obs <crafter.objects.Shelter object at 0x160c6bd30> [ 0 39  0  0 39  0  0 11  0]
obs <crafter.objects.Warehouse object at 0x160c59160> [ 0 39  0  0 37  0  0  9  0]
obs <crafter.objects.Station object at 0x160c59bb0> [ 0  9  0  0  9  0  0 12  0]
obs <crafter.objects.Shelter object at 0x160c6bd30> [ 0 39  0  0 39  0  0 12  0]
obs <crafter.objects.Warehouse object at 0x160c59160> [ 0 39  0  0 42  0  0  9  0]
obs <crafter.objects.Station object at 0x160c59bb0> [0 9 0 0 9 0 0 7 0]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0004699230194091797 seconds
19 rew tensor(-0.8067, dtype=torch.float64) delta_t tensor(-1.3445, dtype=torch.float64)
19 gae_duplicate tensor(-1.3445, dtype=torch.float64) tensor(2.2469, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.8418, dtype=torch.float64) delta_t tensor(-0.7348, dtype=torch.float64)
18 gae_duplicate tensor(-1.8104, dtype=torch.float64) tensor(3.5800, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.8821, dtype=torch.float64) delta_t tensor(-1.1241, dtype=torch.float64)
17 gae_duplicate tensor(-2.5724, dtype=torch.float64) tensor(4.2562, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.9288, dtype=torch.float64) delta_t tensor(-0.7283, dtype=torch.float64)
16 gae_duplicate tensor(-2.7863, dtype=torch.float64) tensor(6.4873, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.9842, dtype=torch.float64) delta_t tensor(-0.8538, dtype=torch.float64)
15 gae_duplicate tensor(-3.0828, dtype=torch.float64) tensor(5.7308, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-1.0510, dtype=torch.float64) delta_t tensor(-1.0570, dtype=torch.float64)
14 gae_duplicate tensor(-3.5232, dtype=torch.float64) tensor(6.5494, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-1.1341, dtype=torch.float64) delta_t tensor(-1.1401, dtype=torch.float64)
13 gae_duplicate tensor(-3.9587, dtype=torch.float64) tensor(9.3136, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-1.2415, dtype=torch.float64) delta_t tensor(-1.2474, dtype=torch.float64)
12 gae_duplicate tensor(-4.4143, dtype=torch.float64) tensor(10.2072, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.3878, dtype=torch.float64) delta_t tensor(-1.3938, dtype=torch.float64)
11 gae_duplicate tensor(-4.9252, dtype=torch.float64) tensor(11.5877, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.6049, dtype=torch.float64) delta_t tensor(-1.7909, dtype=torch.float64)
10 gae_duplicate tensor(-5.7311, dtype=torch.float64) tensor(14.7644, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5520, dtype=torch.float64) delta_t tensor(-1.6225, dtype=torch.float64)
9 gae_duplicate tensor(-6.2074, dtype=torch.float64) tensor(10.4708, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6519, dtype=torch.float64) delta_t tensor(-1.5468, dtype=torch.float64)
8 gae_duplicate tensor(-6.5127, dtype=torch.float64) tensor(12.2297, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8429, dtype=torch.float64) delta_t tensor(-0.9568, dtype=torch.float64)
7 gae_duplicate tensor(-6.1670, dtype=torch.float64) tensor(14.8083, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6109, dtype=torch.float64) delta_t tensor(-0.4385, dtype=torch.float64)
6 gae_duplicate tensor(-5.3721, dtype=torch.float64) tensor(10.0925, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1024, dtype=torch.float64) delta_t tensor(-1.1295, dtype=torch.float64)
5 gae_duplicate tensor(-5.4272, dtype=torch.float64) tensor(13.2394, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.2018, dtype=torch.float64) delta_t tensor(0.9435, dtype=torch.float64)
4 gae_duplicate tensor(-3.3982, dtype=torch.float64) tensor(6.1688, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.4912, dtype=torch.float64) delta_t tensor(1.3962, dtype=torch.float64)
3 gae_duplicate tensor(-1.3224, dtype=torch.float64) tensor(2.4087, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0., dtype=torch.float64) delta_t tensor(-0.0580, dtype=torch.float64)
2 gae_duplicate tensor(-1.1159, dtype=torch.float64) tensor(2.0326, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-878.1448364257812
value loss:488.21661376953125
entropies:36.629695892333984
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.554655075073242 seconds
19 rew tensor(-0.8230, dtype=torch.float64) delta_t tensor(-1.2718, dtype=torch.float64)
19 gae_duplicate tensor(-1.2718, dtype=torch.float64) tensor(1.9557, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.8408, dtype=torch.float64) delta_t tensor(-0.8400, dtype=torch.float64)
18 gae_duplicate tensor(-1.8575, dtype=torch.float64) tensor(4.1543, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.8597, dtype=torch.float64) delta_t tensor(-1.0593, dtype=torch.float64)
17 gae_duplicate tensor(-2.5453, dtype=torch.float64) tensor(5.6326, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.8800, dtype=torch.float64) delta_t tensor(-0.7352, dtype=torch.float64)
16 gae_duplicate tensor(-2.7715, dtype=torch.float64) tensor(5.8368, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.9018, dtype=torch.float64) delta_t tensor(-0.9065, dtype=torch.float64)
15 gae_duplicate tensor(-3.1237, dtype=torch.float64) tensor(7.2544, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.9254, dtype=torch.float64) delta_t tensor(-0.9654, dtype=torch.float64)
14 gae_duplicate tensor(-3.4644, dtype=torch.float64) tensor(6.8449, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.9509, dtype=torch.float64) delta_t tensor(-0.9906, dtype=torch.float64)
13 gae_duplicate tensor(-3.7621, dtype=torch.float64) tensor(10.0086, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.9787, dtype=torch.float64) delta_t tensor(-1.0164, dtype=torch.float64)
12 gae_duplicate tensor(-4.0261, dtype=torch.float64) tensor(7.9115, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.0090, dtype=torch.float64) delta_t tensor(-1.0118, dtype=torch.float64)
11 gae_duplicate tensor(-4.2326, dtype=torch.float64) tensor(7.0410, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.0425, dtype=torch.float64) delta_t tensor(-1.1366, dtype=torch.float64)
10 gae_duplicate tensor(-4.5227, dtype=torch.float64) tensor(7.2478, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6245, dtype=torch.float64) delta_t tensor(-0.6602, dtype=torch.float64)
9 gae_duplicate tensor(-4.2783, dtype=torch.float64) tensor(6.8704, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3390, dtype=torch.float64) delta_t tensor(-0.2498, dtype=torch.float64)
8 gae_duplicate tensor(-3.6724, dtype=torch.float64) tensor(7.3773, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0501, dtype=torch.float64) delta_t tensor(-0.0757, dtype=torch.float64)
7 gae_duplicate tensor(-3.0136, dtype=torch.float64) tensor(5.0326, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6013, dtype=torch.float64) delta_t tensor(0.6989, dtype=torch.float64)
6 gae_duplicate tensor(-1.7120, dtype=torch.float64) tensor(4.0376, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3304, dtype=torch.float64) delta_t tensor(-0.0382, dtype=torch.float64)
5 gae_duplicate tensor(-1.4078, dtype=torch.float64) tensor(2.5397, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.3920, dtype=torch.float64) delta_t tensor(1.3079, dtype=torch.float64)
4 gae_duplicate tensor(0.1817, dtype=torch.float64) tensor(-0.4511, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.1955, dtype=torch.float64) delta_t tensor(1.1896, dtype=torch.float64)
3 gae_duplicate tensor(1.3350, dtype=torch.float64) tensor(-2.3843, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.9708, dtype=torch.float64) delta_t tensor(0.9284, dtype=torch.float64)
2 gae_duplicate tensor(1.9964, dtype=torch.float64) tensor(-4.9974, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-492.5577087402344
value loss:241.956787109375
entropies:36.10809326171875
Policy training finished
---------------------
gamma: 0.8
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 4.45658278465271 seconds
19 rew tensor(-0.7954, dtype=torch.float64) delta_t tensor(-1.4278, dtype=torch.float64)
19 gae_duplicate tensor(-1.4278, dtype=torch.float64) tensor(3.1180, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.8064, dtype=torch.float64) delta_t tensor(-0.9104, dtype=torch.float64)
18 gae_duplicate tensor(-2.0526, dtype=torch.float64) tensor(3.1413, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.8178, dtype=torch.float64) delta_t tensor(-0.8163, dtype=torch.float64)
17 gae_duplicate tensor(-2.4584, dtype=torch.float64) tensor(3.7200, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.8298, dtype=torch.float64) delta_t tensor(-0.6970, dtype=torch.float64)
16 gae_duplicate tensor(-2.6637, dtype=torch.float64) tensor(5.9315, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.8424, dtype=torch.float64) delta_t tensor(-0.6790, dtype=torch.float64)
15 gae_duplicate tensor(-2.8100, dtype=torch.float64) tensor(7.5168, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.8555, dtype=torch.float64) delta_t tensor(-0.8638, dtype=torch.float64)
14 gae_duplicate tensor(-3.1119, dtype=torch.float64) tensor(5.0909, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.8692, dtype=torch.float64) delta_t tensor(-0.8628, dtype=torch.float64)
13 gae_duplicate tensor(-3.3523, dtype=torch.float64) tensor(8.9275, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.8837, dtype=torch.float64) delta_t tensor(-0.8891, dtype=torch.float64)
12 gae_duplicate tensor(-3.5709, dtype=torch.float64) tensor(7.0857, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8989, dtype=torch.float64) delta_t tensor(-0.8902, dtype=torch.float64)
11 gae_duplicate tensor(-3.7469, dtype=torch.float64) tensor(8.7004, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.9149, dtype=torch.float64) delta_t tensor(-1.0705, dtype=torch.float64)
10 gae_duplicate tensor(-4.0681, dtype=torch.float64) tensor(8.5680, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9318, dtype=torch.float64) delta_t tensor(-0.9819, dtype=torch.float64)
9 gae_duplicate tensor(-4.2363, dtype=torch.float64) tensor(6.5775, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4493, dtype=torch.float64) delta_t tensor(-0.4174, dtype=torch.float64)
8 gae_duplicate tensor(-3.8064, dtype=torch.float64) tensor(8.4534, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2422, dtype=torch.float64) delta_t tensor(-0.2641, dtype=torch.float64)
7 gae_duplicate tensor(-3.3092, dtype=torch.float64) tensor(6.5818, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.9481, dtype=torch.float64) delta_t tensor(1.0866, dtype=torch.float64)
6 gae_duplicate tensor(-1.5608, dtype=torch.float64) tensor(2.5023, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.6874, dtype=torch.float64) delta_t tensor(0.4715, dtype=torch.float64)
5 gae_duplicate tensor(-0.7772, dtype=torch.float64) tensor(1.3630, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.1623, dtype=torch.float64) delta_t tensor(2.0636, dtype=torch.float64)
4 gae_duplicate tensor(1.4418, dtype=torch.float64) tensor(-2.6169, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(2.0236, dtype=torch.float64) delta_t tensor(1.9284, dtype=torch.float64)
3 gae_duplicate tensor(3.0819, dtype=torch.float64) tensor(-5.5366, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.8504, dtype=torch.float64) delta_t tensor(1.8047, dtype=torch.float64)
2 gae_duplicate tensor(4.2702, dtype=torch.float64) tensor(-7.5040, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-430.80328369140625
value loss:251.67889404296875
entropies:36.02493667602539
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.440109968185425 seconds
19 rew tensor(-0.7897, dtype=torch.float64) delta_t tensor(-1.3236, dtype=torch.float64)
19 gae_duplicate tensor(-1.3236, dtype=torch.float64) tensor(2.9083, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7978, dtype=torch.float64) delta_t tensor(-0.8136, dtype=torch.float64)
18 gae_duplicate tensor(-1.8725, dtype=torch.float64) tensor(4.1144, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.8061, dtype=torch.float64) delta_t tensor(-0.8126, dtype=torch.float64)
17 gae_duplicate tensor(-2.3106, dtype=torch.float64) tensor(5.0774, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.8148, dtype=torch.float64) delta_t tensor(-0.9740, dtype=torch.float64)
16 gae_duplicate tensor(-2.8224, dtype=torch.float64) tensor(4.2441, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.8237, dtype=torch.float64) delta_t tensor(-0.5909, dtype=torch.float64)
15 gae_duplicate tensor(-2.8489, dtype=torch.float64) tensor(5.9674, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.8329, dtype=torch.float64) delta_t tensor(-0.8497, dtype=torch.float64)
14 gae_duplicate tensor(-3.1288, dtype=torch.float64) tensor(8.6855, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.8425, dtype=torch.float64) delta_t tensor(-0.8485, dtype=torch.float64)
13 gae_duplicate tensor(-3.3515, dtype=torch.float64) tensor(5.2537, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.8524, dtype=torch.float64) delta_t tensor(-0.8439, dtype=torch.float64)
12 gae_duplicate tensor(-3.5251, dtype=torch.float64) tensor(5.5840, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8626, dtype=torch.float64) delta_t tensor(-0.8317, dtype=torch.float64)
11 gae_duplicate tensor(-3.6518, dtype=torch.float64) tensor(7.3936, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.8732, dtype=torch.float64) delta_t tensor(-0.9739, dtype=torch.float64)
10 gae_duplicate tensor(-3.8954, dtype=torch.float64) tensor(6.0012, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6653, dtype=torch.float64) delta_t tensor(-0.6932, dtype=torch.float64)
9 gae_duplicate tensor(-3.8095, dtype=torch.float64) tensor(5.8187, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3814, dtype=torch.float64) delta_t tensor(-0.3647, dtype=torch.float64)
8 gae_duplicate tensor(-3.4123, dtype=torch.float64) tensor(7.3771, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3123, dtype=torch.float64) delta_t tensor(-0.3422, dtype=torch.float64)
7 gae_duplicate tensor(-3.0720, dtype=torch.float64) tensor(6.2573, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7614, dtype=torch.float64) delta_t tensor(0.8881, dtype=torch.float64)
6 gae_duplicate tensor(-1.5695, dtype=torch.float64) tensor(2.4636, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4844, dtype=torch.float64) delta_t tensor(0.1065, dtype=torch.float64)
5 gae_duplicate tensor(-1.1491, dtype=torch.float64) tensor(1.9514, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.8399, dtype=torch.float64) delta_t tensor(1.8651, dtype=torch.float64)
4 gae_duplicate tensor(0.9458, dtype=torch.float64) tensor(-2.2739, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.6158, dtype=torch.float64) delta_t tensor(1.5715, dtype=torch.float64)
3 gae_duplicate tensor(2.3281, dtype=torch.float64) tensor(-4.1714, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.5168, dtype=torch.float64) delta_t tensor(1.4673, dtype=torch.float64)
2 gae_duplicate tensor(3.3298, dtype=torch.float64) tensor(-6.2653, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-399.3987731933594
value loss:218.12452697753906
entropies:35.83656692504883
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4401469230651855 seconds
19 rew tensor(-0.7814, dtype=torch.float64) delta_t tensor(-1.3830, dtype=torch.float64)
19 gae_duplicate tensor(-1.3830, dtype=torch.float64) tensor(3.0235, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7878, dtype=torch.float64) delta_t tensor(-0.8889, dtype=torch.float64)
18 gae_duplicate tensor(-1.9953, dtype=torch.float64) tensor(3.0085, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7943, dtype=torch.float64) delta_t tensor(-0.7643, dtype=torch.float64)
17 gae_duplicate tensor(-2.3605, dtype=torch.float64) tensor(5.1964, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.8009, dtype=torch.float64) delta_t tensor(-0.5672, dtype=torch.float64)
16 gae_duplicate tensor(-2.4556, dtype=torch.float64) tensor(5.3851, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.8078, dtype=torch.float64) delta_t tensor(-0.6760, dtype=torch.float64)
15 gae_duplicate tensor(-2.6405, dtype=torch.float64) tensor(4.0864, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.8148, dtype=torch.float64) delta_t tensor(-0.8069, dtype=torch.float64)
14 gae_duplicate tensor(-2.9193, dtype=torch.float64) tensor(6.1859, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.8220, dtype=torch.float64) delta_t tensor(-0.8141, dtype=torch.float64)
13 gae_duplicate tensor(-3.1495, dtype=torch.float64) tensor(4.8741, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.8295, dtype=torch.float64) delta_t tensor(-0.8083, dtype=torch.float64)
12 gae_duplicate tensor(-3.3278, dtype=torch.float64) tensor(7.0141, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8371, dtype=torch.float64) delta_t tensor(-0.8011, dtype=torch.float64)
11 gae_duplicate tensor(-3.4634, dtype=torch.float64) tensor(7.8036, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.8449, dtype=torch.float64) delta_t tensor(-1.0185, dtype=torch.float64)
10 gae_duplicate tensor(-3.7892, dtype=torch.float64) tensor(8.3454, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8530, dtype=torch.float64) delta_t tensor(-0.8591, dtype=torch.float64)
9 gae_duplicate tensor(-3.8904, dtype=torch.float64) tensor(5.8666, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2153, dtype=torch.float64) delta_t tensor(-0.1906, dtype=torch.float64)
8 gae_duplicate tensor(-3.3029, dtype=torch.float64) tensor(4.9823, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1403, dtype=torch.float64) delta_t tensor(0.2672, dtype=torch.float64)
7 gae_duplicate tensor(-2.3751, dtype=torch.float64) tensor(3.6488, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.2058, dtype=torch.float64) delta_t tensor(1.2428, dtype=torch.float64)
6 gae_duplicate tensor(-0.6573, dtype=torch.float64) tensor(1.3815, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(1.2232, dtype=torch.float64) delta_t tensor(1.0408, dtype=torch.float64)
5 gae_duplicate tensor(0.5150, dtype=torch.float64) tensor(-0.8672, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.3123, dtype=torch.float64) delta_t tensor(2.3890, dtype=torch.float64)
4 gae_duplicate tensor(2.8010, dtype=torch.float64) tensor(-4.5780, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.5242, dtype=torch.float64) delta_t tensor(1.2766, dtype=torch.float64)
3 gae_duplicate tensor(3.5173, dtype=torch.float64) tensor(-8.7489, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.9993, dtype=torch.float64) delta_t tensor(1.9727, dtype=torch.float64)
2 gae_duplicate tensor(4.7866, dtype=torch.float64) tensor(-12.5961, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-265.1455383300781
value loss:233.77273559570312
entropies:35.754638671875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(417.6428)
ToM Target loss= tensor(301.1936)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.281092166900635 seconds
19 rew tensor(-0.7842, dtype=torch.float64) delta_t tensor(-0.9664, dtype=torch.float64)
19 gae_duplicate tensor(-0.9664, dtype=torch.float64) tensor(2.7450, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7895, dtype=torch.float64) delta_t tensor(-0.8160, dtype=torch.float64)
18 gae_duplicate tensor(-1.5892, dtype=torch.float64) tensor(2.4333, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7949, dtype=torch.float64) delta_t tensor(-0.9884, dtype=torch.float64)
17 gae_duplicate tensor(-2.2598, dtype=torch.float64) tensor(4.9220, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.8005, dtype=torch.float64) delta_t tensor(-0.6007, dtype=torch.float64)
16 gae_duplicate tensor(-2.4085, dtype=torch.float64) tensor(5.2831, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.8061, dtype=torch.float64) delta_t tensor(-0.7628, dtype=torch.float64)
15 gae_duplicate tensor(-2.6895, dtype=torch.float64) tensor(5.8990, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.8119, dtype=torch.float64) delta_t tensor(-0.8137, dtype=torch.float64)
14 gae_duplicate tensor(-2.9653, dtype=torch.float64) tensor(6.4590, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.8178, dtype=torch.float64) delta_t tensor(-0.8097, dtype=torch.float64)
13 gae_duplicate tensor(-3.1819, dtype=torch.float64) tensor(4.8720, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.8239, dtype=torch.float64) delta_t tensor(-0.8130, dtype=torch.float64)
12 gae_duplicate tensor(-3.3586, dtype=torch.float64) tensor(5.1204, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8300, dtype=torch.float64) delta_t tensor(-0.8277, dtype=torch.float64)
11 gae_duplicate tensor(-3.5146, dtype=torch.float64) tensor(7.7086, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.8364, dtype=torch.float64) delta_t tensor(-0.9144, dtype=torch.float64)
10 gae_duplicate tensor(-3.7260, dtype=torch.float64) tensor(5.7045, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6233, dtype=torch.float64) delta_t tensor(-0.6837, dtype=torch.float64)
9 gae_duplicate tensor(-3.6645, dtype=torch.float64) tensor(7.9795, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4084, dtype=torch.float64) delta_t tensor(-0.2526, dtype=torch.float64)
8 gae_duplicate tensor(-3.1842, dtype=torch.float64) tensor(6.9104, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4617, dtype=torch.float64) delta_t tensor(0.3750, dtype=torch.float64)
7 gae_duplicate tensor(-2.1723, dtype=torch.float64) tensor(4.7654, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4643, dtype=torch.float64) delta_t tensor(0.5767, dtype=torch.float64)
6 gae_duplicate tensor(-1.1612, dtype=torch.float64) tensor(2.5447, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1062, dtype=torch.float64) delta_t tensor(-0.0774, dtype=torch.float64)
5 gae_duplicate tensor(-1.0064, dtype=torch.float64) tensor(2.0351, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.9019, dtype=torch.float64) delta_t tensor(1.7640, dtype=torch.float64)
4 gae_duplicate tensor(0.9589, dtype=torch.float64) tensor(-1.6021, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.6544, dtype=torch.float64) delta_t tensor(1.6129, dtype=torch.float64)
3 gae_duplicate tensor(2.3800, dtype=torch.float64) tensor(-3.9136, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8778, dtype=torch.float64) delta_t tensor(0.8471, dtype=torch.float64)
2 gae_duplicate tensor(2.7511, dtype=torch.float64) tensor(-7.4753, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-375.41741943359375
value loss:184.25086975097656
entropies:35.71692657470703
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.424654960632324 seconds
19 rew tensor(-0.7783, dtype=torch.float64) delta_t tensor(-1.2592, dtype=torch.float64)
19 gae_duplicate tensor(-1.2592, dtype=torch.float64) tensor(1.9503, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7828, dtype=torch.float64) delta_t tensor(-1.0011, dtype=torch.float64)
18 gae_duplicate tensor(-2.0085, dtype=torch.float64) tensor(3.0983, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7874, dtype=torch.float64) delta_t tensor(-0.6740, dtype=torch.float64)
17 gae_duplicate tensor(-2.2807, dtype=torch.float64) tensor(6.4154, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7920, dtype=torch.float64) delta_t tensor(-0.5170, dtype=torch.float64)
16 gae_duplicate tensor(-2.3416, dtype=torch.float64) tensor(5.1009, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7968, dtype=torch.float64) delta_t tensor(-0.5873, dtype=torch.float64)
15 gae_duplicate tensor(-2.4606, dtype=torch.float64) tensor(5.3415, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.8016, dtype=torch.float64) delta_t tensor(-0.7629, dtype=torch.float64)
14 gae_duplicate tensor(-2.7314, dtype=torch.float64) tensor(7.6651, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.8065, dtype=torch.float64) delta_t tensor(-0.7678, dtype=torch.float64)
13 gae_duplicate tensor(-2.9529, dtype=torch.float64) tensor(4.5740, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.8115, dtype=torch.float64) delta_t tensor(-0.7728, dtype=torch.float64)
12 gae_duplicate tensor(-3.1352, dtype=torch.float64) tensor(6.8287, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8166, dtype=torch.float64) delta_t tensor(-0.7779, dtype=torch.float64)
11 gae_duplicate tensor(-3.2861, dtype=torch.float64) tensor(5.0692, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.8218, dtype=torch.float64) delta_t tensor(-1.0000, dtype=torch.float64)
10 gae_duplicate tensor(-3.6289, dtype=torch.float64) tensor(10.1837, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8271, dtype=torch.float64) delta_t tensor(-0.8464, dtype=torch.float64)
9 gae_duplicate tensor(-3.7495, dtype=torch.float64) tensor(10.5121, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4018, dtype=torch.float64) delta_t tensor(-0.4375, dtype=torch.float64)
8 gae_duplicate tensor(-3.4371, dtype=torch.float64) tensor(5.3044, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1688, dtype=torch.float64) delta_t tensor(0.3283, dtype=torch.float64)
7 gae_duplicate tensor(-2.4213, dtype=torch.float64) tensor(5.2718, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.9536, dtype=torch.float64) delta_t tensor(1.0176, dtype=torch.float64)
6 gae_duplicate tensor(-0.9194, dtype=torch.float64) tensor(1.4216, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(1.3883, dtype=torch.float64) delta_t tensor(1.2219, dtype=torch.float64)
5 gae_duplicate tensor(0.4864, dtype=torch.float64) tensor(-0.7829, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.4777, dtype=torch.float64) delta_t tensor(2.5515, dtype=torch.float64)
4 gae_duplicate tensor(2.9406, dtype=torch.float64) tensor(-6.3372, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.6751, dtype=torch.float64) delta_t tensor(1.4244, dtype=torch.float64)
3 gae_duplicate tensor(3.7768, dtype=torch.float64) tensor(-8.9205, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(2.1433, dtype=torch.float64) delta_t tensor(2.1366, dtype=torch.float64)
2 gae_duplicate tensor(5.1580, dtype=torch.float64) tensor(-11.6630, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-307.2758483886719
value loss:232.0023193359375
entropies:35.81315612792969
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.219874858856201 seconds
19 rew tensor(-0.7750, dtype=torch.float64) delta_t tensor(-1.3408, dtype=torch.float64)
19 gae_duplicate tensor(-1.3408, dtype=torch.float64) tensor(2.9269, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7789, dtype=torch.float64) delta_t tensor(-0.8935, dtype=torch.float64)
18 gae_duplicate tensor(-1.9661, dtype=torch.float64) tensor(5.4978, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7829, dtype=torch.float64) delta_t tensor(-0.6826, dtype=torch.float64)
17 gae_duplicate tensor(-2.2555, dtype=torch.float64) tensor(3.5054, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7869, dtype=torch.float64) delta_t tensor(-0.6582, dtype=torch.float64)
16 gae_duplicate tensor(-2.4626, dtype=torch.float64) tensor(3.8119, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7910, dtype=torch.float64) delta_t tensor(-0.5965, dtype=torch.float64)
15 gae_duplicate tensor(-2.5665, dtype=torch.float64) tensor(3.9732, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7951, dtype=torch.float64) delta_t tensor(-0.7676, dtype=torch.float64)
14 gae_duplicate tensor(-2.8209, dtype=torch.float64) tensor(4.3669, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7993, dtype=torch.float64) delta_t tensor(-0.7695, dtype=torch.float64)
13 gae_duplicate tensor(-3.0262, dtype=torch.float64) tensor(4.6848, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.8036, dtype=torch.float64) delta_t tensor(-0.7716, dtype=torch.float64)
12 gae_duplicate tensor(-3.1926, dtype=torch.float64) tensor(6.9401, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8080, dtype=torch.float64) delta_t tensor(-0.7512, dtype=torch.float64)
11 gae_duplicate tensor(-3.3053, dtype=torch.float64) tensor(9.2633, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.8124, dtype=torch.float64) delta_t tensor(-0.9173, dtype=torch.float64)
10 gae_duplicate tensor(-3.5616, dtype=torch.float64) tensor(7.7198, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8169, dtype=torch.float64) delta_t tensor(-0.8210, dtype=torch.float64)
9 gae_duplicate tensor(-3.6703, dtype=torch.float64) tensor(5.7042, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3233, dtype=torch.float64) delta_t tensor(-0.2356, dtype=torch.float64)
8 gae_duplicate tensor(-3.1718, dtype=torch.float64) tensor(6.8939, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0302, dtype=torch.float64) delta_t tensor(0.0494, dtype=torch.float64)
7 gae_duplicate tensor(-2.4880, dtype=torch.float64) tensor(5.3984, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.2323, dtype=torch.float64) delta_t tensor(1.3130, dtype=torch.float64)
6 gae_duplicate tensor(-0.6774, dtype=torch.float64) tensor(1.0465, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.9596, dtype=torch.float64) delta_t tensor(0.8659, dtype=torch.float64)
5 gae_duplicate tensor(0.3240, dtype=torch.float64) tensor(-0.9077, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.3115, dtype=torch.float64) delta_t tensor(2.0960, dtype=torch.float64)
4 gae_duplicate tensor(2.3553, dtype=torch.float64) tensor(-5.0453, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(2.0763, dtype=torch.float64) delta_t tensor(2.0545, dtype=torch.float64)
3 gae_duplicate tensor(3.9387, dtype=torch.float64) tensor(-7.8726, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.6792, dtype=torch.float64) delta_t tensor(1.6570, dtype=torch.float64)
2 gae_duplicate tensor(4.8080, dtype=torch.float64) tensor(-13.0456, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-270.245849609375
value loss:223.17410278320312
entropies:35.80863952636719
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.32568097114563 seconds
19 rew tensor(-0.7669, dtype=torch.float64) delta_t tensor(-1.1054, dtype=torch.float64)
19 gae_duplicate tensor(-1.1054, dtype=torch.float64) tensor(2.4091, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7703, dtype=torch.float64) delta_t tensor(-0.7140, dtype=torch.float64)
18 gae_duplicate tensor(-1.5983, dtype=torch.float64) tensor(3.4736, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7738, dtype=torch.float64) delta_t tensor(-0.7905, dtype=torch.float64)
17 gae_duplicate tensor(-2.0691, dtype=torch.float64) tensor(4.5099, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7773, dtype=torch.float64) delta_t tensor(-0.5672, dtype=torch.float64)
16 gae_duplicate tensor(-2.2224, dtype=torch.float64) tensor(4.8442, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7808, dtype=torch.float64) delta_t tensor(-0.7438, dtype=torch.float64)
15 gae_duplicate tensor(-2.5217, dtype=torch.float64) tensor(3.9414, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7844, dtype=torch.float64) delta_t tensor(-0.7675, dtype=torch.float64)
14 gae_duplicate tensor(-2.7849, dtype=torch.float64) tensor(4.3527, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7880, dtype=torch.float64) delta_t tensor(-0.7711, dtype=torch.float64)
13 gae_duplicate tensor(-2.9990, dtype=torch.float64) tensor(4.6874, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7917, dtype=torch.float64) delta_t tensor(-0.7748, dtype=torch.float64)
12 gae_duplicate tensor(-3.1740, dtype=torch.float64) tensor(4.9609, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7955, dtype=torch.float64) delta_t tensor(-0.7785, dtype=torch.float64)
11 gae_duplicate tensor(-3.3177, dtype=torch.float64) tensor(7.2310, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7993, dtype=torch.float64) delta_t tensor(-0.8047, dtype=torch.float64)
10 gae_duplicate tensor(-3.4589, dtype=torch.float64) tensor(9.6172, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5883, dtype=torch.float64) delta_t tensor(-0.6059, dtype=torch.float64)
9 gae_duplicate tensor(-3.3730, dtype=torch.float64) tensor(9.3840, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5907, dtype=torch.float64) delta_t tensor(-0.6186, dtype=torch.float64)
8 gae_duplicate tensor(-3.3170, dtype=torch.float64) tensor(7.2111, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5217, dtype=torch.float64) delta_t tensor(-0.4371, dtype=torch.float64)
7 gae_duplicate tensor(-3.0908, dtype=torch.float64) tensor(6.6865, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6861, dtype=torch.float64) delta_t tensor(0.7950, dtype=torch.float64)
6 gae_duplicate tensor(-1.6776, dtype=torch.float64) tensor(4.6841, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.6891, dtype=torch.float64) delta_t tensor(0.2305, dtype=torch.float64)
5 gae_duplicate tensor(-1.1116, dtype=torch.float64) tensor(1.7267, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.0399, dtype=torch.float64) delta_t tensor(2.1304, dtype=torch.float64)
4 gae_duplicate tensor(1.2411, dtype=torch.float64) tensor(-1.9344, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.7862, dtype=torch.float64) delta_t tensor(1.7544, dtype=torch.float64)
3 gae_duplicate tensor(2.7473, dtype=torch.float64) tensor(-6.2933, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.6653, dtype=torch.float64) delta_t tensor(1.6444, dtype=torch.float64)
2 gae_duplicate tensor(3.8422, dtype=torch.float64) tensor(-6.1100, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-393.3685607910156
value loss:193.47669982910156
entropies:35.858245849609375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.524517297744751 seconds
19 rew tensor(-0.7587, dtype=torch.float64) delta_t tensor(-1.1090, dtype=torch.float64)
19 gae_duplicate tensor(-1.1090, dtype=torch.float64) tensor(2.4110, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7617, dtype=torch.float64) delta_t tensor(-0.8834, dtype=torch.float64)
18 gae_duplicate tensor(-1.7706, dtype=torch.float64) tensor(2.7522, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7647, dtype=torch.float64) delta_t tensor(-0.7194, dtype=torch.float64)
17 gae_duplicate tensor(-2.1359, dtype=torch.float64) tensor(4.6564, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7678, dtype=torch.float64) delta_t tensor(-0.4480, dtype=torch.float64)
16 gae_duplicate tensor(-2.1567, dtype=torch.float64) tensor(6.0193, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7709, dtype=torch.float64) delta_t tensor(-0.6079, dtype=torch.float64)
15 gae_duplicate tensor(-2.3333, dtype=torch.float64) tensor(3.6269, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7741, dtype=torch.float64) delta_t tensor(-0.7257, dtype=torch.float64)
14 gae_duplicate tensor(-2.5923, dtype=torch.float64) tensor(7.2185, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7773, dtype=torch.float64) delta_t tensor(-0.7289, dtype=torch.float64)
13 gae_duplicate tensor(-2.8027, dtype=torch.float64) tensor(7.8218, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7805, dtype=torch.float64) delta_t tensor(-0.7321, dtype=torch.float64)
12 gae_duplicate tensor(-2.9743, dtype=torch.float64) tensor(4.6416, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7838, dtype=torch.float64) delta_t tensor(-0.7354, dtype=torch.float64)
11 gae_duplicate tensor(-3.1148, dtype=torch.float64) tensor(4.8609, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7871, dtype=torch.float64) delta_t tensor(-0.8809, dtype=torch.float64)
10 gae_duplicate tensor(-3.3728, dtype=torch.float64) tensor(7.3029, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7904, dtype=torch.float64) delta_t tensor(-0.7837, dtype=torch.float64)
9 gae_duplicate tensor(-3.4819, dtype=torch.float64) tensor(5.4338, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7938, dtype=torch.float64) delta_t tensor(-0.8013, dtype=torch.float64)
8 gae_duplicate tensor(-3.5868, dtype=torch.float64) tensor(7.8206, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2991, dtype=torch.float64) delta_t tensor(-0.2024, dtype=torch.float64)
7 gae_duplicate tensor(-3.0719, dtype=torch.float64) tensor(4.7945, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1260, dtype=torch.float64) delta_t tensor(0.1736, dtype=torch.float64)
6 gae_duplicate tensor(-2.2839, dtype=torch.float64) tensor(3.5437, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(1.1885, dtype=torch.float64) delta_t tensor(1.1887, dtype=torch.float64)
5 gae_duplicate tensor(-0.6384, dtype=torch.float64) tensor(1.3921, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.9052, dtype=torch.float64) delta_t tensor(2.1250, dtype=torch.float64)
4 gae_duplicate tensor(1.6143, dtype=torch.float64) tensor(-2.5035, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.3583, dtype=torch.float64) delta_t tensor(0.9933, dtype=torch.float64)
3 gae_duplicate tensor(2.2847, dtype=torch.float64) tensor(-3.8062, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(2.5142, dtype=torch.float64) delta_t tensor(2.4551, dtype=torch.float64)
2 gae_duplicate tensor(4.2829, dtype=torch.float64) tensor(-6.6699, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-368.97265625
value loss:194.60977172851562
entropies:35.835166931152344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(414.8811)
ToM Target loss= tensor(301.1078)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.465842962265015 seconds
19 rew tensor(-0.7380, dtype=torch.float64) delta_t tensor(-0.8723, dtype=torch.float64)
19 gae_duplicate tensor(-0.8723, dtype=torch.float64) tensor(1.8892, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7406, dtype=torch.float64) delta_t tensor(-0.6781, dtype=torch.float64)
18 gae_duplicate tensor(-1.3760, dtype=torch.float64) tensor(2.1295, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7432, dtype=torch.float64) delta_t tensor(-0.7483, dtype=torch.float64)
17 gae_duplicate tensor(-1.8491, dtype=torch.float64) tensor(4.0409, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7458, dtype=torch.float64) delta_t tensor(-0.5647, dtype=torch.float64)
16 gae_duplicate tensor(-2.0440, dtype=torch.float64) tensor(5.7176, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7485, dtype=torch.float64) delta_t tensor(-0.7109, dtype=torch.float64)
15 gae_duplicate tensor(-2.3461, dtype=torch.float64) tensor(3.6458, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7512, dtype=torch.float64) delta_t tensor(-0.7200, dtype=torch.float64)
14 gae_duplicate tensor(-2.5969, dtype=torch.float64) tensor(5.6407, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7540, dtype=torch.float64) delta_t tensor(-0.7228, dtype=torch.float64)
13 gae_duplicate tensor(-2.8003, dtype=torch.float64) tensor(6.0647, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7568, dtype=torch.float64) delta_t tensor(-0.7255, dtype=torch.float64)
12 gae_duplicate tensor(-2.9657, dtype=torch.float64) tensor(6.4419, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7596, dtype=torch.float64) delta_t tensor(-0.7283, dtype=torch.float64)
11 gae_duplicate tensor(-3.1009, dtype=torch.float64) tensor(4.8188, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7624, dtype=torch.float64) delta_t tensor(-0.7334, dtype=torch.float64)
10 gae_duplicate tensor(-3.2141, dtype=torch.float64) tensor(4.9744, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7653, dtype=torch.float64) delta_t tensor(-0.7402, dtype=torch.float64)
9 gae_duplicate tensor(-3.3115, dtype=torch.float64) tensor(5.1453, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.1203, dtype=torch.float64) delta_t tensor(-2.1028, dtype=torch.float64)
8 gae_duplicate tensor(-4.7521, dtype=torch.float64) tensor(7.3531, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4262, dtype=torch.float64) delta_t tensor(-0.3288, dtype=torch.float64)
7 gae_duplicate tensor(-4.1304, dtype=torch.float64) tensor(6.3918, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0024, dtype=torch.float64) delta_t tensor(0.1605, dtype=torch.float64)
6 gae_duplicate tensor(-3.1438, dtype=torch.float64) tensor(6.8177, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.7885, dtype=torch.float64) delta_t tensor(0.2639, dtype=torch.float64)
5 gae_duplicate tensor(-2.2512, dtype=torch.float64) tensor(3.4740, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.3628, dtype=torch.float64) delta_t tensor(1.4327, dtype=torch.float64)
4 gae_duplicate tensor(-0.3682, dtype=torch.float64) tensor(0.8003, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.9448, dtype=torch.float64) delta_t tensor(1.9384, dtype=torch.float64)
3 gae_duplicate tensor(1.6438, dtype=torch.float64) tensor(-3.4264, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.6799, dtype=torch.float64) delta_t tensor(1.6544, dtype=torch.float64)
2 gae_duplicate tensor(2.9694, dtype=torch.float64) tensor(-4.6158, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-404.89434814453125
value loss:204.44784545898438
entropies:35.76850128173828
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.23697304725647 seconds
19 rew tensor(-0.7359, dtype=torch.float64) delta_t tensor(-1.1945, dtype=torch.float64)
19 gae_duplicate tensor(-1.1945, dtype=torch.float64) tensor(2.6081, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7382, dtype=torch.float64) delta_t tensor(-0.7947, dtype=torch.float64)
18 gae_duplicate tensor(-1.7503, dtype=torch.float64) tensor(2.7099, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7406, dtype=torch.float64) delta_t tensor(-0.6632, dtype=torch.float64)
17 gae_duplicate tensor(-2.0634, dtype=torch.float64) tensor(3.2075, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7430, dtype=torch.float64) delta_t tensor(-0.3529, dtype=torch.float64)
16 gae_duplicate tensor(-2.0036, dtype=torch.float64) tensor(4.3540, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7455, dtype=torch.float64) delta_t tensor(-0.5449, dtype=torch.float64)
15 gae_duplicate tensor(-2.1478, dtype=torch.float64) tensor(4.6543, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7480, dtype=torch.float64) delta_t tensor(-0.6789, dtype=torch.float64)
14 gae_duplicate tensor(-2.3971, dtype=torch.float64) tensor(3.7114, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7504, dtype=torch.float64) delta_t tensor(-0.6813, dtype=torch.float64)
13 gae_duplicate tensor(-2.5990, dtype=torch.float64) tensor(5.6584, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7530, dtype=torch.float64) delta_t tensor(-0.6839, dtype=torch.float64)
12 gae_duplicate tensor(-2.7631, dtype=torch.float64) tensor(4.2780, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7555, dtype=torch.float64) delta_t tensor(-0.6864, dtype=torch.float64)
11 gae_duplicate tensor(-2.8969, dtype=torch.float64) tensor(6.3068, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7581, dtype=torch.float64) delta_t tensor(-0.8541, dtype=torch.float64)
10 gae_duplicate tensor(-3.1716, dtype=torch.float64) tensor(6.8712, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7607, dtype=torch.float64) delta_t tensor(-0.7510, dtype=torch.float64)
9 gae_duplicate tensor(-3.2883, dtype=torch.float64) tensor(5.0952, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7633, dtype=torch.float64) delta_t tensor(-0.7564, dtype=torch.float64)
8 gae_duplicate tensor(-3.3870, dtype=torch.float64) tensor(7.3429, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3639, dtype=torch.float64) delta_t tensor(0.5501, dtype=torch.float64)
7 gae_duplicate tensor(-2.1595, dtype=torch.float64) tensor(3.3407, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.9992, dtype=torch.float64) delta_t tensor(1.1073, dtype=torch.float64)
6 gae_duplicate tensor(-0.6203, dtype=torch.float64) tensor(1.7422, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(1.2855, dtype=torch.float64) delta_t tensor(1.0866, dtype=torch.float64)
5 gae_duplicate tensor(0.5904, dtype=torch.float64) tensor(-1.6526, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.4931, dtype=torch.float64) delta_t tensor(2.5564, dtype=torch.float64)
4 gae_duplicate tensor(3.0287, dtype=torch.float64) tensor(-4.6955, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.3913, dtype=torch.float64) delta_t tensor(1.1594, dtype=torch.float64)
3 gae_duplicate tensor(3.5823, dtype=torch.float64) tensor(-7.3518, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(2.2595, dtype=torch.float64) delta_t tensor(2.3157, dtype=torch.float64)
2 gae_duplicate tensor(5.1815, dtype=torch.float64) tensor(-8.0602, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-241.79737854003906
value loss:198.74679565429688
entropies:35.77893829345703
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.542325973510742 seconds
19 rew tensor(-0.7374, dtype=torch.float64) delta_t tensor(-0.7848, dtype=torch.float64)
19 gae_duplicate tensor(-0.7848, dtype=torch.float64) tensor(1.2197, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7396, dtype=torch.float64) delta_t tensor(-0.6644, dtype=torch.float64)
18 gae_duplicate tensor(-1.2922, dtype=torch.float64) tensor(2.0084, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7418, dtype=torch.float64) delta_t tensor(-0.9786, dtype=torch.float64)
17 gae_duplicate tensor(-2.0124, dtype=torch.float64) tensor(3.1149, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7441, dtype=torch.float64) delta_t tensor(-0.3535, dtype=torch.float64)
16 gae_duplicate tensor(-1.9634, dtype=torch.float64) tensor(4.2514, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7463, dtype=torch.float64) delta_t tensor(-0.6063, dtype=torch.float64)
15 gae_duplicate tensor(-2.1770, dtype=torch.float64) tensor(3.3836, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7486, dtype=torch.float64) delta_t tensor(-0.6846, dtype=torch.float64)
14 gae_duplicate tensor(-2.4261, dtype=torch.float64) tensor(5.3015, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7509, dtype=torch.float64) delta_t tensor(-0.6832, dtype=torch.float64)
13 gae_duplicate tensor(-2.6241, dtype=torch.float64) tensor(5.6988, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7532, dtype=torch.float64) delta_t tensor(-0.6875, dtype=torch.float64)
12 gae_duplicate tensor(-2.7868, dtype=torch.float64) tensor(4.3314, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7556, dtype=torch.float64) delta_t tensor(-0.6937, dtype=torch.float64)
11 gae_duplicate tensor(-2.9232, dtype=torch.float64) tensor(4.5446, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7579, dtype=torch.float64) delta_t tensor(-0.7748, dtype=torch.float64)
10 gae_duplicate tensor(-3.1134, dtype=torch.float64) tensor(6.7835, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5459, dtype=torch.float64) delta_t tensor(-0.5026, dtype=torch.float64)
9 gae_duplicate tensor(-2.9933, dtype=torch.float64) tensor(6.5419, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4046, dtype=torch.float64) delta_t tensor(-0.3573, dtype=torch.float64)
8 gae_duplicate tensor(-2.7519, dtype=torch.float64) tensor(5.9820, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1919, dtype=torch.float64) delta_t tensor(-0.1339, dtype=torch.float64)
7 gae_duplicate tensor(-2.3354, dtype=torch.float64) tensor(3.6287, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5898, dtype=torch.float64) delta_t tensor(0.7106, dtype=torch.float64)
6 gae_duplicate tensor(-1.1577, dtype=torch.float64) tensor(1.7880, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3074, dtype=torch.float64) delta_t tensor(-0.1660, dtype=torch.float64)
5 gae_duplicate tensor(-1.0922, dtype=torch.float64) tensor(3.0636, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.7964, dtype=torch.float64) delta_t tensor(1.7107, dtype=torch.float64)
4 gae_duplicate tensor(0.8369, dtype=torch.float64) tensor(-1.2974, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.6697, dtype=torch.float64) delta_t tensor(1.7775, dtype=torch.float64)
3 gae_duplicate tensor(2.4470, dtype=torch.float64) tensor(-3.7872, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.3970, dtype=torch.float64) delta_t tensor(1.4014, dtype=torch.float64)
2 gae_duplicate tensor(3.3590, dtype=torch.float64) tensor(-7.2725, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-296.7821960449219
value loss:144.29391479492188
entropies:35.75251770019531
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.282772064208984 seconds
19 rew tensor(-0.7319, dtype=torch.float64) delta_t tensor(-0.9177, dtype=torch.float64)
19 gae_duplicate tensor(-0.9177, dtype=torch.float64) tensor(1.4316, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7339, dtype=torch.float64) delta_t tensor(-0.8191, dtype=torch.float64)
18 gae_duplicate tensor(-1.5532, dtype=torch.float64) tensor(3.3614, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7359, dtype=torch.float64) delta_t tensor(-0.6928, dtype=torch.float64)
17 gae_duplicate tensor(-1.9354, dtype=torch.float64) tensor(3.0073, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7380, dtype=torch.float64) delta_t tensor(-0.3279, dtype=torch.float64)
16 gae_duplicate tensor(-1.8762, dtype=torch.float64) tensor(5.2377, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7400, dtype=torch.float64) delta_t tensor(-0.5368, dtype=torch.float64)
15 gae_duplicate tensor(-2.0378, dtype=torch.float64) tensor(4.4228, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7421, dtype=torch.float64) delta_t tensor(-0.6543, dtype=torch.float64)
14 gae_duplicate tensor(-2.2845, dtype=torch.float64) tensor(3.5642, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7442, dtype=torch.float64) delta_t tensor(-0.6564, dtype=torch.float64)
13 gae_duplicate tensor(-2.4840, dtype=torch.float64) tensor(5.4184, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7463, dtype=torch.float64) delta_t tensor(-0.6585, dtype=torch.float64)
12 gae_duplicate tensor(-2.6457, dtype=torch.float64) tensor(4.1113, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7485, dtype=torch.float64) delta_t tensor(-0.6606, dtype=torch.float64)
11 gae_duplicate tensor(-2.7772, dtype=torch.float64) tensor(4.3156, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7506, dtype=torch.float64) delta_t tensor(-0.8059, dtype=torch.float64)
10 gae_duplicate tensor(-3.0276, dtype=torch.float64) tensor(6.5523, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7528, dtype=torch.float64) delta_t tensor(-0.7084, dtype=torch.float64)
9 gae_duplicate tensor(-3.1305, dtype=torch.float64) tensor(4.8843, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2531, dtype=torch.float64) delta_t tensor(-1.2259, dtype=torch.float64)
8 gae_duplicate tensor(-3.7303, dtype=torch.float64) tensor(8.0900, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2618, dtype=torch.float64) delta_t tensor(-0.1667, dtype=torch.float64)
7 gae_duplicate tensor(-3.1509, dtype=torch.float64) tensor(6.8704, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1643, dtype=torch.float64) delta_t tensor(0.2542, dtype=torch.float64)
6 gae_duplicate tensor(-2.2665, dtype=torch.float64) tensor(3.5284, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(1.0874, dtype=torch.float64) delta_t tensor(1.0473, dtype=torch.float64)
5 gae_duplicate tensor(-0.7659, dtype=torch.float64) tensor(2.1430, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.8020, dtype=torch.float64) delta_t tensor(1.7961, dtype=torch.float64)
4 gae_duplicate tensor(1.1834, dtype=torch.float64) tensor(-2.5756, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.8166, dtype=torch.float64) delta_t tensor(1.5409, dtype=torch.float64)
3 gae_duplicate tensor(2.4876, dtype=torch.float64) tensor(-5.3018, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(2.2614, dtype=torch.float64) delta_t tensor(2.3084, dtype=torch.float64)
2 gae_duplicate tensor(4.2985, dtype=torch.float64) tensor(-6.6784, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-315.37060546875
value loss:173.0594482421875
entropies:35.803897857666016
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.502074241638184 seconds
19 rew tensor(-0.7331, dtype=torch.float64) delta_t tensor(-0.7788, dtype=torch.float64)
19 gae_duplicate tensor(-0.7788, dtype=torch.float64) tensor(1.6994, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7349, dtype=torch.float64) delta_t tensor(-0.5829, dtype=torch.float64)
18 gae_duplicate tensor(-1.2059, dtype=torch.float64) tensor(1.8909, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7368, dtype=torch.float64) delta_t tensor(-1.0395, dtype=torch.float64)
17 gae_duplicate tensor(-2.0043, dtype=torch.float64) tensor(5.5663, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7388, dtype=torch.float64) delta_t tensor(-0.4831, dtype=torch.float64)
16 gae_duplicate tensor(-2.0865, dtype=torch.float64) tensor(3.2587, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7407, dtype=torch.float64) delta_t tensor(-0.4449, dtype=torch.float64)
15 gae_duplicate tensor(-2.1141, dtype=torch.float64) tensor(5.8581, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7426, dtype=torch.float64) delta_t tensor(-0.6682, dtype=torch.float64)
14 gae_duplicate tensor(-2.3594, dtype=torch.float64) tensor(3.6995, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7446, dtype=torch.float64) delta_t tensor(-0.6684, dtype=torch.float64)
13 gae_duplicate tensor(-2.5560, dtype=torch.float64) tensor(7.0978, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7466, dtype=torch.float64) delta_t tensor(-0.6676, dtype=torch.float64)
12 gae_duplicate tensor(-2.7123, dtype=torch.float64) tensor(7.5157, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7486, dtype=torch.float64) delta_t tensor(-0.6916, dtype=torch.float64)
11 gae_duplicate tensor(-2.8614, dtype=torch.float64) tensor(4.4867, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7506, dtype=torch.float64) delta_t tensor(-0.6901, dtype=torch.float64)
10 gae_duplicate tensor(-2.9792, dtype=torch.float64) tensor(6.5013, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5366, dtype=torch.float64) delta_t tensor(-0.4737, dtype=torch.float64)
9 gae_duplicate tensor(-2.8571, dtype=torch.float64) tensor(6.2170, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3939, dtype=torch.float64) delta_t tensor(-0.2981, dtype=torch.float64)
8 gae_duplicate tensor(-2.5838, dtype=torch.float64) tensor(7.1865, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1793, dtype=torch.float64) delta_t tensor(-0.0992, dtype=torch.float64)
7 gae_duplicate tensor(-2.1663, dtype=torch.float64) tensor(4.7076, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7524, dtype=torch.float64) delta_t tensor(0.8891, dtype=torch.float64)
6 gae_duplicate tensor(-0.8439, dtype=torch.float64) tensor(1.3184, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4679, dtype=torch.float64) delta_t tensor(-0.0822, dtype=torch.float64)
5 gae_duplicate tensor(-0.7573, dtype=torch.float64) tensor(1.6426, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.6850, dtype=torch.float64) delta_t tensor(1.6388, dtype=torch.float64)
4 gae_duplicate tensor(1.0329, dtype=torch.float64) tensor(-2.2463, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.5530, dtype=torch.float64) delta_t tensor(1.6908, dtype=torch.float64)
3 gae_duplicate tensor(2.5171, dtype=torch.float64) tensor(-3.8675, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.2746, dtype=torch.float64) delta_t tensor(1.3245, dtype=torch.float64)
2 gae_duplicate tensor(3.3382, dtype=torch.float64) tensor(-5.0853, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-345.7591857910156
value loss:136.17503356933594
entropies:35.84503173828125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(413.4597)
ToM Target loss= tensor(300.7504)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.294742107391357 seconds
19 rew tensor(-0.7326, dtype=torch.float64) delta_t tensor(-0.6869, dtype=torch.float64)
19 gae_duplicate tensor(-0.6869, dtype=torch.float64) tensor(1.4958, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7343, dtype=torch.float64) delta_t tensor(-0.5917, dtype=torch.float64)
18 gae_duplicate tensor(-1.1412, dtype=torch.float64) tensor(2.4850, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7361, dtype=torch.float64) delta_t tensor(-1.0240, dtype=torch.float64)
17 gae_duplicate tensor(-1.9369, dtype=torch.float64) tensor(4.1911, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7379, dtype=torch.float64) delta_t tensor(-0.3747, dtype=torch.float64)
16 gae_duplicate tensor(-1.9243, dtype=torch.float64) tensor(2.9997, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7397, dtype=torch.float64) delta_t tensor(-0.5430, dtype=torch.float64)
15 gae_duplicate tensor(-2.0824, dtype=torch.float64) tensor(4.5060, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7415, dtype=torch.float64) delta_t tensor(-0.6629, dtype=torch.float64)
14 gae_duplicate tensor(-2.3288, dtype=torch.float64) tensor(5.0852, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7434, dtype=torch.float64) delta_t tensor(-0.6642, dtype=torch.float64)
13 gae_duplicate tensor(-2.5273, dtype=torch.float64) tensor(3.9553, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7452, dtype=torch.float64) delta_t tensor(-0.6633, dtype=torch.float64)
12 gae_duplicate tensor(-2.6852, dtype=torch.float64) tensor(5.8103, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7471, dtype=torch.float64) delta_t tensor(-0.6650, dtype=torch.float64)
11 gae_duplicate tensor(-2.8132, dtype=torch.float64) tensor(4.3856, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7489, dtype=torch.float64) delta_t tensor(-0.6650, dtype=torch.float64)
10 gae_duplicate tensor(-2.9155, dtype=torch.float64) tensor(8.0951, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7508, dtype=torch.float64) delta_t tensor(-0.6756, dtype=torch.float64)
9 gae_duplicate tensor(-3.0080, dtype=torch.float64) tensor(4.6893, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5353, dtype=torch.float64) delta_t tensor(-0.4319, dtype=torch.float64)
8 gae_duplicate tensor(-2.8383, dtype=torch.float64) tensor(6.1581, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0296, dtype=torch.float64) delta_t tensor(0.0547, dtype=torch.float64)
7 gae_duplicate tensor(-2.2160, dtype=torch.float64) tensor(3.4627, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7654, dtype=torch.float64) delta_t tensor(0.8089, dtype=torch.float64)
6 gae_duplicate tensor(-0.9638, dtype=torch.float64) tensor(2.6872, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4785, dtype=torch.float64) delta_t tensor(-0.0908, dtype=torch.float64)
5 gae_duplicate tensor(-0.8618, dtype=torch.float64) tensor(1.3731, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.9943, dtype=torch.float64) delta_t tensor(1.9799, dtype=torch.float64)
4 gae_duplicate tensor(1.2904, dtype=torch.float64) tensor(-1.9526, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.7208, dtype=torch.float64) delta_t tensor(1.8963, dtype=torch.float64)
3 gae_duplicate tensor(2.9286, dtype=torch.float64) tensor(-6.2053, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.1503, dtype=torch.float64) delta_t tensor(1.2102, dtype=torch.float64)
2 gae_duplicate tensor(3.5531, dtype=torch.float64) tensor(-7.9626, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-272.628662109375
value loss:143.3294219970703
entropies:35.818687438964844
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.356221914291382 seconds
19 rew tensor(-0.7340, dtype=torch.float64) delta_t tensor(-0.9027, dtype=torch.float64)
19 gae_duplicate tensor(-0.9027, dtype=torch.float64) tensor(1.9507, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7357, dtype=torch.float64) delta_t tensor(-0.9726, dtype=torch.float64)
18 gae_duplicate tensor(-1.6948, dtype=torch.float64) tensor(3.6626, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7374, dtype=torch.float64) delta_t tensor(-0.5181, dtype=torch.float64)
17 gae_duplicate tensor(-1.8739, dtype=torch.float64) tensor(5.2159, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7391, dtype=torch.float64) delta_t tensor(-0.2751, dtype=torch.float64)
16 gae_duplicate tensor(-1.7742, dtype=torch.float64) tensor(4.9384, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7408, dtype=torch.float64) delta_t tensor(-0.4060, dtype=torch.float64)
15 gae_duplicate tensor(-1.8253, dtype=torch.float64) tensor(4.0137, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7425, dtype=torch.float64) delta_t tensor(-0.6113, dtype=torch.float64)
14 gae_duplicate tensor(-2.0716, dtype=torch.float64) tensor(4.4678, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7442, dtype=torch.float64) delta_t tensor(-0.6130, dtype=torch.float64)
13 gae_duplicate tensor(-2.2703, dtype=torch.float64) tensor(6.3601, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7459, dtype=torch.float64) delta_t tensor(-0.6147, dtype=torch.float64)
12 gae_duplicate tensor(-2.4310, dtype=torch.float64) tensor(3.8478, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7477, dtype=torch.float64) delta_t tensor(-0.6165, dtype=torch.float64)
11 gae_duplicate tensor(-2.5613, dtype=torch.float64) tensor(3.9461, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7494, dtype=torch.float64) delta_t tensor(-0.8380, dtype=torch.float64)
10 gae_duplicate tensor(-2.8870, dtype=torch.float64) tensor(4.5005, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7512, dtype=torch.float64) delta_t tensor(-0.6432, dtype=torch.float64)
9 gae_duplicate tensor(-2.9529, dtype=torch.float64) tensor(4.6213, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1779, dtype=torch.float64) delta_t tensor(-0.1504, dtype=torch.float64)
8 gae_duplicate tensor(-2.5127, dtype=torch.float64) tensor(5.4578, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2526, dtype=torch.float64) delta_t tensor(0.4017, dtype=torch.float64)
7 gae_duplicate tensor(-1.6085, dtype=torch.float64) tensor(2.5121, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.1848, dtype=torch.float64) delta_t tensor(1.2025, dtype=torch.float64)
6 gae_duplicate tensor(-0.0843, dtype=torch.float64) tensor(0.1846, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(1.1892, dtype=torch.float64) delta_t tensor(1.0245, dtype=torch.float64)
5 gae_duplicate tensor(0.9570, dtype=torch.float64) tensor(-2.1456, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.7009, dtype=torch.float64) delta_t tensor(2.8236, dtype=torch.float64)
4 gae_duplicate tensor(3.5892, dtype=torch.float64) tensor(-5.2356, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.8663, dtype=torch.float64) delta_t tensor(1.5920, dtype=torch.float64)
3 gae_duplicate tensor(4.4633, dtype=torch.float64) tensor(-6.5787, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(2.1704, dtype=torch.float64) delta_t tensor(2.2740, dtype=torch.float64)
2 gae_duplicate tensor(5.8447, dtype=torch.float64) tensor(-8.4974, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-200.40638732910156
value loss:194.15362548828125
entropies:35.80914306640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.366785049438477 seconds
19 rew tensor(-0.7372, dtype=torch.float64) delta_t tensor(-0.6129, dtype=torch.float64)
19 gae_duplicate tensor(-0.6129, dtype=torch.float64) tensor(1.7042, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7388, dtype=torch.float64) delta_t tensor(-0.5429, dtype=torch.float64)
18 gae_duplicate tensor(-1.0332, dtype=torch.float64) tensor(1.6193, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7404, dtype=torch.float64) delta_t tensor(-1.0348, dtype=torch.float64)
17 gae_duplicate tensor(-1.8613, dtype=torch.float64) tensor(4.0643, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7420, dtype=torch.float64) delta_t tensor(-0.3457, dtype=torch.float64)
16 gae_duplicate tensor(-1.8347, dtype=torch.float64) tensor(5.1132, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7436, dtype=torch.float64) delta_t tensor(-0.4404, dtype=torch.float64)
15 gae_duplicate tensor(-1.9082, dtype=torch.float64) tensor(4.0470, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7453, dtype=torch.float64) delta_t tensor(-0.6172, dtype=torch.float64)
14 gae_duplicate tensor(-2.1437, dtype=torch.float64) tensor(5.8352, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7469, dtype=torch.float64) delta_t tensor(-0.6068, dtype=torch.float64)
13 gae_duplicate tensor(-2.3218, dtype=torch.float64) tensor(4.8686, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7485, dtype=torch.float64) delta_t tensor(-0.6155, dtype=torch.float64)
12 gae_duplicate tensor(-2.4729, dtype=torch.float64) tensor(6.7147, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7502, dtype=torch.float64) delta_t tensor(-0.6251, dtype=torch.float64)
11 gae_duplicate tensor(-2.6034, dtype=torch.float64) tensor(5.4983, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7519, dtype=torch.float64) delta_t tensor(-0.7423, dtype=torch.float64)
10 gae_duplicate tensor(-2.8251, dtype=torch.float64) tensor(4.3975, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5371, dtype=torch.float64) delta_t tensor(-0.4954, dtype=torch.float64)
9 gae_duplicate tensor(-2.7555, dtype=torch.float64) tensor(4.2801, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3218, dtype=torch.float64) delta_t tensor(-0.1311, dtype=torch.float64)
8 gae_duplicate tensor(-2.3355, dtype=torch.float64) tensor(5.0945, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5416, dtype=torch.float64) delta_t tensor(0.6489, dtype=torch.float64)
7 gae_duplicate tensor(-1.2195, dtype=torch.float64) tensor(1.8912, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5426, dtype=torch.float64) delta_t tensor(0.5889, dtype=torch.float64)
6 gae_duplicate tensor(-0.3867, dtype=torch.float64) tensor(0.6346, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1844, dtype=torch.float64) delta_t tensor(0.0427, dtype=torch.float64)
5 gae_duplicate tensor(-0.2667, dtype=torch.float64) tensor(0.5467, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.1218, dtype=torch.float64) delta_t tensor(1.9145, dtype=torch.float64)
4 gae_duplicate tensor(1.7011, dtype=torch.float64) tensor(-3.5052, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.8505, dtype=torch.float64) delta_t tensor(1.9186, dtype=torch.float64)
3 gae_duplicate tensor(3.2795, dtype=torch.float64) tensor(-4.6029, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.0664, dtype=torch.float64) delta_t tensor(1.0180, dtype=torch.float64)
2 gae_duplicate tensor(3.6416, dtype=torch.float64) tensor(-5.1723, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-259.2460021972656
value loss:126.66108703613281
entropies:35.752017974853516
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.512405157089233 seconds
19 rew tensor(-0.7381, dtype=torch.float64) delta_t tensor(-0.6358, dtype=torch.float64)
19 gae_duplicate tensor(-0.6358, dtype=torch.float64) tensor(1.4103, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7396, dtype=torch.float64) delta_t tensor(-0.5208, dtype=torch.float64)
18 gae_duplicate tensor(-1.0294, dtype=torch.float64) tensor(1.5430, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7412, dtype=torch.float64) delta_t tensor(-0.7641, dtype=torch.float64)
17 gae_duplicate tensor(-1.5877, dtype=torch.float64) tensor(3.4417, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7427, dtype=torch.float64) delta_t tensor(-0.3458, dtype=torch.float64)
16 gae_duplicate tensor(-1.6160, dtype=torch.float64) tensor(3.5198, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7442, dtype=torch.float64) delta_t tensor(-0.6299, dtype=torch.float64)
15 gae_duplicate tensor(-1.9227, dtype=torch.float64) tensor(5.6149, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7458, dtype=torch.float64) delta_t tensor(-0.6476, dtype=torch.float64)
14 gae_duplicate tensor(-2.1857, dtype=torch.float64) tensor(3.1493, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7473, dtype=torch.float64) delta_t tensor(-0.6503, dtype=torch.float64)
13 gae_duplicate tensor(-2.3989, dtype=torch.float64) tensor(4.9213, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7489, dtype=torch.float64) delta_t tensor(-0.6504, dtype=torch.float64)
12 gae_duplicate tensor(-2.5695, dtype=torch.float64) tensor(6.8932, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7504, dtype=torch.float64) delta_t tensor(-0.6442, dtype=torch.float64)
11 gae_duplicate tensor(-2.6998, dtype=torch.float64) tensor(7.2427, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7520, dtype=torch.float64) delta_t tensor(-0.6185, dtype=torch.float64)
10 gae_duplicate tensor(-2.7783, dtype=torch.float64) tensor(6.0128, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6073, dtype=torch.float64) delta_t tensor(-0.5208, dtype=torch.float64)
9 gae_duplicate tensor(-2.7435, dtype=torch.float64) tensor(5.8877, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1698, dtype=torch.float64) delta_t tensor(-0.0283, dtype=torch.float64)
8 gae_duplicate tensor(-2.2231, dtype=torch.float64) tensor(6.3739, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1220, dtype=torch.float64) delta_t tensor(0.2528, dtype=torch.float64)
7 gae_duplicate tensor(-1.5257, dtype=torch.float64) tensor(3.2278, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3409, dtype=torch.float64) delta_t tensor(0.5486, dtype=torch.float64)
6 gae_duplicate tensor(-0.6720, dtype=torch.float64) tensor(1.3759, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3414, dtype=torch.float64) delta_t tensor(-0.1829, dtype=torch.float64)
5 gae_duplicate tensor(-0.7205, dtype=torch.float64) tensor(0.9944, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.4329, dtype=torch.float64) delta_t tensor(1.4575, dtype=torch.float64)
4 gae_duplicate tensor(0.8811, dtype=torch.float64) tensor(-1.7636, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.0019, dtype=torch.float64) delta_t tensor(1.0660, dtype=torch.float64)
3 gae_duplicate tensor(1.7708, dtype=torch.float64) tensor(-4.2788, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.7133, dtype=torch.float64) delta_t tensor(0.9131, dtype=torch.float64)
2 gae_duplicate tensor(2.3297, dtype=torch.float64) tensor(-4.7186, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-306.1554870605469
value loss:101.31373596191406
entropies:35.62443923950195
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.524496078491211 seconds
19 rew tensor(-0.7400, dtype=torch.float64) delta_t tensor(-0.8067, dtype=torch.float64)
19 gae_duplicate tensor(-0.8067, dtype=torch.float64) tensor(1.2042, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7414, dtype=torch.float64) delta_t tensor(-0.3932, dtype=torch.float64)
18 gae_duplicate tensor(-1.0385, dtype=torch.float64) tensor(2.2058, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7429, dtype=torch.float64) delta_t tensor(-0.9573, dtype=torch.float64)
17 gae_duplicate tensor(-1.7881, dtype=torch.float64) tensor(3.8819, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7443, dtype=torch.float64) delta_t tensor(-0.1248, dtype=torch.float64)
16 gae_duplicate tensor(-1.5552, dtype=torch.float64) tensor(2.3454, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7458, dtype=torch.float64) delta_t tensor(-0.4607, dtype=torch.float64)
15 gae_duplicate tensor(-1.7049, dtype=torch.float64) tensor(2.4042, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7472, dtype=torch.float64) delta_t tensor(-0.5883, dtype=torch.float64)
14 gae_duplicate tensor(-1.9522, dtype=torch.float64) tensor(2.7531, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7487, dtype=torch.float64) delta_t tensor(-0.5898, dtype=torch.float64)
13 gae_duplicate tensor(-2.1516, dtype=torch.float64) tensor(3.0342, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7502, dtype=torch.float64) delta_t tensor(-0.5913, dtype=torch.float64)
12 gae_duplicate tensor(-2.3126, dtype=torch.float64) tensor(5.3974, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7517, dtype=torch.float64) delta_t tensor(-0.5928, dtype=torch.float64)
11 gae_duplicate tensor(-2.4429, dtype=torch.float64) tensor(5.0028, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7532, dtype=torch.float64) delta_t tensor(-0.7545, dtype=torch.float64)
10 gae_duplicate tensor(-2.7088, dtype=torch.float64) tensor(4.0853, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6082, dtype=torch.float64) delta_t tensor(-0.4740, dtype=torch.float64)
9 gae_duplicate tensor(-2.6411, dtype=torch.float64) tensor(3.9695, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2432, dtype=torch.float64) delta_t tensor(-0.1531, dtype=torch.float64)
8 gae_duplicate tensor(-2.2659, dtype=torch.float64) tensor(5.1670, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0241, dtype=torch.float64) delta_t tensor(0.1467, dtype=torch.float64)
7 gae_duplicate tensor(-1.6661, dtype=torch.float64) tensor(2.6849, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7792, dtype=torch.float64) delta_t tensor(0.8220, dtype=torch.float64)
6 gae_duplicate tensor(-0.5108, dtype=torch.float64) tensor(0.7016, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4888, dtype=torch.float64) delta_t tensor(0.0572, dtype=torch.float64)
5 gae_duplicate tensor(-0.3515, dtype=torch.float64) tensor(0.6972, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.1668, dtype=torch.float64) delta_t tensor(2.1527, dtype=torch.float64)
4 gae_duplicate tensor(1.8716, dtype=torch.float64) tensor(-4.9073, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.8900, dtype=torch.float64) delta_t tensor(1.8656, dtype=torch.float64)
3 gae_duplicate tensor(3.3628, dtype=torch.float64) tensor(-6.0495, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.6072, dtype=torch.float64) delta_t tensor(1.7366, dtype=torch.float64)
2 gae_duplicate tensor(4.4269, dtype=torch.float64) tensor(-5.8420, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-173.47882080078125
value loss:130.53627014160156
entropies:35.45800018310547
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(411.9112)
ToM Target loss= tensor(300.5182)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.456812143325806 seconds
19 rew tensor(-0.7361, dtype=torch.float64) delta_t tensor(-0.3985, dtype=torch.float64)
19 gae_duplicate tensor(-0.3985, dtype=torch.float64) tensor(0.8494, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7374, dtype=torch.float64) delta_t tensor(-0.6178, dtype=torch.float64)
18 gae_duplicate tensor(-0.9366, dtype=torch.float64) tensor(1.9915, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7388, dtype=torch.float64) delta_t tensor(-0.6962, dtype=torch.float64)
17 gae_duplicate tensor(-1.4455, dtype=torch.float64) tensor(3.1404, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7402, dtype=torch.float64) delta_t tensor(-0.3208, dtype=torch.float64)
16 gae_duplicate tensor(-1.4772, dtype=torch.float64) tensor(3.2911, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7415, dtype=torch.float64) delta_t tensor(-0.5466, dtype=torch.float64)
15 gae_duplicate tensor(-1.7284, dtype=torch.float64) tensor(4.0532, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7429, dtype=torch.float64) delta_t tensor(-0.5915, dtype=torch.float64)
14 gae_duplicate tensor(-1.9742, dtype=torch.float64) tensor(5.3462, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7443, dtype=torch.float64) delta_t tensor(-0.6023, dtype=torch.float64)
13 gae_duplicate tensor(-2.1817, dtype=torch.float64) tensor(4.4490, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7457, dtype=torch.float64) delta_t tensor(-0.5962, dtype=torch.float64)
12 gae_duplicate tensor(-2.3415, dtype=torch.float64) tensor(5.4717, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7471, dtype=torch.float64) delta_t tensor(-0.6229, dtype=torch.float64)
11 gae_duplicate tensor(-2.4961, dtype=torch.float64) tensor(5.1207, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7485, dtype=torch.float64) delta_t tensor(-0.6140, dtype=torch.float64)
10 gae_duplicate tensor(-2.6108, dtype=torch.float64) tensor(4.0765, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2623, dtype=torch.float64) delta_t tensor(-1.1244, dtype=torch.float64)
9 gae_duplicate tensor(-3.2131, dtype=torch.float64) tensor(7.2028, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3874, dtype=torch.float64) delta_t tensor(-0.2718, dtype=torch.float64)
8 gae_duplicate tensor(-2.8423, dtype=torch.float64) tensor(6.4596, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1684, dtype=torch.float64) delta_t tensor(0.0455, dtype=torch.float64)
7 gae_duplicate tensor(-2.2283, dtype=torch.float64) tensor(3.7160, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5622, dtype=torch.float64) delta_t tensor(0.4716, dtype=torch.float64)
6 gae_duplicate tensor(-1.3111, dtype=torch.float64) tensor(1.7620, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(1.5124, dtype=torch.float64) delta_t tensor(1.2987, dtype=torch.float64)
5 gae_duplicate tensor(0.2498, dtype=torch.float64) tensor(-0.3275, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.1768, dtype=torch.float64) delta_t tensor(2.3275, dtype=torch.float64)
4 gae_duplicate tensor(2.5274, dtype=torch.float64) tensor(-3.1640, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.6046, dtype=torch.float64) delta_t tensor(1.4046, dtype=torch.float64)
3 gae_duplicate tensor(3.4265, dtype=torch.float64) tensor(-6.9847, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.9062, dtype=torch.float64) delta_t tensor(2.0910, dtype=torch.float64)
2 gae_duplicate tensor(4.8322, dtype=torch.float64) tensor(-9.6061, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-222.14859008789062
value loss:153.16482543945312
entropies:35.3891716003418
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.375949859619141 seconds
19 rew tensor(-0.7330, dtype=torch.float64) delta_t tensor(-0.7435, dtype=torch.float64)
19 gae_duplicate tensor(-0.7435, dtype=torch.float64) tensor(1.1022, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7343, dtype=torch.float64) delta_t tensor(-0.9939, dtype=torch.float64)
18 gae_duplicate tensor(-1.5887, dtype=torch.float64) tensor(4.6545, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7356, dtype=torch.float64) delta_t tensor(-0.3508, dtype=torch.float64)
17 gae_duplicate tensor(-1.6217, dtype=torch.float64) tensor(3.5470, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7369, dtype=torch.float64) delta_t tensor(-0.1939, dtype=torch.float64)
16 gae_duplicate tensor(-1.4913, dtype=torch.float64) tensor(3.3080, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7382, dtype=torch.float64) delta_t tensor(-0.3464, dtype=torch.float64)
15 gae_duplicate tensor(-1.5394, dtype=torch.float64) tensor(3.6065, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7395, dtype=torch.float64) delta_t tensor(-0.5524, dtype=torch.float64)
14 gae_duplicate tensor(-1.7840, dtype=torch.float64) tensor(2.4660, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7408, dtype=torch.float64) delta_t tensor(-0.5538, dtype=torch.float64)
13 gae_duplicate tensor(-1.9810, dtype=torch.float64) tensor(3.3245, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7421, dtype=torch.float64) delta_t tensor(-0.5551, dtype=torch.float64)
12 gae_duplicate tensor(-2.1399, dtype=torch.float64) tensor(4.3798, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7435, dtype=torch.float64) delta_t tensor(-0.5564, dtype=torch.float64)
11 gae_duplicate tensor(-2.2683, dtype=torch.float64) tensor(5.3140, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7448, dtype=torch.float64) delta_t tensor(-0.8527, dtype=torch.float64)
10 gae_duplicate tensor(-2.6674, dtype=torch.float64) tensor(5.9285, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7462, dtype=torch.float64) delta_t tensor(-0.5421, dtype=torch.float64)
9 gae_duplicate tensor(-2.6761, dtype=torch.float64) tensor(4.2130, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7475, dtype=torch.float64) delta_t tensor(-0.6642, dtype=torch.float64)
8 gae_duplicate tensor(-2.8050, dtype=torch.float64) tensor(3.9461, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4119, dtype=torch.float64) delta_t tensor(0.6283, dtype=torch.float64)
7 gae_duplicate tensor(-1.6157, dtype=torch.float64) tensor(3.3881, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.2097, dtype=torch.float64) delta_t tensor(0.9367, dtype=torch.float64)
6 gae_duplicate tensor(-0.3558, dtype=torch.float64) tensor(0.6875, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(1.2132, dtype=torch.float64) delta_t tensor(1.2890, dtype=torch.float64)
5 gae_duplicate tensor(1.0044, dtype=torch.float64) tensor(-2.4395, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(3.0307, dtype=torch.float64) delta_t tensor(3.3777, dtype=torch.float64)
4 gae_duplicate tensor(4.1812, dtype=torch.float64) tensor(-5.1485, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.1627, dtype=torch.float64) delta_t tensor(0.8740, dtype=torch.float64)
3 gae_duplicate tensor(4.2189, dtype=torch.float64) tensor(-7.7147, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(2.4854, dtype=torch.float64) delta_t tensor(2.4948, dtype=torch.float64)
2 gae_duplicate tensor(5.8699, dtype=torch.float64) tensor(-11.6330, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-138.63821411132812
value loss:184.1400604248047
entropies:35.283424377441406
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.477840900421143 seconds
19 rew tensor(-0.7341, dtype=torch.float64) delta_t tensor(-0.7081, dtype=torch.float64)
19 gae_duplicate tensor(-0.7081, dtype=torch.float64) tensor(1.4999, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7353, dtype=torch.float64) delta_t tensor(-0.9783, dtype=torch.float64)
18 gae_duplicate tensor(-1.5448, dtype=torch.float64) tensor(2.4996, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7365, dtype=torch.float64) delta_t tensor(-0.4166, dtype=torch.float64)
17 gae_duplicate tensor(-1.6524, dtype=torch.float64) tensor(2.4379, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7378, dtype=torch.float64) delta_t tensor(-0.1240, dtype=torch.float64)
16 gae_duplicate tensor(-1.4460, dtype=torch.float64) tensor(3.0906, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7390, dtype=torch.float64) delta_t tensor(-0.3463, dtype=torch.float64)
15 gae_duplicate tensor(-1.5031, dtype=torch.float64) tensor(2.5543, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7403, dtype=torch.float64) delta_t tensor(-0.5453, dtype=torch.float64)
14 gae_duplicate tensor(-1.7478, dtype=torch.float64) tensor(2.3558, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7415, dtype=torch.float64) delta_t tensor(-0.5466, dtype=torch.float64)
13 gae_duplicate tensor(-1.9449, dtype=torch.float64) tensor(3.9683, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7428, dtype=torch.float64) delta_t tensor(-0.5479, dtype=torch.float64)
12 gae_duplicate tensor(-2.1038, dtype=torch.float64) tensor(5.0085, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7441, dtype=torch.float64) delta_t tensor(-0.5492, dtype=torch.float64)
11 gae_duplicate tensor(-2.2322, dtype=torch.float64) tensor(3.0086, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7454, dtype=torch.float64) delta_t tensor(-0.7668, dtype=torch.float64)
10 gae_duplicate tensor(-2.5526, dtype=torch.float64) tensor(3.6796, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7467, dtype=torch.float64) delta_t tensor(-0.5733, dtype=torch.float64)
9 gae_duplicate tensor(-2.6154, dtype=torch.float64) tensor(5.9601, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1708, dtype=torch.float64) delta_t tensor(-0.1061, dtype=torch.float64)
8 gae_duplicate tensor(-2.1984, dtype=torch.float64) tensor(3.6823, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2614, dtype=torch.float64) delta_t tensor(0.4828, dtype=torch.float64)
7 gae_duplicate tensor(-1.2759, dtype=torch.float64) tensor(3.5053, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.1976, dtype=torch.float64) delta_t tensor(1.1466, dtype=torch.float64)
6 gae_duplicate tensor(0.1259, dtype=torch.float64) tensor(-0.3309, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(1.2009, dtype=torch.float64) delta_t tensor(1.0245, dtype=torch.float64)
5 gae_duplicate tensor(1.1252, dtype=torch.float64) tensor(-1.4033, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.7175, dtype=torch.float64) delta_t tensor(2.8681, dtype=torch.float64)
4 gae_duplicate tensor(3.7683, dtype=torch.float64) tensor(-4.5774, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.8724, dtype=torch.float64) delta_t tensor(1.5778, dtype=torch.float64)
3 gae_duplicate tensor(4.5925, dtype=torch.float64) tensor(-9.0208, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(2.1732, dtype=torch.float64) delta_t tensor(2.3611, dtype=torch.float64)
2 gae_duplicate tensor(6.0351, dtype=torch.float64) tensor(-11.2535, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-101.04161834716797
value loss:178.540283203125
entropies:35.0748405456543
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.590304851531982 seconds
19 rew tensor(-0.7325, dtype=torch.float64) delta_t tensor(-0.8326, dtype=torch.float64)
19 gae_duplicate tensor(-0.8326, dtype=torch.float64) tensor(1.1637, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7336, dtype=torch.float64) delta_t tensor(-0.7215, dtype=torch.float64)
18 gae_duplicate tensor(-1.3876, dtype=torch.float64) tensor(2.2684, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7348, dtype=torch.float64) delta_t tensor(-0.5670, dtype=torch.float64)
17 gae_duplicate tensor(-1.6771, dtype=torch.float64) tensor(3.5942, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7360, dtype=torch.float64) delta_t tensor(-0.2836, dtype=torch.float64)
16 gae_duplicate tensor(-1.6252, dtype=torch.float64) tensor(3.4621, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7372, dtype=torch.float64) delta_t tensor(-0.2772, dtype=torch.float64)
15 gae_duplicate tensor(-1.5774, dtype=torch.float64) tensor(3.7968, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7384, dtype=torch.float64) delta_t tensor(-0.5595, dtype=torch.float64)
14 gae_duplicate tensor(-1.8214, dtype=torch.float64) tensor(3.0915, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7396, dtype=torch.float64) delta_t tensor(-0.5513, dtype=torch.float64)
13 gae_duplicate tensor(-2.0084, dtype=torch.float64) tensor(2.6713, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7408, dtype=torch.float64) delta_t tensor(-0.5510, dtype=torch.float64)
12 gae_duplicate tensor(-2.1577, dtype=torch.float64) tensor(2.8662, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7420, dtype=torch.float64) delta_t tensor(-0.5424, dtype=torch.float64)
11 gae_duplicate tensor(-2.2685, dtype=torch.float64) tensor(7.0603, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7432, dtype=torch.float64) delta_t tensor(-0.6858, dtype=torch.float64)
10 gae_duplicate tensor(-2.5007, dtype=torch.float64) tensor(7.0706, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7445, dtype=torch.float64) delta_t tensor(-0.5833, dtype=torch.float64)
9 gae_duplicate tensor(-2.5838, dtype=torch.float64) tensor(7.7416, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7457, dtype=torch.float64) delta_t tensor(-0.6483, dtype=torch.float64)
8 gae_duplicate tensor(-2.7153, dtype=torch.float64) tensor(5.5178, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3159, dtype=torch.float64) delta_t tensor(-0.0551, dtype=torch.float64)
7 gae_duplicate tensor(-2.2273, dtype=torch.float64) tensor(4.6022, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.9038, dtype=torch.float64) delta_t tensor(0.9093, dtype=torch.float64)
6 gae_duplicate tensor(-0.8725, dtype=torch.float64) tensor(1.6053, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.6185, dtype=torch.float64) delta_t tensor(0.3133, dtype=torch.float64)
5 gae_duplicate tensor(-0.3847, dtype=torch.float64) tensor(0.7360, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.4122, dtype=torch.float64) delta_t tensor(2.4076, dtype=torch.float64)
4 gae_duplicate tensor(2.0998, dtype=torch.float64) tensor(-2.5149, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(2.1417, dtype=torch.float64) delta_t tensor(1.9810, dtype=torch.float64)
3 gae_duplicate tensor(3.6608, dtype=torch.float64) tensor(-9.6050, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(2.0100, dtype=torch.float64) delta_t tensor(2.2140, dtype=torch.float64)
2 gae_duplicate tensor(5.1426, dtype=torch.float64) tensor(-13.4798, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-190.9371795654297
value loss:147.21507263183594
entropies:34.927242279052734
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.275091886520386 seconds
19 rew tensor(-0.8581, dtype=torch.float64) delta_t tensor(-0.5870, dtype=torch.float64)
19 gae_duplicate tensor(-0.5870, dtype=torch.float64) tensor(1.3674, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.9311, dtype=torch.float64) delta_t tensor(-0.6128, dtype=torch.float64)
18 gae_duplicate tensor(-1.0824, dtype=torch.float64) tensor(2.5502, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-1.1474, dtype=torch.float64) delta_t tensor(-1.0683, dtype=torch.float64)
17 gae_duplicate tensor(-1.9342, dtype=torch.float64) tensor(4.4414, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-1.6509, dtype=torch.float64) delta_t tensor(-1.1649, dtype=torch.float64)
16 gae_duplicate tensor(-2.7122, dtype=torch.float64) tensor(5.7233, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-2.4455, dtype=torch.float64) delta_t tensor(-2.2492, dtype=torch.float64)
15 gae_duplicate tensor(-4.4190, dtype=torch.float64) tensor(5.7285, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7341, dtype=torch.float64) delta_t tensor(-0.5521, dtype=torch.float64)
14 gae_duplicate tensor(-4.0873, dtype=torch.float64) tensor(7.0730, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7352, dtype=torch.float64) delta_t tensor(-0.5532, dtype=torch.float64)
13 gae_duplicate tensor(-3.8231, dtype=torch.float64) tensor(6.6158, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7363, dtype=torch.float64) delta_t tensor(-0.5544, dtype=torch.float64)
12 gae_duplicate tensor(-3.6129, dtype=torch.float64) tensor(7.2352, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7375, dtype=torch.float64) delta_t tensor(-0.5555, dtype=torch.float64)
11 gae_duplicate tensor(-3.4459, dtype=torch.float64) tensor(4.4669, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-2.1767, dtype=torch.float64) delta_t tensor(-2.0101, dtype=torch.float64)
10 gae_duplicate tensor(-4.7668, dtype=torch.float64) tensor(10.0218, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6738, dtype=torch.float64) delta_t tensor(-0.4982, dtype=torch.float64)
9 gae_duplicate tensor(-4.3116, dtype=torch.float64) tensor(9.9667, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3862, dtype=torch.float64) delta_t tensor(-0.2565, dtype=torch.float64)
8 gae_duplicate tensor(-3.7057, dtype=torch.float64) tensor(7.5192, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0263, dtype=torch.float64) delta_t tensor(0.2777, dtype=torch.float64)
7 gae_duplicate tensor(-2.6869, dtype=torch.float64) tensor(3.4724, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7657, dtype=torch.float64) delta_t tensor(0.9691, dtype=torch.float64)
6 gae_duplicate tensor(-1.1803, dtype=torch.float64) tensor(2.3309, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.8389, dtype=torch.float64) delta_t tensor(0.5769, dtype=torch.float64)
5 gae_duplicate tensor(-0.3674, dtype=torch.float64) tensor(0.9670, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.5599, dtype=torch.float64) delta_t tensor(1.2278, dtype=torch.float64)
4 gae_duplicate tensor(0.9339, dtype=torch.float64) tensor(-1.7305, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.9978, dtype=torch.float64) delta_t tensor(2.0526, dtype=torch.float64)
3 gae_duplicate tensor(2.7997, dtype=torch.float64) tensor(-5.3360, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.9240, dtype=torch.float64) delta_t tensor(0.9533, dtype=torch.float64)
2 gae_duplicate tensor(3.1931, dtype=torch.float64) tensor(-6.0849, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-399.01275634765625
value loss:256.6336669921875
entropies:34.79695129394531
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(412.3504)
ToM Target loss= tensor(300.6072)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.657351016998291 seconds
19 rew tensor(-0.7165, dtype=torch.float64) delta_t tensor(-0.8189, dtype=torch.float64)
19 gae_duplicate tensor(-0.8189, dtype=torch.float64) tensor(1.8999, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7175, dtype=torch.float64) delta_t tensor(-0.7931, dtype=torch.float64)
18 gae_duplicate tensor(-1.4482, dtype=torch.float64) tensor(3.3992, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7186, dtype=torch.float64) delta_t tensor(-0.3872, dtype=torch.float64)
17 gae_duplicate tensor(-1.5458, dtype=torch.float64) tensor(3.5202, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7196, dtype=torch.float64) delta_t tensor(0.0101, dtype=torch.float64)
16 gae_duplicate tensor(-1.2265, dtype=torch.float64) tensor(3.7192, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7207, dtype=torch.float64) delta_t tensor(-0.3349, dtype=torch.float64)
15 gae_duplicate tensor(-1.3161, dtype=torch.float64) tensor(1.7101, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7218, dtype=torch.float64) delta_t tensor(-0.5015, dtype=torch.float64)
14 gae_duplicate tensor(-1.5544, dtype=torch.float64) tensor(2.6544, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7228, dtype=torch.float64) delta_t tensor(-0.5026, dtype=torch.float64)
13 gae_duplicate tensor(-1.7461, dtype=torch.float64) tensor(3.5458, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7239, dtype=torch.float64) delta_t tensor(-0.5037, dtype=torch.float64)
12 gae_duplicate tensor(-1.9006, dtype=torch.float64) tensor(4.6131, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7250, dtype=torch.float64) delta_t tensor(-0.5048, dtype=torch.float64)
11 gae_duplicate tensor(-2.0252, dtype=torch.float64) tensor(3.4583, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7261, dtype=torch.float64) delta_t tensor(-0.7084, dtype=torch.float64)
10 gae_duplicate tensor(-2.3286, dtype=torch.float64) tensor(3.2636, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7271, dtype=torch.float64) delta_t tensor(-0.5489, dtype=torch.float64)
9 gae_duplicate tensor(-2.4118, dtype=torch.float64) tensor(5.0391, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1611, dtype=torch.float64) delta_t tensor(-0.0375, dtype=torch.float64)
8 gae_duplicate tensor(-1.9669, dtype=torch.float64) tensor(6.1965, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5469, dtype=torch.float64) delta_t tensor(0.8584, dtype=torch.float64)
7 gae_duplicate tensor(-0.7152, dtype=torch.float64) tensor(1.2371, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.1845, dtype=torch.float64) delta_t tensor(1.1649, dtype=torch.float64)
6 gae_duplicate tensor(0.5927, dtype=torch.float64) tensor(-0.7012, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(1.4705, dtype=torch.float64) delta_t tensor(1.2260, dtype=torch.float64)
5 gae_duplicate tensor(1.7002, dtype=torch.float64) tensor(-3.2055, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.6801, dtype=torch.float64) delta_t tensor(2.7977, dtype=torch.float64)
4 gae_duplicate tensor(4.1579, dtype=torch.float64) tensor(-7.9498, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.5610, dtype=torch.float64) delta_t tensor(1.2779, dtype=torch.float64)
3 gae_duplicate tensor(4.6042, dtype=torch.float64) tensor(-8.9080, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(2.1378, dtype=torch.float64) delta_t tensor(2.4205, dtype=torch.float64)
2 gae_duplicate tensor(6.1038, dtype=torch.float64) tensor(-11.8028, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-71.17888641357422
value loss:174.2649688720703
entropies:34.761199951171875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.475771903991699 seconds
19 rew tensor(-0.7194, dtype=torch.float64) delta_t tensor(-0.3391, dtype=torch.float64)
19 gae_duplicate tensor(-0.3391, dtype=torch.float64) tensor(0.4579, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7204, dtype=torch.float64) delta_t tensor(-0.3965, dtype=torch.float64)
18 gae_duplicate tensor(-0.6677, dtype=torch.float64) tensor(1.5856, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7214, dtype=torch.float64) delta_t tensor(-1.0098, dtype=torch.float64)
17 gae_duplicate tensor(-1.5439, dtype=torch.float64) tensor(3.2910, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7224, dtype=torch.float64) delta_t tensor(0.0557, dtype=torch.float64)
16 gae_duplicate tensor(-1.1795, dtype=torch.float64) tensor(2.5001, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7234, dtype=torch.float64) delta_t tensor(-0.4262, dtype=torch.float64)
15 gae_duplicate tensor(-1.3698, dtype=torch.float64) tensor(1.7633, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7245, dtype=torch.float64) delta_t tensor(-0.5131, dtype=torch.float64)
14 gae_duplicate tensor(-1.6090, dtype=torch.float64) tensor(2.0711, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7255, dtype=torch.float64) delta_t tensor(-0.5113, dtype=torch.float64)
13 gae_duplicate tensor(-1.7984, dtype=torch.float64) tensor(5.7260, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7265, dtype=torch.float64) delta_t tensor(-0.5134, dtype=torch.float64)
12 gae_duplicate tensor(-1.9522, dtype=torch.float64) tensor(2.5060, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7276, dtype=torch.float64) delta_t tensor(-0.5040, dtype=torch.float64)
11 gae_duplicate tensor(-2.0657, dtype=torch.float64) tensor(5.1004, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7286, dtype=torch.float64) delta_t tensor(-0.6233, dtype=torch.float64)
10 gae_duplicate tensor(-2.2759, dtype=torch.float64) tensor(4.7533, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4445, dtype=torch.float64) delta_t tensor(-0.2509, dtype=torch.float64)
9 gae_duplicate tensor(-2.0715, dtype=torch.float64) tensor(4.9053, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1600, dtype=torch.float64) delta_t tensor(0.0249, dtype=torch.float64)
8 gae_duplicate tensor(-1.6324, dtype=torch.float64) tensor(2.0901, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1246, dtype=torch.float64) delta_t tensor(0.3635, dtype=torch.float64)
7 gae_duplicate tensor(-0.9424, dtype=torch.float64) tensor(1.5614, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6225, dtype=torch.float64) delta_t tensor(0.6030, dtype=torch.float64)
6 gae_duplicate tensor(-0.1510, dtype=torch.float64) tensor(0.1802, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3390, dtype=torch.float64) delta_t tensor(-0.1892, dtype=torch.float64)
5 gae_duplicate tensor(-0.3100, dtype=torch.float64) tensor(0.3612, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.8306, dtype=torch.float64) delta_t tensor(1.7524, dtype=torch.float64)
4 gae_duplicate tensor(1.5045, dtype=torch.float64) tensor(-1.7517, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.5536, dtype=torch.float64) delta_t tensor(1.7055, dtype=torch.float64)
3 gae_duplicate tensor(2.9090, dtype=torch.float64) tensor(-3.4041, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.2736, dtype=torch.float64) delta_t tensor(1.4110, dtype=torch.float64)
2 gae_duplicate tensor(3.7382, dtype=torch.float64) tensor(-9.9066, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-143.78147888183594
value loss:86.93438720703125
entropies:34.62064743041992
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.416215896606445 seconds
19 rew tensor(-0.7221, dtype=torch.float64) delta_t tensor(-0.5580, dtype=torch.float64)
19 gae_duplicate tensor(-0.5580, dtype=torch.float64) tensor(0.7484, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7231, dtype=torch.float64) delta_t tensor(-0.4545, dtype=torch.float64)
18 gae_duplicate tensor(-0.9009, dtype=torch.float64) tensor(1.8554, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7241, dtype=torch.float64) delta_t tensor(-0.8096, dtype=torch.float64)
17 gae_duplicate tensor(-1.5303, dtype=torch.float64) tensor(3.2619, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7251, dtype=torch.float64) delta_t tensor(0.0985, dtype=torch.float64)
16 gae_duplicate tensor(-1.1257, dtype=torch.float64) tensor(1.7886, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7261, dtype=torch.float64) delta_t tensor(-0.4150, dtype=torch.float64)
15 gae_duplicate tensor(-1.3156, dtype=torch.float64) tensor(1.6707, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7271, dtype=torch.float64) delta_t tensor(-0.5031, dtype=torch.float64)
14 gae_duplicate tensor(-1.5555, dtype=torch.float64) tensor(3.1473, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7281, dtype=torch.float64) delta_t tensor(-0.5032, dtype=torch.float64)
13 gae_duplicate tensor(-1.7477, dtype=torch.float64) tensor(4.8252, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7291, dtype=torch.float64) delta_t tensor(-0.5049, dtype=torch.float64)
12 gae_duplicate tensor(-1.9031, dtype=torch.float64) tensor(3.2756, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7301, dtype=torch.float64) delta_t tensor(-0.4861, dtype=torch.float64)
11 gae_duplicate tensor(-2.0086, dtype=torch.float64) tensor(4.9909, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7311, dtype=torch.float64) delta_t tensor(-0.6219, dtype=torch.float64)
10 gae_duplicate tensor(-2.2288, dtype=torch.float64) tensor(4.6972, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4466, dtype=torch.float64) delta_t tensor(-0.2182, dtype=torch.float64)
9 gae_duplicate tensor(-2.0012, dtype=torch.float64) tensor(2.7142, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0903, dtype=torch.float64) delta_t tensor(0.0910, dtype=torch.float64)
8 gae_duplicate tensor(-1.5100, dtype=torch.float64) tensor(3.0112, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1234, dtype=torch.float64) delta_t tensor(0.3987, dtype=torch.float64)
7 gae_duplicate tensor(-0.8093, dtype=torch.float64) tensor(1.3889, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.1918, dtype=torch.float64) delta_t tensor(1.1066, dtype=torch.float64)
6 gae_duplicate tensor(0.4591, dtype=torch.float64) tensor(-0.8703, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.9095, dtype=torch.float64) delta_t tensor(0.2223, dtype=torch.float64)
5 gae_duplicate tensor(0.5896, dtype=torch.float64) tensor(-0.6819, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.1220, dtype=torch.float64) delta_t tensor(2.3286, dtype=torch.float64)
4 gae_duplicate tensor(2.8003, dtype=torch.float64) tensor(-5.3554, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.8469, dtype=torch.float64) delta_t tensor(1.9038, dtype=torch.float64)
3 gae_duplicate tensor(4.1440, dtype=torch.float64) tensor(-7.9932, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.5680, dtype=torch.float64) delta_t tensor(1.7572, dtype=torch.float64)
2 gae_duplicate tensor(5.0724, dtype=torch.float64) tensor(-5.9222, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-100.35017395019531
value loss:124.20256042480469
entropies:34.52845001220703
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.50358510017395 seconds
19 rew tensor(-0.7240, dtype=torch.float64) delta_t tensor(-0.6445, dtype=torch.float64)
19 gae_duplicate tensor(-0.6445, dtype=torch.float64) tensor(0.8558, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7249, dtype=torch.float64) delta_t tensor(-0.6258, dtype=torch.float64)
18 gae_duplicate tensor(-1.1414, dtype=torch.float64) tensor(2.3511, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7259, dtype=torch.float64) delta_t tensor(-0.2753, dtype=torch.float64)
17 gae_duplicate tensor(-1.1884, dtype=torch.float64) tensor(2.5241, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7269, dtype=torch.float64) delta_t tensor(-0.0885, dtype=torch.float64)
16 gae_duplicate tensor(-1.0393, dtype=torch.float64) tensor(2.1746, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7278, dtype=torch.float64) delta_t tensor(-0.3840, dtype=torch.float64)
15 gae_duplicate tensor(-1.2154, dtype=torch.float64) tensor(1.5028, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7288, dtype=torch.float64) delta_t tensor(-0.4835, dtype=torch.float64)
14 gae_duplicate tensor(-1.4559, dtype=torch.float64) tensor(2.9139, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7298, dtype=torch.float64) delta_t tensor(-0.4845, dtype=torch.float64)
13 gae_duplicate tensor(-1.6492, dtype=torch.float64) tensor(4.1304, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7307, dtype=torch.float64) delta_t tensor(-0.4855, dtype=torch.float64)
12 gae_duplicate tensor(-1.8049, dtype=torch.float64) tensor(2.2316, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7317, dtype=torch.float64) delta_t tensor(-0.4865, dtype=torch.float64)
11 gae_duplicate tensor(-1.9304, dtype=torch.float64) tensor(3.3787, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7327, dtype=torch.float64) delta_t tensor(-0.6094, dtype=torch.float64)
10 gae_duplicate tensor(-2.1537, dtype=torch.float64) tensor(5.0681, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6623, dtype=torch.float64) delta_t tensor(-0.4544, dtype=torch.float64)
9 gae_duplicate tensor(-2.1774, dtype=torch.float64) tensor(3.4885, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3776, dtype=torch.float64) delta_t tensor(-0.2233, dtype=torch.float64)
8 gae_duplicate tensor(-1.9652, dtype=torch.float64) tensor(3.3864, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0213, dtype=torch.float64) delta_t tensor(0.3099, dtype=torch.float64)
7 gae_duplicate tensor(-1.2623, dtype=torch.float64) tensor(1.5496, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.9050, dtype=torch.float64) delta_t tensor(1.1501, dtype=torch.float64)
6 gae_duplicate tensor(0.1402, dtype=torch.float64) tensor(-0.1678, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.9777, dtype=torch.float64) delta_t tensor(0.9106, dtype=torch.float64)
5 gae_duplicate tensor(1.0228, dtype=torch.float64) tensor(-1.9538, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.6919, dtype=torch.float64) delta_t tensor(1.1694, dtype=torch.float64)
4 gae_duplicate tensor(1.9876, dtype=torch.float64) tensor(-3.7843, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(2.4114, dtype=torch.float64) delta_t tensor(2.3869, dtype=torch.float64)
3 gae_duplicate tensor(3.9770, dtype=torch.float64) tensor(-4.5664, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.0643, dtype=torch.float64) delta_t tensor(1.1261, dtype=torch.float64)
2 gae_duplicate tensor(4.3076, dtype=torch.float64) tensor(-4.9411, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-121.88587951660156
value loss:107.60199737548828
entropies:34.40812683105469
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.53902006149292 seconds
19 rew tensor(-0.7257, dtype=torch.float64) delta_t tensor(-0.1095, dtype=torch.float64)
19 gae_duplicate tensor(-0.1095, dtype=torch.float64) tensor(0.2264, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7266, dtype=torch.float64) delta_t tensor(-0.4623, dtype=torch.float64)
18 gae_duplicate tensor(-0.5500, dtype=torch.float64) tensor(1.1310, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7275, dtype=torch.float64) delta_t tensor(-1.0438, dtype=torch.float64)
17 gae_duplicate tensor(-1.4837, dtype=torch.float64) tensor(2.0068, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7284, dtype=torch.float64) delta_t tensor(-0.0785, dtype=torch.float64)
16 gae_duplicate tensor(-1.2655, dtype=torch.float64) tensor(3.0116, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7294, dtype=torch.float64) delta_t tensor(-0.1782, dtype=torch.float64)
15 gae_duplicate tensor(-1.1906, dtype=torch.float64) tensor(2.9873, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7303, dtype=torch.float64) delta_t tensor(-0.4790, dtype=torch.float64)
14 gae_duplicate tensor(-1.4315, dtype=torch.float64) tensor(2.8601, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7313, dtype=torch.float64) delta_t tensor(-0.4728, dtype=torch.float64)
13 gae_duplicate tensor(-1.6180, dtype=torch.float64) tensor(3.2493, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7322, dtype=torch.float64) delta_t tensor(-0.4741, dtype=torch.float64)
12 gae_duplicate tensor(-1.7686, dtype=torch.float64) tensor(5.8362, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7332, dtype=torch.float64) delta_t tensor(-0.4774, dtype=torch.float64)
11 gae_duplicate tensor(-1.8923, dtype=torch.float64) tensor(3.7619, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7341, dtype=torch.float64) delta_t tensor(-0.5859, dtype=torch.float64)
10 gae_duplicate tensor(-2.0997, dtype=torch.float64) tensor(2.7731, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5205, dtype=torch.float64) delta_t tensor(-0.2927, dtype=torch.float64)
9 gae_duplicate tensor(-1.9725, dtype=torch.float64) tensor(2.5841, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2351, dtype=torch.float64) delta_t tensor(-0.0477, dtype=torch.float64)
8 gae_duplicate tensor(-1.6257, dtype=torch.float64) tensor(4.1457, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0210, dtype=torch.float64) delta_t tensor(0.2820, dtype=torch.float64)
7 gae_duplicate tensor(-1.0186, dtype=torch.float64) tensor(2.5552, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.0495, dtype=torch.float64) delta_t tensor(0.9587, dtype=torch.float64)
6 gae_duplicate tensor(0.1438, dtype=torch.float64) tensor(-0.3868, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.7659, dtype=torch.float64) delta_t tensor(0.0272, dtype=torch.float64)
5 gae_duplicate tensor(0.1422, dtype=torch.float64) tensor(-0.3838, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.1225, dtype=torch.float64) delta_t tensor(2.3481, dtype=torch.float64)
4 gae_duplicate tensor(2.4619, dtype=torch.float64) tensor(-4.7112, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.8463, dtype=torch.float64) delta_t tensor(1.8792, dtype=torch.float64)
3 gae_duplicate tensor(3.8487, dtype=torch.float64) tensor(-7.3863, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.5665, dtype=torch.float64) delta_t tensor(1.7980, dtype=torch.float64)
2 gae_duplicate tensor(4.8770, dtype=torch.float64) tensor(-5.5136, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-113.50890350341797
value loss:110.38694763183594
entropies:34.23236083984375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(404.4116)
ToM Target loss= tensor(300.4662)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.382728099822998 seconds
19 rew tensor(-0.7271, dtype=torch.float64) delta_t tensor(-0.3006, dtype=torch.float64)
19 gae_duplicate tensor(-0.3006, dtype=torch.float64) tensor(0.3794, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7280, dtype=torch.float64) delta_t tensor(-0.2981, dtype=torch.float64)
18 gae_duplicate tensor(-0.5386, dtype=torch.float64) tensor(1.3371, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7289, dtype=torch.float64) delta_t tensor(-0.9230, dtype=torch.float64)
17 gae_duplicate tensor(-1.3539, dtype=torch.float64) tensor(3.1792, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7298, dtype=torch.float64) delta_t tensor(-0.2990, dtype=torch.float64)
16 gae_duplicate tensor(-1.3821, dtype=torch.float64) tensor(2.1986, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7307, dtype=torch.float64) delta_t tensor(-0.0968, dtype=torch.float64)
15 gae_duplicate tensor(-1.2025, dtype=torch.float64) tensor(2.4207, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7316, dtype=torch.float64) delta_t tensor(-0.4749, dtype=torch.float64)
14 gae_duplicate tensor(-1.4369, dtype=torch.float64) tensor(1.7250, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7325, dtype=torch.float64) delta_t tensor(-0.4681, dtype=torch.float64)
13 gae_duplicate tensor(-1.6176, dtype=torch.float64) tensor(4.1294, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7334, dtype=torch.float64) delta_t tensor(-0.4639, dtype=torch.float64)
12 gae_duplicate tensor(-1.7580, dtype=torch.float64) tensor(3.4968, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7344, dtype=torch.float64) delta_t tensor(-0.5206, dtype=torch.float64)
11 gae_duplicate tensor(-1.9270, dtype=torch.float64) tensor(6.5123, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7353, dtype=torch.float64) delta_t tensor(-0.5151, dtype=torch.float64)
10 gae_duplicate tensor(-2.0567, dtype=torch.float64) tensor(4.2669, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5925, dtype=torch.float64) delta_t tensor(-0.3632, dtype=torch.float64)
9 gae_duplicate tensor(-2.0085, dtype=torch.float64) tensor(4.9296, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3058, dtype=torch.float64) delta_t tensor(-0.0651, dtype=torch.float64)
8 gae_duplicate tensor(-1.6719, dtype=torch.float64) tensor(1.9686, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1247, dtype=torch.float64) delta_t tensor(0.4036, dtype=torch.float64)
7 gae_duplicate tensor(-0.9339, dtype=torch.float64) tensor(1.6032, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7703, dtype=torch.float64) delta_t tensor(0.6921, dtype=torch.float64)
6 gae_duplicate tensor(-0.0550, dtype=torch.float64) tensor(0.0609, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4845, dtype=torch.float64) delta_t tensor(-0.2760, dtype=torch.float64)
5 gae_duplicate tensor(-0.3200, dtype=torch.float64) tensor(0.3528, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.8465, dtype=torch.float64) delta_t tensor(1.8810, dtype=torch.float64)
4 gae_duplicate tensor(1.6250, dtype=torch.float64) tensor(-3.1078, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.5661, dtype=torch.float64) delta_t tensor(1.7895, dtype=torch.float64)
3 gae_duplicate tensor(3.0896, dtype=torch.float64) tensor(-3.4167, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.1392, dtype=torch.float64) delta_t tensor(1.3478, dtype=torch.float64)
2 gae_duplicate tensor(3.8194, dtype=torch.float64) tensor(-4.2246, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-167.8895721435547
value loss:83.79833984375
entropies:34.002197265625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.295198917388916 seconds
19 rew tensor(-0.7278, dtype=torch.float64) delta_t tensor(-0.4709, dtype=torch.float64)
19 gae_duplicate tensor(-0.4709, dtype=torch.float64) tensor(0.7759, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7286, dtype=torch.float64) delta_t tensor(-0.4143, dtype=torch.float64)
18 gae_duplicate tensor(-0.7910, dtype=torch.float64) tensor(0.9490, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7295, dtype=torch.float64) delta_t tensor(-0.5349, dtype=torch.float64)
17 gae_duplicate tensor(-1.1677, dtype=torch.float64) tensor(2.8031, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7304, dtype=torch.float64) delta_t tensor(-0.4355, dtype=torch.float64)
16 gae_duplicate tensor(-1.3697, dtype=torch.float64) tensor(3.3467, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7313, dtype=torch.float64) delta_t tensor(-0.0536, dtype=torch.float64)
15 gae_duplicate tensor(-1.1494, dtype=torch.float64) tensor(2.0143, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7321, dtype=torch.float64) delta_t tensor(-0.4593, dtype=torch.float64)
14 gae_duplicate tensor(-1.3788, dtype=torch.float64) tensor(3.9055, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7330, dtype=torch.float64) delta_t tensor(-0.4575, dtype=torch.float64)
13 gae_duplicate tensor(-1.5605, dtype=torch.float64) tensor(2.7449, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7339, dtype=torch.float64) delta_t tensor(-0.4355, dtype=torch.float64)
12 gae_duplicate tensor(-1.6839, dtype=torch.float64) tensor(3.3553, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7348, dtype=torch.float64) delta_t tensor(-0.4394, dtype=torch.float64)
11 gae_duplicate tensor(-1.7866, dtype=torch.float64) tensor(2.0372, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7357, dtype=torch.float64) delta_t tensor(-0.5743, dtype=torch.float64)
10 gae_duplicate tensor(-2.0036, dtype=torch.float64) tensor(4.1828, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7366, dtype=torch.float64) delta_t tensor(-0.4990, dtype=torch.float64)
9 gae_duplicate tensor(-2.1019, dtype=torch.float64) tensor(2.5925, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2350, dtype=torch.float64) delta_t tensor(-0.0489, dtype=torch.float64)
8 gae_duplicate tensor(-1.7304, dtype=torch.float64) tensor(3.4071, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1635, dtype=torch.float64) delta_t tensor(0.1758, dtype=torch.float64)
7 gae_duplicate tensor(-1.2085, dtype=torch.float64) tensor(2.4193, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.0549, dtype=torch.float64) delta_t tensor(0.9546, dtype=torch.float64)
6 gae_duplicate tensor(-0.0122, dtype=torch.float64) tensor(0.0336, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.7700, dtype=torch.float64) delta_t tensor(0.0699, dtype=torch.float64)
5 gae_duplicate tensor(0.0601, dtype=torch.float64) tensor(-0.0646, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.2759, dtype=torch.float64) delta_t tensor(2.4664, dtype=torch.float64)
4 gae_duplicate tensor(2.5145, dtype=torch.float64) tensor(-6.9393, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.9996, dtype=torch.float64) delta_t tensor(1.8874, dtype=torch.float64)
3 gae_duplicate tensor(3.8991, dtype=torch.float64) tensor(-13.9804, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.8635, dtype=torch.float64) delta_t tensor(2.1789, dtype=torch.float64)
2 gae_duplicate tensor(5.2982, dtype=torch.float64) tensor(-10.1102, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-21.84610366821289
value loss:117.38811492919922
entropies:33.688621520996094
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.584108591079712 seconds
19 rew tensor(-0.7294, dtype=torch.float64) delta_t tensor(0.1135, dtype=torch.float64)
19 gae_duplicate tensor(0.1135, dtype=torch.float64) tensor(-0.2861, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7303, dtype=torch.float64) delta_t tensor(-0.5015, dtype=torch.float64)
18 gae_duplicate tensor(-0.4107, dtype=torch.float64) tensor(0.4795, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7311, dtype=torch.float64) delta_t tensor(-0.7345, dtype=torch.float64)
17 gae_duplicate tensor(-1.0631, dtype=torch.float64) tensor(1.3196, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7320, dtype=torch.float64) delta_t tensor(-0.0025, dtype=torch.float64)
16 gae_duplicate tensor(-0.8530, dtype=torch.float64) tensor(1.7709, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7328, dtype=torch.float64) delta_t tensor(-0.4443, dtype=torch.float64)
15 gae_duplicate tensor(-1.1267, dtype=torch.float64) tensor(3.1973, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7337, dtype=torch.float64) delta_t tensor(-0.4682, dtype=torch.float64)
14 gae_duplicate tensor(-1.3696, dtype=torch.float64) tensor(2.4518, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7345, dtype=torch.float64) delta_t tensor(-0.4720, dtype=torch.float64)
13 gae_duplicate tensor(-1.5676, dtype=torch.float64) tensor(2.8123, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7354, dtype=torch.float64) delta_t tensor(-0.4914, dtype=torch.float64)
12 gae_duplicate tensor(-1.7455, dtype=torch.float64) tensor(4.6542, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7363, dtype=torch.float64) delta_t tensor(-0.4751, dtype=torch.float64)
11 gae_duplicate tensor(-1.8714, dtype=torch.float64) tensor(3.6999, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7372, dtype=torch.float64) delta_t tensor(-0.4988, dtype=torch.float64)
10 gae_duplicate tensor(-1.9959, dtype=torch.float64) tensor(5.0413, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5935, dtype=torch.float64) delta_t tensor(-0.3589, dtype=torch.float64)
9 gae_duplicate tensor(-1.9556, dtype=torch.float64) tensor(2.2536, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0162, dtype=torch.float64) delta_t tensor(0.2927, dtype=torch.float64)
8 gae_duplicate tensor(-1.2717, dtype=torch.float64) tensor(2.2365, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2724, dtype=torch.float64) delta_t tensor(0.5845, dtype=torch.float64)
7 gae_duplicate tensor(-0.4329, dtype=torch.float64) tensor(0.7423, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3448, dtype=torch.float64) delta_t tensor(0.2181, dtype=torch.float64)
6 gae_duplicate tensor(-0.1282, dtype=torch.float64) tensor(0.4667, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2009, dtype=torch.float64) delta_t tensor(-0.4241, dtype=torch.float64)
5 gae_duplicate tensor(-0.5267, dtype=torch.float64) tensor(1.0106, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.7136, dtype=torch.float64) delta_t tensor(1.8695, dtype=torch.float64)
4 gae_duplicate tensor(1.4482, dtype=torch.float64) tensor(-1.5279, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.1418, dtype=torch.float64) delta_t tensor(1.2995, dtype=torch.float64)
3 gae_duplicate tensor(2.4581, dtype=torch.float64) tensor(-6.8254, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8552, dtype=torch.float64) delta_t tensor(1.2029, dtype=torch.float64)
2 gae_duplicate tensor(3.1694, dtype=torch.float64) tensor(-3.3554, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-121.85480499267578
value loss:63.422149658203125
entropies:33.44328689575195
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.584270715713501 seconds
19 rew tensor(-0.7802, dtype=torch.float64) delta_t tensor(0.0973, dtype=torch.float64)
19 gae_duplicate tensor(0.0973, dtype=torch.float64) tensor(-0.1153, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.9247, dtype=torch.float64) delta_t tensor(-0.7241, dtype=torch.float64)
18 gae_duplicate tensor(-0.6462, dtype=torch.float64) tensor(1.3154, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-1.1413, dtype=torch.float64) delta_t tensor(-0.7041, dtype=torch.float64)
17 gae_duplicate tensor(-1.2211, dtype=torch.float64) tensor(1.4574, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-1.6458, dtype=torch.float64) delta_t tensor(-1.2151, dtype=torch.float64)
16 gae_duplicate tensor(-2.1920, dtype=torch.float64) tensor(2.5496, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-2.3691, dtype=torch.float64) delta_t tensor(-2.3398, dtype=torch.float64)
15 gae_duplicate tensor(-4.0934, dtype=torch.float64) tensor(8.0099, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7218, dtype=torch.float64) delta_t tensor(-0.4987, dtype=torch.float64)
14 gae_duplicate tensor(-3.7734, dtype=torch.float64) tensor(6.9880, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7226, dtype=torch.float64) delta_t tensor(-0.4995, dtype=torch.float64)
13 gae_duplicate tensor(-3.5182, dtype=torch.float64) tensor(6.8844, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7235, dtype=torch.float64) delta_t tensor(-0.5003, dtype=torch.float64)
12 gae_duplicate tensor(-3.3149, dtype=torch.float64) tensor(3.5526, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7243, dtype=torch.float64) delta_t tensor(-0.5011, dtype=torch.float64)
11 gae_duplicate tensor(-3.1530, dtype=torch.float64) tensor(3.3792, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7251, dtype=torch.float64) delta_t tensor(-0.2523, dtype=torch.float64)
10 gae_duplicate tensor(-2.7747, dtype=torch.float64) tensor(4.6113, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.9580, dtype=torch.float64) delta_t tensor(-2.6922, dtype=torch.float64)
9 gae_duplicate tensor(-4.9120, dtype=torch.float64) tensor(12.5282, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3864, dtype=torch.float64) delta_t tensor(-1.1239, dtype=torch.float64)
8 gae_duplicate tensor(-5.0535, dtype=torch.float64) tensor(5.8263, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3748, dtype=torch.float64) delta_t tensor(-0.1134, dtype=torch.float64)
7 gae_duplicate tensor(-4.1562, dtype=torch.float64) tensor(8.1102, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0855, dtype=torch.float64) delta_t tensor(0.2671, dtype=torch.float64)
6 gae_duplicate tensor(-3.0578, dtype=torch.float64) tensor(8.6160, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.7106, dtype=torch.float64) delta_t tensor(0.1172, dtype=torch.float64)
5 gae_duplicate tensor(-2.3290, dtype=torch.float64) tensor(4.4804, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.2902, dtype=torch.float64) delta_t tensor(1.2832, dtype=torch.float64)
4 gae_duplicate tensor(-0.5800, dtype=torch.float64) tensor(1.6276, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.7270, dtype=torch.float64) delta_t tensor(1.4909, dtype=torch.float64)
3 gae_duplicate tensor(1.0269, dtype=torch.float64) tensor(-2.0061, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.8772, dtype=torch.float64) delta_t tensor(2.1951, dtype=torch.float64)
2 gae_duplicate tensor(3.0166, dtype=torch.float64) tensor(-5.8076, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-433.0420227050781
value loss:256.3931579589844
entropies:33.19566345214844
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.496099948883057 seconds
19 rew tensor(-0.7102, dtype=torch.float64) delta_t tensor(-0.0632, dtype=torch.float64)
19 gae_duplicate tensor(-0.0632, dtype=torch.float64) tensor(0.0719, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7110, dtype=torch.float64) delta_t tensor(-0.2794, dtype=torch.float64)
18 gae_duplicate tensor(-0.3299, dtype=torch.float64) tensor(0.3685, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7117, dtype=torch.float64) delta_t tensor(-0.8641, dtype=torch.float64)
17 gae_duplicate tensor(-1.1281, dtype=torch.float64) tensor(1.3578, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7125, dtype=torch.float64) delta_t tensor(-0.2793, dtype=torch.float64)
16 gae_duplicate tensor(-1.1818, dtype=torch.float64) tensor(2.4543, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7133, dtype=torch.float64) delta_t tensor(-0.0171, dtype=torch.float64)
15 gae_duplicate tensor(-0.9625, dtype=torch.float64) tensor(1.0450, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7140, dtype=torch.float64) delta_t tensor(-0.4207, dtype=torch.float64)
14 gae_duplicate tensor(-1.1907, dtype=torch.float64) tensor(1.2908, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7148, dtype=torch.float64) delta_t tensor(-0.4143, dtype=torch.float64)
13 gae_duplicate tensor(-1.3669, dtype=torch.float64) tensor(1.4773, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7156, dtype=torch.float64) delta_t tensor(-0.4098, dtype=torch.float64)
12 gae_duplicate tensor(-1.5033, dtype=torch.float64) tensor(2.7268, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7164, dtype=torch.float64) delta_t tensor(-0.4290, dtype=torch.float64)
11 gae_duplicate tensor(-1.6317, dtype=torch.float64) tensor(2.9975, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7172, dtype=torch.float64) delta_t tensor(-0.5044, dtype=torch.float64)
10 gae_duplicate tensor(-1.8097, dtype=torch.float64) tensor(2.0536, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5742, dtype=torch.float64) delta_t tensor(-0.2541, dtype=torch.float64)
9 gae_duplicate tensor(-1.7019, dtype=torch.float64) tensor(1.9457, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1439, dtype=torch.float64) delta_t tensor(0.1043, dtype=torch.float64)
8 gae_duplicate tensor(-1.2572, dtype=torch.float64) tensor(1.3385, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0004, dtype=torch.float64) delta_t tensor(0.3451, dtype=torch.float64)
7 gae_duplicate tensor(-0.6606, dtype=torch.float64) tensor(1.3184, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6451, dtype=torch.float64) delta_t tensor(0.5103, dtype=torch.float64)
6 gae_duplicate tensor(-0.0182, dtype=torch.float64) tensor(0.0350, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3590, dtype=torch.float64) delta_t tensor(-0.3449, dtype=torch.float64)
5 gae_duplicate tensor(-0.3594, dtype=torch.float64) tensor(0.3671, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.8638, dtype=torch.float64) delta_t tensor(1.7793, dtype=torch.float64)
4 gae_duplicate tensor(1.4917, dtype=torch.float64) tensor(-1.5227, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.4393, dtype=torch.float64) delta_t tensor(1.5853, dtype=torch.float64)
3 gae_duplicate tensor(2.7787, dtype=torch.float64) tensor(-2.8439, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.2988, dtype=torch.float64) delta_t tensor(1.5983, dtype=torch.float64)
2 gae_duplicate tensor(3.8212, dtype=torch.float64) tensor(-7.3652, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-55.68970489501953
value loss:67.17459106445312
entropies:33.05027389526367
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(393.0611)
ToM Target loss= tensor(300.3680)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.299377202987671 seconds
19 rew tensor(-0.7099, dtype=torch.float64) delta_t tensor(0.2665, dtype=torch.float64)
19 gae_duplicate tensor(0.2665, dtype=torch.float64) tensor(-0.3014, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7107, dtype=torch.float64) delta_t tensor(-0.4602, dtype=torch.float64)
18 gae_duplicate tensor(-0.2470, dtype=torch.float64) tensor(0.4284, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7114, dtype=torch.float64) delta_t tensor(-1.0328, dtype=torch.float64)
17 gae_duplicate tensor(-1.2303, dtype=torch.float64) tensor(3.0556, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7122, dtype=torch.float64) delta_t tensor(-0.1152, dtype=torch.float64)
16 gae_duplicate tensor(-1.0994, dtype=torch.float64) tensor(2.7806, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7129, dtype=torch.float64) delta_t tensor(-1.2012e-05, dtype=torch.float64)
15 gae_duplicate tensor(-0.8796, dtype=torch.float64) tensor(2.5368, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7137, dtype=torch.float64) delta_t tensor(-0.4033, dtype=torch.float64)
14 gae_duplicate tensor(-1.1069, dtype=torch.float64) tensor(1.9891, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7144, dtype=torch.float64) delta_t tensor(-0.3953, dtype=torch.float64)
13 gae_duplicate tensor(-1.2808, dtype=torch.float64) tensor(2.5410, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7152, dtype=torch.float64) delta_t tensor(-0.3902, dtype=torch.float64)
12 gae_duplicate tensor(-1.4148, dtype=torch.float64) tensor(1.5122, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7159, dtype=torch.float64) delta_t tensor(-0.5362, dtype=torch.float64)
11 gae_duplicate tensor(-1.6681, dtype=torch.float64) tensor(1.7619, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7167, dtype=torch.float64) delta_t tensor(-0.3697, dtype=torch.float64)
10 gae_duplicate tensor(-1.7042, dtype=torch.float64) tensor(1.9701, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6452, dtype=torch.float64) delta_t tensor(-0.3508, dtype=torch.float64)
9 gae_duplicate tensor(-1.7141, dtype=torch.float64) tensor(3.4912, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5015, dtype=torch.float64) delta_t tensor(-0.2495, dtype=torch.float64)
8 gae_duplicate tensor(-1.6208, dtype=torch.float64) tensor(4.6929, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2854, dtype=torch.float64) delta_t tensor(0.0806, dtype=torch.float64)
7 gae_duplicate tensor(-1.2160, dtype=torch.float64) tensor(1.3582, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2913, dtype=torch.float64) delta_t tensor(0.4342, dtype=torch.float64)
6 gae_duplicate tensor(-0.5386, dtype=torch.float64) tensor(0.5485, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0688, dtype=torch.float64) delta_t tensor(-1.0225, dtype=torch.float64)
5 gae_duplicate tensor(-1.4534, dtype=torch.float64) tensor(1.4750, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.5877, dtype=torch.float64) delta_t tensor(1.5769, dtype=torch.float64)
4 gae_duplicate tensor(0.4142, dtype=torch.float64) tensor(-0.7976, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.4474, dtype=torch.float64) delta_t tensor(1.5669, dtype=torch.float64)
3 gae_duplicate tensor(1.8982, dtype=torch.float64) tensor(-3.6432, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.1620, dtype=torch.float64) delta_t tensor(1.4517, dtype=torch.float64)
2 gae_duplicate tensor(2.9702, dtype=torch.float64) tensor(-8.3956, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-103.01356506347656
value loss:54.338539123535156
entropies:33.013427734375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.160348176956177 seconds
19 rew tensor(-0.7114, dtype=torch.float64) delta_t tensor(0.2771, dtype=torch.float64)
19 gae_duplicate tensor(0.2771, dtype=torch.float64) tensor(-0.5697, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7121, dtype=torch.float64) delta_t tensor(-0.4653, dtype=torch.float64)
18 gae_duplicate tensor(-0.2436, dtype=torch.float64) tensor(0.4952, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7128, dtype=torch.float64) delta_t tensor(-0.8501, dtype=torch.float64)
17 gae_duplicate tensor(-1.0450, dtype=torch.float64) tensor(1.2550, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7136, dtype=torch.float64) delta_t tensor(0.2410, dtype=torch.float64)
16 gae_duplicate tensor(-0.5950, dtype=torch.float64) tensor(0.6949, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7143, dtype=torch.float64) delta_t tensor(-0.3038, dtype=torch.float64)
15 gae_duplicate tensor(-0.7798, dtype=torch.float64) tensor(0.8355, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7150, dtype=torch.float64) delta_t tensor(-0.3915, dtype=torch.float64)
14 gae_duplicate tensor(-1.0154, dtype=torch.float64) tensor(1.0879, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7158, dtype=torch.float64) delta_t tensor(-0.3954, dtype=torch.float64)
13 gae_duplicate tensor(-1.2077, dtype=torch.float64) tensor(2.3894, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7165, dtype=torch.float64) delta_t tensor(-0.4015, dtype=torch.float64)
12 gae_duplicate tensor(-1.3677, dtype=torch.float64) tensor(1.4594, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7173, dtype=torch.float64) delta_t tensor(-0.4107, dtype=torch.float64)
11 gae_duplicate tensor(-1.5048, dtype=torch.float64) tensor(2.7489, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7180, dtype=torch.float64) delta_t tensor(-0.4724, dtype=torch.float64)
10 gae_duplicate tensor(-1.6762, dtype=torch.float64) tensor(1.9370, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5737, dtype=torch.float64) delta_t tensor(-0.2608, dtype=torch.float64)
9 gae_duplicate tensor(-1.6018, dtype=torch.float64) tensor(4.7313, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2844, dtype=torch.float64) delta_t tensor(-0.0180, dtype=torch.float64)
8 gae_duplicate tensor(-1.2995, dtype=torch.float64) tensor(3.7530, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0051, dtype=torch.float64) delta_t tensor(0.3773, dtype=torch.float64)
7 gae_duplicate tensor(-0.6623, dtype=torch.float64) tensor(0.7336, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6564, dtype=torch.float64) delta_t tensor(0.5187, dtype=torch.float64)
6 gae_duplicate tensor(-0.0111, dtype=torch.float64) tensor(0.0113, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3677, dtype=torch.float64) delta_t tensor(-0.4490, dtype=torch.float64)
5 gae_duplicate tensor(-0.4579, dtype=torch.float64) tensor(0.4649, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.8863, dtype=torch.float64) delta_t tensor(1.8367, dtype=torch.float64)
4 gae_duplicate tensor(1.4704, dtype=torch.float64) tensor(-1.4915, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.6025, dtype=torch.float64) delta_t tensor(1.7527, dtype=torch.float64)
3 gae_duplicate tensor(2.9290, dtype=torch.float64) tensor(-8.2870, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.3165, dtype=torch.float64) delta_t tensor(1.6668, dtype=torch.float64)
2 gae_duplicate tensor(4.0100, dtype=torch.float64) tensor(-7.7287, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-28.111980438232422
value loss:65.02233123779297
entropies:33.01324462890625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.101778268814087 seconds
19 rew tensor(-0.7128, dtype=torch.float64) delta_t tensor(0.1605, dtype=torch.float64)
19 gae_duplicate tensor(0.1605, dtype=torch.float64) tensor(-0.3334, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7135, dtype=torch.float64) delta_t tensor(-0.3495, dtype=torch.float64)
18 gae_duplicate tensor(-0.2210, dtype=torch.float64) tensor(0.4537, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7142, dtype=torch.float64) delta_t tensor(-1.0478, dtype=torch.float64)
17 gae_duplicate tensor(-1.2246, dtype=torch.float64) tensor(1.5160, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7149, dtype=torch.float64) delta_t tensor(0.2036, dtype=torch.float64)
16 gae_duplicate tensor(-0.7761, dtype=torch.float64) tensor(1.9380, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7156, dtype=torch.float64) delta_t tensor(-0.1279, dtype=torch.float64)
15 gae_duplicate tensor(-0.7488, dtype=torch.float64) tensor(1.3250, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7164, dtype=torch.float64) delta_t tensor(-0.3792, dtype=torch.float64)
14 gae_duplicate tensor(-0.9782, dtype=torch.float64) tensor(2.8221, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7171, dtype=torch.float64) delta_t tensor(-0.3803, dtype=torch.float64)
13 gae_duplicate tensor(-1.1629, dtype=torch.float64) tensor(1.2726, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7178, dtype=torch.float64) delta_t tensor(-0.3822, dtype=torch.float64)
12 gae_duplicate tensor(-1.3125, dtype=torch.float64) tensor(3.7781, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7185, dtype=torch.float64) delta_t tensor(-0.4111, dtype=torch.float64)
11 gae_duplicate tensor(-1.4611, dtype=torch.float64) tensor(2.9005, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7192, dtype=torch.float64) delta_t tensor(-0.4634, dtype=torch.float64)
10 gae_duplicate tensor(-1.6323, dtype=torch.float64) tensor(2.6543, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5745, dtype=torch.float64) delta_t tensor(-0.2515, dtype=torch.float64)
9 gae_duplicate tensor(-1.5573, dtype=torch.float64) tensor(3.9517, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2841, dtype=torch.float64) delta_t tensor(-0.0102, dtype=torch.float64)
8 gae_duplicate tensor(-1.2561, dtype=torch.float64) tensor(1.3672, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0064, dtype=torch.float64) delta_t tensor(0.3913, dtype=torch.float64)
7 gae_duplicate tensor(-0.6136, dtype=torch.float64) tensor(0.6924, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6601, dtype=torch.float64) delta_t tensor(0.5131, dtype=torch.float64)
6 gae_duplicate tensor(0.0222, dtype=torch.float64) tensor(-0.0627, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3703, dtype=torch.float64) delta_t tensor(-0.4635, dtype=torch.float64)
5 gae_duplicate tensor(-0.4458, dtype=torch.float64) tensor(0.8574, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.8943, dtype=torch.float64) delta_t tensor(1.8456, dtype=torch.float64)
4 gae_duplicate tensor(1.4890, dtype=torch.float64) tensor(-4.2092, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.6094, dtype=torch.float64) delta_t tensor(1.7546, dtype=torch.float64)
3 gae_duplicate tensor(2.9458, dtype=torch.float64) tensor(-5.6534, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.3223, dtype=torch.float64) delta_t tensor(1.6826, dtype=torch.float64)
2 gae_duplicate tensor(4.0392, dtype=torch.float64) tensor(-7.7385, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-46.18611526489258
value loss:65.03575897216797
entropies:33.16783905029297
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.652790784835815 seconds
19 rew tensor(-0.7140, dtype=torch.float64) delta_t tensor(0.0222, dtype=torch.float64)
19 gae_duplicate tensor(0.0222, dtype=torch.float64) tensor(-0.0460, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7147, dtype=torch.float64) delta_t tensor(-0.2093, dtype=torch.float64)
18 gae_duplicate tensor(-0.1916, dtype=torch.float64) tensor(0.3961, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7154, dtype=torch.float64) delta_t tensor(-0.7350, dtype=torch.float64)
17 gae_duplicate tensor(-0.8883, dtype=torch.float64) tensor(1.1386, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7161, dtype=torch.float64) delta_t tensor(-0.3346, dtype=torch.float64)
16 gae_duplicate tensor(-1.0452, dtype=torch.float64) tensor(2.5351, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7168, dtype=torch.float64) delta_t tensor(0.0969, dtype=torch.float64)
15 gae_duplicate tensor(-0.7392, dtype=torch.float64) tensor(1.2787, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7175, dtype=torch.float64) delta_t tensor(-0.3719, dtype=torch.float64)
14 gae_duplicate tensor(-0.9632, dtype=torch.float64) tensor(2.5087, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7182, dtype=torch.float64) delta_t tensor(-0.3590, dtype=torch.float64)
13 gae_duplicate tensor(-1.1296, dtype=torch.float64) tensor(1.2720, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7189, dtype=torch.float64) delta_t tensor(-0.3503, dtype=torch.float64)
12 gae_duplicate tensor(-1.2539, dtype=torch.float64) tensor(1.4034, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7196, dtype=torch.float64) delta_t tensor(-0.3694, dtype=torch.float64)
11 gae_duplicate tensor(-1.3725, dtype=torch.float64) tensor(2.7394, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7203, dtype=torch.float64) delta_t tensor(-0.4755, dtype=torch.float64)
10 gae_duplicate tensor(-1.5735, dtype=torch.float64) tensor(1.9311, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5024, dtype=torch.float64) delta_t tensor(-0.1812, dtype=torch.float64)
9 gae_duplicate tensor(-1.4400, dtype=torch.float64) tensor(3.5853, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3571, dtype=torch.float64) delta_t tensor(-0.0942, dtype=torch.float64)
8 gae_duplicate tensor(-1.2461, dtype=torch.float64) tensor(1.3801, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1390, dtype=torch.float64) delta_t tensor(0.2677, dtype=torch.float64)
7 gae_duplicate tensor(-0.7292, dtype=torch.float64) tensor(0.8363, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.8065, dtype=torch.float64) delta_t tensor(0.6644, dtype=torch.float64)
6 gae_duplicate tensor(0.0811, dtype=torch.float64) tensor(-0.1560, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.5165, dtype=torch.float64) delta_t tensor(-0.3765, dtype=torch.float64)
5 gae_duplicate tensor(-0.3117, dtype=torch.float64) tensor(0.5991, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.0434, dtype=torch.float64) delta_t tensor(2.3192, dtype=torch.float64)
4 gae_duplicate tensor(2.0698, dtype=torch.float64) tensor(-2.1374, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.9047, dtype=torch.float64) delta_t tensor(1.7727, dtype=torch.float64)
3 gae_duplicate tensor(3.4286, dtype=torch.float64) tensor(-3.5490, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.6186, dtype=torch.float64) delta_t tensor(2.0191, dtype=torch.float64)
2 gae_duplicate tensor(4.7620, dtype=torch.float64) tensor(-4.9432, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-65.63546752929688
value loss:80.36756134033203
entropies:33.375404357910156
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.46809196472168 seconds
19 rew tensor(-0.7151, dtype=torch.float64) delta_t tensor(-0.2730, dtype=torch.float64)
19 gae_duplicate tensor(-0.2730, dtype=torch.float64) tensor(0.9081, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7158, dtype=torch.float64) delta_t tensor(-0.6321, dtype=torch.float64)
18 gae_duplicate tensor(-0.8505, dtype=torch.float64) tensor(1.0273, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7165, dtype=torch.float64) delta_t tensor(-0.1409, dtype=torch.float64)
17 gae_duplicate tensor(-0.8213, dtype=torch.float64) tensor(1.9495, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7172, dtype=torch.float64) delta_t tensor(-0.1552, dtype=torch.float64)
16 gae_duplicate tensor(-0.8123, dtype=torch.float64) tensor(1.2538, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7179, dtype=torch.float64) delta_t tensor(0.0543, dtype=torch.float64)
15 gae_duplicate tensor(-0.5955, dtype=torch.float64) tensor(1.5574, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7185, dtype=torch.float64) delta_t tensor(-0.3449, dtype=torch.float64)
14 gae_duplicate tensor(-0.8213, dtype=torch.float64) tensor(2.3706, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7192, dtype=torch.float64) delta_t tensor(-0.3463, dtype=torch.float64)
13 gae_duplicate tensor(-1.0034, dtype=torch.float64) tensor(1.1339, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7199, dtype=torch.float64) delta_t tensor(-0.3487, dtype=torch.float64)
12 gae_duplicate tensor(-1.1514, dtype=torch.float64) tensor(2.0075, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7206, dtype=torch.float64) delta_t tensor(-0.3541, dtype=torch.float64)
11 gae_duplicate tensor(-1.2752, dtype=torch.float64) tensor(1.4313, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7213, dtype=torch.float64) delta_t tensor(-0.5050, dtype=torch.float64)
10 gae_duplicate tensor(-1.5251, dtype=torch.float64) tensor(3.7263, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7220, dtype=torch.float64) delta_t tensor(-0.3878, dtype=torch.float64)
9 gae_duplicate tensor(-1.6079, dtype=torch.float64) tensor(1.9922, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2131, dtype=torch.float64) delta_t tensor(-0.0100, dtype=torch.float64)
8 gae_duplicate tensor(-1.2963, dtype=torch.float64) tensor(1.4572, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0050, dtype=torch.float64) delta_t tensor(0.4696, dtype=torch.float64)
7 gae_duplicate tensor(-0.5674, dtype=torch.float64) tensor(0.6633, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.9501, dtype=torch.float64) delta_t tensor(0.7786, dtype=torch.float64)
6 gae_duplicate tensor(0.3247, dtype=torch.float64) tensor(-0.6204, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.6605, dtype=torch.float64) delta_t tensor(0.0061, dtype=torch.float64)
5 gae_duplicate tensor(0.2658, dtype=torch.float64) tensor(-0.2756, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.3326, dtype=torch.float64) delta_t tensor(2.4280, dtype=torch.float64)
4 gae_duplicate tensor(2.6407, dtype=torch.float64) tensor(-5.0777, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(2.0507, dtype=torch.float64) delta_t tensor(1.8848, dtype=torch.float64)
3 gae_duplicate tensor(3.9973, dtype=torch.float64) tensor(-4.1489, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.7654, dtype=torch.float64) delta_t tensor(2.1727, dtype=torch.float64)
2 gae_duplicate tensor(5.3705, dtype=torch.float64) tensor(-10.3486, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-7.046121597290039
value loss:99.00590515136719
entropies:33.445716857910156
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(397.9797)
ToM Target loss= tensor(300.3145)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.5208940505981445 seconds
19 rew tensor(-0.7147, dtype=torch.float64) delta_t tensor(-0.3304, dtype=torch.float64)
19 gae_duplicate tensor(-0.3304, dtype=torch.float64) tensor(0.5199, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7154, dtype=torch.float64) delta_t tensor(-0.4723, dtype=torch.float64)
18 gae_duplicate tensor(-0.7365, dtype=torch.float64) tensor(2.1797, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7161, dtype=torch.float64) delta_t tensor(-0.5503, dtype=torch.float64)
17 gae_duplicate tensor(-1.1396, dtype=torch.float64) tensor(3.4903, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7167, dtype=torch.float64) delta_t tensor(0.1581, dtype=torch.float64)
16 gae_duplicate tensor(-0.7535, dtype=torch.float64) tensor(1.1500, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7174, dtype=torch.float64) delta_t tensor(-0.1179, dtype=torch.float64)
15 gae_duplicate tensor(-0.7208, dtype=torch.float64) tensor(1.4523, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7181, dtype=torch.float64) delta_t tensor(-0.3784, dtype=torch.float64)
14 gae_duplicate tensor(-0.9550, dtype=torch.float64) tensor(2.7706, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7187, dtype=torch.float64) delta_t tensor(-0.3781, dtype=torch.float64)
13 gae_duplicate tensor(-1.1422, dtype=torch.float64) tensor(2.9731, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7194, dtype=torch.float64) delta_t tensor(-0.3788, dtype=torch.float64)
12 gae_duplicate tensor(-1.2925, dtype=torch.float64) tensor(2.5888, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7201, dtype=torch.float64) delta_t tensor(-0.3707, dtype=torch.float64)
11 gae_duplicate tensor(-1.4047, dtype=torch.float64) tensor(1.5872, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7207, dtype=torch.float64) delta_t tensor(-0.3976, dtype=torch.float64)
10 gae_duplicate tensor(-1.5213, dtype=torch.float64) tensor(1.9123, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7214, dtype=torch.float64) delta_t tensor(-0.3742, dtype=torch.float64)
9 gae_duplicate tensor(-1.5912, dtype=torch.float64) tensor(4.7653, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7221, dtype=torch.float64) delta_t tensor(-0.4570, dtype=torch.float64)
8 gae_duplicate tensor(-1.7299, dtype=torch.float64) tensor(3.4728, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1415, dtype=torch.float64) delta_t tensor(0.3223, dtype=torch.float64)
7 gae_duplicate tensor(-1.0616, dtype=torch.float64) tensor(2.7160, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.0928, dtype=torch.float64) delta_t tensor(0.8709, dtype=torch.float64)
6 gae_duplicate tensor(0.0216, dtype=torch.float64) tensor(-0.0224, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.8038, dtype=torch.float64) delta_t tensor(0.6130, dtype=torch.float64)
5 gae_duplicate tensor(0.6303, dtype=torch.float64) tensor(-0.6515, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.4745, dtype=torch.float64) delta_t tensor(2.1317, dtype=torch.float64)
4 gae_duplicate tensor(2.6360, dtype=torch.float64) tensor(-7.4193, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(2.1942, dtype=torch.float64) delta_t tensor(2.1049, dtype=torch.float64)
3 gae_duplicate tensor(4.2137, dtype=torch.float64) tensor(-8.1511, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.7641, dtype=torch.float64) delta_t tensor(2.2447, dtype=torch.float64)
2 gae_duplicate tensor(5.6157, dtype=torch.float64) tensor(-10.7298, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-28.628612518310547
value loss:111.751708984375
entropies:33.47227096557617
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.458846092224121 seconds
19 rew tensor(-0.7160, dtype=torch.float64) delta_t tensor(-0.0494, dtype=torch.float64)
19 gae_duplicate tensor(-0.0494, dtype=torch.float64) tensor(0.1197, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7166, dtype=torch.float64) delta_t tensor(-0.2207, dtype=torch.float64)
18 gae_duplicate tensor(-0.2602, dtype=torch.float64) tensor(0.6400, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7173, dtype=torch.float64) delta_t tensor(-0.6051, dtype=torch.float64)
17 gae_duplicate tensor(-0.8132, dtype=torch.float64) tensor(1.1800, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7179, dtype=torch.float64) delta_t tensor(-0.5771, dtype=torch.float64)
16 gae_duplicate tensor(-1.2277, dtype=torch.float64) tensor(1.5820, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7186, dtype=torch.float64) delta_t tensor(0.3606, dtype=torch.float64)
15 gae_duplicate tensor(-0.6215, dtype=torch.float64) tensor(1.0353, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7192, dtype=torch.float64) delta_t tensor(-0.3543, dtype=torch.float64)
14 gae_duplicate tensor(-0.8515, dtype=torch.float64) tensor(1.4220, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7199, dtype=torch.float64) delta_t tensor(-0.3506, dtype=torch.float64)
13 gae_duplicate tensor(-1.0318, dtype=torch.float64) tensor(2.6522, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7206, dtype=torch.float64) delta_t tensor(-0.3497, dtype=torch.float64)
12 gae_duplicate tensor(-1.1751, dtype=torch.float64) tensor(1.3585, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7212, dtype=torch.float64) delta_t tensor(-0.3846, dtype=torch.float64)
11 gae_duplicate tensor(-1.3246, dtype=torch.float64) tensor(3.4627, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7219, dtype=torch.float64) delta_t tensor(-0.3816, dtype=torch.float64)
10 gae_duplicate tensor(-1.4413, dtype=torch.float64) tensor(3.0981, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5769, dtype=torch.float64) delta_t tensor(-0.2155, dtype=torch.float64)
9 gae_duplicate tensor(-1.3686, dtype=torch.float64) tensor(1.7137, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0677, dtype=torch.float64) delta_t tensor(0.1906, dtype=torch.float64)
8 gae_duplicate tensor(-0.9042, dtype=torch.float64) tensor(1.5661, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0050, dtype=torch.float64) delta_t tensor(0.4911, dtype=torch.float64)
7 gae_duplicate tensor(-0.2323, dtype=torch.float64) tensor(0.2635, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.2412, dtype=torch.float64) delta_t tensor(0.9522, dtype=torch.float64)
6 gae_duplicate tensor(0.7663, dtype=torch.float64) tensor(-0.7920, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.9521, dtype=torch.float64) delta_t tensor(0.0632, dtype=torch.float64)
5 gae_duplicate tensor(0.6763, dtype=torch.float64) tensor(-1.3006, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.0443, dtype=torch.float64) delta_t tensor(2.3210, dtype=torch.float64)
4 gae_duplicate tensor(2.8620, dtype=torch.float64) tensor(-2.9464, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.6135, dtype=torch.float64) delta_t tensor(1.5684, dtype=torch.float64)
3 gae_duplicate tensor(3.8580, dtype=torch.float64) tensor(-7.4725, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.4711, dtype=torch.float64) delta_t tensor(1.7907, dtype=torch.float64)
2 gae_duplicate tensor(4.8771, dtype=torch.float64) tensor(-13.6771, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:35.563472747802734
value loss:90.41707611083984
entropies:33.481231689453125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.2312331199646 seconds
19 rew tensor(-0.7172, dtype=torch.float64) delta_t tensor(0.0372, dtype=torch.float64)
19 gae_duplicate tensor(0.0372, dtype=torch.float64) tensor(-0.0787, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7179, dtype=torch.float64) delta_t tensor(-0.1142, dtype=torch.float64)
18 gae_duplicate tensor(-0.0844, dtype=torch.float64) tensor(0.2089, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7185, dtype=torch.float64) delta_t tensor(-0.9603, dtype=torch.float64)
17 gae_duplicate tensor(-1.0278, dtype=torch.float64) tensor(2.3791, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7191, dtype=torch.float64) delta_t tensor(0.2565, dtype=torch.float64)
16 gae_duplicate tensor(-0.5658, dtype=torch.float64) tensor(0.7286, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7198, dtype=torch.float64) delta_t tensor(-0.0868, dtype=torch.float64)
15 gae_duplicate tensor(-0.5394, dtype=torch.float64) tensor(1.0939, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7204, dtype=torch.float64) delta_t tensor(-0.3400, dtype=torch.float64)
14 gae_duplicate tensor(-0.7715, dtype=torch.float64) tensor(1.5628, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7210, dtype=torch.float64) delta_t tensor(-0.3406, dtype=torch.float64)
13 gae_duplicate tensor(-0.9578, dtype=torch.float64) tensor(1.9658, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7217, dtype=torch.float64) delta_t tensor(-0.3415, dtype=torch.float64)
12 gae_duplicate tensor(-1.1078, dtype=torch.float64) tensor(2.2707, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7223, dtype=torch.float64) delta_t tensor(-0.3525, dtype=torch.float64)
11 gae_duplicate tensor(-1.2387, dtype=torch.float64) tensor(2.4896, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7230, dtype=torch.float64) delta_t tensor(-0.3974, dtype=torch.float64)
10 gae_duplicate tensor(-1.3884, dtype=torch.float64) tensor(1.7767, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5050, dtype=torch.float64) delta_t tensor(-0.1452, dtype=torch.float64)
9 gae_duplicate tensor(-1.2559, dtype=torch.float64) tensor(1.5835, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2140, dtype=torch.float64) delta_t tensor(0.0633, dtype=torch.float64)
8 gae_duplicate tensor(-0.9414, dtype=torch.float64) tensor(1.9035, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0042, dtype=torch.float64) delta_t tensor(0.4892, dtype=torch.float64)
7 gae_duplicate tensor(-0.2640, dtype=torch.float64) tensor(0.4433, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.2410, dtype=torch.float64) delta_t tensor(0.9679, dtype=torch.float64)
6 gae_duplicate tensor(0.7567, dtype=torch.float64) tensor(-1.4328, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.9518, dtype=torch.float64) delta_t tensor(-0.0791, dtype=torch.float64)
5 gae_duplicate tensor(0.5263, dtype=torch.float64) tensor(-1.0118, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.1899, dtype=torch.float64) delta_t tensor(2.5175, dtype=torch.float64)
4 gae_duplicate tensor(2.9385, dtype=torch.float64) tensor(-8.2699, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.9057, dtype=torch.float64) delta_t tensor(1.8172, dtype=torch.float64)
3 gae_duplicate tensor(4.1680, dtype=torch.float64) tensor(-8.0573, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.6188, dtype=torch.float64) delta_t tensor(2.1396, dtype=torch.float64)
2 gae_duplicate tensor(5.4740, dtype=torch.float64) tensor(-5.6818, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:35.749412536621094
value loss:100.84838104248047
entropies:33.529945373535156
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4411351680755615 seconds
19 rew tensor(-0.7185, dtype=torch.float64) delta_t tensor(0.2072, dtype=torch.float64)
19 gae_duplicate tensor(0.2072, dtype=torch.float64) tensor(-0.4485, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7191, dtype=torch.float64) delta_t tensor(-0.1535, dtype=torch.float64)
18 gae_duplicate tensor(0.0123, dtype=torch.float64) tensor(-0.0191, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7198, dtype=torch.float64) delta_t tensor(-1.0322, dtype=torch.float64)
17 gae_duplicate tensor(-1.0223, dtype=torch.float64) tensor(2.3702, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7204, dtype=torch.float64) delta_t tensor(0.4128, dtype=torch.float64)
16 gae_duplicate tensor(-0.4051, dtype=torch.float64) tensor(0.5307, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7210, dtype=torch.float64) delta_t tensor(-0.1719, dtype=torch.float64)
15 gae_duplicate tensor(-0.4960, dtype=torch.float64) tensor(0.8199, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7216, dtype=torch.float64) delta_t tensor(-0.3322, dtype=torch.float64)
14 gae_duplicate tensor(-0.7290, dtype=torch.float64) tensor(1.4865, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7223, dtype=torch.float64) delta_t tensor(-0.3334, dtype=torch.float64)
13 gae_duplicate tensor(-0.9166, dtype=torch.float64) tensor(1.5232, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7229, dtype=torch.float64) delta_t tensor(-0.3350, dtype=torch.float64)
12 gae_duplicate tensor(-1.0683, dtype=torch.float64) tensor(1.2583, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7235, dtype=torch.float64) delta_t tensor(-0.3416, dtype=torch.float64)
11 gae_duplicate tensor(-1.1962, dtype=torch.float64) tensor(2.0093, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7242, dtype=torch.float64) delta_t tensor(-0.3940, dtype=torch.float64)
10 gae_duplicate tensor(-1.3510, dtype=torch.float64) tensor(1.7388, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7248, dtype=torch.float64) delta_t tensor(-0.3473, dtype=torch.float64)
9 gae_duplicate tensor(-1.4281, dtype=torch.float64) tensor(3.4082, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1421, dtype=torch.float64) delta_t tensor(0.1473, dtype=torch.float64)
8 gae_duplicate tensor(-0.9951, dtype=torch.float64) tensor(2.0393, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2950, dtype=torch.float64) delta_t tensor(0.7825, dtype=torch.float64)
7 gae_duplicate tensor(-0.0136, dtype=torch.float64) tensor(0.0341, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.0964, dtype=torch.float64) delta_t tensor(0.7583, dtype=torch.float64)
6 gae_duplicate tensor(0.7475, dtype=torch.float64) tensor(-1.4465, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.8064, dtype=torch.float64) delta_t tensor(-0.2337, dtype=torch.float64)
5 gae_duplicate tensor(0.3643, dtype=torch.float64) tensor(-0.3773, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.3365, dtype=torch.float64) delta_t tensor(2.3607, dtype=torch.float64)
4 gae_duplicate tensor(2.6521, dtype=torch.float64) tensor(-7.4456, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.7612, dtype=torch.float64) delta_t tensor(1.9148, dtype=torch.float64)
3 gae_duplicate tensor(4.0365, dtype=torch.float64) tensor(-4.1977, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.3267, dtype=torch.float64) delta_t tensor(1.8335, dtype=torch.float64)
2 gae_duplicate tensor(5.0627, dtype=torch.float64) tensor(-14.2443, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:64.75469207763672
value loss:89.91848754882812
entropies:33.612483978271484
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4622979164123535 seconds
19 rew tensor(-0.7210, dtype=torch.float64) delta_t tensor(0.5532, dtype=torch.float64)
19 gae_duplicate tensor(0.5532, dtype=torch.float64) tensor(-0.7214, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7216, dtype=torch.float64) delta_t tensor(-0.4103, dtype=torch.float64)
18 gae_duplicate tensor(0.0322, dtype=torch.float64) tensor(-0.0411, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7222, dtype=torch.float64) delta_t tensor(-0.5831, dtype=torch.float64)
17 gae_duplicate tensor(-0.5573, dtype=torch.float64) tensor(1.2432, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7228, dtype=torch.float64) delta_t tensor(0.2411, dtype=torch.float64)
16 gae_duplicate tensor(-0.2048, dtype=torch.float64) tensor(0.2719, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7234, dtype=torch.float64) delta_t tensor(-0.1704, dtype=torch.float64)
15 gae_duplicate tensor(-0.3343, dtype=torch.float64) tensor(0.6924, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7240, dtype=torch.float64) delta_t tensor(-0.3052, dtype=torch.float64)
14 gae_duplicate tensor(-0.5726, dtype=torch.float64) tensor(0.6849, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7246, dtype=torch.float64) delta_t tensor(-0.3058, dtype=torch.float64)
13 gae_duplicate tensor(-0.7638, dtype=torch.float64) tensor(1.5661, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7253, dtype=torch.float64) delta_t tensor(-0.3064, dtype=torch.float64)
12 gae_duplicate tensor(-0.9175, dtype=torch.float64) tensor(1.0974, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7259, dtype=torch.float64) delta_t tensor(-0.3122, dtype=torch.float64)
11 gae_duplicate tensor(-1.0461, dtype=torch.float64) tensor(2.1645, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7265, dtype=torch.float64) delta_t tensor(-0.4765, dtype=torch.float64)
10 gae_duplicate tensor(-1.3134, dtype=torch.float64) tensor(1.9562, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7271, dtype=torch.float64) delta_t tensor(-0.4639, dtype=torch.float64)
9 gae_duplicate tensor(-1.5146, dtype=torch.float64) tensor(3.7002, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2914, dtype=torch.float64) delta_t tensor(0.4851, dtype=torch.float64)
8 gae_duplicate tensor(-0.7266, dtype=torch.float64) tensor(1.4909, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(1.0192, dtype=torch.float64) delta_t tensor(1.4402, dtype=torch.float64)
7 gae_duplicate tensor(0.8589, dtype=torch.float64) tensor(-1.0039, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.3842, dtype=torch.float64) delta_t tensor(1.2090, dtype=torch.float64)
6 gae_duplicate tensor(1.8962, dtype=torch.float64) tensor(-3.2484, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(1.0953, dtype=torch.float64) delta_t tensor(1.3879, dtype=torch.float64)
5 gae_duplicate tensor(2.9048, dtype=torch.float64) tensor(-3.0379, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.7520, dtype=torch.float64) delta_t tensor(1.0986, dtype=torch.float64)
4 gae_duplicate tensor(3.4224, dtype=torch.float64) tensor(-9.6537, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(2.6307, dtype=torch.float64) delta_t tensor(2.8898, dtype=torch.float64)
3 gae_duplicate tensor(5.6278, dtype=torch.float64) tensor(-10.8408, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.9604, dtype=torch.float64) delta_t tensor(0.8681, dtype=torch.float64)
2 gae_duplicate tensor(5.3703, dtype=torch.float64) tensor(-10.2905, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:142.8079833984375
value loss:139.74310302734375
entropies:33.742828369140625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(400.7713)
ToM Target loss= tensor(300.0387)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.406343936920166 seconds
19 rew tensor(-0.7225, dtype=torch.float64) delta_t tensor(0.3169, dtype=torch.float64)
19 gae_duplicate tensor(0.3169, dtype=torch.float64) tensor(-0.4206, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7231, dtype=torch.float64) delta_t tensor(-0.2095, dtype=torch.float64)
18 gae_duplicate tensor(0.0440, dtype=torch.float64) tensor(-0.0949, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7237, dtype=torch.float64) delta_t tensor(-0.7722, dtype=torch.float64)
17 gae_duplicate tensor(-0.7370, dtype=torch.float64) tensor(1.6580, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7243, dtype=torch.float64) delta_t tensor(0.3882, dtype=torch.float64)
16 gae_duplicate tensor(-0.2014, dtype=torch.float64) tensor(0.2974, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7249, dtype=torch.float64) delta_t tensor(-0.3125, dtype=torch.float64)
15 gae_duplicate tensor(-0.4736, dtype=torch.float64) tensor(1.1724, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7255, dtype=torch.float64) delta_t tensor(-0.3335, dtype=torch.float64)
14 gae_duplicate tensor(-0.7124, dtype=torch.float64) tensor(1.1768, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7261, dtype=torch.float64) delta_t tensor(-0.3414, dtype=torch.float64)
13 gae_duplicate tensor(-0.9113, dtype=torch.float64) tensor(1.8879, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7267, dtype=torch.float64) delta_t tensor(-0.3362, dtype=torch.float64)
12 gae_duplicate tensor(-1.0652, dtype=torch.float64) tensor(2.6419, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7274, dtype=torch.float64) delta_t tensor(-0.3368, dtype=torch.float64)
11 gae_duplicate tensor(-1.1890, dtype=torch.float64) tensor(2.9488, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7280, dtype=torch.float64) delta_t tensor(-0.3788, dtype=torch.float64)
10 gae_duplicate tensor(-1.3300, dtype=torch.float64) tensor(2.8966, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5827, dtype=torch.float64) delta_t tensor(-0.1566, dtype=torch.float64)
9 gae_duplicate tensor(-1.2206, dtype=torch.float64) tensor(2.6317, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(3.8846e-16, dtype=torch.float64) delta_t tensor(0.2941, dtype=torch.float64)
8 gae_duplicate tensor(-0.6824, dtype=torch.float64) tensor(0.8195, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2914, dtype=torch.float64) delta_t tensor(0.8017, dtype=torch.float64)
7 gae_duplicate tensor(0.2558, dtype=torch.float64) tensor(-0.3119, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.2382, dtype=torch.float64) delta_t tensor(0.8508, dtype=torch.float64)
6 gae_duplicate tensor(1.0555, dtype=torch.float64) tensor(-1.1540, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.9486, dtype=torch.float64) delta_t tensor(-0.0934, dtype=torch.float64)
5 gae_duplicate tensor(0.7509, dtype=torch.float64) tensor(-1.4408, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.1878, dtype=torch.float64) delta_t tensor(2.2158, dtype=torch.float64)
4 gae_duplicate tensor(2.8166, dtype=torch.float64) tensor(-5.4059, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.6109, dtype=torch.float64) delta_t tensor(1.7469, dtype=torch.float64)
3 gae_duplicate tensor(4.0001, dtype=torch.float64) tensor(-4.2722, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.3219, dtype=torch.float64) delta_t tensor(1.8385, dtype=torch.float64)
2 gae_duplicate tensor(5.0386, dtype=torch.float64) tensor(-5.3837, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1.1024608612060547
value loss:89.3797607421875
entropies:33.88447189331055
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.376964092254639 seconds
19 rew tensor(-0.7200, dtype=torch.float64) delta_t tensor(0.6600, dtype=torch.float64)
19 gae_duplicate tensor(0.6600, dtype=torch.float64) tensor(-1.5282, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7206, dtype=torch.float64) delta_t tensor(-0.3541, dtype=torch.float64)
18 gae_duplicate tensor(0.1739, dtype=torch.float64) tensor(-0.2277, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7211, dtype=torch.float64) delta_t tensor(-0.0765, dtype=torch.float64)
17 gae_duplicate tensor(0.0626, dtype=torch.float64) tensor(-0.1397, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7217, dtype=torch.float64) delta_t tensor(-0.1682, dtype=torch.float64)
16 gae_duplicate tensor(-0.1181, dtype=torch.float64) tensor(0.1577, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7223, dtype=torch.float64) delta_t tensor(-0.3589, dtype=torch.float64)
15 gae_duplicate tensor(-0.4533, dtype=torch.float64) tensor(0.7603, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7229, dtype=torch.float64) delta_t tensor(-0.3286, dtype=torch.float64)
14 gae_duplicate tensor(-0.6912, dtype=torch.float64) tensor(0.8336, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7235, dtype=torch.float64) delta_t tensor(-0.3291, dtype=torch.float64)
13 gae_duplicate tensor(-0.8821, dtype=torch.float64) tensor(2.2301, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7241, dtype=torch.float64) delta_t tensor(-0.3297, dtype=torch.float64)
12 gae_duplicate tensor(-1.0354, dtype=torch.float64) tensor(2.1298, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7247, dtype=torch.float64) delta_t tensor(-0.3303, dtype=torch.float64)
11 gae_duplicate tensor(-1.1587, dtype=torch.float64) tensor(1.3973, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7253, dtype=torch.float64) delta_t tensor(-0.2885, dtype=torch.float64)
10 gae_duplicate tensor(-1.2155, dtype=torch.float64) tensor(2.6710, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7259, dtype=torch.float64) delta_t tensor(-0.3443, dtype=torch.float64)
9 gae_duplicate tensor(-1.3167, dtype=torch.float64) tensor(3.1003, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2368, dtype=torch.float64) delta_t tensor(-0.8480, dtype=torch.float64)
8 gae_duplicate tensor(-1.9013, dtype=torch.float64) tensor(2.4790, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1446, dtype=torch.float64) delta_t tensor(0.0781, dtype=torch.float64)
7 gae_duplicate tensor(-1.4430, dtype=torch.float64) tensor(1.6943, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4384, dtype=torch.float64) delta_t tensor(0.0599, dtype=torch.float64)
6 gae_duplicate tensor(-1.0945, dtype=torch.float64) tensor(3.0600, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(1.6044, dtype=torch.float64) delta_t tensor(1.5349, dtype=torch.float64)
5 gae_duplicate tensor(0.6593, dtype=torch.float64) tensor(-1.2360, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.0450, dtype=torch.float64) delta_t tensor(2.1270, dtype=torch.float64)
4 gae_duplicate tensor(2.6544, dtype=torch.float64) tensor(-2.8304, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.1742, dtype=torch.float64) delta_t tensor(0.7817, dtype=torch.float64)
3 gae_duplicate tensor(2.9053, dtype=torch.float64) tensor(-3.3891, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(2.0525, dtype=torch.float64) delta_t tensor(2.7329, dtype=torch.float64)
2 gae_duplicate tensor(5.0571, dtype=torch.float64) tensor(-9.7830, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-9.295921325683594
value loss:83.94276428222656
entropies:34.013160705566406
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.327821969985962 seconds
19 rew tensor(-0.7193, dtype=torch.float64) delta_t tensor(-0.0101, dtype=torch.float64)
19 gae_duplicate tensor(-0.0101, dtype=torch.float64) tensor(0.0230, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7199, dtype=torch.float64) delta_t tensor(-0.9622, dtype=torch.float64)
18 gae_duplicate tensor(-0.9702, dtype=torch.float64) tensor(2.9253, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7205, dtype=torch.float64) delta_t tensor(0.2379, dtype=torch.float64)
17 gae_duplicate tensor(-0.5382, dtype=torch.float64) tensor(1.2003, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7211, dtype=torch.float64) delta_t tensor(0.3031, dtype=torch.float64)
16 gae_duplicate tensor(-0.1275, dtype=torch.float64) tensor(0.2923, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7216, dtype=torch.float64) delta_t tensor(-0.1368, dtype=torch.float64)
15 gae_duplicate tensor(-0.2387, dtype=torch.float64) tensor(0.4899, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7222, dtype=torch.float64) delta_t tensor(-0.2854, dtype=torch.float64)
14 gae_duplicate tensor(-0.4764, dtype=torch.float64) tensor(0.5874, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7228, dtype=torch.float64) delta_t tensor(-0.2860, dtype=torch.float64)
13 gae_duplicate tensor(-0.6671, dtype=torch.float64) tensor(1.3689, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7234, dtype=torch.float64) delta_t tensor(-0.2865, dtype=torch.float64)
12 gae_duplicate tensor(-0.8202, dtype=torch.float64) tensor(2.3781, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7239, dtype=torch.float64) delta_t tensor(-0.2871, dtype=torch.float64)
11 gae_duplicate tensor(-0.9433, dtype=torch.float64) tensor(1.9357, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7245, dtype=torch.float64) delta_t tensor(-0.4749, dtype=torch.float64)
10 gae_duplicate tensor(-1.2295, dtype=torch.float64) tensor(1.7672, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7251, dtype=torch.float64) delta_t tensor(-0.3380, dtype=torch.float64)
9 gae_duplicate tensor(-1.3216, dtype=torch.float64) tensor(2.8680, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7257, dtype=torch.float64) delta_t tensor(-0.4833, dtype=torch.float64)
8 gae_duplicate tensor(-1.5406, dtype=torch.float64) tensor(1.9266, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5802, dtype=torch.float64) delta_t tensor(1.0903, dtype=torch.float64)
7 gae_duplicate tensor(-0.1422, dtype=torch.float64) tensor(0.2995, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.3787, dtype=torch.float64) delta_t tensor(0.7042, dtype=torch.float64)
6 gae_duplicate tensor(0.5905, dtype=torch.float64) tensor(-1.1361, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(1.3808, dtype=torch.float64) delta_t tensor(1.3643, dtype=torch.float64)
5 gae_duplicate tensor(1.8366, dtype=torch.float64) tensor(-3.6339, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(3.0533, dtype=torch.float64) delta_t tensor(3.7324, dtype=torch.float64)
4 gae_duplicate tensor(5.2017, dtype=torch.float64) tensor(-5.5599, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.3194, dtype=torch.float64) delta_t tensor(0.3542, dtype=torch.float64)
3 gae_duplicate tensor(4.5155, dtype=torch.float64) tensor(-8.8739, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(2.4889, dtype=torch.float64) delta_t tensor(3.0748, dtype=torch.float64)
2 gae_duplicate tensor(6.6872, dtype=torch.float64) tensor(-12.7231, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:82.16624450683594
value loss:157.6192169189453
entropies:34.046424865722656
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.591206312179565 seconds
19 rew tensor(-0.7206, dtype=torch.float64) delta_t tensor(0.3302, dtype=torch.float64)
19 gae_duplicate tensor(0.3302, dtype=torch.float64) tensor(-0.7183, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7212, dtype=torch.float64) delta_t tensor(-0.1603, dtype=torch.float64)
18 gae_duplicate tensor(0.1039, dtype=torch.float64) tensor(-0.2268, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.7218, dtype=torch.float64) delta_t tensor(-0.7462, dtype=torch.float64)
17 gae_duplicate tensor(-0.6631, dtype=torch.float64) tensor(0.9370, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7223, dtype=torch.float64) delta_t tensor(0.1905, dtype=torch.float64)
16 gae_duplicate tensor(-0.3400, dtype=torch.float64) tensor(0.7625, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7229, dtype=torch.float64) delta_t tensor(-0.0638, dtype=torch.float64)
15 gae_duplicate tensor(-0.3358, dtype=torch.float64) tensor(0.6970, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7235, dtype=torch.float64) delta_t tensor(-0.2970, dtype=torch.float64)
14 gae_duplicate tensor(-0.5656, dtype=torch.float64) tensor(0.9053, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7240, dtype=torch.float64) delta_t tensor(-0.2917, dtype=torch.float64)
13 gae_duplicate tensor(-0.7442, dtype=torch.float64) tensor(0.9347, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7246, dtype=torch.float64) delta_t tensor(-0.2970, dtype=torch.float64)
12 gae_duplicate tensor(-0.8924, dtype=torch.float64) tensor(2.1676, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7252, dtype=torch.float64) delta_t tensor(-0.3229, dtype=torch.float64)
11 gae_duplicate tensor(-1.0368, dtype=torch.float64) tensor(1.2819, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7257, dtype=torch.float64) delta_t tensor(-0.3819, dtype=torch.float64)
10 gae_duplicate tensor(-1.2114, dtype=torch.float64) tensor(1.7910, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5808, dtype=torch.float64) delta_t tensor(-0.1276, dtype=torch.float64)
9 gae_duplicate tensor(-1.0967, dtype=torch.float64) tensor(2.3917, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0720, dtype=torch.float64) delta_t tensor(0.2533, dtype=torch.float64)
8 gae_duplicate tensor(-0.6241, dtype=torch.float64) tensor(1.3113, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0007, dtype=torch.float64) delta_t tensor(0.5152, dtype=torch.float64)
7 gae_duplicate tensor(0.0159, dtype=torch.float64) tensor(-0.0206, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.8000, dtype=torch.float64) delta_t tensor(0.4737, dtype=torch.float64)
6 gae_duplicate tensor(0.4864, dtype=torch.float64) tensor(-0.8605, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.5101, dtype=torch.float64) delta_t tensor(-0.5918, dtype=torch.float64)
5 gae_duplicate tensor(-0.2027, dtype=torch.float64) tensor(0.3931, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(2.0355, dtype=torch.float64) delta_t tensor(1.9241, dtype=torch.float64)
4 gae_duplicate tensor(1.7620, dtype=torch.float64) tensor(-4.8736, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.6045, dtype=torch.float64) delta_t tensor(1.6898, dtype=torch.float64)
3 gae_duplicate tensor(3.0994, dtype=torch.float64) tensor(-3.3277, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.4619, dtype=torch.float64) delta_t tensor(1.9881, dtype=torch.float64)
2 gae_duplicate tensor(4.4676, dtype=torch.float64) tensor(-8.4761, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:28.559093475341797
value loss:59.31068420410156
entropies:34.06742477416992
Policy training finished
---------------------
gamma: 0.8
Process Process-4:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 809, in _callmethod
    conn.send((self._id, methodname, args, kwds))
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 206, in send
    self._send_bytes(_ForkingPickler.dumps(obj))
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
KeyboardInterrupt