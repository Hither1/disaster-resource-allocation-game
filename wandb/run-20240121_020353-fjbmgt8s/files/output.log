obs <crafter.objects.Shelter object at 0x1327b6460> [ 0 39  0  0 39  0  0 12  0]
obs <crafter.objects.Warehouse object at 0x1217bbe80> [ 0 39  0  0 38  0  0  9  0]
obs <crafter.objects.Station object at 0x1327be4f0> [ 0  9  0  0  9  0  0 11  0]
obs <crafter.objects.Shelter object at 0x1327b6460> [ 0 39  0  0 39  0  0  7  0]
obs <crafter.objects.Warehouse object at 0x1217bbe80> [ 0 36  0  0 40  0  0  9  0]
obs <crafter.objects.Station object at 0x1327be4f0> [ 0  9  0  0  9  0  0 10  0]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0011391639709472656 seconds
19 rew tensor(0.7522, dtype=torch.float64) delta_t tensor(0.1158, dtype=torch.float64)
19 gae_duplicate tensor(0.1158, dtype=torch.float64) tensor(-0.1910, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7830, dtype=torch.float64) delta_t tensor(0.7177, dtype=torch.float64)
18 gae_duplicate tensor(0.8104, dtype=torch.float64) tensor(-1.6272, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8181, dtype=torch.float64) delta_t tensor(0.7494, dtype=torch.float64)
17 gae_duplicate tensor(1.3977, dtype=torch.float64) tensor(-2.2595, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8584, dtype=torch.float64) delta_t tensor(0.9569, dtype=torch.float64)
16 gae_duplicate tensor(2.0750, dtype=torch.float64) tensor(-4.7480, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9056, dtype=torch.float64) delta_t tensor(0.9766, dtype=torch.float64)
15 gae_duplicate tensor(2.6367, dtype=torch.float64) tensor(-4.7438, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9616, dtype=torch.float64) delta_t tensor(0.9352, dtype=torch.float64)
14 gae_duplicate tensor(3.0445, dtype=torch.float64) tensor(-5.4989, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0300, dtype=torch.float64) delta_t tensor(1.0058, dtype=torch.float64)
13 gae_duplicate tensor(3.4414, dtype=torch.float64) tensor(-8.2823, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.1158, dtype=torch.float64) delta_t tensor(1.1052, dtype=torch.float64)
12 gae_duplicate tensor(3.8583, dtype=torch.float64) tensor(-8.8217, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.2285, dtype=torch.float64) delta_t tensor(1.2504, dtype=torch.float64)
11 gae_duplicate tensor(4.3371, dtype=torch.float64) tensor(-10.1937, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(1.3857, dtype=torch.float64) delta_t tensor(1.2486, dtype=torch.float64)
10 gae_duplicate tensor(4.7182, dtype=torch.float64) tensor(-12.1701, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(1.6281, dtype=torch.float64) delta_t tensor(1.5734, dtype=torch.float64)
9 gae_duplicate tensor(5.3480, dtype=torch.float64) tensor(-9.0007, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(1.5554, dtype=torch.float64) delta_t tensor(1.5362, dtype=torch.float64)
8 gae_duplicate tensor(5.8146, dtype=torch.float64) tensor(-11.3899, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(1.5841, dtype=torch.float64) delta_t tensor(1.5547, dtype=torch.float64)
7 gae_duplicate tensor(6.2063, dtype=torch.float64) tensor(-14.9009, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4155, dtype=torch.float64) delta_t tensor(0.5846, dtype=torch.float64)
6 gae_duplicate tensor(5.5497, dtype=torch.float64) tensor(-10.4585, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0643, dtype=torch.float64) delta_t tensor(-0.2481, dtype=torch.float64)
5 gae_duplicate tensor(4.1916, dtype=torch.float64) tensor(-10.2254, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0531, dtype=torch.float64) delta_t tensor(-1.0852, dtype=torch.float64)
4 gae_duplicate tensor(2.2681, dtype=torch.float64) tensor(-4.1172, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0404, dtype=torch.float64) delta_t tensor(-1.1264, dtype=torch.float64)
3 gae_duplicate tensor(0.6881, dtype=torch.float64) tensor(-1.2533, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1531, dtype=torch.float64) delta_t tensor(-1.2083, dtype=torch.float64)
2 gae_duplicate tensor(-0.6578, dtype=torch.float64) tensor(1.1982, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:711.0072021484375
value loss:369.4498291015625
entropies:36.58253479003906
Policy training finished
---------------------
gamma: 0.8
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 4.413549900054932 seconds
19 rew tensor(0.8067, dtype=torch.float64) delta_t tensor(0.2651, dtype=torch.float64)
19 gae_duplicate tensor(0.2651, dtype=torch.float64) tensor(-0.4809, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8238, dtype=torch.float64) delta_t tensor(0.8317, dtype=torch.float64)
18 gae_duplicate tensor(1.0437, dtype=torch.float64) tensor(-2.4122, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8420, dtype=torch.float64) delta_t tensor(0.6773, dtype=torch.float64)
17 gae_duplicate tensor(1.5123, dtype=torch.float64) tensor(-3.5395, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8615, dtype=torch.float64) delta_t tensor(0.9482, dtype=torch.float64)
16 gae_duplicate tensor(2.1580, dtype=torch.float64) tensor(-4.0861, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8825, dtype=torch.float64) delta_t tensor(0.9618, dtype=torch.float64)
15 gae_duplicate tensor(2.6882, dtype=torch.float64) tensor(-5.9727, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9051, dtype=torch.float64) delta_t tensor(0.8769, dtype=torch.float64)
14 gae_duplicate tensor(3.0275, dtype=torch.float64) tensor(-5.9152, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9295, dtype=torch.float64) delta_t tensor(0.9029, dtype=torch.float64)
13 gae_duplicate tensor(3.3249, dtype=torch.float64) tensor(-7.3779, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9560, dtype=torch.float64) delta_t tensor(0.9312, dtype=torch.float64)
12 gae_duplicate tensor(3.5912, dtype=torch.float64) tensor(-7.0393, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9850, dtype=torch.float64) delta_t tensor(0.9814, dtype=torch.float64)
11 gae_duplicate tensor(3.8543, dtype=torch.float64) tensor(-7.5565, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(1.0168, dtype=torch.float64) delta_t tensor(0.8975, dtype=torch.float64)
10 gae_duplicate tensor(3.9810, dtype=torch.float64) tensor(-7.4249, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5419, dtype=torch.float64) delta_t tensor(0.4687, dtype=torch.float64)
9 gae_duplicate tensor(3.6535, dtype=torch.float64) tensor(-6.8127, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3018, dtype=torch.float64) delta_t tensor(0.3128, dtype=torch.float64)
8 gae_duplicate tensor(3.2355, dtype=torch.float64) tensor(-5.9784, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0642, dtype=torch.float64) delta_t tensor(-0.1236, dtype=torch.float64)
7 gae_duplicate tensor(2.4649, dtype=torch.float64) tensor(-4.6172, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4908, dtype=torch.float64) delta_t tensor(-0.3411, dtype=torch.float64)
6 gae_duplicate tensor(1.6308, dtype=torch.float64) tensor(-3.8961, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8616, dtype=torch.float64) delta_t tensor(-1.2424, dtype=torch.float64)
5 gae_duplicate tensor(0.0622, dtype=torch.float64) tensor(-0.1147, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4284, dtype=torch.float64) delta_t tensor(-1.4388, dtype=torch.float64)
4 gae_duplicate tensor(-1.3890, dtype=torch.float64) tensor(3.3296, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2812, dtype=torch.float64) delta_t tensor(-1.4018, dtype=torch.float64)
3 gae_duplicate tensor(-2.5130, dtype=torch.float64) tensor(4.6445, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9862, dtype=torch.float64) delta_t tensor(-0.9815, dtype=torch.float64)
2 gae_duplicate tensor(-2.9919, dtype=torch.float64) tensor(7.1886, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:347.2604675292969
value loss:193.35537719726562
entropies:36.963462829589844
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.282864093780518 seconds
19 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.3177, dtype=torch.float64)
19 gae_duplicate tensor(0.3177, dtype=torch.float64) tensor(-0.6110, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8277, dtype=torch.float64) delta_t tensor(0.9264, dtype=torch.float64)
18 gae_duplicate tensor(1.1806, dtype=torch.float64) tensor(-2.2701, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8397, dtype=torch.float64) delta_t tensor(0.5453, dtype=torch.float64)
17 gae_duplicate tensor(1.4898, dtype=torch.float64) tensor(-2.6111, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8523, dtype=torch.float64) delta_t tensor(0.9492, dtype=torch.float64)
16 gae_duplicate tensor(2.1411, dtype=torch.float64) tensor(-4.9251, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8655, dtype=torch.float64) delta_t tensor(0.9237, dtype=torch.float64)
15 gae_duplicate tensor(2.6366, dtype=torch.float64) tensor(-5.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8793, dtype=torch.float64) delta_t tensor(0.8531, dtype=torch.float64)
14 gae_duplicate tensor(2.9623, dtype=torch.float64) tensor(-5.8239, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8938, dtype=torch.float64) delta_t tensor(0.8723, dtype=torch.float64)
13 gae_duplicate tensor(3.2422, dtype=torch.float64) tensor(-7.1657, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9090, dtype=torch.float64) delta_t tensor(0.9293, dtype=torch.float64)
12 gae_duplicate tensor(3.5230, dtype=torch.float64) tensor(-6.9551, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9251, dtype=torch.float64) delta_t tensor(0.9195, dtype=torch.float64)
11 gae_duplicate tensor(3.7380, dtype=torch.float64) tensor(-8.1967, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9420, dtype=torch.float64) delta_t tensor(0.7812, dtype=torch.float64)
10 gae_duplicate tensor(3.7715, dtype=torch.float64) tensor(-7.1932, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9599, dtype=torch.float64) delta_t tensor(0.9269, dtype=torch.float64)
9 gae_duplicate tensor(3.9442, dtype=torch.float64) tensor(-7.2550, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1045, dtype=torch.float64) delta_t tensor(0.2300, dtype=torch.float64)
8 gae_duplicate tensor(3.3853, dtype=torch.float64) tensor(-8.0965, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8834, dtype=torch.float64) delta_t tensor(-0.9800, dtype=torch.float64)
7 gae_duplicate tensor(1.7283, dtype=torch.float64) tensor(-4.0650, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9619, dtype=torch.float64) delta_t tensor(-0.8662, dtype=torch.float64)
6 gae_duplicate tensor(0.5164, dtype=torch.float64) tensor(-0.9658, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2287, dtype=torch.float64) delta_t tensor(-1.2391, dtype=torch.float64)
5 gae_duplicate tensor(-0.8260, dtype=torch.float64) tensor(1.5142, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6980, dtype=torch.float64) delta_t tensor(-1.9378, dtype=torch.float64)
4 gae_duplicate tensor(-2.5986, dtype=torch.float64) tensor(4.7929, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.0312, dtype=torch.float64) delta_t tensor(-2.1346, dtype=torch.float64)
3 gae_duplicate tensor(-4.2134, dtype=torch.float64) tensor(7.7575, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7758, dtype=torch.float64) delta_t tensor(-0.8103, dtype=torch.float64)
2 gae_duplicate tensor(-4.1811, dtype=torch.float64) tensor(7.6654, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:300.504150390625
value loss:222.12905883789062
entropies:36.97441101074219
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.495423078536987 seconds
19 rew tensor(0.8008, dtype=torch.float64) delta_t tensor(0.2728, dtype=torch.float64)
19 gae_duplicate tensor(0.2728, dtype=torch.float64) tensor(-0.6373, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8091, dtype=torch.float64) delta_t tensor(0.7137, dtype=torch.float64)
18 gae_duplicate tensor(0.9320, dtype=torch.float64) tensor(-2.1807, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8177, dtype=torch.float64) delta_t tensor(0.8700, dtype=torch.float64)
17 gae_duplicate tensor(1.6156, dtype=torch.float64) tensor(-3.7944, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8265, dtype=torch.float64) delta_t tensor(0.8826, dtype=torch.float64)
16 gae_duplicate tensor(2.1751, dtype=torch.float64) tensor(-4.1066, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8357, dtype=torch.float64) delta_t tensor(0.9225, dtype=torch.float64)
15 gae_duplicate tensor(2.6626, dtype=torch.float64) tensor(-5.3423, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8452, dtype=torch.float64) delta_t tensor(0.8252, dtype=torch.float64)
14 gae_duplicate tensor(2.9553, dtype=torch.float64) tensor(-6.3961, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8550, dtype=torch.float64) delta_t tensor(0.8350, dtype=torch.float64)
13 gae_duplicate tensor(3.1992, dtype=torch.float64) tensor(-6.3854, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8651, dtype=torch.float64) delta_t tensor(0.8452, dtype=torch.float64)
12 gae_duplicate tensor(3.4045, dtype=torch.float64) tensor(-6.8133, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8757, dtype=torch.float64) delta_t tensor(0.8557, dtype=torch.float64)
11 gae_duplicate tensor(3.5793, dtype=torch.float64) tensor(-7.1626, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8866, dtype=torch.float64) delta_t tensor(0.7346, dtype=torch.float64)
10 gae_duplicate tensor(3.5980, dtype=torch.float64) tensor(-6.8144, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8979, dtype=torch.float64) delta_t tensor(0.8442, dtype=torch.float64)
9 gae_duplicate tensor(3.7226, dtype=torch.float64) tensor(-7.0809, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0318, dtype=torch.float64) delta_t tensor(-0.1038, dtype=torch.float64)
8 gae_duplicate tensor(2.8743, dtype=torch.float64) tensor(-5.5249, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3418, dtype=torch.float64) delta_t tensor(0.4459, dtype=torch.float64)
7 gae_duplicate tensor(2.7453, dtype=torch.float64) tensor(-5.1789, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2744, dtype=torch.float64) delta_t tensor(-0.2190, dtype=torch.float64)
6 gae_duplicate tensor(1.9773, dtype=torch.float64) tensor(-3.6568, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5673, dtype=torch.float64) delta_t tensor(-1.7004, dtype=torch.float64)
5 gae_duplicate tensor(-0.1186, dtype=torch.float64) tensor(0.2253, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6103, dtype=torch.float64) delta_t tensor(-1.5525, dtype=torch.float64)
4 gae_duplicate tensor(-1.6473, dtype=torch.float64) tensor(3.9096, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4050, dtype=torch.float64) delta_t tensor(-1.6643, dtype=torch.float64)
3 gae_duplicate tensor(-2.9822, dtype=torch.float64) tensor(5.5156, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.8203, dtype=torch.float64) delta_t tensor(-1.8734, dtype=torch.float64)
2 gae_duplicate tensor(-4.2592, dtype=torch.float64) tensor(8.1468, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:318.5509948730469
value loss:202.5248565673828
entropies:37.076080322265625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.27480411529541 seconds
19 rew tensor(0.7950, dtype=torch.float64) delta_t tensor(0.4112, dtype=torch.float64)
19 gae_duplicate tensor(0.4112, dtype=torch.float64) tensor(-0.7933, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8016, dtype=torch.float64) delta_t tensor(0.7861, dtype=torch.float64)
18 gae_duplicate tensor(1.1150, dtype=torch.float64) tensor(-2.0247, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8083, dtype=torch.float64) delta_t tensor(0.5870, dtype=torch.float64)
17 gae_duplicate tensor(1.4791, dtype=torch.float64) tensor(-3.3773, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.9482, dtype=torch.float64)
16 gae_duplicate tensor(2.1314, dtype=torch.float64) tensor(-4.1006, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8223, dtype=torch.float64) delta_t tensor(0.7428, dtype=torch.float64)
15 gae_duplicate tensor(2.4479, dtype=torch.float64) tensor(-4.7978, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8295, dtype=torch.float64) delta_t tensor(0.7736, dtype=torch.float64)
14 gae_duplicate tensor(2.7319, dtype=torch.float64) tensor(-6.0476, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8370, dtype=torch.float64) delta_t tensor(0.7810, dtype=torch.float64)
13 gae_duplicate tensor(2.9665, dtype=torch.float64) tensor(-5.8143, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8447, dtype=torch.float64) delta_t tensor(0.7887, dtype=torch.float64)
12 gae_duplicate tensor(3.1619, dtype=torch.float64) tensor(-6.2134, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8525, dtype=torch.float64) delta_t tensor(0.8054, dtype=torch.float64)
11 gae_duplicate tensor(3.3349, dtype=torch.float64) tensor(-7.3485, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8606, dtype=torch.float64) delta_t tensor(0.8361, dtype=torch.float64)
10 gae_duplicate tensor(3.5040, dtype=torch.float64) tensor(-8.0564, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5571, dtype=torch.float64) delta_t tensor(0.4686, dtype=torch.float64)
9 gae_duplicate tensor(3.2718, dtype=torch.float64) tensor(-6.0538, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1885, dtype=torch.float64) delta_t tensor(0.2969, dtype=torch.float64)
8 gae_duplicate tensor(2.9143, dtype=torch.float64) tensor(-5.3733, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1278, dtype=torch.float64) delta_t tensor(0.1841, dtype=torch.float64)
7 gae_duplicate tensor(2.5156, dtype=torch.float64) tensor(-4.6454, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4687, dtype=torch.float64) delta_t tensor(-1.4624, dtype=torch.float64)
6 gae_duplicate tensor(0.5500, dtype=torch.float64) tensor(-1.0214, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6819, dtype=torch.float64) delta_t tensor(-2.0533, dtype=torch.float64)
5 gae_duplicate tensor(-1.6133, dtype=torch.float64) tensor(3.0094, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9085, dtype=torch.float64) delta_t tensor(-1.8236, dtype=torch.float64)
4 gae_duplicate tensor(-3.1142, dtype=torch.float64) tensor(5.7671, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5817, dtype=torch.float64) delta_t tensor(-1.7023, dtype=torch.float64)
3 gae_duplicate tensor(-4.1937, dtype=torch.float64) tensor(9.9800, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6159, dtype=torch.float64) delta_t tensor(-1.6226, dtype=torch.float64)
2 gae_duplicate tensor(-4.9776, dtype=torch.float64) tensor(11.4407, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:211.71188354492188
value loss:216.43228149414062
entropies:37.01047897338867
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.7063)
ToM Target loss= tensor(301.0886)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.3566999435424805 seconds
19 rew tensor(0.8026, dtype=torch.float64) delta_t tensor(0.2363, dtype=torch.float64)
19 gae_duplicate tensor(0.2363, dtype=torch.float64) tensor(-0.5913, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8082, dtype=torch.float64) delta_t tensor(0.8946, dtype=torch.float64)
18 gae_duplicate tensor(1.0837, dtype=torch.float64) tensor(-2.6950, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.5613, dtype=torch.float64)
17 gae_duplicate tensor(1.4282, dtype=torch.float64) tensor(-2.8699, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8196, dtype=torch.float64) delta_t tensor(0.8835, dtype=torch.float64)
16 gae_duplicate tensor(2.0261, dtype=torch.float64) tensor(-4.6410, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8255, dtype=torch.float64) delta_t tensor(0.9414, dtype=torch.float64)
15 gae_duplicate tensor(2.5622, dtype=torch.float64) tensor(-5.8339, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8316, dtype=torch.float64) delta_t tensor(0.8081, dtype=torch.float64)
14 gae_duplicate tensor(2.8579, dtype=torch.float64) tensor(-5.4939, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8377, dtype=torch.float64) delta_t tensor(0.8163, dtype=torch.float64)
13 gae_duplicate tensor(3.1026, dtype=torch.float64) tensor(-5.9770, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8441, dtype=torch.float64) delta_t tensor(0.8246, dtype=torch.float64)
12 gae_duplicate tensor(3.3067, dtype=torch.float64) tensor(-6.3835, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8505, dtype=torch.float64) delta_t tensor(0.8440, dtype=torch.float64)
11 gae_duplicate tensor(3.4893, dtype=torch.float64) tensor(-7.8276, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8571, dtype=torch.float64) delta_t tensor(0.6858, dtype=torch.float64)
10 gae_duplicate tensor(3.4773, dtype=torch.float64) tensor(-6.2339, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4835, dtype=torch.float64) delta_t tensor(0.4084, dtype=torch.float64)
9 gae_duplicate tensor(3.1902, dtype=torch.float64) tensor(-6.0779, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2336, dtype=torch.float64) delta_t tensor(0.2359, dtype=torch.float64)
8 gae_duplicate tensor(2.7880, dtype=torch.float64) tensor(-6.7060, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1427, dtype=torch.float64) delta_t tensor(-0.2206, dtype=torch.float64)
7 gae_duplicate tensor(2.0098, dtype=torch.float64) tensor(-4.7611, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7068, dtype=torch.float64) delta_t tensor(-0.5501, dtype=torch.float64)
6 gae_duplicate tensor(1.0577, dtype=torch.float64) tensor(-2.5172, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9616, dtype=torch.float64) delta_t tensor(-1.2760, dtype=torch.float64)
5 gae_duplicate tensor(-0.4298, dtype=torch.float64) tensor(0.7946, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7822, dtype=torch.float64) delta_t tensor(-1.8848, dtype=torch.float64)
4 gae_duplicate tensor(-2.2287, dtype=torch.float64) tensor(4.1203, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5664, dtype=torch.float64) delta_t tensor(-1.5926, dtype=torch.float64)
3 gae_duplicate tensor(-3.3755, dtype=torch.float64) tensor(6.2762, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2117, dtype=torch.float64) delta_t tensor(-1.2692, dtype=torch.float64)
2 gae_duplicate tensor(-3.9696, dtype=torch.float64) tensor(9.4677, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:286.5951843261719
value loss:183.52163696289062
entropies:36.89436340332031
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.056251049041748 seconds
19 rew tensor(0.8057, dtype=torch.float64) delta_t tensor(0.2244, dtype=torch.float64)
19 gae_duplicate tensor(0.2244, dtype=torch.float64) tensor(-0.3850, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8104, dtype=torch.float64) delta_t tensor(0.8470, dtype=torch.float64)
18 gae_duplicate tensor(1.0266, dtype=torch.float64) tensor(-1.7732, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.6082, dtype=torch.float64)
17 gae_duplicate tensor(1.4294, dtype=torch.float64) tensor(-3.6819, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8203, dtype=torch.float64) delta_t tensor(0.9438, dtype=torch.float64)
16 gae_duplicate tensor(2.0873, dtype=torch.float64) tensor(-4.7261, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8253, dtype=torch.float64) delta_t tensor(0.9283, dtype=torch.float64)
15 gae_duplicate tensor(2.5982, dtype=torch.float64) tensor(-5.0297, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8305, dtype=torch.float64) delta_t tensor(0.8220, dtype=torch.float64)
14 gae_duplicate tensor(2.9005, dtype=torch.float64) tensor(-6.5011, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8357, dtype=torch.float64) delta_t tensor(0.8100, dtype=torch.float64)
13 gae_duplicate tensor(3.1304, dtype=torch.float64) tensor(-6.0733, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8410, dtype=torch.float64) delta_t tensor(0.8153, dtype=torch.float64)
12 gae_duplicate tensor(3.3196, dtype=torch.float64) tensor(-7.4406, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8465, dtype=torch.float64) delta_t tensor(0.8405, dtype=torch.float64)
11 gae_duplicate tensor(3.4962, dtype=torch.float64) tensor(-6.7797, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8520, dtype=torch.float64) delta_t tensor(0.6444, dtype=torch.float64)
10 gae_duplicate tensor(3.4413, dtype=torch.float64) tensor(-8.5114, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8577, dtype=torch.float64) delta_t tensor(0.7815, dtype=torch.float64)
9 gae_duplicate tensor(3.5346, dtype=torch.float64) tensor(-8.6923, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1104, dtype=torch.float64) delta_t tensor(0.1541, dtype=torch.float64)
8 gae_duplicate tensor(2.9817, dtype=torch.float64) tensor(-5.5014, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6393, dtype=torch.float64) delta_t tensor(-0.7632, dtype=torch.float64)
7 gae_duplicate tensor(1.6222, dtype=torch.float64) tensor(-3.0555, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7052, dtype=torch.float64) delta_t tensor(-0.4927, dtype=torch.float64)
6 gae_duplicate tensor(0.8051, dtype=torch.float64) tensor(-1.4895, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0828, dtype=torch.float64) delta_t tensor(-1.0870, dtype=torch.float64)
5 gae_duplicate tensor(-0.4430, dtype=torch.float64) tensor(1.0530, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1512, dtype=torch.float64) delta_t tensor(-2.4416, dtype=torch.float64)
4 gae_duplicate tensor(-2.7959, dtype=torch.float64) tensor(5.1734, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9486, dtype=torch.float64) delta_t tensor(-1.9972, dtype=torch.float64)
3 gae_duplicate tensor(-4.2339, dtype=torch.float64) tensor(10.0426, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2198, dtype=torch.float64) delta_t tensor(-1.3551, dtype=torch.float64)
2 gae_duplicate tensor(-4.7422, dtype=torch.float64) tensor(11.2481, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:251.63543701171875
value loss:210.96766662597656
entropies:36.89307403564453
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.651485919952393 seconds
19 rew tensor(0.6987, dtype=torch.float64) delta_t tensor(0.1523, dtype=torch.float64)
19 gae_duplicate tensor(0.1523, dtype=torch.float64) tensor(-0.3464, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6379, dtype=torch.float64) delta_t tensor(0.6632, dtype=torch.float64)
18 gae_duplicate tensor(0.7850, dtype=torch.float64) tensor(-1.9313, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4490, dtype=torch.float64) delta_t tensor(0.3600, dtype=torch.float64)
17 gae_duplicate tensor(0.9880, dtype=torch.float64) tensor(-1.9517, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0045, dtype=torch.float64) delta_t tensor(0.0413, dtype=torch.float64)
16 gae_duplicate tensor(0.8317, dtype=torch.float64) tensor(-1.9259, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.6945, dtype=torch.float64) delta_t tensor(-0.6563, dtype=torch.float64)
15 gae_duplicate tensor(0.0090, dtype=torch.float64) tensor(-0.0175, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8247, dtype=torch.float64) delta_t tensor(0.7846, dtype=torch.float64)
14 gae_duplicate tensor(0.7919, dtype=torch.float64) tensor(-1.5333, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8292, dtype=torch.float64) delta_t tensor(0.7891, dtype=torch.float64)
13 gae_duplicate tensor(1.4226, dtype=torch.float64) tensor(-3.1860, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8338, dtype=torch.float64) delta_t tensor(0.7937, dtype=torch.float64)
12 gae_duplicate tensor(1.9318, dtype=torch.float64) tensor(-3.7606, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8384, dtype=torch.float64) delta_t tensor(0.7984, dtype=torch.float64)
11 gae_duplicate tensor(2.3438, dtype=torch.float64) tensor(-5.2612, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8431, dtype=torch.float64) delta_t tensor(0.7081, dtype=torch.float64)
10 gae_duplicate tensor(2.5831, dtype=torch.float64) tensor(-4.9208, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6586, dtype=torch.float64) delta_t tensor(0.5859, dtype=torch.float64)
9 gae_duplicate tensor(2.6524, dtype=torch.float64) tensor(-4.7732, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3467, dtype=torch.float64) delta_t tensor(0.2319, dtype=torch.float64)
8 gae_duplicate tensor(2.3538, dtype=torch.float64) tensor(-4.4629, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0289, dtype=torch.float64) delta_t tensor(0.0314, dtype=torch.float64)
7 gae_duplicate tensor(1.9145, dtype=torch.float64) tensor(-3.5472, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7176, dtype=torch.float64) delta_t tensor(-0.6072, dtype=torch.float64)
6 gae_duplicate tensor(0.9244, dtype=torch.float64) tensor(-1.7079, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4713, dtype=torch.float64) delta_t tensor(-1.8711, dtype=torch.float64)
5 gae_duplicate tensor(-1.1316, dtype=torch.float64) tensor(2.6818, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8013, dtype=torch.float64) delta_t tensor(-1.7432, dtype=torch.float64)
4 gae_duplicate tensor(-2.6485, dtype=torch.float64) tensor(4.9074, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7018, dtype=torch.float64) delta_t tensor(-1.7747, dtype=torch.float64)
3 gae_duplicate tensor(-3.8935, dtype=torch.float64) tensor(7.2284, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4707, dtype=torch.float64) delta_t tensor(-1.5423, dtype=torch.float64)
2 gae_duplicate tensor(-4.6571, dtype=torch.float64) tensor(10.7902, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:81.19998168945312
value loss:124.64205932617188
entropies:36.94049835205078
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5196921825408936 seconds
19 rew tensor(0.8280, dtype=torch.float64) delta_t tensor(0.3666, dtype=torch.float64)
19 gae_duplicate tensor(0.3666, dtype=torch.float64) tensor(-0.8482, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8319, dtype=torch.float64) delta_t tensor(0.8024, dtype=torch.float64)
18 gae_duplicate tensor(1.0957, dtype=torch.float64) tensor(-2.5499, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8358, dtype=torch.float64) delta_t tensor(0.5917, dtype=torch.float64)
17 gae_duplicate tensor(1.4682, dtype=torch.float64) tensor(-3.3355, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8398, dtype=torch.float64) delta_t tensor(0.8691, dtype=torch.float64)
16 gae_duplicate tensor(2.0436, dtype=torch.float64) tensor(-4.7371, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8439, dtype=torch.float64) delta_t tensor(0.8843, dtype=torch.float64)
15 gae_duplicate tensor(2.5192, dtype=torch.float64) tensor(-4.8105, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8480, dtype=torch.float64) delta_t tensor(0.7940, dtype=torch.float64)
14 gae_duplicate tensor(2.8093, dtype=torch.float64) tensor(-5.3758, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8522, dtype=torch.float64) delta_t tensor(0.7998, dtype=torch.float64)
13 gae_duplicate tensor(3.0473, dtype=torch.float64) tensor(-5.8434, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8565, dtype=torch.float64) delta_t tensor(0.8119, dtype=torch.float64)
12 gae_duplicate tensor(3.2497, dtype=torch.float64) tensor(-6.2747, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8608, dtype=torch.float64) delta_t tensor(0.8429, dtype=torch.float64)
11 gae_duplicate tensor(3.4427, dtype=torch.float64) tensor(-7.7069, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8652, dtype=torch.float64) delta_t tensor(0.7428, dtype=torch.float64)
10 gae_duplicate tensor(3.4970, dtype=torch.float64) tensor(-8.3560, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5464, dtype=torch.float64) delta_t tensor(0.4187, dtype=torch.float64)
9 gae_duplicate tensor(3.2163, dtype=torch.float64) tensor(-7.6792, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2260, dtype=torch.float64) delta_t tensor(0.3054, dtype=torch.float64)
8 gae_duplicate tensor(2.8784, dtype=torch.float64) tensor(-6.8252, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2879, dtype=torch.float64) delta_t tensor(-0.4205, dtype=torch.float64)
7 gae_duplicate tensor(1.8822, dtype=torch.float64) tensor(-3.4845, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7379, dtype=torch.float64) delta_t tensor(-0.5970, dtype=torch.float64)
6 gae_duplicate tensor(0.9088, dtype=torch.float64) tensor(-2.1642, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9976, dtype=torch.float64) delta_t tensor(-1.3522, dtype=torch.float64)
5 gae_duplicate tensor(-0.6251, dtype=torch.float64) tensor(1.1539, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5802, dtype=torch.float64) delta_t tensor(-1.5600, dtype=torch.float64)
4 gae_duplicate tensor(-2.0601, dtype=torch.float64) tensor(3.8132, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3398, dtype=torch.float64) delta_t tensor(-1.4295, dtype=torch.float64)
3 gae_duplicate tensor(-3.0775, dtype=torch.float64) tensor(7.1430, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8352, dtype=torch.float64) delta_t tensor(-0.8975, dtype=torch.float64)
2 gae_duplicate tensor(-3.3595, dtype=torch.float64) tensor(6.2957, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:308.40301513671875
value loss:171.33592224121094
entropies:36.92802810668945
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.291944980621338 seconds
19 rew tensor(0.8252, dtype=torch.float64) delta_t tensor(0.1138, dtype=torch.float64)
19 gae_duplicate tensor(0.1138, dtype=torch.float64) tensor(-0.2774, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8287, dtype=torch.float64) delta_t tensor(0.7065, dtype=torch.float64)
18 gae_duplicate tensor(0.7975, dtype=torch.float64) tensor(-1.4393, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8322, dtype=torch.float64) delta_t tensor(0.7992, dtype=torch.float64)
17 gae_duplicate tensor(1.4372, dtype=torch.float64) tensor(-3.2943, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8358, dtype=torch.float64) delta_t tensor(0.9512, dtype=torch.float64)
16 gae_duplicate tensor(2.1009, dtype=torch.float64) tensor(-5.0369, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8394, dtype=torch.float64) delta_t tensor(0.9408, dtype=torch.float64)
15 gae_duplicate tensor(2.6216, dtype=torch.float64) tensor(-5.1141, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8431, dtype=torch.float64) delta_t tensor(0.8068, dtype=torch.float64)
14 gae_duplicate tensor(2.9040, dtype=torch.float64) tensor(-6.4482, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8468, dtype=torch.float64) delta_t tensor(0.8105, dtype=torch.float64)
13 gae_duplicate tensor(3.1337, dtype=torch.float64) tensor(-6.9743, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8505, dtype=torch.float64) delta_t tensor(0.8143, dtype=torch.float64)
12 gae_duplicate tensor(3.3213, dtype=torch.float64) tensor(-7.3917, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8544, dtype=torch.float64) delta_t tensor(0.8181, dtype=torch.float64)
11 gae_duplicate tensor(3.4751, dtype=torch.float64) tensor(-6.7971, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8582, dtype=torch.float64) delta_t tensor(0.6388, dtype=torch.float64)
10 gae_duplicate tensor(3.4189, dtype=torch.float64) tensor(-6.4054, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8622, dtype=torch.float64) delta_t tensor(0.7853, dtype=torch.float64)
9 gae_duplicate tensor(3.5204, dtype=torch.float64) tensor(-6.4662, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0988, dtype=torch.float64) delta_t tensor(0.1066, dtype=torch.float64)
8 gae_duplicate tensor(2.9230, dtype=torch.float64) tensor(-6.9284, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4112, dtype=torch.float64) delta_t tensor(-0.4674, dtype=torch.float64)
7 gae_duplicate tensor(1.8709, dtype=torch.float64) tensor(-3.4692, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2397, dtype=torch.float64) delta_t tensor(-1.0913, dtype=torch.float64)
6 gae_duplicate tensor(0.4055, dtype=torch.float64) tensor(-0.7519, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6306, dtype=torch.float64) delta_t tensor(-1.8399, dtype=torch.float64)
5 gae_duplicate tensor(-1.5155, dtype=torch.float64) tensor(3.5920, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2231, dtype=torch.float64) delta_t tensor(-2.3278, dtype=torch.float64)
4 gae_duplicate tensor(-3.5402, dtype=torch.float64) tensor(6.5469, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8714, dtype=torch.float64) delta_t tensor(-1.9615, dtype=torch.float64)
3 gae_duplicate tensor(-4.7936, dtype=torch.float64) tensor(8.9084, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5038, dtype=torch.float64) delta_t tensor(-1.5964, dtype=torch.float64)
2 gae_duplicate tensor(-5.4313, dtype=torch.float64) tensor(10.1452, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:224.50184631347656
value loss:238.44044494628906
entropies:36.96877670288086
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.7664)
ToM Target loss= tensor(302.5891)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.311628103256226 seconds
19 rew tensor(0.8273, dtype=torch.float64) delta_t tensor(0.3926, dtype=torch.float64)
19 gae_duplicate tensor(0.3926, dtype=torch.float64) tensor(-0.7310, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8305, dtype=torch.float64) delta_t tensor(0.7368, dtype=torch.float64)
18 gae_duplicate tensor(1.0509, dtype=torch.float64) tensor(-1.9542, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8337, dtype=torch.float64) delta_t tensor(0.7537, dtype=torch.float64)
17 gae_duplicate tensor(1.5944, dtype=torch.float64) tensor(-3.7599, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8370, dtype=torch.float64) delta_t tensor(0.8242, dtype=torch.float64)
16 gae_duplicate tensor(2.0997, dtype=torch.float64) tensor(-4.9241, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8403, dtype=torch.float64) delta_t tensor(0.8703, dtype=torch.float64)
15 gae_duplicate tensor(2.5500, dtype=torch.float64) tensor(-5.0153, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8436, dtype=torch.float64) delta_t tensor(0.7921, dtype=torch.float64)
14 gae_duplicate tensor(2.8321, dtype=torch.float64) tensor(-6.2631, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8470, dtype=torch.float64) delta_t tensor(0.7955, dtype=torch.float64)
13 gae_duplicate tensor(3.0612, dtype=torch.float64) tensor(-6.0203, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8504, dtype=torch.float64) delta_t tensor(0.8044, dtype=torch.float64)
12 gae_duplicate tensor(3.2533, dtype=torch.float64) tensor(-7.1955, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6591, dtype=torch.float64) delta_t tensor(0.6192, dtype=torch.float64)
11 gae_duplicate tensor(3.2218, dtype=torch.float64) tensor(-6.3350, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1168, dtype=torch.float64) delta_t tensor(-0.3190, dtype=torch.float64)
10 gae_duplicate tensor(2.2584, dtype=torch.float64) tensor(-4.1937, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3358, dtype=torch.float64) delta_t tensor(0.3198, dtype=torch.float64)
9 gae_duplicate tensor(2.1265, dtype=torch.float64) tensor(-3.9961, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2721, dtype=torch.float64) delta_t tensor(0.1729, dtype=torch.float64)
8 gae_duplicate tensor(1.8741, dtype=torch.float64) tensor(-3.5667, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2084, dtype=torch.float64) delta_t tensor(0.2960, dtype=torch.float64)
7 gae_duplicate tensor(1.7953, dtype=torch.float64) tensor(-3.3425, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4337, dtype=torch.float64) delta_t tensor(-0.3870, dtype=torch.float64)
6 gae_duplicate tensor(1.0492, dtype=torch.float64) tensor(-1.9535, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4610, dtype=torch.float64) delta_t tensor(-1.8739, dtype=torch.float64)
5 gae_duplicate tensor(-1.0345, dtype=torch.float64) tensor(1.9381, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3437, dtype=torch.float64) delta_t tensor(-1.2695, dtype=torch.float64)
4 gae_duplicate tensor(-2.0971, dtype=torch.float64) tensor(4.9448, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6107, dtype=torch.float64) delta_t tensor(-1.6733, dtype=torch.float64)
3 gae_duplicate tensor(-3.3509, dtype=torch.float64) tensor(7.8425, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2369, dtype=torch.float64) delta_t tensor(-1.2209, dtype=torch.float64)
2 gae_duplicate tensor(-3.9016, dtype=torch.float64) tensor(7.6065, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:220.4015655517578
value loss:153.66946411132812
entropies:37.055545806884766
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.60091495513916 seconds
19 rew tensor(0.8251, dtype=torch.float64) delta_t tensor(0.1339, dtype=torch.float64)
19 gae_duplicate tensor(0.1339, dtype=torch.float64) tensor(-0.3176, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8280, dtype=torch.float64) delta_t tensor(0.8060, dtype=torch.float64)
18 gae_duplicate tensor(0.9131, dtype=torch.float64) tensor(-1.6970, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8309, dtype=torch.float64) delta_t tensor(0.6672, dtype=torch.float64)
17 gae_duplicate tensor(1.3977, dtype=torch.float64) tensor(-2.6797, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8339, dtype=torch.float64) delta_t tensor(0.8560, dtype=torch.float64)
16 gae_duplicate tensor(1.9741, dtype=torch.float64) tensor(-3.6876, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8369, dtype=torch.float64) delta_t tensor(0.8783, dtype=torch.float64)
15 gae_duplicate tensor(2.4576, dtype=torch.float64) tensor(-4.8434, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8399, dtype=torch.float64) delta_t tensor(0.7719, dtype=torch.float64)
14 gae_duplicate tensor(2.7379, dtype=torch.float64) tensor(-5.3827, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8429, dtype=torch.float64) delta_t tensor(0.7866, dtype=torch.float64)
13 gae_duplicate tensor(2.9770, dtype=torch.float64) tensor(-6.5231, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8460, dtype=torch.float64) delta_t tensor(0.7924, dtype=torch.float64)
12 gae_duplicate tensor(3.1739, dtype=torch.float64) tensor(-6.2821, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8492, dtype=torch.float64) delta_t tensor(0.7984, dtype=torch.float64)
11 gae_duplicate tensor(3.3376, dtype=torch.float64) tensor(-7.2780, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8523, dtype=torch.float64) delta_t tensor(0.6738, dtype=torch.float64)
10 gae_duplicate tensor(3.3439, dtype=torch.float64) tensor(-6.2301, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8555, dtype=torch.float64) delta_t tensor(0.7753, dtype=torch.float64)
9 gae_duplicate tensor(3.4504, dtype=torch.float64) tensor(-6.4156, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0843, dtype=torch.float64) delta_t tensor(0.1274, dtype=torch.float64)
8 gae_duplicate tensor(2.8877, dtype=torch.float64) tensor(-5.3803, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3020, dtype=torch.float64) delta_t tensor(-0.4043, dtype=torch.float64)
7 gae_duplicate tensor(1.9059, dtype=torch.float64) tensor(-3.5418, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2668, dtype=torch.float64) delta_t tensor(-1.1076, dtype=torch.float64)
6 gae_duplicate tensor(0.4171, dtype=torch.float64) tensor(-0.9847, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5315, dtype=torch.float64) delta_t tensor(-1.8531, dtype=torch.float64)
5 gae_duplicate tensor(-1.5194, dtype=torch.float64) tensor(3.5792, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1240, dtype=torch.float64) delta_t tensor(-2.1558, dtype=torch.float64)
4 gae_duplicate tensor(-3.3713, dtype=torch.float64) tensor(6.2817, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7602, dtype=torch.float64) delta_t tensor(-1.8400, dtype=torch.float64)
3 gae_duplicate tensor(-4.5371, dtype=torch.float64) tensor(8.5420, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3842, dtype=torch.float64) delta_t tensor(-1.4698, dtype=torch.float64)
2 gae_duplicate tensor(-5.0995, dtype=torch.float64) tensor(9.6888, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:197.8004913330078
value loss:218.71636962890625
entropies:37.03179168701172
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.647783994674683 seconds
19 rew tensor(0.8192, dtype=torch.float64) delta_t tensor(0.1905, dtype=torch.float64)
19 gae_duplicate tensor(0.1905, dtype=torch.float64) tensor(-0.3577, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8219, dtype=torch.float64) delta_t tensor(0.7890, dtype=torch.float64)
18 gae_duplicate tensor(0.9413, dtype=torch.float64) tensor(-1.7811, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8245, dtype=torch.float64) delta_t tensor(0.6594, dtype=torch.float64)
17 gae_duplicate tensor(1.4124, dtype=torch.float64) tensor(-2.5890, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8272, dtype=torch.float64) delta_t tensor(0.8524, dtype=torch.float64)
16 gae_duplicate tensor(1.9823, dtype=torch.float64) tensor(-3.7460, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8300, dtype=torch.float64) delta_t tensor(0.7449, dtype=torch.float64)
15 gae_duplicate tensor(2.3308, dtype=torch.float64) tensor(-4.6884, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8327, dtype=torch.float64) delta_t tensor(0.7437, dtype=torch.float64)
14 gae_duplicate tensor(2.6083, dtype=torch.float64) tensor(-5.6142, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8355, dtype=torch.float64) delta_t tensor(0.7465, dtype=torch.float64)
13 gae_duplicate tensor(2.8331, dtype=torch.float64) tensor(-5.7124, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8383, dtype=torch.float64) delta_t tensor(0.7493, dtype=torch.float64)
12 gae_duplicate tensor(3.0158, dtype=torch.float64) tensor(-6.0663, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8411, dtype=torch.float64) delta_t tensor(0.7690, dtype=torch.float64)
11 gae_duplicate tensor(3.1816, dtype=torch.float64) tensor(-6.4293, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8440, dtype=torch.float64) delta_t tensor(0.7365, dtype=torch.float64)
10 gae_duplicate tensor(3.2818, dtype=torch.float64) tensor(-7.5317, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8469, dtype=torch.float64) delta_t tensor(0.7370, dtype=torch.float64)
9 gae_duplicate tensor(3.3624, dtype=torch.float64) tensor(-7.6720, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4005, dtype=torch.float64) delta_t tensor(0.4199, dtype=torch.float64)
8 gae_duplicate tensor(3.1098, dtype=torch.float64) tensor(-5.8138, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0811, dtype=torch.float64) delta_t tensor(0.0117, dtype=torch.float64)
7 gae_duplicate tensor(2.4996, dtype=torch.float64) tensor(-4.6609, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2615, dtype=torch.float64) delta_t tensor(-1.1159, dtype=torch.float64)
6 gae_duplicate tensor(0.8838, dtype=torch.float64) tensor(-1.6439, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5243, dtype=torch.float64) delta_t tensor(-1.8614, dtype=torch.float64)
5 gae_duplicate tensor(-1.1543, dtype=torch.float64) tensor(2.7161, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1124, dtype=torch.float64) delta_t tensor(-2.0852, dtype=torch.float64)
4 gae_duplicate tensor(-3.0087, dtype=torch.float64) tensor(5.6256, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8778, dtype=torch.float64) delta_t tensor(-1.9722, dtype=torch.float64)
3 gae_duplicate tensor(-4.3792, dtype=torch.float64) tensor(8.2337, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6355, dtype=torch.float64) delta_t tensor(-1.7242, dtype=torch.float64)
2 gae_duplicate tensor(-5.2275, dtype=torch.float64) tensor(10.0888, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:224.74237060546875
value loss:212.9886474609375
entropies:37.09980010986328
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.1156840324401855 seconds
19 rew tensor(0.8189, dtype=torch.float64) delta_t tensor(0.0571, dtype=torch.float64)
19 gae_duplicate tensor(0.0571, dtype=torch.float64) tensor(-0.1067, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8214, dtype=torch.float64) delta_t tensor(0.6795, dtype=torch.float64)
18 gae_duplicate tensor(0.7252, dtype=torch.float64) tensor(-1.3543, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8238, dtype=torch.float64) delta_t tensor(0.7745, dtype=torch.float64)
17 gae_duplicate tensor(1.3546, dtype=torch.float64) tensor(-2.5232, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8263, dtype=torch.float64) delta_t tensor(0.8587, dtype=torch.float64)
16 gae_duplicate tensor(1.9424, dtype=torch.float64) tensor(-4.5262, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8288, dtype=torch.float64) delta_t tensor(0.9310, dtype=torch.float64)
15 gae_duplicate tensor(2.4850, dtype=torch.float64) tensor(-5.0058, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8314, dtype=torch.float64) delta_t tensor(0.7738, dtype=torch.float64)
14 gae_duplicate tensor(2.7617, dtype=torch.float64) tensor(-5.5502, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8340, dtype=torch.float64) delta_t tensor(0.7763, dtype=torch.float64)
13 gae_duplicate tensor(2.9857, dtype=torch.float64) tensor(-6.4327, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8365, dtype=torch.float64) delta_t tensor(0.7789, dtype=torch.float64)
12 gae_duplicate tensor(3.1675, dtype=torch.float64) tensor(-6.3504, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8392, dtype=torch.float64) delta_t tensor(0.7815, dtype=torch.float64)
11 gae_duplicate tensor(3.3155, dtype=torch.float64) tensor(-6.6629, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8418, dtype=torch.float64) delta_t tensor(0.5771, dtype=torch.float64)
10 gae_duplicate tensor(3.2296, dtype=torch.float64) tensor(-6.0821, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4605, dtype=torch.float64) delta_t tensor(0.3608, dtype=torch.float64)
9 gae_duplicate tensor(2.9445, dtype=torch.float64) tensor(-5.5829, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2698, dtype=torch.float64) delta_t tensor(0.1310, dtype=torch.float64)
8 gae_duplicate tensor(2.4866, dtype=torch.float64) tensor(-4.6880, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0486, dtype=torch.float64) delta_t tensor(-0.0942, dtype=torch.float64)
7 gae_duplicate tensor(1.8950, dtype=torch.float64) tensor(-4.3769, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8763, dtype=torch.float64) delta_t tensor(-0.6839, dtype=torch.float64)
6 gae_duplicate tensor(0.8321, dtype=torch.float64) tensor(-1.5601, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3884, dtype=torch.float64) delta_t tensor(-1.5214, dtype=torch.float64)
5 gae_duplicate tensor(-0.8557, dtype=torch.float64) tensor(2.0075, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9699, dtype=torch.float64) delta_t tensor(-2.0846, dtype=torch.float64)
4 gae_duplicate tensor(-2.7691, dtype=torch.float64) tensor(6.5171, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9883, dtype=torch.float64) delta_t tensor(-2.1033, dtype=torch.float64)
3 gae_duplicate tensor(-4.3186, dtype=torch.float64) tensor(8.2041, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7494, dtype=torch.float64) delta_t tensor(-1.8515, dtype=torch.float64)
2 gae_duplicate tensor(-5.3064, dtype=torch.float64) tensor(10.1827, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:202.2334747314453
value loss:201.98147583007812
entropies:37.10395050048828
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.401159048080444 seconds
19 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.0092, dtype=torch.float64)
19 gae_duplicate tensor(0.0092, dtype=torch.float64) tensor(-0.0217, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8180, dtype=torch.float64) delta_t tensor(0.6594, dtype=torch.float64)
18 gae_duplicate tensor(0.6667, dtype=torch.float64) tensor(-1.2518, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8203, dtype=torch.float64) delta_t tensor(0.7570, dtype=torch.float64)
17 gae_duplicate tensor(1.2904, dtype=torch.float64) tensor(-3.0387, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8226, dtype=torch.float64) delta_t tensor(0.8092, dtype=torch.float64)
16 gae_duplicate tensor(1.8415, dtype=torch.float64) tensor(-3.4624, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8249, dtype=torch.float64) delta_t tensor(0.8319, dtype=torch.float64)
15 gae_duplicate tensor(2.3051, dtype=torch.float64) tensor(-4.9460, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8273, dtype=torch.float64) delta_t tensor(0.7361, dtype=torch.float64)
14 gae_duplicate tensor(2.5802, dtype=torch.float64) tensor(-5.5364, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8297, dtype=torch.float64) delta_t tensor(0.7385, dtype=torch.float64)
13 gae_duplicate tensor(2.8026, dtype=torch.float64) tensor(-6.0270, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8321, dtype=torch.float64) delta_t tensor(0.7409, dtype=torch.float64)
12 gae_duplicate tensor(2.9830, dtype=torch.float64) tensor(-6.4006, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8345, dtype=torch.float64) delta_t tensor(0.7433, dtype=torch.float64)
11 gae_duplicate tensor(3.1297, dtype=torch.float64) tensor(-6.3135, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8369, dtype=torch.float64) delta_t tensor(0.6547, dtype=torch.float64)
10 gae_duplicate tensor(3.1585, dtype=torch.float64) tensor(-7.3962, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8394, dtype=torch.float64) delta_t tensor(0.7364, dtype=torch.float64)
9 gae_duplicate tensor(3.2632, dtype=torch.float64) tensor(-7.6080, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1698, dtype=torch.float64) delta_t tensor(-0.1995, dtype=torch.float64)
8 gae_duplicate tensor(2.4111, dtype=torch.float64) tensor(-5.6762, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4225, dtype=torch.float64) delta_t tensor(-0.3999, dtype=torch.float64)
7 gae_duplicate tensor(1.5289, dtype=torch.float64) tensor(-3.5860, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4949, dtype=torch.float64) delta_t tensor(-1.3299, dtype=torch.float64)
6 gae_duplicate tensor(-0.1068, dtype=torch.float64) tensor(0.1993, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0087, dtype=torch.float64) delta_t tensor(-2.1946, dtype=torch.float64)
5 gae_duplicate tensor(-2.2800, dtype=torch.float64) tensor(4.3050, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4712, dtype=torch.float64) delta_t tensor(-2.4358, dtype=torch.float64)
4 gae_duplicate tensor(-4.2598, dtype=torch.float64) tensor(7.9728, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6054, dtype=torch.float64) delta_t tensor(-1.8361, dtype=torch.float64)
3 gae_duplicate tensor(-5.2440, dtype=torch.float64) tensor(9.9021, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.8728, dtype=torch.float64) delta_t tensor(-1.9872, dtype=torch.float64)
2 gae_duplicate tensor(-6.1824, dtype=torch.float64) tensor(12.0966, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:159.61959838867188
value loss:242.80685424804688
entropies:37.097721099853516
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.2611)
ToM Target loss= tensor(303.5479)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.508994817733765 seconds
19 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.0601, dtype=torch.float64)
19 gae_duplicate tensor(0.0601, dtype=torch.float64) tensor(-0.1407, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8171, dtype=torch.float64) delta_t tensor(0.7292, dtype=torch.float64)
18 gae_duplicate tensor(0.7773, dtype=torch.float64) tensor(-1.8064, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8192, dtype=torch.float64) delta_t tensor(0.6855, dtype=torch.float64)
17 gae_duplicate tensor(1.3073, dtype=torch.float64) tensor(-2.4501, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8214, dtype=torch.float64) delta_t tensor(0.7898, dtype=torch.float64)
16 gae_duplicate tensor(1.8357, dtype=torch.float64) tensor(-3.4805, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8236, dtype=torch.float64) delta_t tensor(0.8693, dtype=torch.float64)
15 gae_duplicate tensor(2.3378, dtype=torch.float64) tensor(-4.7343, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8258, dtype=torch.float64) delta_t tensor(0.7419, dtype=torch.float64)
14 gae_duplicate tensor(2.6121, dtype=torch.float64) tensor(-5.6080, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8280, dtype=torch.float64) delta_t tensor(0.7441, dtype=torch.float64)
13 gae_duplicate tensor(2.8338, dtype=torch.float64) tensor(-5.7255, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8302, dtype=torch.float64) delta_t tensor(0.7463, dtype=torch.float64)
12 gae_duplicate tensor(3.0134, dtype=torch.float64) tensor(-6.1024, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8325, dtype=torch.float64) delta_t tensor(0.7486, dtype=torch.float64)
11 gae_duplicate tensor(3.1593, dtype=torch.float64) tensor(-6.3681, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8347, dtype=torch.float64) delta_t tensor(0.5814, dtype=torch.float64)
10 gae_duplicate tensor(3.1088, dtype=torch.float64) tensor(-7.1274, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4579, dtype=torch.float64) delta_t tensor(0.3334, dtype=torch.float64)
9 gae_duplicate tensor(2.8205, dtype=torch.float64) tensor(-5.3812, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2064, dtype=torch.float64) delta_t tensor(0.0637, dtype=torch.float64)
8 gae_duplicate tensor(2.3201, dtype=torch.float64) tensor(-4.4237, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1712, dtype=torch.float64) delta_t tensor(-0.1663, dtype=torch.float64)
7 gae_duplicate tensor(1.6898, dtype=torch.float64) tensor(-3.2153, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9892, dtype=torch.float64) delta_t tensor(-0.8138, dtype=torch.float64)
6 gae_duplicate tensor(0.5380, dtype=torch.float64) tensor(-1.2486, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6214, dtype=torch.float64) delta_t tensor(-1.8379, dtype=torch.float64)
5 gae_duplicate tensor(-1.4075, dtype=torch.float64) tensor(2.6729, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0726, dtype=torch.float64) delta_t tensor(-2.1316, dtype=torch.float64)
4 gae_duplicate tensor(-3.2576, dtype=torch.float64) tensor(6.0842, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8372, dtype=torch.float64) delta_t tensor(-1.9483, dtype=torch.float64)
3 gae_duplicate tensor(-4.5544, dtype=torch.float64) tensor(10.2461, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4686, dtype=torch.float64) delta_t tensor(-1.5742, dtype=torch.float64)
2 gae_duplicate tensor(-5.2177, dtype=torch.float64) tensor(11.3955, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:163.36648559570312
value loss:197.66148376464844
entropies:37.16077423095703
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.316088914871216 seconds
19 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.0313, dtype=torch.float64)
19 gae_duplicate tensor(0.0313, dtype=torch.float64) tensor(-0.0586, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8177, dtype=torch.float64) delta_t tensor(0.7774, dtype=torch.float64)
18 gae_duplicate tensor(0.8024, dtype=torch.float64) tensor(-1.5155, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8197, dtype=torch.float64) delta_t tensor(0.6228, dtype=torch.float64)
17 gae_duplicate tensor(1.2647, dtype=torch.float64) tensor(-2.9744, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8217, dtype=torch.float64) delta_t tensor(0.7813, dtype=torch.float64)
16 gae_duplicate tensor(1.7931, dtype=torch.float64) tensor(-4.1447, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8238, dtype=torch.float64) delta_t tensor(0.8319, dtype=torch.float64)
15 gae_duplicate tensor(2.2664, dtype=torch.float64) tensor(-4.8622, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8258, dtype=torch.float64) delta_t tensor(0.7274, dtype=torch.float64)
14 gae_duplicate tensor(2.5405, dtype=torch.float64) tensor(-5.4383, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8279, dtype=torch.float64) delta_t tensor(0.7457, dtype=torch.float64)
13 gae_duplicate tensor(2.7781, dtype=torch.float64) tensor(-5.9589, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8300, dtype=torch.float64) delta_t tensor(0.7348, dtype=torch.float64)
12 gae_duplicate tensor(2.9573, dtype=torch.float64) tensor(-6.3294, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8321, dtype=torch.float64) delta_t tensor(0.7530, dtype=torch.float64)
11 gae_duplicate tensor(3.1189, dtype=torch.float64) tensor(-6.3062, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8342, dtype=torch.float64) delta_t tensor(0.5735, dtype=torch.float64)
10 gae_duplicate tensor(3.0686, dtype=torch.float64) tensor(-5.8126, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4566, dtype=torch.float64) delta_t tensor(0.3268, dtype=torch.float64)
9 gae_duplicate tensor(2.7817, dtype=torch.float64) tensor(-5.3235, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2678, dtype=torch.float64) delta_t tensor(0.1735, dtype=torch.float64)
8 gae_duplicate tensor(2.3988, dtype=torch.float64) tensor(-4.5680, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0473, dtype=torch.float64) delta_t tensor(-0.1968, dtype=torch.float64)
7 gae_duplicate tensor(1.7223, dtype=torch.float64) tensor(-3.3087, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8668, dtype=torch.float64) delta_t tensor(-0.6195, dtype=torch.float64)
6 gae_duplicate tensor(0.7583, dtype=torch.float64) tensor(-1.7228, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1211, dtype=torch.float64) delta_t tensor(-1.2926, dtype=torch.float64)
5 gae_duplicate tensor(-0.6860, dtype=torch.float64) tensor(1.5803, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9444, dtype=torch.float64) delta_t tensor(-2.0677, dtype=torch.float64)
4 gae_duplicate tensor(-2.6165, dtype=torch.float64) tensor(4.9346, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7057, dtype=torch.float64) delta_t tensor(-1.7925, dtype=torch.float64)
3 gae_duplicate tensor(-3.8857, dtype=torch.float64) tensor(7.5731, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4621, dtype=torch.float64) delta_t tensor(-1.5779, dtype=torch.float64)
2 gae_duplicate tensor(-4.6865, dtype=torch.float64) tensor(9.2029, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:209.08163452148438
value loss:171.10342407226562
entropies:37.17924880981445
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.448418855667114 seconds
19 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.0813, dtype=torch.float64)
19 gae_duplicate tensor(0.0813, dtype=torch.float64) tensor(-0.1887, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8172, dtype=torch.float64) delta_t tensor(0.7484, dtype=torch.float64)
18 gae_duplicate tensor(0.8135, dtype=torch.float64) tensor(-1.5474, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(0.5763, dtype=torch.float64)
17 gae_duplicate tensor(1.2271, dtype=torch.float64) tensor(-2.8803, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8210, dtype=torch.float64) delta_t tensor(0.7439, dtype=torch.float64)
16 gae_duplicate tensor(1.7256, dtype=torch.float64) tensor(-4.0125, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8230, dtype=torch.float64) delta_t tensor(0.7487, dtype=torch.float64)
15 gae_duplicate tensor(2.1291, dtype=torch.float64) tensor(-4.5943, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8249, dtype=torch.float64) delta_t tensor(0.6995, dtype=torch.float64)
14 gae_duplicate tensor(2.4027, dtype=torch.float64) tensor(-5.1959, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8269, dtype=torch.float64) delta_t tensor(0.7135, dtype=torch.float64)
13 gae_duplicate tensor(2.6357, dtype=torch.float64) tensor(-5.2907, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8289, dtype=torch.float64) delta_t tensor(0.7297, dtype=torch.float64)
12 gae_duplicate tensor(2.8382, dtype=torch.float64) tensor(-6.0932, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8308, dtype=torch.float64) delta_t tensor(0.7624, dtype=torch.float64)
11 gae_duplicate tensor(3.0330, dtype=torch.float64) tensor(-6.4350, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8328, dtype=torch.float64) delta_t tensor(0.6034, dtype=torch.float64)
10 gae_duplicate tensor(3.0299, dtype=torch.float64) tensor(-5.8138, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5182, dtype=torch.float64) delta_t tensor(0.3787, dtype=torch.float64)
9 gae_duplicate tensor(2.8026, dtype=torch.float64) tensor(-5.4102, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2661, dtype=torch.float64) delta_t tensor(0.2300, dtype=torch.float64)
8 gae_duplicate tensor(2.4721, dtype=torch.float64) tensor(-5.6341, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0494, dtype=torch.float64) delta_t tensor(-0.2012, dtype=torch.float64)
7 gae_duplicate tensor(1.7764, dtype=torch.float64) tensor(-3.3943, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1219, dtype=torch.float64) delta_t tensor(-0.9091, dtype=torch.float64)
6 gae_duplicate tensor(0.5120, dtype=torch.float64) tensor(-0.9871, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3780, dtype=torch.float64) delta_t tensor(-1.6235, dtype=torch.float64)
5 gae_duplicate tensor(-1.2139, dtype=torch.float64) tensor(2.3410, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9526, dtype=torch.float64) delta_t tensor(-1.9832, dtype=torch.float64)
4 gae_duplicate tensor(-2.9543, dtype=torch.float64) tensor(6.7589, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7126, dtype=torch.float64) delta_t tensor(-1.8224, dtype=torch.float64)
3 gae_duplicate tensor(-4.1858, dtype=torch.float64) tensor(8.1936, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4679, dtype=torch.float64) delta_t tensor(-1.6002, dtype=torch.float64)
2 gae_duplicate tensor(-4.9488, dtype=torch.float64) tensor(9.9086, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:180.53623962402344
value loss:177.65469360351562
entropies:37.208839416503906
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.416115045547485 seconds
19 rew tensor(0.8178, dtype=torch.float64) delta_t tensor(0.0350, dtype=torch.float64)
19 gae_duplicate tensor(0.0350, dtype=torch.float64) tensor(-0.0802, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8196, dtype=torch.float64) delta_t tensor(0.7183, dtype=torch.float64)
18 gae_duplicate tensor(0.7463, dtype=torch.float64) tensor(-1.4319, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8214, dtype=torch.float64) delta_t tensor(0.6416, dtype=torch.float64)
17 gae_duplicate tensor(1.2386, dtype=torch.float64) tensor(-2.3306, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8232, dtype=torch.float64) delta_t tensor(0.7198, dtype=torch.float64)
16 gae_duplicate tensor(1.7107, dtype=torch.float64) tensor(-3.2881, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8251, dtype=torch.float64) delta_t tensor(0.7185, dtype=torch.float64)
15 gae_duplicate tensor(2.0870, dtype=torch.float64) tensor(-4.4328, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8269, dtype=torch.float64) delta_t tensor(0.6996, dtype=torch.float64)
14 gae_duplicate tensor(2.3692, dtype=torch.float64) tensor(-4.8359, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8288, dtype=torch.float64) delta_t tensor(0.7040, dtype=torch.float64)
13 gae_duplicate tensor(2.5994, dtype=torch.float64) tensor(-5.3413, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8307, dtype=torch.float64) delta_t tensor(0.7094, dtype=torch.float64)
12 gae_duplicate tensor(2.7889, dtype=torch.float64) tensor(-5.8688, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8325, dtype=torch.float64) delta_t tensor(0.7482, dtype=torch.float64)
11 gae_duplicate tensor(2.9793, dtype=torch.float64) tensor(-6.2551, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8344, dtype=torch.float64) delta_t tensor(0.6035, dtype=torch.float64)
10 gae_duplicate tensor(2.9869, dtype=torch.float64) tensor(-6.7288, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3269, dtype=torch.float64) delta_t tensor(0.1582, dtype=torch.float64)
9 gae_duplicate tensor(2.5477, dtype=torch.float64) tensor(-5.7222, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0729, dtype=torch.float64) delta_t tensor(0.0645, dtype=torch.float64)
8 gae_duplicate tensor(2.1027, dtype=torch.float64) tensor(-4.7761, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3081, dtype=torch.float64) delta_t tensor(-0.5326, dtype=torch.float64)
7 gae_duplicate tensor(1.1495, dtype=torch.float64) tensor(-2.5666, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8796, dtype=torch.float64) delta_t tensor(-0.6507, dtype=torch.float64)
6 gae_duplicate tensor(0.2690, dtype=torch.float64) tensor(-0.5264, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1354, dtype=torch.float64) delta_t tensor(-1.3335, dtype=torch.float64)
5 gae_duplicate tensor(-1.1184, dtype=torch.float64) tensor(2.1792, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7100, dtype=torch.float64) delta_t tensor(-1.7592, dtype=torch.float64)
4 gae_duplicate tensor(-2.6539, dtype=torch.float64) tensor(5.1791, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4648, dtype=torch.float64) delta_t tensor(-1.6115, dtype=torch.float64)
3 gae_duplicate tensor(-3.7347, dtype=torch.float64) tensor(8.0567, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0889, dtype=torch.float64) delta_t tensor(-1.2011, dtype=torch.float64)
2 gae_duplicate tensor(-4.1888, dtype=torch.float64) tensor(8.9375, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:177.8755340576172
value loss:149.12095642089844
entropies:37.27115249633789
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5849769115448 seconds
19 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(-0.0075, dtype=torch.float64)
19 gae_duplicate tensor(-0.0075, dtype=torch.float64) tensor(0.0147, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.7012, dtype=torch.float64)
18 gae_duplicate tensor(0.6952, dtype=torch.float64) tensor(-1.5253, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8178, dtype=torch.float64) delta_t tensor(0.6618, dtype=torch.float64)
17 gae_duplicate tensor(1.2179, dtype=torch.float64) tensor(-2.3432, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8195, dtype=torch.float64) delta_t tensor(0.7158, dtype=torch.float64)
16 gae_duplicate tensor(1.6901, dtype=torch.float64) tensor(-3.7048, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8212, dtype=torch.float64) delta_t tensor(0.6321, dtype=torch.float64)
15 gae_duplicate tensor(1.9842, dtype=torch.float64) tensor(-4.1131, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8230, dtype=torch.float64) delta_t tensor(0.6695, dtype=torch.float64)
14 gae_duplicate tensor(2.2568, dtype=torch.float64) tensor(-4.6882, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8247, dtype=torch.float64) delta_t tensor(0.6830, dtype=torch.float64)
13 gae_duplicate tensor(2.4885, dtype=torch.float64) tensor(-5.1694, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8265, dtype=torch.float64) delta_t tensor(0.6754, dtype=torch.float64)
12 gae_duplicate tensor(2.6661, dtype=torch.float64) tensor(-5.5500, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8283, dtype=torch.float64) delta_t tensor(0.7129, dtype=torch.float64)
11 gae_duplicate tensor(2.8458, dtype=torch.float64) tensor(-5.9239, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8300, dtype=torch.float64) delta_t tensor(0.6687, dtype=torch.float64)
10 gae_duplicate tensor(2.9454, dtype=torch.float64) tensor(-5.8627, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8318, dtype=torch.float64) delta_t tensor(0.6551, dtype=torch.float64)
9 gae_duplicate tensor(3.0114, dtype=torch.float64) tensor(-6.0644, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2624, dtype=torch.float64) delta_t tensor(0.2685, dtype=torch.float64)
8 gae_duplicate tensor(2.6776, dtype=torch.float64) tensor(-5.8342, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0725, dtype=torch.float64) delta_t tensor(-0.0073, dtype=torch.float64)
7 gae_duplicate tensor(2.1348, dtype=torch.float64) tensor(-4.1643, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3836, dtype=torch.float64) delta_t tensor(-1.2281, dtype=torch.float64)
6 gae_duplicate tensor(0.4798, dtype=torch.float64) tensor(-0.9429, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6425, dtype=torch.float64) delta_t tensor(-1.8685, dtype=torch.float64)
5 gae_duplicate tensor(-1.4847, dtype=torch.float64) tensor(3.2252, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0951, dtype=torch.float64) delta_t tensor(-2.1090, dtype=torch.float64)
4 gae_duplicate tensor(-3.2968, dtype=torch.float64) tensor(7.2774, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7271, dtype=torch.float64) delta_t tensor(-1.8638, dtype=torch.float64)
3 gae_duplicate tensor(-4.5013, dtype=torch.float64) tensor(8.9653, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6081, dtype=torch.float64) delta_t tensor(-1.7198, dtype=torch.float64)
2 gae_duplicate tensor(-5.3208, dtype=torch.float64) tensor(11.0296, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:151.12452697753906
value loss:189.9003448486328
entropies:37.35289764404297
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.5961)
ToM Target loss= tensor(304.0939)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.478063106536865 seconds
19 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.0301, dtype=torch.float64)
19 gae_duplicate tensor(0.0301, dtype=torch.float64) tensor(-0.0597, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8173, dtype=torch.float64) delta_t tensor(0.6939, dtype=torch.float64)
18 gae_duplicate tensor(0.7180, dtype=torch.float64) tensor(-1.5532, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8190, dtype=torch.float64) delta_t tensor(0.6351, dtype=torch.float64)
17 gae_duplicate tensor(1.2095, dtype=torch.float64) tensor(-2.3521, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8206, dtype=torch.float64) delta_t tensor(0.7187, dtype=torch.float64)
16 gae_duplicate tensor(1.6863, dtype=torch.float64) tensor(-3.6656, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8222, dtype=torch.float64) delta_t tensor(0.7043, dtype=torch.float64)
15 gae_duplicate tensor(2.0533, dtype=torch.float64) tensor(-4.2742, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8239, dtype=torch.float64) delta_t tensor(0.6835, dtype=torch.float64)
14 gae_duplicate tensor(2.3262, dtype=torch.float64) tensor(-4.8422, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8256, dtype=torch.float64) delta_t tensor(0.6852, dtype=torch.float64)
13 gae_duplicate tensor(2.5461, dtype=torch.float64) tensor(-5.2891, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8273, dtype=torch.float64) delta_t tensor(0.7096, dtype=torch.float64)
12 gae_duplicate tensor(2.7465, dtype=torch.float64) tensor(-5.7170, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8290, dtype=torch.float64) delta_t tensor(0.7173, dtype=torch.float64)
11 gae_duplicate tensor(2.9145, dtype=torch.float64) tensor(-6.0545, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8307, dtype=torch.float64) delta_t tensor(0.5728, dtype=torch.float64)
10 gae_duplicate tensor(2.9044, dtype=torch.float64) tensor(-5.8075, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8324, dtype=torch.float64) delta_t tensor(0.7456, dtype=torch.float64)
9 gae_duplicate tensor(3.0691, dtype=torch.float64) tensor(-6.8219, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3039, dtype=torch.float64) delta_t tensor(-0.2034, dtype=torch.float64)
8 gae_duplicate tensor(2.2520, dtype=torch.float64) tensor(-5.0485, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9358, dtype=torch.float64) delta_t tensor(-1.2843, dtype=torch.float64)
7 gae_duplicate tensor(0.5173, dtype=torch.float64) tensor(-1.1278, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0011, dtype=torch.float64) delta_t tensor(-0.9770, dtype=torch.float64)
6 gae_duplicate tensor(-0.5632, dtype=torch.float64) tensor(1.1568, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2562, dtype=torch.float64) delta_t tensor(-0.9425, dtype=torch.float64)
5 gae_duplicate tensor(-1.3930, dtype=torch.float64) tensor(3.0375, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7025, dtype=torch.float64) delta_t tensor(-1.9374, dtype=torch.float64)
4 gae_duplicate tensor(-3.0518, dtype=torch.float64) tensor(5.8911, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.4708, dtype=torch.float64) delta_t tensor(-2.6941, dtype=torch.float64)
3 gae_duplicate tensor(-5.1356, dtype=torch.float64) tensor(10.7148, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0267, dtype=torch.float64) delta_t tensor(-1.0829, dtype=torch.float64)
2 gae_duplicate tensor(-5.1914, dtype=torch.float64) tensor(10.4274, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:127.19233703613281
value loss:187.59066772460938
entropies:37.35829544067383
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.513792037963867 seconds
19 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(-0.0761, dtype=torch.float64)
19 gae_duplicate tensor(-0.0761, dtype=torch.float64) tensor(0.1493, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.6413, dtype=torch.float64)
18 gae_duplicate tensor(0.5804, dtype=torch.float64) tensor(-1.2724, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.6933, dtype=torch.float64)
17 gae_duplicate tensor(1.1577, dtype=torch.float64) tensor(-2.2570, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8181, dtype=torch.float64) delta_t tensor(0.6662, dtype=torch.float64)
16 gae_duplicate tensor(1.5924, dtype=torch.float64) tensor(-3.1856, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8197, dtype=torch.float64) delta_t tensor(0.7766, dtype=torch.float64)
15 gae_duplicate tensor(2.0505, dtype=torch.float64) tensor(-4.2680, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8212, dtype=torch.float64) delta_t tensor(0.6819, dtype=torch.float64)
14 gae_duplicate tensor(2.3223, dtype=torch.float64) tensor(-4.8148, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8228, dtype=torch.float64) delta_t tensor(0.6835, dtype=torch.float64)
13 gae_duplicate tensor(2.5413, dtype=torch.float64) tensor(-5.2793, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8244, dtype=torch.float64) delta_t tensor(0.6851, dtype=torch.float64)
12 gae_duplicate tensor(2.7181, dtype=torch.float64) tensor(-5.6689, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8260, dtype=torch.float64) delta_t tensor(0.6867, dtype=torch.float64)
11 gae_duplicate tensor(2.8612, dtype=torch.float64) tensor(-5.9672, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8276, dtype=torch.float64) delta_t tensor(0.5524, dtype=torch.float64)
10 gae_duplicate tensor(2.8413, dtype=torch.float64) tensor(-6.1694, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8293, dtype=torch.float64) delta_t tensor(0.6711, dtype=torch.float64)
9 gae_duplicate tensor(2.9442, dtype=torch.float64) tensor(-5.9280, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0119, dtype=torch.float64) delta_t tensor(-0.1562, dtype=torch.float64)
8 gae_duplicate tensor(2.1992, dtype=torch.float64) tensor(-4.4567, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1769, dtype=torch.float64) delta_t tensor(-0.1162, dtype=torch.float64)
7 gae_duplicate tensor(1.6431, dtype=torch.float64) tensor(-3.5435, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2456, dtype=torch.float64) delta_t tensor(-1.0824, dtype=torch.float64)
6 gae_duplicate tensor(0.2321, dtype=torch.float64) tensor(-0.5041, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8783, dtype=torch.float64) delta_t tensor(-2.0139, dtype=torch.float64)
5 gae_duplicate tensor(-1.8282, dtype=torch.float64) tensor(3.8955, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2038, dtype=torch.float64) delta_t tensor(-2.1884, dtype=torch.float64)
4 gae_duplicate tensor(-3.6510, dtype=torch.float64) tensor(7.3604, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5854, dtype=torch.float64) delta_t tensor(-1.8020, dtype=torch.float64)
3 gae_duplicate tensor(-4.7228, dtype=torch.float64) tensor(9.5499, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7190, dtype=torch.float64) delta_t tensor(-1.8481, dtype=torch.float64)
2 gae_duplicate tensor(-5.6264, dtype=torch.float64) tensor(11.7111, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:122.77067565917969
value loss:196.218994140625
entropies:37.38289260864258
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.455083608627319 seconds
19 rew tensor(0.8102, dtype=torch.float64) delta_t tensor(-0.0046, dtype=torch.float64)
19 gae_duplicate tensor(-0.0046, dtype=torch.float64) tensor(0.0094, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(0.6796, dtype=torch.float64)
18 gae_duplicate tensor(0.6759, dtype=torch.float64) tensor(-1.3935, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.6087, dtype=torch.float64)
17 gae_duplicate tensor(1.1494, dtype=torch.float64) tensor(-2.2950, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.6415, dtype=torch.float64)
16 gae_duplicate tensor(1.5610, dtype=torch.float64) tensor(-3.2877, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.6082, dtype=torch.float64)
15 gae_duplicate tensor(1.8570, dtype=torch.float64) tensor(-3.8579, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8176, dtype=torch.float64) delta_t tensor(0.6419, dtype=torch.float64)
14 gae_duplicate tensor(2.1275, dtype=torch.float64) tensor(-4.4198, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(0.6434, dtype=torch.float64)
13 gae_duplicate tensor(2.3453, dtype=torch.float64) tensor(-4.8816, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8206, dtype=torch.float64) delta_t tensor(0.6532, dtype=torch.float64)
12 gae_duplicate tensor(2.5295, dtype=torch.float64) tensor(-5.2747, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8221, dtype=torch.float64) delta_t tensor(0.6481, dtype=torch.float64)
11 gae_duplicate tensor(2.6717, dtype=torch.float64) tensor(-5.5505, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8236, dtype=torch.float64) delta_t tensor(0.6450, dtype=torch.float64)
10 gae_duplicate tensor(2.7823, dtype=torch.float64) tensor(-5.7257, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8252, dtype=torch.float64) delta_t tensor(0.6512, dtype=torch.float64)
9 gae_duplicate tensor(2.8771, dtype=torch.float64) tensor(-5.9892, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1127, dtype=torch.float64) delta_t tensor(0.1285, dtype=torch.float64)
8 gae_duplicate tensor(2.4302, dtype=torch.float64) tensor(-5.0484, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3005, dtype=torch.float64) delta_t tensor(-0.3888, dtype=torch.float64)
7 gae_duplicate tensor(1.5553, dtype=torch.float64) tensor(-3.3735, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.9257, dtype=torch.float64) delta_t tensor(-1.8681, dtype=torch.float64)
6 gae_duplicate tensor(-0.6238, dtype=torch.float64) tensor(1.3454, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1240, dtype=torch.float64) delta_t tensor(-2.2788, dtype=torch.float64)
5 gae_duplicate tensor(-2.7779, dtype=torch.float64) tensor(5.7567, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2002, dtype=torch.float64) delta_t tensor(-2.2133, dtype=torch.float64)
4 gae_duplicate tensor(-4.4356, dtype=torch.float64) tensor(9.1510, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4563, dtype=torch.float64) delta_t tensor(-1.6398, dtype=torch.float64)
3 gae_duplicate tensor(-5.1883, dtype=torch.float64) tensor(10.9373, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5880, dtype=torch.float64) delta_t tensor(-1.6411, dtype=torch.float64)
2 gae_duplicate tensor(-5.7917, dtype=torch.float64) tensor(12.0325, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:70.06884002685547
value loss:215.71896362304688
entropies:37.4178581237793
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.519009113311768 seconds
19 rew tensor(0.8112, dtype=torch.float64) delta_t tensor(-0.0158, dtype=torch.float64)
19 gae_duplicate tensor(-0.0158, dtype=torch.float64) tensor(0.0325, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8126, dtype=torch.float64) delta_t tensor(0.6570, dtype=torch.float64)
18 gae_duplicate tensor(0.6444, dtype=torch.float64) tensor(-1.3386, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(0.5964, dtype=torch.float64)
17 gae_duplicate tensor(1.1119, dtype=torch.float64) tensor(-2.2131, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.6643, dtype=torch.float64)
16 gae_duplicate tensor(1.5538, dtype=torch.float64) tensor(-3.2996, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(0.6019, dtype=torch.float64)
15 gae_duplicate tensor(1.8450, dtype=torch.float64) tensor(-3.8399, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8183, dtype=torch.float64) delta_t tensor(0.6392, dtype=torch.float64)
14 gae_duplicate tensor(2.1152, dtype=torch.float64) tensor(-4.4020, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8197, dtype=torch.float64) delta_t tensor(0.6377, dtype=torch.float64)
13 gae_duplicate tensor(2.3298, dtype=torch.float64) tensor(-4.8491, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8212, dtype=torch.float64) delta_t tensor(0.6388, dtype=torch.float64)
12 gae_duplicate tensor(2.5026, dtype=torch.float64) tensor(-5.1905, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8226, dtype=torch.float64) delta_t tensor(0.7720, dtype=torch.float64)
11 gae_duplicate tensor(2.7741, dtype=torch.float64) tensor(-5.7838, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8241, dtype=torch.float64) delta_t tensor(0.5153, dtype=torch.float64)
10 gae_duplicate tensor(2.7346, dtype=torch.float64) tensor(-5.7032, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3217, dtype=torch.float64) delta_t tensor(0.1674, dtype=torch.float64)
9 gae_duplicate tensor(2.3551, dtype=torch.float64) tensor(-4.9100, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1333, dtype=torch.float64) delta_t tensor(0.0652, dtype=torch.float64)
8 gae_duplicate tensor(1.9492, dtype=torch.float64) tensor(-4.0571, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0551, dtype=torch.float64) delta_t tensor(-0.2239, dtype=torch.float64)
7 gae_duplicate tensor(1.3355, dtype=torch.float64) tensor(-2.7747, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9969, dtype=torch.float64) delta_t tensor(-0.8767, dtype=torch.float64)
6 gae_duplicate tensor(0.1916, dtype=torch.float64) tensor(-0.3981, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2502, dtype=torch.float64) delta_t tensor(-1.2757, dtype=torch.float64)
5 gae_duplicate tensor(-1.1224, dtype=torch.float64) tensor(2.3359, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5677, dtype=torch.float64) delta_t tensor(-1.7385, dtype=torch.float64)
4 gae_duplicate tensor(-2.6364, dtype=torch.float64) tensor(5.4677, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3219, dtype=torch.float64) delta_t tensor(-1.4365, dtype=torch.float64)
3 gae_duplicate tensor(-3.5456, dtype=torch.float64) tensor(7.3792, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1999, dtype=torch.float64) delta_t tensor(-1.3305, dtype=torch.float64)
2 gae_duplicate tensor(-4.1669, dtype=torch.float64) tensor(8.6878, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:148.01686096191406
value loss:132.18014526367188
entropies:37.424156188964844
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.378211736679077 seconds
19 rew tensor(0.8096, dtype=torch.float64) delta_t tensor(-0.1326, dtype=torch.float64)
19 gae_duplicate tensor(-0.1326, dtype=torch.float64) tensor(0.2760, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8109, dtype=torch.float64) delta_t tensor(0.6313, dtype=torch.float64)
18 gae_duplicate tensor(0.5252, dtype=torch.float64) tensor(-1.0947, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8123, dtype=torch.float64) delta_t tensor(0.6576, dtype=torch.float64)
17 gae_duplicate tensor(1.0777, dtype=torch.float64) tensor(-2.2492, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.5822, dtype=torch.float64)
16 gae_duplicate tensor(1.4444, dtype=torch.float64) tensor(-3.0060, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.7632, dtype=torch.float64)
15 gae_duplicate tensor(1.9187, dtype=torch.float64) tensor(-3.9801, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(0.6536, dtype=torch.float64)
14 gae_duplicate tensor(2.1885, dtype=torch.float64) tensor(-4.5472, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8177, dtype=torch.float64) delta_t tensor(0.6759, dtype=torch.float64)
13 gae_duplicate tensor(2.4267, dtype=torch.float64) tensor(-5.0421, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(0.6605, dtype=torch.float64)
12 gae_duplicate tensor(2.6019, dtype=torch.float64) tensor(-5.4061, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8205, dtype=torch.float64) delta_t tensor(0.6619, dtype=torch.float64)
11 gae_duplicate tensor(2.7434, dtype=torch.float64) tensor(-5.6910, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8219, dtype=torch.float64) delta_t tensor(0.4928, dtype=torch.float64)
10 gae_duplicate tensor(2.6876, dtype=torch.float64) tensor(-5.5933, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8233, dtype=torch.float64) delta_t tensor(0.6082, dtype=torch.float64)
9 gae_duplicate tensor(2.7583, dtype=torch.float64) tensor(-5.7495, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3849, dtype=torch.float64) delta_t tensor(0.2349, dtype=torch.float64)
8 gae_duplicate tensor(2.4415, dtype=torch.float64) tensor(-5.0730, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0715, dtype=torch.float64) delta_t tensor(-0.1328, dtype=torch.float64)
7 gae_duplicate tensor(1.8204, dtype=torch.float64) tensor(-3.7764, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9944, dtype=torch.float64) delta_t tensor(-0.6832, dtype=torch.float64)
6 gae_duplicate tensor(0.7732, dtype=torch.float64) tensor(-1.6065, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2473, dtype=torch.float64) delta_t tensor(-1.3064, dtype=torch.float64)
5 gae_duplicate tensor(-0.6879, dtype=torch.float64) tensor(1.4339, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0663, dtype=torch.float64) delta_t tensor(-2.1653, dtype=torch.float64)
4 gae_duplicate tensor(-2.7156, dtype=torch.float64) tensor(5.6516, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9517, dtype=torch.float64) delta_t tensor(-2.0320, dtype=torch.float64)
3 gae_duplicate tensor(-4.2045, dtype=torch.float64) tensor(8.7501, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7089, dtype=torch.float64) delta_t tensor(-1.9256, dtype=torch.float64)
2 gae_duplicate tensor(-5.2892, dtype=torch.float64) tensor(10.9893, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:153.16189575195312
value loss:165.60333251953125
entropies:37.42984390258789
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(418.0007)
ToM Target loss= tensor(305.1061)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.367326974868774 seconds
19 rew tensor(0.8114, dtype=torch.float64) delta_t tensor(-0.1376, dtype=torch.float64)
19 gae_duplicate tensor(-0.1376, dtype=torch.float64) tensor(0.2867, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(0.6508, dtype=torch.float64)
18 gae_duplicate tensor(0.5407, dtype=torch.float64) tensor(-1.1252, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(0.6034, dtype=torch.float64)
17 gae_duplicate tensor(1.0360, dtype=torch.float64) tensor(-2.1559, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.6095, dtype=torch.float64)
16 gae_duplicate tensor(1.4383, dtype=torch.float64) tensor(-2.9975, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(0.6342, dtype=torch.float64)
15 gae_duplicate tensor(1.7849, dtype=torch.float64) tensor(-3.7088, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8180, dtype=torch.float64) delta_t tensor(0.6273, dtype=torch.float64)
14 gae_duplicate tensor(2.0552, dtype=torch.float64) tensor(-4.2704, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8193, dtype=torch.float64) delta_t tensor(0.6456, dtype=torch.float64)
13 gae_duplicate tensor(2.2897, dtype=torch.float64) tensor(-4.7649, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8206, dtype=torch.float64) delta_t tensor(0.6513, dtype=torch.float64)
12 gae_duplicate tensor(2.4831, dtype=torch.float64) tensor(-5.1672, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8220, dtype=torch.float64) delta_t tensor(0.6671, dtype=torch.float64)
11 gae_duplicate tensor(2.6536, dtype=torch.float64) tensor(-5.5222, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8233, dtype=torch.float64) delta_t tensor(0.5157, dtype=torch.float64)
10 gae_duplicate tensor(2.6386, dtype=torch.float64) tensor(-5.4749, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3213, dtype=torch.float64) delta_t tensor(0.0950, dtype=torch.float64)
9 gae_duplicate tensor(2.2058, dtype=torch.float64) tensor(-4.5837, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0702, dtype=torch.float64) delta_t tensor(-0.0136, dtype=torch.float64)
8 gae_duplicate tensor(1.7510, dtype=torch.float64) tensor(-3.6492, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3066, dtype=torch.float64) delta_t tensor(-0.5852, dtype=torch.float64)
7 gae_duplicate tensor(0.8157, dtype=torch.float64) tensor(-1.6948, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9972, dtype=torch.float64) delta_t tensor(-0.6673, dtype=torch.float64)
6 gae_duplicate tensor(-0.0148, dtype=torch.float64) tensor(0.0307, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2502, dtype=torch.float64) delta_t tensor(-1.3137, dtype=torch.float64)
5 gae_duplicate tensor(-1.3255, dtype=torch.float64) tensor(2.7584, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9440, dtype=torch.float64) delta_t tensor(-2.0810, dtype=torch.float64)
4 gae_duplicate tensor(-3.1414, dtype=torch.float64) tensor(6.5274, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7015, dtype=torch.float64) delta_t tensor(-1.8316, dtype=torch.float64)
3 gae_duplicate tensor(-4.3447, dtype=torch.float64) tensor(9.0280, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3296, dtype=torch.float64) delta_t tensor(-1.4849, dtype=torch.float64)
2 gae_duplicate tensor(-4.9607, dtype=torch.float64) tensor(10.3075, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:95.93310546875
value loss:149.97467041015625
entropies:37.42987823486328
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.235601902008057 seconds
19 rew tensor(0.8111, dtype=torch.float64) delta_t tensor(-0.1854, dtype=torch.float64)
19 gae_duplicate tensor(-0.1854, dtype=torch.float64) tensor(0.3847, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8123, dtype=torch.float64) delta_t tensor(0.6199, dtype=torch.float64)
18 gae_duplicate tensor(0.4716, dtype=torch.float64) tensor(-0.9812, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.6039, dtype=torch.float64)
17 gae_duplicate tensor(0.9811, dtype=torch.float64) tensor(-2.0388, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.5704, dtype=torch.float64)
16 gae_duplicate tensor(1.3553, dtype=torch.float64) tensor(-2.8164, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.6332, dtype=torch.float64)
15 gae_duplicate tensor(1.7174, dtype=torch.float64) tensor(-3.5640, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8173, dtype=torch.float64) delta_t tensor(0.6135, dtype=torch.float64)
14 gae_duplicate tensor(1.9874, dtype=torch.float64) tensor(-4.1244, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8186, dtype=torch.float64) delta_t tensor(0.6360, dtype=torch.float64)
13 gae_duplicate tensor(2.2259, dtype=torch.float64) tensor(-4.6378, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8199, dtype=torch.float64) delta_t tensor(0.6203, dtype=torch.float64)
12 gae_duplicate tensor(2.4010, dtype=torch.float64) tensor(-4.9893, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8212, dtype=torch.float64) delta_t tensor(0.6216, dtype=torch.float64)
11 gae_duplicate tensor(2.5424, dtype=torch.float64) tensor(-5.2902, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8225, dtype=torch.float64) delta_t tensor(0.5174, dtype=torch.float64)
10 gae_duplicate tensor(2.5513, dtype=torch.float64) tensor(-5.3089, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8238, dtype=torch.float64) delta_t tensor(0.5855, dtype=torch.float64)
9 gae_duplicate tensor(2.6265, dtype=torch.float64) tensor(-5.4653, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0098, dtype=torch.float64) delta_t tensor(-0.0277, dtype=torch.float64)
8 gae_duplicate tensor(2.0735, dtype=torch.float64) tensor(-4.3031, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3034, dtype=torch.float64) delta_t tensor(-0.5754, dtype=torch.float64)
7 gae_duplicate tensor(1.0835, dtype=torch.float64) tensor(-2.2544, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3679, dtype=torch.float64) delta_t tensor(-1.0442, dtype=torch.float64)
6 gae_duplicate tensor(-0.1774, dtype=torch.float64) tensor(0.3691, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6223, dtype=torch.float64) delta_t tensor(-1.6842, dtype=torch.float64)
5 gae_duplicate tensor(-1.8261, dtype=torch.float64) tensor(3.7897, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1926, dtype=torch.float64) delta_t tensor(-2.3005, dtype=torch.float64)
4 gae_duplicate tensor(-3.7614, dtype=torch.float64) tensor(7.8163, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8270, dtype=torch.float64) delta_t tensor(-1.9452, dtype=torch.float64)
3 gae_duplicate tensor(-4.9544, dtype=torch.float64) tensor(10.3092, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5821, dtype=torch.float64) delta_t tensor(-1.8083, dtype=torch.float64)
2 gae_duplicate tensor(-5.7718, dtype=torch.float64) tensor(12.0099, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:65.44732666015625
value loss:182.08885192871094
entropies:37.42989730834961
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.279783248901367 seconds
19 rew tensor(0.8103, dtype=torch.float64) delta_t tensor(-0.2304, dtype=torch.float64)
19 gae_duplicate tensor(-0.2304, dtype=torch.float64) tensor(0.4782, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8115, dtype=torch.float64) delta_t tensor(0.6070, dtype=torch.float64)
18 gae_duplicate tensor(0.4227, dtype=torch.float64) tensor(-0.8784, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(0.5691, dtype=torch.float64)
17 gae_duplicate tensor(0.9072, dtype=torch.float64) tensor(-1.8854, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(0.5191, dtype=torch.float64)
16 gae_duplicate tensor(1.2449, dtype=torch.float64) tensor(-2.5903, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.6139, dtype=torch.float64)
15 gae_duplicate tensor(1.6098, dtype=torch.float64) tensor(-3.3415, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(0.5916, dtype=torch.float64)
14 gae_duplicate tensor(1.8794, dtype=torch.float64) tensor(-3.9059, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8176, dtype=torch.float64) delta_t tensor(0.6157, dtype=torch.float64)
13 gae_duplicate tensor(2.1192, dtype=torch.float64) tensor(-4.4149, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8189, dtype=torch.float64) delta_t tensor(0.6219, dtype=torch.float64)
12 gae_duplicate tensor(2.3173, dtype=torch.float64) tensor(-4.8216, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8201, dtype=torch.float64) delta_t tensor(0.6282, dtype=torch.float64)
11 gae_duplicate tensor(2.4821, dtype=torch.float64) tensor(-5.1708, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8213, dtype=torch.float64) delta_t tensor(0.4223, dtype=torch.float64)
10 gae_duplicate tensor(2.4080, dtype=torch.float64) tensor(-5.0044, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8226, dtype=torch.float64) delta_t tensor(0.5588, dtype=torch.float64)
9 gae_duplicate tensor(2.4852, dtype=torch.float64) tensor(-5.1585, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2599, dtype=torch.float64) delta_t tensor(0.0728, dtype=torch.float64)
8 gae_duplicate tensor(2.0609, dtype=torch.float64) tensor(-4.2831, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0529, dtype=torch.float64) delta_t tensor(-0.3487, dtype=torch.float64)
7 gae_duplicate tensor(1.3001, dtype=torch.float64) tensor(-2.7050, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9912, dtype=torch.float64) delta_t tensor(-0.5830, dtype=torch.float64)
6 gae_duplicate tensor(0.4570, dtype=torch.float64) tensor(-0.9498, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2432, dtype=torch.float64) delta_t tensor(-1.2426, dtype=torch.float64)
5 gae_duplicate tensor(-0.8770, dtype=torch.float64) tensor(1.8225, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0597, dtype=torch.float64) delta_t tensor(-2.1738, dtype=torch.float64)
4 gae_duplicate tensor(-2.8754, dtype=torch.float64) tensor(5.9829, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8186, dtype=torch.float64) delta_t tensor(-1.8797, dtype=torch.float64)
3 gae_duplicate tensor(-4.1800, dtype=torch.float64) tensor(8.6867, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5742, dtype=torch.float64) delta_t tensor(-1.8305, dtype=torch.float64)
2 gae_duplicate tensor(-5.1745, dtype=torch.float64) tensor(10.7663, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:103.11441802978516
value loss:144.23431396484375
entropies:37.429901123046875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.429744243621826 seconds
19 rew tensor(0.8110, dtype=torch.float64) delta_t tensor(-0.2985, dtype=torch.float64)
19 gae_duplicate tensor(-0.2985, dtype=torch.float64) tensor(0.6203, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8122, dtype=torch.float64) delta_t tensor(0.5198, dtype=torch.float64)
18 gae_duplicate tensor(0.2811, dtype=torch.float64) tensor(-0.5848, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(0.6669, dtype=torch.float64)
17 gae_duplicate tensor(0.8917, dtype=torch.float64) tensor(-1.8533, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.3544, dtype=torch.float64)
16 gae_duplicate tensor(1.0678, dtype=torch.float64) tensor(-2.2192, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.5518, dtype=torch.float64)
15 gae_duplicate tensor(1.4061, dtype=torch.float64) tensor(-2.9222, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8169, dtype=torch.float64) delta_t tensor(0.5509, dtype=torch.float64)
14 gae_duplicate tensor(1.6758, dtype=torch.float64) tensor(-3.4828, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8180, dtype=torch.float64) delta_t tensor(0.5666, dtype=torch.float64)
13 gae_duplicate tensor(1.9072, dtype=torch.float64) tensor(-3.9680, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8192, dtype=torch.float64) delta_t tensor(0.5750, dtype=torch.float64)
12 gae_duplicate tensor(2.1008, dtype=torch.float64) tensor(-4.3660, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8204, dtype=torch.float64) delta_t tensor(0.5880, dtype=torch.float64)
11 gae_duplicate tensor(2.2686, dtype=torch.float64) tensor(-4.7147, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8216, dtype=torch.float64) delta_t tensor(0.4445, dtype=torch.float64)
10 gae_duplicate tensor(2.2593, dtype=torch.float64) tensor(-4.7058, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4458, dtype=torch.float64) delta_t tensor(0.1592, dtype=torch.float64)
9 gae_duplicate tensor(1.9667, dtype=torch.float64) tensor(-4.0872, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1950, dtype=torch.float64) delta_t tensor(0.0634, dtype=torch.float64)
8 gae_duplicate tensor(1.6367, dtype=torch.float64) tensor(-3.4014, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1813, dtype=torch.float64) delta_t tensor(-0.5692, dtype=torch.float64)
7 gae_duplicate tensor(0.7401, dtype=torch.float64) tensor(-1.5366, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9965, dtype=torch.float64) delta_t tensor(-0.5923, dtype=torch.float64)
6 gae_duplicate tensor(-0.0001, dtype=torch.float64) tensor(0.0003, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2490, dtype=torch.float64) delta_t tensor(-1.1357, dtype=torch.float64)
5 gae_duplicate tensor(-1.1358, dtype=torch.float64) tensor(2.3605, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8164, dtype=torch.float64) delta_t tensor(-1.9191, dtype=torch.float64)
4 gae_duplicate tensor(-2.8278, dtype=torch.float64) tensor(5.8836, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5719, dtype=torch.float64) delta_t tensor(-1.8272, dtype=torch.float64)
3 gae_duplicate tensor(-4.0894, dtype=torch.float64) tensor(8.5084, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1992, dtype=torch.float64) delta_t tensor(-1.3929, dtype=torch.float64)
2 gae_duplicate tensor(-4.6645, dtype=torch.float64) tensor(9.6834, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:63.590240478515625
value loss:120.07733917236328
entropies:37.42991256713867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.2426440715789795 seconds
19 rew tensor(0.8107, dtype=torch.float64) delta_t tensor(-0.3470, dtype=torch.float64)
19 gae_duplicate tensor(-0.3470, dtype=torch.float64) tensor(0.7213, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(0.5220, dtype=torch.float64)
18 gae_duplicate tensor(0.2444, dtype=torch.float64) tensor(-0.5080, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(0.5324, dtype=torch.float64)
17 gae_duplicate tensor(0.7279, dtype=torch.float64) tensor(-1.5128, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.6020, dtype=torch.float64)
16 gae_duplicate tensor(1.1843, dtype=torch.float64) tensor(-2.4639, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.2390, dtype=torch.float64)
15 gae_duplicate tensor(1.1864, dtype=torch.float64) tensor(-2.4682, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.5067, dtype=torch.float64)
14 gae_duplicate tensor(1.4558, dtype=torch.float64) tensor(-3.0258, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8175, dtype=torch.float64) delta_t tensor(0.5117, dtype=torch.float64)
13 gae_duplicate tensor(1.6764, dtype=torch.float64) tensor(-3.4877, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8186, dtype=torch.float64) delta_t tensor(0.5223, dtype=torch.float64)
12 gae_duplicate tensor(1.8634, dtype=torch.float64) tensor(-3.8805, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8198, dtype=torch.float64) delta_t tensor(0.6619, dtype=torch.float64)
11 gae_duplicate tensor(2.1526, dtype=torch.float64) tensor(-4.4740, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8209, dtype=torch.float64) delta_t tensor(0.3930, dtype=torch.float64)
10 gae_duplicate tensor(2.1151, dtype=torch.float64) tensor(-4.4005, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5070, dtype=torch.float64) delta_t tensor(0.2055, dtype=torch.float64)
9 gae_duplicate tensor(1.8976, dtype=torch.float64) tensor(-3.9441, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2556, dtype=torch.float64) delta_t tensor(0.1013, dtype=torch.float64)
8 gae_duplicate tensor(1.6194, dtype=torch.float64) tensor(-3.3690, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0589, dtype=torch.float64) delta_t tensor(-0.3416, dtype=torch.float64)
7 gae_duplicate tensor(0.9539, dtype=torch.float64) tensor(-1.9846, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1279, dtype=torch.float64) delta_t tensor(-0.8246, dtype=torch.float64)
6 gae_duplicate tensor(-0.0615, dtype=torch.float64) tensor(0.1280, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3817, dtype=torch.float64) delta_t tensor(-1.1662, dtype=torch.float64)
5 gae_duplicate tensor(-1.2153, dtype=torch.float64) tensor(2.5311, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6999, dtype=torch.float64) delta_t tensor(-1.8895, dtype=torch.float64)
4 gae_duplicate tensor(-2.8618, dtype=torch.float64) tensor(5.9539, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4534, dtype=torch.float64) delta_t tensor(-1.6697, dtype=torch.float64)
3 gae_duplicate tensor(-3.9591, dtype=torch.float64) tensor(8.2286, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2048, dtype=torch.float64) delta_t tensor(-1.3038, dtype=torch.float64)
2 gae_duplicate tensor(-4.4711, dtype=torch.float64) tensor(9.2927, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:50.85721969604492
value loss:110.24695587158203
entropies:37.42992401123047
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.8175)
ToM Target loss= tensor(305.5126)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.630204200744629 seconds
19 rew tensor(0.8091, dtype=torch.float64) delta_t tensor(-0.5447, dtype=torch.float64)
19 gae_duplicate tensor(-0.5447, dtype=torch.float64) tensor(1.1311, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8102, dtype=torch.float64) delta_t tensor(0.5450, dtype=torch.float64)
18 gae_duplicate tensor(0.1093, dtype=torch.float64) tensor(-0.2276, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8112, dtype=torch.float64) delta_t tensor(0.5340, dtype=torch.float64)
17 gae_duplicate tensor(0.6214, dtype=torch.float64) tensor(-1.2940, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8123, dtype=torch.float64) delta_t tensor(0.2368, dtype=torch.float64)
16 gae_duplicate tensor(0.7339, dtype=torch.float64) tensor(-1.5254, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(0.4445, dtype=torch.float64)
15 gae_duplicate tensor(1.0316, dtype=torch.float64) tensor(-2.1462, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.5005, dtype=torch.float64)
14 gae_duplicate tensor(1.3258, dtype=torch.float64) tensor(-2.7558, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.4813, dtype=torch.float64)
13 gae_duplicate tensor(1.5420, dtype=torch.float64) tensor(-3.2079, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(0.5293, dtype=torch.float64)
12 gae_duplicate tensor(1.7629, dtype=torch.float64) tensor(-3.6675, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8179, dtype=torch.float64) delta_t tensor(0.4929, dtype=torch.float64)
11 gae_duplicate tensor(1.9032, dtype=torch.float64) tensor(-3.9630, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8190, dtype=torch.float64) delta_t tensor(0.4480, dtype=torch.float64)
10 gae_duplicate tensor(1.9706, dtype=torch.float64) tensor(-4.0995, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6308, dtype=torch.float64) delta_t tensor(0.2724, dtype=torch.float64)
9 gae_duplicate tensor(1.8489, dtype=torch.float64) tensor(-3.8498, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3794, dtype=torch.float64) delta_t tensor(0.4561, dtype=torch.float64)
8 gae_duplicate tensor(1.9352, dtype=torch.float64) tensor(-4.0187, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0647, dtype=torch.float64) delta_t tensor(-0.4072, dtype=torch.float64)
7 gae_duplicate tensor(1.1409, dtype=torch.float64) tensor(-2.3713, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3203, dtype=torch.float64) delta_t tensor(-0.9806, dtype=torch.float64)
6 gae_duplicate tensor(-0.0679, dtype=torch.float64) tensor(0.1410, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5123, dtype=torch.float64) delta_t tensor(-1.2447, dtype=torch.float64)
5 gae_duplicate tensor(-1.2990, dtype=torch.float64) tensor(2.7023, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8317, dtype=torch.float64) delta_t tensor(-2.0189, dtype=torch.float64)
4 gae_duplicate tensor(-3.0581, dtype=torch.float64) tensor(6.3622, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5856, dtype=torch.float64) delta_t tensor(-1.7637, dtype=torch.float64)
3 gae_duplicate tensor(-4.2102, dtype=torch.float64) tensor(8.7506, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3372, dtype=torch.float64) delta_t tensor(-1.4549, dtype=torch.float64)
2 gae_duplicate tensor(-4.8231, dtype=torch.float64) tensor(10.0339, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:22.911083221435547
value loss:116.31401062011719
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.183753967285156 seconds
19 rew tensor(0.8104, dtype=torch.float64) delta_t tensor(-0.4948, dtype=torch.float64)
19 gae_duplicate tensor(-0.4948, dtype=torch.float64) tensor(1.0293, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8115, dtype=torch.float64) delta_t tensor(0.3746, dtype=torch.float64)
18 gae_duplicate tensor(-0.0212, dtype=torch.float64) tensor(0.0441, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8125, dtype=torch.float64) delta_t tensor(0.5349, dtype=torch.float64)
17 gae_duplicate tensor(0.5179, dtype=torch.float64) tensor(-1.0783, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.4837, dtype=torch.float64)
16 gae_duplicate tensor(0.8980, dtype=torch.float64) tensor(-1.8682, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.0678, dtype=torch.float64)
15 gae_duplicate tensor(0.7862, dtype=torch.float64) tensor(-1.6341, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.4290, dtype=torch.float64)
14 gae_duplicate tensor(1.0580, dtype=torch.float64) tensor(-2.2010, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(0.4335, dtype=torch.float64)
13 gae_duplicate tensor(1.2798, dtype=torch.float64) tensor(-2.6624, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8179, dtype=torch.float64) delta_t tensor(0.4574, dtype=torch.float64)
12 gae_duplicate tensor(1.4812, dtype=torch.float64) tensor(-3.0790, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8190, dtype=torch.float64) delta_t tensor(0.5570, dtype=torch.float64)
11 gae_duplicate tensor(1.7420, dtype=torch.float64) tensor(-3.6180, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8200, dtype=torch.float64) delta_t tensor(0.3145, dtype=torch.float64)
10 gae_duplicate tensor(1.7081, dtype=torch.float64) tensor(-3.5507, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3155, dtype=torch.float64) delta_t tensor(-0.0694, dtype=torch.float64)
9 gae_duplicate tensor(1.2971, dtype=torch.float64) tensor(-2.6940, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0632, dtype=torch.float64) delta_t tensor(-0.1596, dtype=torch.float64)
8 gae_duplicate tensor(0.8781, dtype=torch.float64) tensor(-1.8253, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1892, dtype=torch.float64) delta_t tensor(-0.7028, dtype=torch.float64)
7 gae_duplicate tensor(-0.0003, dtype=torch.float64) tensor(0.0007, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0091, dtype=torch.float64) delta_t tensor(-0.4477, dtype=torch.float64)
6 gae_duplicate tensor(-0.4479, dtype=torch.float64) tensor(0.9318, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2630, dtype=torch.float64) delta_t tensor(-0.8400, dtype=torch.float64)
5 gae_duplicate tensor(-1.1984, dtype=torch.float64) tensor(2.4888, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8334, dtype=torch.float64) delta_t tensor(-1.9728, dtype=torch.float64)
4 gae_duplicate tensor(-2.9315, dtype=torch.float64) tensor(6.0984, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5870, dtype=torch.float64) delta_t tensor(-1.7846, dtype=torch.float64)
3 gae_duplicate tensor(-4.1298, dtype=torch.float64) tensor(8.5982, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3384, dtype=torch.float64) delta_t tensor(-1.6652, dtype=torch.float64)
2 gae_duplicate tensor(-4.9690, dtype=torch.float64) tensor(10.3281, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-32.97438430786133
value loss:100.90705871582031
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.482896089553833 seconds
19 rew tensor(0.8090, dtype=torch.float64) delta_t tensor(-0.4339, dtype=torch.float64)
19 gae_duplicate tensor(-0.4339, dtype=torch.float64) tensor(0.9025, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8100, dtype=torch.float64) delta_t tensor(0.5698, dtype=torch.float64)
18 gae_duplicate tensor(0.2227, dtype=torch.float64) tensor(-0.4629, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8110, dtype=torch.float64) delta_t tensor(0.2525, dtype=torch.float64)
17 gae_duplicate tensor(0.4306, dtype=torch.float64) tensor(-0.8951, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(0.4495, dtype=torch.float64)
16 gae_duplicate tensor(0.7940, dtype=torch.float64) tensor(-1.6517, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(-0.0329, dtype=torch.float64)
15 gae_duplicate tensor(0.6023, dtype=torch.float64) tensor(-1.2529, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.3972, dtype=torch.float64)
14 gae_duplicate tensor(0.8790, dtype=torch.float64) tensor(-1.8271, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.4018, dtype=torch.float64)
13 gae_duplicate tensor(1.1050, dtype=torch.float64) tensor(-2.2969, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.4065, dtype=torch.float64)
12 gae_duplicate tensor(1.2905, dtype=torch.float64) tensor(-2.6865, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8172, dtype=torch.float64) delta_t tensor(0.4461, dtype=torch.float64)
11 gae_duplicate tensor(1.4785, dtype=torch.float64) tensor(-3.0734, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8183, dtype=torch.float64) delta_t tensor(0.5425, dtype=torch.float64)
10 gae_duplicate tensor(1.7253, dtype=torch.float64) tensor(-3.5917, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8193, dtype=torch.float64) delta_t tensor(0.2563, dtype=torch.float64)
9 gae_duplicate tensor(1.6366, dtype=torch.float64) tensor(-3.3995, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0016, dtype=torch.float64) delta_t tensor(0.1041, dtype=torch.float64)
8 gae_duplicate tensor(1.4134, dtype=torch.float64) tensor(-2.9424, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1873, dtype=torch.float64) delta_t tensor(-0.6897, dtype=torch.float64)
7 gae_duplicate tensor(0.4410, dtype=torch.float64) tensor(-0.9167, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.6339, dtype=torch.float64) delta_t tensor(-1.1006, dtype=torch.float64)
6 gae_duplicate tensor(-0.7478, dtype=torch.float64) tensor(1.5566, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8905, dtype=torch.float64) delta_t tensor(-1.5878, dtype=torch.float64)
5 gae_duplicate tensor(-2.1861, dtype=torch.float64) tensor(4.5475, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2127, dtype=torch.float64) delta_t tensor(-2.5341, dtype=torch.float64)
4 gae_duplicate tensor(-4.2830, dtype=torch.float64) tensor(8.8962, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5900, dtype=torch.float64) delta_t tensor(-1.4305, dtype=torch.float64)
3 gae_duplicate tensor(-4.8569, dtype=torch.float64) tensor(10.1032, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7211, dtype=torch.float64) delta_t tensor(-2.0687, dtype=torch.float64)
2 gae_duplicate tensor(-5.9542, dtype=torch.float64) tensor(12.3676, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-81.38371276855469
value loss:146.7501220703125
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.453032970428467 seconds
19 rew tensor(0.8102, dtype=torch.float64) delta_t tensor(-0.4772, dtype=torch.float64)
19 gae_duplicate tensor(-0.4772, dtype=torch.float64) tensor(0.9919, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8112, dtype=torch.float64) delta_t tensor(0.5620, dtype=torch.float64)
18 gae_duplicate tensor(0.1803, dtype=torch.float64) tensor(-0.3747, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8122, dtype=torch.float64) delta_t tensor(0.2647, dtype=torch.float64)
17 gae_duplicate tensor(0.4089, dtype=torch.float64) tensor(-0.8493, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(0.2237, dtype=torch.float64)
16 gae_duplicate tensor(0.5508, dtype=torch.float64) tensor(-1.1457, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.0211, dtype=torch.float64)
15 gae_duplicate tensor(0.4617, dtype=torch.float64) tensor(-0.9598, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.3612, dtype=torch.float64)
14 gae_duplicate tensor(0.7306, dtype=torch.float64) tensor(-1.5186, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.3771, dtype=torch.float64)
13 gae_duplicate tensor(0.9616, dtype=torch.float64) tensor(-1.9990, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8172, dtype=torch.float64) delta_t tensor(0.4030, dtype=torch.float64)
12 gae_duplicate tensor(1.1723, dtype=torch.float64) tensor(-2.4369, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8182, dtype=torch.float64) delta_t tensor(0.4487, dtype=torch.float64)
11 gae_duplicate tensor(1.3865, dtype=torch.float64) tensor(-2.8821, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8192, dtype=torch.float64) delta_t tensor(0.2798, dtype=torch.float64)
10 gae_duplicate tensor(1.3890, dtype=torch.float64) tensor(-2.8892, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1912, dtype=torch.float64) delta_t tensor(-0.2772, dtype=torch.float64)
9 gae_duplicate tensor(0.8340, dtype=torch.float64) tensor(-1.7347, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0028, dtype=torch.float64) delta_t tensor(-0.1450, dtype=torch.float64)
8 gae_duplicate tensor(0.5221, dtype=torch.float64) tensor(-1.0847, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3112, dtype=torch.float64) delta_t tensor(-0.8281, dtype=torch.float64)
7 gae_duplicate tensor(-0.4104, dtype=torch.float64) tensor(0.8531, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3785, dtype=torch.float64) delta_t tensor(-0.7795, dtype=torch.float64)
6 gae_duplicate tensor(-1.1078, dtype=torch.float64) tensor(2.3045, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6328, dtype=torch.float64) delta_t tensor(-1.0557, dtype=torch.float64)
5 gae_duplicate tensor(-1.9419, dtype=torch.float64) tensor(4.0395, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0775, dtype=torch.float64) delta_t tensor(-2.3622, dtype=torch.float64)
4 gae_duplicate tensor(-3.9157, dtype=torch.float64) tensor(8.1453, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8337, dtype=torch.float64) delta_t tensor(-1.6516, dtype=torch.float64)
3 gae_duplicate tensor(-4.7842, dtype=torch.float64) tensor(9.9452, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5871, dtype=torch.float64) delta_t tensor(-2.1778, dtype=torch.float64)
2 gae_duplicate tensor(-6.0051, dtype=torch.float64) tensor(12.4918, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-126.50176239013672
value loss:132.0680694580078
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.19480299949646 seconds
19 rew tensor(0.8088, dtype=torch.float64) delta_t tensor(-0.5381, dtype=torch.float64)
19 gae_duplicate tensor(-0.5381, dtype=torch.float64) tensor(1.1179, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8098, dtype=torch.float64) delta_t tensor(0.3956, dtype=torch.float64)
18 gae_duplicate tensor(-0.0348, dtype=torch.float64) tensor(0.0724, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8107, dtype=torch.float64) delta_t tensor(0.4664, dtype=torch.float64)
17 gae_duplicate tensor(0.4386, dtype=torch.float64) tensor(-0.9117, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8117, dtype=torch.float64) delta_t tensor(-0.1625, dtype=torch.float64)
16 gae_duplicate tensor(0.1884, dtype=torch.float64) tensor(-0.3916, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(0.2089, dtype=torch.float64)
15 gae_duplicate tensor(0.3596, dtype=torch.float64) tensor(-0.7481, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.3402, dtype=torch.float64)
14 gae_duplicate tensor(0.6279, dtype=torch.float64) tensor(-1.3053, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.3592, dtype=torch.float64)
13 gae_duplicate tensor(0.8615, dtype=torch.float64) tensor(-1.7899, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.3458, dtype=torch.float64)
12 gae_duplicate tensor(1.0350, dtype=torch.float64) tensor(-2.1515, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(0.3693, dtype=torch.float64)
11 gae_duplicate tensor(1.1973, dtype=torch.float64) tensor(-2.4904, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8175, dtype=torch.float64) delta_t tensor(0.3043, dtype=torch.float64)
10 gae_duplicate tensor(1.2621, dtype=torch.float64) tensor(-2.6221, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8185, dtype=torch.float64) delta_t tensor(0.3415, dtype=torch.float64)
9 gae_duplicate tensor(1.3512, dtype=torch.float64) tensor(-2.8073, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1290, dtype=torch.float64) delta_t tensor(-0.0053, dtype=torch.float64)
8 gae_duplicate tensor(1.0757, dtype=torch.float64) tensor(-2.2349, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0591, dtype=torch.float64) delta_t tensor(-0.5162, dtype=torch.float64)
7 gae_duplicate tensor(0.3443, dtype=torch.float64) tensor(-0.7158, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5008, dtype=torch.float64) delta_t tensor(-0.8843, dtype=torch.float64)
6 gae_duplicate tensor(-0.6089, dtype=torch.float64) tensor(1.2665, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7554, dtype=torch.float64) delta_t tensor(-1.0305, dtype=torch.float64)
5 gae_duplicate tensor(-1.5176, dtype=torch.float64) tensor(3.1548, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0748, dtype=torch.float64) delta_t tensor(-2.4021, dtype=torch.float64)
4 gae_duplicate tensor(-3.6161, dtype=torch.float64) tensor(7.5218, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7050, dtype=torch.float64) delta_t tensor(-1.5256, dtype=torch.float64)
3 gae_duplicate tensor(-4.4185, dtype=torch.float64) tensor(9.1799, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5837, dtype=torch.float64) delta_t tensor(-1.9915, dtype=torch.float64)
2 gae_duplicate tensor(-5.5263, dtype=torch.float64) tensor(11.4951, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-94.96137237548828
value loss:112.19456481933594
entropies:37.42993927001953
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.7938)
ToM Target loss= tensor(306.1948)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.442080020904541 seconds
19 rew tensor(0.8091, dtype=torch.float64) delta_t tensor(-0.7282, dtype=torch.float64)
19 gae_duplicate tensor(-0.7282, dtype=torch.float64) tensor(1.5130, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8100, dtype=torch.float64) delta_t tensor(0.1844, dtype=torch.float64)
18 gae_duplicate tensor(-0.3981, dtype=torch.float64) tensor(0.8277, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8110, dtype=torch.float64) delta_t tensor(0.6737, dtype=torch.float64)
17 gae_duplicate tensor(0.3551, dtype=torch.float64) tensor(-0.7387, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8119, dtype=torch.float64) delta_t tensor(0.0492, dtype=torch.float64)
16 gae_duplicate tensor(0.3333, dtype=torch.float64) tensor(-0.6932, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(-0.0593, dtype=torch.float64)
15 gae_duplicate tensor(0.2074, dtype=torch.float64) tensor(-0.4313, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.3208, dtype=torch.float64)
14 gae_duplicate tensor(0.4867, dtype=torch.float64) tensor(-1.0123, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.3261, dtype=torch.float64)
13 gae_duplicate tensor(0.7154, dtype=torch.float64) tensor(-1.4873, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.3496, dtype=torch.float64)
12 gae_duplicate tensor(0.9220, dtype=torch.float64) tensor(-1.9167, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(0.4054, dtype=torch.float64)
11 gae_duplicate tensor(1.1430, dtype=torch.float64) tensor(-2.3761, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8176, dtype=torch.float64) delta_t tensor(0.1908, dtype=torch.float64)
10 gae_duplicate tensor(1.1052, dtype=torch.float64) tensor(-2.2987, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4411, dtype=torch.float64) delta_t tensor(-0.0458, dtype=torch.float64)
9 gae_duplicate tensor(0.8383, dtype=torch.float64) tensor(-1.7428, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2529, dtype=torch.float64) delta_t tensor(-0.1267, dtype=torch.float64)
8 gae_duplicate tensor(0.5440, dtype=torch.float64) tensor(-1.1320, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0611, dtype=torch.float64) delta_t tensor(-0.7372, dtype=torch.float64)
7 gae_duplicate tensor(-0.3020, dtype=torch.float64) tensor(0.6282, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0029, dtype=torch.float64) delta_t tensor(-0.1897, dtype=torch.float64)
6 gae_duplicate tensor(-0.4313, dtype=torch.float64) tensor(0.8972, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2554, dtype=torch.float64) delta_t tensor(-0.2769, dtype=torch.float64)
5 gae_duplicate tensor(-0.6220, dtype=torch.float64) tensor(1.2930, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8230, dtype=torch.float64) delta_t tensor(-2.1066, dtype=torch.float64)
4 gae_duplicate tensor(-2.6041, dtype=torch.float64) tensor(5.4166, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5770, dtype=torch.float64) delta_t tensor(-1.4268, dtype=torch.float64)
3 gae_duplicate tensor(-3.5101, dtype=torch.float64) tensor(7.2969, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3290, dtype=torch.float64) delta_t tensor(-1.9972, dtype=torch.float64)
2 gae_duplicate tensor(-4.8052, dtype=torch.float64) tensor(9.9947, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-85.35182189941406
value loss:73.42622375488281
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.442054033279419 seconds
19 rew tensor(0.8079, dtype=torch.float64) delta_t tensor(-0.5309, dtype=torch.float64)
19 gae_duplicate tensor(-0.5309, dtype=torch.float64) tensor(1.1036, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8088, dtype=torch.float64) delta_t tensor(0.5644, dtype=torch.float64)
18 gae_duplicate tensor(0.1397, dtype=torch.float64) tensor(-0.2905, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8097, dtype=torch.float64) delta_t tensor(0.0961, dtype=torch.float64)
17 gae_duplicate tensor(0.2079, dtype=torch.float64) tensor(-0.4322, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8106, dtype=torch.float64) delta_t tensor(-0.4009, dtype=torch.float64)
16 gae_duplicate tensor(-0.2346, dtype=torch.float64) tensor(0.4874, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(0.4417, dtype=torch.float64)
15 gae_duplicate tensor(0.2541, dtype=torch.float64) tensor(-0.5287, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8125, dtype=torch.float64) delta_t tensor(0.3186, dtype=torch.float64)
14 gae_duplicate tensor(0.5219, dtype=torch.float64) tensor(-1.0850, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(0.3195, dtype=torch.float64)
13 gae_duplicate tensor(0.7370, dtype=torch.float64) tensor(-1.5330, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.3205, dtype=torch.float64)
12 gae_duplicate tensor(0.9101, dtype=torch.float64) tensor(-1.8920, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.3214, dtype=torch.float64)
11 gae_duplicate tensor(1.0495, dtype=torch.float64) tensor(-2.1828, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.1634, dtype=torch.float64)
10 gae_duplicate tensor(1.0029, dtype=torch.float64) tensor(-2.0850, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8171, dtype=torch.float64) delta_t tensor(0.2527, dtype=torch.float64)
9 gae_duplicate tensor(1.0550, dtype=torch.float64) tensor(-2.1954, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0665, dtype=torch.float64) delta_t tensor(-0.4027, dtype=torch.float64)
8 gae_duplicate tensor(0.4413, dtype=torch.float64) tensor(-0.9183, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5593, dtype=torch.float64) delta_t tensor(-0.7783, dtype=torch.float64)
7 gae_duplicate tensor(-0.4253, dtype=torch.float64) tensor(0.8842, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3730, dtype=torch.float64) delta_t tensor(-0.9456, dtype=torch.float64)
6 gae_duplicate tensor(-1.2858, dtype=torch.float64) tensor(2.6719, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1269, dtype=torch.float64) delta_t tensor(-0.7726, dtype=torch.float64)
5 gae_duplicate tensor(-1.8012, dtype=torch.float64) tensor(3.7446, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4488, dtype=torch.float64) delta_t tensor(-3.2982, dtype=torch.float64)
4 gae_duplicate tensor(-4.7392, dtype=torch.float64) tensor(9.8477, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5792, dtype=torch.float64) delta_t tensor(-0.8616, dtype=torch.float64)
3 gae_duplicate tensor(-4.6529, dtype=torch.float64) tensor(9.6826, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.8351, dtype=torch.float64) delta_t tensor(-2.6079, dtype=torch.float64)
2 gae_duplicate tensor(-6.3303, dtype=torch.float64) tensor(13.1669, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-171.79823303222656
value loss:142.1763458251953
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.50482702255249 seconds
19 rew tensor(0.8087, dtype=torch.float64) delta_t tensor(-1.1761, dtype=torch.float64)
19 gae_duplicate tensor(-1.1761, dtype=torch.float64) tensor(2.4452, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8096, dtype=torch.float64) delta_t tensor(0.3160, dtype=torch.float64)
18 gae_duplicate tensor(-0.6250, dtype=torch.float64) tensor(1.2993, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8105, dtype=torch.float64) delta_t tensor(0.8445, dtype=torch.float64)
17 gae_duplicate tensor(0.3445, dtype=torch.float64) tensor(-0.7159, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8114, dtype=torch.float64) delta_t tensor(-0.1778, dtype=torch.float64)
16 gae_duplicate tensor(0.0978, dtype=torch.float64) tensor(-0.2034, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8123, dtype=torch.float64) delta_t tensor(-0.0842, dtype=torch.float64)
15 gae_duplicate tensor(-0.0059, dtype=torch.float64) tensor(0.0123, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.2765, dtype=torch.float64)
14 gae_duplicate tensor(0.2717, dtype=torch.float64) tensor(-0.5654, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(0.2971, dtype=torch.float64)
13 gae_duplicate tensor(0.5145, dtype=torch.float64) tensor(-1.0692, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.4094, dtype=torch.float64)
12 gae_duplicate tensor(0.8210, dtype=torch.float64) tensor(-1.7076, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(0.3036, dtype=torch.float64)
11 gae_duplicate tensor(0.9604, dtype=torch.float64) tensor(-1.9967, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(0.1403, dtype=torch.float64)
10 gae_duplicate tensor(0.9086, dtype=torch.float64) tensor(-1.8898, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5033, dtype=torch.float64) delta_t tensor(-0.1315, dtype=torch.float64)
9 gae_duplicate tensor(0.5954, dtype=torch.float64) tensor(-1.2388, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1896, dtype=torch.float64) delta_t tensor(-0.2942, dtype=torch.float64)
8 gae_duplicate tensor(0.1821, dtype=torch.float64) tensor(-0.3786, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4382, dtype=torch.float64) delta_t tensor(-1.0487, dtype=torch.float64)
7 gae_duplicate tensor(-0.9030, dtype=torch.float64) tensor(1.8766, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5013, dtype=torch.float64) delta_t tensor(0.3847, dtype=torch.float64)
6 gae_duplicate tensor(-0.3377, dtype=torch.float64) tensor(0.7024, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8781, dtype=torch.float64) delta_t tensor(0.4745, dtype=torch.float64)
5 gae_duplicate tensor(0.2044, dtype=torch.float64) tensor(-0.4250, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6945, dtype=torch.float64) delta_t tensor(-1.7053, dtype=torch.float64)
4 gae_duplicate tensor(-1.5418, dtype=torch.float64) tensor(3.2082, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4477, dtype=torch.float64) delta_t tensor(-2.1032, dtype=torch.float64)
3 gae_duplicate tensor(-3.3367, dtype=torch.float64) tensor(6.9367, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8223, dtype=torch.float64) delta_t tensor(-0.4645, dtype=torch.float64)
2 gae_duplicate tensor(-3.1338, dtype=torch.float64) tensor(6.5152, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-77.95559692382812
value loss:44.02953338623047
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.608802795410156 seconds
19 rew tensor(0.8076, dtype=torch.float64) delta_t tensor(-0.4577, dtype=torch.float64)
19 gae_duplicate tensor(-0.4577, dtype=torch.float64) tensor(0.9517, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8085, dtype=torch.float64) delta_t tensor(0.5297, dtype=torch.float64)
18 gae_duplicate tensor(0.1635, dtype=torch.float64) tensor(-0.3403, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8093, dtype=torch.float64) delta_t tensor(0.1951, dtype=torch.float64)
17 gae_duplicate tensor(0.3259, dtype=torch.float64) tensor(-0.6775, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8102, dtype=torch.float64) delta_t tensor(-0.6701, dtype=torch.float64)
16 gae_duplicate tensor(-0.4094, dtype=torch.float64) tensor(0.8514, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8111, dtype=torch.float64) delta_t tensor(0.4329, dtype=torch.float64)
15 gae_duplicate tensor(0.1054, dtype=torch.float64) tensor(-0.2191, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8119, dtype=torch.float64) delta_t tensor(0.2886, dtype=torch.float64)
14 gae_duplicate tensor(0.3730, dtype=torch.float64) tensor(-0.7757, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(0.2895, dtype=torch.float64)
13 gae_duplicate tensor(0.5879, dtype=torch.float64) tensor(-1.2217, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(0.2904, dtype=torch.float64)
12 gae_duplicate tensor(0.7607, dtype=torch.float64) tensor(-1.5814, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.2912, dtype=torch.float64)
11 gae_duplicate tensor(0.8998, dtype=torch.float64) tensor(-1.8714, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.0853, dtype=torch.float64)
10 gae_duplicate tensor(0.8052, dtype=torch.float64) tensor(-1.6734, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.2722, dtype=torch.float64)
9 gae_duplicate tensor(0.9164, dtype=torch.float64) tensor(-1.9059, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1270, dtype=torch.float64) delta_t tensor(-0.4741, dtype=torch.float64)
8 gae_duplicate tensor(0.2590, dtype=torch.float64) tensor(-0.5383, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0611, dtype=torch.float64) delta_t tensor(-0.5021, dtype=torch.float64)
7 gae_duplicate tensor(-0.2948, dtype=torch.float64) tensor(0.6130, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1265, dtype=torch.float64) delta_t tensor(-0.0344, dtype=torch.float64)
6 gae_duplicate tensor(-0.2703, dtype=torch.float64) tensor(0.5622, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7549, dtype=torch.float64) delta_t tensor(-0.4100, dtype=torch.float64)
5 gae_duplicate tensor(-0.6262, dtype=torch.float64) tensor(1.3025, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1990, dtype=torch.float64) delta_t tensor(-2.7021, dtype=torch.float64)
4 gae_duplicate tensor(-3.2030, dtype=torch.float64) tensor(6.6592, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7040, dtype=torch.float64) delta_t tensor(-1.1313, dtype=torch.float64)
3 gae_duplicate tensor(-3.6937, dtype=torch.float64) tensor(7.6765, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7084, dtype=torch.float64) delta_t tensor(-2.2437, dtype=torch.float64)
2 gae_duplicate tensor(-5.1987, dtype=torch.float64) tensor(10.8042, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-112.81819915771484
value loss:83.14659881591797
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.312952756881714 seconds
19 rew tensor(0.8065, dtype=torch.float64) delta_t tensor(-0.6200, dtype=torch.float64)
19 gae_duplicate tensor(-0.6200, dtype=torch.float64) tensor(1.2898, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8073, dtype=torch.float64) delta_t tensor(0.2416, dtype=torch.float64)
18 gae_duplicate tensor(-0.2544, dtype=torch.float64) tensor(0.5287, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8082, dtype=torch.float64) delta_t tensor(0.6186, dtype=torch.float64)
17 gae_duplicate tensor(0.4151, dtype=torch.float64) tensor(-0.8634, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8090, dtype=torch.float64) delta_t tensor(-0.6935, dtype=torch.float64)
16 gae_duplicate tensor(-0.3614, dtype=torch.float64) tensor(0.7514, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8098, dtype=torch.float64) delta_t tensor(0.2449, dtype=torch.float64)
15 gae_duplicate tensor(-0.0442, dtype=torch.float64) tensor(0.0920, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8107, dtype=torch.float64) delta_t tensor(0.2583, dtype=torch.float64)
14 gae_duplicate tensor(0.2229, dtype=torch.float64) tensor(-0.4636, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8115, dtype=torch.float64) delta_t tensor(0.2775, dtype=torch.float64)
13 gae_duplicate tensor(0.4558, dtype=torch.float64) tensor(-0.9474, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8124, dtype=torch.float64) delta_t tensor(0.2882, dtype=torch.float64)
12 gae_duplicate tensor(0.6528, dtype=torch.float64) tensor(-1.3577, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(0.3487, dtype=torch.float64)
11 gae_duplicate tensor(0.8710, dtype=torch.float64) tensor(-1.8114, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.1342, dtype=torch.float64)
10 gae_duplicate tensor(0.8310, dtype=torch.float64) tensor(-1.7282, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.2698, dtype=torch.float64)
9 gae_duplicate tensor(0.9346, dtype=torch.float64) tensor(-1.9426, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3764, dtype=torch.float64) delta_t tensor(-0.0893, dtype=torch.float64)
8 gae_duplicate tensor(0.6584, dtype=torch.float64) tensor(-1.3694, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0631, dtype=torch.float64) delta_t tensor(-0.7203, dtype=torch.float64)
7 gae_duplicate tensor(-0.1936, dtype=torch.float64) tensor(0.4024, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1281, dtype=torch.float64) delta_t tensor(-0.0231, dtype=torch.float64)
6 gae_duplicate tensor(-0.1780, dtype=torch.float64) tensor(0.3702, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3805, dtype=torch.float64) delta_t tensor(0.2073, dtype=torch.float64)
5 gae_duplicate tensor(0.0649, dtype=torch.float64) tensor(-0.1351, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9477, dtype=torch.float64) delta_t tensor(-2.4580, dtype=torch.float64)
4 gae_duplicate tensor(-2.4060, dtype=torch.float64) tensor(5.0040, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7023, dtype=torch.float64) delta_t tensor(-1.0865, dtype=torch.float64)
3 gae_duplicate tensor(-3.0113, dtype=torch.float64) tensor(6.2610, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4548, dtype=torch.float64) delta_t tensor(-1.8688, dtype=torch.float64)
2 gae_duplicate tensor(-4.2779, dtype=torch.float64) tensor(8.8973, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-78.99207305908203
value loss:56.137359619140625
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.8816)
ToM Target loss= tensor(306.5783)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.2914228439331055 seconds
19 rew tensor(0.8059, dtype=torch.float64) delta_t tensor(-0.3588, dtype=torch.float64)
19 gae_duplicate tensor(-0.3588, dtype=torch.float64) tensor(0.7461, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8068, dtype=torch.float64) delta_t tensor(0.5612, dtype=torch.float64)
18 gae_duplicate tensor(0.2742, dtype=torch.float64) tensor(-0.5703, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8076, dtype=torch.float64) delta_t tensor(0.0738, dtype=torch.float64)
17 gae_duplicate tensor(0.2932, dtype=torch.float64) tensor(-0.6098, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8084, dtype=torch.float64) delta_t tensor(-0.6776, dtype=torch.float64)
16 gae_duplicate tensor(-0.4430, dtype=torch.float64) tensor(0.9212, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8092, dtype=torch.float64) delta_t tensor(0.2640, dtype=torch.float64)
15 gae_duplicate tensor(-0.0904, dtype=torch.float64) tensor(0.1881, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8100, dtype=torch.float64) delta_t tensor(0.2488, dtype=torch.float64)
14 gae_duplicate tensor(0.1764, dtype=torch.float64) tensor(-0.3669, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8108, dtype=torch.float64) delta_t tensor(0.2496, dtype=torch.float64)
13 gae_duplicate tensor(0.3907, dtype=torch.float64) tensor(-0.8125, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8117, dtype=torch.float64) delta_t tensor(0.2504, dtype=torch.float64)
12 gae_duplicate tensor(0.5630, dtype=torch.float64) tensor(-1.1705, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8125, dtype=torch.float64) delta_t tensor(0.2859, dtype=torch.float64)
11 gae_duplicate tensor(0.7363, dtype=torch.float64) tensor(-1.5304, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(0.1279, dtype=torch.float64)
10 gae_duplicate tensor(0.7169, dtype=torch.float64) tensor(-1.4907, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.2334, dtype=torch.float64)
9 gae_duplicate tensor(0.8069, dtype=torch.float64) tensor(-1.6786, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0011, dtype=torch.float64) delta_t tensor(-0.2057, dtype=torch.float64)
8 gae_duplicate tensor(0.4399, dtype=torch.float64) tensor(-0.9146, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1866, dtype=torch.float64) delta_t tensor(-0.9285, dtype=torch.float64)
7 gae_duplicate tensor(-0.5766, dtype=torch.float64) tensor(1.1990, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4999, dtype=torch.float64) delta_t tensor(-0.3870, dtype=torch.float64)
6 gae_duplicate tensor(-0.8482, dtype=torch.float64) tensor(1.7635, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7533, dtype=torch.float64) delta_t tensor(-0.0560, dtype=torch.float64)
5 gae_duplicate tensor(-0.7346, dtype=torch.float64) tensor(1.5277, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1964, dtype=torch.float64) delta_t tensor(-2.7792, dtype=torch.float64)
4 gae_duplicate tensor(-3.3668, dtype=torch.float64) tensor(7.0020, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8275, dtype=torch.float64) delta_t tensor(-1.0086, dtype=torch.float64)
3 gae_duplicate tensor(-3.7021, dtype=torch.float64) tensor(7.6972, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7067, dtype=torch.float64) delta_t tensor(-2.5855, dtype=torch.float64)
2 gae_duplicate tensor(-5.5472, dtype=torch.float64) tensor(11.5332, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-141.7256317138672
value loss:90.4487533569336
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.279847860336304 seconds
19 rew tensor(0.8052, dtype=torch.float64) delta_t tensor(-0.4254, dtype=torch.float64)
19 gae_duplicate tensor(-0.4254, dtype=torch.float64) tensor(0.8847, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8060, dtype=torch.float64) delta_t tensor(0.5756, dtype=torch.float64)
18 gae_duplicate tensor(0.2353, dtype=torch.float64) tensor(-0.4895, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8068, dtype=torch.float64) delta_t tensor(-0.1746, dtype=torch.float64)
17 gae_duplicate tensor(0.0136, dtype=torch.float64) tensor(-0.0283, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8076, dtype=torch.float64) delta_t tensor(-0.5841, dtype=torch.float64)
16 gae_duplicate tensor(-0.5732, dtype=torch.float64) tensor(1.1922, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8084, dtype=torch.float64) delta_t tensor(0.4226, dtype=torch.float64)
15 gae_duplicate tensor(-0.0360, dtype=torch.float64) tensor(0.0748, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8092, dtype=torch.float64) delta_t tensor(0.2593, dtype=torch.float64)
14 gae_duplicate tensor(0.2306, dtype=torch.float64) tensor(-0.4795, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8100, dtype=torch.float64) delta_t tensor(0.2601, dtype=torch.float64)
13 gae_duplicate tensor(0.4446, dtype=torch.float64) tensor(-0.9246, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8108, dtype=torch.float64) delta_t tensor(0.2609, dtype=torch.float64)
12 gae_duplicate tensor(0.6166, dtype=torch.float64) tensor(-1.2820, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(0.3098, dtype=torch.float64)
11 gae_duplicate tensor(0.8031, dtype=torch.float64) tensor(-1.6702, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8124, dtype=torch.float64) delta_t tensor(0.0146, dtype=torch.float64)
10 gae_duplicate tensor(0.6571, dtype=torch.float64) tensor(-1.3668, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(0.2261, dtype=torch.float64)
9 gae_duplicate tensor(0.7518, dtype=torch.float64) tensor(-1.5631, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2515, dtype=torch.float64) delta_t tensor(-0.3159, dtype=torch.float64)
8 gae_duplicate tensor(0.2855, dtype=torch.float64) tensor(-0.5937, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0607, dtype=torch.float64) delta_t tensor(-0.7764, dtype=torch.float64)
7 gae_duplicate tensor(-0.5480, dtype=torch.float64) tensor(1.1392, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1220, dtype=torch.float64) delta_t tensor(0.1683, dtype=torch.float64)
6 gae_duplicate tensor(-0.2701, dtype=torch.float64) tensor(0.5616, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4981, dtype=torch.float64) delta_t tensor(0.4256, dtype=torch.float64)
5 gae_duplicate tensor(0.2095, dtype=torch.float64) tensor(-0.4357, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1884, dtype=torch.float64) delta_t tensor(-2.7949, dtype=torch.float64)
4 gae_duplicate tensor(-2.6273, dtype=torch.float64) tensor(5.4615, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9456, dtype=torch.float64) delta_t tensor(-0.9929, dtype=torch.float64)
3 gae_duplicate tensor(-3.0948, dtype=torch.float64) tensor(6.4361, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7004, dtype=torch.float64) delta_t tensor(-2.5248, dtype=torch.float64)
2 gae_duplicate tensor(-5.0006, dtype=torch.float64) tensor(10.3996, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-105.02095794677734
value loss:67.23661804199219
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4597008228302 seconds
19 rew tensor(0.8055, dtype=torch.float64) delta_t tensor(-0.4940, dtype=torch.float64)
19 gae_duplicate tensor(-0.4940, dtype=torch.float64) tensor(1.0272, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8063, dtype=torch.float64) delta_t tensor(0.0537, dtype=torch.float64)
18 gae_duplicate tensor(-0.3415, dtype=torch.float64) tensor(0.7102, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8071, dtype=torch.float64) delta_t tensor(0.3218, dtype=torch.float64)
17 gae_duplicate tensor(0.0486, dtype=torch.float64) tensor(-0.1012, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8078, dtype=torch.float64) delta_t tensor(0.0950, dtype=torch.float64)
16 gae_duplicate tensor(0.1339, dtype=torch.float64) tensor(-0.2786, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8086, dtype=torch.float64) delta_t tensor(-0.3205, dtype=torch.float64)
15 gae_duplicate tensor(-0.2133, dtype=torch.float64) tensor(0.4436, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8094, dtype=torch.float64) delta_t tensor(0.2278, dtype=torch.float64)
14 gae_duplicate tensor(0.0571, dtype=torch.float64) tensor(-0.1188, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8102, dtype=torch.float64) delta_t tensor(0.2438, dtype=torch.float64)
13 gae_duplicate tensor(0.2895, dtype=torch.float64) tensor(-0.6021, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8110, dtype=torch.float64) delta_t tensor(0.2630, dtype=torch.float64)
12 gae_duplicate tensor(0.4946, dtype=torch.float64) tensor(-1.0284, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(0.3662, dtype=torch.float64)
11 gae_duplicate tensor(0.7619, dtype=torch.float64) tensor(-1.5842, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8126, dtype=torch.float64) delta_t tensor(0.0489, dtype=torch.float64)
10 gae_duplicate tensor(0.6584, dtype=torch.float64) tensor(-1.3690, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4377, dtype=torch.float64) delta_t tensor(-0.1100, dtype=torch.float64)
9 gae_duplicate tensor(0.4168, dtype=torch.float64) tensor(-0.8666, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2502, dtype=torch.float64) delta_t tensor(-0.2909, dtype=torch.float64)
8 gae_duplicate tensor(0.0426, dtype=torch.float64) tensor(-0.0885, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0624, dtype=torch.float64) delta_t tensor(-0.8807, dtype=torch.float64)
7 gae_duplicate tensor(-0.8466, dtype=torch.float64) tensor(1.7603, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0002, dtype=torch.float64) delta_t tensor(0.2869, dtype=torch.float64)
6 gae_duplicate tensor(-0.3904, dtype=torch.float64) tensor(0.8117, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2514, dtype=torch.float64) delta_t tensor(0.8651, dtype=torch.float64)
5 gae_duplicate tensor(0.5528, dtype=torch.float64) tensor(-1.1494, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8162, dtype=torch.float64) delta_t tensor(-1.5479, dtype=torch.float64)
4 gae_duplicate tensor(-1.1057, dtype=torch.float64) tensor(2.2994, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5703, dtype=torch.float64) delta_t tensor(-1.3649, dtype=torch.float64)
3 gae_duplicate tensor(-2.2495, dtype=torch.float64) tensor(4.6773, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3228, dtype=torch.float64) delta_t tensor(-1.5488, dtype=torch.float64)
2 gae_duplicate tensor(-3.3484, dtype=torch.float64) tensor(6.9620, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-70.15180206298828
value loss:30.925048828125
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.677420139312744 seconds
19 rew tensor(0.8061, dtype=torch.float64) delta_t tensor(-0.3326, dtype=torch.float64)
19 gae_duplicate tensor(-0.3326, dtype=torch.float64) tensor(0.6917, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8069, dtype=torch.float64) delta_t tensor(-0.1993, dtype=torch.float64)
18 gae_duplicate tensor(-0.4654, dtype=torch.float64) tensor(0.9680, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8076, dtype=torch.float64) delta_t tensor(0.3811, dtype=torch.float64)
17 gae_duplicate tensor(0.0087, dtype=torch.float64) tensor(-0.0181, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8084, dtype=torch.float64) delta_t tensor(-0.2158, dtype=torch.float64)
16 gae_duplicate tensor(-0.2089, dtype=torch.float64) tensor(0.4342, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8092, dtype=torch.float64) delta_t tensor(-0.0592, dtype=torch.float64)
15 gae_duplicate tensor(-0.2263, dtype=torch.float64) tensor(0.4704, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8099, dtype=torch.float64) delta_t tensor(0.2481, dtype=torch.float64)
14 gae_duplicate tensor(0.0671, dtype=torch.float64) tensor(-0.1396, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8107, dtype=torch.float64) delta_t tensor(0.2953, dtype=torch.float64)
13 gae_duplicate tensor(0.3490, dtype=torch.float64) tensor(-0.7256, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8115, dtype=torch.float64) delta_t tensor(0.3794, dtype=torch.float64)
12 gae_duplicate tensor(0.6586, dtype=torch.float64) tensor(-1.3694, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8122, dtype=torch.float64) delta_t tensor(0.3263, dtype=torch.float64)
11 gae_duplicate tensor(0.8531, dtype=torch.float64) tensor(-1.7741, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(-0.1149, dtype=torch.float64)
10 gae_duplicate tensor(0.5676, dtype=torch.float64) tensor(-1.1802, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4374, dtype=torch.float64) delta_t tensor(-0.2663, dtype=torch.float64)
9 gae_duplicate tensor(0.1878, dtype=torch.float64) tensor(-0.3906, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1868, dtype=torch.float64) delta_t tensor(-0.4522, dtype=torch.float64)
8 gae_duplicate tensor(-0.3020, dtype=torch.float64) tensor(0.6280, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1891, dtype=torch.float64) delta_t tensor(-0.7631, dtype=torch.float64)
7 gae_duplicate tensor(-1.0046, dtype=torch.float64) tensor(2.0892, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3771, dtype=torch.float64) delta_t tensor(0.9260, dtype=torch.float64)
6 gae_duplicate tensor(0.1223, dtype=torch.float64) tensor(-0.2543, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0035, dtype=torch.float64) delta_t tensor(1.1692, dtype=torch.float64)
5 gae_duplicate tensor(1.2671, dtype=torch.float64) tensor(-2.6346, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8185, dtype=torch.float64) delta_t tensor(-1.4006, dtype=torch.float64)
4 gae_duplicate tensor(-0.3870, dtype=torch.float64) tensor(0.8048, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5723, dtype=torch.float64) delta_t tensor(-2.2948, dtype=torch.float64)
3 gae_duplicate tensor(-2.6044, dtype=torch.float64) tensor(5.4147, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1990, dtype=torch.float64) delta_t tensor(-0.4467, dtype=torch.float64)
2 gae_duplicate tensor(-2.5302, dtype=torch.float64) tensor(5.2624, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-50.78417205810547
value loss:27.184371948242188
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.278332948684692 seconds
19 rew tensor(0.8069, dtype=torch.float64) delta_t tensor(-0.2880, dtype=torch.float64)
19 gae_duplicate tensor(-0.2880, dtype=torch.float64) tensor(0.5988, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8076, dtype=torch.float64) delta_t tensor(0.6650, dtype=torch.float64)
18 gae_duplicate tensor(0.4346, dtype=torch.float64) tensor(-0.9036, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8084, dtype=torch.float64) delta_t tensor(0.0605, dtype=torch.float64)
17 gae_duplicate tensor(0.4082, dtype=torch.float64) tensor(-0.8489, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8091, dtype=torch.float64) delta_t tensor(-0.5011, dtype=torch.float64)
16 gae_duplicate tensor(-0.1746, dtype=torch.float64) tensor(0.3629, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8099, dtype=torch.float64) delta_t tensor(0.0701, dtype=torch.float64)
15 gae_duplicate tensor(-0.0695, dtype=torch.float64) tensor(0.1446, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8106, dtype=torch.float64) delta_t tensor(0.2530, dtype=torch.float64)
14 gae_duplicate tensor(0.1974, dtype=torch.float64) tensor(-0.4104, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8114, dtype=torch.float64) delta_t tensor(0.2538, dtype=torch.float64)
13 gae_duplicate tensor(0.4117, dtype=torch.float64) tensor(-0.8562, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(0.2545, dtype=torch.float64)
12 gae_duplicate tensor(0.5839, dtype=torch.float64) tensor(-1.2141, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(0.2799, dtype=torch.float64)
11 gae_duplicate tensor(0.7470, dtype=torch.float64) tensor(-1.5533, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.0493, dtype=torch.float64)
10 gae_duplicate tensor(0.6469, dtype=torch.float64) tensor(-1.3452, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.2672, dtype=torch.float64)
9 gae_duplicate tensor(0.7847, dtype=torch.float64) tensor(-1.6317, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1863, dtype=torch.float64) delta_t tensor(1.5407, dtype=torch.float64)
8 gae_duplicate tensor(2.1684, dtype=torch.float64) tensor(-4.5095, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9371, dtype=torch.float64) delta_t tensor(-3.5838, dtype=torch.float64)
7 gae_duplicate tensor(-1.8490, dtype=torch.float64) tensor(3.8449, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0006, dtype=torch.float64) delta_t tensor(0.7237, dtype=torch.float64)
6 gae_duplicate tensor(-0.7556, dtype=torch.float64) tensor(1.5710, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2520, dtype=torch.float64) delta_t tensor(-2.2939, dtype=torch.float64)
5 gae_duplicate tensor(-2.8984, dtype=torch.float64) tensor(6.0267, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9421, dtype=torch.float64) delta_t tensor(1.0909, dtype=torch.float64)
4 gae_duplicate tensor(-1.2278, dtype=torch.float64) tensor(2.5534, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.3234, dtype=torch.float64) delta_t tensor(-2.2183, dtype=torch.float64)
3 gae_duplicate tensor(-3.2005, dtype=torch.float64) tensor(6.6555, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1381, dtype=torch.float64) delta_t tensor(-0.9816, dtype=torch.float64)
2 gae_duplicate tensor(-3.5420, dtype=torch.float64) tensor(7.3651, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-96.2228775024414
value loss:66.0058822631836
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.8400)
ToM Target loss= tensor(307.0748)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.396925926208496 seconds
19 rew tensor(0.8077, dtype=torch.float64) delta_t tensor(-0.0841, dtype=torch.float64)
19 gae_duplicate tensor(-0.0841, dtype=torch.float64) tensor(0.1748, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8085, dtype=torch.float64) delta_t tensor(0.3060, dtype=torch.float64)
18 gae_duplicate tensor(0.2387, dtype=torch.float64) tensor(-0.4964, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8092, dtype=torch.float64) delta_t tensor(0.1754, dtype=torch.float64)
17 gae_duplicate tensor(0.3664, dtype=torch.float64) tensor(-0.7619, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8099, dtype=torch.float64) delta_t tensor(-0.0833, dtype=torch.float64)
16 gae_duplicate tensor(0.2098, dtype=torch.float64) tensor(-0.4363, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8107, dtype=torch.float64) delta_t tensor(-0.3667, dtype=torch.float64)
15 gae_duplicate tensor(-0.1988, dtype=torch.float64) tensor(0.4135, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8114, dtype=torch.float64) delta_t tensor(0.2472, dtype=torch.float64)
14 gae_duplicate tensor(0.0881, dtype=torch.float64) tensor(-0.1832, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(0.2321, dtype=torch.float64)
13 gae_duplicate tensor(0.3025, dtype=torch.float64) tensor(-0.6291, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(0.2907, dtype=torch.float64)
12 gae_duplicate tensor(0.5328, dtype=torch.float64) tensor(-1.1079, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.2835, dtype=torch.float64)
11 gae_duplicate tensor(0.7097, dtype=torch.float64) tensor(-1.4758, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.0731, dtype=torch.float64)
10 gae_duplicate tensor(0.6409, dtype=torch.float64) tensor(-1.3326, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.3455, dtype=torch.float64)
9 gae_duplicate tensor(0.8582, dtype=torch.float64) tensor(-1.7846, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3096, dtype=torch.float64) delta_t tensor(0.4340, dtype=torch.float64)
8 gae_duplicate tensor(1.1205, dtype=torch.float64) tensor(-2.3300, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1847, dtype=torch.float64) delta_t tensor(-2.8221, dtype=torch.float64)
7 gae_duplicate tensor(-1.9256, dtype=torch.float64) tensor(4.0042, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2488, dtype=torch.float64) delta_t tensor(1.0209, dtype=torch.float64)
6 gae_duplicate tensor(-0.5196, dtype=torch.float64) tensor(1.0804, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5006, dtype=torch.float64) delta_t tensor(-2.1954, dtype=torch.float64)
5 gae_duplicate tensor(-2.6110, dtype=torch.float64) tensor(5.4296, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6910, dtype=torch.float64) delta_t tensor(0.8446, dtype=torch.float64)
4 gae_duplicate tensor(-1.2442, dtype=torch.float64) tensor(2.5872, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.1957, dtype=torch.float64) delta_t tensor(-2.2908, dtype=torch.float64)
3 gae_duplicate tensor(-3.2862, dtype=torch.float64) tensor(6.8334, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7592, dtype=torch.float64) delta_t tensor(-0.5523, dtype=torch.float64)
2 gae_duplicate tensor(-3.1813, dtype=torch.float64) tensor(6.6149, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-100.72393035888672
value loss:55.25202941894531
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.132788896560669 seconds
19 rew tensor(0.8071, dtype=torch.float64) delta_t tensor(0.0127, dtype=torch.float64)
19 gae_duplicate tensor(0.0127, dtype=torch.float64) tensor(-0.0265, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8079, dtype=torch.float64) delta_t tensor(-0.0012, dtype=torch.float64)
18 gae_duplicate tensor(0.0090, dtype=torch.float64) tensor(-0.0188, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8086, dtype=torch.float64) delta_t tensor(0.3981, dtype=torch.float64)
17 gae_duplicate tensor(0.4053, dtype=torch.float64) tensor(-0.8428, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8093, dtype=torch.float64) delta_t tensor(-0.9244, dtype=torch.float64)
16 gae_duplicate tensor(-0.6001, dtype=torch.float64) tensor(1.2480, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8100, dtype=torch.float64) delta_t tensor(0.6929, dtype=torch.float64)
15 gae_duplicate tensor(0.2128, dtype=torch.float64) tensor(-0.4425, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8107, dtype=torch.float64) delta_t tensor(0.3094, dtype=torch.float64)
14 gae_duplicate tensor(0.4797, dtype=torch.float64) tensor(-0.9975, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8114, dtype=torch.float64) delta_t tensor(0.3102, dtype=torch.float64)
13 gae_duplicate tensor(0.6939, dtype=torch.float64) tensor(-1.4430, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(0.3109, dtype=torch.float64)
12 gae_duplicate tensor(0.8660, dtype=torch.float64) tensor(-1.8008, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(0.3116, dtype=torch.float64)
11 gae_duplicate tensor(1.0044, dtype=torch.float64) tensor(-2.0886, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(-0.1571, dtype=torch.float64)
10 gae_duplicate tensor(0.6464, dtype=torch.float64) tensor(-1.3443, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.2260, dtype=torch.float64)
9 gae_duplicate tensor(0.7432, dtype=torch.float64) tensor(-1.5453, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3776, dtype=torch.float64) delta_t tensor(-0.3159, dtype=torch.float64)
8 gae_duplicate tensor(0.2786, dtype=torch.float64) tensor(-0.5794, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1844, dtype=torch.float64) delta_t tensor(-0.3133, dtype=torch.float64)
7 gae_duplicate tensor(-0.0904, dtype=torch.float64) tensor(0.1880, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1210, dtype=torch.float64) delta_t tensor(-1.2095, dtype=torch.float64)
6 gae_duplicate tensor(-1.2819, dtype=torch.float64) tensor(2.6656, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5594, dtype=torch.float64) delta_t tensor(-1.2054, dtype=torch.float64)
5 gae_duplicate tensor(-2.2309, dtype=torch.float64) tensor(4.6389, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4373, dtype=torch.float64) delta_t tensor(1.8794, dtype=torch.float64)
4 gae_duplicate tensor(0.0947, dtype=torch.float64) tensor(-0.1970, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.4402, dtype=torch.float64) delta_t tensor(-2.4736, dtype=torch.float64)
3 gae_duplicate tensor(-2.3978, dtype=torch.float64) tensor(4.9860, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7566, dtype=torch.float64) delta_t tensor(-0.3447, dtype=torch.float64)
2 gae_duplicate tensor(-2.2630, dtype=torch.float64) tensor(4.7058, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-43.758087158203125
value loss:32.39358901977539
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.354579925537109 seconds
19 rew tensor(0.8076, dtype=torch.float64) delta_t tensor(0.1810, dtype=torch.float64)
19 gae_duplicate tensor(0.1810, dtype=torch.float64) tensor(-0.3765, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8082, dtype=torch.float64) delta_t tensor(0.1751, dtype=torch.float64)
18 gae_duplicate tensor(0.3199, dtype=torch.float64) tensor(-0.6652, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8089, dtype=torch.float64) delta_t tensor(0.2629, dtype=torch.float64)
17 gae_duplicate tensor(0.5188, dtype=torch.float64) tensor(-1.0788, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8096, dtype=torch.float64) delta_t tensor(0.2719, dtype=torch.float64)
16 gae_duplicate tensor(0.6870, dtype=torch.float64) tensor(-1.4285, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8103, dtype=torch.float64) delta_t tensor(-0.6048, dtype=torch.float64)
15 gae_duplicate tensor(-0.0552, dtype=torch.float64) tensor(0.1147, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8110, dtype=torch.float64) delta_t tensor(0.2467, dtype=torch.float64)
14 gae_duplicate tensor(0.2026, dtype=torch.float64) tensor(-0.4212, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(0.2489, dtype=torch.float64)
13 gae_duplicate tensor(0.4109, dtype=torch.float64) tensor(-0.8546, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8125, dtype=torch.float64) delta_t tensor(0.2725, dtype=torch.float64)
12 gae_duplicate tensor(0.6013, dtype=torch.float64) tensor(-1.2503, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(0.4556, dtype=torch.float64)
11 gae_duplicate tensor(0.9366, dtype=torch.float64) tensor(-1.9476, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(-0.0812, dtype=torch.float64)
10 gae_duplicate tensor(0.6681, dtype=torch.float64) tensor(-1.3892, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5640, dtype=torch.float64) delta_t tensor(-0.0540, dtype=torch.float64)
9 gae_duplicate tensor(0.4805, dtype=torch.float64) tensor(-0.9991, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0633, dtype=torch.float64) delta_t tensor(-0.5214, dtype=torch.float64)
8 gae_duplicate tensor(-0.1370, dtype=torch.float64) tensor(0.2849, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1871, dtype=torch.float64) delta_t tensor(-0.9599, dtype=torch.float64)
7 gae_duplicate tensor(-1.0695, dtype=torch.float64) tensor(2.2241, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8754, dtype=torch.float64) delta_t tensor(0.8136, dtype=torch.float64)
6 gae_duplicate tensor(-0.0420, dtype=torch.float64) tensor(0.0874, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1265, dtype=torch.float64) delta_t tensor(1.7545, dtype=torch.float64)
5 gae_duplicate tensor(1.7209, dtype=torch.float64) tensor(-3.5783, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8161, dtype=torch.float64) delta_t tensor(-1.3365, dtype=torch.float64)
4 gae_duplicate tensor(0.0402, dtype=torch.float64) tensor(-0.0835, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3191, dtype=torch.float64) delta_t tensor(-1.0328, dtype=torch.float64)
3 gae_duplicate tensor(-1.0006, dtype=torch.float64) tensor(2.0808, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0703, dtype=torch.float64) delta_t tensor(-1.0374, dtype=torch.float64)
2 gae_duplicate tensor(-1.8379, dtype=torch.float64) tensor(3.8218, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:31.631872177124023
value loss:17.267410278320312
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.346310138702393 seconds
19 rew tensor(0.8079, dtype=torch.float64) delta_t tensor(0.1404, dtype=torch.float64)
19 gae_duplicate tensor(0.1404, dtype=torch.float64) tensor(-0.2920, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8086, dtype=torch.float64) delta_t tensor(-0.3493, dtype=torch.float64)
18 gae_duplicate tensor(-0.2370, dtype=torch.float64) tensor(0.4929, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8092, dtype=torch.float64) delta_t tensor(0.9229, dtype=torch.float64)
17 gae_duplicate tensor(0.7333, dtype=torch.float64) tensor(-1.5248, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8099, dtype=torch.float64) delta_t tensor(-0.8349, dtype=torch.float64)
16 gae_duplicate tensor(-0.2483, dtype=torch.float64) tensor(0.5162, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8106, dtype=torch.float64) delta_t tensor(0.1186, dtype=torch.float64)
15 gae_duplicate tensor(-0.0800, dtype=torch.float64) tensor(0.1664, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8113, dtype=torch.float64) delta_t tensor(0.2510, dtype=torch.float64)
14 gae_duplicate tensor(0.1870, dtype=torch.float64) tensor(-0.3889, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8120, dtype=torch.float64) delta_t tensor(0.2734, dtype=torch.float64)
13 gae_duplicate tensor(0.4229, dtype=torch.float64) tensor(-0.8796, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(0.2833, dtype=torch.float64)
12 gae_duplicate tensor(0.6217, dtype=torch.float64) tensor(-1.2927, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(0.3361, dtype=torch.float64)
11 gae_duplicate tensor(0.8334, dtype=torch.float64) tensor(-1.7331, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.0176, dtype=torch.float64)
10 gae_duplicate tensor(0.6843, dtype=torch.float64) tensor(-1.4229, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4386, dtype=torch.float64) delta_t tensor(-0.0852, dtype=torch.float64)
9 gae_duplicate tensor(0.4622, dtype=torch.float64) tensor(-0.9612, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1255, dtype=torch.float64) delta_t tensor(-0.4223, dtype=torch.float64)
8 gae_duplicate tensor(-0.0525, dtype=torch.float64) tensor(0.1092, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0624, dtype=torch.float64) delta_t tensor(-0.9194, dtype=torch.float64)
7 gae_duplicate tensor(-0.9614, dtype=torch.float64) tensor(1.9992, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1268, dtype=torch.float64) delta_t tensor(0.5903, dtype=torch.float64)
6 gae_duplicate tensor(-0.1788, dtype=torch.float64) tensor(0.3718, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3786, dtype=torch.float64) delta_t tensor(1.5822, dtype=torch.float64)
5 gae_duplicate tensor(1.4391, dtype=torch.float64) tensor(-2.9927, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9445, dtype=torch.float64) delta_t tensor(-1.6668, dtype=torch.float64)
4 gae_duplicate tensor(-0.5155, dtype=torch.float64) tensor(1.0719, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5729, dtype=torch.float64) delta_t tensor(-0.8338, dtype=torch.float64)
3 gae_duplicate tensor(-1.2462, dtype=torch.float64) tensor(2.5917, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4501, dtype=torch.float64) delta_t tensor(-1.5175, dtype=torch.float64)
2 gae_duplicate tensor(-2.5145, dtype=torch.float64) tensor(5.2285, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-7.483075141906738
value loss:20.745033264160156
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.622845888137817 seconds
19 rew tensor(0.8080, dtype=torch.float64) delta_t tensor(-0.2062, dtype=torch.float64)
19 gae_duplicate tensor(-0.2062, dtype=torch.float64) tensor(0.4289, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8087, dtype=torch.float64) delta_t tensor(-0.1589, dtype=torch.float64)
18 gae_duplicate tensor(-0.3238, dtype=torch.float64) tensor(0.6734, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8093, dtype=torch.float64) delta_t tensor(0.3101, dtype=torch.float64)
17 gae_duplicate tensor(0.0510, dtype=torch.float64) tensor(-0.1060, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8100, dtype=torch.float64) delta_t tensor(-0.5037, dtype=torch.float64)
16 gae_duplicate tensor(-0.4629, dtype=torch.float64) tensor(0.9625, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8107, dtype=torch.float64) delta_t tensor(0.9617, dtype=torch.float64)
15 gae_duplicate tensor(0.5914, dtype=torch.float64) tensor(-1.2299, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8114, dtype=torch.float64) delta_t tensor(0.3853, dtype=torch.float64)
14 gae_duplicate tensor(0.8584, dtype=torch.float64) tensor(-1.7850, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8120, dtype=torch.float64) delta_t tensor(0.3860, dtype=torch.float64)
13 gae_duplicate tensor(1.0727, dtype=torch.float64) tensor(-2.2308, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(0.3867, dtype=torch.float64)
12 gae_duplicate tensor(1.2449, dtype=torch.float64) tensor(-2.5885, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(0.6260, dtype=torch.float64)
11 gae_duplicate tensor(1.6219, dtype=torch.float64) tensor(-3.3722, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(-0.6033, dtype=torch.float64)
10 gae_duplicate tensor(0.6942, dtype=torch.float64) tensor(-1.4436, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4376, dtype=torch.float64) delta_t tensor(-0.1299, dtype=torch.float64)
9 gae_duplicate tensor(0.4255, dtype=torch.float64) tensor(-0.8849, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3121, dtype=torch.float64) delta_t tensor(-0.4726, dtype=torch.float64)
8 gae_duplicate tensor(-0.1322, dtype=torch.float64) tensor(0.2750, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0610, dtype=torch.float64) delta_t tensor(-0.4544, dtype=torch.float64)
7 gae_duplicate tensor(-0.5602, dtype=torch.float64) tensor(1.1649, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5040, dtype=torch.float64) delta_t tensor(1.4657, dtype=torch.float64)
6 gae_duplicate tensor(1.0176, dtype=torch.float64) tensor(-2.1158, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8809, dtype=torch.float64) delta_t tensor(1.8596, dtype=torch.float64)
5 gae_duplicate tensor(2.6737, dtype=torch.float64) tensor(-5.5595, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5719, dtype=torch.float64) delta_t tensor(-0.9023, dtype=torch.float64)
4 gae_duplicate tensor(1.2366, dtype=torch.float64) tensor(-2.5714, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4491, dtype=torch.float64) delta_t tensor(-0.9426, dtype=torch.float64)
3 gae_duplicate tensor(0.0467, dtype=torch.float64) tensor(-0.0970, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2001, dtype=torch.float64) delta_t tensor(-0.9627, dtype=torch.float64)
2 gae_duplicate tensor(-0.9253, dtype=torch.float64) tensor(1.9244, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:110.21163940429688
value loss:27.522153854370117
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.5467)
ToM Target loss= tensor(307.1595)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.21402907371521 seconds
19 rew tensor(0.8075, dtype=torch.float64) delta_t tensor(0.2746, dtype=torch.float64)
19 gae_duplicate tensor(0.2746, dtype=torch.float64) tensor(-0.5711, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8082, dtype=torch.float64) delta_t tensor(0.7105, dtype=torch.float64)
18 gae_duplicate tensor(0.9302, dtype=torch.float64) tensor(-1.9341, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8089, dtype=torch.float64) delta_t tensor(0.0373, dtype=torch.float64)
17 gae_duplicate tensor(0.7814, dtype=torch.float64) tensor(-1.6248, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8095, dtype=torch.float64) delta_t tensor(-1.1393, dtype=torch.float64)
16 gae_duplicate tensor(-0.5141, dtype=torch.float64) tensor(1.0690, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8102, dtype=torch.float64) delta_t tensor(0.6217, dtype=torch.float64)
15 gae_duplicate tensor(0.2104, dtype=torch.float64) tensor(-0.4375, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8108, dtype=torch.float64) delta_t tensor(0.3089, dtype=torch.float64)
14 gae_duplicate tensor(0.4772, dtype=torch.float64) tensor(-0.9922, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8115, dtype=torch.float64) delta_t tensor(0.3096, dtype=torch.float64)
13 gae_duplicate tensor(0.6913, dtype=torch.float64) tensor(-1.4379, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8122, dtype=torch.float64) delta_t tensor(0.3102, dtype=torch.float64)
12 gae_duplicate tensor(0.8633, dtype=torch.float64) tensor(-1.7953, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(0.3109, dtype=torch.float64)
11 gae_duplicate tensor(1.0015, dtype=torch.float64) tensor(-2.0828, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(-0.0706, dtype=torch.float64)
10 gae_duplicate tensor(0.7306, dtype=torch.float64) tensor(-1.5191, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6257, dtype=torch.float64) delta_t tensor(-0.0227, dtype=torch.float64)
9 gae_duplicate tensor(0.5617, dtype=torch.float64) tensor(-1.1680, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3122, dtype=torch.float64) delta_t tensor(-0.4198, dtype=torch.float64)
8 gae_duplicate tensor(0.0296, dtype=torch.float64) tensor(-0.0615, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1897, dtype=torch.float64) delta_t tensor(-0.7213, dtype=torch.float64)
7 gae_duplicate tensor(-0.6976, dtype=torch.float64) tensor(1.4507, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8799, dtype=torch.float64) delta_t tensor(0.8365, dtype=torch.float64)
6 gae_duplicate tensor(0.2784, dtype=torch.float64) tensor(-0.5790, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7588, dtype=torch.float64) delta_t tensor(1.3093, dtype=torch.float64)
5 gae_duplicate tensor(1.5320, dtype=torch.float64) tensor(-3.1851, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0764, dtype=torch.float64) delta_t tensor(-2.8706, dtype=torch.float64)
4 gae_duplicate tensor(-1.6450, dtype=torch.float64) tensor(3.4199, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7045, dtype=torch.float64) delta_t tensor(0.2026, dtype=torch.float64)
3 gae_duplicate tensor(-1.1134, dtype=torch.float64) tensor(2.3157, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.8337, dtype=torch.float64) delta_t tensor(-1.9287, dtype=torch.float64)
2 gae_duplicate tensor(-2.8194, dtype=torch.float64) tensor(5.8615, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:18.506263732910156
value loss:29.954586029052734
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.258858919143677 seconds
19 rew tensor(0.8060, dtype=torch.float64) delta_t tensor(0.3422, dtype=torch.float64)
19 gae_duplicate tensor(0.3422, dtype=torch.float64) tensor(-0.7117, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8067, dtype=torch.float64) delta_t tensor(0.7481, dtype=torch.float64)
18 gae_duplicate tensor(1.0219, dtype=torch.float64) tensor(-2.1254, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8073, dtype=torch.float64) delta_t tensor(-0.0163, dtype=torch.float64)
17 gae_duplicate tensor(0.8012, dtype=torch.float64) tensor(-1.6660, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8080, dtype=torch.float64) delta_t tensor(-1.1445, dtype=torch.float64)
16 gae_duplicate tensor(-0.5035, dtype=torch.float64) tensor(1.0470, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8086, dtype=torch.float64) delta_t tensor(0.4870, dtype=torch.float64)
15 gae_duplicate tensor(0.0841, dtype=torch.float64) tensor(-0.1750, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8092, dtype=torch.float64) delta_t tensor(0.2831, dtype=torch.float64)
14 gae_duplicate tensor(0.3504, dtype=torch.float64) tensor(-0.7287, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8099, dtype=torch.float64) delta_t tensor(0.2838, dtype=torch.float64)
13 gae_duplicate tensor(0.5641, dtype=torch.float64) tensor(-1.1729, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8105, dtype=torch.float64) delta_t tensor(0.2844, dtype=torch.float64)
12 gae_duplicate tensor(0.7357, dtype=torch.float64) tensor(-1.5302, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8112, dtype=torch.float64) delta_t tensor(0.3395, dtype=torch.float64)
11 gae_duplicate tensor(0.9280, dtype=torch.float64) tensor(-1.9296, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(-0.0234, dtype=torch.float64)
10 gae_duplicate tensor(0.7190, dtype=torch.float64) tensor(-1.4952, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8125, dtype=torch.float64) delta_t tensor(0.2498, dtype=torch.float64)
9 gae_duplicate tensor(0.8249, dtype=torch.float64) tensor(-1.7155, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(0.1558, dtype=torch.float64)
8 gae_duplicate tensor(0.8158, dtype=torch.float64) tensor(-1.6966, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0615, dtype=torch.float64) delta_t tensor(-0.8020, dtype=torch.float64)
7 gae_duplicate tensor(-0.1493, dtype=torch.float64) tensor(0.3105, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1290, dtype=torch.float64) delta_t tensor(0.7170, dtype=torch.float64)
6 gae_duplicate tensor(0.5976, dtype=torch.float64) tensor(-1.2423, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3809, dtype=torch.float64) delta_t tensor(1.8710, dtype=torch.float64)
5 gae_duplicate tensor(2.3491, dtype=torch.float64) tensor(-4.8859, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1979, dtype=torch.float64) delta_t tensor(-3.0170, dtype=torch.float64)
4 gae_duplicate tensor(-1.1377, dtype=torch.float64) tensor(2.3652, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9529, dtype=torch.float64) delta_t tensor(-0.0078, dtype=torch.float64)
3 gae_duplicate tensor(-0.9179, dtype=torch.float64) tensor(1.9093, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7059, dtype=torch.float64) delta_t tensor(-1.6485, dtype=torch.float64)
2 gae_duplicate tensor(-2.3828, dtype=torch.float64) tensor(4.9554, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:61.802833557128906
value loss:29.22412872314453
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.469242095947266 seconds
19 rew tensor(0.8070, dtype=torch.float64) delta_t tensor(0.3192, dtype=torch.float64)
19 gae_duplicate tensor(0.3192, dtype=torch.float64) tensor(-0.6636, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8077, dtype=torch.float64) delta_t tensor(-0.1237, dtype=torch.float64)
18 gae_duplicate tensor(0.1317, dtype=torch.float64) tensor(-0.2738, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8083, dtype=torch.float64) delta_t tensor(0.7341, dtype=torch.float64)
17 gae_duplicate tensor(0.8394, dtype=torch.float64) tensor(-1.7454, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8089, dtype=torch.float64) delta_t tensor(-1.1528, dtype=torch.float64)
16 gae_duplicate tensor(-0.4813, dtype=torch.float64) tensor(1.0011, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8096, dtype=torch.float64) delta_t tensor(0.2938, dtype=torch.float64)
15 gae_duplicate tensor(-0.0912, dtype=torch.float64) tensor(0.1897, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8102, dtype=torch.float64) delta_t tensor(0.2483, dtype=torch.float64)
14 gae_duplicate tensor(0.1754, dtype=torch.float64) tensor(-0.3646, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8108, dtype=torch.float64) delta_t tensor(0.2778, dtype=torch.float64)
13 gae_duplicate tensor(0.4181, dtype=torch.float64) tensor(-0.8695, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8115, dtype=torch.float64) delta_t tensor(0.2906, dtype=torch.float64)
12 gae_duplicate tensor(0.6251, dtype=torch.float64) tensor(-1.2997, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(0.2439, dtype=torch.float64)
11 gae_duplicate tensor(0.7440, dtype=torch.float64) tensor(-1.5469, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(-0.0040, dtype=torch.float64)
10 gae_duplicate tensor(0.5911, dtype=torch.float64) tensor(-1.2291, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3106, dtype=torch.float64) delta_t tensor(-0.3931, dtype=torch.float64)
9 gae_duplicate tensor(0.0798, dtype=torch.float64) tensor(-0.1659, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0595, dtype=torch.float64) delta_t tensor(-0.6144, dtype=torch.float64)
8 gae_duplicate tensor(-0.5505, dtype=torch.float64) tensor(1.1449, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3172, dtype=torch.float64) delta_t tensor(-1.0348, dtype=torch.float64)
7 gae_duplicate tensor(-1.4752, dtype=torch.float64) tensor(3.0680, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7567, dtype=torch.float64) delta_t tensor(1.0181, dtype=torch.float64)
6 gae_duplicate tensor(-0.1620, dtype=torch.float64) tensor(0.3369, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1337, dtype=torch.float64) delta_t tensor(2.3203, dtype=torch.float64)
5 gae_duplicate tensor(2.1907, dtype=torch.float64) tensor(-4.5558, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6998, dtype=torch.float64) delta_t tensor(-0.9652, dtype=torch.float64)
4 gae_duplicate tensor(0.7873, dtype=torch.float64) tensor(-1.6377, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4517, dtype=torch.float64) delta_t tensor(-0.9580, dtype=torch.float64)
3 gae_duplicate tensor(-0.3281, dtype=torch.float64) tensor(0.6824, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0768, dtype=torch.float64) delta_t tensor(-0.7666, dtype=torch.float64)
2 gae_duplicate tensor(-1.0291, dtype=torch.float64) tensor(2.1403, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:33.60850143432617
value loss:17.490766525268555
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.313239097595215 seconds
19 rew tensor(0.8065, dtype=torch.float64) delta_t tensor(0.3554, dtype=torch.float64)
19 gae_duplicate tensor(0.3554, dtype=torch.float64) tensor(-0.7392, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8071, dtype=torch.float64) delta_t tensor(0.6225, dtype=torch.float64)
18 gae_duplicate tensor(0.9068, dtype=torch.float64) tensor(-1.8858, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8077, dtype=torch.float64) delta_t tensor(0.0098, dtype=torch.float64)
17 gae_duplicate tensor(0.7352, dtype=torch.float64) tensor(-1.5286, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8083, dtype=torch.float64) delta_t tensor(-1.1818, dtype=torch.float64)
16 gae_duplicate tensor(-0.5936, dtype=torch.float64) tensor(1.2345, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8090, dtype=torch.float64) delta_t tensor(0.3500, dtype=torch.float64)
15 gae_duplicate tensor(-0.1249, dtype=torch.float64) tensor(0.2597, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8096, dtype=torch.float64) delta_t tensor(0.2414, dtype=torch.float64)
14 gae_duplicate tensor(0.1415, dtype=torch.float64) tensor(-0.2943, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8102, dtype=torch.float64) delta_t tensor(0.2420, dtype=torch.float64)
13 gae_duplicate tensor(0.3552, dtype=torch.float64) tensor(-0.7385, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8108, dtype=torch.float64) delta_t tensor(0.2426, dtype=torch.float64)
12 gae_duplicate tensor(0.5268, dtype=torch.float64) tensor(-1.0955, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8115, dtype=torch.float64) delta_t tensor(0.2846, dtype=torch.float64)
11 gae_duplicate tensor(0.7060, dtype=torch.float64) tensor(-1.4676, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(0.0628, dtype=torch.float64)
10 gae_duplicate tensor(0.6275, dtype=torch.float64) tensor(-1.3048, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(0.2643, dtype=torch.float64)
9 gae_duplicate tensor(0.7663, dtype=torch.float64) tensor(-1.5936, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2483, dtype=torch.float64) delta_t tensor(-0.3030, dtype=torch.float64)
8 gae_duplicate tensor(0.3100, dtype=torch.float64) tensor(-0.6447, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0654, dtype=torch.float64) delta_t tensor(-1.0107, dtype=torch.float64)
7 gae_duplicate tensor(-0.7627, dtype=torch.float64) tensor(1.5862, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2573, dtype=torch.float64) delta_t tensor(0.6324, dtype=torch.float64)
6 gae_duplicate tensor(0.0222, dtype=torch.float64) tensor(-0.0462, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5098, dtype=torch.float64) delta_t tensor(1.9084, dtype=torch.float64)
5 gae_duplicate tensor(1.9262, dtype=torch.float64) tensor(-4.0049, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0772, dtype=torch.float64) delta_t tensor(-2.9250, dtype=torch.float64)
4 gae_duplicate tensor(-1.3841, dtype=torch.float64) tensor(2.8777, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8309, dtype=torch.float64) delta_t tensor(0.1634, dtype=torch.float64)
3 gae_duplicate tensor(-0.9438, dtype=torch.float64) tensor(1.9620, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5828, dtype=torch.float64) delta_t tensor(-1.5925, dtype=torch.float64)
2 gae_duplicate tensor(-2.3475, dtype=torch.float64) tensor(4.8831, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:14.120336532592773
value loss:24.69853973388672
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.339414119720459 seconds
19 rew tensor(0.8055, dtype=torch.float64) delta_t tensor(0.5456, dtype=torch.float64)
19 gae_duplicate tensor(0.5456, dtype=torch.float64) tensor(-1.1344, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8062, dtype=torch.float64) delta_t tensor(0.4355, dtype=torch.float64)
18 gae_duplicate tensor(0.8719, dtype=torch.float64) tensor(-1.8125, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8068, dtype=torch.float64) delta_t tensor(0.1844, dtype=torch.float64)
17 gae_duplicate tensor(0.8819, dtype=torch.float64) tensor(-1.8346, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8074, dtype=torch.float64) delta_t tensor(-1.0711, dtype=torch.float64)
16 gae_duplicate tensor(-0.3656, dtype=torch.float64) tensor(0.7599, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8080, dtype=torch.float64) delta_t tensor(0.2209, dtype=torch.float64)
15 gae_duplicate tensor(-0.0715, dtype=torch.float64) tensor(0.1488, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8086, dtype=torch.float64) delta_t tensor(0.2517, dtype=torch.float64)
14 gae_duplicate tensor(0.1945, dtype=torch.float64) tensor(-0.4042, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8092, dtype=torch.float64) delta_t tensor(0.2739, dtype=torch.float64)
13 gae_duplicate tensor(0.4295, dtype=torch.float64) tensor(-0.8934, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8098, dtype=torch.float64) delta_t tensor(0.2572, dtype=torch.float64)
12 gae_duplicate tensor(0.6008, dtype=torch.float64) tensor(-1.2495, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8104, dtype=torch.float64) delta_t tensor(0.3218, dtype=torch.float64)
11 gae_duplicate tensor(0.8024, dtype=torch.float64) tensor(-1.6685, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8110, dtype=torch.float64) delta_t tensor(0.0844, dtype=torch.float64)
10 gae_duplicate tensor(0.7264, dtype=torch.float64) tensor(-1.5100, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8117, dtype=torch.float64) delta_t tensor(0.2643, dtype=torch.float64)
9 gae_duplicate tensor(0.8454, dtype=torch.float64) tensor(-1.7577, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2476, dtype=torch.float64) delta_t tensor(-0.3509, dtype=torch.float64)
8 gae_duplicate tensor(0.3254, dtype=torch.float64) tensor(-0.6768, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1850, dtype=torch.float64) delta_t tensor(-0.8008, dtype=torch.float64)
7 gae_duplicate tensor(-0.5405, dtype=torch.float64) tensor(1.1238, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2568, dtype=torch.float64) delta_t tensor(0.7499, dtype=torch.float64)
6 gae_duplicate tensor(0.3175, dtype=torch.float64) tensor(-0.6605, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5091, dtype=torch.float64) delta_t tensor(1.9165, dtype=torch.float64)
5 gae_duplicate tensor(2.1705, dtype=torch.float64) tensor(-4.5141, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0761, dtype=torch.float64) delta_t tensor(-2.9397, dtype=torch.float64)
4 gae_duplicate tensor(-1.2032, dtype=torch.float64) tensor(2.5018, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7041, dtype=torch.float64) delta_t tensor(0.3463, dtype=torch.float64)
3 gae_duplicate tensor(-0.6163, dtype=torch.float64) tensor(1.2818, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7072, dtype=torch.float64) delta_t tensor(-1.8962, dtype=torch.float64)
2 gae_duplicate tensor(-2.3893, dtype=torch.float64) tensor(4.9690, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:42.863197326660156
value loss:25.78568458557129
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.8271)
ToM Target loss= tensor(307.1915)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.398305177688599 seconds
19 rew tensor(0.8050, dtype=torch.float64) delta_t tensor(0.2229, dtype=torch.float64)
19 gae_duplicate tensor(0.2229, dtype=torch.float64) tensor(-0.4634, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8056, dtype=torch.float64) delta_t tensor(0.6695, dtype=torch.float64)
18 gae_duplicate tensor(0.8478, dtype=torch.float64) tensor(-1.7627, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8061, dtype=torch.float64) delta_t tensor(-0.2613, dtype=torch.float64)
17 gae_duplicate tensor(0.4170, dtype=torch.float64) tensor(-0.8672, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8067, dtype=torch.float64) delta_t tensor(-1.0433, dtype=torch.float64)
16 gae_duplicate tensor(-0.7097, dtype=torch.float64) tensor(1.4760, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8073, dtype=torch.float64) delta_t tensor(0.3046, dtype=torch.float64)
15 gae_duplicate tensor(-0.2632, dtype=torch.float64) tensor(0.5472, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8079, dtype=torch.float64) delta_t tensor(0.2131, dtype=torch.float64)
14 gae_duplicate tensor(0.0026, dtype=torch.float64) tensor(-0.0053, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8085, dtype=torch.float64) delta_t tensor(0.2591, dtype=torch.float64)
13 gae_duplicate tensor(0.2612, dtype=torch.float64) tensor(-0.5431, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8091, dtype=torch.float64) delta_t tensor(0.2234, dtype=torch.float64)
12 gae_duplicate tensor(0.4323, dtype=torch.float64) tensor(-0.8989, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8097, dtype=torch.float64) delta_t tensor(0.2756, dtype=torch.float64)
11 gae_duplicate tensor(0.6214, dtype=torch.float64) tensor(-1.2927, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8103, dtype=torch.float64) delta_t tensor(-0.0134, dtype=torch.float64)
10 gae_duplicate tensor(0.4837, dtype=torch.float64) tensor(-1.0057, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8109, dtype=torch.float64) delta_t tensor(0.2246, dtype=torch.float64)
9 gae_duplicate tensor(0.6115, dtype=torch.float64) tensor(-1.2718, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2477, dtype=torch.float64) delta_t tensor(-0.4269, dtype=torch.float64)
8 gae_duplicate tensor(0.0623, dtype=torch.float64) tensor(-0.1296, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0600, dtype=torch.float64) delta_t tensor(-0.8305, dtype=torch.float64)
7 gae_duplicate tensor(-0.7807, dtype=torch.float64) tensor(1.6232, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1293, dtype=torch.float64) delta_t tensor(0.8453, dtype=torch.float64)
6 gae_duplicate tensor(0.2207, dtype=torch.float64) tensor(-0.4591, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3809, dtype=torch.float64) delta_t tensor(2.1399, dtype=torch.float64)
5 gae_duplicate tensor(2.3165, dtype=torch.float64) tensor(-4.8165, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1968, dtype=torch.float64) delta_t tensor(-3.0898, dtype=torch.float64)
4 gae_duplicate tensor(-1.2366, dtype=torch.float64) tensor(2.5717, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9517, dtype=torch.float64) delta_t tensor(0.2823, dtype=torch.float64)
3 gae_duplicate tensor(-0.7070, dtype=torch.float64) tensor(1.4703, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.8304, dtype=torch.float64) delta_t tensor(-1.6305, dtype=torch.float64)
2 gae_duplicate tensor(-2.1960, dtype=torch.float64) tensor(4.5658, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:6.448548316955566
value loss:23.46654510498047
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.301892995834351 seconds
19 rew tensor(0.8057, dtype=torch.float64) delta_t tensor(0.1812, dtype=torch.float64)
19 gae_duplicate tensor(0.1812, dtype=torch.float64) tensor(-0.3769, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8062, dtype=torch.float64) delta_t tensor(-0.2090, dtype=torch.float64)
18 gae_duplicate tensor(-0.0640, dtype=torch.float64) tensor(0.1331, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8068, dtype=torch.float64) delta_t tensor(0.5215, dtype=torch.float64)
17 gae_duplicate tensor(0.4703, dtype=torch.float64) tensor(-0.9779, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8074, dtype=torch.float64) delta_t tensor(-1.1789, dtype=torch.float64)
16 gae_duplicate tensor(-0.8027, dtype=torch.float64) tensor(1.6699, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8080, dtype=torch.float64) delta_t tensor(0.4265, dtype=torch.float64)
15 gae_duplicate tensor(-0.2157, dtype=torch.float64) tensor(0.4485, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8086, dtype=torch.float64) delta_t tensor(0.2228, dtype=torch.float64)
14 gae_duplicate tensor(0.0503, dtype=torch.float64) tensor(-0.1046, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8092, dtype=torch.float64) delta_t tensor(0.2234, dtype=torch.float64)
13 gae_duplicate tensor(0.2636, dtype=torch.float64) tensor(-0.5483, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8098, dtype=torch.float64) delta_t tensor(0.2240, dtype=torch.float64)
12 gae_duplicate tensor(0.4349, dtype=torch.float64) tensor(-0.9045, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8104, dtype=torch.float64) delta_t tensor(0.2246, dtype=torch.float64)
11 gae_duplicate tensor(0.5725, dtype=torch.float64) tensor(-1.1907, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8110, dtype=torch.float64) delta_t tensor(-0.0380, dtype=torch.float64)
10 gae_duplicate tensor(0.4200, dtype=torch.float64) tensor(-0.8730, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4356, dtype=torch.float64) delta_t tensor(-0.2631, dtype=torch.float64)
9 gae_duplicate tensor(0.0729, dtype=torch.float64) tensor(-0.1516, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0600, dtype=torch.float64) delta_t tensor(-0.4185, dtype=torch.float64)
8 gae_duplicate tensor(-0.3602, dtype=torch.float64) tensor(0.7487, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4408, dtype=torch.float64) delta_t tensor(-1.1719, dtype=torch.float64)
7 gae_duplicate tensor(-1.4600, dtype=torch.float64) tensor(3.0373, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2546, dtype=torch.float64) delta_t tensor(1.2553, dtype=torch.float64)
6 gae_duplicate tensor(0.0873, dtype=torch.float64) tensor(-0.1816, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4439, dtype=torch.float64) delta_t tensor(-1.6028, dtype=torch.float64)
5 gae_duplicate tensor(-1.5329, dtype=torch.float64) tensor(3.1881, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6964, dtype=torch.float64) delta_t tensor(1.8427, dtype=torch.float64)
4 gae_duplicate tensor(0.6164, dtype=torch.float64) tensor(-1.2815, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.2008, dtype=torch.float64) delta_t tensor(-1.9261, dtype=torch.float64)
3 gae_duplicate tensor(-1.4330, dtype=torch.float64) tensor(2.9795, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7623, dtype=torch.float64) delta_t tensor(-0.2052, dtype=torch.float64)
2 gae_duplicate tensor(-1.3516, dtype=torch.float64) tensor(2.8102, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-51.670467376708984
value loss:15.898443222045898
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.363525152206421 seconds
19 rew tensor(0.8057, dtype=torch.float64) delta_t tensor(0.2783, dtype=torch.float64)
19 gae_duplicate tensor(0.2783, dtype=torch.float64) tensor(-0.5786, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8063, dtype=torch.float64) delta_t tensor(0.3272, dtype=torch.float64)
18 gae_duplicate tensor(0.5498, dtype=torch.float64) tensor(-1.1435, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8069, dtype=torch.float64) delta_t tensor(-0.0781, dtype=torch.float64)
17 gae_duplicate tensor(0.3618, dtype=torch.float64) tensor(-0.7524, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8075, dtype=torch.float64) delta_t tensor(-1.0475, dtype=torch.float64)
16 gae_duplicate tensor(-0.7581, dtype=torch.float64) tensor(1.5757, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8080, dtype=torch.float64) delta_t tensor(0.3906, dtype=torch.float64)
15 gae_duplicate tensor(-0.2159, dtype=torch.float64) tensor(0.4490, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8086, dtype=torch.float64) delta_t tensor(0.2228, dtype=torch.float64)
14 gae_duplicate tensor(0.0500, dtype=torch.float64) tensor(-0.1040, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8092, dtype=torch.float64) delta_t tensor(0.2234, dtype=torch.float64)
13 gae_duplicate tensor(0.2634, dtype=torch.float64) tensor(-0.5476, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8098, dtype=torch.float64) delta_t tensor(0.2239, dtype=torch.float64)
12 gae_duplicate tensor(0.4346, dtype=torch.float64) tensor(-0.9034, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8104, dtype=torch.float64) delta_t tensor(0.1591, dtype=torch.float64)
11 gae_duplicate tensor(0.5068, dtype=torch.float64) tensor(-1.0539, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8109, dtype=torch.float64) delta_t tensor(0.0371, dtype=torch.float64)
10 gae_duplicate tensor(0.4425, dtype=torch.float64) tensor(-0.9201, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3728, dtype=torch.float64) delta_t tensor(-0.1629, dtype=torch.float64)
9 gae_duplicate tensor(0.1912, dtype=torch.float64) tensor(-0.3975, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3729, dtype=torch.float64) delta_t tensor(-0.3546, dtype=torch.float64)
8 gae_duplicate tensor(-0.2016, dtype=torch.float64) tensor(0.4193, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0600, dtype=torch.float64) delta_t tensor(-0.8783, dtype=torch.float64)
7 gae_duplicate tensor(-1.0396, dtype=torch.float64) tensor(2.1613, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0043, dtype=torch.float64) delta_t tensor(1.2662, dtype=torch.float64)
6 gae_duplicate tensor(0.4345, dtype=torch.float64) tensor(-0.9034, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2556, dtype=torch.float64) delta_t tensor(2.0876, dtype=torch.float64)
5 gae_duplicate tensor(2.4353, dtype=torch.float64) tensor(-5.0632, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8207, dtype=torch.float64) delta_t tensor(-2.0346, dtype=torch.float64)
4 gae_duplicate tensor(-0.0864, dtype=torch.float64) tensor(0.1797, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8241, dtype=torch.float64) delta_t tensor(-0.0895, dtype=torch.float64)
3 gae_duplicate tensor(-0.1586, dtype=torch.float64) tensor(0.3300, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5766, dtype=torch.float64) delta_t tensor(-1.3736, dtype=torch.float64)
2 gae_duplicate tensor(-1.5005, dtype=torch.float64) tensor(3.1207, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:23.6683292388916
value loss:17.10995864868164
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.313151836395264 seconds
19 rew tensor(0.6839, dtype=torch.float64) delta_t tensor(-0.5743, dtype=torch.float64)
19 gae_duplicate tensor(-0.5743, dtype=torch.float64) tensor(1.1937, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6214, dtype=torch.float64) delta_t tensor(-0.3500, dtype=torch.float64)
18 gae_duplicate tensor(-0.8095, dtype=torch.float64) tensor(1.6835, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4330, dtype=torch.float64) delta_t tensor(-0.3343, dtype=torch.float64)
17 gae_duplicate tensor(-0.9819, dtype=torch.float64) tensor(2.0414, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.0070, dtype=torch.float64) delta_t tensor(-1.2900, dtype=torch.float64)
16 gae_duplicate tensor(-2.0755, dtype=torch.float64) tensor(4.3166, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.6985, dtype=torch.float64) delta_t tensor(-0.9875, dtype=torch.float64)
15 gae_duplicate tensor(-2.6479, dtype=torch.float64) tensor(5.5070, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8095, dtype=torch.float64) delta_t tensor(0.2456, dtype=torch.float64)
14 gae_duplicate tensor(-1.8727, dtype=torch.float64) tensor(3.8935, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8100, dtype=torch.float64) delta_t tensor(0.2462, dtype=torch.float64)
13 gae_duplicate tensor(-1.2519, dtype=torch.float64) tensor(2.6037, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8106, dtype=torch.float64) delta_t tensor(0.2468, dtype=torch.float64)
12 gae_duplicate tensor(-0.7548, dtype=torch.float64) tensor(1.5697, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8112, dtype=torch.float64) delta_t tensor(0.2473, dtype=torch.float64)
11 gae_duplicate tensor(-0.3565, dtype=torch.float64) tensor(0.7411, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1836, dtype=torch.float64) delta_t tensor(-0.7187, dtype=torch.float64)
10 gae_duplicate tensor(-1.0038, dtype=torch.float64) tensor(2.0885, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6232, dtype=torch.float64) delta_t tensor(0.0325, dtype=torch.float64)
9 gae_duplicate tensor(-0.7706, dtype=torch.float64) tensor(1.6026, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3725, dtype=torch.float64) delta_t tensor(-0.4347, dtype=torch.float64)
8 gae_duplicate tensor(-1.0512, dtype=torch.float64) tensor(2.1854, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0666, dtype=torch.float64) delta_t tensor(-0.8155, dtype=torch.float64)
7 gae_duplicate tensor(-1.6564, dtype=torch.float64) tensor(3.4427, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8820, dtype=torch.float64) delta_t tensor(0.7411, dtype=torch.float64)
6 gae_duplicate tensor(-0.5840, dtype=torch.float64) tensor(1.2146, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1962, dtype=torch.float64) delta_t tensor(2.5632, dtype=torch.float64)
5 gae_duplicate tensor(2.0961, dtype=torch.float64) tensor(-4.3593, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4484, dtype=torch.float64) delta_t tensor(-0.3975, dtype=torch.float64)
4 gae_duplicate tensor(1.2793, dtype=torch.float64) tensor(-2.6615, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7014, dtype=torch.float64) delta_t tensor(-1.2558, dtype=torch.float64)
3 gae_duplicate tensor(-0.2324, dtype=torch.float64) tensor(0.4831, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7621, dtype=torch.float64) delta_t tensor(-0.1250, dtype=torch.float64)
2 gae_duplicate tensor(-0.3109, dtype=torch.float64) tensor(0.6463, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-170.2797393798828
value loss:46.51658630371094
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.3948352336883545 seconds
19 rew tensor(0.8115, dtype=torch.float64) delta_t tensor(-1.1953, dtype=torch.float64)
19 gae_duplicate tensor(-1.1953, dtype=torch.float64) tensor(2.4861, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(0.4110, dtype=torch.float64)
18 gae_duplicate tensor(-0.5453, dtype=torch.float64) tensor(1.1333, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8126, dtype=torch.float64) delta_t tensor(0.2672, dtype=torch.float64)
17 gae_duplicate tensor(-0.1690, dtype=torch.float64) tensor(0.3516, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(-0.5832, dtype=torch.float64)
16 gae_duplicate tensor(-0.7184, dtype=torch.float64) tensor(1.4936, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.3047, dtype=torch.float64)
15 gae_duplicate tensor(-0.2700, dtype=torch.float64) tensor(0.5611, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.1470, dtype=torch.float64)
14 gae_duplicate tensor(-0.0690, dtype=torch.float64) tensor(0.1435, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.2466, dtype=torch.float64)
13 gae_duplicate tensor(0.1914, dtype=torch.float64) tensor(-0.3981, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.3825, dtype=torch.float64)
12 gae_duplicate tensor(0.5356, dtype=torch.float64) tensor(-1.1132, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(4.5512, dtype=torch.float64)
11 gae_duplicate tensor(4.9796, dtype=torch.float64) tensor(-10.3599, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1252, dtype=torch.float64) delta_t tensor(-4.1366, dtype=torch.float64)
10 gae_duplicate tensor(-0.1529, dtype=torch.float64) tensor(0.3178, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6915, dtype=torch.float64) delta_t tensor(-1.2620, dtype=torch.float64)
9 gae_duplicate tensor(-1.3843, dtype=torch.float64) tensor(2.8790, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1266, dtype=torch.float64) delta_t tensor(-0.5799, dtype=torch.float64)
8 gae_duplicate tensor(-1.6873, dtype=torch.float64) tensor(3.5090, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0617, dtype=torch.float64) delta_t tensor(-0.5205, dtype=torch.float64)
7 gae_duplicate tensor(-1.8703, dtype=torch.float64) tensor(3.8902, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8169, dtype=torch.float64) delta_t tensor(2.0530, dtype=torch.float64)
6 gae_duplicate tensor(0.5567, dtype=torch.float64) tensor(-1.1575, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8215, dtype=torch.float64) delta_t tensor(0.6916, dtype=torch.float64)
5 gae_duplicate tensor(1.1370, dtype=torch.float64) tensor(-2.3647, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8248, dtype=torch.float64) delta_t tensor(-2.5621, dtype=torch.float64)
4 gae_duplicate tensor(-1.6526, dtype=torch.float64) tensor(3.4369, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8281, dtype=torch.float64) delta_t tensor(0.4663, dtype=torch.float64)
3 gae_duplicate tensor(-0.8557, dtype=torch.float64) tensor(1.7803, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7056, dtype=torch.float64) delta_t tensor(-1.6443, dtype=torch.float64)
2 gae_duplicate tensor(-2.3289, dtype=torch.float64) tensor(4.8452, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-69.72876739501953
value loss:69.36453247070312
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.9466)
ToM Target loss= tensor(307.2531)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.406260013580322 seconds
19 rew tensor(0.8113, dtype=torch.float64) delta_t tensor(-0.7103, dtype=torch.float64)
19 gae_duplicate tensor(-0.7103, dtype=torch.float64) tensor(1.4767, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8119, dtype=torch.float64) delta_t tensor(0.1838, dtype=torch.float64)
18 gae_duplicate tensor(-0.3844, dtype=torch.float64) tensor(0.7993, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8125, dtype=torch.float64) delta_t tensor(0.8578, dtype=torch.float64)
17 gae_duplicate tensor(0.5502, dtype=torch.float64) tensor(-1.1440, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(-0.8175, dtype=torch.float64)
16 gae_duplicate tensor(-0.3773, dtype=torch.float64) tensor(0.7844, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.0850, dtype=torch.float64)
15 gae_duplicate tensor(-0.2168, dtype=torch.float64) tensor(0.4508, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.2203, dtype=torch.float64)
14 gae_duplicate tensor(0.0468, dtype=torch.float64) tensor(-0.0974, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.2248, dtype=torch.float64)
13 gae_duplicate tensor(0.2623, dtype=torch.float64) tensor(-0.5451, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.2438, dtype=torch.float64)
12 gae_duplicate tensor(0.4536, dtype=torch.float64) tensor(-0.9430, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(0.3572, dtype=torch.float64)
11 gae_duplicate tensor(0.7201, dtype=torch.float64) tensor(-1.4976, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(0.0026, dtype=torch.float64)
10 gae_duplicate tensor(0.5786, dtype=torch.float64) tensor(-1.2035, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4389, dtype=torch.float64) delta_t tensor(-0.0381, dtype=torch.float64)
9 gae_duplicate tensor(0.4248, dtype=torch.float64) tensor(-0.8834, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2501, dtype=torch.float64) delta_t tensor(-0.4387, dtype=torch.float64)
8 gae_duplicate tensor(-0.0989, dtype=torch.float64) tensor(0.2058, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0613, dtype=torch.float64) delta_t tensor(-0.8471, dtype=torch.float64)
7 gae_duplicate tensor(-0.9263, dtype=torch.float64) tensor(1.9251, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8827, dtype=torch.float64) delta_t tensor(1.3216, dtype=torch.float64)
6 gae_duplicate tensor(0.5806, dtype=torch.float64) tensor(-1.2076, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1350, dtype=torch.float64) delta_t tensor(2.5214, dtype=torch.float64)
5 gae_duplicate tensor(2.9859, dtype=torch.float64) tensor(-6.2058, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4508, dtype=torch.float64) delta_t tensor(-0.6326, dtype=torch.float64)
4 gae_duplicate tensor(1.7561, dtype=torch.float64) tensor(-3.6499, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2008, dtype=torch.float64) delta_t tensor(-0.5683, dtype=torch.float64)
3 gae_duplicate tensor(0.8366, dtype=torch.float64) tensor(-1.7400, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0761, dtype=torch.float64) delta_t tensor(-1.2108, dtype=torch.float64)
2 gae_duplicate tensor(-0.5416, dtype=torch.float64) tensor(1.1259, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:72.97321319580078
value loss:24.978595733642578
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.470935106277466 seconds
19 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(-1.0733, dtype=torch.float64)
19 gae_duplicate tensor(-1.0733, dtype=torch.float64) tensor(2.2314, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8123, dtype=torch.float64) delta_t tensor(0.3681, dtype=torch.float64)
18 gae_duplicate tensor(-0.4905, dtype=torch.float64) tensor(1.0202, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(0.4764, dtype=torch.float64)
17 gae_duplicate tensor(0.0840, dtype=torch.float64) tensor(-0.1747, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(-0.5631, dtype=torch.float64)
16 gae_duplicate tensor(-0.4959, dtype=torch.float64) tensor(1.0310, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(0.0979, dtype=torch.float64)
15 gae_duplicate tensor(-0.2988, dtype=torch.float64) tensor(0.6210, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.2081, dtype=torch.float64)
14 gae_duplicate tensor(-0.0310, dtype=torch.float64) tensor(0.0644, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.2192, dtype=torch.float64)
13 gae_duplicate tensor(0.1945, dtype=torch.float64) tensor(-0.4045, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.2495, dtype=torch.float64)
12 gae_duplicate tensor(0.4051, dtype=torch.float64) tensor(-0.8422, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.3231, dtype=torch.float64)
11 gae_duplicate tensor(0.6472, dtype=torch.float64) tensor(-1.3450, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(-0.0632, dtype=torch.float64)
10 gae_duplicate tensor(0.4545, dtype=torch.float64) tensor(-0.9450, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4387, dtype=torch.float64) delta_t tensor(-0.1722, dtype=torch.float64)
9 gae_duplicate tensor(0.1914, dtype=torch.float64) tensor(-0.3980, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0605, dtype=torch.float64) delta_t tensor(-0.5198, dtype=torch.float64)
8 gae_duplicate tensor(-0.3667, dtype=torch.float64) tensor(0.7621, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1917, dtype=torch.float64) delta_t tensor(-1.0986, dtype=torch.float64)
7 gae_duplicate tensor(-1.3920, dtype=torch.float64) tensor(2.8949, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0110, dtype=torch.float64) delta_t tensor(1.0837, dtype=torch.float64)
6 gae_duplicate tensor(-0.0299, dtype=torch.float64) tensor(0.0623, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2639, dtype=torch.float64) delta_t tensor(2.5257, dtype=torch.float64)
5 gae_duplicate tensor(2.5018, dtype=torch.float64) tensor(-5.2033, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8326, dtype=torch.float64) delta_t tensor(-1.0017, dtype=torch.float64)
4 gae_duplicate tensor(0.9997, dtype=torch.float64) tensor(-2.0792, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4573, dtype=torch.float64) delta_t tensor(-0.7178, dtype=torch.float64)
3 gae_duplicate tensor(0.0819, dtype=torch.float64) tensor(-0.1704, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2066, dtype=torch.float64) delta_t tensor(-1.0017, dtype=torch.float64)
2 gae_duplicate tensor(-0.9361, dtype=torch.float64) tensor(1.9470, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4.444031238555908
value loss:19.22109031677246
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.575779914855957 seconds
19 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(-0.5340, dtype=torch.float64)
19 gae_duplicate tensor(-0.5340, dtype=torch.float64) tensor(1.1106, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8126, dtype=torch.float64) delta_t tensor(-0.0893, dtype=torch.float64)
18 gae_duplicate tensor(-0.5165, dtype=torch.float64) tensor(1.0743, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.3795, dtype=torch.float64)
17 gae_duplicate tensor(-0.0337, dtype=torch.float64) tensor(0.0702, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(-0.7417, dtype=torch.float64)
16 gae_duplicate tensor(-0.7687, dtype=torch.float64) tensor(1.5981, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.4176, dtype=torch.float64)
15 gae_duplicate tensor(-0.1973, dtype=torch.float64) tensor(0.4103, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.2284, dtype=torch.float64)
14 gae_duplicate tensor(0.0706, dtype=torch.float64) tensor(-0.1468, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.2290, dtype=torch.float64)
13 gae_duplicate tensor(0.2854, dtype=torch.float64) tensor(-0.5939, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(0.2295, dtype=torch.float64)
12 gae_duplicate tensor(0.4579, dtype=torch.float64) tensor(-0.9519, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(0.2301, dtype=torch.float64)
11 gae_duplicate tensor(0.5964, dtype=torch.float64) tensor(-1.2394, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8169, dtype=torch.float64) delta_t tensor(-0.0322, dtype=torch.float64)
10 gae_duplicate tensor(0.4449, dtype=torch.float64) tensor(-0.9257, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8175, dtype=torch.float64) delta_t tensor(0.0433, dtype=torch.float64)
9 gae_duplicate tensor(0.3993, dtype=torch.float64) tensor(-0.8301, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0644, dtype=torch.float64) delta_t tensor(-0.5866, dtype=torch.float64)
8 gae_duplicate tensor(-0.2672, dtype=torch.float64) tensor(0.5557, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5685, dtype=torch.float64) delta_t tensor(-1.4116, dtype=torch.float64)
7 gae_duplicate tensor(-1.6254, dtype=torch.float64) tensor(3.3804, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0097, dtype=torch.float64) delta_t tensor(2.4243, dtype=torch.float64)
6 gae_duplicate tensor(1.1240, dtype=torch.float64) tensor(-2.3360, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2624, dtype=torch.float64) delta_t tensor(-2.0373, dtype=torch.float64)
5 gae_duplicate tensor(-1.1380, dtype=torch.float64) tensor(2.3670, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9568, dtype=torch.float64) delta_t tensor(1.8019, dtype=torch.float64)
4 gae_duplicate tensor(0.8915, dtype=torch.float64) tensor(-1.8541, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.2129, dtype=torch.float64) delta_t tensor(-1.6112, dtype=torch.float64)
3 gae_duplicate tensor(-0.8980, dtype=torch.float64) tensor(1.8684, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0179, dtype=torch.float64) delta_t tensor(-0.5358, dtype=torch.float64)
2 gae_duplicate tensor(-1.2542, dtype=torch.float64) tensor(2.6065, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-38.10408401489258
value loss:15.95707893371582
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.312916994094849 seconds
19 rew tensor(0.8122, dtype=torch.float64) delta_t tensor(-0.4111, dtype=torch.float64)
19 gae_duplicate tensor(-0.4111, dtype=torch.float64) tensor(0.8547, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(-0.1514, dtype=torch.float64)
18 gae_duplicate tensor(-0.4802, dtype=torch.float64) tensor(0.9984, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(0.2642, dtype=torch.float64)
17 gae_duplicate tensor(-0.1200, dtype=torch.float64) tensor(0.2494, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(-0.5603, dtype=torch.float64)
16 gae_duplicate tensor(-0.6562, dtype=torch.float64) tensor(1.3649, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.2794, dtype=torch.float64)
15 gae_duplicate tensor(-0.2456, dtype=torch.float64) tensor(0.5111, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.2188, dtype=torch.float64)
14 gae_duplicate tensor(0.0223, dtype=torch.float64) tensor(-0.0464, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.2595, dtype=torch.float64)
13 gae_duplicate tensor(0.2774, dtype=torch.float64) tensor(-0.5767, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(0.2279, dtype=torch.float64)
12 gae_duplicate tensor(0.4498, dtype=torch.float64) tensor(-0.9359, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.2753, dtype=torch.float64)
11 gae_duplicate tensor(0.6352, dtype=torch.float64) tensor(-1.3206, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.0178, dtype=torch.float64)
10 gae_duplicate tensor(0.5260, dtype=torch.float64) tensor(-1.0936, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4392, dtype=torch.float64) delta_t tensor(-0.1334, dtype=torch.float64)
9 gae_duplicate tensor(0.2874, dtype=torch.float64) tensor(-0.5975, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2502, dtype=torch.float64) delta_t tensor(-0.3853, dtype=torch.float64)
8 gae_duplicate tensor(-0.1554, dtype=torch.float64) tensor(0.3231, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0648, dtype=torch.float64) delta_t tensor(-0.9617, dtype=torch.float64)
7 gae_duplicate tensor(-1.0860, dtype=torch.float64) tensor(2.2589, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0097, dtype=torch.float64) delta_t tensor(1.0374, dtype=torch.float64)
6 gae_duplicate tensor(0.1685, dtype=torch.float64) tensor(-0.3504, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2625, dtype=torch.float64) delta_t tensor(2.4780, dtype=torch.float64)
5 gae_duplicate tensor(2.6129, dtype=torch.float64) tensor(-5.4365, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9569, dtype=torch.float64) delta_t tensor(-1.0983, dtype=torch.float64)
4 gae_duplicate tensor(0.9920, dtype=torch.float64) tensor(-2.0631, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7083, dtype=torch.float64) delta_t tensor(-0.7735, dtype=torch.float64)
3 gae_duplicate tensor(0.0201, dtype=torch.float64) tensor(-0.0418, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4585, dtype=torch.float64) delta_t tensor(-1.1190, dtype=torch.float64)
2 gae_duplicate tensor(-1.1029, dtype=torch.float64) tensor(2.2929, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:20.532201766967773
value loss:18.311187744140625
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.46084189414978 seconds
19 rew tensor(0.8125, dtype=torch.float64) delta_t tensor(0.0395, dtype=torch.float64)
19 gae_duplicate tensor(0.0395, dtype=torch.float64) tensor(-0.0821, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(0.2402, dtype=torch.float64)
18 gae_duplicate tensor(0.2718, dtype=torch.float64) tensor(-0.5648, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(-0.2665, dtype=torch.float64)
17 gae_duplicate tensor(-0.0491, dtype=torch.float64) tensor(0.1020, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(-0.3824, dtype=torch.float64)
16 gae_duplicate tensor(-0.4217, dtype=torch.float64) tensor(0.8771, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.1509, dtype=torch.float64)
15 gae_duplicate tensor(-0.1864, dtype=torch.float64) tensor(0.3876, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.2307, dtype=torch.float64)
14 gae_duplicate tensor(0.0816, dtype=torch.float64) tensor(-0.1696, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.2312, dtype=torch.float64)
13 gae_duplicate tensor(0.2965, dtype=torch.float64) tensor(-0.6161, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.2586, dtype=torch.float64)
12 gae_duplicate tensor(0.4958, dtype=torch.float64) tensor(-1.0308, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(0.2078, dtype=torch.float64)
11 gae_duplicate tensor(0.6045, dtype=torch.float64) tensor(-1.2572, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8172, dtype=torch.float64) delta_t tensor(0.1127, dtype=torch.float64)
10 gae_duplicate tensor(0.5962, dtype=torch.float64) tensor(-1.2407, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3132, dtype=torch.float64) delta_t tensor(-0.2254, dtype=torch.float64)
9 gae_duplicate tensor(0.2516, dtype=torch.float64) tensor(-0.5233, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1243, dtype=torch.float64) delta_t tensor(-0.2127, dtype=torch.float64)
8 gae_duplicate tensor(-0.0114, dtype=torch.float64) tensor(0.0238, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3168, dtype=torch.float64) delta_t tensor(-1.1985, dtype=torch.float64)
7 gae_duplicate tensor(-1.2077, dtype=torch.float64) tensor(2.5097, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3878, dtype=torch.float64) delta_t tensor(0.5400, dtype=torch.float64)
6 gae_duplicate tensor(-0.4261, dtype=torch.float64) tensor(0.8858, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6414, dtype=torch.float64) delta_t tensor(2.0412, dtype=torch.float64)
5 gae_duplicate tensor(1.7003, dtype=torch.float64) tensor(-3.5351, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9590, dtype=torch.float64) delta_t tensor(-1.0583, dtype=torch.float64)
4 gae_duplicate tensor(0.3020, dtype=torch.float64) tensor(-0.6278, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7102, dtype=torch.float64) delta_t tensor(-0.8645, dtype=torch.float64)
3 gae_duplicate tensor(-0.6230, dtype=torch.float64) tensor(1.2957, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3338, dtype=torch.float64) delta_t tensor(-1.3109, dtype=torch.float64)
2 gae_duplicate tensor(-1.8093, dtype=torch.float64) tensor(3.7630, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2.30564546585083
value loss:14.548311233520508
entropies:37.42993927001953
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.7491)
ToM Target loss= tensor(307.2748)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.329767942428589 seconds
19 rew tensor(0.8112, dtype=torch.float64) delta_t tensor(0.2177, dtype=torch.float64)
19 gae_duplicate tensor(0.2177, dtype=torch.float64) tensor(-0.4529, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8117, dtype=torch.float64) delta_t tensor(0.5964, dtype=torch.float64)
18 gae_duplicate tensor(0.7705, dtype=torch.float64) tensor(-1.6027, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8122, dtype=torch.float64) delta_t tensor(-0.1226, dtype=torch.float64)
17 gae_duplicate tensor(0.4939, dtype=torch.float64) tensor(-1.0276, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(-0.7688, dtype=torch.float64)
16 gae_duplicate tensor(-0.3738, dtype=torch.float64) tensor(0.7774, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(0.1741, dtype=torch.float64)
15 gae_duplicate tensor(-0.1249, dtype=torch.float64) tensor(0.2598, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(0.2426, dtype=torch.float64)
14 gae_duplicate tensor(0.1426, dtype=torch.float64) tensor(-0.2968, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.2431, dtype=torch.float64)
13 gae_duplicate tensor(0.3572, dtype=torch.float64) tensor(-0.7423, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.2810, dtype=torch.float64)
12 gae_duplicate tensor(0.5668, dtype=torch.float64) tensor(-1.1778, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.3470, dtype=torch.float64)
11 gae_duplicate tensor(0.8004, dtype=torch.float64) tensor(-1.6648, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(0.0322, dtype=torch.float64)
10 gae_duplicate tensor(0.6726, dtype=torch.float64) tensor(-1.3995, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.2399, dtype=torch.float64)
9 gae_duplicate tensor(0.7780, dtype=torch.float64) tensor(-1.6174, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.8169, dtype=torch.float64) delta_t tensor(0.2117, dtype=torch.float64)
8 gae_duplicate tensor(0.8341, dtype=torch.float64) tensor(-1.7334, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0619, dtype=torch.float64) delta_t tensor(-0.8745, dtype=torch.float64)
7 gae_duplicate tensor(-0.2072, dtype=torch.float64) tensor(0.4308, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1339, dtype=torch.float64) delta_t tensor(0.9639, dtype=torch.float64)
6 gae_duplicate tensor(0.7982, dtype=torch.float64) tensor(-1.6587, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3867, dtype=torch.float64) delta_t tensor(2.2494, dtype=torch.float64)
5 gae_duplicate tensor(2.8880, dtype=torch.float64) tensor(-6.0041, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2068, dtype=torch.float64) delta_t tensor(-3.0029, dtype=torch.float64)
4 gae_duplicate tensor(-0.6925, dtype=torch.float64) tensor(1.4403, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9595, dtype=torch.float64) delta_t tensor(0.4397, dtype=torch.float64)
3 gae_duplicate tensor(-0.1143, dtype=torch.float64) tensor(0.2376, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7107, dtype=torch.float64) delta_t tensor(-1.4290, dtype=torch.float64)
2 gae_duplicate tensor(-1.5204, dtype=torch.float64) tensor(3.1596, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:77.31253814697266
value loss:23.592395782470703
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.325863838195801 seconds
19 rew tensor(0.8120, dtype=torch.float64) delta_t tensor(-1.1293, dtype=torch.float64)
19 gae_duplicate tensor(-1.1293, dtype=torch.float64) tensor(2.3479, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8125, dtype=torch.float64) delta_t tensor(0.4228, dtype=torch.float64)
18 gae_duplicate tensor(-0.4806, dtype=torch.float64) tensor(1.0001, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(0.2351, dtype=torch.float64)
17 gae_duplicate tensor(-0.1494, dtype=torch.float64) tensor(0.3107, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(-0.4894, dtype=torch.float64)
16 gae_duplicate tensor(-0.6089, dtype=torch.float64) tensor(1.2654, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.3586, dtype=torch.float64)
15 gae_duplicate tensor(-0.1286, dtype=torch.float64) tensor(0.2672, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.2421, dtype=torch.float64)
14 gae_duplicate tensor(0.1392, dtype=torch.float64) tensor(-0.2894, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.2426, dtype=torch.float64)
13 gae_duplicate tensor(0.3539, dtype=torch.float64) tensor(-0.7362, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.2431, dtype=torch.float64)
12 gae_duplicate tensor(0.5262, dtype=torch.float64) tensor(-1.0941, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.1896, dtype=torch.float64)
11 gae_duplicate tensor(0.6106, dtype=torch.float64) tensor(-1.2704, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6274, dtype=torch.float64) delta_t tensor(-0.0473, dtype=torch.float64)
10 gae_duplicate tensor(0.4412, dtype=torch.float64) tensor(-0.9175, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3754, dtype=torch.float64) delta_t tensor(-0.3864, dtype=torch.float64)
9 gae_duplicate tensor(-0.0335, dtype=torch.float64) tensor(0.0696, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1864, dtype=torch.float64) delta_t tensor(-0.3729, dtype=torch.float64)
8 gae_duplicate tensor(-0.3997, dtype=torch.float64) tensor(0.8313, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4437, dtype=torch.float64) delta_t tensor(-1.2305, dtype=torch.float64)
7 gae_duplicate tensor(-1.5502, dtype=torch.float64) tensor(3.2244, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7590, dtype=torch.float64) delta_t tensor(2.5420, dtype=torch.float64)
6 gae_duplicate tensor(1.3018, dtype=torch.float64) tensor(-2.7076, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0114, dtype=torch.float64) delta_t tensor(1.5730, dtype=torch.float64)
5 gae_duplicate tensor(2.6144, dtype=torch.float64) tensor(-5.4354, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7051, dtype=torch.float64) delta_t tensor(-0.6003, dtype=torch.float64)
4 gae_duplicate tensor(1.4913, dtype=torch.float64) tensor(-3.1017, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7076, dtype=torch.float64) delta_t tensor(-1.1181, dtype=torch.float64)
3 gae_duplicate tensor(0.0749, dtype=torch.float64) tensor(-0.1558, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7639, dtype=torch.float64) delta_t tensor(-0.1798, dtype=torch.float64)
2 gae_duplicate tensor(-0.1199, dtype=torch.float64) tensor(0.2493, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:35.73100280761719
value loss:24.36465072631836
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.682850122451782 seconds
19 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(-0.3074, dtype=torch.float64)
19 gae_duplicate tensor(-0.3074, dtype=torch.float64) tensor(0.6396, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(0.8070, dtype=torch.float64)
18 gae_duplicate tensor(0.5611, dtype=torch.float64) tensor(-1.1661, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8126, dtype=torch.float64) delta_t tensor(-0.5529, dtype=torch.float64)
17 gae_duplicate tensor(-0.1040, dtype=torch.float64) tensor(0.2162, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(-0.5985, dtype=torch.float64)
16 gae_duplicate tensor(-0.6817, dtype=torch.float64) tensor(1.4179, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.4004, dtype=torch.float64)
15 gae_duplicate tensor(-0.1449, dtype=torch.float64) tensor(0.3015, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.2386, dtype=torch.float64)
14 gae_duplicate tensor(0.1227, dtype=torch.float64) tensor(-0.2551, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.2391, dtype=torch.float64)
13 gae_duplicate tensor(0.3373, dtype=torch.float64) tensor(-0.7015, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.2396, dtype=torch.float64)
12 gae_duplicate tensor(0.5095, dtype=torch.float64) tensor(-1.0588, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.2401, dtype=torch.float64)
11 gae_duplicate tensor(0.6477, dtype=torch.float64) tensor(-1.3472, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.0361, dtype=torch.float64)
10 gae_duplicate tensor(0.5543, dtype=torch.float64) tensor(-1.1518, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(0.2255, dtype=torch.float64)
9 gae_duplicate tensor(0.6690, dtype=torch.float64) tensor(-1.3914, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2503, dtype=torch.float64) delta_t tensor(-0.3439, dtype=torch.float64)
8 gae_duplicate tensor(0.1913, dtype=torch.float64) tensor(-0.3978, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1903, dtype=torch.float64) delta_t tensor(-1.0191, dtype=torch.float64)
7 gae_duplicate tensor(-0.8661, dtype=torch.float64) tensor(1.8015, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1345, dtype=torch.float64) delta_t tensor(0.9219, dtype=torch.float64)
6 gae_duplicate tensor(0.2290, dtype=torch.float64) tensor(-0.4765, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5131, dtype=torch.float64) delta_t tensor(2.0436, dtype=torch.float64)
5 gae_duplicate tensor(2.2268, dtype=torch.float64) tensor(-4.6314, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2077, dtype=torch.float64) delta_t tensor(-2.9592, dtype=torch.float64)
4 gae_duplicate tensor(-1.1778, dtype=torch.float64) tensor(2.4485, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9603, dtype=torch.float64) delta_t tensor(0.4332, dtype=torch.float64)
3 gae_duplicate tensor(-0.5090, dtype=torch.float64) tensor(1.0586, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7113, dtype=torch.float64) delta_t tensor(-1.2426, dtype=torch.float64)
2 gae_duplicate tensor(-1.6497, dtype=torch.float64) tensor(3.4299, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:6.460843086242676
value loss:18.95109748840332
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.105473041534424 seconds
19 rew tensor(0.8126, dtype=torch.float64) delta_t tensor(-0.8859, dtype=torch.float64)
19 gae_duplicate tensor(-0.8859, dtype=torch.float64) tensor(1.8433, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.2650, dtype=torch.float64)
18 gae_duplicate tensor(-0.4437, dtype=torch.float64) tensor(0.9224, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.4519, dtype=torch.float64)
17 gae_duplicate tensor(0.0970, dtype=torch.float64) tensor(-0.2016, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.2444, dtype=torch.float64)
16 gae_duplicate tensor(0.3220, dtype=torch.float64) tensor(-0.6701, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(-0.5455, dtype=torch.float64)
15 gae_duplicate tensor(-0.2879, dtype=torch.float64) tensor(0.5988, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.2115, dtype=torch.float64)
14 gae_duplicate tensor(-0.0188, dtype=torch.float64) tensor(0.0391, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.2191, dtype=torch.float64)
13 gae_duplicate tensor(0.2040, dtype=torch.float64) tensor(-0.4242, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.2765, dtype=torch.float64)
12 gae_duplicate tensor(0.4397, dtype=torch.float64) tensor(-0.9138, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(0.2195, dtype=torch.float64)
11 gae_duplicate tensor(0.5713, dtype=torch.float64) tensor(-1.1883, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8171, dtype=torch.float64) delta_t tensor(0.1954, dtype=torch.float64)
10 gae_duplicate tensor(0.6525, dtype=torch.float64) tensor(-1.3565, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1248, dtype=torch.float64) delta_t tensor(-0.4384, dtype=torch.float64)
9 gae_duplicate tensor(0.0836, dtype=torch.float64) tensor(-0.1738, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0619, dtype=torch.float64) delta_t tensor(-0.3044, dtype=torch.float64)
8 gae_duplicate tensor(-0.2375, dtype=torch.float64) tensor(0.4939, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0710, dtype=torch.float64) delta_t tensor(-2.1166, dtype=torch.float64)
7 gae_duplicate tensor(-2.3066, dtype=torch.float64) tensor(4.7977, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1347, dtype=torch.float64) delta_t tensor(2.0841, dtype=torch.float64)
6 gae_duplicate tensor(0.2388, dtype=torch.float64) tensor(-0.4969, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3875, dtype=torch.float64) delta_t tensor(-1.0050, dtype=torch.float64)
5 gae_duplicate tensor(-0.8140, dtype=torch.float64) tensor(1.6915, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9557, dtype=torch.float64) delta_t tensor(0.9895, dtype=torch.float64)
4 gae_duplicate tensor(0.3383, dtype=torch.float64) tensor(-0.7036, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9591, dtype=torch.float64) delta_t tensor(-1.5078, dtype=torch.float64)
3 gae_duplicate tensor(-1.2372, dtype=torch.float64) tensor(2.5720, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7637, dtype=torch.float64) delta_t tensor(-0.4493, dtype=torch.float64)
2 gae_duplicate tensor(-1.4390, dtype=torch.float64) tensor(2.9944, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-60.06976318359375
value loss:17.9766845703125
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.421831130981445 seconds
19 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(0.1285, dtype=torch.float64)
19 gae_duplicate tensor(0.1285, dtype=torch.float64) tensor(-0.2673, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8126, dtype=torch.float64) delta_t tensor(0.7634, dtype=torch.float64)
18 gae_duplicate tensor(0.8662, dtype=torch.float64) tensor(-1.8024, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(-0.6130, dtype=torch.float64)
17 gae_duplicate tensor(0.0799, dtype=torch.float64) tensor(-0.1660, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(-0.0257, dtype=torch.float64)
16 gae_duplicate tensor(0.0382, dtype=torch.float64) tensor(-0.0794, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(-0.2555, dtype=torch.float64)
15 gae_duplicate tensor(-0.2249, dtype=torch.float64) tensor(0.4678, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.2228, dtype=torch.float64)
14 gae_duplicate tensor(0.0428, dtype=torch.float64) tensor(-0.0891, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.2232, dtype=torch.float64)
13 gae_duplicate tensor(0.2575, dtype=torch.float64) tensor(-0.5351, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.2547, dtype=torch.float64)
12 gae_duplicate tensor(0.4607, dtype=torch.float64) tensor(-0.9586, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(0.2668, dtype=torch.float64)
11 gae_duplicate tensor(0.6353, dtype=torch.float64) tensor(-1.3208, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.4737, dtype=torch.float64)
10 gae_duplicate tensor(0.9820, dtype=torch.float64) tensor(-2.0414, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(-0.0432, dtype=torch.float64)
9 gae_duplicate tensor(0.7424, dtype=torch.float64) tensor(-1.5440, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0002, dtype=torch.float64) delta_t tensor(-0.2241, dtype=torch.float64)
8 gae_duplicate tensor(0.3698, dtype=torch.float64) tensor(-0.7685, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1883, dtype=torch.float64) delta_t tensor(-1.2033, dtype=torch.float64)
7 gae_duplicate tensor(-0.9075, dtype=torch.float64) tensor(1.8875, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5076, dtype=torch.float64) delta_t tensor(0.6578, dtype=torch.float64)
6 gae_duplicate tensor(-0.0682, dtype=torch.float64) tensor(0.1417, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7608, dtype=torch.float64) delta_t tensor(1.6156, dtype=torch.float64)
5 gae_duplicate tensor(1.5611, dtype=torch.float64) tensor(-3.2484, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3295, dtype=torch.float64) delta_t tensor(-3.1196, dtype=torch.float64)
4 gae_duplicate tensor(-1.8707, dtype=torch.float64) tensor(3.8910, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7049, dtype=torch.float64) delta_t tensor(0.7483, dtype=torch.float64)
3 gae_duplicate tensor(-0.7483, dtype=torch.float64) tensor(1.5557, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.8334, dtype=torch.float64) delta_t tensor(-1.7109, dtype=torch.float64)
2 gae_duplicate tensor(-2.3096, dtype=torch.float64) tensor(4.8059, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-0.6955976486206055
value loss:23.730426788330078
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.2391)
ToM Target loss= tensor(307.5801)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.04301118850708 seconds
19 rew tensor(0.8122, dtype=torch.float64) delta_t tensor(-0.9024, dtype=torch.float64)
19 gae_duplicate tensor(-0.9024, dtype=torch.float64) tensor(1.8761, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(0.3883, dtype=torch.float64)
18 gae_duplicate tensor(-0.3336, dtype=torch.float64) tensor(0.6936, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(0.6911, dtype=torch.float64)
17 gae_duplicate tensor(0.4242, dtype=torch.float64) tensor(-0.8823, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(-0.4425, dtype=torch.float64)
16 gae_duplicate tensor(-0.1031, dtype=torch.float64) tensor(0.2144, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(-0.0863, dtype=torch.float64)
15 gae_duplicate tensor(-0.1688, dtype=torch.float64) tensor(0.3509, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.2530, dtype=torch.float64)
14 gae_duplicate tensor(0.1180, dtype=torch.float64) tensor(-0.2451, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.2617, dtype=torch.float64)
13 gae_duplicate tensor(0.3560, dtype=torch.float64) tensor(-0.7401, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.2718, dtype=torch.float64)
12 gae_duplicate tensor(0.5566, dtype=torch.float64) tensor(-1.1572, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(0.2840, dtype=torch.float64)
11 gae_duplicate tensor(0.7292, dtype=torch.float64) tensor(-1.5168, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.1299, dtype=torch.float64)
10 gae_duplicate tensor(0.7133, dtype=torch.float64) tensor(-1.4829, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.1278, dtype=torch.float64)
9 gae_duplicate tensor(0.6984, dtype=torch.float64) tensor(-1.4534, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1887, dtype=torch.float64) delta_t tensor(-0.3497, dtype=torch.float64)
8 gae_duplicate tensor(0.2090, dtype=torch.float64) tensor(-0.4347, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8169, dtype=torch.float64) delta_t tensor(-1.6908, dtype=torch.float64)
7 gae_duplicate tensor(-1.5236, dtype=torch.float64) tensor(3.1705, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8802, dtype=torch.float64) delta_t tensor(1.2371, dtype=torch.float64)
6 gae_duplicate tensor(0.0182, dtype=torch.float64) tensor(-0.0379, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1322, dtype=torch.float64) delta_t tensor(0.7988, dtype=torch.float64)
5 gae_duplicate tensor(0.8134, dtype=torch.float64) tensor(-1.6911, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0758, dtype=torch.float64) delta_t tensor(0.3063, dtype=torch.float64)
4 gae_duplicate tensor(0.9571, dtype=torch.float64) tensor(-1.9906, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8281, dtype=torch.float64) delta_t tensor(-1.2530, dtype=torch.float64)
3 gae_duplicate tensor(-0.4873, dtype=torch.float64) tensor(1.0131, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7603, dtype=torch.float64) delta_t tensor(-0.3411, dtype=torch.float64)
2 gae_duplicate tensor(-0.7310, dtype=torch.float64) tensor(1.5196, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:15.640581130981445
value loss:11.75732421875
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.610406875610352 seconds
19 rew tensor(0.8113, dtype=torch.float64) delta_t tensor(-1.0886, dtype=torch.float64)
19 gae_duplicate tensor(-1.0886, dtype=torch.float64) tensor(2.2631, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8117, dtype=torch.float64) delta_t tensor(0.6026, dtype=torch.float64)
18 gae_duplicate tensor(-0.2682, dtype=torch.float64) tensor(0.5582, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8122, dtype=torch.float64) delta_t tensor(0.0453, dtype=torch.float64)
17 gae_duplicate tensor(-0.1693, dtype=torch.float64) tensor(0.3518, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(-0.3303, dtype=torch.float64)
16 gae_duplicate tensor(-0.4657, dtype=torch.float64) tensor(0.9682, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.7428, dtype=torch.float64)
15 gae_duplicate tensor(0.3703, dtype=torch.float64) tensor(-0.7705, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.3415, dtype=torch.float64)
14 gae_duplicate tensor(0.6377, dtype=torch.float64) tensor(-1.3263, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.3419, dtype=torch.float64)
13 gae_duplicate tensor(0.8521, dtype=torch.float64) tensor(-1.7723, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.3424, dtype=torch.float64)
12 gae_duplicate tensor(1.0241, dtype=torch.float64) tensor(-2.1300, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.3429, dtype=torch.float64)
11 gae_duplicate tensor(1.1622, dtype=torch.float64) tensor(-2.4172, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(-0.1589, dtype=torch.float64)
10 gae_duplicate tensor(0.7708, dtype=torch.float64) tensor(-1.6025, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(0.2434, dtype=torch.float64)
9 gae_duplicate tensor(0.8600, dtype=torch.float64) tensor(-1.7878, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0018, dtype=torch.float64) delta_t tensor(-0.5334, dtype=torch.float64)
8 gae_duplicate tensor(0.1546, dtype=torch.float64) tensor(-0.3216, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3757, dtype=torch.float64) delta_t tensor(-0.1687, dtype=torch.float64)
7 gae_duplicate tensor(-0.0450, dtype=torch.float64) tensor(0.0936, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2531, dtype=torch.float64) delta_t tensor(-0.4972, dtype=torch.float64)
6 gae_duplicate tensor(-0.5332, dtype=torch.float64) tensor(1.1092, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4479, dtype=torch.float64) delta_t tensor(3.3378, dtype=torch.float64)
5 gae_duplicate tensor(2.9112, dtype=torch.float64) tensor(-6.0523, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4495, dtype=torch.float64) delta_t tensor(-1.9041, dtype=torch.float64)
4 gae_duplicate tensor(0.4248, dtype=torch.float64) tensor(-0.8836, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7027, dtype=torch.float64) delta_t tensor(0.6311, dtype=torch.float64)
3 gae_duplicate tensor(0.9709, dtype=torch.float64) tensor(-2.0185, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5791, dtype=torch.float64) delta_t tensor(-1.7865, dtype=torch.float64)
2 gae_duplicate tensor(-1.0098, dtype=torch.float64) tensor(2.1013, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:80.70230865478516
value loss:26.150535583496094
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.262963056564331 seconds
19 rew tensor(0.8113, dtype=torch.float64) delta_t tensor(-0.9954, dtype=torch.float64)
19 gae_duplicate tensor(-0.9954, dtype=torch.float64) tensor(2.0703, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8117, dtype=torch.float64) delta_t tensor(0.4628, dtype=torch.float64)
18 gae_duplicate tensor(-0.3335, dtype=torch.float64) tensor(0.6933, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8122, dtype=torch.float64) delta_t tensor(0.2016, dtype=torch.float64)
17 gae_duplicate tensor(-0.0652, dtype=torch.float64) tensor(0.1355, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8126, dtype=torch.float64) delta_t tensor(0.1331, dtype=torch.float64)
16 gae_duplicate tensor(0.0810, dtype=torch.float64) tensor(-0.1684, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(-0.2488, dtype=torch.float64)
15 gae_duplicate tensor(-0.1841, dtype=torch.float64) tensor(0.3828, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.2189, dtype=torch.float64)
14 gae_duplicate tensor(0.0717, dtype=torch.float64) tensor(-0.1492, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(0.2211, dtype=torch.float64)
13 gae_duplicate tensor(0.2784, dtype=torch.float64) tensor(-0.5791, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.2382, dtype=torch.float64)
12 gae_duplicate tensor(0.4609, dtype=torch.float64) tensor(-0.9586, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.4008, dtype=torch.float64)
11 gae_duplicate tensor(0.7695, dtype=torch.float64) tensor(-1.6013, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(-0.0252, dtype=torch.float64)
10 gae_duplicate tensor(0.5904, dtype=torch.float64) tensor(-1.2281, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4371, dtype=torch.float64) delta_t tensor(-0.1718, dtype=torch.float64)
9 gae_duplicate tensor(0.3006, dtype=torch.float64) tensor(-0.6252, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1849, dtype=torch.float64) delta_t tensor(-0.4973, dtype=torch.float64)
8 gae_duplicate tensor(-0.2568, dtype=torch.float64) tensor(0.5339, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0588, dtype=torch.float64) delta_t tensor(-0.4393, dtype=torch.float64)
7 gae_duplicate tensor(-0.6447, dtype=torch.float64) tensor(1.3409, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3196, dtype=torch.float64) delta_t tensor(1.2337, dtype=torch.float64)
6 gae_duplicate tensor(0.7180, dtype=torch.float64) tensor(-1.4927, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6350, dtype=torch.float64) delta_t tensor(3.2208, dtype=torch.float64)
5 gae_duplicate tensor(3.7952, dtype=torch.float64) tensor(-7.8938, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3286, dtype=torch.float64) delta_t tensor(-0.4734, dtype=torch.float64)
4 gae_duplicate tensor(2.5627, dtype=torch.float64) tensor(-5.3278, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0777, dtype=torch.float64) delta_t tensor(-0.3795, dtype=torch.float64)
3 gae_duplicate tensor(1.6707, dtype=torch.float64) tensor(-3.4749, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9524, dtype=torch.float64) delta_t tensor(-0.3049, dtype=torch.float64)
2 gae_duplicate tensor(1.0316, dtype=torch.float64) tensor(-2.1468, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:121.81159973144531
value loss:42.444618225097656
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.497305870056152 seconds
19 rew tensor(0.8108, dtype=torch.float64) delta_t tensor(-0.0533, dtype=torch.float64)
19 gae_duplicate tensor(-0.0533, dtype=torch.float64) tensor(0.1109, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8112, dtype=torch.float64) delta_t tensor(0.6497, dtype=torch.float64)
18 gae_duplicate tensor(0.6071, dtype=torch.float64) tensor(-1.2627, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8117, dtype=torch.float64) delta_t tensor(-0.3780, dtype=torch.float64)
17 gae_duplicate tensor(0.1076, dtype=torch.float64) tensor(-0.2240, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(0.0129, dtype=torch.float64)
16 gae_duplicate tensor(0.0990, dtype=torch.float64) tensor(-0.2059, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8126, dtype=torch.float64) delta_t tensor(-0.4205, dtype=torch.float64)
15 gae_duplicate tensor(-0.3413, dtype=torch.float64) tensor(0.7099, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(0.1744, dtype=torch.float64)
14 gae_duplicate tensor(-0.0987, dtype=torch.float64) tensor(0.2050, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.1630, dtype=torch.float64)
13 gae_duplicate tensor(0.0841, dtype=torch.float64) tensor(-0.1749, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(0.1834, dtype=torch.float64)
12 gae_duplicate tensor(0.2506, dtype=torch.float64) tensor(-0.5208, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.3347, dtype=torch.float64)
11 gae_duplicate tensor(0.5352, dtype=torch.float64) tensor(-1.1138, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.1751, dtype=torch.float64)
10 gae_duplicate tensor(0.6033, dtype=torch.float64) tensor(-1.2554, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.2405, dtype=torch.float64)
9 gae_duplicate tensor(0.7231, dtype=torch.float64) tensor(-1.5041, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1223, dtype=torch.float64) delta_t tensor(-0.1679, dtype=torch.float64)
8 gae_duplicate tensor(0.4106, dtype=torch.float64) tensor(-0.8536, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0667, dtype=torch.float64) delta_t tensor(-1.0676, dtype=torch.float64)
7 gae_duplicate tensor(-0.7391, dtype=torch.float64) tensor(1.5380, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3898, dtype=torch.float64) delta_t tensor(0.6741, dtype=torch.float64)
6 gae_duplicate tensor(0.0828, dtype=torch.float64) tensor(-0.1720, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6433, dtype=torch.float64) delta_t tensor(1.6495, dtype=torch.float64)
5 gae_duplicate tensor(1.7157, dtype=torch.float64) tensor(-3.5686, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2129, dtype=torch.float64) delta_t tensor(-2.8809, dtype=torch.float64)
4 gae_duplicate tensor(-1.5083, dtype=torch.float64) tensor(3.1357, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8385, dtype=torch.float64) delta_t tensor(0.5471, dtype=torch.float64)
3 gae_duplicate tensor(-0.6595, dtype=torch.float64) tensor(1.3711, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7148, dtype=torch.float64) delta_t tensor(-1.5358, dtype=torch.float64)
2 gae_duplicate tensor(-2.0634, dtype=torch.float64) tensor(4.2896, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4.148890972137451
value loss:18.592872619628906
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.538570880889893 seconds
19 rew tensor(0.8107, dtype=torch.float64) delta_t tensor(-0.3196, dtype=torch.float64)
19 gae_duplicate tensor(-0.3196, dtype=torch.float64) tensor(0.6648, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8112, dtype=torch.float64) delta_t tensor(0.3313, dtype=torch.float64)
18 gae_duplicate tensor(0.0756, dtype=torch.float64) tensor(-0.1571, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(-0.0934, dtype=torch.float64)
17 gae_duplicate tensor(-0.0329, dtype=torch.float64) tensor(0.0685, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(-0.3020, dtype=torch.float64)
16 gae_duplicate tensor(-0.3283, dtype=torch.float64) tensor(0.6829, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8125, dtype=torch.float64) delta_t tensor(-0.1968, dtype=torch.float64)
15 gae_duplicate tensor(-0.4595, dtype=torch.float64) tensor(0.9557, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(0.1890, dtype=torch.float64)
14 gae_duplicate tensor(-0.1786, dtype=torch.float64) tensor(0.3716, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(0.1977, dtype=torch.float64)
13 gae_duplicate tensor(0.0548, dtype=torch.float64) tensor(-0.1141, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.2072, dtype=torch.float64)
12 gae_duplicate tensor(0.2511, dtype=torch.float64) tensor(-0.5223, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.2954, dtype=torch.float64)
11 gae_duplicate tensor(0.4963, dtype=torch.float64) tensor(-1.0319, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.1367, dtype=torch.float64)
10 gae_duplicate tensor(0.5338, dtype=torch.float64) tensor(-1.1103, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4999, dtype=torch.float64) delta_t tensor(-0.0890, dtype=torch.float64)
9 gae_duplicate tensor(0.3380, dtype=torch.float64) tensor(-0.7031, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2480, dtype=torch.float64) delta_t tensor(-0.2809, dtype=torch.float64)
8 gae_duplicate tensor(-0.0105, dtype=torch.float64) tensor(0.0217, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0590, dtype=torch.float64) delta_t tensor(-0.8781, dtype=torch.float64)
7 gae_duplicate tensor(-0.8865, dtype=torch.float64) tensor(1.8439, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0121, dtype=torch.float64) delta_t tensor(1.0025, dtype=torch.float64)
6 gae_duplicate tensor(0.2933, dtype=torch.float64) tensor(-0.6098, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2649, dtype=torch.float64) delta_t tensor(2.1024, dtype=torch.float64)
5 gae_duplicate tensor(2.3370, dtype=torch.float64) tensor(-4.8586, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9592, dtype=torch.float64) delta_t tensor(-1.2932, dtype=torch.float64)
4 gae_duplicate tensor(0.5765, dtype=torch.float64) tensor(-1.1990, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7101, dtype=torch.float64) delta_t tensor(-0.4439, dtype=torch.float64)
3 gae_duplicate tensor(0.0173, dtype=torch.float64) tensor(-0.0360, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5861, dtype=torch.float64) delta_t tensor(-1.2065, dtype=torch.float64)
2 gae_duplicate tensor(-1.1926, dtype=torch.float64) tensor(2.4794, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:18.39838409423828
value loss:13.89034652709961
entropies:37.42993927001953
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.7299)
ToM Target loss= tensor(307.1904)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.423378944396973 seconds
19 rew tensor(0.8114, dtype=torch.float64) delta_t tensor(-0.4172, dtype=torch.float64)
19 gae_duplicate tensor(-0.4172, dtype=torch.float64) tensor(0.8677, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(0.0920, dtype=torch.float64)
18 gae_duplicate tensor(-0.2417, dtype=torch.float64) tensor(0.5028, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8122, dtype=torch.float64) delta_t tensor(-0.3171, dtype=torch.float64)
17 gae_duplicate tensor(-0.5104, dtype=torch.float64) tensor(1.0612, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(-0.2626, dtype=torch.float64)
16 gae_duplicate tensor(-0.6709, dtype=torch.float64) tensor(1.3941, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.1570, dtype=torch.float64)
15 gae_duplicate tensor(-0.3798, dtype=torch.float64) tensor(0.7895, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.1914, dtype=torch.float64)
14 gae_duplicate tensor(-0.1124, dtype=torch.float64) tensor(0.2337, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(0.2263, dtype=torch.float64)
13 gae_duplicate tensor(0.1363, dtype=torch.float64) tensor(-0.2834, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.1992, dtype=torch.float64)
12 gae_duplicate tensor(0.3083, dtype=torch.float64) tensor(-0.6409, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.1975, dtype=torch.float64)
11 gae_duplicate tensor(0.4441, dtype=torch.float64) tensor(-0.9227, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.1067, dtype=torch.float64)
10 gae_duplicate tensor(0.4619, dtype=torch.float64) tensor(-0.9603, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3109, dtype=torch.float64) delta_t tensor(-0.3622, dtype=torch.float64)
9 gae_duplicate tensor(0.0073, dtype=torch.float64) tensor(-0.0152, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0586, dtype=torch.float64) delta_t tensor(-0.4623, dtype=torch.float64)
8 gae_duplicate tensor(-0.4565, dtype=torch.float64) tensor(0.9494, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1937, dtype=torch.float64) delta_t tensor(-1.0867, dtype=torch.float64)
7 gae_duplicate tensor(-1.4518, dtype=torch.float64) tensor(3.0184, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8874, dtype=torch.float64) delta_t tensor(1.0706, dtype=torch.float64)
6 gae_duplicate tensor(-0.0908, dtype=torch.float64) tensor(0.1887, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1402, dtype=torch.float64) delta_t tensor(2.2285, dtype=torch.float64)
5 gae_duplicate tensor(2.1558, dtype=torch.float64) tensor(-4.4818, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8347, dtype=torch.float64) delta_t tensor(-0.9455, dtype=torch.float64)
4 gae_duplicate tensor(0.7791, dtype=torch.float64) tensor(-1.6205, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5849, dtype=torch.float64) delta_t tensor(-0.6534, dtype=torch.float64)
3 gae_duplicate tensor(-0.0301, dtype=torch.float64) tensor(0.0626, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3342, dtype=torch.float64) delta_t tensor(-0.6782, dtype=torch.float64)
2 gae_duplicate tensor(-0.7023, dtype=torch.float64) tensor(1.4614, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-10.751874923706055
value loss:14.545969009399414
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.539195775985718 seconds
19 rew tensor(0.6871, dtype=torch.float64) delta_t tensor(-0.5261, dtype=torch.float64)
19 gae_duplicate tensor(-0.5261, dtype=torch.float64) tensor(1.0932, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6242, dtype=torch.float64) delta_t tensor(0.1166, dtype=torch.float64)
18 gae_duplicate tensor(-0.3043, dtype=torch.float64) tensor(0.6329, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4349, dtype=torch.float64) delta_t tensor(-0.8398, dtype=torch.float64)
17 gae_duplicate tensor(-1.0832, dtype=torch.float64) tensor(2.2508, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.0704, dtype=torch.float64) delta_t tensor(-1.2532, dtype=torch.float64)
16 gae_duplicate tensor(-2.1197, dtype=torch.float64) tensor(4.4045, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7652, dtype=torch.float64) delta_t tensor(-1.2474, dtype=torch.float64)
15 gae_duplicate tensor(-2.9432, dtype=torch.float64) tensor(6.1216, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(0.2130, dtype=torch.float64)
14 gae_duplicate tensor(-2.1415, dtype=torch.float64) tensor(4.4542, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(0.2135, dtype=torch.float64)
13 gae_duplicate tensor(-1.4997, dtype=torch.float64) tensor(3.1193, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.2139, dtype=torch.float64)
12 gae_duplicate tensor(-0.9858, dtype=torch.float64) tensor(2.0505, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.2144, dtype=torch.float64)
11 gae_duplicate tensor(-0.5743, dtype=torch.float64) tensor(1.1940, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.0720, dtype=torch.float64)
10 gae_duplicate tensor(-0.3875, dtype=torch.float64) tensor(0.8060, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6261, dtype=torch.float64) delta_t tensor(0.0099, dtype=torch.float64)
9 gae_duplicate tensor(-0.3001, dtype=torch.float64) tensor(0.6235, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3739, dtype=torch.float64) delta_t tensor(-0.3503, dtype=torch.float64)
8 gae_duplicate tensor(-0.5903, dtype=torch.float64) tensor(1.2272, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0586, dtype=torch.float64) delta_t tensor(-0.6421, dtype=torch.float64)
7 gae_duplicate tensor(-1.1144, dtype=torch.float64) tensor(2.3179, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7612, dtype=torch.float64) delta_t tensor(1.0376, dtype=torch.float64)
6 gae_duplicate tensor(0.1461, dtype=torch.float64) tensor(-0.3039, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3922, dtype=torch.float64) delta_t tensor(1.8479, dtype=torch.float64)
5 gae_duplicate tensor(1.9647, dtype=torch.float64) tensor(-4.0866, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8351, dtype=torch.float64) delta_t tensor(-2.3557, dtype=torch.float64)
4 gae_duplicate tensor(-0.7839, dtype=torch.float64) tensor(1.6296, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8378, dtype=torch.float64) delta_t tensor(0.4891, dtype=torch.float64)
3 gae_duplicate tensor(-0.1380, dtype=torch.float64) tensor(0.2869, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7141, dtype=torch.float64) delta_t tensor(-1.3113, dtype=torch.float64)
2 gae_duplicate tensor(-1.4217, dtype=torch.float64) tensor(2.9555, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-185.7859649658203
value loss:46.802574157714844
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4970433712005615 seconds
19 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(-0.3088, dtype=torch.float64)
19 gae_duplicate tensor(-0.3088, dtype=torch.float64) tensor(0.6420, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.4164, dtype=torch.float64)
18 gae_duplicate tensor(0.1694, dtype=torch.float64) tensor(-0.3521, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(-0.1749, dtype=torch.float64)
17 gae_duplicate tensor(-0.0394, dtype=torch.float64) tensor(0.0819, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(-0.1293, dtype=torch.float64)
16 gae_duplicate tensor(-0.1608, dtype=torch.float64) tensor(0.3346, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(-0.3646, dtype=torch.float64)
15 gae_duplicate tensor(-0.4933, dtype=torch.float64) tensor(1.0259, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(0.1823, dtype=torch.float64)
14 gae_duplicate tensor(-0.2123, dtype=torch.float64) tensor(0.4416, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.1907, dtype=torch.float64)
13 gae_duplicate tensor(0.0208, dtype=torch.float64) tensor(-0.0434, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(0.1999, dtype=torch.float64)
12 gae_duplicate tensor(0.2166, dtype=torch.float64) tensor(-0.4508, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8171, dtype=torch.float64) delta_t tensor(0.2851, dtype=torch.float64)
11 gae_duplicate tensor(0.4584, dtype=torch.float64) tensor(-0.9530, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8176, dtype=torch.float64) delta_t tensor(0.1285, dtype=torch.float64)
10 gae_duplicate tensor(0.4952, dtype=torch.float64) tensor(-1.0296, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4390, dtype=torch.float64) delta_t tensor(-0.1708, dtype=torch.float64)
9 gae_duplicate tensor(0.2254, dtype=torch.float64) tensor(-0.4689, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2497, dtype=torch.float64) delta_t tensor(-0.2287, dtype=torch.float64)
8 gae_duplicate tensor(-0.0484, dtype=torch.float64) tensor(0.1006, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0660, dtype=torch.float64) delta_t tensor(-1.0054, dtype=torch.float64)
7 gae_duplicate tensor(-1.0441, dtype=torch.float64) tensor(2.1706, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0127, dtype=torch.float64) delta_t tensor(0.9693, dtype=torch.float64)
6 gae_duplicate tensor(0.1340, dtype=torch.float64) tensor(-0.2787, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2659, dtype=torch.float64) delta_t tensor(1.9604, dtype=torch.float64)
5 gae_duplicate tensor(2.0676, dtype=torch.float64) tensor(-4.3005, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9614, dtype=torch.float64) delta_t tensor(-1.1069, dtype=torch.float64)
4 gae_duplicate tensor(0.5472, dtype=torch.float64) tensor(-1.1381, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7117, dtype=torch.float64) delta_t tensor(-0.6599, dtype=torch.float64)
3 gae_duplicate tensor(-0.2222, dtype=torch.float64) tensor(0.4616, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4610, dtype=torch.float64) delta_t tensor(-1.0182, dtype=torch.float64)
2 gae_duplicate tensor(-1.1959, dtype=torch.float64) tensor(2.4850, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:6.504305839538574
value loss:12.236835479736328
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.517887830734253 seconds
19 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(-0.7351, dtype=torch.float64)
19 gae_duplicate tensor(-0.7351, dtype=torch.float64) tensor(1.5282, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.4481, dtype=torch.float64)
18 gae_duplicate tensor(-0.1400, dtype=torch.float64) tensor(0.2911, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(-0.0686, dtype=torch.float64)
17 gae_duplicate tensor(-0.1806, dtype=torch.float64) tensor(0.3754, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(-0.6078, dtype=torch.float64)
16 gae_duplicate tensor(-0.7523, dtype=torch.float64) tensor(1.5639, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.5745, dtype=torch.float64)
15 gae_duplicate tensor(-0.0274, dtype=torch.float64) tensor(0.0568, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.2624, dtype=torch.float64)
14 gae_duplicate tensor(0.2405, dtype=torch.float64) tensor(-0.5003, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.2628, dtype=torch.float64)
13 gae_duplicate tensor(0.4552, dtype=torch.float64) tensor(-0.9473, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.2633, dtype=torch.float64)
12 gae_duplicate tensor(0.6275, dtype=torch.float64) tensor(-1.3045, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.2637, dtype=torch.float64)
11 gae_duplicate tensor(0.7657, dtype=torch.float64) tensor(-1.5918, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8169, dtype=torch.float64) delta_t tensor(-0.1235, dtype=torch.float64)
10 gae_duplicate tensor(0.4890, dtype=torch.float64) tensor(-1.0171, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8174, dtype=torch.float64) delta_t tensor(0.1966, dtype=torch.float64)
9 gae_duplicate tensor(0.5878, dtype=torch.float64) tensor(-1.2220, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1299, dtype=torch.float64) delta_t tensor(-0.6989, dtype=torch.float64)
8 gae_duplicate tensor(-0.2287, dtype=torch.float64) tensor(0.4757, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2490, dtype=torch.float64) delta_t tensor(-0.0840, dtype=torch.float64)
7 gae_duplicate tensor(-0.2669, dtype=torch.float64) tensor(0.5555, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3823, dtype=torch.float64) delta_t tensor(1.1534, dtype=torch.float64)
6 gae_duplicate tensor(0.9399, dtype=torch.float64) tensor(-1.9548, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5817, dtype=torch.float64) delta_t tensor(-0.2006, dtype=torch.float64)
5 gae_duplicate tensor(0.5513, dtype=torch.float64) tensor(-1.1467, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5835, dtype=torch.float64) delta_t tensor(-0.7887, dtype=torch.float64)
4 gae_duplicate tensor(-0.3477, dtype=torch.float64) tensor(0.7228, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4589, dtype=torch.float64) delta_t tensor(0.9948, dtype=torch.float64)
3 gae_duplicate tensor(0.7167, dtype=torch.float64) tensor(-1.4907, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-2.0924, dtype=torch.float64) delta_t tensor(-1.8922, dtype=torch.float64)
2 gae_duplicate tensor(-1.3189, dtype=torch.float64) tensor(2.7419, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:16.0604248046875
value loss:10.010674476623535
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.385569095611572 seconds
19 rew tensor(0.8126, dtype=torch.float64) delta_t tensor(-0.1025, dtype=torch.float64)
19 gae_duplicate tensor(-0.1025, dtype=torch.float64) tensor(0.2131, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(0.5166, dtype=torch.float64)
18 gae_duplicate tensor(0.4346, dtype=torch.float64) tensor(-0.9039, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.2701, dtype=torch.float64)
17 gae_duplicate tensor(0.6178, dtype=torch.float64) tensor(-1.2849, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(-0.0966, dtype=torch.float64)
16 gae_duplicate tensor(0.3976, dtype=torch.float64) tensor(-0.8270, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(-0.5384, dtype=torch.float64)
15 gae_duplicate tensor(-0.2203, dtype=torch.float64) tensor(0.4582, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.2193, dtype=torch.float64)
14 gae_duplicate tensor(0.0431, dtype=torch.float64) tensor(-0.0895, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.2224, dtype=torch.float64)
13 gae_duplicate tensor(0.2569, dtype=torch.float64) tensor(-0.5340, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.2357, dtype=torch.float64)
12 gae_duplicate tensor(0.4412, dtype=torch.float64) tensor(-0.9177, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(0.2960, dtype=torch.float64)
11 gae_duplicate tensor(0.6490, dtype=torch.float64) tensor(-1.3505, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(0.2162, dtype=torch.float64)
10 gae_duplicate tensor(0.7354, dtype=torch.float64) tensor(-1.5303, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6272, dtype=torch.float64) delta_t tensor(0.0720, dtype=torch.float64)
9 gae_duplicate tensor(0.6603, dtype=torch.float64) tensor(-1.3726, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3746, dtype=torch.float64) delta_t tensor(-0.1086, dtype=torch.float64)
8 gae_duplicate tensor(0.4196, dtype=torch.float64) tensor(-0.8732, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1852, dtype=torch.float64) delta_t tensor(-0.7767, dtype=torch.float64)
7 gae_duplicate tensor(-0.4410, dtype=torch.float64) tensor(0.9168, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0151, dtype=torch.float64) delta_t tensor(0.9208, dtype=torch.float64)
6 gae_duplicate tensor(0.5680, dtype=torch.float64) tensor(-1.1804, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2685, dtype=torch.float64) delta_t tensor(1.8934, dtype=torch.float64)
5 gae_duplicate tensor(2.3479, dtype=torch.float64) tensor(-4.8811, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8382, dtype=torch.float64) delta_t tensor(-1.7944, dtype=torch.float64)
4 gae_duplicate tensor(0.0839, dtype=torch.float64) tensor(-0.1746, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5878, dtype=torch.float64) delta_t tensor(0.1360, dtype=torch.float64)
3 gae_duplicate tensor(0.2031, dtype=torch.float64) tensor(-0.4225, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4630, dtype=torch.float64) delta_t tensor(-1.3618, dtype=torch.float64)
2 gae_duplicate tensor(-1.1993, dtype=torch.float64) tensor(2.4921, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:72.45060729980469
value loss:15.210695266723633
entropies:37.42993927001953
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.9381)
ToM Target loss= tensor(307.0247)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.221441030502319 seconds
19 rew tensor(0.8125, dtype=torch.float64) delta_t tensor(-0.6763, dtype=torch.float64)
19 gae_duplicate tensor(-0.6763, dtype=torch.float64) tensor(1.4061, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(0.1360, dtype=torch.float64)
18 gae_duplicate tensor(-0.4050, dtype=torch.float64) tensor(0.8420, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(0.4995, dtype=torch.float64)
17 gae_duplicate tensor(0.1755, dtype=torch.float64) tensor(-0.3650, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(-0.6436, dtype=torch.float64)
16 gae_duplicate tensor(-0.5032, dtype=torch.float64) tensor(1.0466, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.0830, dtype=torch.float64)
15 gae_duplicate tensor(-0.3195, dtype=torch.float64) tensor(0.6640, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.2037, dtype=torch.float64)
14 gae_duplicate tensor(-0.0519, dtype=torch.float64) tensor(0.1078, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.2210, dtype=torch.float64)
13 gae_duplicate tensor(0.1795, dtype=torch.float64) tensor(-0.3733, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.2320, dtype=torch.float64)
12 gae_duplicate tensor(0.3756, dtype=torch.float64) tensor(-0.7809, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(0.2411, dtype=torch.float64)
11 gae_duplicate tensor(0.5415, dtype=torch.float64) tensor(-1.1254, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.1947, dtype=torch.float64)
10 gae_duplicate tensor(0.6280, dtype=torch.float64) tensor(-1.3049, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5001, dtype=torch.float64) delta_t tensor(-0.0432, dtype=torch.float64)
9 gae_duplicate tensor(0.4592, dtype=torch.float64) tensor(-0.9551, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3737, dtype=torch.float64) delta_t tensor(-0.1962, dtype=torch.float64)
8 gae_duplicate tensor(0.1712, dtype=torch.float64) tensor(-0.3560, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0574, dtype=torch.float64) delta_t tensor(-0.7882, dtype=torch.float64)
7 gae_duplicate tensor(-0.6513, dtype=torch.float64) tensor(1.3534, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7651, dtype=torch.float64) delta_t tensor(-0.1731, dtype=torch.float64)
6 gae_duplicate tensor(-0.6941, dtype=torch.float64) tensor(1.4444, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0185, dtype=torch.float64) delta_t tensor(3.0996, dtype=torch.float64)
5 gae_duplicate tensor(2.5443, dtype=torch.float64) tensor(-5.2895, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5885, dtype=torch.float64) delta_t tensor(-0.6631, dtype=torch.float64)
4 gae_duplicate tensor(1.3723, dtype=torch.float64) tensor(-2.8517, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4637, dtype=torch.float64) delta_t tensor(-0.5301, dtype=torch.float64)
3 gae_duplicate tensor(0.5677, dtype=torch.float64) tensor(-1.1803, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2118, dtype=torch.float64) delta_t tensor(-0.7834, dtype=torch.float64)
2 gae_duplicate tensor(-0.3293, dtype=torch.float64) tensor(0.6845, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:41.077728271484375
value loss:17.706844329833984
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.353653907775879 seconds
19 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(-0.3174, dtype=torch.float64)
19 gae_duplicate tensor(-0.3174, dtype=torch.float64) tensor(0.6601, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(0.0310, dtype=torch.float64)
18 gae_duplicate tensor(-0.2229, dtype=torch.float64) tensor(0.4635, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.3403, dtype=torch.float64)
17 gae_duplicate tensor(0.1619, dtype=torch.float64) tensor(-0.3366, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(-0.6411, dtype=torch.float64)
16 gae_duplicate tensor(-0.5116, dtype=torch.float64) tensor(1.0641, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.2575, dtype=torch.float64)
15 gae_duplicate tensor(-0.1518, dtype=torch.float64) tensor(0.3156, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.2374, dtype=torch.float64)
14 gae_duplicate tensor(0.1160, dtype=torch.float64) tensor(-0.2410, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.2423, dtype=torch.float64)
13 gae_duplicate tensor(0.3351, dtype=torch.float64) tensor(-0.6970, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.2441, dtype=torch.float64)
12 gae_duplicate tensor(0.5121, dtype=torch.float64) tensor(-1.0652, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.4445, dtype=torch.float64)
11 gae_duplicate tensor(0.8542, dtype=torch.float64) tensor(-1.7759, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.0411, dtype=torch.float64)
10 gae_duplicate tensor(0.7245, dtype=torch.float64) tensor(-1.5054, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5766, dtype=torch.float64) delta_t tensor(-1.1632, dtype=torch.float64)
9 gae_duplicate tensor(-0.5836, dtype=torch.float64) tensor(1.2140, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0069, dtype=torch.float64) delta_t tensor(-0.4258, dtype=torch.float64)
8 gae_duplicate tensor(-0.8927, dtype=torch.float64) tensor(1.8567, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1830, dtype=torch.float64) delta_t tensor(-0.2454, dtype=torch.float64)
7 gae_duplicate tensor(-0.9596, dtype=torch.float64) tensor(1.9948, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5764, dtype=torch.float64) delta_t tensor(1.0287, dtype=torch.float64)
6 gae_duplicate tensor(0.2611, dtype=torch.float64) tensor(-0.5430, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7156, dtype=torch.float64) delta_t tensor(0.1489, dtype=torch.float64)
5 gae_duplicate tensor(0.3577, dtype=torch.float64) tensor(-0.7440, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7177, dtype=torch.float64) delta_t tensor(-1.4327, dtype=torch.float64)
4 gae_duplicate tensor(-1.1465, dtype=torch.float64) tensor(2.3836, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4664, dtype=torch.float64) delta_t tensor(0.8552, dtype=torch.float64)
3 gae_duplicate tensor(-0.0620, dtype=torch.float64) tensor(0.1290, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.8481, dtype=torch.float64) delta_t tensor(-2.0520, dtype=torch.float64)
2 gae_duplicate tensor(-2.1016, dtype=torch.float64) tensor(4.3692, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-46.3764762878418
value loss:15.140204429626465
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.600564956665039 seconds
19 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(-0.2750, dtype=torch.float64)
19 gae_duplicate tensor(-0.2750, dtype=torch.float64) tensor(0.5718, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.0683, dtype=torch.float64)
18 gae_duplicate tensor(-0.1518, dtype=torch.float64) tensor(0.3154, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.7674, dtype=torch.float64)
17 gae_duplicate tensor(0.6460, dtype=torch.float64) tensor(-1.3436, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.0970, dtype=torch.float64)
16 gae_duplicate tensor(0.6138, dtype=torch.float64) tensor(-1.2767, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(-0.6580, dtype=torch.float64)
15 gae_duplicate tensor(-0.1669, dtype=torch.float64) tensor(0.3471, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.2142, dtype=torch.float64)
14 gae_duplicate tensor(0.0807, dtype=torch.float64) tensor(-0.1677, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.1932, dtype=torch.float64)
13 gae_duplicate tensor(0.2578, dtype=torch.float64) tensor(-0.5359, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(0.1915, dtype=torch.float64)
12 gae_duplicate tensor(0.3977, dtype=torch.float64) tensor(-0.8273, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(0.2765, dtype=torch.float64)
11 gae_duplicate tensor(0.5947, dtype=torch.float64) tensor(-1.2374, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(0.1146, dtype=torch.float64)
10 gae_duplicate tensor(0.5904, dtype=torch.float64) tensor(-1.2268, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3093, dtype=torch.float64) delta_t tensor(-0.3445, dtype=torch.float64)
9 gae_duplicate tensor(0.1278, dtype=torch.float64) tensor(-0.2658, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0555, dtype=torch.float64) delta_t tensor(-0.5810, dtype=torch.float64)
8 gae_duplicate tensor(-0.4787, dtype=torch.float64) tensor(0.9961, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0714, dtype=torch.float64) delta_t tensor(-0.6651, dtype=torch.float64)
7 gae_duplicate tensor(-1.0481, dtype=torch.float64) tensor(2.1809, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3886, dtype=torch.float64) delta_t tensor(-0.1332, dtype=torch.float64)
6 gae_duplicate tensor(-0.9716, dtype=torch.float64) tensor(2.0209, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7693, dtype=torch.float64) delta_t tensor(3.6559, dtype=torch.float64)
5 gae_duplicate tensor(2.8786, dtype=torch.float64) tensor(-5.9872, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3404, dtype=torch.float64) delta_t tensor(-0.5792, dtype=torch.float64)
4 gae_duplicate tensor(1.7237, dtype=torch.float64) tensor(-3.5836, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0878, dtype=torch.float64) delta_t tensor(-0.3786, dtype=torch.float64)
3 gae_duplicate tensor(1.0004, dtype=torch.float64) tensor(-2.0797, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9617, dtype=torch.float64) delta_t tensor(-0.2143, dtype=torch.float64)
2 gae_duplicate tensor(0.5860, dtype=torch.float64) tensor(-1.2183, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:78.78374481201172
value loss:25.11551284790039
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.394555330276489 seconds
19 rew tensor(0.8126, dtype=torch.float64) delta_t tensor(0.0449, dtype=torch.float64)
19 gae_duplicate tensor(0.0449, dtype=torch.float64) tensor(-0.0933, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(0.6699, dtype=torch.float64)
18 gae_duplicate tensor(0.7058, dtype=torch.float64) tensor(-1.4680, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(-0.5484, dtype=torch.float64)
17 gae_duplicate tensor(0.0163, dtype=torch.float64) tensor(-0.0339, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.2406, dtype=torch.float64)
16 gae_duplicate tensor(0.2537, dtype=torch.float64) tensor(-0.5276, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(-0.6264, dtype=torch.float64)
15 gae_duplicate tensor(-0.4235, dtype=torch.float64) tensor(0.8804, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.1829, dtype=torch.float64)
14 gae_duplicate tensor(-0.1558, dtype=torch.float64) tensor(0.3240, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.2098, dtype=torch.float64)
13 gae_duplicate tensor(0.0852, dtype=torch.float64) tensor(-0.1770, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.1891, dtype=torch.float64)
12 gae_duplicate tensor(0.2572, dtype=torch.float64) tensor(-0.5347, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(0.2206, dtype=torch.float64)
11 gae_duplicate tensor(0.4263, dtype=torch.float64) tensor(-0.8867, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.8398, dtype=torch.float64)
10 gae_duplicate tensor(1.1809, dtype=torch.float64) tensor(-2.4562, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(-0.2660, dtype=torch.float64)
9 gae_duplicate tensor(0.6788, dtype=torch.float64) tensor(-1.4118, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1199, dtype=torch.float64) delta_t tensor(0.0440, dtype=torch.float64)
8 gae_duplicate tensor(0.5870, dtype=torch.float64) tensor(-1.2203, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3237, dtype=torch.float64) delta_t tensor(-1.2982, dtype=torch.float64)
7 gae_duplicate tensor(-0.8286, dtype=torch.float64) tensor(1.7235, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5274, dtype=torch.float64) delta_t tensor(0.4761, dtype=torch.float64)
6 gae_duplicate tensor(-0.1868, dtype=torch.float64) tensor(0.3883, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7825, dtype=torch.float64) delta_t tensor(0.9479, dtype=torch.float64)
5 gae_duplicate tensor(0.7985, dtype=torch.float64) tensor(-1.6601, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3554, dtype=torch.float64) delta_t tensor(-2.9408, dtype=torch.float64)
4 gae_duplicate tensor(-2.3020, dtype=torch.float64) tensor(4.7878, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5980, dtype=torch.float64) delta_t tensor(0.7285, dtype=torch.float64)
3 gae_duplicate tensor(-1.1130, dtype=torch.float64) tensor(2.3130, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.9810, dtype=torch.float64) delta_t tensor(-1.7464, dtype=torch.float64)
2 gae_duplicate tensor(-2.6369, dtype=torch.float64) tensor(5.4796, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-33.68513107299805
value loss:27.110069274902344
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.409330129623413 seconds
19 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(-0.0774, dtype=torch.float64)
19 gae_duplicate tensor(-0.0774, dtype=torch.float64) tensor(0.1609, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(0.5327, dtype=torch.float64)
18 gae_duplicate tensor(0.4708, dtype=torch.float64) tensor(-0.9788, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.1678, dtype=torch.float64)
17 gae_duplicate tensor(0.5444, dtype=torch.float64) tensor(-1.1319, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(-1.1434, dtype=torch.float64)
16 gae_duplicate tensor(-0.7079, dtype=torch.float64) tensor(1.4717, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.2696, dtype=torch.float64)
15 gae_duplicate tensor(-0.2967, dtype=torch.float64) tensor(0.6172, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.2083, dtype=torch.float64)
14 gae_duplicate tensor(-0.0290, dtype=torch.float64) tensor(0.0604, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.2087, dtype=torch.float64)
13 gae_duplicate tensor(0.1855, dtype=torch.float64) tensor(-0.3858, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.2091, dtype=torch.float64)
12 gae_duplicate tensor(0.3575, dtype=torch.float64) tensor(-0.7436, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(0.2095, dtype=torch.float64)
11 gae_duplicate tensor(0.4956, dtype=torch.float64) tensor(-1.0303, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(0.1245, dtype=torch.float64)
10 gae_duplicate tensor(0.5210, dtype=torch.float64) tensor(-1.0841, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4366, dtype=torch.float64) delta_t tensor(-0.2029, dtype=torch.float64)
9 gae_duplicate tensor(0.2139, dtype=torch.float64) tensor(-0.4449, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1833, dtype=torch.float64) delta_t tensor(-0.3830, dtype=torch.float64)
8 gae_duplicate tensor(-0.2119, dtype=torch.float64) tensor(0.4407, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1967, dtype=torch.float64) delta_t tensor(-0.9140, dtype=torch.float64)
7 gae_duplicate tensor(-1.0836, dtype=torch.float64) tensor(2.2517, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8933, dtype=torch.float64) delta_t tensor(0.8241, dtype=torch.float64)
6 gae_duplicate tensor(-0.0428, dtype=torch.float64) tensor(0.0889, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4003, dtype=torch.float64) delta_t tensor(1.3838, dtype=torch.float64)
5 gae_duplicate tensor(1.3496, dtype=torch.float64) tensor(-2.8069, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9716, dtype=torch.float64) delta_t tensor(-1.2188, dtype=torch.float64)
4 gae_duplicate tensor(-0.1391, dtype=torch.float64) tensor(0.2895, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9745, dtype=torch.float64) delta_t tensor(-0.7397, dtype=torch.float64)
3 gae_duplicate tensor(-0.8510, dtype=torch.float64) tensor(1.7692, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5967, dtype=torch.float64) delta_t tensor(-0.9740, dtype=torch.float64)
2 gae_duplicate tensor(-1.6547, dtype=torch.float64) tensor(3.4403, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-13.028136253356934
value loss:12.544306755065918
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.2229)
ToM Target loss= tensor(306.6949)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.3515119552612305 seconds
19 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(-0.1798, dtype=torch.float64)
19 gae_duplicate tensor(-0.1798, dtype=torch.float64) tensor(0.3739, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(0.4156, dtype=torch.float64)
18 gae_duplicate tensor(0.2718, dtype=torch.float64) tensor(-0.5652, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.1471, dtype=torch.float64)
17 gae_duplicate tensor(0.3646, dtype=torch.float64) tensor(-0.7576, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.0916, dtype=torch.float64)
16 gae_duplicate tensor(0.3833, dtype=torch.float64) tensor(-0.7969, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(-0.6937, dtype=torch.float64)
15 gae_duplicate tensor(-0.3871, dtype=torch.float64) tensor(0.8050, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.1883, dtype=torch.float64)
14 gae_duplicate tensor(-0.1214, dtype=torch.float64) tensor(0.2525, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.1989, dtype=torch.float64)
13 gae_duplicate tensor(0.1018, dtype=torch.float64) tensor(-0.2117, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.2631, dtype=torch.float64)
12 gae_duplicate tensor(0.3446, dtype=torch.float64) tensor(-0.7161, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.2070, dtype=torch.float64)
11 gae_duplicate tensor(0.4827, dtype=torch.float64) tensor(-1.0035, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8169, dtype=torch.float64) delta_t tensor(0.2099, dtype=torch.float64)
10 gae_duplicate tensor(0.5960, dtype=torch.float64) tensor(-1.2392, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3735, dtype=torch.float64) delta_t tensor(-0.1184, dtype=torch.float64)
9 gae_duplicate tensor(0.3584, dtype=torch.float64) tensor(-0.7451, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1835, dtype=torch.float64) delta_t tensor(-0.2918, dtype=torch.float64)
8 gae_duplicate tensor(-0.0051, dtype=torch.float64) tensor(0.0106, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8303, dtype=torch.float64) delta_t tensor(-1.8424, dtype=torch.float64)
7 gae_duplicate tensor(-1.8465, dtype=torch.float64) tensor(3.8404, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8941, dtype=torch.float64) delta_t tensor(0.9826, dtype=torch.float64)
6 gae_duplicate tensor(-0.4946, dtype=torch.float64) tensor(1.0287, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1480, dtype=torch.float64) delta_t tensor(0.5205, dtype=torch.float64)
5 gae_duplicate tensor(0.1248, dtype=torch.float64) tensor(-0.2598, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9724, dtype=torch.float64) delta_t tensor(0.1911, dtype=torch.float64)
4 gae_duplicate tensor(0.2909, dtype=torch.float64) tensor(-0.6046, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8484, dtype=torch.float64) delta_t tensor(-1.1543, dtype=torch.float64)
3 gae_duplicate tensor(-0.9216, dtype=torch.float64) tensor(1.9152, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7720, dtype=torch.float64) delta_t tensor(-0.7028, dtype=torch.float64)
2 gae_duplicate tensor(-1.4401, dtype=torch.float64) tensor(2.9940, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-27.045595169067383
value loss:12.111083984375
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4263269901275635 seconds
19 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(-0.0503, dtype=torch.float64)
19 gae_duplicate tensor(-0.0503, dtype=torch.float64) tensor(0.1047, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.2836, dtype=torch.float64)
18 gae_duplicate tensor(0.2433, dtype=torch.float64) tensor(-0.5060, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.0339, dtype=torch.float64)
17 gae_duplicate tensor(0.2285, dtype=torch.float64) tensor(-0.4755, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.1598, dtype=torch.float64)
16 gae_duplicate tensor(0.3426, dtype=torch.float64) tensor(-0.7121, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(-0.6917, dtype=torch.float64)
15 gae_duplicate tensor(-0.4176, dtype=torch.float64) tensor(0.8681, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.1847, dtype=torch.float64)
14 gae_duplicate tensor(-0.1494, dtype=torch.float64) tensor(0.3108, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(0.1901, dtype=torch.float64)
13 gae_duplicate tensor(0.0706, dtype=torch.float64) tensor(-0.1468, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.1969, dtype=torch.float64)
12 gae_duplicate tensor(0.2534, dtype=torch.float64) tensor(-0.5270, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(0.2544, dtype=torch.float64)
11 gae_duplicate tensor(0.4571, dtype=torch.float64) tensor(-0.9508, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.2343, dtype=torch.float64)
10 gae_duplicate tensor(0.6000, dtype=torch.float64) tensor(-1.2470, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4369, dtype=torch.float64) delta_t tensor(-0.1987, dtype=torch.float64)
9 gae_duplicate tensor(0.2813, dtype=torch.float64) tensor(-0.5849, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1200, dtype=torch.float64) delta_t tensor(-0.1257, dtype=torch.float64)
8 gae_duplicate tensor(0.0994, dtype=torch.float64) tensor(-0.2067, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1969, dtype=torch.float64) delta_t tensor(-1.1398, dtype=torch.float64)
7 gae_duplicate tensor(-1.0603, dtype=torch.float64) tensor(2.2053, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1475, dtype=torch.float64) delta_t tensor(0.7468, dtype=torch.float64)
6 gae_duplicate tensor(-0.1014, dtype=torch.float64) tensor(0.2109, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4018, dtype=torch.float64) delta_t tensor(1.3462, dtype=torch.float64)
5 gae_duplicate tensor(1.2651, dtype=torch.float64) tensor(-2.6302, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9735, dtype=torch.float64) delta_t tensor(-1.1978, dtype=torch.float64)
4 gae_duplicate tensor(-0.1857, dtype=torch.float64) tensor(0.3860, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5956, dtype=torch.float64) delta_t tensor(-0.5275, dtype=torch.float64)
3 gae_duplicate tensor(-0.6761, dtype=torch.float64) tensor(1.4061, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3434, dtype=torch.float64) delta_t tensor(-0.9347, dtype=torch.float64)
2 gae_duplicate tensor(-1.4756, dtype=torch.float64) tensor(3.0690, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4.567112445831299
value loss:9.838659286499023
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.514713764190674 seconds
19 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(-0.3853, dtype=torch.float64)
19 gae_duplicate tensor(-0.3853, dtype=torch.float64) tensor(0.8017, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.1474, dtype=torch.float64)
18 gae_duplicate tensor(-0.1609, dtype=torch.float64) tensor(0.3343, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.3079, dtype=torch.float64)
17 gae_duplicate tensor(0.1792, dtype=torch.float64) tensor(-0.3726, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.2835, dtype=torch.float64)
16 gae_duplicate tensor(0.4268, dtype=torch.float64) tensor(-0.8877, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(-0.6768, dtype=torch.float64)
15 gae_duplicate tensor(-0.3353, dtype=torch.float64) tensor(0.6977, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.1707, dtype=torch.float64)
14 gae_duplicate tensor(-0.0976, dtype=torch.float64) tensor(0.2030, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.1732, dtype=torch.float64)
13 gae_duplicate tensor(0.0951, dtype=torch.float64) tensor(-0.1978, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.2876, dtype=torch.float64)
12 gae_duplicate tensor(0.3637, dtype=torch.float64) tensor(-0.7561, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.2502, dtype=torch.float64)
11 gae_duplicate tensor(0.5411, dtype=torch.float64) tensor(-1.1259, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8169, dtype=torch.float64) delta_t tensor(0.1448, dtype=torch.float64)
10 gae_duplicate tensor(0.5777, dtype=torch.float64) tensor(-1.2016, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6266, dtype=torch.float64) delta_t tensor(-0.0626, dtype=torch.float64)
9 gae_duplicate tensor(0.3995, dtype=torch.float64) tensor(-0.8306, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3093, dtype=torch.float64) delta_t tensor(-0.3832, dtype=torch.float64)
8 gae_duplicate tensor(-0.0636, dtype=torch.float64) tensor(0.1321, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1987, dtype=torch.float64) delta_t tensor(-0.7321, dtype=torch.float64)
7 gae_duplicate tensor(-0.7830, dtype=torch.float64) tensor(1.6278, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1988, dtype=torch.float64) delta_t tensor(1.2169, dtype=torch.float64)
6 gae_duplicate tensor(0.5905, dtype=torch.float64) tensor(-1.2277, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6431, dtype=torch.float64) delta_t tensor(2.4365, dtype=torch.float64)
5 gae_duplicate tensor(2.9089, dtype=torch.float64) tensor(-6.0500, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5953, dtype=torch.float64) delta_t tensor(-0.6058, dtype=torch.float64)
4 gae_duplicate tensor(1.7213, dtype=torch.float64) tensor(-3.5787, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3430, dtype=torch.float64) delta_t tensor(-0.4138, dtype=torch.float64)
3 gae_duplicate tensor(0.9632, dtype=torch.float64) tensor(-2.0026, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8360, dtype=torch.float64) delta_t tensor(-0.8099, dtype=torch.float64)
2 gae_duplicate tensor(-0.0393, dtype=torch.float64) tensor(0.0817, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:84.99513244628906
value loss:22.136878967285156
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.493404865264893 seconds
19 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(-0.3295, dtype=torch.float64)
19 gae_duplicate tensor(-0.3295, dtype=torch.float64) tensor(0.6848, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(0.4371, dtype=torch.float64)
18 gae_duplicate tensor(0.1735, dtype=torch.float64) tensor(-0.3607, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(0.3398, dtype=torch.float64)
17 gae_duplicate tensor(0.4786, dtype=torch.float64) tensor(-0.9954, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(-1.0852, dtype=torch.float64)
16 gae_duplicate tensor(-0.7024, dtype=torch.float64) tensor(1.4597, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.2070, dtype=torch.float64)
15 gae_duplicate tensor(-0.3549, dtype=torch.float64) tensor(0.7383, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.1967, dtype=torch.float64)
14 gae_duplicate tensor(-0.0872, dtype=torch.float64) tensor(0.1814, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.1971, dtype=torch.float64)
13 gae_duplicate tensor(0.1273, dtype=torch.float64) tensor(-0.2648, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.1974, dtype=torch.float64)
12 gae_duplicate tensor(0.2993, dtype=torch.float64) tensor(-0.6222, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(0.1978, dtype=torch.float64)
11 gae_duplicate tensor(0.4372, dtype=torch.float64) tensor(-0.9094, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.1747, dtype=torch.float64)
10 gae_duplicate tensor(0.5245, dtype=torch.float64) tensor(-1.0908, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(0.2064, dtype=torch.float64)
9 gae_duplicate tensor(0.6259, dtype=torch.float64) tensor(-1.3014, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2460, dtype=torch.float64) delta_t tensor(-0.0996, dtype=torch.float64)
8 gae_duplicate tensor(0.4011, dtype=torch.float64) tensor(-0.8337, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0557, dtype=torch.float64) delta_t tensor(-0.8824, dtype=torch.float64)
7 gae_duplicate tensor(-0.5615, dtype=torch.float64) tensor(1.1679, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1493, dtype=torch.float64) delta_t tensor(0.7967, dtype=torch.float64)
6 gae_duplicate tensor(0.3475, dtype=torch.float64) tensor(-0.7227, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4038, dtype=torch.float64) delta_t tensor(1.1274, dtype=torch.float64)
5 gae_duplicate tensor(1.4053, dtype=torch.float64) tensor(-2.9218, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2298, dtype=torch.float64) delta_t tensor(-2.6377, dtype=torch.float64)
4 gae_duplicate tensor(-1.5134, dtype=torch.float64) tensor(3.1477, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8524, dtype=torch.float64) delta_t tensor(0.3724, dtype=torch.float64)
3 gae_duplicate tensor(-0.8384, dtype=torch.float64) tensor(1.7437, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.9819, dtype=torch.float64) delta_t tensor(-1.4212, dtype=torch.float64)
2 gae_duplicate tensor(-2.0919, dtype=torch.float64) tensor(4.3508, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-21.832796096801758
value loss:17.849594116210938
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.287116050720215 seconds
19 rew tensor(0.8124, dtype=torch.float64) delta_t tensor(-0.0662, dtype=torch.float64)
19 gae_duplicate tensor(-0.0662, dtype=torch.float64) tensor(0.1376, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(0.4552, dtype=torch.float64)
18 gae_duplicate tensor(0.4023, dtype=torch.float64) tensor(-0.8370, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(-0.3412, dtype=torch.float64)
17 gae_duplicate tensor(-0.0194, dtype=torch.float64) tensor(0.0402, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.1154, dtype=torch.float64)
16 gae_duplicate tensor(0.0999, dtype=torch.float64) tensor(-0.2078, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(-0.5555, dtype=torch.float64)
15 gae_duplicate tensor(-0.4757, dtype=torch.float64) tensor(0.9889, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.1723, dtype=torch.float64)
14 gae_duplicate tensor(-0.2082, dtype=torch.float64) tensor(0.4330, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.1900, dtype=torch.float64)
13 gae_duplicate tensor(0.0234, dtype=torch.float64) tensor(-0.0487, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.1766, dtype=torch.float64)
12 gae_duplicate tensor(0.1953, dtype=torch.float64) tensor(-0.4060, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.2253, dtype=torch.float64)
11 gae_duplicate tensor(0.3816, dtype=torch.float64) tensor(-0.7936, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(0.2517, dtype=torch.float64)
10 gae_duplicate tensor(0.5570, dtype=torch.float64) tensor(-1.1576, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.1994, dtype=torch.float64)
9 gae_duplicate tensor(0.6450, dtype=torch.float64) tensor(-1.3410, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2461, dtype=torch.float64) delta_t tensor(0.1680, dtype=torch.float64)
8 gae_duplicate tensor(0.6840, dtype=torch.float64) tensor(-1.4231, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1975, dtype=torch.float64) delta_t tensor(-1.1609, dtype=torch.float64)
7 gae_duplicate tensor(-0.6137, dtype=torch.float64) tensor(1.2770, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4013, dtype=torch.float64) delta_t tensor(0.5360, dtype=torch.float64)
6 gae_duplicate tensor(0.0450, dtype=torch.float64) tensor(-0.0936, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6559, dtype=torch.float64) delta_t tensor(0.8118, dtype=torch.float64)
5 gae_duplicate tensor(0.8478, dtype=torch.float64) tensor(-1.7626, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2283, dtype=torch.float64) delta_t tensor(-2.6694, dtype=torch.float64)
4 gae_duplicate tensor(-1.9912, dtype=torch.float64) tensor(4.1429, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5973, dtype=torch.float64) delta_t tensor(0.6628, dtype=torch.float64)
3 gae_duplicate tensor(-0.9302, dtype=torch.float64) tensor(1.9346, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.9799, dtype=torch.float64) delta_t tensor(-1.6910, dtype=torch.float64)
2 gae_duplicate tensor(-2.4351, dtype=torch.float64) tensor(5.0627, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-36.79908752441406
value loss:20.52276039123535
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.2229)
ToM Target loss= tensor(306.9785)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.560901880264282 seconds
19 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(-0.5879, dtype=torch.float64)
19 gae_duplicate tensor(-0.5879, dtype=torch.float64) tensor(1.2226, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8120, dtype=torch.float64) delta_t tensor(0.6905, dtype=torch.float64)
18 gae_duplicate tensor(0.2202, dtype=torch.float64) tensor(-0.4578, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8123, dtype=torch.float64) delta_t tensor(-0.2038, dtype=torch.float64)
17 gae_duplicate tensor(-0.0276, dtype=torch.float64) tensor(0.0574, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(-0.7230, dtype=torch.float64)
16 gae_duplicate tensor(-0.7451, dtype=torch.float64) tensor(1.5496, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.4854, dtype=torch.float64)
15 gae_duplicate tensor(-0.1106, dtype=torch.float64) tensor(0.2300, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.2451, dtype=torch.float64)
14 gae_duplicate tensor(0.1566, dtype=torch.float64) tensor(-0.3256, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.2454, dtype=torch.float64)
13 gae_duplicate tensor(0.3707, dtype=torch.float64) tensor(-0.7710, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.2458, dtype=torch.float64)
12 gae_duplicate tensor(0.5424, dtype=torch.float64) tensor(-1.1276, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.2462, dtype=torch.float64)
11 gae_duplicate tensor(0.6801, dtype=torch.float64) tensor(-1.4149, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(-0.0555, dtype=torch.float64)
10 gae_duplicate tensor(0.4886, dtype=torch.float64) tensor(-1.0154, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.1930, dtype=torch.float64)
9 gae_duplicate tensor(0.5838, dtype=torch.float64) tensor(-1.2143, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4987, dtype=torch.float64) delta_t tensor(-0.0911, dtype=torch.float64)
8 gae_duplicate tensor(0.3759, dtype=torch.float64) tensor(-0.7816, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2454, dtype=torch.float64) delta_t tensor(0.0564, dtype=torch.float64)
7 gae_duplicate tensor(0.3572, dtype=torch.float64) tensor(-0.7423, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3882, dtype=torch.float64) delta_t tensor(0.0663, dtype=torch.float64)
6 gae_duplicate tensor(0.3521, dtype=torch.float64) tensor(-0.7320, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5920, dtype=torch.float64) delta_t tensor(1.4118, dtype=torch.float64)
5 gae_duplicate tensor(1.6935, dtype=torch.float64) tensor(-3.5221, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5936, dtype=torch.float64) delta_t tensor(-1.6660, dtype=torch.float64)
4 gae_duplicate tensor(-0.3113, dtype=torch.float64) tensor(0.6469, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7220, dtype=torch.float64) delta_t tensor(0.4911, dtype=torch.float64)
3 gae_duplicate tensor(0.2420, dtype=torch.float64) tensor(-0.5032, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.8507, dtype=torch.float64) delta_t tensor(-1.5565, dtype=torch.float64)
2 gae_duplicate tensor(-1.3629, dtype=torch.float64) tensor(2.8346, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:35.27708053588867
value loss:11.600974082946777
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.322540044784546 seconds
19 rew tensor(0.7502, dtype=torch.float64) delta_t tensor(-0.8497, dtype=torch.float64)
19 gae_duplicate tensor(-0.8497, dtype=torch.float64) tensor(1.7667, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6236, dtype=torch.float64) delta_t tensor(-0.0513, dtype=torch.float64)
18 gae_duplicate tensor(-0.7311, dtype=torch.float64) tensor(1.5195, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4968, dtype=torch.float64) delta_t tensor(0.0758, dtype=torch.float64)
17 gae_duplicate tensor(-0.5091, dtype=torch.float64) tensor(1.0585, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0527, dtype=torch.float64) delta_t tensor(-1.4006, dtype=torch.float64)
16 gae_duplicate tensor(-1.8079, dtype=torch.float64) tensor(3.7572, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.5184, dtype=torch.float64) delta_t tensor(-1.1263, dtype=torch.float64)
15 gae_duplicate tensor(-2.5727, dtype=torch.float64) tensor(5.3487, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(0.1795, dtype=torch.float64)
14 gae_duplicate tensor(-1.8787, dtype=torch.float64) tensor(3.9073, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7507, dtype=torch.float64) delta_t tensor(0.1275, dtype=torch.float64)
13 gae_duplicate tensor(-1.3755, dtype=torch.float64) tensor(2.8596, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6241, dtype=torch.float64) delta_t tensor(0.0765, dtype=torch.float64)
12 gae_duplicate tensor(-1.0239, dtype=torch.float64) tensor(2.1295, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6878, dtype=torch.float64) delta_t tensor(0.1048, dtype=torch.float64)
11 gae_duplicate tensor(-0.7143, dtype=torch.float64) tensor(1.4850, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6881, dtype=torch.float64) delta_t tensor(0.0387, dtype=torch.float64)
10 gae_duplicate tensor(-0.5327, dtype=torch.float64) tensor(1.1080, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4347, dtype=torch.float64) delta_t tensor(-0.1560, dtype=torch.float64)
9 gae_duplicate tensor(-0.5822, dtype=torch.float64) tensor(1.2104, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1813, dtype=torch.float64) delta_t tensor(-0.3257, dtype=torch.float64)
8 gae_duplicate tensor(-0.7915, dtype=torch.float64) tensor(1.6456, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1988, dtype=torch.float64) delta_t tensor(-0.5973, dtype=torch.float64)
7 gae_duplicate tensor(-1.2305, dtype=torch.float64) tensor(2.5584, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9591, dtype=torch.float64) delta_t tensor(0.6358, dtype=torch.float64)
6 gae_duplicate tensor(-0.3486, dtype=torch.float64) tensor(0.7253, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7832, dtype=torch.float64) delta_t tensor(0.7464, dtype=torch.float64)
5 gae_duplicate tensor(0.4675, dtype=torch.float64) tensor(-0.9716, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9754, dtype=torch.float64) delta_t tensor(-2.2854, dtype=torch.float64)
4 gae_duplicate tensor(-1.9114, dtype=torch.float64) tensor(3.9754, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7243, dtype=torch.float64) delta_t tensor(0.3777, dtype=torch.float64)
3 gae_duplicate tensor(-1.1514, dtype=torch.float64) tensor(2.3938, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4723, dtype=torch.float64) delta_t tensor(-1.5418, dtype=torch.float64)
2 gae_duplicate tensor(-2.4629, dtype=torch.float64) tensor(5.1205, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-250.70932006835938
value loss:48.796634674072266
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.141940116882324 seconds
19 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(-0.6646, dtype=torch.float64)
19 gae_duplicate tensor(-0.6646, dtype=torch.float64) tensor(1.3828, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(0.5395, dtype=torch.float64)
18 gae_duplicate tensor(0.0078, dtype=torch.float64) tensor(-0.0161, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(-0.0428, dtype=torch.float64)
17 gae_duplicate tensor(-0.0366, dtype=torch.float64) tensor(0.0762, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.0891, dtype=torch.float64)
16 gae_duplicate tensor(0.0598, dtype=torch.float64) tensor(-0.1243, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(-0.5155, dtype=torch.float64)
15 gae_duplicate tensor(-0.4677, dtype=torch.float64) tensor(0.9727, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.1941, dtype=torch.float64)
14 gae_duplicate tensor(-0.1801, dtype=torch.float64) tensor(0.3744, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.2036, dtype=torch.float64)
13 gae_duplicate tensor(0.0596, dtype=torch.float64) tensor(-0.1238, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(0.2489, dtype=torch.float64)
12 gae_duplicate tensor(0.2966, dtype=torch.float64) tensor(-0.6171, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.2342, dtype=torch.float64)
11 gae_duplicate tensor(0.4715, dtype=torch.float64) tensor(-0.9802, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(0.1054, dtype=torch.float64)
10 gae_duplicate tensor(0.4826, dtype=torch.float64) tensor(-1.0030, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.4050, dtype=torch.float64)
9 gae_duplicate tensor(0.7911, dtype=torch.float64) tensor(-1.6447, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.8173, dtype=torch.float64) delta_t tensor(1.3595, dtype=torch.float64)
8 gae_duplicate tensor(1.9924, dtype=torch.float64) tensor(-4.1439, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8296, dtype=torch.float64) delta_t tensor(-2.6109, dtype=torch.float64)
7 gae_duplicate tensor(-1.0170, dtype=torch.float64) tensor(2.1136, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8934, dtype=torch.float64) delta_t tensor(0.9589, dtype=torch.float64)
6 gae_duplicate tensor(0.1453, dtype=torch.float64) tensor(-0.3021, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2739, dtype=torch.float64) delta_t tensor(-0.1724, dtype=torch.float64)
5 gae_duplicate tensor(-0.0561, dtype=torch.float64) tensor(0.1166, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2252, dtype=torch.float64) delta_t tensor(0.0676, dtype=torch.float64)
4 gae_duplicate tensor(0.0227, dtype=torch.float64) tensor(-0.0472, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.1020, dtype=torch.float64) delta_t tensor(-1.1043, dtype=torch.float64)
3 gae_duplicate tensor(-1.0861, dtype=torch.float64) tensor(2.2581, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2162, dtype=torch.float64) delta_t tensor(-1.2886, dtype=torch.float64)
2 gae_duplicate tensor(-2.1576, dtype=torch.float64) tensor(4.4874, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-17.79937744140625
value loss:19.10074234008789
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5198352336883545 seconds
19 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(-0.1761, dtype=torch.float64)
19 gae_duplicate tensor(-0.1761, dtype=torch.float64) tensor(0.3663, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.5196, dtype=torch.float64)
18 gae_duplicate tensor(0.3787, dtype=torch.float64) tensor(-0.7872, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.1731, dtype=torch.float64)
17 gae_duplicate tensor(0.4760, dtype=torch.float64) tensor(-0.9896, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(-0.1351, dtype=torch.float64)
16 gae_duplicate tensor(0.2457, dtype=torch.float64) tensor(-0.5112, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(-0.4511, dtype=torch.float64)
15 gae_duplicate tensor(-0.2545, dtype=torch.float64) tensor(0.5292, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.2170, dtype=torch.float64)
14 gae_duplicate tensor(0.0133, dtype=torch.float64) tensor(-0.0277, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(0.2184, dtype=torch.float64)
13 gae_duplicate tensor(0.2291, dtype=torch.float64) tensor(-0.4766, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.2247, dtype=torch.float64)
12 gae_duplicate tensor(0.4079, dtype=torch.float64) tensor(-0.8484, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(0.2041, dtype=torch.float64)
11 gae_duplicate tensor(0.5304, dtype=torch.float64) tensor(-1.1032, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.2981, dtype=torch.float64)
10 gae_duplicate tensor(0.7225, dtype=torch.float64) tensor(-1.5021, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1832, dtype=torch.float64) delta_t tensor(-0.4481, dtype=torch.float64)
9 gae_duplicate tensor(0.1298, dtype=torch.float64) tensor(-0.2699, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0069, dtype=torch.float64) delta_t tensor(-0.1658, dtype=torch.float64)
8 gae_duplicate tensor(-0.0619, dtype=torch.float64) tensor(0.1288, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0703, dtype=torch.float64) delta_t tensor(-0.8667, dtype=torch.float64)
7 gae_duplicate tensor(-0.9163, dtype=torch.float64) tensor(1.9051, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1474, dtype=torch.float64) delta_t tensor(0.4692, dtype=torch.float64)
6 gae_duplicate tensor(-0.2638, dtype=torch.float64) tensor(0.5487, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4016, dtype=torch.float64) delta_t tensor(1.2446, dtype=torch.float64)
5 gae_duplicate tensor(1.0335, dtype=torch.float64) tensor(-2.1488, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7196, dtype=torch.float64) delta_t tensor(-1.1574, dtype=torch.float64)
4 gae_duplicate tensor(-0.3306, dtype=torch.float64) tensor(0.6870, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4678, dtype=torch.float64) delta_t tensor(-0.1031, dtype=torch.float64)
3 gae_duplicate tensor(-0.3676, dtype=torch.float64) tensor(0.7639, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4690, dtype=torch.float64) delta_t tensor(-1.0039, dtype=torch.float64)
2 gae_duplicate tensor(-1.2979, dtype=torch.float64) tensor(2.6985, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:5.100752830505371
value loss:8.213262557983398
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.641991138458252 seconds
19 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(-0.3530, dtype=torch.float64)
19 gae_duplicate tensor(-0.3530, dtype=torch.float64) tensor(0.7343, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.5309, dtype=torch.float64)
18 gae_duplicate tensor(0.2485, dtype=torch.float64) tensor(-0.5167, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(-0.1123, dtype=torch.float64)
17 gae_duplicate tensor(0.0866, dtype=torch.float64) tensor(-0.1800, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(-0.0130, dtype=torch.float64)
16 gae_duplicate tensor(0.0562, dtype=torch.float64) tensor(-0.1169, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(-0.3820, dtype=torch.float64)
15 gae_duplicate tensor(-0.3370, dtype=torch.float64) tensor(0.7005, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.1967, dtype=torch.float64)
14 gae_duplicate tensor(-0.0729, dtype=torch.float64) tensor(0.1517, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(0.2008, dtype=torch.float64)
13 gae_duplicate tensor(0.1425, dtype=torch.float64) tensor(-0.2962, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(0.2169, dtype=torch.float64)
12 gae_duplicate tensor(0.3309, dtype=torch.float64) tensor(-0.6882, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(0.3019, dtype=torch.float64)
11 gae_duplicate tensor(0.5666, dtype=torch.float64) tensor(-1.1784, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8171, dtype=torch.float64) delta_t tensor(0.1909, dtype=torch.float64)
10 gae_duplicate tensor(0.6442, dtype=torch.float64) tensor(-1.3389, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4366, dtype=torch.float64) delta_t tensor(-0.1920, dtype=torch.float64)
9 gae_duplicate tensor(0.3234, dtype=torch.float64) tensor(-0.6728, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2463, dtype=torch.float64) delta_t tensor(-0.2415, dtype=torch.float64)
8 gae_duplicate tensor(0.0172, dtype=torch.float64) tensor(-0.0358, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0560, dtype=torch.float64) delta_t tensor(-0.7266, dtype=torch.float64)
7 gae_duplicate tensor(-0.7128, dtype=torch.float64) tensor(1.4824, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6417, dtype=torch.float64) delta_t tensor(1.0783, dtype=torch.float64)
6 gae_duplicate tensor(0.5080, dtype=torch.float64) tensor(-1.0562, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8957, dtype=torch.float64) delta_t tensor(1.8016, dtype=torch.float64)
5 gae_duplicate tensor(2.2080, dtype=torch.float64) tensor(-4.5922, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7206, dtype=torch.float64) delta_t tensor(-0.9750, dtype=torch.float64)
4 gae_duplicate tensor(0.7914, dtype=torch.float64) tensor(-1.6453, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4686, dtype=torch.float64) delta_t tensor(-0.3727, dtype=torch.float64)
3 gae_duplicate tensor(0.2604, dtype=torch.float64) tensor(-0.5413, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3428, dtype=torch.float64) delta_t tensor(-0.5090, dtype=torch.float64)
2 gae_duplicate tensor(-0.3007, dtype=torch.float64) tensor(0.6249, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:53.86811065673828
value loss:11.568559646606445
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.0052)
ToM Target loss= tensor(306.5831)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.45222806930542 seconds
19 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(-0.2661, dtype=torch.float64)
19 gae_duplicate tensor(-0.2661, dtype=torch.float64) tensor(0.5534, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.5379, dtype=torch.float64)
18 gae_duplicate tensor(0.3250, dtype=torch.float64) tensor(-0.6759, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.1194, dtype=torch.float64)
17 gae_duplicate tensor(0.3794, dtype=torch.float64) tensor(-0.7891, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(-0.5372, dtype=torch.float64)
16 gae_duplicate tensor(-0.2337, dtype=torch.float64) tensor(0.4859, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(-0.0120, dtype=torch.float64)
15 gae_duplicate tensor(-0.1990, dtype=torch.float64) tensor(0.4135, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.2321, dtype=torch.float64)
14 gae_duplicate tensor(0.0729, dtype=torch.float64) tensor(-0.1515, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(0.2479, dtype=torch.float64)
13 gae_duplicate tensor(0.3062, dtype=torch.float64) tensor(-0.6368, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.2701, dtype=torch.float64)
12 gae_duplicate tensor(0.5151, dtype=torch.float64) tensor(-1.0713, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(0.2410, dtype=torch.float64)
11 gae_duplicate tensor(0.6531, dtype=torch.float64) tensor(-1.3579, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.1867, dtype=torch.float64)
10 gae_duplicate tensor(0.7091, dtype=torch.float64) tensor(-1.4749, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8173, dtype=torch.float64) delta_t tensor(0.2493, dtype=torch.float64)
9 gae_duplicate tensor(0.8166, dtype=torch.float64) tensor(-1.6984, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3096, dtype=torch.float64) delta_t tensor(-0.1958, dtype=torch.float64)
8 gae_duplicate tensor(0.4575, dtype=torch.float64) tensor(-0.9518, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5794, dtype=torch.float64) delta_t tensor(-1.4013, dtype=torch.float64)
7 gae_duplicate tensor(-1.0354, dtype=torch.float64) tensor(2.1534, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5796, dtype=torch.float64) delta_t tensor(1.2739, dtype=torch.float64)
6 gae_duplicate tensor(0.4456, dtype=torch.float64) tensor(-0.9268, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8971, dtype=torch.float64) delta_t tensor(0.7749, dtype=torch.float64)
5 gae_duplicate tensor(1.1314, dtype=torch.float64) tensor(-2.3515, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9766, dtype=torch.float64) delta_t tensor(0.0422, dtype=torch.float64)
4 gae_duplicate tensor(0.9473, dtype=torch.float64) tensor(-1.9702, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7251, dtype=torch.float64) delta_t tensor(-0.8489, dtype=torch.float64)
3 gae_duplicate tensor(-0.0910, dtype=torch.float64) tensor(0.1892, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7736, dtype=torch.float64) delta_t tensor(-0.7052, dtype=torch.float64)
2 gae_duplicate tensor(-0.7780, dtype=torch.float64) tensor(1.6175, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:50.735713958740234
value loss:9.969194412231445
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.499003887176514 seconds
19 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(-0.0681, dtype=torch.float64)
19 gae_duplicate tensor(-0.0681, dtype=torch.float64) tensor(0.1416, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.4190, dtype=torch.float64)
18 gae_duplicate tensor(0.3645, dtype=torch.float64) tensor(-0.7580, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(-0.1178, dtype=torch.float64)
17 gae_duplicate tensor(0.1738, dtype=torch.float64) tensor(-0.3613, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(-0.1705, dtype=torch.float64)
16 gae_duplicate tensor(-0.0315, dtype=torch.float64) tensor(0.0654, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(-0.1991, dtype=torch.float64)
15 gae_duplicate tensor(-0.2243, dtype=torch.float64) tensor(0.4663, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.2228, dtype=torch.float64)
14 gae_duplicate tensor(0.0434, dtype=torch.float64) tensor(-0.0902, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.2304, dtype=torch.float64)
13 gae_duplicate tensor(0.2651, dtype=torch.float64) tensor(-0.5512, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.2376, dtype=torch.float64)
12 gae_duplicate tensor(0.4497, dtype=torch.float64) tensor(-0.9353, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.2703, dtype=torch.float64)
11 gae_duplicate tensor(0.6301, dtype=torch.float64) tensor(-1.3100, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(0.2547, dtype=torch.float64)
10 gae_duplicate tensor(0.7587, dtype=torch.float64) tensor(-1.5779, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(0.2594, dtype=torch.float64)
9 gae_duplicate tensor(0.8663, dtype=torch.float64) tensor(-1.8019, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2459, dtype=torch.float64) delta_t tensor(0.2114, dtype=torch.float64)
8 gae_duplicate tensor(0.9045, dtype=torch.float64) tensor(-1.8799, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0713, dtype=torch.float64) delta_t tensor(-0.9095, dtype=torch.float64)
7 gae_duplicate tensor(-0.1859, dtype=torch.float64) tensor(0.3865, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4035, dtype=torch.float64) delta_t tensor(0.2706, dtype=torch.float64)
6 gae_duplicate tensor(0.1219, dtype=torch.float64) tensor(-0.2534, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6584, dtype=torch.float64) delta_t tensor(0.8234, dtype=torch.float64)
5 gae_duplicate tensor(0.9209, dtype=torch.float64) tensor(-1.9146, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1044, dtype=torch.float64) delta_t tensor(-2.3562, dtype=torch.float64)
4 gae_duplicate tensor(-1.6195, dtype=torch.float64) tensor(3.3670, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8533, dtype=torch.float64) delta_t tensor(0.3464, dtype=torch.float64)
3 gae_duplicate tensor(-0.9492, dtype=torch.float64) tensor(1.9741, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6011, dtype=torch.float64) delta_t tensor(-1.3291, dtype=torch.float64)
2 gae_duplicate tensor(-2.0884, dtype=torch.float64) tensor(4.3420, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3.0215206146240234
value loss:17.7257137298584
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.3022379875183105 seconds
19 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(0.0007, dtype=torch.float64)
19 gae_duplicate tensor(0.0007, dtype=torch.float64) tensor(-0.0016, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(0.4178, dtype=torch.float64)
18 gae_duplicate tensor(0.4183, dtype=torch.float64) tensor(-0.8698, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(-0.1476, dtype=torch.float64)
17 gae_duplicate tensor(0.1871, dtype=torch.float64) tensor(-0.3890, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(-0.5432, dtype=torch.float64)
16 gae_duplicate tensor(-0.3935, dtype=torch.float64) tensor(0.8184, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.1484, dtype=torch.float64)
15 gae_duplicate tensor(-0.1664, dtype=torch.float64) tensor(0.3459, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.2343, dtype=torch.float64)
14 gae_duplicate tensor(0.1011, dtype=torch.float64) tensor(-0.2103, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.2346, dtype=torch.float64)
13 gae_duplicate tensor(0.3155, dtype=torch.float64) tensor(-0.6562, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.2350, dtype=torch.float64)
12 gae_duplicate tensor(0.4874, dtype=torch.float64) tensor(-1.0137, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(0.2572, dtype=torch.float64)
11 gae_duplicate tensor(0.6472, dtype=torch.float64) tensor(-1.3464, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.2714, dtype=torch.float64)
10 gae_duplicate tensor(0.7892, dtype=torch.float64) tensor(-1.6414, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4991, dtype=torch.float64) delta_t tensor(-0.0473, dtype=torch.float64)
9 gae_duplicate tensor(0.5840, dtype=torch.float64) tensor(-1.2146, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2455, dtype=torch.float64) delta_t tensor(0.2152, dtype=torch.float64)
8 gae_duplicate tensor(0.6824, dtype=torch.float64) tensor(-1.4192, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0716, dtype=torch.float64) delta_t tensor(-0.8419, dtype=torch.float64)
7 gae_duplicate tensor(-0.2960, dtype=torch.float64) tensor(0.6156, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4034, dtype=torch.float64) delta_t tensor(0.1814, dtype=torch.float64)
6 gae_duplicate tensor(-0.0554, dtype=torch.float64) tensor(0.1152, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6582, dtype=torch.float64) delta_t tensor(0.8528, dtype=torch.float64)
5 gae_duplicate tensor(0.8085, dtype=torch.float64) tensor(-1.6815, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9771, dtype=torch.float64) delta_t tensor(-2.2297, dtype=torch.float64)
4 gae_duplicate tensor(-1.5829, dtype=torch.float64) tensor(3.2921, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7256, dtype=torch.float64) delta_t tensor(0.4793, dtype=torch.float64)
3 gae_duplicate tensor(-0.7871, dtype=torch.float64) tensor(1.6369, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4732, dtype=torch.float64) delta_t tensor(-1.4103, dtype=torch.float64)
2 gae_duplicate tensor(-2.0400, dtype=torch.float64) tensor(4.2427, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4.862526893615723
value loss:15.92898178100586
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.522997617721558 seconds
19 rew tensor(0.8122, dtype=torch.float64) delta_t tensor(-0.4181, dtype=torch.float64)
19 gae_duplicate tensor(-0.4181, dtype=torch.float64) tensor(0.8696, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8125, dtype=torch.float64) delta_t tensor(0.5532, dtype=torch.float64)
18 gae_duplicate tensor(0.2187, dtype=torch.float64) tensor(-0.4548, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(-0.1150, dtype=torch.float64)
17 gae_duplicate tensor(0.0600, dtype=torch.float64) tensor(-0.1246, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(-0.5141, dtype=torch.float64)
16 gae_duplicate tensor(-0.4662, dtype=torch.float64) tensor(0.9695, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.0842, dtype=torch.float64)
15 gae_duplicate tensor(-0.2888, dtype=torch.float64) tensor(0.6006, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.2095, dtype=torch.float64)
14 gae_duplicate tensor(-0.0215, dtype=torch.float64) tensor(0.0446, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.2307, dtype=torch.float64)
13 gae_duplicate tensor(0.2135, dtype=torch.float64) tensor(-0.4440, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.2391, dtype=torch.float64)
12 gae_duplicate tensor(0.4099, dtype=torch.float64) tensor(-0.8524, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.3236, dtype=torch.float64)
11 gae_duplicate tensor(0.6515, dtype=torch.float64) tensor(-1.3549, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.1197, dtype=torch.float64)
10 gae_duplicate tensor(0.6409, dtype=torch.float64) tensor(-1.3333, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.2207, dtype=torch.float64)
9 gae_duplicate tensor(0.7334, dtype=torch.float64) tensor(-1.5253, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(0.4447, dtype=torch.float64)
8 gae_duplicate tensor(1.0314, dtype=torch.float64) tensor(-2.1444, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0555, dtype=torch.float64) delta_t tensor(-0.8241, dtype=torch.float64)
7 gae_duplicate tensor(0.0011, dtype=torch.float64) tensor(-0.0023, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0219, dtype=torch.float64) delta_t tensor(0.8744, dtype=torch.float64)
6 gae_duplicate tensor(0.8752, dtype=torch.float64) tensor(-1.8196, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2760, dtype=torch.float64) delta_t tensor(1.0109, dtype=torch.float64)
5 gae_duplicate tensor(1.7111, dtype=torch.float64) tensor(-3.5587, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2277, dtype=torch.float64) delta_t tensor(-2.3886, dtype=torch.float64)
4 gae_duplicate tensor(-1.0197, dtype=torch.float64) tensor(2.1195, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9773, dtype=torch.float64) delta_t tensor(0.2288, dtype=torch.float64)
3 gae_duplicate tensor(-0.5870, dtype=torch.float64) tensor(1.2207, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7257, dtype=torch.float64) delta_t tensor(-0.9692, dtype=torch.float64)
2 gae_duplicate tensor(-1.4387, dtype=torch.float64) tensor(2.9903, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:27.674800872802734
value loss:15.489013671875
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.2356908321380615 seconds
19 rew tensor(0.8122, dtype=torch.float64) delta_t tensor(-0.4478, dtype=torch.float64)
19 gae_duplicate tensor(-0.4478, dtype=torch.float64) tensor(0.9312, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8125, dtype=torch.float64) delta_t tensor(0.5658, dtype=torch.float64)
18 gae_duplicate tensor(0.2076, dtype=torch.float64) tensor(-0.4318, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(-0.1425, dtype=torch.float64)
17 gae_duplicate tensor(0.0236, dtype=torch.float64) tensor(-0.0491, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(-0.5608, dtype=torch.float64)
16 gae_duplicate tensor(-0.5419, dtype=torch.float64) tensor(1.1267, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.1268, dtype=torch.float64)
15 gae_duplicate tensor(-0.3067, dtype=torch.float64) tensor(0.6376, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.2059, dtype=torch.float64)
14 gae_duplicate tensor(-0.0394, dtype=torch.float64) tensor(0.0820, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.2296, dtype=torch.float64)
13 gae_duplicate tensor(0.1981, dtype=torch.float64) tensor(-0.4120, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.2389, dtype=torch.float64)
12 gae_duplicate tensor(0.3974, dtype=torch.float64) tensor(-0.8260, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.2498, dtype=torch.float64)
11 gae_duplicate tensor(0.5677, dtype=torch.float64) tensor(-1.1803, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.1982, dtype=torch.float64)
10 gae_duplicate tensor(0.6524, dtype=torch.float64) tensor(-1.3564, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.1529, dtype=torch.float64)
9 gae_duplicate tensor(0.6748, dtype=torch.float64) tensor(-1.4030, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0552, dtype=torch.float64) delta_t tensor(-0.2541, dtype=torch.float64)
8 gae_duplicate tensor(0.2857, dtype=torch.float64) tensor(-0.5943, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1983, dtype=torch.float64) delta_t tensor(-1.0893, dtype=torch.float64)
7 gae_duplicate tensor(-0.8607, dtype=torch.float64) tensor(1.7900, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0221, dtype=torch.float64) delta_t tensor(0.8983, dtype=torch.float64)
6 gae_duplicate tensor(0.2098, dtype=torch.float64) tensor(-0.4362, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2761, dtype=torch.float64) delta_t tensor(1.2061, dtype=torch.float64)
5 gae_duplicate tensor(1.3740, dtype=torch.float64) tensor(-2.8575, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1008, dtype=torch.float64) delta_t tensor(-1.2933, dtype=torch.float64)
4 gae_duplicate tensor(-0.1941, dtype=torch.float64) tensor(0.4036, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7231, dtype=torch.float64) delta_t tensor(-0.5140, dtype=torch.float64)
3 gae_duplicate tensor(-0.6693, dtype=torch.float64) tensor(1.3923, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4710, dtype=torch.float64) delta_t tensor(-0.6242, dtype=torch.float64)
2 gae_duplicate tensor(-1.1596, dtype=torch.float64) tensor(2.4116, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3.506009101867676
value loss:9.927566528320312
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.9201)
ToM Target loss= tensor(306.4651)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.403741836547852 seconds
19 rew tensor(0.8114, dtype=torch.float64) delta_t tensor(-1.1021, dtype=torch.float64)
19 gae_duplicate tensor(-1.1021, dtype=torch.float64) tensor(2.2908, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(1.0496, dtype=torch.float64)
18 gae_duplicate tensor(0.1679, dtype=torch.float64) tensor(-0.3493, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(-0.3526, dtype=torch.float64)
17 gae_duplicate tensor(-0.2183, dtype=torch.float64) tensor(0.4540, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8124, dtype=torch.float64) delta_t tensor(-0.4875, dtype=torch.float64)
16 gae_duplicate tensor(-0.6622, dtype=torch.float64) tensor(1.3763, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(0.5627, dtype=torch.float64)
15 gae_duplicate tensor(0.0329, dtype=torch.float64) tensor(-0.0685, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.2736, dtype=torch.float64)
14 gae_duplicate tensor(0.2999, dtype=torch.float64) tensor(-0.6234, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(0.2739, dtype=torch.float64)
13 gae_duplicate tensor(0.5139, dtype=torch.float64) tensor(-1.0687, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.2743, dtype=torch.float64)
12 gae_duplicate tensor(0.6854, dtype=torch.float64) tensor(-1.4254, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.2746, dtype=torch.float64)
11 gae_duplicate tensor(0.8229, dtype=torch.float64) tensor(-1.7109, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(-0.0895, dtype=torch.float64)
10 gae_duplicate tensor(0.5688, dtype=torch.float64) tensor(-1.1825, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.2120, dtype=torch.float64)
9 gae_duplicate tensor(0.6671, dtype=torch.float64) tensor(-1.3874, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4981, dtype=torch.float64) delta_t tensor(-0.0624, dtype=torch.float64)
8 gae_duplicate tensor(0.4713, dtype=torch.float64) tensor(-0.9799, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2447, dtype=torch.float64) delta_t tensor(0.0773, dtype=torch.float64)
7 gae_duplicate tensor(0.4544, dtype=torch.float64) tensor(-0.9453, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3890, dtype=torch.float64) delta_t tensor(-0.4403, dtype=torch.float64)
6 gae_duplicate tensor(-0.0768, dtype=torch.float64) tensor(0.1596, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5929, dtype=torch.float64) delta_t tensor(0.4327, dtype=torch.float64)
5 gae_duplicate tensor(0.3713, dtype=torch.float64) tensor(-0.7719, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5943, dtype=torch.float64) delta_t tensor(-0.5101, dtype=torch.float64)
4 gae_duplicate tensor(-0.2131, dtype=torch.float64) tensor(0.4430, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7226, dtype=torch.float64) delta_t tensor(0.6215, dtype=torch.float64)
3 gae_duplicate tensor(0.4510, dtype=torch.float64) tensor(-0.9383, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.8511, dtype=torch.float64) delta_t tensor(-1.4266, dtype=torch.float64)
2 gae_duplicate tensor(-1.0658, dtype=torch.float64) tensor(2.2153, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:25.951679229736328
value loss:8.934798240661621
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.532352924346924 seconds
19 rew tensor(0.8109, dtype=torch.float64) delta_t tensor(-0.1460, dtype=torch.float64)
19 gae_duplicate tensor(-0.1460, dtype=torch.float64) tensor(0.3036, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8113, dtype=torch.float64) delta_t tensor(0.4577, dtype=torch.float64)
18 gae_duplicate tensor(0.3409, dtype=torch.float64) tensor(-0.7090, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(-0.1893, dtype=torch.float64)
17 gae_duplicate tensor(0.0834, dtype=torch.float64) tensor(-0.1734, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8119, dtype=torch.float64) delta_t tensor(-0.4877, dtype=torch.float64)
16 gae_duplicate tensor(-0.4210, dtype=torch.float64) tensor(0.8754, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8123, dtype=torch.float64) delta_t tensor(0.0594, dtype=torch.float64)
15 gae_duplicate tensor(-0.2774, dtype=torch.float64) tensor(0.5766, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8126, dtype=torch.float64) delta_t tensor(0.2114, dtype=torch.float64)
14 gae_duplicate tensor(-0.0106, dtype=torch.float64) tensor(0.0219, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(0.2244, dtype=torch.float64)
13 gae_duplicate tensor(0.2160, dtype=torch.float64) tensor(-0.4493, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(0.2146, dtype=torch.float64)
12 gae_duplicate tensor(0.3873, dtype=torch.float64) tensor(-0.8053, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.2333, dtype=torch.float64)
11 gae_duplicate tensor(0.5431, dtype=torch.float64) tensor(-1.1296, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.2353, dtype=torch.float64)
10 gae_duplicate tensor(0.6698, dtype=torch.float64) tensor(-1.3927, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.2509, dtype=torch.float64)
9 gae_duplicate tensor(0.7868, dtype=torch.float64) tensor(-1.6358, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1177, dtype=torch.float64) delta_t tensor(0.1652, dtype=torch.float64)
8 gae_duplicate tensor(0.7947, dtype=torch.float64) tensor(-1.6531, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0723, dtype=torch.float64) delta_t tensor(-0.8614, dtype=torch.float64)
7 gae_duplicate tensor(-0.2257, dtype=torch.float64) tensor(0.4693, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5288, dtype=torch.float64) delta_t tensor(0.1303, dtype=torch.float64)
6 gae_duplicate tensor(-0.0503, dtype=torch.float64) tensor(0.1045, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7835, dtype=torch.float64) delta_t tensor(0.6693, dtype=torch.float64)
5 gae_duplicate tensor(0.6291, dtype=torch.float64) tensor(-1.3076, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1022, dtype=torch.float64) delta_t tensor(-2.3315, dtype=torch.float64)
4 gae_duplicate tensor(-1.8282, dtype=torch.float64) tensor(3.8033, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7245, dtype=torch.float64) delta_t tensor(0.5820, dtype=torch.float64)
3 gae_duplicate tensor(-0.8806, dtype=torch.float64) tensor(1.8315, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5992, dtype=torch.float64) delta_t tensor(-1.5285, dtype=torch.float64)
2 gae_duplicate tensor(-2.2330, dtype=torch.float64) tensor(4.6427, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-21.361793518066406
value loss:18.214309692382812
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.396175146102905 seconds
19 rew tensor(0.8112, dtype=torch.float64) delta_t tensor(-0.3355, dtype=torch.float64)
19 gae_duplicate tensor(-0.3355, dtype=torch.float64) tensor(0.6975, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8115, dtype=torch.float64) delta_t tensor(0.5911, dtype=torch.float64)
18 gae_duplicate tensor(0.3227, dtype=torch.float64) tensor(-0.6710, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(-0.0963, dtype=torch.float64)
17 gae_duplicate tensor(0.1618, dtype=torch.float64) tensor(-0.3365, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(-0.6955, dtype=torch.float64)
16 gae_duplicate tensor(-0.5661, dtype=torch.float64) tensor(1.1772, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8125, dtype=torch.float64) delta_t tensor(0.1569, dtype=torch.float64)
15 gae_duplicate tensor(-0.2959, dtype=torch.float64) tensor(0.6155, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(0.2076, dtype=torch.float64)
14 gae_duplicate tensor(-0.0291, dtype=torch.float64) tensor(0.0606, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.2682, dtype=torch.float64)
13 gae_duplicate tensor(0.2449, dtype=torch.float64) tensor(-0.5095, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(0.2945, dtype=torch.float64)
12 gae_duplicate tensor(0.4905, dtype=torch.float64) tensor(-1.0198, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.3692, dtype=torch.float64)
11 gae_duplicate tensor(0.7616, dtype=torch.float64) tensor(-1.5839, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.2455, dtype=torch.float64)
10 gae_duplicate tensor(0.8548, dtype=torch.float64) tensor(-1.7772, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0546, dtype=torch.float64) delta_t tensor(-0.6245, dtype=torch.float64)
9 gae_duplicate tensor(0.0593, dtype=torch.float64) tensor(-0.1234, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1353, dtype=torch.float64) delta_t tensor(-0.5783, dtype=torch.float64)
8 gae_duplicate tensor(-0.5308, dtype=torch.float64) tensor(1.1038, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0721, dtype=torch.float64) delta_t tensor(-0.3303, dtype=torch.float64)
7 gae_duplicate tensor(-0.7549, dtype=torch.float64) tensor(1.5695, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9579, dtype=torch.float64) delta_t tensor(0.5425, dtype=torch.float64)
6 gae_duplicate tensor(-0.0614, dtype=torch.float64) tensor(0.1277, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9708, dtype=torch.float64) delta_t tensor(0.3124, dtype=torch.float64)
5 gae_duplicate tensor(0.2633, dtype=torch.float64) tensor(-0.5474, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0998, dtype=torch.float64) delta_t tensor(-2.2620, dtype=torch.float64)
4 gae_duplicate tensor(-2.0514, dtype=torch.float64) tensor(4.2641, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7223, dtype=torch.float64) delta_t tensor(0.6562, dtype=torch.float64)
3 gae_duplicate tensor(-0.9849, dtype=torch.float64) tensor(2.0484, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.8508, dtype=torch.float64) delta_t tensor(-1.3660, dtype=torch.float64)
2 gae_duplicate tensor(-2.1539, dtype=torch.float64) tensor(4.4795, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-58.57548522949219
value loss:19.513290405273438
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.447943210601807 seconds
19 rew tensor(0.8108, dtype=torch.float64) delta_t tensor(-0.3775, dtype=torch.float64)
19 gae_duplicate tensor(-0.3775, dtype=torch.float64) tensor(0.7851, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8111, dtype=torch.float64) delta_t tensor(0.6217, dtype=torch.float64)
18 gae_duplicate tensor(0.3197, dtype=torch.float64) tensor(-0.6647, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8115, dtype=torch.float64) delta_t tensor(-0.1224, dtype=torch.float64)
17 gae_duplicate tensor(0.1333, dtype=torch.float64) tensor(-0.2773, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(0.3399, dtype=torch.float64)
16 gae_duplicate tensor(0.4466, dtype=torch.float64) tensor(-0.9291, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(-0.6694, dtype=torch.float64)
15 gae_duplicate tensor(-0.3121, dtype=torch.float64) tensor(0.6490, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8124, dtype=torch.float64) delta_t tensor(0.1826, dtype=torch.float64)
14 gae_duplicate tensor(-0.0671, dtype=torch.float64) tensor(0.1396, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(0.1921, dtype=torch.float64)
13 gae_duplicate tensor(0.1384, dtype=torch.float64) tensor(-0.2879, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.2517, dtype=torch.float64)
12 gae_duplicate tensor(0.3625, dtype=torch.float64) tensor(-0.7535, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(0.2321, dtype=torch.float64)
11 gae_duplicate tensor(0.5221, dtype=torch.float64) tensor(-1.0855, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(0.1354, dtype=torch.float64)
10 gae_duplicate tensor(0.5530, dtype=torch.float64) tensor(-1.1502, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.3294, dtype=torch.float64)
9 gae_duplicate tensor(0.7718, dtype=torch.float64) tensor(-1.6049, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.3778, dtype=torch.float64)
8 gae_duplicate tensor(0.9953, dtype=torch.float64) tensor(-2.0689, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8312, dtype=torch.float64) delta_t tensor(-1.8039, dtype=torch.float64)
7 gae_duplicate tensor(-1.0077, dtype=torch.float64) tensor(2.0956, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8949, dtype=torch.float64) delta_t tensor(0.8613, dtype=torch.float64)
6 gae_duplicate tensor(0.0551, dtype=torch.float64) tensor(-0.1146, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1485, dtype=torch.float64) delta_t tensor(0.5394, dtype=torch.float64)
5 gae_duplicate tensor(0.5835, dtype=torch.float64) tensor(-1.2136, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9721, dtype=torch.float64) delta_t tensor(0.3490, dtype=torch.float64)
4 gae_duplicate tensor(0.8158, dtype=torch.float64) tensor(-1.6967, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9744, dtype=torch.float64) delta_t tensor(-1.0476, dtype=torch.float64)
3 gae_duplicate tensor(-0.3949, dtype=torch.float64) tensor(0.8209, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7723, dtype=torch.float64) delta_t tensor(-0.9403, dtype=torch.float64)
2 gae_duplicate tensor(-1.2563, dtype=torch.float64) tensor(2.6133, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:27.336902618408203
value loss:9.956998825073242
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.322016000747681 seconds
19 rew tensor(0.8112, dtype=torch.float64) delta_t tensor(-0.3694, dtype=torch.float64)
19 gae_duplicate tensor(-0.3694, dtype=torch.float64) tensor(0.7682, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8115, dtype=torch.float64) delta_t tensor(0.5993, dtype=torch.float64)
18 gae_duplicate tensor(0.3038, dtype=torch.float64) tensor(-0.6317, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(-0.3579, dtype=torch.float64)
17 gae_duplicate tensor(-0.1149, dtype=torch.float64) tensor(0.2390, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(-0.5848, dtype=torch.float64)
16 gae_duplicate tensor(-0.6767, dtype=torch.float64) tensor(1.4069, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8124, dtype=torch.float64) delta_t tensor(0.2607, dtype=torch.float64)
15 gae_duplicate tensor(-0.2807, dtype=torch.float64) tensor(0.5837, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(0.2107, dtype=torch.float64)
14 gae_duplicate tensor(-0.0138, dtype=torch.float64) tensor(0.0287, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.2111, dtype=torch.float64)
13 gae_duplicate tensor(0.2000, dtype=torch.float64) tensor(-0.4160, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(0.2114, dtype=torch.float64)
12 gae_duplicate tensor(0.3714, dtype=torch.float64) tensor(-0.7724, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(0.2117, dtype=torch.float64)
11 gae_duplicate tensor(0.5089, dtype=torch.float64) tensor(-1.0583, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.1147, dtype=torch.float64)
10 gae_duplicate tensor(0.5218, dtype=torch.float64) tensor(-1.0851, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4340, dtype=torch.float64) delta_t tensor(-0.1999, dtype=torch.float64)
9 gae_duplicate tensor(0.2175, dtype=torch.float64) tensor(-0.4523, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0539, dtype=torch.float64) delta_t tensor(-0.4455, dtype=torch.float64)
8 gae_duplicate tensor(-0.2716, dtype=torch.float64) tensor(0.5645, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1996, dtype=torch.float64) delta_t tensor(-1.0000, dtype=torch.float64)
7 gae_duplicate tensor(-1.2172, dtype=torch.float64) tensor(2.5309, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6431, dtype=torch.float64) delta_t tensor(1.1739, dtype=torch.float64)
6 gae_duplicate tensor(0.2001, dtype=torch.float64) tensor(-0.4162, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8967, dtype=torch.float64) delta_t tensor(1.7557, dtype=torch.float64)
5 gae_duplicate tensor(1.9158, dtype=torch.float64) tensor(-3.9833, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7205, dtype=torch.float64) delta_t tensor(-0.6306, dtype=torch.float64)
4 gae_duplicate tensor(0.9021, dtype=torch.float64) tensor(-1.8764, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3419, dtype=torch.float64) delta_t tensor(-0.4564, dtype=torch.float64)
3 gae_duplicate tensor(0.2653, dtype=torch.float64) tensor(-0.5517, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0893, dtype=torch.float64) delta_t tensor(-0.0840, dtype=torch.float64)
2 gae_duplicate tensor(0.1282, dtype=torch.float64) tensor(-0.2666, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:31.205936431884766
value loss:11.552225112915039
entropies:37.42993927001953
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.9348)
ToM Target loss= tensor(306.2244)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.4384682178497314 seconds
19 rew tensor(0.6859, dtype=torch.float64) delta_t tensor(-0.2049, dtype=torch.float64)
19 gae_duplicate tensor(-0.2049, dtype=torch.float64) tensor(0.4262, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6226, dtype=torch.float64) delta_t tensor(0.4258, dtype=torch.float64)
18 gae_duplicate tensor(0.2618, dtype=torch.float64) tensor(-0.5443, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3691, dtype=torch.float64) delta_t tensor(-0.8915, dtype=torch.float64)
17 gae_duplicate tensor(-0.6820, dtype=torch.float64) tensor(1.4181, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.0748, dtype=torch.float64) delta_t tensor(-1.6017, dtype=torch.float64)
16 gae_duplicate tensor(-2.1474, dtype=torch.float64) tensor(4.4650, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.8359, dtype=torch.float64) delta_t tensor(-1.2623, dtype=torch.float64)
15 gae_duplicate tensor(-2.9802, dtype=torch.float64) tensor(6.1978, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8125, dtype=torch.float64) delta_t tensor(0.2284, dtype=torch.float64)
14 gae_duplicate tensor(-2.1557, dtype=torch.float64) tensor(4.4842, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(0.2287, dtype=torch.float64)
13 gae_duplicate tensor(-1.4958, dtype=torch.float64) tensor(3.1102, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.2291, dtype=torch.float64)
12 gae_duplicate tensor(-0.9676, dtype=torch.float64) tensor(2.0127, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.2294, dtype=torch.float64)
11 gae_duplicate tensor(-0.5447, dtype=torch.float64) tensor(1.1328, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.0137, dtype=torch.float64)
10 gae_duplicate tensor(-0.4220, dtype=torch.float64) tensor(0.8775, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5606, dtype=torch.float64) delta_t tensor(-0.0585, dtype=torch.float64)
9 gae_duplicate tensor(-0.3962, dtype=torch.float64) tensor(0.8237, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3706, dtype=torch.float64) delta_t tensor(-0.2725, dtype=torch.float64)
8 gae_duplicate tensor(-0.5895, dtype=torch.float64) tensor(1.2256, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0539, dtype=torch.float64) delta_t tensor(-0.4599, dtype=torch.float64)
7 gae_duplicate tensor(-0.9315, dtype=torch.float64) tensor(1.9376, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6429, dtype=torch.float64) delta_t tensor(0.9092, dtype=torch.float64)
6 gae_duplicate tensor(0.1640, dtype=torch.float64) tensor(-0.3410, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4665, dtype=torch.float64) delta_t tensor(0.0317, dtype=torch.float64)
5 gae_duplicate tensor(0.1629, dtype=torch.float64) tensor(-0.3387, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8478, dtype=torch.float64) delta_t tensor(-1.0975, dtype=torch.float64)
4 gae_duplicate tensor(-0.9672, dtype=torch.float64) tensor(2.0110, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8497, dtype=torch.float64) delta_t tensor(0.5455, dtype=torch.float64)
3 gae_duplicate tensor(-0.2283, dtype=torch.float64) tensor(0.4747, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.8517, dtype=torch.float64) delta_t tensor(-1.2181, dtype=torch.float64)
2 gae_duplicate tensor(-1.4007, dtype=torch.float64) tensor(2.9131, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-194.83993530273438
value loss:40.10929870605469
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.324165105819702 seconds
19 rew tensor(0.6874, dtype=torch.float64) delta_t tensor(-0.2707, dtype=torch.float64)
19 gae_duplicate tensor(-0.2707, dtype=torch.float64) tensor(0.5629, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6241, dtype=torch.float64) delta_t tensor(0.2289, dtype=torch.float64)
18 gae_duplicate tensor(0.0123, dtype=torch.float64) tensor(-0.0256, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4339, dtype=torch.float64) delta_t tensor(-0.5729, dtype=torch.float64)
17 gae_duplicate tensor(-0.5630, dtype=torch.float64) tensor(1.1709, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.0736, dtype=torch.float64) delta_t tensor(-1.6012, dtype=torch.float64)
16 gae_duplicate tensor(-2.0516, dtype=torch.float64) tensor(4.2668, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7714, dtype=torch.float64) delta_t tensor(-1.2376, dtype=torch.float64)
15 gae_duplicate tensor(-2.8788, dtype=torch.float64) tensor(5.9857, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.2286, dtype=torch.float64)
14 gae_duplicate tensor(-2.0744, dtype=torch.float64) tensor(4.3151, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.2290, dtype=torch.float64)
13 gae_duplicate tensor(-1.4306, dtype=torch.float64) tensor(2.9751, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.2293, dtype=torch.float64)
12 gae_duplicate tensor(-0.9152, dtype=torch.float64) tensor(1.9037, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.2296, dtype=torch.float64)
11 gae_duplicate tensor(-0.5026, dtype=torch.float64) tensor(1.0451, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.0805, dtype=torch.float64)
10 gae_duplicate tensor(-0.3216, dtype=torch.float64) tensor(0.6686, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6255, dtype=torch.float64) delta_t tensor(0.0202, dtype=torch.float64)
9 gae_duplicate tensor(-0.2371, dtype=torch.float64) tensor(0.4932, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3721, dtype=torch.float64) delta_t tensor(-0.2348, dtype=torch.float64)
8 gae_duplicate tensor(-0.4244, dtype=torch.float64) tensor(0.8825, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0553, dtype=torch.float64) delta_t tensor(-0.5687, dtype=torch.float64)
7 gae_duplicate tensor(-0.9083, dtype=torch.float64) tensor(1.8884, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7686, dtype=torch.float64) delta_t tensor(0.4770, dtype=torch.float64)
6 gae_duplicate tensor(-0.2496, dtype=torch.float64) tensor(0.5188, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4025, dtype=torch.float64) delta_t tensor(0.3390, dtype=torch.float64)
5 gae_duplicate tensor(0.1394, dtype=torch.float64) tensor(-0.2898, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8471, dtype=torch.float64) delta_t tensor(-1.0429, dtype=torch.float64)
4 gae_duplicate tensor(-0.9313, dtype=torch.float64) tensor(1.9365, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8491, dtype=torch.float64) delta_t tensor(0.5414, dtype=torch.float64)
3 gae_duplicate tensor(-0.2037, dtype=torch.float64) tensor(0.4234, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7241, dtype=torch.float64) delta_t tensor(-1.0449, dtype=torch.float64)
2 gae_duplicate tensor(-1.2078, dtype=torch.float64) tensor(2.5112, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-188.51828002929688
value loss:35.911842346191406
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.432949066162109 seconds
19 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(-0.2824, dtype=torch.float64)
19 gae_duplicate tensor(-0.2824, dtype=torch.float64) tensor(0.5873, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.5570, dtype=torch.float64)
18 gae_duplicate tensor(0.3311, dtype=torch.float64) tensor(-0.6883, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(-0.1408, dtype=torch.float64)
17 gae_duplicate tensor(0.1241, dtype=torch.float64) tensor(-0.2581, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(-0.1566, dtype=torch.float64)
16 gae_duplicate tensor(-0.0573, dtype=torch.float64) tensor(0.1192, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(-0.2378, dtype=torch.float64)
15 gae_duplicate tensor(-0.2837, dtype=torch.float64) tensor(0.5899, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.2150, dtype=torch.float64)
14 gae_duplicate tensor(-0.0120, dtype=torch.float64) tensor(0.0249, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(0.2343, dtype=torch.float64)
13 gae_duplicate tensor(0.2247, dtype=torch.float64) tensor(-0.4673, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8169, dtype=torch.float64) delta_t tensor(0.2832, dtype=torch.float64)
12 gae_duplicate tensor(0.4630, dtype=torch.float64) tensor(-0.9626, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8173, dtype=torch.float64) delta_t tensor(0.2624, dtype=torch.float64)
11 gae_duplicate tensor(0.6328, dtype=torch.float64) tensor(-1.3154, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8176, dtype=torch.float64) delta_t tensor(0.1304, dtype=torch.float64)
10 gae_duplicate tensor(0.6366, dtype=torch.float64) tensor(-1.3240, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3737, dtype=torch.float64) delta_t tensor(-0.1330, dtype=torch.float64)
9 gae_duplicate tensor(0.3763, dtype=torch.float64) tensor(-0.7822, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1835, dtype=torch.float64) delta_t tensor(-0.2804, dtype=torch.float64)
8 gae_duplicate tensor(0.0207, dtype=torch.float64) tensor(-0.0430, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7044, dtype=torch.float64) delta_t tensor(-1.5914, dtype=torch.float64)
7 gae_duplicate tensor(-1.5749, dtype=torch.float64) tensor(3.2761, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7681, dtype=torch.float64) delta_t tensor(1.0346, dtype=torch.float64)
6 gae_duplicate tensor(-0.2253, dtype=torch.float64) tensor(0.4684, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0220, dtype=torch.float64) delta_t tensor(0.5586, dtype=torch.float64)
5 gae_duplicate tensor(0.3784, dtype=torch.float64) tensor(-0.7866, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9737, dtype=torch.float64) delta_t tensor(0.2615, dtype=torch.float64)
4 gae_duplicate tensor(0.5642, dtype=torch.float64) tensor(-1.1734, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8490, dtype=torch.float64) delta_t tensor(-0.5876, dtype=torch.float64)
3 gae_duplicate tensor(-0.1363, dtype=torch.float64) tensor(0.2833, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8986, dtype=torch.float64) delta_t tensor(-1.0266, dtype=torch.float64)
2 gae_duplicate tensor(-1.1356, dtype=torch.float64) tensor(2.3623, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-0.5855813026428223
value loss:8.703246116638184
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.453565835952759 seconds
19 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(-0.1543, dtype=torch.float64)
19 gae_duplicate tensor(-0.1543, dtype=torch.float64) tensor(0.3209, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.6904, dtype=torch.float64)
18 gae_duplicate tensor(0.5670, dtype=torch.float64) tensor(-1.1792, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(-0.2214, dtype=torch.float64)
17 gae_duplicate tensor(0.2322, dtype=torch.float64) tensor(-0.4829, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(-0.6146, dtype=torch.float64)
16 gae_duplicate tensor(-0.4288, dtype=torch.float64) tensor(0.8916, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(0.2875, dtype=torch.float64)
15 gae_duplicate tensor(-0.0556, dtype=torch.float64) tensor(0.1156, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.2569, dtype=torch.float64)
14 gae_duplicate tensor(0.2124, dtype=torch.float64) tensor(-0.4417, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(0.2763, dtype=torch.float64)
13 gae_duplicate tensor(0.4462, dtype=torch.float64) tensor(-0.9278, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.2614, dtype=torch.float64)
12 gae_duplicate tensor(0.6183, dtype=torch.float64) tensor(-1.2856, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8173, dtype=torch.float64) delta_t tensor(0.2859, dtype=torch.float64)
11 gae_duplicate tensor(0.7806, dtype=torch.float64) tensor(-1.6237, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8176, dtype=torch.float64) delta_t tensor(0.1498, dtype=torch.float64)
10 gae_duplicate tensor(0.7742, dtype=torch.float64) tensor(-1.6101, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8179, dtype=torch.float64) delta_t tensor(0.3314, dtype=torch.float64)
9 gae_duplicate tensor(0.9508, dtype=torch.float64) tensor(-1.9768, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1837, dtype=torch.float64) delta_t tensor(-0.2497, dtype=torch.float64)
8 gae_duplicate tensor(0.5109, dtype=torch.float64) tensor(-1.0626, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8312, dtype=torch.float64) delta_t tensor(-1.7337, dtype=torch.float64)
7 gae_duplicate tensor(-1.3249, dtype=torch.float64) tensor(2.7547, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8950, dtype=torch.float64) delta_t tensor(1.0460, dtype=torch.float64)
6 gae_duplicate tensor(-0.0139, dtype=torch.float64) tensor(0.0289, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1491, dtype=torch.float64) delta_t tensor(0.4406, dtype=torch.float64)
5 gae_duplicate tensor(0.4295, dtype=torch.float64) tensor(-0.8929, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1012, dtype=torch.float64) delta_t tensor(0.2068, dtype=torch.float64)
4 gae_duplicate tensor(0.5504, dtype=torch.float64) tensor(-1.1449, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8499, dtype=torch.float64) delta_t tensor(-0.7386, dtype=torch.float64)
3 gae_duplicate tensor(-0.2983, dtype=torch.float64) tensor(0.6203, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7720, dtype=torch.float64) delta_t tensor(-0.6701, dtype=torch.float64)
2 gae_duplicate tensor(-0.9088, dtype=torch.float64) tensor(1.8895, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:34.91771697998047
value loss:10.116418838500977
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.403156042098999 seconds
19 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(-0.2740, dtype=torch.float64)
19 gae_duplicate tensor(-0.2740, dtype=torch.float64) tensor(0.5696, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.2248, dtype=torch.float64)
18 gae_duplicate tensor(0.0056, dtype=torch.float64) tensor(-0.0117, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.5350, dtype=torch.float64)
17 gae_duplicate tensor(0.5395, dtype=torch.float64) tensor(-1.1220, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(-0.6504, dtype=torch.float64)
16 gae_duplicate tensor(-0.2188, dtype=torch.float64) tensor(0.4552, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(0.3161, dtype=torch.float64)
15 gae_duplicate tensor(0.1410, dtype=torch.float64) tensor(-0.2932, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.2962, dtype=torch.float64)
14 gae_duplicate tensor(0.4090, dtype=torch.float64) tensor(-0.8504, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.2965, dtype=torch.float64)
13 gae_duplicate tensor(0.6237, dtype=torch.float64) tensor(-1.2968, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(0.2968, dtype=torch.float64)
12 gae_duplicate tensor(0.7958, dtype=torch.float64) tensor(-1.6550, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8171, dtype=torch.float64) delta_t tensor(0.2825, dtype=torch.float64)
11 gae_duplicate tensor(0.9192, dtype=torch.float64) tensor(-1.9116, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8174, dtype=torch.float64) delta_t tensor(0.2423, dtype=torch.float64)
10 gae_duplicate tensor(0.9776, dtype=torch.float64) tensor(-2.0332, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3733, dtype=torch.float64) delta_t tensor(-0.0575, dtype=torch.float64)
9 gae_duplicate tensor(0.7246, dtype=torch.float64) tensor(-1.5069, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1194, dtype=torch.float64) delta_t tensor(0.1481, dtype=torch.float64)
8 gae_duplicate tensor(0.7277, dtype=torch.float64) tensor(-1.5130, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0560, dtype=torch.float64) delta_t tensor(-0.7831, dtype=torch.float64)
7 gae_duplicate tensor(-0.2009, dtype=torch.float64) tensor(0.4176, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3400, dtype=torch.float64) delta_t tensor(0.0879, dtype=torch.float64)
6 gae_duplicate tensor(-0.0728, dtype=torch.float64) tensor(0.1514, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5313, dtype=torch.float64) delta_t tensor(1.6178, dtype=torch.float64)
5 gae_duplicate tensor(1.5595, dtype=torch.float64) tensor(-3.2426, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5960, dtype=torch.float64) delta_t tensor(-2.1018, dtype=torch.float64)
4 gae_duplicate tensor(-0.8542, dtype=torch.float64) tensor(1.7770, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3432, dtype=torch.float64) delta_t tensor(1.1589, dtype=torch.float64)
3 gae_duplicate tensor(0.4756, dtype=torch.float64) tensor(-0.9891, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3441, dtype=torch.float64) delta_t tensor(-1.3757, dtype=torch.float64)
2 gae_duplicate tensor(-0.9952, dtype=torch.float64) tensor(2.0687, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:64.79279327392578
value loss:13.354259490966797
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.8268)
ToM Target loss= tensor(306.0358)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.216073036193848 seconds
19 rew tensor(0.7522, dtype=torch.float64) delta_t tensor(-0.1216, dtype=torch.float64)
19 gae_duplicate tensor(-0.1216, dtype=torch.float64) tensor(0.2529, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6253, dtype=torch.float64) delta_t tensor(0.4875, dtype=torch.float64)
18 gae_duplicate tensor(0.3902, dtype=torch.float64) tensor(-0.8113, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4348, dtype=torch.float64) delta_t tensor(-0.8303, dtype=torch.float64)
17 gae_duplicate tensor(-0.5181, dtype=torch.float64) tensor(1.0778, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0537, dtype=torch.float64) delta_t tensor(-1.1031, dtype=torch.float64)
16 gae_duplicate tensor(-1.5175, dtype=torch.float64) tensor(3.1543, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.5816, dtype=torch.float64) delta_t tensor(-0.9139, dtype=torch.float64)
15 gae_duplicate tensor(-2.1279, dtype=torch.float64) tensor(4.4244, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.3165, dtype=torch.float64)
14 gae_duplicate tensor(-1.3859, dtype=torch.float64) tensor(2.8822, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(0.3168, dtype=torch.float64)
13 gae_duplicate tensor(-0.7919, dtype=torch.float64) tensor(1.6465, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.3171, dtype=torch.float64)
12 gae_duplicate tensor(-0.3164, dtype=torch.float64) tensor(0.6580, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(0.3174, dtype=torch.float64)
11 gae_duplicate tensor(0.0643, dtype=torch.float64) tensor(-0.1337, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8169, dtype=torch.float64) delta_t tensor(0.1035, dtype=torch.float64)
10 gae_duplicate tensor(0.1550, dtype=torch.float64) tensor(-0.3222, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6267, dtype=torch.float64) delta_t tensor(0.0989, dtype=torch.float64)
9 gae_duplicate tensor(0.2228, dtype=torch.float64) tensor(-0.4634, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3095, dtype=torch.float64) delta_t tensor(-0.1933, dtype=torch.float64)
8 gae_duplicate tensor(-0.0151, dtype=torch.float64) tensor(0.0314, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0713, dtype=torch.float64) delta_t tensor(-0.4235, dtype=torch.float64)
7 gae_duplicate tensor(-0.4355, dtype=torch.float64) tensor(0.9056, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8328, dtype=torch.float64) delta_t tensor(0.9727, dtype=torch.float64)
6 gae_duplicate tensor(0.6242, dtype=torch.float64) tensor(-1.2982, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7850, dtype=torch.float64) delta_t tensor(0.9275, dtype=torch.float64)
5 gae_duplicate tensor(1.4269, dtype=torch.float64) tensor(-2.9667, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9771, dtype=torch.float64) delta_t tensor(-2.3435, dtype=torch.float64)
4 gae_duplicate tensor(-1.2020, dtype=torch.float64) tensor(2.4991, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4711, dtype=torch.float64) delta_t tensor(1.1437, dtype=torch.float64)
3 gae_duplicate tensor(0.1821, dtype=torch.float64) tensor(-0.3786, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7264, dtype=torch.float64) delta_t tensor(-1.8370, dtype=torch.float64)
2 gae_duplicate tensor(-1.6913, dtype=torch.float64) tensor(3.5165, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-89.16900634765625
value loss:25.41916275024414
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.363758087158203 seconds
19 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.0238, dtype=torch.float64)
19 gae_duplicate tensor(0.0238, dtype=torch.float64) tensor(-0.0495, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.1049, dtype=torch.float64)
18 gae_duplicate tensor(0.1240, dtype=torch.float64) tensor(-0.2579, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(0.7680, dtype=torch.float64)
17 gae_duplicate tensor(0.8672, dtype=torch.float64) tensor(-1.8035, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(-0.9091, dtype=torch.float64)
16 gae_duplicate tensor(-0.2154, dtype=torch.float64) tensor(0.4478, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(0.2930, dtype=torch.float64)
15 gae_duplicate tensor(0.1206, dtype=torch.float64) tensor(-0.2509, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8169, dtype=torch.float64) delta_t tensor(0.2923, dtype=torch.float64)
14 gae_duplicate tensor(0.3889, dtype=torch.float64) tensor(-0.8089, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8172, dtype=torch.float64) delta_t tensor(0.2927, dtype=torch.float64)
13 gae_duplicate tensor(0.6037, dtype=torch.float64) tensor(-1.2560, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8175, dtype=torch.float64) delta_t tensor(0.2930, dtype=torch.float64)
12 gae_duplicate tensor(0.7759, dtype=torch.float64) tensor(-1.6138, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8178, dtype=torch.float64) delta_t tensor(0.3095, dtype=torch.float64)
11 gae_duplicate tensor(0.9303, dtype=torch.float64) tensor(-1.9347, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8182, dtype=torch.float64) delta_t tensor(0.2622, dtype=torch.float64)
10 gae_duplicate tensor(1.0064, dtype=torch.float64) tensor(-2.0930, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3739, dtype=torch.float64) delta_t tensor(-0.0616, dtype=torch.float64)
9 gae_duplicate tensor(0.7435, dtype=torch.float64) tensor(-1.5468, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1201, dtype=torch.float64) delta_t tensor(0.3265, dtype=torch.float64)
8 gae_duplicate tensor(0.9213, dtype=torch.float64) tensor(-1.9150, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1973, dtype=torch.float64) delta_t tensor(-0.9055, dtype=torch.float64)
7 gae_duplicate tensor(-0.1684, dtype=torch.float64) tensor(0.3503, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.7205, dtype=torch.float64) delta_t tensor(-0.1403, dtype=torch.float64)
6 gae_duplicate tensor(-0.2750, dtype=torch.float64) tensor(0.5716, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9125, dtype=torch.float64) delta_t tensor(0.8530, dtype=torch.float64)
5 gae_duplicate tensor(0.6330, dtype=torch.float64) tensor(-1.3165, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8510, dtype=torch.float64) delta_t tensor(-2.1328, dtype=torch.float64)
4 gae_duplicate tensor(-1.6264, dtype=torch.float64) tensor(3.3806, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5985, dtype=torch.float64) delta_t tensor(0.8894, dtype=torch.float64)
3 gae_duplicate tensor(-0.4117, dtype=torch.float64) tensor(0.8560, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3455, dtype=torch.float64) delta_t tensor(-1.5873, dtype=torch.float64)
2 gae_duplicate tensor(-1.9167, dtype=torch.float64) tensor(3.9861, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:30.400028228759766
value loss:18.32919692993164
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.35657811164856 seconds
19 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.2069, dtype=torch.float64)
19 gae_duplicate tensor(0.2069, dtype=torch.float64) tensor(-0.4305, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.4743, dtype=torch.float64)
18 gae_duplicate tensor(0.6398, dtype=torch.float64) tensor(-1.3303, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(-0.0967, dtype=torch.float64)
17 gae_duplicate tensor(0.4151, dtype=torch.float64) tensor(-0.8634, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(-0.3327, dtype=torch.float64)
16 gae_duplicate tensor(-0.0006, dtype=torch.float64) tensor(0.0013, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(0.1222, dtype=torch.float64)
15 gae_duplicate tensor(0.1217, dtype=torch.float64) tensor(-0.2531, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(0.2925, dtype=torch.float64)
14 gae_duplicate tensor(0.3898, dtype=torch.float64) tensor(-0.8105, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.2987, dtype=torch.float64)
13 gae_duplicate tensor(0.6106, dtype=torch.float64) tensor(-1.2702, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8173, dtype=torch.float64) delta_t tensor(0.3264, dtype=torch.float64)
12 gae_duplicate tensor(0.8149, dtype=torch.float64) tensor(-1.6943, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8176, dtype=torch.float64) delta_t tensor(0.4001, dtype=torch.float64)
11 gae_duplicate tensor(1.0520, dtype=torch.float64) tensor(-2.1873, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8179, dtype=torch.float64) delta_t tensor(0.1682, dtype=torch.float64)
10 gae_duplicate tensor(1.0098, dtype=torch.float64) tensor(-2.1001, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5005, dtype=torch.float64) delta_t tensor(0.0306, dtype=torch.float64)
9 gae_duplicate tensor(0.8385, dtype=torch.float64) tensor(-1.7438, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5007, dtype=torch.float64) delta_t tensor(0.0099, dtype=torch.float64)
8 gae_duplicate tensor(0.6806, dtype=torch.float64) tensor(-1.4154, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1832, dtype=torch.float64) delta_t tensor(-0.5456, dtype=torch.float64)
7 gae_duplicate tensor(-0.0011, dtype=torch.float64) tensor(0.0023, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7693, dtype=torch.float64) delta_t tensor(-0.4070, dtype=torch.float64)
6 gae_duplicate tensor(-0.4079, dtype=torch.float64) tensor(0.8485, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0236, dtype=torch.float64) delta_t tensor(1.5309, dtype=torch.float64)
5 gae_duplicate tensor(1.2046, dtype=torch.float64) tensor(-2.5047, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7225, dtype=torch.float64) delta_t tensor(-0.9259, dtype=torch.float64)
4 gae_duplicate tensor(0.0378, dtype=torch.float64) tensor(-0.0786, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7240, dtype=torch.float64) delta_t tensor(0.7825, dtype=torch.float64)
3 gae_duplicate tensor(0.8127, dtype=torch.float64) tensor(-1.6902, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4714, dtype=torch.float64) delta_t tensor(-0.5450, dtype=torch.float64)
2 gae_duplicate tensor(0.1051, dtype=torch.float64) tensor(-0.2186, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:105.31001281738281
value loss:11.116791725158691
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.633347988128662 seconds
19 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.1949, dtype=torch.float64)
19 gae_duplicate tensor(0.1949, dtype=torch.float64) tensor(-0.4053, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.4743, dtype=torch.float64)
18 gae_duplicate tensor(0.6302, dtype=torch.float64) tensor(-1.3104, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(-0.0628, dtype=torch.float64)
17 gae_duplicate tensor(0.4414, dtype=torch.float64) tensor(-0.9178, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(-0.0250, dtype=torch.float64)
16 gae_duplicate tensor(0.3281, dtype=torch.float64) tensor(-0.6826, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(-0.1188, dtype=torch.float64)
15 gae_duplicate tensor(0.1437, dtype=torch.float64) tensor(-0.2989, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(0.2850, dtype=torch.float64)
14 gae_duplicate tensor(0.3999, dtype=torch.float64) tensor(-0.8317, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.2870, dtype=torch.float64)
13 gae_duplicate tensor(0.6069, dtype=torch.float64) tensor(-1.2625, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8173, dtype=torch.float64) delta_t tensor(0.3065, dtype=torch.float64)
12 gae_duplicate tensor(0.7920, dtype=torch.float64) tensor(-1.6472, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8176, dtype=torch.float64) delta_t tensor(0.4275, dtype=torch.float64)
11 gae_duplicate tensor(1.0611, dtype=torch.float64) tensor(-2.2068, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8179, dtype=torch.float64) delta_t tensor(0.1135, dtype=torch.float64)
10 gae_duplicate tensor(0.9624, dtype=torch.float64) tensor(-2.0011, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4365, dtype=torch.float64) delta_t tensor(-0.0485, dtype=torch.float64)
9 gae_duplicate tensor(0.7215, dtype=torch.float64) tensor(-1.5005, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3730, dtype=torch.float64) delta_t tensor(-0.1232, dtype=torch.float64)
8 gae_duplicate tensor(0.4540, dtype=torch.float64) tensor(-0.9441, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0552, dtype=torch.float64) delta_t tensor(-0.5821, dtype=torch.float64)
7 gae_duplicate tensor(-0.2189, dtype=torch.float64) tensor(0.4552, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6441, dtype=torch.float64) delta_t tensor(-0.2988, dtype=torch.float64)
6 gae_duplicate tensor(-0.4739, dtype=torch.float64) tensor(0.9854, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8985, dtype=torch.float64) delta_t tensor(1.6977, dtype=torch.float64)
5 gae_duplicate tensor(1.3185, dtype=torch.float64) tensor(-2.7408, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5980, dtype=torch.float64) delta_t tensor(0.4349, dtype=torch.float64)
4 gae_duplicate tensor(1.4897, dtype=torch.float64) tensor(-3.0981, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4721, dtype=torch.float64) delta_t tensor(-0.0779, dtype=torch.float64)
3 gae_duplicate tensor(1.1139, dtype=torch.float64) tensor(-2.3160, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2188, dtype=torch.float64) delta_t tensor(-0.1970, dtype=torch.float64)
2 gae_duplicate tensor(0.6941, dtype=torch.float64) tensor(-1.4432, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:131.87478637695312
value loss:15.968218803405762
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.400782108306885 seconds
19 rew tensor(0.6892, dtype=torch.float64) delta_t tensor(0.0128, dtype=torch.float64)
19 gae_duplicate tensor(0.0128, dtype=torch.float64) tensor(-0.0266, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6257, dtype=torch.float64) delta_t tensor(0.3411, dtype=torch.float64)
18 gae_duplicate tensor(0.3513, dtype=torch.float64) tensor(-0.7305, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4348, dtype=torch.float64) delta_t tensor(-0.2444, dtype=torch.float64)
17 gae_duplicate tensor(0.0366, dtype=torch.float64) tensor(-0.0761, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.0110, dtype=torch.float64) delta_t tensor(-1.5682, dtype=torch.float64)
16 gae_duplicate tensor(-1.5389, dtype=torch.float64) tensor(3.2004, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7114, dtype=torch.float64) delta_t tensor(-0.9947, dtype=torch.float64)
15 gae_duplicate tensor(-2.2258, dtype=torch.float64) tensor(4.6300, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.3392, dtype=torch.float64)
14 gae_duplicate tensor(-1.4415, dtype=torch.float64) tensor(2.9964, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(0.3395, dtype=torch.float64)
13 gae_duplicate tensor(-0.8137, dtype=torch.float64) tensor(1.6923, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8171, dtype=torch.float64) delta_t tensor(0.3398, dtype=torch.float64)
12 gae_duplicate tensor(-0.3112, dtype=torch.float64) tensor(0.6472, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8174, dtype=torch.float64) delta_t tensor(0.3401, dtype=torch.float64)
11 gae_duplicate tensor(0.0911, dtype=torch.float64) tensor(-0.1893, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8177, dtype=torch.float64) delta_t tensor(0.0574, dtype=torch.float64)
10 gae_duplicate tensor(0.1303, dtype=torch.float64) tensor(-0.2709, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5634, dtype=torch.float64) delta_t tensor(0.0676, dtype=torch.float64)
9 gae_duplicate tensor(0.1718, dtype=torch.float64) tensor(-0.3571, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3726, dtype=torch.float64) delta_t tensor(-0.1994, dtype=torch.float64)
8 gae_duplicate tensor(-0.0620, dtype=torch.float64) tensor(0.1289, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0546, dtype=torch.float64) delta_t tensor(-0.4987, dtype=torch.float64)
7 gae_duplicate tensor(-0.5483, dtype=torch.float64) tensor(1.1404, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6452, dtype=torch.float64) delta_t tensor(-0.4504, dtype=torch.float64)
6 gae_duplicate tensor(-0.8890, dtype=torch.float64) tensor(1.8481, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2178, dtype=torch.float64) delta_t tensor(1.4140, dtype=torch.float64)
5 gae_duplicate tensor(0.7028, dtype=torch.float64) tensor(-1.4616, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6001, dtype=torch.float64) delta_t tensor(-0.7626, dtype=torch.float64)
4 gae_duplicate tensor(-0.2004, dtype=torch.float64) tensor(0.4166, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7287, dtype=torch.float64) delta_t tensor(0.8387, dtype=torch.float64)
3 gae_duplicate tensor(0.6784, dtype=torch.float64) tensor(-1.4105, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4755, dtype=torch.float64) delta_t tensor(-0.7619, dtype=torch.float64)
2 gae_duplicate tensor(-0.2192, dtype=torch.float64) tensor(0.4558, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-76.92461395263672
value loss:18.714109420776367
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.4893)
ToM Target loss= tensor(305.7518)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.609043121337891 seconds
19 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.2797, dtype=torch.float64)
19 gae_duplicate tensor(0.2797, dtype=torch.float64) tensor(-0.5815, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(0.7105, dtype=torch.float64)
18 gae_duplicate tensor(0.9342, dtype=torch.float64) tensor(-1.9428, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8169, dtype=torch.float64) delta_t tensor(-0.4055, dtype=torch.float64)
17 gae_duplicate tensor(0.3419, dtype=torch.float64) tensor(-0.7108, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8172, dtype=torch.float64) delta_t tensor(-0.0011, dtype=torch.float64)
16 gae_duplicate tensor(0.2724, dtype=torch.float64) tensor(-0.5663, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8175, dtype=torch.float64) delta_t tensor(-0.1785, dtype=torch.float64)
15 gae_duplicate tensor(0.0394, dtype=torch.float64) tensor(-0.0819, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8178, dtype=torch.float64) delta_t tensor(0.2764, dtype=torch.float64)
14 gae_duplicate tensor(0.3079, dtype=torch.float64) tensor(-0.6403, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8181, dtype=torch.float64) delta_t tensor(0.2919, dtype=torch.float64)
13 gae_duplicate tensor(0.5382, dtype=torch.float64) tensor(-1.1193, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8184, dtype=torch.float64) delta_t tensor(0.3002, dtype=torch.float64)
12 gae_duplicate tensor(0.7307, dtype=torch.float64) tensor(-1.5193, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8187, dtype=torch.float64) delta_t tensor(0.3093, dtype=torch.float64)
11 gae_duplicate tensor(0.8939, dtype=torch.float64) tensor(-1.8591, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8190, dtype=torch.float64) delta_t tensor(0.3235, dtype=torch.float64)
10 gae_duplicate tensor(1.0386, dtype=torch.float64) tensor(-2.1595, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8193, dtype=torch.float64) delta_t tensor(0.1691, dtype=torch.float64)
9 gae_duplicate tensor(1.0000, dtype=torch.float64) tensor(-2.0786, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1342, dtype=torch.float64) delta_t tensor(-0.0478, dtype=torch.float64)
8 gae_duplicate tensor(0.7522, dtype=torch.float64) tensor(-1.5646, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3249, dtype=torch.float64) delta_t tensor(-1.1595, dtype=torch.float64)
7 gae_duplicate tensor(-0.5577, dtype=torch.float64) tensor(1.1597, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.6596, dtype=torch.float64) delta_t tensor(0.1782, dtype=torch.float64)
6 gae_duplicate tensor(-0.2679, dtype=torch.float64) tensor(0.5573, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9153, dtype=torch.float64) delta_t tensor(-0.7293, dtype=torch.float64)
5 gae_duplicate tensor(-0.9436, dtype=torch.float64) tensor(1.9615, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3626, dtype=torch.float64) delta_t tensor(-1.5100, dtype=torch.float64)
4 gae_duplicate tensor(-2.2648, dtype=torch.float64) tensor(4.7080, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7292, dtype=torch.float64) delta_t tensor(0.9198, dtype=torch.float64)
3 gae_duplicate tensor(-0.8921, dtype=torch.float64) tensor(1.8548, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.8581, dtype=torch.float64) delta_t tensor(-1.1443, dtype=torch.float64)
2 gae_duplicate tensor(-1.8580, dtype=torch.float64) tensor(3.8640, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3.188931941986084
value loss:24.234432220458984
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.484142780303955 seconds
19 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(-0.0135, dtype=torch.float64)
19 gae_duplicate tensor(-0.0135, dtype=torch.float64) tensor(0.0281, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(0.7236, dtype=torch.float64)
18 gae_duplicate tensor(0.7128, dtype=torch.float64) tensor(-1.4824, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8171, dtype=torch.float64) delta_t tensor(-0.2372, dtype=torch.float64)
17 gae_duplicate tensor(0.3330, dtype=torch.float64) tensor(-0.6925, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8174, dtype=torch.float64) delta_t tensor(-0.5107, dtype=torch.float64)
16 gae_duplicate tensor(-0.2443, dtype=torch.float64) tensor(0.5081, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8177, dtype=torch.float64) delta_t tensor(0.3686, dtype=torch.float64)
15 gae_duplicate tensor(0.1731, dtype=torch.float64) tensor(-0.3600, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8179, dtype=torch.float64) delta_t tensor(0.3032, dtype=torch.float64)
14 gae_duplicate tensor(0.4417, dtype=torch.float64) tensor(-0.9185, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8182, dtype=torch.float64) delta_t tensor(0.3226, dtype=torch.float64)
13 gae_duplicate tensor(0.6760, dtype=torch.float64) tensor(-1.4055, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8185, dtype=torch.float64) delta_t tensor(0.3326, dtype=torch.float64)
12 gae_duplicate tensor(0.8734, dtype=torch.float64) tensor(-1.8165, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8188, dtype=torch.float64) delta_t tensor(0.3445, dtype=torch.float64)
11 gae_duplicate tensor(1.0433, dtype=torch.float64) tensor(-2.1696, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(0.1209, dtype=torch.float64)
10 gae_duplicate tensor(0.9555, dtype=torch.float64) tensor(-1.9871, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5014, dtype=torch.float64) delta_t tensor(-0.0269, dtype=torch.float64)
9 gae_duplicate tensor(0.7375, dtype=torch.float64) tensor(-1.5330, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3107, dtype=torch.float64) delta_t tensor(-0.1163, dtype=torch.float64)
8 gae_duplicate tensor(0.4737, dtype=torch.float64) tensor(-0.9851, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7066, dtype=torch.float64) delta_t tensor(-1.4755, dtype=torch.float64)
7 gae_duplicate tensor(-1.0966, dtype=torch.float64) tensor(2.2800, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7704, dtype=torch.float64) delta_t tensor(1.0197, dtype=torch.float64)
6 gae_duplicate tensor(0.1424, dtype=torch.float64) tensor(-0.2962, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0250, dtype=torch.float64) delta_t tensor(0.6519, dtype=torch.float64)
5 gae_duplicate tensor(0.7658, dtype=torch.float64) tensor(-1.5923, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9790, dtype=torch.float64) delta_t tensor(-1.0196, dtype=torch.float64)
4 gae_duplicate tensor(-0.4070, dtype=torch.float64) tensor(0.8466, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8539, dtype=torch.float64) delta_t tensor(0.5548, dtype=torch.float64)
3 gae_duplicate tensor(0.2292, dtype=torch.float64) tensor(-0.4765, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7737, dtype=torch.float64) delta_t tensor(-0.7610, dtype=torch.float64)
2 gae_duplicate tensor(-0.5777, dtype=torch.float64) tensor(1.2014, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:63.982177734375
value loss:10.88180160522461
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.579985857009888 seconds
19 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(-0.3800, dtype=torch.float64)
19 gae_duplicate tensor(-0.3800, dtype=torch.float64) tensor(0.7903, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(0.1763, dtype=torch.float64)
18 gae_duplicate tensor(-0.1277, dtype=torch.float64) tensor(0.2655, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.2553, dtype=torch.float64)
17 gae_duplicate tensor(0.1532, dtype=torch.float64) tensor(-0.3186, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8173, dtype=torch.float64) delta_t tensor(-0.5563, dtype=torch.float64)
16 gae_duplicate tensor(-0.4337, dtype=torch.float64) tensor(0.9018, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8176, dtype=torch.float64) delta_t tensor(0.3646, dtype=torch.float64)
15 gae_duplicate tensor(0.0177, dtype=torch.float64) tensor(-0.0367, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8179, dtype=torch.float64) delta_t tensor(0.2720, dtype=torch.float64)
14 gae_duplicate tensor(0.2862, dtype=torch.float64) tensor(-0.5950, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8182, dtype=torch.float64) delta_t tensor(0.2723, dtype=torch.float64)
13 gae_duplicate tensor(0.5013, dtype=torch.float64) tensor(-1.0427, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8185, dtype=torch.float64) delta_t tensor(0.3092, dtype=torch.float64)
12 gae_duplicate tensor(0.7102, dtype=torch.float64) tensor(-1.4770, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8187, dtype=torch.float64) delta_t tensor(0.3218, dtype=torch.float64)
11 gae_duplicate tensor(0.8900, dtype=torch.float64) tensor(-1.8512, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8190, dtype=torch.float64) delta_t tensor(0.0668, dtype=torch.float64)
10 gae_duplicate tensor(0.7788, dtype=torch.float64) tensor(-1.6195, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8193, dtype=torch.float64) delta_t tensor(0.2555, dtype=torch.float64)
9 gae_duplicate tensor(0.8785, dtype=torch.float64) tensor(-1.8263, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1836, dtype=torch.float64) delta_t tensor(-0.3901, dtype=torch.float64)
8 gae_duplicate tensor(0.3127, dtype=torch.float64) tensor(-0.6503, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4522, dtype=torch.float64) delta_t tensor(-0.9775, dtype=torch.float64)
7 gae_duplicate tensor(-0.7273, dtype=torch.float64) tensor(1.5121, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4523, dtype=torch.float64) delta_t tensor(1.3310, dtype=torch.float64)
6 gae_duplicate tensor(0.7492, dtype=torch.float64) tensor(-1.5585, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8974, dtype=torch.float64) delta_t tensor(0.5576, dtype=torch.float64)
5 gae_duplicate tensor(1.1570, dtype=torch.float64) tensor(-2.4056, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1054, dtype=torch.float64) delta_t tensor(-1.3298, dtype=torch.float64)
4 gae_duplicate tensor(-0.4042, dtype=torch.float64) tensor(0.8407, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8534, dtype=torch.float64) delta_t tensor(0.7109, dtype=torch.float64)
3 gae_duplicate tensor(0.3875, dtype=torch.float64) tensor(-0.8061, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2188, dtype=torch.float64) delta_t tensor(-2.4554, dtype=torch.float64)
2 gae_duplicate tensor(-2.1454, dtype=torch.float64) tensor(4.4617, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:31.369571685791016
value loss:16.23502540588379
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.349122047424316 seconds
19 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(-0.1349, dtype=torch.float64)
19 gae_duplicate tensor(-0.1349, dtype=torch.float64) tensor(0.2805, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(0.6123, dtype=torch.float64)
18 gae_duplicate tensor(0.5044, dtype=torch.float64) tensor(-1.0490, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8171, dtype=torch.float64) delta_t tensor(-0.4181, dtype=torch.float64)
17 gae_duplicate tensor(-0.0146, dtype=torch.float64) tensor(0.0303, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8174, dtype=torch.float64) delta_t tensor(-0.3363, dtype=torch.float64)
16 gae_duplicate tensor(-0.3480, dtype=torch.float64) tensor(0.7236, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8177, dtype=torch.float64) delta_t tensor(0.3598, dtype=torch.float64)
15 gae_duplicate tensor(0.0814, dtype=torch.float64) tensor(-0.1692, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8180, dtype=torch.float64) delta_t tensor(0.2848, dtype=torch.float64)
14 gae_duplicate tensor(0.3499, dtype=torch.float64) tensor(-0.7276, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8183, dtype=torch.float64) delta_t tensor(0.2851, dtype=torch.float64)
13 gae_duplicate tensor(0.5650, dtype=torch.float64) tensor(-1.1746, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8186, dtype=torch.float64) delta_t tensor(0.3235, dtype=torch.float64)
12 gae_duplicate tensor(0.7755, dtype=torch.float64) tensor(-1.6128, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8189, dtype=torch.float64) delta_t tensor(0.3389, dtype=torch.float64)
11 gae_duplicate tensor(0.9593, dtype=torch.float64) tensor(-1.9950, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(0.0471, dtype=torch.float64)
10 gae_duplicate tensor(0.8145, dtype=torch.float64) tensor(-1.6940, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4374, dtype=torch.float64) delta_t tensor(-0.1290, dtype=torch.float64)
9 gae_duplicate tensor(0.5226, dtype=torch.float64) tensor(-1.0864, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1828, dtype=torch.float64) delta_t tensor(-0.2771, dtype=torch.float64)
8 gae_duplicate tensor(0.1410, dtype=torch.float64) tensor(-0.2933, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0718, dtype=torch.float64) delta_t tensor(-0.7142, dtype=torch.float64)
7 gae_duplicate tensor(-0.6014, dtype=torch.float64) tensor(1.2507, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6446, dtype=torch.float64) delta_t tensor(-0.1945, dtype=torch.float64)
6 gae_duplicate tensor(-0.6756, dtype=torch.float64) tensor(1.4053, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8993, dtype=torch.float64) delta_t tensor(1.6800, dtype=torch.float64)
5 gae_duplicate tensor(1.1395, dtype=torch.float64) tensor(-2.3697, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5996, dtype=torch.float64) delta_t tensor(-0.1754, dtype=torch.float64)
4 gae_duplicate tensor(0.7362, dtype=torch.float64) tensor(-1.5307, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3462, dtype=torch.float64) delta_t tensor(0.4417, dtype=torch.float64)
3 gae_duplicate tensor(1.0306, dtype=torch.float64) tensor(-2.1429, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0924, dtype=torch.float64) delta_t tensor(-0.0487, dtype=torch.float64)
2 gae_duplicate tensor(0.7758, dtype=torch.float64) tensor(-1.6132, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:81.48334503173828
value loss:11.464458465576172
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.489439964294434 seconds
19 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(-0.5325, dtype=torch.float64)
19 gae_duplicate tensor(-0.5325, dtype=torch.float64) tensor(1.1075, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.6753, dtype=torch.float64)
18 gae_duplicate tensor(0.2493, dtype=torch.float64) tensor(-0.5185, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(-0.1315, dtype=torch.float64)
17 gae_duplicate tensor(0.0680, dtype=torch.float64) tensor(-0.1413, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8171, dtype=torch.float64) delta_t tensor(-0.5616, dtype=torch.float64)
16 gae_duplicate tensor(-0.5072, dtype=torch.float64) tensor(1.0548, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8174, dtype=torch.float64) delta_t tensor(0.2932, dtype=torch.float64)
15 gae_duplicate tensor(-0.1126, dtype=torch.float64) tensor(0.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8177, dtype=torch.float64) delta_t tensor(0.2459, dtype=torch.float64)
14 gae_duplicate tensor(0.1559, dtype=torch.float64) tensor(-0.3242, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8180, dtype=torch.float64) delta_t tensor(0.2829, dtype=torch.float64)
13 gae_duplicate tensor(0.4076, dtype=torch.float64) tensor(-0.8477, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8182, dtype=torch.float64) delta_t tensor(0.2538, dtype=torch.float64)
12 gae_duplicate tensor(0.5799, dtype=torch.float64) tensor(-1.2056, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8185, dtype=torch.float64) delta_t tensor(0.2955, dtype=torch.float64)
11 gae_duplicate tensor(0.7594, dtype=torch.float64) tensor(-1.5790, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8188, dtype=torch.float64) delta_t tensor(0.0823, dtype=torch.float64)
10 gae_duplicate tensor(0.6899, dtype=torch.float64) tensor(-1.4347, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(0.2528, dtype=torch.float64)
9 gae_duplicate tensor(0.8047, dtype=torch.float64) tensor(-1.6735, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2467, dtype=torch.float64) delta_t tensor(-0.0915, dtype=torch.float64)
8 gae_duplicate tensor(0.5523, dtype=torch.float64) tensor(-1.1485, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0713, dtype=torch.float64) delta_t tensor(-0.8951, dtype=torch.float64)
7 gae_duplicate tensor(-0.4533, dtype=torch.float64) tensor(0.9425, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1525, dtype=torch.float64) delta_t tensor(0.7471, dtype=torch.float64)
6 gae_duplicate tensor(0.3845, dtype=torch.float64) tensor(-0.7992, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4075, dtype=torch.float64) delta_t tensor(-0.0215, dtype=torch.float64)
5 gae_duplicate tensor(0.2861, dtype=torch.float64) tensor(-0.5950, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2355, dtype=torch.float64) delta_t tensor(-1.4461, dtype=torch.float64)
4 gae_duplicate tensor(-1.2172, dtype=torch.float64) tensor(2.5310, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9836, dtype=torch.float64) delta_t tensor(0.5376, dtype=torch.float64)
3 gae_duplicate tensor(-0.4362, dtype=torch.float64) tensor(0.9068, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7308, dtype=torch.float64) delta_t tensor(-0.7305, dtype=torch.float64)
2 gae_duplicate tensor(-1.0794, dtype=torch.float64) tensor(2.2448, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:6.352878570556641
value loss:9.636773109436035
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.8868)
ToM Target loss= tensor(306.0499)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.437981843948364 seconds
19 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(-0.1026, dtype=torch.float64)
19 gae_duplicate tensor(-0.1026, dtype=torch.float64) tensor(0.2134, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.6659, dtype=torch.float64)
18 gae_duplicate tensor(0.5838, dtype=torch.float64) tensor(-1.2139, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(-0.3427, dtype=torch.float64)
17 gae_duplicate tensor(0.1243, dtype=torch.float64) tensor(-0.2585, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(-0.5799, dtype=torch.float64)
16 gae_duplicate tensor(-0.4804, dtype=torch.float64) tensor(0.9987, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.3052, dtype=torch.float64)
15 gae_duplicate tensor(-0.0791, dtype=torch.float64) tensor(0.1645, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8172, dtype=torch.float64) delta_t tensor(0.2525, dtype=torch.float64)
14 gae_duplicate tensor(0.1892, dtype=torch.float64) tensor(-0.3933, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8175, dtype=torch.float64) delta_t tensor(0.2527, dtype=torch.float64)
13 gae_duplicate tensor(0.4041, dtype=torch.float64) tensor(-0.8402, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8178, dtype=torch.float64) delta_t tensor(0.2530, dtype=torch.float64)
12 gae_duplicate tensor(0.5763, dtype=torch.float64) tensor(-1.1982, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8181, dtype=torch.float64) delta_t tensor(0.2533, dtype=torch.float64)
11 gae_duplicate tensor(0.7143, dtype=torch.float64) tensor(-1.4853, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8184, dtype=torch.float64) delta_t tensor(0.2681, dtype=torch.float64)
10 gae_duplicate tensor(0.8395, dtype=torch.float64) tensor(-1.7456, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8186, dtype=torch.float64) delta_t tensor(0.0810, dtype=torch.float64)
9 gae_duplicate tensor(0.7526, dtype=torch.float64) tensor(-1.5652, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1345, dtype=torch.float64) delta_t tensor(-0.3079, dtype=torch.float64)
8 gae_duplicate tensor(0.2942, dtype=torch.float64) tensor(-0.6119, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3251, dtype=torch.float64) delta_t tensor(-0.8579, dtype=torch.float64)
7 gae_duplicate tensor(-0.6225, dtype=torch.float64) tensor(1.2944, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5323, dtype=torch.float64) delta_t tensor(0.3382, dtype=torch.float64)
6 gae_duplicate tensor(-0.1598, dtype=torch.float64) tensor(0.3323, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0418, dtype=torch.float64) delta_t tensor(0.1622, dtype=torch.float64)
5 gae_duplicate tensor(0.0343, dtype=torch.float64) tensor(-0.0714, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3620, dtype=torch.float64) delta_t tensor(-2.2986, dtype=torch.float64)
4 gae_duplicate tensor(-2.2711, dtype=torch.float64) tensor(4.7213, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6014, dtype=torch.float64) delta_t tensor(1.0583, dtype=torch.float64)
3 gae_duplicate tensor(-0.7586, dtype=torch.float64) tensor(1.5776, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7299, dtype=torch.float64) delta_t tensor(-1.4657, dtype=torch.float64)
2 gae_duplicate tensor(-2.0726, dtype=torch.float64) tensor(4.3103, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-26.49659538269043
value loss:20.169597625732422
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.319283962249756 seconds
19 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(-0.3339, dtype=torch.float64)
19 gae_duplicate tensor(-0.3339, dtype=torch.float64) tensor(0.6942, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.5945, dtype=torch.float64)
18 gae_duplicate tensor(0.3274, dtype=torch.float64) tensor(-0.6810, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(-0.1980, dtype=torch.float64)
17 gae_duplicate tensor(0.0639, dtype=torch.float64) tensor(-0.1329, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(-0.6040, dtype=torch.float64)
16 gae_duplicate tensor(-0.5529, dtype=torch.float64) tensor(1.1498, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.2959, dtype=torch.float64)
15 gae_duplicate tensor(-0.1464, dtype=torch.float64) tensor(0.3045, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.2387, dtype=torch.float64)
14 gae_duplicate tensor(0.1216, dtype=torch.float64) tensor(-0.2530, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(0.2390, dtype=torch.float64)
13 gae_duplicate tensor(0.3363, dtype=torch.float64) tensor(-0.6992, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.2728, dtype=torch.float64)
12 gae_duplicate tensor(0.5419, dtype=torch.float64) tensor(-1.1272, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8173, dtype=torch.float64) delta_t tensor(0.3317, dtype=torch.float64)
11 gae_duplicate tensor(0.7653, dtype=torch.float64) tensor(-1.5917, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8176, dtype=torch.float64) delta_t tensor(0.0162, dtype=torch.float64)
10 gae_duplicate tensor(0.6284, dtype=torch.float64) tensor(-1.3066, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8179, dtype=torch.float64) delta_t tensor(0.2301, dtype=torch.float64)
9 gae_duplicate tensor(0.7328, dtype=torch.float64) tensor(-1.5238, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.8182, dtype=torch.float64) delta_t tensor(0.4586, dtype=torch.float64)
8 gae_duplicate tensor(1.0449, dtype=torch.float64) tensor(-2.1726, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0564, dtype=torch.float64) delta_t tensor(-0.8330, dtype=torch.float64)
7 gae_duplicate tensor(0.0029, dtype=torch.float64) tensor(-0.0061, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1499, dtype=torch.float64) delta_t tensor(0.7965, dtype=torch.float64)
6 gae_duplicate tensor(0.7988, dtype=torch.float64) tensor(-1.6610, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4045, dtype=torch.float64) delta_t tensor(0.0276, dtype=torch.float64)
5 gae_duplicate tensor(0.6667, dtype=torch.float64) tensor(-1.3865, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2310, dtype=torch.float64) delta_t tensor(-1.3908, dtype=torch.float64)
4 gae_duplicate tensor(-0.8575, dtype=torch.float64) tensor(1.7832, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9795, dtype=torch.float64) delta_t tensor(0.5531, dtype=torch.float64)
3 gae_duplicate tensor(-0.1328, dtype=torch.float64) tensor(0.2762, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7271, dtype=torch.float64) delta_t tensor(-0.8447, dtype=torch.float64)
2 gae_duplicate tensor(-0.9510, dtype=torch.float64) tensor(1.9780, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:37.01082992553711
value loss:9.481048583984375
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4002158641815186 seconds
19 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(-0.2307, dtype=torch.float64)
19 gae_duplicate tensor(-0.2307, dtype=torch.float64) tensor(0.4796, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.6415, dtype=torch.float64)
18 gae_duplicate tensor(0.4570, dtype=torch.float64) tensor(-0.9500, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(-0.5855, dtype=torch.float64)
17 gae_duplicate tensor(-0.2199, dtype=torch.float64) tensor(0.4573, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(-0.3060, dtype=torch.float64)
16 gae_duplicate tensor(-0.4819, dtype=torch.float64) tensor(1.0020, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.1992, dtype=torch.float64)
15 gae_duplicate tensor(-0.1864, dtype=torch.float64) tensor(0.3875, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(0.2328, dtype=torch.float64)
14 gae_duplicate tensor(0.0837, dtype=torch.float64) tensor(-0.1740, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(0.2414, dtype=torch.float64)
13 gae_duplicate tensor(0.3084, dtype=torch.float64) tensor(-0.6412, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.2817, dtype=torch.float64)
12 gae_duplicate tensor(0.5284, dtype=torch.float64) tensor(-1.0991, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8172, dtype=torch.float64) delta_t tensor(0.3462, dtype=torch.float64)
11 gae_duplicate tensor(0.7689, dtype=torch.float64) tensor(-1.5987, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8175, dtype=torch.float64) delta_t tensor(-0.0048, dtype=torch.float64)
10 gae_duplicate tensor(0.6103, dtype=torch.float64) tensor(-1.2693, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4362, dtype=torch.float64) delta_t tensor(-0.1003, dtype=torch.float64)
9 gae_duplicate tensor(0.3880, dtype=torch.float64) tensor(-0.8066, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3728, dtype=torch.float64) delta_t tensor(-0.1678, dtype=torch.float64)
8 gae_duplicate tensor(0.1426, dtype=torch.float64) tensor(-0.2966, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0550, dtype=torch.float64) delta_t tensor(-0.6565, dtype=torch.float64)
7 gae_duplicate tensor(-0.5424, dtype=torch.float64) tensor(1.1280, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6442, dtype=torch.float64) delta_t tensor(-0.3544, dtype=torch.float64)
6 gae_duplicate tensor(-0.7883, dtype=torch.float64) tensor(1.6395, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8986, dtype=torch.float64) delta_t tensor(1.8244, dtype=torch.float64)
5 gae_duplicate tensor(1.1937, dtype=torch.float64) tensor(-2.4821, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4709, dtype=torch.float64) delta_t tensor(-0.4657, dtype=torch.float64)
4 gae_duplicate tensor(0.4893, dtype=torch.float64) tensor(-1.0174, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3447, dtype=torch.float64) delta_t tensor(0.8806, dtype=torch.float64)
3 gae_duplicate tensor(1.2720, dtype=torch.float64) tensor(-2.6453, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0911, dtype=torch.float64) delta_t tensor(-0.1801, dtype=torch.float64)
2 gae_duplicate tensor(0.8375, dtype=torch.float64) tensor(-1.7420, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:56.647438049316406
value loss:10.489278793334961
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.466684103012085 seconds
19 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(-1.2083, dtype=torch.float64)
19 gae_duplicate tensor(-1.2083, dtype=torch.float64) tensor(2.5129, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(1.1494, dtype=torch.float64)
18 gae_duplicate tensor(0.1827, dtype=torch.float64) tensor(-0.3798, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(-0.7213, dtype=torch.float64)
17 gae_duplicate tensor(-0.5752, dtype=torch.float64) tensor(1.1959, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(-0.3101, dtype=torch.float64)
16 gae_duplicate tensor(-0.7703, dtype=torch.float64) tensor(1.6015, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.6662, dtype=torch.float64)
15 gae_duplicate tensor(0.0500, dtype=torch.float64) tensor(-0.1040, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(0.2780, dtype=torch.float64)
14 gae_duplicate tensor(0.3180, dtype=torch.float64) tensor(-0.6613, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(0.2783, dtype=torch.float64)
13 gae_duplicate tensor(0.5327, dtype=torch.float64) tensor(-1.1078, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.2786, dtype=torch.float64)
12 gae_duplicate tensor(0.7047, dtype=torch.float64) tensor(-1.4653, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8172, dtype=torch.float64) delta_t tensor(0.2788, dtype=torch.float64)
11 gae_duplicate tensor(0.8426, dtype=torch.float64) tensor(-1.7517, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8175, dtype=torch.float64) delta_t tensor(-0.2120, dtype=torch.float64)
10 gae_duplicate tensor(0.4620, dtype=torch.float64) tensor(-0.9607, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0093, dtype=torch.float64) delta_t tensor(-0.6240, dtype=torch.float64)
9 gae_duplicate tensor(-0.2544, dtype=torch.float64) tensor(0.5291, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4996, dtype=torch.float64) delta_t tensor(-0.1723, dtype=torch.float64)
8 gae_duplicate tensor(-0.3758, dtype=torch.float64) tensor(0.7815, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1817, dtype=torch.float64) delta_t tensor(-0.3782, dtype=torch.float64)
7 gae_duplicate tensor(-0.6788, dtype=torch.float64) tensor(1.4114, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3906, dtype=torch.float64) delta_t tensor(-0.5005, dtype=torch.float64)
6 gae_duplicate tensor(-1.0435, dtype=torch.float64) tensor(2.1694, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2172, dtype=torch.float64) delta_t tensor(0.4966, dtype=torch.float64)
5 gae_duplicate tensor(-0.3382, dtype=torch.float64) tensor(0.7034, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4722, dtype=torch.float64) delta_t tensor(0.2873, dtype=torch.float64)
4 gae_duplicate tensor(0.0167, dtype=torch.float64) tensor(-0.0346, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8547, dtype=torch.float64) delta_t tensor(0.6569, dtype=torch.float64)
3 gae_duplicate tensor(0.6702, dtype=torch.float64) tensor(-1.3933, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6019, dtype=torch.float64) delta_t tensor(-0.7150, dtype=torch.float64)
2 gae_duplicate tensor(-0.1789, dtype=torch.float64) tensor(0.3721, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-21.635263442993164
value loss:9.864604949951172
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.393953084945679 seconds
19 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(-0.6969, dtype=torch.float64)
19 gae_duplicate tensor(-0.6969, dtype=torch.float64) tensor(1.4490, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.6157, dtype=torch.float64)
18 gae_duplicate tensor(0.0582, dtype=torch.float64) tensor(-0.1211, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(-0.2421, dtype=torch.float64)
17 gae_duplicate tensor(-0.1955, dtype=torch.float64) tensor(0.4065, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(-0.7140, dtype=torch.float64)
16 gae_duplicate tensor(-0.8704, dtype=torch.float64) tensor(1.8098, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(0.3012, dtype=torch.float64)
15 gae_duplicate tensor(-0.3952, dtype=torch.float64) tensor(0.8217, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.1889, dtype=torch.float64)
14 gae_duplicate tensor(-0.1273, dtype=torch.float64) tensor(0.2646, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.2381, dtype=torch.float64)
13 gae_duplicate tensor(0.1363, dtype=torch.float64) tensor(-0.2835, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(0.1992, dtype=torch.float64)
12 gae_duplicate tensor(0.3083, dtype=torch.float64) tensor(-0.6411, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.1995, dtype=torch.float64)
11 gae_duplicate tensor(0.4461, dtype=torch.float64) tensor(-0.9276, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8173, dtype=torch.float64) delta_t tensor(-0.0254, dtype=torch.float64)
10 gae_duplicate tensor(0.3315, dtype=torch.float64) tensor(-0.6892, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8176, dtype=torch.float64) delta_t tensor(0.1717, dtype=torch.float64)
9 gae_duplicate tensor(0.4369, dtype=torch.float64) tensor(-0.9085, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2454, dtype=torch.float64) delta_t tensor(-0.1710, dtype=torch.float64)
8 gae_duplicate tensor(0.1785, dtype=torch.float64) tensor(-0.3711, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0725, dtype=torch.float64) delta_t tensor(-0.9608, dtype=torch.float64)
7 gae_duplicate tensor(-0.8180, dtype=torch.float64) tensor(1.7010, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0261, dtype=torch.float64) delta_t tensor(0.9175, dtype=torch.float64)
6 gae_duplicate tensor(0.2631, dtype=torch.float64) tensor(-0.5470, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2809, dtype=torch.float64) delta_t tensor(0.1403, dtype=torch.float64)
5 gae_duplicate tensor(0.3507, dtype=torch.float64) tensor(-0.7294, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1082, dtype=torch.float64) delta_t tensor(-1.3453, dtype=torch.float64)
4 gae_duplicate tensor(-1.0647, dtype=torch.float64) tensor(2.2141, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8559, dtype=torch.float64) delta_t tensor(0.6473, dtype=torch.float64)
3 gae_duplicate tensor(-0.2044, dtype=torch.float64) tensor(0.4252, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6030, dtype=torch.float64) delta_t tensor(-0.6045, dtype=torch.float64)
2 gae_duplicate tensor(-0.7681, dtype=torch.float64) tensor(1.5967, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-33.94464874267578
value loss:7.093743324279785
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.9963)
ToM Target loss= tensor(305.8970)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.446027994155884 seconds
19 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(-0.6795, dtype=torch.float64)
19 gae_duplicate tensor(-0.6795, dtype=torch.float64) tensor(1.4128, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.3078, dtype=torch.float64)
18 gae_duplicate tensor(-0.2358, dtype=torch.float64) tensor(0.4902, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(-0.0524, dtype=torch.float64)
17 gae_duplicate tensor(-0.2410, dtype=torch.float64) tensor(0.5012, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(-0.7342, dtype=torch.float64)
16 gae_duplicate tensor(-0.9270, dtype=torch.float64) tensor(1.9281, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(0.2292, dtype=torch.float64)
15 gae_duplicate tensor(-0.5124, dtype=torch.float64) tensor(1.0657, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.1655, dtype=torch.float64)
14 gae_duplicate tensor(-0.2444, dtype=torch.float64) tensor(0.5082, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(0.1657, dtype=torch.float64)
13 gae_duplicate tensor(-0.0298, dtype=torch.float64) tensor(0.0619, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(0.1660, dtype=torch.float64)
12 gae_duplicate tensor(0.1422, dtype=torch.float64) tensor(-0.2956, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8171, dtype=torch.float64) delta_t tensor(0.2054, dtype=torch.float64)
11 gae_duplicate tensor(0.3192, dtype=torch.float64) tensor(-0.6638, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8174, dtype=torch.float64) delta_t tensor(0.0544, dtype=torch.float64)
10 gae_duplicate tensor(0.3097, dtype=torch.float64) tensor(-0.6442, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8177, dtype=torch.float64) delta_t tensor(0.2494, dtype=torch.float64)
9 gae_duplicate tensor(0.4971, dtype=torch.float64) tensor(-1.0339, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0548, dtype=torch.float64) delta_t tensor(-0.3504, dtype=torch.float64)
8 gae_duplicate tensor(0.0473, dtype=torch.float64) tensor(-0.0983, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8354, dtype=torch.float64) delta_t tensor(-1.8098, dtype=torch.float64)
7 gae_duplicate tensor(-1.7719, dtype=torch.float64) tensor(3.6856, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0264, dtype=torch.float64) delta_t tensor(0.9768, dtype=torch.float64)
6 gae_duplicate tensor(-0.4408, dtype=torch.float64) tensor(0.9165, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2811, dtype=torch.float64) delta_t tensor(0.4262, dtype=torch.float64)
5 gae_duplicate tensor(0.0735, dtype=torch.float64) tensor(-0.1530, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1085, dtype=torch.float64) delta_t tensor(-1.3786, dtype=torch.float64)
4 gae_duplicate tensor(-1.3198, dtype=torch.float64) tensor(2.7442, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8562, dtype=torch.float64) delta_t tensor(0.6754, dtype=torch.float64)
3 gae_duplicate tensor(-0.3804, dtype=torch.float64) tensor(0.7910, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7756, dtype=torch.float64) delta_t tensor(-0.8144, dtype=torch.float64)
2 gae_duplicate tensor(-1.1188, dtype=torch.float64) tensor(2.3269, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-82.38471984863281
value loss:13.054325103759766
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.45579719543457 seconds
19 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(-0.6215, dtype=torch.float64)
19 gae_duplicate tensor(-0.6215, dtype=torch.float64) tensor(1.2922, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.5694, dtype=torch.float64)
18 gae_duplicate tensor(0.0722, dtype=torch.float64) tensor(-0.1502, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(-0.2775, dtype=torch.float64)
17 gae_duplicate tensor(-0.2197, dtype=torch.float64) tensor(0.4570, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(-0.7552, dtype=torch.float64)
16 gae_duplicate tensor(-0.9310, dtype=torch.float64) tensor(1.9357, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.2987, dtype=torch.float64)
15 gae_duplicate tensor(-0.4461, dtype=torch.float64) tensor(0.9274, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(0.1786, dtype=torch.float64)
14 gae_duplicate tensor(-0.1783, dtype=torch.float64) tensor(0.3707, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.1789, dtype=torch.float64)
13 gae_duplicate tensor(0.0362, dtype=torch.float64) tensor(-0.0753, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(0.1791, dtype=torch.float64)
12 gae_duplicate tensor(0.2081, dtype=torch.float64) tensor(-0.4329, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(0.1794, dtype=torch.float64)
11 gae_duplicate tensor(0.3459, dtype=torch.float64) tensor(-0.7191, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.0346, dtype=torch.float64)
10 gae_duplicate tensor(0.3113, dtype=torch.float64) tensor(-0.6471, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8172, dtype=torch.float64) delta_t tensor(0.1825, dtype=torch.float64)
9 gae_duplicate tensor(0.4315, dtype=torch.float64) tensor(-0.8973, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2454, dtype=torch.float64) delta_t tensor(-0.2950, dtype=torch.float64)
8 gae_duplicate tensor(0.0502, dtype=torch.float64) tensor(-0.1044, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0548, dtype=torch.float64) delta_t tensor(-0.6729, dtype=torch.float64)
7 gae_duplicate tensor(-0.6327, dtype=torch.float64) tensor(1.3159, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0255, dtype=torch.float64) delta_t tensor(0.9159, dtype=torch.float64)
6 gae_duplicate tensor(0.4097, dtype=torch.float64) tensor(-0.8523, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5343, dtype=torch.float64) delta_t tensor(-0.1822, dtype=torch.float64)
5 gae_duplicate tensor(0.1456, dtype=torch.float64) tensor(-0.3028, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1074, dtype=torch.float64) delta_t tensor(-1.1580, dtype=torch.float64)
4 gae_duplicate tensor(-1.0415, dtype=torch.float64) tensor(2.1660, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8552, dtype=torch.float64) delta_t tensor(0.7171, dtype=torch.float64)
3 gae_duplicate tensor(-0.1161, dtype=torch.float64) tensor(0.2416, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7296, dtype=torch.float64) delta_t tensor(-1.0393, dtype=torch.float64)
2 gae_duplicate tensor(-1.1322, dtype=torch.float64) tensor(2.3545, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-42.40099334716797
value loss:7.43505334854126
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.218073844909668 seconds
19 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(-0.4859, dtype=torch.float64)
19 gae_duplicate tensor(-0.4859, dtype=torch.float64) tensor(1.0107, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.5710, dtype=torch.float64)
18 gae_duplicate tensor(0.1822, dtype=torch.float64) tensor(-0.3790, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(-0.3271, dtype=torch.float64)
17 gae_duplicate tensor(-0.1813, dtype=torch.float64) tensor(0.3770, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(-0.6954, dtype=torch.float64)
16 gae_duplicate tensor(-0.8404, dtype=torch.float64) tensor(1.7477, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.1217, dtype=torch.float64)
15 gae_duplicate tensor(-0.5506, dtype=torch.float64) tensor(1.1450, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.1720, dtype=torch.float64)
14 gae_duplicate tensor(-0.2685, dtype=torch.float64) tensor(0.5584, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(0.2120, dtype=torch.float64)
13 gae_duplicate tensor(-0.0028, dtype=torch.float64) tensor(0.0058, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.3045, dtype=torch.float64)
12 gae_duplicate tensor(0.3023, dtype=torch.float64) tensor(-0.6286, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.2573, dtype=torch.float64)
11 gae_duplicate tensor(0.4991, dtype=torch.float64) tensor(-1.0378, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(-0.0877, dtype=torch.float64)
10 gae_duplicate tensor(0.3116, dtype=torch.float64) tensor(-0.6481, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6261, dtype=torch.float64) delta_t tensor(-0.1012, dtype=torch.float64)
9 gae_duplicate tensor(0.1481, dtype=torch.float64) tensor(-0.3080, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4353, dtype=torch.float64) delta_t tensor(-0.2526, dtype=torch.float64)
8 gae_duplicate tensor(-0.1341, dtype=torch.float64) tensor(0.2789, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0736, dtype=torch.float64) delta_t tensor(-0.5977, dtype=torch.float64)
7 gae_duplicate tensor(-0.7050, dtype=torch.float64) tensor(1.4662, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0736, dtype=torch.float64) delta_t tensor(0.2138, dtype=torch.float64)
6 gae_duplicate tensor(-0.3502, dtype=torch.float64) tensor(0.7282, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6460, dtype=torch.float64) delta_t tensor(2.0290, dtype=torch.float64)
5 gae_duplicate tensor(1.7489, dtype=torch.float64) tensor(-3.6369, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6001, dtype=torch.float64) delta_t tensor(0.0488, dtype=torch.float64)
4 gae_duplicate tensor(1.4479, dtype=torch.float64) tensor(-3.0105, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4739, dtype=torch.float64) delta_t tensor(0.5407, dtype=torch.float64)
3 gae_duplicate tensor(1.6990, dtype=torch.float64) tensor(-3.5327, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9659, dtype=torch.float64) delta_t tensor(-0.8248, dtype=torch.float64)
2 gae_duplicate tensor(0.5344, dtype=torch.float64) tensor(-1.1109, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:40.72489929199219
value loss:16.211896896362305
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.360891819000244 seconds
19 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(-0.3060, dtype=torch.float64)
19 gae_duplicate tensor(-0.3060, dtype=torch.float64) tensor(0.6364, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(-0.0509, dtype=torch.float64)
18 gae_duplicate tensor(-0.2957, dtype=torch.float64) tensor(0.6151, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.3873, dtype=torch.float64)
17 gae_duplicate tensor(0.1507, dtype=torch.float64) tensor(-0.3134, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(-0.7730, dtype=torch.float64)
16 gae_duplicate tensor(-0.6524, dtype=torch.float64) tensor(1.3564, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.1685, dtype=torch.float64)
15 gae_duplicate tensor(-0.3534, dtype=torch.float64) tensor(0.7348, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.1894, dtype=torch.float64)
14 gae_duplicate tensor(-0.0934, dtype=torch.float64) tensor(0.1942, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(0.1943, dtype=torch.float64)
13 gae_duplicate tensor(0.1196, dtype=torch.float64) tensor(-0.2488, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.2177, dtype=torch.float64)
12 gae_duplicate tensor(0.3134, dtype=torch.float64) tensor(-0.6517, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(0.3158, dtype=torch.float64)
11 gae_duplicate tensor(0.5665, dtype=torch.float64) tensor(-1.1780, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(-0.0403, dtype=torch.float64)
10 gae_duplicate tensor(0.4129, dtype=torch.float64) tensor(-0.8588, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5620, dtype=torch.float64) delta_t tensor(-0.0945, dtype=torch.float64)
9 gae_duplicate tensor(0.2358, dtype=torch.float64) tensor(-0.4905, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1797, dtype=torch.float64) delta_t tensor(-0.3254, dtype=torch.float64)
8 gae_duplicate tensor(-0.1367, dtype=torch.float64) tensor(0.2843, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0751, dtype=torch.float64) delta_t tensor(-0.7933, dtype=torch.float64)
7 gae_duplicate tensor(-0.9026, dtype=torch.float64) tensor(1.8765, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6484, dtype=torch.float64) delta_t tensor(0.1857, dtype=torch.float64)
6 gae_duplicate tensor(-0.5364, dtype=torch.float64) tensor(1.1156, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9034, dtype=torch.float64) delta_t tensor(1.8289, dtype=torch.float64)
5 gae_duplicate tensor(1.3998, dtype=torch.float64) tensor(-2.9110, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4769, dtype=torch.float64) delta_t tensor(-0.9532, dtype=torch.float64)
4 gae_duplicate tensor(0.1666, dtype=torch.float64) tensor(-0.3466, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0956, dtype=torch.float64) delta_t tensor(1.1022, dtype=torch.float64)
3 gae_duplicate tensor(1.2355, dtype=torch.float64) tensor(-2.5689, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8412, dtype=torch.float64) delta_t tensor(0.0086, dtype=torch.float64)
2 gae_duplicate tensor(0.9970, dtype=torch.float64) tensor(-2.0730, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:27.841236114501953
value loss:10.576980590820312
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.49484395980835 seconds
19 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(-0.8579, dtype=torch.float64)
19 gae_duplicate tensor(-0.8579, dtype=torch.float64) tensor(1.7844, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.4968, dtype=torch.float64)
18 gae_duplicate tensor(-0.1895, dtype=torch.float64) tensor(0.3940, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.5287, dtype=torch.float64)
17 gae_duplicate tensor(0.3771, dtype=torch.float64) tensor(-0.7843, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(-0.7950, dtype=torch.float64)
16 gae_duplicate tensor(-0.4933, dtype=torch.float64) tensor(1.0261, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.2201, dtype=torch.float64)
15 gae_duplicate tensor(-0.1745, dtype=torch.float64) tensor(0.3629, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.2266, dtype=torch.float64)
14 gae_duplicate tensor(0.0870, dtype=torch.float64) tensor(-0.1810, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.2334, dtype=torch.float64)
13 gae_duplicate tensor(0.3031, dtype=torch.float64) tensor(-0.6302, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.2660, dtype=torch.float64)
12 gae_duplicate tensor(0.5085, dtype=torch.float64) tensor(-1.0574, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(0.3194, dtype=torch.float64)
11 gae_duplicate tensor(0.7262, dtype=torch.float64) tensor(-1.5097, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.0665, dtype=torch.float64)
10 gae_duplicate tensor(0.6474, dtype=torch.float64) tensor(-1.3465, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6252, dtype=torch.float64) delta_t tensor(0.0552, dtype=torch.float64)
9 gae_duplicate tensor(0.5732, dtype=torch.float64) tensor(-1.1915, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3703, dtype=torch.float64) delta_t tensor(0.1913, dtype=torch.float64)
8 gae_duplicate tensor(0.6499, dtype=torch.float64) tensor(-1.3513, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1792, dtype=torch.float64) delta_t tensor(-0.8692, dtype=torch.float64)
7 gae_duplicate tensor(-0.3493, dtype=torch.float64) tensor(0.7264, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2229, dtype=torch.float64) delta_t tensor(0.5709, dtype=torch.float64)
6 gae_duplicate tensor(0.2915, dtype=torch.float64) tensor(-0.6062, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4147, dtype=torch.float64) delta_t tensor(0.2476, dtype=torch.float64)
5 gae_duplicate tensor(0.4808, dtype=torch.float64) tensor(-0.9997, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7343, dtype=torch.float64) delta_t tensor(-0.9603, dtype=torch.float64)
4 gae_duplicate tensor(-0.5757, dtype=torch.float64) tensor(1.1971, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4806, dtype=torch.float64) delta_t tensor(1.0598, dtype=torch.float64)
3 gae_duplicate tensor(0.5992, dtype=torch.float64) tensor(-1.2456, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3539, dtype=torch.float64) delta_t tensor(-1.3248, dtype=torch.float64)
2 gae_duplicate tensor(-0.8455, dtype=torch.float64) tensor(1.7583, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:20.80221939086914
value loss:7.630066871643066
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.6996)
ToM Target loss= tensor(305.4851)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.473518133163452 seconds
19 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(-0.6913, dtype=torch.float64)
19 gae_duplicate tensor(-0.6913, dtype=torch.float64) tensor(1.4374, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.5552, dtype=torch.float64)
18 gae_duplicate tensor(0.0022, dtype=torch.float64) tensor(-0.0045, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(-0.2540, dtype=torch.float64)
17 gae_duplicate tensor(-0.2523, dtype=torch.float64) tensor(0.5246, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(-0.7515, dtype=torch.float64)
16 gae_duplicate tensor(-0.9533, dtype=torch.float64) tensor(1.9821, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.1122, dtype=torch.float64)
15 gae_duplicate tensor(-0.6504, dtype=torch.float64) tensor(1.3524, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.1374, dtype=torch.float64)
14 gae_duplicate tensor(-0.3829, dtype=torch.float64) tensor(0.7964, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.1744, dtype=torch.float64)
13 gae_duplicate tensor(-0.1320, dtype=torch.float64) tensor(0.2745, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.1453, dtype=torch.float64)
12 gae_duplicate tensor(0.0397, dtype=torch.float64) tensor(-0.0826, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.1878, dtype=torch.float64)
11 gae_duplicate tensor(0.2196, dtype=torch.float64) tensor(-0.4567, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(0.0510, dtype=torch.float64)
10 gae_duplicate tensor(0.2267, dtype=torch.float64) tensor(-0.4714, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.1184, dtype=torch.float64)
9 gae_duplicate tensor(0.2998, dtype=torch.float64) tensor(-0.6233, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1793, dtype=torch.float64) delta_t tensor(-0.0402, dtype=torch.float64)
8 gae_duplicate tensor(0.1996, dtype=torch.float64) tensor(-0.4150, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3303, dtype=torch.float64) delta_t tensor(-1.3118, dtype=torch.float64)
7 gae_duplicate tensor(-1.1521, dtype=torch.float64) tensor(2.3954, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2858, dtype=torch.float64) delta_t tensor(0.6700, dtype=torch.float64)
6 gae_duplicate tensor(-0.2517, dtype=torch.float64) tensor(0.5235, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5413, dtype=torch.float64) delta_t tensor(0.0235, dtype=torch.float64)
5 gae_duplicate tensor(-0.1778, dtype=torch.float64) tensor(0.3699, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2432, dtype=torch.float64) delta_t tensor(-1.5121, dtype=torch.float64)
4 gae_duplicate tensor(-1.6544, dtype=torch.float64) tensor(3.4405, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9907, dtype=torch.float64) delta_t tensor(0.4324, dtype=torch.float64)
3 gae_duplicate tensor(-0.8911, dtype=torch.float64) tensor(1.8532, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4822, dtype=torch.float64) delta_t tensor(-0.5245, dtype=torch.float64)
2 gae_duplicate tensor(-1.2374, dtype=torch.float64) tensor(2.5733, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-93.94115447998047
value loss:13.129432678222656
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.411841869354248 seconds
19 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(-1.2698, dtype=torch.float64)
19 gae_duplicate tensor(-1.2698, dtype=torch.float64) tensor(2.6396, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(0.9596, dtype=torch.float64)
18 gae_duplicate tensor(-0.0562, dtype=torch.float64) tensor(0.1168, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(-0.2590, dtype=torch.float64)
17 gae_duplicate tensor(-0.3040, dtype=torch.float64) tensor(0.6322, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(-0.7792, dtype=torch.float64)
16 gae_duplicate tensor(-1.0224, dtype=torch.float64) tensor(2.1263, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.3339, dtype=torch.float64)
15 gae_duplicate tensor(-0.4840, dtype=torch.float64) tensor(1.0066, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.1706, dtype=torch.float64)
14 gae_duplicate tensor(-0.2166, dtype=torch.float64) tensor(0.4506, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.1709, dtype=torch.float64)
13 gae_duplicate tensor(-0.0024, dtype=torch.float64) tensor(0.0051, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.1711, dtype=torch.float64)
12 gae_duplicate tensor(0.1692, dtype=torch.float64) tensor(-0.3517, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.1714, dtype=torch.float64)
11 gae_duplicate tensor(0.3067, dtype=torch.float64) tensor(-0.6378, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(-0.0385, dtype=torch.float64)
10 gae_duplicate tensor(0.2069, dtype=torch.float64) tensor(-0.4301, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(0.1537, dtype=torch.float64)
9 gae_duplicate tensor(0.3192, dtype=torch.float64) tensor(-0.6638, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1797, dtype=torch.float64) delta_t tensor(-0.4670, dtype=torch.float64)
8 gae_duplicate tensor(-0.2117, dtype=torch.float64) tensor(0.4402, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3294, dtype=torch.float64) delta_t tensor(-0.8944, dtype=torch.float64)
7 gae_duplicate tensor(-1.0637, dtype=torch.float64) tensor(2.2122, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0294, dtype=torch.float64) delta_t tensor(0.7769, dtype=torch.float64)
6 gae_duplicate tensor(-0.0740, dtype=torch.float64) tensor(0.1539, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7935, dtype=torch.float64) delta_t tensor(-0.3295, dtype=torch.float64)
5 gae_duplicate tensor(-0.3887, dtype=torch.float64) tensor(0.8084, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2405, dtype=torch.float64) delta_t tensor(-1.3861, dtype=torch.float64)
4 gae_duplicate tensor(-1.6971, dtype=torch.float64) tensor(3.5286, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.1157, dtype=torch.float64) delta_t tensor(0.3366, dtype=torch.float64)
3 gae_duplicate tensor(-1.0210, dtype=torch.float64) tensor(2.1234, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7354, dtype=torch.float64) delta_t tensor(-0.7654, dtype=torch.float64)
2 gae_duplicate tensor(-1.5822, dtype=torch.float64) tensor(3.2897, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-105.82452392578125
value loss:16.59093475341797
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.497111082077026 seconds
19 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(-0.4845, dtype=torch.float64)
19 gae_duplicate tensor(-0.4845, dtype=torch.float64) tensor(1.0076, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(0.5557, dtype=torch.float64)
18 gae_duplicate tensor(0.1681, dtype=torch.float64) tensor(-0.3498, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(-0.2360, dtype=torch.float64)
17 gae_duplicate tensor(-0.1015, dtype=torch.float64) tensor(0.2112, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(-0.7379, dtype=torch.float64)
16 gae_duplicate tensor(-0.8192, dtype=torch.float64) tensor(1.7028, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.0873, dtype=torch.float64)
15 gae_duplicate tensor(-0.5680, dtype=torch.float64) tensor(1.1813, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.1537, dtype=torch.float64)
14 gae_duplicate tensor(-0.3007, dtype=torch.float64) tensor(0.6253, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.1540, dtype=torch.float64)
13 gae_duplicate tensor(-0.0866, dtype=torch.float64) tensor(0.1800, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.1542, dtype=torch.float64)
12 gae_duplicate tensor(0.0850, dtype=torch.float64) tensor(-0.1767, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.1867, dtype=torch.float64)
11 gae_duplicate tensor(0.2547, dtype=torch.float64) tensor(-0.5296, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.3044, dtype=torch.float64)
10 gae_duplicate tensor(0.5081, dtype=torch.float64) tensor(-1.0564, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(-0.0332, dtype=torch.float64)
9 gae_duplicate tensor(0.3733, dtype=torch.float64) tensor(-0.7763, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2649, dtype=torch.float64) delta_t tensor(-0.2437, dtype=torch.float64)
8 gae_duplicate tensor(0.0549, dtype=torch.float64) tensor(-0.1142, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3285, dtype=torch.float64) delta_t tensor(-1.0724, dtype=torch.float64)
7 gae_duplicate tensor(-1.0284, dtype=torch.float64) tensor(2.1389, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.6633, dtype=torch.float64) delta_t tensor(0.2533, dtype=torch.float64)
6 gae_duplicate tensor(-0.5694, dtype=torch.float64) tensor(1.1837, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0460, dtype=torch.float64) delta_t tensor(-0.8553, dtype=torch.float64)
5 gae_duplicate tensor(-1.3108, dtype=torch.float64) tensor(2.7261, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3661, dtype=torch.float64) delta_t tensor(-1.4151, dtype=torch.float64)
4 gae_duplicate tensor(-2.4637, dtype=torch.float64) tensor(5.1237, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7323, dtype=torch.float64) delta_t tensor(0.8583, dtype=torch.float64)
3 gae_duplicate tensor(-1.1126, dtype=torch.float64) tensor(2.3140, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7336, dtype=torch.float64) delta_t tensor(-1.2206, dtype=torch.float64)
2 gae_duplicate tensor(-2.1107, dtype=torch.float64) tensor(4.3876, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-119.79749298095703
value loss:25.051048278808594
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.464507102966309 seconds
19 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(-0.4858, dtype=torch.float64)
19 gae_duplicate tensor(-0.4858, dtype=torch.float64) tensor(1.0099, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.5444, dtype=torch.float64)
18 gae_duplicate tensor(0.1557, dtype=torch.float64) tensor(-0.3238, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(-0.1655, dtype=torch.float64)
17 gae_duplicate tensor(-0.0409, dtype=torch.float64) tensor(0.0851, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(-0.2414, dtype=torch.float64)
16 gae_duplicate tensor(-0.2741, dtype=torch.float64) tensor(0.5699, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(-0.3795, dtype=torch.float64)
15 gae_duplicate tensor(-0.5988, dtype=torch.float64) tensor(1.2456, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.1475, dtype=torch.float64)
14 gae_duplicate tensor(-0.3315, dtype=torch.float64) tensor(0.6893, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.1635, dtype=torch.float64)
13 gae_duplicate tensor(-0.1017, dtype=torch.float64) tensor(0.2115, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.1732, dtype=torch.float64)
12 gae_duplicate tensor(0.0918, dtype=torch.float64) tensor(-0.1909, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.2183, dtype=torch.float64)
11 gae_duplicate tensor(0.2918, dtype=torch.float64) tensor(-0.6068, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.1562, dtype=torch.float64)
10 gae_duplicate tensor(0.3897, dtype=torch.float64) tensor(-0.8102, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.1211, dtype=torch.float64)
9 gae_duplicate tensor(0.4328, dtype=torch.float64) tensor(-0.8998, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0101, dtype=torch.float64) delta_t tensor(-0.0299, dtype=torch.float64)
8 gae_duplicate tensor(0.3164, dtype=torch.float64) tensor(-0.6578, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2006, dtype=torch.float64) delta_t tensor(-1.1928, dtype=torch.float64)
7 gae_duplicate tensor(-0.9397, dtype=torch.float64) tensor(1.9542, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5340, dtype=torch.float64) delta_t tensor(0.5446, dtype=torch.float64)
6 gae_duplicate tensor(-0.2072, dtype=torch.float64) tensor(0.4307, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7890, dtype=torch.float64) delta_t tensor(-0.6660, dtype=torch.float64)
5 gae_duplicate tensor(-0.8318, dtype=torch.float64) tensor(1.7298, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3623, dtype=torch.float64) delta_t tensor(-1.3517, dtype=torch.float64)
4 gae_duplicate tensor(-2.0171, dtype=torch.float64) tensor(4.1939, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7293, dtype=torch.float64) delta_t tensor(0.9022, dtype=torch.float64)
3 gae_duplicate tensor(-0.7115, dtype=torch.float64) tensor(1.4792, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.8578, dtype=torch.float64) delta_t tensor(-1.1381, dtype=torch.float64)
2 gae_duplicate tensor(-1.7073, dtype=torch.float64) tensor(3.5506, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-83.0861587524414
value loss:15.684325218200684
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.443182945251465 seconds
19 rew tensor(0.7508, dtype=torch.float64) delta_t tensor(-0.4870, dtype=torch.float64)
19 gae_duplicate tensor(-0.4870, dtype=torch.float64) tensor(1.0129, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6237, dtype=torch.float64) delta_t tensor(0.4177, dtype=torch.float64)
18 gae_duplicate tensor(0.0281, dtype=torch.float64) tensor(-0.0585, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4330, dtype=torch.float64) delta_t tensor(-1.5889, dtype=torch.float64)
17 gae_duplicate tensor(-1.5664, dtype=torch.float64) tensor(3.2585, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.0122, dtype=torch.float64) delta_t tensor(-0.8732, dtype=torch.float64)
16 gae_duplicate tensor(-2.1263, dtype=torch.float64) tensor(4.4221, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.6483, dtype=torch.float64) delta_t tensor(-0.9314, dtype=torch.float64)
15 gae_duplicate tensor(-2.6325, dtype=torch.float64) tensor(5.4734, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.2386, dtype=torch.float64)
14 gae_duplicate tensor(-1.8673, dtype=torch.float64) tensor(3.8835, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.2389, dtype=torch.float64)
13 gae_duplicate tensor(-1.2550, dtype=torch.float64) tensor(2.6087, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.2391, dtype=torch.float64)
12 gae_duplicate tensor(-0.7648, dtype=torch.float64) tensor(1.5903, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.2394, dtype=torch.float64)
11 gae_duplicate tensor(-0.3725, dtype=torch.float64) tensor(0.7743, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1795, dtype=torch.float64) delta_t tensor(-0.7745, dtype=torch.float64)
10 gae_duplicate tensor(-1.0725, dtype=torch.float64) tensor(2.2305, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6245, dtype=torch.float64) delta_t tensor(0.0101, dtype=torch.float64)
9 gae_duplicate tensor(-0.8479, dtype=torch.float64) tensor(1.7630, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4975, dtype=torch.float64) delta_t tensor(-0.1161, dtype=torch.float64)
8 gae_duplicate tensor(-0.7944, dtype=torch.float64) tensor(1.6521, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0528, dtype=torch.float64) delta_t tensor(-0.5545, dtype=torch.float64)
7 gae_duplicate tensor(-1.1900, dtype=torch.float64) tensor(2.4748, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6462, dtype=torch.float64) delta_t tensor(-1.0518, dtype=torch.float64)
6 gae_duplicate tensor(-2.0038, dtype=torch.float64) tensor(4.1664, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9640, dtype=torch.float64) delta_t tensor(1.1924, dtype=torch.float64)
5 gae_duplicate tensor(-0.4106, dtype=torch.float64) tensor(0.8541, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2185, dtype=torch.float64) delta_t tensor(0.6380, dtype=torch.float64)
4 gae_duplicate tensor(0.3095, dtype=torch.float64) tensor(-0.6438, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9816, dtype=torch.float64) delta_t tensor(0.4488, dtype=torch.float64)
3 gae_duplicate tensor(0.6964, dtype=torch.float64) tensor(-1.4479, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7755, dtype=torch.float64) delta_t tensor(-2.0981, dtype=torch.float64)
2 gae_duplicate tensor(-1.5409, dtype=torch.float64) tensor(3.2039, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-224.43331909179688
value loss:46.475223541259766
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.4210)
ToM Target loss= tensor(305.8592)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.319037199020386 seconds
19 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(-0.1953, dtype=torch.float64)
19 gae_duplicate tensor(-0.1953, dtype=torch.float64) tensor(0.4059, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.6417, dtype=torch.float64)
18 gae_duplicate tensor(0.4855, dtype=torch.float64) tensor(-1.0099, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(-0.1151, dtype=torch.float64)
17 gae_duplicate tensor(0.2732, dtype=torch.float64) tensor(-0.5682, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.3245, dtype=torch.float64)
16 gae_duplicate tensor(0.5431, dtype=torch.float64) tensor(-1.1292, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(-0.6140, dtype=torch.float64)
15 gae_duplicate tensor(-0.1795, dtype=torch.float64) tensor(0.3734, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(0.1930, dtype=torch.float64)
14 gae_duplicate tensor(0.0493, dtype=torch.float64) tensor(-0.1026, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(0.1667, dtype=torch.float64)
13 gae_duplicate tensor(0.2062, dtype=torch.float64) tensor(-0.4287, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.3625, dtype=torch.float64)
12 gae_duplicate tensor(0.5274, dtype=torch.float64) tensor(-1.0972, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.3004, dtype=torch.float64)
11 gae_duplicate tensor(0.7223, dtype=torch.float64) tensor(-1.5026, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(-0.0320, dtype=torch.float64)
10 gae_duplicate tensor(0.5459, dtype=torch.float64) tensor(-1.1353, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4349, dtype=torch.float64) delta_t tensor(-0.1901, dtype=torch.float64)
9 gae_duplicate tensor(0.2465, dtype=torch.float64) tensor(-0.5126, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0529, dtype=torch.float64) delta_t tensor(-0.4988, dtype=torch.float64)
8 gae_duplicate tensor(-0.3016, dtype=torch.float64) tensor(0.6272, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2017, dtype=torch.float64) delta_t tensor(-0.8441, dtype=torch.float64)
7 gae_duplicate tensor(-1.0853, dtype=torch.float64) tensor(2.2578, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5200, dtype=torch.float64) delta_t tensor(0.1000, dtype=torch.float64)
6 gae_duplicate tensor(-0.7682, dtype=torch.float64) tensor(1.5972, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9020, dtype=torch.float64) delta_t tensor(1.7873, dtype=torch.float64)
5 gae_duplicate tensor(1.1727, dtype=torch.float64) tensor(-2.4383, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4751, dtype=torch.float64) delta_t tensor(-0.7518, dtype=torch.float64)
4 gae_duplicate tensor(0.1864, dtype=torch.float64) tensor(-0.3876, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0941, dtype=torch.float64) delta_t tensor(1.7826, dtype=torch.float64)
3 gae_duplicate tensor(1.9317, dtype=torch.float64) tensor(-4.0165, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8399, dtype=torch.float64) delta_t tensor(-3.5972, dtype=torch.float64)
2 gae_duplicate tensor(-2.0519, dtype=torch.float64) tensor(4.2663, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:27.681659698486328
value loss:19.634824752807617
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.537823438644409 seconds
19 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(-0.3748, dtype=torch.float64)
19 gae_duplicate tensor(-0.3748, dtype=torch.float64) tensor(0.7795, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.5976, dtype=torch.float64)
18 gae_duplicate tensor(0.2977, dtype=torch.float64) tensor(-0.6189, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(-0.1350, dtype=torch.float64)
17 gae_duplicate tensor(0.1032, dtype=torch.float64) tensor(-0.2146, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(-0.5151, dtype=torch.float64)
16 gae_duplicate tensor(-0.4326, dtype=torch.float64) tensor(0.8994, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.0317, dtype=torch.float64)
15 gae_duplicate tensor(-0.3144, dtype=torch.float64) tensor(0.6535, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.2048, dtype=torch.float64)
14 gae_duplicate tensor(-0.0468, dtype=torch.float64) tensor(0.0972, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(0.2313, dtype=torch.float64)
13 gae_duplicate tensor(0.1939, dtype=torch.float64) tensor(-0.4032, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(0.2419, dtype=torch.float64)
12 gae_duplicate tensor(0.3970, dtype=torch.float64) tensor(-0.8259, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.2944, dtype=torch.float64)
11 gae_duplicate tensor(0.6120, dtype=torch.float64) tensor(-1.2725, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.1302, dtype=torch.float64)
10 gae_duplicate tensor(0.6198, dtype=torch.float64) tensor(-1.2891, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(0.2329, dtype=torch.float64)
9 gae_duplicate tensor(0.7288, dtype=torch.float64) tensor(-1.5152, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2442, dtype=torch.float64) delta_t tensor(-0.0684, dtype=torch.float64)
8 gae_duplicate tensor(0.5146, dtype=torch.float64) tensor(-1.0700, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0739, dtype=torch.float64) delta_t tensor(-0.9233, dtype=torch.float64)
7 gae_duplicate tensor(-0.5116, dtype=torch.float64) tensor(1.0635, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1554, dtype=torch.float64) delta_t tensor(0.8497, dtype=torch.float64)
6 gae_duplicate tensor(0.4404, dtype=torch.float64) tensor(-0.9158, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4104, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
5 gae_duplicate tensor(0.3779, dtype=torch.float64) tensor(-0.7856, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2384, dtype=torch.float64) delta_t tensor(-1.3154, dtype=torch.float64)
4 gae_duplicate tensor(-1.0132, dtype=torch.float64) tensor(2.1065, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9862, dtype=torch.float64) delta_t tensor(0.5279, dtype=torch.float64)
3 gae_duplicate tensor(-0.2826, dtype=torch.float64) tensor(0.5877, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7331, dtype=torch.float64) delta_t tensor(-0.5728, dtype=torch.float64)
2 gae_duplicate tensor(-0.7989, dtype=torch.float64) tensor(1.6619, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:5.245905876159668
value loss:6.931384086608887
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4155802726745605 seconds
19 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.0102, dtype=torch.float64)
19 gae_duplicate tensor(0.0102, dtype=torch.float64) tensor(-0.0213, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.6902, dtype=torch.float64)
18 gae_duplicate tensor(0.6984, dtype=torch.float64) tensor(-1.4524, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(-0.0074, dtype=torch.float64)
17 gae_duplicate tensor(0.5513, dtype=torch.float64) tensor(-1.1469, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(-0.7181, dtype=torch.float64)
16 gae_duplicate tensor(-0.2771, dtype=torch.float64) tensor(0.5764, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.2317, dtype=torch.float64)
15 gae_duplicate tensor(0.0100, dtype=torch.float64) tensor(-0.0209, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.2697, dtype=torch.float64)
14 gae_duplicate tensor(0.2777, dtype=torch.float64) tensor(-0.5773, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(0.2970, dtype=torch.float64)
13 gae_duplicate tensor(0.5192, dtype=torch.float64) tensor(-1.0791, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.2756, dtype=torch.float64)
12 gae_duplicate tensor(0.6909, dtype=torch.float64) tensor(-1.4366, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(0.2642, dtype=torch.float64)
11 gae_duplicate tensor(0.8169, dtype=torch.float64) tensor(-1.6990, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(0.1972, dtype=torch.float64)
10 gae_duplicate tensor(0.8507, dtype=torch.float64) tensor(-1.7693, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3073, dtype=torch.float64) delta_t tensor(-0.2183, dtype=torch.float64)
9 gae_duplicate tensor(0.4623, dtype=torch.float64) tensor(-0.9615, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2437, dtype=torch.float64) delta_t tensor(-0.0830, dtype=torch.float64)
8 gae_duplicate tensor(0.2869, dtype=torch.float64) tensor(-0.5963, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0746, dtype=torch.float64) delta_t tensor(-0.8477, dtype=torch.float64)
7 gae_duplicate tensor(-0.6182, dtype=torch.float64) tensor(1.2856, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9023, dtype=torch.float64) delta_t tensor(-0.4669, dtype=torch.float64)
6 gae_duplicate tensor(-0.9614, dtype=torch.float64) tensor(1.9984, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1572, dtype=torch.float64) delta_t tensor(1.5484, dtype=torch.float64)
5 gae_duplicate tensor(0.7792, dtype=torch.float64) tensor(-1.6206, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6034, dtype=torch.float64) delta_t tensor(-0.7358, dtype=torch.float64)
4 gae_duplicate tensor(-0.1124, dtype=torch.float64) tensor(0.2338, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4771, dtype=torch.float64) delta_t tensor(1.1007, dtype=torch.float64)
3 gae_duplicate tensor(1.0108, dtype=torch.float64) tensor(-2.1028, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2231, dtype=torch.float64) delta_t tensor(-0.2323, dtype=torch.float64)
2 gae_duplicate tensor(0.5763, dtype=torch.float64) tensor(-1.1986, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:68.40747833251953
value loss:9.99017333984375
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.384049892425537 seconds
19 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(-0.3685, dtype=torch.float64)
19 gae_duplicate tensor(-0.3685, dtype=torch.float64) tensor(0.7662, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(0.5524, dtype=torch.float64)
18 gae_duplicate tensor(0.2576, dtype=torch.float64) tensor(-0.5358, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(-0.1253, dtype=torch.float64)
17 gae_duplicate tensor(0.0808, dtype=torch.float64) tensor(-0.1679, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(-0.1210, dtype=torch.float64)
16 gae_duplicate tensor(-0.0564, dtype=torch.float64) tensor(0.1172, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.3852, dtype=torch.float64)
15 gae_duplicate tensor(0.3401, dtype=torch.float64) tensor(-0.7074, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.3355, dtype=torch.float64)
14 gae_duplicate tensor(0.6076, dtype=torch.float64) tensor(-1.2636, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.3357, dtype=torch.float64)
13 gae_duplicate tensor(0.8218, dtype=torch.float64) tensor(-1.7091, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.3360, dtype=torch.float64)
12 gae_duplicate tensor(0.9934, dtype=torch.float64) tensor(-2.0655, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.3676, dtype=torch.float64)
11 gae_duplicate tensor(1.1623, dtype=torch.float64) tensor(-2.4160, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(0.2280, dtype=torch.float64)
10 gae_duplicate tensor(1.1578, dtype=torch.float64) tensor(-2.4067, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.3395, dtype=torch.float64)
9 gae_duplicate tensor(1.2658, dtype=torch.float64) tensor(-2.6324, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3706, dtype=torch.float64) delta_t tensor(0.2414, dtype=torch.float64)
8 gae_duplicate tensor(1.2541, dtype=torch.float64) tensor(-2.6083, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1797, dtype=torch.float64) delta_t tensor(-0.5828, dtype=torch.float64)
7 gae_duplicate tensor(0.4205, dtype=torch.float64) tensor(-0.8742, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3482, dtype=torch.float64) delta_t tensor(0.6709, dtype=torch.float64)
6 gae_duplicate tensor(1.0072, dtype=torch.float64) tensor(-2.0936, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6672, dtype=torch.float64) delta_t tensor(-0.2398, dtype=torch.float64)
5 gae_duplicate tensor(0.5660, dtype=torch.float64) tensor(-1.1764, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9868, dtype=torch.float64) delta_t tensor(-1.0384, dtype=torch.float64)
4 gae_duplicate tensor(-0.5856, dtype=torch.float64) tensor(1.2176, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4788, dtype=torch.float64) delta_t tensor(1.2598, dtype=torch.float64)
3 gae_duplicate tensor(0.7913, dtype=torch.float64) tensor(-1.6458, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6071, dtype=torch.float64) delta_t tensor(-1.7994, dtype=torch.float64)
2 gae_duplicate tensor(-1.1663, dtype=torch.float64) tensor(2.4262, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:105.52992248535156
value loss:18.099933624267578
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.60361385345459 seconds
19 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(-0.0786, dtype=torch.float64)
19 gae_duplicate tensor(-0.0786, dtype=torch.float64) tensor(0.1634, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.7932, dtype=torch.float64)
18 gae_duplicate tensor(0.7303, dtype=torch.float64) tensor(-1.5184, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(-0.1188, dtype=torch.float64)
17 gae_duplicate tensor(0.4655, dtype=torch.float64) tensor(-0.9683, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(-0.7525, dtype=torch.float64)
16 gae_duplicate tensor(-0.3801, dtype=torch.float64) tensor(0.7906, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.6083, dtype=torch.float64)
15 gae_duplicate tensor(0.3042, dtype=torch.float64) tensor(-0.6325, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.3281, dtype=torch.float64)
14 gae_duplicate tensor(0.5715, dtype=torch.float64) tensor(-1.1886, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.3284, dtype=torch.float64)
13 gae_duplicate tensor(0.7856, dtype=torch.float64) tensor(-1.6338, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.3286, dtype=torch.float64)
12 gae_duplicate tensor(0.9571, dtype=torch.float64) tensor(-1.9905, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.3289, dtype=torch.float64)
11 gae_duplicate tensor(1.0945, dtype=torch.float64) tensor(-2.2757, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(-0.0225, dtype=torch.float64)
10 gae_duplicate tensor(0.8532, dtype=torch.float64) tensor(-1.7749, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.2691, dtype=torch.float64)
9 gae_duplicate tensor(0.9516, dtype=torch.float64) tensor(-1.9786, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4976, dtype=torch.float64) delta_t tensor(-0.0676, dtype=torch.float64)
8 gae_duplicate tensor(0.6937, dtype=torch.float64) tensor(-1.4418, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0521, dtype=torch.float64) delta_t tensor(0.1381, dtype=torch.float64)
7 gae_duplicate tensor(0.6930, dtype=torch.float64) tensor(-1.4417, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6479, dtype=torch.float64) delta_t tensor(0.7970, dtype=torch.float64)
6 gae_duplicate tensor(1.3514, dtype=torch.float64) tensor(-2.8097, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8572, dtype=torch.float64) delta_t tensor(-3.2055, dtype=torch.float64)
5 gae_duplicate tensor(-2.1244, dtype=torch.float64) tensor(4.4169, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8587, dtype=torch.float64) delta_t tensor(1.3868, dtype=torch.float64)
4 gae_duplicate tensor(-0.3126, dtype=torch.float64) tensor(0.6504, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6054, dtype=torch.float64) delta_t tensor(1.0648, dtype=torch.float64)
3 gae_duplicate tensor(0.8147, dtype=torch.float64) tensor(-1.6939, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.9887, dtype=torch.float64) delta_t tensor(-1.0826, dtype=torch.float64)
2 gae_duplicate tensor(-0.4309, dtype=torch.float64) tensor(0.8961, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:85.46197509765625
value loss:20.898120880126953
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.8577)
ToM Target loss= tensor(305.5313)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.478269100189209 seconds
19 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(0.1120, dtype=torch.float64)
19 gae_duplicate tensor(0.1120, dtype=torch.float64) tensor(-0.2329, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(0.7248, dtype=torch.float64)
18 gae_duplicate tensor(0.8144, dtype=torch.float64) tensor(-1.6933, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(-0.1216, dtype=torch.float64)
17 gae_duplicate tensor(0.5299, dtype=torch.float64) tensor(-1.1021, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(-0.4169, dtype=torch.float64)
16 gae_duplicate tensor(0.0071, dtype=torch.float64) tensor(-0.0147, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(0.0965, dtype=torch.float64)
15 gae_duplicate tensor(0.1022, dtype=torch.float64) tensor(-0.2125, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.2689, dtype=torch.float64)
14 gae_duplicate tensor(0.3507, dtype=torch.float64) tensor(-0.7291, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.2693, dtype=torch.float64)
13 gae_duplicate tensor(0.5499, dtype=torch.float64) tensor(-1.1432, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.2747, dtype=torch.float64)
12 gae_duplicate tensor(0.7146, dtype=torch.float64) tensor(-1.4862, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.4132, dtype=torch.float64)
11 gae_duplicate tensor(0.9848, dtype=torch.float64) tensor(-2.0482, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.1473, dtype=torch.float64)
10 gae_duplicate tensor(0.9352, dtype=torch.float64) tensor(-1.9455, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4967, dtype=torch.float64) delta_t tensor(0.0089, dtype=torch.float64)
9 gae_duplicate tensor(0.7570, dtype=torch.float64) tensor(-1.5744, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4968, dtype=torch.float64) delta_t tensor(-0.0585, dtype=torch.float64)
8 gae_duplicate tensor(0.5472, dtype=torch.float64) tensor(-1.1376, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1783, dtype=torch.float64) delta_t tensor(-0.3498, dtype=torch.float64)
7 gae_duplicate tensor(0.0879, dtype=torch.float64) tensor(-0.1828, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3314, dtype=torch.float64) delta_t tensor(-0.0870, dtype=torch.float64)
6 gae_duplicate tensor(-0.0167, dtype=torch.float64) tensor(0.0347, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6500, dtype=torch.float64) delta_t tensor(2.1591, dtype=torch.float64)
5 gae_duplicate tensor(2.1458, dtype=torch.float64) tensor(-4.4627, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3509, dtype=torch.float64) delta_t tensor(-0.4356, dtype=torch.float64)
4 gae_duplicate tensor(1.2811, dtype=torch.float64) tensor(-2.6635, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3516, dtype=torch.float64) delta_t tensor(1.1256, dtype=torch.float64)
3 gae_duplicate tensor(2.1505, dtype=torch.float64) tensor(-4.4712, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0974, dtype=torch.float64) delta_t tensor(0.1329, dtype=torch.float64)
2 gae_duplicate tensor(1.8533, dtype=torch.float64) tensor(-3.8554, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:172.4012451171875
value loss:28.39914894104004
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.363924980163574 seconds
19 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(-0.0809, dtype=torch.float64)
19 gae_duplicate tensor(-0.0809, dtype=torch.float64) tensor(0.1682, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(0.6589, dtype=torch.float64)
18 gae_duplicate tensor(0.5942, dtype=torch.float64) tensor(-1.2357, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(-0.1431, dtype=torch.float64)
17 gae_duplicate tensor(0.3323, dtype=torch.float64) tensor(-0.6913, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(-0.6515, dtype=torch.float64)
16 gae_duplicate tensor(-0.3857, dtype=torch.float64) tensor(0.8021, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.3494, dtype=torch.float64)
15 gae_duplicate tensor(0.0409, dtype=torch.float64) tensor(-0.0851, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(0.2753, dtype=torch.float64)
14 gae_duplicate tensor(0.3080, dtype=torch.float64) tensor(-0.6403, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.2756, dtype=torch.float64)
13 gae_duplicate tensor(0.5220, dtype=torch.float64) tensor(-1.0850, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.2758, dtype=torch.float64)
12 gae_duplicate tensor(0.6934, dtype=torch.float64) tensor(-1.4425, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.2760, dtype=torch.float64)
11 gae_duplicate tensor(0.8308, dtype=torch.float64) tensor(-1.7278, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6875, dtype=torch.float64) delta_t tensor(0.0250, dtype=torch.float64)
10 gae_duplicate tensor(0.6896, dtype=torch.float64) tensor(-1.4337, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4327, dtype=torch.float64) delta_t tensor(-0.0713, dtype=torch.float64)
9 gae_duplicate tensor(0.4803, dtype=torch.float64) tensor(-0.9992, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2417, dtype=torch.float64) delta_t tensor(-0.2437, dtype=torch.float64)
8 gae_duplicate tensor(0.1406, dtype=torch.float64) tensor(-0.2922, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0768, dtype=torch.float64) delta_t tensor(-0.2577, dtype=torch.float64)
7 gae_duplicate tensor(-0.1452, dtype=torch.float64) tensor(0.3020, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0960, dtype=torch.float64) delta_t tensor(0.8112, dtype=torch.float64)
6 gae_duplicate tensor(0.6950, dtype=torch.float64) tensor(-1.4455, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9245, dtype=torch.float64) delta_t tensor(-0.5495, dtype=torch.float64)
5 gae_duplicate tensor(0.0065, dtype=torch.float64) tensor(-0.0136, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1173, dtype=torch.float64) delta_t tensor(-1.0885, dtype=torch.float64)
4 gae_duplicate tensor(-1.0833, dtype=torch.float64) tensor(2.2529, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6092, dtype=torch.float64) delta_t tensor(1.0975, dtype=torch.float64)
3 gae_duplicate tensor(0.2309, dtype=torch.float64) tensor(-0.4803, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6102, dtype=torch.float64) delta_t tensor(-1.5103, dtype=torch.float64)
2 gae_duplicate tensor(-1.3255, dtype=torch.float64) tensor(2.7560, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:30.623065948486328
value loss:9.559226036071777
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.386580944061279 seconds
19 rew tensor(0.8122, dtype=torch.float64) delta_t tensor(-0.2968, dtype=torch.float64)
19 gae_duplicate tensor(-0.2968, dtype=torch.float64) tensor(0.6173, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8124, dtype=torch.float64) delta_t tensor(0.5943, dtype=torch.float64)
18 gae_duplicate tensor(0.3568, dtype=torch.float64) tensor(-0.7418, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8126, dtype=torch.float64) delta_t tensor(-0.1539, dtype=torch.float64)
17 gae_duplicate tensor(0.1315, dtype=torch.float64) tensor(-0.2736, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(-0.6355, dtype=torch.float64)
16 gae_duplicate tensor(-0.5303, dtype=torch.float64) tensor(1.1029, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.2708, dtype=torch.float64)
15 gae_duplicate tensor(-0.1535, dtype=torch.float64) tensor(0.3193, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(0.2362, dtype=torch.float64)
14 gae_duplicate tensor(0.1134, dtype=torch.float64) tensor(-0.2359, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.2365, dtype=torch.float64)
13 gae_duplicate tensor(0.3272, dtype=torch.float64) tensor(-0.6805, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.2367, dtype=torch.float64)
12 gae_duplicate tensor(0.4985, dtype=torch.float64) tensor(-1.0370, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.2369, dtype=torch.float64)
11 gae_duplicate tensor(0.6357, dtype=torch.float64) tensor(-1.3225, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.1866, dtype=torch.float64)
10 gae_duplicate tensor(0.6952, dtype=torch.float64) tensor(-1.4453, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.2270, dtype=torch.float64)
9 gae_duplicate tensor(0.7831, dtype=torch.float64) tensor(-1.6281, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.4316, dtype=torch.float64)
8 gae_duplicate tensor(1.0580, dtype=torch.float64) tensor(-2.2005, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2037, dtype=torch.float64) delta_t tensor(-0.8487, dtype=torch.float64)
7 gae_duplicate tensor(-0.0023, dtype=torch.float64) tensor(0.0047, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1586, dtype=torch.float64) delta_t tensor(1.0774, dtype=torch.float64)
6 gae_duplicate tensor(1.0756, dtype=torch.float64) tensor(-2.2376, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6684, dtype=torch.float64) delta_t tensor(-0.6122, dtype=torch.float64)
5 gae_duplicate tensor(0.2482, dtype=torch.float64) tensor(-0.5162, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3701, dtype=torch.float64) delta_t tensor(-1.2336, dtype=torch.float64)
4 gae_duplicate tensor(-1.0351, dtype=torch.float64) tensor(2.1527, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6080, dtype=torch.float64) delta_t tensor(0.8553, dtype=torch.float64)
3 gae_duplicate tensor(0.0272, dtype=torch.float64) tensor(-0.0566, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.9915, dtype=torch.float64) delta_t tensor(-0.9414, dtype=torch.float64)
2 gae_duplicate tensor(-0.9196, dtype=torch.float64) tensor(1.9125, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:36.474491119384766
value loss:9.993368148803711
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.37060022354126 seconds
19 rew tensor(0.8123, dtype=torch.float64) delta_t tensor(-0.1338, dtype=torch.float64)
19 gae_duplicate tensor(-0.1338, dtype=torch.float64) tensor(0.2782, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8126, dtype=torch.float64) delta_t tensor(0.6636, dtype=torch.float64)
18 gae_duplicate tensor(0.5566, dtype=torch.float64) tensor(-1.1579, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(-0.1782, dtype=torch.float64)
17 gae_duplicate tensor(0.2670, dtype=torch.float64) tensor(-0.5555, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(-0.6364, dtype=torch.float64)
16 gae_duplicate tensor(-0.4227, dtype=torch.float64) tensor(0.8792, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(0.0851, dtype=torch.float64)
15 gae_duplicate tensor(-0.2531, dtype=torch.float64) tensor(0.5263, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.2163, dtype=torch.float64)
14 gae_duplicate tensor(0.0138, dtype=torch.float64) tensor(-0.0288, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(0.2204, dtype=torch.float64)
13 gae_duplicate tensor(0.2314, dtype=torch.float64) tensor(-0.4812, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(0.2505, dtype=torch.float64)
12 gae_duplicate tensor(0.4357, dtype=torch.float64) tensor(-0.9058, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.3446, dtype=torch.float64)
11 gae_duplicate tensor(0.6931, dtype=torch.float64) tensor(-1.4415, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.1001, dtype=torch.float64)
10 gae_duplicate tensor(0.6546, dtype=torch.float64) tensor(-1.3617, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4322, dtype=torch.float64) delta_t tensor(-0.1615, dtype=torch.float64)
9 gae_duplicate tensor(0.3622, dtype=torch.float64) tensor(-0.7531, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1774, dtype=torch.float64) delta_t tensor(-0.2357, dtype=torch.float64)
8 gae_duplicate tensor(0.0540, dtype=torch.float64) tensor(-0.1123, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0775, dtype=torch.float64) delta_t tensor(-0.8049, dtype=torch.float64)
7 gae_duplicate tensor(-0.7617, dtype=torch.float64) tensor(1.5845, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6509, dtype=torch.float64) delta_t tensor(1.1523, dtype=torch.float64)
6 gae_duplicate tensor(0.5430, dtype=torch.float64) tensor(-1.1293, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9059, dtype=torch.float64) delta_t tensor(0.8133, dtype=torch.float64)
5 gae_duplicate tensor(1.2477, dtype=torch.float64) tensor(-2.5941, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6069, dtype=torch.float64) delta_t tensor(-0.7842, dtype=torch.float64)
4 gae_duplicate tensor(0.2139, dtype=torch.float64) tensor(-0.4448, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3530, dtype=torch.float64) delta_t tensor(1.0950, dtype=torch.float64)
3 gae_duplicate tensor(1.2661, dtype=torch.float64) tensor(-2.6338, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0988, dtype=torch.float64) delta_t tensor(0.0873, dtype=torch.float64)
2 gae_duplicate tensor(1.1002, dtype=torch.float64) tensor(-2.2874, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:74.59071350097656
value loss:10.82859992980957
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4283812046051025 seconds
19 rew tensor(0.8124, dtype=torch.float64) delta_t tensor(-0.3089, dtype=torch.float64)
19 gae_duplicate tensor(-0.3089, dtype=torch.float64) tensor(0.6423, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8126, dtype=torch.float64) delta_t tensor(0.6652, dtype=torch.float64)
18 gae_duplicate tensor(0.4181, dtype=torch.float64) tensor(-0.8690, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(-0.1971, dtype=torch.float64)
17 gae_duplicate tensor(0.1373, dtype=torch.float64) tensor(-0.2855, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(-0.1449, dtype=torch.float64)
16 gae_duplicate tensor(-0.0350, dtype=torch.float64) tensor(0.0728, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(-0.3687, dtype=torch.float64)
15 gae_duplicate tensor(-0.3967, dtype=torch.float64) tensor(0.8248, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.1973, dtype=torch.float64)
14 gae_duplicate tensor(-0.1200, dtype=torch.float64) tensor(0.2495, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.2058, dtype=torch.float64)
13 gae_duplicate tensor(0.1098, dtype=torch.float64) tensor(-0.2284, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(0.2447, dtype=torch.float64)
12 gae_duplicate tensor(0.3325, dtype=torch.float64) tensor(-0.6916, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.2392, dtype=torch.float64)
11 gae_duplicate tensor(0.5052, dtype=torch.float64) tensor(-1.0502, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.1258, dtype=torch.float64)
10 gae_duplicate tensor(0.5300, dtype=torch.float64) tensor(-1.1021, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.3251, dtype=torch.float64)
9 gae_duplicate tensor(0.7490, dtype=torch.float64) tensor(-1.5570, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1775, dtype=torch.float64) delta_t tensor(-0.2516, dtype=torch.float64)
8 gae_duplicate tensor(0.3477, dtype=torch.float64) tensor(-0.7228, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7146, dtype=torch.float64) delta_t tensor(-1.6374, dtype=torch.float64)
7 gae_duplicate tensor(-1.3592, dtype=torch.float64) tensor(2.8267, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7148, dtype=torch.float64) delta_t tensor(1.3863, dtype=torch.float64)
6 gae_duplicate tensor(0.2989, dtype=torch.float64) tensor(-0.6215, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0336, dtype=torch.float64) delta_t tensor(0.5992, dtype=torch.float64)
5 gae_duplicate tensor(0.8383, dtype=torch.float64) tensor(-1.7425, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1172, dtype=torch.float64) delta_t tensor(-1.3869, dtype=torch.float64)
4 gae_duplicate tensor(-0.7163, dtype=torch.float64) tensor(1.4892, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8642, dtype=torch.float64) delta_t tensor(1.0160, dtype=torch.float64)
3 gae_duplicate tensor(0.4430, dtype=torch.float64) tensor(-0.9213, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9088, dtype=torch.float64) delta_t tensor(-2.5577, dtype=torch.float64)
2 gae_duplicate tensor(-2.2033, dtype=torch.float64) tensor(4.5824, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6.499550819396973
value loss:15.009464263916016
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.9722)
ToM Target loss= tensor(305.3898)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.359622955322266 seconds
19 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(-0.4260, dtype=torch.float64)
19 gae_duplicate tensor(-0.4260, dtype=torch.float64) tensor(0.8857, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(0.6211, dtype=torch.float64)
18 gae_duplicate tensor(0.2803, dtype=torch.float64) tensor(-0.5831, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(-0.1786, dtype=torch.float64)
17 gae_duplicate tensor(0.0457, dtype=torch.float64) tensor(-0.0951, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(-0.8118, dtype=torch.float64)
16 gae_duplicate tensor(-0.7752, dtype=torch.float64) tensor(1.6123, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.2136, dtype=torch.float64)
15 gae_duplicate tensor(-0.4066, dtype=torch.float64) tensor(0.8455, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.1858, dtype=torch.float64)
14 gae_duplicate tensor(-0.1395, dtype=torch.float64) tensor(0.2901, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.1860, dtype=torch.float64)
13 gae_duplicate tensor(0.0744, dtype=torch.float64) tensor(-0.1547, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.1862, dtype=torch.float64)
12 gae_duplicate tensor(0.2458, dtype=torch.float64) tensor(-0.5111, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.1865, dtype=torch.float64)
11 gae_duplicate tensor(0.3831, dtype=torch.float64) tensor(-0.7969, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.1518, dtype=torch.float64)
10 gae_duplicate tensor(0.4583, dtype=torch.float64) tensor(-0.9531, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3687, dtype=torch.float64) delta_t tensor(-0.1627, dtype=torch.float64)
9 gae_duplicate tensor(0.2039, dtype=torch.float64) tensor(-0.4242, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1775, dtype=torch.float64) delta_t tensor(-0.2250, dtype=torch.float64)
8 gae_duplicate tensor(-0.0619, dtype=torch.float64) tensor(0.1286, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5874, dtype=torch.float64) delta_t tensor(-1.5195, dtype=torch.float64)
7 gae_duplicate tensor(-1.5690, dtype=torch.float64) tensor(3.2622, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7787, dtype=torch.float64) delta_t tensor(1.0835, dtype=torch.float64)
6 gae_duplicate tensor(-0.1717, dtype=torch.float64) tensor(0.3570, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0339, dtype=torch.float64) delta_t tensor(0.6004, dtype=torch.float64)
5 gae_duplicate tensor(0.4630, dtype=torch.float64) tensor(-0.9629, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8628, dtype=torch.float64) delta_t tensor(-1.0048, dtype=torch.float64)
4 gae_duplicate tensor(-0.6344, dtype=torch.float64) tensor(1.3187, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8642, dtype=torch.float64) delta_t tensor(0.8758, dtype=torch.float64)
3 gae_duplicate tensor(0.3683, dtype=torch.float64) tensor(-0.7657, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9088, dtype=torch.float64) delta_t tensor(-2.3937, dtype=torch.float64)
2 gae_duplicate tensor(-2.0991, dtype=torch.float64) tensor(4.3632, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-48.02251434326172
value loss:13.748821258544922
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.201634883880615 seconds
19 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(-0.4113, dtype=torch.float64)
19 gae_duplicate tensor(-0.4113, dtype=torch.float64) tensor(0.8556, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(0.5821, dtype=torch.float64)
18 gae_duplicate tensor(0.2530, dtype=torch.float64) tensor(-0.5261, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(-0.1761, dtype=torch.float64)
17 gae_duplicate tensor(0.0264, dtype=torch.float64) tensor(-0.0548, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(0.2841, dtype=torch.float64)
16 gae_duplicate tensor(0.3051, dtype=torch.float64) tensor(-0.6343, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(-0.8187, dtype=torch.float64)
15 gae_duplicate tensor(-0.5746, dtype=torch.float64) tensor(1.1948, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.1431, dtype=torch.float64)
14 gae_duplicate tensor(-0.3166, dtype=torch.float64) tensor(0.6586, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.1628, dtype=torch.float64)
13 gae_duplicate tensor(-0.0905, dtype=torch.float64) tensor(0.1882, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.3556, dtype=torch.float64)
12 gae_duplicate tensor(0.2832, dtype=torch.float64) tensor(-0.5888, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.1939, dtype=torch.float64)
11 gae_duplicate tensor(0.4205, dtype=torch.float64) tensor(-0.8743, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.0278, dtype=torch.float64)
10 gae_duplicate tensor(0.3642, dtype=torch.float64) tensor(-0.7572, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4960, dtype=torch.float64) delta_t tensor(-0.0998, dtype=torch.float64)
9 gae_duplicate tensor(0.1915, dtype=torch.float64) tensor(-0.3982, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3047, dtype=torch.float64) delta_t tensor(-0.3713, dtype=torch.float64)
8 gae_duplicate tensor(-0.2181, dtype=torch.float64) tensor(0.4534, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2055, dtype=torch.float64) delta_t tensor(-0.8309, dtype=torch.float64)
7 gae_duplicate tensor(-1.0054, dtype=torch.float64) tensor(2.0904, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2056, dtype=torch.float64) delta_t tensor(1.5491, dtype=torch.float64)
6 gae_duplicate tensor(0.7448, dtype=torch.float64) tensor(-1.5490, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7795, dtype=torch.float64) delta_t tensor(0.5561, dtype=torch.float64)
5 gae_duplicate tensor(1.1520, dtype=torch.float64) tensor(-2.3963, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7361, dtype=torch.float64) delta_t tensor(-0.6977, dtype=torch.float64)
4 gae_duplicate tensor(0.2239, dtype=torch.float64) tensor(-0.4655, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6097, dtype=torch.float64) delta_t tensor(0.8147, dtype=torch.float64)
3 gae_duplicate tensor(0.9938, dtype=torch.float64) tensor(-2.0668, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1003, dtype=torch.float64) delta_t tensor(-1.9560, dtype=torch.float64)
2 gae_duplicate tensor(-1.1609, dtype=torch.float64) tensor(2.4149, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:13.608732223510742
value loss:9.776311874389648
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5589540004730225 seconds
19 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(-0.3879, dtype=torch.float64)
19 gae_duplicate tensor(-0.3879, dtype=torch.float64) tensor(0.8064, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(0.6071, dtype=torch.float64)
18 gae_duplicate tensor(0.2968, dtype=torch.float64) tensor(-0.6171, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(-0.2482, dtype=torch.float64)
17 gae_duplicate tensor(-0.0107, dtype=torch.float64) tensor(0.0223, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(-0.7769, dtype=torch.float64)
16 gae_duplicate tensor(-0.7855, dtype=torch.float64) tensor(1.6332, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(0.1232, dtype=torch.float64)
15 gae_duplicate tensor(-0.5052, dtype=torch.float64) tensor(1.0504, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.1661, dtype=torch.float64)
14 gae_duplicate tensor(-0.2381, dtype=torch.float64) tensor(0.4951, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.2080, dtype=torch.float64)
13 gae_duplicate tensor(0.0176, dtype=torch.float64) tensor(-0.0365, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.1749, dtype=torch.float64)
12 gae_duplicate tensor(0.1889, dtype=torch.float64) tensor(-0.3929, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.1751, dtype=torch.float64)
11 gae_duplicate tensor(0.3262, dtype=torch.float64) tensor(-0.6781, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.1345, dtype=torch.float64)
10 gae_duplicate tensor(0.3955, dtype=torch.float64) tensor(-0.8225, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4321, dtype=torch.float64) delta_t tensor(-0.2045, dtype=torch.float64)
9 gae_duplicate tensor(0.1119, dtype=torch.float64) tensor(-0.2327, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2407, dtype=torch.float64) delta_t tensor(-0.0138, dtype=torch.float64)
8 gae_duplicate tensor(0.0757, dtype=torch.float64) tensor(-0.1575, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0783, dtype=torch.float64) delta_t tensor(-0.9838, dtype=torch.float64)
7 gae_duplicate tensor(-0.9232, dtype=torch.float64) tensor(1.9201, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0352, dtype=torch.float64) delta_t tensor(0.9437, dtype=torch.float64)
6 gae_duplicate tensor(0.2051, dtype=torch.float64) tensor(-0.4265, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2908, dtype=torch.float64) delta_t tensor(0.2536, dtype=torch.float64)
5 gae_duplicate tensor(0.4176, dtype=torch.float64) tensor(-0.8683, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8656, dtype=torch.float64) delta_t tensor(-0.9876, dtype=torch.float64)
4 gae_duplicate tensor(-0.6535, dtype=torch.float64) tensor(1.3585, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6117, dtype=torch.float64) delta_t tensor(0.9288, dtype=torch.float64)
3 gae_duplicate tensor(0.4060, dtype=torch.float64) tensor(-0.8443, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3573, dtype=torch.float64) delta_t tensor(-0.4843, dtype=torch.float64)
2 gae_duplicate tensor(-0.1595, dtype=torch.float64) tensor(0.3316, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-16.370267868041992
value loss:4.756389617919922
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.127421140670776 seconds
19 rew tensor(0.8126, dtype=torch.float64) delta_t tensor(-0.5468, dtype=torch.float64)
19 gae_duplicate tensor(-0.5468, dtype=torch.float64) tensor(1.1369, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(0.5767, dtype=torch.float64)
18 gae_duplicate tensor(0.1392, dtype=torch.float64) tensor(-0.2896, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(-0.2640, dtype=torch.float64)
17 gae_duplicate tensor(-0.1526, dtype=torch.float64) tensor(0.3173, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(-0.8141, dtype=torch.float64)
16 gae_duplicate tensor(-0.9362, dtype=torch.float64) tensor(1.9461, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.2167, dtype=torch.float64)
15 gae_duplicate tensor(-0.5323, dtype=torch.float64) tensor(1.1067, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(0.1606, dtype=torch.float64)
14 gae_duplicate tensor(-0.2653, dtype=torch.float64) tensor(0.5516, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.1608, dtype=torch.float64)
13 gae_duplicate tensor(-0.0514, dtype=torch.float64) tensor(0.1069, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.1610, dtype=torch.float64)
12 gae_duplicate tensor(0.1199, dtype=torch.float64) tensor(-0.2494, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.1613, dtype=torch.float64)
11 gae_duplicate tensor(0.2572, dtype=torch.float64) tensor(-0.5347, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.0764, dtype=torch.float64)
10 gae_duplicate tensor(0.2822, dtype=torch.float64) tensor(-0.5867, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.1528, dtype=torch.float64)
9 gae_duplicate tensor(0.3786, dtype=torch.float64) tensor(-0.7872, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2408, dtype=torch.float64) delta_t tensor(-0.1529, dtype=torch.float64)
8 gae_duplicate tensor(0.1499, dtype=torch.float64) tensor(-0.3117, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0781, dtype=torch.float64) delta_t tensor(-0.8780, dtype=torch.float64)
7 gae_duplicate tensor(-0.7580, dtype=torch.float64) tensor(1.5765, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0349, dtype=torch.float64) delta_t tensor(1.0124, dtype=torch.float64)
6 gae_duplicate tensor(0.4060, dtype=torch.float64) tensor(-0.8440, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4180, dtype=torch.float64) delta_t tensor(0.0405, dtype=torch.float64)
5 gae_duplicate tensor(0.3653, dtype=torch.float64) tensor(-0.7596, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1204, dtype=torch.float64) delta_t tensor(-1.1324, dtype=torch.float64)
4 gae_duplicate tensor(-0.8402, dtype=torch.float64) tensor(1.7469, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8671, dtype=torch.float64) delta_t tensor(0.5590, dtype=torch.float64)
3 gae_duplicate tensor(-0.1131, dtype=torch.float64) tensor(0.2352, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6130, dtype=torch.float64) delta_t tensor(-0.6290, dtype=torch.float64)
2 gae_duplicate tensor(-0.7195, dtype=torch.float64) tensor(1.4967, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-36.2708854675293
value loss:6.014366626739502
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.199347019195557 seconds
19 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(-0.3038, dtype=torch.float64)
19 gae_duplicate tensor(-0.3038, dtype=torch.float64) tensor(0.6316, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(0.6159, dtype=torch.float64)
18 gae_duplicate tensor(0.3728, dtype=torch.float64) tensor(-0.7755, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(-0.1646, dtype=torch.float64)
17 gae_duplicate tensor(0.1336, dtype=torch.float64) tensor(-0.2779, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(-0.3645, dtype=torch.float64)
16 gae_duplicate tensor(-0.2576, dtype=torch.float64) tensor(0.5357, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(-0.2877, dtype=torch.float64)
15 gae_duplicate tensor(-0.4938, dtype=torch.float64) tensor(1.0266, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.1480, dtype=torch.float64)
14 gae_duplicate tensor(-0.2470, dtype=torch.float64) tensor(0.5137, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.1468, dtype=torch.float64)
13 gae_duplicate tensor(-0.0508, dtype=torch.float64) tensor(0.1058, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.1389, dtype=torch.float64)
12 gae_duplicate tensor(0.0983, dtype=torch.float64) tensor(-0.2044, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.1789, dtype=torch.float64)
11 gae_duplicate tensor(0.2576, dtype=torch.float64) tensor(-0.5356, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.2219, dtype=torch.float64)
10 gae_duplicate tensor(0.4279, dtype=torch.float64) tensor(-0.8897, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3043, dtype=torch.float64) delta_t tensor(-0.3659, dtype=torch.float64)
9 gae_duplicate tensor(-0.0235, dtype=torch.float64) tensor(0.0489, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1128, dtype=torch.float64) delta_t tensor(-0.0111, dtype=torch.float64)
8 gae_duplicate tensor(-0.0299, dtype=torch.float64) tensor(0.0622, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2062, dtype=torch.float64) delta_t tensor(-1.0155, dtype=torch.float64)
7 gae_duplicate tensor(-1.0394, dtype=torch.float64) tensor(2.1617, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1634, dtype=torch.float64) delta_t tensor(0.6637, dtype=torch.float64)
6 gae_duplicate tensor(-0.1678, dtype=torch.float64) tensor(0.3491, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4191, dtype=torch.float64) delta_t tensor(0.1932, dtype=torch.float64)
5 gae_duplicate tensor(0.0589, dtype=torch.float64) tensor(-0.1226, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7390, dtype=torch.float64) delta_t tensor(-0.8910, dtype=torch.float64)
4 gae_duplicate tensor(-0.8439, dtype=torch.float64) tensor(1.7546, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4848, dtype=torch.float64) delta_t tensor(1.0094, dtype=torch.float64)
3 gae_duplicate tensor(0.3343, dtype=torch.float64) tensor(-0.6952, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2301, dtype=torch.float64) delta_t tensor(-0.5220, dtype=torch.float64)
2 gae_duplicate tensor(-0.2545, dtype=torch.float64) tensor(0.5292, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-26.432004928588867
value loss:4.326355457305908
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.3462)
ToM Target loss= tensor(305.4311)
optimized based on ToM loss
---------------------
gamma: 0.8
Process Process-4:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 251, in recv
    return _ForkingPickler.loads(buf.getbuffer())
KeyboardInterrupt