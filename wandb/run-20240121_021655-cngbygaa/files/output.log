obs <crafter.objects.Shelter object at 0x13b81c8e0> [ 0 39  0  0 39  0  0  9  0]
obs <crafter.objects.Warehouse object at 0x11f6fb9d0> [ 0 37  0  0 41  0  0  9  0]
obs <crafter.objects.Station object at 0x13b8223d0> [ 0  9  0  0  9  0  0 14  0]
obs <crafter.objects.Shelter object at 0x13b81c8e0> [ 0 39  0  0 39  0  0  9  0]
obs <crafter.objects.Warehouse object at 0x11f6fb9d0> [ 0 41  0  0 40  0  0  9  0]
obs <crafter.objects.Station object at 0x13b8223d0> [ 0  9  0  0  9  0  0 10  0]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0005750656127929688 seconds
19 rew tensor(0.8340, dtype=torch.float64) delta_t tensor(0.5121, dtype=torch.float64)
19 gae_duplicate tensor(0.5121, dtype=torch.float64) tensor(-1.0385, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8714, dtype=torch.float64) delta_t tensor(0.8070, dtype=torch.float64)
18 gae_duplicate tensor(1.2167, dtype=torch.float64) tensor(-2.4750, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9145, dtype=torch.float64) delta_t tensor(0.9551, dtype=torch.float64)
17 gae_duplicate tensor(1.9284, dtype=torch.float64) tensor(-4.3906, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9648, dtype=torch.float64) delta_t tensor(0.9347, dtype=torch.float64)
16 gae_duplicate tensor(2.4774, dtype=torch.float64) tensor(-5.6590, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0248, dtype=torch.float64) delta_t tensor(1.0031, dtype=torch.float64)
15 gae_duplicate tensor(2.9851, dtype=torch.float64) tensor(-5.7126, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0978, dtype=torch.float64) delta_t tensor(1.1417, dtype=torch.float64)
14 gae_duplicate tensor(3.5297, dtype=torch.float64) tensor(-6.7954, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.1896, dtype=torch.float64) delta_t tensor(1.1591, dtype=torch.float64)
13 gae_duplicate tensor(3.9828, dtype=torch.float64) tensor(-8.9016, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.3100, dtype=torch.float64) delta_t tensor(1.3114, dtype=torch.float64)
12 gae_duplicate tensor(4.4976, dtype=torch.float64) tensor(-9.9427, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.4781, dtype=torch.float64) delta_t tensor(1.4602, dtype=torch.float64)
11 gae_duplicate tensor(5.0583, dtype=torch.float64) tensor(-11.2134, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(1.7371, dtype=torch.float64) delta_t tensor(1.7350, dtype=torch.float64)
10 gae_duplicate tensor(5.7817, dtype=torch.float64) tensor(-12.8270, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(1.8014, dtype=torch.float64) delta_t tensor(1.5762, dtype=torch.float64)
9 gae_duplicate tensor(6.2015, dtype=torch.float64) tensor(-11.7301, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(1.9302, dtype=torch.float64) delta_t tensor(1.8559, dtype=torch.float64)
8 gae_duplicate tensor(6.8171, dtype=torch.float64) tensor(-12.8417, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(1.0529, dtype=torch.float64) delta_t tensor(0.9838, dtype=torch.float64)
7 gae_duplicate tensor(6.4375, dtype=torch.float64) tensor(-15.4840, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.0552, dtype=torch.float64) delta_t tensor(0.8594, dtype=torch.float64)
6 gae_duplicate tensor(6.0094, dtype=torch.float64) tensor(-11.0050, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.5441, dtype=torch.float64) delta_t tensor(0.4150, dtype=torch.float64)
5 gae_duplicate tensor(5.2225, dtype=torch.float64) tensor(-12.1423, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0772, dtype=torch.float64) delta_t tensor(-1.1986, dtype=torch.float64)
4 gae_duplicate tensor(2.9794, dtype=torch.float64) tensor(-5.7165, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4606, dtype=torch.float64) delta_t tensor(-1.4689, dtype=torch.float64)
3 gae_duplicate tensor(0.9146, dtype=torch.float64) tensor(-1.7768, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2182, dtype=torch.float64) delta_t tensor(0.5123, dtype=torch.float64)
2 gae_duplicate tensor(1.2440, dtype=torch.float64) tensor(-2.2851, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:850.5092163085938
value loss:493.6431884765625
entropies:37.10410690307617
Policy training finished
---------------------
gamma: 0.8
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 4.597023963928223 seconds
19 rew tensor(0.8009, dtype=torch.float64) delta_t tensor(0.5994, dtype=torch.float64)
19 gae_duplicate tensor(0.5994, dtype=torch.float64) tensor(-1.2447, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8177, dtype=torch.float64) delta_t tensor(0.8438, dtype=torch.float64)
18 gae_duplicate tensor(1.3233, dtype=torch.float64) tensor(-2.7480, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8357, dtype=torch.float64) delta_t tensor(0.7741, dtype=torch.float64)
17 gae_duplicate tensor(1.8327, dtype=torch.float64) tensor(-3.8163, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8549, dtype=torch.float64) delta_t tensor(0.8876, dtype=torch.float64)
16 gae_duplicate tensor(2.3538, dtype=torch.float64) tensor(-4.9009, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8756, dtype=torch.float64) delta_t tensor(0.8182, dtype=torch.float64)
15 gae_duplicate tensor(2.7012, dtype=torch.float64) tensor(-5.6097, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8978, dtype=torch.float64) delta_t tensor(0.7877, dtype=torch.float64)
14 gae_duplicate tensor(2.9486, dtype=torch.float64) tensor(-6.1232, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9218, dtype=torch.float64) delta_t tensor(0.9034, dtype=torch.float64)
13 gae_duplicate tensor(3.2623, dtype=torch.float64) tensor(-6.7927, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9479, dtype=torch.float64) delta_t tensor(0.9417, dtype=torch.float64)
12 gae_duplicate tensor(3.5515, dtype=torch.float64) tensor(-7.3750, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9764, dtype=torch.float64) delta_t tensor(0.9438, dtype=torch.float64)
11 gae_duplicate tensor(3.7849, dtype=torch.float64) tensor(-7.8814, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(1.0076, dtype=torch.float64) delta_t tensor(0.9750, dtype=torch.float64)
10 gae_duplicate tensor(4.0030, dtype=torch.float64) tensor(-8.2906, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1233, dtype=torch.float64) delta_t tensor(-1.0968, dtype=torch.float64)
9 gae_duplicate tensor(2.1056, dtype=torch.float64) tensor(-4.1244, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4646, dtype=torch.float64) delta_t tensor(0.2978, dtype=torch.float64)
8 gae_duplicate tensor(1.9822, dtype=torch.float64) tensor(-3.9073, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1390, dtype=torch.float64) delta_t tensor(0.2566, dtype=torch.float64)
7 gae_duplicate tensor(1.8424, dtype=torch.float64) tensor(-3.6787, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7805, dtype=torch.float64) delta_t tensor(-0.9498, dtype=torch.float64)
6 gae_duplicate tensor(0.5241, dtype=torch.float64) tensor(-1.2121, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1121, dtype=torch.float64) delta_t tensor(-2.1672, dtype=torch.float64)
5 gae_duplicate tensor(-1.7480, dtype=torch.float64) tensor(3.7904, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5252, dtype=torch.float64) delta_t tensor(0.3303, dtype=torch.float64)
4 gae_duplicate tensor(-1.0681, dtype=torch.float64) tensor(2.4154, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7680, dtype=torch.float64) delta_t tensor(-1.9154, dtype=torch.float64)
3 gae_duplicate tensor(-2.7699, dtype=torch.float64) tensor(5.5436, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-2.0952, dtype=torch.float64) delta_t tensor(-2.1714, dtype=torch.float64)
2 gae_duplicate tensor(-4.3873, dtype=torch.float64) tensor(9.2583, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:279.0628356933594
value loss:185.631103515625
entropies:37.36967468261719
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.415402889251709 seconds
19 rew tensor(0.7776, dtype=torch.float64) delta_t tensor(0.4715, dtype=torch.float64)
19 gae_duplicate tensor(0.4715, dtype=torch.float64) tensor(-0.9459, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7881, dtype=torch.float64) delta_t tensor(0.9684, dtype=torch.float64)
18 gae_duplicate tensor(1.3456, dtype=torch.float64) tensor(-2.7676, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7992, dtype=torch.float64) delta_t tensor(0.6609, dtype=torch.float64)
17 gae_duplicate tensor(1.7374, dtype=torch.float64) tensor(-3.6081, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8106, dtype=torch.float64) delta_t tensor(0.7509, dtype=torch.float64)
16 gae_duplicate tensor(2.1408, dtype=torch.float64) tensor(-4.4458, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8226, dtype=torch.float64) delta_t tensor(0.7583, dtype=torch.float64)
15 gae_duplicate tensor(2.4709, dtype=torch.float64) tensor(-5.1589, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8352, dtype=torch.float64) delta_t tensor(0.7879, dtype=torch.float64)
14 gae_duplicate tensor(2.7646, dtype=torch.float64) tensor(-5.7564, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8484, dtype=torch.float64) delta_t tensor(0.7834, dtype=torch.float64)
13 gae_duplicate tensor(2.9950, dtype=torch.float64) tensor(-6.2363, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8622, dtype=torch.float64) delta_t tensor(0.8162, dtype=torch.float64)
12 gae_duplicate tensor(3.2122, dtype=torch.float64) tensor(-6.6480, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8767, dtype=torch.float64) delta_t tensor(0.8444, dtype=torch.float64)
11 gae_duplicate tensor(3.4141, dtype=torch.float64) tensor(-7.1364, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8919, dtype=torch.float64) delta_t tensor(0.8458, dtype=torch.float64)
10 gae_duplicate tensor(3.5771, dtype=torch.float64) tensor(-7.4204, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9080, dtype=torch.float64) delta_t tensor(0.8641, dtype=torch.float64)
9 gae_duplicate tensor(3.7257, dtype=torch.float64) tensor(-7.7264, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1850, dtype=torch.float64) delta_t tensor(0.0892, dtype=torch.float64)
8 gae_duplicate tensor(3.0698, dtype=torch.float64) tensor(-6.3914, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6066, dtype=torch.float64) delta_t tensor(-0.4483, dtype=torch.float64)
7 gae_duplicate tensor(2.0075, dtype=torch.float64) tensor(-4.2443, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9792, dtype=torch.float64) delta_t tensor(-1.1026, dtype=torch.float64)
6 gae_duplicate tensor(0.5034, dtype=torch.float64) tensor(-1.0425, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.7582, dtype=torch.float64) delta_t tensor(-3.0129, dtype=torch.float64)
5 gae_duplicate tensor(-2.6102, dtype=torch.float64) tensor(5.4059, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5382, dtype=torch.float64) delta_t tensor(-2.6524, dtype=torch.float64)
4 gae_duplicate tensor(-4.7406, dtype=torch.float64) tensor(9.3637, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7339, dtype=torch.float64) delta_t tensor(-0.8339, dtype=torch.float64)
3 gae_duplicate tensor(-4.6264, dtype=torch.float64) tensor(9.5107, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6767, dtype=torch.float64) delta_t tensor(-0.7475, dtype=torch.float64)
2 gae_duplicate tensor(-4.4486, dtype=torch.float64) tensor(9.0660, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:215.97000122070312
value loss:247.78652954101562
entropies:37.41765594482422
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.368710994720459 seconds
19 rew tensor(0.7645, dtype=torch.float64) delta_t tensor(0.4967, dtype=torch.float64)
19 gae_duplicate tensor(0.4967, dtype=torch.float64) tensor(-1.0315, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7721, dtype=torch.float64) delta_t tensor(0.7446, dtype=torch.float64)
18 gae_duplicate tensor(1.1420, dtype=torch.float64) tensor(-2.3716, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7800, dtype=torch.float64) delta_t tensor(0.6793, dtype=torch.float64)
17 gae_duplicate tensor(1.5929, dtype=torch.float64) tensor(-3.3080, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7882, dtype=torch.float64) delta_t tensor(0.7293, dtype=torch.float64)
16 gae_duplicate tensor(2.0036, dtype=torch.float64) tensor(-4.1501, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7966, dtype=torch.float64) delta_t tensor(0.7209, dtype=torch.float64)
15 gae_duplicate tensor(2.3239, dtype=torch.float64) tensor(-4.8385, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8053, dtype=torch.float64) delta_t tensor(0.8939, dtype=torch.float64)
14 gae_duplicate tensor(2.7529, dtype=torch.float64) tensor(-5.7320, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.7607, dtype=torch.float64)
13 gae_duplicate tensor(2.9631, dtype=torch.float64) tensor(-6.1375, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8235, dtype=torch.float64) delta_t tensor(0.8343, dtype=torch.float64)
12 gae_duplicate tensor(3.2048, dtype=torch.float64) tensor(-6.3820, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8331, dtype=torch.float64) delta_t tensor(0.8302, dtype=torch.float64)
11 gae_duplicate tensor(3.3940, dtype=torch.float64) tensor(-6.8440, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8431, dtype=torch.float64) delta_t tensor(0.7494, dtype=torch.float64)
10 gae_duplicate tensor(3.4646, dtype=torch.float64) tensor(-7.1125, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8534, dtype=torch.float64) delta_t tensor(0.7653, dtype=torch.float64)
9 gae_duplicate tensor(3.5369, dtype=torch.float64) tensor(-7.3453, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6967, dtype=torch.float64) delta_t tensor(-0.7171, dtype=torch.float64)
8 gae_duplicate tensor(2.1125, dtype=torch.float64) tensor(-4.3869, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1665, dtype=torch.float64) delta_t tensor(0.0815, dtype=torch.float64)
7 gae_duplicate tensor(1.7715, dtype=torch.float64) tensor(-3.4315, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1410, dtype=torch.float64) delta_t tensor(-0.3133, dtype=torch.float64)
6 gae_duplicate tensor(1.1039, dtype=torch.float64) tensor(-2.1483, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6742, dtype=torch.float64) delta_t tensor(-1.7377, dtype=torch.float64)
5 gae_duplicate tensor(-0.8546, dtype=torch.float64) tensor(1.8925, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7003, dtype=torch.float64) delta_t tensor(0.5265, dtype=torch.float64)
4 gae_duplicate tensor(-0.1572, dtype=torch.float64) tensor(0.3509, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7692, dtype=torch.float64) delta_t tensor(-1.2102, dtype=torch.float64)
3 gae_duplicate tensor(-1.3359, dtype=torch.float64) tensor(2.4618, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7667, dtype=torch.float64) delta_t tensor(-2.1409, dtype=torch.float64)
2 gae_duplicate tensor(-3.2096, dtype=torch.float64) tensor(5.9692, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:326.1518859863281
value loss:146.73716735839844
entropies:37.31245040893555
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.455082178115845 seconds
19 rew tensor(0.5425, dtype=torch.float64) delta_t tensor(0.0675, dtype=torch.float64)
19 gae_duplicate tensor(0.0675, dtype=torch.float64) tensor(-0.1322, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2487, dtype=torch.float64) delta_t tensor(0.2246, dtype=torch.float64)
18 gae_duplicate tensor(0.2786, dtype=torch.float64) tensor(-0.5521, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.2826, dtype=torch.float64) delta_t tensor(-0.0520, dtype=torch.float64)
17 gae_duplicate tensor(0.1708, dtype=torch.float64) tensor(-0.3624, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-1.2266, dtype=torch.float64) delta_t tensor(-1.5722, dtype=torch.float64)
16 gae_duplicate tensor(-1.4356, dtype=torch.float64) tensor(2.9892, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7653, dtype=torch.float64) delta_t tensor(0.7182, dtype=torch.float64)
15 gae_duplicate tensor(-0.4303, dtype=torch.float64) tensor(0.8913, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7128, dtype=torch.float64) delta_t tensor(0.6115, dtype=torch.float64)
14 gae_duplicate tensor(0.2672, dtype=torch.float64) tensor(-0.5578, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7773, dtype=torch.float64) delta_t tensor(0.6656, dtype=torch.float64)
13 gae_duplicate tensor(0.8793, dtype=torch.float64) tensor(-1.8214, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7253, dtype=torch.float64) delta_t tensor(0.6418, dtype=torch.float64)
12 gae_duplicate tensor(1.3453, dtype=torch.float64) tensor(-2.7937, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7898, dtype=torch.float64) delta_t tensor(0.9946, dtype=torch.float64)
11 gae_duplicate tensor(2.0708, dtype=torch.float64) tensor(-4.4567, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6217, dtype=torch.float64) delta_t tensor(0.5257, dtype=torch.float64)
10 gae_duplicate tensor(2.1823, dtype=torch.float64) tensor(-4.6873, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6536, dtype=torch.float64) delta_t tensor(-0.7250, dtype=torch.float64)
9 gae_duplicate tensor(1.0208, dtype=torch.float64) tensor(-2.0443, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7749, dtype=torch.float64) delta_t tensor(-0.7805, dtype=torch.float64)
8 gae_duplicate tensor(0.0361, dtype=torch.float64) tensor(-0.0733, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2611, dtype=torch.float64) delta_t tensor(-0.2379, dtype=torch.float64)
7 gae_duplicate tensor(-0.2090, dtype=torch.float64) tensor(0.4291, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0685, dtype=torch.float64) delta_t tensor(-1.0739, dtype=torch.float64)
6 gae_duplicate tensor(-1.2411, dtype=torch.float64) tensor(2.5841, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4276, dtype=torch.float64) delta_t tensor(-1.6926, dtype=torch.float64)
5 gae_duplicate tensor(-2.6855, dtype=torch.float64) tensor(5.5772, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.3526, dtype=torch.float64) delta_t tensor(-4.5687, dtype=torch.float64)
4 gae_duplicate tensor(-6.7171, dtype=torch.float64) tensor(14.1876, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1289, dtype=torch.float64) delta_t tensor(0.0887, dtype=torch.float64)
3 gae_duplicate tensor(-5.2849, dtype=torch.float64) tensor(12.2993, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2601, dtype=torch.float64) delta_t tensor(-0.3532, dtype=torch.float64)
2 gae_duplicate tensor(-4.5811, dtype=torch.float64) tensor(10.5115, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-193.0492706298828
value loss:176.90586853027344
entropies:37.365394592285156
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.4705)
ToM Target loss= tensor(300.0894)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.526610851287842 seconds
19 rew tensor(0.7915, dtype=torch.float64) delta_t tensor(0.5807, dtype=torch.float64)
19 gae_duplicate tensor(0.5807, dtype=torch.float64) tensor(-1.2092, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7969, dtype=torch.float64) delta_t tensor(0.8086, dtype=torch.float64)
18 gae_duplicate tensor(1.2732, dtype=torch.float64) tensor(-2.6582, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8025, dtype=torch.float64) delta_t tensor(0.7658, dtype=torch.float64)
17 gae_duplicate tensor(1.7843, dtype=torch.float64) tensor(-3.7154, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8081, dtype=torch.float64) delta_t tensor(0.6529, dtype=torch.float64)
16 gae_duplicate tensor(2.0803, dtype=torch.float64) tensor(-4.3865, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.7800, dtype=torch.float64)
15 gae_duplicate tensor(2.4443, dtype=torch.float64) tensor(-5.1715, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8197, dtype=torch.float64) delta_t tensor(0.7814, dtype=torch.float64)
14 gae_duplicate tensor(2.7368, dtype=torch.float64) tensor(-5.6337, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8258, dtype=torch.float64) delta_t tensor(0.7670, dtype=torch.float64)
13 gae_duplicate tensor(2.9564, dtype=torch.float64) tensor(-6.1395, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8319, dtype=torch.float64) delta_t tensor(0.8171, dtype=torch.float64)
12 gae_duplicate tensor(3.1822, dtype=torch.float64) tensor(-6.6081, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8382, dtype=torch.float64) delta_t tensor(0.7992, dtype=torch.float64)
11 gae_duplicate tensor(3.3449, dtype=torch.float64) tensor(-6.9652, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6025, dtype=torch.float64) delta_t tensor(0.6544, dtype=torch.float64)
10 gae_duplicate tensor(3.3303, dtype=torch.float64) tensor(-6.8191, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3045, dtype=torch.float64) delta_t tensor(0.2608, dtype=torch.float64)
9 gae_duplicate tensor(2.9250, dtype=torch.float64) tensor(-5.6097, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3551, dtype=torch.float64) delta_t tensor(-0.4141, dtype=torch.float64)
8 gae_duplicate tensor(1.9259, dtype=torch.float64) tensor(-4.4011, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1773, dtype=torch.float64) delta_t tensor(-0.3328, dtype=torch.float64)
7 gae_duplicate tensor(1.2079, dtype=torch.float64) tensor(-2.7223, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5486, dtype=torch.float64) delta_t tensor(-1.7149, dtype=torch.float64)
6 gae_duplicate tensor(-0.7485, dtype=torch.float64) tensor(1.6783, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2740, dtype=torch.float64) delta_t tensor(-1.4473, dtype=torch.float64)
5 gae_duplicate tensor(-2.0461, dtype=torch.float64) tensor(4.6337, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3874, dtype=torch.float64) delta_t tensor(-0.3379, dtype=torch.float64)
4 gae_duplicate tensor(-1.9748, dtype=torch.float64) tensor(3.8385, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7080, dtype=torch.float64) delta_t tensor(-1.8919, dtype=torch.float64)
3 gae_duplicate tensor(-3.4718, dtype=torch.float64) tensor(7.0756, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2890, dtype=torch.float64) delta_t tensor(-0.2971, dtype=torch.float64)
2 gae_duplicate tensor(-3.0745, dtype=torch.float64) tensor(6.5279, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:228.59146118164062
value loss:161.93585205078125
entropies:37.34482955932617
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.380367994308472 seconds
19 rew tensor(0.7135, dtype=torch.float64) delta_t tensor(0.2460, dtype=torch.float64)
19 gae_duplicate tensor(0.2460, dtype=torch.float64) tensor(-0.4694, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5909, dtype=torch.float64) delta_t tensor(0.4984, dtype=torch.float64)
18 gae_duplicate tensor(0.6952, dtype=torch.float64) tensor(-1.3320, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3414, dtype=torch.float64) delta_t tensor(0.2475, dtype=torch.float64)
17 gae_duplicate tensor(0.8037, dtype=torch.float64) tensor(-1.7985, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.2859, dtype=torch.float64) delta_t tensor(-0.0742, dtype=torch.float64)
16 gae_duplicate tensor(0.5687, dtype=torch.float64) tensor(-1.2266, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-1.2270, dtype=torch.float64) delta_t tensor(-1.3899, dtype=torch.float64)
15 gae_duplicate tensor(-0.9349, dtype=torch.float64) tensor(1.9412, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7706, dtype=torch.float64) delta_t tensor(0.6696, dtype=torch.float64)
14 gae_duplicate tensor(-0.0783, dtype=torch.float64) tensor(0.1631, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8379, dtype=torch.float64) delta_t tensor(0.8353, dtype=torch.float64)
13 gae_duplicate tensor(0.7727, dtype=torch.float64) tensor(-1.6045, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7806, dtype=torch.float64) delta_t tensor(0.6854, dtype=torch.float64)
12 gae_duplicate tensor(1.3035, dtype=torch.float64) tensor(-2.7143, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8479, dtype=torch.float64) delta_t tensor(0.7856, dtype=torch.float64)
11 gae_duplicate tensor(1.8284, dtype=torch.float64) tensor(-3.7860, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8535, dtype=torch.float64) delta_t tensor(0.7492, dtype=torch.float64)
10 gae_duplicate tensor(2.2119, dtype=torch.float64) tensor(-4.8138, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1104, dtype=torch.float64) delta_t tensor(0.2213, dtype=torch.float64)
9 gae_duplicate tensor(1.9908, dtype=torch.float64) tensor(-4.3411, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5108, dtype=torch.float64) delta_t tensor(-0.5263, dtype=torch.float64)
8 gae_duplicate tensor(1.0664, dtype=torch.float64) tensor(-2.1213, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5752, dtype=torch.float64) delta_t tensor(-0.6223, dtype=torch.float64)
7 gae_duplicate tensor(0.2308, dtype=torch.float64) tensor(-0.4645, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3310, dtype=torch.float64) delta_t tensor(-0.5004, dtype=torch.float64)
6 gae_duplicate tensor(-0.3157, dtype=torch.float64) tensor(0.6087, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0716, dtype=torch.float64) delta_t tensor(-1.1281, dtype=torch.float64)
5 gae_duplicate tensor(-1.3806, dtype=torch.float64) tensor(3.2216, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2657, dtype=torch.float64) delta_t tensor(-1.6346, dtype=torch.float64)
4 gae_duplicate tensor(-2.7391, dtype=torch.float64) tensor(5.2814, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6613, dtype=torch.float64) delta_t tensor(-0.6568, dtype=torch.float64)
3 gae_duplicate tensor(-2.8481, dtype=torch.float64) tensor(6.0686, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7268, dtype=torch.float64) delta_t tensor(-0.8308, dtype=torch.float64)
2 gae_duplicate tensor(-3.1093, dtype=torch.float64) tensor(6.7448, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2.73665714263916
value loss:68.05072784423828
entropies:37.3108024597168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.425382137298584 seconds
19 rew tensor(0.8452, dtype=torch.float64) delta_t tensor(0.5162, dtype=torch.float64)
19 gae_duplicate tensor(0.5162, dtype=torch.float64) tensor(-1.1289, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8498, dtype=torch.float64) delta_t tensor(0.7977, dtype=torch.float64)
18 gae_duplicate tensor(1.2107, dtype=torch.float64) tensor(-2.6327, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8544, dtype=torch.float64) delta_t tensor(0.7859, dtype=torch.float64)
17 gae_duplicate tensor(1.7544, dtype=torch.float64) tensor(-3.5413, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8591, dtype=torch.float64) delta_t tensor(0.8591, dtype=torch.float64)
16 gae_duplicate tensor(2.2627, dtype=torch.float64) tensor(-4.7813, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8639, dtype=torch.float64) delta_t tensor(0.8123, dtype=torch.float64)
15 gae_duplicate tensor(2.6225, dtype=torch.float64) tensor(-5.4290, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8688, dtype=torch.float64) delta_t tensor(0.8986, dtype=torch.float64)
14 gae_duplicate tensor(2.9966, dtype=torch.float64) tensor(-6.2037, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8737, dtype=torch.float64) delta_t tensor(0.8014, dtype=torch.float64)
13 gae_duplicate tensor(3.1987, dtype=torch.float64) tensor(-6.6613, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8788, dtype=torch.float64) delta_t tensor(0.8329, dtype=torch.float64)
12 gae_duplicate tensor(3.3919, dtype=torch.float64) tensor(-7.0317, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8839, dtype=torch.float64) delta_t tensor(0.8392, dtype=torch.float64)
11 gae_duplicate tensor(3.5527, dtype=torch.float64) tensor(-7.4735, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4462, dtype=torch.float64) delta_t tensor(0.2996, dtype=torch.float64)
10 gae_duplicate tensor(3.1417, dtype=torch.float64) tensor(-6.3223, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3218, dtype=torch.float64) delta_t tensor(0.4068, dtype=torch.float64)
9 gae_duplicate tensor(2.9202, dtype=torch.float64) tensor(-6.4779, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0084, dtype=torch.float64) delta_t tensor(-0.0735, dtype=torch.float64)
8 gae_duplicate tensor(2.2626, dtype=torch.float64) tensor(-4.1254, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8693, dtype=torch.float64) delta_t tensor(-0.8957, dtype=torch.float64)
7 gae_duplicate tensor(0.9144, dtype=torch.float64) tensor(-1.7708, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2504, dtype=torch.float64) delta_t tensor(-1.4975, dtype=torch.float64)
6 gae_duplicate tensor(-0.7660, dtype=torch.float64) tensor(1.4318, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6381, dtype=torch.float64) delta_t tensor(-1.6546, dtype=torch.float64)
5 gae_duplicate tensor(-2.2674, dtype=torch.float64) tensor(5.3782, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5329, dtype=torch.float64) delta_t tensor(-1.8443, dtype=torch.float64)
4 gae_duplicate tensor(-3.6583, dtype=torch.float64) tensor(6.9835, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8048, dtype=torch.float64) delta_t tensor(-1.8450, dtype=torch.float64)
3 gae_duplicate tensor(-4.7716, dtype=torch.float64) tensor(9.1684, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3610, dtype=torch.float64) delta_t tensor(-0.4358, dtype=torch.float64)
2 gae_duplicate tensor(-4.2531, dtype=torch.float64) tensor(9.4742, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:185.74391174316406
value loss:216.69996643066406
entropies:37.248722076416016
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.307066917419434 seconds
19 rew tensor(0.8734, dtype=torch.float64) delta_t tensor(0.5268, dtype=torch.float64)
19 gae_duplicate tensor(0.5268, dtype=torch.float64) tensor(-1.1276, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7452, dtype=torch.float64) delta_t tensor(0.6809, dtype=torch.float64)
18 gae_duplicate tensor(1.1023, dtype=torch.float64) tensor(-2.3493, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7485, dtype=torch.float64) delta_t tensor(0.6896, dtype=torch.float64)
17 gae_duplicate tensor(1.5714, dtype=torch.float64) tensor(-3.3502, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6196, dtype=torch.float64) delta_t tensor(0.6107, dtype=torch.float64)
16 gae_duplicate tensor(1.8678, dtype=torch.float64) tensor(-3.9861, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4242, dtype=torch.float64) delta_t tensor(0.3992, dtype=torch.float64)
15 gae_duplicate tensor(1.8935, dtype=torch.float64) tensor(-3.8902, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0308, dtype=torch.float64) delta_t tensor(-0.0445, dtype=torch.float64)
14 gae_duplicate tensor(1.4703, dtype=torch.float64) tensor(-3.0528, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8183, dtype=torch.float64) delta_t tensor(0.7211, dtype=torch.float64)
13 gae_duplicate tensor(1.8974, dtype=torch.float64) tensor(-3.9517, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4232, dtype=torch.float64) delta_t tensor(-0.4526, dtype=torch.float64)
12 gae_duplicate tensor(1.0653, dtype=torch.float64) tensor(-2.2185, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1639, dtype=torch.float64) delta_t tensor(0.1242, dtype=torch.float64)
11 gae_duplicate tensor(0.9764, dtype=torch.float64) tensor(-2.0522, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6860, dtype=torch.float64) delta_t tensor(0.5577, dtype=torch.float64)
10 gae_duplicate tensor(1.3388, dtype=torch.float64) tensor(-3.0578, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3634, dtype=torch.float64) delta_t tensor(0.4194, dtype=torch.float64)
9 gae_duplicate tensor(1.4904, dtype=torch.float64) tensor(-3.3707, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1549, dtype=torch.float64) delta_t tensor(-0.2378, dtype=torch.float64)
8 gae_duplicate tensor(0.9545, dtype=torch.float64) tensor(-2.2859, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8028, dtype=torch.float64) delta_t tensor(-0.8815, dtype=torch.float64)
7 gae_duplicate tensor(-0.1179, dtype=torch.float64) tensor(0.2135, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7421, dtype=torch.float64) delta_t tensor(-1.0141, dtype=torch.float64)
6 gae_duplicate tensor(-1.1084, dtype=torch.float64) tensor(2.7208, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2879, dtype=torch.float64) delta_t tensor(0.2184, dtype=torch.float64)
5 gae_duplicate tensor(-0.6683, dtype=torch.float64) tensor(1.2296, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4197, dtype=torch.float64) delta_t tensor(-0.5483, dtype=torch.float64)
4 gae_duplicate tensor(-1.0829, dtype=torch.float64) tensor(1.9802, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3569, dtype=torch.float64) delta_t tensor(-0.3089, dtype=torch.float64)
3 gae_duplicate tensor(-1.1752, dtype=torch.float64) tensor(2.7379, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0630, dtype=torch.float64) delta_t tensor(-0.8412, dtype=torch.float64)
2 gae_duplicate tensor(-1.7813, dtype=torch.float64) tensor(3.2255, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:134.4001922607422
value loss:46.83966827392578
entropies:37.10771179199219
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.384395122528076 seconds
19 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.5295, dtype=torch.float64)
19 gae_duplicate tensor(0.5295, dtype=torch.float64) tensor(-1.1169, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8181, dtype=torch.float64) delta_t tensor(0.6624, dtype=torch.float64)
18 gae_duplicate tensor(1.0860, dtype=torch.float64) tensor(-2.2021, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6208, dtype=torch.float64) delta_t tensor(0.5476, dtype=torch.float64)
17 gae_duplicate tensor(1.4164, dtype=torch.float64) tensor(-2.9981, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4226, dtype=torch.float64) delta_t tensor(0.4256, dtype=torch.float64)
16 gae_duplicate tensor(1.5587, dtype=torch.float64) tensor(-3.2873, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0238, dtype=torch.float64) delta_t tensor(0.0064, dtype=torch.float64)
15 gae_duplicate tensor(1.2534, dtype=torch.float64) tensor(-2.6024, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3564, dtype=torch.float64) delta_t tensor(0.2792, dtype=torch.float64)
14 gae_duplicate tensor(1.2819, dtype=torch.float64) tensor(-2.6696, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8218, dtype=torch.float64) delta_t tensor(0.7106, dtype=torch.float64)
13 gae_duplicate tensor(1.7361, dtype=torch.float64) tensor(-3.6268, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8917, dtype=torch.float64) delta_t tensor(0.8892, dtype=torch.float64)
12 gae_duplicate tensor(2.2781, dtype=torch.float64) tensor(-4.7588, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.8207, dtype=torch.float64) delta_t tensor(-1.9715, dtype=torch.float64)
11 gae_duplicate tensor(-0.1490, dtype=torch.float64) tensor(0.3179, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6918, dtype=torch.float64) delta_t tensor(0.7113, dtype=torch.float64)
10 gae_duplicate tensor(0.5921, dtype=torch.float64) tensor(-1.1936, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4282, dtype=torch.float64) delta_t tensor(0.2726, dtype=torch.float64)
9 gae_duplicate tensor(0.7462, dtype=torch.float64) tensor(-1.5948, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0355, dtype=torch.float64) delta_t tensor(-0.0520, dtype=torch.float64)
8 gae_duplicate tensor(0.5450, dtype=torch.float64) tensor(-1.1358, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6319, dtype=torch.float64) delta_t tensor(-0.7128, dtype=torch.float64)
7 gae_duplicate tensor(-0.2768, dtype=torch.float64) tensor(0.5006, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6226, dtype=torch.float64) delta_t tensor(0.8790, dtype=torch.float64)
6 gae_duplicate tensor(0.6575, dtype=torch.float64) tensor(-1.1892, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0168, dtype=torch.float64) delta_t tensor(-2.2606, dtype=torch.float64)
5 gae_duplicate tensor(-1.7346, dtype=torch.float64) tensor(4.2532, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2196, dtype=torch.float64) delta_t tensor(0.0810, dtype=torch.float64)
4 gae_duplicate tensor(-1.3067, dtype=torch.float64) tensor(2.3548, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7727, dtype=torch.float64) delta_t tensor(-1.7700, dtype=torch.float64)
3 gae_duplicate tensor(-2.8153, dtype=torch.float64) tensor(5.1313, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0781, dtype=torch.float64) delta_t tensor(0.0329, dtype=torch.float64)
2 gae_duplicate tensor(-2.2193, dtype=torch.float64) tensor(4.0585, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:69.4406509399414
value loss:54.924049377441406
entropies:37.14560317993164
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.9961)
ToM Target loss= tensor(300.3013)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.373403072357178 seconds
19 rew tensor(0.8732, dtype=torch.float64) delta_t tensor(0.5849, dtype=torch.float64)
19 gae_duplicate tensor(0.5849, dtype=torch.float64) tensor(-1.1850, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8768, dtype=torch.float64) delta_t tensor(0.7771, dtype=torch.float64)
18 gae_duplicate tensor(1.2450, dtype=torch.float64) tensor(-2.5770, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8803, dtype=torch.float64) delta_t tensor(0.8142, dtype=torch.float64)
17 gae_duplicate tensor(1.8102, dtype=torch.float64) tensor(-3.7703, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8839, dtype=torch.float64) delta_t tensor(0.8178, dtype=torch.float64)
16 gae_duplicate tensor(2.2660, dtype=torch.float64) tensor(-4.7192, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8876, dtype=torch.float64) delta_t tensor(0.8215, dtype=torch.float64)
15 gae_duplicate tensor(2.6343, dtype=torch.float64) tensor(-5.4698, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8913, dtype=torch.float64) delta_t tensor(0.7849, dtype=torch.float64)
14 gae_duplicate tensor(2.8924, dtype=torch.float64) tensor(-6.0423, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8950, dtype=torch.float64) delta_t tensor(0.8642, dtype=torch.float64)
13 gae_duplicate tensor(3.1782, dtype=torch.float64) tensor(-6.2526, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.8979, dtype=torch.float64)
12 gae_duplicate tensor(3.4404, dtype=torch.float64) tensor(-7.5950, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9026, dtype=torch.float64) delta_t tensor(0.8501, dtype=torch.float64)
11 gae_duplicate tensor(3.6025, dtype=torch.float64) tensor(-7.1003, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9065, dtype=torch.float64) delta_t tensor(0.9119, dtype=torch.float64)
10 gae_duplicate tensor(3.7939, dtype=torch.float64) tensor(-7.4948, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6448, dtype=torch.float64) delta_t tensor(0.6229, dtype=torch.float64)
9 gae_duplicate tensor(3.6580, dtype=torch.float64) tensor(-7.3192, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3154, dtype=torch.float64) delta_t tensor(0.1975, dtype=torch.float64)
8 gae_duplicate tensor(3.1239, dtype=torch.float64) tensor(-6.3298, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4117, dtype=torch.float64) delta_t tensor(-0.5353, dtype=torch.float64)
7 gae_duplicate tensor(1.9638, dtype=torch.float64) tensor(-3.5551, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4789, dtype=torch.float64) delta_t tensor(-0.6865, dtype=torch.float64)
6 gae_duplicate tensor(0.8846, dtype=torch.float64) tensor(-1.6385, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7327, dtype=torch.float64) delta_t tensor(-1.7671, dtype=torch.float64)
5 gae_duplicate tensor(-1.0594, dtype=torch.float64) tensor(1.9734, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4785, dtype=torch.float64) delta_t tensor(-2.5230, dtype=torch.float64)
4 gae_duplicate tensor(-3.3705, dtype=torch.float64) tensor(8.2472, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8454, dtype=torch.float64) delta_t tensor(-0.9696, dtype=torch.float64)
3 gae_duplicate tensor(-3.6661, dtype=torch.float64) tensor(8.2734, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5196, dtype=torch.float64) delta_t tensor(-1.3513, dtype=torch.float64)
2 gae_duplicate tensor(-4.2841, dtype=torch.float64) tensor(7.7551, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:267.6821594238281
value loss:220.4613037109375
entropies:37.18017578125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.47358512878418 seconds
19 rew tensor(0.8646, dtype=torch.float64) delta_t tensor(0.3694, dtype=torch.float64)
19 gae_duplicate tensor(0.3694, dtype=torch.float64) tensor(-0.7966, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8677, dtype=torch.float64) delta_t tensor(0.8957, dtype=torch.float64)
18 gae_duplicate tensor(1.1912, dtype=torch.float64) tensor(-2.4645, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8709, dtype=torch.float64) delta_t tensor(0.8697, dtype=torch.float64)
17 gae_duplicate tensor(1.8226, dtype=torch.float64) tensor(-3.7959, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8742, dtype=torch.float64) delta_t tensor(0.8150, dtype=torch.float64)
16 gae_duplicate tensor(2.2731, dtype=torch.float64) tensor(-4.7341, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8774, dtype=torch.float64) delta_t tensor(0.8183, dtype=torch.float64)
15 gae_duplicate tensor(2.6368, dtype=torch.float64) tensor(-5.4743, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8807, dtype=torch.float64) delta_t tensor(0.8695, dtype=torch.float64)
14 gae_duplicate tensor(2.9789, dtype=torch.float64) tensor(-6.1659, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8841, dtype=torch.float64) delta_t tensor(0.7921, dtype=torch.float64)
13 gae_duplicate tensor(3.1753, dtype=torch.float64) tensor(-6.5927, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(0.7124, dtype=torch.float64)
12 gae_duplicate tensor(3.2526, dtype=torch.float64) tensor(-6.7530, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8909, dtype=torch.float64) delta_t tensor(0.8346, dtype=torch.float64)
11 gae_duplicate tensor(3.4366, dtype=torch.float64) tensor(-7.1355, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8943, dtype=torch.float64) delta_t tensor(0.8179, dtype=torch.float64)
10 gae_duplicate tensor(3.5672, dtype=torch.float64) tensor(-7.4061, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5035, dtype=torch.float64) delta_t tensor(0.6243, dtype=torch.float64)
9 gae_duplicate tensor(3.4780, dtype=torch.float64) tensor(-6.2672, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0201, dtype=torch.float64) delta_t tensor(-0.0754, dtype=torch.float64)
8 gae_duplicate tensor(2.7070, dtype=torch.float64) tensor(-5.2107, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0022, dtype=torch.float64) delta_t tensor(-1.0831, dtype=torch.float64)
7 gae_duplicate tensor(1.0825, dtype=torch.float64) tensor(-2.0075, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.1197, dtype=torch.float64) delta_t tensor(-2.2984, dtype=torch.float64)
6 gae_duplicate tensor(-1.4324, dtype=torch.float64) tensor(3.5223, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7499, dtype=torch.float64) delta_t tensor(-2.0048, dtype=torch.float64)
5 gae_duplicate tensor(-3.1507, dtype=torch.float64) tensor(6.8256, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1637, dtype=torch.float64) delta_t tensor(-2.1619, dtype=torch.float64)
4 gae_duplicate tensor(-4.6825, dtype=torch.float64) tensor(8.4677, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5871, dtype=torch.float64) delta_t tensor(-0.6228, dtype=torch.float64)
3 gae_duplicate tensor(-4.3688, dtype=torch.float64) tensor(8.3540, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6570, dtype=torch.float64) delta_t tensor(-1.9153, dtype=torch.float64)
2 gae_duplicate tensor(-5.4103, dtype=torch.float64) tensor(11.1791, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:157.61520385742188
value loss:260.8897705078125
entropies:37.215091705322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.417485952377319 seconds
19 rew tensor(0.8173, dtype=torch.float64) delta_t tensor(0.3634, dtype=torch.float64)
19 gae_duplicate tensor(0.3634, dtype=torch.float64) tensor(-0.7879, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7526, dtype=torch.float64) delta_t tensor(0.7183, dtype=torch.float64)
18 gae_duplicate tensor(1.0091, dtype=torch.float64) tensor(-2.0286, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6875, dtype=torch.float64) delta_t tensor(0.6011, dtype=torch.float64)
17 gae_duplicate tensor(1.4084, dtype=torch.float64) tensor(-3.0081, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4205, dtype=torch.float64) delta_t tensor(0.3944, dtype=torch.float64)
16 gae_duplicate tensor(1.5211, dtype=torch.float64) tensor(-3.2514, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0858, dtype=torch.float64) delta_t tensor(0.0827, dtype=torch.float64)
15 gae_duplicate tensor(1.2996, dtype=torch.float64) tensor(-2.6829, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.8522, dtype=torch.float64) delta_t tensor(-1.1492, dtype=torch.float64)
14 gae_duplicate tensor(-0.1096, dtype=torch.float64) tensor(0.2282, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8862, dtype=torch.float64) delta_t tensor(0.8132, dtype=torch.float64)
13 gae_duplicate tensor(0.7256, dtype=torch.float64) tensor(-1.5111, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8224, dtype=torch.float64) delta_t tensor(0.6775, dtype=torch.float64)
12 gae_duplicate tensor(1.2579, dtype=torch.float64) tensor(-2.6200, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8252, dtype=torch.float64) delta_t tensor(0.8638, dtype=torch.float64)
11 gae_duplicate tensor(1.8702, dtype=torch.float64) tensor(-3.8948, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8279, dtype=torch.float64) delta_t tensor(0.7567, dtype=torch.float64)
10 gae_duplicate tensor(2.2528, dtype=torch.float64) tensor(-4.6776, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3075, dtype=torch.float64) delta_t tensor(-1.4223, dtype=torch.float64)
9 gae_duplicate tensor(0.3800, dtype=torch.float64) tensor(-0.8154, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1771, dtype=torch.float64) delta_t tensor(-0.2099, dtype=torch.float64)
8 gae_duplicate tensor(0.0941, dtype=torch.float64) tensor(-0.2020, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8453, dtype=torch.float64) delta_t tensor(-0.8472, dtype=torch.float64)
7 gae_duplicate tensor(-0.7720, dtype=torch.float64) tensor(1.5781, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5813, dtype=torch.float64) delta_t tensor(-0.7039, dtype=torch.float64)
6 gae_duplicate tensor(-1.3215, dtype=torch.float64) tensor(2.6282, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7828, dtype=torch.float64) delta_t tensor(-0.8504, dtype=torch.float64)
5 gae_duplicate tensor(-1.9076, dtype=torch.float64) tensor(4.6793, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1193, dtype=torch.float64) delta_t tensor(-0.1833, dtype=torch.float64)
4 gae_duplicate tensor(-1.7094, dtype=torch.float64) tensor(3.1228, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5184, dtype=torch.float64) delta_t tensor(-0.5701, dtype=torch.float64)
3 gae_duplicate tensor(-1.9376, dtype=torch.float64) tensor(3.5033, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5861, dtype=torch.float64) delta_t tensor(-0.6619, dtype=torch.float64)
2 gae_duplicate tensor(-2.2120, dtype=torch.float64) tensor(4.0586, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:32.97163772583008
value loss:53.30068588256836
entropies:37.23013687133789
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.474762916564941 seconds
19 rew tensor(0.8801, dtype=torch.float64) delta_t tensor(0.6050, dtype=torch.float64)
19 gae_duplicate tensor(0.6050, dtype=torch.float64) tensor(-1.2562, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8829, dtype=torch.float64) delta_t tensor(0.8279, dtype=torch.float64)
18 gae_duplicate tensor(1.3119, dtype=torch.float64) tensor(-2.7238, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8857, dtype=torch.float64) delta_t tensor(0.6328, dtype=torch.float64)
17 gae_duplicate tensor(1.6824, dtype=torch.float64) tensor(-3.4824, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8886, dtype=torch.float64) delta_t tensor(0.6715, dtype=torch.float64)
16 gae_duplicate tensor(2.0174, dtype=torch.float64) tensor(-4.2143, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8915, dtype=torch.float64) delta_t tensor(0.8274, dtype=torch.float64)
15 gae_duplicate tensor(2.4413, dtype=torch.float64) tensor(-5.0842, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8944, dtype=torch.float64) delta_t tensor(0.7939, dtype=torch.float64)
14 gae_duplicate tensor(2.7470, dtype=torch.float64) tensor(-5.7036, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8973, dtype=torch.float64) delta_t tensor(0.7851, dtype=torch.float64)
13 gae_duplicate tensor(2.9827, dtype=torch.float64) tensor(-6.2120, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.8217, dtype=torch.float64)
12 gae_duplicate tensor(3.2079, dtype=torch.float64) tensor(-6.6402, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9033, dtype=torch.float64) delta_t tensor(0.8342, dtype=torch.float64)
11 gae_duplicate tensor(3.4005, dtype=torch.float64) tensor(-7.0601, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9063, dtype=torch.float64) delta_t tensor(0.8331, dtype=torch.float64)
10 gae_duplicate tensor(3.5535, dtype=torch.float64) tensor(-7.3778, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2402, dtype=torch.float64) delta_t tensor(0.2101, dtype=torch.float64)
9 gae_duplicate tensor(3.0529, dtype=torch.float64) tensor(-5.5281, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2406, dtype=torch.float64) delta_t tensor(0.2867, dtype=torch.float64)
8 gae_duplicate tensor(2.7291, dtype=torch.float64) tensor(-5.1890, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3594, dtype=torch.float64) delta_t tensor(-1.4489, dtype=torch.float64)
7 gae_duplicate tensor(0.7343, dtype=torch.float64) tensor(-1.5575, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3666, dtype=torch.float64) delta_t tensor(-1.5668, dtype=torch.float64)
6 gae_duplicate tensor(-0.9793, dtype=torch.float64) tensor(1.8250, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7086, dtype=torch.float64) delta_t tensor(-1.8920, dtype=torch.float64)
5 gae_duplicate tensor(-2.6754, dtype=torch.float64) tensor(6.4343, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2585, dtype=torch.float64) delta_t tensor(-2.3050, dtype=torch.float64)
4 gae_duplicate tensor(-4.4453, dtype=torch.float64) tensor(10.8826, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3375, dtype=torch.float64) delta_t tensor(-1.4149, dtype=torch.float64)
3 gae_duplicate tensor(-4.9712, dtype=torch.float64) tensor(10.8709, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1923, dtype=torch.float64) delta_t tensor(-0.3784, dtype=torch.float64)
2 gae_duplicate tensor(-4.3554, dtype=torch.float64) tensor(8.7701, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:138.3601837158203
value loss:232.10501098632812
entropies:37.238861083984375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.400436878204346 seconds
19 rew tensor(0.8811, dtype=torch.float64) delta_t tensor(0.5411, dtype=torch.float64)
19 gae_duplicate tensor(0.5411, dtype=torch.float64) tensor(-1.1268, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8838, dtype=torch.float64) delta_t tensor(0.6963, dtype=torch.float64)
18 gae_duplicate tensor(1.1292, dtype=torch.float64) tensor(-2.3517, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8864, dtype=torch.float64) delta_t tensor(0.8021, dtype=torch.float64)
17 gae_duplicate tensor(1.7054, dtype=torch.float64) tensor(-3.5627, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8891, dtype=torch.float64) delta_t tensor(0.8435, dtype=torch.float64)
16 gae_duplicate tensor(2.2078, dtype=torch.float64) tensor(-4.5700, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8918, dtype=torch.float64) delta_t tensor(0.8313, dtype=torch.float64)
15 gae_duplicate tensor(2.5976, dtype=torch.float64) tensor(-5.4097, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8945, dtype=torch.float64) delta_t tensor(0.8631, dtype=torch.float64)
14 gae_duplicate tensor(2.9412, dtype=torch.float64) tensor(-6.1255, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8972, dtype=torch.float64) delta_t tensor(0.7606, dtype=torch.float64)
13 gae_duplicate tensor(3.1136, dtype=torch.float64) tensor(-6.5041, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.8378, dtype=torch.float64)
12 gae_duplicate tensor(3.3287, dtype=torch.float64) tensor(-6.9326, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7678, dtype=torch.float64) delta_t tensor(0.7345, dtype=torch.float64)
11 gae_duplicate tensor(3.3974, dtype=torch.float64) tensor(-7.0541, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2976, dtype=torch.float64) delta_t tensor(0.2536, dtype=torch.float64)
10 gae_duplicate tensor(2.9715, dtype=torch.float64) tensor(-6.2807, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1635, dtype=torch.float64) delta_t tensor(0.0204, dtype=torch.float64)
9 gae_duplicate tensor(2.3976, dtype=torch.float64) tensor(-5.8747, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4327, dtype=torch.float64) delta_t tensor(0.5328, dtype=torch.float64)
8 gae_duplicate tensor(2.4509, dtype=torch.float64) tensor(-5.8052, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7749, dtype=torch.float64) delta_t tensor(-0.9386, dtype=torch.float64)
7 gae_duplicate tensor(1.0222, dtype=torch.float64) tensor(-2.2617, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7100, dtype=torch.float64) delta_t tensor(-0.8069, dtype=torch.float64)
6 gae_duplicate tensor(0.0108, dtype=torch.float64) tensor(-0.0225, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7845, dtype=torch.float64) delta_t tensor(-1.9304, dtype=torch.float64)
5 gae_duplicate tensor(-1.9217, dtype=torch.float64) tensor(3.4777, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2213, dtype=torch.float64) delta_t tensor(0.0190, dtype=torch.float64)
4 gae_duplicate tensor(-1.5184, dtype=torch.float64) tensor(2.8268, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1221, dtype=torch.float64) delta_t tensor(-1.1848, dtype=torch.float64)
3 gae_duplicate tensor(-2.3995, dtype=torch.float64) tensor(4.7579, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3282, dtype=torch.float64) delta_t tensor(-1.0457, dtype=torch.float64)
2 gae_duplicate tensor(-2.9653, dtype=torch.float64) tensor(5.3474, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:283.7181091308594
value loss:148.86907958984375
entropies:37.20729446411133
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.0310)
ToM Target loss= tensor(301.9334)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.617019176483154 seconds
19 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(0.2388, dtype=torch.float64)
19 gae_duplicate tensor(0.2388, dtype=torch.float64) tensor(-0.4959, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8900, dtype=torch.float64) delta_t tensor(0.7663, dtype=torch.float64)
18 gae_duplicate tensor(0.9574, dtype=torch.float64) tensor(-1.9878, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8925, dtype=torch.float64) delta_t tensor(0.7640, dtype=torch.float64)
17 gae_duplicate tensor(1.5299, dtype=torch.float64) tensor(-3.1861, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8950, dtype=torch.float64) delta_t tensor(0.7604, dtype=torch.float64)
16 gae_duplicate tensor(1.9843, dtype=torch.float64) tensor(-4.1199, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8976, dtype=torch.float64) delta_t tensor(0.7841, dtype=torch.float64)
15 gae_duplicate tensor(2.3716, dtype=torch.float64) tensor(-4.9390, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.7631, dtype=torch.float64)
14 gae_duplicate tensor(2.6604, dtype=torch.float64) tensor(-5.5572, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9028, dtype=torch.float64) delta_t tensor(1.0801, dtype=torch.float64)
13 gae_duplicate tensor(3.2084, dtype=torch.float64) tensor(-6.3139, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2230, dtype=torch.float64) delta_t tensor(0.1801, dtype=torch.float64)
12 gae_duplicate tensor(2.7469, dtype=torch.float64) tensor(-5.6219, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3597, dtype=torch.float64) delta_t tensor(0.2628, dtype=torch.float64)
11 gae_duplicate tensor(2.4603, dtype=torch.float64) tensor(-4.7080, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2242, dtype=torch.float64) delta_t tensor(0.2008, dtype=torch.float64)
10 gae_duplicate tensor(2.1690, dtype=torch.float64) tensor(-4.6808, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2925, dtype=torch.float64) delta_t tensor(0.2084, dtype=torch.float64)
9 gae_duplicate tensor(1.9436, dtype=torch.float64) tensor(-3.9756, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0896, dtype=torch.float64) delta_t tensor(0.0025, dtype=torch.float64)
8 gae_duplicate tensor(1.5574, dtype=torch.float64) tensor(-3.2433, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7230, dtype=torch.float64) delta_t tensor(-0.7953, dtype=torch.float64)
7 gae_duplicate tensor(0.4506, dtype=torch.float64) tensor(-0.8580, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4014, dtype=torch.float64) delta_t tensor(-1.4952, dtype=torch.float64)
6 gae_duplicate tensor(-1.1347, dtype=torch.float64) tensor(2.4800, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9505, dtype=torch.float64) delta_t tensor(-2.2846, dtype=torch.float64)
5 gae_duplicate tensor(-3.1923, dtype=torch.float64) tensor(6.5704, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0127, dtype=torch.float64) delta_t tensor(-1.1288, dtype=torch.float64)
4 gae_duplicate tensor(-3.6826, dtype=torch.float64) tensor(7.6231, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2670, dtype=torch.float64) delta_t tensor(-0.4118, dtype=torch.float64)
3 gae_duplicate tensor(-3.3579, dtype=torch.float64) tensor(6.9760, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2675, dtype=torch.float64) delta_t tensor(-0.0253, dtype=torch.float64)
2 gae_duplicate tensor(-2.7116, dtype=torch.float64) tensor(4.9714, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:125.27854919433594
value loss:147.93722534179688
entropies:37.338069915771484
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.424247741699219 seconds
19 rew tensor(0.8698, dtype=torch.float64) delta_t tensor(0.3987, dtype=torch.float64)
19 gae_duplicate tensor(0.3987, dtype=torch.float64) tensor(-0.8277, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8721, dtype=torch.float64) delta_t tensor(0.6169, dtype=torch.float64)
18 gae_duplicate tensor(0.9358, dtype=torch.float64) tensor(-1.9429, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8743, dtype=torch.float64) delta_t tensor(0.7479, dtype=torch.float64)
17 gae_duplicate tensor(1.4965, dtype=torch.float64) tensor(-3.1262, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8766, dtype=torch.float64) delta_t tensor(0.7502, dtype=torch.float64)
16 gae_duplicate tensor(1.9474, dtype=torch.float64) tensor(-4.0681, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8789, dtype=torch.float64) delta_t tensor(0.7525, dtype=torch.float64)
15 gae_duplicate tensor(2.3105, dtype=torch.float64) tensor(-4.8120, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8813, dtype=torch.float64) delta_t tensor(0.7440, dtype=torch.float64)
14 gae_duplicate tensor(2.5924, dtype=torch.float64) tensor(-5.3826, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8836, dtype=torch.float64) delta_t tensor(0.9968, dtype=torch.float64)
13 gae_duplicate tensor(3.0707, dtype=torch.float64) tensor(-6.4144, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8860, dtype=torch.float64) delta_t tensor(0.7350, dtype=torch.float64)
12 gae_duplicate tensor(3.1916, dtype=torch.float64) tensor(-6.6470, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8884, dtype=torch.float64) delta_t tensor(0.7940, dtype=torch.float64)
11 gae_duplicate tensor(3.3473, dtype=torch.float64) tensor(-6.9289, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8908, dtype=torch.float64) delta_t tensor(0.8050, dtype=torch.float64)
10 gae_duplicate tensor(3.4828, dtype=torch.float64) tensor(-7.2095, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8932, dtype=torch.float64) delta_t tensor(0.7825, dtype=torch.float64)
9 gae_duplicate tensor(3.5688, dtype=torch.float64) tensor(-7.1663, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9643, dtype=torch.float64) delta_t tensor(-0.9487, dtype=torch.float64)
8 gae_duplicate tensor(1.9063, dtype=torch.float64) tensor(-3.9628, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.8305, dtype=torch.float64) delta_t tensor(-2.0101, dtype=torch.float64)
7 gae_duplicate tensor(-0.4851, dtype=torch.float64) tensor(0.9980, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1762, dtype=torch.float64) delta_t tensor(-1.1186, dtype=torch.float64)
6 gae_duplicate tensor(-1.5066, dtype=torch.float64) tensor(3.6841, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5807, dtype=torch.float64) delta_t tensor(-1.7242, dtype=torch.float64)
5 gae_duplicate tensor(-2.9295, dtype=torch.float64) tensor(6.6022, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.3304, dtype=torch.float64) delta_t tensor(-4.4013, dtype=torch.float64)
4 gae_duplicate tensor(-6.7448, dtype=torch.float64) tensor(12.1807, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3420, dtype=torch.float64) delta_t tensor(-0.4767, dtype=torch.float64)
3 gae_duplicate tensor(-5.8726, dtype=torch.float64) tensor(10.7637, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2052, dtype=torch.float64) delta_t tensor(-0.2277, dtype=torch.float64)
2 gae_duplicate tensor(-4.9258, dtype=torch.float64) tensor(9.3401, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:88.39971160888672
value loss:290.6643371582031
entropies:37.26085662841797
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.619042158126831 seconds
19 rew tensor(0.8618, dtype=torch.float64) delta_t tensor(0.3208, dtype=torch.float64)
19 gae_duplicate tensor(0.3208, dtype=torch.float64) tensor(-0.6680, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8639, dtype=torch.float64) delta_t tensor(0.7692, dtype=torch.float64)
18 gae_duplicate tensor(1.0258, dtype=torch.float64) tensor(-2.1300, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8660, dtype=torch.float64) delta_t tensor(0.8282, dtype=torch.float64)
17 gae_duplicate tensor(1.6489, dtype=torch.float64) tensor(-3.4441, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8681, dtype=torch.float64) delta_t tensor(0.8041, dtype=torch.float64)
16 gae_duplicate tensor(2.1232, dtype=torch.float64) tensor(-4.4349, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8703, dtype=torch.float64) delta_t tensor(0.8813, dtype=torch.float64)
15 gae_duplicate tensor(2.5799, dtype=torch.float64) tensor(-5.3569, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8724, dtype=torch.float64) delta_t tensor(0.7179, dtype=torch.float64)
14 gae_duplicate tensor(2.7818, dtype=torch.float64) tensor(-5.7931, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8746, dtype=torch.float64) delta_t tensor(0.7902, dtype=torch.float64)
13 gae_duplicate tensor(3.0156, dtype=torch.float64) tensor(-6.2612, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8768, dtype=torch.float64) delta_t tensor(0.8247, dtype=torch.float64)
12 gae_duplicate tensor(3.2372, dtype=torch.float64) tensor(-6.7416, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8790, dtype=torch.float64) delta_t tensor(0.8047, dtype=torch.float64)
11 gae_duplicate tensor(3.3944, dtype=torch.float64) tensor(-7.0481, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7489, dtype=torch.float64) delta_t tensor(0.6672, dtype=torch.float64)
10 gae_duplicate tensor(3.3827, dtype=torch.float64) tensor(-7.0236, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4862, dtype=torch.float64) delta_t tensor(0.4864, dtype=torch.float64)
9 gae_duplicate tensor(3.1926, dtype=torch.float64) tensor(-6.1944, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1071, dtype=torch.float64) delta_t tensor(-0.2312, dtype=torch.float64)
8 gae_duplicate tensor(2.3229, dtype=torch.float64) tensor(-4.8520, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7665, dtype=torch.float64) delta_t tensor(-0.7552, dtype=torch.float64)
7 gae_duplicate tensor(1.1031, dtype=torch.float64) tensor(-2.0266, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.6247, dtype=torch.float64) delta_t tensor(-1.8305, dtype=torch.float64)
6 gae_duplicate tensor(-0.9480, dtype=torch.float64) tensor(1.9742, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.5580, dtype=torch.float64) delta_t tensor(-2.6130, dtype=torch.float64)
5 gae_duplicate tensor(-3.3714, dtype=torch.float64) tensor(6.1187, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7428, dtype=torch.float64) delta_t tensor(0.8566, dtype=torch.float64)
4 gae_duplicate tensor(-1.8406, dtype=torch.float64) tensor(4.4917, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7175, dtype=torch.float64) delta_t tensor(-1.9595, dtype=torch.float64)
3 gae_duplicate tensor(-3.4319, dtype=torch.float64) tensor(6.2286, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5273, dtype=torch.float64) delta_t tensor(-1.5232, dtype=torch.float64)
2 gae_duplicate tensor(-4.2687, dtype=torch.float64) tensor(8.3301, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:207.8701171875
value loss:191.6583251953125
entropies:37.23454666137695
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.38547420501709 seconds
19 rew tensor(0.5441, dtype=torch.float64) delta_t tensor(-0.2026, dtype=torch.float64)
19 gae_duplicate tensor(-0.2026, dtype=torch.float64) tensor(0.4235, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4115, dtype=torch.float64) delta_t tensor(0.2756, dtype=torch.float64)
18 gae_duplicate tensor(0.1136, dtype=torch.float64) tensor(-0.2351, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0549, dtype=torch.float64) delta_t tensor(-0.0247, dtype=torch.float64)
17 gae_duplicate tensor(0.0662, dtype=torch.float64) tensor(-0.1378, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.9877, dtype=torch.float64) delta_t tensor(-1.0612, dtype=torch.float64)
16 gae_duplicate tensor(-1.0083, dtype=torch.float64) tensor(2.0997, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7419, dtype=torch.float64) delta_t tensor(0.6270, dtype=torch.float64)
15 gae_duplicate tensor(-0.1797, dtype=torch.float64) tensor(0.3752, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6768, dtype=torch.float64) delta_t tensor(0.5613, dtype=torch.float64)
14 gae_duplicate tensor(0.4175, dtype=torch.float64) tensor(-0.8645, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4785, dtype=torch.float64) delta_t tensor(0.3688, dtype=torch.float64)
13 gae_duplicate tensor(0.7029, dtype=torch.float64) tensor(-1.4637, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(0.7225, dtype=torch.float64)
12 gae_duplicate tensor(1.2848, dtype=torch.float64) tensor(-2.6755, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.6696, dtype=torch.float64)
11 gae_duplicate tensor(1.6974, dtype=torch.float64) tensor(-3.5348, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7489, dtype=torch.float64) delta_t tensor(0.6423, dtype=torch.float64)
10 gae_duplicate tensor(2.0003, dtype=torch.float64) tensor(-4.1535, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0868, dtype=torch.float64) delta_t tensor(-0.0339, dtype=torch.float64)
9 gae_duplicate tensor(1.5663, dtype=torch.float64) tensor(-3.2524, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7084, dtype=torch.float64) delta_t tensor(-0.8677, dtype=torch.float64)
8 gae_duplicate tensor(0.3854, dtype=torch.float64) tensor(-0.8049, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0410, dtype=torch.float64) delta_t tensor(-1.0180, dtype=torch.float64)
7 gae_duplicate tensor(-0.7097, dtype=torch.float64) tensor(1.4737, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.2362, dtype=torch.float64) delta_t tensor(-2.3720, dtype=torch.float64)
6 gae_duplicate tensor(-2.9398, dtype=torch.float64) tensor(6.1041, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0559, dtype=torch.float64) delta_t tensor(-1.2485, dtype=torch.float64)
5 gae_duplicate tensor(-3.6003, dtype=torch.float64) tensor(7.4756, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0736, dtype=torch.float64) delta_t tensor(-0.0440, dtype=torch.float64)
4 gae_duplicate tensor(-2.9243, dtype=torch.float64) tensor(5.4420, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6581, dtype=torch.float64) delta_t tensor(-0.8485, dtype=torch.float64)
3 gae_duplicate tensor(-3.1879, dtype=torch.float64) tensor(6.6584, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6594, dtype=torch.float64) delta_t tensor(-0.7507, dtype=torch.float64)
2 gae_duplicate tensor(-3.3010, dtype=torch.float64) tensor(7.1148, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-121.39051818847656
value loss:96.94475555419922
entropies:37.396427154541016
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4876322746276855 seconds
19 rew tensor(0.8230, dtype=torch.float64) delta_t tensor(0.0660, dtype=torch.float64)
19 gae_duplicate tensor(0.0660, dtype=torch.float64) tensor(-0.1371, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6899, dtype=torch.float64) delta_t tensor(0.5427, dtype=torch.float64)
18 gae_duplicate tensor(0.5955, dtype=torch.float64) tensor(-1.2401, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6911, dtype=torch.float64) delta_t tensor(0.5643, dtype=torch.float64)
17 gae_duplicate tensor(1.0407, dtype=torch.float64) tensor(-2.1609, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4231, dtype=torch.float64) delta_t tensor(0.4307, dtype=torch.float64)
16 gae_duplicate tensor(1.2633, dtype=torch.float64) tensor(-2.6231, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0873, dtype=torch.float64) delta_t tensor(0.0198, dtype=torch.float64)
15 gae_duplicate tensor(1.0304, dtype=torch.float64) tensor(-2.1334, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.7860, dtype=torch.float64) delta_t tensor(-0.8006, dtype=torch.float64)
14 gae_duplicate tensor(0.0238, dtype=torch.float64) tensor(-0.0493, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8241, dtype=torch.float64) delta_t tensor(0.7292, dtype=torch.float64)
13 gae_duplicate tensor(0.7482, dtype=torch.float64) tensor(-1.5535, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8930, dtype=torch.float64) delta_t tensor(0.7976, dtype=torch.float64)
12 gae_duplicate tensor(1.3961, dtype=torch.float64) tensor(-2.9074, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8279, dtype=torch.float64) delta_t tensor(0.7545, dtype=torch.float64)
11 gae_duplicate tensor(1.8714, dtype=torch.float64) tensor(-3.8971, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8968, dtype=torch.float64) delta_t tensor(0.8099, dtype=torch.float64)
10 gae_duplicate tensor(2.3070, dtype=torch.float64) tensor(-4.7766, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1611, dtype=torch.float64) delta_t tensor(-0.0925, dtype=torch.float64)
9 gae_duplicate tensor(1.7531, dtype=torch.float64) tensor(-3.6402, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5755, dtype=torch.float64) delta_t tensor(-0.6694, dtype=torch.float64)
8 gae_duplicate tensor(0.7331, dtype=torch.float64) tensor(-1.5311, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6434, dtype=torch.float64) delta_t tensor(-0.7393, dtype=torch.float64)
7 gae_duplicate tensor(-0.1528, dtype=torch.float64) tensor(0.3174, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9789, dtype=torch.float64) delta_t tensor(-1.1393, dtype=torch.float64)
6 gae_duplicate tensor(-1.2616, dtype=torch.float64) tensor(2.6120, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0483, dtype=torch.float64) delta_t tensor(-1.0562, dtype=torch.float64)
5 gae_duplicate tensor(-2.0654, dtype=torch.float64) tensor(4.9468, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4871, dtype=torch.float64) delta_t tensor(0.7149, dtype=torch.float64)
4 gae_duplicate tensor(-0.9375, dtype=torch.float64) tensor(2.2774, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1157, dtype=torch.float64) delta_t tensor(-1.3119, dtype=torch.float64)
3 gae_duplicate tensor(-2.0619, dtype=torch.float64) tensor(3.8468, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9853, dtype=torch.float64) delta_t tensor(-1.1722, dtype=torch.float64)
2 gae_duplicate tensor(-2.8217, dtype=torch.float64) tensor(5.1208, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:44.0534782409668
value loss:57.02644729614258
entropies:37.26795959472656
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.8499)
ToM Target loss= tensor(302.8002)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.390668869018555 seconds
19 rew tensor(0.8898, dtype=torch.float64) delta_t tensor(0.2779, dtype=torch.float64)
19 gae_duplicate tensor(0.2779, dtype=torch.float64) tensor(-0.5787, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8917, dtype=torch.float64) delta_t tensor(0.7944, dtype=torch.float64)
18 gae_duplicate tensor(1.0168, dtype=torch.float64) tensor(-2.1113, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8936, dtype=torch.float64) delta_t tensor(0.7947, dtype=torch.float64)
17 gae_duplicate tensor(1.6081, dtype=torch.float64) tensor(-3.3392, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8955, dtype=torch.float64) delta_t tensor(0.8049, dtype=torch.float64)
16 gae_duplicate tensor(2.0914, dtype=torch.float64) tensor(-4.3677, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8975, dtype=torch.float64) delta_t tensor(0.8204, dtype=torch.float64)
15 gae_duplicate tensor(2.4936, dtype=torch.float64) tensor(-5.1928, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.7350, dtype=torch.float64)
14 gae_duplicate tensor(2.7299, dtype=torch.float64) tensor(-5.6846, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.7781, dtype=torch.float64)
13 gae_duplicate tensor(2.9620, dtype=torch.float64) tensor(-5.4489, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9034, dtype=torch.float64) delta_t tensor(0.6346, dtype=torch.float64)
12 gae_duplicate tensor(3.0042, dtype=torch.float64) tensor(-5.7912, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9053, dtype=torch.float64) delta_t tensor(0.7775, dtype=torch.float64)
11 gae_duplicate tensor(3.1809, dtype=torch.float64) tensor(-7.1900, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6368, dtype=torch.float64) delta_t tensor(0.5644, dtype=torch.float64)
10 gae_duplicate tensor(3.1090, dtype=torch.float64) tensor(-5.9840, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3000, dtype=torch.float64) delta_t tensor(0.4668, dtype=torch.float64)
9 gae_duplicate tensor(2.9541, dtype=torch.float64) tensor(-6.6098, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0979, dtype=torch.float64) delta_t tensor(-0.0360, dtype=torch.float64)
8 gae_duplicate tensor(2.3273, dtype=torch.float64) tensor(-5.0388, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9134, dtype=torch.float64) delta_t tensor(-0.9784, dtype=torch.float64)
7 gae_duplicate tensor(0.8834, dtype=torch.float64) tensor(-1.6113, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1177, dtype=torch.float64) delta_t tensor(-1.2621, dtype=torch.float64)
6 gae_duplicate tensor(-0.5554, dtype=torch.float64) tensor(1.0130, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4579, dtype=torch.float64) delta_t tensor(-1.7335, dtype=torch.float64)
5 gae_duplicate tensor(-2.1778, dtype=torch.float64) tensor(3.9723, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0895, dtype=torch.float64) delta_t tensor(-0.0627, dtype=torch.float64)
4 gae_duplicate tensor(-1.8050, dtype=torch.float64) tensor(3.4563, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3941, dtype=torch.float64) delta_t tensor(-1.5203, dtype=torch.float64)
3 gae_duplicate tensor(-2.9643, dtype=torch.float64) tensor(6.4542, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3992, dtype=torch.float64) delta_t tensor(-1.1317, dtype=torch.float64)
2 gae_duplicate tensor(-3.5031, dtype=torch.float64) tensor(6.4491, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:224.50645446777344
value loss:155.423583984375
entropies:37.14971923828125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.378448247909546 seconds
19 rew tensor(0.8838, dtype=torch.float64) delta_t tensor(0.2819, dtype=torch.float64)
19 gae_duplicate tensor(0.2819, dtype=torch.float64) tensor(-0.5853, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8856, dtype=torch.float64) delta_t tensor(0.6471, dtype=torch.float64)
18 gae_duplicate tensor(0.8726, dtype=torch.float64) tensor(-1.8222, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8874, dtype=torch.float64) delta_t tensor(0.8524, dtype=torch.float64)
17 gae_duplicate tensor(1.5505, dtype=torch.float64) tensor(-3.2376, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8892, dtype=torch.float64) delta_t tensor(0.7823, dtype=torch.float64)
16 gae_duplicate tensor(2.0227, dtype=torch.float64) tensor(-4.2119, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8910, dtype=torch.float64) delta_t tensor(0.7900, dtype=torch.float64)
15 gae_duplicate tensor(2.4081, dtype=torch.float64) tensor(-5.0145, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8929, dtype=torch.float64) delta_t tensor(0.7946, dtype=torch.float64)
14 gae_duplicate tensor(2.7211, dtype=torch.float64) tensor(-5.6346, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8947, dtype=torch.float64) delta_t tensor(0.7164, dtype=torch.float64)
13 gae_duplicate tensor(2.8933, dtype=torch.float64) tensor(-6.0081, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8966, dtype=torch.float64) delta_t tensor(0.7372, dtype=torch.float64)
12 gae_duplicate tensor(3.0518, dtype=torch.float64) tensor(-6.3727, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(0.8644, dtype=torch.float64)
11 gae_duplicate tensor(3.3059, dtype=torch.float64) tensor(-6.9033, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.9447, dtype=torch.float64)
10 gae_duplicate tensor(3.5895, dtype=torch.float64) tensor(-8.6649, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6997, dtype=torch.float64) delta_t tensor(0.5155, dtype=torch.float64)
9 gae_duplicate tensor(3.3871, dtype=torch.float64) tensor(-6.3938, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4309, dtype=torch.float64) delta_t tensor(0.3255, dtype=torch.float64)
8 gae_duplicate tensor(3.0351, dtype=torch.float64) tensor(-5.5340, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1618, dtype=torch.float64) delta_t tensor(0.0447, dtype=torch.float64)
7 gae_duplicate tensor(2.4729, dtype=torch.float64) tensor(-5.8067, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9156, dtype=torch.float64) delta_t tensor(-1.0524, dtype=torch.float64)
6 gae_duplicate tensor(0.9259, dtype=torch.float64) tensor(-2.2297, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5809, dtype=torch.float64) delta_t tensor(-0.8833, dtype=torch.float64)
5 gae_duplicate tensor(-0.1426, dtype=torch.float64) tensor(0.3147, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0621, dtype=torch.float64) delta_t tensor(-1.9527, dtype=torch.float64)
4 gae_duplicate tensor(-2.0668, dtype=torch.float64) tensor(3.7685, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8048, dtype=torch.float64) delta_t tensor(-2.0996, dtype=torch.float64)
3 gae_duplicate tensor(-3.7531, dtype=torch.float64) tensor(7.3634, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.8139, dtype=torch.float64) delta_t tensor(-1.9521, dtype=torch.float64)
2 gae_duplicate tensor(-4.9545, dtype=torch.float64) tensor(10.3167, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:278.81951904296875
value loss:198.92852783203125
entropies:37.19772720336914
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.74966287612915 seconds
19 rew tensor(0.8798, dtype=torch.float64) delta_t tensor(0.2489, dtype=torch.float64)
19 gae_duplicate tensor(0.2489, dtype=torch.float64) tensor(-0.5168, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8815, dtype=torch.float64) delta_t tensor(0.7540, dtype=torch.float64)
18 gae_duplicate tensor(0.9531, dtype=torch.float64) tensor(-1.9791, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8833, dtype=torch.float64) delta_t tensor(0.7563, dtype=torch.float64)
17 gae_duplicate tensor(1.5188, dtype=torch.float64) tensor(-3.1455, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8850, dtype=torch.float64) delta_t tensor(0.7584, dtype=torch.float64)
16 gae_duplicate tensor(1.9734, dtype=torch.float64) tensor(-4.0983, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8867, dtype=torch.float64) delta_t tensor(0.7512, dtype=torch.float64)
15 gae_duplicate tensor(2.3299, dtype=torch.float64) tensor(-4.8384, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8885, dtype=torch.float64) delta_t tensor(0.6646, dtype=torch.float64)
14 gae_duplicate tensor(2.5286, dtype=torch.float64) tensor(-5.2510, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(0.7166, dtype=torch.float64)
13 gae_duplicate tensor(2.7395, dtype=torch.float64) tensor(-5.7043, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8920, dtype=torch.float64) delta_t tensor(0.7936, dtype=torch.float64)
12 gae_duplicate tensor(2.9852, dtype=torch.float64) tensor(-6.2324, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8937, dtype=torch.float64) delta_t tensor(0.9742, dtype=torch.float64)
11 gae_duplicate tensor(3.3623, dtype=torch.float64) tensor(-6.1598, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8955, dtype=torch.float64) delta_t tensor(0.7695, dtype=torch.float64)
10 gae_duplicate tensor(3.4593, dtype=torch.float64) tensor(-6.6802, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4391, dtype=torch.float64) delta_t tensor(-0.4979, dtype=torch.float64)
9 gae_duplicate tensor(2.2695, dtype=torch.float64) tensor(-4.8104, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6399, dtype=torch.float64) delta_t tensor(-0.7901, dtype=torch.float64)
8 gae_duplicate tensor(1.0256, dtype=torch.float64) tensor(-2.1297, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0412, dtype=torch.float64) delta_t tensor(-1.1380, dtype=torch.float64)
7 gae_duplicate tensor(-0.3176, dtype=torch.float64) tensor(0.7619, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.6442, dtype=torch.float64) delta_t tensor(-1.8695, dtype=torch.float64)
6 gae_duplicate tensor(-2.1235, dtype=torch.float64) tensor(5.0114, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9184, dtype=torch.float64) delta_t tensor(-2.1035, dtype=torch.float64)
5 gae_duplicate tensor(-3.8023, dtype=torch.float64) tensor(7.3223, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3367, dtype=torch.float64) delta_t tensor(-3.4242, dtype=torch.float64)
4 gae_duplicate tensor(-6.4660, dtype=torch.float64) tensor(11.8454, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3477, dtype=torch.float64) delta_t tensor(0.3029, dtype=torch.float64)
3 gae_duplicate tensor(-4.8699, dtype=torch.float64) tensor(10.9655, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7361, dtype=torch.float64) delta_t tensor(-0.5702, dtype=torch.float64)
2 gae_duplicate tensor(-4.4662, dtype=torch.float64) tensor(8.2203, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:43.39910888671875
value loss:254.13595581054688
entropies:37.20920181274414
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.23701286315918 seconds
19 rew tensor(0.8799, dtype=torch.float64) delta_t tensor(0.2391, dtype=torch.float64)
19 gae_duplicate tensor(0.2391, dtype=torch.float64) tensor(-0.4952, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8816, dtype=torch.float64) delta_t tensor(0.8190, dtype=torch.float64)
18 gae_duplicate tensor(1.0103, dtype=torch.float64) tensor(-2.0981, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8832, dtype=torch.float64) delta_t tensor(0.7438, dtype=torch.float64)
17 gae_duplicate tensor(1.5520, dtype=torch.float64) tensor(-3.2230, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8848, dtype=torch.float64) delta_t tensor(0.8324, dtype=torch.float64)
16 gae_duplicate tensor(2.0740, dtype=torch.float64) tensor(-4.3073, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8865, dtype=torch.float64) delta_t tensor(0.5674, dtype=torch.float64)
15 gae_duplicate tensor(2.2266, dtype=torch.float64) tensor(-4.6364, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8882, dtype=torch.float64) delta_t tensor(0.7216, dtype=torch.float64)
14 gae_duplicate tensor(2.5029, dtype=torch.float64) tensor(-5.2113, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8898, dtype=torch.float64) delta_t tensor(0.7483, dtype=torch.float64)
13 gae_duplicate tensor(2.7506, dtype=torch.float64) tensor(-5.7270, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8915, dtype=torch.float64) delta_t tensor(0.8202, dtype=torch.float64)
12 gae_duplicate tensor(3.0207, dtype=torch.float64) tensor(-6.2572, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8932, dtype=torch.float64) delta_t tensor(0.7561, dtype=torch.float64)
11 gae_duplicate tensor(3.1727, dtype=torch.float64) tensor(-6.6230, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4268, dtype=torch.float64) delta_t tensor(0.3824, dtype=torch.float64)
10 gae_duplicate tensor(2.9205, dtype=torch.float64) tensor(-6.0809, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2269, dtype=torch.float64) delta_t tensor(0.1223, dtype=torch.float64)
9 gae_duplicate tensor(2.4588, dtype=torch.float64) tensor(-5.1908, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1733, dtype=torch.float64) delta_t tensor(-0.1909, dtype=torch.float64)
8 gae_duplicate tensor(1.7761, dtype=torch.float64) tensor(-3.2760, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6403, dtype=torch.float64) delta_t tensor(-0.7587, dtype=torch.float64)
7 gae_duplicate tensor(0.6622, dtype=torch.float64) tensor(-1.2767, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8412, dtype=torch.float64) delta_t tensor(-0.9406, dtype=torch.float64)
6 gae_duplicate tensor(-0.4109, dtype=torch.float64) tensor(0.7578, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2898, dtype=torch.float64) delta_t tensor(-0.0691, dtype=torch.float64)
5 gae_duplicate tensor(-0.3977, dtype=torch.float64) tensor(0.9269, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9726, dtype=torch.float64) delta_t tensor(-1.9835, dtype=torch.float64)
4 gae_duplicate tensor(-2.3017, dtype=torch.float64) tensor(4.4888, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9831, dtype=torch.float64) delta_t tensor(-2.0775, dtype=torch.float64)
3 gae_duplicate tensor(-3.9188, dtype=torch.float64) tensor(9.2371, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7882, dtype=torch.float64) delta_t tensor(-0.9049, dtype=torch.float64)
2 gae_duplicate tensor(-4.0400, dtype=torch.float64) tensor(8.6356, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:181.02171325683594
value loss:151.85763549804688
entropies:37.274017333984375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5984838008880615 seconds
19 rew tensor(0.6852, dtype=torch.float64) delta_t tensor(-0.1509, dtype=torch.float64)
19 gae_duplicate tensor(-0.1509, dtype=torch.float64) tensor(0.3141, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3504, dtype=torch.float64) delta_t tensor(0.2911, dtype=torch.float64)
18 gae_duplicate tensor(0.1704, dtype=torch.float64) tensor(-0.3556, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.1190, dtype=torch.float64) delta_t tensor(-0.2120, dtype=torch.float64)
17 gae_duplicate tensor(-0.0757, dtype=torch.float64) tensor(0.1576, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.9906, dtype=torch.float64) delta_t tensor(-1.0359, dtype=torch.float64)
16 gae_duplicate tensor(-1.0965, dtype=torch.float64) tensor(2.2829, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8845, dtype=torch.float64) delta_t tensor(0.7673, dtype=torch.float64)
15 gae_duplicate tensor(-0.1098, dtype=torch.float64) tensor(0.2275, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8861, dtype=torch.float64) delta_t tensor(0.7689, dtype=torch.float64)
14 gae_duplicate tensor(0.6811, dtype=torch.float64) tensor(-1.4145, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8877, dtype=torch.float64) delta_t tensor(0.7705, dtype=torch.float64)
13 gae_duplicate tensor(1.3154, dtype=torch.float64) tensor(-2.7318, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(0.7721, dtype=torch.float64)
12 gae_duplicate tensor(1.8245, dtype=torch.float64) tensor(-3.7890, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8909, dtype=torch.float64) delta_t tensor(0.5842, dtype=torch.float64)
11 gae_duplicate tensor(2.0438, dtype=torch.float64) tensor(-4.2337, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6916, dtype=torch.float64) delta_t tensor(0.6461, dtype=torch.float64)
10 gae_duplicate tensor(2.2811, dtype=torch.float64) tensor(-4.7494, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4249, dtype=torch.float64) delta_t tensor(0.4712, dtype=torch.float64)
9 gae_duplicate tensor(2.2961, dtype=torch.float64) tensor(-4.2569, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0427, dtype=torch.float64) delta_t tensor(-0.1702, dtype=torch.float64)
8 gae_duplicate tensor(1.6667, dtype=torch.float64) tensor(-3.3831, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5104, dtype=torch.float64) delta_t tensor(-0.6590, dtype=torch.float64)
7 gae_duplicate tensor(0.6743, dtype=torch.float64) tensor(-1.3969, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5791, dtype=torch.float64) delta_t tensor(-1.6515, dtype=torch.float64)
6 gae_duplicate tensor(-1.1120, dtype=torch.float64) tensor(2.0223, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5151, dtype=torch.float64) delta_t tensor(-0.8623, dtype=torch.float64)
5 gae_duplicate tensor(-1.7519, dtype=torch.float64) tensor(3.8459, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9855, dtype=torch.float64) delta_t tensor(-1.9636, dtype=torch.float64)
4 gae_duplicate tensor(-3.3652, dtype=torch.float64) tensor(8.0093, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5266, dtype=torch.float64) delta_t tensor(-1.7845, dtype=torch.float64)
3 gae_duplicate tensor(-4.4767, dtype=torch.float64) tensor(9.0068, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2635, dtype=torch.float64) delta_t tensor(-1.0231, dtype=torch.float64)
2 gae_duplicate tensor(-4.6044, dtype=torch.float64) tensor(9.3052, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-54.284324645996094
value loss:122.32670593261719
entropies:37.315547943115234
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.8541)
ToM Target loss= tensor(302.7788)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.509146213531494 seconds
19 rew tensor(0.8865, dtype=torch.float64) delta_t tensor(0.2280, dtype=torch.float64)
19 gae_duplicate tensor(0.2280, dtype=torch.float64) tensor(-0.4758, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8881, dtype=torch.float64) delta_t tensor(0.6465, dtype=torch.float64)
18 gae_duplicate tensor(0.8289, dtype=torch.float64) tensor(-1.7257, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8896, dtype=torch.float64) delta_t tensor(0.7457, dtype=torch.float64)
17 gae_duplicate tensor(1.4088, dtype=torch.float64) tensor(-2.9333, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8911, dtype=torch.float64) delta_t tensor(0.8645, dtype=torch.float64)
16 gae_duplicate tensor(1.9916, dtype=torch.float64) tensor(-4.1567, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8927, dtype=torch.float64) delta_t tensor(0.7624, dtype=torch.float64)
15 gae_duplicate tensor(2.3557, dtype=torch.float64) tensor(-4.8924, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8942, dtype=torch.float64) delta_t tensor(0.7061, dtype=torch.float64)
14 gae_duplicate tensor(2.5907, dtype=torch.float64) tensor(-5.3806, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8958, dtype=torch.float64) delta_t tensor(0.7054, dtype=torch.float64)
13 gae_duplicate tensor(2.7779, dtype=torch.float64) tensor(-5.7839, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8974, dtype=torch.float64) delta_t tensor(0.8100, dtype=torch.float64)
12 gae_duplicate tensor(3.0324, dtype=torch.float64) tensor(-6.3132, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.7439, dtype=torch.float64)
11 gae_duplicate tensor(3.1698, dtype=torch.float64) tensor(-6.5996, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6302, dtype=torch.float64) delta_t tensor(0.4547, dtype=torch.float64)
10 gae_duplicate tensor(2.9905, dtype=torch.float64) tensor(-6.1957, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2258, dtype=torch.float64) delta_t tensor(0.2991, dtype=torch.float64)
9 gae_duplicate tensor(2.6916, dtype=torch.float64) tensor(-6.3662, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2935, dtype=torch.float64) delta_t tensor(0.0554, dtype=torch.float64)
8 gae_duplicate tensor(2.2086, dtype=torch.float64) tensor(-5.2471, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3130, dtype=torch.float64) delta_t tensor(-0.4183, dtype=torch.float64)
7 gae_duplicate tensor(1.3486, dtype=torch.float64) tensor(-2.6456, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4480, dtype=torch.float64) delta_t tensor(-0.6358, dtype=torch.float64)
6 gae_duplicate tensor(0.4431, dtype=torch.float64) tensor(-0.9179, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9197, dtype=torch.float64) delta_t tensor(-0.8400, dtype=torch.float64)
5 gae_duplicate tensor(-0.4856, dtype=torch.float64) tensor(0.9004, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2579, dtype=torch.float64) delta_t tensor(-1.5373, dtype=torch.float64)
4 gae_duplicate tensor(-1.9257, dtype=torch.float64) tensor(3.9994, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9918, dtype=torch.float64) delta_t tensor(-1.1628, dtype=torch.float64)
3 gae_duplicate tensor(-2.7033, dtype=torch.float64) tensor(5.5899, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7244, dtype=torch.float64) delta_t tensor(-0.6010, dtype=torch.float64)
2 gae_duplicate tensor(-2.7637, dtype=torch.float64) tensor(5.2838, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:262.0431213378906
value loss:131.82302856445312
entropies:37.30849075317383
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.453696012496948 seconds
19 rew tensor(0.7565, dtype=torch.float64) delta_t tensor(-0.1477, dtype=torch.float64)
19 gae_duplicate tensor(-0.1477, dtype=torch.float64) tensor(0.3061, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6233, dtype=torch.float64) delta_t tensor(0.4765, dtype=torch.float64)
18 gae_duplicate tensor(0.3583, dtype=torch.float64) tensor(-0.7459, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4227, dtype=torch.float64) delta_t tensor(0.3275, dtype=torch.float64)
17 gae_duplicate tensor(0.6141, dtype=torch.float64) tensor(-1.2755, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.1805, dtype=torch.float64) delta_t tensor(-0.1475, dtype=torch.float64)
16 gae_duplicate tensor(0.3438, dtype=torch.float64) tensor(-0.7140, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-1.0519, dtype=torch.float64) delta_t tensor(-1.3613, dtype=torch.float64)
15 gae_duplicate tensor(-1.0863, dtype=torch.float64) tensor(2.2510, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8897, dtype=torch.float64) delta_t tensor(0.7498, dtype=torch.float64)
14 gae_duplicate tensor(-0.1193, dtype=torch.float64) tensor(0.2472, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7572, dtype=torch.float64) delta_t tensor(0.5818, dtype=torch.float64)
13 gae_duplicate tensor(0.4863, dtype=torch.float64) tensor(-1.0148, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8253, dtype=torch.float64) delta_t tensor(0.6693, dtype=torch.float64)
12 gae_duplicate tensor(1.0584, dtype=torch.float64) tensor(-2.1982, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8266, dtype=torch.float64) delta_t tensor(0.6186, dtype=torch.float64)
11 gae_duplicate tensor(1.4652, dtype=torch.float64) tensor(-3.0505, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5601, dtype=torch.float64) delta_t tensor(0.5203, dtype=torch.float64)
10 gae_duplicate tensor(1.6925, dtype=torch.float64) tensor(-3.5235, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8441, dtype=torch.float64) delta_t tensor(-1.0062, dtype=torch.float64)
9 gae_duplicate tensor(0.3478, dtype=torch.float64) tensor(-0.7241, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8454, dtype=torch.float64) delta_t tensor(-1.0162, dtype=torch.float64)
8 gae_duplicate tensor(-0.7380, dtype=torch.float64) tensor(1.5291, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3567, dtype=torch.float64) delta_t tensor(0.2139, dtype=torch.float64)
7 gae_duplicate tensor(-0.3765, dtype=torch.float64) tensor(0.7839, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4467, dtype=torch.float64) delta_t tensor(-1.5091, dtype=torch.float64)
6 gae_duplicate tensor(-1.8103, dtype=torch.float64) tensor(3.7688, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8522, dtype=torch.float64) delta_t tensor(-2.1248, dtype=torch.float64)
5 gae_duplicate tensor(-3.5731, dtype=torch.float64) tensor(7.4038, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.8041, dtype=torch.float64) delta_t tensor(-3.9809, dtype=torch.float64)
4 gae_duplicate tensor(-6.8393, dtype=torch.float64) tensor(14.2048, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3978, dtype=torch.float64) delta_t tensor(-0.5191, dtype=torch.float64)
3 gae_duplicate tensor(-5.9905, dtype=torch.float64) tensor(12.4715, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3982, dtype=torch.float64) delta_t tensor(-0.5533, dtype=torch.float64)
2 gae_duplicate tensor(-5.3457, dtype=torch.float64) tensor(11.1291, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-246.21572875976562
value loss:204.44830322265625
entropies:37.42979431152344
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.379778146743774 seconds
19 rew tensor(0.8715, dtype=torch.float64) delta_t tensor(0.1624, dtype=torch.float64)
19 gae_duplicate tensor(0.1624, dtype=torch.float64) tensor(-0.3366, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8728, dtype=torch.float64) delta_t tensor(0.8395, dtype=torch.float64)
18 gae_duplicate tensor(0.9695, dtype=torch.float64) tensor(-2.0136, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8742, dtype=torch.float64) delta_t tensor(0.6290, dtype=torch.float64)
17 gae_duplicate tensor(1.4046, dtype=torch.float64) tensor(-2.9174, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8756, dtype=torch.float64) delta_t tensor(0.7159, dtype=torch.float64)
16 gae_duplicate tensor(1.8395, dtype=torch.float64) tensor(-3.8295, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8770, dtype=torch.float64) delta_t tensor(0.7350, dtype=torch.float64)
15 gae_duplicate tensor(2.2066, dtype=torch.float64) tensor(-4.5731, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8784, dtype=torch.float64) delta_t tensor(0.7117, dtype=torch.float64)
14 gae_duplicate tensor(2.4770, dtype=torch.float64) tensor(-5.1452, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8798, dtype=torch.float64) delta_t tensor(0.7311, dtype=torch.float64)
13 gae_duplicate tensor(2.7127, dtype=torch.float64) tensor(-5.6599, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8812, dtype=torch.float64) delta_t tensor(0.7465, dtype=torch.float64)
12 gae_duplicate tensor(2.9166, dtype=torch.float64) tensor(-6.0716, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8826, dtype=torch.float64) delta_t tensor(0.7512, dtype=torch.float64)
11 gae_duplicate tensor(3.0845, dtype=torch.float64) tensor(-6.4357, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8840, dtype=torch.float64) delta_t tensor(0.7292, dtype=torch.float64)
10 gae_duplicate tensor(3.1968, dtype=torch.float64) tensor(-6.6401, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8855, dtype=torch.float64) delta_t tensor(0.8505, dtype=torch.float64)
9 gae_duplicate tensor(3.4079, dtype=torch.float64) tensor(-7.0627, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.8869, dtype=torch.float64) delta_t tensor(0.6891, dtype=torch.float64)
8 gae_duplicate tensor(3.4155, dtype=torch.float64) tensor(-7.0941, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1020, dtype=torch.float64) delta_t tensor(0.0355, dtype=torch.float64)
7 gae_duplicate tensor(2.7679, dtype=torch.float64) tensor(-5.7623, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.7311, dtype=torch.float64) delta_t tensor(-1.9502, dtype=torch.float64)
6 gae_duplicate tensor(0.2641, dtype=torch.float64) tensor(-0.5485, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.3278, dtype=torch.float64) delta_t tensor(-2.4654, dtype=torch.float64)
5 gae_duplicate tensor(-2.2541, dtype=torch.float64) tensor(4.6822, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.0419, dtype=torch.float64) delta_t tensor(-5.2508, dtype=torch.float64)
4 gae_duplicate tensor(-7.0541, dtype=torch.float64) tensor(14.6850, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3164, dtype=torch.float64) delta_t tensor(-0.3970, dtype=torch.float64)
3 gae_duplicate tensor(-6.0403, dtype=torch.float64) tensor(12.7786, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5188, dtype=torch.float64) delta_t tensor(-0.2212, dtype=torch.float64)
2 gae_duplicate tensor(-5.0534, dtype=torch.float64) tensor(10.5591, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:127.18968200683594
value loss:301.19964599609375
entropies:37.428958892822266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.698686122894287 seconds
19 rew tensor(0.5498, dtype=torch.float64) delta_t tensor(-0.3001, dtype=torch.float64)
19 gae_duplicate tensor(-0.3001, dtype=torch.float64) tensor(0.6233, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3522, dtype=torch.float64) delta_t tensor(0.2710, dtype=torch.float64)
18 gae_duplicate tensor(0.0309, dtype=torch.float64) tensor(-0.0644, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.1758, dtype=torch.float64) delta_t tensor(-0.1574, dtype=torch.float64)
17 gae_duplicate tensor(-0.1327, dtype=torch.float64) tensor(0.2756, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-1.0338, dtype=torch.float64) delta_t tensor(-1.2505, dtype=torch.float64)
16 gae_duplicate tensor(-1.3566, dtype=torch.float64) tensor(2.8178, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8780, dtype=torch.float64) delta_t tensor(0.7604, dtype=torch.float64)
15 gae_duplicate tensor(-0.3249, dtype=torch.float64) tensor(0.6748, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(0.5827, dtype=torch.float64)
14 gae_duplicate tensor(0.3228, dtype=torch.float64) tensor(-0.6706, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.7626, dtype=torch.float64)
13 gae_duplicate tensor(1.0209, dtype=torch.float64) tensor(-2.1251, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6839, dtype=torch.float64) delta_t tensor(0.5397, dtype=torch.float64)
12 gae_duplicate tensor(1.3564, dtype=torch.float64) tensor(-2.8175, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6189, dtype=torch.float64) delta_t tensor(0.7241, dtype=torch.float64)
11 gae_duplicate tensor(1.8092, dtype=torch.float64) tensor(-3.3949, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2244, dtype=torch.float64) delta_t tensor(-0.0036, dtype=torch.float64)
10 gae_duplicate tensor(1.4438, dtype=torch.float64) tensor(-3.3771, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5537, dtype=torch.float64) delta_t tensor(0.4149, dtype=torch.float64)
9 gae_duplicate tensor(1.5699, dtype=torch.float64) tensor(-2.9569, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0281, dtype=torch.float64) delta_t tensor(-0.0583, dtype=torch.float64)
8 gae_duplicate tensor(1.1976, dtype=torch.float64) tensor(-2.2471, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2253, dtype=torch.float64) delta_t tensor(0.0823, dtype=torch.float64)
7 gae_duplicate tensor(1.0404, dtype=torch.float64) tensor(-1.9474, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6282, dtype=torch.float64) delta_t tensor(-0.7833, dtype=torch.float64)
6 gae_duplicate tensor(0.0490, dtype=torch.float64) tensor(-0.0919, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0883, dtype=torch.float64) delta_t tensor(-1.3300, dtype=torch.float64)
5 gae_duplicate tensor(-1.2908, dtype=torch.float64) tensor(2.6813, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7469, dtype=torch.float64) delta_t tensor(-1.6101, dtype=torch.float64)
4 gae_duplicate tensor(-2.6428, dtype=torch.float64) tensor(4.9589, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0955, dtype=torch.float64) delta_t tensor(-1.3067, dtype=torch.float64)
3 gae_duplicate tensor(-3.4209, dtype=torch.float64) tensor(7.1215, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2292, dtype=torch.float64) delta_t tensor(-1.4902, dtype=torch.float64)
2 gae_duplicate tensor(-4.2270, dtype=torch.float64) tensor(8.7608, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-50.44248962402344
value loss:80.40406799316406
entropies:37.25285339355469
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.414955139160156 seconds
19 rew tensor(0.8770, dtype=torch.float64) delta_t tensor(0.0451, dtype=torch.float64)
19 gae_duplicate tensor(0.0451, dtype=torch.float64) tensor(-0.0936, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8783, dtype=torch.float64) delta_t tensor(0.6904, dtype=torch.float64)
18 gae_duplicate tensor(0.7265, dtype=torch.float64) tensor(-1.5091, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8796, dtype=torch.float64) delta_t tensor(0.7869, dtype=torch.float64)
17 gae_duplicate tensor(1.3681, dtype=torch.float64) tensor(-2.8417, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8809, dtype=torch.float64) delta_t tensor(0.9478, dtype=torch.float64)
16 gae_duplicate tensor(2.0423, dtype=torch.float64) tensor(-4.2515, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8822, dtype=torch.float64) delta_t tensor(0.6456, dtype=torch.float64)
15 gae_duplicate tensor(2.2794, dtype=torch.float64) tensor(-4.7451, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8835, dtype=torch.float64) delta_t tensor(0.7477, dtype=torch.float64)
14 gae_duplicate tensor(2.5712, dtype=torch.float64) tensor(-5.3407, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8849, dtype=torch.float64) delta_t tensor(0.7559, dtype=torch.float64)
13 gae_duplicate tensor(2.8129, dtype=torch.float64) tensor(-5.8554, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8862, dtype=torch.float64) delta_t tensor(0.7393, dtype=torch.float64)
12 gae_duplicate tensor(2.9895, dtype=torch.float64) tensor(-6.2367, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(0.7830, dtype=torch.float64)
11 gae_duplicate tensor(3.1746, dtype=torch.float64) tensor(-6.5942, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5603, dtype=torch.float64) delta_t tensor(0.4411, dtype=torch.float64)
10 gae_duplicate tensor(2.9807, dtype=torch.float64) tensor(-6.2049, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1614, dtype=torch.float64) delta_t tensor(-0.3509, dtype=torch.float64)
9 gae_duplicate tensor(2.0337, dtype=torch.float64) tensor(-4.2245, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2271, dtype=torch.float64) delta_t tensor(-0.3358, dtype=torch.float64)
8 gae_duplicate tensor(1.2912, dtype=torch.float64) tensor(-2.6879, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9485, dtype=torch.float64) delta_t tensor(-1.0657, dtype=torch.float64)
7 gae_duplicate tensor(-0.0327, dtype=torch.float64) tensor(0.0681, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8189, dtype=torch.float64) delta_t tensor(-0.8748, dtype=torch.float64)
6 gae_duplicate tensor(-0.9009, dtype=torch.float64) tensor(1.8795, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.5241, dtype=torch.float64) delta_t tensor(-2.1245, dtype=torch.float64)
5 gae_duplicate tensor(-2.8452, dtype=torch.float64) tensor(5.3583, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1327, dtype=torch.float64) delta_t tensor(-3.4821, dtype=torch.float64)
4 gae_duplicate tensor(-5.7583, dtype=torch.float64) tensor(11.3952, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1765, dtype=torch.float64) delta_t tensor(-0.2609, dtype=torch.float64)
3 gae_duplicate tensor(-4.8676, dtype=torch.float64) tensor(10.1110, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1767, dtype=torch.float64) delta_t tensor(-0.2966, dtype=torch.float64)
2 gae_duplicate tensor(-4.1907, dtype=torch.float64) tensor(8.7051, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:77.28749084472656
value loss:214.97406005859375
entropies:37.398773193359375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.1386)
ToM Target loss= tensor(303.3017)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.214374303817749 seconds
19 rew tensor(0.8764, dtype=torch.float64) delta_t tensor(0.1319, dtype=torch.float64)
19 gae_duplicate tensor(0.1319, dtype=torch.float64) tensor(-0.2734, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8777, dtype=torch.float64) delta_t tensor(0.7288, dtype=torch.float64)
18 gae_duplicate tensor(0.8344, dtype=torch.float64) tensor(-1.7405, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8789, dtype=torch.float64) delta_t tensor(0.8133, dtype=torch.float64)
17 gae_duplicate tensor(1.4808, dtype=torch.float64) tensor(-3.0888, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8802, dtype=torch.float64) delta_t tensor(0.7896, dtype=torch.float64)
16 gae_duplicate tensor(1.9742, dtype=torch.float64) tensor(-4.1009, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8815, dtype=torch.float64) delta_t tensor(0.8788, dtype=torch.float64)
15 gae_duplicate tensor(2.4581, dtype=torch.float64) tensor(-5.1167, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8827, dtype=torch.float64) delta_t tensor(0.8323, dtype=torch.float64)
14 gae_duplicate tensor(2.7988, dtype=torch.float64) tensor(-5.8139, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8840, dtype=torch.float64) delta_t tensor(0.7761, dtype=torch.float64)
13 gae_duplicate tensor(3.0151, dtype=torch.float64) tensor(-6.2765, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8853, dtype=torch.float64) delta_t tensor(0.7177, dtype=torch.float64)
12 gae_duplicate tensor(3.1298, dtype=torch.float64) tensor(-6.5149, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8866, dtype=torch.float64) delta_t tensor(0.8214, dtype=torch.float64)
11 gae_duplicate tensor(3.3252, dtype=torch.float64) tensor(-6.9362, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5590, dtype=torch.float64) delta_t tensor(0.6689, dtype=torch.float64)
10 gae_duplicate tensor(3.3291, dtype=torch.float64) tensor(-6.2893, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0995, dtype=torch.float64) delta_t tensor(-0.0157, dtype=torch.float64)
9 gae_duplicate tensor(2.6476, dtype=torch.float64) tensor(-6.1578, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0318, dtype=torch.float64) delta_t tensor(-0.1648, dtype=torch.float64)
8 gae_duplicate tensor(1.9533, dtype=torch.float64) tensor(-3.6763, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2132, dtype=torch.float64) delta_t tensor(-1.3246, dtype=torch.float64)
7 gae_duplicate tensor(0.2380, dtype=torch.float64) tensor(-0.4945, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.7409, dtype=torch.float64) delta_t tensor(-1.8443, dtype=torch.float64)
6 gae_duplicate tensor(-1.6538, dtype=torch.float64) tensor(3.1099, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7602, dtype=torch.float64) delta_t tensor(-0.9553, dtype=torch.float64)
5 gae_duplicate tensor(-2.2784, dtype=torch.float64) tensor(4.3998, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2871, dtype=torch.float64) delta_t tensor(-1.4073, dtype=torch.float64)
4 gae_duplicate tensor(-3.2300, dtype=torch.float64) tensor(6.8177, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.1451, dtype=torch.float64) delta_t tensor(-1.8153, dtype=torch.float64)
3 gae_duplicate tensor(-4.3993, dtype=torch.float64) tensor(8.9072, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2418, dtype=torch.float64) delta_t tensor(-0.5687, dtype=torch.float64)
2 gae_duplicate tensor(-4.0881, dtype=torch.float64) tensor(8.5097, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:147.2937774658203
value loss:190.52037048339844
entropies:37.3222770690918
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.550616025924683 seconds
19 rew tensor(0.8784, dtype=torch.float64) delta_t tensor(0.1023, dtype=torch.float64)
19 gae_duplicate tensor(0.1023, dtype=torch.float64) tensor(-0.2129, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8796, dtype=torch.float64) delta_t tensor(0.7702, dtype=torch.float64)
18 gae_duplicate tensor(0.8521, dtype=torch.float64) tensor(-1.7665, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8808, dtype=torch.float64) delta_t tensor(0.8907, dtype=torch.float64)
17 gae_duplicate tensor(1.5724, dtype=torch.float64) tensor(-3.2794, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8820, dtype=torch.float64) delta_t tensor(0.6828, dtype=torch.float64)
16 gae_duplicate tensor(1.9407, dtype=torch.float64) tensor(-4.0396, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8833, dtype=torch.float64) delta_t tensor(0.7390, dtype=torch.float64)
15 gae_duplicate tensor(2.2915, dtype=torch.float64) tensor(-4.7604, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8845, dtype=torch.float64) delta_t tensor(0.9271, dtype=torch.float64)
14 gae_duplicate tensor(2.7603, dtype=torch.float64) tensor(-5.9674, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8858, dtype=torch.float64) delta_t tensor(0.7520, dtype=torch.float64)
13 gae_duplicate tensor(2.9602, dtype=torch.float64) tensor(-6.1616, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2940, dtype=torch.float64) delta_t tensor(0.1797, dtype=torch.float64)
12 gae_duplicate tensor(2.5479, dtype=torch.float64) tensor(-5.2930, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3601, dtype=torch.float64) delta_t tensor(0.2976, dtype=torch.float64)
11 gae_duplicate tensor(2.3359, dtype=torch.float64) tensor(-4.8428, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2289, dtype=torch.float64) delta_t tensor(0.1407, dtype=torch.float64)
10 gae_duplicate tensor(2.0094, dtype=torch.float64) tensor(-4.1743, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2291, dtype=torch.float64) delta_t tensor(0.1527, dtype=torch.float64)
9 gae_duplicate tensor(1.7602, dtype=torch.float64) tensor(-3.6494, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0335, dtype=torch.float64) delta_t tensor(-0.1881, dtype=torch.float64)
8 gae_duplicate tensor(1.2201, dtype=torch.float64) tensor(-2.5345, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8869, dtype=torch.float64) delta_t tensor(-1.0985, dtype=torch.float64)
7 gae_duplicate tensor(-0.1224, dtype=torch.float64) tensor(0.2543, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.2664, dtype=torch.float64) delta_t tensor(-2.3574, dtype=torch.float64)
6 gae_duplicate tensor(-2.4554, dtype=torch.float64) tensor(5.1107, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0264, dtype=torch.float64) delta_t tensor(-1.1987, dtype=torch.float64)
5 gae_duplicate tensor(-3.1630, dtype=torch.float64) tensor(6.5577, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2793, dtype=torch.float64) delta_t tensor(-2.3452, dtype=torch.float64)
4 gae_duplicate tensor(-4.8756, dtype=torch.float64) tensor(10.1490, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3085, dtype=torch.float64) delta_t tensor(-0.3700, dtype=torch.float64)
3 gae_duplicate tensor(-4.2705, dtype=torch.float64) tensor(8.9069, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3087, dtype=torch.float64) delta_t tensor(-0.4713, dtype=torch.float64)
2 gae_duplicate tensor(-3.8877, dtype=torch.float64) tensor(8.0759, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:44.64266586303711
value loss:183.52896118164062
entropies:37.42669677734375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.37385106086731 seconds
19 rew tensor(0.8711, dtype=torch.float64) delta_t tensor(0.2765, dtype=torch.float64)
19 gae_duplicate tensor(0.2765, dtype=torch.float64) tensor(-0.5755, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8723, dtype=torch.float64) delta_t tensor(0.8599, dtype=torch.float64)
18 gae_duplicate tensor(1.0811, dtype=torch.float64) tensor(-2.2459, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8735, dtype=torch.float64) delta_t tensor(0.7708, dtype=torch.float64)
17 gae_duplicate tensor(1.6357, dtype=torch.float64) tensor(-3.3981, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8746, dtype=torch.float64) delta_t tensor(0.7339, dtype=torch.float64)
16 gae_duplicate tensor(2.0424, dtype=torch.float64) tensor(-4.2512, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8758, dtype=torch.float64) delta_t tensor(0.7374, dtype=torch.float64)
15 gae_duplicate tensor(2.3714, dtype=torch.float64) tensor(-4.9357, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8770, dtype=torch.float64) delta_t tensor(0.7153, dtype=torch.float64)
14 gae_duplicate tensor(2.6124, dtype=torch.float64) tensor(-5.4273, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8782, dtype=torch.float64) delta_t tensor(0.8464, dtype=torch.float64)
13 gae_duplicate tensor(2.9363, dtype=torch.float64) tensor(-6.1003, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0995, dtype=torch.float64) delta_t tensor(-0.0763, dtype=torch.float64)
12 gae_duplicate tensor(2.2728, dtype=torch.float64) tensor(-4.7392, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0996, dtype=torch.float64) delta_t tensor(0.1303, dtype=torch.float64)
11 gae_duplicate tensor(1.9485, dtype=torch.float64) tensor(-4.2379, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2248, dtype=torch.float64) delta_t tensor(-0.3659, dtype=torch.float64)
10 gae_duplicate tensor(1.1929, dtype=torch.float64) tensor(-2.4875, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0953, dtype=torch.float64) delta_t tensor(-0.2186, dtype=torch.float64)
9 gae_duplicate tensor(0.7357, dtype=torch.float64) tensor(-1.5257, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3545, dtype=torch.float64) delta_t tensor(-0.3936, dtype=torch.float64)
8 gae_duplicate tensor(0.1950, dtype=torch.float64) tensor(-0.4067, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4196, dtype=torch.float64) delta_t tensor(-0.6482, dtype=torch.float64)
7 gae_duplicate tensor(-0.4922, dtype=torch.float64) tensor(1.0226, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9376, dtype=torch.float64) delta_t tensor(-1.0330, dtype=torch.float64)
6 gae_duplicate tensor(-1.4268, dtype=torch.float64) tensor(2.9751, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2625, dtype=torch.float64) delta_t tensor(-1.4500, dtype=torch.float64)
5 gae_duplicate tensor(-2.5914, dtype=torch.float64) tensor(5.3936, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.3431, dtype=torch.float64) delta_t tensor(-5.3932, dtype=torch.float64)
4 gae_duplicate tensor(-7.4663, dtype=torch.float64) tensor(15.4821, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2429, dtype=torch.float64) delta_t tensor(-0.2362, dtype=torch.float64)
3 gae_duplicate tensor(-6.2092, dtype=torch.float64) tensor(12.9233, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0447, dtype=torch.float64) delta_t tensor(-0.2728, dtype=torch.float64)
2 gae_duplicate tensor(-5.2402, dtype=torch.float64) tensor(10.8662, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-51.11400604248047
value loss:256.3182373046875
entropies:37.42537307739258
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.551980018615723 seconds
19 rew tensor(-1.5465, dtype=torch.float64) delta_t tensor(-2.0170, dtype=torch.float64)
19 gae_duplicate tensor(-2.0170, dtype=torch.float64) tensor(4.1907, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8730, dtype=torch.float64) delta_t tensor(0.7789, dtype=torch.float64)
18 gae_duplicate tensor(-0.8347, dtype=torch.float64) tensor(1.7343, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8741, dtype=torch.float64) delta_t tensor(0.7800, dtype=torch.float64)
17 gae_duplicate tensor(0.1122, dtype=torch.float64) tensor(-0.2327, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8752, dtype=torch.float64) delta_t tensor(0.8456, dtype=torch.float64)
16 gae_duplicate tensor(0.9353, dtype=torch.float64) tensor(-1.9466, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7455, dtype=torch.float64) delta_t tensor(0.6365, dtype=torch.float64)
15 gae_duplicate tensor(1.3848, dtype=torch.float64) tensor(-2.8772, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(0.3605, dtype=torch.float64)
14 gae_duplicate tensor(1.4683, dtype=torch.float64) tensor(-3.0507, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6819, dtype=torch.float64) delta_t tensor(0.6164, dtype=torch.float64)
13 gae_duplicate tensor(1.7911, dtype=torch.float64) tensor(-3.7213, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6172, dtype=torch.float64) delta_t tensor(0.4675, dtype=torch.float64)
12 gae_duplicate tensor(1.9003, dtype=torch.float64) tensor(-3.9483, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6832, dtype=torch.float64) delta_t tensor(0.5054, dtype=torch.float64)
11 gae_duplicate tensor(2.0256, dtype=torch.float64) tensor(-4.2084, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6187, dtype=torch.float64) delta_t tensor(0.7063, dtype=torch.float64)
10 gae_duplicate tensor(2.3268, dtype=torch.float64) tensor(-4.8344, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2927, dtype=torch.float64) delta_t tensor(-0.0189, dtype=torch.float64)
9 gae_duplicate tensor(1.8426, dtype=torch.float64) tensor(-3.8347, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0986, dtype=torch.float64) delta_t tensor(0.1820, dtype=torch.float64)
8 gae_duplicate tensor(1.6560, dtype=torch.float64) tensor(-3.4347, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6857, dtype=torch.float64) delta_t tensor(-0.9977, dtype=torch.float64)
7 gae_duplicate tensor(0.3271, dtype=torch.float64) tensor(-0.6796, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3384, dtype=torch.float64) delta_t tensor(-1.3404, dtype=torch.float64)
6 gae_duplicate tensor(-1.0787, dtype=torch.float64) tensor(2.4539, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4201, dtype=torch.float64) delta_t tensor(0.3196, dtype=torch.float64)
5 gae_duplicate tensor(-0.5433, dtype=torch.float64) tensor(1.0936, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7530, dtype=torch.float64) delta_t tensor(-0.8197, dtype=torch.float64)
4 gae_duplicate tensor(-1.2543, dtype=torch.float64) tensor(2.7560, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2237, dtype=torch.float64) delta_t tensor(0.3060, dtype=torch.float64)
3 gae_duplicate tensor(-0.6974, dtype=torch.float64) tensor(1.3897, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0786, dtype=torch.float64) delta_t tensor(-1.1183, dtype=torch.float64)
2 gae_duplicate tensor(-1.6762, dtype=torch.float64) tensor(3.4888, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:92.84830474853516
value loss:57.952491760253906
entropies:37.401092529296875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.609323024749756 seconds
19 rew tensor(0.8662, dtype=torch.float64) delta_t tensor(0.3159, dtype=torch.float64)
19 gae_duplicate tensor(0.3159, dtype=torch.float64) tensor(-0.6552, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8673, dtype=torch.float64) delta_t tensor(0.7572, dtype=torch.float64)
18 gae_duplicate tensor(1.0099, dtype=torch.float64) tensor(-2.0984, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8684, dtype=torch.float64) delta_t tensor(0.7583, dtype=torch.float64)
17 gae_duplicate tensor(1.5662, dtype=torch.float64) tensor(-3.2542, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8048, dtype=torch.float64) delta_t tensor(0.6888, dtype=torch.float64)
16 gae_duplicate tensor(1.9418, dtype=torch.float64) tensor(-4.0346, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8704, dtype=torch.float64) delta_t tensor(0.6530, dtype=torch.float64)
15 gae_duplicate tensor(2.2065, dtype=torch.float64) tensor(-4.5919, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8069, dtype=torch.float64) delta_t tensor(0.6632, dtype=torch.float64)
14 gae_duplicate tensor(2.4284, dtype=torch.float64) tensor(-5.0457, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8724, dtype=torch.float64) delta_t tensor(0.7377, dtype=torch.float64)
13 gae_duplicate tensor(2.6805, dtype=torch.float64) tensor(-5.5603, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8735, dtype=torch.float64) delta_t tensor(0.7362, dtype=torch.float64)
12 gae_duplicate tensor(2.8805, dtype=torch.float64) tensor(-5.9851, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8101, dtype=torch.float64) delta_t tensor(0.8347, dtype=torch.float64)
11 gae_duplicate tensor(3.1392, dtype=torch.float64) tensor(-6.5330, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6820, dtype=torch.float64) delta_t tensor(0.5239, dtype=torch.float64)
10 gae_duplicate tensor(3.0352, dtype=torch.float64) tensor(-6.2962, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7369, dtype=torch.float64) delta_t tensor(-0.9090, dtype=torch.float64)
9 gae_duplicate tensor(1.5192, dtype=torch.float64) tensor(-3.1514, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1572, dtype=torch.float64) delta_t tensor(-0.3248, dtype=torch.float64)
8 gae_duplicate tensor(0.8906, dtype=torch.float64) tensor(-1.8475, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3507, dtype=torch.float64) delta_t tensor(-0.4561, dtype=torch.float64)
7 gae_duplicate tensor(0.2564, dtype=torch.float64) tensor(-0.5326, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3173, dtype=torch.float64) delta_t tensor(-1.3583, dtype=torch.float64)
6 gae_duplicate tensor(-1.1532, dtype=torch.float64) tensor(2.4000, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7066, dtype=torch.float64) delta_t tensor(-1.7939, dtype=torch.float64)
5 gae_duplicate tensor(-2.7165, dtype=torch.float64) tensor(5.6442, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.8096, dtype=torch.float64) delta_t tensor(-4.9501, dtype=torch.float64)
4 gae_duplicate tensor(-7.1233, dtype=torch.float64) tensor(14.8246, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0411, dtype=torch.float64) delta_t tensor(-0.0278, dtype=torch.float64)
3 gae_duplicate tensor(-5.7265, dtype=torch.float64) tensor(11.8788, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1722, dtype=torch.float64) delta_t tensor(-0.3909, dtype=torch.float64)
2 gae_duplicate tensor(-4.9721, dtype=torch.float64) tensor(10.3476, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:25.822582244873047
value loss:259.1867370605469
entropies:37.42987060546875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.6826)
ToM Target loss= tensor(303.5420)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.327385663986206 seconds
19 rew tensor(0.8656, dtype=torch.float64) delta_t tensor(0.1778, dtype=torch.float64)
19 gae_duplicate tensor(0.1778, dtype=torch.float64) tensor(-0.3688, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8667, dtype=torch.float64) delta_t tensor(0.7362, dtype=torch.float64)
18 gae_duplicate tensor(0.8784, dtype=torch.float64) tensor(-1.8252, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8678, dtype=torch.float64) delta_t tensor(0.7263, dtype=torch.float64)
17 gae_duplicate tensor(1.4290, dtype=torch.float64) tensor(-2.9738, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8688, dtype=torch.float64) delta_t tensor(0.7366, dtype=torch.float64)
16 gae_duplicate tensor(1.8798, dtype=torch.float64) tensor(-3.9119, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8699, dtype=torch.float64) delta_t tensor(0.7625, dtype=torch.float64)
15 gae_duplicate tensor(2.2663, dtype=torch.float64) tensor(-4.7164, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8709, dtype=torch.float64) delta_t tensor(0.8138, dtype=torch.float64)
14 gae_duplicate tensor(2.6269, dtype=torch.float64) tensor(-5.4669, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8720, dtype=torch.float64) delta_t tensor(0.9622, dtype=torch.float64)
13 gae_duplicate tensor(3.0638, dtype=torch.float64) tensor(-6.3662, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8731, dtype=torch.float64) delta_t tensor(0.7996, dtype=torch.float64)
12 gae_duplicate tensor(3.2507, dtype=torch.float64) tensor(-6.7542, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8742, dtype=torch.float64) delta_t tensor(0.6242, dtype=torch.float64)
11 gae_duplicate tensor(3.2248, dtype=torch.float64) tensor(-6.7004, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8753, dtype=torch.float64) delta_t tensor(0.8315, dtype=torch.float64)
10 gae_duplicate tensor(3.4113, dtype=torch.float64) tensor(-7.0992, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5523, dtype=torch.float64) delta_t tensor(0.6070, dtype=torch.float64)
9 gae_duplicate tensor(3.3360, dtype=torch.float64) tensor(-6.9317, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0346, dtype=torch.float64) delta_t tensor(-0.3419, dtype=torch.float64)
8 gae_duplicate tensor(2.3269, dtype=torch.float64) tensor(-4.8501, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1595, dtype=torch.float64) delta_t tensor(-0.1838, dtype=torch.float64)
7 gae_duplicate tensor(1.6778, dtype=torch.float64) tensor(-3.4916, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6124, dtype=torch.float64) delta_t tensor(-0.5271, dtype=torch.float64)
6 gae_duplicate tensor(0.8152, dtype=torch.float64) tensor(-1.6964, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0010, dtype=torch.float64) delta_t tensor(-1.1113, dtype=torch.float64)
5 gae_duplicate tensor(-0.4592, dtype=torch.float64) tensor(0.9541, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5843, dtype=torch.float64) delta_t tensor(-1.7313, dtype=torch.float64)
4 gae_duplicate tensor(-2.0986, dtype=torch.float64) tensor(4.3673, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1999, dtype=torch.float64) delta_t tensor(-1.2285, dtype=torch.float64)
3 gae_duplicate tensor(-2.9074, dtype=torch.float64) tensor(6.0408, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9430, dtype=torch.float64) delta_t tensor(-1.0932, dtype=torch.float64)
2 gae_duplicate tensor(-3.4191, dtype=torch.float64) tensor(7.1152, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:266.92877197265625
value loss:157.77999877929688
entropies:37.429874420166016
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.54083776473999 seconds
19 rew tensor(0.8690, dtype=torch.float64) delta_t tensor(0.2740, dtype=torch.float64)
19 gae_duplicate tensor(0.2740, dtype=torch.float64) tensor(-0.5694, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8700, dtype=torch.float64) delta_t tensor(0.7359, dtype=torch.float64)
18 gae_duplicate tensor(0.9551, dtype=torch.float64) tensor(-1.9847, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8711, dtype=torch.float64) delta_t tensor(0.7429, dtype=torch.float64)
17 gae_duplicate tensor(1.5070, dtype=torch.float64) tensor(-3.1314, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8721, dtype=torch.float64) delta_t tensor(0.7429, dtype=torch.float64)
16 gae_duplicate tensor(1.9485, dtype=torch.float64) tensor(-4.0428, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8732, dtype=torch.float64) delta_t tensor(0.7933, dtype=torch.float64)
15 gae_duplicate tensor(2.3521, dtype=torch.float64) tensor(-4.9020, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8742, dtype=torch.float64) delta_t tensor(0.7309, dtype=torch.float64)
14 gae_duplicate tensor(2.6126, dtype=torch.float64) tensor(-5.4287, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6147, dtype=torch.float64) delta_t tensor(0.5281, dtype=torch.float64)
13 gae_duplicate tensor(2.6182, dtype=torch.float64) tensor(-5.4486, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4200, dtype=torch.float64) delta_t tensor(0.3416, dtype=torch.float64)
12 gae_duplicate tensor(2.4362, dtype=torch.float64) tensor(-5.0620, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3552, dtype=torch.float64) delta_t tensor(0.2734, dtype=torch.float64)
11 gae_duplicate tensor(2.2224, dtype=torch.float64) tensor(-4.6247, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4205, dtype=torch.float64) delta_t tensor(0.2768, dtype=torch.float64)
10 gae_duplicate tensor(2.0547, dtype=torch.float64) tensor(-4.2695, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2909, dtype=torch.float64) delta_t tensor(0.1551, dtype=torch.float64)
9 gae_duplicate tensor(1.7989, dtype=torch.float64) tensor(-3.7490, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1636, dtype=torch.float64) delta_t tensor(-0.4417, dtype=torch.float64)
8 gae_duplicate tensor(0.9974, dtype=torch.float64) tensor(-2.0786, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0725, dtype=torch.float64) delta_t tensor(-1.0345, dtype=torch.float64)
7 gae_duplicate tensor(-0.2366, dtype=torch.float64) tensor(0.4916, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.1128, dtype=torch.float64) delta_t tensor(-2.2153, dtype=torch.float64)
6 gae_duplicate tensor(-2.4045, dtype=torch.float64) tensor(4.9889, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1446, dtype=torch.float64) delta_t tensor(-1.3258, dtype=torch.float64)
5 gae_duplicate tensor(-3.2494, dtype=torch.float64) tensor(6.7520, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4305, dtype=torch.float64) delta_t tensor(-0.2844, dtype=torch.float64)
4 gae_duplicate tensor(-2.8839, dtype=torch.float64) tensor(5.5878, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4308, dtype=torch.float64) delta_t tensor(-0.4542, dtype=torch.float64)
3 gae_duplicate tensor(-2.7614, dtype=torch.float64) tensor(5.7552, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4962, dtype=torch.float64) delta_t tensor(-0.6776, dtype=torch.float64)
2 gae_duplicate tensor(-2.8867, dtype=torch.float64) tensor(6.0074, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:93.1283950805664
value loss:129.39976501464844
entropies:37.41876220703125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.469188928604126 seconds
19 rew tensor(0.8117, dtype=torch.float64) delta_t tensor(-0.1204, dtype=torch.float64)
19 gae_duplicate tensor(-0.1204, dtype=torch.float64) tensor(0.2501, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6165, dtype=torch.float64) delta_t tensor(0.4646, dtype=torch.float64)
18 gae_duplicate tensor(0.3683, dtype=torch.float64) tensor(-0.7653, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4864, dtype=torch.float64) delta_t tensor(0.3221, dtype=torch.float64)
17 gae_duplicate tensor(0.6167, dtype=torch.float64) tensor(-1.2797, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0951, dtype=torch.float64) delta_t tensor(0.0525, dtype=torch.float64)
16 gae_duplicate tensor(0.5458, dtype=torch.float64) tensor(-1.1359, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.5574, dtype=torch.float64) delta_t tensor(-0.5129, dtype=torch.float64)
15 gae_duplicate tensor(-0.0762, dtype=torch.float64) tensor(0.1583, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(0.6717, dtype=torch.float64)
14 gae_duplicate tensor(0.6107, dtype=torch.float64) tensor(-1.2727, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8779, dtype=torch.float64) delta_t tensor(0.7551, dtype=torch.float64)
13 gae_duplicate tensor(1.2437, dtype=torch.float64) tensor(-2.5808, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7485, dtype=torch.float64) delta_t tensor(0.6169, dtype=torch.float64)
12 gae_duplicate tensor(1.6119, dtype=torch.float64) tensor(-3.3541, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.6935, dtype=torch.float64)
11 gae_duplicate tensor(1.9830, dtype=torch.float64) tensor(-4.1208, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7502, dtype=torch.float64) delta_t tensor(0.3844, dtype=torch.float64)
10 gae_duplicate tensor(1.9708, dtype=torch.float64) tensor(-4.1011, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5519, dtype=torch.float64) delta_t tensor(-0.6697, dtype=torch.float64)
9 gae_duplicate tensor(0.9070, dtype=torch.float64) tensor(-1.8899, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6175, dtype=torch.float64) delta_t tensor(-0.8113, dtype=torch.float64)
8 gae_duplicate tensor(-0.0857, dtype=torch.float64) tensor(0.1782, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8134, dtype=torch.float64) delta_t tensor(-0.9697, dtype=torch.float64)
7 gae_duplicate tensor(-1.0383, dtype=torch.float64) tensor(2.1546, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3349, dtype=torch.float64) delta_t tensor(-1.3778, dtype=torch.float64)
6 gae_duplicate tensor(-2.2085, dtype=torch.float64) tensor(4.5956, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1420, dtype=torch.float64) delta_t tensor(-1.1377, dtype=torch.float64)
5 gae_duplicate tensor(-2.9045, dtype=torch.float64) tensor(6.0441, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0555, dtype=torch.float64) delta_t tensor(-2.1678, dtype=torch.float64)
4 gae_duplicate tensor(-4.4914, dtype=torch.float64) tensor(9.3593, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7575, dtype=torch.float64) delta_t tensor(-0.7444, dtype=torch.float64)
3 gae_duplicate tensor(-4.3376, dtype=torch.float64) tensor(9.0131, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7583, dtype=torch.float64) delta_t tensor(-0.8628, dtype=torch.float64)
2 gae_duplicate tensor(-4.3328, dtype=torch.float64) tensor(9.0034, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-122.66070556640625
value loss:129.22653198242188
entropies:37.42988967895508
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.527167081832886 seconds
19 rew tensor(0.4266, dtype=torch.float64) delta_t tensor(-0.5366, dtype=torch.float64)
19 gae_duplicate tensor(-0.5366, dtype=torch.float64) tensor(1.1151, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.0973, dtype=torch.float64) delta_t tensor(-0.2250, dtype=torch.float64)
18 gae_duplicate tensor(-0.6543, dtype=torch.float64) tensor(1.3632, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.9488, dtype=torch.float64) delta_t tensor(-0.9020, dtype=torch.float64)
17 gae_duplicate tensor(-1.4254, dtype=torch.float64) tensor(2.9622, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8182, dtype=torch.float64) delta_t tensor(0.6398, dtype=torch.float64)
16 gae_duplicate tensor(-0.5006, dtype=torch.float64) tensor(1.0416, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6882, dtype=torch.float64) delta_t tensor(0.5994, dtype=torch.float64)
15 gae_duplicate tensor(0.1989, dtype=torch.float64) tensor(-0.4134, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6888, dtype=torch.float64) delta_t tensor(0.5594, dtype=torch.float64)
14 gae_duplicate tensor(0.7185, dtype=torch.float64) tensor(-1.4950, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4932, dtype=torch.float64) delta_t tensor(0.3694, dtype=torch.float64)
13 gae_duplicate tensor(0.9442, dtype=torch.float64) tensor(-1.9595, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8860, dtype=torch.float64) delta_t tensor(0.5124, dtype=torch.float64)
12 gae_duplicate tensor(1.2678, dtype=torch.float64) tensor(-2.6346, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8216, dtype=torch.float64) delta_t tensor(0.6473, dtype=torch.float64)
11 gae_duplicate tensor(1.6615, dtype=torch.float64) tensor(-3.4573, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8225, dtype=torch.float64) delta_t tensor(0.6399, dtype=torch.float64)
10 gae_duplicate tensor(1.9691, dtype=torch.float64) tensor(-4.0865, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5492, dtype=torch.float64) delta_t tensor(-0.7219, dtype=torch.float64)
9 gae_duplicate tensor(0.8534, dtype=torch.float64) tensor(-1.7757, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6150, dtype=torch.float64) delta_t tensor(-0.7898, dtype=torch.float64)
8 gae_duplicate tensor(-0.1071, dtype=torch.float64) tensor(0.2222, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5951, dtype=torch.float64) delta_t tensor(-1.6746, dtype=torch.float64)
7 gae_duplicate tensor(-1.7603, dtype=torch.float64) tensor(3.6581, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7490, dtype=torch.float64) delta_t tensor(-0.2001, dtype=torch.float64)
6 gae_duplicate tensor(-1.6084, dtype=torch.float64) tensor(3.1803, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2072, dtype=torch.float64) delta_t tensor(-1.5943, dtype=torch.float64)
5 gae_duplicate tensor(-2.8810, dtype=torch.float64) tensor(5.6272, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8629, dtype=torch.float64) delta_t tensor(-1.7968, dtype=torch.float64)
4 gae_duplicate tensor(-4.1016, dtype=torch.float64) tensor(8.7397, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5588, dtype=torch.float64) delta_t tensor(-0.6236, dtype=torch.float64)
3 gae_duplicate tensor(-3.9049, dtype=torch.float64) tensor(8.1038, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5593, dtype=torch.float64) delta_t tensor(-0.6901, dtype=torch.float64)
2 gae_duplicate tensor(-3.8141, dtype=torch.float64) tensor(7.9154, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-169.7638397216797
value loss:111.05300903320312
entropies:37.412879943847656
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.330795049667358 seconds
19 rew tensor(0.8874, dtype=torch.float64) delta_t tensor(0.0431, dtype=torch.float64)
19 gae_duplicate tensor(0.0431, dtype=torch.float64) tensor(-0.0898, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8884, dtype=torch.float64) delta_t tensor(0.5892, dtype=torch.float64)
18 gae_duplicate tensor(0.6236, dtype=torch.float64) tensor(-1.2943, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8894, dtype=torch.float64) delta_t tensor(0.7528, dtype=torch.float64)
17 gae_duplicate tensor(1.2517, dtype=torch.float64) tensor(-2.6046, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8904, dtype=torch.float64) delta_t tensor(0.7570, dtype=torch.float64)
16 gae_duplicate tensor(1.7584, dtype=torch.float64) tensor(-3.6542, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8914, dtype=torch.float64) delta_t tensor(1.0831, dtype=torch.float64)
15 gae_duplicate tensor(2.4898, dtype=torch.float64) tensor(-5.1874, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8924, dtype=torch.float64) delta_t tensor(0.6949, dtype=torch.float64)
14 gae_duplicate tensor(2.6868, dtype=torch.float64) tensor(-5.5906, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7618, dtype=torch.float64) delta_t tensor(0.6230, dtype=torch.float64)
13 gae_duplicate tensor(2.7724, dtype=torch.float64) tensor(-5.7539, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6968, dtype=torch.float64) delta_t tensor(0.6090, dtype=torch.float64)
12 gae_duplicate tensor(2.8269, dtype=torch.float64) tensor(-5.8821, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5002, dtype=torch.float64) delta_t tensor(0.3660, dtype=torch.float64)
11 gae_duplicate tensor(2.6275, dtype=torch.float64) tensor(-5.4672, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1719, dtype=torch.float64) delta_t tensor(0.0926, dtype=torch.float64)
10 gae_duplicate tensor(2.1946, dtype=torch.float64) tensor(-4.5665, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5505, dtype=torch.float64) delta_t tensor(-0.8524, dtype=torch.float64)
9 gae_duplicate tensor(0.9033, dtype=torch.float64) tensor(-1.8748, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2227, dtype=torch.float64) delta_t tensor(-0.3632, dtype=torch.float64)
8 gae_duplicate tensor(0.3595, dtype=torch.float64) tensor(-0.7480, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1709, dtype=torch.float64) delta_t tensor(0.3306, dtype=torch.float64)
7 gae_duplicate tensor(0.6181, dtype=torch.float64) tensor(-1.2829, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8127, dtype=torch.float64) delta_t tensor(-1.2453, dtype=torch.float64)
6 gae_duplicate tensor(-0.7508, dtype=torch.float64) tensor(1.5622, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6659, dtype=torch.float64) delta_t tensor(-1.4912, dtype=torch.float64)
5 gae_duplicate tensor(-2.0919, dtype=torch.float64) tensor(4.5949, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4962, dtype=torch.float64) delta_t tensor(0.4312, dtype=torch.float64)
4 gae_duplicate tensor(-1.2423, dtype=torch.float64) tensor(2.5851, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2092, dtype=torch.float64) delta_t tensor(-1.2598, dtype=torch.float64)
3 gae_duplicate tensor(-2.2537, dtype=torch.float64) tensor(4.6834, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0799, dtype=torch.float64) delta_t tensor(-1.1588, dtype=torch.float64)
2 gae_duplicate tensor(-2.9617, dtype=torch.float64) tensor(6.1629, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:145.3239288330078
value loss:101.2889404296875
entropies:37.42378234863281
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(417.3940)
ToM Target loss= tensor(303.7031)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.367516994476318 seconds
19 rew tensor(0.8897, dtype=torch.float64) delta_t tensor(0.2311, dtype=torch.float64)
19 gae_duplicate tensor(0.2311, dtype=torch.float64) tensor(-0.4810, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(0.6443, dtype=torch.float64)
18 gae_duplicate tensor(0.8292, dtype=torch.float64) tensor(-1.7253, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8257, dtype=torch.float64) delta_t tensor(0.7488, dtype=torch.float64)
17 gae_duplicate tensor(1.4121, dtype=torch.float64) tensor(-2.9383, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8265, dtype=torch.float64) delta_t tensor(0.6897, dtype=torch.float64)
16 gae_duplicate tensor(1.8194, dtype=torch.float64) tensor(-3.7809, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7614, dtype=torch.float64) delta_t tensor(0.2965, dtype=torch.float64)
15 gae_duplicate tensor(1.7520, dtype=torch.float64) tensor(-3.6455, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6303, dtype=torch.float64) delta_t tensor(0.4327, dtype=torch.float64)
14 gae_duplicate tensor(1.8343, dtype=torch.float64) tensor(-3.8168, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4330, dtype=torch.float64) delta_t tensor(0.2319, dtype=torch.float64)
13 gae_duplicate tensor(1.6994, dtype=torch.float64) tensor(-3.5360, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8946, dtype=torch.float64) delta_t tensor(0.6923, dtype=torch.float64)
12 gae_duplicate tensor(2.0517, dtype=torch.float64) tensor(-4.2637, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8956, dtype=torch.float64) delta_t tensor(0.6932, dtype=torch.float64)
11 gae_duplicate tensor(2.3346, dtype=torch.float64) tensor(-4.8455, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8966, dtype=torch.float64) delta_t tensor(0.6942, dtype=torch.float64)
10 gae_duplicate tensor(2.5620, dtype=torch.float64) tensor(-5.3240, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4856, dtype=torch.float64) delta_t tensor(-0.6910, dtype=torch.float64)
9 gae_duplicate tensor(1.3585, dtype=torch.float64) tensor(-2.8304, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5518, dtype=torch.float64) delta_t tensor(-0.7268, dtype=torch.float64)
8 gae_duplicate tensor(0.3600, dtype=torch.float64) tensor(-0.7482, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0916, dtype=torch.float64) delta_t tensor(-0.2452, dtype=torch.float64)
7 gae_duplicate tensor(0.0428, dtype=torch.float64) tensor(-0.0891, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0782, dtype=torch.float64) delta_t tensor(-1.1759, dtype=torch.float64)
6 gae_duplicate tensor(-1.1417, dtype=torch.float64) tensor(2.3726, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8031, dtype=torch.float64) delta_t tensor(-1.5358, dtype=torch.float64)
5 gae_duplicate tensor(-2.4491, dtype=torch.float64) tensor(5.0961, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8738, dtype=torch.float64) delta_t tensor(-2.1114, dtype=torch.float64)
4 gae_duplicate tensor(-4.0707, dtype=torch.float64) tensor(8.4702, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4937, dtype=torch.float64) delta_t tensor(-0.3790, dtype=torch.float64)
3 gae_duplicate tensor(-3.6356, dtype=torch.float64) tensor(7.5551, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5600, dtype=torch.float64) delta_t tensor(-0.5243, dtype=torch.float64)
2 gae_duplicate tensor(-3.4327, dtype=torch.float64) tensor(7.1336, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:43.259437561035156
value loss:123.662109375
entropies:37.42989730834961
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.498339891433716 seconds
19 rew tensor(0.8291, dtype=torch.float64) delta_t tensor(-0.3297, dtype=torch.float64)
19 gae_duplicate tensor(-0.3297, dtype=torch.float64) tensor(0.6859, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6317, dtype=torch.float64) delta_t tensor(0.4057, dtype=torch.float64)
18 gae_duplicate tensor(0.1420, dtype=torch.float64) tensor(-0.2958, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5661, dtype=torch.float64) delta_t tensor(0.3429, dtype=torch.float64)
17 gae_duplicate tensor(0.4565, dtype=torch.float64) tensor(-0.9498, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1042, dtype=torch.float64) delta_t tensor(0.1234, dtype=torch.float64)
16 gae_duplicate tensor(0.4886, dtype=torch.float64) tensor(-1.0167, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.5558, dtype=torch.float64) delta_t tensor(-0.4056, dtype=torch.float64)
15 gae_duplicate tensor(-0.0147, dtype=torch.float64) tensor(0.0306, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8953, dtype=torch.float64) delta_t tensor(0.7919, dtype=torch.float64)
14 gae_duplicate tensor(0.7801, dtype=torch.float64) tensor(-1.6233, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8303, dtype=torch.float64) delta_t tensor(0.6926, dtype=torch.float64)
13 gae_duplicate tensor(1.3167, dtype=torch.float64) tensor(-2.7398, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8971, dtype=torch.float64) delta_t tensor(0.7209, dtype=torch.float64)
12 gae_duplicate tensor(1.7742, dtype=torch.float64) tensor(-3.6870, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.8059, dtype=torch.float64) delta_t tensor(-1.5756, dtype=torch.float64)
11 gae_duplicate tensor(-0.1562, dtype=torch.float64) tensor(0.3250, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6990, dtype=torch.float64) delta_t tensor(0.4625, dtype=torch.float64)
10 gae_duplicate tensor(0.3375, dtype=torch.float64) tensor(-0.7032, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5676, dtype=torch.float64) delta_t tensor(0.3783, dtype=torch.float64)
9 gae_duplicate tensor(0.6483, dtype=torch.float64) tensor(-1.3473, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1721, dtype=torch.float64) delta_t tensor(0.0108, dtype=torch.float64)
8 gae_duplicate tensor(0.5294, dtype=torch.float64) tensor(-1.1002, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4873, dtype=torch.float64) delta_t tensor(-0.2739, dtype=torch.float64)
7 gae_duplicate tensor(0.1496, dtype=torch.float64) tensor(-0.2957, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4766, dtype=torch.float64) delta_t tensor(-1.5161, dtype=torch.float64)
6 gae_duplicate tensor(-1.3964, dtype=torch.float64) tensor(2.7498, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5454, dtype=torch.float64) delta_t tensor(-1.7006, dtype=torch.float64)
5 gae_duplicate tensor(-2.8177, dtype=torch.float64) tensor(5.7739, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1021, dtype=torch.float64) delta_t tensor(-0.0557, dtype=torch.float64)
4 gae_duplicate tensor(-2.3099, dtype=torch.float64) tensor(4.7940, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4815, dtype=torch.float64) delta_t tensor(-1.4676, dtype=torch.float64)
3 gae_duplicate tensor(-3.3155, dtype=torch.float64) tensor(6.8989, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3524, dtype=torch.float64) delta_t tensor(-1.2530, dtype=torch.float64)
2 gae_duplicate tensor(-3.9053, dtype=torch.float64) tensor(8.1257, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-94.87281036376953
value loss:72.59477233886719
entropies:37.41698455810547
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.706092119216919 seconds
19 rew tensor(0.4361, dtype=torch.float64) delta_t tensor(-0.7324, dtype=torch.float64)
19 gae_duplicate tensor(-0.7324, dtype=torch.float64) tensor(1.5220, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.0927, dtype=torch.float64) delta_t tensor(-0.2481, dtype=torch.float64)
18 gae_duplicate tensor(-0.8340, dtype=torch.float64) tensor(1.7354, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7665, dtype=torch.float64) delta_t tensor(0.6324, dtype=torch.float64)
17 gae_duplicate tensor(-0.0348, dtype=torch.float64) tensor(0.0724, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7011, dtype=torch.float64) delta_t tensor(0.5301, dtype=torch.float64)
16 gae_duplicate tensor(0.5023, dtype=torch.float64) tensor(-1.0451, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4375, dtype=torch.float64) delta_t tensor(0.7749, dtype=torch.float64)
15 gae_duplicate tensor(1.1767, dtype=torch.float64) tensor(-2.4484, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1077, dtype=torch.float64) delta_t tensor(-0.0862, dtype=torch.float64)
14 gae_duplicate tensor(0.8552, dtype=torch.float64) tensor(-1.7772, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.3247, dtype=torch.float64)
13 gae_duplicate tensor(1.0089, dtype=torch.float64) tensor(-2.0991, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8346, dtype=torch.float64) delta_t tensor(0.6310, dtype=torch.float64)
12 gae_duplicate tensor(1.4381, dtype=torch.float64) tensor(-2.9887, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.6985, dtype=torch.float64)
11 gae_duplicate tensor(1.8490, dtype=torch.float64) tensor(-3.8425, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7704, dtype=torch.float64) delta_t tensor(1.3188, dtype=torch.float64)
10 gae_duplicate tensor(2.7980, dtype=torch.float64) tensor(-5.7152, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7457, dtype=torch.float64) delta_t tensor(-0.9521, dtype=torch.float64)
9 gae_duplicate tensor(1.2863, dtype=torch.float64) tensor(-2.6732, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0760, dtype=torch.float64) delta_t tensor(-1.2162, dtype=torch.float64)
8 gae_duplicate tensor(-0.1872, dtype=torch.float64) tensor(0.4020, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4180, dtype=torch.float64) delta_t tensor(-0.5591, dtype=torch.float64)
7 gae_duplicate tensor(-0.7088, dtype=torch.float64) tensor(1.4730, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.6046, dtype=torch.float64) delta_t tensor(-1.6670, dtype=torch.float64)
6 gae_duplicate tensor(-2.2340, dtype=torch.float64) tensor(4.6426, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9378, dtype=torch.float64) delta_t tensor(-2.2393, dtype=torch.float64)
5 gae_duplicate tensor(-4.0265, dtype=torch.float64) tensor(7.9429, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1050, dtype=torch.float64) delta_t tensor(0.3912, dtype=torch.float64)
4 gae_duplicate tensor(-2.8300, dtype=torch.float64) tensor(5.8886, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.4043, dtype=torch.float64) delta_t tensor(-2.6263, dtype=torch.float64)
3 gae_duplicate tensor(-4.8903, dtype=torch.float64) tensor(10.1631, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0962, dtype=torch.float64) delta_t tensor(-0.3345, dtype=torch.float64)
2 gae_duplicate tensor(-4.2467, dtype=torch.float64) tensor(8.8255, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-121.59237670898438
value loss:136.93331909179688
entropies:37.42047119140625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.455805778503418 seconds
19 rew tensor(0.7057, dtype=torch.float64) delta_t tensor(-0.4442, dtype=torch.float64)
19 gae_duplicate tensor(-0.4442, dtype=torch.float64) tensor(0.9242, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6400, dtype=torch.float64) delta_t tensor(0.3403, dtype=torch.float64)
18 gae_duplicate tensor(-0.0151, dtype=torch.float64) tensor(0.0314, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3751, dtype=torch.float64) delta_t tensor(0.3772, dtype=torch.float64)
17 gae_duplicate tensor(0.3651, dtype=torch.float64) tensor(-0.7597, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.0888, dtype=torch.float64) delta_t tensor(0.2171, dtype=torch.float64)
16 gae_duplicate tensor(0.5092, dtype=torch.float64) tensor(-1.0571, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8389, dtype=torch.float64) delta_t tensor(0.7420, dtype=torch.float64)
15 gae_duplicate tensor(1.1494, dtype=torch.float64) tensor(-2.3888, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7735, dtype=torch.float64) delta_t tensor(0.6610, dtype=torch.float64)
14 gae_duplicate tensor(1.5805, dtype=torch.float64) tensor(-3.2847, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6417, dtype=torch.float64) delta_t tensor(0.5402, dtype=torch.float64)
13 gae_duplicate tensor(1.8046, dtype=torch.float64) tensor(-3.7504, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3774, dtype=torch.float64) delta_t tensor(0.2150, dtype=torch.float64)
12 gae_duplicate tensor(1.6587, dtype=torch.float64) tensor(-3.4471, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9071, dtype=torch.float64) delta_t tensor(0.3691, dtype=torch.float64)
11 gae_duplicate tensor(1.6960, dtype=torch.float64) tensor(-3.5287, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8419, dtype=torch.float64) delta_t tensor(0.6447, dtype=torch.float64)
10 gae_duplicate tensor(2.0015, dtype=torch.float64) tensor(-4.1597, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5468, dtype=torch.float64) delta_t tensor(-0.3893, dtype=torch.float64)
9 gae_duplicate tensor(1.2120, dtype=torch.float64) tensor(-2.5217, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.4732, dtype=torch.float64) delta_t tensor(-1.9376, dtype=torch.float64)
8 gae_duplicate tensor(-0.9680, dtype=torch.float64) tensor(2.0140, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2449, dtype=torch.float64) delta_t tensor(0.3147, dtype=torch.float64)
7 gae_duplicate tensor(-0.4597, dtype=torch.float64) tensor(0.9565, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5487, dtype=torch.float64) delta_t tensor(-0.8659, dtype=torch.float64)
6 gae_duplicate tensor(-1.2337, dtype=torch.float64) tensor(2.5668, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8798, dtype=torch.float64) delta_t tensor(-0.6757, dtype=torch.float64)
5 gae_duplicate tensor(-1.6626, dtype=torch.float64) tensor(3.3293, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4179, dtype=torch.float64) delta_t tensor(-0.4328, dtype=torch.float64)
4 gae_duplicate tensor(-1.7629, dtype=torch.float64) tensor(3.6723, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8720, dtype=torch.float64) delta_t tensor(-1.8408, dtype=torch.float64)
3 gae_duplicate tensor(-3.2511, dtype=torch.float64) tensor(6.7486, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0166, dtype=torch.float64) delta_t tensor(-1.1218, dtype=torch.float64)
2 gae_duplicate tensor(-3.7227, dtype=torch.float64) tensor(7.7547, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-19.722448348999023
value loss:77.60858154296875
entropies:37.42670440673828
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.6354310512542725 seconds
19 rew tensor(0.7758, dtype=torch.float64) delta_t tensor(-0.2665, dtype=torch.float64)
19 gae_duplicate tensor(-0.2665, dtype=torch.float64) tensor(0.5538, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8430, dtype=torch.float64) delta_t tensor(0.5141, dtype=torch.float64)
18 gae_duplicate tensor(0.3009, dtype=torch.float64) tensor(-0.6247, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6443, dtype=torch.float64) delta_t tensor(0.4166, dtype=torch.float64)
17 gae_duplicate tensor(0.6573, dtype=torch.float64) tensor(-1.3676, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5118, dtype=torch.float64) delta_t tensor(0.2736, dtype=torch.float64)
16 gae_duplicate tensor(0.7995, dtype=torch.float64) tensor(-1.6597, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0469, dtype=torch.float64) delta_t tensor(-0.0281, dtype=torch.float64)
15 gae_duplicate tensor(0.6114, dtype=torch.float64) tensor(-1.2721, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.6838, dtype=torch.float64) delta_t tensor(-0.5928, dtype=torch.float64)
14 gae_duplicate tensor(-0.1036, dtype=torch.float64) tensor(0.2152, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8431, dtype=torch.float64) delta_t tensor(0.7331, dtype=torch.float64)
13 gae_duplicate tensor(0.6502, dtype=torch.float64) tensor(-1.3543, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9103, dtype=torch.float64) delta_t tensor(0.7740, dtype=torch.float64)
12 gae_duplicate tensor(1.2942, dtype=torch.float64) tensor(-2.6927, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9112, dtype=torch.float64) delta_t tensor(0.5687, dtype=torch.float64)
11 gae_duplicate tensor(1.6040, dtype=torch.float64) tensor(-3.3337, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8458, dtype=torch.float64) delta_t tensor(0.7291, dtype=torch.float64)
10 gae_duplicate tensor(2.0123, dtype=torch.float64) tensor(-4.1868, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6474, dtype=torch.float64) delta_t tensor(0.1074, dtype=torch.float64)
9 gae_duplicate tensor(1.7173, dtype=torch.float64) tensor(-3.5730, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0820, dtype=torch.float64) delta_t tensor(-0.3090, dtype=torch.float64)
8 gae_duplicate tensor(1.0648, dtype=torch.float64) tensor(-2.2154, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8778, dtype=torch.float64) delta_t tensor(-1.0117, dtype=torch.float64)
7 gae_duplicate tensor(-0.1598, dtype=torch.float64) tensor(0.3321, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1440, dtype=torch.float64) delta_t tensor(-1.2525, dtype=torch.float64)
6 gae_duplicate tensor(-1.3804, dtype=torch.float64) tensor(2.8689, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6760, dtype=torch.float64) delta_t tensor(-1.4689, dtype=torch.float64)
5 gae_duplicate tensor(-2.5732, dtype=torch.float64) tensor(5.3480, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8788, dtype=torch.float64) delta_t tensor(-1.8392, dtype=torch.float64)
4 gae_duplicate tensor(-3.8978, dtype=torch.float64) tensor(8.1185, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4874, dtype=torch.float64) delta_t tensor(-0.3896, dtype=torch.float64)
3 gae_duplicate tensor(-3.5078, dtype=torch.float64) tensor(7.2983, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5542, dtype=torch.float64) delta_t tensor(-0.7817, dtype=torch.float64)
2 gae_duplicate tensor(-3.5880, dtype=torch.float64) tensor(7.4567, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-60.59156036376953
value loss:95.01691436767578
entropies:37.42991256713867
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.9072)
ToM Target loss= tensor(304.3221)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.420695781707764 seconds
19 rew tensor(-1.4871, dtype=torch.float64) delta_t tensor(-2.3885, dtype=torch.float64)
19 gae_duplicate tensor(-2.3885, dtype=torch.float64) tensor(4.9643, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8464, dtype=torch.float64) delta_t tensor(0.7024, dtype=torch.float64)
18 gae_duplicate tensor(-1.2084, dtype=torch.float64) tensor(2.5116, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9139, dtype=torch.float64) delta_t tensor(0.7409, dtype=torch.float64)
17 gae_duplicate tensor(-0.2259, dtype=torch.float64) tensor(0.4699, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8481, dtype=torch.float64) delta_t tensor(0.6736, dtype=torch.float64)
16 gae_duplicate tensor(0.4929, dtype=torch.float64) tensor(-1.0255, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7155, dtype=torch.float64) delta_t tensor(0.6759, dtype=torch.float64)
15 gae_duplicate tensor(1.0703, dtype=torch.float64) tensor(-2.2290, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6494, dtype=torch.float64) delta_t tensor(-0.0313, dtype=torch.float64)
14 gae_duplicate tensor(0.8249, dtype=torch.float64) tensor(-1.7162, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4498, dtype=torch.float64) delta_t tensor(0.3359, dtype=torch.float64)
13 gae_duplicate tensor(0.9958, dtype=torch.float64) tensor(-2.0719, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9167, dtype=torch.float64) delta_t tensor(0.6912, dtype=torch.float64)
12 gae_duplicate tensor(1.4879, dtype=torch.float64) tensor(-3.0955, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9176, dtype=torch.float64) delta_t tensor(0.6921, dtype=torch.float64)
11 gae_duplicate tensor(1.8824, dtype=torch.float64) tensor(-3.9163, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1855, dtype=torch.float64) delta_t tensor(-0.0592, dtype=torch.float64)
10 gae_duplicate tensor(1.4467, dtype=torch.float64) tensor(-3.0069, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0142, dtype=torch.float64) delta_t tensor(-0.1569, dtype=torch.float64)
9 gae_duplicate tensor(1.0004, dtype=torch.float64) tensor(-2.0793, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6799, dtype=torch.float64) delta_t tensor(-1.0474, dtype=torch.float64)
8 gae_duplicate tensor(-0.2471, dtype=torch.float64) tensor(0.5130, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8801, dtype=torch.float64) delta_t tensor(-1.1240, dtype=torch.float64)
7 gae_duplicate tensor(-1.3216, dtype=torch.float64) tensor(2.7469, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2802, dtype=torch.float64) delta_t tensor(-0.6592, dtype=torch.float64)
6 gae_duplicate tensor(-1.7166, dtype=torch.float64) tensor(3.5677, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4152, dtype=torch.float64) delta_t tensor(-1.3706, dtype=torch.float64)
5 gae_duplicate tensor(-2.7438, dtype=torch.float64) tensor(5.7085, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6173, dtype=torch.float64) delta_t tensor(-1.5656, dtype=torch.float64)
4 gae_duplicate tensor(-3.7607, dtype=torch.float64) tensor(7.8160, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3540, dtype=torch.float64) delta_t tensor(-0.3875, dtype=torch.float64)
3 gae_duplicate tensor(-3.3960, dtype=torch.float64) tensor(7.0582, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4209, dtype=torch.float64) delta_t tensor(-0.5591, dtype=torch.float64)
2 gae_duplicate tensor(-3.2759, dtype=torch.float64) tensor(6.8018, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-139.2262420654297
value loss:101.72636413574219
entropies:37.42991256713867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.674643039703369 seconds
19 rew tensor(0.9149, dtype=torch.float64) delta_t tensor(0.3797, dtype=torch.float64)
19 gae_duplicate tensor(0.3797, dtype=torch.float64) tensor(-0.7899, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9158, dtype=torch.float64) delta_t tensor(0.8134, dtype=torch.float64)
18 gae_duplicate tensor(1.1172, dtype=torch.float64) tensor(-2.3198, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9167, dtype=torch.float64) delta_t tensor(0.5622, dtype=torch.float64)
17 gae_duplicate tensor(1.4559, dtype=torch.float64) tensor(-3.0261, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9176, dtype=torch.float64) delta_t tensor(0.7986, dtype=torch.float64)
16 gae_duplicate tensor(1.9633, dtype=torch.float64) tensor(-4.0807, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9185, dtype=torch.float64) delta_t tensor(0.8002, dtype=torch.float64)
15 gae_duplicate tensor(2.3709, dtype=torch.float64) tensor(-4.9325, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9194, dtype=torch.float64) delta_t tensor(0.2092, dtype=torch.float64)
14 gae_duplicate tensor(2.1059, dtype=torch.float64) tensor(-4.3730, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9203, dtype=torch.float64) delta_t tensor(0.6415, dtype=torch.float64)
13 gae_duplicate tensor(2.3262, dtype=torch.float64) tensor(-4.8396, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9212, dtype=torch.float64) delta_t tensor(1.7576, dtype=torch.float64)
12 gae_duplicate tensor(3.6186, dtype=torch.float64) tensor(-7.5282, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7214, dtype=torch.float64) delta_t tensor(0.5507, dtype=torch.float64)
11 gae_duplicate tensor(3.4455, dtype=torch.float64) tensor(-7.0730, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4544, dtype=torch.float64) delta_t tensor(0.3598, dtype=torch.float64)
10 gae_duplicate tensor(3.1162, dtype=torch.float64) tensor(-6.5175, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0803, dtype=torch.float64) delta_t tensor(-0.2129, dtype=torch.float64)
9 gae_duplicate tensor(2.2801, dtype=torch.float64) tensor(-4.7435, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2809, dtype=torch.float64) delta_t tensor(-0.4554, dtype=torch.float64)
8 gae_duplicate tensor(1.3686, dtype=torch.float64) tensor(-2.8419, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9491, dtype=torch.float64) delta_t tensor(-1.2885, dtype=torch.float64)
7 gae_duplicate tensor(-0.1936, dtype=torch.float64) tensor(0.4024, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0837, dtype=torch.float64) delta_t tensor(-0.8755, dtype=torch.float64)
6 gae_duplicate tensor(-1.0304, dtype=torch.float64) tensor(2.1456, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3501, dtype=torch.float64) delta_t tensor(-0.1410, dtype=torch.float64)
5 gae_duplicate tensor(-0.9653, dtype=torch.float64) tensor(2.0082, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9513, dtype=torch.float64) delta_t tensor(-1.0067, dtype=torch.float64)
4 gae_duplicate tensor(-1.7789, dtype=torch.float64) tensor(3.6939, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3529, dtype=torch.float64) delta_t tensor(-1.4878, dtype=torch.float64)
3 gae_duplicate tensor(-2.9110, dtype=torch.float64) tensor(6.0447, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2193, dtype=torch.float64) delta_t tensor(-0.4149, dtype=torch.float64)
2 gae_duplicate tensor(-2.7437, dtype=torch.float64) tensor(5.7078, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:197.25564575195312
value loss:128.66905212402344
entropies:37.429466247558594
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5850889682769775 seconds
19 rew tensor(0.9154, dtype=torch.float64) delta_t tensor(-0.3638, dtype=torch.float64)
19 gae_duplicate tensor(-0.3638, dtype=torch.float64) tensor(0.7568, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9163, dtype=torch.float64) delta_t tensor(1.4392, dtype=torch.float64)
18 gae_duplicate tensor(1.1482, dtype=torch.float64) tensor(-2.3887, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9172, dtype=torch.float64) delta_t tensor(0.7793, dtype=torch.float64)
17 gae_duplicate tensor(1.6978, dtype=torch.float64) tensor(-3.5290, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9181, dtype=torch.float64) delta_t tensor(0.8407, dtype=torch.float64)
16 gae_duplicate tensor(2.1990, dtype=torch.float64) tensor(-4.5747, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9189, dtype=torch.float64) delta_t tensor(0.7243, dtype=torch.float64)
15 gae_duplicate tensor(2.4835, dtype=torch.float64) tensor(-5.1620, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9198, dtype=torch.float64) delta_t tensor(0.8700, dtype=torch.float64)
14 gae_duplicate tensor(2.8568, dtype=torch.float64) tensor(-5.9381, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9207, dtype=torch.float64) delta_t tensor(0.0764, dtype=torch.float64)
13 gae_duplicate tensor(2.3619, dtype=torch.float64) tensor(-4.9091, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9216, dtype=torch.float64) delta_t tensor(0.6019, dtype=torch.float64)
12 gae_duplicate tensor(2.4914, dtype=torch.float64) tensor(-5.1830, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9225, dtype=torch.float64) delta_t tensor(0.6845, dtype=torch.float64)
11 gae_duplicate tensor(2.6776, dtype=torch.float64) tensor(-5.5653, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5213, dtype=torch.float64) delta_t tensor(1.2794, dtype=torch.float64)
10 gae_duplicate tensor(3.4214, dtype=torch.float64) tensor(-7.1115, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3206, dtype=torch.float64) delta_t tensor(-0.0741, dtype=torch.float64)
9 gae_duplicate tensor(2.6631, dtype=torch.float64) tensor(-5.5353, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6168, dtype=torch.float64) delta_t tensor(-0.3326, dtype=torch.float64)
8 gae_duplicate tensor(1.7979, dtype=torch.float64) tensor(-3.7337, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0858, dtype=torch.float64) delta_t tensor(-1.2497, dtype=torch.float64)
7 gae_duplicate tensor(0.1887, dtype=torch.float64) tensor(-0.3921, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2879, dtype=torch.float64) delta_t tensor(-1.1684, dtype=torch.float64)
6 gae_duplicate tensor(-1.0175, dtype=torch.float64) tensor(2.1168, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2228, dtype=torch.float64) delta_t tensor(-1.2337, dtype=torch.float64)
5 gae_duplicate tensor(-2.0477, dtype=torch.float64) tensor(4.2638, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5544, dtype=torch.float64) delta_t tensor(-0.5186, dtype=torch.float64)
4 gae_duplicate tensor(-2.1568, dtype=torch.float64) tensor(4.4789, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7603, dtype=torch.float64) delta_t tensor(-1.8398, dtype=torch.float64)
3 gae_duplicate tensor(-3.5653, dtype=torch.float64) tensor(7.4107, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4903, dtype=torch.float64) delta_t tensor(-0.6815, dtype=torch.float64)
2 gae_duplicate tensor(-3.5337, dtype=torch.float64) tensor(7.3448, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:164.78164672851562
value loss:149.39724731445312
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.553123950958252 seconds
19 rew tensor(0.5193, dtype=torch.float64) delta_t tensor(-0.7182, dtype=torch.float64)
19 gae_duplicate tensor(-0.7182, dtype=torch.float64) tensor(1.4928, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.1185, dtype=torch.float64) delta_t tensor(-0.2319, dtype=torch.float64)
18 gae_duplicate tensor(-0.8065, dtype=torch.float64) tensor(1.6764, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.6165, dtype=torch.float64) delta_t tensor(-0.9410, dtype=torch.float64)
17 gae_duplicate tensor(-1.5862, dtype=torch.float64) tensor(3.2970, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-2.0197, dtype=torch.float64) delta_t tensor(-1.7310, dtype=torch.float64)
16 gae_duplicate tensor(-3.0000, dtype=torch.float64) tensor(6.2462, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8519, dtype=torch.float64) delta_t tensor(0.6730, dtype=torch.float64)
15 gae_duplicate tensor(-1.7270, dtype=torch.float64) tensor(3.5926, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9196, dtype=torch.float64) delta_t tensor(0.7512, dtype=torch.float64)
14 gae_duplicate tensor(-0.6304, dtype=torch.float64) tensor(1.3103, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9204, dtype=torch.float64) delta_t tensor(0.7521, dtype=torch.float64)
13 gae_duplicate tensor(0.2478, dtype=torch.float64) tensor(-0.5145, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9213, dtype=torch.float64) delta_t tensor(0.7529, dtype=torch.float64)
12 gae_duplicate tensor(0.9511, dtype=torch.float64) tensor(-1.9787, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9222, dtype=torch.float64) delta_t tensor(0.2191, dtype=torch.float64)
11 gae_duplicate tensor(0.9800, dtype=torch.float64) tensor(-2.0371, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7893, dtype=torch.float64) delta_t tensor(0.4771, dtype=torch.float64)
10 gae_duplicate tensor(1.2611, dtype=torch.float64) tensor(-2.6236, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4804, dtype=torch.float64) delta_t tensor(-0.7576, dtype=torch.float64)
9 gae_duplicate tensor(0.2513, dtype=torch.float64) tensor(-0.5223, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5475, dtype=torch.float64) delta_t tensor(-0.8173, dtype=torch.float64)
8 gae_duplicate tensor(-0.6163, dtype=torch.float64) tensor(1.2809, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4164, dtype=torch.float64) delta_t tensor(-1.6827, dtype=torch.float64)
7 gae_duplicate tensor(-2.1757, dtype=torch.float64) tensor(4.5223, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1512, dtype=torch.float64) delta_t tensor(-1.2186, dtype=torch.float64)
6 gae_duplicate tensor(-2.9592, dtype=torch.float64) tensor(6.1508, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9549, dtype=torch.float64) delta_t tensor(-1.1903, dtype=torch.float64)
5 gae_duplicate tensor(-3.5576, dtype=torch.float64) tensor(7.3948, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5624, dtype=torch.float64) delta_t tensor(-2.8942, dtype=torch.float64)
4 gae_duplicate tensor(-5.7403, dtype=torch.float64) tensor(11.9518, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5580, dtype=torch.float64) delta_t tensor(-0.3290, dtype=torch.float64)
3 gae_duplicate tensor(-4.9212, dtype=torch.float64) tensor(10.2203, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6926, dtype=torch.float64) delta_t tensor(-0.6973, dtype=torch.float64)
2 gae_duplicate tensor(-4.6343, dtype=torch.float64) tensor(9.6406, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-367.7274475097656
value loss:187.2216796875
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.425731658935547 seconds
19 rew tensor(-1.1588, dtype=torch.float64) delta_t tensor(-1.6902, dtype=torch.float64)
19 gae_duplicate tensor(-1.6902, dtype=torch.float64) tensor(3.5133, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8539, dtype=torch.float64) delta_t tensor(0.7259, dtype=torch.float64)
18 gae_duplicate tensor(-0.6262, dtype=torch.float64) tensor(1.3028, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9218, dtype=torch.float64) delta_t tensor(0.8181, dtype=torch.float64)
17 gae_duplicate tensor(0.3171, dtype=torch.float64) tensor(-0.6590, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8555, dtype=torch.float64) delta_t tensor(0.7218, dtype=torch.float64)
16 gae_duplicate tensor(0.9754, dtype=torch.float64) tensor(-2.0291, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8563, dtype=torch.float64) delta_t tensor(0.7545, dtype=torch.float64)
15 gae_duplicate tensor(1.5348, dtype=torch.float64) tensor(-3.1903, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8570, dtype=torch.float64) delta_t tensor(-0.1450, dtype=torch.float64)
14 gae_duplicate tensor(1.0829, dtype=torch.float64) tensor(-2.2527, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7236, dtype=torch.float64) delta_t tensor(0.4584, dtype=torch.float64)
13 gae_duplicate tensor(1.3247, dtype=torch.float64) tensor(-2.7536, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6571, dtype=torch.float64) delta_t tensor(0.3183, dtype=torch.float64)
12 gae_duplicate tensor(1.3781, dtype=torch.float64) tensor(-2.8667, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9258, dtype=torch.float64) delta_t tensor(0.6302, dtype=torch.float64)
11 gae_duplicate tensor(1.7326, dtype=torch.float64) tensor(-3.6072, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7925, dtype=torch.float64) delta_t tensor(0.5240, dtype=torch.float64)
10 gae_duplicate tensor(1.9101, dtype=torch.float64) tensor(-3.9736, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6591, dtype=torch.float64) delta_t tensor(1.3326, dtype=torch.float64)
9 gae_duplicate tensor(2.8607, dtype=torch.float64) tensor(-5.9413, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1234, dtype=torch.float64) delta_t tensor(0.1211, dtype=torch.float64)
8 gae_duplicate tensor(2.4096, dtype=torch.float64) tensor(-5.0127, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5464, dtype=torch.float64) delta_t tensor(-0.6422, dtype=torch.float64)
7 gae_duplicate tensor(1.2855, dtype=torch.float64) tensor(-2.6719, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0155, dtype=torch.float64) delta_t tensor(-1.0894, dtype=torch.float64)
6 gae_duplicate tensor(-0.0610, dtype=torch.float64) tensor(0.1269, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3514, dtype=torch.float64) delta_t tensor(-1.0145, dtype=torch.float64)
5 gae_duplicate tensor(-1.0633, dtype=torch.float64) tensor(2.2119, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4154, dtype=torch.float64) delta_t tensor(-0.5872, dtype=torch.float64)
4 gae_duplicate tensor(-1.4379, dtype=torch.float64) tensor(2.9911, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3487, dtype=torch.float64) delta_t tensor(-0.3608, dtype=torch.float64)
3 gae_duplicate tensor(-1.5111, dtype=torch.float64) tensor(3.1436, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0852, dtype=torch.float64) delta_t tensor(-0.9853, dtype=torch.float64)
2 gae_duplicate tensor(-2.1941, dtype=torch.float64) tensor(4.5571, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:101.54609680175781
value loss:66.11315155029297
entropies:37.429935455322266
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.8154)
ToM Target loss= tensor(304.8892)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.405452013015747 seconds
19 rew tensor(0.9152, dtype=torch.float64) delta_t tensor(-0.4704, dtype=torch.float64)
19 gae_duplicate tensor(-0.4704, dtype=torch.float64) tensor(0.9779, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9160, dtype=torch.float64) delta_t tensor(0.5620, dtype=torch.float64)
18 gae_duplicate tensor(0.1856, dtype=torch.float64) tensor(-0.3862, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9168, dtype=torch.float64) delta_t tensor(0.6893, dtype=torch.float64)
17 gae_duplicate tensor(0.8378, dtype=torch.float64) tensor(-1.7428, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9177, dtype=torch.float64) delta_t tensor(0.7906, dtype=torch.float64)
16 gae_duplicate tensor(1.4608, dtype=torch.float64) tensor(-3.0389, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9185, dtype=torch.float64) delta_t tensor(1.2132, dtype=torch.float64)
15 gae_duplicate tensor(2.3819, dtype=torch.float64) tensor(-4.9510, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9193, dtype=torch.float64) delta_t tensor(0.7791, dtype=torch.float64)
14 gae_duplicate tensor(2.6845, dtype=torch.float64) tensor(-5.5845, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9202, dtype=torch.float64) delta_t tensor(0.7799, dtype=torch.float64)
13 gae_duplicate tensor(2.9275, dtype=torch.float64) tensor(-6.0804, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9210, dtype=torch.float64) delta_t tensor(0.5736, dtype=torch.float64)
12 gae_duplicate tensor(2.9156, dtype=torch.float64) tensor(-6.0604, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9218, dtype=torch.float64) delta_t tensor(0.7930, dtype=torch.float64)
11 gae_duplicate tensor(3.1255, dtype=torch.float64) tensor(-6.4968, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9227, dtype=torch.float64) delta_t tensor(0.1324, dtype=torch.float64)
10 gae_duplicate tensor(2.6328, dtype=torch.float64) tensor(-5.4768, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9235, dtype=torch.float64) delta_t tensor(0.7845, dtype=torch.float64)
9 gae_duplicate tensor(2.8907, dtype=torch.float64) tensor(-6.0134, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0741, dtype=torch.float64) delta_t tensor(-0.3283, dtype=torch.float64)
8 gae_duplicate tensor(1.9843, dtype=torch.float64) tensor(-4.1214, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9390, dtype=torch.float64) delta_t tensor(-1.0951, dtype=torch.float64)
7 gae_duplicate tensor(0.4923, dtype=torch.float64) tensor(-1.0233, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4056, dtype=torch.float64) delta_t tensor(-1.4075, dtype=torch.float64)
6 gae_duplicate tensor(-1.0137, dtype=torch.float64) tensor(2.1071, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0083, dtype=torch.float64) delta_t tensor(-0.3166, dtype=torch.float64)
5 gae_duplicate tensor(-1.1276, dtype=torch.float64) tensor(2.3474, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.5371, dtype=torch.float64) delta_t tensor(-4.8322, dtype=torch.float64)
4 gae_duplicate tensor(-5.7342, dtype=torch.float64) tensor(11.9380, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4189, dtype=torch.float64) delta_t tensor(-0.1439, dtype=torch.float64)
3 gae_duplicate tensor(-4.7313, dtype=torch.float64) tensor(9.8269, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5536, dtype=torch.float64) delta_t tensor(-0.5384, dtype=torch.float64)
2 gae_duplicate tensor(-4.3234, dtype=torch.float64) tensor(9.0008, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:87.54518127441406
value loss:207.80332946777344
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.2265660762786865 seconds
19 rew tensor(0.5207, dtype=torch.float64) delta_t tensor(-0.9194, dtype=torch.float64)
19 gae_duplicate tensor(-0.9194, dtype=torch.float64) tensor(1.9112, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.1875, dtype=torch.float64) delta_t tensor(0.1897, dtype=torch.float64)
18 gae_duplicate tensor(-0.5458, dtype=torch.float64) tensor(1.1337, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.5456, dtype=torch.float64) delta_t tensor(-0.4587, dtype=torch.float64)
17 gae_duplicate tensor(-0.8953, dtype=torch.float64) tensor(1.8625, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7868, dtype=torch.float64) delta_t tensor(0.5044, dtype=torch.float64)
16 gae_duplicate tensor(-0.2119, dtype=torch.float64) tensor(0.4407, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7874, dtype=torch.float64) delta_t tensor(0.6560, dtype=torch.float64)
15 gae_duplicate tensor(0.4865, dtype=torch.float64) tensor(-1.0113, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7880, dtype=torch.float64) delta_t tensor(0.6493, dtype=torch.float64)
14 gae_duplicate tensor(1.0385, dtype=torch.float64) tensor(-2.1587, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6554, dtype=torch.float64) delta_t tensor(0.5000, dtype=torch.float64)
13 gae_duplicate tensor(1.3308, dtype=torch.float64) tensor(-2.7683, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7224, dtype=torch.float64) delta_t tensor(-0.0521, dtype=torch.float64)
12 gae_duplicate tensor(1.0125, dtype=torch.float64) tensor(-2.1030, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8561, dtype=torch.float64) delta_t tensor(0.5868, dtype=torch.float64)
11 gae_duplicate tensor(1.3968, dtype=torch.float64) tensor(-2.9057, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8568, dtype=torch.float64) delta_t tensor(0.5836, dtype=torch.float64)
10 gae_duplicate tensor(1.7011, dtype=torch.float64) tensor(-3.5359, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4734, dtype=torch.float64) delta_t tensor(-0.7476, dtype=torch.float64)
9 gae_duplicate tensor(0.6133, dtype=torch.float64) tensor(-1.2748, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5402, dtype=torch.float64) delta_t tensor(-0.8989, dtype=torch.float64)
8 gae_duplicate tensor(-0.4083, dtype=torch.float64) tensor(0.8487, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8065, dtype=torch.float64) delta_t tensor(-0.8414, dtype=torch.float64)
7 gae_duplicate tensor(-1.1680, dtype=torch.float64) tensor(2.4297, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.8710, dtype=torch.float64) delta_t tensor(-2.0998, dtype=torch.float64)
6 gae_duplicate tensor(-3.0342, dtype=torch.float64) tensor(6.3167, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1428, dtype=torch.float64) delta_t tensor(-0.5172, dtype=torch.float64)
5 gae_duplicate tensor(-2.9445, dtype=torch.float64) tensor(6.1160, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7433, dtype=torch.float64) delta_t tensor(-1.6428, dtype=torch.float64)
4 gae_duplicate tensor(-3.9984, dtype=torch.float64) tensor(8.3241, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8137, dtype=torch.float64) delta_t tensor(-0.8781, dtype=torch.float64)
3 gae_duplicate tensor(-4.0768, dtype=torch.float64) tensor(8.4676, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8810, dtype=torch.float64) delta_t tensor(-0.6269, dtype=torch.float64)
2 gae_duplicate tensor(-3.8883, dtype=torch.float64) tensor(8.0825, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-182.17649841308594
value loss:117.68463134765625
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.43939208984375 seconds
19 rew tensor(0.9182, dtype=torch.float64) delta_t tensor(-0.0864, dtype=torch.float64)
19 gae_duplicate tensor(-0.0864, dtype=torch.float64) tensor(0.1798, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9190, dtype=torch.float64) delta_t tensor(0.1965, dtype=torch.float64)
18 gae_duplicate tensor(0.1273, dtype=torch.float64) tensor(-0.2649, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9198, dtype=torch.float64) delta_t tensor(0.8954, dtype=torch.float64)
17 gae_duplicate tensor(0.9972, dtype=torch.float64) tensor(-2.0744, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9206, dtype=torch.float64) delta_t tensor(0.7948, dtype=torch.float64)
16 gae_duplicate tensor(1.5926, dtype=torch.float64) tensor(-3.3079, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9214, dtype=torch.float64) delta_t tensor(0.8677, dtype=torch.float64)
15 gae_duplicate tensor(2.1417, dtype=torch.float64) tensor(-4.4486, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9222, dtype=torch.float64) delta_t tensor(1.1891, dtype=torch.float64)
14 gae_duplicate tensor(2.9025, dtype=torch.float64) tensor(-6.0424, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9230, dtype=torch.float64) delta_t tensor(0.7641, dtype=torch.float64)
13 gae_duplicate tensor(3.0861, dtype=torch.float64) tensor(-6.4149, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9238, dtype=torch.float64) delta_t tensor(0.5344, dtype=torch.float64)
12 gae_duplicate tensor(3.0032, dtype=torch.float64) tensor(-6.2475, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9246, dtype=torch.float64) delta_t tensor(0.4607, dtype=torch.float64)
11 gae_duplicate tensor(2.8633, dtype=torch.float64) tensor(-5.9564, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9255, dtype=torch.float64) delta_t tensor(1.7605, dtype=torch.float64)
10 gae_duplicate tensor(4.0512, dtype=torch.float64) tensor(-8.4273, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9263, dtype=torch.float64) delta_t tensor(0.4287, dtype=torch.float64)
9 gae_duplicate tensor(3.6696, dtype=torch.float64) tensor(-7.6337, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4029, dtype=torch.float64) delta_t tensor(-1.1261, dtype=torch.float64)
8 gae_duplicate tensor(1.8096, dtype=torch.float64) tensor(-3.7615, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4001, dtype=torch.float64) delta_t tensor(-0.9365, dtype=torch.float64)
7 gae_duplicate tensor(0.5112, dtype=torch.float64) tensor(-1.0625, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4046, dtype=torch.float64) delta_t tensor(-0.2401, dtype=torch.float64)
6 gae_duplicate tensor(0.1689, dtype=torch.float64) tensor(-0.3513, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8673, dtype=torch.float64) delta_t tensor(-2.0413, dtype=torch.float64)
5 gae_duplicate tensor(-1.9063, dtype=torch.float64) tensor(3.9624, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2706, dtype=torch.float64) delta_t tensor(-2.4446, dtype=torch.float64)
4 gae_duplicate tensor(-3.9696, dtype=torch.float64) tensor(8.2452, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2767, dtype=torch.float64) delta_t tensor(0.3625, dtype=torch.float64)
3 gae_duplicate tensor(-2.8132, dtype=torch.float64) tensor(5.8477, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-2.0766, dtype=torch.float64) delta_t tensor(-2.1869, dtype=torch.float64)
2 gae_duplicate tensor(-4.4375, dtype=torch.float64) tensor(9.2243, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:170.08106994628906
value loss:185.621337890625
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.438224792480469 seconds
19 rew tensor(0.3218, dtype=torch.float64) delta_t tensor(-1.2178, dtype=torch.float64)
19 gae_duplicate tensor(-1.2178, dtype=torch.float64) tensor(2.5296, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.2769, dtype=torch.float64) delta_t tensor(-0.6723, dtype=torch.float64)
18 gae_duplicate tensor(-1.6465, dtype=torch.float64) tensor(3.4226, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-1.4743, dtype=torch.float64) delta_t tensor(-0.8918, dtype=torch.float64)
17 gae_duplicate tensor(-2.2091, dtype=torch.float64) tensor(4.5953, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9193, dtype=torch.float64) delta_t tensor(0.7755, dtype=torch.float64)
16 gae_duplicate tensor(-0.9918, dtype=torch.float64) tensor(2.0615, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9201, dtype=torch.float64) delta_t tensor(0.7763, dtype=torch.float64)
15 gae_duplicate tensor(-0.0171, dtype=torch.float64) tensor(0.0356, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9209, dtype=torch.float64) delta_t tensor(0.7295, dtype=torch.float64)
14 gae_duplicate tensor(0.7158, dtype=torch.float64) tensor(-1.4869, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8552, dtype=torch.float64) delta_t tensor(0.7050, dtype=torch.float64)
13 gae_duplicate tensor(1.2777, dtype=torch.float64) tensor(-2.6579, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9224, dtype=torch.float64) delta_t tensor(-0.0889, dtype=torch.float64)
12 gae_duplicate tensor(0.9333, dtype=torch.float64) tensor(-1.9400, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8567, dtype=torch.float64) delta_t tensor(0.4824, dtype=torch.float64)
11 gae_duplicate tensor(1.2290, dtype=torch.float64) tensor(-2.5584, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8574, dtype=torch.float64) delta_t tensor(0.5490, dtype=torch.float64)
10 gae_duplicate tensor(1.5322, dtype=torch.float64) tensor(-3.1873, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0600, dtype=torch.float64) delta_t tensor(-0.2622, dtype=torch.float64)
9 gae_duplicate tensor(0.9635, dtype=torch.float64) tensor(-2.0029, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8042, dtype=torch.float64) delta_t tensor(-1.0753, dtype=torch.float64)
8 gae_duplicate tensor(-0.3044, dtype=torch.float64) tensor(0.6328, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9377, dtype=torch.float64) delta_t tensor(-1.0029, dtype=torch.float64)
7 gae_duplicate tensor(-1.2464, dtype=torch.float64) tensor(2.5909, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0081, dtype=torch.float64) delta_t tensor(-0.2425, dtype=torch.float64)
6 gae_duplicate tensor(-1.2396, dtype=torch.float64) tensor(2.5787, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8681, dtype=torch.float64) delta_t tensor(-1.1374, dtype=torch.float64)
5 gae_duplicate tensor(-2.1291, dtype=torch.float64) tensor(4.4289, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4041, dtype=torch.float64) delta_t tensor(-2.2597, dtype=torch.float64)
4 gae_duplicate tensor(-3.9629, dtype=torch.float64) tensor(8.2436, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4121, dtype=torch.float64) delta_t tensor(-0.1029, dtype=torch.float64)
3 gae_duplicate tensor(-3.2733, dtype=torch.float64) tensor(6.8141, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2791, dtype=torch.float64) delta_t tensor(-0.5167, dtype=torch.float64)
2 gae_duplicate tensor(-3.1353, dtype=torch.float64) tensor(6.5125, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-184.80128479003906
value loss:92.73838806152344
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.491575002670288 seconds
19 rew tensor(0.9232, dtype=torch.float64) delta_t tensor(-0.6793, dtype=torch.float64)
19 gae_duplicate tensor(-0.6793, dtype=torch.float64) tensor(1.4130, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9240, dtype=torch.float64) delta_t tensor(0.5572, dtype=torch.float64)
18 gae_duplicate tensor(0.0137, dtype=torch.float64) tensor(-0.0286, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9248, dtype=torch.float64) delta_t tensor(0.6223, dtype=torch.float64)
17 gae_duplicate tensor(0.6333, dtype=torch.float64) tensor(-1.3156, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9255, dtype=torch.float64) delta_t tensor(1.3824, dtype=torch.float64)
16 gae_duplicate tensor(1.8891, dtype=torch.float64) tensor(-3.9324, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9263, dtype=torch.float64) delta_t tensor(1.2127, dtype=torch.float64)
15 gae_duplicate tensor(2.7240, dtype=torch.float64) tensor(-5.6624, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9271, dtype=torch.float64) delta_t tensor(0.8431, dtype=torch.float64)
14 gae_duplicate tensor(3.0223, dtype=torch.float64) tensor(-6.2913, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6606, dtype=torch.float64) delta_t tensor(0.1747, dtype=torch.float64)
13 gae_duplicate tensor(2.5925, dtype=torch.float64) tensor(-5.3853, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2601, dtype=torch.float64) delta_t tensor(0.2082, dtype=torch.float64)
12 gae_duplicate tensor(2.2822, dtype=torch.float64) tensor(-4.7440, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0598, dtype=torch.float64) delta_t tensor(-0.4641, dtype=torch.float64)
11 gae_duplicate tensor(1.3617, dtype=torch.float64) tensor(-2.8325, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1404, dtype=torch.float64) delta_t tensor(-0.9540, dtype=torch.float64)
10 gae_duplicate tensor(0.1353, dtype=torch.float64) tensor(-0.2817, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3407, dtype=torch.float64) delta_t tensor(0.4681, dtype=torch.float64)
9 gae_duplicate tensor(0.5763, dtype=torch.float64) tensor(-1.1989, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1408, dtype=torch.float64) delta_t tensor(0.2891, dtype=torch.float64)
8 gae_duplicate tensor(0.7502, dtype=torch.float64) tensor(-1.5595, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7409, dtype=torch.float64) delta_t tensor(-0.7150, dtype=torch.float64)
7 gae_duplicate tensor(-0.1149, dtype=torch.float64) tensor(0.2389, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7251, dtype=torch.float64) delta_t tensor(0.6333, dtype=torch.float64)
6 gae_duplicate tensor(0.5414, dtype=torch.float64) tensor(-1.1245, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6739, dtype=torch.float64) delta_t tensor(-0.3316, dtype=torch.float64)
5 gae_duplicate tensor(0.1015, dtype=torch.float64) tensor(-0.2110, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0081, dtype=torch.float64) delta_t tensor(0.0865, dtype=torch.float64)
4 gae_duplicate tensor(0.1677, dtype=torch.float64) tensor(-0.3489, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9405, dtype=torch.float64) delta_t tensor(-0.9080, dtype=torch.float64)
3 gae_duplicate tensor(-0.7739, dtype=torch.float64) tensor(1.6086, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3409, dtype=torch.float64) delta_t tensor(-1.3361, dtype=torch.float64)
2 gae_duplicate tensor(-1.9552, dtype=torch.float64) tensor(4.0643, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:164.42698669433594
value loss:60.673362731933594
entropies:37.429935455322266
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.5464)
ToM Target loss= tensor(304.6615)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.434577226638794 seconds
19 rew tensor(0.9213, dtype=torch.float64) delta_t tensor(-0.5023, dtype=torch.float64)
19 gae_duplicate tensor(-0.5023, dtype=torch.float64) tensor(1.0455, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9221, dtype=torch.float64) delta_t tensor(0.1857, dtype=torch.float64)
18 gae_duplicate tensor(-0.2161, dtype=torch.float64) tensor(0.4495, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9229, dtype=torch.float64) delta_t tensor(0.7383, dtype=torch.float64)
17 gae_duplicate tensor(0.5655, dtype=torch.float64) tensor(-1.1755, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9236, dtype=torch.float64) delta_t tensor(0.7119, dtype=torch.float64)
16 gae_duplicate tensor(1.1643, dtype=torch.float64) tensor(-2.4203, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9244, dtype=torch.float64) delta_t tensor(0.6022, dtype=torch.float64)
15 gae_duplicate tensor(1.5337, dtype=torch.float64) tensor(-3.1902, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9252, dtype=torch.float64) delta_t tensor(0.9810, dtype=torch.float64)
14 gae_duplicate tensor(2.2079, dtype=torch.float64) tensor(-4.5929, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9259, dtype=torch.float64) delta_t tensor(1.1887, dtype=torch.float64)
13 gae_duplicate tensor(2.9550, dtype=torch.float64) tensor(-6.1428, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9267, dtype=torch.float64) delta_t tensor(0.6483, dtype=torch.float64)
12 gae_duplicate tensor(3.0123, dtype=torch.float64) tensor(-6.2661, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9275, dtype=torch.float64) delta_t tensor(-0.0469, dtype=torch.float64)
11 gae_duplicate tensor(2.3629, dtype=torch.float64) tensor(-4.9086, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9283, dtype=torch.float64) delta_t tensor(0.6396, dtype=torch.float64)
10 gae_duplicate tensor(2.5300, dtype=torch.float64) tensor(-5.2628, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4616, dtype=torch.float64) delta_t tensor(-0.0123, dtype=torch.float64)
9 gae_duplicate tensor(2.0116, dtype=torch.float64) tensor(-4.1817, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1281, dtype=torch.float64) delta_t tensor(-0.1249, dtype=torch.float64)
8 gae_duplicate tensor(1.4844, dtype=torch.float64) tensor(-3.0878, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2054, dtype=torch.float64) delta_t tensor(-0.6116, dtype=torch.float64)
7 gae_duplicate tensor(0.5759, dtype=torch.float64) tensor(-1.1980, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0725, dtype=torch.float64) delta_t tensor(-0.0638, dtype=torch.float64)
6 gae_duplicate tensor(0.3970, dtype=torch.float64) tensor(-0.8252, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4733, dtype=torch.float64) delta_t tensor(-0.2122, dtype=torch.float64)
5 gae_duplicate tensor(0.1054, dtype=torch.float64) tensor(-0.2192, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0736, dtype=torch.float64) delta_t tensor(-2.2454, dtype=torch.float64)
4 gae_duplicate tensor(-2.1611, dtype=torch.float64) tensor(4.4847, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8783, dtype=torch.float64) delta_t tensor(-1.7321, dtype=torch.float64)
3 gae_duplicate tensor(-3.4610, dtype=torch.float64) tensor(7.1943, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7485, dtype=torch.float64) delta_t tensor(-1.4063, dtype=torch.float64)
2 gae_duplicate tensor(-4.1751, dtype=torch.float64) tensor(8.6847, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:128.5511016845703
value loss:119.73475646972656
entropies:37.429927825927734
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.540927886962891 seconds
19 rew tensor(0.7880, dtype=torch.float64) delta_t tensor(-0.7605, dtype=torch.float64)
19 gae_duplicate tensor(-0.7605, dtype=torch.float64) tensor(1.5809, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6555, dtype=torch.float64) delta_t tensor(0.2274, dtype=torch.float64)
18 gae_duplicate tensor(-0.3810, dtype=torch.float64) tensor(0.7930, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3897, dtype=torch.float64) delta_t tensor(-0.0377, dtype=torch.float64)
17 gae_duplicate tensor(-0.3426, dtype=torch.float64) tensor(0.7126, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.0092, dtype=torch.float64) delta_t tensor(-0.3844, dtype=torch.float64)
16 gae_duplicate tensor(-0.6584, dtype=torch.float64) tensor(1.3679, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-1.0066, dtype=torch.float64) delta_t tensor(-0.3269, dtype=torch.float64)
15 gae_duplicate tensor(-0.8537, dtype=torch.float64) tensor(1.7757, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9208, dtype=torch.float64) delta_t tensor(0.6229, dtype=torch.float64)
14 gae_duplicate tensor(-0.0601, dtype=torch.float64) tensor(0.1248, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8550, dtype=torch.float64) delta_t tensor(0.6814, dtype=torch.float64)
13 gae_duplicate tensor(0.6333, dtype=torch.float64) tensor(-1.3165, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8557, dtype=torch.float64) delta_t tensor(0.7025, dtype=torch.float64)
12 gae_duplicate tensor(1.2091, dtype=torch.float64) tensor(-2.5135, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9228, dtype=torch.float64) delta_t tensor(0.7079, dtype=torch.float64)
11 gae_duplicate tensor(1.6752, dtype=torch.float64) tensor(-3.4825, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6577, dtype=torch.float64) delta_t tensor(-0.4168, dtype=torch.float64)
10 gae_duplicate tensor(0.9234, dtype=torch.float64) tensor(-1.9219, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2058, dtype=torch.float64) delta_t tensor(-0.4027, dtype=torch.float64)
9 gae_duplicate tensor(0.3360, dtype=torch.float64) tensor(-0.6993, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8701, dtype=torch.float64) delta_t tensor(-1.4020, dtype=torch.float64)
8 gae_duplicate tensor(-1.1332, dtype=torch.float64) tensor(2.3586, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2730, dtype=torch.float64) delta_t tensor(-0.6184, dtype=torch.float64)
7 gae_duplicate tensor(-1.5250, dtype=torch.float64) tensor(3.1681, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7379, dtype=torch.float64) delta_t tensor(-0.9455, dtype=torch.float64)
6 gae_duplicate tensor(-2.1655, dtype=torch.float64) tensor(4.5045, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0703, dtype=torch.float64) delta_t tensor(-0.4186, dtype=torch.float64)
5 gae_duplicate tensor(-2.1510, dtype=torch.float64) tensor(4.4715, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.3902, dtype=torch.float64) delta_t tensor(-3.5358, dtype=torch.float64)
4 gae_duplicate tensor(-5.2566, dtype=torch.float64) tensor(10.9342, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2140, dtype=torch.float64) delta_t tensor(-0.3699, dtype=torch.float64)
3 gae_duplicate tensor(-4.5752, dtype=torch.float64) tensor(9.5170, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2141, dtype=torch.float64) delta_t tensor(-0.3849, dtype=torch.float64)
2 gae_duplicate tensor(-4.0451, dtype=torch.float64) tensor(8.4142, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-239.8582763671875
value loss:128.24205017089844
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.406457185745239 seconds
19 rew tensor(0.7905, dtype=torch.float64) delta_t tensor(-1.0496, dtype=torch.float64)
19 gae_duplicate tensor(-1.0496, dtype=torch.float64) tensor(2.1831, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7910, dtype=torch.float64) delta_t tensor(0.4593, dtype=torch.float64)
18 gae_duplicate tensor(-0.3803, dtype=torch.float64) tensor(0.7906, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7249, dtype=torch.float64) delta_t tensor(0.2777, dtype=torch.float64)
17 gae_duplicate tensor(-0.0266, dtype=torch.float64) tensor(0.0553, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4587, dtype=torch.float64) delta_t tensor(0.2678, dtype=torch.float64)
16 gae_duplicate tensor(0.2466, dtype=torch.float64) tensor(-0.5131, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0076, dtype=torch.float64) delta_t tensor(0.0582, dtype=torch.float64)
15 gae_duplicate tensor(0.2554, dtype=torch.float64) tensor(-0.5313, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6586, dtype=torch.float64) delta_t tensor(0.5493, dtype=torch.float64)
14 gae_duplicate tensor(0.7536, dtype=torch.float64) tensor(-1.5685, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5924, dtype=torch.float64) delta_t tensor(0.4721, dtype=torch.float64)
13 gae_duplicate tensor(1.0750, dtype=torch.float64) tensor(-2.2360, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4596, dtype=torch.float64) delta_t tensor(0.4772, dtype=torch.float64)
12 gae_duplicate tensor(1.3372, dtype=torch.float64) tensor(-2.7830, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9257, dtype=torch.float64) delta_t tensor(0.7632, dtype=torch.float64)
11 gae_duplicate tensor(1.8330, dtype=torch.float64) tensor(-3.8105, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9265, dtype=torch.float64) delta_t tensor(-0.1880, dtype=torch.float64)
10 gae_duplicate tensor(1.2784, dtype=torch.float64) tensor(-2.6591, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2690, dtype=torch.float64) delta_t tensor(-1.2459, dtype=torch.float64)
9 gae_duplicate tensor(-0.2232, dtype=torch.float64) tensor(0.4643, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.1359, dtype=torch.float64) delta_t tensor(-2.8768, dtype=torch.float64)
8 gae_duplicate tensor(-3.0554, dtype=torch.float64) tensor(6.3517, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5409, dtype=torch.float64) delta_t tensor(-0.1557, dtype=torch.float64)
7 gae_duplicate tensor(-2.6000, dtype=torch.float64) tensor(5.4080, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8078, dtype=torch.float64) delta_t tensor(-0.2191, dtype=torch.float64)
6 gae_duplicate tensor(-2.2990, dtype=torch.float64) tensor(4.7821, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4578, dtype=torch.float64) delta_t tensor(0.9365, dtype=torch.float64)
5 gae_duplicate tensor(-0.9027, dtype=torch.float64) tensor(1.8777, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9409, dtype=torch.float64) delta_t tensor(-0.7599, dtype=torch.float64)
4 gae_duplicate tensor(-1.4820, dtype=torch.float64) tensor(3.0827, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5239, dtype=torch.float64) delta_t tensor(0.8385, dtype=torch.float64)
3 gae_duplicate tensor(-0.3471, dtype=torch.float64) tensor(0.7211, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9410, dtype=torch.float64) delta_t tensor(-1.3781, dtype=torch.float64)
2 gae_duplicate tensor(-1.6558, dtype=torch.float64) tensor(3.4422, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-91.46656799316406
value loss:55.77417755126953
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.575026988983154 seconds
19 rew tensor(0.9225, dtype=torch.float64) delta_t tensor(-0.7379, dtype=torch.float64)
19 gae_duplicate tensor(-0.7379, dtype=torch.float64) tensor(1.5356, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9232, dtype=torch.float64) delta_t tensor(0.6950, dtype=torch.float64)
18 gae_duplicate tensor(0.1047, dtype=torch.float64) tensor(-0.2177, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9239, dtype=torch.float64) delta_t tensor(1.0535, dtype=torch.float64)
17 gae_duplicate tensor(1.1373, dtype=torch.float64) tensor(-2.3655, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9246, dtype=torch.float64) delta_t tensor(0.4309, dtype=torch.float64)
16 gae_duplicate tensor(1.3407, dtype=torch.float64) tensor(-2.7871, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9254, dtype=torch.float64) delta_t tensor(0.7316, dtype=torch.float64)
15 gae_duplicate tensor(1.8041, dtype=torch.float64) tensor(-3.7506, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9261, dtype=torch.float64) delta_t tensor(1.4668, dtype=torch.float64)
14 gae_duplicate tensor(2.9101, dtype=torch.float64) tensor(-6.0529, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9268, dtype=torch.float64) delta_t tensor(1.3681, dtype=torch.float64)
13 gae_duplicate tensor(3.6962, dtype=torch.float64) tensor(-7.6839, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2621, dtype=torch.float64) delta_t tensor(-0.4284, dtype=torch.float64)
12 gae_duplicate tensor(2.5285, dtype=torch.float64) tensor(-5.2565, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2623, dtype=torch.float64) delta_t tensor(0.0467, dtype=torch.float64)
11 gae_duplicate tensor(2.0695, dtype=torch.float64) tensor(-4.3046, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3954, dtype=torch.float64) delta_t tensor(-0.7660, dtype=torch.float64)
10 gae_duplicate tensor(0.8896, dtype=torch.float64) tensor(-1.8485, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3291, dtype=torch.float64) delta_t tensor(0.1811, dtype=torch.float64)
9 gae_duplicate tensor(0.8928, dtype=torch.float64) tensor(-1.8561, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1299, dtype=torch.float64) delta_t tensor(-0.1945, dtype=torch.float64)
8 gae_duplicate tensor(0.5198, dtype=torch.float64) tensor(-1.0812, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7334, dtype=torch.float64) delta_t tensor(-0.7513, dtype=torch.float64)
7 gae_duplicate tensor(-0.3354, dtype=torch.float64) tensor(0.6981, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1987, dtype=torch.float64) delta_t tensor(-1.5281, dtype=torch.float64)
6 gae_duplicate tensor(-1.7964, dtype=torch.float64) tensor(3.7347, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7312, dtype=torch.float64) delta_t tensor(-1.3686, dtype=torch.float64)
5 gae_duplicate tensor(-2.8058, dtype=torch.float64) tensor(5.8329, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5953, dtype=torch.float64) delta_t tensor(-3.0634, dtype=torch.float64)
4 gae_duplicate tensor(-5.3080, dtype=torch.float64) tensor(11.0294, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2764, dtype=torch.float64) delta_t tensor(0.0710, dtype=torch.float64)
3 gae_duplicate tensor(-4.1755, dtype=torch.float64) tensor(8.6848, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2765, dtype=torch.float64) delta_t tensor(-0.2209, dtype=torch.float64)
2 gae_duplicate tensor(-3.5613, dtype=torch.float64) tensor(7.4073, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-11.431640625
value loss:166.60586547851562
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.275100946426392 seconds
19 rew tensor(0.9196, dtype=torch.float64) delta_t tensor(-0.6204, dtype=torch.float64)
19 gae_duplicate tensor(-0.6204, dtype=torch.float64) tensor(1.2898, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9203, dtype=torch.float64) delta_t tensor(0.5503, dtype=torch.float64)
18 gae_duplicate tensor(0.0540, dtype=torch.float64) tensor(-0.1123, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9210, dtype=torch.float64) delta_t tensor(0.5959, dtype=torch.float64)
17 gae_duplicate tensor(0.6390, dtype=torch.float64) tensor(-1.3285, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9217, dtype=torch.float64) delta_t tensor(0.5273, dtype=torch.float64)
16 gae_duplicate tensor(1.0385, dtype=torch.float64) tensor(-2.1600, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9224, dtype=torch.float64) delta_t tensor(1.5599, dtype=torch.float64)
15 gae_duplicate tensor(2.3907, dtype=torch.float64) tensor(-4.9748, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9231, dtype=torch.float64) delta_t tensor(0.7842, dtype=torch.float64)
14 gae_duplicate tensor(2.6967, dtype=torch.float64) tensor(-5.6064, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9238, dtype=torch.float64) delta_t tensor(0.6915, dtype=torch.float64)
13 gae_duplicate tensor(2.8489, dtype=torch.float64) tensor(-5.9227, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9246, dtype=torch.float64) delta_t tensor(0.7892, dtype=torch.float64)
12 gae_duplicate tensor(3.0683, dtype=torch.float64) tensor(-6.3849, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9253, dtype=torch.float64) delta_t tensor(0.7709, dtype=torch.float64)
11 gae_duplicate tensor(3.2256, dtype=torch.float64) tensor(-6.7026, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9260, dtype=torch.float64) delta_t tensor(-0.2986, dtype=torch.float64)
10 gae_duplicate tensor(2.2818, dtype=torch.float64) tensor(-4.7460, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9267, dtype=torch.float64) delta_t tensor(0.6691, dtype=torch.float64)
9 gae_duplicate tensor(2.4945, dtype=torch.float64) tensor(-5.1860, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2690, dtype=torch.float64) delta_t tensor(-1.8637, dtype=torch.float64)
8 gae_duplicate tensor(0.1320, dtype=torch.float64) tensor(-0.2743, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3940, dtype=torch.float64) delta_t tensor(2.1962, dtype=torch.float64)
7 gae_duplicate tensor(2.3017, dtype=torch.float64) tensor(-4.7852, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2048, dtype=torch.float64) delta_t tensor(-0.4048, dtype=torch.float64)
6 gae_duplicate tensor(1.4366, dtype=torch.float64) tensor(-2.9881, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0697, dtype=torch.float64) delta_t tensor(-0.5445, dtype=torch.float64)
5 gae_duplicate tensor(0.6048, dtype=torch.float64) tensor(-1.2574, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4698, dtype=torch.float64) delta_t tensor(-1.1222, dtype=torch.float64)
4 gae_duplicate tensor(-0.6384, dtype=torch.float64) tensor(1.3271, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4585, dtype=torch.float64) delta_t tensor(-0.0637, dtype=torch.float64)
3 gae_duplicate tensor(-0.5744, dtype=torch.float64) tensor(1.1937, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4709, dtype=torch.float64) delta_t tensor(-1.2287, dtype=torch.float64)
2 gae_duplicate tensor(-1.6882, dtype=torch.float64) tensor(3.5082, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:269.5399169921875
value loss:98.33924102783203
entropies:37.42993927001953
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.0552)
ToM Target loss= tensor(305.1401)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.363853931427002 seconds
19 rew tensor(0.8519, dtype=torch.float64) delta_t tensor(0.1141, dtype=torch.float64)
19 gae_duplicate tensor(0.1141, dtype=torch.float64) tensor(-0.2373, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9192, dtype=torch.float64) delta_t tensor(0.7451, dtype=torch.float64)
18 gae_duplicate tensor(0.8364, dtype=torch.float64) tensor(-1.7396, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8532, dtype=torch.float64) delta_t tensor(0.6616, dtype=torch.float64)
17 gae_duplicate tensor(1.3307, dtype=torch.float64) tensor(-2.7677, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8538, dtype=torch.float64) delta_t tensor(-0.5222, dtype=torch.float64)
16 gae_duplicate tensor(0.5424, dtype=torch.float64) tensor(-1.1281, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7878, dtype=torch.float64) delta_t tensor(0.3150, dtype=torch.float64)
15 gae_duplicate tensor(0.7489, dtype=torch.float64) tensor(-1.5576, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8549, dtype=torch.float64) delta_t tensor(0.4236, dtype=torch.float64)
14 gae_duplicate tensor(1.0226, dtype=torch.float64) tensor(-2.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7889, dtype=torch.float64) delta_t tensor(0.3824, dtype=torch.float64)
13 gae_duplicate tensor(1.2005, dtype=torch.float64) tensor(-2.4980, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9227, dtype=torch.float64) delta_t tensor(0.5052, dtype=torch.float64)
12 gae_duplicate tensor(1.4656, dtype=torch.float64) tensor(-3.0482, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9234, dtype=torch.float64) delta_t tensor(0.4219, dtype=torch.float64)
11 gae_duplicate tensor(1.5943, dtype=torch.float64) tensor(-3.3146, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7242, dtype=torch.float64) delta_t tensor(0.3003, dtype=torch.float64)
10 gae_duplicate tensor(1.5757, dtype=torch.float64) tensor(-3.2759, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6581, dtype=torch.float64) delta_t tensor(0.2779, dtype=torch.float64)
9 gae_duplicate tensor(1.5384, dtype=torch.float64) tensor(-3.1984, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1923, dtype=torch.float64) delta_t tensor(0.6075, dtype=torch.float64)
8 gae_duplicate tensor(1.8382, dtype=torch.float64) tensor(-3.8200, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6065, dtype=torch.float64) delta_t tensor(0.3505, dtype=torch.float64)
7 gae_duplicate tensor(1.8211, dtype=torch.float64) tensor(-3.7893, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2058, dtype=torch.float64) delta_t tensor(-0.6303, dtype=torch.float64)
6 gae_duplicate tensor(0.8266, dtype=torch.float64) tensor(-1.7184, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8061, dtype=torch.float64) delta_t tensor(-1.6090, dtype=torch.float64)
5 gae_duplicate tensor(-0.9478, dtype=torch.float64) tensor(1.9721, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2096, dtype=torch.float64) delta_t tensor(-0.9122, dtype=torch.float64)
4 gae_duplicate tensor(-1.6704, dtype=torch.float64) tensor(3.4756, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1219, dtype=torch.float64) delta_t tensor(-0.5332, dtype=torch.float64)
3 gae_duplicate tensor(-1.8695, dtype=torch.float64) tensor(3.8864, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6099, dtype=torch.float64) delta_t tensor(-1.0496, dtype=torch.float64)
2 gae_duplicate tensor(-2.5452, dtype=torch.float64) tensor(5.2939, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:116.43086242675781
value loss:54.60767364501953
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.485244989395142 seconds
19 rew tensor(0.9152, dtype=torch.float64) delta_t tensor(-1.0518, dtype=torch.float64)
19 gae_duplicate tensor(-1.0518, dtype=torch.float64) tensor(2.1875, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9159, dtype=torch.float64) delta_t tensor(0.5250, dtype=torch.float64)
18 gae_duplicate tensor(-0.3164, dtype=torch.float64) tensor(0.6578, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9165, dtype=torch.float64) delta_t tensor(0.5293, dtype=torch.float64)
17 gae_duplicate tensor(0.2762, dtype=torch.float64) tensor(-0.5745, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9172, dtype=torch.float64) delta_t tensor(0.5410, dtype=torch.float64)
16 gae_duplicate tensor(0.7620, dtype=torch.float64) tensor(-1.5848, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9179, dtype=torch.float64) delta_t tensor(0.5568, dtype=torch.float64)
15 gae_duplicate tensor(1.1664, dtype=torch.float64) tensor(-2.4269, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9186, dtype=torch.float64) delta_t tensor(1.6139, dtype=torch.float64)
14 gae_duplicate tensor(2.5470, dtype=torch.float64) tensor(-5.2974, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9193, dtype=torch.float64) delta_t tensor(0.7518, dtype=torch.float64)
13 gae_duplicate tensor(2.7894, dtype=torch.float64) tensor(-5.7994, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9200, dtype=torch.float64) delta_t tensor(0.7525, dtype=torch.float64)
12 gae_duplicate tensor(2.9841, dtype=torch.float64) tensor(-6.2064, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9206, dtype=torch.float64) delta_t tensor(0.0902, dtype=torch.float64)
11 gae_duplicate tensor(2.4774, dtype=torch.float64) tensor(-5.1547, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9213, dtype=torch.float64) delta_t tensor(0.6680, dtype=torch.float64)
10 gae_duplicate tensor(2.6500, dtype=torch.float64) tensor(-5.5115, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9220, dtype=torch.float64) delta_t tensor(0.1383, dtype=torch.float64)
9 gae_duplicate tensor(2.2583, dtype=torch.float64) tensor(-4.6968, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0567, dtype=torch.float64) delta_t tensor(-0.4485, dtype=torch.float64)
8 gae_duplicate tensor(1.3581, dtype=torch.float64) tensor(-2.8258, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6758, dtype=torch.float64) delta_t tensor(-1.0810, dtype=torch.float64)
7 gae_duplicate tensor(0.0055, dtype=torch.float64) tensor(-0.0115, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0756, dtype=torch.float64) delta_t tensor(-1.3145, dtype=torch.float64)
6 gae_duplicate tensor(-1.3100, dtype=torch.float64) tensor(2.7226, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4108, dtype=torch.float64) delta_t tensor(1.5369, dtype=torch.float64)
5 gae_duplicate tensor(0.4888, dtype=torch.float64) tensor(-1.0163, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0733, dtype=torch.float64) delta_t tensor(-3.4190, dtype=torch.float64)
4 gae_duplicate tensor(-3.0280, dtype=torch.float64) tensor(6.2953, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2146, dtype=torch.float64) delta_t tensor(0.1845, dtype=torch.float64)
3 gae_duplicate tensor(-2.2379, dtype=torch.float64) tensor(4.6545, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2146, dtype=torch.float64) delta_t tensor(-0.2274, dtype=torch.float64)
2 gae_duplicate tensor(-2.0177, dtype=torch.float64) tensor(4.1948, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:121.23753356933594
value loss:100.05599212646484
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.405875205993652 seconds
19 rew tensor(0.9169, dtype=torch.float64) delta_t tensor(0.2659, dtype=torch.float64)
19 gae_duplicate tensor(0.2659, dtype=torch.float64) tensor(-0.5529, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9176, dtype=torch.float64) delta_t tensor(0.9065, dtype=torch.float64)
18 gae_duplicate tensor(1.1192, dtype=torch.float64) tensor(-2.3270, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9182, dtype=torch.float64) delta_t tensor(0.9445, dtype=torch.float64)
17 gae_duplicate tensor(1.8399, dtype=torch.float64) tensor(-3.8267, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9189, dtype=torch.float64) delta_t tensor(0.8391, dtype=torch.float64)
16 gae_duplicate tensor(2.3110, dtype=torch.float64) tensor(-4.8064, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9196, dtype=torch.float64) delta_t tensor(1.0475, dtype=torch.float64)
15 gae_duplicate tensor(2.8963, dtype=torch.float64) tensor(-6.0237, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9203, dtype=torch.float64) delta_t tensor(0.8082, dtype=torch.float64)
14 gae_duplicate tensor(3.1253, dtype=torch.float64) tensor(-6.4977, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9209, dtype=torch.float64) delta_t tensor(0.9462, dtype=torch.float64)
13 gae_duplicate tensor(3.4464, dtype=torch.float64) tensor(-7.1630, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2544, dtype=torch.float64) delta_t tensor(0.2930, dtype=torch.float64)
12 gae_duplicate tensor(3.0501, dtype=torch.float64) tensor(-6.3437, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1211, dtype=torch.float64) delta_t tensor(-0.1411, dtype=torch.float64)
11 gae_duplicate tensor(2.2990, dtype=torch.float64) tensor(-4.7830, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1879, dtype=torch.float64) delta_t tensor(-1.0530, dtype=torch.float64)
10 gae_duplicate tensor(0.7862, dtype=torch.float64) tensor(-1.6340, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0546, dtype=torch.float64) delta_t tensor(-0.5086, dtype=torch.float64)
9 gae_duplicate tensor(0.1204, dtype=torch.float64) tensor(-0.2503, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1452, dtype=torch.float64) delta_t tensor(-0.5981, dtype=torch.float64)
8 gae_duplicate tensor(-0.5018, dtype=torch.float64) tensor(1.0433, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6780, dtype=torch.float64) delta_t tensor(0.2012, dtype=torch.float64)
7 gae_duplicate tensor(-0.2003, dtype=torch.float64) tensor(0.4163, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.9433, dtype=torch.float64) delta_t tensor(-2.7183, dtype=torch.float64)
6 gae_duplicate tensor(-2.8785, dtype=torch.float64) tensor(5.9886, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8138, dtype=torch.float64) delta_t tensor(-0.7313, dtype=torch.float64)
5 gae_duplicate tensor(-3.0341, dtype=torch.float64) tensor(6.3082, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6167, dtype=torch.float64) delta_t tensor(-1.6964, dtype=torch.float64)
4 gae_duplicate tensor(-4.1237, dtype=torch.float64) tensor(8.5737, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2840, dtype=torch.float64) delta_t tensor(0.4293, dtype=torch.float64)
3 gae_duplicate tensor(-2.8697, dtype=torch.float64) tensor(5.9645, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4843, dtype=torch.float64) delta_t tensor(-0.6377, dtype=torch.float64)
2 gae_duplicate tensor(-2.9335, dtype=torch.float64) tensor(6.1029, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:57.74098205566406
value loss:160.39926147460938
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.401407957077026 seconds
19 rew tensor(0.7853, dtype=torch.float64) delta_t tensor(-1.4629, dtype=torch.float64)
19 gae_duplicate tensor(-1.4629, dtype=torch.float64) tensor(3.0425, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8528, dtype=torch.float64) delta_t tensor(0.2974, dtype=torch.float64)
18 gae_duplicate tensor(-0.8729, dtype=torch.float64) tensor(1.8155, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6526, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
17 gae_duplicate tensor(-0.6586, dtype=torch.float64) tensor(1.3697, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5192, dtype=torch.float64) delta_t tensor(0.0529, dtype=torch.float64)
16 gae_duplicate tensor(-0.4740, dtype=torch.float64) tensor(0.9855, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1183, dtype=torch.float64) delta_t tensor(0.2823, dtype=torch.float64)
15 gae_duplicate tensor(-0.0969, dtype=torch.float64) tensor(0.2014, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5862, dtype=torch.float64) delta_t tensor(0.7800, dtype=torch.float64)
14 gae_duplicate tensor(0.7024, dtype=torch.float64) tensor(-1.4609, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2524, dtype=torch.float64) delta_t tensor(0.0384, dtype=torch.float64)
13 gae_duplicate tensor(0.6004, dtype=torch.float64) tensor(-1.2486, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7201, dtype=torch.float64) delta_t tensor(0.4366, dtype=torch.float64)
12 gae_duplicate tensor(0.9169, dtype=torch.float64) tensor(-1.9058, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8541, dtype=torch.float64) delta_t tensor(0.5458, dtype=torch.float64)
11 gae_duplicate tensor(1.2794, dtype=torch.float64) tensor(-2.6607, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1869, dtype=torch.float64) delta_t tensor(1.5742, dtype=torch.float64)
10 gae_duplicate tensor(2.5977, dtype=torch.float64) tensor(-5.4025, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1202, dtype=torch.float64) delta_t tensor(-0.3452, dtype=torch.float64)
9 gae_duplicate tensor(1.7330, dtype=torch.float64) tensor(-3.6041, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7208, dtype=torch.float64) delta_t tensor(0.5505, dtype=torch.float64)
8 gae_duplicate tensor(1.9369, dtype=torch.float64) tensor(-4.0282, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3877, dtype=torch.float64) delta_t tensor(0.3167, dtype=torch.float64)
7 gae_duplicate tensor(1.8662, dtype=torch.float64) tensor(-3.8801, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2124, dtype=torch.float64) delta_t tensor(-0.4627, dtype=torch.float64)
6 gae_duplicate tensor(1.0302, dtype=torch.float64) tensor(-2.1426, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8792, dtype=torch.float64) delta_t tensor(0.0735, dtype=torch.float64)
5 gae_duplicate tensor(0.8976, dtype=torch.float64) tensor(-1.8658, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6131, dtype=torch.float64) delta_t tensor(-1.4157, dtype=torch.float64)
4 gae_duplicate tensor(-0.6976, dtype=torch.float64) tensor(1.4503, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6821, dtype=torch.float64) delta_t tensor(-1.3806, dtype=torch.float64)
3 gae_duplicate tensor(-1.9386, dtype=torch.float64) tensor(4.0329, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3509, dtype=torch.float64) delta_t tensor(-2.2590, dtype=torch.float64)
2 gae_duplicate tensor(-3.8099, dtype=torch.float64) tensor(7.9235, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:43.14541244506836
value loss:66.77076721191406
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5847389698028564 seconds
19 rew tensor(0.9192, dtype=torch.float64) delta_t tensor(-0.0342, dtype=torch.float64)
19 gae_duplicate tensor(-0.0342, dtype=torch.float64) tensor(0.0711, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9199, dtype=torch.float64) delta_t tensor(-0.1488, dtype=torch.float64)
18 gae_duplicate tensor(-0.1761, dtype=torch.float64) tensor(0.3663, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9205, dtype=torch.float64) delta_t tensor(1.1273, dtype=torch.float64)
17 gae_duplicate tensor(0.9864, dtype=torch.float64) tensor(-2.0520, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9212, dtype=torch.float64) delta_t tensor(0.2307, dtype=torch.float64)
16 gae_duplicate tensor(1.0198, dtype=torch.float64) tensor(-2.1204, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9218, dtype=torch.float64) delta_t tensor(0.8200, dtype=torch.float64)
15 gae_duplicate tensor(1.6359, dtype=torch.float64) tensor(-3.4021, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9225, dtype=torch.float64) delta_t tensor(1.0320, dtype=torch.float64)
14 gae_duplicate tensor(2.3407, dtype=torch.float64) tensor(-4.8668, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9231, dtype=torch.float64) delta_t tensor(1.6927, dtype=torch.float64)
13 gae_duplicate tensor(3.5653, dtype=torch.float64) tensor(-7.4165, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1223, dtype=torch.float64) delta_t tensor(-0.2923, dtype=torch.float64)
12 gae_duplicate tensor(2.5600, dtype=torch.float64) tensor(-5.3240, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2559, dtype=torch.float64) delta_t tensor(-0.0289, dtype=torch.float64)
11 gae_duplicate tensor(2.0191, dtype=torch.float64) tensor(-4.1981, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2560, dtype=torch.float64) delta_t tensor(-0.8322, dtype=torch.float64)
10 gae_duplicate tensor(0.7831, dtype=torch.float64) tensor(-1.6278, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1893, dtype=torch.float64) delta_t tensor(-0.8544, dtype=torch.float64)
9 gae_duplicate tensor(-0.2279, dtype=torch.float64) tensor(0.4738, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1440, dtype=torch.float64) delta_t tensor(-0.5313, dtype=torch.float64)
8 gae_duplicate tensor(-0.7136, dtype=torch.float64) tensor(1.4834, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0774, dtype=torch.float64) delta_t tensor(0.9223, dtype=torch.float64)
7 gae_duplicate tensor(0.3514, dtype=torch.float64) tensor(-0.7310, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1438, dtype=torch.float64) delta_t tensor(-1.5447, dtype=torch.float64)
6 gae_duplicate tensor(-1.2636, dtype=torch.float64) tensor(2.6279, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.3445, dtype=torch.float64) delta_t tensor(-1.5614, dtype=torch.float64)
5 gae_duplicate tensor(-2.5723, dtype=torch.float64) tensor(5.3497, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0849, dtype=torch.float64) delta_t tensor(-3.1776, dtype=torch.float64)
4 gae_duplicate tensor(-5.2355, dtype=torch.float64) tensor(10.8882, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4180, dtype=torch.float64) delta_t tensor(0.1500, dtype=torch.float64)
3 gae_duplicate tensor(-4.0384, dtype=torch.float64) tensor(8.3966, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4851, dtype=torch.float64) delta_t tensor(-0.3399, dtype=torch.float64)
2 gae_duplicate tensor(-3.5706, dtype=torch.float64) tensor(7.4239, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-33.17658233642578
value loss:149.2828826904297
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.9052)
ToM Target loss= tensor(304.7203)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.302608251571655 seconds
19 rew tensor(0.9179, dtype=torch.float64) delta_t tensor(-1.4699, dtype=torch.float64)
19 gae_duplicate tensor(-1.4699, dtype=torch.float64) tensor(3.0556, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9185, dtype=torch.float64) delta_t tensor(0.9391, dtype=torch.float64)
18 gae_duplicate tensor(-0.2368, dtype=torch.float64) tensor(0.4924, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9192, dtype=torch.float64) delta_t tensor(0.4679, dtype=torch.float64)
17 gae_duplicate tensor(0.2784, dtype=torch.float64) tensor(-0.5788, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9198, dtype=torch.float64) delta_t tensor(0.5741, dtype=torch.float64)
16 gae_duplicate tensor(0.7968, dtype=torch.float64) tensor(-1.6568, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9205, dtype=torch.float64) delta_t tensor(1.0421, dtype=torch.float64)
15 gae_duplicate tensor(1.6795, dtype=torch.float64) tensor(-3.4921, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9211, dtype=torch.float64) delta_t tensor(0.3085, dtype=torch.float64)
14 gae_duplicate tensor(1.6521, dtype=torch.float64) tensor(-3.4344, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9218, dtype=torch.float64) delta_t tensor(-0.0741, dtype=torch.float64)
13 gae_duplicate tensor(1.2476, dtype=torch.float64) tensor(-2.5951, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9224, dtype=torch.float64) delta_t tensor(0.4115, dtype=torch.float64)
12 gae_duplicate tensor(1.4096, dtype=torch.float64) tensor(-2.9320, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9231, dtype=torch.float64) delta_t tensor(0.4982, dtype=torch.float64)
11 gae_duplicate tensor(1.6259, dtype=torch.float64) tensor(-3.3807, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9237, dtype=torch.float64) delta_t tensor(0.3176, dtype=torch.float64)
10 gae_duplicate tensor(1.6183, dtype=torch.float64) tensor(-3.3641, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9244, dtype=torch.float64) delta_t tensor(0.4900, dtype=torch.float64)
9 gae_duplicate tensor(1.7847, dtype=torch.float64) tensor(-3.7115, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8753, dtype=torch.float64) delta_t tensor(-1.4624, dtype=torch.float64)
8 gae_duplicate tensor(-0.0346, dtype=torch.float64) tensor(0.0721, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5425, dtype=torch.float64) delta_t tensor(-1.1105, dtype=torch.float64)
7 gae_duplicate tensor(-1.1382, dtype=torch.float64) tensor(2.3670, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.4090, dtype=torch.float64) delta_t tensor(-1.0204, dtype=torch.float64)
6 gae_duplicate tensor(-1.9309, dtype=torch.float64) tensor(4.0165, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2801, dtype=torch.float64) delta_t tensor(-1.9255, dtype=torch.float64)
5 gae_duplicate tensor(-3.4702, dtype=torch.float64) tensor(7.2169, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8826, dtype=torch.float64) delta_t tensor(-0.6841, dtype=torch.float64)
4 gae_duplicate tensor(-3.4603, dtype=torch.float64) tensor(7.1948, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7493, dtype=torch.float64) delta_t tensor(-0.4830, dtype=torch.float64)
3 gae_duplicate tensor(-3.2512, dtype=torch.float64) tensor(6.7613, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8166, dtype=torch.float64) delta_t tensor(-0.6656, dtype=torch.float64)
2 gae_duplicate tensor(-3.2666, dtype=torch.float64) tensor(6.7947, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-78.07735443115234
value loss:106.12825012207031
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.41173791885376 seconds
19 rew tensor(0.9168, dtype=torch.float64) delta_t tensor(-1.1972, dtype=torch.float64)
19 gae_duplicate tensor(-1.1972, dtype=torch.float64) tensor(2.4898, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9174, dtype=torch.float64) delta_t tensor(0.4946, dtype=torch.float64)
18 gae_duplicate tensor(-0.4632, dtype=torch.float64) tensor(0.9629, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9180, dtype=torch.float64) delta_t tensor(0.1575, dtype=torch.float64)
17 gae_duplicate tensor(-0.2130, dtype=torch.float64) tensor(0.4430, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9187, dtype=torch.float64) delta_t tensor(0.8256, dtype=torch.float64)
16 gae_duplicate tensor(0.6552, dtype=torch.float64) tensor(-1.3629, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9193, dtype=torch.float64) delta_t tensor(0.2822, dtype=torch.float64)
15 gae_duplicate tensor(0.8064, dtype=torch.float64) tensor(-1.6773, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9199, dtype=torch.float64) delta_t tensor(0.2968, dtype=torch.float64)
14 gae_duplicate tensor(0.9419, dtype=torch.float64) tensor(-1.9587, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9206, dtype=torch.float64) delta_t tensor(0.3200, dtype=torch.float64)
13 gae_duplicate tensor(1.0735, dtype=torch.float64) tensor(-2.2320, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9212, dtype=torch.float64) delta_t tensor(0.3688, dtype=torch.float64)
12 gae_duplicate tensor(1.2275, dtype=torch.float64) tensor(-2.5528, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7883, dtype=torch.float64) delta_t tensor(0.1224, dtype=torch.float64)
11 gae_duplicate tensor(1.1044, dtype=torch.float64) tensor(-2.2959, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5218, dtype=torch.float64) delta_t tensor(2.1570, dtype=torch.float64)
10 gae_duplicate tensor(3.0405, dtype=torch.float64) tensor(-6.3220, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4553, dtype=torch.float64) delta_t tensor(0.5177, dtype=torch.float64)
9 gae_duplicate tensor(2.9501, dtype=torch.float64) tensor(-6.1341, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3221, dtype=torch.float64) delta_t tensor(0.8170, dtype=torch.float64)
8 gae_duplicate tensor(3.1771, dtype=torch.float64) tensor(-6.6060, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4556, dtype=torch.float64) delta_t tensor(0.1133, dtype=torch.float64)
7 gae_duplicate tensor(2.6549, dtype=torch.float64) tensor(-5.5202, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8776, dtype=torch.float64) delta_t tensor(-0.4248, dtype=torch.float64)
6 gae_duplicate tensor(1.6991, dtype=torch.float64) tensor(-3.5329, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5448, dtype=torch.float64) delta_t tensor(-0.6926, dtype=torch.float64)
5 gae_duplicate tensor(0.6667, dtype=torch.float64) tensor(-1.3864, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7447, dtype=torch.float64) delta_t tensor(-1.1594, dtype=torch.float64)
4 gae_duplicate tensor(-0.6261, dtype=torch.float64) tensor(1.3017, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6140, dtype=torch.float64) delta_t tensor(-1.6046, dtype=torch.float64)
3 gae_duplicate tensor(-2.1054, dtype=torch.float64) tensor(4.3776, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3492, dtype=torch.float64) delta_t tensor(-1.3745, dtype=torch.float64)
2 gae_duplicate tensor(-3.0589, dtype=torch.float64) tensor(6.3612, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:152.7476806640625
value loss:90.21229553222656
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.381777286529541 seconds
19 rew tensor(0.9161, dtype=torch.float64) delta_t tensor(-1.1935, dtype=torch.float64)
19 gae_duplicate tensor(-1.1935, dtype=torch.float64) tensor(2.4812, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8499, dtype=torch.float64) delta_t tensor(0.5314, dtype=torch.float64)
18 gae_duplicate tensor(-0.4234, dtype=torch.float64) tensor(0.8807, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9172, dtype=torch.float64) delta_t tensor(0.5160, dtype=torch.float64)
17 gae_duplicate tensor(0.1773, dtype=torch.float64) tensor(-0.3686, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8511, dtype=torch.float64) delta_t tensor(0.3850, dtype=torch.float64)
16 gae_duplicate tensor(0.5268, dtype=torch.float64) tensor(-1.0955, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7848, dtype=torch.float64) delta_t tensor(-0.3016, dtype=torch.float64)
15 gae_duplicate tensor(0.1198, dtype=torch.float64) tensor(-0.2492, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7185, dtype=torch.float64) delta_t tensor(0.0769, dtype=torch.float64)
14 gae_duplicate tensor(0.1727, dtype=torch.float64) tensor(-0.3592, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5853, dtype=torch.float64) delta_t tensor(0.1016, dtype=torch.float64)
13 gae_duplicate tensor(0.2398, dtype=torch.float64) tensor(-0.4986, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9194, dtype=torch.float64) delta_t tensor(0.3689, dtype=torch.float64)
12 gae_duplicate tensor(0.5607, dtype=torch.float64) tensor(-1.1663, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9201, dtype=torch.float64) delta_t tensor(0.2935, dtype=torch.float64)
11 gae_duplicate tensor(0.7421, dtype=torch.float64) tensor(-1.5430, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7204, dtype=torch.float64) delta_t tensor(0.1657, dtype=torch.float64)
10 gae_duplicate tensor(0.7593, dtype=torch.float64) tensor(-1.5794, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8144, dtype=torch.float64) delta_t tensor(-1.3530, dtype=torch.float64)
9 gae_duplicate tensor(-0.7455, dtype=torch.float64) tensor(1.5501, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1475, dtype=torch.float64) delta_t tensor(-0.7603, dtype=torch.float64)
8 gae_duplicate tensor(-1.3567, dtype=torch.float64) tensor(2.8209, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2810, dtype=torch.float64) delta_t tensor(-0.6838, dtype=torch.float64)
7 gae_duplicate tensor(-1.7692, dtype=torch.float64) tensor(3.6786, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4145, dtype=torch.float64) delta_t tensor(-0.8638, dtype=torch.float64)
6 gae_duplicate tensor(-2.2792, dtype=torch.float64) tensor(4.7382, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4147, dtype=torch.float64) delta_t tensor(-0.5634, dtype=torch.float64)
5 gae_duplicate tensor(-2.3868, dtype=torch.float64) tensor(4.9627, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9503, dtype=torch.float64) delta_t tensor(-1.5582, dtype=torch.float64)
4 gae_duplicate tensor(-3.4676, dtype=torch.float64) tensor(7.2113, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0848, dtype=torch.float64) delta_t tensor(-0.5544, dtype=torch.float64)
3 gae_duplicate tensor(-3.3285, dtype=torch.float64) tensor(6.9208, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0180, dtype=torch.float64) delta_t tensor(0.0204, dtype=torch.float64)
2 gae_duplicate tensor(-2.6424, dtype=torch.float64) tensor(5.4952, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-204.40402221679688
value loss:74.93928527832031
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.442789077758789 seconds
19 rew tensor(0.9135, dtype=torch.float64) delta_t tensor(-1.8124, dtype=torch.float64)
19 gae_duplicate tensor(-1.8124, dtype=torch.float64) tensor(3.7680, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9141, dtype=torch.float64) delta_t tensor(0.7843, dtype=torch.float64)
18 gae_duplicate tensor(-0.6656, dtype=torch.float64) tensor(1.3842, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9147, dtype=torch.float64) delta_t tensor(0.6941, dtype=torch.float64)
17 gae_duplicate tensor(0.1617, dtype=torch.float64) tensor(-0.3362, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9153, dtype=torch.float64) delta_t tensor(0.5337, dtype=torch.float64)
16 gae_duplicate tensor(0.6630, dtype=torch.float64) tensor(-1.3785, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9159, dtype=torch.float64) delta_t tensor(0.5316, dtype=torch.float64)
15 gae_duplicate tensor(1.0621, dtype=torch.float64) tensor(-2.2084, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9165, dtype=torch.float64) delta_t tensor(0.4357, dtype=torch.float64)
14 gae_duplicate tensor(1.2853, dtype=torch.float64) tensor(-2.6722, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9171, dtype=torch.float64) delta_t tensor(-0.1848, dtype=torch.float64)
13 gae_duplicate tensor(0.8435, dtype=torch.float64) tensor(-1.7541, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9177, dtype=torch.float64) delta_t tensor(0.3781, dtype=torch.float64)
12 gae_duplicate tensor(1.0529, dtype=torch.float64) tensor(-2.1899, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9184, dtype=torch.float64) delta_t tensor(0.3664, dtype=torch.float64)
11 gae_duplicate tensor(1.2087, dtype=torch.float64) tensor(-2.5132, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9190, dtype=torch.float64) delta_t tensor(0.2763, dtype=torch.float64)
10 gae_duplicate tensor(1.2432, dtype=torch.float64) tensor(-2.5854, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9196, dtype=torch.float64) delta_t tensor(0.3774, dtype=torch.float64)
9 gae_duplicate tensor(1.3720, dtype=torch.float64) tensor(-2.8532, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0808, dtype=torch.float64) delta_t tensor(-0.7322, dtype=torch.float64)
8 gae_duplicate tensor(0.3655, dtype=torch.float64) tensor(-0.7599, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3862, dtype=torch.float64) delta_t tensor(-0.0252, dtype=torch.float64)
7 gae_duplicate tensor(0.2672, dtype=torch.float64) tensor(-0.5555, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.0144, dtype=torch.float64) delta_t tensor(-0.3145, dtype=torch.float64)
6 gae_duplicate tensor(-0.1008, dtype=torch.float64) tensor(0.2095, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3505, dtype=torch.float64) delta_t tensor(-2.1757, dtype=torch.float64)
5 gae_duplicate tensor(-2.2563, dtype=torch.float64) tensor(4.6929, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4204, dtype=torch.float64) delta_t tensor(-1.6105, dtype=torch.float64)
4 gae_duplicate tensor(-3.4155, dtype=torch.float64) tensor(7.1018, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4864, dtype=torch.float64) delta_t tensor(-0.0600, dtype=torch.float64)
3 gae_duplicate tensor(-2.7925, dtype=torch.float64) tensor(5.8072, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4197, dtype=torch.float64) delta_t tensor(-0.1077, dtype=torch.float64)
2 gae_duplicate tensor(-2.3417, dtype=torch.float64) tensor(4.8684, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-49.276268005371094
value loss:65.90380859375
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.59520697593689 seconds
19 rew tensor(0.9070, dtype=torch.float64) delta_t tensor(-1.3460, dtype=torch.float64)
19 gae_duplicate tensor(-1.3460, dtype=torch.float64) tensor(2.7988, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9076, dtype=torch.float64) delta_t tensor(0.1229, dtype=torch.float64)
18 gae_duplicate tensor(-0.9539, dtype=torch.float64) tensor(1.9833, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9082, dtype=torch.float64) delta_t tensor(0.8650, dtype=torch.float64)
17 gae_duplicate tensor(0.1019, dtype=torch.float64) tensor(-0.2118, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9088, dtype=torch.float64) delta_t tensor(0.5122, dtype=torch.float64)
16 gae_duplicate tensor(0.5937, dtype=torch.float64) tensor(-1.2345, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9093, dtype=torch.float64) delta_t tensor(0.4288, dtype=torch.float64)
15 gae_duplicate tensor(0.9037, dtype=torch.float64) tensor(-1.8792, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9099, dtype=torch.float64) delta_t tensor(2.5833, dtype=torch.float64)
14 gae_duplicate tensor(3.3063, dtype=torch.float64) tensor(-6.8749, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9105, dtype=torch.float64) delta_t tensor(0.3796, dtype=torch.float64)
13 gae_duplicate tensor(3.0246, dtype=torch.float64) tensor(-6.2907, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9111, dtype=torch.float64) delta_t tensor(-1.2261, dtype=torch.float64)
12 gae_duplicate tensor(1.1936, dtype=torch.float64) tensor(-2.4816, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9117, dtype=torch.float64) delta_t tensor(0.8316, dtype=torch.float64)
11 gae_duplicate tensor(1.7865, dtype=torch.float64) tensor(-3.7151, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9123, dtype=torch.float64) delta_t tensor(-0.0837, dtype=torch.float64)
10 gae_duplicate tensor(1.3455, dtype=torch.float64) tensor(-2.7980, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9129, dtype=torch.float64) delta_t tensor(0.4206, dtype=torch.float64)
9 gae_duplicate tensor(1.4970, dtype=torch.float64) tensor(-3.1128, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2509, dtype=torch.float64) delta_t tensor(0.5391, dtype=torch.float64)
8 gae_duplicate tensor(1.7367, dtype=torch.float64) tensor(-3.6121, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4712, dtype=torch.float64) delta_t tensor(-1.6435, dtype=torch.float64)
7 gae_duplicate tensor(-0.2541, dtype=torch.float64) tensor(0.5284, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5451, dtype=torch.float64) delta_t tensor(-1.6610, dtype=torch.float64)
6 gae_duplicate tensor(-1.8643, dtype=torch.float64) tensor(3.8768, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6716, dtype=torch.float64) delta_t tensor(-1.3649, dtype=torch.float64)
5 gae_duplicate tensor(-2.8563, dtype=torch.float64) tensor(5.9385, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.9223, dtype=torch.float64) delta_t tensor(-3.7385, dtype=torch.float64)
4 gae_duplicate tensor(-6.0236, dtype=torch.float64) tensor(12.5249, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3546, dtype=torch.float64) delta_t tensor(-0.4946, dtype=torch.float64)
3 gae_duplicate tensor(-5.3134, dtype=torch.float64) tensor(11.0495, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2879, dtype=torch.float64) delta_t tensor(0.2021, dtype=torch.float64)
2 gae_duplicate tensor(-4.0486, dtype=torch.float64) tensor(8.4175, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-90.56550598144531
value loss:192.4069061279297
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.2379)
ToM Target loss= tensor(304.8156)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.441559076309204 seconds
19 rew tensor(0.9029, dtype=torch.float64) delta_t tensor(0.1626, dtype=torch.float64)
19 gae_duplicate tensor(0.1626, dtype=torch.float64) tensor(-0.3382, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9035, dtype=torch.float64) delta_t tensor(0.7554, dtype=torch.float64)
18 gae_duplicate tensor(0.8855, dtype=torch.float64) tensor(-1.8415, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.7560, dtype=torch.float64)
17 gae_duplicate tensor(1.4644, dtype=torch.float64) tensor(-3.0451, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9046, dtype=torch.float64) delta_t tensor(0.7566, dtype=torch.float64)
16 gae_duplicate tensor(1.9281, dtype=torch.float64) tensor(-4.0096, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9052, dtype=torch.float64) delta_t tensor(0.7572, dtype=torch.float64)
15 gae_duplicate tensor(2.2997, dtype=torch.float64) tensor(-4.7823, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8399, dtype=torch.float64) delta_t tensor(0.7525, dtype=torch.float64)
14 gae_duplicate tensor(2.5923, dtype=torch.float64) tensor(-5.3911, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9063, dtype=torch.float64) delta_t tensor(0.1524, dtype=torch.float64)
13 gae_duplicate tensor(2.2262, dtype=torch.float64) tensor(-4.6294, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8410, dtype=torch.float64) delta_t tensor(0.7697, dtype=torch.float64)
12 gae_duplicate tensor(2.5507, dtype=torch.float64) tensor(-5.3042, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9074, dtype=torch.float64) delta_t tensor(-1.1413, dtype=torch.float64)
11 gae_duplicate tensor(0.8993, dtype=torch.float64) tensor(-1.8699, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6443, dtype=torch.float64) delta_t tensor(0.0898, dtype=torch.float64)
10 gae_duplicate tensor(0.8092, dtype=torch.float64) tensor(-1.6828, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2664, dtype=torch.float64) delta_t tensor(-1.5774, dtype=torch.float64)
9 gae_duplicate tensor(-0.9301, dtype=torch.float64) tensor(1.9338, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8721, dtype=torch.float64) delta_t tensor(-1.7570, dtype=torch.float64)
8 gae_duplicate tensor(-2.5010, dtype=torch.float64) tensor(5.2006, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3796, dtype=torch.float64) delta_t tensor(-0.1539, dtype=torch.float64)
7 gae_duplicate tensor(-2.1547, dtype=torch.float64) tensor(4.4802, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5427, dtype=torch.float64) delta_t tensor(-0.2780, dtype=torch.float64)
6 gae_duplicate tensor(-2.0018, dtype=torch.float64) tensor(4.1621, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.7167, dtype=torch.float64) delta_t tensor(-2.2723, dtype=torch.float64)
5 gae_duplicate tensor(-3.8737, dtype=torch.float64) tensor(8.0555, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.1113, dtype=torch.float64) delta_t tensor(-2.5109, dtype=torch.float64)
4 gae_duplicate tensor(-5.6099, dtype=torch.float64) tensor(11.6652, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1538, dtype=torch.float64) delta_t tensor(-0.2578, dtype=torch.float64)
3 gae_duplicate tensor(-4.7457, dtype=torch.float64) tensor(9.8685, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0211, dtype=torch.float64) delta_t tensor(-0.3140, dtype=torch.float64)
2 gae_duplicate tensor(-4.1106, dtype=torch.float64) tensor(8.5481, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-127.24174499511719
value loss:199.90956115722656
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.343850135803223 seconds
19 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(-1.5259, dtype=torch.float64)
19 gae_duplicate tensor(-1.5259, dtype=torch.float64) tensor(3.1730, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9027, dtype=torch.float64) delta_t tensor(-0.0124, dtype=torch.float64)
18 gae_duplicate tensor(-1.2331, dtype=torch.float64) tensor(2.5642, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9032, dtype=torch.float64) delta_t tensor(0.5063, dtype=torch.float64)
17 gae_duplicate tensor(-0.4802, dtype=torch.float64) tensor(0.9986, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9038, dtype=torch.float64) delta_t tensor(0.3672, dtype=torch.float64)
16 gae_duplicate tensor(-0.0169, dtype=torch.float64) tensor(0.0352, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9044, dtype=torch.float64) delta_t tensor(0.1613, dtype=torch.float64)
15 gae_duplicate tensor(0.1478, dtype=torch.float64) tensor(-0.3072, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9049, dtype=torch.float64) delta_t tensor(0.1874, dtype=torch.float64)
14 gae_duplicate tensor(0.3056, dtype=torch.float64) tensor(-0.6356, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9055, dtype=torch.float64) delta_t tensor(0.1882, dtype=torch.float64)
13 gae_duplicate tensor(0.4327, dtype=torch.float64) tensor(-0.8998, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9061, dtype=torch.float64) delta_t tensor(0.2685, dtype=torch.float64)
12 gae_duplicate tensor(0.6147, dtype=torch.float64) tensor(-1.2782, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6424, dtype=torch.float64) delta_t tensor(0.0744, dtype=torch.float64)
11 gae_duplicate tensor(0.5661, dtype=torch.float64) tensor(-1.1772, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3785, dtype=torch.float64) delta_t tensor(1.5626, dtype=torch.float64)
10 gae_duplicate tensor(2.0155, dtype=torch.float64) tensor(-4.1913, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3127, dtype=torch.float64) delta_t tensor(-1.8391, dtype=torch.float64)
9 gae_duplicate tensor(-0.2267, dtype=torch.float64) tensor(0.4713, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6114, dtype=torch.float64) delta_t tensor(-0.1214, dtype=torch.float64)
8 gae_duplicate tensor(-0.3028, dtype=torch.float64) tensor(0.6296, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7436, dtype=torch.float64) delta_t tensor(0.2869, dtype=torch.float64)
7 gae_duplicate tensor(0.0447, dtype=torch.float64) tensor(-0.0930, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6416, dtype=torch.float64) delta_t tensor(1.3029, dtype=torch.float64)
6 gae_duplicate tensor(1.3387, dtype=torch.float64) tensor(-2.7838, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4691, dtype=torch.float64) delta_t tensor(-0.7321, dtype=torch.float64)
5 gae_duplicate tensor(0.3389, dtype=torch.float64) tensor(-0.7047, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5092, dtype=torch.float64) delta_t tensor(-0.5248, dtype=torch.float64)
4 gae_duplicate tensor(-0.2537, dtype=torch.float64) tensor(0.5275, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2721, dtype=torch.float64) delta_t tensor(-0.1933, dtype=torch.float64)
3 gae_duplicate tensor(-0.3962, dtype=torch.float64) tensor(0.8240, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0753, dtype=torch.float64) delta_t tensor(-1.7355, dtype=torch.float64)
2 gae_duplicate tensor(-2.0525, dtype=torch.float64) tensor(4.2680, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-9.645468711853027
value loss:23.443843841552734
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.300116062164307 seconds
19 rew tensor(-1.7409, dtype=torch.float64) delta_t tensor(-3.7518, dtype=torch.float64)
19 gae_duplicate tensor(-3.7518, dtype=torch.float64) tensor(7.8019, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8373, dtype=torch.float64) delta_t tensor(0.2084, dtype=torch.float64)
18 gae_duplicate tensor(-2.7931, dtype=torch.float64) tensor(5.8079, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(0.2153, dtype=torch.float64)
17 gae_duplicate tensor(-2.0192, dtype=torch.float64) tensor(4.1985, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8384, dtype=torch.float64) delta_t tensor(0.3207, dtype=torch.float64)
16 gae_duplicate tensor(-1.2946, dtype=torch.float64) tensor(2.6920, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9050, dtype=torch.float64) delta_t tensor(0.4049, dtype=torch.float64)
15 gae_duplicate tensor(-0.6308, dtype=torch.float64) tensor(1.3118, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8394, dtype=torch.float64) delta_t tensor(0.0658, dtype=torch.float64)
14 gae_duplicate tensor(-0.4389, dtype=torch.float64) tensor(0.9127, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7738, dtype=torch.float64) delta_t tensor(0.2468, dtype=torch.float64)
13 gae_duplicate tensor(-0.1043, dtype=torch.float64) tensor(0.2169, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7742, dtype=torch.float64) delta_t tensor(0.1714, dtype=torch.float64)
12 gae_duplicate tensor(0.0880, dtype=torch.float64) tensor(-0.1830, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9069, dtype=torch.float64) delta_t tensor(0.3469, dtype=torch.float64)
11 gae_duplicate tensor(0.4173, dtype=torch.float64) tensor(-0.8678, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8413, dtype=torch.float64) delta_t tensor(0.2627, dtype=torch.float64)
10 gae_duplicate tensor(0.5965, dtype=torch.float64) tensor(-1.2405, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4804, dtype=torch.float64) delta_t tensor(-1.0481, dtype=torch.float64)
9 gae_duplicate tensor(-0.5709, dtype=torch.float64) tensor(1.1872, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5467, dtype=torch.float64) delta_t tensor(-1.0991, dtype=torch.float64)
8 gae_duplicate tensor(-1.5558, dtype=torch.float64) tensor(3.2351, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6791, dtype=torch.float64) delta_t tensor(-1.2284, dtype=torch.float64)
7 gae_duplicate tensor(-2.4730, dtype=torch.float64) tensor(5.1426, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2741, dtype=torch.float64) delta_t tensor(0.7135, dtype=torch.float64)
6 gae_duplicate tensor(-1.2650, dtype=torch.float64) tensor(2.6304, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0021, dtype=torch.float64) delta_t tensor(-1.3347, dtype=torch.float64)
5 gae_duplicate tensor(-2.3466, dtype=torch.float64) tensor(4.8799, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2118, dtype=torch.float64) delta_t tensor(-0.7509, dtype=torch.float64)
4 gae_duplicate tensor(-2.6283, dtype=torch.float64) tensor(5.4652, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0219, dtype=torch.float64) delta_t tensor(0.2325, dtype=torch.float64)
3 gae_duplicate tensor(-1.8701, dtype=torch.float64) tensor(3.8888, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5511, dtype=torch.float64) delta_t tensor(-0.6517, dtype=torch.float64)
2 gae_duplicate tensor(-2.1478, dtype=torch.float64) tensor(4.4665, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-310.40057373046875
value loss:89.63595581054688
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.522410154342651 seconds
19 rew tensor(0.8968, dtype=torch.float64) delta_t tensor(-2.0525, dtype=torch.float64)
19 gae_duplicate tensor(-2.0525, dtype=torch.float64) tensor(4.2687, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8973, dtype=torch.float64) delta_t tensor(0.3281, dtype=torch.float64)
18 gae_duplicate tensor(-1.3139, dtype=torch.float64) tensor(2.7324, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8979, dtype=torch.float64) delta_t tensor(0.2447, dtype=torch.float64)
17 gae_duplicate tensor(-0.8064, dtype=torch.float64) tensor(1.6771, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.4659, dtype=torch.float64)
16 gae_duplicate tensor(-0.1792, dtype=torch.float64) tensor(0.3727, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(1.4711, dtype=torch.float64)
15 gae_duplicate tensor(1.3277, dtype=torch.float64) tensor(-2.7610, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.4288, dtype=torch.float64)
14 gae_duplicate tensor(1.4910, dtype=torch.float64) tensor(-3.0999, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(0.2208, dtype=torch.float64)
13 gae_duplicate tensor(1.4136, dtype=torch.float64) tensor(-2.9399, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.5665, dtype=torch.float64)
12 gae_duplicate tensor(1.6974, dtype=torch.float64) tensor(-3.5292, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.4922, dtype=torch.float64)
11 gae_duplicate tensor(1.8502, dtype=torch.float64) tensor(-3.8479, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(-0.5358, dtype=torch.float64)
10 gae_duplicate tensor(0.9443, dtype=torch.float64) tensor(-1.9639, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(0.7641, dtype=torch.float64)
9 gae_duplicate tensor(1.5195, dtype=torch.float64) tensor(-3.1599, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9310, dtype=torch.float64) delta_t tensor(-1.8778, dtype=torch.float64)
8 gae_duplicate tensor(-0.6622, dtype=torch.float64) tensor(1.3769, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1281, dtype=torch.float64) delta_t tensor(-1.6235, dtype=torch.float64)
7 gae_duplicate tensor(-2.1532, dtype=torch.float64) tensor(4.4781, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0635, dtype=torch.float64) delta_t tensor(-1.1629, dtype=torch.float64)
6 gae_duplicate tensor(-2.8855, dtype=torch.float64) tensor(5.9995, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9988, dtype=torch.float64) delta_t tensor(-0.0016, dtype=torch.float64)
5 gae_duplicate tensor(-2.3100, dtype=torch.float64) tensor(4.8038, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.6502, dtype=torch.float64) delta_t tensor(-5.3098, dtype=torch.float64)
4 gae_duplicate tensor(-7.1578, dtype=torch.float64) tensor(14.8835, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2196, dtype=torch.float64) delta_t tensor(1.0752, dtype=torch.float64)
3 gae_duplicate tensor(-4.6510, dtype=torch.float64) tensor(9.6710, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3521, dtype=torch.float64) delta_t tensor(-0.6242, dtype=torch.float64)
2 gae_duplicate tensor(-4.3450, dtype=torch.float64) tensor(9.0346, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-229.10284423828125
value loss:198.88998413085938
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.530471324920654 seconds
19 rew tensor(0.8342, dtype=torch.float64) delta_t tensor(-1.8871, dtype=torch.float64)
19 gae_duplicate tensor(-1.8871, dtype=torch.float64) tensor(3.9244, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7034, dtype=torch.float64) delta_t tensor(0.0840, dtype=torch.float64)
18 gae_duplicate tensor(-1.4257, dtype=torch.float64) tensor(2.9645, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5725, dtype=torch.float64) delta_t tensor(0.0425, dtype=torch.float64)
17 gae_duplicate tensor(-1.0981, dtype=torch.float64) tensor(2.2829, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3759, dtype=torch.float64) delta_t tensor(-0.1455, dtype=torch.float64)
16 gae_duplicate tensor(-1.0239, dtype=torch.float64) tensor(2.1293, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.2142, dtype=torch.float64) delta_t tensor(0.0902, dtype=torch.float64)
15 gae_duplicate tensor(-0.7289, dtype=torch.float64) tensor(1.5158, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5069, dtype=torch.float64) delta_t tensor(-0.2579, dtype=torch.float64)
14 gae_duplicate tensor(-0.8410, dtype=torch.float64) tensor(1.7492, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.4461, dtype=torch.float64)
13 gae_duplicate tensor(-0.2268, dtype=torch.float64) tensor(0.4716, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(0.4042, dtype=torch.float64)
12 gae_duplicate tensor(0.2228, dtype=torch.float64) tensor(-0.4633, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6394, dtype=torch.float64) delta_t tensor(0.8513, dtype=torch.float64)
11 gae_duplicate tensor(1.0295, dtype=torch.float64) tensor(-2.1406, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5086, dtype=torch.float64) delta_t tensor(-1.0279, dtype=torch.float64)
10 gae_duplicate tensor(-0.2043, dtype=torch.float64) tensor(0.4248, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8669, dtype=torch.float64) delta_t tensor(-1.4953, dtype=torch.float64)
9 gae_duplicate tensor(-1.6587, dtype=torch.float64) tensor(3.4495, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3117, dtype=torch.float64) delta_t tensor(-0.2456, dtype=torch.float64)
8 gae_duplicate tensor(-1.5726, dtype=torch.float64) tensor(3.2700, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1944, dtype=torch.float64) delta_t tensor(-1.6245, dtype=torch.float64)
7 gae_duplicate tensor(-2.8826, dtype=torch.float64) tensor(5.9945, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.1777, dtype=torch.float64) delta_t tensor(0.5551, dtype=torch.float64)
6 gae_duplicate tensor(-1.7510, dtype=torch.float64) tensor(3.6408, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1327, dtype=torch.float64) delta_t tensor(-1.1945, dtype=torch.float64)
5 gae_duplicate tensor(-2.5953, dtype=torch.float64) tensor(5.3964, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5927, dtype=torch.float64) delta_t tensor(-2.0122, dtype=torch.float64)
4 gae_duplicate tensor(-4.0884, dtype=torch.float64) tensor(8.5021, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2822, dtype=torch.float64) delta_t tensor(0.4450, dtype=torch.float64)
3 gae_duplicate tensor(-2.8257, dtype=torch.float64) tensor(5.8763, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4791, dtype=torch.float64) delta_t tensor(-0.5416, dtype=torch.float64)
2 gae_duplicate tensor(-2.8021, dtype=torch.float64) tensor(5.8265, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-330.0120544433594
value loss:99.26365661621094
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.2438)
ToM Target loss= tensor(305.3102)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.380967855453491 seconds
19 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(-1.7551, dtype=torch.float64)
19 gae_duplicate tensor(-1.7551, dtype=torch.float64) tensor(3.6499, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.3377, dtype=torch.float64)
18 gae_duplicate tensor(-1.0663, dtype=torch.float64) tensor(2.2176, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.3311, dtype=torch.float64)
17 gae_duplicate tensor(-0.5219, dtype=torch.float64) tensor(1.0852, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.3788, dtype=torch.float64)
16 gae_duplicate tensor(-0.0388, dtype=torch.float64) tensor(0.0806, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.8045, dtype=torch.float64)
15 gae_duplicate tensor(0.7735, dtype=torch.float64) tensor(-1.6083, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.4438, dtype=torch.float64)
14 gae_duplicate tensor(1.0626, dtype=torch.float64) tensor(-2.2095, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(0.4920, dtype=torch.float64)
13 gae_duplicate tensor(1.3420, dtype=torch.float64) tensor(-2.7905, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9027, dtype=torch.float64) delta_t tensor(0.4052, dtype=torch.float64)
12 gae_duplicate tensor(1.4789, dtype=torch.float64) tensor(-3.0749, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9032, dtype=torch.float64) delta_t tensor(0.4545, dtype=torch.float64)
11 gae_duplicate tensor(1.6376, dtype=torch.float64) tensor(-3.4045, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9038, dtype=torch.float64) delta_t tensor(0.0175, dtype=torch.float64)
10 gae_duplicate tensor(1.3275, dtype=torch.float64) tensor(-2.7603, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5111, dtype=torch.float64) delta_t tensor(0.0315, dtype=torch.float64)
9 gae_duplicate tensor(1.0936, dtype=torch.float64) tensor(-2.2734, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1837, dtype=torch.float64) delta_t tensor(1.1987, dtype=torch.float64)
8 gae_duplicate tensor(2.0736, dtype=torch.float64) tensor(-4.3121, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6022, dtype=torch.float64) delta_t tensor(-1.5488, dtype=torch.float64)
7 gae_duplicate tensor(0.1101, dtype=torch.float64) tensor(-0.2288, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3883, dtype=torch.float64) delta_t tensor(-0.1337, dtype=torch.float64)
6 gae_duplicate tensor(-0.0457, dtype=torch.float64) tensor(0.0950, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6517, dtype=torch.float64) delta_t tensor(-1.1203, dtype=torch.float64)
5 gae_duplicate tensor(-1.1568, dtype=torch.float64) tensor(2.4054, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2436, dtype=torch.float64) delta_t tensor(-3.4746, dtype=torch.float64)
4 gae_duplicate tensor(-4.4001, dtype=torch.float64) tensor(9.1504, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6073, dtype=torch.float64) delta_t tensor(0.9575, dtype=torch.float64)
3 gae_duplicate tensor(-2.5626, dtype=torch.float64) tensor(5.3283, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7231, dtype=torch.float64) delta_t tensor(-1.6220, dtype=torch.float64)
2 gae_duplicate tensor(-3.6720, dtype=torch.float64) tensor(7.6379, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-55.05024719238281
value loss:91.36576843261719
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.397170782089233 seconds
19 rew tensor(0.6386, dtype=torch.float64) delta_t tensor(-1.6656, dtype=torch.float64)
19 gae_duplicate tensor(-1.6656, dtype=torch.float64) tensor(3.4625, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4420, dtype=torch.float64) delta_t tensor(-0.1761, dtype=torch.float64)
18 gae_duplicate tensor(-1.5086, dtype=torch.float64) tensor(3.1374, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.0487, dtype=torch.float64) delta_t tensor(-0.3255, dtype=torch.float64)
17 gae_duplicate tensor(-1.5324, dtype=torch.float64) tensor(3.1854, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6388, dtype=torch.float64) delta_t tensor(0.7583, dtype=torch.float64)
16 gae_duplicate tensor(-0.4676, dtype=torch.float64) tensor(0.9720, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5080, dtype=torch.float64) delta_t tensor(0.3934, dtype=torch.float64)
15 gae_duplicate tensor(0.0193, dtype=torch.float64) tensor(-0.0402, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1805, dtype=torch.float64) delta_t tensor(0.1414, dtype=torch.float64)
14 gae_duplicate tensor(0.1569, dtype=torch.float64) tensor(-0.3263, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8357, dtype=torch.float64) delta_t tensor(0.4284, dtype=torch.float64)
13 gae_duplicate tensor(0.5539, dtype=torch.float64) tensor(-1.1520, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(-0.3736, dtype=torch.float64)
12 gae_duplicate tensor(0.0695, dtype=torch.float64) tensor(-0.1446, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8367, dtype=torch.float64) delta_t tensor(0.4605, dtype=torch.float64)
11 gae_duplicate tensor(0.5162, dtype=torch.float64) tensor(-1.0732, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8372, dtype=torch.float64) delta_t tensor(0.4990, dtype=torch.float64)
10 gae_duplicate tensor(0.9119, dtype=torch.float64) tensor(-1.8965, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4722, dtype=torch.float64) delta_t tensor(-1.2789, dtype=torch.float64)
9 gae_duplicate tensor(-0.5493, dtype=torch.float64) tensor(1.1420, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6688, dtype=torch.float64) delta_t tensor(-1.1183, dtype=torch.float64)
8 gae_duplicate tensor(-1.5577, dtype=torch.float64) tensor(3.2388, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7346, dtype=torch.float64) delta_t tensor(-1.1519, dtype=torch.float64)
7 gae_duplicate tensor(-2.3981, dtype=torch.float64) tensor(4.9872, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5386, dtype=torch.float64) delta_t tensor(-0.2859, dtype=torch.float64)
6 gae_duplicate tensor(-2.2044, dtype=torch.float64) tensor(4.5844, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7167, dtype=torch.float64) delta_t tensor(0.8940, dtype=torch.float64)
5 gae_duplicate tensor(-0.8694, dtype=torch.float64) tensor(1.8082, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0285, dtype=torch.float64) delta_t tensor(-4.3050, dtype=torch.float64)
4 gae_duplicate tensor(-5.0006, dtype=torch.float64) tensor(10.3973, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2811, dtype=torch.float64) delta_t tensor(0.0972, dtype=torch.float64)
3 gae_duplicate tensor(-3.9032, dtype=torch.float64) tensor(8.1156, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3468, dtype=torch.float64) delta_t tensor(0.8674, dtype=torch.float64)
2 gae_duplicate tensor(-2.2552, dtype=torch.float64) tensor(4.6890, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-271.6446838378906
value loss:102.70967102050781
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.355309247970581 seconds
19 rew tensor(0.7067, dtype=torch.float64) delta_t tensor(-1.0750, dtype=torch.float64)
19 gae_duplicate tensor(-1.0750, dtype=torch.float64) tensor(2.2352, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6415, dtype=torch.float64) delta_t tensor(0.3242, dtype=torch.float64)
18 gae_duplicate tensor(-0.5358, dtype=torch.float64) tensor(1.1141, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3795, dtype=torch.float64) delta_t tensor(-0.1009, dtype=torch.float64)
17 gae_duplicate tensor(-0.5296, dtype=torch.float64) tensor(1.1014, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.1447, dtype=torch.float64) delta_t tensor(-0.7321, dtype=torch.float64)
16 gae_duplicate tensor(-1.1558, dtype=torch.float64) tensor(2.4037, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.9966, dtype=torch.float64) delta_t tensor(-0.5866, dtype=torch.float64)
15 gae_duplicate tensor(-1.5113, dtype=torch.float64) tensor(3.1430, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9030, dtype=torch.float64) delta_t tensor(0.6510, dtype=torch.float64)
14 gae_duplicate tensor(-0.5580, dtype=torch.float64) tensor(1.1604, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8380, dtype=torch.float64) delta_t tensor(0.4626, dtype=torch.float64)
13 gae_duplicate tensor(0.0162, dtype=torch.float64) tensor(-0.0336, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8384, dtype=torch.float64) delta_t tensor(1.1597, dtype=torch.float64)
12 gae_duplicate tensor(1.1727, dtype=torch.float64) tensor(-2.4394, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7079, dtype=torch.float64) delta_t tensor(0.7745, dtype=torch.float64)
11 gae_duplicate tensor(1.7126, dtype=torch.float64) tensor(-3.5608, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4462, dtype=torch.float64) delta_t tensor(-1.4776, dtype=torch.float64)
10 gae_duplicate tensor(-0.1075, dtype=torch.float64) tensor(0.2235, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7977, dtype=torch.float64) delta_t tensor(-1.0347, dtype=torch.float64)
9 gae_duplicate tensor(-1.1207, dtype=torch.float64) tensor(2.3308, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5113, dtype=torch.float64) delta_t tensor(-0.0005, dtype=torch.float64)
8 gae_duplicate tensor(-0.8971, dtype=torch.float64) tensor(1.8652, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5831, dtype=torch.float64) delta_t tensor(-2.0648, dtype=torch.float64)
7 gae_duplicate tensor(-2.7825, dtype=torch.float64) tensor(5.7852, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4716, dtype=torch.float64) delta_t tensor(0.0067, dtype=torch.float64)
6 gae_duplicate tensor(-2.2192, dtype=torch.float64) tensor(4.6142, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9122, dtype=torch.float64) delta_t tensor(-1.1991, dtype=torch.float64)
5 gae_duplicate tensor(-2.9745, dtype=torch.float64) tensor(6.1861, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8980, dtype=torch.float64) delta_t tensor(-1.2089, dtype=torch.float64)
4 gae_duplicate tensor(-3.5885, dtype=torch.float64) tensor(7.4631, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3451, dtype=torch.float64) delta_t tensor(0.3848, dtype=torch.float64)
3 gae_duplicate tensor(-2.4861, dtype=torch.float64) tensor(5.1676, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4765, dtype=torch.float64) delta_t tensor(-0.5091, dtype=torch.float64)
2 gae_duplicate tensor(-2.4980, dtype=torch.float64) tensor(5.1924, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-264.8360290527344
value loss:88.27185821533203
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.446558952331543 seconds
19 rew tensor(0.7738, dtype=torch.float64) delta_t tensor(-1.1025, dtype=torch.float64)
19 gae_duplicate tensor(-1.1025, dtype=torch.float64) tensor(2.2923, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7086, dtype=torch.float64) delta_t tensor(0.3311, dtype=torch.float64)
18 gae_duplicate tensor(-0.5509, dtype=torch.float64) tensor(1.1457, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5122, dtype=torch.float64) delta_t tensor(0.1475, dtype=torch.float64)
17 gae_duplicate tensor(-0.2932, dtype=torch.float64) tensor(0.6096, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.0121, dtype=torch.float64) delta_t tensor(-0.5488, dtype=torch.float64)
16 gae_duplicate tensor(-0.7833, dtype=torch.float64) tensor(1.6287, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7987, dtype=torch.float64) delta_t tensor(-0.2090, dtype=torch.float64)
15 gae_duplicate tensor(-0.8357, dtype=torch.float64) tensor(1.7371, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9049, dtype=torch.float64) delta_t tensor(0.6979, dtype=torch.float64)
14 gae_duplicate tensor(0.0294, dtype=torch.float64) tensor(-0.0611, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8399, dtype=torch.float64) delta_t tensor(0.3468, dtype=torch.float64)
13 gae_duplicate tensor(0.3703, dtype=torch.float64) tensor(-0.7704, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7748, dtype=torch.float64) delta_t tensor(1.7799, dtype=torch.float64)
12 gae_duplicate tensor(2.0762, dtype=torch.float64) tensor(-4.3167, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8407, dtype=torch.float64) delta_t tensor(0.6259, dtype=torch.float64)
11 gae_duplicate tensor(2.2869, dtype=torch.float64) tensor(-4.7548, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7102, dtype=torch.float64) delta_t tensor(-1.0651, dtype=torch.float64)
10 gae_duplicate tensor(0.7644, dtype=torch.float64) tensor(-1.5897, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7961, dtype=torch.float64) delta_t tensor(-1.3563, dtype=torch.float64)
9 gae_duplicate tensor(-0.7448, dtype=torch.float64) tensor(1.5485, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8620, dtype=torch.float64) delta_t tensor(-1.2850, dtype=torch.float64)
8 gae_duplicate tensor(-1.8808, dtype=torch.float64) tensor(3.9116, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4473, dtype=torch.float64) delta_t tensor(0.0986, dtype=torch.float64)
7 gae_duplicate tensor(-1.4060, dtype=torch.float64) tensor(2.9250, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6656, dtype=torch.float64) delta_t tensor(-0.8915, dtype=torch.float64)
6 gae_duplicate tensor(-2.0163, dtype=torch.float64) tensor(4.1933, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5824, dtype=torch.float64) delta_t tensor(1.6567, dtype=torch.float64)
5 gae_duplicate tensor(0.0436, dtype=torch.float64) tensor(-0.0908, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0250, dtype=torch.float64) delta_t tensor(-3.3678, dtype=torch.float64)
4 gae_duplicate tensor(-3.3329, dtype=torch.float64) tensor(6.9296, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1456, dtype=torch.float64) delta_t tensor(1.1886, dtype=torch.float64)
3 gae_duplicate tensor(-1.4777, dtype=torch.float64) tensor(3.0732, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2769, dtype=torch.float64) delta_t tensor(-1.5340, dtype=torch.float64)
2 gae_duplicate tensor(-2.7161, dtype=torch.float64) tensor(5.6471, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-145.4716796875
value loss:65.97733306884766
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.238487720489502 seconds
19 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(-0.2238, dtype=torch.float64)
19 gae_duplicate tensor(-0.2238, dtype=torch.float64) tensor(0.4651, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9047, dtype=torch.float64) delta_t tensor(0.6791, dtype=torch.float64)
18 gae_duplicate tensor(0.5001, dtype=torch.float64) tensor(-1.0400, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9052, dtype=torch.float64) delta_t tensor(0.2770, dtype=torch.float64)
17 gae_duplicate tensor(0.6771, dtype=torch.float64) tensor(-1.4081, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9057, dtype=torch.float64) delta_t tensor(0.4783, dtype=torch.float64)
16 gae_duplicate tensor(1.0199, dtype=torch.float64) tensor(-2.1212, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9063, dtype=torch.float64) delta_t tensor(0.5097, dtype=torch.float64)
15 gae_duplicate tensor(1.3256, dtype=torch.float64) tensor(-2.7570, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9068, dtype=torch.float64) delta_t tensor(0.4227, dtype=torch.float64)
14 gae_duplicate tensor(1.4832, dtype=torch.float64) tensor(-3.0847, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9073, dtype=torch.float64) delta_t tensor(0.4949, dtype=torch.float64)
13 gae_duplicate tensor(1.6814, dtype=torch.float64) tensor(-3.4959, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9078, dtype=torch.float64) delta_t tensor(0.5696, dtype=torch.float64)
12 gae_duplicate tensor(1.9147, dtype=torch.float64) tensor(-3.9821, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9083, dtype=torch.float64) delta_t tensor(0.6198, dtype=torch.float64)
11 gae_duplicate tensor(2.1515, dtype=torch.float64) tensor(-4.4760, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7776, dtype=torch.float64) delta_t tensor(0.3823, dtype=torch.float64)
10 gae_duplicate tensor(2.1036, dtype=torch.float64) tensor(-4.3762, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5811, dtype=torch.float64) delta_t tensor(0.3660, dtype=torch.float64)
9 gae_duplicate tensor(2.0488, dtype=torch.float64) tensor(-4.2598, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3189, dtype=torch.float64) delta_t tensor(1.4630, dtype=torch.float64)
8 gae_duplicate tensor(3.1020, dtype=torch.float64) tensor(-6.4534, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0090, dtype=torch.float64) delta_t tensor(1.7651, dtype=torch.float64)
7 gae_duplicate tensor(4.2468, dtype=torch.float64) tensor(-8.8295, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8614, dtype=torch.float64) delta_t tensor(-0.4548, dtype=torch.float64)
6 gae_duplicate tensor(2.9426, dtype=torch.float64) tensor(-6.1161, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7963, dtype=torch.float64) delta_t tensor(-0.3996, dtype=torch.float64)
5 gae_duplicate tensor(1.9545, dtype=torch.float64) tensor(-4.0637, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5835, dtype=torch.float64) delta_t tensor(-0.6985, dtype=torch.float64)
4 gae_duplicate tensor(0.8651, dtype=torch.float64) tensor(-1.7992, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4540, dtype=torch.float64) delta_t tensor(-0.8927, dtype=torch.float64)
3 gae_duplicate tensor(-0.2006, dtype=torch.float64) tensor(0.4171, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3898, dtype=torch.float64) delta_t tensor(-1.9992, dtype=torch.float64)
2 gae_duplicate tensor(-2.1596, dtype=torch.float64) tensor(4.4886, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:316.2309875488281
value loss:106.63584899902344
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.3479)
ToM Target loss= tensor(305.7761)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.440711975097656 seconds
19 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.4659, dtype=torch.float64)
19 gae_duplicate tensor(0.4659, dtype=torch.float64) tensor(-0.9687, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.0805, dtype=torch.float64)
18 gae_duplicate tensor(0.4532, dtype=torch.float64) tensor(-0.9423, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.8343, dtype=torch.float64)
17 gae_duplicate tensor(1.1969, dtype=torch.float64) tensor(-2.4892, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.5046, dtype=torch.float64)
16 gae_duplicate tensor(1.4621, dtype=torch.float64) tensor(-3.0407, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(0.3588, dtype=torch.float64)
15 gae_duplicate tensor(1.5285, dtype=torch.float64) tensor(-3.1770, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9024, dtype=torch.float64) delta_t tensor(0.6070, dtype=torch.float64)
14 gae_duplicate tensor(1.8298, dtype=torch.float64) tensor(-3.8043, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9029, dtype=torch.float64) delta_t tensor(0.4186, dtype=torch.float64)
13 gae_duplicate tensor(1.8824, dtype=torch.float64) tensor(-3.9149, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9035, dtype=torch.float64) delta_t tensor(0.5672, dtype=torch.float64)
12 gae_duplicate tensor(2.0731, dtype=torch.float64) tensor(-4.3103, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(0.3733, dtype=torch.float64)
11 gae_duplicate tensor(2.0318, dtype=torch.float64) tensor(-4.2231, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9045, dtype=torch.float64) delta_t tensor(0.5757, dtype=torch.float64)
10 gae_duplicate tensor(2.2011, dtype=torch.float64) tensor(-4.5751, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9050, dtype=torch.float64) delta_t tensor(0.6189, dtype=torch.float64)
9 gae_duplicate tensor(2.3798, dtype=torch.float64) tensor(-4.9493, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8591, dtype=torch.float64) delta_t tensor(-0.9260, dtype=torch.float64)
8 gae_duplicate tensor(0.9778, dtype=torch.float64) tensor(-2.0336, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3167, dtype=torch.float64) delta_t tensor(-0.1655, dtype=torch.float64)
7 gae_duplicate tensor(0.6167, dtype=torch.float64) tensor(-1.2818, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.8391, dtype=torch.float64) delta_t tensor(-1.9641, dtype=torch.float64)
6 gae_duplicate tensor(-1.4707, dtype=torch.float64) tensor(3.0596, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8609, dtype=torch.float64) delta_t tensor(2.5241, dtype=torch.float64)
5 gae_duplicate tensor(1.3475, dtype=torch.float64) tensor(-2.8017, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.3262, dtype=torch.float64) delta_t tensor(-4.3474, dtype=torch.float64)
4 gae_duplicate tensor(-3.2694, dtype=torch.float64) tensor(6.7954, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2772, dtype=torch.float64) delta_t tensor(0.7582, dtype=torch.float64)
3 gae_duplicate tensor(-1.8573, dtype=torch.float64) tensor(3.8617, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4087, dtype=torch.float64) delta_t tensor(0.0379, dtype=torch.float64)
2 gae_duplicate tensor(-1.4479, dtype=torch.float64) tensor(3.0104, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:153.58729553222656
value loss:80.55746459960938
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.555289030075073 seconds
19 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.1853, dtype=torch.float64)
19 gae_duplicate tensor(0.1853, dtype=torch.float64) tensor(-0.3853, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(0.1506, dtype=torch.float64)
18 gae_duplicate tensor(0.2988, dtype=torch.float64) tensor(-0.6212, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8358, dtype=torch.float64) delta_t tensor(0.5304, dtype=torch.float64)
17 gae_duplicate tensor(0.7695, dtype=torch.float64) tensor(-1.5998, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8363, dtype=torch.float64) delta_t tensor(0.5994, dtype=torch.float64)
16 gae_duplicate tensor(1.2150, dtype=torch.float64) tensor(-2.5269, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8367, dtype=torch.float64) delta_t tensor(0.6289, dtype=torch.float64)
15 gae_duplicate tensor(1.6009, dtype=torch.float64) tensor(-3.3295, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6407, dtype=torch.float64) delta_t tensor(0.2534, dtype=torch.float64)
14 gae_duplicate tensor(1.5341, dtype=torch.float64) tensor(-3.1886, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0790, dtype=torch.float64) delta_t tensor(-0.3452, dtype=torch.float64)
13 gae_duplicate tensor(0.8821, dtype=torch.float64) tensor(-1.8347, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2482, dtype=torch.float64) delta_t tensor(-0.2454, dtype=torch.float64)
12 gae_duplicate tensor(0.4603, dtype=torch.float64) tensor(-0.9573, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8370, dtype=torch.float64) delta_t tensor(3.4434, dtype=torch.float64)
11 gae_duplicate tensor(3.8117, dtype=torch.float64) tensor(-7.9249, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7066, dtype=torch.float64) delta_t tensor(0.7963, dtype=torch.float64)
10 gae_duplicate tensor(3.8456, dtype=torch.float64) tensor(-7.9930, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5107, dtype=torch.float64) delta_t tensor(0.6941, dtype=torch.float64)
9 gae_duplicate tensor(3.7706, dtype=torch.float64) tensor(-7.8420, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0775, dtype=torch.float64) delta_t tensor(0.6150, dtype=torch.float64)
8 gae_duplicate tensor(3.6315, dtype=torch.float64) tensor(-7.5527, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7068, dtype=torch.float64) delta_t tensor(0.8207, dtype=torch.float64)
7 gae_duplicate tensor(3.7259, dtype=torch.float64) tensor(-7.7464, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0574, dtype=torch.float64) delta_t tensor(-0.1304, dtype=torch.float64)
6 gae_duplicate tensor(2.8503, dtype=torch.float64) tensor(-5.9281, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5353, dtype=torch.float64) delta_t tensor(-1.0583, dtype=torch.float64)
5 gae_duplicate tensor(1.2219, dtype=torch.float64) tensor(-2.5413, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7770, dtype=torch.float64) delta_t tensor(-0.0728, dtype=torch.float64)
4 gae_duplicate tensor(0.9048, dtype=torch.float64) tensor(-1.8811, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5831, dtype=torch.float64) delta_t tensor(-2.0844, dtype=torch.float64)
3 gae_duplicate tensor(-1.3606, dtype=torch.float64) tensor(2.8287, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3886, dtype=torch.float64) delta_t tensor(-0.4164, dtype=torch.float64)
2 gae_duplicate tensor(-1.5049, dtype=torch.float64) tensor(3.1288, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:346.249755859375
value loss:139.88226318359375
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.192962884902954 seconds
19 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(-0.7559, dtype=torch.float64)
19 gae_duplicate tensor(-0.7559, dtype=torch.float64) tensor(1.5715, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.6975, dtype=torch.float64)
18 gae_duplicate tensor(0.0928, dtype=torch.float64) tensor(-0.1929, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.5701, dtype=torch.float64)
17 gae_duplicate tensor(0.6444, dtype=torch.float64) tensor(-1.3402, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.7839, dtype=torch.float64)
16 gae_duplicate tensor(1.2994, dtype=torch.float64) tensor(-2.7025, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(0.6410, dtype=torch.float64)
15 gae_duplicate tensor(1.6805, dtype=torch.float64) tensor(-3.4952, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9024, dtype=torch.float64) delta_t tensor(0.6470, dtype=torch.float64)
14 gae_duplicate tensor(1.9914, dtype=torch.float64) tensor(-4.1403, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9029, dtype=torch.float64) delta_t tensor(0.5892, dtype=torch.float64)
13 gae_duplicate tensor(2.1823, dtype=torch.float64) tensor(-4.5372, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9034, dtype=torch.float64) delta_t tensor(0.7267, dtype=torch.float64)
12 gae_duplicate tensor(2.4726, dtype=torch.float64) tensor(-5.1424, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9039, dtype=torch.float64) delta_t tensor(0.3612, dtype=torch.float64)
11 gae_duplicate tensor(2.3393, dtype=torch.float64) tensor(-4.8667, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9044, dtype=torch.float64) delta_t tensor(3.5914, dtype=torch.float64)
10 gae_duplicate tensor(5.4628, dtype=torch.float64) tensor(-11.3540, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4467, dtype=torch.float64) delta_t tensor(0.3023, dtype=torch.float64)
9 gae_duplicate tensor(4.6726, dtype=torch.float64) tensor(-9.7181, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0543, dtype=torch.float64) delta_t tensor(0.3503, dtype=torch.float64)
8 gae_duplicate tensor(4.0884, dtype=torch.float64) tensor(-8.5056, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4690, dtype=torch.float64) delta_t tensor(-3.3586, dtype=torch.float64)
7 gae_duplicate tensor(-0.0879, dtype=torch.float64) tensor(0.1829, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1885, dtype=torch.float64) delta_t tensor(2.3268, dtype=torch.float64)
6 gae_duplicate tensor(2.2565, dtype=torch.float64) tensor(-4.6930, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3856, dtype=torch.float64) delta_t tensor(-0.6074, dtype=torch.float64)
5 gae_duplicate tensor(1.1978, dtype=torch.float64) tensor(-2.4912, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0411, dtype=torch.float64) delta_t tensor(-1.3201, dtype=torch.float64)
4 gae_duplicate tensor(-0.3618, dtype=torch.float64) tensor(0.7523, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5859, dtype=torch.float64) delta_t tensor(-1.1305, dtype=torch.float64)
3 gae_duplicate tensor(-1.4200, dtype=torch.float64) tensor(2.9523, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6704, dtype=torch.float64) delta_t tensor(-0.1628, dtype=torch.float64)
2 gae_duplicate tensor(-1.2988, dtype=torch.float64) tensor(2.7004, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:328.9971618652344
value loss:156.87115478515625
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5478270053863525 seconds
19 rew tensor(0.8974, dtype=torch.float64) delta_t tensor(-0.4528, dtype=torch.float64)
19 gae_duplicate tensor(-0.4528, dtype=torch.float64) tensor(0.9417, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8978, dtype=torch.float64) delta_t tensor(0.3865, dtype=torch.float64)
18 gae_duplicate tensor(0.0243, dtype=torch.float64) tensor(-0.0505, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8983, dtype=torch.float64) delta_t tensor(2.0996, dtype=torch.float64)
17 gae_duplicate tensor(2.1190, dtype=torch.float64) tensor(-4.4042, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.7892, dtype=torch.float64)
16 gae_duplicate tensor(2.4844, dtype=torch.float64) tensor(-5.1670, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.8659, dtype=torch.float64)
15 gae_duplicate tensor(2.8534, dtype=torch.float64) tensor(-5.9326, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.6946, dtype=torch.float64)
14 gae_duplicate tensor(2.9773, dtype=torch.float64) tensor(-6.1902, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.5650, dtype=torch.float64)
13 gae_duplicate tensor(2.9469, dtype=torch.float64) tensor(-6.1269, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(0.0133, dtype=torch.float64)
12 gae_duplicate tensor(2.3708, dtype=torch.float64) tensor(-4.9291, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.5655, dtype=torch.float64)
11 gae_duplicate tensor(2.4621, dtype=torch.float64) tensor(-5.1206, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7060, dtype=torch.float64) delta_t tensor(0.4118, dtype=torch.float64)
10 gae_duplicate tensor(2.3815, dtype=torch.float64) tensor(-4.9530, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7941, dtype=torch.float64) delta_t tensor(-1.1777, dtype=torch.float64)
9 gae_duplicate tensor(0.7275, dtype=torch.float64) tensor(-1.5130, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7944, dtype=torch.float64) delta_t tensor(-1.0200, dtype=torch.float64)
8 gae_duplicate tensor(-0.4380, dtype=torch.float64) tensor(0.9106, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2731, dtype=torch.float64) delta_t tensor(-0.7517, dtype=torch.float64)
7 gae_duplicate tensor(-1.1021, dtype=torch.float64) tensor(2.2922, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5340, dtype=torch.float64) delta_t tensor(-0.6509, dtype=torch.float64)
6 gae_duplicate tensor(-1.5326, dtype=torch.float64) tensor(3.1864, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4468, dtype=torch.float64) delta_t tensor(0.3869, dtype=torch.float64)
5 gae_duplicate tensor(-0.8392, dtype=torch.float64) tensor(1.7448, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.3173, dtype=torch.float64) delta_t tensor(-2.5219, dtype=torch.float64)
4 gae_duplicate tensor(-3.1933, dtype=torch.float64) tensor(6.6413, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2129, dtype=torch.float64) delta_t tensor(0.2694, dtype=torch.float64)
3 gae_duplicate tensor(-2.2852, dtype=torch.float64) tensor(4.7496, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2785, dtype=torch.float64) delta_t tensor(-0.5088, dtype=torch.float64)
2 gae_duplicate tensor(-2.3370, dtype=torch.float64) tensor(4.8571, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:113.25740051269531
value loss:119.67344665527344
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.551020860671997 seconds
19 rew tensor(0.8962, dtype=torch.float64) delta_t tensor(-1.0137, dtype=torch.float64)
19 gae_duplicate tensor(-1.0137, dtype=torch.float64) tensor(2.1082, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8967, dtype=torch.float64) delta_t tensor(0.4193, dtype=torch.float64)
18 gae_duplicate tensor(-0.3917, dtype=torch.float64) tensor(0.8143, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8971, dtype=torch.float64) delta_t tensor(3.7336, dtype=torch.float64)
17 gae_duplicate tensor(3.4203, dtype=torch.float64) tensor(-7.1112, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8976, dtype=torch.float64) delta_t tensor(1.2031, dtype=torch.float64)
16 gae_duplicate tensor(3.9394, dtype=torch.float64) tensor(-8.1904, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8981, dtype=torch.float64) delta_t tensor(1.9461, dtype=torch.float64)
15 gae_duplicate tensor(5.0976, dtype=torch.float64) tensor(-10.6019, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(1.2907, dtype=torch.float64)
14 gae_duplicate tensor(5.3687, dtype=torch.float64) tensor(-11.1695, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(1.3716, dtype=torch.float64)
13 gae_duplicate tensor(5.6666, dtype=torch.float64) tensor(-11.7854, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.9808, dtype=torch.float64)
12 gae_duplicate tensor(5.5141, dtype=torch.float64) tensor(-11.4680, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(1.2785, dtype=torch.float64)
11 gae_duplicate tensor(5.6898, dtype=torch.float64) tensor(-11.8295, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(-1.7248, dtype=torch.float64)
10 gae_duplicate tensor(2.8270, dtype=torch.float64) tensor(-5.8814, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.5547, dtype=torch.float64) delta_t tensor(-2.8011, dtype=torch.float64)
9 gae_duplicate tensor(-0.5395, dtype=torch.float64) tensor(1.1221, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3399, dtype=torch.float64) delta_t tensor(-0.2649, dtype=torch.float64)
8 gae_duplicate tensor(-0.6965, dtype=torch.float64) tensor(1.4487, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4053, dtype=torch.float64) delta_t tensor(0.9029, dtype=torch.float64)
7 gae_duplicate tensor(0.3457, dtype=torch.float64) tensor(-0.7185, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0138, dtype=torch.float64) delta_t tensor(1.6292, dtype=torch.float64)
6 gae_duplicate tensor(1.9057, dtype=torch.float64) tensor(-3.9623, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9274, dtype=torch.float64) delta_t tensor(-0.1812, dtype=torch.float64)
5 gae_duplicate tensor(1.3434, dtype=torch.float64) tensor(-2.7939, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0584, dtype=torch.float64) delta_t tensor(-0.3544, dtype=torch.float64)
4 gae_duplicate tensor(0.7202, dtype=torch.float64) tensor(-1.4985, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.2337, dtype=torch.float64) delta_t tensor(-2.1440, dtype=torch.float64)
3 gae_duplicate tensor(-1.5678, dtype=torch.float64) tensor(3.2596, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0163, dtype=torch.float64) delta_t tensor(-1.0266, dtype=torch.float64)
2 gae_duplicate tensor(-2.2809, dtype=torch.float64) tensor(4.7421, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:439.97015380859375
value loss:300.89947509765625
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.9185)
ToM Target loss= tensor(305.6734)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.439570188522339 seconds
19 rew tensor(0.8953, dtype=torch.float64) delta_t tensor(-0.5430, dtype=torch.float64)
19 gae_duplicate tensor(-0.5430, dtype=torch.float64) tensor(1.1294, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8958, dtype=torch.float64) delta_t tensor(0.3278, dtype=torch.float64)
18 gae_duplicate tensor(-0.1066, dtype=torch.float64) tensor(0.2217, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8963, dtype=torch.float64) delta_t tensor(0.4890, dtype=torch.float64)
17 gae_duplicate tensor(0.4037, dtype=torch.float64) tensor(-0.8391, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8968, dtype=torch.float64) delta_t tensor(0.6149, dtype=torch.float64)
16 gae_duplicate tensor(0.9378, dtype=torch.float64) tensor(-1.9499, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8972, dtype=torch.float64) delta_t tensor(0.7206, dtype=torch.float64)
15 gae_duplicate tensor(1.4709, dtype=torch.float64) tensor(-3.0591, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8977, dtype=torch.float64) delta_t tensor(0.5131, dtype=torch.float64)
14 gae_duplicate tensor(1.6898, dtype=torch.float64) tensor(-3.5143, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8982, dtype=torch.float64) delta_t tensor(0.6173, dtype=torch.float64)
13 gae_duplicate tensor(1.9691, dtype=torch.float64) tensor(-4.0940, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(0.3925, dtype=torch.float64)
12 gae_duplicate tensor(1.9678, dtype=torch.float64) tensor(-4.0901, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.5322, dtype=torch.float64)
11 gae_duplicate tensor(2.1065, dtype=torch.float64) tensor(-4.3796, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.1711, dtype=torch.float64)
10 gae_duplicate tensor(1.8562, dtype=torch.float64) tensor(-3.8593, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5738, dtype=torch.float64) delta_t tensor(0.9396, dtype=torch.float64)
9 gae_duplicate tensor(2.4246, dtype=torch.float64) tensor(-5.0410, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2477, dtype=torch.float64) delta_t tensor(-0.8751, dtype=torch.float64)
8 gae_duplicate tensor(1.0646, dtype=torch.float64) tensor(-2.2134, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0521, dtype=torch.float64) delta_t tensor(3.3494, dtype=torch.float64)
7 gae_duplicate tensor(4.2011, dtype=torch.float64) tensor(-8.7373, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8608, dtype=torch.float64) delta_t tensor(-0.9373, dtype=torch.float64)
6 gae_duplicate tensor(2.4235, dtype=torch.float64) tensor(-5.0405, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9917, dtype=torch.float64) delta_t tensor(0.3976, dtype=torch.float64)
5 gae_duplicate tensor(2.3365, dtype=torch.float64) tensor(-4.8608, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7095, dtype=torch.float64) delta_t tensor(-1.1742, dtype=torch.float64)
4 gae_duplicate tensor(0.6950, dtype=torch.float64) tensor(-1.4445, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4505, dtype=torch.float64) delta_t tensor(-0.8143, dtype=torch.float64)
3 gae_duplicate tensor(-0.2583, dtype=torch.float64) tensor(0.5369, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1908, dtype=torch.float64) delta_t tensor(-1.6401, dtype=torch.float64)
2 gae_duplicate tensor(-1.8468, dtype=torch.float64) tensor(3.8396, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:283.2482604980469
value loss:92.9308853149414
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.518464088439941 seconds
19 rew tensor(0.7653, dtype=torch.float64) delta_t tensor(-1.1131, dtype=torch.float64)
19 gae_duplicate tensor(-1.1131, dtype=torch.float64) tensor(2.3144, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6353, dtype=torch.float64) delta_t tensor(0.2367, dtype=torch.float64)
18 gae_duplicate tensor(-0.6538, dtype=torch.float64) tensor(1.3598, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5052, dtype=torch.float64) delta_t tensor(0.1740, dtype=torch.float64)
17 gae_duplicate tensor(-0.3490, dtype=torch.float64) tensor(0.7260, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.0157, dtype=torch.float64) delta_t tensor(-0.2576, dtype=torch.float64)
16 gae_duplicate tensor(-0.5368, dtype=torch.float64) tensor(1.1158, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7972, dtype=torch.float64) delta_t tensor(-0.2506, dtype=torch.float64)
15 gae_duplicate tensor(-0.6801, dtype=torch.float64) tensor(1.4140, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8954, dtype=torch.float64) delta_t tensor(0.7289, dtype=torch.float64)
14 gae_duplicate tensor(0.1849, dtype=torch.float64) tensor(-0.3846, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8308, dtype=torch.float64) delta_t tensor(0.5669, dtype=torch.float64)
13 gae_duplicate tensor(0.7148, dtype=torch.float64) tensor(-1.4861, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7661, dtype=torch.float64) delta_t tensor(0.1372, dtype=torch.float64)
12 gae_duplicate tensor(0.7090, dtype=torch.float64) tensor(-1.4745, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8966, dtype=torch.float64) delta_t tensor(0.3836, dtype=torch.float64)
11 gae_duplicate tensor(0.9508, dtype=torch.float64) tensor(-1.9775, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8320, dtype=torch.float64) delta_t tensor(0.3415, dtype=torch.float64)
10 gae_duplicate tensor(1.1022, dtype=torch.float64) tensor(-2.2910, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1853, dtype=torch.float64) delta_t tensor(-1.6457, dtype=torch.float64)
9 gae_duplicate tensor(-0.7640, dtype=torch.float64) tensor(1.5884, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5352, dtype=torch.float64) delta_t tensor(-1.1838, dtype=torch.float64)
8 gae_duplicate tensor(-1.7950, dtype=torch.float64) tensor(3.7320, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7306, dtype=torch.float64) delta_t tensor(-1.1724, dtype=torch.float64)
7 gae_duplicate tensor(-2.6083, dtype=torch.float64) tensor(5.4247, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2754, dtype=torch.float64) delta_t tensor(-0.0698, dtype=torch.float64)
6 gae_duplicate tensor(-2.1565, dtype=torch.float64) tensor(4.4849, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5116, dtype=torch.float64) delta_t tensor(-0.4742, dtype=torch.float64)
5 gae_duplicate tensor(-2.1994, dtype=torch.float64) tensor(4.5729, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0511, dtype=torch.float64) delta_t tensor(-1.6645, dtype=torch.float64)
4 gae_duplicate tensor(-3.4241, dtype=torch.float64) tensor(7.1191, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0840, dtype=torch.float64) delta_t tensor(-0.4720, dtype=torch.float64)
3 gae_duplicate tensor(-3.2113, dtype=torch.float64) tensor(6.6789, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0840, dtype=torch.float64) delta_t tensor(0.7661, dtype=torch.float64)
2 gae_duplicate tensor(-1.8030, dtype=torch.float64) tensor(3.7497, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-221.12364196777344
value loss:76.63485717773438
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.364784002304077 seconds
19 rew tensor(0.8961, dtype=torch.float64) delta_t tensor(-1.2228, dtype=torch.float64)
19 gae_duplicate tensor(-1.2228, dtype=torch.float64) tensor(2.5438, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8965, dtype=torch.float64) delta_t tensor(0.5397, dtype=torch.float64)
18 gae_duplicate tensor(-0.4386, dtype=torch.float64) tensor(0.9116, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8970, dtype=torch.float64) delta_t tensor(0.4866, dtype=torch.float64)
17 gae_duplicate tensor(0.1357, dtype=torch.float64) tensor(-0.2822, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8974, dtype=torch.float64) delta_t tensor(0.4871, dtype=torch.float64)
16 gae_duplicate tensor(0.5956, dtype=torch.float64) tensor(-1.2387, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8979, dtype=torch.float64) delta_t tensor(0.4030, dtype=torch.float64)
15 gae_duplicate tensor(0.8795, dtype=torch.float64) tensor(-1.8296, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.5388, dtype=torch.float64)
14 gae_duplicate tensor(1.2424, dtype=torch.float64) tensor(-2.5837, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.0215, dtype=torch.float64)
13 gae_duplicate tensor(1.0154, dtype=torch.float64) tensor(-2.1111, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.4591, dtype=torch.float64)
12 gae_duplicate tensor(1.2714, dtype=torch.float64) tensor(-2.6434, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6386, dtype=torch.float64) delta_t tensor(0.1895, dtype=torch.float64)
11 gae_duplicate tensor(1.2066, dtype=torch.float64) tensor(-2.5101, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2473, dtype=torch.float64) delta_t tensor(0.6902, dtype=torch.float64)
10 gae_duplicate tensor(1.6555, dtype=torch.float64) tensor(-3.4430, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2473, dtype=torch.float64) delta_t tensor(1.5310, dtype=torch.float64)
9 gae_duplicate tensor(2.8554, dtype=torch.float64) tensor(-5.9369, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2474, dtype=torch.float64) delta_t tensor(1.1484, dtype=torch.float64)
8 gae_duplicate tensor(3.4328, dtype=torch.float64) tensor(-7.1353, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6004, dtype=torch.float64) delta_t tensor(-0.8272, dtype=torch.float64)
7 gae_duplicate tensor(1.9190, dtype=torch.float64) tensor(-3.9899, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8614, dtype=torch.float64) delta_t tensor(-1.6858, dtype=torch.float64)
6 gae_duplicate tensor(-0.1506, dtype=torch.float64) tensor(0.3132, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1227, dtype=torch.float64) delta_t tensor(-0.1847, dtype=torch.float64)
5 gae_duplicate tensor(-0.3052, dtype=torch.float64) tensor(0.6347, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9278, dtype=torch.float64) delta_t tensor(0.6194, dtype=torch.float64)
4 gae_duplicate tensor(0.3753, dtype=torch.float64) tensor(-0.7803, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3847, dtype=torch.float64) delta_t tensor(-0.6840, dtype=torch.float64)
3 gae_duplicate tensor(-0.3838, dtype=torch.float64) tensor(0.7980, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4075, dtype=torch.float64) delta_t tensor(-0.7010, dtype=torch.float64)
2 gae_duplicate tensor(-1.0081, dtype=torch.float64) tensor(2.0959, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:161.99850463867188
value loss:54.39263916015625
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.402147054672241 seconds
19 rew tensor(0.5049, dtype=torch.float64) delta_t tensor(-1.7339, dtype=torch.float64)
19 gae_duplicate tensor(-1.7339, dtype=torch.float64) tensor(3.6041, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.1779, dtype=torch.float64) delta_t tensor(-0.3562, dtype=torch.float64)
18 gae_duplicate tensor(-1.7433, dtype=torch.float64) tensor(3.6237, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8322, dtype=torch.float64) delta_t tensor(0.2394, dtype=torch.float64)
17 gae_duplicate tensor(-1.1553, dtype=torch.float64) tensor(2.4026, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6363, dtype=torch.float64) delta_t tensor(0.3244, dtype=torch.float64)
16 gae_duplicate tensor(-0.5998, dtype=torch.float64) tensor(1.2468, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4404, dtype=torch.float64) delta_t tensor(0.4446, dtype=torch.float64)
15 gae_duplicate tensor(-0.0353, dtype=torch.float64) tensor(0.0733, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1789, dtype=torch.float64) delta_t tensor(-0.4619, dtype=torch.float64)
14 gae_duplicate tensor(-0.4901, dtype=torch.float64) tensor(1.0192, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4405, dtype=torch.float64) delta_t tensor(-0.2191, dtype=torch.float64)
13 gae_duplicate tensor(-0.6112, dtype=torch.float64) tensor(1.2711, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8328, dtype=torch.float64) delta_t tensor(0.4222, dtype=torch.float64)
12 gae_duplicate tensor(-0.0668, dtype=torch.float64) tensor(0.1388, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(0.4430, dtype=torch.float64)
11 gae_duplicate tensor(0.3896, dtype=torch.float64) tensor(-0.8102, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7683, dtype=torch.float64) delta_t tensor(2.1315, dtype=torch.float64)
10 gae_duplicate tensor(2.4432, dtype=torch.float64) tensor(-5.0811, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4419, dtype=torch.float64) delta_t tensor(0.6197, dtype=torch.float64)
9 gae_duplicate tensor(2.5742, dtype=torch.float64) tensor(-5.3521, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1808, dtype=torch.float64) delta_t tensor(0.4985, dtype=torch.float64)
8 gae_duplicate tensor(2.5579, dtype=torch.float64) tensor(-5.3168, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6682, dtype=torch.float64) delta_t tensor(-1.6819, dtype=torch.float64)
7 gae_duplicate tensor(0.3644, dtype=torch.float64) tensor(-0.7578, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6685, dtype=torch.float64) delta_t tensor(-0.2404, dtype=torch.float64)
6 gae_duplicate tensor(0.0511, dtype=torch.float64) tensor(-0.1063, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0399, dtype=torch.float64) delta_t tensor(-1.9166, dtype=torch.float64)
5 gae_duplicate tensor(-1.8757, dtype=torch.float64) tensor(3.9000, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.6365, dtype=torch.float64) delta_t tensor(2.0157, dtype=torch.float64)
4 gae_duplicate tensor(0.5151, dtype=torch.float64) tensor(-1.0713, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2581, dtype=torch.float64) delta_t tensor(-0.1773, dtype=torch.float64)
3 gae_duplicate tensor(0.2348, dtype=torch.float64) tensor(-0.4884, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8016, dtype=torch.float64) delta_t tensor(-0.3514, dtype=torch.float64)
2 gae_duplicate tensor(-0.1635, dtype=torch.float64) tensor(0.3400, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:7.062613487243652
value loss:47.47541046142578
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.611279726028442 seconds
19 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(-1.2428, dtype=torch.float64)
19 gae_duplicate tensor(-1.2428, dtype=torch.float64) tensor(2.5841, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.4699, dtype=torch.float64)
18 gae_duplicate tensor(-0.5244, dtype=torch.float64) tensor(1.0908, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.4538, dtype=torch.float64)
17 gae_duplicate tensor(0.0343, dtype=torch.float64) tensor(-0.0714, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.4993, dtype=torch.float64)
16 gae_duplicate tensor(0.5267, dtype=torch.float64) tensor(-1.0957, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(3.9794, dtype=torch.float64)
15 gae_duplicate tensor(4.4007, dtype=torch.float64) tensor(-9.1500, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.8661, dtype=torch.float64)
14 gae_duplicate tensor(4.3867, dtype=torch.float64) tensor(-9.1230, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(1.3362, dtype=torch.float64)
13 gae_duplicate tensor(4.8455, dtype=torch.float64) tensor(-10.0773, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3770, dtype=torch.float64) delta_t tensor(-2.5162, dtype=torch.float64)
12 gae_duplicate tensor(1.3603, dtype=torch.float64) tensor(-2.8282, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3115, dtype=torch.float64) delta_t tensor(-0.0168, dtype=torch.float64)
11 gae_duplicate tensor(1.0714, dtype=torch.float64) tensor(-2.2282, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2461, dtype=torch.float64) delta_t tensor(-0.4835, dtype=torch.float64)
10 gae_duplicate tensor(0.3736, dtype=torch.float64) tensor(-0.7766, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1806, dtype=torch.float64) delta_t tensor(-0.0945, dtype=torch.float64)
9 gae_duplicate tensor(0.2044, dtype=torch.float64) tensor(-0.4249, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0159, dtype=torch.float64) delta_t tensor(-0.0185, dtype=torch.float64)
8 gae_duplicate tensor(0.1450, dtype=torch.float64) tensor(-0.3017, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7363, dtype=torch.float64) delta_t tensor(-0.8448, dtype=torch.float64)
7 gae_duplicate tensor(-0.7288, dtype=torch.float64) tensor(1.5161, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0163, dtype=torch.float64) delta_t tensor(0.3208, dtype=torch.float64)
6 gae_duplicate tensor(-0.2623, dtype=torch.float64) tensor(0.5453, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0458, dtype=torch.float64) delta_t tensor(-0.2610, dtype=torch.float64)
5 gae_duplicate tensor(-0.4708, dtype=torch.float64) tensor(0.9788, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4106, dtype=torch.float64) delta_t tensor(-0.1590, dtype=torch.float64)
4 gae_duplicate tensor(-0.5356, dtype=torch.float64) tensor(1.1142, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4107, dtype=torch.float64) delta_t tensor(0.5211, dtype=torch.float64)
3 gae_duplicate tensor(0.0926, dtype=torch.float64) tensor(-0.1926, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4764, dtype=torch.float64) delta_t tensor(-0.0114, dtype=torch.float64)
2 gae_duplicate tensor(0.0627, dtype=torch.float64) tensor(-0.1303, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:170.2999725341797
value loss:102.76268005371094
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.6451)
ToM Target loss= tensor(305.5573)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.353595018386841 seconds
19 rew tensor(0.8956, dtype=torch.float64) delta_t tensor(-1.5191, dtype=torch.float64)
19 gae_duplicate tensor(-1.5191, dtype=torch.float64) tensor(3.1593, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8960, dtype=torch.float64) delta_t tensor(0.4922, dtype=torch.float64)
18 gae_duplicate tensor(-0.7231, dtype=torch.float64) tensor(1.5034, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8965, dtype=torch.float64) delta_t tensor(0.2756, dtype=torch.float64)
17 gae_duplicate tensor(-0.3029, dtype=torch.float64) tensor(0.6296, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8969, dtype=torch.float64) delta_t tensor(0.4431, dtype=torch.float64)
16 gae_duplicate tensor(0.2008, dtype=torch.float64) tensor(-0.4175, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8974, dtype=torch.float64) delta_t tensor(0.3312, dtype=torch.float64)
15 gae_duplicate tensor(0.4918, dtype=torch.float64) tensor(-1.0226, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8978, dtype=torch.float64) delta_t tensor(0.5308, dtype=torch.float64)
14 gae_duplicate tensor(0.9242, dtype=torch.float64) tensor(-1.9221, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8983, dtype=torch.float64) delta_t tensor(0.3664, dtype=torch.float64)
13 gae_duplicate tensor(1.1058, dtype=torch.float64) tensor(-2.2997, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.4298, dtype=torch.float64)
12 gae_duplicate tensor(1.3144, dtype=torch.float64) tensor(-2.7330, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.3710, dtype=torch.float64)
11 gae_duplicate tensor(1.4225, dtype=torch.float64) tensor(-2.9591, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.3734, dtype=torch.float64)
10 gae_duplicate tensor(1.5114, dtype=torch.float64) tensor(-3.1418, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(0.4870, dtype=torch.float64)
9 gae_duplicate tensor(1.6961, dtype=torch.float64) tensor(-3.5274, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6389, dtype=torch.float64) delta_t tensor(0.1430, dtype=torch.float64)
8 gae_duplicate tensor(1.4999, dtype=torch.float64) tensor(-3.1185, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9305, dtype=torch.float64) delta_t tensor(-1.3614, dtype=torch.float64)
7 gae_duplicate tensor(-0.1615, dtype=torch.float64) tensor(0.3358, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1926, dtype=torch.float64) delta_t tensor(-1.7187, dtype=torch.float64)
6 gae_duplicate tensor(-1.8479, dtype=torch.float64) tensor(3.8421, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1280, dtype=torch.float64) delta_t tensor(0.4623, dtype=torch.float64)
5 gae_duplicate tensor(-1.0160, dtype=torch.float64) tensor(2.1130, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.8106, dtype=torch.float64) delta_t tensor(-1.9548, dtype=torch.float64)
4 gae_duplicate tensor(-2.7676, dtype=torch.float64) tensor(5.7530, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4785, dtype=torch.float64) delta_t tensor(-0.5134, dtype=torch.float64)
3 gae_duplicate tensor(-2.7275, dtype=torch.float64) tensor(5.6711, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4130, dtype=torch.float64) delta_t tensor(0.4022, dtype=torch.float64)
2 gae_duplicate tensor(-1.7798, dtype=torch.float64) tensor(3.7015, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-34.525856018066406
value loss:58.77528762817383
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4919209480285645 seconds
19 rew tensor(0.6369, dtype=torch.float64) delta_t tensor(-1.4716, dtype=torch.float64)
19 gae_duplicate tensor(-1.4716, dtype=torch.float64) tensor(3.0598, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3750, dtype=torch.float64) delta_t tensor(-0.1504, dtype=torch.float64)
18 gae_duplicate tensor(-1.3277, dtype=torch.float64) tensor(2.7599, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0180, dtype=torch.float64) delta_t tensor(-0.3873, dtype=torch.float64)
17 gae_duplicate tensor(-1.4494, dtype=torch.float64) tensor(3.0137, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.9350, dtype=torch.float64) delta_t tensor(-1.2608, dtype=torch.float64)
16 gae_duplicate tensor(-2.4203, dtype=torch.float64) tensor(5.0313, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7674, dtype=torch.float64) delta_t tensor(0.1117, dtype=torch.float64)
15 gae_duplicate tensor(-1.8245, dtype=torch.float64) tensor(3.7937, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6368, dtype=torch.float64) delta_t tensor(-0.1126, dtype=torch.float64)
14 gae_duplicate tensor(-1.5722, dtype=torch.float64) tensor(3.2697, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3751, dtype=torch.float64) delta_t tensor(0.2653, dtype=torch.float64)
13 gae_duplicate tensor(-0.9925, dtype=torch.float64) tensor(2.0635, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8335, dtype=torch.float64) delta_t tensor(0.3647, dtype=torch.float64)
12 gae_duplicate tensor(-0.4293, dtype=torch.float64) tensor(0.8928, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.1478, dtype=torch.float64)
11 gae_duplicate tensor(-0.1957, dtype=torch.float64) tensor(0.4068, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8343, dtype=torch.float64) delta_t tensor(0.3521, dtype=torch.float64)
10 gae_duplicate tensor(0.1955, dtype=torch.float64) tensor(-0.4067, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1802, dtype=torch.float64) delta_t tensor(-0.3406, dtype=torch.float64)
9 gae_duplicate tensor(-0.1842, dtype=torch.float64) tensor(0.3830, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5395, dtype=torch.float64) delta_t tensor(-0.8209, dtype=torch.float64)
8 gae_duplicate tensor(-0.9682, dtype=torch.float64) tensor(2.0131, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7359, dtype=torch.float64) delta_t tensor(-1.3874, dtype=torch.float64)
7 gae_duplicate tensor(-2.1620, dtype=torch.float64) tensor(4.4952, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0633, dtype=torch.float64) delta_t tensor(-1.5449, dtype=torch.float64)
6 gae_duplicate tensor(-3.2745, dtype=torch.float64) tensor(6.8114, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7180, dtype=torch.float64) delta_t tensor(-0.1218, dtype=torch.float64)
5 gae_duplicate tensor(-2.7414, dtype=torch.float64) tensor(5.6988, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8508, dtype=torch.float64) delta_t tensor(-0.3500, dtype=torch.float64)
4 gae_duplicate tensor(-2.5432, dtype=torch.float64) tensor(5.2890, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6087, dtype=torch.float64) delta_t tensor(0.0549, dtype=torch.float64)
3 gae_duplicate tensor(-1.9796, dtype=torch.float64) tensor(4.1160, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6089, dtype=torch.float64) delta_t tensor(-0.2231, dtype=torch.float64)
2 gae_duplicate tensor(-1.8068, dtype=torch.float64) tensor(3.7566, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-339.8089904785156
value loss:84.70207214355469
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.486540079116821 seconds
19 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(-0.8381, dtype=torch.float64)
19 gae_duplicate tensor(-0.8381, dtype=torch.float64) tensor(1.7433, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.6172, dtype=torch.float64)
18 gae_duplicate tensor(-0.0533, dtype=torch.float64) tensor(0.1108, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.5658, dtype=torch.float64)
17 gae_duplicate tensor(0.5232, dtype=torch.float64) tensor(-1.0879, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(0.2100, dtype=torch.float64)
16 gae_duplicate tensor(0.6285, dtype=torch.float64) tensor(-1.3068, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(0.5151, dtype=torch.float64)
15 gae_duplicate tensor(1.0179, dtype=torch.float64) tensor(-2.1168, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(0.9413, dtype=torch.float64)
14 gae_duplicate tensor(1.7556, dtype=torch.float64) tensor(-3.6503, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(2.0612, dtype=torch.float64)
13 gae_duplicate tensor(3.4656, dtype=torch.float64) tensor(-7.2060, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3779, dtype=torch.float64) delta_t tensor(1.0485, dtype=torch.float64)
12 gae_duplicate tensor(3.8210, dtype=torch.float64) tensor(-7.9478, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1157, dtype=torch.float64) delta_t tensor(0.3913, dtype=torch.float64)
11 gae_duplicate tensor(3.4481, dtype=torch.float64) tensor(-7.1693, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1465, dtype=torch.float64) delta_t tensor(-1.7675, dtype=torch.float64)
10 gae_duplicate tensor(0.9910, dtype=torch.float64) tensor(-2.0600, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2121, dtype=torch.float64) delta_t tensor(-2.0101, dtype=torch.float64)
9 gae_duplicate tensor(-1.2173, dtype=torch.float64) tensor(2.5311, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1466, dtype=torch.float64) delta_t tensor(-0.4370, dtype=torch.float64)
8 gae_duplicate tensor(-1.4108, dtype=torch.float64) tensor(2.9341, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3432, dtype=torch.float64) delta_t tensor(-0.1851, dtype=torch.float64)
7 gae_duplicate tensor(-1.3138, dtype=torch.float64) tensor(2.7312, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0158, dtype=torch.float64) delta_t tensor(1.3951, dtype=torch.float64)
6 gae_duplicate tensor(0.3440, dtype=torch.float64) tensor(-0.7153, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1289, dtype=torch.float64) delta_t tensor(-1.6636, dtype=torch.float64)
5 gae_duplicate tensor(-1.3884, dtype=torch.float64) tensor(2.8868, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8975, dtype=torch.float64) delta_t tensor(-1.7656, dtype=torch.float64)
4 gae_duplicate tensor(-2.8763, dtype=torch.float64) tensor(5.9829, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2805, dtype=torch.float64) delta_t tensor(0.9512, dtype=torch.float64)
3 gae_duplicate tensor(-1.3499, dtype=torch.float64) tensor(2.8067, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1494, dtype=torch.float64) delta_t tensor(-0.1042, dtype=torch.float64)
2 gae_duplicate tensor(-1.1841, dtype=torch.float64) tensor(2.4625, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:53.30218505859375
value loss:95.57376861572266
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.30160117149353 seconds
19 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(-1.5587, dtype=torch.float64)
19 gae_duplicate tensor(-1.5587, dtype=torch.float64) tensor(3.2416, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.4080, dtype=torch.float64)
18 gae_duplicate tensor(-0.8390, dtype=torch.float64) tensor(1.7445, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.4084, dtype=torch.float64)
17 gae_duplicate tensor(-0.2628, dtype=torch.float64) tensor(0.5465, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.2883, dtype=torch.float64)
16 gae_duplicate tensor(0.0781, dtype=torch.float64) tensor(-0.1624, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(0.1808, dtype=torch.float64)
15 gae_duplicate tensor(0.2433, dtype=torch.float64) tensor(-0.5058, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(0.3934, dtype=torch.float64)
14 gae_duplicate tensor(0.5880, dtype=torch.float64) tensor(-1.2225, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(0.2402, dtype=torch.float64)
13 gae_duplicate tensor(0.7106, dtype=torch.float64) tensor(-1.4780, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
12 gae_duplicate tensor(0.6083, dtype=torch.float64) tensor(-1.2650, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9026, dtype=torch.float64) delta_t tensor(0.2128, dtype=torch.float64)
11 gae_duplicate tensor(0.6995, dtype=torch.float64) tensor(-1.4546, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4439, dtype=torch.float64) delta_t tensor(-0.1491, dtype=torch.float64)
10 gae_duplicate tensor(0.4105, dtype=torch.float64) tensor(-0.8535, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0506, dtype=torch.float64) delta_t tensor(0.4047, dtype=torch.float64)
9 gae_duplicate tensor(0.7331, dtype=torch.float64) tensor(-1.5243, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2771, dtype=torch.float64) delta_t tensor(0.8035, dtype=torch.float64)
8 gae_duplicate tensor(1.3900, dtype=torch.float64) tensor(-2.8906, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6704, dtype=torch.float64) delta_t tensor(-0.6518, dtype=torch.float64)
7 gae_duplicate tensor(0.4602, dtype=torch.float64) tensor(-0.9568, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.6536, dtype=torch.float64) delta_t tensor(-0.6849, dtype=torch.float64)
6 gae_duplicate tensor(-0.3168, dtype=torch.float64) tensor(0.6588, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9831, dtype=torch.float64) delta_t tensor(-2.3494, dtype=torch.float64)
5 gae_duplicate tensor(-2.6029, dtype=torch.float64) tensor(5.4120, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3296, dtype=torch.float64) delta_t tensor(0.1229, dtype=torch.float64)
4 gae_duplicate tensor(-1.9594, dtype=torch.float64) tensor(4.0733, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8556, dtype=torch.float64) delta_t tensor(-1.6399, dtype=torch.float64)
3 gae_duplicate tensor(-3.2074, dtype=torch.float64) tensor(6.6677, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0191, dtype=torch.float64) delta_t tensor(-3.0187, dtype=torch.float64)
2 gae_duplicate tensor(-5.5846, dtype=torch.float64) tensor(11.6116, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-130.9778289794922
value loss:90.02511596679688
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.7053961753845215 seconds
19 rew tensor(0.6383, dtype=torch.float64) delta_t tensor(-1.5279, dtype=torch.float64)
19 gae_duplicate tensor(-1.5279, dtype=torch.float64) tensor(3.1779, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3756, dtype=torch.float64) delta_t tensor(-0.2823, dtype=torch.float64)
18 gae_duplicate tensor(-1.5046, dtype=torch.float64) tensor(3.1286, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.1500, dtype=torch.float64) delta_t tensor(-0.6348, dtype=torch.float64)
17 gae_duplicate tensor(-1.8385, dtype=torch.float64) tensor(3.8229, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-1.0697, dtype=torch.float64) delta_t tensor(-1.5584, dtype=torch.float64)
16 gae_duplicate tensor(-3.0292, dtype=torch.float64) tensor(6.2995, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8348, dtype=torch.float64) delta_t tensor(0.2655, dtype=torch.float64)
15 gae_duplicate tensor(-2.1579, dtype=torch.float64) tensor(4.4862, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.4020, dtype=torch.float64)
14 gae_duplicate tensor(-1.3243, dtype=torch.float64) tensor(2.7544, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(0.4024, dtype=torch.float64)
13 gae_duplicate tensor(-0.6570, dtype=torch.float64) tensor(1.3662, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8361, dtype=torch.float64) delta_t tensor(0.3291, dtype=torch.float64)
12 gae_duplicate tensor(-0.1965, dtype=torch.float64) tensor(0.4087, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7051, dtype=torch.float64) delta_t tensor(0.1386, dtype=torch.float64)
11 gae_duplicate tensor(-0.0186, dtype=torch.float64) tensor(0.0387, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5084, dtype=torch.float64) delta_t tensor(-0.1480, dtype=torch.float64)
10 gae_duplicate tensor(-0.1628, dtype=torch.float64) tensor(0.3386, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5742, dtype=torch.float64) delta_t tensor(0.0826, dtype=torch.float64)
9 gae_duplicate tensor(-0.0477, dtype=torch.float64) tensor(0.0992, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1477, dtype=torch.float64) delta_t tensor(-0.5851, dtype=torch.float64)
8 gae_duplicate tensor(-0.6233, dtype=torch.float64) tensor(1.2963, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2790, dtype=torch.float64) delta_t tensor(-0.7218, dtype=torch.float64)
7 gae_duplicate tensor(-1.2204, dtype=torch.float64) tensor(2.5380, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0664, dtype=torch.float64) delta_t tensor(-0.0134, dtype=torch.float64)
6 gae_duplicate tensor(-0.9898, dtype=torch.float64) tensor(2.0581, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7888, dtype=torch.float64) delta_t tensor(-0.4386, dtype=torch.float64)
5 gae_duplicate tensor(-1.2304, dtype=torch.float64) tensor(2.5588, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5938, dtype=torch.float64) delta_t tensor(-1.5334, dtype=torch.float64)
4 gae_duplicate tensor(-2.5177, dtype=torch.float64) tensor(5.2350, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1504, dtype=torch.float64) delta_t tensor(0.9494, dtype=torch.float64)
3 gae_duplicate tensor(-1.0648, dtype=torch.float64) tensor(2.2140, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3474, dtype=torch.float64) delta_t tensor(-0.4947, dtype=torch.float64)
2 gae_duplicate tensor(-1.3466, dtype=torch.float64) tensor(2.7996, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-268.8462219238281
value loss:56.58289337158203
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.8242)
ToM Target loss= tensor(305.6355)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.4492881298065186 seconds
19 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(-1.7687, dtype=torch.float64)
19 gae_duplicate tensor(-1.7687, dtype=torch.float64) tensor(3.6781, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(0.3679, dtype=torch.float64)
18 gae_duplicate tensor(-1.0471, dtype=torch.float64) tensor(2.1774, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9024, dtype=torch.float64) delta_t tensor(0.3683, dtype=torch.float64)
17 gae_duplicate tensor(-0.4693, dtype=torch.float64) tensor(0.9760, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9028, dtype=torch.float64) delta_t tensor(0.3688, dtype=torch.float64)
16 gae_duplicate tensor(-0.0067, dtype=torch.float64) tensor(0.0139, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9032, dtype=torch.float64) delta_t tensor(0.4009, dtype=torch.float64)
15 gae_duplicate tensor(0.3955, dtype=torch.float64) tensor(-0.8223, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9036, dtype=torch.float64) delta_t tensor(0.8445, dtype=torch.float64)
14 gae_duplicate tensor(1.1609, dtype=torch.float64) tensor(-2.4138, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.0077, dtype=torch.float64)
13 gae_duplicate tensor(0.9364, dtype=torch.float64) tensor(-1.9473, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9045, dtype=torch.float64) delta_t tensor(2.5484, dtype=torch.float64)
12 gae_duplicate tensor(3.2975, dtype=torch.float64) tensor(-6.8573, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9049, dtype=torch.float64) delta_t tensor(0.6041, dtype=torch.float64)
11 gae_duplicate tensor(3.2421, dtype=torch.float64) tensor(-6.7415, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3138, dtype=torch.float64) delta_t tensor(0.3475, dtype=torch.float64)
10 gae_duplicate tensor(2.9412, dtype=torch.float64) tensor(-6.1164, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0804, dtype=torch.float64) delta_t tensor(-0.0665, dtype=torch.float64)
9 gae_duplicate tensor(2.2865, dtype=torch.float64) tensor(-4.7548, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6716, dtype=torch.float64) delta_t tensor(-0.9766, dtype=torch.float64)
8 gae_duplicate tensor(0.8525, dtype=torch.float64) tensor(-1.7730, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3288, dtype=torch.float64) delta_t tensor(-2.1676, dtype=torch.float64)
7 gae_duplicate tensor(-1.4856, dtype=torch.float64) tensor(3.0893, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4611, dtype=torch.float64) delta_t tensor(-0.6993, dtype=torch.float64)
6 gae_duplicate tensor(-1.8877, dtype=torch.float64) tensor(3.9255, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2137, dtype=torch.float64) delta_t tensor(1.0060, dtype=torch.float64)
5 gae_duplicate tensor(-0.5042, dtype=torch.float64) tensor(1.0483, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5935, dtype=torch.float64) delta_t tensor(-1.1277, dtype=torch.float64)
4 gae_duplicate tensor(-1.5310, dtype=torch.float64) tensor(3.1839, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9893, dtype=torch.float64) delta_t tensor(-1.9365, dtype=torch.float64)
3 gae_duplicate tensor(-3.1614, dtype=torch.float64) tensor(6.5729, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3474, dtype=torch.float64) delta_t tensor(-1.0414, dtype=torch.float64)
2 gae_duplicate tensor(-3.5705, dtype=torch.float64) tensor(7.4244, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5.102531433105469
value loss:110.89218139648438
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.421499252319336 seconds
19 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(-1.6216, dtype=torch.float64)
19 gae_duplicate tensor(-1.6216, dtype=torch.float64) tensor(3.3719, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.3559, dtype=torch.float64)
18 gae_duplicate tensor(-0.9414, dtype=torch.float64) tensor(1.9576, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.3155, dtype=torch.float64)
17 gae_duplicate tensor(-0.4376, dtype=torch.float64) tensor(0.9099, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9024, dtype=torch.float64) delta_t tensor(0.3726, dtype=torch.float64)
16 gae_duplicate tensor(0.0225, dtype=torch.float64) tensor(-0.0468, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9028, dtype=torch.float64) delta_t tensor(0.2548, dtype=torch.float64)
15 gae_duplicate tensor(0.2728, dtype=torch.float64) tensor(-0.5673, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9033, dtype=torch.float64) delta_t tensor(0.4172, dtype=torch.float64)
14 gae_duplicate tensor(0.6355, dtype=torch.float64) tensor(-1.3214, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9037, dtype=torch.float64) delta_t tensor(0.5353, dtype=torch.float64)
13 gae_duplicate tensor(1.0436, dtype=torch.float64) tensor(-2.1702, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(-0.0912, dtype=torch.float64)
12 gae_duplicate tensor(0.7437, dtype=torch.float64) tensor(-1.5466, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9045, dtype=torch.float64) delta_t tensor(0.3186, dtype=torch.float64)
11 gae_duplicate tensor(0.9136, dtype=torch.float64) tensor(-1.8997, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6417, dtype=torch.float64) delta_t tensor(0.1059, dtype=torch.float64)
10 gae_duplicate tensor(0.8368, dtype=torch.float64) tensor(-1.7401, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3788, dtype=torch.float64) delta_t tensor(1.4151, dtype=torch.float64)
9 gae_duplicate tensor(2.0845, dtype=torch.float64) tensor(-4.3347, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4763, dtype=torch.float64) delta_t tensor(-1.9597, dtype=torch.float64)
8 gae_duplicate tensor(-0.2921, dtype=torch.float64) tensor(0.6074, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7395, dtype=torch.float64) delta_t tensor(1.2045, dtype=torch.float64)
7 gae_duplicate tensor(0.9708, dtype=torch.float64) tensor(-2.0187, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8055, dtype=torch.float64) delta_t tensor(-1.7469, dtype=torch.float64)
6 gae_duplicate tensor(-0.9703, dtype=torch.float64) tensor(2.0176, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8579, dtype=torch.float64) delta_t tensor(-1.1347, dtype=torch.float64)
5 gae_duplicate tensor(-1.9109, dtype=torch.float64) tensor(3.9736, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3770, dtype=torch.float64) delta_t tensor(1.6841, dtype=torch.float64)
4 gae_duplicate tensor(0.1553, dtype=torch.float64) tensor(-0.3230, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3332, dtype=torch.float64) delta_t tensor(-1.0470, dtype=torch.float64)
3 gae_duplicate tensor(-0.9227, dtype=torch.float64) tensor(1.9188, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4131, dtype=torch.float64) delta_t tensor(-0.4764, dtype=torch.float64)
2 gae_duplicate tensor(-1.2145, dtype=torch.float64) tensor(2.5256, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-9.006144523620605
value loss:29.51972007751465
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.492099046707153 seconds
19 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(-1.2935, dtype=torch.float64)
19 gae_duplicate tensor(-1.2935, dtype=torch.float64) tensor(2.6897, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.4619, dtype=torch.float64)
18 gae_duplicate tensor(-0.5728, dtype=torch.float64) tensor(1.1912, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.4623, dtype=torch.float64)
17 gae_duplicate tensor(0.0041, dtype=torch.float64) tensor(-0.0085, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8358, dtype=torch.float64) delta_t tensor(0.1601, dtype=torch.float64)
16 gae_duplicate tensor(0.1633, dtype=torch.float64) tensor(-0.3396, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7704, dtype=torch.float64) delta_t tensor(0.2499, dtype=torch.float64)
15 gae_duplicate tensor(0.3806, dtype=torch.float64) tensor(-0.7914, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6393, dtype=torch.float64) delta_t tensor(0.1694, dtype=torch.float64)
14 gae_duplicate tensor(0.4738, dtype=torch.float64) tensor(-0.9853, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4424, dtype=torch.float64) delta_t tensor(2.2108, dtype=torch.float64)
13 gae_duplicate tensor(2.5899, dtype=torch.float64) tensor(-5.3856, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8367, dtype=torch.float64) delta_t tensor(0.5975, dtype=torch.float64)
12 gae_duplicate tensor(2.6694, dtype=torch.float64) tensor(-5.5509, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9028, dtype=torch.float64) delta_t tensor(0.8253, dtype=torch.float64)
11 gae_duplicate tensor(2.9608, dtype=torch.float64) tensor(-6.1569, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9032, dtype=torch.float64) delta_t tensor(0.8257, dtype=torch.float64)
10 gae_duplicate tensor(3.1943, dtype=torch.float64) tensor(-6.6425, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1325, dtype=torch.float64) delta_t tensor(-1.1725, dtype=torch.float64)
9 gae_duplicate tensor(1.3830, dtype=torch.float64) tensor(-2.8759, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5420, dtype=torch.float64) delta_t tensor(-0.9413, dtype=torch.float64)
8 gae_duplicate tensor(0.1651, dtype=torch.float64) tensor(-0.3433, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3303, dtype=torch.float64) delta_t tensor(-1.1885, dtype=torch.float64)
7 gae_duplicate tensor(-1.0564, dtype=torch.float64) tensor(2.1967, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3110, dtype=torch.float64) delta_t tensor(0.4370, dtype=torch.float64)
6 gae_duplicate tensor(-0.4082, dtype=torch.float64) tensor(0.8487, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5934, dtype=torch.float64) delta_t tensor(-0.3970, dtype=torch.float64)
5 gae_duplicate tensor(-0.7236, dtype=torch.float64) tensor(1.5046, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5658, dtype=torch.float64) delta_t tensor(-3.2857, dtype=torch.float64)
4 gae_duplicate tensor(-3.8645, dtype=torch.float64) tensor(8.0361, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1518, dtype=torch.float64) delta_t tensor(-0.8496, dtype=torch.float64)
3 gae_duplicate tensor(-3.9412, dtype=torch.float64) tensor(8.1955, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2177, dtype=torch.float64) delta_t tensor(0.6001, dtype=torch.float64)
2 gae_duplicate tensor(-2.5529, dtype=torch.float64) tensor(5.3087, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6.471613883972168
value loss:113.89771270751953
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.379668235778809 seconds
19 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(-1.3226, dtype=torch.float64)
19 gae_duplicate tensor(-1.3226, dtype=torch.float64) tensor(2.7503, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.0119, dtype=torch.float64)
18 gae_duplicate tensor(-1.0462, dtype=torch.float64) tensor(2.1755, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8345, dtype=torch.float64) delta_t tensor(0.4290, dtype=torch.float64)
17 gae_duplicate tensor(-0.4080, dtype=torch.float64) tensor(0.8484, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.3930, dtype=torch.float64)
16 gae_duplicate tensor(0.0666, dtype=torch.float64) tensor(-0.1386, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(0.3934, dtype=torch.float64)
15 gae_duplicate tensor(0.4468, dtype=torch.float64) tensor(-0.9290, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.3939, dtype=torch.float64)
14 gae_duplicate tensor(0.7513, dtype=torch.float64) tensor(-1.5622, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(0.3943, dtype=torch.float64)
13 gae_duplicate tensor(0.9953, dtype=torch.float64) tensor(-2.0696, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(0.3947, dtype=torch.float64)
12 gae_duplicate tensor(1.1909, dtype=torch.float64) tensor(-2.4764, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9027, dtype=torch.float64) delta_t tensor(0.3951, dtype=torch.float64)
11 gae_duplicate tensor(1.3478, dtype=torch.float64) tensor(-2.8026, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7717, dtype=torch.float64) delta_t tensor(0.3086, dtype=torch.float64)
10 gae_duplicate tensor(1.3869, dtype=torch.float64) tensor(-2.8838, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5091, dtype=torch.float64) delta_t tensor(-0.3656, dtype=torch.float64)
9 gae_duplicate tensor(0.7440, dtype=torch.float64) tensor(-1.5470, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1149, dtype=torch.float64) delta_t tensor(-0.4131, dtype=torch.float64)
8 gae_duplicate tensor(0.1821, dtype=torch.float64) tensor(-0.3787, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5420, dtype=torch.float64) delta_t tensor(1.2673, dtype=torch.float64)
7 gae_duplicate tensor(1.4129, dtype=torch.float64) tensor(-2.9382, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0677, dtype=torch.float64) delta_t tensor(-3.0394, dtype=torch.float64)
6 gae_duplicate tensor(-1.9090, dtype=torch.float64) tensor(3.9697, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9222, dtype=torch.float64) delta_t tensor(-0.1327, dtype=torch.float64)
5 gae_duplicate tensor(-1.6599, dtype=torch.float64) tensor(3.4515, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3762, dtype=torch.float64) delta_t tensor(1.6509, dtype=torch.float64)
4 gae_duplicate tensor(0.3230, dtype=torch.float64) tensor(-0.6717, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5953, dtype=torch.float64) delta_t tensor(-0.8840, dtype=torch.float64)
3 gae_duplicate tensor(-0.6256, dtype=torch.float64) tensor(1.3009, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4652, dtype=torch.float64) delta_t tensor(-1.2657, dtype=torch.float64)
2 gae_duplicate tensor(-1.7662, dtype=torch.float64) tensor(3.6729, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:0.24806928634643555
value loss:33.787818908691406
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.594939231872559 seconds
19 rew tensor(0.8981, dtype=torch.float64) delta_t tensor(-1.9515, dtype=torch.float64)
19 gae_duplicate tensor(-1.9515, dtype=torch.float64) tensor(4.0579, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(0.3568, dtype=torch.float64)
18 gae_duplicate tensor(-1.2044, dtype=torch.float64) tensor(2.5045, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.1656, dtype=torch.float64)
17 gae_duplicate tensor(-0.7980, dtype=torch.float64) tensor(1.6595, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.6240, dtype=torch.float64)
16 gae_duplicate tensor(-0.0144, dtype=torch.float64) tensor(0.0299, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.1605, dtype=torch.float64)
15 gae_duplicate tensor(0.1490, dtype=torch.float64) tensor(-0.3098, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.7184, dtype=torch.float64)
14 gae_duplicate tensor(0.8376, dtype=torch.float64) tensor(-1.7416, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(1.0271, dtype=torch.float64)
13 gae_duplicate tensor(1.6971, dtype=torch.float64) tensor(-3.5289, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(0.3797, dtype=torch.float64)
12 gae_duplicate tensor(1.7374, dtype=torch.float64) tensor(-3.6132, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(-0.1307, dtype=torch.float64)
11 gae_duplicate tensor(1.2592, dtype=torch.float64) tensor(-2.6185, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(0.2835, dtype=torch.float64)
10 gae_duplicate tensor(1.2908, dtype=torch.float64) tensor(-2.6844, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(0.2001, dtype=torch.float64)
9 gae_duplicate tensor(1.2328, dtype=torch.float64) tensor(-2.5636, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1494, dtype=torch.float64) delta_t tensor(0.4602, dtype=torch.float64)
8 gae_duplicate tensor(1.4464, dtype=torch.float64) tensor(-3.0077, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1135, dtype=torch.float64) delta_t tensor(-0.6531, dtype=torch.float64)
7 gae_duplicate tensor(0.5040, dtype=torch.float64) tensor(-1.0480, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6751, dtype=torch.float64) delta_t tensor(-0.9710, dtype=torch.float64)
6 gae_duplicate tensor(-0.5677, dtype=torch.float64) tensor(1.1807, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5953, dtype=torch.float64) delta_t tensor(-0.1935, dtype=torch.float64)
5 gae_duplicate tensor(-0.6477, dtype=torch.float64) tensor(1.3468, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3754, dtype=torch.float64) delta_t tensor(1.1203, dtype=torch.float64)
4 gae_duplicate tensor(0.6021, dtype=torch.float64) tensor(-1.2521, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7276, dtype=torch.float64) delta_t tensor(-0.2367, dtype=torch.float64)
3 gae_duplicate tensor(0.2450, dtype=torch.float64) tensor(-0.5093, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5978, dtype=torch.float64) delta_t tensor(-1.1984, dtype=torch.float64)
2 gae_duplicate tensor(-1.0024, dtype=torch.float64) tensor(2.0843, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:58.95861053466797
value loss:32.70800018310547
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.3154)
ToM Target loss= tensor(305.7894)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.391522169113159 seconds
19 rew tensor(0.8918, dtype=torch.float64) delta_t tensor(-0.0402, dtype=torch.float64)
19 gae_duplicate tensor(-0.0402, dtype=torch.float64) tensor(0.0835, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8922, dtype=torch.float64) delta_t tensor(0.7076, dtype=torch.float64)
18 gae_duplicate tensor(0.6755, dtype=torch.float64) tensor(-1.4045, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8925, dtype=torch.float64) delta_t tensor(0.6578, dtype=torch.float64)
17 gae_duplicate tensor(1.1982, dtype=torch.float64) tensor(-2.4914, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8929, dtype=torch.float64) delta_t tensor(0.7790, dtype=torch.float64)
16 gae_duplicate tensor(1.7376, dtype=torch.float64) tensor(-3.6139, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8933, dtype=torch.float64) delta_t tensor(0.5218, dtype=torch.float64)
15 gae_duplicate tensor(1.9119, dtype=torch.float64) tensor(-3.9753, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8937, dtype=torch.float64) delta_t tensor(1.6638, dtype=torch.float64)
14 gae_duplicate tensor(3.1934, dtype=torch.float64) tensor(-6.6416, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8941, dtype=torch.float64) delta_t tensor(1.8701, dtype=torch.float64)
13 gae_duplicate tensor(4.4248, dtype=torch.float64) tensor(-9.2006, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1117, dtype=torch.float64) delta_t tensor(-0.4808, dtype=torch.float64)
12 gae_duplicate tensor(3.0590, dtype=torch.float64) tensor(-6.3607, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1117, dtype=torch.float64) delta_t tensor(0.3424, dtype=torch.float64)
11 gae_duplicate tensor(2.7896, dtype=torch.float64) tensor(-5.8013, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1117, dtype=torch.float64) delta_t tensor(-0.0520, dtype=torch.float64)
10 gae_duplicate tensor(2.1796, dtype=torch.float64) tensor(-4.5327, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0186, dtype=torch.float64) delta_t tensor(-1.1545, dtype=torch.float64)
9 gae_duplicate tensor(0.5893, dtype=torch.float64) tensor(-1.2253, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2794, dtype=torch.float64) delta_t tensor(-1.2205, dtype=torch.float64)
8 gae_duplicate tensor(-0.7491, dtype=torch.float64) tensor(1.5578, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5025, dtype=torch.float64) delta_t tensor(0.9735, dtype=torch.float64)
7 gae_duplicate tensor(0.3742, dtype=torch.float64) tensor(-0.7780, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3867, dtype=torch.float64) delta_t tensor(-0.4477, dtype=torch.float64)
6 gae_duplicate tensor(-0.1484, dtype=torch.float64) tensor(0.3085, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8664, dtype=torch.float64) delta_t tensor(-0.4922, dtype=torch.float64)
5 gae_duplicate tensor(-0.6109, dtype=torch.float64) tensor(1.2705, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-6.5357, dtype=torch.float64) delta_t tensor(-6.7586, dtype=torch.float64)
4 gae_duplicate tensor(-7.2474, dtype=torch.float64) tensor(15.0712, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2402, dtype=torch.float64) delta_t tensor(1.1265, dtype=torch.float64)
3 gae_duplicate tensor(-4.6714, dtype=torch.float64) tensor(9.7123, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0230, dtype=torch.float64) delta_t tensor(0.6149, dtype=torch.float64)
2 gae_duplicate tensor(-3.1222, dtype=torch.float64) tensor(6.4935, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:68.0448226928711
value loss:218.65933227539062
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.449277877807617 seconds
19 rew tensor(0.8908, dtype=torch.float64) delta_t tensor(-1.9696, dtype=torch.float64)
19 gae_duplicate tensor(-1.9696, dtype=torch.float64) tensor(4.0955, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8912, dtype=torch.float64) delta_t tensor(0.4171, dtype=torch.float64)
18 gae_duplicate tensor(-1.1586, dtype=torch.float64) tensor(2.4091, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8916, dtype=torch.float64) delta_t tensor(0.2165, dtype=torch.float64)
17 gae_duplicate tensor(-0.7104, dtype=torch.float64) tensor(1.4772, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8920, dtype=torch.float64) delta_t tensor(0.2517, dtype=torch.float64)
16 gae_duplicate tensor(-0.3166, dtype=torch.float64) tensor(0.6585, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8924, dtype=torch.float64) delta_t tensor(0.8144, dtype=torch.float64)
15 gae_duplicate tensor(0.5611, dtype=torch.float64) tensor(-1.1670, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8928, dtype=torch.float64) delta_t tensor(0.5333, dtype=torch.float64)
14 gae_duplicate tensor(0.9822, dtype=torch.float64) tensor(-2.0426, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8932, dtype=torch.float64) delta_t tensor(0.2720, dtype=torch.float64)
13 gae_duplicate tensor(1.0577, dtype=torch.float64) tensor(-2.1990, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8936, dtype=torch.float64) delta_t tensor(0.5028, dtype=torch.float64)
12 gae_duplicate tensor(1.3490, dtype=torch.float64) tensor(-2.8053, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8940, dtype=torch.float64) delta_t tensor(0.4209, dtype=torch.float64)
11 gae_duplicate tensor(1.5001, dtype=torch.float64) tensor(-3.1191, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8944, dtype=torch.float64) delta_t tensor(-0.0022, dtype=torch.float64)
10 gae_duplicate tensor(1.1979, dtype=torch.float64) tensor(-2.4911, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8948, dtype=torch.float64) delta_t tensor(0.4301, dtype=torch.float64)
9 gae_duplicate tensor(1.3884, dtype=torch.float64) tensor(-2.8873, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7353, dtype=torch.float64) delta_t tensor(-1.4440, dtype=torch.float64)
8 gae_duplicate tensor(-0.3333, dtype=torch.float64) tensor(0.6930, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0470, dtype=torch.float64) delta_t tensor(0.5965, dtype=torch.float64)
7 gae_duplicate tensor(0.3299, dtype=torch.float64) tensor(-0.6860, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6701, dtype=torch.float64) delta_t tensor(-0.0582, dtype=torch.float64)
6 gae_duplicate tensor(0.2057, dtype=torch.float64) tensor(-0.4277, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3445, dtype=torch.float64) delta_t tensor(0.5268, dtype=torch.float64)
5 gae_duplicate tensor(0.6914, dtype=torch.float64) tensor(-1.4380, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6480, dtype=torch.float64) delta_t tensor(-1.5128, dtype=torch.float64)
4 gae_duplicate tensor(-0.9597, dtype=torch.float64) tensor(1.9951, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.1059, dtype=torch.float64) delta_t tensor(-2.5956, dtype=torch.float64)
3 gae_duplicate tensor(-3.3633, dtype=torch.float64) tensor(6.9933, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2163, dtype=torch.float64) delta_t tensor(0.9995, dtype=torch.float64)
2 gae_duplicate tensor(-1.6912, dtype=torch.float64) tensor(3.5171, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-16.576231002807617
value loss:47.23662567138672
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5550549030303955 seconds
19 rew tensor(0.8892, dtype=torch.float64) delta_t tensor(-1.8400, dtype=torch.float64)
19 gae_duplicate tensor(-1.8400, dtype=torch.float64) tensor(3.8265, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8896, dtype=torch.float64) delta_t tensor(0.6630, dtype=torch.float64)
18 gae_duplicate tensor(-0.8090, dtype=torch.float64) tensor(1.6823, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8899, dtype=torch.float64) delta_t tensor(0.3446, dtype=torch.float64)
17 gae_duplicate tensor(-0.3026, dtype=torch.float64) tensor(0.6292, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8903, dtype=torch.float64) delta_t tensor(0.7330, dtype=torch.float64)
16 gae_duplicate tensor(0.4910, dtype=torch.float64) tensor(-1.0209, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(0.0902, dtype=torch.float64)
15 gae_duplicate tensor(0.4830, dtype=torch.float64) tensor(-1.0043, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8911, dtype=torch.float64) delta_t tensor(0.3770, dtype=torch.float64)
14 gae_duplicate tensor(0.7634, dtype=torch.float64) tensor(-1.5874, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8915, dtype=torch.float64) delta_t tensor(0.9161, dtype=torch.float64)
13 gae_duplicate tensor(1.5269, dtype=torch.float64) tensor(-3.1743, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8919, dtype=torch.float64) delta_t tensor(0.2054, dtype=torch.float64)
12 gae_duplicate tensor(1.4269, dtype=torch.float64) tensor(-2.9675, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8923, dtype=torch.float64) delta_t tensor(-0.1295, dtype=torch.float64)
11 gae_duplicate tensor(1.0120, dtype=torch.float64) tensor(-2.1043, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8927, dtype=torch.float64) delta_t tensor(2.6004, dtype=torch.float64)
10 gae_duplicate tensor(3.4100, dtype=torch.float64) tensor(-7.0914, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8931, dtype=torch.float64) delta_t tensor(-0.0289, dtype=torch.float64)
9 gae_duplicate tensor(2.6991, dtype=torch.float64) tensor(-5.6131, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3063, dtype=torch.float64) delta_t tensor(-1.7128, dtype=torch.float64)
8 gae_duplicate tensor(0.4465, dtype=torch.float64) tensor(-0.9283, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2807, dtype=torch.float64) delta_t tensor(0.9692, dtype=torch.float64)
7 gae_duplicate tensor(1.3263, dtype=torch.float64) tensor(-2.7582, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4547, dtype=torch.float64) delta_t tensor(-1.3771, dtype=torch.float64)
6 gae_duplicate tensor(-0.3161, dtype=torch.float64) tensor(0.6573, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7167, dtype=torch.float64) delta_t tensor(-1.2230, dtype=torch.float64)
5 gae_duplicate tensor(-1.4759, dtype=torch.float64) tensor(3.0692, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7617, dtype=torch.float64) delta_t tensor(2.1799, dtype=torch.float64)
4 gae_duplicate tensor(0.9992, dtype=torch.float64) tensor(-2.0784, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7178, dtype=torch.float64) delta_t tensor(-1.3391, dtype=torch.float64)
3 gae_duplicate tensor(-0.5397, dtype=torch.float64) tensor(1.1223, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4137, dtype=torch.float64) delta_t tensor(-0.3125, dtype=torch.float64)
2 gae_duplicate tensor(-0.7442, dtype=torch.float64) tensor(1.5475, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:105.6393051147461
value loss:53.36048126220703
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.358444929122925 seconds
19 rew tensor(-1.5249, dtype=torch.float64) delta_t tensor(-3.6232, dtype=torch.float64)
19 gae_duplicate tensor(-3.6232, dtype=torch.float64) tensor(7.5336, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8245, dtype=torch.float64) delta_t tensor(0.4036, dtype=torch.float64)
18 gae_duplicate tensor(-2.4949, dtype=torch.float64) tensor(5.1885, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(0.4702, dtype=torch.float64)
17 gae_duplicate tensor(-1.5257, dtype=torch.float64) tensor(3.1724, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8905, dtype=torch.float64) delta_t tensor(0.2679, dtype=torch.float64)
16 gae_duplicate tensor(-0.9527, dtype=torch.float64) tensor(1.9806, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7603, dtype=torch.float64) delta_t tensor(0.3443, dtype=torch.float64)
15 gae_duplicate tensor(-0.4179, dtype=torch.float64) tensor(0.8691, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8259, dtype=torch.float64) delta_t tensor(0.7564, dtype=torch.float64)
14 gae_duplicate tensor(0.4221, dtype=torch.float64) tensor(-0.8779, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6957, dtype=torch.float64) delta_t tensor(0.5253, dtype=torch.float64)
13 gae_duplicate tensor(0.8629, dtype=torch.float64) tensor(-1.7943, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.6746, dtype=torch.float64) delta_t tensor(-1.5400, dtype=torch.float64)
12 gae_duplicate tensor(-0.8496, dtype=torch.float64) tensor(1.7672, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8913, dtype=torch.float64) delta_t tensor(0.4508, dtype=torch.float64)
11 gae_duplicate tensor(-0.2289, dtype=torch.float64) tensor(0.4760, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7611, dtype=torch.float64) delta_t tensor(0.1790, dtype=torch.float64)
10 gae_duplicate tensor(-0.0041, dtype=torch.float64) tensor(0.0085, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4352, dtype=torch.float64) delta_t tensor(1.3007, dtype=torch.float64)
9 gae_duplicate tensor(1.2974, dtype=torch.float64) tensor(-2.6982, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7615, dtype=torch.float64) delta_t tensor(0.7774, dtype=torch.float64)
8 gae_duplicate tensor(1.8153, dtype=torch.float64) tensor(-3.7759, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6079, dtype=torch.float64) delta_t tensor(-0.4186, dtype=torch.float64)
7 gae_duplicate tensor(1.0337, dtype=torch.float64) tensor(-2.1493, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4125, dtype=torch.float64) delta_t tensor(-0.5015, dtype=torch.float64)
6 gae_duplicate tensor(0.3254, dtype=torch.float64) tensor(-0.6767, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7166, dtype=torch.float64) delta_t tensor(-0.9218, dtype=torch.float64)
5 gae_duplicate tensor(-0.6614, dtype=torch.float64) tensor(1.3752, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2401, dtype=torch.float64) delta_t tensor(-2.4999, dtype=torch.float64)
4 gae_duplicate tensor(-3.0290, dtype=torch.float64) tensor(6.2981, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8069, dtype=torch.float64) delta_t tensor(0.6485, dtype=torch.float64)
3 gae_duplicate tensor(-1.7747, dtype=torch.float64) tensor(3.6914, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4601, dtype=torch.float64) delta_t tensor(-1.3099, dtype=torch.float64)
2 gae_duplicate tensor(-2.7297, dtype=torch.float64) tensor(5.6748, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-157.5021209716797
value loss:76.23939514160156
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.355158090591431 seconds
19 rew tensor(0.8898, dtype=torch.float64) delta_t tensor(-1.3200, dtype=torch.float64)
19 gae_duplicate tensor(-1.3200, dtype=torch.float64) tensor(2.7445, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(0.2080, dtype=torch.float64)
18 gae_duplicate tensor(-0.8480, dtype=torch.float64) tensor(1.7632, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8905, dtype=torch.float64) delta_t tensor(0.5000, dtype=torch.float64)
17 gae_duplicate tensor(-0.1784, dtype=torch.float64) tensor(0.3709, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8909, dtype=torch.float64) delta_t tensor(1.0564, dtype=torch.float64)
16 gae_duplicate tensor(0.9137, dtype=torch.float64) tensor(-1.9001, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8913, dtype=torch.float64) delta_t tensor(0.6694, dtype=torch.float64)
15 gae_duplicate tensor(1.4003, dtype=torch.float64) tensor(-2.9116, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8917, dtype=torch.float64) delta_t tensor(3.1736, dtype=torch.float64)
14 gae_duplicate tensor(4.2938, dtype=torch.float64) tensor(-8.9278, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8920, dtype=torch.float64) delta_t tensor(0.8211, dtype=torch.float64)
13 gae_duplicate tensor(4.2562, dtype=torch.float64) tensor(-8.8498, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8924, dtype=torch.float64) delta_t tensor(0.0103, dtype=torch.float64)
12 gae_duplicate tensor(3.4153, dtype=torch.float64) tensor(-7.1010, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8928, dtype=torch.float64) delta_t tensor(0.9897, dtype=torch.float64)
11 gae_duplicate tensor(3.7219, dtype=torch.float64) tensor(-7.7385, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5427, dtype=torch.float64) delta_t tensor(-1.3491, dtype=torch.float64)
10 gae_duplicate tensor(1.6284, dtype=torch.float64) tensor(-3.3858, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7387, dtype=torch.float64) delta_t tensor(-1.4631, dtype=torch.float64)
9 gae_duplicate tensor(-0.1604, dtype=torch.float64) tensor(0.3335, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0441, dtype=torch.float64) delta_t tensor(-0.3090, dtype=torch.float64)
8 gae_duplicate tensor(-0.4374, dtype=torch.float64) tensor(0.9097, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1516, dtype=torch.float64) delta_t tensor(0.7467, dtype=torch.float64)
7 gae_duplicate tensor(0.3968, dtype=torch.float64) tensor(-0.8252, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5658, dtype=torch.float64) delta_t tensor(0.5703, dtype=torch.float64)
6 gae_duplicate tensor(0.8878, dtype=torch.float64) tensor(-1.8459, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9772, dtype=torch.float64) delta_t tensor(-0.7766, dtype=torch.float64)
5 gae_duplicate tensor(-0.0664, dtype=torch.float64) tensor(0.1380, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5001, dtype=torch.float64) delta_t tensor(0.9395, dtype=torch.float64)
4 gae_duplicate tensor(0.8864, dtype=torch.float64) tensor(-1.8426, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6527, dtype=torch.float64) delta_t tensor(-0.9356, dtype=torch.float64)
3 gae_duplicate tensor(-0.2265, dtype=torch.float64) tensor(0.4710, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7195, dtype=torch.float64) delta_t tensor(-1.7069, dtype=torch.float64)
2 gae_duplicate tensor(-1.8881, dtype=torch.float64) tensor(3.9265, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:206.90396118164062
value loss:113.3670654296875
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.7507)
ToM Target loss= tensor(305.5546)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.627902984619141 seconds
19 rew tensor(0.8265, dtype=torch.float64) delta_t tensor(-1.2414, dtype=torch.float64)
19 gae_duplicate tensor(-1.2414, dtype=torch.float64) tensor(2.5811, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7614, dtype=torch.float64) delta_t tensor(0.4350, dtype=torch.float64)
18 gae_duplicate tensor(-0.5581, dtype=torch.float64) tensor(1.1609, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7617, dtype=torch.float64) delta_t tensor(0.4254, dtype=torch.float64)
17 gae_duplicate tensor(-0.0211, dtype=torch.float64) tensor(0.0438, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5006, dtype=torch.float64) delta_t tensor(0.1483, dtype=torch.float64)
16 gae_duplicate tensor(0.1314, dtype=torch.float64) tensor(-0.2733, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1740, dtype=torch.float64) delta_t tensor(0.4186, dtype=torch.float64)
15 gae_duplicate tensor(0.5237, dtype=torch.float64) tensor(-1.0889, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3047, dtype=torch.float64) delta_t tensor(-0.9904, dtype=torch.float64)
14 gae_duplicate tensor(-0.5714, dtype=torch.float64) tensor(1.1878, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7620, dtype=torch.float64) delta_t tensor(0.3670, dtype=torch.float64)
13 gae_duplicate tensor(-0.0901, dtype=torch.float64) tensor(0.1875, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8276, dtype=torch.float64) delta_t tensor(0.0103, dtype=torch.float64)
12 gae_duplicate tensor(-0.0618, dtype=torch.float64) tensor(0.1284, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8279, dtype=torch.float64) delta_t tensor(0.3622, dtype=torch.float64)
11 gae_duplicate tensor(0.3128, dtype=torch.float64) tensor(-0.6504, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8282, dtype=torch.float64) delta_t tensor(0.9911, dtype=torch.float64)
10 gae_duplicate tensor(1.2414, dtype=torch.float64) tensor(-2.5817, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5426, dtype=torch.float64) delta_t tensor(-1.5422, dtype=torch.float64)
9 gae_duplicate tensor(-0.5490, dtype=torch.float64) tensor(1.1418, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.9790, dtype=torch.float64) delta_t tensor(-2.1864, dtype=torch.float64)
8 gae_duplicate tensor(-2.6256, dtype=torch.float64) tensor(5.4603, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7401, dtype=torch.float64) delta_t tensor(-0.7947, dtype=torch.float64)
7 gae_duplicate tensor(-2.8951, dtype=torch.float64) tensor(6.0184, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3283, dtype=torch.float64) delta_t tensor(-1.8405, dtype=torch.float64)
6 gae_duplicate tensor(-4.1566, dtype=torch.float64) tensor(8.6443, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0025, dtype=torch.float64) delta_t tensor(-1.6938, dtype=torch.float64)
5 gae_duplicate tensor(-5.0191, dtype=torch.float64) tensor(10.4379, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1989, dtype=torch.float64) delta_t tensor(0.6473, dtype=torch.float64)
4 gae_duplicate tensor(-3.3680, dtype=torch.float64) tensor(7.0042, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0235, dtype=torch.float64) delta_t tensor(1.4300, dtype=torch.float64)
3 gae_duplicate tensor(-1.2644, dtype=torch.float64) tensor(2.6295, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6114, dtype=torch.float64) delta_t tensor(-0.3010, dtype=torch.float64)
2 gae_duplicate tensor(-1.3125, dtype=torch.float64) tensor(2.7290, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-269.6864929199219
value loss:115.24803161621094
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.448176145553589 seconds
19 rew tensor(0.8920, dtype=torch.float64) delta_t tensor(-0.5499, dtype=torch.float64)
19 gae_duplicate tensor(-0.5499, dtype=torch.float64) tensor(1.1437, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8924, dtype=torch.float64) delta_t tensor(-0.2754, dtype=torch.float64)
18 gae_duplicate tensor(-0.7154, dtype=torch.float64) tensor(1.4878, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8928, dtype=torch.float64) delta_t tensor(0.4680, dtype=torch.float64)
17 gae_duplicate tensor(-0.1043, dtype=torch.float64) tensor(0.2168, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8931, dtype=torch.float64) delta_t tensor(0.8200, dtype=torch.float64)
16 gae_duplicate tensor(0.7365, dtype=torch.float64) tensor(-1.5314, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8935, dtype=torch.float64) delta_t tensor(0.4857, dtype=torch.float64)
15 gae_duplicate tensor(1.0749, dtype=torch.float64) tensor(-2.2355, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8939, dtype=torch.float64) delta_t tensor(0.5545, dtype=torch.float64)
14 gae_duplicate tensor(1.4144, dtype=torch.float64) tensor(-2.9401, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8943, dtype=torch.float64) delta_t tensor(0.5561, dtype=torch.float64)
13 gae_duplicate tensor(1.6877, dtype=torch.float64) tensor(-3.5089, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5021, dtype=torch.float64) delta_t tensor(0.1538, dtype=torch.float64)
12 gae_duplicate tensor(1.5039, dtype=torch.float64) tensor(-3.1262, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5023, dtype=torch.float64) delta_t tensor(0.2035, dtype=torch.float64)
11 gae_duplicate tensor(1.4066, dtype=torch.float64) tensor(-2.9247, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5024, dtype=torch.float64) delta_t tensor(0.0863, dtype=torch.float64)
10 gae_duplicate tensor(1.2116, dtype=torch.float64) tensor(-2.5198, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2410, dtype=torch.float64) delta_t tensor(0.8302, dtype=torch.float64)
9 gae_duplicate tensor(1.7995, dtype=torch.float64) tensor(-3.7408, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1103, dtype=torch.float64) delta_t tensor(0.2101, dtype=torch.float64)
8 gae_duplicate tensor(1.6497, dtype=torch.float64) tensor(-3.4308, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0662, dtype=torch.float64) delta_t tensor(-0.8545, dtype=torch.float64)
7 gae_duplicate tensor(0.4652, dtype=torch.float64) tensor(-0.9675, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2628, dtype=torch.float64) delta_t tensor(-0.5383, dtype=torch.float64)
6 gae_duplicate tensor(-0.1661, dtype=torch.float64) tensor(0.3456, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1746, dtype=torch.float64) delta_t tensor(0.7434, dtype=torch.float64)
5 gae_duplicate tensor(0.6105, dtype=torch.float64) tensor(-1.2697, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7207, dtype=torch.float64) delta_t tensor(-1.1339, dtype=torch.float64)
4 gae_duplicate tensor(-0.6455, dtype=torch.float64) tensor(1.3424, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7223, dtype=torch.float64) delta_t tensor(-1.2037, dtype=torch.float64)
3 gae_duplicate tensor(-1.7200, dtype=torch.float64) tensor(3.5771, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2847, dtype=torch.float64) delta_t tensor(-0.7987, dtype=torch.float64)
2 gae_duplicate tensor(-2.1747, dtype=torch.float64) tensor(4.5228, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:92.2326431274414
value loss:41.64192199707031
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.546781063079834 seconds
19 rew tensor(0.3038, dtype=torch.float64) delta_t tensor(-1.8531, dtype=torch.float64)
19 gae_duplicate tensor(-1.8531, dtype=torch.float64) tensor(3.8530, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.2862, dtype=torch.float64) delta_t tensor(-0.7561, dtype=torch.float64)
18 gae_duplicate tensor(-2.2386, dtype=torch.float64) tensor(4.6569, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-1.3349, dtype=torch.float64) delta_t tensor(-1.8134, dtype=torch.float64)
17 gae_duplicate tensor(-3.6043, dtype=torch.float64) tensor(7.4938, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8931, dtype=torch.float64) delta_t tensor(0.4461, dtype=torch.float64)
16 gae_duplicate tensor(-2.4373, dtype=torch.float64) tensor(5.0689, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8935, dtype=torch.float64) delta_t tensor(0.4465, dtype=torch.float64)
15 gae_duplicate tensor(-1.5033, dtype=torch.float64) tensor(3.1265, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7627, dtype=torch.float64) delta_t tensor(0.3463, dtype=torch.float64)
14 gae_duplicate tensor(-0.8564, dtype=torch.float64) tensor(1.7810, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7630, dtype=torch.float64) delta_t tensor(0.3354, dtype=torch.float64)
13 gae_duplicate tensor(-0.3497, dtype=torch.float64) tensor(0.7273, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7633, dtype=torch.float64) delta_t tensor(-0.0172, dtype=torch.float64)
12 gae_duplicate tensor(-0.2969, dtype=torch.float64) tensor(0.6176, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8291, dtype=torch.float64) delta_t tensor(0.2781, dtype=torch.float64)
11 gae_duplicate tensor(0.0405, dtype=torch.float64) tensor(-0.0842, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8950, dtype=torch.float64) delta_t tensor(0.3794, dtype=torch.float64)
10 gae_duplicate tensor(0.4118, dtype=torch.float64) tensor(-0.8562, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4806, dtype=torch.float64) delta_t tensor(-1.2367, dtype=torch.float64)
9 gae_duplicate tensor(-0.9073, dtype=torch.float64) tensor(1.8874, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0433, dtype=torch.float64) delta_t tensor(-0.5074, dtype=torch.float64)
8 gae_duplicate tensor(-1.2332, dtype=torch.float64) tensor(2.5641, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3975, dtype=torch.float64) delta_t tensor(-1.7326, dtype=torch.float64)
7 gae_duplicate tensor(-2.7192, dtype=torch.float64) tensor(5.6522, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1082, dtype=torch.float64) delta_t tensor(1.3068, dtype=torch.float64)
6 gae_duplicate tensor(-0.8685, dtype=torch.float64) tensor(1.8063, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7432, dtype=torch.float64) delta_t tensor(0.6956, dtype=torch.float64)
5 gae_duplicate tensor(0.0008, dtype=torch.float64) tensor(-0.0016, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4353, dtype=torch.float64) delta_t tensor(0.8098, dtype=torch.float64)
4 gae_duplicate tensor(0.8104, dtype=torch.float64) tensor(-1.6850, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8741, dtype=torch.float64) delta_t tensor(-0.4163, dtype=torch.float64)
3 gae_duplicate tensor(0.2320, dtype=torch.float64) tensor(-0.4825, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8090, dtype=torch.float64) delta_t tensor(-0.2278, dtype=torch.float64)
2 gae_duplicate tensor(-0.0422, dtype=torch.float64) tensor(0.0876, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-218.4018096923828
value loss:62.93506622314453
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.376983880996704 seconds
19 rew tensor(0.8300, dtype=torch.float64) delta_t tensor(-0.7713, dtype=torch.float64)
19 gae_duplicate tensor(-0.7713, dtype=torch.float64) tensor(1.6031, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7647, dtype=torch.float64) delta_t tensor(0.0752, dtype=torch.float64)
18 gae_duplicate tensor(-0.5418, dtype=torch.float64) tensor(1.1264, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5682, dtype=torch.float64) delta_t tensor(0.3610, dtype=torch.float64)
17 gae_duplicate tensor(-0.0724, dtype=torch.float64) tensor(0.1506, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3060, dtype=torch.float64) delta_t tensor(0.3984, dtype=torch.float64)
16 gae_duplicate tensor(0.3404, dtype=torch.float64) tensor(-0.7080, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.2185, dtype=torch.float64) delta_t tensor(-0.6586, dtype=torch.float64)
15 gae_duplicate tensor(-0.3862, dtype=torch.float64) tensor(0.8030, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4371, dtype=torch.float64) delta_t tensor(-0.1566, dtype=torch.float64)
14 gae_duplicate tensor(-0.4656, dtype=torch.float64) tensor(0.9684, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8305, dtype=torch.float64) delta_t tensor(0.5046, dtype=torch.float64)
13 gae_duplicate tensor(0.1321, dtype=torch.float64) tensor(-0.2748, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8308, dtype=torch.float64) delta_t tensor(0.5023, dtype=torch.float64)
12 gae_duplicate tensor(0.6080, dtype=torch.float64) tensor(-1.2645, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7656, dtype=torch.float64) delta_t tensor(1.9913, dtype=torch.float64)
11 gae_duplicate tensor(2.4777, dtype=torch.float64) tensor(-5.1498, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5037, dtype=torch.float64) delta_t tensor(-1.0530, dtype=torch.float64)
10 gae_duplicate tensor(0.9291, dtype=torch.float64) tensor(-1.9318, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8721, dtype=torch.float64) delta_t tensor(-1.5492, dtype=torch.float64)
9 gae_duplicate tensor(-0.8059, dtype=torch.float64) tensor(1.6760, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3069, dtype=torch.float64) delta_t tensor(0.4314, dtype=torch.float64)
8 gae_duplicate tensor(-0.2133, dtype=torch.float64) tensor(0.4434, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1341, dtype=torch.float64) delta_t tensor(-1.3312, dtype=torch.float64)
7 gae_duplicate tensor(-1.5018, dtype=torch.float64) tensor(3.1234, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8727, dtype=torch.float64) delta_t tensor(0.0970, dtype=torch.float64)
6 gae_duplicate tensor(-1.1045, dtype=torch.float64) tensor(2.2978, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1350, dtype=torch.float64) delta_t tensor(-1.0021, dtype=torch.float64)
5 gae_duplicate tensor(-1.8857, dtype=torch.float64) tensor(3.9218, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9044, dtype=torch.float64) delta_t tensor(-1.9048, dtype=torch.float64)
4 gae_duplicate tensor(-3.4133, dtype=torch.float64) tensor(7.0947, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3515, dtype=torch.float64) delta_t tensor(0.3221, dtype=torch.float64)
3 gae_duplicate tensor(-2.4086, dtype=torch.float64) tensor(5.0092, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4172, dtype=torch.float64) delta_t tensor(-0.1980, dtype=torch.float64)
2 gae_duplicate tensor(-2.1249, dtype=torch.float64) tensor(4.4193, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-140.97291564941406
value loss:57.68745422363281
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.643264055252075 seconds
19 rew tensor(0.8931, dtype=torch.float64) delta_t tensor(-1.1718, dtype=torch.float64)
19 gae_duplicate tensor(-1.1718, dtype=torch.float64) tensor(2.4370, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8934, dtype=torch.float64) delta_t tensor(0.5721, dtype=torch.float64)
18 gae_duplicate tensor(-0.3653, dtype=torch.float64) tensor(0.7595, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8938, dtype=torch.float64) delta_t tensor(0.7312, dtype=torch.float64)
17 gae_duplicate tensor(0.4390, dtype=torch.float64) tensor(-0.9127, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8942, dtype=torch.float64) delta_t tensor(1.3489, dtype=torch.float64)
16 gae_duplicate tensor(1.7000, dtype=torch.float64) tensor(-3.5333, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8945, dtype=torch.float64) delta_t tensor(0.7524, dtype=torch.float64)
15 gae_duplicate tensor(2.1124, dtype=torch.float64) tensor(-4.3935, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8949, dtype=torch.float64) delta_t tensor(0.5655, dtype=torch.float64)
14 gae_duplicate tensor(2.2555, dtype=torch.float64) tensor(-4.6910, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8953, dtype=torch.float64) delta_t tensor(0.3555, dtype=torch.float64)
13 gae_duplicate tensor(2.1599, dtype=torch.float64) tensor(-4.4920, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8956, dtype=torch.float64) delta_t tensor(1.6139, dtype=torch.float64)
12 gae_duplicate tensor(3.3418, dtype=torch.float64) tensor(-6.9480, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8960, dtype=torch.float64) delta_t tensor(-0.4490, dtype=torch.float64)
11 gae_duplicate tensor(2.2244, dtype=torch.float64) tensor(-4.6248, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8964, dtype=torch.float64) delta_t tensor(0.5569, dtype=torch.float64)
10 gae_duplicate tensor(2.3365, dtype=torch.float64) tensor(-4.8577, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8967, dtype=torch.float64) delta_t tensor(0.5998, dtype=torch.float64)
9 gae_duplicate tensor(2.4690, dtype=torch.float64) tensor(-5.1332, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8032, dtype=torch.float64) delta_t tensor(-1.2958, dtype=torch.float64)
8 gae_duplicate tensor(0.6793, dtype=torch.float64) tensor(-1.4128, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4111, dtype=torch.float64) delta_t tensor(-0.5974, dtype=torch.float64)
7 gae_duplicate tensor(-0.0539, dtype=torch.float64) tensor(0.1121, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4573, dtype=torch.float64) delta_t tensor(0.0873, dtype=torch.float64)
6 gae_duplicate tensor(0.0441, dtype=torch.float64) tensor(-0.0918, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4774, dtype=torch.float64) delta_t tensor(-0.1597, dtype=torch.float64)
5 gae_duplicate tensor(-0.1244, dtype=torch.float64) tensor(0.2587, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.3352, dtype=torch.float64) delta_t tensor(-4.9792, dtype=torch.float64)
4 gae_duplicate tensor(-5.0787, dtype=torch.float64) tensor(10.5555, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4815, dtype=torch.float64) delta_t tensor(0.3964, dtype=torch.float64)
3 gae_duplicate tensor(-3.6665, dtype=torch.float64) tensor(7.6233, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6786, dtype=torch.float64) delta_t tensor(0.6203, dtype=torch.float64)
2 gae_duplicate tensor(-2.3129, dtype=torch.float64) tensor(4.8119, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:86.07453155517578
value loss:137.31434631347656
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.1909)
ToM Target loss= tensor(305.2848)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.310171127319336 seconds
19 rew tensor(0.3708, dtype=torch.float64) delta_t tensor(-1.5562, dtype=torch.float64)
19 gae_duplicate tensor(-1.5562, dtype=torch.float64) tensor(3.2366, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.2803, dtype=torch.float64) delta_t tensor(-0.5256, dtype=torch.float64)
18 gae_duplicate tensor(-1.7706, dtype=torch.float64) tensor(3.6824, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-1.2570, dtype=torch.float64) delta_t tensor(-1.2589, dtype=torch.float64)
17 gae_duplicate tensor(-2.6753, dtype=torch.float64) tensor(5.5602, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8260, dtype=torch.float64) delta_t tensor(0.5190, dtype=torch.float64)
16 gae_duplicate tensor(-1.6213, dtype=torch.float64) tensor(3.3732, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8914, dtype=torch.float64) delta_t tensor(0.6010, dtype=torch.float64)
15 gae_duplicate tensor(-0.6961, dtype=torch.float64) tensor(1.4477, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8917, dtype=torch.float64) delta_t tensor(0.4158, dtype=torch.float64)
14 gae_duplicate tensor(-0.1410, dtype=torch.float64) tensor(0.2932, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8270, dtype=torch.float64) delta_t tensor(0.4670, dtype=torch.float64)
13 gae_duplicate tensor(0.3542, dtype=torch.float64) tensor(-0.7367, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8924, dtype=torch.float64) delta_t tensor(0.3917, dtype=torch.float64)
12 gae_duplicate tensor(0.6751, dtype=torch.float64) tensor(-1.4036, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8277, dtype=torch.float64) delta_t tensor(0.4549, dtype=torch.float64)
11 gae_duplicate tensor(0.9950, dtype=torch.float64) tensor(-2.0694, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8280, dtype=torch.float64) delta_t tensor(0.4814, dtype=torch.float64)
10 gae_duplicate tensor(1.2774, dtype=torch.float64) tensor(-2.6567, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1894, dtype=torch.float64) delta_t tensor(-1.5104, dtype=torch.float64)
9 gae_duplicate tensor(-0.4885, dtype=torch.float64) tensor(1.0156, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3202, dtype=torch.float64) delta_t tensor(-1.4719, dtype=torch.float64)
8 gae_duplicate tensor(-1.8627, dtype=torch.float64) tensor(3.8712, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4368, dtype=torch.float64) delta_t tensor(0.1093, dtype=torch.float64)
7 gae_duplicate tensor(-1.3809, dtype=torch.float64) tensor(2.8720, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-3.3384, dtype=torch.float64) delta_t tensor(-3.2646, dtype=torch.float64)
6 gae_duplicate tensor(-4.3693, dtype=torch.float64) tensor(9.0838, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9337, dtype=torch.float64) delta_t tensor(0.8450, dtype=torch.float64)
5 gae_duplicate tensor(-2.6504, dtype=torch.float64) tensor(5.5124, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.1961, dtype=torch.float64) delta_t tensor(-4.2820, dtype=torch.float64)
4 gae_duplicate tensor(-6.4023, dtype=torch.float64) tensor(13.3158, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0882, dtype=torch.float64) delta_t tensor(0.7171, dtype=torch.float64)
3 gae_duplicate tensor(-4.4047, dtype=torch.float64) tensor(9.1610, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0882, dtype=torch.float64) delta_t tensor(-0.0751, dtype=torch.float64)
2 gae_duplicate tensor(-3.5988, dtype=torch.float64) tensor(7.4851, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-379.3846740722656
value loss:186.18389892578125
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5510900020599365 seconds
19 rew tensor(0.8909, dtype=torch.float64) delta_t tensor(-1.3292, dtype=torch.float64)
19 gae_duplicate tensor(-1.3292, dtype=torch.float64) tensor(2.7635, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8913, dtype=torch.float64) delta_t tensor(0.4314, dtype=torch.float64)
18 gae_duplicate tensor(-0.6320, dtype=torch.float64) tensor(1.3140, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8916, dtype=torch.float64) delta_t tensor(0.4957, dtype=torch.float64)
17 gae_duplicate tensor(-0.0099, dtype=torch.float64) tensor(0.0207, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8920, dtype=torch.float64) delta_t tensor(0.1226, dtype=torch.float64)
16 gae_duplicate tensor(0.1146, dtype=torch.float64) tensor(-0.2385, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8923, dtype=torch.float64) delta_t tensor(0.5912, dtype=torch.float64)
15 gae_duplicate tensor(0.6829, dtype=torch.float64) tensor(-1.4198, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8927, dtype=torch.float64) delta_t tensor(0.4657, dtype=torch.float64)
14 gae_duplicate tensor(1.0121, dtype=torch.float64) tensor(-2.1033, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8930, dtype=torch.float64) delta_t tensor(0.5018, dtype=torch.float64)
13 gae_duplicate tensor(1.3114, dtype=torch.float64) tensor(-2.7255, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8934, dtype=torch.float64) delta_t tensor(0.0129, dtype=torch.float64)
12 gae_duplicate tensor(1.0621, dtype=torch.float64) tensor(-2.2081, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8938, dtype=torch.float64) delta_t tensor(0.4227, dtype=torch.float64)
11 gae_duplicate tensor(1.2723, dtype=torch.float64) tensor(-2.6452, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8941, dtype=torch.float64) delta_t tensor(0.3940, dtype=torch.float64)
10 gae_duplicate tensor(1.4118, dtype=torch.float64) tensor(-2.9352, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8945, dtype=torch.float64) delta_t tensor(1.6661, dtype=torch.float64)
9 gae_duplicate tensor(2.7955, dtype=torch.float64) tensor(-5.8096, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2443, dtype=torch.float64) delta_t tensor(-1.6041, dtype=torch.float64)
8 gae_duplicate tensor(0.6323, dtype=torch.float64) tensor(-1.3156, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1458, dtype=torch.float64) delta_t tensor(-0.6827, dtype=torch.float64)
7 gae_duplicate tensor(-0.1768, dtype=torch.float64) tensor(0.3676, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1212, dtype=torch.float64) delta_t tensor(1.0506, dtype=torch.float64)
6 gae_duplicate tensor(0.9091, dtype=torch.float64) tensor(-1.8915, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2519, dtype=torch.float64) delta_t tensor(-0.7556, dtype=torch.float64)
5 gae_duplicate tensor(-0.0283, dtype=torch.float64) tensor(0.0588, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2281, dtype=torch.float64) delta_t tensor(-1.0983, dtype=torch.float64)
4 gae_duplicate tensor(-1.1209, dtype=torch.float64) tensor(2.3323, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9056, dtype=torch.float64) delta_t tensor(-1.9118, dtype=torch.float64)
3 gae_duplicate tensor(-2.8085, dtype=torch.float64) tensor(5.8413, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4517, dtype=torch.float64) delta_t tensor(-0.4564, dtype=torch.float64)
2 gae_duplicate tensor(-2.7033, dtype=torch.float64) tensor(5.6201, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:28.72115707397461
value loss:53.482810974121094
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.231608152389526 seconds
19 rew tensor(0.8898, dtype=torch.float64) delta_t tensor(-0.7795, dtype=torch.float64)
19 gae_duplicate tensor(-0.7795, dtype=torch.float64) tensor(1.6199, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(0.5612, dtype=torch.float64)
18 gae_duplicate tensor(-0.0624, dtype=torch.float64) tensor(0.1298, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8905, dtype=torch.float64) delta_t tensor(0.6899, dtype=torch.float64)
17 gae_duplicate tensor(0.6400, dtype=torch.float64) tensor(-1.3305, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8908, dtype=torch.float64) delta_t tensor(0.4743, dtype=torch.float64)
16 gae_duplicate tensor(0.9863, dtype=torch.float64) tensor(-2.0505, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8912, dtype=torch.float64) delta_t tensor(0.8690, dtype=torch.float64)
15 gae_duplicate tensor(1.6581, dtype=torch.float64) tensor(-3.4456, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8915, dtype=torch.float64) delta_t tensor(0.6244, dtype=torch.float64)
14 gae_duplicate tensor(1.9508, dtype=torch.float64) tensor(-4.0575, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8919, dtype=torch.float64) delta_t tensor(0.6247, dtype=torch.float64)
13 gae_duplicate tensor(2.1854, dtype=torch.float64) tensor(-4.5414, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8923, dtype=torch.float64) delta_t tensor(0.2327, dtype=torch.float64)
12 gae_duplicate tensor(1.9810, dtype=torch.float64) tensor(-4.1203, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8926, dtype=torch.float64) delta_t tensor(0.6300, dtype=torch.float64)
11 gae_duplicate tensor(2.2148, dtype=torch.float64) tensor(-4.6066, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8930, dtype=torch.float64) delta_t tensor(0.4465, dtype=torch.float64)
10 gae_duplicate tensor(2.2183, dtype=torch.float64) tensor(-4.6119, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8933, dtype=torch.float64) delta_t tensor(0.5471, dtype=torch.float64)
9 gae_duplicate tensor(2.3218, dtype=torch.float64) tensor(-4.8270, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7637, dtype=torch.float64) delta_t tensor(0.4397, dtype=torch.float64)
8 gae_duplicate tensor(2.2971, dtype=torch.float64) tensor(-4.7756, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6659, dtype=torch.float64) delta_t tensor(-0.9314, dtype=torch.float64)
7 gae_duplicate tensor(0.9063, dtype=torch.float64) tensor(-1.8841, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9910, dtype=torch.float64) delta_t tensor(-0.0894, dtype=torch.float64)
6 gae_duplicate tensor(0.6356, dtype=torch.float64) tensor(-1.3209, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2514, dtype=torch.float64) delta_t tensor(-0.7534, dtype=torch.float64)
5 gae_duplicate tensor(-0.2449, dtype=torch.float64) tensor(0.5094, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6820, dtype=torch.float64) delta_t tensor(-2.0655, dtype=torch.float64)
4 gae_duplicate tensor(-2.2614, dtype=torch.float64) tensor(4.7014, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9296, dtype=torch.float64) delta_t tensor(0.2046, dtype=torch.float64)
3 gae_duplicate tensor(-1.6046, dtype=torch.float64) tensor(3.3359, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9951, dtype=torch.float64) delta_t tensor(-0.7257, dtype=torch.float64)
2 gae_duplicate tensor(-2.0093, dtype=torch.float64) tensor(4.1791, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:161.4554443359375
value loss:76.1309814453125
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.718518972396851 seconds
19 rew tensor(0.8896, dtype=torch.float64) delta_t tensor(-0.6787, dtype=torch.float64)
19 gae_duplicate tensor(-0.6787, dtype=torch.float64) tensor(1.4109, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8900, dtype=torch.float64) delta_t tensor(-0.1459, dtype=torch.float64)
18 gae_duplicate tensor(-0.6889, dtype=torch.float64) tensor(1.4328, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8903, dtype=torch.float64) delta_t tensor(0.9469, dtype=torch.float64)
17 gae_duplicate tensor(0.3958, dtype=torch.float64) tensor(-0.8232, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(0.3632, dtype=torch.float64)
16 gae_duplicate tensor(0.6798, dtype=torch.float64) tensor(-1.4125, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8910, dtype=torch.float64) delta_t tensor(0.5003, dtype=torch.float64)
15 gae_duplicate tensor(1.0441, dtype=torch.float64) tensor(-2.1706, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8914, dtype=torch.float64) delta_t tensor(0.4888, dtype=torch.float64)
14 gae_duplicate tensor(1.3241, dtype=torch.float64) tensor(-2.7527, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8917, dtype=torch.float64) delta_t tensor(0.2858, dtype=torch.float64)
13 gae_duplicate tensor(1.3451, dtype=torch.float64) tensor(-2.7950, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8921, dtype=torch.float64) delta_t tensor(0.4909, dtype=torch.float64)
12 gae_duplicate tensor(1.5670, dtype=torch.float64) tensor(-3.2578, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8924, dtype=torch.float64) delta_t tensor(-0.0889, dtype=torch.float64)
11 gae_duplicate tensor(1.1647, dtype=torch.float64) tensor(-2.4213, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4374, dtype=torch.float64) delta_t tensor(0.0352, dtype=torch.float64)
10 gae_duplicate tensor(0.9669, dtype=torch.float64) tensor(-2.0112, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2424, dtype=torch.float64) delta_t tensor(-0.4584, dtype=torch.float64)
9 gae_duplicate tensor(0.3151, dtype=torch.float64) tensor(-0.6551, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1775, dtype=torch.float64) delta_t tensor(0.9804, dtype=torch.float64)
8 gae_duplicate tensor(1.2324, dtype=torch.float64) tensor(-2.5621, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9276, dtype=torch.float64) delta_t tensor(-0.1936, dtype=torch.float64)
7 gae_duplicate tensor(0.7924, dtype=torch.float64) tensor(-1.6481, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0580, dtype=torch.float64) delta_t tensor(-0.5260, dtype=torch.float64)
6 gae_duplicate tensor(0.1079, dtype=torch.float64) tensor(-0.2244, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7086, dtype=torch.float64) delta_t tensor(-0.7236, dtype=torch.float64)
5 gae_duplicate tensor(-0.6373, dtype=torch.float64) tensor(1.3262, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2410, dtype=torch.float64) delta_t tensor(0.6481, dtype=torch.float64)
4 gae_duplicate tensor(0.1383, dtype=torch.float64) tensor(-0.2874, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5146, dtype=torch.float64) delta_t tensor(-0.9712, dtype=torch.float64)
3 gae_duplicate tensor(-0.8606, dtype=torch.float64) tensor(1.7901, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4506, dtype=torch.float64) delta_t tensor(-0.8771, dtype=torch.float64)
2 gae_duplicate tensor(-1.5656, dtype=torch.float64) tensor(3.2563, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:81.70774841308594
value loss:25.242095947265625
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.0606958866119385 seconds
19 rew tensor(0.7610, dtype=torch.float64) delta_t tensor(-1.7585, dtype=torch.float64)
19 gae_duplicate tensor(-1.7585, dtype=torch.float64) tensor(3.6578, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7613, dtype=torch.float64) delta_t tensor(0.2988, dtype=torch.float64)
18 gae_duplicate tensor(-1.1081, dtype=torch.float64) tensor(2.3048, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6314, dtype=torch.float64) delta_t tensor(0.1864, dtype=torch.float64)
17 gae_duplicate tensor(-0.7001, dtype=torch.float64) tensor(1.4553, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3712, dtype=torch.float64) delta_t tensor(0.0349, dtype=torch.float64)
16 gae_duplicate tensor(-0.5251, dtype=torch.float64) tensor(1.0916, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0842, dtype=torch.float64) delta_t tensor(-0.0546, dtype=torch.float64)
15 gae_duplicate tensor(-0.4747, dtype=torch.float64) tensor(0.9862, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6965, dtype=torch.float64) delta_t tensor(0.0890, dtype=torch.float64)
14 gae_duplicate tensor(-0.2907, dtype=torch.float64) tensor(0.6051, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6317, dtype=torch.float64) delta_t tensor(0.3026, dtype=torch.float64)
13 gae_duplicate tensor(0.0700, dtype=torch.float64) tensor(-0.1456, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5018, dtype=torch.float64) delta_t tensor(0.0551, dtype=torch.float64)
12 gae_duplicate tensor(0.1111, dtype=torch.float64) tensor(-0.2310, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8271, dtype=torch.float64) delta_t tensor(0.4013, dtype=torch.float64)
11 gae_duplicate tensor(0.4902, dtype=torch.float64) tensor(-1.0201, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2421, dtype=torch.float64) delta_t tensor(0.6703, dtype=torch.float64)
10 gae_duplicate tensor(1.0625, dtype=torch.float64) tensor(-2.2099, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6323, dtype=torch.float64) delta_t tensor(-0.4200, dtype=torch.float64)
9 gae_duplicate tensor(0.4300, dtype=torch.float64) tensor(-0.8949, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4374, dtype=torch.float64) delta_t tensor(-0.6385, dtype=torch.float64)
8 gae_duplicate tensor(-0.2945, dtype=torch.float64) tensor(0.6122, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1474, dtype=torch.float64) delta_t tensor(0.6222, dtype=torch.float64)
7 gae_duplicate tensor(0.3866, dtype=torch.float64) tensor(-0.8036, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1871, dtype=torch.float64) delta_t tensor(-0.0683, dtype=torch.float64)
6 gae_duplicate tensor(0.2409, dtype=torch.float64) tensor(-0.5014, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4477, dtype=torch.float64) delta_t tensor(-1.4291, dtype=torch.float64)
5 gae_duplicate tensor(-1.2363, dtype=torch.float64) tensor(2.5701, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7087, dtype=torch.float64) delta_t tensor(-0.2977, dtype=torch.float64)
4 gae_duplicate tensor(-1.2868, dtype=torch.float64) tensor(2.6764, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.2954, dtype=torch.float64) delta_t tensor(-1.8991, dtype=torch.float64)
3 gae_duplicate tensor(-2.9285, dtype=torch.float64) tensor(6.0912, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8666, dtype=torch.float64) delta_t tensor(-0.5995, dtype=torch.float64)
2 gae_duplicate tensor(-2.9423, dtype=torch.float64) tensor(6.1198, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-135.30787658691406
value loss:41.51774597167969
entropies:37.42993927001953
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.7072)
ToM Target loss= tensor(306.1970)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.520071744918823 seconds
19 rew tensor(0.8918, dtype=torch.float64) delta_t tensor(-0.4153, dtype=torch.float64)
19 gae_duplicate tensor(-0.4153, dtype=torch.float64) tensor(0.8638, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8922, dtype=torch.float64) delta_t tensor(0.5018, dtype=torch.float64)
18 gae_duplicate tensor(0.1696, dtype=torch.float64) tensor(-0.3525, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8274, dtype=torch.float64) delta_t tensor(0.7287, dtype=torch.float64)
17 gae_duplicate tensor(0.8643, dtype=torch.float64) tensor(-1.7978, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7626, dtype=torch.float64) delta_t tensor(0.5449, dtype=torch.float64)
16 gae_duplicate tensor(1.2364, dtype=torch.float64) tensor(-2.5718, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7628, dtype=torch.float64) delta_t tensor(0.1011, dtype=torch.float64)
15 gae_duplicate tensor(1.0903, dtype=torch.float64) tensor(-2.2678, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6329, dtype=torch.float64) delta_t tensor(0.3227, dtype=torch.float64)
14 gae_duplicate tensor(1.1949, dtype=torch.float64) tensor(-2.4840, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5029, dtype=torch.float64) delta_t tensor(0.3938, dtype=torch.float64)
13 gae_duplicate tensor(1.3497, dtype=torch.float64) tensor(-2.8058, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8936, dtype=torch.float64) delta_t tensor(0.6129, dtype=torch.float64)
12 gae_duplicate tensor(1.6927, dtype=torch.float64) tensor(-3.5209, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8939, dtype=torch.float64) delta_t tensor(0.6133, dtype=torch.float64)
11 gae_duplicate tensor(1.9674, dtype=torch.float64) tensor(-4.0899, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8943, dtype=torch.float64) delta_t tensor(0.6136, dtype=torch.float64)
10 gae_duplicate tensor(2.1876, dtype=torch.float64) tensor(-4.5503, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4722, dtype=torch.float64) delta_t tensor(-0.6903, dtype=torch.float64)
9 gae_duplicate tensor(1.0598, dtype=torch.float64) tensor(-2.2058, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5374, dtype=torch.float64) delta_t tensor(-1.0899, dtype=torch.float64)
8 gae_duplicate tensor(-0.2421, dtype=torch.float64) tensor(0.5029, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6677, dtype=torch.float64) delta_t tensor(-0.4315, dtype=torch.float64)
7 gae_duplicate tensor(-0.6252, dtype=torch.float64) tensor(1.3004, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9932, dtype=torch.float64) delta_t tensor(-0.7784, dtype=torch.float64)
6 gae_duplicate tensor(-1.2785, dtype=torch.float64) tensor(2.6562, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7092, dtype=torch.float64) delta_t tensor(0.5240, dtype=torch.float64)
5 gae_duplicate tensor(-0.4988, dtype=torch.float64) tensor(1.0382, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4266, dtype=torch.float64) delta_t tensor(-1.8371, dtype=torch.float64)
4 gae_duplicate tensor(-2.2362, dtype=torch.float64) tensor(4.6541, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4105, dtype=torch.float64) delta_t tensor(0.2938, dtype=torch.float64)
3 gae_duplicate tensor(-1.4951, dtype=torch.float64) tensor(3.1100, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3455, dtype=torch.float64) delta_t tensor(0.1104, dtype=torch.float64)
2 gae_duplicate tensor(-1.0857, dtype=torch.float64) tensor(2.2570, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:60.46151351928711
value loss:45.46070098876953
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.439030885696411 seconds
19 rew tensor(0.8915, dtype=torch.float64) delta_t tensor(-1.2412, dtype=torch.float64)
19 gae_duplicate tensor(-1.2412, dtype=torch.float64) tensor(2.5803, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8918, dtype=torch.float64) delta_t tensor(0.4885, dtype=torch.float64)
18 gae_duplicate tensor(-0.5045, dtype=torch.float64) tensor(1.0487, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8922, dtype=torch.float64) delta_t tensor(0.3197, dtype=torch.float64)
17 gae_duplicate tensor(-0.0839, dtype=torch.float64) tensor(0.1744, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8925, dtype=torch.float64) delta_t tensor(0.4522, dtype=torch.float64)
16 gae_duplicate tensor(0.3852, dtype=torch.float64) tensor(-0.8001, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8929, dtype=torch.float64) delta_t tensor(0.6064, dtype=torch.float64)
15 gae_duplicate tensor(0.9145, dtype=torch.float64) tensor(-1.9023, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8932, dtype=torch.float64) delta_t tensor(0.5172, dtype=torch.float64)
14 gae_duplicate tensor(1.2489, dtype=torch.float64) tensor(-2.5961, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8935, dtype=torch.float64) delta_t tensor(0.6435, dtype=torch.float64)
13 gae_duplicate tensor(1.6426, dtype=torch.float64) tensor(-3.4167, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8939, dtype=torch.float64) delta_t tensor(-0.1051, dtype=torch.float64)
12 gae_duplicate tensor(1.2090, dtype=torch.float64) tensor(-2.5133, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8942, dtype=torch.float64) delta_t tensor(0.5698, dtype=torch.float64)
11 gae_duplicate tensor(1.5371, dtype=torch.float64) tensor(-3.1952, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5688, dtype=torch.float64) delta_t tensor(1.7927, dtype=torch.float64)
10 gae_duplicate tensor(3.0224, dtype=torch.float64) tensor(-6.2829, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2432, dtype=torch.float64) delta_t tensor(-0.0804, dtype=torch.float64)
9 gae_duplicate tensor(2.3375, dtype=torch.float64) tensor(-4.8654, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4082, dtype=torch.float64) delta_t tensor(-0.3442, dtype=torch.float64)
8 gae_duplicate tensor(1.5258, dtype=torch.float64) tensor(-3.1718, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2129, dtype=torch.float64) delta_t tensor(-0.3050, dtype=torch.float64)
7 gae_duplicate tensor(0.9156, dtype=torch.float64) tensor(-1.9045, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5804, dtype=torch.float64) delta_t tensor(-0.4382, dtype=torch.float64)
6 gae_duplicate tensor(0.2943, dtype=torch.float64) tensor(-0.6114, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4513, dtype=torch.float64) delta_t tensor(-0.6572, dtype=torch.float64)
5 gae_duplicate tensor(-0.4218, dtype=torch.float64) tensor(0.8774, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4098, dtype=torch.float64) delta_t tensor(0.3431, dtype=torch.float64)
4 gae_duplicate tensor(0.0056, dtype=torch.float64) tensor(-0.0117, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9081, dtype=torch.float64) delta_t tensor(-1.0222, dtype=torch.float64)
3 gae_duplicate tensor(-1.0177, dtype=torch.float64) tensor(2.1170, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1503, dtype=torch.float64) delta_t tensor(-0.7786, dtype=torch.float64)
2 gae_duplicate tensor(-1.5928, dtype=torch.float64) tensor(3.3111, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:125.85188293457031
value loss:48.706626892089844
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.640559911727905 seconds
19 rew tensor(0.8883, dtype=torch.float64) delta_t tensor(-0.1257, dtype=torch.float64)
19 gae_duplicate tensor(-0.1257, dtype=torch.float64) tensor(0.2611, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8887, dtype=torch.float64) delta_t tensor(0.6527, dtype=torch.float64)
18 gae_duplicate tensor(0.5521, dtype=torch.float64) tensor(-1.1477, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8890, dtype=torch.float64) delta_t tensor(0.3525, dtype=torch.float64)
17 gae_duplicate tensor(0.7942, dtype=torch.float64) tensor(-1.6509, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(0.6849, dtype=torch.float64)
16 gae_duplicate tensor(1.3203, dtype=torch.float64) tensor(-2.7464, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8897, dtype=torch.float64) delta_t tensor(0.1593, dtype=torch.float64)
15 gae_duplicate tensor(1.2156, dtype=torch.float64) tensor(-2.5285, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8900, dtype=torch.float64) delta_t tensor(0.4853, dtype=torch.float64)
14 gae_duplicate tensor(1.4577, dtype=torch.float64) tensor(-3.0322, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8904, dtype=torch.float64) delta_t tensor(0.5163, dtype=torch.float64)
13 gae_duplicate tensor(1.6824, dtype=torch.float64) tensor(-3.4950, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(0.5241, dtype=torch.float64)
12 gae_duplicate tensor(1.8701, dtype=torch.float64) tensor(-3.8874, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8910, dtype=torch.float64) delta_t tensor(0.5245, dtype=torch.float64)
11 gae_duplicate tensor(2.0205, dtype=torch.float64) tensor(-4.1973, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8914, dtype=torch.float64) delta_t tensor(0.4570, dtype=torch.float64)
10 gae_duplicate tensor(2.0734, dtype=torch.float64) tensor(-4.3100, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8917, dtype=torch.float64) delta_t tensor(0.5452, dtype=torch.float64)
9 gae_duplicate tensor(2.2039, dtype=torch.float64) tensor(-4.5876, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.8921, dtype=torch.float64) delta_t tensor(0.6829, dtype=torch.float64)
8 gae_duplicate tensor(2.4460, dtype=torch.float64) tensor(-5.0881, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5095, dtype=torch.float64) delta_t tensor(-1.7356, dtype=torch.float64)
7 gae_duplicate tensor(0.2212, dtype=torch.float64) tensor(-0.4601, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1859, dtype=torch.float64) delta_t tensor(-0.5160, dtype=torch.float64)
6 gae_duplicate tensor(-0.3390, dtype=torch.float64) tensor(0.7043, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7709, dtype=torch.float64) delta_t tensor(-0.1345, dtype=torch.float64)
5 gae_duplicate tensor(-0.4058, dtype=torch.float64) tensor(0.8440, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.4362, dtype=torch.float64) delta_t tensor(-3.2685, dtype=torch.float64)
4 gae_duplicate tensor(-3.5932, dtype=torch.float64) tensor(7.4693, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4117, dtype=torch.float64) delta_t tensor(0.2648, dtype=torch.float64)
3 gae_duplicate tensor(-2.6097, dtype=torch.float64) tensor(5.4212, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4770, dtype=torch.float64) delta_t tensor(0.0156, dtype=torch.float64)
2 gae_duplicate tensor(-2.0722, dtype=torch.float64) tensor(4.3075, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:107.61943054199219
value loss:84.2856216430664
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.3505940437316895 seconds
19 rew tensor(0.8882, dtype=torch.float64) delta_t tensor(-1.0359, dtype=torch.float64)
19 gae_duplicate tensor(-1.0359, dtype=torch.float64) tensor(2.1533, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8885, dtype=torch.float64) delta_t tensor(0.4951, dtype=torch.float64)
18 gae_duplicate tensor(-0.3336, dtype=torch.float64) tensor(0.6934, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8888, dtype=torch.float64) delta_t tensor(0.6497, dtype=torch.float64)
17 gae_duplicate tensor(0.3828, dtype=torch.float64) tensor(-0.7958, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8892, dtype=torch.float64) delta_t tensor(0.2459, dtype=torch.float64)
16 gae_duplicate tensor(0.5522, dtype=torch.float64) tensor(-1.1478, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8895, dtype=torch.float64) delta_t tensor(0.8521, dtype=torch.float64)
15 gae_duplicate tensor(1.2938, dtype=torch.float64) tensor(-2.6933, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8898, dtype=torch.float64) delta_t tensor(0.2381, dtype=torch.float64)
14 gae_duplicate tensor(1.2732, dtype=torch.float64) tensor(-2.6485, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(0.5067, dtype=torch.float64)
13 gae_duplicate tensor(1.5252, dtype=torch.float64) tensor(-3.1750, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8905, dtype=torch.float64) delta_t tensor(0.4926, dtype=torch.float64)
12 gae_duplicate tensor(1.7128, dtype=torch.float64) tensor(-3.5604, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8908, dtype=torch.float64) delta_t tensor(1.6722, dtype=torch.float64)
11 gae_duplicate tensor(3.0424, dtype=torch.float64) tensor(-6.3244, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4364, dtype=torch.float64) delta_t tensor(0.1767, dtype=torch.float64)
10 gae_duplicate tensor(2.6107, dtype=torch.float64) tensor(-5.4268, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2416, dtype=torch.float64) delta_t tensor(0.1309, dtype=torch.float64)
9 gae_duplicate tensor(2.2195, dtype=torch.float64) tensor(-4.6202, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5014, dtype=torch.float64) delta_t tensor(0.3501, dtype=torch.float64)
8 gae_duplicate tensor(2.1257, dtype=torch.float64) tensor(-4.4155, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7323, dtype=torch.float64) delta_t tensor(-1.6356, dtype=torch.float64)
7 gae_duplicate tensor(0.0650, dtype=torch.float64) tensor(-0.1351, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7975, dtype=torch.float64) delta_t tensor(-1.2714, dtype=torch.float64)
6 gae_duplicate tensor(-1.2194, dtype=torch.float64) tensor(2.5330, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6418, dtype=torch.float64) delta_t tensor(-0.0557, dtype=torch.float64)
5 gae_duplicate tensor(-1.0312, dtype=torch.float64) tensor(2.1437, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1106, dtype=torch.float64) delta_t tensor(1.5539, dtype=torch.float64)
4 gae_duplicate tensor(0.7289, dtype=torch.float64) tensor(-1.5163, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4479, dtype=torch.float64) delta_t tensor(-0.3819, dtype=torch.float64)
3 gae_duplicate tensor(0.2012, dtype=torch.float64) tensor(-0.4186, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4489, dtype=torch.float64) delta_t tensor(-0.9877, dtype=torch.float64)
2 gae_duplicate tensor(-0.8267, dtype=torch.float64) tensor(1.7197, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:164.6844940185547
value loss:59.275718688964844
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.2889039516448975 seconds
19 rew tensor(0.8882, dtype=torch.float64) delta_t tensor(-1.0030, dtype=torch.float64)
19 gae_duplicate tensor(-1.0030, dtype=torch.float64) tensor(2.0848, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8885, dtype=torch.float64) delta_t tensor(0.4633, dtype=torch.float64)
18 gae_duplicate tensor(-0.3391, dtype=torch.float64) tensor(0.7048, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8889, dtype=torch.float64) delta_t tensor(0.5012, dtype=torch.float64)
17 gae_duplicate tensor(0.2300, dtype=torch.float64) tensor(-0.4781, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8892, dtype=torch.float64) delta_t tensor(0.5658, dtype=torch.float64)
16 gae_duplicate tensor(0.7498, dtype=torch.float64) tensor(-1.5585, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8895, dtype=torch.float64) delta_t tensor(0.4356, dtype=torch.float64)
15 gae_duplicate tensor(1.0354, dtype=torch.float64) tensor(-2.1554, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8899, dtype=torch.float64) delta_t tensor(0.1660, dtype=torch.float64)
14 gae_duplicate tensor(0.9943, dtype=torch.float64) tensor(-2.0654, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(0.3518, dtype=torch.float64)
13 gae_duplicate tensor(1.1473, dtype=torch.float64) tensor(-2.3849, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8905, dtype=torch.float64) delta_t tensor(2.3398, dtype=torch.float64)
12 gae_duplicate tensor(3.2576, dtype=torch.float64) tensor(-6.7814, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8909, dtype=torch.float64) delta_t tensor(0.6737, dtype=torch.float64)
11 gae_duplicate tensor(3.2797, dtype=torch.float64) tensor(-6.8225, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5012, dtype=torch.float64) delta_t tensor(0.6316, dtype=torch.float64)
10 gae_duplicate tensor(3.2554, dtype=torch.float64) tensor(-6.7668, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3063, dtype=torch.float64) delta_t tensor(0.2574, dtype=torch.float64)
9 gae_duplicate tensor(2.8617, dtype=torch.float64) tensor(-5.9485, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2785, dtype=torch.float64) delta_t tensor(-0.4253, dtype=torch.float64)
8 gae_duplicate tensor(1.8641, dtype=torch.float64) tensor(-3.8748, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5384, dtype=torch.float64) delta_t tensor(-0.8254, dtype=torch.float64)
7 gae_duplicate tensor(0.6659, dtype=torch.float64) tensor(-1.3851, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2532, dtype=torch.float64) delta_t tensor(-0.2108, dtype=torch.float64)
6 gae_duplicate tensor(0.3219, dtype=torch.float64) tensor(-0.6702, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0456, dtype=torch.float64) delta_t tensor(0.4468, dtype=torch.float64)
5 gae_duplicate tensor(0.7044, dtype=torch.float64) tensor(-1.4642, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9681, dtype=torch.float64) delta_t tensor(-1.2490, dtype=torch.float64)
4 gae_duplicate tensor(-0.6855, dtype=torch.float64) tensor(1.4260, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6451, dtype=torch.float64) delta_t tensor(-1.0059, dtype=torch.float64)
3 gae_duplicate tensor(-1.5543, dtype=torch.float64) tensor(3.2357, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7361, dtype=torch.float64) delta_t tensor(-0.1152, dtype=torch.float64)
2 gae_duplicate tensor(-1.3587, dtype=torch.float64) tensor(2.8242, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:191.3585662841797
value loss:81.77688598632812
entropies:37.429935455322266
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.8875)
ToM Target loss= tensor(305.6886)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.562633991241455 seconds
19 rew tensor(0.8246, dtype=torch.float64) delta_t tensor(-1.8930, dtype=torch.float64)
19 gae_duplicate tensor(-1.8930, dtype=torch.float64) tensor(3.9350, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7598, dtype=torch.float64) delta_t tensor(0.2599, dtype=torch.float64)
18 gae_duplicate tensor(-1.2545, dtype=torch.float64) tensor(2.6097, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6949, dtype=torch.float64) delta_t tensor(0.0808, dtype=torch.float64)
17 gae_duplicate tensor(-0.9228, dtype=torch.float64) tensor(1.9183, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4348, dtype=torch.float64) delta_t tensor(-0.2159, dtype=torch.float64)
16 gae_duplicate tensor(-0.9542, dtype=torch.float64) tensor(1.9864, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0445, dtype=torch.float64) delta_t tensor(-0.1222, dtype=torch.float64)
15 gae_duplicate tensor(-0.8855, dtype=torch.float64) tensor(1.8421, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7602, dtype=torch.float64) delta_t tensor(0.2831, dtype=torch.float64)
14 gae_duplicate tensor(-0.4253, dtype=torch.float64) tensor(0.8848, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5652, dtype=torch.float64) delta_t tensor(0.2123, dtype=torch.float64)
13 gae_duplicate tensor(-0.1279, dtype=torch.float64) tensor(0.2662, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4353, dtype=torch.float64) delta_t tensor(0.0070, dtype=torch.float64)
12 gae_duplicate tensor(-0.0954, dtype=torch.float64) tensor(0.1984, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8256, dtype=torch.float64) delta_t tensor(0.3395, dtype=torch.float64)
11 gae_duplicate tensor(0.2632, dtype=torch.float64) tensor(-0.5475, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2406, dtype=torch.float64) delta_t tensor(-0.5944, dtype=torch.float64)
10 gae_duplicate tensor(-0.3838, dtype=torch.float64) tensor(0.7984, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6958, dtype=torch.float64) delta_t tensor(0.2437, dtype=torch.float64)
9 gae_duplicate tensor(-0.0633, dtype=torch.float64) tensor(0.1317, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4360, dtype=torch.float64) delta_t tensor(2.5921, dtype=torch.float64)
8 gae_duplicate tensor(2.5414, dtype=torch.float64) tensor(-5.2788, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0839, dtype=torch.float64) delta_t tensor(-1.8384, dtype=torch.float64)
7 gae_duplicate tensor(0.1947, dtype=torch.float64) tensor(-0.4051, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7338, dtype=torch.float64) delta_t tensor(-2.1040, dtype=torch.float64)
6 gae_duplicate tensor(-1.9482, dtype=torch.float64) tensor(4.0526, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9940, dtype=torch.float64) delta_t tensor(1.7957, dtype=torch.float64)
5 gae_duplicate tensor(0.2372, dtype=torch.float64) tensor(-0.4927, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4493, dtype=torch.float64) delta_t tensor(0.2989, dtype=torch.float64)
4 gae_duplicate tensor(0.4887, dtype=torch.float64) tensor(-1.0173, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.1002, dtype=torch.float64) delta_t tensor(-1.2430, dtype=torch.float64)
3 gae_duplicate tensor(-0.8520, dtype=torch.float64) tensor(1.7711, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8667, dtype=torch.float64) delta_t tensor(-0.8914, dtype=torch.float64)
2 gae_duplicate tensor(-1.5731, dtype=torch.float64) tensor(3.2699, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-96.66095733642578
value loss:32.87760925292969
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4869771003723145 seconds
19 rew tensor(0.8240, dtype=torch.float64) delta_t tensor(-1.2054, dtype=torch.float64)
19 gae_duplicate tensor(-1.2054, dtype=torch.float64) tensor(2.5074, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7593, dtype=torch.float64) delta_t tensor(0.2418, dtype=torch.float64)
18 gae_duplicate tensor(-0.7225, dtype=torch.float64) tensor(1.5007, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5645, dtype=torch.float64) delta_t tensor(0.6466, dtype=torch.float64)
17 gae_duplicate tensor(0.0686, dtype=torch.float64) tensor(-0.1428, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2395, dtype=torch.float64) delta_t tensor(0.2616, dtype=torch.float64)
16 gae_duplicate tensor(0.3165, dtype=torch.float64) tensor(-0.6579, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.2805, dtype=torch.float64) delta_t tensor(-0.6134, dtype=torch.float64)
15 gae_duplicate tensor(-0.3602, dtype=torch.float64) tensor(0.7482, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(-0.0876, dtype=torch.float64)
14 gae_duplicate tensor(-0.3758, dtype=torch.float64) tensor(0.7811, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8247, dtype=torch.float64) delta_t tensor(0.5836, dtype=torch.float64)
13 gae_duplicate tensor(0.2829, dtype=torch.float64) tensor(-0.5891, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8900, dtype=torch.float64) delta_t tensor(0.5115, dtype=torch.float64)
12 gae_duplicate tensor(0.7378, dtype=torch.float64) tensor(-1.5325, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8903, dtype=torch.float64) delta_t tensor(0.5118, dtype=torch.float64)
11 gae_duplicate tensor(1.1021, dtype=torch.float64) tensor(-2.2890, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8256, dtype=torch.float64) delta_t tensor(0.2360, dtype=torch.float64)
10 gae_duplicate tensor(1.1176, dtype=torch.float64) tensor(-2.3249, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1112, dtype=torch.float64) delta_t tensor(0.8523, dtype=torch.float64)
9 gae_duplicate tensor(1.7464, dtype=torch.float64) tensor(-3.6329, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6683, dtype=torch.float64) delta_t tensor(-1.5537, dtype=torch.float64)
8 gae_duplicate tensor(-0.1566, dtype=torch.float64) tensor(0.3257, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7335, dtype=torch.float64) delta_t tensor(-1.1652, dtype=torch.float64)
7 gae_duplicate tensor(-1.2904, dtype=torch.float64) tensor(2.6824, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4739, dtype=torch.float64) delta_t tensor(-0.1203, dtype=torch.float64)
6 gae_duplicate tensor(-1.1527, dtype=torch.float64) tensor(2.3978, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8637, dtype=torch.float64) delta_t tensor(0.8295, dtype=torch.float64)
5 gae_duplicate tensor(-0.0926, dtype=torch.float64) tensor(0.1924, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.1757, dtype=torch.float64) delta_t tensor(-2.6577, dtype=torch.float64)
4 gae_duplicate tensor(-2.7317, dtype=torch.float64) tensor(5.6782, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0868, dtype=torch.float64) delta_t tensor(0.6480, dtype=torch.float64)
3 gae_duplicate tensor(-1.5374, dtype=torch.float64) tensor(3.1956, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0217, dtype=torch.float64) delta_t tensor(0.3341, dtype=torch.float64)
2 gae_duplicate tensor(-0.8958, dtype=torch.float64) tensor(1.8605, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-65.32868194580078
value loss:33.21553039550781
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.491692066192627 seconds
19 rew tensor(0.8885, dtype=torch.float64) delta_t tensor(-1.8950, dtype=torch.float64)
19 gae_duplicate tensor(-1.8950, dtype=torch.float64) tensor(3.9452, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8888, dtype=torch.float64) delta_t tensor(0.2680, dtype=torch.float64)
18 gae_duplicate tensor(-1.2480, dtype=torch.float64) tensor(2.5982, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8891, dtype=torch.float64) delta_t tensor(0.0849, dtype=torch.float64)
17 gae_duplicate tensor(-0.9135, dtype=torch.float64) tensor(1.8988, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8894, dtype=torch.float64) delta_t tensor(0.7190, dtype=torch.float64)
16 gae_duplicate tensor(-0.0118, dtype=torch.float64) tensor(0.0244, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8898, dtype=torch.float64) delta_t tensor(0.9779, dtype=torch.float64)
15 gae_duplicate tensor(0.9685, dtype=torch.float64) tensor(-2.0148, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(0.1605, dtype=torch.float64)
14 gae_duplicate tensor(0.9353, dtype=torch.float64) tensor(-1.9427, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8904, dtype=torch.float64) delta_t tensor(0.3854, dtype=torch.float64)
13 gae_duplicate tensor(1.1336, dtype=torch.float64) tensor(-2.3582, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(-0.0116, dtype=torch.float64)
12 gae_duplicate tensor(0.8953, dtype=torch.float64) tensor(-1.8594, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8911, dtype=torch.float64) delta_t tensor(0.4115, dtype=torch.float64)
11 gae_duplicate tensor(1.1277, dtype=torch.float64) tensor(-2.3460, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5014, dtype=torch.float64) delta_t tensor(0.0434, dtype=torch.float64)
10 gae_duplicate tensor(0.9456, dtype=torch.float64) tensor(-1.9656, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1483, dtype=torch.float64) delta_t tensor(-1.0078, dtype=torch.float64)
9 gae_duplicate tensor(-0.2513, dtype=torch.float64) tensor(0.5231, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7330, dtype=torch.float64) delta_t tensor(0.3861, dtype=torch.float64)
8 gae_duplicate tensor(0.1850, dtype=torch.float64) tensor(-0.3846, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1880, dtype=torch.float64) delta_t tensor(-3.2951, dtype=torch.float64)
7 gae_duplicate tensor(-3.1471, dtype=torch.float64) tensor(6.5416, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.4230, dtype=torch.float64) delta_t tensor(-0.3766, dtype=torch.float64)
6 gae_duplicate tensor(-2.8942, dtype=torch.float64) tensor(6.0160, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4351, dtype=torch.float64) delta_t tensor(1.7961, dtype=torch.float64)
5 gae_duplicate tensor(-0.5193, dtype=torch.float64) tensor(1.0803, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6456, dtype=torch.float64) delta_t tensor(-1.0403, dtype=torch.float64)
4 gae_duplicate tensor(-1.4558, dtype=torch.float64) tensor(3.0284, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.6298, dtype=torch.float64) delta_t tensor(1.2939, dtype=torch.float64)
3 gae_duplicate tensor(0.1293, dtype=torch.float64) tensor(-0.2687, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5163, dtype=torch.float64) delta_t tensor(-0.9230, dtype=torch.float64)
2 gae_duplicate tensor(-0.8196, dtype=torch.float64) tensor(1.7022, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-86.43329620361328
value loss:50.256187438964844
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.442596912384033 seconds
19 rew tensor(0.8889, dtype=torch.float64) delta_t tensor(-0.6402, dtype=torch.float64)
19 gae_duplicate tensor(-0.6402, dtype=torch.float64) tensor(1.3307, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8892, dtype=torch.float64) delta_t tensor(0.5981, dtype=torch.float64)
18 gae_duplicate tensor(0.0859, dtype=torch.float64) tensor(-0.1788, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8896, dtype=torch.float64) delta_t tensor(0.6395, dtype=torch.float64)
17 gae_duplicate tensor(0.7082, dtype=torch.float64) tensor(-1.4732, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8899, dtype=torch.float64) delta_t tensor(0.9811, dtype=torch.float64)
16 gae_duplicate tensor(1.5477, dtype=torch.float64) tensor(-3.2196, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(0.2321, dtype=torch.float64)
15 gae_duplicate tensor(1.4703, dtype=torch.float64) tensor(-3.0561, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8905, dtype=torch.float64) delta_t tensor(0.5864, dtype=torch.float64)
14 gae_duplicate tensor(1.7626, dtype=torch.float64) tensor(-3.6638, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8909, dtype=torch.float64) delta_t tensor(2.9336, dtype=torch.float64)
13 gae_duplicate tensor(4.3437, dtype=torch.float64) tensor(-9.0286, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0187, dtype=torch.float64) delta_t tensor(0.3090, dtype=torch.float64)
12 gae_duplicate tensor(3.7840, dtype=torch.float64) tensor(-7.8715, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0837, dtype=torch.float64) delta_t tensor(-0.1897, dtype=torch.float64)
11 gae_duplicate tensor(2.8375, dtype=torch.float64) tensor(-5.9076, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1487, dtype=torch.float64) delta_t tensor(-2.1845, dtype=torch.float64)
10 gae_duplicate tensor(0.0855, dtype=torch.float64) tensor(-0.1780, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2137, dtype=torch.float64) delta_t tensor(-0.6016, dtype=torch.float64)
9 gae_duplicate tensor(-0.5331, dtype=torch.float64) tensor(1.1081, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2137, dtype=torch.float64) delta_t tensor(-0.5355, dtype=torch.float64)
8 gae_duplicate tensor(-0.9620, dtype=torch.float64) tensor(1.9995, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6034, dtype=torch.float64) delta_t tensor(-0.8183, dtype=torch.float64)
7 gae_duplicate tensor(-1.5879, dtype=torch.float64) tensor(3.3032, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0580, dtype=torch.float64) delta_t tensor(0.5040, dtype=torch.float64)
6 gae_duplicate tensor(-0.7663, dtype=torch.float64) tensor(1.5953, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2532, dtype=torch.float64) delta_t tensor(-1.7465, dtype=torch.float64)
5 gae_duplicate tensor(-2.3595, dtype=torch.float64) tensor(4.9045, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3966, dtype=torch.float64) delta_t tensor(-1.5589, dtype=torch.float64)
4 gae_duplicate tensor(-3.4465, dtype=torch.float64) tensor(7.1640, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2168, dtype=torch.float64) delta_t tensor(0.5246, dtype=torch.float64)
3 gae_duplicate tensor(-2.2326, dtype=torch.float64) tensor(4.6480, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0217, dtype=torch.float64) delta_t tensor(0.0390, dtype=torch.float64)
2 gae_duplicate tensor(-1.7470, dtype=torch.float64) tensor(3.6285, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:28.24789047241211
value loss:119.44136810302734
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.287421941757202 seconds
19 rew tensor(0.7588, dtype=torch.float64) delta_t tensor(-1.4891, dtype=torch.float64)
19 gae_duplicate tensor(-1.4891, dtype=torch.float64) tensor(3.0977, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6293, dtype=torch.float64) delta_t tensor(0.3250, dtype=torch.float64)
18 gae_duplicate tensor(-0.8663, dtype=torch.float64) tensor(1.8007, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3052, dtype=torch.float64) delta_t tensor(0.3661, dtype=torch.float64)
17 gae_duplicate tensor(-0.3269, dtype=torch.float64) tensor(0.6801, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.1485, dtype=torch.float64) delta_t tensor(-0.4454, dtype=torch.float64)
16 gae_duplicate tensor(-0.7070, dtype=torch.float64) tensor(1.4707, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6293, dtype=torch.float64) delta_t tensor(1.0078, dtype=torch.float64)
15 gae_duplicate tensor(0.4423, dtype=torch.float64) tensor(-0.9200, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4350, dtype=torch.float64) delta_t tensor(0.2492, dtype=torch.float64)
14 gae_duplicate tensor(0.6030, dtype=torch.float64) tensor(-1.2543, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7591, dtype=torch.float64) delta_t tensor(0.7049, dtype=torch.float64)
13 gae_duplicate tensor(1.1873, dtype=torch.float64) tensor(-2.4679, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8890, dtype=torch.float64) delta_t tensor(0.3126, dtype=torch.float64)
12 gae_duplicate tensor(1.2625, dtype=torch.float64) tensor(-2.6242, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8245, dtype=torch.float64) delta_t tensor(-0.2186, dtype=torch.float64)
11 gae_duplicate tensor(0.7914, dtype=torch.float64) tensor(-1.6463, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7600, dtype=torch.float64) delta_t tensor(0.4295, dtype=torch.float64)
10 gae_duplicate tensor(1.0626, dtype=torch.float64) tensor(-2.2122, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4707, dtype=torch.float64) delta_t tensor(-0.9630, dtype=torch.float64)
9 gae_duplicate tensor(-0.1130, dtype=torch.float64) tensor(0.2349, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6651, dtype=torch.float64) delta_t tensor(-0.0389, dtype=torch.float64)
8 gae_duplicate tensor(-0.1293, dtype=torch.float64) tensor(0.2691, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5721, dtype=torch.float64) delta_t tensor(-1.4287, dtype=torch.float64)
7 gae_duplicate tensor(-1.5322, dtype=torch.float64) tensor(3.1874, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1845, dtype=torch.float64) delta_t tensor(-0.3087, dtype=torch.float64)
6 gae_duplicate tensor(-1.5344, dtype=torch.float64) tensor(3.1920, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8611, dtype=torch.float64) delta_t tensor(-0.1363, dtype=torch.float64)
5 gae_duplicate tensor(-1.3638, dtype=torch.float64) tensor(2.8348, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.6840, dtype=torch.float64) delta_t tensor(-4.3949, dtype=torch.float64)
4 gae_duplicate tensor(-5.4860, dtype=torch.float64) tensor(11.4031, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0211, dtype=torch.float64) delta_t tensor(0.9479, dtype=torch.float64)
3 gae_duplicate tensor(-3.4409, dtype=torch.float64) tensor(7.1466, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2162, dtype=torch.float64) delta_t tensor(0.6073, dtype=torch.float64)
2 gae_duplicate tensor(-2.1454, dtype=torch.float64) tensor(4.4668, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-173.0762176513672
value loss:93.03445434570312
entropies:37.429935455322266
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.8316)
ToM Target loss= tensor(305.3841)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.395510196685791 seconds
19 rew tensor(0.6962, dtype=torch.float64) delta_t tensor(-2.0787, dtype=torch.float64)
19 gae_duplicate tensor(-2.0787, dtype=torch.float64) tensor(4.3243, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5664, dtype=torch.float64) delta_t tensor(0.0927, dtype=torch.float64)
18 gae_duplicate tensor(-1.5702, dtype=torch.float64) tensor(3.2665, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2418, dtype=torch.float64) delta_t tensor(-0.4081, dtype=torch.float64)
17 gae_duplicate tensor(-1.6643, dtype=torch.float64) tensor(3.4593, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7614, dtype=torch.float64) delta_t tensor(0.3940, dtype=torch.float64)
16 gae_duplicate tensor(-0.9374, dtype=torch.float64) tensor(1.9468, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5019, dtype=torch.float64) delta_t tensor(0.1240, dtype=torch.float64)
15 gae_duplicate tensor(-0.6259, dtype=torch.float64) tensor(1.2999, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2423, dtype=torch.float64) delta_t tensor(-0.3454, dtype=torch.float64)
14 gae_duplicate tensor(-0.8462, dtype=torch.float64) tensor(1.7603, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6318, dtype=torch.float64) delta_t tensor(0.1662, dtype=torch.float64)
13 gae_duplicate tensor(-0.5108, dtype=torch.float64) tensor(1.0626, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4373, dtype=torch.float64) delta_t tensor(-0.3784, dtype=torch.float64)
12 gae_duplicate tensor(-0.7870, dtype=torch.float64) tensor(1.6385, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1778, dtype=torch.float64) delta_t tensor(-0.3352, dtype=torch.float64)
11 gae_duplicate tensor(-0.9647, dtype=torch.float64) tensor(2.0053, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.1848, dtype=torch.float64) delta_t tensor(0.9896, dtype=torch.float64)
10 gae_duplicate tensor(0.2178, dtype=torch.float64) tensor(-0.4524, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5667, dtype=torch.float64) delta_t tensor(-0.5444, dtype=torch.float64)
9 gae_duplicate tensor(-0.3701, dtype=torch.float64) tensor(0.7693, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0478, dtype=torch.float64) delta_t tensor(0.1068, dtype=torch.float64)
8 gae_duplicate tensor(-0.1893, dtype=torch.float64) tensor(0.3939, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2765, dtype=torch.float64) delta_t tensor(-0.8872, dtype=torch.float64)
7 gae_duplicate tensor(-1.0387, dtype=torch.float64) tensor(2.1573, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8603, dtype=torch.float64) delta_t tensor(0.3416, dtype=torch.float64)
6 gae_duplicate tensor(-0.4894, dtype=torch.float64) tensor(1.0180, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2497, dtype=torch.float64) delta_t tensor(-0.9057, dtype=torch.float64)
5 gae_duplicate tensor(-1.2972, dtype=torch.float64) tensor(2.6964, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3712, dtype=torch.float64) delta_t tensor(1.2440, dtype=torch.float64)
4 gae_duplicate tensor(0.2062, dtype=torch.float64) tensor(-0.4290, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9906, dtype=torch.float64) delta_t tensor(0.1733, dtype=torch.float64)
3 gae_duplicate tensor(0.3383, dtype=torch.float64) tensor(-0.7038, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0559, dtype=torch.float64) delta_t tensor(-2.0634, dtype=torch.float64)
2 gae_duplicate tensor(-1.7927, dtype=torch.float64) tensor(3.7233, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-180.74220275878906
value loss:29.919010162353516
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.427008867263794 seconds
19 rew tensor(0.8266, dtype=torch.float64) delta_t tensor(-0.8239, dtype=torch.float64)
19 gae_duplicate tensor(-0.8239, dtype=torch.float64) tensor(1.7139, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8919, dtype=torch.float64) delta_t tensor(0.0268, dtype=torch.float64)
18 gae_duplicate tensor(-0.6324, dtype=torch.float64) tensor(1.3144, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8272, dtype=torch.float64) delta_t tensor(0.3647, dtype=torch.float64)
17 gae_duplicate tensor(-0.1412, dtype=torch.float64) tensor(0.2935, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8925, dtype=torch.float64) delta_t tensor(0.3747, dtype=torch.float64)
16 gae_duplicate tensor(0.2617, dtype=torch.float64) tensor(-0.5444, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7628, dtype=torch.float64) delta_t tensor(0.3534, dtype=torch.float64)
15 gae_duplicate tensor(0.5628, dtype=torch.float64) tensor(-1.1717, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6981, dtype=torch.float64) delta_t tensor(0.1635, dtype=torch.float64)
14 gae_duplicate tensor(0.6138, dtype=torch.float64) tensor(-1.2768, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6333, dtype=torch.float64) delta_t tensor(-0.1107, dtype=torch.float64)
13 gae_duplicate tensor(0.3803, dtype=torch.float64) tensor(-0.7899, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7634, dtype=torch.float64) delta_t tensor(0.2582, dtype=torch.float64)
12 gae_duplicate tensor(0.5625, dtype=torch.float64) tensor(-1.1682, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8936, dtype=torch.float64) delta_t tensor(0.3287, dtype=torch.float64)
11 gae_duplicate tensor(0.7787, dtype=torch.float64) tensor(-1.6212, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8289, dtype=torch.float64) delta_t tensor(0.2553, dtype=torch.float64)
10 gae_duplicate tensor(0.8783, dtype=torch.float64) tensor(-1.8286, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6645, dtype=torch.float64) delta_t tensor(-1.2157, dtype=torch.float64)
9 gae_duplicate tensor(-0.5131, dtype=torch.float64) tensor(1.0673, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0802, dtype=torch.float64) delta_t tensor(-0.5724, dtype=torch.float64)
8 gae_duplicate tensor(-0.9828, dtype=torch.float64) tensor(2.0429, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8593, dtype=torch.float64) delta_t tensor(-0.7710, dtype=torch.float64)
7 gae_duplicate tensor(-1.5572, dtype=torch.float64) tensor(3.2368, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1842, dtype=torch.float64) delta_t tensor(-1.1234, dtype=torch.float64)
6 gae_duplicate tensor(-2.3692, dtype=torch.float64) tensor(4.9206, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6392, dtype=torch.float64) delta_t tensor(-0.1204, dtype=torch.float64)
5 gae_duplicate tensor(-2.0157, dtype=torch.float64) tensor(4.1899, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4847, dtype=torch.float64) delta_t tensor(-0.9573, dtype=torch.float64)
4 gae_duplicate tensor(-2.5698, dtype=torch.float64) tensor(5.3417, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4079, dtype=torch.float64) delta_t tensor(-0.0340, dtype=torch.float64)
3 gae_duplicate tensor(-2.0899, dtype=torch.float64) tensor(4.3405, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4080, dtype=torch.float64) delta_t tensor(0.4558, dtype=torch.float64)
2 gae_duplicate tensor(-1.2161, dtype=torch.float64) tensor(2.5277, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-136.65394592285156
value loss:44.21934509277344
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.630986928939819 seconds
19 rew tensor(-1.3175, dtype=torch.float64) delta_t tensor(-2.7526, dtype=torch.float64)
19 gae_duplicate tensor(-2.7526, dtype=torch.float64) tensor(5.7173, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8927, dtype=torch.float64) delta_t tensor(0.6057, dtype=torch.float64)
18 gae_duplicate tensor(-1.5964, dtype=torch.float64) tensor(3.3184, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8930, dtype=torch.float64) delta_t tensor(0.0778, dtype=torch.float64)
17 gae_duplicate tensor(-1.1993, dtype=torch.float64) tensor(2.4929, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8283, dtype=torch.float64) delta_t tensor(0.4020, dtype=torch.float64)
16 gae_duplicate tensor(-0.5575, dtype=torch.float64) tensor(1.1587, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8936, dtype=torch.float64) delta_t tensor(0.4942, dtype=torch.float64)
15 gae_duplicate tensor(0.0483, dtype=torch.float64) tensor(-0.1003, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7639, dtype=torch.float64) delta_t tensor(0.2500, dtype=torch.float64)
14 gae_duplicate tensor(0.2886, dtype=torch.float64) tensor(-0.5999, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6991, dtype=torch.float64) delta_t tensor(0.1619, dtype=torch.float64)
13 gae_duplicate tensor(0.3927, dtype=torch.float64) tensor(-0.8170, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6343, dtype=torch.float64) delta_t tensor(0.0405, dtype=torch.float64)
12 gae_duplicate tensor(0.3546, dtype=torch.float64) tensor(-0.7372, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8945, dtype=torch.float64) delta_t tensor(0.4195, dtype=torch.float64)
11 gae_duplicate tensor(0.7032, dtype=torch.float64) tensor(-1.4628, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8948, dtype=torch.float64) delta_t tensor(0.4198, dtype=torch.float64)
10 gae_duplicate tensor(0.9823, dtype=torch.float64) tensor(-2.0404, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4697, dtype=torch.float64) delta_t tensor(-0.9329, dtype=torch.float64)
9 gae_duplicate tensor(-0.1470, dtype=torch.float64) tensor(0.3058, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5348, dtype=torch.float64) delta_t tensor(-0.9408, dtype=torch.float64)
8 gae_duplicate tensor(-1.0584, dtype=torch.float64) tensor(2.2000, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6648, dtype=torch.float64) delta_t tensor(-1.2907, dtype=torch.float64)
7 gae_duplicate tensor(-2.1374, dtype=torch.float64) tensor(4.4429, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1198, dtype=torch.float64) delta_t tensor(-0.4760, dtype=torch.float64)
6 gae_duplicate tensor(-2.1860, dtype=torch.float64) tensor(4.5474, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6400, dtype=torch.float64) delta_t tensor(-1.1290, dtype=torch.float64)
5 gae_duplicate tensor(-2.8778, dtype=torch.float64) tensor(5.9820, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7062, dtype=torch.float64) delta_t tensor(-0.7050, dtype=torch.float64)
4 gae_duplicate tensor(-3.0073, dtype=torch.float64) tensor(6.2558, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6673, dtype=torch.float64) delta_t tensor(-0.0207, dtype=torch.float64)
3 gae_duplicate tensor(-2.4266, dtype=torch.float64) tensor(5.0479, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7975, dtype=torch.float64) delta_t tensor(1.1680, dtype=torch.float64)
2 gae_duplicate tensor(-0.7733, dtype=torch.float64) tensor(1.6098, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-225.05191040039062
value loss:72.00076293945312
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.388254880905151 seconds
19 rew tensor(0.8919, dtype=torch.float64) delta_t tensor(-0.9109, dtype=torch.float64)
19 gae_duplicate tensor(-0.9109, dtype=torch.float64) tensor(1.8936, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8922, dtype=torch.float64) delta_t tensor(0.3538, dtype=torch.float64)
18 gae_duplicate tensor(-0.3750, dtype=torch.float64) tensor(0.7789, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8925, dtype=torch.float64) delta_t tensor(0.2748, dtype=torch.float64)
17 gae_duplicate tensor(-0.0252, dtype=torch.float64) tensor(0.0524, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8928, dtype=torch.float64) delta_t tensor(-0.0178, dtype=torch.float64)
16 gae_duplicate tensor(-0.0380, dtype=torch.float64) tensor(0.0790, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8931, dtype=torch.float64) delta_t tensor(0.4565, dtype=torch.float64)
15 gae_duplicate tensor(0.4262, dtype=torch.float64) tensor(-0.8865, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8935, dtype=torch.float64) delta_t tensor(0.3528, dtype=torch.float64)
14 gae_duplicate tensor(0.6937, dtype=torch.float64) tensor(-1.4410, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8938, dtype=torch.float64) delta_t tensor(0.1968, dtype=torch.float64)
13 gae_duplicate tensor(0.7518, dtype=torch.float64) tensor(-1.5628, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8941, dtype=torch.float64) delta_t tensor(0.3386, dtype=torch.float64)
12 gae_duplicate tensor(0.9401, dtype=torch.float64) tensor(-1.9542, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8944, dtype=torch.float64) delta_t tensor(0.3390, dtype=torch.float64)
11 gae_duplicate tensor(1.0910, dtype=torch.float64) tensor(-2.2695, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8947, dtype=torch.float64) delta_t tensor(0.4372, dtype=torch.float64)
10 gae_duplicate tensor(1.3100, dtype=torch.float64) tensor(-2.7231, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6352, dtype=torch.float64) delta_t tensor(-0.1145, dtype=torch.float64)
9 gae_duplicate tensor(0.9335, dtype=torch.float64) tensor(-1.9404, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2456, dtype=torch.float64) delta_t tensor(1.5206, dtype=torch.float64)
8 gae_duplicate tensor(2.2673, dtype=torch.float64) tensor(-4.7131, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3389, dtype=torch.float64) delta_t tensor(-1.7859, dtype=torch.float64)
7 gae_duplicate tensor(0.0279, dtype=torch.float64) tensor(-0.0582, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0533, dtype=torch.float64) delta_t tensor(0.5379, dtype=torch.float64)
6 gae_duplicate tensor(0.5603, dtype=torch.float64) tensor(-1.1637, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0278, dtype=torch.float64) delta_t tensor(-0.3258, dtype=torch.float64)
5 gae_duplicate tensor(0.1224, dtype=torch.float64) tensor(-0.2545, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2247, dtype=torch.float64) delta_t tensor(-2.9022, dtype=torch.float64)
4 gae_duplicate tensor(-2.8042, dtype=torch.float64) tensor(5.8290, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7967, dtype=torch.float64) delta_t tensor(1.2163, dtype=torch.float64)
3 gae_duplicate tensor(-1.0271, dtype=torch.float64) tensor(2.1365, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5772, dtype=torch.float64) delta_t tensor(-2.7688, dtype=torch.float64)
2 gae_duplicate tensor(-3.5904, dtype=torch.float64) tensor(7.4687, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3.250737190246582
value loss:51.213417053222656
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.603039979934692 seconds
19 rew tensor(0.8915, dtype=torch.float64) delta_t tensor(-1.5158, dtype=torch.float64)
19 gae_duplicate tensor(-1.5158, dtype=torch.float64) tensor(3.1486, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8918, dtype=torch.float64) delta_t tensor(0.2869, dtype=torch.float64)
18 gae_duplicate tensor(-0.9258, dtype=torch.float64) tensor(1.9258, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8921, dtype=torch.float64) delta_t tensor(0.1321, dtype=torch.float64)
17 gae_duplicate tensor(-0.6086, dtype=torch.float64) tensor(1.2650, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8924, dtype=torch.float64) delta_t tensor(0.6273, dtype=torch.float64)
16 gae_duplicate tensor(0.1405, dtype=torch.float64) tensor(-0.2918, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8927, dtype=torch.float64) delta_t tensor(0.8354, dtype=torch.float64)
15 gae_duplicate tensor(0.9477, dtype=torch.float64) tensor(-1.9715, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8930, dtype=torch.float64) delta_t tensor(0.5116, dtype=torch.float64)
14 gae_duplicate tensor(1.2698, dtype=torch.float64) tensor(-2.6395, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8933, dtype=torch.float64) delta_t tensor(0.4824, dtype=torch.float64)
13 gae_duplicate tensor(1.4983, dtype=torch.float64) tensor(-3.1167, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8936, dtype=torch.float64) delta_t tensor(0.2314, dtype=torch.float64)
12 gae_duplicate tensor(1.4300, dtype=torch.float64) tensor(-2.9726, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8939, dtype=torch.float64) delta_t tensor(0.4568, dtype=torch.float64)
11 gae_duplicate tensor(1.6008, dtype=torch.float64) tensor(-3.3324, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8943, dtype=torch.float64) delta_t tensor(0.3476, dtype=torch.float64)
10 gae_duplicate tensor(1.6282, dtype=torch.float64) tensor(-3.3846, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8946, dtype=torch.float64) delta_t tensor(1.4943, dtype=torch.float64)
9 gae_duplicate tensor(2.7969, dtype=torch.float64) tensor(-5.8222, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0791, dtype=torch.float64) delta_t tensor(-1.4677, dtype=torch.float64)
8 gae_duplicate tensor(0.7698, dtype=torch.float64) tensor(-1.6014, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9879, dtype=torch.float64) delta_t tensor(-1.3164, dtype=torch.float64)
7 gae_duplicate tensor(-0.7006, dtype=torch.float64) tensor(1.4552, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1182, dtype=torch.float64) delta_t tensor(0.8738, dtype=torch.float64)
6 gae_duplicate tensor(0.3134, dtype=torch.float64) tensor(-0.6514, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4432, dtype=torch.float64) delta_t tensor(-1.3208, dtype=torch.float64)
5 gae_duplicate tensor(-1.0701, dtype=torch.float64) tensor(2.2259, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8337, dtype=torch.float64) delta_t tensor(-0.0846, dtype=torch.float64)
4 gae_duplicate tensor(-0.9407, dtype=torch.float64) tensor(1.9568, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.0951, dtype=torch.float64) delta_t tensor(-0.9121, dtype=torch.float64)
3 gae_duplicate tensor(-1.6647, dtype=torch.float64) tensor(3.4653, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7322, dtype=torch.float64) delta_t tensor(-1.4845, dtype=torch.float64)
2 gae_duplicate tensor(-2.8163, dtype=torch.float64) tensor(5.8540, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:25.80229377746582
value loss:55.94312286376953
entropies:37.429935455322266
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.4530)
ToM Target loss= tensor(305.9764)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.569940090179443 seconds
19 rew tensor(0.8271, dtype=torch.float64) delta_t tensor(-1.5141, dtype=torch.float64)
19 gae_duplicate tensor(-1.5141, dtype=torch.float64) tensor(3.1495, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8274, dtype=torch.float64) delta_t tensor(0.3401, dtype=torch.float64)
18 gae_duplicate tensor(-0.8712, dtype=torch.float64) tensor(1.8110, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7626, dtype=torch.float64) delta_t tensor(0.2138, dtype=torch.float64)
17 gae_duplicate tensor(-0.4832, dtype=torch.float64) tensor(1.0051, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6978, dtype=torch.float64) delta_t tensor(0.5045, dtype=torch.float64)
16 gae_duplicate tensor(0.1180, dtype=torch.float64) tensor(-0.2455, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3730, dtype=torch.float64) delta_t tensor(0.4915, dtype=torch.float64)
15 gae_duplicate tensor(0.5859, dtype=torch.float64) tensor(-1.2188, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0818, dtype=torch.float64) delta_t tensor(0.5594, dtype=torch.float64)
14 gae_duplicate tensor(1.0282, dtype=torch.float64) tensor(-2.1373, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5030, dtype=torch.float64) delta_t tensor(1.0379, dtype=torch.float64)
13 gae_duplicate tensor(1.8604, dtype=torch.float64) tensor(-3.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8929, dtype=torch.float64) delta_t tensor(0.8982, dtype=torch.float64)
12 gae_duplicate tensor(2.3865, dtype=torch.float64) tensor(-4.9609, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8932, dtype=torch.float64) delta_t tensor(0.8985, dtype=torch.float64)
11 gae_duplicate tensor(2.8078, dtype=torch.float64) tensor(-5.8365, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7636, dtype=torch.float64) delta_t tensor(0.8802, dtype=torch.float64)
10 gae_duplicate tensor(3.1264, dtype=torch.float64) tensor(-6.4989, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6339, dtype=torch.float64) delta_t tensor(0.0570, dtype=torch.float64)
9 gae_duplicate tensor(2.5582, dtype=torch.float64) tensor(-5.3214, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5691, dtype=torch.float64) delta_t tensor(0.0970, dtype=torch.float64)
8 gae_duplicate tensor(2.1435, dtype=torch.float64) tensor(-4.4589, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5348, dtype=torch.float64) delta_t tensor(-0.1908, dtype=torch.float64)
7 gae_duplicate tensor(1.5240, dtype=torch.float64) tensor(-3.1702, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2102, dtype=torch.float64) delta_t tensor(0.0342, dtype=torch.float64)
6 gae_duplicate tensor(1.2534, dtype=torch.float64) tensor(-2.6036, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5087, dtype=torch.float64) delta_t tensor(0.2794, dtype=torch.float64)
5 gae_duplicate tensor(1.2821, dtype=torch.float64) tensor(-2.6652, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9642, dtype=torch.float64) delta_t tensor(-2.6669, dtype=torch.float64)
4 gae_duplicate tensor(-1.6412, dtype=torch.float64) tensor(3.4117, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0564, dtype=torch.float64) delta_t tensor(1.0956, dtype=torch.float64)
3 gae_duplicate tensor(-0.2174, dtype=torch.float64) tensor(0.4519, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1868, dtype=torch.float64) delta_t tensor(-0.3845, dtype=torch.float64)
2 gae_duplicate tensor(-0.5584, dtype=torch.float64) tensor(1.1607, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:190.8279571533203
value loss:76.86453247070312
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.228881120681763 seconds
19 rew tensor(0.5696, dtype=torch.float64) delta_t tensor(-1.2961, dtype=torch.float64)
19 gae_duplicate tensor(-1.2961, dtype=torch.float64) tensor(2.6979, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2445, dtype=torch.float64) delta_t tensor(-0.1673, dtype=torch.float64)
18 gae_duplicate tensor(-1.2042, dtype=torch.float64) tensor(2.5066, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.2756, dtype=torch.float64) delta_t tensor(-0.6615, dtype=torch.float64)
17 gae_duplicate tensor(-1.6249, dtype=torch.float64) tensor(3.3777, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-1.5759, dtype=torch.float64) delta_t tensor(-1.8915, dtype=torch.float64)
16 gae_duplicate tensor(-3.1914, dtype=torch.float64) tensor(6.6340, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8942, dtype=torch.float64) delta_t tensor(0.5256, dtype=torch.float64)
15 gae_duplicate tensor(-2.0275, dtype=torch.float64) tensor(4.2147, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8295, dtype=torch.float64) delta_t tensor(0.5580, dtype=torch.float64)
14 gae_duplicate tensor(-1.0640, dtype=torch.float64) tensor(2.2104, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7647, dtype=torch.float64) delta_t tensor(0.2918, dtype=torch.float64)
13 gae_duplicate tensor(-0.5594, dtype=torch.float64) tensor(1.1637, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6349, dtype=torch.float64) delta_t tensor(0.5544, dtype=torch.float64)
12 gae_duplicate tensor(0.1069, dtype=torch.float64) tensor(-0.2224, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8951, dtype=torch.float64) delta_t tensor(0.0815, dtype=torch.float64)
11 gae_duplicate tensor(0.1670, dtype=torch.float64) tensor(-0.3472, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7654, dtype=torch.float64) delta_t tensor(0.1830, dtype=torch.float64)
10 gae_duplicate tensor(0.3166, dtype=torch.float64) tensor(-0.6586, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1195, dtype=torch.float64) delta_t tensor(-1.6359, dtype=torch.float64)
9 gae_duplicate tensor(-1.3826, dtype=torch.float64) tensor(2.8740, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5349, dtype=torch.float64) delta_t tensor(-1.0237, dtype=torch.float64)
8 gae_duplicate tensor(-2.1297, dtype=torch.float64) tensor(4.4271, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6650, dtype=torch.float64) delta_t tensor(-0.6766, dtype=torch.float64)
7 gae_duplicate tensor(-2.3804, dtype=torch.float64) tensor(4.9482, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1852, dtype=torch.float64) delta_t tensor(-1.6380, dtype=torch.float64)
6 gae_duplicate tensor(-3.5423, dtype=torch.float64) tensor(7.3683, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0307, dtype=torch.float64) delta_t tensor(1.0693, dtype=torch.float64)
5 gae_duplicate tensor(-1.7645, dtype=torch.float64) tensor(3.6680, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6669, dtype=torch.float64) delta_t tensor(-0.4483, dtype=torch.float64)
4 gae_duplicate tensor(-1.8599, dtype=torch.float64) tensor(3.8689, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8622, dtype=torch.float64) delta_t tensor(0.0497, dtype=torch.float64)
3 gae_duplicate tensor(-1.4382, dtype=torch.float64) tensor(2.9898, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9275, dtype=torch.float64) delta_t tensor(0.5315, dtype=torch.float64)
2 gae_duplicate tensor(-0.6190, dtype=torch.float64) tensor(1.2877, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-319.1755676269531
value loss:83.00389099121094
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.654114007949829 seconds
19 rew tensor(0.7658, dtype=torch.float64) delta_t tensor(-1.8040, dtype=torch.float64)
19 gae_duplicate tensor(-1.8040, dtype=torch.float64) tensor(3.7501, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7660, dtype=torch.float64) delta_t tensor(0.3166, dtype=torch.float64)
18 gae_duplicate tensor(-1.1266, dtype=torch.float64) tensor(2.3405, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6360, dtype=torch.float64) delta_t tensor(0.2634, dtype=torch.float64)
17 gae_duplicate tensor(-0.6379, dtype=torch.float64) tensor(1.3260, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3758, dtype=torch.float64) delta_t tensor(0.1897, dtype=torch.float64)
16 gae_duplicate tensor(-0.3206, dtype=torch.float64) tensor(0.6673, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0796, dtype=torch.float64) delta_t tensor(-0.5557, dtype=torch.float64)
15 gae_duplicate tensor(-0.8122, dtype=torch.float64) tensor(1.6884, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7662, dtype=torch.float64) delta_t tensor(-0.0040, dtype=torch.float64)
14 gae_duplicate tensor(-0.6537, dtype=torch.float64) tensor(1.3590, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5713, dtype=torch.float64) delta_t tensor(0.3488, dtype=torch.float64)
13 gae_duplicate tensor(-0.1742, dtype=torch.float64) tensor(0.3626, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5064, dtype=torch.float64) delta_t tensor(0.1544, dtype=torch.float64)
12 gae_duplicate tensor(0.0150, dtype=torch.float64) tensor(-0.0312, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8967, dtype=torch.float64) delta_t tensor(3.5706, dtype=torch.float64)
11 gae_duplicate tensor(3.5826, dtype=torch.float64) tensor(-7.4474, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7019, dtype=torch.float64) delta_t tensor(-2.3841, dtype=torch.float64)
10 gae_duplicate tensor(0.4819, dtype=torch.float64) tensor(-1.0025, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5721, dtype=torch.float64) delta_t tensor(-0.1665, dtype=torch.float64)
9 gae_duplicate tensor(0.2190, dtype=torch.float64) tensor(-0.4553, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3121, dtype=torch.float64) delta_t tensor(-0.4525, dtype=torch.float64)
8 gae_duplicate tensor(-0.2773, dtype=torch.float64) tensor(0.5768, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4030, dtype=torch.float64) delta_t tensor(1.0651, dtype=torch.float64)
7 gae_duplicate tensor(0.8433, dtype=torch.float64) tensor(-1.7529, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3132, dtype=torch.float64) delta_t tensor(-3.0401, dtype=torch.float64)
6 gae_duplicate tensor(-2.3655, dtype=torch.float64) tensor(4.9238, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7690, dtype=torch.float64) delta_t tensor(0.4599, dtype=torch.float64)
5 gae_duplicate tensor(-1.4325, dtype=torch.float64) tensor(2.9780, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2744, dtype=torch.float64) delta_t tensor(1.7015, dtype=torch.float64)
4 gae_duplicate tensor(0.5554, dtype=torch.float64) tensor(-1.1547, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9653, dtype=torch.float64) delta_t tensor(-1.2956, dtype=torch.float64)
3 gae_duplicate tensor(-0.8512, dtype=torch.float64) tensor(1.7695, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6658, dtype=torch.float64) delta_t tensor(-0.4452, dtype=torch.float64)
2 gae_duplicate tensor(-1.1261, dtype=torch.float64) tensor(2.3440, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-74.57381439208984
value loss:45.00516891479492
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.3088648319244385 seconds
19 rew tensor(0.8952, dtype=torch.float64) delta_t tensor(-0.8797, dtype=torch.float64)
19 gae_duplicate tensor(-0.8797, dtype=torch.float64) tensor(1.8311, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8955, dtype=torch.float64) delta_t tensor(0.5183, dtype=torch.float64)
18 gae_duplicate tensor(-0.1855, dtype=torch.float64) tensor(0.3856, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8958, dtype=torch.float64) delta_t tensor(0.5468, dtype=torch.float64)
17 gae_duplicate tensor(0.3984, dtype=torch.float64) tensor(-0.8281, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8961, dtype=torch.float64) delta_t tensor(1.3572, dtype=torch.float64)
16 gae_duplicate tensor(1.6759, dtype=torch.float64) tensor(-3.4860, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8964, dtype=torch.float64) delta_t tensor(0.7027, dtype=torch.float64)
15 gae_duplicate tensor(2.0434, dtype=torch.float64) tensor(-4.2451, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8967, dtype=torch.float64) delta_t tensor(0.4669, dtype=torch.float64)
14 gae_duplicate tensor(2.1017, dtype=torch.float64) tensor(-4.3717, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8970, dtype=torch.float64) delta_t tensor(0.5894, dtype=torch.float64)
13 gae_duplicate tensor(2.2707, dtype=torch.float64) tensor(-4.7233, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8973, dtype=torch.float64) delta_t tensor(0.5836, dtype=torch.float64)
12 gae_duplicate tensor(2.4002, dtype=torch.float64) tensor(-4.9895, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8976, dtype=torch.float64) delta_t tensor(0.1464, dtype=torch.float64)
11 gae_duplicate tensor(2.0666, dtype=torch.float64) tensor(-4.2960, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8979, dtype=torch.float64) delta_t tensor(0.4406, dtype=torch.float64)
10 gae_duplicate tensor(2.0939, dtype=torch.float64) tensor(-4.3555, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8982, dtype=torch.float64) delta_t tensor(0.4993, dtype=torch.float64)
9 gae_duplicate tensor(2.1744, dtype=torch.float64) tensor(-4.5230, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7265, dtype=torch.float64) delta_t tensor(0.1448, dtype=torch.float64)
8 gae_duplicate tensor(1.8844, dtype=torch.float64) tensor(-3.9195, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5716, dtype=torch.float64) delta_t tensor(-2.3634, dtype=torch.float64)
7 gae_duplicate tensor(-0.8560, dtype=torch.float64) tensor(1.7793, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.6128, dtype=torch.float64) delta_t tensor(-2.8794, dtype=torch.float64)
6 gae_duplicate tensor(-3.5641, dtype=torch.float64) tensor(7.4140, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9008, dtype=torch.float64) delta_t tensor(0.5891, dtype=torch.float64)
5 gae_duplicate tensor(-2.2622, dtype=torch.float64) tensor(4.7026, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8373, dtype=torch.float64) delta_t tensor(0.1069, dtype=torch.float64)
4 gae_duplicate tensor(-1.7029, dtype=torch.float64) tensor(3.5423, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4708, dtype=torch.float64) delta_t tensor(0.3392, dtype=torch.float64)
3 gae_duplicate tensor(-1.0231, dtype=torch.float64) tensor(2.1282, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5360, dtype=torch.float64) delta_t tensor(0.1956, dtype=torch.float64)
2 gae_duplicate tensor(-0.6229, dtype=torch.float64) tensor(1.2948, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:98.83585357666016
value loss:94.66156768798828
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.388859033584595 seconds
19 rew tensor(0.7659, dtype=torch.float64) delta_t tensor(-1.3409, dtype=torch.float64)
19 gae_duplicate tensor(-1.3409, dtype=torch.float64) tensor(2.7874, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7011, dtype=torch.float64) delta_t tensor(0.4682, dtype=torch.float64)
18 gae_duplicate tensor(-0.6046, dtype=torch.float64) tensor(1.2567, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5713, dtype=torch.float64) delta_t tensor(0.1801, dtype=torch.float64)
17 gae_duplicate tensor(-0.3035, dtype=torch.float64) tensor(0.6306, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4414, dtype=torch.float64) delta_t tensor(0.1355, dtype=torch.float64)
16 gae_duplicate tensor(-0.1074, dtype=torch.float64) tensor(0.2232, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3765, dtype=torch.float64) delta_t tensor(0.1114, dtype=torch.float64)
15 gae_duplicate tensor(0.0255, dtype=torch.float64) tensor(-0.0530, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0132, dtype=torch.float64) delta_t tensor(-0.1179, dtype=torch.float64)
14 gae_duplicate tensor(-0.0976, dtype=torch.float64) tensor(0.2028, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7663, dtype=torch.float64) delta_t tensor(0.3702, dtype=torch.float64)
13 gae_duplicate tensor(0.2922, dtype=torch.float64) tensor(-0.6081, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8315, dtype=torch.float64) delta_t tensor(0.4690, dtype=torch.float64)
12 gae_duplicate tensor(0.7028, dtype=torch.float64) tensor(-1.4618, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8967, dtype=torch.float64) delta_t tensor(0.0814, dtype=torch.float64)
11 gae_duplicate tensor(0.6436, dtype=torch.float64) tensor(-1.3395, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.8959, dtype=torch.float64) delta_t tensor(-2.1875, dtype=torch.float64)
10 gae_duplicate tensor(-1.6726, dtype=torch.float64) tensor(3.4770, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6368, dtype=torch.float64) delta_t tensor(0.2706, dtype=torch.float64)
9 gae_duplicate tensor(-1.0675, dtype=torch.float64) tensor(2.2206, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2471, dtype=torch.float64) delta_t tensor(0.6238, dtype=torch.float64)
8 gae_duplicate tensor(-0.2302, dtype=torch.float64) tensor(0.4785, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3375, dtype=torch.float64) delta_t tensor(-0.0388, dtype=torch.float64)
7 gae_duplicate tensor(-0.2230, dtype=torch.float64) tensor(0.4635, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0778, dtype=torch.float64) delta_t tensor(0.5783, dtype=torch.float64)
6 gae_duplicate tensor(0.3999, dtype=torch.float64) tensor(-0.8319, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.2209, dtype=torch.float64) delta_t tensor(-0.5846, dtype=torch.float64)
5 gae_duplicate tensor(-0.2647, dtype=torch.float64) tensor(0.5499, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2234, dtype=torch.float64) delta_t tensor(-2.8473, dtype=torch.float64)
4 gae_duplicate tensor(-3.0591, dtype=torch.float64) tensor(6.3592, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1156, dtype=torch.float64) delta_t tensor(2.2368, dtype=torch.float64)
3 gae_duplicate tensor(-0.2105, dtype=torch.float64) tensor(0.4378, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7052, dtype=torch.float64) delta_t tensor(-1.0939, dtype=torch.float64)
2 gae_duplicate tensor(-1.2623, dtype=torch.float64) tensor(2.6256, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-105.63526916503906
value loss:27.804386138916016
entropies:37.42993927001953
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.4098)
ToM Target loss= tensor(306.3871)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.498714923858643 seconds
19 rew tensor(0.7022, dtype=torch.float64) delta_t tensor(-0.8148, dtype=torch.float64)
19 gae_duplicate tensor(-0.8148, dtype=torch.float64) tensor(1.6959, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8325, dtype=torch.float64) delta_t tensor(0.1501, dtype=torch.float64)
18 gae_duplicate tensor(-0.5018, dtype=torch.float64) tensor(1.0424, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6376, dtype=torch.float64) delta_t tensor(0.3680, dtype=torch.float64)
17 gae_duplicate tensor(-0.0334, dtype=torch.float64) tensor(0.0694, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4426, dtype=torch.float64) delta_t tensor(0.3262, dtype=torch.float64)
16 gae_duplicate tensor(0.2995, dtype=torch.float64) tensor(-0.6229, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0524, dtype=torch.float64) delta_t tensor(0.9467, dtype=torch.float64)
15 gae_duplicate tensor(1.1863, dtype=torch.float64) tensor(-2.4645, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.6629, dtype=torch.float64) delta_t tensor(1.5461, dtype=torch.float64)
14 gae_duplicate tensor(2.4952, dtype=torch.float64) tensor(-5.1869, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8325, dtype=torch.float64) delta_t tensor(1.3017, dtype=torch.float64)
13 gae_duplicate tensor(3.2978, dtype=torch.float64) tensor(-6.8555, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8978, dtype=torch.float64) delta_t tensor(1.3013, dtype=torch.float64)
12 gae_duplicate tensor(3.9396, dtype=torch.float64) tensor(-8.1845, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8981, dtype=torch.float64) delta_t tensor(-1.9868, dtype=torch.float64)
11 gae_duplicate tensor(1.1648, dtype=torch.float64) tensor(-2.4199, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7033, dtype=torch.float64) delta_t tensor(0.6296, dtype=torch.float64)
10 gae_duplicate tensor(1.5614, dtype=torch.float64) tensor(-3.2458, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7267, dtype=torch.float64) delta_t tensor(-1.5283, dtype=torch.float64)
9 gae_duplicate tensor(-0.2792, dtype=torch.float64) tensor(0.5808, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8569, dtype=torch.float64) delta_t tensor(-1.1854, dtype=torch.float64)
8 gae_duplicate tensor(-1.4088, dtype=torch.float64) tensor(2.9286, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3778, dtype=torch.float64) delta_t tensor(0.2563, dtype=torch.float64)
7 gae_duplicate tensor(-0.8707, dtype=torch.float64) tensor(1.8089, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3119, dtype=torch.float64) delta_t tensor(-0.9447, dtype=torch.float64)
6 gae_duplicate tensor(-1.6413, dtype=torch.float64) tensor(3.4141, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0525, dtype=torch.float64) delta_t tensor(1.8982, dtype=torch.float64)
5 gae_duplicate tensor(0.5852, dtype=torch.float64) tensor(-1.2173, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3530, dtype=torch.float64) delta_t tensor(-2.0989, dtype=torch.float64)
4 gae_duplicate tensor(-1.6308, dtype=torch.float64) tensor(3.3901, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3391, dtype=torch.float64) delta_t tensor(1.6932, dtype=torch.float64)
3 gae_duplicate tensor(0.3886, dtype=torch.float64) tensor(-0.8084, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4042, dtype=torch.float64) delta_t tensor(0.3955, dtype=torch.float64)
2 gae_duplicate tensor(0.7064, dtype=torch.float64) tensor(-1.4694, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:104.14599609375
value loss:71.99523162841797
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.113105297088623 seconds
19 rew tensor(0.6388, dtype=torch.float64) delta_t tensor(-0.8147, dtype=torch.float64)
19 gae_duplicate tensor(-0.8147, dtype=torch.float64) tensor(1.6937, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3784, dtype=torch.float64) delta_t tensor(0.1300, dtype=torch.float64)
18 gae_duplicate tensor(-0.5218, dtype=torch.float64) tensor(1.0860, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0775, dtype=torch.float64) delta_t tensor(-0.2813, dtype=torch.float64)
17 gae_duplicate tensor(-0.6987, dtype=torch.float64) tensor(1.4516, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-1.0543, dtype=torch.float64) delta_t tensor(-1.2392, dtype=torch.float64)
16 gae_duplicate tensor(-1.7981, dtype=torch.float64) tensor(3.7403, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8339, dtype=torch.float64) delta_t tensor(0.7002, dtype=torch.float64)
15 gae_duplicate tensor(-0.7383, dtype=torch.float64) tensor(1.5367, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8341, dtype=torch.float64) delta_t tensor(1.0594, dtype=torch.float64)
14 gae_duplicate tensor(0.4688, dtype=torch.float64) tensor(-0.9744, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7041, dtype=torch.float64) delta_t tensor(0.0526, dtype=torch.float64)
13 gae_duplicate tensor(0.4276, dtype=torch.float64) tensor(-0.8895, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6392, dtype=torch.float64) delta_t tensor(0.7950, dtype=torch.float64)
12 gae_duplicate tensor(1.1371, dtype=torch.float64) tensor(-2.3623, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(-0.1399, dtype=torch.float64)
11 gae_duplicate tensor(0.7697, dtype=torch.float64) tensor(-1.6011, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8350, dtype=torch.float64) delta_t tensor(0.5208, dtype=torch.float64)
10 gae_duplicate tensor(1.1366, dtype=torch.float64) tensor(-2.3627, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1843, dtype=torch.float64) delta_t tensor(-0.1458, dtype=torch.float64)
9 gae_duplicate tensor(0.7635, dtype=torch.float64) tensor(-1.5881, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5316, dtype=torch.float64) delta_t tensor(-0.8720, dtype=torch.float64)
8 gae_duplicate tensor(-0.2613, dtype=torch.float64) tensor(0.5434, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0540, dtype=torch.float64) delta_t tensor(0.0226, dtype=torch.float64)
7 gae_duplicate tensor(-0.1864, dtype=torch.float64) tensor(0.3879, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0521, dtype=torch.float64) delta_t tensor(-1.1209, dtype=torch.float64)
6 gae_duplicate tensor(-1.2700, dtype=torch.float64) tensor(2.6418, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8333, dtype=torch.float64) delta_t tensor(-0.3245, dtype=torch.float64)
5 gae_duplicate tensor(-1.3405, dtype=torch.float64) tensor(2.7885, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4027, dtype=torch.float64) delta_t tensor(1.0416, dtype=torch.float64)
4 gae_duplicate tensor(-0.0308, dtype=torch.float64) tensor(0.0641, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7933, dtype=torch.float64) delta_t tensor(0.5296, dtype=torch.float64)
3 gae_duplicate tensor(0.5049, dtype=torch.float64) tensor(-1.0497, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7935, dtype=torch.float64) delta_t tensor(-0.0203, dtype=torch.float64)
2 gae_duplicate tensor(0.3837, dtype=torch.float64) tensor(-0.7971, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-26.976537704467773
value loss:19.922433853149414
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.601833820343018 seconds
19 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.5016, dtype=torch.float64)
19 gae_duplicate tensor(0.5016, dtype=torch.float64) tensor(-1.0428, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.9304, dtype=torch.float64)
18 gae_duplicate tensor(1.3317, dtype=torch.float64) tensor(-2.7683, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(1.4975, dtype=torch.float64)
17 gae_duplicate tensor(2.5628, dtype=torch.float64) tensor(-5.3241, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.9742, dtype=torch.float64)
16 gae_duplicate tensor(3.0244, dtype=torch.float64) tensor(-6.2832, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.4657, dtype=torch.float64)
15 gae_duplicate tensor(2.8852, dtype=torch.float64) tensor(-5.9939, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(1.1709, dtype=torch.float64)
14 gae_duplicate tensor(3.4791, dtype=torch.float64) tensor(-7.2415, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(-0.8421, dtype=torch.float64)
13 gae_duplicate tensor(1.9412, dtype=torch.float64) tensor(-4.0405, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1850, dtype=torch.float64) delta_t tensor(-0.1926, dtype=torch.float64)
12 gae_duplicate tensor(1.3604, dtype=torch.float64) tensor(-2.8298, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3155, dtype=torch.float64) delta_t tensor(0.0948, dtype=torch.float64)
11 gae_duplicate tensor(1.1831, dtype=torch.float64) tensor(-2.4595, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2503, dtype=torch.float64) delta_t tensor(0.5021, dtype=torch.float64)
10 gae_duplicate tensor(1.4486, dtype=torch.float64) tensor(-3.0114, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2504, dtype=torch.float64) delta_t tensor(0.4517, dtype=torch.float64)
9 gae_duplicate tensor(1.6106, dtype=torch.float64) tensor(-3.3481, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1405, dtype=torch.float64) delta_t tensor(-0.0748, dtype=torch.float64)
8 gae_duplicate tensor(1.2137, dtype=torch.float64) tensor(-2.5262, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0526, dtype=torch.float64) delta_t tensor(-0.5446, dtype=torch.float64)
7 gae_duplicate tensor(0.4264, dtype=torch.float64) tensor(-0.8863, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.7696, dtype=torch.float64) delta_t tensor(-0.7914, dtype=torch.float64)
6 gae_duplicate tensor(-0.4503, dtype=torch.float64) tensor(0.9373, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9889, dtype=torch.float64) delta_t tensor(0.4590, dtype=torch.float64)
5 gae_duplicate tensor(0.0987, dtype=torch.float64) tensor(-0.2052, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5758, dtype=torch.float64) delta_t tensor(-0.5764, dtype=torch.float64)
4 gae_duplicate tensor(-0.4974, dtype=torch.float64) tensor(1.0334, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2730, dtype=torch.float64) delta_t tensor(0.2474, dtype=torch.float64)
3 gae_duplicate tensor(-0.1506, dtype=torch.float64) tensor(0.3128, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2730, dtype=torch.float64) delta_t tensor(0.9211, dtype=torch.float64)
2 gae_duplicate tensor(0.8006, dtype=torch.float64) tensor(-1.6643, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:282.9268493652344
value loss:78.98828125
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.531855821609497 seconds
19 rew tensor(0.5759, dtype=torch.float64) delta_t tensor(-1.0809, dtype=torch.float64)
19 gae_duplicate tensor(-1.0809, dtype=torch.float64) tensor(2.2485, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4455, dtype=torch.float64) delta_t tensor(0.1769, dtype=torch.float64)
18 gae_duplicate tensor(-0.6879, dtype=torch.float64) tensor(1.4300, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0763, dtype=torch.float64) delta_t tensor(-0.2704, dtype=torch.float64)
17 gae_duplicate tensor(-0.8207, dtype=torch.float64) tensor(1.7072, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.9243, dtype=torch.float64) delta_t tensor(-1.1489, dtype=torch.float64)
16 gae_duplicate tensor(-1.8055, dtype=torch.float64) tensor(3.7557, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(0.6217, dtype=torch.float64)
15 gae_duplicate tensor(-0.8227, dtype=torch.float64) tensor(1.7102, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.6220, dtype=torch.float64)
14 gae_duplicate tensor(-0.0362, dtype=torch.float64) tensor(0.0752, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(0.6223, dtype=torch.float64)
13 gae_duplicate tensor(0.5934, dtype=torch.float64) tensor(-1.2335, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9026, dtype=torch.float64) delta_t tensor(0.6226, dtype=torch.float64)
12 gae_duplicate tensor(1.0973, dtype=torch.float64) tensor(-2.2825, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-2.3580, dtype=torch.float64) delta_t tensor(-3.1188, dtype=torch.float64)
11 gae_duplicate tensor(-2.2410, dtype=torch.float64) tensor(4.6645, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5984, dtype=torch.float64) delta_t tensor(-0.8044, dtype=torch.float64)
10 gae_duplicate tensor(-2.5972, dtype=torch.float64) tensor(5.4060, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6414, dtype=torch.float64) delta_t tensor(0.1449, dtype=torch.float64)
9 gae_duplicate tensor(-1.9328, dtype=torch.float64) tensor(4.0178, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1195, dtype=torch.float64) delta_t tensor(0.9805, dtype=torch.float64)
8 gae_duplicate tensor(-0.5657, dtype=torch.float64) tensor(1.1760, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5329, dtype=torch.float64) delta_t tensor(-1.0733, dtype=torch.float64)
7 gae_duplicate tensor(-1.5259, dtype=torch.float64) tensor(3.1742, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5768, dtype=torch.float64) delta_t tensor(-0.6281, dtype=torch.float64)
6 gae_duplicate tensor(-1.8489, dtype=torch.float64) tensor(3.8484, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3380, dtype=torch.float64) delta_t tensor(1.7620, dtype=torch.float64)
5 gae_duplicate tensor(0.2829, dtype=torch.float64) tensor(-0.5888, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2728, dtype=torch.float64) delta_t tensor(0.3036, dtype=torch.float64)
4 gae_duplicate tensor(0.5299, dtype=torch.float64) tensor(-1.1023, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7947, dtype=torch.float64) delta_t tensor(0.5405, dtype=torch.float64)
3 gae_duplicate tensor(0.9644, dtype=torch.float64) tensor(-2.0048, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4472, dtype=torch.float64) delta_t tensor(-0.9681, dtype=torch.float64)
2 gae_duplicate tensor(-0.1966, dtype=torch.float64) tensor(0.4084, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-159.5850372314453
value loss:46.06324768066406
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.332190990447998 seconds
19 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(-0.8501, dtype=torch.float64)
19 gae_duplicate tensor(-0.8501, dtype=torch.float64) tensor(1.7683, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.9444, dtype=torch.float64)
18 gae_duplicate tensor(0.2644, dtype=torch.float64) tensor(-0.5500, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.8013, dtype=torch.float64)
17 gae_duplicate tensor(1.0129, dtype=torch.float64) tensor(-2.1040, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(1.0356, dtype=torch.float64)
16 gae_duplicate tensor(1.8458, dtype=torch.float64) tensor(-3.8370, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(1.8695, dtype=torch.float64)
15 gae_duplicate tensor(3.3462, dtype=torch.float64) tensor(-6.9606, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(3.3738, dtype=torch.float64)
14 gae_duplicate tensor(6.0508, dtype=torch.float64) tensor(-12.5780, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(1.4472, dtype=torch.float64)
13 gae_duplicate tensor(6.2878, dtype=torch.float64) tensor(-13.0705, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5116, dtype=torch.float64) delta_t tensor(-0.7982, dtype=torch.float64)
12 gae_duplicate tensor(4.2320, dtype=torch.float64) tensor(-8.7971, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4467, dtype=torch.float64) delta_t tensor(-0.2269, dtype=torch.float64)
11 gae_duplicate tensor(3.1587, dtype=torch.float64) tensor(-6.5706, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5118, dtype=torch.float64) delta_t tensor(2.2916, dtype=torch.float64)
10 gae_duplicate tensor(4.8186, dtype=torch.float64) tensor(-10.0095, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3818, dtype=torch.float64) delta_t tensor(-1.5510, dtype=torch.float64)
9 gae_duplicate tensor(2.3039, dtype=torch.float64) tensor(-4.7926, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1867, dtype=torch.float64) delta_t tensor(0.2231, dtype=torch.float64)
8 gae_duplicate tensor(2.0662, dtype=torch.float64) tensor(-4.3011, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6588, dtype=torch.float64) delta_t tensor(-0.2740, dtype=torch.float64)
7 gae_duplicate tensor(1.3790, dtype=torch.float64) tensor(-2.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1142, dtype=torch.float64) delta_t tensor(-0.9234, dtype=torch.float64)
6 gae_duplicate tensor(0.1798, dtype=torch.float64) tensor(-0.3741, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9846, dtype=torch.float64) delta_t tensor(1.4420, dtype=torch.float64)
5 gae_duplicate tensor(1.5858, dtype=torch.float64) tensor(-3.2988, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.8223, dtype=torch.float64) delta_t tensor(-3.9745, dtype=torch.float64)
4 gae_duplicate tensor(-2.7059, dtype=torch.float64) tensor(5.6208, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1417, dtype=torch.float64) delta_t tensor(0.2262, dtype=torch.float64)
3 gae_duplicate tensor(-1.9385, dtype=torch.float64) tensor(4.0323, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2723, dtype=torch.float64) delta_t tensor(0.4924, dtype=torch.float64)
2 gae_duplicate tensor(-1.0584, dtype=torch.float64) tensor(2.2002, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:397.79840087890625
value loss:254.85507202148438
entropies:37.429935455322266
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.0009)
ToM Target loss= tensor(305.5043)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.445745944976807 seconds
19 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(-1.4063, dtype=torch.float64)
19 gae_duplicate tensor(-1.4063, dtype=torch.float64) tensor(2.9231, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.4388, dtype=torch.float64)
18 gae_duplicate tensor(-0.6863, dtype=torch.float64) tensor(1.4276, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.4579, dtype=torch.float64)
17 gae_duplicate tensor(-0.0911, dtype=torch.float64) tensor(0.1893, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.4876, dtype=torch.float64)
16 gae_duplicate tensor(0.4147, dtype=torch.float64) tensor(-0.8627, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(0.6266, dtype=torch.float64)
15 gae_duplicate tensor(0.9584, dtype=torch.float64) tensor(-1.9936, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.7734, dtype=torch.float64)
14 gae_duplicate tensor(1.5401, dtype=torch.float64) tensor(-3.2037, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(1.9707, dtype=torch.float64)
13 gae_duplicate tensor(3.2027, dtype=torch.float64) tensor(-6.6623, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(-0.8073, dtype=torch.float64)
12 gae_duplicate tensor(1.7549, dtype=torch.float64) tensor(-3.6478, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.5379, dtype=torch.float64)
11 gae_duplicate tensor(1.9418, dtype=torch.float64) tensor(-4.0363, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7720, dtype=torch.float64) delta_t tensor(0.2446, dtype=torch.float64)
10 gae_duplicate tensor(1.7980, dtype=torch.float64) tensor(-3.7347, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5770, dtype=torch.float64) delta_t tensor(0.2152, dtype=torch.float64)
9 gae_duplicate tensor(1.6536, dtype=torch.float64) tensor(-3.4372, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0564, dtype=torch.float64) delta_t tensor(0.8401, dtype=torch.float64)
8 gae_duplicate tensor(2.1630, dtype=torch.float64) tensor(-4.4995, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2039, dtype=torch.float64) delta_t tensor(-0.3332, dtype=torch.float64)
7 gae_duplicate tensor(1.3972, dtype=torch.float64) tensor(-2.9065, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5944, dtype=torch.float64) delta_t tensor(-0.1006, dtype=torch.float64)
6 gae_duplicate tensor(1.0172, dtype=torch.float64) tensor(-2.1144, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4403, dtype=torch.float64) delta_t tensor(-0.6827, dtype=torch.float64)
5 gae_duplicate tensor(0.1310, dtype=torch.float64) tensor(-0.2724, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2220, dtype=torch.float64) delta_t tensor(-1.8240, dtype=torch.float64)
4 gae_duplicate tensor(-1.7192, dtype=torch.float64) tensor(3.5763, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2708, dtype=torch.float64) delta_t tensor(1.6865, dtype=torch.float64)
3 gae_duplicate tensor(0.3111, dtype=torch.float64) tensor(-0.6472, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6615, dtype=torch.float64) delta_t tensor(0.2811, dtype=torch.float64)
2 gae_duplicate tensor(0.5300, dtype=torch.float64) tensor(-1.1009, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:184.89369201660156
value loss:60.0146598815918
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.746863126754761 seconds
19 rew tensor(0.8355, dtype=torch.float64) delta_t tensor(-0.7531, dtype=torch.float64)
19 gae_duplicate tensor(-0.7531, dtype=torch.float64) tensor(1.5654, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7706, dtype=torch.float64) delta_t tensor(0.3458, dtype=torch.float64)
18 gae_duplicate tensor(-0.2567, dtype=torch.float64) tensor(0.5336, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6404, dtype=torch.float64) delta_t tensor(0.2490, dtype=torch.float64)
17 gae_duplicate tensor(0.0437, dtype=torch.float64) tensor(-0.0907, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4451, dtype=torch.float64) delta_t tensor(0.1357, dtype=torch.float64)
16 gae_duplicate tensor(0.1706, dtype=torch.float64) tensor(-0.3547, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3800, dtype=torch.float64) delta_t tensor(-0.1098, dtype=torch.float64)
15 gae_duplicate tensor(0.0267, dtype=torch.float64) tensor(-0.0556, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0109, dtype=torch.float64) delta_t tensor(-0.3825, dtype=torch.float64)
14 gae_duplicate tensor(-0.3611, dtype=torch.float64) tensor(0.7519, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8360, dtype=torch.float64) delta_t tensor(0.5097, dtype=torch.float64)
13 gae_duplicate tensor(0.2208, dtype=torch.float64) tensor(-0.4597, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.5391, dtype=torch.float64)
12 gae_duplicate tensor(0.7158, dtype=torch.float64) tensor(-1.4866, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7714, dtype=torch.float64) delta_t tensor(0.2654, dtype=torch.float64)
11 gae_duplicate tensor(0.8380, dtype=torch.float64) tensor(-1.7420, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3808, dtype=torch.float64) delta_t tensor(-0.2635, dtype=torch.float64)
10 gae_duplicate tensor(0.4069, dtype=torch.float64) tensor(-0.8464, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1204, dtype=torch.float64) delta_t tensor(-0.5884, dtype=torch.float64)
9 gae_duplicate tensor(-0.2629, dtype=torch.float64) tensor(0.5460, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7261, dtype=torch.float64) delta_t tensor(-0.2939, dtype=torch.float64)
8 gae_duplicate tensor(-0.5042, dtype=torch.float64) tensor(1.0496, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8565, dtype=torch.float64) delta_t tensor(-0.2021, dtype=torch.float64)
7 gae_duplicate tensor(-0.6054, dtype=torch.float64) tensor(1.2594, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6407, dtype=torch.float64) delta_t tensor(1.0324, dtype=torch.float64)
6 gae_duplicate tensor(0.5481, dtype=torch.float64) tensor(-1.1392, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7027, dtype=torch.float64) delta_t tensor(0.0482, dtype=torch.float64)
5 gae_duplicate tensor(0.4867, dtype=torch.float64) tensor(-1.0108, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2497, dtype=torch.float64) delta_t tensor(1.0051, dtype=torch.float64)
4 gae_duplicate tensor(1.3944, dtype=torch.float64) tensor(-2.8985, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5733, dtype=torch.float64) delta_t tensor(-0.8432, dtype=torch.float64)
3 gae_duplicate tensor(0.2724, dtype=torch.float64) tensor(-0.5661, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4440, dtype=torch.float64) delta_t tensor(-0.4247, dtype=torch.float64)
2 gae_duplicate tensor(-0.2068, dtype=torch.float64) tensor(0.4301, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:25.962228775024414
value loss:8.268760681152344
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.442951917648315 seconds
19 rew tensor(0.6417, dtype=torch.float64) delta_t tensor(-1.2164, dtype=torch.float64)
19 gae_duplicate tensor(-1.2164, dtype=torch.float64) tensor(2.5284, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3808, dtype=torch.float64) delta_t tensor(0.0077, dtype=torch.float64)
18 gae_duplicate tensor(-0.9654, dtype=torch.float64) tensor(2.0084, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0107, dtype=torch.float64) delta_t tensor(-0.3602, dtype=torch.float64)
17 gae_duplicate tensor(-1.1325, dtype=torch.float64) tensor(2.3540, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.9896, dtype=torch.float64) delta_t tensor(-0.4959, dtype=torch.float64)
16 gae_duplicate tensor(-1.4019, dtype=torch.float64) tensor(2.9139, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7720, dtype=torch.float64) delta_t tensor(0.6168, dtype=torch.float64)
15 gae_duplicate tensor(-0.5047, dtype=torch.float64) tensor(1.0482, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7070, dtype=torch.float64) delta_t tensor(0.3430, dtype=torch.float64)
14 gae_duplicate tensor(-0.0607, dtype=torch.float64) tensor(0.1263, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4462, dtype=torch.float64) delta_t tensor(-0.3291, dtype=torch.float64)
13 gae_duplicate tensor(-0.3777, dtype=torch.float64) tensor(0.7850, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9029, dtype=torch.float64) delta_t tensor(0.5698, dtype=torch.float64)
12 gae_duplicate tensor(0.2677, dtype=torch.float64) tensor(-0.5559, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9032, dtype=torch.float64) delta_t tensor(0.0128, dtype=torch.float64)
11 gae_duplicate tensor(0.2269, dtype=torch.float64) tensor(-0.4712, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6425, dtype=torch.float64) delta_t tensor(0.4470, dtype=torch.float64)
10 gae_duplicate tensor(0.6285, dtype=torch.float64) tensor(-1.3075, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0748, dtype=torch.float64) delta_t tensor(-0.4251, dtype=torch.float64)
9 gae_duplicate tensor(0.0777, dtype=torch.float64) tensor(-0.1617, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7921, dtype=torch.float64) delta_t tensor(-0.9755, dtype=torch.float64)
8 gae_duplicate tensor(-0.9133, dtype=torch.float64) tensor(1.8983, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1184, dtype=torch.float64) delta_t tensor(-1.1082, dtype=torch.float64)
7 gae_duplicate tensor(-1.8389, dtype=torch.float64) tensor(3.8222, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5101, dtype=torch.float64) delta_t tensor(-0.7267, dtype=torch.float64)
6 gae_duplicate tensor(-2.1978, dtype=torch.float64) tensor(4.5643, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1196, dtype=torch.float64) delta_t tensor(-1.3928, dtype=torch.float64)
5 gae_duplicate tensor(-3.1511, dtype=torch.float64) tensor(6.5498, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2498, dtype=torch.float64) delta_t tensor(2.8182, dtype=torch.float64)
4 gae_duplicate tensor(0.2973, dtype=torch.float64) tensor(-0.6180, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5981, dtype=torch.float64) delta_t tensor(0.5798, dtype=torch.float64)
3 gae_duplicate tensor(0.8177, dtype=torch.float64) tensor(-1.7011, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5982, dtype=torch.float64) delta_t tensor(0.3553, dtype=torch.float64)
2 gae_duplicate tensor(1.0094, dtype=torch.float64) tensor(-2.0982, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-131.23304748535156
value loss:41.00371170043945
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.371006011962891 seconds
19 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(-0.5501, dtype=torch.float64)
19 gae_duplicate tensor(-0.5501, dtype=torch.float64) tensor(1.1444, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(0.1409, dtype=torch.float64)
18 gae_duplicate tensor(-0.2991, dtype=torch.float64) tensor(0.6212, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(0.5471, dtype=torch.float64)
17 gae_duplicate tensor(0.3078, dtype=torch.float64) tensor(-0.6392, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9025, dtype=torch.float64) delta_t tensor(0.3874, dtype=torch.float64)
16 gae_duplicate tensor(0.6337, dtype=torch.float64) tensor(-1.3171, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9028, dtype=torch.float64) delta_t tensor(0.5798, dtype=torch.float64)
15 gae_duplicate tensor(1.0867, dtype=torch.float64) tensor(-2.2608, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9031, dtype=torch.float64) delta_t tensor(0.5210, dtype=torch.float64)
14 gae_duplicate tensor(1.3904, dtype=torch.float64) tensor(-2.8925, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9034, dtype=torch.float64) delta_t tensor(0.3806, dtype=torch.float64)
13 gae_duplicate tensor(1.4929, dtype=torch.float64) tensor(-3.1057, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9036, dtype=torch.float64) delta_t tensor(0.5934, dtype=torch.float64)
12 gae_duplicate tensor(1.7877, dtype=torch.float64) tensor(-3.7190, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9039, dtype=torch.float64) delta_t tensor(0.5100, dtype=torch.float64)
11 gae_duplicate tensor(1.9401, dtype=torch.float64) tensor(-4.0327, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(-0.1501, dtype=torch.float64)
10 gae_duplicate tensor(1.4020, dtype=torch.float64) tensor(-2.9116, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4442, dtype=torch.float64) delta_t tensor(-2.0628, dtype=torch.float64)
9 gae_duplicate tensor(-0.9412, dtype=torch.float64) tensor(1.9581, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3169, dtype=torch.float64) delta_t tensor(0.0091, dtype=torch.float64)
8 gae_duplicate tensor(-0.7438, dtype=torch.float64) tensor(1.5461, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2050, dtype=torch.float64) delta_t tensor(0.5276, dtype=torch.float64)
7 gae_duplicate tensor(-0.0675, dtype=torch.float64) tensor(0.1402, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3140, dtype=torch.float64) delta_t tensor(-0.5663, dtype=torch.float64)
6 gae_duplicate tensor(-0.6203, dtype=torch.float64) tensor(1.2892, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4469, dtype=torch.float64) delta_t tensor(1.8825, dtype=torch.float64)
5 gae_duplicate tensor(1.3863, dtype=torch.float64) tensor(-2.8840, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2276, dtype=torch.float64) delta_t tensor(-1.3982, dtype=torch.float64)
4 gae_duplicate tensor(-0.2891, dtype=torch.float64) tensor(0.6015, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.7729, dtype=torch.float64) delta_t tensor(1.4990, dtype=torch.float64)
3 gae_duplicate tensor(1.2677, dtype=torch.float64) tensor(-2.6325, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.9031, dtype=torch.float64) delta_t tensor(-0.9723, dtype=torch.float64)
2 gae_duplicate tensor(0.0418, dtype=torch.float64) tensor(-0.0870, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:113.96668243408203
value loss:30.899248123168945
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.519996881484985 seconds
19 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(-1.3708, dtype=torch.float64)
19 gae_duplicate tensor(-1.3708, dtype=torch.float64) tensor(2.8519, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(0.4238, dtype=torch.float64)
18 gae_duplicate tensor(-0.6728, dtype=torch.float64) tensor(1.4010, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.6545, dtype=torch.float64)
17 gae_duplicate tensor(0.1163, dtype=torch.float64) tensor(-0.2421, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(0.6918, dtype=torch.float64)
16 gae_duplicate tensor(0.7848, dtype=torch.float64) tensor(-1.6326, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9026, dtype=torch.float64) delta_t tensor(0.3488, dtype=torch.float64)
15 gae_duplicate tensor(0.9766, dtype=torch.float64) tensor(-2.0317, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9029, dtype=torch.float64) delta_t tensor(0.5721, dtype=torch.float64)
14 gae_duplicate tensor(1.3534, dtype=torch.float64) tensor(-2.8182, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9032, dtype=torch.float64) delta_t tensor(0.5979, dtype=torch.float64)
13 gae_duplicate tensor(1.6806, dtype=torch.float64) tensor(-3.4931, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9035, dtype=torch.float64) delta_t tensor(0.4044, dtype=torch.float64)
12 gae_duplicate tensor(1.7488, dtype=torch.float64) tensor(-3.6348, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9037, dtype=torch.float64) delta_t tensor(0.5211, dtype=torch.float64)
11 gae_duplicate tensor(1.9202, dtype=torch.float64) tensor(-3.9984, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(1.4422, dtype=torch.float64)
10 gae_duplicate tensor(2.9783, dtype=torch.float64) tensor(-6.1905, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3818, dtype=torch.float64) delta_t tensor(0.1104, dtype=torch.float64)
9 gae_duplicate tensor(2.4931, dtype=torch.float64) tensor(-5.1914, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0753, dtype=torch.float64) delta_t tensor(-1.0906, dtype=torch.float64)
8 gae_duplicate tensor(0.9038, dtype=torch.float64) tensor(-1.8803, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5977, dtype=torch.float64) delta_t tensor(-0.1648, dtype=torch.float64)
7 gae_duplicate tensor(0.5582, dtype=torch.float64) tensor(-1.1603, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7937, dtype=torch.float64) delta_t tensor(0.5459, dtype=torch.float64)
6 gae_duplicate tensor(0.9925, dtype=torch.float64) tensor(-2.0647, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0550, dtype=torch.float64) delta_t tensor(-0.9303, dtype=torch.float64)
5 gae_duplicate tensor(-0.1364, dtype=torch.float64) tensor(0.2839, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9249, dtype=torch.float64) delta_t tensor(0.8776, dtype=torch.float64)
4 gae_duplicate tensor(0.7685, dtype=torch.float64) tensor(-1.5987, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3169, dtype=torch.float64) delta_t tensor(-0.3763, dtype=torch.float64)
3 gae_duplicate tensor(0.2385, dtype=torch.float64) tensor(-0.4956, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4034, dtype=torch.float64) delta_t tensor(-0.8448, dtype=torch.float64)
2 gae_duplicate tensor(-0.6540, dtype=torch.float64) tensor(1.3594, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:182.09414672851562
value loss:50.41461944580078
entropies:37.429931640625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.0630)
ToM Target loss= tensor(306.1046)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.519023180007935 seconds
19 rew tensor(-0.4047, dtype=torch.float64) delta_t tensor(-2.2407, dtype=torch.float64)
19 gae_duplicate tensor(-2.2407, dtype=torch.float64) tensor(4.6615, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-1.5163, dtype=torch.float64) delta_t tensor(-1.3242, dtype=torch.float64)
18 gae_duplicate tensor(-3.1168, dtype=torch.float64) tensor(6.4781, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8373, dtype=torch.float64) delta_t tensor(0.5212, dtype=torch.float64)
17 gae_duplicate tensor(-1.9722, dtype=torch.float64) tensor(4.0992, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9030, dtype=torch.float64) delta_t tensor(0.3699, dtype=torch.float64)
16 gae_duplicate tensor(-1.2079, dtype=torch.float64) tensor(2.5106, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8378, dtype=torch.float64) delta_t tensor(0.4747, dtype=torch.float64)
15 gae_duplicate tensor(-0.4916, dtype=torch.float64) tensor(1.0218, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8381, dtype=torch.float64) delta_t tensor(0.6004, dtype=torch.float64)
14 gae_duplicate tensor(0.2071, dtype=torch.float64) tensor(-0.4304, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8383, dtype=torch.float64) delta_t tensor(0.1356, dtype=torch.float64)
13 gae_duplicate tensor(0.3012, dtype=torch.float64) tensor(-0.6266, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7078, dtype=torch.float64) delta_t tensor(0.0843, dtype=torch.float64)
12 gae_duplicate tensor(0.3253, dtype=torch.float64) tensor(-0.6761, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.4681, dtype=torch.float64)
11 gae_duplicate tensor(0.7283, dtype=torch.float64) tensor(-1.5124, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8390, dtype=torch.float64) delta_t tensor(0.3216, dtype=torch.float64)
10 gae_duplicate tensor(0.9042, dtype=torch.float64) tensor(-1.8794, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4683, dtype=torch.float64) delta_t tensor(-0.9372, dtype=torch.float64)
9 gae_duplicate tensor(-0.2139, dtype=torch.float64) tensor(0.4441, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5337, dtype=torch.float64) delta_t tensor(-0.9876, dtype=torch.float64)
8 gae_duplicate tensor(-1.1586, dtype=torch.float64) tensor(2.4127, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6646, dtype=torch.float64) delta_t tensor(-0.6785, dtype=torch.float64)
7 gae_duplicate tensor(-1.6054, dtype=torch.float64) tensor(3.3400, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1222, dtype=torch.float64) delta_t tensor(-1.1121, dtype=torch.float64)
6 gae_duplicate tensor(-2.3964, dtype=torch.float64) tensor(4.9855, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1226, dtype=torch.float64) delta_t tensor(1.4250, dtype=torch.float64)
5 gae_duplicate tensor(-0.4921, dtype=torch.float64) tensor(1.0229, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1884, dtype=torch.float64) delta_t tensor(-0.9179, dtype=torch.float64)
4 gae_duplicate tensor(-1.3116, dtype=torch.float64) tensor(2.7312, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5353, dtype=torch.float64) delta_t tensor(0.7099, dtype=torch.float64)
3 gae_duplicate tensor(-0.3394, dtype=torch.float64) tensor(0.7061, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7315, dtype=torch.float64) delta_t tensor(0.4619, dtype=torch.float64)
2 gae_duplicate tensor(0.1904, dtype=torch.float64) tensor(-0.3965, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-174.4761505126953
value loss:50.602352142333984
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.422796010971069 seconds
19 rew tensor(0.9031, dtype=torch.float64) delta_t tensor(-0.4934, dtype=torch.float64)
19 gae_duplicate tensor(-0.4934, dtype=torch.float64) tensor(1.0245, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9034, dtype=torch.float64) delta_t tensor(0.4070, dtype=torch.float64)
18 gae_duplicate tensor(0.0123, dtype=torch.float64) tensor(-0.0256, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8383, dtype=torch.float64) delta_t tensor(0.1758, dtype=torch.float64)
17 gae_duplicate tensor(0.1856, dtype=torch.float64) tensor(-0.3865, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7731, dtype=torch.float64) delta_t tensor(0.3324, dtype=torch.float64)
16 gae_duplicate tensor(0.4809, dtype=torch.float64) tensor(-1.0014, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7733, dtype=torch.float64) delta_t tensor(0.2673, dtype=torch.float64)
15 gae_duplicate tensor(0.6520, dtype=torch.float64) tensor(-1.3565, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7736, dtype=torch.float64) delta_t tensor(0.2022, dtype=torch.float64)
14 gae_duplicate tensor(0.7238, dtype=torch.float64) tensor(-1.5030, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5776, dtype=torch.float64) delta_t tensor(0.0980, dtype=torch.float64)
13 gae_duplicate tensor(0.6770, dtype=torch.float64) tensor(-1.4072, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9046, dtype=torch.float64) delta_t tensor(0.4474, dtype=torch.float64)
12 gae_duplicate tensor(0.9890, dtype=torch.float64) tensor(-2.0575, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9049, dtype=torch.float64) delta_t tensor(0.1010, dtype=torch.float64)
11 gae_duplicate tensor(0.8922, dtype=torch.float64) tensor(-1.8563, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7091, dtype=torch.float64) delta_t tensor(0.1700, dtype=torch.float64)
10 gae_duplicate tensor(0.8838, dtype=torch.float64) tensor(-1.8387, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7288, dtype=torch.float64) delta_t tensor(-1.1929, dtype=torch.float64)
9 gae_duplicate tensor(-0.4858, dtype=torch.float64) tensor(1.0107, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1408, dtype=torch.float64) delta_t tensor(-0.0655, dtype=torch.float64)
8 gae_duplicate tensor(-0.4542, dtype=torch.float64) tensor(0.9448, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4022, dtype=torch.float64) delta_t tensor(-0.4868, dtype=torch.float64)
7 gae_duplicate tensor(-0.8501, dtype=torch.float64) tensor(1.7687, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1210, dtype=torch.float64) delta_t tensor(-1.2130, dtype=torch.float64)
6 gae_duplicate tensor(-1.8931, dtype=torch.float64) tensor(3.9347, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5136, dtype=torch.float64) delta_t tensor(-1.0777, dtype=torch.float64)
5 gae_duplicate tensor(-2.5921, dtype=torch.float64) tensor(5.3825, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8870, dtype=torch.float64) delta_t tensor(-0.1921, dtype=torch.float64)
4 gae_duplicate tensor(-2.2659, dtype=torch.float64) tensor(4.7183, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0776, dtype=torch.float64) delta_t tensor(-0.0334, dtype=torch.float64)
3 gae_duplicate tensor(-1.8461, dtype=torch.float64) tensor(3.8370, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0122, dtype=torch.float64) delta_t tensor(0.4880, dtype=torch.float64)
2 gae_duplicate tensor(-0.9889, dtype=torch.float64) tensor(2.0534, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-80.57597351074219
value loss:38.18992233276367
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.1578896045684814 seconds
19 rew tensor(0.7087, dtype=torch.float64) delta_t tensor(-1.3283, dtype=torch.float64)
19 gae_duplicate tensor(-1.3283, dtype=torch.float64) tensor(2.7660, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6434, dtype=torch.float64) delta_t tensor(0.2309, dtype=torch.float64)
18 gae_duplicate tensor(-0.8317, dtype=torch.float64) tensor(1.7303, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3161, dtype=torch.float64) delta_t tensor(-0.1472, dtype=torch.float64)
17 gae_duplicate tensor(-0.8126, dtype=torch.float64) tensor(1.6922, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.2077, dtype=torch.float64) delta_t tensor(-0.4147, dtype=torch.float64)
16 gae_duplicate tensor(-1.0648, dtype=torch.float64) tensor(2.2152, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-1.2552, dtype=torch.float64) delta_t tensor(-1.2776, dtype=torch.float64)
15 gae_duplicate tensor(-2.1294, dtype=torch.float64) tensor(4.4301, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8394, dtype=torch.float64) delta_t tensor(0.4444, dtype=torch.float64)
14 gae_duplicate tensor(-1.2591, dtype=torch.float64) tensor(2.6196, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9051, dtype=torch.float64) delta_t tensor(0.4079, dtype=torch.float64)
13 gae_duplicate tensor(-0.5994, dtype=torch.float64) tensor(1.2446, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8399, dtype=torch.float64) delta_t tensor(-0.1219, dtype=torch.float64)
12 gae_duplicate tensor(-0.6014, dtype=torch.float64) tensor(1.2500, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7747, dtype=torch.float64) delta_t tensor(0.3524, dtype=torch.float64)
11 gae_duplicate tensor(-0.1287, dtype=torch.float64) tensor(0.2681, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8404, dtype=torch.float64) delta_t tensor(0.6299, dtype=torch.float64)
10 gae_duplicate tensor(0.5269, dtype=torch.float64) tensor(-1.0952, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5995, dtype=torch.float64) delta_t tensor(-1.0204, dtype=torch.float64)
9 gae_duplicate tensor(-0.5988, dtype=torch.float64) tensor(1.2447, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6651, dtype=torch.float64) delta_t tensor(-1.0445, dtype=torch.float64)
8 gae_duplicate tensor(-1.5236, dtype=torch.float64) tensor(3.1636, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0579, dtype=torch.float64) delta_t tensor(-1.2598, dtype=torch.float64)
7 gae_duplicate tensor(-2.4787, dtype=torch.float64) tensor(5.1518, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4038, dtype=torch.float64) delta_t tensor(-1.2131, dtype=torch.float64)
6 gae_duplicate tensor(-3.1960, dtype=torch.float64) tensor(6.6427, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0113, dtype=torch.float64) delta_t tensor(2.2145, dtype=torch.float64)
5 gae_duplicate tensor(-0.3423, dtype=torch.float64) tensor(0.7121, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4692, dtype=torch.float64) delta_t tensor(0.6696, dtype=torch.float64)
4 gae_duplicate tensor(0.3957, dtype=torch.float64) tensor(-0.8241, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9273, dtype=torch.float64) delta_t tensor(0.9591, dtype=torch.float64)
3 gae_duplicate tensor(1.2756, dtype=torch.float64) tensor(-2.6513, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1238, dtype=torch.float64) delta_t tensor(-0.3481, dtype=torch.float64)
2 gae_duplicate tensor(0.6724, dtype=torch.float64) tensor(-1.3988, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-176.09158325195312
value loss:49.16426467895508
entropies:37.429927825927734
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5381858348846436 seconds
19 rew tensor(-1.3837, dtype=torch.float64) delta_t tensor(-2.6009, dtype=torch.float64)
19 gae_duplicate tensor(-2.6009, dtype=torch.float64) tensor(5.4111, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9038, dtype=torch.float64) delta_t tensor(0.6603, dtype=torch.float64)
18 gae_duplicate tensor(-1.4204, dtype=torch.float64) tensor(2.9522, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.6606, dtype=torch.float64)
17 gae_duplicate tensor(-0.4757, dtype=torch.float64) tensor(0.9887, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8390, dtype=torch.float64) delta_t tensor(0.5322, dtype=torch.float64)
16 gae_duplicate tensor(0.1516, dtype=torch.float64) tensor(-0.3158, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9046, dtype=torch.float64) delta_t tensor(0.6485, dtype=torch.float64)
15 gae_duplicate tensor(0.7698, dtype=torch.float64) tensor(-1.6015, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9049, dtype=torch.float64) delta_t tensor(-0.0057, dtype=torch.float64)
14 gae_duplicate tensor(0.6102, dtype=torch.float64) tensor(-1.2682, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8398, dtype=torch.float64) delta_t tensor(0.4272, dtype=torch.float64)
13 gae_duplicate tensor(0.9154, dtype=torch.float64) tensor(-1.9043, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8400, dtype=torch.float64) delta_t tensor(0.4123, dtype=torch.float64)
12 gae_duplicate tensor(1.1446, dtype=torch.float64) tensor(-2.3790, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9056, dtype=torch.float64) delta_t tensor(0.0919, dtype=torch.float64)
11 gae_duplicate tensor(1.0075, dtype=torch.float64) tensor(-2.0961, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7098, dtype=torch.float64) delta_t tensor(0.4687, dtype=torch.float64)
10 gae_duplicate tensor(1.2747, dtype=torch.float64) tensor(-2.6520, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7277, dtype=torch.float64) delta_t tensor(-1.3766, dtype=torch.float64)
9 gae_duplicate tensor(-0.3568, dtype=torch.float64) tensor(0.7417, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8586, dtype=torch.float64) delta_t tensor(-1.4351, dtype=torch.float64)
8 gae_duplicate tensor(-1.7206, dtype=torch.float64) tensor(3.5831, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2708, dtype=torch.float64) delta_t tensor(-0.3391, dtype=torch.float64)
7 gae_duplicate tensor(-1.7156, dtype=torch.float64) tensor(3.5658, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0095, dtype=torch.float64) delta_t tensor(0.1963, dtype=torch.float64)
6 gae_duplicate tensor(-1.1762, dtype=torch.float64) tensor(2.4471, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6425, dtype=torch.float64) delta_t tensor(-0.5929, dtype=torch.float64)
5 gae_duplicate tensor(-1.5339, dtype=torch.float64) tensor(3.1911, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.3879, dtype=torch.float64) delta_t tensor(-2.3721, dtype=torch.float64)
4 gae_duplicate tensor(-3.5992, dtype=torch.float64) tensor(7.4879, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2082, dtype=torch.float64) delta_t tensor(0.0273, dtype=torch.float64)
3 gae_duplicate tensor(-2.8520, dtype=torch.float64) tensor(5.9336, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1427, dtype=torch.float64) delta_t tensor(0.4706, dtype=torch.float64)
2 gae_duplicate tensor(-1.8110, dtype=torch.float64) tensor(3.7603, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-168.19639587402344
value loss:73.3797378540039
entropies:37.4299201965332
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.644389867782593 seconds
19 rew tensor(0.9039, dtype=torch.float64) delta_t tensor(-1.4498, dtype=torch.float64)
19 gae_duplicate tensor(-1.4498, dtype=torch.float64) tensor(3.0193, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(0.3790, dtype=torch.float64)
18 gae_duplicate tensor(-0.7808, dtype=torch.float64) tensor(1.6213, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9045, dtype=torch.float64) delta_t tensor(0.8053, dtype=torch.float64)
17 gae_duplicate tensor(0.1806, dtype=torch.float64) tensor(-0.3758, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9047, dtype=torch.float64) delta_t tensor(0.6039, dtype=torch.float64)
16 gae_duplicate tensor(0.7484, dtype=torch.float64) tensor(-1.5555, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9050, dtype=torch.float64) delta_t tensor(0.3259, dtype=torch.float64)
15 gae_duplicate tensor(0.9246, dtype=torch.float64) tensor(-1.9237, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9053, dtype=torch.float64) delta_t tensor(0.3735, dtype=torch.float64)
14 gae_duplicate tensor(1.1132, dtype=torch.float64) tensor(-2.3137, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9056, dtype=torch.float64) delta_t tensor(0.3018, dtype=torch.float64)
13 gae_duplicate tensor(1.1924, dtype=torch.float64) tensor(-2.4758, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9058, dtype=torch.float64) delta_t tensor(0.4695, dtype=torch.float64)
12 gae_duplicate tensor(1.4234, dtype=torch.float64) tensor(-2.9555, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9061, dtype=torch.float64) delta_t tensor(0.4115, dtype=torch.float64)
11 gae_duplicate tensor(1.5502, dtype=torch.float64) tensor(-3.2219, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5795, dtype=torch.float64) delta_t tensor(1.4595, dtype=torch.float64)
10 gae_duplicate tensor(2.6997, dtype=torch.float64) tensor(-5.6167, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3835, dtype=torch.float64) delta_t tensor(0.0578, dtype=torch.float64)
9 gae_duplicate tensor(2.2175, dtype=torch.float64) tensor(-4.6181, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2528, dtype=torch.float64) delta_t tensor(0.3246, dtype=torch.float64)
8 gae_duplicate tensor(2.0986, dtype=torch.float64) tensor(-4.3575, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2046, dtype=torch.float64) delta_t tensor(-0.8045, dtype=torch.float64)
7 gae_duplicate tensor(0.8744, dtype=torch.float64) tensor(-1.8173, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7274, dtype=torch.float64) delta_t tensor(0.1474, dtype=torch.float64)
6 gae_duplicate tensor(0.8469, dtype=torch.float64) tensor(-1.7602, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9236, dtype=torch.float64) delta_t tensor(0.2612, dtype=torch.float64)
5 gae_duplicate tensor(0.9387, dtype=torch.float64) tensor(-1.9511, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8386, dtype=torch.float64) delta_t tensor(-0.9307, dtype=torch.float64)
4 gae_duplicate tensor(-0.1797, dtype=torch.float64) tensor(0.3738, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7093, dtype=torch.float64) delta_t tensor(-1.0781, dtype=torch.float64)
3 gae_duplicate tensor(-1.2218, dtype=torch.float64) tensor(2.5420, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6642, dtype=torch.float64) delta_t tensor(-1.2719, dtype=torch.float64)
2 gae_duplicate tensor(-2.2494, dtype=torch.float64) tensor(4.6799, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:135.1166534423828
value loss:55.21178436279297
entropies:37.4299201965332
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.9250)
ToM Target loss= tensor(306.2330)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.234257936477661 seconds
19 rew tensor(0.7072, dtype=torch.float64) delta_t tensor(-1.2936, dtype=torch.float64)
19 gae_duplicate tensor(-1.2936, dtype=torch.float64) tensor(2.6887, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7074, dtype=torch.float64) delta_t tensor(0.3279, dtype=torch.float64)
18 gae_duplicate tensor(-0.7070, dtype=torch.float64) tensor(1.4708, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4466, dtype=torch.float64) delta_t tensor(0.0933, dtype=torch.float64)
17 gae_duplicate tensor(-0.4723, dtype=torch.float64) tensor(0.9836, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1205, dtype=torch.float64) delta_t tensor(0.4682, dtype=torch.float64)
16 gae_duplicate tensor(0.0904, dtype=torch.float64) tensor(-0.1877, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.6623, dtype=torch.float64) delta_t tensor(-0.8611, dtype=torch.float64)
15 gae_duplicate tensor(-0.7888, dtype=torch.float64) tensor(1.6410, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9029, dtype=torch.float64) delta_t tensor(3.2875, dtype=torch.float64)
14 gae_duplicate tensor(2.6565, dtype=torch.float64) tensor(-5.5212, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7728, dtype=torch.float64) delta_t tensor(0.9095, dtype=torch.float64)
13 gae_duplicate tensor(3.0347, dtype=torch.float64) tensor(-6.3137, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9034, dtype=torch.float64) delta_t tensor(0.5241, dtype=torch.float64)
12 gae_duplicate tensor(2.9518, dtype=torch.float64) tensor(-6.1411, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8385, dtype=torch.float64) delta_t tensor(1.0439, dtype=torch.float64)
11 gae_duplicate tensor(3.4053, dtype=torch.float64) tensor(-7.0847, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7735, dtype=torch.float64) delta_t tensor(-1.7648, dtype=torch.float64)
10 gae_duplicate tensor(0.9595, dtype=torch.float64) tensor(-1.9942, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7913, dtype=torch.float64) delta_t tensor(-1.3422, dtype=torch.float64)
9 gae_duplicate tensor(-0.5746, dtype=torch.float64) tensor(1.1941, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1395, dtype=torch.float64) delta_t tensor(-0.7545, dtype=torch.float64)
8 gae_duplicate tensor(-1.2141, dtype=torch.float64) tensor(2.5234, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2047, dtype=torch.float64) delta_t tensor(-0.2779, dtype=torch.float64)
7 gae_duplicate tensor(-1.2492, dtype=torch.float64) tensor(2.5963, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1825, dtype=torch.float64) delta_t tensor(-0.8465, dtype=torch.float64)
6 gae_duplicate tensor(-1.8459, dtype=torch.float64) tensor(3.8404, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4437, dtype=torch.float64) delta_t tensor(1.0169, dtype=torch.float64)
5 gae_duplicate tensor(-0.4598, dtype=torch.float64) tensor(0.9566, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.8348, dtype=torch.float64) delta_t tensor(-4.6818, dtype=torch.float64)
4 gae_duplicate tensor(-5.0496, dtype=torch.float64) tensor(10.5163, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1192, dtype=torch.float64) delta_t tensor(1.0544, dtype=torch.float64)
3 gae_duplicate tensor(-2.9853, dtype=torch.float64) tensor(6.1983, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0117, dtype=torch.float64) delta_t tensor(-0.4305, dtype=torch.float64)
2 gae_duplicate tensor(-2.8188, dtype=torch.float64) tensor(5.8705, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-80.54701232910156
value loss:134.79319763183594
entropies:37.4299201965332
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.558799743652344 seconds
19 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(-0.9651, dtype=torch.float64)
19 gae_duplicate tensor(-0.9651, dtype=torch.float64) tensor(2.0080, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(0.3913, dtype=torch.float64)
18 gae_duplicate tensor(-0.3808, dtype=torch.float64) tensor(0.7906, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(0.5642, dtype=torch.float64)
17 gae_duplicate tensor(0.2596, dtype=torch.float64) tensor(-0.5400, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9024, dtype=torch.float64) delta_t tensor(1.0986, dtype=torch.float64)
16 gae_duplicate tensor(1.3062, dtype=torch.float64) tensor(-2.7176, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9027, dtype=torch.float64) delta_t tensor(0.6313, dtype=torch.float64)
15 gae_duplicate tensor(1.6763, dtype=torch.float64) tensor(-3.4803, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9029, dtype=torch.float64) delta_t tensor(0.3736, dtype=torch.float64)
14 gae_duplicate tensor(1.7146, dtype=torch.float64) tensor(-3.5636, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9032, dtype=torch.float64) delta_t tensor(0.4986, dtype=torch.float64)
13 gae_duplicate tensor(1.8703, dtype=torch.float64) tensor(-3.8871, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9035, dtype=torch.float64) delta_t tensor(0.8440, dtype=torch.float64)
12 gae_duplicate tensor(2.3402, dtype=torch.float64) tensor(-4.8639, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9037, dtype=torch.float64) delta_t tensor(-0.0877, dtype=torch.float64)
11 gae_duplicate tensor(1.7845, dtype=torch.float64) tensor(-3.7088, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(0.4816, dtype=torch.float64)
10 gae_duplicate tensor(1.9093, dtype=torch.float64) tensor(-3.9723, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(0.4866, dtype=torch.float64)
9 gae_duplicate tensor(2.0140, dtype=torch.float64) tensor(-4.1902, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5279, dtype=torch.float64) delta_t tensor(-0.5440, dtype=torch.float64)
8 gae_duplicate tensor(1.0672, dtype=torch.float64) tensor(-2.2181, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7233, dtype=torch.float64) delta_t tensor(-1.1091, dtype=torch.float64)
7 gae_duplicate tensor(-0.2553, dtype=torch.float64) tensor(0.5306, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1141, dtype=torch.float64) delta_t tensor(-1.2123, dtype=torch.float64)
6 gae_duplicate tensor(-1.4166, dtype=torch.float64) tensor(2.9472, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.4165, dtype=torch.float64) delta_t tensor(-0.4152, dtype=torch.float64)
5 gae_duplicate tensor(-1.5484, dtype=torch.float64) tensor(3.2147, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6571, dtype=torch.float64) delta_t tensor(-3.0328, dtype=torch.float64)
4 gae_duplicate tensor(-4.2715, dtype=torch.float64) tensor(8.8776, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5321, dtype=torch.float64) delta_t tensor(0.0181, dtype=torch.float64)
3 gae_duplicate tensor(-3.3991, dtype=torch.float64) tensor(7.0575, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7933, dtype=torch.float64) delta_t tensor(1.0533, dtype=torch.float64)
2 gae_duplicate tensor(-1.6660, dtype=torch.float64) tensor(3.4697, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:24.35305404663086
value loss:99.96613311767578
entropies:37.42991256713867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.456527948379517 seconds
19 rew tensor(0.7076, dtype=torch.float64) delta_t tensor(-1.2699, dtype=torch.float64)
19 gae_duplicate tensor(-1.2699, dtype=torch.float64) tensor(2.6393, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6426, dtype=torch.float64) delta_t tensor(0.2447, dtype=torch.float64)
18 gae_duplicate tensor(-0.7712, dtype=torch.float64) tensor(1.6029, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4474, dtype=torch.float64) delta_t tensor(0.0624, dtype=torch.float64)
17 gae_duplicate tensor(-0.5545, dtype=torch.float64) tensor(1.1525, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.1385, dtype=torch.float64) delta_t tensor(-0.2054, dtype=torch.float64)
16 gae_duplicate tensor(-0.6491, dtype=torch.float64) tensor(1.3476, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.9848, dtype=torch.float64) delta_t tensor(-1.1443, dtype=torch.float64)
15 gae_duplicate tensor(-1.6635, dtype=torch.float64) tensor(3.4611, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9027, dtype=torch.float64) delta_t tensor(0.6081, dtype=torch.float64)
14 gae_duplicate tensor(-0.7227, dtype=torch.float64) tensor(1.5004, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8379, dtype=torch.float64) delta_t tensor(0.2819, dtype=torch.float64)
13 gae_duplicate tensor(-0.2963, dtype=torch.float64) tensor(0.6151, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7730, dtype=torch.float64) delta_t tensor(0.5124, dtype=torch.float64)
12 gae_duplicate tensor(0.2754, dtype=torch.float64) tensor(-0.5730, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9034, dtype=torch.float64) delta_t tensor(0.2661, dtype=torch.float64)
11 gae_duplicate tensor(0.4864, dtype=torch.float64) tensor(-1.0109, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5783, dtype=torch.float64) delta_t tensor(-0.2238, dtype=torch.float64)
10 gae_duplicate tensor(0.1653, dtype=torch.float64) tensor(-0.3443, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8534, dtype=torch.float64) delta_t tensor(-1.4435, dtype=torch.float64)
9 gae_duplicate tensor(-1.3113, dtype=torch.float64) tensor(2.7282, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7886, dtype=torch.float64) delta_t tensor(-1.1955, dtype=torch.float64)
8 gae_duplicate tensor(-2.2445, dtype=torch.float64) tensor(4.6597, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3826, dtype=torch.float64) delta_t tensor(0.4900, dtype=torch.float64)
7 gae_duplicate tensor(-1.3056, dtype=torch.float64) tensor(2.7135, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.0247, dtype=torch.float64) delta_t tensor(-1.7270, dtype=torch.float64)
6 gae_duplicate tensor(-2.7715, dtype=torch.float64) tensor(5.7724, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7661, dtype=torch.float64) delta_t tensor(-0.3247, dtype=torch.float64)
5 gae_duplicate tensor(-2.5419, dtype=torch.float64) tensor(5.2884, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3533, dtype=torch.float64) delta_t tensor(-0.8789, dtype=torch.float64)
4 gae_duplicate tensor(-2.9124, dtype=torch.float64) tensor(6.0659, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3356, dtype=torch.float64) delta_t tensor(0.5592, dtype=torch.float64)
3 gae_duplicate tensor(-1.7708, dtype=torch.float64) tensor(3.6844, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4008, dtype=torch.float64) delta_t tensor(0.8974, dtype=torch.float64)
2 gae_duplicate tensor(-0.5193, dtype=torch.float64) tensor(1.0803, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-255.42459106445312
value loss:61.71760940551758
entropies:37.42991256713867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.254828929901123 seconds
19 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(-1.0461, dtype=torch.float64)
19 gae_duplicate tensor(-1.0461, dtype=torch.float64) tensor(2.1741, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.5482, dtype=torch.float64)
18 gae_duplicate tensor(-0.2887, dtype=torch.float64) tensor(0.6000, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(1.2460, dtype=torch.float64)
17 gae_duplicate tensor(1.0150, dtype=torch.float64) tensor(-2.1142, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9025, dtype=torch.float64) delta_t tensor(0.5547, dtype=torch.float64)
16 gae_duplicate tensor(1.3667, dtype=torch.float64) tensor(-2.8405, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9028, dtype=torch.float64) delta_t tensor(0.0772, dtype=torch.float64)
15 gae_duplicate tensor(1.1706, dtype=torch.float64) tensor(-2.4328, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9031, dtype=torch.float64) delta_t tensor(1.3082, dtype=torch.float64)
14 gae_duplicate tensor(2.2447, dtype=torch.float64) tensor(-4.6599, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9033, dtype=torch.float64) delta_t tensor(0.3863, dtype=torch.float64)
13 gae_duplicate tensor(2.1820, dtype=torch.float64) tensor(-4.5449, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9036, dtype=torch.float64) delta_t tensor(-0.3016, dtype=torch.float64)
12 gae_duplicate tensor(1.4440, dtype=torch.float64) tensor(-3.0043, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9039, dtype=torch.float64) delta_t tensor(0.4645, dtype=torch.float64)
11 gae_duplicate tensor(1.6197, dtype=torch.float64) tensor(-3.3736, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.4650, dtype=torch.float64)
10 gae_duplicate tensor(1.7608, dtype=torch.float64) tensor(-3.6634, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9044, dtype=torch.float64) delta_t tensor(0.5371, dtype=torch.float64)
9 gae_duplicate tensor(1.9457, dtype=torch.float64) tensor(-4.0481, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6560, dtype=torch.float64) delta_t tensor(-0.7040, dtype=torch.float64)
8 gae_duplicate tensor(0.8526, dtype=torch.float64) tensor(-1.7700, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8512, dtype=torch.float64) delta_t tensor(-1.0418, dtype=torch.float64)
7 gae_duplicate tensor(-0.3597, dtype=torch.float64) tensor(0.7484, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1765, dtype=torch.float64) delta_t tensor(-0.9110, dtype=torch.float64)
6 gae_duplicate tensor(-1.1988, dtype=torch.float64) tensor(2.4887, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7621, dtype=torch.float64) delta_t tensor(-0.5108, dtype=torch.float64)
5 gae_duplicate tensor(-1.4699, dtype=torch.float64) tensor(3.0582, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5195, dtype=torch.float64) delta_t tensor(-2.3702, dtype=torch.float64)
4 gae_duplicate tensor(-3.5461, dtype=torch.float64) tensor(7.3781, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3341, dtype=torch.float64) delta_t tensor(0.8327, dtype=torch.float64)
3 gae_duplicate tensor(-2.0042, dtype=torch.float64) tensor(4.1700, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3994, dtype=torch.float64) delta_t tensor(0.3673, dtype=torch.float64)
2 gae_duplicate tensor(-1.2361, dtype=torch.float64) tensor(2.5662, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:54.486656188964844
value loss:74.1213150024414
entropies:37.42991256713867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.502997159957886 seconds
19 rew tensor(-1.0506, dtype=torch.float64) delta_t tensor(-2.4430, dtype=torch.float64)
19 gae_duplicate tensor(-2.4430, dtype=torch.float64) tensor(5.0772, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9026, dtype=torch.float64) delta_t tensor(-0.0415, dtype=torch.float64)
18 gae_duplicate tensor(-1.9959, dtype=torch.float64) tensor(4.1526, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8378, dtype=torch.float64) delta_t tensor(0.4365, dtype=torch.float64)
17 gae_duplicate tensor(-1.1602, dtype=torch.float64) tensor(2.4141, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9031, dtype=torch.float64) delta_t tensor(0.4936, dtype=torch.float64)
16 gae_duplicate tensor(-0.4346, dtype=torch.float64) tensor(0.9032, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8383, dtype=torch.float64) delta_t tensor(0.4351, dtype=torch.float64)
15 gae_duplicate tensor(0.0874, dtype=torch.float64) tensor(-0.1817, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7734, dtype=torch.float64) delta_t tensor(0.4014, dtype=torch.float64)
14 gae_duplicate tensor(0.4713, dtype=torch.float64) tensor(-0.9795, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5783, dtype=torch.float64) delta_t tensor(0.1620, dtype=torch.float64)
13 gae_duplicate tensor(0.5391, dtype=torch.float64) tensor(-1.1216, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5784, dtype=torch.float64) delta_t tensor(-0.2000, dtype=torch.float64)
12 gae_duplicate tensor(0.2313, dtype=torch.float64) tensor(-0.4801, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.0487, dtype=torch.float64) delta_t tensor(-1.5277, dtype=torch.float64)
11 gae_duplicate tensor(-1.3427, dtype=torch.float64) tensor(2.7936, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7735, dtype=torch.float64) delta_t tensor(0.4471, dtype=torch.float64)
10 gae_duplicate tensor(-0.6271, dtype=torch.float64) tensor(1.3032, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5784, dtype=torch.float64) delta_t tensor(0.7872, dtype=torch.float64)
9 gae_duplicate tensor(0.2855, dtype=torch.float64) tensor(-0.5947, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1230, dtype=torch.float64) delta_t tensor(-0.1899, dtype=torch.float64)
8 gae_duplicate tensor(0.0385, dtype=torch.float64) tensor(-0.0801, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6579, dtype=torch.float64) delta_t tensor(-1.2233, dtype=torch.float64)
7 gae_duplicate tensor(-1.1925, dtype=torch.float64) tensor(2.4782, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3087, dtype=torch.float64) delta_t tensor(-0.2531, dtype=torch.float64)
6 gae_duplicate tensor(-1.2070, dtype=torch.float64) tensor(2.5114, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0573, dtype=torch.float64) delta_t tensor(1.5508, dtype=torch.float64)
5 gae_duplicate tensor(0.5852, dtype=torch.float64) tensor(-1.2175, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5283, dtype=torch.float64) delta_t tensor(0.0685, dtype=torch.float64)
4 gae_duplicate tensor(0.5366, dtype=torch.float64) tensor(-1.1141, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6585, dtype=torch.float64) delta_t tensor(0.6166, dtype=torch.float64)
3 gae_duplicate tensor(1.0459, dtype=torch.float64) tensor(-2.1761, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5693, dtype=torch.float64) delta_t tensor(-0.0113, dtype=torch.float64)
2 gae_duplicate tensor(0.8254, dtype=torch.float64) tensor(-1.7135, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-72.97054290771484
value loss:29.43604278564453
entropies:37.429908752441406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.3571)
ToM Target loss= tensor(305.9411)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.441778182983398 seconds
19 rew tensor(0.5139, dtype=torch.float64) delta_t tensor(-1.0488, dtype=torch.float64)
19 gae_duplicate tensor(-1.0488, dtype=torch.float64) tensor(2.1822, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.1233, dtype=torch.float64) delta_t tensor(-0.1565, dtype=torch.float64)
18 gae_duplicate tensor(-0.9955, dtype=torch.float64) tensor(2.0737, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.5927, dtype=torch.float64) delta_t tensor(-1.2134, dtype=torch.float64)
17 gae_duplicate tensor(-2.0098, dtype=torch.float64) tensor(4.1817, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6439, dtype=torch.float64) delta_t tensor(1.2951, dtype=torch.float64)
16 gae_duplicate tensor(-0.3128, dtype=torch.float64) tensor(0.6515, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5139, dtype=torch.float64) delta_t tensor(0.3161, dtype=torch.float64)
15 gae_duplicate tensor(0.0659, dtype=torch.float64) tensor(-0.1371, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1886, dtype=torch.float64) delta_t tensor(-0.0707, dtype=torch.float64)
14 gae_duplicate tensor(-0.0180, dtype=torch.float64) tensor(0.0373, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9044, dtype=torch.float64) delta_t tensor(0.7153, dtype=torch.float64)
13 gae_duplicate tensor(0.7010, dtype=torch.float64) tensor(-1.4568, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9046, dtype=torch.float64) delta_t tensor(-0.1034, dtype=torch.float64)
12 gae_duplicate tensor(0.4573, dtype=torch.float64) tensor(-0.9504, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8398, dtype=torch.float64) delta_t tensor(0.7483, dtype=torch.float64)
11 gae_duplicate tensor(1.1141, dtype=torch.float64) tensor(-2.3181, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8401, dtype=torch.float64) delta_t tensor(0.5230, dtype=torch.float64)
10 gae_duplicate tensor(1.4143, dtype=torch.float64) tensor(-2.9359, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5260, dtype=torch.float64) delta_t tensor(-0.8791, dtype=torch.float64)
9 gae_duplicate tensor(0.2523, dtype=torch.float64) tensor(-0.5238, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7212, dtype=torch.float64) delta_t tensor(-1.1181, dtype=torch.float64)
8 gae_duplicate tensor(-0.9162, dtype=torch.float64) tensor(1.9063, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9165, dtype=torch.float64) delta_t tensor(-1.4406, dtype=torch.float64)
7 gae_duplicate tensor(-2.1735, dtype=torch.float64) tensor(4.5119, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.9332, dtype=torch.float64) delta_t tensor(-2.1677, dtype=torch.float64)
6 gae_duplicate tensor(-3.9065, dtype=torch.float64) tensor(8.1187, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9840, dtype=torch.float64) delta_t tensor(0.1043, dtype=torch.float64)
5 gae_duplicate tensor(-3.0209, dtype=torch.float64) tensor(6.2853, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3751, dtype=torch.float64) delta_t tensor(-0.4093, dtype=torch.float64)
4 gae_duplicate tensor(-2.8260, dtype=torch.float64) tensor(5.8666, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1875, dtype=torch.float64) delta_t tensor(1.3217, dtype=torch.float64)
3 gae_duplicate tensor(-0.9392, dtype=torch.float64) tensor(1.9518, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6591, dtype=torch.float64) delta_t tensor(0.1652, dtype=torch.float64)
2 gae_duplicate tensor(-0.5862, dtype=torch.float64) tensor(1.2182, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-185.10116577148438
value loss:74.10128021240234
entropies:37.429908752441406
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.267672061920166 seconds
19 rew tensor(0.9045, dtype=torch.float64) delta_t tensor(-1.0218, dtype=torch.float64)
19 gae_duplicate tensor(-1.0218, dtype=torch.float64) tensor(2.1284, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9048, dtype=torch.float64) delta_t tensor(0.5764, dtype=torch.float64)
18 gae_duplicate tensor(-0.2410, dtype=torch.float64) tensor(0.5014, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9050, dtype=torch.float64) delta_t tensor(0.2095, dtype=torch.float64)
17 gae_duplicate tensor(0.0167, dtype=torch.float64) tensor(-0.0348, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9053, dtype=torch.float64) delta_t tensor(0.6860, dtype=torch.float64)
16 gae_duplicate tensor(0.6994, dtype=torch.float64) tensor(-1.4552, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9056, dtype=torch.float64) delta_t tensor(0.4956, dtype=torch.float64)
15 gae_duplicate tensor(1.0551, dtype=torch.float64) tensor(-2.1954, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9058, dtype=torch.float64) delta_t tensor(0.3050, dtype=torch.float64)
14 gae_duplicate tensor(1.1491, dtype=torch.float64) tensor(-2.3881, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9061, dtype=torch.float64) delta_t tensor(0.5669, dtype=torch.float64)
13 gae_duplicate tensor(1.4862, dtype=torch.float64) tensor(-3.0886, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9064, dtype=torch.float64) delta_t tensor(0.4880, dtype=torch.float64)
12 gae_duplicate tensor(1.6769, dtype=torch.float64) tensor(-3.4850, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9066, dtype=torch.float64) delta_t tensor(0.3522, dtype=torch.float64)
11 gae_duplicate tensor(1.6937, dtype=torch.float64) tensor(-3.5159, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5812, dtype=torch.float64) delta_t tensor(0.1599, dtype=torch.float64)
10 gae_duplicate tensor(1.5149, dtype=torch.float64) tensor(-3.1519, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2556, dtype=torch.float64) delta_t tensor(-0.2980, dtype=torch.float64)
9 gae_duplicate tensor(0.9139, dtype=torch.float64) tensor(-1.8993, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5910, dtype=torch.float64) delta_t tensor(-0.5467, dtype=torch.float64)
8 gae_duplicate tensor(0.1845, dtype=torch.float64) tensor(-0.3839, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0469, dtype=torch.float64) delta_t tensor(-1.5029, dtype=torch.float64)
7 gae_duplicate tensor(-1.3553, dtype=torch.float64) tensor(2.8199, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1775, dtype=torch.float64) delta_t tensor(0.6010, dtype=torch.float64)
6 gae_duplicate tensor(-0.4832, dtype=torch.float64) tensor(1.0043, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2011, dtype=torch.float64) delta_t tensor(0.9211, dtype=torch.float64)
5 gae_duplicate tensor(0.5345, dtype=torch.float64) tensor(-1.1108, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0895, dtype=torch.float64) delta_t tensor(-2.2911, dtype=torch.float64)
4 gae_duplicate tensor(-1.8634, dtype=torch.float64) tensor(3.8772, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7883, dtype=torch.float64) delta_t tensor(1.1956, dtype=torch.float64)
3 gae_duplicate tensor(-0.2952, dtype=torch.float64) tensor(0.6141, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2673, dtype=torch.float64) delta_t tensor(-0.1832, dtype=torch.float64)
2 gae_duplicate tensor(-0.4194, dtype=torch.float64) tensor(0.8715, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:64.22984313964844
value loss:31.755657196044922
entropies:37.42991256713867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.636404037475586 seconds
19 rew tensor(0.9037, dtype=torch.float64) delta_t tensor(-0.4252, dtype=torch.float64)
19 gae_duplicate tensor(-0.4252, dtype=torch.float64) tensor(0.8847, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(0.6382, dtype=torch.float64)
18 gae_duplicate tensor(0.2980, dtype=torch.float64) tensor(-0.6193, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(0.4892, dtype=torch.float64)
17 gae_duplicate tensor(0.7276, dtype=torch.float64) tensor(-1.5121, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9045, dtype=torch.float64) delta_t tensor(0.5474, dtype=torch.float64)
16 gae_duplicate tensor(1.1294, dtype=torch.float64) tensor(-2.3528, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9047, dtype=torch.float64) delta_t tensor(0.0373, dtype=torch.float64)
15 gae_duplicate tensor(0.9408, dtype=torch.float64) tensor(-1.9599, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9050, dtype=torch.float64) delta_t tensor(0.5286, dtype=torch.float64)
14 gae_duplicate tensor(1.2813, dtype=torch.float64) tensor(-2.6660, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9053, dtype=torch.float64) delta_t tensor(0.8202, dtype=torch.float64)
13 gae_duplicate tensor(1.8452, dtype=torch.float64) tensor(-3.8348, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9055, dtype=torch.float64) delta_t tensor(0.8586, dtype=torch.float64)
12 gae_duplicate tensor(2.3348, dtype=torch.float64) tensor(-4.8580, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9058, dtype=torch.float64) delta_t tensor(0.6197, dtype=torch.float64)
11 gae_duplicate tensor(2.4875, dtype=torch.float64) tensor(-5.1634, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9060, dtype=torch.float64) delta_t tensor(0.6540, dtype=torch.float64)
10 gae_duplicate tensor(2.6440, dtype=torch.float64) tensor(-5.4948, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6458, dtype=torch.float64) delta_t tensor(0.3820, dtype=torch.float64)
9 gae_duplicate tensor(2.4972, dtype=torch.float64) tensor(-5.1897, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3203, dtype=torch.float64) delta_t tensor(-0.4717, dtype=torch.float64)
8 gae_duplicate tensor(1.5261, dtype=torch.float64) tensor(-3.1677, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3960, dtype=torch.float64) delta_t tensor(-0.4228, dtype=torch.float64)
7 gae_duplicate tensor(0.7981, dtype=torch.float64) tensor(-1.6585, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2425, dtype=torch.float64) delta_t tensor(-0.5602, dtype=torch.float64)
6 gae_duplicate tensor(0.0783, dtype=torch.float64) tensor(-0.1631, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2011, dtype=torch.float64) delta_t tensor(1.5756, dtype=torch.float64)
5 gae_duplicate tensor(1.6382, dtype=torch.float64) tensor(-3.4086, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0892, dtype=torch.float64) delta_t tensor(-1.4083, dtype=torch.float64)
4 gae_duplicate tensor(-0.0977, dtype=torch.float64) tensor(0.2031, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8304, dtype=torch.float64) delta_t tensor(-0.6789, dtype=torch.float64)
3 gae_duplicate tensor(-0.7571, dtype=torch.float64) tensor(1.5733, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5710, dtype=torch.float64) delta_t tensor(-0.9184, dtype=torch.float64)
2 gae_duplicate tensor(-1.5241, dtype=torch.float64) tensor(3.1712, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:216.17446899414062
value loss:62.150054931640625
entropies:37.429901123046875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.613670110702515 seconds
19 rew tensor(0.3185, dtype=torch.float64) delta_t tensor(-1.3304, dtype=torch.float64)
19 gae_duplicate tensor(-1.3304, dtype=torch.float64) tensor(2.7647, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.1378, dtype=torch.float64) delta_t tensor(-0.3796, dtype=torch.float64)
18 gae_duplicate tensor(-1.4438, dtype=torch.float64) tensor(3.0042, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-1.2458, dtype=torch.float64) delta_t tensor(-1.6701, dtype=torch.float64)
17 gae_duplicate tensor(-2.8252, dtype=torch.float64) tensor(5.8711, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8395, dtype=torch.float64) delta_t tensor(0.4520, dtype=torch.float64)
16 gae_duplicate tensor(-1.8081, dtype=torch.float64) tensor(3.7575, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7094, dtype=torch.float64) delta_t tensor(0.4850, dtype=torch.float64)
15 gae_duplicate tensor(-0.9614, dtype=torch.float64) tensor(1.9980, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5792, dtype=torch.float64) delta_t tensor(0.4763, dtype=torch.float64)
14 gae_duplicate tensor(-0.2928, dtype=torch.float64) tensor(0.6100, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4490, dtype=torch.float64) delta_t tensor(0.7301, dtype=torch.float64)
13 gae_duplicate tensor(0.4958, dtype=torch.float64) tensor(-1.0292, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9052, dtype=torch.float64) delta_t tensor(-0.3375, dtype=torch.float64)
12 gae_duplicate tensor(0.0592, dtype=torch.float64) tensor(-0.1232, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8403, dtype=torch.float64) delta_t tensor(0.5069, dtype=torch.float64)
11 gae_duplicate tensor(0.5543, dtype=torch.float64) tensor(-1.1519, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8406, dtype=torch.float64) delta_t tensor(0.4867, dtype=torch.float64)
10 gae_duplicate tensor(0.9302, dtype=torch.float64) tensor(-1.9330, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4622, dtype=torch.float64) delta_t tensor(-0.8195, dtype=torch.float64)
9 gae_duplicate tensor(-0.0754, dtype=torch.float64) tensor(0.1568, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1789, dtype=torch.float64) delta_t tensor(-1.2454, dtype=torch.float64)
8 gae_duplicate tensor(-1.3057, dtype=torch.float64) tensor(2.7168, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0719, dtype=torch.float64) delta_t tensor(-0.3475, dtype=torch.float64)
7 gae_duplicate tensor(-1.3921, dtype=torch.float64) tensor(2.9001, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4627, dtype=torch.float64) delta_t tensor(-0.2537, dtype=torch.float64)
6 gae_duplicate tensor(-1.3674, dtype=torch.float64) tensor(2.8382, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.6120, dtype=torch.float64) delta_t tensor(-0.6169, dtype=torch.float64)
5 gae_duplicate tensor(-1.7107, dtype=torch.float64) tensor(3.5552, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5292, dtype=torch.float64) delta_t tensor(0.2555, dtype=torch.float64)
4 gae_duplicate tensor(-1.1131, dtype=torch.float64) tensor(2.3133, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0573, dtype=torch.float64) delta_t tensor(1.2543, dtype=torch.float64)
3 gae_duplicate tensor(0.3638, dtype=torch.float64) tensor(-0.7560, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5292, dtype=torch.float64) delta_t tensor(0.3225, dtype=torch.float64)
2 gae_duplicate tensor(0.6135, dtype=torch.float64) tensor(-1.2749, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-158.4287109375
value loss:41.59468078613281
entropies:37.429901123046875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.185335159301758 seconds
19 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.5529, dtype=torch.float64)
19 gae_duplicate tensor(0.5529, dtype=torch.float64) tensor(-1.1490, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(0.4776, dtype=torch.float64)
18 gae_duplicate tensor(0.9198, dtype=torch.float64) tensor(-1.9116, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9046, dtype=torch.float64) delta_t tensor(0.2170, dtype=torch.float64)
17 gae_duplicate tensor(0.9529, dtype=torch.float64) tensor(-1.9826, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9048, dtype=torch.float64) delta_t tensor(0.6184, dtype=torch.float64)
16 gae_duplicate tensor(1.3807, dtype=torch.float64) tensor(-2.8692, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9051, dtype=torch.float64) delta_t tensor(0.4673, dtype=torch.float64)
15 gae_duplicate tensor(1.5719, dtype=torch.float64) tensor(-3.2706, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9053, dtype=torch.float64) delta_t tensor(0.4506, dtype=torch.float64)
14 gae_duplicate tensor(1.7081, dtype=torch.float64) tensor(-3.5541, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9056, dtype=torch.float64) delta_t tensor(0.2817, dtype=torch.float64)
13 gae_duplicate tensor(1.6481, dtype=torch.float64) tensor(-3.4251, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9059, dtype=torch.float64) delta_t tensor(0.5370, dtype=torch.float64)
12 gae_duplicate tensor(1.8555, dtype=torch.float64) tensor(-3.8656, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9061, dtype=torch.float64) delta_t tensor(0.5238, dtype=torch.float64)
11 gae_duplicate tensor(2.0082, dtype=torch.float64) tensor(-4.1734, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9064, dtype=torch.float64) delta_t tensor(0.5241, dtype=torch.float64)
10 gae_duplicate tensor(2.1307, dtype=torch.float64) tensor(-4.4279, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9066, dtype=torch.float64) delta_t tensor(0.6036, dtype=torch.float64)
9 gae_duplicate tensor(2.3082, dtype=torch.float64) tensor(-4.7907, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5905, dtype=torch.float64) delta_t tensor(-0.9249, dtype=torch.float64)
8 gae_duplicate tensor(0.9216, dtype=torch.float64) tensor(-1.9152, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7208, dtype=torch.float64) delta_t tensor(-0.5401, dtype=torch.float64)
7 gae_duplicate tensor(0.1972, dtype=torch.float64) tensor(-0.4108, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1116, dtype=torch.float64) delta_t tensor(-0.3019, dtype=torch.float64)
6 gae_duplicate tensor(-0.1442, dtype=torch.float64) tensor(0.3000, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4374, dtype=torch.float64) delta_t tensor(-0.5354, dtype=torch.float64)
5 gae_duplicate tensor(-0.6508, dtype=torch.float64) tensor(1.3523, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5866, dtype=torch.float64) delta_t tensor(-3.2349, dtype=torch.float64)
4 gae_duplicate tensor(-3.7555, dtype=torch.float64) tensor(7.8239, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3983, dtype=torch.float64) delta_t tensor(2.3835, dtype=torch.float64)
3 gae_duplicate tensor(-0.6209, dtype=torch.float64) tensor(1.2903, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3984, dtype=torch.float64) delta_t tensor(0.2116, dtype=torch.float64)
2 gae_duplicate tensor(-0.2851, dtype=torch.float64) tensor(0.5917, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:157.2030792236328
value loss:67.97553253173828
entropies:37.429901123046875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.3722)
ToM Target loss= tensor(306.4380)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.249492168426514 seconds
19 rew tensor(0.8402, dtype=torch.float64) delta_t tensor(-1.3119, dtype=torch.float64)
19 gae_duplicate tensor(-1.3119, dtype=torch.float64) tensor(2.7298, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7752, dtype=torch.float64) delta_t tensor(0.3619, dtype=torch.float64)
18 gae_duplicate tensor(-0.6877, dtype=torch.float64) tensor(1.4327, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7101, dtype=torch.float64) delta_t tensor(0.4921, dtype=torch.float64)
17 gae_duplicate tensor(-0.0580, dtype=torch.float64) tensor(0.1204, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4494, dtype=torch.float64) delta_t tensor(0.2743, dtype=torch.float64)
16 gae_duplicate tensor(0.2279, dtype=torch.float64) tensor(-0.4743, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1235, dtype=torch.float64) delta_t tensor(-0.4423, dtype=torch.float64)
15 gae_duplicate tensor(-0.2600, dtype=torch.float64) tensor(0.5402, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7755, dtype=torch.float64) delta_t tensor(0.2374, dtype=torch.float64)
14 gae_duplicate tensor(0.0294, dtype=torch.float64) tensor(-0.0612, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5801, dtype=torch.float64) delta_t tensor(0.5117, dtype=torch.float64)
13 gae_duplicate tensor(0.5352, dtype=torch.float64) tensor(-1.1152, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5150, dtype=torch.float64) delta_t tensor(-0.0116, dtype=torch.float64)
12 gae_duplicate tensor(0.4165, dtype=torch.float64) tensor(-0.8645, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1892, dtype=torch.float64) delta_t tensor(-0.1919, dtype=torch.float64)
11 gae_duplicate tensor(0.1413, dtype=torch.float64) tensor(-0.2940, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7758, dtype=torch.float64) delta_t tensor(0.1770, dtype=torch.float64)
10 gae_duplicate tensor(0.2900, dtype=torch.float64) tensor(-0.6019, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5805, dtype=torch.float64) delta_t tensor(0.0159, dtype=torch.float64)
9 gae_duplicate tensor(0.2479, dtype=torch.float64) tensor(-0.5151, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1245, dtype=torch.float64) delta_t tensor(1.5922, dtype=torch.float64)
8 gae_duplicate tensor(1.7905, dtype=torch.float64) tensor(-3.7256, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3316, dtype=torch.float64) delta_t tensor(-1.1464, dtype=torch.float64)
7 gae_duplicate tensor(0.2860, dtype=torch.float64) tensor(-0.5950, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5271, dtype=torch.float64) delta_t tensor(0.4849, dtype=torch.float64)
6 gae_duplicate tensor(0.7137, dtype=torch.float64) tensor(-1.4851, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5923, dtype=torch.float64) delta_t tensor(0.4896, dtype=torch.float64)
5 gae_duplicate tensor(1.0606, dtype=torch.float64) tensor(-2.2097, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7878, dtype=torch.float64) delta_t tensor(0.5193, dtype=torch.float64)
4 gae_duplicate tensor(1.3678, dtype=torch.float64) tensor(-2.8423, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5044, dtype=torch.float64) delta_t tensor(-0.8937, dtype=torch.float64)
3 gae_duplicate tensor(0.2005, dtype=torch.float64) tensor(-0.4172, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7886, dtype=torch.float64) delta_t tensor(-0.3946, dtype=torch.float64)
2 gae_duplicate tensor(-0.2342, dtype=torch.float64) tensor(0.4868, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:58.224021911621094
value loss:14.746087074279785
entropies:37.42989730834961
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.405421018600464 seconds
19 rew tensor(0.4493, dtype=torch.float64) delta_t tensor(-1.4143, dtype=torch.float64)
19 gae_duplicate tensor(-1.4143, dtype=torch.float64) tensor(2.9351, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.0077, dtype=torch.float64) delta_t tensor(-0.5453, dtype=torch.float64)
18 gae_duplicate tensor(-1.6768, dtype=torch.float64) tensor(3.4891, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7758, dtype=torch.float64) delta_t tensor(0.9814, dtype=torch.float64)
17 gae_duplicate tensor(-0.3600, dtype=torch.float64) tensor(0.7482, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7107, dtype=torch.float64) delta_t tensor(0.5146, dtype=torch.float64)
16 gae_duplicate tensor(0.2265, dtype=torch.float64) tensor(-0.4707, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6455, dtype=torch.float64) delta_t tensor(0.5929, dtype=torch.float64)
15 gae_duplicate tensor(0.7741, dtype=torch.float64) tensor(-1.6108, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3846, dtype=torch.float64) delta_t tensor(-0.3602, dtype=torch.float64)
14 gae_duplicate tensor(0.2591, dtype=torch.float64) tensor(-0.5385, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5152, dtype=torch.float64) delta_t tensor(-0.2754, dtype=torch.float64)
13 gae_duplicate tensor(-0.0681, dtype=torch.float64) tensor(0.1416, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8416, dtype=torch.float64) delta_t tensor(0.6587, dtype=torch.float64)
12 gae_duplicate tensor(0.6043, dtype=torch.float64) tensor(-1.2574, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9071, dtype=torch.float64) delta_t tensor(0.5343, dtype=torch.float64)
11 gae_duplicate tensor(1.0178, dtype=torch.float64) tensor(-2.1150, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7768, dtype=torch.float64) delta_t tensor(0.4205, dtype=torch.float64)
10 gae_duplicate tensor(1.2347, dtype=torch.float64) tensor(-2.5658, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5812, dtype=torch.float64) delta_t tensor(1.1332, dtype=torch.float64)
9 gae_duplicate tensor(2.1210, dtype=torch.float64) tensor(-4.4135, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0594, dtype=torch.float64) delta_t tensor(-1.8798, dtype=torch.float64)
8 gae_duplicate tensor(-0.1830, dtype=torch.float64) tensor(0.3812, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4625, dtype=torch.float64) delta_t tensor(0.5355, dtype=torch.float64)
7 gae_duplicate tensor(0.3892, dtype=torch.float64) tensor(-0.8098, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3757, dtype=torch.float64) delta_t tensor(-0.6633, dtype=torch.float64)
6 gae_duplicate tensor(-0.3520, dtype=torch.float64) tensor(0.7325, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5721, dtype=torch.float64) delta_t tensor(-0.6221, dtype=torch.float64)
5 gae_duplicate tensor(-0.9037, dtype=torch.float64) tensor(1.8780, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7899, dtype=torch.float64) delta_t tensor(1.1684, dtype=torch.float64)
4 gae_duplicate tensor(0.4454, dtype=torch.float64) tensor(-0.9256, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4426, dtype=torch.float64) delta_t tensor(-0.5416, dtype=torch.float64)
3 gae_duplicate tensor(-0.1853, dtype=torch.float64) tensor(0.3851, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2686, dtype=torch.float64) delta_t tensor(0.3469, dtype=torch.float64)
2 gae_duplicate tensor(0.1987, dtype=torch.float64) tensor(-0.4134, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:25.454362869262695
value loss:21.728652954101562
entropies:37.42989730834961
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.509680986404419 seconds
19 rew tensor(0.7120, dtype=torch.float64) delta_t tensor(-0.8214, dtype=torch.float64)
19 gae_duplicate tensor(-0.8214, dtype=torch.float64) tensor(1.7093, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4508, dtype=torch.float64) delta_t tensor(0.1564, dtype=torch.float64)
18 gae_duplicate tensor(-0.5008, dtype=torch.float64) tensor(1.0420, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0720, dtype=torch.float64) delta_t tensor(-0.0661, dtype=torch.float64)
17 gae_duplicate tensor(-0.4667, dtype=torch.float64) tensor(0.9711, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.8561, dtype=torch.float64) delta_t tensor(-1.1829, dtype=torch.float64)
16 gae_duplicate tensor(-1.5562, dtype=torch.float64) tensor(3.2382, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8425, dtype=torch.float64) delta_t tensor(0.5310, dtype=torch.float64)
15 gae_duplicate tensor(-0.7140, dtype=torch.float64) tensor(1.4877, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8427, dtype=torch.float64) delta_t tensor(0.4907, dtype=torch.float64)
14 gae_duplicate tensor(-0.0804, dtype=torch.float64) tensor(0.1672, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7776, dtype=torch.float64) delta_t tensor(0.5604, dtype=torch.float64)
13 gae_duplicate tensor(0.4960, dtype=torch.float64) tensor(-1.0335, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7778, dtype=torch.float64) delta_t tensor(0.4132, dtype=torch.float64)
12 gae_duplicate tensor(0.8100, dtype=torch.float64) tensor(-1.6831, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8433, dtype=torch.float64) delta_t tensor(0.0805, dtype=torch.float64)
11 gae_duplicate tensor(0.7284, dtype=torch.float64) tensor(-1.5178, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7782, dtype=torch.float64) delta_t tensor(0.5507, dtype=torch.float64)
10 gae_duplicate tensor(1.1334, dtype=torch.float64) tensor(-2.3584, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4626, dtype=torch.float64) delta_t tensor(-0.8534, dtype=torch.float64)
9 gae_duplicate tensor(0.0533, dtype=torch.float64) tensor(-0.1106, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0598, dtype=torch.float64) delta_t tensor(-0.4279, dtype=torch.float64)
8 gae_duplicate tensor(-0.3852, dtype=torch.float64) tensor(0.8006, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7238, dtype=torch.float64) delta_t tensor(-0.9038, dtype=torch.float64)
7 gae_duplicate tensor(-1.2120, dtype=torch.float64) tensor(2.5185, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.8993, dtype=torch.float64) delta_t tensor(-2.1312, dtype=torch.float64)
6 gae_duplicate tensor(-3.1007, dtype=torch.float64) tensor(6.4609, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1168, dtype=torch.float64) delta_t tensor(1.7284, dtype=torch.float64)
5 gae_duplicate tensor(-0.7522, dtype=torch.float64) tensor(1.5652, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1373, dtype=torch.float64) delta_t tensor(-0.1267, dtype=torch.float64)
4 gae_duplicate tensor(-0.7284, dtype=torch.float64) tensor(1.5138, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0517, dtype=torch.float64) delta_t tensor(-0.8950, dtype=torch.float64)
3 gae_duplicate tensor(-1.4777, dtype=torch.float64) tensor(3.0708, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6602, dtype=torch.float64) delta_t tensor(1.2204, dtype=torch.float64)
2 gae_duplicate tensor(0.0382, dtype=torch.float64) tensor(-0.0795, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-107.6963119506836
value loss:31.972328186035156
entropies:37.429893493652344
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.641945123672485 seconds
19 rew tensor(0.6478, dtype=torch.float64) delta_t tensor(-0.9317, dtype=torch.float64)
19 gae_duplicate tensor(-0.9317, dtype=torch.float64) tensor(1.9362, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3862, dtype=torch.float64) delta_t tensor(0.2425, dtype=torch.float64)
18 gae_duplicate tensor(-0.5028, dtype=torch.float64) tensor(1.0478, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0061, dtype=torch.float64) delta_t tensor(-0.6721, dtype=torch.float64)
17 gae_duplicate tensor(-1.0744, dtype=torch.float64) tensor(2.2327, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.9871, dtype=torch.float64) delta_t tensor(-0.7051, dtype=torch.float64)
16 gae_duplicate tensor(-1.5646, dtype=torch.float64) tensor(3.2558, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9091, dtype=torch.float64) delta_t tensor(0.0780, dtype=torch.float64)
15 gae_duplicate tensor(-1.1737, dtype=torch.float64) tensor(2.4457, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8440, dtype=torch.float64) delta_t tensor(0.4630, dtype=torch.float64)
14 gae_duplicate tensor(-0.4759, dtype=torch.float64) tensor(0.9903, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9096, dtype=torch.float64) delta_t tensor(0.5530, dtype=torch.float64)
13 gae_duplicate tensor(0.1723, dtype=torch.float64) tensor(-0.3581, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9099, dtype=torch.float64) delta_t tensor(0.5533, dtype=torch.float64)
12 gae_duplicate tensor(0.6911, dtype=torch.float64) tensor(-1.4362, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9101, dtype=torch.float64) delta_t tensor(0.3245, dtype=torch.float64)
11 gae_duplicate tensor(0.8774, dtype=torch.float64) tensor(-1.8259, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7142, dtype=torch.float64) delta_t tensor(0.3363, dtype=torch.float64)
10 gae_duplicate tensor(1.0382, dtype=torch.float64) tensor(-2.1574, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4528, dtype=torch.float64) delta_t tensor(-0.3653, dtype=torch.float64)
9 gae_duplicate tensor(0.4652, dtype=torch.float64) tensor(-0.9668, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1355, dtype=torch.float64) delta_t tensor(-0.5615, dtype=torch.float64)
8 gae_duplicate tensor(-0.1893, dtype=torch.float64) tensor(0.3939, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5277, dtype=torch.float64) delta_t tensor(0.3482, dtype=torch.float64)
7 gae_duplicate tensor(0.1968, dtype=torch.float64) tensor(-0.4089, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8546, dtype=torch.float64) delta_t tensor(-2.3267, dtype=torch.float64)
6 gae_duplicate tensor(-2.1693, dtype=torch.float64) tensor(4.5079, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2469, dtype=torch.float64) delta_t tensor(1.1004, dtype=torch.float64)
5 gae_duplicate tensor(-0.6351, dtype=torch.float64) tensor(1.3197, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5285, dtype=torch.float64) delta_t tensor(1.2496, dtype=torch.float64)
4 gae_duplicate tensor(0.7416, dtype=torch.float64) tensor(-1.5431, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7703, dtype=torch.float64) delta_t tensor(-1.0966, dtype=torch.float64)
3 gae_duplicate tensor(-0.5034, dtype=torch.float64) tensor(1.0460, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7908, dtype=torch.float64) delta_t tensor(-0.6532, dtype=torch.float64)
2 gae_duplicate tensor(-1.0559, dtype=torch.float64) tensor(2.1971, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-77.18335723876953
value loss:24.001367568969727
entropies:37.429893493652344
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.570352792739868 seconds
19 rew tensor(0.9081, dtype=torch.float64) delta_t tensor(-0.5963, dtype=torch.float64)
19 gae_duplicate tensor(-0.5963, dtype=torch.float64) tensor(1.2373, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9084, dtype=torch.float64) delta_t tensor(0.1020, dtype=torch.float64)
18 gae_duplicate tensor(-0.3750, dtype=torch.float64) tensor(0.7804, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9086, dtype=torch.float64) delta_t tensor(0.5163, dtype=torch.float64)
17 gae_duplicate tensor(0.2163, dtype=torch.float64) tensor(-0.4508, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9089, dtype=torch.float64) delta_t tensor(0.3007, dtype=torch.float64)
16 gae_duplicate tensor(0.4737, dtype=torch.float64) tensor(-0.9844, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9091, dtype=torch.float64) delta_t tensor(0.7809, dtype=torch.float64)
15 gae_duplicate tensor(1.1599, dtype=torch.float64) tensor(-2.4170, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9094, dtype=torch.float64) delta_t tensor(0.4518, dtype=torch.float64)
14 gae_duplicate tensor(1.3797, dtype=torch.float64) tensor(-2.8711, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9096, dtype=torch.float64) delta_t tensor(0.0755, dtype=torch.float64)
13 gae_duplicate tensor(1.1793, dtype=torch.float64) tensor(-2.4506, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9099, dtype=torch.float64) delta_t tensor(0.4273, dtype=torch.float64)
12 gae_duplicate tensor(1.3707, dtype=torch.float64) tensor(-2.8484, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9101, dtype=torch.float64) delta_t tensor(0.4276, dtype=torch.float64)
11 gae_duplicate tensor(1.5242, dtype=torch.float64) tensor(-3.1671, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9104, dtype=torch.float64) delta_t tensor(0.4876, dtype=torch.float64)
10 gae_duplicate tensor(1.7070, dtype=torch.float64) tensor(-3.5470, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9106, dtype=torch.float64) delta_t tensor(0.4782, dtype=torch.float64)
9 gae_duplicate tensor(1.8438, dtype=torch.float64) tensor(-3.8313, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2571, dtype=torch.float64) delta_t tensor(0.5798, dtype=torch.float64)
8 gae_duplicate tensor(2.0548, dtype=torch.float64) tensor(-4.2699, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3312, dtype=torch.float64) delta_t tensor(-0.9350, dtype=torch.float64)
7 gae_duplicate tensor(0.7088, dtype=torch.float64) tensor(-1.4772, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0503, dtype=torch.float64) delta_t tensor(-1.8270, dtype=torch.float64)
6 gae_duplicate tensor(-1.2599, dtype=torch.float64) tensor(2.6181, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.3579, dtype=torch.float64) delta_t tensor(-0.2026, dtype=torch.float64)
5 gae_duplicate tensor(-1.2105, dtype=torch.float64) tensor(2.5190, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7794, dtype=torch.float64) delta_t tensor(2.5801, dtype=torch.float64)
4 gae_duplicate tensor(1.6117, dtype=torch.float64) tensor(-3.3586, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7058, dtype=torch.float64) delta_t tensor(-0.6683, dtype=torch.float64)
3 gae_duplicate tensor(0.6211, dtype=torch.float64) tensor(-1.2888, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6414, dtype=torch.float64) delta_t tensor(-0.0676, dtype=torch.float64)
2 gae_duplicate tensor(0.4293, dtype=torch.float64) tensor(-0.8933, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:159.08120727539062
value loss:40.301307678222656
entropies:37.42988586425781
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.9967)
ToM Target loss= tensor(306.7154)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.62057089805603 seconds
19 rew tensor(0.8429, dtype=torch.float64) delta_t tensor(-0.4853, dtype=torch.float64)
19 gae_duplicate tensor(-0.4853, dtype=torch.float64) tensor(1.0085, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7777, dtype=torch.float64) delta_t tensor(0.7247, dtype=torch.float64)
18 gae_duplicate tensor(0.3365, dtype=torch.float64) tensor(-0.6992, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7124, dtype=torch.float64) delta_t tensor(0.7123, dtype=torch.float64)
17 gae_duplicate tensor(0.9815, dtype=torch.float64) tensor(-2.0395, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4510, dtype=torch.float64) delta_t tensor(0.1242, dtype=torch.float64)
16 gae_duplicate tensor(0.9094, dtype=torch.float64) tensor(-1.8925, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0067, dtype=torch.float64) delta_t tensor(-0.6959, dtype=torch.float64)
15 gae_duplicate tensor(0.0317, dtype=torch.float64) tensor(-0.0658, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3856, dtype=torch.float64) delta_t tensor(0.6649, dtype=torch.float64)
14 gae_duplicate tensor(0.6902, dtype=torch.float64) tensor(-1.4363, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9087, dtype=torch.float64) delta_t tensor(0.7211, dtype=torch.float64)
13 gae_duplicate tensor(1.2733, dtype=torch.float64) tensor(-2.6458, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9090, dtype=torch.float64) delta_t tensor(-0.0390, dtype=torch.float64)
12 gae_duplicate tensor(0.9796, dtype=torch.float64) tensor(-2.0415, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8438, dtype=torch.float64) delta_t tensor(0.5061, dtype=torch.float64)
11 gae_duplicate tensor(1.2898, dtype=torch.float64) tensor(-2.6841, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8441, dtype=torch.float64) delta_t tensor(0.2191, dtype=torch.float64)
10 gae_duplicate tensor(1.2510, dtype=torch.float64) tensor(-2.5995, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1823, dtype=torch.float64) delta_t tensor(-0.6754, dtype=torch.float64)
9 gae_duplicate tensor(0.3254, dtype=torch.float64) tensor(-0.6762, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6478, dtype=torch.float64) delta_t tensor(0.6973, dtype=torch.float64)
8 gae_duplicate tensor(0.9577, dtype=torch.float64) tensor(-1.9929, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1365, dtype=torch.float64) delta_t tensor(-0.1935, dtype=torch.float64)
7 gae_duplicate tensor(0.5727, dtype=torch.float64) tensor(-1.1917, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6594, dtype=torch.float64) delta_t tensor(-1.8313, dtype=torch.float64)
6 gae_duplicate tensor(-1.3732, dtype=torch.float64) tensor(2.8576, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0517, dtype=torch.float64) delta_t tensor(2.6077, dtype=torch.float64)
5 gae_duplicate tensor(1.5091, dtype=torch.float64) tensor(-3.1358, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0127, dtype=torch.float64) delta_t tensor(-2.7805, dtype=torch.float64)
4 gae_duplicate tensor(-1.5732, dtype=torch.float64) tensor(3.2785, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2035, dtype=torch.float64) delta_t tensor(1.3788, dtype=torch.float64)
3 gae_duplicate tensor(0.1202, dtype=torch.float64) tensor(-0.2498, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2690, dtype=torch.float64) delta_t tensor(-0.0278, dtype=torch.float64)
2 gae_duplicate tensor(0.0684, dtype=torch.float64) tensor(-0.1422, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:96.96605682373047
value loss:24.651302337646484
entropies:37.42987823486328
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.298674821853638 seconds
19 rew tensor(0.9086, dtype=torch.float64) delta_t tensor(-1.4200, dtype=torch.float64)
19 gae_duplicate tensor(-1.4200, dtype=torch.float64) tensor(2.9507, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9088, dtype=torch.float64) delta_t tensor(0.4943, dtype=torch.float64)
18 gae_duplicate tensor(-0.6417, dtype=torch.float64) tensor(1.3334, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9091, dtype=torch.float64) delta_t tensor(1.7627, dtype=torch.float64)
17 gae_duplicate tensor(1.2493, dtype=torch.float64) tensor(-2.5960, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9093, dtype=torch.float64) delta_t tensor(0.8328, dtype=torch.float64)
16 gae_duplicate tensor(1.8322, dtype=torch.float64) tensor(-3.8129, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9096, dtype=torch.float64) delta_t tensor(0.7393, dtype=torch.float64)
15 gae_duplicate tensor(2.2051, dtype=torch.float64) tensor(-4.5889, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9098, dtype=torch.float64) delta_t tensor(0.7856, dtype=torch.float64)
14 gae_duplicate tensor(2.5497, dtype=torch.float64) tensor(-5.3060, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9101, dtype=torch.float64) delta_t tensor(4.3977, dtype=torch.float64)
13 gae_duplicate tensor(6.4374, dtype=torch.float64) tensor(-13.3766, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2558, dtype=torch.float64) delta_t tensor(-4.2422, dtype=torch.float64)
12 gae_duplicate tensor(0.9078, dtype=torch.float64) tensor(-1.8891, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3213, dtype=torch.float64) delta_t tensor(0.1469, dtype=torch.float64)
11 gae_duplicate tensor(0.8731, dtype=torch.float64) tensor(-1.8168, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3214, dtype=torch.float64) delta_t tensor(0.1200, dtype=torch.float64)
10 gae_duplicate tensor(0.8184, dtype=torch.float64) tensor(-1.7006, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1906, dtype=torch.float64) delta_t tensor(-0.1935, dtype=torch.float64)
9 gae_duplicate tensor(0.4612, dtype=torch.float64) tensor(-0.9584, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0598, dtype=torch.float64) delta_t tensor(0.4532, dtype=torch.float64)
8 gae_duplicate tensor(0.8222, dtype=torch.float64) tensor(-1.7084, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8558, dtype=torch.float64) delta_t tensor(0.0586, dtype=torch.float64)
7 gae_duplicate tensor(0.7163, dtype=torch.float64) tensor(-1.4907, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.2949, dtype=torch.float64) delta_t tensor(-1.7361, dtype=torch.float64)
6 gae_duplicate tensor(-1.1630, dtype=torch.float64) tensor(2.4238, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6426, dtype=torch.float64) delta_t tensor(1.0175, dtype=torch.float64)
5 gae_duplicate tensor(0.0871, dtype=torch.float64) tensor(-0.1810, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9235, dtype=torch.float64) delta_t tensor(-0.2472, dtype=torch.float64)
4 gae_duplicate tensor(-0.1775, dtype=torch.float64) tensor(0.3688, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1382, dtype=torch.float64) delta_t tensor(0.9347, dtype=torch.float64)
3 gae_duplicate tensor(0.7927, dtype=torch.float64) tensor(-1.6472, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3346, dtype=torch.float64) delta_t tensor(0.2923, dtype=torch.float64)
2 gae_duplicate tensor(0.9265, dtype=torch.float64) tensor(-1.9280, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:214.4196319580078
value loss:100.03068542480469
entropies:37.42987823486328
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.616647005081177 seconds
19 rew tensor(0.9080, dtype=torch.float64) delta_t tensor(-0.0671, dtype=torch.float64)
19 gae_duplicate tensor(-0.0671, dtype=torch.float64) tensor(0.1391, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9083, dtype=torch.float64) delta_t tensor(0.4865, dtype=torch.float64)
18 gae_duplicate tensor(0.4328, dtype=torch.float64) tensor(-0.8994, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9085, dtype=torch.float64) delta_t tensor(0.3828, dtype=torch.float64)
17 gae_duplicate tensor(0.7291, dtype=torch.float64) tensor(-1.5172, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9088, dtype=torch.float64) delta_t tensor(0.4451, dtype=torch.float64)
16 gae_duplicate tensor(1.0284, dtype=torch.float64) tensor(-2.1368, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9090, dtype=torch.float64) delta_t tensor(0.7013, dtype=torch.float64)
15 gae_duplicate tensor(1.5240, dtype=torch.float64) tensor(-3.1762, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9093, dtype=torch.float64) delta_t tensor(0.2337, dtype=torch.float64)
14 gae_duplicate tensor(1.4529, dtype=torch.float64) tensor(-3.0281, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9095, dtype=torch.float64) delta_t tensor(0.3576, dtype=torch.float64)
13 gae_duplicate tensor(1.5200, dtype=torch.float64) tensor(-3.1583, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9098, dtype=torch.float64) delta_t tensor(0.5101, dtype=torch.float64)
12 gae_duplicate tensor(1.7261, dtype=torch.float64) tensor(-3.5812, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9100, dtype=torch.float64) delta_t tensor(0.5853, dtype=torch.float64)
11 gae_duplicate tensor(1.9661, dtype=torch.float64) tensor(-4.0854, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9103, dtype=torch.float64) delta_t tensor(0.5900, dtype=torch.float64)
10 gae_duplicate tensor(2.1629, dtype=torch.float64) tensor(-4.4942, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6487, dtype=torch.float64) delta_t tensor(0.3685, dtype=torch.float64)
9 gae_duplicate tensor(2.0989, dtype=torch.float64) tensor(-4.3545, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1251, dtype=torch.float64) delta_t tensor(-0.4671, dtype=torch.float64)
8 gae_duplicate tensor(1.2120, dtype=torch.float64) tensor(-2.5222, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8565, dtype=torch.float64) delta_t tensor(-0.6449, dtype=torch.float64)
7 gae_duplicate tensor(0.3247, dtype=torch.float64) tensor(-0.6767, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0531, dtype=torch.float64) delta_t tensor(-0.6232, dtype=torch.float64)
6 gae_duplicate tensor(-0.3635, dtype=torch.float64) tensor(0.7564, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6425, dtype=torch.float64) delta_t tensor(-0.8836, dtype=torch.float64)
5 gae_duplicate tensor(-1.1744, dtype=torch.float64) tensor(2.4440, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7088, dtype=torch.float64) delta_t tensor(-1.1984, dtype=torch.float64)
4 gae_duplicate tensor(-2.1379, dtype=torch.float64) tensor(4.4555, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1237, dtype=torch.float64) delta_t tensor(2.1596, dtype=torch.float64)
3 gae_duplicate tensor(0.4493, dtype=torch.float64) tensor(-0.9336, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2512, dtype=torch.float64) delta_t tensor(-0.4746, dtype=torch.float64)
2 gae_duplicate tensor(-0.1152, dtype=torch.float64) tensor(0.2390, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:158.0550994873047
value loss:48.48634338378906
entropies:37.42987823486328
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.374731063842773 seconds
19 rew tensor(0.9090, dtype=torch.float64) delta_t tensor(-0.1041, dtype=torch.float64)
19 gae_duplicate tensor(-0.1041, dtype=torch.float64) tensor(0.2166, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9092, dtype=torch.float64) delta_t tensor(0.7706, dtype=torch.float64)
18 gae_duplicate tensor(0.6873, dtype=torch.float64) tensor(-1.4303, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9095, dtype=torch.float64) delta_t tensor(0.4791, dtype=torch.float64)
17 gae_duplicate tensor(1.0289, dtype=torch.float64) tensor(-2.1380, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9097, dtype=torch.float64) delta_t tensor(0.8981, dtype=torch.float64)
16 gae_duplicate tensor(1.7213, dtype=torch.float64) tensor(-3.5821, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9100, dtype=torch.float64) delta_t tensor(0.3042, dtype=torch.float64)
15 gae_duplicate tensor(1.6812, dtype=torch.float64) tensor(-3.4987, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9102, dtype=torch.float64) delta_t tensor(0.7918, dtype=torch.float64)
14 gae_duplicate tensor(2.1368, dtype=torch.float64) tensor(-4.4399, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5171, dtype=torch.float64) delta_t tensor(-0.1714, dtype=torch.float64)
13 gae_duplicate tensor(1.5380, dtype=torch.float64) tensor(-3.2008, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1239, dtype=torch.float64) delta_t tensor(1.1425, dtype=torch.float64)
12 gae_duplicate tensor(2.3729, dtype=torch.float64) tensor(-4.9457, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1239, dtype=torch.float64) delta_t tensor(-0.2370, dtype=torch.float64)
11 gae_duplicate tensor(1.6614, dtype=torch.float64) tensor(-3.4626, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2038, dtype=torch.float64) delta_t tensor(-0.5295, dtype=torch.float64)
10 gae_duplicate tensor(0.7996, dtype=torch.float64) tensor(-1.6641, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0072, dtype=torch.float64) delta_t tensor(-1.1219, dtype=torch.float64)
9 gae_duplicate tensor(-0.4822, dtype=torch.float64) tensor(1.0004, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1893, dtype=torch.float64) delta_t tensor(0.4218, dtype=torch.float64)
8 gae_duplicate tensor(0.0360, dtype=torch.float64) tensor(-0.0734, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2549, dtype=torch.float64) delta_t tensor(0.2065, dtype=torch.float64)
7 gae_duplicate tensor(0.2353, dtype=torch.float64) tensor(-0.4859, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0726, dtype=torch.float64) delta_t tensor(0.4873, dtype=torch.float64)
6 gae_duplicate tensor(0.6755, dtype=torch.float64) tensor(-1.4037, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5965, dtype=torch.float64) delta_t tensor(0.8783, dtype=torch.float64)
5 gae_duplicate tensor(1.4187, dtype=torch.float64) tensor(-2.9479, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7931, dtype=torch.float64) delta_t tensor(0.2996, dtype=torch.float64)
4 gae_duplicate tensor(1.4345, dtype=torch.float64) tensor(-2.9808, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5136, dtype=torch.float64) delta_t tensor(-0.1631, dtype=torch.float64)
3 gae_duplicate tensor(0.9846, dtype=torch.float64) tensor(-2.0427, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7284, dtype=torch.float64) delta_t tensor(-1.7632, dtype=torch.float64)
2 gae_duplicate tensor(-0.9755, dtype=torch.float64) tensor(2.0301, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:209.1736297607422
value loss:45.04494094848633
entropies:37.428890228271484
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.585211992263794 seconds
19 rew tensor(0.6474, dtype=torch.float64) delta_t tensor(-2.0813, dtype=torch.float64)
19 gae_duplicate tensor(-2.0813, dtype=torch.float64) tensor(4.3384, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4508, dtype=torch.float64) delta_t tensor(-0.0396, dtype=torch.float64)
18 gae_duplicate tensor(-1.7046, dtype=torch.float64) tensor(3.5475, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0083, dtype=torch.float64) delta_t tensor(-0.7464, dtype=torch.float64)
17 gae_duplicate tensor(-2.1101, dtype=torch.float64) tensor(4.3842, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8442, dtype=torch.float64) delta_t tensor(0.3071, dtype=torch.float64)
16 gae_duplicate tensor(-1.3809, dtype=torch.float64) tensor(2.8738, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6477, dtype=torch.float64) delta_t tensor(0.6482, dtype=torch.float64)
15 gae_duplicate tensor(-0.4565, dtype=torch.float64) tensor(0.9500, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5167, dtype=torch.float64) delta_t tensor(-0.0978, dtype=torch.float64)
14 gae_duplicate tensor(-0.4630, dtype=torch.float64) tensor(0.9620, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1234, dtype=torch.float64) delta_t tensor(0.3140, dtype=torch.float64)
13 gae_duplicate tensor(-0.0564, dtype=torch.float64) tensor(0.1173, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9101, dtype=torch.float64) delta_t tensor(-0.4148, dtype=torch.float64)
12 gae_duplicate tensor(-0.4599, dtype=torch.float64) tensor(0.9556, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1893, dtype=torch.float64) delta_t tensor(-0.3339, dtype=torch.float64)
11 gae_duplicate tensor(-0.7018, dtype=torch.float64) tensor(1.4581, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2548, dtype=torch.float64) delta_t tensor(-0.2863, dtype=torch.float64)
10 gae_duplicate tensor(-0.8477, dtype=torch.float64) tensor(1.7642, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-3.1530, dtype=torch.float64) delta_t tensor(-3.6511, dtype=torch.float64)
9 gae_duplicate tensor(-4.3292, dtype=torch.float64) tensor(8.9952, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5824, dtype=torch.float64) delta_t tensor(-0.3031, dtype=torch.float64)
8 gae_duplicate tensor(-3.7665, dtype=torch.float64) tensor(7.8132, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1888, dtype=torch.float64) delta_t tensor(-0.2919, dtype=torch.float64)
7 gae_duplicate tensor(-3.3051, dtype=torch.float64) tensor(6.8892, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2704, dtype=torch.float64) delta_t tensor(1.4914, dtype=torch.float64)
6 gae_duplicate tensor(-1.1526, dtype=torch.float64) tensor(2.3949, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1887, dtype=torch.float64) delta_t tensor(1.1200, dtype=torch.float64)
5 gae_duplicate tensor(0.1979, dtype=torch.float64) tensor(-0.4126, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4015, dtype=torch.float64) delta_t tensor(0.8321, dtype=torch.float64)
4 gae_duplicate tensor(0.9904, dtype=torch.float64) tensor(-2.0579, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3360, dtype=torch.float64) delta_t tensor(-0.6748, dtype=torch.float64)
3 gae_duplicate tensor(0.1175, dtype=torch.float64) tensor(-0.2441, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3197, dtype=torch.float64) delta_t tensor(0.4835, dtype=torch.float64)
2 gae_duplicate tensor(0.5775, dtype=torch.float64) tensor(-1.2017, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-262.2881774902344
value loss:92.9898910522461
entropies:37.42987060546875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.8327)
ToM Target loss= tensor(306.1334)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.332399845123291 seconds
19 rew tensor(0.9090, dtype=torch.float64) delta_t tensor(-1.7140, dtype=torch.float64)
19 gae_duplicate tensor(-1.7140, dtype=torch.float64) tensor(3.5554, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9093, dtype=torch.float64) delta_t tensor(0.3632, dtype=torch.float64)
18 gae_duplicate tensor(-1.0080, dtype=torch.float64) tensor(2.0978, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9095, dtype=torch.float64) delta_t tensor(0.9532, dtype=torch.float64)
17 gae_duplicate tensor(0.1468, dtype=torch.float64) tensor(-0.3051, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9098, dtype=torch.float64) delta_t tensor(0.7563, dtype=torch.float64)
16 gae_duplicate tensor(0.8738, dtype=torch.float64) tensor(-1.8215, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9100, dtype=torch.float64) delta_t tensor(0.0045, dtype=torch.float64)
15 gae_duplicate tensor(0.7036, dtype=torch.float64) tensor(-1.4594, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9103, dtype=torch.float64) delta_t tensor(0.4249, dtype=torch.float64)
14 gae_duplicate tensor(0.9878, dtype=torch.float64) tensor(-2.0489, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9105, dtype=torch.float64) delta_t tensor(0.6012, dtype=torch.float64)
13 gae_duplicate tensor(1.3915, dtype=torch.float64) tensor(-2.8911, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9107, dtype=torch.float64) delta_t tensor(0.3714, dtype=torch.float64)
12 gae_duplicate tensor(1.4846, dtype=torch.float64) tensor(-3.0794, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9110, dtype=torch.float64) delta_t tensor(0.5489, dtype=torch.float64)
11 gae_duplicate tensor(1.7366, dtype=torch.float64) tensor(-3.6202, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9112, dtype=torch.float64) delta_t tensor(0.6441, dtype=torch.float64)
10 gae_duplicate tensor(2.0334, dtype=torch.float64) tensor(-4.2318, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6488, dtype=torch.float64) delta_t tensor(0.3626, dtype=torch.float64)
9 gae_duplicate tensor(1.9894, dtype=torch.float64) tensor(-4.1471, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3863, dtype=torch.float64) delta_t tensor(-0.0850, dtype=torch.float64)
8 gae_duplicate tensor(1.5065, dtype=torch.float64) tensor(-3.1354, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1238, dtype=torch.float64) delta_t tensor(0.6513, dtype=torch.float64)
7 gae_duplicate tensor(1.8565, dtype=torch.float64) tensor(-3.8573, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0582, dtype=torch.float64) delta_t tensor(-0.2147, dtype=torch.float64)
6 gae_duplicate tensor(1.2705, dtype=torch.float64) tensor(-2.6398, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2043, dtype=torch.float64) delta_t tensor(1.1213, dtype=torch.float64)
5 gae_duplicate tensor(2.1377, dtype=torch.float64) tensor(-4.4342, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1886, dtype=torch.float64) delta_t tensor(0.4256, dtype=torch.float64)
4 gae_duplicate tensor(2.1358, dtype=torch.float64) tensor(-4.4522, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7953, dtype=torch.float64) delta_t tensor(0.2860, dtype=torch.float64)
3 gae_duplicate tensor(1.9946, dtype=torch.float64) tensor(-4.1443, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7955, dtype=torch.float64) delta_t tensor(-0.2611, dtype=torch.float64)
2 gae_duplicate tensor(1.3346, dtype=torch.float64) tensor(-2.7821, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:259.2575378417969
value loss:65.51911926269531
entropies:37.42987060546875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.533000946044922 seconds
19 rew tensor(0.8435, dtype=torch.float64) delta_t tensor(-1.3490, dtype=torch.float64)
19 gae_duplicate tensor(-1.3490, dtype=torch.float64) tensor(2.8076, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9094, dtype=torch.float64) delta_t tensor(-0.0509, dtype=torch.float64)
18 gae_duplicate tensor(-1.1301, dtype=torch.float64) tensor(2.3561, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8439, dtype=torch.float64) delta_t tensor(0.3193, dtype=torch.float64)
17 gae_duplicate tensor(-0.5848, dtype=torch.float64) tensor(1.2150, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8441, dtype=torch.float64) delta_t tensor(0.0936, dtype=torch.float64)
16 gae_duplicate tensor(-0.3743, dtype=torch.float64) tensor(0.7763, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7130, dtype=torch.float64) delta_t tensor(0.3330, dtype=torch.float64)
15 gae_duplicate tensor(0.0336, dtype=torch.float64) tensor(-0.0698, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7131, dtype=torch.float64) delta_t tensor(0.1350, dtype=torch.float64)
14 gae_duplicate tensor(0.1619, dtype=torch.float64) tensor(-0.3358, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5162, dtype=torch.float64) delta_t tensor(-0.5598, dtype=torch.float64)
13 gae_duplicate tensor(-0.4303, dtype=torch.float64) tensor(0.8956, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9104, dtype=torch.float64) delta_t tensor(0.2563, dtype=torch.float64)
12 gae_duplicate tensor(-0.0879, dtype=torch.float64) tensor(0.1830, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2538, dtype=torch.float64) delta_t tensor(-0.4002, dtype=torch.float64)
11 gae_duplicate tensor(-0.4706, dtype=torch.float64) tensor(0.9777, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7792, dtype=torch.float64) delta_t tensor(0.1770, dtype=torch.float64)
10 gae_duplicate tensor(-0.1995, dtype=torch.float64) tensor(0.4137, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5168, dtype=torch.float64) delta_t tensor(0.0414, dtype=torch.float64)
9 gae_duplicate tensor(-0.1182, dtype=torch.float64) tensor(0.2455, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0572, dtype=torch.float64) delta_t tensor(0.7174, dtype=torch.float64)
8 gae_duplicate tensor(0.6229, dtype=torch.float64) tensor(-1.2964, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2054, dtype=torch.float64) delta_t tensor(-0.8973, dtype=torch.float64)
7 gae_duplicate tensor(-0.3990, dtype=torch.float64) tensor(0.8317, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5838, dtype=torch.float64) delta_t tensor(-0.9660, dtype=torch.float64)
6 gae_duplicate tensor(-1.2852, dtype=torch.float64) tensor(2.6702, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1755, dtype=torch.float64) delta_t tensor(-0.1622, dtype=torch.float64)
5 gae_duplicate tensor(-1.1904, dtype=torch.float64) tensor(2.4774, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1920, dtype=torch.float64) delta_t tensor(-0.4944, dtype=torch.float64)
4 gae_duplicate tensor(-1.4467, dtype=torch.float64) tensor(3.0108, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1215, dtype=torch.float64) delta_t tensor(0.9006, dtype=torch.float64)
3 gae_duplicate tensor(-0.2567, dtype=torch.float64) tensor(0.5333, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4550, dtype=torch.float64) delta_t tensor(-0.9068, dtype=torch.float64)
2 gae_duplicate tensor(-1.1121, dtype=torch.float64) tensor(2.3146, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-121.16207885742188
value loss:16.628965377807617
entropies:37.429866790771484
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.390054941177368 seconds
19 rew tensor(0.5818, dtype=torch.float64) delta_t tensor(-1.6116, dtype=torch.float64)
19 gae_duplicate tensor(-1.6116, dtype=torch.float64) tensor(3.3540, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3848, dtype=torch.float64) delta_t tensor(-0.1228, dtype=torch.float64)
18 gae_duplicate tensor(-1.4121, dtype=torch.float64) tensor(2.9337, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.2723, dtype=torch.float64) delta_t tensor(-1.1129, dtype=torch.float64)
17 gae_duplicate tensor(-2.2426, dtype=torch.float64) tensor(4.6755, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-1.2580, dtype=torch.float64) delta_t tensor(-0.7400, dtype=torch.float64)
16 gae_duplicate tensor(-2.5340, dtype=torch.float64) tensor(5.2647, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8443, dtype=torch.float64) delta_t tensor(0.4552, dtype=torch.float64)
15 gae_duplicate tensor(-1.5720, dtype=torch.float64) tensor(3.2774, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9103, dtype=torch.float64) delta_t tensor(0.4563, dtype=torch.float64)
14 gae_duplicate tensor(-0.8012, dtype=torch.float64) tensor(1.6647, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8448, dtype=torch.float64) delta_t tensor(0.2190, dtype=torch.float64)
13 gae_duplicate tensor(-0.4220, dtype=torch.float64) tensor(0.8768, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8450, dtype=torch.float64) delta_t tensor(3.4143, dtype=torch.float64)
12 gae_duplicate tensor(3.0766, dtype=torch.float64) tensor(-6.3921, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7795, dtype=torch.float64) delta_t tensor(-3.1026, dtype=torch.float64)
11 gae_duplicate tensor(-0.6413, dtype=torch.float64) tensor(1.3370, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6483, dtype=torch.float64) delta_t tensor(0.1498, dtype=torch.float64)
10 gae_duplicate tensor(-0.3632, dtype=torch.float64) tensor(0.7547, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0742, dtype=torch.float64) delta_t tensor(-0.6637, dtype=torch.float64)
9 gae_duplicate tensor(-0.9543, dtype=torch.float64) tensor(1.9791, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7967, dtype=torch.float64) delta_t tensor(-1.6660, dtype=torch.float64)
8 gae_duplicate tensor(-2.4294, dtype=torch.float64) tensor(5.0474, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2715, dtype=torch.float64) delta_t tensor(-0.0691, dtype=torch.float64)
7 gae_duplicate tensor(-2.0126, dtype=torch.float64) tensor(4.1815, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.0446, dtype=torch.float64) delta_t tensor(-0.6862, dtype=torch.float64)
6 gae_duplicate tensor(-2.2963, dtype=torch.float64) tensor(4.7791, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8490, dtype=torch.float64) delta_t tensor(0.9201, dtype=torch.float64)
5 gae_duplicate tensor(-0.9169, dtype=torch.float64) tensor(1.9117, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7188, dtype=torch.float64) delta_t tensor(-0.9582, dtype=torch.float64)
4 gae_duplicate tensor(-1.6918, dtype=torch.float64) tensor(3.5210, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1419, dtype=torch.float64) delta_t tensor(0.8045, dtype=torch.float64)
3 gae_duplicate tensor(-0.5489, dtype=torch.float64) tensor(1.1404, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2077, dtype=torch.float64) delta_t tensor(0.3322, dtype=torch.float64)
2 gae_duplicate tensor(-0.1069, dtype=torch.float64) tensor(0.2222, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-244.29580688476562
value loss:74.2401123046875
entropies:37.42986297607422
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.548128843307495 seconds
19 rew tensor(0.8438, dtype=torch.float64) delta_t tensor(-0.9963, dtype=torch.float64)
19 gae_duplicate tensor(-0.9963, dtype=torch.float64) tensor(2.0773, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9097, dtype=torch.float64) delta_t tensor(0.2868, dtype=torch.float64)
18 gae_duplicate tensor(-0.5102, dtype=torch.float64) tensor(1.0619, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8442, dtype=torch.float64) delta_t tensor(0.0869, dtype=torch.float64)
17 gae_duplicate tensor(-0.3213, dtype=torch.float64) tensor(0.6675, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7788, dtype=torch.float64) delta_t tensor(0.3538, dtype=torch.float64)
16 gae_duplicate tensor(0.0967, dtype=torch.float64) tensor(-0.2013, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8446, dtype=torch.float64) delta_t tensor(0.2501, dtype=torch.float64)
15 gae_duplicate tensor(0.3275, dtype=torch.float64) tensor(-0.6792, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7135, dtype=torch.float64) delta_t tensor(-0.1612, dtype=torch.float64)
14 gae_duplicate tensor(0.1008, dtype=torch.float64) tensor(-0.2099, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6480, dtype=torch.float64) delta_t tensor(0.0459, dtype=torch.float64)
13 gae_duplicate tensor(0.1266, dtype=torch.float64) tensor(-0.2630, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9107, dtype=torch.float64) delta_t tensor(0.3314, dtype=torch.float64)
12 gae_duplicate tensor(0.4327, dtype=torch.float64) tensor(-0.9022, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9110, dtype=torch.float64) delta_t tensor(0.0969, dtype=torch.float64)
11 gae_duplicate tensor(0.4430, dtype=torch.float64) tensor(-0.9188, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6487, dtype=torch.float64) delta_t tensor(0.0801, dtype=torch.float64)
10 gae_duplicate tensor(0.4345, dtype=torch.float64) tensor(-0.9059, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7295, dtype=torch.float64) delta_t tensor(-1.6195, dtype=torch.float64)
9 gae_duplicate tensor(-1.2719, dtype=torch.float64) tensor(2.6425, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2046, dtype=torch.float64) delta_t tensor(-0.0465, dtype=torch.float64)
8 gae_duplicate tensor(-1.0640, dtype=torch.float64) tensor(2.2146, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3359, dtype=torch.float64) delta_t tensor(-0.8514, dtype=torch.float64)
7 gae_duplicate tensor(-1.7026, dtype=torch.float64) tensor(3.5436, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5984, dtype=torch.float64) delta_t tensor(0.1428, dtype=torch.float64)
6 gae_duplicate tensor(-1.2193, dtype=torch.float64) tensor(2.5287, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1234, dtype=torch.float64) delta_t tensor(-0.6422, dtype=torch.float64)
5 gae_duplicate tensor(-1.6176, dtype=torch.float64) tensor(3.3607, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.2073, dtype=torch.float64) delta_t tensor(-1.9257, dtype=torch.float64)
4 gae_duplicate tensor(-3.2198, dtype=torch.float64) tensor(6.7014, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0754, dtype=torch.float64) delta_t tensor(0.0513, dtype=torch.float64)
3 gae_duplicate tensor(-2.5246, dtype=torch.float64) tensor(5.2451, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0097, dtype=torch.float64) delta_t tensor(0.3491, dtype=torch.float64)
2 gae_duplicate tensor(-1.6705, dtype=torch.float64) tensor(3.4706, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-177.72442626953125
value loss:47.032005310058594
entropies:37.42985916137695
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.1717400550842285 seconds
19 rew tensor(0.9085, dtype=torch.float64) delta_t tensor(-1.0702, dtype=torch.float64)
19 gae_duplicate tensor(-1.0702, dtype=torch.float64) tensor(2.2275, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9088, dtype=torch.float64) delta_t tensor(0.8955, dtype=torch.float64)
18 gae_duplicate tensor(0.0393, dtype=torch.float64) tensor(-0.0817, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9090, dtype=torch.float64) delta_t tensor(0.6504, dtype=torch.float64)
17 gae_duplicate tensor(0.6819, dtype=torch.float64) tensor(-1.4166, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9092, dtype=torch.float64) delta_t tensor(0.6021, dtype=torch.float64)
16 gae_duplicate tensor(1.1476, dtype=torch.float64) tensor(-2.3798, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9095, dtype=torch.float64) delta_t tensor(0.5590, dtype=torch.float64)
15 gae_duplicate tensor(1.4770, dtype=torch.float64) tensor(-3.0743, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9097, dtype=torch.float64) delta_t tensor(-0.7842, dtype=torch.float64)
14 gae_duplicate tensor(0.3974, dtype=torch.float64) tensor(-0.8272, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5167, dtype=torch.float64) delta_t tensor(-0.1649, dtype=torch.float64)
13 gae_duplicate tensor(0.1530, dtype=torch.float64) tensor(-0.3179, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5824, dtype=torch.float64) delta_t tensor(-0.0197, dtype=torch.float64)
12 gae_duplicate tensor(0.1027, dtype=torch.float64) tensor(-0.2137, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6480, dtype=torch.float64) delta_t tensor(0.1333, dtype=torch.float64)
11 gae_duplicate tensor(0.2154, dtype=torch.float64) tensor(-0.4476, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5826, dtype=torch.float64) delta_t tensor(0.3206, dtype=torch.float64)
10 gae_duplicate tensor(0.4930, dtype=torch.float64) tensor(-1.0241, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5827, dtype=torch.float64) delta_t tensor(0.2156, dtype=torch.float64)
9 gae_duplicate tensor(0.6100, dtype=torch.float64) tensor(-1.2673, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5307, dtype=torch.float64) delta_t tensor(-1.4431, dtype=torch.float64)
8 gae_duplicate tensor(-0.9551, dtype=torch.float64) tensor(1.9843, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5787, dtype=torch.float64) delta_t tensor(-2.0779, dtype=torch.float64)
7 gae_duplicate tensor(-2.8420, dtype=torch.float64) tensor(5.9153, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1865, dtype=torch.float64) delta_t tensor(-1.2072, dtype=torch.float64)
6 gae_duplicate tensor(-3.4808, dtype=torch.float64) tensor(7.2182, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9730, dtype=torch.float64) delta_t tensor(-0.7088, dtype=torch.float64)
5 gae_duplicate tensor(-3.4934, dtype=torch.float64) tensor(7.2576, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.2028, dtype=torch.float64) delta_t tensor(-2.0140, dtype=torch.float64)
4 gae_duplicate tensor(-4.8087, dtype=torch.float64) tensor(10.0087, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3379, dtype=torch.float64) delta_t tensor(0.9400, dtype=torch.float64)
3 gae_duplicate tensor(-2.9070, dtype=torch.float64) tensor(6.0507, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3380, dtype=torch.float64) delta_t tensor(0.5935, dtype=torch.float64)
2 gae_duplicate tensor(-1.7321, dtype=torch.float64) tensor(3.6051, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-200.42686462402344
value loss:110.77125549316406
entropies:37.42985153198242
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.4939)
ToM Target loss= tensor(306.3890)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.155071020126343 seconds
19 rew tensor(0.9080, dtype=torch.float64) delta_t tensor(-1.2893, dtype=torch.float64)
19 gae_duplicate tensor(-1.2893, dtype=torch.float64) tensor(2.6785, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9083, dtype=torch.float64) delta_t tensor(0.1568, dtype=torch.float64)
18 gae_duplicate tensor(-0.8746, dtype=torch.float64) tensor(1.8238, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9085, dtype=torch.float64) delta_t tensor(0.4709, dtype=torch.float64)
17 gae_duplicate tensor(-0.2287, dtype=torch.float64) tensor(0.4761, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9087, dtype=torch.float64) delta_t tensor(0.4083, dtype=torch.float64)
16 gae_duplicate tensor(0.2253, dtype=torch.float64) tensor(-0.4680, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9090, dtype=torch.float64) delta_t tensor(0.4177, dtype=torch.float64)
15 gae_duplicate tensor(0.5979, dtype=torch.float64) tensor(-1.2422, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9092, dtype=torch.float64) delta_t tensor(0.4179, dtype=torch.float64)
14 gae_duplicate tensor(0.8962, dtype=torch.float64) tensor(-1.8619, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9094, dtype=torch.float64) delta_t tensor(0.1093, dtype=torch.float64)
13 gae_duplicate tensor(0.8263, dtype=torch.float64) tensor(-1.7166, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9097, dtype=torch.float64) delta_t tensor(0.3174, dtype=torch.float64)
12 gae_duplicate tensor(0.9784, dtype=torch.float64) tensor(-2.0404, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9099, dtype=torch.float64) delta_t tensor(0.2218, dtype=torch.float64)
11 gae_duplicate tensor(1.0045, dtype=torch.float64) tensor(-2.0948, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5824, dtype=torch.float64) delta_t tensor(0.0993, dtype=torch.float64)
10 gae_duplicate tensor(0.9029, dtype=torch.float64) tensor(-1.8793, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3203, dtype=torch.float64) delta_t tensor(0.3689, dtype=torch.float64)
9 gae_duplicate tensor(1.0912, dtype=torch.float64) tensor(-2.2713, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1238, dtype=torch.float64) delta_t tensor(-0.6312, dtype=torch.float64)
8 gae_duplicate tensor(0.2418, dtype=torch.float64) tensor(-0.4818, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5169, dtype=torch.float64) delta_t tensor(0.9295, dtype=torch.float64)
7 gae_duplicate tensor(1.1229, dtype=torch.float64) tensor(-2.2153, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1210, dtype=torch.float64) delta_t tensor(-0.7513, dtype=torch.float64)
6 gae_duplicate tensor(0.1470, dtype=torch.float64) tensor(-0.3048, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2524, dtype=torch.float64) delta_t tensor(-0.4690, dtype=torch.float64)
5 gae_duplicate tensor(-0.3514, dtype=torch.float64) tensor(0.7301, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7770, dtype=torch.float64) delta_t tensor(-0.3530, dtype=torch.float64)
4 gae_duplicate tensor(-0.6341, dtype=torch.float64) tensor(1.3223, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5159, dtype=torch.float64) delta_t tensor(0.5876, dtype=torch.float64)
3 gae_duplicate tensor(0.0803, dtype=torch.float64) tensor(-0.1675, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0577, dtype=torch.float64) delta_t tensor(-0.8207, dtype=torch.float64)
2 gae_duplicate tensor(-0.7564, dtype=torch.float64) tensor(1.5745, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:47.70975112915039
value loss:16.187177658081055
entropies:37.41987609863281
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.413969993591309 seconds
19 rew tensor(0.9078, dtype=torch.float64) delta_t tensor(-0.9261, dtype=torch.float64)
19 gae_duplicate tensor(-0.9261, dtype=torch.float64) tensor(1.9276, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9081, dtype=torch.float64) delta_t tensor(-0.4225, dtype=torch.float64)
18 gae_duplicate tensor(-1.1634, dtype=torch.float64) tensor(2.4168, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9083, dtype=torch.float64) delta_t tensor(0.8375, dtype=torch.float64)
17 gae_duplicate tensor(-0.0932, dtype=torch.float64) tensor(0.1944, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9085, dtype=torch.float64) delta_t tensor(0.4467, dtype=torch.float64)
16 gae_duplicate tensor(0.3722, dtype=torch.float64) tensor(-0.7716, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9088, dtype=torch.float64) delta_t tensor(0.3973, dtype=torch.float64)
15 gae_duplicate tensor(0.6950, dtype=torch.float64) tensor(-1.4439, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9090, dtype=torch.float64) delta_t tensor(0.3621, dtype=torch.float64)
14 gae_duplicate tensor(0.9182, dtype=torch.float64) tensor(-1.9074, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9092, dtype=torch.float64) delta_t tensor(0.2107, dtype=torch.float64)
13 gae_duplicate tensor(0.9452, dtype=torch.float64) tensor(-1.9636, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9095, dtype=torch.float64) delta_t tensor(0.0741, dtype=torch.float64)
12 gae_duplicate tensor(0.8303, dtype=torch.float64) tensor(-1.7316, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9097, dtype=torch.float64) delta_t tensor(0.3378, dtype=torch.float64)
11 gae_duplicate tensor(1.0020, dtype=torch.float64) tensor(-2.0816, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9099, dtype=torch.float64) delta_t tensor(0.2083, dtype=torch.float64)
10 gae_duplicate tensor(1.0099, dtype=torch.float64) tensor(-2.0939, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3196, dtype=torch.float64) delta_t tensor(-0.3405, dtype=torch.float64)
9 gae_duplicate tensor(0.4674, dtype=torch.float64) tensor(-0.9730, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0084, dtype=torch.float64) delta_t tensor(0.3915, dtype=torch.float64)
8 gae_duplicate tensor(0.7655, dtype=torch.float64) tensor(-1.5902, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3364, dtype=torch.float64) delta_t tensor(-0.5014, dtype=torch.float64)
7 gae_duplicate tensor(0.1109, dtype=torch.float64) tensor(-0.2314, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6644, dtype=torch.float64) delta_t tensor(-0.0176, dtype=torch.float64)
6 gae_duplicate tensor(0.0711, dtype=torch.float64) tensor(-0.1483, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9269, dtype=torch.float64) delta_t tensor(0.1046, dtype=torch.float64)
5 gae_duplicate tensor(0.1615, dtype=torch.float64) tensor(-0.3368, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6648, dtype=torch.float64) delta_t tensor(0.8427, dtype=torch.float64)
4 gae_duplicate tensor(0.9719, dtype=torch.float64) tensor(-2.0190, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0584, dtype=torch.float64) delta_t tensor(-0.9124, dtype=torch.float64)
3 gae_duplicate tensor(-0.1349, dtype=torch.float64) tensor(0.2803, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9931, dtype=torch.float64) delta_t tensor(0.6855, dtype=torch.float64)
2 gae_duplicate tensor(0.5775, dtype=torch.float64) tensor(-1.2045, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:80.94320678710938
value loss:14.152875900268555
entropies:37.429840087890625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.373416900634766 seconds
19 rew tensor(0.9075, dtype=torch.float64) delta_t tensor(-1.2085, dtype=torch.float64)
19 gae_duplicate tensor(-1.2085, dtype=torch.float64) tensor(2.5105, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9077, dtype=torch.float64) delta_t tensor(1.5779, dtype=torch.float64)
18 gae_duplicate tensor(0.6111, dtype=torch.float64) tensor(-1.2694, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9080, dtype=torch.float64) delta_t tensor(0.2164, dtype=torch.float64)
17 gae_duplicate tensor(0.7052, dtype=torch.float64) tensor(-1.4680, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9082, dtype=torch.float64) delta_t tensor(0.6743, dtype=torch.float64)
16 gae_duplicate tensor(1.2384, dtype=torch.float64) tensor(-2.5726, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9084, dtype=torch.float64) delta_t tensor(0.2029, dtype=torch.float64)
15 gae_duplicate tensor(1.1936, dtype=torch.float64) tensor(-2.4743, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9087, dtype=torch.float64) delta_t tensor(0.7886, dtype=torch.float64)
14 gae_duplicate tensor(1.7435, dtype=torch.float64) tensor(-3.6218, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9089, dtype=torch.float64) delta_t tensor(-0.1925, dtype=torch.float64)
13 gae_duplicate tensor(1.2024, dtype=torch.float64) tensor(-2.5029, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9091, dtype=torch.float64) delta_t tensor(0.4590, dtype=torch.float64)
12 gae_duplicate tensor(1.4209, dtype=torch.float64) tensor(-2.9516, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9094, dtype=torch.float64) delta_t tensor(0.3512, dtype=torch.float64)
11 gae_duplicate tensor(1.4880, dtype=torch.float64) tensor(-3.0909, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9096, dtype=torch.float64) delta_t tensor(1.1285, dtype=torch.float64)
10 gae_duplicate tensor(2.3189, dtype=torch.float64) tensor(-4.8270, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3846, dtype=torch.float64) delta_t tensor(1.2348, dtype=torch.float64)
9 gae_duplicate tensor(3.0899, dtype=torch.float64) tensor(-6.4186, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3374, dtype=torch.float64) delta_t tensor(-0.5316, dtype=torch.float64)
8 gae_duplicate tensor(1.9403, dtype=torch.float64) tensor(-4.0473, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4687, dtype=torch.float64) delta_t tensor(-1.6280, dtype=torch.float64)
7 gae_duplicate tensor(-0.0758, dtype=torch.float64) tensor(0.1574, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6656, dtype=torch.float64) delta_t tensor(0.1937, dtype=torch.float64)
6 gae_duplicate tensor(0.1331, dtype=torch.float64) tensor(-0.2723, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1873, dtype=torch.float64) delta_t tensor(1.2043, dtype=torch.float64)
5 gae_duplicate tensor(1.3108, dtype=torch.float64) tensor(-2.6749, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9123, dtype=torch.float64) delta_t tensor(-0.6218, dtype=torch.float64)
4 gae_duplicate tensor(0.4268, dtype=torch.float64) tensor(-0.8867, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5853, dtype=torch.float64) delta_t tensor(-0.8483, dtype=torch.float64)
3 gae_duplicate tensor(-0.5068, dtype=torch.float64) tensor(1.0549, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7327, dtype=torch.float64) delta_t tensor(-1.1602, dtype=torch.float64)
2 gae_duplicate tensor(-1.5656, dtype=torch.float64) tensor(3.2657, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:191.41592407226562
value loss:55.994144439697266
entropies:37.428470611572266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.443030118942261 seconds
19 rew tensor(0.3835, dtype=torch.float64) delta_t tensor(-1.7275, dtype=torch.float64)
19 gae_duplicate tensor(-1.7275, dtype=torch.float64) tensor(3.5803, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.0756, dtype=torch.float64) delta_t tensor(-0.8406, dtype=torch.float64)
18 gae_duplicate tensor(-2.2226, dtype=torch.float64) tensor(4.6167, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-1.0595, dtype=torch.float64) delta_t tensor(-1.0882, dtype=torch.float64)
17 gae_duplicate tensor(-2.8664, dtype=torch.float64) tensor(5.9405, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9080, dtype=torch.float64) delta_t tensor(0.5096, dtype=torch.float64)
16 gae_duplicate tensor(-1.7835, dtype=torch.float64) tensor(3.7127, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7770, dtype=torch.float64) delta_t tensor(0.1418, dtype=torch.float64)
15 gae_duplicate tensor(-1.2850, dtype=torch.float64) tensor(2.6809, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7772, dtype=torch.float64) delta_t tensor(0.3605, dtype=torch.float64)
14 gae_duplicate tensor(-0.6674, dtype=torch.float64) tensor(1.3894, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7118, dtype=torch.float64) delta_t tensor(0.6095, dtype=torch.float64)
13 gae_duplicate tensor(0.0756, dtype=torch.float64) tensor(-0.1570, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9087, dtype=torch.float64) delta_t tensor(-0.2914, dtype=torch.float64)
12 gae_duplicate tensor(-0.2309, dtype=torch.float64) tensor(0.4807, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8433, dtype=torch.float64) delta_t tensor(0.4120, dtype=torch.float64)
11 gae_duplicate tensor(0.2273, dtype=torch.float64) tensor(-0.4742, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8435, dtype=torch.float64) delta_t tensor(0.3248, dtype=torch.float64)
10 gae_duplicate tensor(0.5066, dtype=torch.float64) tensor(-1.0500, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5333, dtype=torch.float64) delta_t tensor(-1.0983, dtype=torch.float64)
9 gae_duplicate tensor(-0.6929, dtype=torch.float64) tensor(1.4425, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2547, dtype=torch.float64) delta_t tensor(-1.7486, dtype=torch.float64)
8 gae_duplicate tensor(-2.3030, dtype=torch.float64) tensor(4.7942, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9272, dtype=torch.float64) delta_t tensor(-1.2373, dtype=torch.float64)
7 gae_duplicate tensor(-3.0797, dtype=torch.float64) tensor(6.4112, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.1078, dtype=torch.float64) delta_t tensor(-2.0124, dtype=torch.float64)
6 gae_duplicate tensor(-4.4762, dtype=torch.float64) tensor(9.3184, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0597, dtype=torch.float64) delta_t tensor(0.1119, dtype=torch.float64)
5 gae_duplicate tensor(-3.4691, dtype=torch.float64) tensor(7.2379, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.2250, dtype=torch.float64) delta_t tensor(-2.4758, dtype=torch.float64)
4 gae_duplicate tensor(-5.2510, dtype=torch.float64) tensor(10.9556, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0113, dtype=torch.float64) delta_t tensor(2.1268, dtype=torch.float64)
3 gae_duplicate tensor(-2.0741, dtype=torch.float64) tensor(4.3176, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6681, dtype=torch.float64) delta_t tensor(0.4509, dtype=torch.float64)
2 gae_duplicate tensor(-1.2083, dtype=torch.float64) tensor(2.5154, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-407.4016418457031
value loss:153.68905639648438
entropies:37.42980194091797
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.468579053878784 seconds
19 rew tensor(0.9088, dtype=torch.float64) delta_t tensor(-1.6777, dtype=torch.float64)
19 gae_duplicate tensor(-1.6777, dtype=torch.float64) tensor(3.4844, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9090, dtype=torch.float64) delta_t tensor(0.8149, dtype=torch.float64)
18 gae_duplicate tensor(-0.5272, dtype=torch.float64) tensor(1.0977, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9092, dtype=torch.float64) delta_t tensor(2.2050, dtype=torch.float64)
17 gae_duplicate tensor(1.7832, dtype=torch.float64) tensor(-3.7215, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9094, dtype=torch.float64) delta_t tensor(0.8225, dtype=torch.float64)
16 gae_duplicate tensor(2.2491, dtype=torch.float64) tensor(-4.6824, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9097, dtype=torch.float64) delta_t tensor(3.7095, dtype=torch.float64)
15 gae_duplicate tensor(5.5088, dtype=torch.float64) tensor(-11.4142, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9099, dtype=torch.float64) delta_t tensor(0.4337, dtype=torch.float64)
14 gae_duplicate tensor(4.8408, dtype=torch.float64) tensor(-10.1022, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9101, dtype=torch.float64) delta_t tensor(1.4599, dtype=torch.float64)
13 gae_duplicate tensor(5.3325, dtype=torch.float64) tensor(-11.0756, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2542, dtype=torch.float64) delta_t tensor(-1.8768, dtype=torch.float64)
12 gae_duplicate tensor(2.3892, dtype=torch.float64) tensor(-4.9504, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1887, dtype=torch.float64) delta_t tensor(-1.2682, dtype=torch.float64)
11 gae_duplicate tensor(0.6432, dtype=torch.float64) tensor(-1.3359, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1887, dtype=torch.float64) delta_t tensor(0.6588, dtype=torch.float64)
10 gae_duplicate tensor(1.1733, dtype=torch.float64) tensor(-2.4370, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0736, dtype=torch.float64) delta_t tensor(-1.4320, dtype=torch.float64)
9 gae_duplicate tensor(-0.4934, dtype=torch.float64) tensor(1.0272, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2048, dtype=torch.float64) delta_t tensor(-0.2161, dtype=torch.float64)
8 gae_duplicate tensor(-0.6107, dtype=torch.float64) tensor(1.2685, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2048, dtype=torch.float64) delta_t tensor(-0.0789, dtype=torch.float64)
7 gae_duplicate tensor(-0.5675, dtype=torch.float64) tensor(1.1788, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5161, dtype=torch.float64) delta_t tensor(-0.2965, dtype=torch.float64)
6 gae_duplicate tensor(-0.7505, dtype=torch.float64) tensor(1.5663, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9922, dtype=torch.float64) delta_t tensor(-0.4140, dtype=torch.float64)
5 gae_duplicate tensor(-1.0144, dtype=torch.float64) tensor(2.1019, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8941, dtype=torch.float64) delta_t tensor(-1.5606, dtype=torch.float64)
4 gae_duplicate tensor(-2.3722, dtype=torch.float64) tensor(4.9269, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4036, dtype=torch.float64) delta_t tensor(0.5051, dtype=torch.float64)
3 gae_duplicate tensor(-1.3926, dtype=torch.float64) tensor(2.9063, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3380, dtype=torch.float64) delta_t tensor(0.1453, dtype=torch.float64)
2 gae_duplicate tensor(-0.9688, dtype=torch.float64) tensor(2.0169, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:167.743408203125
value loss:168.12071228027344
entropies:37.429779052734375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.8795)
ToM Target loss= tensor(305.8584)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.4509499073028564 seconds
19 rew tensor(0.9080, dtype=torch.float64) delta_t tensor(-2.0441, dtype=torch.float64)
19 gae_duplicate tensor(-2.0441, dtype=torch.float64) tensor(4.2561, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9082, dtype=torch.float64) delta_t tensor(0.3320, dtype=torch.float64)
18 gae_duplicate tensor(-1.3033, dtype=torch.float64) tensor(2.7205, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9084, dtype=torch.float64) delta_t tensor(0.7776, dtype=torch.float64)
17 gae_duplicate tensor(-0.2650, dtype=torch.float64) tensor(0.5533, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9087, dtype=torch.float64) delta_t tensor(0.5216, dtype=torch.float64)
16 gae_duplicate tensor(0.3096, dtype=torch.float64) tensor(-0.6430, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9089, dtype=torch.float64) delta_t tensor(0.4833, dtype=torch.float64)
15 gae_duplicate tensor(0.7310, dtype=torch.float64) tensor(-1.5182, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9091, dtype=torch.float64) delta_t tensor(0.5104, dtype=torch.float64)
14 gae_duplicate tensor(1.0952, dtype=torch.float64) tensor(-2.2804, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9094, dtype=torch.float64) delta_t tensor(0.7201, dtype=torch.float64)
13 gae_duplicate tensor(1.5963, dtype=torch.float64) tensor(-3.3322, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9096, dtype=torch.float64) delta_t tensor(0.5106, dtype=torch.float64)
12 gae_duplicate tensor(1.7876, dtype=torch.float64) tensor(-3.7030, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9098, dtype=torch.float64) delta_t tensor(-0.0449, dtype=torch.float64)
11 gae_duplicate tensor(1.3852, dtype=torch.float64) tensor(-2.8768, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9101, dtype=torch.float64) delta_t tensor(0.5027, dtype=torch.float64)
10 gae_duplicate tensor(1.6109, dtype=torch.float64) tensor(-3.3626, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6480, dtype=torch.float64) delta_t tensor(0.0480, dtype=torch.float64)
9 gae_duplicate tensor(1.3367, dtype=torch.float64) tensor(-2.7760, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1235, dtype=torch.float64) delta_t tensor(0.2932, dtype=torch.float64)
8 gae_duplicate tensor(1.3625, dtype=torch.float64) tensor(-3.2018, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4666, dtype=torch.float64) delta_t tensor(-0.9972, dtype=torch.float64)
7 gae_duplicate tensor(0.0928, dtype=torch.float64) tensor(-0.2210, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2534, dtype=torch.float64) delta_t tensor(-0.9013, dtype=torch.float64)
6 gae_duplicate tensor(-0.8270, dtype=torch.float64) tensor(1.6718, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.4341, dtype=torch.float64) delta_t tensor(-0.9025, dtype=torch.float64)
5 gae_duplicate tensor(-1.5641, dtype=torch.float64) tensor(3.1955, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6649, dtype=torch.float64) delta_t tensor(0.4753, dtype=torch.float64)
4 gae_duplicate tensor(-0.7761, dtype=torch.float64) tensor(1.7236, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0587, dtype=torch.float64) delta_t tensor(0.2747, dtype=torch.float64)
3 gae_duplicate tensor(-0.3461, dtype=torch.float64) tensor(0.7188, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-2.2399, dtype=torch.float64) delta_t tensor(-0.9141, dtype=torch.float64)
2 gae_duplicate tensor(-1.1910, dtype=torch.float64) tensor(2.4736, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:38.48869705200195
value loss:40.435699462890625
entropies:37.35576248168945
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.46138596534729 seconds
19 rew tensor(0.9069, dtype=torch.float64) delta_t tensor(-1.7150, dtype=torch.float64)
19 gae_duplicate tensor(-1.7150, dtype=torch.float64) tensor(3.5710, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9072, dtype=torch.float64) delta_t tensor(0.4062, dtype=torch.float64)
18 gae_duplicate tensor(-0.9658, dtype=torch.float64) tensor(2.0057, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9074, dtype=torch.float64) delta_t tensor(0.6557, dtype=torch.float64)
17 gae_duplicate tensor(-0.1170, dtype=torch.float64) tensor(0.2442, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9076, dtype=torch.float64) delta_t tensor(0.4477, dtype=torch.float64)
16 gae_duplicate tensor(0.3541, dtype=torch.float64) tensor(-0.7334, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9079, dtype=torch.float64) delta_t tensor(0.2259, dtype=torch.float64)
15 gae_duplicate tensor(0.5092, dtype=torch.float64) tensor(-1.0603, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9081, dtype=torch.float64) delta_t tensor(0.4597, dtype=torch.float64)
14 gae_duplicate tensor(0.8671, dtype=torch.float64) tensor(-1.8006, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9083, dtype=torch.float64) delta_t tensor(0.5267, dtype=torch.float64)
13 gae_duplicate tensor(1.2204, dtype=torch.float64) tensor(-2.5410, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9085, dtype=torch.float64) delta_t tensor(2.9660, dtype=torch.float64)
12 gae_duplicate tensor(3.9423, dtype=torch.float64) tensor(-8.2088, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9088, dtype=torch.float64) delta_t tensor(-1.8506, dtype=torch.float64)
11 gae_duplicate tensor(1.3032, dtype=torch.float64) tensor(-2.6952, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9090, dtype=torch.float64) delta_t tensor(1.1095, dtype=torch.float64)
10 gae_duplicate tensor(2.1521, dtype=torch.float64) tensor(-4.4868, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9092, dtype=torch.float64) delta_t tensor(-0.8386, dtype=torch.float64)
9 gae_duplicate tensor(0.8830, dtype=torch.float64) tensor(-1.8348, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0079, dtype=torch.float64) delta_t tensor(-0.3610, dtype=torch.float64)
8 gae_duplicate tensor(0.3454, dtype=torch.float64) tensor(-0.7192, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1217, dtype=torch.float64) delta_t tensor(-0.2561, dtype=torch.float64)
7 gae_duplicate tensor(0.0202, dtype=torch.float64) tensor(-0.0421, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3186, dtype=torch.float64) delta_t tensor(-0.7625, dtype=torch.float64)
6 gae_duplicate tensor(-0.7463, dtype=torch.float64) tensor(1.6807, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.5641, dtype=torch.float64) delta_t tensor(-2.1126, dtype=torch.float64)
5 gae_duplicate tensor(-2.7096, dtype=torch.float64) tensor(5.6271, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0422, dtype=torch.float64) delta_t tensor(-1.2796, dtype=torch.float64)
4 gae_duplicate tensor(-3.4473, dtype=torch.float64) tensor(7.1780, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.6462, dtype=torch.float64) delta_t tensor(2.1807, dtype=torch.float64)
3 gae_duplicate tensor(-0.5772, dtype=torch.float64) tensor(1.2892, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5185, dtype=torch.float64) delta_t tensor(-0.3959, dtype=torch.float64)
2 gae_duplicate tensor(-0.8577, dtype=torch.float64) tensor(1.7764, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3.3769631385803223
value loss:75.20428466796875
entropies:37.40742111206055
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.3707451820373535 seconds
19 rew tensor(-0.3379, dtype=torch.float64) delta_t tensor(-2.2688, dtype=torch.float64)
19 gae_duplicate tensor(-2.2688, dtype=torch.float64) tensor(4.7242, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-1.4522, dtype=torch.float64) delta_t tensor(0.1133, dtype=torch.float64)
18 gae_duplicate tensor(-1.7017, dtype=torch.float64) tensor(3.5338, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9071, dtype=torch.float64) delta_t tensor(0.9112, dtype=torch.float64)
17 gae_duplicate tensor(-0.4501, dtype=torch.float64) tensor(0.9373, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9073, dtype=torch.float64) delta_t tensor(0.9115, dtype=torch.float64)
16 gae_duplicate tensor(0.5514, dtype=torch.float64) tensor(-1.1481, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9075, dtype=torch.float64) delta_t tensor(0.4772, dtype=torch.float64)
15 gae_duplicate tensor(0.9183, dtype=torch.float64) tensor(-1.9070, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8422, dtype=torch.float64) delta_t tensor(0.8592, dtype=torch.float64)
14 gae_duplicate tensor(1.5939, dtype=torch.float64) tensor(-3.3189, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8424, dtype=torch.float64) delta_t tensor(-0.8919, dtype=torch.float64)
13 gae_duplicate tensor(0.3832, dtype=torch.float64) tensor(-0.7980, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7771, dtype=torch.float64) delta_t tensor(0.4066, dtype=torch.float64)
12 gae_duplicate tensor(0.7131, dtype=torch.float64) tensor(-1.4890, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9083, dtype=torch.float64) delta_t tensor(0.5165, dtype=torch.float64)
11 gae_duplicate tensor(1.0870, dtype=torch.float64) tensor(-2.2574, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8430, dtype=torch.float64) delta_t tensor(0.0411, dtype=torch.float64)
10 gae_duplicate tensor(0.9107, dtype=torch.float64) tensor(-1.8913, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5330, dtype=torch.float64) delta_t tensor(-0.5164, dtype=torch.float64)
9 gae_duplicate tensor(0.2122, dtype=torch.float64) tensor(-0.4419, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5331, dtype=torch.float64) delta_t tensor(-0.6888, dtype=torch.float64)
8 gae_duplicate tensor(-0.5190, dtype=torch.float64) tensor(1.0778, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6643, dtype=torch.float64) delta_t tensor(-0.8433, dtype=torch.float64)
7 gae_duplicate tensor(-1.2585, dtype=torch.float64) tensor(2.6206, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3368, dtype=torch.float64) delta_t tensor(-0.1493, dtype=torch.float64)
6 gae_duplicate tensor(-1.1562, dtype=torch.float64) tensor(2.4075, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.3021, dtype=torch.float64) delta_t tensor(-0.8572, dtype=torch.float64)
5 gae_duplicate tensor(-1.7822, dtype=torch.float64) tensor(3.6909, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1075, dtype=torch.float64) delta_t tensor(-0.2807, dtype=torch.float64)
4 gae_duplicate tensor(-1.7065, dtype=torch.float64) tensor(3.5533, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0761, dtype=torch.float64) delta_t tensor(1.0756, dtype=torch.float64)
3 gae_duplicate tensor(-0.2896, dtype=torch.float64) tensor(0.6030, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0761, dtype=torch.float64) delta_t tensor(0.6764, dtype=torch.float64)
2 gae_duplicate tensor(0.4447, dtype=torch.float64) tensor(-0.9261, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-54.946773529052734
value loss:36.307464599609375
entropies:37.42973327636719
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.675380229949951 seconds
19 rew tensor(-0.1414, dtype=torch.float64) delta_t tensor(-1.3684, dtype=torch.float64)
19 gae_duplicate tensor(-1.3684, dtype=torch.float64) tensor(2.8496, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-1.0596, dtype=torch.float64) delta_t tensor(0.1516, dtype=torch.float64)
18 gae_duplicate tensor(-0.9431, dtype=torch.float64) tensor(1.9585, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8420, dtype=torch.float64) delta_t tensor(1.0360, dtype=torch.float64)
17 gae_duplicate tensor(0.2815, dtype=torch.float64) tensor(-0.5845, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9078, dtype=torch.float64) delta_t tensor(0.2728, dtype=torch.float64)
16 gae_duplicate tensor(0.4979, dtype=torch.float64) tensor(-1.0397, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8424, dtype=torch.float64) delta_t tensor(1.0127, dtype=torch.float64)
15 gae_duplicate tensor(1.4110, dtype=torch.float64) tensor(-2.9464, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8426, dtype=torch.float64) delta_t tensor(0.9282, dtype=torch.float64)
14 gae_duplicate tensor(2.0570, dtype=torch.float64) tensor(-4.2715, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8428, dtype=torch.float64) delta_t tensor(-0.5180, dtype=torch.float64)
13 gae_duplicate tensor(1.1276, dtype=torch.float64) tensor(-2.3351, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7119, dtype=torch.float64) delta_t tensor(0.4884, dtype=torch.float64)
12 gae_duplicate tensor(1.3905, dtype=torch.float64) tensor(-2.8955, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9087, dtype=torch.float64) delta_t tensor(0.7056, dtype=torch.float64)
11 gae_duplicate tensor(1.8180, dtype=torch.float64) tensor(-3.7856, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8434, dtype=torch.float64) delta_t tensor(0.1617, dtype=torch.float64)
10 gae_duplicate tensor(1.6161, dtype=torch.float64) tensor(-3.3471, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4677, dtype=torch.float64) delta_t tensor(-0.8438, dtype=torch.float64)
9 gae_duplicate tensor(0.4490, dtype=torch.float64) tensor(-0.9282, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5333, dtype=torch.float64) delta_t tensor(-0.8121, dtype=torch.float64)
8 gae_duplicate tensor(-0.4529, dtype=torch.float64) tensor(0.9405, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7120, dtype=torch.float64) delta_t tensor(0.2821, dtype=torch.float64)
7 gae_duplicate tensor(-0.0802, dtype=torch.float64) tensor(0.1660, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9265, dtype=torch.float64) delta_t tensor(-0.5059, dtype=torch.float64)
6 gae_duplicate tensor(-0.5700, dtype=torch.float64) tensor(1.1837, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4510, dtype=torch.float64) delta_t tensor(0.6528, dtype=torch.float64)
5 gae_duplicate tensor(0.1968, dtype=torch.float64) tensor(-0.4076, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1072, dtype=torch.float64) delta_t tensor(-1.6353, dtype=torch.float64)
4 gae_duplicate tensor(-1.4779, dtype=torch.float64) tensor(3.0689, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0100, dtype=torch.float64) delta_t tensor(1.1526, dtype=torch.float64)
3 gae_duplicate tensor(-0.0298, dtype=torch.float64) tensor(0.0620, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1412, dtype=torch.float64) delta_t tensor(1.0352, dtype=torch.float64)
2 gae_duplicate tensor(1.0114, dtype=torch.float64) tensor(-2.1118, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:85.42005920410156
value loss:33.627197265625
entropies:37.42961502075195
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.236897945404053 seconds
19 rew tensor(0.9073, dtype=torch.float64) delta_t tensor(-0.2142, dtype=torch.float64)
19 gae_duplicate tensor(-0.2142, dtype=torch.float64) tensor(0.4461, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9075, dtype=torch.float64) delta_t tensor(0.1813, dtype=torch.float64)
18 gae_duplicate tensor(0.0099, dtype=torch.float64) tensor(-0.0206, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9078, dtype=torch.float64) delta_t tensor(0.5378, dtype=torch.float64)
17 gae_duplicate tensor(0.5457, dtype=torch.float64) tensor(-1.1331, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9080, dtype=torch.float64) delta_t tensor(0.5742, dtype=torch.float64)
16 gae_duplicate tensor(1.0108, dtype=torch.float64) tensor(-2.0989, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9082, dtype=torch.float64) delta_t tensor(0.5745, dtype=torch.float64)
15 gae_duplicate tensor(1.3831, dtype=torch.float64) tensor(-2.8719, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9084, dtype=torch.float64) delta_t tensor(0.2806, dtype=torch.float64)
14 gae_duplicate tensor(1.3871, dtype=torch.float64) tensor(-2.8719, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9087, dtype=torch.float64) delta_t tensor(0.2620, dtype=torch.float64)
13 gae_duplicate tensor(1.3717, dtype=torch.float64) tensor(-2.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9089, dtype=torch.float64) delta_t tensor(0.4744, dtype=torch.float64)
12 gae_duplicate tensor(1.5717, dtype=torch.float64) tensor(-3.2824, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9091, dtype=torch.float64) delta_t tensor(0.4675, dtype=torch.float64)
11 gae_duplicate tensor(1.7249, dtype=torch.float64) tensor(-3.5816, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9093, dtype=torch.float64) delta_t tensor(0.4677, dtype=torch.float64)
10 gae_duplicate tensor(1.8476, dtype=torch.float64) tensor(-3.8365, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9096, dtype=torch.float64) delta_t tensor(0.4638, dtype=torch.float64)
9 gae_duplicate tensor(1.9419, dtype=torch.float64) tensor(-4.0554, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5317, dtype=torch.float64) delta_t tensor(-1.0552, dtype=torch.float64)
8 gae_duplicate tensor(0.4983, dtype=torch.float64) tensor(-1.0346, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2524, dtype=torch.float64) delta_t tensor(-1.2886, dtype=torch.float64)
7 gae_duplicate tensor(-0.8900, dtype=torch.float64) tensor(1.8480, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0563, dtype=torch.float64) delta_t tensor(-0.2591, dtype=torch.float64)
6 gae_duplicate tensor(-0.9710, dtype=torch.float64) tensor(2.0221, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5808, dtype=torch.float64) delta_t tensor(-0.5801, dtype=torch.float64)
5 gae_duplicate tensor(-1.3569, dtype=torch.float64) tensor(2.8176, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1543, dtype=torch.float64) delta_t tensor(-1.5120, dtype=torch.float64)
4 gae_duplicate tensor(-2.5976, dtype=torch.float64) tensor(5.3795, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6001, dtype=torch.float64) delta_t tensor(0.0192, dtype=torch.float64)
3 gae_duplicate tensor(-2.0588, dtype=torch.float64) tensor(4.2997, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5346, dtype=torch.float64) delta_t tensor(0.5613, dtype=torch.float64)
2 gae_duplicate tensor(-1.0858, dtype=torch.float64) tensor(2.2612, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:50.34067916870117
value loss:53.55488586425781
entropies:37.42967224121094
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.1369)
ToM Target loss= tensor(307.0085)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.420659303665161 seconds
19 rew tensor(-1.1889, dtype=torch.float64) delta_t tensor(-2.1845, dtype=torch.float64)
19 gae_duplicate tensor(-2.1845, dtype=torch.float64) tensor(4.5228, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9069, dtype=torch.float64) delta_t tensor(0.6232, dtype=torch.float64)
18 gae_duplicate tensor(-1.1244, dtype=torch.float64) tensor(2.3280, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8416, dtype=torch.float64) delta_t tensor(0.4477, dtype=torch.float64)
17 gae_duplicate tensor(-0.4519, dtype=torch.float64) tensor(0.9410, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8418, dtype=torch.float64) delta_t tensor(0.2590, dtype=torch.float64)
16 gae_duplicate tensor(-0.1025, dtype=torch.float64) tensor(0.2128, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7765, dtype=torch.float64) delta_t tensor(0.5137, dtype=torch.float64)
15 gae_duplicate tensor(0.4317, dtype=torch.float64) tensor(-0.8964, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8421, dtype=torch.float64) delta_t tensor(0.1210, dtype=torch.float64)
14 gae_duplicate tensor(0.4664, dtype=torch.float64) tensor(-0.9684, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7113, dtype=torch.float64) delta_t tensor(0.3108, dtype=torch.float64)
13 gae_duplicate tensor(0.6839, dtype=torch.float64) tensor(-1.4242, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6460, dtype=torch.float64) delta_t tensor(0.2108, dtype=torch.float64)
12 gae_duplicate tensor(0.7580, dtype=torch.float64) tensor(-1.5739, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9081, dtype=torch.float64) delta_t tensor(0.5075, dtype=torch.float64)
11 gae_duplicate tensor(1.1139, dtype=torch.float64) tensor(-2.3063, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7773, dtype=torch.float64) delta_t tensor(0.4446, dtype=torch.float64)
10 gae_duplicate tensor(1.3357, dtype=torch.float64) tensor(-2.7655, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5156, dtype=torch.float64) delta_t tensor(1.0704, dtype=torch.float64)
9 gae_duplicate tensor(2.1390, dtype=torch.float64) tensor(-4.4673, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0081, dtype=torch.float64) delta_t tensor(0.1151, dtype=torch.float64)
8 gae_duplicate tensor(1.8263, dtype=torch.float64) tensor(-4.1521, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3847, dtype=torch.float64) delta_t tensor(-0.5153, dtype=torch.float64)
7 gae_duplicate tensor(0.9458, dtype=torch.float64) tensor(-2.2944, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.1026, dtype=torch.float64) delta_t tensor(-0.9096, dtype=torch.float64)
6 gae_duplicate tensor(-0.1529, dtype=torch.float64) tensor(0.3185, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.3006, dtype=torch.float64) delta_t tensor(-1.6373, dtype=torch.float64)
5 gae_duplicate tensor(-1.7596, dtype=torch.float64) tensor(3.5645, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9266, dtype=torch.float64) delta_t tensor(0.6837, dtype=torch.float64)
4 gae_duplicate tensor(-0.7241, dtype=torch.float64) tensor(1.4434, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.3683, dtype=torch.float64) delta_t tensor(-1.5000, dtype=torch.float64)
3 gae_duplicate tensor(-2.0792, dtype=torch.float64) tensor(4.3299, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1412, dtype=torch.float64) delta_t tensor(0.2504, dtype=torch.float64)
2 gae_duplicate tensor(-1.4130, dtype=torch.float64) tensor(2.9510, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:0.2978682518005371
value loss:44.236480712890625
entropies:37.36402130126953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.3124001026153564 seconds
19 rew tensor(0.7119, dtype=torch.float64) delta_t tensor(-1.1758, dtype=torch.float64)
19 gae_duplicate tensor(-1.1758, dtype=torch.float64) tensor(2.4415, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3843, dtype=torch.float64) delta_t tensor(0.1171, dtype=torch.float64)
18 gae_duplicate tensor(-0.8235, dtype=torch.float64) tensor(1.7100, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0090, dtype=torch.float64) delta_t tensor(-0.3688, dtype=torch.float64)
17 gae_duplicate tensor(-1.0277, dtype=torch.float64) tensor(2.1278, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.9266, dtype=torch.float64) delta_t tensor(-1.1138, dtype=torch.float64)
16 gae_duplicate tensor(-1.9360, dtype=torch.float64) tensor(4.0315, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8428, dtype=torch.float64) delta_t tensor(0.6018, dtype=torch.float64)
15 gae_duplicate tensor(-0.9470, dtype=torch.float64) tensor(1.9607, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7775, dtype=torch.float64) delta_t tensor(0.6672, dtype=torch.float64)
14 gae_duplicate tensor(-0.0904, dtype=torch.float64) tensor(0.1883, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5810, dtype=torch.float64) delta_t tensor(0.8347, dtype=torch.float64)
13 gae_duplicate tensor(0.7624, dtype=torch.float64) tensor(-1.5831, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8432, dtype=torch.float64) delta_t tensor(-0.3264, dtype=torch.float64)
12 gae_duplicate tensor(0.2835, dtype=torch.float64) tensor(-0.5903, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8434, dtype=torch.float64) delta_t tensor(-0.0358, dtype=torch.float64)
11 gae_duplicate tensor(0.1910, dtype=torch.float64) tensor(-0.3977, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7126, dtype=torch.float64) delta_t tensor(0.2147, dtype=torch.float64)
10 gae_duplicate tensor(0.3675, dtype=torch.float64) tensor(-0.7674, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7287, dtype=torch.float64) delta_t tensor(-1.1306, dtype=torch.float64)
9 gae_duplicate tensor(-0.8367, dtype=torch.float64) tensor(1.7423, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5159, dtype=torch.float64) delta_t tensor(0.7024, dtype=torch.float64)
8 gae_duplicate tensor(0.0331, dtype=torch.float64) tensor(-0.0686, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1217, dtype=torch.float64) delta_t tensor(-0.8326, dtype=torch.float64)
7 gae_duplicate tensor(-0.8062, dtype=torch.float64) tensor(1.6788, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5806, dtype=torch.float64) delta_t tensor(-2.0213, dtype=torch.float64)
6 gae_duplicate tensor(-2.6662, dtype=torch.float64) tensor(5.5204, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9916, dtype=torch.float64) delta_t tensor(0.8591, dtype=torch.float64)
5 gae_duplicate tensor(-1.2739, dtype=torch.float64) tensor(2.6160, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1885, dtype=torch.float64) delta_t tensor(0.2105, dtype=torch.float64)
4 gae_duplicate tensor(-0.8086, dtype=torch.float64) tensor(1.6590, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4025, dtype=torch.float64) delta_t tensor(-0.1939, dtype=torch.float64)
3 gae_duplicate tensor(-0.8408, dtype=torch.float64) tensor(1.7458, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5336, dtype=torch.float64) delta_t tensor(1.2842, dtype=torch.float64)
2 gae_duplicate tensor(0.6116, dtype=torch.float64) tensor(-1.2700, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-137.59371948242188
value loss:30.629810333251953
entropies:37.42892074584961
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.519971132278442 seconds
19 rew tensor(0.9093, dtype=torch.float64) delta_t tensor(-1.3207, dtype=torch.float64)
19 gae_duplicate tensor(-1.3207, dtype=torch.float64) tensor(2.7577, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9095, dtype=torch.float64) delta_t tensor(0.4429, dtype=torch.float64)
18 gae_duplicate tensor(-0.6136, dtype=torch.float64) tensor(1.2777, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9097, dtype=torch.float64) delta_t tensor(0.9151, dtype=torch.float64)
17 gae_duplicate tensor(0.4242, dtype=torch.float64) tensor(-0.8809, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9099, dtype=torch.float64) delta_t tensor(0.4984, dtype=torch.float64)
16 gae_duplicate tensor(0.8377, dtype=torch.float64) tensor(-1.7396, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9101, dtype=torch.float64) delta_t tensor(0.2371, dtype=torch.float64)
15 gae_duplicate tensor(0.9073, dtype=torch.float64) tensor(-1.8946, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9104, dtype=torch.float64) delta_t tensor(0.7102, dtype=torch.float64)
14 gae_duplicate tensor(1.4361, dtype=torch.float64) tensor(-2.9821, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9106, dtype=torch.float64) delta_t tensor(3.0138, dtype=torch.float64)
13 gae_duplicate tensor(4.1627, dtype=torch.float64) tensor(-8.6681, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0576, dtype=torch.float64) delta_t tensor(0.3843, dtype=torch.float64)
12 gae_duplicate tensor(3.7144, dtype=torch.float64) tensor(-7.7347, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1393, dtype=torch.float64) delta_t tensor(-3.2321, dtype=torch.float64)
11 gae_duplicate tensor(-0.2605, dtype=torch.float64) tensor(0.5410, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.9924, dtype=torch.float64) delta_t tensor(-1.4659, dtype=torch.float64)
10 gae_duplicate tensor(-1.6743, dtype=torch.float64) tensor(3.4865, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1885, dtype=torch.float64) delta_t tensor(0.7637, dtype=torch.float64)
9 gae_duplicate tensor(-0.5757, dtype=torch.float64) tensor(1.1199, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2051, dtype=torch.float64) delta_t tensor(-0.6542, dtype=torch.float64)
8 gae_duplicate tensor(-1.1148, dtype=torch.float64) tensor(2.5014, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3364, dtype=torch.float64) delta_t tensor(-0.4372, dtype=torch.float64)
7 gae_duplicate tensor(-1.3290, dtype=torch.float64) tensor(2.4782, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1235, dtype=torch.float64) delta_t tensor(-0.1316, dtype=torch.float64)
6 gae_duplicate tensor(-1.1947, dtype=torch.float64) tensor(2.7698, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4504, dtype=torch.float64) delta_t tensor(2.2327, dtype=torch.float64)
5 gae_duplicate tensor(1.2769, dtype=torch.float64) tensor(-2.8768, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7301, dtype=torch.float64) delta_t tensor(-0.4117, dtype=torch.float64)
4 gae_duplicate tensor(0.6099, dtype=torch.float64) tensor(-1.4682, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3847, dtype=torch.float64) delta_t tensor(0.7516, dtype=torch.float64)
3 gae_duplicate tensor(1.2395, dtype=torch.float64) tensor(-2.2646, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6645, dtype=torch.float64) delta_t tensor(0.9034, dtype=torch.float64)
2 gae_duplicate tensor(1.8950, dtype=torch.float64) tensor(-3.6970, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:102.52824401855469
value loss:77.67191314697266
entropies:37.257286071777344
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.593128204345703 seconds
19 rew tensor(0.9081, dtype=torch.float64) delta_t tensor(-0.5059, dtype=torch.float64)
19 gae_duplicate tensor(-0.5059, dtype=torch.float64) tensor(1.0564, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9083, dtype=torch.float64) delta_t tensor(0.6861, dtype=torch.float64)
18 gae_duplicate tensor(0.2813, dtype=torch.float64) tensor(-0.5842, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9085, dtype=torch.float64) delta_t tensor(0.6378, dtype=torch.float64)
17 gae_duplicate tensor(0.8629, dtype=torch.float64) tensor(-1.7968, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9088, dtype=torch.float64) delta_t tensor(0.7336, dtype=torch.float64)
16 gae_duplicate tensor(1.4239, dtype=torch.float64) tensor(-2.9650, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9090, dtype=torch.float64) delta_t tensor(-0.0051, dtype=torch.float64)
15 gae_duplicate tensor(1.1340, dtype=torch.float64) tensor(-2.3548, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9092, dtype=torch.float64) delta_t tensor(0.5200, dtype=torch.float64)
14 gae_duplicate tensor(1.4272, dtype=torch.float64) tensor(-2.9718, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9094, dtype=torch.float64) delta_t tensor(0.0588, dtype=torch.float64)
13 gae_duplicate tensor(1.2006, dtype=torch.float64) tensor(-2.4999, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9096, dtype=torch.float64) delta_t tensor(0.6695, dtype=torch.float64)
12 gae_duplicate tensor(1.6300, dtype=torch.float64) tensor(-3.3941, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9099, dtype=torch.float64) delta_t tensor(0.4793, dtype=torch.float64)
11 gae_duplicate tensor(1.7832, dtype=torch.float64) tensor(-3.7031, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7790, dtype=torch.float64) delta_t tensor(0.2600, dtype=torch.float64)
10 gae_duplicate tensor(1.6866, dtype=torch.float64) tensor(-3.5120, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7278, dtype=torch.float64) delta_t tensor(-1.3541, dtype=torch.float64)
9 gae_duplicate tensor(-0.0048, dtype=torch.float64) tensor(0.0100, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.5141, dtype=torch.float64) delta_t tensor(-1.0353, dtype=torch.float64)
8 gae_duplicate tensor(-1.0391, dtype=torch.float64) tensor(2.1579, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0561, dtype=torch.float64) delta_t tensor(-1.0397, dtype=torch.float64)
7 gae_duplicate tensor(-1.8711, dtype=torch.float64) tensor(3.8961, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5977, dtype=torch.float64) delta_t tensor(-0.2550, dtype=torch.float64)
6 gae_duplicate tensor(-1.7518, dtype=torch.float64) tensor(3.6378, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9909, dtype=torch.float64) delta_t tensor(1.4482, dtype=torch.float64)
5 gae_duplicate tensor(0.0467, dtype=torch.float64) tensor(-0.0971, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.3329, dtype=torch.float64) delta_t tensor(-2.8703, dtype=torch.float64)
4 gae_duplicate tensor(-2.8329, dtype=torch.float64) tensor(5.8988, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2066, dtype=torch.float64) delta_t tensor(0.9640, dtype=torch.float64)
3 gae_duplicate tensor(-1.3023, dtype=torch.float64) tensor(2.7118, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2723, dtype=torch.float64) delta_t tensor(0.2361, dtype=torch.float64)
2 gae_duplicate tensor(-0.8058, dtype=torch.float64) tensor(1.6733, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:15.89693546295166
value loss:51.862388610839844
entropies:37.42972946166992
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.337465763092041 seconds
19 rew tensor(0.6470, dtype=torch.float64) delta_t tensor(-1.0414, dtype=torch.float64)
19 gae_duplicate tensor(-1.0414, dtype=torch.float64) tensor(2.1626, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3847, dtype=torch.float64) delta_t tensor(-0.1210, dtype=torch.float64)
18 gae_duplicate tensor(-0.9541, dtype=torch.float64) tensor(1.9814, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0746, dtype=torch.float64) delta_t tensor(0.3460, dtype=torch.float64)
17 gae_duplicate tensor(-0.4173, dtype=torch.float64) tensor(0.8666, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5815, dtype=torch.float64) delta_t tensor(0.8359, dtype=torch.float64)
16 gae_duplicate tensor(0.5021, dtype=torch.float64) tensor(-1.0455, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4504, dtype=torch.float64) delta_t tensor(0.3874, dtype=torch.float64)
15 gae_duplicate tensor(0.7890, dtype=torch.float64) tensor(-1.6341, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.1399, dtype=torch.float64) delta_t tensor(0.2982, dtype=torch.float64)
14 gae_duplicate tensor(0.9295, dtype=torch.float64) tensor(-1.9407, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9094, dtype=torch.float64) delta_t tensor(0.9105, dtype=torch.float64)
13 gae_duplicate tensor(1.6541, dtype=torch.float64) tensor(-3.4350, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9097, dtype=torch.float64) delta_t tensor(-0.8937, dtype=torch.float64)
12 gae_duplicate tensor(0.4296, dtype=torch.float64) tensor(-0.8921, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8443, dtype=torch.float64) delta_t tensor(0.6561, dtype=torch.float64)
11 gae_duplicate tensor(0.9998, dtype=torch.float64) tensor(-2.0819, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8445, dtype=torch.float64) delta_t tensor(1.0951, dtype=torch.float64)
10 gae_duplicate tensor(1.8950, dtype=torch.float64) tensor(-3.9245, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5980, dtype=torch.float64) delta_t tensor(-1.6677, dtype=torch.float64)
9 gae_duplicate tensor(-0.1517, dtype=torch.float64) tensor(0.3174, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6637, dtype=torch.float64) delta_t tensor(-0.9747, dtype=torch.float64)
8 gae_duplicate tensor(-1.0961, dtype=torch.float64) tensor(2.2858, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8605, dtype=torch.float64) delta_t tensor(-0.6362, dtype=torch.float64)
7 gae_duplicate tensor(-1.5131, dtype=torch.float64) tensor(3.1421, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3852, dtype=torch.float64) delta_t tensor(-0.2798, dtype=torch.float64)
6 gae_duplicate tensor(-1.4903, dtype=torch.float64) tensor(3.0865, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1880, dtype=torch.float64) delta_t tensor(1.1201, dtype=torch.float64)
5 gae_duplicate tensor(-0.0722, dtype=torch.float64) tensor(0.1494, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0087, dtype=torch.float64) delta_t tensor(1.1812, dtype=torch.float64)
4 gae_duplicate tensor(1.1234, dtype=torch.float64) tensor(-2.3267, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8609, dtype=torch.float64) delta_t tensor(0.0532, dtype=torch.float64)
3 gae_duplicate tensor(0.9520, dtype=torch.float64) tensor(-1.9823, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6644, dtype=torch.float64) delta_t tensor(-0.6052, dtype=torch.float64)
2 gae_duplicate tensor(0.1564, dtype=torch.float64) tensor(-0.3239, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:32.446712493896484
value loss:29.028076171875
entropies:37.42965316772461
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.6543)
ToM Target loss= tensor(307.0599)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.402145147323608 seconds
19 rew tensor(0.9089, dtype=torch.float64) delta_t tensor(-1.1844, dtype=torch.float64)
19 gae_duplicate tensor(-1.1844, dtype=torch.float64) tensor(2.4663, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9091, dtype=torch.float64) delta_t tensor(0.4724, dtype=torch.float64)
18 gae_duplicate tensor(-0.4751, dtype=torch.float64) tensor(0.9919, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9094, dtype=torch.float64) delta_t tensor(0.4871, dtype=torch.float64)
17 gae_duplicate tensor(0.1070, dtype=torch.float64) tensor(-0.2223, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9096, dtype=torch.float64) delta_t tensor(0.2814, dtype=torch.float64)
16 gae_duplicate tensor(0.3671, dtype=torch.float64) tensor(-0.7664, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9098, dtype=torch.float64) delta_t tensor(0.7324, dtype=torch.float64)
15 gae_duplicate tensor(1.0260, dtype=torch.float64) tensor(-2.1365, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9100, dtype=torch.float64) delta_t tensor(0.4929, dtype=torch.float64)
14 gae_duplicate tensor(1.3138, dtype=torch.float64) tensor(-2.7282, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9102, dtype=torch.float64) delta_t tensor(0.3888, dtype=torch.float64)
13 gae_duplicate tensor(1.4398, dtype=torch.float64) tensor(-2.9981, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9104, dtype=torch.float64) delta_t tensor(0.3871, dtype=torch.float64)
12 gae_duplicate tensor(1.5390, dtype=torch.float64) tensor(-3.2046, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9107, dtype=torch.float64) delta_t tensor(0.2558, dtype=torch.float64)
11 gae_duplicate tensor(1.4870, dtype=torch.float64) tensor(-3.0880, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9109, dtype=torch.float64) delta_t tensor(0.5413, dtype=torch.float64)
10 gae_duplicate tensor(1.7309, dtype=torch.float64) tensor(-3.5944, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6487, dtype=torch.float64) delta_t tensor(0.2467, dtype=torch.float64)
9 gae_duplicate tensor(1.6314, dtype=torch.float64) tensor(-3.3785, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3207, dtype=torch.float64) delta_t tensor(-0.3577, dtype=torch.float64)
8 gae_duplicate tensor(0.9474, dtype=torch.float64) tensor(-1.9620, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0584, dtype=torch.float64) delta_t tensor(1.2901, dtype=torch.float64)
7 gae_duplicate tensor(2.0480, dtype=torch.float64) tensor(-4.2646, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9254, dtype=torch.float64) delta_t tensor(-0.3704, dtype=torch.float64)
6 gae_duplicate tensor(1.2680, dtype=torch.float64) tensor(-2.6476, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4665, dtype=torch.float64) delta_t tensor(0.5696, dtype=torch.float64)
5 gae_duplicate tensor(1.5840, dtype=torch.float64) tensor(-3.2062, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9094, dtype=torch.float64) delta_t tensor(-0.6722, dtype=torch.float64)
4 gae_duplicate tensor(0.5950, dtype=torch.float64) tensor(-1.2389, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8450, dtype=torch.float64) delta_t tensor(-1.0900, dtype=torch.float64)
3 gae_duplicate tensor(-0.6140, dtype=torch.float64) tensor(1.2786, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5836, dtype=torch.float64) delta_t tensor(-0.7460, dtype=torch.float64)
2 gae_duplicate tensor(-1.2372, dtype=torch.float64) tensor(2.5762, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:167.61746215820312
value loss:42.50169372558594
entropies:37.42775344848633
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.339298963546753 seconds
19 rew tensor(0.7130, dtype=torch.float64) delta_t tensor(-0.9886, dtype=torch.float64)
19 gae_duplicate tensor(-0.9886, dtype=torch.float64) tensor(2.0471, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7132, dtype=torch.float64) delta_t tensor(0.3911, dtype=torch.float64)
18 gae_duplicate tensor(-0.3998, dtype=torch.float64) tensor(0.8326, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3849, dtype=torch.float64) delta_t tensor(0.0782, dtype=torch.float64)
17 gae_duplicate tensor(-0.2417, dtype=torch.float64) tensor(0.5005, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0567, dtype=torch.float64) delta_t tensor(-0.4867, dtype=torch.float64)
16 gae_duplicate tensor(-0.6800, dtype=torch.float64) tensor(1.4161, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.8624, dtype=torch.float64) delta_t tensor(-1.0183, dtype=torch.float64)
15 gae_duplicate tensor(-1.5623, dtype=torch.float64) tensor(3.2625, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8443, dtype=torch.float64) delta_t tensor(0.5415, dtype=torch.float64)
14 gae_duplicate tensor(-0.7083, dtype=torch.float64) tensor(1.4792, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9101, dtype=torch.float64) delta_t tensor(0.5858, dtype=torch.float64)
13 gae_duplicate tensor(0.0191, dtype=torch.float64) tensor(-0.0397, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9103, dtype=torch.float64) delta_t tensor(1.9995, dtype=torch.float64)
12 gae_duplicate tensor(2.0148, dtype=torch.float64) tensor(-4.1837, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7136, dtype=torch.float64) delta_t tensor(0.8822, dtype=torch.float64)
11 gae_duplicate tensor(2.4940, dtype=torch.float64) tensor(-5.1936, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5825, dtype=torch.float64) delta_t tensor(-1.2607, dtype=torch.float64)
10 gae_duplicate tensor(0.7345, dtype=torch.float64) tensor(-1.5295, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2050, dtype=torch.float64) delta_t tensor(-0.5031, dtype=torch.float64)
9 gae_duplicate tensor(0.0845, dtype=torch.float64) tensor(-0.1754, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3856, dtype=torch.float64) delta_t tensor(0.2147, dtype=torch.float64)
8 gae_duplicate tensor(0.2822, dtype=torch.float64) tensor(-0.5877, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1236, dtype=torch.float64) delta_t tensor(-0.5737, dtype=torch.float64)
7 gae_duplicate tensor(-0.3479, dtype=torch.float64) tensor(0.7225, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7302, dtype=torch.float64) delta_t tensor(0.8006, dtype=torch.float64)
6 gae_duplicate tensor(0.5223, dtype=torch.float64) tensor(-1.0845, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1241, dtype=torch.float64) delta_t tensor(-0.2347, dtype=torch.float64)
5 gae_duplicate tensor(0.1831, dtype=torch.float64) tensor(-0.3802, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2400, dtype=torch.float64) delta_t tensor(-1.7219, dtype=torch.float64)
4 gae_duplicate tensor(-1.5754, dtype=torch.float64) tensor(3.2713, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2721, dtype=torch.float64) delta_t tensor(1.1632, dtype=torch.float64)
3 gae_duplicate tensor(-0.0971, dtype=torch.float64) tensor(0.2022, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4691, dtype=torch.float64) delta_t tensor(0.1466, dtype=torch.float64)
2 gae_duplicate tensor(0.0689, dtype=torch.float64) tensor(-0.1440, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3.6168482303619385
value loss:27.645118713378906
entropies:37.42972183227539
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.228029012680054 seconds
19 rew tensor(0.8446, dtype=torch.float64) delta_t tensor(0.4113, dtype=torch.float64)
19 gae_duplicate tensor(0.4113, dtype=torch.float64) tensor(-0.8566, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9106, dtype=torch.float64) delta_t tensor(-0.6681, dtype=torch.float64)
18 gae_duplicate tensor(-0.3390, dtype=torch.float64) tensor(0.7040, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8450, dtype=torch.float64) delta_t tensor(0.4521, dtype=torch.float64)
17 gae_duplicate tensor(0.1809, dtype=torch.float64) tensor(-0.3755, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8452, dtype=torch.float64) delta_t tensor(0.7225, dtype=torch.float64)
16 gae_duplicate tensor(0.8672, dtype=torch.float64) tensor(-1.8059, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7797, dtype=torch.float64) delta_t tensor(0.3925, dtype=torch.float64)
15 gae_duplicate tensor(1.0862, dtype=torch.float64) tensor(-2.2620, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7142, dtype=torch.float64) delta_t tensor(0.1449, dtype=torch.float64)
14 gae_duplicate tensor(1.0139, dtype=torch.float64) tensor(-2.1053, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5172, dtype=torch.float64) delta_t tensor(-0.0753, dtype=torch.float64)
13 gae_duplicate tensor(0.7358, dtype=torch.float64) tensor(-1.5278, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9115, dtype=torch.float64) delta_t tensor(0.4814, dtype=torch.float64)
12 gae_duplicate tensor(1.0700, dtype=torch.float64) tensor(-2.2218, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9117, dtype=torch.float64) delta_t tensor(0.0579, dtype=torch.float64)
11 gae_duplicate tensor(0.9139, dtype=torch.float64) tensor(-1.8977, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7148, dtype=torch.float64) delta_t tensor(0.4262, dtype=torch.float64)
10 gae_duplicate tensor(1.1574, dtype=torch.float64) tensor(-2.4103, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3873, dtype=torch.float64) delta_t tensor(-2.0000, dtype=torch.float64)
9 gae_duplicate tensor(-1.0741, dtype=torch.float64) tensor(2.2303, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.5192, dtype=torch.float64) delta_t tensor(-0.9545, dtype=torch.float64)
8 gae_duplicate tensor(-1.8138, dtype=torch.float64) tensor(3.7882, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3201, dtype=torch.float64) delta_t tensor(0.3982, dtype=torch.float64)
7 gae_duplicate tensor(-1.0528, dtype=torch.float64) tensor(2.1925, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5997, dtype=torch.float64) delta_t tensor(-0.2464, dtype=torch.float64)
6 gae_duplicate tensor(-1.0886, dtype=torch.float64) tensor(2.2605, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5853, dtype=torch.float64) delta_t tensor(-0.1139, dtype=torch.float64)
5 gae_duplicate tensor(-0.9848, dtype=torch.float64) tensor(2.0508, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4032, dtype=torch.float64) delta_t tensor(0.9845, dtype=torch.float64)
4 gae_duplicate tensor(0.1966, dtype=torch.float64) tensor(-0.4106, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3376, dtype=torch.float64) delta_t tensor(0.7738, dtype=torch.float64)
3 gae_duplicate tensor(0.9311, dtype=torch.float64) tensor(-1.9389, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4690, dtype=torch.float64) delta_t tensor(-0.1890, dtype=torch.float64)
2 gae_duplicate tensor(0.5558, dtype=torch.float64) tensor(-1.1575, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:33.33793258666992
value loss:24.088848114013672
entropies:37.42970275878906
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.202336072921753 seconds
19 rew tensor(0.9065, dtype=torch.float64) delta_t tensor(-0.1407, dtype=torch.float64)
19 gae_duplicate tensor(-0.1407, dtype=torch.float64) tensor(0.2912, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9067, dtype=torch.float64) delta_t tensor(1.9557, dtype=torch.float64)
18 gae_duplicate tensor(1.8431, dtype=torch.float64) tensor(-3.8385, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9069, dtype=torch.float64) delta_t tensor(0.9491, dtype=torch.float64)
17 gae_duplicate tensor(2.4237, dtype=torch.float64) tensor(-5.0324, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9071, dtype=torch.float64) delta_t tensor(0.9494, dtype=torch.float64)
16 gae_duplicate tensor(2.8883, dtype=torch.float64) tensor(-5.9791, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9073, dtype=torch.float64) delta_t tensor(0.9496, dtype=torch.float64)
15 gae_duplicate tensor(3.2602, dtype=torch.float64) tensor(-6.7490, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9075, dtype=torch.float64) delta_t tensor(1.1587, dtype=torch.float64)
14 gae_duplicate tensor(3.7669, dtype=torch.float64) tensor(-7.8448, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9077, dtype=torch.float64) delta_t tensor(-0.5798, dtype=torch.float64)
13 gae_duplicate tensor(2.4337, dtype=torch.float64) tensor(-5.0381, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9080, dtype=torch.float64) delta_t tensor(0.7614, dtype=torch.float64)
12 gae_duplicate tensor(2.7083, dtype=torch.float64) tensor(-5.6234, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9082, dtype=torch.float64) delta_t tensor(0.6946, dtype=torch.float64)
11 gae_duplicate tensor(2.8613, dtype=torch.float64) tensor(-5.9588, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9084, dtype=torch.float64) delta_t tensor(0.6948, dtype=torch.float64)
10 gae_duplicate tensor(2.9839, dtype=torch.float64) tensor(-6.1956, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9086, dtype=torch.float64) delta_t tensor(0.6045, dtype=torch.float64)
9 gae_duplicate tensor(2.9916, dtype=torch.float64) tensor(-6.2117, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7125, dtype=torch.float64) delta_t tensor(0.4604, dtype=torch.float64)
8 gae_duplicate tensor(2.8537, dtype=torch.float64) tensor(-5.9431, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2507, dtype=torch.float64) delta_t tensor(-1.4288, dtype=torch.float64)
7 gae_duplicate tensor(0.8542, dtype=torch.float64) tensor(-1.7737, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5783, dtype=torch.float64) delta_t tensor(-1.3371, dtype=torch.float64)
6 gae_duplicate tensor(-0.6538, dtype=torch.float64) tensor(1.3615, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7935, dtype=torch.float64) delta_t tensor(0.8120, dtype=torch.float64)
5 gae_duplicate tensor(0.2890, dtype=torch.float64) tensor(-0.6002, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-6.0302, dtype=torch.float64) delta_t tensor(-4.8971, dtype=torch.float64)
4 gae_duplicate tensor(-4.6659, dtype=torch.float64) tensor(9.6589, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0560, dtype=torch.float64) delta_t tensor(1.2529, dtype=torch.float64)
3 gae_duplicate tensor(-2.4798, dtype=torch.float64) tensor(5.1798, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0098, dtype=torch.float64) delta_t tensor(-0.1715, dtype=torch.float64)
2 gae_duplicate tensor(-2.1554, dtype=torch.float64) tensor(4.4753, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:273.8064270019531
value loss:185.54876708984375
entropies:37.4296875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.429001808166504 seconds
19 rew tensor(0.9064, dtype=torch.float64) delta_t tensor(0.1489, dtype=torch.float64)
19 gae_duplicate tensor(0.1489, dtype=torch.float64) tensor(-0.3091, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8411, dtype=torch.float64) delta_t tensor(0.5607, dtype=torch.float64)
18 gae_duplicate tensor(0.6798, dtype=torch.float64) tensor(-1.4159, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9068, dtype=torch.float64) delta_t tensor(-0.2083, dtype=torch.float64)
17 gae_duplicate tensor(0.3355, dtype=torch.float64) tensor(-0.6988, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8415, dtype=torch.float64) delta_t tensor(0.4640, dtype=torch.float64)
16 gae_duplicate tensor(0.7325, dtype=torch.float64) tensor(-1.5208, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8417, dtype=torch.float64) delta_t tensor(0.4614, dtype=torch.float64)
15 gae_duplicate tensor(1.0474, dtype=torch.float64) tensor(-2.1747, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7764, dtype=torch.float64) delta_t tensor(0.3329, dtype=torch.float64)
14 gae_duplicate tensor(1.1708, dtype=torch.float64) tensor(-2.4384, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6456, dtype=torch.float64) delta_t tensor(-0.3548, dtype=torch.float64)
13 gae_duplicate tensor(0.5819, dtype=torch.float64) tensor(-1.2118, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8421, dtype=torch.float64) delta_t tensor(0.4260, dtype=torch.float64)
12 gae_duplicate tensor(0.8915, dtype=torch.float64) tensor(-1.8567, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9078, dtype=torch.float64) delta_t tensor(0.4183, dtype=torch.float64)
11 gae_duplicate tensor(1.1315, dtype=torch.float64) tensor(-2.3421, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7116, dtype=torch.float64) delta_t tensor(0.1598, dtype=torch.float64)
10 gae_duplicate tensor(1.0650, dtype=torch.float64) tensor(-2.2112, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5154, dtype=torch.float64) delta_t tensor(-0.1985, dtype=torch.float64)
9 gae_duplicate tensor(0.6535, dtype=torch.float64) tensor(-1.3527, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9897, dtype=torch.float64) delta_t tensor(-0.8026, dtype=torch.float64)
8 gae_duplicate tensor(-0.2798, dtype=torch.float64) tensor(0.5845, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0571, dtype=torch.float64) delta_t tensor(0.5612, dtype=torch.float64)
7 gae_duplicate tensor(0.3374, dtype=torch.float64) tensor(-0.7027, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.7750, dtype=torch.float64) delta_t tensor(-2.4660, dtype=torch.float64)
6 gae_duplicate tensor(-2.1960, dtype=torch.float64) tensor(4.5595, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9906, dtype=torch.float64) delta_t tensor(1.2186, dtype=torch.float64)
5 gae_duplicate tensor(-0.5383, dtype=torch.float64) tensor(1.1141, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3653, dtype=torch.float64) delta_t tensor(-0.9788, dtype=torch.float64)
4 gae_duplicate tensor(-1.4094, dtype=torch.float64) tensor(2.9442, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3371, dtype=torch.float64) delta_t tensor(0.7737, dtype=torch.float64)
3 gae_duplicate tensor(-0.3538, dtype=torch.float64) tensor(0.7368, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4681, dtype=torch.float64) delta_t tensor(-0.1731, dtype=torch.float64)
2 gae_duplicate tensor(-0.4561, dtype=torch.float64) tensor(0.9528, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:42.93511199951172
value loss:22.800251007080078
entropies:37.42966842651367
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.1483)
ToM Target loss= tensor(307.6554)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.45500373840332 seconds
19 rew tensor(0.9063, dtype=torch.float64) delta_t tensor(-1.4877, dtype=torch.float64)
19 gae_duplicate tensor(-1.4877, dtype=torch.float64) tensor(3.0782, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9065, dtype=torch.float64) delta_t tensor(0.2786, dtype=torch.float64)
18 gae_duplicate tensor(-0.9116, dtype=torch.float64) tensor(1.8987, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9067, dtype=torch.float64) delta_t tensor(0.6873, dtype=torch.float64)
17 gae_duplicate tensor(-0.0419, dtype=torch.float64) tensor(0.0876, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9069, dtype=torch.float64) delta_t tensor(0.5459, dtype=torch.float64)
16 gae_duplicate tensor(0.5124, dtype=torch.float64) tensor(-1.0671, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9072, dtype=torch.float64) delta_t tensor(0.4199, dtype=torch.float64)
15 gae_duplicate tensor(0.8298, dtype=torch.float64) tensor(-1.7282, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9074, dtype=torch.float64) delta_t tensor(0.4636, dtype=torch.float64)
14 gae_duplicate tensor(1.1275, dtype=torch.float64) tensor(-2.3334, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9076, dtype=torch.float64) delta_t tensor(0.2182, dtype=torch.float64)
13 gae_duplicate tensor(1.1202, dtype=torch.float64) tensor(-2.3331, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9078, dtype=torch.float64) delta_t tensor(0.4743, dtype=torch.float64)
12 gae_duplicate tensor(1.3704, dtype=torch.float64) tensor(-2.8452, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7770, dtype=torch.float64) delta_t tensor(0.1694, dtype=torch.float64)
11 gae_duplicate tensor(1.2657, dtype=torch.float64) tensor(-2.6278, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3187, dtype=torch.float64) delta_t tensor(0.1953, dtype=torch.float64)
10 gae_duplicate tensor(1.2079, dtype=torch.float64) tensor(-2.5237, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1878, dtype=torch.float64) delta_t tensor(0.2821, dtype=torch.float64)
9 gae_duplicate tensor(1.2484, dtype=torch.float64) tensor(-2.4028, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3842, dtype=torch.float64) delta_t tensor(-0.1155, dtype=torch.float64)
8 gae_duplicate tensor(0.8833, dtype=torch.float64) tensor(-1.5933, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7942, dtype=torch.float64) delta_t tensor(-1.1541, dtype=torch.float64)
7 gae_duplicate tensor(-0.4475, dtype=torch.float64) tensor(0.8506, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9254, dtype=torch.float64) delta_t tensor(-0.2547, dtype=torch.float64)
6 gae_duplicate tensor(-0.6127, dtype=torch.float64) tensor(1.2680, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7112, dtype=torch.float64) delta_t tensor(-0.3370, dtype=torch.float64)
5 gae_duplicate tensor(-0.8271, dtype=torch.float64) tensor(1.7281, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0094, dtype=torch.float64) delta_t tensor(1.1124, dtype=torch.float64)
4 gae_duplicate tensor(0.4508, dtype=torch.float64) tensor(-0.8564, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3845, dtype=torch.float64) delta_t tensor(-0.3831, dtype=torch.float64)
3 gae_duplicate tensor(-0.0225, dtype=torch.float64) tensor(0.0472, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3195, dtype=torch.float64) delta_t tensor(-0.3702, dtype=torch.float64)
2 gae_duplicate tensor(-0.3882, dtype=torch.float64) tensor(0.8060, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:62.16027069091797
value loss:23.122623443603516
entropies:37.32527542114258
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.353087902069092 seconds
19 rew tensor(0.7111, dtype=torch.float64) delta_t tensor(-1.6253, dtype=torch.float64)
19 gae_duplicate tensor(-1.6253, dtype=torch.float64) tensor(3.3743, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7112, dtype=torch.float64) delta_t tensor(0.6589, dtype=torch.float64)
18 gae_duplicate tensor(-0.6414, dtype=torch.float64) tensor(1.3402, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3837, dtype=torch.float64) delta_t tensor(0.4012, dtype=torch.float64)
17 gae_duplicate tensor(-0.1120, dtype=torch.float64) tensor(0.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.0094, dtype=torch.float64) delta_t tensor(-0.8467, dtype=torch.float64)
16 gae_duplicate tensor(-0.9363, dtype=torch.float64) tensor(1.9564, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4492, dtype=torch.float64) delta_t tensor(0.7936, dtype=torch.float64)
15 gae_duplicate tensor(0.0446, dtype=torch.float64) tensor(-0.0929, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0562, dtype=torch.float64) delta_t tensor(-0.4491, dtype=torch.float64)
14 gae_duplicate tensor(-0.4134, dtype=torch.float64) tensor(0.8582, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9077, dtype=torch.float64) delta_t tensor(0.5990, dtype=torch.float64)
13 gae_duplicate tensor(0.2683, dtype=torch.float64) tensor(-0.5570, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9079, dtype=torch.float64) delta_t tensor(0.2725, dtype=torch.float64)
12 gae_duplicate tensor(0.4871, dtype=torch.float64) tensor(-1.0146, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8426, dtype=torch.float64) delta_t tensor(0.0299, dtype=torch.float64)
11 gae_duplicate tensor(0.4196, dtype=torch.float64) tensor(-0.8740, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7773, dtype=torch.float64) delta_t tensor(0.4127, dtype=torch.float64)
10 gae_duplicate tensor(0.7484, dtype=torch.float64) tensor(-1.5588, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5323, dtype=torch.float64) delta_t tensor(-0.4251, dtype=torch.float64)
9 gae_duplicate tensor(0.1736, dtype=torch.float64) tensor(-0.3617, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3182, dtype=torch.float64) delta_t tensor(-1.6694, dtype=torch.float64)
8 gae_duplicate tensor(-1.5305, dtype=torch.float64) tensor(3.1775, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7948, dtype=torch.float64) delta_t tensor(-0.5090, dtype=torch.float64)
7 gae_duplicate tensor(-1.7334, dtype=torch.float64) tensor(3.5987, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3188, dtype=torch.float64) delta_t tensor(-0.5035, dtype=torch.float64)
6 gae_duplicate tensor(-1.8903, dtype=torch.float64) tensor(3.9243, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1228, dtype=torch.float64) delta_t tensor(-0.4346, dtype=torch.float64)
5 gae_duplicate tensor(-1.9468, dtype=torch.float64) tensor(4.0418, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3676, dtype=torch.float64) delta_t tensor(-2.0385, dtype=torch.float64)
4 gae_duplicate tensor(-3.5960, dtype=torch.float64) tensor(7.4656, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6001, dtype=torch.float64) delta_t tensor(0.6045, dtype=torch.float64)
3 gae_duplicate tensor(-2.2723, dtype=torch.float64) tensor(4.7480, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6002, dtype=torch.float64) delta_t tensor(1.2523, dtype=torch.float64)
2 gae_duplicate tensor(-0.5655, dtype=torch.float64) tensor(1.1207, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-189.4081268310547
value loss:54.472679138183594
entropies:37.423583984375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.506518125534058 seconds
19 rew tensor(0.9053, dtype=torch.float64) delta_t tensor(-1.0166, dtype=torch.float64)
19 gae_duplicate tensor(-1.0166, dtype=torch.float64) tensor(2.0742, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9055, dtype=torch.float64) delta_t tensor(0.4468, dtype=torch.float64)
18 gae_duplicate tensor(-0.3665, dtype=torch.float64) tensor(0.7771, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9057, dtype=torch.float64) delta_t tensor(0.5107, dtype=torch.float64)
17 gae_duplicate tensor(0.2175, dtype=torch.float64) tensor(-0.4531, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9059, dtype=torch.float64) delta_t tensor(1.1765, dtype=torch.float64)
16 gae_duplicate tensor(1.3505, dtype=torch.float64) tensor(-2.7947, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9061, dtype=torch.float64) delta_t tensor(0.6433, dtype=torch.float64)
15 gae_duplicate tensor(1.7237, dtype=torch.float64) tensor(-3.5902, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9063, dtype=torch.float64) delta_t tensor(0.4840, dtype=torch.float64)
14 gae_duplicate tensor(1.8629, dtype=torch.float64) tensor(-3.8676, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9065, dtype=torch.float64) delta_t tensor(0.3498, dtype=torch.float64)
13 gae_duplicate tensor(1.8401, dtype=torch.float64) tensor(-3.8452, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9067, dtype=torch.float64) delta_t tensor(0.3289, dtype=torch.float64)
12 gae_duplicate tensor(1.8010, dtype=torch.float64) tensor(-3.7511, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9069, dtype=torch.float64) delta_t tensor(0.8789, dtype=torch.float64)
11 gae_duplicate tensor(2.3197, dtype=torch.float64) tensor(-4.8159, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5805, dtype=torch.float64) delta_t tensor(-0.3846, dtype=torch.float64)
10 gae_duplicate tensor(1.4712, dtype=torch.float64) tensor(-3.0643, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4441, dtype=torch.float64) delta_t tensor(-2.3198, dtype=torch.float64)
9 gae_duplicate tensor(-1.1428, dtype=torch.float64) tensor(2.3803, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8568, dtype=torch.float64) delta_t tensor(-1.4486, dtype=torch.float64)
8 gae_duplicate tensor(-2.3628, dtype=torch.float64) tensor(4.9373, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3841, dtype=torch.float64) delta_t tensor(0.5791, dtype=torch.float64)
7 gae_duplicate tensor(-1.3112, dtype=torch.float64) tensor(2.7221, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7262, dtype=torch.float64) delta_t tensor(0.6753, dtype=torch.float64)
6 gae_duplicate tensor(-0.3736, dtype=torch.float64) tensor(0.7782, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1835, dtype=torch.float64) delta_t tensor(0.5572, dtype=torch.float64)
5 gae_duplicate tensor(0.2583, dtype=torch.float64) tensor(-0.5134, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.6252, dtype=torch.float64) delta_t tensor(-4.1582, dtype=torch.float64)
4 gae_duplicate tensor(-3.9515, dtype=torch.float64) tensor(9.1254, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1408, dtype=torch.float64) delta_t tensor(0.9319, dtype=torch.float64)
3 gae_duplicate tensor(-2.2293, dtype=torch.float64) tensor(4.6386, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1408, dtype=torch.float64) delta_t tensor(0.7070, dtype=torch.float64)
2 gae_duplicate tensor(-1.0764, dtype=torch.float64) tensor(2.2348, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-18.956567764282227
value loss:81.31990051269531
entropies:37.40217590332031
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.507750749588013 seconds
19 rew tensor(0.9046, dtype=torch.float64) delta_t tensor(-1.2529, dtype=torch.float64)
19 gae_duplicate tensor(-1.2529, dtype=torch.float64) tensor(2.6010, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9048, dtype=torch.float64) delta_t tensor(0.1404, dtype=torch.float64)
18 gae_duplicate tensor(-0.8619, dtype=torch.float64) tensor(1.7953, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9050, dtype=torch.float64) delta_t tensor(0.2185, dtype=torch.float64)
17 gae_duplicate tensor(-0.4710, dtype=torch.float64) tensor(0.9745, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9052, dtype=torch.float64) delta_t tensor(0.7984, dtype=torch.float64)
16 gae_duplicate tensor(0.4216, dtype=torch.float64) tensor(-0.8810, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9054, dtype=torch.float64) delta_t tensor(0.4224, dtype=torch.float64)
15 gae_duplicate tensor(0.7597, dtype=torch.float64) tensor(-1.5823, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9056, dtype=torch.float64) delta_t tensor(0.6438, dtype=torch.float64)
14 gae_duplicate tensor(1.2516, dtype=torch.float64) tensor(-2.6069, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9058, dtype=torch.float64) delta_t tensor(0.3072, dtype=torch.float64)
13 gae_duplicate tensor(1.3084, dtype=torch.float64) tensor(-2.7163, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9060, dtype=torch.float64) delta_t tensor(0.1269, dtype=torch.float64)
12 gae_duplicate tensor(1.1736, dtype=torch.float64) tensor(-2.4283, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9062, dtype=torch.float64) delta_t tensor(0.1144, dtype=torch.float64)
11 gae_duplicate tensor(1.0534, dtype=torch.float64) tensor(-2.1941, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9064, dtype=torch.float64) delta_t tensor(0.0886, dtype=torch.float64)
10 gae_duplicate tensor(0.9313, dtype=torch.float64) tensor(-1.9334, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3838, dtype=torch.float64) delta_t tensor(-0.0509, dtype=torch.float64)
9 gae_duplicate tensor(0.6942, dtype=torch.float64) tensor(-1.4411, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0572, dtype=torch.float64) delta_t tensor(0.7251, dtype=torch.float64)
8 gae_duplicate tensor(1.2805, dtype=torch.float64) tensor(-2.6223, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0735, dtype=torch.float64) delta_t tensor(-1.3674, dtype=torch.float64)
7 gae_duplicate tensor(-0.3430, dtype=torch.float64) tensor(0.7397, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2695, dtype=torch.float64) delta_t tensor(-1.0148, dtype=torch.float64)
6 gae_duplicate tensor(-1.2892, dtype=torch.float64) tensor(2.6674, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9678, dtype=torch.float64) delta_t tensor(0.8752, dtype=torch.float64)
5 gae_duplicate tensor(-0.1561, dtype=torch.float64) tensor(0.3241, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7754, dtype=torch.float64) delta_t tensor(1.6996, dtype=torch.float64)
4 gae_duplicate tensor(1.5747, dtype=torch.float64) tensor(-2.8219, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1193, dtype=torch.float64) delta_t tensor(0.3236, dtype=torch.float64)
3 gae_duplicate tensor(1.5834, dtype=torch.float64) tensor(-3.2612, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7929, dtype=torch.float64) delta_t tensor(0.1085, dtype=torch.float64)
2 gae_duplicate tensor(1.3752, dtype=torch.float64) tensor(-2.8549, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:108.32987213134766
value loss:31.087743759155273
entropies:37.37022399902344
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.27520489692688 seconds
19 rew tensor(0.6446, dtype=torch.float64) delta_t tensor(-1.0753, dtype=torch.float64)
19 gae_duplicate tensor(-1.0753, dtype=torch.float64) tensor(2.3303, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3830, dtype=torch.float64) delta_t tensor(0.0106, dtype=torch.float64)
18 gae_duplicate tensor(-0.8496, dtype=torch.float64) tensor(1.8111, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0093, dtype=torch.float64) delta_t tensor(-0.5712, dtype=torch.float64)
17 gae_duplicate tensor(-1.2509, dtype=torch.float64) tensor(2.6056, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.9249, dtype=torch.float64) delta_t tensor(-1.6560, dtype=torch.float64)
16 gae_duplicate tensor(-2.6567, dtype=torch.float64) tensor(5.5149, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8406, dtype=torch.float64) delta_t tensor(0.3782, dtype=torch.float64)
15 gae_duplicate tensor(-1.7471, dtype=torch.float64) tensor(3.6394, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6446, dtype=torch.float64) delta_t tensor(0.3445, dtype=torch.float64)
14 gae_duplicate tensor(-1.0532, dtype=torch.float64) tensor(2.1940, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5139, dtype=torch.float64) delta_t tensor(0.5675, dtype=torch.float64)
13 gae_duplicate tensor(-0.2751, dtype=torch.float64) tensor(0.5710, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8409, dtype=torch.float64) delta_t tensor(0.0765, dtype=torch.float64)
12 gae_duplicate tensor(-0.1436, dtype=torch.float64) tensor(0.3002, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8411, dtype=torch.float64) delta_t tensor(-0.0904, dtype=torch.float64)
11 gae_duplicate tensor(-0.2053, dtype=torch.float64) tensor(0.4277, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7759, dtype=torch.float64) delta_t tensor(0.3123, dtype=torch.float64)
10 gae_duplicate tensor(0.1480, dtype=torch.float64) tensor(-0.3083, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1852, dtype=torch.float64) delta_t tensor(-1.6847, dtype=torch.float64)
9 gae_duplicate tensor(-1.5663, dtype=torch.float64) tensor(3.2739, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3163, dtype=torch.float64) delta_t tensor(-1.3162, dtype=torch.float64)
8 gae_duplicate tensor(-2.5693, dtype=torch.float64) tensor(5.3334, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9898, dtype=torch.float64) delta_t tensor(-0.9138, dtype=torch.float64)
7 gae_duplicate tensor(-2.9692, dtype=torch.float64) tensor(6.2064, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5131, dtype=torch.float64) delta_t tensor(-2.0635, dtype=torch.float64)
6 gae_duplicate tensor(-4.4389, dtype=torch.float64) tensor(9.2145, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1214, dtype=torch.float64) delta_t tensor(-1.9118, dtype=torch.float64)
5 gae_duplicate tensor(-5.4629, dtype=torch.float64) tensor(11.3403, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4024, dtype=torch.float64) delta_t tensor(2.1286, dtype=torch.float64)
4 gae_duplicate tensor(-2.2418, dtype=torch.float64) tensor(4.4602, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0101, dtype=torch.float64) delta_t tensor(2.2106, dtype=torch.float64)
3 gae_duplicate tensor(0.4172, dtype=torch.float64) tensor(-0.8967, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6639, dtype=torch.float64) delta_t tensor(0.4701, dtype=torch.float64)
2 gae_duplicate tensor(0.8038, dtype=torch.float64) tensor(-1.8245, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-338.2821960449219
value loss:132.12869262695312
entropies:37.403953552246094
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.0016)
ToM Target loss= tensor(308.4680)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.387049913406372 seconds
19 rew tensor(0.9054, dtype=torch.float64) delta_t tensor(-1.0636, dtype=torch.float64)
19 gae_duplicate tensor(-1.0636, dtype=torch.float64) tensor(2.1999, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9056, dtype=torch.float64) delta_t tensor(0.0870, dtype=torch.float64)
18 gae_duplicate tensor(-0.7639, dtype=torch.float64) tensor(1.5856, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9058, dtype=torch.float64) delta_t tensor(0.3720, dtype=torch.float64)
17 gae_duplicate tensor(-0.2391, dtype=torch.float64) tensor(0.4962, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9060, dtype=torch.float64) delta_t tensor(0.4561, dtype=torch.float64)
16 gae_duplicate tensor(0.2649, dtype=torch.float64) tensor(-0.5518, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9063, dtype=torch.float64) delta_t tensor(0.1040, dtype=torch.float64)
15 gae_duplicate tensor(0.3159, dtype=torch.float64) tensor(-0.6581, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9065, dtype=torch.float64) delta_t tensor(0.3869, dtype=torch.float64)
14 gae_duplicate tensor(0.6397, dtype=torch.float64) tensor(-1.3372, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9067, dtype=torch.float64) delta_t tensor(0.2745, dtype=torch.float64)
13 gae_duplicate tensor(0.7863, dtype=torch.float64) tensor(-1.6321, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9069, dtype=torch.float64) delta_t tensor(0.3480, dtype=torch.float64)
12 gae_duplicate tensor(0.9770, dtype=torch.float64) tensor(-2.0352, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9071, dtype=torch.float64) delta_t tensor(-0.1586, dtype=torch.float64)
11 gae_duplicate tensor(0.6229, dtype=torch.float64) tensor(-1.2931, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9073, dtype=torch.float64) delta_t tensor(0.6182, dtype=torch.float64)
10 gae_duplicate tensor(1.1165, dtype=torch.float64) tensor(-2.3259, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6460, dtype=torch.float64) delta_t tensor(0.1209, dtype=torch.float64)
9 gae_duplicate tensor(1.0141, dtype=torch.float64) tensor(-2.1051, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1885, dtype=torch.float64) delta_t tensor(0.8230, dtype=torch.float64)
8 gae_duplicate tensor(1.6343, dtype=torch.float64) tensor(-3.2233, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5959, dtype=torch.float64) delta_t tensor(-2.5613, dtype=torch.float64)
7 gae_duplicate tensor(-1.2538, dtype=torch.float64) tensor(2.7306, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3150, dtype=torch.float64) delta_t tensor(1.0187, dtype=torch.float64)
6 gae_duplicate tensor(0.0156, dtype=torch.float64) tensor(-0.0303, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7730, dtype=torch.float64) delta_t tensor(-1.0504, dtype=torch.float64)
5 gae_duplicate tensor(-1.0379, dtype=torch.float64) tensor(1.9946, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3624, dtype=torch.float64) delta_t tensor(-1.9526, dtype=torch.float64)
4 gae_duplicate tensor(-2.7829, dtype=torch.float64) tensor(5.8175, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4671, dtype=torch.float64) delta_t tensor(2.2415, dtype=torch.float64)
3 gae_duplicate tensor(0.0152, dtype=torch.float64) tensor(-0.0272, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7101, dtype=torch.float64) delta_t tensor(-1.3248, dtype=torch.float64)
2 gae_duplicate tensor(-1.3127, dtype=torch.float64) tensor(2.7152, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-15.040923118591309
value loss:32.062896728515625
entropies:37.334083557128906
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.54694128036499 seconds
19 rew tensor(0.9050, dtype=torch.float64) delta_t tensor(-1.7898, dtype=torch.float64)
19 gae_duplicate tensor(-1.7898, dtype=torch.float64) tensor(3.7014, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9052, dtype=torch.float64) delta_t tensor(0.2913, dtype=torch.float64)
18 gae_duplicate tensor(-1.1405, dtype=torch.float64) tensor(2.3847, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9054, dtype=torch.float64) delta_t tensor(0.5020, dtype=torch.float64)
17 gae_duplicate tensor(-0.4104, dtype=torch.float64) tensor(0.8518, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9056, dtype=torch.float64) delta_t tensor(0.2399, dtype=torch.float64)
16 gae_duplicate tensor(-0.0884, dtype=torch.float64) tensor(0.1841, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9058, dtype=torch.float64) delta_t tensor(0.3721, dtype=torch.float64)
15 gae_duplicate tensor(0.3014, dtype=torch.float64) tensor(-0.6255, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9060, dtype=torch.float64) delta_t tensor(0.5463, dtype=torch.float64)
14 gae_duplicate tensor(0.7874, dtype=torch.float64) tensor(-1.6404, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9062, dtype=torch.float64) delta_t tensor(0.9477, dtype=torch.float64)
13 gae_duplicate tensor(1.5776, dtype=torch.float64) tensor(-3.2866, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9064, dtype=torch.float64) delta_t tensor(4.0507, dtype=torch.float64)
12 gae_duplicate tensor(5.3128, dtype=torch.float64) tensor(-11.5860, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9066, dtype=torch.float64) delta_t tensor(-1.8367, dtype=torch.float64)
11 gae_duplicate tensor(2.4135, dtype=torch.float64) tensor(-4.2717, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9068, dtype=torch.float64) delta_t tensor(0.7077, dtype=torch.float64)
10 gae_duplicate tensor(2.6385, dtype=torch.float64) tensor(-6.6550, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9070, dtype=torch.float64) delta_t tensor(0.7288, dtype=torch.float64)
9 gae_duplicate tensor(2.8396, dtype=torch.float64) tensor(-5.0262, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2535, dtype=torch.float64) delta_t tensor(-0.6354, dtype=torch.float64)
8 gae_duplicate tensor(1.6363, dtype=torch.float64) tensor(-2.8836, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3348, dtype=torch.float64) delta_t tensor(-0.6222, dtype=torch.float64)
7 gae_duplicate tensor(0.6869, dtype=torch.float64) tensor(-1.7017, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7924, dtype=torch.float64) delta_t tensor(-2.3933, dtype=torch.float64)
6 gae_duplicate tensor(-1.8438, dtype=torch.float64) tensor(3.7419, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9886, dtype=torch.float64) delta_t tensor(1.9343, dtype=torch.float64)
5 gae_duplicate tensor(0.4593, dtype=torch.float64) tensor(-0.9084, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5771, dtype=torch.float64) delta_t tensor(-0.3068, dtype=torch.float64)
4 gae_duplicate tensor(0.0606, dtype=torch.float64) tensor(-0.1168, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.1661, dtype=torch.float64) delta_t tensor(-0.5164, dtype=torch.float64)
3 gae_duplicate tensor(-0.4679, dtype=torch.float64) tensor(0.9783, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8596, dtype=torch.float64) delta_t tensor(-1.4742, dtype=torch.float64)
2 gae_duplicate tensor(-1.8485, dtype=torch.float64) tensor(3.7807, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:137.3625030517578
value loss:101.03277587890625
entropies:37.077571868896484
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.307123899459839 seconds
19 rew tensor(0.9048, dtype=torch.float64) delta_t tensor(-1.7431, dtype=torch.float64)
19 gae_duplicate tensor(-1.7431, dtype=torch.float64) tensor(3.4818, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9050, dtype=torch.float64) delta_t tensor(0.2457, dtype=torch.float64)
18 gae_duplicate tensor(-1.1488, dtype=torch.float64) tensor(2.3264, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9052, dtype=torch.float64) delta_t tensor(1.0607, dtype=torch.float64)
17 gae_duplicate tensor(0.1417, dtype=torch.float64) tensor(-0.3014, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9054, dtype=torch.float64) delta_t tensor(-0.1706, dtype=torch.float64)
16 gae_duplicate tensor(-0.0572, dtype=torch.float64) tensor(0.1192, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9056, dtype=torch.float64) delta_t tensor(0.7399, dtype=torch.float64)
15 gae_duplicate tensor(0.6941, dtype=torch.float64) tensor(-1.4514, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9058, dtype=torch.float64) delta_t tensor(0.4455, dtype=torch.float64)
14 gae_duplicate tensor(1.0008, dtype=torch.float64) tensor(-2.0849, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9060, dtype=torch.float64) delta_t tensor(3.1995, dtype=torch.float64)
13 gae_duplicate tensor(4.0002, dtype=torch.float64) tensor(-7.6547, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9062, dtype=torch.float64) delta_t tensor(0.5649, dtype=torch.float64)
12 gae_duplicate tensor(3.7650, dtype=torch.float64) tensor(-6.7279, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7756, dtype=torch.float64) delta_t tensor(-1.5005, dtype=torch.float64)
11 gae_duplicate tensor(1.5115, dtype=torch.float64) tensor(-2.6591, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5796, dtype=torch.float64) delta_t tensor(0.1186, dtype=torch.float64)
10 gae_duplicate tensor(1.3278, dtype=torch.float64) tensor(-3.3576, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2527, dtype=torch.float64) delta_t tensor(0.6370, dtype=torch.float64)
9 gae_duplicate tensor(1.6992, dtype=torch.float64) tensor(-2.9895, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5143, dtype=torch.float64) delta_t tensor(-0.0867, dtype=torch.float64)
8 gae_duplicate tensor(1.2727, dtype=torch.float64) tensor(-2.2487, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9893, dtype=torch.float64) delta_t tensor(-2.1795, dtype=torch.float64)
7 gae_duplicate tensor(-1.1613, dtype=torch.float64) tensor(2.8403, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9895, dtype=torch.float64) delta_t tensor(-1.9262, dtype=torch.float64)
6 gae_duplicate tensor(-2.8553, dtype=torch.float64) tensor(5.9685, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7743, dtype=torch.float64) delta_t tensor(1.1799, dtype=torch.float64)
5 gae_duplicate tensor(-1.1043, dtype=torch.float64) tensor(2.2187, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1212, dtype=torch.float64) delta_t tensor(1.2286, dtype=torch.float64)
4 gae_duplicate tensor(0.3451, dtype=torch.float64) tensor(-0.8578, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5788, dtype=torch.float64) delta_t tensor(-0.5171, dtype=torch.float64)
3 gae_duplicate tensor(-0.2410, dtype=torch.float64) tensor(0.5397, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3179, dtype=torch.float64) delta_t tensor(-0.2608, dtype=torch.float64)
2 gae_duplicate tensor(-0.4536, dtype=torch.float64) tensor(0.9450, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:70.25289154052734
value loss:83.55032348632812
entropies:36.94913101196289
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.527536869049072 seconds
19 rew tensor(0.9031, dtype=torch.float64) delta_t tensor(-1.2592, dtype=torch.float64)
19 gae_duplicate tensor(-1.2592, dtype=torch.float64) tensor(2.4410, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9033, dtype=torch.float64) delta_t tensor(0.5543, dtype=torch.float64)
18 gae_duplicate tensor(-0.4531, dtype=torch.float64) tensor(1.0258, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9035, dtype=torch.float64) delta_t tensor(0.6116, dtype=torch.float64)
17 gae_duplicate tensor(0.2491, dtype=torch.float64) tensor(-0.4893, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9037, dtype=torch.float64) delta_t tensor(1.1247, dtype=torch.float64)
16 gae_duplicate tensor(1.3240, dtype=torch.float64) tensor(-2.7232, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9039, dtype=torch.float64) delta_t tensor(0.2295, dtype=torch.float64)
15 gae_duplicate tensor(1.2887, dtype=torch.float64) tensor(-2.6952, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.4962, dtype=torch.float64)
14 gae_duplicate tensor(1.5271, dtype=torch.float64) tensor(-3.1816, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(0.5429, dtype=torch.float64)
13 gae_duplicate tensor(1.7646, dtype=torch.float64) tensor(-3.6624, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9045, dtype=torch.float64) delta_t tensor(-0.1091, dtype=torch.float64)
12 gae_duplicate tensor(1.3026, dtype=torch.float64) tensor(-2.7139, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9047, dtype=torch.float64) delta_t tensor(0.3080, dtype=torch.float64)
11 gae_duplicate tensor(1.3501, dtype=torch.float64) tensor(-2.8128, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9049, dtype=torch.float64) delta_t tensor(0.7764, dtype=torch.float64)
10 gae_duplicate tensor(1.8565, dtype=torch.float64) tensor(-3.6675, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9051, dtype=torch.float64) delta_t tensor(0.0982, dtype=torch.float64)
9 gae_duplicate tensor(1.5834, dtype=torch.float64) tensor(-3.5897, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.5754, dtype=torch.float64) delta_t tensor(-1.9120, dtype=torch.float64)
8 gae_duplicate tensor(-0.6453, dtype=torch.float64) tensor(1.2435, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9884, dtype=torch.float64) delta_t tensor(-1.1870, dtype=torch.float64)
7 gae_duplicate tensor(-1.7032, dtype=torch.float64) tensor(3.4026, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1399, dtype=torch.float64) delta_t tensor(-1.0167, dtype=torch.float64)
6 gae_duplicate tensor(-2.3793, dtype=torch.float64) tensor(4.9383, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2497, dtype=torch.float64) delta_t tensor(1.3015, dtype=torch.float64)
5 gae_duplicate tensor(-0.6020, dtype=torch.float64) tensor(1.2494, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.4493, dtype=torch.float64) delta_t tensor(-2.7360, dtype=torch.float64)
4 gae_duplicate tensor(-3.2176, dtype=torch.float64) tensor(7.1662, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2725, dtype=torch.float64) delta_t tensor(0.3976, dtype=torch.float64)
3 gae_duplicate tensor(-2.1765, dtype=torch.float64) tensor(4.2163, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1417, dtype=torch.float64) delta_t tensor(0.6805, dtype=torch.float64)
2 gae_duplicate tensor(-1.0607, dtype=torch.float64) tensor(2.2014, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-15.212846755981445
value loss:68.61307525634766
entropies:37.333988189697266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.2158379554748535 seconds
19 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(-1.6851, dtype=torch.float64)
19 gae_duplicate tensor(-1.6851, dtype=torch.float64) tensor(3.2148, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(1.2948, dtype=torch.float64)
18 gae_duplicate tensor(-0.0533, dtype=torch.float64) tensor(0.1115, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9025, dtype=torch.float64) delta_t tensor(0.5671, dtype=torch.float64)
17 gae_duplicate tensor(0.5244, dtype=torch.float64) tensor(-1.0884, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9027, dtype=torch.float64) delta_t tensor(0.5673, dtype=torch.float64)
16 gae_duplicate tensor(0.9868, dtype=torch.float64) tensor(-2.0561, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9029, dtype=torch.float64) delta_t tensor(0.4675, dtype=torch.float64)
15 gae_duplicate tensor(1.2570, dtype=torch.float64) tensor(-2.6087, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9031, dtype=torch.float64) delta_t tensor(0.5477, dtype=torch.float64)
14 gae_duplicate tensor(1.5532, dtype=torch.float64) tensor(-3.2236, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9033, dtype=torch.float64) delta_t tensor(-0.4145, dtype=torch.float64)
13 gae_duplicate tensor(0.8281, dtype=torch.float64) tensor(-1.8645, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9035, dtype=torch.float64) delta_t tensor(0.5080, dtype=torch.float64)
12 gae_duplicate tensor(1.1705, dtype=torch.float64) tensor(-2.6628, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9037, dtype=torch.float64) delta_t tensor(0.5528, dtype=torch.float64)
11 gae_duplicate tensor(1.4892, dtype=torch.float64) tensor(-2.6101, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9039, dtype=torch.float64) delta_t tensor(0.1792, dtype=torch.float64)
10 gae_duplicate tensor(1.3706, dtype=torch.float64) tensor(-2.4023, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.1981, dtype=torch.float64)
9 gae_duplicate tensor(1.2946, dtype=torch.float64) tensor(-2.2689, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0085, dtype=torch.float64) delta_t tensor(-0.9537, dtype=torch.float64)
8 gae_duplicate tensor(0.0820, dtype=torch.float64) tensor(-0.1430, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8559, dtype=torch.float64) delta_t tensor(-1.5476, dtype=torch.float64)
7 gae_duplicate tensor(-1.4820, dtype=torch.float64) tensor(2.7800, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.0295, dtype=torch.float64) delta_t tensor(0.0512, dtype=torch.float64)
6 gae_duplicate tensor(-1.1344, dtype=torch.float64) tensor(2.1197, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7699, dtype=torch.float64) delta_t tensor(-0.5175, dtype=torch.float64)
5 gae_duplicate tensor(-1.4250, dtype=torch.float64) tensor(3.2132, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8797, dtype=torch.float64) delta_t tensor(-2.7696, dtype=torch.float64)
4 gae_duplicate tensor(-3.9096, dtype=torch.float64) tensor(7.7216, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1409, dtype=torch.float64) delta_t tensor(1.5602, dtype=torch.float64)
3 gae_duplicate tensor(-1.5675, dtype=torch.float64) tensor(3.9048, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-2.1646, dtype=torch.float64) delta_t tensor(-1.3617, dtype=torch.float64)
2 gae_duplicate tensor(-2.6157, dtype=torch.float64) tensor(5.4286, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-46.503379821777344
value loss:69.02307891845703
entropies:36.948394775390625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.1451)
ToM Target loss= tensor(308.8344)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.50492000579834 seconds
19 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(-1.5818, dtype=torch.float64)
19 gae_duplicate tensor(-1.5818, dtype=torch.float64) tensor(3.4532, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.2592, dtype=torch.float64)
18 gae_duplicate tensor(-1.0063, dtype=torch.float64) tensor(2.0071, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(0.3085, dtype=torch.float64)
17 gae_duplicate tensor(-0.4965, dtype=torch.float64) tensor(0.9896, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(1.0551, dtype=torch.float64)
16 gae_duplicate tensor(0.6579, dtype=torch.float64) tensor(-1.4284, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(0.1142, dtype=torch.float64)
15 gae_duplicate tensor(0.6406, dtype=torch.float64) tensor(-1.3228, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(0.6383, dtype=torch.float64)
14 gae_duplicate tensor(1.1508, dtype=torch.float64) tensor(-2.3979, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9025, dtype=torch.float64) delta_t tensor(0.4672, dtype=torch.float64)
13 gae_duplicate tensor(1.3878, dtype=torch.float64) tensor(-2.8802, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9027, dtype=torch.float64) delta_t tensor(0.4674, dtype=torch.float64)
12 gae_duplicate tensor(1.5776, dtype=torch.float64) tensor(-3.2872, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9029, dtype=torch.float64) delta_t tensor(-0.1797, dtype=torch.float64)
11 gae_duplicate tensor(1.0824, dtype=torch.float64) tensor(-2.2462, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9031, dtype=torch.float64) delta_t tensor(0.3958, dtype=torch.float64)
10 gae_duplicate tensor(1.2617, dtype=torch.float64) tensor(-2.6290, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1208, dtype=torch.float64) delta_t tensor(-0.6492, dtype=torch.float64)
9 gae_duplicate tensor(0.3602, dtype=torch.float64) tensor(-0.7144, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3164, dtype=torch.float64) delta_t tensor(0.8492, dtype=torch.float64)
8 gae_duplicate tensor(1.1373, dtype=torch.float64) tensor(-2.8302, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0095, dtype=torch.float64) delta_t tensor(-1.0370, dtype=torch.float64)
7 gae_duplicate tensor(-0.1271, dtype=torch.float64) tensor(0.2222, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7918, dtype=torch.float64) delta_t tensor(-1.9259, dtype=torch.float64)
6 gae_duplicate tensor(-2.0276, dtype=torch.float64) tensor(3.9265, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.2260, dtype=torch.float64) delta_t tensor(1.1518, dtype=torch.float64)
5 gae_duplicate tensor(-0.4703, dtype=torch.float64) tensor(0.9269, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3810, dtype=torch.float64) delta_t tensor(1.5118, dtype=torch.float64)
4 gae_duplicate tensor(1.1356, dtype=torch.float64) tensor(-2.8450, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4448, dtype=torch.float64) delta_t tensor(-0.1227, dtype=torch.float64)
3 gae_duplicate tensor(0.7858, dtype=torch.float64) tensor(-1.4820, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5758, dtype=torch.float64) delta_t tensor(-5.0608, dtype=torch.float64)
2 gae_duplicate tensor(-4.4322, dtype=torch.float64) tensor(9.2351, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:18.701168060302734
value loss:60.64533233642578
entropies:37.146697998046875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5928428173065186 seconds
19 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(-1.3667, dtype=torch.float64)
19 gae_duplicate tensor(-1.3667, dtype=torch.float64) tensor(3.2190, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(0.5693, dtype=torch.float64)
18 gae_duplicate tensor(-0.5241, dtype=torch.float64) tensor(1.2621, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.4236, dtype=torch.float64)
17 gae_duplicate tensor(0.0043, dtype=torch.float64) tensor(-0.0098, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(-0.1075, dtype=torch.float64)
16 gae_duplicate tensor(-0.1041, dtype=torch.float64) tensor(0.2168, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.5130, dtype=torch.float64)
15 gae_duplicate tensor(0.4298, dtype=torch.float64) tensor(-0.8919, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(0.7569, dtype=torch.float64)
14 gae_duplicate tensor(1.1007, dtype=torch.float64) tensor(-2.3027, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.5690, dtype=torch.float64)
13 gae_duplicate tensor(1.4496, dtype=torch.float64) tensor(-3.0084, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(0.4796, dtype=torch.float64)
12 gae_duplicate tensor(1.6393, dtype=torch.float64) tensor(-3.4157, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9024, dtype=torch.float64) delta_t tensor(-0.2704, dtype=torch.float64)
11 gae_duplicate tensor(1.0410, dtype=torch.float64) tensor(-2.0520, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9026, dtype=torch.float64) delta_t tensor(0.4216, dtype=torch.float64)
10 gae_duplicate tensor(1.2544, dtype=torch.float64) tensor(-2.7695, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9028, dtype=torch.float64) delta_t tensor(0.3265, dtype=torch.float64)
9 gae_duplicate tensor(1.3300, dtype=torch.float64) tensor(-2.6355, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.9030, dtype=torch.float64) delta_t tensor(0.2106, dtype=torch.float64)
8 gae_duplicate tensor(1.2747, dtype=torch.float64) tensor(-2.4347, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5747, dtype=torch.float64) delta_t tensor(-1.4101, dtype=torch.float64)
7 gae_duplicate tensor(-0.3904, dtype=torch.float64) tensor(0.8830, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1189, dtype=torch.float64) delta_t tensor(-1.6612, dtype=torch.float64)
6 gae_duplicate tensor(-1.9735, dtype=torch.float64) tensor(3.9994, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2496, dtype=torch.float64) delta_t tensor(0.7434, dtype=torch.float64)
5 gae_duplicate tensor(-0.8354, dtype=torch.float64) tensor(1.7406, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2716, dtype=torch.float64) delta_t tensor(0.3337, dtype=torch.float64)
4 gae_duplicate tensor(-0.3346, dtype=torch.float64) tensor(0.6181, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0543, dtype=torch.float64) delta_t tensor(0.5586, dtype=torch.float64)
3 gae_duplicate tensor(0.2909, dtype=torch.float64) tensor(-0.5576, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1198, dtype=torch.float64) delta_t tensor(-0.2986, dtype=torch.float64)
2 gae_duplicate tensor(-0.0659, dtype=torch.float64) tensor(0.1450, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:46.8452033996582
value loss:29.00250244140625
entropies:37.231842041015625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.248978853225708 seconds
19 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(-1.5543, dtype=torch.float64)
19 gae_duplicate tensor(-1.5543, dtype=torch.float64) tensor(3.2255, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(0.4100, dtype=torch.float64)
18 gae_duplicate tensor(-0.8334, dtype=torch.float64) tensor(1.7365, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.4102, dtype=torch.float64)
17 gae_duplicate tensor(-0.2565, dtype=torch.float64) tensor(0.5324, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8361, dtype=torch.float64) delta_t tensor(0.3955, dtype=torch.float64)
16 gae_duplicate tensor(0.1903, dtype=torch.float64) tensor(-0.3933, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7710, dtype=torch.float64) delta_t tensor(0.5165, dtype=torch.float64)
15 gae_duplicate tensor(0.6688, dtype=torch.float64) tensor(-1.5351, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6406, dtype=torch.float64) delta_t tensor(0.0380, dtype=torch.float64)
14 gae_duplicate tensor(0.5730, dtype=torch.float64) tensor(-1.3054, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5101, dtype=torch.float64) delta_t tensor(-0.5064, dtype=torch.float64)
13 gae_duplicate tensor(-0.0480, dtype=torch.float64) tensor(0.0904, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8366, dtype=torch.float64) delta_t tensor(0.1303, dtype=torch.float64)
12 gae_duplicate tensor(0.0919, dtype=torch.float64) tensor(-0.1710, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7715, dtype=torch.float64) delta_t tensor(0.1567, dtype=torch.float64)
11 gae_duplicate tensor(0.2302, dtype=torch.float64) tensor(-0.4298, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6411, dtype=torch.float64) delta_t tensor(0.1663, dtype=torch.float64)
10 gae_duplicate tensor(0.3504, dtype=torch.float64) tensor(-0.7971, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0767, dtype=torch.float64) delta_t tensor(-0.8878, dtype=torch.float64)
9 gae_duplicate tensor(-0.6074, dtype=torch.float64) tensor(1.1660, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4453, dtype=torch.float64) delta_t tensor(0.7071, dtype=torch.float64)
8 gae_duplicate tensor(0.2211, dtype=torch.float64) tensor(-0.4260, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9249, dtype=torch.float64) delta_t tensor(-0.9602, dtype=torch.float64)
7 gae_duplicate tensor(-0.7833, dtype=torch.float64) tensor(1.7432, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3379, dtype=torch.float64) delta_t tensor(-0.0131, dtype=torch.float64)
6 gae_duplicate tensor(-0.6397, dtype=torch.float64) tensor(1.1922, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7080, dtype=torch.float64) delta_t tensor(0.5156, dtype=torch.float64)
5 gae_duplicate tensor(0.0038, dtype=torch.float64) tensor(-0.0072, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3794, dtype=torch.float64) delta_t tensor(0.8563, dtype=torch.float64)
4 gae_duplicate tensor(0.8593, dtype=torch.float64) tensor(-1.6834, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2730, dtype=torch.float64) delta_t tensor(1.2549, dtype=torch.float64)
3 gae_duplicate tensor(1.9423, dtype=torch.float64) tensor(-3.8355, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4035, dtype=torch.float64) delta_t tensor(-1.5332, dtype=torch.float64)
2 gae_duplicate tensor(0.0206, dtype=torch.float64) tensor(-0.0412, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4.518378734588623
value loss:15.189868927001953
entropies:37.18549346923828
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.624651908874512 seconds
19 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(-1.3362, dtype=torch.float64)
19 gae_duplicate tensor(-1.3362, dtype=torch.float64) tensor(3.2267, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.4144, dtype=torch.float64)
18 gae_duplicate tensor(-0.6546, dtype=torch.float64) tensor(1.5596, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.6775, dtype=torch.float64)
17 gae_duplicate tensor(0.1538, dtype=torch.float64) tensor(-0.3464, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.2483, dtype=torch.float64)
16 gae_duplicate tensor(0.3713, dtype=torch.float64) tensor(-0.7706, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.5533, dtype=torch.float64)
15 gae_duplicate tensor(0.8503, dtype=torch.float64) tensor(-1.7719, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.4657, dtype=torch.float64)
14 gae_duplicate tensor(1.1459, dtype=torch.float64) tensor(-2.3780, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.2036, dtype=torch.float64)
13 gae_duplicate tensor(1.1203, dtype=torch.float64) tensor(-2.3345, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.3958, dtype=torch.float64)
12 gae_duplicate tensor(1.2920, dtype=torch.float64) tensor(-2.6923, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.0082, dtype=torch.float64)
11 gae_duplicate tensor(1.0418, dtype=torch.float64) tensor(-2.3658, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(-0.0158, dtype=torch.float64)
10 gae_duplicate tensor(0.8177, dtype=torch.float64) tensor(-1.9369, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.5734, dtype=torch.float64)
9 gae_duplicate tensor(1.2276, dtype=torch.float64) tensor(-2.2889, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0767, dtype=torch.float64) delta_t tensor(-0.2804, dtype=torch.float64)
8 gae_duplicate tensor(0.7016, dtype=torch.float64) tensor(-1.4004, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0538, dtype=torch.float64) delta_t tensor(0.5111, dtype=torch.float64)
7 gae_duplicate tensor(1.0723, dtype=torch.float64) tensor(-1.9541, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0555, dtype=torch.float64) delta_t tensor(-3.0423, dtype=torch.float64)
6 gae_duplicate tensor(-2.1844, dtype=torch.float64) tensor(4.1607, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1650, dtype=torch.float64) delta_t tensor(0.9133, dtype=torch.float64)
5 gae_duplicate tensor(-0.8342, dtype=torch.float64) tensor(1.5861, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2489, dtype=torch.float64) delta_t tensor(1.2826, dtype=torch.float64)
4 gae_duplicate tensor(0.6152, dtype=torch.float64) tensor(-1.5348, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6440, dtype=torch.float64) delta_t tensor(-0.0185, dtype=torch.float64)
3 gae_duplicate tensor(0.4736, dtype=torch.float64) tensor(-1.1203, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.9711, dtype=torch.float64) delta_t tensor(-0.2201, dtype=torch.float64)
2 gae_duplicate tensor(0.1588, dtype=torch.float64) tensor(-0.3309, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:75.04359436035156
value loss:27.502288818359375
entropies:37.05626678466797
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.326925039291382 seconds
19 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(-1.7506, dtype=torch.float64)
19 gae_duplicate tensor(-1.7506, dtype=torch.float64) tensor(3.4440, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(0.9858, dtype=torch.float64)
18 gae_duplicate tensor(-0.4146, dtype=torch.float64) tensor(0.7683, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.8125, dtype=torch.float64)
17 gae_duplicate tensor(0.4808, dtype=torch.float64) tensor(-1.1311, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.4451, dtype=torch.float64)
16 gae_duplicate tensor(0.8297, dtype=torch.float64) tensor(-1.5693, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(-0.2623, dtype=torch.float64)
15 gae_duplicate tensor(0.4015, dtype=torch.float64) tensor(-0.9231, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(1.2071, dtype=torch.float64)
14 gae_duplicate tensor(1.5283, dtype=torch.float64) tensor(-3.0730, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.4808, dtype=torch.float64)
13 gae_duplicate tensor(1.7034, dtype=torch.float64) tensor(-3.3907, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1836, dtype=torch.float64) delta_t tensor(2.9867, dtype=torch.float64)
12 gae_duplicate tensor(4.3494, dtype=torch.float64) tensor(-9.8569, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1183, dtype=torch.float64) delta_t tensor(-2.9560, dtype=torch.float64)
11 gae_duplicate tensor(0.5236, dtype=torch.float64) tensor(-1.0052, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0121, dtype=torch.float64) delta_t tensor(1.5922, dtype=torch.float64)
10 gae_duplicate tensor(2.0110, dtype=torch.float64) tensor(-3.7640, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2078, dtype=torch.float64) delta_t tensor(-2.0861, dtype=torch.float64)
9 gae_duplicate tensor(-0.4773, dtype=torch.float64) tensor(0.8621, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2730, dtype=torch.float64) delta_t tensor(-0.5650, dtype=torch.float64)
8 gae_duplicate tensor(-0.9468, dtype=torch.float64) tensor(2.1839, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3138, dtype=torch.float64) delta_t tensor(-0.3608, dtype=torch.float64)
7 gae_duplicate tensor(-1.1183, dtype=torch.float64) tensor(2.0170, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0773, dtype=torch.float64) delta_t tensor(-0.9951, dtype=torch.float64)
6 gae_duplicate tensor(-1.8897, dtype=torch.float64) tensor(3.4349, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9028, dtype=torch.float64) delta_t tensor(0.5430, dtype=torch.float64)
5 gae_duplicate tensor(-0.9688, dtype=torch.float64) tensor(2.1706, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5994, dtype=torch.float64) delta_t tensor(-2.1325, dtype=torch.float64)
4 gae_duplicate tensor(-2.9075, dtype=torch.float64) tensor(6.1944, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4707, dtype=torch.float64) delta_t tensor(1.5629, dtype=torch.float64)
3 gae_duplicate tensor(-0.7631, dtype=torch.float64) tensor(1.9985, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3401, dtype=torch.float64) delta_t tensor(0.2920, dtype=torch.float64)
2 gae_duplicate tensor(-0.3184, dtype=torch.float64) tensor(0.7551, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4.1980061531066895
value loss:73.21759033203125
entropies:36.956390380859375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.3196)
ToM Target loss= tensor(308.6664)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.415273904800415 seconds
19 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(-1.7457, dtype=torch.float64)
19 gae_duplicate tensor(-1.7457, dtype=torch.float64) tensor(3.2480, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(1.1242, dtype=torch.float64)
18 gae_duplicate tensor(-0.2724, dtype=torch.float64) tensor(0.5677, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.5217, dtype=torch.float64)
17 gae_duplicate tensor(0.3038, dtype=torch.float64) tensor(-0.6303, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.5219, dtype=torch.float64)
16 gae_duplicate tensor(0.7650, dtype=torch.float64) tensor(-1.5941, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.4110, dtype=torch.float64)
15 gae_duplicate tensor(1.0229, dtype=torch.float64) tensor(-2.1318, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(0.5001, dtype=torch.float64)
14 gae_duplicate tensor(1.3184, dtype=torch.float64) tensor(-2.7239, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(-0.3354, dtype=torch.float64)
13 gae_duplicate tensor(0.7194, dtype=torch.float64) tensor(-1.6902, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.5268, dtype=torch.float64)
12 gae_duplicate tensor(1.1023, dtype=torch.float64) tensor(-2.6017, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(0.3722, dtype=torch.float64)
11 gae_duplicate tensor(1.2541, dtype=torch.float64) tensor(-2.3333, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1184, dtype=torch.float64) delta_t tensor(-0.3499, dtype=torch.float64)
10 gae_duplicate tensor(0.6534, dtype=torch.float64) tensor(-1.2240, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6405, dtype=torch.float64) delta_t tensor(0.1474, dtype=torch.float64)
9 gae_duplicate tensor(0.6701, dtype=torch.float64) tensor(-1.2811, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2491, dtype=torch.float64) delta_t tensor(0.2891, dtype=torch.float64)
8 gae_duplicate tensor(0.8252, dtype=torch.float64) tensor(-1.4339, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2728, dtype=torch.float64) delta_t tensor(-1.3324, dtype=torch.float64)
7 gae_duplicate tensor(-0.6722, dtype=torch.float64) tensor(1.1619, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0556, dtype=torch.float64) delta_t tensor(-2.1493, dtype=torch.float64)
6 gae_duplicate tensor(-2.6871, dtype=torch.float64) tensor(5.0370, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5777, dtype=torch.float64) delta_t tensor(1.2859, dtype=torch.float64)
5 gae_duplicate tensor(-0.8637, dtype=torch.float64) tensor(1.5864, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4040, dtype=torch.float64) delta_t tensor(-0.5083, dtype=torch.float64)
4 gae_duplicate tensor(-1.1993, dtype=torch.float64) tensor(2.0851, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7741, dtype=torch.float64) delta_t tensor(0.4057, dtype=torch.float64)
3 gae_duplicate tensor(-0.5537, dtype=torch.float64) tensor(1.3491, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3834, dtype=torch.float64) delta_t tensor(-0.2863, dtype=torch.float64)
2 gae_duplicate tensor(-0.7293, dtype=torch.float64) tensor(1.5518, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:5.236985206604004
value loss:33.212120056152344
entropies:36.88493728637695
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.495131731033325 seconds
19 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(-2.0138, dtype=torch.float64)
19 gae_duplicate tensor(-2.0138, dtype=torch.float64) tensor(3.6497, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.6315, dtype=torch.float64)
18 gae_duplicate tensor(-0.9795, dtype=torch.float64) tensor(2.2566, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(1.0474, dtype=torch.float64)
17 gae_duplicate tensor(0.2638, dtype=torch.float64) tensor(-0.5522, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(0.5138, dtype=torch.float64)
16 gae_duplicate tensor(0.7248, dtype=torch.float64) tensor(-1.4974, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.5140, dtype=torch.float64)
15 gae_duplicate tensor(1.0938, dtype=torch.float64) tensor(-2.2795, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.5142, dtype=torch.float64)
14 gae_duplicate tensor(1.3892, dtype=torch.float64) tensor(-2.8952, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.4048, dtype=torch.float64)
13 gae_duplicate tensor(1.5162, dtype=torch.float64) tensor(-3.1597, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(-0.2508, dtype=torch.float64)
12 gae_duplicate tensor(0.9622, dtype=torch.float64) tensor(-2.2066, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.5299, dtype=torch.float64)
11 gae_duplicate tensor(1.2996, dtype=torch.float64) tensor(-2.9823, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.1942, dtype=torch.float64)
10 gae_duplicate tensor(1.2339, dtype=torch.float64) tensor(-2.3078, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2523, dtype=torch.float64) delta_t tensor(-1.7751, dtype=torch.float64)
9 gae_duplicate tensor(-0.7879, dtype=torch.float64) tensor(1.4748, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0778, dtype=torch.float64) delta_t tensor(0.0935, dtype=torch.float64)
8 gae_duplicate tensor(-0.5369, dtype=torch.float64) tensor(0.9344, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2485, dtype=torch.float64) delta_t tensor(0.2200, dtype=torch.float64)
7 gae_duplicate tensor(-0.2095, dtype=torch.float64) tensor(0.3650, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0527, dtype=torch.float64) delta_t tensor(-0.0420, dtype=torch.float64)
6 gae_duplicate tensor(-0.2096, dtype=torch.float64) tensor(0.3698, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6437, dtype=torch.float64) delta_t tensor(0.5673, dtype=torch.float64)
5 gae_duplicate tensor(0.3996, dtype=torch.float64) tensor(-1.0263, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3181, dtype=torch.float64) delta_t tensor(-0.4462, dtype=torch.float64)
4 gae_duplicate tensor(-0.1265, dtype=torch.float64) tensor(0.3416, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2743, dtype=torch.float64) delta_t tensor(1.1300, dtype=torch.float64)
3 gae_duplicate tensor(1.0288, dtype=torch.float64) tensor(-2.3658, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-2.0363, dtype=torch.float64) delta_t tensor(-0.5436, dtype=torch.float64)
2 gae_duplicate tensor(0.2795, dtype=torch.float64) tensor(-0.6513, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:74.09066009521484
value loss:26.222366333007812
entropies:36.78251647949219
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.45403790473938 seconds
19 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(-1.8729, dtype=torch.float64)
19 gae_duplicate tensor(-1.8729, dtype=torch.float64) tensor(3.9030, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.3198, dtype=torch.float64)
18 gae_duplicate tensor(-1.1785, dtype=torch.float64) tensor(2.5689, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.3140, dtype=torch.float64)
17 gae_duplicate tensor(-0.6288, dtype=torch.float64) tensor(1.3841, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.3612, dtype=torch.float64)
16 gae_duplicate tensor(-0.1418, dtype=torch.float64) tensor(0.3103, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.9468, dtype=torch.float64)
15 gae_duplicate tensor(0.8334, dtype=torch.float64) tensor(-1.9048, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(-0.1122, dtype=torch.float64)
14 gae_duplicate tensor(0.5545, dtype=torch.float64) tensor(-1.2251, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.2039, dtype=torch.float64)
13 gae_duplicate tensor(0.6475, dtype=torch.float64) tensor(-1.2855, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.9010, dtype=torch.float64)
12 gae_duplicate tensor(1.4190, dtype=torch.float64) tensor(-2.7003, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(-0.3382, dtype=torch.float64)
11 gae_duplicate tensor(0.7969, dtype=torch.float64) tensor(-1.5326, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1177, dtype=torch.float64) delta_t tensor(-0.4741, dtype=torch.float64)
10 gae_duplicate tensor(0.1635, dtype=torch.float64) tensor(-0.3184, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0781, dtype=torch.float64) delta_t tensor(-0.5064, dtype=torch.float64)
9 gae_duplicate tensor(-0.3756, dtype=torch.float64) tensor(0.8339, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2739, dtype=torch.float64) delta_t tensor(0.3938, dtype=torch.float64)
8 gae_duplicate tensor(0.0933, dtype=torch.float64) tensor(-0.1991, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2087, dtype=torch.float64) delta_t tensor(-0.1354, dtype=torch.float64)
7 gae_duplicate tensor(-0.0607, dtype=torch.float64) tensor(0.1524, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0130, dtype=torch.float64) delta_t tensor(-0.2691, dtype=torch.float64)
6 gae_duplicate tensor(-0.3177, dtype=torch.float64) tensor(0.5655, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1005, dtype=torch.float64) delta_t tensor(-3.9782, dtype=torch.float64)
5 gae_duplicate tensor(-4.2324, dtype=torch.float64) tensor(8.2857, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9713, dtype=torch.float64) delta_t tensor(1.0928, dtype=torch.float64)
4 gae_duplicate tensor(-2.2931, dtype=torch.float64) tensor(4.3540, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.7695, dtype=torch.float64) delta_t tensor(2.2351, dtype=torch.float64)
3 gae_duplicate tensor(0.4006, dtype=torch.float64) tensor(-0.6194, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3847, dtype=torch.float64) delta_t tensor(-2.0979, dtype=torch.float64)
2 gae_duplicate tensor(-1.7773, dtype=torch.float64) tensor(3.2850, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-96.25570678710938
value loss:54.230953216552734
entropies:37.00466537475586
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.283432960510254 seconds
19 rew tensor(0.5085, dtype=torch.float64) delta_t tensor(-1.4661, dtype=torch.float64)
19 gae_duplicate tensor(-1.4661, dtype=torch.float64) tensor(3.8146, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2473, dtype=torch.float64) delta_t tensor(0.1631, dtype=torch.float64)
18 gae_duplicate tensor(-1.0098, dtype=torch.float64) tensor(2.5319, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.4711, dtype=torch.float64) delta_t tensor(-1.3239, dtype=torch.float64)
17 gae_duplicate tensor(-2.1318, dtype=torch.float64) tensor(4.9922, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-1.7119, dtype=torch.float64) delta_t tensor(-1.6055, dtype=torch.float64)
16 gae_duplicate tensor(-3.3109, dtype=torch.float64) tensor(6.8996, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.3295, dtype=torch.float64)
15 gae_duplicate tensor(-2.3192, dtype=torch.float64) tensor(4.8329, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8349, dtype=torch.float64) delta_t tensor(0.4113, dtype=torch.float64)
14 gae_duplicate tensor(-1.4441, dtype=torch.float64) tensor(3.0093, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.2563, dtype=torch.float64)
13 gae_duplicate tensor(-0.8989, dtype=torch.float64) tensor(1.8653, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8353, dtype=torch.float64) delta_t tensor(0.2704, dtype=torch.float64)
12 gae_duplicate tensor(-0.4487, dtype=torch.float64) tensor(0.9391, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7048, dtype=torch.float64) delta_t tensor(0.2045, dtype=torch.float64)
11 gae_duplicate tensor(-0.1545, dtype=torch.float64) tensor(0.3759, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4437, dtype=torch.float64) delta_t tensor(-0.0649, dtype=torch.float64)
10 gae_duplicate tensor(-0.1885, dtype=torch.float64) tensor(0.4566, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7316, dtype=torch.float64) delta_t tensor(-1.2504, dtype=torch.float64)
9 gae_duplicate tensor(-1.4012, dtype=torch.float64) tensor(2.5591, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4436, dtype=torch.float64) delta_t tensor(0.0846, dtype=torch.float64)
8 gae_duplicate tensor(-1.0363, dtype=torch.float64) tensor(1.9248, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2746, dtype=torch.float64) delta_t tensor(-0.5575, dtype=torch.float64)
7 gae_duplicate tensor(-1.3865, dtype=torch.float64) tensor(2.6554, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4704, dtype=torch.float64) delta_t tensor(-0.8804, dtype=torch.float64)
6 gae_duplicate tensor(-1.9896, dtype=torch.float64) tensor(3.8318, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0372, dtype=torch.float64) delta_t tensor(-2.8936, dtype=torch.float64)
5 gae_duplicate tensor(-4.4853, dtype=torch.float64) tensor(9.7361, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5813, dtype=torch.float64) delta_t tensor(2.3961, dtype=torch.float64)
4 gae_duplicate tensor(-1.1921, dtype=torch.float64) tensor(2.3748, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3410, dtype=torch.float64) delta_t tensor(0.6538, dtype=torch.float64)
3 gae_duplicate tensor(-0.2999, dtype=torch.float64) tensor(0.6132, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3410, dtype=torch.float64) delta_t tensor(0.1685, dtype=torch.float64)
2 gae_duplicate tensor(-0.0714, dtype=torch.float64) tensor(0.1466, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-322.4667053222656
value loss:86.64036560058594
entropies:37.059749603271484
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.2506937980651855 seconds
19 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(-0.8992, dtype=torch.float64)
19 gae_duplicate tensor(-0.8992, dtype=torch.float64) tensor(1.8737, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.0746, dtype=torch.float64)
18 gae_duplicate tensor(-0.6448, dtype=torch.float64) tensor(1.4611, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.4899, dtype=torch.float64)
17 gae_duplicate tensor(-0.0259, dtype=torch.float64) tensor(0.0595, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(0.4638, dtype=torch.float64)
16 gae_duplicate tensor(0.4430, dtype=torch.float64) tensor(-0.8502, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.4113, dtype=torch.float64)
15 gae_duplicate tensor(0.7657, dtype=torch.float64) tensor(-1.4600, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.0451, dtype=torch.float64)
14 gae_duplicate tensor(0.6577, dtype=torch.float64) tensor(-1.2728, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.1982, dtype=torch.float64)
13 gae_duplicate tensor(0.7244, dtype=torch.float64) tensor(-1.4097, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.1674, dtype=torch.float64)
12 gae_duplicate tensor(0.7469, dtype=torch.float64) tensor(-1.4456, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7053, dtype=torch.float64) delta_t tensor(-0.0282, dtype=torch.float64)
11 gae_duplicate tensor(0.5693, dtype=torch.float64) tensor(-1.2922, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5750, dtype=torch.float64) delta_t tensor(-0.1862, dtype=torch.float64)
10 gae_duplicate tensor(0.2692, dtype=torch.float64) tensor(-0.6165, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7947, dtype=torch.float64) delta_t tensor(-1.4001, dtype=torch.float64)
9 gae_duplicate tensor(-1.1847, dtype=torch.float64) tensor(2.2587, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1426, dtype=torch.float64) delta_t tensor(0.1122, dtype=torch.float64)
8 gae_duplicate tensor(-0.8356, dtype=torch.float64) tensor(1.8688, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2730, dtype=torch.float64) delta_t tensor(-0.2984, dtype=torch.float64)
7 gae_duplicate tensor(-0.9669, dtype=torch.float64) tensor(2.1326, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9904, dtype=torch.float64) delta_t tensor(-1.4311, dtype=torch.float64)
6 gae_duplicate tensor(-2.2046, dtype=torch.float64) tensor(4.3103, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7079, dtype=torch.float64) delta_t tensor(-2.5605, dtype=torch.float64)
5 gae_duplicate tensor(-4.3241, dtype=torch.float64) tensor(9.2265, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.1872, dtype=torch.float64) delta_t tensor(0.0493, dtype=torch.float64)
4 gae_duplicate tensor(-3.4100, dtype=torch.float64) tensor(6.6378, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2099, dtype=torch.float64) delta_t tensor(1.1222, dtype=torch.float64)
3 gae_duplicate tensor(-1.6058, dtype=torch.float64) tensor(3.3321, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2753, dtype=torch.float64) delta_t tensor(0.6854, dtype=torch.float64)
2 gae_duplicate tensor(-0.5992, dtype=torch.float64) tensor(1.3209, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-157.92701721191406
value loss:67.61949157714844
entropies:37.23515319824219
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.7239)
ToM Target loss= tensor(309.7682)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.4712018966674805 seconds
19 rew tensor(0.7701, dtype=torch.float64) delta_t tensor(-1.8055, dtype=torch.float64)
19 gae_duplicate tensor(-1.8055, dtype=torch.float64) tensor(3.4225, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5743, dtype=torch.float64) delta_t tensor(0.3712, dtype=torch.float64)
18 gae_duplicate tensor(-1.0732, dtype=torch.float64) tensor(2.0204, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.1825, dtype=torch.float64) delta_t tensor(-0.1810, dtype=torch.float64)
17 gae_duplicate tensor(-1.0395, dtype=torch.float64) tensor(2.3368, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.3399, dtype=torch.float64) delta_t tensor(-1.3506, dtype=torch.float64)
16 gae_duplicate tensor(-2.1822, dtype=torch.float64) tensor(4.5467, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7702, dtype=torch.float64) delta_t tensor(0.2097, dtype=torch.float64)
15 gae_duplicate tensor(-1.5361, dtype=torch.float64) tensor(3.2011, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5091, dtype=torch.float64) delta_t tensor(0.1570, dtype=torch.float64)
14 gae_duplicate tensor(-1.0719, dtype=torch.float64) tensor(2.2337, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3133, dtype=torch.float64) delta_t tensor(0.5238, dtype=torch.float64)
13 gae_duplicate tensor(-0.3337, dtype=torch.float64) tensor(0.6924, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.5333, dtype=torch.float64)
12 gae_duplicate tensor(0.2663, dtype=torch.float64) tensor(-0.5550, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(-0.3743, dtype=torch.float64)
11 gae_duplicate tensor(-0.1612, dtype=torch.float64) tensor(0.3512, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8360, dtype=torch.float64) delta_t tensor(0.3601, dtype=torch.float64)
10 gae_duplicate tensor(0.2311, dtype=torch.float64) tensor(-0.5049, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4694, dtype=torch.float64) delta_t tensor(-1.0369, dtype=torch.float64)
9 gae_duplicate tensor(-0.8520, dtype=torch.float64) tensor(1.6896, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4695, dtype=torch.float64) delta_t tensor(-1.0682, dtype=torch.float64)
8 gae_duplicate tensor(-1.7499, dtype=torch.float64) tensor(3.2652, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7306, dtype=torch.float64) delta_t tensor(-1.4880, dtype=torch.float64)
7 gae_duplicate tensor(-2.8879, dtype=torch.float64) tensor(7.0901, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9266, dtype=torch.float64) delta_t tensor(-0.8093, dtype=torch.float64)
6 gae_duplicate tensor(-3.1196, dtype=torch.float64) tensor(5.8279, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4489, dtype=torch.float64) delta_t tensor(-2.4167, dtype=torch.float64)
5 gae_duplicate tensor(-4.9124, dtype=torch.float64) tensor(9.6721, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2477, dtype=torch.float64) delta_t tensor(4.4466, dtype=torch.float64)
4 gae_duplicate tensor(0.5167, dtype=torch.float64) tensor(-0.9714, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6007, dtype=torch.float64) delta_t tensor(-0.0442, dtype=torch.float64)
3 gae_duplicate tensor(0.3691, dtype=torch.float64) tensor(-0.8291, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5356, dtype=torch.float64) delta_t tensor(1.1897, dtype=torch.float64)
2 gae_duplicate tensor(1.4850, dtype=torch.float64) tensor(-3.0683, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-243.6421356201172
value loss:93.93645477294922
entropies:37.213958740234375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.331990957260132 seconds
19 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(-1.2791, dtype=torch.float64)
19 gae_duplicate tensor(-1.2791, dtype=torch.float64) tensor(2.6428, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8353, dtype=torch.float64) delta_t tensor(0.3146, dtype=torch.float64)
18 gae_duplicate tensor(-0.7086, dtype=torch.float64) tensor(1.4767, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(0.4479, dtype=torch.float64)
17 gae_duplicate tensor(-0.1190, dtype=torch.float64) tensor(0.2480, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(0.4481, dtype=torch.float64)
16 gae_duplicate tensor(0.3529, dtype=torch.float64) tensor(-0.7323, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7705, dtype=torch.float64) delta_t tensor(-0.1363, dtype=torch.float64)
15 gae_duplicate tensor(0.1461, dtype=torch.float64) tensor(-0.3137, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7706, dtype=torch.float64) delta_t tensor(0.2534, dtype=torch.float64)
14 gae_duplicate tensor(0.3703, dtype=torch.float64) tensor(-0.7916, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7708, dtype=torch.float64) delta_t tensor(0.1387, dtype=torch.float64)
13 gae_duplicate tensor(0.4350, dtype=torch.float64) tensor(-0.9278, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.3445, dtype=torch.float64)
12 gae_duplicate tensor(0.6924, dtype=torch.float64) tensor(-1.4109, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4047, dtype=torch.float64) delta_t tensor(-0.9617, dtype=torch.float64)
11 gae_duplicate tensor(-0.4078, dtype=torch.float64) tensor(0.8237, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5353, dtype=torch.float64) delta_t tensor(-1.1954, dtype=torch.float64)
10 gae_duplicate tensor(-1.5216, dtype=torch.float64) tensor(3.0965, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4442, dtype=torch.float64) delta_t tensor(0.0677, dtype=torch.float64)
9 gae_duplicate tensor(-1.1496, dtype=torch.float64) tensor(2.3988, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0782, dtype=torch.float64) delta_t tensor(0.5731, dtype=torch.float64)
8 gae_duplicate tensor(-0.3465, dtype=torch.float64) tensor(0.7160, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8617, dtype=torch.float64) delta_t tensor(-0.2483, dtype=torch.float64)
7 gae_duplicate tensor(-0.5255, dtype=torch.float64) tensor(1.1567, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6399, dtype=torch.float64) delta_t tensor(1.4460, dtype=torch.float64)
6 gae_duplicate tensor(1.0256, dtype=torch.float64) tensor(-1.8716, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.5592, dtype=torch.float64) delta_t tensor(-0.9274, dtype=torch.float64)
5 gae_duplicate tensor(-0.1069, dtype=torch.float64) tensor(0.2636, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7704, dtype=torch.float64) delta_t tensor(0.9496, dtype=torch.float64)
4 gae_duplicate tensor(0.8641, dtype=torch.float64) tensor(-1.3442, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8425, dtype=torch.float64) delta_t tensor(-2.1927, dtype=torch.float64)
3 gae_duplicate tensor(-1.5014, dtype=torch.float64) tensor(2.9196, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1169, dtype=torch.float64) delta_t tensor(-2.7611, dtype=torch.float64)
2 gae_duplicate tensor(-3.9622, dtype=torch.float64) tensor(8.6666, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-103.21614074707031
value loss:40.59962463378906
entropies:37.1456298828125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.653424024581909 seconds
19 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(-1.1021, dtype=torch.float64)
19 gae_duplicate tensor(-1.1021, dtype=torch.float64) tensor(2.5654, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.4975, dtype=torch.float64)
18 gae_duplicate tensor(-0.3842, dtype=torch.float64) tensor(0.7261, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.5125, dtype=torch.float64)
17 gae_duplicate tensor(0.2051, dtype=torch.float64) tensor(-0.3966, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(-0.1280, dtype=torch.float64)
16 gae_duplicate tensor(0.0361, dtype=torch.float64) tensor(-0.0739, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(1.0364, dtype=torch.float64)
15 gae_duplicate tensor(1.0653, dtype=torch.float64) tensor(-2.2106, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.5087, dtype=torch.float64)
14 gae_duplicate tensor(1.3610, dtype=torch.float64) tensor(-2.8240, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(-0.2851, dtype=torch.float64)
13 gae_duplicate tensor(0.8036, dtype=torch.float64) tensor(-1.6676, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.3591, dtype=torch.float64)
12 gae_duplicate tensor(1.0020, dtype=torch.float64) tensor(-2.0882, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(0.3522, dtype=torch.float64)
11 gae_duplicate tensor(1.1539, dtype=torch.float64) tensor(-2.3943, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7712, dtype=torch.float64) delta_t tensor(-0.0544, dtype=torch.float64)
10 gae_duplicate tensor(0.8687, dtype=torch.float64) tensor(-1.6707, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3792, dtype=torch.float64) delta_t tensor(-0.0450, dtype=torch.float64)
9 gae_duplicate tensor(0.6500, dtype=torch.float64) tensor(-1.5031, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0782, dtype=torch.float64) delta_t tensor(0.2522, dtype=torch.float64)
8 gae_duplicate tensor(0.7722, dtype=torch.float64) tensor(-1.4122, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7970, dtype=torch.float64) delta_t tensor(-1.6374, dtype=torch.float64)
7 gae_duplicate tensor(-1.0196, dtype=torch.float64) tensor(1.8230, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5159, dtype=torch.float64) delta_t tensor(-0.2797, dtype=torch.float64)
6 gae_duplicate tensor(-1.0954, dtype=torch.float64) tensor(1.9641, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7323, dtype=torch.float64) delta_t tensor(1.0848, dtype=torch.float64)
5 gae_duplicate tensor(0.2085, dtype=torch.float64) tensor(-0.3495, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0136, dtype=torch.float64) delta_t tensor(0.5576, dtype=torch.float64)
4 gae_duplicate tensor(0.7244, dtype=torch.float64) tensor(-1.9816, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9284, dtype=torch.float64) delta_t tensor(-0.4767, dtype=torch.float64)
3 gae_duplicate tensor(0.1028, dtype=torch.float64) tensor(-0.1871, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4513, dtype=torch.float64) delta_t tensor(-0.1518, dtype=torch.float64)
2 gae_duplicate tensor(-0.0696, dtype=torch.float64) tensor(0.1493, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:68.08098602294922
value loss:17.95597267150879
entropies:36.94356155395508
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.348105192184448 seconds
19 rew tensor(0.4436, dtype=torch.float64) delta_t tensor(-1.8612, dtype=torch.float64)
19 gae_duplicate tensor(-1.8612, dtype=torch.float64) tensor(3.4489, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.1448, dtype=torch.float64) delta_t tensor(-0.6168, dtype=torch.float64)
18 gae_duplicate tensor(-2.1058, dtype=torch.float64) tensor(4.7855, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-1.0602, dtype=torch.float64) delta_t tensor(-1.1973, dtype=torch.float64)
17 gae_duplicate tensor(-2.8819, dtype=torch.float64) tensor(6.0057, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(0.3362, dtype=torch.float64)
16 gae_duplicate tensor(-1.9693, dtype=torch.float64) tensor(4.1216, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8358, dtype=torch.float64) delta_t tensor(0.2061, dtype=torch.float64)
15 gae_duplicate tensor(-1.3693, dtype=torch.float64) tensor(2.8536, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7706, dtype=torch.float64) delta_t tensor(0.2860, dtype=torch.float64)
14 gae_duplicate tensor(-0.8095, dtype=torch.float64) tensor(1.6870, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8361, dtype=torch.float64) delta_t tensor(0.4916, dtype=torch.float64)
13 gae_duplicate tensor(-0.1560, dtype=torch.float64) tensor(0.3238, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7709, dtype=torch.float64) delta_t tensor(-0.3175, dtype=torch.float64)
12 gae_duplicate tensor(-0.4423, dtype=torch.float64) tensor(0.9979, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8364, dtype=torch.float64) delta_t tensor(0.2786, dtype=torch.float64)
11 gae_duplicate tensor(-0.0753, dtype=torch.float64) tensor(0.1695, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(0.2727, dtype=torch.float64)
10 gae_duplicate tensor(0.2125, dtype=torch.float64) tensor(-0.4059, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6667, dtype=torch.float64) delta_t tensor(-1.2357, dtype=torch.float64)
9 gae_duplicate tensor(-1.0657, dtype=torch.float64) tensor(2.0597, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0785, dtype=torch.float64) delta_t tensor(-0.7879, dtype=torch.float64)
8 gae_duplicate tensor(-1.6404, dtype=torch.float64) tensor(3.6508, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7321, dtype=torch.float64) delta_t tensor(-0.9579, dtype=torch.float64)
7 gae_duplicate tensor(-2.2703, dtype=torch.float64) tensor(4.9560, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1243, dtype=torch.float64) delta_t tensor(-0.6296, dtype=torch.float64)
6 gae_duplicate tensor(-2.4458, dtype=torch.float64) tensor(5.1900, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1702, dtype=torch.float64) delta_t tensor(-1.3379, dtype=torch.float64)
5 gae_duplicate tensor(-3.2946, dtype=torch.float64) tensor(6.8361, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8447, dtype=torch.float64) delta_t tensor(0.5929, dtype=torch.float64)
4 gae_duplicate tensor(-2.0427, dtype=torch.float64) tensor(4.4282, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4723, dtype=torch.float64) delta_t tensor(0.4516, dtype=torch.float64)
3 gae_duplicate tensor(-1.1826, dtype=torch.float64) tensor(2.6246, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5378, dtype=torch.float64) delta_t tensor(-1.5801, dtype=torch.float64)
2 gae_duplicate tensor(-2.5262, dtype=torch.float64) tensor(4.8194, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-352.43115234375
value loss:90.98033905029297
entropies:37.2836799621582
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.519167184829712 seconds
19 rew tensor(0.6410, dtype=torch.float64) delta_t tensor(-1.5433, dtype=torch.float64)
19 gae_duplicate tensor(-1.5433, dtype=torch.float64) tensor(3.7713, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5756, dtype=torch.float64) delta_t tensor(0.0810, dtype=torch.float64)
18 gae_duplicate tensor(-1.1536, dtype=torch.float64) tensor(2.1329, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.1832, dtype=torch.float64) delta_t tensor(-0.1532, dtype=torch.float64)
17 gae_duplicate tensor(-1.0761, dtype=torch.float64) tensor(2.0385, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.6019, dtype=torch.float64) delta_t tensor(-1.5190, dtype=torch.float64)
16 gae_duplicate tensor(-2.3799, dtype=torch.float64) tensor(5.0589, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7064, dtype=torch.float64) delta_t tensor(0.2364, dtype=torch.float64)
15 gae_duplicate tensor(-1.6675, dtype=torch.float64) tensor(3.5495, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7065, dtype=torch.float64) delta_t tensor(0.3432, dtype=torch.float64)
14 gae_duplicate tensor(-0.9907, dtype=torch.float64) tensor(2.0247, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4450, dtype=torch.float64) delta_t tensor(0.2687, dtype=torch.float64)
13 gae_duplicate tensor(-0.5239, dtype=torch.float64) tensor(1.0919, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8375, dtype=torch.float64) delta_t tensor(0.3472, dtype=torch.float64)
12 gae_duplicate tensor(-0.0719, dtype=torch.float64) tensor(0.1505, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9030, dtype=torch.float64) delta_t tensor(-0.0909, dtype=torch.float64)
11 gae_duplicate tensor(-0.1484, dtype=torch.float64) tensor(0.2811, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7724, dtype=torch.float64) delta_t tensor(0.2084, dtype=torch.float64)
10 gae_duplicate tensor(0.0897, dtype=torch.float64) tensor(-0.2053, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4700, dtype=torch.float64) delta_t tensor(-1.0992, dtype=torch.float64)
9 gae_duplicate tensor(-1.0275, dtype=torch.float64) tensor(2.3649, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6662, dtype=torch.float64) delta_t tensor(-0.0776, dtype=torch.float64)
8 gae_duplicate tensor(-0.8996, dtype=torch.float64) tensor(2.3136, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5818, dtype=torch.float64) delta_t tensor(-1.9291, dtype=torch.float64)
7 gae_duplicate tensor(-2.6488, dtype=torch.float64) tensor(7.0922, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2554, dtype=torch.float64) delta_t tensor(-0.4964, dtype=torch.float64)
6 gae_duplicate tensor(-2.6154, dtype=torch.float64) tensor(4.4472, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4055, dtype=torch.float64) delta_t tensor(0.7719, dtype=torch.float64)
5 gae_duplicate tensor(-1.3205, dtype=torch.float64) tensor(3.3539, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7789, dtype=torch.float64) delta_t tensor(-1.0180, dtype=torch.float64)
4 gae_duplicate tensor(-2.0743, dtype=torch.float64) tensor(3.6669, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5369, dtype=torch.float64) delta_t tensor(0.5945, dtype=torch.float64)
3 gae_duplicate tensor(-1.0650, dtype=torch.float64) tensor(2.0242, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5370, dtype=torch.float64) delta_t tensor(0.5457, dtype=torch.float64)
2 gae_duplicate tensor(-0.3062, dtype=torch.float64) tensor(0.6088, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-275.6975402832031
value loss:56.40306091308594
entropies:36.785308837890625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.5982)
ToM Target loss= tensor(310.4214)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.472535133361816 seconds
19 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(-1.4396, dtype=torch.float64)
19 gae_duplicate tensor(-1.4396, dtype=torch.float64) tensor(3.1029, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.4328, dtype=torch.float64)
18 gae_duplicate tensor(-0.7188, dtype=torch.float64) tensor(1.4441, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.4330, dtype=torch.float64)
17 gae_duplicate tensor(-0.1421, dtype=torch.float64) tensor(0.2841, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.5851, dtype=torch.float64)
16 gae_duplicate tensor(0.4715, dtype=torch.float64) tensor(-0.8564, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.4236, dtype=torch.float64)
15 gae_duplicate tensor(0.8008, dtype=torch.float64) tensor(-1.9344, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(-0.0198, dtype=torch.float64)
14 gae_duplicate tensor(0.6208, dtype=torch.float64) tensor(-1.1323, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(0.2539, dtype=torch.float64)
13 gae_duplicate tensor(0.7506, dtype=torch.float64) tensor(-1.3985, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.3397, dtype=torch.float64)
12 gae_duplicate tensor(0.9402, dtype=torch.float64) tensor(-1.7345, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(0.3399, dtype=torch.float64)
11 gae_duplicate tensor(1.0921, dtype=torch.float64) tensor(-2.5892, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9024, dtype=torch.float64) delta_t tensor(0.1779, dtype=torch.float64)
10 gae_duplicate tensor(1.0515, dtype=torch.float64) tensor(-2.5026, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9025, dtype=torch.float64) delta_t tensor(0.0422, dtype=torch.float64)
9 gae_duplicate tensor(0.8834, dtype=torch.float64) tensor(-1.6309, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8599, dtype=torch.float64) delta_t tensor(-0.7581, dtype=torch.float64)
8 gae_duplicate tensor(-0.0514, dtype=torch.float64) tensor(0.0954, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5781, dtype=torch.float64) delta_t tensor(-1.7047, dtype=torch.float64)
7 gae_duplicate tensor(-1.7458, dtype=torch.float64) tensor(4.1180, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5341, dtype=torch.float64) delta_t tensor(-0.7069, dtype=torch.float64)
6 gae_duplicate tensor(-2.1035, dtype=torch.float64) tensor(4.0458, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7093, dtype=torch.float64) delta_t tensor(-2.3994, dtype=torch.float64)
5 gae_duplicate tensor(-4.0823, dtype=torch.float64) tensor(8.6724, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.8445, dtype=torch.float64) delta_t tensor(-0.6451, dtype=torch.float64)
4 gae_duplicate tensor(-3.9109, dtype=torch.float64) tensor(8.8550, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0134, dtype=torch.float64) delta_t tensor(0.7584, dtype=torch.float64)
3 gae_duplicate tensor(-2.3703, dtype=torch.float64) tensor(5.0236, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0520, dtype=torch.float64) delta_t tensor(0.9826, dtype=torch.float64)
2 gae_duplicate tensor(-0.9136, dtype=torch.float64) tensor(1.7232, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-142.62461853027344
value loss:81.40961456298828
entropies:37.00557327270508
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.55405592918396 seconds
19 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(-1.3470, dtype=torch.float64)
19 gae_duplicate tensor(-1.3470, dtype=torch.float64) tensor(2.6805, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.4519, dtype=torch.float64)
18 gae_duplicate tensor(-0.6256, dtype=torch.float64) tensor(1.3757, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(0.5259, dtype=torch.float64)
17 gae_duplicate tensor(0.0254, dtype=torch.float64) tensor(-0.0552, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.4671, dtype=torch.float64)
16 gae_duplicate tensor(0.4873, dtype=torch.float64) tensor(-0.9648, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(0.5393, dtype=torch.float64)
15 gae_duplicate tensor(0.9292, dtype=torch.float64) tensor(-1.8568, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9024, dtype=torch.float64) delta_t tensor(0.2855, dtype=torch.float64)
14 gae_duplicate tensor(1.0288, dtype=torch.float64) tensor(-2.2616, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9026, dtype=torch.float64) delta_t tensor(0.5219, dtype=torch.float64)
13 gae_duplicate tensor(1.3450, dtype=torch.float64) tensor(-2.5939, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1190, dtype=torch.float64) delta_t tensor(-0.4076, dtype=torch.float64)
12 gae_duplicate tensor(0.6684, dtype=torch.float64) tensor(-1.3080, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1843, dtype=torch.float64) delta_t tensor(1.7588, dtype=torch.float64)
11 gae_duplicate tensor(2.2935, dtype=torch.float64) tensor(-4.5180, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1190, dtype=torch.float64) delta_t tensor(-1.9299, dtype=torch.float64)
10 gae_duplicate tensor(-0.0951, dtype=torch.float64) tensor(0.1636, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8604, dtype=torch.float64) delta_t tensor(-1.5562, dtype=torch.float64)
9 gae_duplicate tensor(-1.6323, dtype=torch.float64) tensor(2.8080, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7952, dtype=torch.float64) delta_t tensor(-0.9620, dtype=torch.float64)
8 gae_duplicate tensor(-2.2678, dtype=torch.float64) tensor(3.9487, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7301, dtype=torch.float64) delta_t tensor(-1.5273, dtype=torch.float64)
7 gae_duplicate tensor(-3.3416, dtype=torch.float64) tensor(8.8893, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.9706, dtype=torch.float64) delta_t tensor(-1.6654, dtype=torch.float64)
6 gae_duplicate tensor(-4.3386, dtype=torch.float64) tensor(12.2096, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7309, dtype=torch.float64) delta_t tensor(1.0703, dtype=torch.float64)
5 gae_duplicate tensor(-2.4006, dtype=torch.float64) tensor(6.7188, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2534, dtype=torch.float64) delta_t tensor(-0.3051, dtype=torch.float64)
4 gae_duplicate tensor(-2.2256, dtype=torch.float64) tensor(4.0838, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5748, dtype=torch.float64) delta_t tensor(1.7515, dtype=torch.float64)
3 gae_duplicate tensor(-0.0290, dtype=torch.float64) tensor(0.0568, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8618, dtype=torch.float64) delta_t tensor(-0.1738, dtype=torch.float64)
2 gae_duplicate tensor(-0.1970, dtype=torch.float64) tensor(0.3489, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-179.44598388671875
value loss:90.66556549072266
entropies:36.445369720458984
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.365221738815308 seconds
19 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(-0.8486, dtype=torch.float64)
19 gae_duplicate tensor(-0.8486, dtype=torch.float64) tensor(1.9277, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.6448, dtype=torch.float64)
18 gae_duplicate tensor(-0.0342, dtype=torch.float64) tensor(0.0779, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.5695, dtype=torch.float64)
17 gae_duplicate tensor(0.5422, dtype=torch.float64) tensor(-1.2318, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(-0.1225, dtype=torch.float64)
16 gae_duplicate tensor(0.3113, dtype=torch.float64) tensor(-0.7392, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.6347, dtype=torch.float64)
15 gae_duplicate tensor(0.8837, dtype=torch.float64) tensor(-1.6297, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.4723, dtype=torch.float64)
14 gae_duplicate tensor(1.1792, dtype=torch.float64) tensor(-2.1630, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.5726, dtype=torch.float64)
13 gae_duplicate tensor(1.5160, dtype=torch.float64) tensor(-2.7918, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3796, dtype=torch.float64) delta_t tensor(0.9584, dtype=torch.float64)
12 gae_duplicate tensor(2.1712, dtype=torch.float64) tensor(-3.8797, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2493, dtype=torch.float64) delta_t tensor(-1.4970, dtype=torch.float64)
11 gae_duplicate tensor(0.2400, dtype=torch.float64) tensor(-0.4179, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0538, dtype=torch.float64) delta_t tensor(-0.6241, dtype=torch.float64)
10 gae_duplicate tensor(-0.4321, dtype=torch.float64) tensor(0.7343, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2070, dtype=torch.float64) delta_t tensor(-0.6562, dtype=torch.float64)
9 gae_duplicate tensor(-1.0019, dtype=torch.float64) tensor(2.7154, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2070, dtype=torch.float64) delta_t tensor(-1.0321, dtype=torch.float64)
8 gae_duplicate tensor(-1.8336, dtype=torch.float64) tensor(3.1786, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5980, dtype=torch.float64) delta_t tensor(-0.2570, dtype=torch.float64)
7 gae_duplicate tensor(-1.7239, dtype=torch.float64) tensor(4.4042, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5329, dtype=torch.float64) delta_t tensor(-1.4907, dtype=torch.float64)
6 gae_duplicate tensor(-2.8698, dtype=torch.float64) tensor(7.1503, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1194, dtype=torch.float64) delta_t tensor(-1.0944, dtype=torch.float64)
5 gae_duplicate tensor(-3.3902, dtype=torch.float64) tensor(7.9633, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.2247, dtype=torch.float64) delta_t tensor(-1.2544, dtype=torch.float64)
4 gae_duplicate tensor(-3.9666, dtype=torch.float64) tensor(7.2712, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1175, dtype=torch.float64) delta_t tensor(-2.1947, dtype=torch.float64)
3 gae_duplicate tensor(-5.3679, dtype=torch.float64) tensor(13.1665, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1828, dtype=torch.float64) delta_t tensor(3.2567, dtype=torch.float64)
2 gae_duplicate tensor(-1.0377, dtype=torch.float64) tensor(2.2052, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-228.744873046875
value loss:124.8490219116211
entropies:36.5335578918457
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.553431034088135 seconds
19 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(-1.3684, dtype=torch.float64)
19 gae_duplicate tensor(-1.3684, dtype=torch.float64) tensor(2.5666, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(-0.1693, dtype=torch.float64)
18 gae_duplicate tensor(-1.2640, dtype=torch.float64) tensor(2.1318, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8352, dtype=torch.float64) delta_t tensor(0.3930, dtype=torch.float64)
17 gae_duplicate tensor(-0.6182, dtype=torch.float64) tensor(1.6871, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8354, dtype=torch.float64) delta_t tensor(0.2882, dtype=torch.float64)
16 gae_duplicate tensor(-0.2064, dtype=torch.float64) tensor(0.3502, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7703, dtype=torch.float64) delta_t tensor(0.2540, dtype=torch.float64)
15 gae_duplicate tensor(0.0889, dtype=torch.float64) tensor(-0.1499, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7053, dtype=torch.float64) delta_t tensor(0.1718, dtype=torch.float64)
14 gae_duplicate tensor(0.2429, dtype=torch.float64) tensor(-0.4121, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5099, dtype=torch.float64) delta_t tensor(-0.2593, dtype=torch.float64)
13 gae_duplicate tensor(-0.0650, dtype=torch.float64) tensor(0.1107, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(-0.1132, dtype=torch.float64)
12 gae_duplicate tensor(-0.1652, dtype=torch.float64) tensor(0.2787, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4673, dtype=torch.float64) delta_t tensor(-1.3929, dtype=torch.float64)
11 gae_duplicate tensor(-1.5251, dtype=torch.float64) tensor(2.4919, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5326, dtype=torch.float64) delta_t tensor(-1.2604, dtype=torch.float64)
10 gae_duplicate tensor(-2.4805, dtype=torch.float64) tensor(6.8782, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5099, dtype=torch.float64) delta_t tensor(-0.1633, dtype=torch.float64)
9 gae_duplicate tensor(-2.1477, dtype=torch.float64) tensor(3.5877, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0113, dtype=torch.float64) delta_t tensor(1.0012, dtype=torch.float64)
8 gae_duplicate tensor(-0.7170, dtype=torch.float64) tensor(1.2167, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7053, dtype=torch.float64) delta_t tensor(0.6284, dtype=torch.float64)
7 gae_duplicate tensor(0.0548, dtype=torch.float64) tensor(-0.1363, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.2258, dtype=torch.float64) delta_t tensor(-0.2437, dtype=torch.float64)
6 gae_duplicate tensor(-0.1999, dtype=torch.float64) tensor(0.3349, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9015, dtype=torch.float64) delta_t tensor(-0.8611, dtype=torch.float64)
5 gae_duplicate tensor(-1.0210, dtype=torch.float64) tensor(1.5995, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7291, dtype=torch.float64) delta_t tensor(-0.1415, dtype=torch.float64)
4 gae_duplicate tensor(-0.9582, dtype=torch.float64) tensor(2.8961, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.7499, dtype=torch.float64) delta_t tensor(-1.7092, dtype=torch.float64)
3 gae_duplicate tensor(-2.4758, dtype=torch.float64) tensor(4.7933, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2738, dtype=torch.float64) delta_t tensor(-1.3864, dtype=torch.float64)
2 gae_duplicate tensor(-3.3671, dtype=torch.float64) tensor(5.7626, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-216.98728942871094
value loss:55.60436248779297
entropies:35.39217758178711
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.457822799682617 seconds
19 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(-1.2160, dtype=torch.float64)
19 gae_duplicate tensor(-1.2160, dtype=torch.float64) tensor(1.8667, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.6953, dtype=torch.float64)
18 gae_duplicate tensor(-0.2775, dtype=torch.float64) tensor(0.4437, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.4221, dtype=torch.float64)
17 gae_duplicate tensor(0.2001, dtype=torch.float64) tensor(-0.3336, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(-0.2554, dtype=torch.float64)
16 gae_duplicate tensor(-0.0953, dtype=torch.float64) tensor(0.2409, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.3933, dtype=torch.float64)
15 gae_duplicate tensor(0.3171, dtype=torch.float64) tensor(-0.8008, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.1993, dtype=torch.float64)
14 gae_duplicate tensor(0.4530, dtype=torch.float64) tensor(-0.7937, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.4654, dtype=torch.float64)
13 gae_duplicate tensor(0.8278, dtype=torch.float64) tensor(-2.1202, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.3800, dtype=torch.float64)
12 gae_duplicate tensor(1.0422, dtype=torch.float64) tensor(-1.8398, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(0.1910, dtype=torch.float64)
11 gae_duplicate tensor(1.0248, dtype=torch.float64) tensor(-1.7194, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.7367, dtype=torch.float64)
10 gae_duplicate tensor(1.5566, dtype=torch.float64) tensor(-4.3177, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3151, dtype=torch.float64) delta_t tensor(-1.3178, dtype=torch.float64)
9 gae_duplicate tensor(-0.0725, dtype=torch.float64) tensor(0.1120, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0758, dtype=torch.float64) delta_t tensor(-0.6342, dtype=torch.float64)
8 gae_duplicate tensor(-0.6922, dtype=torch.float64) tensor(1.1917, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9229, dtype=torch.float64) delta_t tensor(0.7497, dtype=torch.float64)
7 gae_duplicate tensor(0.1959, dtype=torch.float64) tensor(-0.3287, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5321, dtype=torch.float64) delta_t tensor(-0.8411, dtype=torch.float64)
6 gae_duplicate tensor(-0.6844, dtype=torch.float64) tensor(1.7545, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5746, dtype=torch.float64) delta_t tensor(-0.3946, dtype=torch.float64)
5 gae_duplicate tensor(-0.9421, dtype=torch.float64) tensor(2.5909, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2920, dtype=torch.float64) delta_t tensor(-1.6141, dtype=torch.float64)
4 gae_duplicate tensor(-2.3677, dtype=torch.float64) tensor(6.1113, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7942, dtype=torch.float64) delta_t tensor(1.4793, dtype=torch.float64)
3 gae_duplicate tensor(-0.4149, dtype=torch.float64) tensor(1.0854, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5766, dtype=torch.float64) delta_t tensor(-0.3774, dtype=torch.float64)
2 gae_duplicate tensor(-0.7092, dtype=torch.float64) tensor(1.2163, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-27.222681045532227
value loss:22.972280502319336
entropies:35.48833084106445
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.2294)
ToM Target loss= tensor(310.1262)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.423912048339844 seconds
19 rew tensor(0.1835, dtype=torch.float64) delta_t tensor(-1.8330, dtype=torch.float64)
19 gae_duplicate tensor(-1.8330, dtype=torch.float64) tensor(2.7352, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.5332, dtype=torch.float64) delta_t tensor(-1.0921, dtype=torch.float64)
18 gae_duplicate tensor(-2.5585, dtype=torch.float64) tensor(4.5631, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-1.9014, dtype=torch.float64) delta_t tensor(-1.7567, dtype=torch.float64)
17 gae_duplicate tensor(-3.8035, dtype=torch.float64) tensor(9.6416, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8347, dtype=torch.float64) delta_t tensor(0.5098, dtype=torch.float64)
16 gae_duplicate tensor(-2.5330, dtype=torch.float64) tensor(6.4197, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.5801, dtype=torch.float64)
15 gae_duplicate tensor(-1.4463, dtype=torch.float64) tensor(2.5520, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.4708, dtype=torch.float64)
14 gae_duplicate tensor(-0.6862, dtype=torch.float64) tensor(1.7644, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8352, dtype=torch.float64) delta_t tensor(0.4557, dtype=torch.float64)
13 gae_duplicate tensor(-0.0932, dtype=torch.float64) tensor(0.2419, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.1044, dtype=torch.float64)
12 gae_duplicate tensor(0.0298, dtype=torch.float64) tensor(-0.0541, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8355, dtype=torch.float64) delta_t tensor(0.4150, dtype=torch.float64)
11 gae_duplicate tensor(0.4389, dtype=torch.float64) tensor(-1.2768, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8357, dtype=torch.float64) delta_t tensor(0.4037, dtype=torch.float64)
10 gae_duplicate tensor(0.7548, dtype=torch.float64) tensor(-1.4110, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4672, dtype=torch.float64) delta_t tensor(-1.5001, dtype=torch.float64)
9 gae_duplicate tensor(-0.8962, dtype=torch.float64) tensor(1.5777, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5976, dtype=torch.float64) delta_t tensor(-0.9122, dtype=torch.float64)
8 gae_duplicate tensor(-1.6292, dtype=torch.float64) tensor(3.0703, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7280, dtype=torch.float64) delta_t tensor(-1.1616, dtype=torch.float64)
7 gae_duplicate tensor(-2.4650, dtype=torch.float64) tensor(4.5672, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9887, dtype=torch.float64) delta_t tensor(-0.9784, dtype=torch.float64)
6 gae_duplicate tensor(-2.9504, dtype=torch.float64) tensor(4.5198, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4678, dtype=torch.float64) delta_t tensor(2.1496, dtype=torch.float64)
5 gae_duplicate tensor(-0.2108, dtype=torch.float64) tensor(0.3205, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3989, dtype=torch.float64) delta_t tensor(-5.3517, dtype=torch.float64)
4 gae_duplicate tensor(-5.5203, dtype=torch.float64) tensor(9.8895, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0126, dtype=torch.float64) delta_t tensor(3.3742, dtype=torch.float64)
3 gae_duplicate tensor(-1.0421, dtype=torch.float64) tensor(1.7909, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0778, dtype=torch.float64) delta_t tensor(1.1820, dtype=torch.float64)
2 gae_duplicate tensor(0.3484, dtype=torch.float64) tensor(-0.6622, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-302.5583801269531
value loss:126.130126953125
entropies:35.3140869140625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.515202283859253 seconds
19 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(-1.8964, dtype=torch.float64)
19 gae_duplicate tensor(-1.8964, dtype=torch.float64) tensor(2.9783, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.5726, dtype=torch.float64)
18 gae_duplicate tensor(-0.9445, dtype=torch.float64) tensor(2.6593, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.4309, dtype=torch.float64)
17 gae_duplicate tensor(-0.3247, dtype=torch.float64) tensor(0.5390, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.4988, dtype=torch.float64)
16 gae_duplicate tensor(0.2390, dtype=torch.float64) tensor(-0.6708, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.4573, dtype=torch.float64)
15 gae_duplicate tensor(0.6485, dtype=torch.float64) tensor(-1.0991, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.8094, dtype=torch.float64)
14 gae_duplicate tensor(1.3282, dtype=torch.float64) tensor(-3.4863, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(-0.4656, dtype=torch.float64)
13 gae_duplicate tensor(0.5970, dtype=torch.float64) tensor(-1.6421, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.4726, dtype=torch.float64)
12 gae_duplicate tensor(0.9502, dtype=torch.float64) tensor(-2.7617, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.3417, dtype=torch.float64)
11 gae_duplicate tensor(1.1019, dtype=torch.float64) tensor(-1.7256, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7710, dtype=torch.float64) delta_t tensor(0.0303, dtype=torch.float64)
10 gae_duplicate tensor(0.9118, dtype=torch.float64) tensor(-1.5957, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7285, dtype=torch.float64) delta_t tensor(-0.9095, dtype=torch.float64)
9 gae_duplicate tensor(-0.1801, dtype=torch.float64) tensor(0.2990, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1842, dtype=torch.float64) delta_t tensor(0.7156, dtype=torch.float64)
8 gae_duplicate tensor(0.5715, dtype=torch.float64) tensor(-1.6631, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1190, dtype=torch.float64) delta_t tensor(0.0590, dtype=torch.float64)
7 gae_duplicate tensor(0.5162, dtype=torch.float64) tensor(-0.6960, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6632, dtype=torch.float64) delta_t tensor(0.9448, dtype=torch.float64)
6 gae_duplicate tensor(1.3578, dtype=torch.float64) tensor(-1.9156, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3803, dtype=torch.float64) delta_t tensor(-0.2040, dtype=torch.float64)
5 gae_duplicate tensor(0.8822, dtype=torch.float64) tensor(-1.1988, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7704, dtype=torch.float64) delta_t tensor(0.8868, dtype=torch.float64)
4 gae_duplicate tensor(1.5925, dtype=torch.float64) tensor(-3.2272, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7938, dtype=torch.float64) delta_t tensor(1.5016, dtype=torch.float64)
3 gae_duplicate tensor(2.7756, dtype=torch.float64) tensor(-4.6078, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2725, dtype=torch.float64) delta_t tensor(-0.1410, dtype=torch.float64)
2 gae_duplicate tensor(2.0795, dtype=torch.float64) tensor(-3.4281, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:138.41238403320312
value loss:41.92868423461914
entropies:34.70866012573242
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.197512865066528 seconds
19 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(-0.4969, dtype=torch.float64)
19 gae_duplicate tensor(-0.4969, dtype=torch.float64) tensor(1.0149, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.4630, dtype=torch.float64)
18 gae_duplicate tensor(0.0654, dtype=torch.float64) tensor(-0.1317, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.6409, dtype=torch.float64)
17 gae_duplicate tensor(0.6933, dtype=torch.float64) tensor(-0.9876, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(-0.0319, dtype=torch.float64)
16 gae_duplicate tensor(0.5227, dtype=torch.float64) tensor(-1.3706, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(1.0448, dtype=torch.float64)
15 gae_duplicate tensor(1.4630, dtype=torch.float64) tensor(-2.6083, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(-0.3076, dtype=torch.float64)
14 gae_duplicate tensor(0.8629, dtype=torch.float64) tensor(-1.5318, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.3821, dtype=torch.float64)
13 gae_duplicate tensor(1.0724, dtype=torch.float64) tensor(-2.9067, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.4038, dtype=torch.float64)
12 gae_duplicate tensor(1.2617, dtype=torch.float64) tensor(-2.2466, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.4039, dtype=torch.float64)
11 gae_duplicate tensor(1.4133, dtype=torch.float64) tensor(-2.3628, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(1.5531, dtype=torch.float64)
10 gae_duplicate tensor(2.6837, dtype=torch.float64) tensor(-3.8363, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3822, dtype=torch.float64) delta_t tensor(-2.2262, dtype=torch.float64)
9 gae_duplicate tensor(-0.0792, dtype=torch.float64) tensor(0.2032, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1831, dtype=torch.float64) delta_t tensor(0.2845, dtype=torch.float64)
8 gae_duplicate tensor(0.2211, dtype=torch.float64) tensor(-0.3681, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7702, dtype=torch.float64) delta_t tensor(0.5640, dtype=torch.float64)
7 gae_duplicate tensor(0.7408, dtype=torch.float64) tensor(-0.9628, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3170, dtype=torch.float64) delta_t tensor(0.2492, dtype=torch.float64)
6 gae_duplicate tensor(0.8419, dtype=torch.float64) tensor(-1.1861, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3826, dtype=torch.float64) delta_t tensor(-0.2255, dtype=torch.float64)
5 gae_duplicate tensor(0.4481, dtype=torch.float64) tensor(-0.9393, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7699, dtype=torch.float64) delta_t tensor(1.0830, dtype=torch.float64)
4 gae_duplicate tensor(1.4415, dtype=torch.float64) tensor(-3.4919, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7305, dtype=torch.float64) delta_t tensor(0.1833, dtype=torch.float64)
3 gae_duplicate tensor(1.3364, dtype=torch.float64) tensor(-1.7835, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2739, dtype=torch.float64) delta_t tensor(-3.2080, dtype=torch.float64)
2 gae_duplicate tensor(-2.1388, dtype=torch.float64) tensor(3.0123, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:133.87246704101562
value loss:38.675540924072266
entropies:34.39821243286133
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.525640964508057 seconds
19 rew tensor(-0.1446, dtype=torch.float64) delta_t tensor(-2.1826, dtype=torch.float64)
19 gae_duplicate tensor(-2.1826, dtype=torch.float64) tensor(3.4436, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-1.2548, dtype=torch.float64) delta_t tensor(-1.9240, dtype=torch.float64)
18 gae_duplicate tensor(-3.6701, dtype=torch.float64) tensor(10.8307, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.1657, dtype=torch.float64)
17 gae_duplicate tensor(-2.7704, dtype=torch.float64) tensor(4.7543, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7695, dtype=torch.float64) delta_t tensor(0.2201, dtype=torch.float64)
16 gae_duplicate tensor(-1.9962, dtype=torch.float64) tensor(5.4913, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7697, dtype=torch.float64) delta_t tensor(0.2754, dtype=torch.float64)
15 gae_duplicate tensor(-1.3216, dtype=torch.float64) tensor(2.0663, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6392, dtype=torch.float64) delta_t tensor(0.3381, dtype=torch.float64)
14 gae_duplicate tensor(-0.7191, dtype=torch.float64) tensor(2.1348, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5087, dtype=torch.float64) delta_t tensor(-0.3751, dtype=torch.float64)
13 gae_duplicate tensor(-0.9504, dtype=torch.float64) tensor(1.6584, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8352, dtype=torch.float64) delta_t tensor(0.3491, dtype=torch.float64)
12 gae_duplicate tensor(-0.4113, dtype=torch.float64) tensor(1.1834, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.3592, dtype=torch.float64)
11 gae_duplicate tensor(0.0301, dtype=torch.float64) tensor(-0.0521, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8356, dtype=torch.float64) delta_t tensor(0.2773, dtype=torch.float64)
10 gae_duplicate tensor(0.3014, dtype=torch.float64) tensor(-0.5036, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1881, dtype=torch.float64) delta_t tensor(-1.7769, dtype=torch.float64)
9 gae_duplicate tensor(-1.5358, dtype=torch.float64) tensor(3.2506, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6008, dtype=torch.float64) delta_t tensor(-0.4895, dtype=torch.float64)
8 gae_duplicate tensor(-1.7182, dtype=torch.float64) tensor(2.3600, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4051, dtype=torch.float64) delta_t tensor(-0.5460, dtype=torch.float64)
7 gae_duplicate tensor(-1.9205, dtype=torch.float64) tensor(6.2107, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2746, dtype=torch.float64) delta_t tensor(-1.3559, dtype=torch.float64)
6 gae_duplicate tensor(-2.8923, dtype=torch.float64) tensor(4.5563, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1441, dtype=torch.float64) delta_t tensor(2.9633, dtype=torch.float64)
5 gae_duplicate tensor(0.6495, dtype=torch.float64) tensor(-1.1879, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4051, dtype=torch.float64) delta_t tensor(0.8649, dtype=torch.float64)
4 gae_duplicate tensor(1.3844, dtype=torch.float64) tensor(-1.9819, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0577, dtype=torch.float64) delta_t tensor(-0.2367, dtype=torch.float64)
3 gae_duplicate tensor(0.8709, dtype=torch.float64) tensor(-1.7140, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9275, dtype=torch.float64) delta_t tensor(-1.8039, dtype=torch.float64)
2 gae_duplicate tensor(-1.1072, dtype=torch.float64) tensor(1.4963, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-265.0074768066406
value loss:82.5123519897461
entropies:34.167057037353516
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.52908182144165 seconds
19 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(-0.7837, dtype=torch.float64)
19 gae_duplicate tensor(-0.7837, dtype=torch.float64) tensor(2.2991, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(0.5372, dtype=torch.float64)
18 gae_duplicate tensor(-0.0898, dtype=torch.float64) tensor(0.2525, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.6643, dtype=torch.float64)
17 gae_duplicate tensor(0.5924, dtype=torch.float64) tensor(-0.9394, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(0.2603, dtype=torch.float64)
16 gae_duplicate tensor(0.7343, dtype=torch.float64) tensor(-1.2353, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.6456, dtype=torch.float64)
15 gae_duplicate tensor(1.2330, dtype=torch.float64) tensor(-2.1274, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(0.5424, dtype=torch.float64)
14 gae_duplicate tensor(1.5288, dtype=torch.float64) tensor(-2.3709, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(3.0292, dtype=torch.float64)
13 gae_duplicate tensor(4.2522, dtype=torch.float64) tensor(-6.5452, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2484, dtype=torch.float64) delta_t tensor(-2.5855, dtype=torch.float64)
12 gae_duplicate tensor(0.8163, dtype=torch.float64) tensor(-1.2194, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2484, dtype=torch.float64) delta_t tensor(-0.2689, dtype=torch.float64)
11 gae_duplicate tensor(0.3841, dtype=torch.float64) tensor(-0.7136, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1437, dtype=torch.float64) delta_t tensor(-0.6375, dtype=torch.float64)
10 gae_duplicate tensor(-0.3302, dtype=torch.float64) tensor(1.1178, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0130, dtype=torch.float64) delta_t tensor(-0.1537, dtype=torch.float64)
9 gae_duplicate tensor(-0.4178, dtype=torch.float64) tensor(0.5295, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0783, dtype=torch.float64) delta_t tensor(-1.0533, dtype=torch.float64)
8 gae_duplicate tensor(-1.3876, dtype=torch.float64) tensor(2.3257, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4703, dtype=torch.float64) delta_t tensor(-0.6376, dtype=torch.float64)
7 gae_duplicate tensor(-1.7477, dtype=torch.float64) tensor(2.9272, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0583, dtype=torch.float64) delta_t tensor(-0.9576, dtype=torch.float64)
6 gae_duplicate tensor(-2.3557, dtype=torch.float64) tensor(6.3825, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2545, dtype=torch.float64) delta_t tensor(-2.0164, dtype=torch.float64)
5 gae_duplicate tensor(-3.9010, dtype=torch.float64) tensor(5.4569, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4509, dtype=torch.float64) delta_t tensor(2.6307, dtype=torch.float64)
4 gae_duplicate tensor(-0.4901, dtype=torch.float64) tensor(0.9620, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2100, dtype=torch.float64) delta_t tensor(-1.0251, dtype=torch.float64)
3 gae_duplicate tensor(-1.4172, dtype=torch.float64) tensor(3.6252, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0140, dtype=torch.float64) delta_t tensor(1.8209, dtype=torch.float64)
2 gae_duplicate tensor(0.6872, dtype=torch.float64) tensor(-1.2156, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-58.09387969970703
value loss:79.52450561523438
entropies:34.101200103759766
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(413.8051)
ToM Target loss= tensor(311.0117)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.570060968399048 seconds
19 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(-1.6670, dtype=torch.float64)
19 gae_duplicate tensor(-1.6670, dtype=torch.float64) tensor(2.2354, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8359, dtype=torch.float64) delta_t tensor(0.2572, dtype=torch.float64)
18 gae_duplicate tensor(-1.0764, dtype=torch.float64) tensor(1.4223, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.3748, dtype=torch.float64)
17 gae_duplicate tensor(-0.4863, dtype=torch.float64) tensor(1.0061, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(-0.1127, dtype=torch.float64)
16 gae_duplicate tensor(-0.5018, dtype=torch.float64) tensor(1.1692, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7710, dtype=torch.float64) delta_t tensor(0.6415, dtype=torch.float64)
15 gae_duplicate tensor(0.2401, dtype=torch.float64) tensor(-0.5444, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7711, dtype=torch.float64) delta_t tensor(0.0994, dtype=torch.float64)
14 gae_duplicate tensor(0.2915, dtype=torch.float64) tensor(-0.2835, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7058, dtype=torch.float64) delta_t tensor(0.0386, dtype=torch.float64)
13 gae_duplicate tensor(0.2718, dtype=torch.float64) tensor(-0.2689, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5097, dtype=torch.float64) delta_t tensor(-0.2474, dtype=torch.float64)
12 gae_duplicate tensor(-0.0299, dtype=torch.float64) tensor(0.0303, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7714, dtype=torch.float64) delta_t tensor(0.2121, dtype=torch.float64)
11 gae_duplicate tensor(0.1882, dtype=torch.float64) tensor(-0.1910, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5099, dtype=torch.float64) delta_t tensor(0.0399, dtype=torch.float64)
10 gae_duplicate tensor(0.1904, dtype=torch.float64) tensor(-0.1925, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1176, dtype=torch.float64) delta_t tensor(0.4981, dtype=torch.float64)
9 gae_duplicate tensor(0.6504, dtype=torch.float64) tensor(-0.8404, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2484, dtype=torch.float64) delta_t tensor(0.1873, dtype=torch.float64)
8 gae_duplicate tensor(0.7076, dtype=torch.float64) tensor(-0.8323, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4054, dtype=torch.float64) delta_t tensor(-1.7707, dtype=torch.float64)
7 gae_duplicate tensor(-1.2046, dtype=torch.float64) tensor(1.4756, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7324, dtype=torch.float64) delta_t tensor(-1.7874, dtype=torch.float64)
6 gae_duplicate tensor(-2.7511, dtype=torch.float64) tensor(7.1073, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5170, dtype=torch.float64) delta_t tensor(1.3515, dtype=torch.float64)
5 gae_duplicate tensor(-0.8494, dtype=torch.float64) tensor(1.1319, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0137, dtype=torch.float64) delta_t tensor(1.0713, dtype=torch.float64)
4 gae_duplicate tensor(0.3918, dtype=torch.float64) tensor(-0.9739, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7329, dtype=torch.float64) delta_t tensor(-0.0289, dtype=torch.float64)
3 gae_duplicate tensor(0.2845, dtype=torch.float64) tensor(-0.5396, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2560, dtype=torch.float64) delta_t tensor(1.0889, dtype=torch.float64)
2 gae_duplicate tensor(1.3166, dtype=torch.float64) tensor(-2.1386, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-53.606685638427734
value loss:26.021467208862305
entropies:32.312400817871094
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.602494955062866 seconds
19 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(-1.9668, dtype=torch.float64)
19 gae_duplicate tensor(-1.9668, dtype=torch.float64) tensor(4.9375, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(0.4413, dtype=torch.float64)
18 gae_duplicate tensor(-1.1322, dtype=torch.float64) tensor(2.6480, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.3312, dtype=torch.float64)
17 gae_duplicate tensor(-0.5745, dtype=torch.float64) tensor(0.5633, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.3923, dtype=torch.float64)
16 gae_duplicate tensor(-0.0673, dtype=torch.float64) tensor(0.1727, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.3072, dtype=torch.float64)
15 gae_duplicate tensor(0.2534, dtype=torch.float64) tensor(-0.8314, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(0.8171, dtype=torch.float64)
14 gae_duplicate tensor(1.0198, dtype=torch.float64) tensor(-1.7670, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(-0.0469, dtype=torch.float64)
13 gae_duplicate tensor(0.7689, dtype=torch.float64) tensor(-1.8348, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(1.6650, dtype=torch.float64)
12 gae_duplicate tensor(2.2802, dtype=torch.float64) tensor(-3.0144, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(-0.1219, dtype=torch.float64)
11 gae_duplicate tensor(1.7023, dtype=torch.float64) tensor(-2.0765, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9024, dtype=torch.float64) delta_t tensor(0.7264, dtype=torch.float64)
10 gae_duplicate tensor(2.0882, dtype=torch.float64) tensor(-2.5242, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6408, dtype=torch.float64) delta_t tensor(-1.2460, dtype=torch.float64)
9 gae_duplicate tensor(0.4246, dtype=torch.float64) tensor(-0.9523, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2483, dtype=torch.float64) delta_t tensor(-0.5161, dtype=torch.float64)
8 gae_duplicate tensor(-0.1764, dtype=torch.float64) tensor(0.5746, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0135, dtype=torch.float64) delta_t tensor(0.0146, dtype=torch.float64)
7 gae_duplicate tensor(-0.1265, dtype=torch.float64) tensor(0.3152, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6023, dtype=torch.float64) delta_t tensor(0.8701, dtype=torch.float64)
6 gae_duplicate tensor(0.7689, dtype=torch.float64) tensor(-1.5402, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8641, dtype=torch.float64) delta_t tensor(1.4924, dtype=torch.float64)
5 gae_duplicate tensor(2.1075, dtype=torch.float64) tensor(-4.4684, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5839, dtype=torch.float64) delta_t tensor(-0.7475, dtype=torch.float64)
4 gae_duplicate tensor(0.9386, dtype=torch.float64) tensor(-1.2047, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3228, dtype=torch.float64) delta_t tensor(-0.5896, dtype=torch.float64)
3 gae_duplicate tensor(0.1613, dtype=torch.float64) tensor(-0.2048, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0614, dtype=torch.float64) delta_t tensor(-1.9748, dtype=torch.float64)
2 gae_duplicate tensor(-1.8458, dtype=torch.float64) tensor(2.2713, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:52.654541015625
value loss:43.81757354736328
entropies:32.02564239501953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.525657892227173 seconds
19 rew tensor(0.0494, dtype=torch.float64) delta_t tensor(-2.2415, dtype=torch.float64)
19 gae_duplicate tensor(-2.2415, dtype=torch.float64) tensor(5.8214, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.7369, dtype=torch.float64) delta_t tensor(-1.5655, dtype=torch.float64)
18 gae_duplicate tensor(-3.3587, dtype=torch.float64) tensor(8.5057, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8355, dtype=torch.float64) delta_t tensor(0.3159, dtype=torch.float64)
17 gae_duplicate tensor(-2.3711, dtype=torch.float64) tensor(5.9178, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.3715, dtype=torch.float64)
16 gae_duplicate tensor(-1.5254, dtype=torch.float64) tensor(1.6411, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8359, dtype=torch.float64) delta_t tensor(0.3513, dtype=torch.float64)
15 gae_duplicate tensor(-0.8690, dtype=torch.float64) tensor(2.0258, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8360, dtype=torch.float64) delta_t tensor(0.3694, dtype=torch.float64)
14 gae_duplicate tensor(-0.3259, dtype=torch.float64) tensor(0.4947, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7051, dtype=torch.float64) delta_t tensor(0.2294, dtype=torch.float64)
13 gae_duplicate tensor(-0.0313, dtype=torch.float64) tensor(0.0282, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5087, dtype=torch.float64) delta_t tensor(-0.2067, dtype=torch.float64)
12 gae_duplicate tensor(-0.2317, dtype=torch.float64) tensor(0.5404, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(0.3563, dtype=torch.float64)
11 gae_duplicate tensor(0.1709, dtype=torch.float64) tensor(-0.3187, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7710, dtype=torch.float64) delta_t tensor(0.4569, dtype=torch.float64)
10 gae_duplicate tensor(0.5936, dtype=torch.float64) tensor(-0.6391, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5746, dtype=torch.float64) delta_t tensor(-0.9068, dtype=torch.float64)
9 gae_duplicate tensor(-0.4319, dtype=torch.float64) tensor(0.5673, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1817, dtype=torch.float64) delta_t tensor(-0.1788, dtype=torch.float64)
8 gae_duplicate tensor(-0.5242, dtype=torch.float64) tensor(1.0841, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2112, dtype=torch.float64) delta_t tensor(1.0180, dtype=torch.float64)
7 gae_duplicate tensor(0.5986, dtype=torch.float64) tensor(-1.1830, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4077, dtype=torch.float64) delta_t tensor(0.2149, dtype=torch.float64)
6 gae_duplicate tensor(0.6938, dtype=torch.float64) tensor(-1.8331, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1280, dtype=torch.float64) delta_t tensor(0.6104, dtype=torch.float64)
5 gae_duplicate tensor(1.1654, dtype=torch.float64) tensor(-2.8847, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2468, dtype=torch.float64) delta_t tensor(0.8212, dtype=torch.float64)
4 gae_duplicate tensor(1.7535, dtype=torch.float64) tensor(-6.9388, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9317, dtype=torch.float64) delta_t tensor(-0.1627, dtype=torch.float64)
3 gae_duplicate tensor(1.2401, dtype=torch.float64) tensor(-1.4688, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6700, dtype=torch.float64) delta_t tensor(0.4524, dtype=torch.float64)
2 gae_duplicate tensor(1.4445, dtype=torch.float64) tensor(-1.8072, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-58.2620964050293
value loss:52.36536407470703
entropies:31.46708869934082
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.346186876296997 seconds
19 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(-0.9540, dtype=torch.float64)
19 gae_duplicate tensor(-0.9540, dtype=torch.float64) tensor(1.0311, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8351, dtype=torch.float64) delta_t tensor(0.4132, dtype=torch.float64)
18 gae_duplicate tensor(-0.3500, dtype=torch.float64) tensor(0.8894, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.5196, dtype=torch.float64)
17 gae_duplicate tensor(0.2396, dtype=torch.float64) tensor(-0.2539, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.5198, dtype=torch.float64)
16 gae_duplicate tensor(0.7114, dtype=torch.float64) tensor(-1.6818, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7702, dtype=torch.float64) delta_t tensor(0.1983, dtype=torch.float64)
15 gae_duplicate tensor(0.7675, dtype=torch.float64) tensor(-2.5696, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7703, dtype=torch.float64) delta_t tensor(0.4314, dtype=torch.float64)
14 gae_duplicate tensor(1.0454, dtype=torch.float64) tensor(-3.5859, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7704, dtype=torch.float64) delta_t tensor(-0.0167, dtype=torch.float64)
13 gae_duplicate tensor(0.8197, dtype=torch.float64) tensor(-0.6343, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.4215, dtype=torch.float64)
12 gae_duplicate tensor(1.0772, dtype=torch.float64) tensor(-1.9427, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.2366, dtype=torch.float64)
11 gae_duplicate tensor(1.0984, dtype=torch.float64) tensor(-2.1931, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6400, dtype=torch.float64) delta_t tensor(0.0618, dtype=torch.float64)
10 gae_duplicate tensor(0.9405, dtype=torch.float64) tensor(-1.5872, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5188, dtype=torch.float64) delta_t tensor(-2.1582, dtype=torch.float64)
9 gae_duplicate tensor(-1.4058, dtype=torch.float64) tensor(2.2450, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9304, dtype=torch.float64) delta_t tensor(-0.7304, dtype=torch.float64)
8 gae_duplicate tensor(-1.8550, dtype=torch.float64) tensor(5.2078, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1163, dtype=torch.float64) delta_t tensor(0.3839, dtype=torch.float64)
7 gae_duplicate tensor(-1.1001, dtype=torch.float64) tensor(2.0795, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5193, dtype=torch.float64) delta_t tensor(-2.8251, dtype=torch.float64)
6 gae_duplicate tensor(-3.7052, dtype=torch.float64) tensor(5.9257, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5199, dtype=torch.float64) delta_t tensor(2.5049, dtype=torch.float64)
5 gae_duplicate tensor(-0.4592, dtype=torch.float64) tensor(0.7111, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.2690, dtype=torch.float64) delta_t tensor(-2.5872, dtype=torch.float64)
4 gae_duplicate tensor(-2.9546, dtype=torch.float64) tensor(4.7452, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0494, dtype=torch.float64) delta_t tensor(0.7379, dtype=torch.float64)
3 gae_duplicate tensor(-1.6258, dtype=torch.float64) tensor(2.5823, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1149, dtype=torch.float64) delta_t tensor(0.6814, dtype=torch.float64)
2 gae_duplicate tensor(-0.6192, dtype=torch.float64) tensor(0.9217, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-72.26744079589844
value loss:59.286094665527344
entropies:30.87958335876465
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.377137184143066 seconds
19 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(-0.8907, dtype=torch.float64)
19 gae_duplicate tensor(-0.8907, dtype=torch.float64) tensor(0.5734, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.3296, dtype=torch.float64)
18 gae_duplicate tensor(-0.3830, dtype=torch.float64) tensor(0.7502, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.0143, dtype=torch.float64)
17 gae_duplicate tensor(-0.2921, dtype=torch.float64) tensor(0.1951, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.4026, dtype=torch.float64)
16 gae_duplicate tensor(0.1689, dtype=torch.float64) tensor(-0.3145, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(0.2206, dtype=torch.float64)
15 gae_duplicate tensor(0.3558, dtype=torch.float64) tensor(-1.1523, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.3668, dtype=torch.float64)
14 gae_duplicate tensor(0.6514, dtype=torch.float64) tensor(-0.5554, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.3867, dtype=torch.float64)
13 gae_duplicate tensor(0.9078, dtype=torch.float64) tensor(-1.5427, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.3873, dtype=torch.float64)
12 gae_duplicate tensor(1.1136, dtype=torch.float64) tensor(-1.8804, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(3.2011, dtype=torch.float64)
11 gae_duplicate tensor(4.0920, dtype=torch.float64) tensor(-4.8786, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(-2.1461, dtype=torch.float64)
10 gae_duplicate tensor(1.1275, dtype=torch.float64) tensor(-1.4478, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0792, dtype=torch.float64) delta_t tensor(-0.6981, dtype=torch.float64)
9 gae_duplicate tensor(0.2039, dtype=torch.float64) tensor(-0.4507, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3409, dtype=torch.float64) delta_t tensor(-0.8808, dtype=torch.float64)
8 gae_duplicate tensor(-0.7177, dtype=torch.float64) tensor(0.6975, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0604, dtype=torch.float64) delta_t tensor(-1.3068, dtype=torch.float64)
7 gae_duplicate tensor(-1.8810, dtype=torch.float64) tensor(3.2640, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0607, dtype=torch.float64) delta_t tensor(0.9787, dtype=torch.float64)
6 gae_duplicate tensor(-0.5261, dtype=torch.float64) tensor(0.6790, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2106, dtype=torch.float64) delta_t tensor(0.3726, dtype=torch.float64)
5 gae_duplicate tensor(-0.0483, dtype=torch.float64) tensor(0.0530, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8457, dtype=torch.float64) delta_t tensor(-0.6979, dtype=torch.float64)
4 gae_duplicate tensor(-0.7366, dtype=torch.float64) tensor(0.8325, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.2391, dtype=torch.float64) delta_t tensor(-0.5217, dtype=torch.float64)
3 gae_duplicate tensor(-1.1109, dtype=torch.float64) tensor(1.3388, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8661, dtype=torch.float64) delta_t tensor(-1.7887, dtype=torch.float64)
2 gae_duplicate tensor(-2.6774, dtype=torch.float64) tensor(3.8057, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-0.6888055801391602
value loss:52.505531311035156
entropies:29.601240158081055
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(411.3680)
ToM Target loss= tensor(311.0837)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.571507215499878 seconds
19 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(-0.7446, dtype=torch.float64)
19 gae_duplicate tensor(-0.7446, dtype=torch.float64) tensor(1.6972, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.6311, dtype=torch.float64)
18 gae_duplicate tensor(0.0354, dtype=torch.float64) tensor(-0.0613, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.5440, dtype=torch.float64)
17 gae_duplicate tensor(0.5723, dtype=torch.float64) tensor(-0.9914, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.7060, dtype=torch.float64)
16 gae_duplicate tensor(1.1638, dtype=torch.float64) tensor(-3.6651, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(4.3141, dtype=torch.float64)
15 gae_duplicate tensor(5.2451, dtype=torch.float64) tensor(-11.0045, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(-1.5646, dtype=torch.float64)
14 gae_duplicate tensor(2.6315, dtype=torch.float64) tensor(-2.9612, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.9073, dtype=torch.float64)
13 gae_duplicate tensor(3.0125, dtype=torch.float64) tensor(-3.3499, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2472, dtype=torch.float64) delta_t tensor(0.2591, dtype=torch.float64)
12 gae_duplicate tensor(2.6691, dtype=torch.float64) tensor(-2.8716, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1166, dtype=torch.float64) delta_t tensor(-1.6869, dtype=torch.float64)
11 gae_duplicate tensor(0.4484, dtype=torch.float64) tensor(-0.4452, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0514, dtype=torch.float64) delta_t tensor(-0.2481, dtype=torch.float64)
10 gae_duplicate tensor(0.1106, dtype=torch.float64) tensor(-0.2371, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0792, dtype=torch.float64) delta_t tensor(-0.3272, dtype=torch.float64)
9 gae_duplicate tensor(-0.2387, dtype=torch.float64) tensor(0.3774, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0139, dtype=torch.float64) delta_t tensor(-0.1681, dtype=torch.float64)
8 gae_duplicate tensor(-0.3590, dtype=torch.float64) tensor(0.2574, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3776, dtype=torch.float64) delta_t tensor(-0.0249, dtype=torch.float64)
7 gae_duplicate tensor(-0.3122, dtype=torch.float64) tensor(0.3441, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7969, dtype=torch.float64) delta_t tensor(-0.5110, dtype=torch.float64)
6 gae_duplicate tensor(-0.7607, dtype=torch.float64) tensor(0.8219, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1232, dtype=torch.float64) delta_t tensor(1.1645, dtype=torch.float64)
5 gae_duplicate tensor(0.5560, dtype=torch.float64) tensor(-1.4690, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.5606, dtype=torch.float64) delta_t tensor(-5.0515, dtype=torch.float64)
4 gae_duplicate tensor(-4.6067, dtype=torch.float64) tensor(12.1318, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2773, dtype=torch.float64) delta_t tensor(0.7911, dtype=torch.float64)
3 gae_duplicate tensor(-2.8943, dtype=torch.float64) tensor(3.1529, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2774, dtype=torch.float64) delta_t tensor(-1.0501, dtype=torch.float64)
2 gae_duplicate tensor(-3.3655, dtype=torch.float64) tensor(3.6557, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:26.805103302001953
value loss:142.7736053466797
entropies:30.05898666381836
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.617815017700195 seconds
19 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(-1.1070, dtype=torch.float64)
19 gae_duplicate tensor(-1.1070, dtype=torch.float64) tensor(0.7528, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.4978, dtype=torch.float64)
18 gae_duplicate tensor(-0.3878, dtype=torch.float64) tensor(0.2637, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.4980, dtype=torch.float64)
17 gae_duplicate tensor(0.1878, dtype=torch.float64) tensor(-0.3715, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.4982, dtype=torch.float64)
16 gae_duplicate tensor(0.6484, dtype=torch.float64) tensor(-1.2423, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.4983, dtype=torch.float64)
15 gae_duplicate tensor(1.0171, dtype=torch.float64) tensor(-0.6917, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.4985, dtype=torch.float64)
14 gae_duplicate tensor(1.3122, dtype=torch.float64) tensor(-0.8923, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(-0.2141, dtype=torch.float64)
13 gae_duplicate tensor(0.8356, dtype=torch.float64) tensor(-1.7608, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.4785, dtype=torch.float64)
12 gae_duplicate tensor(1.1470, dtype=torch.float64) tensor(-1.6481, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.0286, dtype=torch.float64)
11 gae_duplicate tensor(0.9462, dtype=torch.float64) tensor(-0.7632, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5738, dtype=torch.float64) delta_t tensor(-0.0947, dtype=torch.float64)
10 gae_duplicate tensor(0.6623, dtype=torch.float64) tensor(-1.4889, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2473, dtype=torch.float64) delta_t tensor(0.1206, dtype=torch.float64)
9 gae_duplicate tensor(0.6504, dtype=torch.float64) tensor(-0.4894, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0513, dtype=torch.float64) delta_t tensor(-0.0250, dtype=torch.float64)
8 gae_duplicate tensor(0.4954, dtype=torch.float64) tensor(-1.0050, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1446, dtype=torch.float64) delta_t tensor(-0.7164, dtype=torch.float64)
7 gae_duplicate tensor(-0.3201, dtype=torch.float64) tensor(0.7729, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6670, dtype=torch.float64) delta_t tensor(0.5281, dtype=torch.float64)
6 gae_duplicate tensor(0.2720, dtype=torch.float64) tensor(-0.2972, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2100, dtype=torch.float64) delta_t tensor(0.4863, dtype=torch.float64)
5 gae_duplicate tensor(0.7039, dtype=torch.float64) tensor(-0.7479, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3199, dtype=torch.float64) delta_t tensor(-0.0687, dtype=torch.float64)
4 gae_duplicate tensor(0.4945, dtype=torch.float64) tensor(-1.3430, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5814, dtype=torch.float64) delta_t tensor(-1.5273, dtype=torch.float64)
3 gae_duplicate tensor(-1.1317, dtype=torch.float64) tensor(1.4065, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7984, dtype=torch.float64) delta_t tensor(0.6411, dtype=torch.float64)
2 gae_duplicate tensor(-0.2643, dtype=torch.float64) tensor(0.2929, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:54.658538818359375
value loss:16.306825637817383
entropies:28.56055450439453
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.47845721244812 seconds
19 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(-1.0358, dtype=torch.float64)
19 gae_duplicate tensor(-1.0358, dtype=torch.float64) tensor(0.7520, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.5120, dtype=torch.float64)
18 gae_duplicate tensor(-0.3167, dtype=torch.float64) tensor(0.9628, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.5121, dtype=torch.float64)
17 gae_duplicate tensor(0.2588, dtype=torch.float64) tensor(-0.1879, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.5123, dtype=torch.float64)
16 gae_duplicate tensor(0.7193, dtype=torch.float64) tensor(-0.5222, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.5125, dtype=torch.float64)
15 gae_duplicate tensor(1.0879, dtype=torch.float64) tensor(-0.7898, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.5126, dtype=torch.float64)
14 gae_duplicate tensor(1.3830, dtype=torch.float64) tensor(-2.6336, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.5128, dtype=torch.float64)
13 gae_duplicate tensor(1.6192, dtype=torch.float64) tensor(-1.1755, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.5130, dtype=torch.float64)
12 gae_duplicate tensor(1.8083, dtype=torch.float64) tensor(-5.4979, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.5132, dtype=torch.float64)
11 gae_duplicate tensor(1.9598, dtype=torch.float64) tensor(-3.7321, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5370, dtype=torch.float64) delta_t tensor(-0.7851, dtype=torch.float64)
10 gae_duplicate tensor(0.7828, dtype=torch.float64) tensor(-1.7392, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5734, dtype=torch.float64) delta_t tensor(-0.8613, dtype=torch.float64)
9 gae_duplicate tensor(-0.2351, dtype=torch.float64) tensor(0.2512, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1163, dtype=torch.float64) delta_t tensor(-0.6269, dtype=torch.float64)
8 gae_duplicate tensor(-0.8149, dtype=torch.float64) tensor(0.8730, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6674, dtype=torch.float64) delta_t tensor(-0.6213, dtype=torch.float64)
7 gae_duplicate tensor(-1.2732, dtype=torch.float64) tensor(1.4531, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.9084, dtype=torch.float64) delta_t tensor(0.2120, dtype=torch.float64)
6 gae_duplicate tensor(-0.8066, dtype=torch.float64) tensor(1.5817, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9947, dtype=torch.float64) delta_t tensor(0.2672, dtype=torch.float64)
5 gae_duplicate tensor(-0.3781, dtype=torch.float64) tensor(0.4291, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1256, dtype=torch.float64) delta_t tensor(-0.0411, dtype=torch.float64)
4 gae_duplicate tensor(-0.3435, dtype=torch.float64) tensor(0.9411, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.2364, dtype=torch.float64) delta_t tensor(-1.0509, dtype=torch.float64)
3 gae_duplicate tensor(-1.3257, dtype=torch.float64) tensor(2.8436, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1465, dtype=torch.float64) delta_t tensor(-0.3503, dtype=torch.float64)
2 gae_duplicate tensor(-1.4109, dtype=torch.float64) tensor(2.4629, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:21.49106788635254
value loss:33.29916000366211
entropies:29.21917724609375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.366742134094238 seconds
19 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(-1.0448, dtype=torch.float64)
19 gae_duplicate tensor(-1.0448, dtype=torch.float64) tensor(1.1902, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.5100, dtype=torch.float64)
18 gae_duplicate tensor(-0.3258, dtype=torch.float64) tensor(0.4588, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(-0.3012, dtype=torch.float64)
17 gae_duplicate tensor(-0.5618, dtype=torch.float64) tensor(0.4382, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(1.1024, dtype=torch.float64)
16 gae_duplicate tensor(0.6529, dtype=torch.float64) tensor(-1.5503, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.4991, dtype=torch.float64)
15 gae_duplicate tensor(1.0215, dtype=torch.float64) tensor(-0.7392, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.4993, dtype=torch.float64)
14 gae_duplicate tensor(1.3165, dtype=torch.float64) tensor(-0.9527, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.4995, dtype=torch.float64)
13 gae_duplicate tensor(1.5526, dtype=torch.float64) tensor(-1.1236, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(-0.3952, dtype=torch.float64)
12 gae_duplicate tensor(0.8469, dtype=torch.float64) tensor(-1.4112, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.4004, dtype=torch.float64)
11 gae_duplicate tensor(1.0779, dtype=torch.float64) tensor(-1.7604, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6388, dtype=torch.float64) delta_t tensor(0.2263, dtype=torch.float64)
10 gae_duplicate tensor(1.0887, dtype=torch.float64) tensor(-0.8373, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2469, dtype=torch.float64) delta_t tensor(0.5339, dtype=torch.float64)
9 gae_duplicate tensor(1.4048, dtype=torch.float64) tensor(-1.0664, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4715, dtype=torch.float64) delta_t tensor(-0.3964, dtype=torch.float64)
8 gae_duplicate tensor(0.7274, dtype=torch.float64) tensor(-0.9388, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5081, dtype=torch.float64) delta_t tensor(0.1565, dtype=torch.float64)
7 gae_duplicate tensor(0.7384, dtype=torch.float64) tensor(-0.7948, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2551, dtype=torch.float64) delta_t tensor(-2.1846, dtype=torch.float64)
6 gae_duplicate tensor(-1.5939, dtype=torch.float64) tensor(1.8365, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3860, dtype=torch.float64) delta_t tensor(0.7894, dtype=torch.float64)
5 gae_duplicate tensor(-0.4857, dtype=torch.float64) tensor(0.6161, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8436, dtype=torch.float64) delta_t tensor(-0.1979, dtype=torch.float64)
4 gae_duplicate tensor(-0.5864, dtype=torch.float64) tensor(1.2907, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9752, dtype=torch.float64) delta_t tensor(-0.6736, dtype=torch.float64)
3 gae_duplicate tensor(-1.1427, dtype=torch.float64) tensor(1.4357, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6692, dtype=torch.float64) delta_t tensor(-1.5798, dtype=torch.float64)
2 gae_duplicate tensor(-2.4940, dtype=torch.float64) tensor(7.2616, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-21.00957679748535
value loss:35.82752227783203
entropies:29.65806007385254
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.589577913284302 seconds
19 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(-1.7726, dtype=torch.float64)
19 gae_duplicate tensor(-1.7726, dtype=torch.float64) tensor(3.4755, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(1.2180, dtype=torch.float64)
18 gae_duplicate tensor(-0.2001, dtype=torch.float64) tensor(0.4721, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.5516, dtype=torch.float64)
17 gae_duplicate tensor(0.3916, dtype=torch.float64) tensor(-0.2852, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(-0.1796, dtype=torch.float64)
16 gae_duplicate tensor(0.1336, dtype=torch.float64) tensor(-0.1117, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.3914, dtype=torch.float64)
15 gae_duplicate tensor(0.4983, dtype=torch.float64) tensor(-0.8792, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.3671, dtype=torch.float64)
14 gae_duplicate tensor(0.7657, dtype=torch.float64) tensor(-2.0548, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.3893, dtype=torch.float64)
13 gae_duplicate tensor(1.0019, dtype=torch.float64) tensor(-1.5457, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.3894, dtype=torch.float64)
12 gae_duplicate tensor(1.1909, dtype=torch.float64) tensor(-2.1419, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.3896, dtype=torch.float64)
11 gae_duplicate tensor(1.3424, dtype=torch.float64) tensor(-1.3427, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.7573, dtype=torch.float64)
10 gae_duplicate tensor(1.8312, dtype=torch.float64) tensor(-3.2932, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3853, dtype=torch.float64) delta_t tensor(-1.8519, dtype=torch.float64)
9 gae_duplicate tensor(-0.3870, dtype=torch.float64) tensor(0.2898, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3409, dtype=torch.float64) delta_t tensor(-1.1357, dtype=torch.float64)
8 gae_duplicate tensor(-1.4453, dtype=torch.float64) tensor(1.4378, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4062, dtype=torch.float64) delta_t tensor(0.4124, dtype=torch.float64)
7 gae_duplicate tensor(-0.7438, dtype=torch.float64) tensor(0.9106, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.7773, dtype=torch.float64) delta_t tensor(-1.0787, dtype=torch.float64)
6 gae_duplicate tensor(-1.6737, dtype=torch.float64) tensor(2.0806, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1046, dtype=torch.float64) delta_t tensor(-1.2022, dtype=torch.float64)
5 gae_duplicate tensor(-2.5412, dtype=torch.float64) tensor(3.4411, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3219, dtype=torch.float64) delta_t tensor(0.0965, dtype=torch.float64)
4 gae_duplicate tensor(-1.9365, dtype=torch.float64) tensor(2.2586, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.1063, dtype=torch.float64) delta_t tensor(-2.6069, dtype=torch.float64)
3 gae_duplicate tensor(-4.1561, dtype=torch.float64) tensor(5.0335, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1468, dtype=torch.float64) delta_t tensor(-1.8074, dtype=torch.float64)
2 gae_duplicate tensor(-5.1323, dtype=torch.float64) tensor(5.4446, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-80.0376968383789
value loss:106.77156066894531
entropies:30.002544403076172
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(409.0986)
ToM Target loss= tensor(310.2656)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.447313070297241 seconds
19 rew tensor(0.8982, dtype=torch.float64) delta_t tensor(-1.5278, dtype=torch.float64)
19 gae_duplicate tensor(-1.5278, dtype=torch.float64) tensor(2.8602, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.4132, dtype=torch.float64)
18 gae_duplicate tensor(-0.8090, dtype=torch.float64) tensor(0.7307, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(0.4190, dtype=torch.float64)
17 gae_duplicate tensor(-0.2282, dtype=torch.float64) tensor(0.3550, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.7795, dtype=torch.float64)
16 gae_duplicate tensor(0.5969, dtype=torch.float64) tensor(-1.0729, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.6115, dtype=torch.float64)
15 gae_duplicate tensor(1.0890, dtype=torch.float64) tensor(-3.9537, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.6447, dtype=torch.float64)
14 gae_duplicate tensor(1.5159, dtype=torch.float64) tensor(-1.1446, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(-0.3515, dtype=torch.float64)
13 gae_duplicate tensor(0.8613, dtype=torch.float64) tensor(-1.3528, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.4208, dtype=torch.float64)
12 gae_duplicate tensor(1.1098, dtype=torch.float64) tensor(-2.9798, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6382, dtype=torch.float64) delta_t tensor(0.2977, dtype=torch.float64)
11 gae_duplicate tensor(1.1855, dtype=torch.float64) tensor(-0.9955, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6383, dtype=torch.float64) delta_t tensor(2.1279, dtype=torch.float64)
10 gae_duplicate tensor(3.0763, dtype=torch.float64) tensor(-3.7705, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.7037, dtype=torch.float64) delta_t tensor(0.2704, dtype=torch.float64)
9 gae_duplicate tensor(2.7314, dtype=torch.float64) tensor(-2.8570, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1812, dtype=torch.float64) delta_t tensor(-0.2711, dtype=torch.float64)
8 gae_duplicate tensor(1.9140, dtype=torch.float64) tensor(-4.5339, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1812, dtype=torch.float64) delta_t tensor(0.0085, dtype=torch.float64)
7 gae_duplicate tensor(1.5397, dtype=torch.float64) tensor(-4.2655, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3413, dtype=torch.float64) delta_t tensor(0.3072, dtype=torch.float64)
6 gae_duplicate tensor(1.5390, dtype=torch.float64) tensor(-1.7280, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8638, dtype=torch.float64) delta_t tensor(0.2829, dtype=torch.float64)
5 gae_duplicate tensor(1.5141, dtype=torch.float64) tensor(-1.6911, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4517, dtype=torch.float64) delta_t tensor(-1.2529, dtype=torch.float64)
4 gae_duplicate tensor(-0.0417, dtype=torch.float64) tensor(0.0535, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2562, dtype=torch.float64) delta_t tensor(0.5543, dtype=torch.float64)
3 gae_duplicate tensor(0.5210, dtype=torch.float64) tensor(-1.4961, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7993, dtype=torch.float64) delta_t tensor(-0.9345, dtype=torch.float64)
2 gae_duplicate tensor(-0.5178, dtype=torch.float64) tensor(1.0579, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:159.8184051513672
value loss:57.63084411621094
entropies:29.586881637573242
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.40442967414856 seconds
19 rew tensor(0.8979, dtype=torch.float64) delta_t tensor(-1.1045, dtype=torch.float64)
19 gae_duplicate tensor(-1.1045, dtype=torch.float64) tensor(4.0242, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8980, dtype=torch.float64) delta_t tensor(0.5080, dtype=torch.float64)
18 gae_duplicate tensor(-0.3756, dtype=torch.float64) tensor(0.2646, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8982, dtype=torch.float64) delta_t tensor(0.5108, dtype=torch.float64)
17 gae_duplicate tensor(0.2103, dtype=torch.float64) tensor(-0.1502, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.5275, dtype=torch.float64)
16 gae_duplicate tensor(0.6958, dtype=torch.float64) tensor(-0.5113, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(0.5620, dtype=torch.float64)
15 gae_duplicate tensor(1.1186, dtype=torch.float64) tensor(-0.8827, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(-0.3969, dtype=torch.float64)
14 gae_duplicate tensor(0.4980, dtype=torch.float64) tensor(-0.4251, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.3356, dtype=torch.float64)
13 gae_duplicate tensor(0.7340, dtype=torch.float64) tensor(-0.6265, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.3358, dtype=torch.float64)
12 gae_duplicate tensor(0.9230, dtype=torch.float64) tensor(-2.4480, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(1.1264, dtype=torch.float64)
11 gae_duplicate tensor(1.8647, dtype=torch.float64) tensor(-2.2292, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.1389, dtype=torch.float64)
10 gae_duplicate tensor(1.6307, dtype=torch.float64) tensor(-1.7586, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1155, dtype=torch.float64) delta_t tensor(-1.6655, dtype=torch.float64)
9 gae_duplicate tensor(-0.3609, dtype=torch.float64) tensor(0.4138, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7991, dtype=torch.float64) delta_t tensor(-0.7556, dtype=torch.float64)
8 gae_duplicate tensor(-1.0444, dtype=torch.float64) tensor(2.8410, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9952, dtype=torch.float64) delta_t tensor(0.5623, dtype=torch.float64)
7 gae_duplicate tensor(-0.2732, dtype=torch.float64) tensor(0.4588, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6035, dtype=torch.float64) delta_t tensor(-0.5414, dtype=torch.float64)
6 gae_duplicate tensor(-0.7599, dtype=torch.float64) tensor(2.1954, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.3019, dtype=torch.float64) delta_t tensor(-0.2895, dtype=torch.float64)
5 gae_duplicate tensor(-0.8975, dtype=torch.float64) tensor(2.6532, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7681, dtype=torch.float64) delta_t tensor(0.8792, dtype=torch.float64)
4 gae_duplicate tensor(0.1612, dtype=torch.float64) tensor(-0.4497, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7150, dtype=torch.float64) delta_t tensor(0.1869, dtype=torch.float64)
3 gae_duplicate tensor(0.3158, dtype=torch.float64) tensor(-1.0261, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6046, dtype=torch.float64) delta_t tensor(-0.5083, dtype=torch.float64)
2 gae_duplicate tensor(-0.2556, dtype=torch.float64) tensor(0.3757, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-17.21027946472168
value loss:20.67800521850586
entropies:29.833003997802734
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.181670904159546 seconds
19 rew tensor(0.8326, dtype=torch.float64) delta_t tensor(-0.8002, dtype=torch.float64)
19 gae_duplicate tensor(-0.8002, dtype=torch.float64) tensor(2.3575, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8981, dtype=torch.float64) delta_t tensor(0.5715, dtype=torch.float64)
18 gae_duplicate tensor(-0.0687, dtype=torch.float64) tensor(0.0967, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8982, dtype=torch.float64) delta_t tensor(0.5717, dtype=torch.float64)
17 gae_duplicate tensor(0.5167, dtype=torch.float64) tensor(-0.7273, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.2227, dtype=torch.float64)
16 gae_duplicate tensor(0.6361, dtype=torch.float64) tensor(-0.4571, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8332, dtype=torch.float64) delta_t tensor(0.4435, dtype=torch.float64)
15 gae_duplicate tensor(0.9524, dtype=torch.float64) tensor(-0.6781, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8334, dtype=torch.float64) delta_t tensor(0.4345, dtype=torch.float64)
14 gae_duplicate tensor(1.1964, dtype=torch.float64) tensor(-0.8594, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8335, dtype=torch.float64) delta_t tensor(0.4270, dtype=torch.float64)
13 gae_duplicate tensor(1.3841, dtype=torch.float64) tensor(-1.0032, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7030, dtype=torch.float64) delta_t tensor(-0.1162, dtype=torch.float64)
12 gae_duplicate tensor(0.9911, dtype=torch.float64) tensor(-1.9589, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.4169, dtype=torch.float64)
11 gae_duplicate tensor(1.2097, dtype=torch.float64) tensor(-2.3911, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.4171, dtype=torch.float64)
10 gae_duplicate tensor(1.3848, dtype=torch.float64) tensor(-1.0317, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4725, dtype=torch.float64) delta_t tensor(-0.9888, dtype=torch.float64)
9 gae_duplicate tensor(0.1191, dtype=torch.float64) tensor(-0.1996, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5379, dtype=torch.float64) delta_t tensor(-1.0332, dtype=torch.float64)
8 gae_duplicate tensor(-0.9379, dtype=torch.float64) tensor(0.7189, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6686, dtype=torch.float64) delta_t tensor(-0.5527, dtype=torch.float64)
7 gae_duplicate tensor(-1.3031, dtype=torch.float64) tensor(2.2455, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1259, dtype=torch.float64) delta_t tensor(-0.4278, dtype=torch.float64)
6 gae_duplicate tensor(-1.4703, dtype=torch.float64) tensor(1.8242, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8447, dtype=torch.float64) delta_t tensor(-0.3610, dtype=torch.float64)
5 gae_duplicate tensor(-1.5372, dtype=torch.float64) tensor(1.6714, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4988, dtype=torch.float64) delta_t tensor(-1.6230, dtype=torch.float64)
4 gae_duplicate tensor(-2.8527, dtype=torch.float64) tensor(3.1435, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0487, dtype=torch.float64) delta_t tensor(1.0842, dtype=torch.float64)
3 gae_duplicate tensor(-1.1980, dtype=torch.float64) tensor(1.3430, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5396, dtype=torch.float64) delta_t tensor(0.6176, dtype=torch.float64)
2 gae_duplicate tensor(-0.3408, dtype=torch.float64) tensor(0.5277, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-28.608741760253906
value loss:40.11088562011719
entropies:29.230266571044922
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.3002848625183105 seconds
19 rew tensor(0.2454, dtype=torch.float64) delta_t tensor(-1.7330, dtype=torch.float64)
19 gae_duplicate tensor(-1.7330, dtype=torch.float64) tensor(0.9123, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.5385, dtype=torch.float64) delta_t tensor(-1.0842, dtype=torch.float64)
18 gae_duplicate tensor(-2.4706, dtype=torch.float64) tensor(1.7374, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-1.7798, dtype=torch.float64) delta_t tensor(-1.9194, dtype=torch.float64)
17 gae_duplicate tensor(-3.8959, dtype=torch.float64) tensor(7.1728, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.4206, dtype=torch.float64)
16 gae_duplicate tensor(-2.6961, dtype=torch.float64) tensor(5.0951, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8332, dtype=torch.float64) delta_t tensor(0.4141, dtype=torch.float64)
15 gae_duplicate tensor(-1.7428, dtype=torch.float64) tensor(2.2383, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.5026, dtype=torch.float64)
14 gae_duplicate tensor(-0.8916, dtype=torch.float64) tensor(1.6999, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.5028, dtype=torch.float64)
13 gae_duplicate tensor(-0.2105, dtype=torch.float64) tensor(0.2667, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.2473, dtype=torch.float64)
12 gae_duplicate tensor(0.0789, dtype=torch.float64) tensor(-0.0638, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8339, dtype=torch.float64) delta_t tensor(0.3830, dtype=torch.float64)
11 gae_duplicate tensor(0.4461, dtype=torch.float64) tensor(-1.6903, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7034, dtype=torch.float64) delta_t tensor(0.3094, dtype=torch.float64)
10 gae_duplicate tensor(0.6662, dtype=torch.float64) tensor(-0.4994, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0502, dtype=torch.float64) delta_t tensor(-0.3265, dtype=torch.float64)
9 gae_duplicate tensor(0.2065, dtype=torch.float64) tensor(-0.1551, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6684, dtype=torch.float64) delta_t tensor(-1.0097, dtype=torch.float64)
8 gae_duplicate tensor(-0.8445, dtype=torch.float64) tensor(1.5847, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7991, dtype=torch.float64) delta_t tensor(-1.0639, dtype=torch.float64)
7 gae_duplicate tensor(-1.7395, dtype=torch.float64) tensor(3.1417, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0605, dtype=torch.float64) delta_t tensor(-1.2000, dtype=torch.float64)
6 gae_duplicate tensor(-2.5916, dtype=torch.float64) tensor(3.2680, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9098, dtype=torch.float64) delta_t tensor(0.3166, dtype=torch.float64)
5 gae_duplicate tensor(-1.7567, dtype=torch.float64) tensor(3.9980, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4334, dtype=torch.float64) delta_t tensor(-1.2534, dtype=torch.float64)
4 gae_duplicate tensor(-2.6588, dtype=torch.float64) tensor(3.0698, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4088, dtype=torch.float64) delta_t tensor(0.2427, dtype=torch.float64)
3 gae_duplicate tensor(-1.8843, dtype=torch.float64) tensor(2.3635, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4088, dtype=torch.float64) delta_t tensor(0.7188, dtype=torch.float64)
2 gae_duplicate tensor(-0.7887, dtype=torch.float64) tensor(1.0681, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-212.13644409179688
value loss:91.35845184326172
entropies:29.6550235748291
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5445709228515625 seconds
19 rew tensor(0.8983, dtype=torch.float64) delta_t tensor(-0.9694, dtype=torch.float64)
19 gae_duplicate tensor(-0.9694, dtype=torch.float64) tensor(0.6834, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.4626, dtype=torch.float64)
18 gae_duplicate tensor(-0.3129, dtype=torch.float64) tensor(0.2399, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(-0.0399, dtype=torch.float64)
17 gae_duplicate tensor(-0.2902, dtype=torch.float64) tensor(0.2722, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.8653, dtype=torch.float64)
16 gae_duplicate tensor(0.6331, dtype=torch.float64) tensor(-0.8566, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.4950, dtype=torch.float64)
15 gae_duplicate tensor(1.0015, dtype=torch.float64) tensor(-1.3742, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.4952, dtype=torch.float64)
14 gae_duplicate tensor(1.2964, dtype=torch.float64) tensor(-1.7788, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(-0.0274, dtype=torch.float64)
13 gae_duplicate tensor(1.0098, dtype=torch.float64) tensor(-3.7282, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.3547, dtype=torch.float64)
12 gae_duplicate tensor(1.1625, dtype=torch.float64) tensor(-3.6766, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.3460, dtype=torch.float64)
11 gae_duplicate tensor(1.2760, dtype=torch.float64) tensor(-2.0717, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.6248, dtype=torch.float64)
10 gae_duplicate tensor(1.6456, dtype=torch.float64) tensor(-4.9062, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3120, dtype=torch.float64) delta_t tensor(-1.2456, dtype=torch.float64)
9 gae_duplicate tensor(0.0709, dtype=torch.float64) tensor(-0.0839, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3411, dtype=torch.float64) delta_t tensor(-0.1981, dtype=torch.float64)
8 gae_duplicate tensor(-0.1413, dtype=torch.float64) tensor(0.1415, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1249, dtype=torch.float64) delta_t tensor(0.1474, dtype=torch.float64)
7 gae_duplicate tensor(0.0343, dtype=torch.float64) tensor(-0.0511, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4067, dtype=torch.float64) delta_t tensor(-0.2541, dtype=torch.float64)
6 gae_duplicate tensor(-0.2267, dtype=torch.float64) tensor(0.2709, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.4313, dtype=torch.float64) delta_t tensor(-0.4173, dtype=torch.float64)
5 gae_duplicate tensor(-0.5986, dtype=torch.float64) tensor(0.7754, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7687, dtype=torch.float64) delta_t tensor(0.9635, dtype=torch.float64)
4 gae_duplicate tensor(0.4846, dtype=torch.float64) tensor(-0.5293, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7794, dtype=torch.float64) delta_t tensor(0.0139, dtype=torch.float64)
3 gae_duplicate tensor(0.4016, dtype=torch.float64) tensor(-1.3228, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5385, dtype=torch.float64) delta_t tensor(-0.5325, dtype=torch.float64)
2 gae_duplicate tensor(-0.2112, dtype=torch.float64) tensor(0.6811, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:102.96037292480469
value loss:17.685272216796875
entropies:30.972856521606445
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(405.4583)
ToM Target loss= tensor(310.4468)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.525070905685425 seconds
19 rew tensor(0.8977, dtype=torch.float64) delta_t tensor(-0.9827, dtype=torch.float64)
19 gae_duplicate tensor(-0.9827, dtype=torch.float64) tensor(1.6395, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8979, dtype=torch.float64) delta_t tensor(0.5218, dtype=torch.float64)
18 gae_duplicate tensor(-0.2644, dtype=torch.float64) tensor(0.4410, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8980, dtype=torch.float64) delta_t tensor(0.5220, dtype=torch.float64)
17 gae_duplicate tensor(0.3105, dtype=torch.float64) tensor(-0.8073, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8982, dtype=torch.float64) delta_t tensor(0.5221, dtype=torch.float64)
16 gae_duplicate tensor(0.7705, dtype=torch.float64) tensor(-0.6618, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.5223, dtype=torch.float64)
15 gae_duplicate tensor(1.1387, dtype=torch.float64) tensor(-0.9780, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(0.5225, dtype=torch.float64)
14 gae_duplicate tensor(1.4334, dtype=torch.float64) tensor(-1.2311, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.5226, dtype=torch.float64)
13 gae_duplicate tensor(1.6694, dtype=torch.float64) tensor(-1.4338, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.5228, dtype=torch.float64)
12 gae_duplicate tensor(1.8583, dtype=torch.float64) tensor(-3.1002, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.5230, dtype=torch.float64)
11 gae_duplicate tensor(2.0096, dtype=torch.float64) tensor(-3.5985, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.5231, dtype=torch.float64)
10 gae_duplicate tensor(2.1308, dtype=torch.float64) tensor(-5.5403, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4723, dtype=torch.float64) delta_t tensor(-0.8251, dtype=torch.float64)
9 gae_duplicate tensor(0.8795, dtype=torch.float64) tensor(-1.5670, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5376, dtype=torch.float64) delta_t tensor(-0.8259, dtype=torch.float64)
8 gae_duplicate tensor(-0.1223, dtype=torch.float64) tensor(0.1099, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6683, dtype=torch.float64) delta_t tensor(-0.5556, dtype=torch.float64)
7 gae_duplicate tensor(-0.6534, dtype=torch.float64) tensor(1.1310, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5173, dtype=torch.float64) delta_t tensor(-1.9736, dtype=torch.float64)
6 gae_duplicate tensor(-2.4963, dtype=torch.float64) tensor(2.6608, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5178, dtype=torch.float64) delta_t tensor(0.7750, dtype=torch.float64)
5 gae_duplicate tensor(-1.2221, dtype=torch.float64) tensor(1.7041, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7594, dtype=torch.float64) delta_t tensor(-5.3982, dtype=torch.float64)
4 gae_duplicate tensor(-6.3759, dtype=torch.float64) tensor(8.5697, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1141, dtype=torch.float64) delta_t tensor(4.2373, dtype=torch.float64)
3 gae_duplicate tensor(-0.8634, dtype=torch.float64) tensor(2.6904, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0488, dtype=torch.float64) delta_t tensor(1.0051, dtype=torch.float64)
2 gae_duplicate tensor(0.3144, dtype=torch.float64) tensor(-0.5473, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2.207263469696045
value loss:105.49747467041016
entropies:30.212379455566406
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.550506830215454 seconds
19 rew tensor(0.8981, dtype=torch.float64) delta_t tensor(-1.4915, dtype=torch.float64)
19 gae_duplicate tensor(-1.4915, dtype=torch.float64) tensor(3.1309, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8982, dtype=torch.float64) delta_t tensor(0.2879, dtype=torch.float64)
18 gae_duplicate tensor(-0.9053, dtype=torch.float64) tensor(1.0465, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(1.2816, dtype=torch.float64)
17 gae_duplicate tensor(0.5573, dtype=torch.float64) tensor(-2.1465, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(0.2935, dtype=torch.float64)
16 gae_duplicate tensor(0.7394, dtype=torch.float64) tensor(-0.9140, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.7514, dtype=torch.float64)
15 gae_duplicate tensor(1.3429, dtype=torch.float64) tensor(-4.1644, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(-0.2379, dtype=torch.float64)
14 gae_duplicate tensor(0.8365, dtype=torch.float64) tensor(-2.6497, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7029, dtype=torch.float64) delta_t tensor(-0.0438, dtype=torch.float64)
13 gae_duplicate tensor(0.6254, dtype=torch.float64) tensor(-1.9340, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7030, dtype=torch.float64) delta_t tensor(0.2690, dtype=torch.float64)
12 gae_duplicate tensor(0.7693, dtype=torch.float64) tensor(-1.0042, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5070, dtype=torch.float64) delta_t tensor(0.1940, dtype=torch.float64)
11 gae_duplicate tensor(0.8094, dtype=torch.float64) tensor(-1.4450, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5071, dtype=torch.float64) delta_t tensor(0.1473, dtype=torch.float64)
10 gae_duplicate tensor(0.7948, dtype=torch.float64) tensor(-1.3234, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1464, dtype=torch.float64) delta_t tensor(-0.9310, dtype=torch.float64)
9 gae_duplicate tensor(-0.2952, dtype=torch.float64) tensor(0.9203, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6692, dtype=torch.float64) delta_t tensor(0.1627, dtype=torch.float64)
8 gae_duplicate tensor(-0.0735, dtype=torch.float64) tensor(0.1293, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0495, dtype=torch.float64) delta_t tensor(-0.0764, dtype=torch.float64)
7 gae_duplicate tensor(-0.1352, dtype=torch.float64) tensor(0.1538, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4732, dtype=torch.float64) delta_t tensor(0.4700, dtype=torch.float64)
6 gae_duplicate tensor(0.3619, dtype=torch.float64) tensor(-0.4317, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1266, dtype=torch.float64) delta_t tensor(0.1408, dtype=torch.float64)
5 gae_duplicate tensor(0.4303, dtype=torch.float64) tensor(-0.8804, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6496, dtype=torch.float64) delta_t tensor(-1.7361, dtype=torch.float64)
4 gae_duplicate tensor(-1.3918, dtype=torch.float64) tensor(2.3310, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4740, dtype=torch.float64) delta_t tensor(1.6895, dtype=torch.float64)
3 gae_duplicate tensor(0.5761, dtype=torch.float64) tensor(-1.9085, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4740, dtype=torch.float64) delta_t tensor(-0.2026, dtype=torch.float64)
2 gae_duplicate tensor(0.2582, dtype=torch.float64) tensor(-0.3970, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:67.9708480834961
value loss:17.155908584594727
entropies:31.714122772216797
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.422887802124023 seconds
19 rew tensor(0.8983, dtype=torch.float64) delta_t tensor(-0.5942, dtype=torch.float64)
19 gae_duplicate tensor(-0.5942, dtype=torch.float64) tensor(0.8795, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(0.6000, dtype=torch.float64)
18 gae_duplicate tensor(0.1247, dtype=torch.float64) tensor(-0.1845, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.6002, dtype=torch.float64)
17 gae_duplicate tensor(0.6999, dtype=torch.float64) tensor(-1.0480, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.6497, dtype=torch.float64)
16 gae_duplicate tensor(1.2096, dtype=torch.float64) tensor(-1.8190, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.6104, dtype=torch.float64)
15 gae_duplicate tensor(1.5780, dtype=torch.float64) tensor(-2.3461, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(-0.1149, dtype=torch.float64)
14 gae_duplicate tensor(1.1475, dtype=torch.float64) tensor(-3.3320, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.4783, dtype=torch.float64)
13 gae_duplicate tensor(1.3963, dtype=torch.float64) tensor(-2.4400, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4415, dtype=torch.float64) delta_t tensor(-0.6235, dtype=torch.float64)
12 gae_duplicate tensor(0.4936, dtype=torch.float64) tensor(-0.8387, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1145, dtype=torch.float64) delta_t tensor(2.8413, dtype=torch.float64)
11 gae_duplicate tensor(3.2362, dtype=torch.float64) tensor(-5.1134, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0817, dtype=torch.float64) delta_t tensor(-2.7044, dtype=torch.float64)
10 gae_duplicate tensor(-0.1155, dtype=torch.float64) tensor(0.1438, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8665, dtype=torch.float64) delta_t tensor(-1.0604, dtype=torch.float64)
9 gae_duplicate tensor(-1.1528, dtype=torch.float64) tensor(3.3280, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6375, dtype=torch.float64) delta_t tensor(0.6679, dtype=torch.float64)
8 gae_duplicate tensor(-0.2544, dtype=torch.float64) tensor(0.2760, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8665, dtype=torch.float64) delta_t tensor(-1.3198, dtype=torch.float64)
7 gae_duplicate tensor(-1.5233, dtype=torch.float64) tensor(1.8275, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7028, dtype=torch.float64) delta_t tensor(1.3439, dtype=torch.float64)
6 gae_duplicate tensor(0.1253, dtype=torch.float64) tensor(-0.2837, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0626, dtype=torch.float64) delta_t tensor(0.0468, dtype=torch.float64)
5 gae_duplicate tensor(0.1470, dtype=torch.float64) tensor(-0.2894, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2128, dtype=torch.float64) delta_t tensor(1.0026, dtype=torch.float64)
4 gae_duplicate tensor(1.1203, dtype=torch.float64) tensor(-3.2552, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3243, dtype=torch.float64) delta_t tensor(-0.2147, dtype=torch.float64)
3 gae_duplicate tensor(0.6815, dtype=torch.float64) tensor(-1.1734, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1939, dtype=torch.float64) delta_t tensor(-0.2094, dtype=torch.float64)
2 gae_duplicate tensor(0.3358, dtype=torch.float64) tensor(-0.5223, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:96.17515563964844
value loss:36.58683776855469
entropies:32.34836959838867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.572150945663452 seconds
19 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(-1.9293, dtype=torch.float64)
19 gae_duplicate tensor(-1.9293, dtype=torch.float64) tensor(2.2855, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(0.3331, dtype=torch.float64)
18 gae_duplicate tensor(-1.2104, dtype=torch.float64) tensor(2.4312, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.3332, dtype=torch.float64)
17 gae_duplicate tensor(-0.6351, dtype=torch.float64) tensor(1.2756, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.1724, dtype=torch.float64)
16 gae_duplicate tensor(-0.3356, dtype=torch.float64) tensor(0.5933, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(-0.2182, dtype=torch.float64)
15 gae_duplicate tensor(-0.4867, dtype=torch.float64) tensor(0.6308, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.4143, dtype=torch.float64)
14 gae_duplicate tensor(0.0249, dtype=torch.float64) tensor(-0.0466, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.4292, dtype=torch.float64)
13 gae_duplicate tensor(0.4491, dtype=torch.float64) tensor(-0.5963, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3762, dtype=torch.float64) delta_t tensor(0.0362, dtype=torch.float64)
12 gae_duplicate tensor(0.3955, dtype=torch.float64) tensor(-0.5152, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3762, dtype=torch.float64) delta_t tensor(-0.4578, dtype=torch.float64)
11 gae_duplicate tensor(-0.1414, dtype=torch.float64) tensor(0.2336, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2125, dtype=torch.float64) delta_t tensor(-0.3612, dtype=torch.float64)
10 gae_duplicate tensor(-0.4743, dtype=torch.float64) tensor(0.8891, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2779, dtype=torch.float64) delta_t tensor(0.3920, dtype=torch.float64)
9 gae_duplicate tensor(0.0126, dtype=torch.float64) tensor(-0.0261, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1799, dtype=torch.float64) delta_t tensor(0.1266, dtype=torch.float64)
8 gae_duplicate tensor(0.1367, dtype=torch.float64) tensor(-0.2225, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1471, dtype=torch.float64) delta_t tensor(-0.8487, dtype=torch.float64)
7 gae_duplicate tensor(-0.7394, dtype=torch.float64) tensor(2.1439, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.8473, dtype=torch.float64) delta_t tensor(-0.9699, dtype=torch.float64)
6 gae_duplicate tensor(-1.5614, dtype=torch.float64) tensor(2.3985, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1098, dtype=torch.float64) delta_t tensor(-1.0392, dtype=torch.float64)
5 gae_duplicate tensor(-2.2883, dtype=torch.float64) tensor(6.0975, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1480, dtype=torch.float64) delta_t tensor(1.0706, dtype=torch.float64)
4 gae_duplicate tensor(-0.7601, dtype=torch.float64) tensor(0.9368, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.1108, dtype=torch.float64) delta_t tensor(-0.6813, dtype=torch.float64)
3 gae_duplicate tensor(-1.2893, dtype=torch.float64) tensor(1.9645, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2139, dtype=torch.float64) delta_t tensor(-4.2830, dtype=torch.float64)
2 gae_duplicate tensor(-5.3144, dtype=torch.float64) tensor(19.1973, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-238.99838256835938
value loss:67.8994140625
entropies:32.40058517456055
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.70917820930481 seconds
19 rew tensor(0.7685, dtype=torch.float64) delta_t tensor(-1.1675, dtype=torch.float64)
19 gae_duplicate tensor(-1.1675, dtype=torch.float64) tensor(1.8307, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7032, dtype=torch.float64) delta_t tensor(0.2771, dtype=torch.float64)
18 gae_duplicate tensor(-0.6569, dtype=torch.float64) tensor(0.6916, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5067, dtype=torch.float64) delta_t tensor(0.2428, dtype=torch.float64)
17 gae_duplicate tensor(-0.2827, dtype=torch.float64) tensor(0.5976, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1793, dtype=torch.float64) delta_t tensor(-1.0624, dtype=torch.float64)
16 gae_duplicate tensor(-1.2886, dtype=torch.float64) tensor(2.3648, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.4756, dtype=torch.float64) delta_t tensor(-1.1974, dtype=torch.float64)
15 gae_duplicate tensor(-2.2283, dtype=torch.float64) tensor(2.9720, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8341, dtype=torch.float64) delta_t tensor(0.4281, dtype=torch.float64)
14 gae_duplicate tensor(-1.3545, dtype=torch.float64) tensor(4.0572, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.3553, dtype=torch.float64)
13 gae_duplicate tensor(-0.7283, dtype=torch.float64) tensor(0.9818, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7689, dtype=torch.float64) delta_t tensor(-0.0537, dtype=torch.float64)
12 gae_duplicate tensor(-0.6364, dtype=torch.float64) tensor(1.1403, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4416, dtype=torch.float64) delta_t tensor(-0.1888, dtype=torch.float64)
11 gae_duplicate tensor(-0.6979, dtype=torch.float64) tensor(0.9091, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1143, dtype=torch.float64) delta_t tensor(-0.6757, dtype=torch.float64)
10 gae_duplicate tensor(-1.2340, dtype=torch.float64) tensor(1.6029, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5404, dtype=torch.float64) delta_t tensor(-0.9274, dtype=torch.float64)
9 gae_duplicate tensor(-1.9146, dtype=torch.float64) tensor(3.5380, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8023, dtype=torch.float64) delta_t tensor(0.0925, dtype=torch.float64)
8 gae_duplicate tensor(-1.4392, dtype=torch.float64) tensor(2.5226, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9334, dtype=torch.float64) delta_t tensor(-1.3842, dtype=torch.float64)
7 gae_duplicate tensor(-2.5356, dtype=torch.float64) tensor(3.1912, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0645, dtype=torch.float64) delta_t tensor(0.0839, dtype=torch.float64)
6 gae_duplicate tensor(-1.9445, dtype=torch.float64) tensor(3.8720, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4410, dtype=torch.float64) delta_t tensor(1.1701, dtype=torch.float64)
5 gae_duplicate tensor(-0.3855, dtype=torch.float64) tensor(0.4424, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6063, dtype=torch.float64) delta_t tensor(0.4579, dtype=torch.float64)
4 gae_duplicate tensor(0.1495, dtype=torch.float64) tensor(-0.1835, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3754, dtype=torch.float64) delta_t tensor(1.2453, dtype=torch.float64)
3 gae_duplicate tensor(1.3649, dtype=torch.float64) tensor(-1.6371, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6717, dtype=torch.float64) delta_t tensor(-0.5274, dtype=torch.float64)
2 gae_duplicate tensor(0.5645, dtype=torch.float64) tensor(-0.8771, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-169.052490234375
value loss:47.369937896728516
entropies:31.74359130859375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(404.2474)
ToM Target loss= tensor(309.3753)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.416437864303589 seconds
19 rew tensor(0.8346, dtype=torch.float64) delta_t tensor(-1.6861, dtype=torch.float64)
19 gae_duplicate tensor(-1.6861, dtype=torch.float64) tensor(1.7586, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8347, dtype=torch.float64) delta_t tensor(0.3260, dtype=torch.float64)
18 gae_duplicate tensor(-1.0229, dtype=torch.float64) tensor(1.0791, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7694, dtype=torch.float64) delta_t tensor(0.2490, dtype=torch.float64)
17 gae_duplicate tensor(-0.5693, dtype=torch.float64) tensor(0.8009, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6385, dtype=torch.float64) delta_t tensor(0.5773, dtype=torch.float64)
16 gae_duplicate tensor(0.1219, dtype=torch.float64) tensor(-0.1136, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3110, dtype=torch.float64) delta_t tensor(0.0452, dtype=torch.float64)
15 gae_duplicate tensor(0.1427, dtype=torch.float64) tensor(-0.1477, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.2130, dtype=torch.float64) delta_t tensor(-1.0260, dtype=torch.float64)
14 gae_duplicate tensor(-0.9118, dtype=torch.float64) tensor(1.2630, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8350, dtype=torch.float64) delta_t tensor(0.3588, dtype=torch.float64)
13 gae_duplicate tensor(-0.3706, dtype=torch.float64) tensor(0.6670, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7696, dtype=torch.float64) delta_t tensor(0.2234, dtype=torch.float64)
12 gae_duplicate tensor(-0.0731, dtype=torch.float64) tensor(0.0990, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7042, dtype=torch.float64) delta_t tensor(0.0812, dtype=torch.float64)
11 gae_duplicate tensor(0.0228, dtype=torch.float64) tensor(-0.0414, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5733, dtype=torch.float64) delta_t tensor(0.1226, dtype=torch.float64)
10 gae_duplicate tensor(0.1408, dtype=torch.float64) tensor(-0.1896, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3911, dtype=torch.float64) delta_t tensor(-2.0940, dtype=torch.float64)
9 gae_duplicate tensor(-1.9813, dtype=torch.float64) tensor(2.4757, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3767, dtype=torch.float64) delta_t tensor(0.0037, dtype=torch.float64)
8 gae_duplicate tensor(-1.5814, dtype=torch.float64) tensor(4.8357, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8675, dtype=torch.float64) delta_t tensor(-0.2575, dtype=torch.float64)
7 gae_duplicate tensor(-1.5225, dtype=torch.float64) tensor(2.3558, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9986, dtype=torch.float64) delta_t tensor(-1.1128, dtype=torch.float64)
6 gae_duplicate tensor(-2.3308, dtype=torch.float64) tensor(3.2527, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9988, dtype=torch.float64) delta_t tensor(1.2975, dtype=torch.float64)
5 gae_duplicate tensor(-0.5672, dtype=torch.float64) tensor(0.7300, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8980, dtype=torch.float64) delta_t tensor(-2.9767, dtype=torch.float64)
4 gae_duplicate tensor(-3.4304, dtype=torch.float64) tensor(6.2795, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2794, dtype=torch.float64) delta_t tensor(1.7190, dtype=torch.float64)
3 gae_duplicate tensor(-1.0254, dtype=torch.float64) tensor(1.6012, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4105, dtype=torch.float64) delta_t tensor(-1.5605, dtype=torch.float64)
2 gae_duplicate tensor(-2.3808, dtype=torch.float64) tensor(3.2683, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-180.80198669433594
value loss:57.34425354003906
entropies:31.866079330444336
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.3325440883636475 seconds
19 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(-1.3544, dtype=torch.float64)
19 gae_duplicate tensor(-1.3544, dtype=torch.float64) tensor(4.3583, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.3854, dtype=torch.float64)
18 gae_duplicate tensor(-0.6981, dtype=torch.float64) tensor(1.5743, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.8370, dtype=torch.float64)
17 gae_duplicate tensor(0.2785, dtype=torch.float64) tensor(-0.2843, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(1.1907, dtype=torch.float64)
16 gae_duplicate tensor(1.4135, dtype=torch.float64) tensor(-1.6521, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(-0.2756, dtype=torch.float64)
15 gae_duplicate tensor(0.8553, dtype=torch.float64) tensor(-1.2577, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.6230, dtype=torch.float64)
14 gae_duplicate tensor(1.3072, dtype=torch.float64) tensor(-1.9692, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.5866, dtype=torch.float64)
13 gae_duplicate tensor(1.6323, dtype=torch.float64) tensor(-2.4904, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(0.7488, dtype=torch.float64)
12 gae_duplicate tensor(2.0546, dtype=torch.float64) tensor(-3.3547, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(3.1277, dtype=torch.float64)
11 gae_duplicate tensor(4.7714, dtype=torch.float64) tensor(-7.8602, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1467, dtype=torch.float64) delta_t tensor(-3.6646, dtype=torch.float64)
10 gae_duplicate tensor(0.1525, dtype=torch.float64) tensor(-0.2022, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0639, dtype=torch.float64) delta_t tensor(0.1939, dtype=torch.float64)
9 gae_duplicate tensor(0.3159, dtype=torch.float64) tensor(-0.5270, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1469, dtype=torch.float64) delta_t tensor(-1.7946, dtype=torch.float64)
8 gae_duplicate tensor(-1.5419, dtype=torch.float64) tensor(1.9395, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8675, dtype=torch.float64) delta_t tensor(-0.3541, dtype=torch.float64)
7 gae_duplicate tensor(-1.5876, dtype=torch.float64) tensor(2.0849, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7044, dtype=torch.float64) delta_t tensor(1.2488, dtype=torch.float64)
6 gae_duplicate tensor(-0.0213, dtype=torch.float64) tensor(0.0460, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8500, dtype=torch.float64) delta_t tensor(-0.0861, dtype=torch.float64)
5 gae_duplicate tensor(-0.1031, dtype=torch.float64) tensor(0.1607, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2129, dtype=torch.float64) delta_t tensor(0.2516, dtype=torch.float64)
4 gae_duplicate tensor(0.1690, dtype=torch.float64) tensor(-0.2633, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.1127, dtype=torch.float64) delta_t tensor(-0.8066, dtype=torch.float64)
3 gae_duplicate tensor(-0.6713, dtype=torch.float64) tensor(1.0351, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6721, dtype=torch.float64) delta_t tensor(0.0132, dtype=torch.float64)
2 gae_duplicate tensor(-0.5239, dtype=torch.float64) tensor(0.8161, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:46.10660171508789
value loss:63.412986755371094
entropies:32.377620697021484
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.574757814407349 seconds
19 rew tensor(0.7697, dtype=torch.float64) delta_t tensor(-0.7984, dtype=torch.float64)
19 gae_duplicate tensor(-0.7984, dtype=torch.float64) tensor(0.6786, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6387, dtype=torch.float64) delta_t tensor(0.1709, dtype=torch.float64)
18 gae_duplicate tensor(-0.4679, dtype=torch.float64) tensor(0.8287, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3112, dtype=torch.float64) delta_t tensor(-0.4381, dtype=torch.float64)
17 gae_duplicate tensor(-0.8124, dtype=torch.float64) tensor(1.9097, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.0818, dtype=torch.float64) delta_t tensor(-0.4430, dtype=torch.float64)
16 gae_duplicate tensor(-1.0929, dtype=torch.float64) tensor(1.2631, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-1.1299, dtype=torch.float64) delta_t tensor(-1.6835, dtype=torch.float64)
15 gae_duplicate tensor(-2.5578, dtype=torch.float64) tensor(8.2685, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.4598, dtype=torch.float64)
14 gae_duplicate tensor(-1.5864, dtype=torch.float64) tensor(2.3376, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.4600, dtype=torch.float64)
13 gae_duplicate tensor(-0.8092, dtype=torch.float64) tensor(1.1924, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.4601, dtype=torch.float64)
12 gae_duplicate tensor(-0.1872, dtype=torch.float64) tensor(0.3168, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.4603, dtype=torch.float64)
11 gae_duplicate tensor(0.3105, dtype=torch.float64) tensor(-0.4575, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.5448, dtype=torch.float64)
10 gae_duplicate tensor(0.7932, dtype=torch.float64) tensor(-1.2107, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5397, dtype=torch.float64) delta_t tensor(-0.8797, dtype=torch.float64)
9 gae_duplicate tensor(-0.2451, dtype=torch.float64) tensor(0.7874, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5397, dtype=torch.float64) delta_t tensor(-0.9313, dtype=torch.float64)
8 gae_duplicate tensor(-1.1274, dtype=torch.float64) tensor(1.8839, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6708, dtype=torch.float64) delta_t tensor(-0.9373, dtype=torch.float64)
7 gae_duplicate tensor(-1.8392, dtype=torch.float64) tensor(2.7807, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9983, dtype=torch.float64) delta_t tensor(-1.0613, dtype=torch.float64)
6 gae_duplicate tensor(-2.5327, dtype=torch.float64) tensor(4.0579, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6534, dtype=torch.float64) delta_t tensor(0.5577, dtype=torch.float64)
5 gae_duplicate tensor(-1.4684, dtype=torch.float64) tensor(2.3884, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0295, dtype=torch.float64) delta_t tensor(-2.0759, dtype=torch.float64)
4 gae_duplicate tensor(-3.2507, dtype=torch.float64) tensor(4.1374, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2138, dtype=torch.float64) delta_t tensor(1.4108, dtype=torch.float64)
3 gae_duplicate tensor(-1.1898, dtype=torch.float64) tensor(3.8188, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2138, dtype=torch.float64) delta_t tensor(0.7506, dtype=torch.float64)
2 gae_duplicate tensor(-0.2012, dtype=torch.float64) tensor(0.3137, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-212.74110412597656
value loss:57.73968505859375
entropies:32.29700469970703
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.418324947357178 seconds
19 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(-0.8129, dtype=torch.float64)
19 gae_duplicate tensor(-0.8129, dtype=torch.float64) tensor(2.6329, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(-0.1544, dtype=torch.float64)
18 gae_duplicate tensor(-0.8047, dtype=torch.float64) tensor(0.8922, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.9746, dtype=torch.float64)
17 gae_duplicate tensor(0.3309, dtype=torch.float64) tensor(-0.6877, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.0889, dtype=torch.float64)
16 gae_duplicate tensor(0.3536, dtype=torch.float64) tensor(-0.4679, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.2030, dtype=torch.float64)
15 gae_duplicate tensor(0.4858, dtype=torch.float64) tensor(-0.7515, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(0.4022, dtype=torch.float64)
14 gae_duplicate tensor(0.7909, dtype=torch.float64) tensor(-2.4034, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(0.4765, dtype=torch.float64)
13 gae_duplicate tensor(1.1092, dtype=torch.float64) tensor(-1.7195, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.0517, dtype=torch.float64)
12 gae_duplicate tensor(0.9391, dtype=torch.float64) tensor(-1.4206, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(0.4743, dtype=torch.float64)
11 gae_duplicate tensor(1.2255, dtype=torch.float64) tensor(-4.0894, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3779, dtype=torch.float64) delta_t tensor(-0.1606, dtype=torch.float64)
10 gae_duplicate tensor(0.8198, dtype=torch.float64) tensor(-1.2129, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2468, dtype=torch.float64) delta_t tensor(0.3886, dtype=torch.float64)
9 gae_duplicate tensor(1.0444, dtype=torch.float64) tensor(-1.5001, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5397, dtype=torch.float64) delta_t tensor(-2.0947, dtype=torch.float64)
8 gae_duplicate tensor(-1.2591, dtype=torch.float64) tensor(1.5902, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7364, dtype=torch.float64) delta_t tensor(-1.2346, dtype=torch.float64)
7 gae_duplicate tensor(-2.2419, dtype=torch.float64) tensor(3.0909, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8676, dtype=torch.float64) delta_t tensor(1.6056, dtype=torch.float64)
6 gae_duplicate tensor(-0.1879, dtype=torch.float64) tensor(0.3082, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6056, dtype=torch.float64) delta_t tensor(0.0994, dtype=torch.float64)
5 gae_duplicate tensor(-0.0509, dtype=torch.float64) tensor(0.0644, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8023, dtype=torch.float64) delta_t tensor(0.3503, dtype=torch.float64)
4 gae_duplicate tensor(0.3096, dtype=torch.float64) tensor(-0.6065, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5233, dtype=torch.float64) delta_t tensor(-0.2418, dtype=torch.float64)
3 gae_duplicate tensor(0.0058, dtype=torch.float64) tensor(-0.0095, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5407, dtype=torch.float64) delta_t tensor(-0.6411, dtype=torch.float64)
2 gae_duplicate tensor(-0.6365, dtype=torch.float64) tensor(1.0030, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:30.74292755126953
value loss:22.39704132080078
entropies:32.67253494262695
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.344136953353882 seconds
19 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(-1.0054, dtype=torch.float64)
19 gae_duplicate tensor(-1.0054, dtype=torch.float64) tensor(1.6739, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.5186, dtype=torch.float64)
18 gae_duplicate tensor(-0.2857, dtype=torch.float64) tensor(0.4397, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.5187, dtype=torch.float64)
17 gae_duplicate tensor(0.2901, dtype=torch.float64) tensor(-0.4418, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.5189, dtype=torch.float64)
16 gae_duplicate tensor(0.7510, dtype=torch.float64) tensor(-1.1557, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.5190, dtype=torch.float64)
15 gae_duplicate tensor(1.1198, dtype=torch.float64) tensor(-1.8464, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(0.3077, dtype=torch.float64)
14 gae_duplicate tensor(1.2035, dtype=torch.float64) tensor(-2.1806, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.0415, dtype=torch.float64)
13 gae_duplicate tensor(1.0043, dtype=torch.float64) tensor(-3.2217, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.3124, dtype=torch.float64)
12 gae_duplicate tensor(1.1158, dtype=torch.float64) tensor(-1.8348, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.2717, dtype=torch.float64)
11 gae_duplicate tensor(1.1643, dtype=torch.float64) tensor(-1.5958, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(0.3250, dtype=torch.float64)
10 gae_duplicate tensor(1.2565, dtype=torch.float64) tensor(-2.1945, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.2930, dtype=torch.float64)
9 gae_duplicate tensor(1.2981, dtype=torch.float64) tensor(-1.8732, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2115, dtype=torch.float64) delta_t tensor(-0.9063, dtype=torch.float64)
8 gae_duplicate tensor(0.1322, dtype=torch.float64) tensor(-0.2299, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5204, dtype=torch.float64) delta_t tensor(-1.6663, dtype=torch.float64)
7 gae_duplicate tensor(-1.5606, dtype=torch.float64) tensor(2.3041, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6046, dtype=torch.float64) delta_t tensor(-0.0446, dtype=torch.float64)
6 gae_duplicate tensor(-1.2931, dtype=torch.float64) tensor(4.1605, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9319, dtype=torch.float64) delta_t tensor(0.9931, dtype=torch.float64)
5 gae_duplicate tensor(-0.0413, dtype=torch.float64) tensor(0.1180, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.8588, dtype=torch.float64) delta_t tensor(-3.9634, dtype=torch.float64)
4 gae_duplicate tensor(-3.9964, dtype=torch.float64) tensor(4.9897, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2792, dtype=torch.float64) delta_t tensor(-0.4346, dtype=torch.float64)
3 gae_duplicate tensor(-3.6317, dtype=torch.float64) tensor(6.5005, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2792, dtype=torch.float64) delta_t tensor(1.8068, dtype=torch.float64)
2 gae_duplicate tensor(-1.0986, dtype=torch.float64) tensor(3.3887, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-42.99485397338867
value loss:68.71597290039062
entropies:33.00835418701172
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(404.8506)
ToM Target loss= tensor(308.4382)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.619886159896851 seconds
19 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(-1.3760, dtype=torch.float64)
19 gae_duplicate tensor(-1.3760, dtype=torch.float64) tensor(2.1471, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.4448, dtype=torch.float64)
18 gae_duplicate tensor(-0.6560, dtype=torch.float64) tensor(1.0237, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(0.4449, dtype=torch.float64)
17 gae_duplicate tensor(-0.0799, dtype=torch.float64) tensor(0.1247, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.4451, dtype=torch.float64)
16 gae_duplicate tensor(0.3811, dtype=torch.float64) tensor(-0.6009, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8349, dtype=torch.float64) delta_t tensor(0.6301, dtype=torch.float64)
15 gae_duplicate tensor(0.9350, dtype=torch.float64) tensor(-1.2915, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7040, dtype=torch.float64) delta_t tensor(0.3647, dtype=torch.float64)
14 gae_duplicate tensor(1.1127, dtype=torch.float64) tensor(-3.5750, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6387, dtype=torch.float64) delta_t tensor(-0.3211, dtype=torch.float64)
13 gae_duplicate tensor(0.5690, dtype=torch.float64) tensor(-1.0568, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8352, dtype=torch.float64) delta_t tensor(0.3134, dtype=torch.float64)
12 gae_duplicate tensor(0.7686, dtype=torch.float64) tensor(-1.1226, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(0.3920, dtype=torch.float64)
11 gae_duplicate tensor(1.0069, dtype=torch.float64) tensor(-1.3322, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8355, dtype=torch.float64) delta_t tensor(0.3078, dtype=torch.float64)
10 gae_duplicate tensor(1.1133, dtype=torch.float64) tensor(-1.9183, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1154, dtype=torch.float64) delta_t tensor(-0.4735, dtype=torch.float64)
9 gae_duplicate tensor(0.4171, dtype=torch.float64) tensor(-0.7498, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6047, dtype=torch.float64) delta_t tensor(-1.1941, dtype=torch.float64)
8 gae_duplicate tensor(-0.8604, dtype=torch.float64) tensor(1.2212, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8666, dtype=torch.float64) delta_t tensor(-0.9143, dtype=torch.float64)
7 gae_duplicate tensor(-1.6026, dtype=torch.float64) tensor(5.0497, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7359, dtype=torch.float64) delta_t tensor(-1.1763, dtype=torch.float64)
6 gae_duplicate tensor(-2.4583, dtype=torch.float64) tensor(7.5409, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1942, dtype=torch.float64) delta_t tensor(-0.8468, dtype=torch.float64)
5 gae_duplicate tensor(-2.8135, dtype=torch.float64) tensor(8.3853, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3254, dtype=torch.float64) delta_t tensor(1.2656, dtype=torch.float64)
4 gae_duplicate tensor(-0.9852, dtype=torch.float64) tensor(1.5294, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8675, dtype=torch.float64) delta_t tensor(0.2339, dtype=torch.float64)
3 gae_duplicate tensor(-0.5542, dtype=torch.float64) tensor(0.9276, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9331, dtype=torch.float64) delta_t tensor(-0.3750, dtype=torch.float64)
2 gae_duplicate tensor(-0.8184, dtype=torch.float64) tensor(1.1257, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-105.56400299072266
value loss:40.71697998046875
entropies:33.170719146728516
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.370805978775024 seconds
19 rew tensor(0.5732, dtype=torch.float64) delta_t tensor(-1.5743, dtype=torch.float64)
19 gae_duplicate tensor(-1.5743, dtype=torch.float64) tensor(4.4560, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3112, dtype=torch.float64) delta_t tensor(0.0481, dtype=torch.float64)
18 gae_duplicate tensor(-1.2113, dtype=torch.float64) tensor(2.1617, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.4094, dtype=torch.float64) delta_t tensor(-0.9388, dtype=torch.float64)
17 gae_duplicate tensor(-1.9078, dtype=torch.float64) tensor(3.2805, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-1.5230, dtype=torch.float64) delta_t tensor(-2.0697, dtype=torch.float64)
16 gae_duplicate tensor(-3.5960, dtype=torch.float64) tensor(5.9891, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.4528, dtype=torch.float64)
15 gae_duplicate tensor(-2.4239, dtype=torch.float64) tensor(4.0761, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.4530, dtype=torch.float64)
14 gae_duplicate tensor(-1.4861, dtype=torch.float64) tensor(2.2140, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(0.4479, dtype=torch.float64)
13 gae_duplicate tensor(-0.7410, dtype=torch.float64) tensor(1.1093, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8354, dtype=torch.float64) delta_t tensor(0.2486, dtype=torch.float64)
12 gae_duplicate tensor(-0.3442, dtype=torch.float64) tensor(0.5893, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.5141, dtype=torch.float64)
11 gae_duplicate tensor(0.2387, dtype=torch.float64) tensor(-0.3847, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6392, dtype=torch.float64) delta_t tensor(0.2479, dtype=torch.float64)
10 gae_duplicate tensor(0.4389, dtype=torch.float64) tensor(-1.4786, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8017, dtype=torch.float64) delta_t tensor(-1.7223, dtype=torch.float64)
9 gae_duplicate tensor(-1.3713, dtype=torch.float64) tensor(1.7663, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3433, dtype=torch.float64) delta_t tensor(-0.4538, dtype=torch.float64)
8 gae_duplicate tensor(-1.5508, dtype=torch.float64) tensor(2.1932, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5399, dtype=torch.float64) delta_t tensor(-0.7116, dtype=torch.float64)
7 gae_duplicate tensor(-1.9522, dtype=torch.float64) tensor(2.7542, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1293, dtype=torch.float64) delta_t tensor(1.4179, dtype=torch.float64)
6 gae_duplicate tensor(-0.1439, dtype=torch.float64) tensor(0.2318, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7845, dtype=torch.float64) delta_t tensor(-1.6297, dtype=torch.float64)
5 gae_duplicate tensor(-1.7448, dtype=torch.float64) tensor(3.3597, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6542, dtype=torch.float64) delta_t tensor(-0.8166, dtype=torch.float64)
4 gae_duplicate tensor(-2.2124, dtype=torch.float64) tensor(8.2200, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2790, dtype=torch.float64) delta_t tensor(0.3015, dtype=torch.float64)
3 gae_duplicate tensor(-1.4684, dtype=torch.float64) tensor(1.9741, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2790, dtype=torch.float64) delta_t tensor(1.1852, dtype=torch.float64)
2 gae_duplicate tensor(0.0105, dtype=torch.float64) tensor(-0.0166, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-255.93991088867188
value loss:71.59515380859375
entropies:32.19947814941406
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.523603916168213 seconds
19 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(-1.5108, dtype=torch.float64)
19 gae_duplicate tensor(-1.5108, dtype=torch.float64) tensor(2.2556, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.4186, dtype=torch.float64)
18 gae_duplicate tensor(-0.7901, dtype=torch.float64) tensor(1.1796, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(0.4187, dtype=torch.float64)
17 gae_duplicate tensor(-0.2134, dtype=torch.float64) tensor(0.2659, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.4189, dtype=torch.float64)
16 gae_duplicate tensor(0.2482, dtype=torch.float64) tensor(-0.3093, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(0.3020, dtype=torch.float64)
15 gae_duplicate tensor(0.5005, dtype=torch.float64) tensor(-0.8460, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.3473, dtype=torch.float64)
14 gae_duplicate tensor(0.7477, dtype=torch.float64) tensor(-1.2636, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.4652, dtype=torch.float64)
13 gae_duplicate tensor(1.0634, dtype=torch.float64) tensor(-1.9637, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(0.2330, dtype=torch.float64)
12 gae_duplicate tensor(1.0837, dtype=torch.float64) tensor(-1.4636, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.4032, dtype=torch.float64)
11 gae_duplicate tensor(1.2701, dtype=torch.float64) tensor(-1.7368, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5091, dtype=torch.float64) delta_t tensor(-0.4636, dtype=torch.float64)
10 gae_duplicate tensor(0.5525, dtype=torch.float64) tensor(-0.7870, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0507, dtype=torch.float64) delta_t tensor(0.4152, dtype=torch.float64)
9 gae_duplicate tensor(0.8572, dtype=torch.float64) tensor(-1.2808, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8008, dtype=torch.float64) delta_t tensor(-2.5444, dtype=torch.float64)
8 gae_duplicate tensor(-1.8586, dtype=torch.float64) tensor(5.4990, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3903, dtype=torch.float64) delta_t tensor(0.1523, dtype=torch.float64)
7 gae_duplicate tensor(-1.3346, dtype=torch.float64) tensor(2.0597, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.7182, dtype=torch.float64) delta_t tensor(-0.5434, dtype=torch.float64)
6 gae_duplicate tensor(-1.6111, dtype=torch.float64) tensor(4.0715, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2121, dtype=torch.float64) delta_t tensor(0.2393, dtype=torch.float64)
5 gae_duplicate tensor(-1.0496, dtype=torch.float64) tensor(1.3229, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5703, dtype=torch.float64) delta_t tensor(-2.1161, dtype=torch.float64)
4 gae_duplicate tensor(-2.9558, dtype=torch.float64) tensor(4.7763, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4094, dtype=torch.float64) delta_t tensor(1.2994, dtype=torch.float64)
3 gae_duplicate tensor(-1.0653, dtype=torch.float64) tensor(2.0222, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4094, dtype=torch.float64) delta_t tensor(-0.3084, dtype=torch.float64)
2 gae_duplicate tensor(-1.1606, dtype=torch.float64) tensor(1.7913, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-94.53935241699219
value loss:43.39999008178711
entropies:32.682945251464844
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.601408004760742 seconds
19 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(-1.7659, dtype=torch.float64)
19 gae_duplicate tensor(-1.7659, dtype=torch.float64) tensor(5.2633, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.3310, dtype=torch.float64)
18 gae_duplicate tensor(-1.0817, dtype=torch.float64) tensor(2.0396, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(1.0382, dtype=torch.float64)
17 gae_duplicate tensor(0.1728, dtype=torch.float64) tensor(-0.3024, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(-0.1314, dtype=torch.float64)
16 gae_duplicate tensor(0.0069, dtype=torch.float64) tensor(-0.0114, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(3.8023, dtype=torch.float64)
15 gae_duplicate tensor(3.8078, dtype=torch.float64) tensor(-5.2415, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(-2.9485, dtype=torch.float64)
14 gae_duplicate tensor(0.0977, dtype=torch.float64) tensor(-0.1794, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(0.4646, dtype=torch.float64)
13 gae_duplicate tensor(0.5428, dtype=torch.float64) tensor(-1.6224, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1161, dtype=torch.float64) delta_t tensor(-0.0415, dtype=torch.float64)
12 gae_duplicate tensor(0.3927, dtype=torch.float64) tensor(-0.5563, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0149, dtype=torch.float64) delta_t tensor(3.0229, dtype=torch.float64)
11 gae_duplicate tensor(3.3371, dtype=torch.float64) tensor(-5.2152, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3425, dtype=torch.float64) delta_t tensor(-3.8874, dtype=torch.float64)
10 gae_duplicate tensor(-1.2178, dtype=torch.float64) tensor(2.1549, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6046, dtype=torch.float64) delta_t tensor(-0.0327, dtype=torch.float64)
9 gae_duplicate tensor(-1.0069, dtype=torch.float64) tensor(1.4959, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1814, dtype=torch.float64) delta_t tensor(0.0320, dtype=torch.float64)
8 gae_duplicate tensor(-0.7735, dtype=torch.float64) tensor(1.2193, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6046, dtype=torch.float64) delta_t tensor(-2.5573, dtype=torch.float64)
7 gae_duplicate tensor(-3.1761, dtype=torch.float64) tensor(4.2980, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.7181, dtype=torch.float64) delta_t tensor(1.0299, dtype=torch.float64)
6 gae_duplicate tensor(-1.5109, dtype=torch.float64) tensor(2.5428, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4741, dtype=torch.float64) delta_t tensor(0.4832, dtype=torch.float64)
5 gae_duplicate tensor(-0.7256, dtype=torch.float64) tensor(1.4311, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4567, dtype=torch.float64) delta_t tensor(-0.2946, dtype=torch.float64)
4 gae_duplicate tensor(-0.8751, dtype=torch.float64) tensor(1.1802, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.1122, dtype=torch.float64) delta_t tensor(-0.9668, dtype=torch.float64)
3 gae_duplicate tensor(-1.6668, dtype=torch.float64) tensor(2.6662, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3440, dtype=torch.float64) delta_t tensor(-0.9217, dtype=torch.float64)
2 gae_duplicate tensor(-2.2551, dtype=torch.float64) tensor(3.7457, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-90.4323501586914
value loss:82.55106353759766
entropies:32.73373031616211
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.302932024002075 seconds
19 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(-0.8952, dtype=torch.float64)
19 gae_duplicate tensor(-0.8952, dtype=torch.float64) tensor(0.8159, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.3831, dtype=torch.float64)
18 gae_duplicate tensor(-0.3330, dtype=torch.float64) tensor(0.8705, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.6898, dtype=torch.float64)
17 gae_duplicate tensor(0.4234, dtype=torch.float64) tensor(-0.7404, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.3363, dtype=torch.float64)
16 gae_duplicate tensor(0.6750, dtype=torch.float64) tensor(-0.7726, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.2679, dtype=torch.float64)
15 gae_duplicate tensor(0.8079, dtype=torch.float64) tensor(-1.1432, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.4565, dtype=torch.float64)
14 gae_duplicate tensor(1.1028, dtype=torch.float64) tensor(-1.5787, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(3.4321, dtype=torch.float64)
13 gae_duplicate tensor(4.3144, dtype=torch.float64) tensor(-6.2430, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(-1.9442, dtype=torch.float64)
12 gae_duplicate tensor(1.5073, dtype=torch.float64) tensor(-2.0327, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.4529, dtype=torch.float64)
11 gae_duplicate tensor(1.6587, dtype=torch.float64) tensor(-3.0178, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.0658, dtype=torch.float64)
10 gae_duplicate tensor(1.3928, dtype=torch.float64) tensor(-4.3079, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(0.6912, dtype=torch.float64)
9 gae_duplicate tensor(1.8054, dtype=torch.float64) tensor(-6.3790, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.5674, dtype=torch.float64)
8 gae_duplicate tensor(2.0117, dtype=torch.float64) tensor(-3.5365, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.6360, dtype=torch.float64)
7 gae_duplicate tensor(2.2454, dtype=torch.float64) tensor(-2.9925, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.9090, dtype=torch.float64) delta_t tensor(-1.8641, dtype=torch.float64)
6 gae_duplicate tensor(-0.0677, dtype=torch.float64) tensor(0.1058, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5831, dtype=torch.float64) delta_t tensor(1.5393, dtype=torch.float64)
5 gae_duplicate tensor(1.4852, dtype=torch.float64) tensor(-2.3794, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.6362, dtype=torch.float64) delta_t tensor(-7.9508, dtype=torch.float64)
4 gae_duplicate tensor(-6.7627, dtype=torch.float64) tensor(9.6209, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1471, dtype=torch.float64) delta_t tensor(3.4660, dtype=torch.float64)
3 gae_duplicate tensor(-1.9441, dtype=torch.float64) tensor(3.1446, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2782, dtype=torch.float64) delta_t tensor(-2.7017, dtype=torch.float64)
2 gae_duplicate tensor(-4.2570, dtype=torch.float64) tensor(6.2823, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:84.73668670654297
value loss:166.7810516357422
entropies:32.189796447753906
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(400.8957)
ToM Target loss= tensor(308.6885)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.62995982170105 seconds
19 rew tensor(-1.9755, dtype=torch.float64) delta_t tensor(-3.6365, dtype=torch.float64)
19 gae_duplicate tensor(-3.6365, dtype=torch.float64) tensor(5.5241, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.5665, dtype=torch.float64)
18 gae_duplicate tensor(-2.3427, dtype=torch.float64) tensor(3.9025, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.5667, dtype=torch.float64)
17 gae_duplicate tensor(-1.3075, dtype=torch.float64) tensor(1.9861, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.5668, dtype=torch.float64)
16 gae_duplicate tensor(-0.4791, dtype=torch.float64) tensor(0.7278, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.5670, dtype=torch.float64)
15 gae_duplicate tensor(0.1837, dtype=torch.float64) tensor(-0.2821, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.1894, dtype=torch.float64)
14 gae_duplicate tensor(0.3364, dtype=torch.float64) tensor(-0.4088, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8342, dtype=torch.float64) delta_t tensor(0.4710, dtype=torch.float64)
13 gae_duplicate tensor(0.7401, dtype=torch.float64) tensor(-2.0421, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.5008, dtype=torch.float64)
12 gae_duplicate tensor(1.0929, dtype=torch.float64) tensor(-1.8045, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.5010, dtype=torch.float64)
11 gae_duplicate tensor(1.3753, dtype=torch.float64) tensor(-2.2708, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8346, dtype=torch.float64) delta_t tensor(0.4388, dtype=torch.float64)
10 gae_duplicate tensor(1.5391, dtype=torch.float64) tensor(-2.5382, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5372, dtype=torch.float64) delta_t tensor(-0.9272, dtype=torch.float64)
9 gae_duplicate tensor(0.3041, dtype=torch.float64) tensor(-0.4853, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3212, dtype=torch.float64) delta_t tensor(-1.6809, dtype=torch.float64)
8 gae_duplicate tensor(-1.4376, dtype=torch.float64) tensor(1.6681, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8643, dtype=torch.float64) delta_t tensor(-1.0894, dtype=torch.float64)
7 gae_duplicate tensor(-2.2395, dtype=torch.float64) tensor(4.2026, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1458, dtype=torch.float64) delta_t tensor(-0.9048, dtype=torch.float64)
6 gae_duplicate tensor(-2.6963, dtype=torch.float64) tensor(3.9912, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1257, dtype=torch.float64) delta_t tensor(2.3077, dtype=torch.float64)
5 gae_duplicate tensor(0.1506, dtype=torch.float64) tensor(-0.2371, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6284, dtype=torch.float64) delta_t tensor(-2.5034, dtype=torch.float64)
4 gae_duplicate tensor(-2.3829, dtype=torch.float64) tensor(8.4143, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7349, dtype=torch.float64) delta_t tensor(0.9465, dtype=torch.float64)
3 gae_duplicate tensor(-0.9598, dtype=torch.float64) tensor(2.9415, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7350, dtype=torch.float64) delta_t tensor(-1.0361, dtype=torch.float64)
2 gae_duplicate tensor(-1.8040, dtype=torch.float64) tensor(2.9021, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-158.1266632080078
value loss:76.68348693847656
entropies:32.57339096069336
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.323222875595093 seconds
19 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(-0.3890, dtype=torch.float64)
19 gae_duplicate tensor(-0.3890, dtype=torch.float64) tensor(0.6006, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.1721, dtype=torch.float64)
18 gae_duplicate tensor(-0.1390, dtype=torch.float64) tensor(0.2504, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.7999, dtype=torch.float64)
17 gae_duplicate tensor(0.6886, dtype=torch.float64) tensor(-1.2691, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.5986, dtype=torch.float64)
16 gae_duplicate tensor(1.1495, dtype=torch.float64) tensor(-1.7015, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.5987, dtype=torch.float64)
15 gae_duplicate tensor(1.5183, dtype=torch.float64) tensor(-2.2475, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(-0.6051, dtype=torch.float64)
14 gae_duplicate tensor(0.6096, dtype=torch.float64) tensor(-0.9891, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.9520, dtype=torch.float64)
13 gae_duplicate tensor(1.4397, dtype=torch.float64) tensor(-4.4231, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3775, dtype=torch.float64) delta_t tensor(-0.0150, dtype=torch.float64)
12 gae_duplicate tensor(1.1368, dtype=torch.float64) tensor(-1.8573, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3775, dtype=torch.float64) delta_t tensor(-0.4604, dtype=torch.float64)
11 gae_duplicate tensor(0.4490, dtype=torch.float64) tensor(-0.6579, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3122, dtype=torch.float64) delta_t tensor(-0.3898, dtype=torch.float64)
10 gae_duplicate tensor(-0.0306, dtype=torch.float64) tensor(0.0461, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2469, dtype=torch.float64) delta_t tensor(-0.4512, dtype=torch.float64)
9 gae_duplicate tensor(-0.4757, dtype=torch.float64) tensor(0.7207, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0798, dtype=torch.float64) delta_t tensor(-0.6345, dtype=torch.float64)
8 gae_duplicate tensor(-1.0151, dtype=torch.float64) tensor(3.5901, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8639, dtype=torch.float64) delta_t tensor(-0.4653, dtype=torch.float64)
7 gae_duplicate tensor(-1.2774, dtype=torch.float64) tensor(4.3693, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3868, dtype=torch.float64) delta_t tensor(-2.5967, dtype=torch.float64)
6 gae_duplicate tensor(-3.6186, dtype=torch.float64) tensor(6.6322, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9951, dtype=torch.float64) delta_t tensor(-1.1242, dtype=torch.float64)
5 gae_duplicate tensor(-4.0191, dtype=torch.float64) tensor(7.0561, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1260, dtype=torch.float64) delta_t tensor(2.8962, dtype=torch.float64)
4 gae_duplicate tensor(-0.3190, dtype=torch.float64) tensor(0.9834, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4728, dtype=torch.float64) delta_t tensor(-0.1424, dtype=torch.float64)
3 gae_duplicate tensor(-0.3976, dtype=torch.float64) tensor(0.6445, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6035, dtype=torch.float64) delta_t tensor(1.2591, dtype=torch.float64)
2 gae_duplicate tensor(0.9410, dtype=torch.float64) tensor(-1.4772, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-62.61366653442383
value loss:62.236854553222656
entropies:33.02063751220703
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.349423885345459 seconds
19 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(-1.0834, dtype=torch.float64)
19 gae_duplicate tensor(-1.0834, dtype=torch.float64) tensor(1.6361, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(-0.1235, dtype=torch.float64)
18 gae_duplicate tensor(-0.9902, dtype=torch.float64) tensor(1.8258, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(1.4150, dtype=torch.float64)
17 gae_duplicate tensor(0.6228, dtype=torch.float64) tensor(-0.5568, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.3433, dtype=torch.float64)
16 gae_duplicate tensor(0.8416, dtype=torch.float64) tensor(-0.8505, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(-0.2258, dtype=torch.float64)
15 gae_duplicate tensor(0.4475, dtype=torch.float64) tensor(-0.8387, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.3813, dtype=torch.float64)
14 gae_duplicate tensor(0.7393, dtype=torch.float64) tensor(-0.9851, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(0.3573, dtype=torch.float64)
13 gae_duplicate tensor(0.9488, dtype=torch.float64) tensor(-1.2815, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.4157, dtype=torch.float64)
12 gae_duplicate tensor(1.1748, dtype=torch.float64) tensor(-2.0857, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.4128, dtype=torch.float64)
11 gae_duplicate tensor(1.3526, dtype=torch.float64) tensor(-2.3673, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6390, dtype=torch.float64) delta_t tensor(0.0922, dtype=torch.float64)
10 gae_duplicate tensor(1.1743, dtype=torch.float64) tensor(-1.8217, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5083, dtype=torch.float64) delta_t tensor(1.0208, dtype=torch.float64)
9 gae_duplicate tensor(1.9602, dtype=torch.float64) tensor(-6.3419, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0149, dtype=torch.float64) delta_t tensor(-0.3580, dtype=torch.float64)
8 gae_duplicate tensor(1.2102, dtype=torch.float64) tensor(-1.4773, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7342, dtype=torch.float64) delta_t tensor(-2.5854, dtype=torch.float64)
7 gae_duplicate tensor(-1.6173, dtype=torch.float64) tensor(2.1199, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7997, dtype=torch.float64) delta_t tensor(-0.9727, dtype=torch.float64)
6 gae_duplicate tensor(-2.2665, dtype=torch.float64) tensor(3.6519, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1267, dtype=torch.float64) delta_t tensor(1.8448, dtype=torch.float64)
5 gae_duplicate tensor(0.0316, dtype=torch.float64) tensor(-0.0514, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8654, dtype=torch.float64) delta_t tensor(0.4702, dtype=torch.float64)
4 gae_duplicate tensor(0.4954, dtype=torch.float64) tensor(-1.4612, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4541, dtype=torch.float64) delta_t tensor(-0.3471, dtype=torch.float64)
3 gae_duplicate tensor(0.0493, dtype=torch.float64) tensor(-0.0838, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2120, dtype=torch.float64) delta_t tensor(-4.2036, dtype=torch.float64)
2 gae_duplicate tensor(-4.1642, dtype=torch.float64) tensor(5.6928, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:30.698505401611328
value loss:60.20304870605469
entropies:31.943260192871094
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.364037036895752 seconds
19 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(-1.0532, dtype=torch.float64)
19 gae_duplicate tensor(-1.0532, dtype=torch.float64) tensor(1.6294, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.5090, dtype=torch.float64)
18 gae_duplicate tensor(-0.3336, dtype=torch.float64) tensor(0.5847, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.5091, dtype=torch.float64)
17 gae_duplicate tensor(0.2422, dtype=torch.float64) tensor(-0.2483, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.5093, dtype=torch.float64)
16 gae_duplicate tensor(0.7030, dtype=torch.float64) tensor(-1.0876, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.4967, dtype=torch.float64)
15 gae_duplicate tensor(1.0591, dtype=torch.float64) tensor(-2.3902, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(-0.3868, dtype=torch.float64)
14 gae_duplicate tensor(0.4604, dtype=torch.float64) tensor(-0.5369, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.2546, dtype=torch.float64)
13 gae_duplicate tensor(0.6229, dtype=torch.float64) tensor(-1.2884, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3766, dtype=torch.float64) delta_t tensor(-0.1671, dtype=torch.float64)
12 gae_duplicate tensor(0.3313, dtype=torch.float64) tensor(-0.6299, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5076, dtype=torch.float64) delta_t tensor(0.5329, dtype=torch.float64)
11 gae_duplicate tensor(0.7979, dtype=torch.float64) tensor(-1.0455, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0494, dtype=torch.float64) delta_t tensor(-1.4270, dtype=torch.float64)
10 gae_duplicate tensor(-0.7887, dtype=torch.float64) tensor(0.9909, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1149, dtype=torch.float64) delta_t tensor(-0.1824, dtype=torch.float64)
9 gae_duplicate tensor(-0.8134, dtype=torch.float64) tensor(1.0595, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7359, dtype=torch.float64) delta_t tensor(1.3671, dtype=torch.float64)
8 gae_duplicate tensor(0.7164, dtype=torch.float64) tensor(-1.0707, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7038, dtype=torch.float64) delta_t tensor(0.1515, dtype=torch.float64)
7 gae_duplicate tensor(0.7246, dtype=torch.float64) tensor(-0.8869, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4741, dtype=torch.float64) delta_t tensor(0.7521, dtype=torch.float64)
6 gae_duplicate tensor(1.3318, dtype=torch.float64) tensor(-4.9895, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3433, dtype=torch.float64) delta_t tensor(0.5559, dtype=torch.float64)
5 gae_duplicate tensor(1.6214, dtype=torch.float64) tensor(-1.8992, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9322, dtype=torch.float64) delta_t tensor(-0.0218, dtype=torch.float64)
4 gae_duplicate tensor(1.2752, dtype=torch.float64) tensor(-1.5402, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3249, dtype=torch.float64) delta_t tensor(0.0556, dtype=torch.float64)
3 gae_duplicate tensor(1.0758, dtype=torch.float64) tensor(-1.8548, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1474, dtype=torch.float64) delta_t tensor(-4.2576, dtype=torch.float64)
2 gae_duplicate tensor(-3.3969, dtype=torch.float64) tensor(6.6546, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:50.349884033203125
value loss:37.93348693847656
entropies:31.462928771972656
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4757068157196045 seconds
19 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(-0.5600, dtype=torch.float64)
19 gae_duplicate tensor(-0.5600, dtype=torch.float64) tensor(1.8959, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(-0.1088, dtype=torch.float64)
18 gae_duplicate tensor(-0.5568, dtype=torch.float64) tensor(0.8794, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(1.2687, dtype=torch.float64)
17 gae_duplicate tensor(0.8232, dtype=torch.float64) tensor(-0.6265, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.2377, dtype=torch.float64)
16 gae_duplicate tensor(0.8963, dtype=torch.float64) tensor(-0.7801, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(-0.2454, dtype=torch.float64)
15 gae_duplicate tensor(0.4716, dtype=torch.float64) tensor(-0.6510, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.3725, dtype=torch.float64)
14 gae_duplicate tensor(0.7497, dtype=torch.float64) tensor(-0.8919, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(0.3091, dtype=torch.float64)
13 gae_duplicate tensor(0.9089, dtype=torch.float64) tensor(-1.6944, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.3851, dtype=torch.float64)
12 gae_duplicate tensor(1.1122, dtype=torch.float64) tensor(-1.4546, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.4255, dtype=torch.float64)
11 gae_duplicate tensor(1.3153, dtype=torch.float64) tensor(-1.7372, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6387, dtype=torch.float64) delta_t tensor(0.0690, dtype=torch.float64)
10 gae_duplicate tensor(1.1213, dtype=torch.float64) tensor(-1.3386, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2459, dtype=torch.float64) delta_t tensor(0.3186, dtype=torch.float64)
9 gae_duplicate tensor(1.2156, dtype=torch.float64) tensor(-2.5748, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0815, dtype=torch.float64) delta_t tensor(0.1536, dtype=torch.float64)
8 gae_duplicate tensor(1.1261, dtype=torch.float64) tensor(-1.9314, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0160, dtype=torch.float64) delta_t tensor(-0.2141, dtype=torch.float64)
7 gae_duplicate tensor(0.6868, dtype=torch.float64) tensor(-0.8032, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9325, dtype=torch.float64) delta_t tensor(-2.6332, dtype=torch.float64)
6 gae_duplicate tensor(-2.0838, dtype=torch.float64) tensor(2.6359, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1290, dtype=torch.float64) delta_t tensor(1.7065, dtype=torch.float64)
5 gae_duplicate tensor(0.0395, dtype=torch.float64) tensor(-0.0677, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7184, dtype=torch.float64) delta_t tensor(0.0084, dtype=torch.float64)
4 gae_duplicate tensor(0.0400, dtype=torch.float64) tensor(-0.0790, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9810, dtype=torch.float64) delta_t tensor(-0.8202, dtype=torch.float64)
3 gae_duplicate tensor(-0.7882, dtype=torch.float64) tensor(1.0845, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4756, dtype=torch.float64) delta_t tensor(-3.0575, dtype=torch.float64)
2 gae_duplicate tensor(-3.6880, dtype=torch.float64) tensor(4.8650, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:18.68207359313965
value loss:44.58795166015625
entropies:31.228818893432617
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(402.8569)
ToM Target loss= tensor(309.1368)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.658585786819458 seconds
19 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(-1.3953, dtype=torch.float64)
19 gae_duplicate tensor(-1.3953, dtype=torch.float64) tensor(2.0597, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8342, dtype=torch.float64) delta_t tensor(0.4542, dtype=torch.float64)
18 gae_duplicate tensor(-0.6620, dtype=torch.float64) tensor(1.9218, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.4567, dtype=torch.float64)
17 gae_duplicate tensor(-0.0730, dtype=torch.float64) tensor(0.0861, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8345, dtype=torch.float64) delta_t tensor(0.3893, dtype=torch.float64)
16 gae_duplicate tensor(0.3309, dtype=torch.float64) tensor(-0.3944, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7692, dtype=torch.float64) delta_t tensor(1.0835, dtype=torch.float64)
15 gae_duplicate tensor(1.3482, dtype=torch.float64) tensor(-1.8268, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5728, dtype=torch.float64) delta_t tensor(-0.0642, dtype=torch.float64)
14 gae_duplicate tensor(1.0144, dtype=torch.float64) tensor(-2.5750, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4420, dtype=torch.float64) delta_t tensor(-0.5749, dtype=torch.float64)
13 gae_duplicate tensor(0.2366, dtype=torch.float64) tensor(-0.3969, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.4081, dtype=torch.float64)
12 gae_duplicate tensor(0.5974, dtype=torch.float64) tensor(-0.5101, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.4083, dtype=torch.float64)
11 gae_duplicate tensor(0.8862, dtype=torch.float64) tensor(-0.7567, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8351, dtype=torch.float64) delta_t tensor(0.2954, dtype=torch.float64)
10 gae_duplicate tensor(1.0043, dtype=torch.float64) tensor(-1.7848, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7832, dtype=torch.float64) delta_t tensor(-2.3015, dtype=torch.float64)
9 gae_duplicate tensor(-1.4981, dtype=torch.float64) tensor(3.8899, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1946, dtype=torch.float64) delta_t tensor(-1.0742, dtype=torch.float64)
8 gae_duplicate tensor(-2.2727, dtype=torch.float64) tensor(4.7467, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8020, dtype=torch.float64) delta_t tensor(-1.1250, dtype=torch.float64)
7 gae_duplicate tensor(-2.9431, dtype=torch.float64) tensor(9.5691, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.4391, dtype=torch.float64) delta_t tensor(-2.4041, dtype=torch.float64)
6 gae_duplicate tensor(-4.7586, dtype=torch.float64) tensor(10.9376, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3926, dtype=torch.float64) delta_t tensor(0.4826, dtype=torch.float64)
5 gae_duplicate tensor(-3.3243, dtype=torch.float64) tensor(5.5313, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1138, dtype=torch.float64) delta_t tensor(0.9353, dtype=torch.float64)
4 gae_duplicate tensor(-1.7241, dtype=torch.float64) tensor(2.0375, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6722, dtype=torch.float64) delta_t tensor(0.6968, dtype=torch.float64)
3 gae_duplicate tensor(-0.6825, dtype=torch.float64) tensor(0.8799, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7378, dtype=torch.float64) delta_t tensor(0.3301, dtype=torch.float64)
2 gae_duplicate tensor(-0.2159, dtype=torch.float64) tensor(0.7476, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-205.8915557861328
value loss:91.2063217163086
entropies:30.555437088012695
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.442416191101074 seconds
19 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(-0.9690, dtype=torch.float64)
19 gae_duplicate tensor(-0.9690, dtype=torch.float64) tensor(1.5162, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.5259, dtype=torch.float64)
18 gae_duplicate tensor(-0.2493, dtype=torch.float64) tensor(0.2253, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.5261, dtype=torch.float64)
17 gae_duplicate tensor(0.3266, dtype=torch.float64) tensor(-0.2953, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.5262, dtype=torch.float64)
16 gae_duplicate tensor(0.7875, dtype=torch.float64) tensor(-0.7120, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.5264, dtype=torch.float64)
15 gae_duplicate tensor(1.1564, dtype=torch.float64) tensor(-1.0454, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.5265, dtype=torch.float64)
14 gae_duplicate tensor(1.4516, dtype=torch.float64) tensor(-1.3123, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.5443, dtype=torch.float64)
13 gae_duplicate tensor(1.7056, dtype=torch.float64) tensor(-2.6668, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(-0.1836, dtype=torch.float64)
12 gae_duplicate tensor(1.1809, dtype=torch.float64) tensor(-1.1533, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.7512, dtype=torch.float64)
11 gae_duplicate tensor(1.6960, dtype=torch.float64) tensor(-2.8583, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6388, dtype=torch.float64) delta_t tensor(-0.1983, dtype=torch.float64)
10 gae_duplicate tensor(1.1585, dtype=torch.float64) tensor(-1.1974, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3114, dtype=torch.float64) delta_t tensor(0.5447, dtype=torch.float64)
9 gae_duplicate tensor(1.4715, dtype=torch.float64) tensor(-1.9994, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1149, dtype=torch.float64) delta_t tensor(0.2282, dtype=torch.float64)
8 gae_duplicate tensor(1.4054, dtype=torch.float64) tensor(-3.0389, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0160, dtype=torch.float64) delta_t tensor(-0.1685, dtype=torch.float64)
7 gae_duplicate tensor(0.9558, dtype=torch.float64) tensor(-1.1084, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6709, dtype=torch.float64) delta_t tensor(-0.8636, dtype=torch.float64)
6 gae_duplicate tensor(-0.0990, dtype=torch.float64) tensor(0.1932, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9329, dtype=torch.float64) delta_t tensor(1.7651, dtype=torch.float64)
5 gae_duplicate tensor(1.6859, dtype=torch.float64) tensor(-5.1819, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7188, dtype=torch.float64) delta_t tensor(-0.9957, dtype=torch.float64)
4 gae_duplicate tensor(0.3530, dtype=torch.float64) tensor(-0.6683, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4575, dtype=torch.float64) delta_t tensor(-2.0079, dtype=torch.float64)
3 gae_duplicate tensor(-1.7256, dtype=torch.float64) tensor(5.2776, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5409, dtype=torch.float64) delta_t tensor(1.5960, dtype=torch.float64)
2 gae_duplicate tensor(0.2156, dtype=torch.float64) tensor(-0.7073, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:99.47245788574219
value loss:37.12366485595703
entropies:30.784988403320312
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.382150888442993 seconds
19 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(-1.3004, dtype=torch.float64)
19 gae_duplicate tensor(-1.3004, dtype=torch.float64) tensor(2.6538, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8343, dtype=torch.float64) delta_t tensor(0.3508, dtype=torch.float64)
18 gae_duplicate tensor(-0.6895, dtype=torch.float64) tensor(2.6715, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8345, dtype=torch.float64) delta_t tensor(0.3721, dtype=torch.float64)
17 gae_duplicate tensor(-0.1794, dtype=torch.float64) tensor(0.2465, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7690, dtype=torch.float64) delta_t tensor(0.7857, dtype=torch.float64)
16 gae_duplicate tensor(0.6421, dtype=torch.float64) tensor(-1.6275, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7691, dtype=torch.float64) delta_t tensor(0.4546, dtype=torch.float64)
15 gae_duplicate tensor(0.9683, dtype=torch.float64) tensor(-0.7817, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6382, dtype=torch.float64) delta_t tensor(0.2670, dtype=torch.float64)
14 gae_duplicate tensor(1.0416, dtype=torch.float64) tensor(-0.8823, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3760, dtype=torch.float64) delta_t tensor(-0.7953, dtype=torch.float64)
13 gae_duplicate tensor(0.0379, dtype=torch.float64) tensor(-0.0343, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.3833, dtype=torch.float64)
12 gae_duplicate tensor(0.4136, dtype=torch.float64) tensor(-0.6715, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4102, dtype=torch.float64) delta_t tensor(-0.9274, dtype=torch.float64)
11 gae_duplicate tensor(-0.5965, dtype=torch.float64) tensor(1.0647, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.3833, dtype=torch.float64)
10 gae_duplicate tensor(-0.0939, dtype=torch.float64) tensor(0.1524, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.7695, dtype=torch.float64) delta_t tensor(0.3032, dtype=torch.float64)
9 gae_duplicate tensor(0.2281, dtype=torch.float64) tensor(-0.4002, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4420, dtype=torch.float64) delta_t tensor(1.0992, dtype=torch.float64)
8 gae_duplicate tensor(1.2817, dtype=torch.float64) tensor(-2.1226, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2133, dtype=torch.float64) delta_t tensor(-2.0889, dtype=torch.float64)
7 gae_duplicate tensor(-1.0635, dtype=torch.float64) tensor(3.1826, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0651, dtype=torch.float64) delta_t tensor(1.5408, dtype=torch.float64)
6 gae_duplicate tensor(0.6900, dtype=torch.float64) tensor(-1.2089, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2618, dtype=torch.float64) delta_t tensor(-0.0307, dtype=torch.float64)
5 gae_duplicate tensor(0.5214, dtype=torch.float64) tensor(-0.5975, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5243, dtype=torch.float64) delta_t tensor(-1.6032, dtype=torch.float64)
4 gae_duplicate tensor(-1.1861, dtype=torch.float64) tensor(1.5289, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4106, dtype=torch.float64) delta_t tensor(1.3623, dtype=torch.float64)
3 gae_duplicate tensor(0.4135, dtype=torch.float64) tensor(-0.4741, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4107, dtype=torch.float64) delta_t tensor(-1.1790, dtype=torch.float64)
2 gae_duplicate tensor(-0.8482, dtype=torch.float64) tensor(1.8465, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-28.18677520751953
value loss:16.56203842163086
entropies:30.271833419799805
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.283897876739502 seconds
19 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(-0.8507, dtype=torch.float64)
19 gae_duplicate tensor(-0.8507, dtype=torch.float64) tensor(2.0569, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.2574, dtype=torch.float64)
18 gae_duplicate tensor(-0.4232, dtype=torch.float64) tensor(0.2763, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.1193, dtype=torch.float64)
17 gae_duplicate tensor(-0.2193, dtype=torch.float64) tensor(0.4137, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(1.1975, dtype=torch.float64)
16 gae_duplicate tensor(1.0221, dtype=torch.float64) tensor(-0.7510, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(-0.0087, dtype=torch.float64)
15 gae_duplicate tensor(0.8090, dtype=torch.float64) tensor(-2.7662, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.4505, dtype=torch.float64)
14 gae_duplicate tensor(1.0977, dtype=torch.float64) tensor(-0.9598, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.5393, dtype=torch.float64)
13 gae_duplicate tensor(1.4175, dtype=torch.float64) tensor(-1.2360, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(3.5561, dtype=torch.float64)
12 gae_duplicate tensor(4.6901, dtype=torch.float64) tensor(-5.8257, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(-2.4351, dtype=torch.float64)
11 gae_duplicate tensor(1.3169, dtype=torch.float64) tensor(-1.5135, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0164, dtype=torch.float64) delta_t tensor(-0.3783, dtype=torch.float64)
10 gae_duplicate tensor(0.6753, dtype=torch.float64) tensor(-1.1654, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8684, dtype=torch.float64) delta_t tensor(-0.5049, dtype=torch.float64)
9 gae_duplicate tensor(0.0353, dtype=torch.float64) tensor(-0.0269, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9996, dtype=torch.float64) delta_t tensor(-2.1323, dtype=torch.float64)
8 gae_duplicate tensor(-2.1040, dtype=torch.float64) tensor(3.3926, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4755, dtype=torch.float64) delta_t tensor(0.3195, dtype=torch.float64)
7 gae_duplicate tensor(-1.3637, dtype=torch.float64) tensor(1.7250, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.6550, dtype=torch.float64) delta_t tensor(-3.1986, dtype=torch.float64)
6 gae_duplicate tensor(-4.2896, dtype=torch.float64) tensor(5.3478, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9178, dtype=torch.float64) delta_t tensor(0.9535, dtype=torch.float64)
5 gae_duplicate tensor(-2.4781, dtype=torch.float64) tensor(3.5191, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8042, dtype=torch.float64) delta_t tensor(0.8377, dtype=torch.float64)
4 gae_duplicate tensor(-1.1449, dtype=torch.float64) tensor(1.2981, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.3775, dtype=torch.float64) delta_t tensor(-1.3385, dtype=torch.float64)
3 gae_duplicate tensor(-2.2544, dtype=torch.float64) tensor(2.9065, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0181, dtype=torch.float64) delta_t tensor(-3.8747, dtype=torch.float64)
2 gae_duplicate tensor(-5.6782, dtype=torch.float64) tensor(14.9591, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-130.78443908691406
value loss:149.27435302734375
entropies:29.36860466003418
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.524770021438599 seconds
19 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(-1.1213, dtype=torch.float64)
19 gae_duplicate tensor(-1.1213, dtype=torch.float64) tensor(3.7638, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8340, dtype=torch.float64) delta_t tensor(0.4628, dtype=torch.float64)
18 gae_duplicate tensor(-0.4342, dtype=torch.float64) tensor(1.5449, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.5021, dtype=torch.float64)
17 gae_duplicate tensor(0.1547, dtype=torch.float64) tensor(-0.0896, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8343, dtype=torch.float64) delta_t tensor(0.4461, dtype=torch.float64)
16 gae_duplicate tensor(0.5699, dtype=torch.float64) tensor(-0.3320, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8344, dtype=torch.float64) delta_t tensor(0.4287, dtype=torch.float64)
15 gae_duplicate tensor(0.8846, dtype=torch.float64) tensor(-0.5119, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7691, dtype=torch.float64) delta_t tensor(0.2196, dtype=torch.float64)
14 gae_duplicate tensor(0.9273, dtype=torch.float64) tensor(-0.5409, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6382, dtype=torch.float64) delta_t tensor(-0.1651, dtype=torch.float64)
13 gae_duplicate tensor(0.5767, dtype=torch.float64) tensor(-0.3437, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.3972, dtype=torch.float64)
12 gae_duplicate tensor(0.8585, dtype=torch.float64) tensor(-0.5116, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.3973, dtype=torch.float64)
11 gae_duplicate tensor(1.0841, dtype=torch.float64) tensor(-0.6461, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8351, dtype=torch.float64) delta_t tensor(0.3272, dtype=torch.float64)
10 gae_duplicate tensor(1.1945, dtype=torch.float64) tensor(-2.4845, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1297, dtype=torch.float64) delta_t tensor(-1.6911, dtype=torch.float64)
9 gae_duplicate tensor(-0.7355, dtype=torch.float64) tensor(0.4441, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5405, dtype=torch.float64) delta_t tensor(-1.0422, dtype=torch.float64)
8 gae_duplicate tensor(-1.6306, dtype=torch.float64) tensor(1.1920, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8025, dtype=torch.float64) delta_t tensor(-0.8206, dtype=torch.float64)
7 gae_duplicate tensor(-2.1250, dtype=torch.float64) tensor(8.0007, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9336, dtype=torch.float64) delta_t tensor(-0.9084, dtype=torch.float64)
6 gae_duplicate tensor(-2.6085, dtype=torch.float64) tensor(1.8914, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6542, dtype=torch.float64) delta_t tensor(2.1137, dtype=torch.float64)
5 gae_duplicate tensor(0.0269, dtype=torch.float64) tensor(-0.0370, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5543, dtype=torch.float64) delta_t tensor(-2.1848, dtype=torch.float64)
4 gae_duplicate tensor(-2.1633, dtype=torch.float64) tensor(6.7619, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0835, dtype=torch.float64) delta_t tensor(1.1205, dtype=torch.float64)
3 gae_duplicate tensor(-0.6101, dtype=torch.float64) tensor(0.9941, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1490, dtype=torch.float64) delta_t tensor(0.2328, dtype=torch.float64)
2 gae_duplicate tensor(-0.2553, dtype=torch.float64) tensor(0.4879, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-118.30764770507812
value loss:40.11932373046875
entropies:26.88488006591797
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(373.5193)
ToM Target loss= tensor(309.4972)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.3941051959991455 seconds
19 rew tensor(-1.4595, dtype=torch.float64) delta_t tensor(-3.7130, dtype=torch.float64)
19 gae_duplicate tensor(-3.7130, dtype=torch.float64) tensor(7.3709, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.4492, dtype=torch.float64)
18 gae_duplicate tensor(-2.5212, dtype=torch.float64) tensor(5.0051, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.4493, dtype=torch.float64)
17 gae_duplicate tensor(-1.5677, dtype=torch.float64) tensor(1.0698, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8346, dtype=torch.float64) delta_t tensor(0.4106, dtype=torch.float64)
16 gae_duplicate tensor(-0.8435, dtype=torch.float64) tensor(1.6952, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8347, dtype=torch.float64) delta_t tensor(0.4709, dtype=torch.float64)
15 gae_duplicate tensor(-0.2040, dtype=torch.float64) tensor(0.4149, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7038, dtype=torch.float64) delta_t tensor(0.5114, dtype=torch.float64)
14 gae_duplicate tensor(0.3482, dtype=torch.float64) tensor(-0.1861, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4417, dtype=torch.float64) delta_t tensor(-0.3666, dtype=torch.float64)
13 gae_duplicate tensor(-0.0881, dtype=torch.float64) tensor(0.3499, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.4335, dtype=torch.float64)
12 gae_duplicate tensor(0.3630, dtype=torch.float64) tensor(-0.7762, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.4336, dtype=torch.float64)
11 gae_duplicate tensor(0.7240, dtype=torch.float64) tensor(-0.3439, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8353, dtype=torch.float64) delta_t tensor(0.2977, dtype=torch.float64)
10 gae_duplicate tensor(0.8769, dtype=torch.float64) tensor(-0.4142, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1146, dtype=torch.float64) delta_t tensor(-0.3976, dtype=torch.float64)
9 gae_duplicate tensor(0.3039, dtype=torch.float64) tensor(-0.1420, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6717, dtype=torch.float64) delta_t tensor(-0.5931, dtype=torch.float64)
8 gae_duplicate tensor(-0.3500, dtype=torch.float64) tensor(0.1780, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9994, dtype=torch.float64) delta_t tensor(-1.1635, dtype=torch.float64)
7 gae_duplicate tensor(-1.4435, dtype=torch.float64) tensor(0.7564, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5238, dtype=torch.float64) delta_t tensor(-2.2794, dtype=torch.float64)
6 gae_duplicate tensor(-3.4343, dtype=torch.float64) tensor(2.1782, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1311, dtype=torch.float64) delta_t tensor(2.1326, dtype=torch.float64)
5 gae_duplicate tensor(-0.6148, dtype=torch.float64) tensor(0.7210, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0173, dtype=torch.float64) delta_t tensor(0.3303, dtype=torch.float64)
4 gae_duplicate tensor(-0.1616, dtype=torch.float64) tensor(0.1887, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6725, dtype=torch.float64) delta_t tensor(0.1632, dtype=torch.float64)
3 gae_duplicate tensor(0.0339, dtype=torch.float64) tensor(-0.0514, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8692, dtype=torch.float64) delta_t tensor(1.1015, dtype=torch.float64)
2 gae_duplicate tensor(1.1286, dtype=torch.float64) tensor(-1.9293, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-97.2873306274414
value loss:61.018646240234375
entropies:25.8544979095459
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.428379774093628 seconds
19 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(-1.3033, dtype=torch.float64)
19 gae_duplicate tensor(-1.3033, dtype=torch.float64) tensor(0.7712, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.4235, dtype=torch.float64)
18 gae_duplicate tensor(-0.6191, dtype=torch.float64) tensor(2.3885, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.4525, dtype=torch.float64)
17 gae_duplicate tensor(-0.0429, dtype=torch.float64) tensor(0.0243, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.4526, dtype=torch.float64)
16 gae_duplicate tensor(0.4183, dtype=torch.float64) tensor(-0.2371, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(1.4456, dtype=torch.float64)
15 gae_duplicate tensor(1.7802, dtype=torch.float64) tensor(-0.9706, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(0.3462, dtype=torch.float64)
14 gae_duplicate tensor(1.7703, dtype=torch.float64) tensor(-4.1608, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.4281, dtype=torch.float64)
13 gae_duplicate tensor(1.8444, dtype=torch.float64) tensor(-3.8300, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(-0.0511, dtype=torch.float64)
12 gae_duplicate tensor(1.4244, dtype=torch.float64) tensor(-0.6610, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.4432, dtype=torch.float64)
11 gae_duplicate tensor(1.5827, dtype=torch.float64) tensor(-3.6493, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.0369, dtype=torch.float64)
10 gae_duplicate tensor(1.3031, dtype=torch.float64) tensor(-0.7490, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1804, dtype=torch.float64) delta_t tensor(0.3713, dtype=torch.float64)
9 gae_duplicate tensor(1.4138, dtype=torch.float64) tensor(-1.6681, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9338, dtype=torch.float64) delta_t tensor(-2.6250, dtype=torch.float64)
8 gae_duplicate tensor(-1.4939, dtype=torch.float64) tensor(1.9705, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8684, dtype=torch.float64) delta_t tensor(0.1819, dtype=torch.float64)
7 gae_duplicate tensor(-1.0133, dtype=torch.float64) tensor(0.8404, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0652, dtype=torch.float64) delta_t tensor(0.5265, dtype=torch.float64)
6 gae_duplicate tensor(-0.2841, dtype=torch.float64) tensor(0.8964, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8032, dtype=torch.float64) delta_t tensor(0.1501, dtype=torch.float64)
5 gae_duplicate tensor(-0.0772, dtype=torch.float64) tensor(0.2224, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0487, dtype=torch.float64) delta_t tensor(-1.9578, dtype=torch.float64)
4 gae_duplicate tensor(-2.0196, dtype=torch.float64) tensor(2.2830, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4106, dtype=torch.float64) delta_t tensor(1.3739, dtype=torch.float64)
3 gae_duplicate tensor(-0.2417, dtype=torch.float64) tensor(0.2484, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4107, dtype=torch.float64) delta_t tensor(-2.3733, dtype=torch.float64)
2 gae_duplicate tensor(-2.5667, dtype=torch.float64) tensor(1.6895, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:26.776355743408203
value loss:51.39727783203125
entropies:25.763845443725586
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.333445072174072 seconds
19 rew tensor(0.6386, dtype=torch.float64) delta_t tensor(-1.3889, dtype=torch.float64)
19 gae_duplicate tensor(-1.3889, dtype=torch.float64) tensor(5.8370, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5075, dtype=torch.float64) delta_t tensor(0.2339, dtype=torch.float64)
18 gae_duplicate tensor(-0.8773, dtype=torch.float64) tensor(2.0197, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.1138, dtype=torch.float64) delta_t tensor(-0.0532, dtype=torch.float64)
17 gae_duplicate tensor(-0.7550, dtype=torch.float64) tensor(0.3381, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.6078, dtype=torch.float64) delta_t tensor(-0.7277, dtype=torch.float64)
16 gae_duplicate tensor(-1.3317, dtype=torch.float64) tensor(0.7013, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7042, dtype=torch.float64) delta_t tensor(0.1170, dtype=torch.float64)
15 gae_duplicate tensor(-0.9484, dtype=torch.float64) tensor(0.5076, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7042, dtype=torch.float64) delta_t tensor(0.1076, dtype=torch.float64)
14 gae_duplicate tensor(-0.6511, dtype=torch.float64) tensor(0.3562, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5076, dtype=torch.float64) delta_t tensor(0.2258, dtype=torch.float64)
13 gae_duplicate tensor(-0.2951, dtype=torch.float64) tensor(0.1715, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.5240, dtype=torch.float64)
12 gae_duplicate tensor(0.2879, dtype=torch.float64) tensor(-0.1673, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(-0.0248, dtype=torch.float64)
11 gae_duplicate tensor(0.2056, dtype=torch.float64) tensor(-0.4741, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7703, dtype=torch.float64) delta_t tensor(0.4324, dtype=torch.float64)
10 gae_duplicate tensor(0.5968, dtype=torch.float64) tensor(-1.3817, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5413, dtype=torch.float64) delta_t tensor(-1.0506, dtype=torch.float64)
9 gae_duplicate tensor(-0.5732, dtype=torch.float64) tensor(0.2452, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6070, dtype=torch.float64) delta_t tensor(-0.4394, dtype=torch.float64)
8 gae_duplicate tensor(-0.8979, dtype=torch.float64) tensor(2.0707, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2136, dtype=torch.float64) delta_t tensor(-0.0698, dtype=torch.float64)
7 gae_duplicate tensor(-0.7881, dtype=torch.float64) tensor(0.3640, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3284, dtype=torch.float64) delta_t tensor(-2.6024, dtype=torch.float64)
6 gae_duplicate tensor(-3.2330, dtype=torch.float64) tensor(1.7985, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0664, dtype=torch.float64) delta_t tensor(1.4614, dtype=torch.float64)
5 gae_duplicate tensor(-1.1250, dtype=torch.float64) tensor(2.6121, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1977, dtype=torch.float64) delta_t tensor(-0.5666, dtype=torch.float64)
4 gae_duplicate tensor(-1.4666, dtype=torch.float64) tensor(1.8629, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0176, dtype=torch.float64) delta_t tensor(1.4459, dtype=torch.float64)
3 gae_duplicate tensor(0.2726, dtype=torch.float64) tensor(-0.4750, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5422, dtype=torch.float64) delta_t tensor(1.1589, dtype=torch.float64)
2 gae_duplicate tensor(1.3770, dtype=torch.float64) tensor(-1.5684, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-89.64350891113281
value loss:36.79314422607422
entropies:24.48949432373047
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.3855249881744385 seconds
19 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(-0.7449, dtype=torch.float64)
19 gae_duplicate tensor(-0.7449, dtype=torch.float64) tensor(2.6278, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.7986, dtype=torch.float64)
18 gae_duplicate tensor(0.2027, dtype=torch.float64) tensor(-0.6348, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.6168, dtype=torch.float64)
17 gae_duplicate tensor(0.7790, dtype=torch.float64) tensor(-0.5194, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.6170, dtype=torch.float64)
16 gae_duplicate tensor(1.2401, dtype=torch.float64) tensor(-0.8269, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(3.1408, dtype=torch.float64)
15 gae_duplicate tensor(4.1329, dtype=torch.float64) tensor(-7.0246, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(-0.9794, dtype=torch.float64)
14 gae_duplicate tensor(2.3269, dtype=torch.float64) tensor(-6.4093, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.7680, dtype=torch.float64)
13 gae_duplicate tensor(2.6295, dtype=torch.float64) tensor(-2.0923, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3769, dtype=torch.float64) delta_t tensor(0.0582, dtype=torch.float64)
12 gae_duplicate tensor(2.1618, dtype=torch.float64) tensor(-1.6184, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1148, dtype=torch.float64) delta_t tensor(-0.8682, dtype=torch.float64)
11 gae_duplicate tensor(0.8612, dtype=torch.float64) tensor(-0.5920, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1148, dtype=torch.float64) delta_t tensor(-0.1835, dtype=torch.float64)
10 gae_duplicate tensor(0.5055, dtype=torch.float64) tensor(-0.8582, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0817, dtype=torch.float64) delta_t tensor(-1.1452, dtype=torch.float64)
9 gae_duplicate tensor(-0.7408, dtype=torch.float64) tensor(1.7093, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0162, dtype=torch.float64) delta_t tensor(-0.7214, dtype=torch.float64)
8 gae_duplicate tensor(-1.3141, dtype=torch.float64) tensor(3.2231, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3113, dtype=torch.float64) delta_t tensor(2.2610, dtype=torch.float64)
7 gae_duplicate tensor(1.2097, dtype=torch.float64) tensor(-4.3066, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.9153, dtype=torch.float64) delta_t tensor(-2.3995, dtype=torch.float64)
6 gae_duplicate tensor(-1.4317, dtype=torch.float64) tensor(4.7892, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3921, dtype=torch.float64) delta_t tensor(0.7751, dtype=torch.float64)
5 gae_duplicate tensor(-0.3703, dtype=torch.float64) tensor(0.3215, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.7990, dtype=torch.float64) delta_t tensor(-3.9646, dtype=torch.float64)
4 gae_duplicate tensor(-4.2609, dtype=torch.float64) tensor(3.4149, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1137, dtype=torch.float64) delta_t tensor(-0.3600, dtype=torch.float64)
3 gae_duplicate tensor(-3.7687, dtype=torch.float64) tensor(2.6591, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1137, dtype=torch.float64) delta_t tensor(-1.9417, dtype=torch.float64)
2 gae_duplicate tensor(-4.9567, dtype=torch.float64) tensor(3.0105, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:17.967140197753906
value loss:151.010498046875
entropies:26.489187240600586
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.369931697845459 seconds
19 rew tensor(0.8348, dtype=torch.float64) delta_t tensor(-1.7556, dtype=torch.float64)
19 gae_duplicate tensor(-1.7556, dtype=torch.float64) tensor(0.7259, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7038, dtype=torch.float64) delta_t tensor(0.2416, dtype=torch.float64)
18 gae_duplicate tensor(-1.1629, dtype=torch.float64) tensor(4.9457, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6383, dtype=torch.float64) delta_t tensor(0.7453, dtype=torch.float64)
17 gae_duplicate tensor(-0.1850, dtype=torch.float64) tensor(0.0765, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2450, dtype=torch.float64) delta_t tensor(-0.0199, dtype=torch.float64)
16 gae_duplicate tensor(-0.1680, dtype=torch.float64) tensor(0.3765, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.2139, dtype=torch.float64) delta_t tensor(-1.3051, dtype=torch.float64)
15 gae_duplicate tensor(-1.4395, dtype=torch.float64) tensor(0.7270, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.3940, dtype=torch.float64)
14 gae_duplicate tensor(-0.7576, dtype=torch.float64) tensor(0.3826, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(2.5167, dtype=torch.float64)
13 gae_duplicate tensor(1.9106, dtype=torch.float64) tensor(-1.2613, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8352, dtype=torch.float64) delta_t tensor(-1.6477, dtype=torch.float64)
12 gae_duplicate tensor(-0.1192, dtype=torch.float64) tensor(0.1726, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.3388, dtype=torch.float64)
11 gae_duplicate tensor(0.2434, dtype=torch.float64) tensor(-0.1576, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1145, dtype=torch.float64) delta_t tensor(-0.4404, dtype=torch.float64)
10 gae_duplicate tensor(-0.2457, dtype=torch.float64) tensor(0.5678, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4422, dtype=torch.float64) delta_t tensor(0.1673, dtype=torch.float64)
9 gae_duplicate tensor(-0.0293, dtype=torch.float64) tensor(0.0138, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0821, dtype=torch.float64) delta_t tensor(-0.3968, dtype=torch.float64)
8 gae_duplicate tensor(-0.4202, dtype=torch.float64) tensor(0.2152, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8029, dtype=torch.float64) delta_t tensor(0.1330, dtype=torch.float64)
7 gae_duplicate tensor(-0.2031, dtype=torch.float64) tensor(0.3065, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0652, dtype=torch.float64) delta_t tensor(-2.7832, dtype=torch.float64)
6 gae_duplicate tensor(-2.9458, dtype=torch.float64) tensor(5.1419, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0484, dtype=torch.float64) delta_t tensor(0.8607, dtype=torch.float64)
5 gae_duplicate tensor(-1.4959, dtype=torch.float64) tensor(1.7497, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7693, dtype=torch.float64) delta_t tensor(1.8207, dtype=torch.float64)
4 gae_duplicate tensor(0.6240, dtype=torch.float64) tensor(-1.8004, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0659, dtype=torch.float64) delta_t tensor(0.6755, dtype=torch.float64)
3 gae_duplicate tensor(1.1747, dtype=torch.float64) tensor(-2.0436, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2140, dtype=torch.float64) delta_t tensor(0.0179, dtype=torch.float64)
2 gae_duplicate tensor(0.9576, dtype=torch.float64) tensor(-1.3002, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-53.76758575439453
value loss:37.121341705322266
entropies:24.54985809326172
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(348.6239)
ToM Target loss= tensor(309.5085)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.31699800491333 seconds
19 rew tensor(0.8356, dtype=torch.float64) delta_t tensor(-1.0631, dtype=torch.float64)
19 gae_duplicate tensor(-1.0631, dtype=torch.float64) tensor(0.4346, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6389, dtype=torch.float64) delta_t tensor(0.2978, dtype=torch.float64)
18 gae_duplicate tensor(-0.5527, dtype=torch.float64) tensor(0.2259, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5077, dtype=torch.float64) delta_t tensor(0.2166, dtype=torch.float64)
17 gae_duplicate tensor(-0.2255, dtype=torch.float64) tensor(0.0925, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0485, dtype=torch.float64) delta_t tensor(0.3725, dtype=torch.float64)
16 gae_duplicate tensor(0.1921, dtype=torch.float64) tensor(-0.4485, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.6076, dtype=torch.float64) delta_t tensor(-1.1157, dtype=torch.float64)
15 gae_duplicate tensor(-0.9621, dtype=torch.float64) tensor(1.6701, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(0.3183, dtype=torch.float64)
14 gae_duplicate tensor(-0.4514, dtype=torch.float64) tensor(0.2508, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8358, dtype=torch.float64) delta_t tensor(0.4005, dtype=torch.float64)
13 gae_duplicate tensor(0.0394, dtype=torch.float64) tensor(-0.1482, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4106, dtype=torch.float64) delta_t tensor(1.3240, dtype=torch.float64)
12 gae_duplicate tensor(1.3555, dtype=torch.float64) tensor(-1.3802, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6390, dtype=torch.float64) delta_t tensor(0.1697, dtype=torch.float64)
11 gae_duplicate tensor(1.2541, dtype=torch.float64) tensor(-3.6488, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6391, dtype=torch.float64) delta_t tensor(-0.8573, dtype=torch.float64)
10 gae_duplicate tensor(0.1460, dtype=torch.float64) tensor(-0.1066, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1144, dtype=torch.float64) delta_t tensor(-0.4496, dtype=torch.float64)
9 gae_duplicate tensor(-0.3328, dtype=torch.float64) tensor(0.2220, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4759, dtype=torch.float64) delta_t tensor(-0.9735, dtype=torch.float64)
8 gae_duplicate tensor(-1.2397, dtype=torch.float64) tensor(1.0821, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7701, dtype=torch.float64) delta_t tensor(1.3103, dtype=torch.float64)
7 gae_duplicate tensor(0.3185, dtype=torch.float64) tensor(-0.9147, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9348, dtype=torch.float64) delta_t tensor(0.4111, dtype=torch.float64)
6 gae_duplicate tensor(0.6659, dtype=torch.float64) tensor(-0.6687, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8694, dtype=torch.float64) delta_t tensor(0.1460, dtype=torch.float64)
5 gae_duplicate tensor(0.6788, dtype=torch.float64) tensor(-0.5939, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9188, dtype=torch.float64) delta_t tensor(-1.9324, dtype=torch.float64)
4 gae_duplicate tensor(-1.3894, dtype=torch.float64) tensor(1.4926, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4109, dtype=torch.float64) delta_t tensor(1.3903, dtype=torch.float64)
3 gae_duplicate tensor(0.2788, dtype=torch.float64) tensor(-0.2948, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4110, dtype=torch.float64) delta_t tensor(-2.0712, dtype=torch.float64)
2 gae_duplicate tensor(-1.8482, dtype=torch.float64) tensor(1.0418, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:9.40746784210205
value loss:21.2442684173584
entropies:24.819917678833008
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.402112007141113 seconds
19 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(0.1673, dtype=torch.float64)
19 gae_duplicate tensor(0.1673, dtype=torch.float64) tensor(-0.3983, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(0.7543, dtype=torch.float64)
18 gae_duplicate tensor(0.8881, dtype=torch.float64) tensor(-0.3967, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.7544, dtype=torch.float64)
17 gae_duplicate tensor(1.4649, dtype=torch.float64) tensor(-3.0969, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(0.7546, dtype=torch.float64)
16 gae_duplicate tensor(1.9265, dtype=torch.float64) tensor(-0.8605, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.7547, dtype=torch.float64)
15 gae_duplicate tensor(2.2959, dtype=torch.float64) tensor(-1.0255, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.7549, dtype=torch.float64)
14 gae_duplicate tensor(2.5916, dtype=torch.float64) tensor(-1.1575, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(0.7278, dtype=torch.float64)
13 gae_duplicate tensor(2.8011, dtype=torch.float64) tensor(-1.2633, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(0.6991, dtype=torch.float64)
12 gae_duplicate tensor(2.9399, dtype=torch.float64) tensor(-6.0776, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.6466, dtype=torch.float64)
11 gae_duplicate tensor(2.9986, dtype=torch.float64) tensor(-1.3793, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(0.4208, dtype=torch.float64)
10 gae_duplicate tensor(2.8196, dtype=torch.float64) tensor(-1.3513, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6398, dtype=torch.float64) delta_t tensor(0.3144, dtype=torch.float64)
9 gae_duplicate tensor(2.5701, dtype=torch.float64) tensor(-3.5803, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1806, dtype=torch.float64) delta_t tensor(-0.2361, dtype=torch.float64)
8 gae_duplicate tensor(1.8200, dtype=torch.float64) tensor(-2.1368, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1317, dtype=torch.float64) delta_t tensor(-2.9226, dtype=torch.float64)
7 gae_duplicate tensor(-1.4666, dtype=torch.float64) tensor(0.8545, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1975, dtype=torch.float64) delta_t tensor(2.5107, dtype=torch.float64)
6 gae_duplicate tensor(1.3374, dtype=torch.float64) tensor(-1.1317, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5259, dtype=torch.float64) delta_t tensor(-0.4411, dtype=torch.float64)
5 gae_duplicate tensor(0.6288, dtype=torch.float64) tensor(-0.7056, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7232, dtype=torch.float64) delta_t tensor(-1.5908, dtype=torch.float64)
4 gae_duplicate tensor(-1.0877, dtype=torch.float64) tensor(1.8182, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5269, dtype=torch.float64) delta_t tensor(0.4830, dtype=torch.float64)
3 gae_duplicate tensor(-0.3872, dtype=torch.float64) tensor(0.9399, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0481, dtype=torch.float64) delta_t tensor(-2.6068, dtype=torch.float64)
2 gae_duplicate tensor(-2.9166, dtype=torch.float64) tensor(7.9834, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:77.05294036865234
value loss:114.277587890625
entropies:24.644670486450195
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.2344841957092285 seconds
19 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(-0.8497, dtype=torch.float64)
19 gae_duplicate tensor(-0.8497, dtype=torch.float64) tensor(3.4833, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.4189, dtype=torch.float64)
18 gae_duplicate tensor(-0.2608, dtype=torch.float64) tensor(0.9529, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.5231, dtype=torch.float64)
17 gae_duplicate tensor(0.3145, dtype=torch.float64) tensor(-0.1611, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.5233, dtype=torch.float64)
16 gae_duplicate tensor(0.7749, dtype=torch.float64) tensor(-0.3970, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.5878, dtype=torch.float64)
15 gae_duplicate tensor(1.2078, dtype=torch.float64) tensor(-0.6282, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.5365, dtype=torch.float64)
14 gae_duplicate tensor(1.5027, dtype=torch.float64) tensor(-2.9965, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.5599, dtype=torch.float64)
13 gae_duplicate tensor(1.7620, dtype=torch.float64) tensor(-0.8996, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.5750, dtype=torch.float64)
12 gae_duplicate tensor(1.9846, dtype=torch.float64) tensor(-0.9956, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.6434, dtype=torch.float64)
11 gae_duplicate tensor(2.2311, dtype=torch.float64) tensor(-1.0828, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.2636, dtype=torch.float64)
10 gae_duplicate tensor(2.0485, dtype=torch.float64) tensor(-4.3338, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.1417, dtype=torch.float64)
9 gae_duplicate tensor(1.7805, dtype=torch.float64) tensor(-2.6980, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4418, dtype=torch.float64) delta_t tensor(0.1812, dtype=torch.float64)
8 gae_duplicate tensor(1.6056, dtype=torch.float64) tensor(-0.9493, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2783, dtype=torch.float64) delta_t tensor(0.0557, dtype=torch.float64)
7 gae_duplicate tensor(1.3401, dtype=torch.float64) tensor(-0.7972, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5401, dtype=torch.float64) delta_t tensor(-0.3315, dtype=torch.float64)
6 gae_duplicate tensor(0.7406, dtype=torch.float64) tensor(-0.4829, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.3075, dtype=torch.float64) delta_t tensor(0.8770, dtype=torch.float64)
5 gae_duplicate tensor(1.4695, dtype=torch.float64) tensor(-1.8296, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.5175, dtype=torch.float64) delta_t tensor(-5.1168, dtype=torch.float64)
4 gae_duplicate tensor(-3.9412, dtype=torch.float64) tensor(6.3203, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0180, dtype=torch.float64) delta_t tensor(1.6444, dtype=torch.float64)
3 gae_duplicate tensor(-1.5085, dtype=torch.float64) tensor(1.5793, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0837, dtype=torch.float64) delta_t tensor(0.6172, dtype=torch.float64)
2 gae_duplicate tensor(-0.5897, dtype=torch.float64) tensor(1.6715, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:24.709810256958008
value loss:74.74752044677734
entropies:25.246217727661133
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.497297048568726 seconds
19 rew tensor(0.8331, dtype=torch.float64) delta_t tensor(-1.0825, dtype=torch.float64)
19 gae_duplicate tensor(-1.0825, dtype=torch.float64) tensor(2.5600, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.5155, dtype=torch.float64)
18 gae_duplicate tensor(-0.3505, dtype=torch.float64) tensor(0.1416, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.5157, dtype=torch.float64)
17 gae_duplicate tensor(0.2353, dtype=torch.float64) tensor(-0.0951, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.5158, dtype=torch.float64)
16 gae_duplicate tensor(0.7041, dtype=torch.float64) tensor(-0.2845, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.5160, dtype=torch.float64)
15 gae_duplicate tensor(1.0792, dtype=torch.float64) tensor(-0.4361, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8338, dtype=torch.float64) delta_t tensor(0.4221, dtype=torch.float64)
14 gae_duplicate tensor(1.2855, dtype=torch.float64) tensor(-0.5166, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8339, dtype=torch.float64) delta_t tensor(0.2839, dtype=torch.float64)
13 gae_duplicate tensor(1.3123, dtype=torch.float64) tensor(-0.5244, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7031, dtype=torch.float64) delta_t tensor(-0.1934, dtype=torch.float64)
12 gae_duplicate tensor(0.8565, dtype=torch.float64) tensor(-0.3412, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.3834, dtype=torch.float64)
11 gae_duplicate tensor(1.0686, dtype=torch.float64) tensor(-2.5218, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.3836, dtype=torch.float64)
10 gae_duplicate tensor(1.2385, dtype=torch.float64) tensor(-2.8876, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4748, dtype=torch.float64) delta_t tensor(-1.1125, dtype=torch.float64)
9 gae_duplicate tensor(-0.1217, dtype=torch.float64) tensor(0.2847, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6057, dtype=torch.float64) delta_t tensor(-1.1384, dtype=torch.float64)
8 gae_duplicate tensor(-1.2358, dtype=torch.float64) tensor(2.8892, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.6347, dtype=torch.float64) delta_t tensor(-2.7354, dtype=torch.float64)
7 gae_duplicate tensor(-3.7240, dtype=torch.float64) tensor(1.6763, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1305, dtype=torch.float64) delta_t tensor(-0.7362, dtype=torch.float64)
6 gae_duplicate tensor(-3.7154, dtype=torch.float64) tensor(15.8118, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7201, dtype=torch.float64) delta_t tensor(0.1966, dtype=torch.float64)
5 gae_duplicate tensor(-2.7757, dtype=torch.float64) tensor(2.8846, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1967, dtype=torch.float64) delta_t tensor(-0.0488, dtype=torch.float64)
4 gae_duplicate tensor(-2.2694, dtype=torch.float64) tensor(2.2187, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0475, dtype=torch.float64) delta_t tensor(1.5136, dtype=torch.float64)
3 gae_duplicate tensor(-0.3020, dtype=torch.float64) tensor(0.5572, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6074, dtype=torch.float64) delta_t tensor(0.7797, dtype=torch.float64)
2 gae_duplicate tensor(0.5381, dtype=torch.float64) tensor(-0.7810, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-124.4842529296875
value loss:78.36759948730469
entropies:22.325830459594727
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.238956928253174 seconds
19 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(-1.1138, dtype=torch.float64)
19 gae_duplicate tensor(-1.1138, dtype=torch.float64) tensor(0.4320, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.4964, dtype=torch.float64)
18 gae_duplicate tensor(-0.3946, dtype=torch.float64) tensor(0.1530, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.4966, dtype=torch.float64)
17 gae_duplicate tensor(0.1809, dtype=torch.float64) tensor(-0.0702, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8338, dtype=torch.float64) delta_t tensor(0.4276, dtype=torch.float64)
16 gae_duplicate tensor(0.5723, dtype=torch.float64) tensor(-0.2220, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7684, dtype=torch.float64) delta_t tensor(0.3675, dtype=torch.float64)
15 gae_duplicate tensor(0.8253, dtype=torch.float64) tensor(-0.3201, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7030, dtype=torch.float64) delta_t tensor(0.2648, dtype=torch.float64)
14 gae_duplicate tensor(0.9250, dtype=torch.float64) tensor(-0.3588, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4412, dtype=torch.float64) delta_t tensor(-0.5078, dtype=torch.float64)
13 gae_duplicate tensor(0.2322, dtype=torch.float64) tensor(-0.0901, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.3818, dtype=torch.float64)
12 gae_duplicate tensor(0.5676, dtype=torch.float64) tensor(-0.2201, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.3820, dtype=torch.float64)
11 gae_duplicate tensor(0.8361, dtype=torch.float64) tensor(-0.3243, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.3821, dtype=torch.float64)
10 gae_duplicate tensor(1.0510, dtype=torch.float64) tensor(-0.4076, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6057, dtype=torch.float64) delta_t tensor(-1.1233, dtype=torch.float64)
9 gae_duplicate tensor(-0.2825, dtype=torch.float64) tensor(0.1097, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0166, dtype=torch.float64) delta_t tensor(0.2013, dtype=torch.float64)
8 gae_duplicate tensor(-0.0247, dtype=torch.float64) tensor(0.0524, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8675, dtype=torch.float64) delta_t tensor(-1.0227, dtype=torch.float64)
7 gae_duplicate tensor(-1.0425, dtype=torch.float64) tensor(2.4809, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.7840, dtype=torch.float64) delta_t tensor(-1.5111, dtype=torch.float64)
6 gae_duplicate tensor(-2.3451, dtype=torch.float64) tensor(0.9681, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6537, dtype=torch.float64) delta_t tensor(1.0359, dtype=torch.float64)
5 gae_duplicate tensor(-0.8402, dtype=torch.float64) tensor(1.2421, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8507, dtype=torch.float64) delta_t tensor(-1.4533, dtype=torch.float64)
4 gae_duplicate tensor(-2.1255, dtype=torch.float64) tensor(3.3468, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4107, dtype=torch.float64) delta_t tensor(0.9383, dtype=torch.float64)
3 gae_duplicate tensor(-0.7621, dtype=torch.float64) tensor(1.6015, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6072, dtype=torch.float64) delta_t tensor(0.7848, dtype=torch.float64)
2 gae_duplicate tensor(0.1752, dtype=torch.float64) tensor(-0.7062, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-46.65306091308594
value loss:26.961898803710938
entropies:21.671018600463867
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(354.0987)
ToM Target loss= tensor(309.8335)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.480562210083008 seconds
19 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(-0.3711, dtype=torch.float64)
19 gae_duplicate tensor(-0.3711, dtype=torch.float64) tensor(0.1400, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.3614, dtype=torch.float64)
18 gae_duplicate tensor(0.0645, dtype=torch.float64) tensor(-0.1532, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.3879, dtype=torch.float64)
17 gae_duplicate tensor(0.4396, dtype=torch.float64) tensor(-0.8719, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.5484, dtype=torch.float64)
16 gae_duplicate tensor(0.9001, dtype=torch.float64) tensor(-0.4072, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.5486, dtype=torch.float64)
15 gae_duplicate tensor(1.2687, dtype=torch.float64) tensor(-2.5164, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.5487, dtype=torch.float64)
14 gae_duplicate tensor(1.5637, dtype=torch.float64) tensor(-0.7074, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.5489, dtype=torch.float64)
13 gae_duplicate tensor(1.7998, dtype=torch.float64) tensor(-0.8142, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(-0.1307, dtype=torch.float64)
12 gae_duplicate tensor(1.3091, dtype=torch.float64) tensor(-0.5318, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.1309, dtype=torch.float64) delta_t tensor(-2.2130, dtype=torch.float64)
11 gae_duplicate tensor(-1.1657, dtype=torch.float64) tensor(4.9950, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6070, dtype=torch.float64) delta_t tensor(-1.0255, dtype=torch.float64)
10 gae_duplicate tensor(-1.9581, dtype=torch.float64) tensor(4.6817, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5066, dtype=torch.float64) delta_t tensor(0.8280, dtype=torch.float64)
9 gae_duplicate tensor(-0.7385, dtype=torch.float64) tensor(0.3839, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1484, dtype=torch.float64) delta_t tensor(-0.5991, dtype=torch.float64)
8 gae_duplicate tensor(-1.1899, dtype=torch.float64) tensor(1.5371, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.6375, dtype=torch.float64) delta_t tensor(1.0097, dtype=torch.float64)
7 gae_duplicate tensor(0.0577, dtype=torch.float64) tensor(-0.0468, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1962, dtype=torch.float64) delta_t tensor(0.3741, dtype=torch.float64)
6 gae_duplicate tensor(0.4202, dtype=torch.float64) tensor(-0.4257, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4585, dtype=torch.float64) delta_t tensor(-0.2575, dtype=torch.float64)
5 gae_duplicate tensor(0.0787, dtype=torch.float64) tensor(-0.2365, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7682, dtype=torch.float64) delta_t tensor(1.1750, dtype=torch.float64)
4 gae_duplicate tensor(1.2380, dtype=torch.float64) tensor(-3.6376, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7382, dtype=torch.float64) delta_t tensor(0.6435, dtype=torch.float64)
3 gae_duplicate tensor(1.6339, dtype=torch.float64) tensor(-1.1320, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2798, dtype=torch.float64) delta_t tensor(0.0564, dtype=torch.float64)
2 gae_duplicate tensor(1.3635, dtype=torch.float64) tensor(-0.9978, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3.754027843475342
value loss:35.332035064697266
entropies:22.997352600097656
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.457862138748169 seconds
19 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(-0.9680, dtype=torch.float64)
19 gae_duplicate tensor(-0.9680, dtype=torch.float64) tensor(2.3162, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.5254, dtype=torch.float64)
18 gae_duplicate tensor(-0.2490, dtype=torch.float64) tensor(0.0911, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.5255, dtype=torch.float64)
17 gae_duplicate tensor(0.3263, dtype=torch.float64) tensor(-0.1193, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.5257, dtype=torch.float64)
16 gae_duplicate tensor(0.7867, dtype=torch.float64) tensor(-0.2876, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.4711, dtype=torch.float64)
15 gae_duplicate tensor(1.1005, dtype=torch.float64) tensor(-0.5682, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8337, dtype=torch.float64) delta_t tensor(0.2323, dtype=torch.float64)
14 gae_duplicate tensor(1.1127, dtype=torch.float64) tensor(-1.9252, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.4717, dtype=torch.float64)
13 gae_duplicate tensor(1.3618, dtype=torch.float64) tensor(-0.6778, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7684, dtype=torch.float64) delta_t tensor(0.2616, dtype=torch.float64)
12 gae_duplicate tensor(1.3510, dtype=torch.float64) tensor(-0.6629, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6374, dtype=torch.float64) delta_t tensor(0.6393, dtype=torch.float64)
11 gae_duplicate tensor(1.7201, dtype=torch.float64) tensor(-0.9872, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5720, dtype=torch.float64) delta_t tensor(0.1705, dtype=torch.float64)
10 gae_duplicate tensor(1.5465, dtype=torch.float64) tensor(-0.8744, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0178, dtype=torch.float64) delta_t tensor(-0.0342, dtype=torch.float64)
9 gae_duplicate tensor(1.2031, dtype=torch.float64) tensor(-0.7598, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3754, dtype=torch.float64) delta_t tensor(0.1942, dtype=torch.float64)
8 gae_duplicate tensor(1.1567, dtype=torch.float64) tensor(-0.7310, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4765, dtype=torch.float64) delta_t tensor(-0.9660, dtype=torch.float64)
7 gae_duplicate tensor(-0.0406, dtype=torch.float64) tensor(0.0207, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5421, dtype=torch.float64) delta_t tensor(-1.7821, dtype=torch.float64)
6 gae_duplicate tensor(-1.8146, dtype=torch.float64) tensor(0.7803, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9181, dtype=torch.float64) delta_t tensor(1.1367, dtype=torch.float64)
5 gae_duplicate tensor(-0.3150, dtype=torch.float64) tensor(0.3416, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7682, dtype=torch.float64) delta_t tensor(1.6376, dtype=torch.float64)
4 gae_duplicate tensor(1.3856, dtype=torch.float64) tensor(-4.1362, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8046, dtype=torch.float64) delta_t tensor(0.6059, dtype=torch.float64)
3 gae_duplicate tensor(1.7144, dtype=torch.float64) tensor(-4.6122, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2804, dtype=torch.float64) delta_t tensor(0.0542, dtype=torch.float64)
2 gae_duplicate tensor(1.4257, dtype=torch.float64) tensor(-2.3017, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:89.87751770019531
value loss:39.411285400390625
entropies:22.81733512878418
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.2276611328125 seconds
19 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(-0.8474, dtype=torch.float64)
19 gae_duplicate tensor(-0.8474, dtype=torch.float64) tensor(0.2993, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(-0.2518, dtype=torch.float64)
18 gae_duplicate tensor(-0.9298, dtype=torch.float64) tensor(0.3913, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.0703, dtype=torch.float64)
17 gae_duplicate tensor(-0.6735, dtype=torch.float64) tensor(1.3830, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.7676, dtype=torch.float64)
16 gae_duplicate tensor(0.2287, dtype=torch.float64) tensor(-0.1107, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(3.2074, dtype=torch.float64)
15 gae_duplicate tensor(3.3904, dtype=torch.float64) tensor(-2.5568, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.9730, dtype=torch.float64)
14 gae_duplicate tensor(3.6853, dtype=torch.float64) tensor(-2.7792, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.9731, dtype=torch.float64)
13 gae_duplicate tensor(3.9214, dtype=torch.float64) tensor(-2.9572, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.0374, dtype=torch.float64)
12 gae_duplicate tensor(3.1745, dtype=torch.float64) tensor(-2.0335, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.7749, dtype=torch.float64)
11 gae_duplicate tensor(3.3145, dtype=torch.float64) tensor(-9.3701, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4407, dtype=torch.float64) delta_t tensor(-1.8220, dtype=torch.float64)
10 gae_duplicate tensor(0.8297, dtype=torch.float64) tensor(-2.1072, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2151, dtype=torch.float64) delta_t tensor(-1.1317, dtype=torch.float64)
9 gae_duplicate tensor(-0.4680, dtype=torch.float64) tensor(0.1810, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6086, dtype=torch.float64) delta_t tensor(0.6108, dtype=torch.float64)
8 gae_duplicate tensor(0.2364, dtype=torch.float64) tensor(-0.3787, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6742, dtype=torch.float64) delta_t tensor(0.0587, dtype=torch.float64)
7 gae_duplicate tensor(0.2478, dtype=torch.float64) tensor(-0.2964, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8710, dtype=torch.float64) delta_t tensor(-1.8135, dtype=torch.float64)
6 gae_duplicate tensor(-1.6152, dtype=torch.float64) tensor(3.4457, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8547, dtype=torch.float64) delta_t tensor(0.9627, dtype=torch.float64)
5 gae_duplicate tensor(-0.3294, dtype=torch.float64) tensor(0.5202, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3744, dtype=torch.float64) delta_t tensor(2.2478, dtype=torch.float64)
4 gae_duplicate tensor(1.9843, dtype=torch.float64) tensor(-2.5036, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4125, dtype=torch.float64) delta_t tensor(0.5209, dtype=torch.float64)
3 gae_duplicate tensor(2.1083, dtype=torch.float64) tensor(-1.9576, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4125, dtype=torch.float64) delta_t tensor(-0.5760, dtype=torch.float64)
2 gae_duplicate tensor(1.1106, dtype=torch.float64) tensor(-0.6828, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:128.34820556640625
value loss:115.4450912475586
entropies:24.39906883239746
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.344565153121948 seconds
19 rew tensor(0.5708, dtype=torch.float64) delta_t tensor(-0.4157, dtype=torch.float64)
19 gae_duplicate tensor(-0.4157, dtype=torch.float64) tensor(1.0115, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7022, dtype=torch.float64) delta_t tensor(0.5628, dtype=torch.float64)
18 gae_duplicate tensor(0.2302, dtype=torch.float64) tensor(-0.0793, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6367, dtype=torch.float64) delta_t tensor(0.1627, dtype=torch.float64)
17 gae_duplicate tensor(0.3468, dtype=torch.float64) tensor(-0.8531, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3741, dtype=torch.float64) delta_t tensor(0.1140, dtype=torch.float64)
16 gae_duplicate tensor(0.3915, dtype=torch.float64) tensor(-0.1350, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0197, dtype=torch.float64) delta_t tensor(-0.2810, dtype=torch.float64)
15 gae_duplicate tensor(0.0322, dtype=torch.float64) tensor(-0.0112, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(-0.1809, dtype=torch.float64)
14 gae_duplicate tensor(-0.1551, dtype=torch.float64) tensor(0.0535, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8338, dtype=torch.float64) delta_t tensor(0.9819, dtype=torch.float64)
13 gae_duplicate tensor(0.8578, dtype=torch.float64) tensor(-3.8491, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-1.2665, dtype=torch.float64) delta_t tensor(-2.6375, dtype=torch.float64)
12 gae_duplicate tensor(-1.9513, dtype=torch.float64) tensor(4.6468, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6368, dtype=torch.float64) delta_t tensor(0.2642, dtype=torch.float64)
11 gae_duplicate tensor(-1.2969, dtype=torch.float64) tensor(0.4456, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5056, dtype=torch.float64) delta_t tensor(1.0282, dtype=torch.float64)
10 gae_duplicate tensor(-0.0093, dtype=torch.float64) tensor(0.0032, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1775, dtype=torch.float64) delta_t tensor(0.5027, dtype=torch.float64)
9 gae_duplicate tensor(0.4953, dtype=torch.float64) tensor(-0.1994, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2819, dtype=torch.float64) delta_t tensor(-0.7401, dtype=torch.float64)
8 gae_duplicate tensor(-0.3438, dtype=torch.float64) tensor(0.6016, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7413, dtype=torch.float64) delta_t tensor(-0.6828, dtype=torch.float64)
7 gae_duplicate tensor(-0.9579, dtype=torch.float64) tensor(1.3429, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6366, dtype=torch.float64) delta_t tensor(1.6219, dtype=torch.float64)
6 gae_duplicate tensor(0.8556, dtype=torch.float64) tensor(-0.6053, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3317, dtype=torch.float64) delta_t tensor(0.2508, dtype=torch.float64)
5 gae_duplicate tensor(0.9354, dtype=torch.float64) tensor(-0.7319, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7678, dtype=torch.float64) delta_t tensor(1.0259, dtype=torch.float64)
4 gae_duplicate tensor(1.7742, dtype=torch.float64) tensor(-1.3860, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7413, dtype=torch.float64) delta_t tensor(1.0497, dtype=torch.float64)
3 gae_duplicate tensor(2.4691, dtype=torch.float64) tensor(-2.0577, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3477, dtype=torch.float64) delta_t tensor(0.0164, dtype=torch.float64)
2 gae_duplicate tensor(1.9916, dtype=torch.float64) tensor(-3.1603, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:29.149158477783203
value loss:34.27289581298828
entropies:20.975950241088867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.33069372177124 seconds
19 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(-0.5237, dtype=torch.float64)
19 gae_duplicate tensor(-0.5237, dtype=torch.float64) tensor(0.1746, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(-0.0619, dtype=torch.float64)
18 gae_duplicate tensor(-0.4809, dtype=torch.float64) tensor(0.1604, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.7728, dtype=torch.float64)
17 gae_duplicate tensor(0.3880, dtype=torch.float64) tensor(-0.1294, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.8154, dtype=torch.float64)
16 gae_duplicate tensor(1.1258, dtype=torch.float64) tensor(-2.7913, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(-0.3078, dtype=torch.float64)
15 gae_duplicate tensor(0.5928, dtype=torch.float64) tensor(-0.1980, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.4135, dtype=torch.float64)
14 gae_duplicate tensor(0.8878, dtype=torch.float64) tensor(-0.2965, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.4136, dtype=torch.float64)
13 gae_duplicate tensor(1.1239, dtype=torch.float64) tensor(-2.7695, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.4138, dtype=torch.float64)
12 gae_duplicate tensor(1.3129, dtype=torch.float64) tensor(-0.4385, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(2.8272, dtype=torch.float64)
11 gae_duplicate tensor(3.8775, dtype=torch.float64) tensor(-2.2381, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(-1.4362, dtype=torch.float64)
10 gae_duplicate tensor(1.6658, dtype=torch.float64) tensor(-3.3756, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2436, dtype=torch.float64) delta_t tensor(0.0085, dtype=torch.float64)
9 gae_duplicate tensor(1.3411, dtype=torch.float64) tensor(-0.5837, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1502, dtype=torch.float64) delta_t tensor(-0.1625, dtype=torch.float64)
8 gae_duplicate tensor(0.9104, dtype=torch.float64) tensor(-0.4388, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6752, dtype=torch.float64) delta_t tensor(-0.9589, dtype=torch.float64)
7 gae_duplicate tensor(-0.2305, dtype=torch.float64) tensor(0.0906, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3315, dtype=torch.float64) delta_t tensor(-2.3202, dtype=torch.float64)
6 gae_duplicate tensor(-2.5046, dtype=torch.float64) tensor(0.8372, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.5788, dtype=torch.float64) delta_t tensor(-0.0183, dtype=torch.float64)
5 gae_duplicate tensor(-2.0220, dtype=torch.float64) tensor(1.6477, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7682, dtype=torch.float64) delta_t tensor(1.7197, dtype=torch.float64)
4 gae_duplicate tensor(0.1021, dtype=torch.float64) tensor(-0.2346, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9237, dtype=torch.float64) delta_t tensor(0.4746, dtype=torch.float64)
3 gae_duplicate tensor(0.5562, dtype=torch.float64) tensor(-0.8807, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2826, dtype=torch.float64) delta_t tensor(-0.7452, dtype=torch.float64)
2 gae_duplicate tensor(-0.3002, dtype=torch.float64) tensor(0.1645, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:67.17713928222656
value loss:55.96825408935547
entropies:20.69071388244629
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(354.2240)
ToM Target loss= tensor(310.8830)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.520096063613892 seconds
19 rew tensor(0.8983, dtype=torch.float64) delta_t tensor(-0.6895, dtype=torch.float64)
19 gae_duplicate tensor(-0.6895, dtype=torch.float64) tensor(0.2257, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.5809, dtype=torch.float64)
18 gae_duplicate tensor(0.0293, dtype=torch.float64) tensor(-0.0727, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(-0.3682, dtype=torch.float64)
17 gae_duplicate tensor(-0.3447, dtype=torch.float64) tensor(0.1126, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.9012, dtype=torch.float64)
16 gae_duplicate tensor(0.6254, dtype=torch.float64) tensor(-1.5598, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.4934, dtype=torch.float64)
15 gae_duplicate tensor(0.9937, dtype=torch.float64) tensor(-0.3244, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.4936, dtype=torch.float64)
14 gae_duplicate tensor(1.2886, dtype=torch.float64) tensor(-0.4206, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.4937, dtype=torch.float64)
13 gae_duplicate tensor(1.5246, dtype=torch.float64) tensor(-0.4977, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.4939, dtype=torch.float64)
12 gae_duplicate tensor(1.7135, dtype=torch.float64) tensor(-4.2503, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.2516, dtype=torch.float64)
11 gae_duplicate tensor(1.6224, dtype=torch.float64) tensor(-0.5277, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(-0.1177, dtype=torch.float64)
10 gae_duplicate tensor(1.1802, dtype=torch.float64) tensor(-2.9471, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.0464, dtype=torch.float64)
9 gae_duplicate tensor(0.9906, dtype=torch.float64) tensor(-0.3217, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7406, dtype=torch.float64) delta_t tensor(-0.2502, dtype=torch.float64)
8 gae_duplicate tensor(0.5423, dtype=torch.float64) tensor(-0.1764, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4625, dtype=torch.float64) delta_t tensor(-2.4817, dtype=torch.float64)
7 gae_duplicate tensor(-2.0478, dtype=torch.float64) tensor(9.5418, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5285, dtype=torch.float64) delta_t tensor(1.2329, dtype=torch.float64)
6 gae_duplicate tensor(-0.4053, dtype=torch.float64) tensor(0.7461, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8571, dtype=torch.float64) delta_t tensor(-0.4287, dtype=torch.float64)
5 gae_duplicate tensor(-0.7530, dtype=torch.float64) tensor(1.7036, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2517, dtype=torch.float64) delta_t tensor(-1.7453, dtype=torch.float64)
4 gae_duplicate tensor(-2.3477, dtype=torch.float64) tensor(4.0177, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8739, dtype=torch.float64) delta_t tensor(1.0496, dtype=torch.float64)
3 gae_duplicate tensor(-0.8286, dtype=torch.float64) tensor(3.4040, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2830, dtype=torch.float64) delta_t tensor(-0.6275, dtype=torch.float64)
2 gae_duplicate tensor(-1.2903, dtype=torch.float64) tensor(0.5890, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-56.06662368774414
value loss:40.47486114501953
entropies:20.485319137573242
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4446189403533936 seconds
19 rew tensor(0.7675, dtype=torch.float64) delta_t tensor(-1.1287, dtype=torch.float64)
19 gae_duplicate tensor(-1.1287, dtype=torch.float64) tensor(0.3605, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7019, dtype=torch.float64) delta_t tensor(0.3323, dtype=torch.float64)
18 gae_duplicate tensor(-0.5707, dtype=torch.float64) tensor(0.1823, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4395, dtype=torch.float64) delta_t tensor(0.1877, dtype=torch.float64)
17 gae_duplicate tensor(-0.2688, dtype=torch.float64) tensor(0.0859, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1114, dtype=torch.float64) delta_t tensor(-0.5545, dtype=torch.float64)
16 gae_duplicate tensor(-0.7696, dtype=torch.float64) tensor(0.2459, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.6104, dtype=torch.float64) delta_t tensor(-1.0652, dtype=torch.float64)
15 gae_duplicate tensor(-1.6808, dtype=torch.float64) tensor(0.5397, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7675, dtype=torch.float64) delta_t tensor(4.0444, dtype=torch.float64)
14 gae_duplicate tensor(2.6998, dtype=torch.float64) tensor(-7.0992, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8332, dtype=torch.float64) delta_t tensor(-0.1301, dtype=torch.float64)
13 gae_duplicate tensor(2.0297, dtype=torch.float64) tensor(-3.4969, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2428, dtype=torch.float64) delta_t tensor(0.3038, dtype=torch.float64)
12 gae_duplicate tensor(1.9276, dtype=torch.float64) tensor(-0.8918, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.7255, dtype=torch.float64) delta_t tensor(-1.6645, dtype=torch.float64)
11 gae_duplicate tensor(-0.1224, dtype=torch.float64) tensor(0.0566, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-3.1697, dtype=torch.float64) delta_t tensor(-5.3160, dtype=torch.float64)
10 gae_duplicate tensor(-5.4140, dtype=torch.float64) tensor(1.7150, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5706, dtype=torch.float64) delta_t tensor(0.5254, dtype=torch.float64)
9 gae_duplicate tensor(-3.8058, dtype=torch.float64) tensor(1.4552, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6363, dtype=torch.float64) delta_t tensor(0.4600, dtype=torch.float64)
8 gae_duplicate tensor(-2.5847, dtype=torch.float64) tensor(1.0316, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3486, dtype=torch.float64) delta_t tensor(-0.0172, dtype=torch.float64)
7 gae_duplicate tensor(-2.0849, dtype=torch.float64) tensor(0.9301, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7019, dtype=torch.float64) delta_t tensor(2.9283, dtype=torch.float64)
6 gae_duplicate tensor(1.2604, dtype=torch.float64) tensor(-2.4708, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6111, dtype=torch.float64) delta_t tensor(-0.2182, dtype=torch.float64)
5 gae_duplicate tensor(0.7901, dtype=torch.float64) tensor(-1.3885, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3736, dtype=torch.float64) delta_t tensor(2.3976, dtype=torch.float64)
4 gae_duplicate tensor(3.0297, dtype=torch.float64) tensor(-2.5113, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4141, dtype=torch.float64) delta_t tensor(0.5113, dtype=torch.float64)
3 gae_duplicate tensor(2.9350, dtype=torch.float64) tensor(-1.9661, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4142, dtype=torch.float64) delta_t tensor(-0.2660, dtype=torch.float64)
2 gae_duplicate tensor(2.0821, dtype=torch.float64) tensor(-0.9422, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:84.348876953125
value loss:149.08883666992188
entropies:21.185001373291016
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.414488792419434 seconds
19 rew tensor(0.5711, dtype=torch.float64) delta_t tensor(-0.9638, dtype=torch.float64)
19 gae_duplicate tensor(-0.9638, dtype=torch.float64) tensor(0.3047, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3741, dtype=torch.float64) delta_t tensor(0.2148, dtype=torch.float64)
18 gae_duplicate tensor(-0.5562, dtype=torch.float64) tensor(0.1759, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.2168, dtype=torch.float64) delta_t tensor(-0.7810, dtype=torch.float64)
17 gae_duplicate tensor(-1.2260, dtype=torch.float64) tensor(3.0610, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-1.1360, dtype=torch.float64) delta_t tensor(-1.2501, dtype=torch.float64)
16 gae_duplicate tensor(-2.2309, dtype=torch.float64) tensor(0.7079, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8335, dtype=torch.float64) delta_t tensor(0.6906, dtype=torch.float64)
15 gae_duplicate tensor(-1.0941, dtype=torch.float64) tensor(0.3471, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8336, dtype=torch.float64) delta_t tensor(2.7515, dtype=torch.float64)
14 gae_duplicate tensor(1.8762, dtype=torch.float64) tensor(-0.5922, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6368, dtype=torch.float64) delta_t tensor(0.0670, dtype=torch.float64)
13 gae_duplicate tensor(1.5680, dtype=torch.float64) tensor(-10.8351, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.9253, dtype=torch.float64)
12 gae_duplicate tensor(2.1796, dtype=torch.float64) tensor(-0.6883, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(-1.6697, dtype=torch.float64)
11 gae_duplicate tensor(0.0741, dtype=torch.float64) tensor(-0.0233, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6372, dtype=torch.float64) delta_t tensor(-0.1048, dtype=torch.float64)
10 gae_duplicate tensor(-0.0455, dtype=torch.float64) tensor(0.1148, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7413, dtype=torch.float64) delta_t tensor(-1.2040, dtype=torch.float64)
9 gae_duplicate tensor(-1.2404, dtype=torch.float64) tensor(0.3908, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8070, dtype=torch.float64) delta_t tensor(-1.2315, dtype=torch.float64)
8 gae_duplicate tensor(-2.2238, dtype=torch.float64) tensor(0.7015, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3477, dtype=torch.float64) delta_t tensor(0.6735, dtype=torch.float64)
7 gae_duplicate tensor(-1.1056, dtype=torch.float64) tensor(4.8118, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8072, dtype=torch.float64) delta_t tensor(0.5266, dtype=torch.float64)
6 gae_duplicate tensor(-0.3579, dtype=torch.float64) tensor(0.4284, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.5794, dtype=torch.float64) delta_t tensor(-1.4739, dtype=torch.float64)
5 gae_duplicate tensor(-1.7602, dtype=torch.float64) tensor(2.9818, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2425, dtype=torch.float64) delta_t tensor(2.3109, dtype=torch.float64)
4 gae_duplicate tensor(0.9027, dtype=torch.float64) tensor(-0.5683, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1514, dtype=torch.float64) delta_t tensor(0.9137, dtype=torch.float64)
3 gae_duplicate tensor(1.6358, dtype=torch.float64) tensor(-0.8806, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1514, dtype=torch.float64) delta_t tensor(0.5118, dtype=torch.float64)
2 gae_duplicate tensor(1.8205, dtype=torch.float64) tensor(-0.8285, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1.7599084377288818
value loss:56.08440399169922
entropies:19.473369598388672
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4079430103302 seconds
19 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(-1.9212, dtype=torch.float64)
19 gae_duplicate tensor(-1.9212, dtype=torch.float64) tensor(0.6007, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.8529, dtype=torch.float64)
18 gae_duplicate tensor(-0.6841, dtype=torch.float64) tensor(0.2139, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(4.4899, dtype=torch.float64)
17 gae_duplicate tensor(3.9426, dtype=torch.float64) tensor(-1.3495, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(1.2492, dtype=torch.float64)
16 gae_duplicate tensor(4.4033, dtype=torch.float64) tensor(-1.5072, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(1.2494, dtype=torch.float64)
15 gae_duplicate tensor(4.7720, dtype=torch.float64) tensor(-1.6334, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(1.2495, dtype=torch.float64)
14 gae_duplicate tensor(5.0672, dtype=torch.float64) tensor(-1.7345, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6375, dtype=torch.float64) delta_t tensor(1.2082, dtype=torch.float64)
13 gae_duplicate tensor(5.2619, dtype=torch.float64) tensor(-1.7242, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4407, dtype=torch.float64) delta_t tensor(-3.3625, dtype=torch.float64)
12 gae_duplicate tensor(0.8470, dtype=torch.float64) tensor(-0.2653, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4407, dtype=torch.float64) delta_t tensor(0.2765, dtype=torch.float64)
11 gae_duplicate tensor(0.9541, dtype=torch.float64) tensor(-2.4069, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3752, dtype=torch.float64) delta_t tensor(0.1215, dtype=torch.float64)
10 gae_duplicate tensor(0.8848, dtype=torch.float64) tensor(-0.2778, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3096, dtype=torch.float64) delta_t tensor(0.1607, dtype=torch.float64)
9 gae_duplicate tensor(0.8685, dtype=torch.float64) tensor(-0.2737, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8058, dtype=torch.float64) delta_t tensor(-0.9208, dtype=torch.float64)
8 gae_duplicate tensor(-0.2261, dtype=torch.float64) tensor(0.0721, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2810, dtype=torch.float64) delta_t tensor(-0.6228, dtype=torch.float64)
7 gae_duplicate tensor(-0.8037, dtype=torch.float64) tensor(1.9331, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3963, dtype=torch.float64) delta_t tensor(-0.4899, dtype=torch.float64)
6 gae_duplicate tensor(-1.1329, dtype=torch.float64) tensor(0.3826, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7247, dtype=torch.float64) delta_t tensor(0.2031, dtype=torch.float64)
5 gae_duplicate tensor(-0.7032, dtype=torch.float64) tensor(0.3269, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6939, dtype=torch.float64) delta_t tensor(-3.0919, dtype=torch.float64)
4 gae_duplicate tensor(-3.6545, dtype=torch.float64) tensor(1.5187, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1512, dtype=torch.float64) delta_t tensor(1.4513, dtype=torch.float64)
3 gae_duplicate tensor(-1.4723, dtype=torch.float64) tensor(0.7245, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2169, dtype=torch.float64) delta_t tensor(0.8026, dtype=torch.float64)
2 gae_duplicate tensor(-0.3752, dtype=torch.float64) tensor(0.6838, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:27.738399505615234
value loss:204.79794311523438
entropies:18.61114501953125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.385538101196289 seconds
19 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(-0.7428, dtype=torch.float64)
19 gae_duplicate tensor(-0.7428, dtype=torch.float64) tensor(0.2314, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.5708, dtype=torch.float64)
18 gae_duplicate tensor(-0.0234, dtype=torch.float64) tensor(0.0073, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.5710, dtype=torch.float64)
17 gae_duplicate tensor(0.5523, dtype=torch.float64) tensor(-1.3901, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.5711, dtype=torch.float64)
16 gae_duplicate tensor(1.0129, dtype=torch.float64) tensor(-0.3156, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(-0.6338, dtype=torch.float64)
15 gae_duplicate tensor(0.1765, dtype=torch.float64) tensor(-0.4463, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.4759, dtype=torch.float64)
14 gae_duplicate tensor(0.6172, dtype=torch.float64) tensor(-4.3018, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.3596, dtype=torch.float64)
13 gae_duplicate tensor(0.8534, dtype=torch.float64) tensor(-0.2639, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.3738, dtype=torch.float64)
12 gae_duplicate tensor(1.0565, dtype=torch.float64) tensor(-0.3267, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.3631, dtype=torch.float64)
11 gae_duplicate tensor(1.2083, dtype=torch.float64) tensor(-0.3736, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6378, dtype=torch.float64) delta_t tensor(0.2244, dtype=torch.float64)
10 gae_duplicate tensor(1.1911, dtype=torch.float64) tensor(-0.3687, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3753, dtype=torch.float64) delta_t tensor(-0.5276, dtype=torch.float64)
9 gae_duplicate tensor(0.4253, dtype=torch.float64) tensor(-0.1314, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0185, dtype=torch.float64) delta_t tensor(-0.5308, dtype=torch.float64)
8 gae_duplicate tensor(-0.1906, dtype=torch.float64) tensor(0.4817, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0472, dtype=torch.float64) delta_t tensor(0.0428, dtype=torch.float64)
7 gae_duplicate tensor(-0.1097, dtype=torch.float64) tensor(0.0341, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9371, dtype=torch.float64) delta_t tensor(0.8084, dtype=torch.float64)
6 gae_duplicate tensor(0.7206, dtype=torch.float64) tensor(-0.3197, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4780, dtype=torch.float64) delta_t tensor(0.5119, dtype=torch.float64)
5 gae_duplicate tensor(1.0884, dtype=torch.float64) tensor(-2.2371, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8559, dtype=torch.float64) delta_t tensor(-0.6540, dtype=torch.float64)
4 gae_duplicate tensor(0.2168, dtype=torch.float64) tensor(-0.1628, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7910, dtype=torch.float64) delta_t tensor(0.1488, dtype=torch.float64)
3 gae_duplicate tensor(0.3222, dtype=torch.float64) tensor(-0.8190, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4635, dtype=torch.float64) delta_t tensor(-0.7987, dtype=torch.float64)
2 gae_duplicate tensor(-0.5409, dtype=torch.float64) tensor(1.4338, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:55.041595458984375
value loss:14.092514038085938
entropies:18.946033477783203
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(336.8997)
ToM Target loss= tensor(310.7264)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.386409282684326 seconds
19 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(-1.0106, dtype=torch.float64)
19 gae_duplicate tensor(-1.0106, dtype=torch.float64) tensor(0.3117, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.5171, dtype=torch.float64)
18 gae_duplicate tensor(-0.2913, dtype=torch.float64) tensor(0.7399, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.5173, dtype=torch.float64)
17 gae_duplicate tensor(0.2842, dtype=torch.float64) tensor(-0.7148, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.5174, dtype=torch.float64)
16 gae_duplicate tensor(0.7448, dtype=torch.float64) tensor(-0.2297, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.4883, dtype=torch.float64)
15 gae_duplicate tensor(1.0841, dtype=torch.float64) tensor(-0.3319, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8339, dtype=torch.float64) delta_t tensor(0.0774, dtype=torch.float64)
14 gae_duplicate tensor(0.9447, dtype=torch.float64) tensor(-2.3991, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.4382, dtype=torch.float64)
13 gae_duplicate tensor(1.1939, dtype=torch.float64) tensor(-0.3651, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.4383, dtype=torch.float64)
12 gae_duplicate tensor(1.3935, dtype=torch.float64) tensor(-0.4261, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.0697, dtype=torch.float64) delta_t tensor(-1.5312, dtype=torch.float64)
11 gae_duplicate tensor(-0.4164, dtype=torch.float64) tensor(0.1273, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.2012, dtype=torch.float64) delta_t tensor(-1.9426, dtype=torch.float64)
10 gae_duplicate tensor(-2.2757, dtype=torch.float64) tensor(0.6958, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5057, dtype=torch.float64) delta_t tensor(0.2322, dtype=torch.float64)
9 gae_duplicate tensor(-1.5883, dtype=torch.float64) tensor(0.4857, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0195, dtype=torch.float64) delta_t tensor(-0.6405, dtype=torch.float64)
8 gae_duplicate tensor(-1.9112, dtype=torch.float64) tensor(0.5843, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8729, dtype=torch.float64) delta_t tensor(1.4870, dtype=torch.float64)
7 gae_duplicate tensor(-0.0419, dtype=torch.float64) tensor(0.0265, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6368, dtype=torch.float64) delta_t tensor(1.0678, dtype=torch.float64)
6 gae_duplicate tensor(1.0343, dtype=torch.float64) tensor(-1.7098, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1201, dtype=torch.float64) delta_t tensor(0.1726, dtype=torch.float64)
5 gae_duplicate tensor(1.0000, dtype=torch.float64) tensor(-3.0096, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7024, dtype=torch.float64) delta_t tensor(1.4125, dtype=torch.float64)
4 gae_duplicate tensor(2.2125, dtype=torch.float64) tensor(-6.3427, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4643, dtype=torch.float64) delta_t tensor(-0.3624, dtype=torch.float64)
3 gae_duplicate tensor(1.4077, dtype=torch.float64) tensor(-0.5791, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0200, dtype=torch.float64) delta_t tensor(-1.3964, dtype=torch.float64)
2 gae_duplicate tensor(-0.2703, dtype=torch.float64) tensor(0.0954, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:77.66813659667969
value loss:41.58820724487305
entropies:19.298168182373047
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4797890186309814 seconds
19 rew tensor(0.8336, dtype=torch.float64) delta_t tensor(-0.3789, dtype=torch.float64)
19 gae_duplicate tensor(-0.3789, dtype=torch.float64) tensor(0.9489, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7680, dtype=torch.float64) delta_t tensor(0.4466, dtype=torch.float64)
18 gae_duplicate tensor(0.1435, dtype=torch.float64) tensor(-0.0445, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7025, dtype=torch.float64) delta_t tensor(-0.3213, dtype=torch.float64)
17 gae_duplicate tensor(-0.2065, dtype=torch.float64) tensor(0.0641, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4398, dtype=torch.float64) delta_t tensor(0.0857, dtype=torch.float64)
16 gae_duplicate tensor(-0.0795, dtype=torch.float64) tensor(0.0247, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0457, dtype=torch.float64) delta_t tensor(0.5155, dtype=torch.float64)
15 gae_duplicate tensor(0.4520, dtype=torch.float64) tensor(-1.1421, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(2.9301, dtype=torch.float64)
14 gae_duplicate tensor(3.2917, dtype=torch.float64) tensor(-1.0197, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5713, dtype=torch.float64) delta_t tensor(-1.1643, dtype=torch.float64)
13 gae_duplicate tensor(1.4690, dtype=torch.float64) tensor(-6.9880, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6370, dtype=torch.float64) delta_t tensor(-0.6229, dtype=torch.float64)
12 gae_duplicate tensor(0.5523, dtype=torch.float64) tensor(-0.1710, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3744, dtype=torch.float64) delta_t tensor(0.2464, dtype=torch.float64)
11 gae_duplicate tensor(0.6883, dtype=torch.float64) tensor(-0.2135, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3745, dtype=torch.float64) delta_t tensor(1.2085, dtype=torch.float64)
10 gae_duplicate tensor(1.7591, dtype=torch.float64) tensor(-0.5428, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2432, dtype=torch.float64) delta_t tensor(-0.2122, dtype=torch.float64)
9 gae_duplicate tensor(1.1951, dtype=torch.float64) tensor(-3.0234, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1776, dtype=torch.float64) delta_t tensor(-1.2887, dtype=torch.float64)
8 gae_duplicate tensor(-0.3326, dtype=torch.float64) tensor(0.8411, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6605, dtype=torch.float64) delta_t tensor(-0.0255, dtype=torch.float64)
7 gae_duplicate tensor(-0.2916, dtype=torch.float64) tensor(0.6784, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.2520, dtype=torch.float64) delta_t tensor(-0.9479, dtype=torch.float64)
6 gae_duplicate tensor(-1.1811, dtype=torch.float64) tensor(2.3254, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8739, dtype=torch.float64) delta_t tensor(1.0215, dtype=torch.float64)
5 gae_duplicate tensor(0.0765, dtype=torch.float64) tensor(-0.1351, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2024, dtype=torch.float64) delta_t tensor(-0.2145, dtype=torch.float64)
4 gae_duplicate tensor(-0.1533, dtype=torch.float64) tensor(0.0665, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8086, dtype=torch.float64) delta_t tensor(0.0174, dtype=torch.float64)
3 gae_duplicate tensor(-0.1052, dtype=torch.float64) tensor(0.0398, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2422, dtype=torch.float64) delta_t tensor(-0.2373, dtype=torch.float64)
2 gae_duplicate tensor(-0.3214, dtype=torch.float64) tensor(0.1115, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:48.52056121826172
value loss:30.669673919677734
entropies:18.62144660949707
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.33838415145874 seconds
19 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(-0.0112, dtype=torch.float64)
19 gae_duplicate tensor(-0.0112, dtype=torch.float64) tensor(0.0035, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(-0.1474, dtype=torch.float64)
18 gae_duplicate tensor(-0.1564, dtype=torch.float64) tensor(0.0486, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.5878, dtype=torch.float64)
17 gae_duplicate tensor(0.4627, dtype=torch.float64) tensor(-1.1681, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.5531, dtype=torch.float64)
16 gae_duplicate tensor(0.9233, dtype=torch.float64) tensor(-0.2870, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.5698, dtype=torch.float64)
15 gae_duplicate tensor(1.3084, dtype=torch.float64) tensor(-0.4067, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.6006, dtype=torch.float64)
14 gae_duplicate tensor(1.6473, dtype=torch.float64) tensor(-0.5118, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(1.1139, dtype=torch.float64)
13 gae_duplicate tensor(2.4317, dtype=torch.float64) tensor(-0.7558, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8341, dtype=torch.float64) delta_t tensor(0.7080, dtype=torch.float64)
12 gae_duplicate tensor(2.6534, dtype=torch.float64) tensor(-0.8272, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2825, dtype=torch.float64) delta_t tensor(0.7457, dtype=torch.float64)
11 gae_duplicate tensor(2.8684, dtype=torch.float64) tensor(-1.3901, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7684, dtype=torch.float64) delta_t tensor(0.3665, dtype=torch.float64)
10 gae_duplicate tensor(2.6612, dtype=torch.float64) tensor(-4.3884, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.6470, dtype=torch.float64) delta_t tensor(-2.5320, dtype=torch.float64)
9 gae_duplicate tensor(-0.4030, dtype=torch.float64) tensor(0.1796, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4399, dtype=torch.float64) delta_t tensor(-1.8729, dtype=torch.float64)
8 gae_duplicate tensor(-2.1953, dtype=torch.float64) tensor(0.8854, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1515, dtype=torch.float64) delta_t tensor(3.0245, dtype=torch.float64)
7 gae_duplicate tensor(1.2682, dtype=torch.float64) tensor(-0.7496, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5713, dtype=torch.float64) delta_t tensor(1.7494, dtype=torch.float64)
6 gae_duplicate tensor(2.7639, dtype=torch.float64) tensor(-1.5497, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5312, dtype=torch.float64) delta_t tensor(-0.3063, dtype=torch.float64)
5 gae_duplicate tensor(1.9049, dtype=torch.float64) tensor(-1.3055, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7683, dtype=torch.float64) delta_t tensor(-0.1178, dtype=torch.float64)
4 gae_duplicate tensor(1.4061, dtype=torch.float64) tensor(-0.8473, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0715, dtype=torch.float64) delta_t tensor(1.1321, dtype=torch.float64)
3 gae_duplicate tensor(2.2570, dtype=torch.float64) tensor(-0.9571, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2174, dtype=torch.float64) delta_t tensor(-0.0203, dtype=torch.float64)
2 gae_duplicate tensor(1.7853, dtype=torch.float64) tensor(-4.5842, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:111.06999206542969
value loss:92.84580993652344
entropies:19.963855743408203
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.238609790802002 seconds
19 rew tensor(0.8982, dtype=torch.float64) delta_t tensor(-0.5372, dtype=torch.float64)
19 gae_duplicate tensor(-0.5372, dtype=torch.float64) tensor(0.1693, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8983, dtype=torch.float64) delta_t tensor(0.5094, dtype=torch.float64)
18 gae_duplicate tensor(0.0796, dtype=torch.float64) tensor(-0.0251, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8328, dtype=torch.float64) delta_t tensor(-0.0538, dtype=torch.float64)
17 gae_duplicate tensor(0.0098, dtype=torch.float64) tensor(-0.0248, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8329, dtype=torch.float64) delta_t tensor(0.4393, dtype=torch.float64)
16 gae_duplicate tensor(0.4471, dtype=torch.float64) tensor(-0.1404, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8331, dtype=torch.float64) delta_t tensor(0.4108, dtype=torch.float64)
15 gae_duplicate tensor(0.7685, dtype=torch.float64) tensor(-1.9404, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8332, dtype=torch.float64) delta_t tensor(0.4062, dtype=torch.float64)
14 gae_duplicate tensor(1.0210, dtype=torch.float64) tensor(-0.3207, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7677, dtype=torch.float64) delta_t tensor(0.3172, dtype=torch.float64)
13 gae_duplicate tensor(1.1341, dtype=torch.float64) tensor(-0.3561, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.4729, dtype=torch.float64)
12 gae_duplicate tensor(1.3801, dtype=torch.float64) tensor(-0.4334, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8335, dtype=torch.float64) delta_t tensor(0.3824, dtype=torch.float64)
11 gae_duplicate tensor(1.4865, dtype=torch.float64) tensor(-0.4668, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7024, dtype=torch.float64) delta_t tensor(0.2345, dtype=torch.float64)
10 gae_duplicate tensor(1.4238, dtype=torch.float64) tensor(-0.4475, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8069, dtype=torch.float64) delta_t tensor(-1.2537, dtype=torch.float64)
9 gae_duplicate tensor(-0.1147, dtype=torch.float64) tensor(0.0361, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.5945, dtype=torch.float64) delta_t tensor(-2.0905, dtype=torch.float64)
8 gae_duplicate tensor(-2.1823, dtype=torch.float64) tensor(0.6836, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6761, dtype=torch.float64) delta_t tensor(-0.2760, dtype=torch.float64)
7 gae_duplicate tensor(-2.0219, dtype=torch.float64) tensor(5.0518, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5449, dtype=torch.float64) delta_t tensor(1.0329, dtype=torch.float64)
6 gae_duplicate tensor(-0.5846, dtype=torch.float64) tensor(0.3212, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5450, dtype=torch.float64) delta_t tensor(0.5277, dtype=torch.float64)
5 gae_duplicate tensor(0.0600, dtype=torch.float64) tensor(-0.2169, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.3511, dtype=torch.float64) delta_t tensor(-2.6710, dtype=torch.float64)
4 gae_duplicate tensor(-2.6231, dtype=torch.float64) tensor(1.1356, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1523, dtype=torch.float64) delta_t tensor(1.0518, dtype=torch.float64)
3 gae_duplicate tensor(-1.0467, dtype=torch.float64) tensor(0.4074, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1523, dtype=torch.float64) delta_t tensor(0.5328, dtype=torch.float64)
2 gae_duplicate tensor(-0.3045, dtype=torch.float64) tensor(0.1092, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-21.80352783203125
value loss:40.249900817871094
entropies:18.43124771118164
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.341933727264404 seconds
19 rew tensor(0.8976, dtype=torch.float64) delta_t tensor(2.4423, dtype=torch.float64)
19 gae_duplicate tensor(2.4423, dtype=torch.float64) tensor(-6.1682, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8977, dtype=torch.float64) delta_t tensor(0.5685, dtype=torch.float64)
18 gae_duplicate tensor(2.5223, dtype=torch.float64) tensor(-6.3852, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8978, dtype=torch.float64) delta_t tensor(1.0792, dtype=torch.float64)
17 gae_duplicate tensor(3.0970, dtype=torch.float64) tensor(-0.9650, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8980, dtype=torch.float64) delta_t tensor(-2.4650, dtype=torch.float64)
16 gae_duplicate tensor(0.0127, dtype=torch.float64) tensor(-0.0039, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8981, dtype=torch.float64) delta_t tensor(0.2732, dtype=torch.float64)
15 gae_duplicate tensor(0.2833, dtype=torch.float64) tensor(-0.7151, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8983, dtype=torch.float64) delta_t tensor(0.3512, dtype=torch.float64)
14 gae_duplicate tensor(0.5779, dtype=torch.float64) tensor(-0.1795, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.3514, dtype=torch.float64)
13 gae_duplicate tensor(0.8137, dtype=torch.float64) tensor(-0.2527, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(0.3515, dtype=torch.float64)
12 gae_duplicate tensor(1.0025, dtype=torch.float64) tensor(-0.3113, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.3616, dtype=torch.float64)
11 gae_duplicate tensor(1.1636, dtype=torch.float64) tensor(-0.3613, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5708, dtype=torch.float64) delta_t tensor(0.0042, dtype=torch.float64)
10 gae_duplicate tensor(0.9351, dtype=torch.float64) tensor(-0.2904, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1773, dtype=torch.float64) delta_t tensor(-0.6303, dtype=torch.float64)
9 gae_duplicate tensor(0.1178, dtype=torch.float64) tensor(-0.0366, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6097, dtype=torch.float64) delta_t tensor(-0.8989, dtype=torch.float64)
8 gae_duplicate tensor(-0.8047, dtype=torch.float64) tensor(0.2504, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5935, dtype=torch.float64) delta_t tensor(-0.3419, dtype=torch.float64)
7 gae_duplicate tensor(-0.9856, dtype=torch.float64) tensor(2.5215, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.9876, dtype=torch.float64) delta_t tensor(-3.7985, dtype=torch.float64)
6 gae_duplicate tensor(-4.5870, dtype=torch.float64) tensor(11.5929, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.9725, dtype=torch.float64) delta_t tensor(-0.1025, dtype=torch.float64)
5 gae_duplicate tensor(-3.7721, dtype=torch.float64) tensor(1.5510, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7672, dtype=torch.float64) delta_t tensor(1.7343, dtype=torch.float64)
4 gae_duplicate tensor(-1.2833, dtype=torch.float64) tensor(2.5552, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5961, dtype=torch.float64) delta_t tensor(0.4992, dtype=torch.float64)
3 gae_duplicate tensor(-0.5274, dtype=torch.float64) tensor(2.2813, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0208, dtype=torch.float64) delta_t tensor(-2.3417, dtype=torch.float64)
2 gae_duplicate tensor(-2.7637, dtype=torch.float64) tensor(0.8674, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-36.24367141723633
value loss:109.04026794433594
entropies:18.013002395629883
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(336.3470)
ToM Target loss= tensor(311.2959)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.509454965591431 seconds
19 rew tensor(0.7670, dtype=torch.float64) delta_t tensor(-1.1992, dtype=torch.float64)
19 gae_duplicate tensor(-1.1992, dtype=torch.float64) tensor(0.3748, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7014, dtype=torch.float64) delta_t tensor(0.2820, dtype=torch.float64)
18 gae_duplicate tensor(-0.6774, dtype=torch.float64) tensor(0.2117, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5046, dtype=torch.float64) delta_t tensor(0.2170, dtype=torch.float64)
17 gae_duplicate tensor(-0.3249, dtype=torch.float64) tensor(0.8135, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1108, dtype=torch.float64) delta_t tensor(0.4748, dtype=torch.float64)
16 gae_duplicate tensor(0.2149, dtype=torch.float64) tensor(-0.0672, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.5455, dtype=torch.float64) delta_t tensor(-1.2343, dtype=torch.float64)
15 gae_duplicate tensor(-1.0623, dtype=torch.float64) tensor(0.3332, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8983, dtype=torch.float64) delta_t tensor(0.5779, dtype=torch.float64)
14 gae_duplicate tensor(-0.2720, dtype=torch.float64) tensor(0.0853, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.5781, dtype=torch.float64)
13 gae_duplicate tensor(0.3605, dtype=torch.float64) tensor(-0.1131, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7673, dtype=torch.float64) delta_t tensor(2.8247, dtype=torch.float64)
12 gae_duplicate tensor(3.1131, dtype=torch.float64) tensor(-1.0453, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1513, dtype=torch.float64) delta_t tensor(0.3268, dtype=torch.float64)
11 gae_duplicate tensor(2.8173, dtype=torch.float64) tensor(-12.8984, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5048, dtype=torch.float64) delta_t tensor(-1.8037, dtype=torch.float64)
10 gae_duplicate tensor(0.4501, dtype=torch.float64) tensor(-0.1395, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8074, dtype=torch.float64) delta_t tensor(-1.1826, dtype=torch.float64)
9 gae_duplicate tensor(-0.8225, dtype=torch.float64) tensor(0.2555, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1355, dtype=torch.float64) delta_t tensor(-1.4998, dtype=torch.float64)
8 gae_duplicate tensor(-2.1578, dtype=torch.float64) tensor(0.6686, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1109, dtype=torch.float64) delta_t tensor(-0.6890, dtype=torch.float64)
7 gae_duplicate tensor(-2.4153, dtype=torch.float64) tensor(0.7483, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6108, dtype=torch.float64) delta_t tensor(0.3906, dtype=torch.float64)
6 gae_duplicate tensor(-1.5416, dtype=torch.float64) tensor(0.4770, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.5044, dtype=torch.float64) delta_t tensor(3.0452, dtype=torch.float64)
5 gae_duplicate tensor(1.8119, dtype=torch.float64) tensor(-3.7552, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7259, dtype=torch.float64) delta_t tensor(-0.4431, dtype=torch.float64)
4 gae_duplicate tensor(1.0064, dtype=torch.float64) tensor(-1.4360, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3730, dtype=torch.float64) delta_t tensor(-0.3536, dtype=torch.float64)
3 gae_duplicate tensor(0.4516, dtype=torch.float64) tensor(-0.2184, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7263, dtype=torch.float64) delta_t tensor(0.3778, dtype=torch.float64)
2 gae_duplicate tensor(0.7390, dtype=torch.float64) tensor(-0.2535, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:95.19937896728516
value loss:59.70204162597656
entropies:18.394575119018555
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.3664069175720215 seconds
19 rew tensor(0.8336, dtype=torch.float64) delta_t tensor(-1.5087, dtype=torch.float64)
19 gae_duplicate tensor(-1.5087, dtype=torch.float64) tensor(0.4686, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8337, dtype=torch.float64) delta_t tensor(0.3528, dtype=torch.float64)
18 gae_duplicate tensor(-0.8541, dtype=torch.float64) tensor(0.2653, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7025, dtype=torch.float64) delta_t tensor(0.2156, dtype=torch.float64)
17 gae_duplicate tensor(-0.4677, dtype=torch.float64) tensor(0.1453, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5713, dtype=torch.float64) delta_t tensor(0.0062, dtype=torch.float64)
16 gae_duplicate tensor(-0.3680, dtype=torch.float64) tensor(0.1143, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1119, dtype=torch.float64) delta_t tensor(0.0118, dtype=torch.float64)
15 gae_duplicate tensor(-0.2826, dtype=torch.float64) tensor(0.0878, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.5445, dtype=torch.float64) delta_t tensor(0.6891, dtype=torch.float64)
14 gae_duplicate tensor(0.4630, dtype=torch.float64) tensor(-0.1445, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7681, dtype=torch.float64) delta_t tensor(0.9297, dtype=torch.float64)
13 gae_duplicate tensor(1.3001, dtype=torch.float64) tensor(-0.4069, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6370, dtype=torch.float64) delta_t tensor(1.4919, dtype=torch.float64)
12 gae_duplicate tensor(2.5320, dtype=torch.float64) tensor(-6.3571, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(1.0424, dtype=torch.float64)
11 gae_duplicate tensor(3.0680, dtype=torch.float64) tensor(-0.9577, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8341, dtype=torch.float64) delta_t tensor(-0.4125, dtype=torch.float64)
10 gae_duplicate tensor(2.0419, dtype=torch.float64) tensor(-5.1414, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5440, dtype=torch.float64) delta_t tensor(-2.5087, dtype=torch.float64)
9 gae_duplicate tensor(-0.8752, dtype=torch.float64) tensor(2.2098, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2659, dtype=torch.float64) delta_t tensor(-1.5443, dtype=torch.float64)
8 gae_duplicate tensor(-2.2445, dtype=torch.float64) tensor(5.6680, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6756, dtype=torch.float64) delta_t tensor(-1.0281, dtype=torch.float64)
7 gae_duplicate tensor(-2.8237, dtype=torch.float64) tensor(0.8770, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1350, dtype=torch.float64) delta_t tensor(-1.2525, dtype=torch.float64)
6 gae_duplicate tensor(-3.5115, dtype=torch.float64) tensor(1.0909, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9228, dtype=torch.float64) delta_t tensor(-0.0252, dtype=torch.float64)
5 gae_duplicate tensor(-2.8344, dtype=torch.float64) tensor(0.8905, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6610, dtype=torch.float64) delta_t tensor(-1.2324, dtype=torch.float64)
4 gae_duplicate tensor(-3.4999, dtype=torch.float64) tensor(1.0939, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8080, dtype=torch.float64) delta_t tensor(0.3814, dtype=torch.float64)
3 gae_duplicate tensor(-2.4185, dtype=torch.float64) tensor(0.8092, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8738, dtype=torch.float64) delta_t tensor(1.2427, dtype=torch.float64)
2 gae_duplicate tensor(-0.6921, dtype=torch.float64) tensor(1.1304, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-11.589445114135742
value loss:117.08375549316406
entropies:17.66200828552246
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.680785179138184 seconds
19 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(-1.3445, dtype=torch.float64)
19 gae_duplicate tensor(-1.3445, dtype=torch.float64) tensor(0.4264, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.3571, dtype=torch.float64)
18 gae_duplicate tensor(-0.7185, dtype=torch.float64) tensor(0.2278, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.3808, dtype=torch.float64)
17 gae_duplicate tensor(-0.1940, dtype=torch.float64) tensor(0.0616, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.6516, dtype=torch.float64)
16 gae_duplicate tensor(0.4964, dtype=torch.float64) tensor(-1.2481, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.6766, dtype=torch.float64) delta_t tensor(-1.3305, dtype=torch.float64)
15 gae_duplicate tensor(-0.9333, dtype=torch.float64) tensor(0.2976, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7687, dtype=torch.float64) delta_t tensor(0.3413, dtype=torch.float64)
14 gae_duplicate tensor(-0.4054, dtype=torch.float64) tensor(0.1294, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7689, dtype=torch.float64) delta_t tensor(2.9933, dtype=torch.float64)
13 gae_duplicate tensor(2.6690, dtype=torch.float64) tensor(-0.8509, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3091, dtype=torch.float64) delta_t tensor(-2.4523, dtype=torch.float64)
12 gae_duplicate tensor(-0.3171, dtype=torch.float64) tensor(0.7960, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5062, dtype=torch.float64) delta_t tensor(2.4948, dtype=torch.float64)
11 gae_duplicate tensor(2.2411, dtype=torch.float64) tensor(-0.7111, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0193, dtype=torch.float64) delta_t tensor(-1.8501, dtype=torch.float64)
10 gae_duplicate tensor(-0.0572, dtype=torch.float64) tensor(0.1439, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6376, dtype=torch.float64) delta_t tensor(0.2949, dtype=torch.float64)
9 gae_duplicate tensor(0.2492, dtype=torch.float64) tensor(-0.0788, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4789, dtype=torch.float64) delta_t tensor(-0.3896, dtype=torch.float64)
8 gae_duplicate tensor(-0.1903, dtype=torch.float64) tensor(0.0601, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7689, dtype=torch.float64) delta_t tensor(0.5538, dtype=torch.float64)
7 gae_duplicate tensor(0.4016, dtype=torch.float64) tensor(-0.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4131, dtype=torch.float64) delta_t tensor(0.3147, dtype=torch.float64)
6 gae_duplicate tensor(0.6359, dtype=torch.float64) tensor(-0.2017, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3475, dtype=torch.float64) delta_t tensor(0.1776, dtype=torch.float64)
5 gae_duplicate tensor(0.6863, dtype=torch.float64) tensor(-0.2949, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0042, dtype=torch.float64) delta_t tensor(1.6982, dtype=torch.float64)
4 gae_duplicate tensor(2.2473, dtype=torch.float64) tensor(-4.8184, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3326, dtype=torch.float64) delta_t tensor(0.0154, dtype=torch.float64)
3 gae_duplicate tensor(1.8132, dtype=torch.float64) tensor(-0.7399, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6106, dtype=torch.float64) delta_t tensor(-0.9594, dtype=torch.float64)
2 gae_duplicate tensor(0.4912, dtype=torch.float64) tensor(-1.2672, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:48.62722396850586
value loss:38.41154098510742
entropies:18.141389846801758
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.495485067367554 seconds
19 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(-1.1587, dtype=torch.float64)
19 gae_duplicate tensor(-1.1587, dtype=torch.float64) tensor(2.9045, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.4880, dtype=torch.float64)
18 gae_duplicate tensor(-0.4390, dtype=torch.float64) tensor(1.0920, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.4882, dtype=torch.float64)
17 gae_duplicate tensor(0.1370, dtype=torch.float64) tensor(-0.0441, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.1249, dtype=torch.float64)
16 gae_duplicate tensor(0.2345, dtype=torch.float64) tensor(-0.5872, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(0.3626, dtype=torch.float64)
15 gae_duplicate tensor(0.5502, dtype=torch.float64) tensor(-1.3795, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.4053, dtype=torch.float64)
14 gae_duplicate tensor(0.8454, dtype=torch.float64) tensor(-0.2701, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.4054, dtype=torch.float64)
13 gae_duplicate tensor(1.0817, dtype=torch.float64) tensor(-0.3456, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.4055, dtype=torch.float64)
12 gae_duplicate tensor(1.2709, dtype=torch.float64) tensor(-0.4060, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.0716, dtype=torch.float64) delta_t tensor(-1.5666, dtype=torch.float64)
11 gae_duplicate tensor(-0.5498, dtype=torch.float64) tensor(0.1757, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7690, dtype=torch.float64) delta_t tensor(0.2875, dtype=torch.float64)
10 gae_duplicate tensor(-0.1524, dtype=torch.float64) tensor(0.0487, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4404, dtype=torch.float64) delta_t tensor(-0.4066, dtype=torch.float64)
9 gae_duplicate tensor(-0.5285, dtype=torch.float64) tensor(0.1688, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0854, dtype=torch.float64) delta_t tensor(-0.2124, dtype=torch.float64)
8 gae_duplicate tensor(-0.6351, dtype=torch.float64) tensor(0.2030, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7690, dtype=torch.float64) delta_t tensor(0.8717, dtype=torch.float64)
7 gae_duplicate tensor(0.3635, dtype=torch.float64) tensor(-0.1163, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8083, dtype=torch.float64) delta_t tensor(-0.0761, dtype=torch.float64)
6 gae_duplicate tensor(0.2147, dtype=torch.float64) tensor(-0.0687, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3746, dtype=torch.float64) delta_t tensor(1.0068, dtype=torch.float64)
5 gae_duplicate tensor(1.1786, dtype=torch.float64) tensor(-5.5104, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4797, dtype=torch.float64) delta_t tensor(0.6459, dtype=torch.float64)
4 gae_duplicate tensor(1.5887, dtype=torch.float64) tensor(-0.5103, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2431, dtype=torch.float64) delta_t tensor(1.4380, dtype=torch.float64)
3 gae_duplicate tensor(2.7090, dtype=torch.float64) tensor(-0.9251, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8082, dtype=torch.float64) delta_t tensor(-1.5073, dtype=torch.float64)
2 gae_duplicate tensor(0.6599, dtype=torch.float64) tensor(-0.2123, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:34.16506576538086
value loss:27.428733825683594
entropies:17.750459671020508
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.447346925735474 seconds
19 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(-1.8136, dtype=torch.float64)
19 gae_duplicate tensor(-1.8136, dtype=torch.float64) tensor(0.5839, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.4654, dtype=torch.float64)
18 gae_duplicate tensor(-0.9855, dtype=torch.float64) tensor(0.3173, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(-0.0070, dtype=torch.float64)
17 gae_duplicate tensor(-0.7954, dtype=torch.float64) tensor(0.2562, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.8423, dtype=torch.float64)
16 gae_duplicate tensor(0.2060, dtype=torch.float64) tensor(-0.9636, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(3.1701, dtype=torch.float64)
15 gae_duplicate tensor(3.3349, dtype=torch.float64) tensor(-1.0808, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(1.1839, dtype=torch.float64)
14 gae_duplicate tensor(3.8518, dtype=torch.float64) tensor(-1.2496, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6368, dtype=torch.float64) delta_t tensor(2.1683, dtype=torch.float64)
13 gae_duplicate tensor(5.2497, dtype=torch.float64) tensor(-1.7012, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5712, dtype=torch.float64) delta_t tensor(1.6277, dtype=torch.float64)
12 gae_duplicate tensor(5.8275, dtype=torch.float64) tensor(-13.3605, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3741, dtype=torch.float64) delta_t tensor(-0.2805, dtype=torch.float64)
11 gae_duplicate tensor(4.3814, dtype=torch.float64) tensor(-1.4566, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3085, dtype=torch.float64) delta_t tensor(-2.4853, dtype=torch.float64)
10 gae_duplicate tensor(1.0198, dtype=torch.float64) tensor(-0.3306, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2428, dtype=torch.float64) delta_t tensor(0.0570, dtype=torch.float64)
9 gae_duplicate tensor(0.8729, dtype=torch.float64) tensor(-0.2831, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8739, dtype=torch.float64) delta_t tensor(-0.7850, dtype=torch.float64)
8 gae_duplicate tensor(-0.0867, dtype=torch.float64) tensor(0.2325, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2427, dtype=torch.float64) delta_t tensor(0.3166, dtype=torch.float64)
7 gae_duplicate tensor(0.2473, dtype=torch.float64) tensor(-0.6351, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2680, dtype=torch.float64) delta_t tensor(-0.6690, dtype=torch.float64)
6 gae_duplicate tensor(-0.4712, dtype=torch.float64) tensor(0.1860, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3487, dtype=torch.float64) delta_t tensor(2.5578, dtype=torch.float64)
5 gae_duplicate tensor(2.1809, dtype=torch.float64) tensor(-0.8366, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.1582, dtype=torch.float64) delta_t tensor(-3.4335, dtype=torch.float64)
4 gae_duplicate tensor(-1.6888, dtype=torch.float64) tensor(0.6313, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1105, dtype=torch.float64) delta_t tensor(1.0534, dtype=torch.float64)
3 gae_duplicate tensor(-0.2976, dtype=torch.float64) tensor(0.1057, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1105, dtype=torch.float64) delta_t tensor(0.6209, dtype=torch.float64)
2 gae_duplicate tensor(0.3828, dtype=torch.float64) tensor(-0.1265, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:117.70884704589844
value loss:182.31761169433594
entropies:18.5865535736084
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(342.2593)
ToM Target loss= tensor(311.0437)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.2788660526275635 seconds
19 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(-1.9343, dtype=torch.float64)
19 gae_duplicate tensor(-1.9343, dtype=torch.float64) tensor(0.6227, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(0.3320, dtype=torch.float64)
18 gae_duplicate tensor(-1.2154, dtype=torch.float64) tensor(0.3913, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.3322, dtype=torch.float64)
17 gae_duplicate tensor(-0.6401, dtype=torch.float64) tensor(0.2061, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.3323, dtype=torch.float64)
16 gae_duplicate tensor(-0.1798, dtype=torch.float64) tensor(0.0579, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.3324, dtype=torch.float64)
15 gae_duplicate tensor(0.1886, dtype=torch.float64) tensor(-0.0607, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.3326, dtype=torch.float64)
14 gae_duplicate tensor(0.4834, dtype=torch.float64) tensor(-0.1556, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.3327, dtype=torch.float64)
13 gae_duplicate tensor(0.7194, dtype=torch.float64) tensor(-0.2316, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.3328, dtype=torch.float64)
12 gae_duplicate tensor(0.9084, dtype=torch.float64) tensor(-0.2924, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.3645, dtype=torch.float64)
11 gae_duplicate tensor(1.0912, dtype=torch.float64) tensor(-0.3513, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.4117, dtype=torch.float64)
10 gae_duplicate tensor(1.2847, dtype=torch.float64) tensor(-0.4136, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3085, dtype=torch.float64) delta_t tensor(-0.0080, dtype=torch.float64)
9 gae_duplicate tensor(1.0198, dtype=torch.float64) tensor(-2.5489, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1514, dtype=torch.float64) delta_t tensor(-0.3570, dtype=torch.float64)
8 gae_duplicate tensor(0.4588, dtype=torch.float64) tensor(-0.1478, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6769, dtype=torch.float64) delta_t tensor(-1.3613, dtype=torch.float64)
7 gae_duplicate tensor(-0.9943, dtype=torch.float64) tensor(0.3201, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3339, dtype=torch.float64) delta_t tensor(0.7908, dtype=torch.float64)
6 gae_duplicate tensor(-0.0046, dtype=torch.float64) tensor(0.0015, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.5167, dtype=torch.float64) delta_t tensor(-1.7631, dtype=torch.float64)
5 gae_duplicate tensor(-1.7668, dtype=torch.float64) tensor(1.6231, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7022, dtype=torch.float64) delta_t tensor(2.8513, dtype=torch.float64)
4 gae_duplicate tensor(1.4379, dtype=torch.float64) tensor(-6.7575, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7294, dtype=torch.float64) delta_t tensor(-0.7071, dtype=torch.float64)
3 gae_duplicate tensor(0.4432, dtype=torch.float64) tensor(-0.1619, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4153, dtype=torch.float64) delta_t tensor(-0.6640, dtype=torch.float64)
2 gae_duplicate tensor(-0.3094, dtype=torch.float64) tensor(0.1210, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:46.108673095703125
value loss:26.751216888427734
entropies:18.564287185668945
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.554781913757324 seconds
19 rew tensor(0.8334, dtype=torch.float64) delta_t tensor(-1.5622, dtype=torch.float64)
19 gae_duplicate tensor(-1.5622, dtype=torch.float64) tensor(3.8927, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7020, dtype=torch.float64) delta_t tensor(0.2615, dtype=torch.float64)
18 gae_duplicate tensor(-0.9882, dtype=torch.float64) tensor(0.3218, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5048, dtype=torch.float64) delta_t tensor(0.3264, dtype=torch.float64)
17 gae_duplicate tensor(-0.4642, dtype=torch.float64) tensor(1.1565, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1761, dtype=torch.float64) delta_t tensor(0.2397, dtype=torch.float64)
16 gae_duplicate tensor(-0.1316, dtype=torch.float64) tensor(0.0429, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.5472, dtype=torch.float64) delta_t tensor(1.7587, dtype=torch.float64)
15 gae_duplicate tensor(1.6534, dtype=torch.float64) tensor(-4.1217, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(1.1064, dtype=torch.float64)
14 gae_duplicate tensor(2.4291, dtype=torch.float64) tensor(-0.7930, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(1.1065, dtype=torch.float64)
13 gae_duplicate tensor(3.0498, dtype=torch.float64) tensor(-0.9957, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4154, dtype=torch.float64) delta_t tensor(-1.9839, dtype=torch.float64)
12 gae_duplicate tensor(0.4560, dtype=torch.float64) tensor(-0.1489, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7021, dtype=torch.float64) delta_t tensor(0.5936, dtype=torch.float64)
11 gae_duplicate tensor(0.9584, dtype=torch.float64) tensor(-2.3896, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6365, dtype=torch.float64) delta_t tensor(-0.6354, dtype=torch.float64)
10 gae_duplicate tensor(0.1313, dtype=torch.float64) tensor(-0.0433, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2421, dtype=torch.float64) delta_t tensor(-0.3561, dtype=torch.float64)
9 gae_duplicate tensor(-0.2510, dtype=torch.float64) tensor(1.1693, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3494, dtype=torch.float64) delta_t tensor(-0.3637, dtype=torch.float64)
8 gae_duplicate tensor(-0.5645, dtype=torch.float64) tensor(0.1838, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5050, dtype=torch.float64) delta_t tensor(0.5516, dtype=torch.float64)
7 gae_duplicate tensor(0.1000, dtype=torch.float64) tensor(-0.0326, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9408, dtype=torch.float64) delta_t tensor(0.3770, dtype=torch.float64)
6 gae_duplicate tensor(0.4570, dtype=torch.float64) tensor(-0.1523, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4809, dtype=torch.float64) delta_t tensor(1.2209, dtype=torch.float64)
5 gae_duplicate tensor(1.5865, dtype=torch.float64) tensor(-0.6121, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8610, dtype=torch.float64) delta_t tensor(-1.5107, dtype=torch.float64)
4 gae_duplicate tensor(-0.2415, dtype=torch.float64) tensor(0.2722, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8100, dtype=torch.float64) delta_t tensor(0.8779, dtype=torch.float64)
3 gae_duplicate tensor(0.6847, dtype=torch.float64) tensor(-1.7668, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2843, dtype=torch.float64) delta_t tensor(-0.3751, dtype=torch.float64)
2 gae_duplicate tensor(0.1727, dtype=torch.float64) tensor(-0.0597, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:23.90216827392578
value loss:39.6054573059082
entropies:18.546457290649414
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.209596157073975 seconds
19 rew tensor(0.7026, dtype=torch.float64) delta_t tensor(-1.4837, dtype=torch.float64)
19 gae_duplicate tensor(-1.4837, dtype=torch.float64) tensor(3.7014, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5711, dtype=torch.float64) delta_t tensor(-0.2377, dtype=torch.float64)
18 gae_duplicate tensor(-1.4246, dtype=torch.float64) tensor(6.6424, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5054, dtype=torch.float64) delta_t tensor(-0.1799, dtype=torch.float64)
17 gae_duplicate tensor(-1.3196, dtype=torch.float64) tensor(0.4287, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0449, dtype=torch.float64) delta_t tensor(0.0077, dtype=torch.float64)
16 gae_duplicate tensor(-1.0480, dtype=torch.float64) tensor(0.3405, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.6787, dtype=torch.float64) delta_t tensor(1.8470, dtype=torch.float64)
15 gae_duplicate tensor(1.0086, dtype=torch.float64) tensor(-2.5062, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(1.0495, dtype=torch.float64)
14 gae_duplicate tensor(1.8564, dtype=torch.float64) tensor(-0.6046, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(-1.0338, dtype=torch.float64)
13 gae_duplicate tensor(0.4513, dtype=torch.float64) tensor(-0.1468, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4811, dtype=torch.float64) delta_t tensor(-0.7019, dtype=torch.float64)
12 gae_duplicate tensor(-0.3409, dtype=torch.float64) tensor(0.8498, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7686, dtype=torch.float64) delta_t tensor(0.6328, dtype=torch.float64)
11 gae_duplicate tensor(0.3601, dtype=torch.float64) tensor(-0.1172, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5056, dtype=torch.float64) delta_t tensor(-0.8041, dtype=torch.float64)
10 gae_duplicate tensor(-0.5160, dtype=torch.float64) tensor(0.1678, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3741, dtype=torch.float64) delta_t tensor(-0.3017, dtype=torch.float64)
9 gae_duplicate tensor(-0.7145, dtype=torch.float64) tensor(0.2322, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7439, dtype=torch.float64) delta_t tensor(-1.1106, dtype=torch.float64)
8 gae_duplicate tensor(-1.6822, dtype=torch.float64) tensor(0.5469, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3740, dtype=torch.float64) delta_t tensor(0.4649, dtype=torch.float64)
7 gae_duplicate tensor(-0.8808, dtype=torch.float64) tensor(0.2864, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3357, dtype=torch.float64) delta_t tensor(0.2985, dtype=torch.float64)
6 gae_duplicate tensor(-0.4062, dtype=torch.float64) tensor(0.1411, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4811, dtype=torch.float64) delta_t tensor(-0.2620, dtype=torch.float64)
5 gae_duplicate tensor(-0.5870, dtype=torch.float64) tensor(0.1916, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3224, dtype=torch.float64) delta_t tensor(-1.8199, dtype=torch.float64)
4 gae_duplicate tensor(-2.2894, dtype=torch.float64) tensor(0.8739, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4159, dtype=torch.float64) delta_t tensor(1.1336, dtype=torch.float64)
3 gae_duplicate tensor(-0.6979, dtype=torch.float64) tensor(1.7388, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4160, dtype=torch.float64) delta_t tensor(-2.3086, dtype=torch.float64)
2 gae_duplicate tensor(-2.8670, dtype=torch.float64) tensor(7.0944, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-119.70748901367188
value loss:46.23509216308594
entropies:18.028247833251953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.565278053283691 seconds
19 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(-1.7343, dtype=torch.float64)
19 gae_duplicate tensor(-1.7343, dtype=torch.float64) tensor(0.5589, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.3763, dtype=torch.float64)
18 gae_duplicate tensor(-1.0111, dtype=torch.float64) tensor(2.5315, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.9232, dtype=torch.float64)
17 gae_duplicate tensor(0.1143, dtype=torch.float64) tensor(-0.2862, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.6014, dtype=torch.float64)
16 gae_duplicate tensor(0.6929, dtype=torch.float64) tensor(-0.2233, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(-0.1132, dtype=torch.float64)
15 gae_duplicate tensor(0.4411, dtype=torch.float64) tensor(-0.1423, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(2.3849, dtype=torch.float64)
14 gae_duplicate tensor(2.7378, dtype=torch.float64) tensor(-0.8799, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(0.4828, dtype=torch.float64)
13 gae_duplicate tensor(2.6731, dtype=torch.float64) tensor(-6.6862, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.8693, dtype=torch.float64)
12 gae_duplicate tensor(3.0078, dtype=torch.float64) tensor(-0.9724, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.2047, dtype=torch.float64) delta_t tensor(-2.5214, dtype=torch.float64)
11 gae_duplicate tensor(-0.1152, dtype=torch.float64) tensor(0.0372, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0203, dtype=torch.float64) delta_t tensor(-1.0249, dtype=torch.float64)
10 gae_duplicate tensor(-1.1170, dtype=torch.float64) tensor(0.3591, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3493, dtype=torch.float64) delta_t tensor(0.1494, dtype=torch.float64)
9 gae_duplicate tensor(-0.7442, dtype=torch.float64) tensor(0.2398, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0455, dtype=torch.float64) delta_t tensor(-0.1308, dtype=torch.float64)
8 gae_duplicate tensor(-0.7261, dtype=torch.float64) tensor(1.3969, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0861, dtype=torch.float64) delta_t tensor(-0.5676, dtype=torch.float64)
7 gae_duplicate tensor(-1.1485, dtype=torch.float64) tensor(2.8773, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4678, dtype=torch.float64) delta_t tensor(0.4094, dtype=torch.float64)
6 gae_duplicate tensor(-0.5094, dtype=torch.float64) tensor(0.1857, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3084, dtype=torch.float64) delta_t tensor(1.7089, dtype=torch.float64)
5 gae_duplicate tensor(1.3014, dtype=torch.float64) tensor(-2.4037, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1260, dtype=torch.float64) delta_t tensor(-1.6396, dtype=torch.float64)
4 gae_duplicate tensor(-0.5984, dtype=torch.float64) tensor(0.6864, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2055, dtype=torch.float64) delta_t tensor(0.3268, dtype=torch.float64)
3 gae_duplicate tensor(-0.1519, dtype=torch.float64) tensor(0.3912, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1527, dtype=torch.float64) delta_t tensor(-0.3345, dtype=torch.float64)
2 gae_duplicate tensor(-0.4561, dtype=torch.float64) tensor(0.1529, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:12.503828048706055
value loss:51.91400146484375
entropies:18.639204025268555
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.454338073730469 seconds
19 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(-0.9588, dtype=torch.float64)
19 gae_duplicate tensor(-0.9588, dtype=torch.float64) tensor(0.3050, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.5288, dtype=torch.float64)
18 gae_duplicate tensor(-0.2383, dtype=torch.float64) tensor(0.5976, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(0.5289, dtype=torch.float64)
17 gae_duplicate tensor(0.3383, dtype=torch.float64) tensor(-0.1076, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.6006, dtype=torch.float64)
16 gae_duplicate tensor(0.8713, dtype=torch.float64) tensor(-0.2771, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(2.9232, dtype=torch.float64)
15 gae_duplicate tensor(3.6202, dtype=torch.float64) tensor(-1.6392, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1108, dtype=torch.float64) delta_t tensor(0.3659, dtype=torch.float64)
14 gae_duplicate tensor(3.2621, dtype=torch.float64) tensor(-8.2167, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0209, dtype=torch.float64) delta_t tensor(-1.3374, dtype=torch.float64)
13 gae_duplicate tensor(1.2723, dtype=torch.float64) tensor(-0.4016, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2184, dtype=torch.float64) delta_t tensor(-1.5634, dtype=torch.float64)
12 gae_duplicate tensor(-0.5455, dtype=torch.float64) tensor(0.1728, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2843, dtype=torch.float64) delta_t tensor(-0.8462, dtype=torch.float64)
11 gae_duplicate tensor(-1.2826, dtype=torch.float64) tensor(0.4072, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6375, dtype=torch.float64) delta_t tensor(0.3338, dtype=torch.float64)
10 gae_duplicate tensor(-0.6923, dtype=torch.float64) tensor(0.2179, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1767, dtype=torch.float64) delta_t tensor(-0.2061, dtype=torch.float64)
9 gae_duplicate tensor(-0.7599, dtype=torch.float64) tensor(1.9123, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1109, dtype=torch.float64) delta_t tensor(-0.3981, dtype=torch.float64)
8 gae_duplicate tensor(-1.0061, dtype=torch.float64) tensor(0.3163, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0082, dtype=torch.float64) delta_t tensor(-0.6145, dtype=torch.float64)
7 gae_duplicate tensor(-1.4194, dtype=torch.float64) tensor(3.3686, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7032, dtype=torch.float64) delta_t tensor(1.3188, dtype=torch.float64)
6 gae_duplicate tensor(0.1833, dtype=torch.float64) tensor(-0.0583, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7324, dtype=torch.float64) delta_t tensor(0.1517, dtype=torch.float64)
5 gae_duplicate tensor(0.2984, dtype=torch.float64) tensor(-0.1648, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7031, dtype=torch.float64) delta_t tensor(1.1170, dtype=torch.float64)
4 gae_duplicate tensor(1.3557, dtype=torch.float64) tensor(-2.1552, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0744, dtype=torch.float64) delta_t tensor(0.6832, dtype=torch.float64)
3 gae_duplicate tensor(1.7677, dtype=torch.float64) tensor(-0.7090, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1529, dtype=torch.float64) delta_t tensor(-0.4658, dtype=torch.float64)
2 gae_duplicate tensor(0.9484, dtype=torch.float64) tensor(-0.3140, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:39.91957473754883
value loss:58.840179443359375
entropies:18.491737365722656
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(329.7888)
ToM Target loss= tensor(312.0585)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.081279993057251 seconds
19 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(-1.1252, dtype=torch.float64)
19 gae_duplicate tensor(-1.1252, dtype=torch.float64) tensor(0.3492, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.4955, dtype=torch.float64)
18 gae_duplicate tensor(-0.4047, dtype=torch.float64) tensor(0.1256, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(0.4957, dtype=torch.float64)
17 gae_duplicate tensor(0.1719, dtype=torch.float64) tensor(-0.0534, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.4958, dtype=torch.float64)
16 gae_duplicate tensor(0.6333, dtype=torch.float64) tensor(-0.1965, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.4959, dtype=torch.float64)
15 gae_duplicate tensor(1.0026, dtype=torch.float64) tensor(-2.5274, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.7221, dtype=torch.float64)
14 gae_duplicate tensor(1.5242, dtype=torch.float64) tensor(-0.9060, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(0.3492, dtype=torch.float64)
13 gae_duplicate tensor(1.5685, dtype=torch.float64) tensor(-4.1618, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-1.0757, dtype=torch.float64) delta_t tensor(-1.4741, dtype=torch.float64)
12 gae_duplicate tensor(-0.2192, dtype=torch.float64) tensor(0.0937, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1104, dtype=torch.float64) delta_t tensor(-0.1866, dtype=torch.float64)
11 gae_duplicate tensor(-0.3620, dtype=torch.float64) tensor(0.1631, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4400, dtype=torch.float64) delta_t tensor(-0.0101, dtype=torch.float64)
10 gae_duplicate tensor(-0.2998, dtype=torch.float64) tensor(0.1271, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0213, dtype=torch.float64) delta_t tensor(0.5637, dtype=torch.float64)
9 gae_duplicate tensor(0.3239, dtype=torch.float64) tensor(-0.1979, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5058, dtype=torch.float64) delta_t tensor(0.1028, dtype=torch.float64)
8 gae_duplicate tensor(0.3619, dtype=torch.float64) tensor(-0.1845, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0095, dtype=torch.float64) delta_t tensor(-0.1940, dtype=torch.float64)
7 gae_duplicate tensor(0.0956, dtype=torch.float64) tensor(-0.0634, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6375, dtype=torch.float64) delta_t tensor(1.2264, dtype=torch.float64)
6 gae_duplicate tensor(1.3029, dtype=torch.float64) tensor(-0.7287, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3389, dtype=torch.float64) delta_t tensor(0.5501, dtype=torch.float64)
5 gae_duplicate tensor(1.5924, dtype=torch.float64) tensor(-1.0360, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7692, dtype=torch.float64) delta_t tensor(0.0848, dtype=torch.float64)
4 gae_duplicate tensor(1.3587, dtype=torch.float64) tensor(-3.7497, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8120, dtype=torch.float64) delta_t tensor(1.3277, dtype=torch.float64)
3 gae_duplicate tensor(2.4146, dtype=torch.float64) tensor(-6.3785, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2850, dtype=torch.float64) delta_t tensor(-0.7647, dtype=torch.float64)
2 gae_duplicate tensor(1.1670, dtype=torch.float64) tensor(-0.3855, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:117.6524887084961
value loss:32.15147399902344
entropies:20.368022918701172
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.342458009719849 seconds
19 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(-0.2589, dtype=torch.float64)
19 gae_duplicate tensor(-0.2589, dtype=torch.float64) tensor(0.0789, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.6691, dtype=torch.float64)
18 gae_duplicate tensor(0.4620, dtype=torch.float64) tensor(-0.1408, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.7986, dtype=torch.float64)
17 gae_duplicate tensor(1.1682, dtype=torch.float64) tensor(-0.3563, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(-0.7130, dtype=torch.float64)
16 gae_duplicate tensor(0.2216, dtype=torch.float64) tensor(-0.0674, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.5041, dtype=torch.float64)
15 gae_duplicate tensor(0.6813, dtype=torch.float64) tensor(-1.7315, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4400, dtype=torch.float64) delta_t tensor(0.0607, dtype=torch.float64)
14 gae_duplicate tensor(0.6057, dtype=torch.float64) tensor(-0.1844, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3082, dtype=torch.float64) delta_t tensor(-0.4322, dtype=torch.float64)
13 gae_duplicate tensor(0.0524, dtype=torch.float64) tensor(-0.0160, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2423, dtype=torch.float64) delta_t tensor(-0.7417, dtype=torch.float64)
12 gae_duplicate tensor(-0.6998, dtype=torch.float64) tensor(0.2136, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1533, dtype=torch.float64) delta_t tensor(-0.6291, dtype=torch.float64)
11 gae_duplicate tensor(-1.1889, dtype=torch.float64) tensor(0.3628, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2193, dtype=torch.float64) delta_t tensor(-0.3470, dtype=torch.float64)
10 gae_duplicate tensor(-1.2981, dtype=torch.float64) tensor(3.3019, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7466, dtype=torch.float64) delta_t tensor(-0.2089, dtype=torch.float64)
9 gae_duplicate tensor(-1.2474, dtype=torch.float64) tensor(0.3799, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1761, dtype=torch.float64) delta_t tensor(-0.9097, dtype=torch.float64)
8 gae_duplicate tensor(-1.9075, dtype=torch.float64) tensor(4.8510, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4171, dtype=torch.float64) delta_t tensor(-0.1048, dtype=torch.float64)
7 gae_duplicate tensor(-1.6308, dtype=torch.float64) tensor(4.1728, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4397, dtype=torch.float64) delta_t tensor(0.9093, dtype=torch.float64)
6 gae_duplicate tensor(-0.3954, dtype=torch.float64) tensor(0.1212, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9328, dtype=torch.float64) delta_t tensor(-0.0472, dtype=torch.float64)
5 gae_duplicate tensor(-0.3635, dtype=torch.float64) tensor(0.9331, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5054, dtype=torch.float64) delta_t tensor(0.6383, dtype=torch.float64)
4 gae_duplicate tensor(0.3475, dtype=torch.float64) tensor(-0.1061, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8016, dtype=torch.float64) delta_t tensor(-1.9072, dtype=torch.float64)
3 gae_duplicate tensor(-1.6292, dtype=torch.float64) tensor(4.1428, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1540, dtype=torch.float64) delta_t tensor(-0.9261, dtype=torch.float64)
2 gae_duplicate tensor(-2.2295, dtype=torch.float64) tensor(0.6841, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-100.35420227050781
value loss:33.00737762451172
entropies:17.23870086669922
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.324932813644409 seconds
19 rew tensor(0.4395, dtype=torch.float64) delta_t tensor(-2.2913, dtype=torch.float64)
19 gae_duplicate tensor(-2.2913, dtype=torch.float64) tensor(0.6804, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.0883, dtype=torch.float64) delta_t tensor(-0.8356, dtype=torch.float64)
18 gae_duplicate tensor(-2.6686, dtype=torch.float64) tensor(0.7924, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.9460, dtype=torch.float64) delta_t tensor(0.8398, dtype=torch.float64)
17 gae_duplicate tensor(-1.2951, dtype=torch.float64) tensor(0.3864, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.7892, dtype=torch.float64)
16 gae_duplicate tensor(-0.2469, dtype=torch.float64) tensor(0.0737, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(0.7893, dtype=torch.float64)
15 gae_duplicate tensor(0.5918, dtype=torch.float64) tensor(-1.5065, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8354, dtype=torch.float64) delta_t tensor(0.8109, dtype=torch.float64)
14 gae_duplicate tensor(1.2843, dtype=torch.float64) tensor(-0.3830, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7696, dtype=torch.float64) delta_t tensor(0.8566, dtype=torch.float64)
13 gae_duplicate tensor(1.8840, dtype=torch.float64) tensor(-0.5612, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7037, dtype=torch.float64) delta_t tensor(-1.7197, dtype=torch.float64)
12 gae_duplicate tensor(-0.2125, dtype=torch.float64) tensor(0.0631, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1761, dtype=torch.float64) delta_t tensor(-0.3421, dtype=torch.float64)
11 gae_duplicate tensor(-0.5121, dtype=torch.float64) tensor(1.3105, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1101, dtype=torch.float64) delta_t tensor(-0.3934, dtype=torch.float64)
10 gae_duplicate tensor(-0.8031, dtype=torch.float64) tensor(0.2385, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5059, dtype=torch.float64) delta_t tensor(-0.2954, dtype=torch.float64)
9 gae_duplicate tensor(-0.9379, dtype=torch.float64) tensor(0.2787, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0443, dtype=torch.float64) delta_t tensor(0.7864, dtype=torch.float64)
8 gae_duplicate tensor(0.0361, dtype=torch.float64) tensor(-0.0925, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2421, dtype=torch.float64) delta_t tensor(-0.3390, dtype=torch.float64)
7 gae_duplicate tensor(-0.3100, dtype=torch.float64) tensor(0.0935, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4723, dtype=torch.float64) delta_t tensor(0.2661, dtype=torch.float64)
6 gae_duplicate tensor(0.0181, dtype=torch.float64) tensor(-0.0466, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9343, dtype=torch.float64) delta_t tensor(-0.8074, dtype=torch.float64)
5 gae_duplicate tensor(-0.7930, dtype=torch.float64) tensor(2.0394, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2416, dtype=torch.float64) delta_t tensor(0.4760, dtype=torch.float64)
4 gae_duplicate tensor(-0.1584, dtype=torch.float64) tensor(0.0471, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7370, dtype=torch.float64) delta_t tensor(-0.1461, dtype=torch.float64)
3 gae_duplicate tensor(-0.2729, dtype=torch.float64) tensor(0.6853, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1754, dtype=torch.float64) delta_t tensor(-1.7367, dtype=torch.float64)
2 gae_duplicate tensor(-1.9550, dtype=torch.float64) tensor(5.0005, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-55.106300354003906
value loss:39.20839309692383
entropies:16.966081619262695
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.142117977142334 seconds
19 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(-1.1998, dtype=torch.float64)
19 gae_duplicate tensor(-1.1998, dtype=torch.float64) tensor(0.3485, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.4813, dtype=torch.float64)
18 gae_duplicate tensor(-0.4786, dtype=torch.float64) tensor(0.1390, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(0.4814, dtype=torch.float64)
17 gae_duplicate tensor(0.0985, dtype=torch.float64) tensor(-0.0286, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(0.4815, dtype=torch.float64)
16 gae_duplicate tensor(0.5604, dtype=torch.float64) tensor(-0.1628, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(0.4817, dtype=torch.float64)
15 gae_duplicate tensor(0.9300, dtype=torch.float64) tensor(-0.2701, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(0.2766, dtype=torch.float64)
14 gae_duplicate tensor(1.0206, dtype=torch.float64) tensor(-2.6336, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8362, dtype=torch.float64) delta_t tensor(-0.4090, dtype=torch.float64)
13 gae_duplicate tensor(0.4074, dtype=torch.float64) tensor(-1.0503, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4180, dtype=torch.float64) delta_t tensor(-1.0361, dtype=torch.float64)
12 gae_duplicate tensor(-0.7102, dtype=torch.float64) tensor(0.2055, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7701, dtype=torch.float64) delta_t tensor(-0.1841, dtype=torch.float64)
11 gae_duplicate tensor(-0.7522, dtype=torch.float64) tensor(0.2177, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5722, dtype=torch.float64) delta_t tensor(-0.1572, dtype=torch.float64)
10 gae_duplicate tensor(-0.7590, dtype=torch.float64) tensor(0.2196, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1762, dtype=torch.float64) delta_t tensor(0.0953, dtype=torch.float64)
9 gae_duplicate tensor(-0.5119, dtype=torch.float64) tensor(0.1481, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4838, dtype=torch.float64) delta_t tensor(-0.4221, dtype=torch.float64)
8 gae_duplicate tensor(-0.8316, dtype=torch.float64) tensor(0.2417, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8798, dtype=torch.float64) delta_t tensor(0.1807, dtype=torch.float64)
7 gae_duplicate tensor(-0.4846, dtype=torch.float64) tensor(0.1838, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6380, dtype=torch.float64) delta_t tensor(0.5596, dtype=torch.float64)
6 gae_duplicate tensor(0.1719, dtype=torch.float64) tensor(-0.4434, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3417, dtype=torch.float64) delta_t tensor(0.3224, dtype=torch.float64)
5 gae_duplicate tensor(0.4599, dtype=torch.float64) tensor(-0.1340, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1099, dtype=torch.float64) delta_t tensor(1.5472, dtype=torch.float64)
4 gae_duplicate tensor(1.9151, dtype=torch.float64) tensor(-0.7657, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4739, dtype=torch.float64) delta_t tensor(-0.3248, dtype=torch.float64)
3 gae_duplicate tensor(1.2073, dtype=torch.float64) tensor(-5.5093, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1543, dtype=torch.float64) delta_t tensor(-0.9059, dtype=torch.float64)
2 gae_duplicate tensor(0.0600, dtype=torch.float64) tensor(-0.0193, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:55.36777877807617
value loss:18.404150009155273
entropies:17.0584774017334
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.590691804885864 seconds
19 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(-1.1552, dtype=torch.float64)
19 gae_duplicate tensor(-1.1552, dtype=torch.float64) tensor(2.9925, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(0.2801, dtype=torch.float64)
18 gae_duplicate tensor(-0.6441, dtype=torch.float64) tensor(0.1847, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.9385, dtype=torch.float64)
17 gae_duplicate tensor(0.4232, dtype=torch.float64) tensor(-1.0963, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.3226, dtype=torch.float64)
16 gae_duplicate tensor(0.6611, dtype=torch.float64) tensor(-1.7040, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(-0.0830, dtype=torch.float64)
15 gae_duplicate tensor(0.4459, dtype=torch.float64) tensor(-0.1281, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(0.3849, dtype=torch.float64)
14 gae_duplicate tensor(0.7416, dtype=torch.float64) tensor(-0.2130, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.3850, dtype=torch.float64)
13 gae_duplicate tensor(0.9784, dtype=torch.float64) tensor(-0.2810, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(0.3852, dtype=torch.float64)
12 gae_duplicate tensor(1.1679, dtype=torch.float64) tensor(-3.0205, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(0.4286, dtype=torch.float64)
11 gae_duplicate tensor(1.3629, dtype=torch.float64) tensor(-0.3919, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(0.9309, dtype=torch.float64)
10 gae_duplicate tensor(2.0212, dtype=torch.float64) tensor(-0.5781, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1102, dtype=torch.float64) delta_t tensor(-1.3193, dtype=torch.float64)
9 gae_duplicate tensor(0.2976, dtype=torch.float64) tensor(-0.7716, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4839, dtype=torch.float64) delta_t tensor(-0.1481, dtype=torch.float64)
8 gae_duplicate tensor(0.0900, dtype=torch.float64) tensor(-0.0261, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8140, dtype=torch.float64) delta_t tensor(-0.9535, dtype=torch.float64)
7 gae_duplicate tensor(-0.8815, dtype=torch.float64) tensor(2.2826, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6161, dtype=torch.float64) delta_t tensor(-0.4267, dtype=torch.float64)
6 gae_duplicate tensor(-1.1319, dtype=torch.float64) tensor(0.3241, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.2003, dtype=torch.float64) delta_t tensor(0.3396, dtype=torch.float64)
5 gae_duplicate tensor(-0.5659, dtype=torch.float64) tensor(1.5899, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7038, dtype=torch.float64) delta_t tensor(1.6782, dtype=torch.float64)
4 gae_duplicate tensor(1.2255, dtype=torch.float64) tensor(-2.0374, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5409, dtype=torch.float64) delta_t tensor(-0.2311, dtype=torch.float64)
3 gae_duplicate tensor(0.7493, dtype=torch.float64) tensor(-0.2569, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6829, dtype=torch.float64) delta_t tensor(-1.0479, dtype=torch.float64)
2 gae_duplicate tensor(-0.4485, dtype=torch.float64) tensor(0.1727, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:17.231420516967773
value loss:24.176668167114258
entropies:17.259559631347656
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(335.1239)
ToM Target loss= tensor(312.4560)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.6327598094940186 seconds
19 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(-1.5685, dtype=torch.float64)
19 gae_duplicate tensor(-1.5685, dtype=torch.float64) tensor(0.4404, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.4662, dtype=torch.float64)
18 gae_duplicate tensor(-0.7886, dtype=torch.float64) tensor(0.2214, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.4540, dtype=torch.float64)
17 gae_duplicate tensor(-0.1768, dtype=torch.float64) tensor(0.4601, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(0.8372, dtype=torch.float64)
16 gae_duplicate tensor(0.6958, dtype=torch.float64) tensor(-1.8106, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(2.4024, dtype=torch.float64)
15 gae_duplicate tensor(2.9590, dtype=torch.float64) tensor(-0.8353, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(1.1098, dtype=torch.float64)
14 gae_duplicate tensor(3.4769, dtype=torch.float64) tensor(-0.9812, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5060, dtype=torch.float64) delta_t tensor(1.1330, dtype=torch.float64)
13 gae_duplicate tensor(3.9146, dtype=torch.float64) tensor(-1.1027, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4400, dtype=torch.float64) delta_t tensor(-0.1565, dtype=torch.float64)
12 gae_duplicate tensor(2.9752, dtype=torch.float64) tensor(-0.8431, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2203, dtype=torch.float64) delta_t tensor(-0.1976, dtype=torch.float64)
11 gae_duplicate tensor(2.1826, dtype=torch.float64) tensor(-5.6841, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.1446, dtype=torch.float64) delta_t tensor(-3.5386, dtype=torch.float64)
10 gae_duplicate tensor(-1.7926, dtype=torch.float64) tensor(0.5052, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0128, dtype=torch.float64) delta_t tensor(-1.4752, dtype=torch.float64)
9 gae_duplicate tensor(-2.9093, dtype=torch.float64) tensor(0.8173, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3076, dtype=torch.float64) delta_t tensor(1.1803, dtype=torch.float64)
8 gae_duplicate tensor(-1.1471, dtype=torch.float64) tensor(0.3423, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4846, dtype=torch.float64) delta_t tensor(0.1741, dtype=torch.float64)
7 gae_duplicate tensor(-0.7436, dtype=torch.float64) tensor(0.9887, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7036, dtype=torch.float64) delta_t tensor(1.2464, dtype=torch.float64)
6 gae_duplicate tensor(0.6515, dtype=torch.float64) tensor(-0.3164, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0689, dtype=torch.float64) delta_t tensor(-0.1366, dtype=torch.float64)
5 gae_duplicate tensor(0.3846, dtype=torch.float64) tensor(-0.2272, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0228, dtype=torch.float64) delta_t tensor(0.0724, dtype=torch.float64)
4 gae_duplicate tensor(0.3800, dtype=torch.float64) tensor(-0.1547, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.2676, dtype=torch.float64) delta_t tensor(-0.4541, dtype=torch.float64)
3 gae_duplicate tensor(-0.1500, dtype=torch.float64) tensor(0.0633, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2874, dtype=torch.float64) delta_t tensor(-0.8061, dtype=torch.float64)
2 gae_duplicate tensor(-0.9261, dtype=torch.float64) tensor(2.4102, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:33.70722198486328
value loss:102.78590393066406
entropies:17.674110412597656
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.498700141906738 seconds
19 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(-1.1816, dtype=torch.float64)
19 gae_duplicate tensor(-1.1816, dtype=torch.float64) tensor(3.0772, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.4846, dtype=torch.float64)
18 gae_duplicate tensor(-0.4607, dtype=torch.float64) tensor(0.1273, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.4847, dtype=torch.float64)
17 gae_duplicate tensor(0.1162, dtype=torch.float64) tensor(-0.0321, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.4849, dtype=torch.float64)
16 gae_duplicate tensor(0.5778, dtype=torch.float64) tensor(-0.1596, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.4862, dtype=torch.float64)
15 gae_duplicate tensor(0.9484, dtype=torch.float64) tensor(-0.2621, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.4886, dtype=torch.float64)
14 gae_duplicate tensor(1.2473, dtype=torch.float64) tensor(-0.3446, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(0.0004, dtype=torch.float64)
13 gae_duplicate tensor(0.9982, dtype=torch.float64) tensor(-2.5997, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(0.2288, dtype=torch.float64)
12 gae_duplicate tensor(1.0274, dtype=torch.float64) tensor(-2.6758, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.3704, dtype=torch.float64)
11 gae_duplicate tensor(1.1924, dtype=torch.float64) tensor(-0.3283, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(-0.2180, dtype=torch.float64)
10 gae_duplicate tensor(0.7359, dtype=torch.float64) tensor(-1.9285, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(0.2679, dtype=torch.float64)
9 gae_duplicate tensor(0.8567, dtype=torch.float64) tensor(-0.2354, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.5410, dtype=torch.float64) delta_t tensor(-2.0684, dtype=torch.float64)
8 gae_duplicate tensor(-1.3831, dtype=torch.float64) tensor(0.3803, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4093, dtype=torch.float64) delta_t tensor(-0.1973, dtype=torch.float64)
7 gae_duplicate tensor(-1.3038, dtype=torch.float64) tensor(0.4142, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3436, dtype=torch.float64) delta_t tensor(-0.5496, dtype=torch.float64)
6 gae_duplicate tensor(-1.5926, dtype=torch.float64) tensor(7.9118, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4100, dtype=torch.float64) delta_t tensor(0.2023, dtype=torch.float64)
5 gae_duplicate tensor(-1.0718, dtype=torch.float64) tensor(3.0113, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7036, dtype=torch.float64) delta_t tensor(0.7995, dtype=torch.float64)
4 gae_duplicate tensor(-0.0579, dtype=torch.float64) tensor(0.0956, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7496, dtype=torch.float64) delta_t tensor(1.2086, dtype=torch.float64)
3 gae_duplicate tensor(1.1623, dtype=torch.float64) tensor(-0.4301, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2873, dtype=torch.float64) delta_t tensor(-0.2332, dtype=torch.float64)
2 gae_duplicate tensor(0.6966, dtype=torch.float64) tensor(-0.2076, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-35.39020919799805
value loss:27.446842193603516
entropies:16.862682342529297
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.538616180419922 seconds
19 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(-1.6717, dtype=torch.float64)
19 gae_duplicate tensor(-1.6717, dtype=torch.float64) tensor(0.4478, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(0.3366, dtype=torch.float64)
18 gae_duplicate tensor(-1.0008, dtype=torch.float64) tensor(0.2680, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.5977, dtype=torch.float64)
17 gae_duplicate tensor(-0.2029, dtype=torch.float64) tensor(0.0540, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(0.5432, dtype=torch.float64)
16 gae_duplicate tensor(0.3809, dtype=torch.float64) tensor(-1.0079, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(2.0657, dtype=torch.float64)
15 gae_duplicate tensor(2.3704, dtype=torch.float64) tensor(-0.6361, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1755, dtype=torch.float64) delta_t tensor(-1.0019, dtype=torch.float64)
14 gae_duplicate tensor(0.8944, dtype=torch.float64) tensor(-0.2383, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.2210, dtype=torch.float64) delta_t tensor(0.3616, dtype=torch.float64)
13 gae_duplicate tensor(1.0771, dtype=torch.float64) tensor(-2.8479, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5719, dtype=torch.float64) delta_t tensor(0.8232, dtype=torch.float64)
12 gae_duplicate tensor(1.6849, dtype=torch.float64) tensor(-0.4522, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8816, dtype=torch.float64) delta_t tensor(-1.4652, dtype=torch.float64)
11 gae_duplicate tensor(-0.1172, dtype=torch.float64) tensor(0.0315, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.8156, dtype=torch.float64) delta_t tensor(-2.3335, dtype=torch.float64)
10 gae_duplicate tensor(-2.4273, dtype=torch.float64) tensor(0.6486, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8818, dtype=torch.float64) delta_t tensor(-0.3907, dtype=torch.float64)
9 gae_duplicate tensor(-2.3326, dtype=torch.float64) tensor(0.6240, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6747, dtype=torch.float64) delta_t tensor(-2.2259, dtype=torch.float64)
8 gae_duplicate tensor(-4.0920, dtype=torch.float64) tensor(1.1803, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7034, dtype=torch.float64) delta_t tensor(1.9933, dtype=torch.float64)
7 gae_duplicate tensor(-1.2803, dtype=torch.float64) tensor(3.5001, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0143, dtype=torch.float64) delta_t tensor(-0.7460, dtype=torch.float64)
6 gae_duplicate tensor(-1.7702, dtype=torch.float64) tensor(2.5417, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4391, dtype=torch.float64) delta_t tensor(0.8238, dtype=torch.float64)
5 gae_duplicate tensor(-0.5923, dtype=torch.float64) tensor(0.2560, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6179, dtype=torch.float64) delta_t tensor(0.2130, dtype=torch.float64)
4 gae_duplicate tensor(-0.2609, dtype=torch.float64) tensor(0.1277, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3729, dtype=torch.float64) delta_t tensor(0.5136, dtype=torch.float64)
3 gae_duplicate tensor(0.3049, dtype=torch.float64) tensor(-0.1330, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6840, dtype=torch.float64) delta_t tensor(0.5852, dtype=torch.float64)
2 gae_duplicate tensor(0.8291, dtype=torch.float64) tensor(-0.2586, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-25.147375106811523
value loss:72.69562530517578
entropies:17.095232009887695
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.403562068939209 seconds
19 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(2.1025, dtype=torch.float64)
19 gae_duplicate tensor(2.1025, dtype=torch.float64) tensor(-5.5790, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8358, dtype=torch.float64) delta_t tensor(1.0624, dtype=torch.float64)
18 gae_duplicate tensor(2.7444, dtype=torch.float64) tensor(-7.2935, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(1.1394, dtype=torch.float64)
17 gae_duplicate tensor(3.3350, dtype=torch.float64) tensor(-8.8465, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(-2.4397, dtype=torch.float64)
16 gae_duplicate tensor(0.2282, dtype=torch.float64) tensor(-0.0598, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8362, dtype=torch.float64) delta_t tensor(0.3856, dtype=torch.float64)
15 gae_duplicate tensor(0.5681, dtype=torch.float64) tensor(-1.5093, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9024, dtype=torch.float64) delta_t tensor(0.4295, dtype=torch.float64)
14 gae_duplicate tensor(0.8840, dtype=torch.float64) tensor(-0.2315, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-1.7417, dtype=torch.float64) delta_t tensor(-2.1413, dtype=torch.float64)
13 gae_duplicate tensor(-1.4341, dtype=torch.float64) tensor(0.3755, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7040, dtype=torch.float64) delta_t tensor(0.3124, dtype=torch.float64)
12 gae_duplicate tensor(-0.8349, dtype=torch.float64) tensor(0.2187, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5719, dtype=torch.float64) delta_t tensor(0.1493, dtype=torch.float64)
11 gae_duplicate tensor(-0.5186, dtype=torch.float64) tensor(0.1358, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4397, dtype=torch.float64) delta_t tensor(0.0953, dtype=torch.float64)
10 gae_duplicate tensor(-0.3196, dtype=torch.float64) tensor(0.0837, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1753, dtype=torch.float64) delta_t tensor(-0.2764, dtype=torch.float64)
9 gae_duplicate tensor(-0.5321, dtype=torch.float64) tensor(0.1393, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3534, dtype=torch.float64) delta_t tensor(0.1804, dtype=torch.float64)
8 gae_duplicate tensor(-0.2453, dtype=torch.float64) tensor(0.0667, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7702, dtype=torch.float64) delta_t tensor(-0.2865, dtype=torch.float64)
7 gae_duplicate tensor(-0.4827, dtype=torch.float64) tensor(0.1264, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3448, dtype=torch.float64) delta_t tensor(-0.5439, dtype=torch.float64)
6 gae_duplicate tensor(-0.9301, dtype=torch.float64) tensor(2.4715, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4396, dtype=torch.float64) delta_t tensor(0.6035, dtype=torch.float64)
5 gae_duplicate tensor(-0.1406, dtype=torch.float64) tensor(0.0370, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8822, dtype=torch.float64) delta_t tensor(-0.1777, dtype=torch.float64)
4 gae_duplicate tensor(-0.2902, dtype=torch.float64) tensor(0.0763, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5056, dtype=torch.float64) delta_t tensor(2.9254, dtype=torch.float64)
3 gae_duplicate tensor(2.6933, dtype=torch.float64) tensor(-1.1033, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9483, dtype=torch.float64) delta_t tensor(-1.1717, dtype=torch.float64)
2 gae_duplicate tensor(0.9829, dtype=torch.float64) tensor(-2.2010, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:138.0825653076172
value loss:55.680877685546875
entropies:15.872358322143555
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.370776891708374 seconds
19 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(-1.2914, dtype=torch.float64)
19 gae_duplicate tensor(-1.2914, dtype=torch.float64) tensor(3.4154, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(0.4765, dtype=torch.float64)
18 gae_duplicate tensor(-0.5566, dtype=torch.float64) tensor(0.1454, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(-0.4028, dtype=torch.float64)
17 gae_duplicate tensor(-0.8481, dtype=torch.float64) tensor(2.2517, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.2921, dtype=torch.float64)
16 gae_duplicate tensor(-0.3864, dtype=torch.float64) tensor(0.1010, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(0.2922, dtype=torch.float64)
15 gae_duplicate tensor(-0.0169, dtype=torch.float64) tensor(0.0044, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(0.2924, dtype=torch.float64)
14 gae_duplicate tensor(0.2789, dtype=torch.float64) tensor(-0.0729, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.2925, dtype=torch.float64)
13 gae_duplicate tensor(0.5156, dtype=torch.float64) tensor(-0.1348, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(0.2926, dtype=torch.float64)
12 gae_duplicate tensor(0.7051, dtype=torch.float64) tensor(-0.1844, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(0.2928, dtype=torch.float64)
11 gae_duplicate tensor(0.8568, dtype=torch.float64) tensor(-2.2783, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7701, dtype=torch.float64) delta_t tensor(0.0748, dtype=torch.float64)
10 gae_duplicate tensor(0.7602, dtype=torch.float64) tensor(-0.1988, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6380, dtype=torch.float64) delta_t tensor(0.6269, dtype=torch.float64)
9 gae_duplicate tensor(1.2351, dtype=torch.float64) tensor(-0.3225, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7703, dtype=torch.float64) delta_t tensor(0.1070, dtype=torch.float64)
8 gae_duplicate tensor(1.0950, dtype=torch.float64) tensor(-0.2858, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3535, dtype=torch.float64) delta_t tensor(-0.4184, dtype=torch.float64)
7 gae_duplicate tensor(0.4576, dtype=torch.float64) tensor(-0.1195, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2213, dtype=torch.float64) delta_t tensor(-0.2125, dtype=torch.float64)
6 gae_duplicate tensor(0.1536, dtype=torch.float64) tensor(-0.0401, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3450, dtype=torch.float64) delta_t tensor(1.7659, dtype=torch.float64)
5 gae_duplicate tensor(1.8888, dtype=torch.float64) tensor(-0.9026, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8081, dtype=torch.float64) delta_t tensor(-0.4571, dtype=torch.float64)
4 gae_duplicate tensor(1.0539, dtype=torch.float64) tensor(-3.8816, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3732, dtype=torch.float64) delta_t tensor(-0.6295, dtype=torch.float64)
3 gae_duplicate tensor(0.2137, dtype=torch.float64) tensor(-0.0961, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7424, dtype=torch.float64) delta_t tensor(0.1788, dtype=torch.float64)
2 gae_duplicate tensor(0.3498, dtype=torch.float64) tensor(-0.1050, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:15.732488632202148
value loss:19.204723358154297
entropies:16.48039436340332
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(359.4644)
ToM Target loss= tensor(312.9804)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.449265956878662 seconds
19 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(-1.4438, dtype=torch.float64)
19 gae_duplicate tensor(-1.4438, dtype=torch.float64) tensor(3.8562, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.2259, dtype=torch.float64)
18 gae_duplicate tensor(-0.9291, dtype=torch.float64) tensor(0.2401, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.4921, dtype=torch.float64)
17 gae_duplicate tensor(-0.2512, dtype=torch.float64) tensor(0.6679, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.0323, dtype=torch.float64)
16 gae_duplicate tensor(-0.1687, dtype=torch.float64) tensor(0.0436, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.5777, dtype=torch.float64)
15 gae_duplicate tensor(0.4428, dtype=torch.float64) tensor(-0.1147, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(2.0878, dtype=torch.float64)
14 gae_duplicate tensor(2.4420, dtype=torch.float64) tensor(-6.5229, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(0.1066, dtype=torch.float64)
13 gae_duplicate tensor(2.0603, dtype=torch.float64) tensor(-5.5028, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(0.6015, dtype=torch.float64)
12 gae_duplicate tensor(2.2497, dtype=torch.float64) tensor(-0.5807, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.4082, dtype=torch.float64)
11 gae_duplicate tensor(2.2080, dtype=torch.float64) tensor(-0.5701, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6851, dtype=torch.float64) delta_t tensor(-2.4928, dtype=torch.float64)
10 gae_duplicate tensor(-0.7264, dtype=torch.float64) tensor(0.1867, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3068, dtype=torch.float64) delta_t tensor(-0.2305, dtype=torch.float64)
9 gae_duplicate tensor(-0.8116, dtype=torch.float64) tensor(0.2087, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2222, dtype=torch.float64) delta_t tensor(-0.5033, dtype=torch.float64)
8 gae_duplicate tensor(-1.1526, dtype=torch.float64) tensor(0.2971, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0156, dtype=torch.float64) delta_t tensor(0.0690, dtype=torch.float64)
7 gae_duplicate tensor(-0.8531, dtype=torch.float64) tensor(0.2393, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6191, dtype=torch.float64) delta_t tensor(-0.6633, dtype=torch.float64)
6 gae_duplicate tensor(-1.3458, dtype=torch.float64) tensor(3.5959, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.2060, dtype=torch.float64) delta_t tensor(-0.6206, dtype=torch.float64)
5 gae_duplicate tensor(-1.6972, dtype=torch.float64) tensor(4.5408, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7692, dtype=torch.float64) delta_t tensor(1.0011, dtype=torch.float64)
4 gae_duplicate tensor(-0.3567, dtype=torch.float64) tensor(0.0923, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4793, dtype=torch.float64) delta_t tensor(-1.5428, dtype=torch.float64)
3 gae_duplicate tensor(-1.8281, dtype=torch.float64) tensor(0.4713, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0245, dtype=torch.float64) delta_t tensor(-2.2088, dtype=torch.float64)
2 gae_duplicate tensor(-3.6713, dtype=torch.float64) tensor(0.9554, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-13.088140487670898
value loss:72.39318084716797
entropies:15.428478240966797
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.391680955886841 seconds
19 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(-2.0181, dtype=torch.float64)
19 gae_duplicate tensor(-2.0181, dtype=torch.float64) tensor(0.5193, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.8815, dtype=torch.float64)
18 gae_duplicate tensor(-0.7330, dtype=torch.float64) tensor(1.9570, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(3.0718, dtype=torch.float64)
17 gae_duplicate tensor(2.4854, dtype=torch.float64) tensor(-0.6424, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(1.2450, dtype=torch.float64)
16 gae_duplicate tensor(3.2333, dtype=torch.float64) tensor(-0.8351, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(1.0161, dtype=torch.float64)
15 gae_duplicate tensor(3.6028, dtype=torch.float64) tensor(-0.9306, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(1.0163, dtype=torch.float64)
14 gae_duplicate tensor(3.8985, dtype=torch.float64) tensor(-10.3619, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6372, dtype=torch.float64) delta_t tensor(1.0758, dtype=torch.float64)
13 gae_duplicate tensor(4.1946, dtype=torch.float64) tensor(-1.0824, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5050, dtype=torch.float64) delta_t tensor(-2.6612, dtype=torch.float64)
12 gae_duplicate tensor(0.6944, dtype=torch.float64) tensor(-0.1787, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3065, dtype=torch.float64) delta_t tensor(0.1733, dtype=torch.float64)
11 gae_duplicate tensor(0.7289, dtype=torch.float64) tensor(-1.9463, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3066, dtype=torch.float64) delta_t tensor(-0.0309, dtype=torch.float64)
10 gae_duplicate tensor(0.5522, dtype=torch.float64) tensor(-0.1425, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3066, dtype=torch.float64) delta_t tensor(0.0313, dtype=torch.float64)
9 gae_duplicate tensor(0.4730, dtype=torch.float64) tensor(-0.1223, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1563, dtype=torch.float64) delta_t tensor(0.8417, dtype=torch.float64)
8 gae_duplicate tensor(1.2201, dtype=torch.float64) tensor(-0.4428, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4870, dtype=torch.float64) delta_t tensor(-1.0820, dtype=torch.float64)
7 gae_duplicate tensor(-0.1059, dtype=torch.float64) tensor(0.4736, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2806, dtype=torch.float64) delta_t tensor(-0.9177, dtype=torch.float64)
6 gae_duplicate tensor(-1.0024, dtype=torch.float64) tensor(0.3450, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6777, dtype=torch.float64) delta_t tensor(0.7705, dtype=torch.float64)
5 gae_duplicate tensor(-0.0314, dtype=torch.float64) tensor(0.0108, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2073, dtype=torch.float64) delta_t tensor(-1.5537, dtype=torch.float64)
4 gae_duplicate tensor(-1.5788, dtype=torch.float64) tensor(0.5227, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0250, dtype=torch.float64) delta_t tensor(0.9887, dtype=torch.float64)
3 gae_duplicate tensor(-0.2743, dtype=torch.float64) tensor(0.0834, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0250, dtype=torch.float64) delta_t tensor(0.5095, dtype=torch.float64)
2 gae_duplicate tensor(0.2900, dtype=torch.float64) tensor(-0.0788, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:76.62413787841797
value loss:110.57132720947266
entropies:16.238914489746094
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.410653352737427 seconds
19 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(-1.1274, dtype=torch.float64)
19 gae_duplicate tensor(-1.1274, dtype=torch.float64) tensor(0.2908, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.4953, dtype=torch.float64)
18 gae_duplicate tensor(-0.4066, dtype=torch.float64) tensor(0.1049, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.4954, dtype=torch.float64)
17 gae_duplicate tensor(0.1701, dtype=torch.float64) tensor(-0.0439, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.4956, dtype=torch.float64)
16 gae_duplicate tensor(0.6317, dtype=torch.float64) tensor(-0.1629, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(0.4957, dtype=torch.float64)
15 gae_duplicate tensor(1.0010, dtype=torch.float64) tensor(-0.2582, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.4958, dtype=torch.float64)
14 gae_duplicate tensor(1.2966, dtype=torch.float64) tensor(-0.3344, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.4959, dtype=torch.float64)
13 gae_duplicate tensor(1.5332, dtype=torch.float64) tensor(-0.3955, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(0.4961, dtype=torch.float64)
12 gae_duplicate tensor(1.7227, dtype=torch.float64) tensor(-4.5697, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.2159, dtype=torch.float64) delta_t tensor(-1.6135, dtype=torch.float64)
11 gae_duplicate tensor(-0.2354, dtype=torch.float64) tensor(0.0602, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4384, dtype=torch.float64) delta_t tensor(-0.4328, dtype=torch.float64)
10 gae_duplicate tensor(-0.6211, dtype=torch.float64) tensor(1.6588, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1076, dtype=torch.float64) delta_t tensor(0.1153, dtype=torch.float64)
9 gae_duplicate tensor(-0.3816, dtype=torch.float64) tensor(1.0202, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5046, dtype=torch.float64) delta_t tensor(0.0278, dtype=torch.float64)
8 gae_duplicate tensor(-0.2774, dtype=torch.float64) tensor(0.7416, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4143, dtype=torch.float64) delta_t tensor(-1.4574, dtype=torch.float64)
7 gae_duplicate tensor(-1.6794, dtype=torch.float64) tensor(0.4297, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6368, dtype=torch.float64) delta_t tensor(0.9893, dtype=torch.float64)
6 gae_duplicate tensor(-0.3542, dtype=torch.float64) tensor(0.0916, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7453, dtype=torch.float64) delta_t tensor(-0.4026, dtype=torch.float64)
5 gae_duplicate tensor(-0.6860, dtype=torch.float64) tensor(0.1762, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7691, dtype=torch.float64) delta_t tensor(1.0623, dtype=torch.float64)
4 gae_duplicate tensor(0.5135, dtype=torch.float64) tensor(-0.1323, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0839, dtype=torch.float64) delta_t tensor(-1.1679, dtype=torch.float64)
3 gae_duplicate tensor(-0.7572, dtype=torch.float64) tensor(0.1943, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2237, dtype=torch.float64) delta_t tensor(-2.4347, dtype=torch.float64)
2 gae_duplicate tensor(-3.0404, dtype=torch.float64) tensor(8.1364, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-42.50615310668945
value loss:36.04047775268555
entropies:15.338725090026855
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.206455945968628 seconds
19 rew tensor(0.7690, dtype=torch.float64) delta_t tensor(-1.1798, dtype=torch.float64)
19 gae_duplicate tensor(-1.1798, dtype=torch.float64) tensor(0.2992, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7028, dtype=torch.float64) delta_t tensor(0.3317, dtype=torch.float64)
18 gae_duplicate tensor(-0.6122, dtype=torch.float64) tensor(0.1553, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5705, dtype=torch.float64) delta_t tensor(0.4627, dtype=torch.float64)
17 gae_duplicate tensor(-0.0270, dtype=torch.float64) tensor(0.0069, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2394, dtype=torch.float64) delta_t tensor(-0.1679, dtype=torch.float64)
16 gae_duplicate tensor(-0.1895, dtype=torch.float64) tensor(0.0481, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.2904, dtype=torch.float64) delta_t tensor(-0.5749, dtype=torch.float64)
15 gae_duplicate tensor(-0.7265, dtype=torch.float64) tensor(0.1850, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.7721, dtype=torch.float64)
14 gae_duplicate tensor(0.1909, dtype=torch.float64) tensor(-0.0486, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-1.8134, dtype=torch.float64) delta_t tensor(-1.1764, dtype=torch.float64)
13 gae_duplicate tensor(-1.0237, dtype=torch.float64) tensor(2.7523, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.5556, dtype=torch.float64) delta_t tensor(-1.7145, dtype=torch.float64)
12 gae_duplicate tensor(-2.5335, dtype=torch.float64) tensor(12.9871, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7689, dtype=torch.float64) delta_t tensor(0.4929, dtype=torch.float64)
11 gae_duplicate tensor(-1.5340, dtype=torch.float64) tensor(4.1083, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5041, dtype=torch.float64) delta_t tensor(-0.5883, dtype=torch.float64)
10 gae_duplicate tensor(-1.8155, dtype=torch.float64) tensor(0.4566, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0406, dtype=torch.float64) delta_t tensor(0.1286, dtype=torch.float64)
9 gae_duplicate tensor(-1.3238, dtype=torch.float64) tensor(0.3320, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7690, dtype=torch.float64) delta_t tensor(0.2793, dtype=torch.float64)
8 gae_duplicate tensor(-0.7797, dtype=torch.float64) tensor(0.1972, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7538, dtype=torch.float64) delta_t tensor(-0.9778, dtype=torch.float64)
7 gae_duplicate tensor(-1.6015, dtype=torch.float64) tensor(0.4025, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6365, dtype=torch.float64) delta_t tensor(0.6116, dtype=torch.float64)
6 gae_duplicate tensor(-0.6696, dtype=torch.float64) tensor(0.1695, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8200, dtype=torch.float64) delta_t tensor(-0.2499, dtype=torch.float64)
5 gae_duplicate tensor(-0.7856, dtype=torch.float64) tensor(0.1986, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5041, dtype=torch.float64) delta_t tensor(2.1378, dtype=torch.float64)
4 gae_duplicate tensor(1.5093, dtype=torch.float64) tensor(-0.5333, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6214, dtype=torch.float64) delta_t tensor(1.0988, dtype=torch.float64)
3 gae_duplicate tensor(2.3062, dtype=torch.float64) tensor(-4.4935, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4890, dtype=torch.float64) delta_t tensor(-0.9374, dtype=torch.float64)
2 gae_duplicate tensor(0.9076, dtype=torch.float64) tensor(-0.2389, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-102.37169647216797
value loss:44.84205627441406
entropies:15.527822494506836
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.631162881851196 seconds
19 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(-2.1346, dtype=torch.float64)
19 gae_duplicate tensor(-2.1346, dtype=torch.float64) tensor(0.5223, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(0.8971, dtype=torch.float64)
18 gae_duplicate tensor(-0.8106, dtype=torch.float64) tensor(0.1983, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(3.0646, dtype=torch.float64)
17 gae_duplicate tensor(2.4162, dtype=torch.float64) tensor(-0.5949, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.9443, dtype=torch.float64)
16 gae_duplicate tensor(2.8772, dtype=torch.float64) tensor(-0.7084, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.9444, dtype=torch.float64)
15 gae_duplicate tensor(3.2462, dtype=torch.float64) tensor(-0.7993, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(1.2321, dtype=torch.float64)
14 gae_duplicate tensor(3.8291, dtype=torch.float64) tensor(-0.9422, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(1.2975, dtype=torch.float64)
13 gae_duplicate tensor(4.3608, dtype=torch.float64) tensor(-1.0728, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(-2.1841, dtype=torch.float64)
12 gae_duplicate tensor(1.3045, dtype=torch.float64) tensor(-0.3198, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3060, dtype=torch.float64) delta_t tensor(-0.2242, dtype=torch.float64)
11 gae_duplicate tensor(0.8194, dtype=torch.float64) tensor(-2.2203, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3721, dtype=torch.float64) delta_t tensor(0.0224, dtype=torch.float64)
10 gae_duplicate tensor(0.6778, dtype=torch.float64) tensor(-0.1670, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3061, dtype=torch.float64) delta_t tensor(0.0342, dtype=torch.float64)
9 gae_duplicate tensor(0.5765, dtype=torch.float64) tensor(-0.1424, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8174, dtype=torch.float64) delta_t tensor(0.2965, dtype=torch.float64)
8 gae_duplicate tensor(0.7577, dtype=torch.float64) tensor(-0.2754, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1077, dtype=torch.float64) delta_t tensor(-0.4971, dtype=torch.float64)
7 gae_duplicate tensor(0.1090, dtype=torch.float64) tensor(-0.7766, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.9409, dtype=torch.float64) delta_t tensor(-1.4737, dtype=torch.float64)
6 gae_duplicate tensor(-1.3865, dtype=torch.float64) tensor(0.4345, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6111, dtype=torch.float64) delta_t tensor(0.7200, dtype=torch.float64)
5 gae_duplicate tensor(-0.3892, dtype=torch.float64) tensor(0.1222, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.5118, dtype=torch.float64) delta_t tensor(-4.9101, dtype=torch.float64)
4 gae_duplicate tensor(-5.2214, dtype=torch.float64) tensor(1.5812, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1066, dtype=torch.float64) delta_t tensor(0.9689, dtype=torch.float64)
3 gae_duplicate tensor(-3.2082, dtype=torch.float64) tensor(0.9022, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1066, dtype=torch.float64) delta_t tensor(0.5181, dtype=torch.float64)
2 gae_duplicate tensor(-2.0485, dtype=torch.float64) tensor(0.5261, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:21.92506980895996
value loss:166.68429565429688
entropies:15.647758483886719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(314.9612)
ToM Target loss= tensor(312.0629)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.371885061264038 seconds
19 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(-0.7308, dtype=torch.float64)
19 gae_duplicate tensor(-0.7308, dtype=torch.float64) tensor(0.1743, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.5740, dtype=torch.float64)
18 gae_duplicate tensor(-0.0106, dtype=torch.float64) tensor(0.0025, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.7038, dtype=torch.float64)
17 gae_duplicate tensor(0.6953, dtype=torch.float64) tensor(-0.1659, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.6002, dtype=torch.float64)
16 gae_duplicate tensor(1.1564, dtype=torch.float64) tensor(-0.2759, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.8362, dtype=torch.float64)
15 gae_duplicate tensor(1.7613, dtype=torch.float64) tensor(-0.4205, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6361, dtype=torch.float64) delta_t tensor(0.4148, dtype=torch.float64)
14 gae_duplicate tensor(1.8238, dtype=torch.float64) tensor(-0.4360, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6362, dtype=torch.float64) delta_t tensor(-0.0847, dtype=torch.float64)
13 gae_duplicate tensor(1.3744, dtype=torch.float64) tensor(-0.3286, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3717, dtype=torch.float64) delta_t tensor(-0.5625, dtype=torch.float64)
12 gae_duplicate tensor(0.5370, dtype=torch.float64) tensor(-1.4619, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3717, dtype=torch.float64) delta_t tensor(-0.0082, dtype=torch.float64)
11 gae_duplicate tensor(0.4215, dtype=torch.float64) tensor(-0.1018, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5040, dtype=torch.float64) delta_t tensor(0.1940, dtype=torch.float64)
10 gae_duplicate tensor(0.5312, dtype=torch.float64) tensor(-0.1261, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0911, dtype=torch.float64) delta_t tensor(-0.7937, dtype=torch.float64)
9 gae_duplicate tensor(-0.3687, dtype=torch.float64) tensor(1.0078, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1573, dtype=torch.float64) delta_t tensor(-0.6973, dtype=torch.float64)
8 gae_duplicate tensor(-0.9923, dtype=torch.float64) tensor(0.2365, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6201, dtype=torch.float64) delta_t tensor(-0.4101, dtype=torch.float64)
7 gae_duplicate tensor(-1.2039, dtype=torch.float64) tensor(0.2860, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7022, dtype=torch.float64) delta_t tensor(0.4525, dtype=torch.float64)
6 gae_duplicate tensor(-0.5106, dtype=torch.float64) tensor(0.1224, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6118, dtype=torch.float64) delta_t tensor(-0.3659, dtype=torch.float64)
5 gae_duplicate tensor(-0.7744, dtype=torch.float64) tensor(0.1851, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3715, dtype=torch.float64) delta_t tensor(0.7648, dtype=torch.float64)
4 gae_duplicate tensor(0.1453, dtype=torch.float64) tensor(-0.0349, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3476, dtype=torch.float64) delta_t tensor(0.8995, dtype=torch.float64)
3 gae_duplicate tensor(1.0157, dtype=torch.float64) tensor(-0.2513, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4883, dtype=torch.float64) delta_t tensor(-0.7249, dtype=torch.float64)
2 gae_duplicate tensor(0.0876, dtype=torch.float64) tensor(-0.1974, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:10.272501945495605
value loss:23.867141723632812
entropies:14.719795227050781
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.65263295173645 seconds
19 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(-1.4394, dtype=torch.float64)
19 gae_duplicate tensor(-1.4394, dtype=torch.float64) tensor(3.9809, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(1.0573, dtype=torch.float64)
18 gae_duplicate tensor(-0.0942, dtype=torch.float64) tensor(0.0220, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.3818, dtype=torch.float64)
17 gae_duplicate tensor(0.3064, dtype=torch.float64) tensor(-0.8471, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.0860, dtype=torch.float64)
16 gae_duplicate tensor(0.3311, dtype=torch.float64) tensor(-0.0769, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(1.9975, dtype=torch.float64)
15 gae_duplicate tensor(2.2624, dtype=torch.float64) tensor(-0.5254, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.7478, dtype=torch.float64)
14 gae_duplicate tensor(2.5577, dtype=torch.float64) tensor(-0.5940, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.7479, dtype=torch.float64)
13 gae_duplicate tensor(2.7941, dtype=torch.float64) tensor(-0.6489, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(2.2992, dtype=torch.float64)
12 gae_duplicate tensor(4.5344, dtype=torch.float64) tensor(-2.0567, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.1503, dtype=torch.float64) delta_t tensor(-1.5157, dtype=torch.float64)
11 gae_duplicate tensor(2.1118, dtype=torch.float64) tensor(-6.0874, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.8784, dtype=torch.float64) delta_t tensor(-4.0636, dtype=torch.float64)
10 gae_duplicate tensor(-2.3742, dtype=torch.float64) tensor(0.7475, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5698, dtype=torch.float64) delta_t tensor(0.3838, dtype=torch.float64)
9 gae_duplicate tensor(-1.5155, dtype=torch.float64) tensor(0.5458, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1066, dtype=torch.float64) delta_t tensor(-0.7242, dtype=torch.float64)
8 gae_duplicate tensor(-1.9366, dtype=torch.float64) tensor(0.6124, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4890, dtype=torch.float64) delta_t tensor(1.2497, dtype=torch.float64)
7 gae_duplicate tensor(-0.2996, dtype=torch.float64) tensor(0.1346, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7020, dtype=torch.float64) delta_t tensor(0.8005, dtype=torch.float64)
6 gae_duplicate tensor(0.5608, dtype=torch.float64) tensor(-0.2366, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3491, dtype=torch.float64) delta_t tensor(0.5481, dtype=torch.float64)
5 gae_duplicate tensor(0.9968, dtype=torch.float64) tensor(-0.4743, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7681, dtype=torch.float64) delta_t tensor(-0.3632, dtype=torch.float64)
4 gae_duplicate tensor(0.4342, dtype=torch.float64) tensor(-0.1839, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7537, dtype=torch.float64) delta_t tensor(1.3709, dtype=torch.float64)
3 gae_duplicate tensor(1.7183, dtype=torch.float64) tensor(-0.5803, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2906, dtype=torch.float64) delta_t tensor(-0.5027, dtype=torch.float64)
2 gae_duplicate tensor(0.8719, dtype=torch.float64) tensor(-0.2254, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:38.4588508605957
value loss:95.63249206542969
entropies:16.764406204223633
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.267822027206421 seconds
19 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(-0.2833, dtype=torch.float64)
19 gae_duplicate tensor(-0.2833, dtype=torch.float64) tensor(0.7914, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(-0.1072, dtype=torch.float64)
18 gae_duplicate tensor(-0.3338, dtype=torch.float64) tensor(1.7927, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.5370, dtype=torch.float64)
17 gae_duplicate tensor(0.2699, dtype=torch.float64) tensor(-0.0595, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(1.0177, dtype=torch.float64)
16 gae_duplicate tensor(1.2337, dtype=torch.float64) tensor(-3.4388, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.6157, dtype=torch.float64)
15 gae_duplicate tensor(1.6026, dtype=torch.float64) tensor(-0.3538, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.7628, dtype=torch.float64)
14 gae_duplicate tensor(2.0449, dtype=torch.float64) tensor(-0.4518, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6358, dtype=torch.float64) delta_t tensor(-0.1613, dtype=torch.float64)
13 gae_duplicate tensor(1.4747, dtype=torch.float64) tensor(-0.3258, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1062, dtype=torch.float64) delta_t tensor(-0.9208, dtype=torch.float64)
12 gae_duplicate tensor(0.2589, dtype=torch.float64) tensor(-0.0572, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0262, dtype=torch.float64) delta_t tensor(-0.4930, dtype=torch.float64)
11 gae_duplicate tensor(-0.2859, dtype=torch.float64) tensor(0.0637, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5034, dtype=torch.float64) delta_t tensor(0.0096, dtype=torch.float64)
10 gae_duplicate tensor(-0.2192, dtype=torch.float64) tensor(0.0483, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0262, dtype=torch.float64) delta_t tensor(-0.1891, dtype=torch.float64)
9 gae_duplicate tensor(-0.3644, dtype=torch.float64) tensor(1.0207, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2386, dtype=torch.float64) delta_t tensor(-0.3584, dtype=torch.float64)
8 gae_duplicate tensor(-0.6499, dtype=torch.float64) tensor(1.8147, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8866, dtype=torch.float64) delta_t tensor(-0.5307, dtype=torch.float64)
7 gae_duplicate tensor(-1.0506, dtype=torch.float64) tensor(0.2307, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7018, dtype=torch.float64) delta_t tensor(0.5865, dtype=torch.float64)
6 gae_duplicate tensor(-0.2539, dtype=torch.float64) tensor(0.0567, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4823, dtype=torch.float64) delta_t tensor(1.0311, dtype=torch.float64)
5 gae_duplicate tensor(0.8279, dtype=torch.float64) tensor(-1.3822, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1060, dtype=torch.float64) delta_t tensor(-0.4638, dtype=torch.float64)
4 gae_duplicate tensor(0.1985, dtype=torch.float64) tensor(-0.8510, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3501, dtype=torch.float64) delta_t tensor(0.5786, dtype=torch.float64)
3 gae_duplicate tensor(0.7374, dtype=torch.float64) tensor(-0.2033, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1058, dtype=torch.float64) delta_t tensor(-1.5098, dtype=torch.float64)
2 gae_duplicate tensor(-0.9199, dtype=torch.float64) tensor(0.2062, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:6.157195568084717
value loss:22.118896484375
entropies:14.473665237426758
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.543804883956909 seconds
19 rew tensor(0.8341, dtype=torch.float64) delta_t tensor(-1.9777, dtype=torch.float64)
19 gae_duplicate tensor(-1.9777, dtype=torch.float64) tensor(0.4229, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7679, dtype=torch.float64) delta_t tensor(0.1102, dtype=torch.float64)
18 gae_duplicate tensor(-1.4719, dtype=torch.float64) tensor(0.3148, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6355, dtype=torch.float64) delta_t tensor(0.3379, dtype=torch.float64)
17 gae_duplicate tensor(-0.8396, dtype=torch.float64) tensor(2.3776, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3042, dtype=torch.float64) delta_t tensor(0.2156, dtype=torch.float64)
16 gae_duplicate tensor(-0.4561, dtype=torch.float64) tensor(1.2925, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0934, dtype=torch.float64) delta_t tensor(0.3270, dtype=torch.float64)
15 gae_duplicate tensor(-0.0379, dtype=torch.float64) tensor(0.0080, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8343, dtype=torch.float64) delta_t tensor(-0.0178, dtype=torch.float64)
14 gae_duplicate tensor(-0.0481, dtype=torch.float64) tensor(0.1352, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.5176, dtype=torch.float64)
13 gae_duplicate tensor(0.4791, dtype=torch.float64) tensor(-0.1022, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2382, dtype=torch.float64) delta_t tensor(-0.1449, dtype=torch.float64)
12 gae_duplicate tensor(0.2383, dtype=torch.float64) tensor(-0.6711, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5569, dtype=torch.float64) delta_t tensor(-0.7411, dtype=torch.float64)
11 gae_duplicate tensor(-0.5505, dtype=torch.float64) tensor(0.1176, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6356, dtype=torch.float64) delta_t tensor(-1.3540, dtype=torch.float64)
10 gae_duplicate tensor(-1.7944, dtype=torch.float64) tensor(0.3803, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3044, dtype=torch.float64) delta_t tensor(0.0874, dtype=torch.float64)
9 gae_duplicate tensor(-1.3481, dtype=torch.float64) tensor(0.2857, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3580, dtype=torch.float64) delta_t tensor(-0.5969, dtype=torch.float64)
8 gae_duplicate tensor(-1.6754, dtype=torch.float64) tensor(0.3580, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9542, dtype=torch.float64) delta_t tensor(0.2446, dtype=torch.float64)
7 gae_duplicate tensor(-1.0957, dtype=torch.float64) tensor(3.1400, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6354, dtype=torch.float64) delta_t tensor(-0.2305, dtype=torch.float64)
6 gae_duplicate tensor(-1.1070, dtype=torch.float64) tensor(3.1273, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0867, dtype=torch.float64) delta_t tensor(-0.2630, dtype=torch.float64)
5 gae_duplicate tensor(-1.1486, dtype=torch.float64) tensor(0.2439, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1595, dtype=torch.float64) delta_t tensor(0.5990, dtype=torch.float64)
4 gae_duplicate tensor(-0.3199, dtype=torch.float64) tensor(0.0680, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3518, dtype=torch.float64) delta_t tensor(0.5676, dtype=torch.float64)
3 gae_duplicate tensor(0.3117, dtype=torch.float64) tensor(-0.0673, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1714, dtype=torch.float64) delta_t tensor(-1.4374, dtype=torch.float64)
2 gae_duplicate tensor(-1.1880, dtype=torch.float64) tensor(3.3462, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-89.07221984863281
value loss:31.176185607910156
entropies:13.5626220703125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.573505878448486 seconds
19 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(-2.0637, dtype=torch.float64)
19 gae_duplicate tensor(-2.0637, dtype=torch.float64) tensor(0.4167, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.2680, dtype=torch.float64)
18 gae_duplicate tensor(-1.3830, dtype=torch.float64) tensor(0.2793, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.4276, dtype=torch.float64)
17 gae_duplicate tensor(-0.6788, dtype=torch.float64) tensor(0.1371, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.4611, dtype=torch.float64)
16 gae_duplicate tensor(-0.0820, dtype=torch.float64) tensor(0.0166, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(1.3281, dtype=torch.float64)
15 gae_duplicate tensor(1.2625, dtype=torch.float64) tensor(-0.2576, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(0.5479, dtype=torch.float64)
14 gae_duplicate tensor(1.5579, dtype=torch.float64) tensor(-0.3179, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.5480, dtype=torch.float64)
13 gae_duplicate tensor(1.7943, dtype=torch.float64) tensor(-0.3661, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.5481, dtype=torch.float64)
12 gae_duplicate tensor(1.9836, dtype=torch.float64) tensor(-0.4047, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.5483, dtype=torch.float64)
11 gae_duplicate tensor(2.1352, dtype=torch.float64) tensor(-0.4356, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5576, dtype=torch.float64) delta_t tensor(-1.8825, dtype=torch.float64)
10 gae_duplicate tensor(-0.1744, dtype=torch.float64) tensor(0.0352, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4197, dtype=torch.float64) delta_t tensor(-1.6803, dtype=torch.float64)
9 gae_duplicate tensor(-1.8198, dtype=torch.float64) tensor(0.3670, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5031, dtype=torch.float64) delta_t tensor(-0.2129, dtype=torch.float64)
8 gae_duplicate tensor(-1.6687, dtype=torch.float64) tensor(0.3369, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2263, dtype=torch.float64) delta_t tensor(-0.3457, dtype=torch.float64)
7 gae_duplicate tensor(-1.6807, dtype=torch.float64) tensor(0.3391, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7020, dtype=torch.float64) delta_t tensor(0.5184, dtype=torch.float64)
6 gae_duplicate tensor(-0.8262, dtype=torch.float64) tensor(0.1681, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5577, dtype=torch.float64) delta_t tensor(0.0123, dtype=torch.float64)
5 gae_duplicate tensor(-0.6487, dtype=torch.float64) tensor(0.1322, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3705, dtype=torch.float64) delta_t tensor(1.2526, dtype=torch.float64)
4 gae_duplicate tensor(0.7336, dtype=torch.float64) tensor(-0.1581, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4251, dtype=torch.float64) delta_t tensor(0.4264, dtype=torch.float64)
3 gae_duplicate tensor(1.0133, dtype=torch.float64) tensor(-0.2062, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4251, dtype=torch.float64) delta_t tensor(-1.2766, dtype=torch.float64)
2 gae_duplicate tensor(-0.4660, dtype=torch.float64) tensor(0.0951, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1.4543843269348145
value loss:51.314918518066406
entropies:13.076708793640137
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(321.4822)
ToM Target loss= tensor(311.0186)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.451970100402832 seconds
19 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.5698, dtype=torch.float64)
19 gae_duplicate tensor(0.5698, dtype=torch.float64) tensor(-0.1239, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(0.8341, dtype=torch.float64)
18 gae_duplicate tensor(1.2899, dtype=torch.float64) tensor(-0.2805, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(-1.8993, dtype=torch.float64)
17 gae_duplicate tensor(-0.8674, dtype=torch.float64) tensor(0.1696, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.5300, dtype=torch.float64)
16 gae_duplicate tensor(-0.1639, dtype=torch.float64) tensor(0.4744, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.3362, dtype=torch.float64)
15 gae_duplicate tensor(0.2051, dtype=torch.float64) tensor(-0.0401, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.3364, dtype=torch.float64)
14 gae_duplicate tensor(0.5004, dtype=torch.float64) tensor(-0.0978, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(0.3365, dtype=torch.float64)
13 gae_duplicate tensor(0.7368, dtype=torch.float64) tensor(-0.1440, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7682, dtype=torch.float64) delta_t tensor(1.1411, dtype=torch.float64)
12 gae_duplicate tensor(1.7305, dtype=torch.float64) tensor(-0.3992, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5030, dtype=torch.float64) delta_t tensor(-0.0160, dtype=torch.float64)
11 gae_duplicate tensor(1.3684, dtype=torch.float64) tensor(-2.5688, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3041, dtype=torch.float64) delta_t tensor(-0.0095, dtype=torch.float64)
10 gae_duplicate tensor(1.0853, dtype=torch.float64) tensor(-0.3632, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0938, dtype=torch.float64) delta_t tensor(0.0728, dtype=torch.float64)
9 gae_duplicate tensor(0.9410, dtype=torch.float64) tensor(-0.3511, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4254, dtype=torch.float64) delta_t tensor(-0.9620, dtype=torch.float64)
8 gae_duplicate tensor(-0.2092, dtype=torch.float64) tensor(0.0630, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0222, dtype=torch.float64) delta_t tensor(-0.2763, dtype=torch.float64)
7 gae_duplicate tensor(-0.4437, dtype=torch.float64) tensor(0.2094, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6354, dtype=torch.float64) delta_t tensor(0.8747, dtype=torch.float64)
6 gae_duplicate tensor(0.5197, dtype=torch.float64) tensor(-0.2203, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.2821, dtype=torch.float64) delta_t tensor(-0.5046, dtype=torch.float64)
5 gae_duplicate tensor(-0.0888, dtype=torch.float64) tensor(0.0458, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5690, dtype=torch.float64) delta_t tensor(-0.5400, dtype=torch.float64)
4 gae_duplicate tensor(-0.6110, dtype=torch.float64) tensor(1.8904, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8187, dtype=torch.float64) delta_t tensor(0.2727, dtype=torch.float64)
3 gae_duplicate tensor(-0.2162, dtype=torch.float64) tensor(0.0561, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2935, dtype=torch.float64) delta_t tensor(-1.4225, dtype=torch.float64)
2 gae_duplicate tensor(-1.5954, dtype=torch.float64) tensor(0.3799, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:7.337666034698486
value loss:21.026782989501953
entropies:15.49140739440918
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.592180967330933 seconds
19 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(-1.4403, dtype=torch.float64)
19 gae_duplicate tensor(-1.4403, dtype=torch.float64) tensor(0.2767, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.4756, dtype=torch.float64)
18 gae_duplicate tensor(-0.6766, dtype=torch.float64) tensor(0.1299, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.1502, dtype=torch.float64)
17 gae_duplicate tensor(-0.3911, dtype=torch.float64) tensor(0.0751, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.7359, dtype=torch.float64)
16 gae_duplicate tensor(0.4230, dtype=torch.float64) tensor(-0.0812, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(2.0247, dtype=torch.float64)
15 gae_duplicate tensor(2.3631, dtype=torch.float64) tensor(-0.4637, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.7676, dtype=torch.float64)
14 gae_duplicate tensor(2.6581, dtype=torch.float64) tensor(-0.5216, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.7677, dtype=torch.float64)
13 gae_duplicate tensor(2.8941, dtype=torch.float64) tensor(-0.5679, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.7678, dtype=torch.float64)
12 gae_duplicate tensor(3.0831, dtype=torch.float64) tensor(-0.6050, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.7679, dtype=torch.float64)
11 gae_duplicate tensor(3.2344, dtype=torch.float64) tensor(-0.6347, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(-0.7988, dtype=torch.float64)
10 gae_duplicate tensor(1.7887, dtype=torch.float64) tensor(-0.3435, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-4.5993, dtype=torch.float64) delta_t tensor(-3.8249, dtype=torch.float64)
9 gae_duplicate tensor(-2.3939, dtype=torch.float64) tensor(0.7895, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3698, dtype=torch.float64) delta_t tensor(-1.0240, dtype=torch.float64)
8 gae_duplicate tensor(-2.9391, dtype=torch.float64) tensor(8.7293, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0381, dtype=torch.float64) delta_t tensor(-0.3156, dtype=torch.float64)
7 gae_duplicate tensor(-2.6669, dtype=torch.float64) tensor(0.6315, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9572, dtype=torch.float64) delta_t tensor(-0.1743, dtype=torch.float64)
6 gae_duplicate tensor(-2.3078, dtype=torch.float64) tensor(0.4735, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2890, dtype=torch.float64) delta_t tensor(0.3539, dtype=torch.float64)
5 gae_duplicate tensor(-1.4923, dtype=torch.float64) tensor(0.9193, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7676, dtype=torch.float64) delta_t tensor(0.2428, dtype=torch.float64)
4 gae_duplicate tensor(-0.9511, dtype=torch.float64) tensor(2.6971, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0901, dtype=torch.float64) delta_t tensor(0.9157, dtype=torch.float64)
3 gae_duplicate tensor(0.1549, dtype=torch.float64) tensor(-0.0453, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1613, dtype=torch.float64) delta_t tensor(-0.2728, dtype=torch.float64)
2 gae_duplicate tensor(-0.1489, dtype=torch.float64) tensor(0.0339, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-69.38372802734375
value loss:115.56259155273438
entropies:14.179563522338867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.295889854431152 seconds
19 rew tensor(0.8329, dtype=torch.float64) delta_t tensor(-1.8528, dtype=torch.float64)
19 gae_duplicate tensor(-1.8528, dtype=torch.float64) tensor(0.3421, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7004, dtype=torch.float64) delta_t tensor(-0.0558, dtype=torch.float64)
18 gae_duplicate tensor(-1.5381, dtype=torch.float64) tensor(0.2840, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5679, dtype=torch.float64) delta_t tensor(0.5048, dtype=torch.float64)
17 gae_duplicate tensor(-0.7256, dtype=torch.float64) tensor(0.1340, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1701, dtype=torch.float64) delta_t tensor(-0.1141, dtype=torch.float64)
16 gae_duplicate tensor(-0.6946, dtype=torch.float64) tensor(0.1283, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.4267, dtype=torch.float64) delta_t tensor(-1.3387, dtype=torch.float64)
15 gae_duplicate tensor(-1.8944, dtype=torch.float64) tensor(0.3534, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.3659, dtype=torch.float64)
14 gae_duplicate tensor(-1.1496, dtype=torch.float64) tensor(0.2145, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.3660, dtype=torch.float64)
13 gae_duplicate tensor(-0.5537, dtype=torch.float64) tensor(1.6110, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.3662, dtype=torch.float64)
12 gae_duplicate tensor(-0.0768, dtype=torch.float64) tensor(0.0143, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.3663, dtype=torch.float64)
11 gae_duplicate tensor(0.3048, dtype=torch.float64) tensor(-0.0569, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5587, dtype=torch.float64) delta_t tensor(-0.4602, dtype=torch.float64)
10 gae_duplicate tensor(-0.2163, dtype=torch.float64) tensor(1.2397, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1610, dtype=torch.float64) delta_t tensor(-1.3388, dtype=torch.float64)
9 gae_duplicate tensor(-1.5119, dtype=torch.float64) tensor(4.4676, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2367, dtype=torch.float64) delta_t tensor(-0.3438, dtype=torch.float64)
8 gae_duplicate tensor(-1.5533, dtype=torch.float64) tensor(0.2834, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2273, dtype=torch.float64) delta_t tensor(-0.8039, dtype=torch.float64)
7 gae_duplicate tensor(-2.0465, dtype=torch.float64) tensor(0.3746, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9563, dtype=torch.float64) delta_t tensor(-1.2826, dtype=torch.float64)
6 gae_duplicate tensor(-2.9199, dtype=torch.float64) tensor(0.5439, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4204, dtype=torch.float64) delta_t tensor(0.7451, dtype=torch.float64)
5 gae_duplicate tensor(-1.5908, dtype=torch.float64) tensor(0.3506, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5015, dtype=torch.float64) delta_t tensor(0.3733, dtype=torch.float64)
4 gae_duplicate tensor(-0.8993, dtype=torch.float64) tensor(2.5392, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2218, dtype=torch.float64) delta_t tensor(-1.5094, dtype=torch.float64)
3 gae_duplicate tensor(-2.2289, dtype=torch.float64) tensor(0.4088, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0289, dtype=torch.float64) delta_t tensor(1.8922, dtype=torch.float64)
2 gae_duplicate tensor(0.1091, dtype=torch.float64) tensor(-0.0201, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-79.64237213134766
value loss:56.85274887084961
entropies:12.309751510620117
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.344225168228149 seconds
19 rew tensor(0.8982, dtype=torch.float64) delta_t tensor(-2.1243, dtype=torch.float64)
19 gae_duplicate tensor(-2.1243, dtype=torch.float64) tensor(0.3766, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.2812, dtype=torch.float64)
18 gae_duplicate tensor(-1.4183, dtype=torch.float64) tensor(0.2515, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(0.1202, dtype=torch.float64)
17 gae_duplicate tensor(-1.0144, dtype=torch.float64) tensor(3.0228, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(0.4433, dtype=torch.float64)
16 gae_duplicate tensor(-0.3682, dtype=torch.float64) tensor(0.0653, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.6771, dtype=torch.float64)
15 gae_duplicate tensor(0.3826, dtype=torch.float64) tensor(-0.0680, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.3713, dtype=torch.float64)
14 gae_duplicate tensor(0.6773, dtype=torch.float64) tensor(-0.1204, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.3714, dtype=torch.float64)
13 gae_duplicate tensor(0.9133, dtype=torch.float64) tensor(-0.1624, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.3715, dtype=torch.float64)
12 gae_duplicate tensor(1.1021, dtype=torch.float64) tensor(-0.1959, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-4.5340, dtype=torch.float64) delta_t tensor(-5.0074, dtype=torch.float64)
11 gae_duplicate tensor(-4.1257, dtype=torch.float64) tensor(0.7345, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5017, dtype=torch.float64) delta_t tensor(-0.1771, dtype=torch.float64)
10 gae_duplicate tensor(-3.4777, dtype=torch.float64) tensor(0.6142, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.7672, dtype=torch.float64) delta_t tensor(-0.3726, dtype=torch.float64)
9 gae_duplicate tensor(-3.1547, dtype=torch.float64) tensor(18.2408, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4934, dtype=torch.float64) delta_t tensor(-0.6710, dtype=torch.float64)
8 gae_duplicate tensor(-3.1947, dtype=torch.float64) tensor(9.5158, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7672, dtype=torch.float64) delta_t tensor(0.1982, dtype=torch.float64)
7 gae_duplicate tensor(-2.3576, dtype=torch.float64) tensor(0.4167, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2943, dtype=torch.float64) delta_t tensor(2.4947, dtype=torch.float64)
6 gae_duplicate tensor(0.6086, dtype=torch.float64) tensor(-0.1863, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2364, dtype=torch.float64) delta_t tensor(-0.1145, dtype=torch.float64)
5 gae_duplicate tensor(0.3724, dtype=torch.float64) tensor(-0.5941, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1616, dtype=torch.float64) delta_t tensor(0.2054, dtype=torch.float64)
4 gae_duplicate tensor(0.5034, dtype=torch.float64) tensor(-0.2109, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0289, dtype=torch.float64) delta_t tensor(0.2088, dtype=torch.float64)
3 gae_duplicate tensor(0.6115, dtype=torch.float64) tensor(-0.2225, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5595, dtype=torch.float64) delta_t tensor(-0.8066, dtype=torch.float64)
2 gae_duplicate tensor(-0.3174, dtype=torch.float64) tensor(0.0708, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-189.68792724609375
value loss:99.61773681640625
entropies:13.226694107055664
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.740948915481567 seconds
19 rew tensor(0.8321, dtype=torch.float64) delta_t tensor(-2.0801, dtype=torch.float64)
19 gae_duplicate tensor(-2.0801, dtype=torch.float64) tensor(6.2635, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(0.3161, dtype=torch.float64)
18 gae_duplicate tensor(-1.3480, dtype=torch.float64) tensor(4.0591, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(0.3162, dtype=torch.float64)
17 gae_duplicate tensor(-0.7623, dtype=torch.float64) tensor(0.1297, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.3163, dtype=torch.float64)
16 gae_duplicate tensor(-0.2935, dtype=torch.float64) tensor(0.0499, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8326, dtype=torch.float64) delta_t tensor(0.2450, dtype=torch.float64)
15 gae_duplicate tensor(0.0102, dtype=torch.float64) tensor(-0.0017, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7664, dtype=torch.float64) delta_t tensor(0.1417, dtype=torch.float64)
14 gae_duplicate tensor(0.1498, dtype=torch.float64) tensor(-0.0255, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7001, dtype=torch.float64) delta_t tensor(-0.0759, dtype=torch.float64)
13 gae_duplicate tensor(0.0440, dtype=torch.float64) tensor(-0.0075, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3687, dtype=torch.float64) delta_t tensor(-0.0458, dtype=torch.float64)
12 gae_duplicate tensor(-0.0106, dtype=torch.float64) tensor(0.0018, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5676, dtype=torch.float64) delta_t tensor(0.0756, dtype=torch.float64)
11 gae_duplicate tensor(0.0672, dtype=torch.float64) tensor(-0.0114, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3688, dtype=torch.float64) delta_t tensor(0.0003, dtype=torch.float64)
10 gae_duplicate tensor(0.0541, dtype=torch.float64) tensor(-0.0092, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8329, dtype=torch.float64) delta_t tensor(2.9123, dtype=torch.float64)
9 gae_duplicate tensor(2.9555, dtype=torch.float64) tensor(-0.6986, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0288, dtype=torch.float64) delta_t tensor(-0.6487, dtype=torch.float64)
8 gae_duplicate tensor(1.7157, dtype=torch.float64) tensor(-2.8916, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2363, dtype=torch.float64) delta_t tensor(-0.3066, dtype=torch.float64)
7 gae_duplicate tensor(1.0659, dtype=torch.float64) tensor(-0.3977, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3602, dtype=torch.float64) delta_t tensor(0.2181, dtype=torch.float64)
6 gae_duplicate tensor(1.0708, dtype=torch.float64) tensor(-3.4885, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0951, dtype=torch.float64) delta_t tensor(0.1723, dtype=torch.float64)
5 gae_duplicate tensor(1.0289, dtype=torch.float64) tensor(-0.3979, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0892, dtype=torch.float64) delta_t tensor(0.3657, dtype=torch.float64)
4 gae_duplicate tensor(1.1888, dtype=torch.float64) tensor(-0.3094, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2219, dtype=torch.float64) delta_t tensor(-0.6650, dtype=torch.float64)
3 gae_duplicate tensor(0.2861, dtype=torch.float64) tensor(-0.1458, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8245, dtype=torch.float64) delta_t tensor(-0.9522, dtype=torch.float64)
2 gae_duplicate tensor(-0.7233, dtype=torch.float64) tensor(2.2272, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-26.4913330078125
value loss:35.82268524169922
entropies:13.755427360534668
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(345.5807)
ToM Target loss= tensor(312.4291)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.42982292175293 seconds
19 rew tensor(0.7666, dtype=torch.float64) delta_t tensor(-2.2485, dtype=torch.float64)
19 gae_duplicate tensor(-2.2485, dtype=torch.float64) tensor(6.8479, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7004, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
18 gae_duplicate tensor(-1.7700, dtype=torch.float64) tensor(0.2882, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5014, dtype=torch.float64) delta_t tensor(-0.1832, dtype=torch.float64)
17 gae_duplicate tensor(-1.5992, dtype=torch.float64) tensor(0.2603, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0369, dtype=torch.float64) delta_t tensor(-0.3602, dtype=torch.float64)
16 gae_duplicate tensor(-1.6396, dtype=torch.float64) tensor(0.2669, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.6266, dtype=torch.float64) delta_t tensor(-0.9135, dtype=torch.float64)
15 gae_duplicate tensor(-2.2251, dtype=torch.float64) tensor(0.3630, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2359, dtype=torch.float64) delta_t tensor(-0.2884, dtype=torch.float64)
14 gae_duplicate tensor(-2.0685, dtype=torch.float64) tensor(0.3375, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-1.0910, dtype=torch.float64) delta_t tensor(-1.6153, dtype=torch.float64)
13 gae_duplicate tensor(-3.2701, dtype=torch.float64) tensor(0.5335, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7665, dtype=torch.float64) delta_t tensor(0.2627, dtype=torch.float64)
12 gae_duplicate tensor(-2.3534, dtype=torch.float64) tensor(0.3844, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5012, dtype=torch.float64) delta_t tensor(0.5868, dtype=torch.float64)
11 gae_duplicate tensor(-1.2960, dtype=torch.float64) tensor(0.2110, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7003, dtype=torch.float64) delta_t tensor(-0.8244, dtype=torch.float64)
10 gae_duplicate tensor(-1.8612, dtype=torch.float64) tensor(0.3024, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4937, dtype=torch.float64) delta_t tensor(-0.4625, dtype=torch.float64)
9 gae_duplicate tensor(-1.9514, dtype=torch.float64) tensor(0.3167, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7666, dtype=torch.float64) delta_t tensor(2.2795, dtype=torch.float64)
8 gae_duplicate tensor(0.7184, dtype=torch.float64) tensor(-0.1678, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4273, dtype=torch.float64) delta_t tensor(-0.8608, dtype=torch.float64)
7 gae_duplicate tensor(-0.2861, dtype=torch.float64) tensor(0.4548, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3023, dtype=torch.float64) delta_t tensor(0.6793, dtype=torch.float64)
6 gae_duplicate tensor(0.4504, dtype=torch.float64) tensor(-0.1761, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8915, dtype=torch.float64) delta_t tensor(-0.2485, dtype=torch.float64)
5 gae_duplicate tensor(0.1119, dtype=torch.float64) tensor(-0.0468, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6926, dtype=torch.float64) delta_t tensor(0.4257, dtype=torch.float64)
4 gae_duplicate tensor(0.5152, dtype=torch.float64) tensor(-0.1436, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6875, dtype=torch.float64) delta_t tensor(-0.9518, dtype=torch.float64)
3 gae_duplicate tensor(-0.5397, dtype=torch.float64) tensor(0.1047, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4278, dtype=torch.float64) delta_t tensor(-2.7964, dtype=torch.float64)
2 gae_duplicate tensor(-3.2281, dtype=torch.float64) tensor(0.5255, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-64.35584259033203
value loss:89.45793914794922
entropies:12.676689147949219
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.503400802612305 seconds
19 rew tensor(0.8334, dtype=torch.float64) delta_t tensor(-2.0851, dtype=torch.float64)
19 gae_duplicate tensor(-2.0851, dtype=torch.float64) tensor(0.3287, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7007, dtype=torch.float64) delta_t tensor(0.1174, dtype=torch.float64)
18 gae_duplicate tensor(-1.5507, dtype=torch.float64) tensor(0.2445, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5680, dtype=torch.float64) delta_t tensor(0.0926, dtype=torch.float64)
17 gae_duplicate tensor(-1.1479, dtype=torch.float64) tensor(0.1810, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1696, dtype=torch.float64) delta_t tensor(-0.3187, dtype=torch.float64)
16 gae_duplicate tensor(-1.2370, dtype=torch.float64) tensor(0.1950, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.4279, dtype=torch.float64) delta_t tensor(-0.5747, dtype=torch.float64)
15 gae_duplicate tensor(-1.5643, dtype=torch.float64) tensor(0.2486, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.4327, dtype=torch.float64)
14 gae_duplicate tensor(-0.8187, dtype=torch.float64) tensor(0.1301, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.4328, dtype=torch.float64)
13 gae_duplicate tensor(-0.2222, dtype=torch.float64) tensor(0.0353, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(0.4330, dtype=torch.float64)
12 gae_duplicate tensor(0.2552, dtype=torch.float64) tensor(-0.0406, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5603, dtype=torch.float64) delta_t tensor(-0.9833, dtype=torch.float64)
11 gae_duplicate tensor(-0.7791, dtype=torch.float64) tensor(0.1242, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6345, dtype=torch.float64) delta_t tensor(0.0896, dtype=torch.float64)
10 gae_duplicate tensor(-0.5337, dtype=torch.float64) tensor(0.0840, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6346, dtype=torch.float64) delta_t tensor(-0.2049, dtype=torch.float64)
9 gae_duplicate tensor(-0.6318, dtype=torch.float64) tensor(0.0996, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2282, dtype=torch.float64) delta_t tensor(-0.3351, dtype=torch.float64)
8 gae_duplicate tensor(-0.8406, dtype=torch.float64) tensor(0.1325, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1619, dtype=torch.float64) delta_t tensor(1.7140, dtype=torch.float64)
7 gae_duplicate tensor(1.0415, dtype=torch.float64) tensor(-2.4955, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1574, dtype=torch.float64) delta_t tensor(-0.4733, dtype=torch.float64)
6 gae_duplicate tensor(0.3599, dtype=torch.float64) tensor(-0.4467, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4353, dtype=torch.float64) delta_t tensor(0.1254, dtype=torch.float64)
5 gae_duplicate tensor(0.4133, dtype=torch.float64) tensor(-0.1623, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6884, dtype=torch.float64) delta_t tensor(-0.2847, dtype=torch.float64)
4 gae_duplicate tensor(0.0459, dtype=torch.float64) tensor(-0.0103, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3570, dtype=torch.float64) delta_t tensor(-1.7113, dtype=torch.float64)
3 gae_duplicate tensor(-1.6746, dtype=torch.float64) tensor(0.2800, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0297, dtype=torch.float64) delta_t tensor(-1.5661, dtype=torch.float64)
2 gae_duplicate tensor(-2.9057, dtype=torch.float64) tensor(0.4580, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3.3217244148254395
value loss:41.19731903076172
entropies:12.040576934814453
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.3589959144592285 seconds
19 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(-1.5063, dtype=torch.float64)
19 gae_duplicate tensor(-1.5063, dtype=torch.float64) tensor(4.5833, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.3212, dtype=torch.float64)
18 gae_duplicate tensor(-0.8838, dtype=torch.float64) tensor(0.1393, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.5617, dtype=torch.float64)
17 gae_duplicate tensor(-0.1454, dtype=torch.float64) tensor(0.0229, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.4986, dtype=torch.float64)
16 gae_duplicate tensor(0.3823, dtype=torch.float64) tensor(-0.0603, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(-0.0123, dtype=torch.float64)
15 gae_duplicate tensor(0.2935, dtype=torch.float64) tensor(-0.0465, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.3538, dtype=torch.float64)
14 gae_duplicate tensor(0.5886, dtype=torch.float64) tensor(-0.0932, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.3539, dtype=torch.float64)
13 gae_duplicate tensor(0.8247, dtype=torch.float64) tensor(-0.1306, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(1.7505, dtype=torch.float64)
12 gae_duplicate tensor(2.4103, dtype=torch.float64) tensor(-0.3752, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(-0.4296, dtype=torch.float64)
11 gae_duplicate tensor(1.4986, dtype=torch.float64) tensor(-4.6212, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7675, dtype=torch.float64) delta_t tensor(-0.2619, dtype=torch.float64)
10 gae_duplicate tensor(0.9370, dtype=torch.float64) tensor(-5.6491, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4356, dtype=torch.float64) delta_t tensor(-0.0982, dtype=torch.float64)
9 gae_duplicate tensor(0.6514, dtype=torch.float64) tensor(-2.0152, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0956, dtype=torch.float64) delta_t tensor(-0.0226, dtype=torch.float64)
8 gae_duplicate tensor(0.4985, dtype=torch.float64) tensor(-0.0770, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.6347, dtype=torch.float64) delta_t tensor(-0.4213, dtype=torch.float64)
7 gae_duplicate tensor(-0.0225, dtype=torch.float64) tensor(0.0035, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.9544, dtype=torch.float64) delta_t tensor(-1.4116, dtype=torch.float64)
6 gae_duplicate tensor(-1.4295, dtype=torch.float64) tensor(0.2225, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4354, dtype=torch.float64) delta_t tensor(0.0265, dtype=torch.float64)
5 gae_duplicate tensor(-1.1171, dtype=torch.float64) tensor(0.1889, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6893, dtype=torch.float64) delta_t tensor(-0.2139, dtype=torch.float64)
4 gae_duplicate tensor(-1.1076, dtype=torch.float64) tensor(0.1831, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.7673, dtype=torch.float64) delta_t tensor(0.7217, dtype=torch.float64)
3 gae_duplicate tensor(-0.1644, dtype=torch.float64) tensor(0.0290, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4240, dtype=torch.float64) delta_t tensor(-1.8173, dtype=torch.float64)
2 gae_duplicate tensor(-1.9488, dtype=torch.float64) tensor(0.3050, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:44.01637649536133
value loss:33.41931915283203
entropies:10.967145919799805
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.47640585899353 seconds
19 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(-1.8046, dtype=torch.float64)
19 gae_duplicate tensor(-1.8046, dtype=torch.float64) tensor(0.2787, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.3585, dtype=torch.float64)
18 gae_duplicate tensor(-1.0852, dtype=torch.float64) tensor(0.1676, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.3587, dtype=torch.float64)
17 gae_duplicate tensor(-0.5095, dtype=torch.float64) tensor(0.0787, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.3588, dtype=torch.float64)
16 gae_duplicate tensor(-0.0488, dtype=torch.float64) tensor(0.0075, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.3589, dtype=torch.float64)
15 gae_duplicate tensor(0.3199, dtype=torch.float64) tensor(-0.0494, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.3884, dtype=torch.float64)
14 gae_duplicate tensor(0.6443, dtype=torch.float64) tensor(-0.0995, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.4098, dtype=torch.float64)
13 gae_duplicate tensor(0.9252, dtype=torch.float64) tensor(-0.1430, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5679, dtype=torch.float64) delta_t tensor(0.0647, dtype=torch.float64)
12 gae_duplicate tensor(0.8048, dtype=torch.float64) tensor(-0.1244, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4351, dtype=torch.float64) delta_t tensor(-0.0662, dtype=torch.float64)
11 gae_duplicate tensor(0.5777, dtype=torch.float64) tensor(-0.0892, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.6239, dtype=torch.float64) delta_t tensor(-1.8871, dtype=torch.float64)
10 gae_duplicate tensor(-1.4249, dtype=torch.float64) tensor(0.2202, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5678, dtype=torch.float64) delta_t tensor(-0.2351, dtype=torch.float64)
9 gae_duplicate tensor(-1.3751, dtype=torch.float64) tensor(0.2125, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0964, dtype=torch.float64) delta_t tensor(-0.1680, dtype=torch.float64)
8 gae_duplicate tensor(-1.2681, dtype=torch.float64) tensor(3.9206, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0300, dtype=torch.float64) delta_t tensor(-1.1124, dtype=torch.float64)
7 gae_duplicate tensor(-2.1268, dtype=torch.float64) tensor(6.5771, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0262, dtype=torch.float64) delta_t tensor(-0.4598, dtype=torch.float64)
6 gae_duplicate tensor(-2.1612, dtype=torch.float64) tensor(0.3531, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4348, dtype=torch.float64) delta_t tensor(0.4243, dtype=torch.float64)
5 gae_duplicate tensor(-1.3047, dtype=torch.float64) tensor(0.2213, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4247, dtype=torch.float64) delta_t tensor(-0.2044, dtype=torch.float64)
4 gae_duplicate tensor(-1.2482, dtype=torch.float64) tensor(0.2177, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3682, dtype=torch.float64) delta_t tensor(0.1423, dtype=torch.float64)
3 gae_duplicate tensor(-0.8563, dtype=torch.float64) tensor(0.1359, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5577, dtype=torch.float64) delta_t tensor(0.7483, dtype=torch.float64)
2 gae_duplicate tensor(0.0633, dtype=torch.float64) tensor(-0.1980, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-70.45259857177734
value loss:38.65812301635742
entropies:10.959908485412598
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.477130174636841 seconds
19 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(-1.5589, dtype=torch.float64)
19 gae_duplicate tensor(-1.5589, dtype=torch.float64) tensor(0.2747, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.4761, dtype=torch.float64)
18 gae_duplicate tensor(-0.7710, dtype=torch.float64) tensor(0.1349, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.2625, dtype=torch.float64)
17 gae_duplicate tensor(-0.3543, dtype=torch.float64) tensor(0.0672, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.7161, dtype=torch.float64)
16 gae_duplicate tensor(0.4327, dtype=torch.float64) tensor(-0.1002, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(2.5840, dtype=torch.float64)
15 gae_duplicate tensor(2.9301, dtype=torch.float64) tensor(-0.9053, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.8810, dtype=torch.float64)
14 gae_duplicate tensor(3.2251, dtype=torch.float64) tensor(-0.9965, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.8811, dtype=torch.float64)
13 gae_duplicate tensor(3.4612, dtype=torch.float64) tensor(-1.0694, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.8813, dtype=torch.float64)
12 gae_duplicate tensor(3.6502, dtype=torch.float64) tensor(-1.1278, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.8814, dtype=torch.float64)
11 gae_duplicate tensor(3.8016, dtype=torch.float64) tensor(-1.1746, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.8912, dtype=torch.float64) delta_t tensor(-3.9514, dtype=torch.float64)
10 gae_duplicate tensor(-0.9101, dtype=torch.float64) tensor(0.2486, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9612, dtype=torch.float64) delta_t tensor(-1.3747, dtype=torch.float64)
9 gae_duplicate tensor(-2.1028, dtype=torch.float64) tensor(0.5131, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0357, dtype=torch.float64) delta_t tensor(-0.0093, dtype=torch.float64)
8 gae_duplicate tensor(-1.6915, dtype=torch.float64) tensor(0.5444, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7668, dtype=torch.float64) delta_t tensor(0.3918, dtype=torch.float64)
7 gae_duplicate tensor(-0.9614, dtype=torch.float64) tensor(0.3029, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2965, dtype=torch.float64) delta_t tensor(0.8999, dtype=torch.float64)
6 gae_duplicate tensor(0.1308, dtype=torch.float64) tensor(-0.0547, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3016, dtype=torch.float64) delta_t tensor(0.5421, dtype=torch.float64)
5 gae_duplicate tensor(0.6467, dtype=torch.float64) tensor(-0.2520, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1635, dtype=torch.float64) delta_t tensor(0.1882, dtype=torch.float64)
4 gae_duplicate tensor(0.7056, dtype=torch.float64) tensor(-0.2948, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0307, dtype=torch.float64) delta_t tensor(0.2481, dtype=torch.float64)
3 gae_duplicate tensor(0.8126, dtype=torch.float64) tensor(-0.2891, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5622, dtype=torch.float64) delta_t tensor(0.0207, dtype=torch.float64)
2 gae_duplicate tensor(0.6707, dtype=torch.float64) tensor(-0.1433, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:25.478622436523438
value loss:109.73835754394531
entropies:15.118915557861328
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(337.3714)
ToM Target loss= tensor(312.1881)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.396500110626221 seconds
19 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(0.1126, dtype=torch.float64)
19 gae_duplicate tensor(0.1126, dtype=torch.float64) tensor(-0.0171, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(0.7414, dtype=torch.float64)
18 gae_duplicate tensor(0.8315, dtype=torch.float64) tensor(-0.1259, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.7416, dtype=torch.float64)
17 gae_duplicate tensor(1.4068, dtype=torch.float64) tensor(-0.2131, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.7417, dtype=torch.float64)
16 gae_duplicate tensor(1.8671, dtype=torch.float64) tensor(-0.2828, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(-1.3557, dtype=torch.float64)
15 gae_duplicate tensor(0.1380, dtype=torch.float64) tensor(-0.0207, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.3367, dtype=torch.float64)
14 gae_duplicate tensor(0.4471, dtype=torch.float64) tensor(-2.7255, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.3254, dtype=torch.float64)
13 gae_duplicate tensor(0.6830, dtype=torch.float64) tensor(-0.1025, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.3255, dtype=torch.float64)
12 gae_duplicate tensor(0.8720, dtype=torch.float64) tensor(-0.1308, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.3256, dtype=torch.float64)
11 gae_duplicate tensor(1.0232, dtype=torch.float64) tensor(-0.1535, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(1.6779, dtype=torch.float64)
10 gae_duplicate tensor(2.4965, dtype=torch.float64) tensor(-0.4281, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7628, dtype=torch.float64) delta_t tensor(-1.3061, dtype=torch.float64)
9 gae_duplicate tensor(0.6911, dtype=torch.float64) tensor(-1.1401, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7666, dtype=torch.float64) delta_t tensor(0.2081, dtype=torch.float64)
8 gae_duplicate tensor(0.7610, dtype=torch.float64) tensor(-0.2370, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4968, dtype=torch.float64) delta_t tensor(-0.3805, dtype=torch.float64)
7 gae_duplicate tensor(0.2282, dtype=torch.float64) tensor(-0.0877, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7001, dtype=torch.float64) delta_t tensor(1.4716, dtype=torch.float64)
6 gae_duplicate tensor(1.6541, dtype=torch.float64) tensor(-0.6874, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5632, dtype=torch.float64) delta_t tensor(0.1491, dtype=torch.float64)
5 gae_duplicate tensor(1.4724, dtype=torch.float64) tensor(-0.6709, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3676, dtype=torch.float64) delta_t tensor(0.1862, dtype=torch.float64)
4 gae_duplicate tensor(1.3641, dtype=torch.float64) tensor(-0.6039, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4302, dtype=torch.float64) delta_t tensor(1.5329, dtype=torch.float64)
3 gae_duplicate tensor(2.6242, dtype=torch.float64) tensor(-0.9060, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4967, dtype=torch.float64) delta_t tensor(-0.9832, dtype=torch.float64)
2 gae_duplicate tensor(1.1161, dtype=torch.float64) tensor(-3.5451, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:72.07073974609375
value loss:46.34977722167969
entropies:13.257914543151855
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.394383192062378 seconds
19 rew tensor(0.8324, dtype=torch.float64) delta_t tensor(-1.4901, dtype=torch.float64)
19 gae_duplicate tensor(-1.4901, dtype=torch.float64) tensor(4.6138, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6994, dtype=torch.float64) delta_t tensor(0.0378, dtype=torch.float64)
18 gae_duplicate tensor(-1.1543, dtype=torch.float64) tensor(0.1693, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4334, dtype=torch.float64) delta_t tensor(-0.2563, dtype=torch.float64)
17 gae_duplicate tensor(-1.1798, dtype=torch.float64) tensor(3.7033, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1007, dtype=torch.float64) delta_t tensor(-0.4736, dtype=torch.float64)
16 gae_duplicate tensor(-1.4174, dtype=torch.float64) tensor(0.2083, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.5645, dtype=torch.float64) delta_t tensor(-0.6649, dtype=torch.float64)
15 gae_duplicate tensor(-1.7989, dtype=torch.float64) tensor(0.2663, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.4406, dtype=torch.float64)
14 gae_duplicate tensor(-0.9984, dtype=torch.float64) tensor(0.1478, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.4408, dtype=torch.float64)
13 gae_duplicate tensor(-0.3580, dtype=torch.float64) tensor(0.0530, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.4409, dtype=torch.float64)
12 gae_duplicate tensor(0.1545, dtype=torch.float64) tensor(-0.0229, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4311, dtype=torch.float64) delta_t tensor(-0.8894, dtype=torch.float64)
11 gae_duplicate tensor(-0.7658, dtype=torch.float64) tensor(0.1134, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.2293, dtype=torch.float64) delta_t tensor(-2.0692, dtype=torch.float64)
10 gae_duplicate tensor(-2.6818, dtype=torch.float64) tensor(0.3941, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4334, dtype=torch.float64) delta_t tensor(0.0282, dtype=torch.float64)
9 gae_duplicate tensor(-2.1172, dtype=torch.float64) tensor(0.3110, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0322, dtype=torch.float64) delta_t tensor(-0.7279, dtype=torch.float64)
8 gae_duplicate tensor(-2.4217, dtype=torch.float64) tensor(7.5972, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7637, dtype=torch.float64) delta_t tensor(1.0363, dtype=torch.float64)
7 gae_duplicate tensor(-0.9011, dtype=torch.float64) tensor(0.2767, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6328, dtype=torch.float64) delta_t tensor(0.7531, dtype=torch.float64)
6 gae_duplicate tensor(0.0323, dtype=torch.float64) tensor(-0.0476, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1603, dtype=torch.float64) delta_t tensor(-0.5932, dtype=torch.float64)
5 gae_duplicate tensor(-0.5674, dtype=torch.float64) tensor(0.2731, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7657, dtype=torch.float64) delta_t tensor(-0.2147, dtype=torch.float64)
4 gae_duplicate tensor(-0.6686, dtype=torch.float64) tensor(0.2642, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4958, dtype=torch.float64) delta_t tensor(0.4817, dtype=torch.float64)
3 gae_duplicate tensor(-0.0532, dtype=torch.float64) tensor(0.0126, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0326, dtype=torch.float64) delta_t tensor(-0.6086, dtype=torch.float64)
2 gae_duplicate tensor(-0.6511, dtype=torch.float64) tensor(0.1118, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-111.03684997558594
value loss:47.209754943847656
entropies:12.148382186889648
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.345813035964966 seconds
19 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(-1.3075, dtype=torch.float64)
19 gae_duplicate tensor(-1.3075, dtype=torch.float64) tensor(0.1896, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.3942, dtype=torch.float64)
18 gae_duplicate tensor(-0.6517, dtype=torch.float64) tensor(0.0945, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.5319, dtype=torch.float64)
17 gae_duplicate tensor(0.0105, dtype=torch.float64) tensor(-0.0015, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.6457, dtype=torch.float64)
16 gae_duplicate tensor(0.6541, dtype=torch.float64) tensor(-0.0954, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(1.5569, dtype=torch.float64)
15 gae_duplicate tensor(2.0802, dtype=torch.float64) tensor(-0.2980, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(-0.2424, dtype=torch.float64)
14 gae_duplicate tensor(1.4218, dtype=torch.float64) tensor(-4.4977, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.4905, dtype=torch.float64)
13 gae_duplicate tensor(1.6279, dtype=torch.float64) tensor(-0.2334, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0324, dtype=torch.float64) delta_t tensor(-0.7153, dtype=torch.float64)
12 gae_duplicate tensor(0.5870, dtype=torch.float64) tensor(-0.0842, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0324, dtype=torch.float64) delta_t tensor(-0.7102, dtype=torch.float64)
11 gae_duplicate tensor(-0.2406, dtype=torch.float64) tensor(0.0349, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1656, dtype=torch.float64) delta_t tensor(-0.5351, dtype=torch.float64)
10 gae_duplicate tensor(-0.7276, dtype=torch.float64) tensor(0.1060, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2321, dtype=torch.float64) delta_t tensor(0.0707, dtype=torch.float64)
9 gae_duplicate tensor(-0.5113, dtype=torch.float64) tensor(0.0782, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5667, dtype=torch.float64) delta_t tensor(-0.6058, dtype=torch.float64)
8 gae_duplicate tensor(-1.0149, dtype=torch.float64) tensor(3.2095, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3652, dtype=torch.float64) delta_t tensor(-0.4365, dtype=torch.float64)
7 gae_duplicate tensor(-1.2484, dtype=torch.float64) tensor(0.1786, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6998, dtype=torch.float64) delta_t tensor(0.2311, dtype=torch.float64)
6 gae_duplicate tensor(-0.7676, dtype=torch.float64) tensor(0.1107, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5648, dtype=torch.float64) delta_t tensor(-0.1913, dtype=torch.float64)
5 gae_duplicate tensor(-0.8053, dtype=torch.float64) tensor(0.1165, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3669, dtype=torch.float64) delta_t tensor(1.2133, dtype=torch.float64)
4 gae_duplicate tensor(0.5690, dtype=torch.float64) tensor(-0.0879, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4317, dtype=torch.float64) delta_t tensor(1.9449, dtype=torch.float64)
3 gae_duplicate tensor(2.4001, dtype=torch.float64) tensor(-0.5312, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4982, dtype=torch.float64) delta_t tensor(-1.1853, dtype=torch.float64)
2 gae_duplicate tensor(0.7348, dtype=torch.float64) tensor(-1.8527, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:21.064420700073242
value loss:34.806888580322266
entropies:10.561975479125977
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.470164060592651 seconds
19 rew tensor(0.8327, dtype=torch.float64) delta_t tensor(-1.5206, dtype=torch.float64)
19 gae_duplicate tensor(-1.5206, dtype=torch.float64) tensor(0.2160, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6995, dtype=torch.float64) delta_t tensor(0.2715, dtype=torch.float64)
18 gae_duplicate tensor(-0.9450, dtype=torch.float64) tensor(0.1343, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6330, dtype=torch.float64) delta_t tensor(0.1982, dtype=torch.float64)
17 gae_duplicate tensor(-0.5578, dtype=torch.float64) tensor(0.0793, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2998, dtype=torch.float64) delta_t tensor(-0.0719, dtype=torch.float64)
16 gae_duplicate tensor(-0.5181, dtype=torch.float64) tensor(0.0739, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1000, dtype=torch.float64) delta_t tensor(0.4171, dtype=torch.float64)
15 gae_duplicate tensor(0.0026, dtype=torch.float64) tensor(-0.0081, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(4.1790, dtype=torch.float64)
14 gae_duplicate tensor(4.1811, dtype=torch.float64) tensor(-0.5943, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8330, dtype=torch.float64) delta_t tensor(-0.3256, dtype=torch.float64)
13 gae_duplicate tensor(3.0193, dtype=torch.float64) tensor(-4.3254, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1001, dtype=torch.float64) delta_t tensor(-0.8272, dtype=torch.float64)
12 gae_duplicate tensor(1.5882, dtype=torch.float64) tensor(-5.2708, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4329, dtype=torch.float64) delta_t tensor(-0.5111, dtype=torch.float64)
11 gae_duplicate tensor(0.7594, dtype=torch.float64) tensor(-0.2168, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7663, dtype=torch.float64) delta_t tensor(0.1054, dtype=torch.float64)
10 gae_duplicate tensor(0.7130, dtype=torch.float64) tensor(-0.2174, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3667, dtype=torch.float64) delta_t tensor(0.2851, dtype=torch.float64)
9 gae_duplicate tensor(0.8555, dtype=torch.float64) tensor(-0.2779, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0330, dtype=torch.float64) delta_t tensor(0.0700, dtype=torch.float64)
8 gae_duplicate tensor(0.7544, dtype=torch.float64) tensor(-0.2043, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3661, dtype=torch.float64) delta_t tensor(0.2166, dtype=torch.float64)
7 gae_duplicate tensor(0.8201, dtype=torch.float64) tensor(-0.3325, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6330, dtype=torch.float64) delta_t tensor(1.0774, dtype=torch.float64)
6 gae_duplicate tensor(1.7335, dtype=torch.float64) tensor(-0.6332, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3652, dtype=torch.float64) delta_t tensor(-1.0265, dtype=torch.float64)
5 gae_duplicate tensor(0.3602, dtype=torch.float64) tensor(-0.1571, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7662, dtype=torch.float64) delta_t tensor(0.2356, dtype=torch.float64)
4 gae_duplicate tensor(0.5237, dtype=torch.float64) tensor(-0.1982, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7658, dtype=torch.float64) delta_t tensor(1.2675, dtype=torch.float64)
3 gae_duplicate tensor(1.6865, dtype=torch.float64) tensor(-0.4617, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2996, dtype=torch.float64) delta_t tensor(-0.4942, dtype=torch.float64)
2 gae_duplicate tensor(0.8550, dtype=torch.float64) tensor(-0.1608, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:74.91413116455078
value loss:64.42163848876953
entropies:13.840826034545898
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.297262191772461 seconds
19 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(-1.6880, dtype=torch.float64)
19 gae_duplicate tensor(-1.6880, dtype=torch.float64) tensor(0.2331, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.4135, dtype=torch.float64)
18 gae_duplicate tensor(-0.9369, dtype=torch.float64) tensor(0.1294, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.4135, dtype=torch.float64)
17 gae_duplicate tensor(-0.3360, dtype=torch.float64) tensor(0.0464, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.5855, dtype=torch.float64)
16 gae_duplicate tensor(0.3167, dtype=torch.float64) tensor(-1.0098, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(1.7049, dtype=torch.float64)
15 gae_duplicate tensor(1.9583, dtype=torch.float64) tensor(-0.2745, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(-0.4443, dtype=torch.float64)
14 gae_duplicate tensor(1.1223, dtype=torch.float64) tensor(-0.1561, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.4310, dtype=torch.float64)
13 gae_duplicate tensor(1.3289, dtype=torch.float64) tensor(-4.2451, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(0.4548, dtype=torch.float64)
12 gae_duplicate tensor(1.5179, dtype=torch.float64) tensor(-0.2112, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4335, dtype=torch.float64) delta_t tensor(-0.8788, dtype=torch.float64)
11 gae_duplicate tensor(0.3356, dtype=torch.float64) tensor(-0.0467, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5669, dtype=torch.float64) delta_t tensor(-1.3271, dtype=torch.float64)
10 gae_duplicate tensor(-1.0586, dtype=torch.float64) tensor(0.1462, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4333, dtype=torch.float64) delta_t tensor(0.2907, dtype=torch.float64)
9 gae_duplicate tensor(-0.5562, dtype=torch.float64) tensor(0.0768, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2333, dtype=torch.float64) delta_t tensor(-0.5008, dtype=torch.float64)
8 gae_duplicate tensor(-0.9458, dtype=torch.float64) tensor(0.1307, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7668, dtype=torch.float64) delta_t tensor(-0.7377, dtype=torch.float64)
7 gae_duplicate tensor(-1.4943, dtype=torch.float64) tensor(0.2071, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6998, dtype=torch.float64) delta_t tensor(0.1915, dtype=torch.float64)
6 gae_duplicate tensor(-1.0040, dtype=torch.float64) tensor(0.1414, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3668, dtype=torch.float64) delta_t tensor(-0.1400, dtype=torch.float64)
5 gae_duplicate tensor(-0.9432, dtype=torch.float64) tensor(0.1394, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7664, dtype=torch.float64) delta_t tensor(0.8538, dtype=torch.float64)
4 gae_duplicate tensor(0.0992, dtype=torch.float64) tensor(-0.0155, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7669, dtype=torch.float64) delta_t tensor(-0.0569, dtype=torch.float64)
3 gae_duplicate tensor(0.0225, dtype=torch.float64) tensor(-0.0031, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3003, dtype=torch.float64) delta_t tensor(0.9837, dtype=torch.float64)
2 gae_duplicate tensor(1.0017, dtype=torch.float64) tensor(-0.1444, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:28.83466148376465
value loss:31.02950668334961
entropies:10.03324031829834
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(332.4896)
ToM Target loss= tensor(311.2111)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.59698486328125 seconds
19 rew tensor(0.2995, dtype=torch.float64) delta_t tensor(-2.2809, dtype=torch.float64)
19 gae_duplicate tensor(-2.2809, dtype=torch.float64) tensor(0.3158, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.3008, dtype=torch.float64) delta_t tensor(-0.9389, dtype=torch.float64)
18 gae_duplicate tensor(-2.7636, dtype=torch.float64) tensor(0.3826, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-1.3680, dtype=torch.float64) delta_t tensor(-0.3418, dtype=torch.float64)
17 gae_duplicate tensor(-2.5526, dtype=torch.float64) tensor(0.3568, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.6725, dtype=torch.float64)
16 gae_duplicate tensor(-1.3696, dtype=torch.float64) tensor(0.1914, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8331, dtype=torch.float64) delta_t tensor(0.7124, dtype=torch.float64)
15 gae_duplicate tensor(-0.3833, dtype=torch.float64) tensor(0.0538, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8332, dtype=torch.float64) delta_t tensor(0.7498, dtype=torch.float64)
14 gae_duplicate tensor(0.4432, dtype=torch.float64) tensor(-0.0631, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7666, dtype=torch.float64) delta_t tensor(0.8327, dtype=torch.float64)
13 gae_duplicate tensor(1.1873, dtype=torch.float64) tensor(-0.1740, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(-1.4372, dtype=torch.float64)
12 gae_duplicate tensor(-0.4874, dtype=torch.float64) tensor(0.0675, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7668, dtype=torch.float64) delta_t tensor(0.4193, dtype=torch.float64)
11 gae_duplicate tensor(0.0294, dtype=torch.float64) tensor(-0.0938, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6335, dtype=torch.float64) delta_t tensor(0.3280, dtype=torch.float64)
10 gae_duplicate tensor(0.3515, dtype=torch.float64) tensor(-0.0487, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9004, dtype=torch.float64) delta_t tensor(-1.0162, dtype=torch.float64)
9 gae_duplicate tensor(-0.7350, dtype=torch.float64) tensor(0.1018, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3670, dtype=torch.float64) delta_t tensor(-1.3000, dtype=torch.float64)
8 gae_duplicate tensor(-1.8880, dtype=torch.float64) tensor(0.2613, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6338, dtype=torch.float64) delta_t tensor(-0.6941, dtype=torch.float64)
7 gae_duplicate tensor(-2.2045, dtype=torch.float64) tensor(0.3047, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.7675, dtype=torch.float64) delta_t tensor(-1.4900, dtype=torch.float64)
6 gae_duplicate tensor(-3.2537, dtype=torch.float64) tensor(0.4539, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9010, dtype=torch.float64) delta_t tensor(1.5407, dtype=torch.float64)
5 gae_duplicate tensor(-1.0622, dtype=torch.float64) tensor(0.2133, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3017, dtype=torch.float64) delta_t tensor(-1.8573, dtype=torch.float64)
4 gae_duplicate tensor(-2.7071, dtype=torch.float64) tensor(5.2876, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0344, dtype=torch.float64) delta_t tensor(0.8238, dtype=torch.float64)
3 gae_duplicate tensor(-1.3419, dtype=torch.float64) tensor(0.3067, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0344, dtype=torch.float64) delta_t tensor(0.3626, dtype=torch.float64)
2 gae_duplicate tensor(-0.7108, dtype=torch.float64) tensor(0.1348, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-48.63578796386719
value loss:80.4898910522461
entropies:10.694016456604004
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.637853145599365 seconds
19 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(-1.2826, dtype=torch.float64)
19 gae_duplicate tensor(-1.2826, dtype=torch.float64) tensor(0.1802, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.4633, dtype=torch.float64)
18 gae_duplicate tensor(-0.5628, dtype=torch.float64) tensor(1.7956, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.4634, dtype=torch.float64)
17 gae_duplicate tensor(0.0131, dtype=torch.float64) tensor(-0.0018, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.2605, dtype=torch.float64)
16 gae_duplicate tensor(0.2710, dtype=torch.float64) tensor(-0.0375, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.3039, dtype=torch.float64)
15 gae_duplicate tensor(0.5208, dtype=torch.float64) tensor(-1.6607, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.3707, dtype=torch.float64)
14 gae_duplicate tensor(0.7873, dtype=torch.float64) tensor(-0.1093, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.4635, dtype=torch.float64)
13 gae_duplicate tensor(1.0934, dtype=torch.float64) tensor(-0.1519, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.4078, dtype=torch.float64)
12 gae_duplicate tensor(1.2825, dtype=torch.float64) tensor(-0.1781, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2334, dtype=torch.float64) delta_t tensor(-0.2592, dtype=torch.float64)
11 gae_duplicate tensor(0.7668, dtype=torch.float64) tensor(-0.1065, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-2.5683, dtype=torch.float64) delta_t tensor(-3.0400, dtype=torch.float64)
10 gae_duplicate tensor(-2.4265, dtype=torch.float64) tensor(0.3371, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6335, dtype=torch.float64) delta_t tensor(0.2401, dtype=torch.float64)
9 gae_duplicate tensor(-1.7011, dtype=torch.float64) tensor(0.2363, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0998, dtype=torch.float64) delta_t tensor(-0.5704, dtype=torch.float64)
8 gae_duplicate tensor(-1.9312, dtype=torch.float64) tensor(0.2683, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5675, dtype=torch.float64) delta_t tensor(-0.4150, dtype=torch.float64)
7 gae_duplicate tensor(-1.9600, dtype=torch.float64) tensor(6.2552, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7002, dtype=torch.float64) delta_t tensor(0.1763, dtype=torch.float64)
6 gae_duplicate tensor(-1.3917, dtype=torch.float64) tensor(0.1955, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3681, dtype=torch.float64) delta_t tensor(-0.1706, dtype=torch.float64)
5 gae_duplicate tensor(-1.2840, dtype=torch.float64) tensor(0.1931, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7668, dtype=torch.float64) delta_t tensor(2.3765, dtype=torch.float64)
4 gae_duplicate tensor(1.3493, dtype=torch.float64) tensor(-0.3446, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8345, dtype=torch.float64) delta_t tensor(0.2095, dtype=torch.float64)
3 gae_duplicate tensor(1.2890, dtype=torch.float64) tensor(-2.4410, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3008, dtype=torch.float64) delta_t tensor(-0.5935, dtype=torch.float64)
2 gae_duplicate tensor(0.4376, dtype=torch.float64) tensor(-0.0806, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-26.414175033569336
value loss:44.95018005371094
entropies:10.620734214782715
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.341277837753296 seconds
19 rew tensor(0.8333, dtype=torch.float64) delta_t tensor(-2.1769, dtype=torch.float64)
19 gae_duplicate tensor(-2.1769, dtype=torch.float64) tensor(0.3019, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7000, dtype=torch.float64) delta_t tensor(0.1222, dtype=torch.float64)
18 gae_duplicate tensor(-1.6193, dtype=torch.float64) tensor(0.2245, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4999, dtype=torch.float64) delta_t tensor(0.3080, dtype=torch.float64)
17 gae_duplicate tensor(-0.9874, dtype=torch.float64) tensor(0.1369, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0328, dtype=torch.float64) delta_t tensor(-0.6429, dtype=torch.float64)
16 gae_duplicate tensor(-1.4328, dtype=torch.float64) tensor(0.1987, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.6344, dtype=torch.float64) delta_t tensor(-0.7423, dtype=torch.float64)
15 gae_duplicate tensor(-1.8886, dtype=torch.float64) tensor(0.2629, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(0.4401, dtype=torch.float64)
14 gae_duplicate tensor(-1.0708, dtype=torch.float64) tensor(0.1490, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.4402, dtype=torch.float64)
13 gae_duplicate tensor(-0.4164, dtype=torch.float64) tensor(0.0580, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2331, dtype=torch.float64) delta_t tensor(-0.2269, dtype=torch.float64)
12 gae_duplicate tensor(-0.5600, dtype=torch.float64) tensor(0.0780, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.9017, dtype=torch.float64) delta_t tensor(-2.3499, dtype=torch.float64)
11 gae_duplicate tensor(-2.7979, dtype=torch.float64) tensor(0.3898, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0340, dtype=torch.float64) delta_t tensor(-0.8160, dtype=torch.float64)
10 gae_duplicate tensor(-3.0543, dtype=torch.float64) tensor(0.4237, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2996, dtype=torch.float64) delta_t tensor(0.0802, dtype=torch.float64)
9 gae_duplicate tensor(-2.3633, dtype=torch.float64) tensor(0.3276, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1674, dtype=torch.float64) delta_t tensor(-1.1505, dtype=torch.float64)
8 gae_duplicate tensor(-3.0411, dtype=torch.float64) tensor(0.4221, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1681, dtype=torch.float64) delta_t tensor(0.7404, dtype=torch.float64)
7 gae_duplicate tensor(-1.6925, dtype=torch.float64) tensor(0.5280, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6330, dtype=torch.float64) delta_t tensor(0.7230, dtype=torch.float64)
6 gae_duplicate tensor(-0.6310, dtype=torch.float64) tensor(0.9199, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1689, dtype=torch.float64) delta_t tensor(-0.6774, dtype=torch.float64)
5 gae_duplicate tensor(-1.1822, dtype=torch.float64) tensor(0.6116, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7664, dtype=torch.float64) delta_t tensor(-0.1456, dtype=torch.float64)
4 gae_duplicate tensor(-1.0913, dtype=torch.float64) tensor(0.4258, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5023, dtype=torch.float64) delta_t tensor(0.4449, dtype=torch.float64)
3 gae_duplicate tensor(-0.4281, dtype=torch.float64) tensor(0.0979, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0345, dtype=torch.float64) delta_t tensor(-0.9682, dtype=torch.float64)
2 gae_duplicate tensor(-1.3107, dtype=torch.float64) tensor(0.2099, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-34.950984954833984
value loss:82.99760437011719
entropies:11.771038055419922
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.44835090637207 seconds
19 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(-1.5595, dtype=torch.float64)
19 gae_duplicate tensor(-1.5595, dtype=torch.float64) tensor(4.9598, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(0.3503, dtype=torch.float64)
18 gae_duplicate tensor(-0.8973, dtype=torch.float64) tensor(0.1274, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.8646, dtype=torch.float64)
17 gae_duplicate tensor(0.1467, dtype=torch.float64) tensor(-0.0208, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.6517, dtype=torch.float64)
16 gae_duplicate tensor(0.7691, dtype=torch.float64) tensor(-0.1092, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.1138, dtype=torch.float64)
15 gae_duplicate tensor(0.7291, dtype=torch.float64) tensor(-0.1041, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(2.0923, dtype=torch.float64)
14 gae_duplicate tensor(2.6756, dtype=torch.float64) tensor(-0.4024, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(-0.5884, dtype=torch.float64)
13 gae_duplicate tensor(1.5520, dtype=torch.float64) tensor(-4.9328, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-1.7696, dtype=torch.float64) delta_t tensor(-2.1708, dtype=torch.float64)
12 gae_duplicate tensor(-0.9292, dtype=torch.float64) tensor(0.1311, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0995, dtype=torch.float64) delta_t tensor(-0.2954, dtype=torch.float64)
11 gae_duplicate tensor(-1.0387, dtype=torch.float64) tensor(0.1468, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6336, dtype=torch.float64) delta_t tensor(0.0116, dtype=torch.float64)
10 gae_duplicate tensor(-0.8194, dtype=torch.float64) tensor(0.1150, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2999, dtype=torch.float64) delta_t tensor(0.2375, dtype=torch.float64)
9 gae_duplicate tensor(-0.4181, dtype=torch.float64) tensor(0.0586, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2331, dtype=torch.float64) delta_t tensor(-0.3707, dtype=torch.float64)
8 gae_duplicate tensor(-0.7051, dtype=torch.float64) tensor(0.0991, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7682, dtype=torch.float64) delta_t tensor(-0.8837, dtype=torch.float64)
7 gae_duplicate tensor(-1.4478, dtype=torch.float64) tensor(0.2150, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6335, dtype=torch.float64) delta_t tensor(0.1000, dtype=torch.float64)
6 gae_duplicate tensor(-1.0583, dtype=torch.float64) tensor(0.1507, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3689, dtype=torch.float64) delta_t tensor(-0.1348, dtype=torch.float64)
5 gae_duplicate tensor(-0.9814, dtype=torch.float64) tensor(0.1526, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7670, dtype=torch.float64) delta_t tensor(0.8056, dtype=torch.float64)
4 gae_duplicate tensor(0.0205, dtype=torch.float64) tensor(-0.0032, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7682, dtype=torch.float64) delta_t tensor(-0.0596, dtype=torch.float64)
3 gae_duplicate tensor(-0.0432, dtype=torch.float64) tensor(0.0061, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3011, dtype=torch.float64) delta_t tensor(-2.1228, dtype=torch.float64)
2 gae_duplicate tensor(-2.1573, dtype=torch.float64) tensor(0.3054, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5.676661014556885
value loss:39.10606384277344
entropies:10.209213256835938
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.471185922622681 seconds
19 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(-0.9761, dtype=torch.float64)
19 gae_duplicate tensor(-0.9761, dtype=torch.float64) tensor(3.1455, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.5391, dtype=torch.float64)
18 gae_duplicate tensor(-0.2418, dtype=torch.float64) tensor(0.0496, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.3646, dtype=torch.float64)
17 gae_duplicate tensor(0.1712, dtype=torch.float64) tensor(-0.0348, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.4122, dtype=torch.float64)
16 gae_duplicate tensor(0.5492, dtype=torch.float64) tensor(-0.1267, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.8398, dtype=torch.float64)
15 gae_duplicate tensor(1.2791, dtype=torch.float64) tensor(-0.3366, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(2.9982, dtype=torch.float64)
14 gae_duplicate tensor(4.0216, dtype=torch.float64) tensor(-1.1769, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(1.0406, dtype=torch.float64)
13 gae_duplicate tensor(4.2578, dtype=torch.float64) tensor(-1.2461, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(1.0407, dtype=torch.float64)
12 gae_duplicate tensor(4.4469, dtype=torch.float64) tensor(-1.3014, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.7312, dtype=torch.float64)
11 gae_duplicate tensor(4.2888, dtype=torch.float64) tensor(-1.1444, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0330, dtype=torch.float64) delta_t tensor(-1.2127, dtype=torch.float64)
10 gae_duplicate tensor(2.2183, dtype=torch.float64) tensor(-7.1770, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-3.4369, dtype=torch.float64) delta_t tensor(-4.5119, dtype=torch.float64)
9 gae_duplicate tensor(-2.7372, dtype=torch.float64) tensor(8.9179, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4349, dtype=torch.float64) delta_t tensor(-0.2611, dtype=torch.float64)
8 gae_duplicate tensor(-2.4509, dtype=torch.float64) tensor(8.3278, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7671, dtype=torch.float64) delta_t tensor(0.1495, dtype=torch.float64)
7 gae_duplicate tensor(-1.8112, dtype=torch.float64) tensor(0.5602, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2361, dtype=torch.float64) delta_t tensor(-0.2526, dtype=torch.float64)
6 gae_duplicate tensor(-1.7015, dtype=torch.float64) tensor(0.8012, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4331, dtype=torch.float64) delta_t tensor(0.6889, dtype=torch.float64)
5 gae_duplicate tensor(-0.6723, dtype=torch.float64) tensor(0.2521, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9024, dtype=torch.float64) delta_t tensor(-0.2567, dtype=torch.float64)
4 gae_duplicate tensor(-0.7946, dtype=torch.float64) tensor(0.3690, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4998, dtype=torch.float64) delta_t tensor(0.6281, dtype=torch.float64)
3 gae_duplicate tensor(-0.0075, dtype=torch.float64) tensor(0.0034, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9024, dtype=torch.float64) delta_t tensor(-0.2350, dtype=torch.float64)
2 gae_duplicate tensor(-0.2411, dtype=torch.float64) tensor(0.0565, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-60.087364196777344
value loss:151.77822875976562
entropies:15.07997989654541
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(345.1823)
ToM Target loss= tensor(312.1041)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.383414030075073 seconds
19 rew tensor(0.7654, dtype=torch.float64) delta_t tensor(-2.0071, dtype=torch.float64)
19 gae_duplicate tensor(-2.0071, dtype=torch.float64) tensor(0.2908, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6322, dtype=torch.float64) delta_t tensor(0.1590, dtype=torch.float64)
18 gae_duplicate tensor(-1.4467, dtype=torch.float64) tensor(0.2096, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4324, dtype=torch.float64) delta_t tensor(0.0358, dtype=torch.float64)
17 gae_duplicate tensor(-1.1215, dtype=torch.float64) tensor(0.1626, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.1673, dtype=torch.float64) delta_t tensor(-0.5732, dtype=torch.float64)
16 gae_duplicate tensor(-1.4705, dtype=torch.float64) tensor(4.6346, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-1.1001, dtype=torch.float64) delta_t tensor(-0.4502, dtype=torch.float64)
15 gae_duplicate tensor(-1.6266, dtype=torch.float64) tensor(0.2378, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(0.6373, dtype=torch.float64)
14 gae_duplicate tensor(-0.6640, dtype=torch.float64) tensor(0.0971, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.6374, dtype=torch.float64)
13 gae_duplicate tensor(0.1062, dtype=torch.float64) tensor(-0.0155, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.6375, dtype=torch.float64)
12 gae_duplicate tensor(0.7225, dtype=torch.float64) tensor(-0.1056, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.6376, dtype=torch.float64)
11 gae_duplicate tensor(1.2156, dtype=torch.float64) tensor(-0.1777, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6992, dtype=torch.float64) delta_t tensor(-0.3395, dtype=torch.float64)
10 gae_duplicate tensor(0.6330, dtype=torch.float64) tensor(-0.0917, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8330, dtype=torch.float64) delta_t tensor(-1.1054, dtype=torch.float64)
9 gae_duplicate tensor(-0.5990, dtype=torch.float64) tensor(0.0867, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8331, dtype=torch.float64) delta_t tensor(-0.6005, dtype=torch.float64)
8 gae_duplicate tensor(-1.0797, dtype=torch.float64) tensor(0.1625, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2327, dtype=torch.float64) delta_t tensor(-0.2023, dtype=torch.float64)
7 gae_duplicate tensor(-1.0661, dtype=torch.float64) tensor(2.6081, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6999, dtype=torch.float64) delta_t tensor(-0.2924, dtype=torch.float64)
6 gae_duplicate tensor(-1.1453, dtype=torch.float64) tensor(0.2395, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8324, dtype=torch.float64) delta_t tensor(0.4637, dtype=torch.float64)
5 gae_duplicate tensor(-0.4525, dtype=torch.float64) tensor(0.1041, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.4306, dtype=torch.float64) delta_t tensor(-5.0234, dtype=torch.float64)
4 gae_duplicate tensor(-5.3854, dtype=torch.float64) tensor(1.1848, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2320, dtype=torch.float64) delta_t tensor(0.9183, dtype=torch.float64)
3 gae_duplicate tensor(-3.3899, dtype=torch.float64) tensor(0.6886, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2320, dtype=torch.float64) delta_t tensor(0.5418, dtype=torch.float64)
2 gae_duplicate tensor(-2.1701, dtype=torch.float64) tensor(0.3914, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-64.58037567138672
value loss:96.63041687011719
entropies:11.15308666229248
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.306192874908447 seconds
19 rew tensor(0.8325, dtype=torch.float64) delta_t tensor(-1.5683, dtype=torch.float64)
19 gae_duplicate tensor(-1.5683, dtype=torch.float64) tensor(0.2303, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7660, dtype=torch.float64) delta_t tensor(0.3073, dtype=torch.float64)
18 gae_duplicate tensor(-0.9473, dtype=torch.float64) tensor(0.1391, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5660, dtype=torch.float64) delta_t tensor(0.0440, dtype=torch.float64)
17 gae_duplicate tensor(-0.7139, dtype=torch.float64) tensor(0.1049, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2328, dtype=torch.float64) delta_t tensor(-0.1215, dtype=torch.float64)
16 gae_duplicate tensor(-0.6926, dtype=torch.float64) tensor(2.1744, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.3005, dtype=torch.float64) delta_t tensor(-0.6432, dtype=torch.float64)
15 gae_duplicate tensor(-1.1973, dtype=torch.float64) tensor(0.1760, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.4636, dtype=torch.float64)
14 gae_duplicate tensor(-0.4942, dtype=torch.float64) tensor(0.0727, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-1.7669, dtype=torch.float64) delta_t tensor(-2.2025, dtype=torch.float64)
13 gae_duplicate tensor(-2.5979, dtype=torch.float64) tensor(0.3819, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7660, dtype=torch.float64) delta_t tensor(0.3452, dtype=torch.float64)
12 gae_duplicate tensor(-1.7331, dtype=torch.float64) tensor(0.2548, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4994, dtype=torch.float64) delta_t tensor(0.3224, dtype=torch.float64)
11 gae_duplicate tensor(-1.0641, dtype=torch.float64) tensor(0.1564, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0328, dtype=torch.float64) delta_t tensor(-0.7233, dtype=torch.float64)
10 gae_duplicate tensor(-1.5745, dtype=torch.float64) tensor(0.2312, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7671, dtype=torch.float64) delta_t tensor(-0.7378, dtype=torch.float64)
9 gae_duplicate tensor(-1.9974, dtype=torch.float64) tensor(0.3006, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7659, dtype=torch.float64) delta_t tensor(0.0104, dtype=torch.float64)
8 gae_duplicate tensor(-1.5876, dtype=torch.float64) tensor(0.2341, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3003, dtype=torch.float64) delta_t tensor(-1.3753, dtype=torch.float64)
7 gae_duplicate tensor(-2.6453, dtype=torch.float64) tensor(0.4197, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6325, dtype=torch.float64) delta_t tensor(0.1911, dtype=torch.float64)
6 gae_duplicate tensor(-1.9252, dtype=torch.float64) tensor(0.2862, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3670, dtype=torch.float64) delta_t tensor(-0.2619, dtype=torch.float64)
5 gae_duplicate tensor(-1.8021, dtype=torch.float64) tensor(0.3052, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7657, dtype=torch.float64) delta_t tensor(1.0001, dtype=torch.float64)
4 gae_duplicate tensor(-0.4415, dtype=torch.float64) tensor(0.0724, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7672, dtype=torch.float64) delta_t tensor(1.5972, dtype=torch.float64)
3 gae_duplicate tensor(1.2439, dtype=torch.float64) tensor(-0.2604, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3674, dtype=torch.float64) delta_t tensor(-1.8982, dtype=torch.float64)
2 gae_duplicate tensor(-0.9031, dtype=torch.float64) tensor(2.3742, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-46.24446105957031
value loss:63.61216735839844
entropies:10.750073432922363
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.294092893600464 seconds
19 rew tensor(0.8326, dtype=torch.float64) delta_t tensor(-1.2933, dtype=torch.float64)
19 gae_duplicate tensor(-1.2933, dtype=torch.float64) tensor(0.1947, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7660, dtype=torch.float64) delta_t tensor(0.3355, dtype=torch.float64)
18 gae_duplicate tensor(-0.6991, dtype=torch.float64) tensor(0.1052, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6327, dtype=torch.float64) delta_t tensor(0.0846, dtype=torch.float64)
17 gae_duplicate tensor(-0.4747, dtype=torch.float64) tensor(0.0714, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2326, dtype=torch.float64) delta_t tensor(-0.0133, dtype=torch.float64)
16 gae_duplicate tensor(-0.3930, dtype=torch.float64) tensor(0.0592, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.2343, dtype=torch.float64) delta_t tensor(-0.4117, dtype=torch.float64)
15 gae_duplicate tensor(-0.7262, dtype=torch.float64) tensor(0.1099, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.5362, dtype=torch.float64)
14 gae_duplicate tensor(-0.0448, dtype=torch.float64) tensor(0.0068, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.5363, dtype=torch.float64)
13 gae_duplicate tensor(0.5005, dtype=torch.float64) tensor(-0.0757, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.5364, dtype=torch.float64)
12 gae_duplicate tensor(0.9368, dtype=torch.float64) tensor(-0.1418, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0995, dtype=torch.float64) delta_t tensor(-0.2607, dtype=torch.float64)
11 gae_duplicate tensor(0.4887, dtype=torch.float64) tensor(-0.0740, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6330, dtype=torch.float64) delta_t tensor(0.1225, dtype=torch.float64)
10 gae_duplicate tensor(0.5135, dtype=torch.float64) tensor(-0.0773, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2330, dtype=torch.float64) delta_t tensor(-0.0489, dtype=torch.float64)
9 gae_duplicate tensor(0.3619, dtype=torch.float64) tensor(-0.0544, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3004, dtype=torch.float64) delta_t tensor(-0.7004, dtype=torch.float64)
8 gae_duplicate tensor(-0.4108, dtype=torch.float64) tensor(0.0618, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9004, dtype=torch.float64) delta_t tensor(-0.6756, dtype=torch.float64)
7 gae_duplicate tensor(-1.0043, dtype=torch.float64) tensor(0.1796, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6328, dtype=torch.float64) delta_t tensor(2.6661, dtype=torch.float64)
6 gae_duplicate tensor(1.8627, dtype=torch.float64) tensor(-0.5329, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.2337, dtype=torch.float64) delta_t tensor(-1.4469, dtype=torch.float64)
5 gae_duplicate tensor(0.0433, dtype=torch.float64) tensor(-0.0452, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7661, dtype=torch.float64) delta_t tensor(-0.1900, dtype=torch.float64)
4 gae_duplicate tensor(-0.1554, dtype=torch.float64) tensor(0.0657, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5010, dtype=torch.float64) delta_t tensor(0.4852, dtype=torch.float64)
3 gae_duplicate tensor(0.3609, dtype=torch.float64) tensor(-0.0902, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0342, dtype=torch.float64) delta_t tensor(-0.5389, dtype=torch.float64)
2 gae_duplicate tensor(-0.2502, dtype=torch.float64) tensor(0.0452, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:0.791512131690979
value loss:14.546768188476562
entropies:12.063515663146973
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.193181753158569 seconds
19 rew tensor(0.3661, dtype=torch.float64) delta_t tensor(-1.8526, dtype=torch.float64)
19 gae_duplicate tensor(-1.8526, dtype=torch.float64) tensor(0.2854, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.3011, dtype=torch.float64) delta_t tensor(-0.5968, dtype=torch.float64)
18 gae_duplicate tensor(-2.0788, dtype=torch.float64) tensor(6.4391, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-1.3020, dtype=torch.float64) delta_t tensor(-0.4038, dtype=torch.float64)
17 gae_duplicate tensor(-2.0668, dtype=torch.float64) tensor(0.3327, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.7481, dtype=torch.float64)
16 gae_duplicate tensor(-0.9054, dtype=torch.float64) tensor(0.1457, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(-0.2854, dtype=torch.float64)
15 gae_duplicate tensor(-1.0097, dtype=torch.float64) tensor(0.1566, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8332, dtype=torch.float64) delta_t tensor(0.4357, dtype=torch.float64)
14 gae_duplicate tensor(-0.3721, dtype=torch.float64) tensor(1.1530, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7666, dtype=torch.float64) delta_t tensor(0.4087, dtype=torch.float64)
13 gae_duplicate tensor(0.1110, dtype=torch.float64) tensor(-0.0173, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6333, dtype=torch.float64) delta_t tensor(-0.4457, dtype=torch.float64)
12 gae_duplicate tensor(-0.3569, dtype=torch.float64) tensor(0.0550, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2330, dtype=torch.float64) delta_t tensor(0.1133, dtype=torch.float64)
11 gae_duplicate tensor(-0.1722, dtype=torch.float64) tensor(0.5335, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3007, dtype=torch.float64) delta_t tensor(-0.3732, dtype=torch.float64)
10 gae_duplicate tensor(-0.5110, dtype=torch.float64) tensor(0.0786, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8334, dtype=torch.float64) delta_t tensor(0.1026, dtype=torch.float64)
9 gae_duplicate tensor(-0.3062, dtype=torch.float64) tensor(0.0472, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6341, dtype=torch.float64) delta_t tensor(-0.5289, dtype=torch.float64)
8 gae_duplicate tensor(-0.7739, dtype=torch.float64) tensor(0.1254, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0338, dtype=torch.float64) delta_t tensor(-0.6470, dtype=torch.float64)
7 gae_duplicate tensor(-1.2661, dtype=torch.float64) tensor(0.1953, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2345, dtype=torch.float64) delta_t tensor(-0.1305, dtype=torch.float64)
6 gae_duplicate tensor(-1.1434, dtype=torch.float64) tensor(0.2430, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1661, dtype=torch.float64) delta_t tensor(-0.3417, dtype=torch.float64)
5 gae_duplicate tensor(-1.2565, dtype=torch.float64) tensor(0.1969, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9683, dtype=torch.float64) delta_t tensor(0.5331, dtype=torch.float64)
4 gae_duplicate tensor(-0.4721, dtype=torch.float64) tensor(0.2194, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3018, dtype=torch.float64) delta_t tensor(-0.5454, dtype=torch.float64)
3 gae_duplicate tensor(-0.9231, dtype=torch.float64) tensor(4.4186, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1679, dtype=torch.float64) delta_t tensor(-1.8557, dtype=torch.float64)
2 gae_duplicate tensor(-2.5942, dtype=torch.float64) tensor(0.4891, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-90.9346923828125
value loss:41.129600524902344
entropies:11.705244064331055
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.603442907333374 seconds
19 rew tensor(0.7002, dtype=torch.float64) delta_t tensor(-1.4940, dtype=torch.float64)
19 gae_duplicate tensor(-1.4940, dtype=torch.float64) tensor(4.6148, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7003, dtype=torch.float64) delta_t tensor(0.2274, dtype=torch.float64)
18 gae_duplicate tensor(-0.9678, dtype=torch.float64) tensor(0.1506, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5001, dtype=torch.float64) delta_t tensor(0.1338, dtype=torch.float64)
17 gae_duplicate tensor(-0.6404, dtype=torch.float64) tensor(0.0997, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.0340, dtype=torch.float64) delta_t tensor(-0.3202, dtype=torch.float64)
16 gae_duplicate tensor(-0.8325, dtype=torch.float64) tensor(2.5718, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7683, dtype=torch.float64) delta_t tensor(-0.8385, dtype=torch.float64)
15 gae_duplicate tensor(-1.5045, dtype=torch.float64) tensor(0.2363, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.5656, dtype=torch.float64)
14 gae_duplicate tensor(-0.6381, dtype=torch.float64) tensor(0.1002, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.5657, dtype=torch.float64)
13 gae_duplicate tensor(0.0552, dtype=torch.float64) tensor(-0.0087, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4343, dtype=torch.float64) delta_t tensor(-0.7692, dtype=torch.float64)
12 gae_duplicate tensor(-0.7250, dtype=torch.float64) tensor(0.1139, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-2.4368, dtype=torch.float64) delta_t tensor(-2.7717, dtype=torch.float64)
11 gae_duplicate tensor(-3.3517, dtype=torch.float64) tensor(0.5264, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7670, dtype=torch.float64) delta_t tensor(0.1499, dtype=torch.float64)
10 gae_duplicate tensor(-2.5315, dtype=torch.float64) tensor(0.3940, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3665, dtype=torch.float64) delta_t tensor(-0.0677, dtype=torch.float64)
9 gae_duplicate tensor(-2.0928, dtype=torch.float64) tensor(0.3255, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0327, dtype=torch.float64) delta_t tensor(0.0169, dtype=torch.float64)
8 gae_duplicate tensor(-1.6573, dtype=torch.float64) tensor(0.2577, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7670, dtype=torch.float64) delta_t tensor(0.1518, dtype=torch.float64)
7 gae_duplicate tensor(-1.1741, dtype=torch.float64) tensor(0.1830, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5680, dtype=torch.float64) delta_t tensor(-0.4351, dtype=torch.float64)
6 gae_duplicate tensor(-1.3744, dtype=torch.float64) tensor(0.2309, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4332, dtype=torch.float64) delta_t tensor(0.4245, dtype=torch.float64)
5 gae_duplicate tensor(-0.6750, dtype=torch.float64) tensor(0.1115, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2342, dtype=torch.float64) delta_t tensor(1.9326, dtype=torch.float64)
4 gae_duplicate tensor(1.3926, dtype=torch.float64) tensor(-0.4339, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1007, dtype=torch.float64) delta_t tensor(-0.1820, dtype=torch.float64)
3 gae_duplicate tensor(0.9321, dtype=torch.float64) tensor(-1.4634, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7682, dtype=torch.float64) delta_t tensor(0.0764, dtype=torch.float64)
2 gae_duplicate tensor(0.8221, dtype=torch.float64) tensor(-0.1803, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-47.32955551147461
value loss:59.170684814453125
entropies:11.654768943786621
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(373.9835)
ToM Target loss= tensor(312.2812)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.518527030944824 seconds
19 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(-1.5131, dtype=torch.float64)
19 gae_duplicate tensor(-1.5131, dtype=torch.float64) tensor(0.2390, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.4558, dtype=torch.float64)
18 gae_duplicate tensor(-0.7547, dtype=torch.float64) tensor(0.1192, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.7321, dtype=torch.float64)
17 gae_duplicate tensor(0.1284, dtype=torch.float64) tensor(-0.3950, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(1.8724, dtype=torch.float64)
16 gae_duplicate tensor(1.9751, dtype=torch.float64) tensor(-0.3151, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.7642, dtype=torch.float64)
15 gae_duplicate tensor(2.3443, dtype=torch.float64) tensor(-7.1466, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(0.7643, dtype=torch.float64)
14 gae_duplicate tensor(2.6397, dtype=torch.float64) tensor(-0.4211, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6342, dtype=torch.float64) delta_t tensor(0.6963, dtype=torch.float64)
13 gae_duplicate tensor(2.8081, dtype=torch.float64) tensor(-0.4487, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5008, dtype=torch.float64) delta_t tensor(0.8331, dtype=torch.float64)
12 gae_duplicate tensor(3.0796, dtype=torch.float64) tensor(-0.4934, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5009, dtype=torch.float64) delta_t tensor(-1.4352, dtype=torch.float64)
11 gae_duplicate tensor(1.0285, dtype=torch.float64) tensor(-0.1636, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2340, dtype=torch.float64) delta_t tensor(0.1778, dtype=torch.float64)
10 gae_duplicate tensor(1.0006, dtype=torch.float64) tensor(-0.1595, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3008, dtype=torch.float64) delta_t tensor(0.0647, dtype=torch.float64)
9 gae_duplicate tensor(0.8652, dtype=torch.float64) tensor(-0.1382, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.1677, dtype=torch.float64) delta_t tensor(-2.5432, dtype=torch.float64)
8 gae_duplicate tensor(-1.8511, dtype=torch.float64) tensor(0.3150, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0341, dtype=torch.float64) delta_t tensor(-1.8883, dtype=torch.float64)
7 gae_duplicate tensor(-3.3692, dtype=torch.float64) tensor(10.3143, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9008, dtype=torch.float64) delta_t tensor(-0.7491, dtype=torch.float64)
6 gae_duplicate tensor(-3.4444, dtype=torch.float64) tensor(0.5458, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.7027, dtype=torch.float64) delta_t tensor(-1.5050, dtype=torch.float64)
5 gae_duplicate tensor(-4.2605, dtype=torch.float64) tensor(0.6815, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4372, dtype=torch.float64) delta_t tensor(-0.6833, dtype=torch.float64)
4 gae_duplicate tensor(-4.0917, dtype=torch.float64) tensor(0.9210, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2345, dtype=torch.float64) delta_t tensor(0.8885, dtype=torch.float64)
3 gae_duplicate tensor(-2.3849, dtype=torch.float64) tensor(4.5894, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1677, dtype=torch.float64) delta_t tensor(0.3232, dtype=torch.float64)
2 gae_duplicate tensor(-1.5847, dtype=torch.float64) tensor(0.3579, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-50.75859451293945
value loss:163.729736328125
entropies:11.543737411499023
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.554472923278809 seconds
19 rew tensor(0.7002, dtype=torch.float64) delta_t tensor(-1.2409, dtype=torch.float64)
19 gae_duplicate tensor(-1.2409, dtype=torch.float64) tensor(3.8058, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7002, dtype=torch.float64) delta_t tensor(0.2926, dtype=torch.float64)
18 gae_duplicate tensor(-0.7001, dtype=torch.float64) tensor(0.1117, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4335, dtype=torch.float64) delta_t tensor(-0.1563, dtype=torch.float64)
17 gae_duplicate tensor(-0.7164, dtype=torch.float64) tensor(0.1143, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.0333, dtype=torch.float64) delta_t tensor(-0.2216, dtype=torch.float64)
16 gae_duplicate tensor(-0.7947, dtype=torch.float64) tensor(2.4374, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.9003, dtype=torch.float64) delta_t tensor(-0.9082, dtype=torch.float64)
15 gae_duplicate tensor(-1.5439, dtype=torch.float64) tensor(4.7372, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.5923, dtype=torch.float64)
14 gae_duplicate tensor(-0.6429, dtype=torch.float64) tensor(0.1033, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.5924, dtype=torch.float64)
13 gae_duplicate tensor(0.0781, dtype=torch.float64) tensor(-0.0125, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.5925, dtype=torch.float64)
12 gae_duplicate tensor(0.6550, dtype=torch.float64) tensor(-0.1052, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-4.5678, dtype=torch.float64) delta_t tensor(-4.8499, dtype=torch.float64)
11 gae_duplicate tensor(-4.3259, dtype=torch.float64) tensor(0.6966, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0337, dtype=torch.float64) delta_t tensor(-0.5620, dtype=torch.float64)
10 gae_duplicate tensor(-4.0228, dtype=torch.float64) tensor(0.6417, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5005, dtype=torch.float64) delta_t tensor(0.8865, dtype=torch.float64)
9 gae_duplicate tensor(-2.3317, dtype=torch.float64) tensor(0.4617, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3008, dtype=torch.float64) delta_t tensor(-0.6457, dtype=torch.float64)
8 gae_duplicate tensor(-2.5111, dtype=torch.float64) tensor(3.7331, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7675, dtype=torch.float64) delta_t tensor(0.4632, dtype=torch.float64)
7 gae_duplicate tensor(-1.5456, dtype=torch.float64) tensor(0.5358, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3007, dtype=torch.float64) delta_t tensor(0.8654, dtype=torch.float64)
6 gae_duplicate tensor(-0.3711, dtype=torch.float64) tensor(0.1776, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3002, dtype=torch.float64) delta_t tensor(0.5704, dtype=torch.float64)
5 gae_duplicate tensor(0.2735, dtype=torch.float64) tensor(-0.1124, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1671, dtype=torch.float64) delta_t tensor(0.2820, dtype=torch.float64)
4 gae_duplicate tensor(0.5009, dtype=torch.float64) tensor(-0.2339, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0336, dtype=torch.float64) delta_t tensor(0.4548, dtype=torch.float64)
3 gae_duplicate tensor(0.8555, dtype=torch.float64) tensor(-0.3177, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5676, dtype=torch.float64) delta_t tensor(0.1430, dtype=torch.float64)
2 gae_duplicate tensor(0.8274, dtype=torch.float64) tensor(-0.1850, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-99.94180297851562
value loss:85.97169494628906
entropies:13.472057342529297
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.499109268188477 seconds
19 rew tensor(0.8982, dtype=torch.float64) delta_t tensor(-1.3177, dtype=torch.float64)
19 gae_duplicate tensor(-1.3177, dtype=torch.float64) tensor(0.2110, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8983, dtype=torch.float64) delta_t tensor(0.8708, dtype=torch.float64)
18 gae_duplicate tensor(-0.1833, dtype=torch.float64) tensor(0.0294, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.2021, dtype=torch.float64)
17 gae_duplicate tensor(0.0554, dtype=torch.float64) tensor(-0.0089, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(1.0149, dtype=torch.float64)
16 gae_duplicate tensor(1.0592, dtype=torch.float64) tensor(-0.1696, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(1.7308, dtype=torch.float64)
15 gae_duplicate tensor(2.5782, dtype=torch.float64) tensor(-0.4170, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.8103, dtype=torch.float64)
14 gae_duplicate tensor(2.8729, dtype=torch.float64) tensor(-0.4646, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.8105, dtype=torch.float64)
13 gae_duplicate tensor(3.1088, dtype=torch.float64) tensor(-0.5028, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.8106, dtype=torch.float64)
12 gae_duplicate tensor(3.2976, dtype=torch.float64) tensor(-0.5333, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(2.2793, dtype=torch.float64)
11 gae_duplicate tensor(4.9174, dtype=torch.float64) tensor(-0.9946, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(-1.0256, dtype=torch.float64)
10 gae_duplicate tensor(2.9083, dtype=torch.float64) tensor(-5.4670, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.7363, dtype=torch.float64)
9 gae_duplicate tensor(3.0630, dtype=torch.float64) tensor(-9.5738, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8307, dtype=torch.float64) delta_t tensor(-0.8876, dtype=torch.float64)
8 gae_duplicate tensor(1.5628, dtype=torch.float64) tensor(-0.3263, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2984, dtype=torch.float64) delta_t tensor(-0.4645, dtype=torch.float64)
7 gae_duplicate tensor(0.7857, dtype=torch.float64) tensor(-0.1673, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3630, dtype=torch.float64) delta_t tensor(-0.8566, dtype=torch.float64)
6 gae_duplicate tensor(-0.2280, dtype=torch.float64) tensor(0.0514, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7626, dtype=torch.float64) delta_t tensor(0.6342, dtype=torch.float64)
5 gae_duplicate tensor(0.4518, dtype=torch.float64) tensor(-0.1098, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-6.0889, dtype=torch.float64) delta_t tensor(-5.5710, dtype=torch.float64)
4 gae_duplicate tensor(-5.2096, dtype=torch.float64) tensor(1.2126, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2332, dtype=torch.float64) delta_t tensor(1.0139, dtype=torch.float64)
3 gae_duplicate tensor(-3.1538, dtype=torch.float64) tensor(0.6802, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2332, dtype=torch.float64) delta_t tensor(0.6261, dtype=torch.float64)
2 gae_duplicate tensor(-1.8970, dtype=torch.float64) tensor(0.3657, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:96.7326431274414
value loss:186.53273010253906
entropies:12.468059539794922
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.052018880844116 seconds
19 rew tensor(0.8970, dtype=torch.float64) delta_t tensor(2.2605, dtype=torch.float64)
19 gae_duplicate tensor(2.2605, dtype=torch.float64) tensor(-5.4826, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8307, dtype=torch.float64) delta_t tensor(-1.9712, dtype=torch.float64)
18 gae_duplicate tensor(-0.1628, dtype=torch.float64) tensor(0.4976, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8308, dtype=torch.float64) delta_t tensor(0.6496, dtype=torch.float64)
17 gae_duplicate tensor(0.5193, dtype=torch.float64) tensor(-1.5875, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8973, dtype=torch.float64) delta_t tensor(0.5873, dtype=torch.float64)
16 gae_duplicate tensor(1.0028, dtype=torch.float64) tensor(-0.1619, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8975, dtype=torch.float64) delta_t tensor(0.5874, dtype=torch.float64)
15 gae_duplicate tensor(1.3897, dtype=torch.float64) tensor(-0.2244, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8976, dtype=torch.float64) delta_t tensor(0.5876, dtype=torch.float64)
14 gae_duplicate tensor(1.6993, dtype=torch.float64) tensor(-0.2744, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8977, dtype=torch.float64) delta_t tensor(0.5877, dtype=torch.float64)
13 gae_duplicate tensor(1.9471, dtype=torch.float64) tensor(-0.3144, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8978, dtype=torch.float64) delta_t tensor(0.5878, dtype=torch.float64)
12 gae_duplicate tensor(2.1455, dtype=torch.float64) tensor(-0.3465, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8979, dtype=torch.float64) delta_t tensor(0.5879, dtype=torch.float64)
11 gae_duplicate tensor(2.3043, dtype=torch.float64) tensor(-0.3721, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2334, dtype=torch.float64) delta_t tensor(-0.0766, dtype=torch.float64)
10 gae_duplicate tensor(1.7668, dtype=torch.float64) tensor(-0.2853, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-5.2162, dtype=torch.float64) delta_t tensor(-5.3324, dtype=torch.float64)
9 gae_duplicate tensor(-3.9189, dtype=torch.float64) tensor(0.6330, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9654, dtype=torch.float64) delta_t tensor(-1.3611, dtype=torch.float64)
8 gae_duplicate tensor(-4.4962, dtype=torch.float64) tensor(0.7267, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0999, dtype=torch.float64) delta_t tensor(0.0672, dtype=torch.float64)
7 gae_duplicate tensor(-3.5298, dtype=torch.float64) tensor(0.6057, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6990, dtype=torch.float64) delta_t tensor(0.5218, dtype=torch.float64)
6 gae_duplicate tensor(-2.3020, dtype=torch.float64) tensor(0.3926, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5659, dtype=torch.float64) delta_t tensor(1.9205, dtype=torch.float64)
5 gae_duplicate tensor(0.0789, dtype=torch.float64) tensor(-0.2536, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2995, dtype=torch.float64) delta_t tensor(-0.6829, dtype=torch.float64)
4 gae_duplicate tensor(-0.6197, dtype=torch.float64) tensor(0.8134, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4327, dtype=torch.float64) delta_t tensor(1.9431, dtype=torch.float64)
3 gae_duplicate tensor(1.4473, dtype=torch.float64) tensor(-0.5161, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4993, dtype=torch.float64) delta_t tensor(-0.4640, dtype=torch.float64)
2 gae_duplicate tensor(0.6938, dtype=torch.float64) tensor(-2.1629, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:49.50482940673828
value loss:126.53207397460938
entropies:12.412418365478516
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.342162847518921 seconds
19 rew tensor(0.8970, dtype=torch.float64) delta_t tensor(-0.8413, dtype=torch.float64)
19 gae_duplicate tensor(-0.8413, dtype=torch.float64) tensor(0.1379, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8971, dtype=torch.float64) delta_t tensor(0.5368, dtype=torch.float64)
18 gae_duplicate tensor(-0.1363, dtype=torch.float64) tensor(0.0223, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8972, dtype=torch.float64) delta_t tensor(0.6016, dtype=torch.float64)
17 gae_duplicate tensor(0.4926, dtype=torch.float64) tensor(-0.0807, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8973, dtype=torch.float64) delta_t tensor(0.7176, dtype=torch.float64)
16 gae_duplicate tensor(1.1117, dtype=torch.float64) tensor(-0.1822, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8974, dtype=torch.float64) delta_t tensor(1.1094, dtype=torch.float64)
15 gae_duplicate tensor(1.9987, dtype=torch.float64) tensor(-0.3309, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8976, dtype=torch.float64) delta_t tensor(0.6941, dtype=torch.float64)
14 gae_duplicate tensor(2.2930, dtype=torch.float64) tensor(-6.9102, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8977, dtype=torch.float64) delta_t tensor(0.6942, dtype=torch.float64)
13 gae_duplicate tensor(2.5286, dtype=torch.float64) tensor(-0.4187, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8978, dtype=torch.float64) delta_t tensor(0.6943, dtype=torch.float64)
12 gae_duplicate tensor(2.7172, dtype=torch.float64) tensor(-0.4499, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8979, dtype=torch.float64) delta_t tensor(0.6944, dtype=torch.float64)
11 gae_duplicate tensor(2.8681, dtype=torch.float64) tensor(-0.4749, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.2294, dtype=torch.float64) delta_t tensor(-1.9667, dtype=torch.float64)
10 gae_duplicate tensor(0.3278, dtype=torch.float64) tensor(-0.0537, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7642, dtype=torch.float64) delta_t tensor(-1.0744, dtype=torch.float64)
9 gae_duplicate tensor(-0.8122, dtype=torch.float64) tensor(0.1332, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6951, dtype=torch.float64) delta_t tensor(-1.6752, dtype=torch.float64)
8 gae_duplicate tensor(-2.3249, dtype=torch.float64) tensor(0.3862, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7646, dtype=torch.float64) delta_t tensor(0.3625, dtype=torch.float64)
7 gae_duplicate tensor(-1.4974, dtype=torch.float64) tensor(0.2458, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9640, dtype=torch.float64) delta_t tensor(-0.4881, dtype=torch.float64)
6 gae_duplicate tensor(-1.6860, dtype=torch.float64) tensor(0.3127, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4321, dtype=torch.float64) delta_t tensor(0.1914, dtype=torch.float64)
5 gae_duplicate tensor(-1.1574, dtype=torch.float64) tensor(0.1980, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6316, dtype=torch.float64) delta_t tensor(0.9103, dtype=torch.float64)
4 gae_duplicate tensor(-0.0156, dtype=torch.float64) tensor(0.0028, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3656, dtype=torch.float64) delta_t tensor(0.8820, dtype=torch.float64)
3 gae_duplicate tensor(0.8696, dtype=torch.float64) tensor(-0.1441, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6980, dtype=torch.float64) delta_t tensor(0.3953, dtype=torch.float64)
2 gae_duplicate tensor(1.0910, dtype=torch.float64) tensor(-0.1890, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:46.429954528808594
value loss:72.00624084472656
entropies:11.39865493774414
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(365.9992)
ToM Target loss= tensor(311.8438)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.556071758270264 seconds
19 rew tensor(0.8968, dtype=torch.float64) delta_t tensor(-0.6929, dtype=torch.float64)
19 gae_duplicate tensor(-0.6929, dtype=torch.float64) tensor(0.1165, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8969, dtype=torch.float64) delta_t tensor(0.5790, dtype=torch.float64)
18 gae_duplicate tensor(0.0246, dtype=torch.float64) tensor(-0.0041, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8970, dtype=torch.float64) delta_t tensor(0.5791, dtype=torch.float64)
17 gae_duplicate tensor(0.5988, dtype=torch.float64) tensor(-0.1006, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8972, dtype=torch.float64) delta_t tensor(0.5792, dtype=torch.float64)
16 gae_duplicate tensor(1.0583, dtype=torch.float64) tensor(-0.1778, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8973, dtype=torch.float64) delta_t tensor(0.5793, dtype=torch.float64)
15 gae_duplicate tensor(1.4259, dtype=torch.float64) tensor(-0.2396, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8974, dtype=torch.float64) delta_t tensor(0.5794, dtype=torch.float64)
14 gae_duplicate tensor(1.7202, dtype=torch.float64) tensor(-0.2891, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2325, dtype=torch.float64) delta_t tensor(-0.0854, dtype=torch.float64)
13 gae_duplicate tensor(1.2907, dtype=torch.float64) tensor(-0.2169, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-3.0920, dtype=torch.float64) delta_t tensor(-3.4100, dtype=torch.float64)
12 gae_duplicate tensor(-2.3774, dtype=torch.float64) tensor(0.3995, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0992, dtype=torch.float64) delta_t tensor(-0.2105, dtype=torch.float64)
11 gae_duplicate tensor(-2.1124, dtype=torch.float64) tensor(0.3551, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6314, dtype=torch.float64) delta_t tensor(0.5378, dtype=torch.float64)
10 gae_duplicate tensor(-1.1521, dtype=torch.float64) tensor(0.1937, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8311, dtype=torch.float64) delta_t tensor(0.3521, dtype=torch.float64)
9 gae_duplicate tensor(-0.5696, dtype=torch.float64) tensor(0.0958, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4993, dtype=torch.float64) delta_t tensor(-0.3999, dtype=torch.float64)
8 gae_duplicate tensor(-0.8556, dtype=torch.float64) tensor(0.1469, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7645, dtype=torch.float64) delta_t tensor(0.4076, dtype=torch.float64)
7 gae_duplicate tensor(-0.2768, dtype=torch.float64) tensor(0.0466, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2997, dtype=torch.float64) delta_t tensor(-0.1734, dtype=torch.float64)
6 gae_duplicate tensor(-0.3949, dtype=torch.float64) tensor(0.0758, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2324, dtype=torch.float64) delta_t tensor(0.3283, dtype=torch.float64)
5 gae_duplicate tensor(0.0124, dtype=torch.float64) tensor(-0.0375, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1666, dtype=torch.float64) delta_t tensor(1.5858, dtype=torch.float64)
4 gae_duplicate tensor(1.5957, dtype=torch.float64) tensor(-0.4705, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1001, dtype=torch.float64) delta_t tensor(0.2792, dtype=torch.float64)
3 gae_duplicate tensor(1.5557, dtype=torch.float64) tensor(-2.4405, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5656, dtype=torch.float64) delta_t tensor(0.1485, dtype=torch.float64)
2 gae_duplicate tensor(1.3931, dtype=torch.float64) tensor(-0.3164, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:16.814638137817383
value loss:42.38315200805664
entropies:12.209646224975586
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5811638832092285 seconds
19 rew tensor(0.6978, dtype=torch.float64) delta_t tensor(-0.8680, dtype=torch.float64)
19 gae_duplicate tensor(-0.8680, dtype=torch.float64) tensor(2.6527, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6979, dtype=torch.float64) delta_t tensor(0.4548, dtype=torch.float64)
18 gae_duplicate tensor(-0.2396, dtype=torch.float64) tensor(0.0535, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4984, dtype=torch.float64) delta_t tensor(-0.0164, dtype=torch.float64)
17 gae_duplicate tensor(-0.2080, dtype=torch.float64) tensor(0.0497, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0329, dtype=torch.float64) delta_t tensor(0.0237, dtype=torch.float64)
16 gae_duplicate tensor(-0.1427, dtype=torch.float64) tensor(0.0402, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.6987, dtype=torch.float64) delta_t tensor(0.8545, dtype=torch.float64)
15 gae_duplicate tensor(0.7403, dtype=torch.float64) tensor(-0.2552, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8973, dtype=torch.float64) delta_t tensor(0.9874, dtype=torch.float64)
14 gae_duplicate tensor(1.5796, dtype=torch.float64) tensor(-0.5446, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8974, dtype=torch.float64) delta_t tensor(0.9875, dtype=torch.float64)
13 gae_duplicate tensor(2.2512, dtype=torch.float64) tensor(-0.7762, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8975, dtype=torch.float64) delta_t tensor(0.9876, dtype=torch.float64)
12 gae_duplicate tensor(2.7886, dtype=torch.float64) tensor(-0.9615, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.7623, dtype=torch.float64) delta_t tensor(-1.6722, dtype=torch.float64)
11 gae_duplicate tensor(0.5587, dtype=torch.float64) tensor(-0.1926, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7645, dtype=torch.float64) delta_t tensor(-0.9362, dtype=torch.float64)
10 gae_duplicate tensor(-0.4893, dtype=torch.float64) tensor(0.1392, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4321, dtype=torch.float64) delta_t tensor(0.3526, dtype=torch.float64)
9 gae_duplicate tensor(-0.0388, dtype=torch.float64) tensor(0.0153, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0334, dtype=torch.float64) delta_t tensor(-0.1780, dtype=torch.float64)
8 gae_duplicate tensor(-0.2090, dtype=torch.float64) tensor(0.0619, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7649, dtype=torch.float64) delta_t tensor(-0.4063, dtype=torch.float64)
7 gae_duplicate tensor(-0.5736, dtype=torch.float64) tensor(0.3311, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6979, dtype=torch.float64) delta_t tensor(1.3836, dtype=torch.float64)
6 gae_duplicate tensor(0.9248, dtype=torch.float64) tensor(-0.4077, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6293, dtype=torch.float64) delta_t tensor(-0.1883, dtype=torch.float64)
5 gae_duplicate tensor(0.5515, dtype=torch.float64) tensor(-0.3369, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2997, dtype=torch.float64) delta_t tensor(0.3437, dtype=torch.float64)
4 gae_duplicate tensor(0.7849, dtype=torch.float64) tensor(-0.2649, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.0286, dtype=torch.float64) delta_t tensor(-1.1742, dtype=torch.float64)
3 gae_duplicate tensor(-0.5464, dtype=torch.float64) tensor(0.3138, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5661, dtype=torch.float64) delta_t tensor(-0.4612, dtype=torch.float64)
2 gae_duplicate tensor(-0.8983, dtype=torch.float64) tensor(2.7501, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-16.504108428955078
value loss:30.853195190429688
entropies:16.599435806274414
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.414391994476318 seconds
19 rew tensor(0.8312, dtype=torch.float64) delta_t tensor(-0.3028, dtype=torch.float64)
19 gae_duplicate tensor(-0.3028, dtype=torch.float64) tensor(0.0533, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6982, dtype=torch.float64) delta_t tensor(0.5484, dtype=torch.float64)
18 gae_duplicate tensor(0.3061, dtype=torch.float64) tensor(-0.0539, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5652, dtype=torch.float64) delta_t tensor(-0.2288, dtype=torch.float64)
17 gae_duplicate tensor(0.0161, dtype=torch.float64) tensor(-0.0028, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1660, dtype=torch.float64) delta_t tensor(-0.1196, dtype=torch.float64)
16 gae_duplicate tensor(-0.1068, dtype=torch.float64) tensor(0.3174, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.2997, dtype=torch.float64) delta_t tensor(-0.3821, dtype=torch.float64)
15 gae_duplicate tensor(-0.4675, dtype=torch.float64) tensor(1.3864, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8978, dtype=torch.float64) delta_t tensor(0.0647, dtype=torch.float64)
14 gae_duplicate tensor(-0.3094, dtype=torch.float64) tensor(0.0549, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8314, dtype=torch.float64) delta_t tensor(0.4540, dtype=torch.float64)
13 gae_duplicate tensor(0.2065, dtype=torch.float64) tensor(-0.6186, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8981, dtype=torch.float64) delta_t tensor(0.5151, dtype=torch.float64)
12 gae_duplicate tensor(0.6803, dtype=torch.float64) tensor(-0.1207, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5655, dtype=torch.float64) delta_t tensor(-0.8787, dtype=torch.float64)
11 gae_duplicate tensor(-0.3344, dtype=torch.float64) tensor(0.0593, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6319, dtype=torch.float64) delta_t tensor(0.9264, dtype=torch.float64)
10 gae_duplicate tensor(0.6589, dtype=torch.float64) tensor(-0.1159, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4324, dtype=torch.float64) delta_t tensor(0.4149, dtype=torch.float64)
9 gae_duplicate tensor(0.9420, dtype=torch.float64) tensor(-0.1661, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0333, dtype=torch.float64) delta_t tensor(0.1196, dtype=torch.float64)
8 gae_duplicate tensor(0.8732, dtype=torch.float64) tensor(-0.1542, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3658, dtype=torch.float64) delta_t tensor(-0.1168, dtype=torch.float64)
7 gae_duplicate tensor(0.5818, dtype=torch.float64) tensor(-0.2082, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6319, dtype=torch.float64) delta_t tensor(-0.0039, dtype=torch.float64)
6 gae_duplicate tensor(0.4615, dtype=torch.float64) tensor(-1.3789, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5629, dtype=torch.float64) delta_t tensor(-0.2958, dtype=torch.float64)
5 gae_duplicate tensor(0.0734, dtype=torch.float64) tensor(-0.0161, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2994, dtype=torch.float64) delta_t tensor(0.0578, dtype=torch.float64)
4 gae_duplicate tensor(0.1165, dtype=torch.float64) tensor(-0.0205, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.0953, dtype=torch.float64) delta_t tensor(0.1607, dtype=torch.float64)
3 gae_duplicate tensor(0.2540, dtype=torch.float64) tensor(-0.0446, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4994, dtype=torch.float64) delta_t tensor(-1.5568, dtype=torch.float64)
2 gae_duplicate tensor(-1.3537, dtype=torch.float64) tensor(4.0512, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-18.49733543395996
value loss:8.519970893859863
entropies:12.215473175048828
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.274922847747803 seconds
19 rew tensor(0.8978, dtype=torch.float64) delta_t tensor(-0.6284, dtype=torch.float64)
19 gae_duplicate tensor(-0.6284, dtype=torch.float64) tensor(1.8819, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8979, dtype=torch.float64) delta_t tensor(0.5927, dtype=torch.float64)
18 gae_duplicate tensor(0.0899, dtype=torch.float64) tensor(-0.0158, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8980, dtype=torch.float64) delta_t tensor(0.5928, dtype=torch.float64)
17 gae_duplicate tensor(0.6647, dtype=torch.float64) tensor(-0.1165, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8981, dtype=torch.float64) delta_t tensor(0.5929, dtype=torch.float64)
16 gae_duplicate tensor(1.1247, dtype=torch.float64) tensor(-3.3392, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8982, dtype=torch.float64) delta_t tensor(0.5930, dtype=torch.float64)
15 gae_duplicate tensor(1.4927, dtype=torch.float64) tensor(-0.2615, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.8491, dtype=torch.float64)
14 gae_duplicate tensor(2.0433, dtype=torch.float64) tensor(-0.4446, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8319, dtype=torch.float64) delta_t tensor(0.1324, dtype=torch.float64)
13 gae_duplicate tensor(1.7670, dtype=torch.float64) tensor(-10.2724, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(0.5554, dtype=torch.float64)
12 gae_duplicate tensor(1.9690, dtype=torch.float64) tensor(-0.3421, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2331, dtype=torch.float64) delta_t tensor(-0.1101, dtype=torch.float64)
11 gae_duplicate tensor(1.4651, dtype=torch.float64) tensor(-0.2545, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7655, dtype=torch.float64) delta_t tensor(0.4226, dtype=torch.float64)
10 gae_duplicate tensor(1.5947, dtype=torch.float64) tensor(-0.2771, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6325, dtype=torch.float64) delta_t tensor(0.4422, dtype=torch.float64)
9 gae_duplicate tensor(1.7180, dtype=torch.float64) tensor(-0.2985, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2332, dtype=torch.float64) delta_t tensor(-0.0358, dtype=torch.float64)
8 gae_duplicate tensor(1.3386, dtype=torch.float64) tensor(-0.2326, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2991, dtype=torch.float64) delta_t tensor(-1.0984, dtype=torch.float64)
7 gae_duplicate tensor(-0.0275, dtype=torch.float64) tensor(0.0048, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9646, dtype=torch.float64) delta_t tensor(0.7395, dtype=torch.float64)
6 gae_duplicate tensor(0.7175, dtype=torch.float64) tensor(-0.2035, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4305, dtype=torch.float64) delta_t tensor(-0.2433, dtype=torch.float64)
5 gae_duplicate tensor(0.3307, dtype=torch.float64) tensor(-1.0550, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4992, dtype=torch.float64) delta_t tensor(0.7977, dtype=torch.float64)
4 gae_duplicate tensor(1.0623, dtype=torch.float64) tensor(-1.7513, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8967, dtype=torch.float64) delta_t tensor(-1.3417, dtype=torch.float64)
3 gae_duplicate tensor(-0.4919, dtype=torch.float64) tensor(0.3824, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7658, dtype=torch.float64) delta_t tensor(-0.3722, dtype=torch.float64)
2 gae_duplicate tensor(-0.7657, dtype=torch.float64) tensor(4.5158, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:72.07887268066406
value loss:41.29094314575195
entropies:13.304611206054688
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.524510145187378 seconds
19 rew tensor(0.7651, dtype=torch.float64) delta_t tensor(-0.5345, dtype=torch.float64)
19 gae_duplicate tensor(-0.5345, dtype=torch.float64) tensor(0.0943, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6320, dtype=torch.float64) delta_t tensor(0.4130, dtype=torch.float64)
18 gae_duplicate tensor(-0.0146, dtype=torch.float64) tensor(0.0436, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4989, dtype=torch.float64) delta_t tensor(0.3703, dtype=torch.float64)
17 gae_duplicate tensor(0.3586, dtype=torch.float64) tensor(-0.0632, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0329, dtype=torch.float64) delta_t tensor(-0.1785, dtype=torch.float64)
16 gae_duplicate tensor(0.1084, dtype=torch.float64) tensor(-0.3247, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.6993, dtype=torch.float64) delta_t tensor(-1.4361, dtype=torch.float64)
15 gae_duplicate tensor(-1.3493, dtype=torch.float64) tensor(0.2394, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8982, dtype=torch.float64) delta_t tensor(0.5717, dtype=torch.float64)
14 gae_duplicate tensor(-0.5077, dtype=torch.float64) tensor(0.0901, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8983, dtype=torch.float64) delta_t tensor(0.5718, dtype=torch.float64)
13 gae_duplicate tensor(0.1656, dtype=torch.float64) tensor(-0.0294, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-3.0955, dtype=torch.float64) delta_t tensor(-3.4220, dtype=torch.float64)
12 gae_duplicate tensor(-3.2895, dtype=torch.float64) tensor(18.9278, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.2328, dtype=torch.float64) delta_t tensor(0.0721, dtype=torch.float64)
11 gae_duplicate tensor(-2.5595, dtype=torch.float64) tensor(6.3691, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1007, dtype=torch.float64) delta_t tensor(-1.4427, dtype=torch.float64)
10 gae_duplicate tensor(-3.4904, dtype=torch.float64) tensor(10.4444, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2989, dtype=torch.float64) delta_t tensor(0.3168, dtype=torch.float64)
9 gae_duplicate tensor(-2.4755, dtype=torch.float64) tensor(0.4312, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7651, dtype=torch.float64) delta_t tensor(0.4060, dtype=torch.float64)
8 gae_duplicate tensor(-1.5744, dtype=torch.float64) tensor(0.2743, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5001, dtype=torch.float64) delta_t tensor(-0.3116, dtype=torch.float64)
7 gae_duplicate tensor(-1.5711, dtype=torch.float64) tensor(0.2948, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6985, dtype=torch.float64) delta_t tensor(0.4439, dtype=torch.float64)
6 gae_duplicate tensor(-0.8129, dtype=torch.float64) tensor(0.1466, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5666, dtype=torch.float64) delta_t tensor(0.1972, dtype=torch.float64)
5 gae_duplicate tensor(-0.4532, dtype=torch.float64) tensor(0.0904, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3655, dtype=torch.float64) delta_t tensor(1.2534, dtype=torch.float64)
4 gae_duplicate tensor(0.8909, dtype=torch.float64) tensor(-0.1724, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4334, dtype=torch.float64) delta_t tensor(0.4463, dtype=torch.float64)
3 gae_duplicate tensor(1.1590, dtype=torch.float64) tensor(-0.2037, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4335, dtype=torch.float64) delta_t tensor(0.3504, dtype=torch.float64)
2 gae_duplicate tensor(1.2776, dtype=torch.float64) tensor(-0.2223, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-218.94229125976562
value loss:71.696044921875
entropies:12.029637336730957
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(319.7980)
ToM Target loss= tensor(313.1341)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.435073137283325 seconds
19 rew tensor(0.8981, dtype=torch.float64) delta_t tensor(-0.3206, dtype=torch.float64)
19 gae_duplicate tensor(-0.3206, dtype=torch.float64) tensor(0.0559, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8982, dtype=torch.float64) delta_t tensor(0.6952, dtype=torch.float64)
18 gae_duplicate tensor(0.4387, dtype=torch.float64) tensor(-0.0765, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8983, dtype=torch.float64) delta_t tensor(0.6752, dtype=torch.float64)
17 gae_duplicate tensor(1.0261, dtype=torch.float64) tensor(-0.1790, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.8054, dtype=torch.float64)
16 gae_duplicate tensor(1.6263, dtype=torch.float64) tensor(-0.3424, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(1.6876, dtype=torch.float64)
15 gae_duplicate tensor(2.9886, dtype=torch.float64) tensor(-8.6938, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.8924, dtype=torch.float64)
14 gae_duplicate tensor(3.2833, dtype=torch.float64) tensor(-0.5909, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(-0.1273, dtype=torch.float64)
13 gae_duplicate tensor(2.4994, dtype=torch.float64) tensor(-0.4327, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.6939, dtype=torch.float64)
12 gae_duplicate tensor(2.6934, dtype=torch.float64) tensor(-8.0844, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.8986, dtype=torch.float64) delta_t tensor(-2.0987, dtype=torch.float64)
11 gae_duplicate tensor(0.0560, dtype=torch.float64) tensor(-0.0097, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0338, dtype=torch.float64) delta_t tensor(-0.6128, dtype=torch.float64)
10 gae_duplicate tensor(-0.5681, dtype=torch.float64) tensor(0.0979, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2993, dtype=torch.float64) delta_t tensor(0.2530, dtype=torch.float64)
9 gae_duplicate tensor(-0.2015, dtype=torch.float64) tensor(0.0347, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7656, dtype=torch.float64) delta_t tensor(0.4290, dtype=torch.float64)
8 gae_duplicate tensor(0.2678, dtype=torch.float64) tensor(-0.0462, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4999, dtype=torch.float64) delta_t tensor(0.7271, dtype=torch.float64)
7 gae_duplicate tensor(0.9414, dtype=torch.float64) tensor(-0.2765, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6324, dtype=torch.float64) delta_t tensor(0.8109, dtype=torch.float64)
6 gae_duplicate tensor(1.5641, dtype=torch.float64) tensor(-2.0878, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5665, dtype=torch.float64) delta_t tensor(0.1496, dtype=torch.float64)
5 gae_duplicate tensor(1.4008, dtype=torch.float64) tensor(-0.7797, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3659, dtype=torch.float64) delta_t tensor(0.9696, dtype=torch.float64)
4 gae_duplicate tensor(2.0903, dtype=torch.float64) tensor(-1.0443, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4332, dtype=torch.float64) delta_t tensor(1.0903, dtype=torch.float64)
3 gae_duplicate tensor(2.7625, dtype=torch.float64) tensor(-1.0586, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4333, dtype=torch.float64) delta_t tensor(-0.5782, dtype=torch.float64)
2 gae_duplicate tensor(1.6318, dtype=torch.float64) tensor(-0.3884, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:143.00279235839844
value loss:86.4035873413086
entropies:13.730807304382324
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.375905990600586 seconds
19 rew tensor(0.8976, dtype=torch.float64) delta_t tensor(0.1372, dtype=torch.float64)
19 gae_duplicate tensor(0.1372, dtype=torch.float64) tensor(-0.4091, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8977, dtype=torch.float64) delta_t tensor(0.7457, dtype=torch.float64)
18 gae_duplicate tensor(0.8554, dtype=torch.float64) tensor(-0.1494, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8978, dtype=torch.float64) delta_t tensor(0.7458, dtype=torch.float64)
17 gae_duplicate tensor(1.4301, dtype=torch.float64) tensor(-0.2498, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8980, dtype=torch.float64) delta_t tensor(0.7459, dtype=torch.float64)
16 gae_duplicate tensor(1.8899, dtype=torch.float64) tensor(-5.6356, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8981, dtype=torch.float64) delta_t tensor(0.7460, dtype=torch.float64)
15 gae_duplicate tensor(2.2579, dtype=torch.float64) tensor(-0.3944, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8982, dtype=torch.float64) delta_t tensor(0.4614, dtype=torch.float64)
14 gae_duplicate tensor(2.2677, dtype=torch.float64) tensor(-0.4584, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7651, dtype=torch.float64) delta_t tensor(-0.0769, dtype=torch.float64)
13 gae_duplicate tensor(1.7373, dtype=torch.float64) tensor(-5.2035, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.5628, dtype=torch.float64)
12 gae_duplicate tensor(1.9526, dtype=torch.float64) tensor(-0.3347, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(0.5513, dtype=torch.float64)
11 gae_duplicate tensor(2.1134, dtype=torch.float64) tensor(-0.3619, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6322, dtype=torch.float64) delta_t tensor(0.3683, dtype=torch.float64)
10 gae_duplicate tensor(2.0590, dtype=torch.float64) tensor(-0.3529, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4987, dtype=torch.float64) delta_t tensor(-1.1311, dtype=torch.float64)
9 gae_duplicate tensor(0.5161, dtype=torch.float64) tensor(-0.0882, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4323, dtype=torch.float64) delta_t tensor(0.3479, dtype=torch.float64)
8 gae_duplicate tensor(0.7607, dtype=torch.float64) tensor(-0.1299, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1660, dtype=torch.float64) delta_t tensor(-0.0690, dtype=torch.float64)
7 gae_duplicate tensor(0.5395, dtype=torch.float64) tensor(-0.0922, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5654, dtype=torch.float64) delta_t tensor(-1.2597, dtype=torch.float64)
6 gae_duplicate tensor(-0.8281, dtype=torch.float64) tensor(0.1431, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8998, dtype=torch.float64) delta_t tensor(1.5616, dtype=torch.float64)
5 gae_duplicate tensor(0.8991, dtype=torch.float64) tensor(-0.1932, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0310, dtype=torch.float64) delta_t tensor(-2.1766, dtype=torch.float64)
4 gae_duplicate tensor(-1.4573, dtype=torch.float64) tensor(6.8366, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0987, dtype=torch.float64) delta_t tensor(1.0076, dtype=torch.float64)
3 gae_duplicate tensor(-0.1582, dtype=torch.float64) tensor(0.0435, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0987, dtype=torch.float64) delta_t tensor(0.5987, dtype=torch.float64)
2 gae_duplicate tensor(0.4721, dtype=torch.float64) tensor(-0.1123, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:42.48198699951172
value loss:55.72095489501953
entropies:12.39984130859375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.2839460372924805 seconds
19 rew tensor(0.8960, dtype=torch.float64) delta_t tensor(-0.3119, dtype=torch.float64)
19 gae_duplicate tensor(-0.3119, dtype=torch.float64) tensor(0.0532, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8961, dtype=torch.float64) delta_t tensor(0.6545, dtype=torch.float64)
18 gae_duplicate tensor(0.4050, dtype=torch.float64) tensor(-0.0691, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8962, dtype=torch.float64) delta_t tensor(0.6546, dtype=torch.float64)
17 gae_duplicate tensor(0.9787, dtype=torch.float64) tensor(-0.1669, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8963, dtype=torch.float64) delta_t tensor(0.6548, dtype=torch.float64)
16 gae_duplicate tensor(1.4377, dtype=torch.float64) tensor(-4.3462, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8965, dtype=torch.float64) delta_t tensor(0.6549, dtype=torch.float64)
15 gae_duplicate tensor(1.8050, dtype=torch.float64) tensor(-0.3078, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8966, dtype=torch.float64) delta_t tensor(0.1152, dtype=torch.float64)
14 gae_duplicate tensor(1.5592, dtype=torch.float64) tensor(-0.2648, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8967, dtype=torch.float64) delta_t tensor(0.9592, dtype=torch.float64)
13 gae_duplicate tensor(2.2065, dtype=torch.float64) tensor(-6.5984, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8968, dtype=torch.float64) delta_t tensor(0.6297, dtype=torch.float64)
12 gae_duplicate tensor(2.3949, dtype=torch.float64) tensor(-0.4073, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8969, dtype=torch.float64) delta_t tensor(0.6298, dtype=torch.float64)
11 gae_duplicate tensor(2.5457, dtype=torch.float64) tensor(-0.4329, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8970, dtype=torch.float64) delta_t tensor(1.5830, dtype=torch.float64)
10 gae_duplicate tensor(3.6195, dtype=torch.float64) tensor(-0.8669, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-5.4870, dtype=torch.float64) delta_t tensor(-6.1601, dtype=torch.float64)
9 gae_duplicate tensor(-3.2644, dtype=torch.float64) tensor(13.4746, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7649, dtype=torch.float64) delta_t tensor(0.3730, dtype=torch.float64)
8 gae_duplicate tensor(-2.2385, dtype=torch.float64) tensor(0.8626, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5010, dtype=torch.float64) delta_t tensor(-0.2767, dtype=torch.float64)
7 gae_duplicate tensor(-2.0675, dtype=torch.float64) tensor(1.1052, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6982, dtype=torch.float64) delta_t tensor(1.5468, dtype=torch.float64)
6 gae_duplicate tensor(-0.1072, dtype=torch.float64) tensor(0.0545, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5676, dtype=torch.float64) delta_t tensor(0.1800, dtype=torch.float64)
5 gae_duplicate tensor(0.0943, dtype=torch.float64) tensor(-0.0577, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3651, dtype=torch.float64) delta_t tensor(0.3047, dtype=torch.float64)
4 gae_duplicate tensor(0.3801, dtype=torch.float64) tensor(-0.2110, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4343, dtype=torch.float64) delta_t tensor(1.8698, dtype=torch.float64)
3 gae_duplicate tensor(2.1738, dtype=torch.float64) tensor(-0.9220, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5010, dtype=torch.float64) delta_t tensor(-0.6808, dtype=torch.float64)
2 gae_duplicate tensor(1.0583, dtype=torch.float64) tensor(-3.2816, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:13.854211807250977
value loss:97.67017364501953
entropies:14.698530197143555
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.379596948623657 seconds
19 rew tensor(0.8960, dtype=torch.float64) delta_t tensor(-0.2983, dtype=torch.float64)
19 gae_duplicate tensor(-0.2983, dtype=torch.float64) tensor(0.9054, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8961, dtype=torch.float64) delta_t tensor(0.6572, dtype=torch.float64)
18 gae_duplicate tensor(0.4186, dtype=torch.float64) tensor(-0.0692, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8962, dtype=torch.float64) delta_t tensor(0.6573, dtype=torch.float64)
17 gae_duplicate tensor(0.9922, dtype=torch.float64) tensor(-0.1641, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8963, dtype=torch.float64) delta_t tensor(0.6574, dtype=torch.float64)
16 gae_duplicate tensor(1.4512, dtype=torch.float64) tensor(-0.2400, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8964, dtype=torch.float64) delta_t tensor(0.6576, dtype=torch.float64)
15 gae_duplicate tensor(1.8185, dtype=torch.float64) tensor(-0.3008, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8965, dtype=torch.float64) delta_t tensor(0.6577, dtype=torch.float64)
14 gae_duplicate tensor(2.1125, dtype=torch.float64) tensor(-6.4129, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-1.0996, dtype=torch.float64) delta_t tensor(-1.3384, dtype=torch.float64)
13 gae_duplicate tensor(0.3515, dtype=torch.float64) tensor(-0.0581, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7634, dtype=torch.float64) delta_t tensor(0.5271, dtype=torch.float64)
12 gae_duplicate tensor(0.8084, dtype=torch.float64) tensor(-0.1337, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6304, dtype=torch.float64) delta_t tensor(0.7327, dtype=torch.float64)
11 gae_duplicate tensor(1.3794, dtype=torch.float64) tensor(-0.2376, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8301, dtype=torch.float64) delta_t tensor(0.5013, dtype=torch.float64)
10 gae_duplicate tensor(1.6048, dtype=torch.float64) tensor(-0.2660, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1679, dtype=torch.float64) delta_t tensor(-0.1666, dtype=torch.float64)
9 gae_duplicate tensor(1.1173, dtype=torch.float64) tensor(-0.2010, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0982, dtype=torch.float64) delta_t tensor(-0.1368, dtype=torch.float64)
8 gae_duplicate tensor(0.7570, dtype=torch.float64) tensor(-0.1255, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6335, dtype=torch.float64) delta_t tensor(-0.3376, dtype=torch.float64)
7 gae_duplicate tensor(0.2680, dtype=torch.float64) tensor(-0.0577, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6304, dtype=torch.float64) delta_t tensor(2.2033, dtype=torch.float64)
6 gae_duplicate tensor(2.4177, dtype=torch.float64) tensor(-0.6745, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4317, dtype=torch.float64) delta_t tensor(-1.0647, dtype=torch.float64)
5 gae_duplicate tensor(0.8694, dtype=torch.float64) tensor(-0.8056, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7633, dtype=torch.float64) delta_t tensor(0.5914, dtype=torch.float64)
4 gae_duplicate tensor(1.2869, dtype=torch.float64) tensor(-0.6642, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7667, dtype=torch.float64) delta_t tensor(1.3477, dtype=torch.float64)
3 gae_duplicate tensor(2.3772, dtype=torch.float64) tensor(-0.9040, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3011, dtype=torch.float64) delta_t tensor(-0.5695, dtype=torch.float64)
2 gae_duplicate tensor(1.3322, dtype=torch.float64) tensor(-0.3254, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:64.01527404785156
value loss:50.93280029296875
entropies:13.140914916992188
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.352737188339233 seconds
19 rew tensor(0.8960, dtype=torch.float64) delta_t tensor(-0.6906, dtype=torch.float64)
19 gae_duplicate tensor(-0.6906, dtype=torch.float64) tensor(0.1117, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8961, dtype=torch.float64) delta_t tensor(0.5788, dtype=torch.float64)
18 gae_duplicate tensor(0.0263, dtype=torch.float64) tensor(-0.0042, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8297, dtype=torch.float64) delta_t tensor(0.5623, dtype=torch.float64)
17 gae_duplicate tensor(0.5833, dtype=torch.float64) tensor(-0.0943, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8298, dtype=torch.float64) delta_t tensor(0.5622, dtype=torch.float64)
16 gae_duplicate tensor(1.0289, dtype=torch.float64) tensor(-0.1664, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7633, dtype=torch.float64) delta_t tensor(0.5026, dtype=torch.float64)
15 gae_duplicate tensor(1.3257, dtype=torch.float64) tensor(-0.2144, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5637, dtype=torch.float64) delta_t tensor(0.3102, dtype=torch.float64)
14 gae_duplicate tensor(1.3708, dtype=torch.float64) tensor(-0.2217, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.3679, dtype=torch.float64) delta_t tensor(-0.7917, dtype=torch.float64)
13 gae_duplicate tensor(0.3050, dtype=torch.float64) tensor(-0.0493, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-3.0964, dtype=torch.float64) delta_t tensor(-3.4084, dtype=torch.float64)
12 gae_duplicate tensor(-3.1644, dtype=torch.float64) tensor(0.5119, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0975, dtype=torch.float64) delta_t tensor(-0.2493, dtype=torch.float64)
11 gae_duplicate tensor(-2.7808, dtype=torch.float64) tensor(0.4501, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6302, dtype=torch.float64) delta_t tensor(0.9056, dtype=torch.float64)
10 gae_duplicate tensor(-1.3191, dtype=torch.float64) tensor(0.2136, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8300, dtype=torch.float64) delta_t tensor(0.4585, dtype=torch.float64)
9 gae_duplicate tensor(-0.5967, dtype=torch.float64) tensor(0.0967, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5015, dtype=torch.float64) delta_t tensor(-0.4653, dtype=torch.float64)
8 gae_duplicate tensor(-0.9427, dtype=torch.float64) tensor(0.1799, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.6968, dtype=torch.float64) delta_t tensor(0.2903, dtype=torch.float64)
7 gae_duplicate tensor(-0.4639, dtype=torch.float64) tensor(1.4175, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3017, dtype=torch.float64) delta_t tensor(-0.1519, dtype=torch.float64)
6 gae_duplicate tensor(-0.5229, dtype=torch.float64) tensor(0.0953, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2974, dtype=torch.float64) delta_t tensor(2.3550, dtype=torch.float64)
5 gae_duplicate tensor(1.9366, dtype=torch.float64) tensor(-0.4692, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2351, dtype=torch.float64) delta_t tensor(-0.3800, dtype=torch.float64)
4 gae_duplicate tensor(1.1693, dtype=torch.float64) tensor(-1.4221, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0355, dtype=torch.float64) delta_t tensor(0.5838, dtype=torch.float64)
3 gae_duplicate tensor(1.5193, dtype=torch.float64) tensor(-0.6170, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5679, dtype=torch.float64) delta_t tensor(0.1636, dtype=torch.float64)
2 gae_duplicate tensor(1.3791, dtype=torch.float64) tensor(-0.3307, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2.7047722339630127
value loss:54.23093032836914
entropies:12.37631607055664
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(391.5648)
ToM Target loss= tensor(313.0963)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.645626068115234 seconds
19 rew tensor(0.8960, dtype=torch.float64) delta_t tensor(-0.5788, dtype=torch.float64)
19 gae_duplicate tensor(-0.5788, dtype=torch.float64) tensor(0.0915, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8961, dtype=torch.float64) delta_t tensor(0.6012, dtype=torch.float64)
18 gae_duplicate tensor(0.1381, dtype=torch.float64) tensor(-0.0218, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8962, dtype=torch.float64) delta_t tensor(0.6013, dtype=torch.float64)
17 gae_duplicate tensor(0.7118, dtype=torch.float64) tensor(-0.1126, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8963, dtype=torch.float64) delta_t tensor(0.6014, dtype=torch.float64)
16 gae_duplicate tensor(1.1708, dtype=torch.float64) tensor(-0.1852, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8299, dtype=torch.float64) delta_t tensor(0.5288, dtype=torch.float64)
15 gae_duplicate tensor(1.4655, dtype=torch.float64) tensor(-0.2318, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8300, dtype=torch.float64) delta_t tensor(0.5261, dtype=torch.float64)
14 gae_duplicate tensor(1.6985, dtype=torch.float64) tensor(-0.2687, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7635, dtype=torch.float64) delta_t tensor(0.4486, dtype=torch.float64)
13 gae_duplicate tensor(1.8074, dtype=torch.float64) tensor(-0.2859, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6304, dtype=torch.float64) delta_t tensor(0.0838, dtype=torch.float64)
12 gae_duplicate tensor(1.5297, dtype=torch.float64) tensor(-0.2420, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5678, dtype=torch.float64) delta_t tensor(-1.0807, dtype=torch.float64)
11 gae_duplicate tensor(0.1431, dtype=torch.float64) tensor(-0.0227, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6304, dtype=torch.float64) delta_t tensor(0.2227, dtype=torch.float64)
10 gae_duplicate tensor(0.3372, dtype=torch.float64) tensor(-0.0534, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2311, dtype=torch.float64) delta_t tensor(0.2371, dtype=torch.float64)
9 gae_duplicate tensor(0.5069, dtype=torch.float64) tensor(-0.0813, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4973, dtype=torch.float64) delta_t tensor(0.5657, dtype=torch.float64)
8 gae_duplicate tensor(0.9713, dtype=torch.float64) tensor(-0.1539, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2996, dtype=torch.float64) delta_t tensor(-1.5233, dtype=torch.float64)
7 gae_duplicate tensor(-0.7462, dtype=torch.float64) tensor(0.1653, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6303, dtype=torch.float64) delta_t tensor(0.8084, dtype=torch.float64)
6 gae_duplicate tensor(0.2114, dtype=torch.float64) tensor(-0.6558, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6325, dtype=torch.float64) delta_t tensor(0.4901, dtype=torch.float64)
5 gae_duplicate tensor(0.6592, dtype=torch.float64) tensor(-0.2348, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3682, dtype=torch.float64) delta_t tensor(0.6710, dtype=torch.float64)
4 gae_duplicate tensor(1.1983, dtype=torch.float64) tensor(-1.8741, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.0322, dtype=torch.float64) delta_t tensor(-0.5468, dtype=torch.float64)
3 gae_duplicate tensor(0.4119, dtype=torch.float64) tensor(-0.1926, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3020, dtype=torch.float64) delta_t tensor(-1.1940, dtype=torch.float64)
2 gae_duplicate tensor(-0.8644, dtype=torch.float64) tensor(2.6909, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:9.641633987426758
value loss:26.391063690185547
entropies:12.371378898620605
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.830032110214233 seconds
19 rew tensor(0.8965, dtype=torch.float64) delta_t tensor(-0.2150, dtype=torch.float64)
19 gae_duplicate tensor(-0.2150, dtype=torch.float64) tensor(0.6676, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8966, dtype=torch.float64) delta_t tensor(3.0775, dtype=torch.float64)
18 gae_duplicate tensor(2.9055, dtype=torch.float64) tensor(-0.7556, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8967, dtype=torch.float64) delta_t tensor(0.1134, dtype=torch.float64)
17 gae_duplicate tensor(2.4379, dtype=torch.float64) tensor(-7.5896, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8968, dtype=torch.float64) delta_t tensor(0.1390, dtype=torch.float64)
16 gae_duplicate tensor(2.0893, dtype=torch.float64) tensor(-0.3236, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8969, dtype=torch.float64) delta_t tensor(0.8374, dtype=torch.float64)
15 gae_duplicate tensor(2.5088, dtype=torch.float64) tensor(-0.4336, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1642, dtype=torch.float64) delta_t tensor(0.3666, dtype=torch.float64)
14 gae_duplicate tensor(2.3737, dtype=torch.float64) tensor(-0.3707, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1689, dtype=torch.float64) delta_t tensor(-1.4630, dtype=torch.float64)
13 gae_duplicate tensor(0.4359, dtype=torch.float64) tensor(-0.0676, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1690, dtype=torch.float64) delta_t tensor(-0.5050, dtype=torch.float64)
12 gae_duplicate tensor(-0.1563, dtype=torch.float64) tensor(0.0243, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3022, dtype=torch.float64) delta_t tensor(-0.5536, dtype=torch.float64)
11 gae_duplicate tensor(-0.6786, dtype=torch.float64) tensor(0.1072, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5686, dtype=torch.float64) delta_t tensor(-0.2945, dtype=torch.float64)
10 gae_duplicate tensor(-0.8374, dtype=torch.float64) tensor(0.1425, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3638, dtype=torch.float64) delta_t tensor(0.8092, dtype=torch.float64)
9 gae_duplicate tensor(0.1393, dtype=torch.float64) tensor(-0.4434, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1640, dtype=torch.float64) delta_t tensor(0.0894, dtype=torch.float64)
8 gae_duplicate tensor(0.2008, dtype=torch.float64) tensor(-0.3267, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7683, dtype=torch.float64) delta_t tensor(-0.4454, dtype=torch.float64)
7 gae_duplicate tensor(-0.2847, dtype=torch.float64) tensor(0.1653, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6301, dtype=torch.float64) delta_t tensor(0.8637, dtype=torch.float64)
6 gae_duplicate tensor(0.6359, dtype=torch.float64) tensor(-0.2935, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3676, dtype=torch.float64) delta_t tensor(-0.2078, dtype=torch.float64)
5 gae_duplicate tensor(0.3010, dtype=torch.float64) tensor(-0.1931, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7632, dtype=torch.float64) delta_t tensor(0.4824, dtype=torch.float64)
4 gae_duplicate tensor(0.7232, dtype=torch.float64) tensor(-0.3465, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7684, dtype=torch.float64) delta_t tensor(1.3079, dtype=torch.float64)
3 gae_duplicate tensor(1.8864, dtype=torch.float64) tensor(-0.6620, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3024, dtype=torch.float64) delta_t tensor(-0.4478, dtype=torch.float64)
2 gae_duplicate tensor(1.0614, dtype=torch.float64) tensor(-0.2450, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:65.2452392578125
value loss:56.91889572143555
entropies:13.973795890808105
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.524389982223511 seconds
19 rew tensor(0.7633, dtype=torch.float64) delta_t tensor(0.0595, dtype=torch.float64)
19 gae_duplicate tensor(0.0595, dtype=torch.float64) tensor(-0.0091, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8967, dtype=torch.float64) delta_t tensor(0.7559, dtype=torch.float64)
18 gae_duplicate tensor(0.8035, dtype=torch.float64) tensor(-0.1234, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8968, dtype=torch.float64) delta_t tensor(0.7560, dtype=torch.float64)
17 gae_duplicate tensor(1.3988, dtype=torch.float64) tensor(-0.2149, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8969, dtype=torch.float64) delta_t tensor(0.7561, dtype=torch.float64)
16 gae_duplicate tensor(1.8751, dtype=torch.float64) tensor(-0.2881, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8970, dtype=torch.float64) delta_t tensor(0.7562, dtype=torch.float64)
15 gae_duplicate tensor(2.2563, dtype=torch.float64) tensor(-0.3466, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8971, dtype=torch.float64) delta_t tensor(0.4406, dtype=torch.float64)
14 gae_duplicate tensor(2.2457, dtype=torch.float64) tensor(-0.3456, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8306, dtype=torch.float64) delta_t tensor(0.3909, dtype=torch.float64)
13 gae_duplicate tensor(2.1874, dtype=torch.float64) tensor(-0.3248, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6974, dtype=torch.float64) delta_t tensor(-0.1417, dtype=torch.float64)
12 gae_duplicate tensor(1.6083, dtype=torch.float64) tensor(-4.9995, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8974, dtype=torch.float64) delta_t tensor(0.5578, dtype=torch.float64)
11 gae_duplicate tensor(1.8444, dtype=torch.float64) tensor(-5.7640, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6310, dtype=torch.float64) delta_t tensor(0.2834, dtype=torch.float64)
10 gae_duplicate tensor(1.7589, dtype=torch.float64) tensor(-0.2639, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8347, dtype=torch.float64) delta_t tensor(-1.2120, dtype=torch.float64)
9 gae_duplicate tensor(0.1951, dtype=torch.float64) tensor(-0.0293, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2352, dtype=torch.float64) delta_t tensor(-0.4410, dtype=torch.float64)
8 gae_duplicate tensor(-0.2849, dtype=torch.float64) tensor(0.0428, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4351, dtype=torch.float64) delta_t tensor(-0.8520, dtype=torch.float64)
7 gae_duplicate tensor(-1.0799, dtype=torch.float64) tensor(0.1621, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5676, dtype=torch.float64) delta_t tensor(-1.0888, dtype=torch.float64)
6 gae_duplicate tensor(-1.9528, dtype=torch.float64) tensor(6.0968, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3681, dtype=torch.float64) delta_t tensor(-0.1744, dtype=torch.float64)
5 gae_duplicate tensor(-1.7366, dtype=torch.float64) tensor(0.2902, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3011, dtype=torch.float64) delta_t tensor(-1.0381, dtype=torch.float64)
4 gae_duplicate tensor(-2.4274, dtype=torch.float64) tensor(0.4800, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3694, dtype=torch.float64) delta_t tensor(1.1036, dtype=torch.float64)
3 gae_duplicate tensor(-0.8383, dtype=torch.float64) tensor(1.4709, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3028, dtype=torch.float64) delta_t tensor(0.2892, dtype=torch.float64)
2 gae_duplicate tensor(-0.3815, dtype=torch.float64) tensor(0.0923, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:24.108539581298828
value loss:67.46636199951172
entropies:11.230500221252441
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.311712026596069 seconds
19 rew tensor(0.8303, dtype=torch.float64) delta_t tensor(-0.5026, dtype=torch.float64)
19 gae_duplicate tensor(-0.5026, dtype=torch.float64) tensor(0.0735, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7637, dtype=torch.float64) delta_t tensor(0.5056, dtype=torch.float64)
18 gae_duplicate tensor(0.1035, dtype=torch.float64) tensor(-0.0151, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5638, dtype=torch.float64) delta_t tensor(0.2178, dtype=torch.float64)
17 gae_duplicate tensor(0.3006, dtype=torch.float64) tensor(-0.0440, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2305, dtype=torch.float64) delta_t tensor(0.0691, dtype=torch.float64)
16 gae_duplicate tensor(0.3096, dtype=torch.float64) tensor(-0.0453, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.3028, dtype=torch.float64) delta_t tensor(-0.3209, dtype=torch.float64)
15 gae_duplicate tensor(-0.0732, dtype=torch.float64) tensor(0.0107, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8971, dtype=torch.float64) delta_t tensor(0.6877, dtype=torch.float64)
14 gae_duplicate tensor(0.6292, dtype=torch.float64) tensor(-0.0924, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-2.4358, dtype=torch.float64) delta_t tensor(-2.6452, dtype=torch.float64)
13 gae_duplicate tensor(-2.1419, dtype=torch.float64) tensor(0.3144, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2303, dtype=torch.float64) delta_t tensor(0.0210, dtype=torch.float64)
12 gae_duplicate tensor(-1.6925, dtype=torch.float64) tensor(0.2484, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7638, dtype=torch.float64) delta_t tensor(0.7909, dtype=torch.float64)
11 gae_duplicate tensor(-0.5631, dtype=torch.float64) tensor(0.0828, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4305, dtype=torch.float64) delta_t tensor(-0.3277, dtype=torch.float64)
10 gae_duplicate tensor(-0.7782, dtype=torch.float64) tensor(0.1139, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1029, dtype=torch.float64) delta_t tensor(0.1331, dtype=torch.float64)
9 gae_duplicate tensor(-0.4895, dtype=torch.float64) tensor(1.5410, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7638, dtype=torch.float64) delta_t tensor(0.4400, dtype=torch.float64)
8 gae_duplicate tensor(0.0484, dtype=torch.float64) tensor(-0.0071, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5028, dtype=torch.float64) delta_t tensor(-0.4649, dtype=torch.float64)
7 gae_duplicate tensor(-0.4262, dtype=torch.float64) tensor(0.0661, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6304, dtype=torch.float64) delta_t tensor(0.3361, dtype=torch.float64)
6 gae_duplicate tensor(-0.0049, dtype=torch.float64) tensor(0.0008, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5694, dtype=torch.float64) delta_t tensor(1.3986, dtype=torch.float64)
5 gae_duplicate tensor(1.3947, dtype=torch.float64) tensor(-2.8778, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2971, dtype=torch.float64) delta_t tensor(-0.0046, dtype=torch.float64)
4 gae_duplicate tensor(1.1111, dtype=torch.float64) tensor(-1.4668, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4360, dtype=torch.float64) delta_t tensor(1.6737, dtype=torch.float64)
3 gae_duplicate tensor(2.5626, dtype=torch.float64) tensor(-0.9050, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4361, dtype=torch.float64) delta_t tensor(-0.8234, dtype=torch.float64)
2 gae_duplicate tensor(1.2267, dtype=torch.float64) tensor(-0.2592, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:19.21713638305664
value loss:31.351186752319336
entropies:11.583834648132324
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.382649183273315 seconds
19 rew tensor(0.8971, dtype=torch.float64) delta_t tensor(-0.4137, dtype=torch.float64)
19 gae_duplicate tensor(-0.4137, dtype=torch.float64) tensor(0.0602, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8972, dtype=torch.float64) delta_t tensor(0.6240, dtype=torch.float64)
18 gae_duplicate tensor(0.2930, dtype=torch.float64) tensor(-0.9122, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8973, dtype=torch.float64) delta_t tensor(0.7656, dtype=torch.float64)
17 gae_duplicate tensor(1.0000, dtype=torch.float64) tensor(-0.1456, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8975, dtype=torch.float64) delta_t tensor(0.7200, dtype=torch.float64)
16 gae_duplicate tensor(1.5200, dtype=torch.float64) tensor(-0.2214, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8976, dtype=torch.float64) delta_t tensor(0.2005, dtype=torch.float64)
15 gae_duplicate tensor(1.4165, dtype=torch.float64) tensor(-4.4844, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8977, dtype=torch.float64) delta_t tensor(0.5776, dtype=torch.float64)
14 gae_duplicate tensor(1.7109, dtype=torch.float64) tensor(-0.2528, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8978, dtype=torch.float64) delta_t tensor(0.2599, dtype=torch.float64)
13 gae_duplicate tensor(1.6286, dtype=torch.float64) tensor(-0.2384, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6978, dtype=torch.float64) delta_t tensor(1.7170, dtype=torch.float64)
12 gae_duplicate tensor(3.0198, dtype=torch.float64) tensor(-9.5496, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5645, dtype=torch.float64) delta_t tensor(-0.6194, dtype=torch.float64)
11 gae_duplicate tensor(1.7965, dtype=torch.float64) tensor(-5.6543, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2311, dtype=torch.float64) delta_t tensor(-0.6317, dtype=torch.float64)
10 gae_duplicate tensor(0.8055, dtype=torch.float64) tensor(-0.1162, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2357, dtype=torch.float64) delta_t tensor(0.1960, dtype=torch.float64)
9 gae_duplicate tensor(0.8404, dtype=torch.float64) tensor(-0.1222, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3690, dtype=torch.float64) delta_t tensor(-0.2747, dtype=torch.float64)
8 gae_duplicate tensor(0.3976, dtype=torch.float64) tensor(-0.0852, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7644, dtype=torch.float64) delta_t tensor(0.1923, dtype=torch.float64)
7 gae_duplicate tensor(0.5104, dtype=torch.float64) tensor(-1.6122, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4356, dtype=torch.float64) delta_t tensor(-0.3151, dtype=torch.float64)
6 gae_duplicate tensor(0.0933, dtype=torch.float64) tensor(-0.0138, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5023, dtype=torch.float64) delta_t tensor(-0.2423, dtype=torch.float64)
5 gae_duplicate tensor(-0.1677, dtype=torch.float64) tensor(0.0252, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1024, dtype=torch.float64) delta_t tensor(1.0356, dtype=torch.float64)
4 gae_duplicate tensor(0.9015, dtype=torch.float64) tensor(-0.1309, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7692, dtype=torch.float64) delta_t tensor(-1.0675, dtype=torch.float64)
3 gae_duplicate tensor(-0.3463, dtype=torch.float64) tensor(0.2783, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7029, dtype=torch.float64) delta_t tensor(-1.3228, dtype=torch.float64)
2 gae_duplicate tensor(-1.5999, dtype=torch.float64) tensor(5.2037, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:107.49513244628906
value loss:43.20415115356445
entropies:11.158056259155273
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(317.5661)
ToM Target loss= tensor(312.8228)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.4890477657318115 seconds
19 rew tensor(0.3637, dtype=torch.float64) delta_t tensor(-1.2583, dtype=torch.float64)
19 gae_duplicate tensor(-1.2583, dtype=torch.float64) tensor(0.1785, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.3038, dtype=torch.float64) delta_t tensor(-0.4259, dtype=torch.float64)
18 gae_duplicate tensor(-1.4325, dtype=torch.float64) tensor(4.5306, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-1.3050, dtype=torch.float64) delta_t tensor(-0.6172, dtype=torch.float64)
17 gae_duplicate tensor(-1.7632, dtype=torch.float64) tensor(0.2854, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8307, dtype=torch.float64) delta_t tensor(0.7109, dtype=torch.float64)
16 gae_duplicate tensor(-0.6997, dtype=torch.float64) tensor(2.2284, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8975, dtype=torch.float64) delta_t tensor(0.3550, dtype=torch.float64)
15 gae_duplicate tensor(-0.2048, dtype=torch.float64) tensor(0.0298, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8309, dtype=torch.float64) delta_t tensor(0.5711, dtype=torch.float64)
14 gae_duplicate tensor(0.4073, dtype=torch.float64) tensor(-1.2907, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.4371, dtype=torch.float64) delta_t tensor(-0.6371, dtype=torch.float64)
13 gae_duplicate tensor(-0.3113, dtype=torch.float64) tensor(0.0453, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7642, dtype=torch.float64) delta_t tensor(-0.0110, dtype=torch.float64)
12 gae_duplicate tensor(-0.2600, dtype=torch.float64) tensor(0.0371, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5640, dtype=torch.float64) delta_t tensor(0.2788, dtype=torch.float64)
11 gae_duplicate tensor(0.0708, dtype=torch.float64) tensor(-0.2243, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4306, dtype=torch.float64) delta_t tensor(0.2520, dtype=torch.float64)
10 gae_duplicate tensor(0.3087, dtype=torch.float64) tensor(-0.0441, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3034, dtype=torch.float64) delta_t tensor(-0.2479, dtype=torch.float64)
9 gae_duplicate tensor(-0.0009, dtype=torch.float64) tensor(0.0001, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7642, dtype=torch.float64) delta_t tensor(0.4018, dtype=torch.float64)
8 gae_duplicate tensor(0.4011, dtype=torch.float64) tensor(-1.2693, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5035, dtype=torch.float64) delta_t tensor(-0.3044, dtype=torch.float64)
7 gae_duplicate tensor(0.0165, dtype=torch.float64) tensor(-0.0025, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6975, dtype=torch.float64) delta_t tensor(0.3522, dtype=torch.float64)
6 gae_duplicate tensor(0.3654, dtype=torch.float64) tensor(-0.0571, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5702, dtype=torch.float64) delta_t tensor(0.1128, dtype=torch.float64)
5 gae_duplicate tensor(0.4052, dtype=torch.float64) tensor(-0.0651, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3638, dtype=torch.float64) delta_t tensor(1.1104, dtype=torch.float64)
4 gae_duplicate tensor(1.4345, dtype=torch.float64) tensor(-0.2382, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5034, dtype=torch.float64) delta_t tensor(1.4069, dtype=torch.float64)
3 gae_duplicate tensor(2.5546, dtype=torch.float64) tensor(-8.1643, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5035, dtype=torch.float64) delta_t tensor(-0.8025, dtype=torch.float64)
2 gae_duplicate tensor(1.2412, dtype=torch.float64) tensor(-3.1238, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:42.54566192626953
value loss:27.43450164794922
entropies:10.637149810791016
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.3463287353515625 seconds
19 rew tensor(0.8313, dtype=torch.float64) delta_t tensor(-0.8094, dtype=torch.float64)
19 gae_duplicate tensor(-0.8094, dtype=torch.float64) tensor(0.1159, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6978, dtype=torch.float64) delta_t tensor(0.3534, dtype=torch.float64)
18 gae_duplicate tensor(-0.2941, dtype=torch.float64) tensor(0.0421, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4975, dtype=torch.float64) delta_t tensor(0.2339, dtype=torch.float64)
17 gae_duplicate tensor(-0.0013, dtype=torch.float64) tensor(0.0002, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0969, dtype=torch.float64) delta_t tensor(-0.0752, dtype=torch.float64)
16 gae_duplicate tensor(-0.0762, dtype=torch.float64) tensor(0.0109, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.5709, dtype=torch.float64) delta_t tensor(-0.6062, dtype=torch.float64)
15 gae_duplicate tensor(-0.6671, dtype=torch.float64) tensor(0.0965, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8981, dtype=torch.float64) delta_t tensor(0.6601, dtype=torch.float64)
14 gae_duplicate tensor(0.1264, dtype=torch.float64) tensor(-0.0183, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2304, dtype=torch.float64) delta_t tensor(-0.0075, dtype=torch.float64)
13 gae_duplicate tensor(0.0936, dtype=torch.float64) tensor(-0.2932, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-2.4403, dtype=torch.float64) delta_t tensor(-2.6782, dtype=torch.float64)
12 gae_duplicate tensor(-2.6034, dtype=torch.float64) tensor(0.3767, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7645, dtype=torch.float64) delta_t tensor(0.5293, dtype=torch.float64)
11 gae_duplicate tensor(-1.5534, dtype=torch.float64) tensor(0.2254, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6310, dtype=torch.float64) delta_t tensor(0.1006, dtype=torch.float64)
10 gae_duplicate tensor(-1.1421, dtype=torch.float64) tensor(0.1634, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2972, dtype=torch.float64) delta_t tensor(0.3790, dtype=torch.float64)
9 gae_duplicate tensor(-0.5347, dtype=torch.float64) tensor(0.0767, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7647, dtype=torch.float64) delta_t tensor(0.3597, dtype=torch.float64)
8 gae_duplicate tensor(-0.0680, dtype=torch.float64) tensor(0.0098, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5041, dtype=torch.float64) delta_t tensor(-0.3046, dtype=torch.float64)
7 gae_duplicate tensor(-0.3590, dtype=torch.float64) tensor(0.0520, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6979, dtype=torch.float64) delta_t tensor(0.3285, dtype=torch.float64)
6 gae_duplicate tensor(0.0412, dtype=torch.float64) tensor(-0.0065, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5708, dtype=torch.float64) delta_t tensor(0.1888, dtype=torch.float64)
5 gae_duplicate tensor(0.2218, dtype=torch.float64) tensor(-0.6632, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3640, dtype=torch.float64) delta_t tensor(1.0898, dtype=torch.float64)
4 gae_duplicate tensor(1.2672, dtype=torch.float64) tensor(-0.2020, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4372, dtype=torch.float64) delta_t tensor(1.4410, dtype=torch.float64)
3 gae_duplicate tensor(2.4548, dtype=torch.float64) tensor(-0.4249, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5040, dtype=torch.float64) delta_t tensor(-0.5716, dtype=torch.float64)
2 gae_duplicate tensor(1.3922, dtype=torch.float64) tensor(-3.3802, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:22.597270965576172
value loss:32.62879943847656
entropies:10.519205093383789
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.437718868255615 seconds
19 rew tensor(0.8983, dtype=torch.float64) delta_t tensor(-0.6302, dtype=torch.float64)
19 gae_duplicate tensor(-0.6302, dtype=torch.float64) tensor(0.0912, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8316, dtype=torch.float64) delta_t tensor(0.5513, dtype=torch.float64)
18 gae_duplicate tensor(0.0471, dtype=torch.float64) tensor(-0.0068, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7648, dtype=torch.float64) delta_t tensor(0.5113, dtype=torch.float64)
17 gae_duplicate tensor(0.5490, dtype=torch.float64) tensor(-0.0795, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6981, dtype=torch.float64) delta_t tensor(0.0967, dtype=torch.float64)
16 gae_duplicate tensor(0.5358, dtype=torch.float64) tensor(-0.0774, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4309, dtype=torch.float64) delta_t tensor(0.0596, dtype=torch.float64)
15 gae_duplicate tensor(0.4883, dtype=torch.float64) tensor(-0.0706, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0968, dtype=torch.float64) delta_t tensor(0.0260, dtype=torch.float64)
14 gae_duplicate tensor(0.4166, dtype=torch.float64) tensor(-0.0603, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(0.5989, dtype=torch.float64)
13 gae_duplicate tensor(0.9322, dtype=torch.float64) tensor(-0.1349, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2305, dtype=torch.float64) delta_t tensor(-0.0691, dtype=torch.float64)
12 gae_duplicate tensor(0.6767, dtype=torch.float64) tensor(-0.0979, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7650, dtype=torch.float64) delta_t tensor(0.5557, dtype=torch.float64)
11 gae_duplicate tensor(1.0971, dtype=torch.float64) tensor(-0.1589, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5647, dtype=torch.float64) delta_t tensor(0.2688, dtype=torch.float64)
10 gae_duplicate tensor(1.1464, dtype=torch.float64) tensor(-0.1661, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1639, dtype=torch.float64) delta_t tensor(-0.0905, dtype=torch.float64)
9 gae_duplicate tensor(0.8267, dtype=torch.float64) tensor(-0.1267, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0303, dtype=torch.float64) delta_t tensor(-0.2777, dtype=torch.float64)
8 gae_duplicate tensor(0.3836, dtype=torch.float64) tensor(-1.2099, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3037, dtype=torch.float64) delta_t tensor(0.7989, dtype=torch.float64)
7 gae_duplicate tensor(1.1058, dtype=torch.float64) tensor(-0.2188, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8380, dtype=torch.float64) delta_t tensor(-0.3852, dtype=torch.float64)
6 gae_duplicate tensor(0.4994, dtype=torch.float64) tensor(-0.5723, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8400, dtype=torch.float64) delta_t tensor(-1.0578, dtype=torch.float64)
5 gae_duplicate tensor(-0.6582, dtype=torch.float64) tensor(2.3565, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7647, dtype=torch.float64) delta_t tensor(0.5824, dtype=torch.float64)
4 gae_duplicate tensor(0.0558, dtype=torch.float64) tensor(-0.0223, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1056, dtype=torch.float64) delta_t tensor(0.9014, dtype=torch.float64)
3 gae_duplicate tensor(0.9461, dtype=torch.float64) tensor(-0.2477, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1705, dtype=torch.float64) delta_t tensor(-0.4219, dtype=torch.float64)
2 gae_duplicate tensor(0.3350, dtype=torch.float64) tensor(-0.0615, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4.821296215057373
value loss:13.486766815185547
entropies:12.092963218688965
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.7532007694244385 seconds
19 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.5368, dtype=torch.float64)
19 gae_duplicate tensor(0.5368, dtype=torch.float64) tensor(-0.0944, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.8265, dtype=torch.float64)
18 gae_duplicate tensor(1.2559, dtype=torch.float64) tensor(-0.2209, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.8583, dtype=torch.float64)
17 gae_duplicate tensor(1.8631, dtype=torch.float64) tensor(-5.9864, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5646, dtype=torch.float64) delta_t tensor(1.0607, dtype=torch.float64)
16 gae_duplicate tensor(2.5511, dtype=torch.float64) tensor(-8.1304, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2971, dtype=torch.float64) delta_t tensor(-0.0811, dtype=torch.float64)
15 gae_duplicate tensor(1.9598, dtype=torch.float64) tensor(-0.2961, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3640, dtype=torch.float64) delta_t tensor(1.2996, dtype=torch.float64)
14 gae_duplicate tensor(2.8674, dtype=torch.float64) tensor(-0.5608, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4309, dtype=torch.float64) delta_t tensor(-0.9156, dtype=torch.float64)
13 gae_duplicate tensor(1.3783, dtype=torch.float64) tensor(-0.2011, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4384, dtype=torch.float64) delta_t tensor(-1.3506, dtype=torch.float64)
12 gae_duplicate tensor(-0.2479, dtype=torch.float64) tensor(0.0360, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4384, dtype=torch.float64) delta_t tensor(-1.1306, dtype=torch.float64)
11 gae_duplicate tensor(-1.3289, dtype=torch.float64) tensor(0.1932, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4977, dtype=torch.float64) delta_t tensor(0.5653, dtype=torch.float64)
10 gae_duplicate tensor(-0.4979, dtype=torch.float64) tensor(1.5707, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1041, dtype=torch.float64) delta_t tensor(-0.0954, dtype=torch.float64)
9 gae_duplicate tensor(-0.4937, dtype=torch.float64) tensor(1.5551, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7651, dtype=torch.float64) delta_t tensor(0.3701, dtype=torch.float64)
8 gae_duplicate tensor(-0.0248, dtype=torch.float64) tensor(0.0783, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5051, dtype=torch.float64) delta_t tensor(-0.3988, dtype=torch.float64)
7 gae_duplicate tensor(-0.4186, dtype=torch.float64) tensor(0.0622, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6982, dtype=torch.float64) delta_t tensor(0.3819, dtype=torch.float64)
6 gae_duplicate tensor(0.0470, dtype=torch.float64) tensor(-0.0075, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5719, dtype=torch.float64) delta_t tensor(0.9365, dtype=torch.float64)
5 gae_duplicate tensor(0.9740, dtype=torch.float64) tensor(-0.2260, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2971, dtype=torch.float64) delta_t tensor(0.4876, dtype=torch.float64)
4 gae_duplicate tensor(1.2669, dtype=torch.float64) tensor(-1.8110, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4382, dtype=torch.float64) delta_t tensor(0.2113, dtype=torch.float64)
3 gae_duplicate tensor(1.2248, dtype=torch.float64) tensor(-0.3878, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4382, dtype=torch.float64) delta_t tensor(0.2753, dtype=torch.float64)
2 gae_duplicate tensor(1.2552, dtype=torch.float64) tensor(-0.2508, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:87.70989227294922
value loss:50.901344299316406
entropies:11.893328666687012
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4352099895477295 seconds
19 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(0.3531, dtype=torch.float64)
19 gae_duplicate tensor(0.3531, dtype=torch.float64) tensor(-0.0586, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.7896, dtype=torch.float64)
18 gae_duplicate tensor(1.0720, dtype=torch.float64) tensor(-0.1781, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(-0.3306, dtype=torch.float64)
17 gae_duplicate tensor(0.5270, dtype=torch.float64) tensor(-0.0770, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8320, dtype=torch.float64) delta_t tensor(0.6344, dtype=torch.float64)
16 gae_duplicate tensor(1.0560, dtype=torch.float64) tensor(-3.3247, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.5929, dtype=torch.float64)
15 gae_duplicate tensor(1.4377, dtype=torch.float64) tensor(-0.2098, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.5931, dtype=torch.float64)
14 gae_duplicate tensor(1.7433, dtype=torch.float64) tensor(-0.2544, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-2.4457, dtype=torch.float64) delta_t tensor(-2.7518, dtype=torch.float64)
13 gae_duplicate tensor(-1.3572, dtype=torch.float64) tensor(0.1980, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.5931, dtype=torch.float64)
12 gae_duplicate tensor(-0.4926, dtype=torch.float64) tensor(0.0719, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7655, dtype=torch.float64) delta_t tensor(0.6700, dtype=torch.float64)
11 gae_duplicate tensor(0.2760, dtype=torch.float64) tensor(-0.0403, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4309, dtype=torch.float64) delta_t tensor(0.0234, dtype=torch.float64)
10 gae_duplicate tensor(0.2442, dtype=torch.float64) tensor(-0.0357, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0374, dtype=torch.float64) delta_t tensor(0.0258, dtype=torch.float64)
9 gae_duplicate tensor(0.2211, dtype=torch.float64) tensor(-0.0333, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2302, dtype=torch.float64) delta_t tensor(-0.1037, dtype=torch.float64)
8 gae_duplicate tensor(0.0732, dtype=torch.float64) tensor(-0.0107, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7734, dtype=torch.float64) delta_t tensor(-0.4948, dtype=torch.float64)
7 gae_duplicate tensor(-0.4363, dtype=torch.float64) tensor(0.0774, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6315, dtype=torch.float64) delta_t tensor(2.0893, dtype=torch.float64)
6 gae_duplicate tensor(1.7402, dtype=torch.float64) tensor(-0.3777, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4423, dtype=torch.float64) delta_t tensor(-1.1975, dtype=torch.float64)
5 gae_duplicate tensor(0.1947, dtype=torch.float64) tensor(-0.2004, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7653, dtype=torch.float64) delta_t tensor(0.5593, dtype=torch.float64)
4 gae_duplicate tensor(0.7151, dtype=torch.float64) tensor(-2.4598, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7734, dtype=torch.float64) delta_t tensor(1.1751, dtype=torch.float64)
3 gae_duplicate tensor(1.7472, dtype=torch.float64) tensor(-0.5550, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3052, dtype=torch.float64) delta_t tensor(-0.6803, dtype=torch.float64)
2 gae_duplicate tensor(0.7175, dtype=torch.float64) tensor(-0.1452, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:45.3184700012207
value loss:26.074419021606445
entropies:12.050313949584961
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(354.5986)
ToM Target loss= tensor(312.8126)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.516952037811279 seconds
19 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(-0.7064, dtype=torch.float64)
19 gae_duplicate tensor(-0.7064, dtype=torch.float64) tensor(0.1056, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(0.5609, dtype=torch.float64)
18 gae_duplicate tensor(-0.0043, dtype=torch.float64) tensor(0.0006, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(0.5623, dtype=torch.float64)
17 gae_duplicate tensor(0.5589, dtype=torch.float64) tensor(-0.0836, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.5621, dtype=torch.float64)
16 gae_duplicate tensor(1.0093, dtype=torch.float64) tensor(-0.1509, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.6303, dtype=torch.float64)
15 gae_duplicate tensor(1.4377, dtype=torch.float64) tensor(-0.2150, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(-0.0177, dtype=torch.float64)
14 gae_duplicate tensor(1.1325, dtype=torch.float64) tensor(-0.1694, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.4624, dtype=torch.float64)
13 gae_duplicate tensor(1.3684, dtype=torch.float64) tensor(-0.2047, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.4625, dtype=torch.float64)
12 gae_duplicate tensor(1.5572, dtype=torch.float64) tensor(-0.2330, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.7764, dtype=torch.float64) delta_t tensor(-1.4946, dtype=torch.float64)
11 gae_duplicate tensor(-0.2488, dtype=torch.float64) tensor(0.7366, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-2.6467, dtype=torch.float64) delta_t tensor(-2.9799, dtype=torch.float64)
10 gae_duplicate tensor(-3.1789, dtype=torch.float64) tensor(9.9732, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4976, dtype=torch.float64) delta_t tensor(-0.1274, dtype=torch.float64)
9 gae_duplicate tensor(-2.6705, dtype=torch.float64) tensor(0.3935, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0378, dtype=torch.float64) delta_t tensor(0.1209, dtype=torch.float64)
8 gae_duplicate tensor(-2.0155, dtype=torch.float64) tensor(6.3331, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7653, dtype=torch.float64) delta_t tensor(0.1283, dtype=torch.float64)
7 gae_duplicate tensor(-1.4841, dtype=torch.float64) tensor(4.6546, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0415, dtype=torch.float64) delta_t tensor(-0.6346, dtype=torch.float64)
6 gae_duplicate tensor(-1.8218, dtype=torch.float64) tensor(0.3089, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4306, dtype=torch.float64) delta_t tensor(2.1309, dtype=torch.float64)
5 gae_duplicate tensor(0.6735, dtype=torch.float64) tensor(-0.1345, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7069, dtype=torch.float64) delta_t tensor(-0.6585, dtype=torch.float64)
4 gae_duplicate tensor(-0.1197, dtype=torch.float64) tensor(0.1447, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3636, dtype=torch.float64) delta_t tensor(0.6876, dtype=torch.float64)
3 gae_duplicate tensor(0.5919, dtype=torch.float64) tensor(-0.2286, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7069, dtype=torch.float64) delta_t tensor(-0.1426, dtype=torch.float64)
2 gae_duplicate tensor(0.3309, dtype=torch.float64) tensor(-0.0712, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-127.30851745605469
value loss:55.93113327026367
entropies:11.637324333190918
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.383238077163696 seconds
19 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(-0.8901, dtype=torch.float64)
19 gae_duplicate tensor(-0.8901, dtype=torch.float64) tensor(0.1308, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.5409, dtype=torch.float64)
18 gae_duplicate tensor(-0.1712, dtype=torch.float64) tensor(0.0252, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.5410, dtype=torch.float64)
17 gae_duplicate tensor(0.4041, dtype=torch.float64) tensor(-0.0594, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.5411, dtype=torch.float64)
16 gae_duplicate tensor(0.8644, dtype=torch.float64) tensor(-0.1271, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.5412, dtype=torch.float64)
15 gae_duplicate tensor(1.2328, dtype=torch.float64) tensor(-0.1812, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.5414, dtype=torch.float64)
14 gae_duplicate tensor(1.5276, dtype=torch.float64) tensor(-0.2246, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.5415, dtype=torch.float64)
13 gae_duplicate tensor(1.7635, dtype=torch.float64) tensor(-0.2592, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4391, dtype=torch.float64) delta_t tensor(-0.7969, dtype=torch.float64)
12 gae_duplicate tensor(0.6139, dtype=torch.float64) tensor(-0.0902, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.1084, dtype=torch.float64) delta_t tensor(-1.4661, dtype=torch.float64)
11 gae_duplicate tensor(-0.9749, dtype=torch.float64) tensor(0.1433, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7652, dtype=torch.float64) delta_t tensor(0.4000, dtype=torch.float64)
10 gae_duplicate tensor(-0.3800, dtype=torch.float64) tensor(0.0559, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4976, dtype=torch.float64) delta_t tensor(0.5331, dtype=torch.float64)
9 gae_duplicate tensor(0.2291, dtype=torch.float64) tensor(-0.0337, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7653, dtype=torch.float64) delta_t tensor(0.3091, dtype=torch.float64)
8 gae_duplicate tensor(0.4924, dtype=torch.float64) tensor(-0.0726, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3721, dtype=torch.float64) delta_t tensor(-0.3022, dtype=torch.float64)
7 gae_duplicate tensor(0.0917, dtype=torch.float64) tensor(-0.0142, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2970, dtype=torch.float64) delta_t tensor(-0.0132, dtype=torch.float64)
6 gae_duplicate tensor(0.0602, dtype=torch.float64) tensor(-0.0096, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9073, dtype=torch.float64) delta_t tensor(-0.2919, dtype=torch.float64)
5 gae_duplicate tensor(-0.2437, dtype=torch.float64) tensor(0.0419, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7067, dtype=torch.float64) delta_t tensor(-0.2618, dtype=torch.float64)
4 gae_duplicate tensor(-0.4568, dtype=torch.float64) tensor(0.0680, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6434, dtype=torch.float64) delta_t tensor(-0.1561, dtype=torch.float64)
3 gae_duplicate tensor(-0.5216, dtype=torch.float64) tensor(0.0978, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5732, dtype=torch.float64) delta_t tensor(-0.1466, dtype=torch.float64)
2 gae_duplicate tensor(-0.5639, dtype=torch.float64) tensor(1.7701, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-7.8848395347595215
value loss:16.99821662902832
entropies:10.598237037658691
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.207007169723511 seconds
19 rew tensor(0.8983, dtype=torch.float64) delta_t tensor(-1.0763, dtype=torch.float64)
19 gae_duplicate tensor(-1.0763, dtype=torch.float64) tensor(0.1562, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.5496, dtype=torch.float64)
18 gae_duplicate tensor(-0.3114, dtype=torch.float64) tensor(0.0452, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(0.4560, dtype=torch.float64)
17 gae_duplicate tensor(0.2069, dtype=torch.float64) tensor(-0.0300, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(0.3760, dtype=torch.float64)
16 gae_duplicate tensor(0.5415, dtype=torch.float64) tensor(-0.0786, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.9131, dtype=torch.float64)
15 gae_duplicate tensor(1.3463, dtype=torch.float64) tensor(-0.1958, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.5942, dtype=torch.float64)
14 gae_duplicate tensor(1.6713, dtype=torch.float64) tensor(-0.2432, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.6868, dtype=torch.float64)
13 gae_duplicate tensor(2.0238, dtype=torch.float64) tensor(-0.2952, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.7601, dtype=torch.float64)
12 gae_duplicate tensor(2.3791, dtype=torch.float64) tensor(-0.3477, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.7541, dtype=torch.float64)
11 gae_duplicate tensor(2.6574, dtype=torch.float64) tensor(-0.3885, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.4432, dtype=torch.float64) delta_t tensor(-2.3014, dtype=torch.float64)
10 gae_duplicate tensor(-0.1755, dtype=torch.float64) tensor(0.0255, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2387, dtype=torch.float64) delta_t tensor(0.8967, dtype=torch.float64)
9 gae_duplicate tensor(0.7563, dtype=torch.float64) tensor(-0.1099, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1718, dtype=torch.float64) delta_t tensor(-1.2213, dtype=torch.float64)
8 gae_duplicate tensor(-0.6163, dtype=torch.float64) tensor(1.2069, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0418, dtype=torch.float64) delta_t tensor(-0.1608, dtype=torch.float64)
7 gae_duplicate tensor(-0.6538, dtype=torch.float64) tensor(2.3398, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6980, dtype=torch.float64) delta_t tensor(0.8476, dtype=torch.float64)
6 gae_duplicate tensor(0.3246, dtype=torch.float64) tensor(-0.1254, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1795, dtype=torch.float64) delta_t tensor(-0.5149, dtype=torch.float64)
5 gae_duplicate tensor(-0.2553, dtype=torch.float64) tensor(0.1622, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7649, dtype=torch.float64) delta_t tensor(-0.0843, dtype=torch.float64)
4 gae_duplicate tensor(-0.2885, dtype=torch.float64) tensor(0.1142, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5108, dtype=torch.float64) delta_t tensor(0.3878, dtype=torch.float64)
3 gae_duplicate tensor(0.1570, dtype=torch.float64) tensor(-0.0373, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0384, dtype=torch.float64) delta_t tensor(-0.5945, dtype=torch.float64)
2 gae_duplicate tensor(-0.4689, dtype=torch.float64) tensor(0.0799, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-14.045866966247559
value loss:37.385108947753906
entropies:12.557415962219238
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.2899110317230225 seconds
19 rew tensor(0.8977, dtype=torch.float64) delta_t tensor(-1.0263, dtype=torch.float64)
19 gae_duplicate tensor(-1.0263, dtype=torch.float64) tensor(0.1476, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8978, dtype=torch.float64) delta_t tensor(0.4808, dtype=torch.float64)
18 gae_duplicate tensor(-0.3403, dtype=torch.float64) tensor(0.0490, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8979, dtype=torch.float64) delta_t tensor(0.6251, dtype=torch.float64)
17 gae_duplicate tensor(0.3529, dtype=torch.float64) tensor(-0.0507, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8980, dtype=torch.float64) delta_t tensor(0.6421, dtype=torch.float64)
16 gae_duplicate tensor(0.9244, dtype=torch.float64) tensor(-0.1329, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8981, dtype=torch.float64) delta_t tensor(-0.0119, dtype=torch.float64)
15 gae_duplicate tensor(0.7276, dtype=torch.float64) tensor(-0.1059, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8982, dtype=torch.float64) delta_t tensor(0.4400, dtype=torch.float64)
14 gae_duplicate tensor(1.0221, dtype=torch.float64) tensor(-0.1488, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8983, dtype=torch.float64) delta_t tensor(0.4401, dtype=torch.float64)
13 gae_duplicate tensor(1.2578, dtype=torch.float64) tensor(-0.1832, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.4403, dtype=torch.float64)
12 gae_duplicate tensor(1.4465, dtype=torch.float64) tensor(-0.2106, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(2.9260, dtype=torch.float64)
11 gae_duplicate tensor(4.0832, dtype=torch.float64) tensor(-0.7266, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(-1.0628, dtype=torch.float64)
10 gae_duplicate tensor(2.2038, dtype=torch.float64) tensor(-6.9864, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-3.3170, dtype=torch.float64) delta_t tensor(-3.6784, dtype=torch.float64)
9 gae_duplicate tensor(-1.9154, dtype=torch.float64) tensor(0.2713, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9090, dtype=torch.float64) delta_t tensor(-0.9124, dtype=torch.float64)
8 gae_duplicate tensor(-2.4447, dtype=torch.float64) tensor(0.3464, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7649, dtype=torch.float64) delta_t tensor(0.3348, dtype=torch.float64)
7 gae_duplicate tensor(-1.6210, dtype=torch.float64) tensor(0.2305, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3064, dtype=torch.float64) delta_t tensor(-0.2169, dtype=torch.float64)
6 gae_duplicate tensor(-1.5137, dtype=torch.float64) tensor(0.2288, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2962, dtype=torch.float64) delta_t tensor(2.1976, dtype=torch.float64)
5 gae_duplicate tensor(0.9866, dtype=torch.float64) tensor(-0.1874, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2394, dtype=torch.float64) delta_t tensor(-0.8137, dtype=torch.float64)
4 gae_duplicate tensor(-0.0244, dtype=torch.float64) tensor(0.0329, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0386, dtype=torch.float64) delta_t tensor(0.6847, dtype=torch.float64)
3 gae_duplicate tensor(0.6652, dtype=torch.float64) tensor(-0.2212, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5741, dtype=torch.float64) delta_t tensor(0.2892, dtype=torch.float64)
2 gae_duplicate tensor(0.8214, dtype=torch.float64) tensor(-0.1706, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:46.56745529174805
value loss:68.37228393554688
entropies:11.30190658569336
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.404582738876343 seconds
19 rew tensor(0.8976, dtype=torch.float64) delta_t tensor(-1.3828, dtype=torch.float64)
19 gae_duplicate tensor(-1.3828, dtype=torch.float64) tensor(0.1963, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8977, dtype=torch.float64) delta_t tensor(0.4416, dtype=torch.float64)
18 gae_duplicate tensor(-0.6646, dtype=torch.float64) tensor(0.0944, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8978, dtype=torch.float64) delta_t tensor(0.4417, dtype=torch.float64)
17 gae_duplicate tensor(-0.0900, dtype=torch.float64) tensor(0.0128, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8979, dtype=torch.float64) delta_t tensor(0.4418, dtype=torch.float64)
16 gae_duplicate tensor(0.3698, dtype=torch.float64) tensor(-0.0525, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8980, dtype=torch.float64) delta_t tensor(0.4419, dtype=torch.float64)
15 gae_duplicate tensor(0.7378, dtype=torch.float64) tensor(-0.1047, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8981, dtype=torch.float64) delta_t tensor(0.4420, dtype=torch.float64)
14 gae_duplicate tensor(1.0323, dtype=torch.float64) tensor(-0.1466, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8982, dtype=torch.float64) delta_t tensor(0.4421, dtype=torch.float64)
13 gae_duplicate tensor(1.2680, dtype=torch.float64) tensor(-0.1800, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8983, dtype=torch.float64) delta_t tensor(0.0877, dtype=torch.float64)
12 gae_duplicate tensor(1.1020, dtype=torch.float64) tensor(-0.1557, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1623, dtype=torch.float64) delta_t tensor(-0.4003, dtype=torch.float64)
11 gae_duplicate tensor(0.4814, dtype=torch.float64) tensor(-1.5159, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.2430, dtype=torch.float64) delta_t tensor(-1.7312, dtype=torch.float64)
10 gae_duplicate tensor(-1.3462, dtype=torch.float64) tensor(0.1907, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4967, dtype=torch.float64) delta_t tensor(0.2275, dtype=torch.float64)
9 gae_duplicate tensor(-0.8494, dtype=torch.float64) tensor(0.1206, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1055, dtype=torch.float64) delta_t tensor(1.0159, dtype=torch.float64)
8 gae_duplicate tensor(0.3363, dtype=torch.float64) tensor(-0.0477, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8415, dtype=torch.float64) delta_t tensor(-0.4674, dtype=torch.float64)
7 gae_duplicate tensor(-0.1983, dtype=torch.float64) tensor(0.1589, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4297, dtype=torch.float64) delta_t tensor(0.4460, dtype=torch.float64)
6 gae_duplicate tensor(0.2873, dtype=torch.float64) tensor(-1.8200, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.3135, dtype=torch.float64) delta_t tensor(-0.7481, dtype=torch.float64)
5 gae_duplicate tensor(-0.5183, dtype=torch.float64) tensor(0.3214, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7642, dtype=torch.float64) delta_t tensor(-0.0437, dtype=torch.float64)
4 gae_duplicate tensor(-0.4583, dtype=torch.float64) tensor(0.1712, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7789, dtype=torch.float64) delta_t tensor(0.1607, dtype=torch.float64)
3 gae_duplicate tensor(-0.2059, dtype=torch.float64) tensor(0.0444, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4407, dtype=torch.float64) delta_t tensor(-0.6808, dtype=torch.float64)
2 gae_duplicate tensor(-0.8455, dtype=torch.float64) tensor(0.2024, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:14.693671226501465
value loss:16.750957489013672
entropies:12.201528549194336
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(359.4301)
ToM Target loss= tensor(314.5042)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.369596004486084 seconds
19 rew tensor(0.4291, dtype=torch.float64) delta_t tensor(-1.5799, dtype=torch.float64)
19 gae_duplicate tensor(-1.5799, dtype=torch.float64) tensor(0.2238, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.0396, dtype=torch.float64) delta_t tensor(-0.0975, dtype=torch.float64)
18 gae_duplicate tensor(-1.3614, dtype=torch.float64) tensor(0.1929, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.9771, dtype=torch.float64) delta_t tensor(-1.5835, dtype=torch.float64)
17 gae_duplicate tensor(-2.6727, dtype=torch.float64) tensor(0.3816, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8978, dtype=torch.float64) delta_t tensor(0.4552, dtype=torch.float64)
16 gae_duplicate tensor(-1.6829, dtype=torch.float64) tensor(0.2405, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8309, dtype=torch.float64) delta_t tensor(0.3945, dtype=torch.float64)
15 gae_duplicate tensor(-0.9519, dtype=torch.float64) tensor(3.0333, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8980, dtype=torch.float64) delta_t tensor(0.4917, dtype=torch.float64)
14 gae_duplicate tensor(-0.2698, dtype=torch.float64) tensor(0.0385, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8981, dtype=torch.float64) delta_t tensor(2.9735, dtype=torch.float64)
13 gae_duplicate tensor(2.7577, dtype=torch.float64) tensor(-9.0786, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8312, dtype=torch.float64) delta_t tensor(-1.3176, dtype=torch.float64)
12 gae_duplicate tensor(0.8886, dtype=torch.float64) tensor(-2.8144, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.1775, dtype=torch.float64) delta_t tensor(-1.4958, dtype=torch.float64)
11 gae_duplicate tensor(-0.7849, dtype=torch.float64) tensor(2.4996, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0946, dtype=torch.float64) delta_t tensor(-0.2554, dtype=torch.float64)
10 gae_duplicate tensor(-0.8834, dtype=torch.float64) tensor(0.1239, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6303, dtype=torch.float64) delta_t tensor(0.3422, dtype=torch.float64)
9 gae_duplicate tensor(-0.3644, dtype=torch.float64) tensor(0.0511, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2286, dtype=torch.float64) delta_t tensor(-0.1853, dtype=torch.float64)
8 gae_duplicate tensor(-0.4768, dtype=torch.float64) tensor(0.0666, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2400, dtype=torch.float64) delta_t tensor(0.4460, dtype=torch.float64)
7 gae_duplicate tensor(0.0646, dtype=torch.float64) tensor(-0.0108, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6972, dtype=torch.float64) delta_t tensor(-0.0006, dtype=torch.float64)
6 gae_duplicate tensor(0.0510, dtype=torch.float64) tensor(-0.0078, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3780, dtype=torch.float64) delta_t tensor(0.7328, dtype=torch.float64)
5 gae_duplicate tensor(0.7736, dtype=torch.float64) tensor(-0.2088, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2954, dtype=torch.float64) delta_t tensor(-0.1654, dtype=torch.float64)
4 gae_duplicate tensor(0.4534, dtype=torch.float64) tensor(-0.7079, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1103, dtype=torch.float64) delta_t tensor(0.5937, dtype=torch.float64)
3 gae_duplicate tensor(0.9564, dtype=torch.float64) tensor(-0.2320, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0394, dtype=torch.float64) delta_t tensor(-0.2005, dtype=torch.float64)
2 gae_duplicate tensor(0.5646, dtype=torch.float64) tensor(-0.1022, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:37.52503204345703
value loss:41.24861145019531
entropies:11.265229225158691
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.530492067337036 seconds
19 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(0.1136, dtype=torch.float64)
19 gae_duplicate tensor(0.1136, dtype=torch.float64) tensor(-0.0163, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.9535, dtype=torch.float64)
18 gae_duplicate tensor(1.0444, dtype=torch.float64) tensor(-0.1533, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8988, dtype=torch.float64) delta_t tensor(0.9460, dtype=torch.float64)
17 gae_duplicate tensor(1.7815, dtype=torch.float64) tensor(-0.2834, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4298, dtype=torch.float64) delta_t tensor(-0.2123, dtype=torch.float64)
16 gae_duplicate tensor(1.2129, dtype=torch.float64) tensor(-0.1748, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2958, dtype=torch.float64) delta_t tensor(1.3769, dtype=torch.float64)
15 gae_duplicate tensor(2.3473, dtype=torch.float64) tensor(-0.4042, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4298, dtype=torch.float64) delta_t tensor(-0.1345, dtype=torch.float64)
14 gae_duplicate tensor(1.7433, dtype=torch.float64) tensor(-0.2637, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1732, dtype=torch.float64) delta_t tensor(-1.6721, dtype=torch.float64)
13 gae_duplicate tensor(-0.2774, dtype=torch.float64) tensor(0.0392, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3743, dtype=torch.float64) delta_t tensor(-1.3592, dtype=torch.float64)
12 gae_duplicate tensor(-1.5811, dtype=torch.float64) tensor(0.2232, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7093, dtype=torch.float64) delta_t tensor(-0.9534, dtype=torch.float64)
11 gae_duplicate tensor(-2.2183, dtype=torch.float64) tensor(0.3173, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4966, dtype=torch.float64) delta_t tensor(0.6015, dtype=torch.float64)
10 gae_duplicate tensor(-1.1731, dtype=torch.float64) tensor(0.2224, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0277, dtype=torch.float64) delta_t tensor(0.2519, dtype=torch.float64)
9 gae_duplicate tensor(-0.6866, dtype=torch.float64) tensor(2.1759, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5752, dtype=torch.float64) delta_t tensor(-0.4531, dtype=torch.float64)
8 gae_duplicate tensor(-1.0023, dtype=torch.float64) tensor(1.3878, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7645, dtype=torch.float64) delta_t tensor(-0.0976, dtype=torch.float64)
7 gae_duplicate tensor(-0.8995, dtype=torch.float64) tensor(0.2526, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0441, dtype=torch.float64) delta_t tensor(-0.0513, dtype=torch.float64)
6 gae_duplicate tensor(-0.7709, dtype=torch.float64) tensor(0.3607, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4295, dtype=torch.float64) delta_t tensor(0.5909, dtype=torch.float64)
5 gae_duplicate tensor(-0.0258, dtype=torch.float64) tensor(0.0091, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6422, dtype=torch.float64) delta_t tensor(-0.1271, dtype=torch.float64)
4 gae_duplicate tensor(-0.1477, dtype=torch.float64) tensor(0.0691, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3625, dtype=torch.float64) delta_t tensor(0.6270, dtype=torch.float64)
3 gae_duplicate tensor(0.5088, dtype=torch.float64) tensor(-0.1804, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7092, dtype=torch.float64) delta_t tensor(-0.6510, dtype=torch.float64)
2 gae_duplicate tensor(-0.2440, dtype=torch.float64) tensor(0.0475, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-22.155941009521484
value loss:39.58702087402344
entropies:12.783591270446777
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.305915832519531 seconds
19 rew tensor(0.7652, dtype=torch.float64) delta_t tensor(-1.5405, dtype=torch.float64)
19 gae_duplicate tensor(-1.5405, dtype=torch.float64) tensor(0.2173, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6311, dtype=torch.float64) delta_t tensor(0.1519, dtype=torch.float64)
18 gae_duplicate tensor(-1.0805, dtype=torch.float64) tensor(0.1524, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4971, dtype=torch.float64) delta_t tensor(-0.2464, dtype=torch.float64)
17 gae_duplicate tensor(-1.1108, dtype=torch.float64) tensor(0.1567, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0276, dtype=torch.float64) delta_t tensor(-0.2329, dtype=torch.float64)
16 gae_duplicate tensor(-1.1215, dtype=torch.float64) tensor(0.1583, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.6431, dtype=torch.float64) delta_t tensor(0.3185, dtype=torch.float64)
15 gae_duplicate tensor(-0.5787, dtype=torch.float64) tensor(0.0838, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(-0.5778, dtype=torch.float64)
14 gae_duplicate tensor(-1.0407, dtype=torch.float64) tensor(0.1470, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.5089, dtype=torch.float64) delta_t tensor(-0.9171, dtype=torch.float64)
13 gae_duplicate tensor(-1.7497, dtype=torch.float64) tensor(5.5543, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7652, dtype=torch.float64) delta_t tensor(0.3458, dtype=torch.float64)
12 gae_duplicate tensor(-1.0540, dtype=torch.float64) tensor(0.1490, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6312, dtype=torch.float64) delta_t tensor(0.6047, dtype=torch.float64)
11 gae_duplicate tensor(-0.2385, dtype=torch.float64) tensor(0.0337, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8324, dtype=torch.float64) delta_t tensor(-0.2815, dtype=torch.float64)
10 gae_duplicate tensor(-0.4723, dtype=torch.float64) tensor(0.0666, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2404, dtype=torch.float64) delta_t tensor(-0.4090, dtype=torch.float64)
9 gae_duplicate tensor(-0.7868, dtype=torch.float64) tensor(0.1110, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0949, dtype=torch.float64) delta_t tensor(-0.2554, dtype=torch.float64)
8 gae_duplicate tensor(-0.8848, dtype=torch.float64) tensor(0.1248, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7097, dtype=torch.float64) delta_t tensor(-1.4532, dtype=torch.float64)
7 gae_duplicate tensor(-2.1611, dtype=torch.float64) tensor(0.3053, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1120, dtype=torch.float64) delta_t tensor(0.2446, dtype=torch.float64)
6 gae_duplicate tensor(-1.4843, dtype=torch.float64) tensor(0.3018, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6428, dtype=torch.float64) delta_t tensor(0.3690, dtype=torch.float64)
5 gae_duplicate tensor(-0.8184, dtype=torch.float64) tensor(4.3687, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2957, dtype=torch.float64) delta_t tensor(0.1807, dtype=torch.float64)
4 gae_duplicate tensor(-0.4740, dtype=torch.float64) tensor(0.7160, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4417, dtype=torch.float64) delta_t tensor(0.0236, dtype=torch.float64)
3 gae_duplicate tensor(-0.3556, dtype=torch.float64) tensor(0.1019, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4418, dtype=torch.float64) delta_t tensor(-0.1016, dtype=torch.float64)
2 gae_duplicate tensor(-0.3861, dtype=torch.float64) tensor(0.0673, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-77.22982025146484
value loss:32.02184295654297
entropies:11.13590145111084
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.375818967819214 seconds
19 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.6046, dtype=torch.float64)
19 gae_duplicate tensor(0.6046, dtype=torch.float64) tensor(-0.0974, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.8403, dtype=torch.float64)
18 gae_duplicate tensor(1.3239, dtype=torch.float64) tensor(-0.2132, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(-0.8080, dtype=torch.float64)
17 gae_duplicate tensor(0.2512, dtype=torch.float64) tensor(-0.0359, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.4441, dtype=torch.float64)
16 gae_duplicate tensor(0.6451, dtype=torch.float64) tensor(-2.0510, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.4976, dtype=torch.float64)
15 gae_duplicate tensor(1.0136, dtype=torch.float64) tensor(-0.1449, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.4977, dtype=torch.float64)
14 gae_duplicate tensor(1.3086, dtype=torch.float64) tensor(-0.1870, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.4978, dtype=torch.float64)
13 gae_duplicate tensor(1.5447, dtype=torch.float64) tensor(-0.2207, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8998, dtype=torch.float64) delta_t tensor(0.4979, dtype=torch.float64)
12 gae_duplicate tensor(1.7336, dtype=torch.float64) tensor(-0.2477, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(1.2007, dtype=torch.float64)
11 gae_duplicate tensor(2.5876, dtype=torch.float64) tensor(-1.0445, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.9844, dtype=torch.float64) delta_t tensor(-2.8125, dtype=torch.float64)
10 gae_duplicate tensor(-0.7424, dtype=torch.float64) tensor(2.4056, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4973, dtype=torch.float64) delta_t tensor(0.4230, dtype=torch.float64)
9 gae_duplicate tensor(-0.1709, dtype=torch.float64) tensor(0.0533, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0393, dtype=torch.float64) delta_t tensor(-0.4462, dtype=torch.float64)
8 gae_duplicate tensor(-0.5829, dtype=torch.float64) tensor(0.1314, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9114, dtype=torch.float64) delta_t tensor(-0.5153, dtype=torch.float64)
7 gae_duplicate tensor(-0.9817, dtype=torch.float64) tensor(0.4945, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6985, dtype=torch.float64) delta_t tensor(1.2278, dtype=torch.float64)
6 gae_duplicate tensor(0.4425, dtype=torch.float64) tensor(-0.1665, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7835, dtype=torch.float64) delta_t tensor(-0.6689, dtype=torch.float64)
5 gae_duplicate tensor(-0.3149, dtype=torch.float64) tensor(0.1823, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7655, dtype=torch.float64) delta_t tensor(0.2769, dtype=torch.float64)
4 gae_duplicate tensor(0.0249, dtype=torch.float64) tensor(-0.0096, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1129, dtype=torch.float64) delta_t tensor(0.6091, dtype=torch.float64)
3 gae_duplicate tensor(0.6291, dtype=torch.float64) tensor(-0.1578, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2409, dtype=torch.float64) delta_t tensor(-0.7158, dtype=torch.float64)
2 gae_duplicate tensor(-0.2126, dtype=torch.float64) tensor(0.6797, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3.379342555999756
value loss:30.067310333251953
entropies:13.244027137756348
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.676229000091553 seconds
19 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(-1.3470, dtype=torch.float64)
19 gae_duplicate tensor(-1.3470, dtype=torch.float64) tensor(0.1870, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.4499, dtype=torch.float64)
18 gae_duplicate tensor(-0.6278, dtype=torch.float64) tensor(0.0871, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.4500, dtype=torch.float64)
17 gae_duplicate tensor(-0.0522, dtype=torch.float64) tensor(0.0073, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.4501, dtype=torch.float64)
16 gae_duplicate tensor(0.4083, dtype=torch.float64) tensor(-0.0567, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.4502, dtype=torch.float64)
15 gae_duplicate tensor(0.7768, dtype=torch.float64) tensor(-0.1078, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.4503, dtype=torch.float64)
14 gae_duplicate tensor(1.0717, dtype=torch.float64) tensor(-0.1487, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.4504, dtype=torch.float64)
13 gae_duplicate tensor(1.3078, dtype=torch.float64) tensor(-0.1815, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.4505, dtype=torch.float64)
12 gae_duplicate tensor(1.4967, dtype=torch.float64) tensor(-0.2077, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.1131, dtype=torch.float64) delta_t tensor(-1.5623, dtype=torch.float64)
11 gae_duplicate tensor(-0.3650, dtype=torch.float64) tensor(0.0507, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7655, dtype=torch.float64) delta_t tensor(0.3131, dtype=torch.float64)
10 gae_duplicate tensor(0.0211, dtype=torch.float64) tensor(-0.0029, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3816, dtype=torch.float64) delta_t tensor(-1.8448, dtype=torch.float64)
9 gae_duplicate tensor(-1.8280, dtype=torch.float64) tensor(0.2541, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1615, dtype=torch.float64) delta_t tensor(0.1727, dtype=torch.float64)
8 gae_duplicate tensor(-1.2896, dtype=torch.float64) tensor(0.1786, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7654, dtype=torch.float64) delta_t tensor(0.1834, dtype=torch.float64)
7 gae_duplicate tensor(-0.8483, dtype=torch.float64) tensor(0.1178, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2474, dtype=torch.float64) delta_t tensor(-0.7488, dtype=torch.float64)
6 gae_duplicate tensor(-1.4275, dtype=torch.float64) tensor(0.2249, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4298, dtype=torch.float64) delta_t tensor(-0.1085, dtype=torch.float64)
5 gae_duplicate tensor(-1.2505, dtype=torch.float64) tensor(0.1957, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9120, dtype=torch.float64) delta_t tensor(0.9992, dtype=torch.float64)
4 gae_duplicate tensor(-0.0012, dtype=torch.float64) tensor(0.0003, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4298, dtype=torch.float64) delta_t tensor(0.4732, dtype=torch.float64)
3 gae_duplicate tensor(0.4722, dtype=torch.float64) tensor(-0.6675, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9120, dtype=torch.float64) delta_t tensor(-0.4684, dtype=torch.float64)
2 gae_duplicate tensor(-0.0906, dtype=torch.float64) tensor(0.2953, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1.6798325777053833
value loss:26.656705856323242
entropies:10.823446273803711
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(308.0878)
ToM Target loss= tensor(313.9815)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.181529760360718 seconds
19 rew tensor(0.7653, dtype=torch.float64) delta_t tensor(-1.5142, dtype=torch.float64)
19 gae_duplicate tensor(-1.5142, dtype=torch.float64) tensor(0.2089, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6311, dtype=torch.float64) delta_t tensor(0.1823, dtype=torch.float64)
18 gae_duplicate tensor(-1.0290, dtype=torch.float64) tensor(0.1420, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4298, dtype=torch.float64) delta_t tensor(-0.1253, dtype=torch.float64)
17 gae_duplicate tensor(-0.9486, dtype=torch.float64) tensor(0.1309, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.1070, dtype=torch.float64) delta_t tensor(-0.4065, dtype=torch.float64)
16 gae_duplicate tensor(-1.1653, dtype=torch.float64) tensor(0.1608, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.9794, dtype=torch.float64) delta_t tensor(-0.9353, dtype=torch.float64)
15 gae_duplicate tensor(-1.8675, dtype=torch.float64) tensor(0.2608, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(0.5566, dtype=torch.float64)
14 gae_duplicate tensor(-0.9374, dtype=torch.float64) tensor(0.1309, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.5567, dtype=torch.float64)
13 gae_duplicate tensor(-0.1932, dtype=torch.float64) tensor(0.0270, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8996, dtype=torch.float64) delta_t tensor(0.5568, dtype=torch.float64)
12 gae_duplicate tensor(0.4023, dtype=torch.float64) tensor(-0.0562, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.7844, dtype=torch.float64) delta_t tensor(-2.1273, dtype=torch.float64)
11 gae_duplicate tensor(-1.8055, dtype=torch.float64) tensor(0.2521, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7654, dtype=torch.float64) delta_t tensor(-0.0743, dtype=torch.float64)
10 gae_duplicate tensor(-1.5186, dtype=torch.float64) tensor(0.2096, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4492, dtype=torch.float64) delta_t tensor(-1.8868, dtype=torch.float64)
9 gae_duplicate tensor(-3.1017, dtype=torch.float64) tensor(0.4288, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3756, dtype=torch.float64) delta_t tensor(-0.3502, dtype=torch.float64)
8 gae_duplicate tensor(-2.8316, dtype=torch.float64) tensor(0.3895, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7653, dtype=torch.float64) delta_t tensor(1.5106, dtype=torch.float64)
7 gae_duplicate tensor(-0.7547, dtype=torch.float64) tensor(0.1055, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3151, dtype=torch.float64) delta_t tensor(-1.1369, dtype=torch.float64)
6 gae_duplicate tensor(-1.7407, dtype=torch.float64) tensor(2.3536, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4296, dtype=torch.float64) delta_t tensor(0.5893, dtype=torch.float64)
5 gae_duplicate tensor(-0.8033, dtype=torch.float64) tensor(0.2495, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9126, dtype=torch.float64) delta_t tensor(-0.3227, dtype=torch.float64)
4 gae_duplicate tensor(-0.9653, dtype=torch.float64) tensor(0.4133, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4967, dtype=torch.float64) delta_t tensor(0.7419, dtype=torch.float64)
3 gae_duplicate tensor(-0.0303, dtype=torch.float64) tensor(0.0113, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9126, dtype=torch.float64) delta_t tensor(-0.5670, dtype=torch.float64)
2 gae_duplicate tensor(-0.5913, dtype=torch.float64) tensor(0.1151, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-33.54903793334961
value loss:58.360782623291016
entropies:11.62338638305664
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.475260019302368 seconds
19 rew tensor(0.8327, dtype=torch.float64) delta_t tensor(-1.2317, dtype=torch.float64)
19 gae_duplicate tensor(-1.2317, dtype=torch.float64) tensor(0.1732, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6986, dtype=torch.float64) delta_t tensor(0.3441, dtype=torch.float64)
18 gae_duplicate tensor(-0.6413, dtype=torch.float64) tensor(0.0902, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5644, dtype=torch.float64) delta_t tensor(0.2146, dtype=torch.float64)
17 gae_duplicate tensor(-0.2984, dtype=torch.float64) tensor(0.0420, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1618, dtype=torch.float64) delta_t tensor(-0.2889, dtype=torch.float64)
16 gae_duplicate tensor(-0.5276, dtype=torch.float64) tensor(0.0743, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.3751, dtype=torch.float64) delta_t tensor(-0.9572, dtype=torch.float64)
15 gae_duplicate tensor(-1.3793, dtype=torch.float64) tensor(0.1956, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(3.3232, dtype=torch.float64)
14 gae_duplicate tensor(2.2197, dtype=torch.float64) tensor(-0.3867, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1618, dtype=torch.float64) delta_t tensor(-2.1182, dtype=torch.float64)
13 gae_duplicate tensor(-0.3424, dtype=torch.float64) tensor(1.0915, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-3.1933, dtype=torch.float64) delta_t tensor(-3.5605, dtype=torch.float64)
12 gae_duplicate tensor(-3.8345, dtype=torch.float64) tensor(12.2387, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.9199, dtype=torch.float64) delta_t tensor(-2.2794, dtype=torch.float64)
11 gae_duplicate tensor(-5.3469, dtype=torch.float64) tensor(0.7459, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6314, dtype=torch.float64) delta_t tensor(0.0385, dtype=torch.float64)
10 gae_duplicate tensor(-4.2391, dtype=torch.float64) tensor(0.5866, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2957, dtype=torch.float64) delta_t tensor(0.3551, dtype=torch.float64)
9 gae_duplicate tensor(-3.0362, dtype=torch.float64) tensor(0.4191, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7657, dtype=torch.float64) delta_t tensor(-0.0386, dtype=torch.float64)
8 gae_duplicate tensor(-2.4676, dtype=torch.float64) tensor(0.3450, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5100, dtype=torch.float64) delta_t tensor(-0.4346, dtype=torch.float64)
7 gae_duplicate tensor(-2.4086, dtype=torch.float64) tensor(0.3335, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6314, dtype=torch.float64) delta_t tensor(0.1865, dtype=torch.float64)
6 gae_duplicate tensor(-1.7404, dtype=torch.float64) tensor(0.2520, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5770, dtype=torch.float64) delta_t tensor(0.0138, dtype=torch.float64)
5 gae_duplicate tensor(-1.3786, dtype=torch.float64) tensor(0.1935, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3628, dtype=torch.float64) delta_t tensor(1.0112, dtype=torch.float64)
4 gae_duplicate tensor(-0.0917, dtype=torch.float64) tensor(0.0131, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4427, dtype=torch.float64) delta_t tensor(1.4929, dtype=torch.float64)
3 gae_duplicate tensor(1.4196, dtype=torch.float64) tensor(-0.2039, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5099, dtype=torch.float64) delta_t tensor(-1.0482, dtype=torch.float64)
2 gae_duplicate tensor(0.0875, dtype=torch.float64) tensor(-0.2415, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-96.0771713256836
value loss:147.86312866210938
entropies:10.181803703308105
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.579952955245972 seconds
19 rew tensor(0.6991, dtype=torch.float64) delta_t tensor(-1.5824, dtype=torch.float64)
19 gae_duplicate tensor(-1.5824, dtype=torch.float64) tensor(0.2175, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4977, dtype=torch.float64) delta_t tensor(0.2161, dtype=torch.float64)
18 gae_duplicate tensor(-1.0498, dtype=torch.float64) tensor(0.1443, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.0276, dtype=torch.float64) delta_t tensor(-0.3194, dtype=torch.float64)
17 gae_duplicate tensor(-1.1592, dtype=torch.float64) tensor(0.1593, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.7112, dtype=torch.float64) delta_t tensor(-0.7992, dtype=torch.float64)
16 gae_duplicate tensor(-1.7266, dtype=torch.float64) tensor(0.2409, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.5578, dtype=torch.float64)
15 gae_duplicate tensor(-0.8235, dtype=torch.float64) tensor(0.1149, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.5579, dtype=torch.float64)
14 gae_duplicate tensor(-0.1009, dtype=torch.float64) tensor(0.0141, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-1.1140, dtype=torch.float64) delta_t tensor(-1.4568, dtype=torch.float64)
13 gae_duplicate tensor(-1.5375, dtype=torch.float64) tensor(0.2145, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.5579, dtype=torch.float64)
12 gae_duplicate tensor(-0.6721, dtype=torch.float64) tensor(0.0938, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0948, dtype=torch.float64) delta_t tensor(-0.5482, dtype=torch.float64)
11 gae_duplicate tensor(-1.0859, dtype=torch.float64) tensor(0.1494, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4978, dtype=torch.float64) delta_t tensor(0.0688, dtype=torch.float64)
10 gae_duplicate tensor(-0.7999, dtype=torch.float64) tensor(2.5569, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1621, dtype=torch.float64) delta_t tensor(0.1386, dtype=torch.float64)
9 gae_duplicate tensor(-0.5014, dtype=torch.float64) tensor(0.0690, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3080, dtype=torch.float64) delta_t tensor(-1.3239, dtype=torch.float64)
8 gae_duplicate tensor(-1.7250, dtype=torch.float64) tensor(0.2371, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1809, dtype=torch.float64) delta_t tensor(-0.7171, dtype=torch.float64)
7 gae_duplicate tensor(-2.0971, dtype=torch.float64) tensor(0.3384, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5767, dtype=torch.float64) delta_t tensor(0.7720, dtype=torch.float64)
6 gae_duplicate tensor(-0.9057, dtype=torch.float64) tensor(7.9416, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2289, dtype=torch.float64) delta_t tensor(0.0900, dtype=torch.float64)
5 gae_duplicate tensor(-0.6346, dtype=torch.float64) tensor(1.1547, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1739, dtype=torch.float64) delta_t tensor(-0.4799, dtype=torch.float64)
4 gae_duplicate tensor(-0.9876, dtype=torch.float64) tensor(0.3483, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0396, dtype=torch.float64) delta_t tensor(0.8860, dtype=torch.float64)
3 gae_duplicate tensor(0.0959, dtype=torch.float64) tensor(-0.0263, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5767, dtype=torch.float64) delta_t tensor(-0.1432, dtype=torch.float64)
2 gae_duplicate tensor(-0.0665, dtype=torch.float64) tensor(0.0110, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-84.20905303955078
value loss:34.63633728027344
entropies:11.085929870605469
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.324501037597656 seconds
19 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(-0.8577, dtype=torch.float64)
19 gae_duplicate tensor(-0.8577, dtype=torch.float64) tensor(0.1170, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(0.5489, dtype=torch.float64)
18 gae_duplicate tensor(-0.1373, dtype=torch.float64) tensor(0.4403, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9006, dtype=torch.float64) delta_t tensor(0.5490, dtype=torch.float64)
17 gae_duplicate tensor(0.4392, dtype=torch.float64) tensor(-0.0599, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.5491, dtype=torch.float64)
16 gae_duplicate tensor(0.9004, dtype=torch.float64) tensor(-0.1228, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(0.5492, dtype=torch.float64)
15 gae_duplicate tensor(1.2695, dtype=torch.float64) tensor(-0.1732, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.5493, dtype=torch.float64)
14 gae_duplicate tensor(1.5649, dtype=torch.float64) tensor(-0.2135, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(0.5494, dtype=torch.float64)
13 gae_duplicate tensor(1.8013, dtype=torch.float64) tensor(-0.2458, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-2.4573, dtype=torch.float64) delta_t tensor(-2.8089, dtype=torch.float64)
12 gae_duplicate tensor(-1.3679, dtype=torch.float64) tensor(0.1866, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7667, dtype=torch.float64) delta_t tensor(0.4098, dtype=torch.float64)
11 gae_duplicate tensor(-0.6846, dtype=torch.float64) tensor(0.0933, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6324, dtype=torch.float64) delta_t tensor(0.2488, dtype=torch.float64)
10 gae_duplicate tensor(-0.2988, dtype=torch.float64) tensor(0.0406, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3637, dtype=torch.float64) delta_t tensor(0.4532, dtype=torch.float64)
9 gae_duplicate tensor(0.2142, dtype=torch.float64) tensor(-0.0291, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0950, dtype=torch.float64) delta_t tensor(-0.4650, dtype=torch.float64)
8 gae_duplicate tensor(-0.2936, dtype=torch.float64) tensor(0.0400, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0470, dtype=torch.float64) delta_t tensor(-0.9416, dtype=torch.float64)
7 gae_duplicate tensor(-1.1764, dtype=torch.float64) tensor(0.1724, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6323, dtype=torch.float64) delta_t tensor(0.3292, dtype=torch.float64)
6 gae_duplicate tensor(-0.6120, dtype=torch.float64) tensor(0.0870, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7860, dtype=torch.float64) delta_t tensor(-0.3997, dtype=torch.float64)
5 gae_duplicate tensor(-0.8893, dtype=torch.float64) tensor(0.1382, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7666, dtype=torch.float64) delta_t tensor(2.1314, dtype=torch.float64)
4 gae_duplicate tensor(1.4200, dtype=torch.float64) tensor(-3.9734, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1816, dtype=torch.float64) delta_t tensor(-0.4983, dtype=torch.float64)
3 gae_duplicate tensor(0.6377, dtype=torch.float64) tensor(-1.4045, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2412, dtype=torch.float64) delta_t tensor(-0.6105, dtype=torch.float64)
2 gae_duplicate tensor(-0.1004, dtype=torch.float64) tensor(0.3229, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:27.196596145629883
value loss:24.910053253173828
entropies:10.196335792541504
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.6464409828186035 seconds
19 rew tensor(0.7668, dtype=torch.float64) delta_t tensor(-0.7780, dtype=torch.float64)
19 gae_duplicate tensor(-0.7780, dtype=torch.float64) tensor(0.1066, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6997, dtype=torch.float64) delta_t tensor(0.0223, dtype=torch.float64)
18 gae_duplicate tensor(-0.6001, dtype=torch.float64) tensor(0.0822, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4309, dtype=torch.float64) delta_t tensor(0.0764, dtype=torch.float64)
17 gae_duplicate tensor(-0.4037, dtype=torch.float64) tensor(0.0553, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.1068, dtype=torch.float64) delta_t tensor(-0.4927, dtype=torch.float64)
16 gae_duplicate tensor(-0.8157, dtype=torch.float64) tensor(0.1118, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.9132, dtype=torch.float64) delta_t tensor(0.4739, dtype=torch.float64)
15 gae_duplicate tensor(-0.1786, dtype=torch.float64) tensor(0.0243, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8340, dtype=torch.float64) delta_t tensor(-0.5567, dtype=torch.float64)
14 gae_duplicate tensor(-0.6996, dtype=torch.float64) tensor(2.2504, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(0.6026, dtype=torch.float64)
13 gae_duplicate tensor(0.0429, dtype=torch.float64) tensor(-0.0059, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4427, dtype=torch.float64) delta_t tensor(-0.7413, dtype=torch.float64)
12 gae_duplicate tensor(-0.7070, dtype=torch.float64) tensor(2.2451, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.1147, dtype=torch.float64) delta_t tensor(-1.4133, dtype=torch.float64)
11 gae_duplicate tensor(-1.9789, dtype=torch.float64) tensor(0.2703, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.2492, dtype=torch.float64) delta_t tensor(-1.9707, dtype=torch.float64)
10 gae_duplicate tensor(-3.5538, dtype=torch.float64) tensor(0.4790, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1070, dtype=torch.float64) delta_t tensor(0.2031, dtype=torch.float64)
9 gae_duplicate tensor(-2.6399, dtype=torch.float64) tensor(0.3559, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2290, dtype=torch.float64) delta_t tensor(0.0597, dtype=torch.float64)
8 gae_duplicate tensor(-2.0522, dtype=torch.float64) tensor(3.8224, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7665, dtype=torch.float64) delta_t tensor(0.2866, dtype=torch.float64)
7 gae_duplicate tensor(-1.3552, dtype=torch.float64) tensor(0.2914, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9804, dtype=torch.float64) delta_t tensor(0.0642, dtype=torch.float64)
6 gae_duplicate tensor(-1.0200, dtype=torch.float64) tensor(0.3610, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4305, dtype=torch.float64) delta_t tensor(0.6044, dtype=torch.float64)
5 gae_duplicate tensor(-0.2116, dtype=torch.float64) tensor(0.0600, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6444, dtype=torch.float64) delta_t tensor(-0.1384, dtype=torch.float64)
4 gae_duplicate tensor(-0.3077, dtype=torch.float64) tensor(0.1123, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3633, dtype=torch.float64) delta_t tensor(0.6669, dtype=torch.float64)
3 gae_duplicate tensor(0.4207, dtype=torch.float64) tensor(-0.1198, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7116, dtype=torch.float64) delta_t tensor(-0.0300, dtype=torch.float64)
2 gae_duplicate tensor(0.3066, dtype=torch.float64) tensor(-0.0520, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-63.052249908447266
value loss:50.746131896972656
entropies:11.665099143981934
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(316.8226)
ToM Target loss= tensor(313.7900)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.430305004119873 seconds
19 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(-0.6661, dtype=torch.float64)
19 gae_duplicate tensor(-0.6661, dtype=torch.float64) tensor(0.0889, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.6837, dtype=torch.float64)
18 gae_duplicate tensor(0.1509, dtype=torch.float64) tensor(-0.0201, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.2603, dtype=torch.float64)
17 gae_duplicate tensor(0.3810, dtype=torch.float64) tensor(-0.0508, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.6395, dtype=torch.float64)
16 gae_duplicate tensor(0.9443, dtype=torch.float64) tensor(-0.1259, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(0.8406, dtype=torch.float64)
15 gae_duplicate tensor(1.5961, dtype=torch.float64) tensor(-0.2130, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(0.6468, dtype=torch.float64)
14 gae_duplicate tensor(1.9237, dtype=torch.float64) tensor(-0.2570, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(0.6445, dtype=torch.float64)
13 gae_duplicate tensor(2.1834, dtype=torch.float64) tensor(-0.2915, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0953, dtype=torch.float64) delta_t tensor(-0.9315, dtype=torch.float64)
12 gae_duplicate tensor(0.8153, dtype=torch.float64) tensor(-0.1097, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5769, dtype=torch.float64) delta_t tensor(-1.4060, dtype=torch.float64)
11 gae_duplicate tensor(-0.7538, dtype=torch.float64) tensor(0.1025, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7114, dtype=torch.float64) delta_t tensor(-0.0957, dtype=torch.float64)
10 gae_duplicate tensor(-0.6987, dtype=torch.float64) tensor(0.0946, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0279, dtype=torch.float64) delta_t tensor(-0.0795, dtype=torch.float64)
9 gae_duplicate tensor(-0.6385, dtype=torch.float64) tensor(0.1039, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0279, dtype=torch.float64) delta_t tensor(-0.5199, dtype=torch.float64)
8 gae_duplicate tensor(-1.0307, dtype=torch.float64) tensor(3.3221, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4506, dtype=torch.float64) delta_t tensor(-1.2952, dtype=torch.float64)
7 gae_duplicate tensor(-2.1197, dtype=torch.float64) tensor(0.2870, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6326, dtype=torch.float64) delta_t tensor(0.3425, dtype=torch.float64)
6 gae_duplicate tensor(-1.3532, dtype=torch.float64) tensor(0.1896, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1900, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
5 gae_duplicate tensor(-1.0284, dtype=torch.float64) tensor(0.2020, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.6998, dtype=torch.float64) delta_t tensor(0.1039, dtype=torch.float64)
4 gae_duplicate tensor(-0.7189, dtype=torch.float64) tensor(1.3366, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5185, dtype=torch.float64) delta_t tensor(0.3131, dtype=torch.float64)
3 gae_duplicate tensor(-0.2620, dtype=torch.float64) tensor(0.0477, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0398, dtype=torch.float64) delta_t tensor(-0.8393, dtype=torch.float64)
2 gae_duplicate tensor(-1.0489, dtype=torch.float64) tensor(0.1415, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-29.400697708129883
value loss:37.166595458984375
entropies:10.380484580993652
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.539708137512207 seconds
19 rew tensor(0.8341, dtype=torch.float64) delta_t tensor(-0.6853, dtype=torch.float64)
19 gae_duplicate tensor(-0.6853, dtype=torch.float64) tensor(0.0900, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7670, dtype=torch.float64) delta_t tensor(0.4447, dtype=torch.float64)
18 gae_duplicate tensor(-0.1035, dtype=torch.float64) tensor(0.0136, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6325, dtype=torch.float64) delta_t tensor(0.2403, dtype=torch.float64)
17 gae_duplicate tensor(0.1575, dtype=torch.float64) tensor(-0.0207, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2291, dtype=torch.float64) delta_t tensor(0.0484, dtype=torch.float64)
16 gae_duplicate tensor(0.1744, dtype=torch.float64) tensor(-0.0229, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.2416, dtype=torch.float64) delta_t tensor(-0.2632, dtype=torch.float64)
15 gae_duplicate tensor(-0.1237, dtype=torch.float64) tensor(0.0163, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.6606, dtype=torch.float64)
14 gae_duplicate tensor(0.5617, dtype=torch.float64) tensor(-0.0741, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.6607, dtype=torch.float64)
13 gae_duplicate tensor(1.1100, dtype=torch.float64) tensor(-0.1465, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2293, dtype=torch.float64) delta_t tensor(-0.0116, dtype=torch.float64)
12 gae_duplicate tensor(0.8764, dtype=torch.float64) tensor(-2.8304, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7672, dtype=torch.float64) delta_t tensor(0.6356, dtype=torch.float64)
11 gae_duplicate tensor(1.3367, dtype=torch.float64) tensor(-0.1768, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5656, dtype=torch.float64) delta_t tensor(0.0235, dtype=torch.float64)
10 gae_duplicate tensor(1.0929, dtype=torch.float64) tensor(-0.1437, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0950, dtype=torch.float64) delta_t tensor(0.0189, dtype=torch.float64)
9 gae_duplicate tensor(0.8931, dtype=torch.float64) tensor(-0.1169, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3084, dtype=torch.float64) delta_t tensor(-0.7171, dtype=torch.float64)
8 gae_duplicate tensor(-0.0026, dtype=torch.float64) tensor(0.0003, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0478, dtype=torch.float64) delta_t tensor(-0.8143, dtype=torch.float64)
7 gae_duplicate tensor(-0.8164, dtype=torch.float64) tensor(0.1073, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6326, dtype=torch.float64) delta_t tensor(0.3333, dtype=torch.float64)
6 gae_duplicate tensor(-0.3198, dtype=torch.float64) tensor(0.0439, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1906, dtype=torch.float64) delta_t tensor(-0.7471, dtype=torch.float64)
5 gae_duplicate tensor(-1.0029, dtype=torch.float64) tensor(0.1407, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7670, dtype=torch.float64) delta_t tensor(0.7117, dtype=torch.float64)
4 gae_duplicate tensor(-0.0906, dtype=torch.float64) tensor(0.0128, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5189, dtype=torch.float64) delta_t tensor(0.3274, dtype=torch.float64)
3 gae_duplicate tensor(0.2549, dtype=torch.float64) tensor(-0.0330, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1072, dtype=torch.float64) delta_t tensor(-0.5985, dtype=torch.float64)
2 gae_duplicate tensor(-0.3946, dtype=torch.float64) tensor(1.2790, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:10.877115249633789
value loss:12.97342300415039
entropies:9.628334999084473
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.460791826248169 seconds
19 rew tensor(0.7002, dtype=torch.float64) delta_t tensor(-0.5784, dtype=torch.float64)
19 gae_duplicate tensor(-0.5784, dtype=torch.float64) tensor(0.0753, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5656, dtype=torch.float64) delta_t tensor(0.1977, dtype=torch.float64)
18 gae_duplicate tensor(-0.2651, dtype=torch.float64) tensor(0.0345, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4310, dtype=torch.float64) delta_t tensor(0.2679, dtype=torch.float64)
17 gae_duplicate tensor(0.0558, dtype=torch.float64) tensor(-0.0073, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2965, dtype=torch.float64) delta_t tensor(0.0381, dtype=torch.float64)
16 gae_duplicate tensor(0.0828, dtype=torch.float64) tensor(-0.0108, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2292, dtype=torch.float64) delta_t tensor(0.2950, dtype=torch.float64)
15 gae_duplicate tensor(0.3613, dtype=torch.float64) tensor(-0.0468, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7003, dtype=torch.float64) delta_t tensor(0.1636, dtype=torch.float64)
14 gae_duplicate tensor(0.4526, dtype=torch.float64) tensor(-0.0591, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.2418, dtype=torch.float64) delta_t tensor(-0.2702, dtype=torch.float64)
13 gae_duplicate tensor(0.0919, dtype=torch.float64) tensor(-0.0120, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1073, dtype=torch.float64) delta_t tensor(-0.2450, dtype=torch.float64)
12 gae_duplicate tensor(-0.1715, dtype=torch.float64) tensor(0.0222, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8475, dtype=torch.float64) delta_t tensor(-2.3228, dtype=torch.float64)
11 gae_duplicate tensor(-2.4600, dtype=torch.float64) tensor(0.3209, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4982, dtype=torch.float64) delta_t tensor(0.8551, dtype=torch.float64)
10 gae_duplicate tensor(-1.1129, dtype=torch.float64) tensor(0.1434, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2419, dtype=torch.float64) delta_t tensor(-0.1435, dtype=torch.float64)
9 gae_duplicate tensor(-1.0338, dtype=torch.float64) tensor(3.3728, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7674, dtype=torch.float64) delta_t tensor(0.4888, dtype=torch.float64)
8 gae_duplicate tensor(-0.3382, dtype=torch.float64) tensor(0.0442, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5109, dtype=torch.float64) delta_t tensor(-0.5079, dtype=torch.float64)
7 gae_duplicate tensor(-0.7784, dtype=torch.float64) tensor(0.1006, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6328, dtype=torch.float64) delta_t tensor(2.0964, dtype=torch.float64)
6 gae_duplicate tensor(1.4737, dtype=torch.float64) tensor(-0.1904, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6454, dtype=torch.float64) delta_t tensor(-0.6387, dtype=torch.float64)
5 gae_duplicate tensor(0.5402, dtype=torch.float64) tensor(-0.9557, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3636, dtype=torch.float64) delta_t tensor(0.4280, dtype=torch.float64)
4 gae_duplicate tensor(0.8602, dtype=torch.float64) tensor(-0.2419, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4436, dtype=torch.float64) delta_t tensor(0.1340, dtype=torch.float64)
3 gae_duplicate tensor(0.8222, dtype=torch.float64) tensor(-0.1788, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4436, dtype=torch.float64) delta_t tensor(0.0809, dtype=torch.float64)
2 gae_duplicate tensor(0.7386, dtype=torch.float64) tensor(-0.1033, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-14.156038284301758
value loss:21.43834686279297
entropies:10.301844596862793
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.301131010055542 seconds
19 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(-0.5849, dtype=torch.float64)
19 gae_duplicate tensor(-0.5849, dtype=torch.float64) tensor(1.9125, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.6046, dtype=torch.float64)
18 gae_duplicate tensor(0.1367, dtype=torch.float64) tensor(-0.0173, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(0.6047, dtype=torch.float64)
17 gae_duplicate tensor(0.7141, dtype=torch.float64) tensor(-0.0902, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(0.6048, dtype=torch.float64)
16 gae_duplicate tensor(1.1761, dtype=torch.float64) tensor(-0.1485, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(0.7508, dtype=torch.float64)
15 gae_duplicate tensor(1.6917, dtype=torch.float64) tensor(-0.2134, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9024, dtype=torch.float64) delta_t tensor(0.3965, dtype=torch.float64)
14 gae_duplicate tensor(1.7499, dtype=torch.float64) tensor(-4.6766, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9025, dtype=torch.float64) delta_t tensor(0.6189, dtype=torch.float64)
13 gae_duplicate tensor(2.0188, dtype=torch.float64) tensor(-0.3333, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9026, dtype=torch.float64) delta_t tensor(0.7505, dtype=torch.float64)
12 gae_duplicate tensor(2.3655, dtype=torch.float64) tensor(-0.4415, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9027, dtype=torch.float64) delta_t tensor(0.5253, dtype=torch.float64)
11 gae_duplicate tensor(2.4177, dtype=torch.float64) tensor(-0.4021, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9028, dtype=torch.float64) delta_t tensor(0.8549, dtype=torch.float64)
10 gae_duplicate tensor(2.7890, dtype=torch.float64) tensor(-0.5976, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4530, dtype=torch.float64) delta_t tensor(-1.8629, dtype=torch.float64)
9 gae_duplicate tensor(0.3684, dtype=torch.float64) tensor(-0.0649, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2416, dtype=torch.float64) delta_t tensor(0.1605, dtype=torch.float64)
8 gae_duplicate tensor(0.4552, dtype=torch.float64) tensor(-0.1079, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1743, dtype=torch.float64) delta_t tensor(-0.9432, dtype=torch.float64)
7 gae_duplicate tensor(-0.5790, dtype=torch.float64) tensor(0.0909, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3185, dtype=torch.float64) delta_t tensor(-0.2191, dtype=torch.float64)
6 gae_duplicate tensor(-0.6823, dtype=torch.float64) tensor(0.2454, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4313, dtype=torch.float64) delta_t tensor(0.6673, dtype=torch.float64)
5 gae_duplicate tensor(0.1215, dtype=torch.float64) tensor(-0.0329, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8571, dtype=torch.float64) delta_t tensor(-0.1054, dtype=torch.float64)
4 gae_duplicate tensor(-0.0082, dtype=torch.float64) tensor(0.0035, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.7678, dtype=torch.float64) delta_t tensor(0.0524, dtype=torch.float64)
3 gae_duplicate tensor(0.0458, dtype=torch.float64) tensor(-0.0145, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6555, dtype=torch.float64) delta_t tensor(-0.0020, dtype=torch.float64)
2 gae_duplicate tensor(0.0346, dtype=torch.float64) tensor(-0.1148, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:29.661327362060547
value loss:48.95268249511719
entropies:11.973064422607422
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5511651039123535 seconds
19 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(-0.6101, dtype=torch.float64)
19 gae_duplicate tensor(-0.6101, dtype=torch.float64) tensor(0.0748, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(0.5997, dtype=torch.float64)
18 gae_duplicate tensor(0.1116, dtype=torch.float64) tensor(-0.0137, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(0.5998, dtype=torch.float64)
17 gae_duplicate tensor(0.6890, dtype=torch.float64) tensor(-0.0845, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(0.5999, dtype=torch.float64)
16 gae_duplicate tensor(1.1511, dtype=torch.float64) tensor(-0.1412, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9024, dtype=torch.float64) delta_t tensor(0.6000, dtype=torch.float64)
15 gae_duplicate tensor(1.5208, dtype=torch.float64) tensor(-0.1865, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9025, dtype=torch.float64) delta_t tensor(0.6001, dtype=torch.float64)
14 gae_duplicate tensor(1.8167, dtype=torch.float64) tensor(-0.2228, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2291, dtype=torch.float64) delta_t tensor(-0.0733, dtype=torch.float64)
13 gae_duplicate tensor(1.3801, dtype=torch.float64) tensor(-0.1693, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2291, dtype=torch.float64) delta_t tensor(-0.0733, dtype=torch.float64)
12 gae_duplicate tensor(1.0307, dtype=torch.float64) tensor(-0.1264, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7679, dtype=torch.float64) delta_t tensor(0.5426, dtype=torch.float64)
11 gae_duplicate tensor(1.3672, dtype=torch.float64) tensor(-4.5109, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4312, dtype=torch.float64) delta_t tensor(0.0672, dtype=torch.float64)
10 gae_duplicate tensor(1.1609, dtype=torch.float64) tensor(-0.1424, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0946, dtype=torch.float64) delta_t tensor(0.1947, dtype=torch.float64)
9 gae_duplicate tensor(1.1234, dtype=torch.float64) tensor(-0.1375, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7679, dtype=torch.float64) delta_t tensor(1.5196, dtype=torch.float64)
8 gae_duplicate tensor(2.4183, dtype=torch.float64) tensor(-0.2965, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5786, dtype=torch.float64) delta_t tensor(-0.7738, dtype=torch.float64)
7 gae_duplicate tensor(1.1609, dtype=torch.float64) tensor(-2.1868, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4313, dtype=torch.float64) delta_t tensor(0.6241, dtype=torch.float64)
6 gae_duplicate tensor(1.5528, dtype=torch.float64) tensor(-0.3995, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9152, dtype=torch.float64) delta_t tensor(-0.2418, dtype=torch.float64)
5 gae_duplicate tensor(1.0004, dtype=torch.float64) tensor(-0.3106, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5787, dtype=torch.float64) delta_t tensor(0.6352, dtype=torch.float64)
4 gae_duplicate tensor(1.4355, dtype=torch.float64) tensor(-0.2782, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6559, dtype=torch.float64) delta_t tensor(-0.7882, dtype=torch.float64)
3 gae_duplicate tensor(0.3603, dtype=torch.float64) tensor(-1.1932, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5790, dtype=torch.float64) delta_t tensor(-2.0309, dtype=torch.float64)
2 gae_duplicate tensor(-1.7427, dtype=torch.float64) tensor(0.2151, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:60.353126525878906
value loss:46.6183967590332
entropies:10.192049980163574
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(325.1117)
ToM Target loss= tensor(313.6414)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.395860910415649 seconds
19 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(-0.1748, dtype=torch.float64)
19 gae_duplicate tensor(-0.1748, dtype=torch.float64) tensor(0.0210, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(0.6868, dtype=torch.float64)
18 gae_duplicate tensor(0.5470, dtype=torch.float64) tensor(-0.0658, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(0.6183, dtype=torch.float64)
17 gae_duplicate tensor(1.0559, dtype=torch.float64) tensor(-0.1271, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9024, dtype=torch.float64) delta_t tensor(0.6186, dtype=torch.float64)
16 gae_duplicate tensor(1.4633, dtype=torch.float64) tensor(-0.1763, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9025, dtype=torch.float64) delta_t tensor(0.7441, dtype=torch.float64)
15 gae_duplicate tensor(1.9148, dtype=torch.float64) tensor(-0.2310, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3635, dtype=torch.float64) delta_t tensor(-0.9094, dtype=torch.float64)
14 gae_duplicate tensor(0.6224, dtype=torch.float64) tensor(-0.0753, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2287, dtype=torch.float64) delta_t tensor(-0.2144, dtype=torch.float64)
13 gae_duplicate tensor(0.2835, dtype=torch.float64) tensor(-0.0345, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2287, dtype=torch.float64) delta_t tensor(-0.1471, dtype=torch.float64)
12 gae_duplicate tensor(0.0797, dtype=torch.float64) tensor(-0.0098, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2287, dtype=torch.float64) delta_t tensor(-0.0768, dtype=torch.float64)
11 gae_duplicate tensor(-0.0130, dtype=torch.float64) tensor(0.0016, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6330, dtype=torch.float64) delta_t tensor(1.0120, dtype=torch.float64)
10 gae_duplicate tensor(1.0016, dtype=torch.float64) tensor(-0.1196, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0267, dtype=torch.float64) delta_t tensor(-0.0997, dtype=torch.float64)
9 gae_duplicate tensor(0.7015, dtype=torch.float64) tensor(-2.3281, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0407, dtype=torch.float64) delta_t tensor(-0.3267, dtype=torch.float64)
8 gae_duplicate tensor(0.2345, dtype=torch.float64) tensor(-0.0283, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5123, dtype=torch.float64) delta_t tensor(0.0444, dtype=torch.float64)
7 gae_duplicate tensor(0.2320, dtype=torch.float64) tensor(-0.0278, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6329, dtype=torch.float64) delta_t tensor(1.8431, dtype=torch.float64)
6 gae_duplicate tensor(2.0287, dtype=torch.float64) tensor(-0.2478, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4553, dtype=torch.float64) delta_t tensor(-0.9607, dtype=torch.float64)
5 gae_duplicate tensor(0.6623, dtype=torch.float64) tensor(-1.0486, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7676, dtype=torch.float64) delta_t tensor(0.3098, dtype=torch.float64)
4 gae_duplicate tensor(0.8396, dtype=torch.float64) tensor(-0.2205, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7818, dtype=torch.float64) delta_t tensor(1.0381, dtype=torch.float64)
3 gae_duplicate tensor(1.7098, dtype=torch.float64) tensor(-0.3252, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3103, dtype=torch.float64) delta_t tensor(-0.4691, dtype=torch.float64)
2 gae_duplicate tensor(0.8987, dtype=torch.float64) tensor(-0.1190, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:30.677425384521484
value loss:27.481332778930664
entropies:9.858022689819336
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.50819206237793 seconds
19 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(-0.7192, dtype=torch.float64)
19 gae_duplicate tensor(-0.7192, dtype=torch.float64) tensor(0.0840, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(0.5777, dtype=torch.float64)
18 gae_duplicate tensor(0.0023, dtype=torch.float64) tensor(-0.0003, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.5778, dtype=torch.float64)
17 gae_duplicate tensor(0.5797, dtype=torch.float64) tensor(-0.0677, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(0.5779, dtype=torch.float64)
16 gae_duplicate tensor(1.0417, dtype=torch.float64) tensor(-0.1217, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(0.5780, dtype=torch.float64)
15 gae_duplicate tensor(1.4114, dtype=torch.float64) tensor(-0.1649, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8349, dtype=torch.float64) delta_t tensor(0.5032, dtype=torch.float64)
14 gae_duplicate tensor(1.6323, dtype=torch.float64) tensor(-0.1907, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7676, dtype=torch.float64) delta_t tensor(0.4636, dtype=torch.float64)
13 gae_duplicate tensor(1.7695, dtype=torch.float64) tensor(-0.2067, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7003, dtype=torch.float64) delta_t tensor(0.5076, dtype=torch.float64)
12 gae_duplicate tensor(1.9232, dtype=torch.float64) tensor(-0.2247, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9026, dtype=torch.float64) delta_t tensor(0.6069, dtype=torch.float64)
11 gae_duplicate tensor(2.1454, dtype=torch.float64) tensor(-7.1706, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5801, dtype=torch.float64) delta_t tensor(-0.8760, dtype=torch.float64)
10 gae_duplicate tensor(0.8404, dtype=torch.float64) tensor(-0.0982, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7149, dtype=torch.float64) delta_t tensor(-1.0530, dtype=torch.float64)
9 gae_duplicate tensor(-0.3807, dtype=torch.float64) tensor(0.0445, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1611, dtype=torch.float64) delta_t tensor(-0.7717, dtype=torch.float64)
8 gae_duplicate tensor(-1.0763, dtype=torch.float64) tensor(0.1265, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6476, dtype=torch.float64) delta_t tensor(0.3058, dtype=torch.float64)
7 gae_duplicate tensor(-0.5553, dtype=torch.float64) tensor(1.8630, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4980, dtype=torch.float64) delta_t tensor(-0.0015, dtype=torch.float64)
6 gae_duplicate tensor(-0.4457, dtype=torch.float64) tensor(1.4926, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.3321, dtype=torch.float64) delta_t tensor(0.0669, dtype=torch.float64)
5 gae_duplicate tensor(-0.2897, dtype=torch.float64) tensor(0.0520, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4304, dtype=torch.float64) delta_t tensor(-0.0899, dtype=torch.float64)
4 gae_duplicate tensor(-0.3216, dtype=torch.float64) tensor(0.6470, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.0633, dtype=torch.float64) delta_t tensor(-0.3124, dtype=torch.float64)
3 gae_duplicate tensor(-0.5697, dtype=torch.float64) tensor(0.0805, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2281, dtype=torch.float64) delta_t tensor(-1.0120, dtype=torch.float64)
2 gae_duplicate tensor(-1.4677, dtype=torch.float64) tensor(0.1743, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:21.806819915771484
value loss:34.81474304199219
entropies:9.326871871948242
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.366431951522827 seconds
19 rew tensor(0.8345, dtype=torch.float64) delta_t tensor(-0.7149, dtype=torch.float64)
19 gae_duplicate tensor(-0.7149, dtype=torch.float64) tensor(2.3997, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7672, dtype=torch.float64) delta_t tensor(0.4601, dtype=torch.float64)
18 gae_duplicate tensor(-0.1118, dtype=torch.float64) tensor(0.0129, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6324, dtype=torch.float64) delta_t tensor(0.2227, dtype=torch.float64)
17 gae_duplicate tensor(0.1333, dtype=torch.float64) tensor(-0.0153, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2279, dtype=torch.float64) delta_t tensor(0.0201, dtype=torch.float64)
16 gae_duplicate tensor(0.1267, dtype=torch.float64) tensor(-0.0146, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.2441, dtype=torch.float64) delta_t tensor(-0.2513, dtype=torch.float64)
15 gae_duplicate tensor(-0.1499, dtype=torch.float64) tensor(0.0173, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(0.6566, dtype=torch.float64)
14 gae_duplicate tensor(0.5366, dtype=torch.float64) tensor(-0.0621, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(0.6567, dtype=torch.float64)
13 gae_duplicate tensor(1.0860, dtype=torch.float64) tensor(-0.1257, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(2.3243, dtype=torch.float64)
12 gae_duplicate tensor(3.1931, dtype=torch.float64) tensor(-0.3658, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.3224, dtype=torch.float64) delta_t tensor(-1.6718, dtype=torch.float64)
11 gae_duplicate tensor(0.8827, dtype=torch.float64) tensor(-2.3191, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6326, dtype=torch.float64) delta_t tensor(-1.1107, dtype=torch.float64)
10 gae_duplicate tensor(-0.4045, dtype=torch.float64) tensor(0.0555, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1607, dtype=torch.float64) delta_t tensor(0.6549, dtype=torch.float64)
9 gae_duplicate tensor(0.3312, dtype=torch.float64) tensor(-0.0793, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3629, dtype=torch.float64) delta_t tensor(-0.2373, dtype=torch.float64)
8 gae_duplicate tensor(0.0277, dtype=torch.float64) tensor(-0.0046, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2549, dtype=torch.float64) delta_t tensor(0.3282, dtype=torch.float64)
7 gae_duplicate tensor(0.3504, dtype=torch.float64) tensor(-0.1083, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6999, dtype=torch.float64) delta_t tensor(0.4638, dtype=torch.float64)
6 gae_duplicate tensor(0.7441, dtype=torch.float64) tensor(-0.1899, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6594, dtype=torch.float64) delta_t tensor(0.1392, dtype=torch.float64)
5 gae_duplicate tensor(0.7345, dtype=torch.float64) tensor(-0.2686, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0931, dtype=torch.float64) delta_t tensor(-0.7983, dtype=torch.float64)
4 gae_duplicate tensor(-0.2107, dtype=torch.float64) tensor(0.0451, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6597, dtype=torch.float64) delta_t tensor(0.0460, dtype=torch.float64)
3 gae_duplicate tensor(-0.1226, dtype=torch.float64) tensor(0.0170, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2277, dtype=torch.float64) delta_t tensor(-1.4987, dtype=torch.float64)
2 gae_duplicate tensor(-1.5968, dtype=torch.float64) tensor(0.1867, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4.596278667449951
value loss:25.682178497314453
entropies:10.582441329956055
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.623508930206299 seconds
19 rew tensor(0.9013, dtype=torch.float64) delta_t tensor(-0.7435, dtype=torch.float64)
19 gae_duplicate tensor(-0.7435, dtype=torch.float64) tensor(0.0854, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9014, dtype=torch.float64) delta_t tensor(0.3202, dtype=torch.float64)
18 gae_duplicate tensor(-0.2746, dtype=torch.float64) tensor(0.0315, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.5995, dtype=torch.float64)
17 gae_duplicate tensor(0.3799, dtype=torch.float64) tensor(-1.2838, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.5967, dtype=torch.float64)
16 gae_duplicate tensor(0.9006, dtype=torch.float64) tensor(-0.1034, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(-0.1741, dtype=torch.float64)
15 gae_duplicate tensor(0.5464, dtype=torch.float64) tensor(-0.0638, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(2.6908, dtype=torch.float64)
14 gae_duplicate tensor(3.1279, dtype=torch.float64) tensor(-0.3676, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9019, dtype=torch.float64) delta_t tensor(-0.2635, dtype=torch.float64)
13 gae_duplicate tensor(2.2388, dtype=torch.float64) tensor(-7.5361, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(0.6372, dtype=torch.float64)
12 gae_duplicate tensor(2.4282, dtype=torch.float64) tensor(-0.2790, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(0.6373, dtype=torch.float64)
11 gae_duplicate tensor(2.5799, dtype=torch.float64) tensor(-8.5905, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(-0.0185, dtype=torch.float64)
10 gae_duplicate tensor(2.0454, dtype=torch.float64) tensor(-0.2302, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-3.5442, dtype=torch.float64) delta_t tensor(-3.2439, dtype=torch.float64)
9 gae_duplicate tensor(-1.6076, dtype=torch.float64) tensor(10.6823, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1609, dtype=torch.float64) delta_t tensor(-0.2844, dtype=torch.float64)
8 gae_duplicate tensor(-1.5704, dtype=torch.float64) tensor(4.4916, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3784, dtype=torch.float64) delta_t tensor(0.0110, dtype=torch.float64)
7 gae_duplicate tensor(-1.2454, dtype=torch.float64) tensor(0.3325, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0261, dtype=torch.float64) delta_t tensor(0.6437, dtype=torch.float64)
6 gae_duplicate tensor(-0.3526, dtype=torch.float64) tensor(0.0668, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9962, dtype=torch.float64) delta_t tensor(-0.4480, dtype=torch.float64)
5 gae_duplicate tensor(-0.7301, dtype=torch.float64) tensor(0.3048, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2281, dtype=torch.float64) delta_t tensor(-0.5380, dtype=torch.float64)
4 gae_duplicate tensor(-1.1221, dtype=torch.float64) tensor(0.2377, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.6034, dtype=torch.float64) delta_t tensor(-1.0312, dtype=torch.float64)
3 gae_duplicate tensor(-1.9289, dtype=torch.float64) tensor(0.6609, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5815, dtype=torch.float64) delta_t tensor(-0.7056, dtype=torch.float64)
2 gae_duplicate tensor(-2.2487, dtype=torch.float64) tensor(7.6297, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-36.721500396728516
value loss:76.06385803222656
entropies:10.267816543579102
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.235961675643921 seconds
19 rew tensor(0.7673, dtype=torch.float64) delta_t tensor(-1.1673, dtype=torch.float64)
19 gae_duplicate tensor(-1.1673, dtype=torch.float64) tensor(0.1304, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6999, dtype=torch.float64) delta_t tensor(0.2607, dtype=torch.float64)
18 gae_duplicate tensor(-0.6732, dtype=torch.float64) tensor(0.0752, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4977, dtype=torch.float64) delta_t tensor(0.2052, dtype=torch.float64)
17 gae_duplicate tensor(-0.3333, dtype=torch.float64) tensor(0.0372, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.0416, dtype=torch.float64) delta_t tensor(-0.3275, dtype=torch.float64)
16 gae_duplicate tensor(-0.5942, dtype=torch.float64) tensor(1.9864, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7832, dtype=torch.float64) delta_t tensor(-1.7343, dtype=torch.float64)
15 gae_duplicate tensor(-2.2096, dtype=torch.float64) tensor(0.2506, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(0.4252, dtype=torch.float64)
14 gae_duplicate tensor(-1.3425, dtype=torch.float64) tensor(4.4905, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(2.8562, dtype=torch.float64)
13 gae_duplicate tensor(1.7822, dtype=torch.float64) tensor(-0.1977, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.5134, dtype=torch.float64) delta_t tensor(-1.6846, dtype=torch.float64)
12 gae_duplicate tensor(-0.2588, dtype=torch.float64) tensor(0.8770, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4460, dtype=torch.float64) delta_t tensor(-0.6728, dtype=torch.float64)
11 gae_duplicate tensor(-0.8799, dtype=torch.float64) tensor(0.0983, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2280, dtype=torch.float64) delta_t tensor(-0.6769, dtype=torch.float64)
10 gae_duplicate tensor(-1.3807, dtype=torch.float64) tensor(0.1519, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6482, dtype=torch.float64) delta_t tensor(-1.0123, dtype=torch.float64)
9 gae_duplicate tensor(-2.1169, dtype=torch.float64) tensor(0.2331, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2439, dtype=torch.float64) delta_t tensor(0.4679, dtype=torch.float64)
8 gae_duplicate tensor(-1.2256, dtype=torch.float64) tensor(0.1437, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.6997, dtype=torch.float64) delta_t tensor(-0.0239, dtype=torch.float64)
7 gae_duplicate tensor(-1.0044, dtype=torch.float64) tensor(2.3767, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9852, dtype=torch.float64) delta_t tensor(0.0428, dtype=torch.float64)
6 gae_duplicate tensor(-0.7608, dtype=torch.float64) tensor(0.2243, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4300, dtype=torch.float64) delta_t tensor(0.5508, dtype=torch.float64)
5 gae_duplicate tensor(-0.0578, dtype=torch.float64) tensor(0.0143, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6482, dtype=torch.float64) delta_t tensor(-0.1111, dtype=torch.float64)
4 gae_duplicate tensor(-0.1574, dtype=torch.float64) tensor(0.0486, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3626, dtype=torch.float64) delta_t tensor(0.6227, dtype=torch.float64)
3 gae_duplicate tensor(0.4968, dtype=torch.float64) tensor(-0.1221, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7156, dtype=torch.float64) delta_t tensor(0.1376, dtype=torch.float64)
2 gae_duplicate tensor(0.5350, dtype=torch.float64) tensor(-0.0771, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-64.74864959716797
value loss:34.53121566772461
entropies:10.043038368225098
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(305.7486)
ToM Target loss= tensor(313.6665)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.3785400390625 seconds
19 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.7172, dtype=torch.float64)
19 gae_duplicate tensor(0.7172, dtype=torch.float64) tensor(-0.0892, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(0.8648, dtype=torch.float64)
18 gae_duplicate tensor(1.4386, dtype=torch.float64) tensor(-0.1788, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(-1.0126, dtype=torch.float64)
17 gae_duplicate tensor(0.1383, dtype=torch.float64) tensor(-0.0148, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8345, dtype=torch.float64) delta_t tensor(0.3917, dtype=torch.float64)
16 gae_duplicate tensor(0.5023, dtype=torch.float64) tensor(-0.0539, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8346, dtype=torch.float64) delta_t tensor(0.5958, dtype=torch.float64)
15 gae_duplicate tensor(0.9977, dtype=torch.float64) tensor(-0.1071, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7673, dtype=torch.float64) delta_t tensor(0.8275, dtype=torch.float64)
14 gae_duplicate tensor(1.6257, dtype=torch.float64) tensor(-0.1745, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6326, dtype=torch.float64) delta_t tensor(0.3136, dtype=torch.float64)
13 gae_duplicate tensor(1.6142, dtype=torch.float64) tensor(-0.1733, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9022, dtype=torch.float64) delta_t tensor(0.6032, dtype=torch.float64)
12 gae_duplicate tensor(1.8945, dtype=torch.float64) tensor(-0.2034, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(0.7386, dtype=torch.float64)
11 gae_duplicate tensor(2.2543, dtype=torch.float64) tensor(-0.2396, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6329, dtype=torch.float64) delta_t tensor(0.6703, dtype=torch.float64)
10 gae_duplicate tensor(2.4737, dtype=torch.float64) tensor(-0.2641, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1756, dtype=torch.float64) delta_t tensor(-0.4745, dtype=torch.float64)
9 gae_duplicate tensor(1.5045, dtype=torch.float64) tensor(-0.1618, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9167, dtype=torch.float64) delta_t tensor(-1.8934, dtype=torch.float64)
8 gae_duplicate tensor(-0.6898, dtype=torch.float64) tensor(0.0735, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3778, dtype=torch.float64) delta_t tensor(-0.1117, dtype=torch.float64)
7 gae_duplicate tensor(-0.6635, dtype=torch.float64) tensor(0.0713, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8495, dtype=torch.float64) delta_t tensor(-0.9300, dtype=torch.float64)
6 gae_duplicate tensor(-1.4608, dtype=torch.float64) tensor(0.1589, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3780, dtype=torch.float64) delta_t tensor(0.2760, dtype=torch.float64)
5 gae_duplicate tensor(-0.8926, dtype=torch.float64) tensor(0.0960, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.4872, dtype=torch.float64) delta_t tensor(-4.7562, dtype=torch.float64)
4 gae_duplicate tensor(-5.4703, dtype=torch.float64) tensor(0.5888, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1767, dtype=torch.float64) delta_t tensor(2.2127, dtype=torch.float64)
3 gae_duplicate tensor(-2.1635, dtype=torch.float64) tensor(7.4922, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2441, dtype=torch.float64) delta_t tensor(0.2081, dtype=torch.float64)
2 gae_duplicate tensor(-1.5228, dtype=torch.float64) tensor(4.3045, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-67.00019073486328
value loss:100.38624572753906
entropies:8.393391609191895
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.150585889816284 seconds
19 rew tensor(0.7675, dtype=torch.float64) delta_t tensor(-1.3180, dtype=torch.float64)
19 gae_duplicate tensor(-1.3180, dtype=torch.float64) tensor(0.1341, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7001, dtype=torch.float64) delta_t tensor(0.1160, dtype=torch.float64)
18 gae_duplicate tensor(-0.9384, dtype=torch.float64) tensor(0.0955, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4305, dtype=torch.float64) delta_t tensor(0.1602, dtype=torch.float64)
17 gae_duplicate tensor(-0.5905, dtype=torch.float64) tensor(0.0601, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.1089, dtype=torch.float64) delta_t tensor(-0.6395, dtype=torch.float64)
16 gae_duplicate tensor(-1.1119, dtype=torch.float64) tensor(0.1132, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.9179, dtype=torch.float64) delta_t tensor(-0.4265, dtype=torch.float64)
15 gae_duplicate tensor(-1.3159, dtype=torch.float64) tensor(0.1438, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(0.6504, dtype=torch.float64)
14 gae_duplicate tensor(-0.4023, dtype=torch.float64) tensor(0.0440, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9024, dtype=torch.float64) delta_t tensor(0.6505, dtype=torch.float64)
13 gae_duplicate tensor(0.3287, dtype=torch.float64) tensor(-0.0359, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9025, dtype=torch.float64) delta_t tensor(0.6506, dtype=torch.float64)
12 gae_duplicate tensor(0.9135, dtype=torch.float64) tensor(-0.0998, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2284, dtype=torch.float64) delta_t tensor(-0.0234, dtype=torch.float64)
11 gae_duplicate tensor(0.7074, dtype=torch.float64) tensor(-0.0773, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4457, dtype=torch.float64) delta_t tensor(-1.6525, dtype=torch.float64)
10 gae_duplicate tensor(-1.0866, dtype=torch.float64) tensor(0.1106, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0262, dtype=torch.float64) delta_t tensor(-0.3194, dtype=torch.float64)
9 gae_duplicate tensor(-1.1887, dtype=torch.float64) tensor(0.1209, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3632, dtype=torch.float64) delta_t tensor(0.2054, dtype=torch.float64)
8 gae_duplicate tensor(-0.7455, dtype=torch.float64) tensor(0.0758, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1760, dtype=torch.float64) delta_t tensor(-0.4180, dtype=torch.float64)
7 gae_duplicate tensor(-1.0145, dtype=torch.float64) tensor(0.1033, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7826, dtype=torch.float64) delta_t tensor(-1.2698, dtype=torch.float64)
6 gae_duplicate tensor(-2.0814, dtype=torch.float64) tensor(0.2133, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5914, dtype=torch.float64) delta_t tensor(-0.1622, dtype=torch.float64)
5 gae_duplicate tensor(-1.8273, dtype=torch.float64) tensor(0.2174, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3111, dtype=torch.float64) delta_t tensor(0.3344, dtype=torch.float64)
4 gae_duplicate tensor(-1.1274, dtype=torch.float64) tensor(3.9458, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0258, dtype=torch.float64) delta_t tensor(0.4491, dtype=torch.float64)
3 gae_duplicate tensor(-0.4528, dtype=torch.float64) tensor(0.7667, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6481, dtype=torch.float64) delta_t tensor(-0.9359, dtype=torch.float64)
2 gae_duplicate tensor(-1.2982, dtype=torch.float64) tensor(0.1915, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-36.99594497680664
value loss:33.824974060058594
entropies:8.627157211303711
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.491570949554443 seconds
19 rew tensor(0.9020, dtype=torch.float64) delta_t tensor(-1.0876, dtype=torch.float64)
19 gae_duplicate tensor(-1.0876, dtype=torch.float64) tensor(0.1075, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(0.4904, dtype=torch.float64)
18 gae_duplicate tensor(-0.3797, dtype=torch.float64) tensor(0.0375, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(0.5685, dtype=torch.float64)
17 gae_duplicate tensor(0.2648, dtype=torch.float64) tensor(-0.0262, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9024, dtype=torch.float64) delta_t tensor(0.6268, dtype=torch.float64)
16 gae_duplicate tensor(0.8387, dtype=torch.float64) tensor(-0.0829, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9025, dtype=torch.float64) delta_t tensor(0.9683, dtype=torch.float64)
15 gae_duplicate tensor(1.6392, dtype=torch.float64) tensor(-0.1839, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9026, dtype=torch.float64) delta_t tensor(2.6218, dtype=torch.float64)
14 gae_duplicate tensor(3.9331, dtype=torch.float64) tensor(-0.4056, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9027, dtype=torch.float64) delta_t tensor(0.5474, dtype=torch.float64)
13 gae_duplicate tensor(3.6939, dtype=torch.float64) tensor(-8.4836, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9028, dtype=torch.float64) delta_t tensor(0.9283, dtype=torch.float64)
12 gae_duplicate tensor(3.8834, dtype=torch.float64) tensor(-0.7813, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9029, dtype=torch.float64) delta_t tensor(0.9285, dtype=torch.float64)
11 gae_duplicate tensor(4.0352, dtype=torch.float64) tensor(-0.8119, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-2.6037, dtype=torch.float64) delta_t tensor(-4.3981, dtype=torch.float64)
10 gae_duplicate tensor(-1.1700, dtype=torch.float64) tensor(0.1508, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7835, dtype=torch.float64) delta_t tensor(-1.0837, dtype=torch.float64)
9 gae_duplicate tensor(-2.0197, dtype=torch.float64) tensor(0.2480, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2957, dtype=torch.float64) delta_t tensor(0.3480, dtype=torch.float64)
8 gae_duplicate tensor(-1.2678, dtype=torch.float64) tensor(0.2369, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7679, dtype=torch.float64) delta_t tensor(0.4061, dtype=torch.float64)
7 gae_duplicate tensor(-0.6081, dtype=torch.float64) tensor(0.1023, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3113, dtype=torch.float64) delta_t tensor(0.6996, dtype=torch.float64)
6 gae_duplicate tensor(0.2132, dtype=torch.float64) tensor(-0.0526, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2958, dtype=torch.float64) delta_t tensor(0.4547, dtype=torch.float64)
5 gae_duplicate tensor(0.6252, dtype=torch.float64) tensor(-0.1492, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1763, dtype=torch.float64) delta_t tensor(0.0704, dtype=torch.float64)
4 gae_duplicate tensor(0.5706, dtype=torch.float64) tensor(-0.1504, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0415, dtype=torch.float64) delta_t tensor(0.4358, dtype=torch.float64)
3 gae_duplicate tensor(0.8922, dtype=torch.float64) tensor(-0.1798, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5810, dtype=torch.float64) delta_t tensor(0.1209, dtype=torch.float64)
2 gae_duplicate tensor(0.8347, dtype=torch.float64) tensor(-0.1033, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:62.85468673706055
value loss:112.41851806640625
entropies:10.411199569702148
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.690425157546997 seconds
19 rew tensor(0.7679, dtype=torch.float64) delta_t tensor(-1.2276, dtype=torch.float64)
19 gae_duplicate tensor(-1.2276, dtype=torch.float64) tensor(0.1186, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7005, dtype=torch.float64) delta_t tensor(0.2551, dtype=torch.float64)
18 gae_duplicate tensor(-0.7269, dtype=torch.float64) tensor(0.0702, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4307, dtype=torch.float64) delta_t tensor(0.0933, dtype=torch.float64)
17 gae_duplicate tensor(-0.4882, dtype=torch.float64) tensor(0.0472, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.0417, dtype=torch.float64) delta_t tensor(0.3085, dtype=torch.float64)
16 gae_duplicate tensor(-0.0821, dtype=torch.float64) tensor(0.0079, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.9189, dtype=torch.float64) delta_t tensor(0.3800, dtype=torch.float64)
15 gae_duplicate tensor(0.3143, dtype=torch.float64) tensor(-0.7850, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9029, dtype=torch.float64) delta_t tensor(0.9664, dtype=torch.float64)
14 gae_duplicate tensor(1.2179, dtype=torch.float64) tensor(-0.1904, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9030, dtype=torch.float64) delta_t tensor(0.9665, dtype=torch.float64)
13 gae_duplicate tensor(1.9408, dtype=torch.float64) tensor(-0.3034, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4464, dtype=torch.float64) delta_t tensor(-0.3829, dtype=torch.float64)
12 gae_duplicate tensor(1.1698, dtype=torch.float64) tensor(-0.1829, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4464, dtype=torch.float64) delta_t tensor(-0.3829, dtype=torch.float64)
11 gae_duplicate tensor(0.5529, dtype=torch.float64) tensor(-0.0864, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5814, dtype=torch.float64) delta_t tensor(-2.5140, dtype=torch.float64)
10 gae_duplicate tensor(-2.0717, dtype=torch.float64) tensor(0.2360, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7839, dtype=torch.float64) delta_t tensor(-1.5265, dtype=torch.float64)
9 gae_duplicate tensor(-3.1839, dtype=torch.float64) tensor(0.3480, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3792, dtype=torch.float64) delta_t tensor(0.2225, dtype=torch.float64)
8 gae_duplicate tensor(-2.3246, dtype=torch.float64) tensor(0.4910, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7676, dtype=torch.float64) delta_t tensor(0.2515, dtype=torch.float64)
7 gae_duplicate tensor(-1.6082, dtype=torch.float64) tensor(0.2683, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9862, dtype=torch.float64) delta_t tensor(0.0295, dtype=torch.float64)
6 gae_duplicate tensor(-1.2570, dtype=torch.float64) tensor(0.3444, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4303, dtype=torch.float64) delta_t tensor(0.5573, dtype=torch.float64)
5 gae_duplicate tensor(-0.4484, dtype=torch.float64) tensor(0.1054, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6489, dtype=torch.float64) delta_t tensor(-0.1208, dtype=torch.float64)
4 gae_duplicate tensor(-0.4795, dtype=torch.float64) tensor(0.1370, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3628, dtype=torch.float64) delta_t tensor(0.5906, dtype=torch.float64)
3 gae_duplicate tensor(0.2070, dtype=torch.float64) tensor(-0.0471, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7164, dtype=torch.float64) delta_t tensor(0.0169, dtype=torch.float64)
2 gae_duplicate tensor(0.1825, dtype=torch.float64) tensor(-0.0232, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3.6439948081970215
value loss:50.713592529296875
entropies:10.338410377502441
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.442569971084595 seconds
19 rew tensor(0.7684, dtype=torch.float64) delta_t tensor(-1.2288, dtype=torch.float64)
19 gae_duplicate tensor(-1.2288, dtype=torch.float64) tensor(0.1175, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7010, dtype=torch.float64) delta_t tensor(0.3996, dtype=torch.float64)
18 gae_duplicate tensor(-0.5834, dtype=torch.float64) tensor(0.0558, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4310, dtype=torch.float64) delta_t tensor(-0.0658, dtype=torch.float64)
17 gae_duplicate tensor(-0.5326, dtype=torch.float64) tensor(0.0509, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.1090, dtype=torch.float64) delta_t tensor(-0.4630, dtype=torch.float64)
16 gae_duplicate tensor(-0.8891, dtype=torch.float64) tensor(0.0911, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.9191, dtype=torch.float64) delta_t tensor(1.0865, dtype=torch.float64)
15 gae_duplicate tensor(0.3752, dtype=torch.float64) tensor(-0.0530, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9034, dtype=torch.float64) delta_t tensor(0.9898, dtype=torch.float64)
14 gae_duplicate tensor(1.2899, dtype=torch.float64) tensor(-0.1823, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9035, dtype=torch.float64) delta_t tensor(0.9899, dtype=torch.float64)
13 gae_duplicate tensor(2.0218, dtype=torch.float64) tensor(-0.2857, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9036, dtype=torch.float64) delta_t tensor(0.9900, dtype=torch.float64)
12 gae_duplicate tensor(2.6075, dtype=torch.float64) tensor(-0.3685, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9037, dtype=torch.float64) delta_t tensor(0.9901, dtype=torch.float64)
11 gae_duplicate tensor(3.0760, dtype=torch.float64) tensor(-0.4347, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4462, dtype=torch.float64) delta_t tensor(-2.6243, dtype=torch.float64)
10 gae_duplicate tensor(-0.1635, dtype=torch.float64) tensor(0.0171, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3236, dtype=torch.float64) delta_t tensor(-1.8530, dtype=torch.float64)
9 gae_duplicate tensor(-1.9838, dtype=torch.float64) tensor(0.2027, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9189, dtype=torch.float64) delta_t tensor(-0.3311, dtype=torch.float64)
8 gae_duplicate tensor(-1.9182, dtype=torch.float64) tensor(0.4253, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7684, dtype=torch.float64) delta_t tensor(0.1840, dtype=torch.float64)
7 gae_duplicate tensor(-1.3506, dtype=torch.float64) tensor(0.2214, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2564, dtype=torch.float64) delta_t tensor(-0.2870, dtype=torch.float64)
6 gae_duplicate tensor(-1.3674, dtype=torch.float64) tensor(0.3941, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4309, dtype=torch.float64) delta_t tensor(0.5328, dtype=torch.float64)
5 gae_duplicate tensor(-0.5612, dtype=torch.float64) tensor(0.1312, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9190, dtype=torch.float64) delta_t tensor(-0.2937, dtype=torch.float64)
4 gae_duplicate tensor(-0.7426, dtype=torch.float64) tensor(0.2225, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4983, dtype=torch.float64) delta_t tensor(0.7479, dtype=torch.float64)
3 gae_duplicate tensor(0.1538, dtype=torch.float64) tensor(-0.0421, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9190, dtype=torch.float64) delta_t tensor(-0.5356, dtype=torch.float64)
2 gae_duplicate tensor(-0.4126, dtype=torch.float64) tensor(0.0549, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4.0153679847717285
value loss:56.210105895996094
entropies:10.249263763427734
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(356.6570)
ToM Target loss= tensor(313.4409)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.460901975631714 seconds
19 rew tensor(0.8364, dtype=torch.float64) delta_t tensor(-1.2281, dtype=torch.float64)
19 gae_duplicate tensor(-1.2281, dtype=torch.float64) tensor(0.1171, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7013, dtype=torch.float64) delta_t tensor(0.1202, dtype=torch.float64)
18 gae_duplicate tensor(-0.8622, dtype=torch.float64) tensor(0.0822, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4987, dtype=torch.float64) delta_t tensor(-0.2729, dtype=torch.float64)
17 gae_duplicate tensor(-0.9627, dtype=torch.float64) tensor(0.0918, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0935, dtype=torch.float64) delta_t tensor(-0.2858, dtype=torch.float64)
16 gae_duplicate tensor(-1.0560, dtype=torch.float64) tensor(0.1008, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.5820, dtype=torch.float64) delta_t tensor(-0.9515, dtype=torch.float64)
15 gae_duplicate tensor(-1.7962, dtype=torch.float64) tensor(0.1735, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9039, dtype=torch.float64) delta_t tensor(0.4420, dtype=torch.float64)
14 gae_duplicate tensor(-0.9950, dtype=torch.float64) tensor(0.0961, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(-0.0331, dtype=torch.float64)
13 gae_duplicate tensor(-0.8291, dtype=torch.float64) tensor(0.0796, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7015, dtype=torch.float64) delta_t tensor(0.2635, dtype=torch.float64)
12 gae_duplicate tensor(-0.3998, dtype=torch.float64) tensor(1.4152, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6340, dtype=torch.float64) delta_t tensor(0.1125, dtype=torch.float64)
11 gae_duplicate tensor(-0.2073, dtype=torch.float64) tensor(0.0200, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2289, dtype=torch.float64) delta_t tensor(0.7392, dtype=torch.float64)
10 gae_duplicate tensor(0.5734, dtype=torch.float64) tensor(-0.0546, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0938, dtype=torch.float64) delta_t tensor(-0.2545, dtype=torch.float64)
9 gae_duplicate tensor(0.2042, dtype=torch.float64) tensor(-0.7231, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0938, dtype=torch.float64) delta_t tensor(-0.1724, dtype=torch.float64)
8 gae_duplicate tensor(-0.0090, dtype=torch.float64) tensor(0.0009, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3113, dtype=torch.float64) delta_t tensor(-0.7668, dtype=torch.float64)
7 gae_duplicate tensor(-0.7741, dtype=torch.float64) tensor(0.0732, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7165, dtype=torch.float64) delta_t tensor(0.8413, dtype=torch.float64)
6 gae_duplicate tensor(0.2221, dtype=torch.float64) tensor(-0.0210, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7969, dtype=torch.float64) delta_t tensor(-0.8514, dtype=torch.float64)
5 gae_duplicate tensor(-0.6737, dtype=torch.float64) tensor(0.5938, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3636, dtype=torch.float64) delta_t tensor(-0.1284, dtype=torch.float64)
4 gae_duplicate tensor(-0.6673, dtype=torch.float64) tensor(2.1530, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4467, dtype=torch.float64) delta_t tensor(0.0299, dtype=torch.float64)
3 gae_duplicate tensor(-0.5040, dtype=torch.float64) tensor(0.0923, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4467, dtype=torch.float64) delta_t tensor(0.0855, dtype=torch.float64)
2 gae_duplicate tensor(-0.3177, dtype=torch.float64) tensor(0.0358, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-26.21946907043457
value loss:17.509883880615234
entropies:8.682634353637695
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.429084062576294 seconds
19 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(-0.8918, dtype=torch.float64)
19 gae_duplicate tensor(-0.8918, dtype=torch.float64) tensor(0.0838, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.5449, dtype=torch.float64)
18 gae_duplicate tensor(-0.1685, dtype=torch.float64) tensor(0.0158, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(0.5450, dtype=torch.float64)
17 gae_duplicate tensor(0.4102, dtype=torch.float64) tensor(-0.0385, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(0.5451, dtype=torch.float64)
16 gae_duplicate tensor(0.8733, dtype=torch.float64) tensor(-0.0821, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2283, dtype=torch.float64) delta_t tensor(-0.1308, dtype=torch.float64)
15 gae_duplicate tensor(0.5678, dtype=torch.float64) tensor(-0.0534, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2284, dtype=torch.float64) delta_t tensor(-0.1308, dtype=torch.float64)
14 gae_duplicate tensor(0.3234, dtype=torch.float64) tensor(-0.0304, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(0.5452, dtype=torch.float64)
13 gae_duplicate tensor(0.8039, dtype=torch.float64) tensor(-0.0755, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7693, dtype=torch.float64) delta_t tensor(0.5208, dtype=torch.float64)
12 gae_duplicate tensor(1.1640, dtype=torch.float64) tensor(-0.1092, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4314, dtype=torch.float64) delta_t tensor(-0.0064, dtype=torch.float64)
11 gae_duplicate tensor(0.9248, dtype=torch.float64) tensor(-0.0869, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0418, dtype=torch.float64) delta_t tensor(0.0336, dtype=torch.float64)
10 gae_duplicate tensor(0.7734, dtype=torch.float64) tensor(-0.0719, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8369, dtype=torch.float64) delta_t tensor(0.3096, dtype=torch.float64)
9 gae_duplicate tensor(0.9282, dtype=torch.float64) tensor(-0.0873, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5148, dtype=torch.float64) delta_t tensor(-0.4432, dtype=torch.float64)
8 gae_duplicate tensor(0.2994, dtype=torch.float64) tensor(-0.0279, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7693, dtype=torch.float64) delta_t tensor(0.3856, dtype=torch.float64)
7 gae_duplicate tensor(0.6251, dtype=torch.float64) tensor(-0.0637, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3119, dtype=torch.float64) delta_t tensor(-0.0735, dtype=torch.float64)
6 gae_duplicate tensor(0.4265, dtype=torch.float64) tensor(-0.0403, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2962, dtype=torch.float64) delta_t tensor(0.3819, dtype=torch.float64)
5 gae_duplicate tensor(0.7231, dtype=torch.float64) tensor(-0.0964, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3119, dtype=torch.float64) delta_t tensor(0.9298, dtype=torch.float64)
4 gae_duplicate tensor(1.5083, dtype=torch.float64) tensor(-5.3737, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1092, dtype=torch.float64) delta_t tensor(0.0445, dtype=torch.float64)
3 gae_duplicate tensor(1.2511, dtype=torch.float64) tensor(-2.6332, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5822, dtype=torch.float64) delta_t tensor(-0.2294, dtype=torch.float64)
2 gae_duplicate tensor(0.7715, dtype=torch.float64) tensor(-0.0881, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:52.91585159301758
value loss:18.17760467529297
entropies:7.946785926818848
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.254647731781006 seconds
19 rew tensor(0.9038, dtype=torch.float64) delta_t tensor(-1.0202, dtype=torch.float64)
19 gae_duplicate tensor(-1.0202, dtype=torch.float64) tensor(0.0963, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9039, dtype=torch.float64) delta_t tensor(0.4974, dtype=torch.float64)
18 gae_duplicate tensor(-0.3188, dtype=torch.float64) tensor(0.0301, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(0.5680, dtype=torch.float64)
17 gae_duplicate tensor(0.3130, dtype=torch.float64) tensor(-0.0295, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.5563, dtype=torch.float64)
16 gae_duplicate tensor(0.8067, dtype=torch.float64) tensor(-0.0761, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(2.8717, dtype=torch.float64)
15 gae_duplicate tensor(3.5171, dtype=torch.float64) tensor(-0.3289, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(0.4903, dtype=torch.float64)
14 gae_duplicate tensor(3.3040, dtype=torch.float64) tensor(-7.6058, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9044, dtype=torch.float64) delta_t tensor(0.8981, dtype=torch.float64)
13 gae_duplicate tensor(3.5413, dtype=torch.float64) tensor(-0.6597, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9045, dtype=torch.float64) delta_t tensor(0.8982, dtype=torch.float64)
12 gae_duplicate tensor(3.7312, dtype=torch.float64) tensor(-0.6951, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9046, dtype=torch.float64) delta_t tensor(0.8983, dtype=torch.float64)
11 gae_duplicate tensor(3.8833, dtype=torch.float64) tensor(-0.7234, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.2590, dtype=torch.float64) delta_t tensor(-2.8725, dtype=torch.float64)
10 gae_duplicate tensor(0.2341, dtype=torch.float64) tensor(-0.0354, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.3411, dtype=torch.float64) delta_t tensor(-2.6787, dtype=torch.float64)
9 gae_duplicate tensor(-2.4915, dtype=torch.float64) tensor(0.3215, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0252, dtype=torch.float64) delta_t tensor(0.0866, dtype=torch.float64)
8 gae_duplicate tensor(-1.9065, dtype=torch.float64) tensor(0.3804, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7692, dtype=torch.float64) delta_t tensor(0.4264, dtype=torch.float64)
7 gae_duplicate tensor(-1.0989, dtype=torch.float64) tensor(0.1950, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3128, dtype=torch.float64) delta_t tensor(0.7245, dtype=torch.float64)
6 gae_duplicate tensor(-0.1546, dtype=torch.float64) tensor(0.0427, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2958, dtype=torch.float64) delta_t tensor(0.4413, dtype=torch.float64)
5 gae_duplicate tensor(0.3176, dtype=torch.float64) tensor(-0.0810, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1775, dtype=torch.float64) delta_t tensor(0.1362, dtype=torch.float64)
4 gae_duplicate tensor(0.3903, dtype=torch.float64) tensor(-0.1098, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0423, dtype=torch.float64) delta_t tensor(0.4053, dtype=torch.float64)
3 gae_duplicate tensor(0.7175, dtype=torch.float64) tensor(-0.1483, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5832, dtype=torch.float64) delta_t tensor(-0.0491, dtype=torch.float64)
2 gae_duplicate tensor(0.5249, dtype=torch.float64) tensor(-0.0631, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:56.62622833251953
value loss:118.33769989013672
entropies:10.530920028686523
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.540101051330566 seconds
19 rew tensor(0.8366, dtype=torch.float64) delta_t tensor(-0.6799, dtype=torch.float64)
19 gae_duplicate tensor(-0.6799, dtype=torch.float64) tensor(0.0656, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7014, dtype=torch.float64) delta_t tensor(0.3728, dtype=torch.float64)
18 gae_duplicate tensor(-0.1712, dtype=torch.float64) tensor(0.0165, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4985, dtype=torch.float64) delta_t tensor(0.2545, dtype=torch.float64)
17 gae_duplicate tensor(0.1176, dtype=torch.float64) tensor(-0.0113, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0927, dtype=torch.float64) delta_t tensor(-0.0902, dtype=torch.float64)
16 gae_duplicate tensor(0.0039, dtype=torch.float64) tensor(-0.0009, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.6512, dtype=torch.float64) delta_t tensor(0.3340, dtype=torch.float64)
15 gae_duplicate tensor(0.3371, dtype=torch.float64) tensor(-1.2129, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(0.8829, dtype=torch.float64)
14 gae_duplicate tensor(1.1526, dtype=torch.float64) tensor(-0.1856, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9044, dtype=torch.float64) delta_t tensor(0.8830, dtype=torch.float64)
13 gae_duplicate tensor(1.8051, dtype=torch.float64) tensor(-0.2907, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2281, dtype=torch.float64) delta_t tensor(0.2068, dtype=torch.float64)
12 gae_duplicate tensor(1.6509, dtype=torch.float64) tensor(-0.2658, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.9359, dtype=torch.float64) delta_t tensor(-1.8486, dtype=torch.float64)
11 gae_duplicate tensor(-0.5278, dtype=torch.float64) tensor(0.0844, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6338, dtype=torch.float64) delta_t tensor(-0.9365, dtype=torch.float64)
10 gae_duplicate tensor(-1.3588, dtype=torch.float64) tensor(0.1678, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2957, dtype=torch.float64) delta_t tensor(0.4685, dtype=torch.float64)
9 gae_duplicate tensor(-0.6185, dtype=torch.float64) tensor(0.1502, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6339, dtype=torch.float64) delta_t tensor(0.1237, dtype=torch.float64)
8 gae_duplicate tensor(-0.3711, dtype=torch.float64) tensor(0.0645, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9216, dtype=torch.float64) delta_t tensor(-0.1993, dtype=torch.float64)
7 gae_duplicate tensor(-0.4962, dtype=torch.float64) tensor(0.1517, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7014, dtype=torch.float64) delta_t tensor(0.9099, dtype=torch.float64)
6 gae_duplicate tensor(0.5129, dtype=torch.float64) tensor(-0.1345, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1245, dtype=torch.float64) delta_t tensor(-0.4465, dtype=torch.float64)
5 gae_duplicate tensor(-0.0361, dtype=torch.float64) tensor(0.0125, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5836, dtype=torch.float64) delta_t tensor(-0.5334, dtype=torch.float64)
4 gae_duplicate tensor(-0.5623, dtype=torch.float64) tensor(0.0982, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8009, dtype=torch.float64) delta_t tensor(0.4080, dtype=torch.float64)
3 gae_duplicate tensor(-0.0418, dtype=torch.float64) tensor(0.0104, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3134, dtype=torch.float64) delta_t tensor(-1.1565, dtype=torch.float64)
2 gae_duplicate tensor(-1.1899, dtype=torch.float64) tensor(4.1990, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-17.84294319152832
value loss:19.23211669921875
entropies:10.96533203125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.479663133621216 seconds
19 rew tensor(0.7019, dtype=torch.float64) delta_t tensor(-0.6707, dtype=torch.float64)
19 gae_duplicate tensor(-0.6707, dtype=torch.float64) tensor(0.0644, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4989, dtype=torch.float64) delta_t tensor(0.3135, dtype=torch.float64)
18 gae_duplicate tensor(-0.2231, dtype=torch.float64) tensor(0.0214, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.0928, dtype=torch.float64) delta_t tensor(-0.6948, dtype=torch.float64)
17 gae_duplicate tensor(-0.8732, dtype=torch.float64) tensor(0.0826, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.9901, dtype=torch.float64) delta_t tensor(-1.0526, dtype=torch.float64)
16 gae_duplicate tensor(-1.7511, dtype=torch.float64) tensor(6.1088, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4988, dtype=torch.float64) delta_t tensor(0.1426, dtype=torch.float64)
15 gae_duplicate tensor(-1.2583, dtype=torch.float64) tensor(4.4213, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4988, dtype=torch.float64) delta_t tensor(0.2058, dtype=torch.float64)
14 gae_duplicate tensor(-0.8008, dtype=torch.float64) tensor(0.0778, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-1.8022, dtype=torch.float64) delta_t tensor(-0.4966, dtype=torch.float64)
13 gae_duplicate tensor(-1.1372, dtype=torch.float64) tensor(0.1328, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0926, dtype=torch.float64) delta_t tensor(-1.0471, dtype=torch.float64)
12 gae_duplicate tensor(-1.9569, dtype=torch.float64) tensor(6.6379, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7694, dtype=torch.float64) delta_t tensor(0.1289, dtype=torch.float64)
11 gae_duplicate tensor(-1.4366, dtype=torch.float64) tensor(0.1347, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3634, dtype=torch.float64) delta_t tensor(-0.0908, dtype=torch.float64)
10 gae_duplicate tensor(-1.2401, dtype=torch.float64) tensor(8.6611, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0927, dtype=torch.float64) delta_t tensor(0.3501, dtype=torch.float64)
9 gae_duplicate tensor(-0.6420, dtype=torch.float64) tensor(0.0626, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7694, dtype=torch.float64) delta_t tensor(0.3525, dtype=torch.float64)
8 gae_duplicate tensor(-0.1612, dtype=torch.float64) tensor(0.0154, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5162, dtype=torch.float64) delta_t tensor(-0.5911, dtype=torch.float64)
7 gae_duplicate tensor(-0.7200, dtype=torch.float64) tensor(0.0725, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5664, dtype=torch.float64) delta_t tensor(2.0351, dtype=torch.float64)
6 gae_duplicate tensor(1.4592, dtype=torch.float64) tensor(-5.1962, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6515, dtype=torch.float64) delta_t tensor(-0.7991, dtype=torch.float64)
5 gae_duplicate tensor(0.3683, dtype=torch.float64) tensor(-0.5876, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3634, dtype=torch.float64) delta_t tensor(0.4994, dtype=torch.float64)
4 gae_duplicate tensor(0.7941, dtype=torch.float64) tensor(-0.2247, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4485, dtype=torch.float64) delta_t tensor(0.0263, dtype=torch.float64)
3 gae_duplicate tensor(0.6615, dtype=torch.float64) tensor(-0.1312, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4486, dtype=torch.float64) delta_t tensor(0.1516, dtype=torch.float64)
2 gae_duplicate tensor(0.6808, dtype=torch.float64) tensor(-0.0828, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-121.88955688476562
value loss:30.045913696289062
entropies:8.78437614440918
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(404.3545)
ToM Target loss= tensor(313.9657)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.196353912353516 seconds
19 rew tensor(0.9047, dtype=torch.float64) delta_t tensor(-0.8970, dtype=torch.float64)
19 gae_duplicate tensor(-0.8970, dtype=torch.float64) tensor(0.0835, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9048, dtype=torch.float64) delta_t tensor(0.5445, dtype=torch.float64)
18 gae_duplicate tensor(-0.1731, dtype=torch.float64) tensor(0.0161, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9049, dtype=torch.float64) delta_t tensor(0.5446, dtype=torch.float64)
17 gae_duplicate tensor(0.4061, dtype=torch.float64) tensor(-0.0378, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9050, dtype=torch.float64) delta_t tensor(0.5447, dtype=torch.float64)
16 gae_duplicate tensor(0.8695, dtype=torch.float64) tensor(-0.0810, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9051, dtype=torch.float64) delta_t tensor(0.5448, dtype=torch.float64)
15 gae_duplicate tensor(1.2404, dtype=torch.float64) tensor(-0.1155, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9052, dtype=torch.float64) delta_t tensor(0.5449, dtype=torch.float64)
14 gae_duplicate tensor(1.5372, dtype=torch.float64) tensor(-0.1431, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9053, dtype=torch.float64) delta_t tensor(0.5450, dtype=torch.float64)
13 gae_duplicate tensor(1.7747, dtype=torch.float64) tensor(-0.1653, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9054, dtype=torch.float64) delta_t tensor(0.5451, dtype=torch.float64)
12 gae_duplicate tensor(1.9649, dtype=torch.float64) tensor(-0.1830, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.9378, dtype=torch.float64) delta_t tensor(-2.3007, dtype=torch.float64)
11 gae_duplicate tensor(-0.7288, dtype=torch.float64) tensor(0.0679, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0425, dtype=torch.float64) delta_t tensor(-0.4242, dtype=torch.float64)
10 gae_duplicate tensor(-1.0073, dtype=torch.float64) tensor(0.0941, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2283, dtype=torch.float64) delta_t tensor(0.4655, dtype=torch.float64)
9 gae_duplicate tensor(-0.3404, dtype=torch.float64) tensor(0.0320, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7700, dtype=torch.float64) delta_t tensor(0.2717, dtype=torch.float64)
8 gae_duplicate tensor(-0.0006, dtype=torch.float64) tensor(5.1414e-05, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3287, dtype=torch.float64) delta_t tensor(-1.1549, dtype=torch.float64)
7 gae_duplicate tensor(-1.1554, dtype=torch.float64) tensor(0.1162, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6345, dtype=torch.float64) delta_t tensor(1.9576, dtype=torch.float64)
6 gae_duplicate tensor(1.0333, dtype=torch.float64) tensor(-0.1306, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5319, dtype=torch.float64) delta_t tensor(-1.3026, dtype=torch.float64)
5 gae_duplicate tensor(-0.4759, dtype=torch.float64) tensor(2.2712, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7698, dtype=torch.float64) delta_t tensor(0.5195, dtype=torch.float64)
4 gae_duplicate tensor(0.1387, dtype=torch.float64) tensor(-0.0375, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7873, dtype=torch.float64) delta_t tensor(0.2656, dtype=torch.float64)
3 gae_duplicate tensor(0.3766, dtype=torch.float64) tensor(-0.0682, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3134, dtype=torch.float64) delta_t tensor(-0.1811, dtype=torch.float64)
2 gae_duplicate tensor(0.1202, dtype=torch.float64) tensor(-0.0134, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-10.493026733398438
value loss:25.700908660888672
entropies:8.627381324768066
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.42128324508667 seconds
19 rew tensor(0.9038, dtype=torch.float64) delta_t tensor(-0.8461, dtype=torch.float64)
19 gae_duplicate tensor(-0.8461, dtype=torch.float64) tensor(0.0780, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9039, dtype=torch.float64) delta_t tensor(0.5539, dtype=torch.float64)
18 gae_duplicate tensor(-0.1230, dtype=torch.float64) tensor(0.0113, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(0.5540, dtype=torch.float64)
17 gae_duplicate tensor(0.4556, dtype=torch.float64) tensor(-0.0420, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.5541, dtype=torch.float64)
16 gae_duplicate tensor(0.9186, dtype=torch.float64) tensor(-0.0847, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(0.5669, dtype=torch.float64)
15 gae_duplicate tensor(1.3018, dtype=torch.float64) tensor(-0.1200, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(0.9342, dtype=torch.float64)
14 gae_duplicate tensor(1.9756, dtype=torch.float64) tensor(-0.1809, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9044, dtype=torch.float64) delta_t tensor(0.2933, dtype=torch.float64)
13 gae_duplicate tensor(1.8739, dtype=torch.float64) tensor(-6.7002, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9045, dtype=torch.float64) delta_t tensor(0.5591, dtype=torch.float64)
12 gae_duplicate tensor(2.0582, dtype=torch.float64) tensor(-0.1871, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9046, dtype=torch.float64) delta_t tensor(0.5637, dtype=torch.float64)
11 gae_duplicate tensor(2.2103, dtype=torch.float64) tensor(-0.2009, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9047, dtype=torch.float64) delta_t tensor(0.5638, dtype=torch.float64)
10 gae_duplicate tensor(2.3320, dtype=torch.float64) tensor(-0.2120, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-4.6424, dtype=torch.float64) delta_t tensor(-4.5815, dtype=torch.float64)
9 gae_duplicate tensor(-2.7159, dtype=torch.float64) tensor(0.2459, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3139, dtype=torch.float64) delta_t tensor(-0.7410, dtype=torch.float64)
8 gae_duplicate tensor(-2.9137, dtype=torch.float64) tensor(0.2651, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1107, dtype=torch.float64) delta_t tensor(-0.0438, dtype=torch.float64)
7 gae_duplicate tensor(-2.3748, dtype=torch.float64) tensor(0.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6343, dtype=torch.float64) delta_t tensor(0.2916, dtype=torch.float64)
6 gae_duplicate tensor(-1.6082, dtype=torch.float64) tensor(5.7742, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5169, dtype=torch.float64) delta_t tensor(0.0212, dtype=torch.float64)
5 gae_duplicate tensor(-1.2654, dtype=torch.float64) tensor(0.1195, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3634, dtype=torch.float64) delta_t tensor(0.9873, dtype=torch.float64)
4 gae_duplicate tensor(-0.0250, dtype=torch.float64) tensor(0.0026, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4492, dtype=torch.float64) delta_t tensor(-0.2239, dtype=torch.float64)
3 gae_duplicate tensor(-0.2439, dtype=torch.float64) tensor(0.0223, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4492, dtype=torch.float64) delta_t tensor(-1.0449, dtype=torch.float64)
2 gae_duplicate tensor(-1.2400, dtype=torch.float64) tensor(0.1141, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4.943325996398926
value loss:79.11276245117188
entropies:7.404113292694092
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.356136798858643 seconds
19 rew tensor(0.9035, dtype=torch.float64) delta_t tensor(-0.8065, dtype=torch.float64)
19 gae_duplicate tensor(-0.8065, dtype=torch.float64) tensor(0.0723, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9036, dtype=torch.float64) delta_t tensor(0.5887, dtype=torch.float64)
18 gae_duplicate tensor(-0.0565, dtype=torch.float64) tensor(0.0051, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9037, dtype=torch.float64) delta_t tensor(0.5982, dtype=torch.float64)
17 gae_duplicate tensor(0.5530, dtype=torch.float64) tensor(-0.0496, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9038, dtype=torch.float64) delta_t tensor(0.7751, dtype=torch.float64)
16 gae_duplicate tensor(1.2174, dtype=torch.float64) tensor(-0.1097, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9039, dtype=torch.float64) delta_t tensor(1.2142, dtype=torch.float64)
15 gae_duplicate tensor(2.1881, dtype=torch.float64) tensor(-0.2035, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(0.0968, dtype=torch.float64)
14 gae_duplicate tensor(1.8473, dtype=torch.float64) tensor(-0.1665, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.6346, dtype=torch.float64)
13 gae_duplicate tensor(2.1125, dtype=torch.float64) tensor(-7.5734, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(0.6124, dtype=torch.float64)
12 gae_duplicate tensor(2.3024, dtype=torch.float64) tensor(-0.2075, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0922, dtype=torch.float64) delta_t tensor(-0.1936, dtype=torch.float64)
11 gae_duplicate tensor(1.6483, dtype=torch.float64) tensor(-0.1487, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4982, dtype=torch.float64) delta_t tensor(-0.0933, dtype=torch.float64)
10 gae_duplicate tensor(1.2253, dtype=torch.float64) tensor(-0.1102, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0246, dtype=torch.float64) delta_t tensor(0.3126, dtype=torch.float64)
9 gae_duplicate tensor(1.2929, dtype=torch.float64) tensor(-0.1158, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7689, dtype=torch.float64) delta_t tensor(0.2364, dtype=torch.float64)
8 gae_duplicate tensor(1.2707, dtype=torch.float64) tensor(-0.1144, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3287, dtype=torch.float64) delta_t tensor(-1.0945, dtype=torch.float64)
7 gae_duplicate tensor(-0.0779, dtype=torch.float64) tensor(0.0074, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6335, dtype=torch.float64) delta_t tensor(0.1407, dtype=torch.float64)
6 gae_duplicate tensor(0.0784, dtype=torch.float64) tensor(-0.0085, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3965, dtype=torch.float64) delta_t tensor(0.6783, dtype=torch.float64)
5 gae_duplicate tensor(0.7410, dtype=torch.float64) tensor(-0.1160, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7011, dtype=torch.float64) delta_t tensor(0.0866, dtype=torch.float64)
4 gae_duplicate tensor(0.6794, dtype=torch.float64) tensor(-1.2427, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7876, dtype=torch.float64) delta_t tensor(0.2265, dtype=torch.float64)
3 gae_duplicate tensor(0.7700, dtype=torch.float64) tensor(-0.1387, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3140, dtype=torch.float64) delta_t tensor(-0.1520, dtype=torch.float64)
2 gae_duplicate tensor(0.4640, dtype=torch.float64) tensor(-0.0509, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:61.383522033691406
value loss:44.61161804199219
entropies:8.119331359863281
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.736845254898071 seconds
19 rew tensor(0.7010, dtype=torch.float64) delta_t tensor(-1.1419, dtype=torch.float64)
19 gae_duplicate tensor(-1.1419, dtype=torch.float64) tensor(0.1022, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7011, dtype=torch.float64) delta_t tensor(0.3121, dtype=torch.float64)
18 gae_duplicate tensor(-0.6014, dtype=torch.float64) tensor(0.0538, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4979, dtype=torch.float64) delta_t tensor(0.0429, dtype=torch.float64)
17 gae_duplicate tensor(-0.4383, dtype=torch.float64) tensor(0.0393, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0239, dtype=torch.float64) delta_t tensor(-0.2709, dtype=torch.float64)
16 gae_duplicate tensor(-0.6215, dtype=torch.float64) tensor(0.0556, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.8564, dtype=torch.float64) delta_t tensor(-0.8744, dtype=torch.float64)
15 gae_duplicate tensor(-1.3716, dtype=torch.float64) tensor(4.9209, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2270, dtype=torch.float64) delta_t tensor(-0.0728, dtype=torch.float64)
14 gae_duplicate tensor(-1.1701, dtype=torch.float64) tensor(0.1055, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.4501, dtype=torch.float64) delta_t tensor(-0.7500, dtype=torch.float64)
13 gae_duplicate tensor(-1.6861, dtype=torch.float64) tensor(0.1520, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-1.8044, dtype=torch.float64) delta_t tensor(-2.1042, dtype=torch.float64)
12 gae_duplicate tensor(-3.4530, dtype=torch.float64) tensor(0.3113, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7685, dtype=torch.float64) delta_t tensor(0.4932, dtype=torch.float64)
11 gae_duplicate tensor(-2.2692, dtype=torch.float64) tensor(0.2051, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6331, dtype=torch.float64) delta_t tensor(0.3825, dtype=torch.float64)
10 gae_duplicate tensor(-1.4329, dtype=torch.float64) tensor(0.1271, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.7686, dtype=torch.float64) delta_t tensor(0.1626, dtype=torch.float64)
9 gae_duplicate tensor(-0.9837, dtype=torch.float64) tensor(0.0879, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5179, dtype=torch.float64) delta_t tensor(-0.4121, dtype=torch.float64)
8 gae_duplicate tensor(-1.1991, dtype=torch.float64) tensor(4.2998, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7686, dtype=torch.float64) delta_t tensor(1.5995, dtype=torch.float64)
7 gae_duplicate tensor(0.6402, dtype=torch.float64) tensor(-2.1306, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3824, dtype=torch.float64) delta_t tensor(-0.3000, dtype=torch.float64)
6 gae_duplicate tensor(0.2121, dtype=torch.float64) tensor(-0.3197, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2946, dtype=torch.float64) delta_t tensor(0.4072, dtype=torch.float64)
5 gae_duplicate tensor(0.5769, dtype=torch.float64) tensor(-0.1619, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1792, dtype=torch.float64) delta_t tensor(0.1828, dtype=torch.float64)
4 gae_duplicate tensor(0.6443, dtype=torch.float64) tensor(-0.2075, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0439, dtype=torch.float64) delta_t tensor(0.3723, dtype=torch.float64)
3 gae_duplicate tensor(0.8877, dtype=torch.float64) tensor(-0.2011, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5854, dtype=torch.float64) delta_t tensor(-0.1520, dtype=torch.float64)
2 gae_duplicate tensor(0.5582, dtype=torch.float64) tensor(-0.0687, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-44.49044418334961
value loss:48.256553649902344
entropies:8.817767143249512
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.626807928085327 seconds
19 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(1.5597, dtype=torch.float64)
19 gae_duplicate tensor(1.5597, dtype=torch.float64) tensor(-0.4362, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(1.0354, dtype=torch.float64)
18 gae_duplicate tensor(2.2832, dtype=torch.float64) tensor(-0.6385, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9044, dtype=torch.float64) delta_t tensor(1.0355, dtype=torch.float64)
17 gae_duplicate tensor(2.8620, dtype=torch.float64) tensor(-0.8004, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9045, dtype=torch.float64) delta_t tensor(-1.2801, dtype=torch.float64)
16 gae_duplicate tensor(1.0096, dtype=torch.float64) tensor(-0.1418, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8368, dtype=torch.float64) delta_t tensor(0.5122, dtype=torch.float64)
15 gae_duplicate tensor(1.3199, dtype=torch.float64) tensor(-0.1803, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8369, dtype=torch.float64) delta_t tensor(0.5181, dtype=torch.float64)
14 gae_duplicate tensor(1.5740, dtype=torch.float64) tensor(-0.2150, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8370, dtype=torch.float64) delta_t tensor(0.5241, dtype=torch.float64)
13 gae_duplicate tensor(1.7833, dtype=torch.float64) tensor(-0.2435, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7016, dtype=torch.float64) delta_t tensor(0.4330, dtype=torch.float64)
12 gae_duplicate tensor(1.8596, dtype=torch.float64) tensor(-0.2537, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9049, dtype=torch.float64) delta_t tensor(0.5911, dtype=torch.float64)
11 gae_duplicate tensor(2.0788, dtype=torch.float64) tensor(-0.2836, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9050, dtype=torch.float64) delta_t tensor(0.5912, dtype=torch.float64)
10 gae_duplicate tensor(2.2542, dtype=torch.float64) tensor(-0.3075, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5176, dtype=torch.float64) delta_t tensor(-0.8132, dtype=torch.float64)
9 gae_duplicate tensor(0.9902, dtype=torch.float64) tensor(-0.1350, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5854, dtype=torch.float64) delta_t tensor(-0.8629, dtype=torch.float64)
8 gae_duplicate tensor(-0.0707, dtype=torch.float64) tensor(0.0096, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0435, dtype=torch.float64) delta_t tensor(-0.3141, dtype=torch.float64)
7 gae_duplicate tensor(-0.3707, dtype=torch.float64) tensor(0.0592, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1273, dtype=torch.float64) delta_t tensor(-0.6556, dtype=torch.float64)
6 gae_duplicate tensor(-0.9521, dtype=torch.float64) tensor(0.2217, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2630, dtype=torch.float64) delta_t tensor(-1.4434, dtype=torch.float64)
5 gae_duplicate tensor(-2.2051, dtype=torch.float64) tensor(0.4877, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0239, dtype=torch.float64) delta_t tensor(1.1454, dtype=torch.float64)
4 gae_duplicate tensor(-0.6187, dtype=torch.float64) tensor(0.2265, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2949, dtype=torch.float64) delta_t tensor(0.5252, dtype=torch.float64)
3 gae_duplicate tensor(0.0302, dtype=torch.float64) tensor(-0.0077, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7889, dtype=torch.float64) delta_t tensor(0.7342, dtype=torch.float64)
2 gae_duplicate tensor(0.7584, dtype=torch.float64) tensor(-0.1243, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:16.239765167236328
value loss:67.45061492919922
entropies:11.26045036315918
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(390.9573)
ToM Target loss= tensor(313.6859)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.493740081787109 seconds
19 rew tensor(0.9039, dtype=torch.float64) delta_t tensor(-1.0089, dtype=torch.float64)
19 gae_duplicate tensor(-1.0089, dtype=torch.float64) tensor(0.0880, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(0.4625, dtype=torch.float64)
18 gae_duplicate tensor(-0.3447, dtype=torch.float64) tensor(0.0301, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.6150, dtype=torch.float64)
17 gae_duplicate tensor(0.3393, dtype=torch.float64) tensor(-1.2251, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(0.5317, dtype=torch.float64)
16 gae_duplicate tensor(0.8031, dtype=torch.float64) tensor(-0.0700, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(0.8813, dtype=torch.float64)
15 gae_duplicate tensor(1.5238, dtype=torch.float64) tensor(-0.1341, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9044, dtype=torch.float64) delta_t tensor(0.6013, dtype=torch.float64)
14 gae_duplicate tensor(1.8203, dtype=torch.float64) tensor(-0.1602, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9045, dtype=torch.float64) delta_t tensor(0.6014, dtype=torch.float64)
13 gae_duplicate tensor(2.0576, dtype=torch.float64) tensor(-0.1811, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9046, dtype=torch.float64) delta_t tensor(0.6015, dtype=torch.float64)
12 gae_duplicate tensor(2.2475, dtype=torch.float64) tensor(-0.1978, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9047, dtype=torch.float64) delta_t tensor(0.6016, dtype=torch.float64)
11 gae_duplicate tensor(2.3996, dtype=torch.float64) tensor(-0.2112, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.9412, dtype=torch.float64) delta_t tensor(-2.6028, dtype=torch.float64)
10 gae_duplicate tensor(-0.6831, dtype=torch.float64) tensor(0.0596, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4303, dtype=torch.float64) delta_t tensor(0.3580, dtype=torch.float64)
9 gae_duplicate tensor(-0.1885, dtype=torch.float64) tensor(0.0164, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0441, dtype=torch.float64) delta_t tensor(-0.6311, dtype=torch.float64)
8 gae_duplicate tensor(-0.7818, dtype=torch.float64) tensor(0.0682, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9250, dtype=torch.float64) delta_t tensor(-0.5461, dtype=torch.float64)
7 gae_duplicate tensor(-1.1716, dtype=torch.float64) tensor(0.1197, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7012, dtype=torch.float64) delta_t tensor(2.0837, dtype=torch.float64)
6 gae_duplicate tensor(1.1464, dtype=torch.float64) tensor(-0.1401, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8737, dtype=torch.float64) delta_t tensor(-0.7599, dtype=torch.float64)
5 gae_duplicate tensor(0.1573, dtype=torch.float64) tensor(-0.1714, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7689, dtype=torch.float64) delta_t tensor(-0.1397, dtype=torch.float64)
4 gae_duplicate tensor(-0.0139, dtype=torch.float64) tensor(0.0040, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1286, dtype=torch.float64) delta_t tensor(0.5865, dtype=torch.float64)
3 gae_duplicate tensor(0.5754, dtype=torch.float64) tensor(-0.0961, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1799, dtype=torch.float64) delta_t tensor(-0.6092, dtype=torch.float64)
2 gae_duplicate tensor(-0.1489, dtype=torch.float64) tensor(0.0160, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:12.861786842346191
value loss:40.1302604675293
entropies:8.381150245666504
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.421005010604858 seconds
19 rew tensor(0.7682, dtype=torch.float64) delta_t tensor(-0.8175, dtype=torch.float64)
19 gae_duplicate tensor(-0.8175, dtype=torch.float64) tensor(0.0706, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7005, dtype=torch.float64) delta_t tensor(0.1079, dtype=torch.float64)
18 gae_duplicate tensor(-0.5461, dtype=torch.float64) tensor(0.0472, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4974, dtype=torch.float64) delta_t tensor(0.5061, dtype=torch.float64)
17 gae_duplicate tensor(0.0693, dtype=torch.float64) tensor(-0.0060, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.0444, dtype=torch.float64) delta_t tensor(-0.6148, dtype=torch.float64)
16 gae_duplicate tensor(-0.5594, dtype=torch.float64) tensor(0.0483, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7895, dtype=torch.float64) delta_t tensor(0.4336, dtype=torch.float64)
15 gae_duplicate tensor(-0.0139, dtype=torch.float64) tensor(0.0017, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8359, dtype=torch.float64) delta_t tensor(-0.4645, dtype=torch.float64)
14 gae_duplicate tensor(-0.4756, dtype=torch.float64) tensor(1.6686, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9037, dtype=torch.float64) delta_t tensor(0.6148, dtype=torch.float64)
13 gae_duplicate tensor(0.2343, dtype=torch.float64) tensor(-0.0211, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2266, dtype=torch.float64) delta_t tensor(-0.0624, dtype=torch.float64)
12 gae_duplicate tensor(0.1250, dtype=torch.float64) tensor(-0.0113, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-4.5139, dtype=torch.float64) delta_t tensor(-4.8029, dtype=torch.float64)
11 gae_duplicate tensor(-4.7029, dtype=torch.float64) tensor(0.4244, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7687, dtype=torch.float64) delta_t tensor(0.2075, dtype=torch.float64)
10 gae_duplicate tensor(-3.5548, dtype=torch.float64) tensor(0.3031, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4976, dtype=torch.float64) delta_t tensor(0.0910, dtype=torch.float64)
9 gae_duplicate tensor(-2.7529, dtype=torch.float64) tensor(0.2349, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1587, dtype=torch.float64) delta_t tensor(0.2449, dtype=torch.float64)
8 gae_duplicate tensor(-1.9574, dtype=torch.float64) tensor(0.1661, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7688, dtype=torch.float64) delta_t tensor(0.2810, dtype=torch.float64)
7 gae_duplicate tensor(-1.2849, dtype=torch.float64) tensor(0.1143, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3158, dtype=torch.float64) delta_t tensor(-0.1820, dtype=torch.float64)
6 gae_duplicate tensor(-1.2099, dtype=torch.float64) tensor(0.1108, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2943, dtype=torch.float64) delta_t tensor(1.9580, dtype=torch.float64)
5 gae_duplicate tensor(0.9901, dtype=torch.float64) tensor(-0.1180, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2480, dtype=torch.float64) delta_t tensor(-0.5220, dtype=torch.float64)
4 gae_duplicate tensor(0.2700, dtype=torch.float64) tensor(-0.3971, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0446, dtype=torch.float64) delta_t tensor(0.3481, dtype=torch.float64)
3 gae_duplicate tensor(0.5641, dtype=torch.float64) tensor(-0.1304, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5868, dtype=torch.float64) delta_t tensor(0.0533, dtype=torch.float64)
2 gae_duplicate tensor(0.5045, dtype=torch.float64) tensor(-0.0654, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-14.887262344360352
value loss:78.72734069824219
entropies:8.086098670959473
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.615834951400757 seconds
19 rew tensor(0.8363, dtype=torch.float64) delta_t tensor(-0.8463, dtype=torch.float64)
19 gae_duplicate tensor(-0.8463, dtype=torch.float64) tensor(0.0715, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7686, dtype=torch.float64) delta_t tensor(0.4211, dtype=torch.float64)
18 gae_duplicate tensor(-0.2560, dtype=torch.float64) tensor(0.0216, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6331, dtype=torch.float64) delta_t tensor(0.1994, dtype=torch.float64)
17 gae_duplicate tensor(-0.0054, dtype=torch.float64) tensor(0.0005, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2943, dtype=torch.float64) delta_t tensor(0.0660, dtype=torch.float64)
16 gae_duplicate tensor(0.0617, dtype=torch.float64) tensor(-0.0052, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1800, dtype=torch.float64) delta_t tensor(-0.2958, dtype=torch.float64)
15 gae_duplicate tensor(-0.2464, dtype=torch.float64) tensor(0.0209, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(0.6155, dtype=torch.float64)
14 gae_duplicate tensor(0.4184, dtype=torch.float64) tensor(-0.0356, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-1.8062, dtype=torch.float64) delta_t tensor(-2.0948, dtype=torch.float64)
13 gae_duplicate tensor(-1.7601, dtype=torch.float64) tensor(0.1496, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2265, dtype=torch.float64) delta_t tensor(-0.0622, dtype=torch.float64)
12 gae_duplicate tensor(-1.4702, dtype=torch.float64) tensor(0.1250, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7686, dtype=torch.float64) delta_t tensor(1.0566, dtype=torch.float64)
11 gae_duplicate tensor(-0.1195, dtype=torch.float64) tensor(0.0101, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5654, dtype=torch.float64) delta_t tensor(-0.3280, dtype=torch.float64)
10 gae_duplicate tensor(-0.4236, dtype=torch.float64) tensor(0.0358, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0234, dtype=torch.float64) delta_t tensor(0.0127, dtype=torch.float64)
9 gae_duplicate tensor(-0.3262, dtype=torch.float64) tensor(0.0273, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0911, dtype=torch.float64) delta_t tensor(1.1316, dtype=torch.float64)
8 gae_duplicate tensor(0.8706, dtype=torch.float64) tensor(-0.0802, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7219, dtype=torch.float64) delta_t tensor(-0.7812, dtype=torch.float64)
7 gae_duplicate tensor(-0.0847, dtype=torch.float64) tensor(0.1045, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6330, dtype=torch.float64) delta_t tensor(0.3910, dtype=torch.float64)
6 gae_duplicate tensor(0.3232, dtype=torch.float64) tensor(-0.0921, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3994, dtype=torch.float64) delta_t tensor(-0.0709, dtype=torch.float64)
5 gae_duplicate tensor(0.1877, dtype=torch.float64) tensor(-0.0839, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7685, dtype=torch.float64) delta_t tensor(0.0391, dtype=torch.float64)
4 gae_duplicate tensor(0.1893, dtype=torch.float64) tensor(-0.0536, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7897, dtype=torch.float64) delta_t tensor(-0.1349, dtype=torch.float64)
3 gae_duplicate tensor(0.0166, dtype=torch.float64) tensor(-0.0030, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3156, dtype=torch.float64) delta_t tensor(0.1844, dtype=torch.float64)
2 gae_duplicate tensor(0.1976, dtype=torch.float64) tensor(-0.0221, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1.4170143604278564
value loss:11.341306686401367
entropies:9.007235527038574
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4349799156188965 seconds
19 rew tensor(0.8368, dtype=torch.float64) delta_t tensor(-1.4074, dtype=torch.float64)
19 gae_duplicate tensor(-1.4074, dtype=torch.float64) tensor(0.1190, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7012, dtype=torch.float64) delta_t tensor(0.1418, dtype=torch.float64)
18 gae_duplicate tensor(-0.9841, dtype=torch.float64) tensor(0.0832, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4978, dtype=torch.float64) delta_t tensor(0.4280, dtype=torch.float64)
17 gae_duplicate tensor(-0.3593, dtype=torch.float64) tensor(0.0304, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0231, dtype=torch.float64) delta_t tensor(-0.4625, dtype=torch.float64)
16 gae_duplicate tensor(-0.7499, dtype=torch.float64) tensor(0.0634, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.6550, dtype=torch.float64) delta_t tensor(-0.8001, dtype=torch.float64)
15 gae_duplicate tensor(-1.4001, dtype=torch.float64) tensor(0.1189, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9046, dtype=torch.float64) delta_t tensor(0.5478, dtype=torch.float64)
14 gae_duplicate tensor(-0.5722, dtype=torch.float64) tensor(0.0486, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9047, dtype=torch.float64) delta_t tensor(0.5479, dtype=torch.float64)
13 gae_duplicate tensor(0.0901, dtype=torch.float64) tensor(-0.0077, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7692, dtype=torch.float64) delta_t tensor(0.4210, dtype=torch.float64)
12 gae_duplicate tensor(0.4931, dtype=torch.float64) tensor(-0.0419, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6336, dtype=torch.float64) delta_t tensor(0.4923, dtype=torch.float64)
11 gae_duplicate tensor(0.8868, dtype=torch.float64) tensor(-0.0754, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4303, dtype=torch.float64) delta_t tensor(-0.6096, dtype=torch.float64)
10 gae_duplicate tensor(0.0998, dtype=torch.float64) tensor(-0.0084, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2477, dtype=torch.float64) delta_t tensor(-0.1856, dtype=torch.float64)
9 gae_duplicate tensor(-0.1057, dtype=torch.float64) tensor(0.0089, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3624, dtype=torch.float64) delta_t tensor(-0.0732, dtype=torch.float64)
8 gae_duplicate tensor(-0.1578, dtype=torch.float64) tensor(0.0134, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8578, dtype=torch.float64) delta_t tensor(-1.4721, dtype=torch.float64)
7 gae_duplicate tensor(-1.5984, dtype=torch.float64) tensor(0.1357, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9935, dtype=torch.float64) delta_t tensor(0.4523, dtype=torch.float64)
6 gae_duplicate tensor(-0.8264, dtype=torch.float64) tensor(0.1172, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6547, dtype=torch.float64) delta_t tensor(-0.9178, dtype=torch.float64)
5 gae_duplicate tensor(-1.5789, dtype=torch.float64) tensor(5.8066, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3621, dtype=torch.float64) delta_t tensor(0.8895, dtype=torch.float64)
4 gae_duplicate tensor(-0.3737, dtype=torch.float64) tensor(0.0341, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4513, dtype=torch.float64) delta_t tensor(0.0441, dtype=torch.float64)
3 gae_duplicate tensor(-0.2548, dtype=torch.float64) tensor(0.0216, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4513, dtype=torch.float64) delta_t tensor(0.0552, dtype=torch.float64)
2 gae_duplicate tensor(-0.1487, dtype=torch.float64) tensor(0.0124, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-39.09271240234375
value loss:19.454002380371094
entropies:7.063067436218262
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.326704025268555 seconds
19 rew tensor(0.9038, dtype=torch.float64) delta_t tensor(-0.9845, dtype=torch.float64)
19 gae_duplicate tensor(-0.9845, dtype=torch.float64) tensor(0.0821, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9039, dtype=torch.float64) delta_t tensor(0.4878, dtype=torch.float64)
18 gae_duplicate tensor(-0.2997, dtype=torch.float64) tensor(0.0250, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(0.6212, dtype=torch.float64)
17 gae_duplicate tensor(0.3814, dtype=torch.float64) tensor(-0.0318, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.6183, dtype=torch.float64)
16 gae_duplicate tensor(0.9235, dtype=torch.float64) tensor(-0.0771, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(0.8818, dtype=torch.float64)
15 gae_duplicate tensor(1.6206, dtype=torch.float64) tensor(-0.1367, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(0.6206, dtype=torch.float64)
14 gae_duplicate tensor(1.9171, dtype=torch.float64) tensor(-0.1617, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9044, dtype=torch.float64) delta_t tensor(0.6207, dtype=torch.float64)
13 gae_duplicate tensor(2.1544, dtype=torch.float64) tensor(-0.1817, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9045, dtype=torch.float64) delta_t tensor(0.6208, dtype=torch.float64)
12 gae_duplicate tensor(2.3443, dtype=torch.float64) tensor(-0.1977, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9046, dtype=torch.float64) delta_t tensor(0.6209, dtype=torch.float64)
11 gae_duplicate tensor(2.4963, dtype=torch.float64) tensor(-0.2105, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-4.6524, dtype=torch.float64) delta_t tensor(-5.2830, dtype=torch.float64)
10 gae_duplicate tensor(-3.2859, dtype=torch.float64) tensor(0.2743, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7911, dtype=torch.float64) delta_t tensor(-0.7838, dtype=torch.float64)
9 gae_duplicate tensor(-3.4126, dtype=torch.float64) tensor(0.2832, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4980, dtype=torch.float64) delta_t tensor(-0.0399, dtype=torch.float64)
8 gae_duplicate tensor(-2.7699, dtype=torch.float64) tensor(0.2311, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2483, dtype=torch.float64) delta_t tensor(-0.0065, dtype=torch.float64)
7 gae_duplicate tensor(-2.2224, dtype=torch.float64) tensor(0.1870, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7015, dtype=torch.float64) delta_t tensor(0.2412, dtype=torch.float64)
6 gae_duplicate tensor(-1.5367, dtype=torch.float64) tensor(0.1447, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5874, dtype=torch.float64) delta_t tensor(1.6132, dtype=torch.float64)
5 gae_duplicate tensor(0.3838, dtype=torch.float64) tensor(-0.0539, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2944, dtype=torch.float64) delta_t tensor(-0.3249, dtype=torch.float64)
4 gae_duplicate tensor(-0.0178, dtype=torch.float64) tensor(0.0286, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4517, dtype=torch.float64) delta_t tensor(-0.0063, dtype=torch.float64)
3 gae_duplicate tensor(-0.0206, dtype=torch.float64) tensor(0.0041, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4518, dtype=torch.float64) delta_t tensor(0.2421, dtype=torch.float64)
2 gae_duplicate tensor(0.2256, dtype=torch.float64) tensor(-0.0268, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1.3266746997833252
value loss:93.51471710205078
entropies:7.774850368499756
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(377.1957)
ToM Target loss= tensor(314.4522)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.319180965423584 seconds
19 rew tensor(0.9034, dtype=torch.float64) delta_t tensor(-0.9837, dtype=torch.float64)
19 gae_duplicate tensor(-0.9837, dtype=torch.float64) tensor(0.0815, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9035, dtype=torch.float64) delta_t tensor(0.4734, dtype=torch.float64)
18 gae_duplicate tensor(-0.3135, dtype=torch.float64) tensor(0.0260, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9036, dtype=torch.float64) delta_t tensor(0.6154, dtype=torch.float64)
17 gae_duplicate tensor(0.3646, dtype=torch.float64) tensor(-0.0302, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9037, dtype=torch.float64) delta_t tensor(0.5759, dtype=torch.float64)
16 gae_duplicate tensor(0.8676, dtype=torch.float64) tensor(-0.0719, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9038, dtype=torch.float64) delta_t tensor(0.7880, dtype=torch.float64)
15 gae_duplicate tensor(1.4821, dtype=torch.float64) tensor(-0.1241, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9039, dtype=torch.float64) delta_t tensor(0.5928, dtype=torch.float64)
14 gae_duplicate tensor(1.7785, dtype=torch.float64) tensor(-0.1489, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(0.5929, dtype=torch.float64)
13 gae_duplicate tensor(2.0156, dtype=torch.float64) tensor(-0.1688, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.5930, dtype=torch.float64)
12 gae_duplicate tensor(2.2055, dtype=torch.float64) tensor(-0.1847, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(0.5931, dtype=torch.float64)
11 gae_duplicate tensor(2.3574, dtype=torch.float64) tensor(-0.1974, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(0.3341, dtype=torch.float64)
10 gae_duplicate tensor(2.2201, dtype=torch.float64) tensor(-0.1841, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2482, dtype=torch.float64) delta_t tensor(-0.2108, dtype=torch.float64)
9 gae_duplicate tensor(1.5653, dtype=torch.float64) tensor(-0.1290, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2264, dtype=torch.float64) delta_t tensor(-0.3852, dtype=torch.float64)
8 gae_duplicate tensor(0.8671, dtype=torch.float64) tensor(-0.0718, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7904, dtype=torch.float64) delta_t tensor(-0.3157, dtype=torch.float64)
7 gae_duplicate tensor(0.3780, dtype=torch.float64) tensor(-0.0356, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7008, dtype=torch.float64) delta_t tensor(1.8431, dtype=torch.float64)
6 gae_duplicate tensor(2.1455, dtype=torch.float64) tensor(-0.2495, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4683, dtype=torch.float64) delta_t tensor(-1.2583, dtype=torch.float64)
5 gae_duplicate tensor(0.4581, dtype=torch.float64) tensor(-0.5296, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7685, dtype=torch.float64) delta_t tensor(0.5172, dtype=torch.float64)
4 gae_duplicate tensor(0.8837, dtype=torch.float64) tensor(-0.2423, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7905, dtype=torch.float64) delta_t tensor(-0.1795, dtype=torch.float64)
3 gae_duplicate tensor(0.5274, dtype=torch.float64) tensor(-0.0930, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3161, dtype=torch.float64) delta_t tensor(0.2102, dtype=torch.float64)
2 gae_duplicate tensor(0.6322, dtype=torch.float64) tensor(-0.0675, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:14.282472610473633
value loss:54.51127624511719
entropies:8.106828689575195
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.528141021728516 seconds
19 rew tensor(0.9031, dtype=torch.float64) delta_t tensor(-1.0304, dtype=torch.float64)
19 gae_duplicate tensor(-1.0304, dtype=torch.float64) tensor(0.0839, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9032, dtype=torch.float64) delta_t tensor(0.5072, dtype=torch.float64)
18 gae_duplicate tensor(-0.3171, dtype=torch.float64) tensor(0.0258, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9033, dtype=torch.float64) delta_t tensor(0.5900, dtype=torch.float64)
17 gae_duplicate tensor(0.3364, dtype=torch.float64) tensor(-0.0274, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9034, dtype=torch.float64) delta_t tensor(0.5687, dtype=torch.float64)
16 gae_duplicate tensor(0.8378, dtype=torch.float64) tensor(-0.0682, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9035, dtype=torch.float64) delta_t tensor(0.7282, dtype=torch.float64)
15 gae_duplicate tensor(1.3984, dtype=torch.float64) tensor(-0.1143, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9036, dtype=torch.float64) delta_t tensor(0.5759, dtype=torch.float64)
14 gae_duplicate tensor(1.6947, dtype=torch.float64) tensor(-0.1385, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9037, dtype=torch.float64) delta_t tensor(0.5760, dtype=torch.float64)
13 gae_duplicate tensor(1.9318, dtype=torch.float64) tensor(-0.1579, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9038, dtype=torch.float64) delta_t tensor(0.5761, dtype=torch.float64)
12 gae_duplicate tensor(2.1216, dtype=torch.float64) tensor(-0.1734, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.9441, dtype=torch.float64) delta_t tensor(-2.2615, dtype=torch.float64)
11 gae_duplicate tensor(-0.5643, dtype=torch.float64) tensor(0.0462, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6325, dtype=torch.float64) delta_t tensor(0.0844, dtype=torch.float64)
10 gae_duplicate tensor(-0.3670, dtype=torch.float64) tensor(0.0299, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1579, dtype=torch.float64) delta_t tensor(0.3769, dtype=torch.float64)
9 gae_duplicate tensor(0.0833, dtype=torch.float64) tensor(-0.0071, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7682, dtype=torch.float64) delta_t tensor(0.2043, dtype=torch.float64)
8 gae_duplicate tensor(0.2709, dtype=torch.float64) tensor(-0.0221, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3339, dtype=torch.float64) delta_t tensor(-1.0849, dtype=torch.float64)
7 gae_duplicate tensor(-0.8682, dtype=torch.float64) tensor(0.0818, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6325, dtype=torch.float64) delta_t tensor(1.7742, dtype=torch.float64)
6 gae_duplicate tensor(1.0797, dtype=torch.float64) tensor(-0.1247, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4696, dtype=torch.float64) delta_t tensor(-1.2184, dtype=torch.float64)
5 gae_duplicate tensor(-0.3547, dtype=torch.float64) tensor(0.4078, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7681, dtype=torch.float64) delta_t tensor(0.5181, dtype=torch.float64)
4 gae_duplicate tensor(0.2344, dtype=torch.float64) tensor(-0.0635, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7916, dtype=torch.float64) delta_t tensor(-0.1931, dtype=torch.float64)
3 gae_duplicate tensor(-0.0056, dtype=torch.float64) tensor(0.0010, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3170, dtype=torch.float64) delta_t tensor(0.0197, dtype=torch.float64)
2 gae_duplicate tensor(0.0152, dtype=torch.float64) tensor(-0.0015, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1.0932921171188354
value loss:26.507102966308594
entropies:8.012015342712402
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.235517978668213 seconds
19 rew tensor(0.8356, dtype=torch.float64) delta_t tensor(-1.3269, dtype=torch.float64)
19 gae_duplicate tensor(-1.3269, dtype=torch.float64) tensor(0.1053, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7000, dtype=torch.float64) delta_t tensor(0.1125, dtype=torch.float64)
18 gae_duplicate tensor(-0.9491, dtype=torch.float64) tensor(0.0753, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4966, dtype=torch.float64) delta_t tensor(0.4358, dtype=torch.float64)
17 gae_duplicate tensor(-0.3235, dtype=torch.float64) tensor(0.0257, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0219, dtype=torch.float64) delta_t tensor(-0.6144, dtype=torch.float64)
16 gae_duplicate tensor(-0.8732, dtype=torch.float64) tensor(0.0693, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.6562, dtype=torch.float64) delta_t tensor(-0.5624, dtype=torch.float64)
15 gae_duplicate tensor(-1.2610, dtype=torch.float64) tensor(0.1011, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9034, dtype=torch.float64) delta_t tensor(0.5752, dtype=torch.float64)
14 gae_duplicate tensor(-0.4336, dtype=torch.float64) tensor(0.0348, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9035, dtype=torch.float64) delta_t tensor(0.5753, dtype=torch.float64)
13 gae_duplicate tensor(0.2285, dtype=torch.float64) tensor(-0.0183, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9036, dtype=torch.float64) delta_t tensor(0.5754, dtype=torch.float64)
12 gae_duplicate tensor(0.7582, dtype=torch.float64) tensor(-0.0608, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4525, dtype=torch.float64) delta_t tensor(-0.7807, dtype=torch.float64)
11 gae_duplicate tensor(-0.1741, dtype=torch.float64) tensor(0.0140, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5882, dtype=torch.float64) delta_t tensor(-1.3354, dtype=torch.float64)
10 gae_duplicate tensor(-1.4747, dtype=torch.float64) tensor(0.1171, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4289, dtype=torch.float64) delta_t tensor(0.2758, dtype=torch.float64)
9 gae_duplicate tensor(-0.9040, dtype=torch.float64) tensor(0.0717, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0457, dtype=torch.float64) delta_t tensor(0.5252, dtype=torch.float64)
8 gae_duplicate tensor(-0.1979, dtype=torch.float64) tensor(0.0162, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8593, dtype=torch.float64) delta_t tensor(-1.0396, dtype=torch.float64)
7 gae_duplicate tensor(-1.1979, dtype=torch.float64) tensor(1.3957, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2492, dtype=torch.float64) delta_t tensor(0.3718, dtype=torch.float64)
6 gae_duplicate tensor(-0.5866, dtype=torch.float64) tensor(0.2205, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.6897, dtype=torch.float64) delta_t tensor(-1.1175, dtype=torch.float64)
5 gae_duplicate tensor(-1.5867, dtype=torch.float64) tensor(6.8189, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7676, dtype=torch.float64) delta_t tensor(-0.1410, dtype=torch.float64)
4 gae_duplicate tensor(-1.4104, dtype=torch.float64) tensor(0.3840, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9449, dtype=torch.float64) delta_t tensor(-0.3582, dtype=torch.float64)
3 gae_duplicate tensor(-1.4865, dtype=torch.float64) tensor(0.1809, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0893, dtype=torch.float64) delta_t tensor(-0.4975, dtype=torch.float64)
2 gae_duplicate tensor(-1.6867, dtype=torch.float64) tensor(0.1477, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-58.453697204589844
value loss:30.503110885620117
entropies:8.638693809509277
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.583300828933716 seconds
19 rew tensor(0.8359, dtype=torch.float64) delta_t tensor(-0.8967, dtype=torch.float64)
19 gae_duplicate tensor(-0.8967, dtype=torch.float64) tensor(0.0688, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7002, dtype=torch.float64) delta_t tensor(0.3590, dtype=torch.float64)
18 gae_duplicate tensor(-0.3584, dtype=torch.float64) tensor(0.0275, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5645, dtype=torch.float64) delta_t tensor(0.2208, dtype=torch.float64)
17 gae_duplicate tensor(-0.0660, dtype=torch.float64) tensor(0.0051, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0895, dtype=torch.float64) delta_t tensor(-0.1673, dtype=torch.float64)
16 gae_duplicate tensor(-0.2201, dtype=torch.float64) tensor(0.0169, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.5214, dtype=torch.float64) delta_t tensor(-0.6703, dtype=torch.float64)
15 gae_duplicate tensor(-0.8464, dtype=torch.float64) tensor(0.0654, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9038, dtype=torch.float64) delta_t tensor(0.6120, dtype=torch.float64)
14 gae_duplicate tensor(-0.0651, dtype=torch.float64) tensor(0.0050, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2252, dtype=torch.float64) delta_t tensor(-0.0665, dtype=torch.float64)
13 gae_duplicate tensor(-0.1186, dtype=torch.float64) tensor(0.0092, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7681, dtype=torch.float64) delta_t tensor(2.1409, dtype=torch.float64)
12 gae_duplicate tensor(2.0460, dtype=torch.float64) tensor(-0.1737, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5646, dtype=torch.float64) delta_t tensor(0.1539, dtype=torch.float64)
11 gae_duplicate tensor(1.7907, dtype=torch.float64) tensor(-2.9898, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2932, dtype=torch.float64) delta_t tensor(-1.0514, dtype=torch.float64)
10 gae_duplicate tensor(0.3812, dtype=torch.float64) tensor(-0.0598, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2496, dtype=torch.float64) delta_t tensor(-0.0494, dtype=torch.float64)
9 gae_duplicate tensor(0.2556, dtype=torch.float64) tensor(-0.0745, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7682, dtype=torch.float64) delta_t tensor(0.2865, dtype=torch.float64)
8 gae_duplicate tensor(0.4909, dtype=torch.float64) tensor(-0.1006, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5209, dtype=torch.float64) delta_t tensor(0.1023, dtype=torch.float64)
7 gae_duplicate tensor(0.4951, dtype=torch.float64) tensor(-0.1610, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7003, dtype=torch.float64) delta_t tensor(0.6460, dtype=torch.float64)
6 gae_duplicate tensor(1.0420, dtype=torch.float64) tensor(-0.2711, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5887, dtype=torch.float64) delta_t tensor(-0.3722, dtype=torch.float64)
5 gae_duplicate tensor(0.4614, dtype=torch.float64) tensor(-0.1555, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3611, dtype=torch.float64) delta_t tensor(0.6875, dtype=torch.float64)
4 gae_duplicate tensor(1.0567, dtype=torch.float64) tensor(-0.3017, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4530, dtype=torch.float64) delta_t tensor(-0.0040, dtype=torch.float64)
3 gae_duplicate tensor(0.8413, dtype=torch.float64) tensor(-0.1575, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4530, dtype=torch.float64) delta_t tensor(0.0429, dtype=torch.float64)
2 gae_duplicate tensor(0.7159, dtype=torch.float64) tensor(-0.0755, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:25.645511627197266
value loss:20.16797637939453
entropies:9.675168991088867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.364940881729126 seconds
19 rew tensor(0.9038, dtype=torch.float64) delta_t tensor(-0.8932, dtype=torch.float64)
19 gae_duplicate tensor(-0.8932, dtype=torch.float64) tensor(0.0669, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9039, dtype=torch.float64) delta_t tensor(0.5445, dtype=torch.float64)
18 gae_duplicate tensor(-0.1700, dtype=torch.float64) tensor(0.0127, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8361, dtype=torch.float64) delta_t tensor(0.4774, dtype=torch.float64)
17 gae_duplicate tensor(0.3413, dtype=torch.float64) tensor(-0.0256, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8362, dtype=torch.float64) delta_t tensor(0.4780, dtype=torch.float64)
16 gae_duplicate tensor(0.7511, dtype=torch.float64) tensor(-0.0563, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7684, dtype=torch.float64) delta_t tensor(0.4139, dtype=torch.float64)
15 gae_duplicate tensor(1.0148, dtype=torch.float64) tensor(-0.0760, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5648, dtype=torch.float64) delta_t tensor(0.2310, dtype=torch.float64)
14 gae_duplicate tensor(1.0428, dtype=torch.float64) tensor(-0.0781, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2933, dtype=torch.float64) delta_t tensor(-0.0966, dtype=torch.float64)
13 gae_duplicate tensor(0.7377, dtype=torch.float64) tensor(-0.0553, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2255, dtype=torch.float64) delta_t tensor(-0.1352, dtype=torch.float64)
12 gae_duplicate tensor(0.4550, dtype=torch.float64) tensor(-0.0341, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-3.1684, dtype=torch.float64) delta_t tensor(-3.5291, dtype=torch.float64)
11 gae_duplicate tensor(-3.1651, dtype=torch.float64) tensor(0.2373, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0894, dtype=torch.float64) delta_t tensor(0.0618, dtype=torch.float64)
10 gae_duplicate tensor(-2.4702, dtype=torch.float64) tensor(0.1840, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4289, dtype=torch.float64) delta_t tensor(-0.0629, dtype=torch.float64)
9 gae_duplicate tensor(-2.0391, dtype=torch.float64) tensor(0.1529, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1143, dtype=torch.float64) delta_t tensor(-0.0665, dtype=torch.float64)
8 gae_duplicate tensor(-1.6978, dtype=torch.float64) tensor(0.1468, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7006, dtype=torch.float64) delta_t tensor(0.1378, dtype=torch.float64)
7 gae_duplicate tensor(-1.2204, dtype=torch.float64) tensor(4.5779, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3179, dtype=torch.float64) delta_t tensor(-0.1856, dtype=torch.float64)
6 gae_duplicate tensor(-1.1619, dtype=torch.float64) tensor(0.0957, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2932, dtype=torch.float64) delta_t tensor(1.8213, dtype=torch.float64)
5 gae_duplicate tensor(0.8918, dtype=torch.float64) tensor(-0.0954, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2500, dtype=torch.float64) delta_t tensor(-0.4747, dtype=torch.float64)
4 gae_duplicate tensor(0.2387, dtype=torch.float64) tensor(-0.3511, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0463, dtype=torch.float64) delta_t tensor(0.3511, dtype=torch.float64)
3 gae_duplicate tensor(0.5420, dtype=torch.float64) tensor(-0.1154, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5894, dtype=torch.float64) delta_t tensor(-0.1204, dtype=torch.float64)
2 gae_duplicate tensor(0.3133, dtype=torch.float64) tensor(-0.0349, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-27.529346466064453
value loss:47.42910385131836
entropies:7.258965492248535
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(350.6403)
ToM Target loss= tensor(314.0865)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.419442892074585 seconds
19 rew tensor(0.9036, dtype=torch.float64) delta_t tensor(-0.9119, dtype=torch.float64)
19 gae_duplicate tensor(-0.9119, dtype=torch.float64) tensor(0.0659, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9037, dtype=torch.float64) delta_t tensor(0.5476, dtype=torch.float64)
18 gae_duplicate tensor(-0.1819, dtype=torch.float64) tensor(0.0131, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9038, dtype=torch.float64) delta_t tensor(0.5723, dtype=torch.float64)
17 gae_duplicate tensor(0.4267, dtype=torch.float64) tensor(-0.0308, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9039, dtype=torch.float64) delta_t tensor(0.6095, dtype=torch.float64)
16 gae_duplicate tensor(0.9509, dtype=torch.float64) tensor(-0.0687, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(0.6920, dtype=torch.float64)
15 gae_duplicate tensor(1.4527, dtype=torch.float64) tensor(-0.1055, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.5869, dtype=torch.float64)
14 gae_duplicate tensor(1.7491, dtype=torch.float64) tensor(-0.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(0.5870, dtype=torch.float64)
13 gae_duplicate tensor(1.9863, dtype=torch.float64) tensor(-0.1442, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(0.5871, dtype=torch.float64)
12 gae_duplicate tensor(2.1762, dtype=torch.float64) tensor(-0.1580, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5898, dtype=torch.float64) delta_t tensor(-0.8893, dtype=torch.float64)
11 gae_duplicate tensor(0.8517, dtype=torch.float64) tensor(-0.0619, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6326, dtype=torch.float64) delta_t tensor(0.1368, dtype=torch.float64)
10 gae_duplicate tensor(0.8182, dtype=torch.float64) tensor(-0.0592, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2931, dtype=torch.float64) delta_t tensor(0.6081, dtype=torch.float64)
9 gae_duplicate tensor(1.2626, dtype=torch.float64) tensor(-0.0966, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6327, dtype=torch.float64) delta_t tensor(1.2293, dtype=torch.float64)
8 gae_duplicate tensor(2.2394, dtype=torch.float64) tensor(-0.1951, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2686, dtype=torch.float64) delta_t tensor(-1.6092, dtype=torch.float64)
7 gae_duplicate tensor(0.1823, dtype=torch.float64) tensor(-0.2261, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6326, dtype=torch.float64) delta_t tensor(0.7202, dtype=torch.float64)
6 gae_duplicate tensor(0.8660, dtype=torch.float64) tensor(-0.2378, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4045, dtype=torch.float64) delta_t tensor(-0.6356, dtype=torch.float64)
5 gae_duplicate tensor(0.0573, dtype=torch.float64) tensor(-0.0260, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7683, dtype=torch.float64) delta_t tensor(0.5180, dtype=torch.float64)
4 gae_duplicate tensor(0.5638, dtype=torch.float64) tensor(-0.1495, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7934, dtype=torch.float64) delta_t tensor(-0.2225, dtype=torch.float64)
3 gae_duplicate tensor(0.2285, dtype=torch.float64) tensor(-0.0378, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3182, dtype=torch.float64) delta_t tensor(0.1238, dtype=torch.float64)
2 gae_duplicate tensor(0.3067, dtype=torch.float64) tensor(-0.0290, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:9.798338890075684
value loss:37.58460235595703
entropies:8.28278923034668
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5715789794921875 seconds
19 rew tensor(0.8361, dtype=torch.float64) delta_t tensor(-0.9489, dtype=torch.float64)
19 gae_duplicate tensor(-0.9489, dtype=torch.float64) tensor(0.0658, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7003, dtype=torch.float64) delta_t tensor(0.3059, dtype=torch.float64)
18 gae_duplicate tensor(-0.4532, dtype=torch.float64) tensor(0.0314, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4965, dtype=torch.float64) delta_t tensor(0.2165, dtype=torch.float64)
17 gae_duplicate tensor(-0.1461, dtype=torch.float64) tensor(0.0101, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0889, dtype=torch.float64) delta_t tensor(-0.2039, dtype=torch.float64)
16 gae_duplicate tensor(-0.3208, dtype=torch.float64) tensor(0.0222, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.5903, dtype=torch.float64) delta_t tensor(-0.8407, dtype=torch.float64)
15 gae_duplicate tensor(-1.0973, dtype=torch.float64) tensor(0.0767, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(0.5846, dtype=torch.float64)
14 gae_duplicate tensor(-0.2932, dtype=torch.float64) tensor(0.0205, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.5847, dtype=torch.float64)
13 gae_duplicate tensor(0.3501, dtype=torch.float64) tensor(-0.0245, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(0.5848, dtype=torch.float64)
12 gae_duplicate tensor(0.8649, dtype=torch.float64) tensor(-0.0605, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5901, dtype=torch.float64) delta_t tensor(-0.9241, dtype=torch.float64)
11 gae_duplicate tensor(-0.2321, dtype=torch.float64) tensor(0.0163, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6325, dtype=torch.float64) delta_t tensor(0.5114, dtype=torch.float64)
10 gae_duplicate tensor(0.3257, dtype=torch.float64) tensor(-0.0224, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3609, dtype=torch.float64) delta_t tensor(-0.1575, dtype=torch.float64)
9 gae_duplicate tensor(0.1031, dtype=torch.float64) tensor(-0.0071, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2503, dtype=torch.float64) delta_t tensor(-0.0859, dtype=torch.float64)
8 gae_duplicate tensor(-0.0035, dtype=torch.float64) tensor(0.0002, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3183, dtype=torch.float64) delta_t tensor(-1.0890, dtype=torch.float64)
7 gae_duplicate tensor(-1.0917, dtype=torch.float64) tensor(0.0759, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5407, dtype=torch.float64) delta_t tensor(-0.0960, dtype=torch.float64)
6 gae_duplicate tensor(-0.9694, dtype=torch.float64) tensor(2.5118, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4286, dtype=torch.float64) delta_t tensor(1.1524, dtype=torch.float64)
5 gae_duplicate tensor(0.3769, dtype=torch.float64) tensor(-0.0398, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3558, dtype=torch.float64) delta_t tensor(-1.6801, dtype=torch.float64)
4 gae_duplicate tensor(-1.3786, dtype=torch.float64) tensor(1.1519, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2698, dtype=torch.float64) delta_t tensor(-0.6119, dtype=torch.float64)
3 gae_duplicate tensor(-1.7148, dtype=torch.float64) tensor(6.6936, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1831, dtype=torch.float64) delta_t tensor(-0.5305, dtype=torch.float64)
2 gae_duplicate tensor(-1.9024, dtype=torch.float64) tensor(0.1694, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-64.3597640991211
value loss:21.443401336669922
entropies:7.008406162261963
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.456594944000244 seconds
19 rew tensor(0.9038, dtype=torch.float64) delta_t tensor(-0.7984, dtype=torch.float64)
19 gae_duplicate tensor(-0.7984, dtype=torch.float64) tensor(0.0529, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9039, dtype=torch.float64) delta_t tensor(0.5629, dtype=torch.float64)
18 gae_duplicate tensor(-0.0759, dtype=torch.float64) tensor(0.0050, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9039, dtype=torch.float64) delta_t tensor(0.5483, dtype=torch.float64)
17 gae_duplicate tensor(0.4876, dtype=torch.float64) tensor(-0.0323, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(0.6133, dtype=torch.float64)
16 gae_duplicate tensor(1.0034, dtype=torch.float64) tensor(-0.0665, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.6488, dtype=torch.float64)
15 gae_duplicate tensor(1.4515, dtype=torch.float64) tensor(-0.0965, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(0.5868, dtype=torch.float64)
14 gae_duplicate tensor(1.7480, dtype=torch.float64) tensor(-0.1162, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(0.5869, dtype=torch.float64)
13 gae_duplicate tensor(1.9853, dtype=torch.float64) tensor(-0.1320, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9044, dtype=torch.float64) delta_t tensor(0.6343, dtype=torch.float64)
12 gae_duplicate tensor(2.2225, dtype=torch.float64) tensor(-0.1476, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7007, dtype=torch.float64) delta_t tensor(0.3460, dtype=torch.float64)
11 gae_duplicate tensor(2.1240, dtype=torch.float64) tensor(-0.1413, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4970, dtype=torch.float64) delta_t tensor(0.3881, dtype=torch.float64)
10 gae_duplicate tensor(2.0873, dtype=torch.float64) tensor(-0.1370, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0894, dtype=torch.float64) delta_t tensor(-0.2240, dtype=torch.float64)
9 gae_duplicate tensor(1.4459, dtype=torch.float64) tensor(-0.0952, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5898, dtype=torch.float64) delta_t tensor(-1.0928, dtype=torch.float64)
8 gae_duplicate tensor(0.0639, dtype=torch.float64) tensor(-0.0043, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9295, dtype=torch.float64) delta_t tensor(-0.5652, dtype=torch.float64)
7 gae_duplicate tensor(-0.5141, dtype=torch.float64) tensor(0.0481, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6326, dtype=torch.float64) delta_t tensor(-0.1322, dtype=torch.float64)
6 gae_duplicate tensor(-0.5435, dtype=torch.float64) tensor(0.0418, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.3559, dtype=torch.float64) delta_t tensor(-0.9318, dtype=torch.float64)
5 gae_duplicate tensor(-1.3666, dtype=torch.float64) tensor(0.1397, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7685, dtype=torch.float64) delta_t tensor(0.3779, dtype=torch.float64)
4 gae_duplicate tensor(-0.7154, dtype=torch.float64) tensor(0.0561, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7452, dtype=torch.float64) delta_t tensor(-1.7273, dtype=torch.float64)
3 gae_duplicate tensor(-2.2996, dtype=torch.float64) tensor(0.1531, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5905, dtype=torch.float64) delta_t tensor(0.8280, dtype=torch.float64)
2 gae_duplicate tensor(-1.0117, dtype=torch.float64) tensor(3.7095, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-19.60434341430664
value loss:54.21678924560547
entropies:5.975019931793213
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.6207427978515625 seconds
19 rew tensor(0.9037, dtype=torch.float64) delta_t tensor(-0.9031, dtype=torch.float64)
19 gae_duplicate tensor(-0.9031, dtype=torch.float64) tensor(0.0572, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9038, dtype=torch.float64) delta_t tensor(0.5035, dtype=torch.float64)
18 gae_duplicate tensor(-0.2189, dtype=torch.float64) tensor(0.8555, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9039, dtype=torch.float64) delta_t tensor(0.6283, dtype=torch.float64)
17 gae_duplicate tensor(0.4531, dtype=torch.float64) tensor(-0.0287, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(0.6125, dtype=torch.float64)
16 gae_duplicate tensor(0.9750, dtype=torch.float64) tensor(-0.0618, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.6176, dtype=torch.float64)
15 gae_duplicate tensor(1.3976, dtype=torch.float64) tensor(-0.0893, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(0.5760, dtype=torch.float64)
14 gae_duplicate tensor(1.6941, dtype=torch.float64) tensor(-0.1083, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(0.5761, dtype=torch.float64)
13 gae_duplicate tensor(1.9313, dtype=torch.float64) tensor(-0.1235, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9044, dtype=torch.float64) delta_t tensor(0.5762, dtype=torch.float64)
12 gae_duplicate tensor(2.1212, dtype=torch.float64) tensor(-0.1356, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4549, dtype=torch.float64) delta_t tensor(-0.7831, dtype=torch.float64)
11 gae_duplicate tensor(0.9139, dtype=torch.float64) tensor(-0.0584, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5909, dtype=torch.float64) delta_t tensor(-0.9967, dtype=torch.float64)
10 gae_duplicate tensor(-0.2656, dtype=torch.float64) tensor(0.0168, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4285, dtype=torch.float64) delta_t tensor(0.5766, dtype=torch.float64)
9 gae_duplicate tensor(0.3641, dtype=torch.float64) tensor(-0.0227, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2247, dtype=torch.float64) delta_t tensor(0.2587, dtype=torch.float64)
8 gae_duplicate tensor(0.5500, dtype=torch.float64) tensor(-0.0372, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8626, dtype=torch.float64) delta_t tensor(-0.3514, dtype=torch.float64)
7 gae_duplicate tensor(0.0886, dtype=torch.float64) tensor(-0.1130, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7003, dtype=torch.float64) delta_t tensor(0.4936, dtype=torch.float64)
6 gae_duplicate tensor(0.5644, dtype=torch.float64) tensor(-0.1443, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4062, dtype=torch.float64) delta_t tensor(-0.6304, dtype=torch.float64)
5 gae_duplicate tensor(-0.1789, dtype=torch.float64) tensor(0.0769, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7681, dtype=torch.float64) delta_t tensor(0.5051, dtype=torch.float64)
4 gae_duplicate tensor(0.3620, dtype=torch.float64) tensor(-0.0905, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7947, dtype=torch.float64) delta_t tensor(-0.2381, dtype=torch.float64)
3 gae_duplicate tensor(0.0515, dtype=torch.float64) tensor(-0.0079, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3191, dtype=torch.float64) delta_t tensor(0.2154, dtype=torch.float64)
2 gae_duplicate tensor(0.2566, dtype=torch.float64) tensor(-0.0226, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-0.00564904510974884
value loss:25.45581817626953
entropies:7.647647857666016
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.362543821334839 seconds
19 rew tensor(0.7003, dtype=torch.float64) delta_t tensor(-1.0751, dtype=torch.float64)
19 gae_duplicate tensor(-1.0751, dtype=torch.float64) tensor(0.0647, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7004, dtype=torch.float64) delta_t tensor(0.3256, dtype=torch.float64)
18 gae_duplicate tensor(-0.5345, dtype=torch.float64) tensor(0.0322, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4965, dtype=torch.float64) delta_t tensor(0.0579, dtype=torch.float64)
17 gae_duplicate tensor(-0.3697, dtype=torch.float64) tensor(0.0223, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0886, dtype=torch.float64) delta_t tensor(-0.1929, dtype=torch.float64)
16 gae_duplicate tensor(-0.4886, dtype=torch.float64) tensor(0.0294, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7953, dtype=torch.float64) delta_t tensor(-1.0820, dtype=torch.float64)
15 gae_duplicate tensor(-1.4729, dtype=torch.float64) tensor(5.8295, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(0.5620, dtype=torch.float64)
14 gae_duplicate tensor(-0.6163, dtype=torch.float64) tensor(0.0376, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9044, dtype=torch.float64) delta_t tensor(0.5621, dtype=torch.float64)
13 gae_duplicate tensor(0.0690, dtype=torch.float64) tensor(-0.0042, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9045, dtype=torch.float64) delta_t tensor(0.5622, dtype=torch.float64)
12 gae_duplicate tensor(0.6174, dtype=torch.float64) tensor(-0.0376, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.1349, dtype=torch.float64) delta_t tensor(-1.4773, dtype=torch.float64)
11 gae_duplicate tensor(-0.9834, dtype=torch.float64) tensor(0.0599, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5912, dtype=torch.float64) delta_t tensor(-0.8926, dtype=torch.float64)
10 gae_duplicate tensor(-1.6793, dtype=torch.float64) tensor(0.1009, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3605, dtype=torch.float64) delta_t tensor(0.1741, dtype=torch.float64)
9 gae_duplicate tensor(-1.1694, dtype=torch.float64) tensor(0.0699, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0473, dtype=torch.float64) delta_t tensor(-0.6088, dtype=torch.float64)
8 gae_duplicate tensor(-1.5443, dtype=torch.float64) tensor(0.0930, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5232, dtype=torch.float64) delta_t tensor(-0.0561, dtype=torch.float64)
7 gae_duplicate tensor(-1.2915, dtype=torch.float64) tensor(0.0885, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7003, dtype=torch.float64) delta_t tensor(-0.1112, dtype=torch.float64)
6 gae_duplicate tensor(-1.1443, dtype=torch.float64) tensor(0.0804, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4067, dtype=torch.float64) delta_t tensor(-0.4332, dtype=torch.float64)
5 gae_duplicate tensor(-1.3487, dtype=torch.float64) tensor(0.1026, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4553, dtype=torch.float64) delta_t tensor(-0.5191, dtype=torch.float64)
4 gae_duplicate tensor(-1.5981, dtype=torch.float64) tensor(0.0964, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9507, dtype=torch.float64) delta_t tensor(-0.3955, dtype=torch.float64)
3 gae_duplicate tensor(-1.6740, dtype=torch.float64) tensor(0.1208, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5916, dtype=torch.float64) delta_t tensor(-1.9015, dtype=torch.float64)
2 gae_duplicate tensor(-3.2407, dtype=torch.float64) tensor(12.8510, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-117.98680877685547
value loss:49.41960525512695
entropies:5.442765712738037
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(314.2673)
ToM Target loss= tensor(313.0246)
optimized based on ToM loss
---------------------
gamma: 0.8
Process Process-4:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt