obs <crafter.objects.Shelter object at 0x13242ebb0> [ 0 39  0  0 39  0  0  9  0]
obs <crafter.objects.Warehouse object at 0x132417c40> [ 0 39  0  0 34  0  0  9  0]
obs <crafter.objects.Station object at 0x1324171c0> [ 0  9  0  0  9  0  0 15  0]
obs <crafter.objects.Shelter object at 0x13242ebb0> [ 0 39  0  0 39  0  0 11  0]
obs <crafter.objects.Warehouse object at 0x132417c40> [ 0 40  0  0 42  0  0  9  0]
obs <crafter.objects.Station object at 0x1324171c0> [ 0  9  0  0  9  0  0 11  0]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0019190311431884766 seconds
19 rew tensor(0.8889, dtype=torch.float64) delta_t tensor(0.6402, dtype=torch.float64)
19 gae_duplicate tensor(0.4906, dtype=torch.float64) tensor(-7.7649, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8692, dtype=torch.float64) delta_t tensor(0.8582, dtype=torch.float64)
18 gae_duplicate tensor(1.2038, dtype=torch.float64) tensor(-16.8385, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7990, dtype=torch.float64) delta_t tensor(0.8035, dtype=torch.float64)
17 gae_duplicate tensor(1.4684, dtype=torch.float64) tensor(-23.9063, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6623, dtype=torch.float64) delta_t tensor(0.5831, dtype=torch.float64)
16 gae_duplicate tensor(0.6678, dtype=torch.float64) tensor(-25.8995, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7569, dtype=torch.float64) delta_t tensor(0.7106, dtype=torch.float64)
15 gae_duplicate tensor(1.4880, dtype=torch.float64) tensor(-29.7348, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0950, dtype=torch.float64) delta_t tensor(1.0720, dtype=torch.float64)
14 gae_duplicate tensor(2.3401, dtype=torch.float64) tensor(-36.3389, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.1371, dtype=torch.float64) delta_t tensor(1.0915, dtype=torch.float64)
13 gae_duplicate tensor(2.7374, dtype=torch.float64) tensor(-43.0873, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.2786, dtype=torch.float64) delta_t tensor(1.2593, dtype=torch.float64)
12 gae_duplicate tensor(3.5687, dtype=torch.float64) tensor(-50.6585, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.1953, dtype=torch.float64) delta_t tensor(1.1725, dtype=torch.float64)
11 gae_duplicate tensor(3.0975, dtype=torch.float64) tensor(-53.9424, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(1.2969, dtype=torch.float64) delta_t tensor(1.2541, dtype=torch.float64)
10 gae_duplicate tensor(2.1914, dtype=torch.float64) tensor(-59.4137, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(1.3871, dtype=torch.float64) delta_t tensor(1.3563, dtype=torch.float64)
9 gae_duplicate tensor(3.0180, dtype=torch.float64) tensor(-62.4164, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(1.2270, dtype=torch.float64) delta_t tensor(1.2224, dtype=torch.float64)
8 gae_duplicate tensor(3.3672, dtype=torch.float64) tensor(-61.2028, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1458, dtype=torch.float64) delta_t tensor(0.0384, dtype=torch.float64)
7 gae_duplicate tensor(2.6102, dtype=torch.float64) tensor(-53.9828, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2466, dtype=torch.float64) delta_t tensor(-0.4273, dtype=torch.float64)
6 gae_duplicate tensor(0.3647, dtype=torch.float64) tensor(-36.8794, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1968, dtype=torch.float64) delta_t tensor(-0.3282, dtype=torch.float64)
5 gae_duplicate tensor(-1.8522, dtype=torch.float64) tensor(-28.9955, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2445, dtype=torch.float64) delta_t tensor(-1.2705, dtype=torch.float64)
4 gae_duplicate tensor(-2.9915, dtype=torch.float64) tensor(-5.1094, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3046, dtype=torch.float64) delta_t tensor(-0.3206, dtype=torch.float64)
3 gae_duplicate tensor(-2.0552, dtype=torch.float64) tensor(-0.5457, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7691, dtype=torch.float64) delta_t tensor(-0.8121, dtype=torch.float64)
2 gae_duplicate tensor(-2.8326, dtype=torch.float64) tensor(11.7879, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:21017.33984375
value loss:1849.500244140625
entropies:222.8069305419922
Policy training finished
---------------------
gamma: 0.8
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 4.793134927749634 seconds
19 rew tensor(0.7425, dtype=torch.float64) delta_t tensor(0.5139, dtype=torch.float64)
19 gae_duplicate tensor(0.3256, dtype=torch.float64) tensor(-5.9232, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8216, dtype=torch.float64) delta_t tensor(0.7856, dtype=torch.float64)
18 gae_duplicate tensor(0.7441, dtype=torch.float64) tensor(-13.6529, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.7509, dtype=torch.float64)
17 gae_duplicate tensor(1.1071, dtype=torch.float64) tensor(-20.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7388, dtype=torch.float64) delta_t tensor(0.7279, dtype=torch.float64)
16 gae_duplicate tensor(1.5844, dtype=torch.float64) tensor(-26.5078, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6362, dtype=torch.float64) delta_t tensor(0.5964, dtype=torch.float64)
15 gae_duplicate tensor(1.5331, dtype=torch.float64) tensor(-29.0227, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6624, dtype=torch.float64) delta_t tensor(0.6142, dtype=torch.float64)
14 gae_duplicate tensor(1.7532, dtype=torch.float64) tensor(-29.9430, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7459, dtype=torch.float64) delta_t tensor(0.7043, dtype=torch.float64)
13 gae_duplicate tensor(1.8068, dtype=torch.float64) tensor(-33.8026, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9443, dtype=torch.float64) delta_t tensor(0.9288, dtype=torch.float64)
12 gae_duplicate tensor(2.2091, dtype=torch.float64) tensor(-34.1996, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2353, dtype=torch.float64) delta_t tensor(0.1840, dtype=torch.float64)
11 gae_duplicate tensor(0.2121, dtype=torch.float64) tensor(-29.8212, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4224, dtype=torch.float64) delta_t tensor(0.3911, dtype=torch.float64)
10 gae_duplicate tensor(1.1026, dtype=torch.float64) tensor(-29.6339, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0729, dtype=torch.float64) delta_t tensor(0.0436, dtype=torch.float64)
9 gae_duplicate tensor(-1.6489, dtype=torch.float64) tensor(-25.9141, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3290, dtype=torch.float64) delta_t tensor(0.3452, dtype=torch.float64)
8 gae_duplicate tensor(-1.4218, dtype=torch.float64) tensor(-23.5669, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2064, dtype=torch.float64) delta_t tensor(-0.2209, dtype=torch.float64)
7 gae_duplicate tensor(-0.8846, dtype=torch.float64) tensor(-16.5559, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8030, dtype=torch.float64) delta_t tensor(-0.9523, dtype=torch.float64)
6 gae_duplicate tensor(-1.3364, dtype=torch.float64) tensor(-2.2477, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9890, dtype=torch.float64) delta_t tensor(-1.1802, dtype=torch.float64)
5 gae_duplicate tensor(-1.6334, dtype=torch.float64) tensor(13.7004, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9101, dtype=torch.float64) delta_t tensor(-1.9633, dtype=torch.float64)
4 gae_duplicate tensor(-5.1643, dtype=torch.float64) tensor(39.8433, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8111, dtype=torch.float64) delta_t tensor(-0.9229, dtype=torch.float64)
3 gae_duplicate tensor(-4.6028, dtype=torch.float64) tensor(35.0478, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9371, dtype=torch.float64) delta_t tensor(-1.0238, dtype=torch.float64)
2 gae_duplicate tensor(-4.5556, dtype=torch.float64) tensor(44.7302, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:6713.7783203125
value loss:970.6676025390625
entropies:220.58290100097656
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.880541086196899 seconds
19 rew tensor(0.7377, dtype=torch.float64) delta_t tensor(0.4689, dtype=torch.float64)
19 gae_duplicate tensor(-0.0541, dtype=torch.float64) tensor(-5.9130, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6311, dtype=torch.float64) delta_t tensor(0.6495, dtype=torch.float64)
18 gae_duplicate tensor(0.1245, dtype=torch.float64) tensor(-12.1416, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4127, dtype=torch.float64) delta_t tensor(0.3542, dtype=torch.float64)
17 gae_duplicate tensor(-0.7091, dtype=torch.float64) tensor(-14.7321, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8451, dtype=torch.float64) delta_t tensor(0.7823, dtype=torch.float64)
16 gae_duplicate tensor(0.1268, dtype=torch.float64) tensor(-22.6416, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8435, dtype=torch.float64) delta_t tensor(0.7614, dtype=torch.float64)
15 gae_duplicate tensor(0.7630, dtype=torch.float64) tensor(-26.7490, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8341, dtype=torch.float64) delta_t tensor(0.7835, dtype=torch.float64)
14 gae_duplicate tensor(1.1060, dtype=torch.float64) tensor(-27.9402, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8585, dtype=torch.float64) delta_t tensor(0.8209, dtype=torch.float64)
13 gae_duplicate tensor(1.3182, dtype=torch.float64) tensor(-36.7674, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9320, dtype=torch.float64) delta_t tensor(0.8784, dtype=torch.float64)
12 gae_duplicate tensor(1.9602, dtype=torch.float64) tensor(-34.9857, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8869, dtype=torch.float64) delta_t tensor(0.9308, dtype=torch.float64)
11 gae_duplicate tensor(2.2295, dtype=torch.float64) tensor(-42.6759, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7700, dtype=torch.float64) delta_t tensor(0.6956, dtype=torch.float64)
10 gae_duplicate tensor(1.9380, dtype=torch.float64) tensor(-44.6405, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0872, dtype=torch.float64) delta_t tensor(-0.1070, dtype=torch.float64)
9 gae_duplicate tensor(0.4060, dtype=torch.float64) tensor(-28.6050, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2726, dtype=torch.float64) delta_t tensor(-0.2769, dtype=torch.float64)
8 gae_duplicate tensor(-0.2418, dtype=torch.float64) tensor(-21.1632, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8238, dtype=torch.float64) delta_t tensor(-0.8956, dtype=torch.float64)
7 gae_duplicate tensor(-2.2622, dtype=torch.float64) tensor(-6.1122, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2104, dtype=torch.float64) delta_t tensor(-1.3322, dtype=torch.float64)
6 gae_duplicate tensor(-4.5862, dtype=torch.float64) tensor(8.7569, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5641, dtype=torch.float64) delta_t tensor(-1.6275, dtype=torch.float64)
5 gae_duplicate tensor(-6.2173, dtype=torch.float64) tensor(25.2355, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8178, dtype=torch.float64) delta_t tensor(-0.9717, dtype=torch.float64)
4 gae_duplicate tensor(-6.4401, dtype=torch.float64) tensor(30.4739, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9493, dtype=torch.float64) delta_t tensor(-1.0525, dtype=torch.float64)
3 gae_duplicate tensor(-5.8091, dtype=torch.float64) tensor(41.8507, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3612, dtype=torch.float64) delta_t tensor(-0.3386, dtype=torch.float64)
2 gae_duplicate tensor(-5.2544, dtype=torch.float64) tensor(37.2546, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:6494.30029296875
value loss:1230.13427734375
entropies:219.71783447265625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.7086358070373535 seconds
19 rew tensor(0.6813, dtype=torch.float64) delta_t tensor(0.4071, dtype=torch.float64)
19 gae_duplicate tensor(0.0864, dtype=torch.float64) tensor(-5.2107, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5939, dtype=torch.float64) delta_t tensor(0.5861, dtype=torch.float64)
18 gae_duplicate tensor(0.1626, dtype=torch.float64) tensor(-11.5281, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3976, dtype=torch.float64) delta_t tensor(0.3077, dtype=torch.float64)
17 gae_duplicate tensor(-0.8344, dtype=torch.float64) tensor(-12.7740, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4251, dtype=torch.float64) delta_t tensor(0.3286, dtype=torch.float64)
16 gae_duplicate tensor(-0.0916, dtype=torch.float64) tensor(-12.8877, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7906, dtype=torch.float64) delta_t tensor(0.7749, dtype=torch.float64)
15 gae_duplicate tensor(0.4339, dtype=torch.float64) tensor(-20.7396, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8000, dtype=torch.float64) delta_t tensor(0.7668, dtype=torch.float64)
14 gae_duplicate tensor(0.9112, dtype=torch.float64) tensor(-27.1838, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7805, dtype=torch.float64) delta_t tensor(0.7181, dtype=torch.float64)
13 gae_duplicate tensor(1.2992, dtype=torch.float64) tensor(-30.1903, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7014, dtype=torch.float64) delta_t tensor(0.5933, dtype=torch.float64)
12 gae_duplicate tensor(1.6753, dtype=torch.float64) tensor(-29.6825, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7266, dtype=torch.float64) delta_t tensor(0.7122, dtype=torch.float64)
11 gae_duplicate tensor(1.8594, dtype=torch.float64) tensor(-32.9447, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6898, dtype=torch.float64) delta_t tensor(0.7154, dtype=torch.float64)
10 gae_duplicate tensor(1.9194, dtype=torch.float64) tensor(-34.8393, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1857, dtype=torch.float64) delta_t tensor(-0.2342, dtype=torch.float64)
9 gae_duplicate tensor(0.4583, dtype=torch.float64) tensor(-25.1112, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0860, dtype=torch.float64) delta_t tensor(-0.1458, dtype=torch.float64)
8 gae_duplicate tensor(-0.2386, dtype=torch.float64) tensor(-18.7339, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6802, dtype=torch.float64) delta_t tensor(-0.7588, dtype=torch.float64)
7 gae_duplicate tensor(-0.9974, dtype=torch.float64) tensor(-6.6287, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2357, dtype=torch.float64) delta_t tensor(-1.2903, dtype=torch.float64)
6 gae_duplicate tensor(-1.8219, dtype=torch.float64) tensor(12.2273, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7841, dtype=torch.float64) delta_t tensor(-1.9004, dtype=torch.float64)
5 gae_duplicate tensor(-4.8030, dtype=torch.float64) tensor(33.0415, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5145, dtype=torch.float64) delta_t tensor(-2.6478, dtype=torch.float64)
4 gae_duplicate tensor(-10.1855, dtype=torch.float64) tensor(57.7179, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6101, dtype=torch.float64) delta_t tensor(-0.6695, dtype=torch.float64)
3 gae_duplicate tensor(-8.8515, dtype=torch.float64) tensor(53.5465, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3069, dtype=torch.float64) delta_t tensor(-0.2627, dtype=torch.float64)
2 gae_duplicate tensor(-7.9790, dtype=torch.float64) tensor(49.6695, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2201.435791015625
value loss:1231.3404541015625
entropies:220.16419982910156
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.903156995773315 seconds
19 rew tensor(0.6388, dtype=torch.float64) delta_t tensor(0.2986, dtype=torch.float64)
19 gae_duplicate tensor(0.0203, dtype=torch.float64) tensor(-3.3272, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5505, dtype=torch.float64) delta_t tensor(0.5026, dtype=torch.float64)
18 gae_duplicate tensor(0.3003, dtype=torch.float64) tensor(-9.0376, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3763, dtype=torch.float64) delta_t tensor(0.3692, dtype=torch.float64)
17 gae_duplicate tensor(-0.3419, dtype=torch.float64) tensor(-11.5645, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3886, dtype=torch.float64) delta_t tensor(0.2904, dtype=torch.float64)
16 gae_duplicate tensor(-0.7349, dtype=torch.float64) tensor(-13.7229, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5278, dtype=torch.float64) delta_t tensor(0.4323, dtype=torch.float64)
15 gae_duplicate tensor(0.0344, dtype=torch.float64) tensor(-15.3263, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7155, dtype=torch.float64) delta_t tensor(0.6314, dtype=torch.float64)
14 gae_duplicate tensor(0.5622, dtype=torch.float64) tensor(-19.1724, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7299, dtype=torch.float64) delta_t tensor(0.6715, dtype=torch.float64)
13 gae_duplicate tensor(1.0199, dtype=torch.float64) tensor(-26.7914, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6604, dtype=torch.float64) delta_t tensor(0.6241, dtype=torch.float64)
12 gae_duplicate tensor(1.3783, dtype=torch.float64) tensor(-28.9573, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6496, dtype=torch.float64) delta_t tensor(0.6379, dtype=torch.float64)
11 gae_duplicate tensor(1.9955, dtype=torch.float64) tensor(-29.2519, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5653, dtype=torch.float64) delta_t tensor(0.4980, dtype=torch.float64)
10 gae_duplicate tensor(1.7307, dtype=torch.float64) tensor(-32.1354, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7178, dtype=torch.float64) delta_t tensor(-0.7601, dtype=torch.float64)
9 gae_duplicate tensor(-1.4769, dtype=torch.float64) tensor(-11.7586, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0832, dtype=torch.float64) delta_t tensor(-0.0968, dtype=torch.float64)
8 gae_duplicate tensor(-1.7817, dtype=torch.float64) tensor(-11.6629, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0289, dtype=torch.float64) delta_t tensor(-1.1104, dtype=torch.float64)
7 gae_duplicate tensor(-3.4183, dtype=torch.float64) tensor(5.3261, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.6590, dtype=torch.float64) delta_t tensor(-1.7411, dtype=torch.float64)
6 gae_duplicate tensor(-7.4299, dtype=torch.float64) tensor(28.8521, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7331, dtype=torch.float64) delta_t tensor(-1.9363, dtype=torch.float64)
5 gae_duplicate tensor(-7.0997, dtype=torch.float64) tensor(43.5856, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4319, dtype=torch.float64) delta_t tensor(-3.5034, dtype=torch.float64)
4 gae_duplicate tensor(-10.2575, dtype=torch.float64) tensor(71.4760, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2704, dtype=torch.float64) delta_t tensor(-0.2764, dtype=torch.float64)
3 gae_duplicate tensor(-8.3846, dtype=torch.float64) tensor(68.7475, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1080, dtype=torch.float64) delta_t tensor(-0.1821, dtype=torch.float64)
2 gae_duplicate tensor(-7.2350, dtype=torch.float64) tensor(61.4300, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2441.00146484375
value loss:1624.5052490234375
entropies:219.28575134277344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2502.6077)
ToM Target loss= tensor(1798.4905)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.129597187042236 seconds
19 rew tensor(0.7226, dtype=torch.float64) delta_t tensor(0.4297, dtype=torch.float64)
19 gae_duplicate tensor(0.3014, dtype=torch.float64) tensor(-5.4519, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7130, dtype=torch.float64) delta_t tensor(0.6530, dtype=torch.float64)
18 gae_duplicate tensor(0.7933, dtype=torch.float64) tensor(-12.6116, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6963, dtype=torch.float64) delta_t tensor(0.6823, dtype=torch.float64)
17 gae_duplicate tensor(1.0491, dtype=torch.float64) tensor(-18.8973, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6512, dtype=torch.float64) delta_t tensor(0.6080, dtype=torch.float64)
16 gae_duplicate tensor(1.0960, dtype=torch.float64) tensor(-21.8219, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5709, dtype=torch.float64) delta_t tensor(0.4760, dtype=torch.float64)
15 gae_duplicate tensor(0.1967, dtype=torch.float64) tensor(-24.5499, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7577, dtype=torch.float64) delta_t tensor(0.6625, dtype=torch.float64)
14 gae_duplicate tensor(0.8164, dtype=torch.float64) tensor(-26.8174, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7630, dtype=torch.float64) delta_t tensor(0.7276, dtype=torch.float64)
13 gae_duplicate tensor(1.3925, dtype=torch.float64) tensor(-30.7980, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7114, dtype=torch.float64) delta_t tensor(0.6812, dtype=torch.float64)
12 gae_duplicate tensor(1.6640, dtype=torch.float64) tensor(-33.8618, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5027, dtype=torch.float64) delta_t tensor(0.4438, dtype=torch.float64)
11 gae_duplicate tensor(1.7124, dtype=torch.float64) tensor(-29.9270, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3446, dtype=torch.float64) delta_t tensor(-0.3603, dtype=torch.float64)
10 gae_duplicate tensor(0.1788, dtype=torch.float64) tensor(-19.1900, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1073, dtype=torch.float64) delta_t tensor(-0.1480, dtype=torch.float64)
9 gae_duplicate tensor(-1.0905, dtype=torch.float64) tensor(-13.9349, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2692, dtype=torch.float64) delta_t tensor(-0.3425, dtype=torch.float64)
8 gae_duplicate tensor(-2.0871, dtype=torch.float64) tensor(-7.4481, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4153, dtype=torch.float64) delta_t tensor(-0.4883, dtype=torch.float64)
7 gae_duplicate tensor(-1.7502, dtype=torch.float64) tensor(-0.2089, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6115, dtype=torch.float64) delta_t tensor(-0.7819, dtype=torch.float64)
6 gae_duplicate tensor(-2.4718, dtype=torch.float64) tensor(12.5605, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6996, dtype=torch.float64) delta_t tensor(-0.7365, dtype=torch.float64)
5 gae_duplicate tensor(-3.3066, dtype=torch.float64) tensor(14.2938, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1066, dtype=torch.float64) delta_t tensor(-0.1763, dtype=torch.float64)
4 gae_duplicate tensor(-2.8538, dtype=torch.float64) tensor(15.5579, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5169, dtype=torch.float64) delta_t tensor(-0.4987, dtype=torch.float64)
3 gae_duplicate tensor(-2.5893, dtype=torch.float64) tensor(18.8990, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1062, dtype=torch.float64) delta_t tensor(-0.2082, dtype=torch.float64)
2 gae_duplicate tensor(-2.1385, dtype=torch.float64) tensor(17.6855, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:5955.32763671875
value loss:557.1636962890625
entropies:219.24156188964844
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.9483442306518555 seconds
19 rew tensor(0.6928, dtype=torch.float64) delta_t tensor(0.3425, dtype=torch.float64)
19 gae_duplicate tensor(0.2282, dtype=torch.float64) tensor(-4.2722, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7016, dtype=torch.float64) delta_t tensor(0.6253, dtype=torch.float64)
18 gae_duplicate tensor(0.7194, dtype=torch.float64) tensor(-10.2742, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6580, dtype=torch.float64) delta_t tensor(0.5961, dtype=torch.float64)
17 gae_duplicate tensor(1.0636, dtype=torch.float64) tensor(-15.6152, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5749, dtype=torch.float64) delta_t tensor(0.5278, dtype=torch.float64)
16 gae_duplicate tensor(0.9963, dtype=torch.float64) tensor(-20.5867, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4445, dtype=torch.float64) delta_t tensor(0.3813, dtype=torch.float64)
15 gae_duplicate tensor(0.1972, dtype=torch.float64) tensor(-19.3045, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5786, dtype=torch.float64) delta_t tensor(0.4599, dtype=torch.float64)
14 gae_duplicate tensor(0.9103, dtype=torch.float64) tensor(-20.9205, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7090, dtype=torch.float64) delta_t tensor(0.6238, dtype=torch.float64)
13 gae_duplicate tensor(1.4808, dtype=torch.float64) tensor(-26.2518, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7460, dtype=torch.float64) delta_t tensor(0.6948, dtype=torch.float64)
12 gae_duplicate tensor(1.8073, dtype=torch.float64) tensor(-28.0976, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6596, dtype=torch.float64) delta_t tensor(0.6207, dtype=torch.float64)
11 gae_duplicate tensor(2.2574, dtype=torch.float64) tensor(-31.1339, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1572, dtype=torch.float64) delta_t tensor(0.1062, dtype=torch.float64)
10 gae_duplicate tensor(0.9702, dtype=torch.float64) tensor(-26.2876, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6876, dtype=torch.float64) delta_t tensor(-0.7110, dtype=torch.float64)
9 gae_duplicate tensor(-0.2863, dtype=torch.float64) tensor(-10.0800, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2106, dtype=torch.float64) delta_t tensor(-0.2518, dtype=torch.float64)
8 gae_duplicate tensor(-0.7965, dtype=torch.float64) tensor(-6.7119, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0881, dtype=torch.float64) delta_t tensor(-0.1149, dtype=torch.float64)
7 gae_duplicate tensor(-0.3208, dtype=torch.float64) tensor(-3.4035, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9215, dtype=torch.float64) delta_t tensor(-1.0255, dtype=torch.float64)
6 gae_duplicate tensor(-1.6654, dtype=torch.float64) tensor(8.4684, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1948, dtype=torch.float64) delta_t tensor(-1.4265, dtype=torch.float64)
5 gae_duplicate tensor(-3.6991, dtype=torch.float64) tensor(25.9985, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5428, dtype=torch.float64) delta_t tensor(-2.7017, dtype=torch.float64)
4 gae_duplicate tensor(-8.6736, dtype=torch.float64) tensor(53.7267, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2475, dtype=torch.float64) delta_t tensor(-0.3019, dtype=torch.float64)
3 gae_duplicate tensor(-7.1151, dtype=torch.float64) tensor(50.0134, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5798, dtype=torch.float64) delta_t tensor(-0.6348, dtype=torch.float64)
2 gae_duplicate tensor(-6.0115, dtype=torch.float64) tensor(49.7202, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1221.0423583984375
value loss:977.4639282226562
entropies:218.91049194335938
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.035761117935181 seconds
19 rew tensor(0.7263, dtype=torch.float64) delta_t tensor(0.3641, dtype=torch.float64)
19 gae_duplicate tensor(0.2720, dtype=torch.float64) tensor(-4.5178, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7220, dtype=torch.float64) delta_t tensor(0.6711, dtype=torch.float64)
18 gae_duplicate tensor(0.8379, dtype=torch.float64) tensor(-11.0627, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7102, dtype=torch.float64) delta_t tensor(0.6651, dtype=torch.float64)
17 gae_duplicate tensor(1.2426, dtype=torch.float64) tensor(-16.4656, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6899, dtype=torch.float64) delta_t tensor(0.6315, dtype=torch.float64)
16 gae_duplicate tensor(1.4956, dtype=torch.float64) tensor(-24.7671, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6318, dtype=torch.float64) delta_t tensor(0.5729, dtype=torch.float64)
15 gae_duplicate tensor(1.3789, dtype=torch.float64) tensor(-24.2168, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5417, dtype=torch.float64) delta_t tensor(0.4210, dtype=torch.float64)
14 gae_duplicate tensor(0.3830, dtype=torch.float64) tensor(-27.0615, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7378, dtype=torch.float64) delta_t tensor(0.6723, dtype=torch.float64)
13 gae_duplicate tensor(1.1449, dtype=torch.float64) tensor(-28.6123, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7114, dtype=torch.float64) delta_t tensor(0.6607, dtype=torch.float64)
12 gae_duplicate tensor(1.5049, dtype=torch.float64) tensor(-28.0483, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7599, dtype=torch.float64) delta_t tensor(0.6993, dtype=torch.float64)
11 gae_duplicate tensor(1.9189, dtype=torch.float64) tensor(-34.4543, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7261, dtype=torch.float64) delta_t tensor(0.6991, dtype=torch.float64)
10 gae_duplicate tensor(2.1132, dtype=torch.float64) tensor(-30.3569, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2141, dtype=torch.float64) delta_t tensor(0.2057, dtype=torch.float64)
9 gae_duplicate tensor(0.4776, dtype=torch.float64) tensor(-28.2597, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3136, dtype=torch.float64) delta_t tensor(-0.3876, dtype=torch.float64)
8 gae_duplicate tensor(-1.0707, dtype=torch.float64) tensor(-18.1648, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3431, dtype=torch.float64) delta_t tensor(-0.4246, dtype=torch.float64)
7 gae_duplicate tensor(-1.4473, dtype=torch.float64) tensor(-9.4565, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7878, dtype=torch.float64) delta_t tensor(-0.9166, dtype=torch.float64)
6 gae_duplicate tensor(-2.9708, dtype=torch.float64) tensor(2.0497, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1997, dtype=torch.float64) delta_t tensor(-1.2983, dtype=torch.float64)
5 gae_duplicate tensor(-4.8023, dtype=torch.float64) tensor(20.5780, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5479, dtype=torch.float64) delta_t tensor(-1.7204, dtype=torch.float64)
4 gae_duplicate tensor(-6.4862, dtype=torch.float64) tensor(39.8748, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6961, dtype=torch.float64) delta_t tensor(-0.7833, dtype=torch.float64)
3 gae_duplicate tensor(-5.3584, dtype=torch.float64) tensor(38.5534, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3805, dtype=torch.float64) delta_t tensor(-0.3708, dtype=torch.float64)
2 gae_duplicate tensor(-4.5371, dtype=torch.float64) tensor(30.2081, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:5511.283203125
value loss:883.4577026367188
entropies:217.78173828125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.806740045547485 seconds
19 rew tensor(0.5138, dtype=torch.float64) delta_t tensor(0.1891, dtype=torch.float64)
19 gae_duplicate tensor(-0.3177, dtype=torch.float64) tensor(-2.0680, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3143, dtype=torch.float64) delta_t tensor(0.1940, dtype=torch.float64)
18 gae_duplicate tensor(-1.2039, dtype=torch.float64) tensor(-4.4513, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7249, dtype=torch.float64) delta_t tensor(0.6325, dtype=torch.float64)
17 gae_duplicate tensor(-0.3309, dtype=torch.float64) tensor(-11.7924, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7223, dtype=torch.float64) delta_t tensor(0.6425, dtype=torch.float64)
16 gae_duplicate tensor(0.3707, dtype=torch.float64) tensor(-17.8995, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7180, dtype=torch.float64) delta_t tensor(0.6723, dtype=torch.float64)
15 gae_duplicate tensor(0.9351, dtype=torch.float64) tensor(-19.1852, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6821, dtype=torch.float64) delta_t tensor(0.5900, dtype=torch.float64)
14 gae_duplicate tensor(1.3250, dtype=torch.float64) tensor(-25.3251, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6675, dtype=torch.float64) delta_t tensor(0.6036, dtype=torch.float64)
13 gae_duplicate tensor(1.5804, dtype=torch.float64) tensor(-29.6214, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7255, dtype=torch.float64) delta_t tensor(0.6665, dtype=torch.float64)
12 gae_duplicate tensor(1.9222, dtype=torch.float64) tensor(-33.6861, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7487, dtype=torch.float64) delta_t tensor(0.6860, dtype=torch.float64)
11 gae_duplicate tensor(2.2185, dtype=torch.float64) tensor(-32.1508, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7049, dtype=torch.float64) delta_t tensor(0.6412, dtype=torch.float64)
10 gae_duplicate tensor(2.4591, dtype=torch.float64) tensor(-31.1260, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0787, dtype=torch.float64) delta_t tensor(-0.0967, dtype=torch.float64)
9 gae_duplicate tensor(0.7863, dtype=torch.float64) tensor(-24.0541, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7739, dtype=torch.float64) delta_t tensor(-0.8476, dtype=torch.float64)
8 gae_duplicate tensor(-0.6836, dtype=torch.float64) tensor(-10.7929, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2125, dtype=torch.float64) delta_t tensor(-0.2463, dtype=torch.float64)
7 gae_duplicate tensor(-1.1143, dtype=torch.float64) tensor(-5.7960, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5050, dtype=torch.float64) delta_t tensor(-0.6810, dtype=torch.float64)
6 gae_duplicate tensor(-1.3333, dtype=torch.float64) tensor(3.6533, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9614, dtype=torch.float64) delta_t tensor(-1.1832, dtype=torch.float64)
5 gae_duplicate tensor(-2.7160, dtype=torch.float64) tensor(17.7338, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6831, dtype=torch.float64) delta_t tensor(-2.7792, dtype=torch.float64)
4 gae_duplicate tensor(-7.7391, dtype=torch.float64) tensor(48.4108, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2650, dtype=torch.float64) delta_t tensor(-0.3316, dtype=torch.float64)
3 gae_duplicate tensor(-6.4141, dtype=torch.float64) tensor(36.3276, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5589, dtype=torch.float64) delta_t tensor(-0.4088, dtype=torch.float64)
2 gae_duplicate tensor(-5.4157, dtype=torch.float64) tensor(38.4459, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3682.56884765625
value loss:937.7568359375
entropies:216.74566650390625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.914024353027344 seconds
19 rew tensor(0.7161, dtype=torch.float64) delta_t tensor(0.2313, dtype=torch.float64)
19 gae_duplicate tensor(0.1320, dtype=torch.float64) tensor(-2.9568, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7029, dtype=torch.float64) delta_t tensor(0.6072, dtype=torch.float64)
18 gae_duplicate tensor(0.5219, dtype=torch.float64) tensor(-9.0906, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6679, dtype=torch.float64) delta_t tensor(0.6315, dtype=torch.float64)
17 gae_duplicate tensor(0.6764, dtype=torch.float64) tensor(-16.9104, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7091, dtype=torch.float64) delta_t tensor(0.6653, dtype=torch.float64)
16 gae_duplicate tensor(1.0333, dtype=torch.float64) tensor(-24.1909, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6813, dtype=torch.float64) delta_t tensor(0.6332, dtype=torch.float64)
15 gae_duplicate tensor(1.1836, dtype=torch.float64) tensor(-24.8730, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6421, dtype=torch.float64) delta_t tensor(0.5272, dtype=torch.float64)
14 gae_duplicate tensor(1.0405, dtype=torch.float64) tensor(-24.6349, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6921, dtype=torch.float64) delta_t tensor(0.6348, dtype=torch.float64)
13 gae_duplicate tensor(1.0310, dtype=torch.float64) tensor(-26.9720, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6817, dtype=torch.float64) delta_t tensor(0.6407, dtype=torch.float64)
12 gae_duplicate tensor(1.5147, dtype=torch.float64) tensor(-30.3468, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3547, dtype=torch.float64) delta_t tensor(0.2224, dtype=torch.float64)
11 gae_duplicate tensor(-0.1036, dtype=torch.float64) tensor(-25.8147, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5662, dtype=torch.float64) delta_t tensor(0.4893, dtype=torch.float64)
10 gae_duplicate tensor(0.4755, dtype=torch.float64) tensor(-26.1318, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1542, dtype=torch.float64) delta_t tensor(0.1547, dtype=torch.float64)
9 gae_duplicate tensor(0.7132, dtype=torch.float64) tensor(-23.5704, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5563, dtype=torch.float64) delta_t tensor(-0.5887, dtype=torch.float64)
8 gae_duplicate tensor(0.1592, dtype=torch.float64) tensor(-12.0684, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2062, dtype=torch.float64) delta_t tensor(-0.3119, dtype=torch.float64)
7 gae_duplicate tensor(-0.4228, dtype=torch.float64) tensor(-5.0304, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0350, dtype=torch.float64) delta_t tensor(-1.1208, dtype=torch.float64)
6 gae_duplicate tensor(-2.4846, dtype=torch.float64) tensor(7.8355, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2587, dtype=torch.float64) delta_t tensor(-1.4487, dtype=torch.float64)
5 gae_duplicate tensor(-3.8480, dtype=torch.float64) tensor(21.0917, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1587, dtype=torch.float64) delta_t tensor(-2.2533, dtype=torch.float64)
4 gae_duplicate tensor(-6.8336, dtype=torch.float64) tensor(39.5463, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2966, dtype=torch.float64) delta_t tensor(-0.3627, dtype=torch.float64)
3 gae_duplicate tensor(-5.5335, dtype=torch.float64) tensor(36.0565, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3121, dtype=torch.float64) delta_t tensor(-0.3217, dtype=torch.float64)
2 gae_duplicate tensor(-4.0472, dtype=torch.float64) tensor(37.0567, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3957.396484375
value loss:845.22119140625
entropies:215.35055541992188
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2491.6702)
ToM Target loss= tensor(1801.2528)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.914466857910156 seconds
19 rew tensor(0.7111, dtype=torch.float64) delta_t tensor(0.2131, dtype=torch.float64)
19 gae_duplicate tensor(-0.0004, dtype=torch.float64) tensor(-2.2407, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6694, dtype=torch.float64) delta_t tensor(0.6140, dtype=torch.float64)
18 gae_duplicate tensor(0.3765, dtype=torch.float64) tensor(-10.0201, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6336, dtype=torch.float64) delta_t tensor(0.5597, dtype=torch.float64)
17 gae_duplicate tensor(0.5055, dtype=torch.float64) tensor(-14.5271, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5363, dtype=torch.float64) delta_t tensor(0.3907, dtype=torch.float64)
16 gae_duplicate tensor(-0.3232, dtype=torch.float64) tensor(-17.8040, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7428, dtype=torch.float64) delta_t tensor(0.6486, dtype=torch.float64)
15 gae_duplicate tensor(0.3972, dtype=torch.float64) tensor(-19.9812, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7397, dtype=torch.float64) delta_t tensor(0.6706, dtype=torch.float64)
14 gae_duplicate tensor(0.9117, dtype=torch.float64) tensor(-23.9834, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7482, dtype=torch.float64) delta_t tensor(0.6887, dtype=torch.float64)
13 gae_duplicate tensor(1.4583, dtype=torch.float64) tensor(-26.4159, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7363, dtype=torch.float64) delta_t tensor(0.6439, dtype=torch.float64)
12 gae_duplicate tensor(1.7450, dtype=torch.float64) tensor(-27.6960, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7478, dtype=torch.float64) delta_t tensor(0.7067, dtype=torch.float64)
11 gae_duplicate tensor(2.1436, dtype=torch.float64) tensor(-35.0551, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6361, dtype=torch.float64) delta_t tensor(0.5497, dtype=torch.float64)
10 gae_duplicate tensor(2.1910, dtype=torch.float64) tensor(-29.6555, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1961, dtype=torch.float64) delta_t tensor(-0.2170, dtype=torch.float64)
9 gae_duplicate tensor(0.2059, dtype=torch.float64) tensor(-22.7932, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9513, dtype=torch.float64) delta_t tensor(-1.0608, dtype=torch.float64)
8 gae_duplicate tensor(-2.2737, dtype=torch.float64) tensor(-5.9210, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3541, dtype=torch.float64) delta_t tensor(-0.4602, dtype=torch.float64)
7 gae_duplicate tensor(-2.5975, dtype=torch.float64) tensor(0.9776, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0060, dtype=torch.float64) delta_t tensor(-1.1435, dtype=torch.float64)
6 gae_duplicate tensor(-3.6172, dtype=torch.float64) tensor(17.6062, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9413, dtype=torch.float64) delta_t tensor(-1.1040, dtype=torch.float64)
5 gae_duplicate tensor(-5.1619, dtype=torch.float64) tensor(23.3800, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5138, dtype=torch.float64) delta_t tensor(-1.6391, dtype=torch.float64)
4 gae_duplicate tensor(-8.1607, dtype=torch.float64) tensor(42.6015, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3804, dtype=torch.float64) delta_t tensor(-0.4048, dtype=torch.float64)
3 gae_duplicate tensor(-6.7859, dtype=torch.float64) tensor(33.2008, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3256, dtype=torch.float64) delta_t tensor(-0.3741, dtype=torch.float64)
2 gae_duplicate tensor(-5.6494, dtype=torch.float64) tensor(35.9178, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2928.010498046875
value loss:926.6583251953125
entropies:215.11053466796875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.7708899974823 seconds
19 rew tensor(0.7236, dtype=torch.float64) delta_t tensor(0.2868, dtype=torch.float64)
19 gae_duplicate tensor(0.2408, dtype=torch.float64) tensor(-3.8640, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7198, dtype=torch.float64) delta_t tensor(0.6116, dtype=torch.float64)
18 gae_duplicate tensor(0.7920, dtype=torch.float64) tensor(-9.6426, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7039, dtype=torch.float64) delta_t tensor(0.6843, dtype=torch.float64)
17 gae_duplicate tensor(1.0890, dtype=torch.float64) tensor(-16.6536, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6818, dtype=torch.float64) delta_t tensor(0.6118, dtype=torch.float64)
16 gae_duplicate tensor(1.2746, dtype=torch.float64) tensor(-19.0994, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6416, dtype=torch.float64) delta_t tensor(0.5311, dtype=torch.float64)
15 gae_duplicate tensor(1.1343, dtype=torch.float64) tensor(-21.0507, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7404, dtype=torch.float64) delta_t tensor(0.6172, dtype=torch.float64)
14 gae_duplicate tensor(1.5877, dtype=torch.float64) tensor(-22.6127, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7428, dtype=torch.float64) delta_t tensor(0.6762, dtype=torch.float64)
13 gae_duplicate tensor(1.9530, dtype=torch.float64) tensor(-28.9969, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6247, dtype=torch.float64) delta_t tensor(0.5242, dtype=torch.float64)
12 gae_duplicate tensor(1.5240, dtype=torch.float64) tensor(-27.6253, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5510, dtype=torch.float64) delta_t tensor(0.4872, dtype=torch.float64)
11 gae_duplicate tensor(1.7883, dtype=torch.float64) tensor(-28.9285, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5685, dtype=torch.float64) delta_t tensor(0.5463, dtype=torch.float64)
10 gae_duplicate tensor(1.8872, dtype=torch.float64) tensor(-27.9303, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2101, dtype=torch.float64) delta_t tensor(-0.3025, dtype=torch.float64)
9 gae_duplicate tensor(-0.7365, dtype=torch.float64) tensor(-21.3673, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3782, dtype=torch.float64) delta_t tensor(-0.4433, dtype=torch.float64)
8 gae_duplicate tensor(-0.3670, dtype=torch.float64) tensor(-10.2521, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6844, dtype=torch.float64) delta_t tensor(-0.8422, dtype=torch.float64)
7 gae_duplicate tensor(-2.8791, dtype=torch.float64) tensor(0.5658, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7537, dtype=torch.float64) delta_t tensor(-0.8842, dtype=torch.float64)
6 gae_duplicate tensor(-4.6004, dtype=torch.float64) tensor(16.5575, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6334, dtype=torch.float64) delta_t tensor(-0.8121, dtype=torch.float64)
5 gae_duplicate tensor(-5.6583, dtype=torch.float64) tensor(16.8542, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9576, dtype=torch.float64) delta_t tensor(-0.9471, dtype=torch.float64)
4 gae_duplicate tensor(-9.2725, dtype=torch.float64) tensor(33.4753, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6486, dtype=torch.float64) delta_t tensor(-0.7406, dtype=torch.float64)
3 gae_duplicate tensor(-7.5212, dtype=torch.float64) tensor(26.5314, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0410, dtype=torch.float64) delta_t tensor(-0.1526, dtype=torch.float64)
2 gae_duplicate tensor(-6.5529, dtype=torch.float64) tensor(29.7687, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4075.14794921875
value loss:821.7039794921875
entropies:214.38381958007812
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.790060043334961 seconds
19 rew tensor(0.5297, dtype=torch.float64) delta_t tensor(-0.0203, dtype=torch.float64)
19 gae_duplicate tensor(-0.5653, dtype=torch.float64) tensor(-0.1333, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3720, dtype=torch.float64) delta_t tensor(0.2311, dtype=torch.float64)
18 gae_duplicate tensor(-1.5748, dtype=torch.float64) tensor(-2.1399, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5587, dtype=torch.float64) delta_t tensor(0.4941, dtype=torch.float64)
17 gae_duplicate tensor(-0.6346, dtype=torch.float64) tensor(-9.4695, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4062, dtype=torch.float64) delta_t tensor(0.3139, dtype=torch.float64)
16 gae_duplicate tensor(-1.2499, dtype=torch.float64) tensor(-11.5765, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6490, dtype=torch.float64) delta_t tensor(0.5691, dtype=torch.float64)
15 gae_duplicate tensor(-0.3843, dtype=torch.float64) tensor(-14.1982, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5771, dtype=torch.float64) delta_t tensor(0.4245, dtype=torch.float64)
14 gae_duplicate tensor(0.2198, dtype=torch.float64) tensor(-15.0381, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7261, dtype=torch.float64) delta_t tensor(0.6421, dtype=torch.float64)
13 gae_duplicate tensor(0.7717, dtype=torch.float64) tensor(-19.8783, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7138, dtype=torch.float64) delta_t tensor(0.6598, dtype=torch.float64)
12 gae_duplicate tensor(1.2153, dtype=torch.float64) tensor(-24.9105, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3313, dtype=torch.float64) delta_t tensor(0.2195, dtype=torch.float64)
11 gae_duplicate tensor(0.6103, dtype=torch.float64) tensor(-20.7730, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4429, dtype=torch.float64) delta_t tensor(0.3879, dtype=torch.float64)
10 gae_duplicate tensor(-0.4095, dtype=torch.float64) tensor(-22.6911, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7454, dtype=torch.float64) delta_t tensor(-0.7787, dtype=torch.float64)
9 gae_duplicate tensor(-1.1741, dtype=torch.float64) tensor(-7.3556, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1968, dtype=torch.float64) delta_t tensor(-0.2673, dtype=torch.float64)
8 gae_duplicate tensor(-1.8401, dtype=torch.float64) tensor(-1.7784, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5126, dtype=torch.float64) delta_t tensor(-0.6160, dtype=torch.float64)
7 gae_duplicate tensor(-2.8411, dtype=torch.float64) tensor(2.5691, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9288, dtype=torch.float64) delta_t tensor(-1.0746, dtype=torch.float64)
6 gae_duplicate tensor(-3.2811, dtype=torch.float64) tensor(14.4417, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6000, dtype=torch.float64) delta_t tensor(-1.6212, dtype=torch.float64)
5 gae_duplicate tensor(-4.8492, dtype=torch.float64) tensor(29.8138, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1233, dtype=torch.float64) delta_t tensor(-2.3303, dtype=torch.float64)
4 gae_duplicate tensor(-9.9313, dtype=torch.float64) tensor(48.0276, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3318, dtype=torch.float64) delta_t tensor(-0.4023, dtype=torch.float64)
3 gae_duplicate tensor(-8.1553, dtype=torch.float64) tensor(46.8152, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3257, dtype=torch.float64) delta_t tensor(-0.3328, dtype=torch.float64)
2 gae_duplicate tensor(-6.9177, dtype=torch.float64) tensor(36.2647, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1046.1004638671875
value loss:1162.2667236328125
entropies:213.74151611328125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.810490131378174 seconds
19 rew tensor(0.6279, dtype=torch.float64) delta_t tensor(0.0734, dtype=torch.float64)
19 gae_duplicate tensor(-0.4673, dtype=torch.float64) tensor(-1.2350, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5547, dtype=torch.float64) delta_t tensor(0.5010, dtype=torch.float64)
18 gae_duplicate tensor(-0.4797, dtype=torch.float64) tensor(-5.9117, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3995, dtype=torch.float64) delta_t tensor(0.2404, dtype=torch.float64)
17 gae_duplicate tensor(-1.6290, dtype=torch.float64) tensor(-9.9486, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6914, dtype=torch.float64) delta_t tensor(0.5930, dtype=torch.float64)
16 gae_duplicate tensor(-0.6481, dtype=torch.float64) tensor(-15.5084, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7009, dtype=torch.float64) delta_t tensor(0.5795, dtype=torch.float64)
15 gae_duplicate tensor(0.1388, dtype=torch.float64) tensor(-18.4627, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6877, dtype=torch.float64) delta_t tensor(0.6038, dtype=torch.float64)
14 gae_duplicate tensor(0.7706, dtype=torch.float64) tensor(-19.9985, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6522, dtype=torch.float64) delta_t tensor(0.5696, dtype=torch.float64)
13 gae_duplicate tensor(1.2182, dtype=torch.float64) tensor(-26.1847, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6529, dtype=torch.float64) delta_t tensor(0.5697, dtype=torch.float64)
12 gae_duplicate tensor(1.6222, dtype=torch.float64) tensor(-24.5005, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5046, dtype=torch.float64) delta_t tensor(0.3727, dtype=torch.float64)
11 gae_duplicate tensor(1.0857, dtype=torch.float64) tensor(-25.9860, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6108, dtype=torch.float64) delta_t tensor(0.5766, dtype=torch.float64)
10 gae_duplicate tensor(1.4045, dtype=torch.float64) tensor(-25.6861, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2480, dtype=torch.float64) delta_t tensor(0.1731, dtype=torch.float64)
9 gae_duplicate tensor(0.6549, dtype=torch.float64) tensor(-22.1065, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0646, dtype=torch.float64) delta_t tensor(-0.1565, dtype=torch.float64)
8 gae_duplicate tensor(-0.6616, dtype=torch.float64) tensor(-16.3717, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1276, dtype=torch.float64) delta_t tensor(-0.2401, dtype=torch.float64)
7 gae_duplicate tensor(-0.9580, dtype=torch.float64) tensor(-10.4575, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2523, dtype=torch.float64) delta_t tensor(-1.3510, dtype=torch.float64)
6 gae_duplicate tensor(-2.2130, dtype=torch.float64) tensor(6.7416, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6035, dtype=torch.float64) delta_t tensor(-1.8064, dtype=torch.float64)
5 gae_duplicate tensor(-3.9624, dtype=torch.float64) tensor(29.3599, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.2641, dtype=torch.float64) delta_t tensor(-3.3205, dtype=torch.float64)
4 gae_duplicate tensor(-9.8248, dtype=torch.float64) tensor(64.8937, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3806, dtype=torch.float64) delta_t tensor(-0.5062, dtype=torch.float64)
3 gae_duplicate tensor(-8.0341, dtype=torch.float64) tensor(62.3307, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1049, dtype=torch.float64) delta_t tensor(-0.2532, dtype=torch.float64)
2 gae_duplicate tensor(-6.6341, dtype=torch.float64) tensor(53.1894, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:171.9630889892578
value loss:1170.4566650390625
entropies:213.1847686767578
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.9008708000183105 seconds
19 rew tensor(0.5539, dtype=torch.float64) delta_t tensor(0.0328, dtype=torch.float64)
19 gae_duplicate tensor(-0.4131, dtype=torch.float64) tensor(0.0103, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3981, dtype=torch.float64) delta_t tensor(0.3046, dtype=torch.float64)
18 gae_duplicate tensor(-1.1289, dtype=torch.float64) tensor(-4.1063, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5430, dtype=torch.float64) delta_t tensor(0.4320, dtype=torch.float64)
17 gae_duplicate tensor(-0.3348, dtype=torch.float64) tensor(-7.9277, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6933, dtype=torch.float64) delta_t tensor(0.5976, dtype=torch.float64)
16 gae_duplicate tensor(0.2984, dtype=torch.float64) tensor(-14.6909, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6799, dtype=torch.float64) delta_t tensor(0.5757, dtype=torch.float64)
15 gae_duplicate tensor(0.7100, dtype=torch.float64) tensor(-16.1645, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6612, dtype=torch.float64) delta_t tensor(0.4875, dtype=torch.float64)
14 gae_duplicate tensor(1.0369, dtype=torch.float64) tensor(-20.3938, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5979, dtype=torch.float64) delta_t tensor(0.5214, dtype=torch.float64)
13 gae_duplicate tensor(1.1398, dtype=torch.float64) tensor(-25.8243, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6797, dtype=torch.float64) delta_t tensor(0.5521, dtype=torch.float64)
12 gae_duplicate tensor(1.5077, dtype=torch.float64) tensor(-28.9851, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6937, dtype=torch.float64) delta_t tensor(0.6150, dtype=torch.float64)
11 gae_duplicate tensor(1.8228, dtype=torch.float64) tensor(-27.2300, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4502, dtype=torch.float64) delta_t tensor(0.3332, dtype=torch.float64)
10 gae_duplicate tensor(1.6651, dtype=torch.float64) tensor(-23.4815, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0580, dtype=torch.float64) delta_t tensor(-0.1673, dtype=torch.float64)
9 gae_duplicate tensor(0.3249, dtype=torch.float64) tensor(-17.7169, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2664, dtype=torch.float64) delta_t tensor(-0.3398, dtype=torch.float64)
8 gae_duplicate tensor(-0.1739, dtype=torch.float64) tensor(-9.4566, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5391, dtype=torch.float64) delta_t tensor(-0.5712, dtype=torch.float64)
7 gae_duplicate tensor(-1.5466, dtype=torch.float64) tensor(-0.8751, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9454, dtype=torch.float64) delta_t tensor(-1.0519, dtype=torch.float64)
6 gae_duplicate tensor(-3.1569, dtype=torch.float64) tensor(11.0403, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0534, dtype=torch.float64) delta_t tensor(-1.2614, dtype=torch.float64)
5 gae_duplicate tensor(-4.0663, dtype=torch.float64) tensor(19.9407, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6031, dtype=torch.float64) delta_t tensor(-0.7281, dtype=torch.float64)
4 gae_duplicate tensor(-4.2789, dtype=torch.float64) tensor(25.3647, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4848, dtype=torch.float64) delta_t tensor(-0.5422, dtype=torch.float64)
3 gae_duplicate tensor(-3.4460, dtype=torch.float64) tensor(28.7263, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5075, dtype=torch.float64) delta_t tensor(-0.4868, dtype=torch.float64)
2 gae_duplicate tensor(-2.7809, dtype=torch.float64) tensor(26.6489, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3026.1552734375
value loss:539.8945922851562
entropies:212.34609985351562
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2474.5769)
ToM Target loss= tensor(1801.6406)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.974790811538696 seconds
19 rew tensor(0.4294, dtype=torch.float64) delta_t tensor(-0.2095, dtype=torch.float64)
19 gae_duplicate tensor(-1.4424, dtype=torch.float64) tensor(2.2097, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6682, dtype=torch.float64) delta_t tensor(0.5416, dtype=torch.float64)
18 gae_duplicate tensor(-0.5322, dtype=torch.float64) tensor(-4.5255, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6083, dtype=torch.float64) delta_t tensor(0.5254, dtype=torch.float64)
17 gae_duplicate tensor(0.1310, dtype=torch.float64) tensor(-8.8028, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5037, dtype=torch.float64) delta_t tensor(0.3601, dtype=torch.float64)
16 gae_duplicate tensor(-0.7721, dtype=torch.float64) tensor(-12.5568, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7182, dtype=torch.float64) delta_t tensor(0.5641, dtype=torch.float64)
15 gae_duplicate tensor(-0.1409, dtype=torch.float64) tensor(-14.2935, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7276, dtype=torch.float64) delta_t tensor(0.6485, dtype=torch.float64)
14 gae_duplicate tensor(0.4352, dtype=torch.float64) tensor(-21.4291, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7231, dtype=torch.float64) delta_t tensor(0.6463, dtype=torch.float64)
13 gae_duplicate tensor(0.8976, dtype=torch.float64) tensor(-27.5660, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5764, dtype=torch.float64) delta_t tensor(0.4830, dtype=torch.float64)
12 gae_duplicate tensor(1.2198, dtype=torch.float64) tensor(-22.1497, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6147, dtype=torch.float64) delta_t tensor(0.5036, dtype=torch.float64)
11 gae_duplicate tensor(1.5661, dtype=torch.float64) tensor(-21.2844, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5571, dtype=torch.float64) delta_t tensor(0.4991, dtype=torch.float64)
10 gae_duplicate tensor(1.6879, dtype=torch.float64) tensor(-26.5150, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1875, dtype=torch.float64) delta_t tensor(0.1321, dtype=torch.float64)
9 gae_duplicate tensor(0.8550, dtype=torch.float64) tensor(-21.6289, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4386, dtype=torch.float64) delta_t tensor(-0.5257, dtype=torch.float64)
8 gae_duplicate tensor(-1.7038, dtype=torch.float64) tensor(-13.1144, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1678, dtype=torch.float64) delta_t tensor(-1.3250, dtype=torch.float64)
7 gae_duplicate tensor(-3.0575, dtype=torch.float64) tensor(7.2870, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1028, dtype=torch.float64) delta_t tensor(-1.2729, dtype=torch.float64)
6 gae_duplicate tensor(-3.4617, dtype=torch.float64) tensor(25.3673, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0940, dtype=torch.float64) delta_t tensor(-1.2604, dtype=torch.float64)
5 gae_duplicate tensor(-4.7312, dtype=torch.float64) tensor(28.4081, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0291, dtype=torch.float64) delta_t tensor(-3.2084, dtype=torch.float64)
4 gae_duplicate tensor(-7.8265, dtype=torch.float64) tensor(53.3094, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4359, dtype=torch.float64) delta_t tensor(-0.3721, dtype=torch.float64)
3 gae_duplicate tensor(-6.5051, dtype=torch.float64) tensor(56.7439, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2405, dtype=torch.float64) delta_t tensor(-0.3236, dtype=torch.float64)
2 gae_duplicate tensor(-5.6002, dtype=torch.float64) tensor(58.5862, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1407.861572265625
value loss:1157.2762451171875
entropies:212.31256103515625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.363901376724243 seconds
19 rew tensor(0.4133, dtype=torch.float64) delta_t tensor(-0.2155, dtype=torch.float64)
19 gae_duplicate tensor(-1.7455, dtype=torch.float64) tensor(2.2959, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7216, dtype=torch.float64) delta_t tensor(0.5965, dtype=torch.float64)
18 gae_duplicate tensor(-0.7953, dtype=torch.float64) tensor(-4.7400, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7155, dtype=torch.float64) delta_t tensor(0.5793, dtype=torch.float64)
17 gae_duplicate tensor(-0.0335, dtype=torch.float64) tensor(-12.7963, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7248, dtype=torch.float64) delta_t tensor(0.6444, dtype=torch.float64)
16 gae_duplicate tensor(0.5777, dtype=torch.float64) tensor(-15.8433, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7190, dtype=torch.float64) delta_t tensor(0.6217, dtype=torch.float64)
15 gae_duplicate tensor(1.0148, dtype=torch.float64) tensor(-21.9850, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7204, dtype=torch.float64) delta_t tensor(0.6242, dtype=torch.float64)
14 gae_duplicate tensor(1.4384, dtype=torch.float64) tensor(-25.8269, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7223, dtype=torch.float64) delta_t tensor(0.6110, dtype=torch.float64)
13 gae_duplicate tensor(1.7377, dtype=torch.float64) tensor(-24.6041, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7314, dtype=torch.float64) delta_t tensor(0.6185, dtype=torch.float64)
12 gae_duplicate tensor(2.0074, dtype=torch.float64) tensor(-23.6961, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6850, dtype=torch.float64) delta_t tensor(0.6125, dtype=torch.float64)
11 gae_duplicate tensor(2.2248, dtype=torch.float64) tensor(-30.6603, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4532, dtype=torch.float64) delta_t tensor(0.3580, dtype=torch.float64)
10 gae_duplicate tensor(1.4005, dtype=torch.float64) tensor(-24.7259, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1648, dtype=torch.float64) delta_t tensor(-1.2478, dtype=torch.float64)
9 gae_duplicate tensor(-4.7007, dtype=torch.float64) tensor(-9.7529, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0516, dtype=torch.float64) delta_t tensor(-0.1612, dtype=torch.float64)
8 gae_duplicate tensor(-3.5474, dtype=torch.float64) tensor(-4.6043, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1995, dtype=torch.float64) delta_t tensor(-0.2768, dtype=torch.float64)
7 gae_duplicate tensor(-2.6052, dtype=torch.float64) tensor(4.4569, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4796, dtype=torch.float64) delta_t tensor(-0.6487, dtype=torch.float64)
6 gae_duplicate tensor(-2.2899, dtype=torch.float64) tensor(6.3544, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0801, dtype=torch.float64) delta_t tensor(-1.2513, dtype=torch.float64)
5 gae_duplicate tensor(-3.7197, dtype=torch.float64) tensor(21.2446, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0160, dtype=torch.float64) delta_t tensor(-1.0403, dtype=torch.float64)
4 gae_duplicate tensor(-5.6894, dtype=torch.float64) tensor(23.6503, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2455, dtype=torch.float64) delta_t tensor(-0.2768, dtype=torch.float64)
3 gae_duplicate tensor(-4.7805, dtype=torch.float64) tensor(26.7277, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4969, dtype=torch.float64) delta_t tensor(-0.5883, dtype=torch.float64)
2 gae_duplicate tensor(-3.8885, dtype=torch.float64) tensor(25.7317, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3157.831298828125
value loss:712.3853149414062
entropies:211.21356201171875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.041096925735474 seconds
19 rew tensor(0.6706, dtype=torch.float64) delta_t tensor(-0.0201, dtype=torch.float64)
19 gae_duplicate tensor(-0.3136, dtype=torch.float64) tensor(0.3704, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6548, dtype=torch.float64) delta_t tensor(0.5985, dtype=torch.float64)
18 gae_duplicate tensor(0.1203, dtype=torch.float64) tensor(-7.4200, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5837, dtype=torch.float64) delta_t tensor(0.5193, dtype=torch.float64)
17 gae_duplicate tensor(0.2068, dtype=torch.float64) tensor(-13.4296, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4641, dtype=torch.float64) delta_t tensor(0.3167, dtype=torch.float64)
16 gae_duplicate tensor(-0.5701, dtype=torch.float64) tensor(-15.6476, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6313, dtype=torch.float64) delta_t tensor(0.5407, dtype=torch.float64)
15 gae_duplicate tensor(0.0739, dtype=torch.float64) tensor(-18.2217, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5806, dtype=torch.float64) delta_t tensor(0.4303, dtype=torch.float64)
14 gae_duplicate tensor(0.6206, dtype=torch.float64) tensor(-17.9144, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7006, dtype=torch.float64) delta_t tensor(0.5952, dtype=torch.float64)
13 gae_duplicate tensor(1.0879, dtype=torch.float64) tensor(-21.5454, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6776, dtype=torch.float64) delta_t tensor(0.5781, dtype=torch.float64)
12 gae_duplicate tensor(1.1060, dtype=torch.float64) tensor(-25.7128, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6790, dtype=torch.float64) delta_t tensor(0.5939, dtype=torch.float64)
11 gae_duplicate tensor(1.5496, dtype=torch.float64) tensor(-30.8450, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6430, dtype=torch.float64) delta_t tensor(0.5491, dtype=torch.float64)
10 gae_duplicate tensor(1.6425, dtype=torch.float64) tensor(-25.9700, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6040, dtype=torch.float64) delta_t tensor(0.5222, dtype=torch.float64)
9 gae_duplicate tensor(1.5587, dtype=torch.float64) tensor(-23.0419, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1418, dtype=torch.float64) delta_t tensor(-0.2262, dtype=torch.float64)
8 gae_duplicate tensor(-0.3251, dtype=torch.float64) tensor(-19.7539, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5185, dtype=torch.float64) delta_t tensor(-0.6258, dtype=torch.float64)
7 gae_duplicate tensor(-0.9593, dtype=torch.float64) tensor(-8.2459, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7558, dtype=torch.float64) delta_t tensor(-0.9021, dtype=torch.float64)
6 gae_duplicate tensor(-2.1457, dtype=torch.float64) tensor(5.8633, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9433, dtype=torch.float64) delta_t tensor(-1.0541, dtype=torch.float64)
5 gae_duplicate tensor(-4.2967, dtype=torch.float64) tensor(19.0778, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1536, dtype=torch.float64) delta_t tensor(-1.2726, dtype=torch.float64)
4 gae_duplicate tensor(-9.5431, dtype=torch.float64) tensor(23.3771, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4902, dtype=torch.float64) delta_t tensor(-0.6079, dtype=torch.float64)
3 gae_duplicate tensor(-7.8950, dtype=torch.float64) tensor(23.4252, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7746, dtype=torch.float64) delta_t tensor(-0.6334, dtype=torch.float64)
2 gae_duplicate tensor(-6.2125, dtype=torch.float64) tensor(26.0115, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4628.58447265625
value loss:743.1951904296875
entropies:210.22564697265625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.76606297492981 seconds
19 rew tensor(0.6340, dtype=torch.float64) delta_t tensor(0.0152, dtype=torch.float64)
19 gae_duplicate tensor(-0.3545, dtype=torch.float64) tensor(-0.3978, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5755, dtype=torch.float64) delta_t tensor(0.4525, dtype=torch.float64)
18 gae_duplicate tensor(-0.3174, dtype=torch.float64) tensor(-4.7388, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4453, dtype=torch.float64) delta_t tensor(0.2792, dtype=torch.float64)
17 gae_duplicate tensor(-1.3241, dtype=torch.float64) tensor(-8.3787, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6975, dtype=torch.float64) delta_t tensor(0.5679, dtype=torch.float64)
16 gae_duplicate tensor(-0.4411, dtype=torch.float64) tensor(-12.3618, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6508, dtype=torch.float64) delta_t tensor(0.5201, dtype=torch.float64)
15 gae_duplicate tensor(0.2669, dtype=torch.float64) tensor(-17.8017, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6056, dtype=torch.float64) delta_t tensor(0.4621, dtype=torch.float64)
14 gae_duplicate tensor(0.7286, dtype=torch.float64) tensor(-17.9789, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6907, dtype=torch.float64) delta_t tensor(0.5834, dtype=torch.float64)
13 gae_duplicate tensor(1.2023, dtype=torch.float64) tensor(-21.0300, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7225, dtype=torch.float64) delta_t tensor(0.6509, dtype=torch.float64)
12 gae_duplicate tensor(1.4537, dtype=torch.float64) tensor(-22.9980, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6938, dtype=torch.float64) delta_t tensor(0.5933, dtype=torch.float64)
11 gae_duplicate tensor(1.7170, dtype=torch.float64) tensor(-27.5821, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6065, dtype=torch.float64) delta_t tensor(0.5276, dtype=torch.float64)
10 gae_duplicate tensor(1.6698, dtype=torch.float64) tensor(-29.9259, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6569, dtype=torch.float64) delta_t tensor(-0.7596, dtype=torch.float64)
9 gae_duplicate tensor(-0.5017, dtype=torch.float64) tensor(-18.0849, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5352, dtype=torch.float64) delta_t tensor(-0.6030, dtype=torch.float64)
8 gae_duplicate tensor(-1.1692, dtype=torch.float64) tensor(-4.4400, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4449, dtype=torch.float64) delta_t tensor(-0.5320, dtype=torch.float64)
7 gae_duplicate tensor(-1.5460, dtype=torch.float64) tensor(4.3219, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7268, dtype=torch.float64) delta_t tensor(-0.8759, dtype=torch.float64)
6 gae_duplicate tensor(-2.8056, dtype=torch.float64) tensor(10.9566, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7199, dtype=torch.float64) delta_t tensor(-1.7136, dtype=torch.float64)
5 gae_duplicate tensor(-6.3363, dtype=torch.float64) tensor(33.6829, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2154, dtype=torch.float64) delta_t tensor(-1.4914, dtype=torch.float64)
4 gae_duplicate tensor(-8.4082, dtype=torch.float64) tensor(32.6266, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3877, dtype=torch.float64) delta_t tensor(-0.4336, dtype=torch.float64)
3 gae_duplicate tensor(-6.8176, dtype=torch.float64) tensor(33.1579, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0938, dtype=torch.float64) delta_t tensor(-0.2612, dtype=torch.float64)
2 gae_duplicate tensor(-5.6104, dtype=torch.float64) tensor(29.4195, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1458.08642578125
value loss:915.7323608398438
entropies:210.16189575195312
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.756856203079224 seconds
19 rew tensor(0.6709, dtype=torch.float64) delta_t tensor(-0.0168, dtype=torch.float64)
19 gae_duplicate tensor(-0.3821, dtype=torch.float64) tensor(0.0302, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6324, dtype=torch.float64) delta_t tensor(0.4975, dtype=torch.float64)
18 gae_duplicate tensor(-0.0894, dtype=torch.float64) tensor(-6.1094, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5525, dtype=torch.float64) delta_t tensor(0.5059, dtype=torch.float64)
17 gae_duplicate tensor(-0.1192, dtype=torch.float64) tensor(-10.3076, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4064, dtype=torch.float64) delta_t tensor(0.2926, dtype=torch.float64)
16 gae_duplicate tensor(-1.0656, dtype=torch.float64) tensor(-10.3475, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5673, dtype=torch.float64) delta_t tensor(0.4488, dtype=torch.float64)
15 gae_duplicate tensor(-0.3112, dtype=torch.float64) tensor(-15.8043, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4121, dtype=torch.float64) delta_t tensor(0.2460, dtype=torch.float64)
14 gae_duplicate tensor(0.2934, dtype=torch.float64) tensor(-14.5008, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6865, dtype=torch.float64) delta_t tensor(0.6138, dtype=torch.float64)
13 gae_duplicate tensor(0.7906, dtype=torch.float64) tensor(-18.2195, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7112, dtype=torch.float64) delta_t tensor(0.5863, dtype=torch.float64)
12 gae_duplicate tensor(1.1161, dtype=torch.float64) tensor(-25.7091, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7257, dtype=torch.float64) delta_t tensor(0.5777, dtype=torch.float64)
11 gae_duplicate tensor(1.4054, dtype=torch.float64) tensor(-24.1781, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5110, dtype=torch.float64) delta_t tensor(0.4405, dtype=torch.float64)
10 gae_duplicate tensor(1.4753, dtype=torch.float64) tensor(-30.4342, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4838, dtype=torch.float64) delta_t tensor(-0.6407, dtype=torch.float64)
9 gae_duplicate tensor(-0.0095, dtype=torch.float64) tensor(-12.5948, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3035, dtype=torch.float64) delta_t tensor(-0.3669, dtype=torch.float64)
8 gae_duplicate tensor(-0.8257, dtype=torch.float64) tensor(-2.2509, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5355, dtype=torch.float64) delta_t tensor(-0.6574, dtype=torch.float64)
7 gae_duplicate tensor(-3.3798, dtype=torch.float64) tensor(2.8366, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5652, dtype=torch.float64) delta_t tensor(-0.7252, dtype=torch.float64)
6 gae_duplicate tensor(-3.3670, dtype=torch.float64) tensor(9.0925, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0553, dtype=torch.float64) delta_t tensor(-1.1818, dtype=torch.float64)
5 gae_duplicate tensor(-4.6453, dtype=torch.float64) tensor(18.0178, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2449, dtype=torch.float64) delta_t tensor(-2.3665, dtype=torch.float64)
4 gae_duplicate tensor(-6.8145, dtype=torch.float64) tensor(52.6575, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4156, dtype=torch.float64) delta_t tensor(-0.4268, dtype=torch.float64)
3 gae_duplicate tensor(-5.6490, dtype=torch.float64) tensor(42.6484, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1570, dtype=torch.float64) delta_t tensor(-0.2369, dtype=torch.float64)
2 gae_duplicate tensor(-4.8098, dtype=torch.float64) tensor(32.9817, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:400.89990234375
value loss:793.8016357421875
entropies:211.0613555908203
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2472.5693)
ToM Target loss= tensor(1804.1814)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.9094557762146 seconds
19 rew tensor(0.6913, dtype=torch.float64) delta_t tensor(-0.0384, dtype=torch.float64)
19 gae_duplicate tensor(-0.3666, dtype=torch.float64) tensor(0.4244, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6628, dtype=torch.float64) delta_t tensor(0.5048, dtype=torch.float64)
18 gae_duplicate tensor(-0.0842, dtype=torch.float64) tensor(-5.4336, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5822, dtype=torch.float64) delta_t tensor(0.5116, dtype=torch.float64)
17 gae_duplicate tensor(-0.1712, dtype=torch.float64) tensor(-10.0206, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4417, dtype=torch.float64) delta_t tensor(0.3162, dtype=torch.float64)
16 gae_duplicate tensor(-1.1147, dtype=torch.float64) tensor(-13.0016, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6494, dtype=torch.float64) delta_t tensor(0.5376, dtype=torch.float64)
15 gae_duplicate tensor(-0.3487, dtype=torch.float64) tensor(-16.7133, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5678, dtype=torch.float64) delta_t tensor(0.4381, dtype=torch.float64)
14 gae_duplicate tensor(0.2238, dtype=torch.float64) tensor(-16.3037, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6823, dtype=torch.float64) delta_t tensor(0.5356, dtype=torch.float64)
13 gae_duplicate tensor(0.6800, dtype=torch.float64) tensor(-17.8510, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6985, dtype=torch.float64) delta_t tensor(0.5407, dtype=torch.float64)
12 gae_duplicate tensor(0.8936, dtype=torch.float64) tensor(-22.9753, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7091, dtype=torch.float64) delta_t tensor(0.5829, dtype=torch.float64)
11 gae_duplicate tensor(1.2405, dtype=torch.float64) tensor(-25.7068, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3536, dtype=torch.float64) delta_t tensor(0.2441, dtype=torch.float64)
10 gae_duplicate tensor(0.2621, dtype=torch.float64) tensor(-21.1510, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6062, dtype=torch.float64) delta_t tensor(-0.7319, dtype=torch.float64)
9 gae_duplicate tensor(-1.1361, dtype=torch.float64) tensor(-11.1706, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7953, dtype=torch.float64) delta_t tensor(-0.9130, dtype=torch.float64)
8 gae_duplicate tensor(-2.3333, dtype=torch.float64) tensor(5.8097, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9550, dtype=torch.float64) delta_t tensor(-1.0095, dtype=torch.float64)
7 gae_duplicate tensor(-2.4507, dtype=torch.float64) tensor(18.3715, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1434, dtype=torch.float64) delta_t tensor(-1.2910, dtype=torch.float64)
6 gae_duplicate tensor(-3.5079, dtype=torch.float64) tensor(26.0781, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2248, dtype=torch.float64) delta_t tensor(-1.3509, dtype=torch.float64)
5 gae_duplicate tensor(-5.2327, dtype=torch.float64) tensor(32.1077, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8398, dtype=torch.float64) delta_t tensor(-3.0839, dtype=torch.float64)
4 gae_duplicate tensor(-8.1618, dtype=torch.float64) tensor(59.9007, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4808, dtype=torch.float64) delta_t tensor(-0.5311, dtype=torch.float64)
3 gae_duplicate tensor(-6.8072, dtype=torch.float64) tensor(57.6452, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3127, dtype=torch.float64) delta_t tensor(-0.2949, dtype=torch.float64)
2 gae_duplicate tensor(-5.7843, dtype=torch.float64) tensor(49.1798, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3248.87939453125
value loss:1248.972900390625
entropies:211.42373657226562
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.767071008682251 seconds
19 rew tensor(0.7063, dtype=torch.float64) delta_t tensor(0.0474, dtype=torch.float64)
19 gae_duplicate tensor(-0.0964, dtype=torch.float64) tensor(-0.6425, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7149, dtype=torch.float64) delta_t tensor(0.5673, dtype=torch.float64)
18 gae_duplicate tensor(0.4485, dtype=torch.float64) tensor(-7.9611, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6992, dtype=torch.float64) delta_t tensor(0.5925, dtype=torch.float64)
17 gae_duplicate tensor(0.9662, dtype=torch.float64) tensor(-14.0545, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6766, dtype=torch.float64) delta_t tensor(0.5310, dtype=torch.float64)
16 gae_duplicate tensor(1.2610, dtype=torch.float64) tensor(-15.7668, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6219, dtype=torch.float64) delta_t tensor(0.4993, dtype=torch.float64)
15 gae_duplicate tensor(1.1591, dtype=torch.float64) tensor(-18.4346, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5973, dtype=torch.float64) delta_t tensor(0.4527, dtype=torch.float64)
14 gae_duplicate tensor(1.1033, dtype=torch.float64) tensor(-21.1113, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5972, dtype=torch.float64) delta_t tensor(0.4936, dtype=torch.float64)
13 gae_duplicate tensor(1.5223, dtype=torch.float64) tensor(-19.6183, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3483, dtype=torch.float64) delta_t tensor(0.2175, dtype=torch.float64)
12 gae_duplicate tensor(0.8391, dtype=torch.float64) tensor(-22.7124, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4689, dtype=torch.float64) delta_t tensor(0.3199, dtype=torch.float64)
11 gae_duplicate tensor(0.5775, dtype=torch.float64) tensor(-17.2264, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1674, dtype=torch.float64) delta_t tensor(0.0654, dtype=torch.float64)
10 gae_duplicate tensor(0.3481, dtype=torch.float64) tensor(-15.5036, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1343, dtype=torch.float64) delta_t tensor(-0.2291, dtype=torch.float64)
9 gae_duplicate tensor(-1.3208, dtype=torch.float64) tensor(-12.7174, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0074, dtype=torch.float64) delta_t tensor(-0.1195, dtype=torch.float64)
8 gae_duplicate tensor(-1.3573, dtype=torch.float64) tensor(-5.8649, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0454, dtype=torch.float64) delta_t tensor(-0.1481, dtype=torch.float64)
7 gae_duplicate tensor(-0.9610, dtype=torch.float64) tensor(-4.0776, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0736, dtype=torch.float64) delta_t tensor(-0.2358, dtype=torch.float64)
6 gae_duplicate tensor(-1.9046, dtype=torch.float64) tensor(2.2201, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6834, dtype=torch.float64) delta_t tensor(-0.8243, dtype=torch.float64)
5 gae_duplicate tensor(-2.6588, dtype=torch.float64) tensor(10.0371, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1583, dtype=torch.float64) delta_t tensor(-1.3022, dtype=torch.float64)
4 gae_duplicate tensor(-8.1597, dtype=torch.float64) tensor(19.2487, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7556, dtype=torch.float64) delta_t tensor(-0.8972, dtype=torch.float64)
3 gae_duplicate tensor(-6.4098, dtype=torch.float64) tensor(26.7706, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3625, dtype=torch.float64) delta_t tensor(-0.4609, dtype=torch.float64)
2 gae_duplicate tensor(-5.4966, dtype=torch.float64) tensor(29.7669, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3117.407470703125
value loss:530.6580810546875
entropies:210.662353515625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.862199068069458 seconds
19 rew tensor(0.7148, dtype=torch.float64) delta_t tensor(-0.0412, dtype=torch.float64)
19 gae_duplicate tensor(-0.2262, dtype=torch.float64) tensor(0.4107, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6966, dtype=torch.float64) delta_t tensor(0.5671, dtype=torch.float64)
18 gae_duplicate tensor(0.2275, dtype=torch.float64) tensor(-6.3046, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6918, dtype=torch.float64) delta_t tensor(0.5495, dtype=torch.float64)
17 gae_duplicate tensor(0.5451, dtype=torch.float64) tensor(-11.9033, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6326, dtype=torch.float64) delta_t tensor(0.5112, dtype=torch.float64)
16 gae_duplicate tensor(0.4786, dtype=torch.float64) tensor(-17.5749, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5656, dtype=torch.float64) delta_t tensor(0.4254, dtype=torch.float64)
15 gae_duplicate tensor(0.0223, dtype=torch.float64) tensor(-18.0976, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7182, dtype=torch.float64) delta_t tensor(0.6161, dtype=torch.float64)
14 gae_duplicate tensor(0.6113, dtype=torch.float64) tensor(-18.3345, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6835, dtype=torch.float64) delta_t tensor(0.5290, dtype=torch.float64)
13 gae_duplicate tensor(0.9570, dtype=torch.float64) tensor(-24.9706, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2262, dtype=torch.float64) delta_t tensor(0.1144, dtype=torch.float64)
12 gae_duplicate tensor(-0.5704, dtype=torch.float64) tensor(-17.2720, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6865, dtype=torch.float64) delta_t tensor(0.6046, dtype=torch.float64)
11 gae_duplicate tensor(0.4968, dtype=torch.float64) tensor(-20.6711, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5905, dtype=torch.float64) delta_t tensor(0.4712, dtype=torch.float64)
10 gae_duplicate tensor(0.6310, dtype=torch.float64) tensor(-25.5513, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3044, dtype=torch.float64) delta_t tensor(-0.4345, dtype=torch.float64)
9 gae_duplicate tensor(0.3947, dtype=torch.float64) tensor(-13.3757, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5253, dtype=torch.float64) delta_t tensor(-0.6766, dtype=torch.float64)
8 gae_duplicate tensor(-0.8259, dtype=torch.float64) tensor(-1.9174, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5787, dtype=torch.float64) delta_t tensor(-0.6891, dtype=torch.float64)
7 gae_duplicate tensor(-1.3518, dtype=torch.float64) tensor(6.6813, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7450, dtype=torch.float64) delta_t tensor(-0.8810, dtype=torch.float64)
6 gae_duplicate tensor(-2.7918, dtype=torch.float64) tensor(17.6450, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0645, dtype=torch.float64) delta_t tensor(-1.2546, dtype=torch.float64)
5 gae_duplicate tensor(-4.5273, dtype=torch.float64) tensor(22.5908, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7912, dtype=torch.float64) delta_t tensor(-1.8816, dtype=torch.float64)
4 gae_duplicate tensor(-9.4390, dtype=torch.float64) tensor(44.4011, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2007, dtype=torch.float64) delta_t tensor(-0.2726, dtype=torch.float64)
3 gae_duplicate tensor(-7.6289, dtype=torch.float64) tensor(41.9201, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0902, dtype=torch.float64) delta_t tensor(-0.2562, dtype=torch.float64)
2 gae_duplicate tensor(-6.2893, dtype=torch.float64) tensor(39.7919, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:53.114227294921875
value loss:849.9664306640625
entropies:211.32579040527344
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.210983991622925 seconds
19 rew tensor(0.7202, dtype=torch.float64) delta_t tensor(0.0034, dtype=torch.float64)
19 gae_duplicate tensor(-0.1484, dtype=torch.float64) tensor(-0.0570, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7297, dtype=torch.float64) delta_t tensor(0.6383, dtype=torch.float64)
18 gae_duplicate tensor(0.4820, dtype=torch.float64) tensor(-7.7736, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7309, dtype=torch.float64) delta_t tensor(0.6051, dtype=torch.float64)
17 gae_duplicate tensor(0.8608, dtype=torch.float64) tensor(-12.6632, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7237, dtype=torch.float64) delta_t tensor(0.5938, dtype=torch.float64)
16 gae_duplicate tensor(1.2662, dtype=torch.float64) tensor(-19.7136, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7249, dtype=torch.float64) delta_t tensor(0.5617, dtype=torch.float64)
15 gae_duplicate tensor(1.5881, dtype=torch.float64) tensor(-21.3741, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7177, dtype=torch.float64) delta_t tensor(0.6069, dtype=torch.float64)
14 gae_duplicate tensor(1.8088, dtype=torch.float64) tensor(-24.4376, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7105, dtype=torch.float64) delta_t tensor(0.5825, dtype=torch.float64)
13 gae_duplicate tensor(1.9834, dtype=torch.float64) tensor(-23.7775, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6866, dtype=torch.float64) delta_t tensor(0.5028, dtype=torch.float64)
12 gae_duplicate tensor(2.0644, dtype=torch.float64) tensor(-23.2058, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7211, dtype=torch.float64) delta_t tensor(0.6068, dtype=torch.float64)
11 gae_duplicate tensor(2.2283, dtype=torch.float64) tensor(-29.3174, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6116, dtype=torch.float64) delta_t tensor(0.4948, dtype=torch.float64)
10 gae_duplicate tensor(2.1788, dtype=torch.float64) tensor(-25.4916, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4761, dtype=torch.float64) delta_t tensor(-0.5606, dtype=torch.float64)
9 gae_duplicate tensor(-1.9365, dtype=torch.float64) tensor(-17.4652, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0620, dtype=torch.float64) delta_t tensor(-0.1441, dtype=torch.float64)
8 gae_duplicate tensor(-2.3330, dtype=torch.float64) tensor(-8.3442, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2252, dtype=torch.float64) delta_t tensor(-0.3300, dtype=torch.float64)
7 gae_duplicate tensor(-1.9016, dtype=torch.float64) tensor(-4.5537, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4107, dtype=torch.float64) delta_t tensor(-0.5960, dtype=torch.float64)
6 gae_duplicate tensor(-1.5120, dtype=torch.float64) tensor(2.6266, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7983, dtype=torch.float64) delta_t tensor(-0.8567, dtype=torch.float64)
5 gae_duplicate tensor(-2.5456, dtype=torch.float64) tensor(14.2849, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9522, dtype=torch.float64) delta_t tensor(-1.0633, dtype=torch.float64)
4 gae_duplicate tensor(-3.4465, dtype=torch.float64) tensor(23.0683, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7643, dtype=torch.float64) delta_t tensor(-0.8356, dtype=torch.float64)
3 gae_duplicate tensor(-3.4892, dtype=torch.float64) tensor(31.6784, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4618, dtype=torch.float64) delta_t tensor(-0.6761, dtype=torch.float64)
2 gae_duplicate tensor(-3.2011, dtype=torch.float64) tensor(25.0885, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4333.68212890625
value loss:557.0523681640625
entropies:209.575439453125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.092671871185303 seconds
19 rew tensor(0.7179, dtype=torch.float64) delta_t tensor(-0.0082, dtype=torch.float64)
19 gae_duplicate tensor(-0.0933, dtype=torch.float64) tensor(0.1794, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7258, dtype=torch.float64) delta_t tensor(0.5744, dtype=torch.float64)
18 gae_duplicate tensor(0.3874, dtype=torch.float64) tensor(-6.6887, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7201, dtype=torch.float64) delta_t tensor(0.5770, dtype=torch.float64)
17 gae_duplicate tensor(0.8260, dtype=torch.float64) tensor(-13.6517, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7009, dtype=torch.float64) delta_t tensor(0.5716, dtype=torch.float64)
16 gae_duplicate tensor(1.1718, dtype=torch.float64) tensor(-17.3176, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6598, dtype=torch.float64) delta_t tensor(0.5610, dtype=torch.float64)
15 gae_duplicate tensor(1.1937, dtype=torch.float64) tensor(-20.6181, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5998, dtype=torch.float64) delta_t tensor(0.4273, dtype=torch.float64)
14 gae_duplicate tensor(0.6794, dtype=torch.float64) tensor(-19.8987, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7144, dtype=torch.float64) delta_t tensor(0.5789, dtype=torch.float64)
13 gae_duplicate tensor(1.0977, dtype=torch.float64) tensor(-22.0204, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6064, dtype=torch.float64) delta_t tensor(0.4512, dtype=torch.float64)
12 gae_duplicate tensor(1.4002, dtype=torch.float64) tensor(-21.8435, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6683, dtype=torch.float64) delta_t tensor(0.5210, dtype=torch.float64)
11 gae_duplicate tensor(1.4124, dtype=torch.float64) tensor(-29.5465, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4890, dtype=torch.float64) delta_t tensor(0.3629, dtype=torch.float64)
10 gae_duplicate tensor(1.1813, dtype=torch.float64) tensor(-24.9782, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2604, dtype=torch.float64) delta_t tensor(-0.4222, dtype=torch.float64)
9 gae_duplicate tensor(-1.3509, dtype=torch.float64) tensor(-14.9897, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3767, dtype=torch.float64) delta_t tensor(-0.4108, dtype=torch.float64)
8 gae_duplicate tensor(-2.4819, dtype=torch.float64) tensor(-3.6121, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6585, dtype=torch.float64) delta_t tensor(-0.8538, dtype=torch.float64)
7 gae_duplicate tensor(-3.4527, dtype=torch.float64) tensor(4.3406, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3028, dtype=torch.float64) delta_t tensor(-1.3748, dtype=torch.float64)
6 gae_duplicate tensor(-4.4035, dtype=torch.float64) tensor(22.0253, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9482, dtype=torch.float64) delta_t tensor(-1.1571, dtype=torch.float64)
5 gae_duplicate tensor(-6.4932, dtype=torch.float64) tensor(28.1479, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1721, dtype=torch.float64) delta_t tensor(-1.2847, dtype=torch.float64)
4 gae_duplicate tensor(-7.9684, dtype=torch.float64) tensor(39.3492, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7387, dtype=torch.float64) delta_t tensor(-0.7234, dtype=torch.float64)
3 gae_duplicate tensor(-6.4637, dtype=torch.float64) tensor(38.8538, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3293, dtype=torch.float64) delta_t tensor(-0.3708, dtype=torch.float64)
2 gae_duplicate tensor(-5.3504, dtype=torch.float64) tensor(30.3943, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1109.6251220703125
value loss:851.1557006835938
entropies:210.36740112304688
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2466.7180)
ToM Target loss= tensor(1807.2594)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.0139851570129395 seconds
19 rew tensor(0.4801, dtype=torch.float64) delta_t tensor(-0.2040, dtype=torch.float64)
19 gae_duplicate tensor(-1.4458, dtype=torch.float64) tensor(3.3528, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7269, dtype=torch.float64) delta_t tensor(0.5648, dtype=torch.float64)
18 gae_duplicate tensor(-0.5332, dtype=torch.float64) tensor(-4.1742, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7266, dtype=torch.float64) delta_t tensor(0.5608, dtype=torch.float64)
17 gae_duplicate tensor(0.1232, dtype=torch.float64) tensor(-10.3544, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7290, dtype=torch.float64) delta_t tensor(0.5790, dtype=torch.float64)
16 gae_duplicate tensor(0.7190, dtype=torch.float64) tensor(-16.3439, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7291, dtype=torch.float64) delta_t tensor(0.5393, dtype=torch.float64)
15 gae_duplicate tensor(1.1968, dtype=torch.float64) tensor(-17.8544, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7314, dtype=torch.float64) delta_t tensor(0.6009, dtype=torch.float64)
14 gae_duplicate tensor(1.4696, dtype=torch.float64) tensor(-22.2885, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7309, dtype=torch.float64) delta_t tensor(0.6048, dtype=torch.float64)
13 gae_duplicate tensor(1.8201, dtype=torch.float64) tensor(-23.0587, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7402, dtype=torch.float64) delta_t tensor(0.5903, dtype=torch.float64)
12 gae_duplicate tensor(2.0125, dtype=torch.float64) tensor(-22.7953, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2768, dtype=torch.float64) delta_t tensor(0.1737, dtype=torch.float64)
11 gae_duplicate tensor(0.0415, dtype=torch.float64) tensor(-19.8510, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3504, dtype=torch.float64) delta_t tensor(-0.4812, dtype=torch.float64)
10 gae_duplicate tensor(-1.2380, dtype=torch.float64) tensor(-11.0395, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0791, dtype=torch.float64) delta_t tensor(-0.1233, dtype=torch.float64)
9 gae_duplicate tensor(-0.3807, dtype=torch.float64) tensor(-8.7266, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2476, dtype=torch.float64) delta_t tensor(-0.3643, dtype=torch.float64)
8 gae_duplicate tensor(-2.7091, dtype=torch.float64) tensor(-5.7375, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7253, dtype=torch.float64) delta_t tensor(-0.8965, dtype=torch.float64)
7 gae_duplicate tensor(-4.9389, dtype=torch.float64) tensor(7.0073, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4758, dtype=torch.float64) delta_t tensor(-0.5987, dtype=torch.float64)
6 gae_duplicate tensor(-4.0974, dtype=torch.float64) tensor(13.8183, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7644, dtype=torch.float64) delta_t tensor(-0.9256, dtype=torch.float64)
5 gae_duplicate tensor(-3.4313, dtype=torch.float64) tensor(17.6752, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8556, dtype=torch.float64) delta_t tensor(-0.8586, dtype=torch.float64)
4 gae_duplicate tensor(-3.7697, dtype=torch.float64) tensor(26.9779, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2755, dtype=torch.float64) delta_t tensor(-0.4386, dtype=torch.float64)
3 gae_duplicate tensor(-3.3536, dtype=torch.float64) tensor(27.4489, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6571, dtype=torch.float64) delta_t tensor(-0.7511, dtype=torch.float64)
2 gae_duplicate tensor(-3.2362, dtype=torch.float64) tensor(34.3326, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1100.37353515625
value loss:561.7753295898438
entropies:209.0511474609375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.786091089248657 seconds
19 rew tensor(0.7176, dtype=torch.float64) delta_t tensor(-0.1104, dtype=torch.float64)
19 gae_duplicate tensor(-0.2111, dtype=torch.float64) tensor(1.3021, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7119, dtype=torch.float64) delta_t tensor(0.5694, dtype=torch.float64)
18 gae_duplicate tensor(0.2331, dtype=torch.float64) tensor(-5.3674, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6930, dtype=torch.float64) delta_t tensor(0.5597, dtype=torch.float64)
17 gae_duplicate tensor(0.4847, dtype=torch.float64) tensor(-11.2564, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6542, dtype=torch.float64) delta_t tensor(0.5379, dtype=torch.float64)
16 gae_duplicate tensor(0.4594, dtype=torch.float64) tensor(-16.2962, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7081, dtype=torch.float64) delta_t tensor(0.5841, dtype=torch.float64)
15 gae_duplicate tensor(0.7753, dtype=torch.float64) tensor(-16.5263, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6826, dtype=torch.float64) delta_t tensor(0.5130, dtype=torch.float64)
14 gae_duplicate tensor(0.9083, dtype=torch.float64) tensor(-20.2161, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6969, dtype=torch.float64) delta_t tensor(0.5290, dtype=torch.float64)
13 gae_duplicate tensor(0.9713, dtype=torch.float64) tensor(-26.7697, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7177, dtype=torch.float64) delta_t tensor(0.5795, dtype=torch.float64)
12 gae_duplicate tensor(1.1910, dtype=torch.float64) tensor(-25.7922, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6439, dtype=torch.float64) delta_t tensor(0.5474, dtype=torch.float64)
11 gae_duplicate tensor(1.5335, dtype=torch.float64) tensor(-29.5917, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5471, dtype=torch.float64) delta_t tensor(0.3664, dtype=torch.float64)
10 gae_duplicate tensor(1.2300, dtype=torch.float64) tensor(-22.0305, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2116, dtype=torch.float64) delta_t tensor(-0.3449, dtype=torch.float64)
9 gae_duplicate tensor(-2.4056, dtype=torch.float64) tensor(-14.8450, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.8184, dtype=torch.float64) delta_t tensor(-1.8841, dtype=torch.float64)
8 gae_duplicate tensor(-2.6923, dtype=torch.float64) tensor(9.9882, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8009, dtype=torch.float64) delta_t tensor(-0.9235, dtype=torch.float64)
7 gae_duplicate tensor(-4.9463, dtype=torch.float64) tensor(13.8341, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6900, dtype=torch.float64) delta_t tensor(-0.9118, dtype=torch.float64)
6 gae_duplicate tensor(-4.9162, dtype=torch.float64) tensor(28.1134, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9212, dtype=torch.float64) delta_t tensor(-1.0238, dtype=torch.float64)
5 gae_duplicate tensor(-5.5738, dtype=torch.float64) tensor(38.0985, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9549, dtype=torch.float64) delta_t tensor(-1.0588, dtype=torch.float64)
4 gae_duplicate tensor(-8.0313, dtype=torch.float64) tensor(38.7492, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6656, dtype=torch.float64) delta_t tensor(-0.8326, dtype=torch.float64)
3 gae_duplicate tensor(-6.6625, dtype=torch.float64) tensor(39.8258, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4135, dtype=torch.float64) delta_t tensor(-0.5863, dtype=torch.float64)
2 gae_duplicate tensor(-5.8533, dtype=torch.float64) tensor(39.9907, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-800.947509765625
value loss:982.158935546875
entropies:207.60946655273438
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.779760122299194 seconds
19 rew tensor(0.6613, dtype=torch.float64) delta_t tensor(-0.1098, dtype=torch.float64)
19 gae_duplicate tensor(-0.3982, dtype=torch.float64) tensor(1.1420, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6144, dtype=torch.float64) delta_t tensor(0.4429, dtype=torch.float64)
18 gae_duplicate tensor(-0.4496, dtype=torch.float64) tensor(-3.8054, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4905, dtype=torch.float64) delta_t tensor(0.3605, dtype=torch.float64)
17 gae_duplicate tensor(-1.2244, dtype=torch.float64) tensor(-8.6434, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7246, dtype=torch.float64) delta_t tensor(0.5408, dtype=torch.float64)
16 gae_duplicate tensor(-0.4039, dtype=torch.float64) tensor(-13.1746, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6964, dtype=torch.float64) delta_t tensor(0.5410, dtype=torch.float64)
15 gae_duplicate tensor(0.1927, dtype=torch.float64) tensor(-15.8711, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6659, dtype=torch.float64) delta_t tensor(0.4572, dtype=torch.float64)
14 gae_duplicate tensor(0.5987, dtype=torch.float64) tensor(-17.5419, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6363, dtype=torch.float64) delta_t tensor(0.4809, dtype=torch.float64)
13 gae_duplicate tensor(0.9117, dtype=torch.float64) tensor(-19.1746, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7282, dtype=torch.float64) delta_t tensor(0.5529, dtype=torch.float64)
12 gae_duplicate tensor(1.2776, dtype=torch.float64) tensor(-19.0944, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6601, dtype=torch.float64) delta_t tensor(0.5187, dtype=torch.float64)
11 gae_duplicate tensor(1.5824, dtype=torch.float64) tensor(-21.9368, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5698, dtype=torch.float64) delta_t tensor(0.4520, dtype=torch.float64)
10 gae_duplicate tensor(1.7228, dtype=torch.float64) tensor(-20.5102, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6511, dtype=torch.float64) delta_t tensor(-0.8035, dtype=torch.float64)
9 gae_duplicate tensor(-0.9781, dtype=torch.float64) tensor(-8.5341, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9775, dtype=torch.float64) delta_t tensor(-1.1100, dtype=torch.float64)
8 gae_duplicate tensor(-3.3842, dtype=torch.float64) tensor(5.0643, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0473, dtype=torch.float64) delta_t tensor(-1.1533, dtype=torch.float64)
7 gae_duplicate tensor(-4.4922, dtype=torch.float64) tensor(20.1333, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4640, dtype=torch.float64) delta_t tensor(-0.6677, dtype=torch.float64)
6 gae_duplicate tensor(-4.0271, dtype=torch.float64) tensor(17.7241, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8846, dtype=torch.float64) delta_t tensor(-1.0521, dtype=torch.float64)
5 gae_duplicate tensor(-4.1640, dtype=torch.float64) tensor(27.9590, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5924, dtype=torch.float64) delta_t tensor(-2.6844, dtype=torch.float64)
4 gae_duplicate tensor(-9.6736, dtype=torch.float64) tensor(47.6214, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4478, dtype=torch.float64) delta_t tensor(-0.5811, dtype=torch.float64)
3 gae_duplicate tensor(-7.8470, dtype=torch.float64) tensor(54.9398, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2230, dtype=torch.float64) delta_t tensor(-0.3175, dtype=torch.float64)
2 gae_duplicate tensor(-6.1085, dtype=torch.float64) tensor(42.0244, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2496.781494140625
value loss:1122.448974609375
entropies:206.60781860351562
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.037009239196777 seconds
19 rew tensor(0.7308, dtype=torch.float64) delta_t tensor(-0.0838, dtype=torch.float64)
19 gae_duplicate tensor(-0.1843, dtype=torch.float64) tensor(0.9379, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7317, dtype=torch.float64) delta_t tensor(0.5496, dtype=torch.float64)
18 gae_duplicate tensor(0.3604, dtype=torch.float64) tensor(-4.5397, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7327, dtype=torch.float64) delta_t tensor(0.5808, dtype=torch.float64)
17 gae_duplicate tensor(0.7971, dtype=torch.float64) tensor(-10.4073, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7337, dtype=torch.float64) delta_t tensor(0.5239, dtype=torch.float64)
16 gae_duplicate tensor(1.1120, dtype=torch.float64) tensor(-12.1637, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7347, dtype=torch.float64) delta_t tensor(0.5919, dtype=torch.float64)
15 gae_duplicate tensor(1.3871, dtype=torch.float64) tensor(-18.9895, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7357, dtype=torch.float64) delta_t tensor(0.6284, dtype=torch.float64)
14 gae_duplicate tensor(1.6367, dtype=torch.float64) tensor(-22.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7300, dtype=torch.float64) delta_t tensor(0.5758, dtype=torch.float64)
13 gae_duplicate tensor(1.7981, dtype=torch.float64) tensor(-20.5615, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7243, dtype=torch.float64) delta_t tensor(0.5804, dtype=torch.float64)
12 gae_duplicate tensor(1.8484, dtype=torch.float64) tensor(-27.3955, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3395, dtype=torch.float64) delta_t tensor(0.1986, dtype=torch.float64)
11 gae_duplicate tensor(1.1495, dtype=torch.float64) tensor(-29.1985, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4123, dtype=torch.float64) delta_t tensor(0.2418, dtype=torch.float64)
10 gae_duplicate tensor(0.2014, dtype=torch.float64) tensor(-19.4967, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2510, dtype=torch.float64) delta_t tensor(0.2148, dtype=torch.float64)
9 gae_duplicate tensor(0.1001, dtype=torch.float64) tensor(-20.9019, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0735, dtype=torch.float64) delta_t tensor(-0.0643, dtype=torch.float64)
8 gae_duplicate tensor(0.4926, dtype=torch.float64) tensor(-14.1950, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0960, dtype=torch.float64) delta_t tensor(-0.1018, dtype=torch.float64)
7 gae_duplicate tensor(0.0187, dtype=torch.float64) tensor(-11.8481, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6793, dtype=torch.float64) delta_t tensor(-0.7728, dtype=torch.float64)
6 gae_duplicate tensor(-1.0712, dtype=torch.float64) tensor(-0.4601, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6844, dtype=torch.float64) delta_t tensor(-0.8055, dtype=torch.float64)
5 gae_duplicate tensor(-2.0834, dtype=torch.float64) tensor(7.0272, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5409, dtype=torch.float64) delta_t tensor(-1.6642, dtype=torch.float64)
4 gae_duplicate tensor(-6.1970, dtype=torch.float64) tensor(34.2140, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8373, dtype=torch.float64) delta_t tensor(-1.0164, dtype=torch.float64)
3 gae_duplicate tensor(-5.1905, dtype=torch.float64) tensor(37.1742, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2757, dtype=torch.float64) delta_t tensor(-0.4294, dtype=torch.float64)
2 gae_duplicate tensor(-4.4985, dtype=torch.float64) tensor(35.3815, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3501.70947265625
value loss:564.5939331054688
entropies:203.54696655273438
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.911375045776367 seconds
19 rew tensor(0.6049, dtype=torch.float64) delta_t tensor(-0.2988, dtype=torch.float64)
19 gae_duplicate tensor(-0.7883, dtype=torch.float64) tensor(3.4216, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4837, dtype=torch.float64) delta_t tensor(0.3381, dtype=torch.float64)
18 gae_duplicate tensor(-1.4550, dtype=torch.float64) tensor(0.4316, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6905, dtype=torch.float64) delta_t tensor(0.5339, dtype=torch.float64)
17 gae_duplicate tensor(-0.6001, dtype=torch.float64) tensor(-7.8327, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6760, dtype=torch.float64) delta_t tensor(0.5243, dtype=torch.float64)
16 gae_duplicate tensor(0.0848, dtype=torch.float64) tensor(-11.1698, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6085, dtype=torch.float64) delta_t tensor(0.4781, dtype=torch.float64)
15 gae_duplicate tensor(0.6336, dtype=torch.float64) tensor(-13.6580, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5046, dtype=torch.float64) delta_t tensor(0.3218, dtype=torch.float64)
14 gae_duplicate tensor(-0.0057, dtype=torch.float64) tensor(-16.5299, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6636, dtype=torch.float64) delta_t tensor(0.4727, dtype=torch.float64)
13 gae_duplicate tensor(0.6207, dtype=torch.float64) tensor(-17.8001, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7173, dtype=torch.float64) delta_t tensor(0.5422, dtype=torch.float64)
12 gae_duplicate tensor(1.0887, dtype=torch.float64) tensor(-23.6770, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7326, dtype=torch.float64) delta_t tensor(0.5661, dtype=torch.float64)
11 gae_duplicate tensor(1.4836, dtype=torch.float64) tensor(-19.7792, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6694, dtype=torch.float64) delta_t tensor(0.4890, dtype=torch.float64)
10 gae_duplicate tensor(1.7483, dtype=torch.float64) tensor(-24.0688, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3250, dtype=torch.float64) delta_t tensor(0.2378, dtype=torch.float64)
9 gae_duplicate tensor(0.3135, dtype=torch.float64) tensor(-18.4305, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5806, dtype=torch.float64) delta_t tensor(-0.7837, dtype=torch.float64)
8 gae_duplicate tensor(-1.0194, dtype=torch.float64) tensor(-7.2155, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0119, dtype=torch.float64) delta_t tensor(-1.1263, dtype=torch.float64)
7 gae_duplicate tensor(-2.2170, dtype=torch.float64) tensor(4.4659, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4896, dtype=torch.float64) delta_t tensor(-1.5678, dtype=torch.float64)
6 gae_duplicate tensor(-4.9020, dtype=torch.float64) tensor(19.6489, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4771, dtype=torch.float64) delta_t tensor(-1.5901, dtype=torch.float64)
5 gae_duplicate tensor(-5.5374, dtype=torch.float64) tensor(33.2641, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4139, dtype=torch.float64) delta_t tensor(-3.4488, dtype=torch.float64)
4 gae_duplicate tensor(-9.1670, dtype=torch.float64) tensor(72.8413, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1388, dtype=torch.float64) delta_t tensor(-0.2585, dtype=torch.float64)
3 gae_duplicate tensor(-7.5225, dtype=torch.float64) tensor(50.0946, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3187, dtype=torch.float64) delta_t tensor(-0.4046, dtype=torch.float64)
2 gae_duplicate tensor(-6.4761, dtype=torch.float64) tensor(44.1168, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2489.062744140625
value loss:1391.976318359375
entropies:203.48904418945312
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2461.8367)
ToM Target loss= tensor(1809.5283)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.450600862503052 seconds
19 rew tensor(0.6989, dtype=torch.float64) delta_t tensor(-0.2080, dtype=torch.float64)
19 gae_duplicate tensor(-0.3429, dtype=torch.float64) tensor(1.8099, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6485, dtype=torch.float64) delta_t tensor(0.4799, dtype=torch.float64)
18 gae_duplicate tensor(-0.0031, dtype=torch.float64) tensor(-3.4493, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5615, dtype=torch.float64) delta_t tensor(0.4173, dtype=torch.float64)
17 gae_duplicate tensor(0.0451, dtype=torch.float64) tensor(-7.7968, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4291, dtype=torch.float64) delta_t tensor(0.2672, dtype=torch.float64)
16 gae_duplicate tensor(-0.4896, dtype=torch.float64) tensor(-8.1279, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5169, dtype=torch.float64) delta_t tensor(0.3825, dtype=torch.float64)
15 gae_duplicate tensor(0.0429, dtype=torch.float64) tensor(-11.9422, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6367, dtype=torch.float64) delta_t tensor(0.4716, dtype=torch.float64)
14 gae_duplicate tensor(0.5753, dtype=torch.float64) tensor(-12.1622, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7324, dtype=torch.float64) delta_t tensor(0.6485, dtype=torch.float64)
13 gae_duplicate tensor(1.0335, dtype=torch.float64) tensor(-17.6150, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5831, dtype=torch.float64) delta_t tensor(0.3612, dtype=torch.float64)
12 gae_duplicate tensor(0.7298, dtype=torch.float64) tensor(-18.0151, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4491, dtype=torch.float64) delta_t tensor(0.3439, dtype=torch.float64)
11 gae_duplicate tensor(-0.5745, dtype=torch.float64) tensor(-19.1067, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3521, dtype=torch.float64) delta_t tensor(0.2193, dtype=torch.float64)
10 gae_duplicate tensor(-0.8723, dtype=torch.float64) tensor(-16.3961, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6758, dtype=torch.float64) delta_t tensor(-0.7447, dtype=torch.float64)
9 gae_duplicate tensor(-0.4521, dtype=torch.float64) tensor(-9.9285, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2361, dtype=torch.float64) delta_t tensor(-0.4196, dtype=torch.float64)
8 gae_duplicate tensor(-0.9845, dtype=torch.float64) tensor(-0.2534, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4791, dtype=torch.float64) delta_t tensor(-0.6238, dtype=torch.float64)
7 gae_duplicate tensor(-3.0189, dtype=torch.float64) tensor(4.2735, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7661, dtype=torch.float64) delta_t tensor(-0.9599, dtype=torch.float64)
6 gae_duplicate tensor(-4.1377, dtype=torch.float64) tensor(11.6635, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8478, dtype=torch.float64) delta_t tensor(-0.9445, dtype=torch.float64)
5 gae_duplicate tensor(-3.5076, dtype=torch.float64) tensor(20.6238, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8267, dtype=torch.float64) delta_t tensor(-1.8953, dtype=torch.float64)
4 gae_duplicate tensor(-7.5414, dtype=torch.float64) tensor(34.8687, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4236, dtype=torch.float64) delta_t tensor(-0.4926, dtype=torch.float64)
3 gae_duplicate tensor(-6.3558, dtype=torch.float64) tensor(37.9425, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2722, dtype=torch.float64) delta_t tensor(-0.4598, dtype=torch.float64)
2 gae_duplicate tensor(-5.6533, dtype=torch.float64) tensor(38.8935, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-946.1183471679688
value loss:708.9545288085938
entropies:199.773193359375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.513596296310425 seconds
19 rew tensor(0.6835, dtype=torch.float64) delta_t tensor(-0.2528, dtype=torch.float64)
19 gae_duplicate tensor(-0.6169, dtype=torch.float64) tensor(2.4521, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6296, dtype=torch.float64) delta_t tensor(0.4849, dtype=torch.float64)
18 gae_duplicate tensor(-0.2434, dtype=torch.float64) tensor(-3.4581, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5349, dtype=torch.float64) delta_t tensor(0.4219, dtype=torch.float64)
17 gae_duplicate tensor(-0.2512, dtype=torch.float64) tensor(-9.2133, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3584, dtype=torch.float64) delta_t tensor(0.2012, dtype=torch.float64)
16 gae_duplicate tensor(-0.7146, dtype=torch.float64) tensor(-7.8247, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7335, dtype=torch.float64) delta_t tensor(0.5986, dtype=torch.float64)
15 gae_duplicate tensor(-0.0136, dtype=torch.float64) tensor(-17.2545, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7344, dtype=torch.float64) delta_t tensor(0.5609, dtype=torch.float64)
14 gae_duplicate tensor(0.5480, dtype=torch.float64) tensor(-17.5750, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7353, dtype=torch.float64) delta_t tensor(0.5923, dtype=torch.float64)
13 gae_duplicate tensor(0.9981, dtype=torch.float64) tensor(-22.5507, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6915, dtype=torch.float64) delta_t tensor(0.4957, dtype=torch.float64)
12 gae_duplicate tensor(1.3590, dtype=torch.float64) tensor(-17.8206, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3966, dtype=torch.float64) delta_t tensor(0.1948, dtype=torch.float64)
11 gae_duplicate tensor(-0.0909, dtype=torch.float64) tensor(-17.0439, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3331, dtype=torch.float64) delta_t tensor(-0.4203, dtype=torch.float64)
10 gae_duplicate tensor(-2.0441, dtype=torch.float64) tensor(-4.6571, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2621, dtype=torch.float64) delta_t tensor(0.1792, dtype=torch.float64)
9 gae_duplicate tensor(-2.2123, dtype=torch.float64) tensor(-6.0388, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2153, dtype=torch.float64) delta_t tensor(0.1512, dtype=torch.float64)
8 gae_duplicate tensor(-1.4072, dtype=torch.float64) tensor(-12.4597, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4423, dtype=torch.float64) delta_t tensor(-0.6793, dtype=torch.float64)
7 gae_duplicate tensor(-1.1928, dtype=torch.float64) tensor(-0.9225, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6848, dtype=torch.float64) delta_t tensor(-0.7556, dtype=torch.float64)
6 gae_duplicate tensor(-2.1556, dtype=torch.float64) tensor(8.0491, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4381, dtype=torch.float64) delta_t tensor(-0.5953, dtype=torch.float64)
5 gae_duplicate tensor(-3.4976, dtype=torch.float64) tensor(9.8527, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3765, dtype=torch.float64) delta_t tensor(-0.5682, dtype=torch.float64)
4 gae_duplicate tensor(-3.5971, dtype=torch.float64) tensor(24.4093, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4379, dtype=torch.float64) delta_t tensor(-0.4395, dtype=torch.float64)
3 gae_duplicate tensor(-3.1767, dtype=torch.float64) tensor(23.3608, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5086, dtype=torch.float64) delta_t tensor(-0.5763, dtype=torch.float64)
2 gae_duplicate tensor(-3.0096, dtype=torch.float64) tensor(18.2220, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1781.3011474609375
value loss:385.5372009277344
entropies:198.46392822265625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.853945016860962 seconds
19 rew tensor(0.5685, dtype=torch.float64) delta_t tensor(-0.3541, dtype=torch.float64)
19 gae_duplicate tensor(-1.0676, dtype=torch.float64) tensor(5.0778, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4145, dtype=torch.float64) delta_t tensor(0.2653, dtype=torch.float64)
18 gae_duplicate tensor(-1.8957, dtype=torch.float64) tensor(0.2360, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6936, dtype=torch.float64) delta_t tensor(0.5497, dtype=torch.float64)
17 gae_duplicate tensor(-0.8982, dtype=torch.float64) tensor(-3.9249, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6470, dtype=torch.float64) delta_t tensor(0.5306, dtype=torch.float64)
16 gae_duplicate tensor(-0.0993, dtype=torch.float64) tensor(-11.7672, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5454, dtype=torch.float64) delta_t tensor(0.4040, dtype=torch.float64)
15 gae_duplicate tensor(-0.0071, dtype=torch.float64) tensor(-14.9418, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6665, dtype=torch.float64) delta_t tensor(0.4784, dtype=torch.float64)
14 gae_duplicate tensor(0.5694, dtype=torch.float64) tensor(-15.8337, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6254, dtype=torch.float64) delta_t tensor(0.4912, dtype=torch.float64)
13 gae_duplicate tensor(1.0314, dtype=torch.float64) tensor(-22.5151, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6043, dtype=torch.float64) delta_t tensor(0.4111, dtype=torch.float64)
12 gae_duplicate tensor(0.6589, dtype=torch.float64) tensor(-19.8798, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5714, dtype=torch.float64) delta_t tensor(0.3713, dtype=torch.float64)
11 gae_duplicate tensor(-0.0797, dtype=torch.float64) tensor(-20.9954, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5206, dtype=torch.float64) delta_t tensor(0.3519, dtype=torch.float64)
10 gae_duplicate tensor(-0.6744, dtype=torch.float64) tensor(-28.9195, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2727, dtype=torch.float64) delta_t tensor(0.2244, dtype=torch.float64)
9 gae_duplicate tensor(-0.0566, dtype=torch.float64) tensor(-15.6160, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0726, dtype=torch.float64) delta_t tensor(-0.1398, dtype=torch.float64)
8 gae_duplicate tensor(-0.8000, dtype=torch.float64) tensor(-12.8792, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2349, dtype=torch.float64) delta_t tensor(-0.3756, dtype=torch.float64)
7 gae_duplicate tensor(-1.8657, dtype=torch.float64) tensor(-4.4074, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4989, dtype=torch.float64) delta_t tensor(-0.7090, dtype=torch.float64)
6 gae_duplicate tensor(-3.0297, dtype=torch.float64) tensor(-0.5315, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9271, dtype=torch.float64) delta_t tensor(-1.1118, dtype=torch.float64)
5 gae_duplicate tensor(-3.9380, dtype=torch.float64) tensor(15.9220, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9004, dtype=torch.float64) delta_t tensor(-0.9238, dtype=torch.float64)
4 gae_duplicate tensor(-4.4636, dtype=torch.float64) tensor(21.5491, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1163, dtype=torch.float64) delta_t tensor(0.1291, dtype=torch.float64)
3 gae_duplicate tensor(-3.1699, dtype=torch.float64) tensor(18.4696, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6608, dtype=torch.float64) delta_t tensor(-0.8578, dtype=torch.float64)
2 gae_duplicate tensor(-3.0098, dtype=torch.float64) tensor(19.6671, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3251.037353515625
value loss:432.5984802246094
entropies:196.6842803955078
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.6220221519470215 seconds
19 rew tensor(0.4967, dtype=torch.float64) delta_t tensor(-0.3459, dtype=torch.float64)
19 gae_duplicate tensor(-1.2955, dtype=torch.float64) tensor(2.8652, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6883, dtype=torch.float64) delta_t tensor(0.5361, dtype=torch.float64)
18 gae_duplicate tensor(-0.4287, dtype=torch.float64) tensor(-2.7973, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7207, dtype=torch.float64) delta_t tensor(0.5371, dtype=torch.float64)
17 gae_duplicate tensor(0.2657, dtype=torch.float64) tensor(-6.9948, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7136, dtype=torch.float64) delta_t tensor(0.5825, dtype=torch.float64)
16 gae_duplicate tensor(0.8220, dtype=torch.float64) tensor(-12.3281, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6748, dtype=torch.float64) delta_t tensor(0.4534, dtype=torch.float64)
15 gae_duplicate tensor(1.0794, dtype=torch.float64) tensor(-12.0775, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6202, dtype=torch.float64) delta_t tensor(0.3977, dtype=torch.float64)
14 gae_duplicate tensor(0.7655, dtype=torch.float64) tensor(-13.9419, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6840, dtype=torch.float64) delta_t tensor(0.5271, dtype=torch.float64)
13 gae_duplicate tensor(1.1402, dtype=torch.float64) tensor(-22.0304, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6299, dtype=torch.float64) delta_t tensor(0.4461, dtype=torch.float64)
12 gae_duplicate tensor(1.3691, dtype=torch.float64) tensor(-26.1578, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3831, dtype=torch.float64) delta_t tensor(-0.4649, dtype=torch.float64)
11 gae_duplicate tensor(-0.7348, dtype=torch.float64) tensor(-12.7619, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1277, dtype=torch.float64) delta_t tensor(-0.0690, dtype=torch.float64)
10 gae_duplicate tensor(-1.7966, dtype=torch.float64) tensor(-6.0332, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4088, dtype=torch.float64) delta_t tensor(0.2117, dtype=torch.float64)
9 gae_duplicate tensor(-1.0762, dtype=torch.float64) tensor(-7.9823, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2973, dtype=torch.float64) delta_t tensor(-0.3344, dtype=torch.float64)
8 gae_duplicate tensor(-0.8155, dtype=torch.float64) tensor(-2.2418, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5900, dtype=torch.float64) delta_t tensor(-0.7585, dtype=torch.float64)
7 gae_duplicate tensor(-2.0407, dtype=torch.float64) tensor(6.3645, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0144, dtype=torch.float64) delta_t tensor(-1.0562, dtype=torch.float64)
6 gae_duplicate tensor(-3.2922, dtype=torch.float64) tensor(16.5344, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4161, dtype=torch.float64) delta_t tensor(-0.6688, dtype=torch.float64)
5 gae_duplicate tensor(-4.7903, dtype=torch.float64) tensor(15.0298, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2888, dtype=torch.float64) delta_t tensor(-0.2323, dtype=torch.float64)
4 gae_duplicate tensor(-3.6163, dtype=torch.float64) tensor(26.2167, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3853, dtype=torch.float64) delta_t tensor(-0.4823, dtype=torch.float64)
3 gae_duplicate tensor(-2.6714, dtype=torch.float64) tensor(19.9269, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2441, dtype=torch.float64) delta_t tensor(-0.4479, dtype=torch.float64)
2 gae_duplicate tensor(-2.5125, dtype=torch.float64) tensor(24.1929, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:476.65142822265625
value loss:387.8585510253906
entropies:195.28097534179688
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.4107630252838135 seconds
19 rew tensor(0.7156, dtype=torch.float64) delta_t tensor(-0.2076, dtype=torch.float64)
19 gae_duplicate tensor(-0.3566, dtype=torch.float64) tensor(2.9456, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6932, dtype=torch.float64) delta_t tensor(0.4713, dtype=torch.float64)
18 gae_duplicate tensor(0.1246, dtype=torch.float64) tensor(-3.1416, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6423, dtype=torch.float64) delta_t tensor(0.4442, dtype=torch.float64)
17 gae_duplicate tensor(0.3588, dtype=torch.float64) tensor(-9.1029, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5673, dtype=torch.float64) delta_t tensor(0.4323, dtype=torch.float64)
16 gae_duplicate tensor(0.4870, dtype=torch.float64) tensor(-12.1556, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4176, dtype=torch.float64) delta_t tensor(0.2648, dtype=torch.float64)
15 gae_duplicate tensor(-0.1344, dtype=torch.float64) tensor(-8.4735, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7118, dtype=torch.float64) delta_t tensor(0.5330, dtype=torch.float64)
14 gae_duplicate tensor(0.4820, dtype=torch.float64) tensor(-12.0960, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6842, dtype=torch.float64) delta_t tensor(0.5128, dtype=torch.float64)
13 gae_duplicate tensor(0.9759, dtype=torch.float64) tensor(-13.2728, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7417, dtype=torch.float64) delta_t tensor(0.5176, dtype=torch.float64)
12 gae_duplicate tensor(1.3720, dtype=torch.float64) tensor(-19.0797, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4520, dtype=torch.float64) delta_t tensor(0.2841, dtype=torch.float64)
11 gae_duplicate tensor(0.2876, dtype=torch.float64) tensor(-17.1717, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1722, dtype=torch.float64) delta_t tensor(0.0893, dtype=torch.float64)
10 gae_duplicate tensor(-1.0340, dtype=torch.float64) tensor(-10.6136, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3558, dtype=torch.float64) delta_t tensor(0.2804, dtype=torch.float64)
9 gae_duplicate tensor(-0.4507, dtype=torch.float64) tensor(-10.6051, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0361, dtype=torch.float64) delta_t tensor(-0.1002, dtype=torch.float64)
8 gae_duplicate tensor(-0.2777, dtype=torch.float64) tensor(-8.3968, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3236, dtype=torch.float64) delta_t tensor(-0.4014, dtype=torch.float64)
7 gae_duplicate tensor(-0.4723, dtype=torch.float64) tensor(-4.7738, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1918, dtype=torch.float64) delta_t tensor(-0.4610, dtype=torch.float64)
6 gae_duplicate tensor(-0.4519, dtype=torch.float64) tensor(0.8742, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2058, dtype=torch.float64) delta_t tensor(-1.1777, dtype=torch.float64)
5 gae_duplicate tensor(-1.7746, dtype=torch.float64) tensor(11.2591, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0412, dtype=torch.float64) delta_t tensor(-0.1509, dtype=torch.float64)
4 gae_duplicate tensor(-2.1557, dtype=torch.float64) tensor(14.6594, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1104, dtype=torch.float64) delta_t tensor(-1.3357, dtype=torch.float64)
3 gae_duplicate tensor(-3.2178, dtype=torch.float64) tensor(19.5215, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1520, dtype=torch.float64) delta_t tensor(-0.2816, dtype=torch.float64)
2 gae_duplicate tensor(-2.9271, dtype=torch.float64) tensor(23.1020, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2000.083984375
value loss:341.8475036621094
entropies:192.66697692871094
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2447.8271)
ToM Target loss= tensor(1812.5063)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.786401987075806 seconds
19 rew tensor(0.7381, dtype=torch.float64) delta_t tensor(-0.2234, dtype=torch.float64)
19 gae_duplicate tensor(-0.3317, dtype=torch.float64) tensor(2.0024, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7389, dtype=torch.float64) delta_t tensor(0.6119, dtype=torch.float64)
18 gae_duplicate tensor(0.1675, dtype=torch.float64) tensor(-5.6319, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7397, dtype=torch.float64) delta_t tensor(0.5604, dtype=torch.float64)
17 gae_duplicate tensor(0.6433, dtype=torch.float64) tensor(-9.2345, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7405, dtype=torch.float64) delta_t tensor(0.5673, dtype=torch.float64)
16 gae_duplicate tensor(1.0612, dtype=torch.float64) tensor(-10.9896, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7334, dtype=torch.float64) delta_t tensor(0.5820, dtype=torch.float64)
15 gae_duplicate tensor(1.4336, dtype=torch.float64) tensor(-20.8116, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7342, dtype=torch.float64) delta_t tensor(0.5142, dtype=torch.float64)
14 gae_duplicate tensor(1.6449, dtype=torch.float64) tensor(-16.8258, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7350, dtype=torch.float64) delta_t tensor(0.5026, dtype=torch.float64)
13 gae_duplicate tensor(1.7210, dtype=torch.float64) tensor(-15.6829, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7358, dtype=torch.float64) delta_t tensor(0.6013, dtype=torch.float64)
12 gae_duplicate tensor(2.0242, dtype=torch.float64) tensor(-19.9468, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5933, dtype=torch.float64) delta_t tensor(0.4325, dtype=torch.float64)
11 gae_duplicate tensor(1.3981, dtype=torch.float64) tensor(-17.7968, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7071, dtype=torch.float64) delta_t tensor(0.4862, dtype=torch.float64)
10 gae_duplicate tensor(1.3704, dtype=torch.float64) tensor(-21.1774, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2135, dtype=torch.float64) delta_t tensor(0.2104, dtype=torch.float64)
9 gae_duplicate tensor(0.1510, dtype=torch.float64) tensor(-21.3506, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2301, dtype=torch.float64) delta_t tensor(-0.4294, dtype=torch.float64)
8 gae_duplicate tensor(-1.4904, dtype=torch.float64) tensor(-15.1498, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4097, dtype=torch.float64) delta_t tensor(-0.6020, dtype=torch.float64)
7 gae_duplicate tensor(-1.9070, dtype=torch.float64) tensor(-1.7882, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9082, dtype=torch.float64) delta_t tensor(-0.9315, dtype=torch.float64)
6 gae_duplicate tensor(-3.5489, dtype=torch.float64) tensor(2.2065, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7840, dtype=torch.float64) delta_t tensor(-1.0462, dtype=torch.float64)
5 gae_duplicate tensor(-5.1770, dtype=torch.float64) tensor(15.3713, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9962, dtype=torch.float64) delta_t tensor(-0.9629, dtype=torch.float64)
4 gae_duplicate tensor(-4.9661, dtype=torch.float64) tensor(27.7579, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5478, dtype=torch.float64) delta_t tensor(-0.6922, dtype=torch.float64)
3 gae_duplicate tensor(-4.1932, dtype=torch.float64) tensor(25.1335, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4952, dtype=torch.float64) delta_t tensor(-0.7509, dtype=torch.float64)
2 gae_duplicate tensor(-3.9670, dtype=torch.float64) tensor(29.2423, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2653.703369140625
value loss:645.8275146484375
entropies:191.587890625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.084731817245483 seconds
19 rew tensor(0.6407, dtype=torch.float64) delta_t tensor(-0.2874, dtype=torch.float64)
19 gae_duplicate tensor(-0.7405, dtype=torch.float64) tensor(2.3731, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7220, dtype=torch.float64) delta_t tensor(0.5459, dtype=torch.float64)
18 gae_duplicate tensor(-0.0532, dtype=torch.float64) tensor(-3.1277, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7068, dtype=torch.float64) delta_t tensor(0.4774, dtype=torch.float64)
17 gae_duplicate tensor(0.4064, dtype=torch.float64) tensor(-6.5042, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7002, dtype=torch.float64) delta_t tensor(0.5192, dtype=torch.float64)
16 gae_duplicate tensor(0.6993, dtype=torch.float64) tensor(-10.2569, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6608, dtype=torch.float64) delta_t tensor(0.4513, dtype=torch.float64)
15 gae_duplicate tensor(0.7783, dtype=torch.float64) tensor(-10.0735, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5749, dtype=torch.float64) delta_t tensor(0.3752, dtype=torch.float64)
14 gae_duplicate tensor(0.5150, dtype=torch.float64) tensor(-13.2543, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6421, dtype=torch.float64) delta_t tensor(0.4492, dtype=torch.float64)
13 gae_duplicate tensor(0.9901, dtype=torch.float64) tensor(-16.4347, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6544, dtype=torch.float64) delta_t tensor(0.4526, dtype=torch.float64)
12 gae_duplicate tensor(1.3807, dtype=torch.float64) tensor(-15.1381, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7345, dtype=torch.float64) delta_t tensor(0.6279, dtype=torch.float64)
11 gae_duplicate tensor(1.6941, dtype=torch.float64) tensor(-25.1012, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6657, dtype=torch.float64) delta_t tensor(0.4833, dtype=torch.float64)
10 gae_duplicate tensor(1.8961, dtype=torch.float64) tensor(-27.4318, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7658, dtype=torch.float64) delta_t tensor(-0.9561, dtype=torch.float64)
9 gae_duplicate tensor(-0.6232, dtype=torch.float64) tensor(-6.5229, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0493, dtype=torch.float64) delta_t tensor(-1.2081, dtype=torch.float64)
8 gae_duplicate tensor(-3.9067, dtype=torch.float64) tensor(17.8064, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3597, dtype=torch.float64) delta_t tensor(-0.3863, dtype=torch.float64)
7 gae_duplicate tensor(-3.1613, dtype=torch.float64) tensor(17.1404, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0840, dtype=torch.float64) delta_t tensor(-1.2744, dtype=torch.float64)
6 gae_duplicate tensor(-4.2710, dtype=torch.float64) tensor(24.4140, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7843, dtype=torch.float64) delta_t tensor(-1.8243, dtype=torch.float64)
5 gae_duplicate tensor(-5.2502, dtype=torch.float64) tensor(26.1629, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8705, dtype=torch.float64) delta_t tensor(-2.0136, dtype=torch.float64)
4 gae_duplicate tensor(-9.7256, dtype=torch.float64) tensor(39.1346, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6455, dtype=torch.float64) delta_t tensor(-0.7592, dtype=torch.float64)
3 gae_duplicate tensor(-7.9833, dtype=torch.float64) tensor(64.0598, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4690, dtype=torch.float64) delta_t tensor(-0.6900, dtype=torch.float64)
2 gae_duplicate tensor(-6.8969, dtype=torch.float64) tensor(44.6846, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3703.72021484375
value loss:1200.4571533203125
entropies:190.1353302001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.797442197799683 seconds
19 rew tensor(0.6980, dtype=torch.float64) delta_t tensor(-0.3168, dtype=torch.float64)
19 gae_duplicate tensor(-0.5662, dtype=torch.float64) tensor(2.1166, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6635, dtype=torch.float64) delta_t tensor(0.4803, dtype=torch.float64)
18 gae_duplicate tensor(-0.1942, dtype=torch.float64) tensor(-2.5464, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5716, dtype=torch.float64) delta_t tensor(0.3664, dtype=torch.float64)
17 gae_duplicate tensor(-0.2046, dtype=torch.float64) tensor(-5.8866, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4177, dtype=torch.float64) delta_t tensor(0.2676, dtype=torch.float64)
16 gae_duplicate tensor(-0.8295, dtype=torch.float64) tensor(-9.9475, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5272, dtype=torch.float64) delta_t tensor(0.3592, dtype=torch.float64)
15 gae_duplicate tensor(-0.5104, dtype=torch.float64) tensor(-9.7932, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7288, dtype=torch.float64) delta_t tensor(0.5575, dtype=torch.float64)
14 gae_duplicate tensor(0.1130, dtype=torch.float64) tensor(-14.0485, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7365, dtype=torch.float64) delta_t tensor(0.5645, dtype=torch.float64)
13 gae_duplicate tensor(0.6124, dtype=torch.float64) tensor(-13.1465, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7163, dtype=torch.float64) delta_t tensor(0.5369, dtype=torch.float64)
12 gae_duplicate tensor(1.1098, dtype=torch.float64) tensor(-22.0166, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7237, dtype=torch.float64) delta_t tensor(0.5313, dtype=torch.float64)
11 gae_duplicate tensor(1.3240, dtype=torch.float64) tensor(-20.1744, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3655, dtype=torch.float64) delta_t tensor(0.2146, dtype=torch.float64)
10 gae_duplicate tensor(1.1645, dtype=torch.float64) tensor(-18.8823, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5805, dtype=torch.float64) delta_t tensor(-0.7414, dtype=torch.float64)
9 gae_duplicate tensor(-0.9559, dtype=torch.float64) tensor(-9.4860, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6952, dtype=torch.float64) delta_t tensor(-0.8907, dtype=torch.float64)
8 gae_duplicate tensor(-1.4145, dtype=torch.float64) tensor(2.0371, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9585, dtype=torch.float64) delta_t tensor(-1.0830, dtype=torch.float64)
7 gae_duplicate tensor(-3.6666, dtype=torch.float64) tensor(11.3186, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0486, dtype=torch.float64) delta_t tensor(-1.0693, dtype=torch.float64)
6 gae_duplicate tensor(-4.6712, dtype=torch.float64) tensor(19.2088, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4525, dtype=torch.float64) delta_t tensor(-1.6321, dtype=torch.float64)
5 gae_duplicate tensor(-7.5225, dtype=torch.float64) tensor(39.7067, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5232, dtype=torch.float64) delta_t tensor(-1.5277, dtype=torch.float64)
4 gae_duplicate tensor(-7.8603, dtype=torch.float64) tensor(57.3024, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4751, dtype=torch.float64) delta_t tensor(-0.6598, dtype=torch.float64)
3 gae_duplicate tensor(-6.3162, dtype=torch.float64) tensor(58.7098, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2036, dtype=torch.float64) delta_t tensor(-0.3246, dtype=torch.float64)
2 gae_duplicate tensor(-5.2659, dtype=torch.float64) tensor(41.8769, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3862.296630859375
value loss:976.92041015625
entropies:187.45542907714844
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.7515411376953125 seconds
19 rew tensor(0.7393, dtype=torch.float64) delta_t tensor(-0.3767, dtype=torch.float64)
19 gae_duplicate tensor(-0.5197, dtype=torch.float64) tensor(3.5357, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7400, dtype=torch.float64) delta_t tensor(0.5400, dtype=torch.float64)
18 gae_duplicate tensor(0.0737, dtype=torch.float64) tensor(-2.5375, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7337, dtype=torch.float64) delta_t tensor(0.5473, dtype=torch.float64)
17 gae_duplicate tensor(0.6482, dtype=torch.float64) tensor(-7.0351, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7203, dtype=torch.float64) delta_t tensor(0.5556, dtype=torch.float64)
16 gae_duplicate tensor(0.8930, dtype=torch.float64) tensor(-12.5665, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7069, dtype=torch.float64) delta_t tensor(0.6002, dtype=torch.float64)
15 gae_duplicate tensor(0.9792, dtype=torch.float64) tensor(-12.1379, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6935, dtype=torch.float64) delta_t tensor(0.5792, dtype=torch.float64)
14 gae_duplicate tensor(0.9678, dtype=torch.float64) tensor(-20.0393, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7143, dtype=torch.float64) delta_t tensor(0.5437, dtype=torch.float64)
13 gae_duplicate tensor(1.1649, dtype=torch.float64) tensor(-15.4700, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2587, dtype=torch.float64) delta_t tensor(0.0736, dtype=torch.float64)
12 gae_duplicate tensor(-0.4268, dtype=torch.float64) tensor(-16.2869, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7073, dtype=torch.float64) delta_t tensor(0.5588, dtype=torch.float64)
11 gae_duplicate tensor(0.1648, dtype=torch.float64) tensor(-22.9210, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6484, dtype=torch.float64) delta_t tensor(0.4882, dtype=torch.float64)
10 gae_duplicate tensor(0.5058, dtype=torch.float64) tensor(-22.2141, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1908, dtype=torch.float64) delta_t tensor(0.0197, dtype=torch.float64)
9 gae_duplicate tensor(-0.0918, dtype=torch.float64) tensor(-21.8716, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6411, dtype=torch.float64) delta_t tensor(-0.8552, dtype=torch.float64)
8 gae_duplicate tensor(-1.6454, dtype=torch.float64) tensor(-0.1635, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5891, dtype=torch.float64) delta_t tensor(-0.6491, dtype=torch.float64)
7 gae_duplicate tensor(-1.3127, dtype=torch.float64) tensor(1.0612, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6111, dtype=torch.float64) delta_t tensor(-0.6886, dtype=torch.float64)
6 gae_duplicate tensor(-4.1046, dtype=torch.float64) tensor(6.1759, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1171, dtype=torch.float64) delta_t tensor(-1.2031, dtype=torch.float64)
5 gae_duplicate tensor(-3.8328, dtype=torch.float64) tensor(20.2584, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8165, dtype=torch.float64) delta_t tensor(-1.8757, dtype=torch.float64)
4 gae_duplicate tensor(-8.4359, dtype=torch.float64) tensor(37.2158, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6355, dtype=torch.float64) delta_t tensor(-0.7695, dtype=torch.float64)
3 gae_duplicate tensor(-7.0537, dtype=torch.float64) tensor(34.5478, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2084, dtype=torch.float64) delta_t tensor(-0.4101, dtype=torch.float64)
2 gae_duplicate tensor(-6.0886, dtype=torch.float64) tensor(30.1916, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:696.0508422851562
value loss:805.0372924804688
entropies:184.44293212890625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.972153902053833 seconds
19 rew tensor(0.7067, dtype=torch.float64) delta_t tensor(-0.3256, dtype=torch.float64)
19 gae_duplicate tensor(-0.5380, dtype=torch.float64) tensor(3.9740, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6771, dtype=torch.float64) delta_t tensor(0.4482, dtype=torch.float64)
18 gae_duplicate tensor(-0.1259, dtype=torch.float64) tensor(-1.7457, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6192, dtype=torch.float64) delta_t tensor(0.4729, dtype=torch.float64)
17 gae_duplicate tensor(0.0588, dtype=torch.float64) tensor(-9.8436, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5008, dtype=torch.float64) delta_t tensor(0.3113, dtype=torch.float64)
16 gae_duplicate tensor(-0.3169, dtype=torch.float64) tensor(-8.4670, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5483, dtype=torch.float64) delta_t tensor(0.3688, dtype=torch.float64)
15 gae_duplicate tensor(0.0814, dtype=torch.float64) tensor(-11.6343, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6930, dtype=torch.float64) delta_t tensor(0.5256, dtype=torch.float64)
14 gae_duplicate tensor(0.5301, dtype=torch.float64) tensor(-17.5109, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6573, dtype=torch.float64) delta_t tensor(0.4531, dtype=torch.float64)
13 gae_duplicate tensor(0.6464, dtype=torch.float64) tensor(-15.5533, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7397, dtype=torch.float64) delta_t tensor(0.5298, dtype=torch.float64)
12 gae_duplicate tensor(1.0428, dtype=torch.float64) tensor(-20.2654, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5562, dtype=torch.float64) delta_t tensor(0.3611, dtype=torch.float64)
11 gae_duplicate tensor(0.5921, dtype=torch.float64) tensor(-18.0803, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6566, dtype=torch.float64) delta_t tensor(0.5058, dtype=torch.float64)
10 gae_duplicate tensor(1.1851, dtype=torch.float64) tensor(-28.3160, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7592, dtype=torch.float64) delta_t tensor(-0.8632, dtype=torch.float64)
9 gae_duplicate tensor(-0.9207, dtype=torch.float64) tensor(-5.3638, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2757, dtype=torch.float64) delta_t tensor(-0.4253, dtype=torch.float64)
8 gae_duplicate tensor(-1.3322, dtype=torch.float64) tensor(0.5420, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5872, dtype=torch.float64) delta_t tensor(-0.7067, dtype=torch.float64)
7 gae_duplicate tensor(-2.3245, dtype=torch.float64) tensor(4.5856, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7139, dtype=torch.float64) delta_t tensor(-0.9322, dtype=torch.float64)
6 gae_duplicate tensor(-3.1921, dtype=torch.float64) tensor(10.4870, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4024, dtype=torch.float64) delta_t tensor(-1.4679, dtype=torch.float64)
5 gae_duplicate tensor(-4.3417, dtype=torch.float64) tensor(20.7199, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2242, dtype=torch.float64) delta_t tensor(-2.2769, dtype=torch.float64)
4 gae_duplicate tensor(-12.2325, dtype=torch.float64) tensor(35.7298, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2429, dtype=torch.float64) delta_t tensor(-0.4168, dtype=torch.float64)
3 gae_duplicate tensor(-9.6489, dtype=torch.float64) tensor(30.6632, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1929, dtype=torch.float64) delta_t tensor(-0.3671, dtype=torch.float64)
2 gae_duplicate tensor(-7.5877, dtype=torch.float64) tensor(33.9488, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-172.28561401367188
value loss:969.6574096679688
entropies:183.1260528564453
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2444.5598)
ToM Target loss= tensor(1812.0699)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.715187311172485 seconds
19 rew tensor(0.5060, dtype=torch.float64) delta_t tensor(-0.4585, dtype=torch.float64)
19 gae_duplicate tensor(-1.3186, dtype=torch.float64) tensor(4.6550, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7005, dtype=torch.float64) delta_t tensor(0.4881, dtype=torch.float64)
18 gae_duplicate tensor(-0.6252, dtype=torch.float64) tensor(0.4666, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6480, dtype=torch.float64) delta_t tensor(0.4440, dtype=torch.float64)
17 gae_duplicate tensor(0.0396, dtype=torch.float64) tensor(-4.5173, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5651, dtype=torch.float64) delta_t tensor(0.3767, dtype=torch.float64)
16 gae_duplicate tensor(-0.1097, dtype=torch.float64) tensor(-7.1009, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4140, dtype=torch.float64) delta_t tensor(0.1955, dtype=torch.float64)
15 gae_duplicate tensor(-0.6468, dtype=torch.float64) tensor(-9.5427, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6378, dtype=torch.float64) delta_t tensor(0.4976, dtype=torch.float64)
14 gae_duplicate tensor(-0.0069, dtype=torch.float64) tensor(-13.9838, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5882, dtype=torch.float64) delta_t tensor(0.3582, dtype=torch.float64)
13 gae_duplicate tensor(0.5056, dtype=torch.float64) tensor(-10.7043, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6556, dtype=torch.float64) delta_t tensor(0.5314, dtype=torch.float64)
12 gae_duplicate tensor(1.1156, dtype=torch.float64) tensor(-14.9807, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7086, dtype=torch.float64) delta_t tensor(-0.9184, dtype=torch.float64)
11 gae_duplicate tensor(-2.5316, dtype=torch.float64) tensor(-2.9801, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4712, dtype=torch.float64) delta_t tensor(0.2726, dtype=torch.float64)
10 gae_duplicate tensor(-1.4139, dtype=torch.float64) tensor(-3.9671, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2485, dtype=torch.float64) delta_t tensor(-0.3822, dtype=torch.float64)
9 gae_duplicate tensor(-1.8125, dtype=torch.float64) tensor(1.1643, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3763, dtype=torch.float64) delta_t tensor(-0.3601, dtype=torch.float64)
8 gae_duplicate tensor(-3.7175, dtype=torch.float64) tensor(5.6449, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2089, dtype=torch.float64) delta_t tensor(-0.4361, dtype=torch.float64)
7 gae_duplicate tensor(-4.3475, dtype=torch.float64) tensor(7.1143, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5263, dtype=torch.float64) delta_t tensor(-0.6604, dtype=torch.float64)
6 gae_duplicate tensor(-5.1293, dtype=torch.float64) tensor(9.3881, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6379, dtype=torch.float64) delta_t tensor(-0.6977, dtype=torch.float64)
5 gae_duplicate tensor(-6.7883, dtype=torch.float64) tensor(12.9983, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6822, dtype=torch.float64) delta_t tensor(-0.8433, dtype=torch.float64)
4 gae_duplicate tensor(-8.3142, dtype=torch.float64) tensor(31.7835, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4198, dtype=torch.float64) delta_t tensor(-0.5031, dtype=torch.float64)
3 gae_duplicate tensor(-6.9031, dtype=torch.float64) tensor(28.4670, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3561, dtype=torch.float64) delta_t tensor(-0.5163, dtype=torch.float64)
2 gae_duplicate tensor(-5.7310, dtype=torch.float64) tensor(25.0097, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2153.8056640625
value loss:595.396728515625
entropies:182.64427185058594
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.887786149978638 seconds
19 rew tensor(0.4248, dtype=torch.float64) delta_t tensor(-0.5974, dtype=torch.float64)
19 gae_duplicate tensor(-1.8382, dtype=torch.float64) tensor(7.2610, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6592, dtype=torch.float64) delta_t tensor(0.5018, dtype=torch.float64)
18 gae_duplicate tensor(-0.9276, dtype=torch.float64) tensor(1.0327, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5935, dtype=torch.float64) delta_t tensor(0.4037, dtype=torch.float64)
17 gae_duplicate tensor(-0.5686, dtype=torch.float64) tensor(-3.5990, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4751, dtype=torch.float64) delta_t tensor(0.2934, dtype=torch.float64)
16 gae_duplicate tensor(-1.3600, dtype=torch.float64) tensor(-5.6497, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7285, dtype=torch.float64) delta_t tensor(0.5242, dtype=torch.float64)
15 gae_duplicate tensor(-0.5397, dtype=torch.float64) tensor(-11.2344, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7067, dtype=torch.float64) delta_t tensor(0.5098, dtype=torch.float64)
14 gae_duplicate tensor(0.0745, dtype=torch.float64) tensor(-13.2577, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6713, dtype=torch.float64) delta_t tensor(0.4697, dtype=torch.float64)
13 gae_duplicate tensor(0.5548, dtype=torch.float64) tensor(-13.0087, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7204, dtype=torch.float64) delta_t tensor(0.5232, dtype=torch.float64)
12 gae_duplicate tensor(0.9853, dtype=torch.float64) tensor(-17.3568, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6895, dtype=torch.float64) delta_t tensor(0.4652, dtype=torch.float64)
11 gae_duplicate tensor(1.1596, dtype=torch.float64) tensor(-19.3345, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6604, dtype=torch.float64) delta_t tensor(0.5282, dtype=torch.float64)
10 gae_duplicate tensor(1.3595, dtype=torch.float64) tensor(-20.3250, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9643, dtype=torch.float64) delta_t tensor(-1.1635, dtype=torch.float64)
9 gae_duplicate tensor(-1.1431, dtype=torch.float64) tensor(-4.4515, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6786, dtype=torch.float64) delta_t tensor(-0.9086, dtype=torch.float64)
8 gae_duplicate tensor(-2.2780, dtype=torch.float64) tensor(0.2445, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7494, dtype=torch.float64) delta_t tensor(-0.8717, dtype=torch.float64)
7 gae_duplicate tensor(-2.4401, dtype=torch.float64) tensor(13.1144, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1226, dtype=torch.float64) delta_t tensor(-1.1573, dtype=torch.float64)
6 gae_duplicate tensor(-3.7594, dtype=torch.float64) tensor(24.7180, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6076, dtype=torch.float64) delta_t tensor(-1.8039, dtype=torch.float64)
5 gae_duplicate tensor(-5.2635, dtype=torch.float64) tensor(39.2394, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5061, dtype=torch.float64) delta_t tensor(-1.5852, dtype=torch.float64)
4 gae_duplicate tensor(-6.7352, dtype=torch.float64) tensor(33.9392, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5560, dtype=torch.float64) delta_t tensor(-0.5980, dtype=torch.float64)
3 gae_duplicate tensor(-5.4050, dtype=torch.float64) tensor(59.8541, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2767, dtype=torch.float64) delta_t tensor(-0.3058, dtype=torch.float64)
2 gae_duplicate tensor(-4.4950, dtype=torch.float64) tensor(41.8466, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4101.91064453125
value loss:945.7901611328125
entropies:181.86732482910156
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.9489710330963135 seconds
19 rew tensor(0.7274, dtype=torch.float64) delta_t tensor(-0.4120, dtype=torch.float64)
19 gae_duplicate tensor(-0.6241, dtype=torch.float64) tensor(3.5147, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7133, dtype=torch.float64) delta_t tensor(0.5372, dtype=torch.float64)
18 gae_duplicate tensor(0.0777, dtype=torch.float64) tensor(-2.9479, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6846, dtype=torch.float64) delta_t tensor(0.5163, dtype=torch.float64)
17 gae_duplicate tensor(0.4715, dtype=torch.float64) tensor(-5.5195, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6416, dtype=torch.float64) delta_t tensor(0.5117, dtype=torch.float64)
16 gae_duplicate tensor(0.5522, dtype=torch.float64) tensor(-10.8114, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5326, dtype=torch.float64) delta_t tensor(0.3647, dtype=torch.float64)
15 gae_duplicate tensor(0.2663, dtype=torch.float64) tensor(-13.0271, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5747, dtype=torch.float64) delta_t tensor(0.3958, dtype=torch.float64)
14 gae_duplicate tensor(0.2095, dtype=torch.float64) tensor(-10.3145, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7087, dtype=torch.float64) delta_t tensor(0.5751, dtype=torch.float64)
13 gae_duplicate tensor(0.5365, dtype=torch.float64) tensor(-17.9702, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6802, dtype=torch.float64) delta_t tensor(0.4177, dtype=torch.float64)
12 gae_duplicate tensor(0.9262, dtype=torch.float64) tensor(-17.4069, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6385, dtype=torch.float64) delta_t tensor(0.4199, dtype=torch.float64)
11 gae_duplicate tensor(1.2683, dtype=torch.float64) tensor(-22.4424, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1085, dtype=torch.float64) delta_t tensor(-0.0842, dtype=torch.float64)
10 gae_duplicate tensor(-1.3667, dtype=torch.float64) tensor(-13.4674, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2729, dtype=torch.float64) delta_t tensor(-0.3916, dtype=torch.float64)
9 gae_duplicate tensor(-1.4165, dtype=torch.float64) tensor(-7.4426, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2449, dtype=torch.float64) delta_t tensor(-0.3269, dtype=torch.float64)
8 gae_duplicate tensor(-1.5733, dtype=torch.float64) tensor(-2.2261, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6470, dtype=torch.float64) delta_t tensor(-0.8465, dtype=torch.float64)
7 gae_duplicate tensor(-3.1391, dtype=torch.float64) tensor(3.1179, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1300, dtype=torch.float64) delta_t tensor(-1.2663, dtype=torch.float64)
6 gae_duplicate tensor(-4.3480, dtype=torch.float64) tensor(14.1121, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3665, dtype=torch.float64) delta_t tensor(-1.4022, dtype=torch.float64)
5 gae_duplicate tensor(-5.3759, dtype=torch.float64) tensor(28.4131, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4439, dtype=torch.float64) delta_t tensor(-1.5682, dtype=torch.float64)
4 gae_duplicate tensor(-9.5325, dtype=torch.float64) tensor(47.1063, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5633, dtype=torch.float64) delta_t tensor(-0.5559, dtype=torch.float64)
3 gae_duplicate tensor(-7.3752, dtype=torch.float64) tensor(30.1003, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3058, dtype=torch.float64) delta_t tensor(-0.4862, dtype=torch.float64)
2 gae_duplicate tensor(-6.2509, dtype=torch.float64) tensor(35.4765, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1410.234619140625
value loss:926.1495971679688
entropies:181.61399841308594
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.740879058837891 seconds
19 rew tensor(0.6627, dtype=torch.float64) delta_t tensor(-0.3880, dtype=torch.float64)
19 gae_duplicate tensor(-0.7301, dtype=torch.float64) tensor(4.5500, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5815, dtype=torch.float64) delta_t tensor(0.3656, dtype=torch.float64)
18 gae_duplicate tensor(-0.7842, dtype=torch.float64) tensor(-1.4021, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4426, dtype=torch.float64) delta_t tensor(0.2855, dtype=torch.float64)
17 gae_duplicate tensor(-1.3670, dtype=torch.float64) tensor(0.3367, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6239, dtype=torch.float64) delta_t tensor(0.3743, dtype=torch.float64)
16 gae_duplicate tensor(-0.5685, dtype=torch.float64) tensor(-6.3121, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5420, dtype=torch.float64) delta_t tensor(0.3281, dtype=torch.float64)
15 gae_duplicate tensor(-0.1957, dtype=torch.float64) tensor(-11.0352, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7224, dtype=torch.float64) delta_t tensor(0.5171, dtype=torch.float64)
14 gae_duplicate tensor(0.4419, dtype=torch.float64) tensor(-13.6237, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6912, dtype=torch.float64) delta_t tensor(0.4974, dtype=torch.float64)
13 gae_duplicate tensor(0.9346, dtype=torch.float64) tensor(-9.7292, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7473, dtype=torch.float64) delta_t tensor(0.5749, dtype=torch.float64)
12 gae_duplicate tensor(1.2739, dtype=torch.float64) tensor(-11.7430, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6201, dtype=torch.float64) delta_t tensor(0.4723, dtype=torch.float64)
11 gae_duplicate tensor(1.5682, dtype=torch.float64) tensor(-18.9139, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5668, dtype=torch.float64) delta_t tensor(0.3957, dtype=torch.float64)
10 gae_duplicate tensor(1.0183, dtype=torch.float64) tensor(-15.9545, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2723, dtype=torch.float64) delta_t tensor(-0.4536, dtype=torch.float64)
9 gae_duplicate tensor(-0.1109, dtype=torch.float64) tensor(-11.3522, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3317, dtype=torch.float64) delta_t tensor(-0.4252, dtype=torch.float64)
8 gae_duplicate tensor(-1.8464, dtype=torch.float64) tensor(-3.6693, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2745, dtype=torch.float64) delta_t tensor(-0.4584, dtype=torch.float64)
7 gae_duplicate tensor(-2.3361, dtype=torch.float64) tensor(2.3259, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1525, dtype=torch.float64) delta_t tensor(-1.3055, dtype=torch.float64)
6 gae_duplicate tensor(-3.8339, dtype=torch.float64) tensor(7.3340, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5996, dtype=torch.float64) delta_t tensor(-1.7031, dtype=torch.float64)
5 gae_duplicate tensor(-6.4962, dtype=torch.float64) tensor(24.7789, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9908, dtype=torch.float64) delta_t tensor(-0.9671, dtype=torch.float64)
4 gae_duplicate tensor(-6.9994, dtype=torch.float64) tensor(32.6912, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5454, dtype=torch.float64) delta_t tensor(-0.6997, dtype=torch.float64)
3 gae_duplicate tensor(-6.1804, dtype=torch.float64) tensor(41.5686, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1944, dtype=torch.float64) delta_t tensor(-0.3622, dtype=torch.float64)
2 gae_duplicate tensor(-5.0247, dtype=torch.float64) tensor(30.8885, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1499.259765625
value loss:735.0474243164062
entropies:181.47035217285156
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.409925222396851 seconds
19 rew tensor(0.7396, dtype=torch.float64) delta_t tensor(-0.2298, dtype=torch.float64)
19 gae_duplicate tensor(-0.4226, dtype=torch.float64) tensor(1.9087, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7402, dtype=torch.float64) delta_t tensor(0.5567, dtype=torch.float64)
18 gae_duplicate tensor(0.1694, dtype=torch.float64) tensor(-4.1424, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7334, dtype=torch.float64) delta_t tensor(0.5471, dtype=torch.float64)
17 gae_duplicate tensor(0.5377, dtype=torch.float64) tensor(-10.4574, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7415, dtype=torch.float64) delta_t tensor(0.5289, dtype=torch.float64)
16 gae_duplicate tensor(0.8937, dtype=torch.float64) tensor(-11.4305, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7272, dtype=torch.float64) delta_t tensor(0.4794, dtype=torch.float64)
15 gae_duplicate tensor(1.1296, dtype=torch.float64) tensor(-15.8297, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7353, dtype=torch.float64) delta_t tensor(0.4885, dtype=torch.float64)
14 gae_duplicate tensor(1.3147, dtype=torch.float64) tensor(-19.2649, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7209, dtype=torch.float64) delta_t tensor(0.5754, dtype=torch.float64)
13 gae_duplicate tensor(1.3510, dtype=torch.float64) tensor(-20.8633, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6786, dtype=torch.float64) delta_t tensor(0.4748, dtype=torch.float64)
12 gae_duplicate tensor(1.5381, dtype=torch.float64) tensor(-18.3031, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6210, dtype=torch.float64) delta_t tensor(0.5234, dtype=torch.float64)
11 gae_duplicate tensor(1.2824, dtype=torch.float64) tensor(-19.8882, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4974, dtype=torch.float64) delta_t tensor(0.2998, dtype=torch.float64)
10 gae_duplicate tensor(0.7661, dtype=torch.float64) tensor(-15.4528, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4024, dtype=torch.float64) delta_t tensor(-0.5790, dtype=torch.float64)
9 gae_duplicate tensor(-0.8680, dtype=torch.float64) tensor(-12.7852, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0893, dtype=torch.float64) delta_t tensor(-0.2462, dtype=torch.float64)
8 gae_duplicate tensor(-1.3304, dtype=torch.float64) tensor(-4.8059, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3020, dtype=torch.float64) delta_t tensor(-0.4869, dtype=torch.float64)
7 gae_duplicate tensor(-1.6661, dtype=torch.float64) tensor(2.8441, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7256, dtype=torch.float64) delta_t tensor(-0.7959, dtype=torch.float64)
6 gae_duplicate tensor(-3.0207, dtype=torch.float64) tensor(6.1787, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7519, dtype=torch.float64) delta_t tensor(-0.8779, dtype=torch.float64)
5 gae_duplicate tensor(-4.3629, dtype=torch.float64) tensor(12.0677, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1128, dtype=torch.float64) delta_t tensor(-3.1363, dtype=torch.float64)
4 gae_duplicate tensor(-13.1418, dtype=torch.float64) tensor(55.2514, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7031, dtype=torch.float64) delta_t tensor(-0.9185, dtype=torch.float64)
3 gae_duplicate tensor(-10.5284, dtype=torch.float64) tensor(56.2585, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0490, dtype=torch.float64) delta_t tensor(-0.0757, dtype=torch.float64)
2 gae_duplicate tensor(-8.0327, dtype=torch.float64) tensor(30.3407, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-451.4798583984375
value loss:1099.70751953125
entropies:182.94839477539062
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2443.2271)
ToM Target loss= tensor(1814.3376)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.885492324829102 seconds
19 rew tensor(0.7033, dtype=torch.float64) delta_t tensor(-0.4292, dtype=torch.float64)
19 gae_duplicate tensor(-0.6642, dtype=torch.float64) tensor(4.2414, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6643, dtype=torch.float64) delta_t tensor(0.4711, dtype=torch.float64)
18 gae_duplicate tensor(-0.1856, dtype=torch.float64) tensor(-0.7048, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6035, dtype=torch.float64) delta_t tensor(0.3767, dtype=torch.float64)
17 gae_duplicate tensor(0.1236, dtype=torch.float64) tensor(-3.7081, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4502, dtype=torch.float64) delta_t tensor(0.2720, dtype=torch.float64)
16 gae_duplicate tensor(0.1716, dtype=torch.float64) tensor(-8.2466, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2046, dtype=torch.float64) delta_t tensor(0.0733, dtype=torch.float64)
15 gae_duplicate tensor(-0.3372, dtype=torch.float64) tensor(-10.5876, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6990, dtype=torch.float64) delta_t tensor(0.5525, dtype=torch.float64)
14 gae_duplicate tensor(0.2711, dtype=torch.float64) tensor(-8.1358, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7064, dtype=torch.float64) delta_t tensor(0.4795, dtype=torch.float64)
13 gae_duplicate tensor(0.7584, dtype=torch.float64) tensor(-12.3842, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7441, dtype=torch.float64) delta_t tensor(0.5464, dtype=torch.float64)
12 gae_duplicate tensor(1.1493, dtype=torch.float64) tensor(-19.6755, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5265, dtype=torch.float64) delta_t tensor(0.3347, dtype=torch.float64)
11 gae_duplicate tensor(0.5025, dtype=torch.float64) tensor(-19.6773, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1391, dtype=torch.float64) delta_t tensor(0.0095, dtype=torch.float64)
10 gae_duplicate tensor(-0.7568, dtype=torch.float64) tensor(-9.4237, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1488, dtype=torch.float64) delta_t tensor(0.1214, dtype=torch.float64)
9 gae_duplicate tensor(-0.4624, dtype=torch.float64) tensor(-15.5965, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0757, dtype=torch.float64) delta_t tensor(-0.2490, dtype=torch.float64)
8 gae_duplicate tensor(-0.5304, dtype=torch.float64) tensor(-6.4614, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3173, dtype=torch.float64) delta_t tensor(-0.3862, dtype=torch.float64)
7 gae_duplicate tensor(-1.1269, dtype=torch.float64) tensor(-1.6341, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7177, dtype=torch.float64) delta_t tensor(-0.8948, dtype=torch.float64)
6 gae_duplicate tensor(-1.9309, dtype=torch.float64) tensor(7.5501, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7198, dtype=torch.float64) delta_t tensor(-0.7416, dtype=torch.float64)
5 gae_duplicate tensor(-2.4645, dtype=torch.float64) tensor(12.0370, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2558, dtype=torch.float64) delta_t tensor(-0.3014, dtype=torch.float64)
4 gae_duplicate tensor(-2.6393, dtype=torch.float64) tensor(18.2520, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5745, dtype=torch.float64) delta_t tensor(-0.6338, dtype=torch.float64)
3 gae_duplicate tensor(-3.1356, dtype=torch.float64) tensor(17.0137, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1669, dtype=torch.float64) delta_t tensor(-0.4190, dtype=torch.float64)
2 gae_duplicate tensor(-3.1673, dtype=torch.float64) tensor(19.8748, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1308.707763671875
value loss:292.6953430175781
entropies:182.70278930664062
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.175440073013306 seconds
19 rew tensor(0.7276, dtype=torch.float64) delta_t tensor(-0.3110, dtype=torch.float64)
19 gae_duplicate tensor(-0.4862, dtype=torch.float64) tensor(1.5832, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7060, dtype=torch.float64) delta_t tensor(0.5227, dtype=torch.float64)
18 gae_duplicate tensor(0.0326, dtype=torch.float64) tensor(-2.2901, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6772, dtype=torch.float64) delta_t tensor(0.5020, dtype=torch.float64)
17 gae_duplicate tensor(0.3593, dtype=torch.float64) tensor(-7.9202, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6188, dtype=torch.float64) delta_t tensor(0.3971, dtype=torch.float64)
16 gae_duplicate tensor(0.3743, dtype=torch.float64) tensor(-8.3422, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4861, dtype=torch.float64) delta_t tensor(0.3925, dtype=torch.float64)
15 gae_duplicate tensor(0.1212, dtype=torch.float64) tensor(-14.0491, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5841, dtype=torch.float64) delta_t tensor(0.3976, dtype=torch.float64)
14 gae_duplicate tensor(0.1443, dtype=torch.float64) tensor(-7.5388, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7377, dtype=torch.float64) delta_t tensor(0.5240, dtype=torch.float64)
13 gae_duplicate tensor(0.6540, dtype=torch.float64) tensor(-18.1506, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7384, dtype=torch.float64) delta_t tensor(0.6114, dtype=torch.float64)
12 gae_duplicate tensor(1.0513, dtype=torch.float64) tensor(-28.7756, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3416, dtype=torch.float64) delta_t tensor(0.1381, dtype=torch.float64)
11 gae_duplicate tensor(0.1650, dtype=torch.float64) tensor(-11.4632, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5687, dtype=torch.float64) delta_t tensor(0.3909, dtype=torch.float64)
10 gae_duplicate tensor(0.6605, dtype=torch.float64) tensor(-18.0634, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5347, dtype=torch.float64) delta_t tensor(-0.6800, dtype=torch.float64)
9 gae_duplicate tensor(-0.9912, dtype=torch.float64) tensor(-8.1302, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4366, dtype=torch.float64) delta_t tensor(-0.5073, dtype=torch.float64)
8 gae_duplicate tensor(-2.3432, dtype=torch.float64) tensor(8.1299, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1628, dtype=torch.float64) delta_t tensor(-0.3281, dtype=torch.float64)
7 gae_duplicate tensor(-2.4659, dtype=torch.float64) tensor(1.1107, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3815, dtype=torch.float64) delta_t tensor(-0.5385, dtype=torch.float64)
6 gae_duplicate tensor(-2.0356, dtype=torch.float64) tensor(9.2496, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1777, dtype=torch.float64) delta_t tensor(-1.2578, dtype=torch.float64)
5 gae_duplicate tensor(-4.7618, dtype=torch.float64) tensor(21.9600, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3870, dtype=torch.float64) delta_t tensor(-1.4211, dtype=torch.float64)
4 gae_duplicate tensor(-6.3512, dtype=torch.float64) tensor(21.4130, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5500, dtype=torch.float64) delta_t tensor(-0.6978, dtype=torch.float64)
3 gae_duplicate tensor(-5.4274, dtype=torch.float64) tensor(28.2424, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1370, dtype=torch.float64) delta_t tensor(-0.2656, dtype=torch.float64)
2 gae_duplicate tensor(-4.7782, dtype=torch.float64) tensor(32.4554, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-12.0201416015625
value loss:620.1084594726562
entropies:182.66217041015625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.031042814254761 seconds
19 rew tensor(0.6967, dtype=torch.float64) delta_t tensor(-0.3589, dtype=torch.float64)
19 gae_duplicate tensor(-0.6261, dtype=torch.float64) tensor(3.4892, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6571, dtype=torch.float64) delta_t tensor(0.4393, dtype=torch.float64)
18 gae_duplicate tensor(-0.3289, dtype=torch.float64) tensor(-0.8831, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5684, dtype=torch.float64) delta_t tensor(0.4166, dtype=torch.float64)
17 gae_duplicate tensor(-0.3375, dtype=torch.float64) tensor(-6.0918, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4088, dtype=torch.float64) delta_t tensor(0.2811, dtype=torch.float64)
16 gae_duplicate tensor(-0.7490, dtype=torch.float64) tensor(-6.2159, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5302, dtype=torch.float64) delta_t tensor(0.3827, dtype=torch.float64)
15 gae_duplicate tensor(-0.4257, dtype=torch.float64) tensor(-5.5578, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6907, dtype=torch.float64) delta_t tensor(0.4995, dtype=torch.float64)
14 gae_duplicate tensor(0.0272, dtype=torch.float64) tensor(-9.5063, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6348, dtype=torch.float64) delta_t tensor(0.3738, dtype=torch.float64)
13 gae_duplicate tensor(0.3112, dtype=torch.float64) tensor(-11.3257, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7065, dtype=torch.float64) delta_t tensor(0.4775, dtype=torch.float64)
12 gae_duplicate tensor(0.6241, dtype=torch.float64) tensor(-14.5666, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5440, dtype=torch.float64) delta_t tensor(0.2788, dtype=torch.float64)
11 gae_duplicate tensor(0.7995, dtype=torch.float64) tensor(-19.3211, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0230, dtype=torch.float64) delta_t tensor(-0.0439, dtype=torch.float64)
10 gae_duplicate tensor(-1.3518, dtype=torch.float64) tensor(-9.1823, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2951, dtype=torch.float64) delta_t tensor(-0.3532, dtype=torch.float64)
9 gae_duplicate tensor(-3.6620, dtype=torch.float64) tensor(-1.0115, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3556, dtype=torch.float64) delta_t tensor(-0.5326, dtype=torch.float64)
8 gae_duplicate tensor(-3.0306, dtype=torch.float64) tensor(1.5668, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4620, dtype=torch.float64) delta_t tensor(-0.5640, dtype=torch.float64)
7 gae_duplicate tensor(-4.1571, dtype=torch.float64) tensor(1.9353, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5400, dtype=torch.float64) delta_t tensor(-0.7155, dtype=torch.float64)
6 gae_duplicate tensor(-4.5411, dtype=torch.float64) tensor(8.9928, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8112, dtype=torch.float64) delta_t tensor(-0.7828, dtype=torch.float64)
5 gae_duplicate tensor(-4.1808, dtype=torch.float64) tensor(14.1208, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3384, dtype=torch.float64) delta_t tensor(-0.4650, dtype=torch.float64)
4 gae_duplicate tensor(-3.6660, dtype=torch.float64) tensor(16.5733, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7464, dtype=torch.float64) delta_t tensor(-0.8035, dtype=torch.float64)
3 gae_duplicate tensor(-3.1841, dtype=torch.float64) tensor(25.6274, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4552, dtype=torch.float64) delta_t tensor(-0.6005, dtype=torch.float64)
2 gae_duplicate tensor(-3.9340, dtype=torch.float64) tensor(21.9568, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-413.8464050292969
value loss:506.767333984375
entropies:179.03646850585938
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.671176910400391 seconds
19 rew tensor(0.7052, dtype=torch.float64) delta_t tensor(-0.4013, dtype=torch.float64)
19 gae_duplicate tensor(-0.6113, dtype=torch.float64) tensor(2.7659, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6816, dtype=torch.float64) delta_t tensor(0.4686, dtype=torch.float64)
18 gae_duplicate tensor(-0.1289, dtype=torch.float64) tensor(-2.0461, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6233, dtype=torch.float64) delta_t tensor(0.4380, dtype=torch.float64)
17 gae_duplicate tensor(-0.1980, dtype=torch.float64) tensor(-6.4939, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5325, dtype=torch.float64) delta_t tensor(0.4017, dtype=torch.float64)
16 gae_duplicate tensor(-0.5876, dtype=torch.float64) tensor(-9.8119, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7402, dtype=torch.float64) delta_t tensor(0.5540, dtype=torch.float64)
15 gae_duplicate tensor(0.1880, dtype=torch.float64) tensor(-9.4884, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7325, dtype=torch.float64) delta_t tensor(0.5362, dtype=torch.float64)
14 gae_duplicate tensor(0.7242, dtype=torch.float64) tensor(-15.8134, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7414, dtype=torch.float64) delta_t tensor(0.5721, dtype=torch.float64)
13 gae_duplicate tensor(1.2097, dtype=torch.float64) tensor(-16.4393, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7420, dtype=torch.float64) delta_t tensor(0.5449, dtype=torch.float64)
12 gae_duplicate tensor(1.5988, dtype=torch.float64) tensor(-16.2620, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7260, dtype=torch.float64) delta_t tensor(0.4210, dtype=torch.float64)
11 gae_duplicate tensor(1.3704, dtype=torch.float64) tensor(-12.1161, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6480, dtype=torch.float64) delta_t tensor(0.5333, dtype=torch.float64)
10 gae_duplicate tensor(1.8778, dtype=torch.float64) tensor(-26.2827, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2678, dtype=torch.float64) delta_t tensor(0.0239, dtype=torch.float64)
9 gae_duplicate tensor(0.3809, dtype=torch.float64) tensor(-13.3084, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0827, dtype=torch.float64) delta_t tensor(-0.1375, dtype=torch.float64)
8 gae_duplicate tensor(-1.0500, dtype=torch.float64) tensor(-11.2073, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5687, dtype=torch.float64) delta_t tensor(-0.6983, dtype=torch.float64)
7 gae_duplicate tensor(-2.2029, dtype=torch.float64) tensor(-6.2934, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7358, dtype=torch.float64) delta_t tensor(-0.9272, dtype=torch.float64)
6 gae_duplicate tensor(-3.3942, dtype=torch.float64) tensor(9.1160, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3628, dtype=torch.float64) delta_t tensor(-1.3265, dtype=torch.float64)
5 gae_duplicate tensor(-4.3808, dtype=torch.float64) tensor(15.6507, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4708, dtype=torch.float64) delta_t tensor(-3.6077, dtype=torch.float64)
4 gae_duplicate tensor(-11.9634, dtype=torch.float64) tensor(79.4146, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3446, dtype=torch.float64) delta_t tensor(-0.4582, dtype=torch.float64)
3 gae_duplicate tensor(-9.4645, dtype=torch.float64) tensor(36.5298, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2119, dtype=torch.float64) delta_t tensor(-0.3667, dtype=torch.float64)
2 gae_duplicate tensor(-7.6965, dtype=torch.float64) tensor(36.4846, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1270.56787109375
value loss:1263.5369873046875
entropies:178.93528747558594
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.987489223480225 seconds
19 rew tensor(0.4324, dtype=torch.float64) delta_t tensor(-0.5796, dtype=torch.float64)
19 gae_duplicate tensor(-1.8144, dtype=torch.float64) tensor(9.5108, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7306, dtype=torch.float64) delta_t tensor(0.5113, dtype=torch.float64)
18 gae_duplicate tensor(-0.8514, dtype=torch.float64) tensor(1.2635, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7239, dtype=torch.float64) delta_t tensor(0.5619, dtype=torch.float64)
17 gae_duplicate tensor(-0.0805, dtype=torch.float64) tensor(-3.8120, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6942, dtype=torch.float64) delta_t tensor(0.5515, dtype=torch.float64)
16 gae_duplicate tensor(0.5369, dtype=torch.float64) tensor(-10.2282, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6498, dtype=torch.float64) delta_t tensor(0.4661, dtype=torch.float64)
15 gae_duplicate tensor(0.7721, dtype=torch.float64) tensor(-15.7017, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5689, dtype=torch.float64) delta_t tensor(0.3672, dtype=torch.float64)
14 gae_duplicate tensor(0.5848, dtype=torch.float64) tensor(-17.9790, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6906, dtype=torch.float64) delta_t tensor(0.5337, dtype=torch.float64)
13 gae_duplicate tensor(1.0742, dtype=torch.float64) tensor(-12.8257, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7243, dtype=torch.float64) delta_t tensor(0.5405, dtype=torch.float64)
12 gae_duplicate tensor(1.5755, dtype=torch.float64) tensor(-18.6460, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7341, dtype=torch.float64) delta_t tensor(0.6334, dtype=torch.float64)
11 gae_duplicate tensor(1.6611, dtype=torch.float64) tensor(-22.9105, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2012, dtype=torch.float64) delta_t tensor(-0.3509, dtype=torch.float64)
10 gae_duplicate tensor(-2.4794, dtype=torch.float64) tensor(-15.8874, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2092, dtype=torch.float64) delta_t tensor(-0.4016, dtype=torch.float64)
9 gae_duplicate tensor(-1.7483, dtype=torch.float64) tensor(-0.7880, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3258, dtype=torch.float64) delta_t tensor(-0.5454, dtype=torch.float64)
8 gae_duplicate tensor(-3.2021, dtype=torch.float64) tensor(-1.4127, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9258, dtype=torch.float64) delta_t tensor(-1.1259, dtype=torch.float64)
7 gae_duplicate tensor(-3.3377, dtype=torch.float64) tensor(11.8541, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3111, dtype=torch.float64) delta_t tensor(-1.2941, dtype=torch.float64)
6 gae_duplicate tensor(-4.6958, dtype=torch.float64) tensor(23.9832, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8823, dtype=torch.float64) delta_t tensor(-1.0229, dtype=torch.float64)
5 gae_duplicate tensor(-4.4805, dtype=torch.float64) tensor(27.8748, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8955, dtype=torch.float64) delta_t tensor(-1.8259, dtype=torch.float64)
4 gae_duplicate tensor(-8.4388, dtype=torch.float64) tensor(37.6130, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1261, dtype=torch.float64) delta_t tensor(0.0638, dtype=torch.float64)
3 gae_duplicate tensor(-6.9185, dtype=torch.float64) tensor(24.2546, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6281, dtype=torch.float64) delta_t tensor(-0.6897, dtype=torch.float64)
2 gae_duplicate tensor(-5.4741, dtype=torch.float64) tensor(29.9962, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1693.706298828125
value loss:945.0103149414062
entropies:177.69557189941406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2437.3745)
ToM Target loss= tensor(1815.8564)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.07276725769043 seconds
19 rew tensor(0.5675, dtype=torch.float64) delta_t tensor(-0.6394, dtype=torch.float64)
19 gae_duplicate tensor(-1.2499, dtype=torch.float64) tensor(3.2881, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3882, dtype=torch.float64) delta_t tensor(0.2317, dtype=torch.float64)
18 gae_duplicate tensor(-1.8861, dtype=torch.float64) tensor(5.5859, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6738, dtype=torch.float64) delta_t tensor(0.4794, dtype=torch.float64)
17 gae_duplicate tensor(-0.8758, dtype=torch.float64) tensor(-2.3080, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5925, dtype=torch.float64) delta_t tensor(0.4059, dtype=torch.float64)
16 gae_duplicate tensor(-0.0669, dtype=torch.float64) tensor(-3.7971, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4586, dtype=torch.float64) delta_t tensor(0.3844, dtype=torch.float64)
15 gae_duplicate tensor(-0.1736, dtype=torch.float64) tensor(-4.6686, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5260, dtype=torch.float64) delta_t tensor(0.3383, dtype=torch.float64)
14 gae_duplicate tensor(-0.3604, dtype=torch.float64) tensor(-9.0801, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7348, dtype=torch.float64) delta_t tensor(0.4703, dtype=torch.float64)
13 gae_duplicate tensor(0.2800, dtype=torch.float64) tensor(-11.0524, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7339, dtype=torch.float64) delta_t tensor(0.5520, dtype=torch.float64)
12 gae_duplicate tensor(0.7930, dtype=torch.float64) tensor(-14.9815, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4250, dtype=torch.float64) delta_t tensor(0.3356, dtype=torch.float64)
11 gae_duplicate tensor(0.5298, dtype=torch.float64) tensor(-10.9116, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0226, dtype=torch.float64) delta_t tensor(-0.1284, dtype=torch.float64)
10 gae_duplicate tensor(-1.6055, dtype=torch.float64) tensor(-13.8825, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2834, dtype=torch.float64) delta_t tensor(0.2097, dtype=torch.float64)
9 gae_duplicate tensor(-1.0797, dtype=torch.float64) tensor(-7.8592, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2090, dtype=torch.float64) delta_t tensor(-0.4115, dtype=torch.float64)
8 gae_duplicate tensor(-1.1215, dtype=torch.float64) tensor(-6.6547, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2107, dtype=torch.float64) delta_t tensor(-0.3122, dtype=torch.float64)
7 gae_duplicate tensor(-1.4778, dtype=torch.float64) tensor(-0.6446, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7950, dtype=torch.float64) delta_t tensor(-0.9395, dtype=torch.float64)
6 gae_duplicate tensor(-3.1051, dtype=torch.float64) tensor(4.2292, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1890, dtype=torch.float64) delta_t tensor(-1.2414, dtype=torch.float64)
5 gae_duplicate tensor(-4.5379, dtype=torch.float64) tensor(13.3041, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4027, dtype=torch.float64) delta_t tensor(-0.4134, dtype=torch.float64)
4 gae_duplicate tensor(-3.3568, dtype=torch.float64) tensor(19.8192, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5120, dtype=torch.float64) delta_t tensor(-0.5855, dtype=torch.float64)
3 gae_duplicate tensor(-3.1502, dtype=torch.float64) tensor(34.8604, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2709, dtype=torch.float64) delta_t tensor(-0.5139, dtype=torch.float64)
2 gae_duplicate tensor(-3.0797, dtype=torch.float64) tensor(16.6497, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-459.7654724121094
value loss:401.0003967285156
entropies:175.02085876464844
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.905216932296753 seconds
19 rew tensor(0.5109, dtype=torch.float64) delta_t tensor(-0.3552, dtype=torch.float64)
19 gae_duplicate tensor(-1.4144, dtype=torch.float64) tensor(5.4231, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7335, dtype=torch.float64) delta_t tensor(0.4206, dtype=torch.float64)
18 gae_duplicate tensor(-0.6063, dtype=torch.float64) tensor(-0.0864, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7339, dtype=torch.float64) delta_t tensor(0.5709, dtype=torch.float64)
17 gae_duplicate tensor(0.1112, dtype=torch.float64) tensor(-7.0578, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7345, dtype=torch.float64) delta_t tensor(0.5515, dtype=torch.float64)
16 gae_duplicate tensor(0.6858, dtype=torch.float64) tensor(-10.8386, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7274, dtype=torch.float64) delta_t tensor(0.4134, dtype=torch.float64)
15 gae_duplicate tensor(1.0921, dtype=torch.float64) tensor(-15.0838, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7204, dtype=torch.float64) delta_t tensor(0.4001, dtype=torch.float64)
14 gae_duplicate tensor(1.0655, dtype=torch.float64) tensor(-17.0437, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6908, dtype=torch.float64) delta_t tensor(0.4907, dtype=torch.float64)
13 gae_duplicate tensor(1.2645, dtype=torch.float64) tensor(-13.8615, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7367, dtype=torch.float64) delta_t tensor(0.5249, dtype=torch.float64)
12 gae_duplicate tensor(1.5175, dtype=torch.float64) tensor(-15.7500, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7132, dtype=torch.float64) delta_t tensor(0.4834, dtype=torch.float64)
11 gae_duplicate tensor(1.7205, dtype=torch.float64) tensor(-13.3147, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6746, dtype=torch.float64) delta_t tensor(0.5162, dtype=torch.float64)
10 gae_duplicate tensor(1.8133, dtype=torch.float64) tensor(-24.5217, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1806, dtype=torch.float64) delta_t tensor(0.0591, dtype=torch.float64)
9 gae_duplicate tensor(0.0136, dtype=torch.float64) tensor(-16.7359, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3224, dtype=torch.float64) delta_t tensor(-0.3771, dtype=torch.float64)
8 gae_duplicate tensor(-1.3922, dtype=torch.float64) tensor(-11.3602, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6685, dtype=torch.float64) delta_t tensor(-0.7591, dtype=torch.float64)
7 gae_duplicate tensor(-3.5932, dtype=torch.float64) tensor(7.1015, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3115, dtype=torch.float64) delta_t tensor(-0.3549, dtype=torch.float64)
6 gae_duplicate tensor(-2.9520, dtype=torch.float64) tensor(0.3461, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2232, dtype=torch.float64) delta_t tensor(-1.2058, dtype=torch.float64)
5 gae_duplicate tensor(-3.6598, dtype=torch.float64) tensor(11.0259, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7084, dtype=torch.float64) delta_t tensor(-0.8081, dtype=torch.float64)
4 gae_duplicate tensor(-4.9525, dtype=torch.float64) tensor(22.1617, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6452, dtype=torch.float64) delta_t tensor(-0.7440, dtype=torch.float64)
3 gae_duplicate tensor(-4.5193, dtype=torch.float64) tensor(25.0470, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3410, dtype=torch.float64) delta_t tensor(-0.5535, dtype=torch.float64)
2 gae_duplicate tensor(-3.9983, dtype=torch.float64) tensor(20.0374, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1931.5712890625
value loss:501.52239990234375
entropies:171.35728454589844
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.843149662017822 seconds
19 rew tensor(0.6209, dtype=torch.float64) delta_t tensor(-0.5207, dtype=torch.float64)
19 gae_duplicate tensor(-0.8904, dtype=torch.float64) tensor(3.9868, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5077, dtype=torch.float64) delta_t tensor(0.2339, dtype=torch.float64)
18 gae_duplicate tensor(-1.1122, dtype=torch.float64) tensor(2.1539, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2834, dtype=torch.float64) delta_t tensor(0.1884, dtype=torch.float64)
17 gae_duplicate tensor(-1.8165, dtype=torch.float64) tensor(0.0273, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4336, dtype=torch.float64) delta_t tensor(0.3372, dtype=torch.float64)
16 gae_duplicate tensor(-1.0667, dtype=torch.float64) tensor(-2.4839, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6058, dtype=torch.float64) delta_t tensor(0.4365, dtype=torch.float64)
15 gae_duplicate tensor(-0.3173, dtype=torch.float64) tensor(-8.1009, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7430, dtype=torch.float64) delta_t tensor(0.6245, dtype=torch.float64)
14 gae_duplicate tensor(0.2828, dtype=torch.float64) tensor(-10.7578, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7359, dtype=torch.float64) delta_t tensor(0.5205, dtype=torch.float64)
13 gae_duplicate tensor(0.7374, dtype=torch.float64) tensor(-13.3352, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7363, dtype=torch.float64) delta_t tensor(0.5552, dtype=torch.float64)
12 gae_duplicate tensor(1.0593, dtype=torch.float64) tensor(-11.5170, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3924, dtype=torch.float64) delta_t tensor(0.1079, dtype=torch.float64)
11 gae_duplicate tensor(-0.1179, dtype=torch.float64) tensor(-11.0946, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0076, dtype=torch.float64) delta_t tensor(-0.1385, dtype=torch.float64)
10 gae_duplicate tensor(-2.7602, dtype=torch.float64) tensor(-13.7374, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0503, dtype=torch.float64) delta_t tensor(-0.0670, dtype=torch.float64)
9 gae_duplicate tensor(-1.8330, dtype=torch.float64) tensor(-4.3455, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3210, dtype=torch.float64) delta_t tensor(-0.5215, dtype=torch.float64)
8 gae_duplicate tensor(-2.2007, dtype=torch.float64) tensor(-2.4441, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4464, dtype=torch.float64) delta_t tensor(-0.4573, dtype=torch.float64)
7 gae_duplicate tensor(-2.5490, dtype=torch.float64) tensor(7.3335, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6535, dtype=torch.float64) delta_t tensor(-0.7544, dtype=torch.float64)
6 gae_duplicate tensor(-3.8060, dtype=torch.float64) tensor(7.6068, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5189, dtype=torch.float64) delta_t tensor(-1.5928, dtype=torch.float64)
5 gae_duplicate tensor(-5.5207, dtype=torch.float64) tensor(17.8799, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5267, dtype=torch.float64) delta_t tensor(-0.4634, dtype=torch.float64)
4 gae_duplicate tensor(-9.1929, dtype=torch.float64) tensor(14.5541, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6111, dtype=torch.float64) delta_t tensor(-0.7260, dtype=torch.float64)
3 gae_duplicate tensor(-7.3674, dtype=torch.float64) tensor(21.2350, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0708, dtype=torch.float64) delta_t tensor(-0.3914, dtype=torch.float64)
2 gae_duplicate tensor(-6.2849, dtype=torch.float64) tensor(24.4163, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-800.6717529296875
value loss:663.1155395507812
entropies:172.68421936035156
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.857402801513672 seconds
19 rew tensor(0.7345, dtype=torch.float64) delta_t tensor(-0.3107, dtype=torch.float64)
19 gae_duplicate tensor(-0.5005, dtype=torch.float64) tensor(2.6351, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7275, dtype=torch.float64) delta_t tensor(0.4866, dtype=torch.float64)
18 gae_duplicate tensor(0.0149, dtype=torch.float64) tensor(-1.0767, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7131, dtype=torch.float64) delta_t tensor(0.4224, dtype=torch.float64)
17 gae_duplicate tensor(0.3550, dtype=torch.float64) tensor(-6.7687, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6831, dtype=torch.float64) delta_t tensor(0.4654, dtype=torch.float64)
16 gae_duplicate tensor(0.5786, dtype=torch.float64) tensor(-8.9541, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6313, dtype=torch.float64) delta_t tensor(0.4684, dtype=torch.float64)
15 gae_duplicate tensor(0.5593, dtype=torch.float64) tensor(-13.9904, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5342, dtype=torch.float64) delta_t tensor(0.3672, dtype=torch.float64)
14 gae_duplicate tensor(0.1195, dtype=torch.float64) tensor(-12.7794, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6901, dtype=torch.float64) delta_t tensor(0.4600, dtype=torch.float64)
13 gae_duplicate tensor(0.4483, dtype=torch.float64) tensor(-7.0006, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6547, dtype=torch.float64) delta_t tensor(0.4993, dtype=torch.float64)
12 gae_duplicate tensor(0.8918, dtype=torch.float64) tensor(-21.9581, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5510, dtype=torch.float64) delta_t tensor(-0.7724, dtype=torch.float64)
11 gae_duplicate tensor(-1.8931, dtype=torch.float64) tensor(-6.1461, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5152, dtype=torch.float64) delta_t tensor(0.3818, dtype=torch.float64)
10 gae_duplicate tensor(-1.7175, dtype=torch.float64) tensor(-10.8314, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0461, dtype=torch.float64) delta_t tensor(0.0446, dtype=torch.float64)
9 gae_duplicate tensor(-0.9400, dtype=torch.float64) tensor(-2.1143, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3622, dtype=torch.float64) delta_t tensor(-0.4765, dtype=torch.float64)
8 gae_duplicate tensor(-2.6158, dtype=torch.float64) tensor(-0.6200, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6867, dtype=torch.float64) delta_t tensor(-0.8795, dtype=torch.float64)
7 gae_duplicate tensor(-2.7985, dtype=torch.float64) tensor(7.7310, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5529, dtype=torch.float64) delta_t tensor(-0.6292, dtype=torch.float64)
6 gae_duplicate tensor(-3.4791, dtype=torch.float64) tensor(12.6523, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0689, dtype=torch.float64) delta_t tensor(-1.1281, dtype=torch.float64)
5 gae_duplicate tensor(-5.1507, dtype=torch.float64) tensor(20.2821, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4480, dtype=torch.float64) delta_t tensor(-1.3984, dtype=torch.float64)
4 gae_duplicate tensor(-8.6182, dtype=torch.float64) tensor(26.4684, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3388, dtype=torch.float64) delta_t tensor(-0.4278, dtype=torch.float64)
3 gae_duplicate tensor(-7.1148, dtype=torch.float64) tensor(29.4759, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2562, dtype=torch.float64) delta_t tensor(-0.4997, dtype=torch.float64)
2 gae_duplicate tensor(-6.1764, dtype=torch.float64) tensor(24.4902, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1164.5025634765625
value loss:681.8905639648438
entropies:170.43060302734375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.773196697235107 seconds
19 rew tensor(0.7350, dtype=torch.float64) delta_t tensor(-0.2184, dtype=torch.float64)
19 gae_duplicate tensor(-0.4758, dtype=torch.float64) tensor(0.9786, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7431, dtype=torch.float64) delta_t tensor(0.5416, dtype=torch.float64)
18 gae_duplicate tensor(0.1008, dtype=torch.float64) tensor(-3.1488, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7436, dtype=torch.float64) delta_t tensor(0.5522, dtype=torch.float64)
17 gae_duplicate tensor(0.6905, dtype=torch.float64) tensor(-10.2484, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7442, dtype=torch.float64) delta_t tensor(0.5562, dtype=torch.float64)
16 gae_duplicate tensor(1.0838, dtype=torch.float64) tensor(-10.4534, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7294, dtype=torch.float64) delta_t tensor(0.5646, dtype=torch.float64)
15 gae_duplicate tensor(1.3991, dtype=torch.float64) tensor(-14.1859, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7452, dtype=torch.float64) delta_t tensor(0.4904, dtype=torch.float64)
14 gae_duplicate tensor(1.5745, dtype=torch.float64) tensor(-13.8874, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7152, dtype=torch.float64) delta_t tensor(0.5166, dtype=torch.float64)
13 gae_duplicate tensor(1.7688, dtype=torch.float64) tensor(-12.4842, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6597, dtype=torch.float64) delta_t tensor(0.4156, dtype=torch.float64)
12 gae_duplicate tensor(1.6955, dtype=torch.float64) tensor(-8.5560, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6359, dtype=torch.float64) delta_t tensor(0.6112, dtype=torch.float64)
11 gae_duplicate tensor(1.5169, dtype=torch.float64) tensor(-23.8623, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2083, dtype=torch.float64) delta_t tensor(0.0915, dtype=torch.float64)
10 gae_duplicate tensor(0.5925, dtype=torch.float64) tensor(-17.0344, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0910, dtype=torch.float64) delta_t tensor(-0.0109, dtype=torch.float64)
9 gae_duplicate tensor(-1.0983, dtype=torch.float64) tensor(-11.9294, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3384, dtype=torch.float64) delta_t tensor(-0.5065, dtype=torch.float64)
8 gae_duplicate tensor(-0.7941, dtype=torch.float64) tensor(-6.7573, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0538, dtype=torch.float64) delta_t tensor(-1.0551, dtype=torch.float64)
7 gae_duplicate tensor(-2.2805, dtype=torch.float64) tensor(3.8227, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2814, dtype=torch.float64) delta_t tensor(-1.3470, dtype=torch.float64)
6 gae_duplicate tensor(-3.7311, dtype=torch.float64) tensor(15.9084, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9698, dtype=torch.float64) delta_t tensor(-1.0745, dtype=torch.float64)
5 gae_duplicate tensor(-4.6971, dtype=torch.float64) tensor(27.6820, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4708, dtype=torch.float64) delta_t tensor(-1.4703, dtype=torch.float64)
4 gae_duplicate tensor(-7.7045, dtype=torch.float64) tensor(40.1863, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4252, dtype=torch.float64) delta_t tensor(-0.5192, dtype=torch.float64)
3 gae_duplicate tensor(-6.2714, dtype=torch.float64) tensor(43.3258, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1906, dtype=torch.float64) delta_t tensor(-0.3327, dtype=torch.float64)
2 gae_duplicate tensor(-5.0831, dtype=torch.float64) tensor(31.9091, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1156.8272705078125
value loss:742.7355346679688
entropies:173.76600646972656
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2399.4597)
ToM Target loss= tensor(1816.9558)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.836980104446411 seconds
19 rew tensor(0.7326, dtype=torch.float64) delta_t tensor(-0.3347, dtype=torch.float64)
19 gae_duplicate tensor(-0.4560, dtype=torch.float64) tensor(4.1071, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7331, dtype=torch.float64) delta_t tensor(0.5316, dtype=torch.float64)
18 gae_duplicate tensor(0.0967, dtype=torch.float64) tensor(-2.5104, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7171, dtype=torch.float64) delta_t tensor(0.5054, dtype=torch.float64)
17 gae_duplicate tensor(0.5393, dtype=torch.float64) tensor(-2.9761, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6846, dtype=torch.float64) delta_t tensor(0.4881, dtype=torch.float64)
16 gae_duplicate tensor(0.7760, dtype=torch.float64) tensor(-6.4992, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6273, dtype=torch.float64) delta_t tensor(0.3782, dtype=torch.float64)
15 gae_duplicate tensor(0.7110, dtype=torch.float64) tensor(-9.4604, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5124, dtype=torch.float64) delta_t tensor(0.4181, dtype=torch.float64)
14 gae_duplicate tensor(0.1131, dtype=torch.float64) tensor(-15.8394, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6688, dtype=torch.float64) delta_t tensor(0.4998, dtype=torch.float64)
13 gae_duplicate tensor(0.6103, dtype=torch.float64) tensor(-11.7747, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0529, dtype=torch.float64) delta_t tensor(-0.0885, dtype=torch.float64)
12 gae_duplicate tensor(-1.4789, dtype=torch.float64) tensor(-4.6753, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6298, dtype=torch.float64) delta_t tensor(0.4264, dtype=torch.float64)
11 gae_duplicate tensor(-0.4769, dtype=torch.float64) tensor(-19.2304, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4397, dtype=torch.float64) delta_t tensor(0.1948, dtype=torch.float64)
10 gae_duplicate tensor(-0.9426, dtype=torch.float64) tensor(-17.4521, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4811, dtype=torch.float64) delta_t tensor(-0.6399, dtype=torch.float64)
9 gae_duplicate tensor(-0.9601, dtype=torch.float64) tensor(0.7048, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6544, dtype=torch.float64) delta_t tensor(-0.9462, dtype=torch.float64)
8 gae_duplicate tensor(-2.5952, dtype=torch.float64) tensor(3.2970, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7929, dtype=torch.float64) delta_t tensor(-0.9293, dtype=torch.float64)
7 gae_duplicate tensor(-3.7901, dtype=torch.float64) tensor(6.9949, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9093, dtype=torch.float64) delta_t tensor(-0.9016, dtype=torch.float64)
6 gae_duplicate tensor(-5.2045, dtype=torch.float64) tensor(20.9343, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2368, dtype=torch.float64) delta_t tensor(-1.2286, dtype=torch.float64)
5 gae_duplicate tensor(-6.1434, dtype=torch.float64) tensor(35.0815, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5755, dtype=torch.float64) delta_t tensor(-2.5238, dtype=torch.float64)
4 gae_duplicate tensor(-10.4899, dtype=torch.float64) tensor(51.2655, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4890, dtype=torch.float64) delta_t tensor(-0.5341, dtype=torch.float64)
3 gae_duplicate tensor(-8.4370, dtype=torch.float64) tensor(49.6105, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1338, dtype=torch.float64) delta_t tensor(-0.3235, dtype=torch.float64)
2 gae_duplicate tensor(-6.7361, dtype=torch.float64) tensor(37.9403, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4333.25439453125
value loss:1129.2462158203125
entropies:170.05755615234375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.588438987731934 seconds
19 rew tensor(0.5028, dtype=torch.float64) delta_t tensor(-0.5703, dtype=torch.float64)
19 gae_duplicate tensor(-1.3238, dtype=torch.float64) tensor(6.5032, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6902, dtype=torch.float64) delta_t tensor(0.4510, dtype=torch.float64)
18 gae_duplicate tensor(-0.4279, dtype=torch.float64) tensor(-0.4338, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6694, dtype=torch.float64) delta_t tensor(0.4618, dtype=torch.float64)
17 gae_duplicate tensor(-0.0356, dtype=torch.float64) tensor(-3.2145, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6046, dtype=torch.float64) delta_t tensor(0.4658, dtype=torch.float64)
16 gae_duplicate tensor(-0.0517, dtype=torch.float64) tensor(-8.4370, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4597, dtype=torch.float64) delta_t tensor(0.4197, dtype=torch.float64)
15 gae_duplicate tensor(-0.3119, dtype=torch.float64) tensor(-7.7141, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5666, dtype=torch.float64) delta_t tensor(0.3605, dtype=torch.float64)
14 gae_duplicate tensor(0.2252, dtype=torch.float64) tensor(-10.1181, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6608, dtype=torch.float64) delta_t tensor(0.4250, dtype=torch.float64)
13 gae_duplicate tensor(0.7531, dtype=torch.float64) tensor(-12.2528, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7362, dtype=torch.float64) delta_t tensor(0.5729, dtype=torch.float64)
12 gae_duplicate tensor(1.0975, dtype=torch.float64) tensor(-17.8003, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7437, dtype=torch.float64) delta_t tensor(0.5384, dtype=torch.float64)
11 gae_duplicate tensor(1.4258, dtype=torch.float64) tensor(-12.8611, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3212, dtype=torch.float64) delta_t tensor(-0.7321, dtype=torch.float64)
10 gae_duplicate tensor(-2.3012, dtype=torch.float64) tensor(-6.1939, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3770, dtype=torch.float64) delta_t tensor(-0.5132, dtype=torch.float64)
9 gae_duplicate tensor(-1.4960, dtype=torch.float64) tensor(0.3414, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9875, dtype=torch.float64) delta_t tensor(-1.0760, dtype=torch.float64)
8 gae_duplicate tensor(-2.8411, dtype=torch.float64) tensor(12.8487, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5573, dtype=torch.float64) delta_t tensor(-0.5777, dtype=torch.float64)
7 gae_duplicate tensor(-3.8279, dtype=torch.float64) tensor(14.6742, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8330, dtype=torch.float64) delta_t tensor(-1.0471, dtype=torch.float64)
6 gae_duplicate tensor(-5.1281, dtype=torch.float64) tensor(36.5937, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1969, dtype=torch.float64) delta_t tensor(-1.1696, dtype=torch.float64)
5 gae_duplicate tensor(-4.1525, dtype=torch.float64) tensor(37.0095, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7249, dtype=torch.float64) delta_t tensor(-1.6290, dtype=torch.float64)
4 gae_duplicate tensor(-9.3484, dtype=torch.float64) tensor(51.7557, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0866, dtype=torch.float64) delta_t tensor(-0.0546, dtype=torch.float64)
3 gae_duplicate tensor(-7.2907, dtype=torch.float64) tensor(37.8654, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2312, dtype=torch.float64) delta_t tensor(-0.4214, dtype=torch.float64)
2 gae_duplicate tensor(-5.7832, dtype=torch.float64) tensor(24.0416, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5164.5439453125
value loss:850.5867919921875
entropies:170.37001037597656
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.923699140548706 seconds
19 rew tensor(0.7316, dtype=torch.float64) delta_t tensor(-0.2895, dtype=torch.float64)
19 gae_duplicate tensor(-0.5301, dtype=torch.float64) tensor(3.6166, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7155, dtype=torch.float64) delta_t tensor(0.5040, dtype=torch.float64)
18 gae_duplicate tensor(-0.0986, dtype=torch.float64) tensor(-1.6851, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6993, dtype=torch.float64) delta_t tensor(0.5006, dtype=torch.float64)
17 gae_duplicate tensor(0.2488, dtype=torch.float64) tensor(-5.1711, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6498, dtype=torch.float64) delta_t tensor(0.5908, dtype=torch.float64)
16 gae_duplicate tensor(0.2759, dtype=torch.float64) tensor(-8.9706, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5754, dtype=torch.float64) delta_t tensor(0.4277, dtype=torch.float64)
15 gae_duplicate tensor(-0.1707, dtype=torch.float64) tensor(-15.4033, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6554, dtype=torch.float64) delta_t tensor(0.5501, dtype=torch.float64)
14 gae_duplicate tensor(0.7095, dtype=torch.float64) tensor(-15.3872, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6478, dtype=torch.float64) delta_t tensor(0.3826, dtype=torch.float64)
13 gae_duplicate tensor(0.9961, dtype=torch.float64) tensor(-18.7059, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6161, dtype=torch.float64) delta_t tensor(0.6045, dtype=torch.float64)
12 gae_duplicate tensor(1.0099, dtype=torch.float64) tensor(-25.2617, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5633, dtype=torch.float64) delta_t tensor(0.2683, dtype=torch.float64)
11 gae_duplicate tensor(0.5266, dtype=torch.float64) tensor(-15.4123, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0800, dtype=torch.float64) delta_t tensor(-0.0591, dtype=torch.float64)
10 gae_duplicate tensor(-0.2252, dtype=torch.float64) tensor(-15.8897, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0260, dtype=torch.float64) delta_t tensor(-0.0486, dtype=torch.float64)
9 gae_duplicate tensor(-1.6021, dtype=torch.float64) tensor(-9.9533, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5823, dtype=torch.float64) delta_t tensor(-0.7148, dtype=torch.float64)
8 gae_duplicate tensor(-1.7811, dtype=torch.float64) tensor(-4.7780, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5694, dtype=torch.float64) delta_t tensor(-0.6013, dtype=torch.float64)
7 gae_duplicate tensor(-2.4806, dtype=torch.float64) tensor(4.5018, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3670, dtype=torch.float64) delta_t tensor(-0.4699, dtype=torch.float64)
6 gae_duplicate tensor(-2.6372, dtype=torch.float64) tensor(16.2604, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8246, dtype=torch.float64) delta_t tensor(-0.8676, dtype=torch.float64)
5 gae_duplicate tensor(-2.8654, dtype=torch.float64) tensor(8.9553, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0460, dtype=torch.float64) delta_t tensor(-0.9371, dtype=torch.float64)
4 gae_duplicate tensor(-8.6452, dtype=torch.float64) tensor(17.6183, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3241, dtype=torch.float64) delta_t tensor(-0.4316, dtype=torch.float64)
3 gae_duplicate tensor(-7.0953, dtype=torch.float64) tensor(28.1915, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0597, dtype=torch.float64) delta_t tensor(-0.3394, dtype=torch.float64)
2 gae_duplicate tensor(-5.7324, dtype=torch.float64) tensor(13.0320, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1568.9498291015625
value loss:571.7609252929688
entropies:172.04296875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.8942787647247314 seconds
19 rew tensor(0.6438, dtype=torch.float64) delta_t tensor(-0.4728, dtype=torch.float64)
19 gae_duplicate tensor(-0.9759, dtype=torch.float64) tensor(5.2823, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5688, dtype=torch.float64) delta_t tensor(0.3314, dtype=torch.float64)
18 gae_duplicate tensor(-1.0814, dtype=torch.float64) tensor(-0.2781, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3874, dtype=torch.float64) delta_t tensor(0.2182, dtype=torch.float64)
17 gae_duplicate tensor(-1.6885, dtype=torch.float64) tensor(2.1801, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6107, dtype=torch.float64) delta_t tensor(0.4022, dtype=torch.float64)
16 gae_duplicate tensor(-0.7791, dtype=torch.float64) tensor(-3.4173, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4936, dtype=torch.float64) delta_t tensor(0.2614, dtype=torch.float64)
15 gae_duplicate tensor(-0.7971, dtype=torch.float64) tensor(-0.6589, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7276, dtype=torch.float64) delta_t tensor(0.6190, dtype=torch.float64)
14 gae_duplicate tensor(-0.0393, dtype=torch.float64) tensor(-15.7827, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7288, dtype=torch.float64) delta_t tensor(0.5200, dtype=torch.float64)
13 gae_duplicate tensor(0.5674, dtype=torch.float64) tensor(-10.8325, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6973, dtype=torch.float64) delta_t tensor(0.4040, dtype=torch.float64)
12 gae_duplicate tensor(0.8063, dtype=torch.float64) tensor(-15.0251, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6882, dtype=torch.float64) delta_t tensor(0.6291, dtype=torch.float64)
11 gae_duplicate tensor(1.0570, dtype=torch.float64) tensor(-17.0159, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6785, dtype=torch.float64) delta_t tensor(0.5058, dtype=torch.float64)
10 gae_duplicate tensor(1.3516, dtype=torch.float64) tensor(-11.7609, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2890, dtype=torch.float64) delta_t tensor(-0.6012, dtype=torch.float64)
9 gae_duplicate tensor(-0.1518, dtype=torch.float64) tensor(-5.8434, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6719, dtype=torch.float64) delta_t tensor(-0.7110, dtype=torch.float64)
8 gae_duplicate tensor(-1.1562, dtype=torch.float64) tensor(-3.3359, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8210, dtype=torch.float64) delta_t tensor(-0.9406, dtype=torch.float64)
7 gae_duplicate tensor(-2.3088, dtype=torch.float64) tensor(4.6271, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2259, dtype=torch.float64) delta_t tensor(-1.2721, dtype=torch.float64)
6 gae_duplicate tensor(-3.8435, dtype=torch.float64) tensor(16.9050, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6677, dtype=torch.float64) delta_t tensor(-1.7994, dtype=torch.float64)
5 gae_duplicate tensor(-5.9751, dtype=torch.float64) tensor(31.5888, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6135, dtype=torch.float64) delta_t tensor(-0.5105, dtype=torch.float64)
4 gae_duplicate tensor(-6.3890, dtype=torch.float64) tensor(22.8253, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3394, dtype=torch.float64) delta_t tensor(-0.3227, dtype=torch.float64)
3 gae_duplicate tensor(-5.1766, dtype=torch.float64) tensor(30.9150, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2310, dtype=torch.float64) delta_t tensor(-0.3680, dtype=torch.float64)
2 gae_duplicate tensor(-4.3723, dtype=torch.float64) tensor(28.7384, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2157.7041015625
value loss:711.1546630859375
entropies:164.99554443359375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.97228479385376 seconds
19 rew tensor(0.7286, dtype=torch.float64) delta_t tensor(-0.3146, dtype=torch.float64)
19 gae_duplicate tensor(-0.5008, dtype=torch.float64) tensor(3.4618, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7363, dtype=torch.float64) delta_t tensor(0.5298, dtype=torch.float64)
18 gae_duplicate tensor(0.1075, dtype=torch.float64) tensor(-2.6319, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7368, dtype=torch.float64) delta_t tensor(0.5209, dtype=torch.float64)
17 gae_duplicate tensor(0.5544, dtype=torch.float64) tensor(-5.8317, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7373, dtype=torch.float64) delta_t tensor(0.5653, dtype=torch.float64)
16 gae_duplicate tensor(0.9124, dtype=torch.float64) tensor(-10.8744, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7378, dtype=torch.float64) delta_t tensor(0.5391, dtype=torch.float64)
15 gae_duplicate tensor(1.1647, dtype=torch.float64) tensor(-19.5449, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7382, dtype=torch.float64) delta_t tensor(0.4548, dtype=torch.float64)
14 gae_duplicate tensor(1.4292, dtype=torch.float64) tensor(-8.4345, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7387, dtype=torch.float64) delta_t tensor(0.5271, dtype=torch.float64)
13 gae_duplicate tensor(1.6135, dtype=torch.float64) tensor(-17.9886, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5969, dtype=torch.float64) delta_t tensor(0.5835, dtype=torch.float64)
12 gae_duplicate tensor(1.6255, dtype=torch.float64) tensor(-15.5094, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7182, dtype=torch.float64) delta_t tensor(0.6057, dtype=torch.float64)
11 gae_duplicate tensor(1.6585, dtype=torch.float64) tensor(-22.1859, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7115, dtype=torch.float64) delta_t tensor(0.4949, dtype=torch.float64)
10 gae_duplicate tensor(1.7980, dtype=torch.float64) tensor(-19.5404, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3241, dtype=torch.float64) delta_t tensor(0.0883, dtype=torch.float64)
9 gae_duplicate tensor(1.3355, dtype=torch.float64) tensor(-17.4763, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3108, dtype=torch.float64) delta_t tensor(-0.5197, dtype=torch.float64)
8 gae_duplicate tensor(-0.1682, dtype=torch.float64) tensor(-7.4340, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8479, dtype=torch.float64) delta_t tensor(-0.8360, dtype=torch.float64)
7 gae_duplicate tensor(-1.9745, dtype=torch.float64) tensor(-2.6058, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7858, dtype=torch.float64) delta_t tensor(-0.8327, dtype=torch.float64)
6 gae_duplicate tensor(-4.1389, dtype=torch.float64) tensor(6.6678, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6317, dtype=torch.float64) delta_t tensor(-1.4925, dtype=torch.float64)
5 gae_duplicate tensor(-5.8247, dtype=torch.float64) tensor(13.7364, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4241, dtype=torch.float64) delta_t tensor(-3.5000, dtype=torch.float64)
4 gae_duplicate tensor(-13.2876, dtype=torch.float64) tensor(30.0784, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4773, dtype=torch.float64) delta_t tensor(-0.4740, dtype=torch.float64)
3 gae_duplicate tensor(-10.4490, dtype=torch.float64) tensor(42.0933, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3001, dtype=torch.float64) delta_t tensor(-0.4607, dtype=torch.float64)
2 gae_duplicate tensor(-8.5905, dtype=torch.float64) tensor(48.5775, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:166.46429443359375
value loss:1414.739013671875
entropies:163.71356201171875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2367.4102)
ToM Target loss= tensor(1815.2052)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.758082628250122 seconds
19 rew tensor(0.7217, dtype=torch.float64) delta_t tensor(-0.3227, dtype=torch.float64)
19 gae_duplicate tensor(-0.6104, dtype=torch.float64) tensor(1.0421, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7065, dtype=torch.float64) delta_t tensor(0.4988, dtype=torch.float64)
18 gae_duplicate tensor(-0.1455, dtype=torch.float64) tensor(-1.8471, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6688, dtype=torch.float64) delta_t tensor(0.2737, dtype=torch.float64)
17 gae_duplicate tensor(0.1326, dtype=torch.float64) tensor(-2.2469, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5837, dtype=torch.float64) delta_t tensor(0.5112, dtype=torch.float64)
16 gae_duplicate tensor(0.1445, dtype=torch.float64) tensor(-13.4100, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4694, dtype=torch.float64) delta_t tensor(0.3525, dtype=torch.float64)
15 gae_duplicate tensor(-0.0593, dtype=torch.float64) tensor(-6.3617, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5691, dtype=torch.float64) delta_t tensor(0.4411, dtype=torch.float64)
14 gae_duplicate tensor(0.3608, dtype=torch.float64) tensor(-18.0624, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6883, dtype=torch.float64) delta_t tensor(0.6639, dtype=torch.float64)
13 gae_duplicate tensor(0.9830, dtype=torch.float64) tensor(-23.1435, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6509, dtype=torch.float64) delta_t tensor(0.4267, dtype=torch.float64)
12 gae_duplicate tensor(1.3872, dtype=torch.float64) tensor(-13.2535, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6013, dtype=torch.float64) delta_t tensor(0.4104, dtype=torch.float64)
11 gae_duplicate tensor(1.3618, dtype=torch.float64) tensor(-16.9984, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0347, dtype=torch.float64) delta_t tensor(-0.1153, dtype=torch.float64)
10 gae_duplicate tensor(-0.5996, dtype=torch.float64) tensor(-14.5566, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0610, dtype=torch.float64) delta_t tensor(-0.3150, dtype=torch.float64)
9 gae_duplicate tensor(-0.0460, dtype=torch.float64) tensor(-10.7842, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0060, dtype=torch.float64) delta_t tensor(-0.0763, dtype=torch.float64)
8 gae_duplicate tensor(-0.3673, dtype=torch.float64) tensor(-4.5506, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3786, dtype=torch.float64) delta_t tensor(-0.3994, dtype=torch.float64)
7 gae_duplicate tensor(-1.4302, dtype=torch.float64) tensor(-0.7691, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8367, dtype=torch.float64) delta_t tensor(-0.9541, dtype=torch.float64)
6 gae_duplicate tensor(-2.5610, dtype=torch.float64) tensor(7.2199, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4787, dtype=torch.float64) delta_t tensor(-1.4636, dtype=torch.float64)
5 gae_duplicate tensor(-3.9978, dtype=torch.float64) tensor(11.1849, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2259, dtype=torch.float64) delta_t tensor(-1.1220, dtype=torch.float64)
4 gae_duplicate tensor(-7.1433, dtype=torch.float64) tensor(18.1902, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0758, dtype=torch.float64) delta_t tensor(-0.1060, dtype=torch.float64)
3 gae_duplicate tensor(-5.7024, dtype=torch.float64) tensor(37.6139, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3046, dtype=torch.float64) delta_t tensor(-0.5107, dtype=torch.float64)
2 gae_duplicate tensor(-4.7891, dtype=torch.float64) tensor(36.7320, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:474.6500244140625
value loss:567.8276977539062
entropies:163.23609924316406
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.679293155670166 seconds
19 rew tensor(0.7003, dtype=torch.float64) delta_t tensor(-0.2453, dtype=torch.float64)
19 gae_duplicate tensor(-0.6932, dtype=torch.float64) tensor(0.7288, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6724, dtype=torch.float64) delta_t tensor(0.3112, dtype=torch.float64)
18 gae_duplicate tensor(-0.4529, dtype=torch.float64) tensor(-2.4953, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6015, dtype=torch.float64) delta_t tensor(0.4267, dtype=torch.float64)
17 gae_duplicate tensor(-0.6395, dtype=torch.float64) tensor(-4.7587, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4659, dtype=torch.float64) delta_t tensor(0.3640, dtype=torch.float64)
16 gae_duplicate tensor(-1.0526, dtype=torch.float64) tensor(-6.7286, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6402, dtype=torch.float64) delta_t tensor(0.5172, dtype=torch.float64)
15 gae_duplicate tensor(-0.3376, dtype=torch.float64) tensor(-11.1935, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5871, dtype=torch.float64) delta_t tensor(0.4578, dtype=torch.float64)
14 gae_duplicate tensor(0.0812, dtype=torch.float64) tensor(-7.7326, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7170, dtype=torch.float64) delta_t tensor(0.5618, dtype=torch.float64)
13 gae_duplicate tensor(0.5535, dtype=torch.float64) tensor(-13.4616, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6756, dtype=torch.float64) delta_t tensor(0.4626, dtype=torch.float64)
12 gae_duplicate tensor(0.9766, dtype=torch.float64) tensor(-19.4584, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6541, dtype=torch.float64) delta_t tensor(0.5522, dtype=torch.float64)
11 gae_duplicate tensor(0.9879, dtype=torch.float64) tensor(-19.5621, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7130, dtype=torch.float64) delta_t tensor(-0.9420, dtype=torch.float64)
10 gae_duplicate tensor(-3.9362, dtype=torch.float64) tensor(-10.0584, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9329, dtype=torch.float64) delta_t tensor(-0.8321, dtype=torch.float64)
9 gae_duplicate tensor(-5.5566, dtype=torch.float64) tensor(11.6048, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2294, dtype=torch.float64) delta_t tensor(-0.4405, dtype=torch.float64)
8 gae_duplicate tensor(-4.4545, dtype=torch.float64) tensor(21.8844, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0034, dtype=torch.float64) delta_t tensor(0.0305, dtype=torch.float64)
7 gae_duplicate tensor(-3.5721, dtype=torch.float64) tensor(5.5658, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1041, dtype=torch.float64) delta_t tensor(-0.2127, dtype=torch.float64)
6 gae_duplicate tensor(-2.3806, dtype=torch.float64) tensor(5.5439, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9686, dtype=torch.float64) delta_t tensor(-0.9673, dtype=torch.float64)
5 gae_duplicate tensor(-3.0265, dtype=torch.float64) tensor(11.6369, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2037, dtype=torch.float64) delta_t tensor(-1.1131, dtype=torch.float64)
4 gae_duplicate tensor(-7.8343, dtype=torch.float64) tensor(19.8534, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2402, dtype=torch.float64) delta_t tensor(-0.2802, dtype=torch.float64)
3 gae_duplicate tensor(-6.3997, dtype=torch.float64) tensor(30.1177, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3144, dtype=torch.float64) delta_t tensor(-0.5376, dtype=torch.float64)
2 gae_duplicate tensor(-5.3893, dtype=torch.float64) tensor(11.8231, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-868.996826171875
value loss:662.186767578125
entropies:165.84434509277344
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.690945148468018 seconds
19 rew tensor(0.7059, dtype=torch.float64) delta_t tensor(-0.4433, dtype=torch.float64)
19 gae_duplicate tensor(-0.6678, dtype=torch.float64) tensor(3.9841, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6817, dtype=torch.float64) delta_t tensor(0.4574, dtype=torch.float64)
18 gae_duplicate tensor(-0.3463, dtype=torch.float64) tensor(-0.6077, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6266, dtype=torch.float64) delta_t tensor(0.4341, dtype=torch.float64)
17 gae_duplicate tensor(-0.2688, dtype=torch.float64) tensor(-4.2907, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5320, dtype=torch.float64) delta_t tensor(0.3680, dtype=torch.float64)
16 gae_duplicate tensor(-0.4988, dtype=torch.float64) tensor(-8.8881, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7382, dtype=torch.float64) delta_t tensor(0.5401, dtype=torch.float64)
15 gae_duplicate tensor(0.2223, dtype=torch.float64) tensor(-8.6265, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7315, dtype=torch.float64) delta_t tensor(0.7104, dtype=torch.float64)
14 gae_duplicate tensor(0.7996, dtype=torch.float64) tensor(-13.4208, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7317, dtype=torch.float64) delta_t tensor(0.6386, dtype=torch.float64)
13 gae_duplicate tensor(1.2619, dtype=torch.float64) tensor(-15.3054, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7395, dtype=torch.float64) delta_t tensor(0.6732, dtype=torch.float64)
12 gae_duplicate tensor(1.6323, dtype=torch.float64) tensor(-21.8507, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0645, dtype=torch.float64) delta_t tensor(-0.0918, dtype=torch.float64)
11 gae_duplicate tensor(-0.8924, dtype=torch.float64) tensor(-15.2367, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5911, dtype=torch.float64) delta_t tensor(0.5210, dtype=torch.float64)
10 gae_duplicate tensor(-0.2484, dtype=torch.float64) tensor(-22.6461, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1047, dtype=torch.float64) delta_t tensor(-0.1201, dtype=torch.float64)
9 gae_duplicate tensor(-0.1617, dtype=torch.float64) tensor(-12.2458, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2131, dtype=torch.float64) delta_t tensor(-0.2943, dtype=torch.float64)
8 gae_duplicate tensor(-1.2304, dtype=torch.float64) tensor(-4.8119, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5560, dtype=torch.float64) delta_t tensor(-0.4133, dtype=torch.float64)
7 gae_duplicate tensor(-1.0363, dtype=torch.float64) tensor(-0.9668, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9596, dtype=torch.float64) delta_t tensor(-1.0428, dtype=torch.float64)
6 gae_duplicate tensor(-3.2932, dtype=torch.float64) tensor(8.1170, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0063, dtype=torch.float64) delta_t tensor(-1.0332, dtype=torch.float64)
5 gae_duplicate tensor(-5.0676, dtype=torch.float64) tensor(15.8934, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7798, dtype=torch.float64) delta_t tensor(-0.7929, dtype=torch.float64)
4 gae_duplicate tensor(-7.8218, dtype=torch.float64) tensor(15.8536, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8874, dtype=torch.float64) delta_t tensor(-0.9249, dtype=torch.float64)
3 gae_duplicate tensor(-6.5460, dtype=torch.float64) tensor(16.4783, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2047, dtype=torch.float64) delta_t tensor(-0.4301, dtype=torch.float64)
2 gae_duplicate tensor(-5.5988, dtype=torch.float64) tensor(34.0642, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1212.4134521484375
value loss:613.754638671875
entropies:165.70327758789062
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.767154932022095 seconds
19 rew tensor(0.7374, dtype=torch.float64) delta_t tensor(-0.2911, dtype=torch.float64)
19 gae_duplicate tensor(-0.4803, dtype=torch.float64) tensor(1.6198, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7378, dtype=torch.float64) delta_t tensor(0.4787, dtype=torch.float64)
18 gae_duplicate tensor(0.0545, dtype=torch.float64) tensor(-2.2020, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7382, dtype=torch.float64) delta_t tensor(0.4556, dtype=torch.float64)
17 gae_duplicate tensor(0.5214, dtype=torch.float64) tensor(-9.5869, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7387, dtype=torch.float64) delta_t tensor(0.6454, dtype=torch.float64)
16 gae_duplicate tensor(0.8693, dtype=torch.float64) tensor(-13.8568, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7391, dtype=torch.float64) delta_t tensor(0.7552, dtype=torch.float64)
15 gae_duplicate tensor(1.1561, dtype=torch.float64) tensor(-17.2132, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7396, dtype=torch.float64) delta_t tensor(0.5913, dtype=torch.float64)
14 gae_duplicate tensor(1.3976, dtype=torch.float64) tensor(-18.1509, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7400, dtype=torch.float64) delta_t tensor(0.5919, dtype=torch.float64)
13 gae_duplicate tensor(1.6290, dtype=torch.float64) tensor(-17.3870, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6037, dtype=torch.float64) delta_t tensor(0.3875, dtype=torch.float64)
12 gae_duplicate tensor(1.7768, dtype=torch.float64) tensor(-17.4657, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4892, dtype=torch.float64) delta_t tensor(0.1839, dtype=torch.float64)
11 gae_duplicate tensor(1.2647, dtype=torch.float64) tensor(-15.2333, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4256, dtype=torch.float64) delta_t tensor(0.3106, dtype=torch.float64)
10 gae_duplicate tensor(0.5675, dtype=torch.float64) tensor(-20.0067, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1508, dtype=torch.float64) delta_t tensor(0.0747, dtype=torch.float64)
9 gae_duplicate tensor(1.0108, dtype=torch.float64) tensor(-10.9260, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0314, dtype=torch.float64) delta_t tensor(-0.0096, dtype=torch.float64)
8 gae_duplicate tensor(-0.5568, dtype=torch.float64) tensor(-19.1679, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5140, dtype=torch.float64) delta_t tensor(-0.5242, dtype=torch.float64)
7 gae_duplicate tensor(-2.6067, dtype=torch.float64) tensor(-3.4504, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9747, dtype=torch.float64) delta_t tensor(-1.0051, dtype=torch.float64)
6 gae_duplicate tensor(-4.6025, dtype=torch.float64) tensor(6.0065, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5681, dtype=torch.float64) delta_t tensor(-0.6342, dtype=torch.float64)
5 gae_duplicate tensor(-5.1605, dtype=torch.float64) tensor(15.1172, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4482, dtype=torch.float64) delta_t tensor(-1.4457, dtype=torch.float64)
4 gae_duplicate tensor(-6.5409, dtype=torch.float64) tensor(22.8728, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2812, dtype=torch.float64) delta_t tensor(-0.1904, dtype=torch.float64)
3 gae_duplicate tensor(-5.1662, dtype=torch.float64) tensor(31.3040, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5230, dtype=torch.float64) delta_t tensor(-0.7056, dtype=torch.float64)
2 gae_duplicate tensor(-4.2585, dtype=torch.float64) tensor(32.9737, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1941.76123046875
value loss:580.3366088867188
entropies:162.98086547851562
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.139274835586548 seconds
19 rew tensor(0.7286, dtype=torch.float64) delta_t tensor(-0.2491, dtype=torch.float64)
19 gae_duplicate tensor(-0.5506, dtype=torch.float64) tensor(2.4628, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7138, dtype=torch.float64) delta_t tensor(0.4098, dtype=torch.float64)
18 gae_duplicate tensor(-0.1567, dtype=torch.float64) tensor(-1.8261, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6913, dtype=torch.float64) delta_t tensor(0.5260, dtype=torch.float64)
17 gae_duplicate tensor(0.2587, dtype=torch.float64) tensor(-7.2014, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6460, dtype=torch.float64) delta_t tensor(0.5266, dtype=torch.float64)
16 gae_duplicate tensor(0.2859, dtype=torch.float64) tensor(-14.8027, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5701, dtype=torch.float64) delta_t tensor(0.4291, dtype=torch.float64)
15 gae_duplicate tensor(0.0892, dtype=torch.float64) tensor(-11.8362, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7381, dtype=torch.float64) delta_t tensor(0.5366, dtype=torch.float64)
14 gae_duplicate tensor(0.6755, dtype=torch.float64) tensor(-14.5715, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7386, dtype=torch.float64) delta_t tensor(0.7365, dtype=torch.float64)
13 gae_duplicate tensor(1.1450, dtype=torch.float64) tensor(-11.5025, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7390, dtype=torch.float64) delta_t tensor(0.5392, dtype=torch.float64)
12 gae_duplicate tensor(1.5210, dtype=torch.float64) tensor(-24.4522, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.6191, dtype=torch.float64) delta_t tensor(-1.7499, dtype=torch.float64)
11 gae_duplicate tensor(-5.1220, dtype=torch.float64) tensor(5.6218, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0541, dtype=torch.float64) delta_t tensor(-0.2907, dtype=torch.float64)
10 gae_duplicate tensor(-4.5943, dtype=torch.float64) tensor(-6.8943, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3342, dtype=torch.float64) delta_t tensor(0.2504, dtype=torch.float64)
9 gae_duplicate tensor(-3.3388, dtype=torch.float64) tensor(-2.0304, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1124, dtype=torch.float64) delta_t tensor(0.0757, dtype=torch.float64)
8 gae_duplicate tensor(-2.6579, dtype=torch.float64) tensor(-9.3282, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1471, dtype=torch.float64) delta_t tensor(-0.1043, dtype=torch.float64)
7 gae_duplicate tensor(-1.9566, dtype=torch.float64) tensor(-3.3954, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2891, dtype=torch.float64) delta_t tensor(-0.3329, dtype=torch.float64)
6 gae_duplicate tensor(-1.3296, dtype=torch.float64) tensor(2.8822, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4022, dtype=torch.float64) delta_t tensor(-0.4142, dtype=torch.float64)
5 gae_duplicate tensor(-2.2896, dtype=torch.float64) tensor(7.7849, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4244, dtype=torch.float64) delta_t tensor(-0.3650, dtype=torch.float64)
4 gae_duplicate tensor(-2.0750, dtype=torch.float64) tensor(10.0997, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4812, dtype=torch.float64) delta_t tensor(-0.5079, dtype=torch.float64)
3 gae_duplicate tensor(-2.5887, dtype=torch.float64) tensor(16.9722, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3363, dtype=torch.float64) delta_t tensor(-0.5577, dtype=torch.float64)
2 gae_duplicate tensor(-2.5025, dtype=torch.float64) tensor(11.7532, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1779.7147216796875
value loss:488.8109130859375
entropies:165.5580291748047
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2373.5435)
ToM Target loss= tensor(1815.0327)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.488607168197632 seconds
19 rew tensor(0.6899, dtype=torch.float64) delta_t tensor(-0.4065, dtype=torch.float64)
19 gae_duplicate tensor(-0.8104, dtype=torch.float64) tensor(2.7111, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6577, dtype=torch.float64) delta_t tensor(0.3821, dtype=torch.float64)
18 gae_duplicate tensor(-0.4130, dtype=torch.float64) tensor(0.3203, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5793, dtype=torch.float64) delta_t tensor(0.2463, dtype=torch.float64)
17 gae_duplicate tensor(-0.4766, dtype=torch.float64) tensor(-3.2721, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4461, dtype=torch.float64) delta_t tensor(0.3505, dtype=torch.float64)
16 gae_duplicate tensor(-0.6754, dtype=torch.float64) tensor(-7.1465, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5547, dtype=torch.float64) delta_t tensor(0.4974, dtype=torch.float64)
15 gae_duplicate tensor(-0.0659, dtype=torch.float64) tensor(-11.7985, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7165, dtype=torch.float64) delta_t tensor(0.5309, dtype=torch.float64)
14 gae_duplicate tensor(0.5255, dtype=torch.float64) tensor(-10.2352, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7029, dtype=torch.float64) delta_t tensor(0.5614, dtype=torch.float64)
13 gae_duplicate tensor(1.0283, dtype=torch.float64) tensor(-10.0198, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6723, dtype=torch.float64) delta_t tensor(0.5621, dtype=torch.float64)
12 gae_duplicate tensor(1.1440, dtype=torch.float64) tensor(-19.5154, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7077, dtype=torch.float64) delta_t tensor(0.4473, dtype=torch.float64)
11 gae_duplicate tensor(1.2655, dtype=torch.float64) tensor(-13.2672, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0654, dtype=torch.float64) delta_t tensor(-0.2508, dtype=torch.float64)
10 gae_duplicate tensor(-1.5191, dtype=torch.float64) tensor(-13.7894, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7821, dtype=torch.float64) delta_t tensor(-0.6477, dtype=torch.float64)
9 gae_duplicate tensor(-3.0287, dtype=torch.float64) tensor(-2.4755, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6638, dtype=torch.float64) delta_t tensor(-0.8880, dtype=torch.float64)
8 gae_duplicate tensor(-5.3852, dtype=torch.float64) tensor(-4.0015, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5555, dtype=torch.float64) delta_t tensor(-0.6261, dtype=torch.float64)
7 gae_duplicate tensor(-4.1041, dtype=torch.float64) tensor(4.4368, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4071, dtype=torch.float64) delta_t tensor(-0.4808, dtype=torch.float64)
6 gae_duplicate tensor(-4.2531, dtype=torch.float64) tensor(13.0518, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0138, dtype=torch.float64) delta_t tensor(-0.8898, dtype=torch.float64)
5 gae_duplicate tensor(-5.4492, dtype=torch.float64) tensor(18.3817, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1906, dtype=torch.float64) delta_t tensor(-0.1384, dtype=torch.float64)
4 gae_duplicate tensor(-6.4775, dtype=torch.float64) tensor(12.3082, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6058, dtype=torch.float64) delta_t tensor(-0.6016, dtype=torch.float64)
3 gae_duplicate tensor(-4.8637, dtype=torch.float64) tensor(14.3150, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2065, dtype=torch.float64) delta_t tensor(-0.3975, dtype=torch.float64)
2 gae_duplicate tensor(-4.3143, dtype=torch.float64) tensor(22.5000, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:240.7535400390625
value loss:595.7103271484375
entropies:161.71310424804688
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.660065174102783 seconds
19 rew tensor(0.4682, dtype=torch.float64) delta_t tensor(-0.4820, dtype=torch.float64)
19 gae_duplicate tensor(-1.3427, dtype=torch.float64) tensor(4.4022, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6753, dtype=torch.float64) delta_t tensor(0.4411, dtype=torch.float64)
18 gae_duplicate tensor(-0.7500, dtype=torch.float64) tensor(-0.1559, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5903, dtype=torch.float64) delta_t tensor(0.4005, dtype=torch.float64)
17 gae_duplicate tensor(-0.9157, dtype=torch.float64) tensor(-5.0137, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4711, dtype=torch.float64) delta_t tensor(0.2964, dtype=torch.float64)
16 gae_duplicate tensor(-1.2582, dtype=torch.float64) tensor(-1.9919, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7164, dtype=torch.float64) delta_t tensor(0.4588, dtype=torch.float64)
15 gae_duplicate tensor(-0.5756, dtype=torch.float64) tensor(-8.7723, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7019, dtype=torch.float64) delta_t tensor(0.5891, dtype=torch.float64)
14 gae_duplicate tensor(0.0909, dtype=torch.float64) tensor(-13.4903, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6625, dtype=torch.float64) delta_t tensor(0.7236, dtype=torch.float64)
13 gae_duplicate tensor(0.7307, dtype=torch.float64) tensor(-18.7392, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6638, dtype=torch.float64) delta_t tensor(0.6253, dtype=torch.float64)
12 gae_duplicate tensor(1.1229, dtype=torch.float64) tensor(-16.5682, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4336, dtype=torch.float64) delta_t tensor(0.3050, dtype=torch.float64)
11 gae_duplicate tensor(0.4553, dtype=torch.float64) tensor(-21.2376, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2465, dtype=torch.float64) delta_t tensor(0.0253, dtype=torch.float64)
10 gae_duplicate tensor(-0.0228, dtype=torch.float64) tensor(-16.4977, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3194, dtype=torch.float64) delta_t tensor(-0.3953, dtype=torch.float64)
9 gae_duplicate tensor(-0.1784, dtype=torch.float64) tensor(-4.8808, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6196, dtype=torch.float64) delta_t tensor(-0.7416, dtype=torch.float64)
8 gae_duplicate tensor(-1.6405, dtype=torch.float64) tensor(-0.1913, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9022, dtype=torch.float64) delta_t tensor(-1.0663, dtype=torch.float64)
7 gae_duplicate tensor(-3.7532, dtype=torch.float64) tensor(7.2294, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7672, dtype=torch.float64) delta_t tensor(-0.7910, dtype=torch.float64)
6 gae_duplicate tensor(-4.8233, dtype=torch.float64) tensor(8.4688, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7506, dtype=torch.float64) delta_t tensor(-0.8031, dtype=torch.float64)
5 gae_duplicate tensor(-4.8036, dtype=torch.float64) tensor(12.1572, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0140, dtype=torch.float64) delta_t tensor(-1.9383, dtype=torch.float64)
4 gae_duplicate tensor(-7.0356, dtype=torch.float64) tensor(33.7375, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2959, dtype=torch.float64) delta_t tensor(-0.2578, dtype=torch.float64)
3 gae_duplicate tensor(-5.9406, dtype=torch.float64) tensor(34.6558, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3186, dtype=torch.float64) delta_t tensor(-0.5057, dtype=torch.float64)
2 gae_duplicate tensor(-4.9191, dtype=torch.float64) tensor(33.2131, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-977.4443969726562
value loss:747.1806640625
entropies:165.22784423828125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.39812707901001 seconds
19 rew tensor(0.6540, dtype=torch.float64) delta_t tensor(-0.4841, dtype=torch.float64)
19 gae_duplicate tensor(-0.9348, dtype=torch.float64) tensor(1.6881, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5615, dtype=torch.float64) delta_t tensor(0.2032, dtype=torch.float64)
18 gae_duplicate tensor(-1.3861, dtype=torch.float64) tensor(4.7886, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3991, dtype=torch.float64) delta_t tensor(0.2712, dtype=torch.float64)
17 gae_duplicate tensor(-1.9597, dtype=torch.float64) tensor(-2.6340, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6817, dtype=torch.float64) delta_t tensor(0.4386, dtype=torch.float64)
16 gae_duplicate tensor(-1.0454, dtype=torch.float64) tensor(-1.7259, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6330, dtype=torch.float64) delta_t tensor(0.4122, dtype=torch.float64)
15 gae_duplicate tensor(-0.3672, dtype=torch.float64) tensor(-4.4794, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5399, dtype=torch.float64) delta_t tensor(0.4818, dtype=torch.float64)
14 gae_duplicate tensor(-0.1478, dtype=torch.float64) tensor(-8.0292, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6785, dtype=torch.float64) delta_t tensor(0.4163, dtype=torch.float64)
13 gae_duplicate tensor(0.3818, dtype=torch.float64) tensor(-12.6309, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6330, dtype=torch.float64) delta_t tensor(0.4177, dtype=torch.float64)
12 gae_duplicate tensor(0.6571, dtype=torch.float64) tensor(-21.1661, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6951, dtype=torch.float64) delta_t tensor(0.4621, dtype=torch.float64)
11 gae_duplicate tensor(0.8732, dtype=torch.float64) tensor(-9.3854, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6266, dtype=torch.float64) delta_t tensor(0.5612, dtype=torch.float64)
10 gae_duplicate tensor(1.5150, dtype=torch.float64) tensor(-18.7606, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0666, dtype=torch.float64) delta_t tensor(-0.3868, dtype=torch.float64)
9 gae_duplicate tensor(-0.4935, dtype=torch.float64) tensor(-10.8915, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3373, dtype=torch.float64) delta_t tensor(-0.1288, dtype=torch.float64)
8 gae_duplicate tensor(-1.6217, dtype=torch.float64) tensor(-12.9290, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9026, dtype=torch.float64) delta_t tensor(-1.0885, dtype=torch.float64)
7 gae_duplicate tensor(-3.6456, dtype=torch.float64) tensor(-1.3997, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6766, dtype=torch.float64) delta_t tensor(-0.6670, dtype=torch.float64)
6 gae_duplicate tensor(-3.8308, dtype=torch.float64) tensor(10.7111, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6578, dtype=torch.float64) delta_t tensor(-1.7403, dtype=torch.float64)
5 gae_duplicate tensor(-5.4507, dtype=torch.float64) tensor(28.3382, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0465, dtype=torch.float64) delta_t tensor(-1.9411, dtype=torch.float64)
4 gae_duplicate tensor(-8.6846, dtype=torch.float64) tensor(25.2549, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3128, dtype=torch.float64) delta_t tensor(-0.2178, dtype=torch.float64)
3 gae_duplicate tensor(-7.0659, dtype=torch.float64) tensor(25.6279, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3951, dtype=torch.float64) delta_t tensor(-0.5562, dtype=torch.float64)
2 gae_duplicate tensor(-5.9123, dtype=torch.float64) tensor(39.3269, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1170.802490234375
value loss:881.0968627929688
entropies:163.654052734375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.840457916259766 seconds
19 rew tensor(0.7390, dtype=torch.float64) delta_t tensor(-0.2116, dtype=torch.float64)
19 gae_duplicate tensor(-0.5080, dtype=torch.float64) tensor(2.1808, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7394, dtype=torch.float64) delta_t tensor(0.3951, dtype=torch.float64)
18 gae_duplicate tensor(-0.0555, dtype=torch.float64) tensor(-3.0876, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7237, dtype=torch.float64) delta_t tensor(0.6336, dtype=torch.float64)
17 gae_duplicate tensor(0.4506, dtype=torch.float64) tensor(-9.0681, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7403, dtype=torch.float64) delta_t tensor(0.6099, dtype=torch.float64)
16 gae_duplicate tensor(0.8536, dtype=torch.float64) tensor(-12.9007, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7330, dtype=torch.float64) delta_t tensor(0.5205, dtype=torch.float64)
15 gae_duplicate tensor(1.1765, dtype=torch.float64) tensor(-12.0482, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7257, dtype=torch.float64) delta_t tensor(0.5533, dtype=torch.float64)
14 gae_duplicate tensor(1.4352, dtype=torch.float64) tensor(-14.5988, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7107, dtype=torch.float64) delta_t tensor(0.5406, dtype=torch.float64)
13 gae_duplicate tensor(1.6426, dtype=torch.float64) tensor(-16.1436, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7028, dtype=torch.float64) delta_t tensor(0.3674, dtype=torch.float64)
12 gae_duplicate tensor(1.5445, dtype=torch.float64) tensor(-18.5212, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3551, dtype=torch.float64) delta_t tensor(0.1349, dtype=torch.float64)
11 gae_duplicate tensor(-0.2427, dtype=torch.float64) tensor(-11.2541, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5008, dtype=torch.float64) delta_t tensor(-0.4520, dtype=torch.float64)
10 gae_duplicate tensor(-1.8958, dtype=torch.float64) tensor(-7.0226, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0832, dtype=torch.float64) delta_t tensor(0.0316, dtype=torch.float64)
9 gae_duplicate tensor(-1.2246, dtype=torch.float64) tensor(-7.5100, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4816, dtype=torch.float64) delta_t tensor(-0.6866, dtype=torch.float64)
8 gae_duplicate tensor(-3.5146, dtype=torch.float64) tensor(1.3732, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4288, dtype=torch.float64) delta_t tensor(-0.3524, dtype=torch.float64)
7 gae_duplicate tensor(-3.4015, dtype=torch.float64) tensor(7.9437, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0677, dtype=torch.float64) delta_t tensor(-0.0508, dtype=torch.float64)
6 gae_duplicate tensor(-2.5401, dtype=torch.float64) tensor(1.8792, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8707, dtype=torch.float64) delta_t tensor(-0.8299, dtype=torch.float64)
5 gae_duplicate tensor(-4.0182, dtype=torch.float64) tensor(11.4939, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5752, dtype=torch.float64) delta_t tensor(-0.5051, dtype=torch.float64)
4 gae_duplicate tensor(-6.1186, dtype=torch.float64) tensor(15.7912, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6594, dtype=torch.float64) delta_t tensor(-0.6709, dtype=torch.float64)
3 gae_duplicate tensor(-5.0490, dtype=torch.float64) tensor(21.5029, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2259, dtype=torch.float64) delta_t tensor(-0.3890, dtype=torch.float64)
2 gae_duplicate tensor(-4.0898, dtype=torch.float64) tensor(24.5823, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:884.159423828125
value loss:487.7528381347656
entropies:169.54083251953125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.817685842514038 seconds
19 rew tensor(0.7157, dtype=torch.float64) delta_t tensor(-0.3256, dtype=torch.float64)
19 gae_duplicate tensor(-0.7282, dtype=torch.float64) tensor(3.8681, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6929, dtype=torch.float64) delta_t tensor(0.5245, dtype=torch.float64)
18 gae_duplicate tensor(-0.1524, dtype=torch.float64) tensor(-1.3166, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6611, dtype=torch.float64) delta_t tensor(0.5213, dtype=torch.float64)
17 gae_duplicate tensor(0.1810, dtype=torch.float64) tensor(-5.6309, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5819, dtype=torch.float64) delta_t tensor(0.3480, dtype=torch.float64)
16 gae_duplicate tensor(0.0564, dtype=torch.float64) tensor(-13.4692, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4935, dtype=torch.float64) delta_t tensor(0.2678, dtype=torch.float64)
15 gae_duplicate tensor(-0.2196, dtype=torch.float64) tensor(-7.5176, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5610, dtype=torch.float64) delta_t tensor(0.3163, dtype=torch.float64)
14 gae_duplicate tensor(0.2834, dtype=torch.float64) tensor(-16.1295, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7088, dtype=torch.float64) delta_t tensor(0.5870, dtype=torch.float64)
13 gae_duplicate tensor(0.7861, dtype=torch.float64) tensor(-15.1705, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7415, dtype=torch.float64) delta_t tensor(0.7273, dtype=torch.float64)
12 gae_duplicate tensor(1.2142, dtype=torch.float64) tensor(-13.5112, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1134, dtype=torch.float64) delta_t tensor(-0.3479, dtype=torch.float64)
11 gae_duplicate tensor(-1.8575, dtype=torch.float64) tensor(-8.7299, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3499, dtype=torch.float64) delta_t tensor(0.1672, dtype=torch.float64)
10 gae_duplicate tensor(-1.0813, dtype=torch.float64) tensor(-13.1876, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1333, dtype=torch.float64) delta_t tensor(-1.3847, dtype=torch.float64)
9 gae_duplicate tensor(-3.4719, dtype=torch.float64) tensor(4.4000, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0420, dtype=torch.float64) delta_t tensor(-0.0923, dtype=torch.float64)
8 gae_duplicate tensor(-2.7166, dtype=torch.float64) tensor(11.0297, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4473, dtype=torch.float64) delta_t tensor(-0.3014, dtype=torch.float64)
7 gae_duplicate tensor(-2.1465, dtype=torch.float64) tensor(5.6972, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4158, dtype=torch.float64) delta_t tensor(-0.4267, dtype=torch.float64)
6 gae_duplicate tensor(-3.8190, dtype=torch.float64) tensor(9.6071, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0987, dtype=torch.float64) delta_t tensor(-1.0939, dtype=torch.float64)
5 gae_duplicate tensor(-4.2635, dtype=torch.float64) tensor(11.8469, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7962, dtype=torch.float64) delta_t tensor(-0.7466, dtype=torch.float64)
4 gae_duplicate tensor(-6.8510, dtype=torch.float64) tensor(25.8301, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4212, dtype=torch.float64) delta_t tensor(-0.4842, dtype=torch.float64)
3 gae_duplicate tensor(-5.6906, dtype=torch.float64) tensor(16.9668, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1217, dtype=torch.float64) delta_t tensor(-0.2642, dtype=torch.float64)
2 gae_duplicate tensor(-4.5658, dtype=torch.float64) tensor(10.9724, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-230.67742919921875
value loss:509.3884582519531
entropies:170.52418518066406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2304.0405)
ToM Target loss= tensor(1812.1962)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.02423095703125 seconds
19 rew tensor(0.6578, dtype=torch.float64) delta_t tensor(-0.4508, dtype=torch.float64)
19 gae_duplicate tensor(-0.7450, dtype=torch.float64) tensor(3.9739, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6035, dtype=torch.float64) delta_t tensor(0.4057, dtype=torch.float64)
18 gae_duplicate tensor(-0.4629, dtype=torch.float64) tensor(-0.4977, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4605, dtype=torch.float64) delta_t tensor(0.1651, dtype=torch.float64)
17 gae_duplicate tensor(-0.7127, dtype=torch.float64) tensor(-3.3810, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1999, dtype=torch.float64) delta_t tensor(0.1637, dtype=torch.float64)
16 gae_duplicate tensor(-1.1494, dtype=torch.float64) tensor(-2.3690, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7308, dtype=torch.float64) delta_t tensor(0.5874, dtype=torch.float64)
15 gae_duplicate tensor(-0.2989, dtype=torch.float64) tensor(-6.7229, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7080, dtype=torch.float64) delta_t tensor(0.5472, dtype=torch.float64)
14 gae_duplicate tensor(0.2567, dtype=torch.float64) tensor(-8.9930, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6858, dtype=torch.float64) delta_t tensor(0.5016, dtype=torch.float64)
13 gae_duplicate tensor(0.7266, dtype=torch.float64) tensor(-15.6253, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6697, dtype=torch.float64) delta_t tensor(0.4959, dtype=torch.float64)
12 gae_duplicate tensor(1.0102, dtype=torch.float64) tensor(-19.2215, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6814, dtype=torch.float64) delta_t tensor(0.3346, dtype=torch.float64)
11 gae_duplicate tensor(0.8191, dtype=torch.float64) tensor(-15.4572, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6081, dtype=torch.float64) delta_t tensor(0.3718, dtype=torch.float64)
10 gae_duplicate tensor(1.0944, dtype=torch.float64) tensor(-18.8929, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1249, dtype=torch.float64) delta_t tensor(0.1210, dtype=torch.float64)
9 gae_duplicate tensor(-0.5722, dtype=torch.float64) tensor(-14.1976, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0130, dtype=torch.float64) delta_t tensor(-0.2666, dtype=torch.float64)
8 gae_duplicate tensor(-1.9896, dtype=torch.float64) tensor(-7.7425, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6935, dtype=torch.float64) delta_t tensor(-0.7454, dtype=torch.float64)
7 gae_duplicate tensor(-3.1994, dtype=torch.float64) tensor(4.4984, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8102, dtype=torch.float64) delta_t tensor(-0.8476, dtype=torch.float64)
6 gae_duplicate tensor(-4.3195, dtype=torch.float64) tensor(1.8021, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9557, dtype=torch.float64) delta_t tensor(-0.7341, dtype=torch.float64)
5 gae_duplicate tensor(-5.2477, dtype=torch.float64) tensor(11.1918, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7664, dtype=torch.float64) delta_t tensor(-2.8072, dtype=torch.float64)
4 gae_duplicate tensor(-9.2916, dtype=torch.float64) tensor(42.6920, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2464, dtype=torch.float64) delta_t tensor(-0.1938, dtype=torch.float64)
3 gae_duplicate tensor(-7.4623, dtype=torch.float64) tensor(30.1305, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2784, dtype=torch.float64) delta_t tensor(-0.3905, dtype=torch.float64)
2 gae_duplicate tensor(-6.1557, dtype=torch.float64) tensor(20.3724, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-86.92520141601562
value loss:905.7467651367188
entropies:170.81265258789062
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.829912185668945 seconds
19 rew tensor(0.7211, dtype=torch.float64) delta_t tensor(-0.1913, dtype=torch.float64)
19 gae_duplicate tensor(-0.6453, dtype=torch.float64) tensor(0.9774, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6816, dtype=torch.float64) delta_t tensor(0.5467, dtype=torch.float64)
18 gae_duplicate tensor(-0.2474, dtype=torch.float64) tensor(-4.6562, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6429, dtype=torch.float64) delta_t tensor(0.4739, dtype=torch.float64)
17 gae_duplicate tensor(-0.1732, dtype=torch.float64) tensor(-12.6704, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5737, dtype=torch.float64) delta_t tensor(0.3932, dtype=torch.float64)
16 gae_duplicate tensor(-0.5777, dtype=torch.float64) tensor(-9.1712, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4162, dtype=torch.float64) delta_t tensor(0.2649, dtype=torch.float64)
15 gae_duplicate tensor(-1.0121, dtype=torch.float64) tensor(-10.4192, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6183, dtype=torch.float64) delta_t tensor(0.4286, dtype=torch.float64)
14 gae_duplicate tensor(-0.2675, dtype=torch.float64) tensor(-14.3207, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7381, dtype=torch.float64) delta_t tensor(0.7294, dtype=torch.float64)
13 gae_duplicate tensor(0.3287, dtype=torch.float64) tensor(-16.4899, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6664, dtype=torch.float64) delta_t tensor(0.4094, dtype=torch.float64)
12 gae_duplicate tensor(0.8059, dtype=torch.float64) tensor(-17.3185, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6582, dtype=torch.float64) delta_t tensor(0.4216, dtype=torch.float64)
11 gae_duplicate tensor(1.1881, dtype=torch.float64) tensor(-21.1830, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5781, dtype=torch.float64) delta_t tensor(0.2317, dtype=torch.float64)
10 gae_duplicate tensor(1.1526, dtype=torch.float64) tensor(-15.7254, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3128, dtype=torch.float64) delta_t tensor(-0.5722, dtype=torch.float64)
9 gae_duplicate tensor(-0.7216, dtype=torch.float64) tensor(-9.0447, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4193, dtype=torch.float64) delta_t tensor(-0.4674, dtype=torch.float64)
8 gae_duplicate tensor(-2.0503, dtype=torch.float64) tensor(1.1953, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6995, dtype=torch.float64) delta_t tensor(-0.8048, dtype=torch.float64)
7 gae_duplicate tensor(-3.1150, dtype=torch.float64) tensor(4.7097, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3054, dtype=torch.float64) delta_t tensor(-1.1371, dtype=torch.float64)
6 gae_duplicate tensor(-3.8080, dtype=torch.float64) tensor(12.9313, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.4199, dtype=torch.float64) delta_t tensor(-2.4357, dtype=torch.float64)
5 gae_duplicate tensor(-5.3113, dtype=torch.float64) tensor(40.6789, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7719, dtype=torch.float64) delta_t tensor(-2.7178, dtype=torch.float64)
4 gae_duplicate tensor(-9.3226, dtype=torch.float64) tensor(55.7106, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2156, dtype=torch.float64) delta_t tensor(-0.1630, dtype=torch.float64)
3 gae_duplicate tensor(-7.4880, dtype=torch.float64) tensor(48.3485, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1803, dtype=torch.float64) delta_t tensor(-0.2356, dtype=torch.float64)
2 gae_duplicate tensor(-5.9523, dtype=torch.float64) tensor(42.5855, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2772.1064453125
value loss:1226.5609130859375
entropies:173.0340576171875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.020927906036377 seconds
19 rew tensor(0.6780, dtype=torch.float64) delta_t tensor(-0.5005, dtype=torch.float64)
19 gae_duplicate tensor(-0.7516, dtype=torch.float64) tensor(4.8112, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6416, dtype=torch.float64) delta_t tensor(0.5100, dtype=torch.float64)
18 gae_duplicate tensor(-0.8505, dtype=torch.float64) tensor(-0.9468, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5462, dtype=torch.float64) delta_t tensor(0.4280, dtype=torch.float64)
17 gae_duplicate tensor(-1.1187, dtype=torch.float64) tensor(-2.6576, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7305, dtype=torch.float64) delta_t tensor(0.5888, dtype=torch.float64)
16 gae_duplicate tensor(-0.3344, dtype=torch.float64) tensor(-9.2954, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7154, dtype=torch.float64) delta_t tensor(0.5162, dtype=torch.float64)
15 gae_duplicate tensor(0.4628, dtype=torch.float64) tensor(-15.5080, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7007, dtype=torch.float64) delta_t tensor(0.4741, dtype=torch.float64)
14 gae_duplicate tensor(0.6989, dtype=torch.float64) tensor(-17.9803, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6860, dtype=torch.float64) delta_t tensor(0.3384, dtype=torch.float64)
13 gae_duplicate tensor(0.8554, dtype=torch.float64) tensor(-9.3984, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6338, dtype=torch.float64) delta_t tensor(0.2028, dtype=torch.float64)
12 gae_duplicate tensor(0.4824, dtype=torch.float64) tensor(-17.3463, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1354, dtype=torch.float64) delta_t tensor(0.0382, dtype=torch.float64)
11 gae_duplicate tensor(-1.0217, dtype=torch.float64) tensor(-9.3801, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5076, dtype=torch.float64) delta_t tensor(0.3924, dtype=torch.float64)
10 gae_duplicate tensor(-0.4817, dtype=torch.float64) tensor(-10.0707, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3594, dtype=torch.float64) delta_t tensor(0.4963, dtype=torch.float64)
9 gae_duplicate tensor(0.0166, dtype=torch.float64) tensor(-10.2929, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0573, dtype=torch.float64) delta_t tensor(-0.2529, dtype=torch.float64)
8 gae_duplicate tensor(-0.0285, dtype=torch.float64) tensor(-10.7495, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4948, dtype=torch.float64) delta_t tensor(-0.5345, dtype=torch.float64)
7 gae_duplicate tensor(-0.4605, dtype=torch.float64) tensor(-1.5128, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3397, dtype=torch.float64) delta_t tensor(-0.3643, dtype=torch.float64)
6 gae_duplicate tensor(-1.1147, dtype=torch.float64) tensor(3.5613, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5841, dtype=torch.float64) delta_t tensor(-0.4626, dtype=torch.float64)
5 gae_duplicate tensor(-1.0508, dtype=torch.float64) tensor(6.0000, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2479, dtype=torch.float64) delta_t tensor(-0.1489, dtype=torch.float64)
4 gae_duplicate tensor(-1.3278, dtype=torch.float64) tensor(8.0358, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3049, dtype=torch.float64) delta_t tensor(-0.3402, dtype=torch.float64)
3 gae_duplicate tensor(-2.2811, dtype=torch.float64) tensor(12.5366, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2975, dtype=torch.float64) delta_t tensor(-0.6416, dtype=torch.float64)
2 gae_duplicate tensor(-1.9154, dtype=torch.float64) tensor(6.4589, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2622.89013671875
value loss:253.26193237304688
entropies:175.4115753173828
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.762647867202759 seconds
19 rew tensor(0.7060, dtype=torch.float64) delta_t tensor(-0.4441, dtype=torch.float64)
19 gae_duplicate tensor(-0.8492, dtype=torch.float64) tensor(2.7627, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6737, dtype=torch.float64) delta_t tensor(0.4590, dtype=torch.float64)
18 gae_duplicate tensor(-0.4260, dtype=torch.float64) tensor(-2.4527, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6985, dtype=torch.float64) delta_t tensor(0.4979, dtype=torch.float64)
17 gae_duplicate tensor(0.0822, dtype=torch.float64) tensor(-4.4330, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6745, dtype=torch.float64) delta_t tensor(0.4379, dtype=torch.float64)
16 gae_duplicate tensor(0.3690, dtype=torch.float64) tensor(-6.8269, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6010, dtype=torch.float64) delta_t tensor(0.5811, dtype=torch.float64)
15 gae_duplicate tensor(0.4346, dtype=torch.float64) tensor(-10.3843, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7061, dtype=torch.float64) delta_t tensor(0.5057, dtype=torch.float64)
14 gae_duplicate tensor(0.9198, dtype=torch.float64) tensor(-16.7347, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6991, dtype=torch.float64) delta_t tensor(0.3964, dtype=torch.float64)
13 gae_duplicate tensor(0.8472, dtype=torch.float64) tensor(-9.9563, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1901, dtype=torch.float64) delta_t tensor(-0.2813, dtype=torch.float64)
12 gae_duplicate tensor(-1.7083, dtype=torch.float64) tensor(-13.8909, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5953, dtype=torch.float64) delta_t tensor(0.3364, dtype=torch.float64)
11 gae_duplicate tensor(-0.8923, dtype=torch.float64) tensor(-8.4743, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4413, dtype=torch.float64) delta_t tensor(0.3376, dtype=torch.float64)
10 gae_duplicate tensor(-0.4729, dtype=torch.float64) tensor(-10.8567, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1432, dtype=torch.float64) delta_t tensor(-0.4183, dtype=torch.float64)
9 gae_duplicate tensor(-0.8051, dtype=torch.float64) tensor(-3.3619, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5646, dtype=torch.float64) delta_t tensor(-0.6319, dtype=torch.float64)
8 gae_duplicate tensor(-2.1157, dtype=torch.float64) tensor(2.1942, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3711, dtype=torch.float64) delta_t tensor(-0.4545, dtype=torch.float64)
7 gae_duplicate tensor(-3.0582, dtype=torch.float64) tensor(3.1968, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8123, dtype=torch.float64) delta_t tensor(-0.6147, dtype=torch.float64)
6 gae_duplicate tensor(-4.1253, dtype=torch.float64) tensor(12.1659, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8175, dtype=torch.float64) delta_t tensor(-0.7664, dtype=torch.float64)
5 gae_duplicate tensor(-5.0349, dtype=torch.float64) tensor(11.2941, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9244, dtype=torch.float64) delta_t tensor(-0.8751, dtype=torch.float64)
4 gae_duplicate tensor(-5.4830, dtype=torch.float64) tensor(15.3518, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4785, dtype=torch.float64) delta_t tensor(-0.4382, dtype=torch.float64)
3 gae_duplicate tensor(-4.1842, dtype=torch.float64) tensor(28.7464, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1987, dtype=torch.float64) delta_t tensor(-0.3907, dtype=torch.float64)
2 gae_duplicate tensor(-3.5728, dtype=torch.float64) tensor(21.1928, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-375.0087890625
value loss:481.915771484375
entropies:176.80482482910156
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.140584945678711 seconds
19 rew tensor(0.7068, dtype=torch.float64) delta_t tensor(-0.3978, dtype=torch.float64)
19 gae_duplicate tensor(-0.7366, dtype=torch.float64) tensor(3.5184, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6907, dtype=torch.float64) delta_t tensor(0.4914, dtype=torch.float64)
18 gae_duplicate tensor(-0.2498, dtype=torch.float64) tensor(-1.3454, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6496, dtype=torch.float64) delta_t tensor(0.2712, dtype=torch.float64)
17 gae_duplicate tensor(0.0445, dtype=torch.float64) tensor(-2.1222, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5269, dtype=torch.float64) delta_t tensor(0.3845, dtype=torch.float64)
16 gae_duplicate tensor(-0.1551, dtype=torch.float64) tensor(-5.3602, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3382, dtype=torch.float64) delta_t tensor(0.2447, dtype=torch.float64)
15 gae_duplicate tensor(-0.5149, dtype=torch.float64) tensor(-9.5301, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7179, dtype=torch.float64) delta_t tensor(0.3872, dtype=torch.float64)
14 gae_duplicate tensor(0.1853, dtype=torch.float64) tensor(-10.2007, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6953, dtype=torch.float64) delta_t tensor(0.5012, dtype=torch.float64)
13 gae_duplicate tensor(0.7132, dtype=torch.float64) tensor(-11.9757, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7120, dtype=torch.float64) delta_t tensor(0.4814, dtype=torch.float64)
12 gae_duplicate tensor(1.1409, dtype=torch.float64) tensor(-9.0762, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7419, dtype=torch.float64) delta_t tensor(0.4075, dtype=torch.float64)
11 gae_duplicate tensor(1.4101, dtype=torch.float64) tensor(-13.2716, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1417, dtype=torch.float64) delta_t tensor(-0.1423, dtype=torch.float64)
10 gae_duplicate tensor(-1.1736, dtype=torch.float64) tensor(-10.7418, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3065, dtype=torch.float64) delta_t tensor(-0.4626, dtype=torch.float64)
9 gae_duplicate tensor(-1.0588, dtype=torch.float64) tensor(-7.6704, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8769, dtype=torch.float64) delta_t tensor(-0.7632, dtype=torch.float64)
8 gae_duplicate tensor(-2.7817, dtype=torch.float64) tensor(0.5378, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6172, dtype=torch.float64) delta_t tensor(-0.6612, dtype=torch.float64)
7 gae_duplicate tensor(-4.0432, dtype=torch.float64) tensor(14.3738, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9758, dtype=torch.float64) delta_t tensor(-1.0803, dtype=torch.float64)
6 gae_duplicate tensor(-4.6257, dtype=torch.float64) tensor(21.3036, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0799, dtype=torch.float64) delta_t tensor(-1.0191, dtype=torch.float64)
5 gae_duplicate tensor(-5.4859, dtype=torch.float64) tensor(23.3589, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5291, dtype=torch.float64) delta_t tensor(-0.2283, dtype=torch.float64)
4 gae_duplicate tensor(-6.7541, dtype=torch.float64) tensor(22.0305, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5352, dtype=torch.float64) delta_t tensor(-0.5789, dtype=torch.float64)
3 gae_duplicate tensor(-5.2868, dtype=torch.float64) tensor(30.7531, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3123, dtype=torch.float64) delta_t tensor(-0.5016, dtype=torch.float64)
2 gae_duplicate tensor(-4.5082, dtype=torch.float64) tensor(23.1316, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2109.31982421875
value loss:569.5961303710938
entropies:175.7415008544922
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2301.1809)
ToM Target loss= tensor(1811.2947)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.105008125305176 seconds
19 rew tensor(0.2991, dtype=torch.float64) delta_t tensor(-0.7820, dtype=torch.float64)
19 gae_duplicate tensor(-1.5542, dtype=torch.float64) tensor(6.9792, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4611, dtype=torch.float64) delta_t tensor(0.4388, dtype=torch.float64)
18 gae_duplicate tensor(-1.7603, dtype=torch.float64) tensor(2.9812, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7337, dtype=torch.float64) delta_t tensor(0.5302, dtype=torch.float64)
17 gae_duplicate tensor(-0.8297, dtype=torch.float64) tensor(-7.0091, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7256, dtype=torch.float64) delta_t tensor(0.4325, dtype=torch.float64)
16 gae_duplicate tensor(-0.0849, dtype=torch.float64) tensor(-6.7906, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7199, dtype=torch.float64) delta_t tensor(0.5367, dtype=torch.float64)
15 gae_duplicate tensor(0.5113, dtype=torch.float64) tensor(-12.8010, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6977, dtype=torch.float64) delta_t tensor(0.4052, dtype=torch.float64)
14 gae_duplicate tensor(0.8922, dtype=torch.float64) tensor(-12.7284, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6757, dtype=torch.float64) delta_t tensor(0.2611, dtype=torch.float64)
13 gae_duplicate tensor(0.5183, dtype=torch.float64) tensor(-20.4319, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3079, dtype=torch.float64) delta_t tensor(0.1475, dtype=torch.float64)
12 gae_duplicate tensor(-0.2633, dtype=torch.float64) tensor(-13.8996, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3940, dtype=torch.float64) delta_t tensor(0.1152, dtype=torch.float64)
11 gae_duplicate tensor(-0.3076, dtype=torch.float64) tensor(-10.0023, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5508, dtype=torch.float64) delta_t tensor(0.4897, dtype=torch.float64)
10 gae_duplicate tensor(-0.7251, dtype=torch.float64) tensor(-9.8705, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5268, dtype=torch.float64) delta_t tensor(-0.6094, dtype=torch.float64)
9 gae_duplicate tensor(-2.1294, dtype=torch.float64) tensor(-7.2679, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5906, dtype=torch.float64) delta_t tensor(-0.7877, dtype=torch.float64)
8 gae_duplicate tensor(-2.9590, dtype=torch.float64) tensor(-3.2929, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8193, dtype=torch.float64) delta_t tensor(-1.0367, dtype=torch.float64)
7 gae_duplicate tensor(-3.5548, dtype=torch.float64) tensor(17.7145, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8676, dtype=torch.float64) delta_t tensor(-0.7274, dtype=torch.float64)
6 gae_duplicate tensor(-4.4175, dtype=torch.float64) tensor(21.4941, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0352, dtype=torch.float64) delta_t tensor(-0.9203, dtype=torch.float64)
5 gae_duplicate tensor(-5.6064, dtype=torch.float64) tensor(31.6263, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9409, dtype=torch.float64) delta_t tensor(-0.7354, dtype=torch.float64)
4 gae_duplicate tensor(-6.9953, dtype=torch.float64) tensor(20.3102, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4093, dtype=torch.float64) delta_t tensor(-0.4218, dtype=torch.float64)
3 gae_duplicate tensor(-6.2674, dtype=torch.float64) tensor(27.8802, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2744, dtype=torch.float64) delta_t tensor(-0.4507, dtype=torch.float64)
2 gae_duplicate tensor(-5.2119, dtype=torch.float64) tensor(23.7483, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1783.0294189453125
value loss:660.8361206054688
entropies:177.8090362548828
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.487602949142456 seconds
19 rew tensor(0.6159, dtype=torch.float64) delta_t tensor(-0.3370, dtype=torch.float64)
19 gae_duplicate tensor(-0.8116, dtype=torch.float64) tensor(3.4965, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5137, dtype=torch.float64) delta_t tensor(0.2549, dtype=torch.float64)
18 gae_duplicate tensor(-0.6713, dtype=torch.float64) tensor(-0.8823, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2933, dtype=torch.float64) delta_t tensor(0.1311, dtype=torch.float64)
17 gae_duplicate tensor(-0.9877, dtype=torch.float64) tensor(-0.4748, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5830, dtype=torch.float64) delta_t tensor(0.4879, dtype=torch.float64)
16 gae_duplicate tensor(-0.2685, dtype=torch.float64) tensor(-5.8699, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6728, dtype=torch.float64) delta_t tensor(0.5757, dtype=torch.float64)
15 gae_duplicate tensor(0.3386, dtype=torch.float64) tensor(-10.2966, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6193, dtype=torch.float64) delta_t tensor(0.4830, dtype=torch.float64)
14 gae_duplicate tensor(0.4853, dtype=torch.float64) tensor(-9.9192, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6389, dtype=torch.float64) delta_t tensor(0.4660, dtype=torch.float64)
13 gae_duplicate tensor(0.9914, dtype=torch.float64) tensor(-14.0406, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5204, dtype=torch.float64) delta_t tensor(0.1655, dtype=torch.float64)
12 gae_duplicate tensor(0.5966, dtype=torch.float64) tensor(-13.6064, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5040, dtype=torch.float64) delta_t tensor(0.2315, dtype=torch.float64)
11 gae_duplicate tensor(0.6191, dtype=torch.float64) tensor(-11.4937, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3870, dtype=torch.float64) delta_t tensor(0.2320, dtype=torch.float64)
10 gae_duplicate tensor(0.7212, dtype=torch.float64) tensor(-12.1582, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2721, dtype=torch.float64) delta_t tensor(-0.4755, dtype=torch.float64)
9 gae_duplicate tensor(-0.2881, dtype=torch.float64) tensor(-3.8424, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7051, dtype=torch.float64) delta_t tensor(-0.8676, dtype=torch.float64)
8 gae_duplicate tensor(-2.4517, dtype=torch.float64) tensor(4.4261, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9851, dtype=torch.float64) delta_t tensor(-0.9995, dtype=torch.float64)
7 gae_duplicate tensor(-3.9646, dtype=torch.float64) tensor(16.0411, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3799, dtype=torch.float64) delta_t tensor(-1.3388, dtype=torch.float64)
6 gae_duplicate tensor(-5.5263, dtype=torch.float64) tensor(37.5333, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1079, dtype=torch.float64) delta_t tensor(-0.9374, dtype=torch.float64)
5 gae_duplicate tensor(-5.1105, dtype=torch.float64) tensor(24.3304, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9403, dtype=torch.float64) delta_t tensor(-2.8885, dtype=torch.float64)
4 gae_duplicate tensor(-10.0377, dtype=torch.float64) tensor(56.2302, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3369, dtype=torch.float64) delta_t tensor(-0.3435, dtype=torch.float64)
3 gae_duplicate tensor(-8.2855, dtype=torch.float64) tensor(52.5940, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3065, dtype=torch.float64) delta_t tensor(-0.3480, dtype=torch.float64)
2 gae_duplicate tensor(-6.9276, dtype=torch.float64) tensor(38.5713, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5455.375
value loss:1227.92578125
entropies:179.86448669433594
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.990106105804443 seconds
19 rew tensor(0.5569, dtype=torch.float64) delta_t tensor(-0.7075, dtype=torch.float64)
19 gae_duplicate tensor(-1.2250, dtype=torch.float64) tensor(7.5105, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6446, dtype=torch.float64) delta_t tensor(0.3417, dtype=torch.float64)
18 gae_duplicate tensor(-0.5654, dtype=torch.float64) tensor(1.8257, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5326, dtype=torch.float64) delta_t tensor(0.3056, dtype=torch.float64)
17 gae_duplicate tensor(-0.8979, dtype=torch.float64) tensor(-1.7254, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3552, dtype=torch.float64) delta_t tensor(0.2315, dtype=torch.float64)
16 gae_duplicate tensor(-1.3986, dtype=torch.float64) tensor(-0.4537, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5656, dtype=torch.float64) delta_t tensor(0.4446, dtype=torch.float64)
15 gae_duplicate tensor(-0.5037, dtype=torch.float64) tensor(-5.9770, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7070, dtype=torch.float64) delta_t tensor(0.6003, dtype=torch.float64)
14 gae_duplicate tensor(0.2126, dtype=torch.float64) tensor(-7.5990, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6789, dtype=torch.float64) delta_t tensor(0.5086, dtype=torch.float64)
13 gae_duplicate tensor(0.5833, dtype=torch.float64) tensor(-12.4384, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7148, dtype=torch.float64) delta_t tensor(0.4717, dtype=torch.float64)
12 gae_duplicate tensor(0.7140, dtype=torch.float64) tensor(-9.7251, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5889, dtype=torch.float64) delta_t tensor(0.3445, dtype=torch.float64)
11 gae_duplicate tensor(0.8411, dtype=torch.float64) tensor(-10.6617, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4048, dtype=torch.float64) delta_t tensor(0.1396, dtype=torch.float64)
10 gae_duplicate tensor(-0.4724, dtype=torch.float64) tensor(-16.1795, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6179, dtype=torch.float64) delta_t tensor(-1.0653, dtype=torch.float64)
9 gae_duplicate tensor(-1.5359, dtype=torch.float64) tensor(-4.0197, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0703, dtype=torch.float64) delta_t tensor(-0.2258, dtype=torch.float64)
8 gae_duplicate tensor(-1.9360, dtype=torch.float64) tensor(2.5428, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3721, dtype=torch.float64) delta_t tensor(-0.2325, dtype=torch.float64)
7 gae_duplicate tensor(-4.0209, dtype=torch.float64) tensor(3.9365, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4564, dtype=torch.float64) delta_t tensor(-0.1798, dtype=torch.float64)
6 gae_duplicate tensor(-4.7996, dtype=torch.float64) tensor(1.7753, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1279, dtype=torch.float64) delta_t tensor(-1.2618, dtype=torch.float64)
5 gae_duplicate tensor(-5.9067, dtype=torch.float64) tensor(24.1531, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7435, dtype=torch.float64) delta_t tensor(-0.6608, dtype=torch.float64)
4 gae_duplicate tensor(-6.3035, dtype=torch.float64) tensor(11.5188, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1845, dtype=torch.float64) delta_t tensor(-0.0217, dtype=torch.float64)
3 gae_duplicate tensor(-5.2004, dtype=torch.float64) tensor(21.9945, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7216, dtype=torch.float64) delta_t tensor(-0.8431, dtype=torch.float64)
2 gae_duplicate tensor(-4.7023, dtype=torch.float64) tensor(29.2308, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1317.2059326171875
value loss:502.92218017578125
entropies:176.11810302734375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.906702041625977 seconds
19 rew tensor(0.7318, dtype=torch.float64) delta_t tensor(-0.3547, dtype=torch.float64)
19 gae_duplicate tensor(-0.6849, dtype=torch.float64) tensor(2.3385, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7165, dtype=torch.float64) delta_t tensor(0.5948, dtype=torch.float64)
18 gae_duplicate tensor(-0.2009, dtype=torch.float64) tensor(-3.9794, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7039, dtype=torch.float64) delta_t tensor(0.5090, dtype=torch.float64)
17 gae_duplicate tensor(0.1896, dtype=torch.float64) tensor(-7.4178, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6685, dtype=torch.float64) delta_t tensor(0.5868, dtype=torch.float64)
16 gae_duplicate tensor(0.2636, dtype=torch.float64) tensor(-11.5839, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5961, dtype=torch.float64) delta_t tensor(0.3914, dtype=torch.float64)
15 gae_duplicate tensor(0.0533, dtype=torch.float64) tensor(-14.5833, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7405, dtype=torch.float64) delta_t tensor(0.5268, dtype=torch.float64)
14 gae_duplicate tensor(0.5539, dtype=torch.float64) tensor(-14.7341, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7069, dtype=torch.float64) delta_t tensor(0.4786, dtype=torch.float64)
13 gae_duplicate tensor(0.9546, dtype=torch.float64) tensor(-10.0899, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7073, dtype=torch.float64) delta_t tensor(0.6160, dtype=torch.float64)
12 gae_duplicate tensor(1.2755, dtype=torch.float64) tensor(-18.3936, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4223, dtype=torch.float64) delta_t tensor(0.3214, dtype=torch.float64)
11 gae_duplicate tensor(-0.1793, dtype=torch.float64) tensor(-13.9818, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3623, dtype=torch.float64) delta_t tensor(0.1395, dtype=torch.float64)
10 gae_duplicate tensor(-2.0038, dtype=torch.float64) tensor(-15.5042, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0363, dtype=torch.float64) delta_t tensor(-0.0298, dtype=torch.float64)
9 gae_duplicate tensor(-1.2918, dtype=torch.float64) tensor(-11.6248, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9996, dtype=torch.float64) delta_t tensor(-0.8814, dtype=torch.float64)
8 gae_duplicate tensor(-2.6516, dtype=torch.float64) tensor(-4.0137, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6570, dtype=torch.float64) delta_t tensor(-0.7226, dtype=torch.float64)
7 gae_duplicate tensor(-2.6221, dtype=torch.float64) tensor(3.4976, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0810, dtype=torch.float64) delta_t tensor(-0.9675, dtype=torch.float64)
6 gae_duplicate tensor(-4.8953, dtype=torch.float64) tensor(12.4891, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4156, dtype=torch.float64) delta_t tensor(-1.3552, dtype=torch.float64)
5 gae_duplicate tensor(-5.8591, dtype=torch.float64) tensor(27.8711, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3843, dtype=torch.float64) delta_t tensor(-2.3797, dtype=torch.float64)
4 gae_duplicate tensor(-9.7054, dtype=torch.float64) tensor(38.0330, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3133, dtype=torch.float64) delta_t tensor(-0.3376, dtype=torch.float64)
3 gae_duplicate tensor(-7.8141, dtype=torch.float64) tensor(33.2254, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2256, dtype=torch.float64) delta_t tensor(-0.4203, dtype=torch.float64)
2 gae_duplicate tensor(-6.5382, dtype=torch.float64) tensor(43.7777, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1303.8544921875
value loss:1139.3546142578125
entropies:178.46133422851562
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.809797048568726 seconds
19 rew tensor(0.3754, dtype=torch.float64) delta_t tensor(-0.6900, dtype=torch.float64)
19 gae_duplicate tensor(-2.0396, dtype=torch.float64) tensor(6.2388, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7208, dtype=torch.float64) delta_t tensor(0.5294, dtype=torch.float64)
18 gae_duplicate tensor(-1.0189, dtype=torch.float64) tensor(0.0714, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6971, dtype=torch.float64) delta_t tensor(0.4796, dtype=torch.float64)
17 gae_duplicate tensor(-0.2020, dtype=torch.float64) tensor(-3.9846, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6572, dtype=torch.float64) delta_t tensor(0.6580, dtype=torch.float64)
16 gae_duplicate tensor(0.4520, dtype=torch.float64) tensor(-12.6093, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5527, dtype=torch.float64) delta_t tensor(0.4059, dtype=torch.float64)
15 gae_duplicate tensor(0.2817, dtype=torch.float64) tensor(-10.2928, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7140, dtype=torch.float64) delta_t tensor(0.5834, dtype=torch.float64)
14 gae_duplicate tensor(0.7056, dtype=torch.float64) tensor(-13.4537, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6380, dtype=torch.float64) delta_t tensor(0.4609, dtype=torch.float64)
13 gae_duplicate tensor(0.9827, dtype=torch.float64) tensor(-17.0931, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6886, dtype=torch.float64) delta_t tensor(0.5099, dtype=torch.float64)
12 gae_duplicate tensor(1.2681, dtype=torch.float64) tensor(-16.9773, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6515, dtype=torch.float64) delta_t tensor(0.5211, dtype=torch.float64)
11 gae_duplicate tensor(1.4968, dtype=torch.float64) tensor(-15.4685, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5613, dtype=torch.float64) delta_t tensor(0.2515, dtype=torch.float64)
10 gae_duplicate tensor(1.1796, dtype=torch.float64) tensor(-15.5697, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0405, dtype=torch.float64) delta_t tensor(-1.2884, dtype=torch.float64)
9 gae_duplicate tensor(-3.1544, dtype=torch.float64) tensor(0.0021, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4598, dtype=torch.float64) delta_t tensor(-0.4936, dtype=torch.float64)
8 gae_duplicate tensor(-2.4184, dtype=torch.float64) tensor(-2.0607, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0009, dtype=torch.float64) delta_t tensor(-1.0246, dtype=torch.float64)
7 gae_duplicate tensor(-3.2721, dtype=torch.float64) tensor(10.8443, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2932, dtype=torch.float64) delta_t tensor(-1.3558, dtype=torch.float64)
6 gae_duplicate tensor(-5.7135, dtype=torch.float64) tensor(22.1720, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2638, dtype=torch.float64) delta_t tensor(-1.1467, dtype=torch.float64)
5 gae_duplicate tensor(-5.9413, dtype=torch.float64) tensor(39.8215, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.2740, dtype=torch.float64) delta_t tensor(-3.1167, dtype=torch.float64)
4 gae_duplicate tensor(-9.3344, dtype=torch.float64) tensor(59.1608, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2231, dtype=torch.float64) delta_t tensor(-0.1789, dtype=torch.float64)
3 gae_duplicate tensor(-7.6019, dtype=torch.float64) tensor(54.6043, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1449, dtype=torch.float64) delta_t tensor(-0.2478, dtype=torch.float64)
2 gae_duplicate tensor(-6.4639, dtype=torch.float64) tensor(29.4032, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4165.06640625
value loss:1377.96875
entropies:177.50576782226562
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2368.8235)
ToM Target loss= tensor(1809.9274)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.95339822769165 seconds
19 rew tensor(0.6979, dtype=torch.float64) delta_t tensor(-0.4366, dtype=torch.float64)
19 gae_duplicate tensor(-0.7557, dtype=torch.float64) tensor(4.7604, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6588, dtype=torch.float64) delta_t tensor(0.3544, dtype=torch.float64)
18 gae_duplicate tensor(-0.3661, dtype=torch.float64) tensor(0.4964, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5944, dtype=torch.float64) delta_t tensor(0.2966, dtype=torch.float64)
17 gae_duplicate tensor(-0.1765, dtype=torch.float64) tensor(-2.5295, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4504, dtype=torch.float64) delta_t tensor(0.2292, dtype=torch.float64)
16 gae_duplicate tensor(-0.6905, dtype=torch.float64) tensor(-6.9232, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2027, dtype=torch.float64) delta_t tensor(0.1005, dtype=torch.float64)
15 gae_duplicate tensor(-1.5013, dtype=torch.float64) tensor(-3.4102, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5946, dtype=torch.float64) delta_t tensor(0.4798, dtype=torch.float64)
14 gae_duplicate tensor(-0.5702, dtype=torch.float64) tensor(-10.9242, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7393, dtype=torch.float64) delta_t tensor(0.6208, dtype=torch.float64)
13 gae_duplicate tensor(0.1473, dtype=torch.float64) tensor(-16.4925, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6558, dtype=torch.float64) delta_t tensor(0.4171, dtype=torch.float64)
12 gae_duplicate tensor(0.7218, dtype=torch.float64) tensor(-16.1069, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5109, dtype=torch.float64) delta_t tensor(0.2651, dtype=torch.float64)
11 gae_duplicate tensor(0.9418, dtype=torch.float64) tensor(-14.6612, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3950, dtype=torch.float64) delta_t tensor(0.0926, dtype=torch.float64)
10 gae_duplicate tensor(-0.1364, dtype=torch.float64) tensor(-6.7829, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0383, dtype=torch.float64) delta_t tensor(0.0251, dtype=torch.float64)
9 gae_duplicate tensor(-0.7862, dtype=torch.float64) tensor(-15.8864, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4212, dtype=torch.float64) delta_t tensor(-0.1740, dtype=torch.float64)
8 gae_duplicate tensor(-2.5289, dtype=torch.float64) tensor(-9.6473, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3731, dtype=torch.float64) delta_t tensor(-0.4764, dtype=torch.float64)
7 gae_duplicate tensor(-2.6653, dtype=torch.float64) tensor(-2.8000, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3137, dtype=torch.float64) delta_t tensor(-0.5836, dtype=torch.float64)
6 gae_duplicate tensor(-2.2591, dtype=torch.float64) tensor(4.0752, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0069, dtype=torch.float64) delta_t tensor(-0.8549, dtype=torch.float64)
5 gae_duplicate tensor(-2.7256, dtype=torch.float64) tensor(17.5081, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0508, dtype=torch.float64) delta_t tensor(0.2433, dtype=torch.float64)
4 gae_duplicate tensor(-1.5826, dtype=torch.float64) tensor(8.5458, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9557, dtype=torch.float64) delta_t tensor(-1.0244, dtype=torch.float64)
3 gae_duplicate tensor(-2.7417, dtype=torch.float64) tensor(13.8066, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2646, dtype=torch.float64) delta_t tensor(-0.5256, dtype=torch.float64)
2 gae_duplicate tensor(-2.6569, dtype=torch.float64) tensor(21.6191, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1241.132080078125
value loss:272.4725341796875
entropies:175.36065673828125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.671695947647095 seconds
19 rew tensor(0.6154, dtype=torch.float64) delta_t tensor(-0.4763, dtype=torch.float64)
19 gae_duplicate tensor(-0.9422, dtype=torch.float64) tensor(2.9658, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5004, dtype=torch.float64) delta_t tensor(0.2617, dtype=torch.float64)
18 gae_duplicate tensor(-1.2334, dtype=torch.float64) tensor(1.7723, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2784, dtype=torch.float64) delta_t tensor(0.1612, dtype=torch.float64)
17 gae_duplicate tensor(-1.5087, dtype=torch.float64) tensor(-2.5710, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4048, dtype=torch.float64) delta_t tensor(0.2142, dtype=torch.float64)
16 gae_duplicate tensor(-0.7473, dtype=torch.float64) tensor(-0.5219, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5618, dtype=torch.float64) delta_t tensor(0.4803, dtype=torch.float64)
15 gae_duplicate tensor(-0.0250, dtype=torch.float64) tensor(-6.4063, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7238, dtype=torch.float64) delta_t tensor(0.5428, dtype=torch.float64)
14 gae_duplicate tensor(0.5515, dtype=torch.float64) tensor(-9.0953, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7235, dtype=torch.float64) delta_t tensor(0.6495, dtype=torch.float64)
13 gae_duplicate tensor(1.0130, dtype=torch.float64) tensor(-10.2640, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3628, dtype=torch.float64) delta_t tensor(0.1991, dtype=torch.float64)
12 gae_duplicate tensor(-0.3387, dtype=torch.float64) tensor(-11.4986, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6244, dtype=torch.float64) delta_t tensor(0.4523, dtype=torch.float64)
11 gae_duplicate tensor(0.0439, dtype=torch.float64) tensor(-16.6062, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4764, dtype=torch.float64) delta_t tensor(0.1635, dtype=torch.float64)
10 gae_duplicate tensor(-0.0566, dtype=torch.float64) tensor(-18.8472, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1386, dtype=torch.float64) delta_t tensor(-0.1083, dtype=torch.float64)
9 gae_duplicate tensor(-0.4198, dtype=torch.float64) tensor(-7.9022, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2775, dtype=torch.float64) delta_t tensor(-0.1734, dtype=torch.float64)
8 gae_duplicate tensor(-1.1349, dtype=torch.float64) tensor(-6.8990, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2866, dtype=torch.float64) delta_t tensor(-0.4286, dtype=torch.float64)
7 gae_duplicate tensor(-2.6413, dtype=torch.float64) tensor(-1.9780, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3560, dtype=torch.float64) delta_t tensor(-0.3702, dtype=torch.float64)
6 gae_duplicate tensor(-1.8282, dtype=torch.float64) tensor(1.9966, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0044, dtype=torch.float64) delta_t tensor(-0.9296, dtype=torch.float64)
5 gae_duplicate tensor(-3.6389, dtype=torch.float64) tensor(11.2613, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9608, dtype=torch.float64) delta_t tensor(-0.7268, dtype=torch.float64)
4 gae_duplicate tensor(-7.4720, dtype=torch.float64) tensor(31.3444, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5932, dtype=torch.float64) delta_t tensor(-0.6206, dtype=torch.float64)
3 gae_duplicate tensor(-5.9926, dtype=torch.float64) tensor(21.8296, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3822, dtype=torch.float64) delta_t tensor(-0.5143, dtype=torch.float64)
2 gae_duplicate tensor(-4.8754, dtype=torch.float64) tensor(38.2746, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-638.6519775390625
value loss:444.2696533203125
entropies:177.09402465820312
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.897857189178467 seconds
19 rew tensor(0.6365, dtype=torch.float64) delta_t tensor(-0.6234, dtype=torch.float64)
19 gae_duplicate tensor(-0.8405, dtype=torch.float64) tensor(6.3693, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5336, dtype=torch.float64) delta_t tensor(0.4114, dtype=torch.float64)
18 gae_duplicate tensor(-0.6221, dtype=torch.float64) tensor(2.3369, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3484, dtype=torch.float64) delta_t tensor(0.1127, dtype=torch.float64)
17 gae_duplicate tensor(-1.0792, dtype=torch.float64) tensor(-1.4629, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(-0.0102, dtype=torch.float64) delta_t tensor(0.0714, dtype=torch.float64)
16 gae_duplicate tensor(-1.6273, dtype=torch.float64) tensor(2.3898, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3920, dtype=torch.float64) delta_t tensor(0.2938, dtype=torch.float64)
15 gae_duplicate tensor(-0.8227, dtype=torch.float64) tensor(-0.6292, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7256, dtype=torch.float64) delta_t tensor(0.5499, dtype=torch.float64)
14 gae_duplicate tensor(-0.0639, dtype=torch.float64) tensor(-10.2968, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6953, dtype=torch.float64) delta_t tensor(0.3273, dtype=torch.float64)
13 gae_duplicate tensor(0.5606, dtype=torch.float64) tensor(-9.3735, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6961, dtype=torch.float64) delta_t tensor(0.5053, dtype=torch.float64)
12 gae_duplicate tensor(1.0605, dtype=torch.float64) tensor(-17.0568, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0132, dtype=torch.float64) delta_t tensor(-0.4095, dtype=torch.float64)
11 gae_duplicate tensor(-3.0938, dtype=torch.float64) tensor(-3.6365, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4445, dtype=torch.float64) delta_t tensor(0.4780, dtype=torch.float64)
10 gae_duplicate tensor(-2.0508, dtype=torch.float64) tensor(-15.9253, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4187, dtype=torch.float64) delta_t tensor(-0.6441, dtype=torch.float64)
9 gae_duplicate tensor(-1.5552, dtype=torch.float64) tensor(1.1578, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7546, dtype=torch.float64) delta_t tensor(-0.7715, dtype=torch.float64)
8 gae_duplicate tensor(-2.7648, dtype=torch.float64) tensor(1.6384, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8044, dtype=torch.float64) delta_t tensor(-1.0961, dtype=torch.float64)
7 gae_duplicate tensor(-3.8197, dtype=torch.float64) tensor(9.1668, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2808, dtype=torch.float64) delta_t tensor(-1.1269, dtype=torch.float64)
6 gae_duplicate tensor(-5.2184, dtype=torch.float64) tensor(17.1720, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9872, dtype=torch.float64) delta_t tensor(-0.8338, dtype=torch.float64)
5 gae_duplicate tensor(-5.3136, dtype=torch.float64) tensor(31.4578, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6769, dtype=torch.float64) delta_t tensor(-1.4813, dtype=torch.float64)
4 gae_duplicate tensor(-7.8618, dtype=torch.float64) tensor(45.7423, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3493, dtype=torch.float64) delta_t tensor(-0.3898, dtype=torch.float64)
3 gae_duplicate tensor(-6.7797, dtype=torch.float64) tensor(23.1556, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2221, dtype=torch.float64) delta_t tensor(-0.4617, dtype=torch.float64)
2 gae_duplicate tensor(-5.6217, dtype=torch.float64) tensor(22.6379, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3805.73876953125
value loss:955.87548828125
entropies:174.2165985107422
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.255035161972046 seconds
19 rew tensor(0.5171, dtype=torch.float64) delta_t tensor(-0.5747, dtype=torch.float64)
19 gae_duplicate tensor(-1.1398, dtype=torch.float64) tensor(4.4296, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6133, dtype=torch.float64) delta_t tensor(0.2629, dtype=torch.float64)
18 gae_duplicate tensor(-1.0664, dtype=torch.float64) tensor(2.4306, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4933, dtype=torch.float64) delta_t tensor(0.3425, dtype=torch.float64)
17 gae_duplicate tensor(-1.2895, dtype=torch.float64) tensor(-0.5378, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7345, dtype=torch.float64) delta_t tensor(0.5029, dtype=torch.float64)
16 gae_duplicate tensor(-0.4835, dtype=torch.float64) tensor(-5.0679, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7103, dtype=torch.float64) delta_t tensor(0.5955, dtype=torch.float64)
15 gae_duplicate tensor(0.2363, dtype=torch.float64) tensor(-11.8514, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6942, dtype=torch.float64) delta_t tensor(0.5328, dtype=torch.float64)
14 gae_duplicate tensor(0.6674, dtype=torch.float64) tensor(-12.4378, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6371, dtype=torch.float64) delta_t tensor(0.5543, dtype=torch.float64)
13 gae_duplicate tensor(0.8788, dtype=torch.float64) tensor(-14.0125, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6104, dtype=torch.float64) delta_t tensor(0.1853, dtype=torch.float64)
12 gae_duplicate tensor(0.7759, dtype=torch.float64) tensor(-10.0092, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6454, dtype=torch.float64) delta_t tensor(0.5117, dtype=torch.float64)
11 gae_duplicate tensor(1.1137, dtype=torch.float64) tensor(-12.6996, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6166, dtype=torch.float64) delta_t tensor(0.3954, dtype=torch.float64)
10 gae_duplicate tensor(1.4217, dtype=torch.float64) tensor(-13.2380, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1353, dtype=torch.float64) delta_t tensor(-1.2128, dtype=torch.float64)
9 gae_duplicate tensor(-2.2369, dtype=torch.float64) tensor(-5.0274, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2820, dtype=torch.float64) delta_t tensor(-0.4825, dtype=torch.float64)
8 gae_duplicate tensor(-3.3354, dtype=torch.float64) tensor(4.3233, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7676, dtype=torch.float64) delta_t tensor(-0.7536, dtype=torch.float64)
7 gae_duplicate tensor(-4.2003, dtype=torch.float64) tensor(15.1364, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9976, dtype=torch.float64) delta_t tensor(-1.1281, dtype=torch.float64)
6 gae_duplicate tensor(-5.2199, dtype=torch.float64) tensor(20.7468, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2480, dtype=torch.float64) delta_t tensor(-1.1873, dtype=torch.float64)
5 gae_duplicate tensor(-5.4815, dtype=torch.float64) tensor(39.6607, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6688, dtype=torch.float64) delta_t tensor(-0.4162, dtype=torch.float64)
4 gae_duplicate tensor(-5.2137, dtype=torch.float64) tensor(27.9710, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3566, dtype=torch.float64) delta_t tensor(-0.3918, dtype=torch.float64)
3 gae_duplicate tensor(-4.3000, dtype=torch.float64) tensor(29.6961, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2981, dtype=torch.float64) delta_t tensor(-0.3075, dtype=torch.float64)
2 gae_duplicate tensor(-3.5195, dtype=torch.float64) tensor(18.9221, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2855.06005859375
value loss:641.4198608398438
entropies:174.44512939453125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.846663951873779 seconds
19 rew tensor(0.7261, dtype=torch.float64) delta_t tensor(-0.6778, dtype=torch.float64)
19 gae_duplicate tensor(-0.8329, dtype=torch.float64) tensor(6.6716, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6950, dtype=torch.float64) delta_t tensor(0.4527, dtype=torch.float64)
18 gae_duplicate tensor(-0.3298, dtype=torch.float64) tensor(1.8569, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6553, dtype=torch.float64) delta_t tensor(0.4480, dtype=torch.float64)
17 gae_duplicate tensor(0.0439, dtype=torch.float64) tensor(-3.1615, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5615, dtype=torch.float64) delta_t tensor(0.6191, dtype=torch.float64)
16 gae_duplicate tensor(0.0748, dtype=torch.float64) tensor(-6.8188, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4189, dtype=torch.float64) delta_t tensor(0.3401, dtype=torch.float64)
15 gae_duplicate tensor(0.1222, dtype=torch.float64) tensor(-12.3697, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7350, dtype=torch.float64) delta_t tensor(0.6746, dtype=torch.float64)
14 gae_duplicate tensor(0.7247, dtype=torch.float64) tensor(-15.9017, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7357, dtype=torch.float64) delta_t tensor(0.5631, dtype=torch.float64)
13 gae_duplicate tensor(1.2504, dtype=torch.float64) tensor(-21.0687, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7212, dtype=torch.float64) delta_t tensor(0.4405, dtype=torch.float64)
12 gae_duplicate tensor(1.0768, dtype=torch.float64) tensor(-15.5953, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0987, dtype=torch.float64) delta_t tensor(-0.0790, dtype=torch.float64)
11 gae_duplicate tensor(-1.9962, dtype=torch.float64) tensor(-9.6894, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1926, dtype=torch.float64) delta_t tensor(-0.2566, dtype=torch.float64)
10 gae_duplicate tensor(-1.7709, dtype=torch.float64) tensor(-15.6310, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0535, dtype=torch.float64) delta_t tensor(-0.1199, dtype=torch.float64)
9 gae_duplicate tensor(-1.1636, dtype=torch.float64) tensor(-6.7003, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0115, dtype=torch.float64) delta_t tensor(-0.1174, dtype=torch.float64)
8 gae_duplicate tensor(-0.8358, dtype=torch.float64) tensor(-4.4591, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2403, dtype=torch.float64) delta_t tensor(-0.2585, dtype=torch.float64)
7 gae_duplicate tensor(-1.4341, dtype=torch.float64) tensor(0.1336, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7118, dtype=torch.float64) delta_t tensor(-0.6251, dtype=torch.float64)
6 gae_duplicate tensor(-2.7794, dtype=torch.float64) tensor(5.7477, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0158, dtype=torch.float64) delta_t tensor(-0.7698, dtype=torch.float64)
5 gae_duplicate tensor(-3.2709, dtype=torch.float64) tensor(9.7997, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9260, dtype=torch.float64) delta_t tensor(-0.9077, dtype=torch.float64)
4 gae_duplicate tensor(-7.9924, dtype=torch.float64) tensor(25.5023, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7052, dtype=torch.float64) delta_t tensor(-0.7223, dtype=torch.float64)
3 gae_duplicate tensor(-5.7835, dtype=torch.float64) tensor(15.0684, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0302, dtype=torch.float64) delta_t tensor(-0.2221, dtype=torch.float64)
2 gae_duplicate tensor(-4.6021, dtype=torch.float64) tensor(15.8258, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1076.8492431640625
value loss:503.9150390625
entropies:175.40133666992188
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2306.0505)
ToM Target loss= tensor(1809.9086)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.807897090911865 seconds
19 rew tensor(0.2080, dtype=torch.float64) delta_t tensor(-0.8339, dtype=torch.float64)
19 gae_duplicate tensor(-1.4651, dtype=torch.float64) tensor(6.3559, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6766, dtype=torch.float64) delta_t tensor(0.5563, dtype=torch.float64)
18 gae_duplicate tensor(-0.6565, dtype=torch.float64) tensor(-0.5760, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6580, dtype=torch.float64) delta_t tensor(0.5709, dtype=torch.float64)
17 gae_duplicate tensor(-0.3616, dtype=torch.float64) tensor(-2.0785, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5651, dtype=torch.float64) delta_t tensor(0.4504, dtype=torch.float64)
16 gae_duplicate tensor(-0.4245, dtype=torch.float64) tensor(-7.4019, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7432, dtype=torch.float64) delta_t tensor(0.6192, dtype=torch.float64)
15 gae_duplicate tensor(0.2376, dtype=torch.float64) tensor(-9.6570, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7436, dtype=torch.float64) delta_t tensor(0.5134, dtype=torch.float64)
14 gae_duplicate tensor(0.7137, dtype=torch.float64) tensor(-9.2023, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7128, dtype=torch.float64) delta_t tensor(0.4635, dtype=torch.float64)
13 gae_duplicate tensor(0.9612, dtype=torch.float64) tensor(-21.0357, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7200, dtype=torch.float64) delta_t tensor(0.4314, dtype=torch.float64)
12 gae_duplicate tensor(1.2019, dtype=torch.float64) tensor(-16.4486, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5327, dtype=torch.float64) delta_t tensor(0.5374, dtype=torch.float64)
11 gae_duplicate tensor(1.2646, dtype=torch.float64) tensor(-19.3541, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5388, dtype=torch.float64) delta_t tensor(0.2895, dtype=torch.float64)
10 gae_duplicate tensor(1.2816, dtype=torch.float64) tensor(-21.6007, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2061, dtype=torch.float64) delta_t tensor(-0.4653, dtype=torch.float64)
9 gae_duplicate tensor(-0.1547, dtype=torch.float64) tensor(-13.9546, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6585, dtype=torch.float64) delta_t tensor(-0.6405, dtype=torch.float64)
8 gae_duplicate tensor(-1.1363, dtype=torch.float64) tensor(-2.9878, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5399, dtype=torch.float64) delta_t tensor(-0.4298, dtype=torch.float64)
7 gae_duplicate tensor(-2.3533, dtype=torch.float64) tensor(4.0605, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0215, dtype=torch.float64) delta_t tensor(-1.0264, dtype=torch.float64)
6 gae_duplicate tensor(-3.6512, dtype=torch.float64) tensor(13.4185, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1254, dtype=torch.float64) delta_t tensor(-1.0251, dtype=torch.float64)
5 gae_duplicate tensor(-4.6044, dtype=torch.float64) tensor(12.0971, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4483, dtype=torch.float64) delta_t tensor(-1.3953, dtype=torch.float64)
4 gae_duplicate tensor(-8.7940, dtype=torch.float64) tensor(28.9515, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3316, dtype=torch.float64) delta_t tensor(-0.2105, dtype=torch.float64)
3 gae_duplicate tensor(-6.9645, dtype=torch.float64) tensor(27.4231, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1761, dtype=torch.float64) delta_t tensor(-0.3660, dtype=torch.float64)
2 gae_duplicate tensor(-6.0101, dtype=torch.float64) tensor(29.7757, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:48.325904846191406
value loss:693.5115966796875
entropies:174.503173828125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.985774993896484 seconds
19 rew tensor(0.5687, dtype=torch.float64) delta_t tensor(-0.6766, dtype=torch.float64)
19 gae_duplicate tensor(-1.5786, dtype=torch.float64) tensor(9.5440, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4242, dtype=torch.float64) delta_t tensor(0.3696, dtype=torch.float64)
18 gae_duplicate tensor(-1.8485, dtype=torch.float64) tensor(0.5775, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6927, dtype=torch.float64) delta_t tensor(0.4627, dtype=torch.float64)
17 gae_duplicate tensor(-1.0421, dtype=torch.float64) tensor(-4.1869, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6343, dtype=torch.float64) delta_t tensor(0.4943, dtype=torch.float64)
16 gae_duplicate tensor(-0.2814, dtype=torch.float64) tensor(-5.6375, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4632, dtype=torch.float64) delta_t tensor(0.4276, dtype=torch.float64)
15 gae_duplicate tensor(-0.2269, dtype=torch.float64) tensor(-6.8673, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4552, dtype=torch.float64) delta_t tensor(0.4012, dtype=torch.float64)
14 gae_duplicate tensor(0.4067, dtype=torch.float64) tensor(-10.0780, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3860, dtype=torch.float64) delta_t tensor(0.0624, dtype=torch.float64)
13 gae_duplicate tensor(0.1444, dtype=torch.float64) tensor(-6.9100, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3321, dtype=torch.float64) delta_t tensor(0.0807, dtype=torch.float64)
12 gae_duplicate tensor(-0.8302, dtype=torch.float64) tensor(-10.3788, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3862, dtype=torch.float64) delta_t tensor(0.1226, dtype=torch.float64)
11 gae_duplicate tensor(-1.6950, dtype=torch.float64) tensor(-6.2977, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1169, dtype=torch.float64) delta_t tensor(-0.4404, dtype=torch.float64)
10 gae_duplicate tensor(-2.9181, dtype=torch.float64) tensor(2.9951, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4512, dtype=torch.float64) delta_t tensor(-0.0696, dtype=torch.float64)
9 gae_duplicate tensor(-4.1997, dtype=torch.float64) tensor(2.9982, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0379, dtype=torch.float64) delta_t tensor(-0.1204, dtype=torch.float64)
8 gae_duplicate tensor(-3.3912, dtype=torch.float64) tensor(0.9776, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4614, dtype=torch.float64) delta_t tensor(-0.5579, dtype=torch.float64)
7 gae_duplicate tensor(-5.2076, dtype=torch.float64) tensor(0.9404, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2100, dtype=torch.float64) delta_t tensor(-0.1391, dtype=torch.float64)
6 gae_duplicate tensor(-5.1687, dtype=torch.float64) tensor(11.7330, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8767, dtype=torch.float64) delta_t tensor(-0.8522, dtype=torch.float64)
5 gae_duplicate tensor(-5.4542, dtype=torch.float64) tensor(18.6592, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2399, dtype=torch.float64) delta_t tensor(0.2048, dtype=torch.float64)
4 gae_duplicate tensor(-4.3114, dtype=torch.float64) tensor(10.2143, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5864, dtype=torch.float64) delta_t tensor(-0.3995, dtype=torch.float64)
3 gae_duplicate tensor(-3.4348, dtype=torch.float64) tensor(17.6768, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3776, dtype=torch.float64) delta_t tensor(-0.4313, dtype=torch.float64)
2 gae_duplicate tensor(-3.1229, dtype=torch.float64) tensor(13.4278, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1449.53955078125
value loss:476.740478515625
entropies:175.5179901123047
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.944015026092529 seconds
19 rew tensor(0.6024, dtype=torch.float64) delta_t tensor(-0.4735, dtype=torch.float64)
19 gae_duplicate tensor(-1.2691, dtype=torch.float64) tensor(3.3959, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4856, dtype=torch.float64) delta_t tensor(0.3628, dtype=torch.float64)
18 gae_duplicate tensor(-1.3449, dtype=torch.float64) tensor(-2.0214, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6467, dtype=torch.float64) delta_t tensor(0.3553, dtype=torch.float64)
17 gae_duplicate tensor(-0.5216, dtype=torch.float64) tensor(-2.2699, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5331, dtype=torch.float64) delta_t tensor(0.3633, dtype=torch.float64)
16 gae_duplicate tensor(-0.0385, dtype=torch.float64) tensor(-5.7047, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3777, dtype=torch.float64) delta_t tensor(0.2895, dtype=torch.float64)
15 gae_duplicate tensor(-0.1008, dtype=torch.float64) tensor(-6.3316, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6644, dtype=torch.float64) delta_t tensor(0.4657, dtype=torch.float64)
14 gae_duplicate tensor(0.4184, dtype=torch.float64) tensor(-8.7234, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6334, dtype=torch.float64) delta_t tensor(0.5645, dtype=torch.float64)
13 gae_duplicate tensor(0.5067, dtype=torch.float64) tensor(-14.6301, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6590, dtype=torch.float64) delta_t tensor(0.5360, dtype=torch.float64)
12 gae_duplicate tensor(0.5209, dtype=torch.float64) tensor(-21.3403, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3983, dtype=torch.float64) delta_t tensor(0.5412, dtype=torch.float64)
11 gae_duplicate tensor(0.0272, dtype=torch.float64) tensor(-22.1677, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1103, dtype=torch.float64) delta_t tensor(-0.0533, dtype=torch.float64)
10 gae_duplicate tensor(-0.0689, dtype=torch.float64) tensor(-17.8111, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0160, dtype=torch.float64) delta_t tensor(-0.1214, dtype=torch.float64)
9 gae_duplicate tensor(-1.6294, dtype=torch.float64) tensor(-7.9152, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2715, dtype=torch.float64) delta_t tensor(-0.3418, dtype=torch.float64)
8 gae_duplicate tensor(-0.9954, dtype=torch.float64) tensor(-7.0199, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6641, dtype=torch.float64) delta_t tensor(-0.7383, dtype=torch.float64)
7 gae_duplicate tensor(-1.8388, dtype=torch.float64) tensor(-0.3292, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9519, dtype=torch.float64) delta_t tensor(-1.1000, dtype=torch.float64)
6 gae_duplicate tensor(-4.0576, dtype=torch.float64) tensor(8.5991, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2489, dtype=torch.float64) delta_t tensor(-1.1768, dtype=torch.float64)
5 gae_duplicate tensor(-4.9328, dtype=torch.float64) tensor(31.8947, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2770, dtype=torch.float64) delta_t tensor(-1.0752, dtype=torch.float64)
4 gae_duplicate tensor(-9.0182, dtype=torch.float64) tensor(36.1466, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4835, dtype=torch.float64) delta_t tensor(-0.4038, dtype=torch.float64)
3 gae_duplicate tensor(-6.9836, dtype=torch.float64) tensor(19.8579, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1882, dtype=torch.float64) delta_t tensor(-0.5365, dtype=torch.float64)
2 gae_duplicate tensor(-5.7811, dtype=torch.float64) tensor(21.8199, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-227.375732421875
value loss:707.296630859375
entropies:173.2809295654297
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.94553804397583 seconds
19 rew tensor(0.5515, dtype=torch.float64) delta_t tensor(-0.7019, dtype=torch.float64)
19 gae_duplicate tensor(-1.7271, dtype=torch.float64) tensor(5.7642, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3577, dtype=torch.float64) delta_t tensor(0.2393, dtype=torch.float64)
18 gae_duplicate tensor(-2.0593, dtype=torch.float64) tensor(3.7799, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6416, dtype=torch.float64) delta_t tensor(0.5439, dtype=torch.float64)
17 gae_duplicate tensor(-1.1055, dtype=torch.float64) tensor(-0.7091, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5231, dtype=torch.float64) delta_t tensor(0.2930, dtype=torch.float64)
16 gae_duplicate tensor(-0.2972, dtype=torch.float64) tensor(-4.4851, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3338, dtype=torch.float64) delta_t tensor(0.2599, dtype=torch.float64)
15 gae_duplicate tensor(-0.6427, dtype=torch.float64) tensor(-12.7877, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6841, dtype=torch.float64) delta_t tensor(0.5938, dtype=torch.float64)
14 gae_duplicate tensor(0.0053, dtype=torch.float64) tensor(-6.8892, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5463, dtype=torch.float64) delta_t tensor(0.2683, dtype=torch.float64)
13 gae_duplicate tensor(0.4266, dtype=torch.float64) tensor(-13.3867, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5510, dtype=torch.float64) delta_t tensor(0.2145, dtype=torch.float64)
12 gae_duplicate tensor(0.7832, dtype=torch.float64) tensor(-9.0590, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2157, dtype=torch.float64) delta_t tensor(0.1483, dtype=torch.float64)
11 gae_duplicate tensor(-0.5412, dtype=torch.float64) tensor(-13.1373, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4369, dtype=torch.float64) delta_t tensor(0.0475, dtype=torch.float64)
10 gae_duplicate tensor(-0.4340, dtype=torch.float64) tensor(-10.2488, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0512, dtype=torch.float64) delta_t tensor(-0.1967, dtype=torch.float64)
9 gae_duplicate tensor(-0.5856, dtype=torch.float64) tensor(-6.8595, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3112, dtype=torch.float64) delta_t tensor(-0.4356, dtype=torch.float64)
8 gae_duplicate tensor(-1.9452, dtype=torch.float64) tensor(-3.9353, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3055, dtype=torch.float64) delta_t tensor(-1.2581, dtype=torch.float64)
7 gae_duplicate tensor(-4.8798, dtype=torch.float64) tensor(10.7246, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8051, dtype=torch.float64) delta_t tensor(-0.7460, dtype=torch.float64)
6 gae_duplicate tensor(-4.7109, dtype=torch.float64) tensor(7.0897, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4425, dtype=torch.float64) delta_t tensor(-1.4100, dtype=torch.float64)
5 gae_duplicate tensor(-5.6635, dtype=torch.float64) tensor(24.0131, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7937, dtype=torch.float64) delta_t tensor(-1.8011, dtype=torch.float64)
4 gae_duplicate tensor(-10.7452, dtype=torch.float64) tensor(33.3653, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1642, dtype=torch.float64) delta_t tensor(0.0202, dtype=torch.float64)
3 gae_duplicate tensor(-8.3085, dtype=torch.float64) tensor(46.9905, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3141, dtype=torch.float64) delta_t tensor(-0.3053, dtype=torch.float64)
2 gae_duplicate tensor(-6.8175, dtype=torch.float64) tensor(53.6144, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3769.393798828125
value loss:897.63134765625
entropies:172.25979614257812
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.673178195953369 seconds
19 rew tensor(0.6658, dtype=torch.float64) delta_t tensor(-0.4630, dtype=torch.float64)
19 gae_duplicate tensor(-1.0803, dtype=torch.float64) tensor(2.5200, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5870, dtype=torch.float64) delta_t tensor(0.3342, dtype=torch.float64)
18 gae_duplicate tensor(-1.4534, dtype=torch.float64) tensor(-1.0724, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4434, dtype=torch.float64) delta_t tensor(0.3789, dtype=torch.float64)
17 gae_duplicate tensor(-1.9145, dtype=torch.float64) tensor(-0.1915, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7456, dtype=torch.float64) delta_t tensor(0.4738, dtype=torch.float64)
16 gae_duplicate tensor(-0.9784, dtype=torch.float64) tensor(-8.1389, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7460, dtype=torch.float64) delta_t tensor(0.6549, dtype=torch.float64)
15 gae_duplicate tensor(-0.2293, dtype=torch.float64) tensor(-15.5317, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7391, dtype=torch.float64) delta_t tensor(0.5521, dtype=torch.float64)
14 gae_duplicate tensor(0.3325, dtype=torch.float64) tensor(-12.5824, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7394, dtype=torch.float64) delta_t tensor(0.7028, dtype=torch.float64)
13 gae_duplicate tensor(0.7887, dtype=torch.float64) tensor(-33.2730, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6771, dtype=torch.float64) delta_t tensor(0.4186, dtype=torch.float64)
12 gae_duplicate tensor(0.5530, dtype=torch.float64) tensor(-18.4031, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3903, dtype=torch.float64) delta_t tensor(0.3307, dtype=torch.float64)
11 gae_duplicate tensor(0.7895, dtype=torch.float64) tensor(-20.3035, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4214, dtype=torch.float64) delta_t tensor(-0.3976, dtype=torch.float64)
10 gae_duplicate tensor(-0.9908, dtype=torch.float64) tensor(-17.9959, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9496, dtype=torch.float64) delta_t tensor(-1.1667, dtype=torch.float64)
9 gae_duplicate tensor(-5.6769, dtype=torch.float64) tensor(0.0086, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5347, dtype=torch.float64) delta_t tensor(-0.5754, dtype=torch.float64)
8 gae_duplicate tensor(-5.6679, dtype=torch.float64) tensor(1.1551, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3136, dtype=torch.float64) delta_t tensor(-0.1004, dtype=torch.float64)
7 gae_duplicate tensor(-4.2201, dtype=torch.float64) tensor(0.5595, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3571, dtype=torch.float64) delta_t tensor(-0.3931, dtype=torch.float64)
6 gae_duplicate tensor(-4.5305, dtype=torch.float64) tensor(9.4353, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7029, dtype=torch.float64) delta_t tensor(-0.5853, dtype=torch.float64)
5 gae_duplicate tensor(-5.7052, dtype=torch.float64) tensor(12.8711, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5668, dtype=torch.float64) delta_t tensor(-0.7068, dtype=torch.float64)
4 gae_duplicate tensor(-6.0110, dtype=torch.float64) tensor(14.1156, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8792, dtype=torch.float64) delta_t tensor(-0.7160, dtype=torch.float64)
3 gae_duplicate tensor(-5.0700, dtype=torch.float64) tensor(22.7497, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3687, dtype=torch.float64) delta_t tensor(-0.4825, dtype=torch.float64)
2 gae_duplicate tensor(-4.2134, dtype=torch.float64) tensor(26.0637, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1337.2119140625
value loss:688.5562133789062
entropies:173.78469848632812
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2279.2085)
ToM Target loss= tensor(1808.9666)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.8318421840667725 seconds
19 rew tensor(0.6842, dtype=torch.float64) delta_t tensor(-0.6435, dtype=torch.float64)
19 gae_duplicate tensor(-0.8172, dtype=torch.float64) tensor(4.8732, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6236, dtype=torch.float64) delta_t tensor(0.3897, dtype=torch.float64)
18 gae_duplicate tensor(-0.4780, dtype=torch.float64) tensor(0.5677, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5089, dtype=torch.float64) delta_t tensor(0.3077, dtype=torch.float64)
17 gae_duplicate tensor(-0.5197, dtype=torch.float64) tensor(-1.8263, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3035, dtype=torch.float64) delta_t tensor(0.3074, dtype=torch.float64)
16 gae_duplicate tensor(-0.4728, dtype=torch.float64) tensor(-3.6352, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2292, dtype=torch.float64) delta_t tensor(0.2938, dtype=torch.float64)
15 gae_duplicate tensor(-0.2240, dtype=torch.float64) tensor(-3.2114, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5296, dtype=torch.float64) delta_t tensor(0.4465, dtype=torch.float64)
14 gae_duplicate tensor(-0.2516, dtype=torch.float64) tensor(-10.5736, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7461, dtype=torch.float64) delta_t tensor(0.6254, dtype=torch.float64)
13 gae_duplicate tensor(0.3486, dtype=torch.float64) tensor(-15.4837, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0752, dtype=torch.float64) delta_t tensor(-0.1161, dtype=torch.float64)
12 gae_duplicate tensor(-2.3237, dtype=torch.float64) tensor(-11.2158, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1770, dtype=torch.float64) delta_t tensor(-0.0995, dtype=torch.float64)
11 gae_duplicate tensor(-3.5663, dtype=torch.float64) tensor(-5.0980, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2763, dtype=torch.float64) delta_t tensor(-0.2241, dtype=torch.float64)
10 gae_duplicate tensor(-2.8027, dtype=torch.float64) tensor(3.6121, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4916, dtype=torch.float64) delta_t tensor(-0.7778, dtype=torch.float64)
9 gae_duplicate tensor(-2.4964, dtype=torch.float64) tensor(4.5349, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0111, dtype=torch.float64) delta_t tensor(-1.1886, dtype=torch.float64)
8 gae_duplicate tensor(-3.8711, dtype=torch.float64) tensor(13.7650, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8359, dtype=torch.float64) delta_t tensor(-0.8059, dtype=torch.float64)
7 gae_duplicate tensor(-3.7203, dtype=torch.float64) tensor(27.3236, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2325, dtype=torch.float64) delta_t tensor(-0.0738, dtype=torch.float64)
6 gae_duplicate tensor(-4.1723, dtype=torch.float64) tensor(21.1441, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3723, dtype=torch.float64) delta_t tensor(-1.3149, dtype=torch.float64)
5 gae_duplicate tensor(-6.2680, dtype=torch.float64) tensor(27.0810, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6550, dtype=torch.float64) delta_t tensor(-1.4192, dtype=torch.float64)
4 gae_duplicate tensor(-8.8600, dtype=torch.float64) tensor(39.1126, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1870, dtype=torch.float64) delta_t tensor(-0.0004, dtype=torch.float64)
3 gae_duplicate tensor(-7.1532, dtype=torch.float64) tensor(42.8421, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2270, dtype=torch.float64) delta_t tensor(-0.5550, dtype=torch.float64)
2 gae_duplicate tensor(-5.9602, dtype=torch.float64) tensor(26.9946, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5819.5830078125
value loss:868.9188232421875
entropies:169.63299560546875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.9212327003479 seconds
19 rew tensor(0.7078, dtype=torch.float64) delta_t tensor(-0.5136, dtype=torch.float64)
19 gae_duplicate tensor(-0.8020, dtype=torch.float64) tensor(5.0580, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6844, dtype=torch.float64) delta_t tensor(0.4371, dtype=torch.float64)
18 gae_duplicate tensor(-0.3222, dtype=torch.float64) tensor(0.0841, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6143, dtype=torch.float64) delta_t tensor(0.3466, dtype=torch.float64)
17 gae_duplicate tensor(-0.0755, dtype=torch.float64) tensor(-2.3037, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4971, dtype=torch.float64) delta_t tensor(0.3895, dtype=torch.float64)
16 gae_duplicate tensor(0.1123, dtype=torch.float64) tensor(-8.8821, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2477, dtype=torch.float64) delta_t tensor(0.2374, dtype=torch.float64)
15 gae_duplicate tensor(-0.0526, dtype=torch.float64) tensor(-5.9200, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5235, dtype=torch.float64) delta_t tensor(0.4320, dtype=torch.float64)
14 gae_duplicate tensor(0.4318, dtype=torch.float64) tensor(-9.1100, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7320, dtype=torch.float64) delta_t tensor(0.4582, dtype=torch.float64)
13 gae_duplicate tensor(0.8017, dtype=torch.float64) tensor(-16.9725, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5295, dtype=torch.float64) delta_t tensor(0.2810, dtype=torch.float64)
12 gae_duplicate tensor(0.1406, dtype=torch.float64) tensor(-14.2413, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6245, dtype=torch.float64) delta_t tensor(0.5679, dtype=torch.float64)
11 gae_duplicate tensor(0.6762, dtype=torch.float64) tensor(-12.8597, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5302, dtype=torch.float64) delta_t tensor(0.5247, dtype=torch.float64)
10 gae_duplicate tensor(1.2141, dtype=torch.float64) tensor(-17.5865, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0587, dtype=torch.float64) delta_t tensor(-0.2524, dtype=torch.float64)
9 gae_duplicate tensor(-0.4567, dtype=torch.float64) tensor(-11.9464, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3079, dtype=torch.float64) delta_t tensor(-0.3512, dtype=torch.float64)
8 gae_duplicate tensor(-1.9257, dtype=torch.float64) tensor(-6.6326, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3787, dtype=torch.float64) delta_t tensor(-0.3997, dtype=torch.float64)
7 gae_duplicate tensor(-3.0659, dtype=torch.float64) tensor(-3.5871, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7692, dtype=torch.float64) delta_t tensor(-0.6637, dtype=torch.float64)
6 gae_duplicate tensor(-5.2375, dtype=torch.float64) tensor(7.1490, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5844, dtype=torch.float64) delta_t tensor(-0.4469, dtype=torch.float64)
5 gae_duplicate tensor(-3.1821, dtype=torch.float64) tensor(9.5259, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3886, dtype=torch.float64) delta_t tensor(-0.4477, dtype=torch.float64)
4 gae_duplicate tensor(-2.6009, dtype=torch.float64) tensor(16.8019, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3832, dtype=torch.float64) delta_t tensor(-0.1879, dtype=torch.float64)
3 gae_duplicate tensor(-2.5305, dtype=torch.float64) tensor(9.1494, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5936, dtype=torch.float64) delta_t tensor(-0.6912, dtype=torch.float64)
2 gae_duplicate tensor(-2.2594, dtype=torch.float64) tensor(20.7992, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1462.11669921875
value loss:324.84478759765625
entropies:172.01004028320312
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.6482179164886475 seconds
19 rew tensor(0.5150, dtype=torch.float64) delta_t tensor(-0.5202, dtype=torch.float64)
19 gae_duplicate tensor(-0.9412, dtype=torch.float64) tensor(6.6935, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6546, dtype=torch.float64) delta_t tensor(0.3749, dtype=torch.float64)
18 gae_duplicate tensor(-0.6548, dtype=torch.float64) tensor(-0.0191, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5461, dtype=torch.float64) delta_t tensor(0.3002, dtype=torch.float64)
17 gae_duplicate tensor(-0.6434, dtype=torch.float64) tensor(-3.9278, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3758, dtype=torch.float64) delta_t tensor(0.3394, dtype=torch.float64)
16 gae_duplicate tensor(-0.7376, dtype=torch.float64) tensor(-7.9977, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5229, dtype=torch.float64) delta_t tensor(0.5431, dtype=torch.float64)
15 gae_duplicate tensor(0.0733, dtype=torch.float64) tensor(-11.2912, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6872, dtype=torch.float64) delta_t tensor(0.4719, dtype=torch.float64)
14 gae_duplicate tensor(0.5805, dtype=torch.float64) tensor(-12.8637, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6640, dtype=torch.float64) delta_t tensor(0.5189, dtype=torch.float64)
13 gae_duplicate tensor(0.4284, dtype=torch.float64) tensor(-13.9777, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6735, dtype=torch.float64) delta_t tensor(0.4356, dtype=torch.float64)
12 gae_duplicate tensor(0.7985, dtype=torch.float64) tensor(-12.2957, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6872, dtype=torch.float64) delta_t tensor(0.3287, dtype=torch.float64)
11 gae_duplicate tensor(1.0432, dtype=torch.float64) tensor(-12.7841, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.2312, dtype=torch.float64) delta_t tensor(-1.2200, dtype=torch.float64)
10 gae_duplicate tensor(-4.4229, dtype=torch.float64) tensor(-4.9771, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5064, dtype=torch.float64) delta_t tensor(-0.7957, dtype=torch.float64)
9 gae_duplicate tensor(-3.4261, dtype=torch.float64) tensor(8.3845, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1888, dtype=torch.float64) delta_t tensor(-0.0812, dtype=torch.float64)
8 gae_duplicate tensor(-2.2915, dtype=torch.float64) tensor(4.4792, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3416, dtype=torch.float64) delta_t tensor(-0.3471, dtype=torch.float64)
7 gae_duplicate tensor(-2.1666, dtype=torch.float64) tensor(10.9497, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8446, dtype=torch.float64) delta_t tensor(-0.8214, dtype=torch.float64)
6 gae_duplicate tensor(-2.4545, dtype=torch.float64) tensor(18.8419, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5022, dtype=torch.float64) delta_t tensor(-1.4615, dtype=torch.float64)
5 gae_duplicate tensor(-5.5054, dtype=torch.float64) tensor(33.0565, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7276, dtype=torch.float64) delta_t tensor(-0.6139, dtype=torch.float64)
4 gae_duplicate tensor(-6.1593, dtype=torch.float64) tensor(25.5220, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1407, dtype=torch.float64) delta_t tensor(-0.0403, dtype=torch.float64)
3 gae_duplicate tensor(-3.9196, dtype=torch.float64) tensor(16.7044, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2470, dtype=torch.float64) delta_t tensor(-0.3201, dtype=torch.float64)
2 gae_duplicate tensor(-3.4898, dtype=torch.float64) tensor(13.8240, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2130.692626953125
value loss:599.3135986328125
entropies:172.8690643310547
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.83932900428772 seconds
19 rew tensor(0.7475, dtype=torch.float64) delta_t tensor(-0.0881, dtype=torch.float64)
19 gae_duplicate tensor(-0.6813, dtype=torch.float64) tensor(0.1150, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7401, dtype=torch.float64) delta_t tensor(0.5611, dtype=torch.float64)
18 gae_duplicate tensor(-0.0820, dtype=torch.float64) tensor(-4.0825, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7163, dtype=torch.float64) delta_t tensor(0.5010, dtype=torch.float64)
17 gae_duplicate tensor(0.3978, dtype=torch.float64) tensor(-12.6620, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7174, dtype=torch.float64) delta_t tensor(0.3199, dtype=torch.float64)
16 gae_duplicate tensor(0.6109, dtype=torch.float64) tensor(-11.7304, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6857, dtype=torch.float64) delta_t tensor(0.3545, dtype=torch.float64)
15 gae_duplicate tensor(0.6919, dtype=torch.float64) tensor(-18.2133, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6401, dtype=torch.float64) delta_t tensor(0.4058, dtype=torch.float64)
14 gae_duplicate tensor(0.7903, dtype=torch.float64) tensor(-12.9302, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6084, dtype=torch.float64) delta_t tensor(0.3489, dtype=torch.float64)
13 gae_duplicate tensor(0.6704, dtype=torch.float64) tensor(-7.9904, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7017, dtype=torch.float64) delta_t tensor(0.3417, dtype=torch.float64)
12 gae_duplicate tensor(0.9521, dtype=torch.float64) tensor(-10.7449, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6860, dtype=torch.float64) delta_t tensor(0.4137, dtype=torch.float64)
11 gae_duplicate tensor(1.1778, dtype=torch.float64) tensor(-13.5991, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2800, dtype=torch.float64) delta_t tensor(-0.3833, dtype=torch.float64)
10 gae_duplicate tensor(-0.9076, dtype=torch.float64) tensor(-4.1162, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0282, dtype=torch.float64) delta_t tensor(0.1782, dtype=torch.float64)
9 gae_duplicate tensor(-0.3877, dtype=torch.float64) tensor(-7.4233, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5082, dtype=torch.float64) delta_t tensor(-0.9717, dtype=torch.float64)
8 gae_duplicate tensor(-1.8394, dtype=torch.float64) tensor(1.5521, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0539, dtype=torch.float64) delta_t tensor(-1.0413, dtype=torch.float64)
7 gae_duplicate tensor(-3.1088, dtype=torch.float64) tensor(6.7432, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0439, dtype=torch.float64) delta_t tensor(-1.0265, dtype=torch.float64)
6 gae_duplicate tensor(-4.4169, dtype=torch.float64) tensor(11.2290, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5145, dtype=torch.float64) delta_t tensor(-1.4426, dtype=torch.float64)
5 gae_duplicate tensor(-5.8998, dtype=torch.float64) tensor(36.3144, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0990, dtype=torch.float64) delta_t tensor(-0.7283, dtype=torch.float64)
4 gae_duplicate tensor(-8.0399, dtype=torch.float64) tensor(33.1614, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3050, dtype=torch.float64) delta_t tensor(-0.2517, dtype=torch.float64)
3 gae_duplicate tensor(-6.7980, dtype=torch.float64) tensor(47.6469, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1671, dtype=torch.float64) delta_t tensor(-0.2711, dtype=torch.float64)
2 gae_duplicate tensor(-5.2781, dtype=torch.float64) tensor(16.3444, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1816.3763427734375
value loss:762.51171875
entropies:168.14573669433594
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.904285192489624 seconds
19 rew tensor(0.7406, dtype=torch.float64) delta_t tensor(-0.2397, dtype=torch.float64)
19 gae_duplicate tensor(-0.6432, dtype=torch.float64) tensor(3.2146, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7186, dtype=torch.float64) delta_t tensor(0.5371, dtype=torch.float64)
18 gae_duplicate tensor(-0.2595, dtype=torch.float64) tensor(-4.0910, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6888, dtype=torch.float64) delta_t tensor(0.6257, dtype=torch.float64)
17 gae_duplicate tensor(0.5166, dtype=torch.float64) tensor(-10.8970, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6459, dtype=torch.float64) delta_t tensor(0.3623, dtype=torch.float64)
16 gae_duplicate tensor(0.4419, dtype=torch.float64) tensor(-7.1651, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5346, dtype=torch.float64) delta_t tensor(0.4654, dtype=torch.float64)
15 gae_duplicate tensor(0.5467, dtype=torch.float64) tensor(-14.3406, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6792, dtype=torch.float64) delta_t tensor(0.6213, dtype=torch.float64)
14 gae_duplicate tensor(0.5003, dtype=torch.float64) tensor(-11.7550, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0385, dtype=torch.float64) delta_t tensor(-0.1861, dtype=torch.float64)
13 gae_duplicate tensor(-3.2750, dtype=torch.float64) tensor(-14.6030, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2523, dtype=torch.float64) delta_t tensor(0.1136, dtype=torch.float64)
12 gae_duplicate tensor(-2.3495, dtype=torch.float64) tensor(-9.0391, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5271, dtype=torch.float64) delta_t tensor(0.5478, dtype=torch.float64)
11 gae_duplicate tensor(-0.9904, dtype=torch.float64) tensor(-17.3760, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6877, dtype=torch.float64) delta_t tensor(-0.7006, dtype=torch.float64)
10 gae_duplicate tensor(-2.0011, dtype=torch.float64) tensor(-1.8670, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4811, dtype=torch.float64) delta_t tensor(-0.8147, dtype=torch.float64)
9 gae_duplicate tensor(-3.8729, dtype=torch.float64) tensor(5.8425, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1731, dtype=torch.float64) delta_t tensor(0.0482, dtype=torch.float64)
8 gae_duplicate tensor(-3.5224, dtype=torch.float64) tensor(-0.4749, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1541, dtype=torch.float64) delta_t tensor(-0.2761, dtype=torch.float64)
7 gae_duplicate tensor(-2.3636, dtype=torch.float64) tensor(5.5136, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2363, dtype=torch.float64) delta_t tensor(-0.1448, dtype=torch.float64)
6 gae_duplicate tensor(-1.9067, dtype=torch.float64) tensor(8.2645, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4967, dtype=torch.float64) delta_t tensor(-0.3832, dtype=torch.float64)
5 gae_duplicate tensor(-1.7589, dtype=torch.float64) tensor(8.5852, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1274, dtype=torch.float64) delta_t tensor(-0.0661, dtype=torch.float64)
4 gae_duplicate tensor(-1.4443, dtype=torch.float64) tensor(9.2358, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5509, dtype=torch.float64) delta_t tensor(-0.4354, dtype=torch.float64)
3 gae_duplicate tensor(-2.0347, dtype=torch.float64) tensor(6.5235, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3200, dtype=torch.float64) delta_t tensor(-0.5101, dtype=torch.float64)
2 gae_duplicate tensor(-2.0961, dtype=torch.float64) tensor(20.0014, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:848.6597290039062
value loss:383.98687744140625
entropies:170.7667694091797
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2248.1533)
ToM Target loss= tensor(1809.4126)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.899665117263794 seconds
19 rew tensor(0.4530, dtype=torch.float64) delta_t tensor(-0.5637, dtype=torch.float64)
19 gae_duplicate tensor(-1.7884, dtype=torch.float64) tensor(5.7666, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.1803, dtype=torch.float64) delta_t tensor(0.1088, dtype=torch.float64)
18 gae_duplicate tensor(-2.3059, dtype=torch.float64) tensor(4.4836, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3736, dtype=torch.float64) delta_t tensor(0.3197, dtype=torch.float64)
17 gae_duplicate tensor(-1.2064, dtype=torch.float64) tensor(-2.9318, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4824, dtype=torch.float64) delta_t tensor(0.3196, dtype=torch.float64)
16 gae_duplicate tensor(-0.5004, dtype=torch.float64) tensor(-1.1584, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6072, dtype=torch.float64) delta_t tensor(0.4549, dtype=torch.float64)
15 gae_duplicate tensor(0.2166, dtype=torch.float64) tensor(-4.7141, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5868, dtype=torch.float64) delta_t tensor(0.4347, dtype=torch.float64)
14 gae_duplicate tensor(0.5081, dtype=torch.float64) tensor(-11.0412, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5959, dtype=torch.float64) delta_t tensor(0.4261, dtype=torch.float64)
13 gae_duplicate tensor(0.6498, dtype=torch.float64) tensor(-6.4061, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3267, dtype=torch.float64) delta_t tensor(0.1417, dtype=torch.float64)
12 gae_duplicate tensor(0.1093, dtype=torch.float64) tensor(-6.7886, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2876, dtype=torch.float64) delta_t tensor(0.0945, dtype=torch.float64)
11 gae_duplicate tensor(-1.0043, dtype=torch.float64) tensor(-11.7770, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3994, dtype=torch.float64) delta_t tensor(0.1685, dtype=torch.float64)
10 gae_duplicate tensor(-0.3446, dtype=torch.float64) tensor(-5.8784, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2502, dtype=torch.float64) delta_t tensor(-1.0296, dtype=torch.float64)
9 gae_duplicate tensor(-4.8369, dtype=torch.float64) tensor(1.6143, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2648, dtype=torch.float64) delta_t tensor(-0.3214, dtype=torch.float64)
8 gae_duplicate tensor(-3.4138, dtype=torch.float64) tensor(3.1922, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5061, dtype=torch.float64) delta_t tensor(-0.6324, dtype=torch.float64)
7 gae_duplicate tensor(-2.9436, dtype=torch.float64) tensor(10.5285, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6596, dtype=torch.float64) delta_t tensor(-0.3802, dtype=torch.float64)
6 gae_duplicate tensor(-2.9799, dtype=torch.float64) tensor(5.4007, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0191, dtype=torch.float64) delta_t tensor(-0.9392, dtype=torch.float64)
5 gae_duplicate tensor(-4.7325, dtype=torch.float64) tensor(24.5752, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7298, dtype=torch.float64) delta_t tensor(-0.7822, dtype=torch.float64)
4 gae_duplicate tensor(-6.0000, dtype=torch.float64) tensor(18.2807, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1009, dtype=torch.float64) delta_t tensor(0.0495, dtype=torch.float64)
3 gae_duplicate tensor(-4.6617, dtype=torch.float64) tensor(14.5685, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2645, dtype=torch.float64) delta_t tensor(-0.4845, dtype=torch.float64)
2 gae_duplicate tensor(-4.1397, dtype=torch.float64) tensor(19.8415, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2102.369873046875
value loss:517.4472045898438
entropies:168.56704711914062
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.829807996749878 seconds
19 rew tensor(0.7144, dtype=torch.float64) delta_t tensor(-0.4978, dtype=torch.float64)
19 gae_duplicate tensor(-0.7761, dtype=torch.float64) tensor(3.3609, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6908, dtype=torch.float64) delta_t tensor(0.4696, dtype=torch.float64)
18 gae_duplicate tensor(-0.5039, dtype=torch.float64) tensor(-0.2567, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6122, dtype=torch.float64) delta_t tensor(0.5314, dtype=torch.float64)
17 gae_duplicate tensor(-0.0355, dtype=torch.float64) tensor(-7.3381, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5003, dtype=torch.float64) delta_t tensor(0.3763, dtype=torch.float64)
16 gae_duplicate tensor(-0.3997, dtype=torch.float64) tensor(-5.9663, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7392, dtype=torch.float64) delta_t tensor(0.6740, dtype=torch.float64)
15 gae_duplicate tensor(0.3881, dtype=torch.float64) tensor(-16.1703, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7475, dtype=torch.float64) delta_t tensor(0.7187, dtype=torch.float64)
14 gae_duplicate tensor(1.0387, dtype=torch.float64) tensor(-17.7423, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7405, dtype=torch.float64) delta_t tensor(0.6489, dtype=torch.float64)
13 gae_duplicate tensor(1.5596, dtype=torch.float64) tensor(-18.4150, dtype=torch.float64, grad_fn=<SumBackward0>)
12 gae_duplicate tensor(1.7617, dtype=torch.float64) tensor(-14.0228, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6797, dtype=torch.float64) delta_t tensor(0.4695, dtype=torch.float64)
11 gae_duplicate tensor(1.8919, dtype=torch.float64) tensor(-21.5735, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2930, dtype=torch.float64) delta_t tensor(-0.2037, dtype=torch.float64)
10 gae_duplicate tensor(-2.5476, dtype=torch.float64) tensor(-24.5094, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2813, dtype=torch.float64) delta_t tensor(-1.6144, dtype=torch.float64)
9 gae_duplicate tensor(-6.5192, dtype=torch.float64) tensor(10.2914, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6075, dtype=torch.float64) delta_t tensor(-1.7262, dtype=torch.float64)
8 gae_duplicate tensor(-4.9590, dtype=torch.float64) tensor(24.1480, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1975, dtype=torch.float64) delta_t tensor(-0.1156, dtype=torch.float64)
7 gae_duplicate tensor(-3.5743, dtype=torch.float64) tensor(17.9506, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8785, dtype=torch.float64) delta_t tensor(-0.7487, dtype=torch.float64)
6 gae_duplicate tensor(-2.9584, dtype=torch.float64) tensor(32.5672, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6864, dtype=torch.float64) delta_t tensor(-0.6467, dtype=torch.float64)
5 gae_duplicate tensor(-4.1667, dtype=torch.float64) tensor(25.9046, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7882, dtype=torch.float64) delta_t tensor(-2.5656, dtype=torch.float64)
4 gae_duplicate tensor(-8.3835, dtype=torch.float64) tensor(23.1843, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0700, dtype=torch.float64) delta_t tensor(0.0805, dtype=torch.float64)
3 gae_duplicate tensor(-6.9279, dtype=torch.float64) tensor(47.2514, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2416, dtype=torch.float64) delta_t tensor(-0.3464, dtype=torch.float64)
2 gae_duplicate tensor(-5.5668, dtype=torch.float64) tensor(34.8126, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3394.908203125
value loss:1130.780517578125
entropies:165.26951599121094
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.998589992523193 seconds
19 rew tensor(0.5966, dtype=torch.float64) delta_t tensor(-0.5862, dtype=torch.float64)
19 gae_duplicate tensor(-1.2763, dtype=torch.float64) tensor(4.1182, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4699, dtype=torch.float64) delta_t tensor(0.4631, dtype=torch.float64)
18 gae_duplicate tensor(-1.2285, dtype=torch.float64) tensor(0.7248, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6276, dtype=torch.float64) delta_t tensor(0.4907, dtype=torch.float64)
17 gae_duplicate tensor(-0.4999, dtype=torch.float64) tensor(-1.9306, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4999, dtype=torch.float64) delta_t tensor(0.4933, dtype=torch.float64)
16 gae_duplicate tensor(-0.6198, dtype=torch.float64) tensor(-8.6429, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7396, dtype=torch.float64) delta_t tensor(0.5822, dtype=torch.float64)
15 gae_duplicate tensor(0.1726, dtype=torch.float64) tensor(-13.5251, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7404, dtype=torch.float64) delta_t tensor(0.6238, dtype=torch.float64)
14 gae_duplicate tensor(0.8068, dtype=torch.float64) tensor(-13.9220, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7335, dtype=torch.float64) delta_t tensor(0.3204, dtype=torch.float64)
13 gae_duplicate tensor(0.8990, dtype=torch.float64) tensor(-6.7008, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7108, dtype=torch.float64) delta_t tensor(0.7481, dtype=torch.float64)
12 gae_duplicate tensor(0.8997, dtype=torch.float64) tensor(-20.7331, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7485, dtype=torch.float64) delta_t tensor(0.5317, dtype=torch.float64)
11 gae_duplicate tensor(1.0765, dtype=torch.float64) tensor(-18.5464, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6473, dtype=torch.float64) delta_t tensor(0.5370, dtype=torch.float64)
10 gae_duplicate tensor(1.3328, dtype=torch.float64) tensor(-21.5048, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4416, dtype=torch.float64) delta_t tensor(-0.2810, dtype=torch.float64)
9 gae_duplicate tensor(-1.4091, dtype=torch.float64) tensor(-14.3650, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2195, dtype=torch.float64) delta_t tensor(-1.4612, dtype=torch.float64)
8 gae_duplicate tensor(-5.8269, dtype=torch.float64) tensor(-4.5411, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4426, dtype=torch.float64) delta_t tensor(-0.4257, dtype=torch.float64)
7 gae_duplicate tensor(-4.2446, dtype=torch.float64) tensor(1.9481, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7246, dtype=torch.float64) delta_t tensor(-0.7315, dtype=torch.float64)
6 gae_duplicate tensor(-3.0611, dtype=torch.float64) tensor(17.7384, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0335, dtype=torch.float64) delta_t tensor(-0.9440, dtype=torch.float64)
5 gae_duplicate tensor(-4.8711, dtype=torch.float64) tensor(16.6256, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6315, dtype=torch.float64) delta_t tensor(-0.5462, dtype=torch.float64)
4 gae_duplicate tensor(-5.5287, dtype=torch.float64) tensor(25.4814, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2139, dtype=torch.float64) delta_t tensor(-0.0131, dtype=torch.float64)
3 gae_duplicate tensor(-4.3771, dtype=torch.float64) tensor(16.9330, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5533, dtype=torch.float64) delta_t tensor(-0.5009, dtype=torch.float64)
2 gae_duplicate tensor(-3.9076, dtype=torch.float64) tensor(22.3553, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:635.7432861328125
value loss:667.1791381835938
entropies:165.47897338867188
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.096536874771118 seconds
19 rew tensor(0.7037, dtype=torch.float64) delta_t tensor(-0.1783, dtype=torch.float64)
19 gae_duplicate tensor(-0.8185, dtype=torch.float64) tensor(0.0110, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6751, dtype=torch.float64) delta_t tensor(0.4989, dtype=torch.float64)
18 gae_duplicate tensor(-0.5893, dtype=torch.float64) tensor(-2.4630, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5883, dtype=torch.float64) delta_t tensor(0.3801, dtype=torch.float64)
17 gae_duplicate tensor(-1.0770, dtype=torch.float64) tensor(-4.8611, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4591, dtype=torch.float64) delta_t tensor(0.3780, dtype=torch.float64)
16 gae_duplicate tensor(-1.3136, dtype=torch.float64) tensor(-8.7505, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7479, dtype=torch.float64) delta_t tensor(0.4240, dtype=torch.float64)
15 gae_duplicate tensor(-0.4468, dtype=torch.float64) tensor(-12.2236, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7482, dtype=torch.float64) delta_t tensor(0.5555, dtype=torch.float64)
14 gae_duplicate tensor(0.2468, dtype=torch.float64) tensor(-17.5173, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7408, dtype=torch.float64) delta_t tensor(0.5697, dtype=torch.float64)
13 gae_duplicate tensor(0.8021, dtype=torch.float64) tensor(-11.2740, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6696, dtype=torch.float64) delta_t tensor(0.3446, dtype=torch.float64)
12 gae_duplicate tensor(1.2465, dtype=torch.float64) tensor(-19.1380, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1301, dtype=torch.float64) delta_t tensor(-0.0743, dtype=torch.float64)
11 gae_duplicate tensor(-1.8083, dtype=torch.float64) tensor(-16.2881, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4150, dtype=torch.float64) delta_t tensor(0.1023, dtype=torch.float64)
10 gae_duplicate tensor(-1.9829, dtype=torch.float64) tensor(-14.9835, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3094, dtype=torch.float64) delta_t tensor(-0.4087, dtype=torch.float64)
9 gae_duplicate tensor(-1.4057, dtype=torch.float64) tensor(0.0567, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2439, dtype=torch.float64) delta_t tensor(-0.4260, dtype=torch.float64)
8 gae_duplicate tensor(-2.4941, dtype=torch.float64) tensor(-3.8993, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5771, dtype=torch.float64) delta_t tensor(-0.4117, dtype=torch.float64)
7 gae_duplicate tensor(-1.8281, dtype=torch.float64) tensor(4.3603, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1976, dtype=torch.float64) delta_t tensor(-1.0972, dtype=torch.float64)
6 gae_duplicate tensor(-3.4333, dtype=torch.float64) tensor(20.6375, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2529, dtype=torch.float64) delta_t tensor(-1.1663, dtype=torch.float64)
5 gae_duplicate tensor(-4.4834, dtype=torch.float64) tensor(16.7755, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1456, dtype=torch.float64) delta_t tensor(-2.1010, dtype=torch.float64)
4 gae_duplicate tensor(-7.2809, dtype=torch.float64) tensor(23.6757, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0290, dtype=torch.float64) delta_t tensor(0.1389, dtype=torch.float64)
3 gae_duplicate tensor(-6.0933, dtype=torch.float64) tensor(22.1100, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5578, dtype=torch.float64) delta_t tensor(-0.5500, dtype=torch.float64)
2 gae_duplicate tensor(-4.9272, dtype=torch.float64) tensor(35.3401, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-445.7785339355469
value loss:801.0993041992188
entropies:162.87060546875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.6087870597839355 seconds
19 rew tensor(0.6077, dtype=torch.float64) delta_t tensor(-0.3795, dtype=torch.float64)
19 gae_duplicate tensor(-0.7836, dtype=torch.float64) tensor(4.9499, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5058, dtype=torch.float64) delta_t tensor(0.1357, dtype=torch.float64)
18 gae_duplicate tensor(-0.5647, dtype=torch.float64) tensor(2.4696, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2568, dtype=torch.float64) delta_t tensor(0.0534, dtype=torch.float64)
17 gae_duplicate tensor(-0.7545, dtype=torch.float64) tensor(-0.7223, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0786, dtype=torch.float64) delta_t tensor(0.2509, dtype=torch.float64)
16 gae_duplicate tensor(-0.9620, dtype=torch.float64) tensor(-6.3347, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7321, dtype=torch.float64) delta_t tensor(0.5304, dtype=torch.float64)
15 gae_duplicate tensor(-0.2034, dtype=torch.float64) tensor(-2.0482, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7080, dtype=torch.float64) delta_t tensor(0.3867, dtype=torch.float64)
14 gae_duplicate tensor(0.4037, dtype=torch.float64) tensor(-9.8225, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6681, dtype=torch.float64) delta_t tensor(0.5776, dtype=torch.float64)
13 gae_duplicate tensor(0.8898, dtype=torch.float64) tensor(-15.9314, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0466, dtype=torch.float64) delta_t tensor(-0.2861, dtype=torch.float64)
12 gae_duplicate tensor(-2.3975, dtype=torch.float64) tensor(-12.1111, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7181, dtype=torch.float64) delta_t tensor(0.2233, dtype=torch.float64)
11 gae_duplicate tensor(-1.5651, dtype=torch.float64) tensor(-12.6822, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4173, dtype=torch.float64) delta_t tensor(0.3685, dtype=torch.float64)
10 gae_duplicate tensor(-1.7485, dtype=torch.float64) tensor(-10.4499, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6481, dtype=torch.float64) delta_t tensor(-0.4857, dtype=torch.float64)
9 gae_duplicate tensor(-2.6318, dtype=torch.float64) tensor(-7.0018, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3634, dtype=torch.float64) delta_t tensor(-0.4718, dtype=torch.float64)
8 gae_duplicate tensor(-3.8104, dtype=torch.float64) tensor(1.3899, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0681, dtype=torch.float64) delta_t tensor(-0.0321, dtype=torch.float64)
7 gae_duplicate tensor(-2.1687, dtype=torch.float64) tensor(-2.9820, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8373, dtype=torch.float64) delta_t tensor(-0.9854, dtype=torch.float64)
6 gae_duplicate tensor(-3.5312, dtype=torch.float64) tensor(6.1985, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7659, dtype=torch.float64) delta_t tensor(-0.4481, dtype=torch.float64)
5 gae_duplicate tensor(-4.3943, dtype=torch.float64) tensor(9.2183, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5434, dtype=torch.float64) delta_t tensor(-0.2976, dtype=torch.float64)
4 gae_duplicate tensor(-4.6756, dtype=torch.float64) tensor(16.1821, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3630, dtype=torch.float64) delta_t tensor(-0.2267, dtype=torch.float64)
3 gae_duplicate tensor(-3.5344, dtype=torch.float64) tensor(19.5478, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4863, dtype=torch.float64) delta_t tensor(-0.6383, dtype=torch.float64)
2 gae_duplicate tensor(-3.0038, dtype=torch.float64) tensor(14.6390, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:168.52342224121094
value loss:378.6605224609375
entropies:161.9464111328125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2225.2439)
ToM Target loss= tensor(1807.8545)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.735322713851929 seconds
19 rew tensor(0.6352, dtype=torch.float64) delta_t tensor(-0.3923, dtype=torch.float64)
19 gae_duplicate tensor(-0.9480, dtype=torch.float64) tensor(2.1268, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5041, dtype=torch.float64) delta_t tensor(0.3268, dtype=torch.float64)
18 gae_duplicate tensor(-1.0464, dtype=torch.float64) tensor(1.5374, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2924, dtype=torch.float64) delta_t tensor(0.2122, dtype=torch.float64)
17 gae_duplicate tensor(-1.6684, dtype=torch.float64) tensor(-1.1141, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4599, dtype=torch.float64) delta_t tensor(0.3909, dtype=torch.float64)
16 gae_duplicate tensor(-0.7961, dtype=torch.float64) tensor(-7.0165, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5984, dtype=torch.float64) delta_t tensor(0.5695, dtype=torch.float64)
15 gae_duplicate tensor(0.1437, dtype=torch.float64) tensor(-7.2714, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7342, dtype=torch.float64) delta_t tensor(0.6677, dtype=torch.float64)
14 gae_duplicate tensor(0.6786, dtype=torch.float64) tensor(-13.7062, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6433, dtype=torch.float64) delta_t tensor(0.5643, dtype=torch.float64)
13 gae_duplicate tensor(1.0770, dtype=torch.float64) tensor(-10.4656, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5363, dtype=torch.float64) delta_t tensor(0.2323, dtype=torch.float64)
12 gae_duplicate tensor(1.0491, dtype=torch.float64) tensor(-9.2376, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5105, dtype=torch.float64) delta_t tensor(0.1627, dtype=torch.float64)
11 gae_duplicate tensor(0.9582, dtype=torch.float64) tensor(-10.0917, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4635, dtype=torch.float64) delta_t tensor(0.0998, dtype=torch.float64)
10 gae_duplicate tensor(-0.0303, dtype=torch.float64) tensor(-8.3447, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3154, dtype=torch.float64) delta_t tensor(-0.1809, dtype=torch.float64)
9 gae_duplicate tensor(-0.6345, dtype=torch.float64) tensor(-9.4728, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7526, dtype=torch.float64) delta_t tensor(-0.8793, dtype=torch.float64)
8 gae_duplicate tensor(-1.2706, dtype=torch.float64) tensor(1.9447, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8735, dtype=torch.float64) delta_t tensor(-0.8897, dtype=torch.float64)
7 gae_duplicate tensor(-3.1678, dtype=torch.float64) tensor(15.7714, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9026, dtype=torch.float64) delta_t tensor(-0.7846, dtype=torch.float64)
6 gae_duplicate tensor(-3.7810, dtype=torch.float64) tensor(12.6451, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3353, dtype=torch.float64) delta_t tensor(-1.2545, dtype=torch.float64)
5 gae_duplicate tensor(-5.6540, dtype=torch.float64) tensor(20.4833, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8941, dtype=torch.float64) delta_t tensor(-0.7052, dtype=torch.float64)
4 gae_duplicate tensor(-7.2563, dtype=torch.float64) tensor(18.6301, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2186, dtype=torch.float64) delta_t tensor(-0.0101, dtype=torch.float64)
3 gae_duplicate tensor(-5.0680, dtype=torch.float64) tensor(19.1196, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1618, dtype=torch.float64) delta_t tensor(-0.1381, dtype=torch.float64)
2 gae_duplicate tensor(-4.0354, dtype=torch.float64) tensor(17.3997, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1214.8682861328125
value loss:628.0386962890625
entropies:161.80520629882812
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.747209072113037 seconds
19 rew tensor(0.6786, dtype=torch.float64) delta_t tensor(-0.4025, dtype=torch.float64)
19 gae_duplicate tensor(-0.6734, dtype=torch.float64) tensor(4.1131, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6229, dtype=torch.float64) delta_t tensor(0.3581, dtype=torch.float64)
18 gae_duplicate tensor(-0.5856, dtype=torch.float64) tensor(0.4177, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5040, dtype=torch.float64) delta_t tensor(0.2686, dtype=torch.float64)
17 gae_duplicate tensor(-0.5480, dtype=torch.float64) tensor(-1.1292, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2650, dtype=torch.float64) delta_t tensor(0.2406, dtype=torch.float64)
16 gae_duplicate tensor(-0.6775, dtype=torch.float64) tensor(-4.1724, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2825, dtype=torch.float64) delta_t tensor(0.2537, dtype=torch.float64)
15 gae_duplicate tensor(-0.1611, dtype=torch.float64) tensor(-3.0460, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6044, dtype=torch.float64) delta_t tensor(0.4927, dtype=torch.float64)
14 gae_duplicate tensor(0.3174, dtype=torch.float64) tensor(-11.8383, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6964, dtype=torch.float64) delta_t tensor(0.4284, dtype=torch.float64)
13 gae_duplicate tensor(0.7862, dtype=torch.float64) tensor(-12.9374, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6091, dtype=torch.float64) delta_t tensor(0.7736, dtype=torch.float64)
12 gae_duplicate tensor(1.1891, dtype=torch.float64) tensor(-17.8867, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2084, dtype=torch.float64) delta_t tensor(-0.4854, dtype=torch.float64)
11 gae_duplicate tensor(-1.1902, dtype=torch.float64) tensor(-8.6035, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1579, dtype=torch.float64) delta_t tensor(-0.1947, dtype=torch.float64)
10 gae_duplicate tensor(-1.2932, dtype=torch.float64) tensor(-0.9824, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2558, dtype=torch.float64) delta_t tensor(-0.4909, dtype=torch.float64)
9 gae_duplicate tensor(-3.8470, dtype=torch.float64) tensor(8.4766, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1065, dtype=torch.float64) delta_t tensor(0.0105, dtype=torch.float64)
8 gae_duplicate tensor(-2.0151, dtype=torch.float64) tensor(-5.3522, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1285, dtype=torch.float64) delta_t tensor(-0.1036, dtype=torch.float64)
7 gae_duplicate tensor(-2.5359, dtype=torch.float64) tensor(1.5784, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2355, dtype=torch.float64) delta_t tensor(-0.0647, dtype=torch.float64)
6 gae_duplicate tensor(-2.2077, dtype=torch.float64) tensor(3.8226, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7140, dtype=torch.float64) delta_t tensor(-0.5789, dtype=torch.float64)
5 gae_duplicate tensor(-3.5963, dtype=torch.float64) tensor(15.2698, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5812, dtype=torch.float64) delta_t tensor(-0.5000, dtype=torch.float64)
4 gae_duplicate tensor(-6.3678, dtype=torch.float64) tensor(5.7606, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2287, dtype=torch.float64) delta_t tensor(-0.1122, dtype=torch.float64)
3 gae_duplicate tensor(-5.0278, dtype=torch.float64) tensor(10.4346, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3377, dtype=torch.float64) delta_t tensor(-0.4745, dtype=torch.float64)
2 gae_duplicate tensor(-4.0129, dtype=torch.float64) tensor(16.7711, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-54.07405471801758
value loss:395.2547607421875
entropies:161.1104278564453
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.764661073684692 seconds
19 rew tensor(0.6523, dtype=torch.float64) delta_t tensor(-0.3446, dtype=torch.float64)
19 gae_duplicate tensor(-0.8641, dtype=torch.float64) tensor(0.5367, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5690, dtype=torch.float64) delta_t tensor(0.4173, dtype=torch.float64)
18 gae_duplicate tensor(-0.9296, dtype=torch.float64) tensor(0.1974, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3964, dtype=torch.float64) delta_t tensor(0.3203, dtype=torch.float64)
17 gae_duplicate tensor(-1.1611, dtype=torch.float64) tensor(-4.6759, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4946, dtype=torch.float64) delta_t tensor(0.3662, dtype=torch.float64)
16 gae_duplicate tensor(-0.3685, dtype=torch.float64) tensor(-4.6386, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4772, dtype=torch.float64) delta_t tensor(0.2193, dtype=torch.float64)
15 gae_duplicate tensor(0.0644, dtype=torch.float64) tensor(-6.2769, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3568, dtype=torch.float64) delta_t tensor(0.2625, dtype=torch.float64)
14 gae_duplicate tensor(-0.1182, dtype=torch.float64) tensor(-9.5435, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6555, dtype=torch.float64) delta_t tensor(0.8375, dtype=torch.float64)
13 gae_duplicate tensor(0.4546, dtype=torch.float64) tensor(-16.9340, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6231, dtype=torch.float64) delta_t tensor(0.3992, dtype=torch.float64)
12 gae_duplicate tensor(0.8023, dtype=torch.float64) tensor(-21.4004, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5658, dtype=torch.float64) delta_t tensor(0.4554, dtype=torch.float64)
11 gae_duplicate tensor(1.0471, dtype=torch.float64) tensor(-14.3483, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6749, dtype=torch.float64) delta_t tensor(0.5627, dtype=torch.float64)
10 gae_duplicate tensor(1.2873, dtype=torch.float64) tensor(-14.8294, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3127, dtype=torch.float64) delta_t tensor(-0.4886, dtype=torch.float64)
9 gae_duplicate tensor(-0.5961, dtype=torch.float64) tensor(-5.3329, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6476, dtype=torch.float64) delta_t tensor(-0.7863, dtype=torch.float64)
8 gae_duplicate tensor(-2.2374, dtype=torch.float64) tensor(-1.1368, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6249, dtype=torch.float64) delta_t tensor(-0.5352, dtype=torch.float64)
7 gae_duplicate tensor(-3.4714, dtype=torch.float64) tensor(-3.1218, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8240, dtype=torch.float64) delta_t tensor(-0.7424, dtype=torch.float64)
6 gae_duplicate tensor(-3.2661, dtype=torch.float64) tensor(4.7121, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2953, dtype=torch.float64) delta_t tensor(-0.9709, dtype=torch.float64)
5 gae_duplicate tensor(-4.0572, dtype=torch.float64) tensor(22.3235, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7590, dtype=torch.float64) delta_t tensor(-0.6958, dtype=torch.float64)
4 gae_duplicate tensor(-6.9937, dtype=torch.float64) tensor(8.4708, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3851, dtype=torch.float64) delta_t tensor(-0.2835, dtype=torch.float64)
3 gae_duplicate tensor(-5.5118, dtype=torch.float64) tensor(11.9430, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2737, dtype=torch.float64) delta_t tensor(-0.2636, dtype=torch.float64)
2 gae_duplicate tensor(-4.4569, dtype=torch.float64) tensor(26.7285, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:955.0755615234375
value loss:531.611083984375
entropies:159.30514526367188
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.877551078796387 seconds
19 rew tensor(0.4528, dtype=torch.float64) delta_t tensor(-0.5750, dtype=torch.float64)
19 gae_duplicate tensor(-1.2696, dtype=torch.float64) tensor(2.8124, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6813, dtype=torch.float64) delta_t tensor(0.3443, dtype=torch.float64)
18 gae_duplicate tensor(-0.5978, dtype=torch.float64) tensor(0.0743, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6129, dtype=torch.float64) delta_t tensor(0.4417, dtype=torch.float64)
17 gae_duplicate tensor(-0.6984, dtype=torch.float64) tensor(-2.6502, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4931, dtype=torch.float64) delta_t tensor(0.6122, dtype=torch.float64)
16 gae_duplicate tensor(-0.7896, dtype=torch.float64) tensor(-10.5541, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7506, dtype=torch.float64) delta_t tensor(0.7897, dtype=torch.float64)
15 gae_duplicate tensor(0.0492, dtype=torch.float64) tensor(-22.0536, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7350, dtype=torch.float64) delta_t tensor(0.4836, dtype=torch.float64)
14 gae_duplicate tensor(0.3402, dtype=torch.float64) tensor(-22.6292, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7182, dtype=torch.float64) delta_t tensor(0.5976, dtype=torch.float64)
13 gae_duplicate tensor(0.9061, dtype=torch.float64) tensor(-18.1210, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7200, dtype=torch.float64) delta_t tensor(0.6871, dtype=torch.float64)
12 gae_duplicate tensor(1.3753, dtype=torch.float64) tensor(-19.3614, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1898, dtype=torch.float64) delta_t tensor(-0.2043, dtype=torch.float64)
11 gae_duplicate tensor(-2.7557, dtype=torch.float64) tensor(-25.1549, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1884, dtype=torch.float64) delta_t tensor(-0.1704, dtype=torch.float64)
10 gae_duplicate tensor(-4.2234, dtype=torch.float64) tensor(-12.1591, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1066, dtype=torch.float64) delta_t tensor(-0.0704, dtype=torch.float64)
9 gae_duplicate tensor(-2.9685, dtype=torch.float64) tensor(-13.6840, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7407, dtype=torch.float64) delta_t tensor(-0.5843, dtype=torch.float64)
8 gae_duplicate tensor(-1.9836, dtype=torch.float64) tensor(-3.6856, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2863, dtype=torch.float64) delta_t tensor(-0.4610, dtype=torch.float64)
7 gae_duplicate tensor(-1.4978, dtype=torch.float64) tensor(2.2316, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8564, dtype=torch.float64) delta_t tensor(-0.5856, dtype=torch.float64)
6 gae_duplicate tensor(-2.2823, dtype=torch.float64) tensor(11.3508, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7463, dtype=torch.float64) delta_t tensor(-0.5064, dtype=torch.float64)
5 gae_duplicate tensor(-3.4385, dtype=torch.float64) tensor(7.3892, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9485, dtype=torch.float64) delta_t tensor(-2.8749, dtype=torch.float64)
4 gae_duplicate tensor(-9.0332, dtype=torch.float64) tensor(29.4095, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3656, dtype=torch.float64) delta_t tensor(-0.4071, dtype=torch.float64)
3 gae_duplicate tensor(-7.4337, dtype=torch.float64) tensor(16.9142, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1521, dtype=torch.float64) delta_t tensor(-0.1494, dtype=torch.float64)
2 gae_duplicate tensor(-5.9466, dtype=torch.float64) tensor(16.3091, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2259.655517578125
value loss:982.5062255859375
entropies:158.74490356445312
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.751629114151001 seconds
19 rew tensor(0.4793, dtype=torch.float64) delta_t tensor(-0.3822, dtype=torch.float64)
19 gae_duplicate tensor(-1.2688, dtype=torch.float64) tensor(0.9464, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7266, dtype=torch.float64) delta_t tensor(0.5675, dtype=torch.float64)
18 gae_duplicate tensor(-0.3856, dtype=torch.float64) tensor(-3.6726, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6951, dtype=torch.float64) delta_t tensor(0.5261, dtype=torch.float64)
17 gae_duplicate tensor(0.0105, dtype=torch.float64) tensor(-5.9572, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6333, dtype=torch.float64) delta_t tensor(0.7281, dtype=torch.float64)
16 gae_duplicate tensor(0.1615, dtype=torch.float64) tensor(-13.0190, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4667, dtype=torch.float64) delta_t tensor(0.7378, dtype=torch.float64)
15 gae_duplicate tensor(-0.0224, dtype=torch.float64) tensor(-28.0430, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6668, dtype=torch.float64) delta_t tensor(0.5796, dtype=torch.float64)
14 gae_duplicate tensor(0.6549, dtype=torch.float64) tensor(-21.5785, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4739, dtype=torch.float64) delta_t tensor(0.2038, dtype=torch.float64)
13 gae_duplicate tensor(0.9293, dtype=torch.float64) tensor(-17.7877, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6217, dtype=torch.float64) delta_t tensor(0.3671, dtype=torch.float64)
12 gae_duplicate tensor(0.3786, dtype=torch.float64) tensor(-26.1424, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5781, dtype=torch.float64) delta_t tensor(0.4219, dtype=torch.float64)
11 gae_duplicate tensor(0.2480, dtype=torch.float64) tensor(-16.4935, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4313, dtype=torch.float64) delta_t tensor(0.3625, dtype=torch.float64)
10 gae_duplicate tensor(0.7102, dtype=torch.float64) tensor(-17.5277, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1020, dtype=torch.float64) delta_t tensor(-1.1716, dtype=torch.float64)
9 gae_duplicate tensor(-0.9193, dtype=torch.float64) tensor(-3.2671, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5810, dtype=torch.float64) delta_t tensor(-0.6615, dtype=torch.float64)
8 gae_duplicate tensor(-1.7122, dtype=torch.float64) tensor(1.4360, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4489, dtype=torch.float64) delta_t tensor(-0.3320, dtype=torch.float64)
7 gae_duplicate tensor(-2.8804, dtype=torch.float64) tensor(0.8795, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3926, dtype=torch.float64) delta_t tensor(-0.2674, dtype=torch.float64)
6 gae_duplicate tensor(-3.6548, dtype=torch.float64) tensor(1.2433, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8314, dtype=torch.float64) delta_t tensor(-0.8563, dtype=torch.float64)
5 gae_duplicate tensor(-4.3882, dtype=torch.float64) tensor(23.1556, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3054, dtype=torch.float64) delta_t tensor(-0.1563, dtype=torch.float64)
4 gae_duplicate tensor(-6.2251, dtype=torch.float64) tensor(14.5395, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2529, dtype=torch.float64) delta_t tensor(-0.1057, dtype=torch.float64)
3 gae_duplicate tensor(-4.5549, dtype=torch.float64) tensor(12.1714, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1497, dtype=torch.float64) delta_t tensor(-0.0760, dtype=torch.float64)
2 gae_duplicate tensor(-3.6366, dtype=torch.float64) tensor(7.8673, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3255.98828125
value loss:536.0289916992188
entropies:161.0985107421875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2174.8787)
ToM Target loss= tensor(1805.9622)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.423774003982544 seconds
19 rew tensor(0.6614, dtype=torch.float64) delta_t tensor(-0.6021, dtype=torch.float64)
19 gae_duplicate tensor(-0.9748, dtype=torch.float64) tensor(5.6119, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5646, dtype=torch.float64) delta_t tensor(0.2987, dtype=torch.float64)
18 gae_duplicate tensor(-0.9008, dtype=torch.float64) tensor(0.7057, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4003, dtype=torch.float64) delta_t tensor(0.4048, dtype=torch.float64)
17 gae_duplicate tensor(-0.6597, dtype=torch.float64) tensor(0.8891, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6362, dtype=torch.float64) delta_t tensor(0.5838, dtype=torch.float64)
16 gae_duplicate tensor(0.0999, dtype=torch.float64) tensor(-6.6910, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5440, dtype=torch.float64) delta_t tensor(0.5913, dtype=torch.float64)
15 gae_duplicate tensor(0.3260, dtype=torch.float64) tensor(-7.6249, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6479, dtype=torch.float64) delta_t tensor(0.5777, dtype=torch.float64)
14 gae_duplicate tensor(0.8283, dtype=torch.float64) tensor(-12.8749, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6852, dtype=torch.float64) delta_t tensor(0.4319, dtype=torch.float64)
13 gae_duplicate tensor(1.2392, dtype=torch.float64) tensor(-11.2534, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3861, dtype=torch.float64) delta_t tensor(-0.0529, dtype=torch.float64)
12 gae_duplicate tensor(-0.8343, dtype=torch.float64) tensor(-9.8746, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0691, dtype=torch.float64) delta_t tensor(0.2022, dtype=torch.float64)
11 gae_duplicate tensor(-3.0378, dtype=torch.float64) tensor(-23.1290, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3974, dtype=torch.float64) delta_t tensor(0.2162, dtype=torch.float64)
10 gae_duplicate tensor(-3.0137, dtype=torch.float64) tensor(-15.5017, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7204, dtype=torch.float64) delta_t tensor(-0.9670, dtype=torch.float64)
9 gae_duplicate tensor(-2.1286, dtype=torch.float64) tensor(-3.2546, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8590, dtype=torch.float64) delta_t tensor(-0.9801, dtype=torch.float64)
8 gae_duplicate tensor(-2.4041, dtype=torch.float64) tensor(7.8633, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6833, dtype=torch.float64) delta_t tensor(-0.6582, dtype=torch.float64)
7 gae_duplicate tensor(-3.3829, dtype=torch.float64) tensor(7.5043, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2164, dtype=torch.float64) delta_t tensor(-0.8485, dtype=torch.float64)
6 gae_duplicate tensor(-4.7013, dtype=torch.float64) tensor(25.3263, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7750, dtype=torch.float64) delta_t tensor(-0.6345, dtype=torch.float64)
5 gae_duplicate tensor(-5.4056, dtype=torch.float64) tensor(28.4711, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0873, dtype=torch.float64) delta_t tensor(-1.1414, dtype=torch.float64)
4 gae_duplicate tensor(-7.4854, dtype=torch.float64) tensor(43.4693, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3075, dtype=torch.float64) delta_t tensor(-0.0727, dtype=torch.float64)
3 gae_duplicate tensor(-5.9631, dtype=torch.float64) tensor(24.3578, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3925, dtype=torch.float64) delta_t tensor(-0.2933, dtype=torch.float64)
2 gae_duplicate tensor(-4.7284, dtype=torch.float64) tensor(15.9427, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2546.73779296875
value loss:771.1022338867188
entropies:161.07989501953125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.318907976150513 seconds
19 rew tensor(0.7340, dtype=torch.float64) delta_t tensor(-0.2479, dtype=torch.float64)
19 gae_duplicate tensor(-0.6941, dtype=torch.float64) tensor(4.8652, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7170, dtype=torch.float64) delta_t tensor(0.7354, dtype=torch.float64)
18 gae_duplicate tensor(-0.2596, dtype=torch.float64) tensor(-7.6612, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7000, dtype=torch.float64) delta_t tensor(0.6983, dtype=torch.float64)
17 gae_duplicate tensor(-0.0301, dtype=torch.float64) tensor(-13.8405, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6399, dtype=torch.float64) delta_t tensor(0.4665, dtype=torch.float64)
16 gae_duplicate tensor(-0.1985, dtype=torch.float64) tensor(-8.1448, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4035, dtype=torch.float64) delta_t tensor(0.3542, dtype=torch.float64)
15 gae_duplicate tensor(-0.3384, dtype=torch.float64) tensor(-21.2731, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7212, dtype=torch.float64) delta_t tensor(0.6141, dtype=torch.float64)
14 gae_duplicate tensor(0.3641, dtype=torch.float64) tensor(-13.1100, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4801, dtype=torch.float64) delta_t tensor(0.3222, dtype=torch.float64)
13 gae_duplicate tensor(0.9264, dtype=torch.float64) tensor(-14.7063, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0091, dtype=torch.float64) delta_t tensor(-0.1052, dtype=torch.float64)
12 gae_duplicate tensor(-0.9132, dtype=torch.float64) tensor(-11.5962, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1581, dtype=torch.float64) delta_t tensor(-0.0754, dtype=torch.float64)
11 gae_duplicate tensor(-1.8926, dtype=torch.float64) tensor(-11.6138, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2574, dtype=torch.float64) delta_t tensor(-0.4464, dtype=torch.float64)
10 gae_duplicate tensor(-2.0303, dtype=torch.float64) tensor(-3.4895, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0398, dtype=torch.float64) delta_t tensor(0.0870, dtype=torch.float64)
9 gae_duplicate tensor(-0.8670, dtype=torch.float64) tensor(-6.4429, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0693, dtype=torch.float64) delta_t tensor(0.0885, dtype=torch.float64)
8 gae_duplicate tensor(-1.0667, dtype=torch.float64) tensor(-2.7977, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5471, dtype=torch.float64) delta_t tensor(-0.1884, dtype=torch.float64)
7 gae_duplicate tensor(-0.5728, dtype=torch.float64) tensor(-1.1714, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1598, dtype=torch.float64) delta_t tensor(0.1164, dtype=torch.float64)
6 gae_duplicate tensor(-0.4610, dtype=torch.float64) tensor(-1.3868, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9077, dtype=torch.float64) delta_t tensor(-0.8173, dtype=torch.float64)
5 gae_duplicate tensor(-1.8511, dtype=torch.float64) tensor(7.7472, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2376, dtype=torch.float64) delta_t tensor(-1.1775, dtype=torch.float64)
4 gae_duplicate tensor(-8.4756, dtype=torch.float64) tensor(22.8265, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3534, dtype=torch.float64) delta_t tensor(-0.1910, dtype=torch.float64)
3 gae_duplicate tensor(-6.7819, dtype=torch.float64) tensor(10.6995, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2292, dtype=torch.float64) delta_t tensor(-0.3637, dtype=torch.float64)
2 gae_duplicate tensor(-5.5245, dtype=torch.float64) tensor(8.8140, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2213.025390625
value loss:481.549560546875
entropies:161.76956176757812
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.797199010848999 seconds
19 rew tensor(0.7349, dtype=torch.float64) delta_t tensor(-0.3798, dtype=torch.float64)
19 gae_duplicate tensor(-0.6566, dtype=torch.float64) tensor(3.1711, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7274, dtype=torch.float64) delta_t tensor(0.4931, dtype=torch.float64)
18 gae_duplicate tensor(-0.1779, dtype=torch.float64) tensor(-0.1373, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6890, dtype=torch.float64) delta_t tensor(0.3528, dtype=torch.float64)
17 gae_duplicate tensor(-0.0673, dtype=torch.float64) tensor(-4.5990, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6343, dtype=torch.float64) delta_t tensor(0.3563, dtype=torch.float64)
16 gae_duplicate tensor(-0.2595, dtype=torch.float64) tensor(-3.9276, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5428, dtype=torch.float64) delta_t tensor(0.4543, dtype=torch.float64)
15 gae_duplicate tensor(-0.3372, dtype=torch.float64) tensor(-12.0548, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7361, dtype=torch.float64) delta_t tensor(0.7363, dtype=torch.float64)
14 gae_duplicate tensor(0.3216, dtype=torch.float64) tensor(-10.6960, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7200, dtype=torch.float64) delta_t tensor(0.6109, dtype=torch.float64)
13 gae_duplicate tensor(0.8490, dtype=torch.float64) tensor(-15.1962, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2266, dtype=torch.float64) delta_t tensor(0.1975, dtype=torch.float64)
12 gae_duplicate tensor(-0.2774, dtype=torch.float64) tensor(-21.5021, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2527, dtype=torch.float64) delta_t tensor(-0.2552, dtype=torch.float64)
11 gae_duplicate tensor(-2.6206, dtype=torch.float64) tensor(-17.0616, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6494, dtype=torch.float64) delta_t tensor(0.4614, dtype=torch.float64)
10 gae_duplicate tensor(-1.4849, dtype=torch.float64) tensor(-11.7800, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1402, dtype=torch.float64) delta_t tensor(-0.1816, dtype=torch.float64)
9 gae_duplicate tensor(-0.7923, dtype=torch.float64) tensor(-10.8276, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3629, dtype=torch.float64) delta_t tensor(-0.3339, dtype=torch.float64)
8 gae_duplicate tensor(-0.4985, dtype=torch.float64) tensor(-2.5147, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0928, dtype=torch.float64) delta_t tensor(-0.3767, dtype=torch.float64)
7 gae_duplicate tensor(-1.2020, dtype=torch.float64) tensor(0.1978, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8540, dtype=torch.float64) delta_t tensor(-0.5905, dtype=torch.float64)
6 gae_duplicate tensor(-2.2577, dtype=torch.float64) tensor(1.1031, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7631, dtype=torch.float64) delta_t tensor(-0.5044, dtype=torch.float64)
5 gae_duplicate tensor(-4.4354, dtype=torch.float64) tensor(14.6268, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9095, dtype=torch.float64) delta_t tensor(-1.8150, dtype=torch.float64)
4 gae_duplicate tensor(-11.4415, dtype=torch.float64) tensor(31.8510, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1447, dtype=torch.float64) delta_t tensor(-0.0352, dtype=torch.float64)
3 gae_duplicate tensor(-9.0539, dtype=torch.float64) tensor(27.4849, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4508, dtype=torch.float64) delta_t tensor(-0.5538, dtype=torch.float64)
2 gae_duplicate tensor(-7.1607, dtype=torch.float64) tensor(10.5499, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:737.819580078125
value loss:809.1311645507812
entropies:163.4894561767578
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.405529737472534 seconds
19 rew tensor(0.4371, dtype=torch.float64) delta_t tensor(-0.4840, dtype=torch.float64)
19 gae_duplicate tensor(-1.1647, dtype=torch.float64) tensor(3.1864, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6203, dtype=torch.float64) delta_t tensor(0.5001, dtype=torch.float64)
18 gae_duplicate tensor(-1.0963, dtype=torch.float64) tensor(-0.4717, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5097, dtype=torch.float64) delta_t tensor(0.5827, dtype=torch.float64)
17 gae_duplicate tensor(-1.1332, dtype=torch.float64) tensor(-7.3208, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7473, dtype=torch.float64) delta_t tensor(0.5478, dtype=torch.float64)
16 gae_duplicate tensor(-0.3030, dtype=torch.float64) tensor(-13.0339, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7476, dtype=torch.float64) delta_t tensor(0.7163, dtype=torch.float64)
15 gae_duplicate tensor(0.3613, dtype=torch.float64) tensor(-14.4613, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7478, dtype=torch.float64) delta_t tensor(0.4062, dtype=torch.float64)
14 gae_duplicate tensor(0.8740, dtype=torch.float64) tensor(-17.6124, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7113, dtype=torch.float64) delta_t tensor(0.4085, dtype=torch.float64)
13 gae_duplicate tensor(1.1128, dtype=torch.float64) tensor(-16.5458, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1451, dtype=torch.float64) delta_t tensor(0.1073, dtype=torch.float64)
12 gae_duplicate tensor(-1.2367, dtype=torch.float64) tensor(-8.5119, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1219, dtype=torch.float64) delta_t tensor(0.0790, dtype=torch.float64)
11 gae_duplicate tensor(-1.4899, dtype=torch.float64) tensor(-4.4313, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5509, dtype=torch.float64) delta_t tensor(0.3443, dtype=torch.float64)
10 gae_duplicate tensor(-0.9935, dtype=torch.float64) tensor(-11.6120, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3265, dtype=torch.float64) delta_t tensor(0.2376, dtype=torch.float64)
9 gae_duplicate tensor(-0.1444, dtype=torch.float64) tensor(-12.4139, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1198, dtype=torch.float64) delta_t tensor(0.1491, dtype=torch.float64)
8 gae_duplicate tensor(0.2189, dtype=torch.float64) tensor(-8.8948, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5616, dtype=torch.float64) delta_t tensor(-0.5553, dtype=torch.float64)
7 gae_duplicate tensor(-0.6123, dtype=torch.float64) tensor(-3.3843, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6590, dtype=torch.float64) delta_t tensor(-0.4510, dtype=torch.float64)
6 gae_duplicate tensor(-1.7470, dtype=torch.float64) tensor(-0.6439, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2949, dtype=torch.float64) delta_t tensor(-1.3972, dtype=torch.float64)
5 gae_duplicate tensor(-3.1796, dtype=torch.float64) tensor(15.3317, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.8260, dtype=torch.float64) delta_t tensor(-3.7113, dtype=torch.float64)
4 gae_duplicate tensor(-11.1226, dtype=torch.float64) tensor(19.7114, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4924, dtype=torch.float64) delta_t tensor(-0.1253, dtype=torch.float64)
3 gae_duplicate tensor(-8.7180, dtype=torch.float64) tensor(41.5330, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3621, dtype=torch.float64) delta_t tensor(-0.4190, dtype=torch.float64)
2 gae_duplicate tensor(-7.0744, dtype=torch.float64) tensor(52.7185, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-502.9481201171875
value loss:1222.6416015625
entropies:165.5636749267578
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.677986145019531 seconds
19 rew tensor(0.6076, dtype=torch.float64) delta_t tensor(-0.3564, dtype=torch.float64)
19 gae_duplicate tensor(-1.3392, dtype=torch.float64) tensor(2.8449, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4919, dtype=torch.float64) delta_t tensor(0.4844, dtype=torch.float64)
18 gae_duplicate tensor(-1.1207, dtype=torch.float64) tensor(-3.6984, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7006, dtype=torch.float64) delta_t tensor(0.6424, dtype=torch.float64)
17 gae_duplicate tensor(-0.2443, dtype=torch.float64) tensor(-8.7193, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6699, dtype=torch.float64) delta_t tensor(0.4171, dtype=torch.float64)
16 gae_duplicate tensor(0.5787, dtype=torch.float64) tensor(-8.4663, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5771, dtype=torch.float64) delta_t tensor(0.4083, dtype=torch.float64)
15 gae_duplicate tensor(0.1017, dtype=torch.float64) tensor(-17.7655, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7169, dtype=torch.float64) delta_t tensor(0.6501, dtype=torch.float64)
14 gae_duplicate tensor(0.6395, dtype=torch.float64) tensor(-12.9900, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6410, dtype=torch.float64) delta_t tensor(0.2740, dtype=torch.float64)
13 gae_duplicate tensor(1.0882, dtype=torch.float64) tensor(-12.3646, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5992, dtype=torch.float64) delta_t tensor(0.6803, dtype=torch.float64)
12 gae_duplicate tensor(1.1503, dtype=torch.float64) tensor(-12.8510, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5652, dtype=torch.float64) delta_t tensor(0.1708, dtype=torch.float64)
11 gae_duplicate tensor(1.4268, dtype=torch.float64) tensor(-23.4482, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3862, dtype=torch.float64) delta_t tensor(0.0699, dtype=torch.float64)
10 gae_duplicate tensor(0.6515, dtype=torch.float64) tensor(-17.0071, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0058, dtype=torch.float64) delta_t tensor(-0.0904, dtype=torch.float64)
9 gae_duplicate tensor(-1.0104, dtype=torch.float64) tensor(-9.8744, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2697, dtype=torch.float64) delta_t tensor(-0.2811, dtype=torch.float64)
8 gae_duplicate tensor(-2.2341, dtype=torch.float64) tensor(-7.8108, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0434, dtype=torch.float64) delta_t tensor(-0.7595, dtype=torch.float64)
7 gae_duplicate tensor(-2.5962, dtype=torch.float64) tensor(1.7218, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9937, dtype=torch.float64) delta_t tensor(-0.9917, dtype=torch.float64)
6 gae_duplicate tensor(-3.7135, dtype=torch.float64) tensor(16.7201, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7863, dtype=torch.float64) delta_t tensor(-1.6435, dtype=torch.float64)
5 gae_duplicate tensor(-4.6731, dtype=torch.float64) tensor(14.4462, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3179, dtype=torch.float64) delta_t tensor(-2.1255, dtype=torch.float64)
4 gae_duplicate tensor(-7.5048, dtype=torch.float64) tensor(26.2486, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3510, dtype=torch.float64) delta_t tensor(-0.2133, dtype=torch.float64)
3 gae_duplicate tensor(-6.0867, dtype=torch.float64) tensor(22.6226, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1328, dtype=torch.float64) delta_t tensor(-0.1054, dtype=torch.float64)
2 gae_duplicate tensor(-4.8175, dtype=torch.float64) tensor(39.2857, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:369.8260498046875
value loss:922.7763061523438
entropies:166.53375244140625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2231.0610)
ToM Target loss= tensor(1802.6559)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.9499571323394775 seconds
19 rew tensor(0.6425, dtype=torch.float64) delta_t tensor(-0.3599, dtype=torch.float64)
19 gae_duplicate tensor(-0.8802, dtype=torch.float64) tensor(3.0018, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5942, dtype=torch.float64) delta_t tensor(0.5869, dtype=torch.float64)
18 gae_duplicate tensor(-0.6281, dtype=torch.float64) tensor(-2.8392, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4241, dtype=torch.float64) delta_t tensor(0.3031, dtype=torch.float64)
17 gae_duplicate tensor(-1.1678, dtype=torch.float64) tensor(-4.3491, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1491, dtype=torch.float64) delta_t tensor(0.2600, dtype=torch.float64)
16 gae_duplicate tensor(-1.6659, dtype=torch.float64) tensor(-13.7002, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7394, dtype=torch.float64) delta_t tensor(0.8116, dtype=torch.float64)
15 gae_duplicate tensor(-0.6244, dtype=torch.float64) tensor(-10.4445, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7481, dtype=torch.float64) delta_t tensor(0.8486, dtype=torch.float64)
14 gae_duplicate tensor(0.4810, dtype=torch.float64) tensor(-14.3864, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7091, dtype=torch.float64) delta_t tensor(0.5881, dtype=torch.float64)
13 gae_duplicate tensor(1.0455, dtype=torch.float64) tensor(-20.9587, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6239, dtype=torch.float64) delta_t tensor(0.3900, dtype=torch.float64)
12 gae_duplicate tensor(1.5445, dtype=torch.float64) tensor(-29.5246, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6087, dtype=torch.float64) delta_t tensor(0.1782, dtype=torch.float64)
11 gae_duplicate tensor(0.9336, dtype=torch.float64) tensor(-13.5008, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3373, dtype=torch.float64) delta_t tensor(0.1793, dtype=torch.float64)
10 gae_duplicate tensor(1.2872, dtype=torch.float64) tensor(-15.4677, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0955, dtype=torch.float64) delta_t tensor(-0.3466, dtype=torch.float64)
9 gae_duplicate tensor(0.1899, dtype=torch.float64) tensor(-8.1287, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4308, dtype=torch.float64) delta_t tensor(-0.2190, dtype=torch.float64)
8 gae_duplicate tensor(-1.6150, dtype=torch.float64) tensor(-4.5202, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8045, dtype=torch.float64) delta_t tensor(-0.8535, dtype=torch.float64)
7 gae_duplicate tensor(-2.2235, dtype=torch.float64) tensor(4.2644, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.6538, dtype=torch.float64) delta_t tensor(-1.7085, dtype=torch.float64)
6 gae_duplicate tensor(-4.4461, dtype=torch.float64) tensor(24.3533, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6395, dtype=torch.float64) delta_t tensor(-1.4003, dtype=torch.float64)
5 gae_duplicate tensor(-5.9428, dtype=torch.float64) tensor(27.6642, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0133, dtype=torch.float64) delta_t tensor(-1.8091, dtype=torch.float64)
4 gae_duplicate tensor(-7.8664, dtype=torch.float64) tensor(44.9786, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0899, dtype=torch.float64) delta_t tensor(-0.0700, dtype=torch.float64)
3 gae_duplicate tensor(-6.5195, dtype=torch.float64) tensor(27.6560, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2353, dtype=torch.float64) delta_t tensor(-0.1236, dtype=torch.float64)
2 gae_duplicate tensor(-5.0609, dtype=torch.float64) tensor(40.8364, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1287.943115234375
value loss:947.1038818359375
entropies:168.33152770996094
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.280253887176514 seconds
19 rew tensor(0.7387, dtype=torch.float64) delta_t tensor(-0.6343, dtype=torch.float64)
19 gae_duplicate tensor(-0.7293, dtype=torch.float64) tensor(6.8726, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7312, dtype=torch.float64) delta_t tensor(0.6150, dtype=torch.float64)
18 gae_duplicate tensor(-0.2142, dtype=torch.float64) tensor(0.0558, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7319, dtype=torch.float64) delta_t tensor(0.6045, dtype=torch.float64)
17 gae_duplicate tensor(0.2325, dtype=torch.float64) tensor(-6.0518, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7025, dtype=torch.float64) delta_t tensor(0.7690, dtype=torch.float64)
16 gae_duplicate tensor(0.4082, dtype=torch.float64) tensor(-15.9519, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6736, dtype=torch.float64) delta_t tensor(0.5885, dtype=torch.float64)
15 gae_duplicate tensor(0.4651, dtype=torch.float64) tensor(-15.4830, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5463, dtype=torch.float64) delta_t tensor(0.4958, dtype=torch.float64)
14 gae_duplicate tensor(0.1706, dtype=torch.float64) tensor(-12.3567, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5937, dtype=torch.float64) delta_t tensor(0.7087, dtype=torch.float64)
13 gae_duplicate tensor(0.6667, dtype=torch.float64) tensor(-23.2065, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6176, dtype=torch.float64) delta_t tensor(0.4823, dtype=torch.float64)
12 gae_duplicate tensor(1.0401, dtype=torch.float64) tensor(-20.5341, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6625, dtype=torch.float64) delta_t tensor(0.2540, dtype=torch.float64)
11 gae_duplicate tensor(1.3803, dtype=torch.float64) tensor(-21.3575, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5026, dtype=torch.float64) delta_t tensor(-0.6171, dtype=torch.float64)
10 gae_duplicate tensor(-3.9808, dtype=torch.float64) tensor(-9.9703, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0062, dtype=torch.float64) delta_t tensor(-0.0696, dtype=torch.float64)
9 gae_duplicate tensor(-3.3140, dtype=torch.float64) tensor(-4.1051, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0968, dtype=torch.float64) delta_t tensor(-0.3122, dtype=torch.float64)
8 gae_duplicate tensor(-2.1593, dtype=torch.float64) tensor(-9.3252, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1490, dtype=torch.float64) delta_t tensor(-0.0790, dtype=torch.float64)
7 gae_duplicate tensor(-1.9220, dtype=torch.float64) tensor(1.2550, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1836, dtype=torch.float64) delta_t tensor(-1.0954, dtype=torch.float64)
6 gae_duplicate tensor(-3.3853, dtype=torch.float64) tensor(6.8953, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0879, dtype=torch.float64) delta_t tensor(-0.7247, dtype=torch.float64)
5 gae_duplicate tensor(-5.4943, dtype=torch.float64) tensor(4.6164, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8660, dtype=torch.float64) delta_t tensor(-1.9563, dtype=torch.float64)
4 gae_duplicate tensor(-8.9142, dtype=torch.float64) tensor(36.8779, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2329, dtype=torch.float64) delta_t tensor(-0.0322, dtype=torch.float64)
3 gae_duplicate tensor(-7.5109, dtype=torch.float64) tensor(16.4665, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4035, dtype=torch.float64) delta_t tensor(-0.3555, dtype=torch.float64)
2 gae_duplicate tensor(-5.8446, dtype=torch.float64) tensor(23.8909, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1460.3426513671875
value loss:976.4281005859375
entropies:169.29002380371094
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.895196914672852 seconds
19 rew tensor(0.7373, dtype=torch.float64) delta_t tensor(-0.3726, dtype=torch.float64)
19 gae_duplicate tensor(-0.8648, dtype=torch.float64) tensor(2.7664, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7299, dtype=torch.float64) delta_t tensor(0.9006, dtype=torch.float64)
18 gae_duplicate tensor(-0.2302, dtype=torch.float64) tensor(-2.4051, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6916, dtype=torch.float64) delta_t tensor(0.5381, dtype=torch.float64)
17 gae_duplicate tensor(0.2355, dtype=torch.float64) tensor(-18.9136, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6610, dtype=torch.float64) delta_t tensor(0.5382, dtype=torch.float64)
16 gae_duplicate tensor(0.6082, dtype=torch.float64) tensor(-11.8456, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5922, dtype=torch.float64) delta_t tensor(0.6264, dtype=torch.float64)
15 gae_duplicate tensor(0.8320, dtype=torch.float64) tensor(-11.4844, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6225, dtype=torch.float64) delta_t tensor(0.7036, dtype=torch.float64)
14 gae_duplicate tensor(0.9391, dtype=torch.float64) tensor(-22.1515, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0038, dtype=torch.float64) delta_t tensor(-0.2630, dtype=torch.float64)
13 gae_duplicate tensor(-0.8856, dtype=torch.float64) tensor(-12.3828, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0198, dtype=torch.float64) delta_t tensor(-0.0171, dtype=torch.float64)
12 gae_duplicate tensor(-0.3063, dtype=torch.float64) tensor(-8.8577, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1957, dtype=torch.float64) delta_t tensor(-0.0498, dtype=torch.float64)
11 gae_duplicate tensor(-0.6576, dtype=torch.float64) tensor(-8.3706, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1602, dtype=torch.float64) delta_t tensor(-0.0163, dtype=torch.float64)
10 gae_duplicate tensor(-1.2696, dtype=torch.float64) tensor(-1.3068, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3245, dtype=torch.float64) delta_t tensor(0.1612, dtype=torch.float64)
9 gae_duplicate tensor(-0.5417, dtype=torch.float64) tensor(-5.2175, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2648, dtype=torch.float64) delta_t tensor(0.2066, dtype=torch.float64)
8 gae_duplicate tensor(0.0628, dtype=torch.float64) tensor(-7.3580, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5135, dtype=torch.float64) delta_t tensor(-0.4480, dtype=torch.float64)
7 gae_duplicate tensor(-1.2739, dtype=torch.float64) tensor(-4.0889, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3769, dtype=torch.float64) delta_t tensor(-0.2024, dtype=torch.float64)
6 gae_duplicate tensor(-2.9045, dtype=torch.float64) tensor(4.6792, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0854, dtype=torch.float64) delta_t tensor(-0.9031, dtype=torch.float64)
5 gae_duplicate tensor(-4.4713, dtype=torch.float64) tensor(11.8129, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7705, dtype=torch.float64) delta_t tensor(-1.5452, dtype=torch.float64)
4 gae_duplicate tensor(-9.8136, dtype=torch.float64) tensor(9.1869, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1789, dtype=torch.float64) delta_t tensor(-0.0475, dtype=torch.float64)
3 gae_duplicate tensor(-7.7955, dtype=torch.float64) tensor(29.6366, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2089, dtype=torch.float64) delta_t tensor(-0.4701, dtype=torch.float64)
2 gae_duplicate tensor(-6.6723, dtype=torch.float64) tensor(9.9621, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1637.430419921875
value loss:680.6229858398438
entropies:170.82359313964844
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.076822996139526 seconds
19 rew tensor(0.7438, dtype=torch.float64) delta_t tensor(-0.1558, dtype=torch.float64)
19 gae_duplicate tensor(-0.7765, dtype=torch.float64) tensor(1.5013, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7441, dtype=torch.float64) delta_t tensor(0.4293, dtype=torch.float64)
18 gae_duplicate tensor(-0.2148, dtype=torch.float64) tensor(-2.6488, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7443, dtype=torch.float64) delta_t tensor(0.5522, dtype=torch.float64)
17 gae_duplicate tensor(0.1497, dtype=torch.float64) tensor(-7.1737, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7198, dtype=torch.float64) delta_t tensor(0.5324, dtype=torch.float64)
16 gae_duplicate tensor(0.6228, dtype=torch.float64) tensor(-12.9537, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7288, dtype=torch.float64) delta_t tensor(0.4991, dtype=torch.float64)
15 gae_duplicate tensor(0.9651, dtype=torch.float64) tensor(-6.5796, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7208, dtype=torch.float64) delta_t tensor(0.6573, dtype=torch.float64)
14 gae_duplicate tensor(1.2080, dtype=torch.float64) tensor(-15.3936, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6830, dtype=torch.float64) delta_t tensor(0.5473, dtype=torch.float64)
13 gae_duplicate tensor(1.3216, dtype=torch.float64) tensor(-15.6106, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5542, dtype=torch.float64) delta_t tensor(0.3710, dtype=torch.float64)
12 gae_duplicate tensor(0.5837, dtype=torch.float64) tensor(-13.1835, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6715, dtype=torch.float64) delta_t tensor(0.9183, dtype=torch.float64)
11 gae_duplicate tensor(1.6833, dtype=torch.float64) tensor(-17.8974, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6063, dtype=torch.float64) delta_t tensor(0.1972, dtype=torch.float64)
10 gae_duplicate tensor(1.5503, dtype=torch.float64) tensor(-16.6258, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4468, dtype=torch.float64) delta_t tensor(0.3408, dtype=torch.float64)
9 gae_duplicate tensor(1.8495, dtype=torch.float64) tensor(-16.4520, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4786, dtype=torch.float64) delta_t tensor(-0.4475, dtype=torch.float64)
8 gae_duplicate tensor(-0.5869, dtype=torch.float64) tensor(-7.3631, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4188, dtype=torch.float64) delta_t tensor(-0.4878, dtype=torch.float64)
7 gae_duplicate tensor(-2.2913, dtype=torch.float64) tensor(-8.3564, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7977, dtype=torch.float64) delta_t tensor(-0.7791, dtype=torch.float64)
6 gae_duplicate tensor(-2.8068, dtype=torch.float64) tensor(4.5636, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3303, dtype=torch.float64) delta_t tensor(-1.3149, dtype=torch.float64)
5 gae_duplicate tensor(-4.8877, dtype=torch.float64) tensor(14.1115, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3609, dtype=torch.float64) delta_t tensor(-2.1711, dtype=torch.float64)
4 gae_duplicate tensor(-10.2316, dtype=torch.float64) tensor(16.0549, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4379, dtype=torch.float64) delta_t tensor(-0.2091, dtype=torch.float64)
3 gae_duplicate tensor(-7.3720, dtype=torch.float64) tensor(35.1645, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3294, dtype=torch.float64) delta_t tensor(-0.3978, dtype=torch.float64)
2 gae_duplicate tensor(-5.7578, dtype=torch.float64) tensor(28.0616, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1437.098388671875
value loss:940.662841796875
entropies:172.25070190429688
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.824849843978882 seconds
19 rew tensor(0.7048, dtype=torch.float64) delta_t tensor(-0.4320, dtype=torch.float64)
19 gae_duplicate tensor(-0.7742, dtype=torch.float64) tensor(5.4811, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6975, dtype=torch.float64) delta_t tensor(0.4211, dtype=torch.float64)
18 gae_duplicate tensor(-0.4145, dtype=torch.float64) tensor(-0.9067, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5481, dtype=torch.float64) delta_t tensor(0.2775, dtype=torch.float64)
17 gae_duplicate tensor(-0.0617, dtype=torch.float64) tensor(-2.7584, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3888, dtype=torch.float64) delta_t tensor(0.2032, dtype=torch.float64)
16 gae_duplicate tensor(-0.4108, dtype=torch.float64) tensor(-3.7262, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3289, dtype=torch.float64) delta_t tensor(0.1500, dtype=torch.float64)
15 gae_duplicate tensor(-0.4550, dtype=torch.float64) tensor(-4.8432, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3911, dtype=torch.float64) delta_t tensor(0.5183, dtype=torch.float64)
14 gae_duplicate tensor(0.3605, dtype=torch.float64) tensor(-9.5263, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6844, dtype=torch.float64) delta_t tensor(0.4395, dtype=torch.float64)
13 gae_duplicate tensor(0.8056, dtype=torch.float64) tensor(-14.2501, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5820, dtype=torch.float64) delta_t tensor(0.3764, dtype=torch.float64)
12 gae_duplicate tensor(0.9991, dtype=torch.float64) tensor(-7.9381, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1289, dtype=torch.float64) delta_t tensor(0.0006, dtype=torch.float64)
11 gae_duplicate tensor(-0.7431, dtype=torch.float64) tensor(-24.0782, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2976, dtype=torch.float64) delta_t tensor(0.2717, dtype=torch.float64)
10 gae_duplicate tensor(-0.3608, dtype=torch.float64) tensor(-11.1739, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3775, dtype=torch.float64) delta_t tensor(-0.4817, dtype=torch.float64)
9 gae_duplicate tensor(-2.7532, dtype=torch.float64) tensor(-6.4852, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5266, dtype=torch.float64) delta_t tensor(-0.6914, dtype=torch.float64)
8 gae_duplicate tensor(-3.5316, dtype=torch.float64) tensor(14.0699, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3547, dtype=torch.float64) delta_t tensor(-0.2876, dtype=torch.float64)
7 gae_duplicate tensor(-2.5991, dtype=torch.float64) tensor(4.7950, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3992, dtype=torch.float64) delta_t tensor(-0.3887, dtype=torch.float64)
6 gae_duplicate tensor(-3.4768, dtype=torch.float64) tensor(2.9850, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6895, dtype=torch.float64) delta_t tensor(-0.5873, dtype=torch.float64)
5 gae_duplicate tensor(-4.2136, dtype=torch.float64) tensor(8.8493, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6336, dtype=torch.float64) delta_t tensor(-1.5062, dtype=torch.float64)
4 gae_duplicate tensor(-11.2959, dtype=torch.float64) tensor(14.2251, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1273, dtype=torch.float64) delta_t tensor(0.1467, dtype=torch.float64)
3 gae_duplicate tensor(-8.5888, dtype=torch.float64) tensor(21.7497, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3157, dtype=torch.float64) delta_t tensor(-0.6253, dtype=torch.float64)
2 gae_duplicate tensor(-6.9941, dtype=torch.float64) tensor(21.5948, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-321.5098571777344
value loss:646.74951171875
entropies:173.43736267089844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2266.7656)
ToM Target loss= tensor(1801.1813)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.597434043884277 seconds
19 rew tensor(0.7354, dtype=torch.float64) delta_t tensor(-0.4921, dtype=torch.float64)
19 gae_duplicate tensor(-0.9641, dtype=torch.float64) tensor(4.2030, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7356, dtype=torch.float64) delta_t tensor(0.4379, dtype=torch.float64)
18 gae_duplicate tensor(-0.4185, dtype=torch.float64) tensor(-0.1488, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7125, dtype=torch.float64) delta_t tensor(0.5601, dtype=torch.float64)
17 gae_duplicate tensor(-0.0592, dtype=torch.float64) tensor(-6.0237, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6811, dtype=torch.float64) delta_t tensor(0.5202, dtype=torch.float64)
16 gae_duplicate tensor(0.0329, dtype=torch.float64) tensor(-8.6244, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6421, dtype=torch.float64) delta_t tensor(0.5576, dtype=torch.float64)
15 gae_duplicate tensor(0.1286, dtype=torch.float64) tensor(-16.3240, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5169, dtype=torch.float64) delta_t tensor(0.3490, dtype=torch.float64)
14 gae_duplicate tensor(-0.0341, dtype=torch.float64) tensor(-19.8751, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6912, dtype=torch.float64) delta_t tensor(0.5183, dtype=torch.float64)
13 gae_duplicate tensor(0.5297, dtype=torch.float64) tensor(-20.3099, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7371, dtype=torch.float64) delta_t tensor(0.6954, dtype=torch.float64)
12 gae_duplicate tensor(1.1041, dtype=torch.float64) tensor(-23.6335, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4325, dtype=torch.float64) delta_t tensor(0.0764, dtype=torch.float64)
11 gae_duplicate tensor(-0.3651, dtype=torch.float64) tensor(-19.0120, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7428, dtype=torch.float64) delta_t tensor(-0.5580, dtype=torch.float64)
10 gae_duplicate tensor(-2.4393, dtype=torch.float64) tensor(-12.7787, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6393, dtype=torch.float64) delta_t tensor(-0.9504, dtype=torch.float64)
9 gae_duplicate tensor(-5.2792, dtype=torch.float64) tensor(2.9274, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2178, dtype=torch.float64) delta_t tensor(-0.3688, dtype=torch.float64)
8 gae_duplicate tensor(-3.6172, dtype=torch.float64) tensor(8.5266, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3417, dtype=torch.float64) delta_t tensor(-0.6404, dtype=torch.float64)
7 gae_duplicate tensor(-3.4096, dtype=torch.float64) tensor(12.6872, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8486, dtype=torch.float64) delta_t tensor(-0.2869, dtype=torch.float64)
6 gae_duplicate tensor(-2.2734, dtype=torch.float64) tensor(5.1742, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2349, dtype=torch.float64) delta_t tensor(-0.0785, dtype=torch.float64)
5 gae_duplicate tensor(-2.9686, dtype=torch.float64) tensor(9.3113, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6897, dtype=torch.float64) delta_t tensor(-1.5217, dtype=torch.float64)
4 gae_duplicate tensor(-8.4208, dtype=torch.float64) tensor(11.3334, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0988, dtype=torch.float64) delta_t tensor(-0.0575, dtype=torch.float64)
3 gae_duplicate tensor(-6.8368, dtype=torch.float64) tensor(30.5831, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5369, dtype=torch.float64) delta_t tensor(-0.5486, dtype=torch.float64)
2 gae_duplicate tensor(-5.6852, dtype=torch.float64) tensor(27.0375, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:506.5367126464844
value loss:661.8699951171875
entropies:175.1274871826172
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.985538959503174 seconds
19 rew tensor(0.6626, dtype=torch.float64) delta_t tensor(-0.3221, dtype=torch.float64)
19 gae_duplicate tensor(-1.1661, dtype=torch.float64) tensor(5.4595, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5811, dtype=torch.float64) delta_t tensor(0.3719, dtype=torch.float64)
18 gae_duplicate tensor(-1.2476, dtype=torch.float64) tensor(-2.7666, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4270, dtype=torch.float64) delta_t tensor(0.4747, dtype=torch.float64)
17 gae_duplicate tensor(-1.0199, dtype=torch.float64) tensor(-3.9456, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6516, dtype=torch.float64) delta_t tensor(0.5075, dtype=torch.float64)
16 gae_duplicate tensor(-0.2335, dtype=torch.float64) tensor(-7.3745, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6832, dtype=torch.float64) delta_t tensor(0.4487, dtype=torch.float64)
15 gae_duplicate tensor(0.4500, dtype=torch.float64) tensor(-10.6667, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6296, dtype=torch.float64) delta_t tensor(0.5502, dtype=torch.float64)
14 gae_duplicate tensor(0.9092, dtype=torch.float64) tensor(-15.7410, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6917, dtype=torch.float64) delta_t tensor(0.7374, dtype=torch.float64)
13 gae_duplicate tensor(1.2683, dtype=torch.float64) tensor(-21.8368, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1423, dtype=torch.float64) delta_t tensor(-0.3214, dtype=torch.float64)
12 gae_duplicate tensor(-1.8885, dtype=torch.float64) tensor(-15.4520, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4946, dtype=torch.float64) delta_t tensor(0.2456, dtype=torch.float64)
11 gae_duplicate tensor(-1.2235, dtype=torch.float64) tensor(-15.7324, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7933, dtype=torch.float64) delta_t tensor(-0.7359, dtype=torch.float64)
10 gae_duplicate tensor(-2.9391, dtype=torch.float64) tensor(-6.2025, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1158, dtype=torch.float64) delta_t tensor(-0.1171, dtype=torch.float64)
9 gae_duplicate tensor(-2.0699, dtype=torch.float64) tensor(-4.9960, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0089, dtype=torch.float64) delta_t tensor(0.1200, dtype=torch.float64)
8 gae_duplicate tensor(-0.4038, dtype=torch.float64) tensor(-0.8533, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0059, dtype=torch.float64) delta_t tensor(0.0415, dtype=torch.float64)
7 gae_duplicate tensor(-0.6877, dtype=torch.float64) tensor(-0.9570, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6974, dtype=torch.float64) delta_t tensor(-0.5533, dtype=torch.float64)
6 gae_duplicate tensor(-1.4539, dtype=torch.float64) tensor(6.1385, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7448, dtype=torch.float64) delta_t tensor(-0.5873, dtype=torch.float64)
5 gae_duplicate tensor(-2.9162, dtype=torch.float64) tensor(8.8402, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1434, dtype=torch.float64) delta_t tensor(-1.1151, dtype=torch.float64)
4 gae_duplicate tensor(-6.1000, dtype=torch.float64) tensor(8.7925, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1172, dtype=torch.float64) delta_t tensor(-0.0674, dtype=torch.float64)
3 gae_duplicate tensor(-4.7354, dtype=torch.float64) tensor(8.3193, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5607, dtype=torch.float64) delta_t tensor(-0.4166, dtype=torch.float64)
2 gae_duplicate tensor(-3.6430, dtype=torch.float64) tensor(17.2228, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1831.21337890625
value loss:448.1127014160156
entropies:176.94921875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.862657070159912 seconds
19 rew tensor(0.7436, dtype=torch.float64) delta_t tensor(-0.6187, dtype=torch.float64)
19 gae_duplicate tensor(-0.9356, dtype=torch.float64) tensor(8.1962, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7362, dtype=torch.float64) delta_t tensor(0.5052, dtype=torch.float64)
18 gae_duplicate tensor(-0.3374, dtype=torch.float64) tensor(-0.2285, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7441, dtype=torch.float64) delta_t tensor(0.4410, dtype=torch.float64)
17 gae_duplicate tensor(0.1329, dtype=torch.float64) tensor(-2.9582, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7367, dtype=torch.float64) delta_t tensor(0.6981, dtype=torch.float64)
16 gae_duplicate tensor(0.5248, dtype=torch.float64) tensor(-9.7260, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7293, dtype=torch.float64) delta_t tensor(0.3740, dtype=torch.float64)
15 gae_duplicate tensor(0.6705, dtype=torch.float64) tensor(-14.7077, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7143, dtype=torch.float64) delta_t tensor(0.4501, dtype=torch.float64)
14 gae_duplicate tensor(0.7733, dtype=torch.float64) tensor(-10.3078, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6917, dtype=torch.float64) delta_t tensor(0.6113, dtype=torch.float64)
13 gae_duplicate tensor(0.7431, dtype=torch.float64) tensor(-14.1162, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7452, dtype=torch.float64) delta_t tensor(0.6178, dtype=torch.float64)
12 gae_duplicate tensor(1.0116, dtype=torch.float64) tensor(-16.6681, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2524, dtype=torch.float64) delta_t tensor(-0.0002, dtype=torch.float64)
11 gae_duplicate tensor(0.2232, dtype=torch.float64) tensor(-17.4955, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1910, dtype=torch.float64) delta_t tensor(-0.1626, dtype=torch.float64)
10 gae_duplicate tensor(-1.6210, dtype=torch.float64) tensor(-12.6528, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2175, dtype=torch.float64) delta_t tensor(0.1285, dtype=torch.float64)
9 gae_duplicate tensor(-0.2647, dtype=torch.float64) tensor(-5.5084, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3702, dtype=torch.float64) delta_t tensor(-0.2478, dtype=torch.float64)
8 gae_duplicate tensor(-1.5665, dtype=torch.float64) tensor(-4.2364, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1017, dtype=torch.float64) delta_t tensor(-1.1942, dtype=torch.float64)
7 gae_duplicate tensor(-3.1069, dtype=torch.float64) tensor(14.7949, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3425, dtype=torch.float64) delta_t tensor(-0.2398, dtype=torch.float64)
6 gae_duplicate tensor(-4.5000, dtype=torch.float64) tensor(4.4420, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8184, dtype=torch.float64) delta_t tensor(-0.5421, dtype=torch.float64)
5 gae_duplicate tensor(-4.0572, dtype=torch.float64) tensor(13.0098, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8449, dtype=torch.float64) delta_t tensor(-0.9068, dtype=torch.float64)
4 gae_duplicate tensor(-7.9928, dtype=torch.float64) tensor(20.3417, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4836, dtype=torch.float64) delta_t tensor(-0.2093, dtype=torch.float64)
3 gae_duplicate tensor(-6.0077, dtype=torch.float64) tensor(12.5384, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3282, dtype=torch.float64) delta_t tensor(-0.4123, dtype=torch.float64)
2 gae_duplicate tensor(-4.9669, dtype=torch.float64) tensor(18.2009, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:582.6467895507812
value loss:507.7817077636719
entropies:179.420654296875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.0418009757995605 seconds
19 rew tensor(0.3380, dtype=torch.float64) delta_t tensor(-0.9675, dtype=torch.float64)
19 gae_duplicate tensor(-2.0798, dtype=torch.float64) tensor(8.4681, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6188, dtype=torch.float64) delta_t tensor(0.3557, dtype=torch.float64)
18 gae_duplicate tensor(-1.0546, dtype=torch.float64) tensor(2.8915, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5339, dtype=torch.float64) delta_t tensor(0.2418, dtype=torch.float64)
17 gae_duplicate tensor(-0.4913, dtype=torch.float64) tensor(1.3288, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4705, dtype=torch.float64) delta_t tensor(0.1052, dtype=torch.float64)
16 gae_duplicate tensor(-0.5354, dtype=torch.float64) tensor(0.0144, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2333, dtype=torch.float64) delta_t tensor(0.2152, dtype=torch.float64)
15 gae_duplicate tensor(-0.3061, dtype=torch.float64) tensor(-2.0742, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4236, dtype=torch.float64) delta_t tensor(0.1040, dtype=torch.float64)
14 gae_duplicate tensor(-0.3483, dtype=torch.float64) tensor(-0.9488, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3631, dtype=torch.float64) delta_t tensor(0.0846, dtype=torch.float64)
13 gae_duplicate tensor(-1.5237, dtype=torch.float64) tensor(0.8657, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7001, dtype=torch.float64) delta_t tensor(0.3225, dtype=torch.float64)
12 gae_duplicate tensor(-0.8188, dtype=torch.float64) tensor(-5.8065, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0358, dtype=torch.float64) delta_t tensor(-0.0558, dtype=torch.float64)
11 gae_duplicate tensor(-2.8485, dtype=torch.float64) tensor(-3.1240, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4711, dtype=torch.float64) delta_t tensor(0.0815, dtype=torch.float64)
10 gae_duplicate tensor(-2.8587, dtype=torch.float64) tensor(-1.1337, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4579, dtype=torch.float64) delta_t tensor(-0.8089, dtype=torch.float64)
9 gae_duplicate tensor(-1.8810, dtype=torch.float64) tensor(4.8506, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0506, dtype=torch.float64) delta_t tensor(-1.1127, dtype=torch.float64)
8 gae_duplicate tensor(-3.8362, dtype=torch.float64) tensor(18.7960, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5341, dtype=torch.float64) delta_t tensor(-0.5773, dtype=torch.float64)
7 gae_duplicate tensor(-4.6956, dtype=torch.float64) tensor(14.0370, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9604, dtype=torch.float64) delta_t tensor(-1.1860, dtype=torch.float64)
6 gae_duplicate tensor(-6.3763, dtype=torch.float64) tensor(28.9725, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3661, dtype=torch.float64) delta_t tensor(-0.9194, dtype=torch.float64)
5 gae_duplicate tensor(-7.0328, dtype=torch.float64) tensor(32.0787, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6145, dtype=torch.float64) delta_t tensor(-1.3217, dtype=torch.float64)
4 gae_duplicate tensor(-8.5038, dtype=torch.float64) tensor(28.6146, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2909, dtype=torch.float64) delta_t tensor(-0.1912, dtype=torch.float64)
3 gae_duplicate tensor(-6.6815, dtype=torch.float64) tensor(36.9506, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4668, dtype=torch.float64) delta_t tensor(-0.3649, dtype=torch.float64)
2 gae_duplicate tensor(-5.1587, dtype=torch.float64) tensor(30.3798, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-7058.42626953125
value loss:969.6454467773438
entropies:181.26034545898438
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.063069105148315 seconds
19 rew tensor(0.5621, dtype=torch.float64) delta_t tensor(-0.5011, dtype=torch.float64)
19 gae_duplicate tensor(-1.8800, dtype=torch.float64) tensor(2.9623, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3966, dtype=torch.float64) delta_t tensor(0.3508, dtype=torch.float64)
18 gae_duplicate tensor(-2.2016, dtype=torch.float64) tensor(-1.5334, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7453, dtype=torch.float64) delta_t tensor(0.6389, dtype=torch.float64)
17 gae_duplicate tensor(-1.1299, dtype=torch.float64) tensor(-5.8075, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7061, dtype=torch.float64) delta_t tensor(0.4494, dtype=torch.float64)
16 gae_duplicate tensor(-0.2723, dtype=torch.float64) tensor(-12.6214, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6986, dtype=torch.float64) delta_t tensor(0.5871, dtype=torch.float64)
15 gae_duplicate tensor(0.4141, dtype=torch.float64) tensor(-11.0519, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5602, dtype=torch.float64) delta_t tensor(0.4539, dtype=torch.float64)
14 gae_duplicate tensor(0.9966, dtype=torch.float64) tensor(-9.4253, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1460, dtype=torch.float64) delta_t tensor(0.0011, dtype=torch.float64)
13 gae_duplicate tensor(0.1632, dtype=torch.float64) tensor(-11.8708, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.8183, dtype=torch.float64) delta_t tensor(-0.9652, dtype=torch.float64)
12 gae_duplicate tensor(-2.4397, dtype=torch.float64) tensor(-2.3048, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4137, dtype=torch.float64) delta_t tensor(-0.6529, dtype=torch.float64)
11 gae_duplicate tensor(-4.2627, dtype=torch.float64) tensor(2.3151, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3302, dtype=torch.float64) delta_t tensor(0.1126, dtype=torch.float64)
10 gae_duplicate tensor(-2.9358, dtype=torch.float64) tensor(4.1041, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1984, dtype=torch.float64) delta_t tensor(0.3848, dtype=torch.float64)
9 gae_duplicate tensor(-1.9193, dtype=torch.float64) tensor(-0.4996, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2281, dtype=torch.float64) delta_t tensor(0.0655, dtype=torch.float64)
8 gae_duplicate tensor(-1.1148, dtype=torch.float64) tensor(-0.5517, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1420, dtype=torch.float64) delta_t tensor(-0.1804, dtype=torch.float64)
7 gae_duplicate tensor(-0.7325, dtype=torch.float64) tensor(0.7485, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0584, dtype=torch.float64) delta_t tensor(0.1773, dtype=torch.float64)
6 gae_duplicate tensor(-1.4071, dtype=torch.float64) tensor(-0.4776, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3803, dtype=torch.float64) delta_t tensor(-0.1868, dtype=torch.float64)
5 gae_duplicate tensor(-0.6215, dtype=torch.float64) tensor(0.9278, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0629, dtype=torch.float64) delta_t tensor(-0.1197, dtype=torch.float64)
4 gae_duplicate tensor(-0.8796, dtype=torch.float64) tensor(0.5920, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5351, dtype=torch.float64) delta_t tensor(-0.3394, dtype=torch.float64)
3 gae_duplicate tensor(-1.2598, dtype=torch.float64) tensor(2.7797, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3475, dtype=torch.float64) delta_t tensor(-0.5358, dtype=torch.float64)
2 gae_duplicate tensor(-1.5209, dtype=torch.float64) tensor(9.7878, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1116.751953125
value loss:211.59764099121094
entropies:181.15528869628906
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2294.4939)
ToM Target loss= tensor(1802.1744)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.832431077957153 seconds
19 rew tensor(0.6269, dtype=torch.float64) delta_t tensor(-0.6836, dtype=torch.float64)
19 gae_duplicate tensor(-1.2508, dtype=torch.float64) tensor(10.3075, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5252, dtype=torch.float64) delta_t tensor(0.2446, dtype=torch.float64)
18 gae_duplicate tensor(-1.6467, dtype=torch.float64) tensor(1.9285, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2808, dtype=torch.float64) delta_t tensor(0.1234, dtype=torch.float64)
17 gae_duplicate tensor(-1.8865, dtype=torch.float64) tensor(3.1856, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4720, dtype=torch.float64) delta_t tensor(0.3595, dtype=torch.float64)
16 gae_duplicate tensor(-1.3885, dtype=torch.float64) tensor(-0.7972, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7376, dtype=torch.float64) delta_t tensor(0.6758, dtype=torch.float64)
15 gae_duplicate tensor(-0.5158, dtype=torch.float64) tensor(-5.9400, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6609, dtype=torch.float64) delta_t tensor(0.7843, dtype=torch.float64)
14 gae_duplicate tensor(0.2093, dtype=torch.float64) tensor(-15.2501, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6375, dtype=torch.float64) delta_t tensor(0.4380, dtype=torch.float64)
13 gae_duplicate tensor(0.4806, dtype=torch.float64) tensor(-19.2137, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4768, dtype=torch.float64) delta_t tensor(0.2988, dtype=torch.float64)
12 gae_duplicate tensor(1.0017, dtype=torch.float64) tensor(-13.4488, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1024, dtype=torch.float64) delta_t tensor(-0.1162, dtype=torch.float64)
11 gae_duplicate tensor(-0.6898, dtype=torch.float64) tensor(-6.6580, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3478, dtype=torch.float64) delta_t tensor(-0.0435, dtype=torch.float64)
10 gae_duplicate tensor(-0.8890, dtype=torch.float64) tensor(-13.7508, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0291, dtype=torch.float64) delta_t tensor(-0.1135, dtype=torch.float64)
9 gae_duplicate tensor(-1.1124, dtype=torch.float64) tensor(-9.8314, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4791, dtype=torch.float64) delta_t tensor(-0.5900, dtype=torch.float64)
8 gae_duplicate tensor(-1.7222, dtype=torch.float64) tensor(-3.6724, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7535, dtype=torch.float64) delta_t tensor(-0.6875, dtype=torch.float64)
7 gae_duplicate tensor(-4.2658, dtype=torch.float64) tensor(11.4521, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8319, dtype=torch.float64) delta_t tensor(-0.7515, dtype=torch.float64)
6 gae_duplicate tensor(-4.9806, dtype=torch.float64) tensor(19.4677, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1178, dtype=torch.float64) delta_t tensor(-1.0210, dtype=torch.float64)
5 gae_duplicate tensor(-5.7994, dtype=torch.float64) tensor(23.4739, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4224, dtype=torch.float64) delta_t tensor(-1.3748, dtype=torch.float64)
4 gae_duplicate tensor(-7.7901, dtype=torch.float64) tensor(37.7787, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2556, dtype=torch.float64) delta_t tensor(-0.0499, dtype=torch.float64)
3 gae_duplicate tensor(-6.5558, dtype=torch.float64) tensor(27.8779, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2287, dtype=torch.float64) delta_t tensor(-0.2680, dtype=torch.float64)
2 gae_duplicate tensor(-5.5458, dtype=torch.float64) tensor(18.6862, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2394.338134765625
value loss:749.7216796875
entropies:182.75062561035156
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.065893173217773 seconds
19 rew tensor(0.6704, dtype=torch.float64) delta_t tensor(-0.6667, dtype=torch.float64)
19 gae_duplicate tensor(-1.2979, dtype=torch.float64) tensor(8.5868, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6263, dtype=torch.float64) delta_t tensor(0.3266, dtype=torch.float64)
18 gae_duplicate tensor(-0.7290, dtype=torch.float64) tensor(1.9597, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5372, dtype=torch.float64) delta_t tensor(0.2977, dtype=torch.float64)
17 gae_duplicate tensor(-0.8760, dtype=torch.float64) tensor(-1.1986, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6469, dtype=torch.float64) delta_t tensor(0.2557, dtype=torch.float64)
16 gae_duplicate tensor(-0.2129, dtype=torch.float64) tensor(-2.2315, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5555, dtype=torch.float64) delta_t tensor(0.6077, dtype=torch.float64)
15 gae_duplicate tensor(0.2249, dtype=torch.float64) tensor(-6.2406, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6169, dtype=torch.float64) delta_t tensor(0.4133, dtype=torch.float64)
14 gae_duplicate tensor(0.0349, dtype=torch.float64) tensor(-12.8678, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5796, dtype=torch.float64) delta_t tensor(0.5265, dtype=torch.float64)
13 gae_duplicate tensor(0.2292, dtype=torch.float64) tensor(-17.0477, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6240, dtype=torch.float64) delta_t tensor(0.1958, dtype=torch.float64)
12 gae_duplicate tensor(0.4843, dtype=torch.float64) tensor(-14.3880, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5840, dtype=torch.float64) delta_t tensor(0.3267, dtype=torch.float64)
11 gae_duplicate tensor(0.7148, dtype=torch.float64) tensor(-15.7953, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4851, dtype=torch.float64) delta_t tensor(0.2030, dtype=torch.float64)
10 gae_duplicate tensor(0.4637, dtype=torch.float64) tensor(-15.1142, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1123, dtype=torch.float64) delta_t tensor(0.0750, dtype=torch.float64)
9 gae_duplicate tensor(0.0672, dtype=torch.float64) tensor(-15.9332, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3970, dtype=torch.float64) delta_t tensor(-0.5751, dtype=torch.float64)
8 gae_duplicate tensor(-2.1387, dtype=torch.float64) tensor(-4.5864, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3948, dtype=torch.float64) delta_t tensor(-0.5273, dtype=torch.float64)
7 gae_duplicate tensor(-2.1331, dtype=torch.float64) tensor(3.8640, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9075, dtype=torch.float64) delta_t tensor(-0.8644, dtype=torch.float64)
6 gae_duplicate tensor(-3.1697, dtype=torch.float64) tensor(4.2461, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2161, dtype=torch.float64) delta_t tensor(-1.0767, dtype=torch.float64)
5 gae_duplicate tensor(-4.2890, dtype=torch.float64) tensor(14.8461, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5314, dtype=torch.float64) delta_t tensor(-1.2040, dtype=torch.float64)
4 gae_duplicate tensor(-7.7933, dtype=torch.float64) tensor(33.0303, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3274, dtype=torch.float64) delta_t tensor(-0.1713, dtype=torch.float64)
3 gae_duplicate tensor(-6.0843, dtype=torch.float64) tensor(28.2887, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3127, dtype=torch.float64) delta_t tensor(-0.3360, dtype=torch.float64)
2 gae_duplicate tensor(-5.3201, dtype=torch.float64) tensor(20.4545, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-388.4394836425781
value loss:631.6564331054688
entropies:183.42828369140625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.073361873626709 seconds
19 rew tensor(0.4327, dtype=torch.float64) delta_t tensor(-0.7735, dtype=torch.float64)
19 gae_duplicate tensor(-1.7468, dtype=torch.float64) tensor(8.0671, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5980, dtype=torch.float64) delta_t tensor(0.2762, dtype=torch.float64)
18 gae_duplicate tensor(-1.0989, dtype=torch.float64) tensor(4.8967, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4572, dtype=torch.float64) delta_t tensor(0.4316, dtype=torch.float64)
17 gae_duplicate tensor(-1.6971, dtype=torch.float64) tensor(-2.1974, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6707, dtype=torch.float64) delta_t tensor(0.2935, dtype=torch.float64)
16 gae_duplicate tensor(-0.8646, dtype=torch.float64) tensor(-7.7603, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5640, dtype=torch.float64) delta_t tensor(0.3139, dtype=torch.float64)
15 gae_duplicate tensor(-0.3677, dtype=torch.float64) tensor(-6.1397, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6864, dtype=torch.float64) delta_t tensor(0.2958, dtype=torch.float64)
14 gae_duplicate tensor(0.1341, dtype=torch.float64) tensor(-9.5744, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6406, dtype=torch.float64) delta_t tensor(0.4672, dtype=torch.float64)
13 gae_duplicate tensor(0.4402, dtype=torch.float64) tensor(-9.9186, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7085, dtype=torch.float64) delta_t tensor(0.4038, dtype=torch.float64)
12 gae_duplicate tensor(0.6696, dtype=torch.float64) tensor(-11.8179, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6668, dtype=torch.float64) delta_t tensor(0.5595, dtype=torch.float64)
11 gae_duplicate tensor(0.9103, dtype=torch.float64) tensor(-12.5558, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6052, dtype=torch.float64) delta_t tensor(0.0527, dtype=torch.float64)
10 gae_duplicate tensor(0.7948, dtype=torch.float64) tensor(-13.8469, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0656, dtype=torch.float64) delta_t tensor(-1.1130, dtype=torch.float64)
9 gae_duplicate tensor(-1.8293, dtype=torch.float64) tensor(3.5004, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9085, dtype=torch.float64) delta_t tensor(-1.3012, dtype=torch.float64)
8 gae_duplicate tensor(-3.1152, dtype=torch.float64) tensor(8.5222, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0106, dtype=torch.float64) delta_t tensor(-1.0414, dtype=torch.float64)
7 gae_duplicate tensor(-4.2390, dtype=torch.float64) tensor(20.1952, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2039, dtype=torch.float64) delta_t tensor(-1.1429, dtype=torch.float64)
6 gae_duplicate tensor(-4.8526, dtype=torch.float64) tensor(24.2424, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3869, dtype=torch.float64) delta_t tensor(-1.1133, dtype=torch.float64)
5 gae_duplicate tensor(-5.7977, dtype=torch.float64) tensor(36.5157, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0295, dtype=torch.float64) delta_t tensor(-1.8073, dtype=torch.float64)
4 gae_duplicate tensor(-7.3295, dtype=torch.float64) tensor(47.2216, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3578, dtype=torch.float64) delta_t tensor(-0.0573, dtype=torch.float64)
3 gae_duplicate tensor(-5.3569, dtype=torch.float64) tensor(33.7095, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2871, dtype=torch.float64) delta_t tensor(-0.2637, dtype=torch.float64)
2 gae_duplicate tensor(-4.4697, dtype=torch.float64) tensor(30.7774, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5211.3486328125
value loss:1017.1362915039062
entropies:184.5186767578125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.861849069595337 seconds
19 rew tensor(0.7468, dtype=torch.float64) delta_t tensor(-0.4530, dtype=torch.float64)
19 gae_duplicate tensor(-1.0189, dtype=torch.float64) tensor(4.0533, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7471, dtype=torch.float64) delta_t tensor(0.3960, dtype=torch.float64)
18 gae_duplicate tensor(-0.3798, dtype=torch.float64) tensor(0.5030, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7399, dtype=torch.float64) delta_t tensor(0.6586, dtype=torch.float64)
17 gae_duplicate tensor(-0.0036, dtype=torch.float64) tensor(-11.2199, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7475, dtype=torch.float64) delta_t tensor(0.5466, dtype=torch.float64)
16 gae_duplicate tensor(0.3821, dtype=torch.float64) tensor(-7.4816, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7404, dtype=torch.float64) delta_t tensor(0.6563, dtype=torch.float64)
15 gae_duplicate tensor(0.6505, dtype=torch.float64) tensor(-16.9425, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7406, dtype=torch.float64) delta_t tensor(0.6519, dtype=torch.float64)
14 gae_duplicate tensor(0.8663, dtype=torch.float64) tensor(-18.9644, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6856, dtype=torch.float64) delta_t tensor(0.7866, dtype=torch.float64)
13 gae_duplicate tensor(0.9999, dtype=torch.float64) tensor(-19.9882, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4800, dtype=torch.float64) delta_t tensor(0.1037, dtype=torch.float64)
12 gae_duplicate tensor(1.0265, dtype=torch.float64) tensor(-25.4819, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5324, dtype=torch.float64) delta_t tensor(0.2530, dtype=torch.float64)
11 gae_duplicate tensor(1.2222, dtype=torch.float64) tensor(-21.8434, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4448, dtype=torch.float64) delta_t tensor(0.2081, dtype=torch.float64)
10 gae_duplicate tensor(0.5200, dtype=torch.float64) tensor(-14.6961, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0706, dtype=torch.float64) delta_t tensor(-0.4625, dtype=torch.float64)
9 gae_duplicate tensor(-1.1958, dtype=torch.float64) tensor(-11.3622, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3125, dtype=torch.float64) delta_t tensor(-0.2145, dtype=torch.float64)
8 gae_duplicate tensor(-1.0350, dtype=torch.float64) tensor(-3.4798, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1989, dtype=torch.float64) delta_t tensor(-1.2474, dtype=torch.float64)
7 gae_duplicate tensor(-4.3342, dtype=torch.float64) tensor(17.2989, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2287, dtype=torch.float64) delta_t tensor(-0.9991, dtype=torch.float64)
6 gae_duplicate tensor(-3.8891, dtype=torch.float64) tensor(26.2765, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9308, dtype=torch.float64) delta_t tensor(-0.8717, dtype=torch.float64)
5 gae_duplicate tensor(-4.8580, dtype=torch.float64) tensor(17.1176, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2531, dtype=torch.float64) delta_t tensor(-2.1440, dtype=torch.float64)
4 gae_duplicate tensor(-6.8753, dtype=torch.float64) tensor(39.2396, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3571, dtype=torch.float64) delta_t tensor(-0.1273, dtype=torch.float64)
3 gae_duplicate tensor(-5.1533, dtype=torch.float64) tensor(40.2462, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1806, dtype=torch.float64) delta_t tensor(-0.1798, dtype=torch.float64)
2 gae_duplicate tensor(-4.2024, dtype=torch.float64) tensor(32.7589, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-970.7393798828125
value loss:931.4827880859375
entropies:186.18177795410156
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.91844916343689 seconds
19 rew tensor(0.4537, dtype=torch.float64) delta_t tensor(-0.5944, dtype=torch.float64)
19 gae_duplicate tensor(-2.0315, dtype=torch.float64) tensor(5.8085, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6779, dtype=torch.float64) delta_t tensor(0.3483, dtype=torch.float64)
18 gae_duplicate tensor(-1.1454, dtype=torch.float64) tensor(0.7898, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6005, dtype=torch.float64) delta_t tensor(0.4142, dtype=torch.float64)
17 gae_duplicate tensor(-0.7054, dtype=torch.float64) tensor(-2.7872, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7089, dtype=torch.float64) delta_t tensor(0.2734, dtype=torch.float64)
16 gae_duplicate tensor(-0.0720, dtype=torch.float64) tensor(-5.0269, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6931, dtype=torch.float64) delta_t tensor(0.5022, dtype=torch.float64)
15 gae_duplicate tensor(0.4329, dtype=torch.float64) tensor(-9.4309, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6549, dtype=torch.float64) delta_t tensor(0.4591, dtype=torch.float64)
14 gae_duplicate tensor(0.3289, dtype=torch.float64) tensor(-11.1278, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.2264, dtype=torch.float64) delta_t tensor(-0.4253, dtype=torch.float64)
13 gae_duplicate tensor(-4.5000, dtype=torch.float64) tensor(-3.6231, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4946, dtype=torch.float64) delta_t tensor(0.3307, dtype=torch.float64)
12 gae_duplicate tensor(-3.3496, dtype=torch.float64) tensor(-10.1284, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6856, dtype=torch.float64) delta_t tensor(0.6739, dtype=torch.float64)
11 gae_duplicate tensor(-2.2478, dtype=torch.float64) tensor(-20.9142, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3032, dtype=torch.float64) delta_t tensor(0.3074, dtype=torch.float64)
10 gae_duplicate tensor(-1.7185, dtype=torch.float64) tensor(-16.7687, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6150, dtype=torch.float64) delta_t tensor(-0.6955, dtype=torch.float64)
9 gae_duplicate tensor(-1.1905, dtype=torch.float64) tensor(-3.1592, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0598, dtype=torch.float64) delta_t tensor(-0.0033, dtype=torch.float64)
8 gae_duplicate tensor(-1.4113, dtype=torch.float64) tensor(-4.8900, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2820, dtype=torch.float64) delta_t tensor(-0.4584, dtype=torch.float64)
7 gae_duplicate tensor(-2.5086, dtype=torch.float64) tensor(1.3662, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6019, dtype=torch.float64) delta_t tensor(-0.5055, dtype=torch.float64)
6 gae_duplicate tensor(-2.6252, dtype=torch.float64) tensor(9.1751, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9906, dtype=torch.float64) delta_t tensor(-1.0394, dtype=torch.float64)
5 gae_duplicate tensor(-3.8135, dtype=torch.float64) tensor(16.8705, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4119, dtype=torch.float64) delta_t tensor(-1.2005, dtype=torch.float64)
4 gae_duplicate tensor(-6.4614, dtype=torch.float64) tensor(20.5960, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2716, dtype=torch.float64) delta_t tensor(-0.0141, dtype=torch.float64)
3 gae_duplicate tensor(-4.8827, dtype=torch.float64) tensor(14.4928, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3502, dtype=torch.float64) delta_t tensor(-0.2961, dtype=torch.float64)
2 gae_duplicate tensor(-4.0327, dtype=torch.float64) tensor(25.2442, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-267.183349609375
value loss:545.6484375
entropies:187.0199432373047
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2307.9563)
ToM Target loss= tensor(1799.1111)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.954494953155518 seconds
19 rew tensor(0.6458, dtype=torch.float64) delta_t tensor(-0.7974, dtype=torch.float64)
19 gae_duplicate tensor(-1.2985, dtype=torch.float64) tensor(8.0089, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5462, dtype=torch.float64) delta_t tensor(0.1843, dtype=torch.float64)
18 gae_duplicate tensor(-1.5011, dtype=torch.float64) tensor(4.9327, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3761, dtype=torch.float64) delta_t tensor(0.3205, dtype=torch.float64)
17 gae_duplicate tensor(-1.1697, dtype=torch.float64) tensor(1.4042, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4881, dtype=torch.float64) delta_t tensor(0.1701, dtype=torch.float64)
16 gae_duplicate tensor(-1.2353, dtype=torch.float64) tensor(1.2700, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7471, dtype=torch.float64) delta_t tensor(0.5550, dtype=torch.float64)
15 gae_duplicate tensor(-0.4273, dtype=torch.float64) tensor(-8.5334, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7399, dtype=torch.float64) delta_t tensor(0.6771, dtype=torch.float64)
14 gae_duplicate tensor(0.1662, dtype=torch.float64) tensor(-16.6541, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7322, dtype=torch.float64) delta_t tensor(0.4912, dtype=torch.float64)
13 gae_duplicate tensor(0.6578, dtype=torch.float64) tensor(-15.5608, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6716, dtype=torch.float64) delta_t tensor(0.3155, dtype=torch.float64)
12 gae_duplicate tensor(0.3048, dtype=torch.float64) tensor(-11.7300, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6542, dtype=torch.float64) delta_t tensor(-0.8820, dtype=torch.float64)
11 gae_duplicate tensor(-5.6642, dtype=torch.float64) tensor(2.0558, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0331, dtype=torch.float64) delta_t tensor(0.0759, dtype=torch.float64)
10 gae_duplicate tensor(-5.2773, dtype=torch.float64) tensor(2.7353, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0770, dtype=torch.float64) delta_t tensor(-0.3482, dtype=torch.float64)
9 gae_duplicate tensor(-4.9083, dtype=torch.float64) tensor(0.2093, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0298, dtype=torch.float64) delta_t tensor(0.0617, dtype=torch.float64)
8 gae_duplicate tensor(-3.7798, dtype=torch.float64) tensor(-1.9695, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5938, dtype=torch.float64) delta_t tensor(-0.4459, dtype=torch.float64)
7 gae_duplicate tensor(-3.3332, dtype=torch.float64) tensor(10.3391, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2761, dtype=torch.float64) delta_t tensor(-0.1875, dtype=torch.float64)
6 gae_duplicate tensor(-2.4592, dtype=torch.float64) tensor(5.7826, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5206, dtype=torch.float64) delta_t tensor(-1.3104, dtype=torch.float64)
5 gae_duplicate tensor(-4.6643, dtype=torch.float64) tensor(17.0597, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9515, dtype=torch.float64) delta_t tensor(-1.8316, dtype=torch.float64)
4 gae_duplicate tensor(-7.6406, dtype=torch.float64) tensor(33.0760, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6172, dtype=torch.float64) delta_t tensor(-0.4421, dtype=torch.float64)
3 gae_duplicate tensor(-6.1391, dtype=torch.float64) tensor(33.6783, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2808, dtype=torch.float64) delta_t tensor(-0.4793, dtype=torch.float64)
2 gae_duplicate tensor(-5.1765, dtype=torch.float64) tensor(41.4938, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3907.467529296875
value loss:806.1531372070312
entropies:188.59619140625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.933091878890991 seconds
19 rew tensor(0.2326, dtype=torch.float64) delta_t tensor(-1.0273, dtype=torch.float64)
19 gae_duplicate tensor(-1.8462, dtype=torch.float64) tensor(9.9421, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7166, dtype=torch.float64) delta_t tensor(0.4568, dtype=torch.float64)
18 gae_duplicate tensor(-1.0066, dtype=torch.float64) tensor(3.3271, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6788, dtype=torch.float64) delta_t tensor(0.4367, dtype=torch.float64)
17 gae_duplicate tensor(-0.4394, dtype=torch.float64) tensor(-4.6460, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6182, dtype=torch.float64) delta_t tensor(0.2668, dtype=torch.float64)
16 gae_duplicate tensor(-0.5206, dtype=torch.float64) tensor(-2.8167, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4813, dtype=torch.float64) delta_t tensor(0.3435, dtype=torch.float64)
15 gae_duplicate tensor(-0.5427, dtype=torch.float64) tensor(-6.6168, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6803, dtype=torch.float64) delta_t tensor(0.1637, dtype=torch.float64)
14 gae_duplicate tensor(0.1395, dtype=torch.float64) tensor(-4.6758, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6874, dtype=torch.float64) delta_t tensor(0.3544, dtype=torch.float64)
13 gae_duplicate tensor(0.5174, dtype=torch.float64) tensor(-6.7004, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7090, dtype=torch.float64) delta_t tensor(0.3862, dtype=torch.float64)
12 gae_duplicate tensor(0.6789, dtype=torch.float64) tensor(-8.9526, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7180, dtype=torch.float64) delta_t tensor(0.4069, dtype=torch.float64)
11 gae_duplicate tensor(0.9502, dtype=torch.float64) tensor(-18.2086, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6496, dtype=torch.float64) delta_t tensor(0.6152, dtype=torch.float64)
10 gae_duplicate tensor(0.8549, dtype=torch.float64) tensor(-18.1254, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2162, dtype=torch.float64) delta_t tensor(-1.6362, dtype=torch.float64)
9 gae_duplicate tensor(-1.7239, dtype=torch.float64) tensor(2.4394, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5968, dtype=torch.float64) delta_t tensor(-0.7740, dtype=torch.float64)
8 gae_duplicate tensor(-2.3989, dtype=torch.float64) tensor(9.9840, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3180, dtype=torch.float64) delta_t tensor(-0.4578, dtype=torch.float64)
7 gae_duplicate tensor(-3.0510, dtype=torch.float64) tensor(7.1367, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1797, dtype=torch.float64) delta_t tensor(-1.1594, dtype=torch.float64)
6 gae_duplicate tensor(-4.4304, dtype=torch.float64) tensor(19.5330, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8978, dtype=torch.float64) delta_t tensor(-1.4972, dtype=torch.float64)
5 gae_duplicate tensor(-5.6076, dtype=torch.float64) tensor(31.8772, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7575, dtype=torch.float64) delta_t tensor(-1.2837, dtype=torch.float64)
4 gae_duplicate tensor(-6.6693, dtype=torch.float64) tensor(33.7963, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2047, dtype=torch.float64) delta_t tensor(-0.0464, dtype=torch.float64)
3 gae_duplicate tensor(-4.9379, dtype=torch.float64) tensor(36.7445, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1253, dtype=torch.float64) delta_t tensor(-0.0852, dtype=torch.float64)
2 gae_duplicate tensor(-3.9485, dtype=torch.float64) tensor(23.3077, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3898.46533203125
value loss:733.3050537109375
entropies:189.0040740966797
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.053945064544678 seconds
19 rew tensor(0.7161, dtype=torch.float64) delta_t tensor(-0.4726, dtype=torch.float64)
19 gae_duplicate tensor(-0.9720, dtype=torch.float64) tensor(5.5239, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6931, dtype=torch.float64) delta_t tensor(0.4958, dtype=torch.float64)
18 gae_duplicate tensor(-0.6584, dtype=torch.float64) tensor(0.2965, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6313, dtype=torch.float64) delta_t tensor(0.6999, dtype=torch.float64)
17 gae_duplicate tensor(-0.8379, dtype=torch.float64) tensor(-9.7169, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5231, dtype=torch.float64) delta_t tensor(0.6449, dtype=torch.float64)
16 gae_duplicate tensor(-0.4725, dtype=torch.float64) tensor(-11.3555, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7401, dtype=torch.float64) delta_t tensor(0.6154, dtype=torch.float64)
15 gae_duplicate tensor(0.2276, dtype=torch.float64) tensor(-20.4007, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7164, dtype=torch.float64) delta_t tensor(0.5809, dtype=torch.float64)
14 gae_duplicate tensor(0.8059, dtype=torch.float64) tensor(-22.2279, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5987, dtype=torch.float64) delta_t tensor(0.6278, dtype=torch.float64)
13 gae_duplicate tensor(1.2207, dtype=torch.float64) tensor(-27.4790, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5596, dtype=torch.float64) delta_t tensor(-0.0154, dtype=torch.float64)
12 gae_duplicate tensor(0.4565, dtype=torch.float64) tensor(-14.4150, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4854, dtype=torch.float64) delta_t tensor(0.3252, dtype=torch.float64)
11 gae_duplicate tensor(0.3427, dtype=torch.float64) tensor(-17.6218, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5510, dtype=torch.float64) delta_t tensor(0.6692, dtype=torch.float64)
10 gae_duplicate tensor(1.1337, dtype=torch.float64) tensor(-20.8716, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2064, dtype=torch.float64) delta_t tensor(-0.2984, dtype=torch.float64)
9 gae_duplicate tensor(0.4389, dtype=torch.float64) tensor(-13.9222, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2215, dtype=torch.float64) delta_t tensor(-0.3324, dtype=torch.float64)
8 gae_duplicate tensor(-0.8786, dtype=torch.float64) tensor(-7.4772, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0960, dtype=torch.float64) delta_t tensor(0.0508, dtype=torch.float64)
7 gae_duplicate tensor(-0.9431, dtype=torch.float64) tensor(-7.6955, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8414, dtype=torch.float64) delta_t tensor(-1.0574, dtype=torch.float64)
6 gae_duplicate tensor(-2.2684, dtype=torch.float64) tensor(7.7463, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3321, dtype=torch.float64) delta_t tensor(-0.8023, dtype=torch.float64)
5 gae_duplicate tensor(-3.9354, dtype=torch.float64) tensor(11.9154, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4095, dtype=torch.float64) delta_t tensor(-1.3602, dtype=torch.float64)
4 gae_duplicate tensor(-8.0596, dtype=torch.float64) tensor(30.5765, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5358, dtype=torch.float64) delta_t tensor(-0.3495, dtype=torch.float64)
3 gae_duplicate tensor(-6.4763, dtype=torch.float64) tensor(28.6162, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3545, dtype=torch.float64) delta_t tensor(-0.2783, dtype=torch.float64)
2 gae_duplicate tensor(-5.0523, dtype=torch.float64) tensor(27.5595, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2159.991455078125
value loss:677.4865112304688
entropies:189.8151092529297
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.924547910690308 seconds
19 rew tensor(0.7227, dtype=torch.float64) delta_t tensor(-0.6721, dtype=torch.float64)
19 gae_duplicate tensor(-0.9818, dtype=torch.float64) tensor(7.7690, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7149, dtype=torch.float64) delta_t tensor(0.4069, dtype=torch.float64)
18 gae_duplicate tensor(-0.4883, dtype=torch.float64) tensor(1.4004, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6991, dtype=torch.float64) delta_t tensor(0.3439, dtype=torch.float64)
17 gae_duplicate tensor(-0.1619, dtype=torch.float64) tensor(-2.1225, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6441, dtype=torch.float64) delta_t tensor(0.4773, dtype=torch.float64)
16 gae_duplicate tensor(-0.1755, dtype=torch.float64) tensor(-5.0962, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5496, dtype=torch.float64) delta_t tensor(0.3823, dtype=torch.float64)
15 gae_duplicate tensor(0.0710, dtype=torch.float64) tensor(-9.0208, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7086, dtype=torch.float64) delta_t tensor(0.4127, dtype=torch.float64)
14 gae_duplicate tensor(0.6772, dtype=torch.float64) tensor(-9.4716, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6857, dtype=torch.float64) delta_t tensor(0.4582, dtype=torch.float64)
13 gae_duplicate tensor(0.7021, dtype=torch.float64) tensor(-12.9743, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7320, dtype=torch.float64) delta_t tensor(0.4344, dtype=torch.float64)
12 gae_duplicate tensor(1.0785, dtype=torch.float64) tensor(-16.5753, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4156, dtype=torch.float64) delta_t tensor(0.0970, dtype=torch.float64)
11 gae_duplicate tensor(-0.2749, dtype=torch.float64) tensor(-8.8753, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2598, dtype=torch.float64) delta_t tensor(-0.4762, dtype=torch.float64)
10 gae_duplicate tensor(-5.3372, dtype=torch.float64) tensor(-0.3526, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1364, dtype=torch.float64) delta_t tensor(-0.3576, dtype=torch.float64)
9 gae_duplicate tensor(-4.2343, dtype=torch.float64) tensor(-1.6209, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7771, dtype=torch.float64) delta_t tensor(-0.7977, dtype=torch.float64)
8 gae_duplicate tensor(-2.7772, dtype=torch.float64) tensor(8.1762, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0378, dtype=torch.float64) delta_t tensor(-1.1997, dtype=torch.float64)
7 gae_duplicate tensor(-4.9016, dtype=torch.float64) tensor(23.3182, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1634, dtype=torch.float64) delta_t tensor(-0.7508, dtype=torch.float64)
6 gae_duplicate tensor(-4.5471, dtype=torch.float64) tensor(15.5638, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2409, dtype=torch.float64) delta_t tensor(-1.0451, dtype=torch.float64)
5 gae_duplicate tensor(-5.0437, dtype=torch.float64) tensor(31.5283, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3819, dtype=torch.float64) delta_t tensor(-1.9725, dtype=torch.float64)
4 gae_duplicate tensor(-9.5972, dtype=torch.float64) tensor(34.0987, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1155, dtype=torch.float64) delta_t tensor(0.0851, dtype=torch.float64)
3 gae_duplicate tensor(-7.5705, dtype=torch.float64) tensor(32.1913, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2294, dtype=torch.float64) delta_t tensor(-0.4080, dtype=torch.float64)
2 gae_duplicate tensor(-6.1490, dtype=torch.float64) tensor(32.1590, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4357.74951171875
value loss:948.3468627929688
entropies:190.63804626464844
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.85925817489624 seconds
19 rew tensor(0.6779, dtype=torch.float64) delta_t tensor(-0.5738, dtype=torch.float64)
19 gae_duplicate tensor(-1.1911, dtype=torch.float64) tensor(4.5948, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6027, dtype=torch.float64) delta_t tensor(0.5027, dtype=torch.float64)
18 gae_duplicate tensor(-1.4009, dtype=torch.float64) tensor(-0.2461, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4900, dtype=torch.float64) delta_t tensor(0.4896, dtype=torch.float64)
17 gae_duplicate tensor(-0.8980, dtype=torch.float64) tensor(-7.1913, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6925, dtype=torch.float64) delta_t tensor(0.7821, dtype=torch.float64)
16 gae_duplicate tensor(-0.0720, dtype=torch.float64) tensor(-12.6523, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5694, dtype=torch.float64) delta_t tensor(0.5188, dtype=torch.float64)
15 gae_duplicate tensor(0.5891, dtype=torch.float64) tensor(-16.2612, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4620, dtype=torch.float64) delta_t tensor(0.2724, dtype=torch.float64)
14 gae_duplicate tensor(0.5155, dtype=torch.float64) tensor(-17.5510, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6228, dtype=torch.float64) delta_t tensor(0.4943, dtype=torch.float64)
13 gae_duplicate tensor(1.1190, dtype=torch.float64) tensor(-17.5270, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6149, dtype=torch.float64) delta_t tensor(0.4888, dtype=torch.float64)
12 gae_duplicate tensor(1.0284, dtype=torch.float64) tensor(-12.4041, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5607, dtype=torch.float64) delta_t tensor(0.2410, dtype=torch.float64)
11 gae_duplicate tensor(0.1430, dtype=torch.float64) tensor(-17.1077, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1659, dtype=torch.float64) delta_t tensor(0.2323, dtype=torch.float64)
10 gae_duplicate tensor(-0.5820, dtype=torch.float64) tensor(-13.2271, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2249, dtype=torch.float64) delta_t tensor(-0.4276, dtype=torch.float64)
9 gae_duplicate tensor(0.0788, dtype=torch.float64) tensor(-9.8090, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5529, dtype=torch.float64) delta_t tensor(-0.5689, dtype=torch.float64)
8 gae_duplicate tensor(-0.9864, dtype=torch.float64) tensor(0.2503, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5291, dtype=torch.float64) delta_t tensor(-0.6398, dtype=torch.float64)
7 gae_duplicate tensor(-2.5134, dtype=torch.float64) tensor(5.5556, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1554, dtype=torch.float64) delta_t tensor(-1.1094, dtype=torch.float64)
6 gae_duplicate tensor(-3.7204, dtype=torch.float64) tensor(14.2275, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3072, dtype=torch.float64) delta_t tensor(-0.8858, dtype=torch.float64)
5 gae_duplicate tensor(-5.1114, dtype=torch.float64) tensor(14.6301, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4699, dtype=torch.float64) delta_t tensor(-2.3260, dtype=torch.float64)
4 gae_duplicate tensor(-11.5270, dtype=torch.float64) tensor(49.1444, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2014, dtype=torch.float64) delta_t tensor(-0.1085, dtype=torch.float64)
3 gae_duplicate tensor(-8.9492, dtype=torch.float64) tensor(52.9189, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2366, dtype=torch.float64) delta_t tensor(-0.3817, dtype=torch.float64)
2 gae_duplicate tensor(-6.7147, dtype=torch.float64) tensor(30.9032, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1771.1214599609375
value loss:1061.208984375
entropies:189.97503662109375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2302.4333)
ToM Target loss= tensor(1800.0674)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.120453834533691 seconds
19 rew tensor(0.6923, dtype=torch.float64) delta_t tensor(-0.7510, dtype=torch.float64)
19 gae_duplicate tensor(-1.1342, dtype=torch.float64) tensor(9.1087, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6305, dtype=torch.float64) delta_t tensor(0.2046, dtype=torch.float64)
18 gae_duplicate tensor(-0.7945, dtype=torch.float64) tensor(6.6283, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5670, dtype=torch.float64) delta_t tensor(0.2771, dtype=torch.float64)
17 gae_duplicate tensor(-0.8972, dtype=torch.float64) tensor(0.5131, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3954, dtype=torch.float64) delta_t tensor(0.4270, dtype=torch.float64)
16 gae_duplicate tensor(-0.7786, dtype=torch.float64) tensor(-7.2063, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6177, dtype=torch.float64) delta_t tensor(0.7064, dtype=torch.float64)
15 gae_duplicate tensor(-0.0449, dtype=torch.float64) tensor(-11.6842, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5187, dtype=torch.float64) delta_t tensor(0.5714, dtype=torch.float64)
14 gae_duplicate tensor(0.4859, dtype=torch.float64) tensor(-12.6501, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7393, dtype=torch.float64) delta_t tensor(0.5706, dtype=torch.float64)
13 gae_duplicate tensor(0.9302, dtype=torch.float64) tensor(-17.4205, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7011, dtype=torch.float64) delta_t tensor(0.5325, dtype=torch.float64)
12 gae_duplicate tensor(1.1332, dtype=torch.float64) tensor(-18.9903, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7171, dtype=torch.float64) delta_t tensor(0.0457, dtype=torch.float64)
11 gae_duplicate tensor(0.6085, dtype=torch.float64) tensor(-13.7041, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6639, dtype=torch.float64) delta_t tensor(0.8962, dtype=torch.float64)
10 gae_duplicate tensor(1.3259, dtype=torch.float64) tensor(-17.2296, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8257, dtype=torch.float64) delta_t tensor(-1.0172, dtype=torch.float64)
9 gae_duplicate tensor(-0.9704, dtype=torch.float64) tensor(-11.2691, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7215, dtype=torch.float64) delta_t tensor(-0.6392, dtype=torch.float64)
8 gae_duplicate tensor(-2.1133, dtype=torch.float64) tensor(0.6973, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6396, dtype=torch.float64) delta_t tensor(-0.8150, dtype=torch.float64)
7 gae_duplicate tensor(-3.9549, dtype=torch.float64) tensor(3.9912, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9520, dtype=torch.float64) delta_t tensor(-0.9037, dtype=torch.float64)
6 gae_duplicate tensor(-4.8685, dtype=torch.float64) tensor(16.4232, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8402, dtype=torch.float64) delta_t tensor(-0.4740, dtype=torch.float64)
5 gae_duplicate tensor(-4.5372, dtype=torch.float64) tensor(15.2607, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8222, dtype=torch.float64) delta_t tensor(-0.6226, dtype=torch.float64)
4 gae_duplicate tensor(-5.9949, dtype=torch.float64) tensor(28.7124, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3457, dtype=torch.float64) delta_t tensor(-0.0405, dtype=torch.float64)
3 gae_duplicate tensor(-5.1579, dtype=torch.float64) tensor(23.4645, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4188, dtype=torch.float64) delta_t tensor(-0.3384, dtype=torch.float64)
2 gae_duplicate tensor(-4.5923, dtype=torch.float64) tensor(16.1316, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-422.0104675292969
value loss:619.0328979492188
entropies:189.18153381347656
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.7787158489227295 seconds
19 rew tensor(0.6414, dtype=torch.float64) delta_t tensor(-0.4715, dtype=torch.float64)
19 gae_duplicate tensor(-1.4612, dtype=torch.float64) tensor(6.4260, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5361, dtype=torch.float64) delta_t tensor(0.3551, dtype=torch.float64)
18 gae_duplicate tensor(-1.2505, dtype=torch.float64) tensor(2.6165, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7396, dtype=torch.float64) delta_t tensor(0.1997, dtype=torch.float64)
17 gae_duplicate tensor(-0.8623, dtype=torch.float64) tensor(-3.0357, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7323, dtype=torch.float64) delta_t tensor(0.6760, dtype=torch.float64)
16 gae_duplicate tensor(-0.0616, dtype=torch.float64) tensor(-10.9650, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7325, dtype=torch.float64) delta_t tensor(0.6537, dtype=torch.float64)
15 gae_duplicate tensor(0.4890, dtype=torch.float64) tensor(-10.6384, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7177, dtype=torch.float64) delta_t tensor(0.6135, dtype=torch.float64)
14 gae_duplicate tensor(0.8240, dtype=torch.float64) tensor(-12.7564, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6428, dtype=torch.float64) delta_t tensor(0.6173, dtype=torch.float64)
13 gae_duplicate tensor(0.3938, dtype=torch.float64) tensor(-27.2049, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6359, dtype=torch.float64) delta_t tensor(0.4748, dtype=torch.float64)
12 gae_duplicate tensor(1.7315, dtype=torch.float64) tensor(-21.7641, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6211, dtype=torch.float64) delta_t tensor(0.5748, dtype=torch.float64)
11 gae_duplicate tensor(1.3499, dtype=torch.float64) tensor(-25.2819, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5135, dtype=torch.float64) delta_t tensor(0.2752, dtype=torch.float64)
10 gae_duplicate tensor(0.1752, dtype=torch.float64) tensor(-23.1578, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2450, dtype=torch.float64) delta_t tensor(-0.1234, dtype=torch.float64)
9 gae_duplicate tensor(0.1241, dtype=torch.float64) tensor(-17.3270, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1671, dtype=torch.float64) delta_t tensor(-0.0992, dtype=torch.float64)
8 gae_duplicate tensor(-0.9723, dtype=torch.float64) tensor(-10.6222, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2763, dtype=torch.float64) delta_t tensor(-0.3410, dtype=torch.float64)
7 gae_duplicate tensor(-2.0684, dtype=torch.float64) tensor(-9.1998, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8498, dtype=torch.float64) delta_t tensor(-0.6212, dtype=torch.float64)
6 gae_duplicate tensor(-3.9905, dtype=torch.float64) tensor(1.5004, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6186, dtype=torch.float64) delta_t tensor(-0.5845, dtype=torch.float64)
5 gae_duplicate tensor(-4.6698, dtype=torch.float64) tensor(5.7542, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4499, dtype=torch.float64) delta_t tensor(-0.2405, dtype=torch.float64)
4 gae_duplicate tensor(-4.5369, dtype=torch.float64) tensor(4.6441, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5396, dtype=torch.float64) delta_t tensor(-0.1626, dtype=torch.float64)
3 gae_duplicate tensor(-3.6872, dtype=torch.float64) tensor(7.2743, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2827, dtype=torch.float64) delta_t tensor(-0.2917, dtype=torch.float64)
2 gae_duplicate tensor(-2.9575, dtype=torch.float64) tensor(11.5621, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4724.5634765625
value loss:456.4378662109375
entropies:187.52099609375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.436039924621582 seconds
19 rew tensor(0.2961, dtype=torch.float64) delta_t tensor(-0.6796, dtype=torch.float64)
19 gae_duplicate tensor(-1.6162, dtype=torch.float64) tensor(6.1111, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4851, dtype=torch.float64) delta_t tensor(0.4452, dtype=torch.float64)
18 gae_duplicate tensor(-1.3286, dtype=torch.float64) tensor(-1.4849, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7468, dtype=torch.float64) delta_t tensor(0.3902, dtype=torch.float64)
17 gae_duplicate tensor(-0.4046, dtype=torch.float64) tensor(-2.1232, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7394, dtype=torch.float64) delta_t tensor(0.5406, dtype=torch.float64)
16 gae_duplicate tensor(0.0191, dtype=torch.float64) tensor(-10.2240, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7397, dtype=torch.float64) delta_t tensor(0.7275, dtype=torch.float64)
15 gae_duplicate tensor(0.6038, dtype=torch.float64) tensor(-10.7368, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7474, dtype=torch.float64) delta_t tensor(0.6271, dtype=torch.float64)
14 gae_duplicate tensor(1.0863, dtype=torch.float64) tensor(-15.4603, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6789, dtype=torch.float64) delta_t tensor(0.4412, dtype=torch.float64)
13 gae_duplicate tensor(0.5970, dtype=torch.float64) tensor(-25.6234, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6488, dtype=torch.float64) delta_t tensor(0.7142, dtype=torch.float64)
12 gae_duplicate tensor(0.8207, dtype=torch.float64) tensor(-25.1388, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6301, dtype=torch.float64) delta_t tensor(0.5238, dtype=torch.float64)
11 gae_duplicate tensor(1.1167, dtype=torch.float64) tensor(-17.5563, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2495, dtype=torch.float64) delta_t tensor(-0.4752, dtype=torch.float64)
10 gae_duplicate tensor(-1.9696, dtype=torch.float64) tensor(-11.4126, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0711, dtype=torch.float64) delta_t tensor(-0.1387, dtype=torch.float64)
9 gae_duplicate tensor(-1.0789, dtype=torch.float64) tensor(-3.2429, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9314, dtype=torch.float64) delta_t tensor(-1.1863, dtype=torch.float64)
8 gae_duplicate tensor(-3.6882, dtype=torch.float64) tensor(-0.0976, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9380, dtype=torch.float64) delta_t tensor(-1.0337, dtype=torch.float64)
7 gae_duplicate tensor(-2.7318, dtype=torch.float64) tensor(17.3748, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0051, dtype=torch.float64) delta_t tensor(-0.8370, dtype=torch.float64)
6 gae_duplicate tensor(-4.0435, dtype=torch.float64) tensor(30.9487, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2893, dtype=torch.float64) delta_t tensor(-0.8760, dtype=torch.float64)
5 gae_duplicate tensor(-4.8925, dtype=torch.float64) tensor(27.2971, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1347, dtype=torch.float64) delta_t tensor(-0.8810, dtype=torch.float64)
4 gae_duplicate tensor(-6.5286, dtype=torch.float64) tensor(20.9956, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3534, dtype=torch.float64) delta_t tensor(-0.0806, dtype=torch.float64)
3 gae_duplicate tensor(-4.8808, dtype=torch.float64) tensor(23.8159, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3706, dtype=torch.float64) delta_t tensor(-0.2864, dtype=torch.float64)
2 gae_duplicate tensor(-3.8548, dtype=torch.float64) tensor(32.6195, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1331.8944091796875
value loss:758.5592041015625
entropies:187.0550079345703
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.9301111698150635 seconds
19 rew tensor(0.5337, dtype=torch.float64) delta_t tensor(-0.5623, dtype=torch.float64)
19 gae_duplicate tensor(-1.6590, dtype=torch.float64) tensor(2.8050, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3364, dtype=torch.float64) delta_t tensor(0.3999, dtype=torch.float64)
18 gae_duplicate tensor(-1.3198, dtype=torch.float64) tensor(0.5827, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4824, dtype=torch.float64) delta_t tensor(0.6520, dtype=torch.float64)
17 gae_duplicate tensor(-1.2240, dtype=torch.float64) tensor(-6.0219, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7467, dtype=torch.float64) delta_t tensor(0.5199, dtype=torch.float64)
16 gae_duplicate tensor(-0.3427, dtype=torch.float64) tensor(-12.3304, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7092, dtype=torch.float64) delta_t tensor(0.4876, dtype=torch.float64)
15 gae_duplicate tensor(0.3044, dtype=torch.float64) tensor(-11.9076, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6555, dtype=torch.float64) delta_t tensor(0.5249, dtype=torch.float64)
14 gae_duplicate tensor(0.8107, dtype=torch.float64) tensor(-14.6414, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6568, dtype=torch.float64) delta_t tensor(0.5802, dtype=torch.float64)
13 gae_duplicate tensor(0.5227, dtype=torch.float64) tensor(-14.8274, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5889, dtype=torch.float64) delta_t tensor(0.1962, dtype=torch.float64)
12 gae_duplicate tensor(0.7448, dtype=torch.float64) tensor(-20.4215, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5734, dtype=torch.float64) delta_t tensor(0.3526, dtype=torch.float64)
11 gae_duplicate tensor(0.5472, dtype=torch.float64) tensor(-10.7338, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6178, dtype=torch.float64) delta_t tensor(0.2447, dtype=torch.float64)
10 gae_duplicate tensor(0.9422, dtype=torch.float64) tensor(-14.3312, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1273, dtype=torch.float64) delta_t tensor(0.0977, dtype=torch.float64)
9 gae_duplicate tensor(-0.6519, dtype=torch.float64) tensor(-13.7386, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7035, dtype=torch.float64) delta_t tensor(-0.8074, dtype=torch.float64)
8 gae_duplicate tensor(-4.1764, dtype=torch.float64) tensor(-3.3938, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6502, dtype=torch.float64) delta_t tensor(-0.7022, dtype=torch.float64)
7 gae_duplicate tensor(-4.9310, dtype=torch.float64) tensor(1.6523, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2807, dtype=torch.float64) delta_t tensor(-0.9465, dtype=torch.float64)
6 gae_duplicate tensor(-5.8579, dtype=torch.float64) tensor(22.6710, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0312, dtype=torch.float64) delta_t tensor(-0.8141, dtype=torch.float64)
5 gae_duplicate tensor(-5.8098, dtype=torch.float64) tensor(18.5847, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6641, dtype=torch.float64) delta_t tensor(-1.3846, dtype=torch.float64)
4 gae_duplicate tensor(-8.8753, dtype=torch.float64) tensor(65.2088, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3857, dtype=torch.float64) delta_t tensor(-0.0525, dtype=torch.float64)
3 gae_duplicate tensor(-7.0541, dtype=torch.float64) tensor(24.1420, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2624, dtype=torch.float64) delta_t tensor(-0.1499, dtype=torch.float64)
2 gae_duplicate tensor(-5.7959, dtype=torch.float64) tensor(18.3376, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1172.30419921875
value loss:848.7654418945312
entropies:185.4477996826172
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.015623331069946 seconds
19 rew tensor(0.5438, dtype=torch.float64) delta_t tensor(-0.7148, dtype=torch.float64)
19 gae_duplicate tensor(-1.6282, dtype=torch.float64) tensor(5.7805, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3470, dtype=torch.float64) delta_t tensor(0.2731, dtype=torch.float64)
18 gae_duplicate tensor(-1.5248, dtype=torch.float64) tensor(3.9043, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6288, dtype=torch.float64) delta_t tensor(0.3529, dtype=torch.float64)
17 gae_duplicate tensor(-0.8226, dtype=torch.float64) tensor(-0.5516, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5104, dtype=torch.float64) delta_t tensor(0.3730, dtype=torch.float64)
16 gae_duplicate tensor(-0.1232, dtype=torch.float64) tensor(-4.8800, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2980, dtype=torch.float64) delta_t tensor(0.3344, dtype=torch.float64)
15 gae_duplicate tensor(0.0897, dtype=torch.float64) tensor(-4.3272, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3473, dtype=torch.float64) delta_t tensor(0.2944, dtype=torch.float64)
14 gae_duplicate tensor(0.1649, dtype=torch.float64) tensor(-9.4207, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6180, dtype=torch.float64) delta_t tensor(0.1916, dtype=torch.float64)
13 gae_duplicate tensor(0.1153, dtype=torch.float64) tensor(-10.7568, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7246, dtype=torch.float64) delta_t tensor(0.4652, dtype=torch.float64)
12 gae_duplicate tensor(0.5188, dtype=torch.float64) tensor(-12.5194, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0746, dtype=torch.float64) delta_t tensor(-0.3273, dtype=torch.float64)
11 gae_duplicate tensor(-1.4271, dtype=torch.float64) tensor(-9.5914, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2460, dtype=torch.float64) delta_t tensor(-0.3249, dtype=torch.float64)
10 gae_duplicate tensor(-1.5320, dtype=torch.float64) tensor(1.0332, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0206, dtype=torch.float64) delta_t tensor(-1.0187, dtype=torch.float64)
9 gae_duplicate tensor(-2.6427, dtype=torch.float64) tensor(7.0722, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2924, dtype=torch.float64) delta_t tensor(-0.4711, dtype=torch.float64)
8 gae_duplicate tensor(-2.3277, dtype=torch.float64) tensor(11.4626, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3020, dtype=torch.float64) delta_t tensor(-0.3513, dtype=torch.float64)
7 gae_duplicate tensor(-3.0297, dtype=torch.float64) tensor(20.8184, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4454, dtype=torch.float64) delta_t tensor(-0.2356, dtype=torch.float64)
6 gae_duplicate tensor(-3.0460, dtype=torch.float64) tensor(12.3870, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9847, dtype=torch.float64) delta_t tensor(-0.3786, dtype=torch.float64)
5 gae_duplicate tensor(-3.2406, dtype=torch.float64) tensor(12.0741, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9776, dtype=torch.float64) delta_t tensor(-0.6661, dtype=torch.float64)
4 gae_duplicate tensor(-6.5819, dtype=torch.float64) tensor(27.0528, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0644, dtype=torch.float64) delta_t tensor(-0.1228, dtype=torch.float64)
3 gae_duplicate tensor(-5.2644, dtype=torch.float64) tensor(14.5163, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3642, dtype=torch.float64) delta_t tensor(-0.0444, dtype=torch.float64)
2 gae_duplicate tensor(-3.9321, dtype=torch.float64) tensor(13.7021, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2832.38720703125
value loss:373.0377197265625
entropies:184.23587036132812
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2268.7822)
ToM Target loss= tensor(1802.2493)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.984295129776001 seconds
19 rew tensor(0.7238, dtype=torch.float64) delta_t tensor(-0.4535, dtype=torch.float64)
19 gae_duplicate tensor(-0.8191, dtype=torch.float64) tensor(5.5067, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7316, dtype=torch.float64) delta_t tensor(0.3729, dtype=torch.float64)
18 gae_duplicate tensor(-0.3150, dtype=torch.float64) tensor(0.4499, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6856, dtype=torch.float64) delta_t tensor(0.5532, dtype=torch.float64)
17 gae_duplicate tensor(-0.1294, dtype=torch.float64) tensor(-3.3610, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6550, dtype=torch.float64) delta_t tensor(0.6405, dtype=torch.float64)
16 gae_duplicate tensor(0.0899, dtype=torch.float64) tensor(-9.8113, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5630, dtype=torch.float64) delta_t tensor(0.5103, dtype=torch.float64)
15 gae_duplicate tensor(0.3051, dtype=torch.float64) tensor(-13.7396, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4016, dtype=torch.float64) delta_t tensor(0.4233, dtype=torch.float64)
14 gae_duplicate tensor(0.2883, dtype=torch.float64) tensor(-10.0128, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7166, dtype=torch.float64) delta_t tensor(0.4978, dtype=torch.float64)
13 gae_duplicate tensor(0.1111, dtype=torch.float64) tensor(-14.8397, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7165, dtype=torch.float64) delta_t tensor(0.6562, dtype=torch.float64)
12 gae_duplicate tensor(0.6393, dtype=torch.float64) tensor(-25.2808, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7172, dtype=torch.float64) delta_t tensor(0.2847, dtype=torch.float64)
11 gae_duplicate tensor(1.0418, dtype=torch.float64) tensor(-20.8832, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6335, dtype=torch.float64) delta_t tensor(0.5081, dtype=torch.float64)
10 gae_duplicate tensor(1.3973, dtype=torch.float64) tensor(-14.3833, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3334, dtype=torch.float64) delta_t tensor(-0.6656, dtype=torch.float64)
9 gae_duplicate tensor(-1.0604, dtype=torch.float64) tensor(-2.0675, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2421, dtype=torch.float64) delta_t tensor(-0.2989, dtype=torch.float64)
8 gae_duplicate tensor(-3.4673, dtype=torch.float64) tensor(-2.3525, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1117, dtype=torch.float64) delta_t tensor(-1.2598, dtype=torch.float64)
7 gae_duplicate tensor(-4.5093, dtype=torch.float64) tensor(3.6205, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2123, dtype=torch.float64) delta_t tensor(-0.8066, dtype=torch.float64)
6 gae_duplicate tensor(-3.5613, dtype=torch.float64) tensor(6.5388, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4067, dtype=torch.float64) delta_t tensor(-1.1273, dtype=torch.float64)
5 gae_duplicate tensor(-3.7338, dtype=torch.float64) tensor(28.6715, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9058, dtype=torch.float64) delta_t tensor(-2.6870, dtype=torch.float64)
4 gae_duplicate tensor(-8.1775, dtype=torch.float64) tensor(45.5162, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2245, dtype=torch.float64) delta_t tensor(0.2088, dtype=torch.float64)
3 gae_duplicate tensor(-5.9412, dtype=torch.float64) tensor(31.4542, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4615, dtype=torch.float64) delta_t tensor(-0.1415, dtype=torch.float64)
2 gae_duplicate tensor(-4.4880, dtype=torch.float64) tensor(47.3136, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1916.8475341796875
value loss:947.0193481445312
entropies:181.25364685058594
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.611918210983276 seconds
19 rew tensor(0.7158, dtype=torch.float64) delta_t tensor(-0.3611, dtype=torch.float64)
19 gae_duplicate tensor(-0.7960, dtype=torch.float64) tensor(4.6774, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6775, dtype=torch.float64) delta_t tensor(0.4649, dtype=torch.float64)
18 gae_duplicate tensor(-0.3230, dtype=torch.float64) tensor(-0.5293, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6314, dtype=torch.float64) delta_t tensor(0.3106, dtype=torch.float64)
17 gae_duplicate tensor(0.0519, dtype=torch.float64) tensor(-4.7805, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4929, dtype=torch.float64) delta_t tensor(0.6654, dtype=torch.float64)
16 gae_duplicate tensor(0.1755, dtype=torch.float64) tensor(-11.5541, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6853, dtype=torch.float64) delta_t tensor(0.6057, dtype=torch.float64)
15 gae_duplicate tensor(0.7405, dtype=torch.float64) tensor(-19.5199, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6313, dtype=torch.float64) delta_t tensor(0.5399, dtype=torch.float64)
14 gae_duplicate tensor(0.9161, dtype=torch.float64) tensor(-21.6068, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6330, dtype=torch.float64) delta_t tensor(0.5562, dtype=torch.float64)
13 gae_duplicate tensor(0.9832, dtype=torch.float64) tensor(-23.0126, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7400, dtype=torch.float64) delta_t tensor(0.8395, dtype=torch.float64)
12 gae_duplicate tensor(1.2347, dtype=torch.float64) tensor(-26.9998, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2606, dtype=torch.float64) delta_t tensor(-0.2048, dtype=torch.float64)
11 gae_duplicate tensor(-1.0624, dtype=torch.float64) tensor(-27.3625, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4810, dtype=torch.float64) delta_t tensor(-0.0168, dtype=torch.float64)
10 gae_duplicate tensor(-0.5196, dtype=torch.float64) tensor(-15.5248, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0697, dtype=torch.float64) delta_t tensor(-0.2616, dtype=torch.float64)
9 gae_duplicate tensor(-1.0666, dtype=torch.float64) tensor(-8.5060, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2899, dtype=torch.float64) delta_t tensor(-0.1461, dtype=torch.float64)
8 gae_duplicate tensor(-2.3813, dtype=torch.float64) tensor(-2.9776, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9601, dtype=torch.float64) delta_t tensor(-1.0973, dtype=torch.float64)
7 gae_duplicate tensor(-3.6094, dtype=torch.float64) tensor(16.9253, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7340, dtype=torch.float64) delta_t tensor(-0.4684, dtype=torch.float64)
6 gae_duplicate tensor(-3.3465, dtype=torch.float64) tensor(9.9024, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3115, dtype=torch.float64) delta_t tensor(-0.8847, dtype=torch.float64)
5 gae_duplicate tensor(-4.6558, dtype=torch.float64) tensor(19.0119, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5409, dtype=torch.float64) delta_t tensor(-1.1833, dtype=torch.float64)
4 gae_duplicate tensor(-8.0344, dtype=torch.float64) tensor(35.4875, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2234, dtype=torch.float64) delta_t tensor(-0.0680, dtype=torch.float64)
3 gae_duplicate tensor(-5.9992, dtype=torch.float64) tensor(20.2099, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2480, dtype=torch.float64) delta_t tensor(-0.1252, dtype=torch.float64)
2 gae_duplicate tensor(-5.1772, dtype=torch.float64) tensor(16.5550, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1393.6092529296875
value loss:779.0394897460938
entropies:178.61500549316406
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.688816785812378 seconds
19 rew tensor(0.7095, dtype=torch.float64) delta_t tensor(-0.4910, dtype=torch.float64)
19 gae_duplicate tensor(-0.8370, dtype=torch.float64) tensor(4.0561, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6723, dtype=torch.float64) delta_t tensor(0.4109, dtype=torch.float64)
18 gae_duplicate tensor(-0.7363, dtype=torch.float64) tensor(1.8672, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5972, dtype=torch.float64) delta_t tensor(0.3447, dtype=torch.float64)
17 gae_duplicate tensor(-0.6914, dtype=torch.float64) tensor(-1.9024, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4473, dtype=torch.float64) delta_t tensor(0.7045, dtype=torch.float64)
16 gae_duplicate tensor(-0.0842, dtype=torch.float64) tensor(-7.0161, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6317, dtype=torch.float64) delta_t tensor(0.4900, dtype=torch.float64)
15 gae_duplicate tensor(0.6014, dtype=torch.float64) tensor(-11.4874, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5848, dtype=torch.float64) delta_t tensor(0.5242, dtype=torch.float64)
14 gae_duplicate tensor(0.7506, dtype=torch.float64) tensor(-16.9301, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7174, dtype=torch.float64) delta_t tensor(0.6796, dtype=torch.float64)
13 gae_duplicate tensor(0.9071, dtype=torch.float64) tensor(-22.9078, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4787, dtype=torch.float64) delta_t tensor(0.3455, dtype=torch.float64)
12 gae_duplicate tensor(0.9936, dtype=torch.float64) tensor(-19.0910, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5205, dtype=torch.float64) delta_t tensor(0.1980, dtype=torch.float64)
11 gae_duplicate tensor(1.1294, dtype=torch.float64) tensor(-17.6668, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5311, dtype=torch.float64) delta_t tensor(-0.5534, dtype=torch.float64)
10 gae_duplicate tensor(-3.3639, dtype=torch.float64) tensor(-8.7639, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2992, dtype=torch.float64) delta_t tensor(-0.5710, dtype=torch.float64)
9 gae_duplicate tensor(-4.2154, dtype=torch.float64) tensor(-5.7234, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3307, dtype=torch.float64) delta_t tensor(-0.4093, dtype=torch.float64)
8 gae_duplicate tensor(-3.2850, dtype=torch.float64) tensor(0.3023, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0732, dtype=torch.float64) delta_t tensor(0.2230, dtype=torch.float64)
7 gae_duplicate tensor(-1.8486, dtype=torch.float64) tensor(3.4499, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0890, dtype=torch.float64) delta_t tensor(0.1425, dtype=torch.float64)
6 gae_duplicate tensor(-1.5618, dtype=torch.float64) tensor(0.7002, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4248, dtype=torch.float64) delta_t tensor(-0.0225, dtype=torch.float64)
5 gae_duplicate tensor(-1.4812, dtype=torch.float64) tensor(-0.1632, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5531, dtype=torch.float64) delta_t tensor(-0.3748, dtype=torch.float64)
4 gae_duplicate tensor(-2.3730, dtype=torch.float64) tensor(3.9085, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4298, dtype=torch.float64) delta_t tensor(-0.1031, dtype=torch.float64)
3 gae_duplicate tensor(-1.7894, dtype=torch.float64) tensor(2.3624, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5391, dtype=torch.float64) delta_t tensor(-0.2777, dtype=torch.float64)
2 gae_duplicate tensor(-1.6289, dtype=torch.float64) tensor(4.9347, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3210.69775390625
value loss:338.68682861328125
entropies:176.98452758789062
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.699235677719116 seconds
19 rew tensor(0.5072, dtype=torch.float64) delta_t tensor(-0.5268, dtype=torch.float64)
19 gae_duplicate tensor(-1.6668, dtype=torch.float64) tensor(3.5595, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2504, dtype=torch.float64) delta_t tensor(-0.1596, dtype=torch.float64)
18 gae_duplicate tensor(-1.6335, dtype=torch.float64) tensor(6.0041, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3452, dtype=torch.float64) delta_t tensor(0.1810, dtype=torch.float64)
17 gae_duplicate tensor(-1.4329, dtype=torch.float64) tensor(-0.3453, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4442, dtype=torch.float64) delta_t tensor(0.4041, dtype=torch.float64)
16 gae_duplicate tensor(-0.6387, dtype=torch.float64) tensor(-3.1490, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5851, dtype=torch.float64) delta_t tensor(0.4630, dtype=torch.float64)
15 gae_duplicate tensor(0.1354, dtype=torch.float64) tensor(-5.0094, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7085, dtype=torch.float64) delta_t tensor(0.8496, dtype=torch.float64)
14 gae_duplicate tensor(0.7549, dtype=torch.float64) tensor(-9.9983, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6134, dtype=torch.float64) delta_t tensor(0.2322, dtype=torch.float64)
13 gae_duplicate tensor(0.0148, dtype=torch.float64) tensor(-10.5225, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5898, dtype=torch.float64) delta_t tensor(0.3799, dtype=torch.float64)
12 gae_duplicate tensor(0.0949, dtype=torch.float64) tensor(-13.1059, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0443, dtype=torch.float64) delta_t tensor(-0.2141, dtype=torch.float64)
11 gae_duplicate tensor(-3.1197, dtype=torch.float64) tensor(-17.8359, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1257, dtype=torch.float64) delta_t tensor(-0.1058, dtype=torch.float64)
10 gae_duplicate tensor(-3.9614, dtype=torch.float64) tensor(-0.0668, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0766, dtype=torch.float64) delta_t tensor(-0.1380, dtype=torch.float64)
9 gae_duplicate tensor(-2.7859, dtype=torch.float64) tensor(-3.5043, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4746, dtype=torch.float64) delta_t tensor(-0.2139, dtype=torch.float64)
8 gae_duplicate tensor(-1.4062, dtype=torch.float64) tensor(-0.1022, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6061, dtype=torch.float64) delta_t tensor(-0.5777, dtype=torch.float64)
7 gae_duplicate tensor(-1.8276, dtype=torch.float64) tensor(4.7381, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2448, dtype=torch.float64) delta_t tensor(-1.1447, dtype=torch.float64)
6 gae_duplicate tensor(-5.5575, dtype=torch.float64) tensor(17.8742, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0648, dtype=torch.float64) delta_t tensor(-0.7455, dtype=torch.float64)
5 gae_duplicate tensor(-7.0073, dtype=torch.float64) tensor(10.0394, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9442, dtype=torch.float64) delta_t tensor(-0.6513, dtype=torch.float64)
4 gae_duplicate tensor(-8.2647, dtype=torch.float64) tensor(20.6547, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0950, dtype=torch.float64) delta_t tensor(0.3127, dtype=torch.float64)
3 gae_duplicate tensor(-6.3285, dtype=torch.float64) tensor(18.6056, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3225, dtype=torch.float64) delta_t tensor(-0.4025, dtype=torch.float64)
2 gae_duplicate tensor(-4.9875, dtype=torch.float64) tensor(13.7195, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1167.7127685546875
value loss:645.6639404296875
entropies:176.19296264648438
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.7961578369140625 seconds
19 rew tensor(0.6317, dtype=torch.float64) delta_t tensor(-0.7202, dtype=torch.float64)
19 gae_duplicate tensor(-1.0747, dtype=torch.float64) tensor(8.5534, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5617, dtype=torch.float64) delta_t tensor(0.3092, dtype=torch.float64)
18 gae_duplicate tensor(-1.1205, dtype=torch.float64) tensor(1.7379, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6789, dtype=torch.float64) delta_t tensor(0.3803, dtype=torch.float64)
17 gae_duplicate tensor(-0.3984, dtype=torch.float64) tensor(-2.9491, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6326, dtype=torch.float64) delta_t tensor(0.5572, dtype=torch.float64)
16 gae_duplicate tensor(-0.1797, dtype=torch.float64) tensor(-8.0380, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5009, dtype=torch.float64) delta_t tensor(0.7714, dtype=torch.float64)
15 gae_duplicate tensor(0.1624, dtype=torch.float64) tensor(-12.5606, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6635, dtype=torch.float64) delta_t tensor(0.4594, dtype=torch.float64)
14 gae_duplicate tensor(0.8285, dtype=torch.float64) tensor(-15.1563, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7415, dtype=torch.float64) delta_t tensor(0.1651, dtype=torch.float64)
13 gae_duplicate tensor(0.1399, dtype=torch.float64) tensor(-18.8861, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7339, dtype=torch.float64) delta_t tensor(0.6063, dtype=torch.float64)
12 gae_duplicate tensor(0.7664, dtype=torch.float64) tensor(-16.6753, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6921, dtype=torch.float64) delta_t tensor(0.3835, dtype=torch.float64)
11 gae_duplicate tensor(1.0877, dtype=torch.float64) tensor(-15.8717, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6375, dtype=torch.float64) delta_t tensor(0.6420, dtype=torch.float64)
10 gae_duplicate tensor(1.3784, dtype=torch.float64) tensor(-21.1550, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1383, dtype=torch.float64) delta_t tensor(-0.0288, dtype=torch.float64)
9 gae_duplicate tensor(-0.4906, dtype=torch.float64) tensor(-22.4709, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7305, dtype=torch.float64) delta_t tensor(-0.5273, dtype=torch.float64)
8 gae_duplicate tensor(-2.1306, dtype=torch.float64) tensor(-3.9768, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4489, dtype=torch.float64) delta_t tensor(-0.4938, dtype=torch.float64)
7 gae_duplicate tensor(-3.2267, dtype=torch.float64) tensor(-3.2649, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7827, dtype=torch.float64) delta_t tensor(-0.5681, dtype=torch.float64)
6 gae_duplicate tensor(-3.4352, dtype=torch.float64) tensor(4.9316, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4706, dtype=torch.float64) delta_t tensor(-0.1273, dtype=torch.float64)
5 gae_duplicate tensor(-3.7031, dtype=torch.float64) tensor(7.8105, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9299, dtype=torch.float64) delta_t tensor(-0.7477, dtype=torch.float64)
4 gae_duplicate tensor(-3.6357, dtype=torch.float64) tensor(15.4194, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0997, dtype=torch.float64) delta_t tensor(0.4288, dtype=torch.float64)
3 gae_duplicate tensor(-1.9140, dtype=torch.float64) tensor(7.7466, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5043, dtype=torch.float64) delta_t tensor(-0.4728, dtype=torch.float64)
2 gae_duplicate tensor(-1.4026, dtype=torch.float64) tensor(9.2648, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3047.779052734375
value loss:372.06048583984375
entropies:176.01434326171875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2288.7031)
ToM Target loss= tensor(1803.6902)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.329015016555786 seconds
19 rew tensor(0.7169, dtype=torch.float64) delta_t tensor(-0.6767, dtype=torch.float64)
19 gae_duplicate tensor(-1.0198, dtype=torch.float64) tensor(6.4109, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7081, dtype=torch.float64) delta_t tensor(0.2925, dtype=torch.float64)
18 gae_duplicate tensor(-0.4298, dtype=torch.float64) tensor(2.1427, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6429, dtype=torch.float64) delta_t tensor(0.3483, dtype=torch.float64)
17 gae_duplicate tensor(-0.6130, dtype=torch.float64) tensor(-1.8514, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5766, dtype=torch.float64) delta_t tensor(0.5449, dtype=torch.float64)
16 gae_duplicate tensor(-0.8238, dtype=torch.float64) tensor(-5.4316, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7341, dtype=torch.float64) delta_t tensor(0.9641, dtype=torch.float64)
15 gae_duplicate tensor(0.6886, dtype=torch.float64) tensor(-14.1018, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6493, dtype=torch.float64) delta_t tensor(0.3896, dtype=torch.float64)
14 gae_duplicate tensor(0.8692, dtype=torch.float64) tensor(-26.0500, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3545, dtype=torch.float64) delta_t tensor(0.3249, dtype=torch.float64)
13 gae_duplicate tensor(0.3443, dtype=torch.float64) tensor(-19.8933, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3314, dtype=torch.float64) delta_t tensor(0.2143, dtype=torch.float64)
12 gae_duplicate tensor(-0.2665, dtype=torch.float64) tensor(-16.8060, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3490, dtype=torch.float64) delta_t tensor(-0.0206, dtype=torch.float64)
11 gae_duplicate tensor(-1.5039, dtype=torch.float64) tensor(-12.0386, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2734, dtype=torch.float64) delta_t tensor(-0.1950, dtype=torch.float64)
10 gae_duplicate tensor(-1.9265, dtype=torch.float64) tensor(-8.0125, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0714, dtype=torch.float64) delta_t tensor(-0.2388, dtype=torch.float64)
9 gae_duplicate tensor(-1.4981, dtype=torch.float64) tensor(-4.5790, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5550, dtype=torch.float64) delta_t tensor(-0.4153, dtype=torch.float64)
8 gae_duplicate tensor(-2.4356, dtype=torch.float64) tensor(-1.5662, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7760, dtype=torch.float64) delta_t tensor(-0.6858, dtype=torch.float64)
7 gae_duplicate tensor(-4.3081, dtype=torch.float64) tensor(8.2914, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5722, dtype=torch.float64) delta_t tensor(-0.2244, dtype=torch.float64)
6 gae_duplicate tensor(-4.1217, dtype=torch.float64) tensor(8.6180, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4924, dtype=torch.float64) delta_t tensor(-1.0925, dtype=torch.float64)
5 gae_duplicate tensor(-4.5396, dtype=torch.float64) tensor(27.3212, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2198, dtype=torch.float64) delta_t tensor(0.1165, dtype=torch.float64)
4 gae_duplicate tensor(-4.7924, dtype=torch.float64) tensor(12.2483, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5237, dtype=torch.float64) delta_t tensor(-0.3716, dtype=torch.float64)
3 gae_duplicate tensor(-3.7408, dtype=torch.float64) tensor(6.9652, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1357, dtype=torch.float64) delta_t tensor(-0.1847, dtype=torch.float64)
2 gae_duplicate tensor(-3.0790, dtype=torch.float64) tensor(14.4838, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:826.8212280273438
value loss:474.6949462890625
entropies:176.3806915283203
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.632265090942383 seconds
19 rew tensor(0.5479, dtype=torch.float64) delta_t tensor(-0.3910, dtype=torch.float64)
19 gae_duplicate tensor(-1.5141, dtype=torch.float64) tensor(5.9619, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7256, dtype=torch.float64) delta_t tensor(0.4639, dtype=torch.float64)
18 gae_duplicate tensor(-0.7181, dtype=torch.float64) tensor(0.1426, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7416, dtype=torch.float64) delta_t tensor(0.5934, dtype=torch.float64)
17 gae_duplicate tensor(-0.0398, dtype=torch.float64) tensor(-6.9115, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7265, dtype=torch.float64) delta_t tensor(0.4974, dtype=torch.float64)
16 gae_duplicate tensor(0.4512, dtype=torch.float64) tensor(-10.3682, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7105, dtype=torch.float64) delta_t tensor(0.5647, dtype=torch.float64)
15 gae_duplicate tensor(0.8992, dtype=torch.float64) tensor(-16.2739, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6802, dtype=torch.float64) delta_t tensor(0.2373, dtype=torch.float64)
14 gae_duplicate tensor(0.2331, dtype=torch.float64) tensor(-16.7626, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7015, dtype=torch.float64) delta_t tensor(0.5218, dtype=torch.float64)
13 gae_duplicate tensor(0.5799, dtype=torch.float64) tensor(-16.7315, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6563, dtype=torch.float64) delta_t tensor(0.4090, dtype=torch.float64)
12 gae_duplicate tensor(0.9112, dtype=torch.float64) tensor(-19.0324, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6408, dtype=torch.float64) delta_t tensor(0.4882, dtype=torch.float64)
11 gae_duplicate tensor(1.1765, dtype=torch.float64) tensor(-14.0448, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5622, dtype=torch.float64) delta_t tensor(0.2483, dtype=torch.float64)
10 gae_duplicate tensor(1.3679, dtype=torch.float64) tensor(-14.2746, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2858, dtype=torch.float64) delta_t tensor(-0.4758, dtype=torch.float64)
9 gae_duplicate tensor(-0.1594, dtype=torch.float64) tensor(-6.6790, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3038, dtype=torch.float64) delta_t tensor(-1.4466, dtype=torch.float64)
8 gae_duplicate tensor(-3.4401, dtype=torch.float64) tensor(12.0014, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6947, dtype=torch.float64) delta_t tensor(-0.6210, dtype=torch.float64)
7 gae_duplicate tensor(-3.4051, dtype=torch.float64) tensor(9.7924, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5849, dtype=torch.float64) delta_t tensor(-0.3873, dtype=torch.float64)
6 gae_duplicate tensor(-4.1611, dtype=torch.float64) tensor(15.3758, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1436, dtype=torch.float64) delta_t tensor(-0.7993, dtype=torch.float64)
5 gae_duplicate tensor(-5.1972, dtype=torch.float64) tensor(26.9951, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5188, dtype=torch.float64) delta_t tensor(-1.3006, dtype=torch.float64)
4 gae_duplicate tensor(-6.9460, dtype=torch.float64) tensor(25.6769, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2725, dtype=torch.float64) delta_t tensor(0.2496, dtype=torch.float64)
3 gae_duplicate tensor(-4.5353, dtype=torch.float64) tensor(14.0188, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2490, dtype=torch.float64) delta_t tensor(-0.0316, dtype=torch.float64)
2 gae_duplicate tensor(-3.3520, dtype=torch.float64) tensor(23.9623, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-494.3875732421875
value loss:709.5352172851562
entropies:176.79957580566406
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.8212878704071045 seconds
19 rew tensor(0.6800, dtype=torch.float64) delta_t tensor(-0.7758, dtype=torch.float64)
19 gae_duplicate tensor(-1.2390, dtype=torch.float64) tensor(6.5082, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5953, dtype=torch.float64) delta_t tensor(0.2206, dtype=torch.float64)
18 gae_duplicate tensor(-1.1907, dtype=torch.float64) tensor(4.8159, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4567, dtype=torch.float64) delta_t tensor(0.3193, dtype=torch.float64)
17 gae_duplicate tensor(-0.8969, dtype=torch.float64) tensor(0.5565, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6507, dtype=torch.float64) delta_t tensor(0.3025, dtype=torch.float64)
16 gae_duplicate tensor(-0.4021, dtype=torch.float64) tensor(-5.3289, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5747, dtype=torch.float64) delta_t tensor(0.5046, dtype=torch.float64)
15 gae_duplicate tensor(-0.2746, dtype=torch.float64) tensor(-6.3908, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7424, dtype=torch.float64) delta_t tensor(0.5997, dtype=torch.float64)
14 gae_duplicate tensor(0.3280, dtype=torch.float64) tensor(-11.6225, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7030, dtype=torch.float64) delta_t tensor(0.5894, dtype=torch.float64)
13 gae_duplicate tensor(0.8103, dtype=torch.float64) tensor(-11.1169, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6640, dtype=torch.float64) delta_t tensor(0.4538, dtype=torch.float64)
12 gae_duplicate tensor(0.8161, dtype=torch.float64) tensor(-15.3367, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3733, dtype=torch.float64) delta_t tensor(0.2291, dtype=torch.float64)
11 gae_duplicate tensor(-0.3238, dtype=torch.float64) tensor(-20.6515, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1320, dtype=torch.float64) delta_t tensor(-0.0331, dtype=torch.float64)
10 gae_duplicate tensor(-2.1848, dtype=torch.float64) tensor(-11.3216, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3964, dtype=torch.float64) delta_t tensor(-0.0282, dtype=torch.float64)
9 gae_duplicate tensor(-1.9012, dtype=torch.float64) tensor(-8.7182, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1773, dtype=torch.float64) delta_t tensor(-0.0063, dtype=torch.float64)
8 gae_duplicate tensor(-1.3914, dtype=torch.float64) tensor(-9.3435, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1564, dtype=torch.float64) delta_t tensor(-0.3657, dtype=torch.float64)
7 gae_duplicate tensor(-1.6664, dtype=torch.float64) tensor(-2.0754, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4465, dtype=torch.float64) delta_t tensor(-0.0179, dtype=torch.float64)
6 gae_duplicate tensor(-0.9740, dtype=torch.float64) tensor(-3.7522, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1352, dtype=torch.float64) delta_t tensor(-0.9199, dtype=torch.float64)
5 gae_duplicate tensor(-2.1574, dtype=torch.float64) tensor(6.9669, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0014, dtype=torch.float64) delta_t tensor(-0.8203, dtype=torch.float64)
4 gae_duplicate tensor(-5.6985, dtype=torch.float64) tensor(9.7058, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5660, dtype=torch.float64) delta_t tensor(-0.1600, dtype=torch.float64)
3 gae_duplicate tensor(-4.4853, dtype=torch.float64) tensor(15.1544, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3685, dtype=torch.float64) delta_t tensor(-0.6222, dtype=torch.float64)
2 gae_duplicate tensor(-3.9131, dtype=torch.float64) tensor(15.6161, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1636.120849609375
value loss:377.5744934082031
entropies:177.2806396484375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.8650548458099365 seconds
19 rew tensor(0.5896, dtype=torch.float64) delta_t tensor(-0.9994, dtype=torch.float64)
19 gae_duplicate tensor(-1.3570, dtype=torch.float64) tensor(10.6698, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4440, dtype=torch.float64) delta_t tensor(0.1896, dtype=torch.float64)
18 gae_duplicate tensor(-1.4396, dtype=torch.float64) tensor(7.8214, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.1546, dtype=torch.float64) delta_t tensor(0.1036, dtype=torch.float64)
17 gae_duplicate tensor(-1.6931, dtype=torch.float64) tensor(6.5986, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5568, dtype=torch.float64) delta_t tensor(0.4043, dtype=torch.float64)
16 gae_duplicate tensor(-0.6106, dtype=torch.float64) tensor(-0.5847, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3946, dtype=torch.float64) delta_t tensor(0.3739, dtype=torch.float64)
15 gae_duplicate tensor(-0.1337, dtype=torch.float64) tensor(-4.4059, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6809, dtype=torch.float64) delta_t tensor(0.5050, dtype=torch.float64)
14 gae_duplicate tensor(0.4690, dtype=torch.float64) tensor(-9.8061, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6434, dtype=torch.float64) delta_t tensor(0.7421, dtype=torch.float64)
13 gae_duplicate tensor(0.8237, dtype=torch.float64) tensor(-13.3162, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4117, dtype=torch.float64) delta_t tensor(-0.2177, dtype=torch.float64)
12 gae_duplicate tensor(-1.4648, dtype=torch.float64) tensor(-14.4836, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7103, dtype=torch.float64) delta_t tensor(0.5146, dtype=torch.float64)
11 gae_duplicate tensor(-1.0957, dtype=torch.float64) tensor(-12.6378, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4706, dtype=torch.float64) delta_t tensor(0.1760, dtype=torch.float64)
10 gae_duplicate tensor(0.6065, dtype=torch.float64) tensor(-10.4372, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4598, dtype=torch.float64) delta_t tensor(-0.8050, dtype=torch.float64)
9 gae_duplicate tensor(-0.6114, dtype=torch.float64) tensor(-2.6020, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6255, dtype=torch.float64) delta_t tensor(-0.8764, dtype=torch.float64)
8 gae_duplicate tensor(-1.8318, dtype=torch.float64) tensor(4.1411, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0094, dtype=torch.float64) delta_t tensor(-1.0611, dtype=torch.float64)
7 gae_duplicate tensor(-3.4382, dtype=torch.float64) tensor(8.9393, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8719, dtype=torch.float64) delta_t tensor(-0.5815, dtype=torch.float64)
6 gae_duplicate tensor(-3.9559, dtype=torch.float64) tensor(21.7591, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7405, dtype=torch.float64) delta_t tensor(-0.1715, dtype=torch.float64)
5 gae_duplicate tensor(-4.0642, dtype=torch.float64) tensor(21.8088, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2329, dtype=torch.float64) delta_t tensor(-1.9088, dtype=torch.float64)
4 gae_duplicate tensor(-6.9974, dtype=torch.float64) tensor(39.3198, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0262, dtype=torch.float64) delta_t tensor(0.2762, dtype=torch.float64)
3 gae_duplicate tensor(-5.3822, dtype=torch.float64) tensor(24.2441, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1866, dtype=torch.float64) delta_t tensor(-0.0076, dtype=torch.float64)
2 gae_duplicate tensor(-4.5604, dtype=torch.float64) tensor(22.2551, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3606.187744140625
value loss:712.2173461914062
entropies:177.65090942382812
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.712669849395752 seconds
19 rew tensor(0.6415, dtype=torch.float64) delta_t tensor(-0.9256, dtype=torch.float64)
19 gae_duplicate tensor(-1.2849, dtype=torch.float64) tensor(16.0762, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5556, dtype=torch.float64) delta_t tensor(0.1116, dtype=torch.float64)
18 gae_duplicate tensor(-1.4677, dtype=torch.float64) tensor(6.7529, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4008, dtype=torch.float64) delta_t tensor(0.4787, dtype=torch.float64)
17 gae_duplicate tensor(-1.3666, dtype=torch.float64) tensor(2.4714, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4948, dtype=torch.float64) delta_t tensor(0.4621, dtype=torch.float64)
16 gae_duplicate tensor(-0.8758, dtype=torch.float64) tensor(-1.4429, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2629, dtype=torch.float64) delta_t tensor(0.4332, dtype=torch.float64)
15 gae_duplicate tensor(-0.2902, dtype=torch.float64) tensor(-5.9101, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5475, dtype=torch.float64) delta_t tensor(0.4858, dtype=torch.float64)
14 gae_duplicate tensor(0.0612, dtype=torch.float64) tensor(-8.6710, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7026, dtype=torch.float64) delta_t tensor(0.8539, dtype=torch.float64)
13 gae_duplicate tensor(0.4958, dtype=torch.float64) tensor(-18.3387, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5191, dtype=torch.float64) delta_t tensor(0.2976, dtype=torch.float64)
12 gae_duplicate tensor(0.9826, dtype=torch.float64) tensor(-14.9845, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0252, dtype=torch.float64) delta_t tensor(-0.3518, dtype=torch.float64)
11 gae_duplicate tensor(-1.6273, dtype=torch.float64) tensor(-11.8504, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0672, dtype=torch.float64) delta_t tensor(-0.6662, dtype=torch.float64)
10 gae_duplicate tensor(-4.6648, dtype=torch.float64) tensor(-6.8947, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0119, dtype=torch.float64) delta_t tensor(-0.5771, dtype=torch.float64)
9 gae_duplicate tensor(-4.3893, dtype=torch.float64) tensor(6.7051, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2764, dtype=torch.float64) delta_t tensor(-0.2994, dtype=torch.float64)
8 gae_duplicate tensor(-2.0703, dtype=torch.float64) tensor(5.2261, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7579, dtype=torch.float64) delta_t tensor(-0.5466, dtype=torch.float64)
7 gae_duplicate tensor(-2.6366, dtype=torch.float64) tensor(11.3045, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7923, dtype=torch.float64) delta_t tensor(-0.4985, dtype=torch.float64)
6 gae_duplicate tensor(-2.9295, dtype=torch.float64) tensor(16.4604, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1677, dtype=torch.float64) delta_t tensor(-0.7746, dtype=torch.float64)
5 gae_duplicate tensor(-4.8423, dtype=torch.float64) tensor(18.9250, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7506, dtype=torch.float64) delta_t tensor(-2.3897, dtype=torch.float64)
4 gae_duplicate tensor(-7.1037, dtype=torch.float64) tensor(25.6760, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1975, dtype=torch.float64) delta_t tensor(-0.0912, dtype=torch.float64)
3 gae_duplicate tensor(-5.6065, dtype=torch.float64) tensor(43.4794, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1031, dtype=torch.float64) delta_t tensor(-0.0804, dtype=torch.float64)
2 gae_duplicate tensor(-4.6571, dtype=torch.float64) tensor(17.4487, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3719.559814453125
value loss:767.0472412109375
entropies:177.50880432128906
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2308.8503)
ToM Target loss= tensor(1807.5348)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.517959117889404 seconds
19 rew tensor(0.5397, dtype=torch.float64) delta_t tensor(-0.8264, dtype=torch.float64)
19 gae_duplicate tensor(-1.1654, dtype=torch.float64) tensor(8.5120, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3286, dtype=torch.float64) delta_t tensor(0.1399, dtype=torch.float64)
18 gae_duplicate tensor(-1.4347, dtype=torch.float64) tensor(3.3587, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5460, dtype=torch.float64) delta_t tensor(0.2264, dtype=torch.float64)
17 gae_duplicate tensor(-1.1755, dtype=torch.float64) tensor(0.7663, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3564, dtype=torch.float64) delta_t tensor(0.1178, dtype=torch.float64)
16 gae_duplicate tensor(-1.1010, dtype=torch.float64) tensor(4.3430, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4590, dtype=torch.float64) delta_t tensor(0.3659, dtype=torch.float64)
15 gae_duplicate tensor(-0.7024, dtype=torch.float64) tensor(-3.1378, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6820, dtype=torch.float64) delta_t tensor(0.4586, dtype=torch.float64)
14 gae_duplicate tensor(0.0804, dtype=torch.float64) tensor(-5.1303, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7286, dtype=torch.float64) delta_t tensor(0.5516, dtype=torch.float64)
13 gae_duplicate tensor(0.6755, dtype=torch.float64) tensor(-12.7065, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2107, dtype=torch.float64) delta_t tensor(0.1232, dtype=torch.float64)
12 gae_duplicate tensor(-0.5730, dtype=torch.float64) tensor(-11.6562, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6411, dtype=torch.float64) delta_t tensor(-0.8527, dtype=torch.float64)
11 gae_duplicate tensor(-3.6347, dtype=torch.float64) tensor(0.3810, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2341, dtype=torch.float64) delta_t tensor(-0.2707, dtype=torch.float64)
10 gae_duplicate tensor(-5.2880, dtype=torch.float64) tensor(2.9265, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0451, dtype=torch.float64) delta_t tensor(-0.1964, dtype=torch.float64)
9 gae_duplicate tensor(-3.5286, dtype=torch.float64) tensor(3.5779, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4076, dtype=torch.float64) delta_t tensor(-0.4876, dtype=torch.float64)
8 gae_duplicate tensor(-2.4071, dtype=torch.float64) tensor(9.5830, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4257, dtype=torch.float64) delta_t tensor(-0.4164, dtype=torch.float64)
7 gae_duplicate tensor(-2.3256, dtype=torch.float64) tensor(7.5032, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0572, dtype=torch.float64) delta_t tensor(-1.0548, dtype=torch.float64)
6 gae_duplicate tensor(-3.9607, dtype=torch.float64) tensor(25.8243, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8021, dtype=torch.float64) delta_t tensor(-0.4319, dtype=torch.float64)
5 gae_duplicate tensor(-5.2950, dtype=torch.float64) tensor(21.2854, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5239, dtype=torch.float64) delta_t tensor(-1.0935, dtype=torch.float64)
4 gae_duplicate tensor(-7.4821, dtype=torch.float64) tensor(47.3364, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2121, dtype=torch.float64) delta_t tensor(0.0013, dtype=torch.float64)
3 gae_duplicate tensor(-6.1063, dtype=torch.float64) tensor(18.0163, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3474, dtype=torch.float64) delta_t tensor(-0.3638, dtype=torch.float64)
2 gae_duplicate tensor(-5.2211, dtype=torch.float64) tensor(29.2523, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5433.1298828125
value loss:651.3955688476562
entropies:176.95358276367188
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.906970739364624 seconds
19 rew tensor(0.7430, dtype=torch.float64) delta_t tensor(-0.5130, dtype=torch.float64)
19 gae_duplicate tensor(-1.1136, dtype=torch.float64) tensor(7.9315, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7438, dtype=torch.float64) delta_t tensor(0.3079, dtype=torch.float64)
18 gae_duplicate tensor(-0.6078, dtype=torch.float64) tensor(-0.6125, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7274, dtype=torch.float64) delta_t tensor(0.4277, dtype=torch.float64)
17 gae_duplicate tensor(-0.1031, dtype=torch.float64) tensor(-1.7241, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7198, dtype=torch.float64) delta_t tensor(0.4023, dtype=torch.float64)
16 gae_duplicate tensor(0.2839, dtype=torch.float64) tensor(-7.2771, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6962, dtype=torch.float64) delta_t tensor(0.8041, dtype=torch.float64)
15 gae_duplicate tensor(0.4858, dtype=torch.float64) tensor(-14.8833, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6399, dtype=torch.float64) delta_t tensor(0.7569, dtype=torch.float64)
14 gae_duplicate tensor(0.3934, dtype=torch.float64) tensor(-16.9724, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7286, dtype=torch.float64) delta_t tensor(0.4560, dtype=torch.float64)
13 gae_duplicate tensor(0.5910, dtype=torch.float64) tensor(-21.2516, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2876, dtype=torch.float64) delta_t tensor(-0.2951, dtype=torch.float64)
12 gae_duplicate tensor(-1.9237, dtype=torch.float64) tensor(-10.8857, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3419, dtype=torch.float64) delta_t tensor(0.0953, dtype=torch.float64)
11 gae_duplicate tensor(-3.0086, dtype=torch.float64) tensor(-15.7059, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2171, dtype=torch.float64) delta_t tensor(0.1334, dtype=torch.float64)
10 gae_duplicate tensor(-2.5774, dtype=torch.float64) tensor(-3.7764, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1982, dtype=torch.float64) delta_t tensor(-0.0401, dtype=torch.float64)
9 gae_duplicate tensor(-2.7964, dtype=torch.float64) tensor(0.2428, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0711, dtype=torch.float64) delta_t tensor(-0.0373, dtype=torch.float64)
8 gae_duplicate tensor(-1.4095, dtype=torch.float64) tensor(-2.7523, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6370, dtype=torch.float64) delta_t tensor(-0.6261, dtype=torch.float64)
7 gae_duplicate tensor(-1.7658, dtype=torch.float64) tensor(4.3877, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3624, dtype=torch.float64) delta_t tensor(-0.1822, dtype=torch.float64)
6 gae_duplicate tensor(-2.6835, dtype=torch.float64) tensor(4.3001, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9640, dtype=torch.float64) delta_t tensor(-0.5133, dtype=torch.float64)
5 gae_duplicate tensor(-2.6092, dtype=torch.float64) tensor(3.1893, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0692, dtype=torch.float64) delta_t tensor(0.2696, dtype=torch.float64)
4 gae_duplicate tensor(-1.8841, dtype=torch.float64) tensor(6.4562, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7018, dtype=torch.float64) delta_t tensor(-0.2942, dtype=torch.float64)
3 gae_duplicate tensor(-1.7484, dtype=torch.float64) tensor(4.9168, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1393, dtype=torch.float64) delta_t tensor(-0.3878, dtype=torch.float64)
2 gae_duplicate tensor(-1.6161, dtype=torch.float64) tensor(5.7140, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2081.701416015625
value loss:355.4346923828125
entropies:175.53659057617188
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.8624818325042725 seconds
19 rew tensor(0.6170, dtype=torch.float64) delta_t tensor(-0.8144, dtype=torch.float64)
19 gae_duplicate tensor(-1.8333, dtype=torch.float64) tensor(8.2584, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4823, dtype=torch.float64) delta_t tensor(0.4390, dtype=torch.float64)
18 gae_duplicate tensor(-1.9572, dtype=torch.float64) tensor(1.5273, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6904, dtype=torch.float64) delta_t tensor(0.2719, dtype=torch.float64)
17 gae_duplicate tensor(-0.9985, dtype=torch.float64) tensor(-2.8518, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6363, dtype=torch.float64) delta_t tensor(0.3694, dtype=torch.float64)
16 gae_duplicate tensor(-0.3134, dtype=torch.float64) tensor(-5.6482, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5284, dtype=torch.float64) delta_t tensor(0.7211, dtype=torch.float64)
15 gae_duplicate tensor(-0.3220, dtype=torch.float64) tensor(-8.9168, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7077, dtype=torch.float64) delta_t tensor(0.5652, dtype=torch.float64)
14 gae_duplicate tensor(0.3537, dtype=torch.float64) tensor(-14.0527, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6202, dtype=torch.float64) delta_t tensor(0.4041, dtype=torch.float64)
13 gae_duplicate tensor(0.6140, dtype=torch.float64) tensor(-8.5504, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6263, dtype=torch.float64) delta_t tensor(0.5452, dtype=torch.float64)
12 gae_duplicate tensor(0.6745, dtype=torch.float64) tensor(-19.2378, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6261, dtype=torch.float64) delta_t tensor(0.3876, dtype=torch.float64)
11 gae_duplicate tensor(0.8530, dtype=torch.float64) tensor(-20.5604, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0154, dtype=torch.float64) delta_t tensor(-0.2728, dtype=torch.float64)
10 gae_duplicate tensor(-0.9153, dtype=torch.float64) tensor(-14.2533, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7360, dtype=torch.float64) delta_t tensor(-1.0175, dtype=torch.float64)
9 gae_duplicate tensor(-1.6682, dtype=torch.float64) tensor(0.7881, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4994, dtype=torch.float64) delta_t tensor(-0.2951, dtype=torch.float64)
8 gae_duplicate tensor(-1.6109, dtype=torch.float64) tensor(3.9703, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9606, dtype=torch.float64) delta_t tensor(-1.0189, dtype=torch.float64)
7 gae_duplicate tensor(-3.8186, dtype=torch.float64) tensor(19.0632, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5078, dtype=torch.float64) delta_t tensor(-1.3681, dtype=torch.float64)
6 gae_duplicate tensor(-5.5703, dtype=torch.float64) tensor(18.9637, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4466, dtype=torch.float64) delta_t tensor(-1.0611, dtype=torch.float64)
5 gae_duplicate tensor(-5.5654, dtype=torch.float64) tensor(20.1334, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4677, dtype=torch.float64) delta_t tensor(-1.4209, dtype=torch.float64)
4 gae_duplicate tensor(-7.9393, dtype=torch.float64) tensor(36.6940, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2195, dtype=torch.float64) delta_t tensor(0.2133, dtype=torch.float64)
3 gae_duplicate tensor(-5.9124, dtype=torch.float64) tensor(12.5750, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4754, dtype=torch.float64) delta_t tensor(-0.2268, dtype=torch.float64)
2 gae_duplicate tensor(-4.3482, dtype=torch.float64) tensor(26.6506, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1995.087646484375
value loss:877.0045776367188
entropies:173.27877807617188
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.712938070297241 seconds
19 rew tensor(0.6888, dtype=torch.float64) delta_t tensor(-0.5073, dtype=torch.float64)
19 gae_duplicate tensor(-1.1996, dtype=torch.float64) tensor(3.5032, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6485, dtype=torch.float64) delta_t tensor(0.4093, dtype=torch.float64)
18 gae_duplicate tensor(-0.9996, dtype=torch.float64) tensor(-1.3549, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5121, dtype=torch.float64) delta_t tensor(0.6174, dtype=torch.float64)
17 gae_duplicate tensor(-0.7353, dtype=torch.float64) tensor(-3.6979, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3041, dtype=torch.float64) delta_t tensor(0.2909, dtype=torch.float64)
16 gae_duplicate tensor(-0.9421, dtype=torch.float64) tensor(-8.6417, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6593, dtype=torch.float64) delta_t tensor(0.7352, dtype=torch.float64)
15 gae_duplicate tensor(-0.2367, dtype=torch.float64) tensor(-14.1507, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5365, dtype=torch.float64) delta_t tensor(0.4712, dtype=torch.float64)
14 gae_duplicate tensor(0.6915, dtype=torch.float64) tensor(-12.3316, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5479, dtype=torch.float64) delta_t tensor(0.3151, dtype=torch.float64)
13 gae_duplicate tensor(1.0901, dtype=torch.float64) tensor(-18.7967, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2692, dtype=torch.float64) delta_t tensor(0.2625, dtype=torch.float64)
12 gae_duplicate tensor(0.8897, dtype=torch.float64) tensor(-11.5061, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1354, dtype=torch.float64) delta_t tensor(-0.5636, dtype=torch.float64)
11 gae_duplicate tensor(-1.0941, dtype=torch.float64) tensor(-4.4613, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1317, dtype=torch.float64) delta_t tensor(-0.1681, dtype=torch.float64)
10 gae_duplicate tensor(-1.3591, dtype=torch.float64) tensor(-2.2418, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3532, dtype=torch.float64) delta_t tensor(-0.5279, dtype=torch.float64)
9 gae_duplicate tensor(-1.3866, dtype=torch.float64) tensor(1.2250, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0050, dtype=torch.float64) delta_t tensor(0.2077, dtype=torch.float64)
8 gae_duplicate tensor(-0.4728, dtype=torch.float64) tensor(0.2742, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1322, dtype=torch.float64) delta_t tensor(0.1514, dtype=torch.float64)
7 gae_duplicate tensor(-0.3456, dtype=torch.float64) tensor(-0.2952, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1871, dtype=torch.float64) delta_t tensor(0.1824, dtype=torch.float64)
6 gae_duplicate tensor(-0.4894, dtype=torch.float64) tensor(-3.4168, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5059, dtype=torch.float64) delta_t tensor(-0.3416, dtype=torch.float64)
5 gae_duplicate tensor(-0.7179, dtype=torch.float64) tensor(3.0194, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1664, dtype=torch.float64) delta_t tensor(0.1743, dtype=torch.float64)
4 gae_duplicate tensor(-0.8098, dtype=torch.float64) tensor(-0.3608, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9171, dtype=torch.float64) delta_t tensor(-0.8541, dtype=torch.float64)
3 gae_duplicate tensor(-1.6419, dtype=torch.float64) tensor(9.3493, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1251, dtype=torch.float64) delta_t tensor(-0.3206, dtype=torch.float64)
2 gae_duplicate tensor(-1.8903, dtype=torch.float64) tensor(6.1691, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2046.5653076171875
value loss:202.20962524414062
entropies:173.26898193359375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.891201019287109 seconds
19 rew tensor(0.5960, dtype=torch.float64) delta_t tensor(-0.8559, dtype=torch.float64)
19 gae_duplicate tensor(-1.3185, dtype=torch.float64) tensor(9.0543, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4398, dtype=torch.float64) delta_t tensor(0.1507, dtype=torch.float64)
18 gae_duplicate tensor(-1.5988, dtype=torch.float64) tensor(1.9341, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.1582, dtype=torch.float64) delta_t tensor(0.1536, dtype=torch.float64)
17 gae_duplicate tensor(-2.0621, dtype=torch.float64) tensor(4.9968, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6524, dtype=torch.float64) delta_t tensor(0.4618, dtype=torch.float64)
16 gae_duplicate tensor(-1.0717, dtype=torch.float64) tensor(-7.0741, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5681, dtype=torch.float64) delta_t tensor(0.3733, dtype=torch.float64)
15 gae_duplicate tensor(-0.3833, dtype=torch.float64) tensor(-3.8311, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7449, dtype=torch.float64) delta_t tensor(0.7561, dtype=torch.float64)
14 gae_duplicate tensor(0.2399, dtype=torch.float64) tensor(-6.7459, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7451, dtype=torch.float64) delta_t tensor(0.5623, dtype=torch.float64)
13 gae_duplicate tensor(0.7179, dtype=torch.float64) tensor(-12.2748, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7453, dtype=torch.float64) delta_t tensor(0.0609, dtype=torch.float64)
12 gae_duplicate tensor(0.3124, dtype=torch.float64) tensor(-15.9210, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1181, dtype=torch.float64) delta_t tensor(0.0842, dtype=torch.float64)
11 gae_duplicate tensor(-2.8740, dtype=torch.float64) tensor(-16.3955, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5556, dtype=torch.float64) delta_t tensor(0.1216, dtype=torch.float64)
10 gae_duplicate tensor(-1.3864, dtype=torch.float64) tensor(-6.7338, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1156, dtype=torch.float64) delta_t tensor(-0.4131, dtype=torch.float64)
9 gae_duplicate tensor(-0.7969, dtype=torch.float64) tensor(-7.4802, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2632, dtype=torch.float64) delta_t tensor(-1.5439, dtype=torch.float64)
8 gae_duplicate tensor(-2.5877, dtype=torch.float64) tensor(10.4935, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2202, dtype=torch.float64) delta_t tensor(-1.0982, dtype=torch.float64)
7 gae_duplicate tensor(-4.1040, dtype=torch.float64) tensor(13.9812, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0404, dtype=torch.float64) delta_t tensor(-0.8879, dtype=torch.float64)
6 gae_duplicate tensor(-4.6398, dtype=torch.float64) tensor(25.1775, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5368, dtype=torch.float64) delta_t tensor(-1.1821, dtype=torch.float64)
5 gae_duplicate tensor(-5.5176, dtype=torch.float64) tensor(45.7734, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6131, dtype=torch.float64) delta_t tensor(-1.3939, dtype=torch.float64)
4 gae_duplicate tensor(-8.4564, dtype=torch.float64) tensor(35.9232, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2860, dtype=torch.float64) delta_t tensor(0.3799, dtype=torch.float64)
3 gae_duplicate tensor(-6.2745, dtype=torch.float64) tensor(26.0064, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0955, dtype=torch.float64) delta_t tensor(-0.0715, dtype=torch.float64)
2 gae_duplicate tensor(-4.7175, dtype=torch.float64) tensor(31.7107, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4660.2216796875
value loss:924.529052734375
entropies:171.17984008789062
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2325.2222)
ToM Target loss= tensor(1813.5498)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.728882789611816 seconds
19 rew tensor(0.7129, dtype=torch.float64) delta_t tensor(-0.6040, dtype=torch.float64)
19 gae_duplicate tensor(-1.1967, dtype=torch.float64) tensor(4.4715, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7041, dtype=torch.float64) delta_t tensor(0.3270, dtype=torch.float64)
18 gae_duplicate tensor(-0.7126, dtype=torch.float64) tensor(1.4026, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6481, dtype=torch.float64) delta_t tensor(0.4301, dtype=torch.float64)
17 gae_duplicate tensor(-0.3226, dtype=torch.float64) tensor(-2.3747, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5590, dtype=torch.float64) delta_t tensor(0.3388, dtype=torch.float64)
16 gae_duplicate tensor(-0.3449, dtype=torch.float64) tensor(-5.4815, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3646, dtype=torch.float64) delta_t tensor(0.4363, dtype=torch.float64)
15 gae_duplicate tensor(-0.0876, dtype=torch.float64) tensor(-7.8932, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4730, dtype=torch.float64) delta_t tensor(0.6314, dtype=torch.float64)
14 gae_duplicate tensor(0.3599, dtype=torch.float64) tensor(-15.0622, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6041, dtype=torch.float64) delta_t tensor(0.5348, dtype=torch.float64)
13 gae_duplicate tensor(0.3551, dtype=torch.float64) tensor(-9.4376, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4774, dtype=torch.float64) delta_t tensor(0.1975, dtype=torch.float64)
12 gae_duplicate tensor(0.5963, dtype=torch.float64) tensor(-18.0676, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4699, dtype=torch.float64) delta_t tensor(0.2350, dtype=torch.float64)
11 gae_duplicate tensor(0.3496, dtype=torch.float64) tensor(-10.8714, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5286, dtype=torch.float64) delta_t tensor(0.0492, dtype=torch.float64)
10 gae_duplicate tensor(-0.1541, dtype=torch.float64) tensor(-7.5117, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2418, dtype=torch.float64) delta_t tensor(-0.5190, dtype=torch.float64)
9 gae_duplicate tensor(-1.2594, dtype=torch.float64) tensor(-6.3792, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5657, dtype=torch.float64) delta_t tensor(-0.7186, dtype=torch.float64)
8 gae_duplicate tensor(-2.5810, dtype=torch.float64) tensor(4.2157, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3247, dtype=torch.float64) delta_t tensor(-0.3306, dtype=torch.float64)
7 gae_duplicate tensor(-2.9124, dtype=torch.float64) tensor(1.5285, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7335, dtype=torch.float64) delta_t tensor(-0.5289, dtype=torch.float64)
6 gae_duplicate tensor(-3.7849, dtype=torch.float64) tensor(3.5047, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0703, dtype=torch.float64) delta_t tensor(-0.8682, dtype=torch.float64)
5 gae_duplicate tensor(-4.6222, dtype=torch.float64) tensor(22.2612, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7742, dtype=torch.float64) delta_t tensor(-0.3792, dtype=torch.float64)
4 gae_duplicate tensor(-6.4950, dtype=torch.float64) tensor(36.5393, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1645, dtype=torch.float64) delta_t tensor(0.1887, dtype=torch.float64)
3 gae_duplicate tensor(-4.7470, dtype=torch.float64) tensor(8.2846, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5219, dtype=torch.float64) delta_t tensor(-0.4078, dtype=torch.float64)
2 gae_duplicate tensor(-3.6256, dtype=torch.float64) tensor(23.3239, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-838.8388671875
value loss:454.2644348144531
entropies:169.65142822265625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.0696141719818115 seconds
19 rew tensor(0.7058, dtype=torch.float64) delta_t tensor(-0.4089, dtype=torch.float64)
19 gae_duplicate tensor(-1.1407, dtype=torch.float64) tensor(1.7084, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6516, dtype=torch.float64) delta_t tensor(0.3332, dtype=torch.float64)
18 gae_duplicate tensor(-1.0238, dtype=torch.float64) tensor(-3.6584, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5725, dtype=torch.float64) delta_t tensor(0.3384, dtype=torch.float64)
17 gae_duplicate tensor(-0.9644, dtype=torch.float64) tensor(-2.4892, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3924, dtype=torch.float64) delta_t tensor(0.3146, dtype=torch.float64)
16 gae_duplicate tensor(-0.9716, dtype=torch.float64) tensor(0.9312, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3977, dtype=torch.float64) delta_t tensor(0.2630, dtype=torch.float64)
15 gae_duplicate tensor(-1.1430, dtype=torch.float64) tensor(-7.2280, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5893, dtype=torch.float64) delta_t tensor(0.5318, dtype=torch.float64)
14 gae_duplicate tensor(-0.5294, dtype=torch.float64) tensor(-3.8260, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5434, dtype=torch.float64) delta_t tensor(0.3510, dtype=torch.float64)
13 gae_duplicate tensor(0.0316, dtype=torch.float64) tensor(-9.2314, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5511, dtype=torch.float64) delta_t tensor(0.6115, dtype=torch.float64)
12 gae_duplicate tensor(0.4807, dtype=torch.float64) tensor(-9.4039, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5680, dtype=torch.float64) delta_t tensor(0.1080, dtype=torch.float64)
11 gae_duplicate tensor(0.1774, dtype=torch.float64) tensor(-19.7774, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3697, dtype=torch.float64) delta_t tensor(0.1957, dtype=torch.float64)
10 gae_duplicate tensor(-0.8158, dtype=torch.float64) tensor(-11.0301, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7776, dtype=torch.float64) delta_t tensor(-1.0775, dtype=torch.float64)
9 gae_duplicate tensor(-1.5325, dtype=torch.float64) tensor(-4.8121, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6859, dtype=torch.float64) delta_t tensor(-0.5663, dtype=torch.float64)
8 gae_duplicate tensor(-2.6099, dtype=torch.float64) tensor(2.4972, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3358, dtype=torch.float64) delta_t tensor(-0.4100, dtype=torch.float64)
7 gae_duplicate tensor(-3.6009, dtype=torch.float64) tensor(6.5098, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7278, dtype=torch.float64) delta_t tensor(-0.7378, dtype=torch.float64)
6 gae_duplicate tensor(-4.4939, dtype=torch.float64) tensor(11.9102, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7643, dtype=torch.float64) delta_t tensor(-1.3318, dtype=torch.float64)
5 gae_duplicate tensor(-5.2972, dtype=torch.float64) tensor(19.1782, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4574, dtype=torch.float64) delta_t tensor(-1.1736, dtype=torch.float64)
4 gae_duplicate tensor(-8.7795, dtype=torch.float64) tensor(13.6198, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1123, dtype=torch.float64) delta_t tensor(0.3078, dtype=torch.float64)
3 gae_duplicate tensor(-6.1563, dtype=torch.float64) tensor(8.3452, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1115, dtype=torch.float64) delta_t tensor(-0.1746, dtype=torch.float64)
2 gae_duplicate tensor(-4.6254, dtype=torch.float64) tensor(23.4080, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-629.3727416992188
value loss:743.664794921875
entropies:166.2069549560547
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.7178871631622314 seconds
19 rew tensor(0.7150, dtype=torch.float64) delta_t tensor(-0.6562, dtype=torch.float64)
19 gae_duplicate tensor(-1.0797, dtype=torch.float64) tensor(6.2205, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6916, dtype=torch.float64) delta_t tensor(0.5882, dtype=torch.float64)
18 gae_duplicate tensor(-0.5527, dtype=torch.float64) tensor(1.3286, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6139, dtype=torch.float64) delta_t tensor(0.6113, dtype=torch.float64)
17 gae_duplicate tensor(-0.4289, dtype=torch.float64) tensor(-6.3144, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5055, dtype=torch.float64) delta_t tensor(0.4404, dtype=torch.float64)
16 gae_duplicate tensor(-0.0826, dtype=torch.float64) tensor(-15.0498, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5949, dtype=torch.float64) delta_t tensor(0.6745, dtype=torch.float64)
15 gae_duplicate tensor(-0.0889, dtype=torch.float64) tensor(-10.0488, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7541, dtype=torch.float64) delta_t tensor(0.6915, dtype=torch.float64)
14 gae_duplicate tensor(0.4620, dtype=torch.float64) tensor(-10.7508, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7085, dtype=torch.float64) delta_t tensor(0.3482, dtype=torch.float64)
13 gae_duplicate tensor(0.8324, dtype=torch.float64) tensor(-7.6438, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2189, dtype=torch.float64) delta_t tensor(0.0713, dtype=torch.float64)
12 gae_duplicate tensor(-0.7391, dtype=torch.float64) tensor(-8.0923, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1656, dtype=torch.float64) delta_t tensor(-0.5019, dtype=torch.float64)
11 gae_duplicate tensor(-1.9701, dtype=torch.float64) tensor(-2.2251, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3790, dtype=torch.float64) delta_t tensor(-0.0460, dtype=torch.float64)
10 gae_duplicate tensor(-2.5189, dtype=torch.float64) tensor(-5.2639, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2612, dtype=torch.float64) delta_t tensor(-0.1196, dtype=torch.float64)
9 gae_duplicate tensor(-2.2897, dtype=torch.float64) tensor(1.2857, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4498, dtype=torch.float64) delta_t tensor(-0.3294, dtype=torch.float64)
8 gae_duplicate tensor(-1.7790, dtype=torch.float64) tensor(-0.8509, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1939, dtype=torch.float64) delta_t tensor(-0.0107, dtype=torch.float64)
7 gae_duplicate tensor(-2.0004, dtype=torch.float64) tensor(1.8214, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8119, dtype=torch.float64) delta_t tensor(-0.4764, dtype=torch.float64)
6 gae_duplicate tensor(-2.8459, dtype=torch.float64) tensor(10.3357, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7588, dtype=torch.float64) delta_t tensor(-0.6936, dtype=torch.float64)
5 gae_duplicate tensor(-3.7542, dtype=torch.float64) tensor(15.1238, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5524, dtype=torch.float64) delta_t tensor(-1.3202, dtype=torch.float64)
4 gae_duplicate tensor(-6.3904, dtype=torch.float64) tensor(19.4090, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0735, dtype=torch.float64) delta_t tensor(0.3640, dtype=torch.float64)
3 gae_duplicate tensor(-4.6240, dtype=torch.float64) tensor(16.0882, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4751, dtype=torch.float64) delta_t tensor(-0.1015, dtype=torch.float64)
2 gae_duplicate tensor(-3.8010, dtype=torch.float64) tensor(9.0499, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-548.88525390625
value loss:505.12762451171875
entropies:164.73916625976562
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.855618000030518 seconds
19 rew tensor(0.5821, dtype=torch.float64) delta_t tensor(-0.5421, dtype=torch.float64)
19 gae_duplicate tensor(-1.7442, dtype=torch.float64) tensor(8.4264, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4253, dtype=torch.float64) delta_t tensor(0.1824, dtype=torch.float64)
18 gae_duplicate tensor(-1.7418, dtype=torch.float64) tensor(1.8970, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5802, dtype=torch.float64) delta_t tensor(0.3536, dtype=torch.float64)
17 gae_duplicate tensor(-1.2717, dtype=torch.float64) tensor(-3.5644, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3826, dtype=torch.float64) delta_t tensor(0.3766, dtype=torch.float64)
16 gae_duplicate tensor(-1.3978, dtype=torch.float64) tensor(-3.7500, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5493, dtype=torch.float64) delta_t tensor(0.3187, dtype=torch.float64)
15 gae_duplicate tensor(-0.5236, dtype=torch.float64) tensor(-2.8739, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6716, dtype=torch.float64) delta_t tensor(0.7192, dtype=torch.float64)
14 gae_duplicate tensor(0.1760, dtype=torch.float64) tensor(-12.3425, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4900, dtype=torch.float64) delta_t tensor(0.1074, dtype=torch.float64)
13 gae_duplicate tensor(0.3437, dtype=torch.float64) tensor(-10.4534, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4880, dtype=torch.float64) delta_t tensor(-0.2710, dtype=torch.float64)
12 gae_duplicate tensor(-2.4117, dtype=torch.float64) tensor(-6.8750, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1677, dtype=torch.float64) delta_t tensor(-0.3421, dtype=torch.float64)
11 gae_duplicate tensor(-3.4070, dtype=torch.float64) tensor(-10.2876, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3993, dtype=torch.float64) delta_t tensor(-0.0522, dtype=torch.float64)
10 gae_duplicate tensor(-2.3217, dtype=torch.float64) tensor(-3.1338, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0430, dtype=torch.float64) delta_t tensor(0.1086, dtype=torch.float64)
9 gae_duplicate tensor(-1.2664, dtype=torch.float64) tensor(-2.9244, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5136, dtype=torch.float64) delta_t tensor(-0.5905, dtype=torch.float64)
8 gae_duplicate tensor(-1.4727, dtype=torch.float64) tensor(6.0926, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5925, dtype=torch.float64) delta_t tensor(-0.8205, dtype=torch.float64)
7 gae_duplicate tensor(-3.0962, dtype=torch.float64) tensor(10.3467, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6353, dtype=torch.float64) delta_t tensor(-0.1773, dtype=torch.float64)
6 gae_duplicate tensor(-3.9083, dtype=torch.float64) tensor(4.3425, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0993, dtype=torch.float64) delta_t tensor(-0.9080, dtype=torch.float64)
5 gae_duplicate tensor(-5.5463, dtype=torch.float64) tensor(21.8314, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0726, dtype=torch.float64) delta_t tensor(0.2565, dtype=torch.float64)
4 gae_duplicate tensor(-5.7599, dtype=torch.float64) tensor(8.8722, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4126, dtype=torch.float64) delta_t tensor(-0.1370, dtype=torch.float64)
3 gae_duplicate tensor(-4.4481, dtype=torch.float64) tensor(10.9581, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3277, dtype=torch.float64) delta_t tensor(-0.1570, dtype=torch.float64)
2 gae_duplicate tensor(-3.3117, dtype=torch.float64) tensor(7.2180, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-885.44091796875
value loss:478.572265625
entropies:163.14939880371094
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.877341985702515 seconds
19 rew tensor(0.6648, dtype=torch.float64) delta_t tensor(-0.8597, dtype=torch.float64)
19 gae_duplicate tensor(-1.3572, dtype=torch.float64) tensor(10.5882, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5991, dtype=torch.float64) delta_t tensor(0.3530, dtype=torch.float64)
18 gae_duplicate tensor(-1.0743, dtype=torch.float64) tensor(1.9384, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4598, dtype=torch.float64) delta_t tensor(0.5161, dtype=torch.float64)
17 gae_duplicate tensor(-1.0876, dtype=torch.float64) tensor(-0.8135, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5901, dtype=torch.float64) delta_t tensor(0.2337, dtype=torch.float64)
16 gae_duplicate tensor(-0.2724, dtype=torch.float64) tensor(-6.1060, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4567, dtype=torch.float64) delta_t tensor(0.4798, dtype=torch.float64)
15 gae_duplicate tensor(0.0884, dtype=torch.float64) tensor(-4.8107, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6629, dtype=torch.float64) delta_t tensor(0.5447, dtype=torch.float64)
14 gae_duplicate tensor(0.6956, dtype=torch.float64) tensor(-7.2565, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2361, dtype=torch.float64) delta_t tensor(0.0915, dtype=torch.float64)
13 gae_duplicate tensor(-0.7901, dtype=torch.float64) tensor(-11.1865, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0656, dtype=torch.float64) delta_t tensor(0.1411, dtype=torch.float64)
12 gae_duplicate tensor(-0.7456, dtype=torch.float64) tensor(-2.8768, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4958, dtype=torch.float64) delta_t tensor(0.2874, dtype=torch.float64)
11 gae_duplicate tensor(-0.5458, dtype=torch.float64) tensor(-2.9556, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2532, dtype=torch.float64) delta_t tensor(-0.0772, dtype=torch.float64)
10 gae_duplicate tensor(-0.4116, dtype=torch.float64) tensor(-5.9602, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9011, dtype=torch.float64) delta_t tensor(-1.0553, dtype=torch.float64)
9 gae_duplicate tensor(-1.3083, dtype=torch.float64) tensor(4.1096, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2678, dtype=torch.float64) delta_t tensor(-0.3508, dtype=torch.float64)
8 gae_duplicate tensor(-2.6194, dtype=torch.float64) tensor(3.2379, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4751, dtype=torch.float64) delta_t tensor(-0.3957, dtype=torch.float64)
7 gae_duplicate tensor(-4.0315, dtype=torch.float64) tensor(11.1853, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1862, dtype=torch.float64) delta_t tensor(0.0735, dtype=torch.float64)
6 gae_duplicate tensor(-3.8273, dtype=torch.float64) tensor(6.5408, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8573, dtype=torch.float64) delta_t tensor(-0.4933, dtype=torch.float64)
5 gae_duplicate tensor(-4.6069, dtype=torch.float64) tensor(10.7117, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7343, dtype=torch.float64) delta_t tensor(-0.5934, dtype=torch.float64)
4 gae_duplicate tensor(-5.8211, dtype=torch.float64) tensor(17.8027, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4483, dtype=torch.float64) delta_t tensor(0.1215, dtype=torch.float64)
3 gae_duplicate tensor(-5.0609, dtype=torch.float64) tensor(6.3335, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2295, dtype=torch.float64) delta_t tensor(-0.2353, dtype=torch.float64)
2 gae_duplicate tensor(-3.3519, dtype=torch.float64) tensor(8.9294, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1447.7801513671875
value loss:382.7237548828125
entropies:160.9072265625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2228.6494)
ToM Target loss= tensor(1814.3014)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.734010934829712 seconds
19 rew tensor(0.6777, dtype=torch.float64) delta_t tensor(-0.5441, dtype=torch.float64)
19 gae_duplicate tensor(-0.9577, dtype=torch.float64) tensor(5.6472, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5857, dtype=torch.float64) delta_t tensor(0.3673, dtype=torch.float64)
18 gae_duplicate tensor(-0.5774, dtype=torch.float64) tensor(1.0772, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4227, dtype=torch.float64) delta_t tensor(0.2772, dtype=torch.float64)
17 gae_duplicate tensor(-0.3674, dtype=torch.float64) tensor(-2.6665, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5846, dtype=torch.float64) delta_t tensor(0.4436, dtype=torch.float64)
16 gae_duplicate tensor(0.0192, dtype=torch.float64) tensor(-7.6778, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4444, dtype=torch.float64) delta_t tensor(0.3275, dtype=torch.float64)
15 gae_duplicate tensor(-0.0697, dtype=torch.float64) tensor(-7.2197, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4866, dtype=torch.float64) delta_t tensor(0.5718, dtype=torch.float64)
14 gae_duplicate tensor(-0.2889, dtype=torch.float64) tensor(-6.8206, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1151, dtype=torch.float64) delta_t tensor(-0.0321, dtype=torch.float64)
13 gae_duplicate tensor(-0.4385, dtype=torch.float64) tensor(-5.4696, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0406, dtype=torch.float64) delta_t tensor(-0.3661, dtype=torch.float64)
12 gae_duplicate tensor(-3.3001, dtype=torch.float64) tensor(-0.5122, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5329, dtype=torch.float64) delta_t tensor(0.3232, dtype=torch.float64)
11 gae_duplicate tensor(-2.5286, dtype=torch.float64) tensor(-3.2489, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5761, dtype=torch.float64) delta_t tensor(0.4285, dtype=torch.float64)
10 gae_duplicate tensor(-1.7405, dtype=torch.float64) tensor(-10.8755, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0310, dtype=torch.float64) delta_t tensor(-0.0460, dtype=torch.float64)
9 gae_duplicate tensor(-0.5495, dtype=torch.float64) tensor(-10.2279, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4116, dtype=torch.float64) delta_t tensor(-0.4868, dtype=torch.float64)
8 gae_duplicate tensor(-1.8469, dtype=torch.float64) tensor(2.0541, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3610, dtype=torch.float64) delta_t tensor(-0.3533, dtype=torch.float64)
7 gae_duplicate tensor(-3.1339, dtype=torch.float64) tensor(-0.5170, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6116, dtype=torch.float64) delta_t tensor(-0.1674, dtype=torch.float64)
6 gae_duplicate tensor(-4.2043, dtype=torch.float64) tensor(1.3583, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0265, dtype=torch.float64) delta_t tensor(-1.0011, dtype=torch.float64)
5 gae_duplicate tensor(-5.5079, dtype=torch.float64) tensor(11.3090, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8182, dtype=torch.float64) delta_t tensor(-1.5315, dtype=torch.float64)
4 gae_duplicate tensor(-8.9116, dtype=torch.float64) tensor(39.4777, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4126, dtype=torch.float64) delta_t tensor(0.0819, dtype=torch.float64)
3 gae_duplicate tensor(-5.9058, dtype=torch.float64) tensor(20.3245, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1765, dtype=torch.float64) delta_t tensor(-0.1184, dtype=torch.float64)
2 gae_duplicate tensor(-4.6137, dtype=torch.float64) tensor(12.1108, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1401.0533447265625
value loss:699.438232421875
entropies:159.01348876953125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.001575231552124 seconds
19 rew tensor(0.4849, dtype=torch.float64) delta_t tensor(-0.7661, dtype=torch.float64)
19 gae_duplicate tensor(-1.6281, dtype=torch.float64) tensor(7.5151, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7323, dtype=torch.float64) delta_t tensor(0.4138, dtype=torch.float64)
18 gae_duplicate tensor(-0.7112, dtype=torch.float64) tensor(1.2426, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7245, dtype=torch.float64) delta_t tensor(0.4809, dtype=torch.float64)
17 gae_duplicate tensor(-0.0508, dtype=torch.float64) tensor(-3.5820, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7018, dtype=torch.float64) delta_t tensor(0.6779, dtype=torch.float64)
16 gae_duplicate tensor(0.2385, dtype=torch.float64) tensor(-8.4872, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6399, dtype=torch.float64) delta_t tensor(0.5700, dtype=torch.float64)
15 gae_duplicate tensor(-0.1041, dtype=torch.float64) tensor(-14.2969, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5316, dtype=torch.float64) delta_t tensor(0.4316, dtype=torch.float64)
14 gae_duplicate tensor(-0.3395, dtype=torch.float64) tensor(-9.8435, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6574, dtype=torch.float64) delta_t tensor(0.4052, dtype=torch.float64)
13 gae_duplicate tensor(0.2740, dtype=torch.float64) tensor(-20.8512, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5389, dtype=torch.float64) delta_t tensor(0.4571, dtype=torch.float64)
12 gae_duplicate tensor(0.7649, dtype=torch.float64) tensor(-14.4891, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0037, dtype=torch.float64) delta_t tensor(-0.1274, dtype=torch.float64)
11 gae_duplicate tensor(-0.8891, dtype=torch.float64) tensor(-9.7912, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0845, dtype=torch.float64) delta_t tensor(-0.3112, dtype=torch.float64)
10 gae_duplicate tensor(-1.5811, dtype=torch.float64) tensor(-0.3665, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1470, dtype=torch.float64) delta_t tensor(-0.5215, dtype=torch.float64)
9 gae_duplicate tensor(-1.9408, dtype=torch.float64) tensor(2.1141, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1510, dtype=torch.float64) delta_t tensor(-0.0633, dtype=torch.float64)
8 gae_duplicate tensor(-1.4734, dtype=torch.float64) tensor(6.6660, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7094, dtype=torch.float64) delta_t tensor(-0.5849, dtype=torch.float64)
7 gae_duplicate tensor(-1.7610, dtype=torch.float64) tensor(6.5479, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2536, dtype=torch.float64) delta_t tensor(0.0003, dtype=torch.float64)
6 gae_duplicate tensor(-1.7861, dtype=torch.float64) tensor(6.6769, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0957, dtype=torch.float64) delta_t tensor(-0.8851, dtype=torch.float64)
5 gae_duplicate tensor(-2.9224, dtype=torch.float64) tensor(6.5084, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5668, dtype=torch.float64) delta_t tensor(-1.1789, dtype=torch.float64)
4 gae_duplicate tensor(-7.5307, dtype=torch.float64) tensor(8.3430, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1936, dtype=torch.float64) delta_t tensor(0.1354, dtype=torch.float64)
3 gae_duplicate tensor(-5.6447, dtype=torch.float64) tensor(12.4491, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3273, dtype=torch.float64) delta_t tensor(-0.0854, dtype=torch.float64)
2 gae_duplicate tensor(-4.0973, dtype=torch.float64) tensor(10.0543, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:460.9596252441406
value loss:541.02783203125
entropies:157.1260223388672
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.608436107635498 seconds
19 rew tensor(0.7399, dtype=torch.float64) delta_t tensor(-0.6904, dtype=torch.float64)
19 gae_duplicate tensor(-0.8433, dtype=torch.float64) tensor(5.6913, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7246, dtype=torch.float64) delta_t tensor(0.4491, dtype=torch.float64)
18 gae_duplicate tensor(-0.3728, dtype=torch.float64) tensor(-0.2307, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7093, dtype=torch.float64) delta_t tensor(0.5496, dtype=torch.float64)
17 gae_duplicate tensor(-0.1646, dtype=torch.float64) tensor(-2.3604, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6553, dtype=torch.float64) delta_t tensor(0.5110, dtype=torch.float64)
16 gae_duplicate tensor(-0.1330, dtype=torch.float64) tensor(-4.0065, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5703, dtype=torch.float64) delta_t tensor(0.9004, dtype=torch.float64)
15 gae_duplicate tensor(-0.2638, dtype=torch.float64) tensor(-11.0949, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7562, dtype=torch.float64) delta_t tensor(0.4732, dtype=torch.float64)
14 gae_duplicate tensor(0.1533, dtype=torch.float64) tensor(-16.1133, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7486, dtype=torch.float64) delta_t tensor(0.5123, dtype=torch.float64)
13 gae_duplicate tensor(0.5891, dtype=torch.float64) tensor(-16.1217, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7565, dtype=torch.float64) delta_t tensor(0.4506, dtype=torch.float64)
12 gae_duplicate tensor(1.0052, dtype=torch.float64) tensor(-13.7244, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0902, dtype=torch.float64) delta_t tensor(-0.2938, dtype=torch.float64)
11 gae_duplicate tensor(-0.5184, dtype=torch.float64) tensor(-5.8672, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2812, dtype=torch.float64) delta_t tensor(-0.6114, dtype=torch.float64)
10 gae_duplicate tensor(-0.9341, dtype=torch.float64) tensor(-3.5747, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5139, dtype=torch.float64) delta_t tensor(-0.7772, dtype=torch.float64)
9 gae_duplicate tensor(-6.2117, dtype=torch.float64) tensor(5.9047, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1492, dtype=torch.float64) delta_t tensor(0.4253, dtype=torch.float64)
8 gae_duplicate tensor(-3.5964, dtype=torch.float64) tensor(3.0013, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2097, dtype=torch.float64) delta_t tensor(-0.0318, dtype=torch.float64)
7 gae_duplicate tensor(-2.5178, dtype=torch.float64) tensor(-2.0247, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2266, dtype=torch.float64) delta_t tensor(-0.0607, dtype=torch.float64)
6 gae_duplicate tensor(-1.7490, dtype=torch.float64) tensor(-3.7390, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7274, dtype=torch.float64) delta_t tensor(-0.4707, dtype=torch.float64)
5 gae_duplicate tensor(-1.8322, dtype=torch.float64) tensor(2.3712, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0823, dtype=torch.float64) delta_t tensor(0.2539, dtype=torch.float64)
4 gae_duplicate tensor(-1.1641, dtype=torch.float64) tensor(1.8444, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3993, dtype=torch.float64) delta_t tensor(-0.2069, dtype=torch.float64)
3 gae_duplicate tensor(-1.0778, dtype=torch.float64) tensor(1.7620, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5273, dtype=torch.float64) delta_t tensor(-0.2940, dtype=torch.float64)
2 gae_duplicate tensor(-1.4381, dtype=torch.float64) tensor(2.9492, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1964.0025634765625
value loss:330.17236328125
entropies:155.5498046875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.07447075843811 seconds
19 rew tensor(0.7554, dtype=torch.float64) delta_t tensor(-0.4973, dtype=torch.float64)
19 gae_duplicate tensor(-0.9378, dtype=torch.float64) tensor(4.3275, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7556, dtype=torch.float64) delta_t tensor(0.6606, dtype=torch.float64)
18 gae_duplicate tensor(-0.2705, dtype=torch.float64) tensor(-0.3201, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7557, dtype=torch.float64) delta_t tensor(0.7110, dtype=torch.float64)
17 gae_duplicate tensor(0.2830, dtype=torch.float64) tensor(-5.5023, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7559, dtype=torch.float64) delta_t tensor(0.7166, dtype=torch.float64)
16 gae_duplicate tensor(0.6252, dtype=torch.float64) tensor(-14.6132, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7561, dtype=torch.float64) delta_t tensor(0.5386, dtype=torch.float64)
15 gae_duplicate tensor(0.9653, dtype=torch.float64) tensor(-14.7846, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7563, dtype=torch.float64) delta_t tensor(0.5894, dtype=torch.float64)
14 gae_duplicate tensor(1.2298, dtype=torch.float64) tensor(-23.4291, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7565, dtype=torch.float64) delta_t tensor(0.3955, dtype=torch.float64)
13 gae_duplicate tensor(1.4312, dtype=torch.float64) tensor(-10.6527, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4137, dtype=torch.float64) delta_t tensor(0.0177, dtype=torch.float64)
12 gae_duplicate tensor(0.0025, dtype=torch.float64) tensor(-11.2485, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1043, dtype=torch.float64) delta_t tensor(-0.1540, dtype=torch.float64)
11 gae_duplicate tensor(-2.4677, dtype=torch.float64) tensor(-9.4822, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1858, dtype=torch.float64) delta_t tensor(-0.2667, dtype=torch.float64)
10 gae_duplicate tensor(-1.5883, dtype=torch.float64) tensor(-2.9188, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2496, dtype=torch.float64) delta_t tensor(0.2858, dtype=torch.float64)
9 gae_duplicate tensor(-0.8859, dtype=torch.float64) tensor(-5.3308, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2976, dtype=torch.float64) delta_t tensor(0.1529, dtype=torch.float64)
8 gae_duplicate tensor(-0.2062, dtype=torch.float64) tensor(-7.3793, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3293, dtype=torch.float64) delta_t tensor(-0.3198, dtype=torch.float64)
7 gae_duplicate tensor(-0.6583, dtype=torch.float64) tensor(-2.8452, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1958, dtype=torch.float64) delta_t tensor(-0.0883, dtype=torch.float64)
6 gae_duplicate tensor(-2.2503, dtype=torch.float64) tensor(-0.5770, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7203, dtype=torch.float64) delta_t tensor(-0.3768, dtype=torch.float64)
5 gae_duplicate tensor(-3.6782, dtype=torch.float64) tensor(5.6955, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1688, dtype=torch.float64) delta_t tensor(0.2384, dtype=torch.float64)
4 gae_duplicate tensor(-2.8311, dtype=torch.float64) tensor(-2.6626, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1735, dtype=torch.float64) delta_t tensor(0.2408, dtype=torch.float64)
3 gae_duplicate tensor(-1.7798, dtype=torch.float64) tensor(-0.0337, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5580, dtype=torch.float64) delta_t tensor(-0.5752, dtype=torch.float64)
2 gae_duplicate tensor(-1.7319, dtype=torch.float64) tensor(4.3566, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3478.81396484375
value loss:327.2664489746094
entropies:153.3447723388672
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.763278245925903 seconds
19 rew tensor(0.5774, dtype=torch.float64) delta_t tensor(-0.6358, dtype=torch.float64)
19 gae_duplicate tensor(-1.3562, dtype=torch.float64) tensor(0.8892, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4298, dtype=torch.float64) delta_t tensor(0.3225, dtype=torch.float64)
18 gae_duplicate tensor(-0.8533, dtype=torch.float64) tensor(1.5952, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5997, dtype=torch.float64) delta_t tensor(0.3982, dtype=torch.float64)
17 gae_duplicate tensor(-0.3805, dtype=torch.float64) tensor(-3.6144, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4684, dtype=torch.float64) delta_t tensor(0.1578, dtype=torch.float64)
16 gae_duplicate tensor(-0.4789, dtype=torch.float64) tensor(-2.7740, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2123, dtype=torch.float64) delta_t tensor(0.1906, dtype=torch.float64)
15 gae_duplicate tensor(-0.5195, dtype=torch.float64) tensor(-4.3838, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6939, dtype=torch.float64) delta_t tensor(0.5724, dtype=torch.float64)
14 gae_duplicate tensor(0.0950, dtype=torch.float64) tensor(-8.4990, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7329, dtype=torch.float64) delta_t tensor(0.4217, dtype=torch.float64)
13 gae_duplicate tensor(0.1532, dtype=torch.float64) tensor(-9.3388, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2561, dtype=torch.float64) delta_t tensor(0.5008, dtype=torch.float64)
12 gae_duplicate tensor(0.3473, dtype=torch.float64) tensor(-15.0517, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0357, dtype=torch.float64) delta_t tensor(-0.2616, dtype=torch.float64)
11 gae_duplicate tensor(-2.4339, dtype=torch.float64) tensor(-5.2851, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4383, dtype=torch.float64) delta_t tensor(0.0145, dtype=torch.float64)
10 gae_duplicate tensor(-2.6115, dtype=torch.float64) tensor(-5.0094, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5551, dtype=torch.float64) delta_t tensor(-0.7485, dtype=torch.float64)
9 gae_duplicate tensor(-2.1375, dtype=torch.float64) tensor(0.8124, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3029, dtype=torch.float64) delta_t tensor(-0.3515, dtype=torch.float64)
8 gae_duplicate tensor(-1.9513, dtype=torch.float64) tensor(1.2658, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3224, dtype=torch.float64) delta_t tensor(-0.1757, dtype=torch.float64)
7 gae_duplicate tensor(-1.8269, dtype=torch.float64) tensor(5.2383, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2339, dtype=torch.float64) delta_t tensor(-0.1285, dtype=torch.float64)
6 gae_duplicate tensor(-2.4109, dtype=torch.float64) tensor(5.9094, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4313, dtype=torch.float64) delta_t tensor(-0.9415, dtype=torch.float64)
5 gae_duplicate tensor(-3.3048, dtype=torch.float64) tensor(4.6268, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2705, dtype=torch.float64) delta_t tensor(-1.2183, dtype=torch.float64)
4 gae_duplicate tensor(-8.4840, dtype=torch.float64) tensor(22.1225, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7009, dtype=torch.float64) delta_t tensor(-0.1194, dtype=torch.float64)
3 gae_duplicate tensor(-6.3483, dtype=torch.float64) tensor(5.0062, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0924, dtype=torch.float64) delta_t tensor(-0.0153, dtype=torch.float64)
2 gae_duplicate tensor(-5.2036, dtype=torch.float64) tensor(7.8627, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-76.27969360351562
value loss:513.875732421875
entropies:149.30491638183594
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2175.5789)
ToM Target loss= tensor(1821.4351)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.80328106880188 seconds
19 rew tensor(0.7228, dtype=torch.float64) delta_t tensor(-0.4605, dtype=torch.float64)
19 gae_duplicate tensor(-0.9301, dtype=torch.float64) tensor(5.3238, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6986, dtype=torch.float64) delta_t tensor(0.3044, dtype=torch.float64)
18 gae_duplicate tensor(-0.5569, dtype=torch.float64) tensor(1.4864, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6336, dtype=torch.float64) delta_t tensor(0.7246, dtype=torch.float64)
17 gae_duplicate tensor(0.0162, dtype=torch.float64) tensor(-2.8180, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5287, dtype=torch.float64) delta_t tensor(0.0628, dtype=torch.float64)
16 gae_duplicate tensor(-0.0250, dtype=torch.float64) tensor(-5.7454, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5900, dtype=torch.float64) delta_t tensor(0.5172, dtype=torch.float64)
15 gae_duplicate tensor(0.1087, dtype=torch.float64) tensor(-5.8420, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4795, dtype=torch.float64) delta_t tensor(0.4224, dtype=torch.float64)
14 gae_duplicate tensor(-0.4083, dtype=torch.float64) tensor(-6.6201, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7245, dtype=torch.float64) delta_t tensor(0.5533, dtype=torch.float64)
13 gae_duplicate tensor(0.1882, dtype=torch.float64) tensor(-9.4597, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7015, dtype=torch.float64) delta_t tensor(0.4646, dtype=torch.float64)
12 gae_duplicate tensor(0.6655, dtype=torch.float64) tensor(-11.6220, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0325, dtype=torch.float64) delta_t tensor(-0.3682, dtype=torch.float64)
11 gae_duplicate tensor(-2.7725, dtype=torch.float64) tensor(-5.8382, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3512, dtype=torch.float64) delta_t tensor(0.0443, dtype=torch.float64)
10 gae_duplicate tensor(-3.4023, dtype=torch.float64) tensor(-2.7777, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9260, dtype=torch.float64) delta_t tensor(-1.0328, dtype=torch.float64)
9 gae_duplicate tensor(-1.9525, dtype=torch.float64) tensor(4.3250, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1675, dtype=torch.float64) delta_t tensor(-1.3095, dtype=torch.float64)
8 gae_duplicate tensor(-4.9873, dtype=torch.float64) tensor(19.1110, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4701, dtype=torch.float64) delta_t tensor(-0.5713, dtype=torch.float64)
7 gae_duplicate tensor(-3.5249, dtype=torch.float64) tensor(9.7711, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7249, dtype=torch.float64) delta_t tensor(-0.3724, dtype=torch.float64)
6 gae_duplicate tensor(-3.8591, dtype=torch.float64) tensor(8.4192, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9499, dtype=torch.float64) delta_t tensor(-0.3524, dtype=torch.float64)
5 gae_duplicate tensor(-4.2433, dtype=torch.float64) tensor(10.9082, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6206, dtype=torch.float64) delta_t tensor(-1.3424, dtype=torch.float64)
4 gae_duplicate tensor(-9.8053, dtype=torch.float64) tensor(22.1938, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1692, dtype=torch.float64) delta_t tensor(0.1099, dtype=torch.float64)
3 gae_duplicate tensor(-7.7466, dtype=torch.float64) tensor(36.7387, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1160, dtype=torch.float64) delta_t tensor(0.1751, dtype=torch.float64)
2 gae_duplicate tensor(-6.0544, dtype=torch.float64) tensor(9.8602, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2813.34814453125
value loss:826.6607055664062
entropies:146.88772583007812
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.788984060287476 seconds
19 rew tensor(0.6954, dtype=torch.float64) delta_t tensor(-0.6090, dtype=torch.float64)
19 gae_duplicate tensor(-1.0726, dtype=torch.float64) tensor(2.0054, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6352, dtype=torch.float64) delta_t tensor(0.6896, dtype=torch.float64)
18 gae_duplicate tensor(-1.0082, dtype=torch.float64) tensor(-4.4811, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5221, dtype=torch.float64) delta_t tensor(0.3761, dtype=torch.float64)
17 gae_duplicate tensor(-0.8993, dtype=torch.float64) tensor(-4.3201, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7484, dtype=torch.float64) delta_t tensor(0.5789, dtype=torch.float64)
16 gae_duplicate tensor(-0.0770, dtype=torch.float64) tensor(-8.8984, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7408, dtype=torch.float64) delta_t tensor(0.6338, dtype=torch.float64)
15 gae_duplicate tensor(0.5810, dtype=torch.float64) tensor(-8.3539, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7332, dtype=torch.float64) delta_t tensor(0.7464, dtype=torch.float64)
14 gae_duplicate tensor(0.7428, dtype=torch.float64) tensor(-19.5981, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6354, dtype=torch.float64) delta_t tensor(0.3950, dtype=torch.float64)
13 gae_duplicate tensor(0.5809, dtype=torch.float64) tensor(-19.4474, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0675, dtype=torch.float64) delta_t tensor(-0.4343, dtype=torch.float64)
12 gae_duplicate tensor(-1.6292, dtype=torch.float64) tensor(-9.0891, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1754, dtype=torch.float64) delta_t tensor(-0.1894, dtype=torch.float64)
11 gae_duplicate tensor(-1.0180, dtype=torch.float64) tensor(-2.9324, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0570, dtype=torch.float64) delta_t tensor(-0.0885, dtype=torch.float64)
10 gae_duplicate tensor(-1.0664, dtype=torch.float64) tensor(-3.4638, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0690, dtype=torch.float64) delta_t tensor(-0.2765, dtype=torch.float64)
9 gae_duplicate tensor(-2.7489, dtype=torch.float64) tensor(-4.1312, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0064, dtype=torch.float64) delta_t tensor(-0.1757, dtype=torch.float64)
8 gae_duplicate tensor(-2.3761, dtype=torch.float64) tensor(-0.2933, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6311, dtype=torch.float64) delta_t tensor(-0.4902, dtype=torch.float64)
7 gae_duplicate tensor(-1.5029, dtype=torch.float64) tensor(2.7619, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3479, dtype=torch.float64) delta_t tensor(-0.2114, dtype=torch.float64)
6 gae_duplicate tensor(-2.2504, dtype=torch.float64) tensor(5.6692, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9014, dtype=torch.float64) delta_t tensor(-0.5557, dtype=torch.float64)
5 gae_duplicate tensor(-3.1232, dtype=torch.float64) tensor(6.5811, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4312, dtype=torch.float64) delta_t tensor(0.1226, dtype=torch.float64)
4 gae_duplicate tensor(-5.5359, dtype=torch.float64) tensor(3.5113, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5140, dtype=torch.float64) delta_t tensor(-0.4499, dtype=torch.float64)
3 gae_duplicate tensor(-4.3120, dtype=torch.float64) tensor(2.5494, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3011, dtype=torch.float64) delta_t tensor(-0.1079, dtype=torch.float64)
2 gae_duplicate tensor(-3.1561, dtype=torch.float64) tensor(5.0482, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2021.50537109375
value loss:365.8182678222656
entropies:145.88963317871094
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.86045503616333 seconds
19 rew tensor(0.6319, dtype=torch.float64) delta_t tensor(-0.8996, dtype=torch.float64)
19 gae_duplicate tensor(-1.6936, dtype=torch.float64) tensor(5.6356, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4837, dtype=torch.float64) delta_t tensor(0.4386, dtype=torch.float64)
18 gae_duplicate tensor(-1.9992, dtype=torch.float64) tensor(5.2616, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6998, dtype=torch.float64) delta_t tensor(0.4008, dtype=torch.float64)
17 gae_duplicate tensor(-1.2007, dtype=torch.float64) tensor(5.4673, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6682, dtype=torch.float64) delta_t tensor(0.4899, dtype=torch.float64)
16 gae_duplicate tensor(-0.4854, dtype=torch.float64) tensor(-6.8251, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6033, dtype=torch.float64) delta_t tensor(0.3172, dtype=torch.float64)
15 gae_duplicate tensor(-0.0943, dtype=torch.float64) tensor(-2.7937, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7403, dtype=torch.float64) delta_t tensor(0.6634, dtype=torch.float64)
14 gae_duplicate tensor(0.4624, dtype=torch.float64) tensor(-6.7198, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7239, dtype=torch.float64) delta_t tensor(0.4325, dtype=torch.float64)
13 gae_duplicate tensor(0.6911, dtype=torch.float64) tensor(-15.8672, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3504, dtype=torch.float64) delta_t tensor(-0.4660, dtype=torch.float64)
12 gae_duplicate tensor(-1.8242, dtype=torch.float64) tensor(-8.1262, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4586, dtype=torch.float64) delta_t tensor(0.0895, dtype=torch.float64)
11 gae_duplicate tensor(-1.3515, dtype=torch.float64) tensor(-4.2127, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2034, dtype=torch.float64) delta_t tensor(-0.1335, dtype=torch.float64)
10 gae_duplicate tensor(-0.7443, dtype=torch.float64) tensor(-0.9595, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2696, dtype=torch.float64) delta_t tensor(0.1892, dtype=torch.float64)
9 gae_duplicate tensor(-0.4276, dtype=torch.float64) tensor(-2.1067, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0269, dtype=torch.float64) delta_t tensor(-0.2671, dtype=torch.float64)
8 gae_duplicate tensor(-1.2348, dtype=torch.float64) tensor(1.7565, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5289, dtype=torch.float64) delta_t tensor(-0.3340, dtype=torch.float64)
7 gae_duplicate tensor(-1.0606, dtype=torch.float64) tensor(-1.0877, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2204, dtype=torch.float64) delta_t tensor(-0.0501, dtype=torch.float64)
6 gae_duplicate tensor(-2.3659, dtype=torch.float64) tensor(6.1008, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2706, dtype=torch.float64) delta_t tensor(-0.9841, dtype=torch.float64)
5 gae_duplicate tensor(-5.0730, dtype=torch.float64) tensor(4.9905, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2694, dtype=torch.float64) delta_t tensor(-0.0122, dtype=torch.float64)
4 gae_duplicate tensor(-5.3899, dtype=torch.float64) tensor(11.8652, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4525, dtype=torch.float64) delta_t tensor(-0.0694, dtype=torch.float64)
3 gae_duplicate tensor(-4.5138, dtype=torch.float64) tensor(3.4088, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3518, dtype=torch.float64) delta_t tensor(-0.1027, dtype=torch.float64)
2 gae_duplicate tensor(-2.7316, dtype=torch.float64) tensor(10.1208, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-238.80418395996094
value loss:315.43548583984375
entropies:145.03790283203125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.169490098953247 seconds
19 rew tensor(0.6592, dtype=torch.float64) delta_t tensor(-0.4524, dtype=torch.float64)
19 gae_duplicate tensor(-1.0685, dtype=torch.float64) tensor(4.3804, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5791, dtype=torch.float64) delta_t tensor(0.5924, dtype=torch.float64)
18 gae_duplicate tensor(-0.4787, dtype=torch.float64) tensor(-2.8315, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7484, dtype=torch.float64) delta_t tensor(0.8160, dtype=torch.float64)
17 gae_duplicate tensor(0.4643, dtype=torch.float64) tensor(-5.9370, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7093, dtype=torch.float64) delta_t tensor(0.3655, dtype=torch.float64)
16 gae_duplicate tensor(0.7275, dtype=torch.float64) tensor(-12.9322, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6542, dtype=torch.float64) delta_t tensor(0.5064, dtype=torch.float64)
15 gae_duplicate tensor(0.7047, dtype=torch.float64) tensor(-7.7953, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5674, dtype=torch.float64) delta_t tensor(0.5561, dtype=torch.float64)
14 gae_duplicate tensor(1.2337, dtype=torch.float64) tensor(-11.3646, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0308, dtype=torch.float64) delta_t tensor(-0.1740, dtype=torch.float64)
13 gae_duplicate tensor(-1.4829, dtype=torch.float64) tensor(-11.0945, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5705, dtype=torch.float64) delta_t tensor(0.1676, dtype=torch.float64)
12 gae_duplicate tensor(-0.5803, dtype=torch.float64) tensor(-7.9185, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2906, dtype=torch.float64) delta_t tensor(-0.0178, dtype=torch.float64)
11 gae_duplicate tensor(-0.7978, dtype=torch.float64) tensor(-8.0182, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3880, dtype=torch.float64) delta_t tensor(0.0857, dtype=torch.float64)
10 gae_duplicate tensor(-0.3191, dtype=torch.float64) tensor(-2.4902, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2659, dtype=torch.float64) delta_t tensor(-0.2773, dtype=torch.float64)
9 gae_duplicate tensor(-0.5312, dtype=torch.float64) tensor(-2.0996, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1393, dtype=torch.float64) delta_t tensor(-0.0021, dtype=torch.float64)
8 gae_duplicate tensor(-1.6940, dtype=torch.float64) tensor(-4.2367, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4857, dtype=torch.float64) delta_t tensor(-0.5439, dtype=torch.float64)
7 gae_duplicate tensor(-3.0657, dtype=torch.float64) tensor(1.5972, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4214, dtype=torch.float64) delta_t tensor(-0.3420, dtype=torch.float64)
6 gae_duplicate tensor(-3.9355, dtype=torch.float64) tensor(1.7575, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9507, dtype=torch.float64) delta_t tensor(-0.7204, dtype=torch.float64)
5 gae_duplicate tensor(-5.2612, dtype=torch.float64) tensor(28.5963, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2841, dtype=torch.float64) delta_t tensor(-0.9423, dtype=torch.float64)
4 gae_duplicate tensor(-10.0328, dtype=torch.float64) tensor(14.2359, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2137, dtype=torch.float64) delta_t tensor(0.2439, dtype=torch.float64)
3 gae_duplicate tensor(-7.3641, dtype=torch.float64) tensor(39.3966, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2293, dtype=torch.float64) delta_t tensor(-0.3276, dtype=torch.float64)
2 gae_duplicate tensor(-5.9181, dtype=torch.float64) tensor(19.7584, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1213.5574951171875
value loss:669.2034301757812
entropies:141.21676635742188
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.608776092529297 seconds
19 rew tensor(0.6010, dtype=torch.float64) delta_t tensor(-0.9187, dtype=torch.float64)
19 gae_duplicate tensor(-1.9347, dtype=torch.float64) tensor(8.0377, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4467, dtype=torch.float64) delta_t tensor(0.2319, dtype=torch.float64)
18 gae_duplicate tensor(-2.2708, dtype=torch.float64) tensor(3.0859, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7402, dtype=torch.float64) delta_t tensor(0.5267, dtype=torch.float64)
17 gae_duplicate tensor(-1.3340, dtype=torch.float64) tensor(-0.4575, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7559, dtype=torch.float64) delta_t tensor(0.6079, dtype=torch.float64)
16 gae_duplicate tensor(-0.5236, dtype=torch.float64) tensor(-6.1671, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7561, dtype=torch.float64) delta_t tensor(1.0116, dtype=torch.float64)
15 gae_duplicate tensor(0.1249, dtype=torch.float64) tensor(-5.0231, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7563, dtype=torch.float64) delta_t tensor(0.6005, dtype=torch.float64)
14 gae_duplicate tensor(0.6439, dtype=torch.float64) tensor(-22.7333, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7565, dtype=torch.float64) delta_t tensor(0.5907, dtype=torch.float64)
13 gae_duplicate tensor(0.9878, dtype=torch.float64) tensor(-7.9756, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6684, dtype=torch.float64) delta_t tensor(0.2605, dtype=torch.float64)
12 gae_duplicate tensor(0.7457, dtype=torch.float64) tensor(-23.3949, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4322, dtype=torch.float64) delta_t tensor(0.2504, dtype=torch.float64)
11 gae_duplicate tensor(0.1159, dtype=torch.float64) tensor(-19.3917, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3562, dtype=torch.float64) delta_t tensor(-0.1269, dtype=torch.float64)
10 gae_duplicate tensor(-0.0339, dtype=torch.float64) tensor(-11.1819, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2732, dtype=torch.float64) delta_t tensor(-0.5234, dtype=torch.float64)
9 gae_duplicate tensor(-2.4207, dtype=torch.float64) tensor(2.4240, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0896, dtype=torch.float64) delta_t tensor(-0.0438, dtype=torch.float64)
8 gae_duplicate tensor(-3.1717, dtype=torch.float64) tensor(4.1950, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0840, dtype=torch.float64) delta_t tensor(0.0193, dtype=torch.float64)
7 gae_duplicate tensor(-2.4091, dtype=torch.float64) tensor(3.0488, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9749, dtype=torch.float64) delta_t tensor(-0.9025, dtype=torch.float64)
6 gae_duplicate tensor(-2.5543, dtype=torch.float64) tensor(15.0086, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5540, dtype=torch.float64) delta_t tensor(-0.9621, dtype=torch.float64)
5 gae_duplicate tensor(-3.0999, dtype=torch.float64) tensor(8.3760, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0424, dtype=torch.float64) delta_t tensor(-1.7662, dtype=torch.float64)
4 gae_duplicate tensor(-7.5376, dtype=torch.float64) tensor(22.0276, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1018, dtype=torch.float64) delta_t tensor(0.0769, dtype=torch.float64)
3 gae_duplicate tensor(-5.9494, dtype=torch.float64) tensor(26.4411, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2875, dtype=torch.float64) delta_t tensor(-0.1822, dtype=torch.float64)
2 gae_duplicate tensor(-4.6095, dtype=torch.float64) tensor(8.3441, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-192.9414825439453
value loss:743.6485595703125
entropies:139.1437530517578
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2127.5798)
ToM Target loss= tensor(1819.0574)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.842097997665405 seconds
19 rew tensor(0.4511, dtype=torch.float64) delta_t tensor(-1.2045, dtype=torch.float64)
19 gae_duplicate tensor(-1.9076, dtype=torch.float64) tensor(7.2536, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6860, dtype=torch.float64) delta_t tensor(0.4626, dtype=torch.float64)
18 gae_duplicate tensor(-1.0353, dtype=torch.float64) tensor(5.1490, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6325, dtype=torch.float64) delta_t tensor(0.6626, dtype=torch.float64)
17 gae_duplicate tensor(-0.5154, dtype=torch.float64) tensor(-0.7914, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6013, dtype=torch.float64) delta_t tensor(0.2542, dtype=torch.float64)
16 gae_duplicate tensor(-0.5333, dtype=torch.float64) tensor(-8.0315, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2767, dtype=torch.float64) delta_t tensor(0.4478, dtype=torch.float64)
15 gae_duplicate tensor(0.1831, dtype=torch.float64) tensor(-8.7947, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5117, dtype=torch.float64) delta_t tensor(0.0216, dtype=torch.float64)
14 gae_duplicate tensor(-0.1795, dtype=torch.float64) tensor(-4.3868, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7400, dtype=torch.float64) delta_t tensor(0.3508, dtype=torch.float64)
13 gae_duplicate tensor(0.2505, dtype=torch.float64) tensor(-5.6808, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2550, dtype=torch.float64) delta_t tensor(-0.0258, dtype=torch.float64)
12 gae_duplicate tensor(-0.6440, dtype=torch.float64) tensor(-5.3410, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7638, dtype=torch.float64) delta_t tensor(-1.0238, dtype=torch.float64)
11 gae_duplicate tensor(-3.5578, dtype=torch.float64) tensor(7.6349, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1229, dtype=torch.float64) delta_t tensor(-0.0332, dtype=torch.float64)
10 gae_duplicate tensor(-5.4579, dtype=torch.float64) tensor(-1.3774, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3093, dtype=torch.float64) delta_t tensor(0.2158, dtype=torch.float64)
9 gae_duplicate tensor(-3.5995, dtype=torch.float64) tensor(-6.8900, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0970, dtype=torch.float64) delta_t tensor(0.2413, dtype=torch.float64)
8 gae_duplicate tensor(-2.8382, dtype=torch.float64) tensor(-4.7145, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2934, dtype=torch.float64) delta_t tensor(-0.4317, dtype=torch.float64)
7 gae_duplicate tensor(-2.5875, dtype=torch.float64) tensor(2.1136, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1738, dtype=torch.float64) delta_t tensor(0.0610, dtype=torch.float64)
6 gae_duplicate tensor(-1.6377, dtype=torch.float64) tensor(1.0425, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9108, dtype=torch.float64) delta_t tensor(-0.6574, dtype=torch.float64)
5 gae_duplicate tensor(-1.9403, dtype=torch.float64) tensor(10.5021, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1357, dtype=torch.float64) delta_t tensor(0.3234, dtype=torch.float64)
4 gae_duplicate tensor(-1.1211, dtype=torch.float64) tensor(7.4360, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9093, dtype=torch.float64) delta_t tensor(-0.8473, dtype=torch.float64)
3 gae_duplicate tensor(-2.5755, dtype=torch.float64) tensor(7.6527, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1080, dtype=torch.float64) delta_t tensor(-0.4270, dtype=torch.float64)
2 gae_duplicate tensor(-2.7987, dtype=torch.float64) tensor(20.4121, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-859.5286254882812
value loss:311.24761962890625
entropies:137.47589111328125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.7706639766693115 seconds
19 rew tensor(0.1214, dtype=torch.float64) delta_t tensor(-1.1571, dtype=torch.float64)
19 gae_duplicate tensor(-2.3843, dtype=torch.float64) tensor(7.6779, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7478, dtype=torch.float64) delta_t tensor(0.5111, dtype=torch.float64)
18 gae_duplicate tensor(-1.3494, dtype=torch.float64) tensor(-0.4467, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7403, dtype=torch.float64) delta_t tensor(0.5342, dtype=torch.float64)
17 gae_duplicate tensor(-0.5212, dtype=torch.float64) tensor(-0.5821, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7173, dtype=torch.float64) delta_t tensor(0.4709, dtype=torch.float64)
16 gae_duplicate tensor(0.0326, dtype=torch.float64) tensor(-7.2536, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6705, dtype=torch.float64) delta_t tensor(0.5001, dtype=torch.float64)
15 gae_duplicate tensor(0.0126, dtype=torch.float64) tensor(-5.4431, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6089, dtype=torch.float64) delta_t tensor(0.1695, dtype=torch.float64)
14 gae_duplicate tensor(-0.2414, dtype=torch.float64) tensor(-6.9098, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7081, dtype=torch.float64) delta_t tensor(0.4284, dtype=torch.float64)
13 gae_duplicate tensor(0.1534, dtype=torch.float64) tensor(-11.2935, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6301, dtype=torch.float64) delta_t tensor(0.3688, dtype=torch.float64)
12 gae_duplicate tensor(0.5597, dtype=torch.float64) tensor(-3.8118, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6944, dtype=torch.float64) delta_t tensor(0.6007, dtype=torch.float64)
11 gae_duplicate tensor(0.9430, dtype=torch.float64) tensor(-8.2039, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2837, dtype=torch.float64) delta_t tensor(-0.0779, dtype=torch.float64)
10 gae_duplicate tensor(-0.5168, dtype=torch.float64) tensor(-2.7453, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0606, dtype=torch.float64) delta_t tensor(-0.1976, dtype=torch.float64)
9 gae_duplicate tensor(-0.7941, dtype=torch.float64) tensor(-12.8440, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8998, dtype=torch.float64) delta_t tensor(-1.0230, dtype=torch.float64)
8 gae_duplicate tensor(-1.4297, dtype=torch.float64) tensor(8.0084, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1699, dtype=torch.float64) delta_t tensor(-1.4521, dtype=torch.float64)
7 gae_duplicate tensor(-3.7971, dtype=torch.float64) tensor(14.8048, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.6020, dtype=torch.float64) delta_t tensor(-1.6906, dtype=torch.float64)
6 gae_duplicate tensor(-6.1517, dtype=torch.float64) tensor(19.6886, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7034, dtype=torch.float64) delta_t tensor(-1.2194, dtype=torch.float64)
5 gae_duplicate tensor(-6.2588, dtype=torch.float64) tensor(11.4330, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4534, dtype=torch.float64) delta_t tensor(-2.2034, dtype=torch.float64)
4 gae_duplicate tensor(-10.4649, dtype=torch.float64) tensor(14.3988, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3694, dtype=torch.float64) delta_t tensor(0.1394, dtype=torch.float64)
3 gae_duplicate tensor(-7.6766, dtype=torch.float64) tensor(40.8680, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1712, dtype=torch.float64) delta_t tensor(-0.0122, dtype=torch.float64)
2 gae_duplicate tensor(-6.0443, dtype=torch.float64) tensor(34.9433, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3346.6572265625
value loss:1260.7919921875
entropies:134.74703979492188
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.795530080795288 seconds
19 rew tensor(0.6701, dtype=torch.float64) delta_t tensor(-0.6520, dtype=torch.float64)
19 gae_duplicate tensor(-1.2479, dtype=torch.float64) tensor(4.0556, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6215, dtype=torch.float64) delta_t tensor(0.3036, dtype=torch.float64)
18 gae_duplicate tensor(-0.8093, dtype=torch.float64) tensor(5.6830, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6336, dtype=torch.float64) delta_t tensor(0.4075, dtype=torch.float64)
17 gae_duplicate tensor(-0.4561, dtype=torch.float64) tensor(-1.1041, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5184, dtype=torch.float64) delta_t tensor(0.2381, dtype=torch.float64)
16 gae_duplicate tensor(-0.7468, dtype=torch.float64) tensor(-3.1042, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3027, dtype=torch.float64) delta_t tensor(0.0981, dtype=torch.float64)
15 gae_duplicate tensor(-0.9535, dtype=torch.float64) tensor(-4.2990, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6860, dtype=torch.float64) delta_t tensor(0.4369, dtype=torch.float64)
14 gae_duplicate tensor(-0.3143, dtype=torch.float64) tensor(-10.5550, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3124, dtype=torch.float64) delta_t tensor(0.2821, dtype=torch.float64)
13 gae_duplicate tensor(-0.9993, dtype=torch.float64) tensor(-4.0966, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3977, dtype=torch.float64) delta_t tensor(-0.6009, dtype=torch.float64)
12 gae_duplicate tensor(-1.3351, dtype=torch.float64) tensor(-2.8290, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0771, dtype=torch.float64) delta_t tensor(-0.1573, dtype=torch.float64)
11 gae_duplicate tensor(-1.5780, dtype=torch.float64) tensor(0.1867, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2132, dtype=torch.float64) delta_t tensor(-0.6993, dtype=torch.float64)
10 gae_duplicate tensor(-3.5038, dtype=torch.float64) tensor(14.9319, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3449, dtype=torch.float64) delta_t tensor(-0.5602, dtype=torch.float64)
9 gae_duplicate tensor(-4.9679, dtype=torch.float64) tensor(13.0038, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2141, dtype=torch.float64) delta_t tensor(0.0937, dtype=torch.float64)
8 gae_duplicate tensor(-3.8739, dtype=torch.float64) tensor(9.2275, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2157, dtype=torch.float64) delta_t tensor(-0.4777, dtype=torch.float64)
7 gae_duplicate tensor(-3.0420, dtype=torch.float64) tensor(5.0993, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5433, dtype=torch.float64) delta_t tensor(-0.0398, dtype=torch.float64)
6 gae_duplicate tensor(-2.8765, dtype=torch.float64) tensor(6.8909, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5321, dtype=torch.float64) delta_t tensor(-0.2652, dtype=torch.float64)
5 gae_duplicate tensor(-3.7258, dtype=torch.float64) tensor(12.0700, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9094, dtype=torch.float64) delta_t tensor(-0.4177, dtype=torch.float64)
4 gae_duplicate tensor(-7.8102, dtype=torch.float64) tensor(4.4566, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0455, dtype=torch.float64) delta_t tensor(-0.0851, dtype=torch.float64)
3 gae_duplicate tensor(-6.9279, dtype=torch.float64) tensor(15.8829, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3532, dtype=torch.float64) delta_t tensor(0.0860, dtype=torch.float64)
2 gae_duplicate tensor(-5.0233, dtype=torch.float64) tensor(1.9072, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2450.470703125
value loss:503.8133544921875
entropies:132.2456512451172
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.895445823669434 seconds
19 rew tensor(0.7560, dtype=torch.float64) delta_t tensor(-0.6749, dtype=torch.float64)
19 gae_duplicate tensor(-0.9380, dtype=torch.float64) tensor(3.5263, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7562, dtype=torch.float64) delta_t tensor(0.5296, dtype=torch.float64)
18 gae_duplicate tensor(-0.3253, dtype=torch.float64) tensor(-0.1281, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7563, dtype=torch.float64) delta_t tensor(0.5728, dtype=torch.float64)
17 gae_duplicate tensor(0.1650, dtype=torch.float64) tensor(-4.1678, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7565, dtype=torch.float64) delta_t tensor(0.5152, dtype=torch.float64)
16 gae_duplicate tensor(0.2562, dtype=torch.float64) tensor(-9.0492, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7567, dtype=torch.float64) delta_t tensor(0.5827, dtype=torch.float64)
15 gae_duplicate tensor(0.7338, dtype=torch.float64) tensor(-9.3236, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7569, dtype=torch.float64) delta_t tensor(0.4960, dtype=torch.float64)
14 gae_duplicate tensor(0.9823, dtype=torch.float64) tensor(-4.2056, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7011, dtype=torch.float64) delta_t tensor(0.4540, dtype=torch.float64)
13 gae_duplicate tensor(0.8773, dtype=torch.float64) tensor(-15.9615, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5890, dtype=torch.float64) delta_t tensor(0.5495, dtype=torch.float64)
12 gae_duplicate tensor(1.2917, dtype=torch.float64) tensor(-23.6454, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0105, dtype=torch.float64) delta_t tensor(0.0480, dtype=torch.float64)
11 gae_duplicate tensor(0.6332, dtype=torch.float64) tensor(-18.6104, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.8429, dtype=torch.float64) delta_t tensor(-1.2296, dtype=torch.float64)
10 gae_duplicate tensor(-3.2937, dtype=torch.float64) tensor(1.1603, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4231, dtype=torch.float64) delta_t tensor(-0.4727, dtype=torch.float64)
9 gae_duplicate tensor(-5.4827, dtype=torch.float64) tensor(4.9633, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0539, dtype=torch.float64) delta_t tensor(0.1329, dtype=torch.float64)
8 gae_duplicate tensor(-4.1598, dtype=torch.float64) tensor(2.2521, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2254, dtype=torch.float64) delta_t tensor(-0.2620, dtype=torch.float64)
7 gae_duplicate tensor(-3.4279, dtype=torch.float64) tensor(4.6700, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0174, dtype=torch.float64) delta_t tensor(0.0910, dtype=torch.float64)
6 gae_duplicate tensor(-2.5322, dtype=torch.float64) tensor(10.4270, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8566, dtype=torch.float64) delta_t tensor(-0.3352, dtype=torch.float64)
5 gae_duplicate tensor(-0.9599, dtype=torch.float64) tensor(6.5006, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1692, dtype=torch.float64) delta_t tensor(0.4887, dtype=torch.float64)
4 gae_duplicate tensor(-1.0856, dtype=torch.float64) tensor(-2.1227, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6242, dtype=torch.float64) delta_t tensor(-0.1938, dtype=torch.float64)
3 gae_duplicate tensor(-1.5115, dtype=torch.float64) tensor(5.9297, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2507, dtype=torch.float64) delta_t tensor(-0.2446, dtype=torch.float64)
2 gae_duplicate tensor(-1.3617, dtype=torch.float64) tensor(2.2902, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1614.5411376953125
value loss:349.18408203125
entropies:129.3068389892578
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.717322111129761 seconds
19 rew tensor(0.5213, dtype=torch.float64) delta_t tensor(-0.8901, dtype=torch.float64)
19 gae_duplicate tensor(-2.0490, dtype=torch.float64) tensor(10.2619, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3009, dtype=torch.float64) delta_t tensor(0.1176, dtype=torch.float64)
18 gae_duplicate tensor(-2.3715, dtype=torch.float64) tensor(6.7768, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4357, dtype=torch.float64) delta_t tensor(0.0994, dtype=torch.float64)
17 gae_duplicate tensor(-1.3183, dtype=torch.float64) tensor(5.1536, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1934, dtype=torch.float64) delta_t tensor(0.2719, dtype=torch.float64)
16 gae_duplicate tensor(-1.4929, dtype=torch.float64) tensor(0.1638, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6935, dtype=torch.float64) delta_t tensor(0.4883, dtype=torch.float64)
15 gae_duplicate tensor(-0.6880, dtype=torch.float64) tensor(-0.4129, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5294, dtype=torch.float64) delta_t tensor(0.5253, dtype=torch.float64)
14 gae_duplicate tensor(-0.0571, dtype=torch.float64) tensor(-8.8918, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5138, dtype=torch.float64) delta_t tensor(0.3129, dtype=torch.float64)
13 gae_duplicate tensor(0.4504, dtype=torch.float64) tensor(-12.2436, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5283, dtype=torch.float64) delta_t tensor(0.5778, dtype=torch.float64)
12 gae_duplicate tensor(0.0901, dtype=torch.float64) tensor(-5.4822, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3746, dtype=torch.float64) delta_t tensor(-0.3298, dtype=torch.float64)
11 gae_duplicate tensor(-0.6890, dtype=torch.float64) tensor(-6.6238, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3062, dtype=torch.float64) delta_t tensor(-0.0456, dtype=torch.float64)
10 gae_duplicate tensor(-0.7419, dtype=torch.float64) tensor(-10.5042, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9149, dtype=torch.float64) delta_t tensor(-1.0177, dtype=torch.float64)
9 gae_duplicate tensor(-4.4945, dtype=torch.float64) tensor(2.1728, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2124, dtype=torch.float64) delta_t tensor(-0.2240, dtype=torch.float64)
8 gae_duplicate tensor(-3.0204, dtype=torch.float64) tensor(-3.3860, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2119, dtype=torch.float64) delta_t tensor(-0.2793, dtype=torch.float64)
7 gae_duplicate tensor(-3.2421, dtype=torch.float64) tensor(5.9830, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5998, dtype=torch.float64) delta_t tensor(-0.4681, dtype=torch.float64)
6 gae_duplicate tensor(-3.5943, dtype=torch.float64) tensor(7.8180, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9454, dtype=torch.float64) delta_t tensor(-0.4328, dtype=torch.float64)
5 gae_duplicate tensor(-4.8083, dtype=torch.float64) tensor(13.6666, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3398, dtype=torch.float64) delta_t tensor(-0.9358, dtype=torch.float64)
4 gae_duplicate tensor(-7.4244, dtype=torch.float64) tensor(17.5815, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2115, dtype=torch.float64) delta_t tensor(0.0811, dtype=torch.float64)
3 gae_duplicate tensor(-5.6758, dtype=torch.float64) tensor(21.7739, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2474, dtype=torch.float64) delta_t tensor(0.1386, dtype=torch.float64)
2 gae_duplicate tensor(-4.2488, dtype=torch.float64) tensor(9.6161, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1946.166748046875
value loss:627.7269897460938
entropies:127.36940002441406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2016.8657)
ToM Target loss= tensor(1817.5297)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.012995004653931 seconds
19 rew tensor(0.7401, dtype=torch.float64) delta_t tensor(-0.7427, dtype=torch.float64)
19 gae_duplicate tensor(-1.2256, dtype=torch.float64) tensor(1.8908, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7251, dtype=torch.float64) delta_t tensor(0.2554, dtype=torch.float64)
18 gae_duplicate tensor(-0.7279, dtype=torch.float64) tensor(1.8468, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7023, dtype=torch.float64) delta_t tensor(0.4134, dtype=torch.float64)
17 gae_duplicate tensor(-0.2941, dtype=torch.float64) tensor(-1.2036, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6419, dtype=torch.float64) delta_t tensor(0.3249, dtype=torch.float64)
16 gae_duplicate tensor(-0.2485, dtype=torch.float64) tensor(-3.5495, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3253, dtype=torch.float64) delta_t tensor(0.5040, dtype=torch.float64)
15 gae_duplicate tensor(0.3137, dtype=torch.float64) tensor(-2.7555, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7002, dtype=torch.float64) delta_t tensor(0.6271, dtype=torch.float64)
14 gae_duplicate tensor(0.5931, dtype=torch.float64) tensor(-3.2870, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5983, dtype=torch.float64) delta_t tensor(0.3870, dtype=torch.float64)
13 gae_duplicate tensor(0.6023, dtype=torch.float64) tensor(-7.6289, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5232, dtype=torch.float64) delta_t tensor(0.4358, dtype=torch.float64)
12 gae_duplicate tensor(0.5556, dtype=torch.float64) tensor(-6.8351, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2026, dtype=torch.float64) delta_t tensor(0.0800, dtype=torch.float64)
11 gae_duplicate tensor(-0.1001, dtype=torch.float64) tensor(-6.2013, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3389, dtype=torch.float64) delta_t tensor(-0.3083, dtype=torch.float64)
10 gae_duplicate tensor(-0.1571, dtype=torch.float64) tensor(-5.0705, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4475, dtype=torch.float64) delta_t tensor(0.2929, dtype=torch.float64)
9 gae_duplicate tensor(0.0556, dtype=torch.float64) tensor(-4.6145, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5122, dtype=torch.float64) delta_t tensor(-0.6647, dtype=torch.float64)
8 gae_duplicate tensor(-0.4163, dtype=torch.float64) tensor(-2.5881, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1059, dtype=torch.float64) delta_t tensor(-0.0523, dtype=torch.float64)
7 gae_duplicate tensor(-1.3961, dtype=torch.float64) tensor(2.8154, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6968, dtype=torch.float64) delta_t tensor(-0.6575, dtype=torch.float64)
6 gae_duplicate tensor(-2.6135, dtype=torch.float64) tensor(3.9278, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1087, dtype=torch.float64) delta_t tensor(-0.3324, dtype=torch.float64)
5 gae_duplicate tensor(-3.0519, dtype=torch.float64) tensor(-1.0311, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7692, dtype=torch.float64) delta_t tensor(-1.4938, dtype=torch.float64)
4 gae_duplicate tensor(-10.8709, dtype=torch.float64) tensor(53.1704, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4499, dtype=torch.float64) delta_t tensor(0.1058, dtype=torch.float64)
3 gae_duplicate tensor(-8.1529, dtype=torch.float64) tensor(6.8677, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2104, dtype=torch.float64) delta_t tensor(-0.5900, dtype=torch.float64)
2 gae_duplicate tensor(-6.2167, dtype=torch.float64) tensor(6.6651, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1189.5074462890625
value loss:573.8919677734375
entropies:124.58888244628906
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.752249002456665 seconds
19 rew tensor(0.7546, dtype=torch.float64) delta_t tensor(-0.2759, dtype=torch.float64)
19 gae_duplicate tensor(-1.0755, dtype=torch.float64) tensor(-0.4621, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7547, dtype=torch.float64) delta_t tensor(0.4621, dtype=torch.float64)
18 gae_duplicate tensor(-0.4776, dtype=torch.float64) tensor(-1.4320, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7549, dtype=torch.float64) delta_t tensor(0.4050, dtype=torch.float64)
17 gae_duplicate tensor(0.0010, dtype=torch.float64) tensor(-2.8704, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7473, dtype=torch.float64) delta_t tensor(0.6443, dtype=torch.float64)
16 gae_duplicate tensor(0.3839, dtype=torch.float64) tensor(-6.6707, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7552, dtype=torch.float64) delta_t tensor(0.5332, dtype=torch.float64)
15 gae_duplicate tensor(0.6905, dtype=torch.float64) tensor(-14.6942, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5999, dtype=torch.float64) delta_t tensor(0.2575, dtype=torch.float64)
14 gae_duplicate tensor(0.7234, dtype=torch.float64) tensor(-6.8769, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7322, dtype=torch.float64) delta_t tensor(0.7962, dtype=torch.float64)
13 gae_duplicate tensor(0.6905, dtype=torch.float64) tensor(-25.2079, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2196, dtype=torch.float64) delta_t tensor(-0.2147, dtype=torch.float64)
12 gae_duplicate tensor(-0.8963, dtype=torch.float64) tensor(-11.4533, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4764, dtype=torch.float64) delta_t tensor(0.3076, dtype=torch.float64)
11 gae_duplicate tensor(-1.3199, dtype=torch.float64) tensor(-8.7368, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6577, dtype=torch.float64) delta_t tensor(-0.6549, dtype=torch.float64)
10 gae_duplicate tensor(-4.3706, dtype=torch.float64) tensor(-0.9876, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1154, dtype=torch.float64) delta_t tensor(-0.3188, dtype=torch.float64)
9 gae_duplicate tensor(-5.8514, dtype=torch.float64) tensor(11.7725, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0397, dtype=torch.float64) delta_t tensor(-0.0110, dtype=torch.float64)
8 gae_duplicate tensor(-4.4863, dtype=torch.float64) tensor(-3.2345, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5115, dtype=torch.float64) delta_t tensor(-0.3838, dtype=torch.float64)
7 gae_duplicate tensor(-2.7810, dtype=torch.float64) tensor(1.8800, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2435, dtype=torch.float64) delta_t tensor(-0.0155, dtype=torch.float64)
6 gae_duplicate tensor(-3.3756, dtype=torch.float64) tensor(5.3914, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5781, dtype=torch.float64) delta_t tensor(-0.1914, dtype=torch.float64)
5 gae_duplicate tensor(-3.4108, dtype=torch.float64) tensor(-1.1304, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8585, dtype=torch.float64) delta_t tensor(-0.3304, dtype=torch.float64)
4 gae_duplicate tensor(-7.3913, dtype=torch.float64) tensor(29.5860, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0953, dtype=torch.float64) delta_t tensor(0.0396, dtype=torch.float64)
3 gae_duplicate tensor(-5.4306, dtype=torch.float64) tensor(-0.0852, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2676, dtype=torch.float64) delta_t tensor(-0.1529, dtype=torch.float64)
2 gae_duplicate tensor(-4.4278, dtype=torch.float64) tensor(-0.5272, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1264.791259765625
value loss:604.75244140625
entropies:121.20589447021484
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.703790664672852 seconds
19 rew tensor(0.1840, dtype=torch.float64) delta_t tensor(-0.9410, dtype=torch.float64)
19 gae_duplicate tensor(-1.8495, dtype=torch.float64) tensor(4.1978, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5107, dtype=torch.float64) delta_t tensor(0.5569, dtype=torch.float64)
18 gae_duplicate tensor(-1.3242, dtype=torch.float64) tensor(0.5036, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4825, dtype=torch.float64) delta_t tensor(0.4183, dtype=torch.float64)
17 gae_duplicate tensor(-1.2391, dtype=torch.float64) tensor(-0.3087, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6616, dtype=torch.float64) delta_t tensor(0.3873, dtype=torch.float64)
16 gae_duplicate tensor(-0.4359, dtype=torch.float64) tensor(-3.3515, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5527, dtype=torch.float64) delta_t tensor(0.7593, dtype=torch.float64)
15 gae_duplicate tensor(0.2069, dtype=torch.float64) tensor(-6.1032, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7010, dtype=torch.float64) delta_t tensor(0.6522, dtype=torch.float64)
14 gae_duplicate tensor(0.7213, dtype=torch.float64) tensor(-19.2183, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6695, dtype=torch.float64) delta_t tensor(0.4099, dtype=torch.float64)
13 gae_duplicate tensor(1.1329, dtype=torch.float64) tensor(-13.8939, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0777, dtype=torch.float64) delta_t tensor(-0.1293, dtype=torch.float64)
12 gae_duplicate tensor(-2.9555, dtype=torch.float64) tensor(-8.4891, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0388, dtype=torch.float64) delta_t tensor(-0.1682, dtype=torch.float64)
11 gae_duplicate tensor(-3.0736, dtype=torch.float64) tensor(10.8215, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0348, dtype=torch.float64) delta_t tensor(-0.4810, dtype=torch.float64)
10 gae_duplicate tensor(-3.0993, dtype=torch.float64) tensor(3.4351, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7294, dtype=torch.float64) delta_t tensor(-0.8631, dtype=torch.float64)
9 gae_duplicate tensor(-2.3471, dtype=torch.float64) tensor(0.5193, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0487, dtype=torch.float64) delta_t tensor(-0.0814, dtype=torch.float64)
8 gae_duplicate tensor(-2.8135, dtype=torch.float64) tensor(1.6640, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5634, dtype=torch.float64) delta_t tensor(-0.2691, dtype=torch.float64)
7 gae_duplicate tensor(-1.9494, dtype=torch.float64) tensor(5.5220, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2015, dtype=torch.float64) delta_t tensor(-0.0937, dtype=torch.float64)
6 gae_duplicate tensor(-4.0059, dtype=torch.float64) tensor(-0.5235, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3177, dtype=torch.float64) delta_t tensor(-0.7729, dtype=torch.float64)
5 gae_duplicate tensor(-5.4958, dtype=torch.float64) tensor(3.0986, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3920, dtype=torch.float64) delta_t tensor(-0.0633, dtype=torch.float64)
4 gae_duplicate tensor(-7.9180, dtype=torch.float64) tensor(3.2280, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7245, dtype=torch.float64) delta_t tensor(-0.2993, dtype=torch.float64)
3 gae_duplicate tensor(-7.0698, dtype=torch.float64) tensor(16.2645, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0867, dtype=torch.float64) delta_t tensor(-0.1671, dtype=torch.float64)
2 gae_duplicate tensor(-5.0564, dtype=torch.float64) tensor(5.0963, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-109.92082214355469
value loss:611.0093383789062
entropies:118.18351745605469
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.055126905441284 seconds
19 rew tensor(0.7387, dtype=torch.float64) delta_t tensor(-0.0997, dtype=torch.float64)
19 gae_duplicate tensor(-0.9177, dtype=torch.float64) tensor(-2.4623, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7310, dtype=torch.float64) delta_t tensor(0.5750, dtype=torch.float64)
18 gae_duplicate tensor(-0.4304, dtype=torch.float64) tensor(-0.3104, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7077, dtype=torch.float64) delta_t tensor(0.3853, dtype=torch.float64)
17 gae_duplicate tensor(-0.3708, dtype=torch.float64) tensor(-2.5472, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6530, dtype=torch.float64) delta_t tensor(0.2461, dtype=torch.float64)
16 gae_duplicate tensor(-0.3067, dtype=torch.float64) tensor(-4.7504, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5591, dtype=torch.float64) delta_t tensor(0.4515, dtype=torch.float64)
15 gae_duplicate tensor(-0.1591, dtype=torch.float64) tensor(-4.9860, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1080, dtype=torch.float64) delta_t tensor(-0.0498, dtype=torch.float64)
14 gae_duplicate tensor(-2.2359, dtype=torch.float64) tensor(-6.9827, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5672, dtype=torch.float64) delta_t tensor(0.4190, dtype=torch.float64)
13 gae_duplicate tensor(-2.2143, dtype=torch.float64) tensor(-4.7600, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6852, dtype=torch.float64) delta_t tensor(0.5372, dtype=torch.float64)
12 gae_duplicate tensor(-1.2851, dtype=torch.float64) tensor(-3.1392, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2007, dtype=torch.float64) delta_t tensor(0.0228, dtype=torch.float64)
11 gae_duplicate tensor(-1.1406, dtype=torch.float64) tensor(-6.4344, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3273, dtype=torch.float64) delta_t tensor(-0.6852, dtype=torch.float64)
10 gae_duplicate tensor(-6.1529, dtype=torch.float64) tensor(-0.4612, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2525, dtype=torch.float64) delta_t tensor(0.0825, dtype=torch.float64)
9 gae_duplicate tensor(-5.0879, dtype=torch.float64) tensor(9.4757, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2681, dtype=torch.float64) delta_t tensor(-0.2550, dtype=torch.float64)
8 gae_duplicate tensor(-3.4773, dtype=torch.float64) tensor(14.3731, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5103, dtype=torch.float64) delta_t tensor(-0.5786, dtype=torch.float64)
7 gae_duplicate tensor(-3.0204, dtype=torch.float64) tensor(15.0082, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0713, dtype=torch.float64) delta_t tensor(-0.8074, dtype=torch.float64)
6 gae_duplicate tensor(-4.0147, dtype=torch.float64) tensor(2.6614, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0299, dtype=torch.float64) delta_t tensor(-0.4228, dtype=torch.float64)
5 gae_duplicate tensor(-4.4147, dtype=torch.float64) tensor(14.9863, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0945, dtype=torch.float64) delta_t tensor(-1.7839, dtype=torch.float64)
4 gae_duplicate tensor(-8.4404, dtype=torch.float64) tensor(17.8933, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0183, dtype=torch.float64) delta_t tensor(0.2219, dtype=torch.float64)
3 gae_duplicate tensor(-6.3666, dtype=torch.float64) tensor(3.4034, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3444, dtype=torch.float64) delta_t tensor(-0.1289, dtype=torch.float64)
2 gae_duplicate tensor(-4.9384, dtype=torch.float64) tensor(24.0627, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2361.924560546875
value loss:851.1611938476562
entropies:115.72482299804688
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.704721927642822 seconds
19 rew tensor(0.7528, dtype=torch.float64) delta_t tensor(-0.4582, dtype=torch.float64)
19 gae_duplicate tensor(-0.9265, dtype=torch.float64) tensor(1.0152, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7530, dtype=torch.float64) delta_t tensor(0.8668, dtype=torch.float64)
18 gae_duplicate tensor(-0.3074, dtype=torch.float64) tensor(-0.5168, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7531, dtype=torch.float64) delta_t tensor(0.5353, dtype=torch.float64)
17 gae_duplicate tensor(0.0931, dtype=torch.float64) tensor(-3.6410, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6434, dtype=torch.float64) delta_t tensor(0.4788, dtype=torch.float64)
16 gae_duplicate tensor(0.0206, dtype=torch.float64) tensor(-7.1693, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5101, dtype=torch.float64) delta_t tensor(0.4106, dtype=torch.float64)
15 gae_duplicate tensor(-0.6058, dtype=torch.float64) tensor(-9.7785, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6593, dtype=torch.float64) delta_t tensor(0.3358, dtype=torch.float64)
14 gae_duplicate tensor(-0.6537, dtype=torch.float64) tensor(-11.2700, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7066, dtype=torch.float64) delta_t tensor(0.6418, dtype=torch.float64)
13 gae_duplicate tensor(0.4120, dtype=torch.float64) tensor(-8.4155, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7381, dtype=torch.float64) delta_t tensor(0.4867, dtype=torch.float64)
12 gae_duplicate tensor(0.7395, dtype=torch.float64) tensor(-23.1979, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1326, dtype=torch.float64) delta_t tensor(-0.0030, dtype=torch.float64)
11 gae_duplicate tensor(-0.3575, dtype=torch.float64) tensor(-3.3386, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2527, dtype=torch.float64) delta_t tensor(0.0019, dtype=torch.float64)
10 gae_duplicate tensor(-2.0728, dtype=torch.float64) tensor(-14.6943, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0385, dtype=torch.float64) delta_t tensor(0.1700, dtype=torch.float64)
9 gae_duplicate tensor(-0.3435, dtype=torch.float64) tensor(-2.4852, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1330, dtype=torch.float64) delta_t tensor(0.0187, dtype=torch.float64)
8 gae_duplicate tensor(-0.9210, dtype=torch.float64) tensor(-6.9068, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6727, dtype=torch.float64) delta_t tensor(-0.6392, dtype=torch.float64)
7 gae_duplicate tensor(-1.0131, dtype=torch.float64) tensor(-0.2817, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2158, dtype=torch.float64) delta_t tensor(-0.2233, dtype=torch.float64)
6 gae_duplicate tensor(-2.4318, dtype=torch.float64) tensor(10.3162, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9858, dtype=torch.float64) delta_t tensor(-0.2957, dtype=torch.float64)
5 gae_duplicate tensor(-3.2468, dtype=torch.float64) tensor(-0.0857, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0217, dtype=torch.float64) delta_t tensor(-1.3613, dtype=torch.float64)
4 gae_duplicate tensor(-8.7227, dtype=torch.float64) tensor(-3.3980, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3787, dtype=torch.float64) delta_t tensor(-0.0937, dtype=torch.float64)
3 gae_duplicate tensor(-6.4818, dtype=torch.float64) tensor(12.1961, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1776, dtype=torch.float64) delta_t tensor(-0.0668, dtype=torch.float64)
2 gae_duplicate tensor(-4.8889, dtype=torch.float64) tensor(10.9430, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2165.15283203125
value loss:714.9717407226562
entropies:113.14202880859375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1896.7656)
ToM Target loss= tensor(1810.4169)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.1678290367126465 seconds
19 rew tensor(0.7218, dtype=torch.float64) delta_t tensor(-0.2029, dtype=torch.float64)
19 gae_duplicate tensor(-0.7632, dtype=torch.float64) tensor(-0.7305, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7061, dtype=torch.float64) delta_t tensor(0.5102, dtype=torch.float64)
18 gae_duplicate tensor(-0.1660, dtype=torch.float64) tensor(-0.3710, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6745, dtype=torch.float64) delta_t tensor(0.2194, dtype=torch.float64)
17 gae_duplicate tensor(-0.0866, dtype=torch.float64) tensor(-1.6567, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5563, dtype=torch.float64) delta_t tensor(0.3755, dtype=torch.float64)
16 gae_duplicate tensor(-0.0340, dtype=torch.float64) tensor(-3.0263, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3910, dtype=torch.float64) delta_t tensor(0.4874, dtype=torch.float64)
15 gae_duplicate tensor(0.6553, dtype=torch.float64) tensor(-6.1856, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6830, dtype=torch.float64) delta_t tensor(0.5123, dtype=torch.float64)
14 gae_duplicate tensor(1.2457, dtype=torch.float64) tensor(-2.9325, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5135, dtype=torch.float64) delta_t tensor(0.3680, dtype=torch.float64)
13 gae_duplicate tensor(0.9029, dtype=torch.float64) tensor(-6.1775, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.8586, dtype=torch.float64) delta_t tensor(-1.1114, dtype=torch.float64)
12 gae_duplicate tensor(-2.2459, dtype=torch.float64) tensor(3.9981, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.9288, dtype=torch.float64) delta_t tensor(-1.1112, dtype=torch.float64)
11 gae_duplicate tensor(-4.2385, dtype=torch.float64) tensor(-0.0948, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3000, dtype=torch.float64) delta_t tensor(-0.1659, dtype=torch.float64)
10 gae_duplicate tensor(-3.1457, dtype=torch.float64) tensor(2.1595, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3375, dtype=torch.float64) delta_t tensor(0.1626, dtype=torch.float64)
9 gae_duplicate tensor(-2.4068, dtype=torch.float64) tensor(-1.4962, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1018, dtype=torch.float64) delta_t tensor(0.1594, dtype=torch.float64)
8 gae_duplicate tensor(-1.9312, dtype=torch.float64) tensor(0.7441, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0514, dtype=torch.float64) delta_t tensor(0.1684, dtype=torch.float64)
7 gae_duplicate tensor(-1.3792, dtype=torch.float64) tensor(-1.1134, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1155, dtype=torch.float64) delta_t tensor(0.4183, dtype=torch.float64)
6 gae_duplicate tensor(-0.8924, dtype=torch.float64) tensor(-2.2341, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6939, dtype=torch.float64) delta_t tensor(-0.2397, dtype=torch.float64)
5 gae_duplicate tensor(-0.3358, dtype=torch.float64) tensor(-0.3707, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0466, dtype=torch.float64) delta_t tensor(0.1309, dtype=torch.float64)
4 gae_duplicate tensor(-1.8340, dtype=torch.float64) tensor(-0.4168, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3496, dtype=torch.float64) delta_t tensor(0.2172, dtype=torch.float64)
3 gae_duplicate tensor(-0.8896, dtype=torch.float64) tensor(-1.4765, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2139, dtype=torch.float64) delta_t tensor(-0.1113, dtype=torch.float64)
2 gae_duplicate tensor(-0.7206, dtype=torch.float64) tensor(-0.7654, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:777.1893920898438
value loss:234.5670623779297
entropies:111.54621887207031
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.007767915725708 seconds
19 rew tensor(0.6003, dtype=torch.float64) delta_t tensor(-0.9669, dtype=torch.float64)
19 gae_duplicate tensor(-1.6391, dtype=torch.float64) tensor(3.0931, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4855, dtype=torch.float64) delta_t tensor(0.3228, dtype=torch.float64)
18 gae_duplicate tensor(-1.2719, dtype=torch.float64) tensor(4.1512, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6370, dtype=torch.float64) delta_t tensor(0.2693, dtype=torch.float64)
17 gae_duplicate tensor(-0.8178, dtype=torch.float64) tensor(0.3494, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5429, dtype=torch.float64) delta_t tensor(0.3176, dtype=torch.float64)
16 gae_duplicate tensor(-0.5710, dtype=torch.float64) tensor(-0.7216, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3397, dtype=torch.float64) delta_t tensor(0.4582, dtype=torch.float64)
15 gae_duplicate tensor(-1.0493, dtype=torch.float64) tensor(-4.3071, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7238, dtype=torch.float64) delta_t tensor(0.7590, dtype=torch.float64)
14 gae_duplicate tensor(0.1790, dtype=torch.float64) tensor(-3.0359, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6857, dtype=torch.float64) delta_t tensor(0.4707, dtype=torch.float64)
13 gae_duplicate tensor(0.7191, dtype=torch.float64) tensor(-9.3939, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0898, dtype=torch.float64) delta_t tensor(-0.0993, dtype=torch.float64)
12 gae_duplicate tensor(-1.0223, dtype=torch.float64) tensor(-10.3179, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0215, dtype=torch.float64) delta_t tensor(-0.1879, dtype=torch.float64)
11 gae_duplicate tensor(-2.2338, dtype=torch.float64) tensor(3.2093, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7313, dtype=torch.float64) delta_t tensor(-1.2331, dtype=torch.float64)
10 gae_duplicate tensor(-3.1296, dtype=torch.float64) tensor(6.7619, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2531, dtype=torch.float64) delta_t tensor(-0.4721, dtype=torch.float64)
9 gae_duplicate tensor(-5.9251, dtype=torch.float64) tensor(10.2333, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2050, dtype=torch.float64) delta_t tensor(-0.0034, dtype=torch.float64)
8 gae_duplicate tensor(-4.7089, dtype=torch.float64) tensor(1.6869, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0430, dtype=torch.float64) delta_t tensor(0.2002, dtype=torch.float64)
7 gae_duplicate tensor(-3.6000, dtype=torch.float64) tensor(-3.7691, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4294, dtype=torch.float64) delta_t tensor(-0.1846, dtype=torch.float64)
6 gae_duplicate tensor(-2.8804, dtype=torch.float64) tensor(9.0838, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2296, dtype=torch.float64) delta_t tensor(-0.0523, dtype=torch.float64)
5 gae_duplicate tensor(-1.5366, dtype=torch.float64) tensor(2.9037, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4399, dtype=torch.float64) delta_t tensor(0.1710, dtype=torch.float64)
4 gae_duplicate tensor(-1.1798, dtype=torch.float64) tensor(0.5123, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2723, dtype=torch.float64) delta_t tensor(-0.0375, dtype=torch.float64)
3 gae_duplicate tensor(-1.1999, dtype=torch.float64) tensor(5.4409, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4974, dtype=torch.float64) delta_t tensor(-0.3629, dtype=torch.float64)
2 gae_duplicate tensor(-1.5862, dtype=torch.float64) tensor(13.5923, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1080.9310302734375
value loss:363.2176513671875
entropies:110.7042465209961
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.6456520557403564 seconds
19 rew tensor(0.7445, dtype=torch.float64) delta_t tensor(0.0195, dtype=torch.float64)
19 gae_duplicate tensor(-0.9587, dtype=torch.float64) tensor(-2.2433, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7212, dtype=torch.float64) delta_t tensor(0.7133, dtype=torch.float64)
18 gae_duplicate tensor(-0.1772, dtype=torch.float64) tensor(-3.7359, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7136, dtype=torch.float64) delta_t tensor(0.6497, dtype=torch.float64)
17 gae_duplicate tensor(0.2021, dtype=torch.float64) tensor(-2.8575, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6509, dtype=torch.float64) delta_t tensor(0.5763, dtype=torch.float64)
16 gae_duplicate tensor(0.3117, dtype=torch.float64) tensor(-22.4542, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5887, dtype=torch.float64) delta_t tensor(0.4875, dtype=torch.float64)
15 gae_duplicate tensor(1.0711, dtype=torch.float64) tensor(-3.3486, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7450, dtype=torch.float64) delta_t tensor(0.2125, dtype=torch.float64)
14 gae_duplicate tensor(1.1687, dtype=torch.float64) tensor(-5.6141, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7454, dtype=torch.float64) delta_t tensor(0.6347, dtype=torch.float64)
13 gae_duplicate tensor(1.3822, dtype=torch.float64) tensor(-20.7643, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1075, dtype=torch.float64) delta_t tensor(-0.2192, dtype=torch.float64)
12 gae_duplicate tensor(-2.3223, dtype=torch.float64) tensor(-10.5485, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0975, dtype=torch.float64) delta_t tensor(-0.2765, dtype=torch.float64)
11 gae_duplicate tensor(-4.9810, dtype=torch.float64) tensor(-10.6183, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2124, dtype=torch.float64) delta_t tensor(-0.0938, dtype=torch.float64)
10 gae_duplicate tensor(-3.6425, dtype=torch.float64) tensor(11.3074, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1764, dtype=torch.float64) delta_t tensor(-0.4058, dtype=torch.float64)
9 gae_duplicate tensor(-3.9917, dtype=torch.float64) tensor(-9.8246, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6177, dtype=torch.float64) delta_t tensor(-0.6189, dtype=torch.float64)
8 gae_duplicate tensor(-3.0526, dtype=torch.float64) tensor(1.1336, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2090, dtype=torch.float64) delta_t tensor(-0.2178, dtype=torch.float64)
7 gae_duplicate tensor(-1.9007, dtype=torch.float64) tensor(6.1294, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8080, dtype=torch.float64) delta_t tensor(-0.5087, dtype=torch.float64)
6 gae_duplicate tensor(-2.8270, dtype=torch.float64) tensor(17.1102, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4985, dtype=torch.float64) delta_t tensor(-0.8639, dtype=torch.float64)
5 gae_duplicate tensor(-4.7194, dtype=torch.float64) tensor(13.1414, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8952, dtype=torch.float64) delta_t tensor(-2.6604, dtype=torch.float64)
4 gae_duplicate tensor(-10.6310, dtype=torch.float64) tensor(6.6510, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2047, dtype=torch.float64) delta_t tensor(0.3140, dtype=torch.float64)
3 gae_duplicate tensor(-8.3671, dtype=torch.float64) tensor(2.6306, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1199, dtype=torch.float64) delta_t tensor(0.0372, dtype=torch.float64)
2 gae_duplicate tensor(-6.2388, dtype=torch.float64) tensor(26.4196, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:250.1842041015625
value loss:1182.7830810546875
entropies:107.30754089355469
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.799491882324219 seconds
19 rew tensor(0.7524, dtype=torch.float64) delta_t tensor(-0.4733, dtype=torch.float64)
19 gae_duplicate tensor(-0.9673, dtype=torch.float64) tensor(0.9343, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7526, dtype=torch.float64) delta_t tensor(0.4461, dtype=torch.float64)
18 gae_duplicate tensor(-0.3733, dtype=torch.float64) tensor(-1.4585, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7527, dtype=torch.float64) delta_t tensor(0.4976, dtype=torch.float64)
17 gae_duplicate tensor(0.0993, dtype=torch.float64) tensor(-4.2713, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7529, dtype=torch.float64) delta_t tensor(0.4747, dtype=torch.float64)
16 gae_duplicate tensor(0.4857, dtype=torch.float64) tensor(-3.5200, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7373, dtype=torch.float64) delta_t tensor(0.3881, dtype=torch.float64)
15 gae_duplicate tensor(0.8116, dtype=torch.float64) tensor(-5.0497, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7375, dtype=torch.float64) delta_t tensor(0.4097, dtype=torch.float64)
14 gae_duplicate tensor(0.8631, dtype=torch.float64) tensor(-5.7229, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7534, dtype=torch.float64) delta_t tensor(0.5629, dtype=torch.float64)
13 gae_duplicate tensor(1.4184, dtype=torch.float64) tensor(-12.6122, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7536, dtype=torch.float64) delta_t tensor(0.4823, dtype=torch.float64)
12 gae_duplicate tensor(1.3769, dtype=torch.float64) tensor(-6.4346, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6989, dtype=torch.float64) delta_t tensor(0.4347, dtype=torch.float64)
11 gae_duplicate tensor(1.5307, dtype=torch.float64) tensor(-11.2119, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3531, dtype=torch.float64) delta_t tensor(0.1746, dtype=torch.float64)
10 gae_duplicate tensor(0.9152, dtype=torch.float64) tensor(-3.2322, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7605, dtype=torch.float64) delta_t tensor(-0.7117, dtype=torch.float64)
9 gae_duplicate tensor(-0.6655, dtype=torch.float64) tensor(-2.1848, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2649, dtype=torch.float64) delta_t tensor(-0.4915, dtype=torch.float64)
8 gae_duplicate tensor(-1.1308, dtype=torch.float64) tensor(-4.8386, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5812, dtype=torch.float64) delta_t tensor(-0.4899, dtype=torch.float64)
7 gae_duplicate tensor(-1.8840, dtype=torch.float64) tensor(6.8258, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6211, dtype=torch.float64) delta_t tensor(-0.4729, dtype=torch.float64)
6 gae_duplicate tensor(-3.3034, dtype=torch.float64) tensor(6.1743, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2903, dtype=torch.float64) delta_t tensor(-0.6646, dtype=torch.float64)
5 gae_duplicate tensor(-3.9304, dtype=torch.float64) tensor(10.8986, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1442, dtype=torch.float64) delta_t tensor(-0.8578, dtype=torch.float64)
4 gae_duplicate tensor(-6.2938, dtype=torch.float64) tensor(26.4739, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6232, dtype=torch.float64) delta_t tensor(-0.0347, dtype=torch.float64)
3 gae_duplicate tensor(-4.8887, dtype=torch.float64) tensor(3.7793, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1820, dtype=torch.float64) delta_t tensor(-0.3411, dtype=torch.float64)
2 gae_duplicate tensor(-4.2206, dtype=torch.float64) tensor(18.4304, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-486.48089599609375
value loss:475.905517578125
entropies:106.6895751953125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.571937084197998 seconds
19 rew tensor(0.4852, dtype=torch.float64) delta_t tensor(-0.5154, dtype=torch.float64)
19 gae_duplicate tensor(-1.0443, dtype=torch.float64) tensor(-0.0300, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7284, dtype=torch.float64) delta_t tensor(0.5371, dtype=torch.float64)
18 gae_duplicate tensor(-0.5287, dtype=torch.float64) tensor(-3.5433, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7050, dtype=torch.float64) delta_t tensor(0.4266, dtype=torch.float64)
17 gae_duplicate tensor(-0.1747, dtype=torch.float64) tensor(-0.9419, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6500, dtype=torch.float64) delta_t tensor(0.5126, dtype=torch.float64)
16 gae_duplicate tensor(-0.0133, dtype=torch.float64) tensor(-1.8117, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5559, dtype=torch.float64) delta_t tensor(0.5224, dtype=torch.float64)
15 gae_duplicate tensor(0.2951, dtype=torch.float64) tensor(-5.0768, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7204, dtype=torch.float64) delta_t tensor(0.5456, dtype=torch.float64)
14 gae_duplicate tensor(0.8817, dtype=torch.float64) tensor(-8.0396, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7128, dtype=torch.float64) delta_t tensor(0.5259, dtype=torch.float64)
13 gae_duplicate tensor(1.1347, dtype=torch.float64) tensor(-11.6435, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2966, dtype=torch.float64) delta_t tensor(-0.0774, dtype=torch.float64)
12 gae_duplicate tensor(-1.3577, dtype=torch.float64) tensor(-2.5580, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1834, dtype=torch.float64) delta_t tensor(-0.2213, dtype=torch.float64)
11 gae_duplicate tensor(-2.4404, dtype=torch.float64) tensor(-15.0722, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3523, dtype=torch.float64) delta_t tensor(0.0083, dtype=torch.float64)
10 gae_duplicate tensor(-2.2533, dtype=torch.float64) tensor(-18.7480, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3249, dtype=torch.float64) delta_t tensor(0.0010, dtype=torch.float64)
9 gae_duplicate tensor(-1.6436, dtype=torch.float64) tensor(-12.0654, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4136, dtype=torch.float64) delta_t tensor(-0.7193, dtype=torch.float64)
8 gae_duplicate tensor(-1.5756, dtype=torch.float64) tensor(-0.1931, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4717, dtype=torch.float64) delta_t tensor(0.0601, dtype=torch.float64)
7 gae_duplicate tensor(-1.4286, dtype=torch.float64) tensor(0.3075, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0850, dtype=torch.float64) delta_t tensor(0.2152, dtype=torch.float64)
6 gae_duplicate tensor(-1.6158, dtype=torch.float64) tensor(0.7109, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1140, dtype=torch.float64) delta_t tensor(-0.6256, dtype=torch.float64)
5 gae_duplicate tensor(-3.3257, dtype=torch.float64) tensor(10.8446, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9757, dtype=torch.float64) delta_t tensor(-1.7589, dtype=torch.float64)
4 gae_duplicate tensor(-9.5184, dtype=torch.float64) tensor(3.8367, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5853, dtype=torch.float64) delta_t tensor(-0.1363, dtype=torch.float64)
3 gae_duplicate tensor(-7.4653, dtype=torch.float64) tensor(3.3129, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2323, dtype=torch.float64) delta_t tensor(-0.2333, dtype=torch.float64)
2 gae_duplicate tensor(-6.0965, dtype=torch.float64) tensor(8.5446, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1859.09130859375
value loss:712.611572265625
entropies:105.01262664794922
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1840.8951)
ToM Target loss= tensor(1812.0767)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.67366886138916 seconds
19 rew tensor(0.5612, dtype=torch.float64) delta_t tensor(-0.8541, dtype=torch.float64)
19 gae_duplicate tensor(-1.4860, dtype=torch.float64) tensor(5.5679, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4017, dtype=torch.float64) delta_t tensor(0.5376, dtype=torch.float64)
18 gae_duplicate tensor(-0.9458, dtype=torch.float64) tensor(-0.8308, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5608, dtype=torch.float64) delta_t tensor(0.2357, dtype=torch.float64)
17 gae_duplicate tensor(-0.4904, dtype=torch.float64) tensor(-1.0735, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3843, dtype=torch.float64) delta_t tensor(0.4116, dtype=torch.float64)
16 gae_duplicate tensor(-0.4227, dtype=torch.float64) tensor(-2.4279, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5410, dtype=torch.float64) delta_t tensor(0.5533, dtype=torch.float64)
15 gae_duplicate tensor(-0.8514, dtype=torch.float64) tensor(-1.7844, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7295, dtype=torch.float64) delta_t tensor(0.9244, dtype=torch.float64)
14 gae_duplicate tensor(-0.2088, dtype=torch.float64) tensor(-15.7735, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6671, dtype=torch.float64) delta_t tensor(0.1714, dtype=torch.float64)
13 gae_duplicate tensor(0.3511, dtype=torch.float64) tensor(-8.1961, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6039, dtype=torch.float64) delta_t tensor(0.4557, dtype=torch.float64)
12 gae_duplicate tensor(0.7991, dtype=torch.float64) tensor(-11.0294, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2373, dtype=torch.float64) delta_t tensor(-0.2600, dtype=torch.float64)
11 gae_duplicate tensor(-0.6605, dtype=torch.float64) tensor(-0.6259, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4935, dtype=torch.float64) delta_t tensor(0.0852, dtype=torch.float64)
10 gae_duplicate tensor(-0.3648, dtype=torch.float64) tensor(-8.0734, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6290, dtype=torch.float64) delta_t tensor(-0.7085, dtype=torch.float64)
9 gae_duplicate tensor(-2.0773, dtype=torch.float64) tensor(4.4304, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1651, dtype=torch.float64) delta_t tensor(-0.2680, dtype=torch.float64)
8 gae_duplicate tensor(-1.6985, dtype=torch.float64) tensor(4.4406, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0476, dtype=torch.float64) delta_t tensor(-0.2150, dtype=torch.float64)
7 gae_duplicate tensor(-1.6313, dtype=torch.float64) tensor(0.5681, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5310, dtype=torch.float64) delta_t tensor(0.0205, dtype=torch.float64)
6 gae_duplicate tensor(-1.0172, dtype=torch.float64) tensor(0.6002, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6195, dtype=torch.float64) delta_t tensor(-0.1314, dtype=torch.float64)
5 gae_duplicate tensor(-2.5072, dtype=torch.float64) tensor(0.9783, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8969, dtype=torch.float64) delta_t tensor(-0.5080, dtype=torch.float64)
4 gae_duplicate tensor(-5.3995, dtype=torch.float64) tensor(1.1823, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0988, dtype=torch.float64) delta_t tensor(0.2442, dtype=torch.float64)
3 gae_duplicate tensor(-4.1180, dtype=torch.float64) tensor(8.4587, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2688, dtype=torch.float64) delta_t tensor(-0.0357, dtype=torch.float64)
2 gae_duplicate tensor(-3.1231, dtype=torch.float64) tensor(0.5866, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:809.2737426757812
value loss:299.0511779785156
entropies:104.38558197021484
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.750571966171265 seconds
19 rew tensor(0.3374, dtype=torch.float64) delta_t tensor(-0.5603, dtype=torch.float64)
19 gae_duplicate tensor(-1.1343, dtype=torch.float64) tensor(3.5644, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4787, dtype=torch.float64) delta_t tensor(0.4560, dtype=torch.float64)
18 gae_duplicate tensor(-0.8396, dtype=torch.float64) tensor(-0.5820, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7115, dtype=torch.float64) delta_t tensor(0.5712, dtype=torch.float64)
17 gae_duplicate tensor(-0.3452, dtype=torch.float64) tensor(-1.0250, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6801, dtype=torch.float64) delta_t tensor(0.4401, dtype=torch.float64)
16 gae_duplicate tensor(-0.1342, dtype=torch.float64) tensor(-2.9151, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6568, dtype=torch.float64) delta_t tensor(0.4977, dtype=torch.float64)
15 gae_duplicate tensor(0.0770, dtype=torch.float64) tensor(-2.3130, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5863, dtype=torch.float64) delta_t tensor(0.2591, dtype=torch.float64)
14 gae_duplicate tensor(0.2281, dtype=torch.float64) tensor(-5.7117, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6656, dtype=torch.float64) delta_t tensor(0.3281, dtype=torch.float64)
13 gae_duplicate tensor(0.6754, dtype=torch.float64) tensor(-4.3439, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3428, dtype=torch.float64) delta_t tensor(0.3543, dtype=torch.float64)
12 gae_duplicate tensor(0.3832, dtype=torch.float64) tensor(-6.0910, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1774, dtype=torch.float64) delta_t tensor(-0.1007, dtype=torch.float64)
11 gae_duplicate tensor(-3.0676, dtype=torch.float64) tensor(2.3260, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3049, dtype=torch.float64) delta_t tensor(-0.4517, dtype=torch.float64)
10 gae_duplicate tensor(-2.8090, dtype=torch.float64) tensor(5.2537, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4775, dtype=torch.float64) delta_t tensor(-0.7286, dtype=torch.float64)
9 gae_duplicate tensor(-2.6844, dtype=torch.float64) tensor(-8.5393, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3429, dtype=torch.float64) delta_t tensor(-0.2433, dtype=torch.float64)
8 gae_duplicate tensor(-2.0083, dtype=torch.float64) tensor(1.8234, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0711, dtype=torch.float64) delta_t tensor(-0.2965, dtype=torch.float64)
7 gae_duplicate tensor(-1.7117, dtype=torch.float64) tensor(3.7004, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5685, dtype=torch.float64) delta_t tensor(-0.2045, dtype=torch.float64)
6 gae_duplicate tensor(-3.2714, dtype=torch.float64) tensor(1.1854, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1076, dtype=torch.float64) delta_t tensor(-0.4649, dtype=torch.float64)
5 gae_duplicate tensor(-4.1301, dtype=torch.float64) tensor(1.9783, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4672, dtype=torch.float64) delta_t tensor(-3.3741, dtype=torch.float64)
4 gae_duplicate tensor(-9.2961, dtype=torch.float64) tensor(7.7674, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1289, dtype=torch.float64) delta_t tensor(0.1364, dtype=torch.float64)
3 gae_duplicate tensor(-6.9118, dtype=torch.float64) tensor(5.6511, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1763, dtype=torch.float64) delta_t tensor(-0.0502, dtype=torch.float64)
2 gae_duplicate tensor(-5.5939, dtype=torch.float64) tensor(25.0029, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-980.6710205078125
value loss:995.44921875
entropies:101.79420471191406
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.098003149032593 seconds
19 rew tensor(0.6714, dtype=torch.float64) delta_t tensor(-0.8639, dtype=torch.float64)
19 gae_duplicate tensor(-1.0856, dtype=torch.float64) tensor(3.0780, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6396, dtype=torch.float64) delta_t tensor(0.3792, dtype=torch.float64)
18 gae_duplicate tensor(-0.5369, dtype=torch.float64) tensor(0.7290, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5854, dtype=torch.float64) delta_t tensor(0.3140, dtype=torch.float64)
17 gae_duplicate tensor(-0.2357, dtype=torch.float64) tensor(-1.1822, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4588, dtype=torch.float64) delta_t tensor(0.2552, dtype=torch.float64)
16 gae_duplicate tensor(-0.0041, dtype=torch.float64) tensor(-0.5392, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1665, dtype=torch.float64) delta_t tensor(0.2464, dtype=torch.float64)
15 gae_duplicate tensor(-0.1579, dtype=torch.float64) tensor(-6.4642, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6323, dtype=torch.float64) delta_t tensor(0.5419, dtype=torch.float64)
14 gae_duplicate tensor(0.3862, dtype=torch.float64) tensor(-7.8171, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4143, dtype=torch.float64) delta_t tensor(-0.0398, dtype=torch.float64)
13 gae_duplicate tensor(-0.6968, dtype=torch.float64) tensor(-2.7329, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2346, dtype=torch.float64) delta_t tensor(0.1891, dtype=torch.float64)
12 gae_duplicate tensor(-0.1012, dtype=torch.float64) tensor(-4.8399, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7710, dtype=torch.float64) delta_t tensor(-0.7604, dtype=torch.float64)
11 gae_duplicate tensor(-3.1041, dtype=torch.float64) tensor(2.1766, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3993, dtype=torch.float64) delta_t tensor(-0.1313, dtype=torch.float64)
10 gae_duplicate tensor(-2.7404, dtype=torch.float64) tensor(2.4400, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4125, dtype=torch.float64) delta_t tensor(0.5805, dtype=torch.float64)
9 gae_duplicate tensor(-1.2432, dtype=torch.float64) tensor(-7.1791, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2283, dtype=torch.float64) delta_t tensor(-0.3249, dtype=torch.float64)
8 gae_duplicate tensor(-1.3485, dtype=torch.float64) tensor(1.7700, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5339, dtype=torch.float64) delta_t tensor(-0.3390, dtype=torch.float64)
7 gae_duplicate tensor(-1.6939, dtype=torch.float64) tensor(8.1533, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1554, dtype=torch.float64) delta_t tensor(0.4170, dtype=torch.float64)
6 gae_duplicate tensor(-2.0501, dtype=torch.float64) tensor(-0.5184, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2485, dtype=torch.float64) delta_t tensor(-0.8487, dtype=torch.float64)
5 gae_duplicate tensor(-2.7817, dtype=torch.float64) tensor(1.2555, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0029, dtype=torch.float64) delta_t tensor(0.1882, dtype=torch.float64)
4 gae_duplicate tensor(-4.6333, dtype=torch.float64) tensor(10.8615, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6633, dtype=torch.float64) delta_t tensor(-0.1152, dtype=torch.float64)
3 gae_duplicate tensor(-3.9134, dtype=torch.float64) tensor(7.9820, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0647, dtype=torch.float64) delta_t tensor(-0.2406, dtype=torch.float64)
2 gae_duplicate tensor(-2.6028, dtype=torch.float64) tensor(1.0202, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-313.18463134765625
value loss:225.09396362304688
entropies:101.30237579345703
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.9437220096588135 seconds
19 rew tensor(0.5468, dtype=torch.float64) delta_t tensor(-0.4394, dtype=torch.float64)
19 gae_duplicate tensor(-1.9471, dtype=torch.float64) tensor(0.7866, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7122, dtype=torch.float64) delta_t tensor(0.5705, dtype=torch.float64)
18 gae_duplicate tensor(-1.1383, dtype=torch.float64) tensor(0.4609, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6497, dtype=torch.float64) delta_t tensor(0.5166, dtype=torch.float64)
17 gae_duplicate tensor(-0.5121, dtype=torch.float64) tensor(-9.4168, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5722, dtype=torch.float64) delta_t tensor(0.0905, dtype=torch.float64)
16 gae_duplicate tensor(-0.2193, dtype=torch.float64) tensor(-9.5775, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7129, dtype=torch.float64) delta_t tensor(0.5681, dtype=torch.float64)
15 gae_duplicate tensor(0.2170, dtype=torch.float64) tensor(-9.4980, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6982, dtype=torch.float64) delta_t tensor(0.4407, dtype=torch.float64)
14 gae_duplicate tensor(0.2415, dtype=torch.float64) tensor(-2.7295, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6607, dtype=torch.float64) delta_t tensor(0.4561, dtype=torch.float64)
13 gae_duplicate tensor(0.1253, dtype=torch.float64) tensor(-3.0647, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7052, dtype=torch.float64) delta_t tensor(0.6252, dtype=torch.float64)
12 gae_duplicate tensor(0.4641, dtype=torch.float64) tensor(-3.0524, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2041, dtype=torch.float64) delta_t tensor(-0.5754, dtype=torch.float64)
11 gae_duplicate tensor(-1.3663, dtype=torch.float64) tensor(8.1947, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2180, dtype=torch.float64) delta_t tensor(-0.0532, dtype=torch.float64)
10 gae_duplicate tensor(-2.6714, dtype=torch.float64) tensor(-0.2644, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4760, dtype=torch.float64) delta_t tensor(-0.8784, dtype=torch.float64)
9 gae_duplicate tensor(-3.4503, dtype=torch.float64) tensor(3.5355, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5538, dtype=torch.float64) delta_t tensor(-0.5141, dtype=torch.float64)
8 gae_duplicate tensor(-1.8550, dtype=torch.float64) tensor(-5.0973, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5701, dtype=torch.float64) delta_t tensor(-0.7962, dtype=torch.float64)
7 gae_duplicate tensor(-2.8271, dtype=torch.float64) tensor(5.6881, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1563, dtype=torch.float64) delta_t tensor(-0.8966, dtype=torch.float64)
6 gae_duplicate tensor(-3.6368, dtype=torch.float64) tensor(13.6031, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1696, dtype=torch.float64) delta_t tensor(-0.7870, dtype=torch.float64)
5 gae_duplicate tensor(-4.4194, dtype=torch.float64) tensor(25.2726, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3492, dtype=torch.float64) delta_t tensor(-1.9749, dtype=torch.float64)
4 gae_duplicate tensor(-7.6903, dtype=torch.float64) tensor(7.7331, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0715, dtype=torch.float64) delta_t tensor(0.4496, dtype=torch.float64)
3 gae_duplicate tensor(-5.9846, dtype=torch.float64) tensor(18.1797, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3438, dtype=torch.float64) delta_t tensor(0.2533, dtype=torch.float64)
2 gae_duplicate tensor(-4.6576, dtype=torch.float64) tensor(29.4924, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2546.872802734375
value loss:825.3934326171875
entropies:100.08759307861328
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5579750537872314 seconds
19 rew tensor(0.7345, dtype=torch.float64) delta_t tensor(-0.7822, dtype=torch.float64)
19 gae_duplicate tensor(-1.2172, dtype=torch.float64) tensor(3.3201, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7266, dtype=torch.float64) delta_t tensor(0.3327, dtype=torch.float64)
18 gae_duplicate tensor(-0.6914, dtype=torch.float64) tensor(0.4989, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6952, dtype=torch.float64) delta_t tensor(0.5487, dtype=torch.float64)
17 gae_duplicate tensor(-0.3777, dtype=torch.float64) tensor(-0.4227, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5523, dtype=torch.float64) delta_t tensor(0.4488, dtype=torch.float64)
16 gae_duplicate tensor(-0.4691, dtype=torch.float64) tensor(-2.2050, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4336, dtype=torch.float64) delta_t tensor(0.6839, dtype=torch.float64)
15 gae_duplicate tensor(-0.3437, dtype=torch.float64) tensor(-9.1289, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4349, dtype=torch.float64) delta_t tensor(0.3577, dtype=torch.float64)
14 gae_duplicate tensor(-0.1726, dtype=torch.float64) tensor(-5.1321, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6894, dtype=torch.float64) delta_t tensor(0.3231, dtype=torch.float64)
13 gae_duplicate tensor(0.0634, dtype=torch.float64) tensor(-5.2718, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5714, dtype=torch.float64) delta_t tensor(0.3345, dtype=torch.float64)
12 gae_duplicate tensor(0.0719, dtype=torch.float64) tensor(-15.1463, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0717, dtype=torch.float64) delta_t tensor(-0.2512, dtype=torch.float64)
11 gae_duplicate tensor(-0.1447, dtype=torch.float64) tensor(-2.8830, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.8937, dtype=torch.float64) delta_t tensor(-2.3593, dtype=torch.float64)
10 gae_duplicate tensor(-5.9786, dtype=torch.float64) tensor(2.7544, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0336, dtype=torch.float64) delta_t tensor(-0.2347, dtype=torch.float64)
9 gae_duplicate tensor(-7.1718, dtype=torch.float64) tensor(3.8470, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7901, dtype=torch.float64) delta_t tensor(-0.8637, dtype=torch.float64)
8 gae_duplicate tensor(-5.6853, dtype=torch.float64) tensor(4.1724, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1071, dtype=torch.float64) delta_t tensor(0.1919, dtype=torch.float64)
7 gae_duplicate tensor(-4.5504, dtype=torch.float64) tensor(16.9611, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0878, dtype=torch.float64) delta_t tensor(0.2413, dtype=torch.float64)
6 gae_duplicate tensor(-3.0009, dtype=torch.float64) tensor(-0.9491, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0234, dtype=torch.float64) delta_t tensor(0.3527, dtype=torch.float64)
5 gae_duplicate tensor(-2.3174, dtype=torch.float64) tensor(5.8640, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0656, dtype=torch.float64) delta_t tensor(0.1330, dtype=torch.float64)
4 gae_duplicate tensor(-1.4182, dtype=torch.float64) tensor(-1.5641, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1711, dtype=torch.float64) delta_t tensor(0.4717, dtype=torch.float64)
3 gae_duplicate tensor(-0.7936, dtype=torch.float64) tensor(-1.0796, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5656, dtype=torch.float64) delta_t tensor(-0.4843, dtype=torch.float64)
2 gae_duplicate tensor(-1.7220, dtype=torch.float64) tensor(-0.2044, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:218.31732177734375
value loss:532.8026733398438
entropies:100.93495178222656
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1813.9259)
ToM Target loss= tensor(1805.2745)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.789423704147339 seconds
19 rew tensor(0.7193, dtype=torch.float64) delta_t tensor(-0.5311, dtype=torch.float64)
19 gae_duplicate tensor(-1.1955, dtype=torch.float64) tensor(5.1021, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6960, dtype=torch.float64) delta_t tensor(0.5490, dtype=torch.float64)
18 gae_duplicate tensor(-0.5986, dtype=torch.float64) tensor(1.1580, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6418, dtype=torch.float64) delta_t tensor(0.1754, dtype=torch.float64)
17 gae_duplicate tensor(-0.2397, dtype=torch.float64) tensor(0.0653, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5324, dtype=torch.float64) delta_t tensor(0.2070, dtype=torch.float64)
16 gae_duplicate tensor(-0.2847, dtype=torch.float64) tensor(-4.6529, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2093, dtype=torch.float64) delta_t tensor(0.2711, dtype=torch.float64)
15 gae_duplicate tensor(-0.2439, dtype=torch.float64) tensor(-1.5856, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6665, dtype=torch.float64) delta_t tensor(0.4497, dtype=torch.float64)
14 gae_duplicate tensor(0.3401, dtype=torch.float64) tensor(-8.3518, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2084, dtype=torch.float64) delta_t tensor(0.0777, dtype=torch.float64)
13 gae_duplicate tensor(-1.6347, dtype=torch.float64) tensor(-1.3891, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.9380, dtype=torch.float64) delta_t tensor(-1.1299, dtype=torch.float64)
12 gae_duplicate tensor(-6.7723, dtype=torch.float64) tensor(0.7554, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4283, dtype=torch.float64) delta_t tensor(0.3902, dtype=torch.float64)
11 gae_duplicate tensor(-5.4653, dtype=torch.float64) tensor(-0.1955, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3247, dtype=torch.float64) delta_t tensor(-0.8785, dtype=torch.float64)
10 gae_duplicate tensor(-4.5091, dtype=torch.float64) tensor(9.5284, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2014, dtype=torch.float64) delta_t tensor(0.2302, dtype=torch.float64)
9 gae_duplicate tensor(-3.1018, dtype=torch.float64) tensor(-1.0514, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3618, dtype=torch.float64) delta_t tensor(0.2061, dtype=torch.float64)
8 gae_duplicate tensor(-1.8889, dtype=torch.float64) tensor(-2.4304, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3641, dtype=torch.float64) delta_t tensor(0.0241, dtype=torch.float64)
7 gae_duplicate tensor(-1.6389, dtype=torch.float64) tensor(0.0707, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5551, dtype=torch.float64) delta_t tensor(0.7492, dtype=torch.float64)
6 gae_duplicate tensor(-0.6171, dtype=torch.float64) tensor(-1.4386, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7534, dtype=torch.float64) delta_t tensor(-0.3900, dtype=torch.float64)
5 gae_duplicate tensor(-0.4848, dtype=torch.float64) tensor(-0.6033, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1934, dtype=torch.float64) delta_t tensor(0.6868, dtype=torch.float64)
4 gae_duplicate tensor(-0.0011, dtype=torch.float64) tensor(-2.6805, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7622, dtype=torch.float64) delta_t tensor(-0.6723, dtype=torch.float64)
3 gae_duplicate tensor(-2.6847, dtype=torch.float64) tensor(-0.0432, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0151, dtype=torch.float64) delta_t tensor(-0.2903, dtype=torch.float64)
2 gae_duplicate tensor(-2.3245, dtype=torch.float64) tensor(0.5110, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:242.3962860107422
value loss:354.6485290527344
entropies:99.59672546386719
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.673179864883423 seconds
19 rew tensor(0.6334, dtype=torch.float64) delta_t tensor(-0.6115, dtype=torch.float64)
19 gae_duplicate tensor(-1.7755, dtype=torch.float64) tensor(3.9846, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5397, dtype=torch.float64) delta_t tensor(0.3222, dtype=torch.float64)
18 gae_duplicate tensor(-1.9851, dtype=torch.float64) tensor(1.6469, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7193, dtype=torch.float64) delta_t tensor(0.4426, dtype=torch.float64)
17 gae_duplicate tensor(-1.1617, dtype=torch.float64) tensor(-9.2559, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6721, dtype=torch.float64) delta_t tensor(0.2803, dtype=torch.float64)
16 gae_duplicate tensor(-0.5028, dtype=torch.float64) tensor(0.2462, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5856, dtype=torch.float64) delta_t tensor(0.5919, dtype=torch.float64)
15 gae_duplicate tensor(-0.3846, dtype=torch.float64) tensor(-1.5953, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6804, dtype=torch.float64) delta_t tensor(0.2492, dtype=torch.float64)
14 gae_duplicate tensor(0.3870, dtype=torch.float64) tensor(-6.6968, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3997, dtype=torch.float64) delta_t tensor(0.0865, dtype=torch.float64)
13 gae_duplicate tensor(-1.6168, dtype=torch.float64) tensor(-1.8115, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4604, dtype=torch.float64) delta_t tensor(0.2816, dtype=torch.float64)
12 gae_duplicate tensor(-1.4889, dtype=torch.float64) tensor(5.2794, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3061, dtype=torch.float64) delta_t tensor(0.1088, dtype=torch.float64)
11 gae_duplicate tensor(-0.9982, dtype=torch.float64) tensor(-1.5579, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2540, dtype=torch.float64) delta_t tensor(-0.6645, dtype=torch.float64)
10 gae_duplicate tensor(-1.6182, dtype=torch.float64) tensor(-6.1966, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0452, dtype=torch.float64) delta_t tensor(-0.0240, dtype=torch.float64)
9 gae_duplicate tensor(-2.0750, dtype=torch.float64) tensor(-0.5386, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1335, dtype=torch.float64) delta_t tensor(-0.0753, dtype=torch.float64)
8 gae_duplicate tensor(-1.1356, dtype=torch.float64) tensor(0.1164, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1104, dtype=torch.float64) delta_t tensor(-0.3253, dtype=torch.float64)
7 gae_duplicate tensor(-1.2405, dtype=torch.float64) tensor(4.2861, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6387, dtype=torch.float64) delta_t tensor(-0.3262, dtype=torch.float64)
6 gae_duplicate tensor(-2.4909, dtype=torch.float64) tensor(0.2865, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8563, dtype=torch.float64) delta_t tensor(-0.3061, dtype=torch.float64)
5 gae_duplicate tensor(-3.3901, dtype=torch.float64) tensor(4.0452, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1060, dtype=torch.float64) delta_t tensor(-0.6270, dtype=torch.float64)
4 gae_duplicate tensor(-5.3742, dtype=torch.float64) tensor(-0.3273, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1815, dtype=torch.float64) delta_t tensor(0.0203, dtype=torch.float64)
3 gae_duplicate tensor(-4.8629, dtype=torch.float64) tensor(1.7266, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2214, dtype=torch.float64) delta_t tensor(-0.4021, dtype=torch.float64)
2 gae_duplicate tensor(-4.8157, dtype=torch.float64) tensor(0.2351, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:202.879150390625
value loss:464.8657531738281
entropies:98.30354309082031
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.043068885803223 seconds
19 rew tensor(0.7191, dtype=torch.float64) delta_t tensor(-0.7925, dtype=torch.float64)
19 gae_duplicate tensor(-1.1760, dtype=torch.float64) tensor(3.5366, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6725, dtype=torch.float64) delta_t tensor(0.1852, dtype=torch.float64)
18 gae_duplicate tensor(-0.8066, dtype=torch.float64) tensor(3.7599, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6184, dtype=torch.float64) delta_t tensor(0.3230, dtype=torch.float64)
17 gae_duplicate tensor(-0.5303, dtype=torch.float64) tensor(-1.4024, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4627, dtype=torch.float64) delta_t tensor(0.1985, dtype=torch.float64)
16 gae_duplicate tensor(-0.6517, dtype=torch.float64) tensor(-4.1350, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2372, dtype=torch.float64) delta_t tensor(0.2894, dtype=torch.float64)
15 gae_duplicate tensor(-1.2032, dtype=torch.float64) tensor(-4.7371, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7507, dtype=torch.float64) delta_t tensor(0.5864, dtype=torch.float64)
14 gae_duplicate tensor(-0.5874, dtype=torch.float64) tensor(-5.8552, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7509, dtype=torch.float64) delta_t tensor(0.4180, dtype=torch.float64)
13 gae_duplicate tensor(-0.0946, dtype=torch.float64) tensor(-1.9737, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7510, dtype=torch.float64) delta_t tensor(0.7419, dtype=torch.float64)
12 gae_duplicate tensor(0.4899, dtype=torch.float64) tensor(-9.1554, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.1899, dtype=torch.float64) delta_t tensor(-1.3180, dtype=torch.float64)
11 gae_duplicate tensor(-3.7153, dtype=torch.float64) tensor(-7.8757, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2527, dtype=torch.float64) delta_t tensor(-1.0549, dtype=torch.float64)
10 gae_duplicate tensor(-5.3245, dtype=torch.float64) tensor(0.3805, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1952, dtype=torch.float64) delta_t tensor(0.0773, dtype=torch.float64)
9 gae_duplicate tensor(-3.9506, dtype=torch.float64) tensor(5.3101, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1901, dtype=torch.float64) delta_t tensor(-0.4021, dtype=torch.float64)
8 gae_duplicate tensor(-3.0176, dtype=torch.float64) tensor(1.7416, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1999, dtype=torch.float64) delta_t tensor(-1.0795, dtype=torch.float64)
7 gae_duplicate tensor(-4.8892, dtype=torch.float64) tensor(8.8073, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2916, dtype=torch.float64) delta_t tensor(-0.1324, dtype=torch.float64)
6 gae_duplicate tensor(-4.7075, dtype=torch.float64) tensor(12.8156, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1043, dtype=torch.float64) delta_t tensor(-0.5288, dtype=torch.float64)
5 gae_duplicate tensor(-5.0552, dtype=torch.float64) tensor(4.0340, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4037, dtype=torch.float64) delta_t tensor(-0.0318, dtype=torch.float64)
4 gae_duplicate tensor(-7.2258, dtype=torch.float64) tensor(13.3805, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4820, dtype=torch.float64) delta_t tensor(0.0754, dtype=torch.float64)
3 gae_duplicate tensor(-4.8997, dtype=torch.float64) tensor(9.2975, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1204, dtype=torch.float64) delta_t tensor(-0.2906, dtype=torch.float64)
2 gae_duplicate tensor(-3.9153, dtype=torch.float64) tensor(2.0497, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1097.0792236328125
value loss:649.164794921875
entropies:99.08944702148438
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.696192979812622 seconds
19 rew tensor(0.7426, dtype=torch.float64) delta_t tensor(0.0464, dtype=torch.float64)
19 gae_duplicate tensor(-1.1649, dtype=torch.float64) tensor(-3.5162, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7268, dtype=torch.float64) delta_t tensor(0.3795, dtype=torch.float64)
18 gae_duplicate tensor(-0.5642, dtype=torch.float64) tensor(-5.6674, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6952, dtype=torch.float64) delta_t tensor(0.4864, dtype=torch.float64)
17 gae_duplicate tensor(-0.1338, dtype=torch.float64) tensor(-2.6652, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6481, dtype=torch.float64) delta_t tensor(0.6338, dtype=torch.float64)
16 gae_duplicate tensor(-0.0246, dtype=torch.float64) tensor(-15.7597, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5931, dtype=torch.float64) delta_t tensor(0.2226, dtype=torch.float64)
15 gae_duplicate tensor(0.0732, dtype=torch.float64) tensor(-10.9697, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6876, dtype=torch.float64) delta_t tensor(0.5306, dtype=torch.float64)
14 gae_duplicate tensor(0.5835, dtype=torch.float64) tensor(-9.6895, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.5516, dtype=torch.float64) delta_t tensor(-0.5336, dtype=torch.float64)
13 gae_duplicate tensor(-2.4033, dtype=torch.float64) tensor(-1.4746, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6264, dtype=torch.float64) delta_t tensor(0.3239, dtype=torch.float64)
12 gae_duplicate tensor(-1.3339, dtype=torch.float64) tensor(0.7230, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2508, dtype=torch.float64) delta_t tensor(0.2086, dtype=torch.float64)
11 gae_duplicate tensor(-0.4221, dtype=torch.float64) tensor(-8.4455, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2800, dtype=torch.float64) delta_t tensor(-0.2414, dtype=torch.float64)
10 gae_duplicate tensor(-0.6074, dtype=torch.float64) tensor(-0.9058, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9777, dtype=torch.float64) delta_t tensor(-0.8220, dtype=torch.float64)
9 gae_duplicate tensor(-2.0645, dtype=torch.float64) tensor(1.3767, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0539, dtype=torch.float64) delta_t tensor(-0.5500, dtype=torch.float64)
8 gae_duplicate tensor(-1.7984, dtype=torch.float64) tensor(2.2998, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5289, dtype=torch.float64) delta_t tensor(0.0607, dtype=torch.float64)
7 gae_duplicate tensor(-2.9520, dtype=torch.float64) tensor(6.1296, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2162, dtype=torch.float64) delta_t tensor(0.1563, dtype=torch.float64)
6 gae_duplicate tensor(-4.0978, dtype=torch.float64) tensor(-1.1438, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9729, dtype=torch.float64) delta_t tensor(-0.3407, dtype=torch.float64)
5 gae_duplicate tensor(-4.5422, dtype=torch.float64) tensor(11.5873, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0362, dtype=torch.float64) delta_t tensor(0.2554, dtype=torch.float64)
4 gae_duplicate tensor(-5.7969, dtype=torch.float64) tensor(-1.6958, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5096, dtype=torch.float64) delta_t tensor(-0.0008, dtype=torch.float64)
3 gae_duplicate tensor(-4.5333, dtype=torch.float64) tensor(-5.4156, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1279, dtype=torch.float64) delta_t tensor(-0.1234, dtype=torch.float64)
2 gae_duplicate tensor(-3.1997, dtype=torch.float64) tensor(2.3538, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1525.5185546875
value loss:438.6867370605469
entropies:100.60895538330078
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.6607232093811035 seconds
19 rew tensor(0.7503, dtype=torch.float64) delta_t tensor(-0.8972, dtype=torch.float64)
19 gae_duplicate tensor(-1.0843, dtype=torch.float64) tensor(6.4602, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7504, dtype=torch.float64) delta_t tensor(0.5686, dtype=torch.float64)
18 gae_duplicate tensor(-0.4859, dtype=torch.float64) tensor(1.3945, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7506, dtype=torch.float64) delta_t tensor(0.4542, dtype=torch.float64)
17 gae_duplicate tensor(-0.1347, dtype=torch.float64) tensor(-4.8622, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7507, dtype=torch.float64) delta_t tensor(0.6356, dtype=torch.float64)
16 gae_duplicate tensor(0.4364, dtype=torch.float64) tensor(-7.4052, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5552, dtype=torch.float64) delta_t tensor(1.1282, dtype=torch.float64)
15 gae_duplicate tensor(0.9554, dtype=torch.float64) tensor(-9.5744, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5920, dtype=torch.float64) delta_t tensor(0.3285, dtype=torch.float64)
14 gae_duplicate tensor(1.1988, dtype=torch.float64) tensor(-17.8701, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5759, dtype=torch.float64) delta_t tensor(0.5086, dtype=torch.float64)
13 gae_duplicate tensor(1.1115, dtype=torch.float64) tensor(-9.7778, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2686, dtype=torch.float64) delta_t tensor(-0.4663, dtype=torch.float64)
12 gae_duplicate tensor(-0.7698, dtype=torch.float64) tensor(-15.6476, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1100, dtype=torch.float64) delta_t tensor(-0.0998, dtype=torch.float64)
11 gae_duplicate tensor(-2.0932, dtype=torch.float64) tensor(-5.7752, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1397, dtype=torch.float64) delta_t tensor(-0.9039, dtype=torch.float64)
10 gae_duplicate tensor(-2.1659, dtype=torch.float64) tensor(-3.5370, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9303, dtype=torch.float64) delta_t tensor(-1.1063, dtype=torch.float64)
9 gae_duplicate tensor(-4.9346, dtype=torch.float64) tensor(1.8616, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2946, dtype=torch.float64) delta_t tensor(-0.1092, dtype=torch.float64)
8 gae_duplicate tensor(-5.8004, dtype=torch.float64) tensor(1.8029, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1442, dtype=torch.float64) delta_t tensor(-0.1249, dtype=torch.float64)
7 gae_duplicate tensor(-3.9079, dtype=torch.float64) tensor(9.1385, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0131, dtype=torch.float64) delta_t tensor(0.5681, dtype=torch.float64)
6 gae_duplicate tensor(-2.4102, dtype=torch.float64) tensor(-2.1617, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3879, dtype=torch.float64) delta_t tensor(0.0213, dtype=torch.float64)
5 gae_duplicate tensor(-1.7646, dtype=torch.float64) tensor(-0.4102, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0447, dtype=torch.float64) delta_t tensor(0.1482, dtype=torch.float64)
4 gae_duplicate tensor(-1.1493, dtype=torch.float64) tensor(-0.0783, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4032, dtype=torch.float64) delta_t tensor(0.1422, dtype=torch.float64)
3 gae_duplicate tensor(-0.7427, dtype=torch.float64) tensor(1.2276, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1511, dtype=torch.float64) delta_t tensor(-0.2960, dtype=torch.float64)
2 gae_duplicate tensor(-0.7435, dtype=torch.float64) tensor(2.2190, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1890.1524658203125
value loss:380.75567626953125
entropies:98.22618103027344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1734.8156)
ToM Target loss= tensor(1803.9592)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.858222961425781 seconds
19 rew tensor(0.6954, dtype=torch.float64) delta_t tensor(-0.9182, dtype=torch.float64)
19 gae_duplicate tensor(-1.1774, dtype=torch.float64) tensor(5.5847, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6560, dtype=torch.float64) delta_t tensor(0.4521, dtype=torch.float64)
18 gae_duplicate tensor(-0.6921, dtype=torch.float64) tensor(1.7310, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6472, dtype=torch.float64) delta_t tensor(0.4206, dtype=torch.float64)
17 gae_duplicate tensor(-0.5281, dtype=torch.float64) tensor(-0.2771, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5359, dtype=torch.float64) delta_t tensor(0.2397, dtype=torch.float64)
16 gae_duplicate tensor(-0.4960, dtype=torch.float64) tensor(0.9893, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3850, dtype=torch.float64) delta_t tensor(0.5150, dtype=torch.float64)
15 gae_duplicate tensor(-0.3820, dtype=torch.float64) tensor(-1.3682, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6628, dtype=torch.float64) delta_t tensor(0.5960, dtype=torch.float64)
14 gae_duplicate tensor(-0.0252, dtype=torch.float64) tensor(-7.1799, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6636, dtype=torch.float64) delta_t tensor(0.3648, dtype=torch.float64)
13 gae_duplicate tensor(0.2858, dtype=torch.float64) tensor(-7.2565, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2757, dtype=torch.float64) delta_t tensor(0.1201, dtype=torch.float64)
12 gae_duplicate tensor(-0.9520, dtype=torch.float64) tensor(-5.1741, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1252, dtype=torch.float64) delta_t tensor(0.0245, dtype=torch.float64)
11 gae_duplicate tensor(-3.0522, dtype=torch.float64) tensor(-7.4722, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.1034, dtype=torch.float64) delta_t tensor(-1.8028, dtype=torch.float64)
10 gae_duplicate tensor(-5.6640, dtype=torch.float64) tensor(0.6613, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1192, dtype=torch.float64) delta_t tensor(-0.0515, dtype=torch.float64)
9 gae_duplicate tensor(-5.6612, dtype=torch.float64) tensor(0.2613, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4441, dtype=torch.float64) delta_t tensor(-0.3842, dtype=torch.float64)
8 gae_duplicate tensor(-3.7996, dtype=torch.float64) tensor(15.9015, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1498, dtype=torch.float64) delta_t tensor(0.1620, dtype=torch.float64)
7 gae_duplicate tensor(-2.4691, dtype=torch.float64) tensor(1.4236, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5009, dtype=torch.float64) delta_t tensor(-0.2856, dtype=torch.float64)
6 gae_duplicate tensor(-2.2097, dtype=torch.float64) tensor(0.6103, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0052, dtype=torch.float64) delta_t tensor(-0.4146, dtype=torch.float64)
5 gae_duplicate tensor(-4.7914, dtype=torch.float64) tensor(6.4030, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2880, dtype=torch.float64) delta_t tensor(-0.0882, dtype=torch.float64)
4 gae_duplicate tensor(-6.1729, dtype=torch.float64) tensor(0.6507, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4140, dtype=torch.float64) delta_t tensor(0.1329, dtype=torch.float64)
3 gae_duplicate tensor(-3.9075, dtype=torch.float64) tensor(8.2089, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1226, dtype=torch.float64) delta_t tensor(-0.0376, dtype=torch.float64)
2 gae_duplicate tensor(-3.0494, dtype=torch.float64) tensor(2.6589, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-606.7089233398438
value loss:474.60968017578125
entropies:99.33328247070312
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.112421989440918 seconds
19 rew tensor(0.7414, dtype=torch.float64) delta_t tensor(-0.7347, dtype=torch.float64)
19 gae_duplicate tensor(-1.0767, dtype=torch.float64) tensor(1.2253, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7337, dtype=torch.float64) delta_t tensor(0.2942, dtype=torch.float64)
18 gae_duplicate tensor(-0.5370, dtype=torch.float64) tensor(2.8579, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7101, dtype=torch.float64) delta_t tensor(0.7293, dtype=torch.float64)
17 gae_duplicate tensor(0.0024, dtype=torch.float64) tensor(-5.6797, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6787, dtype=torch.float64) delta_t tensor(0.7651, dtype=torch.float64)
16 gae_duplicate tensor(-0.1613, dtype=torch.float64) tensor(-8.3555, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4813, dtype=torch.float64) delta_t tensor(0.6316, dtype=torch.float64)
15 gae_duplicate tensor(-0.1418, dtype=torch.float64) tensor(-2.5653, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6630, dtype=torch.float64) delta_t tensor(0.7495, dtype=torch.float64)
14 gae_duplicate tensor(0.3965, dtype=torch.float64) tensor(-3.4636, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6789, dtype=torch.float64) delta_t tensor(0.4521, dtype=torch.float64)
13 gae_duplicate tensor(0.8274, dtype=torch.float64) tensor(-22.8132, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1345, dtype=torch.float64) delta_t tensor(-0.0754, dtype=torch.float64)
12 gae_duplicate tensor(-1.6683, dtype=torch.float64) tensor(-2.9890, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.2139, dtype=torch.float64) delta_t tensor(-1.4405, dtype=torch.float64)
11 gae_duplicate tensor(-8.2793, dtype=torch.float64) tensor(23.3801, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2976, dtype=torch.float64) delta_t tensor(-0.5001, dtype=torch.float64)
10 gae_duplicate tensor(-7.4215, dtype=torch.float64) tensor(15.1736, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6680, dtype=torch.float64) delta_t tensor(-0.8681, dtype=torch.float64)
9 gae_duplicate tensor(-5.4311, dtype=torch.float64) tensor(6.8377, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1102, dtype=torch.float64) delta_t tensor(-0.2323, dtype=torch.float64)
8 gae_duplicate tensor(-4.0822, dtype=torch.float64) tensor(8.7823, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3797, dtype=torch.float64) delta_t tensor(0.0269, dtype=torch.float64)
7 gae_duplicate tensor(-3.6608, dtype=torch.float64) tensor(11.2297, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2530, dtype=torch.float64) delta_t tensor(0.0254, dtype=torch.float64)
6 gae_duplicate tensor(-2.5063, dtype=torch.float64) tensor(7.3770, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1718, dtype=torch.float64) delta_t tensor(-0.7130, dtype=torch.float64)
5 gae_duplicate tensor(-2.7741, dtype=torch.float64) tensor(2.2804, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0370, dtype=torch.float64) delta_t tensor(-0.4810, dtype=torch.float64)
4 gae_duplicate tensor(-8.0380, dtype=torch.float64) tensor(44.4555, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3764, dtype=torch.float64) delta_t tensor(0.1213, dtype=torch.float64)
3 gae_duplicate tensor(-5.7232, dtype=torch.float64) tensor(5.2261, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2212, dtype=torch.float64) delta_t tensor(-0.2637, dtype=torch.float64)
2 gae_duplicate tensor(-4.4119, dtype=torch.float64) tensor(7.9873, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3292.039794921875
value loss:812.87109375
entropies:99.82034301757812
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.913440942764282 seconds
19 rew tensor(0.7489, dtype=torch.float64) delta_t tensor(-0.6300, dtype=torch.float64)
19 gae_duplicate tensor(-1.1866, dtype=torch.float64) tensor(2.0931, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7490, dtype=torch.float64) delta_t tensor(0.5352, dtype=torch.float64)
18 gae_duplicate tensor(-0.5750, dtype=torch.float64) tensor(-0.0200, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7492, dtype=torch.float64) delta_t tensor(0.5955, dtype=torch.float64)
17 gae_duplicate tensor(-0.0277, dtype=torch.float64) tensor(-1.4348, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7493, dtype=torch.float64) delta_t tensor(0.5045, dtype=torch.float64)
16 gae_duplicate tensor(0.4930, dtype=torch.float64) tensor(-14.0907, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5971, dtype=torch.float64) delta_t tensor(0.6038, dtype=torch.float64)
15 gae_duplicate tensor(0.3249, dtype=torch.float64) tensor(-3.8627, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6734, dtype=torch.float64) delta_t tensor(0.0559, dtype=torch.float64)
14 gae_duplicate tensor(0.3261, dtype=torch.float64) tensor(-1.8840, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6115, dtype=torch.float64) delta_t tensor(0.3092, dtype=torch.float64)
13 gae_duplicate tensor(-0.2716, dtype=torch.float64) tensor(-13.6145, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5338, dtype=torch.float64) delta_t tensor(0.2896, dtype=torch.float64)
12 gae_duplicate tensor(-0.5711, dtype=torch.float64) tensor(-5.4604, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5394, dtype=torch.float64) delta_t tensor(0.3556, dtype=torch.float64)
11 gae_duplicate tensor(0.5375, dtype=torch.float64) tensor(-2.3032, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4108, dtype=torch.float64) delta_t tensor(-0.0832, dtype=torch.float64)
10 gae_duplicate tensor(0.2050, dtype=torch.float64) tensor(-2.1691, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2504, dtype=torch.float64) delta_t tensor(0.0196, dtype=torch.float64)
9 gae_duplicate tensor(-0.0223, dtype=torch.float64) tensor(-5.2280, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1998, dtype=torch.float64) delta_t tensor(-0.1741, dtype=torch.float64)
8 gae_duplicate tensor(-0.3738, dtype=torch.float64) tensor(-1.1262, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6416, dtype=torch.float64) delta_t tensor(-0.5024, dtype=torch.float64)
7 gae_duplicate tensor(-1.3142, dtype=torch.float64) tensor(-4.2377, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1966, dtype=torch.float64) delta_t tensor(-0.2776, dtype=torch.float64)
6 gae_duplicate tensor(-2.4618, dtype=torch.float64) tensor(17.0801, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4292, dtype=torch.float64) delta_t tensor(-0.6527, dtype=torch.float64)
5 gae_duplicate tensor(-3.1744, dtype=torch.float64) tensor(3.9582, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3010, dtype=torch.float64) delta_t tensor(-0.9319, dtype=torch.float64)
4 gae_duplicate tensor(-9.0721, dtype=torch.float64) tensor(38.3870, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3324, dtype=torch.float64) delta_t tensor(0.0280, dtype=torch.float64)
3 gae_duplicate tensor(-6.5713, dtype=torch.float64) tensor(4.4565, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3336, dtype=torch.float64) delta_t tensor(-0.2180, dtype=torch.float64)
2 gae_duplicate tensor(-5.1044, dtype=torch.float64) tensor(2.7235, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-495.33404541015625
value loss:467.48736572265625
entropies:98.40694427490234
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.09740686416626 seconds
19 rew tensor(0.7329, dtype=torch.float64) delta_t tensor(-0.6910, dtype=torch.float64)
19 gae_duplicate tensor(-1.1546, dtype=torch.float64) tensor(5.9667, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7015, dtype=torch.float64) delta_t tensor(0.2108, dtype=torch.float64)
18 gae_duplicate tensor(-0.6259, dtype=torch.float64) tensor(1.3939, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6623, dtype=torch.float64) delta_t tensor(0.2925, dtype=torch.float64)
17 gae_duplicate tensor(-0.2427, dtype=torch.float64) tensor(-1.1851, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5994, dtype=torch.float64) delta_t tensor(0.5977, dtype=torch.float64)
16 gae_duplicate tensor(-0.4099, dtype=torch.float64) tensor(-0.9895, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5050, dtype=torch.float64) delta_t tensor(0.3949, dtype=torch.float64)
15 gae_duplicate tensor(-0.2004, dtype=torch.float64) tensor(-5.3072, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6627, dtype=torch.float64) delta_t tensor(0.5426, dtype=torch.float64)
14 gae_duplicate tensor(0.3982, dtype=torch.float64) tensor(-5.8216, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6786, dtype=torch.float64) delta_t tensor(0.4926, dtype=torch.float64)
13 gae_duplicate tensor(0.8773, dtype=torch.float64) tensor(-2.3760, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6316, dtype=torch.float64) delta_t tensor(0.4138, dtype=torch.float64)
12 gae_duplicate tensor(0.7684, dtype=torch.float64) tensor(-2.5296, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2557, dtype=torch.float64) delta_t tensor(-0.1490, dtype=torch.float64)
11 gae_duplicate tensor(0.0823, dtype=torch.float64) tensor(-4.1756, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1637, dtype=torch.float64) delta_t tensor(-0.4461, dtype=torch.float64)
10 gae_duplicate tensor(-1.9082, dtype=torch.float64) tensor(-6.2218, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3573, dtype=torch.float64) delta_t tensor(-0.7422, dtype=torch.float64)
9 gae_duplicate tensor(-3.1517, dtype=torch.float64) tensor(10.1661, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0301, dtype=torch.float64) delta_t tensor(-0.2853, dtype=torch.float64)
8 gae_duplicate tensor(-2.7813, dtype=torch.float64) tensor(1.4981, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4253, dtype=torch.float64) delta_t tensor(-0.4549, dtype=torch.float64)
7 gae_duplicate tensor(-1.9075, dtype=torch.float64) tensor(1.6096, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3561, dtype=torch.float64) delta_t tensor(-0.2960, dtype=torch.float64)
6 gae_duplicate tensor(-3.2750, dtype=torch.float64) tensor(1.6016, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2297, dtype=torch.float64) delta_t tensor(-0.4364, dtype=torch.float64)
5 gae_duplicate tensor(-3.3770, dtype=torch.float64) tensor(3.4262, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4569, dtype=torch.float64) delta_t tensor(-0.0680, dtype=torch.float64)
4 gae_duplicate tensor(-6.9201, dtype=torch.float64) tensor(18.3600, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4497, dtype=torch.float64) delta_t tensor(0.0746, dtype=torch.float64)
3 gae_duplicate tensor(-6.2188, dtype=torch.float64) tensor(-0.9778, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1762, dtype=torch.float64) delta_t tensor(-0.2724, dtype=torch.float64)
2 gae_duplicate tensor(-4.3249, dtype=torch.float64) tensor(1.5102, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-591.72607421875
value loss:417.8797607421875
entropies:97.73155212402344
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.798923015594482 seconds
19 rew tensor(0.7407, dtype=torch.float64) delta_t tensor(-0.9380, dtype=torch.float64)
19 gae_duplicate tensor(-1.5502, dtype=torch.float64) tensor(3.9961, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7174, dtype=torch.float64) delta_t tensor(0.4404, dtype=torch.float64)
18 gae_duplicate tensor(-0.8044, dtype=torch.float64) tensor(1.3495, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6938, dtype=torch.float64) delta_t tensor(0.4447, dtype=torch.float64)
17 gae_duplicate tensor(-0.1403, dtype=torch.float64) tensor(-0.3165, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6386, dtype=torch.float64) delta_t tensor(0.4762, dtype=torch.float64)
16 gae_duplicate tensor(-0.4670, dtype=torch.float64) tensor(0.1767, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5600, dtype=torch.float64) delta_t tensor(0.4201, dtype=torch.float64)
15 gae_duplicate tensor(-0.5273, dtype=torch.float64) tensor(-1.4988, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5451, dtype=torch.float64) delta_t tensor(0.1396, dtype=torch.float64)
14 gae_duplicate tensor(-0.8603, dtype=torch.float64) tensor(-3.2749, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6569, dtype=torch.float64) delta_t tensor(0.5581, dtype=torch.float64)
13 gae_duplicate tensor(-0.1787, dtype=torch.float64) tensor(-8.4919, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7179, dtype=torch.float64) delta_t tensor(0.5968, dtype=torch.float64)
12 gae_duplicate tensor(0.2841, dtype=torch.float64) tensor(-13.3447, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2094, dtype=torch.float64) delta_t tensor(-0.0569, dtype=torch.float64)
11 gae_duplicate tensor(-0.9830, dtype=torch.float64) tensor(-9.7952, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6317, dtype=torch.float64) delta_t tensor(0.2094, dtype=torch.float64)
10 gae_duplicate tensor(-0.4255, dtype=torch.float64) tensor(-6.4723, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0676, dtype=torch.float64) delta_t tensor(-0.1295, dtype=torch.float64)
9 gae_duplicate tensor(-0.6494, dtype=torch.float64) tensor(-8.1116, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4563, dtype=torch.float64) delta_t tensor(-0.4588, dtype=torch.float64)
8 gae_duplicate tensor(-1.9077, dtype=torch.float64) tensor(-3.9230, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8310, dtype=torch.float64) delta_t tensor(-0.9352, dtype=torch.float64)
7 gae_duplicate tensor(-4.0442, dtype=torch.float64) tensor(-2.8437, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5392, dtype=torch.float64) delta_t tensor(-0.4041, dtype=torch.float64)
6 gae_duplicate tensor(-4.6267, dtype=torch.float64) tensor(9.5174, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2469, dtype=torch.float64) delta_t tensor(-0.5901, dtype=torch.float64)
5 gae_duplicate tensor(-5.3827, dtype=torch.float64) tensor(24.5868, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1318, dtype=torch.float64) delta_t tensor(-0.7270, dtype=torch.float64)
4 gae_duplicate tensor(-7.5128, dtype=torch.float64) tensor(17.1356, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2163, dtype=torch.float64) delta_t tensor(-0.0625, dtype=torch.float64)
3 gae_duplicate tensor(-6.7310, dtype=torch.float64) tensor(3.0857, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1997, dtype=torch.float64) delta_t tensor(0.0700, dtype=torch.float64)
2 gae_duplicate tensor(-4.7807, dtype=torch.float64) tensor(0.2163, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-89.44796752929688
value loss:691.6087036132812
entropies:98.65826416015625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1724.1506)
ToM Target loss= tensor(1802.7224)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.8301920890808105 seconds
19 rew tensor(0.6694, dtype=torch.float64) delta_t tensor(-0.7955, dtype=torch.float64)
19 gae_duplicate tensor(-1.1361, dtype=torch.float64) tensor(5.5441, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5903, dtype=torch.float64) delta_t tensor(0.2848, dtype=torch.float64)
18 gae_duplicate tensor(-0.9570, dtype=torch.float64) tensor(1.0419, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4558, dtype=torch.float64) delta_t tensor(-0.0117, dtype=torch.float64)
17 gae_duplicate tensor(-1.1513, dtype=torch.float64) tensor(3.2219, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4159, dtype=torch.float64) delta_t tensor(0.4112, dtype=torch.float64)
16 gae_duplicate tensor(-1.2750, dtype=torch.float64) tensor(-3.9334, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5521, dtype=torch.float64) delta_t tensor(0.5544, dtype=torch.float64)
15 gae_duplicate tensor(-0.8253, dtype=torch.float64) tensor(-5.9816, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6543, dtype=torch.float64) delta_t tensor(0.5032, dtype=torch.float64)
14 gae_duplicate tensor(-0.2628, dtype=torch.float64) tensor(-4.5894, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7176, dtype=torch.float64) delta_t tensor(0.6306, dtype=torch.float64)
13 gae_duplicate tensor(0.1873, dtype=torch.float64) tensor(-8.4989, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5680, dtype=torch.float64) delta_t tensor(0.2321, dtype=torch.float64)
12 gae_duplicate tensor(-0.3970, dtype=torch.float64) tensor(-1.4495, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5427, dtype=torch.float64) delta_t tensor(-0.8489, dtype=torch.float64)
11 gae_duplicate tensor(-2.5503, dtype=torch.float64) tensor(-3.9883, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.9431, dtype=torch.float64) delta_t tensor(-1.3389, dtype=torch.float64)
10 gae_duplicate tensor(-4.1359, dtype=torch.float64) tensor(19.0499, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5409, dtype=torch.float64) delta_t tensor(-1.7335, dtype=torch.float64)
9 gae_duplicate tensor(-7.5624, dtype=torch.float64) tensor(16.3464, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0290, dtype=torch.float64) delta_t tensor(-0.2020, dtype=torch.float64)
8 gae_duplicate tensor(-4.9102, dtype=torch.float64) tensor(6.5398, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7331, dtype=torch.float64) delta_t tensor(-0.6043, dtype=torch.float64)
7 gae_duplicate tensor(-3.6022, dtype=torch.float64) tensor(18.5526, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4251, dtype=torch.float64) delta_t tensor(-0.3977, dtype=torch.float64)
6 gae_duplicate tensor(-4.1478, dtype=torch.float64) tensor(28.3318, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9379, dtype=torch.float64) delta_t tensor(-0.4092, dtype=torch.float64)
5 gae_duplicate tensor(-4.8990, dtype=torch.float64) tensor(14.3450, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4029, dtype=torch.float64) delta_t tensor(-0.0848, dtype=torch.float64)
4 gae_duplicate tensor(-5.5489, dtype=torch.float64) tensor(36.5032, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1914, dtype=torch.float64) delta_t tensor(0.1543, dtype=torch.float64)
3 gae_duplicate tensor(-4.0098, dtype=torch.float64) tensor(2.4433, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1927, dtype=torch.float64) delta_t tensor(0.1176, dtype=torch.float64)
2 gae_duplicate tensor(-2.6860, dtype=torch.float64) tensor(14.6570, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4990.5751953125
value loss:733.4209594726562
entropies:98.24396514892578
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5102221965789795 seconds
19 rew tensor(0.7168, dtype=torch.float64) delta_t tensor(-0.9584, dtype=torch.float64)
19 gae_duplicate tensor(-1.2207, dtype=torch.float64) tensor(10.5199, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6932, dtype=torch.float64) delta_t tensor(0.4186, dtype=torch.float64)
18 gae_duplicate tensor(-0.6138, dtype=torch.float64) tensor(1.7083, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6696, dtype=torch.float64) delta_t tensor(0.3546, dtype=torch.float64)
17 gae_duplicate tensor(-0.2328, dtype=torch.float64) tensor(0.4195, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5749, dtype=torch.float64) delta_t tensor(0.4015, dtype=torch.float64)
16 gae_duplicate tensor(-0.3735, dtype=torch.float64) tensor(-3.2154, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4170, dtype=torch.float64) delta_t tensor(0.4082, dtype=torch.float64)
15 gae_duplicate tensor(-0.3959, dtype=torch.float64) tensor(-3.4099, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2761, dtype=torch.float64) delta_t tensor(0.0721, dtype=torch.float64)
14 gae_duplicate tensor(-2.6589, dtype=torch.float64) tensor(-10.8909, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2300, dtype=torch.float64) delta_t tensor(-0.0056, dtype=torch.float64)
13 gae_duplicate tensor(-4.4707, dtype=torch.float64) tensor(-3.2865, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4367, dtype=torch.float64) delta_t tensor(0.2338, dtype=torch.float64)
12 gae_duplicate tensor(-2.4236, dtype=torch.float64) tensor(-3.7742, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5164, dtype=torch.float64) delta_t tensor(0.4569, dtype=torch.float64)
11 gae_duplicate tensor(-1.2417, dtype=torch.float64) tensor(0.8350, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4387, dtype=torch.float64) delta_t tensor(-0.0942, dtype=torch.float64)
10 gae_duplicate tensor(-1.3766, dtype=torch.float64) tensor(0.2107, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8974, dtype=torch.float64) delta_t tensor(-1.0599, dtype=torch.float64)
9 gae_duplicate tensor(-5.3549, dtype=torch.float64) tensor(-12.2730, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7817, dtype=torch.float64) delta_t tensor(-0.8236, dtype=torch.float64)
8 gae_duplicate tensor(-6.0160, dtype=torch.float64) tensor(1.9960, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0649, dtype=torch.float64) delta_t tensor(0.1755, dtype=torch.float64)
7 gae_duplicate tensor(-4.4195, dtype=torch.float64) tensor(4.0237, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2707, dtype=torch.float64) delta_t tensor(0.3687, dtype=torch.float64)
6 gae_duplicate tensor(-3.2550, dtype=torch.float64) tensor(-2.0175, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3638, dtype=torch.float64) delta_t tensor(-0.0231, dtype=torch.float64)
5 gae_duplicate tensor(-2.1442, dtype=torch.float64) tensor(0.6004, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0811, dtype=torch.float64) delta_t tensor(0.5046, dtype=torch.float64)
4 gae_duplicate tensor(-1.2741, dtype=torch.float64) tensor(-0.5863, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4592, dtype=torch.float64) delta_t tensor(-0.1100, dtype=torch.float64)
3 gae_duplicate tensor(-0.8112, dtype=torch.float64) tensor(1.4846, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2153, dtype=torch.float64) delta_t tensor(-0.3152, dtype=torch.float64)
2 gae_duplicate tensor(-1.3427, dtype=torch.float64) tensor(2.7198, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:520.1749267578125
value loss:367.0045166015625
entropies:97.2927017211914
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.755939722061157 seconds
19 rew tensor(0.7311, dtype=torch.float64) delta_t tensor(-0.2490, dtype=torch.float64)
19 gae_duplicate tensor(-1.1886, dtype=torch.float64) tensor(3.1592, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7233, dtype=torch.float64) delta_t tensor(0.5949, dtype=torch.float64)
18 gae_duplicate tensor(-0.6052, dtype=torch.float64) tensor(0.7000, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7076, dtype=torch.float64) delta_t tensor(0.4848, dtype=torch.float64)
17 gae_duplicate tensor(-0.1961, dtype=torch.float64) tensor(-1.3495, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6523, dtype=torch.float64) delta_t tensor(-0.0762, dtype=torch.float64)
16 gae_duplicate tensor(0.0274, dtype=torch.float64) tensor(-2.4524, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5579, dtype=torch.float64) delta_t tensor(0.4175, dtype=torch.float64)
15 gae_duplicate tensor(0.2953, dtype=torch.float64) tensor(-6.1786, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7400, dtype=torch.float64) delta_t tensor(0.4535, dtype=torch.float64)
14 gae_duplicate tensor(0.3056, dtype=torch.float64) tensor(-3.1413, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5584, dtype=torch.float64) delta_t tensor(0.4076, dtype=torch.float64)
13 gae_duplicate tensor(-0.2232, dtype=torch.float64) tensor(-3.7563, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2569, dtype=torch.float64) delta_t tensor(-0.0816, dtype=torch.float64)
12 gae_duplicate tensor(-2.5043, dtype=torch.float64) tensor(-12.1001, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7321, dtype=torch.float64) delta_t tensor(0.4498, dtype=torch.float64)
11 gae_duplicate tensor(-1.4832, dtype=torch.float64) tensor(-7.5958, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6386, dtype=torch.float64) delta_t tensor(0.2863, dtype=torch.float64)
10 gae_duplicate tensor(-1.4503, dtype=torch.float64) tensor(1.3403, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7331, dtype=torch.float64) delta_t tensor(-0.9827, dtype=torch.float64)
9 gae_duplicate tensor(-2.2441, dtype=torch.float64) tensor(-0.0869, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9072, dtype=torch.float64) delta_t tensor(-1.0881, dtype=torch.float64)
8 gae_duplicate tensor(-3.5803, dtype=torch.float64) tensor(1.5433, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3383, dtype=torch.float64) delta_t tensor(-0.5696, dtype=torch.float64)
7 gae_duplicate tensor(-2.8119, dtype=torch.float64) tensor(7.7458, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4029, dtype=torch.float64) delta_t tensor(-1.2492, dtype=torch.float64)
6 gae_duplicate tensor(-5.0309, dtype=torch.float64) tensor(5.7063, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4595, dtype=torch.float64) delta_t tensor(-0.6787, dtype=torch.float64)
5 gae_duplicate tensor(-4.9282, dtype=torch.float64) tensor(9.7347, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.3638, dtype=torch.float64) delta_t tensor(-3.8198, dtype=torch.float64)
4 gae_duplicate tensor(-10.7139, dtype=torch.float64) tensor(92.4991, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1962, dtype=torch.float64) delta_t tensor(0.2355, dtype=torch.float64)
3 gae_duplicate tensor(-7.9597, dtype=torch.float64) tensor(29.1240, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1211, dtype=torch.float64) delta_t tensor(0.0622, dtype=torch.float64)
2 gae_duplicate tensor(-6.0852, dtype=torch.float64) tensor(14.1696, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4663.37548828125
value loss:1330.8997802734375
entropies:95.34773254394531
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.673550128936768 seconds
19 rew tensor(0.4619, dtype=torch.float64) delta_t tensor(-1.0871, dtype=torch.float64)
19 gae_duplicate tensor(-2.1731, dtype=torch.float64) tensor(7.3361, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7397, dtype=torch.float64) delta_t tensor(0.4366, dtype=torch.float64)
18 gae_duplicate tensor(-1.2232, dtype=torch.float64) tensor(4.1692, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7478, dtype=torch.float64) delta_t tensor(0.5014, dtype=torch.float64)
17 gae_duplicate tensor(-0.4428, dtype=torch.float64) tensor(-0.2353, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6451, dtype=torch.float64) delta_t tensor(0.4902, dtype=torch.float64)
16 gae_duplicate tensor(0.1641, dtype=torch.float64) tensor(-6.7095, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5502, dtype=torch.float64) delta_t tensor(0.5732, dtype=torch.float64)
15 gae_duplicate tensor(0.4135, dtype=torch.float64) tensor(-6.3721, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4513, dtype=torch.float64) delta_t tensor(0.3605, dtype=torch.float64)
14 gae_duplicate tensor(0.2021, dtype=torch.float64) tensor(-11.2684, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4586, dtype=torch.float64) delta_t tensor(0.1089, dtype=torch.float64)
13 gae_duplicate tensor(0.0578, dtype=torch.float64) tensor(-13.2972, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1780, dtype=torch.float64) delta_t tensor(-0.1479, dtype=torch.float64)
12 gae_duplicate tensor(-0.4533, dtype=torch.float64) tensor(-2.9893, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1222, dtype=torch.float64) delta_t tensor(-0.0767, dtype=torch.float64)
11 gae_duplicate tensor(-1.4148, dtype=torch.float64) tensor(-0.7521, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1219, dtype=torch.float64) delta_t tensor(-0.4064, dtype=torch.float64)
10 gae_duplicate tensor(-1.5018, dtype=torch.float64) tensor(2.4521, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0112, dtype=torch.float64) delta_t tensor(-0.1208, dtype=torch.float64)
9 gae_duplicate tensor(-1.3175, dtype=torch.float64) tensor(1.7454, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1918, dtype=torch.float64) delta_t tensor(-0.0368, dtype=torch.float64)
8 gae_duplicate tensor(-1.2794, dtype=torch.float64) tensor(1.0827, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1601, dtype=torch.float64) delta_t tensor(-0.0898, dtype=torch.float64)
7 gae_duplicate tensor(-1.7444, dtype=torch.float64) tensor(-1.1945, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3902, dtype=torch.float64) delta_t tensor(-0.1222, dtype=torch.float64)
6 gae_duplicate tensor(-3.2476, dtype=torch.float64) tensor(-0.1303, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3505, dtype=torch.float64) delta_t tensor(-0.0651, dtype=torch.float64)
5 gae_duplicate tensor(-4.7166, dtype=torch.float64) tensor(0.1363, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3335, dtype=torch.float64) delta_t tensor(0.1558, dtype=torch.float64)
4 gae_duplicate tensor(-4.5246, dtype=torch.float64) tensor(-0.3153, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1008, dtype=torch.float64) delta_t tensor(0.1595, dtype=torch.float64)
3 gae_duplicate tensor(-3.2542, dtype=torch.float64) tensor(7.9646, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3005, dtype=torch.float64) delta_t tensor(0.0618, dtype=torch.float64)
2 gae_duplicate tensor(-1.7464, dtype=torch.float64) tensor(4.3223, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:488.6845703125
value loss:238.11903381347656
entropies:96.09691619873047
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.719932317733765 seconds
19 rew tensor(0.7315, dtype=torch.float64) delta_t tensor(-0.8693, dtype=torch.float64)
19 gae_duplicate tensor(-1.3941, dtype=torch.float64) tensor(9.9469, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7240, dtype=torch.float64) delta_t tensor(0.4525, dtype=torch.float64)
18 gae_duplicate tensor(-0.9136, dtype=torch.float64) tensor(0.3835, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7012, dtype=torch.float64) delta_t tensor(0.3255, dtype=torch.float64)
17 gae_duplicate tensor(-0.4078, dtype=torch.float64) tensor(-0.7411, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6478, dtype=torch.float64) delta_t tensor(0.3182, dtype=torch.float64)
16 gae_duplicate tensor(-0.7667, dtype=torch.float64) tensor(-3.9639, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5637, dtype=torch.float64) delta_t tensor(0.6057, dtype=torch.float64)
15 gae_duplicate tensor(-0.8650, dtype=torch.float64) tensor(-1.6110, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7475, dtype=torch.float64) delta_t tensor(0.5044, dtype=torch.float64)
14 gae_duplicate tensor(-0.2493, dtype=torch.float64) tensor(-2.0751, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4415, dtype=torch.float64) delta_t tensor(0.6641, dtype=torch.float64)
13 gae_duplicate tensor(-1.5931, dtype=torch.float64) tensor(-2.7534, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1355, dtype=torch.float64) delta_t tensor(0.0410, dtype=torch.float64)
12 gae_duplicate tensor(-4.5050, dtype=torch.float64) tensor(-17.8962, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4103, dtype=torch.float64) delta_t tensor(0.0664, dtype=torch.float64)
11 gae_duplicate tensor(-3.2465, dtype=torch.float64) tensor(-5.4686, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1656, dtype=torch.float64) delta_t tensor(-0.7163, dtype=torch.float64)
10 gae_duplicate tensor(-2.6825, dtype=torch.float64) tensor(-5.1346, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.7538, dtype=torch.float64) delta_t tensor(-2.9621, dtype=torch.float64)
9 gae_duplicate tensor(-8.4534, dtype=torch.float64) tensor(6.2108, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2385, dtype=torch.float64) delta_t tensor(-0.4936, dtype=torch.float64)
8 gae_duplicate tensor(-6.7216, dtype=torch.float64) tensor(6.8165, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0424, dtype=torch.float64) delta_t tensor(0.1092, dtype=torch.float64)
7 gae_duplicate tensor(-4.7210, dtype=torch.float64) tensor(8.3961, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3860, dtype=torch.float64) delta_t tensor(-0.1334, dtype=torch.float64)
6 gae_duplicate tensor(-4.4331, dtype=torch.float64) tensor(8.9387, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6863, dtype=torch.float64) delta_t tensor(-0.1897, dtype=torch.float64)
5 gae_duplicate tensor(-4.7493, dtype=torch.float64) tensor(17.3480, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5986, dtype=torch.float64) delta_t tensor(-0.0821, dtype=torch.float64)
4 gae_duplicate tensor(-8.7995, dtype=torch.float64) tensor(0.8794, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1676, dtype=torch.float64) delta_t tensor(0.1565, dtype=torch.float64)
3 gae_duplicate tensor(-6.1831, dtype=torch.float64) tensor(0.9275, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1445, dtype=torch.float64) delta_t tensor(0.0412, dtype=torch.float64)
2 gae_duplicate tensor(-4.6660, dtype=torch.float64) tensor(10.3549, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1117.417724609375
value loss:859.7138671875
entropies:96.15496826171875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1815.9474)
ToM Target loss= tensor(1801.5052)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.614804983139038 seconds
19 rew tensor(0.5196, dtype=torch.float64) delta_t tensor(-0.9044, dtype=torch.float64)
19 gae_duplicate tensor(-1.8672, dtype=torch.float64) tensor(6.4094, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3235, dtype=torch.float64) delta_t tensor(0.1777, dtype=torch.float64)
18 gae_duplicate tensor(-1.3145, dtype=torch.float64) tensor(3.5430, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5602, dtype=torch.float64) delta_t tensor(0.4384, dtype=torch.float64)
17 gae_duplicate tensor(-1.2556, dtype=torch.float64) tensor(-1.6855, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3731, dtype=torch.float64) delta_t tensor(0.3872, dtype=torch.float64)
16 gae_duplicate tensor(-0.7816, dtype=torch.float64) tensor(-0.8630, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5786, dtype=torch.float64) delta_t tensor(0.7098, dtype=torch.float64)
15 gae_duplicate tensor(-0.2855, dtype=torch.float64) tensor(-6.7473, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7168, dtype=torch.float64) delta_t tensor(0.5058, dtype=torch.float64)
14 gae_duplicate tensor(0.4304, dtype=torch.float64) tensor(-5.4716, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1231, dtype=torch.float64) delta_t tensor(-0.2115, dtype=torch.float64)
13 gae_duplicate tensor(-0.4491, dtype=torch.float64) tensor(-6.2475, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3149, dtype=torch.float64) delta_t tensor(0.2080, dtype=torch.float64)
12 gae_duplicate tensor(-1.8014, dtype=torch.float64) tensor(-11.5916, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5668, dtype=torch.float64) delta_t tensor(0.2465, dtype=torch.float64)
11 gae_duplicate tensor(-1.0395, dtype=torch.float64) tensor(-1.5599, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0509, dtype=torch.float64) delta_t tensor(-0.4491, dtype=torch.float64)
10 gae_duplicate tensor(-0.6925, dtype=torch.float64) tensor(-0.8838, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3467, dtype=torch.float64) delta_t tensor(-0.4012, dtype=torch.float64)
9 gae_duplicate tensor(-0.9667, dtype=torch.float64) tensor(2.5991, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5025, dtype=torch.float64) delta_t tensor(-0.8240, dtype=torch.float64)
8 gae_duplicate tensor(-2.4816, dtype=torch.float64) tensor(3.0723, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2799, dtype=torch.float64) delta_t tensor(-1.3507, dtype=torch.float64)
7 gae_duplicate tensor(-5.9761, dtype=torch.float64) tensor(17.8509, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7667, dtype=torch.float64) delta_t tensor(-0.4233, dtype=torch.float64)
6 gae_duplicate tensor(-5.6423, dtype=torch.float64) tensor(5.5045, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9276, dtype=torch.float64) delta_t tensor(-0.2384, dtype=torch.float64)
5 gae_duplicate tensor(-4.1442, dtype=torch.float64) tensor(34.0430, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1011, dtype=torch.float64) delta_t tensor(-0.7740, dtype=torch.float64)
4 gae_duplicate tensor(-6.3572, dtype=torch.float64) tensor(21.6716, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2099, dtype=torch.float64) delta_t tensor(-0.1055, dtype=torch.float64)
3 gae_duplicate tensor(-4.9614, dtype=torch.float64) tensor(10.8677, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1514, dtype=torch.float64) delta_t tensor(0.0549, dtype=torch.float64)
2 gae_duplicate tensor(-3.5150, dtype=torch.float64) tensor(2.3101, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2638.498291015625
value loss:557.1194458007812
entropies:94.05005645751953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.574474573135376 seconds
19 rew tensor(0.7090, dtype=torch.float64) delta_t tensor(-0.7372, dtype=torch.float64)
19 gae_duplicate tensor(-1.1344, dtype=torch.float64) tensor(3.3912, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6777, dtype=torch.float64) delta_t tensor(0.4546, dtype=torch.float64)
18 gae_duplicate tensor(-0.7230, dtype=torch.float64) tensor(-2.4216, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6387, dtype=torch.float64) delta_t tensor(0.4116, dtype=torch.float64)
17 gae_duplicate tensor(-0.3795, dtype=torch.float64) tensor(-0.4638, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4903, dtype=torch.float64) delta_t tensor(0.2986, dtype=torch.float64)
16 gae_duplicate tensor(-0.5958, dtype=torch.float64) tensor(-7.9141, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3024, dtype=torch.float64) delta_t tensor(0.6480, dtype=torch.float64)
15 gae_duplicate tensor(-0.4969, dtype=torch.float64) tensor(-1.8839, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6710, dtype=torch.float64) delta_t tensor(0.5524, dtype=torch.float64)
14 gae_duplicate tensor(0.1776, dtype=torch.float64) tensor(-7.7650, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7174, dtype=torch.float64) delta_t tensor(0.5655, dtype=torch.float64)
13 gae_duplicate tensor(0.7173, dtype=torch.float64) tensor(-2.8205, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1921, dtype=torch.float64) delta_t tensor(0.0939, dtype=torch.float64)
12 gae_duplicate tensor(-1.4306, dtype=torch.float64) tensor(-14.3143, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.9057, dtype=torch.float64) delta_t tensor(-0.7108, dtype=torch.float64)
11 gae_duplicate tensor(-5.6542, dtype=torch.float64) tensor(-9.9347, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1788, dtype=torch.float64) delta_t tensor(-0.9645, dtype=torch.float64)
10 gae_duplicate tensor(-4.4992, dtype=torch.float64) tensor(-5.1648, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8054, dtype=torch.float64) delta_t tensor(-1.0630, dtype=torch.float64)
9 gae_duplicate tensor(-3.7040, dtype=torch.float64) tensor(9.1410, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2086, dtype=torch.float64) delta_t tensor(-0.4337, dtype=torch.float64)
8 gae_duplicate tensor(-3.0398, dtype=torch.float64) tensor(12.6980, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5517, dtype=torch.float64) delta_t tensor(-0.0940, dtype=torch.float64)
7 gae_duplicate tensor(-2.3562, dtype=torch.float64) tensor(11.4980, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2589, dtype=torch.float64) delta_t tensor(-0.0117, dtype=torch.float64)
6 gae_duplicate tensor(-2.9787, dtype=torch.float64) tensor(8.2504, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1747, dtype=torch.float64) delta_t tensor(-0.7579, dtype=torch.float64)
5 gae_duplicate tensor(-3.6185, dtype=torch.float64) tensor(11.1515, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4335, dtype=torch.float64) delta_t tensor(-0.2924, dtype=torch.float64)
4 gae_duplicate tensor(-5.5086, dtype=torch.float64) tensor(3.5003, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4528, dtype=torch.float64) delta_t tensor(0.2557, dtype=torch.float64)
3 gae_duplicate tensor(-4.1192, dtype=torch.float64) tensor(-0.6209, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2014, dtype=torch.float64) delta_t tensor(-0.5640, dtype=torch.float64)
2 gae_duplicate tensor(-2.8328, dtype=torch.float64) tensor(2.0417, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-318.4071350097656
value loss:622.6942138671875
entropies:95.2218246459961
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.967191934585571 seconds
19 rew tensor(0.7403, dtype=torch.float64) delta_t tensor(-0.7116, dtype=torch.float64)
19 gae_duplicate tensor(-1.0983, dtype=torch.float64) tensor(4.0117, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7248, dtype=torch.float64) delta_t tensor(0.5078, dtype=torch.float64)
18 gae_duplicate tensor(-0.5592, dtype=torch.float64) tensor(0.1082, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7014, dtype=torch.float64) delta_t tensor(0.2402, dtype=torch.float64)
17 gae_duplicate tensor(-0.1549, dtype=torch.float64) tensor(-0.5081, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6234, dtype=torch.float64) delta_t tensor(0.2522, dtype=torch.float64)
16 gae_duplicate tensor(-0.3411, dtype=torch.float64) tensor(-3.2283, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5611, dtype=torch.float64) delta_t tensor(0.6841, dtype=torch.float64)
15 gae_duplicate tensor(-0.2448, dtype=torch.float64) tensor(-3.1935, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6386, dtype=torch.float64) delta_t tensor(0.6076, dtype=torch.float64)
14 gae_duplicate tensor(0.2721, dtype=torch.float64) tensor(-20.3994, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5207, dtype=torch.float64) delta_t tensor(0.4323, dtype=torch.float64)
13 gae_duplicate tensor(0.6858, dtype=torch.float64) tensor(-4.4356, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0267, dtype=torch.float64) delta_t tensor(0.0973, dtype=torch.float64)
12 gae_duplicate tensor(-2.4440, dtype=torch.float64) tensor(3.5037, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6847, dtype=torch.float64) delta_t tensor(-0.7854, dtype=torch.float64)
11 gae_duplicate tensor(-2.6834, dtype=torch.float64) tensor(-5.1241, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1486, dtype=torch.float64) delta_t tensor(-0.6374, dtype=torch.float64)
10 gae_duplicate tensor(-2.7197, dtype=torch.float64) tensor(7.1004, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2594, dtype=torch.float64) delta_t tensor(-0.5640, dtype=torch.float64)
9 gae_duplicate tensor(-4.3191, dtype=torch.float64) tensor(12.8777, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1148, dtype=torch.float64) delta_t tensor(0.2983, dtype=torch.float64)
8 gae_duplicate tensor(-2.5782, dtype=torch.float64) tensor(-0.1944, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0492, dtype=torch.float64) delta_t tensor(0.0495, dtype=torch.float64)
7 gae_duplicate tensor(-1.5330, dtype=torch.float64) tensor(-0.2218, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3077, dtype=torch.float64) delta_t tensor(-0.0653, dtype=torch.float64)
6 gae_duplicate tensor(-1.6539, dtype=torch.float64) tensor(1.0830, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5274, dtype=torch.float64) delta_t tensor(-0.1133, dtype=torch.float64)
5 gae_duplicate tensor(-1.5463, dtype=torch.float64) tensor(2.5634, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7191, dtype=torch.float64) delta_t tensor(-0.4228, dtype=torch.float64)
4 gae_duplicate tensor(-6.2678, dtype=torch.float64) tensor(1.4290, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0493, dtype=torch.float64) delta_t tensor(0.5274, dtype=torch.float64)
3 gae_duplicate tensor(-4.1320, dtype=torch.float64) tensor(0.0389, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2466, dtype=torch.float64) delta_t tensor(-0.1248, dtype=torch.float64)
2 gae_duplicate tensor(-3.2058, dtype=torch.float64) tensor(-1.6112, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:206.31471252441406
value loss:412.51513671875
entropies:93.89293670654297
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.8420469760894775 seconds
19 rew tensor(0.6714, dtype=torch.float64) delta_t tensor(-0.8666, dtype=torch.float64)
19 gae_duplicate tensor(-1.5786, dtype=torch.float64) tensor(1.3548, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5636, dtype=torch.float64) delta_t tensor(0.3172, dtype=torch.float64)
18 gae_duplicate tensor(-1.3178, dtype=torch.float64) tensor(3.3956, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4179, dtype=torch.float64) delta_t tensor(0.2550, dtype=torch.float64)
17 gae_duplicate tensor(-1.5229, dtype=torch.float64) tensor(0.6537, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6538, dtype=torch.float64) delta_t tensor(0.3750, dtype=torch.float64)
16 gae_duplicate tensor(-0.6031, dtype=torch.float64) tensor(-0.4325, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5672, dtype=torch.float64) delta_t tensor(0.8042, dtype=torch.float64)
15 gae_duplicate tensor(-0.3795, dtype=torch.float64) tensor(-3.0115, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7254, dtype=torch.float64) delta_t tensor(0.3117, dtype=torch.float64)
14 gae_duplicate tensor(0.2251, dtype=torch.float64) tensor(-15.7216, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7409, dtype=torch.float64) delta_t tensor(0.5255, dtype=torch.float64)
13 gae_duplicate tensor(0.7089, dtype=torch.float64) tensor(-2.2254, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7331, dtype=torch.float64) delta_t tensor(0.5121, dtype=torch.float64)
12 gae_duplicate tensor(0.9117, dtype=torch.float64) tensor(-2.6188, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7178, dtype=torch.float64) delta_t tensor(0.6291, dtype=torch.float64)
11 gae_duplicate tensor(1.2423, dtype=torch.float64) tensor(-10.1554, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4739, dtype=torch.float64) delta_t tensor(-0.1258, dtype=torch.float64)
10 gae_duplicate tensor(0.6660, dtype=torch.float64) tensor(-4.6025, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7022, dtype=torch.float64) delta_t tensor(-1.8099, dtype=torch.float64)
9 gae_duplicate tensor(-2.6107, dtype=torch.float64) tensor(0.9204, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7652, dtype=torch.float64) delta_t tensor(-0.8383, dtype=torch.float64)
8 gae_duplicate tensor(-3.7738, dtype=torch.float64) tensor(4.2428, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0513, dtype=torch.float64) delta_t tensor(-0.3047, dtype=torch.float64)
7 gae_duplicate tensor(-3.3624, dtype=torch.float64) tensor(2.1219, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3785, dtype=torch.float64) delta_t tensor(-1.2518, dtype=torch.float64)
6 gae_duplicate tensor(-3.3218, dtype=torch.float64) tensor(3.5571, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6831, dtype=torch.float64) delta_t tensor(-0.8184, dtype=torch.float64)
5 gae_duplicate tensor(-4.5470, dtype=torch.float64) tensor(15.4694, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0451, dtype=torch.float64) delta_t tensor(-0.6711, dtype=torch.float64)
4 gae_duplicate tensor(-5.3331, dtype=torch.float64) tensor(40.0816, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2321, dtype=torch.float64) delta_t tensor(0.4039, dtype=torch.float64)
3 gae_duplicate tensor(-4.8290, dtype=torch.float64) tensor(2.8433, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1132, dtype=torch.float64) delta_t tensor(0.0343, dtype=torch.float64)
2 gae_duplicate tensor(-3.1880, dtype=torch.float64) tensor(7.9898, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1595.7401123046875
value loss:606.3334350585938
entropies:92.66281127929688
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.867050886154175 seconds
19 rew tensor(0.7323, dtype=torch.float64) delta_t tensor(-0.2634, dtype=torch.float64)
19 gae_duplicate tensor(-1.0391, dtype=torch.float64) tensor(3.1199, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7089, dtype=torch.float64) delta_t tensor(0.3418, dtype=torch.float64)
18 gae_duplicate tensor(-0.4513, dtype=torch.float64) tensor(-0.8890, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6696, dtype=torch.float64) delta_t tensor(0.4840, dtype=torch.float64)
17 gae_duplicate tensor(0.0842, dtype=torch.float64) tensor(-2.2698, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5985, dtype=torch.float64) delta_t tensor(0.3052, dtype=torch.float64)
16 gae_duplicate tensor(-0.4610, dtype=torch.float64) tensor(-0.0220, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3166, dtype=torch.float64) delta_t tensor(0.3930, dtype=torch.float64)
15 gae_duplicate tensor(-0.3394, dtype=torch.float64) tensor(-1.5048, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6473, dtype=torch.float64) delta_t tensor(0.4375, dtype=torch.float64)
14 gae_duplicate tensor(0.3576, dtype=torch.float64) tensor(-1.8864, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0598, dtype=torch.float64) delta_t tensor(-0.2534, dtype=torch.float64)
13 gae_duplicate tensor(-3.0536, dtype=torch.float64) tensor(-7.5629, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0255, dtype=torch.float64) delta_t tensor(-0.1356, dtype=torch.float64)
12 gae_duplicate tensor(-5.8262, dtype=torch.float64) tensor(-4.1214, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3647, dtype=torch.float64) delta_t tensor(0.3670, dtype=torch.float64)
11 gae_duplicate tensor(-4.3623, dtype=torch.float64) tensor(-1.1333, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5764, dtype=torch.float64) delta_t tensor(-0.9173, dtype=torch.float64)
10 gae_duplicate tensor(-3.9931, dtype=torch.float64) tensor(0.6713, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1342, dtype=torch.float64) delta_t tensor(0.0339, dtype=torch.float64)
9 gae_duplicate tensor(-2.8793, dtype=torch.float64) tensor(2.1438, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0437, dtype=torch.float64) delta_t tensor(0.0157, dtype=torch.float64)
8 gae_duplicate tensor(-2.4130, dtype=torch.float64) tensor(0.8748, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0592, dtype=torch.float64) delta_t tensor(-0.1509, dtype=torch.float64)
7 gae_duplicate tensor(-2.0204, dtype=torch.float64) tensor(2.1549, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3337, dtype=torch.float64) delta_t tensor(0.2504, dtype=torch.float64)
6 gae_duplicate tensor(-1.0998, dtype=torch.float64) tensor(-0.1660, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1302, dtype=torch.float64) delta_t tensor(0.4421, dtype=torch.float64)
5 gae_duplicate tensor(-0.4143, dtype=torch.float64) tensor(-1.7443, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4105, dtype=torch.float64) delta_t tensor(0.0786, dtype=torch.float64)
4 gae_duplicate tensor(-0.4574, dtype=torch.float64) tensor(-0.7356, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3486, dtype=torch.float64) delta_t tensor(-0.0006, dtype=torch.float64)
3 gae_duplicate tensor(-0.3272, dtype=torch.float64) tensor(1.1277, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2904, dtype=torch.float64) delta_t tensor(-0.2990, dtype=torch.float64)
2 gae_duplicate tensor(-0.5392, dtype=torch.float64) tensor(2.3419, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:328.9358825683594
value loss:396.4320373535156
entropies:92.80755615234375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1807.7231)
ToM Target loss= tensor(1803.9750)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.88640284538269 seconds
19 rew tensor(0.7327, dtype=torch.float64) delta_t tensor(-0.5365, dtype=torch.float64)
19 gae_duplicate tensor(-0.8841, dtype=torch.float64) tensor(-0.1318, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7091, dtype=torch.float64) delta_t tensor(0.4795, dtype=torch.float64)
18 gae_duplicate tensor(-0.3460, dtype=torch.float64) tensor(1.9408, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6777, dtype=torch.float64) delta_t tensor(0.4054, dtype=torch.float64)
17 gae_duplicate tensor(-0.2675, dtype=torch.float64) tensor(-0.6620, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5989, dtype=torch.float64) delta_t tensor(0.3841, dtype=torch.float64)
16 gae_duplicate tensor(-0.2552, dtype=torch.float64) tensor(-0.4985, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4727, dtype=torch.float64) delta_t tensor(0.6992, dtype=torch.float64)
15 gae_duplicate tensor(-0.3284, dtype=torch.float64) tensor(-1.9278, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6620, dtype=torch.float64) delta_t tensor(0.3094, dtype=torch.float64)
14 gae_duplicate tensor(0.2707, dtype=torch.float64) tensor(-11.5038, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7177, dtype=torch.float64) delta_t tensor(0.6797, dtype=torch.float64)
13 gae_duplicate tensor(0.7500, dtype=torch.float64) tensor(-8.0204, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4658, dtype=torch.float64) delta_t tensor(-0.2877, dtype=torch.float64)
12 gae_duplicate tensor(-1.7045, dtype=torch.float64) tensor(-3.8977, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2130, dtype=torch.float64) delta_t tensor(0.1098, dtype=torch.float64)
11 gae_duplicate tensor(-1.4391, dtype=torch.float64) tensor(-2.3964, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2231, dtype=torch.float64) delta_t tensor(-0.0462, dtype=torch.float64)
10 gae_duplicate tensor(-0.9948, dtype=torch.float64) tensor(-1.0344, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2322, dtype=torch.float64) delta_t tensor(-0.3829, dtype=torch.float64)
9 gae_duplicate tensor(-1.3649, dtype=torch.float64) tensor(3.5815, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2181, dtype=torch.float64) delta_t tensor(-0.3016, dtype=torch.float64)
8 gae_duplicate tensor(-2.0005, dtype=torch.float64) tensor(5.4641, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2417, dtype=torch.float64) delta_t tensor(0.0859, dtype=torch.float64)
7 gae_duplicate tensor(-1.5973, dtype=torch.float64) tensor(-3.7081, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1590, dtype=torch.float64) delta_t tensor(0.3217, dtype=torch.float64)
6 gae_duplicate tensor(-0.8894, dtype=torch.float64) tensor(-1.7122, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6193, dtype=torch.float64) delta_t tensor(-0.1936, dtype=torch.float64)
5 gae_duplicate tensor(-1.0141, dtype=torch.float64) tensor(2.3007, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3264, dtype=torch.float64) delta_t tensor(0.1120, dtype=torch.float64)
4 gae_duplicate tensor(-0.7853, dtype=torch.float64) tensor(-0.4545, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7324, dtype=torch.float64) delta_t tensor(-0.3897, dtype=torch.float64)
3 gae_duplicate tensor(-1.3992, dtype=torch.float64) tensor(2.8229, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1994, dtype=torch.float64) delta_t tensor(-0.4718, dtype=torch.float64)
2 gae_duplicate tensor(-1.6352, dtype=torch.float64) tensor(7.5434, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:426.0602111816406
value loss:258.5910949707031
entropies:91.86273193359375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.581415891647339 seconds
19 rew tensor(0.7483, dtype=torch.float64) delta_t tensor(-0.3892, dtype=torch.float64)
19 gae_duplicate tensor(-1.0145, dtype=torch.float64) tensor(0.4943, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7484, dtype=torch.float64) delta_t tensor(0.5316, dtype=torch.float64)
18 gae_duplicate tensor(-0.4247, dtype=torch.float64) tensor(-0.0934, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7486, dtype=torch.float64) delta_t tensor(0.3573, dtype=torch.float64)
17 gae_duplicate tensor(0.0472, dtype=torch.float64) tensor(-1.4517, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7409, dtype=torch.float64) delta_t tensor(0.6931, dtype=torch.float64)
16 gae_duplicate tensor(0.4249, dtype=torch.float64) tensor(-1.8401, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7410, dtype=torch.float64) delta_t tensor(0.5629, dtype=torch.float64)
15 gae_duplicate tensor(0.7611, dtype=torch.float64) tensor(-2.1443, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7254, dtype=torch.float64) delta_t tensor(0.4182, dtype=torch.float64)
14 gae_duplicate tensor(0.9923, dtype=torch.float64) tensor(-11.5600, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7257, dtype=torch.float64) delta_t tensor(0.5192, dtype=torch.float64)
13 gae_duplicate tensor(1.1550, dtype=torch.float64) tensor(-2.6092, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7492, dtype=torch.float64) delta_t tensor(0.5252, dtype=torch.float64)
12 gae_duplicate tensor(1.3667, dtype=torch.float64) tensor(-2.8561, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1995, dtype=torch.float64) delta_t tensor(-0.6087, dtype=torch.float64)
11 gae_duplicate tensor(-2.7089, dtype=torch.float64) tensor(-1.2916, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5882, dtype=torch.float64) delta_t tensor(-0.9768, dtype=torch.float64)
10 gae_duplicate tensor(-3.6366, dtype=torch.float64) tensor(2.0373, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6102, dtype=torch.float64) delta_t tensor(-0.4436, dtype=torch.float64)
9 gae_duplicate tensor(-3.6383, dtype=torch.float64) tensor(2.0343, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1374, dtype=torch.float64) delta_t tensor(-0.3508, dtype=torch.float64)
8 gae_duplicate tensor(-2.9357, dtype=torch.float64) tensor(3.6060, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3622, dtype=torch.float64) delta_t tensor(-0.2785, dtype=torch.float64)
7 gae_duplicate tensor(-2.8515, dtype=torch.float64) tensor(1.1738, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0234, dtype=torch.float64) delta_t tensor(0.3862, dtype=torch.float64)
6 gae_duplicate tensor(-2.9281, dtype=torch.float64) tensor(2.4587, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4849, dtype=torch.float64) delta_t tensor(-0.0484, dtype=torch.float64)
5 gae_duplicate tensor(-1.5404, dtype=torch.float64) tensor(8.4255, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3269, dtype=torch.float64) delta_t tensor(0.0810, dtype=torch.float64)
4 gae_duplicate tensor(-3.2524, dtype=torch.float64) tensor(1.9292, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0567, dtype=torch.float64) delta_t tensor(0.3906, dtype=torch.float64)
3 gae_duplicate tensor(-2.1890, dtype=torch.float64) tensor(-3.0395, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2724, dtype=torch.float64) delta_t tensor(0.0478, dtype=torch.float64)
2 gae_duplicate tensor(-1.5496, dtype=torch.float64) tensor(-4.9435, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:331.700439453125
value loss:365.592529296875
entropies:91.30487060546875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.020775079727173 seconds
19 rew tensor(0.7171, dtype=torch.float64) delta_t tensor(-0.5008, dtype=torch.float64)
19 gae_duplicate tensor(-0.8440, dtype=torch.float64) tensor(3.9665, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7096, dtype=torch.float64) delta_t tensor(0.5034, dtype=torch.float64)
18 gae_duplicate tensor(-0.3529, dtype=torch.float64) tensor(-0.1483, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6863, dtype=torch.float64) delta_t tensor(0.8619, dtype=torch.float64)
17 gae_duplicate tensor(-0.1369, dtype=torch.float64) tensor(-6.0418, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5853, dtype=torch.float64) delta_t tensor(0.1125, dtype=torch.float64)
16 gae_duplicate tensor(-0.6788, dtype=torch.float64) tensor(-7.8486, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4448, dtype=torch.float64) delta_t tensor(0.3856, dtype=torch.float64)
15 gae_duplicate tensor(-0.8230, dtype=torch.float64) tensor(-5.3793, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6087, dtype=torch.float64) delta_t tensor(0.5640, dtype=torch.float64)
14 gae_duplicate tensor(-0.1062, dtype=torch.float64) tensor(-2.0790, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0451, dtype=torch.float64) delta_t tensor(-0.1214, dtype=torch.float64)
13 gae_duplicate tensor(-1.8466, dtype=torch.float64) tensor(-1.4797, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5094, dtype=torch.float64) delta_t tensor(0.3676, dtype=torch.float64)
12 gae_duplicate tensor(-1.8359, dtype=torch.float64) tensor(-13.4299, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4299, dtype=torch.float64) delta_t tensor(-0.5047, dtype=torch.float64)
11 gae_duplicate tensor(-3.2640, dtype=torch.float64) tensor(-4.5630, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3269, dtype=torch.float64) delta_t tensor(-0.1872, dtype=torch.float64)
10 gae_duplicate tensor(-4.2704, dtype=torch.float64) tensor(-6.3542, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3902, dtype=torch.float64) delta_t tensor(-0.2852, dtype=torch.float64)
9 gae_duplicate tensor(-2.9518, dtype=torch.float64) tensor(1.4788, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1045, dtype=torch.float64) delta_t tensor(-0.0626, dtype=torch.float64)
8 gae_duplicate tensor(-2.2800, dtype=torch.float64) tensor(0.5436, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0496, dtype=torch.float64) delta_t tensor(-0.6859, dtype=torch.float64)
7 gae_duplicate tensor(-1.9286, dtype=torch.float64) tensor(5.7821, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7104, dtype=torch.float64) delta_t tensor(-0.3576, dtype=torch.float64)
6 gae_duplicate tensor(-2.4531, dtype=torch.float64) tensor(1.4439, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0882, dtype=torch.float64) delta_t tensor(-0.8033, dtype=torch.float64)
5 gae_duplicate tensor(-3.5651, dtype=torch.float64) tensor(10.1520, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6973, dtype=torch.float64) delta_t tensor(-1.3421, dtype=torch.float64)
4 gae_duplicate tensor(-7.0651, dtype=torch.float64) tensor(4.6543, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3246, dtype=torch.float64) delta_t tensor(0.4351, dtype=torch.float64)
3 gae_duplicate tensor(-4.8402, dtype=torch.float64) tensor(13.0898, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3491, dtype=torch.float64) delta_t tensor(-0.1761, dtype=torch.float64)
2 gae_duplicate tensor(-3.6959, dtype=torch.float64) tensor(5.4931, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:9.729011535644531
value loss:663.4881591796875
entropies:89.89237213134766
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.439510107040405 seconds
19 rew tensor(0.6937, dtype=torch.float64) delta_t tensor(-0.6234, dtype=torch.float64)
19 gae_duplicate tensor(-0.9305, dtype=torch.float64) tensor(3.1681, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6467, dtype=torch.float64) delta_t tensor(0.4779, dtype=torch.float64)
18 gae_duplicate tensor(-0.3106, dtype=torch.float64) tensor(0.8513, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5456, dtype=torch.float64) delta_t tensor(0.1386, dtype=torch.float64)
17 gae_duplicate tensor(-0.3328, dtype=torch.float64) tensor(0.7030, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3116, dtype=torch.float64) delta_t tensor(0.1187, dtype=torch.float64)
16 gae_duplicate tensor(-0.4553, dtype=torch.float64) tensor(-2.2409, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0392, dtype=torch.float64) delta_t tensor(0.6849, dtype=torch.float64)
15 gae_duplicate tensor(-0.3306, dtype=torch.float64) tensor(-5.0735, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7483, dtype=torch.float64) delta_t tensor(1.0544, dtype=torch.float64)
14 gae_duplicate tensor(0.3111, dtype=torch.float64) tensor(-2.5417, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7169, dtype=torch.float64) delta_t tensor(0.5945, dtype=torch.float64)
13 gae_duplicate tensor(0.8247, dtype=torch.float64) tensor(-14.1361, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4015, dtype=torch.float64) delta_t tensor(0.3726, dtype=torch.float64)
12 gae_duplicate tensor(0.5783, dtype=torch.float64) tensor(-13.3776, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2530, dtype=torch.float64) delta_t tensor(-0.3145, dtype=torch.float64)
11 gae_duplicate tensor(-4.3913, dtype=torch.float64) tensor(-1.8404, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.9381, dtype=torch.float64) delta_t tensor(-2.9704, dtype=torch.float64)
10 gae_duplicate tensor(-6.9834, dtype=torch.float64) tensor(2.6361, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7876, dtype=torch.float64) delta_t tensor(-0.7915, dtype=torch.float64)
9 gae_duplicate tensor(-4.3834, dtype=torch.float64) tensor(13.5268, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1539, dtype=torch.float64) delta_t tensor(0.0684, dtype=torch.float64)
8 gae_duplicate tensor(-3.6675, dtype=torch.float64) tensor(11.1629, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0126, dtype=torch.float64) delta_t tensor(-0.0665, dtype=torch.float64)
7 gae_duplicate tensor(-2.7854, dtype=torch.float64) tensor(3.3817, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5003, dtype=torch.float64) delta_t tensor(0.0816, dtype=torch.float64)
6 gae_duplicate tensor(-2.2989, dtype=torch.float64) tensor(7.2964, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4835, dtype=torch.float64) delta_t tensor(-0.2424, dtype=torch.float64)
5 gae_duplicate tensor(-2.8385, dtype=torch.float64) tensor(7.3067, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8107, dtype=torch.float64) delta_t tensor(-0.2732, dtype=torch.float64)
4 gae_duplicate tensor(-5.5168, dtype=torch.float64) tensor(15.2939, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0856, dtype=torch.float64) delta_t tensor(0.2356, dtype=torch.float64)
3 gae_duplicate tensor(-3.5051, dtype=torch.float64) tensor(0.9954, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4946, dtype=torch.float64) delta_t tensor(-0.0992, dtype=torch.float64)
2 gae_duplicate tensor(-2.6838, dtype=torch.float64) tensor(0.8755, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1023.584716796875
value loss:617.5269775390625
entropies:89.10173797607422
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.793114900588989 seconds
19 rew tensor(0.6699, dtype=torch.float64) delta_t tensor(-0.3962, dtype=torch.float64)
19 gae_duplicate tensor(-0.9974, dtype=torch.float64) tensor(4.7409, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5996, dtype=torch.float64) delta_t tensor(0.7296, dtype=torch.float64)
18 gae_duplicate tensor(-0.5228, dtype=torch.float64) tensor(-1.7041, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4505, dtype=torch.float64) delta_t tensor(0.4491, dtype=torch.float64)
17 gae_duplicate tensor(-0.4851, dtype=torch.float64) tensor(-3.1018, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5245, dtype=torch.float64) delta_t tensor(0.5071, dtype=torch.float64)
16 gae_duplicate tensor(-0.5046, dtype=torch.float64) tensor(-1.3968, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3238, dtype=torch.float64) delta_t tensor(0.4668, dtype=torch.float64)
15 gae_duplicate tensor(-0.6173, dtype=torch.float64) tensor(-2.0565, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6856, dtype=torch.float64) delta_t tensor(0.4384, dtype=torch.float64)
14 gae_duplicate tensor(0.1882, dtype=torch.float64) tensor(-8.1648, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6307, dtype=torch.float64) delta_t tensor(0.4562, dtype=torch.float64)
13 gae_duplicate tensor(0.6669, dtype=torch.float64) tensor(-8.2046, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5601, dtype=torch.float64) delta_t tensor(0.2092, dtype=torch.float64)
12 gae_duplicate tensor(1.0079, dtype=torch.float64) tensor(-8.9156, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4970, dtype=torch.float64) delta_t tensor(0.4044, dtype=torch.float64)
11 gae_duplicate tensor(1.2809, dtype=torch.float64) tensor(-6.7763, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1899, dtype=torch.float64) delta_t tensor(-0.2002, dtype=torch.float64)
10 gae_duplicate tensor(0.2371, dtype=torch.float64) tensor(-3.2686, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7558, dtype=torch.float64) delta_t tensor(-0.9575, dtype=torch.float64)
9 gae_duplicate tensor(-2.4061, dtype=torch.float64) tensor(0.0474, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5742, dtype=torch.float64) delta_t tensor(-0.6332, dtype=torch.float64)
8 gae_duplicate tensor(-3.7381, dtype=torch.float64) tensor(-0.7630, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3934, dtype=torch.float64) delta_t tensor(-0.0657, dtype=torch.float64)
7 gae_duplicate tensor(-4.0242, dtype=torch.float64) tensor(-3.0437, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0715, dtype=torch.float64) delta_t tensor(0.0449, dtype=torch.float64)
6 gae_duplicate tensor(-4.2636, dtype=torch.float64) tensor(1.3169, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2350, dtype=torch.float64) delta_t tensor(-0.5583, dtype=torch.float64)
5 gae_duplicate tensor(-5.6549, dtype=torch.float64) tensor(-2.9954, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5333, dtype=torch.float64) delta_t tensor(-0.1035, dtype=torch.float64)
4 gae_duplicate tensor(-5.0854, dtype=torch.float64) tensor(26.8115, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6224, dtype=torch.float64) delta_t tensor(-0.1387, dtype=torch.float64)
3 gae_duplicate tensor(-3.5407, dtype=torch.float64) tensor(9.8576, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1195, dtype=torch.float64) delta_t tensor(0.0042, dtype=torch.float64)
2 gae_duplicate tensor(-2.2509, dtype=torch.float64) tensor(2.2825, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:176.40911865234375
value loss:475.02764892578125
entropies:86.78524780273438
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1628.7841)
ToM Target loss= tensor(1805.3976)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.817540884017944 seconds
19 rew tensor(0.7241, dtype=torch.float64) delta_t tensor(-0.4425, dtype=torch.float64)
19 gae_duplicate tensor(-1.0562, dtype=torch.float64) tensor(4.3277, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7243, dtype=torch.float64) delta_t tensor(0.6735, dtype=torch.float64)
18 gae_duplicate tensor(-0.5430, dtype=torch.float64) tensor(0.9050, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7010, dtype=torch.float64) delta_t tensor(0.5722, dtype=torch.float64)
17 gae_duplicate tensor(-0.1744, dtype=torch.float64) tensor(-5.6794, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6307, dtype=torch.float64) delta_t tensor(0.8855, dtype=torch.float64)
16 gae_duplicate tensor(-0.4349, dtype=torch.float64) tensor(-17.6977, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5371, dtype=torch.float64) delta_t tensor(0.3902, dtype=torch.float64)
15 gae_duplicate tensor(-0.6344, dtype=torch.float64) tensor(-9.0983, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2640, dtype=torch.float64) delta_t tensor(0.1689, dtype=torch.float64)
14 gae_duplicate tensor(-2.7971, dtype=torch.float64) tensor(-5.3797, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0525, dtype=torch.float64) delta_t tensor(-0.1069, dtype=torch.float64)
13 gae_duplicate tensor(-5.4654, dtype=torch.float64) tensor(-1.4423, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6853, dtype=torch.float64) delta_t tensor(0.5451, dtype=torch.float64)
12 gae_duplicate tensor(-3.9459, dtype=torch.float64) tensor(-13.7736, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6382, dtype=torch.float64) delta_t tensor(0.1259, dtype=torch.float64)
11 gae_duplicate tensor(-2.8170, dtype=torch.float64) tensor(-10.4190, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5754, dtype=torch.float64) delta_t tensor(0.2381, dtype=torch.float64)
10 gae_duplicate tensor(-2.2154, dtype=torch.float64) tensor(-1.6931, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6007, dtype=torch.float64) delta_t tensor(-1.8318, dtype=torch.float64)
9 gae_duplicate tensor(-3.6179, dtype=torch.float64) tensor(-5.1352, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9010, dtype=torch.float64) delta_t tensor(-0.8189, dtype=torch.float64)
8 gae_duplicate tensor(-6.4827, dtype=torch.float64) tensor(2.0314, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3590, dtype=torch.float64) delta_t tensor(-0.3046, dtype=torch.float64)
7 gae_duplicate tensor(-4.7012, dtype=torch.float64) tensor(9.1526, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7441, dtype=torch.float64) delta_t tensor(-0.3363, dtype=torch.float64)
6 gae_duplicate tensor(-2.3554, dtype=torch.float64) tensor(2.1142, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2622, dtype=torch.float64) delta_t tensor(-0.6897, dtype=torch.float64)
5 gae_duplicate tensor(-3.8063, dtype=torch.float64) tensor(9.6740, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2166, dtype=torch.float64) delta_t tensor(-1.7844, dtype=torch.float64)
4 gae_duplicate tensor(-9.1543, dtype=torch.float64) tensor(-0.3865, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1376, dtype=torch.float64) delta_t tensor(0.2547, dtype=torch.float64)
3 gae_duplicate tensor(-7.7882, dtype=torch.float64) tensor(3.2175, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1447, dtype=torch.float64) delta_t tensor(0.1358, dtype=torch.float64)
2 gae_duplicate tensor(-5.5969, dtype=torch.float64) tensor(2.3533, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1314.1204833984375
value loss:1128.771484375
entropies:85.1629409790039
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.098636150360107 seconds
19 rew tensor(0.6704, dtype=torch.float64) delta_t tensor(-0.2391, dtype=torch.float64)
19 gae_duplicate tensor(-1.4122, dtype=torch.float64) tensor(2.2969, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5786, dtype=torch.float64) delta_t tensor(0.4988, dtype=torch.float64)
18 gae_duplicate tensor(-1.2899, dtype=torch.float64) tensor(-0.0688, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4339, dtype=torch.float64) delta_t tensor(0.4406, dtype=torch.float64)
17 gae_duplicate tensor(-1.1938, dtype=torch.float64) tensor(2.0551, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6919, dtype=torch.float64) delta_t tensor(0.5478, dtype=torch.float64)
16 gae_duplicate tensor(-0.2262, dtype=torch.float64) tensor(-9.6437, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6997, dtype=torch.float64) delta_t tensor(0.6084, dtype=torch.float64)
15 gae_duplicate tensor(0.5480, dtype=torch.float64) tensor(-1.9575, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6289, dtype=torch.float64) delta_t tensor(0.4964, dtype=torch.float64)
14 gae_duplicate tensor(1.0574, dtype=torch.float64) tensor(-8.7391, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6448, dtype=torch.float64) delta_t tensor(0.8091, dtype=torch.float64)
13 gae_duplicate tensor(1.2611, dtype=torch.float64) tensor(-7.5661, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6372, dtype=torch.float64) delta_t tensor(0.2296, dtype=torch.float64)
12 gae_duplicate tensor(1.2720, dtype=torch.float64) tensor(-12.5904, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6301, dtype=torch.float64) delta_t tensor(0.3028, dtype=torch.float64)
11 gae_duplicate tensor(1.1383, dtype=torch.float64) tensor(-6.1989, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5279, dtype=torch.float64) delta_t tensor(0.0915, dtype=torch.float64)
10 gae_duplicate tensor(0.5242, dtype=torch.float64) tensor(-5.6295, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6279, dtype=torch.float64) delta_t tensor(-1.7495, dtype=torch.float64)
9 gae_duplicate tensor(-6.0773, dtype=torch.float64) tensor(0.5936, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5527, dtype=torch.float64) delta_t tensor(-0.5421, dtype=torch.float64)
8 gae_duplicate tensor(-5.0545, dtype=torch.float64) tensor(14.9222, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3938, dtype=torch.float64) delta_t tensor(-0.4693, dtype=torch.float64)
7 gae_duplicate tensor(-3.8429, dtype=torch.float64) tensor(7.7286, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2804, dtype=torch.float64) delta_t tensor(-0.9198, dtype=torch.float64)
6 gae_duplicate tensor(-4.8461, dtype=torch.float64) tensor(11.7127, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0286, dtype=torch.float64) delta_t tensor(-0.4356, dtype=torch.float64)
5 gae_duplicate tensor(-5.3262, dtype=torch.float64) tensor(16.0098, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6599, dtype=torch.float64) delta_t tensor(-1.3548, dtype=torch.float64)
4 gae_duplicate tensor(-9.1512, dtype=torch.float64) tensor(14.0862, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1040, dtype=torch.float64) delta_t tensor(0.5906, dtype=torch.float64)
3 gae_duplicate tensor(-7.1663, dtype=torch.float64) tensor(19.5967, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3000, dtype=torch.float64) delta_t tensor(0.0350, dtype=torch.float64)
2 gae_duplicate tensor(-5.8831, dtype=torch.float64) tensor(1.7359, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1395.598876953125
value loss:942.966796875
entropies:84.57711029052734
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.98858904838562 seconds
19 rew tensor(0.7152, dtype=torch.float64) delta_t tensor(-0.5228, dtype=torch.float64)
19 gae_duplicate tensor(-0.9878, dtype=torch.float64) tensor(2.1969, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6917, dtype=torch.float64) delta_t tensor(0.5309, dtype=torch.float64)
18 gae_duplicate tensor(-0.2445, dtype=torch.float64) tensor(-0.3590, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6447, dtype=torch.float64) delta_t tensor(0.4960, dtype=torch.float64)
17 gae_duplicate tensor(-0.0789, dtype=torch.float64) tensor(-0.6717, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5348, dtype=torch.float64) delta_t tensor(0.2818, dtype=torch.float64)
16 gae_duplicate tensor(-0.2586, dtype=torch.float64) tensor(-9.1298, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3699, dtype=torch.float64) delta_t tensor(0.2746, dtype=torch.float64)
15 gae_duplicate tensor(-0.9008, dtype=torch.float64) tensor(-4.3130, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7392, dtype=torch.float64) delta_t tensor(0.6702, dtype=torch.float64)
14 gae_duplicate tensor(-0.2735, dtype=torch.float64) tensor(-14.9114, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4323, dtype=torch.float64) delta_t tensor(0.3112, dtype=torch.float64)
13 gae_duplicate tensor(-0.1861, dtype=torch.float64) tensor(-7.8655, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3566, dtype=torch.float64) delta_t tensor(-0.5104, dtype=torch.float64)
12 gae_duplicate tensor(-4.6189, dtype=torch.float64) tensor(-2.3915, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0949, dtype=torch.float64) delta_t tensor(0.1642, dtype=torch.float64)
11 gae_duplicate tensor(-5.1127, dtype=torch.float64) tensor(-6.7888, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4823, dtype=torch.float64) delta_t tensor(-0.0183, dtype=torch.float64)
10 gae_duplicate tensor(-3.7626, dtype=torch.float64) tensor(-1.0694, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4277, dtype=torch.float64) delta_t tensor(0.4427, dtype=torch.float64)
9 gae_duplicate tensor(-2.2969, dtype=torch.float64) tensor(-1.1310, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3161, dtype=torch.float64) delta_t tensor(0.3740, dtype=torch.float64)
8 gae_duplicate tensor(-1.2177, dtype=torch.float64) tensor(-9.0054, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2289, dtype=torch.float64) delta_t tensor(-0.1873, dtype=torch.float64)
7 gae_duplicate tensor(-1.0609, dtype=torch.float64) tensor(-8.4540, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6101, dtype=torch.float64) delta_t tensor(-0.4283, dtype=torch.float64)
6 gae_duplicate tensor(-0.9830, dtype=torch.float64) tensor(0.3549, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4168, dtype=torch.float64) delta_t tensor(-0.1221, dtype=torch.float64)
5 gae_duplicate tensor(-1.5884, dtype=torch.float64) tensor(-1.0341, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5090, dtype=torch.float64) delta_t tensor(0.1351, dtype=torch.float64)
4 gae_duplicate tensor(-0.9484, dtype=torch.float64) tensor(0.2863, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1237, dtype=torch.float64) delta_t tensor(0.2849, dtype=torch.float64)
3 gae_duplicate tensor(-0.4123, dtype=torch.float64) tensor(0.6740, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3480, dtype=torch.float64) delta_t tensor(0.1145, dtype=torch.float64)
2 gae_duplicate tensor(-0.0781, dtype=torch.float64) tensor(-1.0681, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2313.487548828125
value loss:366.41802978515625
entropies:83.42455291748047
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.6983349323272705 seconds
19 rew tensor(0.7080, dtype=torch.float64) delta_t tensor(-0.5110, dtype=torch.float64)
19 gae_duplicate tensor(-1.0823, dtype=torch.float64) tensor(4.6430, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6454, dtype=torch.float64) delta_t tensor(0.4466, dtype=torch.float64)
18 gae_duplicate tensor(-0.6054, dtype=torch.float64) tensor(-0.0264, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5517, dtype=torch.float64) delta_t tensor(0.2732, dtype=torch.float64)
17 gae_duplicate tensor(-0.3082, dtype=torch.float64) tensor(-0.4002, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3645, dtype=torch.float64) delta_t tensor(0.1541, dtype=torch.float64)
16 gae_duplicate tensor(-0.2973, dtype=torch.float64) tensor(-1.1576, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0675, dtype=torch.float64) delta_t tensor(0.5363, dtype=torch.float64)
15 gae_duplicate tensor(-0.2621, dtype=torch.float64) tensor(-4.5552, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7473, dtype=torch.float64) delta_t tensor(0.6360, dtype=torch.float64)
14 gae_duplicate tensor(0.2089, dtype=torch.float64) tensor(-13.1036, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7005, dtype=torch.float64) delta_t tensor(0.5533, dtype=torch.float64)
13 gae_duplicate tensor(0.6737, dtype=torch.float64) tensor(-11.2760, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3865, dtype=torch.float64) delta_t tensor(0.2276, dtype=torch.float64)
12 gae_duplicate tensor(-0.6488, dtype=torch.float64) tensor(-1.9506, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3254, dtype=torch.float64) delta_t tensor(-0.4286, dtype=torch.float64)
11 gae_duplicate tensor(-0.5517, dtype=torch.float64) tensor(-0.8926, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1705, dtype=torch.float64) delta_t tensor(-0.9296, dtype=torch.float64)
10 gae_duplicate tensor(-3.4197, dtype=torch.float64) tensor(0.3488, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2795, dtype=torch.float64) delta_t tensor(0.0932, dtype=torch.float64)
9 gae_duplicate tensor(-2.2424, dtype=torch.float64) tensor(7.2366, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1101, dtype=torch.float64) delta_t tensor(-0.2036, dtype=torch.float64)
8 gae_duplicate tensor(-1.8860, dtype=torch.float64) tensor(0.4131, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4002, dtype=torch.float64) delta_t tensor(0.1563, dtype=torch.float64)
7 gae_duplicate tensor(-1.1786, dtype=torch.float64) tensor(0.1764, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0485, dtype=torch.float64) delta_t tensor(0.1522, dtype=torch.float64)
6 gae_duplicate tensor(-1.0914, dtype=torch.float64) tensor(-8.6764, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5863, dtype=torch.float64) delta_t tensor(-0.2053, dtype=torch.float64)
5 gae_duplicate tensor(-1.3625, dtype=torch.float64) tensor(1.3777, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2087, dtype=torch.float64) delta_t tensor(0.8558, dtype=torch.float64)
4 gae_duplicate tensor(-1.2019, dtype=torch.float64) tensor(-0.9674, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4985, dtype=torch.float64) delta_t tensor(0.0816, dtype=torch.float64)
3 gae_duplicate tensor(-1.3886, dtype=torch.float64) tensor(2.4995, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0894, dtype=torch.float64) delta_t tensor(-0.3709, dtype=torch.float64)
2 gae_duplicate tensor(-1.7896, dtype=torch.float64) tensor(-0.8994, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:964.5315551757812
value loss:239.43325805664062
entropies:83.58068084716797
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.157381296157837 seconds
19 rew tensor(0.6680, dtype=torch.float64) delta_t tensor(-0.3631, dtype=torch.float64)
19 gae_duplicate tensor(-1.2908, dtype=torch.float64) tensor(-1.1250, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5739, dtype=torch.float64) delta_t tensor(0.5002, dtype=torch.float64)
18 gae_duplicate tensor(-0.9607, dtype=torch.float64) tensor(2.5259, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4327, dtype=torch.float64) delta_t tensor(0.5695, dtype=torch.float64)
17 gae_duplicate tensor(-0.1621, dtype=torch.float64) tensor(-1.1488, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6297, dtype=torch.float64) delta_t tensor(0.5207, dtype=torch.float64)
16 gae_duplicate tensor(-0.1297, dtype=torch.float64) tensor(-1.6119, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5358, dtype=torch.float64) delta_t tensor(1.0575, dtype=torch.float64)
15 gae_duplicate tensor(-0.1517, dtype=torch.float64) tensor(-14.2512, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7009, dtype=torch.float64) delta_t tensor(0.5421, dtype=torch.float64)
14 gae_duplicate tensor(0.4286, dtype=torch.float64) tensor(-10.6892, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6552, dtype=torch.float64) delta_t tensor(0.6830, dtype=torch.float64)
13 gae_duplicate tensor(0.8929, dtype=torch.float64) tensor(-3.1602, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3478, dtype=torch.float64) delta_t tensor(-0.7846, dtype=torch.float64)
12 gae_duplicate tensor(-4.3845, dtype=torch.float64) tensor(-17.9499, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3762, dtype=torch.float64) delta_t tensor(-0.4314, dtype=torch.float64)
11 gae_duplicate tensor(-5.7886, dtype=torch.float64) tensor(-11.3869, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3067, dtype=torch.float64) delta_t tensor(-0.3379, dtype=torch.float64)
10 gae_duplicate tensor(-4.6250, dtype=torch.float64) tensor(-0.0378, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1540, dtype=torch.float64) delta_t tensor(0.0508, dtype=torch.float64)
9 gae_duplicate tensor(-3.6549, dtype=torch.float64) tensor(-1.2273, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0209, dtype=torch.float64) delta_t tensor(-0.0392, dtype=torch.float64)
8 gae_duplicate tensor(-2.2709, dtype=torch.float64) tensor(-0.0917, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3238, dtype=torch.float64) delta_t tensor(-0.2320, dtype=torch.float64)
7 gae_duplicate tensor(-2.4582, dtype=torch.float64) tensor(3.6212, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9843, dtype=torch.float64) delta_t tensor(-0.7574, dtype=torch.float64)
6 gae_duplicate tensor(-3.3314, dtype=torch.float64) tensor(1.1760, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9253, dtype=torch.float64) delta_t tensor(-1.4327, dtype=torch.float64)
5 gae_duplicate tensor(-6.9569, dtype=torch.float64) tensor(1.5599, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4111, dtype=torch.float64) delta_t tensor(-0.9166, dtype=torch.float64)
4 gae_duplicate tensor(-7.9681, dtype=torch.float64) tensor(3.6511, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0197, dtype=torch.float64) delta_t tensor(0.3848, dtype=torch.float64)
3 gae_duplicate tensor(-5.4697, dtype=torch.float64) tensor(10.6114, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2238, dtype=torch.float64) delta_t tensor(0.1185, dtype=torch.float64)
2 gae_duplicate tensor(-4.2529, dtype=torch.float64) tensor(1.4457, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1356.309814453125
value loss:944.68212890625
entropies:82.71753692626953
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1545.0052)
ToM Target loss= tensor(1809.8241)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.23782205581665 seconds
19 rew tensor(0.5772, dtype=torch.float64) delta_t tensor(-0.9726, dtype=torch.float64)
19 gae_duplicate tensor(-1.5868, dtype=torch.float64) tensor(3.2454, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4232, dtype=torch.float64) delta_t tensor(0.3292, dtype=torch.float64)
18 gae_duplicate tensor(-1.2068, dtype=torch.float64) tensor(1.5741, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5895, dtype=torch.float64) delta_t tensor(0.4117, dtype=torch.float64)
17 gae_duplicate tensor(-0.3226, dtype=torch.float64) tensor(1.4583, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4164, dtype=torch.float64) delta_t tensor(0.1961, dtype=torch.float64)
16 gae_duplicate tensor(-0.1858, dtype=torch.float64) tensor(-0.3846, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1332, dtype=torch.float64) delta_t tensor(0.5721, dtype=torch.float64)
15 gae_duplicate tensor(-0.1793, dtype=torch.float64) tensor(-2.0355, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6223, dtype=torch.float64) delta_t tensor(0.4955, dtype=torch.float64)
14 gae_duplicate tensor(0.2245, dtype=torch.float64) tensor(-10.7287, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7471, dtype=torch.float64) delta_t tensor(0.4787, dtype=torch.float64)
13 gae_duplicate tensor(0.6763, dtype=torch.float64) tensor(-10.8971, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.8141, dtype=torch.float64) delta_t tensor(-1.1099, dtype=torch.float64)
12 gae_duplicate tensor(-2.7038, dtype=torch.float64) tensor(1.0809, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4257, dtype=torch.float64) delta_t tensor(0.1513, dtype=torch.float64)
11 gae_duplicate tensor(-2.8555, dtype=torch.float64) tensor(-5.1981, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.9185, dtype=torch.float64) delta_t tensor(-1.4631, dtype=torch.float64)
10 gae_duplicate tensor(-3.8183, dtype=torch.float64) tensor(11.3193, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1216, dtype=torch.float64) delta_t tensor(-1.3148, dtype=torch.float64)
9 gae_duplicate tensor(-4.4404, dtype=torch.float64) tensor(3.1483, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0516, dtype=torch.float64) delta_t tensor(-0.2370, dtype=torch.float64)
8 gae_duplicate tensor(-4.7889, dtype=torch.float64) tensor(3.6470, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1813, dtype=torch.float64) delta_t tensor(0.2790, dtype=torch.float64)
7 gae_duplicate tensor(-2.7826, dtype=torch.float64) tensor(13.3948, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2825, dtype=torch.float64) delta_t tensor(0.0988, dtype=torch.float64)
6 gae_duplicate tensor(-1.7159, dtype=torch.float64) tensor(1.4494, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0450, dtype=torch.float64) delta_t tensor(-0.4870, dtype=torch.float64)
5 gae_duplicate tensor(-1.8906, dtype=torch.float64) tensor(1.6761, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4340, dtype=torch.float64) delta_t tensor(0.9322, dtype=torch.float64)
4 gae_duplicate tensor(-0.8217, dtype=torch.float64) tensor(-0.1517, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6676, dtype=torch.float64) delta_t tensor(-0.2347, dtype=torch.float64)
3 gae_duplicate tensor(-0.8152, dtype=torch.float64) tensor(0.9268, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0982, dtype=torch.float64) delta_t tensor(-0.2849, dtype=torch.float64)
2 gae_duplicate tensor(-1.2756, dtype=torch.float64) tensor(2.3914, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-587.8815307617188
value loss:406.79156494140625
entropies:82.76730346679688
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.524358034133911 seconds
19 rew tensor(0.7383, dtype=torch.float64) delta_t tensor(-0.4824, dtype=torch.float64)
19 gae_duplicate tensor(-0.8847, dtype=torch.float64) tensor(6.3627, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7227, dtype=torch.float64) delta_t tensor(0.4846, dtype=torch.float64)
18 gae_duplicate tensor(-0.4065, dtype=torch.float64) tensor(-0.1167, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7071, dtype=torch.float64) delta_t tensor(0.5032, dtype=torch.float64)
17 gae_duplicate tensor(0.1626, dtype=torch.float64) tensor(-2.1070, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6444, dtype=torch.float64) delta_t tensor(0.4285, dtype=torch.float64)
16 gae_duplicate tensor(-0.1813, dtype=torch.float64) tensor(-0.6866, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5817, dtype=torch.float64) delta_t tensor(0.7060, dtype=torch.float64)
15 gae_duplicate tensor(-0.1406, dtype=torch.float64) tensor(-1.8537, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5893, dtype=torch.float64) delta_t tensor(0.3469, dtype=torch.float64)
14 gae_duplicate tensor(0.4447, dtype=torch.float64) tensor(-16.6504, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0392, dtype=torch.float64) delta_t tensor(-0.2066, dtype=torch.float64)
13 gae_duplicate tensor(-1.9145, dtype=torch.float64) tensor(-4.5538, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2594, dtype=torch.float64) delta_t tensor(0.0628, dtype=torch.float64)
12 gae_duplicate tensor(-2.1794, dtype=torch.float64) tensor(1.3382, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5266, dtype=torch.float64) delta_t tensor(0.4082, dtype=torch.float64)
11 gae_duplicate tensor(-2.2947, dtype=torch.float64) tensor(-7.9984, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5898, dtype=torch.float64) delta_t tensor(0.0577, dtype=torch.float64)
10 gae_duplicate tensor(-1.1635, dtype=torch.float64) tensor(-1.2339, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8083, dtype=torch.float64) delta_t tensor(-0.8186, dtype=torch.float64)
9 gae_duplicate tensor(-5.5527, dtype=torch.float64) tensor(0.1062, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5010, dtype=torch.float64) delta_t tensor(-0.7179, dtype=torch.float64)
8 gae_duplicate tensor(-4.8754, dtype=torch.float64) tensor(1.1115, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4619, dtype=torch.float64) delta_t tensor(-0.5038, dtype=torch.float64)
7 gae_duplicate tensor(-3.6152, dtype=torch.float64) tensor(14.6231, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3896, dtype=torch.float64) delta_t tensor(-0.2765, dtype=torch.float64)
6 gae_duplicate tensor(-3.9299, dtype=torch.float64) tensor(1.5816, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2180, dtype=torch.float64) delta_t tensor(-0.5312, dtype=torch.float64)
5 gae_duplicate tensor(-5.2738, dtype=torch.float64) tensor(0.6140, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3222, dtype=torch.float64) delta_t tensor(-0.8594, dtype=torch.float64)
4 gae_duplicate tensor(-8.9442, dtype=torch.float64) tensor(49.6202, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2707, dtype=torch.float64) delta_t tensor(-0.0096, dtype=torch.float64)
3 gae_duplicate tensor(-6.9996, dtype=torch.float64) tensor(2.0216, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1052, dtype=torch.float64) delta_t tensor(-0.0311, dtype=torch.float64)
2 gae_duplicate tensor(-5.1475, dtype=torch.float64) tensor(2.2421, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1614.0474853515625
value loss:800.2314453125
entropies:82.77460479736328
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.720588684082031 seconds
19 rew tensor(0.7229, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
19 gae_duplicate tensor(-0.7820, dtype=torch.float64) tensor(1.7022, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6997, dtype=torch.float64) delta_t tensor(0.5915, dtype=torch.float64)
18 gae_duplicate tensor(-0.4141, dtype=torch.float64) tensor(-4.0633, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7155, dtype=torch.float64) delta_t tensor(0.6490, dtype=torch.float64)
17 gae_duplicate tensor(0.0634, dtype=torch.float64) tensor(-1.4690, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6697, dtype=torch.float64) delta_t tensor(0.3854, dtype=torch.float64)
16 gae_duplicate tensor(0.4454, dtype=torch.float64) tensor(-4.7769, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6085, dtype=torch.float64) delta_t tensor(0.6019, dtype=torch.float64)
15 gae_duplicate tensor(0.7512, dtype=torch.float64) tensor(-2.1880, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7150, dtype=torch.float64) delta_t tensor(0.5775, dtype=torch.float64)
14 gae_duplicate tensor(0.9960, dtype=torch.float64) tensor(-8.2563, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7309, dtype=torch.float64) delta_t tensor(0.6770, dtype=torch.float64)
13 gae_duplicate tensor(1.1919, dtype=torch.float64) tensor(-2.8429, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6453, dtype=torch.float64) delta_t tensor(0.5346, dtype=torch.float64)
12 gae_duplicate tensor(1.9712, dtype=torch.float64) tensor(-20.1034, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6217, dtype=torch.float64) delta_t tensor(0.5179, dtype=torch.float64)
11 gae_duplicate tensor(1.9411, dtype=torch.float64) tensor(-14.1964, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1991, dtype=torch.float64) delta_t tensor(-0.3210, dtype=torch.float64)
10 gae_duplicate tensor(0.0719, dtype=torch.float64) tensor(-2.0600, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6839, dtype=torch.float64) delta_t tensor(-1.9756, dtype=torch.float64)
9 gae_duplicate tensor(-5.3789, dtype=torch.float64) tensor(8.4765, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4558, dtype=torch.float64) delta_t tensor(-0.2074, dtype=torch.float64)
8 gae_duplicate tensor(-3.2493, dtype=torch.float64) tensor(-1.0305, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1005, dtype=torch.float64) delta_t tensor(-0.1865, dtype=torch.float64)
7 gae_duplicate tensor(-3.1796, dtype=torch.float64) tensor(0.0133, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5064, dtype=torch.float64) delta_t tensor(-0.2813, dtype=torch.float64)
6 gae_duplicate tensor(-2.7727, dtype=torch.float64) tensor(-1.0322, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9038, dtype=torch.float64) delta_t tensor(-0.4925, dtype=torch.float64)
5 gae_duplicate tensor(-2.7950, dtype=torch.float64) tensor(3.1317, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9063, dtype=torch.float64) delta_t tensor(-0.3379, dtype=torch.float64)
4 gae_duplicate tensor(-5.1650, dtype=torch.float64) tensor(1.6706, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0035, dtype=torch.float64) delta_t tensor(0.3027, dtype=torch.float64)
3 gae_duplicate tensor(-3.6477, dtype=torch.float64) tensor(0.9118, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2226, dtype=torch.float64) delta_t tensor(0.0587, dtype=torch.float64)
2 gae_duplicate tensor(-2.7185, dtype=torch.float64) tensor(-0.2621, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1654.730224609375
value loss:612.1168823242188
entropies:82.07530975341797
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.629679918289185 seconds
19 rew tensor(0.6908, dtype=torch.float64) delta_t tensor(-0.4736, dtype=torch.float64)
19 gae_duplicate tensor(-0.9085, dtype=torch.float64) tensor(1.5887, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6830, dtype=torch.float64) delta_t tensor(0.4627, dtype=torch.float64)
18 gae_duplicate tensor(-0.3494, dtype=torch.float64) tensor(-0.1093, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6127, dtype=torch.float64) delta_t tensor(0.3917, dtype=torch.float64)
17 gae_duplicate tensor(0.0256, dtype=torch.float64) tensor(-0.6931, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4718, dtype=torch.float64) delta_t tensor(0.2189, dtype=torch.float64)
16 gae_duplicate tensor(-0.3301, dtype=torch.float64) tensor(0.0056, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2135, dtype=torch.float64) delta_t tensor(0.5300, dtype=torch.float64)
15 gae_duplicate tensor(-0.5798, dtype=torch.float64) tensor(-2.0877, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7381, dtype=torch.float64) delta_t tensor(0.6402, dtype=torch.float64)
14 gae_duplicate tensor(0.8618, dtype=torch.float64) tensor(-6.8656, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7148, dtype=torch.float64) delta_t tensor(0.6302, dtype=torch.float64)
13 gae_duplicate tensor(1.3311, dtype=torch.float64) tensor(-12.3708, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2417, dtype=torch.float64) delta_t tensor(0.1155, dtype=torch.float64)
12 gae_duplicate tensor(-1.0281, dtype=torch.float64) tensor(-7.9164, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7356, dtype=torch.float64) delta_t tensor(-0.7718, dtype=torch.float64)
11 gae_duplicate tensor(-5.7760, dtype=torch.float64) tensor(-7.9167, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2690, dtype=torch.float64) delta_t tensor(-0.1965, dtype=torch.float64)
10 gae_duplicate tensor(-5.9053, dtype=torch.float64) tensor(-0.1937, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1499, dtype=torch.float64) delta_t tensor(-0.0611, dtype=torch.float64)
9 gae_duplicate tensor(-4.4130, dtype=torch.float64) tensor(-13.8371, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6357, dtype=torch.float64) delta_t tensor(-0.7164, dtype=torch.float64)
8 gae_duplicate tensor(-3.3215, dtype=torch.float64) tensor(0.8683, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5985, dtype=torch.float64) delta_t tensor(-0.4427, dtype=torch.float64)
7 gae_duplicate tensor(-2.5710, dtype=torch.float64) tensor(5.6519, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5366, dtype=torch.float64) delta_t tensor(-0.4884, dtype=torch.float64)
6 gae_duplicate tensor(-3.5804, dtype=torch.float64) tensor(1.5251, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9772, dtype=torch.float64) delta_t tensor(-0.3778, dtype=torch.float64)
5 gae_duplicate tensor(-4.1162, dtype=torch.float64) tensor(11.9248, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6471, dtype=torch.float64) delta_t tensor(-1.1199, dtype=torch.float64)
4 gae_duplicate tensor(-8.5979, dtype=torch.float64) tensor(1.3463, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3423, dtype=torch.float64) delta_t tensor(-0.1297, dtype=torch.float64)
3 gae_duplicate tensor(-6.0290, dtype=torch.float64) tensor(2.2026, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0971, dtype=torch.float64) delta_t tensor(0.0521, dtype=torch.float64)
2 gae_duplicate tensor(-4.7405, dtype=torch.float64) tensor(1.7342, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:890.202392578125
value loss:771.5931396484375
entropies:83.00438690185547
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.58276891708374 seconds
19 rew tensor(0.6595, dtype=torch.float64) delta_t tensor(-0.7560, dtype=torch.float64)
19 gae_duplicate tensor(-1.3682, dtype=torch.float64) tensor(3.6482, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6129, dtype=torch.float64) delta_t tensor(0.6129, dtype=torch.float64)
18 gae_duplicate tensor(-0.6708, dtype=torch.float64) tensor(1.6519, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2989, dtype=torch.float64) delta_t tensor(0.0764, dtype=torch.float64)
17 gae_duplicate tensor(-0.6550, dtype=torch.float64) tensor(4.8339, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6117, dtype=torch.float64) delta_t tensor(0.4263, dtype=torch.float64)
16 gae_duplicate tensor(-0.4810, dtype=torch.float64) tensor(-4.7628, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4938, dtype=torch.float64) delta_t tensor(0.3233, dtype=torch.float64)
15 gae_duplicate tensor(-0.4363, dtype=torch.float64) tensor(-6.6525, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6348, dtype=torch.float64) delta_t tensor(0.4592, dtype=torch.float64)
14 gae_duplicate tensor(-0.0261, dtype=torch.float64) tensor(-4.6655, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7140, dtype=torch.float64) delta_t tensor(0.5776, dtype=torch.float64)
13 gae_duplicate tensor(0.6845, dtype=torch.float64) tensor(-1.9305, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5492, dtype=torch.float64) delta_t tensor(0.1784, dtype=torch.float64)
12 gae_duplicate tensor(0.2007, dtype=torch.float64) tensor(-1.7940, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4707, dtype=torch.float64) delta_t tensor(0.4193, dtype=torch.float64)
11 gae_duplicate tensor(-0.2216, dtype=torch.float64) tensor(-4.8873, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1354, dtype=torch.float64) delta_t tensor(-0.4464, dtype=torch.float64)
10 gae_duplicate tensor(-1.2909, dtype=torch.float64) tensor(1.0174, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0660, dtype=torch.float64) delta_t tensor(-0.0242, dtype=torch.float64)
9 gae_duplicate tensor(-2.5831, dtype=torch.float64) tensor(-0.7546, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0451, dtype=torch.float64) delta_t tensor(-0.1308, dtype=torch.float64)
8 gae_duplicate tensor(-1.2602, dtype=torch.float64) tensor(-9.4484, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1971, dtype=torch.float64) delta_t tensor(-0.1243, dtype=torch.float64)
7 gae_duplicate tensor(-0.5640, dtype=torch.float64) tensor(0.8663, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5674, dtype=torch.float64) delta_t tensor(-0.0113, dtype=torch.float64)
6 gae_duplicate tensor(-1.0262, dtype=torch.float64) tensor(0.5133, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4286, dtype=torch.float64) delta_t tensor(-0.2211, dtype=torch.float64)
5 gae_duplicate tensor(-1.4347, dtype=torch.float64) tensor(-3.7528, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6634, dtype=torch.float64) delta_t tensor(-1.0654, dtype=torch.float64)
4 gae_duplicate tensor(-8.8708, dtype=torch.float64) tensor(1.4596, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2255, dtype=torch.float64) delta_t tensor(-0.0712, dtype=torch.float64)
3 gae_duplicate tensor(-6.6903, dtype=torch.float64) tensor(4.8543, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1266, dtype=torch.float64) delta_t tensor(-0.3557, dtype=torch.float64)
2 gae_duplicate tensor(-5.1652, dtype=torch.float64) tensor(1.5254, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:642.738037109375
value loss:453.0152282714844
entropies:84.83631896972656
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1564.8315)
ToM Target loss= tensor(1813.7408)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.66199803352356 seconds
19 rew tensor(0.7135, dtype=torch.float64) delta_t tensor(-0.5776, dtype=torch.float64)
19 gae_duplicate tensor(-1.0404, dtype=torch.float64) tensor(8.0145, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7057, dtype=torch.float64) delta_t tensor(0.4732, dtype=torch.float64)
18 gae_duplicate tensor(-0.6277, dtype=torch.float64) tensor(0.2798, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6744, dtype=torch.float64) delta_t tensor(0.3187, dtype=torch.float64)
17 gae_duplicate tensor(-0.5054, dtype=torch.float64) tensor(-0.4672, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6196, dtype=torch.float64) delta_t tensor(0.2066, dtype=torch.float64)
16 gae_duplicate tensor(-0.6784, dtype=torch.float64) tensor(-5.4016, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5095, dtype=torch.float64) delta_t tensor(0.4597, dtype=torch.float64)
15 gae_duplicate tensor(-1.0355, dtype=torch.float64) tensor(-0.6767, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7061, dtype=torch.float64) delta_t tensor(0.6024, dtype=torch.float64)
14 gae_duplicate tensor(-0.3707, dtype=torch.float64) tensor(-3.9449, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6749, dtype=torch.float64) delta_t tensor(0.4805, dtype=torch.float64)
13 gae_duplicate tensor(0.1898, dtype=torch.float64) tensor(-25.5762, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1169, dtype=torch.float64) delta_t tensor(-0.2009, dtype=torch.float64)
12 gae_duplicate tensor(-3.1341, dtype=torch.float64) tensor(-1.3464, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8292, dtype=torch.float64) delta_t tensor(-0.8333, dtype=torch.float64)
11 gae_duplicate tensor(-4.4628, dtype=torch.float64) tensor(-4.5884, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2317, dtype=torch.float64) delta_t tensor(-0.5627, dtype=torch.float64)
10 gae_duplicate tensor(-7.4063, dtype=torch.float64) tensor(13.3398, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6808, dtype=torch.float64) delta_t tensor(-0.8577, dtype=torch.float64)
9 gae_duplicate tensor(-5.3360, dtype=torch.float64) tensor(16.0606, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1176, dtype=torch.float64) delta_t tensor(-0.3503, dtype=torch.float64)
8 gae_duplicate tensor(-4.0746, dtype=torch.float64) tensor(1.9703, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9930, dtype=torch.float64) delta_t tensor(-0.9777, dtype=torch.float64)
7 gae_duplicate tensor(-3.8185, dtype=torch.float64) tensor(15.6930, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5833, dtype=torch.float64) delta_t tensor(-0.6409, dtype=torch.float64)
6 gae_duplicate tensor(-3.9173, dtype=torch.float64) tensor(7.9071, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0478, dtype=torch.float64) delta_t tensor(-0.4467, dtype=torch.float64)
5 gae_duplicate tensor(-5.0478, dtype=torch.float64) tensor(15.8408, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7404, dtype=torch.float64) delta_t tensor(-0.0619, dtype=torch.float64)
4 gae_duplicate tensor(-5.7077, dtype=torch.float64) tensor(14.8552, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0256, dtype=torch.float64) delta_t tensor(0.2035, dtype=torch.float64)
3 gae_duplicate tensor(-4.9579, dtype=torch.float64) tensor(36.3193, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2630, dtype=torch.float64) delta_t tensor(0.0188, dtype=torch.float64)
2 gae_duplicate tensor(-3.3724, dtype=torch.float64) tensor(1.2739, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3239.296630859375
value loss:824.43896484375
entropies:85.53521728515625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.67216682434082 seconds
19 rew tensor(0.6274, dtype=torch.float64) delta_t tensor(-0.3755, dtype=torch.float64)
19 gae_duplicate tensor(-1.3752, dtype=torch.float64) tensor(2.2980, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5331, dtype=torch.float64) delta_t tensor(0.3736, dtype=torch.float64)
18 gae_duplicate tensor(-1.2534, dtype=torch.float64) tensor(-0.0463, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7377, dtype=torch.float64) delta_t tensor(0.8102, dtype=torch.float64)
17 gae_duplicate tensor(-0.4992, dtype=torch.float64) tensor(-2.9097, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7456, dtype=torch.float64) delta_t tensor(0.6076, dtype=torch.float64)
16 gae_duplicate tensor(0.1800, dtype=torch.float64) tensor(-16.5820, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7458, dtype=torch.float64) delta_t tensor(0.7370, dtype=torch.float64)
15 gae_duplicate tensor(0.7234, dtype=torch.float64) tensor(-10.8426, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6373, dtype=torch.float64) delta_t tensor(0.7980, dtype=torch.float64)
14 gae_duplicate tensor(1.1631, dtype=torch.float64) tensor(-2.8627, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5441, dtype=torch.float64) delta_t tensor(0.0436, dtype=torch.float64)
13 gae_duplicate tensor(1.3333, dtype=torch.float64) tensor(-6.0362, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4277, dtype=torch.float64) delta_t tensor(0.3826, dtype=torch.float64)
12 gae_duplicate tensor(1.4908, dtype=torch.float64) tensor(-10.4394, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0965, dtype=torch.float64) delta_t tensor(-0.3660, dtype=torch.float64)
11 gae_duplicate tensor(-0.3851, dtype=torch.float64) tensor(-5.3793, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2470, dtype=torch.float64) delta_t tensor(-0.5412, dtype=torch.float64)
10 gae_duplicate tensor(-1.9854, dtype=torch.float64) tensor(-2.0207, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2001, dtype=torch.float64) delta_t tensor(0.1188, dtype=torch.float64)
9 gae_duplicate tensor(-1.5003, dtype=torch.float64) tensor(3.1535, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1914, dtype=torch.float64) delta_t tensor(-0.1484, dtype=torch.float64)
8 gae_duplicate tensor(-1.0530, dtype=torch.float64) tensor(-5.1973, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1514, dtype=torch.float64) delta_t tensor(-0.2520, dtype=torch.float64)
7 gae_duplicate tensor(-2.4557, dtype=torch.float64) tensor(-1.5489, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3124, dtype=torch.float64) delta_t tensor(-0.2280, dtype=torch.float64)
6 gae_duplicate tensor(-3.4366, dtype=torch.float64) tensor(2.2724, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4952, dtype=torch.float64) delta_t tensor(-0.1926, dtype=torch.float64)
5 gae_duplicate tensor(-4.0438, dtype=torch.float64) tensor(0.9629, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4222, dtype=torch.float64) delta_t tensor(0.2276, dtype=torch.float64)
4 gae_duplicate tensor(-3.8139, dtype=torch.float64) tensor(-1.6934, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3000, dtype=torch.float64) delta_t tensor(-0.0817, dtype=torch.float64)
3 gae_duplicate tensor(-3.6791, dtype=torch.float64) tensor(1.7555, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3009, dtype=torch.float64) delta_t tensor(-0.4467, dtype=torch.float64)
2 gae_duplicate tensor(-2.3635, dtype=torch.float64) tensor(5.3856, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1775.2332763671875
value loss:393.09881591796875
entropies:83.74954223632812
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.000890016555786 seconds
19 rew tensor(0.7289, dtype=torch.float64) delta_t tensor(-0.3789, dtype=torch.float64)
19 gae_duplicate tensor(-0.9856, dtype=torch.float64) tensor(7.6428, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7292, dtype=torch.float64) delta_t tensor(0.3721, dtype=torch.float64)
18 gae_duplicate tensor(-0.4044, dtype=torch.float64) tensor(-0.3082, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6982, dtype=torch.float64) delta_t tensor(0.3342, dtype=torch.float64)
17 gae_duplicate tensor(-0.4152, dtype=torch.float64) tensor(-2.3297, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6678, dtype=torch.float64) delta_t tensor(0.2528, dtype=torch.float64)
16 gae_duplicate tensor(-0.2769, dtype=torch.float64) tensor(-4.3056, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5904, dtype=torch.float64) delta_t tensor(0.3825, dtype=torch.float64)
15 gae_duplicate tensor(-0.2386, dtype=torch.float64) tensor(-1.2015, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7056, dtype=torch.float64) delta_t tensor(0.5551, dtype=torch.float64)
14 gae_duplicate tensor(0.2459, dtype=torch.float64) tensor(-1.7366, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6348, dtype=torch.float64) delta_t tensor(0.4090, dtype=torch.float64)
13 gae_duplicate tensor(0.6337, dtype=torch.float64) tensor(-5.3329, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.9011, dtype=torch.float64) delta_t tensor(-1.2098, dtype=torch.float64)
12 gae_duplicate tensor(-6.7108, dtype=torch.float64) tensor(-3.3201, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2906, dtype=torch.float64) delta_t tensor(0.2200, dtype=torch.float64)
11 gae_duplicate tensor(-6.0087, dtype=torch.float64) tensor(-5.4361, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.2010, dtype=torch.float64) delta_t tensor(-1.5457, dtype=torch.float64)
10 gae_duplicate tensor(-6.2526, dtype=torch.float64) tensor(18.0532, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4277, dtype=torch.float64) delta_t tensor(-0.7284, dtype=torch.float64)
9 gae_duplicate tensor(-6.1686, dtype=torch.float64) tensor(2.2013, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4813, dtype=torch.float64) delta_t tensor(-0.5767, dtype=torch.float64)
8 gae_duplicate tensor(-4.7813, dtype=torch.float64) tensor(13.8827, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3072, dtype=torch.float64) delta_t tensor(-0.3180, dtype=torch.float64)
7 gae_duplicate tensor(-3.2932, dtype=torch.float64) tensor(22.2658, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2595, dtype=torch.float64) delta_t tensor(-0.0833, dtype=torch.float64)
6 gae_duplicate tensor(-3.3512, dtype=torch.float64) tensor(10.0922, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5803, dtype=torch.float64) delta_t tensor(-0.2722, dtype=torch.float64)
5 gae_duplicate tensor(-3.4283, dtype=torch.float64) tensor(8.9065, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7764, dtype=torch.float64) delta_t tensor(-0.2424, dtype=torch.float64)
4 gae_duplicate tensor(-7.4206, dtype=torch.float64) tensor(1.7422, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0795, dtype=torch.float64) delta_t tensor(0.0927, dtype=torch.float64)
3 gae_duplicate tensor(-4.9708, dtype=torch.float64) tensor(14.9809, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2566, dtype=torch.float64) delta_t tensor(0.0815, dtype=torch.float64)
2 gae_duplicate tensor(-3.8648, dtype=torch.float64) tensor(10.0178, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3104.822021484375
value loss:720.5039672851562
entropies:86.10729217529297
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.0570080280303955 seconds
19 rew tensor(0.7287, dtype=torch.float64) delta_t tensor(-0.5668, dtype=torch.float64)
19 gae_duplicate tensor(-1.3420, dtype=torch.float64) tensor(0.8420, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6975, dtype=torch.float64) delta_t tensor(0.4312, dtype=torch.float64)
18 gae_duplicate tensor(-0.8272, dtype=torch.float64) tensor(2.0862, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6662, dtype=torch.float64) delta_t tensor(0.2850, dtype=torch.float64)
17 gae_duplicate tensor(-0.6099, dtype=torch.float64) tensor(0.2759, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5410, dtype=torch.float64) delta_t tensor(0.0750, dtype=torch.float64)
16 gae_duplicate tensor(-0.6495, dtype=torch.float64) tensor(-1.5403, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4000, dtype=torch.float64) delta_t tensor(0.2914, dtype=torch.float64)
15 gae_duplicate tensor(-0.7265, dtype=torch.float64) tensor(-4.2593, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5754, dtype=torch.float64) delta_t tensor(0.6301, dtype=torch.float64)
14 gae_duplicate tensor(0.5943, dtype=torch.float64) tensor(-1.4370, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6904, dtype=torch.float64) delta_t tensor(0.3382, dtype=torch.float64)
13 gae_duplicate tensor(0.4000, dtype=torch.float64) tensor(-6.2050, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2135, dtype=torch.float64) delta_t tensor(-0.3292, dtype=torch.float64)
12 gae_duplicate tensor(-1.5781, dtype=torch.float64) tensor(-0.8871, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4323, dtype=torch.float64) delta_t tensor(-0.6334, dtype=torch.float64)
11 gae_duplicate tensor(-3.6426, dtype=torch.float64) tensor(-3.1660, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2592, dtype=torch.float64) delta_t tensor(-0.2153, dtype=torch.float64)
10 gae_duplicate tensor(-4.6509, dtype=torch.float64) tensor(0.4404, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1971, dtype=torch.float64) delta_t tensor(-0.3475, dtype=torch.float64)
9 gae_duplicate tensor(-2.8540, dtype=torch.float64) tensor(0.8431, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3696, dtype=torch.float64) delta_t tensor(-0.1563, dtype=torch.float64)
8 gae_duplicate tensor(-3.0392, dtype=torch.float64) tensor(13.1235, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1833, dtype=torch.float64) delta_t tensor(0.0241, dtype=torch.float64)
7 gae_duplicate tensor(-2.4211, dtype=torch.float64) tensor(6.5604, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3463, dtype=torch.float64) delta_t tensor(-0.2177, dtype=torch.float64)
6 gae_duplicate tensor(-1.9614, dtype=torch.float64) tensor(0.8436, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6204, dtype=torch.float64) delta_t tensor(-0.0940, dtype=torch.float64)
5 gae_duplicate tensor(-2.1508, dtype=torch.float64) tensor(3.3397, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1613, dtype=torch.float64) delta_t tensor(-0.7496, dtype=torch.float64)
4 gae_duplicate tensor(-6.9993, dtype=torch.float64) tensor(35.8349, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0977, dtype=torch.float64) delta_t tensor(0.2668, dtype=torch.float64)
3 gae_duplicate tensor(-4.8877, dtype=torch.float64) tensor(14.4979, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2395, dtype=torch.float64) delta_t tensor(-0.1035, dtype=torch.float64)
2 gae_duplicate tensor(-3.8070, dtype=torch.float64) tensor(3.4038, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2340.87158203125
value loss:397.4252014160156
entropies:85.49500274658203
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.891912937164307 seconds
19 rew tensor(0.7369, dtype=torch.float64) delta_t tensor(-0.7630, dtype=torch.float64)
19 gae_duplicate tensor(-1.2480, dtype=torch.float64) tensor(4.0951, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7292, dtype=torch.float64) delta_t tensor(0.4014, dtype=torch.float64)
18 gae_duplicate tensor(-0.6313, dtype=torch.float64) tensor(1.3315, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6983, dtype=torch.float64) delta_t tensor(0.1776, dtype=torch.float64)
17 gae_duplicate tensor(-0.4333, dtype=torch.float64) tensor(-0.4181, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6517, dtype=torch.float64) delta_t tensor(0.4919, dtype=torch.float64)
16 gae_duplicate tensor(-0.3295, dtype=torch.float64) tensor(-5.1296, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5108, dtype=torch.float64) delta_t tensor(0.3423, dtype=torch.float64)
15 gae_duplicate tensor(-0.3080, dtype=torch.float64) tensor(-0.2640, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6517, dtype=torch.float64) delta_t tensor(0.3391, dtype=torch.float64)
14 gae_duplicate tensor(0.2176, dtype=torch.float64) tensor(-4.3349, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0811, dtype=torch.float64) delta_t tensor(-0.3141, dtype=torch.float64)
13 gae_duplicate tensor(-2.9116, dtype=torch.float64) tensor(-0.5693, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3182, dtype=torch.float64) delta_t tensor(-0.3434, dtype=torch.float64)
12 gae_duplicate tensor(-6.7958, dtype=torch.float64) tensor(-4.8553, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0867, dtype=torch.float64) delta_t tensor(-0.5553, dtype=torch.float64)
11 gae_duplicate tensor(-6.0812, dtype=torch.float64) tensor(7.1472, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1472, dtype=torch.float64) delta_t tensor(-0.5821, dtype=torch.float64)
10 gae_duplicate tensor(-4.2171, dtype=torch.float64) tensor(12.4262, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3573, dtype=torch.float64) delta_t tensor(-0.4474, dtype=torch.float64)
9 gae_duplicate tensor(-3.1713, dtype=torch.float64) tensor(13.3832, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6902, dtype=torch.float64) delta_t tensor(-0.8758, dtype=torch.float64)
8 gae_duplicate tensor(-3.9758, dtype=torch.float64) tensor(16.6756, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2860, dtype=torch.float64) delta_t tensor(-0.2841, dtype=torch.float64)
7 gae_duplicate tensor(-4.2000, dtype=torch.float64) tensor(1.6679, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1789, dtype=torch.float64) delta_t tensor(-0.1893, dtype=torch.float64)
6 gae_duplicate tensor(-4.4573, dtype=torch.float64) tensor(5.2901, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0424, dtype=torch.float64) delta_t tensor(-0.7764, dtype=torch.float64)
5 gae_duplicate tensor(-5.6073, dtype=torch.float64) tensor(2.7870, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3121, dtype=torch.float64) delta_t tensor(0.1920, dtype=torch.float64)
4 gae_duplicate tensor(-5.9770, dtype=torch.float64) tensor(1.9223, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3860, dtype=torch.float64) delta_t tensor(0.0169, dtype=torch.float64)
3 gae_duplicate tensor(-3.8596, dtype=torch.float64) tensor(20.3362, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2159, dtype=torch.float64) delta_t tensor(-0.0370, dtype=torch.float64)
2 gae_duplicate tensor(-2.9277, dtype=torch.float64) tensor(8.5709, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2897.55908203125
value loss:671.931884765625
entropies:85.16417694091797
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1604.9287)
ToM Target loss= tensor(1814.5126)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.746025085449219 seconds
19 rew tensor(0.6894, dtype=torch.float64) delta_t tensor(-0.3184, dtype=torch.float64)
19 gae_duplicate tensor(-1.2514, dtype=torch.float64) tensor(4.1109, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6188, dtype=torch.float64) delta_t tensor(0.3036, dtype=torch.float64)
18 gae_duplicate tensor(-0.9940, dtype=torch.float64) tensor(-1.8112, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6821, dtype=torch.float64) delta_t tensor(0.3052, dtype=torch.float64)
17 gae_duplicate tensor(-0.6179, dtype=torch.float64) tensor(-2.6212, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6275, dtype=torch.float64) delta_t tensor(0.4768, dtype=torch.float64)
16 gae_duplicate tensor(-0.5130, dtype=torch.float64) tensor(-6.1005, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5258, dtype=torch.float64) delta_t tensor(0.1649, dtype=torch.float64)
15 gae_duplicate tensor(-0.9185, dtype=torch.float64) tensor(-1.0208, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6190, dtype=torch.float64) delta_t tensor(0.5885, dtype=torch.float64)
14 gae_duplicate tensor(-0.3614, dtype=torch.float64) tensor(-3.8553, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6823, dtype=torch.float64) delta_t tensor(0.3827, dtype=torch.float64)
13 gae_duplicate tensor(0.0844, dtype=torch.float64) tensor(-1.7688, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0512, dtype=torch.float64) delta_t tensor(-0.3282, dtype=torch.float64)
12 gae_duplicate tensor(-3.9945, dtype=torch.float64) tensor(1.8979, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1236, dtype=torch.float64) delta_t tensor(-0.2090, dtype=torch.float64)
11 gae_duplicate tensor(-2.7225, dtype=torch.float64) tensor(-2.4399, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7524, dtype=torch.float64) delta_t tensor(-0.9008, dtype=torch.float64)
10 gae_duplicate tensor(-3.2571, dtype=torch.float64) tensor(-5.7427, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3194, dtype=torch.float64) delta_t tensor(-0.2568, dtype=torch.float64)
9 gae_duplicate tensor(-4.5233, dtype=torch.float64) tensor(-0.1276, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1889, dtype=torch.float64) delta_t tensor(-0.3146, dtype=torch.float64)
8 gae_duplicate tensor(-3.6861, dtype=torch.float64) tensor(7.4519, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6805, dtype=torch.float64) delta_t tensor(-0.3888, dtype=torch.float64)
7 gae_duplicate tensor(-2.5500, dtype=torch.float64) tensor(13.2086, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4698, dtype=torch.float64) delta_t tensor(-0.0944, dtype=torch.float64)
6 gae_duplicate tensor(-1.7547, dtype=torch.float64) tensor(-0.4552, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1604, dtype=torch.float64) delta_t tensor(-0.9202, dtype=torch.float64)
5 gae_duplicate tensor(-3.9803, dtype=torch.float64) tensor(2.2612, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5641, dtype=torch.float64) delta_t tensor(-0.1402, dtype=torch.float64)
4 gae_duplicate tensor(-6.5161, dtype=torch.float64) tensor(2.1707, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3623, dtype=torch.float64) delta_t tensor(-0.1920, dtype=torch.float64)
3 gae_duplicate tensor(-5.8187, dtype=torch.float64) tensor(1.6749, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2790, dtype=torch.float64) delta_t tensor(-0.1162, dtype=torch.float64)
2 gae_duplicate tensor(-4.1241, dtype=torch.float64) tensor(1.4854, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-314.5249328613281
value loss:563.8076782226562
entropies:83.72074127197266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.784129858016968 seconds
19 rew tensor(0.7282, dtype=torch.float64) delta_t tensor(-0.2591, dtype=torch.float64)
19 gae_duplicate tensor(-1.0447, dtype=torch.float64) tensor(0.4171, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7048, dtype=torch.float64) delta_t tensor(0.8086, dtype=torch.float64)
18 gae_duplicate tensor(-0.5872, dtype=torch.float64) tensor(-6.5389, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6814, dtype=torch.float64) delta_t tensor(0.0897, dtype=torch.float64)
17 gae_duplicate tensor(-0.4045, dtype=torch.float64) tensor(-5.9433, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5873, dtype=torch.float64) delta_t tensor(0.2050, dtype=torch.float64)
16 gae_duplicate tensor(-0.5694, dtype=torch.float64) tensor(-7.2573, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3045, dtype=torch.float64) delta_t tensor(-0.0301, dtype=torch.float64)
15 gae_duplicate tensor(-0.8271, dtype=torch.float64) tensor(0.0816, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5571, dtype=torch.float64) delta_t tensor(0.4587, dtype=torch.float64)
14 gae_duplicate tensor(-0.2545, dtype=torch.float64) tensor(-3.0102, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0036, dtype=torch.float64) delta_t tensor(-0.2257, dtype=torch.float64)
13 gae_duplicate tensor(-1.9118, dtype=torch.float64) tensor(-1.2751, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4848, dtype=torch.float64) delta_t tensor(0.2448, dtype=torch.float64)
12 gae_duplicate tensor(-2.0517, dtype=torch.float64) tensor(-0.8032, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6503, dtype=torch.float64) delta_t tensor(0.5140, dtype=torch.float64)
11 gae_duplicate tensor(-1.2736, dtype=torch.float64) tensor(-1.3603, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5333, dtype=torch.float64) delta_t tensor(0.0955, dtype=torch.float64)
10 gae_duplicate tensor(-0.7438, dtype=torch.float64) tensor(-6.6083, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0260, dtype=torch.float64) delta_t tensor(-0.3111, dtype=torch.float64)
9 gae_duplicate tensor(-0.7337, dtype=torch.float64) tensor(-0.5761, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2148, dtype=torch.float64) delta_t tensor(-0.0552, dtype=torch.float64)
8 gae_duplicate tensor(-1.5176, dtype=torch.float64) tensor(3.7482, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1454, dtype=torch.float64) delta_t tensor(-0.3607, dtype=torch.float64)
7 gae_duplicate tensor(-1.0680, dtype=torch.float64) tensor(4.0154, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8672, dtype=torch.float64) delta_t tensor(-0.6207, dtype=torch.float64)
6 gae_duplicate tensor(-2.1922, dtype=torch.float64) tensor(0.8637, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0884, dtype=torch.float64) delta_t tensor(-0.5601, dtype=torch.float64)
5 gae_duplicate tensor(-3.0323, dtype=torch.float64) tensor(0.1815, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2826, dtype=torch.float64) delta_t tensor(-1.9202, dtype=torch.float64)
4 gae_duplicate tensor(-9.2849, dtype=torch.float64) tensor(3.9796, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3654, dtype=torch.float64) delta_t tensor(-0.0513, dtype=torch.float64)
3 gae_duplicate tensor(-6.9249, dtype=torch.float64) tensor(-0.4503, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0838, dtype=torch.float64) delta_t tensor(-0.3180, dtype=torch.float64)
2 gae_duplicate tensor(-5.5418, dtype=torch.float64) tensor(2.6987, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:627.2216186523438
value loss:695.159423828125
entropies:82.82369995117188
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.681088924407959 seconds
19 rew tensor(0.7283, dtype=torch.float64) delta_t tensor(-1.0799, dtype=torch.float64)
19 gae_duplicate tensor(-1.3311, dtype=torch.float64) tensor(7.3056, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7285, dtype=torch.float64) delta_t tensor(0.3953, dtype=torch.float64)
18 gae_duplicate tensor(-0.7344, dtype=torch.float64) tensor(1.0512, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7128, dtype=torch.float64) delta_t tensor(0.2862, dtype=torch.float64)
17 gae_duplicate tensor(-0.4560, dtype=torch.float64) tensor(0.1186, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6579, dtype=torch.float64) delta_t tensor(0.2463, dtype=torch.float64)
16 gae_duplicate tensor(-0.4738, dtype=torch.float64) tensor(-0.8485, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5872, dtype=torch.float64) delta_t tensor(0.6944, dtype=torch.float64)
15 gae_duplicate tensor(0.3896, dtype=torch.float64) tensor(-5.9181, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6347, dtype=torch.float64) delta_t tensor(0.3262, dtype=torch.float64)
14 gae_duplicate tensor(0.6257, dtype=torch.float64) tensor(-11.2898, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1137, dtype=torch.float64) delta_t tensor(0.0157, dtype=torch.float64)
13 gae_duplicate tensor(-1.7680, dtype=torch.float64) tensor(-1.0729, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0511, dtype=torch.float64) delta_t tensor(-0.2986, dtype=torch.float64)
12 gae_duplicate tensor(-3.8133, dtype=torch.float64) tensor(-6.8718, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3056, dtype=torch.float64) delta_t tensor(0.3957, dtype=torch.float64)
11 gae_duplicate tensor(-2.6883, dtype=torch.float64) tensor(-13.3259, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2342, dtype=torch.float64) delta_t tensor(-1.0587, dtype=torch.float64)
10 gae_duplicate tensor(-2.2039, dtype=torch.float64) tensor(6.2728, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9853, dtype=torch.float64) delta_t tensor(-1.2086, dtype=torch.float64)
9 gae_duplicate tensor(-3.5749, dtype=torch.float64) tensor(8.5977, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2038, dtype=torch.float64) delta_t tensor(0.5844, dtype=torch.float64)
8 gae_duplicate tensor(-2.3881, dtype=torch.float64) tensor(2.3958, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3338, dtype=torch.float64) delta_t tensor(0.1986, dtype=torch.float64)
7 gae_duplicate tensor(-1.7233, dtype=torch.float64) tensor(3.6919, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1347, dtype=torch.float64) delta_t tensor(0.0501, dtype=torch.float64)
6 gae_duplicate tensor(-1.3355, dtype=torch.float64) tensor(0.3366, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0830, dtype=torch.float64) delta_t tensor(0.1093, dtype=torch.float64)
5 gae_duplicate tensor(-1.5133, dtype=torch.float64) tensor(1.6581, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1035, dtype=torch.float64) delta_t tensor(0.7607, dtype=torch.float64)
4 gae_duplicate tensor(-0.2802, dtype=torch.float64) tensor(-3.1246, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0748, dtype=torch.float64) delta_t tensor(0.0343, dtype=torch.float64)
3 gae_duplicate tensor(0.2099, dtype=torch.float64) tensor(-0.7210, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3334, dtype=torch.float64) delta_t tensor(-0.1972, dtype=torch.float64)
2 gae_duplicate tensor(-0.2054, dtype=torch.float64) tensor(-0.3216, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:419.13116455078125
value loss:227.92306518554688
entropies:84.71450805664062
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.604552984237671 seconds
19 rew tensor(0.7212, dtype=torch.float64) delta_t tensor(-0.8664, dtype=torch.float64)
19 gae_duplicate tensor(-1.1696, dtype=torch.float64) tensor(12.7913, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7137, dtype=torch.float64) delta_t tensor(0.5638, dtype=torch.float64)
18 gae_duplicate tensor(-0.7264, dtype=torch.float64) tensor(1.5251, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6831, dtype=torch.float64) delta_t tensor(0.6594, dtype=torch.float64)
17 gae_duplicate tensor(-0.5469, dtype=torch.float64) tensor(-0.7084, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6219, dtype=torch.float64) delta_t tensor(0.1999, dtype=torch.float64)
16 gae_duplicate tensor(-0.5125, dtype=torch.float64) tensor(-5.8073, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4991, dtype=torch.float64) delta_t tensor(0.4134, dtype=torch.float64)
15 gae_duplicate tensor(-0.9275, dtype=torch.float64) tensor(-1.1679, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5512, dtype=torch.float64) delta_t tensor(0.6514, dtype=torch.float64)
14 gae_duplicate tensor(-0.3707, dtype=torch.float64) tensor(-1.7504, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3449, dtype=torch.float64) delta_t tensor(-0.0123, dtype=torch.float64)
13 gae_duplicate tensor(-1.7814, dtype=torch.float64) tensor(-8.0492, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1610, dtype=torch.float64) delta_t tensor(-0.0454, dtype=torch.float64)
12 gae_duplicate tensor(-2.7579, dtype=torch.float64) tensor(-4.4690, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1462, dtype=torch.float64) delta_t tensor(0.0593, dtype=torch.float64)
11 gae_duplicate tensor(-2.3279, dtype=torch.float64) tensor(-2.7295, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.1453, dtype=torch.float64) delta_t tensor(-1.5418, dtype=torch.float64)
10 gae_duplicate tensor(-5.2517, dtype=torch.float64) tensor(-7.2234, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4050, dtype=torch.float64) delta_t tensor(-0.6868, dtype=torch.float64)
9 gae_duplicate tensor(-5.7962, dtype=torch.float64) tensor(9.0892, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3151, dtype=torch.float64) delta_t tensor(-0.5044, dtype=torch.float64)
8 gae_duplicate tensor(-4.9270, dtype=torch.float64) tensor(6.0631, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5622, dtype=torch.float64) delta_t tensor(-0.5222, dtype=torch.float64)
7 gae_duplicate tensor(-3.6469, dtype=torch.float64) tensor(2.5707, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3583, dtype=torch.float64) delta_t tensor(-0.4006, dtype=torch.float64)
6 gae_duplicate tensor(-3.9231, dtype=torch.float64) tensor(2.4798, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1334, dtype=torch.float64) delta_t tensor(-0.5639, dtype=torch.float64)
5 gae_duplicate tensor(-4.3952, dtype=torch.float64) tensor(2.7670, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8984, dtype=torch.float64) delta_t tensor(-0.5271, dtype=torch.float64)
4 gae_duplicate tensor(-6.8145, dtype=torch.float64) tensor(2.9153, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3135, dtype=torch.float64) delta_t tensor(0.0018, dtype=torch.float64)
3 gae_duplicate tensor(-5.3378, dtype=torch.float64) tensor(2.1371, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1130, dtype=torch.float64) delta_t tensor(-0.2171, dtype=torch.float64)
2 gae_duplicate tensor(-4.0106, dtype=torch.float64) tensor(7.5150, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-661.1199340820312
value loss:774.0346069335938
entropies:83.17567443847656
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.76169490814209 seconds
19 rew tensor(0.7284, dtype=torch.float64) delta_t tensor(-1.1761, dtype=torch.float64)
19 gae_duplicate tensor(-1.3685, dtype=torch.float64) tensor(5.0031, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6970, dtype=torch.float64) delta_t tensor(0.2652, dtype=torch.float64)
18 gae_duplicate tensor(-0.8741, dtype=torch.float64) tensor(0.9365, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6497, dtype=torch.float64) delta_t tensor(0.4229, dtype=torch.float64)
17 gae_duplicate tensor(-0.4295, dtype=torch.float64) tensor(0.4955, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5472, dtype=torch.float64) delta_t tensor(0.2747, dtype=torch.float64)
16 gae_duplicate tensor(-0.7177, dtype=torch.float64) tensor(-0.2210, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3893, dtype=torch.float64) delta_t tensor(0.1782, dtype=torch.float64)
15 gae_duplicate tensor(-1.1803, dtype=torch.float64) tensor(-9.6314, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7447, dtype=torch.float64) delta_t tensor(0.4622, dtype=torch.float64)
14 gae_duplicate tensor(-0.5731, dtype=torch.float64) tensor(0.4897, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7143, dtype=torch.float64) delta_t tensor(0.3939, dtype=torch.float64)
13 gae_duplicate tensor(-0.0872, dtype=torch.float64) tensor(-1.2967, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6361, dtype=torch.float64) delta_t tensor(0.1041, dtype=torch.float64)
12 gae_duplicate tensor(0.3017, dtype=torch.float64) tensor(-1.1928, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3334, dtype=torch.float64) delta_t tensor(-0.6945, dtype=torch.float64)
11 gae_duplicate tensor(-3.8217, dtype=torch.float64) tensor(0.0014, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2187, dtype=torch.float64) delta_t tensor(-0.0972, dtype=torch.float64)
10 gae_duplicate tensor(-3.1517, dtype=torch.float64) tensor(-3.2891, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3224, dtype=torch.float64) delta_t tensor(0.4234, dtype=torch.float64)
9 gae_duplicate tensor(-1.6838, dtype=torch.float64) tensor(-7.8934, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8145, dtype=torch.float64) delta_t tensor(-0.8157, dtype=torch.float64)
8 gae_duplicate tensor(-1.8791, dtype=torch.float64) tensor(4.9926, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4758, dtype=torch.float64) delta_t tensor(-0.4976, dtype=torch.float64)
7 gae_duplicate tensor(-2.7820, dtype=torch.float64) tensor(8.1164, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5646, dtype=torch.float64) delta_t tensor(-0.6067, dtype=torch.float64)
6 gae_duplicate tensor(-3.0859, dtype=torch.float64) tensor(10.1630, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0077, dtype=torch.float64) delta_t tensor(-0.3615, dtype=torch.float64)
5 gae_duplicate tensor(-2.5740, dtype=torch.float64) tensor(2.0248, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1877, dtype=torch.float64) delta_t tensor(-0.7557, dtype=torch.float64)
4 gae_duplicate tensor(-6.6894, dtype=torch.float64) tensor(3.3441, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1569, dtype=torch.float64) delta_t tensor(0.1496, dtype=torch.float64)
3 gae_duplicate tensor(-5.0904, dtype=torch.float64) tensor(8.6253, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2236, dtype=torch.float64) delta_t tensor(-0.0642, dtype=torch.float64)
2 gae_duplicate tensor(-3.9769, dtype=torch.float64) tensor(4.2270, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-911.4382934570312
value loss:406.30865478515625
entropies:84.57170104980469
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1621.2119)
ToM Target loss= tensor(1814.5829)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.171563148498535 seconds
19 rew tensor(0.7287, dtype=torch.float64) delta_t tensor(-0.4882, dtype=torch.float64)
19 gae_duplicate tensor(-1.2044, dtype=torch.float64) tensor(0.6819, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6748, dtype=torch.float64) delta_t tensor(0.5206, dtype=torch.float64)
18 gae_duplicate tensor(-0.6004, dtype=torch.float64) tensor(-1.7859, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6212, dtype=torch.float64) delta_t tensor(0.4037, dtype=torch.float64)
17 gae_duplicate tensor(-0.3171, dtype=torch.float64) tensor(-4.0729, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5524, dtype=torch.float64) delta_t tensor(0.0427, dtype=torch.float64)
16 gae_duplicate tensor(-0.7247, dtype=torch.float64) tensor(-2.9217, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4377, dtype=torch.float64) delta_t tensor(0.2085, dtype=torch.float64)
15 gae_duplicate tensor(-1.2887, dtype=torch.float64) tensor(-1.7901, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6745, dtype=torch.float64) delta_t tensor(0.2607, dtype=torch.float64)
14 gae_duplicate tensor(-0.6588, dtype=torch.float64) tensor(-3.5866, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.2482, dtype=torch.float64) delta_t tensor(-0.1929, dtype=torch.float64)
13 gae_duplicate tensor(-1.1232, dtype=torch.float64) tensor(-0.8243, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-1.8291, dtype=torch.float64) delta_t tensor(-2.1717, dtype=torch.float64)
12 gae_duplicate tensor(-6.3366, dtype=torch.float64) tensor(26.4234, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3666, dtype=torch.float64) delta_t tensor(-0.0085, dtype=torch.float64)
11 gae_duplicate tensor(-6.6818, dtype=torch.float64) tensor(2.0653, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4707, dtype=torch.float64) delta_t tensor(0.2107, dtype=torch.float64)
10 gae_duplicate tensor(-5.1932, dtype=torch.float64) tensor(2.3168, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4215, dtype=torch.float64) delta_t tensor(0.0859, dtype=torch.float64)
9 gae_duplicate tensor(-3.5816, dtype=torch.float64) tensor(0.6276, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8277, dtype=torch.float64) delta_t tensor(-0.9343, dtype=torch.float64)
8 gae_duplicate tensor(-4.3759, dtype=torch.float64) tensor(2.0764, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4570, dtype=torch.float64) delta_t tensor(-0.3758, dtype=torch.float64)
7 gae_duplicate tensor(-5.4637, dtype=torch.float64) tensor(2.3290, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1611, dtype=torch.float64) delta_t tensor(0.1666, dtype=torch.float64)
6 gae_duplicate tensor(-3.8540, dtype=torch.float64) tensor(14.3681, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2757, dtype=torch.float64) delta_t tensor(0.1400, dtype=torch.float64)
5 gae_duplicate tensor(-3.1174, dtype=torch.float64) tensor(3.1938, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2398, dtype=torch.float64) delta_t tensor(0.8421, dtype=torch.float64)
4 gae_duplicate tensor(-0.9671, dtype=torch.float64) tensor(-2.5183, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2728, dtype=torch.float64) delta_t tensor(-0.0193, dtype=torch.float64)
3 gae_duplicate tensor(-1.3782, dtype=torch.float64) tensor(-1.7196, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2683, dtype=torch.float64) delta_t tensor(-0.2714, dtype=torch.float64)
2 gae_duplicate tensor(-0.9858, dtype=torch.float64) tensor(0.4939, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1288.1754150390625
value loss:512.1443481445312
entropies:85.17488098144531
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.023269176483154 seconds
19 rew tensor(0.7361, dtype=torch.float64) delta_t tensor(-0.9680, dtype=torch.float64)
19 gae_duplicate tensor(-1.2567, dtype=torch.float64) tensor(4.2347, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7204, dtype=torch.float64) delta_t tensor(0.5118, dtype=torch.float64)
18 gae_duplicate tensor(-0.7303, dtype=torch.float64) tensor(1.3401, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7047, dtype=torch.float64) delta_t tensor(0.3353, dtype=torch.float64)
17 gae_duplicate tensor(-0.3513, dtype=torch.float64) tensor(0.0403, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6733, dtype=torch.float64) delta_t tensor(0.5207, dtype=torch.float64)
16 gae_duplicate tensor(0.2482, dtype=torch.float64) tensor(-0.8748, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5866, dtype=torch.float64) delta_t tensor(0.3817, dtype=torch.float64)
15 gae_duplicate tensor(-0.2977, dtype=torch.float64) tensor(-0.4379, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5489, dtype=torch.float64) delta_t tensor(0.3089, dtype=torch.float64)
14 gae_duplicate tensor(0.1743, dtype=torch.float64) tensor(-1.7929, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6350, dtype=torch.float64) delta_t tensor(0.2554, dtype=torch.float64)
13 gae_duplicate tensor(0.5711, dtype=torch.float64) tensor(-1.4626, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7244, dtype=torch.float64) delta_t tensor(-0.8183, dtype=torch.float64)
12 gae_duplicate tensor(-2.9541, dtype=torch.float64) tensor(1.7417, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3979, dtype=torch.float64) delta_t tensor(0.1337, dtype=torch.float64)
11 gae_duplicate tensor(-2.1273, dtype=torch.float64) tensor(6.5691, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0061, dtype=torch.float64) delta_t tensor(-0.5809, dtype=torch.float64)
10 gae_duplicate tensor(-1.9098, dtype=torch.float64) tensor(0.6605, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1603, dtype=torch.float64) delta_t tensor(0.1149, dtype=torch.float64)
9 gae_duplicate tensor(-1.3541, dtype=torch.float64) tensor(-2.1883, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1795, dtype=torch.float64) delta_t tensor(0.1029, dtype=torch.float64)
8 gae_duplicate tensor(-1.0635, dtype=torch.float64) tensor(0.0627, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3038, dtype=torch.float64) delta_t tensor(-0.1376, dtype=torch.float64)
7 gae_duplicate tensor(-1.3625, dtype=torch.float64) tensor(1.2749, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1201, dtype=torch.float64) delta_t tensor(0.0110, dtype=torch.float64)
6 gae_duplicate tensor(-1.3535, dtype=torch.float64) tensor(1.6624, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6962, dtype=torch.float64) delta_t tensor(-0.2766, dtype=torch.float64)
5 gae_duplicate tensor(-1.8032, dtype=torch.float64) tensor(0.4725, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3478, dtype=torch.float64) delta_t tensor(0.8735, dtype=torch.float64)
4 gae_duplicate tensor(-0.5173, dtype=torch.float64) tensor(-2.8582, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2413, dtype=torch.float64) delta_t tensor(0.2409, dtype=torch.float64)
3 gae_duplicate tensor(-0.3579, dtype=torch.float64) tensor(-2.5647, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1918, dtype=torch.float64) delta_t tensor(-0.5004, dtype=torch.float64)
2 gae_duplicate tensor(-0.8632, dtype=torch.float64) tensor(-0.0272, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-226.4261474609375
value loss:183.63861083984375
entropies:87.43054962158203
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.212094783782959 seconds
19 rew tensor(0.7279, dtype=torch.float64) delta_t tensor(-0.7535, dtype=torch.float64)
19 gae_duplicate tensor(-1.1647, dtype=torch.float64) tensor(3.9321, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7202, dtype=torch.float64) delta_t tensor(0.3802, dtype=torch.float64)
18 gae_duplicate tensor(-0.6673, dtype=torch.float64) tensor(1.8815, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7203, dtype=torch.float64) delta_t tensor(0.5071, dtype=torch.float64)
17 gae_duplicate tensor(-0.2002, dtype=torch.float64) tensor(-1.8137, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6814, dtype=torch.float64) delta_t tensor(0.3437, dtype=torch.float64)
16 gae_duplicate tensor(0.1983, dtype=torch.float64) tensor(-2.9864, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6424, dtype=torch.float64) delta_t tensor(0.4850, dtype=torch.float64)
15 gae_duplicate tensor(-0.2331, dtype=torch.float64) tensor(-7.3001, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7363, dtype=torch.float64) delta_t tensor(0.5303, dtype=torch.float64)
14 gae_duplicate tensor(0.3177, dtype=torch.float64) tensor(-8.4880, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7286, dtype=torch.float64) delta_t tensor(0.4396, dtype=torch.float64)
13 gae_duplicate tensor(0.6807, dtype=torch.float64) tensor(-8.1506, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3535, dtype=torch.float64) delta_t tensor(0.0641, dtype=torch.float64)
12 gae_duplicate tensor(-1.3632, dtype=torch.float64) tensor(-1.7782, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.9440, dtype=torch.float64) delta_t tensor(-0.8953, dtype=torch.float64)
11 gae_duplicate tensor(-4.6733, dtype=torch.float64) tensor(11.4819, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3492, dtype=torch.float64) delta_t tensor(-0.9753, dtype=torch.float64)
10 gae_duplicate tensor(-7.6856, dtype=torch.float64) tensor(-4.8913, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8338, dtype=torch.float64) delta_t tensor(-0.7084, dtype=torch.float64)
9 gae_duplicate tensor(-5.4695, dtype=torch.float64) tensor(15.2514, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2627, dtype=torch.float64) delta_t tensor(-0.7098, dtype=torch.float64)
8 gae_duplicate tensor(-4.5805, dtype=torch.float64) tensor(-2.3041, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5389, dtype=torch.float64) delta_t tensor(-0.4631, dtype=torch.float64)
7 gae_duplicate tensor(-4.3832, dtype=torch.float64) tensor(2.8662, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2394, dtype=torch.float64) delta_t tensor(-0.0899, dtype=torch.float64)
6 gae_duplicate tensor(-5.3713, dtype=torch.float64) tensor(2.3388, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7098, dtype=torch.float64) delta_t tensor(0.0103, dtype=torch.float64)
5 gae_duplicate tensor(-5.4209, dtype=torch.float64) tensor(0.1074, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7743, dtype=torch.float64) delta_t tensor(-0.2334, dtype=torch.float64)
4 gae_duplicate tensor(-7.3647, dtype=torch.float64) tensor(19.7027, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5286, dtype=torch.float64) delta_t tensor(-0.2847, dtype=torch.float64)
3 gae_duplicate tensor(-6.4793, dtype=torch.float64) tensor(1.9460, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0540, dtype=torch.float64) delta_t tensor(-0.3125, dtype=torch.float64)
2 gae_duplicate tensor(-4.6164, dtype=torch.float64) tensor(1.6734, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-860.41796875
value loss:827.378662109375
entropies:86.30584716796875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.7487640380859375 seconds
19 rew tensor(0.6360, dtype=torch.float64) delta_t tensor(-0.5557, dtype=torch.float64)
19 gae_duplicate tensor(-1.3484, dtype=torch.float64) tensor(-1.0462, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6750, dtype=torch.float64) delta_t tensor(0.4674, dtype=torch.float64)
18 gae_duplicate tensor(-0.7559, dtype=torch.float64) tensor(0.5741, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6291, dtype=torch.float64) delta_t tensor(0.7031, dtype=torch.float64)
17 gae_duplicate tensor(-0.0003, dtype=torch.float64) tensor(-6.1879, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5824, dtype=torch.float64) delta_t tensor(0.1425, dtype=torch.float64)
16 gae_duplicate tensor(0.4450, dtype=torch.float64) tensor(-6.0039, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4517, dtype=torch.float64) delta_t tensor(0.4969, dtype=torch.float64)
15 gae_duplicate tensor(0.8448, dtype=torch.float64) tensor(-6.6746, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6822, dtype=torch.float64) delta_t tensor(0.3447, dtype=torch.float64)
14 gae_duplicate tensor(0.6705, dtype=torch.float64) tensor(-3.3947, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.2527, dtype=torch.float64) delta_t tensor(-0.5449, dtype=torch.float64)
13 gae_duplicate tensor(-3.1350, dtype=torch.float64) tensor(7.1298, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6071, dtype=torch.float64) delta_t tensor(0.5761, dtype=torch.float64)
12 gae_duplicate tensor(-1.8909, dtype=torch.float64) tensor(-1.2559, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3141, dtype=torch.float64) delta_t tensor(-0.6491, dtype=torch.float64)
11 gae_duplicate tensor(-1.3105, dtype=torch.float64) tensor(2.0887, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2215, dtype=torch.float64) delta_t tensor(-0.5607, dtype=torch.float64)
10 gae_duplicate tensor(-2.7468, dtype=torch.float64) tensor(0.7372, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0126, dtype=torch.float64) delta_t tensor(0.1471, dtype=torch.float64)
9 gae_duplicate tensor(-1.5648, dtype=torch.float64) tensor(0.7692, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0390, dtype=torch.float64) delta_t tensor(-0.3550, dtype=torch.float64)
8 gae_duplicate tensor(-1.8622, dtype=torch.float64) tensor(0.7799, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8414, dtype=torch.float64) delta_t tensor(-0.4601, dtype=torch.float64)
7 gae_duplicate tensor(-5.0517, dtype=torch.float64) tensor(17.6829, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0715, dtype=torch.float64) delta_t tensor(-0.1522, dtype=torch.float64)
6 gae_duplicate tensor(-5.9180, dtype=torch.float64) tensor(1.0770, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0956, dtype=torch.float64) delta_t tensor(-0.4550, dtype=torch.float64)
5 gae_duplicate tensor(-5.9192, dtype=torch.float64) tensor(15.4945, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3198, dtype=torch.float64) delta_t tensor(0.1151, dtype=torch.float64)
4 gae_duplicate tensor(-6.9502, dtype=torch.float64) tensor(17.4116, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3363, dtype=torch.float64) delta_t tensor(0.1253, dtype=torch.float64)
3 gae_duplicate tensor(-5.0004, dtype=torch.float64) tensor(3.0339, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2013, dtype=torch.float64) delta_t tensor(-0.3254, dtype=torch.float64)
2 gae_duplicate tensor(-4.2797, dtype=torch.float64) tensor(12.3482, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1980.1351318359375
value loss:461.0096740722656
entropies:88.01842498779297
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.251803874969482 seconds
19 rew tensor(0.7350, dtype=torch.float64) delta_t tensor(-0.8110, dtype=torch.float64)
19 gae_duplicate tensor(-1.0980, dtype=torch.float64) tensor(9.0421, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7197, dtype=torch.float64) delta_t tensor(0.3381, dtype=torch.float64)
18 gae_duplicate tensor(-0.7937, dtype=torch.float64) tensor(1.1266, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7043, dtype=torch.float64) delta_t tensor(0.3321, dtype=torch.float64)
17 gae_duplicate tensor(-0.1164, dtype=torch.float64) tensor(-0.4018, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6502, dtype=torch.float64) delta_t tensor(0.5325, dtype=torch.float64)
16 gae_duplicate tensor(-0.0644, dtype=torch.float64) tensor(-3.2463, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5806, dtype=torch.float64) delta_t tensor(0.5591, dtype=torch.float64)
15 gae_duplicate tensor(0.0131, dtype=torch.float64) tensor(-3.5343, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7433, dtype=torch.float64) delta_t tensor(0.7412, dtype=torch.float64)
14 gae_duplicate tensor(0.5902, dtype=torch.float64) tensor(-10.5073, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7434, dtype=torch.float64) delta_t tensor(0.4832, dtype=torch.float64)
13 gae_duplicate tensor(1.0450, dtype=torch.float64) tensor(-6.9139, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6887, dtype=torch.float64) delta_t tensor(0.5913, dtype=torch.float64)
12 gae_duplicate tensor(1.4705, dtype=torch.float64) tensor(-8.0064, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1025, dtype=torch.float64) delta_t tensor(-0.4524, dtype=torch.float64)
11 gae_duplicate tensor(-1.9497, dtype=torch.float64) tensor(3.3803, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.2673, dtype=torch.float64) delta_t tensor(-1.8556, dtype=torch.float64)
10 gae_duplicate tensor(-4.6404, dtype=torch.float64) tensor(-2.3389, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4267, dtype=torch.float64) delta_t tensor(-0.6015, dtype=torch.float64)
9 gae_duplicate tensor(-3.5448, dtype=torch.float64) tensor(9.7656, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0193, dtype=torch.float64) delta_t tensor(-0.1232, dtype=torch.float64)
8 gae_duplicate tensor(-3.0246, dtype=torch.float64) tensor(1.5470, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1914, dtype=torch.float64) delta_t tensor(-0.1711, dtype=torch.float64)
7 gae_duplicate tensor(-1.8858, dtype=torch.float64) tensor(7.6790, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0726, dtype=torch.float64) delta_t tensor(-0.1068, dtype=torch.float64)
6 gae_duplicate tensor(-2.7849, dtype=torch.float64) tensor(1.4300, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7064, dtype=torch.float64) delta_t tensor(-0.1291, dtype=torch.float64)
5 gae_duplicate tensor(-3.4974, dtype=torch.float64) tensor(1.2577, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2448, dtype=torch.float64) delta_t tensor(-0.7116, dtype=torch.float64)
4 gae_duplicate tensor(-10.4461, dtype=torch.float64) tensor(2.8386, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2795, dtype=torch.float64) delta_t tensor(0.1138, dtype=torch.float64)
3 gae_duplicate tensor(-7.9421, dtype=torch.float64) tensor(-1.9262, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4791, dtype=torch.float64) delta_t tensor(-0.4476, dtype=torch.float64)
2 gae_duplicate tensor(-5.9258, dtype=torch.float64) tensor(21.5802, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-835.400146484375
value loss:660.4613037109375
entropies:86.75501251220703
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1600.7732)
ToM Target loss= tensor(1818.2019)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.053435802459717 seconds
19 rew tensor(0.7035, dtype=torch.float64) delta_t tensor(-0.1745, dtype=torch.float64)
19 gae_duplicate tensor(-1.0255, dtype=torch.float64) tensor(2.1162, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6647, dtype=torch.float64) delta_t tensor(0.4518, dtype=torch.float64)
18 gae_duplicate tensor(-0.4801, dtype=torch.float64) tensor(2.0521, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6181, dtype=torch.float64) delta_t tensor(0.5290, dtype=torch.float64)
17 gae_duplicate tensor(-0.2208, dtype=torch.float64) tensor(-0.4449, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5634, dtype=torch.float64) delta_t tensor(0.5396, dtype=torch.float64)
16 gae_duplicate tensor(0.0441, dtype=torch.float64) tensor(-5.7702, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4153, dtype=torch.float64) delta_t tensor(0.5445, dtype=torch.float64)
15 gae_duplicate tensor(0.8983, dtype=torch.float64) tensor(-7.9788, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7194, dtype=torch.float64) delta_t tensor(0.6483, dtype=torch.float64)
14 gae_duplicate tensor(1.1509, dtype=torch.float64) tensor(-17.3570, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5863, dtype=torch.float64) delta_t tensor(0.5553, dtype=torch.float64)
13 gae_duplicate tensor(0.6914, dtype=torch.float64) tensor(-2.8206, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.5839, dtype=torch.float64) delta_t tensor(-0.9214, dtype=torch.float64)
12 gae_duplicate tensor(-5.3107, dtype=torch.float64) tensor(-4.8596, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6052, dtype=torch.float64) delta_t tensor(0.6594, dtype=torch.float64)
11 gae_duplicate tensor(-3.5910, dtype=torch.float64) tensor(-11.0814, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5354, dtype=torch.float64) delta_t tensor(-0.2965, dtype=torch.float64)
10 gae_duplicate tensor(-3.3468, dtype=torch.float64) tensor(-7.9296, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0397, dtype=torch.float64) delta_t tensor(-0.0172, dtype=torch.float64)
9 gae_duplicate tensor(-2.6837, dtype=torch.float64) tensor(0.5021, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0143, dtype=torch.float64) delta_t tensor(-0.1863, dtype=torch.float64)
8 gae_duplicate tensor(-1.6829, dtype=torch.float64) tensor(-5.8152, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9487, dtype=torch.float64) delta_t tensor(-0.8812, dtype=torch.float64)
7 gae_duplicate tensor(-2.3717, dtype=torch.float64) tensor(0.7804, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.8182, dtype=torch.float64) delta_t tensor(-1.7364, dtype=torch.float64)
6 gae_duplicate tensor(-5.7320, dtype=torch.float64) tensor(40.3359, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8608, dtype=torch.float64) delta_t tensor(-1.2295, dtype=torch.float64)
5 gae_duplicate tensor(-6.9889, dtype=torch.float64) tensor(17.3912, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5553, dtype=torch.float64) delta_t tensor(-0.9797, dtype=torch.float64)
4 gae_duplicate tensor(-7.3098, dtype=torch.float64) tensor(21.4491, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1152, dtype=torch.float64) delta_t tensor(0.2435, dtype=torch.float64)
3 gae_duplicate tensor(-6.4568, dtype=torch.float64) tensor(11.4459, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1550, dtype=torch.float64) delta_t tensor(0.0687, dtype=torch.float64)
2 gae_duplicate tensor(-4.5941, dtype=torch.float64) tensor(12.9731, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1635.1458740234375
value loss:990.3214721679688
entropies:86.4181900024414
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.8094000816345215 seconds
19 rew tensor(0.4630, dtype=torch.float64) delta_t tensor(-0.6805, dtype=torch.float64)
19 gae_duplicate tensor(-2.1689, dtype=torch.float64) tensor(-0.5914, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7423, dtype=torch.float64) delta_t tensor(0.5228, dtype=torch.float64)
18 gae_duplicate tensor(-1.2535, dtype=torch.float64) tensor(0.0344, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7424, dtype=torch.float64) delta_t tensor(0.4879, dtype=torch.float64)
17 gae_duplicate tensor(-0.5210, dtype=torch.float64) tensor(-0.6509, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7347, dtype=torch.float64) delta_t tensor(0.6651, dtype=torch.float64)
16 gae_duplicate tensor(0.0650, dtype=torch.float64) tensor(-6.2693, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7350, dtype=torch.float64) delta_t tensor(0.5335, dtype=torch.float64)
15 gae_duplicate tensor(0.5340, dtype=torch.float64) tensor(-4.7884, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7349, dtype=torch.float64) delta_t tensor(0.6523, dtype=torch.float64)
14 gae_duplicate tensor(0.5847, dtype=torch.float64) tensor(-2.4993, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1524, dtype=torch.float64) delta_t tensor(-0.3251, dtype=torch.float64)
13 gae_duplicate tensor(-2.8716, dtype=torch.float64) tensor(-7.9756, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2638, dtype=torch.float64) delta_t tensor(0.1057, dtype=torch.float64)
12 gae_duplicate tensor(-1.8712, dtype=torch.float64) tensor(-1.3205, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0507, dtype=torch.float64) delta_t tensor(0.0797, dtype=torch.float64)
11 gae_duplicate tensor(-1.3722, dtype=torch.float64) tensor(-1.2380, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4848, dtype=torch.float64) delta_t tensor(-1.0823, dtype=torch.float64)
10 gae_duplicate tensor(-3.4366, dtype=torch.float64) tensor(-8.6012, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1977, dtype=torch.float64) delta_t tensor(0.0531, dtype=torch.float64)
9 gae_duplicate tensor(-3.2937, dtype=torch.float64) tensor(-1.1881, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0210, dtype=torch.float64) delta_t tensor(-0.1265, dtype=torch.float64)
8 gae_duplicate tensor(-1.4236, dtype=torch.float64) tensor(1.3633, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4251, dtype=torch.float64) delta_t tensor(-0.2774, dtype=torch.float64)
7 gae_duplicate tensor(-3.0152, dtype=torch.float64) tensor(7.4257, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1803, dtype=torch.float64) delta_t tensor(0.0926, dtype=torch.float64)
6 gae_duplicate tensor(-2.3969, dtype=torch.float64) tensor(0.3158, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1884, dtype=torch.float64) delta_t tensor(-0.6787, dtype=torch.float64)
5 gae_duplicate tensor(-4.2449, dtype=torch.float64) tensor(11.3323, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9102, dtype=torch.float64) delta_t tensor(-0.1175, dtype=torch.float64)
4 gae_duplicate tensor(-4.8924, dtype=torch.float64) tensor(4.0420, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4683, dtype=torch.float64) delta_t tensor(-0.1689, dtype=torch.float64)
3 gae_duplicate tensor(-3.6196, dtype=torch.float64) tensor(10.0358, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0991, dtype=torch.float64) delta_t tensor(-0.1116, dtype=torch.float64)
2 gae_duplicate tensor(-2.6270, dtype=torch.float64) tensor(2.3636, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-80.03739929199219
value loss:439.6456298828125
entropies:86.609619140625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.790400981903076 seconds
19 rew tensor(0.7421, dtype=torch.float64) delta_t tensor(-0.2082, dtype=torch.float64)
19 gae_duplicate tensor(-0.9541, dtype=torch.float64) tensor(0.9300, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7423, dtype=torch.float64) delta_t tensor(0.6157, dtype=torch.float64)
18 gae_duplicate tensor(-0.4151, dtype=torch.float64) tensor(-5.1869, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7424, dtype=torch.float64) delta_t tensor(0.4441, dtype=torch.float64)
17 gae_duplicate tensor(-0.0476, dtype=torch.float64) tensor(-1.1362, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6640, dtype=torch.float64) delta_t tensor(0.4282, dtype=torch.float64)
16 gae_duplicate tensor(0.4837, dtype=torch.float64) tensor(-5.3710, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6563, dtype=torch.float64) delta_t tensor(0.8560, dtype=torch.float64)
15 gae_duplicate tensor(1.1140, dtype=torch.float64) tensor(-5.0250, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6328, dtype=torch.float64) delta_t tensor(0.7205, dtype=torch.float64)
14 gae_duplicate tensor(1.0676, dtype=torch.float64) tensor(-16.7683, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1748, dtype=torch.float64) delta_t tensor(-0.0209, dtype=torch.float64)
13 gae_duplicate tensor(0.4467, dtype=torch.float64) tensor(-16.3431, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5006, dtype=torch.float64) delta_t tensor(0.3311, dtype=torch.float64)
12 gae_duplicate tensor(-0.3622, dtype=torch.float64) tensor(-2.1892, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4858, dtype=torch.float64) delta_t tensor(0.3297, dtype=torch.float64)
11 gae_duplicate tensor(-0.0377, dtype=torch.float64) tensor(-2.0920, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4649, dtype=torch.float64) delta_t tensor(-0.6013, dtype=torch.float64)
10 gae_duplicate tensor(-1.6744, dtype=torch.float64) tensor(-2.1569, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2875, dtype=torch.float64) delta_t tensor(-1.6593, dtype=torch.float64)
9 gae_duplicate tensor(-4.1512, dtype=torch.float64) tensor(1.5133, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2680, dtype=torch.float64) delta_t tensor(0.0856, dtype=torch.float64)
8 gae_duplicate tensor(-4.1644, dtype=torch.float64) tensor(5.4080, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3693, dtype=torch.float64) delta_t tensor(0.2006, dtype=torch.float64)
7 gae_duplicate tensor(-3.1833, dtype=torch.float64) tensor(2.0171, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1765, dtype=torch.float64) delta_t tensor(0.1833, dtype=torch.float64)
6 gae_duplicate tensor(-2.3349, dtype=torch.float64) tensor(-0.2399, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0840, dtype=torch.float64) delta_t tensor(0.0261, dtype=torch.float64)
5 gae_duplicate tensor(-1.4175, dtype=torch.float64) tensor(-1.7683, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3188, dtype=torch.float64) delta_t tensor(0.3365, dtype=torch.float64)
4 gae_duplicate tensor(-0.4997, dtype=torch.float64) tensor(-0.6130, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4144, dtype=torch.float64) delta_t tensor(-0.0332, dtype=torch.float64)
3 gae_duplicate tensor(-0.6553, dtype=torch.float64) tensor(0.4433, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1987, dtype=torch.float64) delta_t tensor(-0.1870, dtype=torch.float64)
2 gae_duplicate tensor(-0.6146, dtype=torch.float64) tensor(3.0882, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1622.142822265625
value loss:419.608154296875
entropies:86.1120376586914
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.790680170059204 seconds
19 rew tensor(0.7191, dtype=torch.float64) delta_t tensor(-0.4123, dtype=torch.float64)
19 gae_duplicate tensor(-0.8033, dtype=torch.float64) tensor(2.3786, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6803, dtype=torch.float64) delta_t tensor(0.4790, dtype=torch.float64)
18 gae_duplicate tensor(-0.3002, dtype=torch.float64) tensor(-0.5527, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6180, dtype=torch.float64) delta_t tensor(0.3083, dtype=torch.float64)
17 gae_duplicate tensor(0.0242, dtype=torch.float64) tensor(-0.8032, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4857, dtype=torch.float64) delta_t tensor(0.3874, dtype=torch.float64)
16 gae_duplicate tensor(0.0732, dtype=torch.float64) tensor(-0.9886, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1182, dtype=torch.float64) delta_t tensor(0.0168, dtype=torch.float64)
15 gae_duplicate tensor(-1.0004, dtype=torch.float64) tensor(-6.1379, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4204, dtype=torch.float64) delta_t tensor(0.2880, dtype=torch.float64)
14 gae_duplicate tensor(-2.1662, dtype=torch.float64) tensor(-5.2108, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1750, dtype=torch.float64) delta_t tensor(0.1804, dtype=torch.float64)
13 gae_duplicate tensor(-1.3009, dtype=torch.float64) tensor(1.6967, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-1.0288, dtype=torch.float64) delta_t tensor(-1.2349, dtype=torch.float64)
12 gae_duplicate tensor(-4.1133, dtype=torch.float64) tensor(-3.2729, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3088, dtype=torch.float64) delta_t tensor(-0.4688, dtype=torch.float64)
11 gae_duplicate tensor(-3.6993, dtype=torch.float64) tensor(1.3189, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1487, dtype=torch.float64) delta_t tensor(-0.4390, dtype=torch.float64)
10 gae_duplicate tensor(-2.8933, dtype=torch.float64) tensor(1.6648, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0746, dtype=torch.float64) delta_t tensor(0.0271, dtype=torch.float64)
9 gae_duplicate tensor(-2.1808, dtype=torch.float64) tensor(0.2787, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0122, dtype=torch.float64) delta_t tensor(0.1587, dtype=torch.float64)
8 gae_duplicate tensor(-1.3075, dtype=torch.float64) tensor(7.9703, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0197, dtype=torch.float64) delta_t tensor(-0.1606, dtype=torch.float64)
7 gae_duplicate tensor(-1.0782, dtype=torch.float64) tensor(2.5270, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2688, dtype=torch.float64) delta_t tensor(-0.1454, dtype=torch.float64)
6 gae_duplicate tensor(-2.3642, dtype=torch.float64) tensor(0.8664, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4372, dtype=torch.float64) delta_t tensor(0.1161, dtype=torch.float64)
5 gae_duplicate tensor(-1.7147, dtype=torch.float64) tensor(1.6251, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1365, dtype=torch.float64) delta_t tensor(0.4964, dtype=torch.float64)
4 gae_duplicate tensor(-2.5204, dtype=torch.float64) tensor(-4.8973, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0922, dtype=torch.float64) delta_t tensor(0.3007, dtype=torch.float64)
3 gae_duplicate tensor(-1.9793, dtype=torch.float64) tensor(-0.5968, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2241, dtype=torch.float64) delta_t tensor(-0.6268, dtype=torch.float64)
2 gae_duplicate tensor(-2.7684, dtype=torch.float64) tensor(0.3972, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:47.08335494995117
value loss:313.39508056640625
entropies:85.73399353027344
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.685793876647949 seconds
19 rew tensor(0.7346, dtype=torch.float64) delta_t tensor(-0.8557, dtype=torch.float64)
19 gae_duplicate tensor(-1.0485, dtype=torch.float64) tensor(3.8473, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7189, dtype=torch.float64) delta_t tensor(0.3933, dtype=torch.float64)
18 gae_duplicate tensor(-0.5444, dtype=torch.float64) tensor(4.2530, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6954, dtype=torch.float64) delta_t tensor(0.6052, dtype=torch.float64)
17 gae_duplicate tensor(-0.2142, dtype=torch.float64) tensor(-2.8805, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6719, dtype=torch.float64) delta_t tensor(0.2930, dtype=torch.float64)
16 gae_duplicate tensor(-0.1419, dtype=torch.float64) tensor(-3.5480, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6011, dtype=torch.float64) delta_t tensor(0.4157, dtype=torch.float64)
15 gae_duplicate tensor(-0.6670, dtype=torch.float64) tensor(-1.2164, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7272, dtype=torch.float64) delta_t tensor(0.6832, dtype=torch.float64)
14 gae_duplicate tensor(0.9173, dtype=torch.float64) tensor(-14.2157, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5801, dtype=torch.float64) delta_t tensor(0.2366, dtype=torch.float64)
13 gae_duplicate tensor(0.8186, dtype=torch.float64) tensor(-6.8079, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0837, dtype=torch.float64) delta_t tensor(0.2141, dtype=torch.float64)
12 gae_duplicate tensor(-2.6029, dtype=torch.float64) tensor(-10.6016, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3411, dtype=torch.float64) delta_t tensor(-0.7407, dtype=torch.float64)
11 gae_duplicate tensor(-1.8031, dtype=torch.float64) tensor(-5.8935, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2984, dtype=torch.float64) delta_t tensor(0.0331, dtype=torch.float64)
10 gae_duplicate tensor(-2.1740, dtype=torch.float64) tensor(-4.8429, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2594, dtype=torch.float64) delta_t tensor(0.0076, dtype=torch.float64)
9 gae_duplicate tensor(-1.7411, dtype=torch.float64) tensor(-0.1368, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5401, dtype=torch.float64) delta_t tensor(-0.4982, dtype=torch.float64)
8 gae_duplicate tensor(-1.2701, dtype=torch.float64) tensor(-0.6568, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2068, dtype=torch.float64) delta_t tensor(-0.1116, dtype=torch.float64)
7 gae_duplicate tensor(-1.3516, dtype=torch.float64) tensor(6.7821, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1205, dtype=torch.float64) delta_t tensor(0.0276, dtype=torch.float64)
6 gae_duplicate tensor(-0.9729, dtype=torch.float64) tensor(1.5158, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5045, dtype=torch.float64) delta_t tensor(-0.0347, dtype=torch.float64)
5 gae_duplicate tensor(-1.7476, dtype=torch.float64) tensor(-0.1413, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2351, dtype=torch.float64) delta_t tensor(0.7602, dtype=torch.float64)
4 gae_duplicate tensor(-0.0517, dtype=torch.float64) tensor(-5.2240, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2066, dtype=torch.float64) delta_t tensor(0.4210, dtype=torch.float64)
3 gae_duplicate tensor(0.0955, dtype=torch.float64) tensor(-1.1540, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1789, dtype=torch.float64) delta_t tensor(-0.4309, dtype=torch.float64)
2 gae_duplicate tensor(-0.4904, dtype=torch.float64) tensor(-0.3056, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1468.4832763671875
value loss:212.3004608154297
entropies:87.16490936279297
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1546.1731)
ToM Target loss= tensor(1815.9641)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.902101993560791 seconds
19 rew tensor(0.7266, dtype=torch.float64) delta_t tensor(-0.5199, dtype=torch.float64)
19 gae_duplicate tensor(-0.7891, dtype=torch.float64) tensor(4.0455, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7188, dtype=torch.float64) delta_t tensor(0.5858, dtype=torch.float64)
18 gae_duplicate tensor(-0.1946, dtype=torch.float64) tensor(-2.7059, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6953, dtype=torch.float64) delta_t tensor(0.4039, dtype=torch.float64)
17 gae_duplicate tensor(-0.1068, dtype=torch.float64) tensor(-5.3057, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4493, dtype=torch.float64) delta_t tensor(0.2624, dtype=torch.float64)
16 gae_duplicate tensor(-0.1806, dtype=torch.float64) tensor(-1.0930, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3399, dtype=torch.float64) delta_t tensor(0.6746, dtype=torch.float64)
15 gae_duplicate tensor(-0.8019, dtype=torch.float64) tensor(-11.3700, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5899, dtype=torch.float64) delta_t tensor(0.6302, dtype=torch.float64)
14 gae_duplicate tensor(-0.2407, dtype=torch.float64) tensor(-2.4698, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5007, dtype=torch.float64) delta_t tensor(0.4326, dtype=torch.float64)
13 gae_duplicate tensor(0.0444, dtype=torch.float64) tensor(-2.7404, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1635, dtype=torch.float64) delta_t tensor(-0.1203, dtype=torch.float64)
12 gae_duplicate tensor(-2.4802, dtype=torch.float64) tensor(4.1158, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0023, dtype=torch.float64) delta_t tensor(-0.2190, dtype=torch.float64)
11 gae_duplicate tensor(-0.7483, dtype=torch.float64) tensor(-1.1967, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2074, dtype=torch.float64) delta_t tensor(-0.8392, dtype=torch.float64)
10 gae_duplicate tensor(-2.6662, dtype=torch.float64) tensor(2.8530, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3380, dtype=torch.float64) delta_t tensor(0.4742, dtype=torch.float64)
9 gae_duplicate tensor(-1.2503, dtype=torch.float64) tensor(-0.3908, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4557, dtype=torch.float64) delta_t tensor(-0.4596, dtype=torch.float64)
8 gae_duplicate tensor(-1.1250, dtype=torch.float64) tensor(5.3732, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2022, dtype=torch.float64) delta_t tensor(-0.2703, dtype=torch.float64)
7 gae_duplicate tensor(-1.8251, dtype=torch.float64) tensor(0.6862, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3540, dtype=torch.float64) delta_t tensor(0.0295, dtype=torch.float64)
6 gae_duplicate tensor(-2.0752, dtype=torch.float64) tensor(5.3921, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3396, dtype=torch.float64) delta_t tensor(-0.1728, dtype=torch.float64)
5 gae_duplicate tensor(-2.0082, dtype=torch.float64) tensor(0.5947, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0932, dtype=torch.float64) delta_t tensor(-0.4934, dtype=torch.float64)
4 gae_duplicate tensor(-7.5430, dtype=torch.float64) tensor(1.1688, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0489, dtype=torch.float64) delta_t tensor(0.4541, dtype=torch.float64)
3 gae_duplicate tensor(-5.7136, dtype=torch.float64) tensor(-1.9290, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2720, dtype=torch.float64) delta_t tensor(-0.1844, dtype=torch.float64)
2 gae_duplicate tensor(-4.4070, dtype=torch.float64) tensor(-1.0064, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:199.34059143066406
value loss:478.1524658203125
entropies:88.23912811279297
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.623220920562744 seconds
19 rew tensor(0.7194, dtype=torch.float64) delta_t tensor(-0.6929, dtype=torch.float64)
19 gae_duplicate tensor(-0.8564, dtype=torch.float64) tensor(6.0332, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6731, dtype=torch.float64) delta_t tensor(0.4758, dtype=torch.float64)
18 gae_duplicate tensor(-0.3533, dtype=torch.float64) tensor(0.1113, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6036, dtype=torch.float64) delta_t tensor(0.2216, dtype=torch.float64)
17 gae_duplicate tensor(-0.2832, dtype=torch.float64) tensor(0.8881, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4412, dtype=torch.float64) delta_t tensor(0.2412, dtype=torch.float64)
16 gae_duplicate tensor(-0.1601, dtype=torch.float64) tensor(-0.2739, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.2409, dtype=torch.float64) delta_t tensor(-0.3265, dtype=torch.float64)
15 gae_duplicate tensor(-3.1921, dtype=torch.float64) tensor(5.8324, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7272, dtype=torch.float64) delta_t tensor(0.4790, dtype=torch.float64)
14 gae_duplicate tensor(-2.0412, dtype=torch.float64) tensor(-0.6334, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6962, dtype=torch.float64) delta_t tensor(0.5163, dtype=torch.float64)
13 gae_duplicate tensor(-1.2064, dtype=torch.float64) tensor(-1.2988, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3619, dtype=torch.float64) delta_t tensor(0.2424, dtype=torch.float64)
12 gae_duplicate tensor(-0.7697, dtype=torch.float64) tensor(-1.3618, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1387, dtype=torch.float64) delta_t tensor(-0.1398, dtype=torch.float64)
11 gae_duplicate tensor(-2.8913, dtype=torch.float64) tensor(-9.6273, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4530, dtype=torch.float64) delta_t tensor(-0.0113, dtype=torch.float64)
10 gae_duplicate tensor(-2.2705, dtype=torch.float64) tensor(-0.4180, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6052, dtype=torch.float64) delta_t tensor(-0.6094, dtype=torch.float64)
9 gae_duplicate tensor(-2.6014, dtype=torch.float64) tensor(0.2198, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2010, dtype=torch.float64) delta_t tensor(-0.0936, dtype=torch.float64)
8 gae_duplicate tensor(-2.4139, dtype=torch.float64) tensor(0.3627, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4785, dtype=torch.float64) delta_t tensor(-0.2637, dtype=torch.float64)
7 gae_duplicate tensor(-2.4354, dtype=torch.float64) tensor(12.0805, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0126, dtype=torch.float64) delta_t tensor(0.0584, dtype=torch.float64)
6 gae_duplicate tensor(-3.8038, dtype=torch.float64) tensor(8.2292, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0214, dtype=torch.float64) delta_t tensor(-0.3324, dtype=torch.float64)
5 gae_duplicate tensor(-3.5555, dtype=torch.float64) tensor(2.9773, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1766, dtype=torch.float64) delta_t tensor(0.3511, dtype=torch.float64)
4 gae_duplicate tensor(-4.9449, dtype=torch.float64) tensor(10.9462, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5626, dtype=torch.float64) delta_t tensor(-0.0586, dtype=torch.float64)
3 gae_duplicate tensor(-3.6000, dtype=torch.float64) tensor(-1.4930, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1632, dtype=torch.float64) delta_t tensor(-0.3659, dtype=torch.float64)
2 gae_duplicate tensor(-2.2965, dtype=torch.float64) tensor(0.6503, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1211.9217529296875
value loss:316.7901306152344
entropies:87.92584228515625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.752429246902466 seconds
19 rew tensor(0.6953, dtype=torch.float64) delta_t tensor(-0.4125, dtype=torch.float64)
19 gae_duplicate tensor(-1.1289, dtype=torch.float64) tensor(1.3931, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6717, dtype=torch.float64) delta_t tensor(0.5261, dtype=torch.float64)
18 gae_duplicate tensor(-0.5591, dtype=torch.float64) tensor(-0.2414, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5929, dtype=torch.float64) delta_t tensor(0.9492, dtype=torch.float64)
17 gae_duplicate tensor(-0.1787, dtype=torch.float64) tensor(-1.7404, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5690, dtype=torch.float64) delta_t tensor(0.4266, dtype=torch.float64)
16 gae_duplicate tensor(-0.7205, dtype=torch.float64) tensor(-9.4147, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7193, dtype=torch.float64) delta_t tensor(0.6641, dtype=torch.float64)
15 gae_duplicate tensor(-0.1763, dtype=torch.float64) tensor(-2.5553, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7195, dtype=torch.float64) delta_t tensor(0.7390, dtype=torch.float64)
14 gae_duplicate tensor(1.3791, dtype=torch.float64) tensor(-8.5983, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6642, dtype=torch.float64) delta_t tensor(0.8040, dtype=torch.float64)
13 gae_duplicate tensor(1.7279, dtype=torch.float64) tensor(-21.5601, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.5207, dtype=torch.float64) delta_t tensor(-0.7853, dtype=torch.float64)
12 gae_duplicate tensor(-1.8766, dtype=torch.float64) tensor(2.7367, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2199, dtype=torch.float64) delta_t tensor(-0.0835, dtype=torch.float64)
11 gae_duplicate tensor(-1.6085, dtype=torch.float64) tensor(-1.1664, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3251, dtype=torch.float64) delta_t tensor(-0.7112, dtype=torch.float64)
10 gae_duplicate tensor(-4.2731, dtype=torch.float64) tensor(-11.1774, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1750, dtype=torch.float64) delta_t tensor(-0.0670, dtype=torch.float64)
9 gae_duplicate tensor(-3.2134, dtype=torch.float64) tensor(1.8995, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0091, dtype=torch.float64) delta_t tensor(-1.1885, dtype=torch.float64)
8 gae_duplicate tensor(-3.1551, dtype=torch.float64) tensor(1.8087, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2721, dtype=torch.float64) delta_t tensor(0.0630, dtype=torch.float64)
7 gae_duplicate tensor(-3.1233, dtype=torch.float64) tensor(1.3808, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7195, dtype=torch.float64) delta_t tensor(-0.5448, dtype=torch.float64)
6 gae_duplicate tensor(-4.1892, dtype=torch.float64) tensor(1.8302, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2690, dtype=torch.float64) delta_t tensor(-0.8612, dtype=torch.float64)
5 gae_duplicate tensor(-4.6890, dtype=torch.float64) tensor(7.7369, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1145, dtype=torch.float64) delta_t tensor(0.7607, dtype=torch.float64)
4 gae_duplicate tensor(-5.2192, dtype=torch.float64) tensor(1.1389, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5033, dtype=torch.float64) delta_t tensor(-0.0484, dtype=torch.float64)
3 gae_duplicate tensor(-3.8186, dtype=torch.float64) tensor(0.9158, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0876, dtype=torch.float64) delta_t tensor(-0.2619, dtype=torch.float64)
2 gae_duplicate tensor(-2.4688, dtype=torch.float64) tensor(0.9704, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1231.39306640625
value loss:647.5548095703125
entropies:87.55318450927734
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.685029029846191 seconds
19 rew tensor(0.6174, dtype=torch.float64) delta_t tensor(-0.6669, dtype=torch.float64)
19 gae_duplicate tensor(-1.3483, dtype=torch.float64) tensor(0.9443, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4763, dtype=torch.float64) delta_t tensor(0.3001, dtype=torch.float64)
18 gae_duplicate tensor(-1.2682, dtype=torch.float64) tensor(-2.4656, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2254, dtype=torch.float64) delta_t tensor(0.1005, dtype=torch.float64)
17 gae_duplicate tensor(-1.4142, dtype=torch.float64) tensor(3.7585, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3390, dtype=torch.float64) delta_t tensor(0.1615, dtype=torch.float64)
16 gae_duplicate tensor(-0.4182, dtype=torch.float64) tensor(0.9419, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0049, dtype=torch.float64) delta_t tensor(0.4619, dtype=torch.float64)
15 gae_duplicate tensor(-0.3986, dtype=torch.float64) tensor(-0.7845, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7352, dtype=torch.float64) delta_t tensor(0.6495, dtype=torch.float64)
14 gae_duplicate tensor(0.2032, dtype=torch.float64) tensor(-3.6812, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7355, dtype=torch.float64) delta_t tensor(0.9079, dtype=torch.float64)
13 gae_duplicate tensor(0.6847, dtype=torch.float64) tensor(-5.9047, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0990, dtype=torch.float64) delta_t tensor(0.0450, dtype=torch.float64)
12 gae_duplicate tensor(-0.9595, dtype=torch.float64) tensor(-10.6415, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6733, dtype=torch.float64) delta_t tensor(-0.7045, dtype=torch.float64)
11 gae_duplicate tensor(-1.9337, dtype=torch.float64) tensor(-11.6722, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2950, dtype=torch.float64) delta_t tensor(-1.1110, dtype=torch.float64)
10 gae_duplicate tensor(-4.9491, dtype=torch.float64) tensor(1.0393, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8503, dtype=torch.float64) delta_t tensor(-0.9499, dtype=torch.float64)
9 gae_duplicate tensor(-4.8434, dtype=torch.float64) tensor(2.1266, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3573, dtype=torch.float64) delta_t tensor(-0.4620, dtype=torch.float64)
8 gae_duplicate tensor(-2.7327, dtype=torch.float64) tensor(2.3825, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1064, dtype=torch.float64) delta_t tensor(0.1919, dtype=torch.float64)
7 gae_duplicate tensor(-1.9149, dtype=torch.float64) tensor(1.7385, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4243, dtype=torch.float64) delta_t tensor(-0.3350, dtype=torch.float64)
6 gae_duplicate tensor(-2.7850, dtype=torch.float64) tensor(1.8585, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8406, dtype=torch.float64) delta_t tensor(0.1296, dtype=torch.float64)
5 gae_duplicate tensor(-2.1744, dtype=torch.float64) tensor(1.3671, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8988, dtype=torch.float64) delta_t tensor(-0.7058, dtype=torch.float64)
4 gae_duplicate tensor(-7.1582, dtype=torch.float64) tensor(19.4341, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3719, dtype=torch.float64) delta_t tensor(0.2087, dtype=torch.float64)
3 gae_duplicate tensor(-5.2265, dtype=torch.float64) tensor(1.1648, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0479, dtype=torch.float64) delta_t tensor(-0.0537, dtype=torch.float64)
2 gae_duplicate tensor(-3.9583, dtype=torch.float64) tensor(0.9907, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-109.03064727783203
value loss:473.4465026855469
entropies:86.29335021972656
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.811523914337158 seconds
19 rew tensor(0.7116, dtype=torch.float64) delta_t tensor(-0.6269, dtype=torch.float64)
19 gae_duplicate tensor(-0.9048, dtype=torch.float64) tensor(0.9016, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6723, dtype=torch.float64) delta_t tensor(0.4526, dtype=torch.float64)
18 gae_duplicate tensor(-0.3818, dtype=torch.float64) tensor(0.0660, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6095, dtype=torch.float64) delta_t tensor(0.2683, dtype=torch.float64)
17 gae_duplicate tensor(-0.1926, dtype=torch.float64) tensor(-0.0282, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4601, dtype=torch.float64) delta_t tensor(0.3480, dtype=torch.float64)
16 gae_duplicate tensor(-0.1927, dtype=torch.float64) tensor(-2.7578, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2478, dtype=torch.float64) delta_t tensor(0.3142, dtype=torch.float64)
15 gae_duplicate tensor(-0.2807, dtype=torch.float64) tensor(-4.8587, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5776, dtype=torch.float64) delta_t tensor(0.5062, dtype=torch.float64)
14 gae_duplicate tensor(-0.6412, dtype=torch.float64) tensor(1.7185, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2541, dtype=torch.float64) delta_t tensor(-0.0075, dtype=torch.float64)
13 gae_duplicate tensor(-2.7615, dtype=torch.float64) tensor(-15.5255, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4119, dtype=torch.float64) delta_t tensor(0.2529, dtype=torch.float64)
12 gae_duplicate tensor(-2.2869, dtype=torch.float64) tensor(-4.5406, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1043, dtype=torch.float64) delta_t tensor(0.1844, dtype=torch.float64)
11 gae_duplicate tensor(-1.3363, dtype=torch.float64) tensor(-4.5232, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0273, dtype=torch.float64) delta_t tensor(-0.7585, dtype=torch.float64)
10 gae_duplicate tensor(-1.5394, dtype=torch.float64) tensor(1.4911, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6265, dtype=torch.float64) delta_t tensor(-0.8813, dtype=torch.float64)
9 gae_duplicate tensor(-4.4922, dtype=torch.float64) tensor(-2.1179, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5054, dtype=torch.float64) delta_t tensor(-0.3570, dtype=torch.float64)
8 gae_duplicate tensor(-5.2936, dtype=torch.float64) tensor(-0.7380, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0044, dtype=torch.float64) delta_t tensor(0.0996, dtype=torch.float64)
7 gae_duplicate tensor(-4.0141, dtype=torch.float64) tensor(1.2981, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1795, dtype=torch.float64) delta_t tensor(0.0624, dtype=torch.float64)
6 gae_duplicate tensor(-2.9335, dtype=torch.float64) tensor(2.1399, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2656, dtype=torch.float64) delta_t tensor(-0.0857, dtype=torch.float64)
5 gae_duplicate tensor(-1.8800, dtype=torch.float64) tensor(5.3830, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0424, dtype=torch.float64) delta_t tensor(0.6990, dtype=torch.float64)
4 gae_duplicate tensor(-0.7409, dtype=torch.float64) tensor(-0.1161, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0536, dtype=torch.float64) delta_t tensor(0.4518, dtype=torch.float64)
3 gae_duplicate tensor(-0.2803, dtype=torch.float64) tensor(-2.4899, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2805, dtype=torch.float64) delta_t tensor(-0.1686, dtype=torch.float64)
2 gae_duplicate tensor(-0.1775, dtype=torch.float64) tensor(-0.0268, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:874.3128051757812
value loss:317.07830810546875
entropies:87.57109069824219
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1533.2202)
ToM Target loss= tensor(1817.9861)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.1645166873931885 seconds
19 rew tensor(0.7355, dtype=torch.float64) delta_t tensor(-0.4627, dtype=torch.float64)
19 gae_duplicate tensor(-0.9668, dtype=torch.float64) tensor(0.7007, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7119, dtype=torch.float64) delta_t tensor(0.4069, dtype=torch.float64)
18 gae_duplicate tensor(-0.3704, dtype=torch.float64) tensor(0.7444, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6963, dtype=torch.float64) delta_t tensor(0.5890, dtype=torch.float64)
17 gae_duplicate tensor(0.1068, dtype=torch.float64) tensor(-3.2860, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6569, dtype=torch.float64) delta_t tensor(0.4086, dtype=torch.float64)
16 gae_duplicate tensor(0.4225, dtype=torch.float64) tensor(-4.5725, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5783, dtype=torch.float64) delta_t tensor(0.7111, dtype=torch.float64)
15 gae_duplicate tensor(0.6857, dtype=torch.float64) tensor(-2.1007, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6662, dtype=torch.float64) delta_t tensor(0.4567, dtype=torch.float64)
14 gae_duplicate tensor(0.7570, dtype=torch.float64) tensor(-10.7760, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6507, dtype=torch.float64) delta_t tensor(0.4574, dtype=torch.float64)
13 gae_duplicate tensor(1.1843, dtype=torch.float64) tensor(-5.3710, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3586, dtype=torch.float64) delta_t tensor(-0.6811, dtype=torch.float64)
12 gae_duplicate tensor(-2.0165, dtype=torch.float64) tensor(-5.0011, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7239, dtype=torch.float64) delta_t tensor(-0.9878, dtype=torch.float64)
11 gae_duplicate tensor(-2.4877, dtype=torch.float64) tensor(3.7047, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2892, dtype=torch.float64) delta_t tensor(0.2370, dtype=torch.float64)
10 gae_duplicate tensor(-1.9568, dtype=torch.float64) tensor(-7.2240, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1166, dtype=torch.float64) delta_t tensor(-0.2285, dtype=torch.float64)
9 gae_duplicate tensor(-1.3082, dtype=torch.float64) tensor(0.7750, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2910, dtype=torch.float64) delta_t tensor(0.1155, dtype=torch.float64)
8 gae_duplicate tensor(-0.8101, dtype=torch.float64) tensor(0.5299, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2273, dtype=torch.float64) delta_t tensor(-0.1254, dtype=torch.float64)
7 gae_duplicate tensor(-2.1210, dtype=torch.float64) tensor(-2.5767, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8518, dtype=torch.float64) delta_t tensor(-0.3908, dtype=torch.float64)
6 gae_duplicate tensor(-3.9106, dtype=torch.float64) tensor(0.8742, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4360, dtype=torch.float64) delta_t tensor(0.0390, dtype=torch.float64)
5 gae_duplicate tensor(-3.8707, dtype=torch.float64) tensor(1.7016, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5117, dtype=torch.float64) delta_t tensor(-0.1739, dtype=torch.float64)
4 gae_duplicate tensor(-4.8267, dtype=torch.float64) tensor(3.6089, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3840, dtype=torch.float64) delta_t tensor(0.0852, dtype=torch.float64)
3 gae_duplicate tensor(-3.5141, dtype=torch.float64) tensor(1.9936, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4547, dtype=torch.float64) delta_t tensor(-0.0909, dtype=torch.float64)
2 gae_duplicate tensor(-2.2219, dtype=torch.float64) tensor(3.8508, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:791.2259521484375
value loss:327.9813232421875
entropies:89.16840362548828
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.708065032958984 seconds
19 rew tensor(0.3796, dtype=torch.float64) delta_t tensor(-0.9188, dtype=torch.float64)
19 gae_duplicate tensor(-2.2186, dtype=torch.float64) tensor(2.6437, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6329, dtype=torch.float64) delta_t tensor(0.4056, dtype=torch.float64)
18 gae_duplicate tensor(-1.2520, dtype=torch.float64) tensor(0.4869, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5224, dtype=torch.float64) delta_t tensor(0.3360, dtype=torch.float64)
17 gae_duplicate tensor(-0.8104, dtype=torch.float64) tensor(1.8992, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6092, dtype=torch.float64) delta_t tensor(0.7311, dtype=torch.float64)
16 gae_duplicate tensor(0.0066, dtype=torch.float64) tensor(-4.4439, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4828, dtype=torch.float64) delta_t tensor(0.3344, dtype=torch.float64)
15 gae_duplicate tensor(-0.1546, dtype=torch.float64) tensor(-8.1492, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6332, dtype=torch.float64) delta_t tensor(0.5880, dtype=torch.float64)
14 gae_duplicate tensor(-0.0367, dtype=torch.float64) tensor(-7.4571, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0629, dtype=torch.float64) delta_t tensor(-0.0521, dtype=torch.float64)
13 gae_duplicate tensor(-2.4423, dtype=torch.float64) tensor(-2.8921, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0550, dtype=torch.float64) delta_t tensor(-0.4485, dtype=torch.float64)
12 gae_duplicate tensor(-3.7404, dtype=torch.float64) tensor(8.7193, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3695, dtype=torch.float64) delta_t tensor(0.0599, dtype=torch.float64)
11 gae_duplicate tensor(-2.5069, dtype=torch.float64) tensor(-5.6026, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1929, dtype=torch.float64) delta_t tensor(-0.6409, dtype=torch.float64)
10 gae_duplicate tensor(-2.5102, dtype=torch.float64) tensor(0.7514, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3470, dtype=torch.float64) delta_t tensor(-0.0235, dtype=torch.float64)
9 gae_duplicate tensor(-4.1222, dtype=torch.float64) tensor(0.4363, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7356, dtype=torch.float64) delta_t tensor(-0.9556, dtype=torch.float64)
8 gae_duplicate tensor(-3.4534, dtype=torch.float64) tensor(18.0419, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4980, dtype=torch.float64) delta_t tensor(-0.2952, dtype=torch.float64)
7 gae_duplicate tensor(-3.9383, dtype=torch.float64) tensor(1.8341, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2716, dtype=torch.float64) delta_t tensor(0.1967, dtype=torch.float64)
6 gae_duplicate tensor(-3.2816, dtype=torch.float64) tensor(4.4545, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6026, dtype=torch.float64) delta_t tensor(-0.2079, dtype=torch.float64)
5 gae_duplicate tensor(-3.9038, dtype=torch.float64) tensor(4.4301, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3590, dtype=torch.float64) delta_t tensor(1.0596, dtype=torch.float64)
4 gae_duplicate tensor(-1.8290, dtype=torch.float64) tensor(-0.7237, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2176, dtype=torch.float64) delta_t tensor(0.3407, dtype=torch.float64)
3 gae_duplicate tensor(-0.5482, dtype=torch.float64) tensor(-0.5460, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1957, dtype=torch.float64) delta_t tensor(-0.0645, dtype=torch.float64)
2 gae_duplicate tensor(-0.3479, dtype=torch.float64) tensor(-2.7999, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-415.1764221191406
value loss:428.7137451171875
entropies:89.945068359375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.880803823471069 seconds
19 rew tensor(0.6490, dtype=torch.float64) delta_t tensor(-0.7430, dtype=torch.float64)
19 gae_duplicate tensor(-1.1766, dtype=torch.float64) tensor(3.1640, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5544, dtype=torch.float64) delta_t tensor(0.5004, dtype=torch.float64)
18 gae_duplicate tensor(-1.0445, dtype=torch.float64) tensor(0.1461, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3889, dtype=torch.float64) delta_t tensor(0.1481, dtype=torch.float64)
17 gae_duplicate tensor(-1.0408, dtype=torch.float64) tensor(-4.0039, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5327, dtype=torch.float64) delta_t tensor(0.3761, dtype=torch.float64)
16 gae_duplicate tensor(-0.1493, dtype=torch.float64) tensor(-1.4904, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4000, dtype=torch.float64) delta_t tensor(0.0716, dtype=torch.float64)
15 gae_duplicate tensor(-0.0199, dtype=torch.float64) tensor(-0.5750, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4363, dtype=torch.float64) delta_t tensor(0.2562, dtype=torch.float64)
14 gae_duplicate tensor(-0.3529, dtype=torch.float64) tensor(-8.0336, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.8637, dtype=torch.float64) delta_t tensor(-1.1147, dtype=torch.float64)
13 gae_duplicate tensor(-3.5838, dtype=torch.float64) tensor(-2.8362, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4120, dtype=torch.float64) delta_t tensor(0.2738, dtype=torch.float64)
12 gae_duplicate tensor(-3.1368, dtype=torch.float64) tensor(0.3678, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4602, dtype=torch.float64) delta_t tensor(0.2470, dtype=torch.float64)
11 gae_duplicate tensor(-2.0826, dtype=torch.float64) tensor(-5.1938, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4693, dtype=torch.float64) delta_t tensor(0.0662, dtype=torch.float64)
10 gae_duplicate tensor(-1.6008, dtype=torch.float64) tensor(0.5751, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0874, dtype=torch.float64) delta_t tensor(-0.1252, dtype=torch.float64)
9 gae_duplicate tensor(-1.1523, dtype=torch.float64) tensor(0.3912, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2708, dtype=torch.float64) delta_t tensor(-0.5918, dtype=torch.float64)
8 gae_duplicate tensor(-3.5514, dtype=torch.float64) tensor(2.6810, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3138, dtype=torch.float64) delta_t tensor(0.3192, dtype=torch.float64)
7 gae_duplicate tensor(-1.3174, dtype=torch.float64) tensor(5.2347, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3337, dtype=torch.float64) delta_t tensor(0.0472, dtype=torch.float64)
6 gae_duplicate tensor(-2.3098, dtype=torch.float64) tensor(5.4821, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7586, dtype=torch.float64) delta_t tensor(0.0571, dtype=torch.float64)
5 gae_duplicate tensor(-1.9363, dtype=torch.float64) tensor(3.9046, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4614, dtype=torch.float64) delta_t tensor(0.9236, dtype=torch.float64)
4 gae_duplicate tensor(-0.6031, dtype=torch.float64) tensor(-11.6367, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5850, dtype=torch.float64) delta_t tensor(-0.1989, dtype=torch.float64)
3 gae_duplicate tensor(-1.7448, dtype=torch.float64) tensor(-3.7787, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1188, dtype=torch.float64) delta_t tensor(-0.1895, dtype=torch.float64)
2 gae_duplicate tensor(-1.1508, dtype=torch.float64) tensor(-2.6918, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:642.2224731445312
value loss:223.585205078125
entropies:90.77416229248047
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.847936153411865 seconds
19 rew tensor(0.5953, dtype=torch.float64) delta_t tensor(-0.1493, dtype=torch.float64)
19 gae_duplicate tensor(-1.8607, dtype=torch.float64) tensor(0.5293, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4395, dtype=torch.float64) delta_t tensor(0.3853, dtype=torch.float64)
18 gae_duplicate tensor(-2.3837, dtype=torch.float64) tensor(0.9599, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7358, dtype=torch.float64) delta_t tensor(0.6157, dtype=torch.float64)
17 gae_duplicate tensor(-1.4375, dtype=torch.float64) tensor(-5.0968, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7121, dtype=torch.float64) delta_t tensor(0.5123, dtype=torch.float64)
16 gae_duplicate tensor(-0.6805, dtype=torch.float64) tensor(-1.7428, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6489, dtype=torch.float64) delta_t tensor(0.1704, dtype=torch.float64)
15 gae_duplicate tensor(-0.0748, dtype=torch.float64) tensor(-8.0043, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6331, dtype=torch.float64) delta_t tensor(0.4791, dtype=torch.float64)
14 gae_duplicate tensor(0.4100, dtype=torch.float64) tensor(-5.5904, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1656, dtype=torch.float64) delta_t tensor(0.1274, dtype=torch.float64)
13 gae_duplicate tensor(-1.6732, dtype=torch.float64) tensor(-1.7942, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5326, dtype=torch.float64) delta_t tensor(0.2436, dtype=torch.float64)
12 gae_duplicate tensor(-1.3537, dtype=torch.float64) tensor(1.4470, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5882, dtype=torch.float64) delta_t tensor(0.1810, dtype=torch.float64)
11 gae_duplicate tensor(-0.5901, dtype=torch.float64) tensor(-0.3315, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2093, dtype=torch.float64) delta_t tensor(-0.1848, dtype=torch.float64)
10 gae_duplicate tensor(-1.6112, dtype=torch.float64) tensor(-3.5012, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2112, dtype=torch.float64) delta_t tensor(-0.4003, dtype=torch.float64)
9 gae_duplicate tensor(-2.7655, dtype=torch.float64) tensor(-1.6016, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1996, dtype=torch.float64) delta_t tensor(-0.3363, dtype=torch.float64)
8 gae_duplicate tensor(-2.2475, dtype=torch.float64) tensor(0.2275, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7825, dtype=torch.float64) delta_t tensor(-0.2607, dtype=torch.float64)
7 gae_duplicate tensor(-2.3496, dtype=torch.float64) tensor(3.9569, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1691, dtype=torch.float64) delta_t tensor(-0.2866, dtype=torch.float64)
6 gae_duplicate tensor(-3.0843, dtype=torch.float64) tensor(8.9255, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7804, dtype=torch.float64) delta_t tensor(-0.3175, dtype=torch.float64)
5 gae_duplicate tensor(-4.0978, dtype=torch.float64) tensor(3.1426, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4028, dtype=torch.float64) delta_t tensor(-0.6999, dtype=torch.float64)
4 gae_duplicate tensor(-6.2307, dtype=torch.float64) tensor(6.9966, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4070, dtype=torch.float64) delta_t tensor(-0.0304, dtype=torch.float64)
3 gae_duplicate tensor(-5.3296, dtype=torch.float64) tensor(11.1060, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1497, dtype=torch.float64) delta_t tensor(-0.1355, dtype=torch.float64)
2 gae_duplicate tensor(-3.6324, dtype=torch.float64) tensor(1.1208, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-403.3843994140625
value loss:547.8269653320312
entropies:91.15316772460938
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.727756023406982 seconds
19 rew tensor(0.7118, dtype=torch.float64) delta_t tensor(-0.7247, dtype=torch.float64)
19 gae_duplicate tensor(-1.0068, dtype=torch.float64) tensor(3.1556, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6803, dtype=torch.float64) delta_t tensor(0.6155, dtype=torch.float64)
18 gae_duplicate tensor(-0.5184, dtype=torch.float64) tensor(1.0987, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6333, dtype=torch.float64) delta_t tensor(0.3148, dtype=torch.float64)
17 gae_duplicate tensor(-0.3215, dtype=torch.float64) tensor(-2.3956, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4840, dtype=torch.float64) delta_t tensor(0.0863, dtype=torch.float64)
16 gae_duplicate tensor(-0.7502, dtype=torch.float64) tensor(-0.5513, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2481, dtype=torch.float64) delta_t tensor(0.3764, dtype=torch.float64)
15 gae_duplicate tensor(-1.4433, dtype=torch.float64) tensor(-6.0184, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6421, dtype=torch.float64) delta_t tensor(0.9684, dtype=torch.float64)
14 gae_duplicate tensor(0.5882, dtype=torch.float64) tensor(-17.0396, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1896, dtype=torch.float64) delta_t tensor(-0.1937, dtype=torch.float64)
13 gae_duplicate tensor(-1.4580, dtype=torch.float64) tensor(-14.6808, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2573, dtype=torch.float64) delta_t tensor(-0.5784, dtype=torch.float64)
12 gae_duplicate tensor(-4.2209, dtype=torch.float64) tensor(-0.3786, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1926, dtype=torch.float64) delta_t tensor(-0.3960, dtype=torch.float64)
11 gae_duplicate tensor(-2.7599, dtype=torch.float64) tensor(-2.5514, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4661, dtype=torch.float64) delta_t tensor(-0.1222, dtype=torch.float64)
10 gae_duplicate tensor(-2.4723, dtype=torch.float64) tensor(0.5002, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2282, dtype=torch.float64) delta_t tensor(0.1022, dtype=torch.float64)
9 gae_duplicate tensor(-2.5693, dtype=torch.float64) tensor(-1.5357, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3064, dtype=torch.float64) delta_t tensor(0.3812, dtype=torch.float64)
8 gae_duplicate tensor(-1.2923, dtype=torch.float64) tensor(-0.0828, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6015, dtype=torch.float64) delta_t tensor(-0.6784, dtype=torch.float64)
7 gae_duplicate tensor(-3.2448, dtype=torch.float64) tensor(0.7352, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1949, dtype=torch.float64) delta_t tensor(-0.0597, dtype=torch.float64)
6 gae_duplicate tensor(-3.2066, dtype=torch.float64) tensor(2.4404, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1288, dtype=torch.float64) delta_t tensor(-0.7975, dtype=torch.float64)
5 gae_duplicate tensor(-7.7427, dtype=torch.float64) tensor(20.4143, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0356, dtype=torch.float64) delta_t tensor(0.8554, dtype=torch.float64)
4 gae_duplicate tensor(-4.9368, dtype=torch.float64) tensor(11.9000, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1598, dtype=torch.float64) delta_t tensor(0.1227, dtype=torch.float64)
3 gae_duplicate tensor(-3.9030, dtype=torch.float64) tensor(6.2858, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2772, dtype=torch.float64) delta_t tensor(-0.1227, dtype=torch.float64)
2 gae_duplicate tensor(-3.0106, dtype=torch.float64) tensor(10.6853, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-447.97637939453125
value loss:436.514404296875
entropies:92.51791381835938
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1570.0746)
ToM Target loss= tensor(1820.6223)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.005527019500732 seconds
19 rew tensor(0.7277, dtype=torch.float64) delta_t tensor(-0.6562, dtype=torch.float64)
19 gae_duplicate tensor(-0.8519, dtype=torch.float64) tensor(4.0508, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7279, dtype=torch.float64) delta_t tensor(0.4692, dtype=torch.float64)
18 gae_duplicate tensor(-0.2530, dtype=torch.float64) tensor(0.0889, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7124, dtype=torch.float64) delta_t tensor(0.2566, dtype=torch.float64)
17 gae_duplicate tensor(-0.1987, dtype=torch.float64) tensor(-1.3636, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6500, dtype=torch.float64) delta_t tensor(0.4448, dtype=torch.float64)
16 gae_duplicate tensor(0.2908, dtype=torch.float64) tensor(-1.7989, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5950, dtype=torch.float64) delta_t tensor(0.4586, dtype=torch.float64)
15 gae_duplicate tensor(0.2098, dtype=torch.float64) tensor(-3.7259, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1339, dtype=torch.float64) delta_t tensor(-0.1189, dtype=torch.float64)
14 gae_duplicate tensor(-1.6821, dtype=torch.float64) tensor(-1.0799, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5935, dtype=torch.float64) delta_t tensor(0.5836, dtype=torch.float64)
13 gae_duplicate tensor(-0.7573, dtype=torch.float64) tensor(-1.8039, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0158, dtype=torch.float64) delta_t tensor(-0.2906, dtype=torch.float64)
12 gae_duplicate tensor(-2.3418, dtype=torch.float64) tensor(-2.8553, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0961, dtype=torch.float64) delta_t tensor(-0.0472, dtype=torch.float64)
11 gae_duplicate tensor(-1.4107, dtype=torch.float64) tensor(-0.7258, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4826, dtype=torch.float64) delta_t tensor(-1.0253, dtype=torch.float64)
10 gae_duplicate tensor(-3.5998, dtype=torch.float64) tensor(0.0034, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3474, dtype=torch.float64) delta_t tensor(-0.2662, dtype=torch.float64)
9 gae_duplicate tensor(-4.3607, dtype=torch.float64) tensor(1.2734, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2283, dtype=torch.float64) delta_t tensor(-0.3366, dtype=torch.float64)
8 gae_duplicate tensor(-3.4858, dtype=torch.float64) tensor(1.4548, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4298, dtype=torch.float64) delta_t tensor(-0.1082, dtype=torch.float64)
7 gae_duplicate tensor(-2.5877, dtype=torch.float64) tensor(2.4497, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1595, dtype=torch.float64) delta_t tensor(-0.2891, dtype=torch.float64)
6 gae_duplicate tensor(-4.3135, dtype=torch.float64) tensor(13.8618, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5042, dtype=torch.float64) delta_t tensor(-0.1077, dtype=torch.float64)
5 gae_duplicate tensor(-3.9872, dtype=torch.float64) tensor(1.2913, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1234, dtype=torch.float64) delta_t tensor(0.6768, dtype=torch.float64)
4 gae_duplicate tensor(-2.4852, dtype=torch.float64) tensor(-0.0391, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1885, dtype=torch.float64) delta_t tensor(0.4067, dtype=torch.float64)
3 gae_duplicate tensor(-1.5596, dtype=torch.float64) tensor(3.6729, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2203, dtype=torch.float64) delta_t tensor(-0.3323, dtype=torch.float64)
2 gae_duplicate tensor(-0.7046, dtype=torch.float64) tensor(-0.1739, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-541.5317993164062
value loss:289.0513000488281
entropies:92.3576889038086
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.751563787460327 seconds
19 rew tensor(0.7038, dtype=torch.float64) delta_t tensor(-0.8504, dtype=torch.float64)
19 gae_duplicate tensor(-0.9323, dtype=torch.float64) tensor(3.5361, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6960, dtype=torch.float64) delta_t tensor(0.4077, dtype=torch.float64)
18 gae_duplicate tensor(-0.4570, dtype=torch.float64) tensor(0.4254, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6486, dtype=torch.float64) delta_t tensor(0.3649, dtype=torch.float64)
17 gae_duplicate tensor(-0.3426, dtype=torch.float64) tensor(-0.7430, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5141, dtype=torch.float64) delta_t tensor(0.3272, dtype=torch.float64)
16 gae_duplicate tensor(-0.5650, dtype=torch.float64) tensor(-1.6490, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3321, dtype=torch.float64) delta_t tensor(0.3860, dtype=torch.float64)
15 gae_duplicate tensor(-0.9525, dtype=torch.float64) tensor(-4.0301, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7126, dtype=torch.float64) delta_t tensor(0.8640, dtype=torch.float64)
14 gae_duplicate tensor(-0.2991, dtype=torch.float64) tensor(-4.4346, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5307, dtype=torch.float64) delta_t tensor(0.2934, dtype=torch.float64)
13 gae_duplicate tensor(0.2238, dtype=torch.float64) tensor(-14.9520, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2381, dtype=torch.float64) delta_t tensor(0.3693, dtype=torch.float64)
12 gae_duplicate tensor(-0.3049, dtype=torch.float64) tensor(-1.4828, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3809, dtype=torch.float64) delta_t tensor(0.0209, dtype=torch.float64)
11 gae_duplicate tensor(-1.3046, dtype=torch.float64) tensor(-12.2002, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1662, dtype=torch.float64) delta_t tensor(-0.5708, dtype=torch.float64)
10 gae_duplicate tensor(-4.3619, dtype=torch.float64) tensor(-4.5307, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2429, dtype=torch.float64) delta_t tensor(-0.5543, dtype=torch.float64)
9 gae_duplicate tensor(-3.2663, dtype=torch.float64) tensor(-2.6586, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1337, dtype=torch.float64) delta_t tensor(-0.9682, dtype=torch.float64)
8 gae_duplicate tensor(-2.9988, dtype=torch.float64) tensor(1.8271, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6879, dtype=torch.float64) delta_t tensor(-0.8849, dtype=torch.float64)
7 gae_duplicate tensor(-3.2926, dtype=torch.float64) tensor(7.6742, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0246, dtype=torch.float64) delta_t tensor(-0.3628, dtype=torch.float64)
6 gae_duplicate tensor(-2.8843, dtype=torch.float64) tensor(2.6770, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0746, dtype=torch.float64) delta_t tensor(-0.8149, dtype=torch.float64)
5 gae_duplicate tensor(-3.9841, dtype=torch.float64) tensor(11.5890, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6451, dtype=torch.float64) delta_t tensor(-2.2286, dtype=torch.float64)
4 gae_duplicate tensor(-9.6002, dtype=torch.float64) tensor(6.5962, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(6.6097e-06, dtype=torch.float64) delta_t tensor(0.3469, dtype=torch.float64)
3 gae_duplicate tensor(-7.0983, dtype=torch.float64) tensor(14.9838, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4020, dtype=torch.float64) delta_t tensor(-0.1435, dtype=torch.float64)
2 gae_duplicate tensor(-5.5945, dtype=torch.float64) tensor(24.3414, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-987.4649047851562
value loss:890.5379638671875
entropies:92.06491088867188
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.83788800239563 seconds
19 rew tensor(0.6887, dtype=torch.float64) delta_t tensor(-0.5286, dtype=torch.float64)
19 gae_duplicate tensor(-1.0940, dtype=torch.float64) tensor(0.8181, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6104, dtype=torch.float64) delta_t tensor(0.0678, dtype=torch.float64)
18 gae_duplicate tensor(-1.0142, dtype=torch.float64) tensor(0.5348, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4770, dtype=torch.float64) delta_t tensor(0.4979, dtype=torch.float64)
17 gae_duplicate tensor(-0.0195, dtype=torch.float64) tensor(-2.8998, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6404, dtype=torch.float64) delta_t tensor(0.5571, dtype=torch.float64)
16 gae_duplicate tensor(0.4031, dtype=torch.float64) tensor(-4.2114, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5454, dtype=torch.float64) delta_t tensor(0.7183, dtype=torch.float64)
15 gae_duplicate tensor(0.7175, dtype=torch.float64) tensor(-7.8513, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4001, dtype=torch.float64) delta_t tensor(0.3063, dtype=torch.float64)
14 gae_duplicate tensor(0.1981, dtype=torch.float64) tensor(-3.0604, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3846, dtype=torch.float64) delta_t tensor(0.6380, dtype=torch.float64)
13 gae_duplicate tensor(-0.7615, dtype=torch.float64) tensor(-0.8390, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5405, dtype=torch.float64) delta_t tensor(0.1829, dtype=torch.float64)
12 gae_duplicate tensor(-2.0161, dtype=torch.float64) tensor(-7.0036, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5313, dtype=torch.float64) delta_t tensor(0.5451, dtype=torch.float64)
11 gae_duplicate tensor(-1.0762, dtype=torch.float64) tensor(-4.9788, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4147, dtype=torch.float64) delta_t tensor(-0.0753, dtype=torch.float64)
10 gae_duplicate tensor(-0.1765, dtype=torch.float64) tensor(-7.3851, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6064, dtype=torch.float64) delta_t tensor(-0.7747, dtype=torch.float64)
9 gae_duplicate tensor(-1.5897, dtype=torch.float64) tensor(-1.0441, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2084, dtype=torch.float64) delta_t tensor(-0.1719, dtype=torch.float64)
8 gae_duplicate tensor(-1.0773, dtype=torch.float64) tensor(-0.1330, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2301, dtype=torch.float64) delta_t tensor(-0.3311, dtype=torch.float64)
7 gae_duplicate tensor(-2.3776, dtype=torch.float64) tensor(-1.6549, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5629, dtype=torch.float64) delta_t tensor(-0.3334, dtype=torch.float64)
6 gae_duplicate tensor(-3.2778, dtype=torch.float64) tensor(0.1474, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5598, dtype=torch.float64) delta_t tensor(-0.1479, dtype=torch.float64)
5 gae_duplicate tensor(-3.3827, dtype=torch.float64) tensor(1.2364, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6567, dtype=torch.float64) delta_t tensor(-1.1876, dtype=torch.float64)
4 gae_duplicate tensor(-7.1184, dtype=torch.float64) tensor(2.9977, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0935, dtype=torch.float64) delta_t tensor(0.3172, dtype=torch.float64)
3 gae_duplicate tensor(-4.8337, dtype=torch.float64) tensor(9.8297, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2049, dtype=torch.float64) delta_t tensor(-0.2611, dtype=torch.float64)
2 gae_duplicate tensor(-3.5963, dtype=torch.float64) tensor(-0.2006, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:908.56982421875
value loss:526.1883544921875
entropies:91.96845245361328
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.842085838317871 seconds
19 rew tensor(0.4753, dtype=torch.float64) delta_t tensor(-0.4020, dtype=torch.float64)
19 gae_duplicate tensor(-0.7607, dtype=torch.float64) tensor(2.4554, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7356, dtype=torch.float64) delta_t tensor(0.5807, dtype=torch.float64)
18 gae_duplicate tensor(-0.1388, dtype=torch.float64) tensor(-0.4053, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6347, dtype=torch.float64) delta_t tensor(0.4451, dtype=torch.float64)
17 gae_duplicate tensor(-0.2129, dtype=torch.float64) tensor(-1.8040, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6111, dtype=torch.float64) delta_t tensor(0.2286, dtype=torch.float64)
16 gae_duplicate tensor(-0.0286, dtype=torch.float64) tensor(-3.4830, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5326, dtype=torch.float64) delta_t tensor(0.7822, dtype=torch.float64)
15 gae_duplicate tensor(0.1946, dtype=torch.float64) tensor(-2.6723, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2330, dtype=torch.float64) delta_t tensor(0.1081, dtype=torch.float64)
14 gae_duplicate tensor(-0.5267, dtype=torch.float64) tensor(-5.2336, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5034, dtype=torch.float64) delta_t tensor(0.2718, dtype=torch.float64)
13 gae_duplicate tensor(-0.0482, dtype=torch.float64) tensor(-6.5735, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6821, dtype=torch.float64) delta_t tensor(0.5236, dtype=torch.float64)
12 gae_duplicate tensor(0.7474, dtype=torch.float64) tensor(-2.2668, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4256, dtype=torch.float64) delta_t tensor(0.3024, dtype=torch.float64)
11 gae_duplicate tensor(-0.3667, dtype=torch.float64) tensor(-8.3401, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1672, dtype=torch.float64) delta_t tensor(-0.5593, dtype=torch.float64)
10 gae_duplicate tensor(-1.8165, dtype=torch.float64) tensor(-4.5975, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8981, dtype=torch.float64) delta_t tensor(-1.0262, dtype=torch.float64)
9 gae_duplicate tensor(-6.8975, dtype=torch.float64) tensor(2.8541, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2670, dtype=torch.float64) delta_t tensor(0.1079, dtype=torch.float64)
8 gae_duplicate tensor(-5.0575, dtype=torch.float64) tensor(0.7560, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0809, dtype=torch.float64) delta_t tensor(-0.0850, dtype=torch.float64)
7 gae_duplicate tensor(-3.7921, dtype=torch.float64) tensor(0.4840, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5571, dtype=torch.float64) delta_t tensor(-0.0810, dtype=torch.float64)
6 gae_duplicate tensor(-2.9056, dtype=torch.float64) tensor(0.4969, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3630, dtype=torch.float64) delta_t tensor(-0.1672, dtype=torch.float64)
5 gae_duplicate tensor(-2.0487, dtype=torch.float64) tensor(0.7438, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4903, dtype=torch.float64) delta_t tensor(0.1174, dtype=torch.float64)
4 gae_duplicate tensor(-4.5776, dtype=torch.float64) tensor(-0.2606, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1051, dtype=torch.float64) delta_t tensor(0.3110, dtype=torch.float64)
3 gae_duplicate tensor(-2.9917, dtype=torch.float64) tensor(-2.0525, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2190, dtype=torch.float64) delta_t tensor(-0.1932, dtype=torch.float64)
2 gae_duplicate tensor(-2.3303, dtype=torch.float64) tensor(0.1260, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1055.2283935546875
value loss:417.4547119140625
entropies:92.15802001953125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.613775968551636 seconds
19 rew tensor(0.6806, dtype=torch.float64) delta_t tensor(-0.7368, dtype=torch.float64)
19 gae_duplicate tensor(-1.1814, dtype=torch.float64) tensor(1.1622, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6972, dtype=torch.float64) delta_t tensor(0.5531, dtype=torch.float64)
18 gae_duplicate tensor(-0.5927, dtype=torch.float64) tensor(-0.1156, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6349, dtype=torch.float64) delta_t tensor(0.3080, dtype=torch.float64)
17 gae_duplicate tensor(-0.1823, dtype=torch.float64) tensor(0.8691, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5569, dtype=torch.float64) delta_t tensor(0.3147, dtype=torch.float64)
16 gae_duplicate tensor(-0.1145, dtype=torch.float64) tensor(-0.8251, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3774, dtype=torch.float64) delta_t tensor(0.3349, dtype=torch.float64)
15 gae_duplicate tensor(-0.3631, dtype=torch.float64) tensor(-2.5071, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6186, dtype=torch.float64) delta_t tensor(0.5128, dtype=torch.float64)
14 gae_duplicate tensor(0.2390, dtype=torch.float64) tensor(-3.8666, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5501, dtype=torch.float64) delta_t tensor(0.4393, dtype=torch.float64)
13 gae_duplicate tensor(0.3265, dtype=torch.float64) tensor(-11.3560, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3277, dtype=torch.float64) delta_t tensor(-0.4348, dtype=torch.float64)
12 gae_duplicate tensor(-0.7682, dtype=torch.float64) tensor(-11.6985, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1184, dtype=torch.float64) delta_t tensor(0.0340, dtype=torch.float64)
11 gae_duplicate tensor(-1.9167, dtype=torch.float64) tensor(-1.5552, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1685, dtype=torch.float64) delta_t tensor(-0.7185, dtype=torch.float64)
10 gae_duplicate tensor(-4.4351, dtype=torch.float64) tensor(-5.5260, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4638, dtype=torch.float64) delta_t tensor(-0.8571, dtype=torch.float64)
9 gae_duplicate tensor(-3.1183, dtype=torch.float64) tensor(1.7781, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5874, dtype=torch.float64) delta_t tensor(-0.3880, dtype=torch.float64)
8 gae_duplicate tensor(-2.6979, dtype=torch.float64) tensor(12.0752, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2979, dtype=torch.float64) delta_t tensor(-0.3735, dtype=torch.float64)
7 gae_duplicate tensor(-3.5304, dtype=torch.float64) tensor(2.7917, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6708, dtype=torch.float64) delta_t tensor(-0.5730, dtype=torch.float64)
6 gae_duplicate tensor(-4.1739, dtype=torch.float64) tensor(4.1866, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5504, dtype=torch.float64) delta_t tensor(-0.0128, dtype=torch.float64)
5 gae_duplicate tensor(-5.0606, dtype=torch.float64) tensor(12.9428, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0398, dtype=torch.float64) delta_t tensor(0.3519, dtype=torch.float64)
4 gae_duplicate tensor(-4.3747, dtype=torch.float64) tensor(0.5327, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0381, dtype=torch.float64) delta_t tensor(0.5020, dtype=torch.float64)
3 gae_duplicate tensor(-2.7516, dtype=torch.float64) tensor(0.2352, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3375, dtype=torch.float64) delta_t tensor(-0.2984, dtype=torch.float64)
2 gae_duplicate tensor(-1.9045, dtype=torch.float64) tensor(6.6835, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-225.6023406982422
value loss:407.4361877441406
entropies:91.9781265258789
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1605.2583)
ToM Target loss= tensor(1822.2937)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.862355947494507 seconds
19 rew tensor(0.7276, dtype=torch.float64) delta_t tensor(-0.7571, dtype=torch.float64)
19 gae_duplicate tensor(-0.9326, dtype=torch.float64) tensor(2.8968, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7197, dtype=torch.float64) delta_t tensor(0.6294, dtype=torch.float64)
18 gae_duplicate tensor(-0.2413, dtype=torch.float64) tensor(0.6291, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6880, dtype=torch.float64) delta_t tensor(0.3129, dtype=torch.float64)
17 gae_duplicate tensor(-0.1666, dtype=torch.float64) tensor(-6.0813, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6244, dtype=torch.float64) delta_t tensor(0.4207, dtype=torch.float64)
16 gae_duplicate tensor(-0.7970, dtype=torch.float64) tensor(-2.6190, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4357, dtype=torch.float64) delta_t tensor(0.4282, dtype=torch.float64)
15 gae_duplicate tensor(-1.5025, dtype=torch.float64) tensor(-7.6786, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6973, dtype=torch.float64) delta_t tensor(0.7365, dtype=torch.float64)
14 gae_duplicate tensor(0.5637, dtype=torch.float64) tensor(-2.3695, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6972, dtype=torch.float64) delta_t tensor(0.5597, dtype=torch.float64)
13 gae_duplicate tensor(0.3582, dtype=torch.float64) tensor(-8.9610, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1585, dtype=torch.float64) delta_t tensor(-0.1421, dtype=torch.float64)
12 gae_duplicate tensor(-0.9971, dtype=torch.float64) tensor(-5.8383, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6119, dtype=torch.float64) delta_t tensor(0.4450, dtype=torch.float64)
11 gae_duplicate tensor(-0.4009, dtype=torch.float64) tensor(-6.2082, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-2.5948, dtype=torch.float64) delta_t tensor(-3.1548, dtype=torch.float64)
10 gae_duplicate tensor(-5.3105, dtype=torch.float64) tensor(5.7427, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2983, dtype=torch.float64) delta_t tensor(-0.1851, dtype=torch.float64)
9 gae_duplicate tensor(-4.2957, dtype=torch.float64) tensor(13.5393, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2831, dtype=torch.float64) delta_t tensor(0.0691, dtype=torch.float64)
8 gae_duplicate tensor(-3.6799, dtype=torch.float64) tensor(8.7289, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1425, dtype=torch.float64) delta_t tensor(0.2268, dtype=torch.float64)
7 gae_duplicate tensor(-2.4925, dtype=torch.float64) tensor(8.2217, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2101, dtype=torch.float64) delta_t tensor(0.3403, dtype=torch.float64)
6 gae_duplicate tensor(-1.5182, dtype=torch.float64) tensor(-0.6189, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7313, dtype=torch.float64) delta_t tensor(-0.4146, dtype=torch.float64)
5 gae_duplicate tensor(-1.6548, dtype=torch.float64) tensor(9.6009, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0594, dtype=torch.float64) delta_t tensor(0.7407, dtype=torch.float64)
4 gae_duplicate tensor(-1.8511, dtype=torch.float64) tensor(-0.3912, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4140, dtype=torch.float64) delta_t tensor(0.2006, dtype=torch.float64)
3 gae_duplicate tensor(-0.1267, dtype=torch.float64) tensor(-0.1736, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1271, dtype=torch.float64) delta_t tensor(-0.3816, dtype=torch.float64)
2 gae_duplicate tensor(-0.7407, dtype=torch.float64) tensor(0.1389, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-324.7036437988281
value loss:373.11285400390625
entropies:92.14395904541016
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.7044079303741455 seconds
19 rew tensor(0.7350, dtype=torch.float64) delta_t tensor(-0.8584, dtype=torch.float64)
19 gae_duplicate tensor(-1.2274, dtype=torch.float64) tensor(3.6939, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7114, dtype=torch.float64) delta_t tensor(0.3884, dtype=torch.float64)
18 gae_duplicate tensor(-0.7138, dtype=torch.float64) tensor(0.4685, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6799, dtype=torch.float64) delta_t tensor(0.3134, dtype=torch.float64)
17 gae_duplicate tensor(-0.2547, dtype=torch.float64) tensor(-0.1158, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6091, dtype=torch.float64) delta_t tensor(0.4079, dtype=torch.float64)
16 gae_duplicate tensor(-0.0965, dtype=torch.float64) tensor(-1.5020, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4908, dtype=torch.float64) delta_t tensor(0.3666, dtype=torch.float64)
15 gae_duplicate tensor(0.3088, dtype=torch.float64) tensor(-6.2638, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6318, dtype=torch.float64) delta_t tensor(0.6002, dtype=torch.float64)
14 gae_duplicate tensor(0.2145, dtype=torch.float64) tensor(-11.5074, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1066, dtype=torch.float64) delta_t tensor(-0.0536, dtype=torch.float64)
13 gae_duplicate tensor(-3.1727, dtype=torch.float64) tensor(-4.6437, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7279, dtype=torch.float64) delta_t tensor(0.7818, dtype=torch.float64)
12 gae_duplicate tensor(-2.0618, dtype=torch.float64) tensor(-3.3307, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2734, dtype=torch.float64) delta_t tensor(-0.0573, dtype=torch.float64)
11 gae_duplicate tensor(-1.1517, dtype=torch.float64) tensor(-6.6841, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.8731, dtype=torch.float64) delta_t tensor(-2.2255, dtype=torch.float64)
10 gae_duplicate tensor(-4.5140, dtype=torch.float64) tensor(16.0484, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3621, dtype=torch.float64) delta_t tensor(-1.6418, dtype=torch.float64)
9 gae_duplicate tensor(-4.9760, dtype=torch.float64) tensor(18.8175, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3214, dtype=torch.float64) delta_t tensor(0.0545, dtype=torch.float64)
8 gae_duplicate tensor(-3.6091, dtype=torch.float64) tensor(4.1256, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0302, dtype=torch.float64) delta_t tensor(0.4156, dtype=torch.float64)
7 gae_duplicate tensor(-2.4764, dtype=torch.float64) tensor(1.9376, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2489, dtype=torch.float64) delta_t tensor(0.3021, dtype=torch.float64)
6 gae_duplicate tensor(-2.4336, dtype=torch.float64) tensor(8.9211, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7494, dtype=torch.float64) delta_t tensor(-0.1653, dtype=torch.float64)
5 gae_duplicate tensor(-2.5579, dtype=torch.float64) tensor(12.8523, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4825, dtype=torch.float64) delta_t tensor(0.8194, dtype=torch.float64)
4 gae_duplicate tensor(-1.0668, dtype=torch.float64) tensor(-2.5103, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4695, dtype=torch.float64) delta_t tensor(0.1308, dtype=torch.float64)
3 gae_duplicate tensor(-0.6600, dtype=torch.float64) tensor(-0.4759, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0961, dtype=torch.float64) delta_t tensor(-0.2394, dtype=torch.float64)
2 gae_duplicate tensor(-0.9263, dtype=torch.float64) tensor(-1.9370, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1020.741943359375
value loss:410.2460632324219
entropies:91.9462661743164
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.646254777908325 seconds
19 rew tensor(0.6727, dtype=torch.float64) delta_t tensor(-0.9164, dtype=torch.float64)
19 gae_duplicate tensor(-1.2386, dtype=torch.float64) tensor(7.3152, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6572, dtype=torch.float64) delta_t tensor(0.3112, dtype=torch.float64)
18 gae_duplicate tensor(-0.6698, dtype=torch.float64) tensor(0.6644, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5789, dtype=torch.float64) delta_t tensor(0.3022, dtype=torch.float64)
17 gae_duplicate tensor(-0.3000, dtype=torch.float64) tensor(0.0605, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3989, dtype=torch.float64) delta_t tensor(0.1711, dtype=torch.float64)
16 gae_duplicate tensor(-0.8697, dtype=torch.float64) tensor(1.8462, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0932, dtype=torch.float64) delta_t tensor(0.0566, dtype=torch.float64)
15 gae_duplicate tensor(-0.9744, dtype=torch.float64) tensor(-0.2804, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6079, dtype=torch.float64) delta_t tensor(0.5355, dtype=torch.float64)
14 gae_duplicate tensor(-0.3083, dtype=torch.float64) tensor(-5.9333, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7278, dtype=torch.float64) delta_t tensor(0.4572, dtype=torch.float64)
13 gae_duplicate tensor(0.2247, dtype=torch.float64) tensor(-10.6197, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7437, dtype=torch.float64) delta_t tensor(0.5539, dtype=torch.float64)
12 gae_duplicate tensor(0.6512, dtype=torch.float64) tensor(-2.0212, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4007, dtype=torch.float64) delta_t tensor(0.3387, dtype=torch.float64)
11 gae_duplicate tensor(-0.8756, dtype=torch.float64) tensor(-7.1246, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0017, dtype=torch.float64) delta_t tensor(-0.3380, dtype=torch.float64)
10 gae_duplicate tensor(-1.9225, dtype=torch.float64) tensor(-4.0752, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0313, dtype=torch.float64) delta_t tensor(-0.3809, dtype=torch.float64)
9 gae_duplicate tensor(-2.3655, dtype=torch.float64) tensor(-1.7763, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2084, dtype=torch.float64) delta_t tensor(-0.3613, dtype=torch.float64)
8 gae_duplicate tensor(-1.9554, dtype=torch.float64) tensor(-5.2148, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2845, dtype=torch.float64) delta_t tensor(-0.4572, dtype=torch.float64)
7 gae_duplicate tensor(-2.4285, dtype=torch.float64) tensor(0.9331, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5815, dtype=torch.float64) delta_t tensor(-0.2139, dtype=torch.float64)
6 gae_duplicate tensor(-2.9733, dtype=torch.float64) tensor(1.0520, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1492, dtype=torch.float64) delta_t tensor(-0.7276, dtype=torch.float64)
5 gae_duplicate tensor(-3.1337, dtype=torch.float64) tensor(17.5919, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0040, dtype=torch.float64) delta_t tensor(0.4708, dtype=torch.float64)
4 gae_duplicate tensor(-2.5797, dtype=torch.float64) tensor(2.7528, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1352, dtype=torch.float64) delta_t tensor(0.3246, dtype=torch.float64)
3 gae_duplicate tensor(-1.6421, dtype=torch.float64) tensor(-1.5725, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3547, dtype=torch.float64) delta_t tensor(-0.3797, dtype=torch.float64)
2 gae_duplicate tensor(-1.0468, dtype=torch.float64) tensor(2.6813, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:117.50755310058594
value loss:256.08538818359375
entropies:91.27446746826172
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.68553614616394 seconds
19 rew tensor(0.6564, dtype=torch.float64) delta_t tensor(-0.8339, dtype=torch.float64)
19 gae_duplicate tensor(-1.1826, dtype=torch.float64) tensor(8.3131, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6012, dtype=torch.float64) delta_t tensor(0.3286, dtype=torch.float64)
18 gae_duplicate tensor(-0.7600, dtype=torch.float64) tensor(0.8226, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6086, dtype=torch.float64) delta_t tensor(0.2476, dtype=torch.float64)
17 gae_duplicate tensor(-0.5680, dtype=torch.float64) tensor(0.6264, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4497, dtype=torch.float64) delta_t tensor(0.1902, dtype=torch.float64)
16 gae_duplicate tensor(-0.7861, dtype=torch.float64) tensor(-0.7660, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2035, dtype=torch.float64) delta_t tensor(0.4111, dtype=torch.float64)
15 gae_duplicate tensor(-0.9723, dtype=torch.float64) tensor(-0.8531, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6650, dtype=torch.float64) delta_t tensor(0.2644, dtype=torch.float64)
14 gae_duplicate tensor(-0.2854, dtype=torch.float64) tensor(0.6320, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6572, dtype=torch.float64) delta_t tensor(0.4264, dtype=torch.float64)
13 gae_duplicate tensor(-0.2611, dtype=torch.float64) tensor(-2.9052, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6414, dtype=torch.float64) delta_t tensor(0.4190, dtype=torch.float64)
12 gae_duplicate tensor(-0.2149, dtype=torch.float64) tensor(-1.3780, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7213, dtype=torch.float64) delta_t tensor(-0.9558, dtype=torch.float64)
11 gae_duplicate tensor(-4.6731, dtype=torch.float64) tensor(-0.0164, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4920, dtype=torch.float64) delta_t tensor(-0.9230, dtype=torch.float64)
10 gae_duplicate tensor(-5.6999, dtype=torch.float64) tensor(-5.3828, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2775, dtype=torch.float64) delta_t tensor(-0.3916, dtype=torch.float64)
9 gae_duplicate tensor(-4.5082, dtype=torch.float64) tensor(1.7181, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1361, dtype=torch.float64) delta_t tensor(-0.4240, dtype=torch.float64)
8 gae_duplicate tensor(-3.8495, dtype=torch.float64) tensor(4.0004, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2640, dtype=torch.float64) delta_t tensor(-0.3571, dtype=torch.float64)
7 gae_duplicate tensor(-4.0636, dtype=torch.float64) tensor(6.5728, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2390, dtype=torch.float64) delta_t tensor(0.1418, dtype=torch.float64)
6 gae_duplicate tensor(-3.0145, dtype=torch.float64) tensor(3.1428, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2977, dtype=torch.float64) delta_t tensor(0.0865, dtype=torch.float64)
5 gae_duplicate tensor(-2.1921, dtype=torch.float64) tensor(11.0847, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2342, dtype=torch.float64) delta_t tensor(0.2541, dtype=torch.float64)
4 gae_duplicate tensor(-1.0310, dtype=torch.float64) tensor(3.0390, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4326, dtype=torch.float64) delta_t tensor(-0.3040, dtype=torch.float64)
3 gae_duplicate tensor(-2.0668, dtype=torch.float64) tensor(6.2476, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2513, dtype=torch.float64) delta_t tensor(-0.6645, dtype=torch.float64)
2 gae_duplicate tensor(-3.5944, dtype=torch.float64) tensor(1.6630, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1332.7493896484375
value loss:402.3425598144531
entropies:92.0098876953125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.588374614715576 seconds
19 rew tensor(0.7030, dtype=torch.float64) delta_t tensor(-0.8145, dtype=torch.float64)
19 gae_duplicate tensor(-1.6231, dtype=torch.float64) tensor(4.5738, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6554, dtype=torch.float64) delta_t tensor(0.3481, dtype=torch.float64)
18 gae_duplicate tensor(-1.4660, dtype=torch.float64) tensor(2.5762, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5603, dtype=torch.float64) delta_t tensor(0.5162, dtype=torch.float64)
17 gae_duplicate tensor(-1.2806, dtype=torch.float64) tensor(-6.4556, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4248, dtype=torch.float64) delta_t tensor(0.1496, dtype=torch.float64)
16 gae_duplicate tensor(-1.9637, dtype=torch.float64) tensor(-2.2466, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7432, dtype=torch.float64) delta_t tensor(0.5082, dtype=torch.float64)
15 gae_duplicate tensor(-1.0227, dtype=torch.float64) tensor(-1.2269, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7433, dtype=torch.float64) delta_t tensor(0.7326, dtype=torch.float64)
14 gae_duplicate tensor(0.6935, dtype=torch.float64) tensor(-11.2840, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7275, dtype=torch.float64) delta_t tensor(0.3298, dtype=torch.float64)
13 gae_duplicate tensor(0.7909, dtype=torch.float64) tensor(-4.1697, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7357, dtype=torch.float64) delta_t tensor(0.5428, dtype=torch.float64)
12 gae_duplicate tensor(1.2920, dtype=torch.float64) tensor(-6.3711, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7436, dtype=torch.float64) delta_t tensor(0.6082, dtype=torch.float64)
11 gae_duplicate tensor(0.5818, dtype=torch.float64) tensor(-12.4092, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6436, dtype=torch.float64) delta_t tensor(0.3421, dtype=torch.float64)
10 gae_duplicate tensor(1.1938, dtype=torch.float64) tensor(-25.9873, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5132, dtype=torch.float64) delta_t tensor(-1.6796, dtype=torch.float64)
9 gae_duplicate tensor(-6.1939, dtype=torch.float64) tensor(15.0888, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1090, dtype=torch.float64) delta_t tensor(-1.2164, dtype=torch.float64)
8 gae_duplicate tensor(-6.0820, dtype=torch.float64) tensor(-0.7368, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7965, dtype=torch.float64) delta_t tensor(-0.9335, dtype=torch.float64)
7 gae_duplicate tensor(-4.7531, dtype=torch.float64) tensor(13.9297, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3004, dtype=torch.float64) delta_t tensor(-1.0762, dtype=torch.float64)
6 gae_duplicate tensor(-4.3660, dtype=torch.float64) tensor(12.1042, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2294, dtype=torch.float64) delta_t tensor(-0.4433, dtype=torch.float64)
5 gae_duplicate tensor(-4.4030, dtype=torch.float64) tensor(17.6200, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5610, dtype=torch.float64) delta_t tensor(-2.0696, dtype=torch.float64)
4 gae_duplicate tensor(-7.9413, dtype=torch.float64) tensor(5.3784, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0715, dtype=torch.float64) delta_t tensor(0.1092, dtype=torch.float64)
3 gae_duplicate tensor(-5.8187, dtype=torch.float64) tensor(13.0765, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2136, dtype=torch.float64) delta_t tensor(0.0794, dtype=torch.float64)
2 gae_duplicate tensor(-4.6847, dtype=torch.float64) tensor(3.2756, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-618.818359375
value loss:1017.8389892578125
entropies:90.70298767089844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1649.5819)
ToM Target loss= tensor(1824.7876)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.798058032989502 seconds
19 rew tensor(0.7429, dtype=torch.float64) delta_t tensor(-0.4084, dtype=torch.float64)
19 gae_duplicate tensor(-0.8989, dtype=torch.float64) tensor(3.5956, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7350, dtype=torch.float64) delta_t tensor(0.4639, dtype=torch.float64)
18 gae_duplicate tensor(-0.3159, dtype=torch.float64) tensor(-3.6703, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7352, dtype=torch.float64) delta_t tensor(0.5536, dtype=torch.float64)
17 gae_duplicate tensor(0.1349, dtype=torch.float64) tensor(-6.3099, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7354, dtype=torch.float64) delta_t tensor(0.4694, dtype=torch.float64)
16 gae_duplicate tensor(0.2890, dtype=torch.float64) tensor(-3.3686, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7355, dtype=torch.float64) delta_t tensor(0.7682, dtype=torch.float64)
15 gae_duplicate tensor(0.6866, dtype=torch.float64) tensor(-11.9499, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7199, dtype=torch.float64) delta_t tensor(0.7951, dtype=torch.float64)
14 gae_duplicate tensor(1.2651, dtype=torch.float64) tensor(-3.0350, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6963, dtype=torch.float64) delta_t tensor(0.4240, dtype=torch.float64)
13 gae_duplicate tensor(1.3723, dtype=torch.float64) tensor(-7.0159, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6435, dtype=torch.float64) delta_t tensor(0.3755, dtype=torch.float64)
12 gae_duplicate tensor(1.7807, dtype=torch.float64) tensor(-3.0128, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5003, dtype=torch.float64) delta_t tensor(-0.7796, dtype=torch.float64)
11 gae_duplicate tensor(-0.9230, dtype=torch.float64) tensor(-11.3855, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4206, dtype=torch.float64) delta_t tensor(-0.9234, dtype=torch.float64)
10 gae_duplicate tensor(-4.0081, dtype=torch.float64) tensor(-3.5969, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2133, dtype=torch.float64) delta_t tensor(-0.4420, dtype=torch.float64)
9 gae_duplicate tensor(-2.7765, dtype=torch.float64) tensor(8.2030, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8910, dtype=torch.float64) delta_t tensor(-0.7853, dtype=torch.float64)
8 gae_duplicate tensor(-2.4295, dtype=torch.float64) tensor(5.6207, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1673, dtype=torch.float64) delta_t tensor(-0.2828, dtype=torch.float64)
7 gae_duplicate tensor(-2.5159, dtype=torch.float64) tensor(9.3655, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5845, dtype=torch.float64) delta_t tensor(-0.3673, dtype=torch.float64)
6 gae_duplicate tensor(-3.5434, dtype=torch.float64) tensor(10.5466, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4821, dtype=torch.float64) delta_t tensor(-0.2554, dtype=torch.float64)
5 gae_duplicate tensor(-3.4470, dtype=torch.float64) tensor(3.7657, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6880, dtype=torch.float64) delta_t tensor(-0.0229, dtype=torch.float64)
4 gae_duplicate tensor(-4.5966, dtype=torch.float64) tensor(1.7695, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0987, dtype=torch.float64) delta_t tensor(0.7049, dtype=torch.float64)
3 gae_duplicate tensor(-3.4721, dtype=torch.float64) tensor(-4.6045, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3668, dtype=torch.float64) delta_t tensor(-0.3101, dtype=torch.float64)
2 gae_duplicate tensor(-2.7464, dtype=torch.float64) tensor(9.8034, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:173.86236572265625
value loss:458.599365234375
entropies:89.95252990722656
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.6493940353393555 seconds
19 rew tensor(0.7117, dtype=torch.float64) delta_t tensor(-0.1699, dtype=torch.float64)
19 gae_duplicate tensor(-0.9324, dtype=torch.float64) tensor(3.7014, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7041, dtype=torch.float64) delta_t tensor(0.3543, dtype=torch.float64)
18 gae_duplicate tensor(-0.4504, dtype=torch.float64) tensor(-3.5192, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6504, dtype=torch.float64) delta_t tensor(0.5953, dtype=torch.float64)
17 gae_duplicate tensor(-0.2622, dtype=torch.float64) tensor(-8.7405, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7196, dtype=torch.float64) delta_t tensor(0.7708, dtype=torch.float64)
16 gae_duplicate tensor(0.2107, dtype=torch.float64) tensor(-9.3408, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5771, dtype=torch.float64) delta_t tensor(0.0277, dtype=torch.float64)
15 gae_duplicate tensor(0.5590, dtype=torch.float64) tensor(-8.4421, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4128, dtype=torch.float64) delta_t tensor(0.3338, dtype=torch.float64)
14 gae_duplicate tensor(0.5880, dtype=torch.float64) tensor(-19.1711, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2945, dtype=torch.float64) delta_t tensor(0.1525, dtype=torch.float64)
13 gae_duplicate tensor(0.5498, dtype=torch.float64) tensor(-1.6916, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4588, dtype=torch.float64) delta_t tensor(0.1805, dtype=torch.float64)
12 gae_duplicate tensor(0.7252, dtype=torch.float64) tensor(-1.6107, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4586, dtype=torch.float64) delta_t tensor(0.0265, dtype=torch.float64)
11 gae_duplicate tensor(-0.9413, dtype=torch.float64) tensor(-4.6813, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5089, dtype=torch.float64) delta_t tensor(0.3158, dtype=torch.float64)
10 gae_duplicate tensor(-0.3001, dtype=torch.float64) tensor(-4.2009, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2944, dtype=torch.float64) delta_t tensor(0.2923, dtype=torch.float64)
9 gae_duplicate tensor(0.7516, dtype=torch.float64) tensor(-3.4694, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1481, dtype=torch.float64) delta_t tensor(-0.1719, dtype=torch.float64)
8 gae_duplicate tensor(-0.0764, dtype=torch.float64) tensor(-4.1839, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5355, dtype=torch.float64) delta_t tensor(-0.4607, dtype=torch.float64)
7 gae_duplicate tensor(-1.2518, dtype=torch.float64) tensor(0.3897, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6484, dtype=torch.float64) delta_t tensor(-0.5731, dtype=torch.float64)
6 gae_duplicate tensor(-3.6218, dtype=torch.float64) tensor(11.9599, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5098, dtype=torch.float64) delta_t tensor(-0.2918, dtype=torch.float64)
5 gae_duplicate tensor(-4.5013, dtype=torch.float64) tensor(3.0161, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4699, dtype=torch.float64) delta_t tensor(-0.9691, dtype=torch.float64)
4 gae_duplicate tensor(-12.5907, dtype=torch.float64) tensor(-1.7123, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2433, dtype=torch.float64) delta_t tensor(0.1647, dtype=torch.float64)
3 gae_duplicate tensor(-9.3824, dtype=torch.float64) tensor(1.5810, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1658, dtype=torch.float64) delta_t tensor(-0.4449, dtype=torch.float64)
2 gae_duplicate tensor(-7.6282, dtype=torch.float64) tensor(19.3222, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1092.4305419921875
value loss:678.2994384765625
entropies:89.6077651977539
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.789391040802002 seconds
19 rew tensor(0.5342, dtype=torch.float64) delta_t tensor(-0.9495, dtype=torch.float64)
19 gae_duplicate tensor(-2.0046, dtype=torch.float64) tensor(3.7187, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3647, dtype=torch.float64) delta_t tensor(0.2047, dtype=torch.float64)
18 gae_duplicate tensor(-2.3886, dtype=torch.float64) tensor(7.4842, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5623, dtype=torch.float64) delta_t tensor(0.5326, dtype=torch.float64)
17 gae_duplicate tensor(-0.1675, dtype=torch.float64) tensor(-2.0225, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3353, dtype=torch.float64) delta_t tensor(-0.0680, dtype=torch.float64)
16 gae_duplicate tensor(-0.5430, dtype=torch.float64) tensor(-2.7336, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0445, dtype=torch.float64) delta_t tensor(-0.0265, dtype=torch.float64)
15 gae_duplicate tensor(-1.2946, dtype=torch.float64) tensor(0.0549, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7195, dtype=torch.float64) delta_t tensor(0.7642, dtype=torch.float64)
14 gae_duplicate tensor(0.0235, dtype=torch.float64) tensor(-4.4675, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2178, dtype=torch.float64) delta_t tensor(-0.2700, dtype=torch.float64)
13 gae_duplicate tensor(-2.6431, dtype=torch.float64) tensor(4.5261, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4403, dtype=torch.float64) delta_t tensor(-0.5804, dtype=torch.float64)
12 gae_duplicate tensor(-5.4712, dtype=torch.float64) tensor(-2.8000, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.1113, dtype=torch.float64) delta_t tensor(-1.0875, dtype=torch.float64)
11 gae_duplicate tensor(-4.9573, dtype=torch.float64) tensor(14.2494, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1684, dtype=torch.float64) delta_t tensor(-0.3046, dtype=torch.float64)
10 gae_duplicate tensor(-6.0327, dtype=torch.float64) tensor(18.9094, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0681, dtype=torch.float64) delta_t tensor(-0.1092, dtype=torch.float64)
9 gae_duplicate tensor(-4.2615, dtype=torch.float64) tensor(8.3265, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1797, dtype=torch.float64) delta_t tensor(-0.2879, dtype=torch.float64)
8 gae_duplicate tensor(-3.2198, dtype=torch.float64) tensor(1.6231, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2003, dtype=torch.float64) delta_t tensor(-0.1425, dtype=torch.float64)
7 gae_duplicate tensor(-2.6962, dtype=torch.float64) tensor(1.7382, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0412, dtype=torch.float64) delta_t tensor(-0.1882, dtype=torch.float64)
6 gae_duplicate tensor(-2.4582, dtype=torch.float64) tensor(4.4711, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6940, dtype=torch.float64) delta_t tensor(-0.0996, dtype=torch.float64)
5 gae_duplicate tensor(-3.1304, dtype=torch.float64) tensor(1.5232, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1814, dtype=torch.float64) delta_t tensor(0.7666, dtype=torch.float64)
4 gae_duplicate tensor(-2.0393, dtype=torch.float64) tensor(-0.4447, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2605, dtype=torch.float64) delta_t tensor(0.0684, dtype=torch.float64)
3 gae_duplicate tensor(-2.1797, dtype=torch.float64) tensor(5.1302, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1663, dtype=torch.float64) delta_t tensor(-0.3505, dtype=torch.float64)
2 gae_duplicate tensor(-1.2273, dtype=torch.float64) tensor(0.4153, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2165.355712890625
value loss:489.7247009277344
entropies:89.35578918457031
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.699779987335205 seconds
19 rew tensor(0.6641, dtype=torch.float64) delta_t tensor(-0.7488, dtype=torch.float64)
19 gae_duplicate tensor(-1.2247, dtype=torch.float64) tensor(2.9449, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5704, dtype=torch.float64) delta_t tensor(0.1757, dtype=torch.float64)
18 gae_duplicate tensor(-1.7215, dtype=torch.float64) tensor(1.1003, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4295, dtype=torch.float64) delta_t tensor(0.1962, dtype=torch.float64)
17 gae_duplicate tensor(-2.3911, dtype=torch.float64) tensor(0.2086, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7039, dtype=torch.float64) delta_t tensor(0.3562, dtype=torch.float64)
16 gae_duplicate tensor(-1.4539, dtype=torch.float64) tensor(1.6614, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6884, dtype=torch.float64) delta_t tensor(0.3852, dtype=torch.float64)
15 gae_duplicate tensor(-0.6785, dtype=torch.float64) tensor(-0.8614, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6344, dtype=torch.float64) delta_t tensor(0.3773, dtype=torch.float64)
14 gae_duplicate tensor(-0.0581, dtype=torch.float64) tensor(-3.1332, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7276, dtype=torch.float64) delta_t tensor(0.4331, dtype=torch.float64)
13 gae_duplicate tensor(0.4752, dtype=torch.float64) tensor(-1.6475, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7122, dtype=torch.float64) delta_t tensor(0.2723, dtype=torch.float64)
12 gae_duplicate tensor(0.1430, dtype=torch.float64) tensor(-2.0819, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5330, dtype=torch.float64) delta_t tensor(0.4993, dtype=torch.float64)
11 gae_duplicate tensor(0.0991, dtype=torch.float64) tensor(-3.2166, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3208, dtype=torch.float64) delta_t tensor(-0.6779, dtype=torch.float64)
10 gae_duplicate tensor(-5.1984, dtype=torch.float64) tensor(-8.7698, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4308, dtype=torch.float64) delta_t tensor(-0.5850, dtype=torch.float64)
9 gae_duplicate tensor(-4.4818, dtype=torch.float64) tensor(11.0389, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1424, dtype=torch.float64) delta_t tensor(-0.3326, dtype=torch.float64)
8 gae_duplicate tensor(-3.5720, dtype=torch.float64) tensor(11.8105, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5118, dtype=torch.float64) delta_t tensor(-0.5936, dtype=torch.float64)
7 gae_duplicate tensor(-3.0963, dtype=torch.float64) tensor(1.5493, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3124, dtype=torch.float64) delta_t tensor(-0.5201, dtype=torch.float64)
6 gae_duplicate tensor(-3.7542, dtype=torch.float64) tensor(12.0902, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3102, dtype=torch.float64) delta_t tensor(-0.5438, dtype=torch.float64)
5 gae_duplicate tensor(-3.3867, dtype=torch.float64) tensor(16.8151, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4535, dtype=torch.float64) delta_t tensor(-1.0984, dtype=torch.float64)
4 gae_duplicate tensor(-9.5820, dtype=torch.float64) tensor(43.0705, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3138, dtype=torch.float64) delta_t tensor(0.3518, dtype=torch.float64)
3 gae_duplicate tensor(-7.6587, dtype=torch.float64) tensor(12.9675, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1896, dtype=torch.float64) delta_t tensor(-0.2152, dtype=torch.float64)
2 gae_duplicate tensor(-5.1819, dtype=torch.float64) tensor(14.4792, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3977.1474609375
value loss:727.8510131835938
entropies:90.01895141601562
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.967885971069336 seconds
19 rew tensor(0.7264, dtype=torch.float64) delta_t tensor(-0.7859, dtype=torch.float64)
19 gae_duplicate tensor(-1.2404, dtype=torch.float64) tensor(6.1286, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7265, dtype=torch.float64) delta_t tensor(0.3012, dtype=torch.float64)
18 gae_duplicate tensor(-0.6453, dtype=torch.float64) tensor(1.6066, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6868, dtype=torch.float64) delta_t tensor(0.3179, dtype=torch.float64)
17 gae_duplicate tensor(-0.2292, dtype=torch.float64) tensor(-1.9390, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6548, dtype=torch.float64) delta_t tensor(0.3822, dtype=torch.float64)
16 gae_duplicate tensor(0.2121, dtype=torch.float64) tensor(-2.8008, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5910, dtype=torch.float64) delta_t tensor(0.5522, dtype=torch.float64)
15 gae_duplicate tensor(-0.1828, dtype=torch.float64) tensor(-2.6470, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6630, dtype=torch.float64) delta_t tensor(0.3426, dtype=torch.float64)
14 gae_duplicate tensor(0.1880, dtype=torch.float64) tensor(-6.3034, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0603, dtype=torch.float64) delta_t tensor(-0.0063, dtype=torch.float64)
13 gae_duplicate tensor(-2.2599, dtype=torch.float64) tensor(-3.5549, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6232, dtype=torch.float64) delta_t tensor(0.4392, dtype=torch.float64)
12 gae_duplicate tensor(-1.3439, dtype=torch.float64) tensor(-8.1100, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5800, dtype=torch.float64) delta_t tensor(-0.8629, dtype=torch.float64)
11 gae_duplicate tensor(-2.1636, dtype=torch.float64) tensor(10.3785, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2871, dtype=torch.float64) delta_t tensor(-0.6424, dtype=torch.float64)
10 gae_duplicate tensor(-4.9074, dtype=torch.float64) tensor(12.9281, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8140, dtype=torch.float64) delta_t tensor(-0.9466, dtype=torch.float64)
9 gae_duplicate tensor(-4.7997, dtype=torch.float64) tensor(15.7123, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3920, dtype=torch.float64) delta_t tensor(-0.4601, dtype=torch.float64)
8 gae_duplicate tensor(-3.7220, dtype=torch.float64) tensor(2.5216, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1416, dtype=torch.float64) delta_t tensor(-0.2074, dtype=torch.float64)
7 gae_duplicate tensor(-3.3050, dtype=torch.float64) tensor(10.1705, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1602, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
6 gae_duplicate tensor(-3.5625, dtype=torch.float64) tensor(1.7425, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5787, dtype=torch.float64) delta_t tensor(-0.0060, dtype=torch.float64)
5 gae_duplicate tensor(-3.1225, dtype=torch.float64) tensor(17.6476, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3625, dtype=torch.float64) delta_t tensor(0.7145, dtype=torch.float64)
4 gae_duplicate tensor(-2.1328, dtype=torch.float64) tensor(-0.0221, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4963, dtype=torch.float64) delta_t tensor(-0.2579, dtype=torch.float64)
3 gae_duplicate tensor(-3.1739, dtype=torch.float64) tensor(-4.4197, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1674, dtype=torch.float64) delta_t tensor(-0.4438, dtype=torch.float64)
2 gae_duplicate tensor(-3.5493, dtype=torch.float64) tensor(1.0365, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1818.9141845703125
value loss:410.8858642578125
entropies:89.88733673095703
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1527.1667)
ToM Target loss= tensor(1822.1921)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.70665431022644 seconds
19 rew tensor(0.6194, dtype=torch.float64) delta_t tensor(-0.8228, dtype=torch.float64)
19 gae_duplicate tensor(-1.5763, dtype=torch.float64) tensor(3.0623, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6797, dtype=torch.float64) delta_t tensor(0.3473, dtype=torch.float64)
18 gae_duplicate tensor(-1.0246, dtype=torch.float64) tensor(2.2763, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6329, dtype=torch.float64) delta_t tensor(0.3827, dtype=torch.float64)
17 gae_duplicate tensor(-0.4772, dtype=torch.float64) tensor(-0.1889, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5066, dtype=torch.float64) delta_t tensor(0.4296, dtype=torch.float64)
16 gae_duplicate tensor(-0.3279, dtype=torch.float64) tensor(-0.5264, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3259, dtype=torch.float64) delta_t tensor(0.2104, dtype=torch.float64)
15 gae_duplicate tensor(-0.6949, dtype=torch.float64) tensor(-6.0342, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5497, dtype=torch.float64) delta_t tensor(0.7648, dtype=torch.float64)
14 gae_duplicate tensor(0.6769, dtype=torch.float64) tensor(-6.4020, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4335, dtype=torch.float64) delta_t tensor(0.2188, dtype=torch.float64)
13 gae_duplicate tensor(0.2078, dtype=torch.float64) tensor(-8.8062, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.6525, dtype=torch.float64) delta_t tensor(-0.8478, dtype=torch.float64)
12 gae_duplicate tensor(-3.8260, dtype=torch.float64) tensor(-0.2384, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2461, dtype=torch.float64) delta_t tensor(0.1048, dtype=torch.float64)
11 gae_duplicate tensor(-2.5038, dtype=torch.float64) tensor(-0.3587, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4883, dtype=torch.float64) delta_t tensor(-1.0881, dtype=torch.float64)
10 gae_duplicate tensor(-2.2987, dtype=torch.float64) tensor(-1.0068, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4687, dtype=torch.float64) delta_t tensor(-0.4874, dtype=torch.float64)
9 gae_duplicate tensor(-3.6555, dtype=torch.float64) tensor(11.2878, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1774, dtype=torch.float64) delta_t tensor(-0.5271, dtype=torch.float64)
8 gae_duplicate tensor(-4.6428, dtype=torch.float64) tensor(4.5101, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4445, dtype=torch.float64) delta_t tensor(0.1261, dtype=torch.float64)
7 gae_duplicate tensor(-3.0728, dtype=torch.float64) tensor(1.5808, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2182, dtype=torch.float64) delta_t tensor(0.2078, dtype=torch.float64)
6 gae_duplicate tensor(-3.3904, dtype=torch.float64) tensor(1.0058, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2148, dtype=torch.float64) delta_t tensor(-0.4386, dtype=torch.float64)
5 gae_duplicate tensor(-3.8567, dtype=torch.float64) tensor(16.6227, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4522, dtype=torch.float64) delta_t tensor(0.8681, dtype=torch.float64)
4 gae_duplicate tensor(-2.6989, dtype=torch.float64) tensor(6.1402, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4847, dtype=torch.float64) delta_t tensor(-0.0412, dtype=torch.float64)
3 gae_duplicate tensor(-1.3873, dtype=torch.float64) tensor(-0.4759, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1132, dtype=torch.float64) delta_t tensor(-0.2664, dtype=torch.float64)
2 gae_duplicate tensor(-0.8364, dtype=torch.float64) tensor(0.3024, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-834.7742919921875
value loss:296.5570983886719
entropies:87.46345520019531
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.456036806106567 seconds
19 rew tensor(0.7349, dtype=torch.float64) delta_t tensor(-0.7389, dtype=torch.float64)
19 gae_duplicate tensor(-1.0849, dtype=torch.float64) tensor(1.0700, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7190, dtype=torch.float64) delta_t tensor(0.4349, dtype=torch.float64)
18 gae_duplicate tensor(-0.4752, dtype=torch.float64) tensor(0.2302, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6717, dtype=torch.float64) delta_t tensor(0.3647, dtype=torch.float64)
17 gae_duplicate tensor(-0.2825, dtype=torch.float64) tensor(-0.3395, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5847, dtype=torch.float64) delta_t tensor(0.4820, dtype=torch.float64)
16 gae_duplicate tensor(-0.2474, dtype=torch.float64) tensor(-0.9653, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4814, dtype=torch.float64) delta_t tensor(0.4734, dtype=torch.float64)
15 gae_duplicate tensor(-0.8491, dtype=torch.float64) tensor(-10.4476, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6888, dtype=torch.float64) delta_t tensor(0.3011, dtype=torch.float64)
14 gae_duplicate tensor(-0.2317, dtype=torch.float64) tensor(-4.2214, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6033, dtype=torch.float64) delta_t tensor(0.4359, dtype=torch.float64)
13 gae_duplicate tensor(0.2623, dtype=torch.float64) tensor(-4.7115, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2118, dtype=torch.float64) delta_t tensor(-0.5522, dtype=torch.float64)
12 gae_duplicate tensor(-3.1659, dtype=torch.float64) tensor(-4.1107, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0442, dtype=torch.float64) delta_t tensor(-0.1887, dtype=torch.float64)
11 gae_duplicate tensor(-2.8349, dtype=torch.float64) tensor(6.7954, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0240, dtype=torch.float64) delta_t tensor(-0.2735, dtype=torch.float64)
10 gae_duplicate tensor(-1.9194, dtype=torch.float64) tensor(5.2889, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2178, dtype=torch.float64) delta_t tensor(-0.2231, dtype=torch.float64)
9 gae_duplicate tensor(-1.3539, dtype=torch.float64) tensor(3.1806, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0764, dtype=torch.float64) delta_t tensor(0.1445, dtype=torch.float64)
8 gae_duplicate tensor(-0.8545, dtype=torch.float64) tensor(3.2962, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1252, dtype=torch.float64) delta_t tensor(-0.4980, dtype=torch.float64)
7 gae_duplicate tensor(-1.5123, dtype=torch.float64) tensor(4.4967, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3088, dtype=torch.float64) delta_t tensor(-0.0048, dtype=torch.float64)
6 gae_duplicate tensor(-1.8546, dtype=torch.float64) tensor(0.6878, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1464, dtype=torch.float64) delta_t tensor(0.2254, dtype=torch.float64)
5 gae_duplicate tensor(-1.0965, dtype=torch.float64) tensor(4.0732, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1837, dtype=torch.float64) delta_t tensor(0.8831, dtype=torch.float64)
4 gae_duplicate tensor(-0.3645, dtype=torch.float64) tensor(-1.1915, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1174, dtype=torch.float64) delta_t tensor(0.1921, dtype=torch.float64)
3 gae_duplicate tensor(0.2068, dtype=torch.float64) tensor(-6.7693, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2543, dtype=torch.float64) delta_t tensor(-0.3779, dtype=torch.float64)
2 gae_duplicate tensor(-0.3665, dtype=torch.float64) tensor(-2.7072, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:212.8148956298828
value loss:236.03518676757812
entropies:86.67747497558594
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.935244083404541 seconds
19 rew tensor(0.7429, dtype=torch.float64) delta_t tensor(-0.3328, dtype=torch.float64)
19 gae_duplicate tensor(-0.9373, dtype=torch.float64) tensor(2.3709, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7430, dtype=torch.float64) delta_t tensor(0.8434, dtype=torch.float64)
18 gae_duplicate tensor(-0.1707, dtype=torch.float64) tensor(-1.2648, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7353, dtype=torch.float64) delta_t tensor(0.6710, dtype=torch.float64)
17 gae_duplicate tensor(0.3007, dtype=torch.float64) tensor(-10.7170, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6730, dtype=torch.float64) delta_t tensor(0.5229, dtype=torch.float64)
16 gae_duplicate tensor(0.6780, dtype=torch.float64) tensor(-4.2918, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6497, dtype=torch.float64) delta_t tensor(0.8111, dtype=torch.float64)
15 gae_duplicate tensor(0.9799, dtype=torch.float64) tensor(-2.8567, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6034, dtype=torch.float64) delta_t tensor(0.2948, dtype=torch.float64)
14 gae_duplicate tensor(1.3622, dtype=torch.float64) tensor(-13.7438, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0523, dtype=torch.float64) delta_t tensor(-0.1616, dtype=torch.float64)
13 gae_duplicate tensor(-2.2969, dtype=torch.float64) tensor(-0.2674, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2963, dtype=torch.float64) delta_t tensor(-0.5284, dtype=torch.float64)
12 gae_duplicate tensor(-1.9968, dtype=torch.float64) tensor(-0.6028, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5365, dtype=torch.float64) delta_t tensor(-0.8217, dtype=torch.float64)
11 gae_duplicate tensor(-1.6959, dtype=torch.float64) tensor(5.6585, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5459, dtype=torch.float64) delta_t tensor(-0.9577, dtype=torch.float64)
10 gae_duplicate tensor(-4.6801, dtype=torch.float64) tensor(1.7257, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5191, dtype=torch.float64) delta_t tensor(-0.2514, dtype=torch.float64)
9 gae_duplicate tensor(-5.7746, dtype=torch.float64) tensor(1.6864, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2000, dtype=torch.float64) delta_t tensor(-0.0104, dtype=torch.float64)
8 gae_duplicate tensor(-4.8628, dtype=torch.float64) tensor(12.5331, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1557, dtype=torch.float64) delta_t tensor(0.3123, dtype=torch.float64)
7 gae_duplicate tensor(-3.3581, dtype=torch.float64) tensor(0.6897, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3157, dtype=torch.float64) delta_t tensor(0.2437, dtype=torch.float64)
6 gae_duplicate tensor(-2.0892, dtype=torch.float64) tensor(5.6532, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7532, dtype=torch.float64) delta_t tensor(-0.2577, dtype=torch.float64)
5 gae_duplicate tensor(-2.1028, dtype=torch.float64) tensor(-0.2106, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2787, dtype=torch.float64) delta_t tensor(0.8444, dtype=torch.float64)
4 gae_duplicate tensor(-0.9686, dtype=torch.float64) tensor(-0.7579, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5966, dtype=torch.float64) delta_t tensor(-0.0777, dtype=torch.float64)
3 gae_duplicate tensor(-0.9629, dtype=torch.float64) tensor(-2.9170, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0121, dtype=torch.float64) delta_t tensor(-0.5316, dtype=torch.float64)
2 gae_duplicate tensor(-1.1298, dtype=torch.float64) tensor(0.2079, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:240.6254425048828
value loss:428.91595458984375
entropies:84.10005187988281
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.693922996520996 seconds
19 rew tensor(0.6959, dtype=torch.float64) delta_t tensor(-0.4687, dtype=torch.float64)
19 gae_duplicate tensor(-0.9498, dtype=torch.float64) tensor(4.5669, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6649, dtype=torch.float64) delta_t tensor(0.4319, dtype=torch.float64)
18 gae_duplicate tensor(-0.4047, dtype=torch.float64) tensor(-2.0074, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6022, dtype=torch.float64) delta_t tensor(0.3796, dtype=torch.float64)
17 gae_duplicate tensor(-0.0226, dtype=torch.float64) tensor(-0.5543, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4458, dtype=torch.float64) delta_t tensor(0.1228, dtype=torch.float64)
16 gae_duplicate tensor(-0.5504, dtype=torch.float64) tensor(-0.5967, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1792, dtype=torch.float64) delta_t tensor(0.0990, dtype=torch.float64)
15 gae_duplicate tensor(-1.4902, dtype=torch.float64) tensor(0.8705, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6884, dtype=torch.float64) delta_t tensor(0.3934, dtype=torch.float64)
14 gae_duplicate tensor(-0.8102, dtype=torch.float64) tensor(-10.2987, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7043, dtype=torch.float64) delta_t tensor(0.4454, dtype=torch.float64)
13 gae_duplicate tensor(-0.2660, dtype=torch.float64) tensor(-5.6008, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5053, dtype=torch.float64) delta_t tensor(0.6746, dtype=torch.float64)
12 gae_duplicate tensor(0.1694, dtype=torch.float64) tensor(-1.9978, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1765, dtype=torch.float64) delta_t tensor(0.0182, dtype=torch.float64)
11 gae_duplicate tensor(0.0876, dtype=torch.float64) tensor(-16.6032, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0703, dtype=torch.float64) delta_t tensor(-0.5457, dtype=torch.float64)
10 gae_duplicate tensor(-1.5424, dtype=torch.float64) tensor(-5.1889, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0003, dtype=torch.float64) delta_t tensor(0.0095, dtype=torch.float64)
9 gae_duplicate tensor(-1.0714, dtype=torch.float64) tensor(-0.4969, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1806, dtype=torch.float64) delta_t tensor(-0.3106, dtype=torch.float64)
8 gae_duplicate tensor(-0.6748, dtype=torch.float64) tensor(0.0194, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7155, dtype=torch.float64) delta_t tensor(-0.7003, dtype=torch.float64)
7 gae_duplicate tensor(-2.1236, dtype=torch.float64) tensor(1.0590, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7827, dtype=torch.float64) delta_t tensor(-0.3699, dtype=torch.float64)
6 gae_duplicate tensor(-3.2959, dtype=torch.float64) tensor(6.2470, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9513, dtype=torch.float64) delta_t tensor(-0.5675, dtype=torch.float64)
5 gae_duplicate tensor(-3.8908, dtype=torch.float64) tensor(4.8365, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4384, dtype=torch.float64) delta_t tensor(-0.8489, dtype=torch.float64)
4 gae_duplicate tensor(-7.3986, dtype=torch.float64) tensor(16.1603, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2751, dtype=torch.float64) delta_t tensor(0.0175, dtype=torch.float64)
3 gae_duplicate tensor(-5.1410, dtype=torch.float64) tensor(1.8057, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2920, dtype=torch.float64) delta_t tensor(-0.0244, dtype=torch.float64)
2 gae_duplicate tensor(-3.8360, dtype=torch.float64) tensor(14.1782, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-245.13522338867188
value loss:484.4306945800781
entropies:82.12629699707031
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.726884126663208 seconds
19 rew tensor(0.7044, dtype=torch.float64) delta_t tensor(-0.5887, dtype=torch.float64)
19 gae_duplicate tensor(-0.8887, dtype=torch.float64) tensor(5.3173, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6732, dtype=torch.float64) delta_t tensor(0.4220, dtype=torch.float64)
18 gae_duplicate tensor(-0.5069, dtype=torch.float64) tensor(2.1246, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6421, dtype=torch.float64) delta_t tensor(0.3518, dtype=torch.float64)
17 gae_duplicate tensor(-0.0834, dtype=torch.float64) tensor(-1.5079, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5093, dtype=torch.float64) delta_t tensor(0.1857, dtype=torch.float64)
16 gae_duplicate tensor(-0.3988, dtype=torch.float64) tensor(-0.5667, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3220, dtype=torch.float64) delta_t tensor(0.1940, dtype=torch.float64)
15 gae_duplicate tensor(-0.8761, dtype=torch.float64) tensor(-0.6905, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5678, dtype=torch.float64) delta_t tensor(0.3626, dtype=torch.float64)
14 gae_duplicate tensor(-0.1858, dtype=torch.float64) tensor(-0.9793, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4444, dtype=torch.float64) delta_t tensor(0.3647, dtype=torch.float64)
13 gae_duplicate tensor(-0.5664, dtype=torch.float64) tensor(-1.2170, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1588, dtype=torch.float64) delta_t tensor(-0.4615, dtype=torch.float64)
12 gae_duplicate tensor(-4.6022, dtype=torch.float64) tensor(-0.3606, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.1949, dtype=torch.float64) delta_t tensor(-1.4637, dtype=torch.float64)
11 gae_duplicate tensor(-5.0346, dtype=torch.float64) tensor(1.5649, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4654, dtype=torch.float64) delta_t tensor(0.2207, dtype=torch.float64)
10 gae_duplicate tensor(-3.8356, dtype=torch.float64) tensor(0.9559, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0159, dtype=torch.float64) delta_t tensor(-0.1881, dtype=torch.float64)
9 gae_duplicate tensor(-3.0170, dtype=torch.float64) tensor(0.1899, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3701, dtype=torch.float64) delta_t tensor(-0.3751, dtype=torch.float64)
8 gae_duplicate tensor(-2.5942, dtype=torch.float64) tensor(2.6132, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1227, dtype=torch.float64) delta_t tensor(-0.0044, dtype=torch.float64)
7 gae_duplicate tensor(-3.0948, dtype=torch.float64) tensor(18.0341, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4903, dtype=torch.float64) delta_t tensor(-0.5379, dtype=torch.float64)
6 gae_duplicate tensor(-5.7783, dtype=torch.float64) tensor(6.6462, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7229, dtype=torch.float64) delta_t tensor(-0.2935, dtype=torch.float64)
5 gae_duplicate tensor(-6.6271, dtype=torch.float64) tensor(21.1795, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2336, dtype=torch.float64) delta_t tensor(0.2317, dtype=torch.float64)
4 gae_duplicate tensor(-6.3737, dtype=torch.float64) tensor(0.8026, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4258, dtype=torch.float64) delta_t tensor(0.0045, dtype=torch.float64)
3 gae_duplicate tensor(-4.7571, dtype=torch.float64) tensor(13.6902, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2477, dtype=torch.float64) delta_t tensor(-0.2362, dtype=torch.float64)
2 gae_duplicate tensor(-3.3939, dtype=torch.float64) tensor(15.6156, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3017.396484375
value loss:500.1441650390625
entropies:80.88909149169922
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1313.4614)
ToM Target loss= tensor(1819.4033)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.698527097702026 seconds
19 rew tensor(0.7110, dtype=torch.float64) delta_t tensor(-0.6240, dtype=torch.float64)
19 gae_duplicate tensor(-0.7864, dtype=torch.float64) tensor(1.7317, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6951, dtype=torch.float64) delta_t tensor(0.4286, dtype=torch.float64)
18 gae_duplicate tensor(-0.3085, dtype=torch.float64) tensor(0.0901, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6556, dtype=torch.float64) delta_t tensor(0.5003, dtype=torch.float64)
17 gae_duplicate tensor(0.1669, dtype=torch.float64) tensor(-3.6738, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5455, dtype=torch.float64) delta_t tensor(0.7295, dtype=torch.float64)
16 gae_duplicate tensor(-0.2743, dtype=torch.float64) tensor(-6.0900, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4113, dtype=torch.float64) delta_t tensor(0.3905, dtype=torch.float64)
15 gae_duplicate tensor(-0.6599, dtype=torch.float64) tensor(-8.1050, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7428, dtype=torch.float64) delta_t tensor(0.9804, dtype=torch.float64)
14 gae_duplicate tensor(0.6983, dtype=torch.float64) tensor(-18.2043, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.5166, dtype=torch.float64) delta_t tensor(-0.5300, dtype=torch.float64)
13 gae_duplicate tensor(-3.7582, dtype=torch.float64) tensor(-11.0853, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1030, dtype=torch.float64) delta_t tensor(0.0702, dtype=torch.float64)
12 gae_duplicate tensor(-6.3056, dtype=torch.float64) tensor(-7.5546, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0413, dtype=torch.float64) delta_t tensor(-0.3093, dtype=torch.float64)
11 gae_duplicate tensor(-4.7498, dtype=torch.float64) tensor(-0.5673, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4452, dtype=torch.float64) delta_t tensor(0.0582, dtype=torch.float64)
10 gae_duplicate tensor(-3.6160, dtype=torch.float64) tensor(-0.4887, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3322, dtype=torch.float64) delta_t tensor(-0.3570, dtype=torch.float64)
9 gae_duplicate tensor(-2.6302, dtype=torch.float64) tensor(0.1627, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5396, dtype=torch.float64) delta_t tensor(-0.5651, dtype=torch.float64)
8 gae_duplicate tensor(-3.6137, dtype=torch.float64) tensor(0.8555, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6457, dtype=torch.float64) delta_t tensor(-0.5594, dtype=torch.float64)
7 gae_duplicate tensor(-4.6157, dtype=torch.float64) tensor(1.5372, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2898, dtype=torch.float64) delta_t tensor(-0.2692, dtype=torch.float64)
6 gae_duplicate tensor(-3.6519, dtype=torch.float64) tensor(1.3122, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9937, dtype=torch.float64) delta_t tensor(-0.2501, dtype=torch.float64)
5 gae_duplicate tensor(-3.8291, dtype=torch.float64) tensor(13.0604, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2407, dtype=torch.float64) delta_t tensor(-0.8408, dtype=torch.float64)
4 gae_duplicate tensor(-9.9574, dtype=torch.float64) tensor(1.9790, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4672, dtype=torch.float64) delta_t tensor(0.1284, dtype=torch.float64)
3 gae_duplicate tensor(-7.4676, dtype=torch.float64) tensor(-0.8416, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0261, dtype=torch.float64) delta_t tensor(-0.3109, dtype=torch.float64)
2 gae_duplicate tensor(-5.7766, dtype=torch.float64) tensor(1.4367, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1225.824951171875
value loss:890.0762329101562
entropies:78.89247131347656
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.6838061809539795 seconds
19 rew tensor(0.7105, dtype=torch.float64) delta_t tensor(-0.3467, dtype=torch.float64)
19 gae_duplicate tensor(-0.7076, dtype=torch.float64) tensor(0.4264, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6716, dtype=torch.float64) delta_t tensor(0.4764, dtype=torch.float64)
18 gae_duplicate tensor(-0.1470, dtype=torch.float64) tensor(-0.4682, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6090, dtype=torch.float64) delta_t tensor(0.3511, dtype=torch.float64)
17 gae_duplicate tensor(-0.0720, dtype=torch.float64) tensor(-0.7742, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4678, dtype=torch.float64) delta_t tensor(0.3700, dtype=torch.float64)
16 gae_duplicate tensor(-0.4337, dtype=torch.float64) tensor(-0.9492, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2405, dtype=torch.float64) delta_t tensor(0.3660, dtype=torch.float64)
15 gae_duplicate tensor(-0.2354, dtype=torch.float64) tensor(-4.0245, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7266, dtype=torch.float64) delta_t tensor(0.4590, dtype=torch.float64)
14 gae_duplicate tensor(-0.0582, dtype=torch.float64) tensor(-1.6443, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0424, dtype=torch.float64) delta_t tensor(-0.2237, dtype=torch.float64)
13 gae_duplicate tensor(-2.8076, dtype=torch.float64) tensor(-1.5410, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6957, dtype=torch.float64) delta_t tensor(0.8791, dtype=torch.float64)
12 gae_duplicate tensor(-1.5825, dtype=torch.float64) tensor(-1.7523, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3441, dtype=torch.float64) delta_t tensor(0.2565, dtype=torch.float64)
11 gae_duplicate tensor(-0.7675, dtype=torch.float64) tensor(-15.8327, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2348, dtype=torch.float64) delta_t tensor(-0.3352, dtype=torch.float64)
10 gae_duplicate tensor(-2.0806, dtype=torch.float64) tensor(-12.1320, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2956, dtype=torch.float64) delta_t tensor(-0.2235, dtype=torch.float64)
9 gae_duplicate tensor(-1.4179, dtype=torch.float64) tensor(-0.5251, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2401, dtype=torch.float64) delta_t tensor(0.1060, dtype=torch.float64)
8 gae_duplicate tensor(-1.4415, dtype=torch.float64) tensor(-0.5730, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4090, dtype=torch.float64) delta_t tensor(-0.0987, dtype=torch.float64)
7 gae_duplicate tensor(-1.0280, dtype=torch.float64) tensor(-3.4589, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0090, dtype=torch.float64) delta_t tensor(-0.2271, dtype=torch.float64)
6 gae_duplicate tensor(-0.7216, dtype=torch.float64) tensor(0.6713, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1345, dtype=torch.float64) delta_t tensor(-0.4794, dtype=torch.float64)
5 gae_duplicate tensor(-1.2172, dtype=torch.float64) tensor(2.4216, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0606, dtype=torch.float64) delta_t tensor(-0.5946, dtype=torch.float64)
4 gae_duplicate tensor(-8.1122, dtype=torch.float64) tensor(-0.0546, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5864, dtype=torch.float64) delta_t tensor(-0.0107, dtype=torch.float64)
3 gae_duplicate tensor(-6.0416, dtype=torch.float64) tensor(3.6668, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2703, dtype=torch.float64) delta_t tensor(-0.5049, dtype=torch.float64)
2 gae_duplicate tensor(-4.6804, dtype=torch.float64) tensor(12.3620, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:856.6121826171875
value loss:480.30560302734375
entropies:77.43876647949219
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.600366830825806 seconds
19 rew tensor(0.7339, dtype=torch.float64) delta_t tensor(-0.3401, dtype=torch.float64)
19 gae_duplicate tensor(-0.8750, dtype=torch.float64) tensor(-2.2117, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7340, dtype=torch.float64) delta_t tensor(0.7332, dtype=torch.float64)
18 gae_duplicate tensor(-0.3104, dtype=torch.float64) tensor(-5.9747, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7421, dtype=torch.float64) delta_t tensor(0.3309, dtype=torch.float64)
17 gae_duplicate tensor(0.5703, dtype=torch.float64) tensor(-2.5374, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7262, dtype=torch.float64) delta_t tensor(0.4891, dtype=torch.float64)
16 gae_duplicate tensor(0.4738, dtype=torch.float64) tensor(-3.8780, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7343, dtype=torch.float64) delta_t tensor(0.6920, dtype=torch.float64)
15 gae_duplicate tensor(1.3050, dtype=torch.float64) tensor(-5.8657, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7264, dtype=torch.float64) delta_t tensor(0.5821, dtype=torch.float64)
14 gae_duplicate tensor(1.5472, dtype=torch.float64) tensor(-2.0819, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6486, dtype=torch.float64) delta_t tensor(0.6590, dtype=torch.float64)
13 gae_duplicate tensor(1.4394, dtype=torch.float64) tensor(-7.7163, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6807, dtype=torch.float64) delta_t tensor(0.4470, dtype=torch.float64)
12 gae_duplicate tensor(1.2980, dtype=torch.float64) tensor(-15.5621, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.4213, dtype=torch.float64) delta_t tensor(-1.7297, dtype=torch.float64)
11 gae_duplicate tensor(-3.4421, dtype=torch.float64) tensor(9.2314, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6134, dtype=torch.float64) delta_t tensor(-0.9908, dtype=torch.float64)
10 gae_duplicate tensor(-5.2980, dtype=torch.float64) tensor(5.2773, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-7.7274e-05, dtype=torch.float64) delta_t tensor(0.0886, dtype=torch.float64)
9 gae_duplicate tensor(-4.0901, dtype=torch.float64) tensor(0.9012, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6940, dtype=torch.float64) delta_t tensor(-0.7519, dtype=torch.float64)
8 gae_duplicate tensor(-3.0161, dtype=torch.float64) tensor(1.5853, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2413, dtype=torch.float64) delta_t tensor(0.0186, dtype=torch.float64)
7 gae_duplicate tensor(-2.5012, dtype=torch.float64) tensor(25.5889, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4023, dtype=torch.float64) delta_t tensor(-0.3648, dtype=torch.float64)
6 gae_duplicate tensor(-1.6998, dtype=torch.float64) tensor(7.5567, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5173, dtype=torch.float64) delta_t tensor(0.0286, dtype=torch.float64)
5 gae_duplicate tensor(-1.2224, dtype=torch.float64) tensor(1.7731, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1970, dtype=torch.float64) delta_t tensor(0.2190, dtype=torch.float64)
4 gae_duplicate tensor(-2.9971, dtype=torch.float64) tensor(-0.4355, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1691, dtype=torch.float64) delta_t tensor(0.4955, dtype=torch.float64)
3 gae_duplicate tensor(-1.9704, dtype=torch.float64) tensor(-2.0199, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1423, dtype=torch.float64) delta_t tensor(-0.2456, dtype=torch.float64)
2 gae_duplicate tensor(-1.4464, dtype=torch.float64) tensor(-0.4618, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-127.86582946777344
value loss:429.2266845703125
entropies:76.58568572998047
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.567659854888916 seconds
19 rew tensor(0.7186, dtype=torch.float64) delta_t tensor(-0.1944, dtype=torch.float64)
19 gae_duplicate tensor(-0.6523, dtype=torch.float64) tensor(-2.9705, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6955, dtype=torch.float64) delta_t tensor(0.4710, dtype=torch.float64)
18 gae_duplicate tensor(-0.1140, dtype=torch.float64) tensor(-0.3505, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6413, dtype=torch.float64) delta_t tensor(0.4848, dtype=torch.float64)
17 gae_duplicate tensor(0.0027, dtype=torch.float64) tensor(-0.8732, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4247, dtype=torch.float64) delta_t tensor(0.1503, dtype=torch.float64)
16 gae_duplicate tensor(-0.1291, dtype=torch.float64) tensor(-4.7080, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1383, dtype=torch.float64) delta_t tensor(0.3749, dtype=torch.float64)
15 gae_duplicate tensor(-0.4769, dtype=torch.float64) tensor(-4.1547, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6959, dtype=torch.float64) delta_t tensor(0.7667, dtype=torch.float64)
14 gae_duplicate tensor(0.5457, dtype=torch.float64) tensor(-8.1990, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5024, dtype=torch.float64) delta_t tensor(0.3047, dtype=torch.float64)
13 gae_duplicate tensor(0.2720, dtype=torch.float64) tensor(-10.2865, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5068, dtype=torch.float64) delta_t tensor(0.4973, dtype=torch.float64)
12 gae_duplicate tensor(0.4947, dtype=torch.float64) tensor(-2.0052, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1669, dtype=torch.float64) delta_t tensor(0.2519, dtype=torch.float64)
11 gae_duplicate tensor(-0.5586, dtype=torch.float64) tensor(-0.3140, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3002, dtype=torch.float64) delta_t tensor(-0.9662, dtype=torch.float64)
10 gae_duplicate tensor(-2.3952, dtype=torch.float64) tensor(-4.6946, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2708, dtype=torch.float64) delta_t tensor(-0.0154, dtype=torch.float64)
9 gae_duplicate tensor(-1.0813, dtype=torch.float64) tensor(1.4627, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0497, dtype=torch.float64) delta_t tensor(0.0381, dtype=torch.float64)
8 gae_duplicate tensor(-0.8245, dtype=torch.float64) tensor(2.5362, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0753, dtype=torch.float64) delta_t tensor(0.1311, dtype=torch.float64)
7 gae_duplicate tensor(-0.1978, dtype=torch.float64) tensor(0.0793, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2732, dtype=torch.float64) delta_t tensor(-0.1462, dtype=torch.float64)
6 gae_duplicate tensor(-0.8899, dtype=torch.float64) tensor(2.2103, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8269, dtype=torch.float64) delta_t tensor(-0.2569, dtype=torch.float64)
5 gae_duplicate tensor(-1.4701, dtype=torch.float64) tensor(3.6242, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2711, dtype=torch.float64) delta_t tensor(-0.4289, dtype=torch.float64)
4 gae_duplicate tensor(-8.1673, dtype=torch.float64) tensor(1.7383, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4746, dtype=torch.float64) delta_t tensor(-0.4319, dtype=torch.float64)
3 gae_duplicate tensor(-6.2441, dtype=torch.float64) tensor(0.8807, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2381, dtype=torch.float64) delta_t tensor(-0.3346, dtype=torch.float64)
2 gae_duplicate tensor(-4.8958, dtype=torch.float64) tensor(2.9179, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:818.19140625
value loss:449.59954833984375
entropies:75.83415985107422
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.840036153793335 seconds
19 rew tensor(0.6876, dtype=torch.float64) delta_t tensor(-0.1913, dtype=torch.float64)
19 gae_duplicate tensor(-1.1129, dtype=torch.float64) tensor(2.4605, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6176, dtype=torch.float64) delta_t tensor(0.6808, dtype=torch.float64)
18 gae_duplicate tensor(-1.2172, dtype=torch.float64) tensor(-8.3259, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5014, dtype=torch.float64) delta_t tensor(0.3876, dtype=torch.float64)
17 gae_duplicate tensor(-1.4120, dtype=torch.float64) tensor(-5.5839, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7345, dtype=torch.float64) delta_t tensor(0.2567, dtype=torch.float64)
16 gae_duplicate tensor(-0.6072, dtype=torch.float64) tensor(0.7047, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7034, dtype=torch.float64) delta_t tensor(0.8043, dtype=torch.float64)
15 gae_duplicate tensor(0.0226, dtype=torch.float64) tensor(-5.6174, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7113, dtype=torch.float64) delta_t tensor(0.3981, dtype=torch.float64)
14 gae_duplicate tensor(0.5471, dtype=torch.float64) tensor(-10.2953, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6638, dtype=torch.float64) delta_t tensor(0.7112, dtype=torch.float64)
13 gae_duplicate tensor(1.4749, dtype=torch.float64) tensor(-2.2753, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3380, dtype=torch.float64) delta_t tensor(-0.7723, dtype=torch.float64)
12 gae_duplicate tensor(-1.6722, dtype=torch.float64) tensor(0.4731, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4128, dtype=torch.float64) delta_t tensor(0.2817, dtype=torch.float64)
11 gae_duplicate tensor(-1.4283, dtype=torch.float64) tensor(-4.6688, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1621, dtype=torch.float64) delta_t tensor(-0.3691, dtype=torch.float64)
10 gae_duplicate tensor(-1.8254, dtype=torch.float64) tensor(-0.5885, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2305, dtype=torch.float64) delta_t tensor(-1.2789, dtype=torch.float64)
9 gae_duplicate tensor(-5.6924, dtype=torch.float64) tensor(-2.7301, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1583, dtype=torch.float64) delta_t tensor(0.1607, dtype=torch.float64)
8 gae_duplicate tensor(-3.8110, dtype=torch.float64) tensor(0.6631, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2651, dtype=torch.float64) delta_t tensor(-0.2963, dtype=torch.float64)
7 gae_duplicate tensor(-2.4716, dtype=torch.float64) tensor(2.7297, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3806, dtype=torch.float64) delta_t tensor(-0.0039, dtype=torch.float64)
6 gae_duplicate tensor(-1.7764, dtype=torch.float64) tensor(5.1733, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9277, dtype=torch.float64) delta_t tensor(-0.6266, dtype=torch.float64)
5 gae_duplicate tensor(-3.6360, dtype=torch.float64) tensor(1.4214, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8207, dtype=torch.float64) delta_t tensor(-0.1994, dtype=torch.float64)
4 gae_duplicate tensor(-6.5871, dtype=torch.float64) tensor(2.0548, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0130, dtype=torch.float64) delta_t tensor(0.3487, dtype=torch.float64)
3 gae_duplicate tensor(-4.9435, dtype=torch.float64) tensor(0.5029, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3315, dtype=torch.float64) delta_t tensor(-0.2345, dtype=torch.float64)
2 gae_duplicate tensor(-3.8913, dtype=torch.float64) tensor(0.6173, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:824.773193359375
value loss:506.6368408203125
entropies:74.77997589111328
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1106.7283)
ToM Target loss= tensor(1811.8350)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.593523025512695 seconds
19 rew tensor(0.7183, dtype=torch.float64) delta_t tensor(-0.2444, dtype=torch.float64)
19 gae_duplicate tensor(-0.9530, dtype=torch.float64) tensor(4.8981, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6947, dtype=torch.float64) delta_t tensor(0.6348, dtype=torch.float64)
18 gae_duplicate tensor(-0.1117, dtype=torch.float64) tensor(-0.4359, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6474, dtype=torch.float64) delta_t tensor(0.1420, dtype=torch.float64)
17 gae_duplicate tensor(-0.1943, dtype=torch.float64) tensor(-2.4773, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5447, dtype=torch.float64) delta_t tensor(0.3178, dtype=torch.float64)
16 gae_duplicate tensor(-0.6612, dtype=torch.float64) tensor(-2.4215, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3948, dtype=torch.float64) delta_t tensor(0.5322, dtype=torch.float64)
15 gae_duplicate tensor(-0.5302, dtype=torch.float64) tensor(0.3120, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7424, dtype=torch.float64) delta_t tensor(0.7427, dtype=torch.float64)
14 gae_duplicate tensor(0.8546, dtype=torch.float64) tensor(-8.5030, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4092, dtype=torch.float64) delta_t tensor(0.0768, dtype=torch.float64)
13 gae_duplicate tensor(-0.8463, dtype=torch.float64) tensor(3.2416, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.6802, dtype=torch.float64) delta_t tensor(-0.8380, dtype=torch.float64)
12 gae_duplicate tensor(-5.7316, dtype=torch.float64) tensor(-13.3844, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5134, dtype=torch.float64) delta_t tensor(0.2826, dtype=torch.float64)
11 gae_duplicate tensor(-4.9560, dtype=torch.float64) tensor(-5.3212, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2135, dtype=torch.float64) delta_t tensor(-0.6477, dtype=torch.float64)
10 gae_duplicate tensor(-4.1248, dtype=torch.float64) tensor(0.5425, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1930, dtype=torch.float64) delta_t tensor(-0.4649, dtype=torch.float64)
9 gae_duplicate tensor(-3.0214, dtype=torch.float64) tensor(0.9382, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4874, dtype=torch.float64) delta_t tensor(-0.4153, dtype=torch.float64)
8 gae_duplicate tensor(-1.8735, dtype=torch.float64) tensor(2.8113, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6769, dtype=torch.float64) delta_t tensor(-0.5360, dtype=torch.float64)
7 gae_duplicate tensor(-2.4762, dtype=torch.float64) tensor(1.2685, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8037, dtype=torch.float64) delta_t tensor(-0.6373, dtype=torch.float64)
6 gae_duplicate tensor(-3.6237, dtype=torch.float64) tensor(2.3976, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2388, dtype=torch.float64) delta_t tensor(-0.7665, dtype=torch.float64)
5 gae_duplicate tensor(-4.6849, dtype=torch.float64) tensor(22.8626, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3868, dtype=torch.float64) delta_t tensor(0.2123, dtype=torch.float64)
4 gae_duplicate tensor(-5.9442, dtype=torch.float64) tensor(2.1936, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4515, dtype=torch.float64) delta_t tensor(-0.0184, dtype=torch.float64)
3 gae_duplicate tensor(-5.2359, dtype=torch.float64) tensor(6.2322, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1313, dtype=torch.float64) delta_t tensor(-0.2829, dtype=torch.float64)
2 gae_duplicate tensor(-3.6483, dtype=torch.float64) tensor(5.0925, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-741.8135986328125
value loss:628.6852416992188
entropies:71.7375717163086
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.933055877685547 seconds
19 rew tensor(0.7180, dtype=torch.float64) delta_t tensor(-0.0700, dtype=torch.float64)
19 gae_duplicate tensor(-0.6854, dtype=torch.float64) tensor(2.0200, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7025, dtype=torch.float64) delta_t tensor(0.4905, dtype=torch.float64)
18 gae_duplicate tensor(-0.3465, dtype=torch.float64) tensor(-4.1902, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6636, dtype=torch.float64) delta_t tensor(0.3242, dtype=torch.float64)
17 gae_duplicate tensor(-0.1704, dtype=torch.float64) tensor(-3.5915, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5781, dtype=torch.float64) delta_t tensor(0.3362, dtype=torch.float64)
16 gae_duplicate tensor(-0.5486, dtype=torch.float64) tensor(-3.2871, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4301, dtype=torch.float64) delta_t tensor(0.1648, dtype=torch.float64)
15 gae_duplicate tensor(-0.4198, dtype=torch.float64) tensor(-2.3920, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7032, dtype=torch.float64) delta_t tensor(0.5224, dtype=torch.float64)
14 gae_duplicate tensor(0.1757, dtype=torch.float64) tensor(-9.6611, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6721, dtype=torch.float64) delta_t tensor(0.7370, dtype=torch.float64)
13 gae_duplicate tensor(1.3609, dtype=torch.float64) tensor(-7.2097, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6714, dtype=torch.float64) delta_t tensor(0.4441, dtype=torch.float64)
12 gae_duplicate tensor(1.4855, dtype=torch.float64) tensor(-11.2622, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5549, dtype=torch.float64) delta_t tensor(-0.7337, dtype=torch.float64)
11 gae_duplicate tensor(-5.3199, dtype=torch.float64) tensor(-0.7926, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1856, dtype=torch.float64) delta_t tensor(-0.4026, dtype=torch.float64)
10 gae_duplicate tensor(-7.6936, dtype=torch.float64) tensor(-0.2241, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4777, dtype=torch.float64) delta_t tensor(-0.6849, dtype=torch.float64)
9 gae_duplicate tensor(-5.5707, dtype=torch.float64) tensor(-1.4164, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.4132, dtype=torch.float64) delta_t tensor(-1.6075, dtype=torch.float64)
8 gae_duplicate tensor(-5.0143, dtype=torch.float64) tensor(2.3813, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3865, dtype=torch.float64) delta_t tensor(-0.4940, dtype=torch.float64)
7 gae_duplicate tensor(-5.3596, dtype=torch.float64) tensor(14.9649, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3461, dtype=torch.float64) delta_t tensor(-0.1473, dtype=torch.float64)
6 gae_duplicate tensor(-4.1332, dtype=torch.float64) tensor(2.2500, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0237, dtype=torch.float64) delta_t tensor(-0.1931, dtype=torch.float64)
5 gae_duplicate tensor(-3.2640, dtype=torch.float64) tensor(14.0172, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7221, dtype=torch.float64) delta_t tensor(-0.9360, dtype=torch.float64)
4 gae_duplicate tensor(-7.1999, dtype=torch.float64) tensor(14.3373, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2698, dtype=torch.float64) delta_t tensor(-0.1131, dtype=torch.float64)
3 gae_duplicate tensor(-5.4921, dtype=torch.float64) tensor(18.5622, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1277, dtype=torch.float64) delta_t tensor(-0.1148, dtype=torch.float64)
2 gae_duplicate tensor(-4.3242, dtype=torch.float64) tensor(5.9854, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1110.68310546875
value loss:904.4521484375
entropies:72.22065734863281
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.58684778213501 seconds
19 rew tensor(0.6949, dtype=torch.float64) delta_t tensor(-0.4763, dtype=torch.float64)
19 gae_duplicate tensor(-0.9422, dtype=torch.float64) tensor(0.3963, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6486, dtype=torch.float64) delta_t tensor(0.3420, dtype=torch.float64)
18 gae_duplicate tensor(-0.8891, dtype=torch.float64) tensor(-0.5652, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6640, dtype=torch.float64) delta_t tensor(0.2411, dtype=torch.float64)
17 gae_duplicate tensor(-0.3715, dtype=torch.float64) tensor(-1.2318, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6176, dtype=torch.float64) delta_t tensor(0.4675, dtype=torch.float64)
16 gae_duplicate tensor(-0.3095, dtype=torch.float64) tensor(-0.7032, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4860, dtype=torch.float64) delta_t tensor(0.3373, dtype=torch.float64)
15 gae_duplicate tensor(-1.0117, dtype=torch.float64) tensor(-4.4798, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5950, dtype=torch.float64) delta_t tensor(0.7081, dtype=torch.float64)
14 gae_duplicate tensor(0.0010, dtype=torch.float64) tensor(-8.6205, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6698, dtype=torch.float64) delta_t tensor(0.3526, dtype=torch.float64)
13 gae_duplicate tensor(-0.1035, dtype=torch.float64) tensor(-3.0471, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0289, dtype=torch.float64) delta_t tensor(0.0387, dtype=torch.float64)
12 gae_duplicate tensor(-2.1044, dtype=torch.float64) tensor(-10.7187, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0793, dtype=torch.float64) delta_t tensor(-0.2558, dtype=torch.float64)
11 gae_duplicate tensor(-1.7301, dtype=torch.float64) tensor(8.4728, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.7513, dtype=torch.float64) delta_t tensor(-2.0894, dtype=torch.float64)
10 gae_duplicate tensor(-4.6519, dtype=torch.float64) tensor(1.5825, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8241, dtype=torch.float64) delta_t tensor(-0.9803, dtype=torch.float64)
9 gae_duplicate tensor(-4.3193, dtype=torch.float64) tensor(11.8282, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1866, dtype=torch.float64) delta_t tensor(0.1299, dtype=torch.float64)
8 gae_duplicate tensor(-3.7070, dtype=torch.float64) tensor(10.2449, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0768, dtype=torch.float64) delta_t tensor(0.4423, dtype=torch.float64)
7 gae_duplicate tensor(-2.4476, dtype=torch.float64) tensor(4.2584, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2903, dtype=torch.float64) delta_t tensor(0.2091, dtype=torch.float64)
6 gae_duplicate tensor(-1.9524, dtype=torch.float64) tensor(2.3878, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7415, dtype=torch.float64) delta_t tensor(-0.3499, dtype=torch.float64)
5 gae_duplicate tensor(-2.1132, dtype=torch.float64) tensor(0.6890, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1163, dtype=torch.float64) delta_t tensor(0.6970, dtype=torch.float64)
4 gae_duplicate tensor(-1.5863, dtype=torch.float64) tensor(-0.2418, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2546, dtype=torch.float64) delta_t tensor(0.1102, dtype=torch.float64)
3 gae_duplicate tensor(-1.4929, dtype=torch.float64) tensor(0.4172, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2291, dtype=torch.float64) delta_t tensor(-0.3667, dtype=torch.float64)
2 gae_duplicate tensor(-1.8824, dtype=torch.float64) tensor(0.2120, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-404.4757385253906
value loss:400.09368896484375
entropies:70.92721557617188
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.805480003356934 seconds
19 rew tensor(0.7337, dtype=torch.float64) delta_t tensor(-0.1037, dtype=torch.float64)
19 gae_duplicate tensor(-0.5440, dtype=torch.float64) tensor(2.1968, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7338, dtype=torch.float64) delta_t tensor(0.5327, dtype=torch.float64)
18 gae_duplicate tensor(0.0535, dtype=torch.float64) tensor(-0.6121, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7416, dtype=torch.float64) delta_t tensor(0.6573, dtype=torch.float64)
17 gae_duplicate tensor(0.5316, dtype=torch.float64) tensor(-6.2632, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7417, dtype=torch.float64) delta_t tensor(0.6718, dtype=torch.float64)
16 gae_duplicate tensor(0.9142, dtype=torch.float64) tensor(-1.4438, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7418, dtype=torch.float64) delta_t tensor(0.6210, dtype=torch.float64)
15 gae_duplicate tensor(1.2203, dtype=torch.float64) tensor(-1.8369, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6953, dtype=torch.float64) delta_t tensor(0.5536, dtype=torch.float64)
14 gae_duplicate tensor(1.4388, dtype=torch.float64) tensor(-7.9711, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3556, dtype=torch.float64) delta_t tensor(0.2673, dtype=torch.float64)
13 gae_duplicate tensor(-0.1307, dtype=torch.float64) tensor(-1.8002, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.7888, dtype=torch.float64) delta_t tensor(-1.0419, dtype=torch.float64)
12 gae_duplicate tensor(-4.2327, dtype=torch.float64) tensor(-0.2235, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3493, dtype=torch.float64) delta_t tensor(-0.5286, dtype=torch.float64)
11 gae_duplicate tensor(-3.8855, dtype=torch.float64) tensor(-7.8392, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2402, dtype=torch.float64) delta_t tensor(-0.2217, dtype=torch.float64)
10 gae_duplicate tensor(-2.7707, dtype=torch.float64) tensor(0.4022, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3034, dtype=torch.float64) delta_t tensor(-0.1475, dtype=torch.float64)
9 gae_duplicate tensor(-1.4694, dtype=torch.float64) tensor(0.5960, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1277, dtype=torch.float64) delta_t tensor(-0.3132, dtype=torch.float64)
8 gae_duplicate tensor(-1.4763, dtype=torch.float64) tensor(3.7907, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7885, dtype=torch.float64) delta_t tensor(-0.7207, dtype=torch.float64)
7 gae_duplicate tensor(-3.7158, dtype=torch.float64) tensor(1.3690, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3767, dtype=torch.float64) delta_t tensor(-0.3332, dtype=torch.float64)
6 gae_duplicate tensor(-4.7413, dtype=torch.float64) tensor(10.9573, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6736, dtype=torch.float64) delta_t tensor(-0.2619, dtype=torch.float64)
5 gae_duplicate tensor(-4.1141, dtype=torch.float64) tensor(0.8721, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2070, dtype=torch.float64) delta_t tensor(0.4518, dtype=torch.float64)
4 gae_duplicate tensor(-5.3134, dtype=torch.float64) tensor(0.4737, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0434, dtype=torch.float64) delta_t tensor(0.2161, dtype=torch.float64)
3 gae_duplicate tensor(-4.1975, dtype=torch.float64) tensor(0.1567, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2846, dtype=torch.float64) delta_t tensor(-0.1885, dtype=torch.float64)
2 gae_duplicate tensor(-3.1199, dtype=torch.float64) tensor(0.4175, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:230.76519775390625
value loss:564.4202880859375
entropies:69.58162689208984
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.788180828094482 seconds
19 rew tensor(0.5787, dtype=torch.float64) delta_t tensor(-0.5106, dtype=torch.float64)
19 gae_duplicate tensor(-1.3947, dtype=torch.float64) tensor(0.0230, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4312, dtype=torch.float64) delta_t tensor(0.2762, dtype=torch.float64)
18 gae_duplicate tensor(-1.8195, dtype=torch.float64) tensor(-2.1280, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6638, dtype=torch.float64) delta_t tensor(0.4213, dtype=torch.float64)
17 gae_duplicate tensor(-0.8753, dtype=torch.float64) tensor(-0.3212, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5622, dtype=torch.float64) delta_t tensor(0.4531, dtype=torch.float64)
16 gae_duplicate tensor(-0.1199, dtype=torch.float64) tensor(-0.7528, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2744, dtype=torch.float64) delta_t tensor(-0.0887, dtype=torch.float64)
15 gae_duplicate tensor(-1.3729, dtype=torch.float64) tensor(-2.7450, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4008, dtype=torch.float64) delta_t tensor(0.4078, dtype=torch.float64)
14 gae_duplicate tensor(-2.4265, dtype=torch.float64) tensor(-4.9099, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6713, dtype=torch.float64) delta_t tensor(0.6091, dtype=torch.float64)
13 gae_duplicate tensor(-1.5158, dtype=torch.float64) tensor(-4.3925, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3307, dtype=torch.float64) delta_t tensor(-0.0307, dtype=torch.float64)
12 gae_duplicate tensor(-0.8985, dtype=torch.float64) tensor(-10.1662, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1780, dtype=torch.float64) delta_t tensor(0.1100, dtype=torch.float64)
11 gae_duplicate tensor(-0.6490, dtype=torch.float64) tensor(-0.8933, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5369, dtype=torch.float64) delta_t tensor(-0.9387, dtype=torch.float64)
10 gae_duplicate tensor(-2.1259, dtype=torch.float64) tensor(1.2220, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1852, dtype=torch.float64) delta_t tensor(-1.4448, dtype=torch.float64)
9 gae_duplicate tensor(-3.4056, dtype=torch.float64) tensor(1.6134, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0647, dtype=torch.float64) delta_t tensor(-0.0251, dtype=torch.float64)
8 gae_duplicate tensor(-2.8014, dtype=torch.float64) tensor(1.3583, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1072, dtype=torch.float64) delta_t tensor(-0.0134, dtype=torch.float64)
7 gae_duplicate tensor(-2.3502, dtype=torch.float64) tensor(6.2708, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2096, dtype=torch.float64) delta_t tensor(0.2905, dtype=torch.float64)
6 gae_duplicate tensor(-2.4597, dtype=torch.float64) tensor(11.6434, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3774, dtype=torch.float64) delta_t tensor(-0.0528, dtype=torch.float64)
5 gae_duplicate tensor(-2.0198, dtype=torch.float64) tensor(1.2778, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6219, dtype=torch.float64) delta_t tensor(-0.0524, dtype=torch.float64)
4 gae_duplicate tensor(-3.3078, dtype=torch.float64) tensor(2.6172, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3384, dtype=torch.float64) delta_t tensor(-0.1441, dtype=torch.float64)
3 gae_duplicate tensor(-2.3786, dtype=torch.float64) tensor(0.4949, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2982, dtype=torch.float64) delta_t tensor(-0.5962, dtype=torch.float64)
2 gae_duplicate tensor(-1.8410, dtype=torch.float64) tensor(0.8846, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-52.059749603271484
value loss:304.8793640136719
entropies:69.9169692993164
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1120.1990)
ToM Target loss= tensor(1815.9548)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.8273396492004395 seconds
19 rew tensor(0.7344, dtype=torch.float64) delta_t tensor(-0.1366, dtype=torch.float64)
19 gae_duplicate tensor(-0.8424, dtype=torch.float64) tensor(2.6204, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7266, dtype=torch.float64) delta_t tensor(0.4999, dtype=torch.float64)
18 gae_duplicate tensor(-0.2728, dtype=torch.float64) tensor(-2.2756, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6228, dtype=torch.float64) delta_t tensor(0.5746, dtype=torch.float64)
17 gae_duplicate tensor(-0.1024, dtype=torch.float64) tensor(-0.8289, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5354, dtype=torch.float64) delta_t tensor(0.4292, dtype=torch.float64)
16 gae_duplicate tensor(-0.3318, dtype=torch.float64) tensor(-1.0812, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4976, dtype=torch.float64) delta_t tensor(0.4255, dtype=torch.float64)
15 gae_duplicate tensor(-0.4051, dtype=torch.float64) tensor(-1.3049, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4396, dtype=torch.float64) delta_t tensor(0.3578, dtype=torch.float64)
14 gae_duplicate tensor(0.1026, dtype=torch.float64) tensor(-1.4094, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4600, dtype=torch.float64) delta_t tensor(0.3117, dtype=torch.float64)
13 gae_duplicate tensor(0.0978, dtype=torch.float64) tensor(-1.4042, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3527, dtype=torch.float64) delta_t tensor(-0.4947, dtype=torch.float64)
12 gae_duplicate tensor(-2.0157, dtype=torch.float64) tensor(5.1285, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4068, dtype=torch.float64) delta_t tensor(0.0226, dtype=torch.float64)
11 gae_duplicate tensor(-1.0439, dtype=torch.float64) tensor(-7.2305, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0436, dtype=torch.float64) delta_t tensor(-0.3884, dtype=torch.float64)
10 gae_duplicate tensor(-1.4658, dtype=torch.float64) tensor(1.4252, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0545, dtype=torch.float64) delta_t tensor(-0.2804, dtype=torch.float64)
9 gae_duplicate tensor(-1.1789, dtype=torch.float64) tensor(-0.8357, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3826, dtype=torch.float64) delta_t tensor(-0.5162, dtype=torch.float64)
8 gae_duplicate tensor(-2.2070, dtype=torch.float64) tensor(9.1804, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4827, dtype=torch.float64) delta_t tensor(-0.3186, dtype=torch.float64)
7 gae_duplicate tensor(-3.3295, dtype=torch.float64) tensor(10.1182, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6452, dtype=torch.float64) delta_t tensor(-0.3469, dtype=torch.float64)
6 gae_duplicate tensor(-4.3313, dtype=torch.float64) tensor(5.5808, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0750, dtype=torch.float64) delta_t tensor(-0.8099, dtype=torch.float64)
5 gae_duplicate tensor(-5.2636, dtype=torch.float64) tensor(3.7794, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4901, dtype=torch.float64) delta_t tensor(0.2886, dtype=torch.float64)
4 gae_duplicate tensor(-5.0744, dtype=torch.float64) tensor(-0.5723, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0031, dtype=torch.float64) delta_t tensor(0.2387, dtype=torch.float64)
3 gae_duplicate tensor(-4.5384, dtype=torch.float64) tensor(-5.3047, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2614, dtype=torch.float64) delta_t tensor(-0.0590, dtype=torch.float64)
2 gae_duplicate tensor(-3.1214, dtype=torch.float64) tensor(0.5082, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-591.7214965820312
value loss:465.22314453125
entropies:68.60806274414062
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.135969161987305 seconds
19 rew tensor(0.7343, dtype=torch.float64) delta_t tensor(-0.7505, dtype=torch.float64)
19 gae_duplicate tensor(-1.0239, dtype=torch.float64) tensor(3.7033, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7263, dtype=torch.float64) delta_t tensor(0.4235, dtype=torch.float64)
18 gae_duplicate tensor(-0.4255, dtype=torch.float64) tensor(0.1745, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7104, dtype=torch.float64) delta_t tensor(0.4405, dtype=torch.float64)
17 gae_duplicate tensor(0.0533, dtype=torch.float64) tensor(-0.2946, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6703, dtype=torch.float64) delta_t tensor(0.2905, dtype=torch.float64)
16 gae_duplicate tensor(0.0819, dtype=torch.float64) tensor(-0.5299, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6064, dtype=torch.float64) delta_t tensor(0.5000, dtype=torch.float64)
15 gae_duplicate tensor(-0.2215, dtype=torch.float64) tensor(-0.9405, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7350, dtype=torch.float64) delta_t tensor(0.3984, dtype=torch.float64)
14 gae_duplicate tensor(0.2828, dtype=torch.float64) tensor(-9.1377, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7351, dtype=torch.float64) delta_t tensor(0.4857, dtype=torch.float64)
13 gae_duplicate tensor(0.6863, dtype=torch.float64) tensor(-1.4247, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0692, dtype=torch.float64) delta_t tensor(-0.2000, dtype=torch.float64)
12 gae_duplicate tensor(-2.8476, dtype=torch.float64) tensor(-5.3119, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2499, dtype=torch.float64) delta_t tensor(0.1506, dtype=torch.float64)
11 gae_duplicate tensor(-0.9194, dtype=torch.float64) tensor(-0.9262, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2952, dtype=torch.float64) delta_t tensor(0.1132, dtype=torch.float64)
10 gae_duplicate tensor(-1.2007, dtype=torch.float64) tensor(1.2095, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1987, dtype=torch.float64) delta_t tensor(-0.2620, dtype=torch.float64)
9 gae_duplicate tensor(-2.4930, dtype=torch.float64) tensor(-5.8579, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7992, dtype=torch.float64) delta_t tensor(-1.0026, dtype=torch.float64)
8 gae_duplicate tensor(-4.0883, dtype=torch.float64) tensor(4.3101, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5315, dtype=torch.float64) delta_t tensor(-0.4110, dtype=torch.float64)
7 gae_duplicate tensor(-3.1234, dtype=torch.float64) tensor(10.8073, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0575, dtype=torch.float64) delta_t tensor(-0.2801, dtype=torch.float64)
6 gae_duplicate tensor(-2.6500, dtype=torch.float64) tensor(2.7384, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9923, dtype=torch.float64) delta_t tensor(-0.4266, dtype=torch.float64)
5 gae_duplicate tensor(-3.4029, dtype=torch.float64) tensor(5.2771, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4980, dtype=torch.float64) delta_t tensor(0.1084, dtype=torch.float64)
4 gae_duplicate tensor(-4.7630, dtype=torch.float64) tensor(-0.3632, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1578, dtype=torch.float64) delta_t tensor(0.3549, dtype=torch.float64)
3 gae_duplicate tensor(-3.6226, dtype=torch.float64) tensor(10.1817, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2870, dtype=torch.float64) delta_t tensor(-0.4539, dtype=torch.float64)
2 gae_duplicate tensor(-2.8320, dtype=torch.float64) tensor(0.6564, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-526.2363891601562
value loss:354.1180114746094
entropies:69.19197845458984
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.8385021686553955 seconds
19 rew tensor(0.6803, dtype=torch.float64) delta_t tensor(-0.6072, dtype=torch.float64)
19 gae_duplicate tensor(-0.7484, dtype=torch.float64) tensor(0.6241, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5953, dtype=torch.float64) delta_t tensor(0.3186, dtype=torch.float64)
18 gae_duplicate tensor(-0.9924, dtype=torch.float64) tensor(2.6595, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4871, dtype=torch.float64) delta_t tensor(0.4322, dtype=torch.float64)
17 gae_duplicate tensor(-1.2917, dtype=torch.float64) tensor(-0.3609, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7425, dtype=torch.float64) delta_t tensor(0.4078, dtype=torch.float64)
16 gae_duplicate tensor(-0.6466, dtype=torch.float64) tensor(-3.4815, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7348, dtype=torch.float64) delta_t tensor(0.6815, dtype=torch.float64)
15 gae_duplicate tensor(0.0708, dtype=torch.float64) tensor(-1.6187, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2784, dtype=torch.float64) delta_t tensor(0.1617, dtype=torch.float64)
14 gae_duplicate tensor(-2.1416, dtype=torch.float64) tensor(-1.2051, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6728, dtype=torch.float64) delta_t tensor(0.4171, dtype=torch.float64)
13 gae_duplicate tensor(-1.1263, dtype=torch.float64) tensor(-4.6689, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6963, dtype=torch.float64) delta_t tensor(0.5287, dtype=torch.float64)
12 gae_duplicate tensor(-0.5379, dtype=torch.float64) tensor(-1.5746, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2999, dtype=torch.float64) delta_t tensor(0.0258, dtype=torch.float64)
11 gae_duplicate tensor(-0.4070, dtype=torch.float64) tensor(-0.0712, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5788, dtype=torch.float64) delta_t tensor(-0.8290, dtype=torch.float64)
10 gae_duplicate tensor(-1.5091, dtype=torch.float64) tensor(-0.2545, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7431, dtype=torch.float64) delta_t tensor(-1.0115, dtype=torch.float64)
9 gae_duplicate tensor(-4.4574, dtype=torch.float64) tensor(-0.0342, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4427, dtype=torch.float64) delta_t tensor(-0.1274, dtype=torch.float64)
8 gae_duplicate tensor(-5.2567, dtype=torch.float64) tensor(0.6033, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2936, dtype=torch.float64) delta_t tensor(0.1142, dtype=torch.float64)
7 gae_duplicate tensor(-4.1108, dtype=torch.float64) tensor(-1.5899, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4011, dtype=torch.float64) delta_t tensor(-0.2092, dtype=torch.float64)
6 gae_duplicate tensor(-3.0784, dtype=torch.float64) tensor(-0.2257, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4761, dtype=torch.float64) delta_t tensor(-0.0637, dtype=torch.float64)
5 gae_duplicate tensor(-2.1201, dtype=torch.float64) tensor(5.1872, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1755, dtype=torch.float64) delta_t tensor(0.3882, dtype=torch.float64)
4 gae_duplicate tensor(-0.8565, dtype=torch.float64) tensor(2.5439, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5423, dtype=torch.float64) delta_t tensor(0.0320, dtype=torch.float64)
3 gae_duplicate tensor(-1.8050, dtype=torch.float64) tensor(1.6251, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1756, dtype=torch.float64) delta_t tensor(-0.4364, dtype=torch.float64)
2 gae_duplicate tensor(-1.7870, dtype=torch.float64) tensor(6.0720, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-164.93484497070312
value loss:318.8252258300781
entropies:70.33950805664062
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.865249872207642 seconds
19 rew tensor(0.7178, dtype=torch.float64) delta_t tensor(-0.4806, dtype=torch.float64)
19 gae_duplicate tensor(-1.1762, dtype=torch.float64) tensor(3.0282, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7179, dtype=torch.float64) delta_t tensor(0.4974, dtype=torch.float64)
18 gae_duplicate tensor(-0.4506, dtype=torch.float64) tensor(-0.1114, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6940, dtype=torch.float64) delta_t tensor(0.4422, dtype=torch.float64)
17 gae_duplicate tensor(-0.1108, dtype=torch.float64) tensor(-0.5072, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5131, dtype=torch.float64) delta_t tensor(0.3450, dtype=torch.float64)
16 gae_duplicate tensor(-0.1911, dtype=torch.float64) tensor(-0.7318, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3082, dtype=torch.float64) delta_t tensor(0.2543, dtype=torch.float64)
15 gae_duplicate tensor(-0.6886, dtype=torch.float64) tensor(-4.7123, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6956, dtype=torch.float64) delta_t tensor(0.6476, dtype=torch.float64)
14 gae_duplicate tensor(-0.4661, dtype=torch.float64) tensor(-1.2867, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5711, dtype=torch.float64) delta_t tensor(0.1236, dtype=torch.float64)
13 gae_duplicate tensor(-0.5320, dtype=torch.float64) tensor(-22.0061, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6958, dtype=torch.float64) delta_t tensor(0.9405, dtype=torch.float64)
12 gae_duplicate tensor(1.2340, dtype=torch.float64) tensor(-9.4642, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.5393, dtype=torch.float64) delta_t tensor(-1.7696, dtype=torch.float64)
11 gae_duplicate tensor(-4.7844, dtype=torch.float64) tensor(-6.9581, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7032, dtype=torch.float64) delta_t tensor(-1.0476, dtype=torch.float64)
10 gae_duplicate tensor(-5.6634, dtype=torch.float64) tensor(-2.6007, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1385, dtype=torch.float64) delta_t tensor(-0.3038, dtype=torch.float64)
9 gae_duplicate tensor(-4.6772, dtype=torch.float64) tensor(13.4613, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1987, dtype=torch.float64) delta_t tensor(-0.1187, dtype=torch.float64)
8 gae_duplicate tensor(-2.8869, dtype=torch.float64) tensor(6.6393, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0567, dtype=torch.float64) delta_t tensor(-0.0372, dtype=torch.float64)
7 gae_duplicate tensor(-2.4962, dtype=torch.float64) tensor(-2.4538, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3166, dtype=torch.float64) delta_t tensor(-0.2663, dtype=torch.float64)
6 gae_duplicate tensor(-4.7434, dtype=torch.float64) tensor(1.1383, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5550, dtype=torch.float64) delta_t tensor(-0.0251, dtype=torch.float64)
5 gae_duplicate tensor(-4.2836, dtype=torch.float64) tensor(3.8570, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6878, dtype=torch.float64) delta_t tensor(-0.0902, dtype=torch.float64)
4 gae_duplicate tensor(-7.5973, dtype=torch.float64) tensor(0.8713, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2682, dtype=torch.float64) delta_t tensor(0.0369, dtype=torch.float64)
3 gae_duplicate tensor(-5.7916, dtype=torch.float64) tensor(0.4790, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2077, dtype=torch.float64) delta_t tensor(-0.3941, dtype=torch.float64)
2 gae_duplicate tensor(-4.5699, dtype=torch.float64) tensor(3.1317, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:643.8741455078125
value loss:673.98583984375
entropies:68.17681884765625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.832025051116943 seconds
19 rew tensor(0.7340, dtype=torch.float64) delta_t tensor(0.0048, dtype=torch.float64)
19 gae_duplicate tensor(-0.7657, dtype=torch.float64) tensor(0.0353, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7185, dtype=torch.float64) delta_t tensor(0.2245, dtype=torch.float64)
18 gae_duplicate tensor(-0.3918, dtype=torch.float64) tensor(-0.1715, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6797, dtype=torch.float64) delta_t tensor(0.5286, dtype=torch.float64)
17 gae_duplicate tensor(0.1947, dtype=torch.float64) tensor(-5.8342, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6408, dtype=torch.float64) delta_t tensor(0.3917, dtype=torch.float64)
16 gae_duplicate tensor(-0.3198, dtype=torch.float64) tensor(-3.6726, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5469, dtype=torch.float64) delta_t tensor(0.4965, dtype=torch.float64)
15 gae_duplicate tensor(-0.7913, dtype=torch.float64) tensor(-1.1778, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7107, dtype=torch.float64) delta_t tensor(0.5386, dtype=torch.float64)
14 gae_duplicate tensor(-0.1251, dtype=torch.float64) tensor(-5.9019, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6554, dtype=torch.float64) delta_t tensor(0.6038, dtype=torch.float64)
13 gae_duplicate tensor(0.2183, dtype=torch.float64) tensor(-2.4240, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5001, dtype=torch.float64) delta_t tensor(0.3199, dtype=torch.float64)
12 gae_duplicate tensor(0.6080, dtype=torch.float64) tensor(-8.8032, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1632, dtype=torch.float64) delta_t tensor(-0.1148, dtype=torch.float64)
11 gae_duplicate tensor(-0.5372, dtype=torch.float64) tensor(-1.2499, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3043, dtype=torch.float64) delta_t tensor(0.0562, dtype=torch.float64)
10 gae_duplicate tensor(-0.8896, dtype=torch.float64) tensor(-1.0026, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1665, dtype=torch.float64) delta_t tensor(-1.0490, dtype=torch.float64)
9 gae_duplicate tensor(-4.2088, dtype=torch.float64) tensor(-5.0695, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0116, dtype=torch.float64) delta_t tensor(-0.3601, dtype=torch.float64)
8 gae_duplicate tensor(-3.3300, dtype=torch.float64) tensor(-1.3829, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4764, dtype=torch.float64) delta_t tensor(-0.1396, dtype=torch.float64)
7 gae_duplicate tensor(-3.2502, dtype=torch.float64) tensor(5.7741, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2290, dtype=torch.float64) delta_t tensor(-0.3550, dtype=torch.float64)
6 gae_duplicate tensor(-4.9193, dtype=torch.float64) tensor(1.2883, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4727, dtype=torch.float64) delta_t tensor(-0.9103, dtype=torch.float64)
5 gae_duplicate tensor(-7.4540, dtype=torch.float64) tensor(1.5873, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2003, dtype=torch.float64) delta_t tensor(0.8584, dtype=torch.float64)
4 gae_duplicate tensor(-6.1539, dtype=torch.float64) tensor(-0.1610, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4460, dtype=torch.float64) delta_t tensor(-0.0407, dtype=torch.float64)
3 gae_duplicate tensor(-4.1217, dtype=torch.float64) tensor(-3.6625, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1925, dtype=torch.float64) delta_t tensor(-0.5407, dtype=torch.float64)
2 gae_duplicate tensor(-3.2752, dtype=torch.float64) tensor(0.7148, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1107.952880859375
value loss:538.41064453125
entropies:67.48137664794922
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1185.4178)
ToM Target loss= tensor(1821.2324)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.025297164916992 seconds
19 rew tensor(0.7183, dtype=torch.float64) delta_t tensor(-0.5240, dtype=torch.float64)
19 gae_duplicate tensor(-0.9784, dtype=torch.float64) tensor(0.4941, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6635, dtype=torch.float64) delta_t tensor(0.4454, dtype=torch.float64)
18 gae_duplicate tensor(-0.4928, dtype=torch.float64) tensor(0.4462, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6159, dtype=torch.float64) delta_t tensor(0.3396, dtype=torch.float64)
17 gae_duplicate tensor(-0.1541, dtype=torch.float64) tensor(-0.8804, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4663, dtype=torch.float64) delta_t tensor(0.0808, dtype=torch.float64)
16 gae_duplicate tensor(-0.2187, dtype=torch.float64) tensor(-0.3733, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2459, dtype=torch.float64) delta_t tensor(0.0542, dtype=torch.float64)
15 gae_duplicate tensor(-0.8088, dtype=torch.float64) tensor(-0.3676, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5077, dtype=torch.float64) delta_t tensor(0.3158, dtype=torch.float64)
14 gae_duplicate tensor(-1.1946, dtype=torch.float64) tensor(-4.4451, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7424, dtype=torch.float64) delta_t tensor(0.5259, dtype=torch.float64)
13 gae_duplicate tensor(-0.5589, dtype=torch.float64) tensor(-5.0387, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5472, dtype=torch.float64) delta_t tensor(0.4481, dtype=torch.float64)
12 gae_duplicate tensor(-0.1218, dtype=torch.float64) tensor(-10.7794, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2403, dtype=torch.float64) delta_t tensor(0.3279, dtype=torch.float64)
11 gae_duplicate tensor(0.2917, dtype=torch.float64) tensor(-6.0909, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4052, dtype=torch.float64) delta_t tensor(-0.0245, dtype=torch.float64)
10 gae_duplicate tensor(-0.1788, dtype=torch.float64) tensor(-6.2078, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0920, dtype=torch.float64) delta_t tensor(-0.2539, dtype=torch.float64)
9 gae_duplicate tensor(-0.2536, dtype=torch.float64) tensor(-0.7144, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1652, dtype=torch.float64) delta_t tensor(-0.3518, dtype=torch.float64)
8 gae_duplicate tensor(-1.2602, dtype=torch.float64) tensor(-0.1836, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5447, dtype=torch.float64) delta_t tensor(-0.2619, dtype=torch.float64)
7 gae_duplicate tensor(-1.5200, dtype=torch.float64) tensor(-0.0435, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1485, dtype=torch.float64) delta_t tensor(-0.3505, dtype=torch.float64)
6 gae_duplicate tensor(-2.8426, dtype=torch.float64) tensor(-0.5407, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0561, dtype=torch.float64) delta_t tensor(-0.2625, dtype=torch.float64)
5 gae_duplicate tensor(-3.1829, dtype=torch.float64) tensor(4.0488, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3264, dtype=torch.float64) delta_t tensor(0.6757, dtype=torch.float64)
4 gae_duplicate tensor(-2.1858, dtype=torch.float64) tensor(-5.9955, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6509, dtype=torch.float64) delta_t tensor(-0.0375, dtype=torch.float64)
3 gae_duplicate tensor(-1.5612, dtype=torch.float64) tensor(-4.6521, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0287, dtype=torch.float64) delta_t tensor(-0.7215, dtype=torch.float64)
2 gae_duplicate tensor(-1.7121, dtype=torch.float64) tensor(0.5167, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1457.0948486328125
value loss:173.92543029785156
entropies:66.42655181884766
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.241184949874878 seconds
19 rew tensor(0.7029, dtype=torch.float64) delta_t tensor(-0.4798, dtype=torch.float64)
19 gae_duplicate tensor(-0.7664, dtype=torch.float64) tensor(0.0105, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6717, dtype=torch.float64) delta_t tensor(0.2809, dtype=torch.float64)
18 gae_duplicate tensor(-0.2703, dtype=torch.float64) tensor(0.0999, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5936, dtype=torch.float64) delta_t tensor(0.3286, dtype=torch.float64)
17 gae_duplicate tensor(-0.1234, dtype=torch.float64) tensor(-1.6152, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4451, dtype=torch.float64) delta_t tensor(0.0561, dtype=torch.float64)
16 gae_duplicate tensor(-0.4745, dtype=torch.float64) tensor(-0.2527, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1951, dtype=torch.float64) delta_t tensor(0.0109, dtype=torch.float64)
15 gae_duplicate tensor(-1.1402, dtype=torch.float64) tensor(-0.2379, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6803, dtype=torch.float64) delta_t tensor(0.3701, dtype=torch.float64)
14 gae_duplicate tensor(-0.5006, dtype=torch.float64) tensor(-0.7733, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2608, dtype=torch.float64) delta_t tensor(0.0626, dtype=torch.float64)
13 gae_duplicate tensor(-0.9230, dtype=torch.float64) tensor(0.5891, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.8540, dtype=torch.float64) delta_t tensor(-1.0847, dtype=torch.float64)
12 gae_duplicate tensor(-5.3661, dtype=torch.float64) tensor(-0.8093, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-2.0695, dtype=torch.float64) delta_t tensor(-2.0023, dtype=torch.float64)
11 gae_duplicate tensor(-5.7507, dtype=torch.float64) tensor(4.4175, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1117, dtype=torch.float64) delta_t tensor(-0.6870, dtype=torch.float64)
10 gae_duplicate tensor(-5.0797, dtype=torch.float64) tensor(27.5154, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3125, dtype=torch.float64) delta_t tensor(0.4233, dtype=torch.float64)
9 gae_duplicate tensor(-4.0262, dtype=torch.float64) tensor(2.1608, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2298, dtype=torch.float64) delta_t tensor(-0.0535, dtype=torch.float64)
8 gae_duplicate tensor(-3.1586, dtype=torch.float64) tensor(2.2587, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0126, dtype=torch.float64) delta_t tensor(0.2351, dtype=torch.float64)
7 gae_duplicate tensor(-2.2992, dtype=torch.float64) tensor(1.1204, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3651, dtype=torch.float64) delta_t tensor(0.2894, dtype=torch.float64)
6 gae_duplicate tensor(-1.3131, dtype=torch.float64) tensor(0.4769, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4255, dtype=torch.float64) delta_t tensor(0.0762, dtype=torch.float64)
5 gae_duplicate tensor(-0.7394, dtype=torch.float64) tensor(3.5881, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1933, dtype=torch.float64) delta_t tensor(0.9224, dtype=torch.float64)
4 gae_duplicate tensor(-0.5494, dtype=torch.float64) tensor(-9.5072, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4321, dtype=torch.float64) delta_t tensor(-0.1661, dtype=torch.float64)
3 gae_duplicate tensor(-0.9082, dtype=torch.float64) tensor(2.4094, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2488, dtype=torch.float64) delta_t tensor(-0.3610, dtype=torch.float64)
2 gae_duplicate tensor(-1.1364, dtype=torch.float64) tensor(3.7410, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1279.1414794921875
value loss:473.5384521484375
entropies:67.937744140625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.939182996749878 seconds
19 rew tensor(0.7184, dtype=torch.float64) delta_t tensor(-0.4619, dtype=torch.float64)
19 gae_duplicate tensor(-0.8622, dtype=torch.float64) tensor(0.4146, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7107, dtype=torch.float64) delta_t tensor(0.6146, dtype=torch.float64)
18 gae_duplicate tensor(-0.1283, dtype=torch.float64) tensor(-3.6570, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6950, dtype=torch.float64) delta_t tensor(0.3713, dtype=torch.float64)
17 gae_duplicate tensor(0.1562, dtype=torch.float64) tensor(-1.6750, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6399, dtype=torch.float64) delta_t tensor(0.4942, dtype=torch.float64)
16 gae_duplicate tensor(-0.3883, dtype=torch.float64) tensor(-0.8757, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3440, dtype=torch.float64) delta_t tensor(-0.0716, dtype=torch.float64)
15 gae_duplicate tensor(-1.0171, dtype=torch.float64) tensor(-5.1158, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7192, dtype=torch.float64) delta_t tensor(0.6306, dtype=torch.float64)
14 gae_duplicate tensor(-0.3718, dtype=torch.float64) tensor(-1.2171, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6884, dtype=torch.float64) delta_t tensor(0.5151, dtype=torch.float64)
13 gae_duplicate tensor(0.1445, dtype=torch.float64) tensor(-13.1465, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5153, dtype=torch.float64) delta_t tensor(0.3070, dtype=torch.float64)
12 gae_duplicate tensor(-0.3883, dtype=torch.float64) tensor(-1.5230, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2079, dtype=torch.float64) delta_t tensor(0.4774, dtype=torch.float64)
11 gae_duplicate tensor(-1.3013, dtype=torch.float64) tensor(-7.7476, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1372, dtype=torch.float64) delta_t tensor(-0.5322, dtype=torch.float64)
10 gae_duplicate tensor(-2.6146, dtype=torch.float64) tensor(1.0465, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5271, dtype=torch.float64) delta_t tensor(-1.6129, dtype=torch.float64)
9 gae_duplicate tensor(-2.7720, dtype=torch.float64) tensor(0.8749, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0342, dtype=torch.float64) delta_t tensor(-0.0035, dtype=torch.float64)
8 gae_duplicate tensor(-1.6649, dtype=torch.float64) tensor(5.8788, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0580, dtype=torch.float64) delta_t tensor(-0.0044, dtype=torch.float64)
7 gae_duplicate tensor(-1.8162, dtype=torch.float64) tensor(10.6727, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4886, dtype=torch.float64) delta_t tensor(-0.2088, dtype=torch.float64)
6 gae_duplicate tensor(-2.9450, dtype=torch.float64) tensor(2.9076, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4037, dtype=torch.float64) delta_t tensor(-0.1864, dtype=torch.float64)
5 gae_duplicate tensor(-3.2932, dtype=torch.float64) tensor(0.9810, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6588, dtype=torch.float64) delta_t tensor(0.0756, dtype=torch.float64)
4 gae_duplicate tensor(-3.2384, dtype=torch.float64) tensor(0.6604, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0503, dtype=torch.float64) delta_t tensor(0.1643, dtype=torch.float64)
3 gae_duplicate tensor(-3.0750, dtype=torch.float64) tensor(0.2562, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5772, dtype=torch.float64) delta_t tensor(-0.3986, dtype=torch.float64)
2 gae_duplicate tensor(-1.9862, dtype=torch.float64) tensor(0.5244, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:374.3975830078125
value loss:314.28387451171875
entropies:68.1204605102539
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.600623846054077 seconds
19 rew tensor(0.7343, dtype=torch.float64) delta_t tensor(-0.4290, dtype=torch.float64)
19 gae_duplicate tensor(-0.7122, dtype=torch.float64) tensor(0.5068, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7102, dtype=torch.float64) delta_t tensor(0.5297, dtype=torch.float64)
18 gae_duplicate tensor(-0.2703, dtype=torch.float64) tensor(-0.2752, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6942, dtype=torch.float64) delta_t tensor(0.3552, dtype=torch.float64)
17 gae_duplicate tensor(0.0522, dtype=torch.float64) tensor(-2.2543, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6379, dtype=torch.float64) delta_t tensor(0.5026, dtype=torch.float64)
16 gae_duplicate tensor(0.0140, dtype=torch.float64) tensor(-0.9116, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5575, dtype=torch.float64) delta_t tensor(0.4730, dtype=torch.float64)
15 gae_duplicate tensor(-0.3518, dtype=torch.float64) tensor(-1.2228, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6569, dtype=torch.float64) delta_t tensor(0.4287, dtype=torch.float64)
14 gae_duplicate tensor(0.0195, dtype=torch.float64) tensor(-5.1486, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6485, dtype=torch.float64) delta_t tensor(0.4434, dtype=torch.float64)
13 gae_duplicate tensor(0.5012, dtype=torch.float64) tensor(-4.5725, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4226, dtype=torch.float64) delta_t tensor(0.2388, dtype=torch.float64)
12 gae_duplicate tensor(0.9113, dtype=torch.float64) tensor(-1.4490, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0485, dtype=torch.float64) delta_t tensor(-0.2262, dtype=torch.float64)
11 gae_duplicate tensor(-1.6583, dtype=torch.float64) tensor(-2.4653, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0503, dtype=torch.float64) delta_t tensor(-0.4878, dtype=torch.float64)
10 gae_duplicate tensor(-2.9764, dtype=torch.float64) tensor(-4.0131, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2915, dtype=torch.float64) delta_t tensor(-0.2758, dtype=torch.float64)
9 gae_duplicate tensor(-2.0745, dtype=torch.float64) tensor(0.0063, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5281, dtype=torch.float64) delta_t tensor(-0.6191, dtype=torch.float64)
8 gae_duplicate tensor(-2.1337, dtype=torch.float64) tensor(5.5905, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5607, dtype=torch.float64) delta_t tensor(-0.4562, dtype=torch.float64)
7 gae_duplicate tensor(-2.0874, dtype=torch.float64) tensor(4.1830, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2523, dtype=torch.float64) delta_t tensor(-1.2068, dtype=torch.float64)
6 gae_duplicate tensor(-4.2632, dtype=torch.float64) tensor(11.6112, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2070, dtype=torch.float64) delta_t tensor(-0.6045, dtype=torch.float64)
5 gae_duplicate tensor(-5.8984, dtype=torch.float64) tensor(2.6310, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5476, dtype=torch.float64) delta_t tensor(-0.2120, dtype=torch.float64)
4 gae_duplicate tensor(-6.6573, dtype=torch.float64) tensor(-0.2240, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3378, dtype=torch.float64) delta_t tensor(0.3815, dtype=torch.float64)
3 gae_duplicate tensor(-4.7075, dtype=torch.float64) tensor(2.2994, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1529, dtype=torch.float64) delta_t tensor(-0.3300, dtype=torch.float64)
2 gae_duplicate tensor(-3.4625, dtype=torch.float64) tensor(18.1825, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-821.4489135742188
value loss:558.7691650390625
entropies:68.77909088134766
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.2475221157073975 seconds
19 rew tensor(0.6720, dtype=torch.float64) delta_t tensor(-0.5938, dtype=torch.float64)
19 gae_duplicate tensor(-1.0104, dtype=torch.float64) tensor(1.8281, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6097, dtype=torch.float64) delta_t tensor(0.3105, dtype=torch.float64)
18 gae_duplicate tensor(-0.7726, dtype=torch.float64) tensor(2.5239, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4617, dtype=torch.float64) delta_t tensor(0.1139, dtype=torch.float64)
17 gae_duplicate tensor(-1.0702, dtype=torch.float64) tensor(0.0278, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0167, dtype=torch.float64) delta_t tensor(-0.0879, dtype=torch.float64)
16 gae_duplicate tensor(-1.4101, dtype=torch.float64) tensor(0.0655, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0807, dtype=torch.float64) delta_t tensor(0.2929, dtype=torch.float64)
15 gae_duplicate tensor(-1.1769, dtype=torch.float64) tensor(-0.1865, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7346, dtype=torch.float64) delta_t tensor(0.3522, dtype=torch.float64)
14 gae_duplicate tensor(-1.1291, dtype=torch.float64) tensor(-6.9529, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7425, dtype=torch.float64) delta_t tensor(0.6347, dtype=torch.float64)
13 gae_duplicate tensor(-0.3621, dtype=torch.float64) tensor(-0.9531, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3966, dtype=torch.float64) delta_t tensor(0.4098, dtype=torch.float64)
12 gae_duplicate tensor(0.0496, dtype=torch.float64) tensor(-1.3797, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5530, dtype=torch.float64) delta_t tensor(0.1363, dtype=torch.float64)
11 gae_duplicate tensor(-0.5683, dtype=torch.float64) tensor(-9.8983, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4201, dtype=torch.float64) delta_t tensor(0.0638, dtype=torch.float64)
10 gae_duplicate tensor(-0.4445, dtype=torch.float64) tensor(-3.5054, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4583, dtype=torch.float64) delta_t tensor(-0.4643, dtype=torch.float64)
9 gae_duplicate tensor(-1.3038, dtype=torch.float64) tensor(0.9553, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2350, dtype=torch.float64) delta_t tensor(-0.6409, dtype=torch.float64)
8 gae_duplicate tensor(-1.7998, dtype=torch.float64) tensor(-1.4762, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5136, dtype=torch.float64) delta_t tensor(-0.3579, dtype=torch.float64)
7 gae_duplicate tensor(-2.3574, dtype=torch.float64) tensor(0.5765, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4254, dtype=torch.float64) delta_t tensor(-0.2667, dtype=torch.float64)
6 gae_duplicate tensor(-3.1797, dtype=torch.float64) tensor(0.7257, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7119, dtype=torch.float64) delta_t tensor(-0.1565, dtype=torch.float64)
5 gae_duplicate tensor(-4.0088, dtype=torch.float64) tensor(4.5924, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9509, dtype=torch.float64) delta_t tensor(-1.3495, dtype=torch.float64)
4 gae_duplicate tensor(-7.8339, dtype=torch.float64) tensor(1.9676, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3291, dtype=torch.float64) delta_t tensor(-0.0125, dtype=torch.float64)
3 gae_duplicate tensor(-6.2812, dtype=torch.float64) tensor(1.4272, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2234, dtype=torch.float64) delta_t tensor(-0.3932, dtype=torch.float64)
2 gae_duplicate tensor(-4.6247, dtype=torch.float64) tensor(20.3367, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-396.21942138671875
value loss:529.14892578125
entropies:66.28020477294922
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1203.5909)
ToM Target loss= tensor(1820.8711)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.8053200244903564 seconds
19 rew tensor(0.6803, dtype=torch.float64) delta_t tensor(-0.8402, dtype=torch.float64)
19 gae_duplicate tensor(-1.5078, dtype=torch.float64) tensor(0.7191, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6179, dtype=torch.float64) delta_t tensor(0.6891, dtype=torch.float64)
18 gae_duplicate tensor(-0.7198, dtype=torch.float64) tensor(0.8636, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4544, dtype=torch.float64) delta_t tensor(0.0382, dtype=torch.float64)
17 gae_duplicate tensor(-1.2142, dtype=torch.float64) tensor(5.5439, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2286, dtype=torch.float64) delta_t tensor(0.3076, dtype=torch.float64)
16 gae_duplicate tensor(-1.6871, dtype=torch.float64) tensor(-1.3769, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2618, dtype=torch.float64) delta_t tensor(0.2075, dtype=torch.float64)
15 gae_duplicate tensor(-0.6695, dtype=torch.float64) tensor(-0.4289, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6465, dtype=torch.float64) delta_t tensor(0.2768, dtype=torch.float64)
14 gae_duplicate tensor(-0.0191, dtype=torch.float64) tensor(-3.9118, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1245, dtype=torch.float64) delta_t tensor(-0.3324, dtype=torch.float64)
13 gae_duplicate tensor(-3.5174, dtype=torch.float64) tensor(-0.1923, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3720, dtype=torch.float64) delta_t tensor(-0.5805, dtype=torch.float64)
12 gae_duplicate tensor(-2.5479, dtype=torch.float64) tensor(0.4098, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0601, dtype=torch.float64) delta_t tensor(-0.2778, dtype=torch.float64)
11 gae_duplicate tensor(-2.5563, dtype=torch.float64) tensor(0.6749, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1842, dtype=torch.float64) delta_t tensor(-0.2476, dtype=torch.float64)
10 gae_duplicate tensor(-3.4161, dtype=torch.float64) tensor(-3.7394, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4985, dtype=torch.float64) delta_t tensor(-0.2761, dtype=torch.float64)
9 gae_duplicate tensor(-2.1078, dtype=torch.float64) tensor(0.9667, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0586, dtype=torch.float64) delta_t tensor(-0.2989, dtype=torch.float64)
8 gae_duplicate tensor(-2.7380, dtype=torch.float64) tensor(5.7024, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5225, dtype=torch.float64) delta_t tensor(0.1155, dtype=torch.float64)
7 gae_duplicate tensor(-2.7468, dtype=torch.float64) tensor(9.1718, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1712, dtype=torch.float64) delta_t tensor(-0.1786, dtype=torch.float64)
6 gae_duplicate tensor(-3.8355, dtype=torch.float64) tensor(0.8183, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3639, dtype=torch.float64) delta_t tensor(-0.4733, dtype=torch.float64)
5 gae_duplicate tensor(-5.2979, dtype=torch.float64) tensor(0.9054, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3665, dtype=torch.float64) delta_t tensor(0.5391, dtype=torch.float64)
4 gae_duplicate tensor(-4.0895, dtype=torch.float64) tensor(-0.3926, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5805, dtype=torch.float64) delta_t tensor(-0.0535, dtype=torch.float64)
3 gae_duplicate tensor(-3.1739, dtype=torch.float64) tensor(0.1710, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0827, dtype=torch.float64) delta_t tensor(-0.4186, dtype=torch.float64)
2 gae_duplicate tensor(-2.1445, dtype=torch.float64) tensor(2.7636, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-684.1243896484375
value loss:312.17169189453125
entropies:66.9543228149414
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.949854135513306 seconds
19 rew tensor(0.6877, dtype=torch.float64) delta_t tensor(-0.0475, dtype=torch.float64)
19 gae_duplicate tensor(-1.1159, dtype=torch.float64) tensor(-1.1516, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6722, dtype=torch.float64) delta_t tensor(0.4822, dtype=torch.float64)
18 gae_duplicate tensor(-0.5460, dtype=torch.float64) tensor(-1.0378, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6252, dtype=torch.float64) delta_t tensor(0.4484, dtype=torch.float64)
17 gae_duplicate tensor(-0.2642, dtype=torch.float64) tensor(-5.3130, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5389, dtype=torch.float64) delta_t tensor(0.2943, dtype=torch.float64)
16 gae_duplicate tensor(-0.6329, dtype=torch.float64) tensor(-4.3307, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3663, dtype=torch.float64) delta_t tensor(0.2271, dtype=torch.float64)
15 gae_duplicate tensor(-0.3926, dtype=torch.float64) tensor(-10.2740, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6883, dtype=torch.float64) delta_t tensor(0.4320, dtype=torch.float64)
14 gae_duplicate tensor(-0.4061, dtype=torch.float64) tensor(-6.7627, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5797, dtype=torch.float64) delta_t tensor(0.3754, dtype=torch.float64)
13 gae_duplicate tensor(0.2830, dtype=torch.float64) tensor(-2.2072, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1780, dtype=torch.float64) delta_t tensor(0.0579, dtype=torch.float64)
12 gae_duplicate tensor(-0.4960, dtype=torch.float64) tensor(-1.2065, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2457, dtype=torch.float64) delta_t tensor(0.1814, dtype=torch.float64)
11 gae_duplicate tensor(-0.4455, dtype=torch.float64) tensor(1.6423, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2071, dtype=torch.float64) delta_t tensor(-0.1849, dtype=torch.float64)
10 gae_duplicate tensor(-0.5381, dtype=torch.float64) tensor(-0.6575, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0537, dtype=torch.float64) delta_t tensor(-0.1716, dtype=torch.float64)
9 gae_duplicate tensor(-1.3940, dtype=torch.float64) tensor(-0.2239, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1833, dtype=torch.float64) delta_t tensor(-0.2939, dtype=torch.float64)
8 gae_duplicate tensor(-1.3798, dtype=torch.float64) tensor(-1.5286, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6964, dtype=torch.float64) delta_t tensor(-0.3221, dtype=torch.float64)
7 gae_duplicate tensor(-2.1742, dtype=torch.float64) tensor(-1.0601, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0339, dtype=torch.float64) delta_t tensor(-0.2239, dtype=torch.float64)
6 gae_duplicate tensor(-3.4089, dtype=torch.float64) tensor(-0.3352, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8528, dtype=torch.float64) delta_t tensor(-0.2435, dtype=torch.float64)
5 gae_duplicate tensor(-3.5766, dtype=torch.float64) tensor(1.5284, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8809, dtype=torch.float64) delta_t tensor(-0.1959, dtype=torch.float64)
4 gae_duplicate tensor(-9.0377, dtype=torch.float64) tensor(15.8839, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6216, dtype=torch.float64) delta_t tensor(-0.2602, dtype=torch.float64)
3 gae_duplicate tensor(-6.4838, dtype=torch.float64) tensor(14.3139, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1011, dtype=torch.float64) delta_t tensor(-0.4146, dtype=torch.float64)
2 gae_duplicate tensor(-4.8008, dtype=torch.float64) tensor(3.8833, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-54.153194427490234
value loss:457.0346374511719
entropies:68.20062255859375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.834673166275024 seconds
19 rew tensor(0.7032, dtype=torch.float64) delta_t tensor(-0.5999, dtype=torch.float64)
19 gae_duplicate tensor(-0.9771, dtype=torch.float64) tensor(0.5427, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6559, dtype=torch.float64) delta_t tensor(0.4114, dtype=torch.float64)
18 gae_duplicate tensor(-0.4447, dtype=torch.float64) tensor(0.0608, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5540, dtype=torch.float64) delta_t tensor(0.2567, dtype=torch.float64)
17 gae_duplicate tensor(-0.1837, dtype=torch.float64) tensor(-0.0749, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3656, dtype=torch.float64) delta_t tensor(0.1912, dtype=torch.float64)
16 gae_duplicate tensor(-0.1739, dtype=torch.float64) tensor(-2.7701, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0360, dtype=torch.float64) delta_t tensor(0.2920, dtype=torch.float64)
15 gae_duplicate tensor(-0.7044, dtype=torch.float64) tensor(-1.8295, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6956, dtype=torch.float64) delta_t tensor(0.6518, dtype=torch.float64)
14 gae_duplicate tensor(-0.1362, dtype=torch.float64) tensor(-1.2200, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7348, dtype=torch.float64) delta_t tensor(0.8226, dtype=torch.float64)
13 gae_duplicate tensor(1.0327, dtype=torch.float64) tensor(-1.8934, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.6076, dtype=torch.float64) delta_t tensor(-0.8084, dtype=torch.float64)
12 gae_duplicate tensor(-5.4066, dtype=torch.float64) tensor(15.4764, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4427, dtype=torch.float64) delta_t tensor(-0.3190, dtype=torch.float64)
11 gae_duplicate tensor(-3.7567, dtype=torch.float64) tensor(-9.2093, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3522, dtype=torch.float64) delta_t tensor(-1.2659, dtype=torch.float64)
10 gae_duplicate tensor(-3.1638, dtype=torch.float64) tensor(-8.6047, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1864, dtype=torch.float64) delta_t tensor(-1.3538, dtype=torch.float64)
9 gae_duplicate tensor(-4.6736, dtype=torch.float64) tensor(13.5735, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4065, dtype=torch.float64) delta_t tensor(-0.2871, dtype=torch.float64)
8 gae_duplicate tensor(-3.7870, dtype=torch.float64) tensor(2.4401, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1244, dtype=torch.float64) delta_t tensor(-0.1930, dtype=torch.float64)
7 gae_duplicate tensor(-3.2142, dtype=torch.float64) tensor(7.6333, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0806, dtype=torch.float64) delta_t tensor(0.1131, dtype=torch.float64)
6 gae_duplicate tensor(-2.7236, dtype=torch.float64) tensor(1.6434, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6113, dtype=torch.float64) delta_t tensor(-0.0043, dtype=torch.float64)
5 gae_duplicate tensor(-2.7039, dtype=torch.float64) tensor(1.2679, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9855, dtype=torch.float64) delta_t tensor(-0.5303, dtype=torch.float64)
4 gae_duplicate tensor(-8.7636, dtype=torch.float64) tensor(1.2557, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1630, dtype=torch.float64) delta_t tensor(0.4577, dtype=torch.float64)
3 gae_duplicate tensor(-5.9389, dtype=torch.float64) tensor(18.4183, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1086, dtype=torch.float64) delta_t tensor(-0.2675, dtype=torch.float64)
2 gae_duplicate tensor(-4.5330, dtype=torch.float64) tensor(0.7437, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1361.009521484375
value loss:639.3723754882812
entropies:70.41766357421875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.673151969909668 seconds
19 rew tensor(0.7268, dtype=torch.float64) delta_t tensor(-0.5645, dtype=torch.float64)
19 gae_duplicate tensor(-0.7209, dtype=torch.float64) tensor(3.4737, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7270, dtype=torch.float64) delta_t tensor(0.5703, dtype=torch.float64)
18 gae_duplicate tensor(-0.1999, dtype=torch.float64) tensor(-0.1026, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6963, dtype=torch.float64) delta_t tensor(0.5093, dtype=torch.float64)
17 gae_duplicate tensor(0.2101, dtype=torch.float64) tensor(-1.0009, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6579, dtype=torch.float64) delta_t tensor(0.4515, dtype=torch.float64)
16 gae_duplicate tensor(0.3541, dtype=torch.float64) tensor(-10.1380, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4144, dtype=torch.float64) delta_t tensor(0.2770, dtype=torch.float64)
15 gae_duplicate tensor(0.0635, dtype=torch.float64) tensor(-1.8537, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7032, dtype=torch.float64) delta_t tensor(0.5900, dtype=torch.float64)
14 gae_duplicate tensor(0.6694, dtype=torch.float64) tensor(-3.3271, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4496, dtype=torch.float64) delta_t tensor(0.3012, dtype=torch.float64)
13 gae_duplicate tensor(0.1451, dtype=torch.float64) tensor(-1.8081, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1797, dtype=torch.float64) delta_t tensor(-0.3511, dtype=torch.float64)
12 gae_duplicate tensor(-1.1358, dtype=torch.float64) tensor(-2.7896, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.4433, dtype=torch.float64) delta_t tensor(-1.5687, dtype=torch.float64)
11 gae_duplicate tensor(-3.8784, dtype=torch.float64) tensor(10.4497, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1114, dtype=torch.float64) delta_t tensor(-0.5283, dtype=torch.float64)
10 gae_duplicate tensor(-4.2249, dtype=torch.float64) tensor(2.3698, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1114, dtype=torch.float64) delta_t tensor(0.1664, dtype=torch.float64)
9 gae_duplicate tensor(-4.1664, dtype=torch.float64) tensor(0.7841, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0275, dtype=torch.float64) delta_t tensor(0.2015, dtype=torch.float64)
8 gae_duplicate tensor(-2.6180, dtype=torch.float64) tensor(6.6128, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2114, dtype=torch.float64) delta_t tensor(-0.1671, dtype=torch.float64)
7 gae_duplicate tensor(-2.1163, dtype=torch.float64) tensor(8.9832, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1249, dtype=torch.float64) delta_t tensor(0.3068, dtype=torch.float64)
6 gae_duplicate tensor(-1.4624, dtype=torch.float64) tensor(3.8251, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2690, dtype=torch.float64) delta_t tensor(-0.0306, dtype=torch.float64)
5 gae_duplicate tensor(-0.8206, dtype=torch.float64) tensor(-0.9148, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0466, dtype=torch.float64) delta_t tensor(-0.4757, dtype=torch.float64)
4 gae_duplicate tensor(-6.9734, dtype=torch.float64) tensor(0.8721, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1202, dtype=torch.float64) delta_t tensor(0.3236, dtype=torch.float64)
3 gae_duplicate tensor(-5.6213, dtype=torch.float64) tensor(-1.3152, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2016, dtype=torch.float64) delta_t tensor(-0.1502, dtype=torch.float64)
2 gae_duplicate tensor(-4.0702, dtype=torch.float64) tensor(0.2970, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-531.434814453125
value loss:408.402099609375
entropies:68.94536590576172
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.925263166427612 seconds
19 rew tensor(0.7027, dtype=torch.float64) delta_t tensor(-0.4718, dtype=torch.float64)
19 gae_duplicate tensor(-0.9155, dtype=torch.float64) tensor(2.1298, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6870, dtype=torch.float64) delta_t tensor(0.4853, dtype=torch.float64)
18 gae_duplicate tensor(-0.3205, dtype=torch.float64) tensor(-0.1324, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6235, dtype=torch.float64) delta_t tensor(0.3298, dtype=torch.float64)
17 gae_duplicate tensor(0.0221, dtype=torch.float64) tensor(-0.4340, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4803, dtype=torch.float64) delta_t tensor(-0.0076, dtype=torch.float64)
16 gae_duplicate tensor(-0.3217, dtype=torch.float64) tensor(-0.3173, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2656, dtype=torch.float64) delta_t tensor(0.2630, dtype=torch.float64)
15 gae_duplicate tensor(-0.9531, dtype=torch.float64) tensor(-6.3721, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2410, dtype=torch.float64) delta_t tensor(0.0382, dtype=torch.float64)
14 gae_duplicate tensor(-1.7865, dtype=torch.float64) tensor(-1.5486, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7194, dtype=torch.float64) delta_t tensor(0.5043, dtype=torch.float64)
13 gae_duplicate tensor(-0.8767, dtype=torch.float64) tensor(-1.3111, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6878, dtype=torch.float64) delta_t tensor(0.5396, dtype=torch.float64)
12 gae_duplicate tensor(0.0888, dtype=torch.float64) tensor(-1.1703, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3275, dtype=torch.float64) delta_t tensor(-0.3787, dtype=torch.float64)
11 gae_duplicate tensor(-0.9466, dtype=torch.float64) tensor(-0.6757, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0795, dtype=torch.float64) delta_t tensor(-0.4498, dtype=torch.float64)
10 gae_duplicate tensor(-2.8029, dtype=torch.float64) tensor(15.2045, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5918, dtype=torch.float64) delta_t tensor(-0.9201, dtype=torch.float64)
9 gae_duplicate tensor(-3.0899, dtype=torch.float64) tensor(0.8128, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9309, dtype=torch.float64) delta_t tensor(-0.7234, dtype=torch.float64)
8 gae_duplicate tensor(-5.0175, dtype=torch.float64) tensor(-0.4152, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5115, dtype=torch.float64) delta_t tensor(-0.6637, dtype=torch.float64)
7 gae_duplicate tensor(-4.9368, dtype=torch.float64) tensor(10.0359, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4330, dtype=torch.float64) delta_t tensor(0.0727, dtype=torch.float64)
6 gae_duplicate tensor(-4.0084, dtype=torch.float64) tensor(19.7419, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0244, dtype=torch.float64) delta_t tensor(-0.6540, dtype=torch.float64)
5 gae_duplicate tensor(-5.6069, dtype=torch.float64) tensor(20.9341, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1355, dtype=torch.float64) delta_t tensor(0.2292, dtype=torch.float64)
4 gae_duplicate tensor(-5.4161, dtype=torch.float64) tensor(1.1222, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1715, dtype=torch.float64) delta_t tensor(0.4529, dtype=torch.float64)
3 gae_duplicate tensor(-3.4495, dtype=torch.float64) tensor(2.7411, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2399, dtype=torch.float64) delta_t tensor(-0.2587, dtype=torch.float64)
2 gae_duplicate tensor(-2.4165, dtype=torch.float64) tensor(8.0547, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2474.732177734375
value loss:449.9833679199219
entropies:68.45449829101562
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1178.4904)
ToM Target loss= tensor(1821.8264)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.107375144958496 seconds
19 rew tensor(0.7344, dtype=torch.float64) delta_t tensor(0.3151, dtype=torch.float64)
19 gae_duplicate tensor(-0.5436, dtype=torch.float64) tensor(-3.7003, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7424, dtype=torch.float64) delta_t tensor(0.9215, dtype=torch.float64)
18 gae_duplicate tensor(0.1937, dtype=torch.float64) tensor(-1.5180, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6321, dtype=torch.float64) delta_t tensor(0.5448, dtype=torch.float64)
17 gae_duplicate tensor(0.2399, dtype=torch.float64) tensor(-2.6633, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5848, dtype=torch.float64) delta_t tensor(0.3855, dtype=torch.float64)
16 gae_duplicate tensor(0.1058, dtype=torch.float64) tensor(-8.6541, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4981, dtype=torch.float64) delta_t tensor(0.1506, dtype=torch.float64)
15 gae_duplicate tensor(-0.0652, dtype=torch.float64) tensor(-9.2473, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6169, dtype=torch.float64) delta_t tensor(0.4072, dtype=torch.float64)
14 gae_duplicate tensor(-0.5563, dtype=torch.float64) tensor(-1.5558, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5547, dtype=torch.float64) delta_t tensor(0.1299, dtype=torch.float64)
13 gae_duplicate tensor(-1.2090, dtype=torch.float64) tensor(-8.3280, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0135, dtype=torch.float64) delta_t tensor(-0.0691, dtype=torch.float64)
12 gae_duplicate tensor(-0.6159, dtype=torch.float64) tensor(-10.2030, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0465, dtype=torch.float64) delta_t tensor(0.0956, dtype=torch.float64)
11 gae_duplicate tensor(-2.8191, dtype=torch.float64) tensor(0.5481, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3053, dtype=torch.float64) delta_t tensor(-0.6548, dtype=torch.float64)
10 gae_duplicate tensor(-2.6575, dtype=torch.float64) tensor(4.8496, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4175, dtype=torch.float64) delta_t tensor(-0.6534, dtype=torch.float64)
9 gae_duplicate tensor(-4.5994, dtype=torch.float64) tensor(-0.7284, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4032, dtype=torch.float64) delta_t tensor(-0.1598, dtype=torch.float64)
8 gae_duplicate tensor(-2.5397, dtype=torch.float64) tensor(0.7333, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2804, dtype=torch.float64) delta_t tensor(-0.4644, dtype=torch.float64)
7 gae_duplicate tensor(-2.5324, dtype=torch.float64) tensor(5.3103, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3473, dtype=torch.float64) delta_t tensor(0.0699, dtype=torch.float64)
6 gae_duplicate tensor(-3.9410, dtype=torch.float64) tensor(1.1047, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7886, dtype=torch.float64) delta_t tensor(-0.3718, dtype=torch.float64)
5 gae_duplicate tensor(-4.9145, dtype=torch.float64) tensor(0.3256, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6581, dtype=torch.float64) delta_t tensor(-0.6528, dtype=torch.float64)
4 gae_duplicate tensor(-8.0949, dtype=torch.float64) tensor(8.6317, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3245, dtype=torch.float64) delta_t tensor(-0.3244, dtype=torch.float64)
3 gae_duplicate tensor(-6.1774, dtype=torch.float64) tensor(1.5097, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1767, dtype=torch.float64) delta_t tensor(-0.1596, dtype=torch.float64)
2 gae_duplicate tensor(-4.8658, dtype=torch.float64) tensor(3.6006, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:706.6026611328125
value loss:696.5985107421875
entropies:71.36537170410156
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.587451934814453 seconds
19 rew tensor(0.7184, dtype=torch.float64) delta_t tensor(-0.3156, dtype=torch.float64)
19 gae_duplicate tensor(-0.8623, dtype=torch.float64) tensor(0.2783, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6947, dtype=torch.float64) delta_t tensor(0.4945, dtype=torch.float64)
18 gae_duplicate tensor(-0.3370, dtype=torch.float64) tensor(0.8260, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6471, dtype=torch.float64) delta_t tensor(0.4519, dtype=torch.float64)
17 gae_duplicate tensor(-0.1061, dtype=torch.float64) tensor(-1.7810, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5201, dtype=torch.float64) delta_t tensor(0.2399, dtype=torch.float64)
16 gae_duplicate tensor(-0.1337, dtype=torch.float64) tensor(-0.3909, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3614, dtype=torch.float64) delta_t tensor(0.2955, dtype=torch.float64)
15 gae_duplicate tensor(-0.5050, dtype=torch.float64) tensor(0.7127, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5926, dtype=torch.float64) delta_t tensor(0.3792, dtype=torch.float64)
14 gae_duplicate tensor(0.1455, dtype=torch.float64) tensor(-4.3343, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3880, dtype=torch.float64) delta_t tensor(0.3039, dtype=torch.float64)
13 gae_duplicate tensor(-0.7835, dtype=torch.float64) tensor(-1.0542, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-1.0175, dtype=torch.float64) delta_t tensor(-0.8677, dtype=torch.float64)
12 gae_duplicate tensor(-6.6782, dtype=torch.float64) tensor(0.0560, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3926, dtype=torch.float64) delta_t tensor(-0.5763, dtype=torch.float64)
11 gae_duplicate tensor(-5.8246, dtype=torch.float64) tensor(-4.0958, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2696, dtype=torch.float64) delta_t tensor(-0.0048, dtype=torch.float64)
10 gae_duplicate tensor(-4.3165, dtype=torch.float64) tensor(0.2048, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6895, dtype=torch.float64) delta_t tensor(-0.6940, dtype=torch.float64)
9 gae_duplicate tensor(-3.0885, dtype=torch.float64) tensor(-0.0447, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1703, dtype=torch.float64) delta_t tensor(-0.3766, dtype=torch.float64)
8 gae_duplicate tensor(-3.1445, dtype=torch.float64) tensor(8.2117, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2530, dtype=torch.float64) delta_t tensor(-0.1174, dtype=torch.float64)
7 gae_duplicate tensor(-2.0816, dtype=torch.float64) tensor(2.7459, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0266, dtype=torch.float64) delta_t tensor(0.1844, dtype=torch.float64)
6 gae_duplicate tensor(-1.3221, dtype=torch.float64) tensor(3.2483, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8426, dtype=torch.float64) delta_t tensor(-0.2466, dtype=torch.float64)
5 gae_duplicate tensor(-1.7426, dtype=torch.float64) tensor(0.5368, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6938, dtype=torch.float64) delta_t tensor(-0.3480, dtype=torch.float64)
4 gae_duplicate tensor(-5.4029, dtype=torch.float64) tensor(1.1970, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3910, dtype=torch.float64) delta_t tensor(0.2949, dtype=torch.float64)
3 gae_duplicate tensor(-3.9949, dtype=torch.float64) tensor(-1.1940, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0824, dtype=torch.float64) delta_t tensor(-0.2888, dtype=torch.float64)
2 gae_duplicate tensor(-3.0839, dtype=torch.float64) tensor(-0.3882, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-182.32472229003906
value loss:471.6140441894531
entropies:66.04542541503906
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.07402491569519 seconds
19 rew tensor(0.6954, dtype=torch.float64) delta_t tensor(-0.3043, dtype=torch.float64)
19 gae_duplicate tensor(-0.8245, dtype=torch.float64) tensor(0.2787, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6405, dtype=torch.float64) delta_t tensor(0.4797, dtype=torch.float64)
18 gae_duplicate tensor(-0.3838, dtype=torch.float64) tensor(-0.8541, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6326, dtype=torch.float64) delta_t tensor(0.1708, dtype=torch.float64)
17 gae_duplicate tensor(-0.1926, dtype=torch.float64) tensor(-1.4382, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4834, dtype=torch.float64) delta_t tensor(0.3308, dtype=torch.float64)
16 gae_duplicate tensor(0.1210, dtype=torch.float64) tensor(-0.6441, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2641, dtype=torch.float64) delta_t tensor(0.2052, dtype=torch.float64)
15 gae_duplicate tensor(-0.2415, dtype=torch.float64) tensor(-3.3157, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7110, dtype=torch.float64) delta_t tensor(0.5577, dtype=torch.float64)
14 gae_duplicate tensor(0.2749, dtype=torch.float64) tensor(-0.9962, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6875, dtype=torch.float64) delta_t tensor(0.5852, dtype=torch.float64)
13 gae_duplicate tensor(0.7084, dtype=torch.float64) tensor(-1.2831, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7041, dtype=torch.float64) delta_t tensor(0.5047, dtype=torch.float64)
12 gae_duplicate tensor(0.8641, dtype=torch.float64) tensor(-10.3271, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.6818, dtype=torch.float64) delta_t tensor(-1.3933, dtype=torch.float64)
11 gae_duplicate tensor(-3.3052, dtype=torch.float64) tensor(-4.7035, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4472, dtype=torch.float64) delta_t tensor(-0.8824, dtype=torch.float64)
10 gae_duplicate tensor(-4.2594, dtype=torch.float64) tensor(0.8213, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3230, dtype=torch.float64) delta_t tensor(-0.3136, dtype=torch.float64)
9 gae_duplicate tensor(-3.4127, dtype=torch.float64) tensor(0.6441, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1965, dtype=torch.float64) delta_t tensor(-0.4497, dtype=torch.float64)
8 gae_duplicate tensor(-2.4314, dtype=torch.float64) tensor(1.4061, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6009, dtype=torch.float64) delta_t tensor(-0.1477, dtype=torch.float64)
7 gae_duplicate tensor(-2.2771, dtype=torch.float64) tensor(8.3596, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4289, dtype=torch.float64) delta_t tensor(-0.3777, dtype=torch.float64)
6 gae_duplicate tensor(-2.8726, dtype=torch.float64) tensor(5.8404, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0282, dtype=torch.float64) delta_t tensor(-0.3320, dtype=torch.float64)
5 gae_duplicate tensor(-3.3300, dtype=torch.float64) tensor(1.4999, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9139, dtype=torch.float64) delta_t tensor(-0.3757, dtype=torch.float64)
4 gae_duplicate tensor(-4.6951, dtype=torch.float64) tensor(1.5673, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5920, dtype=torch.float64) delta_t tensor(-0.1474, dtype=torch.float64)
3 gae_duplicate tensor(-3.4538, dtype=torch.float64) tensor(1.2994, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0273, dtype=torch.float64) delta_t tensor(-0.4380, dtype=torch.float64)
2 gae_duplicate tensor(-2.9752, dtype=torch.float64) tensor(24.8266, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-839.3853759765625
value loss:471.5936584472656
entropies:66.94258117675781
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.8050291538238525 seconds
19 rew tensor(0.7337, dtype=torch.float64) delta_t tensor(-0.3932, dtype=torch.float64)
19 gae_duplicate tensor(-0.5296, dtype=torch.float64) tensor(0.3626, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7184, dtype=torch.float64) delta_t tensor(0.4388, dtype=torch.float64)
18 gae_duplicate tensor(-0.0952, dtype=torch.float64) tensor(-0.1474, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6720, dtype=torch.float64) delta_t tensor(0.4990, dtype=torch.float64)
17 gae_duplicate tensor(0.3003, dtype=torch.float64) tensor(-3.7093, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6413, dtype=torch.float64) delta_t tensor(0.4971, dtype=torch.float64)
16 gae_duplicate tensor(0.5140, dtype=torch.float64) tensor(-1.0198, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5487, dtype=torch.float64) delta_t tensor(0.4374, dtype=torch.float64)
15 gae_duplicate tensor(0.3248, dtype=torch.float64) tensor(-3.7850, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6636, dtype=torch.float64) delta_t tensor(0.4560, dtype=torch.float64)
14 gae_duplicate tensor(0.6218, dtype=torch.float64) tensor(-5.7099, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3006, dtype=torch.float64) delta_t tensor(0.1900, dtype=torch.float64)
13 gae_duplicate tensor(-0.7727, dtype=torch.float64) tensor(0.9739, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1252, dtype=torch.float64) delta_t tensor(-0.2930, dtype=torch.float64)
12 gae_duplicate tensor(-3.7125, dtype=torch.float64) tensor(-2.3013, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4451, dtype=torch.float64) delta_t tensor(0.2213, dtype=torch.float64)
11 gae_duplicate tensor(-2.4604, dtype=torch.float64) tensor(-0.7556, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3479, dtype=torch.float64) delta_t tensor(-0.1038, dtype=torch.float64)
10 gae_duplicate tensor(-1.7973, dtype=torch.float64) tensor(-0.5346, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1843, dtype=torch.float64) delta_t tensor(-1.4371, dtype=torch.float64)
9 gae_duplicate tensor(-9.2847, dtype=torch.float64) tensor(0.7858, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9070, dtype=torch.float64) delta_t tensor(-0.5675, dtype=torch.float64)
8 gae_duplicate tensor(-7.6770, dtype=torch.float64) tensor(25.9773, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0043, dtype=torch.float64) delta_t tensor(0.0511, dtype=torch.float64)
7 gae_duplicate tensor(-5.2209, dtype=torch.float64) tensor(-2.4990, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3426, dtype=torch.float64) delta_t tensor(-0.1014, dtype=torch.float64)
6 gae_duplicate tensor(-3.5584, dtype=torch.float64) tensor(18.5325, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3972, dtype=torch.float64) delta_t tensor(0.0036, dtype=torch.float64)
5 gae_duplicate tensor(-2.7899, dtype=torch.float64) tensor(7.2378, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2835, dtype=torch.float64) delta_t tensor(0.3448, dtype=torch.float64)
4 gae_duplicate tensor(-1.4987, dtype=torch.float64) tensor(0.5620, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1773, dtype=torch.float64) delta_t tensor(0.4001, dtype=torch.float64)
3 gae_duplicate tensor(-0.9865, dtype=torch.float64) tensor(-3.3896, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2238, dtype=torch.float64) delta_t tensor(-0.0940, dtype=torch.float64)
2 gae_duplicate tensor(-1.0940, dtype=torch.float64) tensor(-0.0811, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1110.49267578125
value loss:612.706298828125
entropies:69.5628662109375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.866302013397217 seconds
19 rew tensor(0.7411, dtype=torch.float64) delta_t tensor(-0.0385, dtype=torch.float64)
19 gae_duplicate tensor(-0.5059, dtype=torch.float64) tensor(1.5689, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7332, dtype=torch.float64) delta_t tensor(0.5930, dtype=torch.float64)
18 gae_duplicate tensor(0.0697, dtype=torch.float64) tensor(-0.5408, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7254, dtype=torch.float64) delta_t tensor(0.5663, dtype=torch.float64)
17 gae_duplicate tensor(0.5958, dtype=torch.float64) tensor(-2.8164, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7097, dtype=torch.float64) delta_t tensor(0.3078, dtype=torch.float64)
16 gae_duplicate tensor(0.6467, dtype=torch.float64) tensor(-4.5062, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6782, dtype=torch.float64) delta_t tensor(0.6537, dtype=torch.float64)
15 gae_duplicate tensor(0.7188, dtype=torch.float64) tensor(-5.7467, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5369, dtype=torch.float64) delta_t tensor(0.6091, dtype=torch.float64)
14 gae_duplicate tensor(1.0071, dtype=torch.float64) tensor(-1.8801, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2129, dtype=torch.float64) delta_t tensor(0.1388, dtype=torch.float64)
13 gae_duplicate tensor(-1.4129, dtype=torch.float64) tensor(-1.5696, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3231, dtype=torch.float64) delta_t tensor(-0.4320, dtype=torch.float64)
12 gae_duplicate tensor(-5.2454, dtype=torch.float64) tensor(-7.0750, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6572, dtype=torch.float64) delta_t tensor(-1.0111, dtype=torch.float64)
11 gae_duplicate tensor(-3.6206, dtype=torch.float64) tensor(0.2062, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-2.0010, dtype=torch.float64) delta_t tensor(-2.2552, dtype=torch.float64)
10 gae_duplicate tensor(-5.3831, dtype=torch.float64) tensor(2.0018, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1779, dtype=torch.float64) delta_t tensor(0.4093, dtype=torch.float64)
9 gae_duplicate tensor(-4.6484, dtype=torch.float64) tensor(1.6432, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3076, dtype=torch.float64) delta_t tensor(0.0743, dtype=torch.float64)
8 gae_duplicate tensor(-3.4900, dtype=torch.float64) tensor(9.3527, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8554, dtype=torch.float64) delta_t tensor(-0.3272, dtype=torch.float64)
7 gae_duplicate tensor(-3.1472, dtype=torch.float64) tensor(2.7644, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1879, dtype=torch.float64) delta_t tensor(-0.0179, dtype=torch.float64)
6 gae_duplicate tensor(-2.3628, dtype=torch.float64) tensor(1.2606, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9020, dtype=torch.float64) delta_t tensor(-0.1727, dtype=torch.float64)
5 gae_duplicate tensor(-2.9179, dtype=torch.float64) tensor(1.2270, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2881, dtype=torch.float64) delta_t tensor(0.5293, dtype=torch.float64)
4 gae_duplicate tensor(-5.8316, dtype=torch.float64) tensor(0.4489, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3416, dtype=torch.float64) delta_t tensor(-0.0270, dtype=torch.float64)
3 gae_duplicate tensor(-4.5266, dtype=torch.float64) tensor(0.3178, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1217, dtype=torch.float64) delta_t tensor(-0.3535, dtype=torch.float64)
2 gae_duplicate tensor(-3.4576, dtype=torch.float64) tensor(0.5529, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:87.74188995361328
value loss:667.9891357421875
entropies:70.65027618408203
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1216.3173)
ToM Target loss= tensor(1820.8302)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.830249309539795 seconds
19 rew tensor(0.7018, dtype=torch.float64) delta_t tensor(-0.3112, dtype=torch.float64)
19 gae_duplicate tensor(-0.4732, dtype=torch.float64) tensor(0.2895, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6628, dtype=torch.float64) delta_t tensor(0.3746, dtype=torch.float64)
18 gae_duplicate tensor(-0.2016, dtype=torch.float64) tensor(-0.1331, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6000, dtype=torch.float64) delta_t tensor(0.4068, dtype=torch.float64)
17 gae_duplicate tensor(0.0833, dtype=torch.float64) tensor(-0.5109, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4275, dtype=torch.float64) delta_t tensor(0.0790, dtype=torch.float64)
16 gae_duplicate tensor(-0.3670, dtype=torch.float64) tensor(-0.4680, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1765, dtype=torch.float64) delta_t tensor(0.1201, dtype=torch.float64)
15 gae_duplicate tensor(-0.8667, dtype=torch.float64) tensor(-0.4957, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7413, dtype=torch.float64) delta_t tensor(0.5164, dtype=torch.float64)
14 gae_duplicate tensor(-0.3228, dtype=torch.float64) tensor(-7.4036, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7335, dtype=torch.float64) delta_t tensor(0.6527, dtype=torch.float64)
13 gae_duplicate tensor(0.0696, dtype=torch.float64) tensor(-1.5197, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4211, dtype=torch.float64) delta_t tensor(0.5500, dtype=torch.float64)
12 gae_duplicate tensor(0.2725, dtype=torch.float64) tensor(-18.4842, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2202, dtype=torch.float64) delta_t tensor(0.2945, dtype=torch.float64)
11 gae_duplicate tensor(0.2036, dtype=torch.float64) tensor(-18.6543, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4810, dtype=torch.float64) delta_t tensor(-1.0828, dtype=torch.float64)
10 gae_duplicate tensor(-2.7735, dtype=torch.float64) tensor(6.8028, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3910, dtype=torch.float64) delta_t tensor(-1.4063, dtype=torch.float64)
9 gae_duplicate tensor(-4.2610, dtype=torch.float64) tensor(10.9408, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7348, dtype=torch.float64) delta_t tensor(-1.1702, dtype=torch.float64)
8 gae_duplicate tensor(-7.3786, dtype=torch.float64) tensor(1.8873, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2705, dtype=torch.float64) delta_t tensor(0.4716, dtype=torch.float64)
7 gae_duplicate tensor(-5.0307, dtype=torch.float64) tensor(1.2498, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3319, dtype=torch.float64) delta_t tensor(0.0857, dtype=torch.float64)
6 gae_duplicate tensor(-3.5304, dtype=torch.float64) tensor(8.5783, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9524, dtype=torch.float64) delta_t tensor(-0.0744, dtype=torch.float64)
5 gae_duplicate tensor(-2.8081, dtype=torch.float64) tensor(7.4747, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2928, dtype=torch.float64) delta_t tensor(0.9256, dtype=torch.float64)
4 gae_duplicate tensor(-1.3468, dtype=torch.float64) tensor(0.0787, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5678, dtype=torch.float64) delta_t tensor(0.1869, dtype=torch.float64)
3 gae_duplicate tensor(-0.1427, dtype=torch.float64) tensor(-2.3408, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2399, dtype=torch.float64) delta_t tensor(-0.4414, dtype=torch.float64)
2 gae_duplicate tensor(-0.7346, dtype=torch.float64) tensor(0.8692, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:413.6319885253906
value loss:450.7161865234375
entropies:69.85601043701172
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.863034009933472 seconds
19 rew tensor(0.7336, dtype=torch.float64) delta_t tensor(-0.2478, dtype=torch.float64)
19 gae_duplicate tensor(-0.4775, dtype=torch.float64) tensor(0.2415, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7029, dtype=torch.float64) delta_t tensor(0.5816, dtype=torch.float64)
18 gae_duplicate tensor(0.1400, dtype=torch.float64) tensor(-0.8007, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6875, dtype=torch.float64) delta_t tensor(0.4672, dtype=torch.float64)
17 gae_duplicate tensor(0.2777, dtype=torch.float64) tensor(-1.5017, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6490, dtype=torch.float64) delta_t tensor(0.5410, dtype=torch.float64)
16 gae_duplicate tensor(0.2985, dtype=torch.float64) tensor(-2.0737, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5720, dtype=torch.float64) delta_t tensor(0.7976, dtype=torch.float64)
15 gae_duplicate tensor(0.0242, dtype=torch.float64) tensor(-14.5863, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4892, dtype=torch.float64) delta_t tensor(0.3250, dtype=torch.float64)
14 gae_duplicate tensor(0.6319, dtype=torch.float64) tensor(-9.7909, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.3801, dtype=torch.float64) delta_t tensor(-0.3414, dtype=torch.float64)
13 gae_duplicate tensor(-2.5838, dtype=torch.float64) tensor(-1.4204, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4097, dtype=torch.float64) delta_t tensor(0.3355, dtype=torch.float64)
12 gae_duplicate tensor(-1.4545, dtype=torch.float64) tensor(-1.6405, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1571, dtype=torch.float64) delta_t tensor(-0.0391, dtype=torch.float64)
11 gae_duplicate tensor(-1.5663, dtype=torch.float64) tensor(-13.1149, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1458, dtype=torch.float64) delta_t tensor(-0.4613, dtype=torch.float64)
10 gae_duplicate tensor(-1.9697, dtype=torch.float64) tensor(-0.4362, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2559, dtype=torch.float64) delta_t tensor(-0.5383, dtype=torch.float64)
9 gae_duplicate tensor(-4.7125, dtype=torch.float64) tensor(10.4472, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2540, dtype=torch.float64) delta_t tensor(0.6248, dtype=torch.float64)
8 gae_duplicate tensor(-2.7580, dtype=torch.float64) tensor(-0.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0665, dtype=torch.float64) delta_t tensor(0.2321, dtype=torch.float64)
7 gae_duplicate tensor(-1.9364, dtype=torch.float64) tensor(6.9555, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1995, dtype=torch.float64) delta_t tensor(0.2917, dtype=torch.float64)
6 gae_duplicate tensor(-1.5145, dtype=torch.float64) tensor(-0.8564, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4117, dtype=torch.float64) delta_t tensor(-0.1937, dtype=torch.float64)
5 gae_duplicate tensor(-1.1307, dtype=torch.float64) tensor(3.1962, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3111, dtype=torch.float64) delta_t tensor(0.8729, dtype=torch.float64)
4 gae_duplicate tensor(-0.5548, dtype=torch.float64) tensor(-5.7818, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2790, dtype=torch.float64) delta_t tensor(-0.2395, dtype=torch.float64)
3 gae_duplicate tensor(0.1402, dtype=torch.float64) tensor(-4.7354, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2395, dtype=torch.float64) delta_t tensor(-0.0821, dtype=torch.float64)
2 gae_duplicate tensor(-0.0303, dtype=torch.float64) tensor(-1.1536, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1351.5338134765625
value loss:380.4325256347656
entropies:74.8434066772461
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.4226460456848145 seconds
19 rew tensor(0.6942, dtype=torch.float64) delta_t tensor(-0.2629, dtype=torch.float64)
19 gae_duplicate tensor(-0.7598, dtype=torch.float64) tensor(2.7149, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6313, dtype=torch.float64) delta_t tensor(0.5112, dtype=torch.float64)
18 gae_duplicate tensor(0.0678, dtype=torch.float64) tensor(-1.4814, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5530, dtype=torch.float64) delta_t tensor(0.2731, dtype=torch.float64)
17 gae_duplicate tensor(-0.0855, dtype=torch.float64) tensor(-4.3202, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3566, dtype=torch.float64) delta_t tensor(0.1870, dtype=torch.float64)
16 gae_duplicate tensor(-0.6104, dtype=torch.float64) tensor(-0.5263, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0428, dtype=torch.float64) delta_t tensor(-0.0196, dtype=torch.float64)
15 gae_duplicate tensor(-1.1873, dtype=torch.float64) tensor(-2.0068, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7334, dtype=torch.float64) delta_t tensor(0.5014, dtype=torch.float64)
14 gae_duplicate tensor(-0.5926, dtype=torch.float64) tensor(-6.1853, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7336, dtype=torch.float64) delta_t tensor(0.4809, dtype=torch.float64)
13 gae_duplicate tensor(-0.1166, dtype=torch.float64) tensor(-2.3426, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3700, dtype=torch.float64) delta_t tensor(-0.2213, dtype=torch.float64)
12 gae_duplicate tensor(-1.5474, dtype=torch.float64) tensor(-7.5042, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-2.8915, dtype=torch.float64) delta_t tensor(-3.1784, dtype=torch.float64)
11 gae_duplicate tensor(-6.2678, dtype=torch.float64) tensor(6.9917, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.1221, dtype=torch.float64) delta_t tensor(-1.3681, dtype=torch.float64)
10 gae_duplicate tensor(-6.8251, dtype=torch.float64) tensor(3.3693, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0642, dtype=torch.float64) delta_t tensor(-0.0838, dtype=torch.float64)
9 gae_duplicate tensor(-5.5643, dtype=torch.float64) tensor(12.0811, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1213, dtype=torch.float64) delta_t tensor(0.3353, dtype=torch.float64)
8 gae_duplicate tensor(-4.0578, dtype=torch.float64) tensor(2.0173, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1503, dtype=torch.float64) delta_t tensor(0.2401, dtype=torch.float64)
7 gae_duplicate tensor(-2.7615, dtype=torch.float64) tensor(1.8404, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0280, dtype=torch.float64) delta_t tensor(0.1929, dtype=torch.float64)
6 gae_duplicate tensor(-1.7432, dtype=torch.float64) tensor(7.0601, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3781, dtype=torch.float64) delta_t tensor(0.0686, dtype=torch.float64)
5 gae_duplicate tensor(-1.2620, dtype=torch.float64) tensor(7.1269, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0433, dtype=torch.float64) delta_t tensor(0.9000, dtype=torch.float64)
4 gae_duplicate tensor(-1.4384, dtype=torch.float64) tensor(-0.9044, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3529, dtype=torch.float64) delta_t tensor(0.0724, dtype=torch.float64)
3 gae_duplicate tensor(-0.4767, dtype=torch.float64) tensor(0.8483, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1367, dtype=torch.float64) delta_t tensor(-0.3676, dtype=torch.float64)
2 gae_duplicate tensor(-1.3599, dtype=torch.float64) tensor(-2.7209, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-590.8087158203125
value loss:641.3576049804688
entropies:70.67388153076172
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.70800518989563 seconds
19 rew tensor(0.7332, dtype=torch.float64) delta_t tensor(-0.0799, dtype=torch.float64)
19 gae_duplicate tensor(-0.6276, dtype=torch.float64) tensor(0.0812, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7253, dtype=torch.float64) delta_t tensor(0.6195, dtype=torch.float64)
18 gae_duplicate tensor(0.0770, dtype=torch.float64) tensor(-2.2903, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7016, dtype=torch.float64) delta_t tensor(0.4923, dtype=torch.float64)
17 gae_duplicate tensor(0.3957, dtype=torch.float64) tensor(-3.3194, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6307, dtype=torch.float64) delta_t tensor(0.6104, dtype=torch.float64)
16 gae_duplicate tensor(0.4093, dtype=torch.float64) tensor(-1.3800, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5357, dtype=torch.float64) delta_t tensor(0.7743, dtype=torch.float64)
15 gae_duplicate tensor(0.0484, dtype=torch.float64) tensor(-7.5694, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5450, dtype=torch.float64) delta_t tensor(0.6893, dtype=torch.float64)
14 gae_duplicate tensor(1.0981, dtype=torch.float64) tensor(-2.0602, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4340, dtype=torch.float64) delta_t tensor(0.2715, dtype=torch.float64)
13 gae_duplicate tensor(0.0338, dtype=torch.float64) tensor(-1.9004, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2286, dtype=torch.float64) delta_t tensor(0.2725, dtype=torch.float64)
12 gae_duplicate tensor(-0.6913, dtype=torch.float64) tensor(-1.9552, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1788, dtype=torch.float64) delta_t tensor(-0.1086, dtype=torch.float64)
11 gae_duplicate tensor(-0.8959, dtype=torch.float64) tensor(-1.2887, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2167, dtype=torch.float64) delta_t tensor(-0.2202, dtype=torch.float64)
10 gae_duplicate tensor(-2.1300, dtype=torch.float64) tensor(-8.6592, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5481, dtype=torch.float64) delta_t tensor(-0.7524, dtype=torch.float64)
9 gae_duplicate tensor(-4.4225, dtype=torch.float64) tensor(-8.1957, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3228, dtype=torch.float64) delta_t tensor(-0.1891, dtype=torch.float64)
8 gae_duplicate tensor(-3.7500, dtype=torch.float64) tensor(-10.5800, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2951, dtype=torch.float64) delta_t tensor(0.6001, dtype=torch.float64)
7 gae_duplicate tensor(-1.9149, dtype=torch.float64) tensor(-1.4405, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0979, dtype=torch.float64) delta_t tensor(0.2919, dtype=torch.float64)
6 gae_duplicate tensor(-1.3664, dtype=torch.float64) tensor(-0.7817, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4341, dtype=torch.float64) delta_t tensor(0.1750, dtype=torch.float64)
5 gae_duplicate tensor(-1.0234, dtype=torch.float64) tensor(-1.2901, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0414, dtype=torch.float64) delta_t tensor(0.3683, dtype=torch.float64)
4 gae_duplicate tensor(0.0654, dtype=torch.float64) tensor(-1.4183, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3248, dtype=torch.float64) delta_t tensor(0.1121, dtype=torch.float64)
3 gae_duplicate tensor(0.2707, dtype=torch.float64) tensor(-4.5476, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1614, dtype=torch.float64) delta_t tensor(-0.2841, dtype=torch.float64)
2 gae_duplicate tensor(-0.6180, dtype=torch.float64) tensor(-0.4298, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2112.6103515625
value loss:467.8448181152344
entropies:68.36420440673828
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.938257932662964 seconds
19 rew tensor(0.7017, dtype=torch.float64) delta_t tensor(-0.1868, dtype=torch.float64)
19 gae_duplicate tensor(-0.5261, dtype=torch.float64) tensor(0.1690, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6625, dtype=torch.float64) delta_t tensor(0.4829, dtype=torch.float64)
18 gae_duplicate tensor(-0.0793, dtype=torch.float64) tensor(-0.2847, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5683, dtype=torch.float64) delta_t tensor(0.3423, dtype=torch.float64)
17 gae_duplicate tensor(0.0087, dtype=torch.float64) tensor(-0.5617, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3794, dtype=torch.float64) delta_t tensor(0.2855, dtype=torch.float64)
16 gae_duplicate tensor(0.1146, dtype=torch.float64) tensor(-2.1876, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0805, dtype=torch.float64) delta_t tensor(0.1602, dtype=torch.float64)
15 gae_duplicate tensor(-0.3388, dtype=torch.float64) tensor(-1.3268, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5538, dtype=torch.float64) delta_t tensor(0.4563, dtype=torch.float64)
14 gae_duplicate tensor(0.1088, dtype=torch.float64) tensor(-1.1378, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6780, dtype=torch.float64) delta_t tensor(0.5685, dtype=torch.float64)
13 gae_duplicate tensor(0.6147, dtype=torch.float64) tensor(-4.1534, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.6297, dtype=torch.float64) delta_t tensor(-0.5316, dtype=torch.float64)
12 gae_duplicate tensor(-2.5498, dtype=torch.float64) tensor(-0.2702, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.3797, dtype=torch.float64) delta_t tensor(-1.5297, dtype=torch.float64)
11 gae_duplicate tensor(-4.9695, dtype=torch.float64) tensor(16.0017, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3493, dtype=torch.float64) delta_t tensor(-0.1056, dtype=torch.float64)
10 gae_duplicate tensor(-4.0585, dtype=torch.float64) tensor(0.8843, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1307, dtype=torch.float64) delta_t tensor(0.5576, dtype=torch.float64)
9 gae_duplicate tensor(-3.0915, dtype=torch.float64) tensor(-2.8024, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2619, dtype=torch.float64) delta_t tensor(-0.1952, dtype=torch.float64)
8 gae_duplicate tensor(-2.3567, dtype=torch.float64) tensor(0.3088, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3426, dtype=torch.float64) delta_t tensor(0.2753, dtype=torch.float64)
7 gae_duplicate tensor(-1.6318, dtype=torch.float64) tensor(-2.5098, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4666, dtype=torch.float64) delta_t tensor(0.2501, dtype=torch.float64)
6 gae_duplicate tensor(-1.1646, dtype=torch.float64) tensor(1.4645, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7039, dtype=torch.float64) delta_t tensor(0.2084, dtype=torch.float64)
5 gae_duplicate tensor(-0.9400, dtype=torch.float64) tensor(-5.3627, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2925, dtype=torch.float64) delta_t tensor(0.9446, dtype=torch.float64)
4 gae_duplicate tensor(-0.4666, dtype=torch.float64) tensor(-5.0013, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5797, dtype=torch.float64) delta_t tensor(-0.2429, dtype=torch.float64)
3 gae_duplicate tensor(-1.8393, dtype=torch.float64) tensor(-1.3315, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0667, dtype=torch.float64) delta_t tensor(-0.5216, dtype=torch.float64)
2 gae_duplicate tensor(-2.7122, dtype=torch.float64) tensor(8.4973, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-26.93979835510254
value loss:386.50152587890625
entropies:70.48758697509766
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1374.3274)
ToM Target loss= tensor(1824.4567)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.305000305175781 seconds
19 rew tensor(0.7249, dtype=torch.float64) delta_t tensor(-0.0721, dtype=torch.float64)
19 gae_duplicate tensor(-0.5978, dtype=torch.float64) tensor(-0.0765, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7172, dtype=torch.float64) delta_t tensor(0.5679, dtype=torch.float64)
18 gae_duplicate tensor(-0.0031, dtype=torch.float64) tensor(-0.6504, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6863, dtype=torch.float64) delta_t tensor(0.5357, dtype=torch.float64)
17 gae_duplicate tensor(0.3332, dtype=torch.float64) tensor(-3.0367, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6167, dtype=torch.float64) delta_t tensor(0.5278, dtype=torch.float64)
16 gae_duplicate tensor(0.2586, dtype=torch.float64) tensor(-1.4410, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5240, dtype=torch.float64) delta_t tensor(0.4891, dtype=torch.float64)
15 gae_duplicate tensor(-0.1495, dtype=torch.float64) tensor(-1.5969, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6614, dtype=torch.float64) delta_t tensor(0.6444, dtype=torch.float64)
14 gae_duplicate tensor(0.4889, dtype=torch.float64) tensor(-1.7761, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7011, dtype=torch.float64) delta_t tensor(0.6843, dtype=torch.float64)
13 gae_duplicate tensor(0.9996, dtype=torch.float64) tensor(-7.9253, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0683, dtype=torch.float64) delta_t tensor(-0.1616, dtype=torch.float64)
12 gae_duplicate tensor(-2.2936, dtype=torch.float64) tensor(-1.7348, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.1343, dtype=torch.float64) delta_t tensor(-1.0866, dtype=torch.float64)
11 gae_duplicate tensor(-2.6526, dtype=torch.float64) tensor(-7.3701, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3780, dtype=torch.float64) delta_t tensor(-0.9689, dtype=torch.float64)
10 gae_duplicate tensor(-4.4332, dtype=torch.float64) tensor(9.9743, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.3572, dtype=torch.float64) delta_t tensor(-2.1525, dtype=torch.float64)
9 gae_duplicate tensor(-6.8290, dtype=torch.float64) tensor(25.2532, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2792, dtype=torch.float64) delta_t tensor(0.0724, dtype=torch.float64)
8 gae_duplicate tensor(-5.5915, dtype=torch.float64) tensor(6.1524, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0401, dtype=torch.float64) delta_t tensor(0.4691, dtype=torch.float64)
7 gae_duplicate tensor(-3.9231, dtype=torch.float64) tensor(13.2522, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3202, dtype=torch.float64) delta_t tensor(0.1108, dtype=torch.float64)
6 gae_duplicate tensor(-2.8832, dtype=torch.float64) tensor(0.8464, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4485, dtype=torch.float64) delta_t tensor(0.0756, dtype=torch.float64)
5 gae_duplicate tensor(-2.3820, dtype=torch.float64) tensor(0.3390, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1999, dtype=torch.float64) delta_t tensor(1.0515, dtype=torch.float64)
4 gae_duplicate tensor(-1.2138, dtype=torch.float64) tensor(-5.5129, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4557, dtype=torch.float64) delta_t tensor(-0.0862, dtype=torch.float64)
3 gae_duplicate tensor(-0.5095, dtype=torch.float64) tensor(-0.6609, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1047, dtype=torch.float64) delta_t tensor(-0.5175, dtype=torch.float64)
2 gae_duplicate tensor(-1.8637, dtype=torch.float64) tensor(-0.3062, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-866.9191284179688
value loss:665.61572265625
entropies:70.31429290771484
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.042672872543335 seconds
19 rew tensor(0.7323, dtype=torch.float64) delta_t tensor(-0.3393, dtype=torch.float64)
19 gae_duplicate tensor(-0.6929, dtype=torch.float64) tensor(1.2349, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7245, dtype=torch.float64) delta_t tensor(0.4937, dtype=torch.float64)
18 gae_duplicate tensor(-0.1615, dtype=torch.float64) tensor(-2.1301, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7007, dtype=torch.float64) delta_t tensor(0.4513, dtype=torch.float64)
17 gae_duplicate tensor(0.1965, dtype=torch.float64) tensor(-0.5692, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6690, dtype=torch.float64) delta_t tensor(0.4571, dtype=torch.float64)
16 gae_duplicate tensor(0.1110, dtype=torch.float64) tensor(-0.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5818, dtype=torch.float64) delta_t tensor(0.7720, dtype=torch.float64)
15 gae_duplicate tensor(-0.2571, dtype=torch.float64) tensor(-7.7323, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7090, dtype=torch.float64) delta_t tensor(0.5078, dtype=torch.float64)
14 gae_duplicate tensor(0.2764, dtype=torch.float64) tensor(-20.1415, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6854, dtype=torch.float64) delta_t tensor(0.6105, dtype=torch.float64)
13 gae_duplicate tensor(0.7034, dtype=torch.float64) tensor(-2.4886, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7329, dtype=torch.float64) delta_t tensor(0.5595, dtype=torch.float64)
12 gae_duplicate tensor(1.0451, dtype=torch.float64) tensor(-2.7790, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1286, dtype=torch.float64) delta_t tensor(-0.2168, dtype=torch.float64)
11 gae_duplicate tensor(-1.5406, dtype=torch.float64) tensor(-2.2102, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1969, dtype=torch.float64) delta_t tensor(-0.3470, dtype=torch.float64)
10 gae_duplicate tensor(-2.0645, dtype=torch.float64) tensor(-6.5210, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2703, dtype=torch.float64) delta_t tensor(-1.3506, dtype=torch.float64)
9 gae_duplicate tensor(-2.3349, dtype=torch.float64) tensor(1.5778, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0612, dtype=torch.float64) delta_t tensor(0.3123, dtype=torch.float64)
8 gae_duplicate tensor(-1.9135, dtype=torch.float64) tensor(-0.5702, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3253, dtype=torch.float64) delta_t tensor(0.2490, dtype=torch.float64)
7 gae_duplicate tensor(-1.3546, dtype=torch.float64) tensor(-0.5010, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1393, dtype=torch.float64) delta_t tensor(0.2307, dtype=torch.float64)
6 gae_duplicate tensor(-1.0487, dtype=torch.float64) tensor(-0.1975, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0523, dtype=torch.float64) delta_t tensor(0.3008, dtype=torch.float64)
5 gae_duplicate tensor(-0.3945, dtype=torch.float64) tensor(-0.5205, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0302, dtype=torch.float64) delta_t tensor(0.7862, dtype=torch.float64)
4 gae_duplicate tensor(0.1433, dtype=torch.float64) tensor(-2.3859, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0526, dtype=torch.float64) delta_t tensor(0.5932, dtype=torch.float64)
3 gae_duplicate tensor(0.2133, dtype=torch.float64) tensor(-2.8266, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2397, dtype=torch.float64) delta_t tensor(-0.6256, dtype=torch.float64)
2 gae_duplicate tensor(-1.0864, dtype=torch.float64) tensor(-0.6877, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1798.16748046875
value loss:360.6646423339844
entropies:72.7999267578125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.537180185317993 seconds
19 rew tensor(0.7087, dtype=torch.float64) delta_t tensor(-0.5028, dtype=torch.float64)
19 gae_duplicate tensor(-0.8269, dtype=torch.float64) tensor(0.4130, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6696, dtype=torch.float64) delta_t tensor(0.4451, dtype=torch.float64)
18 gae_duplicate tensor(-0.3495, dtype=torch.float64) tensor(-0.0345, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6149, dtype=torch.float64) delta_t tensor(0.3859, dtype=torch.float64)
17 gae_duplicate tensor(0.1086, dtype=torch.float64) tensor(-0.3581, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4584, dtype=torch.float64) delta_t tensor(0.3273, dtype=torch.float64)
16 gae_duplicate tensor(0.0180, dtype=torch.float64) tensor(-0.5670, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2391, dtype=torch.float64) delta_t tensor(0.1679, dtype=torch.float64)
15 gae_duplicate tensor(-0.6301, dtype=torch.float64) tensor(-8.7460, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7325, dtype=torch.float64) delta_t tensor(0.5509, dtype=torch.float64)
14 gae_duplicate tensor(-0.0208, dtype=torch.float64) tensor(-6.3113, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7404, dtype=torch.float64) delta_t tensor(0.5547, dtype=torch.float64)
13 gae_duplicate tensor(0.4667, dtype=torch.float64) tensor(-1.1597, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2481, dtype=torch.float64) delta_t tensor(0.2419, dtype=torch.float64)
12 gae_duplicate tensor(-1.0049, dtype=torch.float64) tensor(-1.1108, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1871, dtype=torch.float64) delta_t tensor(0.0952, dtype=torch.float64)
11 gae_duplicate tensor(-0.6531, dtype=torch.float64) tensor(-7.5784, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2363, dtype=torch.float64) delta_t tensor(-0.1344, dtype=torch.float64)
10 gae_duplicate tensor(-2.2644, dtype=torch.float64) tensor(-3.0942, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7640, dtype=torch.float64) delta_t tensor(-0.8304, dtype=torch.float64)
9 gae_duplicate tensor(-2.5800, dtype=torch.float64) tensor(0.0523, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.0242, dtype=torch.float64) delta_t tensor(-2.0394, dtype=torch.float64)
8 gae_duplicate tensor(-7.7509, dtype=torch.float64) tensor(1.8463, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2275, dtype=torch.float64) delta_t tensor(0.0436, dtype=torch.float64)
7 gae_duplicate tensor(-5.4825, dtype=torch.float64) tensor(2.3460, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1788, dtype=torch.float64) delta_t tensor(0.0653, dtype=torch.float64)
6 gae_duplicate tensor(-4.4801, dtype=torch.float64) tensor(1.1162, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6674, dtype=torch.float64) delta_t tensor(-0.1374, dtype=torch.float64)
5 gae_duplicate tensor(-3.9038, dtype=torch.float64) tensor(1.9646, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3878, dtype=torch.float64) delta_t tensor(0.9684, dtype=torch.float64)
4 gae_duplicate tensor(-2.0052, dtype=torch.float64) tensor(-4.0414, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3918, dtype=torch.float64) delta_t tensor(0.3247, dtype=torch.float64)
3 gae_duplicate tensor(-2.1752, dtype=torch.float64) tensor(1.8080, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1541, dtype=torch.float64) delta_t tensor(-0.3860, dtype=torch.float64)
2 gae_duplicate tensor(-1.7162, dtype=torch.float64) tensor(4.7874, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:660.794677734375
value loss:443.04901123046875
entropies:62.421173095703125
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.527331113815308 seconds
19 rew tensor(0.7008, dtype=torch.float64) delta_t tensor(-0.4433, dtype=torch.float64)
19 gae_duplicate tensor(-0.7178, dtype=torch.float64) tensor(0.3777, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6852, dtype=torch.float64) delta_t tensor(0.4962, dtype=torch.float64)
18 gae_duplicate tensor(-0.1922, dtype=torch.float64) tensor(-1.1751, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6306, dtype=torch.float64) delta_t tensor(0.4118, dtype=torch.float64)
17 gae_duplicate tensor(0.1289, dtype=torch.float64) tensor(-0.4385, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5137, dtype=torch.float64) delta_t tensor(0.2670, dtype=torch.float64)
16 gae_duplicate tensor(0.0207, dtype=torch.float64) tensor(-0.5917, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3185, dtype=torch.float64) delta_t tensor(0.3414, dtype=torch.float64)
15 gae_duplicate tensor(-0.4719, dtype=torch.float64) tensor(-5.2000, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0726, dtype=torch.float64) delta_t tensor(0.0051, dtype=torch.float64)
14 gae_duplicate tensor(-2.6273, dtype=torch.float64) tensor(-1.0357, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6694, dtype=torch.float64) delta_t tensor(0.5479, dtype=torch.float64)
13 gae_duplicate tensor(-1.8752, dtype=torch.float64) tensor(-9.9701, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0480, dtype=torch.float64) delta_t tensor(-0.2354, dtype=torch.float64)
12 gae_duplicate tensor(-2.8477, dtype=torch.float64) tensor(-0.6630, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.2110, dtype=torch.float64) delta_t tensor(-1.1154, dtype=torch.float64)
11 gae_duplicate tensor(-5.1410, dtype=torch.float64) tensor(11.0951, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.9570, dtype=torch.float64) delta_t tensor(-2.4642, dtype=torch.float64)
10 gae_duplicate tensor(-6.5253, dtype=torch.float64) tensor(10.4320, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5183, dtype=torch.float64) delta_t tensor(-0.7372, dtype=torch.float64)
9 gae_duplicate tensor(-5.6784, dtype=torch.float64) tensor(2.8501, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0734, dtype=torch.float64) delta_t tensor(0.5446, dtype=torch.float64)
8 gae_duplicate tensor(-3.9775, dtype=torch.float64) tensor(1.7596, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4714, dtype=torch.float64) delta_t tensor(0.0967, dtype=torch.float64)
7 gae_duplicate tensor(-3.0035, dtype=torch.float64) tensor(0.5628, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0670, dtype=torch.float64) delta_t tensor(0.3374, dtype=torch.float64)
6 gae_duplicate tensor(-2.2238, dtype=torch.float64) tensor(0.7534, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0776, dtype=torch.float64) delta_t tensor(0.1972, dtype=torch.float64)
5 gae_duplicate tensor(-1.5655, dtype=torch.float64) tensor(0.9926, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0429, dtype=torch.float64) delta_t tensor(0.7258, dtype=torch.float64)
4 gae_duplicate tensor(-0.6527, dtype=torch.float64) tensor(-0.7606, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0152, dtype=torch.float64) delta_t tensor(0.5237, dtype=torch.float64)
3 gae_duplicate tensor(0.2799, dtype=torch.float64) tensor(-2.4617, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2641, dtype=torch.float64) delta_t tensor(-0.1471, dtype=torch.float64)
2 gae_duplicate tensor(-0.0664, dtype=torch.float64) tensor(-0.4777, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-230.3716278076172
value loss:570.16845703125
entropies:69.97317504882812
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.967538833618164 seconds
19 rew tensor(0.7319, dtype=torch.float64) delta_t tensor(-0.2898, dtype=torch.float64)
19 gae_duplicate tensor(-0.6645, dtype=torch.float64) tensor(0.2352, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7083, dtype=torch.float64) delta_t tensor(0.5170, dtype=torch.float64)
18 gae_duplicate tensor(-0.1821, dtype=torch.float64) tensor(-0.2304, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7004, dtype=torch.float64) delta_t tensor(0.2840, dtype=torch.float64)
17 gae_duplicate tensor(0.0480, dtype=torch.float64) tensor(-2.3850, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6450, dtype=torch.float64) delta_t tensor(0.3528, dtype=torch.float64)
16 gae_duplicate tensor(-0.1152, dtype=torch.float64) tensor(-3.7952, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5738, dtype=torch.float64) delta_t tensor(0.4525, dtype=torch.float64)
15 gae_duplicate tensor(-0.2379, dtype=torch.float64) tensor(-0.8632, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7323, dtype=torch.float64) delta_t tensor(0.7300, dtype=torch.float64)
14 gae_duplicate tensor(1.4406, dtype=torch.float64) tensor(-1.2716, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3839, dtype=torch.float64) delta_t tensor(0.1711, dtype=torch.float64)
13 gae_duplicate tensor(-0.7095, dtype=torch.float64) tensor(3.2240, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1872, dtype=torch.float64) delta_t tensor(-0.0372, dtype=torch.float64)
12 gae_duplicate tensor(-2.8009, dtype=torch.float64) tensor(-5.4151, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3442, dtype=torch.float64) delta_t tensor(0.1302, dtype=torch.float64)
11 gae_duplicate tensor(-1.8466, dtype=torch.float64) tensor(-0.9174, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.9981, dtype=torch.float64) delta_t tensor(-1.3850, dtype=torch.float64)
10 gae_duplicate tensor(-3.8418, dtype=torch.float64) tensor(0.3751, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0563, dtype=torch.float64) delta_t tensor(-0.2299, dtype=torch.float64)
9 gae_duplicate tensor(-3.1863, dtype=torch.float64) tensor(0.5502, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5589, dtype=torch.float64) delta_t tensor(-0.3038, dtype=torch.float64)
8 gae_duplicate tensor(-2.8056, dtype=torch.float64) tensor(0.8070, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2880, dtype=torch.float64) delta_t tensor(-0.4893, dtype=torch.float64)
7 gae_duplicate tensor(-2.0812, dtype=torch.float64) tensor(4.5365, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9843, dtype=torch.float64) delta_t tensor(-0.3731, dtype=torch.float64)
6 gae_duplicate tensor(-2.6001, dtype=torch.float64) tensor(10.3000, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4069, dtype=torch.float64) delta_t tensor(0.0040, dtype=torch.float64)
5 gae_duplicate tensor(-2.0289, dtype=torch.float64) tensor(8.2439, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1003, dtype=torch.float64) delta_t tensor(-0.3365, dtype=torch.float64)
4 gae_duplicate tensor(-3.9584, dtype=torch.float64) tensor(0.7454, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0964, dtype=torch.float64) delta_t tensor(0.4110, dtype=torch.float64)
3 gae_duplicate tensor(-3.6130, dtype=torch.float64) tensor(0.4739, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2874, dtype=torch.float64) delta_t tensor(-0.0423, dtype=torch.float64)
2 gae_duplicate tensor(-2.2721, dtype=torch.float64) tensor(-2.4590, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-449.36785888671875
value loss:394.64459228515625
entropies:65.62610626220703
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(1372.8080)
ToM Target loss= tensor(1824.7231)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 5.2013890743255615 seconds
19 rew tensor(0.7159, dtype=torch.float64) delta_t tensor(-0.3942, dtype=torch.float64)
19 gae_duplicate tensor(-0.5644, dtype=torch.float64) tensor(3.7969, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6765, dtype=torch.float64) delta_t tensor(0.4348, dtype=torch.float64)
18 gae_duplicate tensor(-0.1358, dtype=torch.float64) tensor(-0.0987, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6450, dtype=torch.float64) delta_t tensor(0.4905, dtype=torch.float64)
17 gae_duplicate tensor(0.1589, dtype=torch.float64) tensor(-1.3920, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5265, dtype=torch.float64) delta_t tensor(0.3482, dtype=torch.float64)
16 gae_duplicate tensor(0.1595, dtype=torch.float64) tensor(-0.6732, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3607, dtype=torch.float64) delta_t tensor(0.2979, dtype=torch.float64)
15 gae_duplicate tensor(-0.0821, dtype=torch.float64) tensor(-0.7717, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7002, dtype=torch.float64) delta_t tensor(0.7481, dtype=torch.float64)
14 gae_duplicate tensor(0.5379, dtype=torch.float64) tensor(-12.4204, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6765, dtype=torch.float64) delta_t tensor(0.6474, dtype=torch.float64)
13 gae_duplicate tensor(1.0340, dtype=torch.float64) tensor(-9.0057, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7401, dtype=torch.float64) delta_t tensor(0.4823, dtype=torch.float64)
12 gae_duplicate tensor(1.0756, dtype=torch.float64) tensor(-7.8903, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.2445, dtype=torch.float64) delta_t tensor(-1.4706, dtype=torch.float64)
11 gae_duplicate tensor(-1.4769, dtype=torch.float64) tensor(3.7581, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-2.2514, dtype=torch.float64) delta_t tensor(-2.7895, dtype=torch.float64)
10 gae_duplicate tensor(-4.5694, dtype=torch.float64) tensor(2.5777, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8964, dtype=torch.float64) delta_t tensor(-0.7976, dtype=torch.float64)
9 gae_duplicate tensor(-6.5681, dtype=torch.float64) tensor(2.7227, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1657, dtype=torch.float64) delta_t tensor(-0.1736, dtype=torch.float64)
8 gae_duplicate tensor(-4.9631, dtype=torch.float64) tensor(2.3687, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3431, dtype=torch.float64) delta_t tensor(0.3579, dtype=torch.float64)
7 gae_duplicate tensor(-3.1235, dtype=torch.float64) tensor(8.2026, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5834, dtype=torch.float64) delta_t tensor(0.2821, dtype=torch.float64)
6 gae_duplicate tensor(-1.9116, dtype=torch.float64) tensor(11.5586, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9188, dtype=torch.float64) delta_t tensor(-0.1537, dtype=torch.float64)
5 gae_duplicate tensor(-1.5988, dtype=torch.float64) tensor(1.1466, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3869, dtype=torch.float64) delta_t tensor(1.1366, dtype=torch.float64)
4 gae_duplicate tensor(-0.1923, dtype=torch.float64) tensor(-0.3488, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7382, dtype=torch.float64) delta_t tensor(-0.2489, dtype=torch.float64)
3 gae_duplicate tensor(-0.7408, dtype=torch.float64) tensor(-0.1089, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1232, dtype=torch.float64) delta_t tensor(-0.5233, dtype=torch.float64)
2 gae_duplicate tensor(-1.2317, dtype=torch.float64) tensor(1.8640, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-202.4532928466797
value loss:479.97637939453125
entropies:67.49797058105469
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 5.041682720184326 seconds
19 rew tensor(0.6694, dtype=torch.float64) delta_t tensor(-0.6465, dtype=torch.float64)
19 gae_duplicate tensor(-1.4932, dtype=torch.float64) tensor(0.9851, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6227, dtype=torch.float64) delta_t tensor(0.4429, dtype=torch.float64)
18 gae_duplicate tensor(-0.9050, dtype=torch.float64) tensor(2.9131, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4823, dtype=torch.float64) delta_t tensor(0.2386, dtype=torch.float64)
17 gae_duplicate tensor(-0.8476, dtype=torch.float64) tensor(-0.1445, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2324, dtype=torch.float64) delta_t tensor(0.2977, dtype=torch.float64)
16 gae_duplicate tensor(-0.5149, dtype=torch.float64) tensor(-2.8791, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2499, dtype=torch.float64) delta_t tensor(0.0580, dtype=torch.float64)
15 gae_duplicate tensor(-1.6111, dtype=torch.float64) tensor(-0.3232, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7159, dtype=torch.float64) delta_t tensor(0.4912, dtype=torch.float64)
14 gae_duplicate tensor(-0.8298, dtype=torch.float64) tensor(-10.6394, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0766, dtype=torch.float64) delta_t tensor(-0.1175, dtype=torch.float64)
13 gae_duplicate tensor(-0.4639, dtype=torch.float64) tensor(0.3368, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-1.5274, dtype=torch.float64) delta_t tensor(-1.7067, dtype=torch.float64)
12 gae_duplicate tensor(-5.0166, dtype=torch.float64) tensor(1.0662, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.0361, dtype=torch.float64) delta_t tensor(-0.9022, dtype=torch.float64)
11 gae_duplicate tensor(-4.7459, dtype=torch.float64) tensor(1.5916, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5906, dtype=torch.float64) delta_t tensor(0.1092, dtype=torch.float64)
10 gae_duplicate tensor(-3.4795, dtype=torch.float64) tensor(2.4951, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1119, dtype=torch.float64) delta_t tensor(-0.0819, dtype=torch.float64)
9 gae_duplicate tensor(-2.5145, dtype=torch.float64) tensor(2.8132, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2872, dtype=torch.float64) delta_t tensor(-0.4980, dtype=torch.float64)
8 gae_duplicate tensor(-2.4927, dtype=torch.float64) tensor(1.2325, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5813, dtype=torch.float64) delta_t tensor(-0.7419, dtype=torch.float64)
7 gae_duplicate tensor(-3.2635, dtype=torch.float64) tensor(1.6143, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5782, dtype=torch.float64) delta_t tensor(-0.4708, dtype=torch.float64)
6 gae_duplicate tensor(-4.1535, dtype=torch.float64) tensor(12.5012, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4959, dtype=torch.float64) delta_t tensor(0.0025, dtype=torch.float64)
5 gae_duplicate tensor(-4.2809, dtype=torch.float64) tensor(7.1969, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0045, dtype=torch.float64) delta_t tensor(-0.4720, dtype=torch.float64)
4 gae_duplicate tensor(-8.8177, dtype=torch.float64) tensor(5.1544, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0276, dtype=torch.float64) delta_t tensor(0.6399, dtype=torch.float64)
3 gae_duplicate tensor(-6.0755, dtype=torch.float64) tensor(9.3582, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1956, dtype=torch.float64) delta_t tensor(-0.0203, dtype=torch.float64)
2 gae_duplicate tensor(-4.6883, dtype=torch.float64) tensor(0.6548, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1304.5738525390625
value loss:712.82763671875
entropies:62.158103942871094
Policy training finished
---------------------
gamma: 0.8
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
training start after waiting for 4.802359104156494 seconds
19 rew tensor(0.7161, dtype=torch.float64) delta_t tensor(-0.4498, dtype=torch.float64)
19 gae_duplicate tensor(-0.6732, dtype=torch.float64) tensor(0.4000, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6613, dtype=torch.float64) delta_t tensor(0.4814, dtype=torch.float64)
18 gae_duplicate tensor(-0.1188, dtype=torch.float64) tensor(-0.1263, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6063, dtype=torch.float64) delta_t tensor(0.3034, dtype=torch.float64)
17 gae_duplicate tensor(0.0978, dtype=torch.float64) tensor(-0.3775, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4650, dtype=torch.float64) delta_t tensor(0.1682, dtype=torch.float64)
16 gae_duplicate tensor(-0.0390, dtype=torch.float64) tensor(-1.7649, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2452, dtype=torch.float64) delta_t tensor(0.5589, dtype=torch.float64)
15 gae_duplicate tensor(-0.8092, dtype=torch.float64) tensor(-1.1834, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7399, dtype=torch.float64) delta_t tensor(0.9663, dtype=torch.float64)
14 gae_duplicate tensor(1.2043, dtype=torch.float64) tensor(-1.9563, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1920, dtype=torch.float64) delta_t tensor(-0.1734, dtype=torch.float64)
13 gae_duplicate tensor(-1.9420, dtype=torch.float64) tensor(-8.0411, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3062, dtype=torch.float64) delta_t tensor(-0.3515, dtype=torch.float64)
12 gae_duplicate tensor(-3.9070, dtype=torch.float64) tensor(-5.2256, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5899, dtype=torch.float64) delta_t tensor(-0.5379, dtype=torch.float64)
11 gae_duplicate tensor(-4.2260, dtype=torch.float64) tensor(6.3026, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4196, dtype=torch.float64) delta_t tensor(-0.1220, dtype=torch.float64)
10 gae_duplicate tensor(-3.3686, dtype=torch.float64) tensor(4.4856, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0275, dtype=torch.float64) delta_t tensor(-0.0627, dtype=torch.float64)
9 gae_duplicate tensor(-2.6801, dtype=torch.float64) tensor(0.3759, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2017, dtype=torch.float64) delta_t tensor(0.1153, dtype=torch.float64)
8 gae_duplicate tensor(-1.6122, dtype=torch.float64) tensor(1.4987, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1747, dtype=torch.float64) delta_t tensor(0.1999, dtype=torch.float64)
7 gae_duplicate tensor(-0.7500, dtype=torch.float64) tensor(-2.8634, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1408, dtype=torch.float64) delta_t tensor(-0.0895, dtype=torch.float64)
6 gae_duplicate tensor(-1.6841, dtype=torch.float64) tensor(4.7347, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7188, dtype=torch.float64) delta_t tensor(0.0402, dtype=torch.float64)
5 gae_duplicate tensor(-1.9081, dtype=torch.float64) tensor(-0.0163, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7664, dtype=torch.float64) delta_t tensor(-0.2570, dtype=torch.float64)
4 gae_duplicate tensor(-5.8361, dtype=torch.float64) tensor(-1.6021, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4040, dtype=torch.float64) delta_t tensor(-0.0515, dtype=torch.float64)
3 gae_duplicate tensor(-4.3061, dtype=torch.float64) tensor(0.3215, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2492, dtype=torch.float64) delta_t tensor(-0.3299, dtype=torch.float64)
2 gae_duplicate tensor(-2.8919, dtype=torch.float64) tensor(1.9379, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:98.9024429321289
value loss:382.25604248046875
entropies:70.51187133789062
Policy training finished
---------------------
gamma: 0.8