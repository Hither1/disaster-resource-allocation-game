obs <crafter.objects.Shelter object at 0x13a4678e0> [ 0 39  0  0 39  0  0 11  0]
obs <crafter.objects.Warehouse object at 0x11c27be20> [ 0 38  0  0 40  0  0  9  0]
obs <crafter.objects.Station object at 0x13a47fcd0> [ 0  9  0  0  9  0  0 10  0]
obs <crafter.objects.Shelter object at 0x13a4678e0> [ 0 39  0  0 39  0  0  9  0]
obs <crafter.objects.Warehouse object at 0x11c27be20> [ 0 42  0  0 40  0  0  9  0]
obs <crafter.objects.Station object at 0x13a47fcd0> [ 0  9  0  0  9  0  0 10  0]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0006771087646484375 seconds
19 rew tensor(0.9101, dtype=torch.float64) delta_t tensor(0.9037, dtype=torch.float64)
19 gae_duplicate tensor(0.9037, dtype=torch.float64) tensor(-1.6406, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9547, dtype=torch.float64) delta_t tensor(0.8375, dtype=torch.float64)
18 gae_duplicate tensor(1.5605, dtype=torch.float64) tensor(-2.9172, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0066, dtype=torch.float64) delta_t tensor(0.9821, dtype=torch.float64)
17 gae_duplicate tensor(2.2305, dtype=torch.float64) tensor(-5.2408, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0682, dtype=torch.float64) delta_t tensor(1.0438, dtype=torch.float64)
16 gae_duplicate tensor(2.8282, dtype=torch.float64) tensor(-6.6625, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.1431, dtype=torch.float64) delta_t tensor(1.1059, dtype=torch.float64)
15 gae_duplicate tensor(3.3684, dtype=torch.float64) tensor(-6.2888, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.2368, dtype=torch.float64) delta_t tensor(1.1856, dtype=torch.float64)
14 gae_duplicate tensor(3.8804, dtype=torch.float64) tensor(-7.2709, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.3590, dtype=torch.float64) delta_t tensor(1.4131, dtype=torch.float64)
13 gae_duplicate tensor(4.5174, dtype=torch.float64) tensor(-8.1994, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.5278, dtype=torch.float64) delta_t tensor(1.3524, dtype=torch.float64)
12 gae_duplicate tensor(4.9664, dtype=torch.float64) tensor(-12.0863, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.2104, dtype=torch.float64) delta_t tensor(1.1504, dtype=torch.float64)
11 gae_duplicate tensor(5.1235, dtype=torch.float64) tensor(-12.4585, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(1.2632, dtype=torch.float64) delta_t tensor(1.3332, dtype=torch.float64)
10 gae_duplicate tensor(5.4320, dtype=torch.float64) tensor(-13.0616, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(1.3489, dtype=torch.float64) delta_t tensor(1.0139, dtype=torch.float64)
9 gae_duplicate tensor(5.3594, dtype=torch.float64) tensor(-9.6947, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6125, dtype=torch.float64) delta_t tensor(0.5855, dtype=torch.float64)
8 gae_duplicate tensor(4.8731, dtype=torch.float64) tensor(-8.8752, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5033, dtype=torch.float64) delta_t tensor(-0.5706, dtype=torch.float64)
7 gae_duplicate tensor(3.3278, dtype=torch.float64) tensor(-8.0981, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7443, dtype=torch.float64) delta_t tensor(-0.7451, dtype=torch.float64)
6 gae_duplicate tensor(1.9172, dtype=torch.float64) tensor(-3.4801, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.8069, dtype=torch.float64) delta_t tensor(0.7090, dtype=torch.float64)
5 gae_duplicate tensor(2.2427, dtype=torch.float64) tensor(-5.4708, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2257, dtype=torch.float64) delta_t tensor(-1.3698, dtype=torch.float64)
4 gae_duplicate tensor(0.4244, dtype=torch.float64) tensor(-0.7705, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4853, dtype=torch.float64) delta_t tensor(-1.4982, dtype=torch.float64)
3 gae_duplicate tensor(-1.1587, dtype=torch.float64) tensor(2.1542, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2182, dtype=torch.float64) delta_t tensor(0.3026, dtype=torch.float64)
2 gae_duplicate tensor(-0.6244, dtype=torch.float64) tensor(1.1373, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:652.4457397460938
value loss:326.43060302734375
entropies:36.70709228515625
Policy training finished
---------------------
gamma: 0.8
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 4.58307671546936 seconds
19 rew tensor(0.8942, dtype=torch.float64) delta_t tensor(0.7332, dtype=torch.float64)
19 gae_duplicate tensor(0.7332, dtype=torch.float64) tensor(-1.5662, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9150, dtype=torch.float64) delta_t tensor(0.8828, dtype=torch.float64)
18 gae_duplicate tensor(1.4693, dtype=torch.float64) tensor(-3.1388, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9373, dtype=torch.float64) delta_t tensor(0.9051, dtype=torch.float64)
17 gae_duplicate tensor(2.0805, dtype=torch.float64) tensor(-4.4559, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9613, dtype=torch.float64) delta_t tensor(0.9194, dtype=torch.float64)
16 gae_duplicate tensor(2.5838, dtype=torch.float64) tensor(-5.2453, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9873, dtype=torch.float64) delta_t tensor(0.9448, dtype=torch.float64)
15 gae_duplicate tensor(3.0119, dtype=torch.float64) tensor(-6.4088, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0156, dtype=torch.float64) delta_t tensor(1.0180, dtype=torch.float64)
14 gae_duplicate tensor(3.4275, dtype=torch.float64) tensor(-6.6711, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0464, dtype=torch.float64) delta_t tensor(0.7872, dtype=torch.float64)
13 gae_duplicate tensor(3.5292, dtype=torch.float64) tensor(-8.0865, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6153, dtype=torch.float64) delta_t tensor(0.5989, dtype=torch.float64)
12 gae_duplicate tensor(3.4223, dtype=torch.float64) tensor(-6.5666, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4749, dtype=torch.float64) delta_t tensor(0.5283, dtype=torch.float64)
11 gae_duplicate tensor(3.2662, dtype=torch.float64) tensor(-6.3423, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4840, dtype=torch.float64) delta_t tensor(0.5044, dtype=torch.float64)
10 gae_duplicate tensor(3.1174, dtype=torch.float64) tensor(-6.1211, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.7930, dtype=torch.float64) delta_t tensor(0.6917, dtype=torch.float64)
9 gae_duplicate tensor(3.1856, dtype=torch.float64) tensor(-5.8563, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1461, dtype=torch.float64) delta_t tensor(0.0791, dtype=torch.float64)
8 gae_duplicate tensor(2.6276, dtype=torch.float64) tensor(-4.8305, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5087, dtype=torch.float64) delta_t tensor(-0.7550, dtype=torch.float64)
7 gae_duplicate tensor(1.3471, dtype=torch.float64) tensor(-2.4687, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4567, dtype=torch.float64) delta_t tensor(-1.3904, dtype=torch.float64)
6 gae_duplicate tensor(-0.3127, dtype=torch.float64) tensor(0.6983, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0673, dtype=torch.float64) delta_t tensor(-2.2461, dtype=torch.float64)
5 gae_duplicate tensor(-2.4963, dtype=torch.float64) tensor(4.6446, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3893, dtype=torch.float64) delta_t tensor(0.3526, dtype=torch.float64)
4 gae_duplicate tensor(-1.6444, dtype=torch.float64) tensor(3.9372, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6390, dtype=torch.float64) delta_t tensor(-1.7147, dtype=torch.float64)
3 gae_duplicate tensor(-3.0303, dtype=torch.float64) tensor(5.7876, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6214, dtype=torch.float64) delta_t tensor(-1.6136, dtype=torch.float64)
2 gae_duplicate tensor(-4.0379, dtype=torch.float64) tensor(8.7899, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:262.2892761230469
value loss:198.69210815429688
entropies:37.14796829223633
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.537399053573608 seconds
19 rew tensor(0.7118, dtype=torch.float64) delta_t tensor(0.5295, dtype=torch.float64)
19 gae_duplicate tensor(0.5295, dtype=torch.float64) tensor(-1.0745, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6747, dtype=torch.float64) delta_t tensor(0.6346, dtype=torch.float64)
18 gae_duplicate tensor(1.0582, dtype=torch.float64) tensor(-2.1525, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6831, dtype=torch.float64) delta_t tensor(0.5825, dtype=torch.float64)
17 gae_duplicate tensor(1.4291, dtype=torch.float64) tensor(-3.0679, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6002, dtype=torch.float64) delta_t tensor(0.6928, dtype=torch.float64)
16 gae_duplicate tensor(1.8361, dtype=torch.float64) tensor(-4.2011, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4708, dtype=torch.float64) delta_t tensor(0.1386, dtype=torch.float64)
15 gae_duplicate tensor(1.6075, dtype=torch.float64) tensor(-3.6469, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3404, dtype=torch.float64) delta_t tensor(0.2766, dtype=torch.float64)
14 gae_duplicate tensor(1.5626, dtype=torch.float64) tensor(-3.0802, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4783, dtype=torch.float64) delta_t tensor(0.4234, dtype=torch.float64)
13 gae_duplicate tensor(1.6735, dtype=torch.float64) tensor(-3.6371, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7509, dtype=torch.float64) delta_t tensor(0.6763, dtype=torch.float64)
12 gae_duplicate tensor(2.0151, dtype=torch.float64) tensor(-4.0171, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7622, dtype=torch.float64) delta_t tensor(0.8021, dtype=torch.float64)
11 gae_duplicate tensor(2.4141, dtype=torch.float64) tensor(-5.3215, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5974, dtype=torch.float64) delta_t tensor(0.4944, dtype=torch.float64)
10 gae_duplicate tensor(2.4257, dtype=torch.float64) tensor(-4.8091, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2371, dtype=torch.float64) delta_t tensor(-1.1074, dtype=torch.float64)
9 gae_duplicate tensor(0.8332, dtype=torch.float64) tensor(-1.6389, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3581, dtype=torch.float64) delta_t tensor(-1.2802, dtype=torch.float64)
8 gae_duplicate tensor(-0.6137, dtype=torch.float64) tensor(1.3814, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2042, dtype=torch.float64) delta_t tensor(0.1345, dtype=torch.float64)
7 gae_duplicate tensor(-0.3565, dtype=torch.float64) tensor(0.7900, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.8219, dtype=torch.float64) delta_t tensor(-1.9624, dtype=torch.float64)
6 gae_duplicate tensor(-2.2475, dtype=torch.float64) tensor(4.5846, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5052, dtype=torch.float64) delta_t tensor(-1.6905, dtype=torch.float64)
5 gae_duplicate tensor(-3.4886, dtype=torch.float64) tensor(7.0740, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.3807, dtype=torch.float64) delta_t tensor(-5.5546, dtype=torch.float64)
4 gae_duplicate tensor(-8.3455, dtype=torch.float64) tensor(16.2765, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6850, dtype=torch.float64) delta_t tensor(-0.6672, dtype=torch.float64)
3 gae_duplicate tensor(-7.3436, dtype=torch.float64) tensor(14.6900, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6176, dtype=torch.float64) delta_t tensor(-0.7094, dtype=torch.float64)
2 gae_duplicate tensor(-6.5842, dtype=torch.float64) tensor(13.1785, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-129.08912658691406
value loss:323.63812255859375
entropies:37.317203521728516
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4426429271698 seconds
19 rew tensor(0.7570, dtype=torch.float64) delta_t tensor(0.4925, dtype=torch.float64)
19 gae_duplicate tensor(0.4925, dtype=torch.float64) tensor(-1.0228, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7646, dtype=torch.float64) delta_t tensor(0.7002, dtype=torch.float64)
18 gae_duplicate tensor(1.0942, dtype=torch.float64) tensor(-2.2725, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7723, dtype=torch.float64) delta_t tensor(0.7171, dtype=torch.float64)
17 gae_duplicate tensor(1.5925, dtype=torch.float64) tensor(-3.3073, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7803, dtype=torch.float64) delta_t tensor(0.7251, dtype=torch.float64)
16 gae_duplicate tensor(1.9991, dtype=torch.float64) tensor(-4.1413, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7886, dtype=torch.float64) delta_t tensor(0.8276, dtype=torch.float64)
15 gae_duplicate tensor(2.4269, dtype=torch.float64) tensor(-4.6819, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7971, dtype=torch.float64) delta_t tensor(0.6830, dtype=torch.float64)
14 gae_duplicate tensor(2.6245, dtype=torch.float64) tensor(-6.0355, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3093, dtype=torch.float64) delta_t tensor(0.4098, dtype=torch.float64)
13 gae_duplicate tensor(2.5095, dtype=torch.float64) tensor(-4.8342, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2129, dtype=torch.float64) delta_t tensor(0.0967, dtype=torch.float64)
12 gae_duplicate tensor(2.1043, dtype=torch.float64) tensor(-3.9520, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0674, dtype=torch.float64) delta_t tensor(0.0164, dtype=torch.float64)
11 gae_duplicate tensor(1.6998, dtype=torch.float64) tensor(-3.2109, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1165, dtype=torch.float64) delta_t tensor(0.1704, dtype=torch.float64)
10 gae_duplicate tensor(1.5303, dtype=torch.float64) tensor(-2.9581, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0207, dtype=torch.float64) delta_t tensor(0.1109, dtype=torch.float64)
9 gae_duplicate tensor(1.3351, dtype=torch.float64) tensor(-2.6519, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2190, dtype=torch.float64) delta_t tensor(-0.2506, dtype=torch.float64)
8 gae_duplicate tensor(0.8175, dtype=torch.float64) tensor(-1.6891, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1731, dtype=torch.float64) delta_t tensor(-0.5023, dtype=torch.float64)
7 gae_duplicate tensor(0.1517, dtype=torch.float64) tensor(-0.2918, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5824, dtype=torch.float64) delta_t tensor(0.5273, dtype=torch.float64)
6 gae_duplicate tensor(0.6486, dtype=torch.float64) tensor(-1.1999, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2000, dtype=torch.float64) delta_t tensor(-1.2401, dtype=torch.float64)
5 gae_duplicate tensor(-0.7212, dtype=torch.float64) tensor(1.3495, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3829, dtype=torch.float64) delta_t tensor(0.2830, dtype=torch.float64)
4 gae_duplicate tensor(-0.2939, dtype=torch.float64) tensor(0.6961, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0680, dtype=torch.float64) delta_t tensor(-0.9171, dtype=torch.float64)
3 gae_duplicate tensor(-1.1523, dtype=torch.float64) tensor(2.1315, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2273, dtype=torch.float64) delta_t tensor(-1.1597, dtype=torch.float64)
2 gae_duplicate tensor(-2.0816, dtype=torch.float64) tensor(3.8616, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:204.14749145507812
value loss:68.80258178710938
entropies:37.14371871948242
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.663535118103027 seconds
19 rew tensor(0.6918, dtype=torch.float64) delta_t tensor(0.4612, dtype=torch.float64)
19 gae_duplicate tensor(0.4612, dtype=torch.float64) tensor(-0.9006, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6075, dtype=torch.float64) delta_t tensor(0.6991, dtype=torch.float64)
18 gae_duplicate tensor(1.0681, dtype=torch.float64) tensor(-2.0439, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4336, dtype=torch.float64) delta_t tensor(0.4170, dtype=torch.float64)
17 gae_duplicate tensor(1.2715, dtype=torch.float64) tensor(-2.8623, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2145, dtype=torch.float64) delta_t tensor(0.2045, dtype=torch.float64)
16 gae_duplicate tensor(1.2217, dtype=torch.float64) tensor(-2.4168, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.3140, dtype=torch.float64) delta_t tensor(-0.6084, dtype=torch.float64)
15 gae_duplicate tensor(0.3690, dtype=torch.float64) tensor(-0.7644, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7384, dtype=torch.float64) delta_t tensor(0.6663, dtype=torch.float64)
14 gae_duplicate tensor(0.9615, dtype=torch.float64) tensor(-2.0068, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7445, dtype=torch.float64) delta_t tensor(0.6664, dtype=torch.float64)
13 gae_duplicate tensor(1.4356, dtype=torch.float64) tensor(-2.9741, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7070, dtype=torch.float64) delta_t tensor(0.6175, dtype=torch.float64)
12 gae_duplicate tensor(1.7659, dtype=torch.float64) tensor(-3.6675, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7563, dtype=torch.float64) delta_t tensor(0.7369, dtype=torch.float64)
11 gae_duplicate tensor(2.1497, dtype=torch.float64) tensor(-4.4871, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5888, dtype=torch.float64) delta_t tensor(0.7882, dtype=torch.float64)
10 gae_duplicate tensor(2.5080, dtype=torch.float64) tensor(-5.6001, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2269, dtype=torch.float64) delta_t tensor(-1.4261, dtype=torch.float64)
9 gae_duplicate tensor(0.5803, dtype=torch.float64) tensor(-1.1256, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3313, dtype=torch.float64) delta_t tensor(-1.3008, dtype=torch.float64)
8 gae_duplicate tensor(-0.8365, dtype=torch.float64) tensor(1.6415, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3066, dtype=torch.float64) delta_t tensor(0.3052, dtype=torch.float64)
7 gae_duplicate tensor(-0.3641, dtype=torch.float64) tensor(0.7295, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8643, dtype=torch.float64) delta_t tensor(-1.0348, dtype=torch.float64)
6 gae_duplicate tensor(-1.3260, dtype=torch.float64) tensor(2.7607, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3935, dtype=torch.float64) delta_t tensor(-1.4997, dtype=torch.float64)
5 gae_duplicate tensor(-2.5605, dtype=torch.float64) tensor(5.3179, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.9518, dtype=torch.float64) delta_t tensor(-5.0932, dtype=torch.float64)
4 gae_duplicate tensor(-7.1416, dtype=torch.float64) tensor(14.5521, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1476, dtype=torch.float64) delta_t tensor(0.0143, dtype=torch.float64)
3 gae_duplicate tensor(-5.6991, dtype=torch.float64) tensor(13.5611, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1999, dtype=torch.float64) delta_t tensor(-0.2612, dtype=torch.float64)
2 gae_duplicate tensor(-4.8204, dtype=torch.float64) tensor(11.4705, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-128.22528076171875
value loss:206.72369384765625
entropies:37.28873825073242
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.6819)
ToM Target loss= tensor(299.9673)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.44404411315918 seconds
19 rew tensor(0.7480, dtype=torch.float64) delta_t tensor(0.4994, dtype=torch.float64)
19 gae_duplicate tensor(0.4994, dtype=torch.float64) tensor(-1.0398, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7529, dtype=torch.float64) delta_t tensor(0.7032, dtype=torch.float64)
18 gae_duplicate tensor(1.1027, dtype=torch.float64) tensor(-2.3014, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7579, dtype=torch.float64) delta_t tensor(0.8732, dtype=torch.float64)
17 gae_duplicate tensor(1.7554, dtype=torch.float64) tensor(-3.6547, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7630, dtype=torch.float64) delta_t tensor(0.6971, dtype=torch.float64)
16 gae_duplicate tensor(2.1015, dtype=torch.float64) tensor(-4.7177, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7682, dtype=torch.float64) delta_t tensor(0.8260, dtype=torch.float64)
15 gae_duplicate tensor(2.5072, dtype=torch.float64) tensor(-5.5972, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7735, dtype=torch.float64) delta_t tensor(0.8073, dtype=torch.float64)
14 gae_duplicate tensor(2.8131, dtype=torch.float64) tensor(-5.5551, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7789, dtype=torch.float64) delta_t tensor(0.7735, dtype=torch.float64)
13 gae_duplicate tensor(3.0239, dtype=torch.float64) tensor(-6.1377, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7845, dtype=torch.float64) delta_t tensor(0.5812, dtype=torch.float64)
12 gae_duplicate tensor(3.0004, dtype=torch.float64) tensor(-6.2316, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7901, dtype=torch.float64) delta_t tensor(0.7417, dtype=torch.float64)
11 gae_duplicate tensor(3.1420, dtype=torch.float64) tensor(-6.5415, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4216, dtype=torch.float64) delta_t tensor(0.4221, dtype=torch.float64)
10 gae_duplicate tensor(2.9357, dtype=torch.float64) tensor(-6.0972, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3306, dtype=torch.float64) delta_t tensor(0.1556, dtype=torch.float64)
9 gae_duplicate tensor(2.5042, dtype=torch.float64) tensor(-4.9265, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2249, dtype=torch.float64) delta_t tensor(-0.3509, dtype=torch.float64)
8 gae_duplicate tensor(1.6524, dtype=torch.float64) tensor(-3.6741, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2260, dtype=torch.float64) delta_t tensor(-0.1963, dtype=torch.float64)
7 gae_duplicate tensor(1.1256, dtype=torch.float64) tensor(-2.4680, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3191, dtype=torch.float64) delta_t tensor(-0.5240, dtype=torch.float64)
6 gae_duplicate tensor(0.3765, dtype=torch.float64) tensor(-0.8383, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2749, dtype=torch.float64) delta_t tensor(-0.3198, dtype=torch.float64)
5 gae_duplicate tensor(-0.0186, dtype=torch.float64) tensor(0.0348, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3676, dtype=torch.float64) delta_t tensor(-0.5129, dtype=torch.float64)
4 gae_duplicate tensor(-0.5278, dtype=torch.float64) tensor(1.0210, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8693, dtype=torch.float64) delta_t tensor(-0.9571, dtype=torch.float64)
3 gae_duplicate tensor(-1.3794, dtype=torch.float64) tensor(2.7716, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4683, dtype=torch.float64) delta_t tensor(-0.5692, dtype=torch.float64)
2 gae_duplicate tensor(-1.6727, dtype=torch.float64) tensor(3.6307, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:312.8157653808594
value loss:112.78384399414062
entropies:37.324363708496094
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.488260746002197 seconds
19 rew tensor(0.7514, dtype=torch.float64) delta_t tensor(0.6753, dtype=torch.float64)
19 gae_duplicate tensor(0.6753, dtype=torch.float64) tensor(-1.3994, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7556, dtype=torch.float64) delta_t tensor(0.7232, dtype=torch.float64)
18 gae_duplicate tensor(1.2634, dtype=torch.float64) tensor(-2.6179, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7599, dtype=torch.float64) delta_t tensor(0.7412, dtype=torch.float64)
17 gae_duplicate tensor(1.7520, dtype=torch.float64) tensor(-3.6560, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7643, dtype=torch.float64) delta_t tensor(0.7456, dtype=torch.float64)
16 gae_duplicate tensor(2.1472, dtype=torch.float64) tensor(-4.4597, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7687, dtype=torch.float64) delta_t tensor(0.7501, dtype=torch.float64)
15 gae_duplicate tensor(2.4678, dtype=torch.float64) tensor(-5.1257, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7732, dtype=torch.float64) delta_t tensor(0.7197, dtype=torch.float64)
14 gae_duplicate tensor(2.6940, dtype=torch.float64) tensor(-5.6086, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7778, dtype=torch.float64) delta_t tensor(0.7522, dtype=torch.float64)
13 gae_duplicate tensor(2.9074, dtype=torch.float64) tensor(-6.0386, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7825, dtype=torch.float64) delta_t tensor(0.7455, dtype=torch.float64)
12 gae_duplicate tensor(3.0714, dtype=torch.float64) tensor(-6.3944, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7873, dtype=torch.float64) delta_t tensor(0.7335, dtype=torch.float64)
11 gae_duplicate tensor(3.1906, dtype=torch.float64) tensor(-6.6113, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7922, dtype=torch.float64) delta_t tensor(0.5039, dtype=torch.float64)
10 gae_duplicate tensor(3.0564, dtype=torch.float64) tensor(-6.7193, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2617, dtype=torch.float64) delta_t tensor(0.1905, dtype=torch.float64)
9 gae_duplicate tensor(2.6356, dtype=torch.float64) tensor(-5.8987, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4162, dtype=torch.float64) delta_t tensor(-0.5084, dtype=torch.float64)
8 gae_duplicate tensor(1.6000, dtype=torch.float64) tensor(-3.0658, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5148, dtype=torch.float64) delta_t tensor(-0.5938, dtype=torch.float64)
7 gae_duplicate tensor(0.6862, dtype=torch.float64) tensor(-1.3385, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4691, dtype=torch.float64) delta_t tensor(-0.5349, dtype=torch.float64)
6 gae_duplicate tensor(0.0140, dtype=torch.float64) tensor(-0.0275, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4324, dtype=torch.float64) delta_t tensor(-1.4435, dtype=torch.float64)
5 gae_duplicate tensor(-1.4323, dtype=torch.float64) tensor(3.0562, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4803, dtype=torch.float64) delta_t tensor(0.3582, dtype=torch.float64)
4 gae_duplicate tensor(-0.7876, dtype=torch.float64) tensor(1.4983, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9607, dtype=torch.float64) delta_t tensor(-1.0094, dtype=torch.float64)
3 gae_duplicate tensor(-1.6395, dtype=torch.float64) tensor(3.4611, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2467, dtype=torch.float64) delta_t tensor(-0.4387, dtype=torch.float64)
2 gae_duplicate tensor(-1.7503, dtype=torch.float64) tensor(3.6509, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:282.6483459472656
value loss:118.33197021484375
entropies:37.35847091674805
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.408401250839233 seconds
19 rew tensor(0.7559, dtype=torch.float64) delta_t tensor(0.1867, dtype=torch.float64)
19 gae_duplicate tensor(0.1867, dtype=torch.float64) tensor(-0.3886, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7596, dtype=torch.float64) delta_t tensor(0.5684, dtype=torch.float64)
18 gae_duplicate tensor(0.7178, dtype=torch.float64) tensor(-1.4943, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7634, dtype=torch.float64) delta_t tensor(1.0987, dtype=torch.float64)
17 gae_duplicate tensor(1.6729, dtype=torch.float64) tensor(-3.4561, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7672, dtype=torch.float64) delta_t tensor(0.7811, dtype=torch.float64)
16 gae_duplicate tensor(2.1194, dtype=torch.float64) tensor(-4.4021, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7711, dtype=torch.float64) delta_t tensor(0.6217, dtype=torch.float64)
15 gae_duplicate tensor(2.3172, dtype=torch.float64) tensor(-4.8017, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7751, dtype=torch.float64) delta_t tensor(0.7149, dtype=torch.float64)
14 gae_duplicate tensor(2.5686, dtype=torch.float64) tensor(-5.3228, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7791, dtype=torch.float64) delta_t tensor(0.7235, dtype=torch.float64)
13 gae_duplicate tensor(2.7784, dtype=torch.float64) tensor(-5.7844, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7832, dtype=torch.float64) delta_t tensor(0.7239, dtype=torch.float64)
12 gae_duplicate tensor(2.9467, dtype=torch.float64) tensor(-6.1344, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7874, dtype=torch.float64) delta_t tensor(0.7328, dtype=torch.float64)
11 gae_duplicate tensor(3.0901, dtype=torch.float64) tensor(-6.4481, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7916, dtype=torch.float64) delta_t tensor(0.9027, dtype=torch.float64)
10 gae_duplicate tensor(3.3748, dtype=torch.float64) tensor(-7.0095, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5441, dtype=torch.float64) delta_t tensor(0.2008, dtype=torch.float64)
9 gae_duplicate tensor(2.9007, dtype=torch.float64) tensor(-6.0482, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2953, dtype=torch.float64) delta_t tensor(0.2159, dtype=torch.float64)
8 gae_duplicate tensor(2.5365, dtype=torch.float64) tensor(-5.2043, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3045, dtype=torch.float64) delta_t tensor(-0.2758, dtype=torch.float64)
7 gae_duplicate tensor(1.7534, dtype=torch.float64) tensor(-3.6418, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3056, dtype=torch.float64) delta_t tensor(-0.5941, dtype=torch.float64)
6 gae_duplicate tensor(0.8086, dtype=torch.float64) tensor(-1.6756, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5556, dtype=torch.float64) delta_t tensor(-0.6035, dtype=torch.float64)
5 gae_duplicate tensor(0.0434, dtype=torch.float64) tensor(-0.0934, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3028, dtype=torch.float64) delta_t tensor(-1.4814, dtype=torch.float64)
4 gae_duplicate tensor(-1.4466, dtype=torch.float64) tensor(2.9369, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0663, dtype=torch.float64) delta_t tensor(-1.0235, dtype=torch.float64)
3 gae_duplicate tensor(-2.1808, dtype=torch.float64) tensor(4.3967, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5763, dtype=torch.float64) delta_t tensor(-0.7478, dtype=torch.float64)
2 gae_duplicate tensor(-2.4925, dtype=torch.float64) tensor(5.3907, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:293.9631042480469
value loss:133.18109130859375
entropies:37.42007827758789
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.518476963043213 seconds
19 rew tensor(0.7372, dtype=torch.float64) delta_t tensor(0.1394, dtype=torch.float64)
19 gae_duplicate tensor(0.1394, dtype=torch.float64) tensor(-0.2902, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6872, dtype=torch.float64) delta_t tensor(0.5287, dtype=torch.float64)
18 gae_duplicate tensor(0.6402, dtype=torch.float64) tensor(-1.3298, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5839, dtype=torch.float64) delta_t tensor(0.9286, dtype=torch.float64)
17 gae_duplicate tensor(1.4407, dtype=torch.float64) tensor(-3.0460, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3742, dtype=torch.float64) delta_t tensor(0.2849, dtype=torch.float64)
16 gae_duplicate tensor(1.4375, dtype=torch.float64) tensor(-3.0228, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0583, dtype=torch.float64) delta_t tensor(-0.1030, dtype=torch.float64)
15 gae_duplicate tensor(1.0470, dtype=torch.float64) tensor(-2.1747, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0584, dtype=torch.float64) delta_t tensor(0.0075, dtype=torch.float64)
14 gae_duplicate tensor(0.8451, dtype=torch.float64) tensor(-1.7554, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5841, dtype=torch.float64) delta_t tensor(0.4096, dtype=torch.float64)
13 gae_duplicate tensor(1.0857, dtype=torch.float64) tensor(-2.2604, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3241, dtype=torch.float64) delta_t tensor(0.2075, dtype=torch.float64)
12 gae_duplicate tensor(1.0761, dtype=torch.float64) tensor(-2.2403, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0636, dtype=torch.float64) delta_t tensor(0.0128, dtype=torch.float64)
11 gae_duplicate tensor(0.8737, dtype=torch.float64) tensor(-1.8189, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1449, dtype=torch.float64) delta_t tensor(-0.1930, dtype=torch.float64)
10 gae_duplicate tensor(0.5060, dtype=torch.float64) tensor(-1.0534, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3014, dtype=torch.float64) delta_t tensor(-0.2658, dtype=torch.float64)
9 gae_duplicate tensor(0.1390, dtype=torch.float64) tensor(-0.2894, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4579, dtype=torch.float64) delta_t tensor(-0.6839, dtype=torch.float64)
8 gae_duplicate tensor(-0.5727, dtype=torch.float64) tensor(1.2123, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0579, dtype=torch.float64) delta_t tensor(0.0592, dtype=torch.float64)
7 gae_duplicate tensor(-0.3989, dtype=torch.float64) tensor(0.7900, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8190, dtype=torch.float64) delta_t tensor(-1.0874, dtype=torch.float64)
6 gae_duplicate tensor(-1.4065, dtype=torch.float64) tensor(3.1843, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4139, dtype=torch.float64) delta_t tensor(0.4466, dtype=torch.float64)
5 gae_duplicate tensor(-0.6786, dtype=torch.float64) tensor(1.3021, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0242, dtype=torch.float64) delta_t tensor(-1.0995, dtype=torch.float64)
4 gae_duplicate tensor(-1.6424, dtype=torch.float64) tensor(3.2111, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3578, dtype=torch.float64) delta_t tensor(0.1824, dtype=torch.float64)
3 gae_duplicate tensor(-1.1315, dtype=torch.float64) tensor(2.5117, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0770, dtype=torch.float64) delta_t tensor(-0.8438, dtype=torch.float64)
2 gae_duplicate tensor(-1.7490, dtype=torch.float64) tensor(3.2635, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:21.718297958374023
value loss:29.57984161376953
entropies:37.34885787963867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.532435178756714 seconds
19 rew tensor(0.8068, dtype=torch.float64) delta_t tensor(0.5580, dtype=torch.float64)
19 gae_duplicate tensor(0.5580, dtype=torch.float64) tensor(-1.1617, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8102, dtype=torch.float64) delta_t tensor(0.6679, dtype=torch.float64)
18 gae_duplicate tensor(1.1143, dtype=torch.float64) tensor(-2.3092, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.8185, dtype=torch.float64)
17 gae_duplicate tensor(1.7099, dtype=torch.float64) tensor(-3.5597, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.8433, dtype=torch.float64)
16 gae_duplicate tensor(2.2112, dtype=torch.float64) tensor(-4.6137, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8205, dtype=torch.float64) delta_t tensor(0.6754, dtype=torch.float64)
15 gae_duplicate tensor(2.4444, dtype=torch.float64) tensor(-5.0772, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0656, dtype=torch.float64) delta_t tensor(-0.0708, dtype=torch.float64)
14 gae_duplicate tensor(1.8847, dtype=torch.float64) tensor(-3.9236, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4440, dtype=torch.float64) delta_t tensor(0.2957, dtype=torch.float64)
13 gae_duplicate tensor(1.8034, dtype=torch.float64) tensor(-3.7629, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3375, dtype=torch.float64) delta_t tensor(0.2871, dtype=torch.float64)
12 gae_duplicate tensor(1.7299, dtype=torch.float64) tensor(-3.6094, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1771, dtype=torch.float64) delta_t tensor(0.0719, dtype=torch.float64)
11 gae_duplicate tensor(1.4558, dtype=torch.float64) tensor(-3.0308, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0702, dtype=torch.float64) delta_t tensor(-0.0497, dtype=torch.float64)
10 gae_duplicate tensor(1.1150, dtype=torch.float64) tensor(-2.3047, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3042, dtype=torch.float64) delta_t tensor(-0.2881, dtype=torch.float64)
9 gae_duplicate tensor(0.6038, dtype=torch.float64) tensor(-1.2571, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7856, dtype=torch.float64) delta_t tensor(-0.6825, dtype=torch.float64)
8 gae_duplicate tensor(-0.1994, dtype=torch.float64) tensor(0.4151, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6290, dtype=torch.float64) delta_t tensor(-0.8761, dtype=torch.float64)
7 gae_duplicate tensor(-1.0357, dtype=torch.float64) tensor(2.1223, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5935, dtype=torch.float64) delta_t tensor(0.6936, dtype=torch.float64)
6 gae_duplicate tensor(-0.1349, dtype=torch.float64) tensor(0.2523, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9561, dtype=torch.float64) delta_t tensor(-2.0036, dtype=torch.float64)
5 gae_duplicate tensor(-2.1116, dtype=torch.float64) tensor(4.9506, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7504, dtype=torch.float64) delta_t tensor(0.5729, dtype=torch.float64)
4 gae_duplicate tensor(-1.1164, dtype=torch.float64) tensor(2.0824, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3335, dtype=torch.float64) delta_t tensor(-1.3736, dtype=torch.float64)
3 gae_duplicate tensor(-2.2667, dtype=torch.float64) tensor(4.2680, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2711, dtype=torch.float64) delta_t tensor(-0.4027, dtype=torch.float64)
2 gae_duplicate tensor(-2.2161, dtype=torch.float64) tensor(4.1967, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:96.81385803222656
value loss:68.62445831298828
entropies:37.30481719970703
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.9110)
ToM Target loss= tensor(300.5818)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.425107955932617 seconds
19 rew tensor(0.8114, dtype=torch.float64) delta_t tensor(0.5488, dtype=torch.float64)
19 gae_duplicate tensor(0.5488, dtype=torch.float64) tensor(-1.1425, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.5142, dtype=torch.float64)
18 gae_duplicate tensor(0.9533, dtype=torch.float64) tensor(-1.9758, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8176, dtype=torch.float64) delta_t tensor(0.7052, dtype=torch.float64)
17 gae_duplicate tensor(1.4678, dtype=torch.float64) tensor(-3.0555, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8207, dtype=torch.float64) delta_t tensor(0.7166, dtype=torch.float64)
16 gae_duplicate tensor(1.8908, dtype=torch.float64) tensor(-3.9361, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8239, dtype=torch.float64) delta_t tensor(0.7198, dtype=torch.float64)
15 gae_duplicate tensor(2.2324, dtype=torch.float64) tensor(-4.6372, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8271, dtype=torch.float64) delta_t tensor(0.7083, dtype=torch.float64)
14 gae_duplicate tensor(2.4942, dtype=torch.float64) tensor(-5.2035, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8304, dtype=torch.float64) delta_t tensor(0.7948, dtype=torch.float64)
13 gae_duplicate tensor(2.7901, dtype=torch.float64) tensor(-5.7955, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8337, dtype=torch.float64) delta_t tensor(0.6895, dtype=torch.float64)
12 gae_duplicate tensor(2.9216, dtype=torch.float64) tensor(-6.0952, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8370, dtype=torch.float64) delta_t tensor(0.6985, dtype=torch.float64)
11 gae_duplicate tensor(3.0358, dtype=torch.float64) tensor(-6.3059, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6200, dtype=torch.float64) delta_t tensor(0.5228, dtype=torch.float64)
10 gae_duplicate tensor(2.9515, dtype=torch.float64) tensor(-6.1174, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5121, dtype=torch.float64) delta_t tensor(0.3894, dtype=torch.float64)
9 gae_duplicate tensor(2.7506, dtype=torch.float64) tensor(-5.7135, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0194, dtype=torch.float64) delta_t tensor(-0.1428, dtype=torch.float64)
8 gae_duplicate tensor(2.0577, dtype=torch.float64) tensor(-4.2649, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3639, dtype=torch.float64) delta_t tensor(-0.4557, dtype=torch.float64)
7 gae_duplicate tensor(1.1904, dtype=torch.float64) tensor(-2.5465, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5836, dtype=torch.float64) delta_t tensor(-0.7564, dtype=torch.float64)
6 gae_duplicate tensor(0.1959, dtype=torch.float64) tensor(-0.4023, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8583, dtype=torch.float64) delta_t tensor(-1.0348, dtype=torch.float64)
5 gae_duplicate tensor(-0.8781, dtype=torch.float64) tensor(1.8200, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4619, dtype=torch.float64) delta_t tensor(-1.5354, dtype=torch.float64)
4 gae_duplicate tensor(-2.2378, dtype=torch.float64) tensor(4.6776, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8169, dtype=torch.float64) delta_t tensor(-0.9229, dtype=torch.float64)
3 gae_duplicate tensor(-2.7131, dtype=torch.float64) tensor(5.6603, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9296, dtype=torch.float64) delta_t tensor(-0.6874, dtype=torch.float64)
2 gae_duplicate tensor(-2.8580, dtype=torch.float64) tensor(5.3795, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:236.80307006835938
value loss:130.4327392578125
entropies:37.403785705566406
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.662298917770386 seconds
19 rew tensor(-1.1460, dtype=torch.float64) delta_t tensor(-1.6846, dtype=torch.float64)
19 gae_duplicate tensor(-1.6846, dtype=torch.float64) tensor(3.5139, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8248, dtype=torch.float64) delta_t tensor(0.7171, dtype=torch.float64)
18 gae_duplicate tensor(-0.6306, dtype=torch.float64) tensor(1.3073, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8277, dtype=torch.float64) delta_t tensor(0.7200, dtype=torch.float64)
17 gae_duplicate tensor(0.2155, dtype=torch.float64) tensor(-0.4486, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8307, dtype=torch.float64) delta_t tensor(0.7229, dtype=torch.float64)
16 gae_duplicate tensor(0.8953, dtype=torch.float64) tensor(-1.8637, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7773, dtype=torch.float64) delta_t tensor(0.6659, dtype=torch.float64)
15 gae_duplicate tensor(1.3821, dtype=torch.float64) tensor(-2.8711, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7236, dtype=torch.float64) delta_t tensor(0.7619, dtype=torch.float64)
14 gae_duplicate tensor(1.8676, dtype=torch.float64) tensor(-3.8715, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6135, dtype=torch.float64) delta_t tensor(0.4414, dtype=torch.float64)
13 gae_duplicate tensor(1.9355, dtype=torch.float64) tensor(-4.0206, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5029, dtype=torch.float64) delta_t tensor(0.3051, dtype=torch.float64)
12 gae_duplicate tensor(1.8534, dtype=torch.float64) tensor(-3.8501, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2809, dtype=torch.float64) delta_t tensor(-0.3987, dtype=torch.float64)
11 gae_duplicate tensor(1.0841, dtype=torch.float64) tensor(-2.2521, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7260, dtype=torch.float64) delta_t tensor(0.6081, dtype=torch.float64)
10 gae_duplicate tensor(1.4753, dtype=torch.float64) tensor(-3.0647, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6165, dtype=torch.float64) delta_t tensor(0.6183, dtype=torch.float64)
9 gae_duplicate tensor(1.7986, dtype=torch.float64) tensor(-3.7285, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1717, dtype=torch.float64) delta_t tensor(0.1249, dtype=torch.float64)
8 gae_duplicate tensor(1.5638, dtype=torch.float64) tensor(-3.2484, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2180, dtype=torch.float64) delta_t tensor(-0.3816, dtype=torch.float64)
7 gae_duplicate tensor(0.8694, dtype=torch.float64) tensor(-1.8022, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9414, dtype=torch.float64) delta_t tensor(-1.0304, dtype=torch.float64)
6 gae_duplicate tensor(-0.3349, dtype=torch.float64) tensor(0.6985, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5006, dtype=torch.float64) delta_t tensor(-0.7784, dtype=torch.float64)
5 gae_duplicate tensor(-1.0463, dtype=torch.float64) tensor(2.1791, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7229, dtype=torch.float64) delta_t tensor(-1.8618, dtype=torch.float64)
4 gae_duplicate tensor(-2.6989, dtype=torch.float64) tensor(5.6063, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2889, dtype=torch.float64) delta_t tensor(-0.2912, dtype=torch.float64)
3 gae_duplicate tensor(-2.4503, dtype=torch.float64) tensor(5.0373, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3453, dtype=torch.float64) delta_t tensor(-0.5857, dtype=torch.float64)
2 gae_duplicate tensor(-2.5460, dtype=torch.float64) tensor(5.2891, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:43.217254638671875
value loss:71.14188385009766
entropies:37.429534912109375
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.535163164138794 seconds
19 rew tensor(0.8278, dtype=torch.float64) delta_t tensor(0.4323, dtype=torch.float64)
19 gae_duplicate tensor(0.4323, dtype=torch.float64) tensor(-0.9015, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8305, dtype=torch.float64) delta_t tensor(0.7470, dtype=torch.float64)
18 gae_duplicate tensor(1.0928, dtype=torch.float64) tensor(-2.2702, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8332, dtype=torch.float64) delta_t tensor(0.8849, dtype=torch.float64)
17 gae_duplicate tensor(1.7592, dtype=torch.float64) tensor(-3.6546, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8360, dtype=torch.float64) delta_t tensor(0.7584, dtype=torch.float64)
16 gae_duplicate tensor(2.1658, dtype=torch.float64) tensor(-4.5080, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8387, dtype=torch.float64) delta_t tensor(0.6954, dtype=torch.float64)
15 gae_duplicate tensor(2.4280, dtype=torch.float64) tensor(-5.0440, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8415, dtype=torch.float64) delta_t tensor(0.7598, dtype=torch.float64)
14 gae_duplicate tensor(2.7022, dtype=torch.float64) tensor(-5.6245, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8444, dtype=torch.float64) delta_t tensor(0.7588, dtype=torch.float64)
13 gae_duplicate tensor(2.9206, dtype=torch.float64) tensor(-6.0790, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8472, dtype=torch.float64) delta_t tensor(0.7572, dtype=torch.float64)
12 gae_duplicate tensor(3.0937, dtype=torch.float64) tensor(-6.4394, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8501, dtype=torch.float64) delta_t tensor(0.7572, dtype=torch.float64)
11 gae_duplicate tensor(3.2322, dtype=torch.float64) tensor(-6.7277, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8530, dtype=torch.float64) delta_t tensor(0.7278, dtype=torch.float64)
10 gae_duplicate tensor(3.3136, dtype=torch.float64) tensor(-6.8838, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4020, dtype=torch.float64) delta_t tensor(0.2013, dtype=torch.float64)
9 gae_duplicate tensor(2.8521, dtype=torch.float64) tensor(-5.9366, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2896, dtype=torch.float64) delta_t tensor(0.0478, dtype=torch.float64)
8 gae_duplicate tensor(2.3295, dtype=torch.float64) tensor(-4.8582, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7841, dtype=torch.float64) delta_t tensor(-0.8490, dtype=torch.float64)
7 gae_duplicate tensor(1.0146, dtype=torch.float64) tensor(-2.1078, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8432, dtype=torch.float64) delta_t tensor(-1.0168, dtype=torch.float64)
6 gae_duplicate tensor(-0.2051, dtype=torch.float64) tensor(0.4252, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2414, dtype=torch.float64) delta_t tensor(-0.7657, dtype=torch.float64)
5 gae_duplicate tensor(-0.9297, dtype=torch.float64) tensor(2.1383, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4740, dtype=torch.float64) delta_t tensor(-1.9658, dtype=torch.float64)
4 gae_duplicate tensor(-2.7095, dtype=torch.float64) tensor(5.2405, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3704, dtype=torch.float64) delta_t tensor(-1.4446, dtype=torch.float64)
3 gae_duplicate tensor(-3.6122, dtype=torch.float64) tensor(7.2171, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1862, dtype=torch.float64) delta_t tensor(-0.2423, dtype=torch.float64)
2 gae_duplicate tensor(-3.1321, dtype=torch.float64) tensor(6.1736, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:237.9216766357422
value loss:161.3819580078125
entropies:37.3869743347168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.740705966949463 seconds
19 rew tensor(0.8339, dtype=torch.float64) delta_t tensor(0.1396, dtype=torch.float64)
19 gae_duplicate tensor(0.1396, dtype=torch.float64) tensor(-0.2900, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8364, dtype=torch.float64) delta_t tensor(0.6976, dtype=torch.float64)
18 gae_duplicate tensor(0.8092, dtype=torch.float64) tensor(-1.6813, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8390, dtype=torch.float64) delta_t tensor(0.9377, dtype=torch.float64)
17 gae_duplicate tensor(1.5851, dtype=torch.float64) tensor(-3.2874, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8415, dtype=torch.float64) delta_t tensor(0.7781, dtype=torch.float64)
16 gae_duplicate tensor(2.0461, dtype=torch.float64) tensor(-4.2660, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8442, dtype=torch.float64) delta_t tensor(0.7906, dtype=torch.float64)
15 gae_duplicate tensor(2.4275, dtype=torch.float64) tensor(-5.0523, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8468, dtype=torch.float64) delta_t tensor(0.6207, dtype=torch.float64)
14 gae_duplicate tensor(2.5627, dtype=torch.float64) tensor(-5.3244, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8494, dtype=torch.float64) delta_t tensor(0.7586, dtype=torch.float64)
13 gae_duplicate tensor(2.8087, dtype=torch.float64) tensor(-5.8458, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8521, dtype=torch.float64) delta_t tensor(0.7354, dtype=torch.float64)
12 gae_duplicate tensor(2.9824, dtype=torch.float64) tensor(-6.1855, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5676, dtype=torch.float64) delta_t tensor(0.4916, dtype=torch.float64)
11 gae_duplicate tensor(2.8775, dtype=torch.float64) tensor(-5.9783, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3968, dtype=torch.float64) delta_t tensor(0.3047, dtype=torch.float64)
10 gae_duplicate tensor(2.6067, dtype=torch.float64) tensor(-5.4158, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1685, dtype=torch.float64) delta_t tensor(0.0489, dtype=torch.float64)
9 gae_duplicate tensor(2.1343, dtype=torch.float64) tensor(-4.4420, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1743, dtype=torch.float64) delta_t tensor(-0.4355, dtype=torch.float64)
8 gae_duplicate tensor(1.2719, dtype=torch.float64) tensor(-2.6518, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9738, dtype=torch.float64) delta_t tensor(-1.0648, dtype=torch.float64)
7 gae_duplicate tensor(-0.0472, dtype=torch.float64) tensor(0.0983, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9774, dtype=torch.float64) delta_t tensor(-1.1142, dtype=torch.float64)
6 gae_duplicate tensor(-1.1520, dtype=torch.float64) tensor(2.3935, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3805, dtype=torch.float64) delta_t tensor(-1.5654, dtype=torch.float64)
5 gae_duplicate tensor(-2.4870, dtype=torch.float64) tensor(5.1850, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9027, dtype=torch.float64) delta_t tensor(-2.0667, dtype=torch.float64)
4 gae_duplicate tensor(-4.0563, dtype=torch.float64) tensor(8.4571, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3106, dtype=torch.float64) delta_t tensor(-0.4967, dtype=torch.float64)
3 gae_duplicate tensor(-3.7418, dtype=torch.float64) tensor(7.7873, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3112, dtype=torch.float64) delta_t tensor(-0.4857, dtype=torch.float64)
2 gae_duplicate tensor(-3.4791, dtype=torch.float64) tensor(7.2158, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:114.5777359008789
value loss:161.90890502929688
entropies:37.42986297607422
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.273469924926758 seconds
19 rew tensor(0.8438, dtype=torch.float64) delta_t tensor(0.0032, dtype=torch.float64)
19 gae_duplicate tensor(0.0032, dtype=torch.float64) tensor(-0.0067, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7885, dtype=torch.float64) delta_t tensor(0.6273, dtype=torch.float64)
18 gae_duplicate tensor(0.6298, dtype=torch.float64) tensor(-1.3108, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7906, dtype=torch.float64) delta_t tensor(0.6308, dtype=torch.float64)
17 gae_duplicate tensor(1.1347, dtype=torch.float64) tensor(-2.3652, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6775, dtype=torch.float64) delta_t tensor(0.8485, dtype=torch.float64)
16 gae_duplicate tensor(1.7562, dtype=torch.float64) tensor(-3.6432, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4488, dtype=torch.float64) delta_t tensor(0.2170, dtype=torch.float64)
15 gae_duplicate tensor(1.6220, dtype=torch.float64) tensor(-3.3755, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1620, dtype=torch.float64) delta_t tensor(-0.1361, dtype=torch.float64)
14 gae_duplicate tensor(1.1614, dtype=torch.float64) tensor(-2.4171, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3346, dtype=torch.float64) delta_t tensor(0.2054, dtype=torch.float64)
13 gae_duplicate tensor(1.1346, dtype=torch.float64) tensor(-2.3649, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7940, dtype=torch.float64) delta_t tensor(0.6406, dtype=torch.float64)
12 gae_duplicate tensor(1.5483, dtype=torch.float64) tensor(-3.2221, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8535, dtype=torch.float64) delta_t tensor(0.7001, dtype=torch.float64)
11 gae_duplicate tensor(1.9387, dtype=torch.float64) tensor(-4.0282, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6842, dtype=torch.float64) delta_t tensor(0.5600, dtype=torch.float64)
10 gae_duplicate tensor(2.1110, dtype=torch.float64) tensor(-4.3933, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6303, dtype=torch.float64) delta_t tensor(-0.8194, dtype=torch.float64)
9 gae_duplicate tensor(0.8694, dtype=torch.float64) tensor(-1.8093, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.9466, dtype=torch.float64) delta_t tensor(-1.8220, dtype=torch.float64)
8 gae_duplicate tensor(-1.1265, dtype=torch.float64) tensor(2.3480, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0438, dtype=torch.float64) delta_t tensor(-1.1198, dtype=torch.float64)
7 gae_duplicate tensor(-2.0209, dtype=torch.float64) tensor(4.1991, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.5415, dtype=torch.float64) delta_t tensor(-2.7406, dtype=torch.float64)
6 gae_duplicate tensor(-4.3574, dtype=torch.float64) tensor(9.0536, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0935, dtype=torch.float64) delta_t tensor(-0.1495, dtype=torch.float64)
5 gae_duplicate tensor(-3.6354, dtype=torch.float64) tensor(7.5535, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4991, dtype=torch.float64) delta_t tensor(0.2816, dtype=torch.float64)
4 gae_duplicate tensor(-2.6268, dtype=torch.float64) tensor(5.4667, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8301, dtype=torch.float64) delta_t tensor(-0.9886, dtype=torch.float64)
3 gae_duplicate tensor(-3.0900, dtype=torch.float64) tensor(6.4099, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7748, dtype=torch.float64) delta_t tensor(-0.5470, dtype=torch.float64)
2 gae_duplicate tensor(-3.0190, dtype=torch.float64) tensor(6.2629, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-75.26807403564453
value loss:126.78243255615234
entropies:37.42987060546875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.5666)
ToM Target loss= tensor(300.5562)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.7098939418792725 seconds
19 rew tensor(0.8475, dtype=torch.float64) delta_t tensor(0.1781, dtype=torch.float64)
19 gae_duplicate tensor(0.1781, dtype=torch.float64) tensor(-0.3700, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8498, dtype=torch.float64) delta_t tensor(0.8187, dtype=torch.float64)
18 gae_duplicate tensor(0.9612, dtype=torch.float64) tensor(-1.9973, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8521, dtype=torch.float64) delta_t tensor(0.7476, dtype=torch.float64)
17 gae_duplicate tensor(1.5165, dtype=torch.float64) tensor(-3.1558, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8544, dtype=torch.float64) delta_t tensor(0.5339, dtype=torch.float64)
16 gae_duplicate tensor(1.7471, dtype=torch.float64) tensor(-3.6304, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8567, dtype=torch.float64) delta_t tensor(0.6899, dtype=torch.float64)
15 gae_duplicate tensor(2.0876, dtype=torch.float64) tensor(-4.3441, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8591, dtype=torch.float64) delta_t tensor(0.7031, dtype=torch.float64)
14 gae_duplicate tensor(2.3731, dtype=torch.float64) tensor(-4.9455, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8615, dtype=torch.float64) delta_t tensor(0.6896, dtype=torch.float64)
13 gae_duplicate tensor(2.5881, dtype=torch.float64) tensor(-5.3779, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5717, dtype=torch.float64) delta_t tensor(0.4028, dtype=torch.float64)
12 gae_duplicate tensor(2.4733, dtype=torch.float64) tensor(-5.1468, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5145, dtype=torch.float64) delta_t tensor(0.4481, dtype=torch.float64)
11 gae_duplicate tensor(2.4267, dtype=torch.float64) tensor(-5.0352, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2823, dtype=torch.float64) delta_t tensor(0.0834, dtype=torch.float64)
10 gae_duplicate tensor(2.0248, dtype=torch.float64) tensor(-4.2135, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1664, dtype=torch.float64) delta_t tensor(-0.0426, dtype=torch.float64)
9 gae_duplicate tensor(1.5773, dtype=torch.float64) tensor(-3.2727, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6471, dtype=torch.float64) delta_t tensor(-0.5588, dtype=torch.float64)
8 gae_duplicate tensor(0.7030, dtype=torch.float64) tensor(-1.4629, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2421, dtype=torch.float64) delta_t tensor(-0.4152, dtype=torch.float64)
7 gae_duplicate tensor(0.1472, dtype=torch.float64) tensor(-0.3058, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5693, dtype=torch.float64) delta_t tensor(0.3842, dtype=torch.float64)
6 gae_duplicate tensor(0.5020, dtype=torch.float64) tensor(-1.0446, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1092, dtype=torch.float64) delta_t tensor(-1.2282, dtype=torch.float64)
5 gae_duplicate tensor(-0.8267, dtype=torch.float64) tensor(1.7177, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1035, dtype=torch.float64) delta_t tensor(-0.1293, dtype=torch.float64)
4 gae_duplicate tensor(-0.7906, dtype=torch.float64) tensor(1.6405, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2268, dtype=torch.float64) delta_t tensor(-1.4594, dtype=torch.float64)
3 gae_duplicate tensor(-2.0919, dtype=torch.float64) tensor(4.3470, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0582, dtype=torch.float64) delta_t tensor(-0.8127, dtype=torch.float64)
2 gae_duplicate tensor(-2.4862, dtype=torch.float64) tensor(5.1810, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:187.374755859375
value loss:81.33525848388672
entropies:37.42987823486328
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.333978176116943 seconds
19 rew tensor(0.8367, dtype=torch.float64) delta_t tensor(0.0478, dtype=torch.float64)
19 gae_duplicate tensor(0.0478, dtype=torch.float64) tensor(-0.0994, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8388, dtype=torch.float64) delta_t tensor(0.7370, dtype=torch.float64)
18 gae_duplicate tensor(0.7753, dtype=torch.float64) tensor(-1.6111, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8409, dtype=torch.float64) delta_t tensor(0.8807, dtype=torch.float64)
17 gae_duplicate tensor(1.5009, dtype=torch.float64) tensor(-3.1274, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8431, dtype=torch.float64) delta_t tensor(0.6015, dtype=torch.float64)
16 gae_duplicate tensor(1.8023, dtype=torch.float64) tensor(-3.7552, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8452, dtype=torch.float64) delta_t tensor(0.5409, dtype=torch.float64)
15 gae_duplicate tensor(1.9828, dtype=torch.float64) tensor(-4.1258, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8474, dtype=torch.float64) delta_t tensor(0.6779, dtype=torch.float64)
14 gae_duplicate tensor(2.2641, dtype=torch.float64) tensor(-4.7050, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8496, dtype=torch.float64) delta_t tensor(0.6801, dtype=torch.float64)
13 gae_duplicate tensor(2.4914, dtype=torch.float64) tensor(-5.1910, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8518, dtype=torch.float64) delta_t tensor(0.6823, dtype=torch.float64)
12 gae_duplicate tensor(2.6754, dtype=torch.float64) tensor(-5.5671, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8540, dtype=torch.float64) delta_t tensor(0.6845, dtype=torch.float64)
11 gae_duplicate tensor(2.8248, dtype=torch.float64) tensor(-5.8624, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8562, dtype=torch.float64) delta_t tensor(0.8564, dtype=torch.float64)
10 gae_duplicate tensor(3.1163, dtype=torch.float64) tensor(-6.4672, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8585, dtype=torch.float64) delta_t tensor(0.6838, dtype=torch.float64)
9 gae_duplicate tensor(3.1768, dtype=torch.float64) tensor(-6.6016, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7343, dtype=torch.float64) delta_t tensor(-0.9541, dtype=torch.float64)
8 gae_duplicate tensor(1.5873, dtype=torch.float64) tensor(-3.3030, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-3.1269, dtype=torch.float64) delta_t tensor(-3.1784, dtype=torch.float64)
7 gae_duplicate tensor(-1.9085, dtype=torch.float64) tensor(3.9660, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.4872, dtype=torch.float64) delta_t tensor(-2.6126, dtype=torch.float64)
6 gae_duplicate tensor(-4.1394, dtype=torch.float64) tensor(8.6132, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.3987, dtype=torch.float64) delta_t tensor(-2.4261, dtype=torch.float64)
5 gae_duplicate tensor(-5.7376, dtype=torch.float64) tensor(11.9549, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0723, dtype=torch.float64) delta_t tensor(-2.1386, dtype=torch.float64)
4 gae_duplicate tensor(-6.7287, dtype=torch.float64) tensor(13.9640, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0315, dtype=torch.float64) delta_t tensor(0.0268, dtype=torch.float64)
3 gae_duplicate tensor(-5.3562, dtype=torch.float64) tensor(10.9326, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4391, dtype=torch.float64) delta_t tensor(-0.6698, dtype=torch.float64)
2 gae_duplicate tensor(-4.9547, dtype=torch.float64) tensor(10.2825, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-56.90400314331055
value loss:316.5592956542969
entropies:37.429134368896484
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.591420888900757 seconds
19 rew tensor(0.8408, dtype=torch.float64) delta_t tensor(0.0597, dtype=torch.float64)
19 gae_duplicate tensor(0.0597, dtype=torch.float64) tensor(-0.1242, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8428, dtype=torch.float64) delta_t tensor(0.6487, dtype=torch.float64)
18 gae_duplicate tensor(0.6964, dtype=torch.float64) tensor(-1.4473, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8448, dtype=torch.float64) delta_t tensor(0.6114, dtype=torch.float64)
17 gae_duplicate tensor(1.1685, dtype=torch.float64) tensor(-2.4342, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8469, dtype=torch.float64) delta_t tensor(0.6691, dtype=torch.float64)
16 gae_duplicate tensor(1.6040, dtype=torch.float64) tensor(-3.3412, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8489, dtype=torch.float64) delta_t tensor(0.6712, dtype=torch.float64)
15 gae_duplicate tensor(1.9543, dtype=torch.float64) tensor(-4.0616, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8510, dtype=torch.float64) delta_t tensor(0.6732, dtype=torch.float64)
14 gae_duplicate tensor(2.2367, dtype=torch.float64) tensor(-4.6538, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8530, dtype=torch.float64) delta_t tensor(0.6753, dtype=torch.float64)
13 gae_duplicate tensor(2.4647, dtype=torch.float64) tensor(-5.1221, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8551, dtype=torch.float64) delta_t tensor(0.7115, dtype=torch.float64)
12 gae_duplicate tensor(2.6832, dtype=torch.float64) tensor(-5.5829, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8572, dtype=torch.float64) delta_t tensor(0.5422, dtype=torch.float64)
11 gae_duplicate tensor(2.6888, dtype=torch.float64) tensor(-5.5880, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4566, dtype=torch.float64) delta_t tensor(0.3681, dtype=torch.float64)
10 gae_duplicate tensor(2.5191, dtype=torch.float64) tensor(-5.2353, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4000, dtype=torch.float64) delta_t tensor(0.4277, dtype=torch.float64)
9 gae_duplicate tensor(2.4430, dtype=torch.float64) tensor(-5.0711, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5177, dtype=torch.float64) delta_t tensor(-0.7834, dtype=torch.float64)
8 gae_duplicate tensor(1.1710, dtype=torch.float64) tensor(-2.4392, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6907, dtype=torch.float64) delta_t tensor(-0.9863, dtype=torch.float64)
7 gae_duplicate tensor(-0.0495, dtype=torch.float64) tensor(0.1028, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8067, dtype=torch.float64) delta_t tensor(-0.9850, dtype=torch.float64)
6 gae_duplicate tensor(-1.0246, dtype=torch.float64) tensor(2.1318, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3240, dtype=torch.float64) delta_t tensor(-1.3553, dtype=torch.float64)
5 gae_duplicate tensor(-2.1750, dtype=torch.float64) tensor(4.5201, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2974, dtype=torch.float64) delta_t tensor(-0.1333, dtype=torch.float64)
4 gae_duplicate tensor(-1.8733, dtype=torch.float64) tensor(3.8977, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6147, dtype=torch.float64) delta_t tensor(-2.0087, dtype=torch.float64)
3 gae_duplicate tensor(-3.5073, dtype=torch.float64) tensor(7.2891, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6476, dtype=torch.float64) delta_t tensor(-0.7258, dtype=torch.float64)
2 gae_duplicate tensor(-3.5316, dtype=torch.float64) tensor(7.3395, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:117.796875
value loss:122.25587463378906
entropies:37.429908752441406
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.209573745727539 seconds
19 rew tensor(0.8436, dtype=torch.float64) delta_t tensor(-0.1568, dtype=torch.float64)
19 gae_duplicate tensor(-0.1568, dtype=torch.float64) tensor(0.3263, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8455, dtype=torch.float64) delta_t tensor(0.6454, dtype=torch.float64)
18 gae_duplicate tensor(0.5200, dtype=torch.float64) tensor(-1.0796, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7906, dtype=torch.float64) delta_t tensor(0.5928, dtype=torch.float64)
17 gae_duplicate tensor(1.0088, dtype=torch.float64) tensor(-2.0988, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7923, dtype=torch.float64) delta_t tensor(0.8103, dtype=torch.float64)
16 gae_duplicate tensor(1.6174, dtype=torch.float64) tensor(-3.3649, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6806, dtype=torch.float64) delta_t tensor(0.3707, dtype=torch.float64)
15 gae_duplicate tensor(1.6646, dtype=torch.float64) tensor(-3.4666, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5685, dtype=torch.float64) delta_t tensor(0.2379, dtype=torch.float64)
14 gae_duplicate tensor(1.5696, dtype=torch.float64) tensor(-3.2590, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3428, dtype=torch.float64) delta_t tensor(0.0522, dtype=torch.float64)
13 gae_duplicate tensor(1.3078, dtype=torch.float64) tensor(-2.7209, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8527, dtype=torch.float64) delta_t tensor(0.8232, dtype=torch.float64)
12 gae_duplicate tensor(1.8695, dtype=torch.float64) tensor(-3.8894, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7981, dtype=torch.float64) delta_t tensor(0.6250, dtype=torch.float64)
11 gae_duplicate tensor(2.1206, dtype=torch.float64) tensor(-4.4117, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6867, dtype=torch.float64) delta_t tensor(0.3863, dtype=torch.float64)
10 gae_duplicate tensor(2.0827, dtype=torch.float64) tensor(-4.3288, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5751, dtype=torch.float64) delta_t tensor(0.4109, dtype=torch.float64)
9 gae_duplicate tensor(2.0771, dtype=torch.float64) tensor(-4.3170, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.7948, dtype=torch.float64) delta_t tensor(-1.7901, dtype=torch.float64)
8 gae_duplicate tensor(-0.1285, dtype=torch.float64) tensor(0.2675, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7860, dtype=torch.float64) delta_t tensor(-0.9629, dtype=torch.float64)
7 gae_duplicate tensor(-1.0656, dtype=torch.float64) tensor(2.2148, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.2592, dtype=torch.float64) delta_t tensor(-2.3885, dtype=torch.float64)
6 gae_duplicate tensor(-3.2410, dtype=torch.float64) tensor(6.7361, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.7905, dtype=torch.float64) delta_t tensor(-3.1343, dtype=torch.float64)
5 gae_duplicate tensor(-5.7271, dtype=torch.float64) tensor(11.9034, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3650, dtype=torch.float64) delta_t tensor(-2.4160, dtype=torch.float64)
4 gae_duplicate tensor(-6.9977, dtype=torch.float64) tensor(14.5439, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8254, dtype=torch.float64) delta_t tensor(-1.1524, dtype=torch.float64)
3 gae_duplicate tensor(-6.7505, dtype=torch.float64) tensor(14.0586, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7695, dtype=torch.float64) delta_t tensor(-0.9649, dtype=torch.float64)
2 gae_duplicate tensor(-6.3653, dtype=torch.float64) tensor(13.2298, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-183.18399047851562
value loss:310.5415344238281
entropies:37.42991638183594
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.409836053848267 seconds
19 rew tensor(0.8504, dtype=torch.float64) delta_t tensor(-0.1354, dtype=torch.float64)
19 gae_duplicate tensor(-0.1354, dtype=torch.float64) tensor(0.2813, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8523, dtype=torch.float64) delta_t tensor(0.4910, dtype=torch.float64)
18 gae_duplicate tensor(0.3827, dtype=torch.float64) tensor(-0.7962, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8541, dtype=torch.float64) delta_t tensor(0.7523, dtype=torch.float64)
17 gae_duplicate tensor(1.0585, dtype=torch.float64) tensor(-2.2002, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8560, dtype=torch.float64) delta_t tensor(0.6516, dtype=torch.float64)
16 gae_duplicate tensor(1.4984, dtype=torch.float64) tensor(-3.1146, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8579, dtype=torch.float64) delta_t tensor(0.6544, dtype=torch.float64)
15 gae_duplicate tensor(1.8532, dtype=torch.float64) tensor(-3.8486, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8598, dtype=torch.float64) delta_t tensor(0.6589, dtype=torch.float64)
14 gae_duplicate tensor(2.1414, dtype=torch.float64) tensor(-4.4510, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6316, dtype=torch.float64) delta_t tensor(0.4558, dtype=torch.float64)
13 gae_duplicate tensor(2.1689, dtype=torch.float64) tensor(-4.5082, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1731, dtype=torch.float64) delta_t tensor(-0.1049, dtype=torch.float64)
12 gae_duplicate tensor(1.6302, dtype=torch.float64) tensor(-3.3916, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1710, dtype=torch.float64) delta_t tensor(-0.4961, dtype=torch.float64)
11 gae_duplicate tensor(0.8081, dtype=torch.float64) tensor(-1.6811, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0566, dtype=torch.float64) delta_t tensor(-0.2608, dtype=torch.float64)
10 gae_duplicate tensor(0.3857, dtype=torch.float64) tensor(-0.8010, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5730, dtype=torch.float64) delta_t tensor(0.6668, dtype=torch.float64)
9 gae_duplicate tensor(0.9754, dtype=torch.float64) tensor(-2.0274, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1736, dtype=torch.float64) delta_t tensor(-0.0856, dtype=torch.float64)
8 gae_duplicate tensor(0.6947, dtype=torch.float64) tensor(-1.4465, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1739, dtype=torch.float64) delta_t tensor(-0.2141, dtype=torch.float64)
7 gae_duplicate tensor(0.3417, dtype=torch.float64) tensor(-0.7102, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7387, dtype=torch.float64) delta_t tensor(-1.0207, dtype=torch.float64)
6 gae_duplicate tensor(-0.7474, dtype=torch.float64) tensor(1.5521, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3103, dtype=torch.float64) delta_t tensor(-1.3706, dtype=torch.float64)
5 gae_duplicate tensor(-1.9685, dtype=torch.float64) tensor(4.0915, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1736, dtype=torch.float64) delta_t tensor(0.0894, dtype=torch.float64)
4 gae_duplicate tensor(-1.4853, dtype=torch.float64) tensor(3.0901, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6298, dtype=torch.float64) delta_t tensor(-0.9122, dtype=torch.float64)
3 gae_duplicate tensor(-2.1005, dtype=torch.float64) tensor(4.3660, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2005, dtype=torch.float64) delta_t tensor(-1.5021, dtype=torch.float64)
2 gae_duplicate tensor(-3.1825, dtype=torch.float64) tensor(6.6094, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:52.79271697998047
value loss:63.666656494140625
entropies:37.429931640625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.1526)
ToM Target loss= tensor(300.9958)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.224866151809692 seconds
19 rew tensor(0.8552, dtype=torch.float64) delta_t tensor(-0.2959, dtype=torch.float64)
19 gae_duplicate tensor(-0.2959, dtype=torch.float64) tensor(0.6155, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8570, dtype=torch.float64) delta_t tensor(0.6268, dtype=torch.float64)
18 gae_duplicate tensor(0.3901, dtype=torch.float64) tensor(-0.8108, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8588, dtype=torch.float64) delta_t tensor(0.6286, dtype=torch.float64)
17 gae_duplicate tensor(0.9406, dtype=torch.float64) tensor(-1.9552, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8035, dtype=torch.float64) delta_t tensor(0.5776, dtype=torch.float64)
16 gae_duplicate tensor(1.3301, dtype=torch.float64) tensor(-2.7688, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6909, dtype=torch.float64) delta_t tensor(0.6078, dtype=torch.float64)
15 gae_duplicate tensor(1.6718, dtype=torch.float64) tensor(-3.4778, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5781, dtype=torch.float64) delta_t tensor(0.2284, dtype=torch.float64)
14 gae_duplicate tensor(1.5659, dtype=torch.float64) tensor(-3.2574, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4650, dtype=torch.float64) delta_t tensor(0.3324, dtype=torch.float64)
13 gae_duplicate tensor(1.5851, dtype=torch.float64) tensor(-3.2950, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8073, dtype=torch.float64) delta_t tensor(0.6930, dtype=torch.float64)
12 gae_duplicate tensor(1.9611, dtype=torch.float64) tensor(-4.0795, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7520, dtype=torch.float64) delta_t tensor(0.5440, dtype=torch.float64)
11 gae_duplicate tensor(2.1130, dtype=torch.float64) tensor(-4.3922, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5828, dtype=torch.float64) delta_t tensor(0.3095, dtype=torch.float64)
10 gae_duplicate tensor(1.9999, dtype=torch.float64) tensor(-4.1571, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5530, dtype=torch.float64) delta_t tensor(-0.9111, dtype=torch.float64)
9 gae_duplicate tensor(0.6889, dtype=torch.float64) tensor(-1.4330, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6107, dtype=torch.float64) delta_t tensor(-0.5707, dtype=torch.float64)
8 gae_duplicate tensor(-0.0196, dtype=torch.float64) tensor(0.0408, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.9169, dtype=torch.float64) delta_t tensor(-2.1302, dtype=torch.float64)
7 gae_duplicate tensor(-2.1459, dtype=torch.float64) tensor(4.4639, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.9849, dtype=torch.float64) delta_t tensor(-2.2984, dtype=torch.float64)
6 gae_duplicate tensor(-4.0151, dtype=torch.float64) tensor(8.3462, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.7399, dtype=torch.float64) delta_t tensor(-3.1250, dtype=torch.float64)
5 gae_duplicate tensor(-6.3371, dtype=torch.float64) tensor(13.1825, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0202, dtype=torch.float64) delta_t tensor(-2.2472, dtype=torch.float64)
4 gae_duplicate tensor(-7.3169, dtype=torch.float64) tensor(15.1986, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4137, dtype=torch.float64) delta_t tensor(-0.5250, dtype=torch.float64)
3 gae_duplicate tensor(-6.3785, dtype=torch.float64) tensor(13.2590, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4721, dtype=torch.float64) delta_t tensor(-0.2400, dtype=torch.float64)
2 gae_duplicate tensor(-5.3427, dtype=torch.float64) tensor(11.1060, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-220.6367645263672
value loss:310.6361999511719
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.516112804412842 seconds
19 rew tensor(0.8605, dtype=torch.float64) delta_t tensor(-0.3384, dtype=torch.float64)
19 gae_duplicate tensor(-0.3384, dtype=torch.float64) tensor(0.7035, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8622, dtype=torch.float64) delta_t tensor(0.8707, dtype=torch.float64)
18 gae_duplicate tensor(0.5999, dtype=torch.float64) tensor(-1.2486, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8071, dtype=torch.float64) delta_t tensor(0.5201, dtype=torch.float64)
17 gae_duplicate tensor(1.0001, dtype=torch.float64) tensor(-2.0814, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8086, dtype=torch.float64) delta_t tensor(0.6105, dtype=torch.float64)
16 gae_duplicate tensor(1.4105, dtype=torch.float64) tensor(-2.9339, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7534, dtype=torch.float64) delta_t tensor(0.5584, dtype=torch.float64)
15 gae_duplicate tensor(1.6868, dtype=torch.float64) tensor(-3.5086, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6980, dtype=torch.float64) delta_t tensor(0.3511, dtype=torch.float64)
14 gae_duplicate tensor(1.7005, dtype=torch.float64) tensor(-3.5330, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4723, dtype=torch.float64) delta_t tensor(0.1463, dtype=torch.float64)
13 gae_duplicate tensor(1.5067, dtype=torch.float64) tensor(-3.1322, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8697, dtype=torch.float64) delta_t tensor(0.6179, dtype=torch.float64)
12 gae_duplicate tensor(1.8232, dtype=torch.float64) tensor(-3.7946, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8714, dtype=torch.float64) delta_t tensor(0.6197, dtype=torch.float64)
11 gae_duplicate tensor(2.0783, dtype=torch.float64) tensor(-4.3254, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(0.7950, dtype=torch.float64)
10 gae_duplicate tensor(2.4576, dtype=torch.float64) tensor(-5.1119, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5600, dtype=torch.float64) delta_t tensor(-1.7542, dtype=torch.float64)
9 gae_duplicate tensor(0.2119, dtype=torch.float64) tensor(-0.4407, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6230, dtype=torch.float64) delta_t tensor(-1.9156, dtype=torch.float64)
8 gae_duplicate tensor(-1.7461, dtype=torch.float64) tensor(3.6278, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7775, dtype=torch.float64) delta_t tensor(-0.9637, dtype=torch.float64)
7 gae_duplicate tensor(-2.3606, dtype=torch.float64) tensor(4.9073, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.3695, dtype=torch.float64) delta_t tensor(-2.7635, dtype=torch.float64)
6 gae_duplicate tensor(-4.6519, dtype=torch.float64) tensor(9.6706, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0454, dtype=torch.float64) delta_t tensor(-2.2792, dtype=torch.float64)
5 gae_duplicate tensor(-6.0008, dtype=torch.float64) tensor(12.4818, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9687, dtype=torch.float64) delta_t tensor(-1.1423, dtype=torch.float64)
4 gae_duplicate tensor(-5.9430, dtype=torch.float64) tensor(12.3474, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5696, dtype=torch.float64) delta_t tensor(-0.7080, dtype=torch.float64)
3 gae_duplicate tensor(-5.4623, dtype=torch.float64) tensor(11.3551, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5705, dtype=torch.float64) delta_t tensor(-0.7896, dtype=torch.float64)
2 gae_duplicate tensor(-5.1595, dtype=torch.float64) tensor(10.7318, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-215.41213989257812
value loss:274.8687744140625
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4731879234313965 seconds
19 rew tensor(0.8651, dtype=torch.float64) delta_t tensor(-0.4271, dtype=torch.float64)
19 gae_duplicate tensor(-0.4271, dtype=torch.float64) tensor(0.8880, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8667, dtype=torch.float64) delta_t tensor(0.5940, dtype=torch.float64)
18 gae_duplicate tensor(0.2523, dtype=torch.float64) tensor(-0.5244, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8684, dtype=torch.float64) delta_t tensor(0.9077, dtype=torch.float64)
17 gae_duplicate tensor(1.1095, dtype=torch.float64) tensor(-2.3057, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8700, dtype=torch.float64) delta_t tensor(0.6371, dtype=torch.float64)
16 gae_duplicate tensor(1.5247, dtype=torch.float64) tensor(-3.1699, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8717, dtype=torch.float64) delta_t tensor(0.6567, dtype=torch.float64)
15 gae_duplicate tensor(1.8765, dtype=torch.float64) tensor(-3.9012, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8734, dtype=torch.float64) delta_t tensor(0.6808, dtype=torch.float64)
14 gae_duplicate tensor(2.1820, dtype=torch.float64) tensor(-4.5383, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8751, dtype=torch.float64) delta_t tensor(0.6350, dtype=torch.float64)
13 gae_duplicate tensor(2.3806, dtype=torch.float64) tensor(-4.9513, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3596, dtype=torch.float64) delta_t tensor(0.0629, dtype=torch.float64)
12 gae_duplicate tensor(1.9673, dtype=torch.float64) tensor(-4.0936, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1878, dtype=torch.float64) delta_t tensor(0.2711, dtype=torch.float64)
11 gae_duplicate tensor(1.8449, dtype=torch.float64) tensor(-3.8357, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0160, dtype=torch.float64) delta_t tensor(-0.4869, dtype=torch.float64)
10 gae_duplicate tensor(0.9891, dtype=torch.float64) tensor(-2.0564, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3277, dtype=torch.float64) delta_t tensor(-0.6133, dtype=torch.float64)
9 gae_duplicate tensor(0.1780, dtype=torch.float64) tensor(-0.3702, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7859, dtype=torch.float64) delta_t tensor(-0.7864, dtype=torch.float64)
8 gae_duplicate tensor(-0.6440, dtype=torch.float64) tensor(1.3389, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2725, dtype=torch.float64) delta_t tensor(-0.3310, dtype=torch.float64)
7 gae_duplicate tensor(-0.8462, dtype=torch.float64) tensor(1.7600, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0157, dtype=torch.float64) delta_t tensor(-1.2488, dtype=torch.float64)
6 gae_duplicate tensor(-1.9258, dtype=torch.float64) tensor(4.0054, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4678, dtype=torch.float64) delta_t tensor(0.3328, dtype=torch.float64)
5 gae_duplicate tensor(-1.2078, dtype=torch.float64) tensor(2.5099, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6164, dtype=torch.float64) delta_t tensor(-0.7765, dtype=torch.float64)
4 gae_duplicate tensor(-1.7427, dtype=torch.float64) tensor(3.6216, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2385, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
3 gae_duplicate tensor(-1.4063, dtype=torch.float64) tensor(2.9238, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9581, dtype=torch.float64) delta_t tensor(-0.7718, dtype=torch.float64)
2 gae_duplicate tensor(-1.8968, dtype=torch.float64) tensor(3.9434, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:51.411991119384766
value loss:61.420387268066406
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.450471878051758 seconds
19 rew tensor(0.8625, dtype=torch.float64) delta_t tensor(-0.2485, dtype=torch.float64)
19 gae_duplicate tensor(-0.2485, dtype=torch.float64) tensor(0.5165, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8641, dtype=torch.float64) delta_t tensor(0.7427, dtype=torch.float64)
18 gae_duplicate tensor(0.5439, dtype=torch.float64) tensor(-1.1309, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8657, dtype=torch.float64) delta_t tensor(0.6262, dtype=torch.float64)
17 gae_duplicate tensor(1.0613, dtype=torch.float64) tensor(-2.2067, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8673, dtype=torch.float64) delta_t tensor(0.7395, dtype=torch.float64)
16 gae_duplicate tensor(1.5886, dtype=torch.float64) tensor(-3.3030, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8689, dtype=torch.float64) delta_t tensor(0.7044, dtype=torch.float64)
15 gae_duplicate tensor(1.9753, dtype=torch.float64) tensor(-4.1081, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8705, dtype=torch.float64) delta_t tensor(0.5905, dtype=torch.float64)
14 gae_duplicate tensor(2.1707, dtype=torch.float64) tensor(-4.5146, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8721, dtype=torch.float64) delta_t tensor(0.6662, dtype=torch.float64)
13 gae_duplicate tensor(2.4027, dtype=torch.float64) tensor(-4.9971, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8737, dtype=torch.float64) delta_t tensor(0.6636, dtype=torch.float64)
12 gae_duplicate tensor(2.5858, dtype=torch.float64) tensor(-5.3747, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7595, dtype=torch.float64) delta_t tensor(0.5476, dtype=torch.float64)
11 gae_duplicate tensor(2.6163, dtype=torch.float64) tensor(-5.4428, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7029, dtype=torch.float64) delta_t tensor(0.4738, dtype=torch.float64)
10 gae_duplicate tensor(2.5669, dtype=torch.float64) tensor(-5.3384, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4726, dtype=torch.float64) delta_t tensor(0.2355, dtype=torch.float64)
9 gae_duplicate tensor(2.2890, dtype=torch.float64) tensor(-4.7618, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3576, dtype=torch.float64) delta_t tensor(0.4584, dtype=torch.float64)
8 gae_duplicate tensor(2.2896, dtype=torch.float64) tensor(-4.7618, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4735, dtype=torch.float64) delta_t tensor(0.1438, dtype=torch.float64)
7 gae_duplicate tensor(1.9755, dtype=torch.float64) tensor(-4.1076, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3915, dtype=torch.float64) delta_t tensor(-0.5157, dtype=torch.float64)
6 gae_duplicate tensor(1.0648, dtype=torch.float64) tensor(-2.2138, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5073, dtype=torch.float64) delta_t tensor(-0.8894, dtype=torch.float64)
5 gae_duplicate tensor(-0.0376, dtype=torch.float64) tensor(0.0782, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3145, dtype=torch.float64) delta_t tensor(-1.4665, dtype=torch.float64)
4 gae_duplicate tensor(-1.4966, dtype=torch.float64) tensor(3.1108, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2031, dtype=torch.float64) delta_t tensor(-1.1985, dtype=torch.float64)
3 gae_duplicate tensor(-2.3957, dtype=torch.float64) tensor(4.9824, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9755, dtype=torch.float64) delta_t tensor(-1.3574, dtype=torch.float64)
2 gae_duplicate tensor(-3.2740, dtype=torch.float64) tensor(6.8109, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:219.4514617919922
value loss:109.09919738769531
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.6653218269348145 seconds
19 rew tensor(0.8596, dtype=torch.float64) delta_t tensor(-0.4277, dtype=torch.float64)
19 gae_duplicate tensor(-0.4277, dtype=torch.float64) tensor(0.8895, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8611, dtype=torch.float64) delta_t tensor(0.5956, dtype=torch.float64)
18 gae_duplicate tensor(0.2534, dtype=torch.float64) tensor(-0.5271, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8626, dtype=torch.float64) delta_t tensor(0.8413, dtype=torch.float64)
17 gae_duplicate tensor(1.0441, dtype=torch.float64) tensor(-2.1712, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8642, dtype=torch.float64) delta_t tensor(0.5803, dtype=torch.float64)
16 gae_duplicate tensor(1.4156, dtype=torch.float64) tensor(-2.9438, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8657, dtype=torch.float64) delta_t tensor(0.6753, dtype=torch.float64)
15 gae_duplicate tensor(1.8078, dtype=torch.float64) tensor(-3.7584, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8672, dtype=torch.float64) delta_t tensor(0.6432, dtype=torch.float64)
14 gae_duplicate tensor(2.0894, dtype=torch.float64) tensor(-4.3445, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8687, dtype=torch.float64) delta_t tensor(0.6441, dtype=torch.float64)
13 gae_duplicate tensor(2.3156, dtype=torch.float64) tensor(-4.8149, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8703, dtype=torch.float64) delta_t tensor(0.6405, dtype=torch.float64)
12 gae_duplicate tensor(2.4930, dtype=torch.float64) tensor(-5.1836, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8718, dtype=torch.float64) delta_t tensor(0.6441, dtype=torch.float64)
11 gae_duplicate tensor(2.6385, dtype=torch.float64) tensor(-5.4854, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8734, dtype=torch.float64) delta_t tensor(0.7326, dtype=torch.float64)
10 gae_duplicate tensor(2.8434, dtype=torch.float64) tensor(-5.9131, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5252, dtype=torch.float64) delta_t tensor(0.1224, dtype=torch.float64)
9 gae_duplicate tensor(2.3971, dtype=torch.float64) tensor(-4.9857, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4094, dtype=torch.float64) delta_t tensor(0.2623, dtype=torch.float64)
8 gae_duplicate tensor(2.1800, dtype=torch.float64) tensor(-4.5329, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3516, dtype=torch.float64) delta_t tensor(0.0560, dtype=torch.float64)
7 gae_duplicate tensor(1.8000, dtype=torch.float64) tensor(-3.7422, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2877, dtype=torch.float64) delta_t tensor(-0.2386, dtype=torch.float64)
6 gae_duplicate tensor(1.2014, dtype=torch.float64) tensor(-2.4981, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5785, dtype=torch.float64) delta_t tensor(-0.9483, dtype=torch.float64)
5 gae_duplicate tensor(0.0129, dtype=torch.float64) tensor(-0.0267, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2180, dtype=torch.float64) delta_t tensor(-1.3455, dtype=torch.float64)
4 gae_duplicate tensor(-1.3352, dtype=torch.float64) tensor(2.7767, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2211, dtype=torch.float64) delta_t tensor(-1.1754, dtype=torch.float64)
3 gae_duplicate tensor(-2.2435, dtype=torch.float64) tensor(4.6656, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0499, dtype=torch.float64) delta_t tensor(-0.9857, dtype=torch.float64)
2 gae_duplicate tensor(-2.7805, dtype=torch.float64) tensor(5.7816, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:219.76316833496094
value loss:100.9925308227539
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(417.1685)
ToM Target loss= tensor(300.6536)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.5966010093688965 seconds
19 rew tensor(0.8633, dtype=torch.float64) delta_t tensor(-0.2509, dtype=torch.float64)
19 gae_duplicate tensor(-0.2509, dtype=torch.float64) tensor(0.5217, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8648, dtype=torch.float64) delta_t tensor(0.5605, dtype=torch.float64)
18 gae_duplicate tensor(0.3598, dtype=torch.float64) tensor(-0.7481, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8662, dtype=torch.float64) delta_t tensor(0.7402, dtype=torch.float64)
17 gae_duplicate tensor(1.0280, dtype=torch.float64) tensor(-2.1377, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8677, dtype=torch.float64) delta_t tensor(0.6340, dtype=torch.float64)
16 gae_duplicate tensor(1.4563, dtype=torch.float64) tensor(-3.0285, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8692, dtype=torch.float64) delta_t tensor(0.6103, dtype=torch.float64)
15 gae_duplicate tensor(1.7754, dtype=torch.float64) tensor(-3.6917, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8706, dtype=torch.float64) delta_t tensor(0.6429, dtype=torch.float64)
14 gae_duplicate tensor(2.0632, dtype=torch.float64) tensor(-4.2902, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8721, dtype=torch.float64) delta_t tensor(0.7360, dtype=torch.float64)
13 gae_duplicate tensor(2.3866, dtype=torch.float64) tensor(-4.9629, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8736, dtype=torch.float64) delta_t tensor(0.5841, dtype=torch.float64)
12 gae_duplicate tensor(2.4934, dtype=torch.float64) tensor(-5.1849, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4052, dtype=torch.float64) delta_t tensor(0.1556, dtype=torch.float64)
11 gae_duplicate tensor(2.1503, dtype=torch.float64) tensor(-4.4715, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4056, dtype=torch.float64) delta_t tensor(-0.0096, dtype=torch.float64)
10 gae_duplicate tensor(1.7107, dtype=torch.float64) tensor(-3.5571, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2977, dtype=torch.float64) delta_t tensor(0.0241, dtype=torch.float64)
9 gae_duplicate tensor(1.3926, dtype=torch.float64) tensor(-2.8959, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0637, dtype=torch.float64) delta_t tensor(-0.4554, dtype=torch.float64)
8 gae_duplicate tensor(0.6587, dtype=torch.float64) tensor(-1.3699, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5321, dtype=torch.float64) delta_t tensor(-0.9668, dtype=torch.float64)
7 gae_duplicate tensor(-0.4398, dtype=torch.float64) tensor(0.9144, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0007, dtype=torch.float64) delta_t tensor(-1.3314, dtype=torch.float64)
6 gae_duplicate tensor(-1.6832, dtype=torch.float64) tensor(3.5000, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4122, dtype=torch.float64) delta_t tensor(-1.2094, dtype=torch.float64)
5 gae_duplicate tensor(-2.5559, dtype=torch.float64) tensor(5.3150, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3038, dtype=torch.float64) delta_t tensor(-0.7403, dtype=torch.float64)
4 gae_duplicate tensor(-2.7851, dtype=torch.float64) tensor(5.7912, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5913, dtype=torch.float64) delta_t tensor(-1.7783, dtype=torch.float64)
3 gae_duplicate tensor(-4.0064, dtype=torch.float64) tensor(8.3312, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3664, dtype=torch.float64) delta_t tensor(-0.1197, dtype=torch.float64)
2 gae_duplicate tensor(-3.3248, dtype=torch.float64) tensor(6.9137, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:29.184370040893555
value loss:115.55523681640625
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.614964008331299 seconds
19 rew tensor(0.8633, dtype=torch.float64) delta_t tensor(-0.4006, dtype=torch.float64)
19 gae_duplicate tensor(-0.4006, dtype=torch.float64) tensor(0.8331, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8647, dtype=torch.float64) delta_t tensor(0.6345, dtype=torch.float64)
18 gae_duplicate tensor(0.3140, dtype=torch.float64) tensor(-0.6529, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8661, dtype=torch.float64) delta_t tensor(0.5926, dtype=torch.float64)
17 gae_duplicate tensor(0.8438, dtype=torch.float64) tensor(-1.7548, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8675, dtype=torch.float64) delta_t tensor(0.6291, dtype=torch.float64)
16 gae_duplicate tensor(1.3042, dtype=torch.float64) tensor(-2.7120, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8689, dtype=torch.float64) delta_t tensor(0.6333, dtype=torch.float64)
15 gae_duplicate tensor(1.6766, dtype=torch.float64) tensor(-3.4868, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8704, dtype=torch.float64) delta_t tensor(0.6435, dtype=torch.float64)
14 gae_duplicate tensor(1.9848, dtype=torch.float64) tensor(-4.1277, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8718, dtype=torch.float64) delta_t tensor(0.6637, dtype=torch.float64)
13 gae_duplicate tensor(2.2515, dtype=torch.float64) tensor(-4.6814, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8732, dtype=torch.float64) delta_t tensor(0.6370, dtype=torch.float64)
12 gae_duplicate tensor(2.4382, dtype=torch.float64) tensor(-5.0703, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8747, dtype=torch.float64) delta_t tensor(0.6436, dtype=torch.float64)
11 gae_duplicate tensor(2.5942, dtype=torch.float64) tensor(-5.3944, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5809, dtype=torch.float64) delta_t tensor(0.1380, dtype=torch.float64)
10 gae_duplicate tensor(2.2133, dtype=torch.float64) tensor(-4.6023, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4046, dtype=torch.float64) delta_t tensor(0.1873, dtype=torch.float64)
9 gae_duplicate tensor(1.9580, dtype=torch.float64) tensor(-4.0714, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2282, dtype=torch.float64) delta_t tensor(-0.0655, dtype=torch.float64)
8 gae_duplicate tensor(1.5009, dtype=torch.float64) tensor(-3.1213, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0662, dtype=torch.float64) delta_t tensor(0.0959, dtype=torch.float64)
7 gae_duplicate tensor(1.2966, dtype=torch.float64) tensor(-2.6962, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8313, dtype=torch.float64) delta_t tensor(-1.4064, dtype=torch.float64)
6 gae_duplicate tensor(-0.3691, dtype=torch.float64) tensor(0.7676, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0680, dtype=torch.float64) delta_t tensor(-0.9607, dtype=torch.float64)
5 gae_duplicate tensor(-1.2560, dtype=torch.float64) tensor(2.6121, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3644, dtype=torch.float64) delta_t tensor(-1.5418, dtype=torch.float64)
4 gae_duplicate tensor(-2.5466, dtype=torch.float64) tensor(5.2956, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4270, dtype=torch.float64) delta_t tensor(-1.7557, dtype=torch.float64)
3 gae_duplicate tensor(-3.7930, dtype=torch.float64) tensor(7.8867, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0775, dtype=torch.float64) delta_t tensor(-1.3559, dtype=torch.float64)
2 gae_duplicate tensor(-4.3903, dtype=torch.float64) tensor(9.1287, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:93.9618911743164
value loss:122.53878784179688
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5367231369018555 seconds
19 rew tensor(0.8665, dtype=torch.float64) delta_t tensor(-0.4733, dtype=torch.float64)
19 gae_duplicate tensor(-0.4733, dtype=torch.float64) tensor(0.9845, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8679, dtype=torch.float64) delta_t tensor(0.5999, dtype=torch.float64)
18 gae_duplicate tensor(0.2213, dtype=torch.float64) tensor(-0.4601, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8693, dtype=torch.float64) delta_t tensor(0.6013, dtype=torch.float64)
17 gae_duplicate tensor(0.7783, dtype=torch.float64) tensor(-1.6185, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(0.5571, dtype=torch.float64)
16 gae_duplicate tensor(1.1798, dtype=torch.float64) tensor(-2.4531, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7538, dtype=torch.float64) delta_t tensor(0.4001, dtype=torch.float64)
15 gae_duplicate tensor(1.3439, dtype=torch.float64) tensor(-2.7954, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6369, dtype=torch.float64) delta_t tensor(0.2831, dtype=torch.float64)
14 gae_duplicate tensor(1.3582, dtype=torch.float64) tensor(-2.8246, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5197, dtype=torch.float64) delta_t tensor(0.1717, dtype=torch.float64)
13 gae_duplicate tensor(1.2583, dtype=torch.float64) tensor(-2.6159, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8739, dtype=torch.float64) delta_t tensor(0.7022, dtype=torch.float64)
12 gae_duplicate tensor(1.7088, dtype=torch.float64) tensor(-3.5531, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(0.4430, dtype=torch.float64)
11 gae_duplicate tensor(1.8101, dtype=torch.float64) tensor(-3.7629, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6998, dtype=torch.float64) delta_t tensor(0.4007, dtype=torch.float64)
10 gae_duplicate tensor(1.8487, dtype=torch.float64) tensor(-3.8447, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.8306, dtype=torch.float64) delta_t tensor(-2.0278, dtype=torch.float64)
9 gae_duplicate tensor(-0.5488, dtype=torch.float64) tensor(1.1414, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.9559, dtype=torch.float64) delta_t tensor(-2.2047, dtype=torch.float64)
8 gae_duplicate tensor(-2.6437, dtype=torch.float64) tensor(5.4978, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.1420, dtype=torch.float64) delta_t tensor(-2.4194, dtype=torch.float64)
7 gae_duplicate tensor(-4.5343, dtype=torch.float64) tensor(9.4280, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3815, dtype=torch.float64) delta_t tensor(-1.6554, dtype=torch.float64)
6 gae_duplicate tensor(-5.2828, dtype=torch.float64) tensor(10.9865, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9695, dtype=torch.float64) delta_t tensor(-0.7955, dtype=torch.float64)
5 gae_duplicate tensor(-5.0218, dtype=torch.float64) tensor(10.4434, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0385, dtype=torch.float64) delta_t tensor(-0.4603, dtype=torch.float64)
4 gae_duplicate tensor(-4.4777, dtype=torch.float64) tensor(9.3103, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4362, dtype=torch.float64) delta_t tensor(-0.3150, dtype=torch.float64)
3 gae_duplicate tensor(-3.8972, dtype=torch.float64) tensor(8.1048, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5553, dtype=torch.float64) delta_t tensor(-0.6227, dtype=torch.float64)
2 gae_duplicate tensor(-3.7405, dtype=torch.float64) tensor(7.7775, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-239.59817504882812
value loss:220.9878387451172
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.6258158683776855 seconds
19 rew tensor(0.8694, dtype=torch.float64) delta_t tensor(-0.5537, dtype=torch.float64)
19 gae_duplicate tensor(-0.5537, dtype=torch.float64) tensor(1.1515, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8707, dtype=torch.float64) delta_t tensor(0.5861, dtype=torch.float64)
18 gae_duplicate tensor(0.1431, dtype=torch.float64) tensor(-0.2976, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8720, dtype=torch.float64) delta_t tensor(0.5874, dtype=torch.float64)
17 gae_duplicate tensor(0.7019, dtype=torch.float64) tensor(-1.4597, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8733, dtype=torch.float64) delta_t tensor(0.5887, dtype=torch.float64)
16 gae_duplicate tensor(1.1502, dtype=torch.float64) tensor(-2.3922, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8747, dtype=torch.float64) delta_t tensor(0.5901, dtype=torch.float64)
15 gae_duplicate tensor(1.5103, dtype=torch.float64) tensor(-3.1410, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8760, dtype=torch.float64) delta_t tensor(0.8218, dtype=torch.float64)
14 gae_duplicate tensor(2.0300, dtype=torch.float64) tensor(-4.2218, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8774, dtype=torch.float64) delta_t tensor(0.6524, dtype=torch.float64)
13 gae_duplicate tensor(2.2763, dtype=torch.float64) tensor(-4.7328, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2887, dtype=torch.float64) delta_t tensor(-0.0550, dtype=torch.float64)
12 gae_duplicate tensor(1.7660, dtype=torch.float64) tensor(-3.6729, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1711, dtype=torch.float64) delta_t tensor(0.2655, dtype=torch.float64)
11 gae_duplicate tensor(1.6783, dtype=torch.float64) tensor(-3.4906, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.6547, dtype=torch.float64) delta_t tensor(-1.9266, dtype=torch.float64)
10 gae_duplicate tensor(-0.5839, dtype=torch.float64) tensor(1.2137, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8175, dtype=torch.float64) delta_t tensor(0.4227, dtype=torch.float64)
9 gae_duplicate tensor(-0.0444, dtype=torch.float64) tensor(0.0924, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4788, dtype=torch.float64) delta_t tensor(-0.9204, dtype=torch.float64)
8 gae_duplicate tensor(-0.9559, dtype=torch.float64) tensor(1.9881, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1101, dtype=torch.float64) delta_t tensor(0.2954, dtype=torch.float64)
7 gae_duplicate tensor(-0.4694, dtype=torch.float64) tensor(0.9764, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0513, dtype=torch.float64) delta_t tensor(-0.2891, dtype=torch.float64)
6 gae_duplicate tensor(-0.6646, dtype=torch.float64) tensor(1.3821, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8313, dtype=torch.float64) delta_t tensor(-2.2248, dtype=torch.float64)
5 gae_duplicate tensor(-2.7564, dtype=torch.float64) tensor(5.7326, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8974, dtype=torch.float64) delta_t tensor(-1.7160, dtype=torch.float64)
4 gae_duplicate tensor(-3.9211, dtype=torch.float64) tensor(8.1526, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1914, dtype=torch.float64) delta_t tensor(-0.6209, dtype=torch.float64)
3 gae_duplicate tensor(-3.7578, dtype=torch.float64) tensor(7.8131, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7267, dtype=torch.float64) delta_t tensor(-2.0034, dtype=torch.float64)
2 gae_duplicate tensor(-5.0097, dtype=torch.float64) tensor(10.4221, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-94.22035217285156
value loss:125.65888977050781
entropies:37.4299430847168
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.398276090621948 seconds
19 rew tensor(0.8684, dtype=torch.float64) delta_t tensor(-0.4703, dtype=torch.float64)
19 gae_duplicate tensor(-0.4703, dtype=torch.float64) tensor(0.9782, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8696, dtype=torch.float64) delta_t tensor(0.6098, dtype=torch.float64)
18 gae_duplicate tensor(0.2335, dtype=torch.float64) tensor(-0.4857, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8709, dtype=torch.float64) delta_t tensor(0.3788, dtype=torch.float64)
17 gae_duplicate tensor(0.5657, dtype=torch.float64) tensor(-1.1765, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8722, dtype=torch.float64) delta_t tensor(0.5883, dtype=torch.float64)
16 gae_duplicate tensor(1.0408, dtype=torch.float64) tensor(-2.1640, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8735, dtype=torch.float64) delta_t tensor(0.5778, dtype=torch.float64)
15 gae_duplicate tensor(1.4104, dtype=torch.float64) tensor(-2.9323, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8748, dtype=torch.float64) delta_t tensor(0.5848, dtype=torch.float64)
14 gae_duplicate tensor(1.7131, dtype=torch.float64) tensor(-3.5630, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8761, dtype=torch.float64) delta_t tensor(0.6411, dtype=torch.float64)
13 gae_duplicate tensor(2.0116, dtype=torch.float64) tensor(-4.1823, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8774, dtype=torch.float64) delta_t tensor(0.5896, dtype=torch.float64)
12 gae_duplicate tensor(2.1989, dtype=torch.float64) tensor(-4.5699, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8787, dtype=torch.float64) delta_t tensor(0.6130, dtype=torch.float64)
11 gae_duplicate tensor(2.3721, dtype=torch.float64) tensor(-4.9335, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8800, dtype=torch.float64) delta_t tensor(0.5732, dtype=torch.float64)
10 gae_duplicate tensor(2.4708, dtype=torch.float64) tensor(-5.1370, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2883, dtype=torch.float64) delta_t tensor(0.1901, dtype=torch.float64)
9 gae_duplicate tensor(2.1668, dtype=torch.float64) tensor(-4.5066, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0670, dtype=torch.float64) delta_t tensor(-0.5731, dtype=torch.float64)
8 gae_duplicate tensor(1.1603, dtype=torch.float64) tensor(-2.4124, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6592, dtype=torch.float64) delta_t tensor(-0.5442, dtype=torch.float64)
7 gae_duplicate tensor(0.3841, dtype=torch.float64) tensor(-0.7985, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8375, dtype=torch.float64) delta_t tensor(-1.1572, dtype=torch.float64)
6 gae_duplicate tensor(-0.8500, dtype=torch.float64) tensor(1.7665, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5487, dtype=torch.float64) delta_t tensor(-0.8315, dtype=torch.float64)
5 gae_duplicate tensor(-1.5115, dtype=torch.float64) tensor(3.1412, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2239, dtype=torch.float64) delta_t tensor(-0.2611, dtype=torch.float64)
4 gae_duplicate tensor(-1.4703, dtype=torch.float64) tensor(3.0568, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8413, dtype=torch.float64) delta_t tensor(-1.0860, dtype=torch.float64)
3 gae_duplicate tensor(-2.2622, dtype=torch.float64) tensor(4.7050, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0201, dtype=torch.float64) delta_t tensor(-1.3191, dtype=torch.float64)
2 gae_duplicate tensor(-3.1289, dtype=torch.float64) tensor(6.5077, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:99.11507415771484
value loss:80.22221374511719
entropies:37.4299430847168
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.7170)
ToM Target loss= tensor(300.9141)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.40706992149353 seconds
19 rew tensor(0.8664, dtype=torch.float64) delta_t tensor(-0.8186, dtype=torch.float64)
19 gae_duplicate tensor(-0.8186, dtype=torch.float64) tensor(1.7033, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8676, dtype=torch.float64) delta_t tensor(0.4794, dtype=torch.float64)
18 gae_duplicate tensor(-0.1755, dtype=torch.float64) tensor(0.3646, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8689, dtype=torch.float64) delta_t tensor(0.6665, dtype=torch.float64)
17 gae_duplicate tensor(0.5261, dtype=torch.float64) tensor(-1.0933, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8701, dtype=torch.float64) delta_t tensor(0.6476, dtype=torch.float64)
16 gae_duplicate tensor(1.0685, dtype=torch.float64) tensor(-2.2225, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8713, dtype=torch.float64) delta_t tensor(0.6610, dtype=torch.float64)
15 gae_duplicate tensor(1.5159, dtype=torch.float64) tensor(-3.1514, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8726, dtype=torch.float64) delta_t tensor(0.5912, dtype=torch.float64)
14 gae_duplicate tensor(1.8039, dtype=torch.float64) tensor(-3.7520, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8738, dtype=torch.float64) delta_t tensor(0.5925, dtype=torch.float64)
13 gae_duplicate tensor(2.0356, dtype=torch.float64) tensor(-4.2321, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8751, dtype=torch.float64) delta_t tensor(0.6003, dtype=torch.float64)
12 gae_duplicate tensor(2.2288, dtype=torch.float64) tensor(-4.6336, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8764, dtype=torch.float64) delta_t tensor(0.6902, dtype=torch.float64)
11 gae_duplicate tensor(2.4732, dtype=torch.float64) tensor(-5.1394, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6986, dtype=torch.float64) delta_t tensor(0.2941, dtype=torch.float64)
10 gae_duplicate tensor(2.2727, dtype=torch.float64) tensor(-4.7248, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4013, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
9 gae_duplicate tensor(1.8723, dtype=torch.float64) tensor(-3.8907, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4613, dtype=torch.float64) delta_t tensor(0.1923, dtype=torch.float64)
8 gae_duplicate tensor(1.6901, dtype=torch.float64) tensor(-3.5170, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1043, dtype=torch.float64) delta_t tensor(-0.1696, dtype=torch.float64)
7 gae_duplicate tensor(1.1826, dtype=torch.float64) tensor(-2.4596, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1932, dtype=torch.float64) delta_t tensor(0.0999, dtype=torch.float64)
6 gae_duplicate tensor(1.0459, dtype=torch.float64) tensor(-2.1765, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4907, dtype=torch.float64) delta_t tensor(-1.0402, dtype=torch.float64)
5 gae_duplicate tensor(-0.2034, dtype=torch.float64) tensor(0.4229, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4420, dtype=torch.float64) delta_t tensor(-1.4628, dtype=torch.float64)
4 gae_duplicate tensor(-1.6256, dtype=torch.float64) tensor(3.3797, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2673, dtype=torch.float64) delta_t tensor(-0.9648, dtype=torch.float64)
3 gae_duplicate tensor(-2.2653, dtype=torch.float64) tensor(4.7116, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9129, dtype=torch.float64) delta_t tensor(-1.3767, dtype=torch.float64)
2 gae_duplicate tensor(-3.1889, dtype=torch.float64) tensor(6.6296, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:141.56361389160156
value loss:82.35545349121094
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.574918270111084 seconds
19 rew tensor(0.8610, dtype=torch.float64) delta_t tensor(-0.7791, dtype=torch.float64)
19 gae_duplicate tensor(-0.7791, dtype=torch.float64) tensor(1.6197, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8622, dtype=torch.float64) delta_t tensor(0.4929, dtype=torch.float64)
18 gae_duplicate tensor(-0.1304, dtype=torch.float64) tensor(0.2713, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8634, dtype=torch.float64) delta_t tensor(0.5165, dtype=torch.float64)
17 gae_duplicate tensor(0.4122, dtype=torch.float64) tensor(-0.8564, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8645, dtype=torch.float64) delta_t tensor(0.6472, dtype=torch.float64)
16 gae_duplicate tensor(0.9769, dtype=torch.float64) tensor(-2.0309, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8657, dtype=torch.float64) delta_t tensor(0.6438, dtype=torch.float64)
15 gae_duplicate tensor(1.4253, dtype=torch.float64) tensor(-2.9647, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8669, dtype=torch.float64) delta_t tensor(1.0516, dtype=torch.float64)
14 gae_duplicate tensor(2.1919, dtype=torch.float64) tensor(-4.5565, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8681, dtype=torch.float64) delta_t tensor(0.4649, dtype=torch.float64)
13 gae_duplicate tensor(2.2184, dtype=torch.float64) tensor(-4.6118, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5134, dtype=torch.float64) delta_t tensor(0.2431, dtype=torch.float64)
12 gae_duplicate tensor(2.0178, dtype=torch.float64) tensor(-4.1971, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5139, dtype=torch.float64) delta_t tensor(0.1987, dtype=torch.float64)
11 gae_duplicate tensor(1.8130, dtype=torch.float64) tensor(-3.7729, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3959, dtype=torch.float64) delta_t tensor(-0.1915, dtype=torch.float64)
10 gae_duplicate tensor(1.2589, dtype=torch.float64) tensor(-2.6184, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3371, dtype=torch.float64) delta_t tensor(-0.0291, dtype=torch.float64)
9 gae_duplicate tensor(0.9780, dtype=torch.float64) tensor(-2.0354, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1007, dtype=torch.float64) delta_t tensor(-0.2651, dtype=torch.float64)
8 gae_duplicate tensor(0.5173, dtype=torch.float64) tensor(-1.0760, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6679, dtype=torch.float64) delta_t tensor(-0.8574, dtype=torch.float64)
7 gae_duplicate tensor(-0.4435, dtype=torch.float64) tensor(0.9226, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0777, dtype=torch.float64) delta_t tensor(-0.3566, dtype=torch.float64)
6 gae_duplicate tensor(-0.7114, dtype=torch.float64) tensor(1.4790, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-4.3886, dtype=torch.float64) delta_t tensor(-4.5849, dtype=torch.float64)
5 gae_duplicate tensor(-5.1541, dtype=torch.float64) tensor(10.7263, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9252, dtype=torch.float64) delta_t tensor(-0.9596, dtype=torch.float64)
4 gae_duplicate tensor(-5.0828, dtype=torch.float64) tensor(10.5668, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3872, dtype=torch.float64) delta_t tensor(-0.3094, dtype=torch.float64)
3 gae_duplicate tensor(-4.3757, dtype=torch.float64) tensor(9.0915, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4474, dtype=torch.float64) delta_t tensor(-1.0252, dtype=torch.float64)
2 gae_duplicate tensor(-4.5258, dtype=torch.float64) tensor(9.4135, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-93.34532928466797
value loss:174.607421875
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.401764154434204 seconds
19 rew tensor(0.8583, dtype=torch.float64) delta_t tensor(-1.0048, dtype=torch.float64)
19 gae_duplicate tensor(-1.0048, dtype=torch.float64) tensor(2.0887, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8594, dtype=torch.float64) delta_t tensor(0.4887, dtype=torch.float64)
18 gae_duplicate tensor(-0.3151, dtype=torch.float64) tensor(0.6554, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8605, dtype=torch.float64) delta_t tensor(0.5340, dtype=torch.float64)
17 gae_duplicate tensor(0.2820, dtype=torch.float64) tensor(-0.5865, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8617, dtype=torch.float64) delta_t tensor(0.5759, dtype=torch.float64)
16 gae_duplicate tensor(0.8014, dtype=torch.float64) tensor(-1.6660, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8628, dtype=torch.float64) delta_t tensor(0.4952, dtype=torch.float64)
15 gae_duplicate tensor(1.1364, dtype=torch.float64) tensor(-2.3623, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8640, dtype=torch.float64) delta_t tensor(0.6265, dtype=torch.float64)
14 gae_duplicate tensor(1.5356, dtype=torch.float64) tensor(-3.1941, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8651, dtype=torch.float64) delta_t tensor(0.5363, dtype=torch.float64)
13 gae_duplicate tensor(1.7648, dtype=torch.float64) tensor(-3.6709, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8663, dtype=torch.float64) delta_t tensor(0.5426, dtype=torch.float64)
12 gae_duplicate tensor(1.9544, dtype=torch.float64) tensor(-4.0602, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8674, dtype=torch.float64) delta_t tensor(0.5581, dtype=torch.float64)
11 gae_duplicate tensor(2.1216, dtype=torch.float64) tensor(-4.4132, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8686, dtype=torch.float64) delta_t tensor(0.5770, dtype=torch.float64)
10 gae_duplicate tensor(2.2743, dtype=torch.float64) tensor(-4.7248, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6319, dtype=torch.float64) delta_t tensor(0.2941, dtype=torch.float64)
9 gae_duplicate tensor(2.1135, dtype=torch.float64) tensor(-4.3990, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0975, dtype=torch.float64) delta_t tensor(-0.2724, dtype=torch.float64)
8 gae_duplicate tensor(1.4184, dtype=torch.float64) tensor(-2.9468, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0212, dtype=torch.float64) delta_t tensor(-0.0115, dtype=torch.float64)
7 gae_duplicate tensor(1.1232, dtype=torch.float64) tensor(-2.3364, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2083, dtype=torch.float64) delta_t tensor(-1.1555, dtype=torch.float64)
6 gae_duplicate tensor(-0.2569, dtype=torch.float64) tensor(0.5338, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6856, dtype=torch.float64) delta_t tensor(-2.4002, dtype=torch.float64)
5 gae_duplicate tensor(-2.6058, dtype=torch.float64) tensor(5.4169, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3933, dtype=torch.float64) delta_t tensor(-1.0881, dtype=torch.float64)
4 gae_duplicate tensor(-3.1727, dtype=torch.float64) tensor(6.6036, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3886, dtype=torch.float64) delta_t tensor(0.0533, dtype=torch.float64)
3 gae_duplicate tensor(-2.4849, dtype=torch.float64) tensor(5.1655, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0382, dtype=torch.float64) delta_t tensor(-1.4491, dtype=torch.float64)
2 gae_duplicate tensor(-3.4370, dtype=torch.float64) tensor(7.1537, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:39.333248138427734
value loss:97.10675048828125
entropies:37.42993927001953
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.6347010135650635 seconds
19 rew tensor(0.8605, dtype=torch.float64) delta_t tensor(-0.9026, dtype=torch.float64)
19 gae_duplicate tensor(-0.9026, dtype=torch.float64) tensor(1.8775, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8027, dtype=torch.float64) delta_t tensor(0.4915, dtype=torch.float64)
18 gae_duplicate tensor(-0.2306, dtype=torch.float64) tensor(0.4796, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7448, dtype=torch.float64) delta_t tensor(0.4233, dtype=torch.float64)
17 gae_duplicate tensor(0.2389, dtype=torch.float64) tensor(-0.4973, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6867, dtype=torch.float64) delta_t tensor(0.2408, dtype=torch.float64)
16 gae_duplicate tensor(0.4319, dtype=torch.float64) tensor(-0.8977, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4520, dtype=torch.float64) delta_t tensor(0.0973, dtype=torch.float64)
15 gae_duplicate tensor(0.4428, dtype=torch.float64) tensor(-0.9210, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0994, dtype=torch.float64) delta_t tensor(-0.3950, dtype=torch.float64)
14 gae_duplicate tensor(-0.0408, dtype=torch.float64) tensor(0.0848, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8638, dtype=torch.float64) delta_t tensor(0.4771, dtype=torch.float64)
13 gae_duplicate tensor(0.4445, dtype=torch.float64) tensor(-0.9246, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8649, dtype=torch.float64) delta_t tensor(0.5024, dtype=torch.float64)
12 gae_duplicate tensor(0.8580, dtype=torch.float64) tensor(-1.7847, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8072, dtype=torch.float64) delta_t tensor(0.4336, dtype=torch.float64)
11 gae_duplicate tensor(1.1200, dtype=torch.float64) tensor(-2.3298, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4844, dtype=torch.float64) delta_t tensor(-0.7400, dtype=torch.float64)
10 gae_duplicate tensor(0.1560, dtype=torch.float64) tensor(-0.3242, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7197, dtype=torch.float64) delta_t tensor(-1.0158, dtype=torch.float64)
9 gae_duplicate tensor(-0.8910, dtype=torch.float64) tensor(1.8522, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8380, dtype=torch.float64) delta_t tensor(-1.1729, dtype=torch.float64)
8 gae_duplicate tensor(-1.8857, dtype=torch.float64) tensor(3.9253, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.2476, dtype=torch.float64) delta_t tensor(-2.5838, dtype=torch.float64)
7 gae_duplicate tensor(-4.0923, dtype=torch.float64) tensor(8.5127, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.7876, dtype=torch.float64) delta_t tensor(-2.3950, dtype=torch.float64)
6 gae_duplicate tensor(-5.6689, dtype=torch.float64) tensor(11.7837, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1553, dtype=torch.float64) delta_t tensor(-2.3865, dtype=torch.float64)
5 gae_duplicate tensor(-6.9216, dtype=torch.float64) tensor(14.3877, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1732, dtype=torch.float64) delta_t tensor(-3.3152, dtype=torch.float64)
4 gae_duplicate tensor(-8.8525, dtype=torch.float64) tensor(18.4016, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2725, dtype=torch.float64) delta_t tensor(0.0064, dtype=torch.float64)
3 gae_duplicate tensor(-7.0756, dtype=torch.float64) tensor(14.7181, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3921, dtype=torch.float64) delta_t tensor(-0.8039, dtype=torch.float64)
2 gae_duplicate tensor(-6.4644, dtype=torch.float64) tensor(13.4380, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-491.81390380859375
value loss:412.32476806640625
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.312135934829712 seconds
19 rew tensor(0.8575, dtype=torch.float64) delta_t tensor(-0.6575, dtype=torch.float64)
19 gae_duplicate tensor(-0.6575, dtype=torch.float64) tensor(1.3688, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8585, dtype=torch.float64) delta_t tensor(0.5672, dtype=torch.float64)
18 gae_duplicate tensor(0.0412, dtype=torch.float64) tensor(-0.0857, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8596, dtype=torch.float64) delta_t tensor(0.5590, dtype=torch.float64)
17 gae_duplicate tensor(0.5919, dtype=torch.float64) tensor(-1.2313, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8607, dtype=torch.float64) delta_t tensor(0.5734, dtype=torch.float64)
16 gae_duplicate tensor(1.0470, dtype=torch.float64) tensor(-2.1780, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8618, dtype=torch.float64) delta_t tensor(0.2639, dtype=torch.float64)
15 gae_duplicate tensor(1.1015, dtype=torch.float64) tensor(-2.2897, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8628, dtype=torch.float64) delta_t tensor(0.5595, dtype=torch.float64)
14 gae_duplicate tensor(1.4407, dtype=torch.float64) tensor(-2.9971, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8639, dtype=torch.float64) delta_t tensor(0.5373, dtype=torch.float64)
13 gae_duplicate tensor(1.6899, dtype=torch.float64) tensor(-3.5180, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8650, dtype=torch.float64) delta_t tensor(0.5002, dtype=torch.float64)
12 gae_duplicate tensor(1.8521, dtype=torch.float64) tensor(-3.8528, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8661, dtype=torch.float64) delta_t tensor(0.5984, dtype=torch.float64)
11 gae_duplicate tensor(2.0800, dtype=torch.float64) tensor(-4.3237, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8672, dtype=torch.float64) delta_t tensor(0.5634, dtype=torch.float64)
10 gae_duplicate tensor(2.2274, dtype=torch.float64) tensor(-4.6370, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6317, dtype=torch.float64) delta_t tensor(0.2694, dtype=torch.float64)
9 gae_duplicate tensor(2.0513, dtype=torch.float64) tensor(-4.2705, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3367, dtype=torch.float64) delta_t tensor(0.3668, dtype=torch.float64)
8 gae_duplicate tensor(2.0079, dtype=torch.float64) tensor(-4.1802, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8449, dtype=torch.float64) delta_t tensor(-0.7767, dtype=torch.float64)
7 gae_duplicate tensor(0.8297, dtype=torch.float64) tensor(-1.7259, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9050, dtype=torch.float64) delta_t tensor(-1.4749, dtype=torch.float64)
6 gae_duplicate tensor(-0.8111, dtype=torch.float64) tensor(1.6860, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9653, dtype=torch.float64) delta_t tensor(-0.5681, dtype=torch.float64)
5 gae_duplicate tensor(-1.2170, dtype=torch.float64) tensor(2.5317, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1439, dtype=torch.float64) delta_t tensor(-1.8342, dtype=torch.float64)
4 gae_duplicate tensor(-2.8078, dtype=torch.float64) tensor(5.8364, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7913, dtype=torch.float64) delta_t tensor(-1.0567, dtype=torch.float64)
3 gae_duplicate tensor(-3.3030, dtype=torch.float64) tensor(6.8763, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1528, dtype=torch.float64) delta_t tensor(-0.4268, dtype=torch.float64)
2 gae_duplicate tensor(-3.0692, dtype=torch.float64) tensor(6.3798, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:62.54291534423828
value loss:90.03517150878906
entropies:37.429935455322266
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.9499)
ToM Target loss= tensor(300.6468)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.478726148605347 seconds
19 rew tensor(0.8563, dtype=torch.float64) delta_t tensor(-1.0940, dtype=torch.float64)
19 gae_duplicate tensor(-1.0940, dtype=torch.float64) tensor(2.2777, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8573, dtype=torch.float64) delta_t tensor(0.4813, dtype=torch.float64)
18 gae_duplicate tensor(-0.3939, dtype=torch.float64) tensor(0.8195, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8584, dtype=torch.float64) delta_t tensor(0.6802, dtype=torch.float64)
17 gae_duplicate tensor(0.3650, dtype=torch.float64) tensor(-0.7587, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8594, dtype=torch.float64) delta_t tensor(0.4604, dtype=torch.float64)
16 gae_duplicate tensor(0.7524, dtype=torch.float64) tensor(-1.5640, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8604, dtype=torch.float64) delta_t tensor(0.5395, dtype=torch.float64)
15 gae_duplicate tensor(1.1415, dtype=torch.float64) tensor(-2.3727, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8615, dtype=torch.float64) delta_t tensor(0.6048, dtype=torch.float64)
14 gae_duplicate tensor(1.5180, dtype=torch.float64) tensor(-3.1554, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8625, dtype=torch.float64) delta_t tensor(0.5620, dtype=torch.float64)
13 gae_duplicate tensor(1.7764, dtype=torch.float64) tensor(-3.6954, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8636, dtype=torch.float64) delta_t tensor(0.5534, dtype=torch.float64)
12 gae_duplicate tensor(1.9745, dtype=torch.float64) tensor(-4.1076, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8646, dtype=torch.float64) delta_t tensor(0.5318, dtype=torch.float64)
11 gae_duplicate tensor(2.1114, dtype=torch.float64) tensor(-4.3923, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6288, dtype=torch.float64) delta_t tensor(0.4728, dtype=torch.float64)
10 gae_duplicate tensor(2.1619, dtype=torch.float64) tensor(-4.4937, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4518, dtype=torch.float64) delta_t tensor(0.0860, dtype=torch.float64)
9 gae_duplicate tensor(1.8155, dtype=torch.float64) tensor(-3.7768, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0211, dtype=torch.float64) delta_t tensor(-0.5125, dtype=torch.float64)
8 gae_duplicate tensor(0.9399, dtype=torch.float64) tensor(-1.9522, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0380, dtype=torch.float64) delta_t tensor(-0.0409, dtype=torch.float64)
7 gae_duplicate tensor(0.7110, dtype=torch.float64) tensor(-1.4779, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1436, dtype=torch.float64) delta_t tensor(-0.8902, dtype=torch.float64)
6 gae_duplicate tensor(-0.3214, dtype=torch.float64) tensor(0.6681, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6774, dtype=torch.float64) delta_t tensor(-1.8073, dtype=torch.float64)
5 gae_duplicate tensor(-2.0644, dtype=torch.float64) tensor(4.2945, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8594, dtype=torch.float64) delta_t tensor(-1.7856, dtype=torch.float64)
4 gae_duplicate tensor(-3.4371, dtype=torch.float64) tensor(7.1445, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3911, dtype=torch.float64) delta_t tensor(-1.8023, dtype=torch.float64)
3 gae_duplicate tensor(-4.5520, dtype=torch.float64) tensor(9.4689, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3347, dtype=torch.float64) delta_t tensor(-1.9595, dtype=torch.float64)
2 gae_duplicate tensor(-5.6011, dtype=torch.float64) tensor(11.6425, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-28.536245346069336
value loss:142.203857421875
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4818620681762695 seconds
19 rew tensor(0.8552, dtype=torch.float64) delta_t tensor(-0.8561, dtype=torch.float64)
19 gae_duplicate tensor(-0.8561, dtype=torch.float64) tensor(1.7810, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8562, dtype=torch.float64) delta_t tensor(0.4259, dtype=torch.float64)
18 gae_duplicate tensor(-0.2589, dtype=torch.float64) tensor(0.5387, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8572, dtype=torch.float64) delta_t tensor(0.5413, dtype=torch.float64)
17 gae_duplicate tensor(0.3342, dtype=torch.float64) tensor(-0.6952, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8582, dtype=torch.float64) delta_t tensor(0.5170, dtype=torch.float64)
16 gae_duplicate tensor(0.7843, dtype=torch.float64) tensor(-1.6330, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8592, dtype=torch.float64) delta_t tensor(0.7117, dtype=torch.float64)
15 gae_duplicate tensor(1.3391, dtype=torch.float64) tensor(-2.7811, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8602, dtype=torch.float64) delta_t tensor(0.6731, dtype=torch.float64)
14 gae_duplicate tensor(1.7444, dtype=torch.float64) tensor(-3.6288, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7430, dtype=torch.float64) delta_t tensor(0.4854, dtype=torch.float64)
13 gae_duplicate tensor(1.8809, dtype=torch.float64) tensor(-3.9096, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6847, dtype=torch.float64) delta_t tensor(0.4056, dtype=torch.float64)
12 gae_duplicate tensor(1.9104, dtype=torch.float64) tensor(-3.9742, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6854, dtype=torch.float64) delta_t tensor(0.3720, dtype=torch.float64)
11 gae_duplicate tensor(1.9003, dtype=torch.float64) tensor(-3.9500, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6861, dtype=torch.float64) delta_t tensor(0.1046, dtype=torch.float64)
10 gae_duplicate tensor(1.6248, dtype=torch.float64) tensor(-3.3801, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5097, dtype=torch.float64) delta_t tensor(0.0536, dtype=torch.float64)
9 gae_duplicate tensor(1.3535, dtype=torch.float64) tensor(-2.8109, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.0266, dtype=torch.float64) delta_t tensor(-2.1944, dtype=torch.float64)
8 gae_duplicate tensor(-1.1116, dtype=torch.float64) tensor(2.3085, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0287, dtype=torch.float64) delta_t tensor(-1.3492, dtype=torch.float64)
7 gae_duplicate tensor(-2.2385, dtype=torch.float64) tensor(4.6569, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.5674, dtype=torch.float64) delta_t tensor(-2.7782, dtype=torch.float64)
6 gae_duplicate tensor(-4.5690, dtype=torch.float64) tensor(9.5130, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0900, dtype=torch.float64) delta_t tensor(-0.1111, dtype=torch.float64)
5 gae_duplicate tensor(-3.7663, dtype=torch.float64) tensor(7.8352, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1045, dtype=torch.float64) delta_t tensor(-1.6907, dtype=torch.float64)
4 gae_duplicate tensor(-4.7038, dtype=torch.float64) tensor(9.7938, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0279, dtype=torch.float64) delta_t tensor(-0.2233, dtype=torch.float64)
3 gae_duplicate tensor(-3.9863, dtype=torch.float64) tensor(8.2789, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4474, dtype=torch.float64) delta_t tensor(-0.8535, dtype=torch.float64)
2 gae_duplicate tensor(-4.0426, dtype=torch.float64) tensor(8.4029, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-159.1978759765625
value loss:175.94932556152344
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.366145849227905 seconds
19 rew tensor(0.8579, dtype=torch.float64) delta_t tensor(-1.0886, dtype=torch.float64)
19 gae_duplicate tensor(-1.0886, dtype=torch.float64) tensor(2.2647, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8589, dtype=torch.float64) delta_t tensor(0.3686, dtype=torch.float64)
18 gae_duplicate tensor(-0.5022, dtype=torch.float64) tensor(1.0448, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8599, dtype=torch.float64) delta_t tensor(0.5873, dtype=torch.float64)
17 gae_duplicate tensor(0.1855, dtype=torch.float64) tensor(-0.3863, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8609, dtype=torch.float64) delta_t tensor(0.6523, dtype=torch.float64)
16 gae_duplicate tensor(0.8007, dtype=torch.float64) tensor(-1.6643, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8619, dtype=torch.float64) delta_t tensor(0.7868, dtype=torch.float64)
15 gae_duplicate tensor(1.4274, dtype=torch.float64) tensor(-2.9696, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8628, dtype=torch.float64) delta_t tensor(0.5699, dtype=torch.float64)
14 gae_duplicate tensor(1.7118, dtype=torch.float64) tensor(-3.5549, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8638, dtype=torch.float64) delta_t tensor(1.3011, dtype=torch.float64)
13 gae_duplicate tensor(2.6705, dtype=torch.float64) tensor(-5.5606, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8648, dtype=torch.float64) delta_t tensor(0.3781, dtype=torch.float64)
12 gae_duplicate tensor(2.5146, dtype=torch.float64) tensor(-5.2265, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0380, dtype=torch.float64) delta_t tensor(-0.3183, dtype=torch.float64)
11 gae_duplicate tensor(1.6934, dtype=torch.float64) tensor(-3.5228, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0380, dtype=torch.float64) delta_t tensor(-0.3361, dtype=torch.float64)
10 gae_duplicate tensor(1.0186, dtype=torch.float64) tensor(-2.1172, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0801, dtype=torch.float64) delta_t tensor(-0.6438, dtype=torch.float64)
9 gae_duplicate tensor(0.1711, dtype=torch.float64) tensor(-0.3552, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2572, dtype=torch.float64) delta_t tensor(-0.6259, dtype=torch.float64)
8 gae_duplicate tensor(-0.4891, dtype=torch.float64) tensor(1.0175, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2145, dtype=torch.float64) delta_t tensor(0.2637, dtype=torch.float64)
7 gae_duplicate tensor(-0.1276, dtype=torch.float64) tensor(0.2657, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7284, dtype=torch.float64) delta_t tensor(-0.3841, dtype=torch.float64)
6 gae_duplicate tensor(-0.4862, dtype=torch.float64) tensor(1.0105, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8487, dtype=torch.float64) delta_t tensor(-2.1036, dtype=torch.float64)
5 gae_duplicate tensor(-2.4926, dtype=torch.float64) tensor(5.1808, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9132, dtype=torch.float64) delta_t tensor(-1.8707, dtype=torch.float64)
4 gae_duplicate tensor(-3.8647, dtype=torch.float64) tensor(8.0256, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2689, dtype=torch.float64) delta_t tensor(-1.5027, dtype=torch.float64)
3 gae_duplicate tensor(-4.5945, dtype=torch.float64) tensor(9.5579, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.8035, dtype=torch.float64) delta_t tensor(-2.2049, dtype=torch.float64)
2 gae_duplicate tensor(-5.8804, dtype=torch.float64) tensor(12.2332, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-92.58314514160156
value loss:152.69940185546875
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.67301607131958 seconds
19 rew tensor(0.8591, dtype=torch.float64) delta_t tensor(-0.2540, dtype=torch.float64)
19 gae_duplicate tensor(-0.2540, dtype=torch.float64) tensor(0.5285, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8600, dtype=torch.float64) delta_t tensor(-0.1276, dtype=torch.float64)
18 gae_duplicate tensor(-0.3309, dtype=torch.float64) tensor(0.6870, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8022, dtype=torch.float64) delta_t tensor(0.5196, dtype=torch.float64)
17 gae_duplicate tensor(0.2549, dtype=torch.float64) tensor(-0.5302, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8031, dtype=torch.float64) delta_t tensor(0.4975, dtype=torch.float64)
16 gae_duplicate tensor(0.7014, dtype=torch.float64) tensor(-1.4578, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7452, dtype=torch.float64) delta_t tensor(0.4977, dtype=torch.float64)
15 gae_duplicate tensor(1.0588, dtype=torch.float64) tensor(-2.2028, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5697, dtype=torch.float64) delta_t tensor(0.2893, dtype=torch.float64)
14 gae_duplicate tensor(1.1363, dtype=torch.float64) tensor(-2.3618, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4528, dtype=torch.float64) delta_t tensor(0.1897, dtype=torch.float64)
13 gae_duplicate tensor(1.0988, dtype=torch.float64) tensor(-2.2881, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8639, dtype=torch.float64) delta_t tensor(0.5572, dtype=torch.float64)
12 gae_duplicate tensor(1.4362, dtype=torch.float64) tensor(-2.9879, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7475, dtype=torch.float64) delta_t tensor(0.3749, dtype=torch.float64)
11 gae_duplicate tensor(1.5239, dtype=torch.float64) tensor(-3.1673, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5723, dtype=torch.float64) delta_t tensor(0.1633, dtype=torch.float64)
10 gae_duplicate tensor(1.3824, dtype=torch.float64) tensor(-2.8786, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.8304, dtype=torch.float64) delta_t tensor(-2.1807, dtype=torch.float64)
9 gae_duplicate tensor(-1.0748, dtype=torch.float64) tensor(2.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4539, dtype=torch.float64) delta_t tensor(0.1362, dtype=torch.float64)
8 gae_duplicate tensor(-0.7237, dtype=torch.float64) tensor(1.5070, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.1275, dtype=torch.float64) delta_t tensor(-2.5050, dtype=torch.float64)
7 gae_duplicate tensor(-3.0840, dtype=torch.float64) tensor(6.4160, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.3116, dtype=torch.float64) delta_t tensor(-1.4248, dtype=torch.float64)
6 gae_duplicate tensor(-3.8920, dtype=torch.float64) tensor(8.0892, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.3212, dtype=torch.float64) delta_t tensor(-2.7206, dtype=torch.float64)
5 gae_duplicate tensor(-5.8342, dtype=torch.float64) tensor(12.1259, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2718, dtype=torch.float64) delta_t tensor(-2.1357, dtype=torch.float64)
4 gae_duplicate tensor(-6.8030, dtype=torch.float64) tensor(14.1529, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5610, dtype=torch.float64) delta_t tensor(-0.4658, dtype=torch.float64)
3 gae_duplicate tensor(-5.9082, dtype=torch.float64) tensor(12.3033, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5615, dtype=torch.float64) delta_t tensor(-0.7917, dtype=torch.float64)
2 gae_duplicate tensor(-5.5183, dtype=torch.float64) tensor(11.4914, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-311.0866394042969
value loss:273.9922790527344
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.527054071426392 seconds
19 rew tensor(0.8537, dtype=torch.float64) delta_t tensor(-0.8749, dtype=torch.float64)
19 gae_duplicate tensor(-0.8749, dtype=torch.float64) tensor(1.8166, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7971, dtype=torch.float64) delta_t tensor(0.4639, dtype=torch.float64)
18 gae_duplicate tensor(-0.2361, dtype=torch.float64) tensor(0.4916, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7404, dtype=torch.float64) delta_t tensor(0.4488, dtype=torch.float64)
17 gae_duplicate tensor(0.2599, dtype=torch.float64) tensor(-0.5402, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6260, dtype=torch.float64) delta_t tensor(0.2350, dtype=torch.float64)
16 gae_duplicate tensor(0.4429, dtype=torch.float64) tensor(-0.9215, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3965, dtype=torch.float64) delta_t tensor(0.1457, dtype=torch.float64)
15 gae_duplicate tensor(0.5000, dtype=torch.float64) tensor(-1.0382, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0630, dtype=torch.float64) delta_t tensor(-0.4505, dtype=torch.float64)
14 gae_duplicate tensor(-0.0505, dtype=torch.float64) tensor(0.1049, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8560, dtype=torch.float64) delta_t tensor(0.5179, dtype=torch.float64)
13 gae_duplicate tensor(0.4776, dtype=torch.float64) tensor(-0.9946, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8570, dtype=torch.float64) delta_t tensor(0.5189, dtype=torch.float64)
12 gae_duplicate tensor(0.9009, dtype=torch.float64) tensor(-1.8725, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8579, dtype=torch.float64) delta_t tensor(0.5198, dtype=torch.float64)
11 gae_duplicate tensor(1.2405, dtype=torch.float64) tensor(-2.5783, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6866, dtype=torch.float64) delta_t tensor(0.3649, dtype=torch.float64)
10 gae_duplicate tensor(1.3573, dtype=torch.float64) tensor(-2.8210, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7809, dtype=torch.float64) delta_t tensor(-2.2232, dtype=torch.float64)
9 gae_duplicate tensor(-1.1373, dtype=torch.float64) tensor(2.3686, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.9580, dtype=torch.float64) delta_t tensor(-2.0541, dtype=torch.float64)
8 gae_duplicate tensor(-2.9640, dtype=torch.float64) tensor(6.1603, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2240, dtype=torch.float64) delta_t tensor(-0.1994, dtype=torch.float64)
7 gae_duplicate tensor(-2.5706, dtype=torch.float64) tensor(5.3535, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.5381, dtype=torch.float64) delta_t tensor(-2.7061, dtype=torch.float64)
6 gae_duplicate tensor(-4.7626, dtype=torch.float64) tensor(9.8984, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-3.3009, dtype=torch.float64) delta_t tensor(-2.6422, dtype=torch.float64)
5 gae_duplicate tensor(-6.4523, dtype=torch.float64) tensor(13.4102, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.6047, dtype=torch.float64) delta_t tensor(-4.7492, dtype=torch.float64)
4 gae_duplicate tensor(-9.9111, dtype=torch.float64) tensor(20.5993, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5496, dtype=torch.float64) delta_t tensor(-0.7379, dtype=torch.float64)
3 gae_duplicate tensor(-8.6667, dtype=torch.float64) tensor(18.0312, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5501, dtype=torch.float64) delta_t tensor(-0.4171, dtype=torch.float64)
2 gae_duplicate tensor(-7.3505, dtype=torch.float64) tensor(15.2774, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-497.5982971191406
value loss:471.19647216796875
entropies:37.42991638183594
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.0793)
ToM Target loss= tensor(300.6019)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.523638010025024 seconds
19 rew tensor(0.8520, dtype=torch.float64) delta_t tensor(-0.2924, dtype=torch.float64)
19 gae_duplicate tensor(-0.2924, dtype=torch.float64) tensor(0.6078, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8529, dtype=torch.float64) delta_t tensor(0.6240, dtype=torch.float64)
18 gae_duplicate tensor(0.3901, dtype=torch.float64) tensor(-0.8107, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8538, dtype=torch.float64) delta_t tensor(0.6446, dtype=torch.float64)
17 gae_duplicate tensor(0.9567, dtype=torch.float64) tensor(-1.9883, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8547, dtype=torch.float64) delta_t tensor(0.6534, dtype=torch.float64)
16 gae_duplicate tensor(1.4188, dtype=torch.float64) tensor(-2.9519, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8556, dtype=torch.float64) delta_t tensor(0.2799, dtype=torch.float64)
15 gae_duplicate tensor(1.4149, dtype=torch.float64) tensor(-2.9406, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8565, dtype=torch.float64) delta_t tensor(0.4964, dtype=torch.float64)
14 gae_duplicate tensor(1.6283, dtype=torch.float64) tensor(-3.3841, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8574, dtype=torch.float64) delta_t tensor(0.5489, dtype=torch.float64)
13 gae_duplicate tensor(1.8515, dtype=torch.float64) tensor(-3.8480, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8584, dtype=torch.float64) delta_t tensor(0.5526, dtype=torch.float64)
12 gae_duplicate tensor(2.0337, dtype=torch.float64) tensor(-4.2313, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8593, dtype=torch.float64) delta_t tensor(0.5535, dtype=torch.float64)
11 gae_duplicate tensor(2.1805, dtype=torch.float64) tensor(-4.5414, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8602, dtype=torch.float64) delta_t tensor(0.5544, dtype=torch.float64)
10 gae_duplicate tensor(2.2988, dtype=torch.float64) tensor(-4.7827, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.6929, dtype=torch.float64) delta_t tensor(-2.2136, dtype=torch.float64)
9 gae_duplicate tensor(-0.3746, dtype=torch.float64) tensor(0.7776, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7502, dtype=torch.float64) delta_t tensor(-1.1999, dtype=torch.float64)
8 gae_duplicate tensor(-1.4996, dtype=torch.float64) tensor(3.1199, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0545, dtype=torch.float64) delta_t tensor(-0.2509, dtype=torch.float64)
7 gae_duplicate tensor(-1.4505, dtype=torch.float64) tensor(3.0146, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7504, dtype=torch.float64) delta_t tensor(-0.9944, dtype=torch.float64)
6 gae_duplicate tensor(-2.1548, dtype=torch.float64) tensor(4.4831, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8432, dtype=torch.float64) delta_t tensor(-1.4765, dtype=torch.float64)
5 gae_duplicate tensor(-3.2003, dtype=torch.float64) tensor(6.6514, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7422, dtype=torch.float64) delta_t tensor(0.7638, dtype=torch.float64)
4 gae_duplicate tensor(-1.7965, dtype=torch.float64) tensor(3.7338, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5591, dtype=torch.float64) delta_t tensor(-1.1719, dtype=torch.float64)
3 gae_duplicate tensor(-2.6091, dtype=torch.float64) tensor(5.4283, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3896, dtype=torch.float64) delta_t tensor(-1.7167, dtype=torch.float64)
2 gae_duplicate tensor(-3.8039, dtype=torch.float64) tensor(7.9144, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-38.63411331176758
value loss:103.95719146728516
entropies:37.42991638183594
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.723912954330444 seconds
19 rew tensor(0.8527, dtype=torch.float64) delta_t tensor(-0.6127, dtype=torch.float64)
19 gae_duplicate tensor(-0.6127, dtype=torch.float64) tensor(1.2734, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8536, dtype=torch.float64) delta_t tensor(0.5590, dtype=torch.float64)
18 gae_duplicate tensor(0.0688, dtype=torch.float64) tensor(-0.1429, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8545, dtype=torch.float64) delta_t tensor(0.4307, dtype=torch.float64)
17 gae_duplicate tensor(0.4857, dtype=torch.float64) tensor(-1.0095, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8554, dtype=torch.float64) delta_t tensor(0.7615, dtype=torch.float64)
16 gae_duplicate tensor(1.1501, dtype=torch.float64) tensor(-2.3903, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8562, dtype=torch.float64) delta_t tensor(1.0840, dtype=torch.float64)
15 gae_duplicate tensor(2.0041, dtype=torch.float64) tensor(-4.1652, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8571, dtype=torch.float64) delta_t tensor(0.6832, dtype=torch.float64)
14 gae_duplicate tensor(2.2865, dtype=torch.float64) tensor(-4.7521, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8580, dtype=torch.float64) delta_t tensor(0.6841, dtype=torch.float64)
13 gae_duplicate tensor(2.5133, dtype=torch.float64) tensor(-5.2234, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7434, dtype=torch.float64) delta_t tensor(0.5500, dtype=torch.float64)
12 gae_duplicate tensor(2.5607, dtype=torch.float64) tensor(-5.3278, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7441, dtype=torch.float64) delta_t tensor(1.1366, dtype=torch.float64)
11 gae_duplicate tensor(3.1852, dtype=torch.float64) tensor(-6.6199, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3986, dtype=torch.float64) delta_t tensor(-0.0165, dtype=torch.float64)
10 gae_duplicate tensor(2.5316, dtype=torch.float64) tensor(-5.2558, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1681, dtype=torch.float64) delta_t tensor(-0.0466, dtype=torch.float64)
9 gae_duplicate tensor(1.9787, dtype=torch.float64) tensor(-4.1169, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0047, dtype=torch.float64) delta_t tensor(-0.4159, dtype=torch.float64)
8 gae_duplicate tensor(1.1671, dtype=torch.float64) tensor(-2.4283, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4656, dtype=torch.float64) delta_t tensor(-0.5526, dtype=torch.float64)
7 gae_duplicate tensor(0.3810, dtype=torch.float64) tensor(-0.7937, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8115, dtype=torch.float64) delta_t tensor(-0.1089, dtype=torch.float64)
6 gae_duplicate tensor(0.1960, dtype=torch.float64) tensor(-0.4077, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4669, dtype=torch.float64) delta_t tensor(-0.7277, dtype=torch.float64)
5 gae_duplicate tensor(-0.5710, dtype=torch.float64) tensor(1.1866, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2370, dtype=torch.float64) delta_t tensor(-0.3034, dtype=torch.float64)
4 gae_duplicate tensor(-0.7602, dtype=torch.float64) tensor(1.5834, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8698, dtype=torch.float64) delta_t tensor(-0.8856, dtype=torch.float64)
3 gae_duplicate tensor(-1.4937, dtype=torch.float64) tensor(3.1045, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6982, dtype=torch.float64) delta_t tensor(-0.6703, dtype=torch.float64)
2 gae_duplicate tensor(-1.8653, dtype=torch.float64) tensor(3.8766, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:188.53050231933594
value loss:79.03201293945312
entropies:37.42991256713867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.341852903366089 seconds
19 rew tensor(0.8561, dtype=torch.float64) delta_t tensor(-0.0941, dtype=torch.float64)
19 gae_duplicate tensor(-0.0941, dtype=torch.float64) tensor(0.1958, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7989, dtype=torch.float64) delta_t tensor(0.6552, dtype=torch.float64)
18 gae_duplicate tensor(0.5799, dtype=torch.float64) tensor(-1.2052, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7997, dtype=torch.float64) delta_t tensor(0.6622, dtype=torch.float64)
17 gae_duplicate tensor(1.1262, dtype=torch.float64) tensor(-2.3405, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6264, dtype=torch.float64) delta_t tensor(-0.0386, dtype=torch.float64)
16 gae_duplicate tensor(0.8623, dtype=torch.float64) tensor(-1.7922, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4530, dtype=torch.float64) delta_t tensor(0.2179, dtype=torch.float64)
15 gae_duplicate tensor(0.9078, dtype=torch.float64) tensor(-1.8867, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2215, dtype=torch.float64) delta_t tensor(0.5345, dtype=torch.float64)
14 gae_duplicate tensor(1.2608, dtype=torch.float64) tensor(-2.6232, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8588, dtype=torch.float64) delta_t tensor(0.7105, dtype=torch.float64)
13 gae_duplicate tensor(1.7192, dtype=torch.float64) tensor(-3.5729, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8597, dtype=torch.float64) delta_t tensor(0.7114, dtype=torch.float64)
12 gae_duplicate tensor(2.0867, dtype=torch.float64) tensor(-4.3417, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7447, dtype=torch.float64) delta_t tensor(0.5665, dtype=torch.float64)
11 gae_duplicate tensor(2.2359, dtype=torch.float64) tensor(-4.6520, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4124, dtype=torch.float64) delta_t tensor(-0.0544, dtype=torch.float64)
10 gae_duplicate tensor(1.7343, dtype=torch.float64) tensor(-3.6086, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.9170, dtype=torch.float64) delta_t tensor(-2.4063, dtype=torch.float64)
9 gae_duplicate tensor(-1.0188, dtype=torch.float64) tensor(2.1198, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1640, dtype=torch.float64) delta_t tensor(0.5925, dtype=torch.float64)
8 gae_duplicate tensor(-0.2225, dtype=torch.float64) tensor(0.4630, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0676, dtype=torch.float64) delta_t tensor(-0.4135, dtype=torch.float64)
7 gae_duplicate tensor(-0.5915, dtype=torch.float64) tensor(1.2307, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1096, dtype=torch.float64) delta_t tensor(-1.4907, dtype=torch.float64)
6 gae_duplicate tensor(-1.9639, dtype=torch.float64) tensor(4.0863, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1689, dtype=torch.float64) delta_t tensor(-0.6451, dtype=torch.float64)
5 gae_duplicate tensor(-2.2163, dtype=torch.float64) tensor(4.6112, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5336, dtype=torch.float64) delta_t tensor(-0.6344, dtype=torch.float64)
4 gae_duplicate tensor(-2.4074, dtype=torch.float64) tensor(5.0031, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3444, dtype=torch.float64) delta_t tensor(-1.5483, dtype=torch.float64)
3 gae_duplicate tensor(-3.4742, dtype=torch.float64) tensor(7.2287, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1011, dtype=torch.float64) delta_t tensor(-0.3798, dtype=torch.float64)
2 gae_duplicate tensor(-3.1592, dtype=torch.float64) tensor(6.5733, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-34.05692672729492
value loss:87.21090698242188
entropies:37.42991256713867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.836114168167114 seconds
19 rew tensor(0.8588, dtype=torch.float64) delta_t tensor(0.3641, dtype=torch.float64)
19 gae_duplicate tensor(0.3641, dtype=torch.float64) tensor(-0.7566, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8597, dtype=torch.float64) delta_t tensor(-0.3077, dtype=torch.float64)
18 gae_duplicate tensor(-0.0164, dtype=torch.float64) tensor(0.0340, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8605, dtype=torch.float64) delta_t tensor(0.7134, dtype=torch.float64)
17 gae_duplicate tensor(0.7002, dtype=torch.float64) tensor(-1.4552, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8614, dtype=torch.float64) delta_t tensor(0.6534, dtype=torch.float64)
16 gae_duplicate tensor(1.2136, dtype=torch.float64) tensor(-2.5281, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8622, dtype=torch.float64) delta_t tensor(0.6795, dtype=torch.float64)
15 gae_duplicate tensor(1.6504, dtype=torch.float64) tensor(-3.4340, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8631, dtype=torch.float64) delta_t tensor(0.6299, dtype=torch.float64)
14 gae_duplicate tensor(1.9503, dtype=torch.float64) tensor(-4.0579, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8640, dtype=torch.float64) delta_t tensor(0.6015, dtype=torch.float64)
13 gae_duplicate tensor(2.1617, dtype=torch.float64) tensor(-4.4978, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0521, dtype=torch.float64) delta_t tensor(0.7409, dtype=torch.float64)
12 gae_duplicate tensor(2.4703, dtype=torch.float64) tensor(-5.1399, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2262, dtype=torch.float64) delta_t tensor(-0.4576, dtype=torch.float64)
11 gae_duplicate tensor(1.5186, dtype=torch.float64) tensor(-3.1560, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0636, dtype=torch.float64) delta_t tensor(-0.4265, dtype=torch.float64)
10 gae_duplicate tensor(0.7884, dtype=torch.float64) tensor(-1.6404, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5159, dtype=torch.float64) delta_t tensor(1.2211, dtype=torch.float64)
9 gae_duplicate tensor(1.8519, dtype=torch.float64) tensor(-3.8485, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1210, dtype=torch.float64) delta_t tensor(-0.6742, dtype=torch.float64)
8 gae_duplicate tensor(0.8073, dtype=torch.float64) tensor(-1.6778, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8738, dtype=torch.float64) delta_t tensor(-0.2602, dtype=torch.float64)
7 gae_duplicate tensor(0.3857, dtype=torch.float64) tensor(-0.8015, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4536, dtype=torch.float64) delta_t tensor(-2.1473, dtype=torch.float64)
6 gae_duplicate tensor(-1.8387, dtype=torch.float64) tensor(3.8212, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1513, dtype=torch.float64) delta_t tensor(-2.0612, dtype=torch.float64)
5 gae_duplicate tensor(-3.5322, dtype=torch.float64) tensor(7.3494, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0476, dtype=torch.float64) delta_t tensor(0.3147, dtype=torch.float64)
4 gae_duplicate tensor(-2.5111, dtype=torch.float64) tensor(5.2122, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9250, dtype=torch.float64) delta_t tensor(-1.4239, dtype=torch.float64)
3 gae_duplicate tensor(-3.4327, dtype=torch.float64) tensor(7.1510, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5937, dtype=torch.float64) delta_t tensor(-1.3141, dtype=torch.float64)
2 gae_duplicate tensor(-4.0603, dtype=torch.float64) tensor(8.4281, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4.864940643310547
value loss:115.48332214355469
entropies:37.429908752441406
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.735069990158081 seconds
19 rew tensor(0.8549, dtype=torch.float64) delta_t tensor(-0.3502, dtype=torch.float64)
19 gae_duplicate tensor(-0.3502, dtype=torch.float64) tensor(0.7288, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7984, dtype=torch.float64) delta_t tensor(0.6615, dtype=torch.float64)
18 gae_duplicate tensor(0.3814, dtype=torch.float64) tensor(-0.7945, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7419, dtype=torch.float64) delta_t tensor(0.6142, dtype=torch.float64)
17 gae_duplicate tensor(0.9193, dtype=torch.float64) tensor(-1.9105, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6852, dtype=torch.float64) delta_t tensor(0.2104, dtype=torch.float64)
16 gae_duplicate tensor(0.9459, dtype=torch.float64) tensor(-1.9705, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4568, dtype=torch.float64) delta_t tensor(0.2060, dtype=torch.float64)
15 gae_duplicate tensor(0.9627, dtype=torch.float64) tensor(-2.0006, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1139, dtype=torch.float64) delta_t tensor(-0.2909, dtype=torch.float64)
14 gae_duplicate tensor(0.4792, dtype=torch.float64) tensor(-0.9983, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8573, dtype=torch.float64) delta_t tensor(0.6230, dtype=torch.float64)
13 gae_duplicate tensor(1.0063, dtype=torch.float64) tensor(-2.0888, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8010, dtype=torch.float64) delta_t tensor(0.4982, dtype=torch.float64)
12 gae_duplicate tensor(1.3033, dtype=torch.float64) tensor(-2.7085, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8589, dtype=torch.float64) delta_t tensor(0.5784, dtype=torch.float64)
11 gae_duplicate tensor(1.6210, dtype=torch.float64) tensor(-3.3729, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6882, dtype=torch.float64) delta_t tensor(0.5628, dtype=torch.float64)
10 gae_duplicate tensor(1.8596, dtype=torch.float64) tensor(-3.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6825, dtype=torch.float64) delta_t tensor(-1.1358, dtype=torch.float64)
9 gae_duplicate tensor(0.3519, dtype=torch.float64) tensor(-0.7313, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7973, dtype=torch.float64) delta_t tensor(-0.7481, dtype=torch.float64)
8 gae_duplicate tensor(-0.4666, dtype=torch.float64) tensor(0.9697, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9694, dtype=torch.float64) delta_t tensor(-1.3039, dtype=torch.float64)
7 gae_duplicate tensor(-1.6772, dtype=torch.float64) tensor(3.4898, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-3.6546, dtype=torch.float64) delta_t tensor(-3.3862, dtype=torch.float64)
6 gae_duplicate tensor(-4.7279, dtype=torch.float64) tensor(9.8377, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9592, dtype=torch.float64) delta_t tensor(-1.6712, dtype=torch.float64)
5 gae_duplicate tensor(-5.4536, dtype=torch.float64) tensor(11.3474, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.4415, dtype=torch.float64) delta_t tensor(-4.0575, dtype=torch.float64)
4 gae_duplicate tensor(-8.4203, dtype=torch.float64) tensor(17.4772, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3605, dtype=torch.float64) delta_t tensor(0.1542, dtype=torch.float64)
3 gae_duplicate tensor(-6.5821, dtype=torch.float64) tensor(13.6785, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4189, dtype=torch.float64) delta_t tensor(-0.9167, dtype=torch.float64)
2 gae_duplicate tensor(-6.1823, dtype=torch.float64) tensor(12.8634, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-300.8358459472656
value loss:329.4862365722656
entropies:37.429901123046875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.8718)
ToM Target loss= tensor(300.7375)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.319768190383911 seconds
19 rew tensor(0.8490, dtype=torch.float64) delta_t tensor(0.3878, dtype=torch.float64)
19 gae_duplicate tensor(0.3878, dtype=torch.float64) tensor(-0.8070, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8498, dtype=torch.float64) delta_t tensor(0.7575, dtype=torch.float64)
18 gae_duplicate tensor(1.0678, dtype=torch.float64) tensor(-2.2218, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8506, dtype=torch.float64) delta_t tensor(0.7583, dtype=torch.float64)
17 gae_duplicate tensor(1.6126, dtype=torch.float64) tensor(-3.3512, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7950, dtype=torch.float64) delta_t tensor(0.7553, dtype=torch.float64)
16 gae_duplicate tensor(2.0454, dtype=torch.float64) tensor(-4.2506, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6830, dtype=torch.float64) delta_t tensor(-0.0802, dtype=torch.float64)
15 gae_duplicate tensor(1.5561, dtype=torch.float64) tensor(-3.2297, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6272, dtype=torch.float64) delta_t tensor(0.3832, dtype=torch.float64)
14 gae_duplicate tensor(1.6280, dtype=torch.float64) tensor(-3.3833, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5151, dtype=torch.float64) delta_t tensor(0.2305, dtype=torch.float64)
13 gae_duplicate tensor(1.5329, dtype=torch.float64) tensor(-3.1856, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8532, dtype=torch.float64) delta_t tensor(0.6028, dtype=torch.float64)
12 gae_duplicate tensor(1.8292, dtype=torch.float64) tensor(-3.8012, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7977, dtype=torch.float64) delta_t tensor(0.5750, dtype=torch.float64)
11 gae_duplicate tensor(2.0383, dtype=torch.float64) tensor(-4.2359, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4396, dtype=torch.float64) delta_t tensor(-0.5243, dtype=torch.float64)
10 gae_duplicate tensor(1.1063, dtype=torch.float64) tensor(-2.3020, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4601, dtype=torch.float64) delta_t tensor(0.5636, dtype=torch.float64)
9 gae_duplicate tensor(1.4486, dtype=torch.float64) tensor(-3.0143, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6641, dtype=torch.float64) delta_t tensor(-1.0568, dtype=torch.float64)
8 gae_duplicate tensor(0.1021, dtype=torch.float64) tensor(-0.2126, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.0137, dtype=torch.float64) delta_t tensor(-2.2776, dtype=torch.float64)
7 gae_duplicate tensor(-2.1959, dtype=torch.float64) tensor(4.5691, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.4135, dtype=torch.float64) delta_t tensor(-1.4553, dtype=torch.float64)
6 gae_duplicate tensor(-3.2120, dtype=torch.float64) tensor(6.6835, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0274, dtype=torch.float64) delta_t tensor(-1.5385, dtype=torch.float64)
5 gae_duplicate tensor(-4.1081, dtype=torch.float64) tensor(8.5371, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.2567, dtype=torch.float64) delta_t tensor(-5.1026, dtype=torch.float64)
4 gae_duplicate tensor(-8.3891, dtype=torch.float64) tensor(17.4553, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2327, dtype=torch.float64) delta_t tensor(-0.2679, dtype=torch.float64)
3 gae_duplicate tensor(-6.9792, dtype=torch.float64) tensor(14.5218, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2903, dtype=torch.float64) delta_t tensor(-0.7335, dtype=torch.float64)
2 gae_duplicate tensor(-6.3169, dtype=torch.float64) tensor(13.1606, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-186.71566772460938
value loss:326.0010986328125
entropies:37.429901123046875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.376408815383911 seconds
19 rew tensor(0.8489, dtype=torch.float64) delta_t tensor(0.8686, dtype=torch.float64)
19 gae_duplicate tensor(0.8686, dtype=torch.float64) tensor(-1.8050, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8497, dtype=torch.float64) delta_t tensor(0.7424, dtype=torch.float64)
18 gae_duplicate tensor(1.4373, dtype=torch.float64) tensor(-2.9946, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8505, dtype=torch.float64) delta_t tensor(-0.5262, dtype=torch.float64)
17 gae_duplicate tensor(0.6236, dtype=torch.float64) tensor(-1.2977, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8512, dtype=torch.float64) delta_t tensor(0.7657, dtype=torch.float64)
16 gae_duplicate tensor(1.2646, dtype=torch.float64) tensor(-2.6314, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8520, dtype=torch.float64) delta_t tensor(0.7799, dtype=torch.float64)
15 gae_duplicate tensor(1.7916, dtype=torch.float64) tensor(-3.7230, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8528, dtype=torch.float64) delta_t tensor(0.6479, dtype=torch.float64)
14 gae_duplicate tensor(2.0812, dtype=torch.float64) tensor(-4.3361, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8536, dtype=torch.float64) delta_t tensor(0.6005, dtype=torch.float64)
13 gae_duplicate tensor(2.2654, dtype=torch.float64) tensor(-4.7078, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8544, dtype=torch.float64) delta_t tensor(1.5364, dtype=torch.float64)
12 gae_duplicate tensor(3.3488, dtype=torch.float64) tensor(-6.9591, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8552, dtype=torch.float64) delta_t tensor(1.0907, dtype=torch.float64)
11 gae_duplicate tensor(3.7697, dtype=torch.float64) tensor(-7.8440, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8560, dtype=torch.float64) delta_t tensor(0.9321, dtype=torch.float64)
10 gae_duplicate tensor(3.9479, dtype=torch.float64) tensor(-8.2147, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6306, dtype=torch.float64) delta_t tensor(0.6099, dtype=torch.float64)
9 gae_duplicate tensor(3.7682, dtype=torch.float64) tensor(-7.8307, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3299, dtype=torch.float64) delta_t tensor(-0.8133, dtype=torch.float64)
8 gae_duplicate tensor(2.2013, dtype=torch.float64) tensor(-4.5863, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3866, dtype=torch.float64) delta_t tensor(-0.1317, dtype=torch.float64)
7 gae_duplicate tensor(1.6293, dtype=torch.float64) tensor(-3.3903, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4998, dtype=torch.float64) delta_t tensor(0.3356, dtype=torch.float64)
6 gae_duplicate tensor(1.6391, dtype=torch.float64) tensor(-3.4018, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8953, dtype=torch.float64) delta_t tensor(-1.1386, dtype=torch.float64)
5 gae_duplicate tensor(0.1727, dtype=torch.float64) tensor(-0.3589, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3882, dtype=torch.float64) delta_t tensor(-0.2453, dtype=torch.float64)
4 gae_duplicate tensor(-0.1072, dtype=torch.float64) tensor(0.2233, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4040, dtype=torch.float64) delta_t tensor(-1.1538, dtype=torch.float64)
3 gae_duplicate tensor(-1.2396, dtype=torch.float64) tensor(2.5827, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5595, dtype=torch.float64) delta_t tensor(-1.0533, dtype=torch.float64)
2 gae_duplicate tensor(-2.0450, dtype=torch.float64) tensor(4.2496, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:341.0328369140625
value loss:132.9579315185547
entropies:37.42989730834961
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.601068019866943 seconds
19 rew tensor(0.8506, dtype=torch.float64) delta_t tensor(0.7386, dtype=torch.float64)
19 gae_duplicate tensor(0.7386, dtype=torch.float64) tensor(-1.5348, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8513, dtype=torch.float64) delta_t tensor(0.8289, dtype=torch.float64)
18 gae_duplicate tensor(1.4198, dtype=torch.float64) tensor(-2.9504, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8521, dtype=torch.float64) delta_t tensor(0.8297, dtype=torch.float64)
17 gae_duplicate tensor(1.9655, dtype=torch.float64) tensor(-4.0900, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8529, dtype=torch.float64) delta_t tensor(0.8305, dtype=torch.float64)
16 gae_duplicate tensor(2.4029, dtype=torch.float64) tensor(-4.9934, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8537, dtype=torch.float64) delta_t tensor(0.1154, dtype=torch.float64)
15 gae_duplicate tensor(2.0377, dtype=torch.float64) tensor(-4.2402, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8544, dtype=torch.float64) delta_t tensor(0.6512, dtype=torch.float64)
14 gae_duplicate tensor(2.2814, dtype=torch.float64) tensor(-4.7472, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6278, dtype=torch.float64) delta_t tensor(0.5206, dtype=torch.float64)
13 gae_duplicate tensor(2.3457, dtype=torch.float64) tensor(-4.8810, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4577, dtype=torch.float64) delta_t tensor(0.4226, dtype=torch.float64)
12 gae_duplicate tensor(2.2992, dtype=torch.float64) tensor(-4.7778, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5148, dtype=torch.float64) delta_t tensor(0.4000, dtype=torch.float64)
11 gae_duplicate tensor(2.2394, dtype=torch.float64) tensor(-4.6597, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6288, dtype=torch.float64) delta_t tensor(1.2191, dtype=torch.float64)
10 gae_duplicate tensor(3.0106, dtype=torch.float64) tensor(-6.2646, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4021, dtype=torch.float64) delta_t tensor(-0.0775, dtype=torch.float64)
9 gae_duplicate tensor(2.3310, dtype=torch.float64) tensor(-4.8504, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3353, dtype=torch.float64) delta_t tensor(0.4996, dtype=torch.float64)
8 gae_duplicate tensor(2.3644, dtype=torch.float64) tensor(-4.9266, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8460, dtype=torch.float64) delta_t tensor(-0.9733, dtype=torch.float64)
7 gae_duplicate tensor(0.9182, dtype=torch.float64) tensor(-1.9107, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0736, dtype=torch.float64) delta_t tensor(-0.3404, dtype=torch.float64)
6 gae_duplicate tensor(0.3942, dtype=torch.float64) tensor(-0.8191, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9614, dtype=torch.float64) delta_t tensor(-1.3940, dtype=torch.float64)
5 gae_duplicate tensor(-1.0787, dtype=torch.float64) tensor(2.2385, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3385, dtype=torch.float64) delta_t tensor(-0.0058, dtype=torch.float64)
4 gae_duplicate tensor(-0.8688, dtype=torch.float64) tensor(1.8102, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4158, dtype=torch.float64) delta_t tensor(-1.3667, dtype=torch.float64)
3 gae_duplicate tensor(-2.0617, dtype=torch.float64) tensor(4.2902, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1136, dtype=torch.float64) delta_t tensor(-0.4393, dtype=torch.float64)
2 gae_duplicate tensor(-2.0887, dtype=torch.float64) tensor(4.3462, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:256.6419982910156
value loss:103.4652099609375
entropies:37.42989730834961
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.575066804885864 seconds
19 rew tensor(0.8499, dtype=torch.float64) delta_t tensor(-0.1920, dtype=torch.float64)
19 gae_duplicate tensor(-0.1920, dtype=torch.float64) tensor(0.3995, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8506, dtype=torch.float64) delta_t tensor(0.6586, dtype=torch.float64)
18 gae_duplicate tensor(0.5051, dtype=torch.float64) tensor(-1.0510, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8514, dtype=torch.float64) delta_t tensor(0.8157, dtype=torch.float64)
17 gae_duplicate tensor(1.2197, dtype=torch.float64) tensor(-2.5381, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8521, dtype=torch.float64) delta_t tensor(1.2980, dtype=torch.float64)
16 gae_duplicate tensor(2.2738, dtype=torch.float64) tensor(-4.7186, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8529, dtype=torch.float64) delta_t tensor(0.8051, dtype=torch.float64)
15 gae_duplicate tensor(2.6241, dtype=torch.float64) tensor(-5.4530, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8537, dtype=torch.float64) delta_t tensor(0.8058, dtype=torch.float64)
14 gae_duplicate tensor(2.9052, dtype=torch.float64) tensor(-6.0452, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8544, dtype=torch.float64) delta_t tensor(0.8066, dtype=torch.float64)
13 gae_duplicate tensor(3.1307, dtype=torch.float64) tensor(-6.5235, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8552, dtype=torch.float64) delta_t tensor(0.8291, dtype=torch.float64)
12 gae_duplicate tensor(3.3337, dtype=torch.float64) tensor(-6.9276, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8559, dtype=torch.float64) delta_t tensor(0.3159, dtype=torch.float64)
11 gae_duplicate tensor(2.9829, dtype=torch.float64) tensor(-6.2070, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8567, dtype=torch.float64) delta_t tensor(0.6551, dtype=torch.float64)
10 gae_duplicate tensor(3.0414, dtype=torch.float64) tensor(-6.3201, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5150, dtype=torch.float64) delta_t tensor(0.2830, dtype=torch.float64)
9 gae_duplicate tensor(2.7162, dtype=torch.float64) tensor(-5.6520, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1159, dtype=torch.float64) delta_t tensor(1.4630, dtype=torch.float64)
8 gae_duplicate tensor(3.6359, dtype=torch.float64) tensor(-7.5657, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5114, dtype=torch.float64) delta_t tensor(-1.2562, dtype=torch.float64)
7 gae_duplicate tensor(1.6525, dtype=torch.float64) tensor(-3.4386, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5117, dtype=torch.float64) delta_t tensor(-0.6592, dtype=torch.float64)
6 gae_duplicate tensor(0.6628, dtype=torch.float64) tensor(-1.3791, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9680, dtype=torch.float64) delta_t tensor(0.0695, dtype=torch.float64)
5 gae_duplicate tensor(0.5997, dtype=torch.float64) tensor(-1.2480, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0572, dtype=torch.float64) delta_t tensor(0.0278, dtype=torch.float64)
4 gae_duplicate tensor(0.5076, dtype=torch.float64) tensor(-1.0533, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0824, dtype=torch.float64) delta_t tensor(-0.8219, dtype=torch.float64)
3 gae_duplicate tensor(-0.4158, dtype=torch.float64) tensor(0.8664, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9127, dtype=torch.float64) delta_t tensor(-0.9584, dtype=torch.float64)
2 gae_duplicate tensor(-1.2910, dtype=torch.float64) tensor(2.6827, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:371.90960693359375
value loss:131.34434509277344
entropies:37.429893493652344
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.320250988006592 seconds
19 rew tensor(0.8526, dtype=torch.float64) delta_t tensor(0.5439, dtype=torch.float64)
19 gae_duplicate tensor(0.5439, dtype=torch.float64) tensor(-1.1317, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8533, dtype=torch.float64) delta_t tensor(0.7916, dtype=torch.float64)
18 gae_duplicate tensor(1.2267, dtype=torch.float64) tensor(-2.5491, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8541, dtype=torch.float64) delta_t tensor(0.8098, dtype=torch.float64)
17 gae_duplicate tensor(1.7911, dtype=torch.float64) tensor(-3.7272, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8548, dtype=torch.float64) delta_t tensor(0.7966, dtype=torch.float64)
16 gae_duplicate tensor(2.2295, dtype=torch.float64) tensor(-4.6328, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8556, dtype=torch.float64) delta_t tensor(0.9201, dtype=torch.float64)
15 gae_duplicate tensor(2.7037, dtype=torch.float64) tensor(-5.6261, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8563, dtype=torch.float64) delta_t tensor(0.0681, dtype=torch.float64)
14 gae_duplicate tensor(2.2310, dtype=torch.float64) tensor(-4.6361, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5701, dtype=torch.float64) delta_t tensor(0.7757, dtype=torch.float64)
13 gae_duplicate tensor(2.5605, dtype=torch.float64) tensor(-5.3282, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1181, dtype=torch.float64) delta_t tensor(0.5930, dtype=torch.float64)
12 gae_duplicate tensor(2.6414, dtype=torch.float64) tensor(-5.4888, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0035, dtype=torch.float64) delta_t tensor(-0.5999, dtype=torch.float64)
11 gae_duplicate tensor(1.5132, dtype=torch.float64) tensor(-3.1401, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1181, dtype=torch.float64) delta_t tensor(-0.5651, dtype=torch.float64)
10 gae_duplicate tensor(0.6454, dtype=torch.float64) tensor(-1.3412, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6266, dtype=torch.float64) delta_t tensor(1.1997, dtype=torch.float64)
9 gae_duplicate tensor(1.7160, dtype=torch.float64) tensor(-3.5758, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1116, dtype=torch.float64) delta_t tensor(0.7459, dtype=torch.float64)
8 gae_duplicate tensor(2.1187, dtype=torch.float64) tensor(-4.4025, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1746, dtype=torch.float64) delta_t tensor(-0.7501, dtype=torch.float64)
7 gae_duplicate tensor(0.9449, dtype=torch.float64) tensor(-1.9662, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1474, dtype=torch.float64) delta_t tensor(-0.4879, dtype=torch.float64)
6 gae_duplicate tensor(0.2680, dtype=torch.float64) tensor(-0.5568, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4921, dtype=torch.float64) delta_t tensor(-0.8549, dtype=torch.float64)
5 gae_duplicate tensor(-0.6406, dtype=torch.float64) tensor(1.3311, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5211, dtype=torch.float64) delta_t tensor(-1.0307, dtype=torch.float64)
4 gae_duplicate tensor(-1.5431, dtype=torch.float64) tensor(3.2066, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1780, dtype=torch.float64) delta_t tensor(0.1945, dtype=torch.float64)
3 gae_duplicate tensor(-1.0401, dtype=torch.float64) tensor(2.1613, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0935, dtype=torch.float64) delta_t tensor(-1.0236, dtype=torch.float64)
2 gae_duplicate tensor(-1.8556, dtype=torch.float64) tensor(3.8667, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:224.09764099121094
value loss:81.33152770996094
entropies:37.42988967895508
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.8154)
ToM Target loss= tensor(300.7534)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.328593969345093 seconds
19 rew tensor(0.7967, dtype=torch.float64) delta_t tensor(-0.5696, dtype=torch.float64)
19 gae_duplicate tensor(-0.5696, dtype=torch.float64) tensor(1.1853, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6821, dtype=torch.float64) delta_t tensor(0.2100, dtype=torch.float64)
18 gae_duplicate tensor(-0.2456, dtype=torch.float64) tensor(0.5104, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5099, dtype=torch.float64) delta_t tensor(0.3288, dtype=torch.float64)
17 gae_duplicate tensor(0.1323, dtype=torch.float64) tensor(-0.2749, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1072, dtype=torch.float64) delta_t tensor(0.1340, dtype=torch.float64)
16 gae_duplicate tensor(0.2398, dtype=torch.float64) tensor(-0.4983, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.4682, dtype=torch.float64) delta_t tensor(0.1345, dtype=torch.float64)
15 gae_duplicate tensor(0.3263, dtype=torch.float64) tensor(-0.6790, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8545, dtype=torch.float64) delta_t tensor(0.7959, dtype=torch.float64)
14 gae_duplicate tensor(1.0569, dtype=torch.float64) tensor(-2.1963, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8552, dtype=torch.float64) delta_t tensor(0.7966, dtype=torch.float64)
13 gae_duplicate tensor(1.6422, dtype=torch.float64) tensor(-3.4219, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8560, dtype=torch.float64) delta_t tensor(0.7973, dtype=torch.float64)
12 gae_duplicate tensor(2.1111, dtype=torch.float64) tensor(-4.3929, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8567, dtype=torch.float64) delta_t tensor(1.2804, dtype=torch.float64)
11 gae_duplicate tensor(2.9692, dtype=torch.float64) tensor(-6.1786, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6275, dtype=torch.float64) delta_t tensor(-0.4871, dtype=torch.float64)
10 gae_duplicate tensor(1.8882, dtype=torch.float64) tensor(-3.9238, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6365, dtype=torch.float64) delta_t tensor(-0.7758, dtype=torch.float64)
9 gae_duplicate tensor(0.7348, dtype=torch.float64) tensor(-1.5270, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5122, dtype=torch.float64) delta_t tensor(0.2096, dtype=torch.float64)
8 gae_duplicate tensor(0.7975, dtype=torch.float64) tensor(-1.6619, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3402, dtype=torch.float64) delta_t tensor(0.2041, dtype=torch.float64)
7 gae_duplicate tensor(0.8421, dtype=torch.float64) tensor(-1.7523, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0041, dtype=torch.float64) delta_t tensor(0.2901, dtype=torch.float64)
6 gae_duplicate tensor(0.9638, dtype=torch.float64) tensor(-2.0055, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9551, dtype=torch.float64) delta_t tensor(-0.7859, dtype=torch.float64)
5 gae_duplicate tensor(-0.0149, dtype=torch.float64) tensor(0.0309, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0173, dtype=torch.float64) delta_t tensor(-2.3326, dtype=torch.float64)
4 gae_duplicate tensor(-2.3445, dtype=torch.float64) tensor(4.8650, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1807, dtype=torch.float64) delta_t tensor(0.2946, dtype=torch.float64)
3 gae_duplicate tensor(-1.5810, dtype=torch.float64) tensor(3.2899, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2384, dtype=torch.float64) delta_t tensor(-0.0926, dtype=torch.float64)
2 gae_duplicate tensor(-1.3574, dtype=torch.float64) tensor(2.8167, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:93.76231384277344
value loss:50.806800842285156
entropies:37.42988586425781
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.833550930023193 seconds
19 rew tensor(0.4508, dtype=torch.float64) delta_t tensor(-1.2202, dtype=torch.float64)
19 gae_duplicate tensor(-1.2202, dtype=torch.float64) tensor(2.5390, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.0002, dtype=torch.float64) delta_t tensor(0.0885, dtype=torch.float64)
18 gae_duplicate tensor(-0.8876, dtype=torch.float64) tensor(1.8497, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.6758, dtype=torch.float64) delta_t tensor(-0.2361, dtype=torch.float64)
17 gae_duplicate tensor(-0.9462, dtype=torch.float64) tensor(1.9663, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7880, dtype=torch.float64) delta_t tensor(0.7081, dtype=torch.float64)
16 gae_duplicate tensor(-0.0489, dtype=torch.float64) tensor(0.1016, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7886, dtype=torch.float64) delta_t tensor(0.7194, dtype=torch.float64)
15 gae_duplicate tensor(0.6802, dtype=torch.float64) tensor(-1.4155, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6767, dtype=torch.float64) delta_t tensor(0.8836, dtype=torch.float64)
14 gae_duplicate tensor(1.4278, dtype=torch.float64) tensor(-2.9712, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5083, dtype=torch.float64) delta_t tensor(0.6769, dtype=torch.float64)
13 gae_duplicate tensor(1.8192, dtype=torch.float64) tensor(-3.7802, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8462, dtype=torch.float64) delta_t tensor(-0.5588, dtype=torch.float64)
12 gae_duplicate tensor(0.8965, dtype=torch.float64) tensor(-1.8682, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7906, dtype=torch.float64) delta_t tensor(0.5035, dtype=torch.float64)
11 gae_duplicate tensor(1.2207, dtype=torch.float64) tensor(-2.5366, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6787, dtype=torch.float64) delta_t tensor(0.3940, dtype=torch.float64)
10 gae_duplicate tensor(1.3705, dtype=torch.float64) tensor(-2.8519, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.8070, dtype=torch.float64) delta_t tensor(-2.9700, dtype=torch.float64)
9 gae_duplicate tensor(-1.8736, dtype=torch.float64) tensor(3.8987, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.8601, dtype=torch.float64) delta_t tensor(-1.9993, dtype=torch.float64)
8 gae_duplicate tensor(-3.4981, dtype=torch.float64) tensor(7.2793, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2259, dtype=torch.float64) delta_t tensor(0.0452, dtype=torch.float64)
7 gae_duplicate tensor(-2.7533, dtype=torch.float64) tensor(5.7214, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2420, dtype=torch.float64) delta_t tensor(-0.8887, dtype=torch.float64)
6 gae_duplicate tensor(-3.0914, dtype=torch.float64) tensor(6.4150, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9212, dtype=torch.float64) delta_t tensor(-0.4953, dtype=torch.float64)
5 gae_duplicate tensor(-2.9684, dtype=torch.float64) tensor(6.1856, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-6.5062, dtype=torch.float64) delta_t tensor(-6.7853, dtype=torch.float64)
4 gae_duplicate tensor(-9.1600, dtype=torch.float64) tensor(19.0076, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0672, dtype=torch.float64) delta_t tensor(-0.0847, dtype=torch.float64)
3 gae_duplicate tensor(-7.4127, dtype=torch.float64) tensor(15.4466, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0672, dtype=torch.float64) delta_t tensor(0.1818, dtype=torch.float64)
2 gae_duplicate tensor(-5.7484, dtype=torch.float64) tensor(11.9618, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-402.81646728515625
value loss:340.1271667480469
entropies:37.42988967895508
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.430541753768921 seconds
19 rew tensor(0.8452, dtype=torch.float64) delta_t tensor(-0.7366, dtype=torch.float64)
19 gae_duplicate tensor(-0.7366, dtype=torch.float64) tensor(1.5307, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8459, dtype=torch.float64) delta_t tensor(0.2712, dtype=torch.float64)
18 gae_duplicate tensor(-0.3181, dtype=torch.float64) tensor(0.6610, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8465, dtype=torch.float64) delta_t tensor(0.8356, dtype=torch.float64)
17 gae_duplicate tensor(0.5811, dtype=torch.float64) tensor(-1.2075, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8472, dtype=torch.float64) delta_t tensor(0.7553, dtype=torch.float64)
16 gae_duplicate tensor(1.2202, dtype=torch.float64) tensor(-2.5426, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8479, dtype=torch.float64) delta_t tensor(0.7571, dtype=torch.float64)
15 gae_duplicate tensor(1.7332, dtype=torch.float64) tensor(-3.6116, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8486, dtype=torch.float64) delta_t tensor(1.4528, dtype=torch.float64)
14 gae_duplicate tensor(2.8393, dtype=torch.float64) tensor(-5.8919, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8493, dtype=torch.float64) delta_t tensor(0.8346, dtype=torch.float64)
13 gae_duplicate tensor(3.1061, dtype=torch.float64) tensor(-6.4633, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8500, dtype=torch.float64) delta_t tensor(0.8012, dtype=torch.float64)
12 gae_duplicate tensor(3.2861, dtype=torch.float64) tensor(-6.8282, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8507, dtype=torch.float64) delta_t tensor(0.8019, dtype=torch.float64)
11 gae_duplicate tensor(3.4307, dtype=torch.float64) tensor(-7.1289, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5120, dtype=torch.float64) delta_t tensor(1.1629, dtype=torch.float64)
10 gae_duplicate tensor(3.9075, dtype=torch.float64) tensor(-8.1198, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1730, dtype=torch.float64) delta_t tensor(-1.0978, dtype=torch.float64)
9 gae_duplicate tensor(2.0282, dtype=torch.float64) tensor(-4.2146, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1731, dtype=torch.float64) delta_t tensor(-0.1110, dtype=torch.float64)
8 gae_duplicate tensor(1.5115, dtype=torch.float64) tensor(-3.1453, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0528, dtype=torch.float64) delta_t tensor(0.8273, dtype=torch.float64)
7 gae_duplicate tensor(2.0366, dtype=torch.float64) tensor(-4.2379, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0529, dtype=torch.float64) delta_t tensor(0.4957, dtype=torch.float64)
6 gae_duplicate tensor(2.1250, dtype=torch.float64) tensor(-4.4157, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9560, dtype=torch.float64) delta_t tensor(-1.0521, dtype=torch.float64)
5 gae_duplicate tensor(0.6479, dtype=torch.float64) tensor(-1.3483, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0697, dtype=torch.float64) delta_t tensor(-0.3536, dtype=torch.float64)
4 gae_duplicate tensor(0.1648, dtype=torch.float64) tensor(-0.3433, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9579, dtype=torch.float64) delta_t tensor(-1.4003, dtype=torch.float64)
3 gae_duplicate tensor(-1.2685, dtype=torch.float64) tensor(2.6397, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8459, dtype=torch.float64) delta_t tensor(-1.0570, dtype=torch.float64)
2 gae_duplicate tensor(-2.0718, dtype=torch.float64) tensor(4.3113, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:301.0158386230469
value loss:123.64501953125
entropies:37.42988204956055
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.447171211242676 seconds
19 rew tensor(0.8471, dtype=torch.float64) delta_t tensor(-0.9871, dtype=torch.float64)
19 gae_duplicate tensor(-0.9871, dtype=torch.float64) tensor(2.0569, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8478, dtype=torch.float64) delta_t tensor(0.9150, dtype=torch.float64)
18 gae_duplicate tensor(0.1253, dtype=torch.float64) tensor(-0.2608, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8485, dtype=torch.float64) delta_t tensor(1.5431, dtype=torch.float64)
17 gae_duplicate tensor(1.6434, dtype=torch.float64) tensor(-3.4149, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8491, dtype=torch.float64) delta_t tensor(0.8523, dtype=torch.float64)
16 gae_duplicate tensor(2.1671, dtype=torch.float64) tensor(-4.5095, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8498, dtype=torch.float64) delta_t tensor(0.7353, dtype=torch.float64)
15 gae_duplicate tensor(2.4690, dtype=torch.float64) tensor(-5.1377, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8505, dtype=torch.float64) delta_t tensor(0.8026, dtype=torch.float64)
14 gae_duplicate tensor(2.7778, dtype=torch.float64) tensor(-5.7885, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8512, dtype=torch.float64) delta_t tensor(0.8100, dtype=torch.float64)
13 gae_duplicate tensor(3.0323, dtype=torch.float64) tensor(-6.3010, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3977, dtype=torch.float64) delta_t tensor(-0.7437, dtype=torch.float64)
12 gae_duplicate tensor(1.6821, dtype=torch.float64) tensor(-3.5003, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1709, dtype=torch.float64) delta_t tensor(1.1867, dtype=torch.float64)
11 gae_duplicate tensor(2.5324, dtype=torch.float64) tensor(-5.2548, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1126, dtype=torch.float64) delta_t tensor(-0.9098, dtype=torch.float64)
10 gae_duplicate tensor(1.1162, dtype=torch.float64) tensor(-2.3194, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1693, dtype=torch.float64) delta_t tensor(-0.6316, dtype=torch.float64)
9 gae_duplicate tensor(0.2613, dtype=torch.float64) tensor(-0.5438, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3394, dtype=torch.float64) delta_t tensor(-0.7624, dtype=torch.float64)
8 gae_duplicate tensor(-0.5534, dtype=torch.float64) tensor(1.1515, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1702, dtype=torch.float64) delta_t tensor(0.2451, dtype=torch.float64)
7 gae_duplicate tensor(-0.1976, dtype=torch.float64) tensor(0.4112, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6224, dtype=torch.float64) delta_t tensor(0.6833, dtype=torch.float64)
6 gae_duplicate tensor(0.5252, dtype=torch.float64) tensor(-1.0913, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5851, dtype=torch.float64) delta_t tensor(-2.4043, dtype=torch.float64)
5 gae_duplicate tensor(-1.9841, dtype=torch.float64) tensor(4.1230, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5877, dtype=torch.float64) delta_t tensor(-1.4889, dtype=torch.float64)
4 gae_duplicate tensor(-3.0763, dtype=torch.float64) tensor(6.3924, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.7338, dtype=torch.float64) delta_t tensor(1.1760, dtype=torch.float64)
3 gae_duplicate tensor(-1.2850, dtype=torch.float64) tensor(2.6663, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0793, dtype=torch.float64) delta_t tensor(-1.0340, dtype=torch.float64)
2 gae_duplicate tensor(-2.0620, dtype=torch.float64) tensor(4.2968, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:101.01947021484375
value loss:92.81133270263672
entropies:37.42988204956055
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.497554063796997 seconds
19 rew tensor(0.8471, dtype=torch.float64) delta_t tensor(-1.1858, dtype=torch.float64)
19 gae_duplicate tensor(-1.1858, dtype=torch.float64) tensor(2.4641, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8478, dtype=torch.float64) delta_t tensor(0.8094, dtype=torch.float64)
18 gae_duplicate tensor(-0.1392, dtype=torch.float64) tensor(0.2889, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8485, dtype=torch.float64) delta_t tensor(0.5907, dtype=torch.float64)
17 gae_duplicate tensor(0.4793, dtype=torch.float64) tensor(-0.9988, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8491, dtype=torch.float64) delta_t tensor(1.4236, dtype=torch.float64)
16 gae_duplicate tensor(1.8070, dtype=torch.float64) tensor(-3.7496, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8498, dtype=torch.float64) delta_t tensor(1.5344, dtype=torch.float64)
15 gae_duplicate tensor(2.9801, dtype=torch.float64) tensor(-6.2013, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8505, dtype=torch.float64) delta_t tensor(0.5410, dtype=torch.float64)
14 gae_duplicate tensor(2.9250, dtype=torch.float64) tensor(-6.0695, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6227, dtype=torch.float64) delta_t tensor(0.4727, dtype=torch.float64)
13 gae_duplicate tensor(2.8127, dtype=torch.float64) tensor(-5.8613, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3947, dtype=torch.float64) delta_t tensor(0.7059, dtype=torch.float64)
12 gae_duplicate tensor(2.9560, dtype=torch.float64) tensor(-6.1512, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2237, dtype=torch.float64) delta_t tensor(-0.3117, dtype=torch.float64)
11 gae_duplicate tensor(2.0531, dtype=torch.float64) tensor(-4.2663, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0526, dtype=torch.float64) delta_t tensor(-0.6588, dtype=torch.float64)
10 gae_duplicate tensor(0.9837, dtype=torch.float64) tensor(-2.0413, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0614, dtype=torch.float64) delta_t tensor(0.1320, dtype=torch.float64)
9 gae_duplicate tensor(0.9190, dtype=torch.float64) tensor(-1.9095, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3946, dtype=torch.float64) delta_t tensor(0.8863, dtype=torch.float64)
8 gae_duplicate tensor(1.6215, dtype=torch.float64) tensor(-3.3742, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0041, dtype=torch.float64) delta_t tensor(0.5809, dtype=torch.float64)
7 gae_duplicate tensor(1.8781, dtype=torch.float64) tensor(-3.9025, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6793, dtype=torch.float64) delta_t tensor(0.1704, dtype=torch.float64)
6 gae_duplicate tensor(1.6729, dtype=torch.float64) tensor(-3.4860, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8006, dtype=torch.float64) delta_t tensor(-1.0531, dtype=torch.float64)
5 gae_duplicate tensor(0.2852, dtype=torch.float64) tensor(-0.5934, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3374, dtype=torch.float64) delta_t tensor(0.7166, dtype=torch.float64)
4 gae_duplicate tensor(0.9447, dtype=torch.float64) tensor(-1.9631, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7437, dtype=torch.float64) delta_t tensor(-0.7099, dtype=torch.float64)
3 gae_duplicate tensor(0.0459, dtype=torch.float64) tensor(-0.0956, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5166, dtype=torch.float64) delta_t tensor(-0.6753, dtype=torch.float64)
2 gae_duplicate tensor(-0.6385, dtype=torch.float64) tensor(1.3287, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:278.3688659667969
value loss:83.05912017822266
entropies:37.42987823486328
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.3487)
ToM Target loss= tensor(300.8017)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.530918836593628 seconds
19 rew tensor(0.8470, dtype=torch.float64) delta_t tensor(-0.2998, dtype=torch.float64)
19 gae_duplicate tensor(-0.2998, dtype=torch.float64) tensor(0.6221, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8477, dtype=torch.float64) delta_t tensor(-0.1611, dtype=torch.float64)
18 gae_duplicate tensor(-0.4009, dtype=torch.float64) tensor(0.8331, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8483, dtype=torch.float64) delta_t tensor(0.6043, dtype=torch.float64)
17 gae_duplicate tensor(0.2835, dtype=torch.float64) tensor(-0.5900, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8490, dtype=torch.float64) delta_t tensor(0.5312, dtype=torch.float64)
16 gae_duplicate tensor(0.7581, dtype=torch.float64) tensor(-1.5775, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8496, dtype=torch.float64) delta_t tensor(0.5297, dtype=torch.float64)
15 gae_duplicate tensor(1.1361, dtype=torch.float64) tensor(-2.3609, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8503, dtype=torch.float64) delta_t tensor(1.1270, dtype=torch.float64)
14 gae_duplicate tensor(2.0360, dtype=torch.float64) tensor(-4.2307, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8509, dtype=torch.float64) delta_t tensor(0.6316, dtype=torch.float64)
13 gae_duplicate tensor(2.2604, dtype=torch.float64) tensor(-4.7037, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8516, dtype=torch.float64) delta_t tensor(0.6710, dtype=torch.float64)
12 gae_duplicate tensor(2.4794, dtype=torch.float64) tensor(-5.1519, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8523, dtype=torch.float64) delta_t tensor(0.6407, dtype=torch.float64)
11 gae_duplicate tensor(2.6242, dtype=torch.float64) tensor(-5.4685, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6238, dtype=torch.float64) delta_t tensor(0.6863, dtype=torch.float64)
10 gae_duplicate tensor(2.7856, dtype=torch.float64) tensor(-5.7883, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3379, dtype=torch.float64) delta_t tensor(-0.6392, dtype=torch.float64)
9 gae_duplicate tensor(1.5893, dtype=torch.float64) tensor(-3.3073, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0519, dtype=torch.float64) delta_t tensor(0.3827, dtype=torch.float64)
8 gae_duplicate tensor(1.6542, dtype=torch.float64) tensor(-3.4373, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0625, dtype=torch.float64) delta_t tensor(-0.5809, dtype=torch.float64)
7 gae_duplicate tensor(0.7424, dtype=torch.float64) tensor(-1.5427, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8631, dtype=torch.float64) delta_t tensor(0.0232, dtype=torch.float64)
6 gae_duplicate tensor(0.6171, dtype=torch.float64) tensor(-1.2842, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4635, dtype=torch.float64) delta_t tensor(0.1940, dtype=torch.float64)
5 gae_duplicate tensor(0.6877, dtype=torch.float64) tensor(-1.4289, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4926, dtype=torch.float64) delta_t tensor(-1.9898, dtype=torch.float64)
4 gae_duplicate tensor(-1.4396, dtype=torch.float64) tensor(2.9958, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3232, dtype=torch.float64) delta_t tensor(-0.8526, dtype=torch.float64)
3 gae_duplicate tensor(-2.0043, dtype=torch.float64) tensor(4.1707, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0388, dtype=torch.float64) delta_t tensor(-1.1217, dtype=torch.float64)
2 gae_duplicate tensor(-2.7251, dtype=torch.float64) tensor(5.6626, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:158.40252685546875
value loss:78.64117431640625
entropies:37.42987823486328
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.67566990852356 seconds
19 rew tensor(0.8488, dtype=torch.float64) delta_t tensor(-1.3292, dtype=torch.float64)
19 gae_duplicate tensor(-1.3292, dtype=torch.float64) tensor(2.7661, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8494, dtype=torch.float64) delta_t tensor(0.4021, dtype=torch.float64)
18 gae_duplicate tensor(-0.6613, dtype=torch.float64) tensor(1.3722, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8501, dtype=torch.float64) delta_t tensor(0.4179, dtype=torch.float64)
17 gae_duplicate tensor(-0.1111, dtype=torch.float64) tensor(0.2309, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8507, dtype=torch.float64) delta_t tensor(0.6909, dtype=torch.float64)
16 gae_duplicate tensor(0.6020, dtype=torch.float64) tensor(-1.2545, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8514, dtype=torch.float64) delta_t tensor(0.4522, dtype=torch.float64)
15 gae_duplicate tensor(0.9338, dtype=torch.float64) tensor(-1.9403, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8520, dtype=torch.float64) delta_t tensor(1.1682, dtype=torch.float64)
14 gae_duplicate tensor(1.9152, dtype=torch.float64) tensor(-3.9912, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8527, dtype=torch.float64) delta_t tensor(0.7824, dtype=torch.float64)
13 gae_duplicate tensor(2.3145, dtype=torch.float64) tensor(-4.8164, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5661, dtype=torch.float64) delta_t tensor(0.3854, dtype=torch.float64)
12 gae_duplicate tensor(2.2370, dtype=torch.float64) tensor(-4.6551, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5090, dtype=torch.float64) delta_t tensor(1.0408, dtype=torch.float64)
11 gae_duplicate tensor(2.8304, dtype=torch.float64) tensor(-5.8899, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1075, dtype=torch.float64) delta_t tensor(0.5309, dtype=torch.float64)
10 gae_duplicate tensor(2.7952, dtype=torch.float64) tensor(-5.8000, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2941, dtype=torch.float64) delta_t tensor(-1.9253, dtype=torch.float64)
9 gae_duplicate tensor(0.3109, dtype=torch.float64) tensor(-0.6450, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5810, dtype=torch.float64) delta_t tensor(-1.0943, dtype=torch.float64)
8 gae_duplicate tensor(-0.8456, dtype=torch.float64) tensor(1.7545, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0080, dtype=torch.float64) delta_t tensor(1.0813, dtype=torch.float64)
7 gae_duplicate tensor(0.4049, dtype=torch.float64) tensor(-0.8437, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3518, dtype=torch.float64) delta_t tensor(-0.5994, dtype=torch.float64)
6 gae_duplicate tensor(-0.2755, dtype=torch.float64) tensor(0.5726, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4405, dtype=torch.float64) delta_t tensor(-1.3682, dtype=torch.float64)
5 gae_duplicate tensor(-1.5886, dtype=torch.float64) tensor(3.3057, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8437, dtype=torch.float64) delta_t tensor(-1.2745, dtype=torch.float64)
4 gae_duplicate tensor(-2.5454, dtype=torch.float64) tensor(5.2892, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4129, dtype=torch.float64) delta_t tensor(-0.2013, dtype=torch.float64)
3 gae_duplicate tensor(-2.2376, dtype=torch.float64) tensor(4.6496, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5029, dtype=torch.float64) delta_t tensor(-1.8411, dtype=torch.float64)
2 gae_duplicate tensor(-3.6312, dtype=torch.float64) tensor(7.5455, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:12.974809646606445
value loss:92.32757568359375
entropies:37.42987823486328
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.559416055679321 seconds
19 rew tensor(0.8509, dtype=torch.float64) delta_t tensor(-0.7233, dtype=torch.float64)
19 gae_duplicate tensor(-0.7233, dtype=torch.float64) tensor(1.5029, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8515, dtype=torch.float64) delta_t tensor(0.5367, dtype=torch.float64)
18 gae_duplicate tensor(-0.0419, dtype=torch.float64) tensor(0.0872, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8522, dtype=torch.float64) delta_t tensor(0.5894, dtype=torch.float64)
17 gae_duplicate tensor(0.5558, dtype=torch.float64) tensor(-1.1566, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8528, dtype=torch.float64) delta_t tensor(0.4066, dtype=torch.float64)
16 gae_duplicate tensor(0.8513, dtype=torch.float64) tensor(-1.7664, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8534, dtype=torch.float64) delta_t tensor(0.0765, dtype=torch.float64)
15 gae_duplicate tensor(0.7575, dtype=torch.float64) tensor(-1.5741, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8541, dtype=torch.float64) delta_t tensor(0.4602, dtype=torch.float64)
14 gae_duplicate tensor(1.0662, dtype=torch.float64) tensor(-2.2123, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2197, dtype=torch.float64) delta_t tensor(0.0482, dtype=torch.float64)
13 gae_duplicate tensor(0.9011, dtype=torch.float64) tensor(-1.8724, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0111, dtype=torch.float64) delta_t tensor(0.8793, dtype=torch.float64)
12 gae_duplicate tensor(1.6002, dtype=torch.float64) tensor(-3.3203, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0687, dtype=torch.float64) delta_t tensor(-0.9439, dtype=torch.float64)
11 gae_duplicate tensor(0.3363, dtype=torch.float64) tensor(-0.6997, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2418, dtype=torch.float64) delta_t tensor(-0.9481, dtype=torch.float64)
10 gae_duplicate tensor(-0.6791, dtype=torch.float64) tensor(1.4111, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6226, dtype=torch.float64) delta_t tensor(1.2357, dtype=torch.float64)
9 gae_duplicate tensor(0.6924, dtype=torch.float64) tensor(-1.4389, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1045, dtype=torch.float64) delta_t tensor(-0.4196, dtype=torch.float64)
8 gae_duplicate tensor(0.1344, dtype=torch.float64) tensor(-0.2796, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5290, dtype=torch.float64) delta_t tensor(-1.1868, dtype=torch.float64)
7 gae_duplicate tensor(-1.0793, dtype=torch.float64) tensor(2.2427, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2202, dtype=torch.float64) delta_t tensor(-0.3685, dtype=torch.float64)
6 gae_duplicate tensor(-1.2319, dtype=torch.float64) tensor(2.5599, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4485, dtype=torch.float64) delta_t tensor(0.6371, dtype=torch.float64)
5 gae_duplicate tensor(-0.3484, dtype=torch.float64) tensor(0.7240, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7026, dtype=torch.float64) delta_t tensor(-0.1914, dtype=torch.float64)
4 gae_duplicate tensor(-0.4701, dtype=torch.float64) tensor(0.9769, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1027, dtype=torch.float64) delta_t tensor(-0.5791, dtype=torch.float64)
3 gae_duplicate tensor(-0.9552, dtype=torch.float64) tensor(1.9907, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1054, dtype=torch.float64) delta_t tensor(-1.0063, dtype=torch.float64)
2 gae_duplicate tensor(-1.7705, dtype=torch.float64) tensor(3.6842, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6.2789716720581055
value loss:22.177974700927734
entropies:37.42987823486328
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5981221199035645 seconds
19 rew tensor(0.8379, dtype=torch.float64) delta_t tensor(-0.7282, dtype=torch.float64)
19 gae_duplicate tensor(-0.7282, dtype=torch.float64) tensor(1.5110, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8385, dtype=torch.float64) delta_t tensor(0.0415, dtype=torch.float64)
18 gae_duplicate tensor(-0.5411, dtype=torch.float64) tensor(1.1259, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8391, dtype=torch.float64) delta_t tensor(0.6066, dtype=torch.float64)
17 gae_duplicate tensor(0.1737, dtype=torch.float64) tensor(-0.3610, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8397, dtype=torch.float64) delta_t tensor(0.3600, dtype=torch.float64)
16 gae_duplicate tensor(0.4990, dtype=torch.float64) tensor(-1.0384, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8403, dtype=torch.float64) delta_t tensor(0.6217, dtype=torch.float64)
15 gae_duplicate tensor(1.0209, dtype=torch.float64) tensor(-2.1245, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8410, dtype=torch.float64) delta_t tensor(0.9904, dtype=torch.float64)
14 gae_duplicate tensor(1.8072, dtype=torch.float64) tensor(-3.7552, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8416, dtype=torch.float64) delta_t tensor(0.1828, dtype=torch.float64)
13 gae_duplicate tensor(1.6285, dtype=torch.float64) tensor(-3.3889, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1655, dtype=torch.float64) delta_t tensor(1.5181, dtype=torch.float64)
12 gae_duplicate tensor(2.8209, dtype=torch.float64) tensor(-5.8701, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2220, dtype=torch.float64) delta_t tensor(-0.3746, dtype=torch.float64)
11 gae_duplicate tensor(1.8821, dtype=torch.float64) tensor(-3.9110, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2221, dtype=torch.float64) delta_t tensor(-0.3457, dtype=torch.float64)
10 gae_duplicate tensor(1.1600, dtype=torch.float64) tensor(-2.4173, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2222, dtype=torch.float64) delta_t tensor(-0.5322, dtype=torch.float64)
9 gae_duplicate tensor(0.3957, dtype=torch.float64) tensor(-0.8235, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1155, dtype=torch.float64) delta_t tensor(-0.7930, dtype=torch.float64)
8 gae_duplicate tensor(-0.4764, dtype=torch.float64) tensor(0.9899, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6912, dtype=torch.float64) delta_t tensor(-1.8313, dtype=torch.float64)
7 gae_duplicate tensor(-2.2124, dtype=torch.float64) tensor(4.5907, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.0883, dtype=torch.float64) delta_t tensor(-2.0093, dtype=torch.float64)
6 gae_duplicate tensor(-3.7792, dtype=torch.float64) tensor(7.8641, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9239, dtype=torch.float64) delta_t tensor(-1.9547, dtype=torch.float64)
5 gae_duplicate tensor(-4.9780, dtype=torch.float64) tensor(10.3588, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-7.5178, dtype=torch.float64) delta_t tensor(-7.3711, dtype=torch.float64)
4 gae_duplicate tensor(-11.3535, dtype=torch.float64) tensor(23.6601, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3041, dtype=torch.float64) delta_t tensor(1.1828, dtype=torch.float64)
3 gae_duplicate tensor(-7.8999, dtype=torch.float64) tensor(16.4156, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3042, dtype=torch.float64) delta_t tensor(-0.9762, dtype=torch.float64)
2 gae_duplicate tensor(-7.2961, dtype=torch.float64) tensor(15.1609, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-349.0453186035156
value loss:464.6893310546875
entropies:37.42988204956055
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.353099822998047 seconds
19 rew tensor(0.7280, dtype=torch.float64) delta_t tensor(-1.7519, dtype=torch.float64)
19 gae_duplicate tensor(-1.7519, dtype=torch.float64) tensor(3.6457, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6720, dtype=torch.float64) delta_t tensor(0.1492, dtype=torch.float64)
18 gae_duplicate tensor(-1.2523, dtype=torch.float64) tensor(2.5985, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4466, dtype=torch.float64) delta_t tensor(-0.1049, dtype=torch.float64)
17 gae_duplicate tensor(-1.1068, dtype=torch.float64) tensor(2.3031, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0519, dtype=torch.float64) delta_t tensor(-0.0944, dtype=torch.float64)
16 gae_duplicate tensor(-0.9798, dtype=torch.float64) tensor(2.0359, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.6814, dtype=torch.float64) delta_t tensor(-0.3702, dtype=torch.float64)
15 gae_duplicate tensor(-1.1540, dtype=torch.float64) tensor(2.3946, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8408, dtype=torch.float64) delta_t tensor(0.5523, dtype=torch.float64)
14 gae_duplicate tensor(-0.3709, dtype=torch.float64) tensor(0.7718, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8414, dtype=torch.float64) delta_t tensor(0.5529, dtype=torch.float64)
13 gae_duplicate tensor(0.2562, dtype=torch.float64) tensor(-0.5331, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8420, dtype=torch.float64) delta_t tensor(0.5535, dtype=torch.float64)
12 gae_duplicate tensor(0.7585, dtype=torch.float64) tensor(-1.5738, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8426, dtype=torch.float64) delta_t tensor(0.7373, dtype=torch.float64)
11 gae_duplicate tensor(1.3441, dtype=torch.float64) tensor(-2.8010, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6177, dtype=torch.float64) delta_t tensor(-0.7852, dtype=torch.float64)
10 gae_duplicate tensor(0.2901, dtype=torch.float64) tensor(-0.6027, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7485, dtype=torch.float64) delta_t tensor(-1.9432, dtype=torch.float64)
9 gae_duplicate tensor(-1.7112, dtype=torch.float64) tensor(3.5609, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6800, dtype=torch.float64) delta_t tensor(-1.2446, dtype=torch.float64)
8 gae_duplicate tensor(-2.6136, dtype=torch.float64) tensor(5.4387, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2217, dtype=torch.float64) delta_t tensor(-0.1940, dtype=torch.float64)
7 gae_duplicate tensor(-2.2849, dtype=torch.float64) tensor(4.7548, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.3708, dtype=torch.float64) delta_t tensor(-2.3142, dtype=torch.float64)
6 gae_duplicate tensor(-4.1421, dtype=torch.float64) tensor(8.6070, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9257, dtype=torch.float64) delta_t tensor(-0.7166, dtype=torch.float64)
5 gae_duplicate tensor(-4.0303, dtype=torch.float64) tensor(8.3870, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1624, dtype=torch.float64) delta_t tensor(0.3085, dtype=torch.float64)
4 gae_duplicate tensor(-2.9158, dtype=torch.float64) tensor(6.0676, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4027, dtype=torch.float64) delta_t tensor(-0.6202, dtype=torch.float64)
3 gae_duplicate tensor(-2.9528, dtype=torch.float64) tensor(6.1535, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4029, dtype=torch.float64) delta_t tensor(-0.2165, dtype=torch.float64)
2 gae_duplicate tensor(-2.5788, dtype=torch.float64) tensor(5.3742, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-340.6188049316406
value loss:124.61167907714844
entropies:37.42987823486328
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.0681)
ToM Target loss= tensor(300.7023)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.509603977203369 seconds
19 rew tensor(0.8417, dtype=torch.float64) delta_t tensor(-1.5698, dtype=torch.float64)
19 gae_duplicate tensor(-1.5698, dtype=torch.float64) tensor(3.2618, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8423, dtype=torch.float64) delta_t tensor(1.2989, dtype=torch.float64)
18 gae_duplicate tensor(0.0431, dtype=torch.float64) tensor(-0.0896, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8429, dtype=torch.float64) delta_t tensor(0.5484, dtype=torch.float64)
17 gae_duplicate tensor(0.5829, dtype=torch.float64) tensor(-1.2113, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8435, dtype=torch.float64) delta_t tensor(0.5490, dtype=torch.float64)
16 gae_duplicate tensor(1.0153, dtype=torch.float64) tensor(-2.1098, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8441, dtype=torch.float64) delta_t tensor(0.5496, dtype=torch.float64)
15 gae_duplicate tensor(1.3619, dtype=torch.float64) tensor(-2.8298, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8447, dtype=torch.float64) delta_t tensor(0.5502, dtype=torch.float64)
14 gae_duplicate tensor(1.6397, dtype=torch.float64) tensor(-3.4071, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8453, dtype=torch.float64) delta_t tensor(-0.4483, dtype=torch.float64)
13 gae_duplicate tensor(0.8635, dtype=torch.float64) tensor(-1.7916, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8459, dtype=torch.float64) delta_t tensor(0.3347, dtype=torch.float64)
12 gae_duplicate tensor(1.0255, dtype=torch.float64) tensor(-2.1309, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8465, dtype=torch.float64) delta_t tensor(1.8525, dtype=torch.float64)
11 gae_duplicate tensor(2.6729, dtype=torch.float64) tensor(-5.5622, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2248, dtype=torch.float64) delta_t tensor(-0.8018, dtype=torch.float64)
10 gae_duplicate tensor(1.3366, dtype=torch.float64) tensor(-2.7814, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0552, dtype=torch.float64) delta_t tensor(-0.5069, dtype=torch.float64)
9 gae_duplicate tensor(0.5624, dtype=torch.float64) tensor(-1.1703, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4535, dtype=torch.float64) delta_t tensor(-0.3026, dtype=torch.float64)
8 gae_duplicate tensor(0.1473, dtype=torch.float64) tensor(-0.3071, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6232, dtype=torch.float64) delta_t tensor(0.0234, dtype=torch.float64)
7 gae_duplicate tensor(0.1413, dtype=torch.float64) tensor(-0.2931, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1885, dtype=torch.float64) delta_t tensor(-0.8067, dtype=torch.float64)
6 gae_duplicate tensor(-0.6937, dtype=torch.float64) tensor(1.4436, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5853, dtype=torch.float64) delta_t tensor(-1.1114, dtype=torch.float64)
5 gae_duplicate tensor(-1.6663, dtype=torch.float64) tensor(3.4574, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7395, dtype=torch.float64) delta_t tensor(-1.1883, dtype=torch.float64)
4 gae_duplicate tensor(-2.5213, dtype=torch.float64) tensor(5.2314, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1080, dtype=torch.float64) delta_t tensor(0.5712, dtype=torch.float64)
3 gae_duplicate tensor(-1.4459, dtype=torch.float64) tensor(3.0088, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1916, dtype=torch.float64) delta_t tensor(-1.6757, dtype=torch.float64)
2 gae_duplicate tensor(-2.8324, dtype=torch.float64) tensor(5.8855, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:7.25108528137207
value loss:58.790809631347656
entropies:37.42987823486328
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.246064186096191 seconds
19 rew tensor(0.7692, dtype=torch.float64) delta_t tensor(-1.7620, dtype=torch.float64)
19 gae_duplicate tensor(-1.7620, dtype=torch.float64) tensor(3.6612, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7697, dtype=torch.float64) delta_t tensor(0.2640, dtype=torch.float64)
18 gae_duplicate tensor(-1.1456, dtype=torch.float64) tensor(2.3839, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7153, dtype=torch.float64) delta_t tensor(0.2138, dtype=torch.float64)
17 gae_duplicate tensor(-0.7026, dtype=torch.float64) tensor(1.4600, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4964, dtype=torch.float64) delta_t tensor(0.0580, dtype=torch.float64)
16 gae_duplicate tensor(-0.5040, dtype=torch.float64) tensor(1.0474, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2224, dtype=torch.float64) delta_t tensor(0.0214, dtype=torch.float64)
15 gae_duplicate tensor(-0.3819, dtype=torch.float64) tensor(0.7923, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.2708, dtype=torch.float64) delta_t tensor(-0.2885, dtype=torch.float64)
14 gae_duplicate tensor(-0.5940, dtype=torch.float64) tensor(1.2343, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8250, dtype=torch.float64) delta_t tensor(0.4745, dtype=torch.float64)
13 gae_duplicate tensor(-0.0007, dtype=torch.float64) tensor(0.0015, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8255, dtype=torch.float64) delta_t tensor(0.4751, dtype=torch.float64)
12 gae_duplicate tensor(0.4745, dtype=torch.float64) tensor(-0.9859, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8261, dtype=torch.float64) delta_t tensor(0.4414, dtype=torch.float64)
11 gae_duplicate tensor(0.8210, dtype=torch.float64) tensor(-1.7035, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6623, dtype=torch.float64) delta_t tensor(0.4358, dtype=torch.float64)
10 gae_duplicate tensor(1.0926, dtype=torch.float64) tensor(-2.2703, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6921, dtype=torch.float64) delta_t tensor(-2.6372, dtype=torch.float64)
9 gae_duplicate tensor(-1.7632, dtype=torch.float64) tensor(3.6637, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.9004, dtype=torch.float64) delta_t tensor(-3.1326, dtype=torch.float64)
8 gae_duplicate tensor(-4.5431, dtype=torch.float64) tensor(9.4260, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3866, dtype=torch.float64) delta_t tensor(-0.1570, dtype=torch.float64)
7 gae_duplicate tensor(-3.7915, dtype=torch.float64) tensor(7.8901, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.9761, dtype=torch.float64) delta_t tensor(-2.2917, dtype=torch.float64)
6 gae_duplicate tensor(-5.3249, dtype=torch.float64) tensor(11.0976, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.3102, dtype=torch.float64) delta_t tensor(-0.8791, dtype=torch.float64)
5 gae_duplicate tensor(-5.1389, dtype=torch.float64) tensor(10.6941, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-8.3237, dtype=torch.float64) delta_t tensor(-8.8843, dtype=torch.float64)
4 gae_duplicate tensor(-12.9955, dtype=torch.float64) tensor(27.0436, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2752, dtype=torch.float64) delta_t tensor(0.4974, dtype=torch.float64)
3 gae_duplicate tensor(-9.8990, dtype=torch.float64) tensor(20.5689, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2186, dtype=torch.float64) delta_t tensor(-0.5182, dtype=torch.float64)
2 gae_duplicate tensor(-8.4374, dtype=torch.float64) tensor(17.5581, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-682.5003662109375
value loss:658.0570068359375
entropies:37.42987823486328
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.648390054702759 seconds
19 rew tensor(0.8253, dtype=torch.float64) delta_t tensor(-0.7446, dtype=torch.float64)
19 gae_duplicate tensor(-0.7446, dtype=torch.float64) tensor(1.5495, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8258, dtype=torch.float64) delta_t tensor(0.2852, dtype=torch.float64)
18 gae_duplicate tensor(-0.3104, dtype=torch.float64) tensor(0.6460, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8264, dtype=torch.float64) delta_t tensor(-0.0527, dtype=torch.float64)
17 gae_duplicate tensor(-0.3010, dtype=torch.float64) tensor(0.6255, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8269, dtype=torch.float64) delta_t tensor(0.3512, dtype=torch.float64)
16 gae_duplicate tensor(0.1104, dtype=torch.float64) tensor(-0.2294, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8275, dtype=torch.float64) delta_t tensor(0.4741, dtype=torch.float64)
15 gae_duplicate tensor(0.5625, dtype=torch.float64) tensor(-1.1687, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8280, dtype=torch.float64) delta_t tensor(0.8637, dtype=torch.float64)
14 gae_duplicate tensor(1.3137, dtype=torch.float64) tensor(-2.7338, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8286, dtype=torch.float64) delta_t tensor(0.5189, dtype=torch.float64)
13 gae_duplicate tensor(1.5698, dtype=torch.float64) tensor(-3.2718, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8292, dtype=torch.float64) delta_t tensor(0.7093, dtype=torch.float64)
12 gae_duplicate tensor(1.9652, dtype=torch.float64) tensor(-4.0834, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5544, dtype=torch.float64) delta_t tensor(0.1716, dtype=torch.float64)
11 gae_duplicate tensor(1.7438, dtype=torch.float64) tensor(-3.6179, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3895, dtype=torch.float64) delta_t tensor(1.7230, dtype=torch.float64)
10 gae_duplicate tensor(3.1180, dtype=torch.float64) tensor(-6.4985, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2246, dtype=torch.float64) delta_t tensor(-1.0395, dtype=torch.float64)
9 gae_duplicate tensor(1.4549, dtype=torch.float64) tensor(-3.0230, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3805, dtype=torch.float64) delta_t tensor(-1.0071, dtype=torch.float64)
8 gae_duplicate tensor(0.1568, dtype=torch.float64) tensor(-0.3263, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3256, dtype=torch.float64) delta_t tensor(1.0833, dtype=torch.float64)
7 gae_duplicate tensor(1.2087, dtype=torch.float64) tensor(-2.5154, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1059, dtype=torch.float64) delta_t tensor(-0.6425, dtype=torch.float64)
6 gae_duplicate tensor(0.3245, dtype=torch.float64) tensor(-0.6732, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4357, dtype=torch.float64) delta_t tensor(0.2429, dtype=torch.float64)
5 gae_duplicate tensor(0.5025, dtype=torch.float64) tensor(-1.0456, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5457, dtype=torch.float64) delta_t tensor(-1.0907, dtype=torch.float64)
4 gae_duplicate tensor(-0.6887, dtype=torch.float64) tensor(1.4333, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1501, dtype=torch.float64) delta_t tensor(-0.2899, dtype=torch.float64)
3 gae_duplicate tensor(-0.8408, dtype=torch.float64) tensor(1.7525, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6569, dtype=torch.float64) delta_t tensor(-1.7369, dtype=torch.float64)
2 gae_duplicate tensor(-2.4096, dtype=torch.float64) tensor(4.9991, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:107.96256256103516
value loss:49.24798583984375
entropies:37.429874420166016
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.41999626159668 seconds
19 rew tensor(0.8253, dtype=torch.float64) delta_t tensor(-0.6265, dtype=torch.float64)
19 gae_duplicate tensor(-0.6265, dtype=torch.float64) tensor(1.3017, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8258, dtype=torch.float64) delta_t tensor(0.5354, dtype=torch.float64)
18 gae_duplicate tensor(0.0343, dtype=torch.float64) tensor(-0.0712, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8263, dtype=torch.float64) delta_t tensor(0.5360, dtype=torch.float64)
17 gae_duplicate tensor(0.5634, dtype=torch.float64) tensor(-1.1707, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8269, dtype=torch.float64) delta_t tensor(0.6027, dtype=torch.float64)
16 gae_duplicate tensor(1.0534, dtype=torch.float64) tensor(-2.1922, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8274, dtype=torch.float64) delta_t tensor(-0.0745, dtype=torch.float64)
15 gae_duplicate tensor(0.7682, dtype=torch.float64) tensor(-1.6012, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8280, dtype=torch.float64) delta_t tensor(0.3277, dtype=torch.float64)
14 gae_duplicate tensor(0.9423, dtype=torch.float64) tensor(-1.9579, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8285, dtype=torch.float64) delta_t tensor(0.6604, dtype=torch.float64)
13 gae_duplicate tensor(1.4142, dtype=torch.float64) tensor(-2.9385, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8291, dtype=torch.float64) delta_t tensor(0.7722, dtype=torch.float64)
12 gae_duplicate tensor(1.9036, dtype=torch.float64) tensor(-3.9675, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6089, dtype=torch.float64) delta_t tensor(0.3851, dtype=torch.float64)
11 gae_duplicate tensor(1.9080, dtype=torch.float64) tensor(-3.9646, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6093, dtype=torch.float64) delta_t tensor(1.1633, dtype=torch.float64)
10 gae_duplicate tensor(2.6897, dtype=torch.float64) tensor(-5.5886, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4993, dtype=torch.float64) delta_t tensor(0.4395, dtype=torch.float64)
9 gae_duplicate tensor(2.5912, dtype=torch.float64) tensor(-5.3842, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3342, dtype=torch.float64) delta_t tensor(0.8281, dtype=torch.float64)
8 gae_duplicate tensor(2.9011, dtype=torch.float64) tensor(-6.0282, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2241, dtype=torch.float64) delta_t tensor(-0.6891, dtype=torch.float64)
7 gae_duplicate tensor(1.6318, dtype=torch.float64) tensor(-3.3959, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8225, dtype=torch.float64) delta_t tensor(-1.0568, dtype=torch.float64)
6 gae_duplicate tensor(0.2486, dtype=torch.float64) tensor(-0.5166, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0985, dtype=torch.float64) delta_t tensor(0.1812, dtype=torch.float64)
5 gae_duplicate tensor(0.3801, dtype=torch.float64) tensor(-0.7922, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7054, dtype=torch.float64) delta_t tensor(-1.4609, dtype=torch.float64)
4 gae_duplicate tensor(-1.1569, dtype=torch.float64) tensor(2.4075, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4875, dtype=torch.float64) delta_t tensor(-1.2478, dtype=torch.float64)
3 gae_duplicate tensor(-2.1733, dtype=torch.float64) tensor(4.5088, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2136, dtype=torch.float64) delta_t tensor(-1.9020, dtype=torch.float64)
2 gae_duplicate tensor(-3.6407, dtype=torch.float64) tensor(7.5648, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:141.59698486328125
value loss:85.67037963867188
entropies:37.429874420166016
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.468526124954224 seconds
19 rew tensor(0.8256, dtype=torch.float64) delta_t tensor(-1.2813, dtype=torch.float64)
19 gae_duplicate tensor(-1.2813, dtype=torch.float64) tensor(2.6664, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8261, dtype=torch.float64) delta_t tensor(1.2243, dtype=torch.float64)
18 gae_duplicate tensor(0.1993, dtype=torch.float64) tensor(-0.4135, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8266, dtype=torch.float64) delta_t tensor(0.5673, dtype=torch.float64)
17 gae_duplicate tensor(0.7268, dtype=torch.float64) tensor(-1.5078, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8272, dtype=torch.float64) delta_t tensor(0.5823, dtype=torch.float64)
16 gae_duplicate tensor(1.1637, dtype=torch.float64) tensor(-2.4218, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8277, dtype=torch.float64) delta_t tensor(0.6931, dtype=torch.float64)
15 gae_duplicate tensor(1.6241, dtype=torch.float64) tensor(-3.3746, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8282, dtype=torch.float64) delta_t tensor(0.5971, dtype=torch.float64)
14 gae_duplicate tensor(1.8964, dtype=torch.float64) tensor(-3.9465, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8288, dtype=torch.float64) delta_t tensor(1.0995, dtype=torch.float64)
13 gae_duplicate tensor(2.6166, dtype=torch.float64) tensor(-5.4283, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6078, dtype=torch.float64) delta_t tensor(-0.1984, dtype=torch.float64)
12 gae_duplicate tensor(1.8948, dtype=torch.float64) tensor(-3.9371, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4973, dtype=torch.float64) delta_t tensor(0.1749, dtype=torch.float64)
11 gae_duplicate tensor(1.6908, dtype=torch.float64) tensor(-3.5186, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2761, dtype=torch.float64) delta_t tensor(-0.2283, dtype=torch.float64)
10 gae_duplicate tensor(1.1243, dtype=torch.float64) tensor(-2.3434, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0549, dtype=torch.float64) delta_t tensor(-0.4607, dtype=torch.float64)
9 gae_duplicate tensor(0.4387, dtype=torch.float64) tensor(-0.9130, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6642, dtype=torch.float64) delta_t tensor(-1.1444, dtype=torch.float64)
8 gae_duplicate tensor(-0.7934, dtype=torch.float64) tensor(1.6538, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0562, dtype=torch.float64) delta_t tensor(1.1180, dtype=torch.float64)
7 gae_duplicate tensor(0.4833, dtype=torch.float64) tensor(-1.0026, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6072, dtype=torch.float64) delta_t tensor(0.4769, dtype=torch.float64)
6 gae_duplicate tensor(0.8635, dtype=torch.float64) tensor(-1.7942, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2164, dtype=torch.float64) delta_t tensor(-0.7255, dtype=torch.float64)
5 gae_duplicate tensor(-0.0347, dtype=torch.float64) tensor(0.0722, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3303, dtype=torch.float64) delta_t tensor(0.0441, dtype=torch.float64)
4 gae_duplicate tensor(0.0163, dtype=torch.float64) tensor(-0.0339, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1616, dtype=torch.float64) delta_t tensor(-0.6942, dtype=torch.float64)
3 gae_duplicate tensor(-0.6811, dtype=torch.float64) tensor(1.4175, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9969, dtype=torch.float64) delta_t tensor(-1.5110, dtype=torch.float64)
2 gae_duplicate tensor(-2.0559, dtype=torch.float64) tensor(4.2783, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:122.16046905517578
value loss:46.27619171142578
entropies:37.429874420166016
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.6622)
ToM Target loss= tensor(300.8654)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.634026050567627 seconds
19 rew tensor(0.7705, dtype=torch.float64) delta_t tensor(-1.5666, dtype=torch.float64)
19 gae_duplicate tensor(-1.5666, dtype=torch.float64) tensor(3.2655, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7710, dtype=torch.float64) delta_t tensor(0.3010, dtype=torch.float64)
18 gae_duplicate tensor(-0.9523, dtype=torch.float64) tensor(1.9818, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7164, dtype=torch.float64) delta_t tensor(0.2372, dtype=torch.float64)
17 gae_duplicate tensor(-0.5247, dtype=torch.float64) tensor(1.0936, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5518, dtype=torch.float64) delta_t tensor(0.0306, dtype=torch.float64)
16 gae_duplicate tensor(-0.3891, dtype=torch.float64) tensor(0.8098, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2770, dtype=torch.float64) delta_t tensor(0.1675, dtype=torch.float64)
15 gae_duplicate tensor(-0.1438, dtype=torch.float64) tensor(0.2993, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.1627, dtype=torch.float64) delta_t tensor(-0.3730, dtype=torch.float64)
14 gae_duplicate tensor(-0.4880, dtype=torch.float64) tensor(1.0172, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3868, dtype=torch.float64) delta_t tensor(0.4755, dtype=torch.float64)
13 gae_duplicate tensor(0.0851, dtype=torch.float64) tensor(-0.1765, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8266, dtype=torch.float64) delta_t tensor(0.5524, dtype=torch.float64)
12 gae_duplicate tensor(0.6205, dtype=torch.float64) tensor(-1.2872, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6623, dtype=torch.float64) delta_t tensor(0.5689, dtype=torch.float64)
11 gae_duplicate tensor(1.0653, dtype=torch.float64) tensor(-2.2170, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6077, dtype=torch.float64) delta_t tensor(0.3921, dtype=torch.float64)
10 gae_duplicate tensor(1.2444, dtype=torch.float64) tensor(-2.5937, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6001, dtype=torch.float64) delta_t tensor(-1.5260, dtype=torch.float64)
9 gae_duplicate tensor(-0.5305, dtype=torch.float64) tensor(1.1023, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3878, dtype=torch.float64) delta_t tensor(-0.3219, dtype=torch.float64)
8 gae_duplicate tensor(-0.7463, dtype=torch.float64) tensor(1.5481, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.8073, dtype=torch.float64) delta_t tensor(-2.2087, dtype=torch.float64)
7 gae_duplicate tensor(-2.8057, dtype=torch.float64) tensor(5.8297, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.9089, dtype=torch.float64) delta_t tensor(-2.5347, dtype=torch.float64)
6 gae_duplicate tensor(-4.7793, dtype=torch.float64) tensor(9.9147, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-3.5255, dtype=torch.float64) delta_t tensor(-3.1466, dtype=torch.float64)
5 gae_duplicate tensor(-6.9700, dtype=torch.float64) tensor(14.4824, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0458, dtype=torch.float64) delta_t tensor(-2.2321, dtype=torch.float64)
4 gae_duplicate tensor(-7.8081, dtype=torch.float64) tensor(16.2495, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3379, dtype=torch.float64) delta_t tensor(-0.0743, dtype=torch.float64)
3 gae_duplicate tensor(-6.3208, dtype=torch.float64) tensor(13.1332, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3380, dtype=torch.float64) delta_t tensor(-0.1771, dtype=torch.float64)
2 gae_duplicate tensor(-5.2338, dtype=torch.float64) tensor(10.8574, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-452.9831237792969
value loss:323.34967041015625
entropies:37.429874420166016
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.200177907943726 seconds
19 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(-1.3958, dtype=torch.float64)
19 gae_duplicate tensor(-1.3958, dtype=torch.float64) tensor(2.9002, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(0.3659, dtype=torch.float64)
18 gae_duplicate tensor(-0.7507, dtype=torch.float64) tensor(1.5648, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.3575, dtype=torch.float64)
17 gae_duplicate tensor(-0.2431, dtype=torch.float64) tensor(0.5051, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.1239, dtype=torch.float64)
16 gae_duplicate tensor(-0.0706, dtype=torch.float64) tensor(0.1465, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.6151, dtype=torch.float64)
15 gae_duplicate tensor(0.5586, dtype=torch.float64) tensor(-1.1589, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.5760, dtype=torch.float64)
14 gae_duplicate tensor(1.0229, dtype=torch.float64) tensor(-2.1254, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(0.7280, dtype=torch.float64)
13 gae_duplicate tensor(1.5463, dtype=torch.float64) tensor(-3.2180, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.4817, dtype=torch.float64)
12 gae_duplicate tensor(1.7188, dtype=torch.float64) tensor(-3.5713, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(0.4822, dtype=torch.float64)
11 gae_duplicate tensor(1.8572, dtype=torch.float64) tensor(-3.8712, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8173, dtype=torch.float64) delta_t tensor(1.3417, dtype=torch.float64)
10 gae_duplicate tensor(2.8275, dtype=torch.float64) tensor(-5.8844, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8179, dtype=torch.float64) delta_t tensor(0.0916, dtype=torch.float64)
9 gae_duplicate tensor(2.3537, dtype=torch.float64) tensor(-4.8982, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.5409, dtype=torch.float64) delta_t tensor(-2.1642, dtype=torch.float64)
8 gae_duplicate tensor(-0.2812, dtype=torch.float64) tensor(0.5853, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7038, dtype=torch.float64) delta_t tensor(-2.0173, dtype=torch.float64)
7 gae_duplicate tensor(-2.2423, dtype=torch.float64) tensor(4.6663, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-3.1021, dtype=torch.float64) delta_t tensor(-2.6770, dtype=torch.float64)
6 gae_duplicate tensor(-4.4709, dtype=torch.float64) tensor(9.3042, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9297, dtype=torch.float64) delta_t tensor(-1.8175, dtype=torch.float64)
5 gae_duplicate tensor(-5.3942, dtype=torch.float64) tensor(11.2082, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-7.4865, dtype=torch.float64) delta_t tensor(-6.4310, dtype=torch.float64)
4 gae_duplicate tensor(-10.7463, dtype=torch.float64) tensor(22.3642, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7688, dtype=torch.float64) delta_t tensor(-0.3618, dtype=torch.float64)
3 gae_duplicate tensor(-8.9589, dtype=torch.float64) tensor(18.6440, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7692, dtype=torch.float64) delta_t tensor(-0.4879, dtype=torch.float64)
2 gae_duplicate tensor(-7.6550, dtype=torch.float64) tensor(15.9055, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-379.5254211425781
value loss:502.1999816894531
entropies:37.429874420166016
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.6038336753845215 seconds
19 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(-1.2668, dtype=torch.float64)
19 gae_duplicate tensor(-1.2668, dtype=torch.float64) tensor(2.6404, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.4170, dtype=torch.float64)
18 gae_duplicate tensor(-0.5965, dtype=torch.float64) tensor(1.2374, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.4338, dtype=torch.float64)
17 gae_duplicate tensor(-0.0433, dtype=torch.float64) tensor(0.0902, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.0777, dtype=torch.float64)
16 gae_duplicate tensor(0.0431, dtype=torch.float64) tensor(-0.0897, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.8333, dtype=torch.float64)
15 gae_duplicate tensor(0.8677, dtype=torch.float64) tensor(-1.8058, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.5812, dtype=torch.float64)
14 gae_duplicate tensor(1.2754, dtype=torch.float64) tensor(-2.6500, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(0.8110, dtype=torch.float64)
13 gae_duplicate tensor(1.8313, dtype=torch.float64) tensor(-3.8111, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5480, dtype=torch.float64) delta_t tensor(0.1094, dtype=torch.float64)
12 gae_duplicate tensor(1.5745, dtype=torch.float64) tensor(-3.2664, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4945, dtype=torch.float64) delta_t tensor(0.4080, dtype=torch.float64)
11 gae_duplicate tensor(1.6675, dtype=torch.float64) tensor(-3.4703, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3333, dtype=torch.float64) delta_t tensor(1.4717, dtype=torch.float64)
10 gae_duplicate tensor(2.8057, dtype=torch.float64) tensor(-5.8205, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.7099, dtype=torch.float64) delta_t tensor(0.8241, dtype=torch.float64)
9 gae_duplicate tensor(3.0686, dtype=torch.float64) tensor(-6.3863, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0425, dtype=torch.float64) delta_t tensor(-0.1990, dtype=torch.float64)
8 gae_duplicate tensor(2.2559, dtype=torch.float64) tensor(-4.6947, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1187, dtype=torch.float64) delta_t tensor(-0.4787, dtype=torch.float64)
7 gae_duplicate tensor(1.3260, dtype=torch.float64) tensor(-2.7594, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4185, dtype=torch.float64) delta_t tensor(-0.2650, dtype=torch.float64)
6 gae_duplicate tensor(0.7958, dtype=torch.float64) tensor(-1.6586, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8484, dtype=torch.float64) delta_t tensor(0.1677, dtype=torch.float64)
5 gae_duplicate tensor(0.8043, dtype=torch.float64) tensor(-1.6738, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5472, dtype=torch.float64) delta_t tensor(-1.1620, dtype=torch.float64)
4 gae_duplicate tensor(-0.5186, dtype=torch.float64) tensor(1.0775, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7968, dtype=torch.float64) delta_t tensor(-1.2852, dtype=torch.float64)
3 gae_duplicate tensor(-1.7001, dtype=torch.float64) tensor(3.5379, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9048, dtype=torch.float64) delta_t tensor(-0.6442, dtype=torch.float64)
2 gae_duplicate tensor(-2.0042, dtype=torch.float64) tensor(4.1646, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:150.9085235595703
value loss:68.32341003417969
entropies:37.429874420166016
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.445651054382324 seconds
19 rew tensor(0.8109, dtype=torch.float64) delta_t tensor(0.5805, dtype=torch.float64)
19 gae_duplicate tensor(0.5805, dtype=torch.float64) tensor(-1.2099, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8114, dtype=torch.float64) delta_t tensor(-1.0719, dtype=torch.float64)
18 gae_duplicate tensor(-0.6075, dtype=torch.float64) tensor(1.2623, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7053, dtype=torch.float64) delta_t tensor(0.6258, dtype=torch.float64)
17 gae_duplicate tensor(0.1397, dtype=torch.float64) tensor(-0.2903, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7590, dtype=torch.float64) delta_t tensor(0.4419, dtype=torch.float64)
16 gae_duplicate tensor(0.5537, dtype=torch.float64) tensor(-1.1540, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7061, dtype=torch.float64) delta_t tensor(0.4273, dtype=torch.float64)
15 gae_duplicate tensor(0.8703, dtype=torch.float64) tensor(-1.8111, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6000, dtype=torch.float64) delta_t tensor(0.2506, dtype=torch.float64)
14 gae_duplicate tensor(0.9468, dtype=torch.float64) tensor(-1.9734, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3874, dtype=torch.float64) delta_t tensor(0.0856, dtype=torch.float64)
13 gae_duplicate tensor(0.8430, dtype=torch.float64) tensor(-1.7516, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(0.4868, dtype=torch.float64)
12 gae_duplicate tensor(1.1612, dtype=torch.float64) tensor(-2.4090, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.4873, dtype=torch.float64)
11 gae_duplicate tensor(1.4163, dtype=torch.float64) tensor(-2.9475, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7611, dtype=torch.float64) delta_t tensor(0.9957, dtype=torch.float64)
10 gae_duplicate tensor(2.1287, dtype=torch.float64) tensor(-4.4231, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.5896, dtype=torch.float64) delta_t tensor(-3.0150, dtype=torch.float64)
9 gae_duplicate tensor(-1.3120, dtype=torch.float64) tensor(2.7260, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6375, dtype=torch.float64) delta_t tensor(-2.1276, dtype=torch.float64)
8 gae_duplicate tensor(-3.1772, dtype=torch.float64) tensor(6.6119, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-3.9865, dtype=torch.float64) delta_t tensor(-4.2975, dtype=torch.float64)
7 gae_duplicate tensor(-6.8392, dtype=torch.float64) tensor(14.2329, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0109, dtype=torch.float64) delta_t tensor(1.1131, dtype=torch.float64)
6 gae_duplicate tensor(-4.3582, dtype=torch.float64) tensor(9.0839, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-3.2057, dtype=torch.float64) delta_t tensor(-3.3582, dtype=torch.float64)
5 gae_duplicate tensor(-6.8448, dtype=torch.float64) tensor(14.1999, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9501, dtype=torch.float64) delta_t tensor(-2.4035, dtype=torch.float64)
4 gae_duplicate tensor(-7.8793, dtype=torch.float64) tensor(16.3974, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3172, dtype=torch.float64) delta_t tensor(0.9436, dtype=torch.float64)
3 gae_duplicate tensor(-5.3599, dtype=torch.float64) tensor(11.1368, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2634, dtype=torch.float64) delta_t tensor(-0.4043, dtype=torch.float64)
2 gae_duplicate tensor(-4.6922, dtype=torch.float64) tensor(9.7802, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-405.8919372558594
value loss:372.8203430175781
entropies:37.429874420166016
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.228794097900391 seconds
19 rew tensor(0.8122, dtype=torch.float64) delta_t tensor(-1.0377, dtype=torch.float64)
19 gae_duplicate tensor(-1.0377, dtype=torch.float64) tensor(2.1596, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(0.4651, dtype=torch.float64)
18 gae_duplicate tensor(-0.3651, dtype=torch.float64) tensor(0.7610, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(0.7083, dtype=torch.float64)
17 gae_duplicate tensor(0.4163, dtype=torch.float64) tensor(-0.8635, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(0.2420, dtype=torch.float64)
16 gae_duplicate tensor(0.5750, dtype=torch.float64) tensor(-1.1965, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.6836, dtype=torch.float64)
15 gae_duplicate tensor(1.1436, dtype=torch.float64) tensor(-2.3799, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.9530, dtype=torch.float64)
14 gae_duplicate tensor(1.8678, dtype=torch.float64) tensor(-3.8871, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.2429, dtype=torch.float64)
13 gae_duplicate tensor(1.7371, dtype=torch.float64) tensor(-3.6037, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.4767, dtype=torch.float64)
12 gae_duplicate tensor(1.8664, dtype=torch.float64) tensor(-3.8903, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4957, dtype=torch.float64) delta_t tensor(2.4524, dtype=torch.float64)
11 gae_duplicate tensor(3.9455, dtype=torch.float64) tensor(-8.1981, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1223, dtype=torch.float64) delta_t tensor(-0.9349, dtype=torch.float64)
10 gae_duplicate tensor(2.2215, dtype=torch.float64) tensor(-4.6159, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1757, dtype=torch.float64) delta_t tensor(-0.3974, dtype=torch.float64)
9 gae_duplicate tensor(1.3798, dtype=torch.float64) tensor(-2.8714, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1976, dtype=torch.float64) delta_t tensor(-0.1948, dtype=torch.float64)
8 gae_duplicate tensor(0.9090, dtype=torch.float64) tensor(-1.8858, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1977, dtype=torch.float64) delta_t tensor(0.0119, dtype=torch.float64)
7 gae_duplicate tensor(0.7391, dtype=torch.float64) tensor(-1.5381, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3044, dtype=torch.float64) delta_t tensor(-0.3604, dtype=torch.float64)
6 gae_duplicate tensor(0.2309, dtype=torch.float64) tensor(-0.4798, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2104, dtype=torch.float64) delta_t tensor(-0.4683, dtype=torch.float64)
5 gae_duplicate tensor(-0.2836, dtype=torch.float64) tensor(0.5911, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5845, dtype=torch.float64) delta_t tensor(-1.1804, dtype=torch.float64)
4 gae_duplicate tensor(-1.4072, dtype=torch.float64) tensor(2.9285, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4667, dtype=torch.float64) delta_t tensor(-0.2565, dtype=torch.float64)
3 gae_duplicate tensor(-1.3822, dtype=torch.float64) tensor(2.8720, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2133, dtype=torch.float64) delta_t tensor(-1.0446, dtype=torch.float64)
2 gae_duplicate tensor(-2.1504, dtype=torch.float64) tensor(4.4824, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:128.5706787109375
value loss:68.15830993652344
entropies:37.429874420166016
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.3416)
ToM Target loss= tensor(300.9182)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.372259855270386 seconds
19 rew tensor(0.6524, dtype=torch.float64) delta_t tensor(-1.1577, dtype=torch.float64)
19 gae_duplicate tensor(-1.1577, dtype=torch.float64) tensor(2.4054, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5997, dtype=torch.float64) delta_t tensor(0.4912, dtype=torch.float64)
18 gae_duplicate tensor(-0.4350, dtype=torch.float64) tensor(0.9037, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4409, dtype=torch.float64) delta_t tensor(-0.0961, dtype=torch.float64)
17 gae_duplicate tensor(-0.4441, dtype=torch.float64) tensor(0.9242, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0700, dtype=torch.float64) delta_t tensor(0.0930, dtype=torch.float64)
16 gae_duplicate tensor(-0.2623, dtype=torch.float64) tensor(0.5449, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.6189, dtype=torch.float64) delta_t tensor(0.3144, dtype=torch.float64)
15 gae_duplicate tensor(0.1046, dtype=torch.float64) tensor(-0.2174, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8114, dtype=torch.float64) delta_t tensor(0.7736, dtype=torch.float64)
14 gae_duplicate tensor(0.8573, dtype=torch.float64) tensor(-1.7783, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(0.7740, dtype=torch.float64)
13 gae_duplicate tensor(1.4598, dtype=torch.float64) tensor(-3.0332, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8123, dtype=torch.float64) delta_t tensor(0.7745, dtype=torch.float64)
12 gae_duplicate tensor(1.9424, dtype=torch.float64) tensor(-4.0358, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(0.1614, dtype=torch.float64)
11 gae_duplicate tensor(1.7154, dtype=torch.float64) tensor(-3.5698, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6544, dtype=torch.float64) delta_t tensor(-0.1447, dtype=torch.float64)
10 gae_duplicate tensor(1.2276, dtype=torch.float64) tensor(-2.5506, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.6281, dtype=torch.float64) delta_t tensor(-3.0235, dtype=torch.float64)
9 gae_duplicate tensor(-2.0414, dtype=torch.float64) tensor(4.2552, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3889, dtype=torch.float64) delta_t tensor(0.3803, dtype=torch.float64)
8 gae_duplicate tensor(-1.2528, dtype=torch.float64) tensor(2.6073, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.8996, dtype=torch.float64) delta_t tensor(-3.2386, dtype=torch.float64)
7 gae_duplicate tensor(-4.2408, dtype=torch.float64) tensor(8.8398, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1438, dtype=torch.float64) delta_t tensor(1.2564, dtype=torch.float64)
6 gae_duplicate tensor(-2.1363, dtype=torch.float64) tensor(4.4530, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1110, dtype=torch.float64) delta_t tensor(-2.1280, dtype=torch.float64)
5 gae_duplicate tensor(-3.8370, dtype=torch.float64) tensor(7.9725, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9782, dtype=torch.float64) delta_t tensor(-3.4518, dtype=torch.float64)
4 gae_duplicate tensor(-6.5214, dtype=torch.float64) tensor(13.5719, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2562, dtype=torch.float64) delta_t tensor(0.5564, dtype=torch.float64)
3 gae_duplicate tensor(-4.6607, dtype=torch.float64) tensor(9.6839, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2563, dtype=torch.float64) delta_t tensor(-0.4214, dtype=torch.float64)
2 gae_duplicate tensor(-4.1500, dtype=torch.float64) tensor(8.6229, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-298.7203369140625
value loss:206.0643768310547
entropies:37.42987060546875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.192270040512085 seconds
19 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(0.9245, dtype=torch.float64)
19 gae_duplicate tensor(0.9245, dtype=torch.float64) tensor(-1.9209, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(-1.3260, dtype=torch.float64)
18 gae_duplicate tensor(-0.5864, dtype=torch.float64) tensor(1.2224, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.4757, dtype=torch.float64)
17 gae_duplicate tensor(0.0065, dtype=torch.float64) tensor(-0.0135, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.4186, dtype=torch.float64)
16 gae_duplicate tensor(0.4239, dtype=torch.float64) tensor(-0.8807, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.4699, dtype=torch.float64)
15 gae_duplicate tensor(0.8090, dtype=torch.float64) tensor(-1.6864, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.4593, dtype=torch.float64)
14 gae_duplicate tensor(1.1065, dtype=torch.float64) tensor(-2.3028, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(1.4230, dtype=torch.float64)
13 gae_duplicate tensor(2.3082, dtype=torch.float64) tensor(-4.8038, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1284, dtype=torch.float64) delta_t tensor(-0.6836, dtype=torch.float64)
12 gae_duplicate tensor(1.1630, dtype=torch.float64) tensor(-2.4204, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1813, dtype=torch.float64) delta_t tensor(0.0608, dtype=torch.float64)
11 gae_duplicate tensor(0.9913, dtype=torch.float64) tensor(-2.0629, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0756, dtype=torch.float64) delta_t tensor(0.7217, dtype=torch.float64)
10 gae_duplicate tensor(1.5147, dtype=torch.float64) tensor(-3.1471, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0757, dtype=torch.float64) delta_t tensor(-0.7989, dtype=torch.float64)
9 gae_duplicate tensor(0.4128, dtype=torch.float64) tensor(-0.8578, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1357, dtype=torch.float64) delta_t tensor(-0.7572, dtype=torch.float64)
8 gae_duplicate tensor(-0.4269, dtype=torch.float64) tensor(0.8885, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5054, dtype=torch.float64) delta_t tensor(0.4798, dtype=torch.float64)
7 gae_duplicate tensor(0.1383, dtype=torch.float64) tensor(-0.2868, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.9313, dtype=torch.float64) delta_t tensor(-1.3801, dtype=torch.float64)
6 gae_duplicate tensor(-1.2695, dtype=torch.float64) tensor(2.6420, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.5159, dtype=torch.float64) delta_t tensor(-1.0385, dtype=torch.float64)
5 gae_duplicate tensor(-2.0541, dtype=torch.float64) tensor(4.2680, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0519, dtype=torch.float64) delta_t tensor(-4.0053, dtype=torch.float64)
4 gae_duplicate tensor(-5.6486, dtype=torch.float64) tensor(11.7554, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5138, dtype=torch.float64) delta_t tensor(1.0375, dtype=torch.float64)
3 gae_duplicate tensor(-3.4814, dtype=torch.float64) tensor(7.2334, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4610, dtype=torch.float64) delta_t tensor(0.0412, dtype=torch.float64)
2 gae_duplicate tensor(-2.7440, dtype=torch.float64) tensor(5.7201, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-81.2022933959961
value loss:106.45999145507812
entropies:37.42987060546875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4150919914245605 seconds
19 rew tensor(-0.8800, dtype=torch.float64) delta_t tensor(-0.7281, dtype=torch.float64)
19 gae_duplicate tensor(-0.7281, dtype=torch.float64) tensor(1.5154, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(0.8434, dtype=torch.float64)
18 gae_duplicate tensor(0.2609, dtype=torch.float64) tensor(-0.5420, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.8438, dtype=torch.float64)
17 gae_duplicate tensor(1.0525, dtype=torch.float64) tensor(-2.1832, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.8443, dtype=torch.float64)
16 gae_duplicate tensor(1.6863, dtype=torch.float64) tensor(-3.5038, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7615, dtype=torch.float64) delta_t tensor(0.8261, dtype=torch.float64)
15 gae_duplicate tensor(2.1752, dtype=torch.float64) tensor(-4.5269, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7090, dtype=torch.float64) delta_t tensor(-0.6069, dtype=torch.float64)
14 gae_duplicate tensor(1.1333, dtype=torch.float64) tensor(-2.3626, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6036, dtype=torch.float64) delta_t tensor(0.3844, dtype=torch.float64)
13 gae_duplicate tensor(1.2910, dtype=torch.float64) tensor(-2.6869, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4981, dtype=torch.float64) delta_t tensor(0.1152, dtype=torch.float64)
12 gae_duplicate tensor(1.1481, dtype=torch.float64) tensor(-2.3894, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.5545, dtype=torch.float64)
11 gae_duplicate tensor(1.4729, dtype=torch.float64) tensor(-3.0707, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-3.4126, dtype=torch.float64) delta_t tensor(-3.6736, dtype=torch.float64)
10 gae_duplicate tensor(-2.4952, dtype=torch.float64) tensor(5.1931, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4116, dtype=torch.float64) delta_t tensor(-1.0779, dtype=torch.float64)
9 gae_duplicate tensor(-3.0741, dtype=torch.float64) tensor(6.3977, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3914, dtype=torch.float64) delta_t tensor(0.6951, dtype=torch.float64)
8 gae_duplicate tensor(-1.7641, dtype=torch.float64) tensor(3.6653, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1263, dtype=torch.float64) delta_t tensor(-0.3219, dtype=torch.float64)
7 gae_duplicate tensor(-1.7331, dtype=torch.float64) tensor(3.6070, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7753, dtype=torch.float64) delta_t tensor(0.1942, dtype=torch.float64)
6 gae_duplicate tensor(-1.1923, dtype=torch.float64) tensor(2.4772, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4439, dtype=torch.float64) delta_t tensor(0.7815, dtype=torch.float64)
5 gae_duplicate tensor(-0.1723, dtype=torch.float64) tensor(0.3586, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4041, dtype=torch.float64) delta_t tensor(0.9337, dtype=torch.float64)
4 gae_duplicate tensor(0.7959, dtype=torch.float64) tensor(-1.6536, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3377, dtype=torch.float64) delta_t tensor(-0.1846, dtype=torch.float64)
3 gae_duplicate tensor(0.4521, dtype=torch.float64) tensor(-0.9409, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6159, dtype=torch.float64) delta_t tensor(-0.1309, dtype=torch.float64)
2 gae_duplicate tensor(0.2308, dtype=torch.float64) tensor(-0.4811, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:5.636946678161621
value loss:59.78104019165039
entropies:37.429866790771484
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5146331787109375 seconds
19 rew tensor(0.7569, dtype=torch.float64) delta_t tensor(-0.7379, dtype=torch.float64)
19 gae_duplicate tensor(-0.7379, dtype=torch.float64) tensor(1.5384, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6526, dtype=torch.float64) delta_t tensor(0.3669, dtype=torch.float64)
18 gae_duplicate tensor(-0.2234, dtype=torch.float64) tensor(0.4649, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5483, dtype=torch.float64) delta_t tensor(0.2223, dtype=torch.float64)
17 gae_duplicate tensor(0.0436, dtype=torch.float64) tensor(-0.0909, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1823, dtype=torch.float64) delta_t tensor(0.4883, dtype=torch.float64)
16 gae_duplicate tensor(0.5232, dtype=torch.float64) tensor(-1.0871, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.3406, dtype=torch.float64) delta_t tensor(0.3225, dtype=torch.float64)
15 gae_duplicate tensor(0.7411, dtype=torch.float64) tensor(-1.5424, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8095, dtype=torch.float64) delta_t tensor(0.7977, dtype=torch.float64)
14 gae_duplicate tensor(1.3905, dtype=torch.float64) tensor(-2.8840, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8100, dtype=torch.float64) delta_t tensor(0.7475, dtype=torch.float64)
13 gae_duplicate tensor(1.8599, dtype=torch.float64) tensor(-3.8777, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7582, dtype=torch.float64) delta_t tensor(1.2362, dtype=torch.float64)
12 gae_duplicate tensor(2.7242, dtype=torch.float64) tensor(-5.6502, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8108, dtype=torch.float64) delta_t tensor(0.8889, dtype=torch.float64)
11 gae_duplicate tensor(3.0682, dtype=torch.float64) tensor(-6.3967, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6545, dtype=torch.float64) delta_t tensor(-0.9069, dtype=torch.float64)
10 gae_duplicate tensor(1.5477, dtype=torch.float64) tensor(-3.2267, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5919, dtype=torch.float64) delta_t tensor(-1.4195, dtype=torch.float64)
9 gae_duplicate tensor(-0.1814, dtype=torch.float64) tensor(0.3775, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6984, dtype=torch.float64) delta_t tensor(-1.6782, dtype=torch.float64)
8 gae_duplicate tensor(-1.8233, dtype=torch.float64) tensor(3.7881, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2872, dtype=torch.float64) delta_t tensor(0.0207, dtype=torch.float64)
7 gae_duplicate tensor(-1.4379, dtype=torch.float64) tensor(2.9979, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.0660, dtype=torch.float64) delta_t tensor(-1.8630, dtype=torch.float64)
6 gae_duplicate tensor(-3.0133, dtype=torch.float64) tensor(6.2497, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6509, dtype=torch.float64) delta_t tensor(-0.5937, dtype=torch.float64)
5 gae_duplicate tensor(-3.0043, dtype=torch.float64) tensor(6.2528, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.8960, dtype=torch.float64) delta_t tensor(-4.8105, dtype=torch.float64)
4 gae_duplicate tensor(-7.2139, dtype=torch.float64) tensor(14.9879, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1255, dtype=torch.float64) delta_t tensor(0.8665, dtype=torch.float64)
3 gae_duplicate tensor(-4.9046, dtype=torch.float64) tensor(10.1900, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0726, dtype=torch.float64) delta_t tensor(-0.3695, dtype=torch.float64)
2 gae_duplicate tensor(-4.2932, dtype=torch.float64) tensor(8.9197, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-187.1903533935547
value loss:216.15167236328125
entropies:37.429866790771484
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.388527870178223 seconds
19 rew tensor(0.8078, dtype=torch.float64) delta_t tensor(-0.2667, dtype=torch.float64)
19 gae_duplicate tensor(-0.2667, dtype=torch.float64) tensor(0.5552, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7563, dtype=torch.float64) delta_t tensor(0.8399, dtype=torch.float64)
18 gae_duplicate tensor(0.6265, dtype=torch.float64) tensor(-1.3016, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7567, dtype=torch.float64) delta_t tensor(0.7913, dtype=torch.float64)
17 gae_duplicate tensor(1.2925, dtype=torch.float64) tensor(-2.6806, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7051, dtype=torch.float64) delta_t tensor(0.0738, dtype=torch.float64)
16 gae_duplicate tensor(1.1079, dtype=torch.float64) tensor(-2.3057, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4975, dtype=torch.float64) delta_t tensor(0.3539, dtype=torch.float64)
15 gae_duplicate tensor(1.2402, dtype=torch.float64) tensor(-2.5812, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3418, dtype=torch.float64) delta_t tensor(-0.1058, dtype=torch.float64)
14 gae_duplicate tensor(0.8864, dtype=torch.float64) tensor(-1.8480, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4978, dtype=torch.float64) delta_t tensor(0.1982, dtype=torch.float64)
13 gae_duplicate tensor(0.9073, dtype=torch.float64) tensor(-1.8883, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8096, dtype=torch.float64) delta_t tensor(0.5556, dtype=torch.float64)
12 gae_duplicate tensor(1.2814, dtype=torch.float64) tensor(-2.6669, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6543, dtype=torch.float64) delta_t tensor(1.5197, dtype=torch.float64)
11 gae_duplicate tensor(2.5448, dtype=torch.float64) tensor(-5.2872, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4988, dtype=torch.float64) delta_t tensor(-0.2672, dtype=torch.float64)
10 gae_duplicate tensor(1.7687, dtype=torch.float64) tensor(-3.6811, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5773, dtype=torch.float64) delta_t tensor(-1.6612, dtype=torch.float64)
9 gae_duplicate tensor(-0.2462, dtype=torch.float64) tensor(0.5125, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3944, dtype=torch.float64) delta_t tensor(0.1840, dtype=torch.float64)
8 gae_duplicate tensor(-0.0130, dtype=torch.float64) tensor(0.0271, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.8380, dtype=torch.float64) delta_t tensor(-2.2473, dtype=torch.float64)
7 gae_duplicate tensor(-2.2578, dtype=torch.float64) tensor(4.6990, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9574, dtype=torch.float64) delta_t tensor(1.7132, dtype=torch.float64)
6 gae_duplicate tensor(-0.0930, dtype=torch.float64) tensor(0.1932, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8413, dtype=torch.float64) delta_t tensor(-1.4438, dtype=torch.float64)
5 gae_duplicate tensor(-1.5182, dtype=torch.float64) tensor(3.1543, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.9121, dtype=torch.float64) delta_t tensor(-4.7095, dtype=torch.float64)
4 gae_duplicate tensor(-5.9241, dtype=torch.float64) tensor(12.3294, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2372, dtype=torch.float64) delta_t tensor(0.7775, dtype=torch.float64)
3 gae_duplicate tensor(-3.9618, dtype=torch.float64) tensor(8.2456, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2896, dtype=torch.float64) delta_t tensor(-0.4828, dtype=torch.float64)
2 gae_duplicate tensor(-3.6522, dtype=torch.float64) tensor(7.5880, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-79.50386047363281
value loss:134.03297424316406
entropies:37.42986297607422
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.3741)
ToM Target loss= tensor(301.0818)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.432941198348999 seconds
19 rew tensor(0.8088, dtype=torch.float64) delta_t tensor(-0.4668, dtype=torch.float64)
19 gae_duplicate tensor(-0.4668, dtype=torch.float64) tensor(0.9716, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8093, dtype=torch.float64) delta_t tensor(0.5208, dtype=torch.float64)
18 gae_duplicate tensor(0.1473, dtype=torch.float64) tensor(-0.3066, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8097, dtype=torch.float64) delta_t tensor(0.2293, dtype=torch.float64)
17 gae_duplicate tensor(0.3471, dtype=torch.float64) tensor(-0.7212, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8102, dtype=torch.float64) delta_t tensor(1.3280, dtype=torch.float64)
16 gae_duplicate tensor(1.6057, dtype=torch.float64) tensor(-3.3302, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8106, dtype=torch.float64) delta_t tensor(1.0003, dtype=torch.float64)
15 gae_duplicate tensor(2.2849, dtype=torch.float64) tensor(-4.7471, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8110, dtype=torch.float64) delta_t tensor(0.5961, dtype=torch.float64)
14 gae_duplicate tensor(2.4240, dtype=torch.float64) tensor(-5.0362, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8115, dtype=torch.float64) delta_t tensor(0.7656, dtype=torch.float64)
13 gae_duplicate tensor(2.7048, dtype=torch.float64) tensor(-5.6194, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5514, dtype=torch.float64) delta_t tensor(1.0057, dtype=torch.float64)
12 gae_duplicate tensor(3.1696, dtype=torch.float64) tensor(-6.5849, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4475, dtype=torch.float64) delta_t tensor(1.8046, dtype=torch.float64)
11 gae_duplicate tensor(4.3403, dtype=torch.float64) tensor(-9.0016, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2394, dtype=torch.float64) delta_t tensor(-1.5041, dtype=torch.float64)
10 gae_duplicate tensor(1.9681, dtype=torch.float64) tensor(-4.0890, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0833, dtype=torch.float64) delta_t tensor(0.1204, dtype=torch.float64)
9 gae_duplicate tensor(1.6949, dtype=torch.float64) tensor(-3.5151, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0312, dtype=torch.float64) delta_t tensor(0.3795, dtype=torch.float64)
8 gae_duplicate tensor(1.7354, dtype=torch.float64) tensor(-3.6118, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1768, dtype=torch.float64) delta_t tensor(0.1039, dtype=torch.float64)
7 gae_duplicate tensor(1.4922, dtype=torch.float64) tensor(-3.1003, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9570, dtype=torch.float64) delta_t tensor(0.6473, dtype=torch.float64)
6 gae_duplicate tensor(1.8411, dtype=torch.float64) tensor(-3.8183, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3217, dtype=torch.float64) delta_t tensor(-1.1381, dtype=torch.float64)
5 gae_duplicate tensor(0.3348, dtype=torch.float64) tensor(-0.6956, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5830, dtype=torch.float64) delta_t tensor(-1.9867, dtype=torch.float64)
4 gae_duplicate tensor(-1.7189, dtype=torch.float64) tensor(3.5774, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3878, dtype=torch.float64) delta_t tensor(0.6000, dtype=torch.float64)
3 gae_duplicate tensor(-0.7752, dtype=torch.float64) tensor(1.6104, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2725, dtype=torch.float64) delta_t tensor(-1.0647, dtype=torch.float64)
2 gae_duplicate tensor(-1.6848, dtype=torch.float64) tensor(3.5127, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:265.9073181152344
value loss:108.1732177734375
entropies:37.42986297607422
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.695194959640503 seconds
19 rew tensor(0.8078, dtype=torch.float64) delta_t tensor(0.7699, dtype=torch.float64)
19 gae_duplicate tensor(0.7699, dtype=torch.float64) tensor(-1.5965, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7566, dtype=torch.float64) delta_t tensor(-0.3880, dtype=torch.float64)
18 gae_duplicate tensor(0.2279, dtype=torch.float64) tensor(-0.4744, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6535, dtype=torch.float64) delta_t tensor(0.0020, dtype=torch.float64)
17 gae_duplicate tensor(0.1843, dtype=torch.float64) tensor(-0.3822, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6021, dtype=torch.float64) delta_t tensor(0.8476, dtype=torch.float64)
16 gae_duplicate tensor(0.9950, dtype=torch.float64) tensor(-2.0634, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4473, dtype=torch.float64) delta_t tensor(0.3961, dtype=torch.float64)
15 gae_duplicate tensor(1.1921, dtype=torch.float64) tensor(-2.4813, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0857, dtype=torch.float64) delta_t tensor(-0.4004, dtype=torch.float64)
14 gae_duplicate tensor(0.5533, dtype=torch.float64) tensor(-1.1516, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8090, dtype=torch.float64) delta_t tensor(0.5721, dtype=torch.float64)
13 gae_duplicate tensor(1.0147, dtype=torch.float64) tensor(-2.1120, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8095, dtype=torch.float64) delta_t tensor(0.5725, dtype=torch.float64)
12 gae_duplicate tensor(1.3843, dtype=torch.float64) tensor(-2.8811, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8099, dtype=torch.float64) delta_t tensor(0.5692, dtype=torch.float64)
11 gae_duplicate tensor(1.6766, dtype=torch.float64) tensor(-3.4831, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6038, dtype=torch.float64) delta_t tensor(0.3717, dtype=torch.float64)
10 gae_duplicate tensor(1.7129, dtype=torch.float64) tensor(-3.5652, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6162, dtype=torch.float64) delta_t tensor(-2.1242, dtype=torch.float64)
9 gae_duplicate tensor(-0.7539, dtype=torch.float64) tensor(1.5633, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6697, dtype=torch.float64) delta_t tensor(-1.0580, dtype=torch.float64)
8 gae_duplicate tensor(-1.6611, dtype=torch.float64) tensor(3.4509, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8448, dtype=torch.float64) delta_t tensor(-1.1984, dtype=torch.float64)
7 gae_duplicate tensor(-2.5273, dtype=torch.float64) tensor(5.2602, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.2407, dtype=torch.float64) delta_t tensor(-2.0858, dtype=torch.float64)
6 gae_duplicate tensor(-4.1077, dtype=torch.float64) tensor(8.5496, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7276, dtype=torch.float64) delta_t tensor(1.2243, dtype=torch.float64)
5 gae_duplicate tensor(-2.0619, dtype=torch.float64) tensor(4.2914, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.9925, dtype=torch.float64) delta_t tensor(-6.0496, dtype=torch.float64)
4 gae_duplicate tensor(-7.6991, dtype=torch.float64) tensor(15.9954, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3898, dtype=torch.float64) delta_t tensor(-0.1886, dtype=torch.float64)
3 gae_duplicate tensor(-6.3479, dtype=torch.float64) tensor(13.1879, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4943, dtype=torch.float64) delta_t tensor(1.3217, dtype=torch.float64)
2 gae_duplicate tensor(-3.7566, dtype=torch.float64) tensor(7.8044, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-240.5966339111328
value loss:234.91558837890625
entropies:37.42985153198242
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.305773735046387 seconds
19 rew tensor(0.8079, dtype=torch.float64) delta_t tensor(1.4783, dtype=torch.float64)
19 gae_duplicate tensor(1.4783, dtype=torch.float64) tensor(-3.0711, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8083, dtype=torch.float64) delta_t tensor(-1.4205, dtype=torch.float64)
18 gae_duplicate tensor(-0.2378, dtype=torch.float64) tensor(0.4941, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8088, dtype=torch.float64) delta_t tensor(0.6147, dtype=torch.float64)
17 gae_duplicate tensor(0.4244, dtype=torch.float64) tensor(-0.8833, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8092, dtype=torch.float64) delta_t tensor(0.5140, dtype=torch.float64)
16 gae_duplicate tensor(0.8535, dtype=torch.float64) tensor(-1.7766, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8096, dtype=torch.float64) delta_t tensor(0.6395, dtype=torch.float64)
15 gae_duplicate tensor(1.3223, dtype=torch.float64) tensor(-2.7523, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8101, dtype=torch.float64) delta_t tensor(1.0696, dtype=torch.float64)
14 gae_duplicate tensor(2.1274, dtype=torch.float64) tensor(-4.4280, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8105, dtype=torch.float64) delta_t tensor(0.5191, dtype=torch.float64)
13 gae_duplicate tensor(2.2211, dtype=torch.float64) tensor(-4.6317, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8109, dtype=torch.float64) delta_t tensor(0.2111, dtype=torch.float64)
12 gae_duplicate tensor(1.9880, dtype=torch.float64) tensor(-4.1456, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8114, dtype=torch.float64) delta_t tensor(2.8306, dtype=torch.float64)
11 gae_duplicate tensor(4.4210, dtype=torch.float64) tensor(-9.1845, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(0.5249, dtype=torch.float64)
10 gae_duplicate tensor(4.0617, dtype=torch.float64) tensor(-8.4383, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6049, dtype=torch.float64) delta_t tensor(0.7568, dtype=torch.float64)
9 gae_duplicate tensor(4.0062, dtype=torch.float64) tensor(-8.3385, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1721, dtype=torch.float64) delta_t tensor(0.5634, dtype=torch.float64)
8 gae_duplicate tensor(3.7684, dtype=torch.float64) tensor(-7.8287, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2239, dtype=torch.float64) delta_t tensor(-0.9771, dtype=torch.float64)
7 gae_duplicate tensor(2.0375, dtype=torch.float64) tensor(-4.2330, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3276, dtype=torch.float64) delta_t tensor(1.1476, dtype=torch.float64)
6 gae_duplicate tensor(2.7776, dtype=torch.float64) tensor(-5.7705, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5865, dtype=torch.float64) delta_t tensor(-0.0013, dtype=torch.float64)
5 gae_duplicate tensor(2.2208, dtype=torch.float64) tensor(-4.6223, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2597, dtype=torch.float64) delta_t tensor(-0.5444, dtype=torch.float64)
4 gae_duplicate tensor(1.2322, dtype=torch.float64) tensor(-2.5649, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5877, dtype=torch.float64) delta_t tensor(0.0188, dtype=torch.float64)
3 gae_duplicate tensor(1.0046, dtype=torch.float64) tensor(-2.0832, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6915, dtype=torch.float64) delta_t tensor(-1.0109, dtype=torch.float64)
2 gae_duplicate tensor(-0.2072, dtype=torch.float64) tensor(0.4296, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:441.8492431640625
value loss:155.96014404296875
entropies:37.42984390258789
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4509477615356445 seconds
19 rew tensor(0.8095, dtype=torch.float64) delta_t tensor(-0.0255, dtype=torch.float64)
19 gae_duplicate tensor(-0.0255, dtype=torch.float64) tensor(0.0531, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8099, dtype=torch.float64) delta_t tensor(0.6416, dtype=torch.float64)
18 gae_duplicate tensor(0.6212, dtype=torch.float64) tensor(-1.2930, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8103, dtype=torch.float64) delta_t tensor(0.7269, dtype=torch.float64)
17 gae_duplicate tensor(1.2239, dtype=torch.float64) tensor(-2.5426, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8107, dtype=torch.float64) delta_t tensor(0.9507, dtype=torch.float64)
16 gae_duplicate tensor(1.9298, dtype=torch.float64) tensor(-4.0092, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8112, dtype=torch.float64) delta_t tensor(1.7458, dtype=torch.float64)
15 gae_duplicate tensor(3.2897, dtype=torch.float64) tensor(-6.8213, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(0.9855, dtype=torch.float64)
14 gae_duplicate tensor(3.6172, dtype=torch.float64) tensor(-7.5291, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8120, dtype=torch.float64) delta_t tensor(1.5826, dtype=torch.float64)
13 gae_duplicate tensor(4.4764, dtype=torch.float64) tensor(-9.3352, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4492, dtype=torch.float64) delta_t tensor(1.4874, dtype=torch.float64)
12 gae_duplicate tensor(5.0685, dtype=torch.float64) tensor(-10.5293, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2419, dtype=torch.float64) delta_t tensor(-0.2047, dtype=torch.float64)
11 gae_duplicate tensor(3.8501, dtype=torch.float64) tensor(-7.9985, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1902, dtype=torch.float64) delta_t tensor(-0.8675, dtype=torch.float64)
10 gae_duplicate tensor(2.2126, dtype=torch.float64) tensor(-4.6053, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.4536, dtype=torch.float64) delta_t tensor(-1.3597, dtype=torch.float64)
9 gae_duplicate tensor(0.4104, dtype=torch.float64) tensor(-0.8525, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3447, dtype=torch.float64) delta_t tensor(0.4933, dtype=torch.float64)
8 gae_duplicate tensor(0.8216, dtype=torch.float64) tensor(-1.7101, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0853, dtype=torch.float64) delta_t tensor(0.0718, dtype=torch.float64)
7 gae_duplicate tensor(0.7291, dtype=torch.float64) tensor(-1.5204, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6411, dtype=torch.float64) delta_t tensor(-0.7260, dtype=torch.float64)
6 gae_duplicate tensor(-0.1427, dtype=torch.float64) tensor(0.2971, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3159, dtype=torch.float64) delta_t tensor(-0.4520, dtype=torch.float64)
5 gae_duplicate tensor(-0.5662, dtype=torch.float64) tensor(1.1785, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6424, dtype=torch.float64) delta_t tensor(0.3967, dtype=torch.float64)
4 gae_duplicate tensor(-0.0562, dtype=torch.float64) tensor(0.1168, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5766, dtype=torch.float64) delta_t tensor(-0.7516, dtype=torch.float64)
3 gae_duplicate tensor(-0.7966, dtype=torch.float64) tensor(1.6581, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5402, dtype=torch.float64) delta_t tensor(-0.4841, dtype=torch.float64)
2 gae_duplicate tensor(-1.1214, dtype=torch.float64) tensor(2.3295, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:317.55853271484375
value loss:147.86073303222656
entropies:37.429840087890625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.544691324234009 seconds
19 rew tensor(0.8099, dtype=torch.float64) delta_t tensor(1.5298, dtype=torch.float64)
19 gae_duplicate tensor(1.5298, dtype=torch.float64) tensor(-3.1719, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8103, dtype=torch.float64) delta_t tensor(1.0665, dtype=torch.float64)
18 gae_duplicate tensor(2.2904, dtype=torch.float64) tensor(-4.7674, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8107, dtype=torch.float64) delta_t tensor(0.9772, dtype=torch.float64)
17 gae_duplicate tensor(2.8095, dtype=torch.float64) tensor(-5.8479, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8111, dtype=torch.float64) delta_t tensor(-1.1116, dtype=torch.float64)
16 gae_duplicate tensor(1.1360, dtype=torch.float64) tensor(-2.3645, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(0.9257, dtype=torch.float64)
15 gae_duplicate tensor(1.8345, dtype=torch.float64) tensor(-3.8185, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8120, dtype=torch.float64) delta_t tensor(0.4152, dtype=torch.float64)
14 gae_duplicate tensor(1.8828, dtype=torch.float64) tensor(-3.9190, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8124, dtype=torch.float64) delta_t tensor(1.1021, dtype=torch.float64)
13 gae_duplicate tensor(2.6084, dtype=torch.float64) tensor(-5.4188, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(0.6932, dtype=torch.float64)
12 gae_duplicate tensor(2.7799, dtype=torch.float64) tensor(-5.7862, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7093, dtype=torch.float64) delta_t tensor(0.5494, dtype=torch.float64)
11 gae_duplicate tensor(2.7733, dtype=torch.float64) tensor(-5.7838, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6057, dtype=torch.float64) delta_t tensor(0.3325, dtype=torch.float64)
10 gae_duplicate tensor(2.5511, dtype=torch.float64) tensor(-5.3204, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1382, dtype=torch.float64) delta_t tensor(0.3389, dtype=torch.float64)
9 gae_duplicate tensor(2.3798, dtype=torch.float64) tensor(-4.9440, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0343, dtype=torch.float64) delta_t tensor(1.6506, dtype=torch.float64)
8 gae_duplicate tensor(3.5545, dtype=torch.float64) tensor(-7.4130, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4331, dtype=torch.float64) delta_t tensor(0.3786, dtype=torch.float64)
7 gae_duplicate tensor(3.2222, dtype=torch.float64) tensor(-6.6939, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2121, dtype=torch.float64) delta_t tensor(-0.4039, dtype=torch.float64)
6 gae_duplicate tensor(2.1739, dtype=torch.float64) tensor(-4.5073, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3302, dtype=torch.float64) delta_t tensor(0.1601, dtype=torch.float64)
5 gae_duplicate tensor(1.8993, dtype=torch.float64) tensor(-3.9456, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5763, dtype=torch.float64) delta_t tensor(-0.7216, dtype=torch.float64)
4 gae_duplicate tensor(0.7979, dtype=torch.float64) tensor(-1.6607, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1625, dtype=torch.float64) delta_t tensor(-0.5312, dtype=torch.float64)
3 gae_duplicate tensor(0.1071, dtype=torch.float64) tensor(-0.2229, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2673, dtype=torch.float64) delta_t tensor(-2.0795, dtype=torch.float64)
2 gae_duplicate tensor(-1.9938, dtype=torch.float64) tensor(4.1338, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:427.5882263183594
value loss:141.07266235351562
entropies:37.429840087890625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.1451)
ToM Target loss= tensor(301.0583)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.453157901763916 seconds
19 rew tensor(0.8112, dtype=torch.float64) delta_t tensor(-0.3404, dtype=torch.float64)
19 gae_duplicate tensor(-0.3404, dtype=torch.float64) tensor(0.7071, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(0.3982, dtype=torch.float64)
18 gae_duplicate tensor(0.1259, dtype=torch.float64) tensor(-0.2615, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8120, dtype=torch.float64) delta_t tensor(0.6941, dtype=torch.float64)
17 gae_duplicate tensor(0.7948, dtype=torch.float64) tensor(-1.6543, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8125, dtype=torch.float64) delta_t tensor(1.8262, dtype=torch.float64)
16 gae_duplicate tensor(2.4620, dtype=torch.float64) tensor(-5.1244, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(0.8259, dtype=torch.float64)
15 gae_duplicate tensor(2.7955, dtype=torch.float64) tensor(-5.7962, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(0.9866, dtype=torch.float64)
14 gae_duplicate tensor(3.2229, dtype=torch.float64) tensor(-6.6955, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(1.5768, dtype=torch.float64)
13 gae_duplicate tensor(4.1552, dtype=torch.float64) tensor(-8.6491, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(1.2370, dtype=torch.float64)
12 gae_duplicate tensor(4.5611, dtype=torch.float64) tensor(-9.4752, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3454, dtype=torch.float64) delta_t tensor(-0.4761, dtype=torch.float64)
11 gae_duplicate tensor(3.1728, dtype=torch.float64) tensor(-6.5782, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2934, dtype=torch.float64) delta_t tensor(-0.2960, dtype=torch.float64)
10 gae_duplicate tensor(2.2422, dtype=torch.float64) tensor(-4.6489, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2935, dtype=torch.float64) delta_t tensor(0.5794, dtype=torch.float64)
9 gae_duplicate tensor(2.3732, dtype=torch.float64) tensor(-4.9397, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3835, dtype=torch.float64) delta_t tensor(0.3759, dtype=torch.float64)
8 gae_duplicate tensor(2.2744, dtype=torch.float64) tensor(-4.7342, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5398, dtype=torch.float64) delta_t tensor(-0.4426, dtype=torch.float64)
7 gae_duplicate tensor(1.3769, dtype=torch.float64) tensor(-2.8549, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8524, dtype=torch.float64) delta_t tensor(-0.6597, dtype=torch.float64)
6 gae_duplicate tensor(0.4418, dtype=torch.float64) tensor(-0.9214, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3734, dtype=torch.float64) delta_t tensor(-0.8117, dtype=torch.float64)
5 gae_duplicate tensor(-0.4583, dtype=torch.float64) tensor(0.9520, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1250, dtype=torch.float64) delta_t tensor(1.1117, dtype=torch.float64)
4 gae_duplicate tensor(0.7451, dtype=torch.float64) tensor(-1.5448, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4784, dtype=torch.float64) delta_t tensor(-1.0059, dtype=torch.float64)
3 gae_duplicate tensor(-0.4098, dtype=torch.float64) tensor(0.8513, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4384, dtype=torch.float64) delta_t tensor(-0.2604, dtype=torch.float64)
2 gae_duplicate tensor(-0.5882, dtype=torch.float64) tensor(1.2219, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:359.75140380859375
value loss:138.5481414794922
entropies:37.429840087890625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.456233978271484 seconds
19 rew tensor(0.8119, dtype=torch.float64) delta_t tensor(-0.6078, dtype=torch.float64)
19 gae_duplicate tensor(-0.6078, dtype=torch.float64) tensor(1.2651, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8123, dtype=torch.float64) delta_t tensor(0.4126, dtype=torch.float64)
18 gae_duplicate tensor(-0.0736, dtype=torch.float64) tensor(0.1530, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(0.5550, dtype=torch.float64)
17 gae_duplicate tensor(0.4961, dtype=torch.float64) tensor(-1.0306, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.5626, dtype=torch.float64)
16 gae_duplicate tensor(0.9595, dtype=torch.float64) tensor(-1.9972, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(1.7627, dtype=torch.float64)
15 gae_duplicate tensor(2.5303, dtype=torch.float64) tensor(-5.2670, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.7735, dtype=torch.float64)
14 gae_duplicate tensor(2.7978, dtype=torch.float64) tensor(-5.8007, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(1.0119, dtype=torch.float64)
13 gae_duplicate tensor(3.2501, dtype=torch.float64) tensor(-6.7652, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5533, dtype=torch.float64) delta_t tensor(0.4173, dtype=torch.float64)
12 gae_duplicate tensor(3.0173, dtype=torch.float64) tensor(-6.2805, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4490, dtype=torch.float64) delta_t tensor(1.6407, dtype=torch.float64)
11 gae_duplicate tensor(4.0546, dtype=torch.float64) tensor(-8.4230, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3969, dtype=torch.float64) delta_t tensor(0.1000, dtype=torch.float64)
10 gae_duplicate tensor(3.3436, dtype=torch.float64) tensor(-6.9324, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0210, dtype=torch.float64) delta_t tensor(0.1115, dtype=torch.float64)
9 gae_duplicate tensor(2.7864, dtype=torch.float64) tensor(-5.8000, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0733, dtype=torch.float64) delta_t tensor(0.8561, dtype=torch.float64)
8 gae_duplicate tensor(3.0852, dtype=torch.float64) tensor(-6.4219, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5012, dtype=torch.float64) delta_t tensor(0.4360, dtype=torch.float64)
7 gae_duplicate tensor(2.9041, dtype=torch.float64) tensor(-6.0328, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8561, dtype=torch.float64) delta_t tensor(-0.3259, dtype=torch.float64)
6 gae_duplicate tensor(1.9974, dtype=torch.float64) tensor(-4.1576, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2301, dtype=torch.float64) delta_t tensor(0.6938, dtype=torch.float64)
5 gae_duplicate tensor(2.2917, dtype=torch.float64) tensor(-4.7702, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3784, dtype=torch.float64) delta_t tensor(-0.5209, dtype=torch.float64)
4 gae_duplicate tensor(1.3124, dtype=torch.float64) tensor(-2.7264, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0664, dtype=torch.float64) delta_t tensor(-0.9960, dtype=torch.float64)
3 gae_duplicate tensor(0.0539, dtype=torch.float64) tensor(-0.1120, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8583, dtype=torch.float64) delta_t tensor(-0.6464, dtype=torch.float64)
2 gae_duplicate tensor(-0.6032, dtype=torch.float64) tensor(1.2531, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:417.95489501953125
value loss:150.15823364257812
entropies:37.429832458496094
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.444156169891357 seconds
19 rew tensor(0.7607, dtype=torch.float64) delta_t tensor(0.6288, dtype=torch.float64)
19 gae_duplicate tensor(0.6288, dtype=torch.float64) tensor(-1.3063, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6561, dtype=torch.float64) delta_t tensor(-0.4999, dtype=torch.float64)
18 gae_duplicate tensor(0.0031, dtype=torch.float64) tensor(-0.0065, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6040, dtype=torch.float64) delta_t tensor(0.6891, dtype=torch.float64)
17 gae_duplicate tensor(0.6916, dtype=torch.float64) tensor(-1.4395, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4993, dtype=torch.float64) delta_t tensor(1.0126, dtype=torch.float64)
16 gae_duplicate tensor(1.5659, dtype=torch.float64) tensor(-3.2595, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.8555, dtype=torch.float64)
15 gae_duplicate tensor(2.1082, dtype=torch.float64) tensor(-4.3883, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7621, dtype=torch.float64) delta_t tensor(1.3036, dtype=torch.float64)
14 gae_duplicate tensor(2.9901, dtype=torch.float64) tensor(-6.2114, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6052, dtype=torch.float64) delta_t tensor(0.4608, dtype=torch.float64)
13 gae_duplicate tensor(2.8529, dtype=torch.float64) tensor(-5.9264, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5006, dtype=torch.float64) delta_t tensor(0.5456, dtype=torch.float64)
12 gae_duplicate tensor(2.8279, dtype=torch.float64) tensor(-5.8865, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5008, dtype=torch.float64) delta_t tensor(0.0148, dtype=torch.float64)
11 gae_duplicate tensor(2.2771, dtype=torch.float64) tensor(-4.7493, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5468, dtype=torch.float64) delta_t tensor(0.0029, dtype=torch.float64)
10 gae_duplicate tensor(1.8246, dtype=torch.float64) tensor(-3.7826, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2911, dtype=torch.float64) delta_t tensor(0.2431, dtype=torch.float64)
9 gae_duplicate tensor(1.7028, dtype=torch.float64) tensor(-3.5444, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1341, dtype=torch.float64) delta_t tensor(1.3991, dtype=torch.float64)
8 gae_duplicate tensor(2.7614, dtype=torch.float64) tensor(-5.7596, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0229, dtype=torch.float64) delta_t tensor(-0.4259, dtype=torch.float64)
7 gae_duplicate tensor(1.7831, dtype=torch.float64) tensor(-3.7191, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4359, dtype=torch.float64) delta_t tensor(-0.3677, dtype=torch.float64)
6 gae_duplicate tensor(1.0588, dtype=torch.float64) tensor(-2.2039, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5419, dtype=torch.float64) delta_t tensor(-0.5595, dtype=torch.float64)
5 gae_duplicate tensor(0.2875, dtype=torch.float64) tensor(-0.5984, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9674, dtype=torch.float64) delta_t tensor(-0.7118, dtype=torch.float64)
4 gae_duplicate tensor(-0.4818, dtype=torch.float64) tensor(1.0009, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1251, dtype=torch.float64) delta_t tensor(-2.0835, dtype=torch.float64)
3 gae_duplicate tensor(-2.4689, dtype=torch.float64) tensor(5.1288, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3929, dtype=torch.float64) delta_t tensor(-0.6489, dtype=torch.float64)
2 gae_duplicate tensor(-2.6241, dtype=torch.float64) tensor(5.4511, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:246.08309936523438
value loss:104.22406005859375
entropies:37.42982864379883
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.500208854675293 seconds
19 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(-1.5410, dtype=torch.float64)
19 gae_duplicate tensor(-1.5410, dtype=torch.float64) tensor(3.2076, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(0.6578, dtype=torch.float64)
18 gae_duplicate tensor(-0.5749, dtype=torch.float64) tensor(1.1968, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(1.1804, dtype=torch.float64)
17 gae_duplicate tensor(0.7204, dtype=torch.float64) tensor(-1.4936, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.5613, dtype=torch.float64)
16 gae_duplicate tensor(1.1376, dtype=torch.float64) tensor(-2.3680, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.5617, dtype=torch.float64)
15 gae_duplicate tensor(1.4718, dtype=torch.float64) tensor(-3.0575, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.6309, dtype=torch.float64)
14 gae_duplicate tensor(1.8084, dtype=torch.float64) tensor(-3.7565, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.6496, dtype=torch.float64)
13 gae_duplicate tensor(2.0963, dtype=torch.float64) tensor(-4.3548, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(-0.4500, dtype=torch.float64)
12 gae_duplicate tensor(1.2270, dtype=torch.float64) tensor(-2.5490, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.6887, dtype=torch.float64)
11 gae_duplicate tensor(1.6704, dtype=torch.float64) tensor(-3.4769, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6065, dtype=torch.float64) delta_t tensor(0.2823, dtype=torch.float64)
10 gae_duplicate tensor(1.6186, dtype=torch.float64) tensor(-3.3692, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6067, dtype=torch.float64) delta_t tensor(0.3716, dtype=torch.float64)
9 gae_duplicate tensor(1.6665, dtype=torch.float64) tensor(-3.4689, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3445, dtype=torch.float64) delta_t tensor(0.5272, dtype=torch.float64)
8 gae_duplicate tensor(1.8604, dtype=torch.float64) tensor(-3.8647, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1346, dtype=torch.float64) delta_t tensor(2.0799, dtype=torch.float64)
7 gae_duplicate tensor(3.5682, dtype=torch.float64) tensor(-7.4273, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7574, dtype=torch.float64) delta_t tensor(-1.1799, dtype=torch.float64)
6 gae_duplicate tensor(1.6746, dtype=torch.float64) tensor(-3.4787, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0201, dtype=torch.float64) delta_t tensor(0.6322, dtype=torch.float64)
5 gae_duplicate tensor(1.9719, dtype=torch.float64) tensor(-4.0963, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4929, dtype=torch.float64) delta_t tensor(-1.0096, dtype=torch.float64)
4 gae_duplicate tensor(0.5679, dtype=torch.float64) tensor(-1.1822, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2844, dtype=torch.float64) delta_t tensor(-1.2195, dtype=torch.float64)
3 gae_duplicate tensor(-0.7652, dtype=torch.float64) tensor(1.5863, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1279, dtype=torch.float64) delta_t tensor(-1.1994, dtype=torch.float64)
2 gae_duplicate tensor(-1.8116, dtype=torch.float64) tensor(3.7555, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:228.0605926513672
value loss:76.67594909667969
entropies:37.42982864379883
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.228590250015259 seconds
19 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(-1.3846, dtype=torch.float64)
19 gae_duplicate tensor(-1.3846, dtype=torch.float64) tensor(2.8822, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(0.6769, dtype=torch.float64)
18 gae_duplicate tensor(-0.4308, dtype=torch.float64) tensor(0.8949, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.9396, dtype=torch.float64)
17 gae_duplicate tensor(0.5950, dtype=torch.float64) tensor(-1.2359, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(1.6956, dtype=torch.float64)
16 gae_duplicate tensor(2.1715, dtype=torch.float64) tensor(-4.5110, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(2.2554, dtype=torch.float64)
15 gae_duplicate tensor(3.9926, dtype=torch.float64) tensor(-8.3108, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(1.0665, dtype=torch.float64)
14 gae_duplicate tensor(4.2606, dtype=torch.float64) tensor(-8.8864, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(1.0669, dtype=torch.float64)
13 gae_duplicate tensor(4.4753, dtype=torch.float64) tensor(-9.3155, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(1.0673, dtype=torch.float64)
12 gae_duplicate tensor(4.6476, dtype=torch.float64) tensor(-9.6740, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(1.1376, dtype=torch.float64)
11 gae_duplicate tensor(4.8556, dtype=torch.float64) tensor(-10.0868, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2908, dtype=torch.float64) delta_t tensor(-1.7467, dtype=torch.float64)
10 gae_duplicate tensor(2.1378, dtype=torch.float64) tensor(-4.4589, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2383, dtype=torch.float64) delta_t tensor(-0.1805, dtype=torch.float64)
9 gae_duplicate tensor(1.5297, dtype=torch.float64) tensor(-3.1841, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6034, dtype=torch.float64) delta_t tensor(1.2002, dtype=torch.float64)
8 gae_duplicate tensor(2.4240, dtype=torch.float64) tensor(-5.0456, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9719, dtype=torch.float64) delta_t tensor(-0.9861, dtype=torch.float64)
7 gae_duplicate tensor(0.9531, dtype=torch.float64) tensor(-1.9758, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9724, dtype=torch.float64) delta_t tensor(-0.9095, dtype=torch.float64)
6 gae_duplicate tensor(-0.1470, dtype=torch.float64) tensor(0.3054, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2368, dtype=torch.float64) delta_t tensor(0.3888, dtype=torch.float64)
5 gae_duplicate tensor(0.2712, dtype=torch.float64) tensor(-0.5645, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3932, dtype=torch.float64) delta_t tensor(-0.0905, dtype=torch.float64)
4 gae_duplicate tensor(0.1265, dtype=torch.float64) tensor(-0.2638, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3419, dtype=torch.float64) delta_t tensor(-2.1376, dtype=torch.float64)
3 gae_duplicate tensor(-2.0364, dtype=torch.float64) tensor(4.2304, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2381, dtype=torch.float64) delta_t tensor(-0.2482, dtype=torch.float64)
2 gae_duplicate tensor(-1.8774, dtype=torch.float64) tensor(3.9001, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:330.6784362792969
value loss:191.92214965820312
entropies:37.42982864379883
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.3438)
ToM Target loss= tensor(300.9461)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.53011417388916 seconds
19 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(-1.5236, dtype=torch.float64)
19 gae_duplicate tensor(-1.5236, dtype=torch.float64) tensor(3.1715, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.2007, dtype=torch.float64)
18 gae_duplicate tensor(-1.0183, dtype=torch.float64) tensor(2.1195, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.0605, dtype=torch.float64)
17 gae_duplicate tensor(-0.7541, dtype=torch.float64) tensor(1.5635, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.5947, dtype=torch.float64)
16 gae_duplicate tensor(-0.0087, dtype=torch.float64) tensor(0.0180, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.7736, dtype=torch.float64)
15 gae_duplicate tensor(0.7667, dtype=torch.float64) tensor(-1.5959, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(0.4213, dtype=torch.float64)
14 gae_duplicate tensor(1.0347, dtype=torch.float64) tensor(-2.1537, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.4809, dtype=torch.float64)
13 gae_duplicate tensor(1.3087, dtype=torch.float64) tensor(-2.7186, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(0.4933, dtype=torch.float64)
12 gae_duplicate tensor(1.5402, dtype=torch.float64) tensor(-3.1934, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.5855, dtype=torch.float64)
11 gae_duplicate tensor(1.8177, dtype=torch.float64) tensor(-3.7761, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6592, dtype=torch.float64) delta_t tensor(-0.3750, dtype=torch.float64)
10 gae_duplicate tensor(1.0792, dtype=torch.float64) tensor(-2.2419, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5541, dtype=torch.float64) delta_t tensor(1.0356, dtype=torch.float64)
9 gae_duplicate tensor(1.8989, dtype=torch.float64) tensor(-3.9448, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1853, dtype=torch.float64) delta_t tensor(-0.8618, dtype=torch.float64)
8 gae_duplicate tensor(0.6574, dtype=torch.float64) tensor(-1.3656, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0781, dtype=torch.float64) delta_t tensor(1.5091, dtype=torch.float64)
7 gae_duplicate tensor(2.0349, dtype=torch.float64) tensor(-4.2358, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7629, dtype=torch.float64) delta_t tensor(-1.1258, dtype=torch.float64)
6 gae_duplicate tensor(0.5022, dtype=torch.float64) tensor(-1.0453, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9213, dtype=torch.float64) delta_t tensor(0.8805, dtype=torch.float64)
5 gae_duplicate tensor(1.2823, dtype=torch.float64) tensor(-2.6744, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7118, dtype=torch.float64) delta_t tensor(-1.4617, dtype=torch.float64)
4 gae_duplicate tensor(-0.4359, dtype=torch.float64) tensor(0.9037, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3976, dtype=torch.float64) delta_t tensor(-0.9209, dtype=torch.float64)
3 gae_duplicate tensor(-1.2697, dtype=torch.float64) tensor(2.6323, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0298, dtype=torch.float64) delta_t tensor(-1.5031, dtype=torch.float64)
2 gae_duplicate tensor(-2.5188, dtype=torch.float64) tensor(5.2324, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:78.70497131347656
value loss:48.541656494140625
entropies:37.429832458496094
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4490721225738525 seconds
19 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(-0.1714, dtype=torch.float64)
19 gae_duplicate tensor(-0.1714, dtype=torch.float64) tensor(0.3561, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.6800, dtype=torch.float64)
18 gae_duplicate tensor(0.5429, dtype=torch.float64) tensor(-1.1300, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.4005, dtype=torch.float64)
17 gae_duplicate tensor(0.8348, dtype=torch.float64) tensor(-1.7411, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(-0.9057, dtype=torch.float64)
16 gae_duplicate tensor(-0.2378, dtype=torch.float64) tensor(0.4931, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.2864, dtype=torch.float64)
15 gae_duplicate tensor(0.0961, dtype=torch.float64) tensor(-0.1997, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.3167, dtype=torch.float64)
14 gae_duplicate tensor(0.3936, dtype=torch.float64) tensor(-0.8209, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(0.3095, dtype=torch.float64)
13 gae_duplicate tensor(0.6243, dtype=torch.float64) tensor(-1.2970, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.2014, dtype=torch.float64)
12 gae_duplicate tensor(0.7008, dtype=torch.float64) tensor(-1.4588, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7109, dtype=torch.float64) delta_t tensor(1.8127, dtype=torch.float64)
11 gae_duplicate tensor(2.3733, dtype=torch.float64) tensor(-4.9400, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6583, dtype=torch.float64) delta_t tensor(-0.1943, dtype=torch.float64)
10 gae_duplicate tensor(1.7043, dtype=torch.float64) tensor(-3.5336, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2885, dtype=torch.float64) delta_t tensor(-0.7791, dtype=torch.float64)
9 gae_duplicate tensor(0.5843, dtype=torch.float64) tensor(-1.2138, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3985, dtype=torch.float64) delta_t tensor(1.3862, dtype=torch.float64)
8 gae_duplicate tensor(1.8537, dtype=torch.float64) tensor(-3.8509, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0816, dtype=torch.float64) delta_t tensor(-0.7697, dtype=torch.float64)
7 gae_duplicate tensor(0.7133, dtype=torch.float64) tensor(-1.4847, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6098, dtype=torch.float64) delta_t tensor(-0.0645, dtype=torch.float64)
6 gae_duplicate tensor(0.5061, dtype=torch.float64) tensor(-1.0534, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2878, dtype=torch.float64) delta_t tensor(0.5593, dtype=torch.float64)
5 gae_duplicate tensor(0.9642, dtype=torch.float64) tensor(-2.0029, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2433, dtype=torch.float64) delta_t tensor(-0.2180, dtype=torch.float64)
4 gae_duplicate tensor(0.5534, dtype=torch.float64) tensor(-1.1495, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2443, dtype=torch.float64) delta_t tensor(-1.8088, dtype=torch.float64)
3 gae_duplicate tensor(-1.3661, dtype=torch.float64) tensor(2.8436, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0832, dtype=torch.float64) delta_t tensor(-0.7856, dtype=torch.float64)
2 gae_duplicate tensor(-1.8785, dtype=torch.float64) tensor(3.9100, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:108.51768493652344
value loss:32.750160217285156
entropies:37.429832458496094
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5579540729522705 seconds
19 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(-1.7316, dtype=torch.float64)
19 gae_duplicate tensor(-1.7316, dtype=torch.float64) tensor(3.6113, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.3051, dtype=torch.float64)
18 gae_duplicate tensor(-1.0802, dtype=torch.float64) tensor(2.2396, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.3055, dtype=torch.float64)
17 gae_duplicate tensor(-0.5586, dtype=torch.float64) tensor(1.1605, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.3647, dtype=torch.float64)
16 gae_duplicate tensor(-0.0822, dtype=torch.float64) tensor(0.1711, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(-0.3799, dtype=torch.float64)
15 gae_duplicate tensor(-0.4456, dtype=torch.float64) tensor(0.9293, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(0.5540, dtype=torch.float64)
14 gae_duplicate tensor(0.1976, dtype=torch.float64) tensor(-0.4112, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.0330, dtype=torch.float64)
13 gae_duplicate tensor(0.1910, dtype=torch.float64) tensor(-0.3968, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.2747, dtype=torch.float64)
12 gae_duplicate tensor(0.4275, dtype=torch.float64) tensor(-0.8882, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8169, dtype=torch.float64) delta_t tensor(0.1289, dtype=torch.float64)
11 gae_duplicate tensor(0.4709, dtype=torch.float64) tensor(-0.9821, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3930, dtype=torch.float64) delta_t tensor(0.1162, dtype=torch.float64)
10 gae_duplicate tensor(0.4930, dtype=torch.float64) tensor(-1.0261, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0311, dtype=torch.float64) delta_t tensor(1.6670, dtype=torch.float64)
9 gae_duplicate tensor(2.0614, dtype=torch.float64) tensor(-4.2824, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4460, dtype=torch.float64) delta_t tensor(0.6750, dtype=torch.float64)
8 gae_duplicate tensor(2.3241, dtype=torch.float64) tensor(-4.8189, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6138, dtype=torch.float64) delta_t tensor(-1.8236, dtype=torch.float64)
7 gae_duplicate tensor(0.0357, dtype=torch.float64) tensor(-0.0741, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6140, dtype=torch.float64) delta_t tensor(-0.9589, dtype=torch.float64)
6 gae_duplicate tensor(-0.9303, dtype=torch.float64) tensor(1.9327, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7732, dtype=torch.float64) delta_t tensor(1.0849, dtype=torch.float64)
5 gae_duplicate tensor(0.3406, dtype=torch.float64) tensor(-0.7089, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5617, dtype=torch.float64) delta_t tensor(-1.2708, dtype=torch.float64)
4 gae_duplicate tensor(-0.9983, dtype=torch.float64) tensor(2.0739, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1445, dtype=torch.float64) delta_t tensor(-0.3166, dtype=torch.float64)
3 gae_duplicate tensor(-1.1152, dtype=torch.float64) tensor(2.3168, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2448, dtype=torch.float64) delta_t tensor(-1.7422, dtype=torch.float64)
2 gae_duplicate tensor(-2.6344, dtype=torch.float64) tensor(5.4730, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-39.03989028930664
value loss:37.829811096191406
entropies:37.429840087890625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.628663063049316 seconds
19 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(-1.2926, dtype=torch.float64)
19 gae_duplicate tensor(-1.2926, dtype=torch.float64) tensor(2.6803, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(0.4464, dtype=torch.float64)
18 gae_duplicate tensor(-0.5877, dtype=torch.float64) tensor(1.2185, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(-0.6453, dtype=torch.float64)
17 gae_duplicate tensor(-1.1155, dtype=torch.float64) tensor(2.3218, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(0.2206, dtype=torch.float64)
16 gae_duplicate tensor(-0.6718, dtype=torch.float64) tensor(1.3929, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8171, dtype=torch.float64) delta_t tensor(0.2363, dtype=torch.float64)
15 gae_duplicate tensor(-0.3011, dtype=torch.float64) tensor(0.6280, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8175, dtype=torch.float64) delta_t tensor(0.3378, dtype=torch.float64)
14 gae_duplicate tensor(0.0969, dtype=torch.float64) tensor(-0.2016, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1259, dtype=torch.float64) delta_t tensor(0.0661, dtype=torch.float64)
13 gae_duplicate tensor(0.1436, dtype=torch.float64) tensor(-0.2989, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2323, dtype=torch.float64) delta_t tensor(1.1986, dtype=torch.float64)
12 gae_duplicate tensor(1.3134, dtype=torch.float64) tensor(-2.7233, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1260, dtype=torch.float64) delta_t tensor(-1.3581, dtype=torch.float64)
11 gae_duplicate tensor(-0.3074, dtype=torch.float64) tensor(0.6398, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0335, dtype=torch.float64) delta_t tensor(-0.4642, dtype=torch.float64)
10 gae_duplicate tensor(-0.7101, dtype=torch.float64) tensor(1.4781, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4450, dtype=torch.float64) delta_t tensor(1.2029, dtype=torch.float64)
9 gae_duplicate tensor(0.6348, dtype=torch.float64) tensor(-1.3188, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0730, dtype=torch.float64) delta_t tensor(-0.6334, dtype=torch.float64)
8 gae_duplicate tensor(-0.1255, dtype=torch.float64) tensor(0.2602, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1262, dtype=torch.float64) delta_t tensor(-0.2391, dtype=torch.float64)
7 gae_duplicate tensor(-0.3396, dtype=torch.float64) tensor(0.7067, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7239, dtype=torch.float64) delta_t tensor(-0.0550, dtype=torch.float64)
6 gae_duplicate tensor(-0.3266, dtype=torch.float64) tensor(0.6798, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2023, dtype=torch.float64) delta_t tensor(-0.4149, dtype=torch.float64)
5 gae_duplicate tensor(-0.6762, dtype=torch.float64) tensor(1.4048, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3530, dtype=torch.float64) delta_t tensor(-1.0267, dtype=torch.float64)
4 gae_duplicate tensor(-1.5677, dtype=torch.float64) tensor(3.2630, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4063, dtype=torch.float64) delta_t tensor(0.1811, dtype=torch.float64)
3 gae_duplicate tensor(-1.0730, dtype=torch.float64) tensor(2.2334, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2030, dtype=torch.float64) delta_t tensor(-1.2182, dtype=torch.float64)
2 gae_duplicate tensor(-2.0767, dtype=torch.float64) tensor(4.3225, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-113.2465591430664
value loss:22.76387596130371
entropies:37.42984390258789
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.95194411277771 seconds
19 rew tensor(0.8174, dtype=torch.float64) delta_t tensor(-2.2854, dtype=torch.float64)
19 gae_duplicate tensor(-2.2854, dtype=torch.float64) tensor(4.7478, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8177, dtype=torch.float64) delta_t tensor(0.8989, dtype=torch.float64)
18 gae_duplicate tensor(-0.9294, dtype=torch.float64) tensor(1.9381, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8181, dtype=torch.float64) delta_t tensor(0.3379, dtype=torch.float64)
17 gae_duplicate tensor(-0.4056, dtype=torch.float64) tensor(0.8442, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8185, dtype=torch.float64) delta_t tensor(0.3383, dtype=torch.float64)
16 gae_duplicate tensor(0.0138, dtype=torch.float64) tensor(-0.0288, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8189, dtype=torch.float64) delta_t tensor(2.4944, dtype=torch.float64)
15 gae_duplicate tensor(2.5054, dtype=torch.float64) tensor(-5.2051, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8193, dtype=torch.float64) delta_t tensor(-0.1025, dtype=torch.float64)
14 gae_duplicate tensor(1.9019, dtype=torch.float64) tensor(-3.9586, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4456, dtype=torch.float64) delta_t tensor(-1.1774, dtype=torch.float64)
13 gae_duplicate tensor(0.3441, dtype=torch.float64) tensor(-0.7163, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1787, dtype=torch.float64) delta_t tensor(-0.3174, dtype=torch.float64)
12 gae_duplicate tensor(-0.0421, dtype=torch.float64) tensor(0.0875, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1254, dtype=torch.float64) delta_t tensor(-0.0284, dtype=torch.float64)
11 gae_duplicate tensor(-0.0621, dtype=torch.float64) tensor(0.1293, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0186, dtype=torch.float64) delta_t tensor(0.0249, dtype=torch.float64)
10 gae_duplicate tensor(-0.0249, dtype=torch.float64) tensor(0.0515, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4083, dtype=torch.float64) delta_t tensor(-1.6384, dtype=torch.float64)
9 gae_duplicate tensor(-1.6583, dtype=torch.float64) tensor(3.4451, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6219, dtype=torch.float64) delta_t tensor(-1.7180, dtype=torch.float64)
8 gae_duplicate tensor(-3.0447, dtype=torch.float64) tensor(6.3492, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1953, dtype=torch.float64) delta_t tensor(1.4863, dtype=torch.float64)
7 gae_duplicate tensor(-0.9495, dtype=torch.float64) tensor(1.9800, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2846, dtype=torch.float64) delta_t tensor(0.1965, dtype=torch.float64)
6 gae_duplicate tensor(-0.5631, dtype=torch.float64) tensor(1.1699, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6218, dtype=torch.float64) delta_t tensor(-0.5323, dtype=torch.float64)
5 gae_duplicate tensor(-0.9828, dtype=torch.float64) tensor(2.0417, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4088, dtype=torch.float64) delta_t tensor(-0.5500, dtype=torch.float64)
4 gae_duplicate tensor(-1.3362, dtype=torch.float64) tensor(2.7866, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2084, dtype=torch.float64) delta_t tensor(-1.5023, dtype=torch.float64)
3 gae_duplicate tensor(-2.5713, dtype=torch.float64) tensor(5.3521, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0898, dtype=torch.float64) delta_t tensor(-0.8475, dtype=torch.float64)
2 gae_duplicate tensor(-2.9046, dtype=torch.float64) tensor(6.0342, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-163.41395568847656
value loss:70.96287536621094
entropies:37.42984390258789
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.0357)
ToM Target loss= tensor(300.7275)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.610385179519653 seconds
19 rew tensor(0.8172, dtype=torch.float64) delta_t tensor(-2.5213, dtype=torch.float64)
19 gae_duplicate tensor(-2.5213, dtype=torch.float64) tensor(5.2478, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8176, dtype=torch.float64) delta_t tensor(0.2133, dtype=torch.float64)
18 gae_duplicate tensor(-1.8037, dtype=torch.float64) tensor(3.7471, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8180, dtype=torch.float64) delta_t tensor(0.0550, dtype=torch.float64)
17 gae_duplicate tensor(-1.3880, dtype=torch.float64) tensor(2.8779, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8183, dtype=torch.float64) delta_t tensor(-0.1403, dtype=torch.float64)
16 gae_duplicate tensor(-1.2507, dtype=torch.float64) tensor(2.6032, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8187, dtype=torch.float64) delta_t tensor(0.4683, dtype=torch.float64)
15 gae_duplicate tensor(-0.5322, dtype=torch.float64) tensor(1.1057, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(0.0403, dtype=torch.float64)
14 gae_duplicate tensor(-0.3855, dtype=torch.float64) tensor(0.8024, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8195, dtype=torch.float64) delta_t tensor(0.7020, dtype=torch.float64)
13 gae_duplicate tensor(0.3936, dtype=torch.float64) tensor(-0.8192, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8199, dtype=torch.float64) delta_t tensor(0.6270, dtype=torch.float64)
12 gae_duplicate tensor(0.9419, dtype=torch.float64) tensor(-1.9568, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8202, dtype=torch.float64) delta_t tensor(0.3271, dtype=torch.float64)
11 gae_duplicate tensor(1.0806, dtype=torch.float64) tensor(-2.2534, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8206, dtype=torch.float64) delta_t tensor(1.1582, dtype=torch.float64)
10 gae_duplicate tensor(2.0227, dtype=torch.float64) tensor(-4.1940, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4997, dtype=torch.float64) delta_t tensor(-1.4070, dtype=torch.float64)
9 gae_duplicate tensor(0.2112, dtype=torch.float64) tensor(-0.4397, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1787, dtype=torch.float64) delta_t tensor(-0.3193, dtype=torch.float64)
8 gae_duplicate tensor(-0.1503, dtype=torch.float64) tensor(0.3122, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1958, dtype=torch.float64) delta_t tensor(0.6447, dtype=torch.float64)
7 gae_duplicate tensor(0.5245, dtype=torch.float64) tensor(-1.0875, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1959, dtype=torch.float64) delta_t tensor(-0.9928, dtype=torch.float64)
6 gae_duplicate tensor(-0.5732, dtype=torch.float64) tensor(1.1908, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4099, dtype=torch.float64) delta_t tensor(1.0986, dtype=torch.float64)
5 gae_duplicate tensor(0.6400, dtype=torch.float64) tensor(-1.3320, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3191, dtype=torch.float64) delta_t tensor(-1.0619, dtype=torch.float64)
4 gae_duplicate tensor(-0.5499, dtype=torch.float64) tensor(1.1403, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9457, dtype=torch.float64) delta_t tensor(-1.8140, dtype=torch.float64)
3 gae_duplicate tensor(-2.2539, dtype=torch.float64) tensor(4.6824, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5718, dtype=torch.float64) delta_t tensor(-0.3894, dtype=torch.float64)
2 gae_duplicate tensor(-2.1925, dtype=torch.float64) tensor(4.5636, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-98.26781463623047
value loss:46.65629959106445
entropies:37.42984390258789
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.487606763839722 seconds
19 rew tensor(0.8172, dtype=torch.float64) delta_t tensor(-2.6958, dtype=torch.float64)
19 gae_duplicate tensor(-2.6958, dtype=torch.float64) tensor(5.6005, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8175, dtype=torch.float64) delta_t tensor(0.1614, dtype=torch.float64)
18 gae_duplicate tensor(-1.9953, dtype=torch.float64) tensor(4.1372, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8179, dtype=torch.float64) delta_t tensor(-0.1759, dtype=torch.float64)
17 gae_duplicate tensor(-1.7721, dtype=torch.float64) tensor(3.6815, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8183, dtype=torch.float64) delta_t tensor(0.3276, dtype=torch.float64)
16 gae_duplicate tensor(-1.0901, dtype=torch.float64) tensor(2.2602, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8187, dtype=torch.float64) delta_t tensor(0.1427, dtype=torch.float64)
15 gae_duplicate tensor(-0.7293, dtype=torch.float64) tensor(1.5152, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8190, dtype=torch.float64) delta_t tensor(0.7482, dtype=torch.float64)
14 gae_duplicate tensor(0.1647, dtype=torch.float64) tensor(-0.3428, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8194, dtype=torch.float64) delta_t tensor(0.2485, dtype=torch.float64)
13 gae_duplicate tensor(0.3803, dtype=torch.float64) tensor(-0.7901, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8198, dtype=torch.float64) delta_t tensor(0.2489, dtype=torch.float64)
12 gae_duplicate tensor(0.5531, dtype=torch.float64) tensor(-1.1513, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8201, dtype=torch.float64) delta_t tensor(0.3330, dtype=torch.float64)
11 gae_duplicate tensor(0.7755, dtype=torch.float64) tensor(-1.6112, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6061, dtype=torch.float64) delta_t tensor(-0.2252, dtype=torch.float64)
10 gae_duplicate tensor(0.3953, dtype=torch.float64) tensor(-0.8227, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5527, dtype=torch.float64) delta_t tensor(-0.3309, dtype=torch.float64)
9 gae_duplicate tensor(-0.0146, dtype=torch.float64) tensor(0.0304, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1777, dtype=torch.float64) delta_t tensor(0.7028, dtype=torch.float64)
8 gae_duplicate tensor(0.6911, dtype=torch.float64) tensor(-1.4357, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0706, dtype=torch.float64) delta_t tensor(-1.3045, dtype=torch.float64)
7 gae_duplicate tensor(-0.7516, dtype=torch.float64) tensor(1.5615, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7865, dtype=torch.float64) delta_t tensor(0.4834, dtype=torch.float64)
6 gae_duplicate tensor(-0.1179, dtype=torch.float64) tensor(0.2459, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2690, dtype=torch.float64) delta_t tensor(-0.4305, dtype=torch.float64)
5 gae_duplicate tensor(-0.5248, dtype=torch.float64) tensor(1.0882, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6449, dtype=torch.float64) delta_t tensor(-1.4113, dtype=torch.float64)
4 gae_duplicate tensor(-1.8312, dtype=torch.float64) tensor(3.8115, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3250, dtype=torch.float64) delta_t tensor(-1.7005, dtype=torch.float64)
3 gae_duplicate tensor(-3.1654, dtype=torch.float64) tensor(6.5758, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2724, dtype=torch.float64) delta_t tensor(-2.2369, dtype=torch.float64)
2 gae_duplicate tensor(-4.7692, dtype=torch.float64) tensor(9.9077, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-206.69277954101562
value loss:82.19254302978516
entropies:37.429840087890625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.471637010574341 seconds
19 rew tensor(0.8175, dtype=torch.float64) delta_t tensor(-2.8506, dtype=torch.float64)
19 gae_duplicate tensor(-2.8506, dtype=torch.float64) tensor(5.9446, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8178, dtype=torch.float64) delta_t tensor(-0.1128, dtype=torch.float64)
18 gae_duplicate tensor(-2.3933, dtype=torch.float64) tensor(4.9815, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8182, dtype=torch.float64) delta_t tensor(0.4610, dtype=torch.float64)
17 gae_duplicate tensor(-1.4537, dtype=torch.float64) tensor(3.0200, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8186, dtype=torch.float64) delta_t tensor(0.7982, dtype=torch.float64)
16 gae_duplicate tensor(-0.3647, dtype=torch.float64) tensor(0.7578, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8189, dtype=torch.float64) delta_t tensor(0.2630, dtype=torch.float64)
15 gae_duplicate tensor(-0.0288, dtype=torch.float64) tensor(0.0600, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8193, dtype=torch.float64) delta_t tensor(0.3556, dtype=torch.float64)
14 gae_duplicate tensor(0.3326, dtype=torch.float64) tensor(-0.6910, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8197, dtype=torch.float64) delta_t tensor(0.3795, dtype=torch.float64)
13 gae_duplicate tensor(0.6456, dtype=torch.float64) tensor(-1.3413, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8200, dtype=torch.float64) delta_t tensor(0.3020, dtype=torch.float64)
12 gae_duplicate tensor(0.8185, dtype=torch.float64) tensor(-1.7069, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6053, dtype=torch.float64) delta_t tensor(-0.8340, dtype=torch.float64)
11 gae_duplicate tensor(-0.1792, dtype=torch.float64) tensor(0.3722, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4980, dtype=torch.float64) delta_t tensor(-0.1869, dtype=torch.float64)
10 gae_duplicate tensor(-0.3303, dtype=torch.float64) tensor(0.6848, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2294, dtype=torch.float64) delta_t tensor(0.2695, dtype=torch.float64)
9 gae_duplicate tensor(0.0053, dtype=torch.float64) tensor(-0.0111, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0682, dtype=torch.float64) delta_t tensor(-1.0032, dtype=torch.float64)
8 gae_duplicate tensor(-0.9990, dtype=torch.float64) tensor(2.0793, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6302, dtype=torch.float64) delta_t tensor(0.6967, dtype=torch.float64)
7 gae_duplicate tensor(-0.1025, dtype=torch.float64) tensor(0.2125, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2544, dtype=torch.float64) delta_t tensor(0.4573, dtype=torch.float64)
6 gae_duplicate tensor(0.3753, dtype=torch.float64) tensor(-0.7796, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9526, dtype=torch.float64) delta_t tensor(-1.2544, dtype=torch.float64)
5 gae_duplicate tensor(-0.9541, dtype=torch.float64) tensor(1.9822, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2216, dtype=torch.float64) delta_t tensor(-0.9909, dtype=torch.float64)
4 gae_duplicate tensor(-1.7542, dtype=torch.float64) tensor(3.6582, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1483, dtype=torch.float64) delta_t tensor(-0.1224, dtype=torch.float64)
3 gae_duplicate tensor(-1.5258, dtype=torch.float64) tensor(3.1698, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7926, dtype=torch.float64) delta_t tensor(-1.0389, dtype=torch.float64)
2 gae_duplicate tensor(-2.2595, dtype=torch.float64) tensor(4.7031, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-163.69937133789062
value loss:45.015281677246094
entropies:37.42984390258789
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.702741861343384 seconds
19 rew tensor(0.8188, dtype=torch.float64) delta_t tensor(-2.8079, dtype=torch.float64)
19 gae_duplicate tensor(-2.8079, dtype=torch.float64) tensor(5.8445, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7652, dtype=torch.float64) delta_t tensor(0.0405, dtype=torch.float64)
18 gae_duplicate tensor(-2.2058, dtype=torch.float64) tensor(4.5825, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7116, dtype=torch.float64) delta_t tensor(-0.0392, dtype=torch.float64)
17 gae_duplicate tensor(-1.8039, dtype=torch.float64) tensor(3.7476, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6039, dtype=torch.float64) delta_t tensor(-0.3862, dtype=torch.float64)
16 gae_duplicate tensor(-1.8293, dtype=torch.float64) tensor(3.8148, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3345, dtype=torch.float64) delta_t tensor(-0.0156, dtype=torch.float64)
15 gae_duplicate tensor(-1.4790, dtype=torch.float64) tensor(3.0726, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0110, dtype=torch.float64) delta_t tensor(-0.8204, dtype=torch.float64)
14 gae_duplicate tensor(-2.0036, dtype=torch.float64) tensor(4.1624, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8197, dtype=torch.float64) delta_t tensor(0.0967, dtype=torch.float64)
13 gae_duplicate tensor(-1.5061, dtype=torch.float64) tensor(3.1408, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8201, dtype=torch.float64) delta_t tensor(0.0971, dtype=torch.float64)
12 gae_duplicate tensor(-1.1078, dtype=torch.float64) tensor(2.3058, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7665, dtype=torch.float64) delta_t tensor(0.1836, dtype=torch.float64)
11 gae_duplicate tensor(-0.7026, dtype=torch.float64) tensor(1.4624, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7669, dtype=torch.float64) delta_t tensor(-0.0252, dtype=torch.float64)
10 gae_duplicate tensor(-0.5873, dtype=torch.float64) tensor(1.2201, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7118, dtype=torch.float64) delta_t tensor(-2.5497, dtype=torch.float64)
9 gae_duplicate tensor(-3.0196, dtype=torch.float64) tensor(6.2731, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7970, dtype=torch.float64) delta_t tensor(-1.1909, dtype=torch.float64)
8 gae_duplicate tensor(-3.6065, dtype=torch.float64) tensor(7.5066, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0965, dtype=torch.float64) delta_t tensor(-0.6625, dtype=torch.float64)
7 gae_duplicate tensor(-3.5477, dtype=torch.float64) tensor(7.3702, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2808, dtype=torch.float64) delta_t tensor(-0.2643, dtype=torch.float64)
6 gae_duplicate tensor(-3.1024, dtype=torch.float64) tensor(6.4574, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2580, dtype=torch.float64) delta_t tensor(1.9959, dtype=torch.float64)
5 gae_duplicate tensor(-0.4860, dtype=torch.float64) tensor(1.0097, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1503, dtype=torch.float64) delta_t tensor(0.0713, dtype=torch.float64)
4 gae_duplicate tensor(-0.3175, dtype=torch.float64) tensor(0.6583, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6889, dtype=torch.float64) delta_t tensor(-0.2844, dtype=torch.float64)
3 gae_duplicate tensor(-0.5383, dtype=torch.float64) tensor(1.1163, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4738, dtype=torch.float64) delta_t tensor(-2.4915, dtype=torch.float64)
2 gae_duplicate tensor(-2.9221, dtype=torch.float64) tensor(6.0705, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-420.0166931152344
value loss:125.08211517333984
entropies:37.42984390258789
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.428781032562256 seconds
19 rew tensor(0.7138, dtype=torch.float64) delta_t tensor(-2.9462, dtype=torch.float64)
19 gae_duplicate tensor(-2.9462, dtype=torch.float64) tensor(6.1439, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6062, dtype=torch.float64) delta_t tensor(-0.1288, dtype=torch.float64)
18 gae_duplicate tensor(-2.4857, dtype=torch.float64) tensor(5.1641, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4447, dtype=torch.float64) delta_t tensor(-0.4684, dtype=torch.float64)
17 gae_duplicate tensor(-2.4570, dtype=torch.float64) tensor(5.1043, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0134, dtype=torch.float64) delta_t tensor(-0.4336, dtype=torch.float64)
16 gae_duplicate tensor(-2.3992, dtype=torch.float64) tensor(4.9937, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.7412, dtype=torch.float64) delta_t tensor(-0.3953, dtype=torch.float64)
15 gae_duplicate tensor(-2.3146, dtype=torch.float64) tensor(4.7995, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8215, dtype=torch.float64) delta_t tensor(0.3272, dtype=torch.float64)
14 gae_duplicate tensor(-1.5245, dtype=torch.float64) tensor(3.1791, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8219, dtype=torch.float64) delta_t tensor(0.3276, dtype=torch.float64)
13 gae_duplicate tensor(-0.8920, dtype=torch.float64) tensor(1.8531, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8223, dtype=torch.float64) delta_t tensor(0.3116, dtype=torch.float64)
12 gae_duplicate tensor(-0.4020, dtype=torch.float64) tensor(0.8368, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6610, dtype=torch.float64) delta_t tensor(0.0744, dtype=torch.float64)
11 gae_duplicate tensor(-0.2472, dtype=torch.float64) tensor(0.5146, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4457, dtype=torch.float64) delta_t tensor(-1.0905, dtype=torch.float64)
10 gae_duplicate tensor(-1.2883, dtype=torch.float64) tensor(2.6714, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5776, dtype=torch.float64) delta_t tensor(-1.2840, dtype=torch.float64)
9 gae_duplicate tensor(-2.3147, dtype=torch.float64) tensor(4.8269, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.7088, dtype=torch.float64) delta_t tensor(-2.3064, dtype=torch.float64)
8 gae_duplicate tensor(-4.1581, dtype=torch.float64) tensor(8.6711, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7945, dtype=torch.float64) delta_t tensor(-1.4798, dtype=torch.float64)
7 gae_duplicate tensor(-4.8063, dtype=torch.float64) tensor(10.0039, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-3.1116, dtype=torch.float64) delta_t tensor(-1.4704, dtype=torch.float64)
6 gae_duplicate tensor(-5.3154, dtype=torch.float64) tensor(11.0428, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9604, dtype=torch.float64) delta_t tensor(-1.3857, dtype=torch.float64)
5 gae_duplicate tensor(-5.6380, dtype=torch.float64) tensor(11.7349, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9069, dtype=torch.float64) delta_t tensor(-1.2287, dtype=torch.float64)
4 gae_duplicate tensor(-5.7391, dtype=torch.float64) tensor(11.9229, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5833, dtype=torch.float64) delta_t tensor(0.2996, dtype=torch.float64)
3 gae_duplicate tensor(-4.2917, dtype=torch.float64) tensor(8.9158, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6915, dtype=torch.float64) delta_t tensor(-1.3778, dtype=torch.float64)
2 gae_duplicate tensor(-4.8111, dtype=torch.float64) tensor(9.9759, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-675.2500610351562
value loss:325.9547119140625
entropies:37.42984390258789
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.3859)
ToM Target loss= tensor(300.6331)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.525943040847778 seconds
19 rew tensor(0.8230, dtype=torch.float64) delta_t tensor(-1.7835, dtype=torch.float64)
19 gae_duplicate tensor(-1.7835, dtype=torch.float64) tensor(3.7122, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8234, dtype=torch.float64) delta_t tensor(0.3021, dtype=torch.float64)
18 gae_duplicate tensor(-1.1248, dtype=torch.float64) tensor(2.3411, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8237, dtype=torch.float64) delta_t tensor(0.3024, dtype=torch.float64)
17 gae_duplicate tensor(-0.5974, dtype=torch.float64) tensor(1.2434, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8241, dtype=torch.float64) delta_t tensor(-0.0246, dtype=torch.float64)
16 gae_duplicate tensor(-0.5025, dtype=torch.float64) tensor(1.0459, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8245, dtype=torch.float64) delta_t tensor(-0.5483, dtype=torch.float64)
15 gae_duplicate tensor(-0.9503, dtype=torch.float64) tensor(1.9704, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8248, dtype=torch.float64) delta_t tensor(0.2293, dtype=torch.float64)
14 gae_duplicate tensor(-0.5309, dtype=torch.float64) tensor(1.1009, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8252, dtype=torch.float64) delta_t tensor(0.3345, dtype=torch.float64)
13 gae_duplicate tensor(-0.0902, dtype=torch.float64) tensor(0.1878, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3393, dtype=torch.float64) delta_t tensor(1.1341, dtype=torch.float64)
12 gae_duplicate tensor(1.0619, dtype=torch.float64) tensor(-2.2104, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4474, dtype=torch.float64) delta_t tensor(0.0223, dtype=torch.float64)
11 gae_duplicate tensor(0.8719, dtype=torch.float64) tensor(-1.8113, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4476, dtype=torch.float64) delta_t tensor(0.3303, dtype=torch.float64)
10 gae_duplicate tensor(1.0278, dtype=torch.float64) tensor(-2.1393, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0922, dtype=torch.float64) delta_t tensor(-0.5133, dtype=torch.float64)
9 gae_duplicate tensor(0.3089, dtype=torch.float64) tensor(-0.6430, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2542, dtype=torch.float64) delta_t tensor(-0.7721, dtype=torch.float64)
8 gae_duplicate tensor(-0.5249, dtype=torch.float64) tensor(1.0946, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1177, dtype=torch.float64) delta_t tensor(-2.3949, dtype=torch.float64)
7 gae_duplicate tensor(-2.8148, dtype=torch.float64) tensor(5.8587, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2263, dtype=torch.float64) delta_t tensor(0.2334, dtype=torch.float64)
6 gae_duplicate tensor(-2.0184, dtype=torch.float64) tensor(4.2011, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0936, dtype=torch.float64) delta_t tensor(-0.3126, dtype=torch.float64)
5 gae_duplicate tensor(-1.9274, dtype=torch.float64) tensor(3.9965, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2268, dtype=torch.float64) delta_t tensor(-1.5696, dtype=torch.float64)
4 gae_duplicate tensor(-3.1115, dtype=torch.float64) tensor(6.4764, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4975, dtype=torch.float64) delta_t tensor(-1.8312, dtype=torch.float64)
3 gae_duplicate tensor(-4.3204, dtype=torch.float64) tensor(8.9585, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2031, dtype=torch.float64) delta_t tensor(-1.2968, dtype=torch.float64)
2 gae_duplicate tensor(-4.7531, dtype=torch.float64) tensor(9.8745, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-272.6717224121094
value loss:114.32217407226562
entropies:37.42984390258789
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.645643949508667 seconds
19 rew tensor(0.8228, dtype=torch.float64) delta_t tensor(-2.2679, dtype=torch.float64)
19 gae_duplicate tensor(-2.2679, dtype=torch.float64) tensor(4.7116, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8232, dtype=torch.float64) delta_t tensor(0.2531, dtype=torch.float64)
18 gae_duplicate tensor(-1.5612, dtype=torch.float64) tensor(3.2495, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8235, dtype=torch.float64) delta_t tensor(0.2917, dtype=torch.float64)
17 gae_duplicate tensor(-0.9573, dtype=torch.float64) tensor(1.9887, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8239, dtype=torch.float64) delta_t tensor(0.1632, dtype=torch.float64)
16 gae_duplicate tensor(-0.6026, dtype=torch.float64) tensor(1.2542, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8242, dtype=torch.float64) delta_t tensor(0.1848, dtype=torch.float64)
15 gae_duplicate tensor(-0.2973, dtype=torch.float64) tensor(0.6176, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8246, dtype=torch.float64) delta_t tensor(0.1081, dtype=torch.float64)
14 gae_duplicate tensor(-0.1297, dtype=torch.float64) tensor(0.2694, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8249, dtype=torch.float64) delta_t tensor(0.1979, dtype=torch.float64)
13 gae_duplicate tensor(0.0941, dtype=torch.float64) tensor(-0.1955, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8253, dtype=torch.float64) delta_t tensor(0.4048, dtype=torch.float64)
12 gae_duplicate tensor(0.4801, dtype=torch.float64) tensor(-0.9993, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8257, dtype=torch.float64) delta_t tensor(0.2168, dtype=torch.float64)
11 gae_duplicate tensor(0.6009, dtype=torch.float64) tensor(-1.2483, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8260, dtype=torch.float64) delta_t tensor(0.3364, dtype=torch.float64)
10 gae_duplicate tensor(0.8171, dtype=torch.float64) tensor(-1.7007, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3932, dtype=torch.float64) delta_t tensor(0.3492, dtype=torch.float64)
9 gae_duplicate tensor(1.0029, dtype=torch.float64) tensor(-2.0874, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4188, dtype=torch.float64) delta_t tensor(-1.4706, dtype=torch.float64)
8 gae_duplicate tensor(-0.6683, dtype=torch.float64) tensor(1.3857, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4189, dtype=torch.float64) delta_t tensor(0.0148, dtype=torch.float64)
7 gae_duplicate tensor(-0.5198, dtype=torch.float64) tensor(1.0799, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4732, dtype=torch.float64) delta_t tensor(-1.3806, dtype=torch.float64)
6 gae_duplicate tensor(-1.7964, dtype=torch.float64) tensor(3.7322, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2308, dtype=torch.float64) delta_t tensor(-0.0098, dtype=torch.float64)
5 gae_duplicate tensor(-1.4470, dtype=torch.float64) tensor(3.0061, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2835, dtype=torch.float64) delta_t tensor(0.0435, dtype=torch.float64)
4 gae_duplicate tensor(-1.1141, dtype=torch.float64) tensor(2.3146, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9066, dtype=torch.float64) delta_t tensor(-1.2038, dtype=torch.float64)
3 gae_duplicate tensor(-2.0951, dtype=torch.float64) tensor(4.3608, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2578, dtype=torch.float64) delta_t tensor(-0.5676, dtype=torch.float64)
2 gae_duplicate tensor(-2.2437, dtype=torch.float64) tensor(4.6614, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-159.52554321289062
value loss:41.9131965637207
entropies:37.42984390258789
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.3105998039245605 seconds
19 rew tensor(0.8215, dtype=torch.float64) delta_t tensor(-2.3609, dtype=torch.float64)
19 gae_duplicate tensor(-2.3609, dtype=torch.float64) tensor(4.9139, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7680, dtype=torch.float64) delta_t tensor(0.1475, dtype=torch.float64)
18 gae_duplicate tensor(-1.7412, dtype=torch.float64) tensor(3.6175, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7144, dtype=torch.float64) delta_t tensor(0.1165, dtype=torch.float64)
17 gae_duplicate tensor(-1.2765, dtype=torch.float64) tensor(2.6519, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6069, dtype=torch.float64) delta_t tensor(0.0187, dtype=torch.float64)
16 gae_duplicate tensor(-1.0024, dtype=torch.float64) tensor(2.0864, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3377, dtype=torch.float64) delta_t tensor(-0.0857, dtype=torch.float64)
15 gae_duplicate tensor(-0.8876, dtype=torch.float64) tensor(1.8407, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0146, dtype=torch.float64) delta_t tensor(-0.1445, dtype=torch.float64)
14 gae_duplicate tensor(-0.8546, dtype=torch.float64) tensor(1.7786, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1223, dtype=torch.float64) delta_t tensor(1.8262, dtype=torch.float64)
13 gae_duplicate tensor(1.1425, dtype=torch.float64) tensor(-2.3780, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7146, dtype=torch.float64) delta_t tensor(0.4294, dtype=torch.float64)
12 gae_duplicate tensor(1.3434, dtype=torch.float64) tensor(-2.7961, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8225, dtype=torch.float64) delta_t tensor(0.7210, dtype=torch.float64)
11 gae_duplicate tensor(1.7957, dtype=torch.float64) tensor(-3.7443, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8229, dtype=torch.float64) delta_t tensor(1.3920, dtype=torch.float64)
10 gae_duplicate tensor(2.8285, dtype=torch.float64) tensor(-5.8871, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4913, dtype=torch.float64) delta_t tensor(-1.8500, dtype=torch.float64)
9 gae_duplicate tensor(0.4128, dtype=torch.float64) tensor(-0.8592, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-5.0461, dtype=torch.float64) delta_t tensor(-6.8051, dtype=torch.float64)
8 gae_duplicate tensor(-6.4749, dtype=torch.float64) tensor(13.4763, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.9380, dtype=torch.float64) delta_t tensor(-1.9977, dtype=torch.float64)
7 gae_duplicate tensor(-7.1775, dtype=torch.float64) tensor(14.9390, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0658, dtype=torch.float64) delta_t tensor(-0.0639, dtype=torch.float64)
6 gae_duplicate tensor(-5.8059, dtype=torch.float64) tensor(12.1067, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0968, dtype=torch.float64) delta_t tensor(0.0382, dtype=torch.float64)
5 gae_duplicate tensor(-4.6065, dtype=torch.float64) tensor(9.5880, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9639, dtype=torch.float64) delta_t tensor(-0.0525, dtype=torch.float64)
4 gae_duplicate tensor(-3.7378, dtype=torch.float64) tensor(7.7797, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.6072, dtype=torch.float64) delta_t tensor(0.2006, dtype=torch.float64)
3 gae_duplicate tensor(-2.7896, dtype=torch.float64) tensor(5.8062, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3974, dtype=torch.float64) delta_t tensor(-0.4471, dtype=torch.float64)
2 gae_duplicate tensor(-2.6788, dtype=torch.float64) tensor(5.5759, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-424.09979248046875
value loss:306.84417724609375
entropies:37.42985534667969
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.291826009750366 seconds
19 rew tensor(0.8216, dtype=torch.float64) delta_t tensor(-0.8568, dtype=torch.float64)
19 gae_duplicate tensor(-0.8568, dtype=torch.float64) tensor(1.7834, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8219, dtype=torch.float64) delta_t tensor(-0.6419, dtype=torch.float64)
18 gae_duplicate tensor(-1.3274, dtype=torch.float64) tensor(2.7628, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8223, dtype=torch.float64) delta_t tensor(0.4411, dtype=torch.float64)
17 gae_duplicate tensor(-0.6208, dtype=torch.float64) tensor(1.2874, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8226, dtype=torch.float64) delta_t tensor(0.2973, dtype=torch.float64)
16 gae_duplicate tensor(-0.1993, dtype=torch.float64) tensor(0.4149, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8230, dtype=torch.float64) delta_t tensor(0.2977, dtype=torch.float64)
15 gae_duplicate tensor(0.1382, dtype=torch.float64) tensor(-0.2877, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8233, dtype=torch.float64) delta_t tensor(0.3115, dtype=torch.float64)
14 gae_duplicate tensor(0.4220, dtype=torch.float64) tensor(-0.8768, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8237, dtype=torch.float64) delta_t tensor(0.3761, dtype=torch.float64)
13 gae_duplicate tensor(0.7138, dtype=torch.float64) tensor(-1.4856, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6621, dtype=torch.float64) delta_t tensor(-0.0004, dtype=torch.float64)
12 gae_duplicate tensor(0.5707, dtype=torch.float64) tensor(-1.1878, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5004, dtype=torch.float64) delta_t tensor(0.0405, dtype=torch.float64)
11 gae_duplicate tensor(0.4970, dtype=torch.float64) tensor(-1.0345, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5005, dtype=torch.float64) delta_t tensor(0.1047, dtype=torch.float64)
10 gae_duplicate tensor(0.5023, dtype=torch.float64) tensor(-1.0474, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3388, dtype=torch.float64) delta_t tensor(-0.2468, dtype=torch.float64)
9 gae_duplicate tensor(0.1550, dtype=torch.float64) tensor(-0.3226, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0387, dtype=torch.float64) delta_t tensor(-0.4271, dtype=torch.float64)
8 gae_duplicate tensor(-0.3031, dtype=torch.float64) tensor(0.6298, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0927, dtype=torch.float64) delta_t tensor(0.0514, dtype=torch.float64)
7 gae_duplicate tensor(-0.1911, dtype=torch.float64) tensor(0.3970, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7937, dtype=torch.float64) delta_t tensor(-1.7663, dtype=torch.float64)
6 gae_duplicate tensor(-1.9192, dtype=torch.float64) tensor(3.9873, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3871, dtype=torch.float64) delta_t tensor(0.2419, dtype=torch.float64)
5 gae_duplicate tensor(-1.2935, dtype=torch.float64) tensor(2.6922, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.6072, dtype=torch.float64) delta_t tensor(0.5712, dtype=torch.float64)
4 gae_duplicate tensor(-0.4635, dtype=torch.float64) tensor(0.9612, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2258, dtype=torch.float64) delta_t tensor(-0.7489, dtype=torch.float64)
3 gae_duplicate tensor(-1.1198, dtype=torch.float64) tensor(2.3307, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1727, dtype=torch.float64) delta_t tensor(-1.9221, dtype=torch.float64)
2 gae_duplicate tensor(-2.8179, dtype=torch.float64) tensor(5.8434, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-102.20928192138672
value loss:29.05710220336914
entropies:37.429847717285156
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.491115093231201 seconds
19 rew tensor(-1.1779, dtype=torch.float64) delta_t tensor(-2.8214, dtype=torch.float64)
19 gae_duplicate tensor(-2.8214, dtype=torch.float64) tensor(5.8724, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8231, dtype=torch.float64) delta_t tensor(0.4944, dtype=torch.float64)
18 gae_duplicate tensor(-1.7627, dtype=torch.float64) tensor(3.6688, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8235, dtype=torch.float64) delta_t tensor(0.4948, dtype=torch.float64)
17 gae_duplicate tensor(-0.9154, dtype=torch.float64) tensor(1.8982, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8238, dtype=torch.float64) delta_t tensor(0.4951, dtype=torch.float64)
16 gae_duplicate tensor(-0.2372, dtype=torch.float64) tensor(0.4928, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7701, dtype=torch.float64) delta_t tensor(0.5290, dtype=torch.float64)
15 gae_duplicate tensor(0.3393, dtype=torch.float64) tensor(-0.7049, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7704, dtype=torch.float64) delta_t tensor(-0.7780, dtype=torch.float64)
14 gae_duplicate tensor(-0.5065, dtype=torch.float64) tensor(1.0543, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6085, dtype=torch.float64) delta_t tensor(0.2188, dtype=torch.float64)
13 gae_duplicate tensor(-0.1865, dtype=torch.float64) tensor(0.3881, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5546, dtype=torch.float64) delta_t tensor(0.1389, dtype=torch.float64)
12 gae_duplicate tensor(-0.0103, dtype=torch.float64) tensor(0.0214, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8251, dtype=torch.float64) delta_t tensor(0.3221, dtype=torch.float64)
11 gae_duplicate tensor(0.3138, dtype=torch.float64) tensor(-0.6520, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3638, dtype=torch.float64) delta_t tensor(-0.1279, dtype=torch.float64)
10 gae_duplicate tensor(0.1232, dtype=torch.float64) tensor(-0.2559, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4468, dtype=torch.float64) delta_t tensor(0.0549, dtype=torch.float64)
9 gae_duplicate tensor(0.1534, dtype=torch.float64) tensor(-0.3187, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1227, dtype=torch.float64) delta_t tensor(0.4322, dtype=torch.float64)
8 gae_duplicate tensor(0.5549, dtype=torch.float64) tensor(-1.1549, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5795, dtype=torch.float64) delta_t tensor(-0.4890, dtype=torch.float64)
7 gae_duplicate tensor(-0.0450, dtype=torch.float64) tensor(0.0937, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2278, dtype=torch.float64) delta_t tensor(-2.0188, dtype=torch.float64)
6 gae_duplicate tensor(-2.0548, dtype=torch.float64) tensor(4.2691, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4987, dtype=torch.float64) delta_t tensor(0.2172, dtype=torch.float64)
5 gae_duplicate tensor(-1.4266, dtype=torch.float64) tensor(2.9693, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2571, dtype=torch.float64) delta_t tensor(-0.5656, dtype=torch.float64)
4 gae_duplicate tensor(-1.7069, dtype=torch.float64) tensor(3.5460, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9595, dtype=torch.float64) delta_t tensor(-0.4934, dtype=torch.float64)
3 gae_duplicate tensor(-1.8589, dtype=torch.float64) tensor(3.8764, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7162, dtype=torch.float64) delta_t tensor(-1.6149, dtype=torch.float64)
2 gae_duplicate tensor(-3.1020, dtype=torch.float64) tensor(6.4564, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-190.24478149414062
value loss:52.59636688232422
entropies:37.429847717285156
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.4327)
ToM Target loss= tensor(301.2885)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.40681791305542 seconds
19 rew tensor(0.8213, dtype=torch.float64) delta_t tensor(-1.2214, dtype=torch.float64)
19 gae_duplicate tensor(-1.2214, dtype=torch.float64) tensor(2.5328, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8216, dtype=torch.float64) delta_t tensor(0.4302, dtype=torch.float64)
18 gae_duplicate tensor(-0.5470, dtype=torch.float64) tensor(1.1384, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8220, dtype=torch.float64) delta_t tensor(0.4985, dtype=torch.float64)
17 gae_duplicate tensor(0.0609, dtype=torch.float64) tensor(-0.1267, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8223, dtype=torch.float64) delta_t tensor(-0.0054, dtype=torch.float64)
16 gae_duplicate tensor(0.0433, dtype=torch.float64) tensor(-0.0898, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8227, dtype=torch.float64) delta_t tensor(0.5109, dtype=torch.float64)
15 gae_duplicate tensor(0.5455, dtype=torch.float64) tensor(-1.1354, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8230, dtype=torch.float64) delta_t tensor(0.3717, dtype=torch.float64)
14 gae_duplicate tensor(0.8081, dtype=torch.float64) tensor(-1.6758, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8233, dtype=torch.float64) delta_t tensor(0.3461, dtype=torch.float64)
13 gae_duplicate tensor(0.9926, dtype=torch.float64) tensor(-2.0661, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3393, dtype=torch.float64) delta_t tensor(-0.0772, dtype=torch.float64)
12 gae_duplicate tensor(0.7169, dtype=torch.float64) tensor(-1.4922, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3394, dtype=torch.float64) delta_t tensor(-0.0652, dtype=torch.float64)
11 gae_duplicate tensor(0.5083, dtype=torch.float64) tensor(-1.0561, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2857, dtype=torch.float64) delta_t tensor(0.6010, dtype=torch.float64)
10 gae_duplicate tensor(1.0077, dtype=torch.float64) tensor(-2.0935, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2858, dtype=torch.float64) delta_t tensor(-0.8463, dtype=torch.float64)
9 gae_duplicate tensor(-0.0401, dtype=torch.float64) tensor(0.0835, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0708, dtype=torch.float64) delta_t tensor(-0.2280, dtype=torch.float64)
8 gae_duplicate tensor(-0.2601, dtype=torch.float64) tensor(0.5404, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5742, dtype=torch.float64) delta_t tensor(-0.2166, dtype=torch.float64)
7 gae_duplicate tensor(-0.4247, dtype=torch.float64) tensor(0.8856, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.1330, dtype=torch.float64) delta_t tensor(-1.0743, dtype=torch.float64)
6 gae_duplicate tensor(-1.4141, dtype=torch.float64) tensor(2.9325, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8132, dtype=torch.float64) delta_t tensor(-1.8016, dtype=torch.float64)
5 gae_duplicate tensor(-2.9329, dtype=torch.float64) tensor(6.0931, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.9908, dtype=torch.float64) delta_t tensor(-5.2719, dtype=torch.float64)
4 gae_duplicate tensor(-7.6182, dtype=torch.float64) tensor(15.8268, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0417, dtype=torch.float64) delta_t tensor(0.7539, dtype=torch.float64)
3 gae_duplicate tensor(-5.3407, dtype=torch.float64) tensor(11.1370, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2041, dtype=torch.float64) delta_t tensor(0.5760, dtype=torch.float64)
2 gae_duplicate tensor(-3.6966, dtype=torch.float64) tensor(7.6655, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-235.72323608398438
value loss:174.89596557617188
entropies:37.429847717285156
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.47697114944458 seconds
19 rew tensor(0.8240, dtype=torch.float64) delta_t tensor(-0.6091, dtype=torch.float64)
19 gae_duplicate tensor(-0.6091, dtype=torch.float64) tensor(1.2678, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8244, dtype=torch.float64) delta_t tensor(0.5377, dtype=torch.float64)
18 gae_duplicate tensor(0.0504, dtype=torch.float64) tensor(-0.1049, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7708, dtype=torch.float64) delta_t tensor(0.3597, dtype=torch.float64)
17 gae_duplicate tensor(0.4000, dtype=torch.float64) tensor(-0.8310, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7171, dtype=torch.float64) delta_t tensor(-0.3684, dtype=torch.float64)
16 gae_duplicate tensor(-0.0484, dtype=torch.float64) tensor(0.1005, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6095, dtype=torch.float64) delta_t tensor(0.3145, dtype=torch.float64)
15 gae_duplicate tensor(0.2758, dtype=torch.float64) tensor(-0.5719, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5019, dtype=torch.float64) delta_t tensor(0.1729, dtype=torch.float64)
14 gae_duplicate tensor(0.3936, dtype=torch.float64) tensor(-0.8176, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2326, dtype=torch.float64) delta_t tensor(-0.3353, dtype=torch.float64)
13 gae_duplicate tensor(-0.0204, dtype=torch.float64) tensor(0.0426, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6099, dtype=torch.float64) delta_t tensor(0.4279, dtype=torch.float64)
12 gae_duplicate tensor(0.4116, dtype=torch.float64) tensor(-0.8551, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2521, dtype=torch.float64) delta_t tensor(-0.6426, dtype=torch.float64)
11 gae_duplicate tensor(-0.3134, dtype=torch.float64) tensor(0.6522, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.3296, dtype=torch.float64) delta_t tensor(-1.7201, dtype=torch.float64)
10 gae_duplicate tensor(-1.9708, dtype=torch.float64) tensor(4.0945, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3606, dtype=torch.float64) delta_t tensor(-0.6924, dtype=torch.float64)
9 gae_duplicate tensor(-2.2691, dtype=torch.float64) tensor(4.7141, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4473, dtype=torch.float64) delta_t tensor(1.5623, dtype=torch.float64)
8 gae_duplicate tensor(-0.2530, dtype=torch.float64) tensor(0.5275, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0166, dtype=torch.float64) delta_t tensor(-1.3352, dtype=torch.float64)
7 gae_duplicate tensor(-1.5376, dtype=torch.float64) tensor(3.1944, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7372, dtype=torch.float64) delta_t tensor(0.7432, dtype=torch.float64)
6 gae_duplicate tensor(-0.4869, dtype=torch.float64) tensor(1.0134, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9529, dtype=torch.float64) delta_t tensor(-1.1968, dtype=torch.float64)
5 gae_duplicate tensor(-1.5863, dtype=torch.float64) tensor(3.2895, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6303, dtype=torch.float64) delta_t tensor(-0.0708, dtype=torch.float64)
4 gae_duplicate tensor(-1.3398, dtype=torch.float64) tensor(2.7938, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7610, dtype=torch.float64) delta_t tensor(-1.1534, dtype=torch.float64)
3 gae_duplicate tensor(-2.2253, dtype=torch.float64) tensor(4.6315, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6317, dtype=torch.float64) delta_t tensor(-0.6718, dtype=torch.float64)
2 gae_duplicate tensor(-2.4520, dtype=torch.float64) tensor(5.0940, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-170.53363037109375
value loss:42.01299285888672
entropies:37.42984390258789
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.642498970031738 seconds
19 rew tensor(0.8244, dtype=torch.float64) delta_t tensor(0.0127, dtype=torch.float64)
19 gae_duplicate tensor(0.0127, dtype=torch.float64) tensor(-0.0263, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8248, dtype=torch.float64) delta_t tensor(0.7025, dtype=torch.float64)
18 gae_duplicate tensor(0.7126, dtype=torch.float64) tensor(-1.4805, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8251, dtype=torch.float64) delta_t tensor(0.6646, dtype=torch.float64)
17 gae_duplicate tensor(1.2347, dtype=torch.float64) tensor(-2.5651, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8254, dtype=torch.float64) delta_t tensor(-0.3048, dtype=torch.float64)
16 gae_duplicate tensor(0.6829, dtype=torch.float64) tensor(-1.4214, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8258, dtype=torch.float64) delta_t tensor(0.5078, dtype=torch.float64)
15 gae_duplicate tensor(1.0541, dtype=torch.float64) tensor(-2.1940, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8261, dtype=torch.float64) delta_t tensor(0.5021, dtype=torch.float64)
14 gae_duplicate tensor(1.3454, dtype=torch.float64) tensor(-2.8002, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5025, dtype=torch.float64) delta_t tensor(0.2846, dtype=torch.float64)
13 gae_duplicate tensor(1.3609, dtype=torch.float64) tensor(-2.8377, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3947, dtype=torch.float64) delta_t tensor(0.2825, dtype=torch.float64)
12 gae_duplicate tensor(1.3713, dtype=torch.float64) tensor(-2.8488, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6107, dtype=torch.float64) delta_t tensor(0.3970, dtype=torch.float64)
11 gae_duplicate tensor(1.4940, dtype=torch.float64) tensor(-3.1096, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5569, dtype=torch.float64) delta_t tensor(1.2882, dtype=torch.float64)
10 gae_duplicate tensor(2.4834, dtype=torch.float64) tensor(-5.1595, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1795, dtype=torch.float64) delta_t tensor(-0.2177, dtype=torch.float64)
9 gae_duplicate tensor(1.7691, dtype=torch.float64) tensor(-3.6754, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4677, dtype=torch.float64) delta_t tensor(-1.3067, dtype=torch.float64)
8 gae_duplicate tensor(0.1086, dtype=torch.float64) tensor(-0.2260, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1149, dtype=torch.float64) delta_t tensor(-0.1582, dtype=torch.float64)
7 gae_duplicate tensor(-0.0713, dtype=torch.float64) tensor(0.1481, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3312, dtype=torch.float64) delta_t tensor(-1.7221, dtype=torch.float64)
6 gae_duplicate tensor(-1.7791, dtype=torch.float64) tensor(3.6961, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0333, dtype=torch.float64) delta_t tensor(-1.3853, dtype=torch.float64)
5 gae_duplicate tensor(-2.8086, dtype=torch.float64) tensor(5.8350, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5011, dtype=torch.float64) delta_t tensor(0.7214, dtype=torch.float64)
4 gae_duplicate tensor(-1.5255, dtype=torch.float64) tensor(3.1634, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4416, dtype=torch.float64) delta_t tensor(-1.4933, dtype=torch.float64)
3 gae_duplicate tensor(-2.7136, dtype=torch.float64) tensor(5.6481, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0689, dtype=torch.float64) delta_t tensor(-0.7697, dtype=torch.float64)
2 gae_duplicate tensor(-2.9406, dtype=torch.float64) tensor(6.1203, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:21.277647018432617
value loss:75.13583374023438
entropies:37.429847717285156
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.441289186477661 seconds
19 rew tensor(0.8259, dtype=torch.float64) delta_t tensor(-0.1613, dtype=torch.float64)
19 gae_duplicate tensor(-0.1613, dtype=torch.float64) tensor(0.3358, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8263, dtype=torch.float64) delta_t tensor(0.6838, dtype=torch.float64)
18 gae_duplicate tensor(0.5547, dtype=torch.float64) tensor(-1.1524, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8266, dtype=torch.float64) delta_t tensor(0.6950, dtype=torch.float64)
17 gae_duplicate tensor(1.1388, dtype=torch.float64) tensor(-2.3702, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8269, dtype=torch.float64) delta_t tensor(0.6515, dtype=torch.float64)
16 gae_duplicate tensor(1.5625, dtype=torch.float64) tensor(-3.2579, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8273, dtype=torch.float64) delta_t tensor(0.7777, dtype=torch.float64)
15 gae_duplicate tensor(2.0277, dtype=torch.float64) tensor(-4.2128, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8276, dtype=torch.float64) delta_t tensor(-0.0106, dtype=torch.float64)
14 gae_duplicate tensor(1.6116, dtype=torch.float64) tensor(-3.3482, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3951, dtype=torch.float64) delta_t tensor(0.7970, dtype=torch.float64)
13 gae_duplicate tensor(2.0863, dtype=torch.float64) tensor(-4.3424, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1789, dtype=torch.float64) delta_t tensor(-0.2472, dtype=torch.float64)
12 gae_duplicate tensor(1.4218, dtype=torch.float64) tensor(-2.9484, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2871, dtype=torch.float64) delta_t tensor(0.0057, dtype=torch.float64)
11 gae_duplicate tensor(1.1431, dtype=torch.float64) tensor(-2.3749, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2872, dtype=torch.float64) delta_t tensor(0.1138, dtype=torch.float64)
10 gae_duplicate tensor(1.0283, dtype=torch.float64) tensor(-2.1403, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5236, dtype=torch.float64) delta_t tensor(0.3078, dtype=torch.float64)
9 gae_duplicate tensor(1.1305, dtype=torch.float64) tensor(-2.3486, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4491, dtype=torch.float64) delta_t tensor(0.5077, dtype=torch.float64)
8 gae_duplicate tensor(1.4120, dtype=torch.float64) tensor(-2.9283, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0911, dtype=torch.float64) delta_t tensor(-0.6163, dtype=torch.float64)
7 gae_duplicate tensor(0.5134, dtype=torch.float64) tensor(-1.0685, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2532, dtype=torch.float64) delta_t tensor(-0.1252, dtype=torch.float64)
6 gae_duplicate tensor(0.2855, dtype=torch.float64) tensor(-0.5943, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2254, dtype=torch.float64) delta_t tensor(-0.5644, dtype=torch.float64)
5 gae_duplicate tensor(-0.3359, dtype=torch.float64) tensor(0.6992, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6583, dtype=torch.float64) delta_t tensor(-0.8507, dtype=torch.float64)
4 gae_duplicate tensor(-1.1194, dtype=torch.float64) tensor(2.3299, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4710, dtype=torch.float64) delta_t tensor(-0.3026, dtype=torch.float64)
3 gae_duplicate tensor(-1.1981, dtype=torch.float64) tensor(2.4846, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2275, dtype=torch.float64) delta_t tensor(-1.2326, dtype=torch.float64)
2 gae_duplicate tensor(-2.1911, dtype=torch.float64) tensor(4.5688, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:134.89015197753906
value loss:46.107177734375
entropies:37.42985534667969
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.368850946426392 seconds
19 rew tensor(0.8262, dtype=torch.float64) delta_t tensor(-0.2854, dtype=torch.float64)
19 gae_duplicate tensor(-0.2854, dtype=torch.float64) tensor(0.5941, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8265, dtype=torch.float64) delta_t tensor(1.1779, dtype=torch.float64)
18 gae_duplicate tensor(0.9495, dtype=torch.float64) tensor(-1.9763, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7729, dtype=torch.float64) delta_t tensor(-0.3527, dtype=torch.float64)
17 gae_duplicate tensor(0.4070, dtype=torch.float64) tensor(-0.8486, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7193, dtype=torch.float64) delta_t tensor(0.4666, dtype=torch.float64)
16 gae_duplicate tensor(0.7921, dtype=torch.float64) tensor(-1.6457, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6656, dtype=torch.float64) delta_t tensor(0.4183, dtype=torch.float64)
15 gae_duplicate tensor(1.0520, dtype=torch.float64) tensor(-2.1896, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5041, dtype=torch.float64) delta_t tensor(0.6637, dtype=torch.float64)
14 gae_duplicate tensor(1.5053, dtype=torch.float64) tensor(-3.1331, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5582, dtype=torch.float64) delta_t tensor(0.0124, dtype=torch.float64)
13 gae_duplicate tensor(1.2166, dtype=torch.float64) tensor(-2.5322, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6123, dtype=torch.float64) delta_t tensor(0.3748, dtype=torch.float64)
12 gae_duplicate tensor(1.3481, dtype=torch.float64) tensor(-2.8059, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6125, dtype=torch.float64) delta_t tensor(0.3277, dtype=torch.float64)
11 gae_duplicate tensor(1.4062, dtype=torch.float64) tensor(-2.9267, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5588, dtype=torch.float64) delta_t tensor(0.3449, dtype=torch.float64)
10 gae_duplicate tensor(1.4698, dtype=torch.float64) tensor(-3.0592, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5051, dtype=torch.float64) delta_t tensor(0.2008, dtype=torch.float64)
9 gae_duplicate tensor(1.3766, dtype=torch.float64) tensor(-2.8652, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4642, dtype=torch.float64) delta_t tensor(0.3404, dtype=torch.float64)
8 gae_duplicate tensor(1.4417, dtype=torch.float64) tensor(-2.9897, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.8644, dtype=torch.float64) delta_t tensor(-1.8146, dtype=torch.float64)
7 gae_duplicate tensor(-0.6613, dtype=torch.float64) tensor(1.3738, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.1358, dtype=torch.float64) delta_t tensor(-1.3012, dtype=torch.float64)
6 gae_duplicate tensor(-1.8303, dtype=torch.float64) tensor(3.8094, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-3.0015, dtype=torch.float64) delta_t tensor(-3.0205, dtype=torch.float64)
5 gae_duplicate tensor(-4.4847, dtype=torch.float64) tensor(9.3175, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1708, dtype=torch.float64) delta_t tensor(-2.2114, dtype=torch.float64)
4 gae_duplicate tensor(-5.7992, dtype=torch.float64) tensor(12.0921, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6884, dtype=torch.float64) delta_t tensor(0.5095, dtype=torch.float64)
3 gae_duplicate tensor(-4.1298, dtype=torch.float64) tensor(8.5955, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7428, dtype=torch.float64) delta_t tensor(-0.3186, dtype=torch.float64)
2 gae_duplicate tensor(-3.6224, dtype=torch.float64) tensor(7.5257, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-99.13788604736328
value loss:156.39700317382812
entropies:37.42985534667969
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.7654)
ToM Target loss= tensor(301.2209)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.725640058517456 seconds
19 rew tensor(0.8257, dtype=torch.float64) delta_t tensor(-0.5870, dtype=torch.float64)
19 gae_duplicate tensor(-0.5870, dtype=torch.float64) tensor(1.2218, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8260, dtype=torch.float64) delta_t tensor(0.5272, dtype=torch.float64)
18 gae_duplicate tensor(0.0576, dtype=torch.float64) tensor(-0.1194, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8264, dtype=torch.float64) delta_t tensor(0.4937, dtype=torch.float64)
17 gae_duplicate tensor(0.5397, dtype=torch.float64) tensor(-1.1213, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8267, dtype=torch.float64) delta_t tensor(0.4548, dtype=torch.float64)
16 gae_duplicate tensor(0.8866, dtype=torch.float64) tensor(-1.8419, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8270, dtype=torch.float64) delta_t tensor(0.9291, dtype=torch.float64)
15 gae_duplicate tensor(1.6383, dtype=torch.float64) tensor(-3.4099, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8273, dtype=torch.float64) delta_t tensor(1.1720, dtype=torch.float64)
14 gae_duplicate tensor(2.4827, dtype=torch.float64) tensor(-5.1768, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8277, dtype=torch.float64) delta_t tensor(0.7142, dtype=torch.float64)
13 gae_duplicate tensor(2.7004, dtype=torch.float64) tensor(-5.6103, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8280, dtype=torch.float64) delta_t tensor(0.7145, dtype=torch.float64)
12 gae_duplicate tensor(2.8748, dtype=torch.float64) tensor(-5.9944, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8283, dtype=torch.float64) delta_t tensor(0.7149, dtype=torch.float64)
11 gae_duplicate tensor(3.0147, dtype=torch.float64) tensor(-6.2746, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8287, dtype=torch.float64) delta_t tensor(0.3304, dtype=torch.float64)
10 gae_duplicate tensor(2.7422, dtype=torch.float64) tensor(-5.6971, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5184, dtype=torch.float64) delta_t tensor(-1.1929, dtype=torch.float64)
9 gae_duplicate tensor(1.0009, dtype=torch.float64) tensor(-2.0794, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.7579, dtype=torch.float64) delta_t tensor(-1.7034, dtype=torch.float64)
8 gae_duplicate tensor(-0.9027, dtype=torch.float64) tensor(1.8753, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2891, dtype=torch.float64) delta_t tensor(0.3338, dtype=torch.float64)
7 gae_duplicate tensor(-0.3883, dtype=torch.float64) tensor(0.8097, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.2980, dtype=torch.float64) delta_t tensor(-2.2488, dtype=torch.float64)
6 gae_duplicate tensor(-2.5594, dtype=torch.float64) tensor(5.3173, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0317, dtype=torch.float64) delta_t tensor(-1.6995, dtype=torch.float64)
5 gae_duplicate tensor(-3.7470, dtype=torch.float64) tensor(7.7846, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1796, dtype=torch.float64) delta_t tensor(1.5001, dtype=torch.float64)
4 gae_duplicate tensor(-1.4975, dtype=torch.float64) tensor(3.1112, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0717, dtype=torch.float64) delta_t tensor(1.2071, dtype=torch.float64)
3 gae_duplicate tensor(0.0091, dtype=torch.float64) tensor(-0.0189, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3601, dtype=torch.float64) delta_t tensor(-0.1730, dtype=torch.float64)
2 gae_duplicate tensor(-0.1657, dtype=torch.float64) tensor(0.3449, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:100.15205383300781
value loss:100.9002914428711
entropies:37.429847717285156
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.529401779174805 seconds
19 rew tensor(0.8266, dtype=torch.float64) delta_t tensor(1.4595, dtype=torch.float64)
19 gae_duplicate tensor(1.4595, dtype=torch.float64) tensor(-3.0320, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8269, dtype=torch.float64) delta_t tensor(-1.0119, dtype=torch.float64)
18 gae_duplicate tensor(0.1557, dtype=torch.float64) tensor(-0.3234, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8273, dtype=torch.float64) delta_t tensor(0.6224, dtype=torch.float64)
17 gae_duplicate tensor(0.7470, dtype=torch.float64) tensor(-1.5546, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8276, dtype=torch.float64) delta_t tensor(0.6316, dtype=torch.float64)
16 gae_duplicate tensor(1.2291, dtype=torch.float64) tensor(-2.5582, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8279, dtype=torch.float64) delta_t tensor(0.4837, dtype=torch.float64)
15 gae_duplicate tensor(1.4670, dtype=torch.float64) tensor(-3.0477, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8283, dtype=torch.float64) delta_t tensor(0.5852, dtype=torch.float64)
14 gae_duplicate tensor(1.7588, dtype=torch.float64) tensor(-3.6673, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8286, dtype=torch.float64) delta_t tensor(0.6134, dtype=torch.float64)
13 gae_duplicate tensor(2.0204, dtype=torch.float64) tensor(-4.2051, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8289, dtype=torch.float64) delta_t tensor(0.6171, dtype=torch.float64)
12 gae_duplicate tensor(2.2334, dtype=torch.float64) tensor(-4.6569, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3973, dtype=torch.float64) delta_t tensor(0.2581, dtype=torch.float64)
11 gae_duplicate tensor(2.0448, dtype=torch.float64) tensor(-4.2560, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2894, dtype=torch.float64) delta_t tensor(0.2661, dtype=torch.float64)
10 gae_duplicate tensor(1.9019, dtype=torch.float64) tensor(-3.9514, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0736, dtype=torch.float64) delta_t tensor(1.1685, dtype=torch.float64)
9 gae_duplicate tensor(2.6900, dtype=torch.float64) tensor(-5.6091, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0736, dtype=torch.float64) delta_t tensor(-0.0948, dtype=torch.float64)
8 gae_duplicate tensor(2.0572, dtype=torch.float64) tensor(-4.2739, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8974, dtype=torch.float64) delta_t tensor(-0.0781, dtype=torch.float64)
7 gae_duplicate tensor(1.5677, dtype=torch.float64) tensor(-3.2570, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0597, dtype=torch.float64) delta_t tensor(-1.0179, dtype=torch.float64)
6 gae_duplicate tensor(0.2363, dtype=torch.float64) tensor(-0.4899, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0891, dtype=torch.float64) delta_t tensor(0.2261, dtype=torch.float64)
5 gae_duplicate tensor(0.4151, dtype=torch.float64) tensor(-0.8624, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3297, dtype=torch.float64) delta_t tensor(-0.3222, dtype=torch.float64)
4 gae_duplicate tensor(0.0099, dtype=torch.float64) tensor(-0.0205, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6003, dtype=torch.float64) delta_t tensor(-0.9541, dtype=torch.float64)
3 gae_duplicate tensor(-0.9462, dtype=torch.float64) tensor(1.9658, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4683, dtype=torch.float64) delta_t tensor(-0.9522, dtype=torch.float64)
2 gae_duplicate tensor(-1.7091, dtype=torch.float64) tensor(3.5508, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:240.369140625
value loss:66.4611587524414
entropies:37.42985534667969
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.566793918609619 seconds
19 rew tensor(0.8267, dtype=torch.float64) delta_t tensor(-0.6499, dtype=torch.float64)
19 gae_duplicate tensor(-0.6499, dtype=torch.float64) tensor(1.3526, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8270, dtype=torch.float64) delta_t tensor(1.0515, dtype=torch.float64)
18 gae_duplicate tensor(0.5316, dtype=torch.float64) tensor(-1.1025, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8273, dtype=torch.float64) delta_t tensor(0.8733, dtype=torch.float64)
17 gae_duplicate tensor(1.2986, dtype=torch.float64) tensor(-2.7027, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8276, dtype=torch.float64) delta_t tensor(0.6838, dtype=torch.float64)
16 gae_duplicate tensor(1.7226, dtype=torch.float64) tensor(-3.5789, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8280, dtype=torch.float64) delta_t tensor(0.7968, dtype=torch.float64)
15 gae_duplicate tensor(2.1749, dtype=torch.float64) tensor(-4.5185, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8283, dtype=torch.float64) delta_t tensor(0.7910, dtype=torch.float64)
14 gae_duplicate tensor(2.5309, dtype=torch.float64) tensor(-5.2582, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8286, dtype=torch.float64) delta_t tensor(0.9431, dtype=torch.float64)
13 gae_duplicate tensor(2.9678, dtype=torch.float64) tensor(-6.1659, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8289, dtype=torch.float64) delta_t tensor(-0.0837, dtype=torch.float64)
12 gae_duplicate tensor(2.2906, dtype=torch.float64) tensor(-4.7589, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3963, dtype=torch.float64) delta_t tensor(0.1813, dtype=torch.float64)
11 gae_duplicate tensor(2.0138, dtype=torch.float64) tensor(-4.1763, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3964, dtype=torch.float64) delta_t tensor(0.4047, dtype=torch.float64)
10 gae_duplicate tensor(2.0157, dtype=torch.float64) tensor(-4.1953, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1801, dtype=torch.float64) delta_t tensor(1.2081, dtype=torch.float64)
9 gae_duplicate tensor(2.8207, dtype=torch.float64) tensor(-5.8496, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0178, dtype=torch.float64) delta_t tensor(0.5548, dtype=torch.float64)
8 gae_duplicate tensor(2.8114, dtype=torch.float64) tensor(-5.8513, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0363, dtype=torch.float64) delta_t tensor(-0.6133, dtype=torch.float64)
7 gae_duplicate tensor(1.6358, dtype=torch.float64) tensor(-3.4107, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5769, dtype=torch.float64) delta_t tensor(0.0752, dtype=torch.float64)
6 gae_duplicate tensor(1.3839, dtype=torch.float64) tensor(-2.8751, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2799, dtype=torch.float64) delta_t tensor(0.1633, dtype=torch.float64)
5 gae_duplicate tensor(1.2704, dtype=torch.float64) tensor(-2.6346, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.6657, dtype=torch.float64) delta_t tensor(0.2648, dtype=torch.float64)
4 gae_duplicate tensor(1.2811, dtype=torch.float64) tensor(-2.6664, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9018, dtype=torch.float64) delta_t tensor(-0.2352, dtype=torch.float64)
3 gae_duplicate tensor(0.7897, dtype=torch.float64) tensor(-1.6407, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6859, dtype=torch.float64) delta_t tensor(-0.3157, dtype=torch.float64)
2 gae_duplicate tensor(0.3160, dtype=torch.float64) tensor(-0.6590, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:363.0282287597656
value loss:94.64569854736328
entropies:37.42986297607422
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.517129898071289 seconds
19 rew tensor(0.7734, dtype=torch.float64) delta_t tensor(-0.5481, dtype=torch.float64)
19 gae_duplicate tensor(-0.5481, dtype=torch.float64) tensor(1.1428, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7197, dtype=torch.float64) delta_t tensor(0.4495, dtype=torch.float64)
18 gae_duplicate tensor(0.0110, dtype=torch.float64) tensor(-0.0229, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6119, dtype=torch.float64) delta_t tensor(0.0860, dtype=torch.float64)
17 gae_duplicate tensor(0.0948, dtype=torch.float64) tensor(-0.1974, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2881, dtype=torch.float64) delta_t tensor(0.2498, dtype=torch.float64)
16 gae_duplicate tensor(0.3257, dtype=torch.float64) tensor(-0.6766, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1437, dtype=torch.float64) delta_t tensor(0.1592, dtype=torch.float64)
15 gae_duplicate tensor(0.4197, dtype=torch.float64) tensor(-0.8735, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2341, dtype=torch.float64) delta_t tensor(0.4064, dtype=torch.float64)
14 gae_duplicate tensor(0.7422, dtype=torch.float64) tensor(-1.5419, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8278, dtype=torch.float64) delta_t tensor(0.7487, dtype=torch.float64)
13 gae_duplicate tensor(1.3424, dtype=torch.float64) tensor(-2.7891, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7741, dtype=torch.float64) delta_t tensor(0.6826, dtype=torch.float64)
12 gae_duplicate tensor(1.7565, dtype=torch.float64) tensor(-3.6494, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7204, dtype=torch.float64) delta_t tensor(2.1031, dtype=torch.float64)
11 gae_duplicate tensor(3.5083, dtype=torch.float64) tensor(-7.3147, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5049, dtype=torch.float64) delta_t tensor(-1.0891, dtype=torch.float64)
10 gae_duplicate tensor(1.7175, dtype=torch.float64) tensor(-3.5748, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6526, dtype=torch.float64) delta_t tensor(-2.2093, dtype=torch.float64)
9 gae_duplicate tensor(-0.8352, dtype=torch.float64) tensor(1.7353, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6827, dtype=torch.float64) delta_t tensor(-0.5603, dtype=torch.float64)
8 gae_duplicate tensor(-1.2285, dtype=torch.float64) tensor(2.5569, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7909, dtype=torch.float64) delta_t tensor(-0.9053, dtype=torch.float64)
7 gae_duplicate tensor(-1.8881, dtype=torch.float64) tensor(3.9228, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.0321, dtype=torch.float64) delta_t tensor(-0.4069, dtype=torch.float64)
6 gae_duplicate tensor(-1.9174, dtype=torch.float64) tensor(3.9765, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9265, dtype=torch.float64) delta_t tensor(-2.0329, dtype=torch.float64)
5 gae_duplicate tensor(-3.5668, dtype=torch.float64) tensor(7.4104, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9275, dtype=torch.float64) delta_t tensor(-2.1092, dtype=torch.float64)
4 gae_duplicate tensor(-4.9626, dtype=torch.float64) tensor(10.3472, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0939, dtype=torch.float64) delta_t tensor(0.8603, dtype=torch.float64)
3 gae_duplicate tensor(-3.1098, dtype=torch.float64) tensor(6.4609, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1481, dtype=torch.float64) delta_t tensor(-0.4177, dtype=torch.float64)
2 gae_duplicate tensor(-2.9056, dtype=torch.float64) tensor(6.0366, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-138.816650390625
value loss:129.29869079589844
entropies:37.42986297607422
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.089500904083252 seconds
19 rew tensor(0.8284, dtype=torch.float64) delta_t tensor(1.1226, dtype=torch.float64)
19 gae_duplicate tensor(1.1226, dtype=torch.float64) tensor(-2.3324, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7747, dtype=torch.float64) delta_t tensor(-1.1801, dtype=torch.float64)
18 gae_duplicate tensor(-0.2820, dtype=torch.float64) tensor(0.5869, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7210, dtype=torch.float64) delta_t tensor(0.3857, dtype=torch.float64)
17 gae_duplicate tensor(0.1601, dtype=torch.float64) tensor(-0.3333, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6672, dtype=torch.float64) delta_t tensor(0.5070, dtype=torch.float64)
16 gae_duplicate tensor(0.6351, dtype=torch.float64) tensor(-1.3241, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5595, dtype=torch.float64) delta_t tensor(0.3803, dtype=torch.float64)
15 gae_duplicate tensor(0.8884, dtype=torch.float64) tensor(-1.8457, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2898, dtype=torch.float64) delta_t tensor(0.1603, dtype=torch.float64)
14 gae_duplicate tensor(0.8710, dtype=torch.float64) tensor(-1.8097, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4518, dtype=torch.float64) delta_t tensor(0.1702, dtype=torch.float64)
13 gae_duplicate tensor(0.8670, dtype=torch.float64) tensor(-1.8014, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8295, dtype=torch.float64) delta_t tensor(0.6569, dtype=torch.float64)
12 gae_duplicate tensor(1.3506, dtype=torch.float64) tensor(-2.8109, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6680, dtype=torch.float64) delta_t tensor(0.4022, dtype=torch.float64)
11 gae_duplicate tensor(1.4827, dtype=torch.float64) tensor(-3.0859, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5604, dtype=torch.float64) delta_t tensor(0.3167, dtype=torch.float64)
10 gae_duplicate tensor(1.5029, dtype=torch.float64) tensor(-3.1279, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5720, dtype=torch.float64) delta_t tensor(-0.7794, dtype=torch.float64)
9 gae_duplicate tensor(0.4229, dtype=torch.float64) tensor(-0.8801, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7340, dtype=torch.float64) delta_t tensor(-1.1362, dtype=torch.float64)
8 gae_duplicate tensor(-0.7979, dtype=torch.float64) tensor(1.6578, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-3.1066, dtype=torch.float64) delta_t tensor(-2.9367, dtype=torch.float64)
7 gae_duplicate tensor(-3.5750, dtype=torch.float64) tensor(7.4275, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.2498, dtype=torch.float64) delta_t tensor(0.1476, dtype=torch.float64)
6 gae_duplicate tensor(-2.7124, dtype=torch.float64) tensor(5.6252, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1264, dtype=torch.float64) delta_t tensor(0.7981, dtype=torch.float64)
5 gae_duplicate tensor(-1.3718, dtype=torch.float64) tensor(2.8499, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0723, dtype=torch.float64) delta_t tensor(-0.1932, dtype=torch.float64)
4 gae_duplicate tensor(-1.2906, dtype=torch.float64) tensor(2.6909, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6303, dtype=torch.float64) delta_t tensor(-0.1549, dtype=torch.float64)
3 gae_duplicate tensor(-1.1874, dtype=torch.float64) tensor(2.4713, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7386, dtype=torch.float64) delta_t tensor(0.8638, dtype=torch.float64)
2 gae_duplicate tensor(-0.0861, dtype=torch.float64) tensor(0.1785, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-25.942873001098633
value loss:54.40096664428711
entropies:37.42986297607422
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.7557)
ToM Target loss= tensor(301.3406)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.358713865280151 seconds
19 rew tensor(0.8281, dtype=torch.float64) delta_t tensor(-0.4100, dtype=torch.float64)
19 gae_duplicate tensor(-0.4100, dtype=torch.float64) tensor(0.8519, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7746, dtype=torch.float64) delta_t tensor(0.5261, dtype=torch.float64)
18 gae_duplicate tensor(0.1980, dtype=torch.float64) tensor(-0.4115, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7212, dtype=torch.float64) delta_t tensor(0.1076, dtype=torch.float64)
17 gae_duplicate tensor(0.2661, dtype=torch.float64) tensor(-0.5547, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5603, dtype=torch.float64) delta_t tensor(0.3308, dtype=torch.float64)
16 gae_duplicate tensor(0.5437, dtype=torch.float64) tensor(-1.1276, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4530, dtype=torch.float64) delta_t tensor(0.5111, dtype=torch.float64)
15 gae_duplicate tensor(0.9460, dtype=torch.float64) tensor(-1.9654, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0236, dtype=torch.float64) delta_t tensor(-0.2924, dtype=torch.float64)
14 gae_duplicate tensor(0.4644, dtype=torch.float64) tensor(-0.9665, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8289, dtype=torch.float64) delta_t tensor(0.5813, dtype=torch.float64)
13 gae_duplicate tensor(0.9528, dtype=torch.float64) tensor(-1.9795, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8292, dtype=torch.float64) delta_t tensor(0.5816, dtype=torch.float64)
12 gae_duplicate tensor(1.3438, dtype=torch.float64) tensor(-2.7968, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8295, dtype=torch.float64) delta_t tensor(0.6715, dtype=torch.float64)
11 gae_duplicate tensor(1.7466, dtype=torch.float64) tensor(-3.6288, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6151, dtype=torch.float64) delta_t tensor(0.3785, dtype=torch.float64)
10 gae_duplicate tensor(1.7758, dtype=torch.float64) tensor(-3.6894, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6388, dtype=torch.float64) delta_t tensor(-1.8906, dtype=torch.float64)
9 gae_duplicate tensor(-0.4700, dtype=torch.float64) tensor(0.9782, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.8213, dtype=torch.float64) delta_t tensor(-2.8316, dtype=torch.float64)
8 gae_duplicate tensor(-3.2076, dtype=torch.float64) tensor(6.6874, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1843, dtype=torch.float64) delta_t tensor(0.0838, dtype=torch.float64)
7 gae_duplicate tensor(-2.4823, dtype=torch.float64) tensor(5.1573, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-3.4177, dtype=torch.float64) delta_t tensor(-2.8542, dtype=torch.float64)
6 gae_duplicate tensor(-4.8401, dtype=torch.float64) tensor(10.0734, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9186, dtype=torch.float64) delta_t tensor(0.6440, dtype=torch.float64)
5 gae_duplicate tensor(-3.2280, dtype=torch.float64) tensor(6.7066, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1609, dtype=torch.float64) delta_t tensor(-2.9414, dtype=torch.float64)
4 gae_duplicate tensor(-5.5239, dtype=torch.float64) tensor(11.4767, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4670, dtype=torch.float64) delta_t tensor(0.7417, dtype=torch.float64)
3 gae_duplicate tensor(-3.6774, dtype=torch.float64) tensor(7.6403, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5212, dtype=torch.float64) delta_t tensor(0.1480, dtype=torch.float64)
2 gae_duplicate tensor(-2.7939, dtype=torch.float64) tensor(5.8047, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-230.6607208251953
value loss:169.44241333007812
entropies:37.42986297607422
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.372942924499512 seconds
19 rew tensor(0.8280, dtype=torch.float64) delta_t tensor(1.4338, dtype=torch.float64)
19 gae_duplicate tensor(1.4338, dtype=torch.float64) tensor(-2.9840, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8283, dtype=torch.float64) delta_t tensor(0.9495, dtype=torch.float64)
18 gae_duplicate tensor(2.0965, dtype=torch.float64) tensor(-4.3633, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8286, dtype=torch.float64) delta_t tensor(0.5309, dtype=torch.float64)
17 gae_duplicate tensor(2.2081, dtype=torch.float64) tensor(-4.5954, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8290, dtype=torch.float64) delta_t tensor(-0.7117, dtype=torch.float64)
16 gae_duplicate tensor(1.0547, dtype=torch.float64) tensor(-2.1914, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8293, dtype=torch.float64) delta_t tensor(0.6890, dtype=torch.float64)
15 gae_duplicate tensor(1.5328, dtype=torch.float64) tensor(-3.1902, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8296, dtype=torch.float64) delta_t tensor(0.7322, dtype=torch.float64)
14 gae_duplicate tensor(1.9585, dtype=torch.float64) tensor(-4.0831, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8299, dtype=torch.float64) delta_t tensor(0.7238, dtype=torch.float64)
13 gae_duplicate tensor(2.2906, dtype=torch.float64) tensor(-4.7755, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8302, dtype=torch.float64) delta_t tensor(0.6213, dtype=torch.float64)
12 gae_duplicate tensor(2.4538, dtype=torch.float64) tensor(-5.1069, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8305, dtype=torch.float64) delta_t tensor(0.6587, dtype=torch.float64)
11 gae_duplicate tensor(2.6218, dtype=torch.float64) tensor(-5.4565, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8308, dtype=torch.float64) delta_t tensor(0.7869, dtype=torch.float64)
10 gae_duplicate tensor(2.8843, dtype=torch.float64) tensor(-6.0030, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5086, dtype=torch.float64) delta_t tensor(2.3518, dtype=torch.float64)
9 gae_duplicate tensor(4.6592, dtype=torch.float64) tensor(-9.7136, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4012, dtype=torch.float64) delta_t tensor(-0.5799, dtype=torch.float64)
8 gae_duplicate tensor(3.1475, dtype=torch.float64) tensor(-6.5283, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5661, dtype=torch.float64) delta_t tensor(-0.9086, dtype=torch.float64)
7 gae_duplicate tensor(1.6094, dtype=torch.float64) tensor(-3.3494, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6737, dtype=torch.float64) delta_t tensor(0.7749, dtype=torch.float64)
6 gae_duplicate tensor(2.0624, dtype=torch.float64) tensor(-4.2777, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8351, dtype=torch.float64) delta_t tensor(-0.4065, dtype=torch.float64)
5 gae_duplicate tensor(1.2435, dtype=torch.float64) tensor(-2.5880, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5876, dtype=torch.float64) delta_t tensor(-0.9718, dtype=torch.float64)
4 gae_duplicate tensor(0.0230, dtype=torch.float64) tensor(-0.0476, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4814, dtype=torch.float64) delta_t tensor(-1.0446, dtype=torch.float64)
3 gae_duplicate tensor(-1.0262, dtype=torch.float64) tensor(2.1322, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5685, dtype=torch.float64) delta_t tensor(-0.7325, dtype=torch.float64)
2 gae_duplicate tensor(-1.5535, dtype=torch.float64) tensor(3.2333, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:382.2079162597656
value loss:132.83689880371094
entropies:37.42986297607422
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.7702858448028564 seconds
19 rew tensor(0.8283, dtype=torch.float64) delta_t tensor(-0.4234, dtype=torch.float64)
19 gae_duplicate tensor(-0.4234, dtype=torch.float64) tensor(0.8826, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8287, dtype=torch.float64) delta_t tensor(0.4108, dtype=torch.float64)
18 gae_duplicate tensor(0.0721, dtype=torch.float64) tensor(-0.1498, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8290, dtype=torch.float64) delta_t tensor(0.7502, dtype=torch.float64)
17 gae_duplicate tensor(0.8079, dtype=torch.float64) tensor(-1.6813, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8293, dtype=torch.float64) delta_t tensor(0.8067, dtype=torch.float64)
16 gae_duplicate tensor(1.4530, dtype=torch.float64) tensor(-3.0241, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8296, dtype=torch.float64) delta_t tensor(1.1887, dtype=torch.float64)
15 gae_duplicate tensor(2.3511, dtype=torch.float64) tensor(-4.9011, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8299, dtype=torch.float64) delta_t tensor(0.9881, dtype=torch.float64)
14 gae_duplicate tensor(2.8690, dtype=torch.float64) tensor(-5.9611, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8302, dtype=torch.float64) delta_t tensor(0.9542, dtype=torch.float64)
13 gae_duplicate tensor(3.2494, dtype=torch.float64) tensor(-6.7735, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7227, dtype=torch.float64) delta_t tensor(0.7785, dtype=torch.float64)
12 gae_duplicate tensor(3.3781, dtype=torch.float64) tensor(-7.0186, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4534, dtype=torch.float64) delta_t tensor(2.5614, dtype=torch.float64)
11 gae_duplicate tensor(5.2638, dtype=torch.float64) tensor(-10.9363, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4535, dtype=torch.float64) delta_t tensor(-2.2740, dtype=torch.float64)
10 gae_duplicate tensor(1.9370, dtype=torch.float64) tensor(-4.0313, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2381, dtype=torch.float64) delta_t tensor(0.0472, dtype=torch.float64)
9 gae_duplicate tensor(1.5968, dtype=torch.float64) tensor(-3.3231, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1304, dtype=torch.float64) delta_t tensor(1.4116, dtype=torch.float64)
8 gae_duplicate tensor(2.6890, dtype=torch.float64) tensor(-5.5963, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5159, dtype=torch.float64) delta_t tensor(-0.5142, dtype=torch.float64)
7 gae_duplicate tensor(1.6370, dtype=torch.float64) tensor(-3.4069, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7853, dtype=torch.float64) delta_t tensor(0.6187, dtype=torch.float64)
6 gae_duplicate tensor(1.9284, dtype=torch.float64) tensor(-4.0199, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7318, dtype=torch.float64) delta_t tensor(-0.6571, dtype=torch.float64)
5 gae_duplicate tensor(0.8855, dtype=torch.float64) tensor(-1.8399, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0218, dtype=torch.float64) delta_t tensor(0.5549, dtype=torch.float64)
4 gae_duplicate tensor(1.2634, dtype=torch.float64) tensor(-2.6293, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8933, dtype=torch.float64) delta_t tensor(-0.0311, dtype=torch.float64)
3 gae_duplicate tensor(0.9796, dtype=torch.float64) tensor(-2.0388, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7322, dtype=torch.float64) delta_t tensor(-1.0518, dtype=torch.float64)
2 gae_duplicate tensor(-0.2682, dtype=torch.float64) tensor(0.5572, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:394.2270202636719
value loss:134.5910186767578
entropies:37.42987060546875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.619366884231567 seconds
19 rew tensor(0.8290, dtype=torch.float64) delta_t tensor(0.8602, dtype=torch.float64)
19 gae_duplicate tensor(0.8602, dtype=torch.float64) tensor(-1.7901, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8293, dtype=torch.float64) delta_t tensor(-0.8561, dtype=torch.float64)
18 gae_duplicate tensor(-0.1680, dtype=torch.float64) tensor(0.3491, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8296, dtype=torch.float64) delta_t tensor(0.4732, dtype=torch.float64)
17 gae_duplicate tensor(0.3388, dtype=torch.float64) tensor(-0.7039, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8299, dtype=torch.float64) delta_t tensor(0.6241, dtype=torch.float64)
16 gae_duplicate tensor(0.8951, dtype=torch.float64) tensor(-1.8658, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8302, dtype=torch.float64) delta_t tensor(0.8128, dtype=torch.float64)
15 gae_duplicate tensor(1.5289, dtype=torch.float64) tensor(-3.1818, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8305, dtype=torch.float64) delta_t tensor(0.5699, dtype=torch.float64)
14 gae_duplicate tensor(1.7930, dtype=torch.float64) tensor(-3.7314, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8308, dtype=torch.float64) delta_t tensor(0.5770, dtype=torch.float64)
13 gae_duplicate tensor(2.0114, dtype=torch.float64) tensor(-4.1927, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6152, dtype=torch.float64) delta_t tensor(0.5477, dtype=torch.float64)
12 gae_duplicate tensor(2.1569, dtype=torch.float64) tensor(-4.4887, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6154, dtype=torch.float64) delta_t tensor(0.6581, dtype=torch.float64)
11 gae_duplicate tensor(2.3836, dtype=torch.float64) tensor(-4.9606, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3997, dtype=torch.float64) delta_t tensor(2.3733, dtype=torch.float64)
10 gae_duplicate tensor(4.2802, dtype=torch.float64) tensor(-8.8934, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1839, dtype=torch.float64) delta_t tensor(-2.0518, dtype=torch.float64)
9 gae_duplicate tensor(1.3724, dtype=torch.float64) tensor(-2.8561, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2476, dtype=torch.float64) delta_t tensor(-0.3415, dtype=torch.float64)
8 gae_duplicate tensor(0.7564, dtype=torch.float64) tensor(-1.5741, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6792, dtype=torch.float64) delta_t tensor(0.7398, dtype=torch.float64)
7 gae_duplicate tensor(1.3449, dtype=torch.float64) tensor(-2.7945, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8412, dtype=torch.float64) delta_t tensor(-0.8353, dtype=torch.float64)
6 gae_duplicate tensor(0.2407, dtype=torch.float64) tensor(-0.5001, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7044, dtype=torch.float64) delta_t tensor(0.1284, dtype=torch.float64)
5 gae_duplicate tensor(0.3210, dtype=torch.float64) tensor(-0.6658, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3983, dtype=torch.float64) delta_t tensor(-0.0754, dtype=torch.float64)
4 gae_duplicate tensor(0.1813, dtype=torch.float64) tensor(-0.3774, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4896, dtype=torch.float64) delta_t tensor(0.0267, dtype=torch.float64)
3 gae_duplicate tensor(0.1718, dtype=torch.float64) tensor(-0.3569, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0590, dtype=torch.float64) delta_t tensor(-1.2783, dtype=torch.float64)
2 gae_duplicate tensor(-1.1409, dtype=torch.float64) tensor(2.3705, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:240.15867614746094
value loss:68.5886001586914
entropies:37.429874420166016
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.350096225738525 seconds
19 rew tensor(0.8288, dtype=torch.float64) delta_t tensor(-0.7165, dtype=torch.float64)
19 gae_duplicate tensor(-0.7165, dtype=torch.float64) tensor(1.4888, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8291, dtype=torch.float64) delta_t tensor(0.5200, dtype=torch.float64)
18 gae_duplicate tensor(-0.0532, dtype=torch.float64) tensor(0.1105, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8294, dtype=torch.float64) delta_t tensor(0.5203, dtype=torch.float64)
17 gae_duplicate tensor(0.4778, dtype=torch.float64) tensor(-0.9943, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8297, dtype=torch.float64) delta_t tensor(0.4923, dtype=torch.float64)
16 gae_duplicate tensor(0.8745, dtype=torch.float64) tensor(-1.8199, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8300, dtype=torch.float64) delta_t tensor(0.3201, dtype=torch.float64)
15 gae_duplicate tensor(1.0198, dtype=torch.float64) tensor(-2.1254, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8303, dtype=torch.float64) delta_t tensor(0.6261, dtype=torch.float64)
14 gae_duplicate tensor(1.4419, dtype=torch.float64) tensor(-2.9915, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8306, dtype=torch.float64) delta_t tensor(0.6952, dtype=torch.float64)
13 gae_duplicate tensor(1.8487, dtype=torch.float64) tensor(-3.8471, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8309, dtype=torch.float64) delta_t tensor(1.0262, dtype=torch.float64)
12 gae_duplicate tensor(2.5051, dtype=torch.float64) tensor(-5.2132, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8312, dtype=torch.float64) delta_t tensor(0.6413, dtype=torch.float64)
11 gae_duplicate tensor(2.6454, dtype=torch.float64) tensor(-5.4885, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8315, dtype=torch.float64) delta_t tensor(2.5620, dtype=torch.float64)
10 gae_duplicate tensor(4.6783, dtype=torch.float64) tensor(-9.7209, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5616, dtype=torch.float64) delta_t tensor(-0.4537, dtype=torch.float64)
9 gae_duplicate tensor(3.2890, dtype=torch.float64) tensor(-6.8239, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3455, dtype=torch.float64) delta_t tensor(0.1778, dtype=torch.float64)
8 gae_duplicate tensor(2.8090, dtype=torch.float64) tensor(-5.8454, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1407, dtype=torch.float64) delta_t tensor(-0.8567, dtype=torch.float64)
7 gae_duplicate tensor(1.3904, dtype=torch.float64) tensor(-2.8935, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2488, dtype=torch.float64) delta_t tensor(1.4824, dtype=torch.float64)
6 gae_duplicate tensor(2.5948, dtype=torch.float64) tensor(-5.3834, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7350, dtype=torch.float64) delta_t tensor(0.6085, dtype=torch.float64)
5 gae_duplicate tensor(2.6844, dtype=torch.float64) tensor(-5.5861, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4374, dtype=torch.float64) delta_t tensor(-1.2577, dtype=torch.float64)
4 gae_duplicate tensor(0.8898, dtype=torch.float64) tensor(-1.8489, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2763, dtype=torch.float64) delta_t tensor(-0.6053, dtype=torch.float64)
3 gae_duplicate tensor(0.1066, dtype=torch.float64) tensor(-0.2215, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5206, dtype=torch.float64) delta_t tensor(-1.0513, dtype=torch.float64)
2 gae_duplicate tensor(-0.9660, dtype=torch.float64) tensor(2.0072, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:342.05853271484375
value loss:119.28394317626953
entropies:37.429874420166016
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.3234)
ToM Target loss= tensor(301.7561)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.475496292114258 seconds
19 rew tensor(0.8286, dtype=torch.float64) delta_t tensor(-0.8102, dtype=torch.float64)
19 gae_duplicate tensor(-0.8102, dtype=torch.float64) tensor(1.6836, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8289, dtype=torch.float64) delta_t tensor(0.6777, dtype=torch.float64)
18 gae_duplicate tensor(0.0296, dtype=torch.float64) tensor(-0.0615, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8292, dtype=torch.float64) delta_t tensor(0.2347, dtype=torch.float64)
17 gae_duplicate tensor(0.2583, dtype=torch.float64) tensor(-0.5368, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8295, dtype=torch.float64) delta_t tensor(0.9559, dtype=torch.float64)
16 gae_duplicate tensor(1.1625, dtype=torch.float64) tensor(-2.4156, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8298, dtype=torch.float64) delta_t tensor(1.1585, dtype=torch.float64)
15 gae_duplicate tensor(2.0885, dtype=torch.float64) tensor(-4.3397, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8301, dtype=torch.float64) delta_t tensor(0.6902, dtype=torch.float64)
14 gae_duplicate tensor(2.3610, dtype=torch.float64) tensor(-4.9130, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8304, dtype=torch.float64) delta_t tensor(0.6905, dtype=torch.float64)
13 gae_duplicate tensor(2.5794, dtype=torch.float64) tensor(-5.3675, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8307, dtype=torch.float64) delta_t tensor(0.7806, dtype=torch.float64)
12 gae_duplicate tensor(2.8441, dtype=torch.float64) tensor(-5.9099, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8310, dtype=torch.float64) delta_t tensor(0.8029, dtype=torch.float64)
11 gae_duplicate tensor(3.0782, dtype=torch.float64) tensor(-6.4052, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8313, dtype=torch.float64) delta_t tensor(-0.0834, dtype=torch.float64)
10 gae_duplicate tensor(2.3791, dtype=torch.float64) tensor(-4.9437, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5612, dtype=torch.float64) delta_t tensor(0.4034, dtype=torch.float64)
9 gae_duplicate tensor(2.3067, dtype=torch.float64) tensor(-4.7861, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2368, dtype=torch.float64) delta_t tensor(1.4035, dtype=torch.float64)
8 gae_duplicate tensor(3.2488, dtype=torch.float64) tensor(-6.7706, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0335, dtype=torch.float64) delta_t tensor(-1.0108, dtype=torch.float64)
7 gae_duplicate tensor(1.5883, dtype=torch.float64) tensor(-3.3004, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0066, dtype=torch.float64) delta_t tensor(0.8300, dtype=torch.float64)
6 gae_duplicate tensor(2.1007, dtype=torch.float64) tensor(-4.3778, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3314, dtype=torch.float64) delta_t tensor(-0.5383, dtype=torch.float64)
5 gae_duplicate tensor(1.1423, dtype=torch.float64) tensor(-2.3701, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8188, dtype=torch.float64) delta_t tensor(-1.6439, dtype=torch.float64)
4 gae_duplicate tensor(-0.7301, dtype=torch.float64) tensor(1.5149, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4418, dtype=torch.float64) delta_t tensor(-0.9020, dtype=torch.float64)
3 gae_duplicate tensor(-1.4860, dtype=torch.float64) tensor(3.0877, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2804, dtype=torch.float64) delta_t tensor(-0.5311, dtype=torch.float64)
2 gae_duplicate tensor(-1.7199, dtype=torch.float64) tensor(3.5791, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:278.6740417480469
value loss:107.55690002441406
entropies:37.42987823486328
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.350722074508667 seconds
19 rew tensor(0.8287, dtype=torch.float64) delta_t tensor(-0.7560, dtype=torch.float64)
19 gae_duplicate tensor(-0.7560, dtype=torch.float64) tensor(1.5731, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8290, dtype=torch.float64) delta_t tensor(0.5304, dtype=torch.float64)
18 gae_duplicate tensor(-0.0744, dtype=torch.float64) tensor(0.1549, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8293, dtype=torch.float64) delta_t tensor(0.5355, dtype=torch.float64)
17 gae_duplicate tensor(0.4759, dtype=torch.float64) tensor(-0.9889, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8296, dtype=torch.float64) delta_t tensor(-0.0802, dtype=torch.float64)
16 gae_duplicate tensor(0.3006, dtype=torch.float64) tensor(-0.6264, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8299, dtype=torch.float64) delta_t tensor(0.7121, dtype=torch.float64)
15 gae_duplicate tensor(0.9526, dtype=torch.float64) tensor(-1.9795, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8302, dtype=torch.float64) delta_t tensor(0.6633, dtype=torch.float64)
14 gae_duplicate tensor(1.4254, dtype=torch.float64) tensor(-2.9661, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8305, dtype=torch.float64) delta_t tensor(0.6680, dtype=torch.float64)
13 gae_duplicate tensor(1.8083, dtype=torch.float64) tensor(-3.7575, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8308, dtype=torch.float64) delta_t tensor(1.1475, dtype=torch.float64)
12 gae_duplicate tensor(2.5942, dtype=torch.float64) tensor(-5.3981, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8311, dtype=torch.float64) delta_t tensor(0.7603, dtype=torch.float64)
11 gae_duplicate tensor(2.8357, dtype=torch.float64) tensor(-5.9006, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4518, dtype=torch.float64) delta_t tensor(1.6227, dtype=torch.float64)
10 gae_duplicate tensor(3.8913, dtype=torch.float64) tensor(-8.0975, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1266, dtype=torch.float64) delta_t tensor(0.4009, dtype=torch.float64)
9 gae_duplicate tensor(3.5139, dtype=torch.float64) tensor(-7.2916, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0360, dtype=torch.float64) delta_t tensor(-1.1402, dtype=torch.float64)
8 gae_duplicate tensor(1.6709, dtype=torch.float64) tensor(-3.4771, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4695, dtype=torch.float64) delta_t tensor(-1.0183, dtype=torch.float64)
7 gae_duplicate tensor(0.3184, dtype=torch.float64) tensor(-0.6617, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4697, dtype=torch.float64) delta_t tensor(1.1004, dtype=torch.float64)
6 gae_duplicate tensor(1.3551, dtype=torch.float64) tensor(-2.8237, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1989, dtype=torch.float64) delta_t tensor(0.0191, dtype=torch.float64)
5 gae_duplicate tensor(1.1032, dtype=torch.float64) tensor(-2.2924, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6323, dtype=torch.float64) delta_t tensor(0.0156, dtype=torch.float64)
4 gae_duplicate tensor(0.8982, dtype=torch.float64) tensor(-1.8717, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0657, dtype=torch.float64) delta_t tensor(-0.0992, dtype=torch.float64)
3 gae_duplicate tensor(0.6193, dtype=torch.float64) tensor(-1.2870, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2538, dtype=torch.float64) delta_t tensor(-1.5328, dtype=torch.float64)
2 gae_duplicate tensor(-1.0374, dtype=torch.float64) tensor(2.1587, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:272.0760803222656
value loss:86.36500549316406
entropies:37.42988586425781
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.280717849731445 seconds
19 rew tensor(0.8244, dtype=torch.float64) delta_t tensor(0.6825, dtype=torch.float64)
19 gae_duplicate tensor(0.6825, dtype=torch.float64) tensor(-1.4220, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8247, dtype=torch.float64) delta_t tensor(0.7963, dtype=torch.float64)
18 gae_duplicate tensor(1.3423, dtype=torch.float64) tensor(-2.7931, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8250, dtype=torch.float64) delta_t tensor(0.7966, dtype=torch.float64)
17 gae_duplicate tensor(1.8705, dtype=torch.float64) tensor(-3.8921, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7715, dtype=torch.float64) delta_t tensor(0.8347, dtype=torch.float64)
16 gae_duplicate tensor(2.3310, dtype=torch.float64) tensor(-4.8440, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7180, dtype=torch.float64) delta_t tensor(-1.4557, dtype=torch.float64)
15 gae_duplicate tensor(0.4092, dtype=torch.float64) tensor(-0.8502, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6645, dtype=torch.float64) delta_t tensor(0.2899, dtype=torch.float64)
14 gae_duplicate tensor(0.6173, dtype=torch.float64) tensor(-1.2827, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6109, dtype=torch.float64) delta_t tensor(0.2999, dtype=torch.float64)
13 gae_duplicate tensor(0.7937, dtype=torch.float64) tensor(-1.6538, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7724, dtype=torch.float64) delta_t tensor(0.3938, dtype=torch.float64)
12 gae_duplicate tensor(1.0287, dtype=torch.float64) tensor(-2.1407, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8264, dtype=torch.float64) delta_t tensor(0.4262, dtype=torch.float64)
11 gae_duplicate tensor(1.2492, dtype=torch.float64) tensor(-2.6030, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6655, dtype=torch.float64) delta_t tensor(0.2274, dtype=torch.float64)
10 gae_duplicate tensor(1.2268, dtype=torch.float64) tensor(-2.5528, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.7196, dtype=torch.float64) delta_t tensor(-3.1556, dtype=torch.float64)
9 gae_duplicate tensor(-2.1741, dtype=torch.float64) tensor(4.5118, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6260, dtype=torch.float64) delta_t tensor(-1.1201, dtype=torch.float64)
8 gae_duplicate tensor(-2.8594, dtype=torch.float64) tensor(5.9420, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7337, dtype=torch.float64) delta_t tensor(-0.7126, dtype=torch.float64)
7 gae_duplicate tensor(-3.0001, dtype=torch.float64) tensor(6.2343, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.0251, dtype=torch.float64) delta_t tensor(-1.1939, dtype=torch.float64)
6 gae_duplicate tensor(-3.5940, dtype=torch.float64) tensor(7.4889, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.4579, dtype=torch.float64) delta_t tensor(-0.6776, dtype=torch.float64)
5 gae_duplicate tensor(-3.5529, dtype=torch.float64) tensor(7.3830, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-6.0721, dtype=torch.float64) delta_t tensor(-5.8143, dtype=torch.float64)
4 gae_duplicate tensor(-8.6566, dtype=torch.float64) tensor(18.0134, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0691, dtype=torch.float64) delta_t tensor(0.5919, dtype=torch.float64)
3 gae_duplicate tensor(-6.3334, dtype=torch.float64) tensor(13.1966, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0148, dtype=torch.float64) delta_t tensor(0.0995, dtype=torch.float64)
2 gae_duplicate tensor(-4.9671, dtype=torch.float64) tensor(10.3361, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-295.552734375
value loss:305.50018310546875
entropies:37.429893493652344
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.544151067733765 seconds
19 rew tensor(0.8242, dtype=torch.float64) delta_t tensor(-0.3517, dtype=torch.float64)
19 gae_duplicate tensor(-0.3517, dtype=torch.float64) tensor(0.7319, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8245, dtype=torch.float64) delta_t tensor(0.5893, dtype=torch.float64)
18 gae_duplicate tensor(0.3079, dtype=torch.float64) tensor(-0.6407, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8248, dtype=torch.float64) delta_t tensor(0.5896, dtype=torch.float64)
17 gae_duplicate tensor(0.8359, dtype=torch.float64) tensor(-1.7393, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8250, dtype=torch.float64) delta_t tensor(0.5899, dtype=torch.float64)
16 gae_duplicate tensor(1.2586, dtype=torch.float64) tensor(-2.6190, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8253, dtype=torch.float64) delta_t tensor(0.5902, dtype=torch.float64)
15 gae_duplicate tensor(1.5970, dtype=torch.float64) tensor(-3.3144, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8256, dtype=torch.float64) delta_t tensor(0.5904, dtype=torch.float64)
14 gae_duplicate tensor(1.8681, dtype=torch.float64) tensor(-3.8821, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8259, dtype=torch.float64) delta_t tensor(0.5907, dtype=torch.float64)
13 gae_duplicate tensor(2.0852, dtype=torch.float64) tensor(-4.3275, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8262, dtype=torch.float64) delta_t tensor(0.5910, dtype=torch.float64)
12 gae_duplicate tensor(2.2592, dtype=torch.float64) tensor(-4.7011, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7189, dtype=torch.float64) delta_t tensor(0.5102, dtype=torch.float64)
11 gae_duplicate tensor(2.3175, dtype=torch.float64) tensor(-4.8225, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6653, dtype=torch.float64) delta_t tensor(1.0709, dtype=torch.float64)
10 gae_duplicate tensor(2.9249, dtype=torch.float64) tensor(-6.0862, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3428, dtype=torch.float64) delta_t tensor(-0.1814, dtype=torch.float64)
9 gae_duplicate tensor(2.1585, dtype=torch.float64) tensor(-4.4795, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2891, dtype=torch.float64) delta_t tensor(0.5960, dtype=torch.float64)
8 gae_duplicate tensor(2.3228, dtype=torch.float64) tensor(-4.8397, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4636, dtype=torch.float64) delta_t tensor(-1.0651, dtype=torch.float64)
7 gae_duplicate tensor(0.7931, dtype=torch.float64) tensor(-1.6504, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6787, dtype=torch.float64) delta_t tensor(-1.4498, dtype=torch.float64)
6 gae_duplicate tensor(-0.8153, dtype=torch.float64) tensor(1.6987, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9152, dtype=torch.float64) delta_t tensor(-0.5113, dtype=torch.float64)
5 gae_duplicate tensor(-1.1635, dtype=torch.float64) tensor(2.4211, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.6107, dtype=torch.float64) delta_t tensor(1.1680, dtype=torch.float64)
4 gae_duplicate tensor(0.2372, dtype=torch.float64) tensor(-0.4930, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4864, dtype=torch.float64) delta_t tensor(-0.3212, dtype=torch.float64)
3 gae_duplicate tensor(-0.1314, dtype=torch.float64) tensor(0.2731, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3798, dtype=torch.float64) delta_t tensor(-1.3055, dtype=torch.float64)
2 gae_duplicate tensor(-1.4107, dtype=torch.float64) tensor(2.9313, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:212.1121368408203
value loss:70.0274429321289
entropies:37.42989730834961
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.376214981079102 seconds
19 rew tensor(0.8250, dtype=torch.float64) delta_t tensor(0.6107, dtype=torch.float64)
19 gae_duplicate tensor(0.6107, dtype=torch.float64) tensor(-1.2708, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8253, dtype=torch.float64) delta_t tensor(0.7824, dtype=torch.float64)
18 gae_duplicate tensor(1.2710, dtype=torch.float64) tensor(-2.6447, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8256, dtype=torch.float64) delta_t tensor(0.7827, dtype=torch.float64)
17 gae_duplicate tensor(1.7995, dtype=torch.float64) tensor(-3.7444, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8258, dtype=torch.float64) delta_t tensor(-1.5365, dtype=torch.float64)
16 gae_duplicate tensor(-0.0969, dtype=torch.float64) tensor(0.2017, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7184, dtype=torch.float64) delta_t tensor(0.2502, dtype=torch.float64)
15 gae_duplicate tensor(0.1727, dtype=torch.float64) tensor(-0.3584, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7725, dtype=torch.float64) delta_t tensor(0.2995, dtype=torch.float64)
14 gae_duplicate tensor(0.4377, dtype=torch.float64) tensor(-0.9119, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7189, dtype=torch.float64) delta_t tensor(0.2914, dtype=torch.float64)
13 gae_duplicate tensor(0.6415, dtype=torch.float64) tensor(-1.3348, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8268, dtype=torch.float64) delta_t tensor(1.8381, dtype=torch.float64)
12 gae_duplicate tensor(2.3513, dtype=torch.float64) tensor(-4.8798, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4113, dtype=torch.float64) delta_t tensor(-0.9501, dtype=torch.float64)
11 gae_duplicate tensor(0.9309, dtype=torch.float64) tensor(-1.9345, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6115, dtype=torch.float64) delta_t tensor(0.2521, dtype=torch.float64)
10 gae_duplicate tensor(0.9968, dtype=torch.float64) tensor(-2.0742, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3963, dtype=torch.float64) delta_t tensor(-0.4596, dtype=torch.float64)
9 gae_duplicate tensor(0.3379, dtype=torch.float64) tensor(-0.7030, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1956, dtype=torch.float64) delta_t tensor(-0.3743, dtype=torch.float64)
8 gae_duplicate tensor(-0.1040, dtype=torch.float64) tensor(0.2164, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0565, dtype=torch.float64) delta_t tensor(0.1802, dtype=torch.float64)
7 gae_duplicate tensor(0.0970, dtype=torch.float64) tensor(-0.2016, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3037, dtype=torch.float64) delta_t tensor(-0.5970, dtype=torch.float64)
6 gae_duplicate tensor(-0.5194, dtype=torch.float64) tensor(1.0780, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5411, dtype=torch.float64) delta_t tensor(-1.4732, dtype=torch.float64)
5 gae_duplicate tensor(-1.8888, dtype=torch.float64) tensor(3.9301, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9189, dtype=torch.float64) delta_t tensor(-1.4354, dtype=torch.float64)
4 gae_duplicate tensor(-2.9464, dtype=torch.float64) tensor(6.1228, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1978, dtype=torch.float64) delta_t tensor(1.1269, dtype=torch.float64)
3 gae_duplicate tensor(-1.2302, dtype=torch.float64) tensor(2.5529, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5975, dtype=torch.float64) delta_t tensor(-1.4133, dtype=torch.float64)
2 gae_duplicate tensor(-2.3975, dtype=torch.float64) tensor(4.9887, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4.682221412658691
value loss:49.75752258300781
entropies:37.42989730834961
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.7821)
ToM Target loss= tensor(301.6988)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.514948129653931 seconds
19 rew tensor(0.8250, dtype=torch.float64) delta_t tensor(-0.8635, dtype=torch.float64)
19 gae_duplicate tensor(-0.8635, dtype=torch.float64) tensor(1.7968, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8253, dtype=torch.float64) delta_t tensor(0.5824, dtype=torch.float64)
18 gae_duplicate tensor(-0.1084, dtype=torch.float64) tensor(0.2253, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8256, dtype=torch.float64) delta_t tensor(0.6773, dtype=torch.float64)
17 gae_duplicate tensor(0.5906, dtype=torch.float64) tensor(-1.2289, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8259, dtype=torch.float64) delta_t tensor(0.5412, dtype=torch.float64)
16 gae_duplicate tensor(1.0137, dtype=torch.float64) tensor(-2.1039, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8261, dtype=torch.float64) delta_t tensor(0.7825, dtype=torch.float64)
15 gae_duplicate tensor(1.5934, dtype=torch.float64) tensor(-3.3113, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8264, dtype=torch.float64) delta_t tensor(-0.7992, dtype=torch.float64)
14 gae_duplicate tensor(0.4756, dtype=torch.float64) tensor(-0.9883, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8267, dtype=torch.float64) delta_t tensor(0.4401, dtype=torch.float64)
13 gae_duplicate tensor(0.8206, dtype=torch.float64) tensor(-1.7052, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8270, dtype=torch.float64) delta_t tensor(0.3258, dtype=torch.float64)
12 gae_duplicate tensor(0.9823, dtype=torch.float64) tensor(-2.0412, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5577, dtype=torch.float64) delta_t tensor(0.1186, dtype=torch.float64)
11 gae_duplicate tensor(0.9044, dtype=torch.float64) tensor(-1.8795, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6118, dtype=torch.float64) delta_t tensor(0.1804, dtype=torch.float64)
10 gae_duplicate tensor(0.9040, dtype=torch.float64) tensor(-1.8785, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5042, dtype=torch.float64) delta_t tensor(0.0664, dtype=torch.float64)
9 gae_duplicate tensor(0.7896, dtype=torch.float64) tensor(-1.6430, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3427, dtype=torch.float64) delta_t tensor(1.9453, dtype=torch.float64)
8 gae_duplicate tensor(2.5770, dtype=torch.float64) tensor(-5.3692, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1811, dtype=torch.float64) delta_t tensor(-0.8105, dtype=torch.float64)
7 gae_duplicate tensor(1.2511, dtype=torch.float64) tensor(-2.5999, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7885, dtype=torch.float64) delta_t tensor(-0.6315, dtype=torch.float64)
6 gae_duplicate tensor(0.3694, dtype=torch.float64) tensor(-0.7677, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0580, dtype=torch.float64) delta_t tensor(0.6071, dtype=torch.float64)
5 gae_duplicate tensor(0.9027, dtype=torch.float64) tensor(-1.8807, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5433, dtype=torch.float64) delta_t tensor(-1.8014, dtype=torch.float64)
4 gae_duplicate tensor(-1.0793, dtype=torch.float64) tensor(2.2400, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5444, dtype=torch.float64) delta_t tensor(-0.8110, dtype=torch.float64)
3 gae_duplicate tensor(-1.6744, dtype=torch.float64) tensor(3.4841, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1682, dtype=torch.float64) delta_t tensor(-0.5473, dtype=torch.float64)
2 gae_duplicate tensor(-1.8868, dtype=torch.float64) tensor(3.9261, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:93.2283706665039
value loss:38.22331619262695
entropies:37.42989730834961
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.690676212310791 seconds
19 rew tensor(0.8251, dtype=torch.float64) delta_t tensor(-2.1048, dtype=torch.float64)
19 gae_duplicate tensor(-2.1048, dtype=torch.float64) tensor(4.3740, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8254, dtype=torch.float64) delta_t tensor(0.2938, dtype=torch.float64)
18 gae_duplicate tensor(-1.3900, dtype=torch.float64) tensor(2.8961, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8257, dtype=torch.float64) delta_t tensor(-0.0247, dtype=torch.float64)
17 gae_duplicate tensor(-1.1367, dtype=torch.float64) tensor(2.3593, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8260, dtype=torch.float64) delta_t tensor(0.3190, dtype=torch.float64)
16 gae_duplicate tensor(-0.5904, dtype=torch.float64) tensor(1.2284, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8263, dtype=torch.float64) delta_t tensor(0.7812, dtype=torch.float64)
15 gae_duplicate tensor(0.3089, dtype=torch.float64) tensor(-0.6435, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8265, dtype=torch.float64) delta_t tensor(0.8798, dtype=torch.float64)
14 gae_duplicate tensor(1.1269, dtype=torch.float64) tensor(-2.3449, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8268, dtype=torch.float64) delta_t tensor(0.4427, dtype=torch.float64)
13 gae_duplicate tensor(1.3443, dtype=torch.float64) tensor(-2.7900, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8271, dtype=torch.float64) delta_t tensor(0.4430, dtype=torch.float64)
12 gae_duplicate tensor(1.5184, dtype=torch.float64) tensor(-3.1635, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8274, dtype=torch.float64) delta_t tensor(0.4454, dtype=torch.float64)
11 gae_duplicate tensor(1.6602, dtype=torch.float64) tensor(-3.4589, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8277, dtype=torch.float64) delta_t tensor(-0.4488, dtype=torch.float64)
10 gae_duplicate tensor(0.8794, dtype=torch.float64) tensor(-1.8275, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7551, dtype=torch.float64) delta_t tensor(-1.3174, dtype=torch.float64)
9 gae_duplicate tensor(-0.6139, dtype=torch.float64) tensor(1.2759, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.9181, dtype=torch.float64) delta_t tensor(-2.7321, dtype=torch.float64)
8 gae_duplicate tensor(-3.2233, dtype=torch.float64) tensor(6.6982, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.9738, dtype=torch.float64) delta_t tensor(-2.0441, dtype=torch.float64)
7 gae_duplicate tensor(-4.6227, dtype=torch.float64) tensor(9.6191, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.4070, dtype=torch.float64) delta_t tensor(-1.3317, dtype=torch.float64)
6 gae_duplicate tensor(-5.0298, dtype=torch.float64) tensor(10.4527, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8708, dtype=torch.float64) delta_t tensor(-0.3981, dtype=torch.float64)
5 gae_duplicate tensor(-4.4220, dtype=torch.float64) tensor(9.2011, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9009, dtype=torch.float64) delta_t tensor(-1.6319, dtype=torch.float64)
4 gae_duplicate tensor(-5.1695, dtype=torch.float64) tensor(10.7566, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1243, dtype=torch.float64) delta_t tensor(1.6351, dtype=torch.float64)
3 gae_duplicate tensor(-2.5005, dtype=torch.float64) tensor(5.2030, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3614, dtype=torch.float64) delta_t tensor(0.5501, dtype=torch.float64)
2 gae_duplicate tensor(-1.4503, dtype=torch.float64) tensor(3.0217, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-318.2693786621094
value loss:193.62081909179688
entropies:37.42989730834961
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.398193836212158 seconds
19 rew tensor(0.8255, dtype=torch.float64) delta_t tensor(-2.0907, dtype=torch.float64)
19 gae_duplicate tensor(-2.0907, dtype=torch.float64) tensor(4.3393, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8258, dtype=torch.float64) delta_t tensor(0.3191, dtype=torch.float64)
18 gae_duplicate tensor(-1.3534, dtype=torch.float64) tensor(2.8091, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8260, dtype=torch.float64) delta_t tensor(0.1241, dtype=torch.float64)
17 gae_duplicate tensor(-0.9586, dtype=torch.float64) tensor(1.9947, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8263, dtype=torch.float64) delta_t tensor(0.4509, dtype=torch.float64)
16 gae_duplicate tensor(-0.3161, dtype=torch.float64) tensor(0.6568, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8266, dtype=torch.float64) delta_t tensor(0.9936, dtype=torch.float64)
15 gae_duplicate tensor(0.7408, dtype=torch.float64) tensor(-1.5395, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8269, dtype=torch.float64) delta_t tensor(0.5042, dtype=torch.float64)
14 gae_duplicate tensor(1.0968, dtype=torch.float64) tensor(-2.2851, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8272, dtype=torch.float64) delta_t tensor(0.8657, dtype=torch.float64)
13 gae_duplicate tensor(1.7432, dtype=torch.float64) tensor(-3.6226, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8275, dtype=torch.float64) delta_t tensor(0.9553, dtype=torch.float64)
12 gae_duplicate tensor(2.3498, dtype=torch.float64) tensor(-4.8954, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3961, dtype=torch.float64) delta_t tensor(-0.6019, dtype=torch.float64)
11 gae_duplicate tensor(1.2779, dtype=torch.float64) tensor(-2.6558, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1805, dtype=torch.float64) delta_t tensor(-0.3957, dtype=torch.float64)
10 gae_duplicate tensor(0.6267, dtype=torch.float64) tensor(-1.3040, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0352, dtype=torch.float64) delta_t tensor(-1.0067, dtype=torch.float64)
9 gae_duplicate tensor(-0.5053, dtype=torch.float64) tensor(1.0488, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1970, dtype=torch.float64) delta_t tensor(0.5957, dtype=torch.float64)
8 gae_duplicate tensor(0.1914, dtype=torch.float64) tensor(-0.3983, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5205, dtype=torch.float64) delta_t tensor(-0.4535, dtype=torch.float64)
7 gae_duplicate tensor(-0.3004, dtype=torch.float64) tensor(0.6251, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0057, dtype=torch.float64) delta_t tensor(0.0561, dtype=torch.float64)
6 gae_duplicate tensor(-0.1842, dtype=torch.float64) tensor(0.3833, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5210, dtype=torch.float64) delta_t tensor(-0.5931, dtype=torch.float64)
5 gae_duplicate tensor(-0.7404, dtype=torch.float64) tensor(1.5387, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2333, dtype=torch.float64) delta_t tensor(0.3909, dtype=torch.float64)
4 gae_duplicate tensor(-0.2015, dtype=torch.float64) tensor(0.4187, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5210, dtype=torch.float64) delta_t tensor(-0.0566, dtype=torch.float64)
3 gae_duplicate tensor(-0.2178, dtype=torch.float64) tensor(0.4533, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7905, dtype=torch.float64) delta_t tensor(-1.8687, dtype=torch.float64)
2 gae_duplicate tensor(-2.0429, dtype=torch.float64) tensor(4.2563, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-12.063664436340332
value loss:37.1788330078125
entropies:37.429901123046875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.3524329662323 seconds
19 rew tensor(0.8090, dtype=torch.float64) delta_t tensor(-2.1719, dtype=torch.float64)
19 gae_duplicate tensor(-2.1719, dtype=torch.float64) tensor(4.5192, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8092, dtype=torch.float64) delta_t tensor(0.2238, dtype=torch.float64)
18 gae_duplicate tensor(-1.5137, dtype=torch.float64) tensor(3.1418, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8095, dtype=torch.float64) delta_t tensor(0.2883, dtype=torch.float64)
17 gae_duplicate tensor(-0.9227, dtype=torch.float64) tensor(1.9176, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8098, dtype=torch.float64) delta_t tensor(0.3697, dtype=torch.float64)
16 gae_duplicate tensor(-0.3685, dtype=torch.float64) tensor(0.7658, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8100, dtype=torch.float64) delta_t tensor(1.6719, dtype=torch.float64)
15 gae_duplicate tensor(1.3771, dtype=torch.float64) tensor(-2.8654, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8103, dtype=torch.float64) delta_t tensor(0.5414, dtype=torch.float64)
14 gae_duplicate tensor(1.6431, dtype=torch.float64) tensor(-3.4188, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8106, dtype=torch.float64) delta_t tensor(1.0750, dtype=torch.float64)
13 gae_duplicate tensor(2.3895, dtype=torch.float64) tensor(-4.9718, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3371, dtype=torch.float64) delta_t tensor(1.4245, dtype=torch.float64)
12 gae_duplicate tensor(3.3361, dtype=torch.float64) tensor(-6.9328, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2846, dtype=torch.float64) delta_t tensor(0.2223, dtype=torch.float64)
11 gae_duplicate tensor(2.8911, dtype=torch.float64) tensor(-6.0008, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1268, dtype=torch.float64) delta_t tensor(-2.8992, dtype=torch.float64)
10 gae_duplicate tensor(-0.5863, dtype=torch.float64) tensor(1.2184, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0216, dtype=torch.float64) delta_t tensor(-0.5596, dtype=torch.float64)
9 gae_duplicate tensor(-1.0287, dtype=torch.float64) tensor(2.1404, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0310, dtype=torch.float64) delta_t tensor(-0.4515, dtype=torch.float64)
8 gae_duplicate tensor(-1.2744, dtype=torch.float64) tensor(2.6517, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.9766, dtype=torch.float64) delta_t tensor(-1.8933, dtype=torch.float64)
7 gae_duplicate tensor(-2.9128, dtype=torch.float64) tensor(6.0533, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2423, dtype=torch.float64) delta_t tensor(0.3535, dtype=torch.float64)
6 gae_duplicate tensor(-1.9768, dtype=torch.float64) tensor(4.1031, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.9778, dtype=torch.float64) delta_t tensor(-2.6934, dtype=torch.float64)
5 gae_duplicate tensor(-4.2748, dtype=torch.float64) tensor(8.8948, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-10.9924, dtype=torch.float64) delta_t tensor(-9.0582, dtype=torch.float64)
4 gae_duplicate tensor(-12.4781, dtype=torch.float64) tensor(25.9638, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1775, dtype=torch.float64) delta_t tensor(-0.1383, dtype=torch.float64)
3 gae_duplicate tensor(-10.1208, dtype=torch.float64) tensor(21.0065, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2856, dtype=torch.float64) delta_t tensor(0.6866, dtype=torch.float64)
2 gae_duplicate tensor(-7.4100, dtype=torch.float64) tensor(15.4377, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-442.86920166015625
value loss:576.7832641601562
entropies:37.429901123046875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.701491117477417 seconds
19 rew tensor(0.8063, dtype=torch.float64) delta_t tensor(-0.5686, dtype=torch.float64)
19 gae_duplicate tensor(-0.5686, dtype=torch.float64) tensor(1.1816, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8066, dtype=torch.float64) delta_t tensor(0.7683, dtype=torch.float64)
18 gae_duplicate tensor(0.3134, dtype=torch.float64) tensor(-0.6521, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8069, dtype=torch.float64) delta_t tensor(-1.4391, dtype=torch.float64)
17 gae_duplicate tensor(-1.1883, dtype=torch.float64) tensor(2.4696, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7549, dtype=torch.float64) delta_t tensor(0.2471, dtype=torch.float64)
16 gae_duplicate tensor(-0.7036, dtype=torch.float64) tensor(1.4621, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7551, dtype=torch.float64) delta_t tensor(0.2945, dtype=torch.float64)
15 gae_duplicate tensor(-0.2683, dtype=torch.float64) tensor(0.5576, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7031, dtype=torch.float64) delta_t tensor(0.1838, dtype=torch.float64)
14 gae_duplicate tensor(-0.0309, dtype=torch.float64) tensor(0.0641, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3896, dtype=torch.float64) delta_t tensor(-0.1549, dtype=torch.float64)
13 gae_duplicate tensor(-0.1796, dtype=torch.float64) tensor(0.3737, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3374, dtype=torch.float64) delta_t tensor(-0.3451, dtype=torch.float64)
12 gae_duplicate tensor(-0.4888, dtype=torch.float64) tensor(1.0170, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5465, dtype=torch.float64) delta_t tensor(-0.0591, dtype=torch.float64)
11 gae_duplicate tensor(-0.4502, dtype=torch.float64) tensor(0.9356, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5467, dtype=torch.float64) delta_t tensor(0.0164, dtype=torch.float64)
10 gae_duplicate tensor(-0.3438, dtype=torch.float64) tensor(0.7135, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5468, dtype=torch.float64) delta_t tensor(0.0194, dtype=torch.float64)
9 gae_duplicate tensor(-0.2556, dtype=torch.float64) tensor(0.5318, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3857, dtype=torch.float64) delta_t tensor(-0.5892, dtype=torch.float64)
8 gae_duplicate tensor(-0.7937, dtype=torch.float64) tensor(1.6475, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5955, dtype=torch.float64) delta_t tensor(-2.0203, dtype=torch.float64)
7 gae_duplicate tensor(-2.6553, dtype=torch.float64) tensor(5.5181, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.8057, dtype=torch.float64) delta_t tensor(-1.4960, dtype=torch.float64)
6 gae_duplicate tensor(-3.6202, dtype=torch.float64) tensor(7.5234, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.2255, dtype=torch.float64) delta_t tensor(-0.5437, dtype=torch.float64)
5 gae_duplicate tensor(-3.4398, dtype=torch.float64) tensor(7.1572, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.9957, dtype=torch.float64) delta_t tensor(-5.8443, dtype=torch.float64)
4 gae_duplicate tensor(-8.5962, dtype=torch.float64) tensor(17.8859, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2439, dtype=torch.float64) delta_t tensor(1.5514, dtype=torch.float64)
3 gae_duplicate tensor(-5.3255, dtype=torch.float64) tensor(11.0947, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3494, dtype=torch.float64) delta_t tensor(0.1164, dtype=torch.float64)
2 gae_duplicate tensor(-4.1440, dtype=torch.float64) tensor(8.6014, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-409.61944580078125
value loss:232.65869140625
entropies:37.429901123046875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.8311)
ToM Target loss= tensor(301.5423)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.681855916976929 seconds
19 rew tensor(0.8069, dtype=torch.float64) delta_t tensor(-0.2538, dtype=torch.float64)
19 gae_duplicate tensor(-0.2538, dtype=torch.float64) tensor(0.5275, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8072, dtype=torch.float64) delta_t tensor(-1.0540, dtype=torch.float64)
18 gae_duplicate tensor(-1.2570, dtype=torch.float64) tensor(2.6124, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8075, dtype=torch.float64) delta_t tensor(0.3577, dtype=torch.float64)
17 gae_duplicate tensor(-0.6479, dtype=torch.float64) tensor(1.3481, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8077, dtype=torch.float64) delta_t tensor(0.2842, dtype=torch.float64)
16 gae_duplicate tensor(-0.2341, dtype=torch.float64) tensor(0.4877, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8080, dtype=torch.float64) delta_t tensor(0.3818, dtype=torch.float64)
15 gae_duplicate tensor(0.1945, dtype=torch.float64) tensor(-0.4052, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5987, dtype=torch.float64) delta_t tensor(0.1355, dtype=torch.float64)
14 gae_duplicate tensor(0.2911, dtype=torch.float64) tensor(-0.6049, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2845, dtype=torch.float64) delta_t tensor(-0.1463, dtype=torch.float64)
13 gae_duplicate tensor(0.0865, dtype=torch.float64) tensor(-0.1798, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1798, dtype=torch.float64) delta_t tensor(-0.1499, dtype=torch.float64)
12 gae_duplicate tensor(-0.0807, dtype=torch.float64) tensor(0.1674, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4941, dtype=torch.float64) delta_t tensor(0.1284, dtype=torch.float64)
11 gae_duplicate tensor(0.0639, dtype=torch.float64) tensor(-0.1330, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5989, dtype=torch.float64) delta_t tensor(1.4632, dtype=torch.float64)
10 gae_duplicate tensor(1.5144, dtype=torch.float64) tensor(-3.1548, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3897, dtype=torch.float64) delta_t tensor(-0.2409, dtype=torch.float64)
9 gae_duplicate tensor(0.9705, dtype=torch.float64) tensor(-2.0195, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0290, dtype=torch.float64) delta_t tensor(0.0138, dtype=torch.float64)
8 gae_duplicate tensor(0.7902, dtype=torch.float64) tensor(-1.6423, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1337, dtype=torch.float64) delta_t tensor(-0.4357, dtype=torch.float64)
7 gae_duplicate tensor(0.1965, dtype=torch.float64) tensor(-0.4093, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7616, dtype=torch.float64) delta_t tensor(-0.1683, dtype=torch.float64)
6 gae_duplicate tensor(-0.0111, dtype=torch.float64) tensor(0.0231, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5466, dtype=torch.float64) delta_t tensor(-0.2989, dtype=torch.float64)
5 gae_duplicate tensor(-0.3077, dtype=torch.float64) tensor(0.6403, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5457, dtype=torch.float64) delta_t tensor(-0.1505, dtype=torch.float64)
4 gae_duplicate tensor(-0.3967, dtype=torch.float64) tensor(0.8245, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1809, dtype=torch.float64) delta_t tensor(-1.0667, dtype=torch.float64)
3 gae_duplicate tensor(-1.3841, dtype=torch.float64) tensor(2.8764, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1349, dtype=torch.float64) delta_t tensor(0.4224, dtype=torch.float64)
2 gae_duplicate tensor(-0.6849, dtype=torch.float64) tensor(1.4269, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-15.434896469116211
value loss:13.192723274230957
entropies:37.429901123046875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4805498123168945 seconds
19 rew tensor(0.8085, dtype=torch.float64) delta_t tensor(-2.1459, dtype=torch.float64)
19 gae_duplicate tensor(-2.1459, dtype=torch.float64) tensor(4.4596, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8087, dtype=torch.float64) delta_t tensor(0.2179, dtype=torch.float64)
18 gae_duplicate tensor(-1.4989, dtype=torch.float64) tensor(3.1187, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8090, dtype=torch.float64) delta_t tensor(0.2637, dtype=torch.float64)
17 gae_duplicate tensor(-0.9354, dtype=torch.float64) tensor(1.9462, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8093, dtype=torch.float64) delta_t tensor(2.0665, dtype=torch.float64)
16 gae_duplicate tensor(1.3182, dtype=torch.float64) tensor(-2.7394, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8095, dtype=torch.float64) delta_t tensor(-1.4101, dtype=torch.float64)
15 gae_duplicate tensor(-0.3556, dtype=torch.float64) tensor(0.7381, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8098, dtype=torch.float64) delta_t tensor(0.4040, dtype=torch.float64)
14 gae_duplicate tensor(0.1195, dtype=torch.float64) tensor(-0.2483, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1872, dtype=torch.float64) delta_t tensor(-0.1053, dtype=torch.float64)
13 gae_duplicate tensor(-0.0097, dtype=torch.float64) tensor(0.0202, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1801, dtype=torch.float64) delta_t tensor(1.5552, dtype=torch.float64)
12 gae_duplicate tensor(1.5474, dtype=torch.float64) tensor(-3.2235, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1871, dtype=torch.float64) delta_t tensor(-2.0832, dtype=torch.float64)
11 gae_duplicate tensor(-0.8452, dtype=torch.float64) tensor(1.7545, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1347, dtype=torch.float64) delta_t tensor(-0.8426, dtype=torch.float64)
10 gae_duplicate tensor(-1.5188, dtype=torch.float64) tensor(3.1526, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4422, dtype=torch.float64) delta_t tensor(1.5165, dtype=torch.float64)
9 gae_duplicate tensor(0.3015, dtype=torch.float64) tensor(-0.6265, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0228, dtype=torch.float64) delta_t tensor(-1.4105, dtype=torch.float64)
8 gae_duplicate tensor(-1.1694, dtype=torch.float64) tensor(2.4331, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5539, dtype=torch.float64) delta_t tensor(0.1364, dtype=torch.float64)
7 gae_duplicate tensor(-0.7991, dtype=torch.float64) tensor(1.6627, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4419, dtype=torch.float64) delta_t tensor(0.0765, dtype=torch.float64)
6 gae_duplicate tensor(-0.5628, dtype=torch.float64) tensor(1.1724, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5496, dtype=torch.float64) delta_t tensor(0.3859, dtype=torch.float64)
5 gae_duplicate tensor(-0.0644, dtype=torch.float64) tensor(0.1340, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9740, dtype=torch.float64) delta_t tensor(-0.5395, dtype=torch.float64)
4 gae_duplicate tensor(-0.5910, dtype=torch.float64) tensor(1.2296, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0831, dtype=torch.float64) delta_t tensor(-0.9178, dtype=torch.float64)
3 gae_duplicate tensor(-1.3905, dtype=torch.float64) tensor(2.8968, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4983, dtype=torch.float64) delta_t tensor(-0.6649, dtype=torch.float64)
2 gae_duplicate tensor(-1.7773, dtype=torch.float64) tensor(3.6981, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-130.5967559814453
value loss:34.3197021484375
entropies:37.429901123046875
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5278849601745605 seconds
19 rew tensor(0.8079, dtype=torch.float64) delta_t tensor(-2.1508, dtype=torch.float64)
19 gae_duplicate tensor(-2.1508, dtype=torch.float64) tensor(4.4804, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8082, dtype=torch.float64) delta_t tensor(0.2728, dtype=torch.float64)
18 gae_duplicate tensor(-1.4478, dtype=torch.float64) tensor(3.0124, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8085, dtype=torch.float64) delta_t tensor(-0.0839, dtype=torch.float64)
17 gae_duplicate tensor(-1.2422, dtype=torch.float64) tensor(2.5845, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8087, dtype=torch.float64) delta_t tensor(0.7089, dtype=torch.float64)
16 gae_duplicate tensor(-0.2848, dtype=torch.float64) tensor(0.5926, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8090, dtype=torch.float64) delta_t tensor(0.4268, dtype=torch.float64)
15 gae_duplicate tensor(0.1989, dtype=torch.float64) tensor(-0.4139, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8093, dtype=torch.float64) delta_t tensor(0.3413, dtype=torch.float64)
14 gae_duplicate tensor(0.5005, dtype=torch.float64) tensor(-1.0413, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8095, dtype=torch.float64) delta_t tensor(0.9063, dtype=torch.float64)
13 gae_duplicate tensor(1.3066, dtype=torch.float64) tensor(-2.7155, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2343, dtype=torch.float64) delta_t tensor(0.9161, dtype=torch.float64)
12 gae_duplicate tensor(1.9614, dtype=torch.float64) tensor(-4.0810, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2343, dtype=torch.float64) delta_t tensor(-1.1011, dtype=torch.float64)
11 gae_duplicate tensor(0.4680, dtype=torch.float64) tensor(-0.9727, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2344, dtype=torch.float64) delta_t tensor(-0.2860, dtype=torch.float64)
10 gae_duplicate tensor(0.0884, dtype=torch.float64) tensor(-0.1842, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0775, dtype=torch.float64) delta_t tensor(-0.9961, dtype=torch.float64)
9 gae_duplicate tensor(-0.9254, dtype=torch.float64) tensor(1.9232, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1839, dtype=torch.float64) delta_t tensor(-0.6110, dtype=torch.float64)
8 gae_duplicate tensor(-1.3514, dtype=torch.float64) tensor(2.8118, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.7451, dtype=torch.float64) delta_t tensor(-2.8967, dtype=torch.float64)
7 gae_duplicate tensor(-3.9778, dtype=torch.float64) tensor(8.2765, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-4.2675, dtype=torch.float64) delta_t tensor(-3.8003, dtype=torch.float64)
6 gae_duplicate tensor(-6.9825, dtype=torch.float64) tensor(14.5113, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8680, dtype=torch.float64) delta_t tensor(-2.4577, dtype=torch.float64)
5 gae_duplicate tensor(-8.0437, dtype=torch.float64) tensor(16.7365, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1794, dtype=torch.float64) delta_t tensor(1.9275, dtype=torch.float64)
4 gae_duplicate tensor(-4.5075, dtype=torch.float64) tensor(9.3676, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6610, dtype=torch.float64) delta_t tensor(0.2172, dtype=torch.float64)
3 gae_duplicate tensor(-3.3887, dtype=torch.float64) tensor(7.0427, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7137, dtype=torch.float64) delta_t tensor(1.0471, dtype=torch.float64)
2 gae_duplicate tensor(-1.6639, dtype=torch.float64) tensor(3.4539, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-393.431396484375
value loss:271.4231872558594
entropies:37.42990493774414
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.724724054336548 seconds
19 rew tensor(0.8078, dtype=torch.float64) delta_t tensor(-1.9446, dtype=torch.float64)
19 gae_duplicate tensor(-1.9446, dtype=torch.float64) tensor(4.0461, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8081, dtype=torch.float64) delta_t tensor(-0.0037, dtype=torch.float64)
18 gae_duplicate tensor(-1.5594, dtype=torch.float64) tensor(3.2483, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8084, dtype=torch.float64) delta_t tensor(0.6937, dtype=torch.float64)
17 gae_duplicate tensor(-0.5538, dtype=torch.float64) tensor(1.1509, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8086, dtype=torch.float64) delta_t tensor(0.5914, dtype=torch.float64)
16 gae_duplicate tensor(0.1483, dtype=torch.float64) tensor(-0.3083, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8089, dtype=torch.float64) delta_t tensor(0.3613, dtype=torch.float64)
15 gae_duplicate tensor(0.4800, dtype=torch.float64) tensor(-0.9976, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8091, dtype=torch.float64) delta_t tensor(0.4021, dtype=torch.float64)
14 gae_duplicate tensor(0.7861, dtype=torch.float64) tensor(-1.6376, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8094, dtype=torch.float64) delta_t tensor(0.4056, dtype=torch.float64)
13 gae_duplicate tensor(1.0346, dtype=torch.float64) tensor(-2.1525, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8097, dtype=torch.float64) delta_t tensor(0.4664, dtype=torch.float64)
12 gae_duplicate tensor(1.2940, dtype=torch.float64) tensor(-2.6924, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8099, dtype=torch.float64) delta_t tensor(0.0349, dtype=torch.float64)
11 gae_duplicate tensor(1.0701, dtype=torch.float64) tensor(-2.2239, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8102, dtype=torch.float64) delta_t tensor(0.3936, dtype=torch.float64)
10 gae_duplicate tensor(1.2496, dtype=torch.float64) tensor(-2.6001, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5484, dtype=torch.float64) delta_t tensor(0.0544, dtype=torch.float64)
9 gae_duplicate tensor(1.0541, dtype=torch.float64) tensor(-2.1932, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1294, dtype=torch.float64) delta_t tensor(0.3454, dtype=torch.float64)
8 gae_duplicate tensor(1.1887, dtype=torch.float64) tensor(-2.4733, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0277, dtype=torch.float64) delta_t tensor(-0.9619, dtype=torch.float64)
7 gae_duplicate tensor(-0.0109, dtype=torch.float64) tensor(0.0227, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5514, dtype=torch.float64) delta_t tensor(1.3571, dtype=torch.float64)
6 gae_duplicate tensor(1.3484, dtype=torch.float64) tensor(-2.8088, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8134, dtype=torch.float64) delta_t tensor(0.4184, dtype=torch.float64)
5 gae_duplicate tensor(1.4971, dtype=torch.float64) tensor(-3.1150, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2850, dtype=torch.float64) delta_t tensor(-1.1181, dtype=torch.float64)
4 gae_duplicate tensor(0.0796, dtype=torch.float64) tensor(-0.1655, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8667, dtype=torch.float64) delta_t tensor(-0.9234, dtype=torch.float64)
3 gae_duplicate tensor(-0.8597, dtype=torch.float64) tensor(1.7867, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7622, dtype=torch.float64) delta_t tensor(-0.5765, dtype=torch.float64)
2 gae_duplicate tensor(-1.2642, dtype=torch.float64) tensor(2.6274, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:61.79247283935547
value loss:32.65394592285156
entropies:37.42991256713867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.548723220825195 seconds
19 rew tensor(0.8076, dtype=torch.float64) delta_t tensor(-2.0640, dtype=torch.float64)
19 gae_duplicate tensor(-2.0640, dtype=torch.float64) tensor(4.2994, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8079, dtype=torch.float64) delta_t tensor(0.1919, dtype=torch.float64)
18 gae_duplicate tensor(-1.4593, dtype=torch.float64) tensor(3.0328, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8081, dtype=torch.float64) delta_t tensor(0.1714, dtype=torch.float64)
17 gae_duplicate tensor(-0.9960, dtype=torch.float64) tensor(2.0723, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8084, dtype=torch.float64) delta_t tensor(0.1533, dtype=torch.float64)
16 gae_duplicate tensor(-0.6435, dtype=torch.float64) tensor(1.3403, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8086, dtype=torch.float64) delta_t tensor(0.4287, dtype=torch.float64)
15 gae_duplicate tensor(-0.0861, dtype=torch.float64) tensor(0.1789, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8089, dtype=torch.float64) delta_t tensor(0.3191, dtype=torch.float64)
14 gae_duplicate tensor(0.2502, dtype=torch.float64) tensor(-0.5207, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8091, dtype=torch.float64) delta_t tensor(0.2286, dtype=torch.float64)
13 gae_duplicate tensor(0.4288, dtype=torch.float64) tensor(-0.8911, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8094, dtype=torch.float64) delta_t tensor(0.2885, dtype=torch.float64)
12 gae_duplicate tensor(0.6315, dtype=torch.float64) tensor(-1.3140, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8097, dtype=torch.float64) delta_t tensor(0.9224, dtype=torch.float64)
11 gae_duplicate tensor(1.4276, dtype=torch.float64) tensor(-2.9635, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8099, dtype=torch.float64) delta_t tensor(0.4797, dtype=torch.float64)
10 gae_duplicate tensor(1.6218, dtype=torch.float64) tensor(-3.3744, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6528, dtype=torch.float64) delta_t tensor(0.7888, dtype=torch.float64)
9 gae_duplicate tensor(2.0863, dtype=torch.float64) tensor(-4.3308, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3382, dtype=torch.float64) delta_t tensor(-1.0995, dtype=torch.float64)
8 gae_duplicate tensor(0.5695, dtype=torch.float64) tensor(-1.1837, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1809, dtype=torch.float64) delta_t tensor(0.1930, dtype=torch.float64)
7 gae_duplicate tensor(0.6486, dtype=torch.float64) tensor(-1.3495, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7106, dtype=torch.float64) delta_t tensor(0.9761, dtype=torch.float64)
6 gae_duplicate tensor(1.4950, dtype=torch.float64) tensor(-3.1105, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9205, dtype=torch.float64) delta_t tensor(0.5209, dtype=torch.float64)
5 gae_duplicate tensor(1.7169, dtype=torch.float64) tensor(-3.5681, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4976, dtype=torch.float64) delta_t tensor(-1.2096, dtype=torch.float64)
4 gae_duplicate tensor(0.1639, dtype=torch.float64) tensor(-0.3406, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2888, dtype=torch.float64) delta_t tensor(-1.0245, dtype=torch.float64)
3 gae_duplicate tensor(-0.8934, dtype=torch.float64) tensor(1.8546, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0272, dtype=torch.float64) delta_t tensor(-1.1270, dtype=torch.float64)
2 gae_duplicate tensor(-1.8418, dtype=torch.float64) tensor(3.8320, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:36.89603042602539
value loss:41.4212532043457
entropies:37.429908752441406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.6851)
ToM Target loss= tensor(301.6467)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.462251663208008 seconds
19 rew tensor(0.7566, dtype=torch.float64) delta_t tensor(-1.5850, dtype=torch.float64)
19 gae_duplicate tensor(-1.5850, dtype=torch.float64) tensor(3.2940, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7568, dtype=torch.float64) delta_t tensor(0.3114, dtype=torch.float64)
18 gae_duplicate tensor(-0.9566, dtype=torch.float64) tensor(1.9904, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7044, dtype=torch.float64) delta_t tensor(0.2853, dtype=torch.float64)
17 gae_duplicate tensor(-0.4800, dtype=torch.float64) tensor(0.9976, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5994, dtype=torch.float64) delta_t tensor(0.2491, dtype=torch.float64)
16 gae_duplicate tensor(-0.1349, dtype=torch.float64) tensor(0.2803, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3892, dtype=torch.float64) delta_t tensor(0.1169, dtype=torch.float64)
15 gae_duplicate tensor(0.0090, dtype=torch.float64) tensor(-0.0187, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0314, dtype=torch.float64) delta_t tensor(1.3938, dtype=torch.float64)
14 gae_duplicate tensor(1.4010, dtype=torch.float64) tensor(-2.9149, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.5572, dtype=torch.float64) delta_t tensor(0.1914, dtype=torch.float64)
13 gae_duplicate tensor(1.3122, dtype=torch.float64) tensor(-2.7333, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8095, dtype=torch.float64) delta_t tensor(0.9302, dtype=torch.float64)
12 gae_duplicate tensor(1.9800, dtype=torch.float64) tensor(-4.1196, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7046, dtype=torch.float64) delta_t tensor(1.0322, dtype=torch.float64)
11 gae_duplicate tensor(2.6162, dtype=torch.float64) tensor(-5.4435, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5471, dtype=torch.float64) delta_t tensor(0.6971, dtype=torch.float64)
10 gae_duplicate tensor(2.7901, dtype=torch.float64) tensor(-5.8050, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2845, dtype=torch.float64) delta_t tensor(-1.1659, dtype=torch.float64)
9 gae_duplicate tensor(1.0662, dtype=torch.float64) tensor(-2.2158, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3371, dtype=torch.float64) delta_t tensor(-0.1534, dtype=torch.float64)
8 gae_duplicate tensor(0.6996, dtype=torch.float64) tensor(-1.4538, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1882, dtype=torch.float64) delta_t tensor(0.0046, dtype=torch.float64)
7 gae_duplicate tensor(0.5643, dtype=torch.float64) tensor(-1.1727, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2933, dtype=torch.float64) delta_t tensor(-0.1132, dtype=torch.float64)
6 gae_duplicate tensor(0.3382, dtype=torch.float64) tensor(-0.7045, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0286, dtype=torch.float64) delta_t tensor(0.8616, dtype=torch.float64)
5 gae_duplicate tensor(1.1322, dtype=torch.float64) tensor(-2.3557, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3966, dtype=torch.float64) delta_t tensor(-1.2222, dtype=torch.float64)
4 gae_duplicate tensor(-0.3165, dtype=torch.float64) tensor(0.6585, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7671, dtype=torch.float64) delta_t tensor(-0.6748, dtype=torch.float64)
3 gae_duplicate tensor(-0.9280, dtype=torch.float64) tensor(1.9308, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8724, dtype=torch.float64) delta_t tensor(0.2018, dtype=torch.float64)
2 gae_duplicate tensor(-0.5406, dtype=torch.float64) tensor(1.1247, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:110.84481811523438
value loss:45.756309509277344
entropies:37.42991256713867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.65748405456543 seconds
19 rew tensor(0.8099, dtype=torch.float64) delta_t tensor(-0.1465, dtype=torch.float64)
19 gae_duplicate tensor(-0.1465, dtype=torch.float64) tensor(0.3041, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8101, dtype=torch.float64) delta_t tensor(0.6189, dtype=torch.float64)
18 gae_duplicate tensor(0.5017, dtype=torch.float64) tensor(-1.0414, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8104, dtype=torch.float64) delta_t tensor(-1.2314, dtype=torch.float64)
17 gae_duplicate tensor(-0.8301, dtype=torch.float64) tensor(1.7271, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7056, dtype=torch.float64) delta_t tensor(0.0728, dtype=torch.float64)
16 gae_duplicate tensor(-0.5912, dtype=torch.float64) tensor(1.2301, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7058, dtype=torch.float64) delta_t tensor(0.2106, dtype=torch.float64)
15 gae_duplicate tensor(-0.2624, dtype=torch.float64) tensor(0.5459, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6535, dtype=torch.float64) delta_t tensor(0.2727, dtype=torch.float64)
14 gae_duplicate tensor(0.0628, dtype=torch.float64) tensor(-0.1308, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4962, dtype=torch.float64) delta_t tensor(-0.0028, dtype=torch.float64)
13 gae_duplicate tensor(0.0474, dtype=torch.float64) tensor(-0.0985, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6013, dtype=torch.float64) delta_t tensor(0.1837, dtype=torch.float64)
12 gae_duplicate tensor(0.2216, dtype=torch.float64) tensor(-0.4606, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7589, dtype=torch.float64) delta_t tensor(0.0910, dtype=torch.float64)
11 gae_duplicate tensor(0.2683, dtype=torch.float64) tensor(-0.5582, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7067, dtype=torch.float64) delta_t tensor(0.1750, dtype=torch.float64)
10 gae_duplicate tensor(0.3896, dtype=torch.float64) tensor(-0.8097, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-3.6488, dtype=torch.float64) delta_t tensor(-4.1768, dtype=torch.float64)
9 gae_duplicate tensor(-3.8651, dtype=torch.float64) tensor(8.0416, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5553, dtype=torch.float64) delta_t tensor(-1.0022, dtype=torch.float64)
8 gae_duplicate tensor(-4.0943, dtype=torch.float64) tensor(8.5185, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7132, dtype=torch.float64) delta_t tensor(-1.0274, dtype=torch.float64)
7 gae_duplicate tensor(-4.3028, dtype=torch.float64) tensor(8.9524, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.0808, dtype=torch.float64) delta_t tensor(-2.4263, dtype=torch.float64)
6 gae_duplicate tensor(-5.8685, dtype=torch.float64) tensor(12.1963, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3988, dtype=torch.float64) delta_t tensor(2.1099, dtype=torch.float64)
5 gae_duplicate tensor(-2.5849, dtype=torch.float64) tensor(5.3780, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0838, dtype=torch.float64) delta_t tensor(-0.7566, dtype=torch.float64)
4 gae_duplicate tensor(-2.8245, dtype=torch.float64) tensor(5.8702, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7158, dtype=torch.float64) delta_t tensor(1.3156, dtype=torch.float64)
3 gae_duplicate tensor(-0.9440, dtype=torch.float64) tensor(1.9643, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7686, dtype=torch.float64) delta_t tensor(-0.0764, dtype=torch.float64)
2 gae_duplicate tensor(-0.8316, dtype=torch.float64) tensor(1.7284, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-321.26971435546875
value loss:153.8365478515625
entropies:37.42991256713867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.379096031188965 seconds
19 rew tensor(0.8101, dtype=torch.float64) delta_t tensor(0.0852, dtype=torch.float64)
19 gae_duplicate tensor(0.0852, dtype=torch.float64) tensor(-0.1772, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8103, dtype=torch.float64) delta_t tensor(0.6653, dtype=torch.float64)
18 gae_duplicate tensor(0.7335, dtype=torch.float64) tensor(-1.5278, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8106, dtype=torch.float64) delta_t tensor(-0.8102, dtype=torch.float64)
17 gae_duplicate tensor(-0.2234, dtype=torch.float64) tensor(0.4648, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8108, dtype=torch.float64) delta_t tensor(0.4349, dtype=torch.float64)
16 gae_duplicate tensor(0.2562, dtype=torch.float64) tensor(-0.5318, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8111, dtype=torch.float64) delta_t tensor(0.3766, dtype=torch.float64)
15 gae_duplicate tensor(0.5815, dtype=torch.float64) tensor(-1.2099, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8113, dtype=torch.float64) delta_t tensor(0.4223, dtype=torch.float64)
14 gae_duplicate tensor(0.8875, dtype=torch.float64) tensor(-1.8465, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(0.4861, dtype=torch.float64)
13 gae_duplicate tensor(1.1960, dtype=torch.float64) tensor(-2.4829, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(1.2732, dtype=torch.float64)
12 gae_duplicate tensor(2.2300, dtype=torch.float64) tensor(-4.6449, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(1.2467, dtype=torch.float64)
11 gae_duplicate tensor(3.0307, dtype=torch.float64) tensor(-6.3058, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8123, dtype=torch.float64) delta_t tensor(1.6400, dtype=torch.float64)
10 gae_duplicate tensor(4.0646, dtype=torch.float64) tensor(-8.4473, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4445, dtype=torch.float64) delta_t tensor(0.3382, dtype=torch.float64)
9 gae_duplicate tensor(3.5899, dtype=torch.float64) tensor(-7.4692, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3968, dtype=torch.float64) delta_t tensor(-1.2684, dtype=torch.float64)
8 gae_duplicate tensor(1.6036, dtype=torch.float64) tensor(-3.3326, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4495, dtype=torch.float64) delta_t tensor(-0.6845, dtype=torch.float64)
7 gae_duplicate tensor(0.5984, dtype=torch.float64) tensor(-1.2450, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5547, dtype=torch.float64) delta_t tensor(-1.1400, dtype=torch.float64)
6 gae_duplicate tensor(-0.6613, dtype=torch.float64) tensor(1.3728, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6074, dtype=torch.float64) delta_t tensor(0.9587, dtype=torch.float64)
5 gae_duplicate tensor(0.4297, dtype=torch.float64) tensor(-0.8940, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4499, dtype=torch.float64) delta_t tensor(0.3200, dtype=torch.float64)
4 gae_duplicate tensor(0.6637, dtype=torch.float64) tensor(-1.3809, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1856, dtype=torch.float64) delta_t tensor(-0.3140, dtype=torch.float64)
3 gae_duplicate tensor(0.2170, dtype=torch.float64) tensor(-0.4514, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4505, dtype=torch.float64) delta_t tensor(-0.5661, dtype=torch.float64)
2 gae_duplicate tensor(-0.3926, dtype=torch.float64) tensor(0.8149, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:234.64614868164062
value loss:76.46578216552734
entropies:37.42991256713867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.568164110183716 seconds
19 rew tensor(0.8101, dtype=torch.float64) delta_t tensor(-1.8045, dtype=torch.float64)
19 gae_duplicate tensor(-1.8045, dtype=torch.float64) tensor(3.7461, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8103, dtype=torch.float64) delta_t tensor(0.2199, dtype=torch.float64)
18 gae_duplicate tensor(-1.2237, dtype=torch.float64) tensor(2.5460, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8106, dtype=torch.float64) delta_t tensor(0.9072, dtype=torch.float64)
17 gae_duplicate tensor(-0.0717, dtype=torch.float64) tensor(0.1493, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8108, dtype=torch.float64) delta_t tensor(1.3762, dtype=torch.float64)
16 gae_duplicate tensor(1.3188, dtype=torch.float64) tensor(-2.7409, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8111, dtype=torch.float64) delta_t tensor(0.8767, dtype=torch.float64)
15 gae_duplicate tensor(1.9317, dtype=torch.float64) tensor(-4.0235, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8113, dtype=torch.float64) delta_t tensor(0.6059, dtype=torch.float64)
14 gae_duplicate tensor(2.1513, dtype=torch.float64) tensor(-4.4712, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(0.6436, dtype=torch.float64)
13 gae_duplicate tensor(2.3646, dtype=torch.float64) tensor(-4.9143, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(0.6438, dtype=torch.float64)
12 gae_duplicate tensor(2.5355, dtype=torch.float64) tensor(-5.2753, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(-0.8839, dtype=torch.float64)
11 gae_duplicate tensor(1.1445, dtype=torch.float64) tensor(-2.3813, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5491, dtype=torch.float64) delta_t tensor(0.2098, dtype=torch.float64)
10 gae_duplicate tensor(1.1254, dtype=torch.float64) tensor(-2.3388, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3386, dtype=torch.float64) delta_t tensor(0.1798, dtype=torch.float64)
9 gae_duplicate tensor(1.0801, dtype=torch.float64) tensor(-2.2448, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2861, dtype=torch.float64) delta_t tensor(1.3706, dtype=torch.float64)
8 gae_duplicate tensor(2.2347, dtype=torch.float64) tensor(-4.6444, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0756, dtype=torch.float64) delta_t tensor(0.7039, dtype=torch.float64)
7 gae_duplicate tensor(2.4917, dtype=torch.float64) tensor(-5.1841, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7137, dtype=torch.float64) delta_t tensor(-0.6495, dtype=torch.float64)
6 gae_duplicate tensor(1.3438, dtype=torch.float64) tensor(-2.7929, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1348, dtype=torch.float64) delta_t tensor(0.6747, dtype=torch.float64)
5 gae_duplicate tensor(1.7497, dtype=torch.float64) tensor(-3.6404, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6089, dtype=torch.float64) delta_t tensor(-1.7250, dtype=torch.float64)
4 gae_duplicate tensor(-0.3252, dtype=torch.float64) tensor(0.6759, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3994, dtype=torch.float64) delta_t tensor(-0.9416, dtype=torch.float64)
3 gae_duplicate tensor(-1.2018, dtype=torch.float64) tensor(2.4976, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1370, dtype=torch.float64) delta_t tensor(-0.4423, dtype=torch.float64)
2 gae_duplicate tensor(-1.4037, dtype=torch.float64) tensor(2.9206, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:191.576171875
value loss:75.31692504882812
entropies:37.42991256713867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.657945156097412 seconds
19 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(-1.8328, dtype=torch.float64)
19 gae_duplicate tensor(-1.8328, dtype=torch.float64) tensor(3.8132, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7591, dtype=torch.float64) delta_t tensor(0.2157, dtype=torch.float64)
18 gae_duplicate tensor(-1.2505, dtype=torch.float64) tensor(2.6018, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7066, dtype=torch.float64) delta_t tensor(0.1206, dtype=torch.float64)
17 gae_duplicate tensor(-0.8798, dtype=torch.float64) tensor(1.8326, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5486, dtype=torch.float64) delta_t tensor(0.0979, dtype=torch.float64)
16 gae_duplicate tensor(-0.6060, dtype=torch.float64) tensor(1.2608, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3906, dtype=torch.float64) delta_t tensor(0.1825, dtype=torch.float64)
15 gae_duplicate tensor(-0.3023, dtype=torch.float64) tensor(0.6284, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0218, dtype=torch.float64) delta_t tensor(-0.6699, dtype=torch.float64)
14 gae_duplicate tensor(-0.9117, dtype=torch.float64) tensor(1.8969, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6541, dtype=torch.float64) delta_t tensor(0.1247, dtype=torch.float64)
13 gae_duplicate tensor(-0.6047, dtype=torch.float64) tensor(1.2553, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6016, dtype=torch.float64) delta_t tensor(1.9257, dtype=torch.float64)
12 gae_duplicate tensor(1.4420, dtype=torch.float64) tensor(-2.9968, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3383, dtype=torch.float64) delta_t tensor(-1.3198, dtype=torch.float64)
11 gae_duplicate tensor(-0.1662, dtype=torch.float64) tensor(0.3450, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.8212, dtype=torch.float64) delta_t tensor(-0.5871, dtype=torch.float64)
10 gae_duplicate tensor(-0.7201, dtype=torch.float64) tensor(1.4981, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1271, dtype=torch.float64) delta_t tensor(-1.6822, dtype=torch.float64)
9 gae_duplicate tensor(-2.2582, dtype=torch.float64) tensor(4.6934, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1363, dtype=torch.float64) delta_t tensor(-0.1178, dtype=torch.float64)
8 gae_duplicate tensor(-1.9244, dtype=torch.float64) tensor(4.0038, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2944, dtype=torch.float64) delta_t tensor(0.9134, dtype=torch.float64)
7 gae_duplicate tensor(-0.6261, dtype=torch.float64) tensor(1.3027, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0216, dtype=torch.float64) delta_t tensor(-0.2708, dtype=torch.float64)
6 gae_duplicate tensor(-0.7717, dtype=torch.float64) tensor(1.6038, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8214, dtype=torch.float64) delta_t tensor(-0.7821, dtype=torch.float64)
5 gae_duplicate tensor(-1.3995, dtype=torch.float64) tensor(2.9148, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8229, dtype=torch.float64) delta_t tensor(-1.9166, dtype=torch.float64)
4 gae_duplicate tensor(-3.0362, dtype=torch.float64) tensor(6.3169, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2838, dtype=torch.float64) delta_t tensor(0.7629, dtype=torch.float64)
3 gae_duplicate tensor(-1.6660, dtype=torch.float64) tensor(3.4624, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4024, dtype=torch.float64) delta_t tensor(-1.4092, dtype=torch.float64)
2 gae_duplicate tensor(-2.7420, dtype=torch.float64) tensor(5.6986, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-253.91397094726562
value loss:61.85823059082031
entropies:37.42991256713867
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(416.1388)
ToM Target loss= tensor(301.9155)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.4166929721832275 seconds
19 rew tensor(0.8114, dtype=torch.float64) delta_t tensor(-1.7388, dtype=torch.float64)
19 gae_duplicate tensor(-1.7388, dtype=torch.float64) tensor(3.6099, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(0.1969, dtype=torch.float64)
18 gae_duplicate tensor(-1.1941, dtype=torch.float64) tensor(2.4871, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8119, dtype=torch.float64) delta_t tensor(0.1606, dtype=torch.float64)
17 gae_duplicate tensor(-0.7947, dtype=torch.float64) tensor(1.6535, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(0.8946, dtype=torch.float64)
16 gae_duplicate tensor(0.2588, dtype=torch.float64) tensor(-0.5379, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8124, dtype=torch.float64) delta_t tensor(0.2440, dtype=torch.float64)
15 gae_duplicate tensor(0.4510, dtype=torch.float64) tensor(-0.9394, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8126, dtype=torch.float64) delta_t tensor(3.5490, dtype=torch.float64)
14 gae_duplicate tensor(3.9098, dtype=torch.float64) tensor(-8.1346, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(1.4250, dtype=torch.float64)
13 gae_duplicate tensor(4.5529, dtype=torch.float64) tensor(-9.4723, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(1.5655, dtype=torch.float64)
12 gae_duplicate tensor(5.2078, dtype=torch.float64) tensor(-10.8464, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(1.1787, dtype=torch.float64)
11 gae_duplicate tensor(5.3449, dtype=torch.float64) tensor(-11.1320, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.6226, dtype=torch.float64)
10 gae_duplicate tensor(4.8986, dtype=torch.float64) tensor(-10.1916, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5499, dtype=torch.float64) delta_t tensor(-2.2473, dtype=torch.float64)
9 gae_duplicate tensor(1.6715, dtype=torch.float64) tensor(-3.4740, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0749, dtype=torch.float64) delta_t tensor(-0.3317, dtype=torch.float64)
8 gae_duplicate tensor(1.0056, dtype=torch.float64) tensor(-2.0921, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0222, dtype=torch.float64) delta_t tensor(-0.0049, dtype=torch.float64)
7 gae_duplicate tensor(0.7996, dtype=torch.float64) tensor(-1.6653, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2944, dtype=torch.float64) delta_t tensor(-0.4487, dtype=torch.float64)
6 gae_duplicate tensor(0.1910, dtype=torch.float64) tensor(-0.3969, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5055, dtype=torch.float64) delta_t tensor(1.2762, dtype=torch.float64)
5 gae_duplicate tensor(1.4290, dtype=torch.float64) tensor(-2.9700, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4529, dtype=torch.float64) delta_t tensor(0.8438, dtype=torch.float64)
4 gae_duplicate tensor(1.9870, dtype=torch.float64) tensor(-4.1341, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1387, dtype=torch.float64) delta_t tensor(-1.0026, dtype=torch.float64)
3 gae_duplicate tensor(0.5870, dtype=torch.float64) tensor(-1.2200, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8227, dtype=torch.float64) delta_t tensor(-0.1823, dtype=torch.float64)
2 gae_duplicate tensor(0.2873, dtype=torch.float64) tensor(-0.5970, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:359.19537353515625
value loss:197.9249267578125
entropies:37.42991256713867
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.3296918869018555 seconds
19 rew tensor(0.8111, dtype=torch.float64) delta_t tensor(-1.6145, dtype=torch.float64)
19 gae_duplicate tensor(-1.6145, dtype=torch.float64) tensor(3.3588, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8113, dtype=torch.float64) delta_t tensor(0.3653, dtype=torch.float64)
18 gae_duplicate tensor(-0.9263, dtype=torch.float64) tensor(1.9232, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(0.4466, dtype=torch.float64)
17 gae_duplicate tensor(-0.2944, dtype=torch.float64) tensor(0.6131, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(0.4537, dtype=torch.float64)
16 gae_duplicate tensor(0.2181, dtype=torch.float64) tensor(-0.4534, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(0.3695, dtype=torch.float64)
15 gae_duplicate tensor(0.5440, dtype=torch.float64) tensor(-1.1295, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8123, dtype=torch.float64) delta_t tensor(0.3156, dtype=torch.float64)
14 gae_duplicate tensor(0.7508, dtype=torch.float64) tensor(-1.5620, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8126, dtype=torch.float64) delta_t tensor(0.3415, dtype=torch.float64)
13 gae_duplicate tensor(0.9421, dtype=torch.float64) tensor(-1.9580, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(0.3766, dtype=torch.float64)
12 gae_duplicate tensor(1.1303, dtype=torch.float64) tensor(-2.3540, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.3984, dtype=torch.float64)
11 gae_duplicate tensor(1.3027, dtype=torch.float64) tensor(-2.7076, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(0.4110, dtype=torch.float64)
10 gae_duplicate tensor(1.4532, dtype=torch.float64) tensor(-3.0232, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3377, dtype=torch.float64) delta_t tensor(0.1836, dtype=torch.float64)
9 gae_duplicate tensor(1.3461, dtype=torch.float64) tensor(-2.7978, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0207, dtype=torch.float64) delta_t tensor(-0.3357, dtype=torch.float64)
8 gae_duplicate tensor(0.7412, dtype=torch.float64) tensor(-1.5404, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3493, dtype=torch.float64) delta_t tensor(0.7480, dtype=torch.float64)
7 gae_duplicate tensor(1.3410, dtype=torch.float64) tensor(-2.7843, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5079, dtype=torch.float64) delta_t tensor(-1.1477, dtype=torch.float64)
6 gae_duplicate tensor(-0.0749, dtype=torch.float64) tensor(0.1556, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7231, dtype=torch.float64) delta_t tensor(-0.6957, dtype=torch.float64)
5 gae_duplicate tensor(-0.7556, dtype=torch.float64) tensor(1.5704, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7068, dtype=torch.float64) delta_t tensor(1.1966, dtype=torch.float64)
4 gae_duplicate tensor(0.5922, dtype=torch.float64) tensor(-1.2308, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9841, dtype=torch.float64) delta_t tensor(-0.1405, dtype=torch.float64)
3 gae_duplicate tensor(0.3332, dtype=torch.float64) tensor(-0.6933, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7731, dtype=torch.float64) delta_t tensor(-2.2119, dtype=torch.float64)
2 gae_duplicate tensor(-1.9453, dtype=torch.float64) tensor(4.0512, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:62.248268127441406
value loss:29.121196746826172
entropies:37.4299201965332
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.551471948623657 seconds
19 rew tensor(0.8103, dtype=torch.float64) delta_t tensor(-1.6582, dtype=torch.float64)
19 gae_duplicate tensor(-1.6582, dtype=torch.float64) tensor(3.4497, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8105, dtype=torch.float64) delta_t tensor(0.6443, dtype=torch.float64)
18 gae_duplicate tensor(-0.6823, dtype=torch.float64) tensor(1.4194, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8107, dtype=torch.float64) delta_t tensor(0.5958, dtype=torch.float64)
17 gae_duplicate tensor(0.0500, dtype=torch.float64) tensor(-0.1041, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8110, dtype=torch.float64) delta_t tensor(0.4077, dtype=torch.float64)
16 gae_duplicate tensor(0.4477, dtype=torch.float64) tensor(-0.9323, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8112, dtype=torch.float64) delta_t tensor(0.3805, dtype=torch.float64)
15 gae_duplicate tensor(0.7387, dtype=torch.float64) tensor(-1.5382, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8115, dtype=torch.float64) delta_t tensor(0.2883, dtype=torch.float64)
14 gae_duplicate tensor(0.8793, dtype=torch.float64) tensor(-1.8258, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8117, dtype=torch.float64) delta_t tensor(0.6342, dtype=torch.float64)
13 gae_duplicate tensor(1.3376, dtype=torch.float64) tensor(-2.7776, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5479, dtype=torch.float64) delta_t tensor(-0.1584, dtype=torch.float64)
12 gae_duplicate tensor(0.9117, dtype=torch.float64) tensor(-1.8950, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6009, dtype=torch.float64) delta_t tensor(1.5821, dtype=torch.float64)
11 gae_duplicate tensor(2.3115, dtype=torch.float64) tensor(-4.8090, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4954, dtype=torch.float64) delta_t tensor(-0.6207, dtype=torch.float64)
10 gae_duplicate tensor(1.2285, dtype=torch.float64) tensor(-2.5558, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5483, dtype=torch.float64) delta_t tensor(-0.1720, dtype=torch.float64)
9 gae_duplicate tensor(0.8108, dtype=torch.float64) tensor(-1.6867, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2318, dtype=torch.float64) delta_t tensor(-0.0525, dtype=torch.float64)
8 gae_duplicate tensor(0.5961, dtype=torch.float64) tensor(-1.2378, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5623, dtype=torch.float64) delta_t tensor(-0.1631, dtype=torch.float64)
7 gae_duplicate tensor(0.3137, dtype=torch.float64) tensor(-0.6527, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.9328, dtype=torch.float64) delta_t tensor(-0.9154, dtype=torch.float64)
6 gae_duplicate tensor(-0.6644, dtype=torch.float64) tensor(1.3796, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7198, dtype=torch.float64) delta_t tensor(-0.2843, dtype=torch.float64)
5 gae_duplicate tensor(-0.8158, dtype=torch.float64) tensor(1.6972, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.8355, dtype=torch.float64) delta_t tensor(-2.6220, dtype=torch.float64)
4 gae_duplicate tensor(-3.2747, dtype=torch.float64) tensor(6.8193, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1409, dtype=torch.float64) delta_t tensor(0.3861, dtype=torch.float64)
3 gae_duplicate tensor(-2.2336, dtype=torch.float64) tensor(4.6513, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1410, dtype=torch.float64) delta_t tensor(1.4491, dtype=torch.float64)
2 gae_duplicate tensor(-0.3378, dtype=torch.float64) tensor(0.7028, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1.7484476566314697
value loss:48.381004333496094
entropies:37.42992401123047
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.460407018661499 seconds
19 rew tensor(0.8104, dtype=torch.float64) delta_t tensor(-1.5649, dtype=torch.float64)
19 gae_duplicate tensor(-1.5649, dtype=torch.float64) tensor(3.2526, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8106, dtype=torch.float64) delta_t tensor(0.1079, dtype=torch.float64)
18 gae_duplicate tensor(-1.1440, dtype=torch.float64) tensor(2.3801, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8109, dtype=torch.float64) delta_t tensor(0.9736, dtype=torch.float64)
17 gae_duplicate tensor(0.0584, dtype=torch.float64) tensor(-0.1214, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8111, dtype=torch.float64) delta_t tensor(0.3467, dtype=torch.float64)
16 gae_duplicate tensor(0.3934, dtype=torch.float64) tensor(-0.8177, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8114, dtype=torch.float64) delta_t tensor(0.4929, dtype=torch.float64)
15 gae_duplicate tensor(0.8076, dtype=torch.float64) tensor(-1.6801, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(0.4279, dtype=torch.float64)
14 gae_duplicate tensor(1.0739, dtype=torch.float64) tensor(-2.2343, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8119, dtype=torch.float64) delta_t tensor(0.4281, dtype=torch.float64)
13 gae_duplicate tensor(1.2873, dtype=torch.float64) tensor(-2.6781, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(0.4229, dtype=torch.float64)
12 gae_duplicate tensor(1.4527, dtype=torch.float64) tensor(-3.0196, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6537, dtype=torch.float64) delta_t tensor(0.1284, dtype=torch.float64)
11 gae_duplicate tensor(1.2906, dtype=torch.float64) tensor(-2.6799, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3895, dtype=torch.float64) delta_t tensor(-0.2840, dtype=torch.float64)
10 gae_duplicate tensor(0.7484, dtype=torch.float64) tensor(-1.5542, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2839, dtype=torch.float64) delta_t tensor(0.2318, dtype=torch.float64)
9 gae_duplicate tensor(0.8306, dtype=torch.float64) tensor(-1.7280, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4561, dtype=torch.float64) delta_t tensor(-0.7916, dtype=torch.float64)
8 gae_duplicate tensor(-0.1271, dtype=torch.float64) tensor(0.2644, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4033, dtype=torch.float64) delta_t tensor(1.0686, dtype=torch.float64)
7 gae_duplicate tensor(0.9670, dtype=torch.float64) tensor(-2.0098, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5091, dtype=torch.float64) delta_t tensor(-0.7159, dtype=torch.float64)
6 gae_duplicate tensor(0.0577, dtype=torch.float64) tensor(-0.1198, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6715, dtype=torch.float64) delta_t tensor(-0.0537, dtype=torch.float64)
5 gae_duplicate tensor(-0.0075, dtype=torch.float64) tensor(0.0156, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7584, dtype=torch.float64) delta_t tensor(0.2215, dtype=torch.float64)
4 gae_duplicate tensor(0.2155, dtype=torch.float64) tensor(-0.4480, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0910, dtype=torch.float64) delta_t tensor(-0.3024, dtype=torch.float64)
3 gae_duplicate tensor(-0.1299, dtype=torch.float64) tensor(0.2703, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4572, dtype=torch.float64) delta_t tensor(-0.4843, dtype=torch.float64)
2 gae_duplicate tensor(-0.5883, dtype=torch.float64) tensor(1.2250, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:68.97386932373047
value loss:20.652896881103516
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.42913818359375 seconds
19 rew tensor(0.8110, dtype=torch.float64) delta_t tensor(-1.3195, dtype=torch.float64)
19 gae_duplicate tensor(-1.3195, dtype=torch.float64) tensor(2.7425, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8113, dtype=torch.float64) delta_t tensor(0.3972, dtype=torch.float64)
18 gae_duplicate tensor(-0.6583, dtype=torch.float64) tensor(1.3683, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8115, dtype=torch.float64) delta_t tensor(0.3719, dtype=torch.float64)
17 gae_duplicate tensor(-0.1548, dtype=torch.float64) tensor(0.3223, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8117, dtype=torch.float64) delta_t tensor(0.3110, dtype=torch.float64)
16 gae_duplicate tensor(0.1872, dtype=torch.float64) tensor(-0.3895, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8120, dtype=torch.float64) delta_t tensor(2.4898, dtype=torch.float64)
15 gae_duplicate tensor(2.6396, dtype=torch.float64) tensor(-5.4862, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8122, dtype=torch.float64) delta_t tensor(0.3217, dtype=torch.float64)
14 gae_duplicate tensor(2.4334, dtype=torch.float64) tensor(-5.0624, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4945, dtype=torch.float64) delta_t tensor(0.1613, dtype=torch.float64)
13 gae_duplicate tensor(2.1080, dtype=torch.float64) tensor(-4.3856, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2826, dtype=torch.float64) delta_t tensor(-0.6397, dtype=torch.float64)
12 gae_duplicate tensor(1.0467, dtype=torch.float64) tensor(-2.1775, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2826, dtype=torch.float64) delta_t tensor(-0.1918, dtype=torch.float64)
11 gae_duplicate tensor(0.6456, dtype=torch.float64) tensor(-1.3418, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0708, dtype=torch.float64) delta_t tensor(-0.1945, dtype=torch.float64)
10 gae_duplicate tensor(0.3219, dtype=torch.float64) tensor(-0.6704, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0708, dtype=torch.float64) delta_t tensor(0.0964, dtype=torch.float64)
9 gae_duplicate tensor(0.3539, dtype=torch.float64) tensor(-0.7356, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5647, dtype=torch.float64) delta_t tensor(-1.6253, dtype=torch.float64)
8 gae_duplicate tensor(-1.3422, dtype=torch.float64) tensor(2.7872, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9355, dtype=torch.float64) delta_t tensor(0.4415, dtype=torch.float64)
7 gae_duplicate tensor(-0.6323, dtype=torch.float64) tensor(1.3166, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5998, dtype=torch.float64) delta_t tensor(0.6680, dtype=torch.float64)
6 gae_duplicate tensor(0.1622, dtype=torch.float64) tensor(-0.3371, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4590, dtype=torch.float64) delta_t tensor(0.3040, dtype=torch.float64)
5 gae_duplicate tensor(0.4337, dtype=torch.float64) tensor(-0.9015, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1232, dtype=torch.float64) delta_t tensor(0.3514, dtype=torch.float64)
4 gae_duplicate tensor(0.6984, dtype=torch.float64) tensor(-1.4543, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6177, dtype=torch.float64) delta_t tensor(-0.3289, dtype=torch.float64)
3 gae_duplicate tensor(0.2299, dtype=torch.float64) tensor(-0.4778, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0413, dtype=torch.float64) delta_t tensor(0.2397, dtype=torch.float64)
2 gae_duplicate tensor(0.4236, dtype=torch.float64) tensor(-0.8813, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:93.46083068847656
value loss:36.66423034667969
entropies:37.429931640625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.7792)
ToM Target loss= tensor(301.6544)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.559566020965576 seconds
19 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(-1.6150, dtype=torch.float64)
19 gae_duplicate tensor(-1.6150, dtype=torch.float64) tensor(3.3599, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(0.0712, dtype=torch.float64)
18 gae_duplicate tensor(-1.2209, dtype=torch.float64) tensor(2.5376, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8123, dtype=torch.float64) delta_t tensor(0.6954, dtype=torch.float64)
17 gae_duplicate tensor(-0.2813, dtype=torch.float64) tensor(0.5852, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8125, dtype=torch.float64) delta_t tensor(0.4709, dtype=torch.float64)
16 gae_duplicate tensor(0.2459, dtype=torch.float64) tensor(-0.5111, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(0.2208, dtype=torch.float64)
15 gae_duplicate tensor(0.4175, dtype=torch.float64) tensor(-0.8678, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(0.3062, dtype=torch.float64)
14 gae_duplicate tensor(0.6402, dtype=torch.float64) tensor(-1.3306, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(2.8453, dtype=torch.float64)
13 gae_duplicate tensor(3.3574, dtype=torch.float64) tensor(-6.9785, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5480, dtype=torch.float64) delta_t tensor(0.3077, dtype=torch.float64)
12 gae_duplicate tensor(2.9936, dtype=torch.float64) tensor(-6.2280, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3358, dtype=torch.float64) delta_t tensor(1.2218, dtype=torch.float64)
11 gae_duplicate tensor(3.6168, dtype=torch.float64) tensor(-7.5242, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1767, dtype=torch.float64) delta_t tensor(-1.7143, dtype=torch.float64)
10 gae_duplicate tensor(1.1791, dtype=torch.float64) tensor(-2.4552, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1236, dtype=torch.float64) delta_t tensor(-0.9575, dtype=torch.float64)
9 gae_duplicate tensor(-0.0143, dtype=torch.float64) tensor(0.0297, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4600, dtype=torch.float64) delta_t tensor(0.7989, dtype=torch.float64)
8 gae_duplicate tensor(0.7875, dtype=torch.float64) tensor(-1.6368, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3540, dtype=torch.float64) delta_t tensor(-0.8439, dtype=torch.float64)
7 gae_duplicate tensor(-0.2139, dtype=torch.float64) tensor(0.4445, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3010, dtype=torch.float64) delta_t tensor(0.2853, dtype=torch.float64)
6 gae_duplicate tensor(0.1142, dtype=torch.float64) tensor(-0.2376, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2026, dtype=torch.float64) delta_t tensor(-0.6406, dtype=torch.float64)
5 gae_duplicate tensor(-0.5493, dtype=torch.float64) tensor(1.1428, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7335, dtype=torch.float64) delta_t tensor(-0.8373, dtype=torch.float64)
4 gae_duplicate tensor(-1.2768, dtype=torch.float64) tensor(2.6538, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1961, dtype=torch.float64) delta_t tensor(-0.5965, dtype=torch.float64)
3 gae_duplicate tensor(-1.6179, dtype=torch.float64) tensor(3.3628, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2492, dtype=torch.float64) delta_t tensor(-0.5409, dtype=torch.float64)
2 gae_duplicate tensor(-1.8353, dtype=torch.float64) tensor(3.8214, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:57.86939239501953
value loss:72.18760681152344
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.611446857452393 seconds
19 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(-1.7503, dtype=torch.float64)
19 gae_duplicate tensor(-1.7503, dtype=torch.float64) tensor(3.6414, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7602, dtype=torch.float64) delta_t tensor(0.2256, dtype=torch.float64)
18 gae_duplicate tensor(-1.1747, dtype=torch.float64) tensor(2.4437, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7072, dtype=torch.float64) delta_t tensor(0.1570, dtype=torch.float64)
17 gae_duplicate tensor(-0.7828, dtype=torch.float64) tensor(1.6299, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6011, dtype=torch.float64) delta_t tensor(0.0324, dtype=torch.float64)
16 gae_duplicate tensor(-0.5938, dtype=torch.float64) tensor(1.2353, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3354, dtype=torch.float64) delta_t tensor(0.1186, dtype=torch.float64)
15 gae_duplicate tensor(-0.3564, dtype=torch.float64) tensor(0.7408, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0166, dtype=torch.float64) delta_t tensor(-0.6566, dtype=torch.float64)
14 gae_duplicate tensor(-0.9418, dtype=torch.float64) tensor(1.9558, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6543, dtype=torch.float64) delta_t tensor(0.1185, dtype=torch.float64)
13 gae_duplicate tensor(-0.6349, dtype=torch.float64) tensor(1.3185, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6013, dtype=torch.float64) delta_t tensor(0.2221, dtype=torch.float64)
12 gae_duplicate tensor(-0.2858, dtype=torch.float64) tensor(0.5950, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2295, dtype=torch.float64) delta_t tensor(2.4042, dtype=torch.float64)
11 gae_duplicate tensor(2.1756, dtype=torch.float64) tensor(-4.5261, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-2.0015, dtype=torch.float64) delta_t tensor(-4.2729, dtype=torch.float64)
10 gae_duplicate tensor(-2.5325, dtype=torch.float64) tensor(5.2639, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0695, dtype=torch.float64) delta_t tensor(-0.5101, dtype=torch.float64)
9 gae_duplicate tensor(-2.5360, dtype=torch.float64) tensor(5.2805, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2493, dtype=torch.float64) delta_t tensor(-0.2962, dtype=torch.float64)
8 gae_duplicate tensor(-2.3250, dtype=torch.float64) tensor(4.8283, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1962, dtype=torch.float64) delta_t tensor(0.8997, dtype=torch.float64)
7 gae_duplicate tensor(-0.9603, dtype=torch.float64) tensor(1.9959, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6006, dtype=torch.float64) delta_t tensor(0.4984, dtype=torch.float64)
6 gae_duplicate tensor(-0.2698, dtype=torch.float64) tensor(0.5614, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5239, dtype=torch.float64) delta_t tensor(0.2816, dtype=torch.float64)
5 gae_duplicate tensor(0.0657, dtype=torch.float64) tensor(-0.1368, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4941, dtype=torch.float64) delta_t tensor(-0.1441, dtype=torch.float64)
4 gae_duplicate tensor(-0.0916, dtype=torch.float64) tensor(0.1905, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2588, dtype=torch.float64) delta_t tensor(0.1818, dtype=torch.float64)
3 gae_duplicate tensor(0.1086, dtype=torch.float64) tensor(-0.2258, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2594, dtype=torch.float64) delta_t tensor(-2.0658, dtype=torch.float64)
2 gae_duplicate tensor(-1.9790, dtype=torch.float64) tensor(4.1133, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-186.5572052001953
value loss:52.24079132080078
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4194135665893555 seconds
19 rew tensor(0.7068, dtype=torch.float64) delta_t tensor(-1.8347, dtype=torch.float64)
19 gae_duplicate tensor(-1.8347, dtype=torch.float64) tensor(3.8169, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6538, dtype=torch.float64) delta_t tensor(0.2055, dtype=torch.float64)
18 gae_duplicate tensor(-1.2623, dtype=torch.float64) tensor(2.6237, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4946, dtype=torch.float64) delta_t tensor(-0.1655, dtype=torch.float64)
17 gae_duplicate tensor(-1.1753, dtype=torch.float64) tensor(2.4451, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0698, dtype=torch.float64) delta_t tensor(0.1256, dtype=torch.float64)
16 gae_duplicate tensor(-0.8147, dtype=torch.float64) tensor(1.6949, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.5675, dtype=torch.float64) delta_t tensor(-0.4780, dtype=torch.float64)
15 gae_duplicate tensor(-1.1298, dtype=torch.float64) tensor(2.3523, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(0.6768, dtype=torch.float64)
14 gae_duplicate tensor(-0.2270, dtype=torch.float64) tensor(0.4723, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7601, dtype=torch.float64) delta_t tensor(0.7506, dtype=torch.float64)
13 gae_duplicate tensor(0.5690, dtype=torch.float64) tensor(-1.1837, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.5902, dtype=torch.float64)
12 gae_duplicate tensor(1.0454, dtype=torch.float64) tensor(-2.1766, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7075, dtype=torch.float64) delta_t tensor(-0.5614, dtype=torch.float64)
11 gae_duplicate tensor(0.2749, dtype=torch.float64) tensor(-0.5724, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4953, dtype=torch.float64) delta_t tensor(0.0877, dtype=torch.float64)
10 gae_duplicate tensor(0.3076, dtype=torch.float64) tensor(-0.6394, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3893, dtype=torch.float64) delta_t tensor(0.0466, dtype=torch.float64)
9 gae_duplicate tensor(0.2927, dtype=torch.float64) tensor(-0.6084, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3894, dtype=torch.float64) delta_t tensor(-0.0025, dtype=torch.float64)
8 gae_duplicate tensor(0.2316, dtype=torch.float64) tensor(-0.4819, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7780, dtype=torch.float64) delta_t tensor(-1.1835, dtype=torch.float64)
7 gae_duplicate tensor(-0.9982, dtype=torch.float64) tensor(2.0766, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-2.0516, dtype=torch.float64) delta_t tensor(-0.9167, dtype=torch.float64)
6 gae_duplicate tensor(-1.7153, dtype=torch.float64) tensor(3.5714, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2294, dtype=torch.float64) delta_t tensor(-0.4241, dtype=torch.float64)
5 gae_duplicate tensor(-1.7963, dtype=torch.float64) tensor(3.7371, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.8579, dtype=torch.float64) delta_t tensor(-1.1332, dtype=torch.float64)
4 gae_duplicate tensor(-2.5703, dtype=torch.float64) tensor(5.3472, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1971, dtype=torch.float64) delta_t tensor(0.7614, dtype=torch.float64)
3 gae_duplicate tensor(-1.2949, dtype=torch.float64) tensor(2.6915, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1971, dtype=torch.float64) delta_t tensor(1.1996, dtype=torch.float64)
2 gae_duplicate tensor(0.1637, dtype=torch.float64) tensor(-0.3406, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-150.07827758789062
value loss:38.30150604248047
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.5136048793792725 seconds
19 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(-0.0723, dtype=torch.float64)
19 gae_duplicate tensor(-0.0723, dtype=torch.float64) tensor(0.1503, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.6360, dtype=torch.float64)
18 gae_duplicate tensor(0.5782, dtype=torch.float64) tensor(-1.2039, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(0.6363, dtype=torch.float64)
17 gae_duplicate tensor(1.0988, dtype=torch.float64) tensor(-2.2879, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(-0.2686, dtype=torch.float64)
16 gae_duplicate tensor(0.6105, dtype=torch.float64) tensor(-1.2699, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(-0.0042, dtype=torch.float64)
15 gae_duplicate tensor(0.4841, dtype=torch.float64) tensor(-1.0063, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(0.4531, dtype=torch.float64)
14 gae_duplicate tensor(0.8404, dtype=torch.float64) tensor(-1.7469, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.3336, dtype=torch.float64)
13 gae_duplicate tensor(1.0060, dtype=torch.float64) tensor(-2.0910, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.3274, dtype=torch.float64)
12 gae_duplicate tensor(1.1322, dtype=torch.float64) tensor(-2.3534, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.7704, dtype=torch.float64)
11 gae_duplicate tensor(1.6762, dtype=torch.float64) tensor(-3.4870, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3895, dtype=torch.float64) delta_t tensor(0.9902, dtype=torch.float64)
10 gae_duplicate tensor(2.3311, dtype=torch.float64) tensor(-4.8537, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1768, dtype=torch.float64) delta_t tensor(-0.1086, dtype=torch.float64)
9 gae_duplicate tensor(1.7562, dtype=torch.float64) tensor(-3.6504, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3017, dtype=torch.float64) delta_t tensor(-1.0815, dtype=torch.float64)
8 gae_duplicate tensor(0.3235, dtype=torch.float64) tensor(-0.6729, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3017, dtype=torch.float64) delta_t tensor(-0.5151, dtype=torch.float64)
7 gae_duplicate tensor(-0.2564, dtype=torch.float64) tensor(0.5338, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5243, dtype=torch.float64) delta_t tensor(-0.5595, dtype=torch.float64)
6 gae_duplicate tensor(-0.7646, dtype=torch.float64) tensor(1.5907, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4419, dtype=torch.float64) delta_t tensor(0.7924, dtype=torch.float64)
5 gae_duplicate tensor(0.1806, dtype=torch.float64) tensor(-0.3755, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9932, dtype=torch.float64) delta_t tensor(0.2606, dtype=torch.float64)
4 gae_duplicate tensor(0.4052, dtype=torch.float64) tensor(-0.8422, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.6543, dtype=torch.float64) delta_t tensor(0.1623, dtype=torch.float64)
3 gae_duplicate tensor(0.4864, dtype=torch.float64) tensor(-1.0128, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8869, dtype=torch.float64) delta_t tensor(-0.2938, dtype=torch.float64)
2 gae_duplicate tensor(0.0953, dtype=torch.float64) tensor(-0.1981, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:147.53916931152344
value loss:26.519554138183594
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.318852186203003 seconds
19 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(0.2913, dtype=torch.float64)
19 gae_duplicate tensor(0.2913, dtype=torch.float64) tensor(-0.6054, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(0.7087, dtype=torch.float64)
18 gae_duplicate tensor(0.9417, dtype=torch.float64) tensor(-1.9558, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(0.0476, dtype=torch.float64)
17 gae_duplicate tensor(0.8009, dtype=torch.float64) tensor(-1.6634, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
16 gae_duplicate tensor(0.6948, dtype=torch.float64) tensor(-1.4442, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(-0.4048, dtype=torch.float64)
15 gae_duplicate tensor(0.1510, dtype=torch.float64) tensor(-0.3140, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.5884, dtype=torch.float64)
14 gae_duplicate tensor(0.7092, dtype=torch.float64) tensor(-1.4729, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.4617, dtype=torch.float64)
13 gae_duplicate tensor(1.0291, dtype=torch.float64) tensor(-2.1408, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.4158, dtype=torch.float64)
12 gae_duplicate tensor(1.2390, dtype=torch.float64) tensor(-2.5776, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.3903, dtype=torch.float64)
11 gae_duplicate tensor(1.3815, dtype=torch.float64) tensor(-2.8691, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(1.7761, dtype=torch.float64)
10 gae_duplicate tensor(2.8813, dtype=torch.float64) tensor(-5.9941, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3356, dtype=torch.float64) delta_t tensor(0.1334, dtype=torch.float64)
9 gae_duplicate tensor(2.4384, dtype=torch.float64) tensor(-5.0640, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1226, dtype=torch.float64) delta_t tensor(-0.5249, dtype=torch.float64)
8 gae_duplicate tensor(1.4258, dtype=torch.float64) tensor(-2.9637, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4101, dtype=torch.float64) delta_t tensor(-0.7967, dtype=torch.float64)
7 gae_duplicate tensor(0.3440, dtype=torch.float64) tensor(-0.7156, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5699, dtype=torch.float64) delta_t tensor(0.1627, dtype=torch.float64)
6 gae_duplicate tensor(0.4379, dtype=torch.float64) tensor(-0.9101, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7298, dtype=torch.float64) delta_t tensor(0.7505, dtype=torch.float64)
5 gae_duplicate tensor(1.1008, dtype=torch.float64) tensor(-2.2861, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7832, dtype=torch.float64) delta_t tensor(-0.8603, dtype=torch.float64)
4 gae_duplicate tensor(0.0204, dtype=torch.float64) tensor(-0.0423, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8899, dtype=torch.float64) delta_t tensor(0.0108, dtype=torch.float64)
3 gae_duplicate tensor(0.0271, dtype=torch.float64) tensor(-0.0564, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2513, dtype=torch.float64) delta_t tensor(-1.8356, dtype=torch.float64)
2 gae_duplicate tensor(-1.8139, dtype=torch.float64) tensor(3.7733, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:174.69052124023438
value loss:42.32661056518555
entropies:37.429931640625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.7083)
ToM Target loss= tensor(301.8539)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.594538927078247 seconds
19 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(-0.3756, dtype=torch.float64)
19 gae_duplicate tensor(-0.3756, dtype=torch.float64) tensor(0.7807, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(0.5755, dtype=torch.float64)
18 gae_duplicate tensor(0.2751, dtype=torch.float64) tensor(-0.5722, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.3255, dtype=torch.float64)
17 gae_duplicate tensor(0.5455, dtype=torch.float64) tensor(-1.1349, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(-0.3940, dtype=torch.float64)
16 gae_duplicate tensor(0.0424, dtype=torch.float64) tensor(-0.0882, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.7188, dtype=torch.float64)
15 gae_duplicate tensor(0.7527, dtype=torch.float64) tensor(-1.5659, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.3941, dtype=torch.float64)
14 gae_duplicate tensor(0.9963, dtype=torch.float64) tensor(-2.0727, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.3501, dtype=torch.float64)
13 gae_duplicate tensor(1.1472, dtype=torch.float64) tensor(-2.3845, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.1944, dtype=torch.float64)
12 gae_duplicate tensor(1.1121, dtype=torch.float64) tensor(-2.3135, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.2809, dtype=torch.float64)
11 gae_duplicate tensor(1.1706, dtype=torch.float64) tensor(-2.4373, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.3112, dtype=torch.float64)
10 gae_duplicate tensor(1.2477, dtype=torch.float64) tensor(-2.5957, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3884, dtype=torch.float64) delta_t tensor(0.7979, dtype=torch.float64)
9 gae_duplicate tensor(1.7961, dtype=torch.float64) tensor(-3.7397, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6252, dtype=torch.float64) delta_t tensor(-0.2496, dtype=torch.float64)
8 gae_duplicate tensor(1.1873, dtype=torch.float64) tensor(-2.4658, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8387, dtype=torch.float64) delta_t tensor(-0.9703, dtype=torch.float64)
7 gae_duplicate tensor(-0.0205, dtype=torch.float64) tensor(0.0425, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8923, dtype=torch.float64) delta_t tensor(-1.0818, dtype=torch.float64)
6 gae_duplicate tensor(-1.0982, dtype=torch.float64) tensor(2.2826, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9459, dtype=torch.float64) delta_t tensor(0.1973, dtype=torch.float64)
5 gae_duplicate tensor(-0.6812, dtype=torch.float64) tensor(1.4172, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4662, dtype=torch.float64) delta_t tensor(0.0396, dtype=torch.float64)
4 gae_duplicate tensor(-0.5054, dtype=torch.float64) tensor(1.0495, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2129, dtype=torch.float64) delta_t tensor(-0.8296, dtype=torch.float64)
3 gae_duplicate tensor(-1.2339, dtype=torch.float64) tensor(2.5648, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2534, dtype=torch.float64) delta_t tensor(0.0861, dtype=torch.float64)
2 gae_duplicate tensor(-0.9010, dtype=torch.float64) tensor(1.8712, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:67.04789733886719
value loss:24.676849365234375
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.4923131465911865 seconds
19 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(-1.6939, dtype=torch.float64)
19 gae_duplicate tensor(-1.6939, dtype=torch.float64) tensor(3.5268, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7608, dtype=torch.float64) delta_t tensor(0.2517, dtype=torch.float64)
18 gae_duplicate tensor(-1.1034, dtype=torch.float64) tensor(2.2935, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7610, dtype=torch.float64) delta_t tensor(0.2071, dtype=torch.float64)
17 gae_duplicate tensor(-0.6756, dtype=torch.float64) tensor(1.4032, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6546, dtype=torch.float64) delta_t tensor(-0.0126, dtype=torch.float64)
16 gae_duplicate tensor(-0.5531, dtype=torch.float64) tensor(1.1487, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4949, dtype=torch.float64) delta_t tensor(0.3367, dtype=torch.float64)
15 gae_duplicate tensor(-0.1058, dtype=torch.float64) tensor(0.2199, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2819, dtype=torch.float64) delta_t tensor(-0.2620, dtype=torch.float64)
14 gae_duplicate tensor(-0.3466, dtype=torch.float64) tensor(0.7217, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4418, dtype=torch.float64) delta_t tensor(-0.1744, dtype=torch.float64)
13 gae_duplicate tensor(-0.4518, dtype=torch.float64) tensor(0.9398, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.3056, dtype=torch.float64)
12 gae_duplicate tensor(-0.0558, dtype=torch.float64) tensor(0.1160, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.3772, dtype=torch.float64)
11 gae_duplicate tensor(0.3326, dtype=torch.float64) tensor(-0.6913, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6021, dtype=torch.float64) delta_t tensor(0.0345, dtype=torch.float64)
10 gae_duplicate tensor(0.3006, dtype=torch.float64) tensor(-0.6248, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6340, dtype=torch.float64) delta_t tensor(-1.9882, dtype=torch.float64)
9 gae_duplicate tensor(-1.7477, dtype=torch.float64) tensor(3.6327, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.7415, dtype=torch.float64) delta_t tensor(-1.9206, dtype=torch.float64)
8 gae_duplicate tensor(-3.3188, dtype=torch.float64) tensor(6.8984, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8903, dtype=torch.float64) delta_t tensor(-1.2766, dtype=torch.float64)
7 gae_duplicate tensor(-3.9317, dtype=torch.float64) tensor(8.1724, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2102, dtype=torch.float64) delta_t tensor(-1.8330, dtype=torch.float64)
6 gae_duplicate tensor(-4.9783, dtype=torch.float64) tensor(10.3563, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.8624, dtype=torch.float64) delta_t tensor(-0.3096, dtype=torch.float64)
5 gae_duplicate tensor(-4.2922, dtype=torch.float64) tensor(8.9363, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0270, dtype=torch.float64) delta_t tensor(-1.7332, dtype=torch.float64)
4 gae_duplicate tensor(-5.1670, dtype=torch.float64) tensor(10.7307, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4146, dtype=torch.float64) delta_t tensor(-0.0279, dtype=torch.float64)
3 gae_duplicate tensor(-4.1615, dtype=torch.float64) tensor(8.6574, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3613, dtype=torch.float64) delta_t tensor(0.5720, dtype=torch.float64)
2 gae_duplicate tensor(-2.7572, dtype=torch.float64) tensor(5.7407, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-434.19329833984375
value loss:194.61141967773438
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.597543954849243 seconds
19 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(-1.6727, dtype=torch.float64)
19 gae_duplicate tensor(-1.6727, dtype=torch.float64) tensor(3.4739, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.2586, dtype=torch.float64)
18 gae_duplicate tensor(-1.0796, dtype=torch.float64) tensor(2.2439, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.0997, dtype=torch.float64)
17 gae_duplicate tensor(-0.7640, dtype=torch.float64) tensor(1.5866, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.9219, dtype=torch.float64)
16 gae_duplicate tensor(0.3107, dtype=torch.float64) tensor(-0.6459, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.2482, dtype=torch.float64)
15 gae_duplicate tensor(0.4968, dtype=torch.float64) tensor(-1.0326, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.3896, dtype=torch.float64)
14 gae_duplicate tensor(0.7870, dtype=torch.float64) tensor(-1.6359, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.4110, dtype=torch.float64)
13 gae_duplicate tensor(1.0406, dtype=torch.float64) tensor(-2.1666, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(3.3909, dtype=torch.float64)
12 gae_duplicate tensor(4.2234, dtype=torch.float64) tensor(-8.7857, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(0.4409, dtype=torch.float64)
11 gae_duplicate tensor(3.8197, dtype=torch.float64) tensor(-7.9333, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3896, dtype=torch.float64) delta_t tensor(-2.3446, dtype=torch.float64)
10 gae_duplicate tensor(0.7111, dtype=torch.float64) tensor(-1.4793, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1232, dtype=torch.float64) delta_t tensor(-0.0572, dtype=torch.float64)
9 gae_duplicate tensor(0.5117, dtype=torch.float64) tensor(-1.0645, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1232, dtype=torch.float64) delta_t tensor(-0.1209, dtype=torch.float64)
8 gae_duplicate tensor(0.2884, dtype=torch.float64) tensor(-0.6005, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5694, dtype=torch.float64) delta_t tensor(0.5459, dtype=torch.float64)
7 gae_duplicate tensor(0.7767, dtype=torch.float64) tensor(-1.6158, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1022, dtype=torch.float64) delta_t tensor(-2.2105, dtype=torch.float64)
6 gae_duplicate tensor(-1.5891, dtype=torch.float64) tensor(3.3060, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0615, dtype=torch.float64) delta_t tensor(0.2364, dtype=torch.float64)
5 gae_duplicate tensor(-1.0349, dtype=torch.float64) tensor(2.1510, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4418, dtype=torch.float64) delta_t tensor(0.8183, dtype=torch.float64)
4 gae_duplicate tensor(-0.0096, dtype=torch.float64) tensor(0.0200, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3701, dtype=torch.float64) delta_t tensor(-0.9210, dtype=torch.float64)
3 gae_duplicate tensor(-0.9287, dtype=torch.float64) tensor(1.9321, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3708, dtype=torch.float64) delta_t tensor(-0.3490, dtype=torch.float64)
2 gae_duplicate tensor(-1.0920, dtype=torch.float64) tensor(2.2697, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:58.73809051513672
value loss:69.18781280517578
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.571160078048706 seconds
19 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(-1.4447, dtype=torch.float64)
19 gae_duplicate tensor(-1.4447, dtype=torch.float64) tensor(3.0030, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.3623, dtype=torch.float64)
18 gae_duplicate tensor(-0.7935, dtype=torch.float64) tensor(1.6507, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.3625, dtype=torch.float64)
17 gae_duplicate tensor(-0.2723, dtype=torch.float64) tensor(0.5666, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.3627, dtype=torch.float64)
16 gae_duplicate tensor(0.1448, dtype=torch.float64) tensor(-0.3008, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.1924, dtype=torch.float64)
15 gae_duplicate tensor(0.3083, dtype=torch.float64) tensor(-0.6408, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.6375, dtype=torch.float64)
14 gae_duplicate tensor(0.8841, dtype=torch.float64) tensor(-1.8392, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.3052, dtype=torch.float64)
13 gae_duplicate tensor(1.0125, dtype=torch.float64) tensor(-2.1045, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.2036, dtype=torch.float64)
12 gae_duplicate tensor(1.0135, dtype=torch.float64) tensor(-2.1085, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(1.4637, dtype=torch.float64)
11 gae_duplicate tensor(2.2745, dtype=torch.float64) tensor(-4.7277, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4422, dtype=torch.float64) delta_t tensor(-0.3563, dtype=torch.float64)
10 gae_duplicate tensor(1.4633, dtype=torch.float64) tensor(-3.0416, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4956, dtype=torch.float64) delta_t tensor(0.3557, dtype=torch.float64)
9 gae_duplicate tensor(1.5264, dtype=torch.float64) tensor(-3.1754, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7315, dtype=torch.float64) delta_t tensor(-0.1138, dtype=torch.float64)
8 gae_duplicate tensor(1.1073, dtype=torch.float64) tensor(-2.2997, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4421, dtype=torch.float64) delta_t tensor(0.0777, dtype=torch.float64)
7 gae_duplicate tensor(0.9635, dtype=torch.float64) tensor(-2.0044, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9982, dtype=torch.float64) delta_t tensor(-0.0073, dtype=torch.float64)
6 gae_duplicate tensor(0.7635, dtype=torch.float64) tensor(-1.5870, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0519, dtype=torch.float64) delta_t tensor(0.0434, dtype=torch.float64)
5 gae_duplicate tensor(0.6542, dtype=torch.float64) tensor(-1.3598, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2656, dtype=torch.float64) delta_t tensor(-0.8011, dtype=torch.float64)
4 gae_duplicate tensor(-0.2777, dtype=torch.float64) tensor(0.5772, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1595, dtype=torch.float64) delta_t tensor(-1.8717, dtype=torch.float64)
3 gae_duplicate tensor(-2.0939, dtype=torch.float64) tensor(4.3522, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1740, dtype=torch.float64) delta_t tensor(-1.3792, dtype=torch.float64)
2 gae_duplicate tensor(-3.0543, dtype=torch.float64) tensor(6.3588, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:50.96342849731445
value loss:48.511474609375
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.751596927642822 seconds
19 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.3703, dtype=torch.float64)
19 gae_duplicate tensor(0.3703, dtype=torch.float64) tensor(-0.7690, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(-1.1098, dtype=torch.float64)
18 gae_duplicate tensor(-0.8135, dtype=torch.float64) tensor(1.6939, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.3666, dtype=torch.float64)
17 gae_duplicate tensor(-0.2842, dtype=torch.float64) tensor(0.5908, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.3686, dtype=torch.float64)
16 gae_duplicate tensor(0.1413, dtype=torch.float64) tensor(-0.2939, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.3355, dtype=torch.float64)
15 gae_duplicate tensor(0.4485, dtype=torch.float64) tensor(-0.9323, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.2929, dtype=torch.float64)
14 gae_duplicate tensor(0.6517, dtype=torch.float64) tensor(-1.3558, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.2667, dtype=torch.float64)
13 gae_duplicate tensor(0.7880, dtype=torch.float64) tensor(-1.6408, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(1.9378, dtype=torch.float64)
12 gae_duplicate tensor(2.5682, dtype=torch.float64) tensor(-5.3471, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4952, dtype=torch.float64) delta_t tensor(-0.3328, dtype=torch.float64)
11 gae_duplicate tensor(1.7218, dtype=torch.float64) tensor(-3.5817, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3350, dtype=torch.float64) delta_t tensor(1.1115, dtype=torch.float64)
10 gae_duplicate tensor(2.4889, dtype=torch.float64) tensor(-5.1732, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4954, dtype=torch.float64) delta_t tensor(-0.2357, dtype=torch.float64)
9 gae_duplicate tensor(1.7554, dtype=torch.float64) tensor(-3.6456, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1215, dtype=torch.float64) delta_t tensor(0.2482, dtype=torch.float64)
8 gae_duplicate tensor(1.6525, dtype=torch.float64) tensor(-3.4406, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1215, dtype=torch.float64) delta_t tensor(-0.7410, dtype=torch.float64)
7 gae_duplicate tensor(0.5810, dtype=torch.float64) tensor(-1.2086, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5194, dtype=torch.float64) delta_t tensor(-0.4865, dtype=torch.float64)
6 gae_duplicate tensor(-0.0217, dtype=torch.float64) tensor(0.0451, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6263, dtype=torch.float64) delta_t tensor(1.1897, dtype=torch.float64)
5 gae_duplicate tensor(1.1723, dtype=torch.float64) tensor(-2.4387, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5343, dtype=torch.float64) delta_t tensor(-1.3093, dtype=torch.float64)
4 gae_duplicate tensor(-0.3715, dtype=torch.float64) tensor(0.7721, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1613, dtype=torch.float64) delta_t tensor(-0.5699, dtype=torch.float64)
3 gae_duplicate tensor(-0.8671, dtype=torch.float64) tensor(1.8022, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6810, dtype=torch.float64) delta_t tensor(-0.5349, dtype=torch.float64)
2 gae_duplicate tensor(-1.2286, dtype=torch.float64) tensor(2.5537, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:133.09410095214844
value loss:41.73723220825195
entropies:37.429931640625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  100
ToM_loss = tensor(415.9639)
ToM Target loss= tensor(302.0260)
optimized based on ToM loss
---------------------
gamma: 0.8
training start after waiting for 4.3683860301971436 seconds
19 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(-1.2783, dtype=torch.float64)
19 gae_duplicate tensor(-1.2783, dtype=torch.float64) tensor(2.6592, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.3961, dtype=torch.float64)
18 gae_duplicate tensor(-0.6266, dtype=torch.float64) tensor(1.3023, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.3963, dtype=torch.float64)
17 gae_duplicate tensor(-0.1049, dtype=torch.float64) tensor(0.2179, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.5447, dtype=torch.float64)
16 gae_duplicate tensor(0.4607, dtype=torch.float64) tensor(-0.9592, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.1195, dtype=torch.float64)
15 gae_duplicate tensor(0.4881, dtype=torch.float64) tensor(-1.0146, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(1.6541, dtype=torch.float64)
14 gae_duplicate tensor(2.0446, dtype=torch.float64) tensor(-4.2535, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(-0.0379, dtype=torch.float64)
13 gae_duplicate tensor(1.5978, dtype=torch.float64) tensor(-3.3211, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(0.9854, dtype=torch.float64)
12 gae_duplicate tensor(2.2637, dtype=torch.float64) tensor(-4.7051, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5486, dtype=torch.float64) delta_t tensor(0.5286, dtype=torch.float64)
11 gae_duplicate tensor(2.3396, dtype=torch.float64) tensor(-4.8629, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4416, dtype=torch.float64) delta_t tensor(0.4843, dtype=torch.float64)
10 gae_duplicate tensor(2.3559, dtype=torch.float64) tensor(-4.9011, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2812, dtype=torch.float64) delta_t tensor(-0.2356, dtype=torch.float64)
9 gae_duplicate tensor(1.6491, dtype=torch.float64) tensor(-3.4308, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1207, dtype=torch.float64) delta_t tensor(-0.1232, dtype=torch.float64)
8 gae_duplicate tensor(1.1961, dtype=torch.float64) tensor(-2.4884, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5212, dtype=torch.float64) delta_t tensor(-1.2748, dtype=torch.float64)
7 gae_duplicate tensor(-0.3179, dtype=torch.float64) tensor(0.6613, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8423, dtype=torch.float64) delta_t tensor(-0.9580, dtype=torch.float64)
6 gae_duplicate tensor(-1.2123, dtype=torch.float64) tensor(2.5199, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4309, dtype=torch.float64) delta_t tensor(0.0572, dtype=torch.float64)
5 gae_duplicate tensor(-0.9127, dtype=torch.float64) tensor(1.8972, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1733, dtype=torch.float64) delta_t tensor(0.1784, dtype=torch.float64)
4 gae_duplicate tensor(-0.5518, dtype=torch.float64) tensor(1.1459, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1104, dtype=torch.float64) delta_t tensor(0.0376, dtype=torch.float64)
3 gae_duplicate tensor(-0.4039, dtype=torch.float64) tensor(0.8409, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9503, dtype=torch.float64) delta_t tensor(-0.9616, dtype=torch.float64)
2 gae_duplicate tensor(-1.2847, dtype=torch.float64) tensor(2.6679, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:95.02247619628906
value loss:51.06295394897461
entropies:37.429931640625
Policy training finished
---------------------
gamma: 0.8
training start after waiting for 4.495409965515137 seconds
19 rew tensor(0.7630, dtype=torch.float64) delta_t tensor(-1.6744, dtype=torch.float64)
19 gae_duplicate tensor(-1.6744, dtype=torch.float64) tensor(3.4804, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6560, dtype=torch.float64) delta_t tensor(0.1230, dtype=torch.float64)
18 gae_duplicate tensor(-1.2166, dtype=torch.float64) tensor(2.5329, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4952, dtype=torch.float64) delta_t tensor(-0.2608, dtype=torch.float64)
17 gae_duplicate tensor(-1.2341, dtype=torch.float64) tensor(2.5651, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1199, dtype=torch.float64) delta_t tensor(0.0317, dtype=torch.float64)
16 gae_duplicate tensor(-0.9556, dtype=torch.float64) tensor(1.9863, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.4162, dtype=torch.float64) delta_t tensor(-1.0361, dtype=torch.float64)
15 gae_duplicate tensor(-1.8006, dtype=torch.float64) tensor(3.7488, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7095, dtype=torch.float64) delta_t tensor(0.2562, dtype=torch.float64)
14 gae_duplicate tensor(-1.1843, dtype=torch.float64) tensor(2.4636, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4417, dtype=torch.float64) delta_t tensor(2.8559, dtype=torch.float64)
13 gae_duplicate tensor(1.9085, dtype=torch.float64) tensor(-3.9703, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1202, dtype=torch.float64) delta_t tensor(-1.6375, dtype=torch.float64)
12 gae_duplicate tensor(-0.1107, dtype=torch.float64) tensor(0.2304, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1478, dtype=torch.float64) delta_t tensor(2.0986, dtype=torch.float64)
11 gae_duplicate tensor(2.0100, dtype=torch.float64) tensor(-4.1814, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.3801, dtype=torch.float64) delta_t tensor(-4.5327, dtype=torch.float64)
10 gae_duplicate tensor(-2.9248, dtype=torch.float64) tensor(6.0794, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4698, dtype=torch.float64) delta_t tensor(-0.7353, dtype=torch.float64)
9 gae_duplicate tensor(-3.0752, dtype=torch.float64) tensor(6.3919, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2556, dtype=torch.float64) delta_t tensor(-0.8609, dtype=torch.float64)
8 gae_duplicate tensor(-3.3211, dtype=torch.float64) tensor(6.9089, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2020, dtype=torch.float64) delta_t tensor(0.5033, dtype=torch.float64)
7 gae_duplicate tensor(-2.1535, dtype=torch.float64) tensor(4.4799, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5478, dtype=torch.float64) delta_t tensor(0.6862, dtype=torch.float64)
6 gae_duplicate tensor(-1.0366, dtype=torch.float64) tensor(2.1547, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2195, dtype=torch.float64) delta_t tensor(-0.2017, dtype=torch.float64)
5 gae_duplicate tensor(-1.0310, dtype=torch.float64) tensor(2.1467, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2798, dtype=torch.float64) delta_t tensor(0.2945, dtype=torch.float64)
4 gae_duplicate tensor(-0.5303, dtype=torch.float64) tensor(1.1032, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1661, dtype=torch.float64) delta_t tensor(0.3065, dtype=torch.float64)
3 gae_duplicate tensor(-0.1177, dtype=torch.float64) tensor(0.2450, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4880, dtype=torch.float64) delta_t tensor(-1.0610, dtype=torch.float64)
2 gae_duplicate tensor(-1.1552, dtype=torch.float64) tensor(2.3991, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-245.71133422851562
value loss:84.75619506835938
entropies:37.429935455322266
Policy training finished
---------------------
gamma: 0.8
Process Process-4:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt