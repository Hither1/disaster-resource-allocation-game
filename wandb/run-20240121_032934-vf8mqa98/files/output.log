obs <crafter.objects.Shelter object at 0x147a9c7f0> [ 0 39  0  0 39  0  0 10  0]
obs <crafter.objects.Warehouse object at 0x130045cd0> [ 0 37  0  0 42  0  0  9  0]
obs <crafter.objects.Station object at 0x147aab220> [0 9 0 0 9 0 0 9 0]
obs <crafter.objects.Shelter object at 0x147a9c7f0> [ 0 39  0  0 39  0  0  8  0]
obs <crafter.objects.Warehouse object at 0x130045cd0> [ 0 39  0  0 40  0  0  9  0]
obs <crafter.objects.Station object at 0x147aab220> [ 0  9  0  0  9  0  0 11  0]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0024449825286865234 seconds
19 rew tensor(0.8859, dtype=torch.float64) delta_t tensor(0.7361, dtype=torch.float64)
19 gae_duplicate tensor(0.6341, dtype=torch.float64) tensor(-8.2040, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9284, dtype=torch.float64) delta_t tensor(0.7841, dtype=torch.float64)
18 gae_duplicate tensor(0.7150, dtype=torch.float64) tensor(-10.1585, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9777, dtype=torch.float64) delta_t tensor(0.8486, dtype=torch.float64)
17 gae_duplicate tensor(0.7443, dtype=torch.float64) tensor(-10.9508, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0361, dtype=torch.float64) delta_t tensor(0.8872, dtype=torch.float64)
16 gae_duplicate tensor(0.8023, dtype=torch.float64) tensor(-11.6218, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0961, dtype=torch.float64) delta_t tensor(0.9317, dtype=torch.float64)
15 gae_duplicate tensor(0.8067, dtype=torch.float64) tensor(-12.3324, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0496, dtype=torch.float64) delta_t tensor(0.9084, dtype=torch.float64)
14 gae_duplicate tensor(0.5762, dtype=torch.float64) tensor(-12.2756, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0782, dtype=torch.float64) delta_t tensor(0.9951, dtype=torch.float64)
13 gae_duplicate tensor(0.1987, dtype=torch.float64) tensor(-12.2001, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.2318, dtype=torch.float64) delta_t tensor(1.0719, dtype=torch.float64)
12 gae_duplicate tensor(0.6099, dtype=torch.float64) tensor(-14.9166, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.2665, dtype=torch.float64) delta_t tensor(1.1167, dtype=torch.float64)
11 gae_duplicate tensor(0.5751, dtype=torch.float64) tensor(-15.0339, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(1.3310, dtype=torch.float64) delta_t tensor(1.2110, dtype=torch.float64)
10 gae_duplicate tensor(0.6066, dtype=torch.float64) tensor(-15.7802, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(1.3559, dtype=torch.float64) delta_t tensor(1.0640, dtype=torch.float64)
9 gae_duplicate tensor(0.8442, dtype=torch.float64) tensor(-14.0352, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(1.2027, dtype=torch.float64) delta_t tensor(0.9231, dtype=torch.float64)
8 gae_duplicate tensor(0.2027, dtype=torch.float64) tensor(-11.3763, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3459, dtype=torch.float64) delta_t tensor(0.0464, dtype=torch.float64)
7 gae_duplicate tensor(-0.6668, dtype=torch.float64) tensor(-1.0672, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1774, dtype=torch.float64) delta_t tensor(-0.4603, dtype=torch.float64)
6 gae_duplicate tensor(-1.6666, dtype=torch.float64) tensor(5.6704, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0578, dtype=torch.float64) delta_t tensor(-0.2697, dtype=torch.float64)
5 gae_duplicate tensor(-1.4877, dtype=torch.float64) tensor(3.6773, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7435, dtype=torch.float64) delta_t tensor(-1.0752, dtype=torch.float64)
4 gae_duplicate tensor(-1.8876, dtype=torch.float64) tensor(12.8079, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5978, dtype=torch.float64) delta_t tensor(-0.8454, dtype=torch.float64)
3 gae_duplicate tensor(-1.9603, dtype=torch.float64) tensor(10.4959, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7676, dtype=torch.float64) delta_t tensor(-0.9543, dtype=torch.float64)
2 gae_duplicate tensor(-1.6887, dtype=torch.float64) tensor(13.4868, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3697.6591796875
value loss:199.6547088623047
entropies:220.31251525878906
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 4.6220409870147705 seconds
19 rew tensor(0.9108, dtype=torch.float64) delta_t tensor(0.7253, dtype=torch.float64)
19 gae_duplicate tensor(0.4145, dtype=torch.float64) tensor(-8.3583, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9208, dtype=torch.float64) delta_t tensor(0.7485, dtype=torch.float64)
18 gae_duplicate tensor(0.4208, dtype=torch.float64) tensor(-9.4344, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8971, dtype=torch.float64) delta_t tensor(0.7776, dtype=torch.float64)
17 gae_duplicate tensor(0.4745, dtype=torch.float64) tensor(-10.4944, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8174, dtype=torch.float64) delta_t tensor(0.7058, dtype=torch.float64)
16 gae_duplicate tensor(0.0043, dtype=torch.float64) tensor(-9.7957, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6714, dtype=torch.float64) delta_t tensor(0.4997, dtype=torch.float64)
15 gae_duplicate tensor(-1.0927, dtype=torch.float64) tensor(-8.0128, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9628, dtype=torch.float64) delta_t tensor(0.8011, dtype=torch.float64)
14 gae_duplicate tensor(0.6339, dtype=torch.float64) tensor(-10.3957, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9197, dtype=torch.float64) delta_t tensor(0.6943, dtype=torch.float64)
13 gae_duplicate tensor(0.5305, dtype=torch.float64) tensor(-10.4992, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8535, dtype=torch.float64) delta_t tensor(0.6453, dtype=torch.float64)
12 gae_duplicate tensor(0.3042, dtype=torch.float64) tensor(-7.8008, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4587, dtype=torch.float64) delta_t tensor(0.2330, dtype=torch.float64)
11 gae_duplicate tensor(-1.4460, dtype=torch.float64) tensor(-2.8946, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0979, dtype=torch.float64) delta_t tensor(-0.3091, dtype=torch.float64)
10 gae_duplicate tensor(-3.2972, dtype=torch.float64) tensor(4.6682, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3751, dtype=torch.float64) delta_t tensor(-0.5944, dtype=torch.float64)
9 gae_duplicate tensor(-2.3067, dtype=torch.float64) tensor(7.8635, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1597, dtype=torch.float64) delta_t tensor(-0.3621, dtype=torch.float64)
8 gae_duplicate tensor(-1.4570, dtype=torch.float64) tensor(4.5829, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2019, dtype=torch.float64) delta_t tensor(-0.3995, dtype=torch.float64)
7 gae_duplicate tensor(-1.0492, dtype=torch.float64) tensor(5.7330, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9868, dtype=torch.float64) delta_t tensor(-1.2834, dtype=torch.float64)
6 gae_duplicate tensor(-1.9484, dtype=torch.float64) tensor(16.1522, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7647, dtype=torch.float64) delta_t tensor(-1.0781, dtype=torch.float64)
5 gae_duplicate tensor(-2.2739, dtype=torch.float64) tensor(14.1698, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7545, dtype=torch.float64) delta_t tensor(-1.0471, dtype=torch.float64)
4 gae_duplicate tensor(-2.6753, dtype=torch.float64) tensor(16.9899, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3592, dtype=torch.float64) delta_t tensor(-1.7018, dtype=torch.float64)
3 gae_duplicate tensor(-2.1964, dtype=torch.float64) tensor(19.5699, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0233, dtype=torch.float64) delta_t tensor(-1.3351, dtype=torch.float64)
2 gae_duplicate tensor(-1.9416, dtype=torch.float64) tensor(18.7503, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1147.9151611328125
value loss:211.91587829589844
entropies:218.53233337402344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.947214126586914 seconds
19 rew tensor(0.8920, dtype=torch.float64) delta_t tensor(0.7375, dtype=torch.float64)
19 gae_duplicate tensor(0.3891, dtype=torch.float64) tensor(-8.8981, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(0.8310, dtype=torch.float64)
18 gae_duplicate tensor(0.4896, dtype=torch.float64) tensor(-10.3508, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9067, dtype=torch.float64) delta_t tensor(0.8319, dtype=torch.float64)
17 gae_duplicate tensor(0.6307, dtype=torch.float64) tensor(-10.5209, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9081, dtype=torch.float64) delta_t tensor(0.7607, dtype=torch.float64)
16 gae_duplicate tensor(0.5208, dtype=torch.float64) tensor(-11.3527, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9035, dtype=torch.float64) delta_t tensor(0.7306, dtype=torch.float64)
15 gae_duplicate tensor(0.3328, dtype=torch.float64) tensor(-9.7201, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8795, dtype=torch.float64) delta_t tensor(0.7071, dtype=torch.float64)
14 gae_duplicate tensor(0.1038, dtype=torch.float64) tensor(-8.4301, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9605, dtype=torch.float64) delta_t tensor(0.7789, dtype=torch.float64)
13 gae_duplicate tensor(0.5959, dtype=torch.float64) tensor(-11.5155, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8740, dtype=torch.float64) delta_t tensor(0.6705, dtype=torch.float64)
12 gae_duplicate tensor(0.2725, dtype=torch.float64) tensor(-8.0740, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7008, dtype=torch.float64) delta_t tensor(0.5080, dtype=torch.float64)
11 gae_duplicate tensor(0.0956, dtype=torch.float64) tensor(-7.5131, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4396, dtype=torch.float64) delta_t tensor(0.2368, dtype=torch.float64)
10 gae_duplicate tensor(-0.1726, dtype=torch.float64) tensor(-3.4547, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7940, dtype=torch.float64) delta_t tensor(-1.0087, dtype=torch.float64)
9 gae_duplicate tensor(-3.5689, dtype=torch.float64) tensor(10.4517, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7212, dtype=torch.float64) delta_t tensor(-0.9343, dtype=torch.float64)
8 gae_duplicate tensor(-1.4891, dtype=torch.float64) tensor(13.0147, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5730, dtype=torch.float64) delta_t tensor(-0.8428, dtype=torch.float64)
7 gae_duplicate tensor(-1.7431, dtype=torch.float64) tensor(10.0910, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9999, dtype=torch.float64) delta_t tensor(-1.2731, dtype=torch.float64)
6 gae_duplicate tensor(-2.2588, dtype=torch.float64) tensor(16.8692, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7169, dtype=torch.float64) delta_t tensor(-1.9732, dtype=torch.float64)
5 gae_duplicate tensor(-3.0269, dtype=torch.float64) tensor(22.6246, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0531, dtype=torch.float64) delta_t tensor(-1.4008, dtype=torch.float64)
4 gae_duplicate tensor(-6.0209, dtype=torch.float64) tensor(17.2512, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2916, dtype=torch.float64) delta_t tensor(-1.6418, dtype=torch.float64)
3 gae_duplicate tensor(-2.8433, dtype=torch.float64) tensor(22.3399, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7225, dtype=torch.float64) delta_t tensor(-0.9387, dtype=torch.float64)
2 gae_duplicate tensor(-2.6691, dtype=torch.float64) tensor(15.3734, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1413.894287109375
value loss:281.7193603515625
entropies:217.846435546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.449413061141968 seconds
19 rew tensor(0.7375, dtype=torch.float64) delta_t tensor(0.5857, dtype=torch.float64)
19 gae_duplicate tensor(0.2479, dtype=torch.float64) tensor(-7.9349, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6415, dtype=torch.float64) delta_t tensor(0.5497, dtype=torch.float64)
18 gae_duplicate tensor(-0.2727, dtype=torch.float64) tensor(-7.8663, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4839, dtype=torch.float64) delta_t tensor(0.3290, dtype=torch.float64)
17 gae_duplicate tensor(-1.5727, dtype=torch.float64) tensor(-5.2433, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8332, dtype=torch.float64) delta_t tensor(0.6393, dtype=torch.float64)
16 gae_duplicate tensor(0.4719, dtype=torch.float64) tensor(-8.2628, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7918, dtype=torch.float64) delta_t tensor(0.5310, dtype=torch.float64)
15 gae_duplicate tensor(0.2714, dtype=torch.float64) tensor(-7.4187, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7440, dtype=torch.float64) delta_t tensor(0.4661, dtype=torch.float64)
14 gae_duplicate tensor(0.1234, dtype=torch.float64) tensor(-6.7306, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(0.5178, dtype=torch.float64)
13 gae_duplicate tensor(0.2167, dtype=torch.float64) tensor(-7.3486, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8220, dtype=torch.float64) delta_t tensor(0.5974, dtype=torch.float64)
12 gae_duplicate tensor(0.1705, dtype=torch.float64) tensor(-7.5069, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6753, dtype=torch.float64) delta_t tensor(0.4368, dtype=torch.float64)
11 gae_duplicate tensor(-0.0035, dtype=torch.float64) tensor(-6.0195, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6199, dtype=torch.float64) delta_t tensor(0.4163, dtype=torch.float64)
10 gae_duplicate tensor(0.0672, dtype=torch.float64) tensor(-6.0229, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6793, dtype=torch.float64) delta_t tensor(-0.8051, dtype=torch.float64)
9 gae_duplicate tensor(-2.2076, dtype=torch.float64) tensor(9.4827, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6959, dtype=torch.float64) delta_t tensor(-0.8400, dtype=torch.float64)
8 gae_duplicate tensor(-1.7432, dtype=torch.float64) tensor(11.0536, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5337, dtype=torch.float64) delta_t tensor(-0.8006, dtype=torch.float64)
7 gae_duplicate tensor(-1.2873, dtype=torch.float64) tensor(11.2001, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5145, dtype=torch.float64) delta_t tensor(-1.7742, dtype=torch.float64)
6 gae_duplicate tensor(-2.5332, dtype=torch.float64) tensor(22.8389, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8135, dtype=torch.float64) delta_t tensor(-2.1037, dtype=torch.float64)
5 gae_duplicate tensor(-3.4034, dtype=torch.float64) tensor(28.3812, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5950, dtype=torch.float64) delta_t tensor(-2.9053, dtype=torch.float64)
4 gae_duplicate tensor(-6.1710, dtype=torch.float64) tensor(35.9760, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6038, dtype=torch.float64) delta_t tensor(-0.8505, dtype=torch.float64)
3 gae_duplicate tensor(-2.3196, dtype=torch.float64) tensor(13.1668, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1473, dtype=torch.float64) delta_t tensor(-0.2955, dtype=torch.float64)
2 gae_duplicate tensor(-0.8476, dtype=torch.float64) tensor(5.1686, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2448.141357421875
value loss:314.69122314453125
entropies:218.11756896972656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0202717781066895 seconds
19 rew tensor(0.5521, dtype=torch.float64) delta_t tensor(0.2974, dtype=torch.float64)
19 gae_duplicate tensor(-0.1224, dtype=torch.float64) tensor(-3.4045, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3553, dtype=torch.float64) delta_t tensor(0.1533, dtype=torch.float64)
18 gae_duplicate tensor(-1.0530, dtype=torch.float64) tensor(-1.6868, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3946, dtype=torch.float64) delta_t tensor(0.1949, dtype=torch.float64)
17 gae_duplicate tensor(-1.1686, dtype=torch.float64) tensor(-2.3200, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5877, dtype=torch.float64) delta_t tensor(0.4220, dtype=torch.float64)
16 gae_duplicate tensor(0.2223, dtype=torch.float64) tensor(-5.7901, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4154, dtype=torch.float64) delta_t tensor(0.2449, dtype=torch.float64)
15 gae_duplicate tensor(-0.3491, dtype=torch.float64) tensor(-3.5726, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3130, dtype=torch.float64) delta_t tensor(0.0659, dtype=torch.float64)
14 gae_duplicate tensor(-0.4058, dtype=torch.float64) tensor(-1.0741, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6375, dtype=torch.float64) delta_t tensor(0.4166, dtype=torch.float64)
13 gae_duplicate tensor(0.1505, dtype=torch.float64) tensor(-5.1524, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7702, dtype=torch.float64) delta_t tensor(0.5617, dtype=torch.float64)
12 gae_duplicate tensor(0.4408, dtype=torch.float64) tensor(-7.8743, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7760, dtype=torch.float64) delta_t tensor(0.5151, dtype=torch.float64)
11 gae_duplicate tensor(0.4227, dtype=torch.float64) tensor(-7.3133, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4658, dtype=torch.float64) delta_t tensor(0.2650, dtype=torch.float64)
10 gae_duplicate tensor(-0.5654, dtype=torch.float64) tensor(-4.4850, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0795, dtype=torch.float64) delta_t tensor(-1.1740, dtype=torch.float64)
9 gae_duplicate tensor(-2.1599, dtype=torch.float64) tensor(13.3105, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8279, dtype=torch.float64) delta_t tensor(-0.8773, dtype=torch.float64)
8 gae_duplicate tensor(-1.8881, dtype=torch.float64) tensor(10.4543, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0868, dtype=torch.float64) delta_t tensor(-0.1267, dtype=torch.float64)
7 gae_duplicate tensor(-1.1331, dtype=torch.float64) tensor(2.7586, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.8031, dtype=torch.float64) delta_t tensor(-2.0237, dtype=torch.float64)
6 gae_duplicate tensor(-2.6928, dtype=torch.float64) tensor(27.0130, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7185, dtype=torch.float64) delta_t tensor(-2.0700, dtype=torch.float64)
5 gae_duplicate tensor(-2.9638, dtype=torch.float64) tensor(26.1116, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.8713, dtype=torch.float64) delta_t tensor(-4.1831, dtype=torch.float64)
4 gae_duplicate tensor(-7.4365, dtype=torch.float64) tensor(51.7832, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2423, dtype=torch.float64) delta_t tensor(-0.4636, dtype=torch.float64)
3 gae_duplicate tensor(-1.1902, dtype=torch.float64) tensor(10.7764, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2726, dtype=torch.float64) delta_t tensor(-0.4725, dtype=torch.float64)
2 gae_duplicate tensor(-0.7691, dtype=torch.float64) tensor(7.6662, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3898.673828125
value loss:401.6052551269531
entropies:219.13389587402344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2501.7944)
ToM Target loss= tensor(1799.7600)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.159543037414551 seconds
19 rew tensor(0.4933, dtype=torch.float64) delta_t tensor(0.2706, dtype=torch.float64)
19 gae_duplicate tensor(-1.0392, dtype=torch.float64) tensor(-3.2821, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7685, dtype=torch.float64) delta_t tensor(0.5580, dtype=torch.float64)
18 gae_duplicate tensor(0.3069, dtype=torch.float64) tensor(-7.4677, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7738, dtype=torch.float64) delta_t tensor(0.6111, dtype=torch.float64)
17 gae_duplicate tensor(0.3720, dtype=torch.float64) tensor(-8.2625, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7791, dtype=torch.float64) delta_t tensor(0.6115, dtype=torch.float64)
16 gae_duplicate tensor(0.3765, dtype=torch.float64) tensor(-7.9392, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7490, dtype=torch.float64) delta_t tensor(0.6134, dtype=torch.float64)
15 gae_duplicate tensor(0.3379, dtype=torch.float64) tensor(-8.7271, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7240, dtype=torch.float64) delta_t tensor(0.5846, dtype=torch.float64)
14 gae_duplicate tensor(0.2804, dtype=torch.float64) tensor(-7.6385, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5635, dtype=torch.float64) delta_t tensor(0.3425, dtype=torch.float64)
13 gae_duplicate tensor(-0.0546, dtype=torch.float64) tensor(-5.2189, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4804, dtype=torch.float64) delta_t tensor(0.2454, dtype=torch.float64)
12 gae_duplicate tensor(-0.2119, dtype=torch.float64) tensor(-3.7354, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2324, dtype=torch.float64) delta_t tensor(0.0958, dtype=torch.float64)
11 gae_duplicate tensor(-1.5727, dtype=torch.float64) tensor(-1.5485, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0880, dtype=torch.float64) delta_t tensor(-0.0792, dtype=torch.float64)
10 gae_duplicate tensor(-2.5891, dtype=torch.float64) tensor(0.1845, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1120, dtype=torch.float64) delta_t tensor(-0.3265, dtype=torch.float64)
9 gae_duplicate tensor(-2.5229, dtype=torch.float64) tensor(3.6751, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0732, dtype=torch.float64) delta_t tensor(-0.1089, dtype=torch.float64)
8 gae_duplicate tensor(-0.9912, dtype=torch.float64) tensor(0.8370, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6313, dtype=torch.float64) delta_t tensor(-0.8049, dtype=torch.float64)
7 gae_duplicate tensor(-1.6416, dtype=torch.float64) tensor(10.5827, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7315, dtype=torch.float64) delta_t tensor(-1.0175, dtype=torch.float64)
6 gae_duplicate tensor(-1.7108, dtype=torch.float64) tensor(15.2828, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0874, dtype=torch.float64) delta_t tensor(-1.3297, dtype=torch.float64)
5 gae_duplicate tensor(-3.2287, dtype=torch.float64) tensor(17.4796, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8739, dtype=torch.float64) delta_t tensor(-2.1452, dtype=torch.float64)
4 gae_duplicate tensor(-7.3925, dtype=torch.float64) tensor(28.7468, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3782, dtype=torch.float64) delta_t tensor(-0.5289, dtype=torch.float64)
3 gae_duplicate tensor(-1.4749, dtype=torch.float64) tensor(8.8554, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2295, dtype=torch.float64) delta_t tensor(-0.4268, dtype=torch.float64)
2 gae_duplicate tensor(-0.9419, dtype=torch.float64) tensor(6.2123, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1408.8604736328125
value loss:253.28115844726562
entropies:219.7284698486328
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.2217419147491455 seconds
19 rew tensor(0.7789, dtype=torch.float64) delta_t tensor(0.6320, dtype=torch.float64)
19 gae_duplicate tensor(0.3997, dtype=torch.float64) tensor(-8.0030, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7834, dtype=torch.float64) delta_t tensor(0.6983, dtype=torch.float64)
18 gae_duplicate tensor(0.4630, dtype=torch.float64) tensor(-8.5817, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7881, dtype=torch.float64) delta_t tensor(0.6868, dtype=torch.float64)
17 gae_duplicate tensor(0.4771, dtype=torch.float64) tensor(-9.4323, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7928, dtype=torch.float64) delta_t tensor(0.7098, dtype=torch.float64)
16 gae_duplicate tensor(0.4811, dtype=torch.float64) tensor(-10.0717, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7976, dtype=torch.float64) delta_t tensor(0.6800, dtype=torch.float64)
15 gae_duplicate tensor(0.4948, dtype=torch.float64) tensor(-9.4188, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8025, dtype=torch.float64) delta_t tensor(0.6652, dtype=torch.float64)
14 gae_duplicate tensor(0.4866, dtype=torch.float64) tensor(-9.1059, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7894, dtype=torch.float64) delta_t tensor(0.5946, dtype=torch.float64)
13 gae_duplicate tensor(0.1949, dtype=torch.float64) tensor(-8.3899, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5740, dtype=torch.float64) delta_t tensor(0.4405, dtype=torch.float64)
12 gae_duplicate tensor(0.1094, dtype=torch.float64) tensor(-6.4233, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4904, dtype=torch.float64) delta_t tensor(0.3196, dtype=torch.float64)
11 gae_duplicate tensor(-0.1003, dtype=torch.float64) tensor(-4.6547, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4052, dtype=torch.float64) delta_t tensor(0.1787, dtype=torch.float64)
10 gae_duplicate tensor(-0.2553, dtype=torch.float64) tensor(-2.9355, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0960, dtype=torch.float64) delta_t tensor(-0.2935, dtype=torch.float64)
9 gae_duplicate tensor(-1.3276, dtype=torch.float64) tensor(3.7450, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3326, dtype=torch.float64) delta_t tensor(-0.5885, dtype=torch.float64)
8 gae_duplicate tensor(-2.4541, dtype=torch.float64) tensor(7.0975, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0141, dtype=torch.float64) delta_t tensor(-0.3100, dtype=torch.float64)
7 gae_duplicate tensor(-0.9133, dtype=torch.float64) tensor(4.2880, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6119, dtype=torch.float64) delta_t tensor(-0.8828, dtype=torch.float64)
6 gae_duplicate tensor(-1.3593, dtype=torch.float64) tensor(10.0622, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7869, dtype=torch.float64) delta_t tensor(-1.1222, dtype=torch.float64)
5 gae_duplicate tensor(-1.9700, dtype=torch.float64) tensor(15.9380, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0064, dtype=torch.float64) delta_t tensor(-0.2962, dtype=torch.float64)
4 gae_duplicate tensor(-1.8879, dtype=torch.float64) tensor(4.4568, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6983, dtype=torch.float64) delta_t tensor(-0.9568, dtype=torch.float64)
3 gae_duplicate tensor(-1.5289, dtype=torch.float64) tensor(12.9261, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5145, dtype=torch.float64) delta_t tensor(-0.7587, dtype=torch.float64)
2 gae_duplicate tensor(-1.1965, dtype=torch.float64) tensor(11.1686, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:224.34193420410156
value loss:109.09851837158203
entropies:220.56283569335938
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.974228858947754 seconds
19 rew tensor(0.6939, dtype=torch.float64) delta_t tensor(0.4773, dtype=torch.float64)
19 gae_duplicate tensor(0.2121, dtype=torch.float64) tensor(-5.9597, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6353, dtype=torch.float64) delta_t tensor(0.4669, dtype=torch.float64)
18 gae_duplicate tensor(-0.0460, dtype=torch.float64) tensor(-6.3143, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5061, dtype=torch.float64) delta_t tensor(0.2699, dtype=torch.float64)
17 gae_duplicate tensor(-1.0359, dtype=torch.float64) tensor(-3.7778, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7378, dtype=torch.float64) delta_t tensor(0.5969, dtype=torch.float64)
16 gae_duplicate tensor(0.4695, dtype=torch.float64) tensor(-8.4370, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6974, dtype=torch.float64) delta_t tensor(0.5673, dtype=torch.float64)
15 gae_duplicate tensor(0.3969, dtype=torch.float64) tensor(-7.6550, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6218, dtype=torch.float64) delta_t tensor(0.4467, dtype=torch.float64)
14 gae_duplicate tensor(-0.1194, dtype=torch.float64) tensor(-6.5234, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7039, dtype=torch.float64) delta_t tensor(0.5111, dtype=torch.float64)
13 gae_duplicate tensor(0.1225, dtype=torch.float64) tensor(-7.0614, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7147, dtype=torch.float64) delta_t tensor(0.5813, dtype=torch.float64)
12 gae_duplicate tensor(0.1539, dtype=torch.float64) tensor(-7.6449, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7025, dtype=torch.float64) delta_t tensor(0.5234, dtype=torch.float64)
11 gae_duplicate tensor(-0.0013, dtype=torch.float64) tensor(-7.6498, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6334, dtype=torch.float64) delta_t tensor(0.4687, dtype=torch.float64)
10 gae_duplicate tensor(0.0047, dtype=torch.float64) tensor(-5.8644, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4249, dtype=torch.float64) delta_t tensor(-0.5473, dtype=torch.float64)
9 gae_duplicate tensor(-2.7171, dtype=torch.float64) tensor(6.0281, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6751, dtype=torch.float64) delta_t tensor(-0.8270, dtype=torch.float64)
8 gae_duplicate tensor(-3.0844, dtype=torch.float64) tensor(10.6645, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1614, dtype=torch.float64) delta_t tensor(-0.3326, dtype=torch.float64)
7 gae_duplicate tensor(-1.2712, dtype=torch.float64) tensor(5.1154, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1155, dtype=torch.float64) delta_t tensor(-1.4082, dtype=torch.float64)
6 gae_duplicate tensor(-2.7524, dtype=torch.float64) tensor(18.2021, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4584, dtype=torch.float64) delta_t tensor(-1.7391, dtype=torch.float64)
5 gae_duplicate tensor(-3.7209, dtype=torch.float64) tensor(24.7949, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5136, dtype=torch.float64) delta_t tensor(-1.8128, dtype=torch.float64)
4 gae_duplicate tensor(-3.7582, dtype=torch.float64) tensor(25.4517, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6370, dtype=torch.float64) delta_t tensor(-0.8992, dtype=torch.float64)
3 gae_duplicate tensor(-1.7708, dtype=torch.float64) tensor(13.7842, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3733, dtype=torch.float64) delta_t tensor(-0.5461, dtype=torch.float64)
2 gae_duplicate tensor(-1.0968, dtype=torch.float64) tensor(8.6477, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1688.6259765625
value loss:206.62265014648438
entropies:221.1063232421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.089008331298828 seconds
19 rew tensor(0.7689, dtype=torch.float64) delta_t tensor(0.5093, dtype=torch.float64)
19 gae_duplicate tensor(0.2505, dtype=torch.float64) tensor(-6.2307, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7473, dtype=torch.float64) delta_t tensor(0.5113, dtype=torch.float64)
18 gae_duplicate tensor(0.2864, dtype=torch.float64) tensor(-7.1463, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7176, dtype=torch.float64) delta_t tensor(0.6189, dtype=torch.float64)
17 gae_duplicate tensor(0.5176, dtype=torch.float64) tensor(-8.6241, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6373, dtype=torch.float64) delta_t tensor(0.5415, dtype=torch.float64)
16 gae_duplicate tensor(0.2999, dtype=torch.float64) tensor(-8.0884, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5255, dtype=torch.float64) delta_t tensor(0.3490, dtype=torch.float64)
15 gae_duplicate tensor(-0.4170, dtype=torch.float64) tensor(-4.4795, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6303, dtype=torch.float64) delta_t tensor(0.5069, dtype=torch.float64)
14 gae_duplicate tensor(-0.0913, dtype=torch.float64) tensor(-6.7433, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7326, dtype=torch.float64) delta_t tensor(0.5739, dtype=torch.float64)
13 gae_duplicate tensor(0.5737, dtype=torch.float64) tensor(-8.1872, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6617, dtype=torch.float64) delta_t tensor(0.5172, dtype=torch.float64)
12 gae_duplicate tensor(0.2962, dtype=torch.float64) tensor(-7.8475, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6076, dtype=torch.float64) delta_t tensor(0.4906, dtype=torch.float64)
11 gae_duplicate tensor(0.1694, dtype=torch.float64) tensor(-6.7439, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5274, dtype=torch.float64) delta_t tensor(0.3847, dtype=torch.float64)
10 gae_duplicate tensor(-0.0213, dtype=torch.float64) tensor(-4.8351, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2550, dtype=torch.float64) delta_t tensor(-0.3795, dtype=torch.float64)
9 gae_duplicate tensor(-1.4346, dtype=torch.float64) tensor(3.6708, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5017, dtype=torch.float64) delta_t tensor(-0.5969, dtype=torch.float64)
8 gae_duplicate tensor(-2.5429, dtype=torch.float64) tensor(6.8876, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3711, dtype=torch.float64) delta_t tensor(-0.5223, dtype=torch.float64)
7 gae_duplicate tensor(-1.7098, dtype=torch.float64) tensor(7.7858, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6670, dtype=torch.float64) delta_t tensor(-0.9306, dtype=torch.float64)
6 gae_duplicate tensor(-2.1719, dtype=torch.float64) tensor(12.3954, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4162, dtype=torch.float64) delta_t tensor(-1.7302, dtype=torch.float64)
5 gae_duplicate tensor(-2.8450, dtype=torch.float64) tensor(21.3341, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6386, dtype=torch.float64) delta_t tensor(-3.0086, dtype=torch.float64)
4 gae_duplicate tensor(-5.8815, dtype=torch.float64) tensor(38.2114, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3959, dtype=torch.float64) delta_t tensor(-0.6954, dtype=torch.float64)
3 gae_duplicate tensor(-1.4225, dtype=torch.float64) tensor(12.7615, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3953, dtype=torch.float64) delta_t tensor(-0.4631, dtype=torch.float64)
2 gae_duplicate tensor(-1.6483, dtype=torch.float64) tensor(6.7023, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1509.307373046875
value loss:250.86517333984375
entropies:220.42794799804688
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.13398814201355 seconds
19 rew tensor(0.7777, dtype=torch.float64) delta_t tensor(0.6041, dtype=torch.float64)
19 gae_duplicate tensor(0.3541, dtype=torch.float64) tensor(-7.7711, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7809, dtype=torch.float64) delta_t tensor(0.6798, dtype=torch.float64)
18 gae_duplicate tensor(0.5435, dtype=torch.float64) tensor(-8.8395, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7841, dtype=torch.float64) delta_t tensor(0.7257, dtype=torch.float64)
17 gae_duplicate tensor(0.6104, dtype=torch.float64) tensor(-10.2503, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7873, dtype=torch.float64) delta_t tensor(0.7159, dtype=torch.float64)
16 gae_duplicate tensor(0.6474, dtype=torch.float64) tensor(-10.9034, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7906, dtype=torch.float64) delta_t tensor(0.7120, dtype=torch.float64)
15 gae_duplicate tensor(0.6278, dtype=torch.float64) tensor(-10.6156, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7939, dtype=torch.float64) delta_t tensor(0.7127, dtype=torch.float64)
14 gae_duplicate tensor(0.6543, dtype=torch.float64) tensor(-9.6245, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7973, dtype=torch.float64) delta_t tensor(0.7115, dtype=torch.float64)
13 gae_duplicate tensor(0.6579, dtype=torch.float64) tensor(-10.1018, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6735, dtype=torch.float64) delta_t tensor(0.5560, dtype=torch.float64)
12 gae_duplicate tensor(0.3077, dtype=torch.float64) tensor(-7.7765, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7095, dtype=torch.float64) delta_t tensor(0.5826, dtype=torch.float64)
11 gae_duplicate tensor(0.1409, dtype=torch.float64) tensor(-7.7882, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5228, dtype=torch.float64) delta_t tensor(0.3935, dtype=torch.float64)
10 gae_duplicate tensor(-0.0766, dtype=torch.float64) tensor(-5.6913, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1272, dtype=torch.float64) delta_t tensor(-0.0743, dtype=torch.float64)
9 gae_duplicate tensor(-1.4788, dtype=torch.float64) tensor(-0.1493, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0287, dtype=torch.float64) delta_t tensor(-0.1703, dtype=torch.float64)
8 gae_duplicate tensor(-0.8297, dtype=torch.float64) tensor(2.4131, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4101, dtype=torch.float64) delta_t tensor(-0.6400, dtype=torch.float64)
7 gae_duplicate tensor(-0.9620, dtype=torch.float64) tensor(7.4562, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4510, dtype=torch.float64) delta_t tensor(-0.7017, dtype=torch.float64)
6 gae_duplicate tensor(-1.1474, dtype=torch.float64) tensor(9.5231, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0460, dtype=torch.float64) delta_t tensor(-1.2470, dtype=torch.float64)
5 gae_duplicate tensor(-2.1199, dtype=torch.float64) tensor(15.4449, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4574, dtype=torch.float64) delta_t tensor(-0.7095, dtype=torch.float64)
4 gae_duplicate tensor(-1.8729, dtype=torch.float64) tensor(9.1947, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6410, dtype=torch.float64) delta_t tensor(-0.8039, dtype=torch.float64)
3 gae_duplicate tensor(-1.6536, dtype=torch.float64) tensor(9.6939, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4001, dtype=torch.float64) delta_t tensor(-0.5364, dtype=torch.float64)
2 gae_duplicate tensor(-1.1963, dtype=torch.float64) tensor(7.7156, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:970.86962890625
value loss:112.66345977783203
entropies:220.24990844726562
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2492.0520)
ToM Target loss= tensor(1799.2887)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.917119026184082 seconds
19 rew tensor(0.7486, dtype=torch.float64) delta_t tensor(0.5102, dtype=torch.float64)
19 gae_duplicate tensor(0.2984, dtype=torch.float64) tensor(-5.7167, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7213, dtype=torch.float64) delta_t tensor(0.5526, dtype=torch.float64)
18 gae_duplicate tensor(0.3318, dtype=torch.float64) tensor(-7.6069, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6715, dtype=torch.float64) delta_t tensor(0.6340, dtype=torch.float64)
17 gae_duplicate tensor(0.5000, dtype=torch.float64) tensor(-9.2667, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5695, dtype=torch.float64) delta_t tensor(0.5287, dtype=torch.float64)
16 gae_duplicate tensor(0.0286, dtype=torch.float64) tensor(-8.0330, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3780, dtype=torch.float64) delta_t tensor(0.2794, dtype=torch.float64)
15 gae_duplicate tensor(-0.8114, dtype=torch.float64) tensor(-4.0856, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7809, dtype=torch.float64) delta_t tensor(0.6485, dtype=torch.float64)
14 gae_duplicate tensor(0.4957, dtype=torch.float64) tensor(-8.4355, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6796, dtype=torch.float64) delta_t tensor(0.5600, dtype=torch.float64)
13 gae_duplicate tensor(0.3380, dtype=torch.float64) tensor(-7.2397, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6747, dtype=torch.float64) delta_t tensor(0.5595, dtype=torch.float64)
12 gae_duplicate tensor(0.2626, dtype=torch.float64) tensor(-7.6074, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6865, dtype=torch.float64) delta_t tensor(0.5524, dtype=torch.float64)
11 gae_duplicate tensor(0.1589, dtype=torch.float64) tensor(-7.7421, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5222, dtype=torch.float64) delta_t tensor(0.4055, dtype=torch.float64)
10 gae_duplicate tensor(0.1051, dtype=torch.float64) tensor(-5.4784, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5000, dtype=torch.float64) delta_t tensor(-0.6496, dtype=torch.float64)
9 gae_duplicate tensor(-3.0855, dtype=torch.float64) tensor(8.3637, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3123, dtype=torch.float64) delta_t tensor(-0.4651, dtype=torch.float64)
8 gae_duplicate tensor(-1.7645, dtype=torch.float64) tensor(5.7825, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0520, dtype=torch.float64) delta_t tensor(-0.0909, dtype=torch.float64)
7 gae_duplicate tensor(-0.4535, dtype=torch.float64) tensor(1.8062, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7403, dtype=torch.float64) delta_t tensor(-0.9348, dtype=torch.float64)
6 gae_duplicate tensor(-1.8921, dtype=torch.float64) tensor(11.6897, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3947, dtype=torch.float64) delta_t tensor(-1.6589, dtype=torch.float64)
5 gae_duplicate tensor(-3.6755, dtype=torch.float64) tensor(21.1476, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9794, dtype=torch.float64) delta_t tensor(-2.2137, dtype=torch.float64)
4 gae_duplicate tensor(-7.6580, dtype=torch.float64) tensor(29.7337, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5527, dtype=torch.float64) delta_t tensor(-0.7205, dtype=torch.float64)
3 gae_duplicate tensor(-1.5788, dtype=torch.float64) tensor(10.8561, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5216, dtype=torch.float64) delta_t tensor(-0.6220, dtype=torch.float64)
2 gae_duplicate tensor(-1.1860, dtype=torch.float64) tensor(9.1311, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1022.4282836914062
value loss:242.7325439453125
entropies:220.48716735839844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.824120044708252 seconds
19 rew tensor(0.7672, dtype=torch.float64) delta_t tensor(0.7349, dtype=torch.float64)
19 gae_duplicate tensor(0.5691, dtype=torch.float64) tensor(-9.7247, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7621, dtype=torch.float64) delta_t tensor(0.7615, dtype=torch.float64)
18 gae_duplicate tensor(0.7086, dtype=torch.float64) tensor(-9.7838, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7493, dtype=torch.float64) delta_t tensor(0.6835, dtype=torch.float64)
17 gae_duplicate tensor(0.5529, dtype=torch.float64) tensor(-9.5157, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7210, dtype=torch.float64) delta_t tensor(0.6380, dtype=torch.float64)
16 gae_duplicate tensor(0.4623, dtype=torch.float64) tensor(-8.8102, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6773, dtype=torch.float64) delta_t tensor(0.5673, dtype=torch.float64)
15 gae_duplicate tensor(0.2254, dtype=torch.float64) tensor(-7.5761, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6797, dtype=torch.float64) delta_t tensor(0.5201, dtype=torch.float64)
14 gae_duplicate tensor(0.0424, dtype=torch.float64) tensor(-6.7408, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4620, dtype=torch.float64) delta_t tensor(0.2835, dtype=torch.float64)
13 gae_duplicate tensor(-0.3443, dtype=torch.float64) tensor(-4.4682, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3258, dtype=torch.float64) delta_t tensor(0.2077, dtype=torch.float64)
12 gae_duplicate tensor(-0.4449, dtype=torch.float64) tensor(-2.8195, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1785, dtype=torch.float64) delta_t tensor(-0.0380, dtype=torch.float64)
11 gae_duplicate tensor(-0.6964, dtype=torch.float64) tensor(-0.1539, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0849, dtype=torch.float64) delta_t tensor(-0.0759, dtype=torch.float64)
10 gae_duplicate tensor(-0.7786, dtype=torch.float64) tensor(0.8678, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7110, dtype=torch.float64) delta_t tensor(-0.7801, dtype=torch.float64)
9 gae_duplicate tensor(-5.0536, dtype=torch.float64) tensor(8.6176, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1223, dtype=torch.float64) delta_t tensor(-0.2298, dtype=torch.float64)
8 gae_duplicate tensor(-0.5740, dtype=torch.float64) tensor(3.7414, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0969, dtype=torch.float64) delta_t tensor(-0.0949, dtype=torch.float64)
7 gae_duplicate tensor(-0.5766, dtype=torch.float64) tensor(1.7259, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5353, dtype=torch.float64) delta_t tensor(-0.7262, dtype=torch.float64)
6 gae_duplicate tensor(-1.1239, dtype=torch.float64) tensor(10.1976, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3728, dtype=torch.float64) delta_t tensor(-0.5768, dtype=torch.float64)
5 gae_duplicate tensor(-1.6718, dtype=torch.float64) tensor(8.0687, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3063, dtype=torch.float64) delta_t tensor(-0.4750, dtype=torch.float64)
4 gae_duplicate tensor(-1.7420, dtype=torch.float64) tensor(6.8055, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3102, dtype=torch.float64) delta_t tensor(-0.5014, dtype=torch.float64)
3 gae_duplicate tensor(-1.2706, dtype=torch.float64) tensor(6.3049, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5234, dtype=torch.float64) delta_t tensor(-0.6427, dtype=torch.float64)
2 gae_duplicate tensor(-1.0016, dtype=torch.float64) tensor(8.3816, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:136.0380859375
value loss:110.15621948242188
entropies:220.61061096191406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.786746025085449 seconds
19 rew tensor(0.7578, dtype=torch.float64) delta_t tensor(0.6400, dtype=torch.float64)
19 gae_duplicate tensor(0.4283, dtype=torch.float64) tensor(-7.8073, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7358, dtype=torch.float64) delta_t tensor(0.6217, dtype=torch.float64)
18 gae_duplicate tensor(0.4129, dtype=torch.float64) tensor(-8.0250, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7382, dtype=torch.float64) delta_t tensor(0.6411, dtype=torch.float64)
17 gae_duplicate tensor(0.3489, dtype=torch.float64) tensor(-8.6594, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7002, dtype=torch.float64) delta_t tensor(0.6470, dtype=torch.float64)
16 gae_duplicate tensor(0.5294, dtype=torch.float64) tensor(-8.9245, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6302, dtype=torch.float64) delta_t tensor(0.5141, dtype=torch.float64)
15 gae_duplicate tensor(0.2421, dtype=torch.float64) tensor(-6.8309, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4879, dtype=torch.float64) delta_t tensor(0.3466, dtype=torch.float64)
14 gae_duplicate tensor(-0.5721, dtype=torch.float64) tensor(-4.7058, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6845, dtype=torch.float64) delta_t tensor(0.5295, dtype=torch.float64)
13 gae_duplicate tensor(0.4960, dtype=torch.float64) tensor(-6.7108, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6047, dtype=torch.float64) delta_t tensor(0.4392, dtype=torch.float64)
12 gae_duplicate tensor(0.1858, dtype=torch.float64) tensor(-6.0338, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5560, dtype=torch.float64) delta_t tensor(0.3809, dtype=torch.float64)
11 gae_duplicate tensor(0.1038, dtype=torch.float64) tensor(-4.9397, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4127, dtype=torch.float64) delta_t tensor(0.2400, dtype=torch.float64)
10 gae_duplicate tensor(-0.4946, dtype=torch.float64) tensor(-3.6472, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3487, dtype=torch.float64) delta_t tensor(-0.4239, dtype=torch.float64)
9 gae_duplicate tensor(-1.3542, dtype=torch.float64) tensor(5.2146, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6437, dtype=torch.float64) delta_t tensor(-0.7002, dtype=torch.float64)
8 gae_duplicate tensor(-2.5604, dtype=torch.float64) tensor(8.3462, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2922, dtype=torch.float64) delta_t tensor(-0.4510, dtype=torch.float64)
7 gae_duplicate tensor(-2.4157, dtype=torch.float64) tensor(6.2606, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6688, dtype=torch.float64) delta_t tensor(-0.8094, dtype=torch.float64)
6 gae_duplicate tensor(-1.9451, dtype=torch.float64) tensor(9.3669, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1824, dtype=torch.float64) delta_t tensor(-1.3518, dtype=torch.float64)
5 gae_duplicate tensor(-2.7912, dtype=torch.float64) tensor(17.8675, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6055, dtype=torch.float64) delta_t tensor(-2.8040, dtype=torch.float64)
4 gae_duplicate tensor(-8.0758, dtype=torch.float64) tensor(32.4670, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5754, dtype=torch.float64) delta_t tensor(-0.7718, dtype=torch.float64)
3 gae_duplicate tensor(-1.4314, dtype=torch.float64) tensor(13.7425, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3844, dtype=torch.float64) delta_t tensor(-0.4836, dtype=torch.float64)
2 gae_duplicate tensor(-1.2017, dtype=torch.float64) tensor(7.0600, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1265.2164306640625
value loss:271.545166015625
entropies:220.79876708984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.20165491104126 seconds
19 rew tensor(0.6918, dtype=torch.float64) delta_t tensor(0.6130, dtype=torch.float64)
19 gae_duplicate tensor(0.2060, dtype=torch.float64) tensor(-7.7510, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6286, dtype=torch.float64) delta_t tensor(0.5851, dtype=torch.float64)
18 gae_duplicate tensor(-0.0324, dtype=torch.float64) tensor(-7.3498, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5006, dtype=torch.float64) delta_t tensor(0.4287, dtype=torch.float64)
17 gae_duplicate tensor(-1.0898, dtype=torch.float64) tensor(-5.8108, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7779, dtype=torch.float64) delta_t tensor(0.7307, dtype=torch.float64)
16 gae_duplicate tensor(0.4812, dtype=torch.float64) tensor(-10.6131, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7802, dtype=torch.float64) delta_t tensor(0.6763, dtype=torch.float64)
15 gae_duplicate tensor(0.6405, dtype=torch.float64) tensor(-9.5975, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7825, dtype=torch.float64) delta_t tensor(0.6636, dtype=torch.float64)
14 gae_duplicate tensor(0.6587, dtype=torch.float64) tensor(-8.5577, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7848, dtype=torch.float64) delta_t tensor(0.7318, dtype=torch.float64)
13 gae_duplicate tensor(0.6628, dtype=torch.float64) tensor(-10.7282, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5637, dtype=torch.float64) delta_t tensor(0.5061, dtype=torch.float64)
12 gae_duplicate tensor(0.0650, dtype=torch.float64) tensor(-7.0095, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1255, dtype=torch.float64) delta_t tensor(0.0476, dtype=torch.float64)
11 gae_duplicate tensor(-1.0955, dtype=torch.float64) tensor(-0.7260, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2229, dtype=torch.float64) delta_t tensor(0.1535, dtype=torch.float64)
10 gae_duplicate tensor(-0.5804, dtype=torch.float64) tensor(-1.9803, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3251, dtype=torch.float64) delta_t tensor(0.2247, dtype=torch.float64)
9 gae_duplicate tensor(-0.1446, dtype=torch.float64) tensor(-2.7712, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0179, dtype=torch.float64) delta_t tensor(-0.0907, dtype=torch.float64)
8 gae_duplicate tensor(-0.3122, dtype=torch.float64) tensor(0.7103, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7367, dtype=torch.float64) delta_t tensor(-0.8508, dtype=torch.float64)
7 gae_duplicate tensor(-2.3771, dtype=torch.float64) tensor(9.7214, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9447, dtype=torch.float64) delta_t tensor(-1.1050, dtype=torch.float64)
6 gae_duplicate tensor(-2.4916, dtype=torch.float64) tensor(13.6810, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2984, dtype=torch.float64) delta_t tensor(-1.4544, dtype=torch.float64)
5 gae_duplicate tensor(-2.2137, dtype=torch.float64) tensor(19.8749, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4404, dtype=torch.float64) delta_t tensor(-1.6560, dtype=torch.float64)
4 gae_duplicate tensor(-3.2661, dtype=torch.float64) tensor(22.9300, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3729, dtype=torch.float64) delta_t tensor(-0.5373, dtype=torch.float64)
3 gae_duplicate tensor(-1.0559, dtype=torch.float64) tensor(9.7855, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5116, dtype=torch.float64) delta_t tensor(-0.7181, dtype=torch.float64)
2 gae_duplicate tensor(-1.8321, dtype=torch.float64) tensor(10.3472, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-549.4133911132812
value loss:160.96017456054688
entropies:221.2449188232422
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.954432010650635 seconds
19 rew tensor(0.6388, dtype=torch.float64) delta_t tensor(0.5361, dtype=torch.float64)
19 gae_duplicate tensor(-0.0169, dtype=torch.float64) tensor(-6.2784, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5180, dtype=torch.float64) delta_t tensor(0.4327, dtype=torch.float64)
18 gae_duplicate tensor(-0.8665, dtype=torch.float64) tensor(-5.8629, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7724, dtype=torch.float64) delta_t tensor(0.6985, dtype=torch.float64)
17 gae_duplicate tensor(0.5792, dtype=torch.float64) tensor(-9.1982, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7500, dtype=torch.float64) delta_t tensor(0.6794, dtype=torch.float64)
16 gae_duplicate tensor(0.6799, dtype=torch.float64) tensor(-9.5370, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7113, dtype=torch.float64) delta_t tensor(0.6208, dtype=torch.float64)
15 gae_duplicate tensor(0.4243, dtype=torch.float64) tensor(-8.1104, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6563, dtype=torch.float64) delta_t tensor(0.5485, dtype=torch.float64)
14 gae_duplicate tensor(0.0074, dtype=torch.float64) tensor(-7.6738, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6024, dtype=torch.float64) delta_t tensor(0.4995, dtype=torch.float64)
13 gae_duplicate tensor(0.1941, dtype=torch.float64) tensor(-7.4202, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6846, dtype=torch.float64) delta_t tensor(0.5679, dtype=torch.float64)
12 gae_duplicate tensor(0.4002, dtype=torch.float64) tensor(-8.0144, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6873, dtype=torch.float64) delta_t tensor(0.5687, dtype=torch.float64)
11 gae_duplicate tensor(0.2448, dtype=torch.float64) tensor(-7.8539, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6086, dtype=torch.float64) delta_t tensor(0.5109, dtype=torch.float64)
10 gae_duplicate tensor(0.1680, dtype=torch.float64) tensor(-7.1106, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4070, dtype=torch.float64) delta_t tensor(-0.4205, dtype=torch.float64)
9 gae_duplicate tensor(-1.3918, dtype=torch.float64) tensor(5.1157, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3407, dtype=torch.float64) delta_t tensor(-0.4394, dtype=torch.float64)
8 gae_duplicate tensor(-1.6978, dtype=torch.float64) tensor(6.0909, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1510, dtype=torch.float64) delta_t tensor(-0.1890, dtype=torch.float64)
7 gae_duplicate tensor(-1.3849, dtype=torch.float64) tensor(2.4468, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0750, dtype=torch.float64) delta_t tensor(-1.2165, dtype=torch.float64)
6 gae_duplicate tensor(-3.0545, dtype=torch.float64) tensor(15.3460, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4927, dtype=torch.float64) delta_t tensor(-1.7249, dtype=torch.float64)
5 gae_duplicate tensor(-3.5366, dtype=torch.float64) tensor(22.6608, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0370, dtype=torch.float64) delta_t tensor(-1.2556, dtype=torch.float64)
4 gae_duplicate tensor(-3.1319, dtype=torch.float64) tensor(16.1103, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5009, dtype=torch.float64) delta_t tensor(-0.6157, dtype=torch.float64)
3 gae_duplicate tensor(-1.1776, dtype=torch.float64) tensor(9.4503, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5333, dtype=torch.float64) delta_t tensor(-0.6176, dtype=torch.float64)
2 gae_duplicate tensor(-1.3029, dtype=torch.float64) tensor(8.9479, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-367.7711486816406
value loss:162.67788696289062
entropies:221.42601013183594
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2484.7908)
ToM Target loss= tensor(1798.6267)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.016339302062988 seconds
19 rew tensor(0.7740, dtype=torch.float64) delta_t tensor(0.6870, dtype=torch.float64)
19 gae_duplicate tensor(0.5892, dtype=torch.float64) tensor(-8.3824, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7602, dtype=torch.float64) delta_t tensor(0.7052, dtype=torch.float64)
18 gae_duplicate tensor(0.6557, dtype=torch.float64) tensor(-9.6831, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7463, dtype=torch.float64) delta_t tensor(0.7248, dtype=torch.float64)
17 gae_duplicate tensor(0.6451, dtype=torch.float64) tensor(-9.3995, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6751, dtype=torch.float64) delta_t tensor(0.6241, dtype=torch.float64)
16 gae_duplicate tensor(0.2430, dtype=torch.float64) tensor(-8.4799, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5979, dtype=torch.float64) delta_t tensor(0.5840, dtype=torch.float64)
15 gae_duplicate tensor(-0.1686, dtype=torch.float64) tensor(-7.7673, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6290, dtype=torch.float64) delta_t tensor(0.5816, dtype=torch.float64)
14 gae_duplicate tensor(0.0471, dtype=torch.float64) tensor(-8.0335, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7049, dtype=torch.float64) delta_t tensor(0.6488, dtype=torch.float64)
13 gae_duplicate tensor(0.4250, dtype=torch.float64) tensor(-8.8642, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7597, dtype=torch.float64) delta_t tensor(0.7146, dtype=torch.float64)
12 gae_duplicate tensor(0.6305, dtype=torch.float64) tensor(-8.8882, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7439, dtype=torch.float64) delta_t tensor(0.6541, dtype=torch.float64)
11 gae_duplicate tensor(0.5664, dtype=torch.float64) tensor(-8.8954, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5805, dtype=torch.float64) delta_t tensor(0.4061, dtype=torch.float64)
10 gae_duplicate tensor(0.1020, dtype=torch.float64) tensor(-5.7399, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3398, dtype=torch.float64) delta_t tensor(-0.4644, dtype=torch.float64)
9 gae_duplicate tensor(-1.7273, dtype=torch.float64) tensor(4.6500, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4873, dtype=torch.float64) delta_t tensor(-0.5210, dtype=torch.float64)
8 gae_duplicate tensor(-2.3372, dtype=torch.float64) tensor(6.6090, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9431, dtype=torch.float64) delta_t tensor(-1.0071, dtype=torch.float64)
7 gae_duplicate tensor(-1.9115, dtype=torch.float64) tensor(13.5749, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9985, dtype=torch.float64) delta_t tensor(-1.1335, dtype=torch.float64)
6 gae_duplicate tensor(-2.3099, dtype=torch.float64) tensor(15.8441, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3897, dtype=torch.float64) delta_t tensor(-1.5533, dtype=torch.float64)
5 gae_duplicate tensor(-2.5941, dtype=torch.float64) tensor(20.6194, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0611, dtype=torch.float64) delta_t tensor(-1.2659, dtype=torch.float64)
4 gae_duplicate tensor(-4.8326, dtype=torch.float64) tensor(16.2720, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6331, dtype=torch.float64) delta_t tensor(-0.6638, dtype=torch.float64)
3 gae_duplicate tensor(-1.4594, dtype=torch.float64) tensor(9.7930, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5623, dtype=torch.float64) delta_t tensor(-0.6141, dtype=torch.float64)
2 gae_duplicate tensor(-1.2281, dtype=torch.float64) tensor(9.2535, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-489.2563781738281
value loss:184.34901428222656
entropies:221.59127807617188
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.101077079772949 seconds
19 rew tensor(0.4453, dtype=torch.float64) delta_t tensor(0.3648, dtype=torch.float64)
19 gae_duplicate tensor(-1.4468, dtype=torch.float64) tensor(-4.4291, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7858, dtype=torch.float64) delta_t tensor(0.7159, dtype=torch.float64)
18 gae_duplicate tensor(0.4606, dtype=torch.float64) tensor(-9.1553, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7877, dtype=torch.float64) delta_t tensor(0.7101, dtype=torch.float64)
17 gae_duplicate tensor(0.6126, dtype=torch.float64) tensor(-10.0387, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7896, dtype=torch.float64) delta_t tensor(0.6773, dtype=torch.float64)
16 gae_duplicate tensor(0.6149, dtype=torch.float64) tensor(-9.8453, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7915, dtype=torch.float64) delta_t tensor(0.6889, dtype=torch.float64)
15 gae_duplicate tensor(0.6226, dtype=torch.float64) tensor(-9.3682, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7206, dtype=torch.float64) delta_t tensor(0.6689, dtype=torch.float64)
14 gae_duplicate tensor(0.4544, dtype=torch.float64) tensor(-9.5553, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6372, dtype=torch.float64) delta_t tensor(0.6123, dtype=torch.float64)
13 gae_duplicate tensor(0.2199, dtype=torch.float64) tensor(-8.9841, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5175, dtype=torch.float64) delta_t tensor(0.4681, dtype=torch.float64)
12 gae_duplicate tensor(-0.2638, dtype=torch.float64) tensor(-5.9754, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4769, dtype=torch.float64) delta_t tensor(0.4264, dtype=torch.float64)
11 gae_duplicate tensor(-0.2309, dtype=torch.float64) tensor(-5.5862, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2660, dtype=torch.float64) delta_t tensor(0.1801, dtype=torch.float64)
10 gae_duplicate tensor(-0.4748, dtype=torch.float64) tensor(-2.2941, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1594, dtype=torch.float64) delta_t tensor(-0.2507, dtype=torch.float64)
9 gae_duplicate tensor(-1.3756, dtype=torch.float64) tensor(2.2602, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6671, dtype=torch.float64) delta_t tensor(-0.7175, dtype=torch.float64)
8 gae_duplicate tensor(-3.5248, dtype=torch.float64) tensor(8.2615, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2108, dtype=torch.float64) delta_t tensor(-0.2845, dtype=torch.float64)
7 gae_duplicate tensor(-0.7926, dtype=torch.float64) tensor(4.2145, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1266, dtype=torch.float64) delta_t tensor(-0.2512, dtype=torch.float64)
6 gae_duplicate tensor(-1.2414, dtype=torch.float64) tensor(3.5199, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5738, dtype=torch.float64) delta_t tensor(-1.6856, dtype=torch.float64)
5 gae_duplicate tensor(-2.6543, dtype=torch.float64) tensor(20.4507, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8592, dtype=torch.float64) delta_t tensor(-0.9992, dtype=torch.float64)
4 gae_duplicate tensor(-3.8775, dtype=torch.float64) tensor(13.0364, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6571, dtype=torch.float64) delta_t tensor(-0.6865, dtype=torch.float64)
3 gae_duplicate tensor(-1.4067, dtype=torch.float64) tensor(10.7945, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7391, dtype=torch.float64) delta_t tensor(-0.7527, dtype=torch.float64)
2 gae_duplicate tensor(-1.7096, dtype=torch.float64) tensor(9.8972, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:60.78306198120117
value loss:159.97312927246094
entropies:221.6563720703125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.724732160568237 seconds
19 rew tensor(0.7749, dtype=torch.float64) delta_t tensor(0.6948, dtype=torch.float64)
19 gae_duplicate tensor(0.5468, dtype=torch.float64) tensor(-8.8421, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7617, dtype=torch.float64) delta_t tensor(0.7084, dtype=torch.float64)
18 gae_duplicate tensor(0.6015, dtype=torch.float64) tensor(-9.3499, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7528, dtype=torch.float64) delta_t tensor(0.6718, dtype=torch.float64)
17 gae_duplicate tensor(0.6525, dtype=torch.float64) tensor(-9.3973, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7125, dtype=torch.float64) delta_t tensor(0.6392, dtype=torch.float64)
16 gae_duplicate tensor(0.4839, dtype=torch.float64) tensor(-8.9972, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6215, dtype=torch.float64) delta_t tensor(0.4851, dtype=torch.float64)
15 gae_duplicate tensor(0.1834, dtype=torch.float64) tensor(-6.8097, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4394, dtype=torch.float64) delta_t tensor(0.2882, dtype=torch.float64)
14 gae_duplicate tensor(-0.3511, dtype=torch.float64) tensor(-4.0792, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6784, dtype=torch.float64) delta_t tensor(0.5800, dtype=torch.float64)
13 gae_duplicate tensor(0.0507, dtype=torch.float64) tensor(-7.1004, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6539, dtype=torch.float64) delta_t tensor(0.5634, dtype=torch.float64)
12 gae_duplicate tensor(0.4192, dtype=torch.float64) tensor(-7.9512, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6564, dtype=torch.float64) delta_t tensor(0.5683, dtype=torch.float64)
11 gae_duplicate tensor(0.3628, dtype=torch.float64) tensor(-8.2837, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1241, dtype=torch.float64) delta_t tensor(-0.1723, dtype=torch.float64)
10 gae_duplicate tensor(-3.4521, dtype=torch.float64) tensor(0.5415, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2578, dtype=torch.float64) delta_t tensor(-0.3010, dtype=torch.float64)
9 gae_duplicate tensor(-1.9073, dtype=torch.float64) tensor(4.4301, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0502, dtype=torch.float64) delta_t tensor(-0.0781, dtype=torch.float64)
8 gae_duplicate tensor(-0.7346, dtype=torch.float64) tensor(1.3017, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0169, dtype=torch.float64) delta_t tensor(-0.0316, dtype=torch.float64)
7 gae_duplicate tensor(-0.5218, dtype=torch.float64) tensor(0.4791, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8601, dtype=torch.float64) delta_t tensor(-0.9622, dtype=torch.float64)
6 gae_duplicate tensor(-1.9801, dtype=torch.float64) tensor(12.6828, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1257, dtype=torch.float64) delta_t tensor(-1.2595, dtype=torch.float64)
5 gae_duplicate tensor(-2.1559, dtype=torch.float64) tensor(16.5403, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2782, dtype=torch.float64) delta_t tensor(-1.3549, dtype=torch.float64)
4 gae_duplicate tensor(-7.1928, dtype=torch.float64) tensor(19.3126, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5748, dtype=torch.float64) delta_t tensor(-0.6643, dtype=torch.float64)
3 gae_duplicate tensor(-1.4598, dtype=torch.float64) tensor(9.5422, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7389, dtype=torch.float64) delta_t tensor(-0.7011, dtype=torch.float64)
2 gae_duplicate tensor(-1.6741, dtype=torch.float64) tensor(8.7407, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-139.29022216796875
value loss:195.80775451660156
entropies:221.7919921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7832722663879395 seconds
19 rew tensor(0.7811, dtype=torch.float64) delta_t tensor(0.6800, dtype=torch.float64)
19 gae_duplicate tensor(0.2757, dtype=torch.float64) tensor(-8.6443, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7828, dtype=torch.float64) delta_t tensor(0.6909, dtype=torch.float64)
18 gae_duplicate tensor(0.3305, dtype=torch.float64) tensor(-8.5811, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7682, dtype=torch.float64) delta_t tensor(0.6876, dtype=torch.float64)
17 gae_duplicate tensor(0.3172, dtype=torch.float64) tensor(-9.6754, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7374, dtype=torch.float64) delta_t tensor(0.7337, dtype=torch.float64)
16 gae_duplicate tensor(0.5443, dtype=torch.float64) tensor(-9.4837, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6994, dtype=torch.float64) delta_t tensor(0.6591, dtype=torch.float64)
15 gae_duplicate tensor(0.3889, dtype=torch.float64) tensor(-8.8927, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5609, dtype=torch.float64) delta_t tensor(0.4751, dtype=torch.float64)
14 gae_duplicate tensor(-0.0524, dtype=torch.float64) tensor(-6.5851, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5678, dtype=torch.float64) delta_t tensor(0.4949, dtype=torch.float64)
13 gae_duplicate tensor(0.1915, dtype=torch.float64) tensor(-6.5651, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4293, dtype=torch.float64) delta_t tensor(0.3513, dtype=torch.float64)
12 gae_duplicate tensor(0.0983, dtype=torch.float64) tensor(-5.0938, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5119, dtype=torch.float64) delta_t tensor(0.4596, dtype=torch.float64)
11 gae_duplicate tensor(-0.0925, dtype=torch.float64) tensor(-6.2155, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1958, dtype=torch.float64) delta_t tensor(0.1365, dtype=torch.float64)
10 gae_duplicate tensor(-0.8724, dtype=torch.float64) tensor(-2.6620, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6075, dtype=torch.float64) delta_t tensor(-0.6646, dtype=torch.float64)
9 gae_duplicate tensor(-2.3652, dtype=torch.float64) tensor(8.1756, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0993, dtype=torch.float64) delta_t tensor(-0.1032, dtype=torch.float64)
8 gae_duplicate tensor(-0.7758, dtype=torch.float64) tensor(2.5037, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4745, dtype=torch.float64) delta_t tensor(-0.5265, dtype=torch.float64)
7 gae_duplicate tensor(-0.7529, dtype=torch.float64) tensor(7.3222, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2866, dtype=torch.float64) delta_t tensor(-1.3055, dtype=torch.float64)
6 gae_duplicate tensor(-2.6533, dtype=torch.float64) tensor(17.1409, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4739, dtype=torch.float64) delta_t tensor(-1.5029, dtype=torch.float64)
5 gae_duplicate tensor(-3.2442, dtype=torch.float64) tensor(20.1032, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8385, dtype=torch.float64) delta_t tensor(-0.9344, dtype=torch.float64)
4 gae_duplicate tensor(-4.9300, dtype=torch.float64) tensor(12.2225, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7046, dtype=torch.float64) delta_t tensor(-0.6983, dtype=torch.float64)
3 gae_duplicate tensor(-1.3223, dtype=torch.float64) tensor(9.2532, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2881, dtype=torch.float64) delta_t tensor(-0.4210, dtype=torch.float64)
2 gae_duplicate tensor(-1.0084, dtype=torch.float64) tensor(5.6392, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-398.5265808105469
value loss:165.3877410888672
entropies:221.6376953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.129968881607056 seconds
19 rew tensor(0.7529, dtype=torch.float64) delta_t tensor(0.6923, dtype=torch.float64)
19 gae_duplicate tensor(0.5918, dtype=torch.float64) tensor(-8.6678, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7380, dtype=torch.float64) delta_t tensor(0.7155, dtype=torch.float64)
18 gae_duplicate tensor(0.6444, dtype=torch.float64) tensor(-9.7864, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6889, dtype=torch.float64) delta_t tensor(0.6688, dtype=torch.float64)
17 gae_duplicate tensor(0.5218, dtype=torch.float64) tensor(-9.2683, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6147, dtype=torch.float64) delta_t tensor(0.6083, dtype=torch.float64)
16 gae_duplicate tensor(0.2430, dtype=torch.float64) tensor(-8.0868, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4732, dtype=torch.float64) delta_t tensor(0.3705, dtype=torch.float64)
15 gae_duplicate tensor(-0.5913, dtype=torch.float64) tensor(-5.4476, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6130, dtype=torch.float64) delta_t tensor(0.5511, dtype=torch.float64)
14 gae_duplicate tensor(0.0256, dtype=torch.float64) tensor(-7.6463, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7770, dtype=torch.float64) delta_t tensor(0.7075, dtype=torch.float64)
13 gae_duplicate tensor(0.4824, dtype=torch.float64) tensor(-9.1168, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7707, dtype=torch.float64) delta_t tensor(0.6893, dtype=torch.float64)
12 gae_duplicate tensor(0.5798, dtype=torch.float64) tensor(-9.8571, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7401, dtype=torch.float64) delta_t tensor(0.6305, dtype=torch.float64)
11 gae_duplicate tensor(0.4127, dtype=torch.float64) tensor(-8.5013, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1011, dtype=torch.float64) delta_t tensor(-0.1942, dtype=torch.float64)
10 gae_duplicate tensor(-3.4441, dtype=torch.float64) tensor(2.1642, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5939, dtype=torch.float64) delta_t tensor(-0.6416, dtype=torch.float64)
9 gae_duplicate tensor(-2.0435, dtype=torch.float64) tensor(8.8456, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1943, dtype=torch.float64) delta_t tensor(-0.1949, dtype=torch.float64)
8 gae_duplicate tensor(-1.6280, dtype=torch.float64) tensor(3.9283, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0855, dtype=torch.float64) delta_t tensor(-0.1409, dtype=torch.float64)
7 gae_duplicate tensor(-0.6000, dtype=torch.float64) tensor(2.1577, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0509, dtype=torch.float64) delta_t tensor(-1.1401, dtype=torch.float64)
6 gae_duplicate tensor(-2.1346, dtype=torch.float64) tensor(13.8745, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3200, dtype=torch.float64) delta_t tensor(-1.4555, dtype=torch.float64)
5 gae_duplicate tensor(-1.9609, dtype=torch.float64) tensor(18.5951, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0792, dtype=torch.float64) delta_t tensor(-2.1490, dtype=torch.float64)
4 gae_duplicate tensor(-9.6554, dtype=torch.float64) tensor(26.7385, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5858, dtype=torch.float64) delta_t tensor(-0.5906, dtype=torch.float64)
3 gae_duplicate tensor(-1.4226, dtype=torch.float64) tensor(10.6358, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5405, dtype=torch.float64) delta_t tensor(-0.5454, dtype=torch.float64)
2 gae_duplicate tensor(-1.4417, dtype=torch.float64) tensor(7.6344, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-695.018798828125
value loss:292.8828125
entropies:222.08950805664062
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2487.6768)
ToM Target loss= tensor(1800.0037)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.607324838638306 seconds
19 rew tensor(0.7774, dtype=torch.float64) delta_t tensor(0.6765, dtype=torch.float64)
19 gae_duplicate tensor(0.4972, dtype=torch.float64) tensor(-8.1996, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7789, dtype=torch.float64) delta_t tensor(0.6820, dtype=torch.float64)
18 gae_duplicate tensor(0.5804, dtype=torch.float64) tensor(-9.6434, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7804, dtype=torch.float64) delta_t tensor(0.7026, dtype=torch.float64)
17 gae_duplicate tensor(0.6809, dtype=torch.float64) tensor(-9.3480, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7655, dtype=torch.float64) delta_t tensor(0.6421, dtype=torch.float64)
16 gae_duplicate tensor(0.4622, dtype=torch.float64) tensor(-9.0284, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7670, dtype=torch.float64) delta_t tensor(0.6873, dtype=torch.float64)
15 gae_duplicate tensor(0.6522, dtype=torch.float64) tensor(-9.3156, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7275, dtype=torch.float64) delta_t tensor(0.6488, dtype=torch.float64)
14 gae_duplicate tensor(0.5954, dtype=torch.float64) tensor(-9.6770, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7124, dtype=torch.float64) delta_t tensor(0.6076, dtype=torch.float64)
13 gae_duplicate tensor(0.5016, dtype=torch.float64) tensor(-7.9398, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7629, dtype=torch.float64) delta_t tensor(0.6886, dtype=torch.float64)
12 gae_duplicate tensor(0.6492, dtype=torch.float64) tensor(-9.6325, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6915, dtype=torch.float64) delta_t tensor(0.5942, dtype=torch.float64)
11 gae_duplicate tensor(0.3805, dtype=torch.float64) tensor(-8.2444, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5552, dtype=torch.float64) delta_t tensor(0.5215, dtype=torch.float64)
10 gae_duplicate tensor(0.1880, dtype=torch.float64) tensor(-7.3550, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2371, dtype=torch.float64) delta_t tensor(-0.2816, dtype=torch.float64)
9 gae_duplicate tensor(-1.4781, dtype=torch.float64) tensor(2.5121, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3348, dtype=torch.float64) delta_t tensor(-0.3357, dtype=torch.float64)
8 gae_duplicate tensor(-1.6298, dtype=torch.float64) tensor(4.5443, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7999, dtype=torch.float64) delta_t tensor(-0.8200, dtype=torch.float64)
7 gae_duplicate tensor(-2.6674, dtype=torch.float64) tensor(11.7436, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8202, dtype=torch.float64) delta_t tensor(-0.8993, dtype=torch.float64)
6 gae_duplicate tensor(-2.3230, dtype=torch.float64) tensor(12.5569, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2010, dtype=torch.float64) delta_t tensor(-1.3041, dtype=torch.float64)
5 gae_duplicate tensor(-2.3444, dtype=torch.float64) tensor(16.8812, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2805, dtype=torch.float64) delta_t tensor(-1.3869, dtype=torch.float64)
4 gae_duplicate tensor(-6.0165, dtype=torch.float64) tensor(20.3781, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5821, dtype=torch.float64) delta_t tensor(-0.6211, dtype=torch.float64)
3 gae_duplicate tensor(-1.4530, dtype=torch.float64) tensor(9.3325, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4630, dtype=torch.float64) delta_t tensor(-0.4039, dtype=torch.float64)
2 gae_duplicate tensor(-0.8325, dtype=torch.float64) tensor(5.6672, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:131.6381072998047
value loss:176.2595672607422
entropies:222.25552368164062
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.819355010986328 seconds
19 rew tensor(0.7776, dtype=torch.float64) delta_t tensor(0.7520, dtype=torch.float64)
19 gae_duplicate tensor(0.6376, dtype=torch.float64) tensor(-9.5546, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7710, dtype=torch.float64) delta_t tensor(0.7774, dtype=torch.float64)
18 gae_duplicate tensor(0.7862, dtype=torch.float64) tensor(-10.6982, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7725, dtype=torch.float64) delta_t tensor(0.7735, dtype=torch.float64)
17 gae_duplicate tensor(0.7936, dtype=torch.float64) tensor(-10.6924, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7658, dtype=torch.float64) delta_t tensor(0.7753, dtype=torch.float64)
16 gae_duplicate tensor(0.7787, dtype=torch.float64) tensor(-10.5026, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7512, dtype=torch.float64) delta_t tensor(0.7569, dtype=torch.float64)
15 gae_duplicate tensor(0.7652, dtype=torch.float64) tensor(-10.6372, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7205, dtype=torch.float64) delta_t tensor(0.6553, dtype=torch.float64)
14 gae_duplicate tensor(0.4599, dtype=torch.float64) tensor(-9.3822, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6071, dtype=torch.float64) delta_t tensor(0.5479, dtype=torch.float64)
13 gae_duplicate tensor(0.2803, dtype=torch.float64) tensor(-7.4232, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6377, dtype=torch.float64) delta_t tensor(0.5665, dtype=torch.float64)
12 gae_duplicate tensor(0.2842, dtype=torch.float64) tensor(-8.1622, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5394, dtype=torch.float64) delta_t tensor(0.4481, dtype=torch.float64)
11 gae_duplicate tensor(0.0731, dtype=torch.float64) tensor(-6.0167, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4099, dtype=torch.float64) delta_t tensor(0.3710, dtype=torch.float64)
10 gae_duplicate tensor(-0.0295, dtype=torch.float64) tensor(-5.3880, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3515, dtype=torch.float64) delta_t tensor(-0.3765, dtype=torch.float64)
9 gae_duplicate tensor(-1.3246, dtype=torch.float64) tensor(4.0981, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5993, dtype=torch.float64) delta_t tensor(-0.6724, dtype=torch.float64)
8 gae_duplicate tensor(-2.4629, dtype=torch.float64) tensor(8.2453, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4769, dtype=torch.float64) delta_t tensor(-0.4882, dtype=torch.float64)
7 gae_duplicate tensor(-0.8964, dtype=torch.float64) tensor(7.8359, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5129, dtype=torch.float64) delta_t tensor(-0.5839, dtype=torch.float64)
6 gae_duplicate tensor(-3.0027, dtype=torch.float64) tensor(8.8312, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9872, dtype=torch.float64) delta_t tensor(-1.0189, dtype=torch.float64)
5 gae_duplicate tensor(-2.0980, dtype=torch.float64) tensor(12.9654, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5010, dtype=torch.float64) delta_t tensor(-1.6109, dtype=torch.float64)
4 gae_duplicate tensor(-5.6148, dtype=torch.float64) tensor(20.1203, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7864, dtype=torch.float64) delta_t tensor(-0.8001, dtype=torch.float64)
3 gae_duplicate tensor(-1.1510, dtype=torch.float64) tensor(11.9425, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3843, dtype=torch.float64) delta_t tensor(-0.4481, dtype=torch.float64)
2 gae_duplicate tensor(-0.9092, dtype=torch.float64) tensor(7.4169, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:212.0376434326172
value loss:182.91482543945312
entropies:222.36790466308594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9518609046936035 seconds
19 rew tensor(0.7604, dtype=torch.float64) delta_t tensor(0.7192, dtype=torch.float64)
19 gae_duplicate tensor(0.4899, dtype=torch.float64) tensor(-8.6822, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7536, dtype=torch.float64) delta_t tensor(0.7262, dtype=torch.float64)
18 gae_duplicate tensor(0.4617, dtype=torch.float64) tensor(-9.8098, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7305, dtype=torch.float64) delta_t tensor(0.7559, dtype=torch.float64)
17 gae_duplicate tensor(0.5554, dtype=torch.float64) tensor(-10.1231, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6667, dtype=torch.float64) delta_t tensor(0.6711, dtype=torch.float64)
16 gae_duplicate tensor(0.2439, dtype=torch.float64) tensor(-9.6420, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5705, dtype=torch.float64) delta_t tensor(0.5854, dtype=torch.float64)
15 gae_duplicate tensor(-0.4478, dtype=torch.float64) tensor(-8.5042, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7824, dtype=torch.float64) delta_t tensor(0.7899, dtype=torch.float64)
14 gae_duplicate tensor(0.7544, dtype=torch.float64) tensor(-9.9831, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7838, dtype=torch.float64) delta_t tensor(0.7943, dtype=torch.float64)
13 gae_duplicate tensor(0.7943, dtype=torch.float64) tensor(-11.3715, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7446, dtype=torch.float64) delta_t tensor(0.7405, dtype=torch.float64)
12 gae_duplicate tensor(0.6618, dtype=torch.float64) tensor(-10.1659, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6725, dtype=torch.float64) delta_t tensor(0.6716, dtype=torch.float64)
11 gae_duplicate tensor(0.4935, dtype=torch.float64) tensor(-9.0839, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4244, dtype=torch.float64) delta_t tensor(0.3717, dtype=torch.float64)
10 gae_duplicate tensor(0.0368, dtype=torch.float64) tensor(-5.6009, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2365, dtype=torch.float64) delta_t tensor(-1.2225, dtype=torch.float64)
9 gae_duplicate tensor(-4.9355, dtype=torch.float64) tensor(13.5463, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6646, dtype=torch.float64) delta_t tensor(-0.6950, dtype=torch.float64)
8 gae_duplicate tensor(-2.0556, dtype=torch.float64) tensor(9.2236, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3548, dtype=torch.float64) delta_t tensor(-0.3739, dtype=torch.float64)
7 gae_duplicate tensor(-1.2654, dtype=torch.float64) tensor(6.3164, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7480, dtype=torch.float64) delta_t tensor(-0.7983, dtype=torch.float64)
6 gae_duplicate tensor(-2.0317, dtype=torch.float64) tensor(10.8216, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3142, dtype=torch.float64) delta_t tensor(-1.3932, dtype=torch.float64)
5 gae_duplicate tensor(-2.3932, dtype=torch.float64) tensor(16.7611, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9604, dtype=torch.float64) delta_t tensor(-1.1085, dtype=torch.float64)
4 gae_duplicate tensor(-4.8179, dtype=torch.float64) tensor(17.1099, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5102, dtype=torch.float64) delta_t tensor(-0.5280, dtype=torch.float64)
3 gae_duplicate tensor(-1.4399, dtype=torch.float64) tensor(8.4443, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3037, dtype=torch.float64) delta_t tensor(-0.3479, dtype=torch.float64)
2 gae_duplicate tensor(-0.8225, dtype=torch.float64) tensor(5.2300, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:158.38389587402344
value loss:207.5095672607422
entropies:222.75631713867188
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.520784139633179 seconds
19 rew tensor(0.7738, dtype=torch.float64) delta_t tensor(0.6676, dtype=torch.float64)
19 gae_duplicate tensor(0.4937, dtype=torch.float64) tensor(-8.6932, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7751, dtype=torch.float64) delta_t tensor(0.7481, dtype=torch.float64)
18 gae_duplicate tensor(0.6796, dtype=torch.float64) tensor(-10.0933, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7764, dtype=torch.float64) delta_t tensor(0.7844, dtype=torch.float64)
17 gae_duplicate tensor(0.7674, dtype=torch.float64) tensor(-10.2750, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7777, dtype=torch.float64) delta_t tensor(0.7797, dtype=torch.float64)
16 gae_duplicate tensor(0.7693, dtype=torch.float64) tensor(-11.2767, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7790, dtype=torch.float64) delta_t tensor(0.7609, dtype=torch.float64)
15 gae_duplicate tensor(0.7710, dtype=torch.float64) tensor(-10.4946, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7803, dtype=torch.float64) delta_t tensor(0.7755, dtype=torch.float64)
14 gae_duplicate tensor(0.7722, dtype=torch.float64) tensor(-11.0321, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7660, dtype=torch.float64) delta_t tensor(0.7892, dtype=torch.float64)
13 gae_duplicate tensor(0.7126, dtype=torch.float64) tensor(-10.7511, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6604, dtype=torch.float64) delta_t tensor(0.6375, dtype=torch.float64)
12 gae_duplicate tensor(0.3720, dtype=torch.float64) tensor(-8.9415, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5648, dtype=torch.float64) delta_t tensor(0.5164, dtype=torch.float64)
11 gae_duplicate tensor(0.2874, dtype=torch.float64) tensor(-7.6321, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4500, dtype=torch.float64) delta_t tensor(0.4748, dtype=torch.float64)
10 gae_duplicate tensor(0.2132, dtype=torch.float64) tensor(-6.6871, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2543, dtype=torch.float64) delta_t tensor(0.2416, dtype=torch.float64)
9 gae_duplicate tensor(0.1798, dtype=torch.float64) tensor(-3.5870, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1646, dtype=torch.float64) delta_t tensor(0.1515, dtype=torch.float64)
8 gae_duplicate tensor(0.0730, dtype=torch.float64) tensor(-2.0587, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4203, dtype=torch.float64) delta_t tensor(-0.4644, dtype=torch.float64)
7 gae_duplicate tensor(-1.5610, dtype=torch.float64) tensor(5.4299, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5844, dtype=torch.float64) delta_t tensor(-0.6264, dtype=torch.float64)
6 gae_duplicate tensor(-0.9597, dtype=torch.float64) tensor(8.2238, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2275, dtype=torch.float64) delta_t tensor(-1.2527, dtype=torch.float64)
5 gae_duplicate tensor(-3.4709, dtype=torch.float64) tensor(16.3864, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8335, dtype=torch.float64) delta_t tensor(-1.8431, dtype=torch.float64)
4 gae_duplicate tensor(-7.0290, dtype=torch.float64) tensor(25.5367, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9103, dtype=torch.float64) delta_t tensor(-0.9349, dtype=torch.float64)
3 gae_duplicate tensor(-1.4396, dtype=torch.float64) tensor(14.8695, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5212, dtype=torch.float64) delta_t tensor(-0.5338, dtype=torch.float64)
2 gae_duplicate tensor(-1.1111, dtype=torch.float64) tensor(7.8056, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:797.6405029296875
value loss:191.90164184570312
entropies:222.7813720703125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.957687139511108 seconds
19 rew tensor(0.7589, dtype=torch.float64) delta_t tensor(0.6773, dtype=torch.float64)
19 gae_duplicate tensor(0.4499, dtype=torch.float64) tensor(-8.2423, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7359, dtype=torch.float64) delta_t tensor(0.5770, dtype=torch.float64)
18 gae_duplicate tensor(0.4541, dtype=torch.float64) tensor(-8.0917, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7131, dtype=torch.float64) delta_t tensor(0.6545, dtype=torch.float64)
17 gae_duplicate tensor(0.4384, dtype=torch.float64) tensor(-9.2987, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6659, dtype=torch.float64) delta_t tensor(0.6231, dtype=torch.float64)
16 gae_duplicate tensor(0.4225, dtype=torch.float64) tensor(-8.3429, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5388, dtype=torch.float64) delta_t tensor(0.4436, dtype=torch.float64)
15 gae_duplicate tensor(0.0913, dtype=torch.float64) tensor(-6.0744, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3396, dtype=torch.float64) delta_t tensor(0.2836, dtype=torch.float64)
14 gae_duplicate tensor(-0.2442, dtype=torch.float64) tensor(-4.1227, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6887, dtype=torch.float64) delta_t tensor(0.6084, dtype=torch.float64)
13 gae_duplicate tensor(0.3770, dtype=torch.float64) tensor(-7.6476, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6645, dtype=torch.float64) delta_t tensor(0.5746, dtype=torch.float64)
12 gae_duplicate tensor(0.3919, dtype=torch.float64) tensor(-7.6063, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6191, dtype=torch.float64) delta_t tensor(0.5432, dtype=torch.float64)
11 gae_duplicate tensor(0.2952, dtype=torch.float64) tensor(-7.6392, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5211, dtype=torch.float64) delta_t tensor(0.4552, dtype=torch.float64)
10 gae_duplicate tensor(0.1930, dtype=torch.float64) tensor(-6.7991, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0142, dtype=torch.float64) delta_t tensor(-1.0720, dtype=torch.float64)
9 gae_duplicate tensor(-3.1011, dtype=torch.float64) tensor(11.7218, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2292, dtype=torch.float64) delta_t tensor(-0.2191, dtype=torch.float64)
8 gae_duplicate tensor(-1.7316, dtype=torch.float64) tensor(4.2254, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4171, dtype=torch.float64) delta_t tensor(-0.4103, dtype=torch.float64)
7 gae_duplicate tensor(-1.5874, dtype=torch.float64) tensor(5.6823, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4222, dtype=torch.float64) delta_t tensor(-1.4682, dtype=torch.float64)
6 gae_duplicate tensor(-3.1619, dtype=torch.float64) tensor(17.5770, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2355, dtype=torch.float64) delta_t tensor(-1.3015, dtype=torch.float64)
5 gae_duplicate tensor(-2.6289, dtype=torch.float64) tensor(18.1961, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0977, dtype=torch.float64) delta_t tensor(-2.1906, dtype=torch.float64)
4 gae_duplicate tensor(-5.3245, dtype=torch.float64) tensor(27.9456, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3102, dtype=torch.float64) delta_t tensor(-0.3313, dtype=torch.float64)
3 gae_duplicate tensor(-1.5061, dtype=torch.float64) tensor(7.1199, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5440, dtype=torch.float64) delta_t tensor(-0.5084, dtype=torch.float64)
2 gae_duplicate tensor(-1.5634, dtype=torch.float64) tensor(6.4331, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-941.39306640625
value loss:229.58810424804688
entropies:222.67652893066406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2494.7380)
ToM Target loss= tensor(1798.9171)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.153650999069214 seconds
19 rew tensor(0.7688, dtype=torch.float64) delta_t tensor(0.7113, dtype=torch.float64)
19 gae_duplicate tensor(0.4316, dtype=torch.float64) tensor(-8.4099, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7617, dtype=torch.float64) delta_t tensor(0.6967, dtype=torch.float64)
18 gae_duplicate tensor(0.5192, dtype=torch.float64) tensor(-9.3060, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7547, dtype=torch.float64) delta_t tensor(0.7495, dtype=torch.float64)
17 gae_duplicate tensor(0.5600, dtype=torch.float64) tensor(-10.0650, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7229, dtype=torch.float64) delta_t tensor(0.7175, dtype=torch.float64)
16 gae_duplicate tensor(0.5261, dtype=torch.float64) tensor(-9.7830, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6828, dtype=torch.float64) delta_t tensor(0.6341, dtype=torch.float64)
15 gae_duplicate tensor(0.2650, dtype=torch.float64) tensor(-8.5430, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5851, dtype=torch.float64) delta_t tensor(0.5123, dtype=torch.float64)
14 gae_duplicate tensor(-0.4647, dtype=torch.float64) tensor(-7.3848, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6472, dtype=torch.float64) delta_t tensor(0.6492, dtype=torch.float64)
13 gae_duplicate tensor(0.3042, dtype=torch.float64) tensor(-8.7089, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6320, dtype=torch.float64) delta_t tensor(0.6185, dtype=torch.float64)
12 gae_duplicate tensor(0.2415, dtype=torch.float64) tensor(-8.3632, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5417, dtype=torch.float64) delta_t tensor(0.5056, dtype=torch.float64)
11 gae_duplicate tensor(0.1761, dtype=torch.float64) tensor(-6.7031, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3035, dtype=torch.float64) delta_t tensor(0.2692, dtype=torch.float64)
10 gae_duplicate tensor(-0.4783, dtype=torch.float64) tensor(-4.3421, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2141, dtype=torch.float64) delta_t tensor(0.2108, dtype=torch.float64)
9 gae_duplicate tensor(-0.8068, dtype=torch.float64) tensor(-2.9690, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7240, dtype=torch.float64) delta_t tensor(-0.7429, dtype=torch.float64)
8 gae_duplicate tensor(-3.4553, dtype=torch.float64) tensor(10.1174, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1174, dtype=torch.float64) delta_t tensor(-0.1321, dtype=torch.float64)
7 gae_duplicate tensor(-0.6872, dtype=torch.float64) tensor(2.5558, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6244, dtype=torch.float64) delta_t tensor(-0.6457, dtype=torch.float64)
6 gae_duplicate tensor(-1.1632, dtype=torch.float64) tensor(7.5652, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7080, dtype=torch.float64) delta_t tensor(-0.7607, dtype=torch.float64)
5 gae_duplicate tensor(-2.2618, dtype=torch.float64) tensor(9.2113, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3210, dtype=torch.float64) delta_t tensor(-0.3007, dtype=torch.float64)
4 gae_duplicate tensor(-1.2643, dtype=torch.float64) tensor(4.4759, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8302, dtype=torch.float64) delta_t tensor(-0.7749, dtype=torch.float64)
3 gae_duplicate tensor(-1.4365, dtype=torch.float64) tensor(9.7846, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7499, dtype=torch.float64) delta_t tensor(-0.7380, dtype=torch.float64)
2 gae_duplicate tensor(-1.4433, dtype=torch.float64) tensor(10.1759, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1064.823486328125
value loss:111.80239868164062
entropies:222.67633056640625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.993411064147949 seconds
19 rew tensor(0.5073, dtype=torch.float64) delta_t tensor(0.4746, dtype=torch.float64)
19 gae_duplicate tensor(-0.8647, dtype=torch.float64) tensor(-5.6059, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7792, dtype=torch.float64) delta_t tensor(0.7330, dtype=torch.float64)
18 gae_duplicate tensor(0.6631, dtype=torch.float64) tensor(-9.3521, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7554, dtype=torch.float64) delta_t tensor(0.7272, dtype=torch.float64)
17 gae_duplicate tensor(0.7553, dtype=torch.float64) tensor(-10.7126, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7483, dtype=torch.float64) delta_t tensor(0.7224, dtype=torch.float64)
16 gae_duplicate tensor(0.7347, dtype=torch.float64) tensor(-9.9553, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7243, dtype=torch.float64) delta_t tensor(0.6944, dtype=torch.float64)
15 gae_duplicate tensor(0.6840, dtype=torch.float64) tensor(-9.0672, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6921, dtype=torch.float64) delta_t tensor(0.6342, dtype=torch.float64)
14 gae_duplicate tensor(0.4446, dtype=torch.float64) tensor(-8.3365, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6506, dtype=torch.float64) delta_t tensor(0.6146, dtype=torch.float64)
13 gae_duplicate tensor(0.5656, dtype=torch.float64) tensor(-8.8451, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0170, dtype=torch.float64) delta_t tensor(-0.0013, dtype=torch.float64)
12 gae_duplicate tensor(-3.5793, dtype=torch.float64) tensor(-1.7512, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6775, dtype=torch.float64) delta_t tensor(0.6806, dtype=torch.float64)
11 gae_duplicate tensor(0.3191, dtype=torch.float64) tensor(-8.6715, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6040, dtype=torch.float64) delta_t tensor(0.6033, dtype=torch.float64)
10 gae_duplicate tensor(0.5045, dtype=torch.float64) tensor(-8.1563, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0886, dtype=torch.float64) delta_t tensor(0.0644, dtype=torch.float64)
9 gae_duplicate tensor(-1.4318, dtype=torch.float64) tensor(-1.9168, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2628, dtype=torch.float64) delta_t tensor(-0.2713, dtype=torch.float64)
8 gae_duplicate tensor(-2.5116, dtype=torch.float64) tensor(3.9788, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4921, dtype=torch.float64) delta_t tensor(-0.5223, dtype=torch.float64)
7 gae_duplicate tensor(-1.9751, dtype=torch.float64) tensor(6.6846, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0524, dtype=torch.float64) delta_t tensor(-1.1106, dtype=torch.float64)
6 gae_duplicate tensor(-2.3071, dtype=torch.float64) tensor(14.4433, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6850, dtype=torch.float64) delta_t tensor(-0.7275, dtype=torch.float64)
5 gae_duplicate tensor(-2.3559, dtype=torch.float64) tensor(11.0263, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4531, dtype=torch.float64) delta_t tensor(-0.4961, dtype=torch.float64)
4 gae_duplicate tensor(-1.1864, dtype=torch.float64) tensor(7.1572, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4583, dtype=torch.float64) delta_t tensor(-0.4772, dtype=torch.float64)
3 gae_duplicate tensor(-1.2062, dtype=torch.float64) tensor(6.5901, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5039, dtype=torch.float64) delta_t tensor(-0.5277, dtype=torch.float64)
2 gae_duplicate tensor(-1.0727, dtype=torch.float64) tensor(7.4519, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:861.2936401367188
value loss:134.92724609375
entropies:222.7212371826172
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9090659618377686 seconds
19 rew tensor(0.7844, dtype=torch.float64) delta_t tensor(0.7169, dtype=torch.float64)
19 gae_duplicate tensor(0.6542, dtype=torch.float64) tensor(-8.7438, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7603, dtype=torch.float64) delta_t tensor(0.6880, dtype=torch.float64)
18 gae_duplicate tensor(0.6986, dtype=torch.float64) tensor(-8.9111, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7361, dtype=torch.float64) delta_t tensor(0.6137, dtype=torch.float64)
17 gae_duplicate tensor(0.3224, dtype=torch.float64) tensor(-8.3280, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6865, dtype=torch.float64) delta_t tensor(0.6075, dtype=torch.float64)
16 gae_duplicate tensor(0.5706, dtype=torch.float64) tensor(-8.5134, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6032, dtype=torch.float64) delta_t tensor(0.5288, dtype=torch.float64)
15 gae_duplicate tensor(0.4838, dtype=torch.float64) tensor(-7.0042, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4445, dtype=torch.float64) delta_t tensor(0.2412, dtype=torch.float64)
14 gae_duplicate tensor(-0.0356, dtype=torch.float64) tensor(-3.8769, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4001, dtype=torch.float64) delta_t tensor(0.2714, dtype=torch.float64)
13 gae_duplicate tensor(0.0168, dtype=torch.float64) tensor(-3.7529, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7267, dtype=torch.float64) delta_t tensor(0.6556, dtype=torch.float64)
12 gae_duplicate tensor(0.3568, dtype=torch.float64) tensor(-7.8686, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6313, dtype=torch.float64) delta_t tensor(0.5149, dtype=torch.float64)
11 gae_duplicate tensor(0.0126, dtype=torch.float64) tensor(-7.4014, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3757, dtype=torch.float64) delta_t tensor(0.2613, dtype=torch.float64)
10 gae_duplicate tensor(-1.0338, dtype=torch.float64) tensor(-3.5068, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5742, dtype=torch.float64) delta_t tensor(-0.6579, dtype=torch.float64)
9 gae_duplicate tensor(-1.7059, dtype=torch.float64) tensor(7.1581, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4516, dtype=torch.float64) delta_t tensor(-0.4420, dtype=torch.float64)
8 gae_duplicate tensor(-0.7522, dtype=torch.float64) tensor(6.2087, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8947, dtype=torch.float64) delta_t tensor(-0.9207, dtype=torch.float64)
7 gae_duplicate tensor(-2.9571, dtype=torch.float64) tensor(12.2448, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5220, dtype=torch.float64) delta_t tensor(-1.5464, dtype=torch.float64)
6 gae_duplicate tensor(-3.0565, dtype=torch.float64) tensor(20.5703, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1044, dtype=torch.float64) delta_t tensor(-1.1637, dtype=torch.float64)
5 gae_duplicate tensor(-2.1037, dtype=torch.float64) tensor(16.2193, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8853, dtype=torch.float64) delta_t tensor(-0.9296, dtype=torch.float64)
4 gae_duplicate tensor(-2.0226, dtype=torch.float64) tensor(12.6984, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5569, dtype=torch.float64) delta_t tensor(-0.6019, dtype=torch.float64)
3 gae_duplicate tensor(-1.2581, dtype=torch.float64) tensor(9.6634, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5570, dtype=torch.float64) delta_t tensor(-0.5889, dtype=torch.float64)
2 gae_duplicate tensor(-1.0647, dtype=torch.float64) tensor(8.1317, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-939.6563110351562
value loss:151.0846710205078
entropies:222.79440307617188
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.015465021133423 seconds
19 rew tensor(0.7850, dtype=torch.float64) delta_t tensor(0.7030, dtype=torch.float64)
19 gae_duplicate tensor(0.6028, dtype=torch.float64) tensor(-8.7969, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7861, dtype=torch.float64) delta_t tensor(0.7433, dtype=torch.float64)
18 gae_duplicate tensor(0.7265, dtype=torch.float64) tensor(-10.2609, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7872, dtype=torch.float64) delta_t tensor(0.7255, dtype=torch.float64)
17 gae_duplicate tensor(0.6445, dtype=torch.float64) tensor(-10.1214, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6282, dtype=torch.float64) delta_t tensor(0.5508, dtype=torch.float64)
16 gae_duplicate tensor(-0.2708, dtype=torch.float64) tensor(-7.4836, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6206, dtype=torch.float64) delta_t tensor(0.5804, dtype=torch.float64)
15 gae_duplicate tensor(-0.1940, dtype=torch.float64) tensor(-8.2968, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7057, dtype=torch.float64) delta_t tensor(0.6252, dtype=torch.float64)
14 gae_duplicate tensor(0.1676, dtype=torch.float64) tensor(-8.5193, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6730, dtype=torch.float64) delta_t tensor(0.5541, dtype=torch.float64)
13 gae_duplicate tensor(0.0232, dtype=torch.float64) tensor(-7.0566, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6656, dtype=torch.float64) delta_t tensor(0.6233, dtype=torch.float64)
12 gae_duplicate tensor(0.0982, dtype=torch.float64) tensor(-9.1044, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5484, dtype=torch.float64) delta_t tensor(0.4525, dtype=torch.float64)
11 gae_duplicate tensor(-0.4569, dtype=torch.float64) tensor(-6.8222, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5072, dtype=torch.float64) delta_t tensor(0.4236, dtype=torch.float64)
10 gae_duplicate tensor(-0.7121, dtype=torch.float64) tensor(-5.0905, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2970, dtype=torch.float64) delta_t tensor(0.2557, dtype=torch.float64)
9 gae_duplicate tensor(-0.4982, dtype=torch.float64) tensor(-3.5131, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4236, dtype=torch.float64) delta_t tensor(-0.4337, dtype=torch.float64)
8 gae_duplicate tensor(-1.5369, dtype=torch.float64) tensor(4.8472, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2616, dtype=torch.float64) delta_t tensor(-0.2944, dtype=torch.float64)
7 gae_duplicate tensor(-1.9205, dtype=torch.float64) tensor(4.8689, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0425, dtype=torch.float64) delta_t tensor(-1.1084, dtype=torch.float64)
6 gae_duplicate tensor(-3.3761, dtype=torch.float64) tensor(14.1877, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0710, dtype=torch.float64) delta_t tensor(-1.1081, dtype=torch.float64)
5 gae_duplicate tensor(-2.2875, dtype=torch.float64) tensor(14.5284, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4812, dtype=torch.float64) delta_t tensor(-1.4711, dtype=torch.float64)
4 gae_duplicate tensor(-4.8894, dtype=torch.float64) tensor(18.5191, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8592, dtype=torch.float64) delta_t tensor(-0.8672, dtype=torch.float64)
3 gae_duplicate tensor(-1.4694, dtype=torch.float64) tensor(12.5544, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3868, dtype=torch.float64) delta_t tensor(-0.4338, dtype=torch.float64)
2 gae_duplicate tensor(-1.1675, dtype=torch.float64) tensor(6.4887, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:286.5238342285156
value loss:164.09695434570312
entropies:222.47438049316406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.814496040344238 seconds
19 rew tensor(0.7674, dtype=torch.float64) delta_t tensor(0.6394, dtype=torch.float64)
19 gae_duplicate tensor(0.3882, dtype=torch.float64) tensor(-7.7555, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7522, dtype=torch.float64) delta_t tensor(0.6204, dtype=torch.float64)
18 gae_duplicate tensor(0.3589, dtype=torch.float64) tensor(-8.2270, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7215, dtype=torch.float64) delta_t tensor(0.6053, dtype=torch.float64)
17 gae_duplicate tensor(0.4366, dtype=torch.float64) tensor(-8.2238, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6520, dtype=torch.float64) delta_t tensor(0.6150, dtype=torch.float64)
16 gae_duplicate tensor(0.1856, dtype=torch.float64) tensor(-8.5152, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5430, dtype=torch.float64) delta_t tensor(0.4515, dtype=torch.float64)
15 gae_duplicate tensor(-0.4408, dtype=torch.float64) tensor(-5.8932, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6945, dtype=torch.float64) delta_t tensor(0.5842, dtype=torch.float64)
14 gae_duplicate tensor(-0.1014, dtype=torch.float64) tensor(-7.5352, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7720, dtype=torch.float64) delta_t tensor(0.6776, dtype=torch.float64)
13 gae_duplicate tensor(0.4227, dtype=torch.float64) tensor(-9.0375, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7730, dtype=torch.float64) delta_t tensor(0.6968, dtype=torch.float64)
12 gae_duplicate tensor(0.5334, dtype=torch.float64) tensor(-10.2744, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7171, dtype=torch.float64) delta_t tensor(0.6692, dtype=torch.float64)
11 gae_duplicate tensor(0.3737, dtype=torch.float64) tensor(-8.5623, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5790, dtype=torch.float64) delta_t tensor(0.5528, dtype=torch.float64)
10 gae_duplicate tensor(0.1224, dtype=torch.float64) tensor(-7.7353, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2985, dtype=torch.float64) delta_t tensor(-0.3069, dtype=torch.float64)
9 gae_duplicate tensor(-1.6728, dtype=torch.float64) tensor(3.2208, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4302, dtype=torch.float64) delta_t tensor(-0.4252, dtype=torch.float64)
8 gae_duplicate tensor(-1.5786, dtype=torch.float64) tensor(5.4230, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1184, dtype=torch.float64) delta_t tensor(-0.1852, dtype=torch.float64)
7 gae_duplicate tensor(-0.9713, dtype=torch.float64) tensor(2.8340, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0612, dtype=torch.float64) delta_t tensor(-1.0990, dtype=torch.float64)
6 gae_duplicate tensor(-2.3707, dtype=torch.float64) tensor(14.0419, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8907, dtype=torch.float64) delta_t tensor(-0.9070, dtype=torch.float64)
5 gae_duplicate tensor(-1.7375, dtype=torch.float64) tensor(12.4225, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4393, dtype=torch.float64) delta_t tensor(-2.5173, dtype=torch.float64)
4 gae_duplicate tensor(-7.3963, dtype=torch.float64) tensor(35.1013, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3696, dtype=torch.float64) delta_t tensor(-0.3401, dtype=torch.float64)
3 gae_duplicate tensor(-1.2759, dtype=torch.float64) tensor(7.5947, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5942, dtype=torch.float64) delta_t tensor(-0.5734, dtype=torch.float64)
2 gae_duplicate tensor(-1.0853, dtype=torch.float64) tensor(7.6331, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-274.4657897949219
value loss:213.99026489257812
entropies:222.4658203125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2488.1831)
ToM Target loss= tensor(1799.2476)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.796178817749023 seconds
19 rew tensor(0.7757, dtype=torch.float64) delta_t tensor(0.5591, dtype=torch.float64)
19 gae_duplicate tensor(0.2881, dtype=torch.float64) tensor(-6.5834, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7680, dtype=torch.float64) delta_t tensor(0.6181, dtype=torch.float64)
18 gae_duplicate tensor(0.2987, dtype=torch.float64) tensor(-8.1226, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7517, dtype=torch.float64) delta_t tensor(0.6883, dtype=torch.float64)
17 gae_duplicate tensor(0.5515, dtype=torch.float64) tensor(-8.9432, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7093, dtype=torch.float64) delta_t tensor(0.6686, dtype=torch.float64)
16 gae_duplicate tensor(0.3520, dtype=torch.float64) tensor(-8.5190, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6583, dtype=torch.float64) delta_t tensor(0.6138, dtype=torch.float64)
15 gae_duplicate tensor(0.0112, dtype=torch.float64) tensor(-8.7452, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6591, dtype=torch.float64) delta_t tensor(0.6114, dtype=torch.float64)
14 gae_duplicate tensor(-0.0354, dtype=torch.float64) tensor(-8.2763, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7897, dtype=torch.float64) delta_t tensor(0.7359, dtype=torch.float64)
13 gae_duplicate tensor(0.7267, dtype=torch.float64) tensor(-9.7725, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7498, dtype=torch.float64) delta_t tensor(0.6732, dtype=torch.float64)
12 gae_duplicate tensor(0.6205, dtype=torch.float64) tensor(-8.5953, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7265, dtype=torch.float64) delta_t tensor(0.7149, dtype=torch.float64)
11 gae_duplicate tensor(0.5989, dtype=torch.float64) tensor(-9.7008, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4562, dtype=torch.float64) delta_t tensor(0.3839, dtype=torch.float64)
10 gae_duplicate tensor(0.3117, dtype=torch.float64) tensor(-5.6407, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2845, dtype=torch.float64) delta_t tensor(0.2958, dtype=torch.float64)
9 gae_duplicate tensor(0.0854, dtype=torch.float64) tensor(-4.3760, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0293, dtype=torch.float64) delta_t tensor(-0.0090, dtype=torch.float64)
8 gae_duplicate tensor(-0.5863, dtype=torch.float64) tensor(-0.4174, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2725, dtype=torch.float64) delta_t tensor(-0.2917, dtype=torch.float64)
7 gae_duplicate tensor(-0.9353, dtype=torch.float64) tensor(3.2665, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4827, dtype=torch.float64) delta_t tensor(-0.5812, dtype=torch.float64)
6 gae_duplicate tensor(-1.0784, dtype=torch.float64) tensor(6.8687, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9068, dtype=torch.float64) delta_t tensor(-0.9547, dtype=torch.float64)
5 gae_duplicate tensor(-1.6780, dtype=torch.float64) tensor(11.3809, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4113, dtype=torch.float64) delta_t tensor(-0.4132, dtype=torch.float64)
4 gae_duplicate tensor(-1.2579, dtype=torch.float64) tensor(6.9715, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6411, dtype=torch.float64) delta_t tensor(-0.5816, dtype=torch.float64)
3 gae_duplicate tensor(-1.1516, dtype=torch.float64) tensor(7.5511, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6407, dtype=torch.float64) delta_t tensor(-0.6486, dtype=torch.float64)
2 gae_duplicate tensor(-1.0687, dtype=torch.float64) tensor(8.8020, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1502.66259765625
value loss:86.17159271240234
entropies:222.18350219726562
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.85242486000061 seconds
19 rew tensor(0.7462, dtype=torch.float64) delta_t tensor(0.4863, dtype=torch.float64)
19 gae_duplicate tensor(0.1179, dtype=torch.float64) tensor(-5.7721, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7068, dtype=torch.float64) delta_t tensor(0.4760, dtype=torch.float64)
18 gae_duplicate tensor(0.1656, dtype=torch.float64) tensor(-6.4064, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6203, dtype=torch.float64) delta_t tensor(0.4024, dtype=torch.float64)
17 gae_duplicate tensor(0.0571, dtype=torch.float64) tensor(-5.8592, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4778, dtype=torch.float64) delta_t tensor(0.3458, dtype=torch.float64)
16 gae_duplicate tensor(-0.7081, dtype=torch.float64) tensor(-4.7032, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6169, dtype=torch.float64) delta_t tensor(0.4048, dtype=torch.float64)
15 gae_duplicate tensor(0.1125, dtype=torch.float64) tensor(-5.4739, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4941, dtype=torch.float64) delta_t tensor(0.3014, dtype=torch.float64)
14 gae_duplicate tensor(-0.3305, dtype=torch.float64) tensor(-4.2863, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7298, dtype=torch.float64) delta_t tensor(0.5772, dtype=torch.float64)
13 gae_duplicate tensor(0.3710, dtype=torch.float64) tensor(-7.6701, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6463, dtype=torch.float64) delta_t tensor(0.5425, dtype=torch.float64)
12 gae_duplicate tensor(0.4095, dtype=torch.float64) tensor(-7.6377, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5571, dtype=torch.float64) delta_t tensor(0.3969, dtype=torch.float64)
11 gae_duplicate tensor(0.1111, dtype=torch.float64) tensor(-5.3894, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3014, dtype=torch.float64) delta_t tensor(-0.3678, dtype=torch.float64)
10 gae_duplicate tensor(-1.9641, dtype=torch.float64) tensor(4.8765, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0739, dtype=torch.float64) delta_t tensor(-0.1205, dtype=torch.float64)
9 gae_duplicate tensor(-1.4772, dtype=torch.float64) tensor(1.4963, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3208, dtype=torch.float64) delta_t tensor(-0.3363, dtype=torch.float64)
8 gae_duplicate tensor(-1.6668, dtype=torch.float64) tensor(4.9592, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5503, dtype=torch.float64) delta_t tensor(-0.6275, dtype=torch.float64)
7 gae_duplicate tensor(-1.8934, dtype=torch.float64) tensor(7.9875, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2546, dtype=torch.float64) delta_t tensor(-1.3383, dtype=torch.float64)
6 gae_duplicate tensor(-2.0419, dtype=torch.float64) tensor(17.0241, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6704, dtype=torch.float64) delta_t tensor(-0.7430, dtype=torch.float64)
5 gae_duplicate tensor(-2.1620, dtype=torch.float64) tensor(10.6570, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9905, dtype=torch.float64) delta_t tensor(-1.9910, dtype=torch.float64)
4 gae_duplicate tensor(-7.6040, dtype=torch.float64) tensor(28.0189, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1593, dtype=torch.float64) delta_t tensor(-0.1381, dtype=torch.float64)
3 gae_duplicate tensor(-1.2035, dtype=torch.float64) tensor(4.8991, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9315, dtype=torch.float64) delta_t tensor(-0.8585, dtype=torch.float64)
2 gae_duplicate tensor(-1.3346, dtype=torch.float64) tensor(10.2887, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1372.308837890625
value loss:205.92593383789062
entropies:222.13482666015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.78642201423645 seconds
19 rew tensor(0.7877, dtype=torch.float64) delta_t tensor(0.6637, dtype=torch.float64)
19 gae_duplicate tensor(0.5425, dtype=torch.float64) tensor(-8.1784, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7732, dtype=torch.float64) delta_t tensor(0.6912, dtype=torch.float64)
18 gae_duplicate tensor(0.5381, dtype=torch.float64) tensor(-8.9746, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7819, dtype=torch.float64) delta_t tensor(0.6527, dtype=torch.float64)
17 gae_duplicate tensor(0.5975, dtype=torch.float64) tensor(-8.7033, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7751, dtype=torch.float64) delta_t tensor(0.5864, dtype=torch.float64)
16 gae_duplicate tensor(0.4590, dtype=torch.float64) tensor(-8.4332, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7105, dtype=torch.float64) delta_t tensor(0.5487, dtype=torch.float64)
15 gae_duplicate tensor(0.3493, dtype=torch.float64) tensor(-7.9532, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6281, dtype=torch.float64) delta_t tensor(0.4124, dtype=torch.float64)
14 gae_duplicate tensor(-0.1106, dtype=torch.float64) tensor(-5.7231, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4935, dtype=torch.float64) delta_t tensor(0.4038, dtype=torch.float64)
13 gae_duplicate tensor(0.0645, dtype=torch.float64) tensor(-5.3670, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4146, dtype=torch.float64) delta_t tensor(0.2688, dtype=torch.float64)
12 gae_duplicate tensor(-0.6013, dtype=torch.float64) tensor(-4.2682, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2892, dtype=torch.float64) delta_t tensor(0.2284, dtype=torch.float64)
11 gae_duplicate tensor(-0.3581, dtype=torch.float64) tensor(-4.0395, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1049, dtype=torch.float64) delta_t tensor(0.0046, dtype=torch.float64)
10 gae_duplicate tensor(-1.3410, dtype=torch.float64) tensor(-0.1897, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0119, dtype=torch.float64) delta_t tensor(-0.0164, dtype=torch.float64)
9 gae_duplicate tensor(-1.4106, dtype=torch.float64) tensor(0.8257, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1179, dtype=torch.float64) delta_t tensor(-0.1509, dtype=torch.float64)
8 gae_duplicate tensor(-1.7486, dtype=torch.float64) tensor(2.3754, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2800, dtype=torch.float64) delta_t tensor(-0.3572, dtype=torch.float64)
7 gae_duplicate tensor(-1.1344, dtype=torch.float64) tensor(5.2267, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3243, dtype=torch.float64) delta_t tensor(-0.4100, dtype=torch.float64)
6 gae_duplicate tensor(-2.2409, dtype=torch.float64) tensor(5.1002, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0939, dtype=torch.float64) delta_t tensor(-1.1271, dtype=torch.float64)
5 gae_duplicate tensor(-1.9082, dtype=torch.float64) tensor(14.0950, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5403, dtype=torch.float64) delta_t tensor(-1.5846, dtype=torch.float64)
4 gae_duplicate tensor(-4.8164, dtype=torch.float64) tensor(21.2930, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1418, dtype=torch.float64) delta_t tensor(-0.1847, dtype=torch.float64)
3 gae_duplicate tensor(-1.2909, dtype=torch.float64) tensor(4.3194, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8292, dtype=torch.float64) delta_t tensor(-0.8070, dtype=torch.float64)
2 gae_duplicate tensor(-1.2217, dtype=torch.float64) tensor(10.0169, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-91.12063598632812
value loss:133.6723175048828
entropies:221.82180786132812
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.5765461921691895 seconds
19 rew tensor(0.5115, dtype=torch.float64) delta_t tensor(0.3368, dtype=torch.float64)
19 gae_duplicate tensor(-0.9338, dtype=torch.float64) tensor(-4.3800, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7776, dtype=torch.float64) delta_t tensor(0.6268, dtype=torch.float64)
18 gae_duplicate tensor(0.3787, dtype=torch.float64) tensor(-7.9192, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7621, dtype=torch.float64) delta_t tensor(0.6145, dtype=torch.float64)
17 gae_duplicate tensor(0.2996, dtype=torch.float64) tensor(-8.0114, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7465, dtype=torch.float64) delta_t tensor(0.6396, dtype=torch.float64)
16 gae_duplicate tensor(0.4542, dtype=torch.float64) tensor(-8.5817, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6901, dtype=torch.float64) delta_t tensor(0.5033, dtype=torch.float64)
15 gae_duplicate tensor(0.1174, dtype=torch.float64) tensor(-7.1724, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6089, dtype=torch.float64) delta_t tensor(0.4399, dtype=torch.float64)
14 gae_duplicate tensor(-0.3120, dtype=torch.float64) tensor(-6.0594, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7356, dtype=torch.float64) delta_t tensor(0.5017, dtype=torch.float64)
13 gae_duplicate tensor(0.3081, dtype=torch.float64) tensor(-6.9791, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2532, dtype=torch.float64) delta_t tensor(0.0463, dtype=torch.float64)
12 gae_duplicate tensor(-2.3205, dtype=torch.float64) tensor(-0.6904, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3776, dtype=torch.float64) delta_t tensor(0.2338, dtype=torch.float64)
11 gae_duplicate tensor(-1.6494, dtype=torch.float64) tensor(-1.9780, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1997, dtype=torch.float64) delta_t tensor(-0.2582, dtype=torch.float64)
10 gae_duplicate tensor(-3.0604, dtype=torch.float64) tensor(2.1061, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2813, dtype=torch.float64) delta_t tensor(-0.4270, dtype=torch.float64)
9 gae_duplicate tensor(-1.6471, dtype=torch.float64) tensor(5.7399, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.4685, dtype=torch.float64) delta_t tensor(-1.5680, dtype=torch.float64)
8 gae_duplicate tensor(-5.5156, dtype=torch.float64) tensor(21.7231, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3082, dtype=torch.float64) delta_t tensor(-0.3634, dtype=torch.float64)
7 gae_duplicate tensor(-1.1798, dtype=torch.float64) tensor(6.8409, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8219, dtype=torch.float64) delta_t tensor(-0.8829, dtype=torch.float64)
6 gae_duplicate tensor(-2.1063, dtype=torch.float64) tensor(13.0645, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7296, dtype=torch.float64) delta_t tensor(-0.7923, dtype=torch.float64)
5 gae_duplicate tensor(-2.3955, dtype=torch.float64) tensor(10.7143, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1367, dtype=torch.float64) delta_t tensor(-2.1372, dtype=torch.float64)
4 gae_duplicate tensor(-7.9340, dtype=torch.float64) tensor(29.8473, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3867, dtype=torch.float64) delta_t tensor(-0.3862, dtype=torch.float64)
3 gae_duplicate tensor(-1.4279, dtype=torch.float64) tensor(8.2593, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6153, dtype=torch.float64) delta_t tensor(-0.6675, dtype=torch.float64)
2 gae_duplicate tensor(-1.7907, dtype=torch.float64) tensor(8.7297, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2029.005859375
value loss:277.6308898925781
entropies:221.5240478515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8746349811553955 seconds
19 rew tensor(0.7034, dtype=torch.float64) delta_t tensor(0.4623, dtype=torch.float64)
19 gae_duplicate tensor(0.0927, dtype=torch.float64) tensor(-5.7491, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6277, dtype=torch.float64) delta_t tensor(0.4541, dtype=torch.float64)
18 gae_duplicate tensor(-0.1453, dtype=torch.float64) tensor(-5.7641, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4823, dtype=torch.float64) delta_t tensor(0.2984, dtype=torch.float64)
17 gae_duplicate tensor(-0.8914, dtype=torch.float64) tensor(-4.1953, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6632, dtype=torch.float64) delta_t tensor(0.5231, dtype=torch.float64)
16 gae_duplicate tensor(-0.0233, dtype=torch.float64) tensor(-7.1956, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5612, dtype=torch.float64) delta_t tensor(0.4403, dtype=torch.float64)
15 gae_duplicate tensor(-0.6718, dtype=torch.float64) tensor(-5.9525, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7832, dtype=torch.float64) delta_t tensor(0.6733, dtype=torch.float64)
14 gae_duplicate tensor(0.5907, dtype=torch.float64) tensor(-8.4759, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7689, dtype=torch.float64) delta_t tensor(0.6745, dtype=torch.float64)
13 gae_duplicate tensor(0.5277, dtype=torch.float64) tensor(-9.3828, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5866, dtype=torch.float64) delta_t tensor(0.4971, dtype=torch.float64)
12 gae_duplicate tensor(0.1987, dtype=torch.float64) tensor(-6.7856, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5746, dtype=torch.float64) delta_t tensor(0.5147, dtype=torch.float64)
11 gae_duplicate tensor(0.1488, dtype=torch.float64) tensor(-6.9943, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4875, dtype=torch.float64) delta_t tensor(0.3497, dtype=torch.float64)
10 gae_duplicate tensor(0.2652, dtype=torch.float64) tensor(-4.6415, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2768, dtype=torch.float64) delta_t tensor(-0.3867, dtype=torch.float64)
9 gae_duplicate tensor(-1.5315, dtype=torch.float64) tensor(4.6723, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4162, dtype=torch.float64) delta_t tensor(-0.5070, dtype=torch.float64)
8 gae_duplicate tensor(-1.6526, dtype=torch.float64) tensor(6.1716, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6771, dtype=torch.float64) delta_t tensor(-0.7706, dtype=torch.float64)
7 gae_duplicate tensor(-2.4969, dtype=torch.float64) tensor(9.2446, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0718, dtype=torch.float64) delta_t tensor(-1.1864, dtype=torch.float64)
6 gae_duplicate tensor(-2.1620, dtype=torch.float64) tensor(16.1552, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6616, dtype=torch.float64) delta_t tensor(-1.7283, dtype=torch.float64)
5 gae_duplicate tensor(-2.7804, dtype=torch.float64) tensor(24.0640, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1822, dtype=torch.float64) delta_t tensor(-3.2845, dtype=torch.float64)
4 gae_duplicate tensor(-7.7537, dtype=torch.float64) tensor(46.5271, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5406, dtype=torch.float64) delta_t tensor(-0.5207, dtype=torch.float64)
3 gae_duplicate tensor(-1.1800, dtype=torch.float64) tensor(10.1552, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3421, dtype=torch.float64) delta_t tensor(-0.3722, dtype=torch.float64)
2 gae_duplicate tensor(-1.2750, dtype=torch.float64) tensor(5.7549, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2113.637939453125
value loss:345.8392333984375
entropies:220.82957458496094
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2480.7402)
ToM Target loss= tensor(1800.6023)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.2380690574646 seconds
19 rew tensor(0.7825, dtype=torch.float64) delta_t tensor(0.5707, dtype=torch.float64)
19 gae_duplicate tensor(0.3208, dtype=torch.float64) tensor(-7.0304, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7833, dtype=torch.float64) delta_t tensor(0.6062, dtype=torch.float64)
18 gae_duplicate tensor(0.5781, dtype=torch.float64) tensor(-8.7790, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7842, dtype=torch.float64) delta_t tensor(0.6189, dtype=torch.float64)
17 gae_duplicate tensor(0.6072, dtype=torch.float64) tensor(-7.9421, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7214, dtype=torch.float64) delta_t tensor(0.5494, dtype=torch.float64)
16 gae_duplicate tensor(0.2284, dtype=torch.float64) tensor(-6.8506, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6114, dtype=torch.float64) delta_t tensor(0.4524, dtype=torch.float64)
15 gae_duplicate tensor(-0.2169, dtype=torch.float64) tensor(-7.4546, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6751, dtype=torch.float64) delta_t tensor(0.5368, dtype=torch.float64)
14 gae_duplicate tensor(0.1601, dtype=torch.float64) tensor(-6.9685, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6608, dtype=torch.float64) delta_t tensor(0.5229, dtype=torch.float64)
13 gae_duplicate tensor(0.1189, dtype=torch.float64) tensor(-6.8058, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4750, dtype=torch.float64) delta_t tensor(0.3793, dtype=torch.float64)
12 gae_duplicate tensor(-0.1556, dtype=torch.float64) tensor(-5.2779, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3477, dtype=torch.float64) delta_t tensor(0.2349, dtype=torch.float64)
11 gae_duplicate tensor(-0.3348, dtype=torch.float64) tensor(-3.0800, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3050, dtype=torch.float64) delta_t tensor(0.1964, dtype=torch.float64)
10 gae_duplicate tensor(-0.2367, dtype=torch.float64) tensor(-2.6564, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7065, dtype=torch.float64) delta_t tensor(-0.6448, dtype=torch.float64)
9 gae_duplicate tensor(-3.7357, dtype=torch.float64) tensor(6.7594, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1273, dtype=torch.float64) delta_t tensor(-0.1971, dtype=torch.float64)
8 gae_duplicate tensor(-1.2191, dtype=torch.float64) tensor(2.9428, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0031, dtype=torch.float64) delta_t tensor(-0.1023, dtype=torch.float64)
7 gae_duplicate tensor(-0.5944, dtype=torch.float64) tensor(1.4087, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7051, dtype=torch.float64) delta_t tensor(-0.7737, dtype=torch.float64)
6 gae_duplicate tensor(-1.4682, dtype=torch.float64) tensor(9.6704, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4835, dtype=torch.float64) delta_t tensor(-0.4933, dtype=torch.float64)
5 gae_duplicate tensor(-1.7469, dtype=torch.float64) tensor(6.9254, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9981, dtype=torch.float64) delta_t tensor(-0.9555, dtype=torch.float64)
4 gae_duplicate tensor(-1.2756, dtype=torch.float64) tensor(12.3022, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9528, dtype=torch.float64) delta_t tensor(-0.9752, dtype=torch.float64)
3 gae_duplicate tensor(-1.7908, dtype=torch.float64) tensor(12.6195, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3972, dtype=torch.float64) delta_t tensor(-0.4916, dtype=torch.float64)
2 gae_duplicate tensor(-0.9003, dtype=torch.float64) tensor(6.8428, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:81.82247161865234
value loss:103.58729553222656
entropies:220.23971557617188
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.161730051040649 seconds
19 rew tensor(0.7740, dtype=torch.float64) delta_t tensor(0.4893, dtype=torch.float64)
19 gae_duplicate tensor(0.1299, dtype=torch.float64) tensor(-6.0878, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7748, dtype=torch.float64) delta_t tensor(0.5369, dtype=torch.float64)
18 gae_duplicate tensor(0.2006, dtype=torch.float64) tensor(-7.5047, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7680, dtype=torch.float64) delta_t tensor(0.5637, dtype=torch.float64)
17 gae_duplicate tensor(0.3775, dtype=torch.float64) tensor(-7.4339, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7372, dtype=torch.float64) delta_t tensor(0.5424, dtype=torch.float64)
16 gae_duplicate tensor(0.2790, dtype=torch.float64) tensor(-6.9644, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7151, dtype=torch.float64) delta_t tensor(0.5137, dtype=torch.float64)
15 gae_duplicate tensor(0.0138, dtype=torch.float64) tensor(-6.6667, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6297, dtype=torch.float64) delta_t tensor(0.4145, dtype=torch.float64)
14 gae_duplicate tensor(-0.5202, dtype=torch.float64) tensor(-5.5343, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6737, dtype=torch.float64) delta_t tensor(0.4407, dtype=torch.float64)
13 gae_duplicate tensor(0.2167, dtype=torch.float64) tensor(-5.6669, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7003, dtype=torch.float64) delta_t tensor(0.5289, dtype=torch.float64)
12 gae_duplicate tensor(0.2911, dtype=torch.float64) tensor(-6.6776, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6665, dtype=torch.float64) delta_t tensor(0.4905, dtype=torch.float64)
11 gae_duplicate tensor(0.1925, dtype=torch.float64) tensor(-6.3301, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4466, dtype=torch.float64) delta_t tensor(0.2760, dtype=torch.float64)
10 gae_duplicate tensor(0.0672, dtype=torch.float64) tensor(-3.6982, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0416, dtype=torch.float64) delta_t tensor(-0.1409, dtype=torch.float64)
9 gae_duplicate tensor(-0.6712, dtype=torch.float64) tensor(1.0545, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1659, dtype=torch.float64) delta_t tensor(-1.3154, dtype=torch.float64)
8 gae_duplicate tensor(-3.4649, dtype=torch.float64) tensor(16.6153, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6402, dtype=torch.float64) delta_t tensor(-0.6712, dtype=torch.float64)
7 gae_duplicate tensor(-2.1387, dtype=torch.float64) tensor(10.1317, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1681, dtype=torch.float64) delta_t tensor(-1.2566, dtype=torch.float64)
6 gae_duplicate tensor(-4.5388, dtype=torch.float64) tensor(17.3043, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6396, dtype=torch.float64) delta_t tensor(-1.6818, dtype=torch.float64)
5 gae_duplicate tensor(-2.3717, dtype=torch.float64) tensor(24.7276, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5203, dtype=torch.float64) delta_t tensor(-1.5870, dtype=torch.float64)
4 gae_duplicate tensor(-5.1520, dtype=torch.float64) tensor(19.1136, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7637, dtype=torch.float64) delta_t tensor(-0.7191, dtype=torch.float64)
3 gae_duplicate tensor(-1.3770, dtype=torch.float64) tensor(12.5499, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6721, dtype=torch.float64) delta_t tensor(-0.7344, dtype=torch.float64)
2 gae_duplicate tensor(-1.4204, dtype=torch.float64) tensor(10.7813, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1829.2523193359375
value loss:233.8612823486328
entropies:219.77809143066406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.854274034500122 seconds
19 rew tensor(0.7567, dtype=torch.float64) delta_t tensor(0.4798, dtype=torch.float64)
19 gae_duplicate tensor(0.2423, dtype=torch.float64) tensor(-5.6536, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7158, dtype=torch.float64) delta_t tensor(0.4399, dtype=torch.float64)
18 gae_duplicate tensor(0.2442, dtype=torch.float64) tensor(-6.4200, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6507, dtype=torch.float64) delta_t tensor(0.4779, dtype=torch.float64)
17 gae_duplicate tensor(0.1527, dtype=torch.float64) tensor(-6.2188, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5436, dtype=torch.float64) delta_t tensor(0.3658, dtype=torch.float64)
16 gae_duplicate tensor(-0.1731, dtype=torch.float64) tensor(-5.0295, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3135, dtype=torch.float64) delta_t tensor(0.1370, dtype=torch.float64)
15 gae_duplicate tensor(-0.8491, dtype=torch.float64) tensor(-1.7886, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6640, dtype=torch.float64) delta_t tensor(0.5357, dtype=torch.float64)
14 gae_duplicate tensor(0.1094, dtype=torch.float64) tensor(-7.0780, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7442, dtype=torch.float64) delta_t tensor(0.6138, dtype=torch.float64)
13 gae_duplicate tensor(0.4039, dtype=torch.float64) tensor(-7.7296, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6789, dtype=torch.float64) delta_t tensor(0.5417, dtype=torch.float64)
12 gae_duplicate tensor(0.1669, dtype=torch.float64) tensor(-7.1617, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6799, dtype=torch.float64) delta_t tensor(0.5139, dtype=torch.float64)
11 gae_duplicate tensor(0.3564, dtype=torch.float64) tensor(-7.3819, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1744, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
10 gae_duplicate tensor(-1.6252, dtype=torch.float64) tensor(-0.7545, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3360, dtype=torch.float64) delta_t tensor(-0.4818, dtype=torch.float64)
9 gae_duplicate tensor(-2.6263, dtype=torch.float64) tensor(7.1474, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5901, dtype=torch.float64) delta_t tensor(-0.7086, dtype=torch.float64)
8 gae_duplicate tensor(-1.9930, dtype=torch.float64) tensor(8.0993, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7928, dtype=torch.float64) delta_t tensor(-0.9094, dtype=torch.float64)
7 gae_duplicate tensor(-1.9027, dtype=torch.float64) tensor(10.5289, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3423, dtype=torch.float64) delta_t tensor(-1.4399, dtype=torch.float64)
6 gae_duplicate tensor(-2.9423, dtype=torch.float64) tensor(18.7087, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5511, dtype=torch.float64) delta_t tensor(-0.5991, dtype=torch.float64)
5 gae_duplicate tensor(-2.0573, dtype=torch.float64) tensor(11.0202, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6196, dtype=torch.float64) delta_t tensor(-1.6431, dtype=torch.float64)
4 gae_duplicate tensor(-6.9973, dtype=torch.float64) tensor(24.9336, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2285, dtype=torch.float64) delta_t tensor(-0.2511, dtype=torch.float64)
3 gae_duplicate tensor(-0.8956, dtype=torch.float64) tensor(5.2380, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3926, dtype=torch.float64) delta_t tensor(-0.4194, dtype=torch.float64)
2 gae_duplicate tensor(-0.8008, dtype=torch.float64) tensor(6.1624, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1357.8623046875
value loss:202.0669708251953
entropies:219.2545166015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.797826051712036 seconds
19 rew tensor(0.7366, dtype=torch.float64) delta_t tensor(0.4931, dtype=torch.float64)
19 gae_duplicate tensor(0.1485, dtype=torch.float64) tensor(-5.6933, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7208, dtype=torch.float64) delta_t tensor(0.4400, dtype=torch.float64)
18 gae_duplicate tensor(0.1771, dtype=torch.float64) tensor(-5.9984, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6737, dtype=torch.float64) delta_t tensor(0.4164, dtype=torch.float64)
17 gae_duplicate tensor(0.1130, dtype=torch.float64) tensor(-5.7363, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5380, dtype=torch.float64) delta_t tensor(0.3755, dtype=torch.float64)
16 gae_duplicate tensor(-0.0217, dtype=torch.float64) tensor(-5.9220, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3310, dtype=torch.float64) delta_t tensor(0.0742, dtype=torch.float64)
15 gae_duplicate tensor(-0.7369, dtype=torch.float64) tensor(-1.6010, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6804, dtype=torch.float64) delta_t tensor(0.4450, dtype=torch.float64)
14 gae_duplicate tensor(-0.0551, dtype=torch.float64) tensor(-5.4032, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7217, dtype=torch.float64) delta_t tensor(0.5147, dtype=torch.float64)
13 gae_duplicate tensor(0.1872, dtype=torch.float64) tensor(-5.9332, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7316, dtype=torch.float64) delta_t tensor(0.5842, dtype=torch.float64)
12 gae_duplicate tensor(0.5454, dtype=torch.float64) tensor(-7.6673, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6602, dtype=torch.float64) delta_t tensor(0.5687, dtype=torch.float64)
11 gae_duplicate tensor(0.2724, dtype=torch.float64) tensor(-8.3424, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4546, dtype=torch.float64) delta_t tensor(0.3176, dtype=torch.float64)
10 gae_duplicate tensor(0.1822, dtype=torch.float64) tensor(-4.9497, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4831, dtype=torch.float64) delta_t tensor(-0.5911, dtype=torch.float64)
9 gae_duplicate tensor(-1.5708, dtype=torch.float64) tensor(6.9738, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2903, dtype=torch.float64) delta_t tensor(-0.4391, dtype=torch.float64)
8 gae_duplicate tensor(-1.8779, dtype=torch.float64) tensor(6.7431, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4888, dtype=torch.float64) delta_t tensor(-0.6013, dtype=torch.float64)
7 gae_duplicate tensor(-0.8939, dtype=torch.float64) tensor(7.4679, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.6079, dtype=torch.float64) delta_t tensor(-1.6699, dtype=torch.float64)
6 gae_duplicate tensor(-3.8020, dtype=torch.float64) tensor(19.9030, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3492, dtype=torch.float64) delta_t tensor(-1.3636, dtype=torch.float64)
5 gae_duplicate tensor(-2.2154, dtype=torch.float64) tensor(19.0084, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1159, dtype=torch.float64) delta_t tensor(-3.1368, dtype=torch.float64)
4 gae_duplicate tensor(-8.9574, dtype=torch.float64) tensor(36.5143, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6755, dtype=torch.float64) delta_t tensor(-0.5971, dtype=torch.float64)
3 gae_duplicate tensor(-1.2543, dtype=torch.float64) tensor(10.9568, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3843, dtype=torch.float64) delta_t tensor(-0.4450, dtype=torch.float64)
2 gae_duplicate tensor(-1.2678, dtype=torch.float64) tensor(6.2415, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2075.55126953125
value loss:337.31500244140625
entropies:218.46078491210938
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.753629922866821 seconds
19 rew tensor(0.7706, dtype=torch.float64) delta_t tensor(0.5536, dtype=torch.float64)
19 gae_duplicate tensor(0.5010, dtype=torch.float64) tensor(-6.4184, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7633, dtype=torch.float64) delta_t tensor(0.5111, dtype=torch.float64)
18 gae_duplicate tensor(0.1779, dtype=torch.float64) tensor(-6.3120, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7488, dtype=torch.float64) delta_t tensor(0.5590, dtype=torch.float64)
17 gae_duplicate tensor(0.3604, dtype=torch.float64) tensor(-7.8056, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7105, dtype=torch.float64) delta_t tensor(0.5385, dtype=torch.float64)
16 gae_duplicate tensor(0.2615, dtype=torch.float64) tensor(-6.7137, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6640, dtype=torch.float64) delta_t tensor(0.5283, dtype=torch.float64)
15 gae_duplicate tensor(0.1109, dtype=torch.float64) tensor(-7.6805, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5719, dtype=torch.float64) delta_t tensor(0.4221, dtype=torch.float64)
14 gae_duplicate tensor(-0.2150, dtype=torch.float64) tensor(-5.9854, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6880, dtype=torch.float64) delta_t tensor(0.5551, dtype=torch.float64)
13 gae_duplicate tensor(0.1131, dtype=torch.float64) tensor(-6.7962, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7171, dtype=torch.float64) delta_t tensor(0.6252, dtype=torch.float64)
12 gae_duplicate tensor(0.4175, dtype=torch.float64) tensor(-7.7554, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5407, dtype=torch.float64) delta_t tensor(0.3703, dtype=torch.float64)
11 gae_duplicate tensor(0.2659, dtype=torch.float64) tensor(-5.4268, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3923, dtype=torch.float64) delta_t tensor(0.1999, dtype=torch.float64)
10 gae_duplicate tensor(-0.1215, dtype=torch.float64) tensor(-3.2153, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1862, dtype=torch.float64) delta_t tensor(-0.2361, dtype=torch.float64)
9 gae_duplicate tensor(-1.5095, dtype=torch.float64) tensor(3.1057, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2815, dtype=torch.float64) delta_t tensor(-0.4083, dtype=torch.float64)
8 gae_duplicate tensor(-0.9502, dtype=torch.float64) tensor(6.3959, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2901, dtype=torch.float64) delta_t tensor(-0.3217, dtype=torch.float64)
7 gae_duplicate tensor(-1.0000, dtype=torch.float64) tensor(4.4897, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9974, dtype=torch.float64) delta_t tensor(-1.1125, dtype=torch.float64)
6 gae_duplicate tensor(-2.2506, dtype=torch.float64) tensor(14.1070, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3104, dtype=torch.float64) delta_t tensor(-1.3212, dtype=torch.float64)
5 gae_duplicate tensor(-2.8916, dtype=torch.float64) tensor(17.5643, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7508, dtype=torch.float64) delta_t tensor(-0.7294, dtype=torch.float64)
4 gae_duplicate tensor(-4.6334, dtype=torch.float64) tensor(8.9747, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5906, dtype=torch.float64) delta_t tensor(-0.6165, dtype=torch.float64)
3 gae_duplicate tensor(-1.3144, dtype=torch.float64) tensor(7.7401, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6339, dtype=torch.float64) delta_t tensor(-0.6317, dtype=torch.float64)
2 gae_duplicate tensor(-1.1533, dtype=torch.float64) tensor(8.9273, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-298.2397766113281
value loss:126.75858306884766
entropies:217.82388305664062
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2464.7598)
ToM Target loss= tensor(1798.8569)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.954965114593506 seconds
19 rew tensor(0.7820, dtype=torch.float64) delta_t tensor(0.5825, dtype=torch.float64)
19 gae_duplicate tensor(0.4648, dtype=torch.float64) tensor(-7.0131, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7828, dtype=torch.float64) delta_t tensor(0.5306, dtype=torch.float64)
18 gae_duplicate tensor(0.5128, dtype=torch.float64) tensor(-7.2966, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7836, dtype=torch.float64) delta_t tensor(0.5758, dtype=torch.float64)
17 gae_duplicate tensor(0.5832, dtype=torch.float64) tensor(-8.0656, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7760, dtype=torch.float64) delta_t tensor(0.5435, dtype=torch.float64)
16 gae_duplicate tensor(0.5383, dtype=torch.float64) tensor(-6.9939, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4815, dtype=torch.float64) delta_t tensor(0.3357, dtype=torch.float64)
15 gae_duplicate tensor(-0.2665, dtype=torch.float64) tensor(-5.1223, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6320, dtype=torch.float64) delta_t tensor(0.5035, dtype=torch.float64)
14 gae_duplicate tensor(0.3116, dtype=torch.float64) tensor(-6.5242, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4277, dtype=torch.float64) delta_t tensor(0.4326, dtype=torch.float64)
13 gae_duplicate tensor(0.1677, dtype=torch.float64) tensor(-5.4249, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2456, dtype=torch.float64) delta_t tensor(0.2653, dtype=torch.float64)
12 gae_duplicate tensor(-0.1975, dtype=torch.float64) tensor(-3.3910, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2041, dtype=torch.float64) delta_t tensor(-0.2120, dtype=torch.float64)
11 gae_duplicate tensor(-1.3891, dtype=torch.float64) tensor(2.8258, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1976, dtype=torch.float64) delta_t tensor(-0.3913, dtype=torch.float64)
10 gae_duplicate tensor(-0.9009, dtype=torch.float64) tensor(4.7267, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1888, dtype=torch.float64) delta_t tensor(-0.2840, dtype=torch.float64)
9 gae_duplicate tensor(-0.6534, dtype=torch.float64) tensor(3.8877, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1151, dtype=torch.float64) delta_t tensor(0.1967, dtype=torch.float64)
8 gae_duplicate tensor(-0.1315, dtype=torch.float64) tensor(-1.6665, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1450, dtype=torch.float64) delta_t tensor(-0.1550, dtype=torch.float64)
7 gae_duplicate tensor(-0.7714, dtype=torch.float64) tensor(2.4663, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3525, dtype=torch.float64) delta_t tensor(-0.3970, dtype=torch.float64)
6 gae_duplicate tensor(-1.4534, dtype=torch.float64) tensor(4.3794, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9079, dtype=torch.float64) delta_t tensor(-0.9855, dtype=torch.float64)
5 gae_duplicate tensor(-1.9559, dtype=torch.float64) tensor(12.7632, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1296, dtype=torch.float64) delta_t tensor(0.0888, dtype=torch.float64)
4 gae_duplicate tensor(-0.4434, dtype=torch.float64) tensor(-0.0186, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8898, dtype=torch.float64) delta_t tensor(-0.8023, dtype=torch.float64)
3 gae_duplicate tensor(-1.5517, dtype=torch.float64) tensor(10.7925, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4304, dtype=torch.float64) delta_t tensor(-0.5361, dtype=torch.float64)
2 gae_duplicate tensor(-1.1813, dtype=torch.float64) tensor(6.9737, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:58.12382125854492
value loss:69.11026000976562
entropies:217.32347106933594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.691564083099365 seconds
19 rew tensor(0.7517, dtype=torch.float64) delta_t tensor(0.5022, dtype=torch.float64)
19 gae_duplicate tensor(0.1965, dtype=torch.float64) tensor(-6.0604, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7195, dtype=torch.float64) delta_t tensor(0.4743, dtype=torch.float64)
18 gae_duplicate tensor(0.2187, dtype=torch.float64) tensor(-7.2460, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6625, dtype=torch.float64) delta_t tensor(0.4715, dtype=torch.float64)
17 gae_duplicate tensor(0.1541, dtype=torch.float64) tensor(-5.9435, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5141, dtype=torch.float64) delta_t tensor(0.2758, dtype=torch.float64)
16 gae_duplicate tensor(-0.1252, dtype=torch.float64) tensor(-3.9043, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2836, dtype=torch.float64) delta_t tensor(0.1074, dtype=torch.float64)
15 gae_duplicate tensor(-0.8399, dtype=torch.float64) tensor(-2.1559, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7613, dtype=torch.float64) delta_t tensor(0.6095, dtype=torch.float64)
14 gae_duplicate tensor(0.4946, dtype=torch.float64) tensor(-6.9913, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7366, dtype=torch.float64) delta_t tensor(0.6440, dtype=torch.float64)
13 gae_duplicate tensor(0.5922, dtype=torch.float64) tensor(-8.5257, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5146, dtype=torch.float64) delta_t tensor(0.4836, dtype=torch.float64)
12 gae_duplicate tensor(0.0951, dtype=torch.float64) tensor(-6.3506, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0989, dtype=torch.float64) delta_t tensor(0.0063, dtype=torch.float64)
11 gae_duplicate tensor(-2.1307, dtype=torch.float64) tensor(-0.8608, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2166, dtype=torch.float64) delta_t tensor(0.1237, dtype=torch.float64)
10 gae_duplicate tensor(-0.7439, dtype=torch.float64) tensor(-1.7504, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4733, dtype=torch.float64) delta_t tensor(-0.5545, dtype=torch.float64)
9 gae_duplicate tensor(-1.6683, dtype=torch.float64) tensor(7.1205, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0695, dtype=torch.float64) delta_t tensor(-0.1060, dtype=torch.float64)
8 gae_duplicate tensor(-0.9487, dtype=torch.float64) tensor(1.6834, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5084, dtype=torch.float64) delta_t tensor(-0.6021, dtype=torch.float64)
7 gae_duplicate tensor(-1.9425, dtype=torch.float64) tensor(6.5978, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3671, dtype=torch.float64) delta_t tensor(-1.3804, dtype=torch.float64)
6 gae_duplicate tensor(-2.1222, dtype=torch.float64) tensor(18.0204, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4189, dtype=torch.float64) delta_t tensor(-1.4449, dtype=torch.float64)
5 gae_duplicate tensor(-3.1957, dtype=torch.float64) tensor(20.1342, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6358, dtype=torch.float64) delta_t tensor(-0.6246, dtype=torch.float64)
4 gae_duplicate tensor(-3.9281, dtype=torch.float64) tensor(8.3500, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7313, dtype=torch.float64) delta_t tensor(-0.7338, dtype=torch.float64)
3 gae_duplicate tensor(-1.7051, dtype=torch.float64) tensor(11.1798, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1899, dtype=torch.float64) delta_t tensor(-0.3010, dtype=torch.float64)
2 gae_duplicate tensor(-0.5924, dtype=torch.float64) tensor(4.5609, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1041.82373046875
value loss:146.31533813476562
entropies:216.25927734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.864715814590454 seconds
19 rew tensor(0.7853, dtype=torch.float64) delta_t tensor(0.5260, dtype=torch.float64)
19 gae_duplicate tensor(0.3216, dtype=torch.float64) tensor(-6.1617, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7774, dtype=torch.float64) delta_t tensor(0.5824, dtype=torch.float64)
18 gae_duplicate tensor(0.4520, dtype=torch.float64) tensor(-9.0020, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7781, dtype=torch.float64) delta_t tensor(0.5864, dtype=torch.float64)
17 gae_duplicate tensor(0.5150, dtype=torch.float64) tensor(-7.1083, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7529, dtype=torch.float64) delta_t tensor(0.5652, dtype=torch.float64)
16 gae_duplicate tensor(0.4058, dtype=torch.float64) tensor(-8.0115, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7363, dtype=torch.float64) delta_t tensor(0.5176, dtype=torch.float64)
15 gae_duplicate tensor(0.1296, dtype=torch.float64) tensor(-7.7301, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6765, dtype=torch.float64) delta_t tensor(0.4549, dtype=torch.float64)
14 gae_duplicate tensor(-0.3710, dtype=torch.float64) tensor(-6.0121, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7894, dtype=torch.float64) delta_t tensor(0.5883, dtype=torch.float64)
13 gae_duplicate tensor(0.2652, dtype=torch.float64) tensor(-8.2770, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6674, dtype=torch.float64) delta_t tensor(0.5035, dtype=torch.float64)
12 gae_duplicate tensor(0.2050, dtype=torch.float64) tensor(-7.1702, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4584, dtype=torch.float64) delta_t tensor(0.2663, dtype=torch.float64)
11 gae_duplicate tensor(-0.0060, dtype=torch.float64) tensor(-4.0442, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3002, dtype=torch.float64) delta_t tensor(0.2446, dtype=torch.float64)
10 gae_duplicate tensor(0.0354, dtype=torch.float64) tensor(-3.2661, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2645, dtype=torch.float64) delta_t tensor(-0.3354, dtype=torch.float64)
9 gae_duplicate tensor(-1.7281, dtype=torch.float64) tensor(3.5362, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6527, dtype=torch.float64) delta_t tensor(-0.6828, dtype=torch.float64)
8 gae_duplicate tensor(-4.0924, dtype=torch.float64) tensor(6.8477, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3995, dtype=torch.float64) delta_t tensor(-0.4812, dtype=torch.float64)
7 gae_duplicate tensor(-1.5075, dtype=torch.float64) tensor(5.5866, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8592, dtype=torch.float64) delta_t tensor(-0.8957, dtype=torch.float64)
6 gae_duplicate tensor(-2.6498, dtype=torch.float64) tensor(10.6988, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1098, dtype=torch.float64) delta_t tensor(-1.0595, dtype=torch.float64)
5 gae_duplicate tensor(-1.9379, dtype=torch.float64) tensor(13.3669, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1308, dtype=torch.float64) delta_t tensor(-1.1233, dtype=torch.float64)
4 gae_duplicate tensor(-5.2720, dtype=torch.float64) tensor(13.7617, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6347, dtype=torch.float64) delta_t tensor(-0.5637, dtype=torch.float64)
3 gae_duplicate tensor(-1.0515, dtype=torch.float64) tensor(6.8281, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4620, dtype=torch.float64) delta_t tensor(-0.5422, dtype=torch.float64)
2 gae_duplicate tensor(-1.4611, dtype=torch.float64) tensor(6.9960, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-68.87249755859375
value loss:152.4842987060547
entropies:214.86825561523438
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.782769203186035 seconds
19 rew tensor(0.7816, dtype=torch.float64) delta_t tensor(0.5603, dtype=torch.float64)
19 gae_duplicate tensor(0.2346, dtype=torch.float64) tensor(-6.7859, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7665, dtype=torch.float64) delta_t tensor(0.5529, dtype=torch.float64)
18 gae_duplicate tensor(0.2891, dtype=torch.float64) tensor(-7.6472, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7515, dtype=torch.float64) delta_t tensor(0.5015, dtype=torch.float64)
17 gae_duplicate tensor(0.2381, dtype=torch.float64) tensor(-6.8570, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7130, dtype=torch.float64) delta_t tensor(0.5299, dtype=torch.float64)
16 gae_duplicate tensor(0.3757, dtype=torch.float64) tensor(-8.0798, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6749, dtype=torch.float64) delta_t tensor(0.4222, dtype=torch.float64)
15 gae_duplicate tensor(0.1612, dtype=torch.float64) tensor(-5.7932, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5812, dtype=torch.float64) delta_t tensor(0.3330, dtype=torch.float64)
14 gae_duplicate tensor(-0.1625, dtype=torch.float64) tensor(-4.8306, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7044, dtype=torch.float64) delta_t tensor(0.4646, dtype=torch.float64)
13 gae_duplicate tensor(0.3102, dtype=torch.float64) tensor(-5.4183, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7164, dtype=torch.float64) delta_t tensor(0.4923, dtype=torch.float64)
12 gae_duplicate tensor(0.3010, dtype=torch.float64) tensor(-5.9056, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7103, dtype=torch.float64) delta_t tensor(0.4985, dtype=torch.float64)
11 gae_duplicate tensor(0.3951, dtype=torch.float64) tensor(-6.2906, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6292, dtype=torch.float64) delta_t tensor(0.4487, dtype=torch.float64)
10 gae_duplicate tensor(0.2566, dtype=torch.float64) tensor(-5.7637, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3797, dtype=torch.float64) delta_t tensor(-0.5205, dtype=torch.float64)
9 gae_duplicate tensor(-1.7352, dtype=torch.float64) tensor(5.1478, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3289, dtype=torch.float64) delta_t tensor(-0.3818, dtype=torch.float64)
8 gae_duplicate tensor(-1.8930, dtype=torch.float64) tensor(7.2045, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1215, dtype=torch.float64) delta_t tensor(-0.2642, dtype=torch.float64)
7 gae_duplicate tensor(-0.6986, dtype=torch.float64) tensor(4.1127, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4098, dtype=torch.float64) delta_t tensor(-1.5105, dtype=torch.float64)
6 gae_duplicate tensor(-4.4911, dtype=torch.float64) tensor(17.3337, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1360, dtype=torch.float64) delta_t tensor(-1.1521, dtype=torch.float64)
5 gae_duplicate tensor(-2.3049, dtype=torch.float64) tensor(15.6414, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4293, dtype=torch.float64) delta_t tensor(-2.3934, dtype=torch.float64)
4 gae_duplicate tensor(-8.2817, dtype=torch.float64) tensor(32.5318, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7870, dtype=torch.float64) delta_t tensor(-0.7871, dtype=torch.float64)
3 gae_duplicate tensor(-1.4560, dtype=torch.float64) tensor(11.4215, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2769, dtype=torch.float64) delta_t tensor(-0.2984, dtype=torch.float64)
2 gae_duplicate tensor(-1.0040, dtype=torch.float64) tensor(5.5544, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1319.166748046875
value loss:256.0184020996094
entropies:213.51406860351562
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.007401943206787 seconds
19 rew tensor(0.7662, dtype=torch.float64) delta_t tensor(0.4214, dtype=torch.float64)
19 gae_duplicate tensor(0.1443, dtype=torch.float64) tensor(-4.5564, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7585, dtype=torch.float64) delta_t tensor(0.4439, dtype=torch.float64)
18 gae_duplicate tensor(0.2818, dtype=torch.float64) tensor(-6.5878, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7256, dtype=torch.float64) delta_t tensor(0.4802, dtype=torch.float64)
17 gae_duplicate tensor(0.2300, dtype=torch.float64) tensor(-6.3404, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6592, dtype=torch.float64) delta_t tensor(0.4379, dtype=torch.float64)
16 gae_duplicate tensor(-0.0528, dtype=torch.float64) tensor(-5.0810, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5510, dtype=torch.float64) delta_t tensor(0.3950, dtype=torch.float64)
15 gae_duplicate tensor(-0.7565, dtype=torch.float64) tensor(-4.8539, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7859, dtype=torch.float64) delta_t tensor(0.5727, dtype=torch.float64)
14 gae_duplicate tensor(0.4264, dtype=torch.float64) tensor(-7.7828, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7866, dtype=torch.float64) delta_t tensor(0.6549, dtype=torch.float64)
13 gae_duplicate tensor(0.4009, dtype=torch.float64) tensor(-9.1484, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7789, dtype=torch.float64) delta_t tensor(0.6292, dtype=torch.float64)
12 gae_duplicate tensor(0.4016, dtype=torch.float64) tensor(-8.4219, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5912, dtype=torch.float64) delta_t tensor(0.5058, dtype=torch.float64)
11 gae_duplicate tensor(0.3770, dtype=torch.float64) tensor(-7.8177, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4650, dtype=torch.float64) delta_t tensor(0.3329, dtype=torch.float64)
10 gae_duplicate tensor(-0.0434, dtype=torch.float64) tensor(-4.5902, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3173, dtype=torch.float64) delta_t tensor(-0.4301, dtype=torch.float64)
9 gae_duplicate tensor(-1.6869, dtype=torch.float64) tensor(4.8260, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3143, dtype=torch.float64) delta_t tensor(-0.4401, dtype=torch.float64)
8 gae_duplicate tensor(-0.9434, dtype=torch.float64) tensor(5.0982, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9044, dtype=torch.float64) delta_t tensor(-1.0360, dtype=torch.float64)
7 gae_duplicate tensor(-3.1277, dtype=torch.float64) tensor(15.4106, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9667, dtype=torch.float64) delta_t tensor(-0.9707, dtype=torch.float64)
6 gae_duplicate tensor(-2.5450, dtype=torch.float64) tensor(10.5301, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7020, dtype=torch.float64) delta_t tensor(-0.7421, dtype=torch.float64)
5 gae_duplicate tensor(-1.9428, dtype=torch.float64) tensor(10.2746, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8793, dtype=torch.float64) delta_t tensor(-1.7675, dtype=torch.float64)
4 gae_duplicate tensor(-4.0416, dtype=torch.float64) tensor(25.1424, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5240, dtype=torch.float64) delta_t tensor(-0.4525, dtype=torch.float64)
3 gae_duplicate tensor(-1.3299, dtype=torch.float64) tensor(8.1151, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4733, dtype=torch.float64) delta_t tensor(-0.4719, dtype=torch.float64)
2 gae_duplicate tensor(-1.0625, dtype=torch.float64) tensor(5.2217, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-737.9505004882812
value loss:152.62791442871094
entropies:212.08615112304688
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2464.5759)
ToM Target loss= tensor(1798.5854)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.276336908340454 seconds
19 rew tensor(0.7686, dtype=torch.float64) delta_t tensor(0.5072, dtype=torch.float64)
19 gae_duplicate tensor(0.3732, dtype=torch.float64) tensor(-6.2791, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7526, dtype=torch.float64) delta_t tensor(0.5275, dtype=torch.float64)
18 gae_duplicate tensor(0.2089, dtype=torch.float64) tensor(-6.9862, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7282, dtype=torch.float64) delta_t tensor(0.5256, dtype=torch.float64)
17 gae_duplicate tensor(0.2319, dtype=torch.float64) tensor(-7.1000, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6704, dtype=torch.float64) delta_t tensor(0.3962, dtype=torch.float64)
16 gae_duplicate tensor(-0.0187, dtype=torch.float64) tensor(-6.1750, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5627, dtype=torch.float64) delta_t tensor(0.3541, dtype=torch.float64)
15 gae_duplicate tensor(-0.6885, dtype=torch.float64) tensor(-5.1357, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7881, dtype=torch.float64) delta_t tensor(0.5554, dtype=torch.float64)
14 gae_duplicate tensor(0.5187, dtype=torch.float64) tensor(-5.7619, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7580, dtype=torch.float64) delta_t tensor(0.6393, dtype=torch.float64)
13 gae_duplicate tensor(0.5116, dtype=torch.float64) tensor(-9.8413, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6753, dtype=torch.float64) delta_t tensor(0.6051, dtype=torch.float64)
12 gae_duplicate tensor(0.4789, dtype=torch.float64) tensor(-8.8322, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4582, dtype=torch.float64) delta_t tensor(0.4199, dtype=torch.float64)
11 gae_duplicate tensor(0.2092, dtype=torch.float64) tensor(-6.5812, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1811, dtype=torch.float64) delta_t tensor(0.0657, dtype=torch.float64)
10 gae_duplicate tensor(-0.6560, dtype=torch.float64) tensor(-0.9712, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1074, dtype=torch.float64) delta_t tensor(-1.1657, dtype=torch.float64)
9 gae_duplicate tensor(-3.0183, dtype=torch.float64) tensor(16.6748, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3821, dtype=torch.float64) delta_t tensor(-0.4319, dtype=torch.float64)
8 gae_duplicate tensor(-1.7626, dtype=torch.float64) tensor(6.0979, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6220, dtype=torch.float64) delta_t tensor(-0.5829, dtype=torch.float64)
7 gae_duplicate tensor(-1.9744, dtype=torch.float64) tensor(6.7227, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9190, dtype=torch.float64) delta_t tensor(-0.9476, dtype=torch.float64)
6 gae_duplicate tensor(-2.2399, dtype=torch.float64) tensor(9.7999, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1448, dtype=torch.float64) delta_t tensor(-1.1508, dtype=torch.float64)
5 gae_duplicate tensor(-1.9534, dtype=torch.float64) tensor(13.5847, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9853, dtype=torch.float64) delta_t tensor(-0.9678, dtype=torch.float64)
4 gae_duplicate tensor(-2.7542, dtype=torch.float64) tensor(13.0244, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3348, dtype=torch.float64) delta_t tensor(-0.2960, dtype=torch.float64)
3 gae_duplicate tensor(-1.0158, dtype=torch.float64) tensor(4.3297, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3070, dtype=torch.float64) delta_t tensor(-0.3784, dtype=torch.float64)
2 gae_duplicate tensor(-0.8598, dtype=torch.float64) tensor(5.5207, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-473.27459716796875
value loss:130.6425323486328
entropies:211.0876007080078
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.47446084022522 seconds
19 rew tensor(0.7783, dtype=torch.float64) delta_t tensor(0.3858, dtype=torch.float64)
19 gae_duplicate tensor(0.0698, dtype=torch.float64) tensor(-4.5810, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7636, dtype=torch.float64) delta_t tensor(0.4651, dtype=torch.float64)
18 gae_duplicate tensor(0.3387, dtype=torch.float64) tensor(-5.1657, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7411, dtype=torch.float64) delta_t tensor(0.4709, dtype=torch.float64)
17 gae_duplicate tensor(0.2651, dtype=torch.float64) tensor(-6.3385, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7033, dtype=torch.float64) delta_t tensor(0.4277, dtype=torch.float64)
16 gae_duplicate tensor(0.1066, dtype=torch.float64) tensor(-5.1150, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6192, dtype=torch.float64) delta_t tensor(0.3731, dtype=torch.float64)
15 gae_duplicate tensor(-0.3756, dtype=torch.float64) tensor(-4.7638, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7890, dtype=torch.float64) delta_t tensor(0.5854, dtype=torch.float64)
14 gae_duplicate tensor(0.5192, dtype=torch.float64) tensor(-4.8866, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7897, dtype=torch.float64) delta_t tensor(0.6004, dtype=torch.float64)
13 gae_duplicate tensor(0.5766, dtype=torch.float64) tensor(-7.8879, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7738, dtype=torch.float64) delta_t tensor(0.6383, dtype=torch.float64)
12 gae_duplicate tensor(0.5720, dtype=torch.float64) tensor(-9.4601, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7580, dtype=torch.float64) delta_t tensor(0.6266, dtype=torch.float64)
11 gae_duplicate tensor(0.5662, dtype=torch.float64) tensor(-6.9272, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5695, dtype=torch.float64) delta_t tensor(0.4769, dtype=torch.float64)
10 gae_duplicate tensor(0.2736, dtype=torch.float64) tensor(-5.7882, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2711, dtype=torch.float64) delta_t tensor(-0.3371, dtype=torch.float64)
9 gae_duplicate tensor(-1.8212, dtype=torch.float64) tensor(3.4533, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8788, dtype=torch.float64) delta_t tensor(-0.9582, dtype=torch.float64)
8 gae_duplicate tensor(-2.7359, dtype=torch.float64) tensor(13.4561, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1863, dtype=torch.float64) delta_t tensor(-0.3178, dtype=torch.float64)
7 gae_duplicate tensor(-1.1903, dtype=torch.float64) tensor(4.7338, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6617, dtype=torch.float64) delta_t tensor(-0.6115, dtype=torch.float64)
6 gae_duplicate tensor(-1.1721, dtype=torch.float64) tensor(7.6059, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9202, dtype=torch.float64) delta_t tensor(-0.8699, dtype=torch.float64)
5 gae_duplicate tensor(-1.9665, dtype=torch.float64) tensor(10.7235, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6723, dtype=torch.float64) delta_t tensor(-1.6244, dtype=torch.float64)
4 gae_duplicate tensor(-3.4424, dtype=torch.float64) tensor(18.8131, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1808, dtype=torch.float64) delta_t tensor(-0.1867, dtype=torch.float64)
3 gae_duplicate tensor(-1.1399, dtype=torch.float64) tensor(4.9175, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2755, dtype=torch.float64) delta_t tensor(-0.3165, dtype=torch.float64)
2 gae_duplicate tensor(-0.5992, dtype=torch.float64) tensor(4.3583, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-295.1060791015625
value loss:119.14140319824219
entropies:210.02670288085938
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.682184934616089 seconds
19 rew tensor(0.7502, dtype=torch.float64) delta_t tensor(0.4613, dtype=torch.float64)
19 gae_duplicate tensor(0.0830, dtype=torch.float64) tensor(-5.5446, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7195, dtype=torch.float64) delta_t tensor(0.5422, dtype=torch.float64)
18 gae_duplicate tensor(0.2782, dtype=torch.float64) tensor(-6.6209, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6641, dtype=torch.float64) delta_t tensor(0.5366, dtype=torch.float64)
17 gae_duplicate tensor(0.1631, dtype=torch.float64) tensor(-8.2762, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5251, dtype=torch.float64) delta_t tensor(0.3863, dtype=torch.float64)
16 gae_duplicate tensor(0.0123, dtype=torch.float64) tensor(-5.7135, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5295, dtype=torch.float64) delta_t tensor(0.4183, dtype=torch.float64)
15 gae_duplicate tensor(-0.4251, dtype=torch.float64) tensor(-5.1360, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6980, dtype=torch.float64) delta_t tensor(0.6263, dtype=torch.float64)
14 gae_duplicate tensor(0.5387, dtype=torch.float64) tensor(-7.2864, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7246, dtype=torch.float64) delta_t tensor(0.5811, dtype=torch.float64)
13 gae_duplicate tensor(0.5449, dtype=torch.float64) tensor(-7.3381, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4985, dtype=torch.float64) delta_t tensor(0.4589, dtype=torch.float64)
12 gae_duplicate tensor(0.1909, dtype=torch.float64) tensor(-7.1275, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5364, dtype=torch.float64) delta_t tensor(0.4007, dtype=torch.float64)
11 gae_duplicate tensor(0.2152, dtype=torch.float64) tensor(-6.4761, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5271, dtype=torch.float64) delta_t tensor(-0.6859, dtype=torch.float64)
10 gae_duplicate tensor(-4.9608, dtype=torch.float64) tensor(9.7613, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1057, dtype=torch.float64) delta_t tensor(-0.1664, dtype=torch.float64)
9 gae_duplicate tensor(-2.5923, dtype=torch.float64) tensor(5.6351, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0719, dtype=torch.float64) delta_t tensor(0.0331, dtype=torch.float64)
8 gae_duplicate tensor(-0.9635, dtype=torch.float64) tensor(-0.1037, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6012, dtype=torch.float64) delta_t tensor(-0.5748, dtype=torch.float64)
7 gae_duplicate tensor(-1.5515, dtype=torch.float64) tensor(6.6679, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5795, dtype=torch.float64) delta_t tensor(-0.6250, dtype=torch.float64)
6 gae_duplicate tensor(-1.7929, dtype=torch.float64) tensor(7.7270, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4273, dtype=torch.float64) delta_t tensor(-1.3469, dtype=torch.float64)
5 gae_duplicate tensor(-3.1779, dtype=torch.float64) tensor(17.2533, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2913, dtype=torch.float64) delta_t tensor(-2.2686, dtype=torch.float64)
4 gae_duplicate tensor(-9.3843, dtype=torch.float64) tensor(30.6365, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4893, dtype=torch.float64) delta_t tensor(-0.4052, dtype=torch.float64)
3 gae_duplicate tensor(-1.3886, dtype=torch.float64) tensor(7.8448, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4287, dtype=torch.float64) delta_t tensor(-0.4267, dtype=torch.float64)
2 gae_duplicate tensor(-1.0736, dtype=torch.float64) tensor(4.6322, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1136.9686279296875
value loss:282.6921691894531
entropies:209.48019409179688
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.709775924682617 seconds
19 rew tensor(0.5036, dtype=torch.float64) delta_t tensor(0.2655, dtype=torch.float64)
19 gae_duplicate tensor(-0.9070, dtype=torch.float64) tensor(-3.4455, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7231, dtype=torch.float64) delta_t tensor(0.4792, dtype=torch.float64)
18 gae_duplicate tensor(0.2657, dtype=torch.float64) tensor(-6.8056, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6814, dtype=torch.float64) delta_t tensor(0.4741, dtype=torch.float64)
17 gae_duplicate tensor(0.0933, dtype=torch.float64) tensor(-5.5041, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6058, dtype=torch.float64) delta_t tensor(0.4128, dtype=torch.float64)
16 gae_duplicate tensor(-0.2002, dtype=torch.float64) tensor(-6.3228, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4459, dtype=torch.float64) delta_t tensor(0.2676, dtype=torch.float64)
15 gae_duplicate tensor(-0.9516, dtype=torch.float64) tensor(-3.7958, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6328, dtype=torch.float64) delta_t tensor(0.3949, dtype=torch.float64)
14 gae_duplicate tensor(-0.4850, dtype=torch.float64) tensor(-5.4172, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7437, dtype=torch.float64) delta_t tensor(0.5519, dtype=torch.float64)
13 gae_duplicate tensor(0.2331, dtype=torch.float64) tensor(-7.0864, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7603, dtype=torch.float64) delta_t tensor(0.5735, dtype=torch.float64)
12 gae_duplicate tensor(0.2664, dtype=torch.float64) tensor(-7.2419, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6888, dtype=torch.float64) delta_t tensor(0.5459, dtype=torch.float64)
11 gae_duplicate tensor(0.3199, dtype=torch.float64) tensor(-6.9753, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5966, dtype=torch.float64) delta_t tensor(0.4750, dtype=torch.float64)
10 gae_duplicate tensor(0.1827, dtype=torch.float64) tensor(-7.6351, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7599, dtype=torch.float64) delta_t tensor(-0.9136, dtype=torch.float64)
9 gae_duplicate tensor(-1.7147, dtype=torch.float64) tensor(8.8772, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8545, dtype=torch.float64) delta_t tensor(-0.8623, dtype=torch.float64)
8 gae_duplicate tensor(-2.4925, dtype=torch.float64) tensor(11.3503, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8180, dtype=torch.float64) delta_t tensor(-0.8431, dtype=torch.float64)
7 gae_duplicate tensor(-2.6227, dtype=torch.float64) tensor(9.7014, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8798, dtype=torch.float64) delta_t tensor(-0.9561, dtype=torch.float64)
6 gae_duplicate tensor(-2.0146, dtype=torch.float64) tensor(13.6974, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1076, dtype=torch.float64) delta_t tensor(-0.9933, dtype=torch.float64)
5 gae_duplicate tensor(-2.3065, dtype=torch.float64) tensor(11.5103, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2311, dtype=torch.float64) delta_t tensor(-2.1957, dtype=torch.float64)
4 gae_duplicate tensor(-7.1368, dtype=torch.float64) tensor(31.4535, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4634, dtype=torch.float64) delta_t tensor(-0.3533, dtype=torch.float64)
3 gae_duplicate tensor(-1.2154, dtype=torch.float64) tensor(6.7326, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3874, dtype=torch.float64) delta_t tensor(-0.3829, dtype=torch.float64)
2 gae_duplicate tensor(-1.1798, dtype=torch.float64) tensor(5.1169, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1413.021484375
value loss:233.38949584960938
entropies:208.13465881347656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.728221893310547 seconds
19 rew tensor(0.7386, dtype=torch.float64) delta_t tensor(0.4886, dtype=torch.float64)
19 gae_duplicate tensor(0.1628, dtype=torch.float64) tensor(-6.3875, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7054, dtype=torch.float64) delta_t tensor(0.4967, dtype=torch.float64)
18 gae_duplicate tensor(0.0749, dtype=torch.float64) tensor(-5.7751, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6299, dtype=torch.float64) delta_t tensor(0.4282, dtype=torch.float64)
17 gae_duplicate tensor(-0.2056, dtype=torch.float64) tensor(-4.4054, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4954, dtype=torch.float64) delta_t tensor(0.3104, dtype=torch.float64)
16 gae_duplicate tensor(-1.0197, dtype=torch.float64) tensor(-2.9726, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7827, dtype=torch.float64) delta_t tensor(0.5859, dtype=torch.float64)
15 gae_duplicate tensor(0.5424, dtype=torch.float64) tensor(-7.4344, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5943, dtype=torch.float64) delta_t tensor(0.5171, dtype=torch.float64)
14 gae_duplicate tensor(-0.3090, dtype=torch.float64) tensor(-5.9922, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6920, dtype=torch.float64) delta_t tensor(0.6573, dtype=torch.float64)
13 gae_duplicate tensor(0.3960, dtype=torch.float64) tensor(-6.5288, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6749, dtype=torch.float64) delta_t tensor(0.6168, dtype=torch.float64)
12 gae_duplicate tensor(0.4997, dtype=torch.float64) tensor(-7.0608, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6209, dtype=torch.float64) delta_t tensor(0.5431, dtype=torch.float64)
11 gae_duplicate tensor(0.2800, dtype=torch.float64) tensor(-8.0611, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3209, dtype=torch.float64) delta_t tensor(0.3210, dtype=torch.float64)
10 gae_duplicate tensor(-0.3224, dtype=torch.float64) tensor(-3.4562, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0488, dtype=torch.float64) delta_t tensor(-1.0376, dtype=torch.float64)
9 gae_duplicate tensor(-4.0441, dtype=torch.float64) tensor(8.4116, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8951, dtype=torch.float64) delta_t tensor(-0.9398, dtype=torch.float64)
8 gae_duplicate tensor(-2.8349, dtype=torch.float64) tensor(14.7847, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3225, dtype=torch.float64) delta_t tensor(-0.4351, dtype=torch.float64)
7 gae_duplicate tensor(-1.0846, dtype=torch.float64) tensor(6.2383, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5576, dtype=torch.float64) delta_t tensor(-0.4880, dtype=torch.float64)
6 gae_duplicate tensor(-1.3874, dtype=torch.float64) tensor(5.0907, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2779, dtype=torch.float64) delta_t tensor(-0.2143, dtype=torch.float64)
5 gae_duplicate tensor(-1.9634, dtype=torch.float64) tensor(2.3429, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9524, dtype=torch.float64) delta_t tensor(-1.7863, dtype=torch.float64)
4 gae_duplicate tensor(-6.7359, dtype=torch.float64) tensor(16.1168, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1301, dtype=torch.float64) delta_t tensor(0.2213, dtype=torch.float64)
3 gae_duplicate tensor(-0.8379, dtype=torch.float64) tensor(-0.9651, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8574, dtype=torch.float64) delta_t tensor(-0.7454, dtype=torch.float64)
2 gae_duplicate tensor(-1.0402, dtype=torch.float64) tensor(7.4383, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-87.20765686035156
value loss:203.05613708496094
entropies:207.70021057128906
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2423.8616)
ToM Target loss= tensor(1798.8287)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.809095144271851 seconds
19 rew tensor(0.7810, dtype=torch.float64) delta_t tensor(0.5229, dtype=torch.float64)
19 gae_duplicate tensor(0.2726, dtype=torch.float64) tensor(-4.9258, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7816, dtype=torch.float64) delta_t tensor(0.6212, dtype=torch.float64)
18 gae_duplicate tensor(0.5414, dtype=torch.float64) tensor(-9.6841, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7738, dtype=torch.float64) delta_t tensor(0.6020, dtype=torch.float64)
17 gae_duplicate tensor(0.5498, dtype=torch.float64) tensor(-6.3504, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7744, dtype=torch.float64) delta_t tensor(0.5739, dtype=torch.float64)
16 gae_duplicate tensor(0.4712, dtype=torch.float64) tensor(-7.2287, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7583, dtype=torch.float64) delta_t tensor(0.5215, dtype=torch.float64)
15 gae_duplicate tensor(0.4100, dtype=torch.float64) tensor(-5.4622, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7421, dtype=torch.float64) delta_t tensor(0.6184, dtype=torch.float64)
14 gae_duplicate tensor(0.1659, dtype=torch.float64) tensor(-7.2610, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6311, dtype=torch.float64) delta_t tensor(0.4529, dtype=torch.float64)
13 gae_duplicate tensor(-0.2096, dtype=torch.float64) tensor(-6.7988, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6982, dtype=torch.float64) delta_t tensor(0.5858, dtype=torch.float64)
12 gae_duplicate tensor(0.2215, dtype=torch.float64) tensor(-6.8505, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5471, dtype=torch.float64) delta_t tensor(0.5154, dtype=torch.float64)
11 gae_duplicate tensor(0.3352, dtype=torch.float64) tensor(-5.4225, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3591, dtype=torch.float64) delta_t tensor(0.3487, dtype=torch.float64)
10 gae_duplicate tensor(0.1123, dtype=torch.float64) tensor(-4.9806, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2423, dtype=torch.float64) delta_t tensor(-0.2903, dtype=torch.float64)
9 gae_duplicate tensor(-2.7363, dtype=torch.float64) tensor(2.5255, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0882, dtype=torch.float64) delta_t tensor(-0.2030, dtype=torch.float64)
8 gae_duplicate tensor(-0.8900, dtype=torch.float64) tensor(3.5551, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0646, dtype=torch.float64) delta_t tensor(-0.9775, dtype=torch.float64)
7 gae_duplicate tensor(-2.8846, dtype=torch.float64) tensor(11.5437, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8783, dtype=torch.float64) delta_t tensor(-0.8472, dtype=torch.float64)
6 gae_duplicate tensor(-3.4644, dtype=torch.float64) tensor(9.3165, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1662, dtype=torch.float64) delta_t tensor(-1.0296, dtype=torch.float64)
5 gae_duplicate tensor(-2.4880, dtype=torch.float64) tensor(14.3566, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4883, dtype=torch.float64) delta_t tensor(-1.3291, dtype=torch.float64)
4 gae_duplicate tensor(-5.0988, dtype=torch.float64) tensor(14.8471, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7614, dtype=torch.float64) delta_t tensor(-0.6466, dtype=torch.float64)
3 gae_duplicate tensor(-1.2558, dtype=torch.float64) tensor(11.6354, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4174, dtype=torch.float64) delta_t tensor(-0.3502, dtype=torch.float64)
2 gae_duplicate tensor(-1.2388, dtype=torch.float64) tensor(4.7968, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-311.4085998535156
value loss:172.4436798095703
entropies:207.6784210205078
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.885337829589844 seconds
19 rew tensor(0.7481, dtype=torch.float64) delta_t tensor(0.4934, dtype=torch.float64)
19 gae_duplicate tensor(0.2021, dtype=torch.float64) tensor(-7.1780, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7410, dtype=torch.float64) delta_t tensor(0.4430, dtype=torch.float64)
18 gae_duplicate tensor(0.1896, dtype=torch.float64) tensor(-5.2301, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6931, dtype=torch.float64) delta_t tensor(0.4588, dtype=torch.float64)
17 gae_duplicate tensor(0.0594, dtype=torch.float64) tensor(-5.9541, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6052, dtype=torch.float64) delta_t tensor(0.4479, dtype=torch.float64)
16 gae_duplicate tensor(0.0125, dtype=torch.float64) tensor(-5.0711, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4290, dtype=torch.float64) delta_t tensor(0.2612, dtype=torch.float64)
15 gae_duplicate tensor(-0.5382, dtype=torch.float64) tensor(-5.3914, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5116, dtype=torch.float64) delta_t tensor(0.3198, dtype=torch.float64)
14 gae_duplicate tensor(-0.4860, dtype=torch.float64) tensor(-4.2169, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6544, dtype=torch.float64) delta_t tensor(0.4459, dtype=torch.float64)
13 gae_duplicate tensor(-0.1330, dtype=torch.float64) tensor(-5.3749, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7754, dtype=torch.float64) delta_t tensor(0.5722, dtype=torch.float64)
12 gae_duplicate tensor(0.3161, dtype=torch.float64) tensor(-7.1778, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7255, dtype=torch.float64) delta_t tensor(0.6033, dtype=torch.float64)
11 gae_duplicate tensor(0.4985, dtype=torch.float64) tensor(-8.0243, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6031, dtype=torch.float64) delta_t tensor(0.4677, dtype=torch.float64)
10 gae_duplicate tensor(0.1244, dtype=torch.float64) tensor(-5.6928, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1532, dtype=torch.float64) delta_t tensor(-0.2899, dtype=torch.float64)
9 gae_duplicate tensor(-1.7264, dtype=torch.float64) tensor(2.3933, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1770, dtype=torch.float64) delta_t tensor(-1.2853, dtype=torch.float64)
8 gae_duplicate tensor(-2.7570, dtype=torch.float64) tensor(18.1614, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7866, dtype=torch.float64) delta_t tensor(-0.8616, dtype=torch.float64)
7 gae_duplicate tensor(-1.9368, dtype=torch.float64) tensor(13.2741, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2829, dtype=torch.float64) delta_t tensor(-1.4069, dtype=torch.float64)
6 gae_duplicate tensor(-2.3596, dtype=torch.float64) tensor(15.6515, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5425, dtype=torch.float64) delta_t tensor(-1.5247, dtype=torch.float64)
5 gae_duplicate tensor(-2.0556, dtype=torch.float64) tensor(18.0310, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4935, dtype=torch.float64) delta_t tensor(-1.4053, dtype=torch.float64)
4 gae_duplicate tensor(-7.4714, dtype=torch.float64) tensor(24.5911, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4720, dtype=torch.float64) delta_t tensor(-0.3487, dtype=torch.float64)
3 gae_duplicate tensor(-0.9893, dtype=torch.float64) tensor(5.7464, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2545, dtype=torch.float64) delta_t tensor(-0.2255, dtype=torch.float64)
2 gae_duplicate tensor(-0.4517, dtype=torch.float64) tensor(2.9479, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1530.634033203125
value loss:229.5636749267578
entropies:206.46128845214844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.998021125793457 seconds
19 rew tensor(0.6903, dtype=torch.float64) delta_t tensor(0.3488, dtype=torch.float64)
19 gae_duplicate tensor(-0.0368, dtype=torch.float64) tensor(-3.6487, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6156, dtype=torch.float64) delta_t tensor(0.3372, dtype=torch.float64)
18 gae_duplicate tensor(-0.2125, dtype=torch.float64) tensor(-4.4802, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4489, dtype=torch.float64) delta_t tensor(0.2475, dtype=torch.float64)
17 gae_duplicate tensor(-0.9847, dtype=torch.float64) tensor(-3.2042, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6989, dtype=torch.float64) delta_t tensor(0.5501, dtype=torch.float64)
16 gae_duplicate tensor(0.0193, dtype=torch.float64) tensor(-6.3296, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6234, dtype=torch.float64) delta_t tensor(0.5618, dtype=torch.float64)
15 gae_duplicate tensor(-0.0621, dtype=torch.float64) tensor(-6.1431, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7505, dtype=torch.float64) delta_t tensor(0.7136, dtype=torch.float64)
14 gae_duplicate tensor(0.6378, dtype=torch.float64) tensor(-9.8690, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7426, dtype=torch.float64) delta_t tensor(0.7366, dtype=torch.float64)
13 gae_duplicate tensor(0.7204, dtype=torch.float64) tensor(-9.5882, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5819, dtype=torch.float64) delta_t tensor(0.6183, dtype=torch.float64)
12 gae_duplicate tensor(0.3636, dtype=torch.float64) tensor(-5.9304, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4969, dtype=torch.float64) delta_t tensor(0.4482, dtype=torch.float64)
11 gae_duplicate tensor(0.1295, dtype=torch.float64) tensor(-5.8819, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4657, dtype=torch.float64) delta_t tensor(-0.5132, dtype=torch.float64)
10 gae_duplicate tensor(-4.3827, dtype=torch.float64) tensor(3.3353, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0416, dtype=torch.float64) delta_t tensor(-0.0194, dtype=torch.float64)
9 gae_duplicate tensor(-0.9302, dtype=torch.float64) tensor(1.1566, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0164, dtype=torch.float64) delta_t tensor(-0.0328, dtype=torch.float64)
8 gae_duplicate tensor(-0.8561, dtype=torch.float64) tensor(-0.1737, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3726, dtype=torch.float64) delta_t tensor(-0.3407, dtype=torch.float64)
7 gae_duplicate tensor(-0.7162, dtype=torch.float64) tensor(3.5015, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4464, dtype=torch.float64) delta_t tensor(-0.3153, dtype=torch.float64)
6 gae_duplicate tensor(-0.8140, dtype=torch.float64) tensor(4.3974, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2857, dtype=torch.float64) delta_t tensor(-1.1262, dtype=torch.float64)
5 gae_duplicate tensor(-1.7893, dtype=torch.float64) tensor(13.5332, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0645, dtype=torch.float64) delta_t tensor(0.1911, dtype=torch.float64)
4 gae_duplicate tensor(-1.3323, dtype=torch.float64) tensor(-0.1873, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8545, dtype=torch.float64) delta_t tensor(-0.6850, dtype=torch.float64)
3 gae_duplicate tensor(-1.1673, dtype=torch.float64) tensor(7.3804, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5432, dtype=torch.float64) delta_t tensor(-0.5526, dtype=torch.float64)
2 gae_duplicate tensor(-1.0367, dtype=torch.float64) tensor(8.4252, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:456.0625915527344
value loss:101.72403717041016
entropies:207.61444091796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.890655994415283 seconds
19 rew tensor(0.7824, dtype=torch.float64) delta_t tensor(0.6338, dtype=torch.float64)
19 gae_duplicate tensor(0.4548, dtype=torch.float64) tensor(-5.4556, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7666, dtype=torch.float64) delta_t tensor(0.5738, dtype=torch.float64)
18 gae_duplicate tensor(0.4935, dtype=torch.float64) tensor(-6.5865, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7672, dtype=torch.float64) delta_t tensor(0.5924, dtype=torch.float64)
17 gae_duplicate tensor(0.5054, dtype=torch.float64) tensor(-7.9590, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7438, dtype=torch.float64) delta_t tensor(0.5570, dtype=torch.float64)
16 gae_duplicate tensor(0.4597, dtype=torch.float64) tensor(-6.5297, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7038, dtype=torch.float64) delta_t tensor(0.5342, dtype=torch.float64)
15 gae_duplicate tensor(0.3411, dtype=torch.float64) tensor(-7.0910, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6475, dtype=torch.float64) delta_t tensor(0.4885, dtype=torch.float64)
14 gae_duplicate tensor(0.2563, dtype=torch.float64) tensor(-5.6114, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6066, dtype=torch.float64) delta_t tensor(0.4765, dtype=torch.float64)
13 gae_duplicate tensor(0.0115, dtype=torch.float64) tensor(-5.4164, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7242, dtype=torch.float64) delta_t tensor(0.5536, dtype=torch.float64)
12 gae_duplicate tensor(0.3388, dtype=torch.float64) tensor(-9.3506, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7159, dtype=torch.float64) delta_t tensor(0.6538, dtype=torch.float64)
11 gae_duplicate tensor(0.3452, dtype=torch.float64) tensor(-8.7355, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0577, dtype=torch.float64) delta_t tensor(-0.0185, dtype=torch.float64)
10 gae_duplicate tensor(-1.1556, dtype=torch.float64) tensor(-0.5801, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5663, dtype=torch.float64) delta_t tensor(-0.6325, dtype=torch.float64)
9 gae_duplicate tensor(-2.3994, dtype=torch.float64) tensor(9.0420, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2678, dtype=torch.float64) delta_t tensor(-0.1898, dtype=torch.float64)
8 gae_duplicate tensor(-1.7236, dtype=torch.float64) tensor(3.7293, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4799, dtype=torch.float64) delta_t tensor(-0.4655, dtype=torch.float64)
7 gae_duplicate tensor(-2.9242, dtype=torch.float64) tensor(7.3268, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6361, dtype=torch.float64) delta_t tensor(-0.5311, dtype=torch.float64)
6 gae_duplicate tensor(-2.0183, dtype=torch.float64) tensor(5.9055, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2897, dtype=torch.float64) delta_t tensor(-1.1260, dtype=torch.float64)
5 gae_duplicate tensor(-3.5068, dtype=torch.float64) tensor(18.1764, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5886, dtype=torch.float64) delta_t tensor(-1.4717, dtype=torch.float64)
4 gae_duplicate tensor(-5.9419, dtype=torch.float64) tensor(20.1128, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3395, dtype=torch.float64) delta_t tensor(-0.2074, dtype=torch.float64)
3 gae_duplicate tensor(-0.9622, dtype=torch.float64) tensor(5.5306, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4892, dtype=torch.float64) delta_t tensor(-0.4614, dtype=torch.float64)
2 gae_duplicate tensor(-0.7891, dtype=torch.float64) tensor(6.1554, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-493.00299072265625
value loss:160.24652099609375
entropies:206.32540893554688
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.57682728767395 seconds
19 rew tensor(0.7747, dtype=torch.float64) delta_t tensor(0.4939, dtype=torch.float64)
19 gae_duplicate tensor(0.2953, dtype=torch.float64) tensor(-4.8094, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7753, dtype=torch.float64) delta_t tensor(0.5655, dtype=torch.float64)
18 gae_duplicate tensor(0.4835, dtype=torch.float64) tensor(-7.1991, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7674, dtype=torch.float64) delta_t tensor(0.5746, dtype=torch.float64)
17 gae_duplicate tensor(0.5001, dtype=torch.float64) tensor(-7.6106, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7426, dtype=torch.float64) delta_t tensor(0.5436, dtype=torch.float64)
16 gae_duplicate tensor(0.3801, dtype=torch.float64) tensor(-6.9031, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7094, dtype=torch.float64) delta_t tensor(0.5311, dtype=torch.float64)
15 gae_duplicate tensor(0.0931, dtype=torch.float64) tensor(-5.7894, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6424, dtype=torch.float64) delta_t tensor(0.5270, dtype=torch.float64)
14 gae_duplicate tensor(-0.0249, dtype=torch.float64) tensor(-4.4147, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7282, dtype=torch.float64) delta_t tensor(0.6025, dtype=torch.float64)
13 gae_duplicate tensor(0.3697, dtype=torch.float64) tensor(-6.2703, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5249, dtype=torch.float64) delta_t tensor(0.4277, dtype=torch.float64)
12 gae_duplicate tensor(-0.4047, dtype=torch.float64) tensor(-5.8830, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4085, dtype=torch.float64) delta_t tensor(0.4209, dtype=torch.float64)
11 gae_duplicate tensor(-0.7473, dtype=torch.float64) tensor(-6.2569, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4130, dtype=torch.float64) delta_t tensor(0.3004, dtype=torch.float64)
10 gae_duplicate tensor(-0.0531, dtype=torch.float64) tensor(-4.8525, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0313, dtype=torch.float64) delta_t tensor(-0.0971, dtype=torch.float64)
9 gae_duplicate tensor(-0.3267, dtype=torch.float64) tensor(0.4492, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4158, dtype=torch.float64) delta_t tensor(-0.3580, dtype=torch.float64)
8 gae_duplicate tensor(-1.5416, dtype=torch.float64) tensor(4.1210, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7076, dtype=torch.float64) delta_t tensor(-0.6167, dtype=torch.float64)
7 gae_duplicate tensor(-2.4410, dtype=torch.float64) tensor(8.4271, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9615, dtype=torch.float64) delta_t tensor(-0.8452, dtype=torch.float64)
6 gae_duplicate tensor(-2.0097, dtype=torch.float64) tensor(8.2718, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1284, dtype=torch.float64) delta_t tensor(-1.0741, dtype=torch.float64)
5 gae_duplicate tensor(-2.2568, dtype=torch.float64) tensor(12.9860, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3079, dtype=torch.float64) delta_t tensor(-2.2284, dtype=torch.float64)
4 gae_duplicate tensor(-4.8954, dtype=torch.float64) tensor(27.7959, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1948, dtype=torch.float64) delta_t tensor(-0.0211, dtype=torch.float64)
3 gae_duplicate tensor(-0.8185, dtype=torch.float64) tensor(3.3029, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6895, dtype=torch.float64) delta_t tensor(-0.5586, dtype=torch.float64)
2 gae_duplicate tensor(-1.0324, dtype=torch.float64) tensor(7.3133, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-493.2476806640625
value loss:163.10552978515625
entropies:204.64393615722656
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2419.5496)
ToM Target loss= tensor(1799.9004)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.983538866043091 seconds
19 rew tensor(0.7717, dtype=torch.float64) delta_t tensor(0.5621, dtype=torch.float64)
19 gae_duplicate tensor(0.4584, dtype=torch.float64) tensor(-5.7396, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7723, dtype=torch.float64) delta_t tensor(0.5979, dtype=torch.float64)
18 gae_duplicate tensor(0.5354, dtype=torch.float64) tensor(-8.4981, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7489, dtype=torch.float64) delta_t tensor(0.5332, dtype=torch.float64)
17 gae_duplicate tensor(0.4086, dtype=torch.float64) tensor(-4.7366, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7014, dtype=torch.float64) delta_t tensor(0.4851, dtype=torch.float64)
16 gae_duplicate tensor(0.2683, dtype=torch.float64) tensor(-4.9578, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6698, dtype=torch.float64) delta_t tensor(0.5508, dtype=torch.float64)
15 gae_duplicate tensor(0.1453, dtype=torch.float64) tensor(-5.4399, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4785, dtype=torch.float64) delta_t tensor(0.4224, dtype=torch.float64)
14 gae_duplicate tensor(-0.3723, dtype=torch.float64) tensor(-6.7064, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6780, dtype=torch.float64) delta_t tensor(0.6058, dtype=torch.float64)
13 gae_duplicate tensor(0.4482, dtype=torch.float64) tensor(-7.6899, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5987, dtype=torch.float64) delta_t tensor(0.5383, dtype=torch.float64)
12 gae_duplicate tensor(0.3284, dtype=torch.float64) tensor(-5.3460, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5583, dtype=torch.float64) delta_t tensor(0.5032, dtype=torch.float64)
11 gae_duplicate tensor(0.4337, dtype=torch.float64) tensor(-6.9252, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4991, dtype=torch.float64) delta_t tensor(0.4818, dtype=torch.float64)
10 gae_duplicate tensor(0.3756, dtype=torch.float64) tensor(-6.3238, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2901, dtype=torch.float64) delta_t tensor(-0.3679, dtype=torch.float64)
9 gae_duplicate tensor(-1.5679, dtype=torch.float64) tensor(3.7812, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1703, dtype=torch.float64) delta_t tensor(-0.2771, dtype=torch.float64)
8 gae_duplicate tensor(-1.1225, dtype=torch.float64) tensor(5.9154, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5346, dtype=torch.float64) delta_t tensor(-0.5960, dtype=torch.float64)
7 gae_duplicate tensor(-2.0403, dtype=torch.float64) tensor(8.6982, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9967, dtype=torch.float64) delta_t tensor(-1.0233, dtype=torch.float64)
6 gae_duplicate tensor(-3.0018, dtype=torch.float64) tensor(12.3772, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1827, dtype=torch.float64) delta_t tensor(-1.0828, dtype=torch.float64)
5 gae_duplicate tensor(-2.4282, dtype=torch.float64) tensor(14.8972, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6345, dtype=torch.float64) delta_t tensor(-2.4753, dtype=torch.float64)
4 gae_duplicate tensor(-9.2768, dtype=torch.float64) tensor(29.0812, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3659, dtype=torch.float64) delta_t tensor(-0.2226, dtype=torch.float64)
3 gae_duplicate tensor(-1.3456, dtype=torch.float64) tensor(5.4460, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0956, dtype=torch.float64) delta_t tensor(-0.1694, dtype=torch.float64)
2 gae_duplicate tensor(-0.3238, dtype=torch.float64) tensor(2.6108, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-772.7683715820312
value loss:269.7734069824219
entropies:204.3377227783203
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.559501886367798 seconds
19 rew tensor(0.3756, dtype=torch.float64) delta_t tensor(0.0344, dtype=torch.float64)
19 gae_duplicate tensor(-1.0387, dtype=torch.float64) tensor(-0.2109, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5804, dtype=torch.float64) delta_t tensor(0.3090, dtype=torch.float64)
18 gae_duplicate tensor(-0.4403, dtype=torch.float64) tensor(-4.5941, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3771, dtype=torch.float64) delta_t tensor(0.2056, dtype=torch.float64)
17 gae_duplicate tensor(-1.1558, dtype=torch.float64) tensor(-2.6665, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6022, dtype=torch.float64) delta_t tensor(0.4820, dtype=torch.float64)
16 gae_duplicate tensor(0.1275, dtype=torch.float64) tensor(-5.2116, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4468, dtype=torch.float64) delta_t tensor(0.3520, dtype=torch.float64)
15 gae_duplicate tensor(-0.4036, dtype=torch.float64) tensor(-2.9796, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4918, dtype=torch.float64) delta_t tensor(0.3642, dtype=torch.float64)
14 gae_duplicate tensor(-0.2901, dtype=torch.float64) tensor(-5.0487, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6604, dtype=torch.float64) delta_t tensor(0.5591, dtype=torch.float64)
13 gae_duplicate tensor(0.2869, dtype=torch.float64) tensor(-5.6182, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4329, dtype=torch.float64) delta_t tensor(0.3587, dtype=torch.float64)
12 gae_duplicate tensor(-0.5707, dtype=torch.float64) tensor(-3.9316, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4649, dtype=torch.float64) delta_t tensor(0.3202, dtype=torch.float64)
11 gae_duplicate tensor(-0.0454, dtype=torch.float64) tensor(-3.7442, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0135, dtype=torch.float64) delta_t tensor(-0.0453, dtype=torch.float64)
10 gae_duplicate tensor(-2.0579, dtype=torch.float64) tensor(0.0652, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8966, dtype=torch.float64) delta_t tensor(-1.0432, dtype=torch.float64)
9 gae_duplicate tensor(-2.6205, dtype=torch.float64) tensor(12.4335, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1970, dtype=torch.float64) delta_t tensor(-0.3030, dtype=torch.float64)
8 gae_duplicate tensor(-1.2750, dtype=torch.float64) tensor(5.2536, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6218, dtype=torch.float64) delta_t tensor(-0.5988, dtype=torch.float64)
7 gae_duplicate tensor(-3.0330, dtype=torch.float64) tensor(10.8348, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5890, dtype=torch.float64) delta_t tensor(-0.6536, dtype=torch.float64)
6 gae_duplicate tensor(-2.4538, dtype=torch.float64) tensor(7.8411, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6498, dtype=torch.float64) delta_t tensor(-1.4602, dtype=torch.float64)
5 gae_duplicate tensor(-2.8088, dtype=torch.float64) tensor(19.1609, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5901, dtype=torch.float64) delta_t tensor(-1.4135, dtype=torch.float64)
4 gae_duplicate tensor(-4.9175, dtype=torch.float64) tensor(23.1490, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0932, dtype=torch.float64) delta_t tensor(0.0249, dtype=torch.float64)
3 gae_duplicate tensor(-0.4948, dtype=torch.float64) tensor(1.6574, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5465, dtype=torch.float64) delta_t tensor(-0.4689, dtype=torch.float64)
2 gae_duplicate tensor(-0.9011, dtype=torch.float64) tensor(4.3604, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1863.678955078125
value loss:170.1476593017578
entropies:203.689453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7966649532318115 seconds
19 rew tensor(0.4750, dtype=torch.float64) delta_t tensor(0.2055, dtype=torch.float64)
19 gae_duplicate tensor(-0.9416, dtype=torch.float64) tensor(-2.6609, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7053, dtype=torch.float64) delta_t tensor(0.5098, dtype=torch.float64)
18 gae_duplicate tensor(0.2761, dtype=torch.float64) tensor(-5.2927, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6070, dtype=torch.float64) delta_t tensor(0.4763, dtype=torch.float64)
17 gae_duplicate tensor(0.0814, dtype=torch.float64) tensor(-6.1063, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4758, dtype=torch.float64) delta_t tensor(0.3665, dtype=torch.float64)
16 gae_duplicate tensor(-0.3594, dtype=torch.float64) tensor(-5.2992, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5148, dtype=torch.float64) delta_t tensor(0.4216, dtype=torch.float64)
15 gae_duplicate tensor(-0.4654, dtype=torch.float64) tensor(-5.0825, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6950, dtype=torch.float64) delta_t tensor(0.6737, dtype=torch.float64)
14 gae_duplicate tensor(0.2902, dtype=torch.float64) tensor(-7.8022, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7100, dtype=torch.float64) delta_t tensor(0.6657, dtype=torch.float64)
13 gae_duplicate tensor(0.4591, dtype=torch.float64) tensor(-9.3773, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5754, dtype=torch.float64) delta_t tensor(0.5616, dtype=torch.float64)
12 gae_duplicate tensor(0.4440, dtype=torch.float64) tensor(-8.8106, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4771, dtype=torch.float64) delta_t tensor(0.5253, dtype=torch.float64)
11 gae_duplicate tensor(0.3634, dtype=torch.float64) tensor(-6.5159, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4131, dtype=torch.float64) delta_t tensor(0.3783, dtype=torch.float64)
10 gae_duplicate tensor(-0.2860, dtype=torch.float64) tensor(-4.2863, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9744, dtype=torch.float64) delta_t tensor(-0.8775, dtype=torch.float64)
9 gae_duplicate tensor(-2.2573, dtype=torch.float64) tensor(11.4181, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7926, dtype=torch.float64) delta_t tensor(-0.7851, dtype=torch.float64)
8 gae_duplicate tensor(-1.7834, dtype=torch.float64) tensor(9.2523, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7183, dtype=torch.float64) delta_t tensor(-0.6512, dtype=torch.float64)
7 gae_duplicate tensor(-1.9051, dtype=torch.float64) tensor(11.0745, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4798, dtype=torch.float64) delta_t tensor(-1.3830, dtype=torch.float64)
6 gae_duplicate tensor(-2.0308, dtype=torch.float64) tensor(16.4746, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4701, dtype=torch.float64) delta_t tensor(-1.3983, dtype=torch.float64)
5 gae_duplicate tensor(-4.0111, dtype=torch.float64) tensor(17.4286, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4197, dtype=torch.float64) delta_t tensor(-3.2107, dtype=torch.float64)
4 gae_duplicate tensor(-9.1537, dtype=torch.float64) tensor(41.4650, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0928, dtype=torch.float64) delta_t tensor(-0.0516, dtype=torch.float64)
3 gae_duplicate tensor(-1.0472, dtype=torch.float64) tensor(5.1920, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1428, dtype=torch.float64) delta_t tensor(-0.1202, dtype=torch.float64)
2 gae_duplicate tensor(-0.6577, dtype=torch.float64) tensor(1.1315, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1915.5411376953125
value loss:348.38726806640625
entropies:201.3525848388672
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.195519924163818 seconds
19 rew tensor(0.5279, dtype=torch.float64) delta_t tensor(0.3993, dtype=torch.float64)
19 gae_duplicate tensor(-0.7162, dtype=torch.float64) tensor(-5.4900, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7394, dtype=torch.float64) delta_t tensor(0.4954, dtype=torch.float64)
18 gae_duplicate tensor(0.0719, dtype=torch.float64) tensor(-5.3150, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7155, dtype=torch.float64) delta_t tensor(0.5492, dtype=torch.float64)
17 gae_duplicate tensor(0.2193, dtype=torch.float64) tensor(-7.1193, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6511, dtype=torch.float64) delta_t tensor(0.5099, dtype=torch.float64)
16 gae_duplicate tensor(-0.0982, dtype=torch.float64) tensor(-5.0783, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5461, dtype=torch.float64) delta_t tensor(0.4362, dtype=torch.float64)
15 gae_duplicate tensor(-0.6134, dtype=torch.float64) tensor(-5.0169, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7660, dtype=torch.float64) delta_t tensor(0.8143, dtype=torch.float64)
14 gae_duplicate tensor(0.5987, dtype=torch.float64) tensor(-12.2057, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7034, dtype=torch.float64) delta_t tensor(0.7099, dtype=torch.float64)
13 gae_duplicate tensor(0.6105, dtype=torch.float64) tensor(-9.4326, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5719, dtype=torch.float64) delta_t tensor(0.6054, dtype=torch.float64)
12 gae_duplicate tensor(0.4764, dtype=torch.float64) tensor(-7.3302, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5123, dtype=torch.float64) delta_t tensor(0.5260, dtype=torch.float64)
11 gae_duplicate tensor(0.4274, dtype=torch.float64) tensor(-5.7426, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3850, dtype=torch.float64) delta_t tensor(0.3570, dtype=torch.float64)
10 gae_duplicate tensor(0.3003, dtype=torch.float64) tensor(-3.3098, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0043, dtype=torch.float64) delta_t tensor(-0.0036, dtype=torch.float64)
9 gae_duplicate tensor(-0.5358, dtype=torch.float64) tensor(-0.5916, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2881, dtype=torch.float64) delta_t tensor(-0.1513, dtype=torch.float64)
8 gae_duplicate tensor(-1.5977, dtype=torch.float64) tensor(-0.1348, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5457, dtype=torch.float64) delta_t tensor(-0.4912, dtype=torch.float64)
7 gae_duplicate tensor(-1.6411, dtype=torch.float64) tensor(4.6408, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2009, dtype=torch.float64) delta_t tensor(-1.0708, dtype=torch.float64)
6 gae_duplicate tensor(-2.2827, dtype=torch.float64) tensor(13.6744, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6530, dtype=torch.float64) delta_t tensor(-1.6613, dtype=torch.float64)
5 gae_duplicate tensor(-3.2281, dtype=torch.float64) tensor(23.1614, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8170, dtype=torch.float64) delta_t tensor(-1.7064, dtype=torch.float64)
4 gae_duplicate tensor(-5.7551, dtype=torch.float64) tensor(13.4355, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5174, dtype=torch.float64) delta_t tensor(-0.3055, dtype=torch.float64)
3 gae_duplicate tensor(-1.0664, dtype=torch.float64) tensor(4.9586, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4464, dtype=torch.float64) delta_t tensor(-0.3845, dtype=torch.float64)
2 gae_duplicate tensor(-1.0058, dtype=torch.float64) tensor(4.8468, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:37.78788757324219
value loss:196.6856231689453
entropies:199.94825744628906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.674164056777954 seconds
19 rew tensor(0.3201, dtype=torch.float64) delta_t tensor(0.1884, dtype=torch.float64)
19 gae_duplicate tensor(-0.6195, dtype=torch.float64) tensor(-4.1527, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7476, dtype=torch.float64) delta_t tensor(0.6426, dtype=torch.float64)
18 gae_duplicate tensor(0.3534, dtype=torch.float64) tensor(-6.2345, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7227, dtype=torch.float64) delta_t tensor(0.6338, dtype=torch.float64)
17 gae_duplicate tensor(0.2995, dtype=torch.float64) tensor(-6.3071, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6555, dtype=torch.float64) delta_t tensor(0.5347, dtype=torch.float64)
16 gae_duplicate tensor(-0.0116, dtype=torch.float64) tensor(-5.6021, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5312, dtype=torch.float64) delta_t tensor(0.4832, dtype=torch.float64)
15 gae_duplicate tensor(-0.5674, dtype=torch.float64) tensor(-6.8466, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7518, dtype=torch.float64) delta_t tensor(0.6473, dtype=torch.float64)
14 gae_duplicate tensor(0.4294, dtype=torch.float64) tensor(-7.6113, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5752, dtype=torch.float64) delta_t tensor(0.4533, dtype=torch.float64)
13 gae_duplicate tensor(0.0942, dtype=torch.float64) tensor(-6.6492, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4529, dtype=torch.float64) delta_t tensor(0.4801, dtype=torch.float64)
12 gae_duplicate tensor(0.0689, dtype=torch.float64) tensor(-5.5725, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2883, dtype=torch.float64) delta_t tensor(0.3462, dtype=torch.float64)
11 gae_duplicate tensor(-0.2337, dtype=torch.float64) tensor(-3.7312, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4773, dtype=torch.float64) delta_t tensor(-0.5186, dtype=torch.float64)
10 gae_duplicate tensor(-2.1716, dtype=torch.float64) tensor(5.2769, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1161, dtype=torch.float64) delta_t tensor(0.1356, dtype=torch.float64)
9 gae_duplicate tensor(-0.5603, dtype=torch.float64) tensor(-1.4430, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1968, dtype=torch.float64) delta_t tensor(-0.2208, dtype=torch.float64)
8 gae_duplicate tensor(-1.1881, dtype=torch.float64) tensor(2.1354, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3957, dtype=torch.float64) delta_t tensor(-0.4131, dtype=torch.float64)
7 gae_duplicate tensor(-1.3484, dtype=torch.float64) tensor(7.0375, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3296, dtype=torch.float64) delta_t tensor(-0.2270, dtype=torch.float64)
6 gae_duplicate tensor(-1.5731, dtype=torch.float64) tensor(3.9406, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6799, dtype=torch.float64) delta_t tensor(-0.4721, dtype=torch.float64)
5 gae_duplicate tensor(-2.0229, dtype=torch.float64) tensor(3.6010, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1666, dtype=torch.float64) delta_t tensor(-0.8993, dtype=torch.float64)
4 gae_duplicate tensor(-5.4039, dtype=torch.float64) tensor(5.9860, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5007, dtype=torch.float64) delta_t tensor(-0.2899, dtype=torch.float64)
3 gae_duplicate tensor(-1.2623, dtype=torch.float64) tensor(5.0161, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4707, dtype=torch.float64) delta_t tensor(-0.4298, dtype=torch.float64)
2 gae_duplicate tensor(-0.8541, dtype=torch.float64) tensor(5.1288, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:540.9105224609375
value loss:126.2270278930664
entropies:200.53883361816406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2389.5449)
ToM Target loss= tensor(1799.8212)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.655771017074585 seconds
19 rew tensor(0.7262, dtype=torch.float64) delta_t tensor(0.4591, dtype=torch.float64)
19 gae_duplicate tensor(0.0670, dtype=torch.float64) tensor(-5.5851, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6633, dtype=torch.float64) delta_t tensor(0.4606, dtype=torch.float64)
18 gae_duplicate tensor(0.0071, dtype=torch.float64) tensor(-5.2435, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5371, dtype=torch.float64) delta_t tensor(0.3495, dtype=torch.float64)
17 gae_duplicate tensor(-0.2771, dtype=torch.float64) tensor(-3.7272, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3140, dtype=torch.float64) delta_t tensor(0.1391, dtype=torch.float64)
16 gae_duplicate tensor(-0.9122, dtype=torch.float64) tensor(-2.5641, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7653, dtype=torch.float64) delta_t tensor(0.6340, dtype=torch.float64)
15 gae_duplicate tensor(0.4717, dtype=torch.float64) tensor(-6.3049, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7399, dtype=torch.float64) delta_t tensor(0.6553, dtype=torch.float64)
14 gae_duplicate tensor(0.4172, dtype=torch.float64) tensor(-8.9599, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7057, dtype=torch.float64) delta_t tensor(0.7407, dtype=torch.float64)
13 gae_duplicate tensor(0.4082, dtype=torch.float64) tensor(-11.4038, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7276, dtype=torch.float64) delta_t tensor(0.8008, dtype=torch.float64)
12 gae_duplicate tensor(0.7579, dtype=torch.float64) tensor(-10.8001, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2502, dtype=torch.float64) delta_t tensor(0.3653, dtype=torch.float64)
11 gae_duplicate tensor(-1.8984, dtype=torch.float64) tensor(-3.4815, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1704, dtype=torch.float64) delta_t tensor(0.3006, dtype=torch.float64)
10 gae_duplicate tensor(-1.0605, dtype=torch.float64) tensor(-4.9324, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4654, dtype=torch.float64) delta_t tensor(-0.3934, dtype=torch.float64)
9 gae_duplicate tensor(-3.9523, dtype=torch.float64) tensor(7.3516, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0555, dtype=torch.float64) delta_t tensor(0.0550, dtype=torch.float64)
8 gae_duplicate tensor(-0.9665, dtype=torch.float64) tensor(-0.7823, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2103, dtype=torch.float64) delta_t tensor(-0.0886, dtype=torch.float64)
7 gae_duplicate tensor(-0.9403, dtype=torch.float64) tensor(1.3476, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1207, dtype=torch.float64) delta_t tensor(-0.0617, dtype=torch.float64)
6 gae_duplicate tensor(-0.9867, dtype=torch.float64) tensor(1.4641, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9858, dtype=torch.float64) delta_t tensor(-0.7004, dtype=torch.float64)
5 gae_duplicate tensor(-1.1466, dtype=torch.float64) tensor(6.1722, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1656, dtype=torch.float64) delta_t tensor(0.0559, dtype=torch.float64)
4 gae_duplicate tensor(-0.5653, dtype=torch.float64) tensor(1.6177, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4544, dtype=torch.float64) delta_t tensor(-0.2193, dtype=torch.float64)
3 gae_duplicate tensor(-0.9815, dtype=torch.float64) tensor(2.9137, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3741, dtype=torch.float64) delta_t tensor(-0.3237, dtype=torch.float64)
2 gae_duplicate tensor(-1.0321, dtype=torch.float64) tensor(3.6069, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1379.1522216796875
value loss:99.32295989990234
entropies:200.2730712890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.478286981582642 seconds
19 rew tensor(0.7644, dtype=torch.float64) delta_t tensor(0.5274, dtype=torch.float64)
19 gae_duplicate tensor(0.1237, dtype=torch.float64) tensor(-4.6096, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7562, dtype=torch.float64) delta_t tensor(0.5033, dtype=torch.float64)
18 gae_duplicate tensor(0.1387, dtype=torch.float64) tensor(-5.2164, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7219, dtype=torch.float64) delta_t tensor(0.5441, dtype=torch.float64)
17 gae_duplicate tensor(0.2373, dtype=torch.float64) tensor(-5.4445, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6703, dtype=torch.float64) delta_t tensor(0.5173, dtype=torch.float64)
16 gae_duplicate tensor(0.0361, dtype=torch.float64) tensor(-6.1816, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5666, dtype=torch.float64) delta_t tensor(0.5727, dtype=torch.float64)
15 gae_duplicate tensor(-0.5039, dtype=torch.float64) tensor(-7.3654, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7372, dtype=torch.float64) delta_t tensor(0.7222, dtype=torch.float64)
14 gae_duplicate tensor(0.3871, dtype=torch.float64) tensor(-7.5575, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6819, dtype=torch.float64) delta_t tensor(0.7603, dtype=torch.float64)
13 gae_duplicate tensor(0.2137, dtype=torch.float64) tensor(-8.2664, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4539, dtype=torch.float64) delta_t tensor(0.5026, dtype=torch.float64)
12 gae_duplicate tensor(0.0875, dtype=torch.float64) tensor(-6.7634, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4307, dtype=torch.float64) delta_t tensor(0.4909, dtype=torch.float64)
11 gae_duplicate tensor(0.2436, dtype=torch.float64) tensor(-4.7754, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3210, dtype=torch.float64) delta_t tensor(0.2064, dtype=torch.float64)
10 gae_duplicate tensor(-0.2237, dtype=torch.float64) tensor(-3.5189, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1284, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
9 gae_duplicate tensor(-1.7700, dtype=torch.float64) tensor(0.7069, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1272, dtype=torch.float64) delta_t tensor(0.0152, dtype=torch.float64)
8 gae_duplicate tensor(-0.9257, dtype=torch.float64) tensor(-0.7149, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5413, dtype=torch.float64) delta_t tensor(-0.4759, dtype=torch.float64)
7 gae_duplicate tensor(-1.4217, dtype=torch.float64) tensor(4.3957, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0968, dtype=torch.float64) delta_t tensor(-0.9141, dtype=torch.float64)
6 gae_duplicate tensor(-2.0626, dtype=torch.float64) tensor(11.2851, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0095, dtype=torch.float64) delta_t tensor(-0.7492, dtype=torch.float64)
5 gae_duplicate tensor(-1.8384, dtype=torch.float64) tensor(7.8043, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3083, dtype=torch.float64) delta_t tensor(-2.0305, dtype=torch.float64)
4 gae_duplicate tensor(-6.9298, dtype=torch.float64) tensor(24.5960, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2057, dtype=torch.float64) delta_t tensor(-0.0322, dtype=torch.float64)
3 gae_duplicate tensor(-0.7519, dtype=torch.float64) tensor(2.4624, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3698, dtype=torch.float64) delta_t tensor(-0.3010, dtype=torch.float64)
2 gae_duplicate tensor(-0.8578, dtype=torch.float64) tensor(2.6846, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:197.49038696289062
value loss:181.38658142089844
entropies:198.6350555419922
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.940648078918457 seconds
19 rew tensor(0.7519, dtype=torch.float64) delta_t tensor(0.5233, dtype=torch.float64)
19 gae_duplicate tensor(0.0339, dtype=torch.float64) tensor(-6.1264, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7136, dtype=torch.float64) delta_t tensor(0.5006, dtype=torch.float64)
18 gae_duplicate tensor(-0.0131, dtype=torch.float64) tensor(-4.4594, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6185, dtype=torch.float64) delta_t tensor(0.4769, dtype=torch.float64)
17 gae_duplicate tensor(-0.1807, dtype=torch.float64) tensor(-6.0727, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4605, dtype=torch.float64) delta_t tensor(0.3335, dtype=torch.float64)
16 gae_duplicate tensor(-0.8390, dtype=torch.float64) tensor(-4.1659, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7329, dtype=torch.float64) delta_t tensor(0.6648, dtype=torch.float64)
15 gae_duplicate tensor(0.4947, dtype=torch.float64) tensor(-6.9687, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7248, dtype=torch.float64) delta_t tensor(0.7270, dtype=torch.float64)
14 gae_duplicate tensor(0.5978, dtype=torch.float64) tensor(-8.6301, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6567, dtype=torch.float64) delta_t tensor(0.7367, dtype=torch.float64)
13 gae_duplicate tensor(0.2962, dtype=torch.float64) tensor(-8.3643, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4616, dtype=torch.float64) delta_t tensor(0.5697, dtype=torch.float64)
12 gae_duplicate tensor(0.1336, dtype=torch.float64) tensor(-7.5539, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4996, dtype=torch.float64) delta_t tensor(-0.4661, dtype=torch.float64)
11 gae_duplicate tensor(-4.4237, dtype=torch.float64) tensor(1.9679, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2693, dtype=torch.float64) delta_t tensor(0.3464, dtype=torch.float64)
10 gae_duplicate tensor(-0.6844, dtype=torch.float64) tensor(-3.0271, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7541, dtype=torch.float64) delta_t tensor(-0.7518, dtype=torch.float64)
9 gae_duplicate tensor(-4.4086, dtype=torch.float64) tensor(6.6069, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1493, dtype=torch.float64) delta_t tensor(-0.0145, dtype=torch.float64)
8 gae_duplicate tensor(-1.3705, dtype=torch.float64) tensor(0.0606, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2071, dtype=torch.float64) delta_t tensor(-0.0822, dtype=torch.float64)
7 gae_duplicate tensor(-0.7358, dtype=torch.float64) tensor(0.4233, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1550, dtype=torch.float64) delta_t tensor(0.0295, dtype=torch.float64)
6 gae_duplicate tensor(-0.7076, dtype=torch.float64) tensor(-0.0183, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5072, dtype=torch.float64) delta_t tensor(-0.2532, dtype=torch.float64)
5 gae_duplicate tensor(-1.2170, dtype=torch.float64) tensor(3.9729, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4747, dtype=torch.float64) delta_t tensor(-0.3199, dtype=torch.float64)
4 gae_duplicate tensor(-0.9050, dtype=torch.float64) tensor(3.9639, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9292, dtype=torch.float64) delta_t tensor(-0.6278, dtype=torch.float64)
3 gae_duplicate tensor(-1.2763, dtype=torch.float64) tensor(5.6260, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4218, dtype=torch.float64) delta_t tensor(-0.4351, dtype=torch.float64)
2 gae_duplicate tensor(-0.8361, dtype=torch.float64) tensor(7.6159, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:869.2267456054688
value loss:126.61634826660156
entropies:200.83729553222656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.020055055618286 seconds
19 rew tensor(0.7839, dtype=torch.float64) delta_t tensor(0.5458, dtype=torch.float64)
19 gae_duplicate tensor(0.2230, dtype=torch.float64) tensor(-6.3302, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7844, dtype=torch.float64) delta_t tensor(0.5846, dtype=torch.float64)
18 gae_duplicate tensor(0.4241, dtype=torch.float64) tensor(-6.4574, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7849, dtype=torch.float64) delta_t tensor(0.6088, dtype=torch.float64)
17 gae_duplicate tensor(0.5874, dtype=torch.float64) tensor(-10.1492, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7854, dtype=torch.float64) delta_t tensor(0.6308, dtype=torch.float64)
16 gae_duplicate tensor(0.5634, dtype=torch.float64) tensor(-7.6330, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7859, dtype=torch.float64) delta_t tensor(0.7249, dtype=torch.float64)
15 gae_duplicate tensor(0.5641, dtype=torch.float64) tensor(-8.6749, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7338, dtype=torch.float64) delta_t tensor(0.7792, dtype=torch.float64)
14 gae_duplicate tensor(0.7650, dtype=torch.float64) tensor(-8.3459, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6179, dtype=torch.float64) delta_t tensor(0.6949, dtype=torch.float64)
13 gae_duplicate tensor(0.4012, dtype=torch.float64) tensor(-8.9347, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5351, dtype=torch.float64) delta_t tensor(0.5320, dtype=torch.float64)
12 gae_duplicate tensor(0.3429, dtype=torch.float64) tensor(-6.0237, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3765, dtype=torch.float64) delta_t tensor(0.3396, dtype=torch.float64)
11 gae_duplicate tensor(0.1047, dtype=torch.float64) tensor(-4.8872, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1789, dtype=torch.float64) delta_t tensor(0.0635, dtype=torch.float64)
10 gae_duplicate tensor(-0.2631, dtype=torch.float64) tensor(-1.6753, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7815, dtype=torch.float64) delta_t tensor(-0.7511, dtype=torch.float64)
9 gae_duplicate tensor(-3.1259, dtype=torch.float64) tensor(5.8701, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2932, dtype=torch.float64) delta_t tensor(-0.1980, dtype=torch.float64)
8 gae_duplicate tensor(-1.6320, dtype=torch.float64) tensor(3.9247, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1496, dtype=torch.float64) delta_t tensor(0.3488, dtype=torch.float64)
7 gae_duplicate tensor(-0.2580, dtype=torch.float64) tensor(-3.5848, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6712, dtype=torch.float64) delta_t tensor(-0.4867, dtype=torch.float64)
6 gae_duplicate tensor(-1.1090, dtype=torch.float64) tensor(4.0157, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5339, dtype=torch.float64) delta_t tensor(-0.4949, dtype=torch.float64)
5 gae_duplicate tensor(-1.7417, dtype=torch.float64) tensor(5.5380, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9951, dtype=torch.float64) delta_t tensor(-0.7889, dtype=torch.float64)
4 gae_duplicate tensor(-1.9064, dtype=torch.float64) tensor(10.1822, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2679, dtype=torch.float64) delta_t tensor(-0.1007, dtype=torch.float64)
3 gae_duplicate tensor(-0.8240, dtype=torch.float64) tensor(2.4644, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5811, dtype=torch.float64) delta_t tensor(-0.5108, dtype=torch.float64)
2 gae_duplicate tensor(-1.0465, dtype=torch.float64) tensor(6.3986, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1199.424560546875
value loss:98.58187866210938
entropies:197.0720977783203
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.664879083633423 seconds
19 rew tensor(0.4728, dtype=torch.float64) delta_t tensor(0.3585, dtype=torch.float64)
19 gae_duplicate tensor(-1.2197, dtype=torch.float64) tensor(-6.0619, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7667, dtype=torch.float64) delta_t tensor(0.6397, dtype=torch.float64)
18 gae_duplicate tensor(0.4251, dtype=torch.float64) tensor(-7.1913, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6928, dtype=torch.float64) delta_t tensor(0.5622, dtype=torch.float64)
17 gae_duplicate tensor(0.3964, dtype=torch.float64) tensor(-7.3564, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6770, dtype=torch.float64) delta_t tensor(0.5254, dtype=torch.float64)
16 gae_duplicate tensor(0.1344, dtype=torch.float64) tensor(-8.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6012, dtype=torch.float64) delta_t tensor(0.4475, dtype=torch.float64)
15 gae_duplicate tensor(-0.2144, dtype=torch.float64) tensor(-5.7273, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5426, dtype=torch.float64) delta_t tensor(0.4530, dtype=torch.float64)
14 gae_duplicate tensor(-0.4808, dtype=torch.float64) tensor(-5.7040, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3970, dtype=torch.float64) delta_t tensor(0.2937, dtype=torch.float64)
13 gae_duplicate tensor(-0.1105, dtype=torch.float64) tensor(-4.7900, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4215, dtype=torch.float64) delta_t tensor(0.4173, dtype=torch.float64)
12 gae_duplicate tensor(-0.0025, dtype=torch.float64) tensor(-5.5337, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4206, dtype=torch.float64) delta_t tensor(0.4900, dtype=torch.float64)
11 gae_duplicate tensor(0.0206, dtype=torch.float64) tensor(-5.0855, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1916, dtype=torch.float64) delta_t tensor(0.1911, dtype=torch.float64)
10 gae_duplicate tensor(-0.5100, dtype=torch.float64) tensor(-3.6259, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3429, dtype=torch.float64) delta_t tensor(-0.3315, dtype=torch.float64)
9 gae_duplicate tensor(-2.7021, dtype=torch.float64) tensor(5.5992, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0306, dtype=torch.float64) delta_t tensor(-0.0999, dtype=torch.float64)
8 gae_duplicate tensor(-1.3493, dtype=torch.float64) tensor(2.4781, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8722, dtype=torch.float64) delta_t tensor(-0.8111, dtype=torch.float64)
7 gae_duplicate tensor(-3.7245, dtype=torch.float64) tensor(16.7131, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3316, dtype=torch.float64) delta_t tensor(-0.3366, dtype=torch.float64)
6 gae_duplicate tensor(-1.2898, dtype=torch.float64) tensor(5.9407, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1763, dtype=torch.float64) delta_t tensor(-0.9430, dtype=torch.float64)
5 gae_duplicate tensor(-2.3403, dtype=torch.float64) tensor(8.8537, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0751, dtype=torch.float64) delta_t tensor(-1.9793, dtype=torch.float64)
4 gae_duplicate tensor(-6.1769, dtype=torch.float64) tensor(25.8264, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1671, dtype=torch.float64) delta_t tensor(-0.0090, dtype=torch.float64)
3 gae_duplicate tensor(-0.6687, dtype=torch.float64) tensor(2.3725, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3770, dtype=torch.float64) delta_t tensor(-0.3683, dtype=torch.float64)
2 gae_duplicate tensor(-0.9087, dtype=torch.float64) tensor(3.7300, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-478.832275390625
value loss:207.2506561279297
entropies:198.0536651611328
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2412.8516)
ToM Target loss= tensor(1803.7953)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.975306987762451 seconds
19 rew tensor(0.7680, dtype=torch.float64) delta_t tensor(0.4701, dtype=torch.float64)
19 gae_duplicate tensor(0.1718, dtype=torch.float64) tensor(-6.2084, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7598, dtype=torch.float64) delta_t tensor(0.4753, dtype=torch.float64)
18 gae_duplicate tensor(0.2160, dtype=torch.float64) tensor(-5.4661, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7094, dtype=torch.float64) delta_t tensor(0.3885, dtype=torch.float64)
17 gae_duplicate tensor(0.1230, dtype=torch.float64) tensor(-5.1450, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6573, dtype=torch.float64) delta_t tensor(0.4436, dtype=torch.float64)
16 gae_duplicate tensor(-0.1229, dtype=torch.float64) tensor(-6.1196, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5376, dtype=torch.float64) delta_t tensor(0.3823, dtype=torch.float64)
15 gae_duplicate tensor(-0.6989, dtype=torch.float64) tensor(-4.6900, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7625, dtype=torch.float64) delta_t tensor(0.5845, dtype=torch.float64)
14 gae_duplicate tensor(0.3923, dtype=torch.float64) tensor(-7.3944, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6868, dtype=torch.float64) delta_t tensor(0.5341, dtype=torch.float64)
13 gae_duplicate tensor(0.3706, dtype=torch.float64) tensor(-4.9513, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4697, dtype=torch.float64) delta_t tensor(0.3620, dtype=torch.float64)
12 gae_duplicate tensor(-0.4520, dtype=torch.float64) tensor(-5.4935, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6020, dtype=torch.float64) delta_t tensor(0.5725, dtype=torch.float64)
11 gae_duplicate tensor(0.4303, dtype=torch.float64) tensor(-5.9260, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1287, dtype=torch.float64) delta_t tensor(-0.2888, dtype=torch.float64)
10 gae_duplicate tensor(-1.1508, dtype=torch.float64) tensor(3.1786, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3118, dtype=torch.float64) delta_t tensor(-0.1646, dtype=torch.float64)
9 gae_duplicate tensor(-1.6554, dtype=torch.float64) tensor(1.3296, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0491, dtype=torch.float64) delta_t tensor(0.1346, dtype=torch.float64)
8 gae_duplicate tensor(-0.8391, dtype=torch.float64) tensor(-1.0140, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8365, dtype=torch.float64) delta_t tensor(-0.8218, dtype=torch.float64)
7 gae_duplicate tensor(-3.0748, dtype=torch.float64) tensor(9.7547, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7544, dtype=torch.float64) delta_t tensor(-0.6824, dtype=torch.float64)
6 gae_duplicate tensor(-1.8860, dtype=torch.float64) tensor(7.8826, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0666, dtype=torch.float64) delta_t tensor(-1.0659, dtype=torch.float64)
5 gae_duplicate tensor(-2.0824, dtype=torch.float64) tensor(16.7223, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3144, dtype=torch.float64) delta_t tensor(-0.1702, dtype=torch.float64)
4 gae_duplicate tensor(-2.0421, dtype=torch.float64) tensor(2.0314, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6316, dtype=torch.float64) delta_t tensor(-0.4089, dtype=torch.float64)
3 gae_duplicate tensor(-0.7781, dtype=torch.float64) tensor(5.0602, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3466, dtype=torch.float64) delta_t tensor(-0.3354, dtype=torch.float64)
2 gae_duplicate tensor(-0.7573, dtype=torch.float64) tensor(4.9581, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:18.420982360839844
value loss:96.3753890991211
entropies:195.83453369140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.888615846633911 seconds
19 rew tensor(0.7862, dtype=torch.float64) delta_t tensor(0.5875, dtype=torch.float64)
19 gae_duplicate tensor(0.4514, dtype=torch.float64) tensor(-6.5651, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7784, dtype=torch.float64) delta_t tensor(0.5566, dtype=torch.float64)
18 gae_duplicate tensor(0.3835, dtype=torch.float64) tensor(-5.4171, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7706, dtype=torch.float64) delta_t tensor(0.5537, dtype=torch.float64)
17 gae_duplicate tensor(0.4184, dtype=torch.float64) tensor(-6.4130, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7468, dtype=torch.float64) delta_t tensor(0.5563, dtype=torch.float64)
16 gae_duplicate tensor(0.3758, dtype=torch.float64) tensor(-8.5560, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6711, dtype=torch.float64) delta_t tensor(0.4231, dtype=torch.float64)
15 gae_duplicate tensor(0.0268, dtype=torch.float64) tensor(-4.8824, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6134, dtype=torch.float64) delta_t tensor(0.4729, dtype=torch.float64)
14 gae_duplicate tensor(-0.4028, dtype=torch.float64) tensor(-6.0925, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6888, dtype=torch.float64) delta_t tensor(0.6437, dtype=torch.float64)
13 gae_duplicate tensor(0.2080, dtype=torch.float64) tensor(-8.5793, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4633, dtype=torch.float64) delta_t tensor(0.5812, dtype=torch.float64)
12 gae_duplicate tensor(0.3665, dtype=torch.float64) tensor(-7.7502, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2624, dtype=torch.float64) delta_t tensor(0.3156, dtype=torch.float64)
11 gae_duplicate tensor(-0.4002, dtype=torch.float64) tensor(-6.1482, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4059, dtype=torch.float64) delta_t tensor(0.3828, dtype=torch.float64)
10 gae_duplicate tensor(-0.4704, dtype=torch.float64) tensor(-3.2388, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2918, dtype=torch.float64) delta_t tensor(-0.2950, dtype=torch.float64)
9 gae_duplicate tensor(-2.5178, dtype=torch.float64) tensor(1.5527, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1981, dtype=torch.float64) delta_t tensor(-0.1709, dtype=torch.float64)
8 gae_duplicate tensor(-2.0569, dtype=torch.float64) tensor(2.0584, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5883, dtype=torch.float64) delta_t tensor(-0.5647, dtype=torch.float64)
7 gae_duplicate tensor(-3.2238, dtype=torch.float64) tensor(3.5309, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3126, dtype=torch.float64) delta_t tensor(-0.1767, dtype=torch.float64)
6 gae_duplicate tensor(-1.0290, dtype=torch.float64) tensor(2.0343, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1152, dtype=torch.float64) delta_t tensor(-1.0681, dtype=torch.float64)
5 gae_duplicate tensor(-1.8361, dtype=torch.float64) tensor(11.8780, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5532, dtype=torch.float64) delta_t tensor(-1.4103, dtype=torch.float64)
4 gae_duplicate tensor(-3.8568, dtype=torch.float64) tensor(19.7254, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3783, dtype=torch.float64) delta_t tensor(-0.1600, dtype=torch.float64)
3 gae_duplicate tensor(-0.9201, dtype=torch.float64) tensor(3.1251, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6664, dtype=torch.float64) delta_t tensor(-0.6444, dtype=torch.float64)
2 gae_duplicate tensor(-1.3773, dtype=torch.float64) tensor(10.4414, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:299.13507080078125
value loss:135.17080688476562
entropies:197.41102600097656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6735358238220215 seconds
19 rew tensor(0.7870, dtype=torch.float64) delta_t tensor(0.4689, dtype=torch.float64)
19 gae_duplicate tensor(0.2724, dtype=torch.float64) tensor(-3.6253, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7792, dtype=torch.float64) delta_t tensor(0.5575, dtype=torch.float64)
18 gae_duplicate tensor(0.3414, dtype=torch.float64) tensor(-6.1524, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7714, dtype=torch.float64) delta_t tensor(0.5049, dtype=torch.float64)
17 gae_duplicate tensor(0.3498, dtype=torch.float64) tensor(-6.7193, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7471, dtype=torch.float64) delta_t tensor(0.4685, dtype=torch.float64)
16 gae_duplicate tensor(0.1854, dtype=torch.float64) tensor(-6.4150, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7310, dtype=torch.float64) delta_t tensor(0.4487, dtype=torch.float64)
15 gae_duplicate tensor(-0.0202, dtype=torch.float64) tensor(-5.3301, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6340, dtype=torch.float64) delta_t tensor(0.3658, dtype=torch.float64)
14 gae_duplicate tensor(-0.5068, dtype=torch.float64) tensor(-3.7670, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7340, dtype=torch.float64) delta_t tensor(0.5972, dtype=torch.float64)
13 gae_duplicate tensor(0.1503, dtype=torch.float64) tensor(-6.1516, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5204, dtype=torch.float64) delta_t tensor(0.4281, dtype=torch.float64)
12 gae_duplicate tensor(0.0839, dtype=torch.float64) tensor(-6.5868, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4628, dtype=torch.float64) delta_t tensor(0.3355, dtype=torch.float64)
11 gae_duplicate tensor(-0.0902, dtype=torch.float64) tensor(-3.8463, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0556, dtype=torch.float64) delta_t tensor(0.0822, dtype=torch.float64)
10 gae_duplicate tensor(-1.4553, dtype=torch.float64) tensor(-1.4321, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1967, dtype=torch.float64) delta_t tensor(0.1404, dtype=torch.float64)
9 gae_duplicate tensor(-0.9111, dtype=torch.float64) tensor(-2.5481, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4848, dtype=torch.float64) delta_t tensor(-0.4151, dtype=torch.float64)
8 gae_duplicate tensor(-1.9022, dtype=torch.float64) tensor(5.1890, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5383, dtype=torch.float64) delta_t tensor(-0.4764, dtype=torch.float64)
7 gae_duplicate tensor(-2.3156, dtype=torch.float64) tensor(4.9470, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0958, dtype=torch.float64) delta_t tensor(-0.0373, dtype=torch.float64)
6 gae_duplicate tensor(-1.6402, dtype=torch.float64) tensor(3.0134, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1729, dtype=torch.float64) delta_t tensor(-1.0930, dtype=torch.float64)
5 gae_duplicate tensor(-1.6637, dtype=torch.float64) tensor(14.8588, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1420, dtype=torch.float64) delta_t tensor(-0.0487, dtype=torch.float64)
4 gae_duplicate tensor(-1.4722, dtype=torch.float64) tensor(1.5968, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5222, dtype=torch.float64) delta_t tensor(-0.4209, dtype=torch.float64)
3 gae_duplicate tensor(-1.1819, dtype=torch.float64) tensor(4.0718, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4803, dtype=torch.float64) delta_t tensor(-0.4665, dtype=torch.float64)
2 gae_duplicate tensor(-1.0679, dtype=torch.float64) tensor(7.0968, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:389.3433837890625
value loss:85.96035766601562
entropies:197.0616912841797
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.681672811508179 seconds
19 rew tensor(0.7178, dtype=torch.float64) delta_t tensor(0.3665, dtype=torch.float64)
19 gae_duplicate tensor(-0.0245, dtype=torch.float64) tensor(-3.8002, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6587, dtype=torch.float64) delta_t tensor(0.4216, dtype=torch.float64)
18 gae_duplicate tensor(-0.0612, dtype=torch.float64) tensor(-5.2715, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7865, dtype=torch.float64) delta_t tensor(0.5643, dtype=torch.float64)
17 gae_duplicate tensor(0.4596, dtype=torch.float64) tensor(-7.8302, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7869, dtype=torch.float64) delta_t tensor(0.5795, dtype=torch.float64)
16 gae_duplicate tensor(0.4724, dtype=torch.float64) tensor(-6.2791, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7789, dtype=torch.float64) delta_t tensor(0.5851, dtype=torch.float64)
15 gae_duplicate tensor(0.5151, dtype=torch.float64) tensor(-6.4336, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7305, dtype=torch.float64) delta_t tensor(0.6281, dtype=torch.float64)
14 gae_duplicate tensor(0.5282, dtype=torch.float64) tensor(-5.4828, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6567, dtype=torch.float64) delta_t tensor(0.5602, dtype=torch.float64)
13 gae_duplicate tensor(0.4404, dtype=torch.float64) tensor(-6.7558, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5926, dtype=torch.float64) delta_t tensor(0.4078, dtype=torch.float64)
12 gae_duplicate tensor(0.1090, dtype=torch.float64) tensor(-6.4484, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4470, dtype=torch.float64) delta_t tensor(0.3275, dtype=torch.float64)
11 gae_duplicate tensor(-0.5254, dtype=torch.float64) tensor(-4.4511, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4046, dtype=torch.float64) delta_t tensor(0.2328, dtype=torch.float64)
10 gae_duplicate tensor(-0.7747, dtype=torch.float64) tensor(-3.5651, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3474, dtype=torch.float64) delta_t tensor(-0.4749, dtype=torch.float64)
9 gae_duplicate tensor(-2.6893, dtype=torch.float64) tensor(6.3524, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4216, dtype=torch.float64) delta_t tensor(-0.5716, dtype=torch.float64)
8 gae_duplicate tensor(-2.1386, dtype=torch.float64) tensor(5.5893, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4682, dtype=torch.float64) delta_t tensor(-0.3572, dtype=torch.float64)
7 gae_duplicate tensor(-1.2631, dtype=torch.float64) tensor(4.6825, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1004, dtype=torch.float64) delta_t tensor(0.0603, dtype=torch.float64)
6 gae_duplicate tensor(-1.4312, dtype=torch.float64) tensor(-1.7427, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1440, dtype=torch.float64) delta_t tensor(-0.9352, dtype=torch.float64)
5 gae_duplicate tensor(-2.1364, dtype=torch.float64) tensor(10.3599, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2912, dtype=torch.float64) delta_t tensor(-1.3026, dtype=torch.float64)
4 gae_duplicate tensor(-7.8976, dtype=torch.float64) tensor(11.2889, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9350, dtype=torch.float64) delta_t tensor(-0.7224, dtype=torch.float64)
3 gae_duplicate tensor(-1.3287, dtype=torch.float64) tensor(8.5358, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3553, dtype=torch.float64) delta_t tensor(-0.4487, dtype=torch.float64)
2 gae_duplicate tensor(-0.8949, dtype=torch.float64) tensor(10.2350, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1.3106346130371094
value loss:178.63339233398438
entropies:196.05194091796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.80696177482605 seconds
19 rew tensor(0.7766, dtype=torch.float64) delta_t tensor(0.3919, dtype=torch.float64)
19 gae_duplicate tensor(0.0374, dtype=torch.float64) tensor(-2.6252, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7692, dtype=torch.float64) delta_t tensor(0.4029, dtype=torch.float64)
18 gae_duplicate tensor(0.0510, dtype=torch.float64) tensor(-3.7507, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7540, dtype=torch.float64) delta_t tensor(0.4939, dtype=torch.float64)
17 gae_duplicate tensor(0.1731, dtype=torch.float64) tensor(-7.2599, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7073, dtype=torch.float64) delta_t tensor(0.4837, dtype=torch.float64)
16 gae_duplicate tensor(0.0257, dtype=torch.float64) tensor(-7.8785, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6450, dtype=torch.float64) delta_t tensor(0.4732, dtype=torch.float64)
15 gae_duplicate tensor(-0.3192, dtype=torch.float64) tensor(-6.0249, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6313, dtype=torch.float64) delta_t tensor(0.6680, dtype=torch.float64)
14 gae_duplicate tensor(0.1146, dtype=torch.float64) tensor(-11.2682, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6759, dtype=torch.float64) delta_t tensor(0.6123, dtype=torch.float64)
13 gae_duplicate tensor(0.2824, dtype=torch.float64) tensor(-7.6032, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6763, dtype=torch.float64) delta_t tensor(0.7319, dtype=torch.float64)
12 gae_duplicate tensor(0.6694, dtype=torch.float64) tensor(-8.0724, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4688, dtype=torch.float64) delta_t tensor(0.5106, dtype=torch.float64)
11 gae_duplicate tensor(0.0710, dtype=torch.float64) tensor(-6.2842, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1946, dtype=torch.float64) delta_t tensor(0.1743, dtype=torch.float64)
10 gae_duplicate tensor(-0.2152, dtype=torch.float64) tensor(-1.8440, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2676, dtype=torch.float64) delta_t tensor(-1.4393, dtype=torch.float64)
9 gae_duplicate tensor(-6.0506, dtype=torch.float64) tensor(16.8451, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5762, dtype=torch.float64) delta_t tensor(-0.6108, dtype=torch.float64)
8 gae_duplicate tensor(-1.8272, dtype=torch.float64) tensor(10.7920, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3523, dtype=torch.float64) delta_t tensor(-0.2682, dtype=torch.float64)
7 gae_duplicate tensor(-1.1466, dtype=torch.float64) tensor(3.4135, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0228, dtype=torch.float64) delta_t tensor(-0.0523, dtype=torch.float64)
6 gae_duplicate tensor(-1.2705, dtype=torch.float64) tensor(1.4456, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2787, dtype=torch.float64) delta_t tensor(-1.0867, dtype=torch.float64)
5 gae_duplicate tensor(-1.5143, dtype=torch.float64) tensor(11.0548, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4358, dtype=torch.float64) delta_t tensor(-1.4309, dtype=torch.float64)
4 gae_duplicate tensor(-7.4133, dtype=torch.float64) tensor(22.2633, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5851, dtype=torch.float64) delta_t tensor(-0.4627, dtype=torch.float64)
3 gae_duplicate tensor(-1.2583, dtype=torch.float64) tensor(6.1085, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2812, dtype=torch.float64) delta_t tensor(-0.3170, dtype=torch.float64)
2 gae_duplicate tensor(-0.7318, dtype=torch.float64) tensor(3.2158, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-486.755859375
value loss:222.25653076171875
entropies:198.6859588623047
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2367.1750)
ToM Target loss= tensor(1802.7775)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.95320200920105 seconds
19 rew tensor(0.7777, dtype=torch.float64) delta_t tensor(0.3565, dtype=torch.float64)
19 gae_duplicate tensor(0.2152, dtype=torch.float64) tensor(-3.4701, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7536, dtype=torch.float64) delta_t tensor(0.3342, dtype=torch.float64)
18 gae_duplicate tensor(0.2164, dtype=torch.float64) tensor(-4.4467, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7290, dtype=torch.float64) delta_t tensor(0.3724, dtype=torch.float64)
17 gae_duplicate tensor(0.1548, dtype=torch.float64) tensor(-4.7672, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6797, dtype=torch.float64) delta_t tensor(0.3627, dtype=torch.float64)
16 gae_duplicate tensor(-0.0576, dtype=torch.float64) tensor(-4.7946, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5808, dtype=torch.float64) delta_t tensor(0.2943, dtype=torch.float64)
15 gae_duplicate tensor(-0.5759, dtype=torch.float64) tensor(-4.0097, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5659, dtype=torch.float64) delta_t tensor(0.3358, dtype=torch.float64)
14 gae_duplicate tensor(-0.4125, dtype=torch.float64) tensor(-4.9892, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7455, dtype=torch.float64) delta_t tensor(0.6108, dtype=torch.float64)
13 gae_duplicate tensor(0.1395, dtype=torch.float64) tensor(-7.3126, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5960, dtype=torch.float64) delta_t tensor(0.4271, dtype=torch.float64)
12 gae_duplicate tensor(0.1286, dtype=torch.float64) tensor(-4.9174, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5446, dtype=torch.float64) delta_t tensor(0.4052, dtype=torch.float64)
11 gae_duplicate tensor(-0.0680, dtype=torch.float64) tensor(-5.3028, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3506, dtype=torch.float64) delta_t tensor(0.1633, dtype=torch.float64)
10 gae_duplicate tensor(-0.5075, dtype=torch.float64) tensor(-1.8379, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3857, dtype=torch.float64) delta_t tensor(-0.4969, dtype=torch.float64)
9 gae_duplicate tensor(-1.7632, dtype=torch.float64) tensor(4.7096, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9392, dtype=torch.float64) delta_t tensor(-0.9179, dtype=torch.float64)
8 gae_duplicate tensor(-3.0035, dtype=torch.float64) tensor(7.1321, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8093, dtype=torch.float64) delta_t tensor(-0.9002, dtype=torch.float64)
7 gae_duplicate tensor(-2.2307, dtype=torch.float64) tensor(12.0090, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6620, dtype=torch.float64) delta_t tensor(-0.6549, dtype=torch.float64)
6 gae_duplicate tensor(-2.3604, dtype=torch.float64) tensor(5.7663, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7637, dtype=torch.float64) delta_t tensor(-0.7618, dtype=torch.float64)
5 gae_duplicate tensor(-1.8613, dtype=torch.float64) tensor(8.3667, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7101, dtype=torch.float64) delta_t tensor(-0.6048, dtype=torch.float64)
4 gae_duplicate tensor(-1.7890, dtype=torch.float64) tensor(8.6966, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4088, dtype=torch.float64) delta_t tensor(-0.3785, dtype=torch.float64)
3 gae_duplicate tensor(-1.3907, dtype=torch.float64) tensor(5.3674, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3303, dtype=torch.float64) delta_t tensor(-0.3168, dtype=torch.float64)
2 gae_duplicate tensor(-0.4985, dtype=torch.float64) tensor(3.7581, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-393.91455078125
value loss:110.85687255859375
entropies:196.90538024902344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.613782644271851 seconds
19 rew tensor(0.6608, dtype=torch.float64) delta_t tensor(0.3533, dtype=torch.float64)
19 gae_duplicate tensor(-0.0878, dtype=torch.float64) tensor(-3.9568, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7847, dtype=torch.float64) delta_t tensor(0.4913, dtype=torch.float64)
18 gae_duplicate tensor(0.3719, dtype=torch.float64) tensor(-6.1899, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7852, dtype=torch.float64) delta_t tensor(0.4850, dtype=torch.float64)
17 gae_duplicate tensor(0.3421, dtype=torch.float64) tensor(-8.1180, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7856, dtype=torch.float64) delta_t tensor(0.5094, dtype=torch.float64)
16 gae_duplicate tensor(0.3598, dtype=torch.float64) tensor(-5.4584, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7861, dtype=torch.float64) delta_t tensor(0.5216, dtype=torch.float64)
15 gae_duplicate tensor(0.2557, dtype=torch.float64) tensor(-4.8276, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7458, dtype=torch.float64) delta_t tensor(0.4740, dtype=torch.float64)
14 gae_duplicate tensor(0.2904, dtype=torch.float64) tensor(-5.9627, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6413, dtype=torch.float64) delta_t tensor(0.4190, dtype=torch.float64)
13 gae_duplicate tensor(0.1572, dtype=torch.float64) tensor(-5.0299, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5259, dtype=torch.float64) delta_t tensor(0.2909, dtype=torch.float64)
12 gae_duplicate tensor(-0.0490, dtype=torch.float64) tensor(-3.9857, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4746, dtype=torch.float64) delta_t tensor(0.2722, dtype=torch.float64)
11 gae_duplicate tensor(-0.1580, dtype=torch.float64) tensor(-3.6066, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3664, dtype=torch.float64) delta_t tensor(0.1570, dtype=torch.float64)
10 gae_duplicate tensor(-0.1796, dtype=torch.float64) tensor(-2.2428, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4118, dtype=torch.float64) delta_t tensor(-0.5945, dtype=torch.float64)
9 gae_duplicate tensor(-1.7310, dtype=torch.float64) tensor(6.2609, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4422, dtype=torch.float64) delta_t tensor(-0.5446, dtype=torch.float64)
8 gae_duplicate tensor(-2.1851, dtype=torch.float64) tensor(6.9337, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7844, dtype=torch.float64) delta_t tensor(-0.8662, dtype=torch.float64)
7 gae_duplicate tensor(-2.1774, dtype=torch.float64) tensor(12.0879, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3087, dtype=torch.float64) delta_t tensor(-1.2578, dtype=torch.float64)
6 gae_duplicate tensor(-2.6783, dtype=torch.float64) tensor(16.0632, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7575, dtype=torch.float64) delta_t tensor(-1.7476, dtype=torch.float64)
5 gae_duplicate tensor(-3.3226, dtype=torch.float64) tensor(23.2090, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1693, dtype=torch.float64) delta_t tensor(-2.1560, dtype=torch.float64)
4 gae_duplicate tensor(-8.8130, dtype=torch.float64) tensor(19.4939, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4438, dtype=torch.float64) delta_t tensor(-0.2794, dtype=torch.float64)
3 gae_duplicate tensor(-1.4285, dtype=torch.float64) tensor(3.7403, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2925, dtype=torch.float64) delta_t tensor(-0.4047, dtype=torch.float64)
2 gae_duplicate tensor(-0.6769, dtype=torch.float64) tensor(6.2209, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1642.287841796875
value loss:271.709228515625
entropies:197.5291748046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.970661163330078 seconds
19 rew tensor(0.7850, dtype=torch.float64) delta_t tensor(0.5179, dtype=torch.float64)
19 gae_duplicate tensor(0.3852, dtype=torch.float64) tensor(-5.3656, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7855, dtype=torch.float64) delta_t tensor(0.5040, dtype=torch.float64)
18 gae_duplicate tensor(0.3079, dtype=torch.float64) tensor(-4.8634, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7859, dtype=torch.float64) delta_t tensor(0.4951, dtype=torch.float64)
17 gae_duplicate tensor(0.3891, dtype=torch.float64) tensor(-6.2791, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7863, dtype=torch.float64) delta_t tensor(0.4586, dtype=torch.float64)
16 gae_duplicate tensor(0.3532, dtype=torch.float64) tensor(-5.0483, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7868, dtype=torch.float64) delta_t tensor(0.4510, dtype=torch.float64)
15 gae_duplicate tensor(0.3128, dtype=torch.float64) tensor(-5.9158, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7872, dtype=torch.float64) delta_t tensor(0.4106, dtype=torch.float64)
14 gae_duplicate tensor(0.2446, dtype=torch.float64) tensor(-5.8309, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6631, dtype=torch.float64) delta_t tensor(0.3966, dtype=torch.float64)
13 gae_duplicate tensor(-0.0156, dtype=torch.float64) tensor(-3.9778, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4836, dtype=torch.float64) delta_t tensor(0.2216, dtype=torch.float64)
12 gae_duplicate tensor(-0.2321, dtype=torch.float64) tensor(-3.8947, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1445, dtype=torch.float64) delta_t tensor(0.1036, dtype=torch.float64)
11 gae_duplicate tensor(-1.1591, dtype=torch.float64) tensor(0.4153, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2842, dtype=torch.float64) delta_t tensor(0.1480, dtype=torch.float64)
10 gae_duplicate tensor(-0.2717, dtype=torch.float64) tensor(-2.1226, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1785, dtype=torch.float64) delta_t tensor(0.1710, dtype=torch.float64)
9 gae_duplicate tensor(-0.5404, dtype=torch.float64) tensor(-2.0993, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1118, dtype=torch.float64) delta_t tensor(-0.1873, dtype=torch.float64)
8 gae_duplicate tensor(-0.7710, dtype=torch.float64) tensor(2.3600, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3083, dtype=torch.float64) delta_t tensor(-0.2814, dtype=torch.float64)
7 gae_duplicate tensor(-0.9789, dtype=torch.float64) tensor(3.3002, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4656, dtype=torch.float64) delta_t tensor(-0.4941, dtype=torch.float64)
6 gae_duplicate tensor(-1.4494, dtype=torch.float64) tensor(8.1918, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5920, dtype=torch.float64) delta_t tensor(-0.4332, dtype=torch.float64)
5 gae_duplicate tensor(-1.0768, dtype=torch.float64) tensor(5.0448, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3067, dtype=torch.float64) delta_t tensor(-0.0805, dtype=torch.float64)
4 gae_duplicate tensor(-0.5985, dtype=torch.float64) tensor(1.4898, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4789, dtype=torch.float64) delta_t tensor(-0.5192, dtype=torch.float64)
3 gae_duplicate tensor(-1.4101, dtype=torch.float64) tensor(9.7275, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2608, dtype=torch.float64) delta_t tensor(-0.4060, dtype=torch.float64)
2 gae_duplicate tensor(-0.9382, dtype=torch.float64) tensor(3.4137, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:376.5126953125
value loss:52.94131851196289
entropies:199.16607666015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.954594135284424 seconds
19 rew tensor(0.7764, dtype=torch.float64) delta_t tensor(0.4877, dtype=torch.float64)
19 gae_duplicate tensor(0.2515, dtype=torch.float64) tensor(-3.7774, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7768, dtype=torch.float64) delta_t tensor(0.4708, dtype=torch.float64)
18 gae_duplicate tensor(0.1552, dtype=torch.float64) tensor(-7.3611, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7537, dtype=torch.float64) delta_t tensor(0.4569, dtype=torch.float64)
17 gae_duplicate tensor(0.1516, dtype=torch.float64) tensor(-4.6660, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7385, dtype=torch.float64) delta_t tensor(0.4970, dtype=torch.float64)
16 gae_duplicate tensor(0.1139, dtype=torch.float64) tensor(-5.0746, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6730, dtype=torch.float64) delta_t tensor(0.5625, dtype=torch.float64)
15 gae_duplicate tensor(-0.1166, dtype=torch.float64) tensor(-6.4702, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5248, dtype=torch.float64) delta_t tensor(0.4622, dtype=torch.float64)
14 gae_duplicate tensor(-0.5022, dtype=torch.float64) tensor(-5.7418, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5722, dtype=torch.float64) delta_t tensor(0.5077, dtype=torch.float64)
13 gae_duplicate tensor(0.0314, dtype=torch.float64) tensor(-3.9518, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3398, dtype=torch.float64) delta_t tensor(0.2877, dtype=torch.float64)
12 gae_duplicate tensor(-0.1440, dtype=torch.float64) tensor(-3.6531, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1902, dtype=torch.float64) delta_t tensor(0.0651, dtype=torch.float64)
11 gae_duplicate tensor(-0.5689, dtype=torch.float64) tensor(-1.2450, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0569, dtype=torch.float64) delta_t tensor(-0.1676, dtype=torch.float64)
10 gae_duplicate tensor(-1.0850, dtype=torch.float64) tensor(0.0335, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0585, dtype=torch.float64) delta_t tensor(-0.0681, dtype=torch.float64)
9 gae_duplicate tensor(-1.5532, dtype=torch.float64) tensor(2.5011, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4423, dtype=torch.float64) delta_t tensor(-0.5164, dtype=torch.float64)
8 gae_duplicate tensor(-1.8973, dtype=torch.float64) tensor(5.0039, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5122, dtype=torch.float64) delta_t tensor(-0.6133, dtype=torch.float64)
7 gae_duplicate tensor(-2.8328, dtype=torch.float64) tensor(5.3949, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9880, dtype=torch.float64) delta_t tensor(-0.9964, dtype=torch.float64)
6 gae_duplicate tensor(-2.4728, dtype=torch.float64) tensor(13.8300, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1000, dtype=torch.float64) delta_t tensor(-1.1691, dtype=torch.float64)
5 gae_duplicate tensor(-2.9312, dtype=torch.float64) tensor(13.8388, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2567, dtype=torch.float64) delta_t tensor(-2.1141, dtype=torch.float64)
4 gae_duplicate tensor(-8.7308, dtype=torch.float64) tensor(18.9751, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4777, dtype=torch.float64) delta_t tensor(-0.4673, dtype=torch.float64)
3 gae_duplicate tensor(-1.2915, dtype=torch.float64) tensor(9.0678, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1065, dtype=torch.float64) delta_t tensor(-0.2103, dtype=torch.float64)
2 gae_duplicate tensor(-0.4718, dtype=torch.float64) tensor(3.0338, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1106.324951171875
value loss:245.0249786376953
entropies:198.698486328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.628722906112671 seconds
19 rew tensor(0.7161, dtype=torch.float64) delta_t tensor(0.1943, dtype=torch.float64)
19 gae_duplicate tensor(-0.3186, dtype=torch.float64) tensor(-1.4286, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6926, dtype=torch.float64) delta_t tensor(0.2675, dtype=torch.float64)
18 gae_duplicate tensor(-0.3371, dtype=torch.float64) tensor(-2.1588, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5968, dtype=torch.float64) delta_t tensor(0.2203, dtype=torch.float64)
17 gae_duplicate tensor(-0.6546, dtype=torch.float64) tensor(-3.6333, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4202, dtype=torch.float64) delta_t tensor(0.0441, dtype=torch.float64)
16 gae_duplicate tensor(-1.3781, dtype=torch.float64) tensor(-2.5188, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6832, dtype=torch.float64) delta_t tensor(0.4066, dtype=torch.float64)
15 gae_duplicate tensor(0.0862, dtype=torch.float64) tensor(-5.2534, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5770, dtype=torch.float64) delta_t tensor(0.2812, dtype=torch.float64)
14 gae_duplicate tensor(-0.3723, dtype=torch.float64) tensor(-2.9397, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6750, dtype=torch.float64) delta_t tensor(0.3985, dtype=torch.float64)
13 gae_duplicate tensor(0.1329, dtype=torch.float64) tensor(-3.5781, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6923, dtype=torch.float64) delta_t tensor(0.4959, dtype=torch.float64)
12 gae_duplicate tensor(0.0812, dtype=torch.float64) tensor(-3.8434, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7417, dtype=torch.float64) delta_t tensor(0.5558, dtype=torch.float64)
11 gae_duplicate tensor(0.1720, dtype=torch.float64) tensor(-5.3862, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5727, dtype=torch.float64) delta_t tensor(0.2989, dtype=torch.float64)
10 gae_duplicate tensor(0.1551, dtype=torch.float64) tensor(-3.4016, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0789, dtype=torch.float64) delta_t tensor(-1.3385, dtype=torch.float64)
9 gae_duplicate tensor(-3.5216, dtype=torch.float64) tensor(15.4740, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1772, dtype=torch.float64) delta_t tensor(-1.3857, dtype=torch.float64)
8 gae_duplicate tensor(-3.2076, dtype=torch.float64) tensor(18.9227, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5785, dtype=torch.float64) delta_t tensor(-0.7390, dtype=torch.float64)
7 gae_duplicate tensor(-2.5092, dtype=torch.float64) tensor(11.2206, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3657, dtype=torch.float64) delta_t tensor(-1.5555, dtype=torch.float64)
6 gae_duplicate tensor(-3.3688, dtype=torch.float64) tensor(22.3178, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5281, dtype=torch.float64) delta_t tensor(-1.5415, dtype=torch.float64)
5 gae_duplicate tensor(-2.7403, dtype=torch.float64) tensor(16.0443, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0477, dtype=torch.float64) delta_t tensor(-4.0005, dtype=torch.float64)
4 gae_duplicate tensor(-8.4798, dtype=torch.float64) tensor(61.2154, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2605, dtype=torch.float64) delta_t tensor(-0.2122, dtype=torch.float64)
3 gae_duplicate tensor(-0.9131, dtype=torch.float64) tensor(6.7341, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1460, dtype=torch.float64) delta_t tensor(-0.1991, dtype=torch.float64)
2 gae_duplicate tensor(-0.6469, dtype=torch.float64) tensor(3.1369, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4388.5849609375
value loss:429.5675354003906
entropies:196.22804260253906
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2362.0347)
ToM Target loss= tensor(1801.7893)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.149005889892578 seconds
19 rew tensor(0.7146, dtype=torch.float64) delta_t tensor(0.3900, dtype=torch.float64)
19 gae_duplicate tensor(-0.1269, dtype=torch.float64) tensor(-4.2705, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6412, dtype=torch.float64) delta_t tensor(0.2370, dtype=torch.float64)
18 gae_duplicate tensor(-0.3377, dtype=torch.float64) tensor(-3.0090, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5186, dtype=torch.float64) delta_t tensor(0.1803, dtype=torch.float64)
17 gae_duplicate tensor(-0.9412, dtype=torch.float64) tensor(-1.5555, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7727, dtype=torch.float64) delta_t tensor(0.5065, dtype=torch.float64)
16 gae_duplicate tensor(0.3650, dtype=torch.float64) tensor(-6.2155, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7566, dtype=torch.float64) delta_t tensor(0.4929, dtype=torch.float64)
15 gae_duplicate tensor(0.3421, dtype=torch.float64) tensor(-6.8774, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7404, dtype=torch.float64) delta_t tensor(0.4078, dtype=torch.float64)
14 gae_duplicate tensor(0.1205, dtype=torch.float64) tensor(-4.5467, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6598, dtype=torch.float64) delta_t tensor(0.3546, dtype=torch.float64)
13 gae_duplicate tensor(-0.0350, dtype=torch.float64) tensor(-5.4676, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0323, dtype=torch.float64) delta_t tensor(-0.2678, dtype=torch.float64)
12 gae_duplicate tensor(-3.2139, dtype=torch.float64) tensor(3.2423, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4818, dtype=torch.float64) delta_t tensor(0.1773, dtype=torch.float64)
11 gae_duplicate tensor(-0.8414, dtype=torch.float64) tensor(0.1807, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5972, dtype=torch.float64) delta_t tensor(0.3798, dtype=torch.float64)
10 gae_duplicate tensor(0.1143, dtype=torch.float64) tensor(-3.3027, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3659, dtype=torch.float64) delta_t tensor(-0.5758, dtype=torch.float64)
9 gae_duplicate tensor(-2.3713, dtype=torch.float64) tensor(4.0206, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5500, dtype=torch.float64) delta_t tensor(-0.7869, dtype=torch.float64)
8 gae_duplicate tensor(-3.0534, dtype=torch.float64) tensor(9.6448, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2910, dtype=torch.float64) delta_t tensor(-1.5308, dtype=torch.float64)
7 gae_duplicate tensor(-3.0933, dtype=torch.float64) tensor(22.3540, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9846, dtype=torch.float64) delta_t tensor(-1.0568, dtype=torch.float64)
6 gae_duplicate tensor(-2.4940, dtype=torch.float64) tensor(16.7892, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3712, dtype=torch.float64) delta_t tensor(-1.2983, dtype=torch.float64)
5 gae_duplicate tensor(-2.1562, dtype=torch.float64) tensor(18.2739, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6828, dtype=torch.float64) delta_t tensor(-1.5590, dtype=torch.float64)
4 gae_duplicate tensor(-6.7014, dtype=torch.float64) tensor(18.7539, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5696, dtype=torch.float64) delta_t tensor(-0.5419, dtype=torch.float64)
3 gae_duplicate tensor(-1.4585, dtype=torch.float64) tensor(7.6931, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1775, dtype=torch.float64) delta_t tensor(-0.3114, dtype=torch.float64)
2 gae_duplicate tensor(-0.5284, dtype=torch.float64) tensor(3.4311, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2524.4052734375
value loss:238.66456604003906
entropies:196.73419189453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9622437953948975 seconds
19 rew tensor(0.7089, dtype=torch.float64) delta_t tensor(0.3610, dtype=torch.float64)
19 gae_duplicate tensor(-0.2181, dtype=torch.float64) tensor(-5.2247, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6224, dtype=torch.float64) delta_t tensor(0.2943, dtype=torch.float64)
18 gae_duplicate tensor(-0.4574, dtype=torch.float64) tensor(-2.5508, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4641, dtype=torch.float64) delta_t tensor(0.1546, dtype=torch.float64)
17 gae_duplicate tensor(-1.1244, dtype=torch.float64) tensor(-1.7853, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7246, dtype=torch.float64) delta_t tensor(0.4740, dtype=torch.float64)
16 gae_duplicate tensor(0.1515, dtype=torch.float64) tensor(-5.0582, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7018, dtype=torch.float64) delta_t tensor(0.5351, dtype=torch.float64)
15 gae_duplicate tensor(0.0915, dtype=torch.float64) tensor(-6.3632, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5578, dtype=torch.float64) delta_t tensor(0.3884, dtype=torch.float64)
14 gae_duplicate tensor(-0.0647, dtype=torch.float64) tensor(-3.8524, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5842, dtype=torch.float64) delta_t tensor(0.4260, dtype=torch.float64)
13 gae_duplicate tensor(0.0583, dtype=torch.float64) tensor(-3.9687, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4638, dtype=torch.float64) delta_t tensor(0.2041, dtype=torch.float64)
12 gae_duplicate tensor(-0.3840, dtype=torch.float64) tensor(-3.0184, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4104, dtype=torch.float64) delta_t tensor(0.0974, dtype=torch.float64)
11 gae_duplicate tensor(-0.4723, dtype=torch.float64) tensor(-1.8628, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2781, dtype=torch.float64) delta_t tensor(0.1032, dtype=torch.float64)
10 gae_duplicate tensor(-0.7733, dtype=torch.float64) tensor(-0.9330, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0820, dtype=torch.float64) delta_t tensor(-0.2942, dtype=torch.float64)
9 gae_duplicate tensor(-1.6260, dtype=torch.float64) tensor(1.6959, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6999, dtype=torch.float64) delta_t tensor(-0.8005, dtype=torch.float64)
8 gae_duplicate tensor(-1.8835, dtype=torch.float64) tensor(10.0832, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5954, dtype=torch.float64) delta_t tensor(-0.6516, dtype=torch.float64)
7 gae_duplicate tensor(-2.8747, dtype=torch.float64) tensor(9.4321, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.6870, dtype=torch.float64) delta_t tensor(-1.6505, dtype=torch.float64)
6 gae_duplicate tensor(-4.4578, dtype=torch.float64) tensor(17.5772, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6563, dtype=torch.float64) delta_t tensor(-0.6619, dtype=torch.float64)
5 gae_duplicate tensor(-2.0772, dtype=torch.float64) tensor(8.5028, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4028, dtype=torch.float64) delta_t tensor(-2.2992, dtype=torch.float64)
4 gae_duplicate tensor(-6.6930, dtype=torch.float64) tensor(31.0909, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2528, dtype=torch.float64) delta_t tensor(-0.2601, dtype=torch.float64)
3 gae_duplicate tensor(-1.4175, dtype=torch.float64) tensor(6.6129, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4001, dtype=torch.float64) delta_t tensor(-0.4042, dtype=torch.float64)
2 gae_duplicate tensor(-1.3035, dtype=torch.float64) tensor(4.5311, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2011.9132080078125
value loss:232.55368041992188
entropies:195.5457000732422
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1619250774383545 seconds
19 rew tensor(0.7813, dtype=torch.float64) delta_t tensor(0.3841, dtype=torch.float64)
19 gae_duplicate tensor(0.1724, dtype=torch.float64) tensor(-5.1307, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7817, dtype=torch.float64) delta_t tensor(0.2906, dtype=torch.float64)
18 gae_duplicate tensor(0.1527, dtype=torch.float64) tensor(-3.2207, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7738, dtype=torch.float64) delta_t tensor(0.3944, dtype=torch.float64)
17 gae_duplicate tensor(0.3223, dtype=torch.float64) tensor(-5.6462, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7742, dtype=torch.float64) delta_t tensor(0.4066, dtype=torch.float64)
16 gae_duplicate tensor(0.3650, dtype=torch.float64) tensor(-3.9906, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7664, dtype=torch.float64) delta_t tensor(0.4218, dtype=torch.float64)
15 gae_duplicate tensor(0.3493, dtype=torch.float64) tensor(-4.2370, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7338, dtype=torch.float64) delta_t tensor(0.3805, dtype=torch.float64)
14 gae_duplicate tensor(-0.0163, dtype=torch.float64) tensor(-2.9559, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6127, dtype=torch.float64) delta_t tensor(0.2739, dtype=torch.float64)
13 gae_duplicate tensor(-0.2163, dtype=torch.float64) tensor(-2.1634, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6287, dtype=torch.float64) delta_t tensor(0.3584, dtype=torch.float64)
12 gae_duplicate tensor(0.1474, dtype=torch.float64) tensor(-2.8936, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5693, dtype=torch.float64) delta_t tensor(0.4013, dtype=torch.float64)
11 gae_duplicate tensor(0.1211, dtype=torch.float64) tensor(-5.4867, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1030, dtype=torch.float64) delta_t tensor(-0.1134, dtype=torch.float64)
10 gae_duplicate tensor(-0.6889, dtype=torch.float64) tensor(1.7538, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0021, dtype=torch.float64) delta_t tensor(-0.1056, dtype=torch.float64)
9 gae_duplicate tensor(-0.4679, dtype=torch.float64) tensor(0.8682, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1182, dtype=torch.float64) delta_t tensor(-0.2424, dtype=torch.float64)
8 gae_duplicate tensor(-0.8694, dtype=torch.float64) tensor(3.3477, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2624, dtype=torch.float64) delta_t tensor(-0.2316, dtype=torch.float64)
7 gae_duplicate tensor(-0.7798, dtype=torch.float64) tensor(2.0367, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5836, dtype=torch.float64) delta_t tensor(-0.4615, dtype=torch.float64)
6 gae_duplicate tensor(-1.2206, dtype=torch.float64) tensor(5.0773, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8981, dtype=torch.float64) delta_t tensor(-0.8175, dtype=torch.float64)
5 gae_duplicate tensor(-2.1782, dtype=torch.float64) tensor(12.0904, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7553, dtype=torch.float64) delta_t tensor(-0.7243, dtype=torch.float64)
4 gae_duplicate tensor(-1.9659, dtype=torch.float64) tensor(6.6139, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4593, dtype=torch.float64) delta_t tensor(-0.3578, dtype=torch.float64)
3 gae_duplicate tensor(-1.1670, dtype=torch.float64) tensor(5.5941, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7913, dtype=torch.float64) delta_t tensor(-0.8007, dtype=torch.float64)
2 gae_duplicate tensor(-1.0638, dtype=torch.float64) tensor(9.2357, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-426.9674072265625
value loss:62.17423629760742
entropies:193.4039764404297
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.090602874755859 seconds
19 rew tensor(0.7589, dtype=torch.float64) delta_t tensor(0.2177, dtype=torch.float64)
19 gae_duplicate tensor(0.0456, dtype=torch.float64) tensor(-1.9528, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7259, dtype=torch.float64) delta_t tensor(0.2765, dtype=torch.float64)
18 gae_duplicate tensor(-0.0377, dtype=torch.float64) tensor(-3.6008, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6698, dtype=torch.float64) delta_t tensor(0.3338, dtype=torch.float64)
17 gae_duplicate tensor(-0.0100, dtype=torch.float64) tensor(-3.8468, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5652, dtype=torch.float64) delta_t tensor(0.3001, dtype=torch.float64)
16 gae_duplicate tensor(-0.2067, dtype=torch.float64) tensor(-4.5149, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3788, dtype=torch.float64) delta_t tensor(0.2066, dtype=torch.float64)
15 gae_duplicate tensor(-0.7304, dtype=torch.float64) tensor(-3.4996, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7058, dtype=torch.float64) delta_t tensor(0.5567, dtype=torch.float64)
14 gae_duplicate tensor(0.4081, dtype=torch.float64) tensor(-5.4119, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6640, dtype=torch.float64) delta_t tensor(0.5351, dtype=torch.float64)
13 gae_duplicate tensor(0.2758, dtype=torch.float64) tensor(-4.2189, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1402, dtype=torch.float64) delta_t tensor(0.1694, dtype=torch.float64)
12 gae_duplicate tensor(-1.1041, dtype=torch.float64) tensor(-2.5358, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0169, dtype=torch.float64) delta_t tensor(-0.1361, dtype=torch.float64)
11 gae_duplicate tensor(-2.1210, dtype=torch.float64) tensor(0.5398, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0828, dtype=torch.float64) delta_t tensor(-0.1806, dtype=torch.float64)
10 gae_duplicate tensor(-0.9799, dtype=torch.float64) tensor(1.8822, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2037, dtype=torch.float64) delta_t tensor(-0.3123, dtype=torch.float64)
9 gae_duplicate tensor(-1.1844, dtype=torch.float64) tensor(2.7829, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4279, dtype=torch.float64) delta_t tensor(-0.5256, dtype=torch.float64)
8 gae_duplicate tensor(-1.7238, dtype=torch.float64) tensor(4.5900, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2324, dtype=torch.float64) delta_t tensor(-0.2954, dtype=torch.float64)
7 gae_duplicate tensor(-0.6339, dtype=torch.float64) tensor(2.8861, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5809, dtype=torch.float64) delta_t tensor(-0.6100, dtype=torch.float64)
6 gae_duplicate tensor(-2.3012, dtype=torch.float64) tensor(4.2553, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8392, dtype=torch.float64) delta_t tensor(-0.7220, dtype=torch.float64)
5 gae_duplicate tensor(-2.2118, dtype=torch.float64) tensor(9.5794, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2523, dtype=torch.float64) delta_t tensor(-0.1500, dtype=torch.float64)
4 gae_duplicate tensor(-1.8700, dtype=torch.float64) tensor(1.2051, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0882, dtype=torch.float64) delta_t tensor(0.0719, dtype=torch.float64)
3 gae_duplicate tensor(-0.5380, dtype=torch.float64) tensor(-0.7960, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3442, dtype=torch.float64) delta_t tensor(-0.4304, dtype=torch.float64)
2 gae_duplicate tensor(-0.6173, dtype=torch.float64) tensor(4.3686, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-96.39115142822266
value loss:84.5903549194336
entropies:193.13046264648438
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.545107126235962 seconds
19 rew tensor(0.7832, dtype=torch.float64) delta_t tensor(0.2945, dtype=torch.float64)
19 gae_duplicate tensor(0.0541, dtype=torch.float64) tensor(-3.2555, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7835, dtype=torch.float64) delta_t tensor(0.2988, dtype=torch.float64)
18 gae_duplicate tensor(0.1767, dtype=torch.float64) tensor(-2.5114, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7839, dtype=torch.float64) delta_t tensor(0.4008, dtype=torch.float64)
17 gae_duplicate tensor(0.3242, dtype=torch.float64) tensor(-4.2792, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7843, dtype=torch.float64) delta_t tensor(0.4864, dtype=torch.float64)
16 gae_duplicate tensor(0.3292, dtype=torch.float64) tensor(-6.1234, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7847, dtype=torch.float64) delta_t tensor(0.5950, dtype=torch.float64)
15 gae_duplicate tensor(0.3879, dtype=torch.float64) tensor(-6.9196, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7851, dtype=torch.float64) delta_t tensor(0.6023, dtype=torch.float64)
14 gae_duplicate tensor(0.4305, dtype=torch.float64) tensor(-7.6574, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7855, dtype=torch.float64) delta_t tensor(0.6217, dtype=torch.float64)
13 gae_duplicate tensor(0.4578, dtype=torch.float64) tensor(-8.0866, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7034, dtype=torch.float64) delta_t tensor(0.6005, dtype=torch.float64)
12 gae_duplicate tensor(0.4583, dtype=torch.float64) tensor(-6.4447, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6787, dtype=torch.float64) delta_t tensor(0.5929, dtype=torch.float64)
11 gae_duplicate tensor(0.2288, dtype=torch.float64) tensor(-6.4785, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5372, dtype=torch.float64) delta_t tensor(0.3659, dtype=torch.float64)
10 gae_duplicate tensor(-0.3312, dtype=torch.float64) tensor(-4.5921, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5743, dtype=torch.float64) delta_t tensor(-0.7190, dtype=torch.float64)
9 gae_duplicate tensor(-2.8857, dtype=torch.float64) tensor(4.2969, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6765, dtype=torch.float64) delta_t tensor(-0.8194, dtype=torch.float64)
8 gae_duplicate tensor(-1.4747, dtype=torch.float64) tensor(8.3036, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0415, dtype=torch.float64) delta_t tensor(-1.0722, dtype=torch.float64)
7 gae_duplicate tensor(-2.2957, dtype=torch.float64) tensor(11.1307, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4919, dtype=torch.float64) delta_t tensor(-1.4846, dtype=torch.float64)
6 gae_duplicate tensor(-2.6589, dtype=torch.float64) tensor(20.1043, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3392, dtype=torch.float64) delta_t tensor(-1.2588, dtype=torch.float64)
5 gae_duplicate tensor(-1.9872, dtype=torch.float64) tensor(15.9350, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8150, dtype=torch.float64) delta_t tensor(-1.7431, dtype=torch.float64)
4 gae_duplicate tensor(-5.0842, dtype=torch.float64) tensor(18.6026, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1131, dtype=torch.float64) delta_t tensor(-0.0413, dtype=torch.float64)
3 gae_duplicate tensor(-0.5521, dtype=torch.float64) tensor(2.4736, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2270, dtype=torch.float64) delta_t tensor(-0.2750, dtype=torch.float64)
2 gae_duplicate tensor(-0.4490, dtype=torch.float64) tensor(2.3375, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1000.5501098632812
value loss:184.99896240234375
entropies:191.46298217773438
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2380.7310)
ToM Target loss= tensor(1802.6786)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.019745111465454 seconds
19 rew tensor(0.7509, dtype=torch.float64) delta_t tensor(0.3379, dtype=torch.float64)
19 gae_duplicate tensor(0.1458, dtype=torch.float64) tensor(-3.9637, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7265, dtype=torch.float64) delta_t tensor(0.3470, dtype=torch.float64)
18 gae_duplicate tensor(0.0841, dtype=torch.float64) tensor(-3.6004, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6675, dtype=torch.float64) delta_t tensor(0.2917, dtype=torch.float64)
17 gae_duplicate tensor(-0.0134, dtype=torch.float64) tensor(-3.7214, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5836, dtype=torch.float64) delta_t tensor(0.2301, dtype=torch.float64)
16 gae_duplicate tensor(-0.3376, dtype=torch.float64) tensor(-4.0319, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3909, dtype=torch.float64) delta_t tensor(0.2253, dtype=torch.float64)
15 gae_duplicate tensor(-0.5610, dtype=torch.float64) tensor(-1.9222, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6472, dtype=torch.float64) delta_t tensor(0.4321, dtype=torch.float64)
14 gae_duplicate tensor(-0.0618, dtype=torch.float64) tensor(-4.3112, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5757, dtype=torch.float64) delta_t tensor(0.6138, dtype=torch.float64)
13 gae_duplicate tensor(0.2629, dtype=torch.float64) tensor(-6.5902, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5652, dtype=torch.float64) delta_t tensor(0.4304, dtype=torch.float64)
12 gae_duplicate tensor(-0.2123, dtype=torch.float64) tensor(-4.4492, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4272, dtype=torch.float64) delta_t tensor(0.2473, dtype=torch.float64)
11 gae_duplicate tensor(-0.2911, dtype=torch.float64) tensor(-4.9947, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2407, dtype=torch.float64) delta_t tensor(-0.4674, dtype=torch.float64)
10 gae_duplicate tensor(-2.4963, dtype=torch.float64) tensor(6.3347, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2809, dtype=torch.float64) delta_t tensor(0.1552, dtype=torch.float64)
9 gae_duplicate tensor(-0.8811, dtype=torch.float64) tensor(-2.2943, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0427, dtype=torch.float64) delta_t tensor(0.1213, dtype=torch.float64)
8 gae_duplicate tensor(-0.2270, dtype=torch.float64) tensor(-1.9609, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3203, dtype=torch.float64) delta_t tensor(-0.3927, dtype=torch.float64)
7 gae_duplicate tensor(-1.3886, dtype=torch.float64) tensor(5.1716, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1104, dtype=torch.float64) delta_t tensor(-1.1811, dtype=torch.float64)
6 gae_duplicate tensor(-2.6368, dtype=torch.float64) tensor(9.6626, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0715, dtype=torch.float64) delta_t tensor(-1.1484, dtype=torch.float64)
5 gae_duplicate tensor(-2.0638, dtype=torch.float64) tensor(17.2188, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0928, dtype=torch.float64) delta_t tensor(0.1164, dtype=torch.float64)
4 gae_duplicate tensor(-0.4711, dtype=torch.float64) tensor(0.8606, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9255, dtype=torch.float64) delta_t tensor(-0.7569, dtype=torch.float64)
3 gae_duplicate tensor(-1.4682, dtype=torch.float64) tensor(6.1471, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3592, dtype=torch.float64) delta_t tensor(-0.4896, dtype=torch.float64)
2 gae_duplicate tensor(-1.3255, dtype=torch.float64) tensor(7.6000, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-435.9768371582031
value loss:93.2039794921875
entropies:191.03868103027344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.972327947616577 seconds
19 rew tensor(0.7845, dtype=torch.float64) delta_t tensor(0.3740, dtype=torch.float64)
19 gae_duplicate tensor(0.0588, dtype=torch.float64) tensor(-4.1609, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7849, dtype=torch.float64) delta_t tensor(0.4317, dtype=torch.float64)
18 gae_duplicate tensor(0.2174, dtype=torch.float64) tensor(-4.5298, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7852, dtype=torch.float64) delta_t tensor(0.5123, dtype=torch.float64)
17 gae_duplicate tensor(0.3120, dtype=torch.float64) tensor(-5.7748, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7856, dtype=torch.float64) delta_t tensor(0.3817, dtype=torch.float64)
16 gae_duplicate tensor(0.2695, dtype=torch.float64) tensor(-3.0923, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7684, dtype=torch.float64) delta_t tensor(0.5494, dtype=torch.float64)
15 gae_duplicate tensor(0.3329, dtype=torch.float64) tensor(-7.4961, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7688, dtype=torch.float64) delta_t tensor(0.5395, dtype=torch.float64)
14 gae_duplicate tensor(0.4670, dtype=torch.float64) tensor(-6.2438, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6526, dtype=torch.float64) delta_t tensor(0.6401, dtype=torch.float64)
13 gae_duplicate tensor(0.4125, dtype=torch.float64) tensor(-5.7471, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6181, dtype=torch.float64) delta_t tensor(0.5523, dtype=torch.float64)
12 gae_duplicate tensor(0.2303, dtype=torch.float64) tensor(-5.4538, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4900, dtype=torch.float64) delta_t tensor(0.5812, dtype=torch.float64)
11 gae_duplicate tensor(0.2941, dtype=torch.float64) tensor(-7.9141, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3588, dtype=torch.float64) delta_t tensor(0.2562, dtype=torch.float64)
10 gae_duplicate tensor(-0.3704, dtype=torch.float64) tensor(-4.1472, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4464, dtype=torch.float64) delta_t tensor(-0.5513, dtype=torch.float64)
9 gae_duplicate tensor(-1.3254, dtype=torch.float64) tensor(3.5119, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5478, dtype=torch.float64) delta_t tensor(-0.6525, dtype=torch.float64)
8 gae_duplicate tensor(-2.9286, dtype=torch.float64) tensor(3.7184, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6854, dtype=torch.float64) delta_t tensor(-0.6572, dtype=torch.float64)
7 gae_duplicate tensor(-2.3880, dtype=torch.float64) tensor(6.5891, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8408, dtype=torch.float64) delta_t tensor(-0.8654, dtype=torch.float64)
6 gae_duplicate tensor(-3.1654, dtype=torch.float64) tensor(12.0417, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0560, dtype=torch.float64) delta_t tensor(-0.9088, dtype=torch.float64)
5 gae_duplicate tensor(-2.8327, dtype=torch.float64) tensor(9.5803, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2580, dtype=torch.float64) delta_t tensor(-1.1332, dtype=torch.float64)
4 gae_duplicate tensor(-6.3359, dtype=torch.float64) tensor(20.1606, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7752, dtype=torch.float64) delta_t tensor(-0.6444, dtype=torch.float64)
3 gae_duplicate tensor(-1.1906, dtype=torch.float64) tensor(10.0300, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4133, dtype=torch.float64) delta_t tensor(-0.4788, dtype=torch.float64)
2 gae_duplicate tensor(-1.0700, dtype=torch.float64) tensor(8.4175, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-736.18310546875
value loss:177.30331420898438
entropies:192.0267791748047
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.018704891204834 seconds
19 rew tensor(0.7686, dtype=torch.float64) delta_t tensor(0.2840, dtype=torch.float64)
19 gae_duplicate tensor(0.1473, dtype=torch.float64) tensor(-3.2232, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7607, dtype=torch.float64) delta_t tensor(0.3124, dtype=torch.float64)
18 gae_duplicate tensor(0.1327, dtype=torch.float64) tensor(-3.6991, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7364, dtype=torch.float64) delta_t tensor(0.3608, dtype=torch.float64)
17 gae_duplicate tensor(0.0774, dtype=torch.float64) tensor(-2.7129, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6711, dtype=torch.float64) delta_t tensor(0.3476, dtype=torch.float64)
16 gae_duplicate tensor(-0.1207, dtype=torch.float64) tensor(-4.3444, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5814, dtype=torch.float64) delta_t tensor(0.2474, dtype=torch.float64)
15 gae_duplicate tensor(-0.4962, dtype=torch.float64) tensor(-3.0577, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5912, dtype=torch.float64) delta_t tensor(0.3015, dtype=torch.float64)
14 gae_duplicate tensor(-0.2831, dtype=torch.float64) tensor(-4.4560, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7691, dtype=torch.float64) delta_t tensor(0.4965, dtype=torch.float64)
13 gae_duplicate tensor(0.2648, dtype=torch.float64) tensor(-5.3807, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6625, dtype=torch.float64) delta_t tensor(0.3610, dtype=torch.float64)
12 gae_duplicate tensor(0.2385, dtype=torch.float64) tensor(-5.6452, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5956, dtype=torch.float64) delta_t tensor(0.3013, dtype=torch.float64)
11 gae_duplicate tensor(-0.0416, dtype=torch.float64) tensor(-2.7056, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4471, dtype=torch.float64) delta_t tensor(0.4751, dtype=torch.float64)
10 gae_duplicate tensor(-0.2681, dtype=torch.float64) tensor(-4.8767, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2798, dtype=torch.float64) delta_t tensor(-0.4049, dtype=torch.float64)
9 gae_duplicate tensor(-1.7730, dtype=torch.float64) tensor(5.7064, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4962, dtype=torch.float64) delta_t tensor(-0.5767, dtype=torch.float64)
8 gae_duplicate tensor(-1.4749, dtype=torch.float64) tensor(4.1701, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7449, dtype=torch.float64) delta_t tensor(-0.8216, dtype=torch.float64)
7 gae_duplicate tensor(-2.6030, dtype=torch.float64) tensor(5.9338, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7168, dtype=torch.float64) delta_t tensor(-0.8118, dtype=torch.float64)
6 gae_duplicate tensor(-1.8114, dtype=torch.float64) tensor(8.5464, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9978, dtype=torch.float64) delta_t tensor(-0.9008, dtype=torch.float64)
5 gae_duplicate tensor(-1.7599, dtype=torch.float64) tensor(12.9086, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1841, dtype=torch.float64) delta_t tensor(-1.1049, dtype=torch.float64)
4 gae_duplicate tensor(-3.6799, dtype=torch.float64) tensor(18.4255, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2965, dtype=torch.float64) delta_t tensor(-0.3077, dtype=torch.float64)
3 gae_duplicate tensor(-1.0289, dtype=torch.float64) tensor(3.5465, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1078, dtype=torch.float64) delta_t tensor(-0.1857, dtype=torch.float64)
2 gae_duplicate tensor(-0.4445, dtype=torch.float64) tensor(1.9288, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-792.3565673828125
value loss:119.9796371459961
entropies:189.08343505859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.927396774291992 seconds
19 rew tensor(0.7773, dtype=torch.float64) delta_t tensor(0.3683, dtype=torch.float64)
19 gae_duplicate tensor(0.1187, dtype=torch.float64) tensor(-4.8008, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7612, dtype=torch.float64) delta_t tensor(0.4093, dtype=torch.float64)
18 gae_duplicate tensor(0.2030, dtype=torch.float64) tensor(-3.9275, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7285, dtype=torch.float64) delta_t tensor(0.3484, dtype=torch.float64)
17 gae_duplicate tensor(0.0812, dtype=torch.float64) tensor(-4.0509, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6958, dtype=torch.float64) delta_t tensor(0.3787, dtype=torch.float64)
16 gae_duplicate tensor(-0.0874, dtype=torch.float64) tensor(-4.2699, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6052, dtype=torch.float64) delta_t tensor(0.2776, dtype=torch.float64)
15 gae_duplicate tensor(-0.5856, dtype=torch.float64) tensor(-2.8999, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7872, dtype=torch.float64) delta_t tensor(0.4621, dtype=torch.float64)
14 gae_duplicate tensor(0.3920, dtype=torch.float64) tensor(-4.7688, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7793, dtype=torch.float64) delta_t tensor(0.5942, dtype=torch.float64)
13 gae_duplicate tensor(0.4314, dtype=torch.float64) tensor(-6.9815, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6665, dtype=torch.float64) delta_t tensor(0.4303, dtype=torch.float64)
12 gae_duplicate tensor(0.1923, dtype=torch.float64) tensor(-5.0162, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5257, dtype=torch.float64) delta_t tensor(0.3434, dtype=torch.float64)
11 gae_duplicate tensor(0.0499, dtype=torch.float64) tensor(-3.4355, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0354, dtype=torch.float64) delta_t tensor(-0.0825, dtype=torch.float64)
10 gae_duplicate tensor(-1.4608, dtype=torch.float64) tensor(0.3726, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4384, dtype=torch.float64) delta_t tensor(-0.5605, dtype=torch.float64)
9 gae_duplicate tensor(-3.8170, dtype=torch.float64) tensor(10.0937, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1228, dtype=torch.float64) delta_t tensor(-0.1787, dtype=torch.float64)
8 gae_duplicate tensor(-0.7089, dtype=torch.float64) tensor(1.6061, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4604, dtype=torch.float64) delta_t tensor(-0.3616, dtype=torch.float64)
7 gae_duplicate tensor(-1.4261, dtype=torch.float64) tensor(4.4524, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8579, dtype=torch.float64) delta_t tensor(-0.8742, dtype=torch.float64)
6 gae_duplicate tensor(-1.4745, dtype=torch.float64) tensor(13.2246, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6011, dtype=torch.float64) delta_t tensor(-1.5032, dtype=torch.float64)
5 gae_duplicate tensor(-3.1663, dtype=torch.float64) tensor(22.3355, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4045, dtype=torch.float64) delta_t tensor(-0.2742, dtype=torch.float64)
4 gae_duplicate tensor(-1.3018, dtype=torch.float64) tensor(4.2052, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8635, dtype=torch.float64) delta_t tensor(-0.8477, dtype=torch.float64)
3 gae_duplicate tensor(-1.7365, dtype=torch.float64) tensor(11.2313, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1183, dtype=torch.float64) delta_t tensor(-0.2003, dtype=torch.float64)
2 gae_duplicate tensor(-0.4898, dtype=torch.float64) tensor(3.1341, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1132.23779296875
value loss:108.1068115234375
entropies:189.3298797607422
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.5251219272613525 seconds
19 rew tensor(0.7513, dtype=torch.float64) delta_t tensor(0.2060, dtype=torch.float64)
19 gae_duplicate tensor(-0.0145, dtype=torch.float64) tensor(-2.3370, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7346, dtype=torch.float64) delta_t tensor(0.2597, dtype=torch.float64)
18 gae_duplicate tensor(-0.0403, dtype=torch.float64) tensor(-4.2931, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6753, dtype=torch.float64) delta_t tensor(0.2945, dtype=torch.float64)
17 gae_duplicate tensor(0.0381, dtype=torch.float64) tensor(-2.6766, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5315, dtype=torch.float64) delta_t tensor(0.2921, dtype=torch.float64)
16 gae_duplicate tensor(-0.1761, dtype=torch.float64) tensor(-4.2411, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3365, dtype=torch.float64) delta_t tensor(0.1763, dtype=torch.float64)
15 gae_duplicate tensor(-0.6765, dtype=torch.float64) tensor(-3.7191, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7780, dtype=torch.float64) delta_t tensor(0.7324, dtype=torch.float64)
14 gae_duplicate tensor(0.5464, dtype=torch.float64) tensor(-7.4438, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7699, dtype=torch.float64) delta_t tensor(0.6658, dtype=torch.float64)
13 gae_duplicate tensor(0.6690, dtype=torch.float64) tensor(-9.3625, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0277, dtype=torch.float64) delta_t tensor(-0.0962, dtype=torch.float64)
12 gae_duplicate tensor(-3.1335, dtype=torch.float64) tensor(-1.1258, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6045, dtype=torch.float64) delta_t tensor(0.6010, dtype=torch.float64)
11 gae_duplicate tensor(0.2651, dtype=torch.float64) tensor(-6.8898, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4877, dtype=torch.float64) delta_t tensor(0.3323, dtype=torch.float64)
10 gae_duplicate tensor(-0.6123, dtype=torch.float64) tensor(-2.4965, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5590, dtype=torch.float64) delta_t tensor(-0.7224, dtype=torch.float64)
9 gae_duplicate tensor(-1.7259, dtype=torch.float64) tensor(6.9425, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2756, dtype=torch.float64) delta_t tensor(-0.4629, dtype=torch.float64)
8 gae_duplicate tensor(-1.7499, dtype=torch.float64) tensor(3.3116, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8081, dtype=torch.float64) delta_t tensor(-0.9072, dtype=torch.float64)
7 gae_duplicate tensor(-1.8879, dtype=torch.float64) tensor(10.7961, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3105, dtype=torch.float64) delta_t tensor(-1.4103, dtype=torch.float64)
6 gae_duplicate tensor(-4.4221, dtype=torch.float64) tensor(19.6685, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2414, dtype=torch.float64) delta_t tensor(-1.0154, dtype=torch.float64)
5 gae_duplicate tensor(-2.2306, dtype=torch.float64) tensor(11.3841, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0607, dtype=torch.float64) delta_t tensor(-1.9497, dtype=torch.float64)
4 gae_duplicate tensor(-5.7827, dtype=torch.float64) tensor(29.5853, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3400, dtype=torch.float64) delta_t tensor(-0.2719, dtype=torch.float64)
3 gae_duplicate tensor(-1.2750, dtype=torch.float64) tensor(4.4401, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1616, dtype=torch.float64) delta_t tensor(-0.1601, dtype=torch.float64)
2 gae_duplicate tensor(-0.3825, dtype=torch.float64) tensor(1.9569, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1599.9962158203125
value loss:223.22865295410156
entropies:188.899658203125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2343.0225)
ToM Target loss= tensor(1803.3203)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.968780040740967 seconds
19 rew tensor(0.7694, dtype=torch.float64) delta_t tensor(0.3599, dtype=torch.float64)
19 gae_duplicate tensor(-0.0318, dtype=torch.float64) tensor(-4.0370, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7457, dtype=torch.float64) delta_t tensor(0.3539, dtype=torch.float64)
18 gae_duplicate tensor(0.0248, dtype=torch.float64) tensor(-6.0200, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7219, dtype=torch.float64) delta_t tensor(0.3865, dtype=torch.float64)
17 gae_duplicate tensor(0.0079, dtype=torch.float64) tensor(-2.1717, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6340, dtype=torch.float64) delta_t tensor(0.3662, dtype=torch.float64)
16 gae_duplicate tensor(-0.2196, dtype=torch.float64) tensor(-2.9720, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5380, dtype=torch.float64) delta_t tensor(0.3042, dtype=torch.float64)
15 gae_duplicate tensor(-0.6752, dtype=torch.float64) tensor(-3.0177, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6911, dtype=torch.float64) delta_t tensor(0.5033, dtype=torch.float64)
14 gae_duplicate tensor(-0.0072, dtype=torch.float64) tensor(-4.7219, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7712, dtype=torch.float64) delta_t tensor(0.5489, dtype=torch.float64)
13 gae_duplicate tensor(0.4389, dtype=torch.float64) tensor(-7.9513, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7635, dtype=torch.float64) delta_t tensor(0.5724, dtype=torch.float64)
12 gae_duplicate tensor(0.4694, dtype=torch.float64) tensor(-6.3356, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7879, dtype=torch.float64) delta_t tensor(0.7841, dtype=torch.float64)
11 gae_duplicate tensor(0.5458, dtype=torch.float64) tensor(-8.2045, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5696, dtype=torch.float64) delta_t tensor(0.4949, dtype=torch.float64)
10 gae_duplicate tensor(0.4016, dtype=torch.float64) tensor(-6.8331, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1825, dtype=torch.float64) delta_t tensor(-0.3387, dtype=torch.float64)
9 gae_duplicate tensor(-1.7109, dtype=torch.float64) tensor(3.3608, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7951, dtype=torch.float64) delta_t tensor(-0.8346, dtype=torch.float64)
8 gae_duplicate tensor(-2.9675, dtype=torch.float64) tensor(6.8390, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9586, dtype=torch.float64) delta_t tensor(-0.8678, dtype=torch.float64)
7 gae_duplicate tensor(-4.0800, dtype=torch.float64) tensor(12.4864, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4117, dtype=torch.float64) delta_t tensor(-0.4489, dtype=torch.float64)
6 gae_duplicate tensor(-1.0835, dtype=torch.float64) tensor(5.4022, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2852, dtype=torch.float64) delta_t tensor(-1.1233, dtype=torch.float64)
5 gae_duplicate tensor(-2.2921, dtype=torch.float64) tensor(11.0171, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0329, dtype=torch.float64) delta_t tensor(-0.8876, dtype=torch.float64)
4 gae_duplicate tensor(-2.7334, dtype=torch.float64) tensor(14.8144, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5606, dtype=torch.float64) delta_t tensor(-0.5240, dtype=torch.float64)
3 gae_duplicate tensor(-1.3069, dtype=torch.float64) tensor(6.8355, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1667, dtype=torch.float64) delta_t tensor(-0.2286, dtype=torch.float64)
2 gae_duplicate tensor(-0.7986, dtype=torch.float64) tensor(4.3733, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-496.9476013183594
value loss:139.45188903808594
entropies:188.0285186767578
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.789560794830322 seconds
19 rew tensor(0.7863, dtype=torch.float64) delta_t tensor(0.4359, dtype=torch.float64)
19 gae_duplicate tensor(0.2219, dtype=torch.float64) tensor(-4.5979, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7867, dtype=torch.float64) delta_t tensor(0.6658, dtype=torch.float64)
18 gae_duplicate tensor(0.2298, dtype=torch.float64) tensor(-8.1961, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7871, dtype=torch.float64) delta_t tensor(0.6224, dtype=torch.float64)
17 gae_duplicate tensor(0.3162, dtype=torch.float64) tensor(-5.8936, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7874, dtype=torch.float64) delta_t tensor(0.6627, dtype=torch.float64)
16 gae_duplicate tensor(0.5317, dtype=torch.float64) tensor(-6.4125, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7878, dtype=torch.float64) delta_t tensor(0.7311, dtype=torch.float64)
15 gae_duplicate tensor(0.6017, dtype=torch.float64) tensor(-7.9224, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7040, dtype=torch.float64) delta_t tensor(0.5583, dtype=torch.float64)
14 gae_duplicate tensor(0.3930, dtype=torch.float64) tensor(-6.0687, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4338, dtype=torch.float64) delta_t tensor(0.2171, dtype=torch.float64)
13 gae_duplicate tensor(-0.2396, dtype=torch.float64) tensor(-2.1005, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3563, dtype=torch.float64) delta_t tensor(0.1972, dtype=torch.float64)
12 gae_duplicate tensor(-0.1526, dtype=torch.float64) tensor(-2.4510, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2309, dtype=torch.float64) delta_t tensor(0.1369, dtype=torch.float64)
11 gae_duplicate tensor(-0.3545, dtype=torch.float64) tensor(-1.2147, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1062, dtype=torch.float64) delta_t tensor(0.1666, dtype=torch.float64)
10 gae_duplicate tensor(-0.4387, dtype=torch.float64) tensor(-1.3957, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0733, dtype=torch.float64) delta_t tensor(0.2797, dtype=torch.float64)
9 gae_duplicate tensor(0.0343, dtype=torch.float64) tensor(-4.2940, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0228, dtype=torch.float64) delta_t tensor(0.1191, dtype=torch.float64)
8 gae_duplicate tensor(-0.0476, dtype=torch.float64) tensor(-2.0959, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2644, dtype=torch.float64) delta_t tensor(-0.0520, dtype=torch.float64)
7 gae_duplicate tensor(-0.3849, dtype=torch.float64) tensor(0.3956, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1245, dtype=torch.float64) delta_t tensor(-0.0404, dtype=torch.float64)
6 gae_duplicate tensor(-0.6223, dtype=torch.float64) tensor(0.1256, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9758, dtype=torch.float64) delta_t tensor(-0.7567, dtype=torch.float64)
5 gae_duplicate tensor(-0.9846, dtype=torch.float64) tensor(8.6265, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3015, dtype=torch.float64) delta_t tensor(0.4190, dtype=torch.float64)
4 gae_duplicate tensor(-0.4738, dtype=torch.float64) tensor(-2.6639, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8460, dtype=torch.float64) delta_t tensor(-0.6771, dtype=torch.float64)
3 gae_duplicate tensor(-1.1159, dtype=torch.float64) tensor(8.2925, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2197, dtype=torch.float64) delta_t tensor(-0.3100, dtype=torch.float64)
2 gae_duplicate tensor(-0.6944, dtype=torch.float64) tensor(3.5803, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1200.1090087890625
value loss:55.64305877685547
entropies:190.03988647460938
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7384560108184814 seconds
19 rew tensor(0.7783, dtype=torch.float64) delta_t tensor(0.4356, dtype=torch.float64)
19 gae_duplicate tensor(0.2428, dtype=torch.float64) tensor(-3.2259, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7610, dtype=torch.float64) delta_t tensor(0.4843, dtype=torch.float64)
18 gae_duplicate tensor(0.3067, dtype=torch.float64) tensor(-5.7093, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7173, dtype=torch.float64) delta_t tensor(0.4876, dtype=torch.float64)
17 gae_duplicate tensor(0.4051, dtype=torch.float64) tensor(-5.8285, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6824, dtype=torch.float64) delta_t tensor(0.4516, dtype=torch.float64)
16 gae_duplicate tensor(0.3076, dtype=torch.float64) tensor(-4.7113, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5858, dtype=torch.float64) delta_t tensor(0.3416, dtype=torch.float64)
15 gae_duplicate tensor(-0.3289, dtype=torch.float64) tensor(-2.0970, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7215, dtype=torch.float64) delta_t tensor(0.4339, dtype=torch.float64)
14 gae_duplicate tensor(0.1190, dtype=torch.float64) tensor(-4.1234, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6281, dtype=torch.float64) delta_t tensor(0.3826, dtype=torch.float64)
13 gae_duplicate tensor(-0.0060, dtype=torch.float64) tensor(-4.8812, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5197, dtype=torch.float64) delta_t tensor(0.2898, dtype=torch.float64)
12 gae_duplicate tensor(-0.1584, dtype=torch.float64) tensor(-4.5161, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5312, dtype=torch.float64) delta_t tensor(0.7251, dtype=torch.float64)
11 gae_duplicate tensor(0.1595, dtype=torch.float64) tensor(-6.8444, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2300, dtype=torch.float64) delta_t tensor(0.3553, dtype=torch.float64)
10 gae_duplicate tensor(0.2319, dtype=torch.float64) tensor(-5.6926, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0095, dtype=torch.float64) delta_t tensor(0.0390, dtype=torch.float64)
9 gae_duplicate tensor(-0.5991, dtype=torch.float64) tensor(-1.1539, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0855, dtype=torch.float64) delta_t tensor(0.0915, dtype=torch.float64)
8 gae_duplicate tensor(-1.0019, dtype=torch.float64) tensor(-0.7077, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2925, dtype=torch.float64) delta_t tensor(-0.1957, dtype=torch.float64)
7 gae_duplicate tensor(-0.6626, dtype=torch.float64) tensor(1.3638, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1775, dtype=torch.float64) delta_t tensor(-0.1811, dtype=torch.float64)
6 gae_duplicate tensor(-1.2510, dtype=torch.float64) tensor(1.6011, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9880, dtype=torch.float64) delta_t tensor(-0.7668, dtype=torch.float64)
5 gae_duplicate tensor(-2.2237, dtype=torch.float64) tensor(8.5691, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1273, dtype=torch.float64) delta_t tensor(0.0644, dtype=torch.float64)
4 gae_duplicate tensor(-0.9842, dtype=torch.float64) tensor(0.3444, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6775, dtype=torch.float64) delta_t tensor(-0.5959, dtype=torch.float64)
3 gae_duplicate tensor(-1.1346, dtype=torch.float64) tensor(6.1858, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4437, dtype=torch.float64) delta_t tensor(-0.5301, dtype=torch.float64)
2 gae_duplicate tensor(-1.3041, dtype=torch.float64) tensor(3.5949, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:968.1651611328125
value loss:60.935577392578125
entropies:187.74652099609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.967636823654175 seconds
19 rew tensor(0.7878, dtype=torch.float64) delta_t tensor(0.3076, dtype=torch.float64)
19 gae_duplicate tensor(0.1546, dtype=torch.float64) tensor(-3.1925, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7798, dtype=torch.float64) delta_t tensor(0.3656, dtype=torch.float64)
18 gae_duplicate tensor(0.1817, dtype=torch.float64) tensor(-4.4198, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7635, dtype=torch.float64) delta_t tensor(0.4512, dtype=torch.float64)
17 gae_duplicate tensor(0.2048, dtype=torch.float64) tensor(-5.6167, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7555, dtype=torch.float64) delta_t tensor(0.4785, dtype=torch.float64)
16 gae_duplicate tensor(0.1918, dtype=torch.float64) tensor(-5.1091, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7308, dtype=torch.float64) delta_t tensor(0.4158, dtype=torch.float64)
15 gae_duplicate tensor(-0.0538, dtype=torch.float64) tensor(-4.8319, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6645, dtype=torch.float64) delta_t tensor(0.4182, dtype=torch.float64)
14 gae_duplicate tensor(-0.5311, dtype=torch.float64) tensor(-5.2118, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7456, dtype=torch.float64) delta_t tensor(0.5182, dtype=torch.float64)
13 gae_duplicate tensor(0.1769, dtype=torch.float64) tensor(-6.0868, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6377, dtype=torch.float64) delta_t tensor(0.2716, dtype=torch.float64)
12 gae_duplicate tensor(0.0613, dtype=torch.float64) tensor(-2.3054, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5602, dtype=torch.float64) delta_t tensor(0.4648, dtype=torch.float64)
11 gae_duplicate tensor(-0.2675, dtype=torch.float64) tensor(-5.0324, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3832, dtype=torch.float64) delta_t tensor(0.4702, dtype=torch.float64)
10 gae_duplicate tensor(0.2388, dtype=torch.float64) tensor(-5.4984, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1840, dtype=torch.float64) delta_t tensor(0.1790, dtype=torch.float64)
9 gae_duplicate tensor(-0.6420, dtype=torch.float64) tensor(-5.1186, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4266, dtype=torch.float64) delta_t tensor(-0.5451, dtype=torch.float64)
8 gae_duplicate tensor(-2.8572, dtype=torch.float64) tensor(4.8942, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4126, dtype=torch.float64) delta_t tensor(-0.4261, dtype=torch.float64)
7 gae_duplicate tensor(-2.0131, dtype=torch.float64) tensor(2.9311, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3647, dtype=torch.float64) delta_t tensor(-0.3726, dtype=torch.float64)
6 gae_duplicate tensor(-0.7301, dtype=torch.float64) tensor(3.1826, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0458, dtype=torch.float64) delta_t tensor(-0.9104, dtype=torch.float64)
5 gae_duplicate tensor(-1.9861, dtype=torch.float64) tensor(10.9368, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7346, dtype=torch.float64) delta_t tensor(-0.5253, dtype=torch.float64)
4 gae_duplicate tensor(-1.6100, dtype=torch.float64) tensor(8.6358, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3597, dtype=torch.float64) delta_t tensor(-0.1119, dtype=torch.float64)
3 gae_duplicate tensor(-0.8060, dtype=torch.float64) tensor(3.2623, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5237, dtype=torch.float64) delta_t tensor(-0.5683, dtype=torch.float64)
2 gae_duplicate tensor(-1.0595, dtype=torch.float64) tensor(8.7838, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:319.49365234375
value loss:79.0728530883789
entropies:184.3780975341797
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.656314849853516 seconds
19 rew tensor(0.7795, dtype=torch.float64) delta_t tensor(0.4089, dtype=torch.float64)
19 gae_duplicate tensor(0.0507, dtype=torch.float64) tensor(-4.0103, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7710, dtype=torch.float64) delta_t tensor(0.4019, dtype=torch.float64)
18 gae_duplicate tensor(0.2123, dtype=torch.float64) tensor(-4.7775, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7625, dtype=torch.float64) delta_t tensor(0.4063, dtype=torch.float64)
17 gae_duplicate tensor(0.2279, dtype=torch.float64) tensor(-3.7583, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7275, dtype=torch.float64) delta_t tensor(0.2995, dtype=torch.float64)
16 gae_duplicate tensor(0.0150, dtype=torch.float64) tensor(-2.5019, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6836, dtype=torch.float64) delta_t tensor(0.3863, dtype=torch.float64)
15 gae_duplicate tensor(0.3395, dtype=torch.float64) tensor(-5.4684, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7281, dtype=torch.float64) delta_t tensor(0.5180, dtype=torch.float64)
14 gae_duplicate tensor(0.3757, dtype=torch.float64) tensor(-4.7987, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7549, dtype=torch.float64) delta_t tensor(0.5871, dtype=torch.float64)
13 gae_duplicate tensor(0.3795, dtype=torch.float64) tensor(-10.4827, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6286, dtype=torch.float64) delta_t tensor(0.4563, dtype=torch.float64)
12 gae_duplicate tensor(0.1185, dtype=torch.float64) tensor(-5.2558, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1653, dtype=torch.float64) delta_t tensor(0.1583, dtype=torch.float64)
11 gae_duplicate tensor(-1.1733, dtype=torch.float64) tensor(-4.8474, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3235, dtype=torch.float64) delta_t tensor(0.3898, dtype=torch.float64)
10 gae_duplicate tensor(0.1666, dtype=torch.float64) tensor(-6.0522, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1125, dtype=torch.float64) delta_t tensor(-0.0837, dtype=torch.float64)
9 gae_duplicate tensor(-0.4016, dtype=torch.float64) tensor(1.7827, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6203, dtype=torch.float64) delta_t tensor(-0.6464, dtype=torch.float64)
8 gae_duplicate tensor(-2.6122, dtype=torch.float64) tensor(8.3652, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6084, dtype=torch.float64) delta_t tensor(-0.4934, dtype=torch.float64)
7 gae_duplicate tensor(-1.4619, dtype=torch.float64) tensor(5.1515, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2425, dtype=torch.float64) delta_t tensor(-0.2002, dtype=torch.float64)
6 gae_duplicate tensor(-2.1489, dtype=torch.float64) tensor(2.7742, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7835, dtype=torch.float64) delta_t tensor(-0.5671, dtype=torch.float64)
5 gae_duplicate tensor(-1.9976, dtype=torch.float64) tensor(6.5177, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2167, dtype=torch.float64) delta_t tensor(-0.1024, dtype=torch.float64)
4 gae_duplicate tensor(-0.8399, dtype=torch.float64) tensor(0.2202, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9384, dtype=torch.float64) delta_t tensor(-0.7657, dtype=torch.float64)
3 gae_duplicate tensor(-1.2604, dtype=torch.float64) tensor(9.6572, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1817, dtype=torch.float64) delta_t tensor(-0.2750, dtype=torch.float64)
2 gae_duplicate tensor(-0.5259, dtype=torch.float64) tensor(5.2499, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:407.74835205078125
value loss:74.00077819824219
entropies:181.65235900878906
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2304.8110)
ToM Target loss= tensor(1805.6041)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.922077894210815 seconds
19 rew tensor(0.7307, dtype=torch.float64) delta_t tensor(0.1279, dtype=torch.float64)
19 gae_duplicate tensor(-0.0588, dtype=torch.float64) tensor(-0.7975, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6727, dtype=torch.float64) delta_t tensor(0.2463, dtype=torch.float64)
18 gae_duplicate tensor(-0.0622, dtype=torch.float64) tensor(-2.0191, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5484, dtype=torch.float64) delta_t tensor(0.2070, dtype=torch.float64)
17 gae_duplicate tensor(-0.2545, dtype=torch.float64) tensor(-1.6989, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3332, dtype=torch.float64) delta_t tensor(0.0404, dtype=torch.float64)
16 gae_duplicate tensor(-0.6886, dtype=torch.float64) tensor(-0.2638, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3560, dtype=torch.float64) delta_t tensor(0.2130, dtype=torch.float64)
15 gae_duplicate tensor(-0.6947, dtype=torch.float64) tensor(-1.1849, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7566, dtype=torch.float64) delta_t tensor(0.5811, dtype=torch.float64)
14 gae_duplicate tensor(0.4250, dtype=torch.float64) tensor(-6.5142, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7394, dtype=torch.float64) delta_t tensor(0.5874, dtype=torch.float64)
13 gae_duplicate tensor(0.2699, dtype=torch.float64) tensor(-6.8125, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2441, dtype=torch.float64) delta_t tensor(0.1018, dtype=torch.float64)
12 gae_duplicate tensor(-1.5680, dtype=torch.float64) tensor(-1.2768, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4607, dtype=torch.float64) delta_t tensor(0.3414, dtype=torch.float64)
11 gae_duplicate tensor(-0.2544, dtype=torch.float64) tensor(-3.1075, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3759, dtype=torch.float64) delta_t tensor(0.3011, dtype=torch.float64)
10 gae_duplicate tensor(-0.2579, dtype=torch.float64) tensor(-2.5322, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7757, dtype=torch.float64) delta_t tensor(-0.9979, dtype=torch.float64)
9 gae_duplicate tensor(-4.5304, dtype=torch.float64) tensor(6.4979, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6006, dtype=torch.float64) delta_t tensor(-0.9165, dtype=torch.float64)
8 gae_duplicate tensor(-1.6079, dtype=torch.float64) tensor(6.5386, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9364, dtype=torch.float64) delta_t tensor(-0.9727, dtype=torch.float64)
7 gae_duplicate tensor(-2.0625, dtype=torch.float64) tensor(16.1043, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3167, dtype=torch.float64) delta_t tensor(-0.2799, dtype=torch.float64)
6 gae_duplicate tensor(-2.3880, dtype=torch.float64) tensor(4.5454, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7625, dtype=torch.float64) delta_t tensor(-1.6506, dtype=torch.float64)
5 gae_duplicate tensor(-3.9407, dtype=torch.float64) tensor(20.1304, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8000, dtype=torch.float64) delta_t tensor(-1.6821, dtype=torch.float64)
4 gae_duplicate tensor(-4.9843, dtype=torch.float64) tensor(20.5187, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3733, dtype=torch.float64) delta_t tensor(-0.3100, dtype=torch.float64)
3 gae_duplicate tensor(-1.2421, dtype=torch.float64) tensor(5.9801, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1879, dtype=torch.float64) delta_t tensor(-0.2017, dtype=torch.float64)
2 gae_duplicate tensor(-0.4109, dtype=torch.float64) tensor(2.0701, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2054.8388671875
value loss:214.23736572265625
entropies:180.17613220214844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.196796894073486 seconds
19 rew tensor(0.7813, dtype=torch.float64) delta_t tensor(0.3540, dtype=torch.float64)
19 gae_duplicate tensor(-0.0002, dtype=torch.float64) tensor(-2.7062, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7654, dtype=torch.float64) delta_t tensor(0.3648, dtype=torch.float64)
18 gae_duplicate tensor(0.0831, dtype=torch.float64) tensor(-5.0958, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7333, dtype=torch.float64) delta_t tensor(0.4344, dtype=torch.float64)
17 gae_duplicate tensor(0.1031, dtype=torch.float64) tensor(-3.7621, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6851, dtype=torch.float64) delta_t tensor(0.3578, dtype=torch.float64)
16 gae_duplicate tensor(-0.2864, dtype=torch.float64) tensor(-5.1326, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5799, dtype=torch.float64) delta_t tensor(0.4296, dtype=torch.float64)
15 gae_duplicate tensor(-0.5519, dtype=torch.float64) tensor(-3.1665, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7066, dtype=torch.float64) delta_t tensor(0.5190, dtype=torch.float64)
14 gae_duplicate tensor(0.1751, dtype=torch.float64) tensor(-5.7505, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6502, dtype=torch.float64) delta_t tensor(0.5310, dtype=torch.float64)
13 gae_duplicate tensor(0.3415, dtype=torch.float64) tensor(-7.3767, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5803, dtype=torch.float64) delta_t tensor(0.4630, dtype=torch.float64)
12 gae_duplicate tensor(0.1440, dtype=torch.float64) tensor(-5.1124, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5470, dtype=torch.float64) delta_t tensor(0.4539, dtype=torch.float64)
11 gae_duplicate tensor(0.3550, dtype=torch.float64) tensor(-4.5477, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2901, dtype=torch.float64) delta_t tensor(0.2784, dtype=torch.float64)
10 gae_duplicate tensor(-0.2002, dtype=torch.float64) tensor(-3.3596, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3138, dtype=torch.float64) delta_t tensor(-0.2036, dtype=torch.float64)
9 gae_duplicate tensor(-2.1520, dtype=torch.float64) tensor(1.9163, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1717, dtype=torch.float64) delta_t tensor(-1.2077, dtype=torch.float64)
8 gae_duplicate tensor(-2.7441, dtype=torch.float64) tensor(17.8027, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9051, dtype=torch.float64) delta_t tensor(-0.8585, dtype=torch.float64)
7 gae_duplicate tensor(-4.3510, dtype=torch.float64) tensor(5.6155, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2800, dtype=torch.float64) delta_t tensor(-0.2329, dtype=torch.float64)
6 gae_duplicate tensor(-0.9718, dtype=torch.float64) tensor(3.8125, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0536, dtype=torch.float64) delta_t tensor(-0.9570, dtype=torch.float64)
5 gae_duplicate tensor(-1.6568, dtype=torch.float64) tensor(13.3819, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5884, dtype=torch.float64) delta_t tensor(-0.4198, dtype=torch.float64)
4 gae_duplicate tensor(-1.5671, dtype=torch.float64) tensor(8.1843, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4410, dtype=torch.float64) delta_t tensor(-0.2352, dtype=torch.float64)
3 gae_duplicate tensor(-1.3693, dtype=torch.float64) tensor(1.9470, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7510, dtype=torch.float64) delta_t tensor(-0.7535, dtype=torch.float64)
2 gae_duplicate tensor(-1.1930, dtype=torch.float64) tensor(11.1891, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-675.3151245117188
value loss:130.83433532714844
entropies:183.8883819580078
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.664929151535034 seconds
19 rew tensor(0.7723, dtype=torch.float64) delta_t tensor(0.3086, dtype=torch.float64)
19 gae_duplicate tensor(0.0476, dtype=torch.float64) tensor(-2.8319, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7645, dtype=torch.float64) delta_t tensor(0.4264, dtype=torch.float64)
18 gae_duplicate tensor(0.1240, dtype=torch.float64) tensor(-3.9250, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7321, dtype=torch.float64) delta_t tensor(0.3362, dtype=torch.float64)
17 gae_duplicate tensor(-0.0225, dtype=torch.float64) tensor(-4.8241, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6753, dtype=torch.float64) delta_t tensor(0.3349, dtype=torch.float64)
16 gae_duplicate tensor(-0.2188, dtype=torch.float64) tensor(-3.4327, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5776, dtype=torch.float64) delta_t tensor(0.3934, dtype=torch.float64)
15 gae_duplicate tensor(-0.2783, dtype=torch.float64) tensor(-3.3561, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7232, dtype=torch.float64) delta_t tensor(0.4442, dtype=torch.float64)
14 gae_duplicate tensor(0.1637, dtype=torch.float64) tensor(-6.5767, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5226, dtype=torch.float64) delta_t tensor(0.3150, dtype=torch.float64)
13 gae_duplicate tensor(-0.0371, dtype=torch.float64) tensor(-3.0561, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5098, dtype=torch.float64) delta_t tensor(0.4059, dtype=torch.float64)
12 gae_duplicate tensor(-0.2161, dtype=torch.float64) tensor(-4.8701, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4249, dtype=torch.float64) delta_t tensor(0.2584, dtype=torch.float64)
11 gae_duplicate tensor(-0.4537, dtype=torch.float64) tensor(-2.5870, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.8342, dtype=torch.float64) delta_t tensor(-0.7904, dtype=torch.float64)
10 gae_duplicate tensor(-4.3618, dtype=torch.float64) tensor(4.2475, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1410, dtype=torch.float64) delta_t tensor(0.0906, dtype=torch.float64)
9 gae_duplicate tensor(-0.6453, dtype=torch.float64) tensor(-0.1290, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1279, dtype=torch.float64) delta_t tensor(-0.0583, dtype=torch.float64)
8 gae_duplicate tensor(-1.1944, dtype=torch.float64) tensor(1.4242, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3701, dtype=torch.float64) delta_t tensor(-0.4963, dtype=torch.float64)
7 gae_duplicate tensor(-1.8008, dtype=torch.float64) tensor(4.9253, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7812, dtype=torch.float64) delta_t tensor(-0.8653, dtype=torch.float64)
6 gae_duplicate tensor(-1.9548, dtype=torch.float64) tensor(8.6458, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0207, dtype=torch.float64) delta_t tensor(-0.8581, dtype=torch.float64)
5 gae_duplicate tensor(-2.2263, dtype=torch.float64) tensor(14.7914, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6175, dtype=torch.float64) delta_t tensor(-1.4858, dtype=torch.float64)
4 gae_duplicate tensor(-7.5602, dtype=torch.float64) tensor(12.4569, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3485, dtype=torch.float64) delta_t tensor(-0.2177, dtype=torch.float64)
3 gae_duplicate tensor(-1.0350, dtype=torch.float64) tensor(3.6991, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4626, dtype=torch.float64) delta_t tensor(-0.4442, dtype=torch.float64)
2 gae_duplicate tensor(-0.9218, dtype=torch.float64) tensor(3.3034, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-677.2421264648438
value loss:200.315185546875
entropies:181.4630126953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.691878080368042 seconds
19 rew tensor(0.7705, dtype=torch.float64) delta_t tensor(0.4423, dtype=torch.float64)
19 gae_duplicate tensor(0.0576, dtype=torch.float64) tensor(-2.0962, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7532, dtype=torch.float64) delta_t tensor(0.4083, dtype=torch.float64)
18 gae_duplicate tensor(0.0675, dtype=torch.float64) tensor(-5.8910, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7096, dtype=torch.float64) delta_t tensor(0.3913, dtype=torch.float64)
17 gae_duplicate tensor(-0.1740, dtype=torch.float64) tensor(-4.9212, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6308, dtype=torch.float64) delta_t tensor(0.3411, dtype=torch.float64)
16 gae_duplicate tensor(-0.5132, dtype=torch.float64) tensor(-3.4061, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4993, dtype=torch.float64) delta_t tensor(0.1103, dtype=torch.float64)
15 gae_duplicate tensor(-1.1087, dtype=torch.float64) tensor(-2.0796, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7894, dtype=torch.float64) delta_t tensor(0.4354, dtype=torch.float64)
14 gae_duplicate tensor(0.3170, dtype=torch.float64) tensor(-4.1191, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7898, dtype=torch.float64) delta_t tensor(0.4512, dtype=torch.float64)
13 gae_duplicate tensor(0.3434, dtype=torch.float64) tensor(-2.7994, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7387, dtype=torch.float64) delta_t tensor(0.4087, dtype=torch.float64)
12 gae_duplicate tensor(0.3454, dtype=torch.float64) tensor(-3.4958, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6281, dtype=torch.float64) delta_t tensor(0.3024, dtype=torch.float64)
11 gae_duplicate tensor(-0.2424, dtype=torch.float64) tensor(-2.4648, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4352, dtype=torch.float64) delta_t tensor(-0.6812, dtype=torch.float64)
10 gae_duplicate tensor(-5.6811, dtype=torch.float64) tensor(11.0701, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7168, dtype=torch.float64) delta_t tensor(-0.8302, dtype=torch.float64)
9 gae_duplicate tensor(-4.8938, dtype=torch.float64) tensor(5.2211, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3945, dtype=torch.float64) delta_t tensor(-0.5025, dtype=torch.float64)
8 gae_duplicate tensor(-2.3939, dtype=torch.float64) tensor(5.5579, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5213, dtype=torch.float64) delta_t tensor(-0.3964, dtype=torch.float64)
7 gae_duplicate tensor(-2.1842, dtype=torch.float64) tensor(2.1051, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7275, dtype=torch.float64) delta_t tensor(-0.7128, dtype=torch.float64)
6 gae_duplicate tensor(-2.5117, dtype=torch.float64) tensor(4.3147, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3161, dtype=torch.float64) delta_t tensor(-1.2750, dtype=torch.float64)
5 gae_duplicate tensor(-3.0873, dtype=torch.float64) tensor(16.4970, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2050, dtype=torch.float64) delta_t tensor(-0.9497, dtype=torch.float64)
4 gae_duplicate tensor(-4.2343, dtype=torch.float64) tensor(10.8655, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2172, dtype=torch.float64) delta_t tensor(-0.0614, dtype=torch.float64)
3 gae_duplicate tensor(-0.9573, dtype=torch.float64) tensor(3.6717, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4104, dtype=torch.float64) delta_t tensor(-0.4379, dtype=torch.float64)
2 gae_duplicate tensor(-0.6627, dtype=torch.float64) tensor(3.3365, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1161.431884765625
value loss:206.9865264892578
entropies:179.11566162109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6592912673950195 seconds
19 rew tensor(0.7888, dtype=torch.float64) delta_t tensor(0.3248, dtype=torch.float64)
19 gae_duplicate tensor(0.0034, dtype=torch.float64) tensor(-3.2787, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7891, dtype=torch.float64) delta_t tensor(0.4415, dtype=torch.float64)
18 gae_duplicate tensor(0.2323, dtype=torch.float64) tensor(-6.7314, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7894, dtype=torch.float64) delta_t tensor(0.4426, dtype=torch.float64)
17 gae_duplicate tensor(0.2841, dtype=torch.float64) tensor(-6.0177, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7898, dtype=torch.float64) delta_t tensor(0.5104, dtype=torch.float64)
16 gae_duplicate tensor(0.2864, dtype=torch.float64) tensor(-4.7718, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7901, dtype=torch.float64) delta_t tensor(0.5355, dtype=torch.float64)
15 gae_duplicate tensor(0.3107, dtype=torch.float64) tensor(-8.9754, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7905, dtype=torch.float64) delta_t tensor(0.5526, dtype=torch.float64)
14 gae_duplicate tensor(0.3189, dtype=torch.float64) tensor(-4.7787, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6988, dtype=torch.float64) delta_t tensor(0.5766, dtype=torch.float64)
13 gae_duplicate tensor(0.0930, dtype=torch.float64) tensor(-6.9139, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6244, dtype=torch.float64) delta_t tensor(0.4557, dtype=torch.float64)
12 gae_duplicate tensor(0.0410, dtype=torch.float64) tensor(-4.3341, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2060, dtype=torch.float64) delta_t tensor(0.2414, dtype=torch.float64)
11 gae_duplicate tensor(-1.4563, dtype=torch.float64) tensor(-3.3604, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2464, dtype=torch.float64) delta_t tensor(0.1515, dtype=torch.float64)
10 gae_duplicate tensor(-0.3329, dtype=torch.float64) tensor(-4.2653, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0032, dtype=torch.float64) delta_t tensor(-0.1530, dtype=torch.float64)
9 gae_duplicate tensor(-0.7509, dtype=torch.float64) tensor(2.7896, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2162, dtype=torch.float64) delta_t tensor(-0.2852, dtype=torch.float64)
8 gae_duplicate tensor(-1.2730, dtype=torch.float64) tensor(2.8264, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5569, dtype=torch.float64) delta_t tensor(-0.4750, dtype=torch.float64)
7 gae_duplicate tensor(-1.0007, dtype=torch.float64) tensor(5.2702, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3677, dtype=torch.float64) delta_t tensor(-0.1946, dtype=torch.float64)
6 gae_duplicate tensor(-1.2861, dtype=torch.float64) tensor(1.6228, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2512, dtype=torch.float64) delta_t tensor(-1.0550, dtype=torch.float64)
5 gae_duplicate tensor(-2.0506, dtype=torch.float64) tensor(11.8943, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4831, dtype=torch.float64) delta_t tensor(-0.3897, dtype=torch.float64)
4 gae_duplicate tensor(-1.5891, dtype=torch.float64) tensor(6.7193, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6683, dtype=torch.float64) delta_t tensor(-0.5488, dtype=torch.float64)
3 gae_duplicate tensor(-1.3734, dtype=torch.float64) tensor(2.9406, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3529, dtype=torch.float64) delta_t tensor(-0.4266, dtype=torch.float64)
2 gae_duplicate tensor(-0.9616, dtype=torch.float64) tensor(6.3294, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:436.5675048828125
value loss:78.95086669921875
entropies:181.59030151367188
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2326.6897)
ToM Target loss= tensor(1804.8944)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.769638776779175 seconds
19 rew tensor(0.7190, dtype=torch.float64) delta_t tensor(0.3442, dtype=torch.float64)
19 gae_duplicate tensor(-0.1505, dtype=torch.float64) tensor(-4.5153, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7106, dtype=torch.float64) delta_t tensor(0.4073, dtype=torch.float64)
18 gae_duplicate tensor(-0.0596, dtype=torch.float64) tensor(-2.9674, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5991, dtype=torch.float64) delta_t tensor(0.3090, dtype=torch.float64)
17 gae_duplicate tensor(-0.2884, dtype=torch.float64) tensor(-4.2443, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4196, dtype=torch.float64) delta_t tensor(0.1318, dtype=torch.float64)
16 gae_duplicate tensor(-0.8921, dtype=torch.float64) tensor(-0.7669, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5924, dtype=torch.float64) delta_t tensor(0.3087, dtype=torch.float64)
15 gae_duplicate tensor(-0.0930, dtype=torch.float64) tensor(-2.9655, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5197, dtype=torch.float64) delta_t tensor(0.3942, dtype=torch.float64)
14 gae_duplicate tensor(-0.6177, dtype=torch.float64) tensor(-3.7338, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6799, dtype=torch.float64) delta_t tensor(0.5045, dtype=torch.float64)
13 gae_duplicate tensor(0.1026, dtype=torch.float64) tensor(-3.9249, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6140, dtype=torch.float64) delta_t tensor(0.5004, dtype=torch.float64)
12 gae_duplicate tensor(-0.0241, dtype=torch.float64) tensor(-6.8082, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0465, dtype=torch.float64) delta_t tensor(-0.0679, dtype=torch.float64)
11 gae_duplicate tensor(-2.3223, dtype=torch.float64) tensor(0.4981, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0755, dtype=torch.float64) delta_t tensor(-0.0964, dtype=torch.float64)
10 gae_duplicate tensor(-1.6743, dtype=torch.float64) tensor(-0.4334, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1403, dtype=torch.float64) delta_t tensor(-1.0403, dtype=torch.float64)
9 gae_duplicate tensor(-5.2702, dtype=torch.float64) tensor(11.4844, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5469, dtype=torch.float64) delta_t tensor(-0.3932, dtype=torch.float64)
8 gae_duplicate tensor(-1.4508, dtype=torch.float64) tensor(7.3407, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9811, dtype=torch.float64) delta_t tensor(-0.9969, dtype=torch.float64)
7 gae_duplicate tensor(-4.0965, dtype=torch.float64) tensor(9.0439, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6410, dtype=torch.float64) delta_t tensor(-0.5938, dtype=torch.float64)
6 gae_duplicate tensor(-2.4600, dtype=torch.float64) tensor(5.2639, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1370, dtype=torch.float64) delta_t tensor(-0.8584, dtype=torch.float64)
5 gae_duplicate tensor(-3.2941, dtype=torch.float64) tensor(11.0726, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4710, dtype=torch.float64) delta_t tensor(-1.2727, dtype=torch.float64)
4 gae_duplicate tensor(-7.8466, dtype=torch.float64) tensor(23.9743, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5269, dtype=torch.float64) delta_t tensor(-0.4534, dtype=torch.float64)
3 gae_duplicate tensor(-1.0768, dtype=torch.float64) tensor(6.0302, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2147, dtype=torch.float64) delta_t tensor(-0.2267, dtype=torch.float64)
2 gae_duplicate tensor(-0.6372, dtype=torch.float64) tensor(2.5278, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1720.871826171875
value loss:259.027099609375
entropies:185.17404174804688
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.775980234146118 seconds
19 rew tensor(0.4840, dtype=torch.float64) delta_t tensor(-0.0139, dtype=torch.float64)
19 gae_duplicate tensor(-0.9813, dtype=torch.float64) tensor(1.8454, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7304, dtype=torch.float64) delta_t tensor(0.3264, dtype=torch.float64)
18 gae_duplicate tensor(0.1187, dtype=torch.float64) tensor(-3.6484, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6563, dtype=torch.float64) delta_t tensor(0.3192, dtype=torch.float64)
17 gae_duplicate tensor(-0.1398, dtype=torch.float64) tensor(-3.5860, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5401, dtype=torch.float64) delta_t tensor(0.2777, dtype=torch.float64)
16 gae_duplicate tensor(-0.7230, dtype=torch.float64) tensor(-1.0421, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7016, dtype=torch.float64) delta_t tensor(0.4635, dtype=torch.float64)
15 gae_duplicate tensor(0.0854, dtype=torch.float64) tensor(-6.4836, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6313, dtype=torch.float64) delta_t tensor(0.4159, dtype=torch.float64)
14 gae_duplicate tensor(-0.3277, dtype=torch.float64) tensor(-4.6194, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6954, dtype=torch.float64) delta_t tensor(0.5048, dtype=torch.float64)
13 gae_duplicate tensor(0.3231, dtype=torch.float64) tensor(-5.5340, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6984, dtype=torch.float64) delta_t tensor(0.5846, dtype=torch.float64)
12 gae_duplicate tensor(0.2507, dtype=torch.float64) tensor(-4.7733, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6146, dtype=torch.float64) delta_t tensor(0.5242, dtype=torch.float64)
11 gae_duplicate tensor(0.0368, dtype=torch.float64) tensor(-8.7772, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1194, dtype=torch.float64) delta_t tensor(-0.0248, dtype=torch.float64)
10 gae_duplicate tensor(-2.4441, dtype=torch.float64) tensor(-2.2593, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2666, dtype=torch.float64) delta_t tensor(-0.3411, dtype=torch.float64)
9 gae_duplicate tensor(-1.7179, dtype=torch.float64) tensor(6.7755, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5717, dtype=torch.float64) delta_t tensor(-0.5773, dtype=torch.float64)
8 gae_duplicate tensor(-2.1316, dtype=torch.float64) tensor(8.3715, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7559, dtype=torch.float64) delta_t tensor(-0.7082, dtype=torch.float64)
7 gae_duplicate tensor(-2.8018, dtype=torch.float64) tensor(5.9917, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7482, dtype=torch.float64) delta_t tensor(-0.7512, dtype=torch.float64)
6 gae_duplicate tensor(-1.6532, dtype=torch.float64) tensor(9.6004, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2836, dtype=torch.float64) delta_t tensor(-1.2967, dtype=torch.float64)
5 gae_duplicate tensor(-2.2981, dtype=torch.float64) tensor(21.4836, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7563, dtype=torch.float64) delta_t tensor(-0.5598, dtype=torch.float64)
4 gae_duplicate tensor(-2.5120, dtype=torch.float64) tensor(5.5532, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5571, dtype=torch.float64) delta_t tensor(-0.5621, dtype=torch.float64)
3 gae_duplicate tensor(-1.4212, dtype=torch.float64) tensor(6.1663, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1312, dtype=torch.float64) delta_t tensor(-0.2319, dtype=torch.float64)
2 gae_duplicate tensor(-1.0393, dtype=torch.float64) tensor(2.2752, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1017.1011962890625
value loss:135.97073364257812
entropies:182.70272827148438
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.841498136520386 seconds
19 rew tensor(0.6413, dtype=torch.float64) delta_t tensor(0.2711, dtype=torch.float64)
19 gae_duplicate tensor(-0.4142, dtype=torch.float64) tensor(-1.1573, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5192, dtype=torch.float64) delta_t tensor(0.2767, dtype=torch.float64)
18 gae_duplicate tensor(-0.9721, dtype=torch.float64) tensor(-2.5528, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7886, dtype=torch.float64) delta_t tensor(0.5767, dtype=torch.float64)
17 gae_duplicate tensor(0.3242, dtype=torch.float64) tensor(-4.3867, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7890, dtype=torch.float64) delta_t tensor(0.6461, dtype=torch.float64)
16 gae_duplicate tensor(0.3732, dtype=torch.float64) tensor(-8.2016, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6596, dtype=torch.float64) delta_t tensor(0.4753, dtype=torch.float64)
15 gae_duplicate tensor(-0.3724, dtype=torch.float64) tensor(-3.1217, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5994, dtype=torch.float64) delta_t tensor(0.4450, dtype=torch.float64)
14 gae_duplicate tensor(-0.6723, dtype=torch.float64) tensor(-5.2721, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6193, dtype=torch.float64) delta_t tensor(0.4281, dtype=torch.float64)
13 gae_duplicate tensor(0.1611, dtype=torch.float64) tensor(-3.4814, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6216, dtype=torch.float64) delta_t tensor(0.5264, dtype=torch.float64)
12 gae_duplicate tensor(0.0745, dtype=torch.float64) tensor(-8.2235, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4732, dtype=torch.float64) delta_t tensor(0.4363, dtype=torch.float64)
11 gae_duplicate tensor(-0.3382, dtype=torch.float64) tensor(-3.7868, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3997, dtype=torch.float64) delta_t tensor(0.2015, dtype=torch.float64)
10 gae_duplicate tensor(-0.5581, dtype=torch.float64) tensor(-3.9219, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3384, dtype=torch.float64) delta_t tensor(-0.4285, dtype=torch.float64)
9 gae_duplicate tensor(-2.6202, dtype=torch.float64) tensor(5.7276, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3420, dtype=torch.float64) delta_t tensor(-0.3782, dtype=torch.float64)
8 gae_duplicate tensor(-1.9797, dtype=torch.float64) tensor(4.2541, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3098, dtype=torch.float64) delta_t tensor(-0.3514, dtype=torch.float64)
7 gae_duplicate tensor(-1.1486, dtype=torch.float64) tensor(3.1630, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7654, dtype=torch.float64) delta_t tensor(-0.7341, dtype=torch.float64)
6 gae_duplicate tensor(-2.0546, dtype=torch.float64) tensor(14.1284, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3319, dtype=torch.float64) delta_t tensor(-1.1049, dtype=torch.float64)
5 gae_duplicate tensor(-2.2664, dtype=torch.float64) tensor(12.0718, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6222, dtype=torch.float64) delta_t tensor(-1.4866, dtype=torch.float64)
4 gae_duplicate tensor(-6.5549, dtype=torch.float64) tensor(15.8628, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1768, dtype=torch.float64) delta_t tensor(-0.0045, dtype=torch.float64)
3 gae_duplicate tensor(-0.9831, dtype=torch.float64) tensor(0.7450, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3934, dtype=torch.float64) delta_t tensor(-0.4178, dtype=torch.float64)
2 gae_duplicate tensor(-0.8974, dtype=torch.float64) tensor(4.2871, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-614.001220703125
value loss:170.584228515625
entropies:184.3147430419922
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.024986267089844 seconds
19 rew tensor(0.7887, dtype=torch.float64) delta_t tensor(0.3109, dtype=torch.float64)
19 gae_duplicate tensor(0.0200, dtype=torch.float64) tensor(-1.9745, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7891, dtype=torch.float64) delta_t tensor(0.4171, dtype=torch.float64)
18 gae_duplicate tensor(0.1014, dtype=torch.float64) tensor(-3.3296, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7894, dtype=torch.float64) delta_t tensor(0.3966, dtype=torch.float64)
17 gae_duplicate tensor(0.2687, dtype=torch.float64) tensor(-3.7882, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7897, dtype=torch.float64) delta_t tensor(0.5105, dtype=torch.float64)
16 gae_duplicate tensor(0.4055, dtype=torch.float64) tensor(-6.4447, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7900, dtype=torch.float64) delta_t tensor(0.4881, dtype=torch.float64)
15 gae_duplicate tensor(0.2881, dtype=torch.float64) tensor(-6.1509, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7904, dtype=torch.float64) delta_t tensor(0.5562, dtype=torch.float64)
14 gae_duplicate tensor(0.4042, dtype=torch.float64) tensor(-7.7219, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7734, dtype=torch.float64) delta_t tensor(0.6967, dtype=torch.float64)
13 gae_duplicate tensor(0.4908, dtype=torch.float64) tensor(-5.4700, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6490, dtype=torch.float64) delta_t tensor(0.5070, dtype=torch.float64)
12 gae_duplicate tensor(0.2991, dtype=torch.float64) tensor(-5.4147, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3468, dtype=torch.float64) delta_t tensor(0.4073, dtype=torch.float64)
11 gae_duplicate tensor(-0.7558, dtype=torch.float64) tensor(-6.4055, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1013, dtype=torch.float64) delta_t tensor(0.1021, dtype=torch.float64)
10 gae_duplicate tensor(-1.2539, dtype=torch.float64) tensor(-4.0973, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0238, dtype=torch.float64) delta_t tensor(-0.2026, dtype=torch.float64)
9 gae_duplicate tensor(-1.4699, dtype=torch.float64) tensor(1.0740, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2475, dtype=torch.float64) delta_t tensor(-0.4741, dtype=torch.float64)
8 gae_duplicate tensor(-0.8095, dtype=torch.float64) tensor(4.7501, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6737, dtype=torch.float64) delta_t tensor(-0.5089, dtype=torch.float64)
7 gae_duplicate tensor(-2.3549, dtype=torch.float64) tensor(5.0494, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6030, dtype=torch.float64) delta_t tensor(-0.4388, dtype=torch.float64)
6 gae_duplicate tensor(-1.8443, dtype=torch.float64) tensor(6.3323, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0113, dtype=torch.float64) delta_t tensor(-0.8252, dtype=torch.float64)
5 gae_duplicate tensor(-2.2156, dtype=torch.float64) tensor(7.9571, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9439, dtype=torch.float64) delta_t tensor(-0.6569, dtype=torch.float64)
4 gae_duplicate tensor(-3.6123, dtype=torch.float64) tensor(3.8863, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3521, dtype=torch.float64) delta_t tensor(-0.2535, dtype=torch.float64)
3 gae_duplicate tensor(-1.1836, dtype=torch.float64) tensor(3.0919, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5970, dtype=torch.float64) delta_t tensor(-0.5262, dtype=torch.float64)
2 gae_duplicate tensor(-1.0844, dtype=torch.float64) tensor(6.6284, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:400.0105285644531
value loss:96.59770202636719
entropies:183.30316162109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.863240003585815 seconds
19 rew tensor(0.7810, dtype=torch.float64) delta_t tensor(0.3812, dtype=torch.float64)
19 gae_duplicate tensor(0.1576, dtype=torch.float64) tensor(-4.5511, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7639, dtype=torch.float64) delta_t tensor(0.3030, dtype=torch.float64)
18 gae_duplicate tensor(0.1755, dtype=torch.float64) tensor(-4.3574, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7478, dtype=torch.float64) delta_t tensor(0.3803, dtype=torch.float64)
17 gae_duplicate tensor(0.2297, dtype=torch.float64) tensor(-4.7612, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7221, dtype=torch.float64) delta_t tensor(0.4291, dtype=torch.float64)
16 gae_duplicate tensor(0.2488, dtype=torch.float64) tensor(-5.8897, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7744, dtype=torch.float64) delta_t tensor(0.6232, dtype=torch.float64)
15 gae_duplicate tensor(0.4518, dtype=torch.float64) tensor(-5.0364, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7414, dtype=torch.float64) delta_t tensor(0.5601, dtype=torch.float64)
14 gae_duplicate tensor(0.4154, dtype=torch.float64) tensor(-6.2733, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5833, dtype=torch.float64) delta_t tensor(0.4279, dtype=torch.float64)
13 gae_duplicate tensor(0.3254, dtype=torch.float64) tensor(-6.0136, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5555, dtype=torch.float64) delta_t tensor(0.3636, dtype=torch.float64)
12 gae_duplicate tensor(0.0495, dtype=torch.float64) tensor(-4.6904, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5060, dtype=torch.float64) delta_t tensor(0.2400, dtype=torch.float64)
11 gae_duplicate tensor(-0.2256, dtype=torch.float64) tensor(-3.1947, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1135, dtype=torch.float64) delta_t tensor(-0.3562, dtype=torch.float64)
10 gae_duplicate tensor(-1.2961, dtype=torch.float64) tensor(5.1562, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2934, dtype=torch.float64) delta_t tensor(0.3836, dtype=torch.float64)
9 gae_duplicate tensor(-0.5981, dtype=torch.float64) tensor(-3.0750, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0849, dtype=torch.float64) delta_t tensor(0.0685, dtype=torch.float64)
8 gae_duplicate tensor(-0.2422, dtype=torch.float64) tensor(-0.9225, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4134, dtype=torch.float64) delta_t tensor(-0.4391, dtype=torch.float64)
7 gae_duplicate tensor(-0.8989, dtype=torch.float64) tensor(4.8803, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8466, dtype=torch.float64) delta_t tensor(-0.7398, dtype=torch.float64)
6 gae_duplicate tensor(-1.5021, dtype=torch.float64) tensor(10.4619, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0400, dtype=torch.float64) delta_t tensor(-0.8119, dtype=torch.float64)
5 gae_duplicate tensor(-1.6784, dtype=torch.float64) tensor(9.7922, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7733, dtype=torch.float64) delta_t tensor(-0.4255, dtype=torch.float64)
4 gae_duplicate tensor(-1.2116, dtype=torch.float64) tensor(4.2843, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7502, dtype=torch.float64) delta_t tensor(-0.6685, dtype=torch.float64)
3 gae_duplicate tensor(-1.3781, dtype=torch.float64) tensor(7.5641, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3014, dtype=torch.float64) delta_t tensor(-0.3213, dtype=torch.float64)
2 gae_duplicate tensor(-0.8334, dtype=torch.float64) tensor(4.3317, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:49.73237609863281
value loss:68.1259994506836
entropies:182.59271240234375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2345.9697)
ToM Target loss= tensor(1804.9604)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.826250076293945 seconds
19 rew tensor(0.7719, dtype=torch.float64) delta_t tensor(0.3406, dtype=torch.float64)
19 gae_duplicate tensor(-0.0250, dtype=torch.float64) tensor(-5.0547, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7640, dtype=torch.float64) delta_t tensor(0.3561, dtype=torch.float64)
18 gae_duplicate tensor(-0.0468, dtype=torch.float64) tensor(-3.0163, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7397, dtype=torch.float64) delta_t tensor(0.3156, dtype=torch.float64)
17 gae_duplicate tensor(0.0691, dtype=torch.float64) tensor(-3.6172, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6828, dtype=torch.float64) delta_t tensor(0.3445, dtype=torch.float64)
16 gae_duplicate tensor(-0.1180, dtype=torch.float64) tensor(-4.7478, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5849, dtype=torch.float64) delta_t tensor(0.5214, dtype=torch.float64)
15 gae_duplicate tensor(-0.6120, dtype=torch.float64) tensor(-4.5515, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7896, dtype=torch.float64) delta_t tensor(0.5824, dtype=torch.float64)
14 gae_duplicate tensor(0.3436, dtype=torch.float64) tensor(-6.9654, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6466, dtype=torch.float64) delta_t tensor(0.4971, dtype=torch.float64)
13 gae_duplicate tensor(0.3521, dtype=torch.float64) tensor(-3.3351, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5359, dtype=torch.float64) delta_t tensor(0.3836, dtype=torch.float64)
12 gae_duplicate tensor(0.0896, dtype=torch.float64) tensor(-2.8457, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3875, dtype=torch.float64) delta_t tensor(0.1979, dtype=torch.float64)
11 gae_duplicate tensor(-0.6542, dtype=torch.float64) tensor(-1.4936, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2343, dtype=torch.float64) delta_t tensor(-0.0772, dtype=torch.float64)
10 gae_duplicate tensor(-0.5893, dtype=torch.float64) tensor(0.4139, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4574, dtype=torch.float64) delta_t tensor(-0.6713, dtype=torch.float64)
9 gae_duplicate tensor(-2.4254, dtype=torch.float64) tensor(10.2732, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6034, dtype=torch.float64) delta_t tensor(-0.6829, dtype=torch.float64)
8 gae_duplicate tensor(-1.7339, dtype=torch.float64) tensor(9.0223, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0209, dtype=torch.float64) delta_t tensor(-0.9413, dtype=torch.float64)
7 gae_duplicate tensor(-2.7772, dtype=torch.float64) tensor(12.1862, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4543, dtype=torch.float64) delta_t tensor(-0.4493, dtype=torch.float64)
6 gae_duplicate tensor(-1.3676, dtype=torch.float64) tensor(8.8211, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2341, dtype=torch.float64) delta_t tensor(-1.0234, dtype=torch.float64)
5 gae_duplicate tensor(-2.3565, dtype=torch.float64) tensor(7.0305, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1205, dtype=torch.float64) delta_t tensor(-2.0120, dtype=torch.float64)
4 gae_duplicate tensor(-9.3144, dtype=torch.float64) tensor(22.8475, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5597, dtype=torch.float64) delta_t tensor(-0.3955, dtype=torch.float64)
3 gae_duplicate tensor(-1.3840, dtype=torch.float64) tensor(5.9855, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1401, dtype=torch.float64) delta_t tensor(-0.2724, dtype=torch.float64)
2 gae_duplicate tensor(-0.6864, dtype=torch.float64) tensor(3.7066, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1640.5389404296875
value loss:259.47491455078125
entropies:182.2123260498047
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.932877063751221 seconds
19 rew tensor(0.7901, dtype=torch.float64) delta_t tensor(0.3824, dtype=torch.float64)
19 gae_duplicate tensor(0.0746, dtype=torch.float64) tensor(-5.2180, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7904, dtype=torch.float64) delta_t tensor(0.3794, dtype=torch.float64)
18 gae_duplicate tensor(0.2469, dtype=torch.float64) tensor(-5.8771, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7018, dtype=torch.float64) delta_t tensor(0.2730, dtype=torch.float64)
17 gae_duplicate tensor(-0.0283, dtype=torch.float64) tensor(-3.1340, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6577, dtype=torch.float64) delta_t tensor(0.2627, dtype=torch.float64)
16 gae_duplicate tensor(-0.3558, dtype=torch.float64) tensor(-3.1135, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5597, dtype=torch.float64) delta_t tensor(0.1958, dtype=torch.float64)
15 gae_duplicate tensor(-0.6867, dtype=torch.float64) tensor(-1.4669, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4814, dtype=torch.float64) delta_t tensor(0.1626, dtype=torch.float64)
14 gae_duplicate tensor(-0.4503, dtype=torch.float64) tensor(-1.8507, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2729, dtype=torch.float64) delta_t tensor(0.3002, dtype=torch.float64)
13 gae_duplicate tensor(-0.2678, dtype=torch.float64) tensor(-3.6792, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0205, dtype=torch.float64) delta_t tensor(0.0315, dtype=torch.float64)
12 gae_duplicate tensor(-1.7733, dtype=torch.float64) tensor(1.9663, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2536, dtype=torch.float64) delta_t tensor(-0.1473, dtype=torch.float64)
11 gae_duplicate tensor(-1.1897, dtype=torch.float64) tensor(2.4332, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1064, dtype=torch.float64) delta_t tensor(-0.1647, dtype=torch.float64)
10 gae_duplicate tensor(-1.4146, dtype=torch.float64) tensor(0.8386, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0577, dtype=torch.float64) delta_t tensor(0.2375, dtype=torch.float64)
9 gae_duplicate tensor(-0.1234, dtype=torch.float64) tensor(-2.6676, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0701, dtype=torch.float64) delta_t tensor(0.0651, dtype=torch.float64)
8 gae_duplicate tensor(-0.7564, dtype=torch.float64) tensor(-1.5493, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4679, dtype=torch.float64) delta_t tensor(-0.3652, dtype=torch.float64)
7 gae_duplicate tensor(-0.9851, dtype=torch.float64) tensor(4.8449, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6436, dtype=torch.float64) delta_t tensor(-0.3599, dtype=torch.float64)
6 gae_duplicate tensor(-0.7220, dtype=torch.float64) tensor(4.2926, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3852, dtype=torch.float64) delta_t tensor(-0.1553, dtype=torch.float64)
5 gae_duplicate tensor(-1.1375, dtype=torch.float64) tensor(4.3178, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5035, dtype=torch.float64) delta_t tensor(-0.2170, dtype=torch.float64)
4 gae_duplicate tensor(-0.9943, dtype=torch.float64) tensor(1.6648, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1812, dtype=torch.float64) delta_t tensor(-0.1284, dtype=torch.float64)
3 gae_duplicate tensor(-0.8350, dtype=torch.float64) tensor(1.1826, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2998, dtype=torch.float64) delta_t tensor(-0.3611, dtype=torch.float64)
2 gae_duplicate tensor(-0.5091, dtype=torch.float64) tensor(3.1654, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:105.07472229003906
value loss:46.618011474609375
entropies:186.2891387939453
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.868434906005859 seconds
19 rew tensor(0.7907, dtype=torch.float64) delta_t tensor(0.3277, dtype=torch.float64)
19 gae_duplicate tensor(0.1775, dtype=torch.float64) tensor(-2.2430, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7732, dtype=torch.float64) delta_t tensor(0.4189, dtype=torch.float64)
18 gae_duplicate tensor(0.3346, dtype=torch.float64) tensor(-4.0856, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7824, dtype=torch.float64) delta_t tensor(0.4439, dtype=torch.float64)
17 gae_duplicate tensor(0.3745, dtype=torch.float64) tensor(-4.7343, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7569, dtype=torch.float64) delta_t tensor(0.4552, dtype=torch.float64)
16 gae_duplicate tensor(0.3505, dtype=torch.float64) tensor(-4.4318, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7313, dtype=torch.float64) delta_t tensor(0.3494, dtype=torch.float64)
15 gae_duplicate tensor(0.0923, dtype=torch.float64) tensor(-3.6053, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6702, dtype=torch.float64) delta_t tensor(0.3365, dtype=torch.float64)
14 gae_duplicate tensor(-0.3499, dtype=torch.float64) tensor(-3.1888, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6409, dtype=torch.float64) delta_t tensor(0.5712, dtype=torch.float64)
13 gae_duplicate tensor(0.2043, dtype=torch.float64) tensor(-7.4753, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5329, dtype=torch.float64) delta_t tensor(0.2744, dtype=torch.float64)
12 gae_duplicate tensor(0.1051, dtype=torch.float64) tensor(-4.2169, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5382, dtype=torch.float64) delta_t tensor(0.4015, dtype=torch.float64)
11 gae_duplicate tensor(-0.1448, dtype=torch.float64) tensor(-4.4850, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4654, dtype=torch.float64) delta_t tensor(0.4974, dtype=torch.float64)
10 gae_duplicate tensor(0.0964, dtype=torch.float64) tensor(-5.3164, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2874, dtype=torch.float64) delta_t tensor(-0.3587, dtype=torch.float64)
9 gae_duplicate tensor(-2.9844, dtype=torch.float64) tensor(5.9330, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5070, dtype=torch.float64) delta_t tensor(-0.3921, dtype=torch.float64)
8 gae_duplicate tensor(-2.3420, dtype=torch.float64) tensor(3.4021, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2301, dtype=torch.float64) delta_t tensor(-0.1128, dtype=torch.float64)
7 gae_duplicate tensor(-0.5576, dtype=torch.float64) tensor(0.4682, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8988, dtype=torch.float64) delta_t tensor(-0.8980, dtype=torch.float64)
6 gae_duplicate tensor(-1.1690, dtype=torch.float64) tensor(8.2460, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5135, dtype=torch.float64) delta_t tensor(-1.2367, dtype=torch.float64)
5 gae_duplicate tensor(-1.9224, dtype=torch.float64) tensor(13.7336, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0620, dtype=torch.float64) delta_t tensor(0.0510, dtype=torch.float64)
4 gae_duplicate tensor(-1.9275, dtype=torch.float64) tensor(-0.9304, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9286, dtype=torch.float64) delta_t tensor(-0.7608, dtype=torch.float64)
3 gae_duplicate tensor(-1.2487, dtype=torch.float64) tensor(7.8026, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1610, dtype=torch.float64) delta_t tensor(-0.1938, dtype=torch.float64)
2 gae_duplicate tensor(-0.5414, dtype=torch.float64) tensor(2.9077, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:46.705692291259766
value loss:92.33207702636719
entropies:184.46209716796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.06057596206665 seconds
19 rew tensor(0.4589, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
19 gae_duplicate tensor(-1.1131, dtype=torch.float64) tensor(-0.1206, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7133, dtype=torch.float64) delta_t tensor(0.3068, dtype=torch.float64)
18 gae_duplicate tensor(-0.0557, dtype=torch.float64) tensor(-2.6406, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6534, dtype=torch.float64) delta_t tensor(0.2332, dtype=torch.float64)
17 gae_duplicate tensor(-0.1245, dtype=torch.float64) tensor(-2.9910, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5083, dtype=torch.float64) delta_t tensor(0.1828, dtype=torch.float64)
16 gae_duplicate tensor(-0.3289, dtype=torch.float64) tensor(-0.6783, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5707, dtype=torch.float64) delta_t tensor(0.3815, dtype=torch.float64)
15 gae_duplicate tensor(-0.6621, dtype=torch.float64) tensor(-3.9950, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7758, dtype=torch.float64) delta_t tensor(0.5253, dtype=torch.float64)
14 gae_duplicate tensor(0.1566, dtype=torch.float64) tensor(-6.2321, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7398, dtype=torch.float64) delta_t tensor(0.5674, dtype=torch.float64)
13 gae_duplicate tensor(0.4733, dtype=torch.float64) tensor(-8.4831, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7570, dtype=torch.float64) delta_t tensor(0.5952, dtype=torch.float64)
12 gae_duplicate tensor(0.5641, dtype=torch.float64) tensor(-5.6597, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7412, dtype=torch.float64) delta_t tensor(0.7629, dtype=torch.float64)
11 gae_duplicate tensor(0.3834, dtype=torch.float64) tensor(-8.9660, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4424, dtype=torch.float64) delta_t tensor(0.3299, dtype=torch.float64)
10 gae_duplicate tensor(-0.5200, dtype=torch.float64) tensor(-4.7544, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2339, dtype=torch.float64) delta_t tensor(0.1026, dtype=torch.float64)
9 gae_duplicate tensor(-0.7712, dtype=torch.float64) tensor(-1.7959, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3122, dtype=torch.float64) delta_t tensor(-0.1499, dtype=torch.float64)
8 gae_duplicate tensor(-1.1460, dtype=torch.float64) tensor(-0.3904, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3819, dtype=torch.float64) delta_t tensor(-0.4761, dtype=torch.float64)
7 gae_duplicate tensor(-1.6966, dtype=torch.float64) tensor(8.3563, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0161, dtype=torch.float64) delta_t tensor(-0.9828, dtype=torch.float64)
6 gae_duplicate tensor(-2.4498, dtype=torch.float64) tensor(11.9047, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1564, dtype=torch.float64) delta_t tensor(-0.8997, dtype=torch.float64)
5 gae_duplicate tensor(-2.6769, dtype=torch.float64) tensor(12.1804, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0461, dtype=torch.float64) delta_t tensor(-1.7154, dtype=torch.float64)
4 gae_duplicate tensor(-4.5605, dtype=torch.float64) tensor(15.9956, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4082, dtype=torch.float64) delta_t tensor(-0.3293, dtype=torch.float64)
3 gae_duplicate tensor(-0.8996, dtype=torch.float64) tensor(4.9505, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3535, dtype=torch.float64) delta_t tensor(-0.3385, dtype=torch.float64)
2 gae_duplicate tensor(-0.8150, dtype=torch.float64) tensor(2.6970, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-370.5727233886719
value loss:144.52389526367188
entropies:183.2530975341797
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.668521881103516 seconds
19 rew tensor(0.4610, dtype=torch.float64) delta_t tensor(-0.0113, dtype=torch.float64)
19 gae_duplicate tensor(-1.1932, dtype=torch.float64) tensor(-0.8807, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7675, dtype=torch.float64) delta_t tensor(0.3950, dtype=torch.float64)
18 gae_duplicate tensor(-0.0783, dtype=torch.float64) tensor(-4.9618, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7351, dtype=torch.float64) delta_t tensor(0.4371, dtype=torch.float64)
17 gae_duplicate tensor(0.0438, dtype=torch.float64) tensor(-5.6650, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6782, dtype=torch.float64) delta_t tensor(0.4483, dtype=torch.float64)
16 gae_duplicate tensor(-0.1273, dtype=torch.float64) tensor(-6.2848, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5807, dtype=torch.float64) delta_t tensor(0.5038, dtype=torch.float64)
15 gae_duplicate tensor(-0.6018, dtype=torch.float64) tensor(-7.7086, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7421, dtype=torch.float64) delta_t tensor(0.8474, dtype=torch.float64)
14 gae_duplicate tensor(0.5643, dtype=torch.float64) tensor(-10.3249, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5727, dtype=torch.float64) delta_t tensor(0.5651, dtype=torch.float64)
13 gae_duplicate tensor(0.3069, dtype=torch.float64) tensor(-8.1025, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4430, dtype=torch.float64) delta_t tensor(0.3189, dtype=torch.float64)
12 gae_duplicate tensor(-0.1890, dtype=torch.float64) tensor(-4.7231, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2079, dtype=torch.float64) delta_t tensor(-0.0638, dtype=torch.float64)
11 gae_duplicate tensor(-0.7236, dtype=torch.float64) tensor(0.9405, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0147, dtype=torch.float64) delta_t tensor(-0.0945, dtype=torch.float64)
10 gae_duplicate tensor(-0.6585, dtype=torch.float64) tensor(0.9167, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0179, dtype=torch.float64) delta_t tensor(-0.1251, dtype=torch.float64)
9 gae_duplicate tensor(-0.7648, dtype=torch.float64) tensor(2.2412, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2351, dtype=torch.float64) delta_t tensor(-0.1310, dtype=torch.float64)
8 gae_duplicate tensor(-0.9786, dtype=torch.float64) tensor(0.8137, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4047, dtype=torch.float64) delta_t tensor(-0.4155, dtype=torch.float64)
7 gae_duplicate tensor(-1.9792, dtype=torch.float64) tensor(2.7178, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1148, dtype=torch.float64) delta_t tensor(-1.0931, dtype=torch.float64)
6 gae_duplicate tensor(-2.4844, dtype=torch.float64) tensor(7.9331, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0568, dtype=torch.float64) delta_t tensor(-0.8938, dtype=torch.float64)
5 gae_duplicate tensor(-2.1438, dtype=torch.float64) tensor(13.6974, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5055, dtype=torch.float64) delta_t tensor(-0.3227, dtype=torch.float64)
4 gae_duplicate tensor(-4.6316, dtype=torch.float64) tensor(6.6168, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3854, dtype=torch.float64) delta_t tensor(-0.2164, dtype=torch.float64)
3 gae_duplicate tensor(-0.9113, dtype=torch.float64) tensor(1.7718, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1587, dtype=torch.float64) delta_t tensor(-0.2231, dtype=torch.float64)
2 gae_duplicate tensor(-0.4078, dtype=torch.float64) tensor(2.1352, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:285.9359436035156
value loss:118.6903076171875
entropies:184.91600036621094
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2311.6470)
ToM Target loss= tensor(1806.9796)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.86024284362793 seconds
19 rew tensor(0.7027, dtype=torch.float64) delta_t tensor(0.1596, dtype=torch.float64)
19 gae_duplicate tensor(-0.2471, dtype=torch.float64) tensor(-2.5824, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5972, dtype=torch.float64) delta_t tensor(0.1949, dtype=torch.float64)
18 gae_duplicate tensor(-0.4555, dtype=torch.float64) tensor(-1.4011, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4266, dtype=torch.float64) delta_t tensor(0.0688, dtype=torch.float64)
17 gae_duplicate tensor(-1.1459, dtype=torch.float64) tensor(1.5412, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6329, dtype=torch.float64) delta_t tensor(0.3558, dtype=torch.float64)
16 gae_duplicate tensor(-0.2772, dtype=torch.float64) tensor(-5.7903, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5156, dtype=torch.float64) delta_t tensor(0.2531, dtype=torch.float64)
15 gae_duplicate tensor(-0.8075, dtype=torch.float64) tensor(-1.5849, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6909, dtype=torch.float64) delta_t tensor(0.4307, dtype=torch.float64)
14 gae_duplicate tensor(-0.3969, dtype=torch.float64) tensor(-3.0308, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7934, dtype=torch.float64) delta_t tensor(0.4721, dtype=torch.float64)
13 gae_duplicate tensor(0.1347, dtype=torch.float64) tensor(-3.8078, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7937, dtype=torch.float64) delta_t tensor(0.4351, dtype=torch.float64)
12 gae_duplicate tensor(0.1602, dtype=torch.float64) tensor(-4.0528, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7431, dtype=torch.float64) delta_t tensor(0.6703, dtype=torch.float64)
11 gae_duplicate tensor(0.4551, dtype=torch.float64) tensor(-11.4608, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6412, dtype=torch.float64) delta_t tensor(0.6007, dtype=torch.float64)
10 gae_duplicate tensor(0.4147, dtype=torch.float64) tensor(-8.0419, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0580, dtype=torch.float64) delta_t tensor(-0.2489, dtype=torch.float64)
9 gae_duplicate tensor(-1.0300, dtype=torch.float64) tensor(2.7023, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7964, dtype=torch.float64) delta_t tensor(-0.9066, dtype=torch.float64)
8 gae_duplicate tensor(-2.9127, dtype=torch.float64) tensor(8.2609, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8273, dtype=torch.float64) delta_t tensor(-0.8899, dtype=torch.float64)
7 gae_duplicate tensor(-2.0910, dtype=torch.float64) tensor(6.0514, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2684, dtype=torch.float64) delta_t tensor(-1.0176, dtype=torch.float64)
6 gae_duplicate tensor(-2.6066, dtype=torch.float64) tensor(14.8815, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2792, dtype=torch.float64) delta_t tensor(-1.1844, dtype=torch.float64)
5 gae_duplicate tensor(-2.3926, dtype=torch.float64) tensor(12.3898, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0630, dtype=torch.float64) delta_t tensor(-1.8610, dtype=torch.float64)
4 gae_duplicate tensor(-4.0403, dtype=torch.float64) tensor(20.7577, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2579, dtype=torch.float64) delta_t tensor(0.0328, dtype=torch.float64)
3 gae_duplicate tensor(-0.8474, dtype=torch.float64) tensor(3.3818, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4669, dtype=torch.float64) delta_t tensor(-0.3492, dtype=torch.float64)
2 gae_duplicate tensor(-0.7585, dtype=torch.float64) tensor(5.0334, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1229.987548828125
value loss:171.58419799804688
entropies:183.7984161376953
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.620991945266724 seconds
19 rew tensor(0.7584, dtype=torch.float64) delta_t tensor(0.2770, dtype=torch.float64)
19 gae_duplicate tensor(0.0408, dtype=torch.float64) tensor(-3.0737, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7416, dtype=torch.float64) delta_t tensor(0.3089, dtype=torch.float64)
18 gae_duplicate tensor(0.0287, dtype=torch.float64) tensor(-4.4266, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7069, dtype=torch.float64) delta_t tensor(0.3424, dtype=torch.float64)
17 gae_duplicate tensor(-0.0717, dtype=torch.float64) tensor(-4.4600, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6380, dtype=torch.float64) delta_t tensor(0.2420, dtype=torch.float64)
16 gae_duplicate tensor(-0.0359, dtype=torch.float64) tensor(-2.3204, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4738, dtype=torch.float64) delta_t tensor(0.1675, dtype=torch.float64)
15 gae_duplicate tensor(-0.6171, dtype=torch.float64) tensor(-0.9936, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5901, dtype=torch.float64) delta_t tensor(0.2998, dtype=torch.float64)
14 gae_duplicate tensor(-0.7008, dtype=torch.float64) tensor(-1.0763, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7432, dtype=torch.float64) delta_t tensor(0.4702, dtype=torch.float64)
13 gae_duplicate tensor(0.3640, dtype=torch.float64) tensor(-4.4246, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7256, dtype=torch.float64) delta_t tensor(0.4772, dtype=torch.float64)
12 gae_duplicate tensor(0.3464, dtype=torch.float64) tensor(-4.7800, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5286, dtype=torch.float64) delta_t tensor(0.5557, dtype=torch.float64)
11 gae_duplicate tensor(0.5078, dtype=torch.float64) tensor(-5.0664, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1904, dtype=torch.float64) delta_t tensor(-0.0451, dtype=torch.float64)
10 gae_duplicate tensor(-0.4890, dtype=torch.float64) tensor(0.9212, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2552, dtype=torch.float64) delta_t tensor(-0.3924, dtype=torch.float64)
9 gae_duplicate tensor(-1.8007, dtype=torch.float64) tensor(5.5382, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2921, dtype=torch.float64) delta_t tensor(-0.2783, dtype=torch.float64)
8 gae_duplicate tensor(-0.9772, dtype=torch.float64) tensor(2.7380, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5252, dtype=torch.float64) delta_t tensor(-0.3818, dtype=torch.float64)
7 gae_duplicate tensor(-1.9580, dtype=torch.float64) tensor(5.7790, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6784, dtype=torch.float64) delta_t tensor(-0.7439, dtype=torch.float64)
6 gae_duplicate tensor(-2.4879, dtype=torch.float64) tensor(7.6452, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1636, dtype=torch.float64) delta_t tensor(-1.0915, dtype=torch.float64)
5 gae_duplicate tensor(-2.1587, dtype=torch.float64) tensor(8.7284, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0740, dtype=torch.float64) delta_t tensor(-0.8177, dtype=torch.float64)
4 gae_duplicate tensor(-2.0225, dtype=torch.float64) tensor(10.4948, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2414, dtype=torch.float64) delta_t tensor(-0.0970, dtype=torch.float64)
3 gae_duplicate tensor(-0.6203, dtype=torch.float64) tensor(1.7767, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3871, dtype=torch.float64) delta_t tensor(-0.4354, dtype=torch.float64)
2 gae_duplicate tensor(-0.8684, dtype=torch.float64) tensor(3.9013, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-641.8773193359375
value loss:86.13504028320312
entropies:185.7130126953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.813194036483765 seconds
19 rew tensor(0.7779, dtype=torch.float64) delta_t tensor(0.3588, dtype=torch.float64)
19 gae_duplicate tensor(-0.0777, dtype=torch.float64) tensor(-2.6655, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7700, dtype=torch.float64) delta_t tensor(0.3973, dtype=torch.float64)
18 gae_duplicate tensor(-0.0699, dtype=torch.float64) tensor(-4.4226, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7375, dtype=torch.float64) delta_t tensor(0.3514, dtype=torch.float64)
17 gae_duplicate tensor(-0.0273, dtype=torch.float64) tensor(-4.6687, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6633, dtype=torch.float64) delta_t tensor(0.4113, dtype=torch.float64)
16 gae_duplicate tensor(-0.1821, dtype=torch.float64) tensor(-3.7480, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5742, dtype=torch.float64) delta_t tensor(0.3410, dtype=torch.float64)
15 gae_duplicate tensor(-0.7006, dtype=torch.float64) tensor(-1.5276, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7794, dtype=torch.float64) delta_t tensor(0.6794, dtype=torch.float64)
14 gae_duplicate tensor(0.5297, dtype=torch.float64) tensor(-6.0667, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6839, dtype=torch.float64) delta_t tensor(0.6629, dtype=torch.float64)
13 gae_duplicate tensor(0.5154, dtype=torch.float64) tensor(-7.9701, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5718, dtype=torch.float64) delta_t tensor(0.4623, dtype=torch.float64)
12 gae_duplicate tensor(0.0582, dtype=torch.float64) tensor(-7.7496, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0637, dtype=torch.float64) delta_t tensor(-0.1538, dtype=torch.float64)
11 gae_duplicate tensor(-2.1498, dtype=torch.float64) tensor(-0.8477, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3308, dtype=torch.float64) delta_t tensor(-0.6006, dtype=torch.float64)
10 gae_duplicate tensor(-2.6392, dtype=torch.float64) tensor(5.1308, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5765, dtype=torch.float64) delta_t tensor(-0.5684, dtype=torch.float64)
9 gae_duplicate tensor(-3.7159, dtype=torch.float64) tensor(5.7791, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4278, dtype=torch.float64) delta_t tensor(-0.4532, dtype=torch.float64)
8 gae_duplicate tensor(-1.8900, dtype=torch.float64) tensor(5.7620, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5707, dtype=torch.float64) delta_t tensor(-0.5602, dtype=torch.float64)
7 gae_duplicate tensor(-2.1400, dtype=torch.float64) tensor(5.7111, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9503, dtype=torch.float64) delta_t tensor(-0.7689, dtype=torch.float64)
6 gae_duplicate tensor(-1.8027, dtype=torch.float64) tensor(8.1719, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8911, dtype=torch.float64) delta_t tensor(-0.6602, dtype=torch.float64)
5 gae_duplicate tensor(-2.1503, dtype=torch.float64) tensor(8.4710, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7740, dtype=torch.float64) delta_t tensor(-0.5051, dtype=torch.float64)
4 gae_duplicate tensor(-1.7342, dtype=torch.float64) tensor(5.7426, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0270, dtype=torch.float64) delta_t tensor(0.0757, dtype=torch.float64)
3 gae_duplicate tensor(-0.5034, dtype=torch.float64) tensor(-0.0173, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7506, dtype=torch.float64) delta_t tensor(-0.6399, dtype=torch.float64)
2 gae_duplicate tensor(-1.4074, dtype=torch.float64) tensor(4.3797, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-374.0471496582031
value loss:123.08439636230469
entropies:185.13404846191406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8180742263793945 seconds
19 rew tensor(0.6662, dtype=torch.float64) delta_t tensor(0.3300, dtype=torch.float64)
19 gae_duplicate tensor(-0.5788, dtype=torch.float64) tensor(-2.6109, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5541, dtype=torch.float64) delta_t tensor(0.3266, dtype=torch.float64)
18 gae_duplicate tensor(-0.8043, dtype=torch.float64) tensor(-1.1497, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7782, dtype=torch.float64) delta_t tensor(0.5795, dtype=torch.float64)
17 gae_duplicate tensor(0.5385, dtype=torch.float64) tensor(-4.8801, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7785, dtype=torch.float64) delta_t tensor(0.4943, dtype=torch.float64)
16 gae_duplicate tensor(0.2667, dtype=torch.float64) tensor(-4.9674, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7026, dtype=torch.float64) delta_t tensor(0.4704, dtype=torch.float64)
15 gae_duplicate tensor(0.2857, dtype=torch.float64) tensor(-5.1034, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6192, dtype=torch.float64) delta_t tensor(0.2927, dtype=torch.float64)
14 gae_duplicate tensor(0.0253, dtype=torch.float64) tensor(-3.0522, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5753, dtype=torch.float64) delta_t tensor(0.1607, dtype=torch.float64)
13 gae_duplicate tensor(-0.0836, dtype=torch.float64) tensor(-3.3571, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7232, dtype=torch.float64) delta_t tensor(0.3991, dtype=torch.float64)
12 gae_duplicate tensor(-0.0280, dtype=torch.float64) tensor(-3.4770, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6294, dtype=torch.float64) delta_t tensor(0.4804, dtype=torch.float64)
11 gae_duplicate tensor(0.1129, dtype=torch.float64) tensor(-5.7020, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4249, dtype=torch.float64) delta_t tensor(0.3410, dtype=torch.float64)
10 gae_duplicate tensor(0.0167, dtype=torch.float64) tensor(-3.7607, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0347, dtype=torch.float64) delta_t tensor(-0.1635, dtype=torch.float64)
9 gae_duplicate tensor(-1.3023, dtype=torch.float64) tensor(1.1704, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0300, dtype=torch.float64) delta_t tensor(-1.0155, dtype=torch.float64)
8 gae_duplicate tensor(-3.3342, dtype=torch.float64) tensor(10.2474, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0313, dtype=torch.float64) delta_t tensor(-0.9343, dtype=torch.float64)
7 gae_duplicate tensor(-2.8649, dtype=torch.float64) tensor(12.4601, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9405, dtype=torch.float64) delta_t tensor(-0.8108, dtype=torch.float64)
6 gae_duplicate tensor(-2.1011, dtype=torch.float64) tensor(10.2519, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7877, dtype=torch.float64) delta_t tensor(-0.6552, dtype=torch.float64)
5 gae_duplicate tensor(-2.9112, dtype=torch.float64) tensor(4.9280, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3198, dtype=torch.float64) delta_t tensor(-1.0464, dtype=torch.float64)
4 gae_duplicate tensor(-5.0144, dtype=torch.float64) tensor(9.3770, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5493, dtype=torch.float64) delta_t tensor(-0.2883, dtype=torch.float64)
3 gae_duplicate tensor(-1.0181, dtype=torch.float64) tensor(3.8700, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5635, dtype=torch.float64) delta_t tensor(-0.5388, dtype=torch.float64)
2 gae_duplicate tensor(-1.0860, dtype=torch.float64) tensor(8.3949, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-848.4071044921875
value loss:152.8289794921875
entropies:185.52626037597656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.813607931137085 seconds
19 rew tensor(0.7867, dtype=torch.float64) delta_t tensor(0.3580, dtype=torch.float64)
19 gae_duplicate tensor(0.0763, dtype=torch.float64) tensor(-2.8839, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7705, dtype=torch.float64) delta_t tensor(0.3521, dtype=torch.float64)
18 gae_duplicate tensor(0.1163, dtype=torch.float64) tensor(-4.3761, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7462, dtype=torch.float64) delta_t tensor(0.3671, dtype=torch.float64)
17 gae_duplicate tensor(0.0676, dtype=torch.float64) tensor(-5.2872, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7136, dtype=torch.float64) delta_t tensor(0.3418, dtype=torch.float64)
16 gae_duplicate tensor(-0.1170, dtype=torch.float64) tensor(-4.6851, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6317, dtype=torch.float64) delta_t tensor(0.4584, dtype=torch.float64)
15 gae_duplicate tensor(-0.2438, dtype=torch.float64) tensor(-5.7586, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7703, dtype=torch.float64) delta_t tensor(0.6570, dtype=torch.float64)
14 gae_duplicate tensor(0.4595, dtype=torch.float64) tensor(-8.0331, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6948, dtype=torch.float64) delta_t tensor(0.5662, dtype=torch.float64)
13 gae_duplicate tensor(0.2344, dtype=torch.float64) tensor(-5.3296, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5596, dtype=torch.float64) delta_t tensor(0.7141, dtype=torch.float64)
12 gae_duplicate tensor(0.4911, dtype=torch.float64) tensor(-6.3628, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4191, dtype=torch.float64) delta_t tensor(0.3952, dtype=torch.float64)
11 gae_duplicate tensor(0.2378, dtype=torch.float64) tensor(-5.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3072, dtype=torch.float64) delta_t tensor(0.0852, dtype=torch.float64)
10 gae_duplicate tensor(-0.1426, dtype=torch.float64) tensor(-1.9087, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1525, dtype=torch.float64) delta_t tensor(-0.1467, dtype=torch.float64)
9 gae_duplicate tensor(-0.5776, dtype=torch.float64) tensor(0.9553, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3376, dtype=torch.float64) delta_t tensor(-0.4802, dtype=torch.float64)
8 gae_duplicate tensor(-1.1231, dtype=torch.float64) tensor(3.5639, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8972, dtype=torch.float64) delta_t tensor(-0.6466, dtype=torch.float64)
7 gae_duplicate tensor(-1.5768, dtype=torch.float64) tensor(7.0578, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0776, dtype=torch.float64) delta_t tensor(-0.9448, dtype=torch.float64)
6 gae_duplicate tensor(-3.1825, dtype=torch.float64) tensor(16.4036, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0343, dtype=torch.float64) delta_t tensor(-0.7772, dtype=torch.float64)
5 gae_duplicate tensor(-2.0293, dtype=torch.float64) tensor(7.1984, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9137, dtype=torch.float64) delta_t tensor(-1.7472, dtype=torch.float64)
4 gae_duplicate tensor(-5.1490, dtype=torch.float64) tensor(16.2108, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6244, dtype=torch.float64) delta_t tensor(-0.3479, dtype=torch.float64)
3 gae_duplicate tensor(-0.8260, dtype=torch.float64) tensor(4.1233, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4513, dtype=torch.float64) delta_t tensor(-0.3103, dtype=torch.float64)
2 gae_duplicate tensor(-1.0815, dtype=torch.float64) tensor(4.4589, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-401.0989990234375
value loss:160.4645233154297
entropies:184.33164978027344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2315.8364)
ToM Target loss= tensor(1806.1589)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.871084928512573 seconds
19 rew tensor(0.7955, dtype=torch.float64) delta_t tensor(0.4386, dtype=torch.float64)
19 gae_duplicate tensor(0.2000, dtype=torch.float64) tensor(-4.5227, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7958, dtype=torch.float64) delta_t tensor(0.5598, dtype=torch.float64)
18 gae_duplicate tensor(0.3533, dtype=torch.float64) tensor(-3.5299, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7961, dtype=torch.float64) delta_t tensor(0.4982, dtype=torch.float64)
17 gae_duplicate tensor(0.1662, dtype=torch.float64) tensor(-4.6275, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7879, dtype=torch.float64) delta_t tensor(0.6277, dtype=torch.float64)
16 gae_duplicate tensor(0.4610, dtype=torch.float64) tensor(-8.3767, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7967, dtype=torch.float64) delta_t tensor(0.6160, dtype=torch.float64)
15 gae_duplicate tensor(0.4084, dtype=torch.float64) tensor(-7.4500, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7226, dtype=torch.float64) delta_t tensor(0.6894, dtype=torch.float64)
14 gae_duplicate tensor(0.3669, dtype=torch.float64) tensor(-5.5923, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7144, dtype=torch.float64) delta_t tensor(0.7048, dtype=torch.float64)
13 gae_duplicate tensor(0.3985, dtype=torch.float64) tensor(-8.8176, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5292, dtype=torch.float64) delta_t tensor(0.5746, dtype=torch.float64)
12 gae_duplicate tensor(0.2470, dtype=torch.float64) tensor(-10.7116, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3482, dtype=torch.float64) delta_t tensor(0.3931, dtype=torch.float64)
11 gae_duplicate tensor(0.1773, dtype=torch.float64) tensor(-4.3579, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2137, dtype=torch.float64) delta_t tensor(0.0870, dtype=torch.float64)
10 gae_duplicate tensor(-0.3058, dtype=torch.float64) tensor(-0.5817, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2909, dtype=torch.float64) delta_t tensor(-0.2683, dtype=torch.float64)
9 gae_duplicate tensor(-1.2479, dtype=torch.float64) tensor(2.1766, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0908, dtype=torch.float64) delta_t tensor(0.0941, dtype=torch.float64)
8 gae_duplicate tensor(-0.4201, dtype=torch.float64) tensor(-0.4275, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0242, dtype=torch.float64) delta_t tensor(0.0201, dtype=torch.float64)
7 gae_duplicate tensor(-0.5342, dtype=torch.float64) tensor(-0.0890, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7422, dtype=torch.float64) delta_t tensor(-0.5936, dtype=torch.float64)
6 gae_duplicate tensor(-0.9712, dtype=torch.float64) tensor(7.1913, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5418, dtype=torch.float64) delta_t tensor(-0.2098, dtype=torch.float64)
5 gae_duplicate tensor(-1.0630, dtype=torch.float64) tensor(5.0075, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7229, dtype=torch.float64) delta_t tensor(-0.3679, dtype=torch.float64)
4 gae_duplicate tensor(-1.2535, dtype=torch.float64) tensor(3.4849, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0519, dtype=torch.float64) delta_t tensor(0.2660, dtype=torch.float64)
3 gae_duplicate tensor(-0.6600, dtype=torch.float64) tensor(-4.0242, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8199, dtype=torch.float64) delta_t tensor(-0.7087, dtype=torch.float64)
2 gae_duplicate tensor(-0.9424, dtype=torch.float64) tensor(8.5745, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1286.3939208984375
value loss:64.32402038574219
entropies:188.13002014160156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.487620115280151 seconds
19 rew tensor(0.7089, dtype=torch.float64) delta_t tensor(0.1379, dtype=torch.float64)
19 gae_duplicate tensor(-0.0783, dtype=torch.float64) tensor(-1.6790, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6314, dtype=torch.float64) delta_t tensor(0.2161, dtype=torch.float64)
18 gae_duplicate tensor(-0.2592, dtype=torch.float64) tensor(-2.8600, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4869, dtype=torch.float64) delta_t tensor(0.1682, dtype=torch.float64)
17 gae_duplicate tensor(-0.8863, dtype=torch.float64) tensor(-1.0762, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6726, dtype=torch.float64) delta_t tensor(0.3327, dtype=torch.float64)
16 gae_duplicate tensor(-0.0509, dtype=torch.float64) tensor(-4.6445, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5742, dtype=torch.float64) delta_t tensor(0.4303, dtype=torch.float64)
15 gae_duplicate tensor(-0.1934, dtype=torch.float64) tensor(-4.4222, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3702, dtype=torch.float64) delta_t tensor(0.2558, dtype=torch.float64)
14 gae_duplicate tensor(-0.4256, dtype=torch.float64) tensor(-2.2385, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6196, dtype=torch.float64) delta_t tensor(0.5414, dtype=torch.float64)
13 gae_duplicate tensor(-0.1149, dtype=torch.float64) tensor(-7.3097, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7188, dtype=torch.float64) delta_t tensor(0.5780, dtype=torch.float64)
12 gae_duplicate tensor(0.2290, dtype=torch.float64) tensor(-6.0654, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6820, dtype=torch.float64) delta_t tensor(0.5487, dtype=torch.float64)
11 gae_duplicate tensor(0.2705, dtype=torch.float64) tensor(-8.0044, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1347, dtype=torch.float64) delta_t tensor(0.0103, dtype=torch.float64)
10 gae_duplicate tensor(-1.3562, dtype=torch.float64) tensor(1.5931, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8084, dtype=torch.float64) delta_t tensor(-1.0382, dtype=torch.float64)
9 gae_duplicate tensor(-1.9030, dtype=torch.float64) tensor(9.4622, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1402, dtype=torch.float64) delta_t tensor(-0.2857, dtype=torch.float64)
8 gae_duplicate tensor(-1.9436, dtype=torch.float64) tensor(10.2975, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8941, dtype=torch.float64) delta_t tensor(-1.0913, dtype=torch.float64)
7 gae_duplicate tensor(-2.8026, dtype=torch.float64) tensor(16.3102, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3917, dtype=torch.float64) delta_t tensor(-1.4542, dtype=torch.float64)
6 gae_duplicate tensor(-2.5390, dtype=torch.float64) tensor(18.0293, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9496, dtype=torch.float64) delta_t tensor(-1.6966, dtype=torch.float64)
5 gae_duplicate tensor(-2.3188, dtype=torch.float64) tensor(15.7202, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.2877, dtype=torch.float64) delta_t tensor(-3.1527, dtype=torch.float64)
4 gae_duplicate tensor(-8.9777, dtype=torch.float64) tensor(57.3869, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5113, dtype=torch.float64) delta_t tensor(-0.2876, dtype=torch.float64)
3 gae_duplicate tensor(-0.9688, dtype=torch.float64) tensor(5.6754, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1001, dtype=torch.float64) delta_t tensor(-0.0214, dtype=torch.float64)
2 gae_duplicate tensor(-0.2123, dtype=torch.float64) tensor(0.7438, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3522.05810546875
value loss:341.5470275878906
entropies:183.20065307617188
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.762596130371094 seconds
19 rew tensor(0.7778, dtype=torch.float64) delta_t tensor(0.4824, dtype=torch.float64)
19 gae_duplicate tensor(-0.0942, dtype=torch.float64) tensor(-2.4423, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7609, dtype=torch.float64) delta_t tensor(0.3910, dtype=torch.float64)
18 gae_duplicate tensor(-0.0995, dtype=torch.float64) tensor(-3.3751, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7012, dtype=torch.float64) delta_t tensor(0.3691, dtype=torch.float64)
16 rew tensor(0.6330, dtype=torch.float64) delta_t tensor(0.3120, dtype=torch.float64)
16 gae_duplicate tensor(-0.1535, dtype=torch.float64) tensor(-3.6048, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4148, dtype=torch.float64) delta_t tensor(0.1438, dtype=torch.float64)
15 gae_duplicate tensor(-0.6910, dtype=torch.float64) tensor(-1.9679, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4751, dtype=torch.float64) delta_t tensor(0.3818, dtype=torch.float64)
14 gae_duplicate tensor(-0.1824, dtype=torch.float64) tensor(-3.3756, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4167, dtype=torch.float64) delta_t tensor(0.2977, dtype=torch.float64)
13 gae_duplicate tensor(-0.2638, dtype=torch.float64) tensor(-1.9194, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3748, dtype=torch.float64) delta_t tensor(0.2169, dtype=torch.float64)
12 gae_duplicate tensor(-0.8023, dtype=torch.float64) tensor(-0.8605, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.0505, dtype=torch.float64) delta_t tensor(-1.1021, dtype=torch.float64)
11 gae_duplicate tensor(-6.4455, dtype=torch.float64) tensor(15.0588, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1003, dtype=torch.float64) delta_t tensor(-0.0444, dtype=torch.float64)
10 gae_duplicate tensor(-0.9523, dtype=torch.float64) tensor(1.1915, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1212, dtype=torch.float64) delta_t tensor(0.0097, dtype=torch.float64)
9 gae_duplicate tensor(-1.8237, dtype=torch.float64) tensor(-1.5802, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1307, dtype=torch.float64) delta_t tensor(-0.0823, dtype=torch.float64)
8 gae_duplicate tensor(-0.8681, dtype=torch.float64) tensor(1.2877, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2687, dtype=torch.float64) delta_t tensor(-0.0826, dtype=torch.float64)
7 gae_duplicate tensor(-1.2114, dtype=torch.float64) tensor(1.9058, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6583, dtype=torch.float64) delta_t tensor(-0.4600, dtype=torch.float64)
6 gae_duplicate tensor(-1.4207, dtype=torch.float64) tensor(5.3500, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6765, dtype=torch.float64) delta_t tensor(-0.4550, dtype=torch.float64)
5 gae_duplicate tensor(-1.7584, dtype=torch.float64) tensor(4.0892, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2184, dtype=torch.float64) delta_t tensor(0.0164, dtype=torch.float64)
4 gae_duplicate tensor(-1.2926, dtype=torch.float64) tensor(-0.7162, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2867, dtype=torch.float64) delta_t tensor(-0.2192, dtype=torch.float64)
3 gae_duplicate tensor(-0.7874, dtype=torch.float64) tensor(1.5271, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2466, dtype=torch.float64) delta_t tensor(-0.2066, dtype=torch.float64)
2 gae_duplicate tensor(-0.3136, dtype=torch.float64) tensor(2.2690, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-289.6149597167969
value loss:117.9655990600586
entropies:187.10208129882812
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.792546987533569 seconds
19 rew tensor(0.7861, dtype=torch.float64) delta_t tensor(0.4836, dtype=torch.float64)
19 gae_duplicate tensor(0.2080, dtype=torch.float64) tensor(-5.2796, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7778, dtype=torch.float64) delta_t tensor(0.4872, dtype=torch.float64)
18 gae_duplicate tensor(0.2962, dtype=torch.float64) tensor(-2.9505, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7610, dtype=torch.float64) delta_t tensor(0.4075, dtype=torch.float64)
17 gae_duplicate tensor(0.2235, dtype=torch.float64) tensor(-4.6219, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7185, dtype=torch.float64) delta_t tensor(0.4108, dtype=torch.float64)
16 gae_duplicate tensor(0.3027, dtype=torch.float64) tensor(-4.2923, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6589, dtype=torch.float64) delta_t tensor(0.3548, dtype=torch.float64)
15 gae_duplicate tensor(-0.0526, dtype=torch.float64) tensor(-2.1105, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7959, dtype=torch.float64) delta_t tensor(0.6127, dtype=torch.float64)
14 gae_duplicate tensor(0.4252, dtype=torch.float64) tensor(-7.6308, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7442, dtype=torch.float64) delta_t tensor(0.5137, dtype=torch.float64)
13 gae_duplicate tensor(0.3534, dtype=torch.float64) tensor(-4.3460, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6924, dtype=torch.float64) delta_t tensor(0.4311, dtype=torch.float64)
12 gae_duplicate tensor(0.1993, dtype=torch.float64) tensor(-3.9688, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6325, dtype=torch.float64) delta_t tensor(0.6159, dtype=torch.float64)
11 gae_duplicate tensor(0.1040, dtype=torch.float64) tensor(-4.7492, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4215, dtype=torch.float64) delta_t tensor(0.3030, dtype=torch.float64)
10 gae_duplicate tensor(-0.0009, dtype=torch.float64) tensor(-3.6411, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2782, dtype=torch.float64) delta_t tensor(0.0566, dtype=torch.float64)
9 gae_duplicate tensor(-0.3606, dtype=torch.float64) tensor(-1.6712, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5083, dtype=torch.float64) delta_t tensor(-0.4388, dtype=torch.float64)
8 gae_duplicate tensor(-1.5990, dtype=torch.float64) tensor(3.0734, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5448, dtype=torch.float64) delta_t tensor(-0.4188, dtype=torch.float64)
7 gae_duplicate tensor(-2.1201, dtype=torch.float64) tensor(5.0587, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8091, dtype=torch.float64) delta_t tensor(-0.6837, dtype=torch.float64)
6 gae_duplicate tensor(-2.5407, dtype=torch.float64) tensor(4.9270, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1145, dtype=torch.float64) delta_t tensor(-0.8473, dtype=torch.float64)
5 gae_duplicate tensor(-3.0969, dtype=torch.float64) tensor(7.7295, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3558, dtype=torch.float64) delta_t tensor(-1.1550, dtype=torch.float64)
4 gae_duplicate tensor(-6.4898, dtype=torch.float64) tensor(10.8095, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9172, dtype=torch.float64) delta_t tensor(-0.5514, dtype=torch.float64)
3 gae_duplicate tensor(-1.0081, dtype=torch.float64) tensor(6.9897, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3263, dtype=torch.float64) delta_t tensor(-0.2146, dtype=torch.float64)
2 gae_duplicate tensor(-0.6043, dtype=torch.float64) tensor(3.3567, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:86.31539916992188
value loss:145.48117065429688
entropies:183.95896911621094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.717306852340698 seconds
19 rew tensor(0.7784, dtype=torch.float64) delta_t tensor(0.3785, dtype=torch.float64)
19 gae_duplicate tensor(0.1081, dtype=torch.float64) tensor(-2.8293, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7615, dtype=torch.float64) delta_t tensor(0.3946, dtype=torch.float64)
18 gae_duplicate tensor(-0.0576, dtype=torch.float64) tensor(-4.4051, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7361, dtype=torch.float64) delta_t tensor(0.4170, dtype=torch.float64)
17 gae_duplicate tensor(-0.0485, dtype=torch.float64) tensor(-4.2518, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6593, dtype=torch.float64) delta_t tensor(0.3538, dtype=torch.float64)
16 gae_duplicate tensor(-0.3138, dtype=torch.float64) tensor(-3.3165, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5483, dtype=torch.float64) delta_t tensor(0.3906, dtype=torch.float64)
15 gae_duplicate tensor(-0.8554, dtype=torch.float64) tensor(-5.5405, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7966, dtype=torch.float64) delta_t tensor(0.6512, dtype=torch.float64)
14 gae_duplicate tensor(0.3308, dtype=torch.float64) tensor(-5.6810, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7170, dtype=torch.float64) delta_t tensor(0.5920, dtype=torch.float64)
13 gae_duplicate tensor(0.0287, dtype=torch.float64) tensor(-6.1377, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5696, dtype=torch.float64) delta_t tensor(0.4137, dtype=torch.float64)
12 gae_duplicate tensor(0.1541, dtype=torch.float64) tensor(-3.4747, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2688, dtype=torch.float64) delta_t tensor(0.2296, dtype=torch.float64)
11 gae_duplicate tensor(-0.6493, dtype=torch.float64) tensor(-3.8191, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1574, dtype=torch.float64) delta_t tensor(0.1829, dtype=torch.float64)
10 gae_duplicate tensor(-0.5553, dtype=torch.float64) tensor(-4.1683, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1116, dtype=torch.float64) delta_t tensor(0.1755, dtype=torch.float64)
9 gae_duplicate tensor(-0.7955, dtype=torch.float64) tensor(-3.6244, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0810, dtype=torch.float64) delta_t tensor(0.1542, dtype=torch.float64)
8 gae_duplicate tensor(-0.2951, dtype=torch.float64) tensor(-1.5853, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1726, dtype=torch.float64) delta_t tensor(-0.1434, dtype=torch.float64)
7 gae_duplicate tensor(-1.2035, dtype=torch.float64) tensor(4.3376, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6712, dtype=torch.float64) delta_t tensor(-0.5127, dtype=torch.float64)
6 gae_duplicate tensor(-1.4926, dtype=torch.float64) tensor(7.1763, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1476, dtype=torch.float64) delta_t tensor(-0.8852, dtype=torch.float64)
5 gae_duplicate tensor(-1.8644, dtype=torch.float64) tensor(10.7802, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9980, dtype=torch.float64) delta_t tensor(-0.6562, dtype=torch.float64)
4 gae_duplicate tensor(-1.6556, dtype=torch.float64) tensor(9.7338, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4842, dtype=torch.float64) delta_t tensor(-0.2215, dtype=torch.float64)
3 gae_duplicate tensor(-1.3053, dtype=torch.float64) tensor(1.9917, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3979, dtype=torch.float64) delta_t tensor(-0.4121, dtype=torch.float64)
2 gae_duplicate tensor(-0.9602, dtype=torch.float64) tensor(3.6063, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:370.1623229980469
value loss:76.74820709228516
entropies:185.12820434570312
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2314.8408)
ToM Target loss= tensor(1807.1620)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.872103929519653 seconds
19 rew tensor(0.7784, dtype=torch.float64) delta_t tensor(0.3026, dtype=torch.float64)
19 gae_duplicate tensor(-0.0428, dtype=torch.float64) tensor(-2.5407, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7701, dtype=torch.float64) delta_t tensor(0.3621, dtype=torch.float64)
18 gae_duplicate tensor(0.0392, dtype=torch.float64) tensor(-2.8669, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7449, dtype=torch.float64) delta_t tensor(0.3908, dtype=torch.float64)
17 gae_duplicate tensor(-0.0485, dtype=torch.float64) tensor(-4.3684, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6689, dtype=torch.float64) delta_t tensor(0.3853, dtype=torch.float64)
16 gae_duplicate tensor(-0.2211, dtype=torch.float64) tensor(-1.9620, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5506, dtype=torch.float64) delta_t tensor(0.2046, dtype=torch.float64)
15 gae_duplicate tensor(-0.7106, dtype=torch.float64) tensor(-0.8880, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7553, dtype=torch.float64) delta_t tensor(0.4496, dtype=torch.float64)
14 gae_duplicate tensor(0.1379, dtype=torch.float64) tensor(-5.6157, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6521, dtype=torch.float64) delta_t tensor(0.4032, dtype=torch.float64)
13 gae_duplicate tensor(0.1360, dtype=torch.float64) tensor(-4.4009, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7448, dtype=torch.float64) delta_t tensor(0.6073, dtype=torch.float64)
12 gae_duplicate tensor(0.2239, dtype=torch.float64) tensor(-7.7952, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6651, dtype=torch.float64) delta_t tensor(0.6162, dtype=torch.float64)
11 gae_duplicate tensor(0.0942, dtype=torch.float64) tensor(-9.1191, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6402, dtype=torch.float64) delta_t tensor(0.5759, dtype=torch.float64)
10 gae_duplicate tensor(0.2274, dtype=torch.float64) tensor(-10.3186, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5972, dtype=torch.float64) delta_t tensor(-0.5935, dtype=torch.float64)
9 gae_duplicate tensor(-1.8586, dtype=torch.float64) tensor(10.0113, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7255, dtype=torch.float64) delta_t tensor(-0.8100, dtype=torch.float64)
8 gae_duplicate tensor(-3.5759, dtype=torch.float64) tensor(7.4794, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8491, dtype=torch.float64) delta_t tensor(-0.9368, dtype=torch.float64)
7 gae_duplicate tensor(-3.0952, dtype=torch.float64) tensor(7.4351, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1057, dtype=torch.float64) delta_t tensor(-0.8814, dtype=torch.float64)
6 gae_duplicate tensor(-2.4644, dtype=torch.float64) tensor(7.2127, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3575, dtype=torch.float64) delta_t tensor(-1.3271, dtype=torch.float64)
5 gae_duplicate tensor(-3.0889, dtype=torch.float64) tensor(16.3369, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0229, dtype=torch.float64) delta_t tensor(-1.6795, dtype=torch.float64)
4 gae_duplicate tensor(-5.7251, dtype=torch.float64) tensor(14.7915, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1915, dtype=torch.float64) delta_t tensor(-0.0181, dtype=torch.float64)
3 gae_duplicate tensor(-1.0678, dtype=torch.float64) tensor(2.2371, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7453, dtype=torch.float64) delta_t tensor(-0.6186, dtype=torch.float64)
2 gae_duplicate tensor(-1.0860, dtype=torch.float64) tensor(8.2329, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-891.47265625
value loss:200.12840270996094
entropies:180.3496551513672
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.714836835861206 seconds
19 rew tensor(0.7954, dtype=torch.float64) delta_t tensor(0.4555, dtype=torch.float64)
19 gae_duplicate tensor(0.2274, dtype=torch.float64) tensor(-3.3971, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7794, dtype=torch.float64) delta_t tensor(0.4937, dtype=torch.float64)
18 gae_duplicate tensor(0.3023, dtype=torch.float64) tensor(-5.0411, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7796, dtype=torch.float64) delta_t tensor(0.5693, dtype=torch.float64)
17 gae_duplicate tensor(0.1972, dtype=torch.float64) tensor(-5.4546, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7717, dtype=torch.float64) delta_t tensor(0.5501, dtype=torch.float64)
16 gae_duplicate tensor(0.1366, dtype=torch.float64) tensor(-6.7973, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7475, dtype=torch.float64) delta_t tensor(0.5703, dtype=torch.float64)
15 gae_duplicate tensor(0.0629, dtype=torch.float64) tensor(-5.5730, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3780, dtype=torch.float64) delta_t tensor(0.3089, dtype=torch.float64)
14 gae_duplicate tensor(-0.0686, dtype=torch.float64) tensor(-3.6858, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4947, dtype=torch.float64) delta_t tensor(0.5053, dtype=torch.float64)
13 gae_duplicate tensor(0.3119, dtype=torch.float64) tensor(-5.5504, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1880, dtype=torch.float64) delta_t tensor(0.2145, dtype=torch.float64)
12 gae_duplicate tensor(-0.2584, dtype=torch.float64) tensor(-3.5359, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2230, dtype=torch.float64) delta_t tensor(0.1202, dtype=torch.float64)
11 gae_duplicate tensor(-0.4646, dtype=torch.float64) tensor(-2.3369, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6339, dtype=torch.float64) delta_t tensor(-0.5257, dtype=torch.float64)
10 gae_duplicate tensor(-3.3024, dtype=torch.float64) tensor(2.8154, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1701, dtype=torch.float64) delta_t tensor(-0.3094, dtype=torch.float64)
9 gae_duplicate tensor(-1.3863, dtype=torch.float64) tensor(3.1112, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1114, dtype=torch.float64) delta_t tensor(-0.0570, dtype=torch.float64)
8 gae_duplicate tensor(-0.6902, dtype=torch.float64) tensor(0.2134, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6583, dtype=torch.float64) delta_t tensor(-0.4164, dtype=torch.float64)
7 gae_duplicate tensor(-2.6960, dtype=torch.float64) tensor(3.4725, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9442, dtype=torch.float64) delta_t tensor(-0.8291, dtype=torch.float64)
6 gae_duplicate tensor(-2.4847, dtype=torch.float64) tensor(13.5321, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2005, dtype=torch.float64) delta_t tensor(-0.7894, dtype=torch.float64)
5 gae_duplicate tensor(-1.6342, dtype=torch.float64) tensor(11.3145, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5945, dtype=torch.float64) delta_t tensor(-1.3617, dtype=torch.float64)
4 gae_duplicate tensor(-6.3698, dtype=torch.float64) tensor(12.0338, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2072, dtype=torch.float64) delta_t tensor(-0.0559, dtype=torch.float64)
3 gae_duplicate tensor(-0.6323, dtype=torch.float64) tensor(4.1712, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2770, dtype=torch.float64) delta_t tensor(-0.2788, dtype=torch.float64)
2 gae_duplicate tensor(-0.9872, dtype=torch.float64) tensor(2.4926, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-457.559814453125
value loss:175.33535766601562
entropies:185.1081085205078
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.790560007095337 seconds
19 rew tensor(0.7161, dtype=torch.float64) delta_t tensor(0.2004, dtype=torch.float64)
19 gae_duplicate tensor(-0.2711, dtype=torch.float64) tensor(-0.9028, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6360, dtype=torch.float64) delta_t tensor(0.1909, dtype=torch.float64)
18 gae_duplicate tensor(-0.4976, dtype=torch.float64) tensor(-1.3807, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5021, dtype=torch.float64) delta_t tensor(0.1153, dtype=torch.float64)
17 gae_duplicate tensor(-0.9562, dtype=torch.float64) tensor(0.4568, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7361, dtype=torch.float64) delta_t tensor(0.4772, dtype=torch.float64)
16 gae_duplicate tensor(-0.0736, dtype=torch.float64) tensor(-6.5284, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6577, dtype=torch.float64) delta_t tensor(0.4538, dtype=torch.float64)
15 gae_duplicate tensor(-0.2834, dtype=torch.float64) tensor(-5.0616, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5624, dtype=torch.float64) delta_t tensor(0.3976, dtype=torch.float64)
14 gae_duplicate tensor(-0.8080, dtype=torch.float64) tensor(-3.3716, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5899, dtype=torch.float64) delta_t tensor(0.5295, dtype=torch.float64)
13 gae_duplicate tensor(0.3167, dtype=torch.float64) tensor(-3.4736, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4960, dtype=torch.float64) delta_t tensor(0.3439, dtype=torch.float64)
12 gae_duplicate tensor(-0.1953, dtype=torch.float64) tensor(-2.7525, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0381, dtype=torch.float64) delta_t tensor(-0.1543, dtype=torch.float64)
11 gae_duplicate tensor(-2.3736, dtype=torch.float64) tensor(-0.0726, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2245, dtype=torch.float64) delta_t tensor(-0.1048, dtype=torch.float64)
10 gae_duplicate tensor(-1.9694, dtype=torch.float64) tensor(-0.0647, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0351, dtype=torch.float64) delta_t tensor(-0.0517, dtype=torch.float64)
9 gae_duplicate tensor(-1.7759, dtype=torch.float64) tensor(0.1436, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2987, dtype=torch.float64) delta_t tensor(-0.3086, dtype=torch.float64)
8 gae_duplicate tensor(-2.1180, dtype=torch.float64) tensor(2.4206, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7892, dtype=torch.float64) delta_t tensor(-0.5856, dtype=torch.float64)
7 gae_duplicate tensor(-2.3322, dtype=torch.float64) tensor(11.0088, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2394, dtype=torch.float64) delta_t tensor(-1.2211, dtype=torch.float64)
6 gae_duplicate tensor(-2.7157, dtype=torch.float64) tensor(15.0996, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2741, dtype=torch.float64) delta_t tensor(-1.1255, dtype=torch.float64)
5 gae_duplicate tensor(-2.6889, dtype=torch.float64) tensor(10.8068, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0080, dtype=torch.float64) delta_t tensor(0.2515, dtype=torch.float64)
4 gae_duplicate tensor(-0.6892, dtype=torch.float64) tensor(-1.0417, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4967, dtype=torch.float64) delta_t tensor(-0.2462, dtype=torch.float64)
3 gae_duplicate tensor(-0.8532, dtype=torch.float64) tensor(3.4824, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3547, dtype=torch.float64) delta_t tensor(-0.2892, dtype=torch.float64)
2 gae_duplicate tensor(-0.6000, dtype=torch.float64) tensor(4.2181, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-859.9988403320312
value loss:109.65800476074219
entropies:180.50755310058594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.590661287307739 seconds
19 rew tensor(0.7957, dtype=torch.float64) delta_t tensor(0.5117, dtype=torch.float64)
19 gae_duplicate tensor(0.1858, dtype=torch.float64) tensor(-4.2516, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7702, dtype=torch.float64) delta_t tensor(0.4446, dtype=torch.float64)
18 gae_duplicate tensor(0.1717, dtype=torch.float64) tensor(-6.8872, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7705, dtype=torch.float64) delta_t tensor(0.4312, dtype=torch.float64)
17 gae_duplicate tensor(0.1820, dtype=torch.float64) tensor(-6.7799, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7356, dtype=torch.float64) delta_t tensor(0.3001, dtype=torch.float64)
16 gae_duplicate tensor(0.1153, dtype=torch.float64) tensor(-3.9577, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6841, dtype=torch.float64) delta_t tensor(0.2992, dtype=torch.float64)
15 gae_duplicate tensor(0.1697, dtype=torch.float64) tensor(-3.3445, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5283, dtype=torch.float64) delta_t tensor(0.3763, dtype=torch.float64)
14 gae_duplicate tensor(-0.2457, dtype=torch.float64) tensor(-3.8158, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5694, dtype=torch.float64) delta_t tensor(0.4223, dtype=torch.float64)
13 gae_duplicate tensor(0.0048, dtype=torch.float64) tensor(-4.1687, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6666, dtype=torch.float64) delta_t tensor(0.4884, dtype=torch.float64)
12 gae_duplicate tensor(-0.1131, dtype=torch.float64) tensor(-4.4375, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2215, dtype=torch.float64) delta_t tensor(0.1999, dtype=torch.float64)
11 gae_duplicate tensor(-0.5341, dtype=torch.float64) tensor(-2.0559, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1047, dtype=torch.float64) delta_t tensor(-0.0416, dtype=torch.float64)
10 gae_duplicate tensor(-1.8037, dtype=torch.float64) tensor(0.7206, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.1352, dtype=torch.float64) delta_t tensor(-1.9572, dtype=torch.float64)
9 gae_duplicate tensor(-6.3314, dtype=torch.float64) tensor(23.5414, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4615, dtype=torch.float64) delta_t tensor(-0.4882, dtype=torch.float64)
8 gae_duplicate tensor(-3.1442, dtype=torch.float64) tensor(9.1772, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7624, dtype=torch.float64) delta_t tensor(-0.5563, dtype=torch.float64)
7 gae_duplicate tensor(-2.8387, dtype=torch.float64) tensor(4.0228, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0457, dtype=torch.float64) delta_t tensor(-0.0131, dtype=torch.float64)
6 gae_duplicate tensor(-1.1063, dtype=torch.float64) tensor(-0.3213, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1906, dtype=torch.float64) delta_t tensor(-0.8779, dtype=torch.float64)
5 gae_duplicate tensor(-2.0703, dtype=torch.float64) tensor(13.2000, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2997, dtype=torch.float64) delta_t tensor(-0.9005, dtype=torch.float64)
4 gae_duplicate tensor(-5.6808, dtype=torch.float64) tensor(8.8908, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3927, dtype=torch.float64) delta_t tensor(-0.2791, dtype=torch.float64)
3 gae_duplicate tensor(-1.0793, dtype=torch.float64) tensor(3.4489, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3923, dtype=torch.float64) delta_t tensor(-0.3369, dtype=torch.float64)
2 gae_duplicate tensor(-0.9110, dtype=torch.float64) tensor(4.0703, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1006.634521484375
value loss:229.8851318359375
entropies:182.05459594726562
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.767376899719238 seconds
19 rew tensor(0.7543, dtype=torch.float64) delta_t tensor(0.2494, dtype=torch.float64)
19 gae_duplicate tensor(0.0537, dtype=torch.float64) tensor(-2.7316, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7293, dtype=torch.float64) delta_t tensor(0.3639, dtype=torch.float64)
18 gae_duplicate tensor(-0.0385, dtype=torch.float64) tensor(-3.5363, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6612, dtype=torch.float64) delta_t tensor(0.3354, dtype=torch.float64)
17 gae_duplicate tensor(-0.1457, dtype=torch.float64) tensor(-4.2505, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5337, dtype=torch.float64) delta_t tensor(0.3322, dtype=torch.float64)
16 gae_duplicate tensor(-0.2511, dtype=torch.float64) tensor(-5.3298, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5222, dtype=torch.float64) delta_t tensor(0.3727, dtype=torch.float64)
15 gae_duplicate tensor(-0.7981, dtype=torch.float64) tensor(-3.6282, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7628, dtype=torch.float64) delta_t tensor(0.6156, dtype=torch.float64)
14 gae_duplicate tensor(0.3820, dtype=torch.float64) tensor(-3.9929, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5338, dtype=torch.float64) delta_t tensor(0.4658, dtype=torch.float64)
13 gae_duplicate tensor(0.2026, dtype=torch.float64) tensor(-4.8875, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4275, dtype=torch.float64) delta_t tensor(0.3945, dtype=torch.float64)
12 gae_duplicate tensor(0.1400, dtype=torch.float64) tensor(-6.8130, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0316, dtype=torch.float64) delta_t tensor(-0.1007, dtype=torch.float64)
11 gae_duplicate tensor(-1.0526, dtype=torch.float64) tensor(0.9757, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5520, dtype=torch.float64) delta_t tensor(-0.4168, dtype=torch.float64)
10 gae_duplicate tensor(-3.4900, dtype=torch.float64) tensor(10.4810, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0425, dtype=torch.float64) delta_t tensor(0.0984, dtype=torch.float64)
9 gae_duplicate tensor(-0.6103, dtype=torch.float64) tensor(-0.1228, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1599, dtype=torch.float64) delta_t tensor(-0.0070, dtype=torch.float64)
8 gae_duplicate tensor(-1.0346, dtype=torch.float64) tensor(-0.8350, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3179, dtype=torch.float64) delta_t tensor(-0.0768, dtype=torch.float64)
7 gae_duplicate tensor(-0.9065, dtype=torch.float64) tensor(0.0012, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5013, dtype=torch.float64) delta_t tensor(-0.1723, dtype=torch.float64)
6 gae_duplicate tensor(-0.6991, dtype=torch.float64) tensor(2.8933, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2608, dtype=torch.float64) delta_t tensor(-0.0131, dtype=torch.float64)
5 gae_duplicate tensor(-0.5964, dtype=torch.float64) tensor(1.1421, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0519, dtype=torch.float64) delta_t tensor(0.2665, dtype=torch.float64)
4 gae_duplicate tensor(-0.2487, dtype=torch.float64) tensor(-2.0104, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2976, dtype=torch.float64) delta_t tensor(-0.1674, dtype=torch.float64)
3 gae_duplicate tensor(-0.9984, dtype=torch.float64) tensor(0.4104, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4801, dtype=torch.float64) delta_t tensor(-0.4994, dtype=torch.float64)
2 gae_duplicate tensor(-1.3352, dtype=torch.float64) tensor(4.2263, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:615.2679443359375
value loss:68.30561828613281
entropies:183.38442993164062
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2315.8760)
ToM Target loss= tensor(1808.0403)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.979985237121582 seconds
19 rew tensor(0.7873, dtype=torch.float64) delta_t tensor(0.2079, dtype=torch.float64)
19 gae_duplicate tensor(-0.0464, dtype=torch.float64) tensor(-4.0340, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7876, dtype=torch.float64) delta_t tensor(0.3227, dtype=torch.float64)
18 gae_duplicate tensor(0.0280, dtype=torch.float64) tensor(-3.9736, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7718, dtype=torch.float64) delta_t tensor(0.3789, dtype=torch.float64)
17 gae_duplicate tensor(0.0799, dtype=torch.float64) tensor(-4.4861, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7400, dtype=torch.float64) delta_t tensor(0.2895, dtype=torch.float64)
16 gae_duplicate tensor(-0.0642, dtype=torch.float64) tensor(-3.7666, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7082, dtype=torch.float64) delta_t tensor(0.4270, dtype=torch.float64)
15 gae_duplicate tensor(-0.0339, dtype=torch.float64) tensor(-4.9710, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5253, dtype=torch.float64) delta_t tensor(0.3622, dtype=torch.float64)
14 gae_duplicate tensor(-0.5802, dtype=torch.float64) tensor(-6.5242, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7619, dtype=torch.float64) delta_t tensor(0.5515, dtype=torch.float64)
13 gae_duplicate tensor(0.1744, dtype=torch.float64) tensor(-6.1946, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7448, dtype=torch.float64) delta_t tensor(0.5740, dtype=torch.float64)
12 gae_duplicate tensor(0.1536, dtype=torch.float64) tensor(-4.6556, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7451, dtype=torch.float64) delta_t tensor(0.9026, dtype=torch.float64)
11 gae_duplicate tensor(0.5893, dtype=torch.float64) tensor(-9.9168, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5842, dtype=torch.float64) delta_t tensor(0.5344, dtype=torch.float64)
10 gae_duplicate tensor(0.2532, dtype=torch.float64) tensor(-9.0686, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2466, dtype=torch.float64) delta_t tensor(-0.2747, dtype=torch.float64)
9 gae_duplicate tensor(-1.6553, dtype=torch.float64) tensor(3.5998, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4219, dtype=torch.float64) delta_t tensor(-0.4631, dtype=torch.float64)
8 gae_duplicate tensor(-1.1845, dtype=torch.float64) tensor(8.0959, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5861, dtype=torch.float64) delta_t tensor(-0.4567, dtype=torch.float64)
7 gae_duplicate tensor(-0.9334, dtype=torch.float64) tensor(5.8681, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4113, dtype=torch.float64) delta_t tensor(-0.3895, dtype=torch.float64)
6 gae_duplicate tensor(-2.1532, dtype=torch.float64) tensor(9.3513, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5399, dtype=torch.float64) delta_t tensor(-1.3043, dtype=torch.float64)
5 gae_duplicate tensor(-1.9313, dtype=torch.float64) tensor(13.8468, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8374, dtype=torch.float64) delta_t tensor(-1.6702, dtype=torch.float64)
4 gae_duplicate tensor(-9.3282, dtype=torch.float64) tensor(17.8257, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3520, dtype=torch.float64) delta_t tensor(-0.0628, dtype=torch.float64)
3 gae_duplicate tensor(-0.9915, dtype=torch.float64) tensor(1.1578, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3685, dtype=torch.float64) delta_t tensor(-0.3760, dtype=torch.float64)
2 gae_duplicate tensor(-0.8670, dtype=torch.float64) tensor(3.4427, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-234.01687622070312
value loss:217.2010040283203
entropies:180.6535186767578
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.815378189086914 seconds
19 rew tensor(0.7782, dtype=torch.float64) delta_t tensor(0.2265, dtype=torch.float64)
19 gae_duplicate tensor(0.0043, dtype=torch.float64) tensor(-2.1828, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7526, dtype=torch.float64) delta_t tensor(0.2980, dtype=torch.float64)
18 gae_duplicate tensor(-0.0752, dtype=torch.float64) tensor(-2.6960, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7254, dtype=torch.float64) delta_t tensor(0.3627, dtype=torch.float64)
17 gae_duplicate tensor(-0.0933, dtype=torch.float64) tensor(-3.4466, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6460, dtype=torch.float64) delta_t tensor(0.2690, dtype=torch.float64)
16 gae_duplicate tensor(-0.2929, dtype=torch.float64) tensor(-1.6104, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5217, dtype=torch.float64) delta_t tensor(0.2439, dtype=torch.float64)
15 gae_duplicate tensor(-0.8545, dtype=torch.float64) tensor(-2.4346, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7042, dtype=torch.float64) delta_t tensor(0.4441, dtype=torch.float64)
14 gae_duplicate tensor(-0.3056, dtype=torch.float64) tensor(-6.2160, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6989, dtype=torch.float64) delta_t tensor(0.5964, dtype=torch.float64)
13 gae_duplicate tensor(0.2208, dtype=torch.float64) tensor(-7.9398, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5710, dtype=torch.float64) delta_t tensor(0.4561, dtype=torch.float64)
12 gae_duplicate tensor(0.0405, dtype=torch.float64) tensor(-3.9524, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4674, dtype=torch.float64) delta_t tensor(0.2588, dtype=torch.float64)
11 gae_duplicate tensor(-0.1319, dtype=torch.float64) tensor(-4.8062, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3552, dtype=torch.float64) delta_t tensor(0.1455, dtype=torch.float64)
10 gae_duplicate tensor(-0.2740, dtype=torch.float64) tensor(-1.7698, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4417, dtype=torch.float64) delta_t tensor(-0.5514, dtype=torch.float64)
9 gae_duplicate tensor(-2.1852, dtype=torch.float64) tensor(5.4790, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2302, dtype=torch.float64) delta_t tensor(-0.1129, dtype=torch.float64)
8 gae_duplicate tensor(-2.1739, dtype=torch.float64) tensor(6.9456, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4454, dtype=torch.float64) delta_t tensor(-0.4338, dtype=torch.float64)
7 gae_duplicate tensor(-1.2956, dtype=torch.float64) tensor(3.7562, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3165, dtype=torch.float64) delta_t tensor(-1.1171, dtype=torch.float64)
6 gae_duplicate tensor(-2.5685, dtype=torch.float64) tensor(10.8411, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6618, dtype=torch.float64) delta_t tensor(-0.4725, dtype=torch.float64)
5 gae_duplicate tensor(-1.8540, dtype=torch.float64) tensor(7.7742, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5009, dtype=torch.float64) delta_t tensor(-1.0852, dtype=torch.float64)
4 gae_duplicate tensor(-2.6609, dtype=torch.float64) tensor(14.4287, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2842, dtype=torch.float64) delta_t tensor(-0.0585, dtype=torch.float64)
3 gae_duplicate tensor(-0.6737, dtype=torch.float64) tensor(1.8381, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4701, dtype=torch.float64) delta_t tensor(-0.4317, dtype=torch.float64)
2 gae_duplicate tensor(-1.1244, dtype=torch.float64) tensor(6.3562, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-765.776123046875
value loss:104.89990234375
entropies:181.42303466796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.901993036270142 seconds
19 rew tensor(0.7430, dtype=torch.float64) delta_t tensor(0.3623, dtype=torch.float64)
19 gae_duplicate tensor(0.1484, dtype=torch.float64) tensor(-2.5166, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6991, dtype=torch.float64) delta_t tensor(0.4089, dtype=torch.float64)
18 gae_duplicate tensor(0.1727, dtype=torch.float64) tensor(-4.0169, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6021, dtype=torch.float64) delta_t tensor(0.3728, dtype=torch.float64)
17 gae_duplicate tensor(0.1042, dtype=torch.float64) tensor(-3.8701, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4012, dtype=torch.float64) delta_t tensor(0.1720, dtype=torch.float64)
16 gae_duplicate tensor(-0.6465, dtype=torch.float64) tensor(-1.8176, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5696, dtype=torch.float64) delta_t tensor(0.3899, dtype=torch.float64)
15 gae_duplicate tensor(-0.1118, dtype=torch.float64) tensor(-4.6344, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6494, dtype=torch.float64) delta_t tensor(0.4873, dtype=torch.float64)
14 gae_duplicate tensor(-0.2874, dtype=torch.float64) tensor(-6.1612, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7182, dtype=torch.float64) delta_t tensor(0.5880, dtype=torch.float64)
13 gae_duplicate tensor(0.2541, dtype=torch.float64) tensor(-5.7077, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7184, dtype=torch.float64) delta_t tensor(0.5735, dtype=torch.float64)
12 gae_duplicate tensor(0.3085, dtype=torch.float64) tensor(-5.4205, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6271, dtype=torch.float64) delta_t tensor(0.4782, dtype=torch.float64)
11 gae_duplicate tensor(0.2748, dtype=torch.float64) tensor(-4.3630, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4889, dtype=torch.float64) delta_t tensor(0.2761, dtype=torch.float64)
10 gae_duplicate tensor(-0.2513, dtype=torch.float64) tensor(-3.8980, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2747, dtype=torch.float64) delta_t tensor(-0.3482, dtype=torch.float64)
9 gae_duplicate tensor(-1.3283, dtype=torch.float64) tensor(2.1820, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5556, dtype=torch.float64) delta_t tensor(-0.5800, dtype=torch.float64)
8 gae_duplicate tensor(-1.5104, dtype=torch.float64) tensor(7.2763, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6844, dtype=torch.float64) delta_t tensor(-0.5807, dtype=torch.float64)
7 gae_duplicate tensor(-1.5556, dtype=torch.float64) tensor(6.3870, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8329, dtype=torch.float64) delta_t tensor(-0.7365, dtype=torch.float64)
6 gae_duplicate tensor(-2.0220, dtype=torch.float64) tensor(7.5804, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8704, dtype=torch.float64) delta_t tensor(-0.5059, dtype=torch.float64)
5 gae_duplicate tensor(-1.4068, dtype=torch.float64) tensor(5.1930, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8412, dtype=torch.float64) delta_t tensor(-2.6217, dtype=torch.float64)
4 gae_duplicate tensor(-7.9660, dtype=torch.float64) tensor(25.0064, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3078, dtype=torch.float64) delta_t tensor(-0.1665, dtype=torch.float64)
3 gae_duplicate tensor(-0.8197, dtype=torch.float64) tensor(3.5583, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1744, dtype=torch.float64) delta_t tensor(-0.1761, dtype=torch.float64)
2 gae_duplicate tensor(-0.4128, dtype=torch.float64) tensor(1.6319, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-623.4483642578125
value loss:249.53196716308594
entropies:181.74256896972656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.05404806137085 seconds
19 rew tensor(0.7931, dtype=torch.float64) delta_t tensor(0.4010, dtype=torch.float64)
19 gae_duplicate tensor(0.1504, dtype=torch.float64) tensor(-3.2307, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7933, dtype=torch.float64) delta_t tensor(0.5192, dtype=torch.float64)
18 gae_duplicate tensor(0.3985, dtype=torch.float64) tensor(-4.7535, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7850, dtype=torch.float64) delta_t tensor(0.4670, dtype=torch.float64)
17 gae_duplicate tensor(0.2300, dtype=torch.float64) tensor(-8.1080, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7774, dtype=torch.float64) delta_t tensor(0.4394, dtype=torch.float64)
16 gae_duplicate tensor(0.3294, dtype=torch.float64) tensor(-3.4075, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7604, dtype=torch.float64) delta_t tensor(0.3816, dtype=torch.float64)
15 gae_duplicate tensor(0.1400, dtype=torch.float64) tensor(-5.8031, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7263, dtype=torch.float64) delta_t tensor(0.5585, dtype=torch.float64)
14 gae_duplicate tensor(0.4903, dtype=torch.float64) tensor(-5.0386, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7359, dtype=torch.float64) delta_t tensor(0.6406, dtype=torch.float64)
13 gae_duplicate tensor(0.3434, dtype=torch.float64) tensor(-4.5190, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5769, dtype=torch.float64) delta_t tensor(0.3483, dtype=torch.float64)
12 gae_duplicate tensor(0.1369, dtype=torch.float64) tensor(-5.3464, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5721, dtype=torch.float64) delta_t tensor(0.3776, dtype=torch.float64)
11 gae_duplicate tensor(0.1819, dtype=torch.float64) tensor(-4.5948, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5124, dtype=torch.float64) delta_t tensor(0.4220, dtype=torch.float64)
10 gae_duplicate tensor(0.0193, dtype=torch.float64) tensor(-3.7131, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1664, dtype=torch.float64) delta_t tensor(-0.4269, dtype=torch.float64)
9 gae_duplicate tensor(-2.3549, dtype=torch.float64) tensor(5.3019, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5017, dtype=torch.float64) delta_t tensor(-0.6819, dtype=torch.float64)
8 gae_duplicate tensor(-2.0331, dtype=torch.float64) tensor(7.0586, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5352, dtype=torch.float64) delta_t tensor(-1.5200, dtype=torch.float64)
7 gae_duplicate tensor(-3.3060, dtype=torch.float64) tensor(22.6766, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0869, dtype=torch.float64) delta_t tensor(-1.0686, dtype=torch.float64)
6 gae_duplicate tensor(-2.8016, dtype=torch.float64) tensor(14.0524, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1603, dtype=torch.float64) delta_t tensor(-1.2227, dtype=torch.float64)
5 gae_duplicate tensor(-2.6456, dtype=torch.float64) tensor(8.4891, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6256, dtype=torch.float64) delta_t tensor(-3.4273, dtype=torch.float64)
4 gae_duplicate tensor(-8.0770, dtype=torch.float64) tensor(28.0870, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0025, dtype=torch.float64) delta_t tensor(0.1752, dtype=torch.float64)
3 gae_duplicate tensor(-0.6324, dtype=torch.float64) tensor(4.1774, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2568, dtype=torch.float64) delta_t tensor(-0.1769, dtype=torch.float64)
2 gae_duplicate tensor(-0.5213, dtype=torch.float64) tensor(1.2918, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1565.81201171875
value loss:337.1802673339844
entropies:174.94949340820312
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.003342866897583 seconds
19 rew tensor(0.7928, dtype=torch.float64) delta_t tensor(0.4343, dtype=torch.float64)
19 gae_duplicate tensor(0.2855, dtype=torch.float64) tensor(-3.4559, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7930, dtype=torch.float64) delta_t tensor(0.4159, dtype=torch.float64)
18 gae_duplicate tensor(0.2083, dtype=torch.float64) tensor(-4.8303, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7933, dtype=torch.float64) delta_t tensor(0.4335, dtype=torch.float64)
17 gae_duplicate tensor(0.3001, dtype=torch.float64) tensor(-5.0535, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7935, dtype=torch.float64) delta_t tensor(0.5098, dtype=torch.float64)
16 gae_duplicate tensor(0.2986, dtype=torch.float64) tensor(-3.6621, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7938, dtype=torch.float64) delta_t tensor(0.4842, dtype=torch.float64)
15 gae_duplicate tensor(0.2705, dtype=torch.float64) tensor(-6.1818, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6208, dtype=torch.float64) delta_t tensor(0.3713, dtype=torch.float64)
14 gae_duplicate tensor(-0.0053, dtype=torch.float64) tensor(-3.4164, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5357, dtype=torch.float64) delta_t tensor(0.2960, dtype=torch.float64)
13 gae_duplicate tensor(-0.2020, dtype=torch.float64) tensor(-1.5925, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4427, dtype=torch.float64) delta_t tensor(0.2918, dtype=torch.float64)
12 gae_duplicate tensor(-0.0066, dtype=torch.float64) tensor(-2.6879, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4099, dtype=torch.float64) delta_t tensor(0.1959, dtype=torch.float64)
11 gae_duplicate tensor(-0.5421, dtype=torch.float64) tensor(-2.1666, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3088, dtype=torch.float64) delta_t tensor(0.1940, dtype=torch.float64)
10 gae_duplicate tensor(-0.6234, dtype=torch.float64) tensor(-0.3683, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2346, dtype=torch.float64) delta_t tensor(0.1030, dtype=torch.float64)
9 gae_duplicate tensor(-0.1801, dtype=torch.float64) tensor(-1.1708, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1630, dtype=torch.float64) delta_t tensor(-0.0349, dtype=torch.float64)
8 gae_duplicate tensor(-0.5747, dtype=torch.float64) tensor(0.2540, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4451, dtype=torch.float64) delta_t tensor(-0.0661, dtype=torch.float64)
7 gae_duplicate tensor(-0.6369, dtype=torch.float64) tensor(1.2539, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2800, dtype=torch.float64) delta_t tensor(-0.2447, dtype=torch.float64)
6 gae_duplicate tensor(-1.7782, dtype=torch.float64) tensor(0.5810, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2349, dtype=torch.float64) delta_t tensor(-0.9136, dtype=torch.float64)
5 gae_duplicate tensor(-1.6971, dtype=torch.float64) tensor(12.3532, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5921, dtype=torch.float64) delta_t tensor(-1.3592, dtype=torch.float64)
4 gae_duplicate tensor(-7.3445, dtype=torch.float64) tensor(15.1564, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6629, dtype=torch.float64) delta_t tensor(-0.5252, dtype=torch.float64)
3 gae_duplicate tensor(-1.2993, dtype=torch.float64) tensor(5.1140, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4120, dtype=torch.float64) delta_t tensor(-0.2983, dtype=torch.float64)
2 gae_duplicate tensor(-0.8719, dtype=torch.float64) tensor(6.2773, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-262.6834716796875
value loss:137.47979736328125
entropies:178.6399383544922
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2302.5625)
ToM Target loss= tensor(1807.8557)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.83263897895813 seconds
19 rew tensor(0.7753, dtype=torch.float64) delta_t tensor(0.2707, dtype=torch.float64)
19 gae_duplicate tensor(-0.0757, dtype=torch.float64) tensor(-1.9845, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7665, dtype=torch.float64) delta_t tensor(0.3238, dtype=torch.float64)
18 gae_duplicate tensor(-0.0883, dtype=torch.float64) tensor(-4.1714, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7396, dtype=torch.float64) delta_t tensor(0.3301, dtype=torch.float64)
17 gae_duplicate tensor(0.0199, dtype=torch.float64) tensor(-2.1473, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6676, dtype=torch.float64) delta_t tensor(0.2594, dtype=torch.float64)
16 gae_duplicate tensor(-0.1598, dtype=torch.float64) tensor(-2.0496, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5684, dtype=torch.float64) delta_t tensor(0.2879, dtype=torch.float64)
15 gae_duplicate tensor(-0.6841, dtype=torch.float64) tensor(-4.0827, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7393, dtype=torch.float64) delta_t tensor(0.5893, dtype=torch.float64)
14 gae_duplicate tensor(0.5301, dtype=torch.float64) tensor(-6.9698, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6654, dtype=torch.float64) delta_t tensor(0.4435, dtype=torch.float64)
13 gae_duplicate tensor(-0.0570, dtype=torch.float64) tensor(-4.7147, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5821, dtype=torch.float64) delta_t tensor(0.4156, dtype=torch.float64)
12 gae_duplicate tensor(-0.3224, dtype=torch.float64) tensor(-4.5335, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1676, dtype=torch.float64) delta_t tensor(0.1515, dtype=torch.float64)
11 gae_duplicate tensor(-1.5282, dtype=torch.float64) tensor(-7.0257, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4543, dtype=torch.float64) delta_t tensor(0.5931, dtype=torch.float64)
10 gae_duplicate tensor(-0.0649, dtype=torch.float64) tensor(-6.3889, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1319, dtype=torch.float64) delta_t tensor(0.1552, dtype=torch.float64)
9 gae_duplicate tensor(-0.5628, dtype=torch.float64) tensor(-3.4697, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1270, dtype=torch.float64) delta_t tensor(0.0108, dtype=torch.float64)
8 gae_duplicate tensor(-0.7400, dtype=torch.float64) tensor(-2.2732, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4066, dtype=torch.float64) delta_t tensor(-0.3707, dtype=torch.float64)
7 gae_duplicate tensor(-0.7891, dtype=torch.float64) tensor(4.3781, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3029, dtype=torch.float64) delta_t tensor(0.0076, dtype=torch.float64)
6 gae_duplicate tensor(-1.1009, dtype=torch.float64) tensor(0.8665, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9314, dtype=torch.float64) delta_t tensor(-0.6511, dtype=torch.float64)
5 gae_duplicate tensor(-1.5277, dtype=torch.float64) tensor(5.1894, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6148, dtype=torch.float64) delta_t tensor(-0.3493, dtype=torch.float64)
4 gae_duplicate tensor(-1.6586, dtype=torch.float64) tensor(2.5938, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3804, dtype=torch.float64) delta_t tensor(-0.1858, dtype=torch.float64)
3 gae_duplicate tensor(-0.9424, dtype=torch.float64) tensor(1.9621, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2298, dtype=torch.float64) delta_t tensor(-0.2827, dtype=torch.float64)
2 gae_duplicate tensor(-0.4325, dtype=torch.float64) tensor(3.6495, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1090.189208984375
value loss:56.81397247314453
entropies:177.74945068359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.086542129516602 seconds
19 rew tensor(0.7590, dtype=torch.float64) delta_t tensor(0.3073, dtype=torch.float64)
19 gae_duplicate tensor(-0.1448, dtype=torch.float64) tensor(-3.1337, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7419, dtype=torch.float64) delta_t tensor(0.3384, dtype=torch.float64)
18 gae_duplicate tensor(-0.1904, dtype=torch.float64) tensor(-2.1460, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6902, dtype=torch.float64) delta_t tensor(0.3482, dtype=torch.float64)
17 gae_duplicate tensor(-0.2401, dtype=torch.float64) tensor(-4.1457, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5794, dtype=torch.float64) delta_t tensor(0.2666, dtype=torch.float64)
16 gae_duplicate tensor(-0.3353, dtype=torch.float64) tensor(-2.3789, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3923, dtype=torch.float64) delta_t tensor(0.1375, dtype=torch.float64)
15 gae_duplicate tensor(-0.9392, dtype=torch.float64) tensor(-2.1913, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5175, dtype=torch.float64) delta_t tensor(0.3026, dtype=torch.float64)
14 gae_duplicate tensor(-0.5596, dtype=torch.float64) tensor(-3.5443, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6096, dtype=torch.float64) delta_t tensor(0.4038, dtype=torch.float64)
13 gae_duplicate tensor(-0.0398, dtype=torch.float64) tensor(-3.4655, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6486, dtype=torch.float64) delta_t tensor(0.4176, dtype=torch.float64)
12 gae_duplicate tensor(0.1138, dtype=torch.float64) tensor(-2.3725, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6047, dtype=torch.float64) delta_t tensor(0.4810, dtype=torch.float64)
11 gae_duplicate tensor(0.0122, dtype=torch.float64) tensor(-6.2693, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1467, dtype=torch.float64) delta_t tensor(-0.0010, dtype=torch.float64)
10 gae_duplicate tensor(-1.3713, dtype=torch.float64) tensor(-0.1346, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0522, dtype=torch.float64) delta_t tensor(-1.2171, dtype=torch.float64)
9 gae_duplicate tensor(-3.0064, dtype=torch.float64) tensor(15.2041, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4783, dtype=torch.float64) delta_t tensor(-0.4552, dtype=torch.float64)
8 gae_duplicate tensor(-2.1248, dtype=torch.float64) tensor(9.9518, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0653, dtype=torch.float64) delta_t tensor(-0.1048, dtype=torch.float64)
7 gae_duplicate tensor(-0.5251, dtype=torch.float64) tensor(1.0558, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4851, dtype=torch.float64) delta_t tensor(-1.3767, dtype=torch.float64)
6 gae_duplicate tensor(-3.2613, dtype=torch.float64) tensor(10.8823, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5561, dtype=torch.float64) delta_t tensor(-1.2437, dtype=torch.float64)
5 gae_duplicate tensor(-3.0957, dtype=torch.float64) tensor(14.0688, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7177, dtype=torch.float64) delta_t tensor(-1.4958, dtype=torch.float64)
4 gae_duplicate tensor(-8.1200, dtype=torch.float64) tensor(17.2433, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5592, dtype=torch.float64) delta_t tensor(-0.3579, dtype=torch.float64)
3 gae_duplicate tensor(-1.2414, dtype=torch.float64) tensor(6.1742, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1844, dtype=torch.float64) delta_t tensor(-0.0953, dtype=torch.float64)
2 gae_duplicate tensor(-0.9167, dtype=torch.float64) tensor(2.3433, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1728.39501953125
value loss:238.01812744140625
entropies:173.831298828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.578874111175537 seconds
19 rew tensor(0.7405, dtype=torch.float64) delta_t tensor(0.4015, dtype=torch.float64)
19 gae_duplicate tensor(-0.0432, dtype=torch.float64) tensor(-4.0802, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7147, dtype=torch.float64) delta_t tensor(0.4025, dtype=torch.float64)
18 gae_duplicate tensor(-0.2063, dtype=torch.float64) tensor(-4.6142, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6370, dtype=torch.float64) delta_t tensor(0.4239, dtype=torch.float64)
17 gae_duplicate tensor(-0.2971, dtype=torch.float64) tensor(-5.1322, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7775, dtype=torch.float64) delta_t tensor(0.4754, dtype=torch.float64)
16 gae_duplicate tensor(0.0624, dtype=torch.float64) tensor(-3.3082, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7155, dtype=torch.float64) delta_t tensor(0.4939, dtype=torch.float64)
15 gae_duplicate tensor(0.2754, dtype=torch.float64) tensor(-8.4494, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6551, dtype=torch.float64) delta_t tensor(0.3822, dtype=torch.float64)
14 gae_duplicate tensor(0.1198, dtype=torch.float64) tensor(-4.0353, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5118, dtype=torch.float64) delta_t tensor(0.5091, dtype=torch.float64)
13 gae_duplicate tensor(-0.0182, dtype=torch.float64) tensor(-8.0883, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3941, dtype=torch.float64) delta_t tensor(0.1736, dtype=torch.float64)
12 gae_duplicate tensor(-0.1560, dtype=torch.float64) tensor(-1.7971, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3916, dtype=torch.float64) delta_t tensor(0.2279, dtype=torch.float64)
11 gae_duplicate tensor(-0.7868, dtype=torch.float64) tensor(-3.3995, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1178, dtype=torch.float64) delta_t tensor(-0.0219, dtype=torch.float64)
10 gae_duplicate tensor(-1.2288, dtype=torch.float64) tensor(-1.1912, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6957, dtype=torch.float64) delta_t tensor(-0.5642, dtype=torch.float64)
9 gae_duplicate tensor(-3.0558, dtype=torch.float64) tensor(3.0631, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0042, dtype=torch.float64) delta_t tensor(0.0374, dtype=torch.float64)
8 gae_duplicate tensor(-1.8304, dtype=torch.float64) tensor(-0.3083, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4111, dtype=torch.float64) delta_t tensor(-0.2994, dtype=torch.float64)
7 gae_duplicate tensor(-1.0797, dtype=torch.float64) tensor(3.8087, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7188, dtype=torch.float64) delta_t tensor(-0.6079, dtype=torch.float64)
6 gae_duplicate tensor(-2.3178, dtype=torch.float64) tensor(1.6811, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3852, dtype=torch.float64) delta_t tensor(-0.9738, dtype=torch.float64)
5 gae_duplicate tensor(-2.5770, dtype=torch.float64) tensor(13.2590, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6833, dtype=torch.float64) delta_t tensor(-1.5069, dtype=torch.float64)
4 gae_duplicate tensor(-7.4764, dtype=torch.float64) tensor(30.1722, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6157, dtype=torch.float64) delta_t tensor(-0.3559, dtype=torch.float64)
3 gae_duplicate tensor(-0.8181, dtype=torch.float64) tensor(6.2622, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2670, dtype=torch.float64) delta_t tensor(-0.2391, dtype=torch.float64)
2 gae_duplicate tensor(-0.8087, dtype=torch.float64) tensor(3.6888, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-662.28857421875
value loss:206.51834106445312
entropies:173.13023376464844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9955010414123535 seconds
19 rew tensor(0.7927, dtype=torch.float64) delta_t tensor(0.5143, dtype=torch.float64)
19 gae_duplicate tensor(0.2050, dtype=torch.float64) tensor(-4.0647, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7848, dtype=torch.float64) delta_t tensor(0.5269, dtype=torch.float64)
18 gae_duplicate tensor(0.3104, dtype=torch.float64) tensor(-4.2652, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7851, dtype=torch.float64) delta_t tensor(0.4208, dtype=torch.float64)
17 gae_duplicate tensor(0.1060, dtype=torch.float64) tensor(-3.3845, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7423, dtype=torch.float64) delta_t tensor(0.4737, dtype=torch.float64)
16 gae_duplicate tensor(0.3121, dtype=torch.float64) tensor(-3.5899, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7259, dtype=torch.float64) delta_t tensor(0.5072, dtype=torch.float64)
15 gae_duplicate tensor(0.2846, dtype=torch.float64) tensor(-3.2387, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6835, dtype=torch.float64) delta_t tensor(0.5307, dtype=torch.float64)
14 gae_duplicate tensor(0.1901, dtype=torch.float64) tensor(-6.0700, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3075, dtype=torch.float64) delta_t tensor(0.2498, dtype=torch.float64)
13 gae_duplicate tensor(-1.3172, dtype=torch.float64) tensor(-4.7497, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6284, dtype=torch.float64) delta_t tensor(0.4707, dtype=torch.float64)
12 gae_duplicate tensor(0.2234, dtype=torch.float64) tensor(-6.6564, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3902, dtype=torch.float64) delta_t tensor(0.4354, dtype=torch.float64)
11 gae_duplicate tensor(0.0352, dtype=torch.float64) tensor(-3.6568, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1031, dtype=torch.float64) delta_t tensor(0.1010, dtype=torch.float64)
10 gae_duplicate tensor(-0.3766, dtype=torch.float64) tensor(-0.4166, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0529, dtype=torch.float64) delta_t tensor(-0.0218, dtype=torch.float64)
9 gae_duplicate tensor(-0.5937, dtype=torch.float64) tensor(0.2685, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5292, dtype=torch.float64) delta_t tensor(-0.5172, dtype=torch.float64)
8 gae_duplicate tensor(-1.9271, dtype=torch.float64) tensor(3.0614, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7488, dtype=torch.float64) delta_t tensor(-0.6447, dtype=torch.float64)
7 gae_duplicate tensor(-2.0719, dtype=torch.float64) tensor(10.9326, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2661, dtype=torch.float64) delta_t tensor(-1.0732, dtype=torch.float64)
6 gae_duplicate tensor(-1.8142, dtype=torch.float64) tensor(8.9017, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5200, dtype=torch.float64) delta_t tensor(-1.2136, dtype=torch.float64)
5 gae_duplicate tensor(-2.8866, dtype=torch.float64) tensor(16.2083, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0909, dtype=torch.float64) delta_t tensor(-0.7558, dtype=torch.float64)
4 gae_duplicate tensor(-5.7453, dtype=torch.float64) tensor(6.6329, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3357, dtype=torch.float64) delta_t tensor(-0.1819, dtype=torch.float64)
3 gae_duplicate tensor(-0.6104, dtype=torch.float64) tensor(1.9422, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1907, dtype=torch.float64) delta_t tensor(-0.2072, dtype=torch.float64)
2 gae_duplicate tensor(-0.3461, dtype=torch.float64) tensor(2.1153, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-390.37469482421875
value loss:150.28575134277344
entropies:174.70570373535156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.84112024307251 seconds
19 rew tensor(0.6805, dtype=torch.float64) delta_t tensor(0.0288, dtype=torch.float64)
19 gae_duplicate tensor(-0.3214, dtype=torch.float64) tensor(-0.0203, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5778, dtype=torch.float64) delta_t tensor(0.0420, dtype=torch.float64)
18 gae_duplicate tensor(-0.4961, dtype=torch.float64) tensor(0.4987, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3738, dtype=torch.float64) delta_t tensor(-0.0203, dtype=torch.float64)
17 gae_duplicate tensor(-1.2097, dtype=torch.float64) tensor(1.2219, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5550, dtype=torch.float64) delta_t tensor(0.2185, dtype=torch.float64)
16 gae_duplicate tensor(-0.2631, dtype=torch.float64) tensor(-1.4385, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3509, dtype=torch.float64) delta_t tensor(0.2277, dtype=torch.float64)
15 gae_duplicate tensor(-0.7937, dtype=torch.float64) tensor(-2.2667, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3995, dtype=torch.float64) delta_t tensor(0.2683, dtype=torch.float64)
14 gae_duplicate tensor(-0.5595, dtype=torch.float64) tensor(-3.4316, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7205, dtype=torch.float64) delta_t tensor(0.6156, dtype=torch.float64)
13 gae_duplicate tensor(0.2868, dtype=torch.float64) tensor(-6.5923, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7403, dtype=torch.float64) delta_t tensor(0.7433, dtype=torch.float64)
12 gae_duplicate tensor(0.6453, dtype=torch.float64) tensor(-4.7790, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7060, dtype=torch.float64) delta_t tensor(0.5748, dtype=torch.float64)
11 gae_duplicate tensor(0.2464, dtype=torch.float64) tensor(-6.5926, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.8828, dtype=torch.float64) delta_t tensor(-1.0017, dtype=torch.float64)
10 gae_duplicate tensor(-4.5842, dtype=torch.float64) tensor(6.2035, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0498, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
9 gae_duplicate tensor(-1.8137, dtype=torch.float64) tensor(3.1210, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5411, dtype=torch.float64) delta_t tensor(-0.6414, dtype=torch.float64)
8 gae_duplicate tensor(-2.9445, dtype=torch.float64) tensor(7.6486, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8573, dtype=torch.float64) delta_t tensor(-0.9151, dtype=torch.float64)
7 gae_duplicate tensor(-2.5173, dtype=torch.float64) tensor(9.2352, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3074, dtype=torch.float64) delta_t tensor(-1.2152, dtype=torch.float64)
6 gae_duplicate tensor(-2.0782, dtype=torch.float64) tensor(11.9992, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2553, dtype=torch.float64) delta_t tensor(-1.1218, dtype=torch.float64)
5 gae_duplicate tensor(-2.2730, dtype=torch.float64) tensor(11.7796, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6095, dtype=torch.float64) delta_t tensor(-3.3824, dtype=torch.float64)
4 gae_duplicate tensor(-8.4499, dtype=torch.float64) tensor(40.4204, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0260, dtype=torch.float64) delta_t tensor(-0.0262, dtype=torch.float64)
3 gae_duplicate tensor(-1.0137, dtype=torch.float64) tensor(3.2479, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3814, dtype=torch.float64) delta_t tensor(-0.4130, dtype=torch.float64)
2 gae_duplicate tensor(-1.1654, dtype=torch.float64) tensor(3.6442, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2690.736083984375
value loss:387.8243408203125
entropies:168.69143676757812
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2297.1855)
ToM Target loss= tensor(1808.4918)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.8930768966674805 seconds
19 rew tensor(0.7829, dtype=torch.float64) delta_t tensor(0.4820, dtype=torch.float64)
19 gae_duplicate tensor(0.0058, dtype=torch.float64) tensor(-4.6421, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7745, dtype=torch.float64) delta_t tensor(0.4100, dtype=torch.float64)
18 gae_duplicate tensor(0.1141, dtype=torch.float64) tensor(-7.0950, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7401, dtype=torch.float64) delta_t tensor(0.3243, dtype=torch.float64)
17 gae_duplicate tensor(-0.0286, dtype=torch.float64) tensor(-2.0864, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7057, dtype=torch.float64) delta_t tensor(0.4158, dtype=torch.float64)
16 gae_duplicate tensor(-0.1782, dtype=torch.float64) tensor(-4.6651, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6193, dtype=torch.float64) delta_t tensor(0.5227, dtype=torch.float64)
15 gae_duplicate tensor(-0.0228, dtype=torch.float64) tensor(-4.5086, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7667, dtype=torch.float64) delta_t tensor(0.7891, dtype=torch.float64)
14 gae_duplicate tensor(0.5900, dtype=torch.float64) tensor(-7.8706, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6894, dtype=torch.float64) delta_t tensor(0.5837, dtype=torch.float64)
13 gae_duplicate tensor(0.2951, dtype=torch.float64) tensor(-5.7181, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5950, dtype=torch.float64) delta_t tensor(0.4500, dtype=torch.float64)
12 gae_duplicate tensor(0.3084, dtype=torch.float64) tensor(-4.3557, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4672, dtype=torch.float64) delta_t tensor(0.2527, dtype=torch.float64)
11 gae_duplicate tensor(0.0652, dtype=torch.float64) tensor(-2.5053, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1574, dtype=torch.float64) delta_t tensor(0.1259, dtype=torch.float64)
10 gae_duplicate tensor(-0.6807, dtype=torch.float64) tensor(-3.4680, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4628, dtype=torch.float64) delta_t tensor(-0.4426, dtype=torch.float64)
9 gae_duplicate tensor(-2.2967, dtype=torch.float64) tensor(2.8637, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4322, dtype=torch.float64) delta_t tensor(-0.3260, dtype=torch.float64)
8 gae_duplicate tensor(-3.2896, dtype=torch.float64) tensor(0.1973, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4916, dtype=torch.float64) delta_t tensor(-0.1539, dtype=torch.float64)
7 gae_duplicate tensor(-2.6496, dtype=torch.float64) tensor(4.2651, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1888, dtype=torch.float64) delta_t tensor(-0.0644, dtype=torch.float64)
6 gae_duplicate tensor(-0.7537, dtype=torch.float64) tensor(1.6027, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8908, dtype=torch.float64) delta_t tensor(-0.5895, dtype=torch.float64)
5 gae_duplicate tensor(-1.2162, dtype=torch.float64) tensor(5.3481, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4954, dtype=torch.float64) delta_t tensor(-0.1272, dtype=torch.float64)
4 gae_duplicate tensor(-1.0182, dtype=torch.float64) tensor(3.5958, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2681, dtype=torch.float64) delta_t tensor(0.0520, dtype=torch.float64)
3 gae_duplicate tensor(-0.9654, dtype=torch.float64) tensor(-1.3276, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4865, dtype=torch.float64) delta_t tensor(-0.4215, dtype=torch.float64)
2 gae_duplicate tensor(-0.7841, dtype=torch.float64) tensor(3.0448, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:953.0338134765625
value loss:93.39688873291016
entropies:170.3863983154297
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.918844938278198 seconds
19 rew tensor(0.7845, dtype=torch.float64) delta_t tensor(0.3685, dtype=torch.float64)
19 gae_duplicate tensor(0.1056, dtype=torch.float64) tensor(-4.3647, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7847, dtype=torch.float64) delta_t tensor(0.2839, dtype=torch.float64)
18 gae_duplicate tensor(0.1646, dtype=torch.float64) tensor(-3.0834, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7695, dtype=torch.float64) delta_t tensor(0.3333, dtype=torch.float64)
17 gae_duplicate tensor(0.2641, dtype=torch.float64) tensor(-3.8912, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7389, dtype=torch.float64) delta_t tensor(0.3655, dtype=torch.float64)
16 gae_duplicate tensor(-0.2047, dtype=torch.float64) tensor(-3.1347, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6851, dtype=torch.float64) delta_t tensor(0.3955, dtype=torch.float64)
15 gae_duplicate tensor(-0.2789, dtype=torch.float64) tensor(-2.4048, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3896, dtype=torch.float64) delta_t tensor(0.2009, dtype=torch.float64)
14 gae_duplicate tensor(-0.5243, dtype=torch.float64) tensor(-2.1059, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6301, dtype=torch.float64) delta_t tensor(0.5227, dtype=torch.float64)
13 gae_duplicate tensor(0.0802, dtype=torch.float64) tensor(-6.4667, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5159, dtype=torch.float64) delta_t tensor(0.3297, dtype=torch.float64)
12 gae_duplicate tensor(-0.4940, dtype=torch.float64) tensor(-4.3596, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2503, dtype=torch.float64) delta_t tensor(0.1845, dtype=torch.float64)
11 gae_duplicate tensor(-1.4235, dtype=torch.float64) tensor(-2.2116, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5453, dtype=torch.float64) delta_t tensor(0.5366, dtype=torch.float64)
10 gae_duplicate tensor(-0.1304, dtype=torch.float64) tensor(-6.3980, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0945, dtype=torch.float64) delta_t tensor(0.2327, dtype=torch.float64)
9 gae_duplicate tensor(-0.9268, dtype=torch.float64) tensor(-5.0243, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2078, dtype=torch.float64) delta_t tensor(-0.1922, dtype=torch.float64)
8 gae_duplicate tensor(-1.8300, dtype=torch.float64) tensor(3.0246, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6127, dtype=torch.float64) delta_t tensor(-0.4963, dtype=torch.float64)
7 gae_duplicate tensor(-2.0398, dtype=torch.float64) tensor(7.2721, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8635, dtype=torch.float64) delta_t tensor(-0.6184, dtype=torch.float64)
6 gae_duplicate tensor(-1.6353, dtype=torch.float64) tensor(5.3685, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3964, dtype=torch.float64) delta_t tensor(-1.0812, dtype=torch.float64)
5 gae_duplicate tensor(-3.1738, dtype=torch.float64) tensor(13.5265, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8527, dtype=torch.float64) delta_t tensor(-0.6295, dtype=torch.float64)
4 gae_duplicate tensor(-3.7754, dtype=torch.float64) tensor(5.0816, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4422, dtype=torch.float64) delta_t tensor(-0.0826, dtype=torch.float64)
3 gae_duplicate tensor(-0.5614, dtype=torch.float64) tensor(0.9466, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3047, dtype=torch.float64) delta_t tensor(-0.2640, dtype=torch.float64)
2 gae_duplicate tensor(-0.5778, dtype=torch.float64) tensor(4.4022, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:107.30143737792969
value loss:101.4148178100586
entropies:168.4412078857422
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.738818883895874 seconds
19 rew tensor(0.6138, dtype=torch.float64) delta_t tensor(0.2303, dtype=torch.float64)
19 gae_duplicate tensor(-0.6409, dtype=torch.float64) tensor(-1.9486, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7759, dtype=torch.float64) delta_t tensor(0.4057, dtype=torch.float64)
18 gae_duplicate tensor(0.2316, dtype=torch.float64) tensor(-4.5674, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7848, dtype=torch.float64) delta_t tensor(0.3590, dtype=torch.float64)
17 gae_duplicate tensor(0.1687, dtype=torch.float64) tensor(-3.4113, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7678, dtype=torch.float64) delta_t tensor(0.3727, dtype=torch.float64)
16 gae_duplicate tensor(0.2347, dtype=torch.float64) tensor(-5.3582, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7336, dtype=torch.float64) delta_t tensor(0.4286, dtype=torch.float64)
15 gae_duplicate tensor(-0.0539, dtype=torch.float64) tensor(-2.3517, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6821, dtype=torch.float64) delta_t tensor(0.5278, dtype=torch.float64)
14 gae_duplicate tensor(-0.2725, dtype=torch.float64) tensor(-5.3985, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6054, dtype=torch.float64) delta_t tensor(0.6316, dtype=torch.float64)
13 gae_duplicate tensor(0.2855, dtype=torch.float64) tensor(-10.1216, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5901, dtype=torch.float64) delta_t tensor(0.5953, dtype=torch.float64)
12 gae_duplicate tensor(0.1806, dtype=torch.float64) tensor(-6.9533, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4723, dtype=torch.float64) delta_t tensor(0.4688, dtype=torch.float64)
11 gae_duplicate tensor(0.0752, dtype=torch.float64) tensor(-5.0187, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2474, dtype=torch.float64) delta_t tensor(0.0685, dtype=torch.float64)
10 gae_duplicate tensor(-0.3859, dtype=torch.float64) tensor(-1.4720, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3425, dtype=torch.float64) delta_t tensor(-0.1044, dtype=torch.float64)
9 gae_duplicate tensor(-1.2701, dtype=torch.float64) tensor(-0.8020, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3127, dtype=torch.float64) delta_t tensor(-0.4827, dtype=torch.float64)
8 gae_duplicate tensor(-1.5708, dtype=torch.float64) tensor(6.5355, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7944, dtype=torch.float64) delta_t tensor(-0.6043, dtype=torch.float64)
7 gae_duplicate tensor(-2.7550, dtype=torch.float64) tensor(7.4771, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6654, dtype=torch.float64) delta_t tensor(-0.5878, dtype=torch.float64)
6 gae_duplicate tensor(-1.2381, dtype=torch.float64) tensor(13.3888, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8861, dtype=torch.float64) delta_t tensor(-0.6760, dtype=torch.float64)
5 gae_duplicate tensor(-1.7899, dtype=torch.float64) tensor(7.4974, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6273, dtype=torch.float64) delta_t tensor(-0.4264, dtype=torch.float64)
4 gae_duplicate tensor(-1.8230, dtype=torch.float64) tensor(2.0252, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9275, dtype=torch.float64) delta_t tensor(-0.7804, dtype=torch.float64)
3 gae_duplicate tensor(-1.5017, dtype=torch.float64) tensor(6.5041, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1405, dtype=torch.float64) delta_t tensor(-0.0749, dtype=torch.float64)
2 gae_duplicate tensor(-0.3090, dtype=torch.float64) tensor(2.4187, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:26.24362564086914
value loss:91.75982666015625
entropies:165.497314453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.2032630443573 seconds
19 rew tensor(0.7508, dtype=torch.float64) delta_t tensor(0.2177, dtype=torch.float64)
19 gae_duplicate tensor(-0.1933, dtype=torch.float64) tensor(-0.9216, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7000, dtype=torch.float64) delta_t tensor(0.2371, dtype=torch.float64)
18 gae_duplicate tensor(-0.1713, dtype=torch.float64) tensor(-1.7044, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6241, dtype=torch.float64) delta_t tensor(0.2803, dtype=torch.float64)
17 gae_duplicate tensor(-0.2700, dtype=torch.float64) tensor(-2.7099, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4481, dtype=torch.float64) delta_t tensor(0.1741, dtype=torch.float64)
16 gae_duplicate tensor(-0.8148, dtype=torch.float64) tensor(2.1127, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6623, dtype=torch.float64) delta_t tensor(0.4021, dtype=torch.float64)
15 gae_duplicate tensor(-0.1090, dtype=torch.float64) tensor(-4.6996, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6780, dtype=torch.float64) delta_t tensor(0.4123, dtype=torch.float64)
14 gae_duplicate tensor(-0.0237, dtype=torch.float64) tensor(-3.8131, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7596, dtype=torch.float64) delta_t tensor(0.5369, dtype=torch.float64)
13 gae_duplicate tensor(0.2582, dtype=torch.float64) tensor(-3.8130, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6285, dtype=torch.float64) delta_t tensor(0.4880, dtype=torch.float64)
12 gae_duplicate tensor(0.2584, dtype=torch.float64) tensor(-4.9052, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3949, dtype=torch.float64) delta_t tensor(0.0321, dtype=torch.float64)
11 gae_duplicate tensor(-0.2122, dtype=torch.float64) tensor(-0.6741, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.4068, dtype=torch.float64) delta_t tensor(-1.6949, dtype=torch.float64)
10 gae_duplicate tensor(-6.2921, dtype=torch.float64) tensor(26.3966, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2992, dtype=torch.float64) delta_t tensor(-0.3866, dtype=torch.float64)
9 gae_duplicate tensor(-2.3625, dtype=torch.float64) tensor(7.6143, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4389, dtype=torch.float64) delta_t tensor(-0.4976, dtype=torch.float64)
8 gae_duplicate tensor(-2.8911, dtype=torch.float64) tensor(8.8019, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5577, dtype=torch.float64) delta_t tensor(-0.3348, dtype=torch.float64)
7 gae_duplicate tensor(-2.3476, dtype=torch.float64) tensor(1.6951, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6347, dtype=torch.float64) delta_t tensor(-0.6252, dtype=torch.float64)
6 gae_duplicate tensor(-2.4200, dtype=torch.float64) tensor(4.9105, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3477, dtype=torch.float64) delta_t tensor(-1.2053, dtype=torch.float64)
5 gae_duplicate tensor(-1.7556, dtype=torch.float64) tensor(15.3645, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3534, dtype=torch.float64) delta_t tensor(-0.0478, dtype=torch.float64)
4 gae_duplicate tensor(-1.0266, dtype=torch.float64) tensor(1.7779, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3181, dtype=torch.float64) delta_t tensor(-0.1198, dtype=torch.float64)
3 gae_duplicate tensor(-1.0001, dtype=torch.float64) tensor(0.7573, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3335, dtype=torch.float64) delta_t tensor(-0.3301, dtype=torch.float64)
2 gae_duplicate tensor(-0.9932, dtype=torch.float64) tensor(2.4190, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1779.142578125
value loss:178.9322509765625
entropies:162.3424530029297
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.705075979232788 seconds
19 rew tensor(0.6291, dtype=torch.float64) delta_t tensor(0.1150, dtype=torch.float64)
19 gae_duplicate tensor(-0.6755, dtype=torch.float64) tensor(-1.1439, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4822, dtype=torch.float64) delta_t tensor(0.1579, dtype=torch.float64)
18 gae_duplicate tensor(-1.2640, dtype=torch.float64) tensor(-2.7781, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7938, dtype=torch.float64) delta_t tensor(0.4729, dtype=torch.float64)
17 gae_duplicate tensor(0.2898, dtype=torch.float64) tensor(-2.9628, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7854, dtype=torch.float64) delta_t tensor(0.4475, dtype=torch.float64)
16 gae_duplicate tensor(0.1982, dtype=torch.float64) tensor(-2.5876, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7856, dtype=torch.float64) delta_t tensor(0.5978, dtype=torch.float64)
15 gae_duplicate tensor(0.3205, dtype=torch.float64) tensor(-4.1818, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7772, dtype=torch.float64) delta_t tensor(0.6323, dtype=torch.float64)
14 gae_duplicate tensor(0.5025, dtype=torch.float64) tensor(-7.9623, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7023, dtype=torch.float64) delta_t tensor(0.6371, dtype=torch.float64)
13 gae_duplicate tensor(0.1063, dtype=torch.float64) tensor(-4.8581, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6902, dtype=torch.float64) delta_t tensor(0.5290, dtype=torch.float64)
12 gae_duplicate tensor(0.2679, dtype=torch.float64) tensor(-7.8952, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6082, dtype=torch.float64) delta_t tensor(0.4793, dtype=torch.float64)
11 gae_duplicate tensor(0.0262, dtype=torch.float64) tensor(-3.2339, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3413, dtype=torch.float64) delta_t tensor(0.2942, dtype=torch.float64)
10 gae_duplicate tensor(-0.3693, dtype=torch.float64) tensor(-2.6871, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3935, dtype=torch.float64) delta_t tensor(-0.5562, dtype=torch.float64)
9 gae_duplicate tensor(-2.0370, dtype=torch.float64) tensor(3.8967, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4318, dtype=torch.float64) delta_t tensor(-0.5422, dtype=torch.float64)
8 gae_duplicate tensor(-1.2964, dtype=torch.float64) tensor(4.7485, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7806, dtype=torch.float64) delta_t tensor(-0.5826, dtype=torch.float64)
7 gae_duplicate tensor(-2.4371, dtype=torch.float64) tensor(16.8944, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2611, dtype=torch.float64) delta_t tensor(-0.1621, dtype=torch.float64)
6 gae_duplicate tensor(-1.6784, dtype=torch.float64) tensor(1.6734, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8271, dtype=torch.float64) delta_t tensor(-0.3357, dtype=torch.float64)
5 gae_duplicate tensor(-1.5621, dtype=torch.float64) tensor(3.3654, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1713, dtype=torch.float64) delta_t tensor(0.3619, dtype=torch.float64)
4 gae_duplicate tensor(0.0442, dtype=torch.float64) tensor(-3.7476, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3647, dtype=torch.float64) delta_t tensor(-0.0244, dtype=torch.float64)
3 gae_duplicate tensor(-0.6333, dtype=torch.float64) tensor(-0.6854, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1741, dtype=torch.float64) delta_t tensor(-0.2145, dtype=torch.float64)
2 gae_duplicate tensor(-0.3250, dtype=torch.float64) tensor(1.8342, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:413.87884521484375
value loss:78.21376037597656
entropies:162.91250610351562
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2301.1797)
ToM Target loss= tensor(1808.3800)
optimized based on ToM loss
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt