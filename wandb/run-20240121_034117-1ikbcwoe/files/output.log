obs <crafter.objects.Shelter object at 0x1346941f0> [ 0 39  0  0 39  0  0  7  0]
obs <crafter.objects.Warehouse object at 0x1346a40d0> [ 0 43  0  0 42  0  0  9  0]
obs <crafter.objects.Station object at 0x1346a4430> [ 0  9  0  0  9  0  0 10  0]
obs <crafter.objects.Shelter object at 0x1346941f0> [ 0 39  0  0 39  0  0  9  0]
obs <crafter.objects.Warehouse object at 0x1346a40d0> [ 0 37  0  0 37  0  0  9  0]
obs <crafter.objects.Station object at 0x1346a4430> [ 0  9  0  0  9  0  0 10  0]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0014781951904296875 seconds
19 rew tensor(0.8793, dtype=torch.float64) delta_t tensor(0.6878, dtype=torch.float64)
19 gae_duplicate tensor(0.4866, dtype=torch.float64) tensor(-7.7030, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8982, dtype=torch.float64) delta_t tensor(0.7193, dtype=torch.float64)
18 gae_duplicate tensor(0.5859, dtype=torch.float64) tensor(-9.5958, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9215, dtype=torch.float64) delta_t tensor(0.7745, dtype=torch.float64)
17 gae_duplicate tensor(0.6299, dtype=torch.float64) tensor(-10.0023, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8755, dtype=torch.float64) delta_t tensor(0.7101, dtype=torch.float64)
16 gae_duplicate tensor(0.2747, dtype=torch.float64) tensor(-9.4068, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7851, dtype=torch.float64) delta_t tensor(0.6025, dtype=torch.float64)
15 gae_duplicate tensor(-0.8352, dtype=torch.float64) tensor(-7.7562, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.1307, dtype=torch.float64) delta_t tensor(0.9765, dtype=torch.float64)
14 gae_duplicate tensor(0.4745, dtype=torch.float64) tensor(-13.0430, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.1220, dtype=torch.float64) delta_t tensor(0.9836, dtype=torch.float64)
13 gae_duplicate tensor(0.3497, dtype=torch.float64) tensor(-12.2892, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.2294, dtype=torch.float64) delta_t tensor(1.0637, dtype=torch.float64)
12 gae_duplicate tensor(0.6051, dtype=torch.float64) tensor(-14.3191, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.3454, dtype=torch.float64) delta_t tensor(1.1486, dtype=torch.float64)
11 gae_duplicate tensor(0.6959, dtype=torch.float64) tensor(-15.6834, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(1.1043, dtype=torch.float64) delta_t tensor(0.9366, dtype=torch.float64)
10 gae_duplicate tensor(-0.6230, dtype=torch.float64) tensor(-12.9744, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5814, dtype=torch.float64) delta_t tensor(0.3401, dtype=torch.float64)
9 gae_duplicate tensor(-1.7625, dtype=torch.float64) tensor(-5.8371, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6782, dtype=torch.float64) delta_t tensor(0.4465, dtype=torch.float64)
8 gae_duplicate tensor(-2.5208, dtype=torch.float64) tensor(-5.3709, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2829, dtype=torch.float64) delta_t tensor(-0.0003, dtype=torch.float64)
7 gae_duplicate tensor(-0.5540, dtype=torch.float64) tensor(-0.4576, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2033, dtype=torch.float64) delta_t tensor(-0.4735, dtype=torch.float64)
6 gae_duplicate tensor(-1.6539, dtype=torch.float64) tensor(5.6268, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.5437, dtype=torch.float64) delta_t tensor(0.2433, dtype=torch.float64)
5 gae_duplicate tensor(-1.1110, dtype=torch.float64) tensor(-3.4374, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3493, dtype=torch.float64) delta_t tensor(-0.6683, dtype=torch.float64)
4 gae_duplicate tensor(-1.8093, dtype=torch.float64) tensor(7.7702, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5403, dtype=torch.float64) delta_t tensor(-0.8094, dtype=torch.float64)
3 gae_duplicate tensor(-1.9726, dtype=torch.float64) tensor(9.7679, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6723, dtype=torch.float64) delta_t tensor(-0.8734, dtype=torch.float64)
2 gae_duplicate tensor(-1.6170, dtype=torch.float64) tensor(12.6429, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3274.778076171875
value loss:197.5855255126953
entropies:220.4783935546875
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 4.766484022140503 seconds
19 rew tensor(0.8558, dtype=torch.float64) delta_t tensor(0.6959, dtype=torch.float64)
19 gae_duplicate tensor(0.6259, dtype=torch.float64) tensor(-7.9265, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8579, dtype=torch.float64) delta_t tensor(0.7255, dtype=torch.float64)
18 gae_duplicate tensor(0.6909, dtype=torch.float64) tensor(-9.1128, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8268, dtype=torch.float64) delta_t tensor(0.6795, dtype=torch.float64)
17 gae_duplicate tensor(0.4597, dtype=torch.float64) tensor(-9.0596, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7548, dtype=torch.float64) delta_t tensor(0.6082, dtype=torch.float64)
16 gae_duplicate tensor(0.1081, dtype=torch.float64) tensor(-8.0894, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6240, dtype=torch.float64) delta_t tensor(0.4551, dtype=torch.float64)
15 gae_duplicate tensor(-0.4149, dtype=torch.float64) tensor(-6.6028, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8303, dtype=torch.float64) delta_t tensor(0.6510, dtype=torch.float64)
14 gae_duplicate tensor(-0.0309, dtype=torch.float64) tensor(-8.5165, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9212, dtype=torch.float64) delta_t tensor(0.6599, dtype=torch.float64)
13 gae_duplicate tensor(0.3303, dtype=torch.float64) tensor(-9.9538, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8681, dtype=torch.float64) delta_t tensor(0.6314, dtype=torch.float64)
12 gae_duplicate tensor(0.2222, dtype=torch.float64) tensor(-7.6085, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8939, dtype=torch.float64) delta_t tensor(0.6413, dtype=torch.float64)
11 gae_duplicate tensor(0.2492, dtype=torch.float64) tensor(-8.6089, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7270, dtype=torch.float64) delta_t tensor(0.5390, dtype=torch.float64)
10 gae_duplicate tensor(0.4485, dtype=torch.float64) tensor(-7.3178, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2467, dtype=torch.float64) delta_t tensor(-0.0295, dtype=torch.float64)
9 gae_duplicate tensor(-1.9109, dtype=torch.float64) tensor(0.4788, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1868, dtype=torch.float64) delta_t tensor(-0.0378, dtype=torch.float64)
8 gae_duplicate tensor(-0.4280, dtype=torch.float64) tensor(0.2530, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4059, dtype=torch.float64) delta_t tensor(-0.6386, dtype=torch.float64)
7 gae_duplicate tensor(-1.2690, dtype=torch.float64) tensor(8.0085, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5803, dtype=torch.float64) delta_t tensor(-0.9238, dtype=torch.float64)
6 gae_duplicate tensor(-1.2548, dtype=torch.float64) tensor(12.2940, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2822, dtype=torch.float64) delta_t tensor(-1.6757, dtype=torch.float64)
5 gae_duplicate tensor(-2.5389, dtype=torch.float64) tensor(21.6152, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9252, dtype=torch.float64) delta_t tensor(-1.2537, dtype=torch.float64)
4 gae_duplicate tensor(-4.3009, dtype=torch.float64) tensor(21.5332, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0013, dtype=torch.float64) delta_t tensor(-1.3067, dtype=torch.float64)
3 gae_duplicate tensor(-2.0826, dtype=torch.float64) tensor(15.5900, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7465, dtype=torch.float64) delta_t tensor(-1.0618, dtype=torch.float64)
2 gae_duplicate tensor(-2.3159, dtype=torch.float64) tensor(15.3719, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-483.8677673339844
value loss:185.67495727539062
entropies:218.57374572753906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.538662910461426 seconds
19 rew tensor(0.8650, dtype=torch.float64) delta_t tensor(0.6775, dtype=torch.float64)
19 gae_duplicate tensor(0.4623, dtype=torch.float64) tensor(-8.3708, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8704, dtype=torch.float64) delta_t tensor(0.7003, dtype=torch.float64)
18 gae_duplicate tensor(0.4946, dtype=torch.float64) tensor(-8.8115, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8838, dtype=torch.float64) delta_t tensor(0.7131, dtype=torch.float64)
17 gae_duplicate tensor(0.5004, dtype=torch.float64) tensor(-9.1865, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8756, dtype=torch.float64) delta_t tensor(0.6653, dtype=torch.float64)
16 gae_duplicate tensor(0.5587, dtype=torch.float64) tensor(-9.7572, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8750, dtype=torch.float64) delta_t tensor(0.5726, dtype=torch.float64)
15 gae_duplicate tensor(0.3670, dtype=torch.float64) tensor(-7.7069, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7912, dtype=torch.float64) delta_t tensor(0.5332, dtype=torch.float64)
14 gae_duplicate tensor(0.1560, dtype=torch.float64) tensor(-6.4058, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8435, dtype=torch.float64) delta_t tensor(0.5912, dtype=torch.float64)
13 gae_duplicate tensor(0.1330, dtype=torch.float64) tensor(-9.0132, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8008, dtype=torch.float64) delta_t tensor(0.5024, dtype=torch.float64)
12 gae_duplicate tensor(-0.1402, dtype=torch.float64) tensor(-6.0892, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6582, dtype=torch.float64) delta_t tensor(0.4033, dtype=torch.float64)
11 gae_duplicate tensor(-0.3701, dtype=torch.float64) tensor(-5.7041, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5113, dtype=torch.float64) delta_t tensor(0.2362, dtype=torch.float64)
10 gae_duplicate tensor(-0.6205, dtype=torch.float64) tensor(-3.7319, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0928, dtype=torch.float64) delta_t tensor(-0.2967, dtype=torch.float64)
9 gae_duplicate tensor(-1.2936, dtype=torch.float64) tensor(2.8603, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3809, dtype=torch.float64) delta_t tensor(-0.5572, dtype=torch.float64)
8 gae_duplicate tensor(-1.0609, dtype=torch.float64) tensor(7.4709, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4218, dtype=torch.float64) delta_t tensor(-0.6922, dtype=torch.float64)
7 gae_duplicate tensor(-1.2245, dtype=torch.float64) tensor(7.9864, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9003, dtype=torch.float64) delta_t tensor(-1.1897, dtype=torch.float64)
6 gae_duplicate tensor(-2.8515, dtype=torch.float64) tensor(15.8152, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6374, dtype=torch.float64) delta_t tensor(-1.8745, dtype=torch.float64)
5 gae_duplicate tensor(-3.7442, dtype=torch.float64) tensor(21.3417, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2471, dtype=torch.float64) delta_t tensor(-1.6125, dtype=torch.float64)
4 gae_duplicate tensor(-5.5869, dtype=torch.float64) tensor(19.3187, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8681, dtype=torch.float64) delta_t tensor(-1.2452, dtype=torch.float64)
3 gae_duplicate tensor(-2.2505, dtype=torch.float64) tensor(17.8994, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7334, dtype=torch.float64) delta_t tensor(-0.9872, dtype=torch.float64)
2 gae_duplicate tensor(-2.3487, dtype=torch.float64) tensor(15.0435, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1225.7227783203125
value loss:227.68450927734375
entropies:217.78111267089844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.815613031387329 seconds
19 rew tensor(0.4370, dtype=torch.float64) delta_t tensor(0.1665, dtype=torch.float64)
19 gae_duplicate tensor(-1.5178, dtype=torch.float64) tensor(-1.6167, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7136, dtype=torch.float64) delta_t tensor(0.5042, dtype=torch.float64)
18 gae_duplicate tensor(0.1569, dtype=torch.float64) tensor(-6.1956, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6087, dtype=torch.float64) delta_t tensor(0.3576, dtype=torch.float64)
17 gae_duplicate tensor(-0.6725, dtype=torch.float64) tensor(-5.2901, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7269, dtype=torch.float64) delta_t tensor(0.5077, dtype=torch.float64)
16 gae_duplicate tensor(0.0599, dtype=torch.float64) tensor(-6.5154, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5805, dtype=torch.float64) delta_t tensor(0.2921, dtype=torch.float64)
15 gae_duplicate tensor(-0.8034, dtype=torch.float64) tensor(-4.5062, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7479, dtype=torch.float64) delta_t tensor(0.5134, dtype=torch.float64)
14 gae_duplicate tensor(0.4368, dtype=torch.float64) tensor(-6.7695, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6572, dtype=torch.float64) delta_t tensor(0.3951, dtype=torch.float64)
13 gae_duplicate tensor(0.2182, dtype=torch.float64) tensor(-5.8155, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7256, dtype=torch.float64) delta_t tensor(0.4740, dtype=torch.float64)
12 gae_duplicate tensor(0.0308, dtype=torch.float64) tensor(-6.1925, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7351, dtype=torch.float64) delta_t tensor(0.4998, dtype=torch.float64)
11 gae_duplicate tensor(-0.0573, dtype=torch.float64) tensor(-6.9306, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0193, dtype=torch.float64) delta_t tensor(-0.2008, dtype=torch.float64)
10 gae_duplicate tensor(-2.1928, dtype=torch.float64) tensor(1.3838, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2973, dtype=torch.float64) delta_t tensor(-0.5084, dtype=torch.float64)
9 gae_duplicate tensor(-1.4874, dtype=torch.float64) tensor(5.5479, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3635, dtype=torch.float64) delta_t tensor(-0.5485, dtype=torch.float64)
8 gae_duplicate tensor(-1.5547, dtype=torch.float64) tensor(6.9606, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8638, dtype=torch.float64) delta_t tensor(-1.1755, dtype=torch.float64)
7 gae_duplicate tensor(-1.9614, dtype=torch.float64) tensor(15.3757, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4300, dtype=torch.float64) delta_t tensor(-1.6817, dtype=torch.float64)
6 gae_duplicate tensor(-2.8461, dtype=torch.float64) tensor(23.0371, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9259, dtype=torch.float64) delta_t tensor(-2.2628, dtype=torch.float64)
5 gae_duplicate tensor(-3.3959, dtype=torch.float64) tensor(29.4814, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9104, dtype=torch.float64) delta_t tensor(-3.2689, dtype=torch.float64)
4 gae_duplicate tensor(-6.3841, dtype=torch.float64) tensor(41.2812, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7765, dtype=torch.float64) delta_t tensor(-1.0710, dtype=torch.float64)
3 gae_duplicate tensor(-2.5541, dtype=torch.float64) tensor(16.3262, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4381, dtype=torch.float64) delta_t tensor(-0.6277, dtype=torch.float64)
2 gae_duplicate tensor(-1.1868, dtype=torch.float64) tensor(8.3459, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3563.993408203125
value loss:339.10687255859375
entropies:218.42352294921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.980815172195435 seconds
19 rew tensor(0.7272, dtype=torch.float64) delta_t tensor(0.4393, dtype=torch.float64)
19 gae_duplicate tensor(0.2303, dtype=torch.float64) tensor(-5.1252, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6710, dtype=torch.float64) delta_t tensor(0.4559, dtype=torch.float64)
18 gae_duplicate tensor(0.1906, dtype=torch.float64) tensor(-6.0114, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5681, dtype=torch.float64) delta_t tensor(0.3220, dtype=torch.float64)
17 gae_duplicate tensor(-0.5257, dtype=torch.float64) tensor(-4.4475, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6655, dtype=torch.float64) delta_t tensor(0.5000, dtype=torch.float64)
16 gae_duplicate tensor(0.2264, dtype=torch.float64) tensor(-6.7827, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5518, dtype=torch.float64) delta_t tensor(0.3223, dtype=torch.float64)
15 gae_duplicate tensor(-0.5106, dtype=torch.float64) tensor(-4.4425, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5841, dtype=torch.float64) delta_t tensor(0.3166, dtype=torch.float64)
14 gae_duplicate tensor(-0.2152, dtype=torch.float64) tensor(-3.7896, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7818, dtype=torch.float64) delta_t tensor(0.4596, dtype=torch.float64)
13 gae_duplicate tensor(0.2425, dtype=torch.float64) tensor(-6.2355, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8057, dtype=torch.float64) delta_t tensor(0.5365, dtype=torch.float64)
12 gae_duplicate tensor(0.4898, dtype=torch.float64) tensor(-7.5294, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(0.5359, dtype=torch.float64)
11 gae_duplicate tensor(0.4958, dtype=torch.float64) tensor(-7.4955, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6437, dtype=torch.float64) delta_t tensor(0.3770, dtype=torch.float64)
10 gae_duplicate tensor(-0.0512, dtype=torch.float64) tensor(-5.5655, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4835, dtype=torch.float64) delta_t tensor(-0.7169, dtype=torch.float64)
9 gae_duplicate tensor(-1.7767, dtype=torch.float64) tensor(8.4082, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5653, dtype=torch.float64) delta_t tensor(-0.7530, dtype=torch.float64)
8 gae_duplicate tensor(-2.1308, dtype=torch.float64) tensor(9.2127, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1813, dtype=torch.float64) delta_t tensor(-0.3343, dtype=torch.float64)
7 gae_duplicate tensor(-0.9014, dtype=torch.float64) tensor(5.4577, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3161, dtype=torch.float64) delta_t tensor(-1.6773, dtype=torch.float64)
6 gae_duplicate tensor(-2.7349, dtype=torch.float64) tensor(21.7594, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3005, dtype=torch.float64) delta_t tensor(-1.6853, dtype=torch.float64)
5 gae_duplicate tensor(-2.6271, dtype=torch.float64) tensor(21.6122, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9467, dtype=torch.float64) delta_t tensor(-4.2652, dtype=torch.float64)
4 gae_duplicate tensor(-7.7614, dtype=torch.float64) tensor(52.8623, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4816, dtype=torch.float64) delta_t tensor(-0.7195, dtype=torch.float64)
3 gae_duplicate tensor(-1.9326, dtype=torch.float64) tensor(14.2699, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4362, dtype=torch.float64) delta_t tensor(-0.6726, dtype=torch.float64)
2 gae_duplicate tensor(-1.7021, dtype=torch.float64) tensor(9.7962, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3133.92041015625
value loss:384.18756103515625
entropies:219.89450073242188
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2501.7085)
ToM Target loss= tensor(1799.7305)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.276579856872559 seconds
19 rew tensor(0.7022, dtype=torch.float64) delta_t tensor(0.4839, dtype=torch.float64)
19 gae_duplicate tensor(0.1249, dtype=torch.float64) tensor(-6.0897, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6368, dtype=torch.float64) delta_t tensor(0.3860, dtype=torch.float64)
18 gae_duplicate tensor(-0.5623, dtype=torch.float64) tensor(-5.1201, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7930, dtype=torch.float64) delta_t tensor(0.5939, dtype=torch.float64)
17 gae_duplicate tensor(0.3069, dtype=torch.float64) tensor(-8.1348, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7862, dtype=torch.float64) delta_t tensor(0.5941, dtype=torch.float64)
16 gae_duplicate tensor(0.3983, dtype=torch.float64) tensor(-8.3014, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7735, dtype=torch.float64) delta_t tensor(0.5464, dtype=torch.float64)
15 gae_duplicate tensor(0.3751, dtype=torch.float64) tensor(-7.6927, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7483, dtype=torch.float64) delta_t tensor(0.5089, dtype=torch.float64)
14 gae_duplicate tensor(0.3369, dtype=torch.float64) tensor(-7.0169, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6713, dtype=torch.float64) delta_t tensor(0.3807, dtype=torch.float64)
13 gae_duplicate tensor(0.2352, dtype=torch.float64) tensor(-5.3618, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5483, dtype=torch.float64) delta_t tensor(0.2753, dtype=torch.float64)
12 gae_duplicate tensor(0.0904, dtype=torch.float64) tensor(-3.9868, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3321, dtype=torch.float64) delta_t tensor(0.0201, dtype=torch.float64)
11 gae_duplicate tensor(-0.9130, dtype=torch.float64) tensor(-0.6594, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3927, dtype=torch.float64) delta_t tensor(0.1698, dtype=torch.float64)
10 gae_duplicate tensor(-0.0183, dtype=torch.float64) tensor(-2.1729, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1098, dtype=torch.float64) delta_t tensor(-0.3483, dtype=torch.float64)
9 gae_duplicate tensor(-1.7664, dtype=torch.float64) tensor(4.0808, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3871, dtype=torch.float64) delta_t tensor(-0.6552, dtype=torch.float64)
8 gae_duplicate tensor(-1.2449, dtype=torch.float64) tensor(8.1400, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6712, dtype=torch.float64) delta_t tensor(-0.9338, dtype=torch.float64)
7 gae_duplicate tensor(-1.7628, dtype=torch.float64) tensor(12.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0628, dtype=torch.float64) delta_t tensor(-1.3857, dtype=torch.float64)
6 gae_duplicate tensor(-3.4352, dtype=torch.float64) tensor(21.6988, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1488, dtype=torch.float64) delta_t tensor(-1.4456, dtype=torch.float64)
5 gae_duplicate tensor(-3.3116, dtype=torch.float64) tensor(17.2374, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6027, dtype=torch.float64) delta_t tensor(-1.9210, dtype=torch.float64)
4 gae_duplicate tensor(-5.1959, dtype=torch.float64) tensor(25.5723, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7596, dtype=torch.float64) delta_t tensor(-0.9721, dtype=torch.float64)
3 gae_duplicate tensor(-2.1856, dtype=torch.float64) tensor(13.8467, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1372, dtype=torch.float64) delta_t tensor(-0.3401, dtype=torch.float64)
2 gae_duplicate tensor(-1.3873, dtype=torch.float64) tensor(6.2166, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1997.560302734375
value loss:205.81771850585938
entropies:220.9177703857422
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.823700904846191 seconds
19 rew tensor(0.7833, dtype=torch.float64) delta_t tensor(0.5691, dtype=torch.float64)
19 gae_duplicate tensor(0.4262, dtype=torch.float64) tensor(-7.1653, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7879, dtype=torch.float64) delta_t tensor(0.6519, dtype=torch.float64)
18 gae_duplicate tensor(0.6023, dtype=torch.float64) tensor(-8.5587, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7926, dtype=torch.float64) delta_t tensor(0.5723, dtype=torch.float64)
17 gae_duplicate tensor(0.4931, dtype=torch.float64) tensor(-8.2993, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7974, dtype=torch.float64) delta_t tensor(0.6162, dtype=torch.float64)
16 gae_duplicate tensor(0.5493, dtype=torch.float64) tensor(-8.6004, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8023, dtype=torch.float64) delta_t tensor(0.6240, dtype=torch.float64)
15 gae_duplicate tensor(0.6075, dtype=torch.float64) tensor(-8.5229, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8072, dtype=torch.float64) delta_t tensor(0.5923, dtype=torch.float64)
14 gae_duplicate tensor(0.5794, dtype=torch.float64) tensor(-8.2583, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7883, dtype=torch.float64) delta_t tensor(0.5813, dtype=torch.float64)
13 gae_duplicate tensor(0.4401, dtype=torch.float64) tensor(-8.1193, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7335, dtype=torch.float64) delta_t tensor(0.5674, dtype=torch.float64)
12 gae_duplicate tensor(0.3815, dtype=torch.float64) tensor(-7.9367, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7363, dtype=torch.float64) delta_t tensor(0.5150, dtype=torch.float64)
11 gae_duplicate tensor(0.2447, dtype=torch.float64) tensor(-7.4787, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5689, dtype=torch.float64) delta_t tensor(0.2833, dtype=torch.float64)
10 gae_duplicate tensor(-0.0764, dtype=torch.float64) tensor(-4.3076, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1082, dtype=torch.float64) delta_t tensor(-0.3855, dtype=torch.float64)
9 gae_duplicate tensor(-2.2875, dtype=torch.float64) tensor(3.8592, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5312, dtype=torch.float64) delta_t tensor(-0.7803, dtype=torch.float64)
8 gae_duplicate tensor(-2.8022, dtype=torch.float64) tensor(9.7262, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2202, dtype=torch.float64) delta_t tensor(-0.5392, dtype=torch.float64)
7 gae_duplicate tensor(-1.5103, dtype=torch.float64) tensor(8.1666, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7210, dtype=torch.float64) delta_t tensor(-1.0413, dtype=torch.float64)
6 gae_duplicate tensor(-2.3071, dtype=torch.float64) tensor(12.1855, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3844, dtype=torch.float64) delta_t tensor(-1.7512, dtype=torch.float64)
5 gae_duplicate tensor(-3.0873, dtype=torch.float64) tensor(22.1480, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0760, dtype=torch.float64) delta_t tensor(-0.2591, dtype=torch.float64)
4 gae_duplicate tensor(-1.4218, dtype=torch.float64) tensor(4.9976, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8074, dtype=torch.float64) delta_t tensor(-1.1285, dtype=torch.float64)
3 gae_duplicate tensor(-2.3710, dtype=torch.float64) tensor(15.7287, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8138, dtype=torch.float64) delta_t tensor(-1.1362, dtype=torch.float64)
2 gae_duplicate tensor(-2.2913, dtype=torch.float64) tensor(15.7240, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-590.3831176757812
value loss:153.31900024414062
entropies:222.17286682128906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.978591680526733 seconds
19 rew tensor(0.7745, dtype=torch.float64) delta_t tensor(0.5407, dtype=torch.float64)
19 gae_duplicate tensor(0.4132, dtype=torch.float64) tensor(-6.7277, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7784, dtype=torch.float64) delta_t tensor(0.5765, dtype=torch.float64)
18 gae_duplicate tensor(0.4761, dtype=torch.float64) tensor(-7.8457, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7735, dtype=torch.float64) delta_t tensor(0.5872, dtype=torch.float64)
17 gae_duplicate tensor(0.4803, dtype=torch.float64) tensor(-8.0713, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7416, dtype=torch.float64) delta_t tensor(0.6274, dtype=torch.float64)
16 gae_duplicate tensor(0.5337, dtype=torch.float64) tensor(-8.6870, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7007, dtype=torch.float64) delta_t tensor(0.5545, dtype=torch.float64)
15 gae_duplicate tensor(0.2532, dtype=torch.float64) tensor(-7.7865, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5567, dtype=torch.float64) delta_t tensor(0.3505, dtype=torch.float64)
14 gae_duplicate tensor(-0.4502, dtype=torch.float64) tensor(-5.0934, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6841, dtype=torch.float64) delta_t tensor(0.4137, dtype=torch.float64)
13 gae_duplicate tensor(0.0678, dtype=torch.float64) tensor(-5.5312, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4933, dtype=torch.float64) delta_t tensor(0.2726, dtype=torch.float64)
12 gae_duplicate tensor(-0.0436, dtype=torch.float64) tensor(-4.0218, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6196, dtype=torch.float64) delta_t tensor(0.3884, dtype=torch.float64)
11 gae_duplicate tensor(0.0542, dtype=torch.float64) tensor(-5.2354, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1253, dtype=torch.float64) delta_t tensor(-0.1224, dtype=torch.float64)
10 gae_duplicate tensor(-2.7837, dtype=torch.float64) tensor(0.8301, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0378, dtype=torch.float64) delta_t tensor(-0.2033, dtype=torch.float64)
9 gae_duplicate tensor(-1.8329, dtype=torch.float64) tensor(2.8725, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1282, dtype=torch.float64) delta_t tensor(-0.3652, dtype=torch.float64)
8 gae_duplicate tensor(-1.8432, dtype=torch.float64) tensor(4.8760, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0810, dtype=torch.float64) delta_t tensor(-0.2958, dtype=torch.float64)
7 gae_duplicate tensor(-0.7092, dtype=torch.float64) tensor(4.0379, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7473, dtype=torch.float64) delta_t tensor(-1.0544, dtype=torch.float64)
6 gae_duplicate tensor(-2.1158, dtype=torch.float64) tensor(13.9589, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3129, dtype=torch.float64) delta_t tensor(-1.5563, dtype=torch.float64)
5 gae_duplicate tensor(-2.9557, dtype=torch.float64) tensor(21.3573, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3166, dtype=torch.float64) delta_t tensor(-1.6597, dtype=torch.float64)
4 gae_duplicate tensor(-5.8241, dtype=torch.float64) tensor(22.3253, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6818, dtype=torch.float64) delta_t tensor(-0.9631, dtype=torch.float64)
3 gae_duplicate tensor(-1.3294, dtype=torch.float64) tensor(14.1710, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6381, dtype=torch.float64) delta_t tensor(-0.8382, dtype=torch.float64)
2 gae_duplicate tensor(-1.9889, dtype=torch.float64) tensor(10.9815, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1350.9713134765625
value loss:185.25088500976562
entropies:223.2927703857422
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.835490703582764 seconds
19 rew tensor(0.7686, dtype=torch.float64) delta_t tensor(0.5718, dtype=torch.float64)
19 gae_duplicate tensor(0.3255, dtype=torch.float64) tensor(-7.1516, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7655, dtype=torch.float64) delta_t tensor(0.5906, dtype=torch.float64)
18 gae_duplicate tensor(0.3958, dtype=torch.float64) tensor(-8.1062, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7560, dtype=torch.float64) delta_t tensor(0.6133, dtype=torch.float64)
17 gae_duplicate tensor(0.4083, dtype=torch.float64) tensor(-8.4783, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7206, dtype=torch.float64) delta_t tensor(0.6084, dtype=torch.float64)
16 gae_duplicate tensor(0.3828, dtype=torch.float64) tensor(-8.4990, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6723, dtype=torch.float64) delta_t tensor(0.5812, dtype=torch.float64)
15 gae_duplicate tensor(-0.0803, dtype=torch.float64) tensor(-8.0180, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7076, dtype=torch.float64) delta_t tensor(0.5520, dtype=torch.float64)
14 gae_duplicate tensor(-0.0652, dtype=torch.float64) tensor(-7.7056, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7672, dtype=torch.float64) delta_t tensor(0.5770, dtype=torch.float64)
13 gae_duplicate tensor(0.4522, dtype=torch.float64) tensor(-7.9598, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6442, dtype=torch.float64) delta_t tensor(0.4466, dtype=torch.float64)
12 gae_duplicate tensor(0.2506, dtype=torch.float64) tensor(-6.4388, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6635, dtype=torch.float64) delta_t tensor(0.4253, dtype=torch.float64)
11 gae_duplicate tensor(0.1375, dtype=torch.float64) tensor(-5.9787, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5196, dtype=torch.float64) delta_t tensor(0.3105, dtype=torch.float64)
10 gae_duplicate tensor(0.0164, dtype=torch.float64) tensor(-4.4090, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0325, dtype=torch.float64) delta_t tensor(-0.1629, dtype=torch.float64)
9 gae_duplicate tensor(-1.0322, dtype=torch.float64) tensor(1.6490, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1404, dtype=torch.float64) delta_t tensor(-0.3155, dtype=torch.float64)
8 gae_duplicate tensor(-0.6489, dtype=torch.float64) tensor(3.9257, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2114, dtype=torch.float64) delta_t tensor(-0.4042, dtype=torch.float64)
7 gae_duplicate tensor(-0.7014, dtype=torch.float64) tensor(5.4970, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3879, dtype=torch.float64) delta_t tensor(-0.6845, dtype=torch.float64)
6 gae_duplicate tensor(-1.2784, dtype=torch.float64) tensor(8.8063, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9932, dtype=torch.float64) delta_t tensor(-1.2873, dtype=torch.float64)
5 gae_duplicate tensor(-2.3129, dtype=torch.float64) tensor(16.3165, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1514, dtype=torch.float64) delta_t tensor(-2.4898, dtype=torch.float64)
4 gae_duplicate tensor(-7.6434, dtype=torch.float64) tensor(31.4641, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5718, dtype=torch.float64) delta_t tensor(-0.8754, dtype=torch.float64)
3 gae_duplicate tensor(-2.1538, dtype=torch.float64) tensor(14.2387, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6937, dtype=torch.float64) delta_t tensor(-0.8006, dtype=torch.float64)
2 gae_duplicate tensor(-1.8947, dtype=torch.float64) tensor(11.4711, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-782.64208984375
value loss:211.2071990966797
entropies:223.3548583984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.993404150009155 seconds
19 rew tensor(0.7555, dtype=torch.float64) delta_t tensor(0.5387, dtype=torch.float64)
19 gae_duplicate tensor(0.2941, dtype=torch.float64) tensor(-6.7195, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7496, dtype=torch.float64) delta_t tensor(0.6122, dtype=torch.float64)
18 gae_duplicate tensor(0.4749, dtype=torch.float64) tensor(-8.3004, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7258, dtype=torch.float64) delta_t tensor(0.5988, dtype=torch.float64)
17 gae_duplicate tensor(0.3759, dtype=torch.float64) tensor(-8.3257, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6665, dtype=torch.float64) delta_t tensor(0.5505, dtype=torch.float64)
16 gae_duplicate tensor(0.0915, dtype=torch.float64) tensor(-7.7109, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5627, dtype=torch.float64) delta_t tensor(0.3092, dtype=torch.float64)
15 gae_duplicate tensor(-0.8140, dtype=torch.float64) tensor(-4.6357, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7954, dtype=torch.float64) delta_t tensor(0.6184, dtype=torch.float64)
14 gae_duplicate tensor(0.4980, dtype=torch.float64) tensor(-8.1720, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7988, dtype=torch.float64) delta_t tensor(0.6003, dtype=torch.float64)
13 gae_duplicate tensor(0.5732, dtype=torch.float64) tensor(-8.3413, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7795, dtype=torch.float64) delta_t tensor(0.5881, dtype=torch.float64)
12 gae_duplicate tensor(0.5810, dtype=torch.float64) tensor(-8.1716, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3567, dtype=torch.float64) delta_t tensor(0.1654, dtype=torch.float64)
11 gae_duplicate tensor(-1.6002, dtype=torch.float64) tensor(-3.1994, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2831, dtype=torch.float64) delta_t tensor(0.1133, dtype=torch.float64)
10 gae_duplicate tensor(-1.1840, dtype=torch.float64) tensor(-1.8374, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0309, dtype=torch.float64) delta_t tensor(-0.1990, dtype=torch.float64)
9 gae_duplicate tensor(-1.5792, dtype=torch.float64) tensor(2.3399, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5794, dtype=torch.float64) delta_t tensor(-0.6873, dtype=torch.float64)
8 gae_duplicate tensor(-2.9063, dtype=torch.float64) tensor(8.7812, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6436, dtype=torch.float64) delta_t tensor(-0.7936, dtype=torch.float64)
7 gae_duplicate tensor(-2.2104, dtype=torch.float64) tensor(10.6804, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8083, dtype=torch.float64) delta_t tensor(-1.0255, dtype=torch.float64)
6 gae_duplicate tensor(-2.5536, dtype=torch.float64) tensor(13.9235, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0459, dtype=torch.float64) delta_t tensor(-1.2739, dtype=torch.float64)
5 gae_duplicate tensor(-2.6301, dtype=torch.float64) tensor(16.9638, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5340, dtype=torch.float64) delta_t tensor(-0.7904, dtype=torch.float64)
4 gae_duplicate tensor(-2.1942, dtype=torch.float64) tensor(10.5371, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4408, dtype=torch.float64) delta_t tensor(-0.6355, dtype=torch.float64)
3 gae_duplicate tensor(-1.9758, dtype=torch.float64) tensor(8.0799, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7053, dtype=torch.float64) delta_t tensor(-0.8717, dtype=torch.float64)
2 gae_duplicate tensor(-1.8694, dtype=torch.float64) tensor(10.9119, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-645.1829223632812
value loss:148.00701904296875
entropies:223.5904541015625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2496.4182)
ToM Target loss= tensor(1800.6057)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.860594034194946 seconds
19 rew tensor(0.5382, dtype=torch.float64) delta_t tensor(0.3337, dtype=torch.float64)
19 gae_duplicate tensor(-0.7935, dtype=torch.float64) tensor(-4.1654, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7705, dtype=torch.float64) delta_t tensor(0.5665, dtype=torch.float64)
18 gae_duplicate tensor(0.5235, dtype=torch.float64) tensor(-7.4801, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7456, dtype=torch.float64) delta_t tensor(0.5494, dtype=torch.float64)
17 gae_duplicate tensor(0.4841, dtype=torch.float64) tensor(-7.6078, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7138, dtype=torch.float64) delta_t tensor(0.5247, dtype=torch.float64)
16 gae_duplicate tensor(0.2699, dtype=torch.float64) tensor(-7.3205, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6371, dtype=torch.float64) delta_t tensor(0.4441, dtype=torch.float64)
15 gae_duplicate tensor(-0.2583, dtype=torch.float64) tensor(-6.2713, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6593, dtype=torch.float64) delta_t tensor(0.4580, dtype=torch.float64)
14 gae_duplicate tensor(-0.0959, dtype=torch.float64) tensor(-6.3525, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6817, dtype=torch.float64) delta_t tensor(0.5179, dtype=torch.float64)
13 gae_duplicate tensor(0.2703, dtype=torch.float64) tensor(-7.0886, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6912, dtype=torch.float64) delta_t tensor(0.5208, dtype=torch.float64)
12 gae_duplicate tensor(0.2350, dtype=torch.float64) tensor(-7.2122, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7220, dtype=torch.float64) delta_t tensor(0.5464, dtype=torch.float64)
11 gae_duplicate tensor(0.4435, dtype=torch.float64) tensor(-7.5412, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6290, dtype=torch.float64) delta_t tensor(0.4541, dtype=torch.float64)
10 gae_duplicate tensor(0.3551, dtype=torch.float64) tensor(-6.3965, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0363, dtype=torch.float64) delta_t tensor(-0.0714, dtype=torch.float64)
9 gae_duplicate tensor(-1.3132, dtype=torch.float64) tensor(0.2502, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5394, dtype=torch.float64) delta_t tensor(-0.7064, dtype=torch.float64)
8 gae_duplicate tensor(-2.6096, dtype=torch.float64) tensor(8.7856, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4645, dtype=torch.float64) delta_t tensor(-0.6045, dtype=torch.float64)
7 gae_duplicate tensor(-1.9097, dtype=torch.float64) tensor(8.7388, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3744, dtype=torch.float64) delta_t tensor(-1.6155, dtype=torch.float64)
6 gae_duplicate tensor(-4.0475, dtype=torch.float64) tensor(21.0728, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1538, dtype=torch.float64) delta_t tensor(-1.4386, dtype=torch.float64)
5 gae_duplicate tensor(-3.0145, dtype=torch.float64) tensor(19.9817, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1158, dtype=torch.float64) delta_t tensor(-2.3700, dtype=torch.float64)
4 gae_duplicate tensor(-5.1981, dtype=torch.float64) tensor(33.8280, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6802, dtype=torch.float64) delta_t tensor(-0.8501, dtype=torch.float64)
3 gae_duplicate tensor(-2.3131, dtype=torch.float64) tensor(13.3120, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6045, dtype=torch.float64) delta_t tensor(-0.6944, dtype=torch.float64)
2 gae_duplicate tensor(-1.4363, dtype=torch.float64) tensor(9.8363, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1781.624267578125
value loss:231.97048950195312
entropies:224.04454040527344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.321747779846191 seconds
19 rew tensor(0.5730, dtype=torch.float64) delta_t tensor(0.4027, dtype=torch.float64)
19 gae_duplicate tensor(-0.6895, dtype=torch.float64) tensor(-5.0247, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7225, dtype=torch.float64) delta_t tensor(0.5916, dtype=torch.float64)
18 gae_duplicate tensor(0.4239, dtype=torch.float64) tensor(-7.8766, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6633, dtype=torch.float64) delta_t tensor(0.5301, dtype=torch.float64)
17 gae_duplicate tensor(0.3886, dtype=torch.float64) tensor(-7.4073, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5579, dtype=torch.float64) delta_t tensor(0.3990, dtype=torch.float64)
16 gae_duplicate tensor(-0.3465, dtype=torch.float64) tensor(-5.7188, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6774, dtype=torch.float64) delta_t tensor(0.5019, dtype=torch.float64)
15 gae_duplicate tensor(0.0359, dtype=torch.float64) tensor(-6.8278, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5339, dtype=torch.float64) delta_t tensor(0.3836, dtype=torch.float64)
14 gae_duplicate tensor(-0.1262, dtype=torch.float64) tensor(-5.4671, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6112, dtype=torch.float64) delta_t tensor(0.4619, dtype=torch.float64)
13 gae_duplicate tensor(-0.1322, dtype=torch.float64) tensor(-6.2948, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5649, dtype=torch.float64) delta_t tensor(0.3873, dtype=torch.float64)
12 gae_duplicate tensor(-0.1044, dtype=torch.float64) tensor(-5.4714, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4222, dtype=torch.float64) delta_t tensor(0.2293, dtype=torch.float64)
11 gae_duplicate tensor(-0.3450, dtype=torch.float64) tensor(-3.4207, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2948, dtype=torch.float64) delta_t tensor(0.1348, dtype=torch.float64)
10 gae_duplicate tensor(-0.2933, dtype=torch.float64) tensor(-2.0235, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9657, dtype=torch.float64) delta_t tensor(-1.1151, dtype=torch.float64)
9 gae_duplicate tensor(-2.9439, dtype=torch.float64) tensor(13.1544, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1328, dtype=torch.float64) delta_t tensor(-0.3156, dtype=torch.float64)
8 gae_duplicate tensor(-0.7759, dtype=torch.float64) tensor(5.2787, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1092, dtype=torch.float64) delta_t tensor(-0.3201, dtype=torch.float64)
7 gae_duplicate tensor(-0.8228, dtype=torch.float64) tensor(4.3028, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4871, dtype=torch.float64) delta_t tensor(-0.7147, dtype=torch.float64)
6 gae_duplicate tensor(-1.3225, dtype=torch.float64) tensor(9.8478, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4630, dtype=torch.float64) delta_t tensor(-0.6871, dtype=torch.float64)
5 gae_duplicate tensor(-1.9441, dtype=torch.float64) tensor(9.4037, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5811, dtype=torch.float64) delta_t tensor(-0.7779, dtype=torch.float64)
4 gae_duplicate tensor(-1.6258, dtype=torch.float64) tensor(10.9669, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2409, dtype=torch.float64) delta_t tensor(-0.4390, dtype=torch.float64)
3 gae_duplicate tensor(-1.8590, dtype=torch.float64) tensor(6.1376, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5599, dtype=torch.float64) delta_t tensor(-0.7239, dtype=torch.float64)
2 gae_duplicate tensor(-1.2571, dtype=torch.float64) tensor(9.4958, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-510.3124694824219
value loss:102.5125732421875
entropies:224.07864379882812
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.289913892745972 seconds
19 rew tensor(0.7305, dtype=torch.float64) delta_t tensor(0.5696, dtype=torch.float64)
19 gae_duplicate tensor(0.4610, dtype=torch.float64) tensor(-7.1070, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7116, dtype=torch.float64) delta_t tensor(0.5984, dtype=torch.float64)
18 gae_duplicate tensor(0.5080, dtype=torch.float64) tensor(-8.1763, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6859, dtype=torch.float64) delta_t tensor(0.6494, dtype=torch.float64)
17 gae_duplicate tensor(0.4804, dtype=torch.float64) tensor(-8.9281, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6390, dtype=torch.float64) delta_t tensor(0.6203, dtype=torch.float64)
16 gae_duplicate tensor(0.2289, dtype=torch.float64) tensor(-8.6366, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5436, dtype=torch.float64) delta_t tensor(0.4447, dtype=torch.float64)
15 gae_duplicate tensor(-0.5115, dtype=torch.float64) tensor(-6.4076, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6901, dtype=torch.float64) delta_t tensor(0.5642, dtype=torch.float64)
14 gae_duplicate tensor(0.3070, dtype=torch.float64) tensor(-7.6700, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7133, dtype=torch.float64) delta_t tensor(0.5783, dtype=torch.float64)
13 gae_duplicate tensor(0.4106, dtype=torch.float64) tensor(-7.9812, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6655, dtype=torch.float64) delta_t tensor(0.5128, dtype=torch.float64)
12 gae_duplicate tensor(0.4212, dtype=torch.float64) tensor(-7.2010, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6689, dtype=torch.float64) delta_t tensor(0.5269, dtype=torch.float64)
11 gae_duplicate tensor(0.4053, dtype=torch.float64) tensor(-7.3045, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4186, dtype=torch.float64) delta_t tensor(0.3148, dtype=torch.float64)
10 gae_duplicate tensor(-0.2260, dtype=torch.float64) tensor(-4.6599, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4574, dtype=torch.float64) delta_t tensor(-0.5724, dtype=torch.float64)
9 gae_duplicate tensor(-1.9300, dtype=torch.float64) tensor(6.6609, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4399, dtype=torch.float64) delta_t tensor(-0.5611, dtype=torch.float64)
8 gae_duplicate tensor(-2.3462, dtype=torch.float64) tensor(7.6324, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8083, dtype=torch.float64) delta_t tensor(-0.9330, dtype=torch.float64)
7 gae_duplicate tensor(-1.9027, dtype=torch.float64) tensor(12.4140, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9631, dtype=torch.float64) delta_t tensor(-1.1246, dtype=torch.float64)
6 gae_duplicate tensor(-2.1884, dtype=torch.float64) tensor(15.2228, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2732, dtype=torch.float64) delta_t tensor(-1.3852, dtype=torch.float64)
5 gae_duplicate tensor(-2.8668, dtype=torch.float64) tensor(18.8238, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.8762, dtype=torch.float64) delta_t tensor(-4.1218, dtype=torch.float64)
4 gae_duplicate tensor(-11.0111, dtype=torch.float64) tensor(52.7361, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4429, dtype=torch.float64) delta_t tensor(-0.6482, dtype=torch.float64)
3 gae_duplicate tensor(-1.4504, dtype=torch.float64) tensor(13.4863, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2559, dtype=torch.float64) delta_t tensor(-0.4024, dtype=torch.float64)
2 gae_duplicate tensor(-1.2709, dtype=torch.float64) tensor(6.3181, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2172.362060546875
value loss:503.4495849609375
entropies:224.26113891601562
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.429950952529907 seconds
19 rew tensor(0.5117, dtype=torch.float64) delta_t tensor(0.3752, dtype=torch.float64)
19 gae_duplicate tensor(-0.8795, dtype=torch.float64) tensor(-4.6794, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7379, dtype=torch.float64) delta_t tensor(0.6025, dtype=torch.float64)
18 gae_duplicate tensor(0.4046, dtype=torch.float64) tensor(-7.9742, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7399, dtype=torch.float64) delta_t tensor(0.5880, dtype=torch.float64)
17 gae_duplicate tensor(0.5350, dtype=torch.float64) tensor(-8.1351, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7420, dtype=torch.float64) delta_t tensor(0.6448, dtype=torch.float64)
16 gae_duplicate tensor(0.5480, dtype=torch.float64) tensor(-8.8748, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7358, dtype=torch.float64) delta_t tensor(0.5912, dtype=torch.float64)
15 gae_duplicate tensor(0.5014, dtype=torch.float64) tensor(-8.2576, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7213, dtype=torch.float64) delta_t tensor(0.5556, dtype=torch.float64)
14 gae_duplicate tensor(0.5347, dtype=torch.float64) tensor(-7.7514, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7067, dtype=torch.float64) delta_t tensor(0.5806, dtype=torch.float64)
13 gae_duplicate tensor(0.4856, dtype=torch.float64) tensor(-8.0244, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5855, dtype=torch.float64) delta_t tensor(0.5074, dtype=torch.float64)
12 gae_duplicate tensor(0.4078, dtype=torch.float64) tensor(-7.1180, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5191, dtype=torch.float64) delta_t tensor(0.4121, dtype=torch.float64)
11 gae_duplicate tensor(0.2047, dtype=torch.float64) tensor(-5.8480, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4357, dtype=torch.float64) delta_t tensor(0.3394, dtype=torch.float64)
10 gae_duplicate tensor(0.1086, dtype=torch.float64) tensor(-4.8284, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4002, dtype=torch.float64) delta_t tensor(0.2850, dtype=torch.float64)
9 gae_duplicate tensor(0.2012, dtype=torch.float64) tensor(-4.0359, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0630, dtype=torch.float64) delta_t tensor(-0.1253, dtype=torch.float64)
8 gae_duplicate tensor(-0.6022, dtype=torch.float64) tensor(1.1589, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9075, dtype=torch.float64) delta_t tensor(-1.0486, dtype=torch.float64)
7 gae_duplicate tensor(-1.7170, dtype=torch.float64) tensor(13.1286, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0469, dtype=torch.float64) delta_t tensor(-1.2219, dtype=torch.float64)
6 gae_duplicate tensor(-2.1134, dtype=torch.float64) tensor(16.5239, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1203, dtype=torch.float64) delta_t tensor(-1.3315, dtype=torch.float64)
5 gae_duplicate tensor(-2.6841, dtype=torch.float64) tensor(18.1068, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7922, dtype=torch.float64) delta_t tensor(-3.0201, dtype=torch.float64)
4 gae_duplicate tensor(-6.1259, dtype=torch.float64) tensor(40.0629, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2503, dtype=torch.float64) delta_t tensor(-0.4572, dtype=torch.float64)
3 gae_duplicate tensor(-1.0195, dtype=torch.float64) tensor(9.8474, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1887, dtype=torch.float64) delta_t tensor(-0.3895, dtype=torch.float64)
2 gae_duplicate tensor(-0.6985, dtype=torch.float64) tensor(5.8638, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1090.347412109375
value loss:221.19285583496094
entropies:224.4807586669922
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.722663879394531 seconds
19 rew tensor(0.6356, dtype=torch.float64) delta_t tensor(0.5381, dtype=torch.float64)
19 gae_duplicate tensor(0.0744, dtype=torch.float64) tensor(-6.7140, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5527, dtype=torch.float64) delta_t tensor(0.4473, dtype=torch.float64)
18 gae_duplicate tensor(-0.6389, dtype=torch.float64) tensor(-6.2432, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7440, dtype=torch.float64) delta_t tensor(0.6188, dtype=torch.float64)
17 gae_duplicate tensor(0.4494, dtype=torch.float64) tensor(-8.3463, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7385, dtype=torch.float64) delta_t tensor(0.6209, dtype=torch.float64)
16 gae_duplicate tensor(0.5395, dtype=torch.float64) tensor(-8.5731, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7254, dtype=torch.float64) delta_t tensor(0.6130, dtype=torch.float64)
15 gae_duplicate tensor(0.5730, dtype=torch.float64) tensor(-8.5055, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7128, dtype=torch.float64) delta_t tensor(0.6452, dtype=torch.float64)
14 gae_duplicate tensor(0.5354, dtype=torch.float64) tensor(-8.8985, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6856, dtype=torch.float64) delta_t tensor(0.6209, dtype=torch.float64)
13 gae_duplicate tensor(0.4765, dtype=torch.float64) tensor(-8.6507, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6031, dtype=torch.float64) delta_t tensor(0.5476, dtype=torch.float64)
12 gae_duplicate tensor(0.3313, dtype=torch.float64) tensor(-7.7066, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6441, dtype=torch.float64) delta_t tensor(0.5914, dtype=torch.float64)
11 gae_duplicate tensor(0.3407, dtype=torch.float64) tensor(-8.1389, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5402, dtype=torch.float64) delta_t tensor(0.4855, dtype=torch.float64)
10 gae_duplicate tensor(0.2487, dtype=torch.float64) tensor(-6.8765, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1142, dtype=torch.float64) delta_t tensor(-0.1967, dtype=torch.float64)
9 gae_duplicate tensor(-1.9498, dtype=torch.float64) tensor(1.7613, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0587, dtype=torch.float64) delta_t tensor(-0.1600, dtype=torch.float64)
8 gae_duplicate tensor(-0.6137, dtype=torch.float64) tensor(2.1659, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2390, dtype=torch.float64) delta_t tensor(-0.3398, dtype=torch.float64)
7 gae_duplicate tensor(-1.3364, dtype=torch.float64) tensor(4.4540, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8177, dtype=torch.float64) delta_t tensor(-0.9716, dtype=torch.float64)
6 gae_duplicate tensor(-1.6890, dtype=torch.float64) tensor(12.5609, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3089, dtype=torch.float64) delta_t tensor(-1.5473, dtype=torch.float64)
5 gae_duplicate tensor(-2.4236, dtype=torch.float64) tensor(20.5600, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5991, dtype=torch.float64) delta_t tensor(-0.7870, dtype=torch.float64)
4 gae_duplicate tensor(-3.6406, dtype=torch.float64) tensor(11.8592, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6313, dtype=torch.float64) delta_t tensor(-0.7534, dtype=torch.float64)
3 gae_duplicate tensor(-1.1529, dtype=torch.float64) tensor(10.6391, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4704, dtype=torch.float64) delta_t tensor(-0.5383, dtype=torch.float64)
2 gae_duplicate tensor(-0.8584, dtype=torch.float64) tensor(7.6979, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:209.954345703125
value loss:127.7869873046875
entropies:224.56224060058594
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2494.5759)
ToM Target loss= tensor(1800.4430)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.715242147445679 seconds
19 rew tensor(0.7261, dtype=torch.float64) delta_t tensor(0.6313, dtype=torch.float64)
19 gae_duplicate tensor(0.5157, dtype=torch.float64) tensor(-7.8641, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7202, dtype=torch.float64) delta_t tensor(0.6293, dtype=torch.float64)
18 gae_duplicate tensor(0.5915, dtype=torch.float64) tensor(-8.6315, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6921, dtype=torch.float64) delta_t tensor(0.6150, dtype=torch.float64)
17 gae_duplicate tensor(0.4824, dtype=torch.float64) tensor(-8.5359, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6056, dtype=torch.float64) delta_t tensor(0.5520, dtype=torch.float64)
16 gae_duplicate tensor(0.1473, dtype=torch.float64) tensor(-7.7358, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4812, dtype=torch.float64) delta_t tensor(0.3998, dtype=torch.float64)
15 gae_duplicate tensor(-0.6032, dtype=torch.float64) tensor(-5.7624, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6021, dtype=torch.float64) delta_t tensor(0.5191, dtype=torch.float64)
14 gae_duplicate tensor(-0.0472, dtype=torch.float64) tensor(-7.0463, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6089, dtype=torch.float64) delta_t tensor(0.4837, dtype=torch.float64)
13 gae_duplicate tensor(0.2642, dtype=torch.float64) tensor(-6.7355, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6667, dtype=torch.float64) delta_t tensor(0.5505, dtype=torch.float64)
12 gae_duplicate tensor(0.2892, dtype=torch.float64) tensor(-7.5488, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6507, dtype=torch.float64) delta_t tensor(0.5288, dtype=torch.float64)
11 gae_duplicate tensor(0.2754, dtype=torch.float64) tensor(-7.3423, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2784, dtype=torch.float64) delta_t tensor(0.2249, dtype=torch.float64)
10 gae_duplicate tensor(-0.8599, dtype=torch.float64) tensor(-3.5279, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1932, dtype=torch.float64) delta_t tensor(-0.2488, dtype=torch.float64)
9 gae_duplicate tensor(-1.1536, dtype=torch.float64) tensor(2.7486, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2268, dtype=torch.float64) delta_t tensor(-0.2843, dtype=torch.float64)
8 gae_duplicate tensor(-1.3735, dtype=torch.float64) tensor(3.8302, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1924, dtype=torch.float64) delta_t tensor(-0.2731, dtype=torch.float64)
7 gae_duplicate tensor(-0.6725, dtype=torch.float64) tensor(3.7797, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8673, dtype=torch.float64) delta_t tensor(-1.0383, dtype=torch.float64)
6 gae_duplicate tensor(-1.9679, dtype=torch.float64) tensor(13.3448, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2331, dtype=torch.float64) delta_t tensor(-1.4125, dtype=torch.float64)
5 gae_duplicate tensor(-1.9478, dtype=torch.float64) tensor(18.9474, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8971, dtype=torch.float64) delta_t tensor(-2.0809, dtype=torch.float64)
4 gae_duplicate tensor(-4.2934, dtype=torch.float64) tensor(27.8357, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5846, dtype=torch.float64) delta_t tensor(-0.6558, dtype=torch.float64)
3 gae_duplicate tensor(-1.4009, dtype=torch.float64) tensor(10.7944, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6424, dtype=torch.float64) delta_t tensor(-0.6963, dtype=torch.float64)
2 gae_duplicate tensor(-1.3773, dtype=torch.float64) tensor(9.8088, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-773.34912109375
value loss:164.0103302001953
entropies:224.5538787841797
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.935467004776001 seconds
19 rew tensor(0.6575, dtype=torch.float64) delta_t tensor(0.5994, dtype=torch.float64)
19 gae_duplicate tensor(0.1180, dtype=torch.float64) tensor(-7.4760, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5665, dtype=torch.float64) delta_t tensor(0.4863, dtype=torch.float64)
18 gae_duplicate tensor(-0.5606, dtype=torch.float64) tensor(-6.8183, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7526, dtype=torch.float64) delta_t tensor(0.6634, dtype=torch.float64)
17 gae_duplicate tensor(0.4936, dtype=torch.float64) tensor(-8.9639, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7544, dtype=torch.float64) delta_t tensor(0.6634, dtype=torch.float64)
16 gae_duplicate tensor(0.6007, dtype=torch.float64) tensor(-9.1795, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7561, dtype=torch.float64) delta_t tensor(0.6392, dtype=torch.float64)
15 gae_duplicate tensor(0.6131, dtype=torch.float64) tensor(-8.8870, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7579, dtype=torch.float64) delta_t tensor(0.6681, dtype=torch.float64)
14 gae_duplicate tensor(0.6289, dtype=torch.float64) tensor(-9.2209, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6292, dtype=torch.float64) delta_t tensor(0.5372, dtype=torch.float64)
13 gae_duplicate tensor(0.2600, dtype=torch.float64) tensor(-7.6345, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5264, dtype=torch.float64) delta_t tensor(0.4217, dtype=torch.float64)
12 gae_duplicate tensor(0.1904, dtype=torch.float64) tensor(-6.0160, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4404, dtype=torch.float64) delta_t tensor(0.3459, dtype=torch.float64)
11 gae_duplicate tensor(-0.0492, dtype=torch.float64) tensor(-4.9200, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3536, dtype=torch.float64) delta_t tensor(0.2368, dtype=torch.float64)
10 gae_duplicate tensor(-0.0293, dtype=torch.float64) tensor(-3.4377, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5068, dtype=torch.float64) delta_t tensor(-0.5804, dtype=torch.float64)
9 gae_duplicate tensor(-3.0774, dtype=torch.float64) tensor(6.8873, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2907, dtype=torch.float64) delta_t tensor(-0.3504, dtype=torch.float64)
8 gae_duplicate tensor(-1.7561, dtype=torch.float64) tensor(5.0591, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1268, dtype=torch.float64) delta_t tensor(-0.2219, dtype=torch.float64)
7 gae_duplicate tensor(-1.1951, dtype=torch.float64) tensor(3.2835, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0191, dtype=torch.float64) delta_t tensor(-0.1566, dtype=torch.float64)
6 gae_duplicate tensor(-1.0302, dtype=torch.float64) tensor(2.2806, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4857, dtype=torch.float64) delta_t tensor(-1.5932, dtype=torch.float64)
5 gae_duplicate tensor(-3.3334, dtype=torch.float64) tensor(20.1281, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8276, dtype=torch.float64) delta_t tensor(-0.9339, dtype=torch.float64)
4 gae_duplicate tensor(-4.6239, dtype=torch.float64) tensor(12.8772, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6959, dtype=torch.float64) delta_t tensor(-0.7334, dtype=torch.float64)
3 gae_duplicate tensor(-1.5171, dtype=torch.float64) tensor(10.5518, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6029, dtype=torch.float64) delta_t tensor(-0.5777, dtype=torch.float64)
2 gae_duplicate tensor(-1.1613, dtype=torch.float64) tensor(8.3423, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:72.76303100585938
value loss:147.89463806152344
entropies:224.53871154785156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.374711036682129 seconds
19 rew tensor(0.4919, dtype=torch.float64) delta_t tensor(0.3535, dtype=torch.float64)
19 gae_duplicate tensor(-0.6664, dtype=torch.float64) tensor(-4.4154, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6354, dtype=torch.float64) delta_t tensor(0.5591, dtype=torch.float64)
18 gae_duplicate tensor(0.1553, dtype=torch.float64) tensor(-7.4145, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5358, dtype=torch.float64) delta_t tensor(0.4439, dtype=torch.float64)
17 gae_duplicate tensor(-0.5876, dtype=torch.float64) tensor(-6.2881, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7019, dtype=torch.float64) delta_t tensor(0.6416, dtype=torch.float64)
16 gae_duplicate tensor(0.4868, dtype=torch.float64) tensor(-8.6492, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6724, dtype=torch.float64) delta_t tensor(0.5840, dtype=torch.float64)
15 gae_duplicate tensor(0.3831, dtype=torch.float64) tensor(-8.1551, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5915, dtype=torch.float64) delta_t tensor(0.5251, dtype=torch.float64)
14 gae_duplicate tensor(0.1052, dtype=torch.float64) tensor(-7.3604, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6518, dtype=torch.float64) delta_t tensor(0.5923, dtype=torch.float64)
13 gae_duplicate tensor(0.5152, dtype=torch.float64) tensor(-8.1164, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6201, dtype=torch.float64) delta_t tensor(0.5502, dtype=torch.float64)
12 gae_duplicate tensor(0.3730, dtype=torch.float64) tensor(-7.6833, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6304, dtype=torch.float64) delta_t tensor(0.5632, dtype=torch.float64)
11 gae_duplicate tensor(0.3469, dtype=torch.float64) tensor(-7.7875, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0014, dtype=torch.float64) delta_t tensor(-0.0610, dtype=torch.float64)
10 gae_duplicate tensor(-2.8841, dtype=torch.float64) tensor(-0.0139, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0872, dtype=torch.float64) delta_t tensor(-1.1387, dtype=torch.float64)
9 gae_duplicate tensor(-4.7407, dtype=torch.float64) tensor(14.1936, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0268, dtype=torch.float64) delta_t tensor(0.0078, dtype=torch.float64)
8 gae_duplicate tensor(-1.7056, dtype=torch.float64) tensor(1.3147, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0942, dtype=torch.float64) delta_t tensor(0.0559, dtype=torch.float64)
7 gae_duplicate tensor(-0.3573, dtype=torch.float64) tensor(-0.5642, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8263, dtype=torch.float64) delta_t tensor(-0.9289, dtype=torch.float64)
6 gae_duplicate tensor(-1.8448, dtype=torch.float64) tensor(11.5324, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9323, dtype=torch.float64) delta_t tensor(-1.0185, dtype=torch.float64)
5 gae_duplicate tensor(-1.6976, dtype=torch.float64) tensor(13.8561, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8538, dtype=torch.float64) delta_t tensor(-1.9166, dtype=torch.float64)
4 gae_duplicate tensor(-8.6537, dtype=torch.float64) tensor(25.2494, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4156, dtype=torch.float64) delta_t tensor(-0.5012, dtype=torch.float64)
3 gae_duplicate tensor(-1.2502, dtype=torch.float64) tensor(8.5270, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8671, dtype=torch.float64) delta_t tensor(-0.7977, dtype=torch.float64)
2 gae_duplicate tensor(-1.2574, dtype=torch.float64) tensor(10.7139, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-722.220947265625
value loss:255.8828887939453
entropies:224.50656127929688
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.994307041168213 seconds
19 rew tensor(0.7456, dtype=torch.float64) delta_t tensor(0.6392, dtype=torch.float64)
19 gae_duplicate tensor(0.5562, dtype=torch.float64) tensor(-7.9846, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7308, dtype=torch.float64) delta_t tensor(0.6345, dtype=torch.float64)
18 gae_duplicate tensor(0.5872, dtype=torch.float64) tensor(-8.6955, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7234, dtype=torch.float64) delta_t tensor(0.6564, dtype=torch.float64)
17 gae_duplicate tensor(0.5968, dtype=torch.float64) tensor(-9.0572, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6997, dtype=torch.float64) delta_t tensor(0.6450, dtype=torch.float64)
16 gae_duplicate tensor(0.6551, dtype=torch.float64) tensor(-8.9457, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6383, dtype=torch.float64) delta_t tensor(0.5960, dtype=torch.float64)
15 gae_duplicate tensor(0.5149, dtype=torch.float64) tensor(-8.3309, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5136, dtype=torch.float64) delta_t tensor(0.4259, dtype=torch.float64)
14 gae_duplicate tensor(0.1117, dtype=torch.float64) tensor(-6.1405, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5109, dtype=torch.float64) delta_t tensor(0.4512, dtype=torch.float64)
13 gae_duplicate tensor(0.3120, dtype=torch.float64) tensor(-6.2439, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5895, dtype=torch.float64) delta_t tensor(0.5031, dtype=torch.float64)
12 gae_duplicate tensor(0.0892, dtype=torch.float64) tensor(-6.9136, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5549, dtype=torch.float64) delta_t tensor(0.4630, dtype=torch.float64)
11 gae_duplicate tensor(-0.3649, dtype=torch.float64) tensor(-6.4717, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4462, dtype=torch.float64) delta_t tensor(0.3765, dtype=torch.float64)
10 gae_duplicate tensor(-0.4001, dtype=torch.float64) tensor(-5.3443, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1924, dtype=torch.float64) delta_t tensor(-0.2526, dtype=torch.float64)
9 gae_duplicate tensor(-1.5136, dtype=torch.float64) tensor(2.6040, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3940, dtype=torch.float64) delta_t tensor(-0.3807, dtype=torch.float64)
8 gae_duplicate tensor(-2.3713, dtype=torch.float64) tensor(5.0247, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2901, dtype=torch.float64) delta_t tensor(-0.3516, dtype=torch.float64)
7 gae_duplicate tensor(-1.9271, dtype=torch.float64) tensor(4.8868, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1200, dtype=torch.float64) delta_t tensor(-1.1844, dtype=torch.float64)
6 gae_duplicate tensor(-2.4365, dtype=torch.float64) tensor(15.2884, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1469, dtype=torch.float64) delta_t tensor(-1.1813, dtype=torch.float64)
5 gae_duplicate tensor(-2.6374, dtype=torch.float64) tensor(16.2314, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1994, dtype=torch.float64) delta_t tensor(-1.2998, dtype=torch.float64)
4 gae_duplicate tensor(-6.4013, dtype=torch.float64) tensor(17.8456, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4746, dtype=torch.float64) delta_t tensor(-0.4640, dtype=torch.float64)
3 gae_duplicate tensor(-0.8832, dtype=torch.float64) tensor(7.5213, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5047, dtype=torch.float64) delta_t tensor(-0.5685, dtype=torch.float64)
2 gae_duplicate tensor(-1.1347, dtype=torch.float64) tensor(7.8150, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-151.6135711669922
value loss:173.95474243164062
entropies:224.42588806152344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.2504472732543945 seconds
19 rew tensor(0.7479, dtype=torch.float64) delta_t tensor(0.6600, dtype=torch.float64)
19 gae_duplicate tensor(0.5773, dtype=torch.float64) tensor(-8.2446, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7417, dtype=torch.float64) delta_t tensor(0.6661, dtype=torch.float64)
18 gae_duplicate tensor(0.6422, dtype=torch.float64) tensor(-9.1408, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7356, dtype=torch.float64) delta_t tensor(0.6770, dtype=torch.float64)
17 gae_duplicate tensor(0.6507, dtype=torch.float64) tensor(-9.3517, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7143, dtype=torch.float64) delta_t tensor(0.6596, dtype=torch.float64)
16 gae_duplicate tensor(0.6541, dtype=torch.float64) tensor(-9.1736, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6845, dtype=torch.float64) delta_t tensor(0.6191, dtype=torch.float64)
15 gae_duplicate tensor(0.3373, dtype=torch.float64) tensor(-8.6308, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6241, dtype=torch.float64) delta_t tensor(0.5943, dtype=torch.float64)
14 gae_duplicate tensor(0.1095, dtype=torch.float64) tensor(-8.2739, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6723, dtype=torch.float64) delta_t tensor(0.6368, dtype=torch.float64)
13 gae_duplicate tensor(0.5522, dtype=torch.float64) tensor(-8.7566, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6738, dtype=torch.float64) delta_t tensor(0.6297, dtype=torch.float64)
12 gae_duplicate tensor(0.4009, dtype=torch.float64) tensor(-8.7364, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7261, dtype=torch.float64) delta_t tensor(0.6710, dtype=torch.float64)
11 gae_duplicate tensor(0.6178, dtype=torch.float64) tensor(-9.2457, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5763, dtype=torch.float64) delta_t tensor(0.4930, dtype=torch.float64)
10 gae_duplicate tensor(0.3999, dtype=torch.float64) tensor(-7.0776, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0605, dtype=torch.float64) delta_t tensor(-0.0666, dtype=torch.float64)
9 gae_duplicate tensor(-1.1843, dtype=torch.float64) tensor(0.1207, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3945, dtype=torch.float64) delta_t tensor(-0.3896, dtype=torch.float64)
8 gae_duplicate tensor(-1.4865, dtype=torch.float64) tensor(4.8797, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3639, dtype=torch.float64) delta_t tensor(-0.4321, dtype=torch.float64)
7 gae_duplicate tensor(-1.8112, dtype=torch.float64) tensor(5.8792, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2022, dtype=torch.float64) delta_t tensor(-1.2893, dtype=torch.float64)
6 gae_duplicate tensor(-3.9146, dtype=torch.float64) tensor(16.6559, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9599, dtype=torch.float64) delta_t tensor(-1.0674, dtype=torch.float64)
5 gae_duplicate tensor(-2.0016, dtype=torch.float64) tensor(14.9937, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3033, dtype=torch.float64) delta_t tensor(-0.3520, dtype=torch.float64)
4 gae_duplicate tensor(-1.9597, dtype=torch.float64) tensor(5.9071, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6114, dtype=torch.float64) delta_t tensor(-0.5596, dtype=torch.float64)
3 gae_duplicate tensor(-1.1770, dtype=torch.float64) tensor(7.3799, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6382, dtype=torch.float64) delta_t tensor(-0.6060, dtype=torch.float64)
2 gae_duplicate tensor(-1.0510, dtype=torch.float64) tensor(8.3069, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:769.8927001953125
value loss:123.88456726074219
entropies:224.52755737304688
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2495.2759)
ToM Target loss= tensor(1801.1359)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.45862889289856 seconds
19 rew tensor(0.7330, dtype=torch.float64) delta_t tensor(0.6088, dtype=torch.float64)
19 gae_duplicate tensor(0.5747, dtype=torch.float64) tensor(-7.5961, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7343, dtype=torch.float64) delta_t tensor(0.6493, dtype=torch.float64)
18 gae_duplicate tensor(0.6485, dtype=torch.float64) tensor(-8.8542, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7283, dtype=torch.float64) delta_t tensor(0.6462, dtype=torch.float64)
17 gae_duplicate tensor(0.6525, dtype=torch.float64) tensor(-8.9554, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7000, dtype=torch.float64) delta_t tensor(0.6142, dtype=torch.float64)
16 gae_duplicate tensor(0.5026, dtype=torch.float64) tensor(-8.5597, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6249, dtype=torch.float64) delta_t tensor(0.6165, dtype=torch.float64)
15 gae_duplicate tensor(0.3844, dtype=torch.float64) tensor(-8.5524, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5301, dtype=torch.float64) delta_t tensor(0.5063, dtype=torch.float64)
14 gae_duplicate tensor(-0.0976, dtype=torch.float64) tensor(-7.1695, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5954, dtype=torch.float64) delta_t tensor(0.5357, dtype=torch.float64)
13 gae_duplicate tensor(0.2304, dtype=torch.float64) tensor(-7.3841, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6761, dtype=torch.float64) delta_t tensor(0.6207, dtype=torch.float64)
12 gae_duplicate tensor(0.4389, dtype=torch.float64) tensor(-8.4921, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6950, dtype=torch.float64) delta_t tensor(0.6413, dtype=torch.float64)
11 gae_duplicate tensor(0.5505, dtype=torch.float64) tensor(-8.8380, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5275, dtype=torch.float64) delta_t tensor(0.4899, dtype=torch.float64)
10 gae_duplicate tensor(0.4899, dtype=torch.float64) tensor(-7.0031, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9648, dtype=torch.float64) delta_t tensor(-0.9643, dtype=torch.float64)
9 gae_duplicate tensor(-2.9488, dtype=torch.float64) tensor(11.3604, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2648, dtype=torch.float64) delta_t tensor(-0.2786, dtype=torch.float64)
8 gae_duplicate tensor(-1.8278, dtype=torch.float64) tensor(4.6104, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5485, dtype=torch.float64) delta_t tensor(-0.5390, dtype=torch.float64)
7 gae_duplicate tensor(-1.5295, dtype=torch.float64) tensor(7.2014, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3541, dtype=torch.float64) delta_t tensor(-1.4151, dtype=torch.float64)
6 gae_duplicate tensor(-2.9209, dtype=torch.float64) tensor(18.3755, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5819, dtype=torch.float64) delta_t tensor(-1.7030, dtype=torch.float64)
5 gae_duplicate tensor(-3.1384, dtype=torch.float64) tensor(23.1232, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1661, dtype=torch.float64) delta_t tensor(-3.2713, dtype=torch.float64)
4 gae_duplicate tensor(-7.9109, dtype=torch.float64) tensor(43.1837, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3122, dtype=torch.float64) delta_t tensor(-0.3567, dtype=torch.float64)
3 gae_duplicate tensor(-1.3851, dtype=torch.float64) tensor(8.7412, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1711, dtype=torch.float64) delta_t tensor(-0.1392, dtype=torch.float64)
2 gae_duplicate tensor(-0.5453, dtype=torch.float64) tensor(2.6060, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1401.1239013671875
value loss:327.2569274902344
entropies:224.57626342773438
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.57918906211853 seconds
19 rew tensor(0.6507, dtype=torch.float64) delta_t tensor(0.6223, dtype=torch.float64)
19 gae_duplicate tensor(0.2085, dtype=torch.float64) tensor(-7.7693, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5714, dtype=torch.float64) delta_t tensor(0.5120, dtype=torch.float64)
18 gae_duplicate tensor(-0.4123, dtype=torch.float64) tensor(-7.1751, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7478, dtype=torch.float64) delta_t tensor(0.7037, dtype=torch.float64)
17 gae_duplicate tensor(0.5924, dtype=torch.float64) tensor(-9.5021, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7418, dtype=torch.float64) delta_t tensor(0.7046, dtype=torch.float64)
16 gae_duplicate tensor(0.6376, dtype=torch.float64) tensor(-9.7444, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6984, dtype=torch.float64) delta_t tensor(0.5836, dtype=torch.float64)
15 gae_duplicate tensor(0.3000, dtype=torch.float64) tensor(-8.2464, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6923, dtype=torch.float64) delta_t tensor(0.6290, dtype=torch.float64)
14 gae_duplicate tensor(0.3042, dtype=torch.float64) tensor(-8.6807, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4731, dtype=torch.float64) delta_t tensor(0.3835, dtype=torch.float64)
13 gae_duplicate tensor(0.0927, dtype=torch.float64) tensor(-5.6567, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4806, dtype=torch.float64) delta_t tensor(0.4478, dtype=torch.float64)
12 gae_duplicate tensor(0.1189, dtype=torch.float64) tensor(-6.1517, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3349, dtype=torch.float64) delta_t tensor(0.3056, dtype=torch.float64)
11 gae_duplicate tensor(0.1797, dtype=torch.float64) tensor(-4.4287, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0174, dtype=torch.float64) delta_t tensor(-0.0562, dtype=torch.float64)
10 gae_duplicate tensor(-1.1608, dtype=torch.float64) tensor(0.2659, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3864, dtype=torch.float64) delta_t tensor(-0.3825, dtype=torch.float64)
9 gae_duplicate tensor(-3.2540, dtype=torch.float64) tensor(4.8036, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3899, dtype=torch.float64) delta_t tensor(-0.3761, dtype=torch.float64)
8 gae_duplicate tensor(-1.9178, dtype=torch.float64) tensor(5.1933, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3945, dtype=torch.float64) delta_t tensor(-0.3888, dtype=torch.float64)
7 gae_duplicate tensor(-1.6297, dtype=torch.float64) tensor(5.3819, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4603, dtype=torch.float64) delta_t tensor(-0.4841, dtype=torch.float64)
6 gae_duplicate tensor(-2.1074, dtype=torch.float64) tensor(6.5728, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9488, dtype=torch.float64) delta_t tensor(-0.9771, dtype=torch.float64)
5 gae_duplicate tensor(-2.6063, dtype=torch.float64) tensor(12.8281, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6516, dtype=torch.float64) delta_t tensor(-0.6706, dtype=torch.float64)
4 gae_duplicate tensor(-3.4371, dtype=torch.float64) tensor(9.6430, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8215, dtype=torch.float64) delta_t tensor(-0.8197, dtype=torch.float64)
3 gae_duplicate tensor(-1.2447, dtype=torch.float64) tensor(11.1795, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6355, dtype=torch.float64) delta_t tensor(-0.6557, dtype=torch.float64)
2 gae_duplicate tensor(-1.6769, dtype=torch.float64) tensor(9.3192, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:37.6248779296875
value loss:126.85661315917969
entropies:224.5786590576172
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.462352275848389 seconds
19 rew tensor(0.7195, dtype=torch.float64) delta_t tensor(0.6336, dtype=torch.float64)
19 gae_duplicate tensor(0.5651, dtype=torch.float64) tensor(-7.9018, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7056, dtype=torch.float64) delta_t tensor(0.6269, dtype=torch.float64)
18 gae_duplicate tensor(0.6082, dtype=torch.float64) tensor(-8.6114, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6837, dtype=torch.float64) delta_t tensor(0.6095, dtype=torch.float64)
17 gae_duplicate tensor(0.4156, dtype=torch.float64) tensor(-8.4604, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6091, dtype=torch.float64) delta_t tensor(0.5449, dtype=torch.float64)
16 gae_duplicate tensor(0.2311, dtype=torch.float64) tensor(-7.6435, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4595, dtype=torch.float64) delta_t tensor(0.4076, dtype=torch.float64)
15 gae_duplicate tensor(-0.4863, dtype=torch.float64) tensor(-5.8448, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5648, dtype=torch.float64) delta_t tensor(0.4964, dtype=torch.float64)
14 gae_duplicate tensor(-0.4793, dtype=torch.float64) tensor(-6.7755, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7551, dtype=torch.float64) delta_t tensor(0.6934, dtype=torch.float64)
13 gae_duplicate tensor(0.5998, dtype=torch.float64) tensor(-9.3297, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6142, dtype=torch.float64) delta_t tensor(0.5752, dtype=torch.float64)
12 gae_duplicate tensor(0.4239, dtype=torch.float64) tensor(-8.1174, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6496, dtype=torch.float64) delta_t tensor(0.6458, dtype=torch.float64)
11 gae_duplicate tensor(0.4199, dtype=torch.float64) tensor(-8.8656, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4959, dtype=torch.float64) delta_t tensor(0.4919, dtype=torch.float64)
10 gae_duplicate tensor(0.1969, dtype=torch.float64) tensor(-7.0325, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8753, dtype=torch.float64) delta_t tensor(-0.8666, dtype=torch.float64)
9 gae_duplicate tensor(-3.5570, dtype=torch.float64) tensor(10.1190, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4155, dtype=torch.float64) delta_t tensor(-0.3280, dtype=torch.float64)
8 gae_duplicate tensor(-1.5365, dtype=torch.float64) tensor(5.0998, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2985, dtype=torch.float64) delta_t tensor(-0.2560, dtype=torch.float64)
7 gae_duplicate tensor(-0.7984, dtype=torch.float64) tensor(3.7107, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2028, dtype=torch.float64) delta_t tensor(-1.2038, dtype=torch.float64)
6 gae_duplicate tensor(-2.5612, dtype=torch.float64) tensor(15.3806, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0930, dtype=torch.float64) delta_t tensor(-1.1477, dtype=torch.float64)
5 gae_duplicate tensor(-3.0851, dtype=torch.float64) tensor(15.8633, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2308, dtype=torch.float64) delta_t tensor(-1.2983, dtype=torch.float64)
4 gae_duplicate tensor(-3.5883, dtype=torch.float64) tensor(17.7890, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0891, dtype=torch.float64) delta_t tensor(-0.0819, dtype=torch.float64)
3 gae_duplicate tensor(-0.9748, dtype=torch.float64) tensor(2.7975, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5081, dtype=torch.float64) delta_t tensor(-0.4824, dtype=torch.float64)
2 gae_duplicate tensor(-0.8077, dtype=torch.float64) tensor(6.3371, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:13.054178237915039
value loss:154.53518676757812
entropies:224.55783081054688
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.609282970428467 seconds
19 rew tensor(0.5236, dtype=torch.float64) delta_t tensor(0.4932, dtype=torch.float64)
19 gae_duplicate tensor(-0.6708, dtype=torch.float64) tensor(-6.1509, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7443, dtype=torch.float64) delta_t tensor(0.7587, dtype=torch.float64)
18 gae_duplicate tensor(0.6345, dtype=torch.float64) tensor(-10.0734, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7378, dtype=torch.float64) delta_t tensor(0.7232, dtype=torch.float64)
17 gae_duplicate tensor(0.6627, dtype=torch.float64) tensor(-10.0236, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7158, dtype=torch.float64) delta_t tensor(0.7303, dtype=torch.float64)
16 gae_duplicate tensor(0.6327, dtype=torch.float64) tensor(-10.1250, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6931, dtype=torch.float64) delta_t tensor(0.6583, dtype=torch.float64)
15 gae_duplicate tensor(0.3996, dtype=torch.float64) tensor(-9.2294, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6157, dtype=torch.float64) delta_t tensor(0.6087, dtype=torch.float64)
14 gae_duplicate tensor(0.1261, dtype=torch.float64) tensor(-8.5189, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7013, dtype=torch.float64) delta_t tensor(0.6881, dtype=torch.float64)
13 gae_duplicate tensor(0.5138, dtype=torch.float64) tensor(-9.4364, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5909, dtype=torch.float64) delta_t tensor(0.5757, dtype=torch.float64)
12 gae_duplicate tensor(0.3865, dtype=torch.float64) tensor(-8.1331, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6183, dtype=torch.float64) delta_t tensor(0.5826, dtype=torch.float64)
11 gae_duplicate tensor(0.3548, dtype=torch.float64) tensor(-8.0866, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5496, dtype=torch.float64) delta_t tensor(0.5556, dtype=torch.float64)
10 gae_duplicate tensor(0.3320, dtype=torch.float64) tensor(-7.7341, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2436, dtype=torch.float64) delta_t tensor(0.2467, dtype=torch.float64)
9 gae_duplicate tensor(-0.3143, dtype=torch.float64) tensor(-3.8533, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1196, dtype=torch.float64) delta_t tensor(-0.0932, dtype=torch.float64)
8 gae_duplicate tensor(-1.4366, dtype=torch.float64) tensor(0.7754, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6003, dtype=torch.float64) delta_t tensor(-0.6364, dtype=torch.float64)
7 gae_duplicate tensor(-2.1734, dtype=torch.float64) tensor(8.0105, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9865, dtype=torch.float64) delta_t tensor(-1.0217, dtype=torch.float64)
6 gae_duplicate tensor(-2.0379, dtype=torch.float64) tensor(13.5604, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8493, dtype=torch.float64) delta_t tensor(-0.8275, dtype=torch.float64)
5 gae_duplicate tensor(-2.0830, dtype=torch.float64) tensor(11.6770, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1173, dtype=torch.float64) delta_t tensor(-2.0512, dtype=torch.float64)
4 gae_duplicate tensor(-5.7822, dtype=torch.float64) tensor(26.7490, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5676, dtype=torch.float64) delta_t tensor(-0.5442, dtype=torch.float64)
3 gae_duplicate tensor(-1.1680, dtype=torch.float64) tensor(9.4402, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3576, dtype=torch.float64) delta_t tensor(-0.3300, dtype=torch.float64)
2 gae_duplicate tensor(-1.0303, dtype=torch.float64) tensor(5.0464, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:539.388671875
value loss:165.3878936767578
entropies:224.57215881347656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.595529079437256 seconds
19 rew tensor(0.7361, dtype=torch.float64) delta_t tensor(0.6583, dtype=torch.float64)
19 gae_duplicate tensor(0.5778, dtype=torch.float64) tensor(-8.2196, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7135, dtype=torch.float64) delta_t tensor(0.6404, dtype=torch.float64)
18 gae_duplicate tensor(0.6085, dtype=torch.float64) tensor(-8.8228, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7066, dtype=torch.float64) delta_t tensor(0.6510, dtype=torch.float64)
17 gae_duplicate tensor(0.6163, dtype=torch.float64) tensor(-9.0023, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6443, dtype=torch.float64) delta_t tensor(0.5794, dtype=torch.float64)
16 gae_duplicate tensor(0.3660, dtype=torch.float64) tensor(-8.1310, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5313, dtype=torch.float64) delta_t tensor(0.5344, dtype=torch.float64)
15 gae_duplicate tensor(0.1074, dtype=torch.float64) tensor(-7.4791, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3471, dtype=torch.float64) delta_t tensor(0.3263, dtype=torch.float64)
14 gae_duplicate tensor(-0.6584, dtype=torch.float64) tensor(-4.8210, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5100, dtype=torch.float64) delta_t tensor(0.5031, dtype=torch.float64)
13 gae_duplicate tensor(0.1098, dtype=torch.float64) tensor(-6.7560, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5884, dtype=torch.float64) delta_t tensor(0.5605, dtype=torch.float64)
12 gae_duplicate tensor(-0.1199, dtype=torch.float64) tensor(-7.6716, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1922, dtype=torch.float64) delta_t tensor(0.1745, dtype=torch.float64)
11 gae_duplicate tensor(-1.0782, dtype=torch.float64) tensor(-2.9453, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4300, dtype=torch.float64) delta_t tensor(0.4036, dtype=torch.float64)
10 gae_duplicate tensor(-0.2648, dtype=torch.float64) tensor(-5.3253, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1456, dtype=torch.float64) delta_t tensor(-0.1438, dtype=torch.float64)
9 gae_duplicate tensor(-2.1120, dtype=torch.float64) tensor(1.2564, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0912, dtype=torch.float64) delta_t tensor(-0.1195, dtype=torch.float64)
8 gae_duplicate tensor(-1.6662, dtype=torch.float64) tensor(1.6268, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4498, dtype=torch.float64) delta_t tensor(-0.4385, dtype=torch.float64)
7 gae_duplicate tensor(-2.5600, dtype=torch.float64) tensor(5.6253, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8785, dtype=torch.float64) delta_t tensor(-0.9239, dtype=torch.float64)
6 gae_duplicate tensor(-2.0638, dtype=torch.float64) tensor(12.0886, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1716, dtype=torch.float64) delta_t tensor(-1.1803, dtype=torch.float64)
5 gae_duplicate tensor(-4.7622, dtype=torch.float64) tensor(15.9487, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7059, dtype=torch.float64) delta_t tensor(-1.7062, dtype=torch.float64)
4 gae_duplicate tensor(-6.0642, dtype=torch.float64) tensor(22.8895, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5668, dtype=torch.float64) delta_t tensor(-0.5132, dtype=torch.float64)
3 gae_duplicate tensor(-1.4259, dtype=torch.float64) tensor(8.6443, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5457, dtype=torch.float64) delta_t tensor(-0.5066, dtype=torch.float64)
2 gae_duplicate tensor(-1.2752, dtype=torch.float64) tensor(7.2698, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-262.7401123046875
value loss:191.92286682128906
entropies:224.57479858398438
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2498.3442)
ToM Target loss= tensor(1799.7791)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.1062171459198 seconds
19 rew tensor(0.7536, dtype=torch.float64) delta_t tensor(0.7132, dtype=torch.float64)
19 gae_duplicate tensor(0.6162, dtype=torch.float64) tensor(-8.8984, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7547, dtype=torch.float64) delta_t tensor(0.6690, dtype=torch.float64)
18 gae_duplicate tensor(0.6902, dtype=torch.float64) tensor(-9.2328, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7559, dtype=torch.float64) delta_t tensor(0.6707, dtype=torch.float64)
17 gae_duplicate tensor(0.6987, dtype=torch.float64) tensor(-9.2997, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7489, dtype=torch.float64) delta_t tensor(0.6812, dtype=torch.float64)
16 gae_duplicate tensor(0.6558, dtype=torch.float64) tensor(-9.4324, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7500, dtype=torch.float64) delta_t tensor(0.7018, dtype=torch.float64)
15 gae_duplicate tensor(0.6868, dtype=torch.float64) tensor(-9.6919, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7348, dtype=torch.float64) delta_t tensor(0.7131, dtype=torch.float64)
14 gae_duplicate tensor(0.5764, dtype=torch.float64) tensor(-9.8610, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7278, dtype=torch.float64) delta_t tensor(0.7318, dtype=torch.float64)
13 gae_duplicate tensor(0.5228, dtype=torch.float64) tensor(-10.1166, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6161, dtype=torch.float64) delta_t tensor(0.6357, dtype=torch.float64)
12 gae_duplicate tensor(0.5129, dtype=torch.float64) tensor(-8.9389, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4642, dtype=torch.float64) delta_t tensor(0.4986, dtype=torch.float64)
11 gae_duplicate tensor(0.3534, dtype=torch.float64) tensor(-7.0995, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0434, dtype=torch.float64) delta_t tensor(-0.0778, dtype=torch.float64)
10 gae_duplicate tensor(-1.3249, dtype=torch.float64) tensor(0.2582, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0199, dtype=torch.float64) delta_t tensor(0.0574, dtype=torch.float64)
9 gae_duplicate tensor(-0.5265, dtype=torch.float64) tensor(-0.6840, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1010, dtype=torch.float64) delta_t tensor(-0.0607, dtype=torch.float64)
8 gae_duplicate tensor(-0.6931, dtype=torch.float64) tensor(0.6867, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3044, dtype=torch.float64) delta_t tensor(-0.2494, dtype=torch.float64)
7 gae_duplicate tensor(-1.7186, dtype=torch.float64) tensor(3.1811, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4649, dtype=torch.float64) delta_t tensor(-0.4689, dtype=torch.float64)
6 gae_duplicate tensor(-0.9445, dtype=torch.float64) tensor(6.1528, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1685, dtype=torch.float64) delta_t tensor(-1.1635, dtype=torch.float64)
5 gae_duplicate tensor(-2.4097, dtype=torch.float64) tensor(15.1435, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4847, dtype=torch.float64) delta_t tensor(-1.4432, dtype=torch.float64)
4 gae_duplicate tensor(-5.6432, dtype=torch.float64) tensor(19.4922, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2952, dtype=torch.float64) delta_t tensor(-0.2295, dtype=torch.float64)
3 gae_duplicate tensor(-1.1885, dtype=torch.float64) tensor(4.8502, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6511, dtype=torch.float64) delta_t tensor(-0.5738, dtype=torch.float64)
2 gae_duplicate tensor(-1.0275, dtype=torch.float64) tensor(7.6350, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:890.3678588867188
value loss:146.58482360839844
entropies:224.57247924804688
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.361488103866577 seconds
19 rew tensor(0.5209, dtype=torch.float64) delta_t tensor(0.4733, dtype=torch.float64)
19 gae_duplicate tensor(-0.6621, dtype=torch.float64) tensor(-5.9097, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7571, dtype=torch.float64) delta_t tensor(0.6853, dtype=torch.float64)
18 gae_duplicate tensor(0.6875, dtype=torch.float64) tensor(-9.1418, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7509, dtype=torch.float64) delta_t tensor(0.7067, dtype=torch.float64)
17 gae_duplicate tensor(0.5986, dtype=torch.float64) tensor(-9.7463, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7520, dtype=torch.float64) delta_t tensor(0.7213, dtype=torch.float64)
16 gae_duplicate tensor(0.6053, dtype=torch.float64) tensor(-9.9646, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7444, dtype=torch.float64) delta_t tensor(0.6587, dtype=torch.float64)
15 gae_duplicate tensor(0.6178, dtype=torch.float64) tensor(-9.2040, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7294, dtype=torch.float64) delta_t tensor(0.6705, dtype=torch.float64)
14 gae_duplicate tensor(0.6033, dtype=torch.float64) tensor(-9.2705, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6418, dtype=torch.float64) delta_t tensor(0.6045, dtype=torch.float64)
13 gae_duplicate tensor(0.4684, dtype=torch.float64) tensor(-8.4786, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5297, dtype=torch.float64) delta_t tensor(0.5557, dtype=torch.float64)
12 gae_duplicate tensor(0.4770, dtype=torch.float64) tensor(-7.7815, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5144, dtype=torch.float64) delta_t tensor(0.5570, dtype=torch.float64)
11 gae_duplicate tensor(0.2831, dtype=torch.float64) tensor(-7.7334, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3619, dtype=torch.float64) delta_t tensor(0.3863, dtype=torch.float64)
10 gae_duplicate tensor(0.2198, dtype=torch.float64) tensor(-5.5916, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1747, dtype=torch.float64) delta_t tensor(0.2188, dtype=torch.float64)
9 gae_duplicate tensor(-0.2408, dtype=torch.float64) tensor(-3.2921, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0811, dtype=torch.float64) delta_t tensor(-0.0113, dtype=torch.float64)
8 gae_duplicate tensor(-0.4129, dtype=torch.float64) tensor(-0.1916, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1768, dtype=torch.float64) delta_t tensor(-0.0957, dtype=torch.float64)
7 gae_duplicate tensor(-0.7744, dtype=torch.float64) tensor(1.1722, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8862, dtype=torch.float64) delta_t tensor(-0.8508, dtype=torch.float64)
6 gae_duplicate tensor(-1.6580, dtype=torch.float64) tensor(10.7341, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3796, dtype=torch.float64) delta_t tensor(-0.2960, dtype=torch.float64)
5 gae_duplicate tensor(-1.2129, dtype=torch.float64) tensor(4.7627, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6650, dtype=torch.float64) delta_t tensor(-0.5432, dtype=torch.float64)
4 gae_duplicate tensor(-1.2661, dtype=torch.float64) tensor(7.2548, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5212, dtype=torch.float64) delta_t tensor(-0.5010, dtype=torch.float64)
3 gae_duplicate tensor(-1.3013, dtype=torch.float64) tensor(6.9822, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6714, dtype=torch.float64) delta_t tensor(-0.6644, dtype=torch.float64)
2 gae_duplicate tensor(-1.0832, dtype=torch.float64) tensor(8.9846, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1630.516357421875
value loss:79.99124908447266
entropies:224.5786895751953
Policy training finished
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 809, in _callmethod
    conn.send((self._id, methodname, args, kwds))
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 206, in send
    self._send_bytes(_ForkingPickler.dumps(obj))
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/reduction.py", line 39, in __init__
    super().__init__(*args)
KeyboardInterrupt
training start after waiting for 4.964284896850586 seconds
19 rew tensor(0.7083, dtype=torch.float64) delta_t tensor(0.6467, dtype=torch.float64)
19 gae_duplicate tensor(0.3953, dtype=torch.float64) tensor(-8.0601, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6564, dtype=torch.float64) delta_t tensor(0.6279, dtype=torch.float64)
18 gae_duplicate tensor(0.4792, dtype=torch.float64) tensor(-8.6326, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5449, dtype=torch.float64) delta_t tensor(0.5001, dtype=torch.float64)
17 gae_duplicate tensor(0.1393, dtype=torch.float64) tensor(-7.1023, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3582, dtype=torch.float64) delta_t tensor(0.2447, dtype=torch.float64)
16 gae_duplicate tensor(-0.5622, dtype=torch.float64) tensor(-3.7591, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7178, dtype=torch.float64) delta_t tensor(0.6089, dtype=torch.float64)
15 gae_duplicate tensor(0.5175, dtype=torch.float64) tensor(-7.9745, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5835, dtype=torch.float64) delta_t tensor(0.5046, dtype=torch.float64)
14 gae_duplicate tensor(0.3038, dtype=torch.float64) tensor(-7.0898, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5773, dtype=torch.float64) delta_t tensor(0.5091, dtype=torch.float64)
13 gae_duplicate tensor(0.4364, dtype=torch.float64) tensor(-7.0670, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6672, dtype=torch.float64) delta_t tensor(0.6403, dtype=torch.float64)
12 gae_duplicate tensor(0.4429, dtype=torch.float64) tensor(-8.6889, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5547, dtype=torch.float64) delta_t tensor(0.5381, dtype=torch.float64)
11 gae_duplicate tensor(0.4707, dtype=torch.float64) tensor(-7.5913, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3521, dtype=torch.float64) delta_t tensor(0.3347, dtype=torch.float64)
10 gae_duplicate tensor(0.1223, dtype=torch.float64) tensor(-4.9347, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7097, dtype=torch.float64) delta_t tensor(-0.7376, dtype=torch.float64)
9 gae_duplicate tensor(-2.2459, dtype=torch.float64) tensor(8.6941, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4303, dtype=torch.float64) delta_t tensor(-0.4763, dtype=torch.float64)
8 gae_duplicate tensor(-1.6647, dtype=torch.float64) tensor(6.8163, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7970, dtype=torch.float64) delta_t tensor(-0.7958, dtype=torch.float64)
7 gae_duplicate tensor(-1.8746, dtype=torch.float64) tensor(10.6321, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6629, dtype=torch.float64) delta_t tensor(-0.6761, dtype=torch.float64)
6 gae_duplicate tensor(-2.1667, dtype=torch.float64) tensor(9.5149, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5689, dtype=torch.float64) delta_t tensor(-1.5910, dtype=torch.float64)
5 gae_duplicate tensor(-2.6946, dtype=torch.float64) tensor(20.7915, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9279, dtype=torch.float64) delta_t tensor(-1.9236, dtype=torch.float64)
4 gae_duplicate tensor(-5.5241, dtype=torch.float64) tensor(26.0843, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4029, dtype=torch.float64) delta_t tensor(-0.3504, dtype=torch.float64)
3 gae_duplicate tensor(-1.3044, dtype=torch.float64) tensor(7.0006, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3950, dtype=torch.float64) delta_t tensor(-0.3997, dtype=torch.float64)
2 gae_duplicate tensor(-1.1552, dtype=torch.float64) tensor(5.6593, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-914.96337890625
value loss:185.93801879882812
entropies:224.57394409179688
Policy training finished
---------------------
gamma: 0.1