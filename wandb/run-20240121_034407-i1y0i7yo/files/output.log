obs <crafter.objects.Shelter object at 0x16dacff70> [ 0 39  0  0 39  0  0 13  0]
obs <crafter.objects.Warehouse object at 0x136f37b80> [ 0 41  0  0 37  0  0  9  0]
obs <crafter.objects.Station object at 0x16dae58e0> [ 0  9  0  0  9  0  0 12  0]
obs <crafter.objects.Shelter object at 0x16dacff70> [ 0 39  0  0 39  0  0 10  0]
obs <crafter.objects.Warehouse object at 0x136f37b80> [ 0 39  0  0 42  0  0  9  0]
obs <crafter.objects.Station object at 0x16dae58e0> [ 0  9  0  0  9  0  0 15  0]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.001828908920288086 seconds
19 rew tensor(0.8939, dtype=torch.float64) delta_t tensor(0.7080, dtype=torch.float64)
19 gae_duplicate tensor(0.6227, dtype=torch.float64) tensor(-7.9247, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9371, dtype=torch.float64) delta_t tensor(0.7057, dtype=torch.float64)
18 gae_duplicate tensor(0.7127, dtype=torch.float64) tensor(-9.2955, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9873, dtype=torch.float64) delta_t tensor(0.8065, dtype=torch.float64)
17 gae_duplicate tensor(0.7603, dtype=torch.float64) tensor(-10.4193, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0469, dtype=torch.float64) delta_t tensor(0.8594, dtype=torch.float64)
16 gae_duplicate tensor(0.8156, dtype=torch.float64) tensor(-11.1489, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.1192, dtype=torch.float64) delta_t tensor(0.9940, dtype=torch.float64)
15 gae_duplicate tensor(0.8879, dtype=torch.float64) tensor(-12.9929, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.2096, dtype=torch.float64) delta_t tensor(1.0810, dtype=torch.float64)
14 gae_duplicate tensor(0.9676, dtype=torch.float64) tensor(-14.6166, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.1967, dtype=torch.float64) delta_t tensor(1.0638, dtype=torch.float64)
13 gae_duplicate tensor(0.6083, dtype=torch.float64) tensor(-13.3633, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.4086, dtype=torch.float64) delta_t tensor(1.2749, dtype=torch.float64)
12 gae_duplicate tensor(1.0727, dtype=torch.float64) tensor(-16.9242, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.0591, dtype=torch.float64) delta_t tensor(0.9190, dtype=torch.float64)
11 gae_duplicate tensor(-1.0752, dtype=torch.float64) tensor(-13.3485, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(1.3341, dtype=torch.float64) delta_t tensor(1.1558, dtype=torch.float64)
10 gae_duplicate tensor(0.5077, dtype=torch.float64) tensor(-15.3497, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(1.4338, dtype=torch.float64) delta_t tensor(1.1745, dtype=torch.float64)
9 gae_duplicate tensor(0.6291, dtype=torch.float64) tensor(-15.1860, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(1.3364, dtype=torch.float64) delta_t tensor(1.1053, dtype=torch.float64)
8 gae_duplicate tensor(0.7115, dtype=torch.float64) tensor(-13.4961, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.6634, dtype=torch.float64) delta_t tensor(0.3315, dtype=torch.float64)
7 gae_duplicate tensor(-0.2979, dtype=torch.float64) tensor(-5.4634, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0812, dtype=torch.float64) delta_t tensor(-0.2163, dtype=torch.float64)
6 gae_duplicate tensor(-1.7397, dtype=torch.float64) tensor(2.4705, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2600, dtype=torch.float64) delta_t tensor(-0.0655, dtype=torch.float64)
5 gae_duplicate tensor(-1.3690, dtype=torch.float64) tensor(0.3533, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5525, dtype=torch.float64) delta_t tensor(-0.8461, dtype=torch.float64)
4 gae_duplicate tensor(-1.5349, dtype=torch.float64) tensor(9.7588, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8541, dtype=torch.float64) delta_t tensor(-1.1248, dtype=torch.float64)
3 gae_duplicate tensor(-1.9436, dtype=torch.float64) tensor(13.2934, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6376, dtype=torch.float64) delta_t tensor(-0.8668, dtype=torch.float64)
2 gae_duplicate tensor(-1.6023, dtype=torch.float64) tensor(12.7265, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4313.69140625
value loss:211.00811767578125
entropies:220.3826904296875
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 4.853138208389282 seconds
19 rew tensor(0.8960, dtype=torch.float64) delta_t tensor(0.7269, dtype=torch.float64)
19 gae_duplicate tensor(0.6482, dtype=torch.float64) tensor(-8.3054, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9069, dtype=torch.float64) delta_t tensor(0.7580, dtype=torch.float64)
18 gae_duplicate tensor(0.7519, dtype=torch.float64) tensor(-9.5771, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.7687, dtype=torch.float64)
17 gae_duplicate tensor(0.7229, dtype=torch.float64) tensor(-10.4072, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8533, dtype=torch.float64) delta_t tensor(0.7434, dtype=torch.float64)
16 gae_duplicate tensor(0.3702, dtype=torch.float64) tensor(-10.2402, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7789, dtype=torch.float64) delta_t tensor(0.6059, dtype=torch.float64)
15 gae_duplicate tensor(-0.3569, dtype=torch.float64) tensor(-9.3014, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8581, dtype=torch.float64) delta_t tensor(0.6244, dtype=torch.float64)
14 gae_duplicate tensor(-0.1441, dtype=torch.float64) tensor(-8.6475, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(0.5477, dtype=torch.float64)
13 gae_duplicate tensor(-0.0732, dtype=torch.float64) tensor(-8.3020, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8104, dtype=torch.float64) delta_t tensor(0.5673, dtype=torch.float64)
12 gae_duplicate tensor(-0.4529, dtype=torch.float64) tensor(-6.7905, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6993, dtype=torch.float64) delta_t tensor(0.4667, dtype=torch.float64)
11 gae_duplicate tensor(-0.2443, dtype=torch.float64) tensor(-6.6288, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7222, dtype=torch.float64) delta_t tensor(0.5217, dtype=torch.float64)
10 gae_duplicate tensor(-0.2505, dtype=torch.float64) tensor(-7.0646, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1544, dtype=torch.float64) delta_t tensor(-0.3688, dtype=torch.float64)
9 gae_duplicate tensor(-1.6116, dtype=torch.float64) tensor(4.4573, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1639, dtype=torch.float64) delta_t tensor(-0.0280, dtype=torch.float64)
8 gae_duplicate tensor(-0.7487, dtype=torch.float64) tensor(0.4204, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7331, dtype=torch.float64) delta_t tensor(-0.9098, dtype=torch.float64)
7 gae_duplicate tensor(-1.8991, dtype=torch.float64) tensor(11.7824, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2346, dtype=torch.float64) delta_t tensor(-1.5126, dtype=torch.float64)
6 gae_duplicate tensor(-2.8479, dtype=torch.float64) tensor(18.8440, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7312, dtype=torch.float64) delta_t tensor(-2.1123, dtype=torch.float64)
5 gae_duplicate tensor(-3.6969, dtype=torch.float64) tensor(27.2422, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5143, dtype=torch.float64) delta_t tensor(-0.8432, dtype=torch.float64)
4 gae_duplicate tensor(-2.2214, dtype=torch.float64) tensor(14.3808, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0809, dtype=torch.float64) delta_t tensor(-1.3876, dtype=torch.float64)
3 gae_duplicate tensor(-2.1383, dtype=torch.float64) tensor(16.0777, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9681, dtype=torch.float64) delta_t tensor(-1.2970, dtype=torch.float64)
2 gae_duplicate tensor(-2.7112, dtype=torch.float64) tensor(18.9663, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1007.9735717773438
value loss:232.09902954101562
entropies:218.56581115722656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.838683128356934 seconds
19 rew tensor(0.8761, dtype=torch.float64) delta_t tensor(0.7546, dtype=torch.float64)
19 gae_duplicate tensor(0.5303, dtype=torch.float64) tensor(-9.1225, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8799, dtype=torch.float64) delta_t tensor(0.7714, dtype=torch.float64)
18 gae_duplicate tensor(0.5587, dtype=torch.float64) tensor(-9.6994, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8935, dtype=torch.float64) delta_t tensor(0.7805, dtype=torch.float64)
17 gae_duplicate tensor(0.5634, dtype=torch.float64) tensor(-10.0524, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8892, dtype=torch.float64) delta_t tensor(0.7416, dtype=torch.float64)
16 gae_duplicate tensor(0.6796, dtype=torch.float64) tensor(-10.9294, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8759, dtype=torch.float64) delta_t tensor(0.7112, dtype=torch.float64)
15 gae_duplicate tensor(0.4815, dtype=torch.float64) tensor(-10.2335, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8538, dtype=torch.float64) delta_t tensor(0.6892, dtype=torch.float64)
14 gae_duplicate tensor(0.2174, dtype=torch.float64) tensor(-8.3393, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9601, dtype=torch.float64) delta_t tensor(0.7907, dtype=torch.float64)
13 gae_duplicate tensor(0.7159, dtype=torch.float64) tensor(-11.5123, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9777, dtype=torch.float64) delta_t tensor(0.7963, dtype=torch.float64)
12 gae_duplicate tensor(0.7360, dtype=torch.float64) tensor(-9.5816, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8674, dtype=torch.float64) delta_t tensor(0.6676, dtype=torch.float64)
11 gae_duplicate tensor(0.0232, dtype=torch.float64) tensor(-9.3366, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7800, dtype=torch.float64) delta_t tensor(0.5156, dtype=torch.float64)
10 gae_duplicate tensor(-0.0355, dtype=torch.float64) tensor(-7.9069, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1277, dtype=torch.float64) delta_t tensor(-0.3463, dtype=torch.float64)
9 gae_duplicate tensor(-1.6703, dtype=torch.float64) tensor(3.0833, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3738, dtype=torch.float64) delta_t tensor(-0.6352, dtype=torch.float64)
8 gae_duplicate tensor(-1.3456, dtype=torch.float64) tensor(8.7010, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5258, dtype=torch.float64) delta_t tensor(-0.8229, dtype=torch.float64)
7 gae_duplicate tensor(-1.5685, dtype=torch.float64) tensor(9.5398, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0382, dtype=torch.float64) delta_t tensor(-1.3401, dtype=torch.float64)
6 gae_duplicate tensor(-2.4473, dtype=torch.float64) tensor(17.4872, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5057, dtype=torch.float64) delta_t tensor(-1.7872, dtype=torch.float64)
5 gae_duplicate tensor(-3.1502, dtype=torch.float64) tensor(20.8014, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8497, dtype=torch.float64) delta_t tensor(-1.1688, dtype=torch.float64)
4 gae_duplicate tensor(-4.9303, dtype=torch.float64) tensor(14.6902, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0660, dtype=torch.float64) delta_t tensor(-1.4094, dtype=torch.float64)
3 gae_duplicate tensor(-2.3670, dtype=torch.float64) tensor(19.4736, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5733, dtype=torch.float64) delta_t tensor(-0.7919, dtype=torch.float64)
2 gae_duplicate tensor(-2.6110, dtype=torch.float64) tensor(13.1219, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-406.0173034667969
value loss:229.85968017578125
entropies:218.7673797607422
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.024707078933716 seconds
19 rew tensor(0.7943, dtype=torch.float64) delta_t tensor(0.6102, dtype=torch.float64)
19 gae_duplicate tensor(0.4710, dtype=torch.float64) tensor(-7.8087, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7933, dtype=torch.float64) delta_t tensor(0.6555, dtype=torch.float64)
18 gae_duplicate tensor(0.5323, dtype=torch.float64) tensor(-9.3004, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7631, dtype=torch.float64) delta_t tensor(0.5990, dtype=torch.float64)
17 gae_duplicate tensor(0.3750, dtype=torch.float64) tensor(-8.0526, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6580, dtype=torch.float64) delta_t tensor(0.5231, dtype=torch.float64)
16 gae_duplicate tensor(-0.0143, dtype=torch.float64) tensor(-7.4143, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4947, dtype=torch.float64) delta_t tensor(0.3191, dtype=torch.float64)
15 gae_duplicate tensor(-0.9223, dtype=torch.float64) tensor(-5.1786, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6378, dtype=torch.float64) delta_t tensor(0.4320, dtype=torch.float64)
14 gae_duplicate tensor(-0.5656, dtype=torch.float64) tensor(-5.9273, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7062, dtype=torch.float64) delta_t tensor(0.4803, dtype=torch.float64)
13 gae_duplicate tensor(-0.1843, dtype=torch.float64) tensor(-6.5099, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7806, dtype=torch.float64) delta_t tensor(0.5479, dtype=torch.float64)
12 gae_duplicate tensor(0.0334, dtype=torch.float64) tensor(-7.1542, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7868, dtype=torch.float64) delta_t tensor(0.5519, dtype=torch.float64)
11 gae_duplicate tensor(-0.0714, dtype=torch.float64) tensor(-7.7089, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6945, dtype=torch.float64) delta_t tensor(0.4587, dtype=torch.float64)
10 gae_duplicate tensor(-0.0141, dtype=torch.float64) tensor(-6.4679, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7114, dtype=torch.float64) delta_t tensor(-0.9187, dtype=torch.float64)
9 gae_duplicate tensor(-2.8461, dtype=torch.float64) tensor(9.4408, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0473, dtype=torch.float64) delta_t tensor(-0.2274, dtype=torch.float64)
8 gae_duplicate tensor(-0.9575, dtype=torch.float64) tensor(3.2795, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6930, dtype=torch.float64) delta_t tensor(-0.9975, dtype=torch.float64)
7 gae_duplicate tensor(-2.0908, dtype=torch.float64) tensor(12.4317, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.7325, dtype=torch.float64) delta_t tensor(-1.9425, dtype=torch.float64)
6 gae_duplicate tensor(-3.1367, dtype=torch.float64) tensor(26.3591, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0707, dtype=torch.float64) delta_t tensor(-2.4320, dtype=torch.float64)
5 gae_duplicate tensor(-3.8700, dtype=torch.float64) tensor(32.6767, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7189, dtype=torch.float64) delta_t tensor(-3.0494, dtype=torch.float64)
4 gae_duplicate tensor(-6.7346, dtype=torch.float64) tensor(40.8518, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7419, dtype=torch.float64) delta_t tensor(-1.0209, dtype=torch.float64)
3 gae_duplicate tensor(-1.9232, dtype=torch.float64) tensor(15.5945, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5430, dtype=torch.float64) delta_t tensor(-0.7126, dtype=torch.float64)
2 gae_duplicate tensor(-1.5754, dtype=torch.float64) tensor(11.3840, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2937.29248046875
value loss:358.6556091308594
entropies:219.21603393554688
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.404934883117676 seconds
19 rew tensor(0.7525, dtype=torch.float64) delta_t tensor(0.5217, dtype=torch.float64)
19 gae_duplicate tensor(0.4206, dtype=torch.float64) tensor(-5.9744, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6875, dtype=torch.float64) delta_t tensor(0.5250, dtype=torch.float64)
18 gae_duplicate tensor(0.1618, dtype=torch.float64) tensor(-6.8379, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5176, dtype=torch.float64) delta_t tensor(0.3376, dtype=torch.float64)
17 gae_duplicate tensor(-0.6996, dtype=torch.float64) tensor(-4.4654, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6106, dtype=torch.float64) delta_t tensor(0.4540, dtype=torch.float64)
16 gae_duplicate tensor(0.0467, dtype=torch.float64) tensor(-6.6195, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4357, dtype=torch.float64) delta_t tensor(0.2288, dtype=torch.float64)
15 gae_duplicate tensor(-0.6452, dtype=torch.float64) tensor(-3.4569, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6710, dtype=torch.float64) delta_t tensor(0.4407, dtype=torch.float64)
14 gae_duplicate tensor(-0.3797, dtype=torch.float64) tensor(-4.8696, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7701, dtype=torch.float64) delta_t tensor(0.5276, dtype=torch.float64)
13 gae_duplicate tensor(0.2724, dtype=torch.float64) tensor(-7.3251, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8568, dtype=torch.float64) delta_t tensor(0.6325, dtype=torch.float64)
12 gae_duplicate tensor(0.4002, dtype=torch.float64) tensor(-9.1405, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8543, dtype=torch.float64) delta_t tensor(0.5865, dtype=torch.float64)
11 gae_duplicate tensor(0.4423, dtype=torch.float64) tensor(-8.3858, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6326, dtype=torch.float64) delta_t tensor(0.4290, dtype=torch.float64)
10 gae_duplicate tensor(0.2713, dtype=torch.float64) tensor(-6.3955, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2818, dtype=torch.float64) delta_t tensor(-1.4666, dtype=torch.float64)
9 gae_duplicate tensor(-4.2582, dtype=torch.float64) tensor(15.9466, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3328, dtype=torch.float64) delta_t tensor(-0.5017, dtype=torch.float64)
8 gae_duplicate tensor(-1.7875, dtype=torch.float64) tensor(7.3746, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6686, dtype=torch.float64) delta_t tensor(-0.7837, dtype=torch.float64)
7 gae_duplicate tensor(-2.0465, dtype=torch.float64) tensor(11.1235, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5483, dtype=torch.float64) delta_t tensor(-1.8408, dtype=torch.float64)
6 gae_duplicate tensor(-3.8379, dtype=torch.float64) tensor(25.2638, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4807, dtype=torch.float64) delta_t tensor(-1.8175, dtype=torch.float64)
5 gae_duplicate tensor(-2.9034, dtype=torch.float64) tensor(22.7716, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1364, dtype=torch.float64) delta_t tensor(-2.4243, dtype=torch.float64)
4 gae_duplicate tensor(-4.4531, dtype=torch.float64) tensor(30.5326, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4139, dtype=torch.float64) delta_t tensor(-0.6218, dtype=torch.float64)
3 gae_duplicate tensor(-1.5992, dtype=torch.float64) tensor(10.5587, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6322, dtype=torch.float64) delta_t tensor(-0.8494, dtype=torch.float64)
2 gae_duplicate tensor(-2.0354, dtype=torch.float64) tensor(11.9827, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2634.443115234375
value loss:269.5777893066406
entropies:219.10305786132812
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2504.2327)
ToM Target loss= tensor(1799.7914)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.935672044754028 seconds
19 rew tensor(0.8120, dtype=torch.float64) delta_t tensor(0.5462, dtype=torch.float64)
19 gae_duplicate tensor(0.4140, dtype=torch.float64) tensor(-6.8021, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8177, dtype=torch.float64) delta_t tensor(0.5680, dtype=torch.float64)
18 gae_duplicate tensor(0.4653, dtype=torch.float64) tensor(-7.9237, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.5963, dtype=torch.float64)
17 gae_duplicate tensor(0.4817, dtype=torch.float64) tensor(-8.0480, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7753, dtype=torch.float64) delta_t tensor(0.6033, dtype=torch.float64)
16 gae_duplicate tensor(0.4855, dtype=torch.float64) tensor(-8.0310, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7490, dtype=torch.float64) delta_t tensor(0.5542, dtype=torch.float64)
15 gae_duplicate tensor(0.3443, dtype=torch.float64) tensor(-8.0208, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6539, dtype=torch.float64) delta_t tensor(0.4778, dtype=torch.float64)
14 gae_duplicate tensor(-0.3328, dtype=torch.float64) tensor(-6.7343, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6574, dtype=torch.float64) delta_t tensor(0.4708, dtype=torch.float64)
13 gae_duplicate tensor(0.1230, dtype=torch.float64) tensor(-6.4298, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5101, dtype=torch.float64) delta_t tensor(0.2658, dtype=torch.float64)
12 gae_duplicate tensor(-0.2254, dtype=torch.float64) tensor(-4.3958, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3955, dtype=torch.float64) delta_t tensor(0.1501, dtype=torch.float64)
11 gae_duplicate tensor(-0.5330, dtype=torch.float64) tensor(-2.0314, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2480, dtype=torch.float64) delta_t tensor(0.0129, dtype=torch.float64)
10 gae_duplicate tensor(-0.7633, dtype=torch.float64) tensor(-0.1934, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1723, dtype=torch.float64) delta_t tensor(0.0007, dtype=torch.float64)
9 gae_duplicate tensor(-0.6689, dtype=torch.float64) tensor(-0.0781, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1207, dtype=torch.float64) delta_t tensor(-0.3265, dtype=torch.float64)
8 gae_duplicate tensor(-1.4084, dtype=torch.float64) tensor(3.2560, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8234, dtype=torch.float64) delta_t tensor(-1.0607, dtype=torch.float64)
7 gae_duplicate tensor(-1.9317, dtype=torch.float64) tensor(12.8456, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3001, dtype=torch.float64) delta_t tensor(-1.5951, dtype=torch.float64)
6 gae_duplicate tensor(-2.5401, dtype=torch.float64) tensor(24.2970, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5800, dtype=torch.float64) delta_t tensor(-1.8706, dtype=torch.float64)
5 gae_duplicate tensor(-4.5299, dtype=torch.float64) tensor(22.3002, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7838, dtype=torch.float64) delta_t tensor(-2.0708, dtype=torch.float64)
4 gae_duplicate tensor(-7.2674, dtype=torch.float64) tensor(27.3597, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7095, dtype=torch.float64) delta_t tensor(-0.8671, dtype=torch.float64)
3 gae_duplicate tensor(-1.5148, dtype=torch.float64) tensor(13.0516, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1513, dtype=torch.float64) delta_t tensor(-0.3566, dtype=torch.float64)
2 gae_duplicate tensor(-0.8416, dtype=torch.float64) tensor(5.8726, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1850.0504150390625
value loss:261.4632263183594
entropies:219.19766235351562
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.93898606300354 seconds
19 rew tensor(0.7919, dtype=torch.float64) delta_t tensor(0.5387, dtype=torch.float64)
19 gae_duplicate tensor(0.4083, dtype=torch.float64) tensor(-6.8037, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8285, dtype=torch.float64) delta_t tensor(0.6070, dtype=torch.float64)
18 gae_duplicate tensor(0.5392, dtype=torch.float64) tensor(-7.7126, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8336, dtype=torch.float64) delta_t tensor(0.6998, dtype=torch.float64)
17 gae_duplicate tensor(0.5506, dtype=torch.float64) tensor(-9.1360, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8227, dtype=torch.float64) delta_t tensor(0.7158, dtype=torch.float64)
16 gae_duplicate tensor(0.6154, dtype=torch.float64) tensor(-10.4432, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8199, dtype=torch.float64) delta_t tensor(0.6698, dtype=torch.float64)
15 gae_duplicate tensor(0.5094, dtype=torch.float64) tensor(-8.9307, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8171, dtype=torch.float64) delta_t tensor(0.6781, dtype=torch.float64)
14 gae_duplicate tensor(0.5909, dtype=torch.float64) tensor(-8.9811, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7415, dtype=torch.float64) delta_t tensor(0.5332, dtype=torch.float64)
13 gae_duplicate tensor(0.3918, dtype=torch.float64) tensor(-7.7636, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6998, dtype=torch.float64) delta_t tensor(0.5161, dtype=torch.float64)
12 gae_duplicate tensor(0.1239, dtype=torch.float64) tensor(-6.8173, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6090, dtype=torch.float64) delta_t tensor(0.3724, dtype=torch.float64)
11 gae_duplicate tensor(-0.2927, dtype=torch.float64) tensor(-5.9112, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4025, dtype=torch.float64) delta_t tensor(0.2033, dtype=torch.float64)
10 gae_duplicate tensor(-0.7795, dtype=torch.float64) tensor(-2.8314, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0651, dtype=torch.float64) delta_t tensor(-0.2625, dtype=torch.float64)
9 gae_duplicate tensor(-1.4194, dtype=torch.float64) tensor(3.5973, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0724, dtype=torch.float64) delta_t tensor(-0.2987, dtype=torch.float64)
8 gae_duplicate tensor(-1.0453, dtype=torch.float64) tensor(4.0236, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0924, dtype=torch.float64) delta_t tensor(-0.3555, dtype=torch.float64)
7 gae_duplicate tensor(-0.8778, dtype=torch.float64) tensor(4.5180, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8746, dtype=torch.float64) delta_t tensor(-1.1541, dtype=torch.float64)
6 gae_duplicate tensor(-2.8712, dtype=torch.float64) tensor(12.9808, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7768, dtype=torch.float64) delta_t tensor(-1.1189, dtype=torch.float64)
5 gae_duplicate tensor(-1.8543, dtype=torch.float64) tensor(15.7972, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6622, dtype=torch.float64) delta_t tensor(-0.9945, dtype=torch.float64)
4 gae_duplicate tensor(-3.2638, dtype=torch.float64) tensor(12.8322, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7607, dtype=torch.float64) delta_t tensor(-1.0312, dtype=torch.float64)
3 gae_duplicate tensor(-1.6079, dtype=torch.float64) tensor(15.1507, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4691, dtype=torch.float64) delta_t tensor(-0.7405, dtype=torch.float64)
2 gae_duplicate tensor(-1.2356, dtype=torch.float64) tensor(10.9581, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-202.59625244140625
value loss:133.35476684570312
entropies:220.10096740722656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.832612037658691 seconds
19 rew tensor(0.7688, dtype=torch.float64) delta_t tensor(0.6303, dtype=torch.float64)
19 gae_duplicate tensor(0.3942, dtype=torch.float64) tensor(-7.6456, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7121, dtype=torch.float64) delta_t tensor(0.5767, dtype=torch.float64)
18 gae_duplicate tensor(0.0952, dtype=torch.float64) tensor(-7.5465, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6208, dtype=torch.float64) delta_t tensor(0.4513, dtype=torch.float64)
17 gae_duplicate tensor(-0.7850, dtype=torch.float64) tensor(-5.9641, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8313, dtype=torch.float64) delta_t tensor(0.7031, dtype=torch.float64)
16 gae_duplicate tensor(0.3866, dtype=torch.float64) tensor(-10.2890, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8359, dtype=torch.float64) delta_t tensor(0.6696, dtype=torch.float64)
15 gae_duplicate tensor(0.5039, dtype=torch.float64) tensor(-8.9984, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7735, dtype=torch.float64) delta_t tensor(0.5509, dtype=torch.float64)
14 gae_duplicate tensor(0.1167, dtype=torch.float64) tensor(-7.9289, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7164, dtype=torch.float64) delta_t tensor(0.4751, dtype=torch.float64)
13 gae_duplicate tensor(0.1204, dtype=torch.float64) tensor(-6.8133, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6082, dtype=torch.float64) delta_t tensor(0.4217, dtype=torch.float64)
12 gae_duplicate tensor(0.0966, dtype=torch.float64) tensor(-5.5130, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5837, dtype=torch.float64) delta_t tensor(0.3862, dtype=torch.float64)
11 gae_duplicate tensor(-0.0692, dtype=torch.float64) tensor(-5.8521, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5039, dtype=torch.float64) delta_t tensor(0.3162, dtype=torch.float64)
10 gae_duplicate tensor(-0.0821, dtype=torch.float64) tensor(-3.9877, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1780, dtype=torch.float64) delta_t tensor(-0.3499, dtype=torch.float64)
9 gae_duplicate tensor(-2.6460, dtype=torch.float64) tensor(3.6638, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1447, dtype=torch.float64) delta_t tensor(-0.0067, dtype=torch.float64)
8 gae_duplicate tensor(-0.6411, dtype=torch.float64) tensor(0.4474, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3693, dtype=torch.float64) delta_t tensor(-0.5489, dtype=torch.float64)
7 gae_duplicate tensor(-1.9115, dtype=torch.float64) tensor(7.2126, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9210, dtype=torch.float64) delta_t tensor(-1.2351, dtype=torch.float64)
6 gae_duplicate tensor(-2.6785, dtype=torch.float64) tensor(16.8341, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3804, dtype=torch.float64) delta_t tensor(-1.6420, dtype=torch.float64)
5 gae_duplicate tensor(-2.8626, dtype=torch.float64) tensor(23.1127, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2946, dtype=torch.float64) delta_t tensor(-1.6225, dtype=torch.float64)
4 gae_duplicate tensor(-4.4672, dtype=torch.float64) tensor(22.5689, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9773, dtype=torch.float64) delta_t tensor(-1.2521, dtype=torch.float64)
3 gae_duplicate tensor(-1.9332, dtype=torch.float64) tensor(18.4033, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8465, dtype=torch.float64) delta_t tensor(-1.0491, dtype=torch.float64)
2 gae_duplicate tensor(-2.5930, dtype=torch.float64) tensor(14.6793, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1349.491455078125
value loss:194.83468627929688
entropies:220.49603271484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.715404987335205 seconds
19 rew tensor(0.7688, dtype=torch.float64) delta_t tensor(0.5619, dtype=torch.float64)
19 gae_duplicate tensor(0.4320, dtype=torch.float64) tensor(-6.8355, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7149, dtype=torch.float64) delta_t tensor(0.5644, dtype=torch.float64)
18 gae_duplicate tensor(0.2005, dtype=torch.float64) tensor(-8.0936, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6267, dtype=torch.float64) delta_t tensor(0.4931, dtype=torch.float64)
17 gae_duplicate tensor(-0.2873, dtype=torch.float64) tensor(-7.2044, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7168, dtype=torch.float64) delta_t tensor(0.6327, dtype=torch.float64)
16 gae_duplicate tensor(0.4351, dtype=torch.float64) tensor(-8.9998, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6542, dtype=torch.float64) delta_t tensor(0.5509, dtype=torch.float64)
15 gae_duplicate tensor(0.1340, dtype=torch.float64) tensor(-6.7708, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5364, dtype=torch.float64) delta_t tensor(0.3977, dtype=torch.float64)
14 gae_duplicate tensor(-0.0692, dtype=torch.float64) tensor(-6.0555, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7512, dtype=torch.float64) delta_t tensor(0.5786, dtype=torch.float64)
13 gae_duplicate tensor(0.3596, dtype=torch.float64) tensor(-8.1945, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7118, dtype=torch.float64) delta_t tensor(0.5526, dtype=torch.float64)
12 gae_duplicate tensor(0.0134, dtype=torch.float64) tensor(-8.4040, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6972, dtype=torch.float64) delta_t tensor(0.5087, dtype=torch.float64)
11 gae_duplicate tensor(-0.0213, dtype=torch.float64) tensor(-6.4715, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6012, dtype=torch.float64) delta_t tensor(0.4503, dtype=torch.float64)
10 gae_duplicate tensor(-0.0560, dtype=torch.float64) tensor(-5.5749, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3071, dtype=torch.float64) delta_t tensor(0.1089, dtype=torch.float64)
9 gae_duplicate tensor(-0.4575, dtype=torch.float64) tensor(-1.6400, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4079, dtype=torch.float64) delta_t tensor(-0.5486, dtype=torch.float64)
8 gae_duplicate tensor(-1.5393, dtype=torch.float64) tensor(6.0966, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1353, dtype=torch.float64) delta_t tensor(-1.3007, dtype=torch.float64)
7 gae_duplicate tensor(-2.0154, dtype=torch.float64) tensor(16.5531, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.6223, dtype=torch.float64) delta_t tensor(-1.8935, dtype=torch.float64)
6 gae_duplicate tensor(-2.5580, dtype=torch.float64) tensor(26.3131, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7845, dtype=torch.float64) delta_t tensor(-2.1199, dtype=torch.float64)
5 gae_duplicate tensor(-3.4364, dtype=torch.float64) tensor(28.6123, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1912, dtype=torch.float64) delta_t tensor(-3.5413, dtype=torch.float64)
4 gae_duplicate tensor(-7.8819, dtype=torch.float64) tensor(44.6095, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5595, dtype=torch.float64) delta_t tensor(-0.8529, dtype=torch.float64)
3 gae_duplicate tensor(-2.3544, dtype=torch.float64) tensor(14.7379, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7673, dtype=torch.float64) delta_t tensor(-0.8802, dtype=torch.float64)
2 gae_duplicate tensor(-2.1626, dtype=torch.float64) tensor(11.3380, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2704.2119140625
value loss:365.65240478515625
entropies:220.20018005371094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.870026111602783 seconds
19 rew tensor(0.8096, dtype=torch.float64) delta_t tensor(0.6315, dtype=torch.float64)
19 gae_duplicate tensor(0.5032, dtype=torch.float64) tensor(-8.2803, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(0.6580, dtype=torch.float64)
18 gae_duplicate tensor(0.5887, dtype=torch.float64) tensor(-8.5261, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8064, dtype=torch.float64) delta_t tensor(0.6822, dtype=torch.float64)
17 gae_duplicate tensor(0.6153, dtype=torch.float64) tensor(-9.8196, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7795, dtype=torch.float64) delta_t tensor(0.6952, dtype=torch.float64)
16 gae_duplicate tensor(0.5862, dtype=torch.float64) tensor(-10.7284, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7425, dtype=torch.float64) delta_t tensor(0.5491, dtype=torch.float64)
15 gae_duplicate tensor(0.0885, dtype=torch.float64) tensor(-7.7732, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6754, dtype=torch.float64) delta_t tensor(0.5006, dtype=torch.float64)
14 gae_duplicate tensor(-0.3227, dtype=torch.float64) tensor(-6.3806, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7461, dtype=torch.float64) delta_t tensor(0.5859, dtype=torch.float64)
13 gae_duplicate tensor(0.3235, dtype=torch.float64) tensor(-8.0096, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7554, dtype=torch.float64) delta_t tensor(0.5775, dtype=torch.float64)
12 gae_duplicate tensor(0.3399, dtype=torch.float64) tensor(-7.7549, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6712, dtype=torch.float64) delta_t tensor(0.5001, dtype=torch.float64)
11 gae_duplicate tensor(0.1609, dtype=torch.float64) tensor(-7.1320, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4226, dtype=torch.float64) delta_t tensor(-0.5937, dtype=torch.float64)
10 gae_duplicate tensor(-4.8169, dtype=torch.float64) tensor(8.0792, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0405, dtype=torch.float64) delta_t tensor(-0.1932, dtype=torch.float64)
9 gae_duplicate tensor(-1.9755, dtype=torch.float64) tensor(3.7314, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3706, dtype=torch.float64) delta_t tensor(-0.5315, dtype=torch.float64)
8 gae_duplicate tensor(-1.5613, dtype=torch.float64) tensor(7.0232, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3570, dtype=torch.float64) delta_t tensor(-0.5673, dtype=torch.float64)
7 gae_duplicate tensor(-1.1972, dtype=torch.float64) tensor(7.0088, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6330, dtype=torch.float64) delta_t tensor(-0.8698, dtype=torch.float64)
6 gae_duplicate tensor(-1.8203, dtype=torch.float64) tensor(12.0199, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8783, dtype=torch.float64) delta_t tensor(-1.1124, dtype=torch.float64)
5 gae_duplicate tensor(-2.0662, dtype=torch.float64) tensor(13.9739, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8058, dtype=torch.float64) delta_t tensor(-1.0645, dtype=torch.float64)
4 gae_duplicate tensor(-2.2754, dtype=torch.float64) tensor(12.9050, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7557, dtype=torch.float64) delta_t tensor(-0.9403, dtype=torch.float64)
3 gae_duplicate tensor(-2.4224, dtype=torch.float64) tensor(11.5552, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7813, dtype=torch.float64) delta_t tensor(-0.9275, dtype=torch.float64)
2 gae_duplicate tensor(-2.3023, dtype=torch.float64) tensor(12.3493, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-552.2568359375
value loss:170.89724731445312
entropies:219.866455078125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2490.3948)
ToM Target loss= tensor(1799.1768)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.914192199707031 seconds
19 rew tensor(0.7540, dtype=torch.float64) delta_t tensor(0.6113, dtype=torch.float64)
19 gae_duplicate tensor(0.5370, dtype=torch.float64) tensor(-6.7423, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7118, dtype=torch.float64) delta_t tensor(0.6185, dtype=torch.float64)
18 gae_duplicate tensor(0.5517, dtype=torch.float64) tensor(-8.6417, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5791, dtype=torch.float64) delta_t tensor(0.4913, dtype=torch.float64)
17 gae_duplicate tensor(0.0153, dtype=torch.float64) tensor(-7.3412, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3501, dtype=torch.float64) delta_t tensor(0.2552, dtype=torch.float64)
16 gae_duplicate tensor(-0.9864, dtype=torch.float64) tensor(-3.9969, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4571, dtype=torch.float64) delta_t tensor(0.2983, dtype=torch.float64)
15 gae_duplicate tensor(-0.7163, dtype=torch.float64) tensor(-3.3764, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5540, dtype=torch.float64) delta_t tensor(0.3708, dtype=torch.float64)
14 gae_duplicate tensor(-0.2340, dtype=torch.float64) tensor(-4.9114, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7679, dtype=torch.float64) delta_t tensor(0.5839, dtype=torch.float64)
13 gae_duplicate tensor(0.2849, dtype=torch.float64) tensor(-7.0270, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7575, dtype=torch.float64) delta_t tensor(0.5677, dtype=torch.float64)
12 gae_duplicate tensor(0.3419, dtype=torch.float64) tensor(-7.2421, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7329, dtype=torch.float64) delta_t tensor(0.5607, dtype=torch.float64)
11 gae_duplicate tensor(0.4425, dtype=torch.float64) tensor(-7.9622, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6148, dtype=torch.float64) delta_t tensor(0.4740, dtype=torch.float64)
10 gae_duplicate tensor(0.2455, dtype=torch.float64) tensor(-6.4246, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1618, dtype=torch.float64) delta_t tensor(-0.2510, dtype=torch.float64)
9 gae_duplicate tensor(-1.5393, dtype=torch.float64) tensor(1.9955, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9092, dtype=torch.float64) delta_t tensor(-0.9990, dtype=torch.float64)
8 gae_duplicate tensor(-2.9356, dtype=torch.float64) tensor(11.1793, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3673, dtype=torch.float64) delta_t tensor(-0.5192, dtype=torch.float64)
7 gae_duplicate tensor(-2.4887, dtype=torch.float64) tensor(8.3177, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1770, dtype=torch.float64) delta_t tensor(-1.3783, dtype=torch.float64)
6 gae_duplicate tensor(-2.8797, dtype=torch.float64) tensor(18.5048, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5128, dtype=torch.float64) delta_t tensor(-1.7749, dtype=torch.float64)
5 gae_duplicate tensor(-3.7716, dtype=torch.float64) tensor(22.0611, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0296, dtype=torch.float64) delta_t tensor(-2.3045, dtype=torch.float64)
4 gae_duplicate tensor(-5.6986, dtype=torch.float64) tensor(28.9624, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6268, dtype=torch.float64) delta_t tensor(-0.7805, dtype=torch.float64)
3 gae_duplicate tensor(-1.9728, dtype=torch.float64) tensor(11.6495, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6685, dtype=torch.float64) delta_t tensor(-0.7766, dtype=torch.float64)
2 gae_duplicate tensor(-1.6867, dtype=torch.float64) tensor(11.0850, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1842.814697265625
value loss:251.7736053466797
entropies:219.96241760253906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.999423027038574 seconds
19 rew tensor(0.8023, dtype=torch.float64) delta_t tensor(0.6075, dtype=torch.float64)
19 gae_duplicate tensor(0.5040, dtype=torch.float64) tensor(-8.0922, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7872, dtype=torch.float64) delta_t tensor(0.6331, dtype=torch.float64)
18 gae_duplicate tensor(0.6126, dtype=torch.float64) tensor(-8.0438, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7631, dtype=torch.float64) delta_t tensor(0.6187, dtype=torch.float64)
17 gae_duplicate tensor(0.6161, dtype=torch.float64) tensor(-8.2545, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7212, dtype=torch.float64) delta_t tensor(0.5902, dtype=torch.float64)
16 gae_duplicate tensor(0.3435, dtype=torch.float64) tensor(-7.7038, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6525, dtype=torch.float64) delta_t tensor(0.5050, dtype=torch.float64)
15 gae_duplicate tensor(-0.2406, dtype=torch.float64) tensor(-6.7664, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6472, dtype=torch.float64) delta_t tensor(0.5328, dtype=torch.float64)
14 gae_duplicate tensor(-0.2480, dtype=torch.float64) tensor(-6.4423, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6264, dtype=torch.float64) delta_t tensor(0.4972, dtype=torch.float64)
13 gae_duplicate tensor(-0.0440, dtype=torch.float64) tensor(-7.0659, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6079, dtype=torch.float64) delta_t tensor(0.4810, dtype=torch.float64)
12 gae_duplicate tensor(-0.1087, dtype=torch.float64) tensor(-6.2196, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3693, dtype=torch.float64) delta_t tensor(0.2061, dtype=torch.float64)
11 gae_duplicate tensor(-0.6930, dtype=torch.float64) tensor(-3.3670, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3624, dtype=torch.float64) delta_t tensor(0.2361, dtype=torch.float64)
10 gae_duplicate tensor(0.0412, dtype=torch.float64) tensor(-3.0247, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3801, dtype=torch.float64) delta_t tensor(-0.5069, dtype=torch.float64)
9 gae_duplicate tensor(-1.6767, dtype=torch.float64) tensor(5.5294, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6048, dtype=torch.float64) delta_t tensor(-0.7267, dtype=torch.float64)
8 gae_duplicate tensor(-1.8570, dtype=torch.float64) tensor(9.6183, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8148, dtype=torch.float64) delta_t tensor(-0.9830, dtype=torch.float64)
7 gae_duplicate tensor(-2.0489, dtype=torch.float64) tensor(11.7557, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9956, dtype=torch.float64) delta_t tensor(-1.1834, dtype=torch.float64)
6 gae_duplicate tensor(-2.6559, dtype=torch.float64) tensor(17.5858, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0879, dtype=torch.float64) delta_t tensor(-1.3276, dtype=torch.float64)
5 gae_duplicate tensor(-3.0702, dtype=torch.float64) tensor(15.8836, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6436, dtype=torch.float64) delta_t tensor(-1.8551, dtype=torch.float64)
4 gae_duplicate tensor(-8.9429, dtype=torch.float64) tensor(28.6305, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6914, dtype=torch.float64) delta_t tensor(-0.8670, dtype=torch.float64)
3 gae_duplicate tensor(-2.1234, dtype=torch.float64) tensor(12.2487, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2063, dtype=torch.float64) delta_t tensor(-0.3890, dtype=torch.float64)
2 gae_duplicate tensor(-1.0879, dtype=torch.float64) tensor(5.9389, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1559.14794921875
value loss:267.30218505859375
entropies:219.7598876953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.081825017929077 seconds
19 rew tensor(0.8060, dtype=torch.float64) delta_t tensor(0.6777, dtype=torch.float64)
19 gae_duplicate tensor(0.5788, dtype=torch.float64) tensor(-8.3045, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7911, dtype=torch.float64) delta_t tensor(0.6925, dtype=torch.float64)
18 gae_duplicate tensor(0.6751, dtype=torch.float64) tensor(-8.7095, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7936, dtype=torch.float64) delta_t tensor(0.7086, dtype=torch.float64)
17 gae_duplicate tensor(0.6998, dtype=torch.float64) tensor(-9.3207, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7874, dtype=torch.float64) delta_t tensor(0.7212, dtype=torch.float64)
16 gae_duplicate tensor(0.6743, dtype=torch.float64) tensor(-9.8749, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7637, dtype=torch.float64) delta_t tensor(0.5943, dtype=torch.float64)
15 gae_duplicate tensor(0.3783, dtype=torch.float64) tensor(-7.9995, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7050, dtype=torch.float64) delta_t tensor(0.5689, dtype=torch.float64)
14 gae_duplicate tensor(0.0758, dtype=torch.float64) tensor(-7.8688, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8025, dtype=torch.float64) delta_t tensor(0.6680, dtype=torch.float64)
13 gae_duplicate tensor(0.6669, dtype=torch.float64) tensor(-8.4176, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7309, dtype=torch.float64) delta_t tensor(0.5532, dtype=torch.float64)
12 gae_duplicate tensor(0.3792, dtype=torch.float64) tensor(-7.7338, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6884, dtype=torch.float64) delta_t tensor(0.5404, dtype=torch.float64)
11 gae_duplicate tensor(0.4137, dtype=torch.float64) tensor(-6.9928, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4183, dtype=torch.float64) delta_t tensor(0.2707, dtype=torch.float64)
10 gae_duplicate tensor(-0.4678, dtype=torch.float64) tensor(-4.8388, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2587, dtype=torch.float64) delta_t tensor(0.1020, dtype=torch.float64)
9 gae_duplicate tensor(-0.6719, dtype=torch.float64) tensor(-2.1757, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1128, dtype=torch.float64) delta_t tensor(-0.2168, dtype=torch.float64)
8 gae_duplicate tensor(-0.7199, dtype=torch.float64) tensor(2.4630, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8190, dtype=torch.float64) delta_t tensor(-0.9726, dtype=torch.float64)
7 gae_duplicate tensor(-2.0111, dtype=torch.float64) tensor(12.1108, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4097, dtype=torch.float64) delta_t tensor(-0.5940, dtype=torch.float64)
6 gae_duplicate tensor(-1.5477, dtype=torch.float64) tensor(7.3937, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5229, dtype=torch.float64) delta_t tensor(-1.6630, dtype=torch.float64)
5 gae_duplicate tensor(-4.2262, dtype=torch.float64) tensor(19.8326, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8802, dtype=torch.float64) delta_t tensor(-2.0839, dtype=torch.float64)
4 gae_duplicate tensor(-6.3149, dtype=torch.float64) tensor(24.4704, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8506, dtype=torch.float64) delta_t tensor(-1.0293, dtype=torch.float64)
3 gae_duplicate tensor(-1.4827, dtype=torch.float64) tensor(14.2507, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5833, dtype=torch.float64) delta_t tensor(-0.6468, dtype=torch.float64)
2 gae_duplicate tensor(-1.1600, dtype=torch.float64) tensor(9.1756, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-308.0566711425781
value loss:224.31793212890625
entropies:219.412353515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.10143518447876 seconds
19 rew tensor(0.8106, dtype=torch.float64) delta_t tensor(0.6387, dtype=torch.float64)
19 gae_duplicate tensor(0.5161, dtype=torch.float64) tensor(-8.2699, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8043, dtype=torch.float64) delta_t tensor(0.6476, dtype=torch.float64)
18 gae_duplicate tensor(0.5909, dtype=torch.float64) tensor(-7.6847, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7980, dtype=torch.float64) delta_t tensor(0.6726, dtype=torch.float64)
17 gae_duplicate tensor(0.7024, dtype=torch.float64) tensor(-9.5198, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7829, dtype=torch.float64) delta_t tensor(0.7340, dtype=torch.float64)
16 gae_duplicate tensor(0.6481, dtype=torch.float64) tensor(-10.9412, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7505, dtype=torch.float64) delta_t tensor(0.6542, dtype=torch.float64)
15 gae_duplicate tensor(0.3536, dtype=torch.float64) tensor(-9.1784, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6439, dtype=torch.float64) delta_t tensor(0.5459, dtype=torch.float64)
14 gae_duplicate tensor(-0.0127, dtype=torch.float64) tensor(-6.6572, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7472, dtype=torch.float64) delta_t tensor(0.6498, dtype=torch.float64)
13 gae_duplicate tensor(0.2894, dtype=torch.float64) tensor(-9.2657, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5497, dtype=torch.float64) delta_t tensor(0.4592, dtype=torch.float64)
12 gae_duplicate tensor(0.1380, dtype=torch.float64) tensor(-6.2264, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4478, dtype=torch.float64) delta_t tensor(0.2985, dtype=torch.float64)
11 gae_duplicate tensor(0.1649, dtype=torch.float64) tensor(-4.2299, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2955, dtype=torch.float64) delta_t tensor(0.2104, dtype=torch.float64)
10 gae_duplicate tensor(-0.0228, dtype=torch.float64) tensor(-2.8424, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1892, dtype=torch.float64) delta_t tensor(-0.2820, dtype=torch.float64)
9 gae_duplicate tensor(-2.6439, dtype=torch.float64) tensor(2.6178, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3313, dtype=torch.float64) delta_t tensor(-0.4199, dtype=torch.float64)
8 gae_duplicate tensor(-1.9944, dtype=torch.float64) tensor(5.0481, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7383, dtype=torch.float64) delta_t tensor(-0.8515, dtype=torch.float64)
7 gae_duplicate tensor(-1.8261, dtype=torch.float64) tensor(9.9340, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5223, dtype=torch.float64) delta_t tensor(-1.7307, dtype=torch.float64)
6 gae_duplicate tensor(-3.6681, dtype=torch.float64) tensor(20.9741, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2516, dtype=torch.float64) delta_t tensor(-1.4155, dtype=torch.float64)
5 gae_duplicate tensor(-2.2776, dtype=torch.float64) tensor(19.3994, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2611, dtype=torch.float64) delta_t tensor(-1.4503, dtype=torch.float64)
4 gae_duplicate tensor(-4.2619, dtype=torch.float64) tensor(19.7207, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4928, dtype=torch.float64) delta_t tensor(-0.6568, dtype=torch.float64)
3 gae_duplicate tensor(-1.5253, dtype=torch.float64) tensor(11.1213, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2448, dtype=torch.float64) delta_t tensor(-0.4379, dtype=torch.float64)
2 gae_duplicate tensor(-0.7019, dtype=torch.float64) tensor(6.7776, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-787.4569091796875
value loss:184.01095581054688
entropies:219.29678344726562
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.017377138137817 seconds
19 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.7181, dtype=torch.float64)
19 gae_duplicate tensor(0.6219, dtype=torch.float64) tensor(-8.3352, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.7370, dtype=torch.float64)
18 gae_duplicate tensor(0.7082, dtype=torch.float64) tensor(-9.4641, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8180, dtype=torch.float64) delta_t tensor(0.7334, dtype=torch.float64)
17 gae_duplicate tensor(0.7193, dtype=torch.float64) tensor(-9.9267, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8116, dtype=torch.float64) delta_t tensor(0.7279, dtype=torch.float64)
16 gae_duplicate tensor(0.6767, dtype=torch.float64) tensor(-9.5367, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.7450, dtype=torch.float64)
15 gae_duplicate tensor(0.7457, dtype=torch.float64) tensor(-9.6701, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7987, dtype=torch.float64) delta_t tensor(0.7355, dtype=torch.float64)
14 gae_duplicate tensor(0.7231, dtype=torch.float64) tensor(-9.8335, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6496, dtype=torch.float64) delta_t tensor(0.5460, dtype=torch.float64)
13 gae_duplicate tensor(-0.1296, dtype=torch.float64) tensor(-8.1842, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6325, dtype=torch.float64) delta_t tensor(0.5520, dtype=torch.float64)
12 gae_duplicate tensor(0.1279, dtype=torch.float64) tensor(-8.4449, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5982, dtype=torch.float64) delta_t tensor(0.5263, dtype=torch.float64)
11 gae_duplicate tensor(0.1725, dtype=torch.float64) tensor(-7.1949, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4752, dtype=torch.float64) delta_t tensor(0.4091, dtype=torch.float64)
10 gae_duplicate tensor(-0.1232, dtype=torch.float64) tensor(-6.0627, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0377, dtype=torch.float64) delta_t tensor(-0.0403, dtype=torch.float64)
9 gae_duplicate tensor(-1.5665, dtype=torch.float64) tensor(0.4147, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0235, dtype=torch.float64) delta_t tensor(-0.1383, dtype=torch.float64)
8 gae_duplicate tensor(-0.6978, dtype=torch.float64) tensor(1.3006, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2486, dtype=torch.float64) delta_t tensor(-0.3401, dtype=torch.float64)
7 gae_duplicate tensor(-0.6977, dtype=torch.float64) tensor(4.5931, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7910, dtype=torch.float64) delta_t tensor(-0.9394, dtype=torch.float64)
6 gae_duplicate tensor(-1.4567, dtype=torch.float64) tensor(12.1448, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0448, dtype=torch.float64) delta_t tensor(-1.2296, dtype=torch.float64)
5 gae_duplicate tensor(-2.5425, dtype=torch.float64) tensor(15.6464, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1109, dtype=torch.float64) delta_t tensor(-1.2695, dtype=torch.float64)
4 gae_duplicate tensor(-3.3442, dtype=torch.float64) tensor(15.5421, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5011, dtype=torch.float64) delta_t tensor(-0.5927, dtype=torch.float64)
3 gae_duplicate tensor(-1.4659, dtype=torch.float64) tensor(9.3192, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8340, dtype=torch.float64) delta_t tensor(-0.8566, dtype=torch.float64)
2 gae_duplicate tensor(-1.5455, dtype=torch.float64) tensor(11.5846, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:540.4573364257812
value loss:132.530029296875
entropies:219.02828979492188
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2477.9639)
ToM Target loss= tensor(1801.1729)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.839139699935913 seconds
19 rew tensor(0.8059, dtype=torch.float64) delta_t tensor(0.7319, dtype=torch.float64)
19 gae_duplicate tensor(0.6596, dtype=torch.float64) tensor(-8.2221, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7996, dtype=torch.float64) delta_t tensor(0.7711, dtype=torch.float64)
18 gae_duplicate tensor(0.7429, dtype=torch.float64) tensor(-10.6765, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7765, dtype=torch.float64) delta_t tensor(0.7195, dtype=torch.float64)
17 gae_duplicate tensor(0.6241, dtype=torch.float64) tensor(-8.8016, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7366, dtype=torch.float64) delta_t tensor(0.6828, dtype=torch.float64)
16 gae_duplicate tensor(0.4018, dtype=torch.float64) tensor(-8.9509, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6542, dtype=torch.float64) delta_t tensor(0.5759, dtype=torch.float64)
15 gae_duplicate tensor(-0.2020, dtype=torch.float64) tensor(-7.3754, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6465, dtype=torch.float64) delta_t tensor(0.5550, dtype=torch.float64)
14 gae_duplicate tensor(0.0222, dtype=torch.float64) tensor(-7.4421, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7088, dtype=torch.float64) delta_t tensor(0.6156, dtype=torch.float64)
13 gae_duplicate tensor(0.1750, dtype=torch.float64) tensor(-8.7438, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5633, dtype=torch.float64) delta_t tensor(0.4546, dtype=torch.float64)
12 gae_duplicate tensor(-0.1006, dtype=torch.float64) tensor(-6.1037, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5799, dtype=torch.float64) delta_t tensor(0.4693, dtype=torch.float64)
11 gae_duplicate tensor(-0.1388, dtype=torch.float64) tensor(-5.3032, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4485, dtype=torch.float64) delta_t tensor(0.3628, dtype=torch.float64)
10 gae_duplicate tensor(-0.2683, dtype=torch.float64) tensor(-4.1788, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1280, dtype=torch.float64) delta_t tensor(0.0281, dtype=torch.float64)
9 gae_duplicate tensor(-1.3683, dtype=torch.float64) tensor(0.0331, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2232, dtype=torch.float64) delta_t tensor(0.1203, dtype=torch.float64)
8 gae_duplicate tensor(-0.0530, dtype=torch.float64) tensor(-1.5063, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9417, dtype=torch.float64) delta_t tensor(-1.0656, dtype=torch.float64)
7 gae_duplicate tensor(-1.8321, dtype=torch.float64) tensor(13.0300, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4488, dtype=torch.float64) delta_t tensor(-1.6334, dtype=torch.float64)
6 gae_duplicate tensor(-4.1796, dtype=torch.float64) tensor(22.2302, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3354, dtype=torch.float64) delta_t tensor(-1.4709, dtype=torch.float64)
5 gae_duplicate tensor(-3.2317, dtype=torch.float64) tensor(20.6318, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9235, dtype=torch.float64) delta_t tensor(-2.1333, dtype=torch.float64)
4 gae_duplicate tensor(-4.1155, dtype=torch.float64) tensor(25.2058, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6392, dtype=torch.float64) delta_t tensor(-0.6914, dtype=torch.float64)
3 gae_duplicate tensor(-1.3452, dtype=torch.float64) tensor(10.8426, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3921, dtype=torch.float64) delta_t tensor(-0.4483, dtype=torch.float64)
2 gae_duplicate tensor(-1.5802, dtype=torch.float64) tensor(7.3480, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-831.8529663085938
value loss:212.04339599609375
entropies:218.01678466796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0193870067596436 seconds
19 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(0.7067, dtype=torch.float64)
19 gae_duplicate tensor(0.6441, dtype=torch.float64) tensor(-8.5562, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8178, dtype=torch.float64) delta_t tensor(0.7137, dtype=torch.float64)
18 gae_duplicate tensor(0.7041, dtype=torch.float64) tensor(-8.7476, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8198, dtype=torch.float64) delta_t tensor(0.7174, dtype=torch.float64)
17 gae_duplicate tensor(0.6332, dtype=torch.float64) tensor(-10.4427, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8218, dtype=torch.float64) delta_t tensor(0.7320, dtype=torch.float64)
16 gae_duplicate tensor(0.6813, dtype=torch.float64) tensor(-10.7963, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8239, dtype=torch.float64) delta_t tensor(0.7504, dtype=torch.float64)
15 gae_duplicate tensor(0.7678, dtype=torch.float64) tensor(-10.3120, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7247, dtype=torch.float64) delta_t tensor(0.6460, dtype=torch.float64)
14 gae_duplicate tensor(0.2491, dtype=torch.float64) tensor(-8.6893, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6229, dtype=torch.float64) delta_t tensor(0.5729, dtype=torch.float64)
13 gae_duplicate tensor(-0.1424, dtype=torch.float64) tensor(-8.3927, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5977, dtype=torch.float64) delta_t tensor(0.4989, dtype=torch.float64)
12 gae_duplicate tensor(-0.3314, dtype=torch.float64) tensor(-5.8866, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4678, dtype=torch.float64) delta_t tensor(0.3756, dtype=torch.float64)
11 gae_duplicate tensor(-0.3041, dtype=torch.float64) tensor(-5.1207, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3429, dtype=torch.float64) delta_t tensor(0.2585, dtype=torch.float64)
10 gae_duplicate tensor(-0.6395, dtype=torch.float64) tensor(-3.4331, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4258, dtype=torch.float64) delta_t tensor(-0.5040, dtype=torch.float64)
9 gae_duplicate tensor(-2.2235, dtype=torch.float64) tensor(4.6524, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1572, dtype=torch.float64) delta_t tensor(-0.2010, dtype=torch.float64)
8 gae_duplicate tensor(-0.9916, dtype=torch.float64) tensor(2.5348, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6199, dtype=torch.float64) delta_t tensor(-0.7481, dtype=torch.float64)
7 gae_duplicate tensor(-2.5097, dtype=torch.float64) tensor(8.2319, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0085, dtype=torch.float64) delta_t tensor(-0.1240, dtype=torch.float64)
6 gae_duplicate tensor(-1.3294, dtype=torch.float64) tensor(2.2438, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3661, dtype=torch.float64) delta_t tensor(-1.4827, dtype=torch.float64)
5 gae_duplicate tensor(-2.5582, dtype=torch.float64) tensor(17.0589, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9967, dtype=torch.float64) delta_t tensor(-1.1527, dtype=torch.float64)
4 gae_duplicate tensor(-4.4565, dtype=torch.float64) tensor(14.0634, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5646, dtype=torch.float64) delta_t tensor(-0.5694, dtype=torch.float64)
3 gae_duplicate tensor(-1.6645, dtype=torch.float64) tensor(9.7554, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7633, dtype=torch.float64) delta_t tensor(-0.7341, dtype=torch.float64)
2 gae_duplicate tensor(-1.4674, dtype=torch.float64) tensor(9.3504, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:410.271240234375
value loss:157.07020568847656
entropies:217.93922424316406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.706751823425293 seconds
19 rew tensor(0.7694, dtype=torch.float64) delta_t tensor(0.7276, dtype=torch.float64)
19 gae_duplicate tensor(0.5990, dtype=torch.float64) tensor(-8.7592, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7250, dtype=torch.float64) delta_t tensor(0.6937, dtype=torch.float64)
18 gae_duplicate tensor(0.4325, dtype=torch.float64) tensor(-9.3664, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6248, dtype=torch.float64) delta_t tensor(0.6001, dtype=torch.float64)
17 gae_duplicate tensor(0.1421, dtype=torch.float64) tensor(-7.7733, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4782, dtype=torch.float64) delta_t tensor(0.4098, dtype=torch.float64)
16 gae_duplicate tensor(-0.6944, dtype=torch.float64) tensor(-6.9305, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5261, dtype=torch.float64) delta_t tensor(0.4084, dtype=torch.float64)
15 gae_duplicate tensor(-0.6550, dtype=torch.float64) tensor(-5.1725, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7695, dtype=torch.float64) delta_t tensor(0.6220, dtype=torch.float64)
14 gae_duplicate tensor(0.4950, dtype=torch.float64) tensor(-7.9650, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6452, dtype=torch.float64) delta_t tensor(0.5089, dtype=torch.float64)
13 gae_duplicate tensor(0.1098, dtype=torch.float64) tensor(-6.2734, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5817, dtype=torch.float64) delta_t tensor(0.4896, dtype=torch.float64)
12 gae_duplicate tensor(0.0209, dtype=torch.float64) tensor(-7.5564, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6870, dtype=torch.float64) delta_t tensor(0.6042, dtype=torch.float64)
11 gae_duplicate tensor(0.2143, dtype=torch.float64) tensor(-8.2236, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2680, dtype=torch.float64) delta_t tensor(0.2280, dtype=torch.float64)
10 gae_duplicate tensor(-0.9288, dtype=torch.float64) tensor(-2.2519, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1240, dtype=torch.float64) delta_t tensor(-0.1408, dtype=torch.float64)
9 gae_duplicate tensor(-1.0772, dtype=torch.float64) tensor(0.6696, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0778, dtype=torch.float64) delta_t tensor(0.0207, dtype=torch.float64)
8 gae_duplicate tensor(-0.7587, dtype=torch.float64) tensor(-0.3455, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3996, dtype=torch.float64) delta_t tensor(-0.4562, dtype=torch.float64)
7 gae_duplicate tensor(-0.9452, dtype=torch.float64) tensor(4.5793, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6098, dtype=torch.float64) delta_t tensor(-0.7033, dtype=torch.float64)
6 gae_duplicate tensor(-2.4702, dtype=torch.float64) tensor(9.4147, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0829, dtype=torch.float64) delta_t tensor(-1.2259, dtype=torch.float64)
5 gae_duplicate tensor(-2.1992, dtype=torch.float64) tensor(16.9996, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5614, dtype=torch.float64) delta_t tensor(-1.6417, dtype=torch.float64)
4 gae_duplicate tensor(-6.7488, dtype=torch.float64) tensor(21.6209, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4545, dtype=torch.float64) delta_t tensor(-0.5601, dtype=torch.float64)
3 gae_duplicate tensor(-1.4755, dtype=torch.float64) tensor(8.1975, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8305, dtype=torch.float64) delta_t tensor(-0.7696, dtype=torch.float64)
2 gae_duplicate tensor(-1.3407, dtype=torch.float64) tensor(9.2194, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-41.979103088378906
value loss:176.4923095703125
entropies:216.56500244140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.81346583366394 seconds
19 rew tensor(0.8185, dtype=torch.float64) delta_t tensor(0.7198, dtype=torch.float64)
19 gae_duplicate tensor(0.6944, dtype=torch.float64) tensor(-10.0123, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8203, dtype=torch.float64) delta_t tensor(0.7398, dtype=torch.float64)
18 gae_duplicate tensor(0.7735, dtype=torch.float64) tensor(-7.7107, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(0.7400, dtype=torch.float64)
17 gae_duplicate tensor(0.6886, dtype=torch.float64) tensor(-10.4880, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.7432, dtype=torch.float64)
16 gae_duplicate tensor(0.7027, dtype=torch.float64) tensor(-9.4882, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7988, dtype=torch.float64) delta_t tensor(0.7097, dtype=torch.float64)
15 gae_duplicate tensor(0.7102, dtype=torch.float64) tensor(-8.8257, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7650, dtype=torch.float64) delta_t tensor(0.6909, dtype=torch.float64)
14 gae_duplicate tensor(0.5110, dtype=torch.float64) tensor(-7.5563, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6285, dtype=torch.float64) delta_t tensor(0.5602, dtype=torch.float64)
13 gae_duplicate tensor(0.1909, dtype=torch.float64) tensor(-7.6476, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4936, dtype=torch.float64) delta_t tensor(0.4570, dtype=torch.float64)
12 gae_duplicate tensor(0.1388, dtype=torch.float64) tensor(-7.1493, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5001, dtype=torch.float64) delta_t tensor(0.4464, dtype=torch.float64)
11 gae_duplicate tensor(0.1176, dtype=torch.float64) tensor(-7.2061, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4353, dtype=torch.float64) delta_t tensor(0.3799, dtype=torch.float64)
10 gae_duplicate tensor(-0.1134, dtype=torch.float64) tensor(-5.4408, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1553, dtype=torch.float64) delta_t tensor(-0.2146, dtype=torch.float64)
9 gae_duplicate tensor(-1.6672, dtype=torch.float64) tensor(1.9151, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0596, dtype=torch.float64) delta_t tensor(-0.1237, dtype=torch.float64)
8 gae_duplicate tensor(-0.8599, dtype=torch.float64) tensor(2.5149, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4123, dtype=torch.float64) delta_t tensor(-0.4565, dtype=torch.float64)
7 gae_duplicate tensor(-0.9291, dtype=torch.float64) tensor(6.1750, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0446, dtype=torch.float64) delta_t tensor(-1.1102, dtype=torch.float64)
6 gae_duplicate tensor(-2.2929, dtype=torch.float64) tensor(15.1115, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9975, dtype=torch.float64) delta_t tensor(-1.0325, dtype=torch.float64)
5 gae_duplicate tensor(-1.9851, dtype=torch.float64) tensor(14.4641, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0594, dtype=torch.float64) delta_t tensor(-1.1912, dtype=torch.float64)
4 gae_duplicate tensor(-4.4989, dtype=torch.float64) tensor(15.3058, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4221, dtype=torch.float64) delta_t tensor(-0.4392, dtype=torch.float64)
3 gae_duplicate tensor(-1.3587, dtype=torch.float64) tensor(6.4067, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4439, dtype=torch.float64) delta_t tensor(-0.5262, dtype=torch.float64)
2 gae_duplicate tensor(-1.3389, dtype=torch.float64) tensor(6.8523, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:421.28271484375
value loss:134.51065063476562
entropies:215.4786376953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.836805105209351 seconds
19 rew tensor(0.8021, dtype=torch.float64) delta_t tensor(0.7977, dtype=torch.float64)
19 gae_duplicate tensor(0.7183, dtype=torch.float64) tensor(-10.8320, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7954, dtype=torch.float64) delta_t tensor(0.7923, dtype=torch.float64)
18 gae_duplicate tensor(0.7546, dtype=torch.float64) tensor(-10.4661, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7716, dtype=torch.float64) delta_t tensor(0.7740, dtype=torch.float64)
17 gae_duplicate tensor(0.6512, dtype=torch.float64) tensor(-11.0067, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7392, dtype=torch.float64) delta_t tensor(0.7418, dtype=torch.float64)
16 gae_duplicate tensor(0.6037, dtype=torch.float64) tensor(-9.0079, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6647, dtype=torch.float64) delta_t tensor(0.5870, dtype=torch.float64)
15 gae_duplicate tensor(0.2858, dtype=torch.float64) tensor(-7.0640, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5309, dtype=torch.float64) delta_t tensor(0.4447, dtype=torch.float64)
14 gae_duplicate tensor(-0.3495, dtype=torch.float64) tensor(-4.9327, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7949, dtype=torch.float64) delta_t tensor(0.7058, dtype=torch.float64)
13 gae_duplicate tensor(0.6176, dtype=torch.float64) tensor(-7.9809, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6875, dtype=torch.float64) delta_t tensor(0.5777, dtype=torch.float64)
12 gae_duplicate tensor(0.2493, dtype=torch.float64) tensor(-7.4632, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6046, dtype=torch.float64) delta_t tensor(0.5009, dtype=torch.float64)
11 gae_duplicate tensor(-0.1435, dtype=torch.float64) tensor(-5.9327, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4104, dtype=torch.float64) delta_t tensor(0.3419, dtype=torch.float64)
10 gae_duplicate tensor(-0.2917, dtype=torch.float64) tensor(-5.5677, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7562, dtype=torch.float64) delta_t tensor(-0.7455, dtype=torch.float64)
9 gae_duplicate tensor(-2.4026, dtype=torch.float64) tensor(7.7337, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6110, dtype=torch.float64) delta_t tensor(-0.6443, dtype=torch.float64)
8 gae_duplicate tensor(-2.7869, dtype=torch.float64) tensor(8.9185, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2779, dtype=torch.float64) delta_t tensor(-0.3544, dtype=torch.float64)
7 gae_duplicate tensor(-1.0237, dtype=torch.float64) tensor(4.7669, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9931, dtype=torch.float64) delta_t tensor(-1.0772, dtype=torch.float64)
6 gae_duplicate tensor(-2.1918, dtype=torch.float64) tensor(11.7087, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8448, dtype=torch.float64) delta_t tensor(-1.9946, dtype=torch.float64)
5 gae_duplicate tensor(-3.4752, dtype=torch.float64) tensor(24.7471, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4410, dtype=torch.float64) delta_t tensor(-2.5077, dtype=torch.float64)
4 gae_duplicate tensor(-8.4857, dtype=torch.float64) tensor(30.9582, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8713, dtype=torch.float64) delta_t tensor(-0.8233, dtype=torch.float64)
3 gae_duplicate tensor(-1.8213, dtype=torch.float64) tensor(13.3072, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2109, dtype=torch.float64) delta_t tensor(-0.2875, dtype=torch.float64)
2 gae_duplicate tensor(-1.0582, dtype=torch.float64) tensor(5.0503, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1008.251708984375
value loss:311.12310791015625
entropies:214.05516052246094
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2469.4692)
ToM Target loss= tensor(1805.7012)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.888074159622192 seconds
19 rew tensor(0.7782, dtype=torch.float64) delta_t tensor(0.7194, dtype=torch.float64)
19 gae_duplicate tensor(0.6552, dtype=torch.float64) tensor(-7.7171, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7367, dtype=torch.float64) delta_t tensor(0.6811, dtype=torch.float64)
18 gae_duplicate tensor(0.6191, dtype=torch.float64) tensor(-8.1985, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6793, dtype=torch.float64) delta_t tensor(0.6121, dtype=torch.float64)
17 gae_duplicate tensor(0.4090, dtype=torch.float64) tensor(-8.8146, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5196, dtype=torch.float64) delta_t tensor(0.5438, dtype=torch.float64)
16 gae_duplicate tensor(0.2059, dtype=torch.float64) tensor(-6.8346, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2587, dtype=torch.float64) delta_t tensor(0.1951, dtype=torch.float64)
15 gae_duplicate tensor(-0.6046, dtype=torch.float64) tensor(-2.9412, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5892, dtype=torch.float64) delta_t tensor(0.5347, dtype=torch.float64)
14 gae_duplicate tensor(-0.1017, dtype=torch.float64) tensor(-4.7916, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7488, dtype=torch.float64) delta_t tensor(0.6890, dtype=torch.float64)
13 gae_duplicate tensor(0.5573, dtype=torch.float64) tensor(-7.1293, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7437, dtype=torch.float64) delta_t tensor(0.6505, dtype=torch.float64)
12 gae_duplicate tensor(0.5057, dtype=torch.float64) tensor(-9.0666, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7392, dtype=torch.float64) delta_t tensor(0.6503, dtype=torch.float64)
11 gae_duplicate tensor(0.4658, dtype=torch.float64) tensor(-7.6349, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6366, dtype=torch.float64) delta_t tensor(0.5676, dtype=torch.float64)
10 gae_duplicate tensor(0.3459, dtype=torch.float64) tensor(-8.2045, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7438, dtype=torch.float64) delta_t tensor(-0.7221, dtype=torch.float64)
9 gae_duplicate tensor(-3.7583, dtype=torch.float64) tensor(7.1758, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0589, dtype=torch.float64) delta_t tensor(-1.0675, dtype=torch.float64)
8 gae_duplicate tensor(-2.8653, dtype=torch.float64) tensor(12.7484, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6376, dtype=torch.float64) delta_t tensor(-0.6209, dtype=torch.float64)
7 gae_duplicate tensor(-1.5428, dtype=torch.float64) tensor(9.1917, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2261, dtype=torch.float64) delta_t tensor(-1.2791, dtype=torch.float64)
6 gae_duplicate tensor(-2.3530, dtype=torch.float64) tensor(16.1537, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5071, dtype=torch.float64) delta_t tensor(-1.6258, dtype=torch.float64)
5 gae_duplicate tensor(-3.2114, dtype=torch.float64) tensor(18.7913, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6205, dtype=torch.float64) delta_t tensor(-1.7252, dtype=torch.float64)
4 gae_duplicate tensor(-6.6050, dtype=torch.float64) tensor(23.9081, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8025, dtype=torch.float64) delta_t tensor(-0.8272, dtype=torch.float64)
3 gae_duplicate tensor(-1.7836, dtype=torch.float64) tensor(11.2976, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4348, dtype=torch.float64) delta_t tensor(-0.4382, dtype=torch.float64)
2 gae_duplicate tensor(-0.9175, dtype=torch.float64) tensor(6.2248, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1268.0264892578125
value loss:250.63194274902344
entropies:212.884765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.893815040588379 seconds
19 rew tensor(0.8041, dtype=torch.float64) delta_t tensor(0.7655, dtype=torch.float64)
19 gae_duplicate tensor(0.6498, dtype=torch.float64) tensor(-9.2842, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7881, dtype=torch.float64) delta_t tensor(0.7204, dtype=torch.float64)
18 gae_duplicate tensor(0.6577, dtype=torch.float64) tensor(-11.7396, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7546, dtype=torch.float64) delta_t tensor(0.7191, dtype=torch.float64)
17 gae_duplicate tensor(0.5733, dtype=torch.float64) tensor(-10.3835, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7123, dtype=torch.float64) delta_t tensor(0.6542, dtype=torch.float64)
16 gae_duplicate tensor(0.2674, dtype=torch.float64) tensor(-9.0165, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6088, dtype=torch.float64) delta_t tensor(0.5067, dtype=torch.float64)
15 gae_duplicate tensor(-0.5443, dtype=torch.float64) tensor(-6.2733, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7683, dtype=torch.float64) delta_t tensor(0.7020, dtype=torch.float64)
14 gae_duplicate tensor(0.3764, dtype=torch.float64) tensor(-8.7557, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7114, dtype=torch.float64) delta_t tensor(0.6292, dtype=torch.float64)
13 gae_duplicate tensor(0.3743, dtype=torch.float64) tensor(-8.2680, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5780, dtype=torch.float64) delta_t tensor(0.5075, dtype=torch.float64)
12 gae_duplicate tensor(0.2842, dtype=torch.float64) tensor(-7.0268, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5213, dtype=torch.float64) delta_t tensor(0.4466, dtype=torch.float64)
11 gae_duplicate tensor(0.2677, dtype=torch.float64) tensor(-5.6994, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3061, dtype=torch.float64) delta_t tensor(0.2403, dtype=torch.float64)
10 gae_duplicate tensor(-0.0547, dtype=torch.float64) tensor(-2.9622, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5982, dtype=torch.float64) delta_t tensor(-0.6160, dtype=torch.float64)
9 gae_duplicate tensor(-1.6256, dtype=torch.float64) tensor(7.9736, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4558, dtype=torch.float64) delta_t tensor(-0.4903, dtype=torch.float64)
8 gae_duplicate tensor(-1.2644, dtype=torch.float64) tensor(7.9687, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4348, dtype=torch.float64) delta_t tensor(-0.4762, dtype=torch.float64)
7 gae_duplicate tensor(-1.5066, dtype=torch.float64) tensor(8.2682, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0294, dtype=torch.float64) delta_t tensor(-0.0934, dtype=torch.float64)
6 gae_duplicate tensor(-1.1024, dtype=torch.float64) tensor(1.7026, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0557, dtype=torch.float64) delta_t tensor(-1.1252, dtype=torch.float64)
5 gae_duplicate tensor(-1.6216, dtype=torch.float64) tensor(13.5146, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7439, dtype=torch.float64) delta_t tensor(-0.8679, dtype=torch.float64)
4 gae_duplicate tensor(-4.9591, dtype=torch.float64) tensor(9.0590, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7536, dtype=torch.float64) delta_t tensor(-0.8198, dtype=torch.float64)
3 gae_duplicate tensor(-1.6718, dtype=torch.float64) tensor(11.0274, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3823, dtype=torch.float64) delta_t tensor(-0.4365, dtype=torch.float64)
2 gae_duplicate tensor(-0.9961, dtype=torch.float64) tensor(7.6056, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:404.0257568359375
value loss:137.08473205566406
entropies:213.30775451660156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.93847393989563 seconds
19 rew tensor(0.3372, dtype=torch.float64) delta_t tensor(0.2778, dtype=torch.float64)
19 gae_duplicate tensor(-0.8068, dtype=torch.float64) tensor(-3.7912, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7960, dtype=torch.float64) delta_t tensor(0.7306, dtype=torch.float64)
18 gae_duplicate tensor(0.5726, dtype=torch.float64) tensor(-8.1248, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7890, dtype=torch.float64) delta_t tensor(0.7526, dtype=torch.float64)
17 gae_duplicate tensor(0.6995, dtype=torch.float64) tensor(-8.8780, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7652, dtype=torch.float64) delta_t tensor(0.6927, dtype=torch.float64)
16 gae_duplicate tensor(0.5255, dtype=torch.float64) tensor(-9.1243, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6813, dtype=torch.float64) delta_t tensor(0.6336, dtype=torch.float64)
15 gae_duplicate tensor(0.2701, dtype=torch.float64) tensor(-7.7284, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5993, dtype=torch.float64) delta_t tensor(0.5555, dtype=torch.float64)
14 gae_duplicate tensor(-0.4564, dtype=torch.float64) tensor(-6.6876, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7248, dtype=torch.float64) delta_t tensor(0.7009, dtype=torch.float64)
13 gae_duplicate tensor(0.6240, dtype=torch.float64) tensor(-9.5659, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1707, dtype=torch.float64) delta_t tensor(0.1124, dtype=torch.float64)
12 gae_duplicate tensor(-2.4303, dtype=torch.float64) tensor(-1.3040, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4542, dtype=torch.float64) delta_t tensor(0.4220, dtype=torch.float64)
11 gae_duplicate tensor(-0.8805, dtype=torch.float64) tensor(-5.6851, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4712, dtype=torch.float64) delta_t tensor(0.4395, dtype=torch.float64)
10 gae_duplicate tensor(-0.2119, dtype=torch.float64) tensor(-5.0534, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5686, dtype=torch.float64) delta_t tensor(-0.5448, dtype=torch.float64)
9 gae_duplicate tensor(-2.5284, dtype=torch.float64) tensor(4.1001, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4935, dtype=torch.float64) delta_t tensor(-0.5207, dtype=torch.float64)
8 gae_duplicate tensor(-1.6685, dtype=torch.float64) tensor(7.0647, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7655, dtype=torch.float64) delta_t tensor(-0.7837, dtype=torch.float64)
7 gae_duplicate tensor(-3.0172, dtype=torch.float64) tensor(12.2108, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6214, dtype=torch.float64) delta_t tensor(-0.6702, dtype=torch.float64)
6 gae_duplicate tensor(-1.8071, dtype=torch.float64) tensor(8.8093, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0903, dtype=torch.float64) delta_t tensor(-2.2081, dtype=torch.float64)
5 gae_duplicate tensor(-3.8077, dtype=torch.float64) tensor(24.9242, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3114, dtype=torch.float64) delta_t tensor(-1.3875, dtype=torch.float64)
4 gae_duplicate tensor(-5.8234, dtype=torch.float64) tensor(23.0102, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4500, dtype=torch.float64) delta_t tensor(-0.4808, dtype=torch.float64)
3 gae_duplicate tensor(-1.1306, dtype=torch.float64) tensor(8.2322, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4013, dtype=torch.float64) delta_t tensor(-0.4264, dtype=torch.float64)
2 gae_duplicate tensor(-1.1383, dtype=torch.float64) tensor(5.2715, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1034.56396484375
value loss:238.32000732421875
entropies:211.53858947753906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.914696931838989 seconds
19 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.7370, dtype=torch.float64)
19 gae_duplicate tensor(0.7002, dtype=torch.float64) tensor(-8.4130, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.7666, dtype=torch.float64)
18 gae_duplicate tensor(0.7373, dtype=torch.float64) tensor(-9.4578, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8177, dtype=torch.float64) delta_t tensor(0.7362, dtype=torch.float64)
17 gae_duplicate tensor(0.7812, dtype=torch.float64) tensor(-9.3743, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(0.7534, dtype=torch.float64)
16 gae_duplicate tensor(0.7796, dtype=torch.float64) tensor(-11.5302, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8205, dtype=torch.float64) delta_t tensor(0.7874, dtype=torch.float64)
15 gae_duplicate tensor(0.8473, dtype=torch.float64) tensor(-11.4866, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8220, dtype=torch.float64) delta_t tensor(0.7902, dtype=torch.float64)
14 gae_duplicate tensor(0.8275, dtype=torch.float64) tensor(-11.0046, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7886, dtype=torch.float64) delta_t tensor(0.7314, dtype=torch.float64)
13 gae_duplicate tensor(0.7525, dtype=torch.float64) tensor(-9.2412, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6694, dtype=torch.float64) delta_t tensor(0.6704, dtype=torch.float64)
12 gae_duplicate tensor(0.5051, dtype=torch.float64) tensor(-8.4722, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5776, dtype=torch.float64) delta_t tensor(0.5796, dtype=torch.float64)
11 gae_duplicate tensor(0.0792, dtype=torch.float64) tensor(-8.0278, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3565, dtype=torch.float64) delta_t tensor(0.3450, dtype=torch.float64)
10 gae_duplicate tensor(-0.0573, dtype=torch.float64) tensor(-4.2847, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0179, dtype=torch.float64) delta_t tensor(0.0402, dtype=torch.float64)
9 gae_duplicate tensor(-0.3808, dtype=torch.float64) tensor(-0.6048, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1168, dtype=torch.float64) delta_t tensor(-0.1487, dtype=torch.float64)
8 gae_duplicate tensor(-0.4035, dtype=torch.float64) tensor(1.7575, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3291, dtype=torch.float64) delta_t tensor(-0.3843, dtype=torch.float64)
7 gae_duplicate tensor(-0.7744, dtype=torch.float64) tensor(5.1930, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6080, dtype=torch.float64) delta_t tensor(-0.6459, dtype=torch.float64)
6 gae_duplicate tensor(-1.5214, dtype=torch.float64) tensor(9.3621, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0144, dtype=torch.float64) delta_t tensor(-1.0763, dtype=torch.float64)
5 gae_duplicate tensor(-2.1143, dtype=torch.float64) tensor(13.7023, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1329, dtype=torch.float64) delta_t tensor(-1.1387, dtype=torch.float64)
4 gae_duplicate tensor(-1.9643, dtype=torch.float64) tensor(15.1800, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7554, dtype=torch.float64) delta_t tensor(-0.8208, dtype=torch.float64)
3 gae_duplicate tensor(-1.8286, dtype=torch.float64) tensor(13.4153, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3332, dtype=torch.float64) delta_t tensor(-0.3807, dtype=torch.float64)
2 gae_duplicate tensor(-1.0054, dtype=torch.float64) tensor(5.2094, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:972.7147827148438
value loss:115.4445571899414
entropies:211.5204620361328
Policy training finished
---------------------

gamma: 0.1
training start after waiting for 4.892771005630493 seconds
19 rew tensor(0.7916, dtype=torch.float64) delta_t tensor(0.7784, dtype=torch.float64)
19 gae_duplicate tensor(0.7202, dtype=torch.float64) tensor(-9.8535, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7666, dtype=torch.float64) delta_t tensor(0.7593, dtype=torch.float64)
18 gae_duplicate tensor(0.7513, dtype=torch.float64) tensor(-11.1698, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7500, dtype=torch.float64) delta_t tensor(0.7192, dtype=torch.float64)
17 gae_duplicate tensor(0.6033, dtype=torch.float64) tensor(-9.4174, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6801, dtype=torch.float64) delta_t tensor(0.6508, dtype=torch.float64)
16 gae_duplicate tensor(0.4697, dtype=torch.float64) tensor(-8.3480, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5410, dtype=torch.float64) delta_t tensor(0.5063, dtype=torch.float64)
15 gae_duplicate tensor(0.1343, dtype=torch.float64) tensor(-6.7539, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2785, dtype=torch.float64) delta_t tensor(0.2192, dtype=torch.float64)
14 gae_duplicate tensor(-0.6139, dtype=torch.float64) tensor(-4.1716, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.7695, dtype=torch.float64)
13 gae_duplicate tensor(0.5945, dtype=torch.float64) tensor(-8.8135, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7533, dtype=torch.float64) delta_t tensor(0.6897, dtype=torch.float64)
12 gae_duplicate tensor(0.5232, dtype=torch.float64) tensor(-7.7359, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7106, dtype=torch.float64) delta_t tensor(0.6485, dtype=torch.float64)
11 gae_duplicate tensor(0.4568, dtype=torch.float64) tensor(-8.3811, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4373, dtype=torch.float64) delta_t tensor(0.3747, dtype=torch.float64)
10 gae_duplicate tensor(-0.2439, dtype=torch.float64) tensor(-4.9162, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0387, dtype=torch.float64) delta_t tensor(-0.0393, dtype=torch.float64)
9 gae_duplicate tensor(-0.5267, dtype=torch.float64) tensor(-0.3900, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3545, dtype=torch.float64) delta_t tensor(-0.3327, dtype=torch.float64)
8 gae_duplicate tensor(-2.6776, dtype=torch.float64) tensor(6.1283, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3543, dtype=torch.float64) delta_t tensor(-1.3703, dtype=torch.float64)
7 gae_duplicate tensor(-2.7631, dtype=torch.float64) tensor(18.4872, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.9948, dtype=torch.float64) delta_t tensor(-2.0610, dtype=torch.float64)
6 gae_duplicate tensor(-3.3862, dtype=torch.float64) tensor(24.3237, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0922, dtype=torch.float64) delta_t tensor(-1.1718, dtype=torch.float64)
5 gae_duplicate tensor(-2.7586, dtype=torch.float64) tensor(19.2574, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5710, dtype=torch.float64) delta_t tensor(-1.6032, dtype=torch.float64)
4 gae_duplicate tensor(-3.2881, dtype=torch.float64) tensor(17.8270, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5992, dtype=torch.float64) delta_t tensor(-0.5861, dtype=torch.float64)
3 gae_duplicate tensor(-1.4269, dtype=torch.float64) tensor(8.8787, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4320, dtype=torch.float64) delta_t tensor(-0.4414, dtype=torch.float64)
2 gae_duplicate tensor(-1.0004, dtype=torch.float64) tensor(6.3371, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-804.1487426757812
value loss:209.0411376953125
entropies:209.80084228515625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2459.7952)
ToM Target loss= tensor(1806.5981)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.818728923797607 seconds
19 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(0.7526, dtype=torch.float64)
19 gae_duplicate tensor(0.6577, dtype=torch.float64) tensor(-8.6305, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7856, dtype=torch.float64) delta_t tensor(0.7207, dtype=torch.float64)
18 gae_duplicate tensor(0.7477, dtype=torch.float64) tensor(-9.6536, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7613, dtype=torch.float64) delta_t tensor(0.7167, dtype=torch.float64)
17 gae_duplicate tensor(0.7349, dtype=torch.float64) tensor(-10.4141, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7098, dtype=torch.float64) delta_t tensor(0.7024, dtype=torch.float64)
16 gae_duplicate tensor(0.6581, dtype=torch.float64) tensor(-9.4720, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5856, dtype=torch.float64) delta_t tensor(0.5193, dtype=torch.float64)
15 gae_duplicate tensor(0.1981, dtype=torch.float64) tensor(-5.5702, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3906, dtype=torch.float64) delta_t tensor(0.4134, dtype=torch.float64)
14 gae_duplicate tensor(-0.2517, dtype=torch.float64) tensor(-5.3550, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7305, dtype=torch.float64) delta_t tensor(0.7368, dtype=torch.float64)
13 gae_duplicate tensor(0.5011, dtype=torch.float64) tensor(-8.4410, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7223, dtype=torch.float64) delta_t tensor(0.6926, dtype=torch.float64)
12 gae_duplicate tensor(0.2584, dtype=torch.float64) tensor(-8.9590, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3109, dtype=torch.float64) delta_t tensor(0.3021, dtype=torch.float64)
11 gae_duplicate tensor(-1.1786, dtype=torch.float64) tensor(-3.6501, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3984, dtype=torch.float64) delta_t tensor(0.3037, dtype=torch.float64)
10 gae_duplicate tensor(-0.1063, dtype=torch.float64) tensor(-3.6379, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1074, dtype=torch.float64) delta_t tensor(0.1318, dtype=torch.float64)
9 gae_duplicate tensor(-0.4841, dtype=torch.float64) tensor(-1.5353, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0014, dtype=torch.float64) delta_t tensor(0.0242, dtype=torch.float64)
8 gae_duplicate tensor(-0.6311, dtype=torch.float64) tensor(-0.7544, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4874, dtype=torch.float64) delta_t tensor(-0.4913, dtype=torch.float64)
7 gae_duplicate tensor(-2.4730, dtype=torch.float64) tensor(7.1895, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2331, dtype=torch.float64) delta_t tensor(-1.2835, dtype=torch.float64)
6 gae_duplicate tensor(-2.8306, dtype=torch.float64) tensor(14.0222, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3955, dtype=torch.float64) delta_t tensor(-0.4641, dtype=torch.float64)
5 gae_duplicate tensor(-1.5658, dtype=torch.float64) tensor(6.6504, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1392, dtype=torch.float64) delta_t tensor(-1.1718, dtype=torch.float64)
4 gae_duplicate tensor(-2.0520, dtype=torch.float64) tensor(12.5378, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2286, dtype=torch.float64) delta_t tensor(-0.2282, dtype=torch.float64)
3 gae_duplicate tensor(-1.3008, dtype=torch.float64) tensor(4.4705, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6474, dtype=torch.float64) delta_t tensor(-0.6079, dtype=torch.float64)
2 gae_duplicate tensor(-1.1659, dtype=torch.float64) tensor(8.2133, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:789.9341430664062
value loss:121.28108978271484
entropies:209.3772430419922
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.840018033981323 seconds
19 rew tensor(0.8079, dtype=torch.float64) delta_t tensor(0.7651, dtype=torch.float64)
19 gae_duplicate tensor(0.7428, dtype=torch.float64) tensor(-8.8342, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7903, dtype=torch.float64) delta_t tensor(0.7171, dtype=torch.float64)
18 gae_duplicate tensor(0.6351, dtype=torch.float64) tensor(-9.1410, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7450, dtype=torch.float64) delta_t tensor(0.7013, dtype=torch.float64)
17 gae_duplicate tensor(0.5898, dtype=torch.float64) tensor(-10.5740, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6820, dtype=torch.float64) delta_t tensor(0.6225, dtype=torch.float64)
16 gae_duplicate tensor(0.2503, dtype=torch.float64) tensor(-7.2942, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5628, dtype=torch.float64) delta_t tensor(0.4647, dtype=torch.float64)
15 gae_duplicate tensor(-0.4793, dtype=torch.float64) tensor(-5.1159, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6818, dtype=torch.float64) delta_t tensor(0.6374, dtype=torch.float64)
14 gae_duplicate tensor(0.3105, dtype=torch.float64) tensor(-7.1753, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5777, dtype=torch.float64) delta_t tensor(0.5533, dtype=torch.float64)
13 gae_duplicate tensor(0.2208, dtype=torch.float64) tensor(-8.2341, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5075, dtype=torch.float64) delta_t tensor(0.4466, dtype=torch.float64)
12 gae_duplicate tensor(0.3679, dtype=torch.float64) tensor(-6.0576, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0750, dtype=torch.float64) delta_t tensor(-0.1284, dtype=torch.float64)
11 gae_duplicate tensor(-2.8565, dtype=torch.float64) tensor(1.7483, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0641, dtype=torch.float64) delta_t tensor(-0.0622, dtype=torch.float64)
10 gae_duplicate tensor(-2.1173, dtype=torch.float64) tensor(-0.7111, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3562, dtype=torch.float64) delta_t tensor(-0.3149, dtype=torch.float64)
9 gae_duplicate tensor(-1.4787, dtype=torch.float64) tensor(4.6775, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4011, dtype=torch.float64) delta_t tensor(-0.3710, dtype=torch.float64)
8 gae_duplicate tensor(-1.4887, dtype=torch.float64) tensor(5.1716, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3691, dtype=torch.float64) delta_t tensor(-0.3561, dtype=torch.float64)
7 gae_duplicate tensor(-0.8687, dtype=torch.float64) tensor(3.9479, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0387, dtype=torch.float64) delta_t tensor(-1.0998, dtype=torch.float64)
6 gae_duplicate tensor(-3.3007, dtype=torch.float64) tensor(11.7758, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0669, dtype=torch.float64) delta_t tensor(-1.1149, dtype=torch.float64)
5 gae_duplicate tensor(-2.2692, dtype=torch.float64) tensor(16.3769, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8594, dtype=torch.float64) delta_t tensor(-0.8800, dtype=torch.float64)
4 gae_duplicate tensor(-3.0322, dtype=torch.float64) tensor(10.7802, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7792, dtype=torch.float64) delta_t tensor(-0.8124, dtype=torch.float64)
3 gae_duplicate tensor(-1.4677, dtype=torch.float64) tensor(10.0386, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5985, dtype=torch.float64) delta_t tensor(-0.6571, dtype=torch.float64)
2 gae_duplicate tensor(-1.5303, dtype=torch.float64) tensor(9.5886, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-432.3564758300781
value loss:152.09735107421875
entropies:208.39080810546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.733335018157959 seconds
19 rew tensor(0.7443, dtype=torch.float64) delta_t tensor(0.7180, dtype=torch.float64)
19 gae_duplicate tensor(0.4720, dtype=torch.float64) tensor(-6.0800, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6775, dtype=torch.float64) delta_t tensor(0.6590, dtype=torch.float64)
18 gae_duplicate tensor(0.1937, dtype=torch.float64) tensor(-8.6747, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5399, dtype=torch.float64) delta_t tensor(0.5123, dtype=torch.float64)
17 gae_duplicate tensor(-0.5461, dtype=torch.float64) tensor(-7.6397, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6961, dtype=torch.float64) delta_t tensor(0.6756, dtype=torch.float64)
16 gae_duplicate tensor(0.1742, dtype=torch.float64) tensor(-8.7530, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5502, dtype=torch.float64) delta_t tensor(0.5237, dtype=torch.float64)
15 gae_duplicate tensor(-0.6461, dtype=torch.float64) tensor(-7.7087, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7468, dtype=torch.float64) delta_t tensor(0.7361, dtype=torch.float64)
14 gae_duplicate tensor(0.6701, dtype=torch.float64) tensor(-10.0984, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7751, dtype=torch.float64) delta_t tensor(0.7455, dtype=torch.float64)
13 gae_duplicate tensor(0.6156, dtype=torch.float64) tensor(-9.0432, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6998, dtype=torch.float64) delta_t tensor(0.6601, dtype=torch.float64)
12 gae_duplicate tensor(0.6410, dtype=torch.float64) tensor(-7.8197, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6725, dtype=torch.float64) delta_t tensor(0.6376, dtype=torch.float64)
11 gae_duplicate tensor(0.4687, dtype=torch.float64) tensor(-7.6159, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3640, dtype=torch.float64) delta_t tensor(0.3492, dtype=torch.float64)
10 gae_duplicate tensor(-0.2791, dtype=torch.float64) tensor(-5.1735, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6106, dtype=torch.float64) delta_t tensor(-0.6035, dtype=torch.float64)
9 gae_duplicate tensor(-2.4281, dtype=torch.float64) tensor(6.1529, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3937, dtype=torch.float64) delta_t tensor(-0.3906, dtype=torch.float64)
8 gae_duplicate tensor(-2.9931, dtype=torch.float64) tensor(6.5815, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9617, dtype=torch.float64) delta_t tensor(-0.9831, dtype=torch.float64)
7 gae_duplicate tensor(-1.8161, dtype=torch.float64) tensor(15.1628, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9382, dtype=torch.float64) delta_t tensor(-0.9872, dtype=torch.float64)
6 gae_duplicate tensor(-2.3105, dtype=torch.float64) tensor(12.7656, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.2375, dtype=torch.float64) delta_t tensor(-2.2781, dtype=torch.float64)
5 gae_duplicate tensor(-3.3704, dtype=torch.float64) tensor(27.8352, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1709, dtype=torch.float64) delta_t tensor(-3.1963, dtype=torch.float64)
4 gae_duplicate tensor(-8.2311, dtype=torch.float64) tensor(40.0014, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5820, dtype=torch.float64) delta_t tensor(-0.6129, dtype=torch.float64)
3 gae_duplicate tensor(-2.0994, dtype=torch.float64) tensor(12.6609, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2461, dtype=torch.float64) delta_t tensor(-0.2358, dtype=torch.float64)
2 gae_duplicate tensor(-1.0700, dtype=torch.float64) tensor(3.9897, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1712.8585205078125
value loss:348.9670104980469
entropies:207.22250366210938
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.817023992538452 seconds
19 rew tensor(0.8221, dtype=torch.float64) delta_t tensor(0.7233, dtype=torch.float64)
19 gae_duplicate tensor(0.5911, dtype=torch.float64) tensor(-7.9016, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8233, dtype=torch.float64) delta_t tensor(0.7530, dtype=torch.float64)
18 gae_duplicate tensor(0.7341, dtype=torch.float64) tensor(-7.7082, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8245, dtype=torch.float64) delta_t tensor(0.7905, dtype=torch.float64)
17 gae_duplicate tensor(0.7833, dtype=torch.float64) tensor(-9.3479, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.7817, dtype=torch.float64)
16 gae_duplicate tensor(0.7900, dtype=torch.float64) tensor(-8.6936, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8078, dtype=torch.float64) delta_t tensor(0.7801, dtype=torch.float64)
15 gae_duplicate tensor(0.7111, dtype=torch.float64) tensor(-8.6557, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7572, dtype=torch.float64) delta_t tensor(0.7641, dtype=torch.float64)
14 gae_duplicate tensor(0.6710, dtype=torch.float64) tensor(-9.0712, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5602, dtype=torch.float64) delta_t tensor(0.5598, dtype=torch.float64)
13 gae_duplicate tensor(0.4185, dtype=torch.float64) tensor(-6.3649, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6275, dtype=torch.float64) delta_t tensor(0.6348, dtype=torch.float64)
12 gae_duplicate tensor(0.4478, dtype=torch.float64) tensor(-7.3539, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6205, dtype=torch.float64) delta_t tensor(0.6577, dtype=torch.float64)
11 gae_duplicate tensor(0.3330, dtype=torch.float64) tensor(-9.6917, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3125, dtype=torch.float64) delta_t tensor(0.2999, dtype=torch.float64)
10 gae_duplicate tensor(-0.2577, dtype=torch.float64) tensor(-3.1600, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2858, dtype=torch.float64) delta_t tensor(0.2938, dtype=torch.float64)
9 gae_duplicate tensor(-0.4930, dtype=torch.float64) tensor(-3.9293, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0499, dtype=torch.float64) delta_t tensor(-0.0375, dtype=torch.float64)
8 gae_duplicate tensor(-0.6306, dtype=torch.float64) tensor(-0.0995, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3551, dtype=torch.float64) delta_t tensor(-0.3747, dtype=torch.float64)
7 gae_duplicate tensor(-1.7098, dtype=torch.float64) tensor(5.3849, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5899, dtype=torch.float64) delta_t tensor(-0.6495, dtype=torch.float64)
6 gae_duplicate tensor(-2.2567, dtype=torch.float64) tensor(9.2794, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1811, dtype=torch.float64) delta_t tensor(-1.1699, dtype=torch.float64)
5 gae_duplicate tensor(-2.6795, dtype=torch.float64) tensor(13.8372, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1530, dtype=torch.float64) delta_t tensor(-1.0987, dtype=torch.float64)
4 gae_duplicate tensor(-2.9546, dtype=torch.float64) tensor(16.6187, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8840, dtype=torch.float64) delta_t tensor(-0.9410, dtype=torch.float64)
3 gae_duplicate tensor(-1.4319, dtype=torch.float64) tensor(13.0319, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4362, dtype=torch.float64) delta_t tensor(-0.4737, dtype=torch.float64)
2 gae_duplicate tensor(-1.0254, dtype=torch.float64) tensor(7.4299, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:553.0838623046875
value loss:129.5776824951172
entropies:206.38938903808594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.980679988861084 seconds
19 rew tensor(0.8172, dtype=torch.float64) delta_t tensor(0.7549, dtype=torch.float64)
19 gae_duplicate tensor(0.6359, dtype=torch.float64) tensor(-8.5486, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8014, dtype=torch.float64) delta_t tensor(0.7591, dtype=torch.float64)
18 gae_duplicate tensor(0.7122, dtype=torch.float64) tensor(-8.2437, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8025, dtype=torch.float64) delta_t tensor(0.7848, dtype=torch.float64)
17 gae_duplicate tensor(0.7870, dtype=torch.float64) tensor(-8.8205, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7775, dtype=torch.float64) delta_t tensor(0.7521, dtype=torch.float64)
16 gae_duplicate tensor(0.7207, dtype=torch.float64) tensor(-8.3434, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7190, dtype=torch.float64) delta_t tensor(0.6877, dtype=torch.float64)
15 gae_duplicate tensor(0.4677, dtype=torch.float64) tensor(-9.2475, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5302, dtype=torch.float64) delta_t tensor(0.4597, dtype=torch.float64)
14 gae_duplicate tensor(0.0742, dtype=torch.float64) tensor(-6.7102, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4541, dtype=torch.float64) delta_t tensor(0.4447, dtype=torch.float64)
13 gae_duplicate tensor(-0.0336, dtype=torch.float64) tensor(-4.7683, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5636, dtype=torch.float64) delta_t tensor(0.5861, dtype=torch.float64)
12 gae_duplicate tensor(0.4148, dtype=torch.float64) tensor(-8.1327, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4945, dtype=torch.float64) delta_t tensor(0.4862, dtype=torch.float64)
11 gae_duplicate tensor(-0.0433, dtype=torch.float64) tensor(-5.6304, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3492, dtype=torch.float64) delta_t tensor(0.3535, dtype=torch.float64)
10 gae_duplicate tensor(-0.4759, dtype=torch.float64) tensor(-4.9024, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5694, dtype=torch.float64) delta_t tensor(-0.5788, dtype=torch.float64)
9 gae_duplicate tensor(-1.5469, dtype=torch.float64) tensor(5.4105, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4850, dtype=torch.float64) delta_t tensor(-0.5022, dtype=torch.float64)
8 gae_duplicate tensor(-2.1213, dtype=torch.float64) tensor(4.8836, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5058, dtype=torch.float64) delta_t tensor(-1.5281, dtype=torch.float64)
7 gae_duplicate tensor(-3.3782, dtype=torch.float64) tensor(19.1015, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8698, dtype=torch.float64) delta_t tensor(-0.8999, dtype=torch.float64)
6 gae_duplicate tensor(-1.9236, dtype=torch.float64) tensor(12.5821, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6335, dtype=torch.float64) delta_t tensor(-1.6696, dtype=torch.float64)
5 gae_duplicate tensor(-3.1162, dtype=torch.float64) tensor(22.1035, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0630, dtype=torch.float64) delta_t tensor(-3.0358, dtype=torch.float64)
4 gae_duplicate tensor(-8.2933, dtype=torch.float64) tensor(36.7308, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3952, dtype=torch.float64) delta_t tensor(-0.2877, dtype=torch.float64)
3 gae_duplicate tensor(-1.5052, dtype=torch.float64) tensor(6.9045, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1262, dtype=torch.float64) delta_t tensor(-0.1219, dtype=torch.float64)
2 gae_duplicate tensor(-0.7308, dtype=torch.float64) tensor(1.4144, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1325.041748046875
value loss:326.7408447265625
entropies:204.72698974609375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2460.9263)
ToM Target loss= tensor(1809.1766)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.870479106903076 seconds
19 rew tensor(0.7467, dtype=torch.float64) delta_t tensor(0.6912, dtype=torch.float64)
19 gae_duplicate tensor(0.6255, dtype=torch.float64) tensor(-6.9430, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6673, dtype=torch.float64) delta_t tensor(0.6229, dtype=torch.float64)
18 gae_duplicate tensor(0.5939, dtype=torch.float64) tensor(-7.0520, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4880, dtype=torch.float64) delta_t tensor(0.4508, dtype=torch.float64)
17 gae_duplicate tensor(0.0619, dtype=torch.float64) tensor(-6.9890, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2112, dtype=torch.float64) delta_t tensor(0.1522, dtype=torch.float64)
16 gae_duplicate tensor(-0.6993, dtype=torch.float64) tensor(-1.0903, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5500, dtype=torch.float64) delta_t tensor(0.4940, dtype=torch.float64)
15 gae_duplicate tensor(-0.1747, dtype=torch.float64) tensor(-4.2885, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5582, dtype=torch.float64) delta_t tensor(0.4816, dtype=torch.float64)
14 gae_duplicate tensor(-0.1527, dtype=torch.float64) tensor(-3.5624, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7896, dtype=torch.float64) delta_t tensor(0.7437, dtype=torch.float64)
13 gae_duplicate tensor(0.6291, dtype=torch.float64) tensor(-8.5332, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6897, dtype=torch.float64) delta_t tensor(0.6024, dtype=torch.float64)
12 gae_duplicate tensor(0.3539, dtype=torch.float64) tensor(-7.3574, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3097, dtype=torch.float64) delta_t tensor(-0.3357, dtype=torch.float64)
11 gae_duplicate tensor(-4.8946, dtype=torch.float64) tensor(1.4592, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0072, dtype=torch.float64) delta_t tensor(-0.0454, dtype=torch.float64)
10 gae_duplicate tensor(-2.3929, dtype=torch.float64) tensor(0.7737, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1736, dtype=torch.float64) delta_t tensor(-0.1304, dtype=torch.float64)
9 gae_duplicate tensor(-1.4491, dtype=torch.float64) tensor(3.3361, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1216, dtype=torch.float64) delta_t tensor(-0.0541, dtype=torch.float64)
8 gae_duplicate tensor(-0.7225, dtype=torch.float64) tensor(0.8797, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0945, dtype=torch.float64) delta_t tensor(0.1189, dtype=torch.float64)
7 gae_duplicate tensor(-0.1162, dtype=torch.float64) tensor(-1.1611, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8357, dtype=torch.float64) delta_t tensor(-0.8292, dtype=torch.float64)
6 gae_duplicate tensor(-3.1689, dtype=torch.float64) tensor(5.7154, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5617, dtype=torch.float64) delta_t tensor(-1.5461, dtype=torch.float64)
5 gae_duplicate tensor(-3.9398, dtype=torch.float64) tensor(17.1592, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9267, dtype=torch.float64) delta_t tensor(-0.9174, dtype=torch.float64)
4 gae_duplicate tensor(-2.1880, dtype=torch.float64) tensor(14.2823, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0152, dtype=torch.float64) delta_t tensor(0.0371, dtype=torch.float64)
3 gae_duplicate tensor(-0.3972, dtype=torch.float64) tensor(0.6779, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4875, dtype=torch.float64) delta_t tensor(-0.4869, dtype=torch.float64)
2 gae_duplicate tensor(-1.1113, dtype=torch.float64) tensor(4.6477, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-107.0257797241211
value loss:166.7123565673828
entropies:203.72415161132812
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.82854700088501 seconds
19 rew tensor(0.7866, dtype=torch.float64) delta_t tensor(0.7637, dtype=torch.float64)
19 gae_duplicate tensor(0.6776, dtype=torch.float64) tensor(-8.6900, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4756, dtype=torch.float64) delta_t tensor(0.4183, dtype=torch.float64)
18 gae_duplicate tensor(-0.7215, dtype=torch.float64) tensor(-6.1980, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5851, dtype=torch.float64) delta_t tensor(0.5531, dtype=torch.float64)
17 gae_duplicate tensor(0.0523, dtype=torch.float64) tensor(-7.7387, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4463, dtype=torch.float64) delta_t tensor(0.4022, dtype=torch.float64)
16 gae_duplicate tensor(-0.5554, dtype=torch.float64) tensor(-3.7040, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5410, dtype=torch.float64) delta_t tensor(0.4474, dtype=torch.float64)
15 gae_duplicate tensor(-0.2439, dtype=torch.float64) tensor(-6.1736, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6161, dtype=torch.float64) delta_t tensor(0.5840, dtype=torch.float64)
14 gae_duplicate tensor(0.0438, dtype=torch.float64) tensor(-5.9514, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6389, dtype=torch.float64) delta_t tensor(0.6297, dtype=torch.float64)
13 gae_duplicate tensor(0.3350, dtype=torch.float64) tensor(-8.7825, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3554, dtype=torch.float64) delta_t tensor(0.3104, dtype=torch.float64)
12 gae_duplicate tensor(0.2489, dtype=torch.float64) tensor(-3.9658, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3088, dtype=torch.float64) delta_t tensor(0.2709, dtype=torch.float64)
11 gae_duplicate tensor(0.0039, dtype=torch.float64) tensor(-2.6146, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1409, dtype=torch.float64) delta_t tensor(-0.1604, dtype=torch.float64)
10 gae_duplicate tensor(-0.9325, dtype=torch.float64) tensor(3.3984, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1316, dtype=torch.float64) delta_t tensor(0.1062, dtype=torch.float64)
9 gae_duplicate tensor(-0.5089, dtype=torch.float64) tensor(-0.7485, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2797, dtype=torch.float64) delta_t tensor(-0.3114, dtype=torch.float64)
8 gae_duplicate tensor(-0.7105, dtype=torch.float64) tensor(3.7903, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7770, dtype=torch.float64) delta_t tensor(-0.8057, dtype=torch.float64)
7 gae_duplicate tensor(-2.3869, dtype=torch.float64) tensor(8.0520, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9722, dtype=torch.float64) delta_t tensor(-0.9659, dtype=torch.float64)
6 gae_duplicate tensor(-3.0191, dtype=torch.float64) tensor(15.7536, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8925, dtype=torch.float64) delta_t tensor(-0.9183, dtype=torch.float64)
5 gae_duplicate tensor(-3.1507, dtype=torch.float64) tensor(9.8494, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8620, dtype=torch.float64) delta_t tensor(-1.8333, dtype=torch.float64)
4 gae_duplicate tensor(-8.1396, dtype=torch.float64) tensor(29.7421, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2700, dtype=torch.float64) delta_t tensor(-0.2003, dtype=torch.float64)
3 gae_duplicate tensor(-1.0282, dtype=torch.float64) tensor(6.1350, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8148, dtype=torch.float64) delta_t tensor(-0.7250, dtype=torch.float64)
2 gae_duplicate tensor(-1.1011, dtype=torch.float64) tensor(7.9020, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1118.451171875
value loss:223.4642333984375
entropies:202.51107788085938
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.795161247253418 seconds
19 rew tensor(0.7723, dtype=torch.float64) delta_t tensor(0.7331, dtype=torch.float64)
19 gae_duplicate tensor(0.5902, dtype=torch.float64) tensor(-7.7815, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7535, dtype=torch.float64) delta_t tensor(0.7363, dtype=torch.float64)
18 gae_duplicate tensor(0.6267, dtype=torch.float64) tensor(-8.1697, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6756, dtype=torch.float64) delta_t tensor(0.6557, dtype=torch.float64)
17 gae_duplicate tensor(0.1071, dtype=torch.float64) tensor(-5.4944, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5514, dtype=torch.float64) delta_t tensor(0.4987, dtype=torch.float64)
16 gae_duplicate tensor(-0.6760, dtype=torch.float64) tensor(-8.1334, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7637, dtype=torch.float64) delta_t tensor(0.7053, dtype=torch.float64)
15 gae_duplicate tensor(0.5767, dtype=torch.float64) tensor(-9.0202, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6352, dtype=torch.float64) delta_t tensor(0.5701, dtype=torch.float64)
14 gae_duplicate tensor(0.2402, dtype=torch.float64) tensor(-7.1589, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6420, dtype=torch.float64) delta_t tensor(0.5937, dtype=torch.float64)
13 gae_duplicate tensor(0.1661, dtype=torch.float64) tensor(-9.5164, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5584, dtype=torch.float64) delta_t tensor(0.5077, dtype=torch.float64)
12 gae_duplicate tensor(0.1180, dtype=torch.float64) tensor(-5.7424, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1405, dtype=torch.float64) delta_t tensor(0.1472, dtype=torch.float64)
11 gae_duplicate tensor(-0.9204, dtype=torch.float64) tensor(-4.2238, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3151, dtype=torch.float64) delta_t tensor(0.3069, dtype=torch.float64)
10 gae_duplicate tensor(-0.5843, dtype=torch.float64) tensor(-5.3512, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2720, dtype=torch.float64) delta_t tensor(-0.2327, dtype=torch.float64)
9 gae_duplicate tensor(-1.3845, dtype=torch.float64) tensor(2.1444, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3346, dtype=torch.float64) delta_t tensor(-0.2888, dtype=torch.float64)
8 gae_duplicate tensor(-1.5140, dtype=torch.float64) tensor(2.2660, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0557, dtype=torch.float64) delta_t tensor(-1.0272, dtype=torch.float64)
7 gae_duplicate tensor(-3.8039, dtype=torch.float64) tensor(15.2908, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8205, dtype=torch.float64) delta_t tensor(-0.8129, dtype=torch.float64)
6 gae_duplicate tensor(-2.1770, dtype=torch.float64) tensor(8.2105, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8667, dtype=torch.float64) delta_t tensor(-1.8898, dtype=torch.float64)
5 gae_duplicate tensor(-3.8198, dtype=torch.float64) tensor(22.4880, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4396, dtype=torch.float64) delta_t tensor(-2.4077, dtype=torch.float64)
4 gae_duplicate tensor(-4.4288, dtype=torch.float64) tensor(26.1221, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1021, dtype=torch.float64) delta_t tensor(0.1595, dtype=torch.float64)
3 gae_duplicate tensor(-0.6945, dtype=torch.float64) tensor(1.5504, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6184, dtype=torch.float64) delta_t tensor(-0.5426, dtype=torch.float64)
2 gae_duplicate tensor(-1.1910, dtype=torch.float64) tensor(4.7400, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-475.8041687011719
value loss:236.99191284179688
entropies:199.29638671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.911327123641968 seconds
19 rew tensor(0.7893, dtype=torch.float64) delta_t tensor(0.7516, dtype=torch.float64)
19 gae_duplicate tensor(0.7139, dtype=torch.float64) tensor(-6.6352, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7577, dtype=torch.float64) delta_t tensor(0.7336, dtype=torch.float64)
18 gae_duplicate tensor(0.7016, dtype=torch.float64) tensor(-8.5483, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7427, dtype=torch.float64) delta_t tensor(0.7177, dtype=torch.float64)
17 gae_duplicate tensor(0.6418, dtype=torch.float64) tensor(-7.8389, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6535, dtype=torch.float64) delta_t tensor(0.6019, dtype=torch.float64)
16 gae_duplicate tensor(0.1459, dtype=torch.float64) tensor(-7.1837, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5088, dtype=torch.float64) delta_t tensor(0.5021, dtype=torch.float64)
15 gae_duplicate tensor(-0.3944, dtype=torch.float64) tensor(-5.3370, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5901, dtype=torch.float64) delta_t tensor(0.5474, dtype=torch.float64)
14 gae_duplicate tensor(-0.4526, dtype=torch.float64) tensor(-6.6847, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6231, dtype=torch.float64) delta_t tensor(0.6025, dtype=torch.float64)
13 gae_duplicate tensor(0.2708, dtype=torch.float64) tensor(-8.3290, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5921, dtype=torch.float64) delta_t tensor(0.5638, dtype=torch.float64)
12 gae_duplicate tensor(0.4641, dtype=torch.float64) tensor(-7.5303, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6270, dtype=torch.float64) delta_t tensor(0.6177, dtype=torch.float64)
11 gae_duplicate tensor(0.3660, dtype=torch.float64) tensor(-7.5733, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5050, dtype=torch.float64) delta_t tensor(0.5050, dtype=torch.float64)
10 gae_duplicate tensor(0.0864, dtype=torch.float64) tensor(-6.4463, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3233, dtype=torch.float64) delta_t tensor(-0.2971, dtype=torch.float64)
9 gae_duplicate tensor(-1.3872, dtype=torch.float64) tensor(4.2810, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8699, dtype=torch.float64) delta_t tensor(-0.8705, dtype=torch.float64)
8 gae_duplicate tensor(-2.5926, dtype=torch.float64) tensor(11.4328, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2508, dtype=torch.float64) delta_t tensor(-1.2852, dtype=torch.float64)
7 gae_duplicate tensor(-2.9148, dtype=torch.float64) tensor(16.0027, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3402, dtype=torch.float64) delta_t tensor(-1.4172, dtype=torch.float64)
6 gae_duplicate tensor(-2.2995, dtype=torch.float64) tensor(16.1502, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1468, dtype=torch.float64) delta_t tensor(-1.1259, dtype=torch.float64)
5 gae_duplicate tensor(-3.8761, dtype=torch.float64) tensor(11.9973, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6336, dtype=torch.float64) delta_t tensor(-3.5261, dtype=torch.float64)
4 gae_duplicate tensor(-9.1724, dtype=torch.float64) tensor(35.6731, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1545, dtype=torch.float64) delta_t tensor(0.1539, dtype=torch.float64)
3 gae_duplicate tensor(-1.0018, dtype=torch.float64) tensor(2.2288, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6665, dtype=torch.float64) delta_t tensor(-0.5611, dtype=torch.float64)
2 gae_duplicate tensor(-1.0501, dtype=torch.float64) tensor(6.5804, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1196.2783203125
value loss:365.1346435546875
entropies:198.09228515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.015555143356323 seconds
19 rew tensor(0.8039, dtype=torch.float64) delta_t tensor(0.8046, dtype=torch.float64)
19 gae_duplicate tensor(0.7588, dtype=torch.float64) tensor(-9.3675, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7700, dtype=torch.float64) delta_t tensor(0.7321, dtype=torch.float64)
18 gae_duplicate tensor(0.7162, dtype=torch.float64) tensor(-7.3770, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7110, dtype=torch.float64) delta_t tensor(0.7132, dtype=torch.float64)
17 gae_duplicate tensor(0.5685, dtype=torch.float64) tensor(-9.0088, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5453, dtype=torch.float64) delta_t tensor(0.5107, dtype=torch.float64)
16 gae_duplicate tensor(-0.0267, dtype=torch.float64) tensor(-6.2451, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3897, dtype=torch.float64) delta_t tensor(0.3814, dtype=torch.float64)
15 gae_duplicate tensor(-0.3231, dtype=torch.float64) tensor(-2.7291, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4344, dtype=torch.float64) delta_t tensor(0.4263, dtype=torch.float64)
14 gae_duplicate tensor(-0.3367, dtype=torch.float64) tensor(-3.1723, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5336, dtype=torch.float64) delta_t tensor(0.5361, dtype=torch.float64)
13 gae_duplicate tensor(0.0232, dtype=torch.float64) tensor(-4.8032, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1959, dtype=torch.float64) delta_t tensor(0.1511, dtype=torch.float64)
12 gae_duplicate tensor(-1.4092, dtype=torch.float64) tensor(-2.1358, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3594, dtype=torch.float64) delta_t tensor(0.3653, dtype=torch.float64)
11 gae_duplicate tensor(-0.1668, dtype=torch.float64) tensor(-4.4334, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1750, dtype=torch.float64) delta_t tensor(0.1907, dtype=torch.float64)
10 gae_duplicate tensor(-1.7772, dtype=torch.float64) tensor(-1.3862, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1419, dtype=torch.float64) delta_t tensor(-0.1324, dtype=torch.float64)
9 gae_duplicate tensor(-1.4071, dtype=torch.float64) tensor(0.1273, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2207, dtype=torch.float64) delta_t tensor(-0.2111, dtype=torch.float64)
8 gae_duplicate tensor(-1.7204, dtype=torch.float64) tensor(2.1691, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4413, dtype=torch.float64) delta_t tensor(-0.4327, dtype=torch.float64)
7 gae_duplicate tensor(-0.8378, dtype=torch.float64) tensor(4.3422, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4796, dtype=torch.float64) delta_t tensor(-0.4764, dtype=torch.float64)
6 gae_duplicate tensor(-2.3560, dtype=torch.float64) tensor(4.6125, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1818, dtype=torch.float64) delta_t tensor(-1.2169, dtype=torch.float64)
5 gae_duplicate tensor(-3.3036, dtype=torch.float64) tensor(14.9573, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5264, dtype=torch.float64) delta_t tensor(-1.5031, dtype=torch.float64)
4 gae_duplicate tensor(-8.9018, dtype=torch.float64) tensor(11.4337, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5143, dtype=torch.float64) delta_t tensor(-0.4405, dtype=torch.float64)
3 gae_duplicate tensor(-1.0924, dtype=torch.float64) tensor(4.6125, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6132, dtype=torch.float64) delta_t tensor(-0.5735, dtype=torch.float64)
2 gae_duplicate tensor(-1.3152, dtype=torch.float64) tensor(7.7708, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-12.766284942626953
value loss:234.91954040527344
entropies:197.5427703857422
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2462.6614)
ToM Target loss= tensor(1812.0945)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.192270040512085 seconds
19 rew tensor(0.7760, dtype=torch.float64) delta_t tensor(0.7291, dtype=torch.float64)
19 gae_duplicate tensor(0.5886, dtype=torch.float64) tensor(-7.1479, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7116, dtype=torch.float64) delta_t tensor(0.6855, dtype=torch.float64)
18 gae_duplicate tensor(0.5665, dtype=torch.float64) tensor(-10.8875, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6182, dtype=torch.float64) delta_t tensor(0.6102, dtype=torch.float64)
17 gae_duplicate tensor(0.1239, dtype=torch.float64) tensor(-8.0889, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4588, dtype=torch.float64) delta_t tensor(0.4088, dtype=torch.float64)
16 gae_duplicate tensor(-0.7009, dtype=torch.float64) tensor(-5.0999, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6115, dtype=torch.float64) delta_t tensor(0.5976, dtype=torch.float64)
15 gae_duplicate tensor(-0.3935, dtype=torch.float64) tensor(-10.2643, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8080, dtype=torch.float64) delta_t tensor(0.7639, dtype=torch.float64)
14 gae_duplicate tensor(0.6696, dtype=torch.float64) tensor(-9.5698, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7178, dtype=torch.float64) delta_t tensor(0.6627, dtype=torch.float64)
13 gae_duplicate tensor(0.5650, dtype=torch.float64) tensor(-6.0653, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5648, dtype=torch.float64) delta_t tensor(0.5574, dtype=torch.float64)
12 gae_duplicate tensor(0.3766, dtype=torch.float64) tensor(-6.0641, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1566, dtype=torch.float64) delta_t tensor(0.1524, dtype=torch.float64)
11 gae_duplicate tensor(-1.6859, dtype=torch.float64) tensor(-0.8726, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3554, dtype=torch.float64) delta_t tensor(0.3556, dtype=torch.float64)
10 gae_duplicate tensor(-0.1139, dtype=torch.float64) tensor(-3.1136, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2346, dtype=torch.float64) delta_t tensor(-0.1709, dtype=torch.float64)
9 gae_duplicate tensor(-1.7881, dtype=torch.float64) tensor(0.2754, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1209, dtype=torch.float64) delta_t tensor(0.1269, dtype=torch.float64)
8 gae_duplicate tensor(-0.1283, dtype=torch.float64) tensor(-2.5527, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8283, dtype=torch.float64) delta_t tensor(-0.7659, dtype=torch.float64)
7 gae_duplicate tensor(-3.4274, dtype=torch.float64) tensor(8.2463, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3407, dtype=torch.float64) delta_t tensor(-0.2880, dtype=torch.float64)
6 gae_duplicate tensor(-1.4799, dtype=torch.float64) tensor(2.6567, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5319, dtype=torch.float64) delta_t tensor(-0.4379, dtype=torch.float64)
5 gae_duplicate tensor(-1.7302, dtype=torch.float64) tensor(4.5878, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7767, dtype=torch.float64) delta_t tensor(-0.7792, dtype=torch.float64)
4 gae_duplicate tensor(-1.5596, dtype=torch.float64) tensor(10.7320, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2292, dtype=torch.float64) delta_t tensor(-0.1763, dtype=torch.float64)
3 gae_duplicate tensor(-1.3491, dtype=torch.float64) tensor(2.7389, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6516, dtype=torch.float64) delta_t tensor(-0.6219, dtype=torch.float64)
2 gae_duplicate tensor(-1.0419, dtype=torch.float64) tensor(6.0563, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1204.0390625
value loss:110.92108154296875
entropies:197.55007934570312
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.893064022064209 seconds
19 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(0.7633, dtype=torch.float64)
19 gae_duplicate tensor(0.6780, dtype=torch.float64) tensor(-7.4864, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8159, dtype=torch.float64) delta_t tensor(0.7395, dtype=torch.float64)
18 gae_duplicate tensor(0.7532, dtype=torch.float64) tensor(-8.6679, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(0.7179, dtype=torch.float64)
17 gae_duplicate tensor(0.7164, dtype=torch.float64) tensor(-6.1670, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8178, dtype=torch.float64) delta_t tensor(0.7364, dtype=torch.float64)
16 gae_duplicate tensor(0.7631, dtype=torch.float64) tensor(-7.1682, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8098, dtype=torch.float64) delta_t tensor(0.7605, dtype=torch.float64)
15 gae_duplicate tensor(0.7641, dtype=torch.float64) tensor(-7.5067, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6662, dtype=torch.float64) delta_t tensor(0.6460, dtype=torch.float64)
14 gae_duplicate tensor(0.1846, dtype=torch.float64) tensor(-6.6632, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7162, dtype=torch.float64) delta_t tensor(0.7160, dtype=torch.float64)
13 gae_duplicate tensor(0.6051, dtype=torch.float64) tensor(-7.9814, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7532, dtype=torch.float64) delta_t tensor(0.7268, dtype=torch.float64)
12 gae_duplicate tensor(0.5876, dtype=torch.float64) tensor(-7.9953, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7250, dtype=torch.float64) delta_t tensor(0.7934, dtype=torch.float64)
11 gae_duplicate tensor(0.5801, dtype=torch.float64) tensor(-10.4730, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6513, dtype=torch.float64) delta_t tensor(0.6356, dtype=torch.float64)
10 gae_duplicate tensor(0.5634, dtype=torch.float64) tensor(-9.8020, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1687, dtype=torch.float64) delta_t tensor(0.1268, dtype=torch.float64)
9 gae_duplicate tensor(-0.5263, dtype=torch.float64) tensor(-1.6326, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6335, dtype=torch.float64) delta_t tensor(-0.6593, dtype=torch.float64)
8 gae_duplicate tensor(-1.9026, dtype=torch.float64) tensor(8.7163, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8847, dtype=torch.float64) delta_t tensor(-0.8185, dtype=torch.float64)
7 gae_duplicate tensor(-2.1824, dtype=torch.float64) tensor(12.3001, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7286, dtype=torch.float64) delta_t tensor(-0.7204, dtype=torch.float64)
6 gae_duplicate tensor(-2.1785, dtype=torch.float64) tensor(8.4060, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2562, dtype=torch.float64) delta_t tensor(-1.2179, dtype=torch.float64)
5 gae_duplicate tensor(-3.1020, dtype=torch.float64) tensor(14.2900, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9379, dtype=torch.float64) delta_t tensor(-0.9703, dtype=torch.float64)
4 gae_duplicate tensor(-2.1961, dtype=torch.float64) tensor(8.7193, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7204, dtype=torch.float64) delta_t tensor(-0.6512, dtype=torch.float64)
3 gae_duplicate tensor(-1.3312, dtype=torch.float64) tensor(9.3771, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5461, dtype=torch.float64) delta_t tensor(-0.5245, dtype=torch.float64)
2 gae_duplicate tensor(-1.2770, dtype=torch.float64) tensor(8.5460, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:367.42816162109375
value loss:149.07406616210938
entropies:196.5122833251953
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.299305200576782 seconds
19 rew tensor(0.7822, dtype=torch.float64) delta_t tensor(0.7518, dtype=torch.float64)
19 gae_duplicate tensor(0.6739, dtype=torch.float64) tensor(-5.1758, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7476, dtype=torch.float64) delta_t tensor(0.7213, dtype=torch.float64)
18 gae_duplicate tensor(0.6845, dtype=torch.float64) tensor(-9.1937, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6785, dtype=torch.float64) delta_t tensor(0.6482, dtype=torch.float64)
17 gae_duplicate tensor(0.5018, dtype=torch.float64) tensor(-7.7181, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5384, dtype=torch.float64) delta_t tensor(0.5660, dtype=torch.float64)
16 gae_duplicate tensor(0.1222, dtype=torch.float64) tensor(-7.2355, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2778, dtype=torch.float64) delta_t tensor(0.2315, dtype=torch.float64)
15 gae_duplicate tensor(-0.6498, dtype=torch.float64) tensor(-1.7134, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6576, dtype=torch.float64) delta_t tensor(0.6399, dtype=torch.float64)
14 gae_duplicate tensor(0.0241, dtype=torch.float64) tensor(-7.9367, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7959, dtype=torch.float64) delta_t tensor(0.7897, dtype=torch.float64)
13 gae_duplicate tensor(0.7443, dtype=torch.float64) tensor(-7.6902, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7186, dtype=torch.float64) delta_t tensor(0.6959, dtype=torch.float64)
12 gae_duplicate tensor(0.5223, dtype=torch.float64) tensor(-10.3672, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3360, dtype=torch.float64) delta_t tensor(0.3157, dtype=torch.float64)
11 gae_duplicate tensor(-1.1188, dtype=torch.float64) tensor(-5.9735, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2605, dtype=torch.float64) delta_t tensor(0.2237, dtype=torch.float64)
10 gae_duplicate tensor(-1.4551, dtype=torch.float64) tensor(-0.1613, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6593, dtype=torch.float64) delta_t tensor(-0.6927, dtype=torch.float64)
9 gae_duplicate tensor(-1.6381, dtype=torch.float64) tensor(6.5142, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6057, dtype=torch.float64) delta_t tensor(-0.5744, dtype=torch.float64)
8 gae_duplicate tensor(-2.0234, dtype=torch.float64) tensor(3.4711, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2151, dtype=torch.float64) delta_t tensor(-1.1907, dtype=torch.float64)
7 gae_duplicate tensor(-2.2116, dtype=torch.float64) tensor(9.8404, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.7251, dtype=torch.float64) delta_t tensor(-1.7209, dtype=torch.float64)
6 gae_duplicate tensor(-2.7585, dtype=torch.float64) tensor(20.2800, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6119, dtype=torch.float64) delta_t tensor(-0.6257, dtype=torch.float64)
5 gae_duplicate tensor(-2.7959, dtype=torch.float64) tensor(11.7096, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0179, dtype=torch.float64) delta_t tensor(-1.9803, dtype=torch.float64)
4 gae_duplicate tensor(-4.3195, dtype=torch.float64) tensor(24.8937, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0570, dtype=torch.float64) delta_t tensor(0.0752, dtype=torch.float64)
3 gae_duplicate tensor(-1.6299, dtype=torch.float64) tensor(-0.6378, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3950, dtype=torch.float64) delta_t tensor(-0.3676, dtype=torch.float64)
2 gae_duplicate tensor(-0.7723, dtype=torch.float64) tensor(4.5795, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-664.75146484375
value loss:212.8575439453125
entropies:196.02813720703125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.870130777359009 seconds
19 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.7563, dtype=torch.float64)
19 gae_duplicate tensor(0.6497, dtype=torch.float64) tensor(-8.7721, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(0.7423, dtype=torch.float64)
18 gae_duplicate tensor(0.6339, dtype=torch.float64) tensor(-9.8233, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7914, dtype=torch.float64) delta_t tensor(0.7030, dtype=torch.float64)
17 gae_duplicate tensor(0.7039, dtype=torch.float64) tensor(-8.0329, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7917, dtype=torch.float64) delta_t tensor(0.7156, dtype=torch.float64)
16 gae_duplicate tensor(0.6548, dtype=torch.float64) tensor(-9.4423, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7666, dtype=torch.float64) delta_t tensor(0.7231, dtype=torch.float64)
15 gae_duplicate tensor(0.6039, dtype=torch.float64) tensor(-8.6116, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7074, dtype=torch.float64) delta_t tensor(0.6448, dtype=torch.float64)
14 gae_duplicate tensor(0.3198, dtype=torch.float64) tensor(-9.0462, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7185, dtype=torch.float64) delta_t tensor(0.6943, dtype=torch.float64)
13 gae_duplicate tensor(0.5541, dtype=torch.float64) tensor(-5.9282, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6415, dtype=torch.float64) delta_t tensor(0.6223, dtype=torch.float64)
12 gae_duplicate tensor(0.4774, dtype=torch.float64) tensor(-7.0365, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6539, dtype=torch.float64) delta_t tensor(0.6650, dtype=torch.float64)
11 gae_duplicate tensor(0.4706, dtype=torch.float64) tensor(-7.0966, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5188, dtype=torch.float64) delta_t tensor(0.5198, dtype=torch.float64)
10 gae_duplicate tensor(0.2890, dtype=torch.float64) tensor(-6.0533, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0714, dtype=torch.float64) delta_t tensor(-0.0704, dtype=torch.float64)
9 gae_duplicate tensor(-1.5705, dtype=torch.float64) tensor(-1.4245, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4667, dtype=torch.float64) delta_t tensor(-0.4751, dtype=torch.float64)
8 gae_duplicate tensor(-2.0259, dtype=torch.float64) tensor(6.7267, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8218, dtype=torch.float64) delta_t tensor(-0.8097, dtype=torch.float64)
7 gae_duplicate tensor(-1.6848, dtype=torch.float64) tensor(7.9205, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1394, dtype=torch.float64) delta_t tensor(-1.1437, dtype=torch.float64)
6 gae_duplicate tensor(-3.4261, dtype=torch.float64) tensor(12.3625, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1116, dtype=torch.float64) delta_t tensor(-1.1211, dtype=torch.float64)
5 gae_duplicate tensor(-2.0918, dtype=torch.float64) tensor(15.1326, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4551, dtype=torch.float64) delta_t tensor(-1.3746, dtype=torch.float64)
4 gae_duplicate tensor(-6.1093, dtype=torch.float64) tensor(13.2856, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6413, dtype=torch.float64) delta_t tensor(-0.5251, dtype=torch.float64)
3 gae_duplicate tensor(-1.0380, dtype=torch.float64) tensor(7.0823, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3070, dtype=torch.float64) delta_t tensor(-0.2570, dtype=torch.float64)
2 gae_duplicate tensor(-0.9594, dtype=torch.float64) tensor(3.6203, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:509.617919921875
value loss:199.0454559326172
entropies:196.18739318847656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.71931791305542 seconds
19 rew tensor(0.7748, dtype=torch.float64) delta_t tensor(0.6853, dtype=torch.float64)
19 gae_duplicate tensor(0.4351, dtype=torch.float64) tensor(-6.7156, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7438, dtype=torch.float64) delta_t tensor(0.6714, dtype=torch.float64)
18 gae_duplicate tensor(0.2306, dtype=torch.float64) tensor(-9.2253, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6728, dtype=torch.float64) delta_t tensor(0.6410, dtype=torch.float64)
17 gae_duplicate tensor(0.1556, dtype=torch.float64) tensor(-10.6108, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5288, dtype=torch.float64) delta_t tensor(0.4578, dtype=torch.float64)
16 gae_duplicate tensor(-0.5128, dtype=torch.float64) tensor(-4.3097, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6788, dtype=torch.float64) delta_t tensor(0.6330, dtype=torch.float64)
15 gae_duplicate tensor(0.3245, dtype=torch.float64) tensor(-10.1186, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5508, dtype=torch.float64) delta_t tensor(0.4547, dtype=torch.float64)
14 gae_duplicate tensor(-0.1864, dtype=torch.float64) tensor(-5.1668, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6496, dtype=torch.float64) delta_t tensor(0.5766, dtype=torch.float64)
13 gae_duplicate tensor(0.3166, dtype=torch.float64) tensor(-6.0859, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7434, dtype=torch.float64) delta_t tensor(0.6811, dtype=torch.float64)
12 gae_duplicate tensor(0.6025, dtype=torch.float64) tensor(-8.6245, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6706, dtype=torch.float64) delta_t tensor(0.5923, dtype=torch.float64)
11 gae_duplicate tensor(0.4011, dtype=torch.float64) tensor(-7.3489, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1872, dtype=torch.float64) delta_t tensor(0.1804, dtype=torch.float64)
10 gae_duplicate tensor(-1.4311, dtype=torch.float64) tensor(-4.9698, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9642, dtype=torch.float64) delta_t tensor(-0.9649, dtype=torch.float64)
9 gae_duplicate tensor(-3.2874, dtype=torch.float64) tensor(19.6902, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7405, dtype=torch.float64) delta_t tensor(-0.7262, dtype=torch.float64)
8 gae_duplicate tensor(-2.9304, dtype=torch.float64) tensor(11.5782, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9219, dtype=torch.float64) delta_t tensor(-0.8844, dtype=torch.float64)
7 gae_duplicate tensor(-3.3018, dtype=torch.float64) tensor(10.2890, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2341, dtype=torch.float64) delta_t tensor(-1.2586, dtype=torch.float64)
6 gae_duplicate tensor(-2.9035, dtype=torch.float64) tensor(12.3540, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2219, dtype=torch.float64) delta_t tensor(-1.2384, dtype=torch.float64)
5 gae_duplicate tensor(-2.7127, dtype=torch.float64) tensor(15.3213, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8490, dtype=torch.float64) delta_t tensor(-0.8037, dtype=torch.float64)
4 gae_duplicate tensor(-7.2846, dtype=torch.float64) tensor(3.5402, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4261, dtype=torch.float64) delta_t tensor(-0.3293, dtype=torch.float64)
3 gae_duplicate tensor(-0.8159, dtype=torch.float64) tensor(3.8895, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5851, dtype=torch.float64) delta_t tensor(-0.5607, dtype=torch.float64)
2 gae_duplicate tensor(-1.0746, dtype=torch.float64) tensor(6.4451, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-392.70806884765625
value loss:248.23544311523438
entropies:195.36720275878906
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2488.3574)
ToM Target loss= tensor(1812.5342)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.7905871868133545 seconds
19 rew tensor(0.8179, dtype=torch.float64) delta_t tensor(0.7857, dtype=torch.float64)
19 gae_duplicate tensor(0.6762, dtype=torch.float64) tensor(-9.0404, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8188, dtype=torch.float64) delta_t tensor(0.7180, dtype=torch.float64)
18 gae_duplicate tensor(0.6726, dtype=torch.float64) tensor(-8.2134, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7400, dtype=torch.float64) delta_t tensor(0.6637, dtype=torch.float64)
17 gae_duplicate tensor(0.3144, dtype=torch.float64) tensor(-8.4030, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6868, dtype=torch.float64) delta_t tensor(0.5990, dtype=torch.float64)
16 gae_duplicate tensor(-0.0870, dtype=torch.float64) tensor(-6.0824, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4237, dtype=torch.float64) delta_t tensor(0.4387, dtype=torch.float64)
15 gae_duplicate tensor(-0.3773, dtype=torch.float64) tensor(-6.5635, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5599, dtype=torch.float64) delta_t tensor(0.5544, dtype=torch.float64)
14 gae_duplicate tensor(-0.4665, dtype=torch.float64) tensor(-6.8964, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3565, dtype=torch.float64) delta_t tensor(0.4116, dtype=torch.float64)
13 gae_duplicate tensor(-0.2138, dtype=torch.float64) tensor(-3.6113, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3955, dtype=torch.float64) delta_t tensor(0.4859, dtype=torch.float64)
12 gae_duplicate tensor(0.0484, dtype=torch.float64) tensor(-6.5461, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0960, dtype=torch.float64) delta_t tensor(0.1429, dtype=torch.float64)
11 gae_duplicate tensor(-0.3713, dtype=torch.float64) tensor(-1.8661, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1097, dtype=torch.float64) delta_t tensor(0.0344, dtype=torch.float64)
10 gae_duplicate tensor(-0.4987, dtype=torch.float64) tensor(0.9210, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5209, dtype=torch.float64) delta_t tensor(-0.4951, dtype=torch.float64)
9 gae_duplicate tensor(-1.9196, dtype=torch.float64) tensor(6.9260, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3846, dtype=torch.float64) delta_t tensor(-0.3005, dtype=torch.float64)
8 gae_duplicate tensor(-1.4322, dtype=torch.float64) tensor(4.1770, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0242, dtype=torch.float64) delta_t tensor(0.0039, dtype=torch.float64)
7 gae_duplicate tensor(-1.3633, dtype=torch.float64) tensor(0.3561, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4152, dtype=torch.float64) delta_t tensor(-0.3954, dtype=torch.float64)
6 gae_duplicate tensor(-0.8500, dtype=torch.float64) tensor(2.0639, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4740, dtype=torch.float64) delta_t tensor(-0.4174, dtype=torch.float64)
5 gae_duplicate tensor(-2.0847, dtype=torch.float64) tensor(3.4238, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5718, dtype=torch.float64) delta_t tensor(-0.4848, dtype=torch.float64)
4 gae_duplicate tensor(-2.7651, dtype=torch.float64) tensor(6.2805, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1295, dtype=torch.float64) delta_t tensor(0.2301, dtype=torch.float64)
3 gae_duplicate tensor(-0.3437, dtype=torch.float64) tensor(-2.4840, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4667, dtype=torch.float64) delta_t tensor(-0.4772, dtype=torch.float64)
2 gae_duplicate tensor(-0.8273, dtype=torch.float64) tensor(5.1581, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1058.873779296875
value loss:89.62198638916016
entropies:197.4044952392578
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1496262550354 seconds
19 rew tensor(0.7761, dtype=torch.float64) delta_t tensor(0.6996, dtype=torch.float64)
19 gae_duplicate tensor(0.5893, dtype=torch.float64) tensor(-8.5842, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7205, dtype=torch.float64) delta_t tensor(0.6754, dtype=torch.float64)
18 gae_duplicate tensor(0.5101, dtype=torch.float64) tensor(-11.4903, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6414, dtype=torch.float64) delta_t tensor(0.6018, dtype=torch.float64)
17 gae_duplicate tensor(0.2574, dtype=torch.float64) tensor(-7.2868, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4644, dtype=torch.float64) delta_t tensor(0.4044, dtype=torch.float64)
16 gae_duplicate tensor(-0.7556, dtype=torch.float64) tensor(-4.9895, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5640, dtype=torch.float64) delta_t tensor(0.4511, dtype=torch.float64)
15 gae_duplicate tensor(-0.6050, dtype=torch.float64) tensor(-6.3881, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7679, dtype=torch.float64) delta_t tensor(0.6495, dtype=torch.float64)
14 gae_duplicate tensor(0.5910, dtype=torch.float64) tensor(-6.6189, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5897, dtype=torch.float64) delta_t tensor(0.5472, dtype=torch.float64)
13 gae_duplicate tensor(0.1366, dtype=torch.float64) tensor(-6.4453, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4498, dtype=torch.float64) delta_t tensor(0.4068, dtype=torch.float64)
12 gae_duplicate tensor(-0.5349, dtype=torch.float64) tensor(-3.4034, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0824, dtype=torch.float64) delta_t tensor(0.1186, dtype=torch.float64)
11 gae_duplicate tensor(-2.6097, dtype=torch.float64) tensor(-4.3613, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.8118, dtype=torch.float64) delta_t tensor(-0.7877, dtype=torch.float64)
10 gae_duplicate tensor(-6.4128, dtype=torch.float64) tensor(3.8429, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3163, dtype=torch.float64) delta_t tensor(-0.2944, dtype=torch.float64)
9 gae_duplicate tensor(-1.2377, dtype=torch.float64) tensor(4.3970, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1675, dtype=torch.float64) delta_t tensor(-0.1951, dtype=torch.float64)
8 gae_duplicate tensor(-0.6693, dtype=torch.float64) tensor(2.2117, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6783, dtype=torch.float64) delta_t tensor(-0.6942, dtype=torch.float64)
7 gae_duplicate tensor(-2.7102, dtype=torch.float64) tensor(8.7055, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8587, dtype=torch.float64) delta_t tensor(-0.8421, dtype=torch.float64)
6 gae_duplicate tensor(-2.0470, dtype=torch.float64) tensor(9.2368, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3385, dtype=torch.float64) delta_t tensor(-1.3089, dtype=torch.float64)
5 gae_duplicate tensor(-3.3332, dtype=torch.float64) tensor(16.2611, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2388, dtype=torch.float64) delta_t tensor(-1.1785, dtype=torch.float64)
4 gae_duplicate tensor(-6.1094, dtype=torch.float64) tensor(13.6533, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3105, dtype=torch.float64) delta_t tensor(-0.2676, dtype=torch.float64)
3 gae_duplicate tensor(-0.9177, dtype=torch.float64) tensor(4.0299, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3951, dtype=torch.float64) delta_t tensor(-0.4038, dtype=torch.float64)
2 gae_duplicate tensor(-0.8510, dtype=torch.float64) tensor(4.4890, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-296.8703918457031
value loss:256.39068603515625
entropies:197.4016876220703
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.727395057678223 seconds
19 rew tensor(0.7808, dtype=torch.float64) delta_t tensor(0.6559, dtype=torch.float64)
19 gae_duplicate tensor(0.5471, dtype=torch.float64) tensor(-6.4257, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7544, dtype=torch.float64) delta_t tensor(0.6971, dtype=torch.float64)
18 gae_duplicate tensor(0.5190, dtype=torch.float64) tensor(-9.6969, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6848, dtype=torch.float64) delta_t tensor(0.6046, dtype=torch.float64)
17 gae_duplicate tensor(0.0472, dtype=torch.float64) tensor(-7.3456, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5602, dtype=torch.float64) delta_t tensor(0.4917, dtype=torch.float64)
16 gae_duplicate tensor(-0.6160, dtype=torch.float64) tensor(-5.5444, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7615, dtype=torch.float64) delta_t tensor(0.6736, dtype=torch.float64)
15 gae_duplicate tensor(0.3855, dtype=torch.float64) tensor(-9.0505, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6958, dtype=torch.float64) delta_t tensor(0.6427, dtype=torch.float64)
14 gae_duplicate tensor(0.0400, dtype=torch.float64) tensor(-7.5190, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7884, dtype=torch.float64) delta_t tensor(0.7199, dtype=torch.float64)
13 gae_duplicate tensor(0.6708, dtype=torch.float64) tensor(-11.4226, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6916, dtype=torch.float64) delta_t tensor(0.6167, dtype=torch.float64)
12 gae_duplicate tensor(0.4438, dtype=torch.float64) tensor(-8.4615, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6236, dtype=torch.float64) delta_t tensor(0.5756, dtype=torch.float64)
11 gae_duplicate tensor(0.1746, dtype=torch.float64) tensor(-7.2820, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3415, dtype=torch.float64) delta_t tensor(0.3161, dtype=torch.float64)
10 gae_duplicate tensor(-0.1788, dtype=torch.float64) tensor(-3.0846, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0249, dtype=torch.float64) delta_t tensor(-0.9981, dtype=torch.float64)
9 gae_duplicate tensor(-4.8855, dtype=torch.float64) tensor(11.1466, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5779, dtype=torch.float64) delta_t tensor(-0.5443, dtype=torch.float64)
8 gae_duplicate tensor(-3.2499, dtype=torch.float64) tensor(3.2922, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0711, dtype=torch.float64) delta_t tensor(-0.0956, dtype=torch.float64)
7 gae_duplicate tensor(-0.3438, dtype=torch.float64) tensor(1.5080, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7632, dtype=torch.float64) delta_t tensor(-0.7886, dtype=torch.float64)
6 gae_duplicate tensor(-1.4898, dtype=torch.float64) tensor(6.4393, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3357, dtype=torch.float64) delta_t tensor(-1.2710, dtype=torch.float64)
5 gae_duplicate tensor(-3.1545, dtype=torch.float64) tensor(15.5523, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6370, dtype=torch.float64) delta_t tensor(-0.6016, dtype=torch.float64)
4 gae_duplicate tensor(-3.5625, dtype=torch.float64) tensor(10.4287, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4230, dtype=torch.float64) delta_t tensor(-0.4000, dtype=torch.float64)
3 gae_duplicate tensor(-1.1338, dtype=torch.float64) tensor(4.4568, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4367, dtype=torch.float64) delta_t tensor(-0.4139, dtype=torch.float64)
2 gae_duplicate tensor(-1.2979, dtype=torch.float64) tensor(5.2477, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:603.7242431640625
value loss:172.2528533935547
entropies:198.2071075439453
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.799065113067627 seconds
19 rew tensor(0.7994, dtype=torch.float64) delta_t tensor(0.7222, dtype=torch.float64)
19 gae_duplicate tensor(0.6177, dtype=torch.float64) tensor(-8.1725, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8005, dtype=torch.float64) delta_t tensor(0.7293, dtype=torch.float64)
18 gae_duplicate tensor(0.7033, dtype=torch.float64) tensor(-8.4839, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7676, dtype=torch.float64) delta_t tensor(0.6389, dtype=torch.float64)
17 gae_duplicate tensor(0.5667, dtype=torch.float64) tensor(-8.1532, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7423, dtype=torch.float64) delta_t tensor(0.6674, dtype=torch.float64)
16 gae_duplicate tensor(0.6049, dtype=torch.float64) tensor(-9.3172, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6655, dtype=torch.float64) delta_t tensor(0.5501, dtype=torch.float64)
15 gae_duplicate tensor(0.2242, dtype=torch.float64) tensor(-6.8782, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5386, dtype=torch.float64) delta_t tensor(0.4629, dtype=torch.float64)
14 gae_duplicate tensor(-0.2836, dtype=torch.float64) tensor(-6.9560, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6634, dtype=torch.float64) delta_t tensor(0.5713, dtype=torch.float64)
13 gae_duplicate tensor(0.2068, dtype=torch.float64) tensor(-5.6671, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7262, dtype=torch.float64) delta_t tensor(0.6644, dtype=torch.float64)
12 gae_duplicate tensor(0.2362, dtype=torch.float64) tensor(-7.3923, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7585, dtype=torch.float64) delta_t tensor(0.7066, dtype=torch.float64)
11 gae_duplicate tensor(0.3814, dtype=torch.float64) tensor(-7.3976, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4441, dtype=torch.float64) delta_t tensor(0.4405, dtype=torch.float64)
10 gae_duplicate tensor(-0.3175, dtype=torch.float64) tensor(-6.5431, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0871, dtype=torch.float64) delta_t tensor(-0.0350, dtype=torch.float64)
9 gae_duplicate tensor(-1.4958, dtype=torch.float64) tensor(-1.2173, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0907, dtype=torch.float64) delta_t tensor(-0.1249, dtype=torch.float64)
8 gae_duplicate tensor(-1.9325, dtype=torch.float64) tensor(2.8379, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6328, dtype=torch.float64) delta_t tensor(-0.7475, dtype=torch.float64)
7 gae_duplicate tensor(-1.8011, dtype=torch.float64) tensor(7.0663, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2952, dtype=torch.float64) delta_t tensor(-1.3232, dtype=torch.float64)
6 gae_duplicate tensor(-3.1022, dtype=torch.float64) tensor(12.6565, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3671, dtype=torch.float64) delta_t tensor(-1.3204, dtype=torch.float64)
5 gae_duplicate tensor(-2.8924, dtype=torch.float64) tensor(14.3462, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6224, dtype=torch.float64) delta_t tensor(-1.5377, dtype=torch.float64)
4 gae_duplicate tensor(-4.3886, dtype=torch.float64) tensor(23.7675, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5603, dtype=torch.float64) delta_t tensor(-0.5416, dtype=torch.float64)
3 gae_duplicate tensor(-1.3412, dtype=torch.float64) tensor(8.7846, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4888, dtype=torch.float64) delta_t tensor(-0.4605, dtype=torch.float64)
2 gae_duplicate tensor(-0.8694, dtype=torch.float64) tensor(7.4009, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-60.34470748901367
value loss:177.32626342773438
entropies:198.95188903808594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.86038613319397 seconds
19 rew tensor(0.8076, dtype=torch.float64) delta_t tensor(0.7182, dtype=torch.float64)
19 gae_duplicate tensor(0.6633, dtype=torch.float64) tensor(-7.0706, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7753, dtype=torch.float64) delta_t tensor(0.6874, dtype=torch.float64)
18 gae_duplicate tensor(0.6805, dtype=torch.float64) tensor(-9.3125, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7346, dtype=torch.float64) delta_t tensor(0.6753, dtype=torch.float64)
17 gae_duplicate tensor(0.5244, dtype=torch.float64) tensor(-8.6515, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6855, dtype=torch.float64) delta_t tensor(0.5954, dtype=torch.float64)
16 gae_duplicate tensor(0.1617, dtype=torch.float64) tensor(-7.6256, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5548, dtype=torch.float64) delta_t tensor(0.4289, dtype=torch.float64)
15 gae_duplicate tensor(-0.4497, dtype=torch.float64) tensor(-4.6179, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6833, dtype=torch.float64) delta_t tensor(0.5737, dtype=torch.float64)
14 gae_duplicate tensor(0.0426, dtype=torch.float64) tensor(-8.6890, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7609, dtype=torch.float64) delta_t tensor(0.6757, dtype=torch.float64)
13 gae_duplicate tensor(0.4577, dtype=torch.float64) tensor(-8.9871, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8035, dtype=torch.float64) delta_t tensor(0.6720, dtype=torch.float64)
12 gae_duplicate tensor(0.6251, dtype=torch.float64) tensor(-8.5608, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7958, dtype=torch.float64) delta_t tensor(0.6860, dtype=torch.float64)
11 gae_duplicate tensor(0.6446, dtype=torch.float64) tensor(-8.8722, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6033, dtype=torch.float64) delta_t tensor(0.5611, dtype=torch.float64)
10 gae_duplicate tensor(0.5543, dtype=torch.float64) tensor(-6.9740, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3847, dtype=torch.float64) delta_t tensor(-0.4019, dtype=torch.float64)
9 gae_duplicate tensor(-1.4982, dtype=torch.float64) tensor(3.9035, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4049, dtype=torch.float64) delta_t tensor(-0.4821, dtype=torch.float64)
8 gae_duplicate tensor(-0.9897, dtype=torch.float64) tensor(5.1459, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6721, dtype=torch.float64) delta_t tensor(-0.6861, dtype=torch.float64)
7 gae_duplicate tensor(-1.0188, dtype=torch.float64) tensor(7.8815, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0289, dtype=torch.float64) delta_t tensor(-1.0494, dtype=torch.float64)
6 gae_duplicate tensor(-3.1047, dtype=torch.float64) tensor(12.3513, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2343, dtype=torch.float64) delta_t tensor(-1.2519, dtype=torch.float64)
5 gae_duplicate tensor(-2.6124, dtype=torch.float64) tensor(15.7103, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7061, dtype=torch.float64) delta_t tensor(-2.6698, dtype=torch.float64)
4 gae_duplicate tensor(-7.0141, dtype=torch.float64) tensor(39.0397, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4051, dtype=torch.float64) delta_t tensor(-0.3577, dtype=torch.float64)
3 gae_duplicate tensor(-1.3624, dtype=torch.float64) tensor(7.9120, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4209, dtype=torch.float64) delta_t tensor(-0.4276, dtype=torch.float64)
2 gae_duplicate tensor(-1.2623, dtype=torch.float64) tensor(5.2206, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-677.005615234375
value loss:226.41519165039062
entropies:200.44195556640625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2464.7410)
ToM Target loss= tensor(1812.2987)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.592399835586548 seconds
19 rew tensor(0.8096, dtype=torch.float64) delta_t tensor(0.6368, dtype=torch.float64)
19 gae_duplicate tensor(0.5005, dtype=torch.float64) tensor(-7.8436, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7932, dtype=torch.float64) delta_t tensor(0.6655, dtype=torch.float64)
18 gae_duplicate tensor(0.4404, dtype=torch.float64) tensor(-8.3002, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7596, dtype=torch.float64) delta_t tensor(0.6395, dtype=torch.float64)
17 gae_duplicate tensor(0.3186, dtype=torch.float64) tensor(-8.1140, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7174, dtype=torch.float64) delta_t tensor(0.6163, dtype=torch.float64)
16 gae_duplicate tensor(0.2091, dtype=torch.float64) tensor(-8.0191, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6323, dtype=torch.float64) delta_t tensor(0.5368, dtype=torch.float64)
15 gae_duplicate tensor(-0.3566, dtype=torch.float64) tensor(-6.3060, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7018, dtype=torch.float64) delta_t tensor(0.6297, dtype=torch.float64)
14 gae_duplicate tensor(0.2994, dtype=torch.float64) tensor(-5.8550, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6675, dtype=torch.float64) delta_t tensor(0.6662, dtype=torch.float64)
13 gae_duplicate tensor(0.2047, dtype=torch.float64) tensor(-10.5360, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6088, dtype=torch.float64) delta_t tensor(0.5641, dtype=torch.float64)
12 gae_duplicate tensor(0.2829, dtype=torch.float64) tensor(-8.4866, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4761, dtype=torch.float64) delta_t tensor(0.4454, dtype=torch.float64)
11 gae_duplicate tensor(0.1145, dtype=torch.float64) tensor(-7.0020, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0318, dtype=torch.float64) delta_t tensor(-0.0795, dtype=torch.float64)
10 gae_duplicate tensor(-1.9647, dtype=torch.float64) tensor(-0.2435, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6412, dtype=torch.float64) delta_t tensor(-0.6773, dtype=torch.float64)
9 gae_duplicate tensor(-2.3265, dtype=torch.float64) tensor(10.2047, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6272, dtype=torch.float64) delta_t tensor(-0.5939, dtype=torch.float64)
8 gae_duplicate tensor(-2.7675, dtype=torch.float64) tensor(5.0113, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3160, dtype=torch.float64) delta_t tensor(-0.2727, dtype=torch.float64)
7 gae_duplicate tensor(-1.1225, dtype=torch.float64) tensor(2.7921, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8523, dtype=torch.float64) delta_t tensor(-0.8922, dtype=torch.float64)
6 gae_duplicate tensor(-2.1643, dtype=torch.float64) tensor(9.2348, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8507, dtype=torch.float64) delta_t tensor(-0.7388, dtype=torch.float64)
5 gae_duplicate tensor(-1.8356, dtype=torch.float64) tensor(9.0589, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2712, dtype=torch.float64) delta_t tensor(-0.1815, dtype=torch.float64)
4 gae_duplicate tensor(-1.1997, dtype=torch.float64) tensor(3.3065, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1882, dtype=torch.float64) delta_t tensor(-0.0387, dtype=torch.float64)
3 gae_duplicate tensor(-0.4741, dtype=torch.float64) tensor(1.2847, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4375, dtype=torch.float64) delta_t tensor(-0.4061, dtype=torch.float64)
2 gae_duplicate tensor(-0.9788, dtype=torch.float64) tensor(4.9050, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:860.27734375
value loss:104.48118591308594
entropies:202.28317260742188
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.99673318862915 seconds
19 rew tensor(0.7986, dtype=torch.float64) delta_t tensor(0.6545, dtype=torch.float64)
19 gae_duplicate tensor(0.5606, dtype=torch.float64) tensor(-5.9231, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7817, dtype=torch.float64) delta_t tensor(0.6495, dtype=torch.float64)
18 gae_duplicate tensor(0.5488, dtype=torch.float64) tensor(-7.2210, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7479, dtype=torch.float64) delta_t tensor(0.6451, dtype=torch.float64)
17 gae_duplicate tensor(0.4899, dtype=torch.float64) tensor(-8.4360, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6627, dtype=torch.float64) delta_t tensor(0.5661, dtype=torch.float64)
16 gae_duplicate tensor(0.0447, dtype=torch.float64) tensor(-6.6345, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5253, dtype=torch.float64) delta_t tensor(0.3978, dtype=torch.float64)
15 gae_duplicate tensor(-0.6656, dtype=torch.float64) tensor(-5.3903, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6903, dtype=torch.float64) delta_t tensor(0.6219, dtype=torch.float64)
14 gae_duplicate tensor(0.0447, dtype=torch.float64) tensor(-4.4795, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7844, dtype=torch.float64) delta_t tensor(0.7184, dtype=torch.float64)
13 gae_duplicate tensor(0.7110, dtype=torch.float64) tensor(-9.1241, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7167, dtype=torch.float64) delta_t tensor(0.6440, dtype=torch.float64)
12 gae_duplicate tensor(0.4963, dtype=torch.float64) tensor(-10.8442, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7001, dtype=torch.float64) delta_t tensor(0.6352, dtype=torch.float64)
11 gae_duplicate tensor(0.3545, dtype=torch.float64) tensor(-5.9741, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3566, dtype=torch.float64) delta_t tensor(-0.3311, dtype=torch.float64)
10 gae_duplicate tensor(-4.7475, dtype=torch.float64) tensor(1.4643, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9162, dtype=torch.float64) delta_t tensor(-0.8980, dtype=torch.float64)
9 gae_duplicate tensor(-3.3930, dtype=torch.float64) tensor(9.4230, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0326, dtype=torch.float64) delta_t tensor(-0.0669, dtype=torch.float64)
8 gae_duplicate tensor(-0.9887, dtype=torch.float64) tensor(2.5625, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4982, dtype=torch.float64) delta_t tensor(-0.5923, dtype=torch.float64)
7 gae_duplicate tensor(-2.1424, dtype=torch.float64) tensor(7.3631, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4217, dtype=torch.float64) delta_t tensor(-1.3968, dtype=torch.float64)
6 gae_duplicate tensor(-3.2321, dtype=torch.float64) tensor(20.4629, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1457, dtype=torch.float64) delta_t tensor(-1.1967, dtype=torch.float64)
5 gae_duplicate tensor(-4.0930, dtype=torch.float64) tensor(14.5088, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2843, dtype=torch.float64) delta_t tensor(-1.2759, dtype=torch.float64)
4 gae_duplicate tensor(-6.7252, dtype=torch.float64) tensor(11.5984, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5648, dtype=torch.float64) delta_t tensor(-0.5598, dtype=torch.float64)
3 gae_duplicate tensor(-1.1727, dtype=torch.float64) tensor(8.3778, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2508, dtype=torch.float64) delta_t tensor(-0.2609, dtype=torch.float64)
2 gae_duplicate tensor(-0.4433, dtype=torch.float64) tensor(3.7083, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-592.3687744140625
value loss:256.388427734375
entropies:202.44935607910156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.141120195388794 seconds
19 rew tensor(0.7985, dtype=torch.float64) delta_t tensor(0.6562, dtype=torch.float64)
19 gae_duplicate tensor(0.5227, dtype=torch.float64) tensor(-7.4935, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7652, dtype=torch.float64) delta_t tensor(0.6731, dtype=torch.float64)
18 gae_duplicate tensor(0.5524, dtype=torch.float64) tensor(-8.0687, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7485, dtype=torch.float64) delta_t tensor(0.6396, dtype=torch.float64)
17 gae_duplicate tensor(0.5340, dtype=torch.float64) tensor(-9.0422, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6548, dtype=torch.float64) delta_t tensor(0.5430, dtype=torch.float64)
16 gae_duplicate tensor(0.1883, dtype=torch.float64) tensor(-8.4636, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5076, dtype=torch.float64) delta_t tensor(0.4061, dtype=torch.float64)
15 gae_duplicate tensor(-0.3770, dtype=torch.float64) tensor(-4.7419, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5023, dtype=torch.float64) delta_t tensor(0.3620, dtype=torch.float64)
14 gae_duplicate tensor(-0.2452, dtype=torch.float64) tensor(-3.1293, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6779, dtype=torch.float64) delta_t tensor(0.5996, dtype=torch.float64)
13 gae_duplicate tensor(0.0824, dtype=torch.float64) tensor(-6.5666, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4854, dtype=torch.float64) delta_t tensor(0.4235, dtype=torch.float64)
12 gae_duplicate tensor(-0.3104, dtype=torch.float64) tensor(-5.3786, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1479, dtype=torch.float64) delta_t tensor(0.0195, dtype=torch.float64)
11 gae_duplicate tensor(-1.3595, dtype=torch.float64) tensor(-0.2843, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.9874, dtype=torch.float64) delta_t tensor(-1.0213, dtype=torch.float64)
10 gae_duplicate tensor(-5.9028, dtype=torch.float64) tensor(9.1413, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0394, dtype=torch.float64) delta_t tensor(0.0194, dtype=torch.float64)
9 gae_duplicate tensor(-1.6207, dtype=torch.float64) tensor(2.5526, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1173, dtype=torch.float64) delta_t tensor(-0.1051, dtype=torch.float64)
8 gae_duplicate tensor(-0.9162, dtype=torch.float64) tensor(1.9261, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5450, dtype=torch.float64) delta_t tensor(-0.6384, dtype=torch.float64)
7 gae_duplicate tensor(-1.7232, dtype=torch.float64) tensor(7.8145, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1852, dtype=torch.float64) delta_t tensor(-1.2512, dtype=torch.float64)
6 gae_duplicate tensor(-3.4227, dtype=torch.float64) tensor(11.6084, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1497, dtype=torch.float64) delta_t tensor(-1.1856, dtype=torch.float64)
5 gae_duplicate tensor(-2.8654, dtype=torch.float64) tensor(13.6444, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0986, dtype=torch.float64) delta_t tensor(-1.0907, dtype=torch.float64)
4 gae_duplicate tensor(-5.2473, dtype=torch.float64) tensor(13.6697, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6431, dtype=torch.float64) delta_t tensor(-0.5750, dtype=torch.float64)
3 gae_duplicate tensor(-1.4363, dtype=torch.float64) tensor(8.1129, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5919, dtype=torch.float64) delta_t tensor(-0.5914, dtype=torch.float64)
2 gae_duplicate tensor(-1.5685, dtype=torch.float64) tensor(7.4544, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-855.8046875
value loss:215.68655395507812
entropies:203.35293579101562
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.651772975921631 seconds
19 rew tensor(0.7732, dtype=torch.float64) delta_t tensor(0.5812, dtype=torch.float64)
19 gae_duplicate tensor(0.3460, dtype=torch.float64) tensor(-6.1698, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7402, dtype=torch.float64) delta_t tensor(0.5554, dtype=torch.float64)
18 gae_duplicate tensor(0.1538, dtype=torch.float64) tensor(-6.8726, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6570, dtype=torch.float64) delta_t tensor(0.5362, dtype=torch.float64)
17 gae_duplicate tensor(0.0924, dtype=torch.float64) tensor(-5.4621, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5056, dtype=torch.float64) delta_t tensor(0.3919, dtype=torch.float64)
16 gae_duplicate tensor(-0.5363, dtype=torch.float64) tensor(-4.6848, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6195, dtype=torch.float64) delta_t tensor(0.5052, dtype=torch.float64)
15 gae_duplicate tensor(-0.4188, dtype=torch.float64) tensor(-6.6907, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8095, dtype=torch.float64) delta_t tensor(0.7502, dtype=torch.float64)
14 gae_duplicate tensor(0.6623, dtype=torch.float64) tensor(-9.4601, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7755, dtype=torch.float64) delta_t tensor(0.6687, dtype=torch.float64)
13 gae_duplicate tensor(0.5970, dtype=torch.float64) tensor(-8.6581, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6815, dtype=torch.float64) delta_t tensor(0.5878, dtype=torch.float64)
12 gae_duplicate tensor(0.4761, dtype=torch.float64) tensor(-7.3712, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5879, dtype=torch.float64) delta_t tensor(0.4925, dtype=torch.float64)
11 gae_duplicate tensor(0.1473, dtype=torch.float64) tensor(-5.5737, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0333, dtype=torch.float64) delta_t tensor(-0.1580, dtype=torch.float64)
10 gae_duplicate tensor(-2.4435, dtype=torch.float64) tensor(3.2795, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3524, dtype=torch.float64) delta_t tensor(-0.3998, dtype=torch.float64)
9 gae_duplicate tensor(-1.7527, dtype=torch.float64) tensor(2.6490, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5469, dtype=torch.float64) delta_t tensor(-0.5964, dtype=torch.float64)
8 gae_duplicate tensor(-4.1167, dtype=torch.float64) tensor(7.2939, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1082, dtype=torch.float64) delta_t tensor(-1.0539, dtype=torch.float64)
7 gae_duplicate tensor(-3.5541, dtype=torch.float64) tensor(15.4606, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3306, dtype=torch.float64) delta_t tensor(-0.3790, dtype=torch.float64)
6 gae_duplicate tensor(-2.3294, dtype=torch.float64) tensor(6.8584, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3343, dtype=torch.float64) delta_t tensor(-1.1960, dtype=torch.float64)
5 gae_duplicate tensor(-3.5750, dtype=torch.float64) tensor(13.0903, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9275, dtype=torch.float64) delta_t tensor(-0.9590, dtype=torch.float64)
4 gae_duplicate tensor(-4.2084, dtype=torch.float64) tensor(12.0154, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8536, dtype=torch.float64) delta_t tensor(-0.6953, dtype=torch.float64)
3 gae_duplicate tensor(-1.5684, dtype=torch.float64) tensor(9.5620, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5805, dtype=torch.float64) delta_t tensor(-0.5755, dtype=torch.float64)
2 gae_duplicate tensor(-1.2910, dtype=torch.float64) tensor(7.5524, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-642.3875732421875
value loss:205.23678588867188
entropies:205.1509552001953
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.798344135284424 seconds
19 rew tensor(0.7678, dtype=torch.float64) delta_t tensor(0.5845, dtype=torch.float64)
19 gae_duplicate tensor(0.4571, dtype=torch.float64) tensor(-8.2535, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7076, dtype=torch.float64) delta_t tensor(0.5317, dtype=torch.float64)
18 gae_duplicate tensor(0.3877, dtype=torch.float64) tensor(-5.7686, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6147, dtype=torch.float64) delta_t tensor(0.4656, dtype=torch.float64)
17 gae_duplicate tensor(0.0776, dtype=torch.float64) tensor(-4.6735, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4470, dtype=torch.float64) delta_t tensor(0.3251, dtype=torch.float64)
16 gae_duplicate tensor(-0.5159, dtype=torch.float64) tensor(-3.2197, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6605, dtype=torch.float64) delta_t tensor(0.6068, dtype=torch.float64)
15 gae_duplicate tensor(0.1443, dtype=torch.float64) tensor(-6.9906, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4832, dtype=torch.float64) delta_t tensor(0.4430, dtype=torch.float64)
14 gae_duplicate tensor(-0.3356, dtype=torch.float64) tensor(-5.3356, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7544, dtype=torch.float64) delta_t tensor(0.6869, dtype=torch.float64)
13 gae_duplicate tensor(0.5285, dtype=torch.float64) tensor(-7.2212, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6896, dtype=torch.float64) delta_t tensor(0.6658, dtype=torch.float64)
12 gae_duplicate tensor(0.2583, dtype=torch.float64) tensor(-7.5962, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2497, dtype=torch.float64) delta_t tensor(0.2166, dtype=torch.float64)
11 gae_duplicate tensor(-1.1837, dtype=torch.float64) tensor(-1.2232, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4045, dtype=torch.float64) delta_t tensor(-0.4164, dtype=torch.float64)
10 gae_duplicate tensor(-2.4620, dtype=torch.float64) tensor(2.7953, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2788, dtype=torch.float64) delta_t tensor(-0.3173, dtype=torch.float64)
9 gae_duplicate tensor(-1.6436, dtype=torch.float64) tensor(3.4415, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5239, dtype=torch.float64) delta_t tensor(-0.6068, dtype=torch.float64)
8 gae_duplicate tensor(-2.0567, dtype=torch.float64) tensor(9.0730, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5648, dtype=torch.float64) delta_t tensor(-0.6467, dtype=torch.float64)
7 gae_duplicate tensor(-2.1192, dtype=torch.float64) tensor(6.8218, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5108, dtype=torch.float64) delta_t tensor(-0.5082, dtype=torch.float64)
6 gae_duplicate tensor(-0.9667, dtype=torch.float64) tensor(8.5388, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7847, dtype=torch.float64) delta_t tensor(-0.6954, dtype=torch.float64)
5 gae_duplicate tensor(-2.2831, dtype=torch.float64) tensor(8.0636, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2044, dtype=torch.float64) delta_t tensor(-1.1449, dtype=torch.float64)
4 gae_duplicate tensor(-3.1224, dtype=torch.float64) tensor(14.6721, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0088, dtype=torch.float64) delta_t tensor(0.0906, dtype=torch.float64)
3 gae_duplicate tensor(-1.2825, dtype=torch.float64) tensor(-0.2457, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7757, dtype=torch.float64) delta_t tensor(-0.7147, dtype=torch.float64)
2 gae_duplicate tensor(-1.0200, dtype=torch.float64) tensor(7.2268, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-400.8748474121094
value loss:143.07264709472656
entropies:206.0829315185547
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2476.3311)
ToM Target loss= tensor(1812.6813)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.339816331863403 seconds
19 rew tensor(0.7931, dtype=torch.float64) delta_t tensor(0.6720, dtype=torch.float64)
19 gae_duplicate tensor(0.4208, dtype=torch.float64) tensor(-7.3025, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7857, dtype=torch.float64) delta_t tensor(0.6710, dtype=torch.float64)
18 gae_duplicate tensor(0.4455, dtype=torch.float64) tensor(-10.3150, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7606, dtype=torch.float64) delta_t tensor(0.6151, dtype=torch.float64)
17 gae_duplicate tensor(0.4667, dtype=torch.float64) tensor(-6.8231, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7113, dtype=torch.float64) delta_t tensor(0.5957, dtype=torch.float64)
16 gae_duplicate tensor(0.2377, dtype=torch.float64) tensor(-7.2061, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6046, dtype=torch.float64) delta_t tensor(0.4650, dtype=torch.float64)
15 gae_duplicate tensor(0.0309, dtype=torch.float64) tensor(-4.8871, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3326, dtype=torch.float64) delta_t tensor(0.1888, dtype=torch.float64)
14 gae_duplicate tensor(-0.6334, dtype=torch.float64) tensor(-2.7130, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7013, dtype=torch.float64) delta_t tensor(0.5812, dtype=torch.float64)
13 gae_duplicate tensor(0.4320, dtype=torch.float64) tensor(-6.8283, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7385, dtype=torch.float64) delta_t tensor(0.6061, dtype=torch.float64)
12 gae_duplicate tensor(0.4628, dtype=torch.float64) tensor(-6.3992, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6689, dtype=torch.float64) delta_t tensor(0.5784, dtype=torch.float64)
11 gae_duplicate tensor(0.4472, dtype=torch.float64) tensor(-5.9287, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6825, dtype=torch.float64) delta_t tensor(0.5656, dtype=torch.float64)
10 gae_duplicate tensor(0.3695, dtype=torch.float64) tensor(-7.5040, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0646, dtype=torch.float64) delta_t tensor(0.0355, dtype=torch.float64)
9 gae_duplicate tensor(-1.3054, dtype=torch.float64) tensor(-1.6549, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8529, dtype=torch.float64) delta_t tensor(-0.9536, dtype=torch.float64)
8 gae_duplicate tensor(-2.0658, dtype=torch.float64) tensor(10.9532, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8796, dtype=torch.float64) delta_t tensor(-0.9324, dtype=torch.float64)
7 gae_duplicate tensor(-2.3977, dtype=torch.float64) tensor(12.4665, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.7224, dtype=torch.float64) delta_t tensor(-1.8288, dtype=torch.float64)
6 gae_duplicate tensor(-5.1491, dtype=torch.float64) tensor(15.6871, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3013, dtype=torch.float64) delta_t tensor(-1.3661, dtype=torch.float64)
5 gae_duplicate tensor(-2.7032, dtype=torch.float64) tensor(16.5875, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7454, dtype=torch.float64) delta_t tensor(-0.7408, dtype=torch.float64)
4 gae_duplicate tensor(-2.8140, dtype=torch.float64) tensor(9.8859, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3850, dtype=torch.float64) delta_t tensor(-0.3880, dtype=torch.float64)
3 gae_duplicate tensor(-1.2250, dtype=torch.float64) tensor(7.1364, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2861, dtype=torch.float64) delta_t tensor(-0.2955, dtype=torch.float64)
2 gae_duplicate tensor(-0.5515, dtype=torch.float64) tensor(3.3701, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-343.86248779296875
value loss:189.50790405273438
entropies:205.3814239501953
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.817497968673706 seconds
19 rew tensor(0.7585, dtype=torch.float64) delta_t tensor(0.5411, dtype=torch.float64)
19 gae_duplicate tensor(0.2224, dtype=torch.float64) tensor(-7.2785, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7081, dtype=torch.float64) delta_t tensor(0.5393, dtype=torch.float64)
18 gae_duplicate tensor(0.0897, dtype=torch.float64) tensor(-6.3981, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6083, dtype=torch.float64) delta_t tensor(0.4737, dtype=torch.float64)
17 gae_duplicate tensor(-0.5109, dtype=torch.float64) tensor(-7.0035, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8023, dtype=torch.float64) delta_t tensor(0.7067, dtype=torch.float64)
16 gae_duplicate tensor(0.6412, dtype=torch.float64) tensor(-7.9009, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7946, dtype=torch.float64) delta_t tensor(0.6438, dtype=torch.float64)
15 gae_duplicate tensor(0.5153, dtype=torch.float64) tensor(-8.6279, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7441, dtype=torch.float64) delta_t tensor(0.6137, dtype=torch.float64)
14 gae_duplicate tensor(0.4535, dtype=torch.float64) tensor(-8.8229, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6310, dtype=torch.float64) delta_t tensor(0.5196, dtype=torch.float64)
13 gae_duplicate tensor(0.4156, dtype=torch.float64) tensor(-6.5439, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6910, dtype=torch.float64) delta_t tensor(0.5538, dtype=torch.float64)
12 gae_duplicate tensor(0.4100, dtype=torch.float64) tensor(-7.0118, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5740, dtype=torch.float64) delta_t tensor(0.4575, dtype=torch.float64)
11 gae_duplicate tensor(0.1371, dtype=torch.float64) tensor(-6.2249, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5055, dtype=torch.float64) delta_t tensor(0.4428, dtype=torch.float64)
10 gae_duplicate tensor(-0.0761, dtype=torch.float64) tensor(-5.2818, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7128, dtype=torch.float64) delta_t tensor(-0.7634, dtype=torch.float64)
9 gae_duplicate tensor(-1.4882, dtype=torch.float64) tensor(8.2954, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2516, dtype=torch.float64) delta_t tensor(-1.3277, dtype=torch.float64)
8 gae_duplicate tensor(-2.8055, dtype=torch.float64) tensor(15.3140, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3915, dtype=torch.float64) delta_t tensor(-0.4616, dtype=torch.float64)
7 gae_duplicate tensor(-2.1625, dtype=torch.float64) tensor(7.2229, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9654, dtype=torch.float64) delta_t tensor(-1.0660, dtype=torch.float64)
6 gae_duplicate tensor(-2.9959, dtype=torch.float64) tensor(14.7297, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7913, dtype=torch.float64) delta_t tensor(-1.7107, dtype=torch.float64)
5 gae_duplicate tensor(-3.4537, dtype=torch.float64) tensor(19.5444, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8282, dtype=torch.float64) delta_t tensor(-1.8255, dtype=torch.float64)
4 gae_duplicate tensor(-6.6918, dtype=torch.float64) tensor(32.9857, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5327, dtype=torch.float64) delta_t tensor(-0.5295, dtype=torch.float64)
3 gae_duplicate tensor(-1.3885, dtype=torch.float64) tensor(9.5018, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4735, dtype=torch.float64) delta_t tensor(-0.4358, dtype=torch.float64)
2 gae_duplicate tensor(-1.5077, dtype=torch.float64) tensor(5.8308, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1560.939208984375
value loss:262.3192443847656
entropies:205.78021240234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.120388031005859 seconds
19 rew tensor(0.7968, dtype=torch.float64) delta_t tensor(0.6188, dtype=torch.float64)
19 gae_duplicate tensor(0.5039, dtype=torch.float64) tensor(-7.2688, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7974, dtype=torch.float64) delta_t tensor(0.6414, dtype=torch.float64)
18 gae_duplicate tensor(0.6031, dtype=torch.float64) tensor(-8.0466, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7898, dtype=torch.float64) delta_t tensor(0.6324, dtype=torch.float64)
17 gae_duplicate tensor(0.5668, dtype=torch.float64) tensor(-8.9935, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7738, dtype=torch.float64) delta_t tensor(0.6296, dtype=torch.float64)
16 gae_duplicate tensor(0.4033, dtype=torch.float64) tensor(-8.0356, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7165, dtype=torch.float64) delta_t tensor(0.5953, dtype=torch.float64)
15 gae_duplicate tensor(0.0750, dtype=torch.float64) tensor(-6.3921, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6101, dtype=torch.float64) delta_t tensor(0.5293, dtype=torch.float64)
14 gae_duplicate tensor(-0.4317, dtype=torch.float64) tensor(-8.3445, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6872, dtype=torch.float64) delta_t tensor(0.6260, dtype=torch.float64)
13 gae_duplicate tensor(0.4160, dtype=torch.float64) tensor(-8.1356, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5220, dtype=torch.float64) delta_t tensor(0.5064, dtype=torch.float64)
12 gae_duplicate tensor(0.1021, dtype=torch.float64) tensor(-4.5956, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3581, dtype=torch.float64) delta_t tensor(0.2866, dtype=torch.float64)
11 gae_duplicate tensor(-0.1107, dtype=torch.float64) tensor(-3.9117, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4534, dtype=torch.float64) delta_t tensor(0.3890, dtype=torch.float64)
10 gae_duplicate tensor(-0.1267, dtype=torch.float64) tensor(-5.0402, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0601, dtype=torch.float64) delta_t tensor(-0.0007, dtype=torch.float64)
9 gae_duplicate tensor(-0.6534, dtype=torch.float64) tensor(-0.5321, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0234, dtype=torch.float64) delta_t tensor(-0.0234, dtype=torch.float64)
8 gae_duplicate tensor(-0.6659, dtype=torch.float64) tensor(0.3703, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5528, dtype=torch.float64) delta_t tensor(-0.5504, dtype=torch.float64)
7 gae_duplicate tensor(-1.8612, dtype=torch.float64) tensor(5.0895, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4516, dtype=torch.float64) delta_t tensor(-0.4224, dtype=torch.float64)
6 gae_duplicate tensor(-1.0711, dtype=torch.float64) tensor(6.2256, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4749, dtype=torch.float64) delta_t tensor(-1.3409, dtype=torch.float64)
5 gae_duplicate tensor(-1.9966, dtype=torch.float64) tensor(15.5117, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5136, dtype=torch.float64) delta_t tensor(-1.5063, dtype=torch.float64)
4 gae_duplicate tensor(-9.7508, dtype=torch.float64) tensor(25.2863, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8310, dtype=torch.float64) delta_t tensor(-0.7189, dtype=torch.float64)
3 gae_duplicate tensor(-1.1843, dtype=torch.float64) tensor(11.1764, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4395, dtype=torch.float64) delta_t tensor(-0.5507, dtype=torch.float64)
2 gae_duplicate tensor(-1.6122, dtype=torch.float64) tensor(10.1581, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-199.83856201171875
value loss:233.97552490234375
entropies:205.9383087158203
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.044068813323975 seconds
19 rew tensor(0.8052, dtype=torch.float64) delta_t tensor(0.6531, dtype=torch.float64)
19 gae_duplicate tensor(0.5854, dtype=torch.float64) tensor(-5.4892, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8058, dtype=torch.float64) delta_t tensor(0.6152, dtype=torch.float64)
18 gae_duplicate tensor(0.6067, dtype=torch.float64) tensor(-7.8662, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7707, dtype=torch.float64) delta_t tensor(0.5936, dtype=torch.float64)
17 gae_duplicate tensor(0.5681, dtype=torch.float64) tensor(-7.9472, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7273, dtype=torch.float64) delta_t tensor(0.5598, dtype=torch.float64)
16 gae_duplicate tensor(0.3989, dtype=torch.float64) tensor(-6.7834, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6665, dtype=torch.float64) delta_t tensor(0.5130, dtype=torch.float64)
15 gae_duplicate tensor(0.1243, dtype=torch.float64) tensor(-6.5918, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5243, dtype=torch.float64) delta_t tensor(0.3327, dtype=torch.float64)
14 gae_duplicate tensor(-0.5791, dtype=torch.float64) tensor(-4.7892, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6476, dtype=torch.float64) delta_t tensor(0.5561, dtype=torch.float64)
13 gae_duplicate tensor(0.2868, dtype=torch.float64) tensor(-5.7522, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7517, dtype=torch.float64) delta_t tensor(0.6292, dtype=torch.float64)
12 gae_duplicate tensor(0.5903, dtype=torch.float64) tensor(-10.0144, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7157, dtype=torch.float64) delta_t tensor(0.6605, dtype=torch.float64)
11 gae_duplicate tensor(0.3337, dtype=torch.float64) tensor(-8.9438, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4694, dtype=torch.float64) delta_t tensor(0.3917, dtype=torch.float64)
10 gae_duplicate tensor(-0.2668, dtype=torch.float64) tensor(-6.4409, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7599, dtype=torch.float64) delta_t tensor(-0.7918, dtype=torch.float64)
9 gae_duplicate tensor(-2.1864, dtype=torch.float64) tensor(10.7656, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5677, dtype=torch.float64) delta_t tensor(-0.5708, dtype=torch.float64)
8 gae_duplicate tensor(-2.1102, dtype=torch.float64) tensor(9.5928, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1896, dtype=torch.float64) delta_t tensor(-1.2354, dtype=torch.float64)
7 gae_duplicate tensor(-2.1308, dtype=torch.float64) tensor(17.4874, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9162, dtype=torch.float64) delta_t tensor(-0.8961, dtype=torch.float64)
6 gae_duplicate tensor(-2.2262, dtype=torch.float64) tensor(10.6112, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2061, dtype=torch.float64) delta_t tensor(-1.1143, dtype=torch.float64)
5 gae_duplicate tensor(-1.7574, dtype=torch.float64) tensor(17.3615, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3815, dtype=torch.float64) delta_t tensor(-2.3929, dtype=torch.float64)
4 gae_duplicate tensor(-5.0344, dtype=torch.float64) tensor(28.0120, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7950, dtype=torch.float64) delta_t tensor(-0.7939, dtype=torch.float64)
3 gae_duplicate tensor(-1.5056, dtype=torch.float64) tensor(13.7590, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3215, dtype=torch.float64) delta_t tensor(-0.4553, dtype=torch.float64)
2 gae_duplicate tensor(-0.7955, dtype=torch.float64) tensor(7.6582, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1643.55859375
value loss:210.1405487060547
entropies:205.02767944335938
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.2470526695251465 seconds
19 rew tensor(0.7895, dtype=torch.float64) delta_t tensor(0.5686, dtype=torch.float64)
19 gae_duplicate tensor(0.4123, dtype=torch.float64) tensor(-5.7760, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7663, dtype=torch.float64) delta_t tensor(0.5931, dtype=torch.float64)
18 gae_duplicate tensor(0.3520, dtype=torch.float64) tensor(-7.4505, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7350, dtype=torch.float64) delta_t tensor(0.5447, dtype=torch.float64)
17 gae_duplicate tensor(0.1355, dtype=torch.float64) tensor(-7.4380, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6560, dtype=torch.float64) delta_t tensor(0.5340, dtype=torch.float64)
16 gae_duplicate tensor(-0.2950, dtype=torch.float64) tensor(-6.1078, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.7259, dtype=torch.float64)
15 gae_duplicate tensor(0.6980, dtype=torch.float64) tensor(-9.0012, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8082, dtype=torch.float64) delta_t tensor(0.7172, dtype=torch.float64)
14 gae_duplicate tensor(0.6955, dtype=torch.float64) tensor(-7.9471, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7691, dtype=torch.float64) delta_t tensor(0.6807, dtype=torch.float64)
13 gae_duplicate tensor(0.4722, dtype=torch.float64) tensor(-7.1909, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7448, dtype=torch.float64) delta_t tensor(0.6601, dtype=torch.float64)
12 gae_duplicate tensor(0.4664, dtype=torch.float64) tensor(-7.3278, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6284, dtype=torch.float64) delta_t tensor(0.5716, dtype=torch.float64)
11 gae_duplicate tensor(0.2472, dtype=torch.float64) tensor(-7.5346, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4459, dtype=torch.float64) delta_t tensor(0.2645, dtype=torch.float64)
10 gae_duplicate tensor(0.0577, dtype=torch.float64) tensor(-4.4825, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0841, dtype=torch.float64) delta_t tensor(-0.1423, dtype=torch.float64)
9 gae_duplicate tensor(-1.4087, dtype=torch.float64) tensor(0.2184, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6393, dtype=torch.float64) delta_t tensor(-0.6126, dtype=torch.float64)
8 gae_duplicate tensor(-1.9924, dtype=torch.float64) tensor(7.7254, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6791, dtype=torch.float64) delta_t tensor(-0.6529, dtype=torch.float64)
7 gae_duplicate tensor(-2.5588, dtype=torch.float64) tensor(8.7309, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9594, dtype=torch.float64) delta_t tensor(-0.9376, dtype=torch.float64)
6 gae_duplicate tensor(-1.9790, dtype=torch.float64) tensor(9.9963, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9964, dtype=torch.float64) delta_t tensor(-1.0119, dtype=torch.float64)
5 gae_duplicate tensor(-1.7421, dtype=torch.float64) tensor(11.7372, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4477, dtype=torch.float64) delta_t tensor(-2.4704, dtype=torch.float64)
4 gae_duplicate tensor(-6.1600, dtype=torch.float64) tensor(24.5305, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2204, dtype=torch.float64) delta_t tensor(-0.1596, dtype=torch.float64)
3 gae_duplicate tensor(-1.2836, dtype=torch.float64) tensor(5.9217, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4650, dtype=torch.float64) delta_t tensor(-0.4248, dtype=torch.float64)
2 gae_duplicate tensor(-0.8923, dtype=torch.float64) tensor(5.1804, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-173.06776428222656
value loss:193.7998809814453
entropies:204.612548828125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2472.3479)
ToM Target loss= tensor(1811.1299)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.097256898880005 seconds
19 rew tensor(0.7778, dtype=torch.float64) delta_t tensor(0.5715, dtype=torch.float64)
19 gae_duplicate tensor(0.4095, dtype=torch.float64) tensor(-6.4735, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7534, dtype=torch.float64) delta_t tensor(0.5876, dtype=torch.float64)
18 gae_duplicate tensor(0.4339, dtype=torch.float64) tensor(-8.0781, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6882, dtype=torch.float64) delta_t tensor(0.4977, dtype=torch.float64)
17 gae_duplicate tensor(0.0808, dtype=torch.float64) tensor(-4.4008, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5815, dtype=torch.float64) delta_t tensor(0.4296, dtype=torch.float64)
16 gae_duplicate tensor(-0.5504, dtype=torch.float64) tensor(-4.2009, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7454, dtype=torch.float64) delta_t tensor(0.6218, dtype=torch.float64)
15 gae_duplicate tensor(0.4629, dtype=torch.float64) tensor(-6.3563, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6954, dtype=torch.float64) delta_t tensor(0.5572, dtype=torch.float64)
14 gae_duplicate tensor(0.1952, dtype=torch.float64) tensor(-7.8519, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6720, dtype=torch.float64) delta_t tensor(0.5712, dtype=torch.float64)
13 gae_duplicate tensor(0.3254, dtype=torch.float64) tensor(-7.7630, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5826, dtype=torch.float64) delta_t tensor(0.5459, dtype=torch.float64)
12 gae_duplicate tensor(0.4746, dtype=torch.float64) tensor(-5.6689, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3910, dtype=torch.float64) delta_t tensor(0.2929, dtype=torch.float64)
11 gae_duplicate tensor(-0.2024, dtype=torch.float64) tensor(-4.7743, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4397, dtype=torch.float64) delta_t tensor(0.3217, dtype=torch.float64)
10 gae_duplicate tensor(0.0734, dtype=torch.float64) tensor(-3.7030, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4702, dtype=torch.float64) delta_t tensor(-0.5507, dtype=torch.float64)
9 gae_duplicate tensor(-1.5087, dtype=torch.float64) tensor(4.7325, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3728, dtype=torch.float64) delta_t tensor(-0.4977, dtype=torch.float64)
8 gae_duplicate tensor(-1.1240, dtype=torch.float64) tensor(8.7508, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3559, dtype=torch.float64) delta_t tensor(-0.3874, dtype=torch.float64)
7 gae_duplicate tensor(-2.0088, dtype=torch.float64) tensor(6.2602, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3811, dtype=torch.float64) delta_t tensor(-0.4558, dtype=torch.float64)
6 gae_duplicate tensor(-0.9805, dtype=torch.float64) tensor(6.0099, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2331, dtype=torch.float64) delta_t tensor(-1.1945, dtype=torch.float64)
5 gae_duplicate tensor(-2.3243, dtype=torch.float64) tensor(15.4679, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3572, dtype=torch.float64) delta_t tensor(-3.2720, dtype=torch.float64)
4 gae_duplicate tensor(-7.6685, dtype=torch.float64) tensor(43.2944, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4999, dtype=torch.float64) delta_t tensor(-0.4529, dtype=torch.float64)
3 gae_duplicate tensor(-1.2273, dtype=torch.float64) tensor(9.7804, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1021, dtype=torch.float64) delta_t tensor(-0.1834, dtype=torch.float64)
2 gae_duplicate tensor(-0.5017, dtype=torch.float64) tensor(3.2468, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1414.5709228515625
value loss:264.4674377441406
entropies:204.28805541992188
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.272891998291016 seconds
19 rew tensor(0.7543, dtype=torch.float64) delta_t tensor(0.5820, dtype=torch.float64)
19 gae_duplicate tensor(0.3791, dtype=torch.float64) tensor(-7.6506, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6724, dtype=torch.float64) delta_t tensor(0.5337, dtype=torch.float64)
18 gae_duplicate tensor(0.0349, dtype=torch.float64) tensor(-7.4825, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5658, dtype=torch.float64) delta_t tensor(0.4130, dtype=torch.float64)
17 gae_duplicate tensor(-0.6413, dtype=torch.float64) tensor(-5.1288, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7310, dtype=torch.float64) delta_t tensor(0.5553, dtype=torch.float64)
16 gae_duplicate tensor(0.2765, dtype=torch.float64) tensor(-6.6790, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6417, dtype=torch.float64) delta_t tensor(0.5812, dtype=torch.float64)
15 gae_duplicate tensor(0.1074, dtype=torch.float64) tensor(-6.0050, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4946, dtype=torch.float64) delta_t tensor(0.3773, dtype=torch.float64)
14 gae_duplicate tensor(-0.4257, dtype=torch.float64) tensor(-5.6994, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7075, dtype=torch.float64) delta_t tensor(0.6031, dtype=torch.float64)
13 gae_duplicate tensor(0.4383, dtype=torch.float64) tensor(-5.8822, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6775, dtype=torch.float64) delta_t tensor(0.6309, dtype=torch.float64)
12 gae_duplicate tensor(0.4684, dtype=torch.float64) tensor(-7.6498, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5750, dtype=torch.float64) delta_t tensor(0.4939, dtype=torch.float64)
11 gae_duplicate tensor(0.2948, dtype=torch.float64) tensor(-6.1184, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4560, dtype=torch.float64) delta_t tensor(0.3137, dtype=torch.float64)
10 gae_duplicate tensor(0.1009, dtype=torch.float64) tensor(-5.5308, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3877, dtype=torch.float64) delta_t tensor(-0.5584, dtype=torch.float64)
9 gae_duplicate tensor(-1.5216, dtype=torch.float64) tensor(6.5960, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2916, dtype=torch.float64) delta_t tensor(-1.3638, dtype=torch.float64)
8 gae_duplicate tensor(-2.7542, dtype=torch.float64) tensor(17.3606, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1574, dtype=torch.float64) delta_t tensor(-1.2193, dtype=torch.float64)
7 gae_duplicate tensor(-2.2388, dtype=torch.float64) tensor(16.9534, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1083, dtype=torch.float64) delta_t tensor(-1.1796, dtype=torch.float64)
6 gae_duplicate tensor(-3.6097, dtype=torch.float64) tensor(21.2653, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8478, dtype=torch.float64) delta_t tensor(-0.7986, dtype=torch.float64)
5 gae_duplicate tensor(-2.0648, dtype=torch.float64) tensor(12.2323, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9907, dtype=torch.float64) delta_t tensor(-0.9167, dtype=torch.float64)
4 gae_duplicate tensor(-4.8853, dtype=torch.float64) tensor(13.7863, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2469, dtype=torch.float64) delta_t tensor(-0.1084, dtype=torch.float64)
3 gae_duplicate tensor(-1.1516, dtype=torch.float64) tensor(2.1999, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5579, dtype=torch.float64) delta_t tensor(-0.4390, dtype=torch.float64)
2 gae_duplicate tensor(-1.0182, dtype=torch.float64) tensor(4.1034, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1140.798828125
value loss:186.49038696289062
entropies:203.5801239013672
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.735878229141235 seconds
19 rew tensor(0.5980, dtype=torch.float64) delta_t tensor(0.4365, dtype=torch.float64)
19 gae_duplicate tensor(-0.6716, dtype=torch.float64) tensor(-6.2294, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7923, dtype=torch.float64) delta_t tensor(0.6369, dtype=torch.float64)
18 gae_duplicate tensor(0.5537, dtype=torch.float64) tensor(-7.3817, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7837, dtype=torch.float64) delta_t tensor(0.6436, dtype=torch.float64)
17 gae_duplicate tensor(0.5991, dtype=torch.float64) tensor(-8.1621, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7843, dtype=torch.float64) delta_t tensor(0.5740, dtype=torch.float64)
16 gae_duplicate tensor(0.5631, dtype=torch.float64) tensor(-7.3372, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7493, dtype=torch.float64) delta_t tensor(0.5415, dtype=torch.float64)
15 gae_duplicate tensor(0.2903, dtype=torch.float64) tensor(-7.1907, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6778, dtype=torch.float64) delta_t tensor(0.5084, dtype=torch.float64)
14 gae_duplicate tensor(-0.0279, dtype=torch.float64) tensor(-6.4593, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7247, dtype=torch.float64) delta_t tensor(0.5740, dtype=torch.float64)
13 gae_duplicate tensor(0.4849, dtype=torch.float64) tensor(-8.3522, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7331, dtype=torch.float64) delta_t tensor(0.6924, dtype=torch.float64)
12 gae_duplicate tensor(0.4340, dtype=torch.float64) tensor(-11.7262, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6351, dtype=torch.float64) delta_t tensor(0.5678, dtype=torch.float64)
11 gae_duplicate tensor(0.1537, dtype=torch.float64) tensor(-7.0739, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3728, dtype=torch.float64) delta_t tensor(0.2572, dtype=torch.float64)
10 gae_duplicate tensor(-0.4980, dtype=torch.float64) tensor(-3.0182, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2363, dtype=torch.float64) delta_t tensor(-1.2965, dtype=torch.float64)
9 gae_duplicate tensor(-3.2463, dtype=torch.float64) tensor(12.9561, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3984, dtype=torch.float64) delta_t tensor(-0.4987, dtype=torch.float64)
8 gae_duplicate tensor(-1.0224, dtype=torch.float64) tensor(6.8223, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8463, dtype=torch.float64) delta_t tensor(-0.8774, dtype=torch.float64)
7 gae_duplicate tensor(-2.2605, dtype=torch.float64) tensor(12.8515, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2878, dtype=torch.float64) delta_t tensor(-1.3192, dtype=torch.float64)
6 gae_duplicate tensor(-2.9102, dtype=torch.float64) tensor(13.8390, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9831, dtype=torch.float64) delta_t tensor(-0.9155, dtype=torch.float64)
5 gae_duplicate tensor(-2.3062, dtype=torch.float64) tensor(10.0361, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3142, dtype=torch.float64) delta_t tensor(-2.2445, dtype=torch.float64)
4 gae_duplicate tensor(-6.3554, dtype=torch.float64) tensor(26.7984, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0078, dtype=torch.float64) delta_t tensor(0.0468, dtype=torch.float64)
3 gae_duplicate tensor(-0.9092, dtype=torch.float64) tensor(4.0113, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3080, dtype=torch.float64) delta_t tensor(-0.3309, dtype=torch.float64)
2 gae_duplicate tensor(-0.9243, dtype=torch.float64) tensor(2.8467, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-656.7696533203125
value loss:247.84732055664062
entropies:202.59385681152344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.825238227844238 seconds
19 rew tensor(0.5796, dtype=torch.float64) delta_t tensor(0.4425, dtype=torch.float64)
19 gae_duplicate tensor(-0.7304, dtype=torch.float64) tensor(-5.1370, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8038, dtype=torch.float64) delta_t tensor(0.6395, dtype=torch.float64)
18 gae_duplicate tensor(0.5569, dtype=torch.float64) tensor(-7.4089, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7961, dtype=torch.float64) delta_t tensor(0.5998, dtype=torch.float64)
17 gae_duplicate tensor(0.5158, dtype=torch.float64) tensor(-8.4391, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7885, dtype=torch.float64) delta_t tensor(0.6084, dtype=torch.float64)
16 gae_duplicate tensor(0.5337, dtype=torch.float64) tensor(-5.6588, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8054, dtype=torch.float64) delta_t tensor(0.6690, dtype=torch.float64)
15 gae_duplicate tensor(0.6027, dtype=torch.float64) tensor(-8.0991, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6501, dtype=torch.float64) delta_t tensor(0.5672, dtype=torch.float64)
14 gae_duplicate tensor(-0.0224, dtype=torch.float64) tensor(-9.2428, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6189, dtype=torch.float64) delta_t tensor(0.5547, dtype=torch.float64)
13 gae_duplicate tensor(0.1779, dtype=torch.float64) tensor(-8.1563, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4861, dtype=torch.float64) delta_t tensor(0.4756, dtype=torch.float64)
12 gae_duplicate tensor(0.0502, dtype=torch.float64) tensor(-6.7381, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4164, dtype=torch.float64) delta_t tensor(0.3702, dtype=torch.float64)
11 gae_duplicate tensor(0.0121, dtype=torch.float64) tensor(-4.4019, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3526, dtype=torch.float64) delta_t tensor(0.2792, dtype=torch.float64)
10 gae_duplicate tensor(-0.3959, dtype=torch.float64) tensor(-2.6811, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1342, dtype=torch.float64) delta_t tensor(0.1035, dtype=torch.float64)
9 gae_duplicate tensor(-0.5703, dtype=torch.float64) tensor(-1.5186, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1261, dtype=torch.float64) delta_t tensor(-0.1515, dtype=torch.float64)
8 gae_duplicate tensor(-0.8683, dtype=torch.float64) tensor(1.4186, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2241, dtype=torch.float64) delta_t tensor(-0.3035, dtype=torch.float64)
7 gae_duplicate tensor(-0.8446, dtype=torch.float64) tensor(2.4574, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7438, dtype=torch.float64) delta_t tensor(-0.7741, dtype=torch.float64)
6 gae_duplicate tensor(-1.2495, dtype=torch.float64) tensor(8.9034, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7883, dtype=torch.float64) delta_t tensor(-0.7570, dtype=torch.float64)
5 gae_duplicate tensor(-1.6793, dtype=torch.float64) tensor(7.5160, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5498, dtype=torch.float64) delta_t tensor(-0.4232, dtype=torch.float64)
4 gae_duplicate tensor(-1.6942, dtype=torch.float64) tensor(3.7351, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3221, dtype=torch.float64) delta_t tensor(-0.3094, dtype=torch.float64)
3 gae_duplicate tensor(-1.1872, dtype=torch.float64) tensor(4.4750, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5747, dtype=torch.float64) delta_t tensor(-0.5714, dtype=torch.float64)
2 gae_duplicate tensor(-1.1100, dtype=torch.float64) tensor(6.5285, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1131.7109375
value loss:78.41691589355469
entropies:202.25634765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.66107702255249 seconds
19 rew tensor(0.5736, dtype=torch.float64) delta_t tensor(0.4020, dtype=torch.float64)
19 gae_duplicate tensor(-0.7303, dtype=torch.float64) tensor(-6.2396, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7786, dtype=torch.float64) delta_t tensor(0.6331, dtype=torch.float64)
18 gae_duplicate tensor(0.4045, dtype=torch.float64) tensor(-7.1514, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7631, dtype=torch.float64) delta_t tensor(0.6239, dtype=torch.float64)
17 gae_duplicate tensor(0.4194, dtype=torch.float64) tensor(-6.6953, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6907, dtype=torch.float64) delta_t tensor(0.5274, dtype=torch.float64)
16 gae_duplicate tensor(0.0429, dtype=torch.float64) tensor(-5.8449, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5440, dtype=torch.float64) delta_t tensor(0.4294, dtype=torch.float64)
15 gae_duplicate tensor(-0.5968, dtype=torch.float64) tensor(-6.8128, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5506, dtype=torch.float64) delta_t tensor(0.4732, dtype=torch.float64)
14 gae_duplicate tensor(-0.1391, dtype=torch.float64) tensor(-5.5461, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6306, dtype=torch.float64) delta_t tensor(0.5179, dtype=torch.float64)
13 gae_duplicate tensor(0.3461, dtype=torch.float64) tensor(-6.7076, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5548, dtype=torch.float64) delta_t tensor(0.4921, dtype=torch.float64)
12 gae_duplicate tensor(0.3104, dtype=torch.float64) tensor(-5.9073, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5600, dtype=torch.float64) delta_t tensor(0.5238, dtype=torch.float64)
11 gae_duplicate tensor(0.0775, dtype=torch.float64) tensor(-7.4747, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3454, dtype=torch.float64) delta_t tensor(0.2596, dtype=torch.float64)
10 gae_duplicate tensor(-0.3636, dtype=torch.float64) tensor(-2.7980, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0919, dtype=torch.float64) delta_t tensor(-0.1764, dtype=torch.float64)
9 gae_duplicate tensor(-1.3323, dtype=torch.float64) tensor(0.2194, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8450, dtype=torch.float64) delta_t tensor(-0.9152, dtype=torch.float64)
8 gae_duplicate tensor(-1.7714, dtype=torch.float64) tensor(10.3054, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6739, dtype=torch.float64) delta_t tensor(-0.6857, dtype=torch.float64)
7 gae_duplicate tensor(-1.8772, dtype=torch.float64) tensor(11.1897, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0665, dtype=torch.float64) delta_t tensor(-1.1005, dtype=torch.float64)
6 gae_duplicate tensor(-2.0878, dtype=torch.float64) tensor(12.6421, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3154, dtype=torch.float64) delta_t tensor(-1.2462, dtype=torch.float64)
5 gae_duplicate tensor(-2.4954, dtype=torch.float64) tensor(14.0327, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6279, dtype=torch.float64) delta_t tensor(-2.5910, dtype=torch.float64)
4 gae_duplicate tensor(-7.1387, dtype=torch.float64) tensor(33.6846, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5926, dtype=torch.float64) delta_t tensor(-0.5888, dtype=torch.float64)
3 gae_duplicate tensor(-1.2472, dtype=torch.float64) tensor(10.7733, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2717, dtype=torch.float64) delta_t tensor(-0.2803, dtype=torch.float64)
2 gae_duplicate tensor(-1.1760, dtype=torch.float64) tensor(4.9620, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1355.03759765625
value loss:265.70159912109375
entropies:201.66636657714844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2446.1758)
ToM Target loss= tensor(1812.2919)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.2060840129852295 seconds
19 rew tensor(0.8026, dtype=torch.float64) delta_t tensor(0.5673, dtype=torch.float64)
19 gae_duplicate tensor(0.4790, dtype=torch.float64) tensor(-6.5874, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7946, dtype=torch.float64) delta_t tensor(0.5950, dtype=torch.float64)
18 gae_duplicate tensor(0.5938, dtype=torch.float64) tensor(-6.5148, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7780, dtype=torch.float64) delta_t tensor(0.5800, dtype=torch.float64)
17 gae_duplicate tensor(0.5498, dtype=torch.float64) tensor(-7.4087, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7614, dtype=torch.float64) delta_t tensor(0.5974, dtype=torch.float64)
16 gae_duplicate tensor(0.4304, dtype=torch.float64) tensor(-8.0288, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6583, dtype=torch.float64) delta_t tensor(0.5148, dtype=torch.float64)
15 gae_duplicate tensor(0.0419, dtype=torch.float64) tensor(-5.9610, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5015, dtype=torch.float64) delta_t tensor(0.3372, dtype=torch.float64)
14 gae_duplicate tensor(-0.6773, dtype=torch.float64) tensor(-5.6427, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6348, dtype=torch.float64) delta_t tensor(0.5827, dtype=torch.float64)
13 gae_duplicate tensor(0.4251, dtype=torch.float64) tensor(-7.8378, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6396, dtype=torch.float64) delta_t tensor(0.5711, dtype=torch.float64)
12 gae_duplicate tensor(0.2843, dtype=torch.float64) tensor(-7.4907, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5282, dtype=torch.float64) delta_t tensor(0.5168, dtype=torch.float64)
11 gae_duplicate tensor(-0.0262, dtype=torch.float64) tensor(-7.1288, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5482, dtype=torch.float64) delta_t tensor(0.5277, dtype=torch.float64)
10 gae_duplicate tensor(0.2762, dtype=torch.float64) tensor(-7.9813, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2695, dtype=torch.float64) delta_t tensor(-0.3575, dtype=torch.float64)
9 gae_duplicate tensor(-1.3013, dtype=torch.float64) tensor(4.0599, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6579, dtype=torch.float64) delta_t tensor(-0.7082, dtype=torch.float64)
8 gae_duplicate tensor(-2.5882, dtype=torch.float64) tensor(8.7240, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7208, dtype=torch.float64) delta_t tensor(-0.7088, dtype=torch.float64)
7 gae_duplicate tensor(-1.8175, dtype=torch.float64) tensor(9.5850, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2647, dtype=torch.float64) delta_t tensor(-0.3022, dtype=torch.float64)
6 gae_duplicate tensor(-1.8899, dtype=torch.float64) tensor(2.8508, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5345, dtype=torch.float64) delta_t tensor(-1.3534, dtype=torch.float64)
5 gae_duplicate tensor(-2.6498, dtype=torch.float64) tensor(13.0485, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2993, dtype=torch.float64) delta_t tensor(0.2847, dtype=torch.float64)
4 gae_duplicate tensor(-0.4837, dtype=torch.float64) tensor(0.2175, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7602, dtype=torch.float64) delta_t tensor(-0.7234, dtype=torch.float64)
3 gae_duplicate tensor(-1.3188, dtype=torch.float64) tensor(7.4107, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3740, dtype=torch.float64) delta_t tensor(-0.4374, dtype=torch.float64)
2 gae_duplicate tensor(-0.9947, dtype=torch.float64) tensor(6.7599, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:609.057373046875
value loss:104.69908142089844
entropies:201.51986694335938
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.839734792709351 seconds
19 rew tensor(0.7796, dtype=torch.float64) delta_t tensor(0.6480, dtype=torch.float64)
19 gae_duplicate tensor(0.5347, dtype=torch.float64) tensor(-6.3005, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7623, dtype=torch.float64) delta_t tensor(0.5990, dtype=torch.float64)
18 gae_duplicate tensor(0.4726, dtype=torch.float64) tensor(-6.8812, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7023, dtype=torch.float64) delta_t tensor(0.5666, dtype=torch.float64)
17 gae_duplicate tensor(0.3768, dtype=torch.float64) tensor(-5.4987, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6255, dtype=torch.float64) delta_t tensor(0.5254, dtype=torch.float64)
16 gae_duplicate tensor(0.1553, dtype=torch.float64) tensor(-6.1327, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3933, dtype=torch.float64) delta_t tensor(0.3692, dtype=torch.float64)
15 gae_duplicate tensor(-0.5722, dtype=torch.float64) tensor(-4.1647, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3308, dtype=torch.float64) delta_t tensor(0.2525, dtype=torch.float64)
14 gae_duplicate tensor(-0.4133, dtype=torch.float64) tensor(-2.3869, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5218, dtype=torch.float64) delta_t tensor(0.4530, dtype=torch.float64)
13 gae_duplicate tensor(-0.1942, dtype=torch.float64) tensor(-4.1857, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4741, dtype=torch.float64) delta_t tensor(0.4037, dtype=torch.float64)
12 gae_duplicate tensor(-0.2779, dtype=torch.float64) tensor(-5.2002, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4745, dtype=torch.float64) delta_t tensor(0.3873, dtype=torch.float64)
11 gae_duplicate tensor(-0.1271, dtype=torch.float64) tensor(-4.6174, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5143, dtype=torch.float64) delta_t tensor(0.4493, dtype=torch.float64)
10 gae_duplicate tensor(0.1785, dtype=torch.float64) tensor(-5.6023, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0889, dtype=torch.float64) delta_t tensor(-1.0787, dtype=torch.float64)
9 gae_duplicate tensor(-4.9328, dtype=torch.float64) tensor(12.6607, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0740, dtype=torch.float64) delta_t tensor(-1.1875, dtype=torch.float64)
8 gae_duplicate tensor(-4.0078, dtype=torch.float64) tensor(20.5685, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5885, dtype=torch.float64) delta_t tensor(-0.5941, dtype=torch.float64)
7 gae_duplicate tensor(-2.2713, dtype=torch.float64) tensor(7.2726, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6259, dtype=torch.float64) delta_t tensor(-0.6537, dtype=torch.float64)
6 gae_duplicate tensor(-2.1617, dtype=torch.float64) tensor(8.0450, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3929, dtype=torch.float64) delta_t tensor(-1.3203, dtype=torch.float64)
5 gae_duplicate tensor(-2.1666, dtype=torch.float64) tensor(13.5824, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9007, dtype=torch.float64) delta_t tensor(-3.8033, dtype=torch.float64)
4 gae_duplicate tensor(-9.2528, dtype=torch.float64) tensor(41.2713, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2092, dtype=torch.float64) delta_t tensor(-0.1754, dtype=torch.float64)
3 gae_duplicate tensor(-0.9169, dtype=torch.float64) tensor(6.7118, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2085, dtype=torch.float64) delta_t tensor(-0.2582, dtype=torch.float64)
2 gae_duplicate tensor(-1.2781, dtype=torch.float64) tensor(2.3311, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2249.26416015625
value loss:422.03997802734375
entropies:201.3059844970703
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.864706039428711 seconds
19 rew tensor(0.7531, dtype=torch.float64) delta_t tensor(0.5263, dtype=torch.float64)
19 gae_duplicate tensor(0.2175, dtype=torch.float64) tensor(-5.6602, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6822, dtype=torch.float64) delta_t tensor(0.4985, dtype=torch.float64)
18 gae_duplicate tensor(-0.0698, dtype=torch.float64) tensor(-4.0694, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5845, dtype=torch.float64) delta_t tensor(0.4258, dtype=torch.float64)
17 gae_duplicate tensor(-0.7113, dtype=torch.float64) tensor(-5.4481, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8079, dtype=torch.float64) delta_t tensor(0.6675, dtype=torch.float64)
16 gae_duplicate tensor(0.5639, dtype=torch.float64) tensor(-7.5449, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7595, dtype=torch.float64) delta_t tensor(0.6135, dtype=torch.float64)
15 gae_duplicate tensor(0.5477, dtype=torch.float64) tensor(-7.2442, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6691, dtype=torch.float64) delta_t tensor(0.5470, dtype=torch.float64)
14 gae_duplicate tensor(0.4476, dtype=torch.float64) tensor(-6.7235, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6780, dtype=torch.float64) delta_t tensor(0.6522, dtype=torch.float64)
13 gae_duplicate tensor(0.4685, dtype=torch.float64) tensor(-8.4238, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1321, dtype=torch.float64) delta_t tensor(0.0772, dtype=torch.float64)
12 gae_duplicate tensor(-1.4694, dtype=torch.float64) tensor(-0.5972, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4960, dtype=torch.float64) delta_t tensor(0.4374, dtype=torch.float64)
11 gae_duplicate tensor(0.1520, dtype=torch.float64) tensor(-5.0078, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3856, dtype=torch.float64) delta_t tensor(0.4222, dtype=torch.float64)
10 gae_duplicate tensor(0.1472, dtype=torch.float64) tensor(-5.2480, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2528, dtype=torch.float64) delta_t tensor(0.1670, dtype=torch.float64)
9 gae_duplicate tensor(-0.0974, dtype=torch.float64) tensor(-2.6089, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2685, dtype=torch.float64) delta_t tensor(-0.2471, dtype=torch.float64)
8 gae_duplicate tensor(-0.9365, dtype=torch.float64) tensor(2.0425, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5915, dtype=torch.float64) delta_t tensor(-0.5696, dtype=torch.float64)
7 gae_duplicate tensor(-1.9647, dtype=torch.float64) tensor(6.8777, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4549, dtype=torch.float64) delta_t tensor(-0.3613, dtype=torch.float64)
6 gae_duplicate tensor(-1.9812, dtype=torch.float64) tensor(5.2406, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3122, dtype=torch.float64) delta_t tensor(-0.2562, dtype=torch.float64)
5 gae_duplicate tensor(-1.1287, dtype=torch.float64) tensor(5.1863, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4805, dtype=torch.float64) delta_t tensor(-0.4102, dtype=torch.float64)
4 gae_duplicate tensor(-1.1148, dtype=torch.float64) tensor(4.7464, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0726, dtype=torch.float64) delta_t tensor(-0.9295, dtype=torch.float64)
3 gae_duplicate tensor(-1.4271, dtype=torch.float64) tensor(9.5675, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3500, dtype=torch.float64) delta_t tensor(-0.4386, dtype=torch.float64)
2 gae_duplicate tensor(-0.9565, dtype=torch.float64) tensor(8.0377, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:571.3668823242188
value loss:78.83252716064453
entropies:201.18910217285156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.099791049957275 seconds
19 rew tensor(0.7615, dtype=torch.float64) delta_t tensor(0.5793, dtype=torch.float64)
19 gae_duplicate tensor(0.4292, dtype=torch.float64) tensor(-6.2009, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7286, dtype=torch.float64) delta_t tensor(0.5316, dtype=torch.float64)
18 gae_duplicate tensor(0.1895, dtype=torch.float64) tensor(-6.2122, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6300, dtype=torch.float64) delta_t tensor(0.4922, dtype=torch.float64)
17 gae_duplicate tensor(0.0308, dtype=torch.float64) tensor(-8.4047, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4812, dtype=torch.float64) delta_t tensor(0.3483, dtype=torch.float64)
16 gae_duplicate tensor(-0.6441, dtype=torch.float64) tensor(-5.4922, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6158, dtype=torch.float64) delta_t tensor(0.5103, dtype=torch.float64)
15 gae_duplicate tensor(0.0252, dtype=torch.float64) tensor(-5.9982, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4191, dtype=torch.float64) delta_t tensor(0.3183, dtype=torch.float64)
14 gae_duplicate tensor(-0.4740, dtype=torch.float64) tensor(-5.3656, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7088, dtype=torch.float64) delta_t tensor(0.6676, dtype=torch.float64)
13 gae_duplicate tensor(0.5641, dtype=torch.float64) tensor(-7.1543, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5552, dtype=torch.float64) delta_t tensor(0.4844, dtype=torch.float64)
12 gae_duplicate tensor(0.2959, dtype=torch.float64) tensor(-6.3698, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4615, dtype=torch.float64) delta_t tensor(0.4030, dtype=torch.float64)
11 gae_duplicate tensor(0.0738, dtype=torch.float64) tensor(-5.0605, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2724, dtype=torch.float64) delta_t tensor(0.1320, dtype=torch.float64)
10 gae_duplicate tensor(-0.4152, dtype=torch.float64) tensor(-2.3002, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4512, dtype=torch.float64) delta_t tensor(-0.5183, dtype=torch.float64)
9 gae_duplicate tensor(-1.5648, dtype=torch.float64) tensor(7.6729, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3564, dtype=torch.float64) delta_t tensor(-0.3569, dtype=torch.float64)
8 gae_duplicate tensor(-1.4407, dtype=torch.float64) tensor(4.8330, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3772, dtype=torch.float64) delta_t tensor(-0.3586, dtype=torch.float64)
7 gae_duplicate tensor(-2.4278, dtype=torch.float64) tensor(1.8061, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9531, dtype=torch.float64) delta_t tensor(-0.9124, dtype=torch.float64)
6 gae_duplicate tensor(-3.2171, dtype=torch.float64) tensor(11.0104, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6450, dtype=torch.float64) delta_t tensor(-0.6259, dtype=torch.float64)
5 gae_duplicate tensor(-2.1789, dtype=torch.float64) tensor(6.8623, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4797, dtype=torch.float64) delta_t tensor(-3.3773, dtype=torch.float64)
4 gae_duplicate tensor(-10.8235, dtype=torch.float64) tensor(38.1733, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2565, dtype=torch.float64) delta_t tensor(-0.1778, dtype=torch.float64)
3 gae_duplicate tensor(-0.8232, dtype=torch.float64) tensor(8.4420, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4687, dtype=torch.float64) delta_t tensor(-0.4493, dtype=torch.float64)
2 gae_duplicate tensor(-1.3164, dtype=torch.float64) tensor(6.0933, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-984.1019287109375
value loss:327.60858154296875
entropies:200.30673217773438
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9828782081604 seconds
19 rew tensor(0.8041, dtype=torch.float64) delta_t tensor(0.6736, dtype=torch.float64)
19 gae_duplicate tensor(0.5964, dtype=torch.float64) tensor(-7.9194, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8046, dtype=torch.float64) delta_t tensor(0.7534, dtype=torch.float64)
18 gae_duplicate tensor(0.6766, dtype=torch.float64) tensor(-8.8952, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7710, dtype=torch.float64) delta_t tensor(0.6209, dtype=torch.float64)
17 gae_duplicate tensor(0.6260, dtype=torch.float64) tensor(-8.0696, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7625, dtype=torch.float64) delta_t tensor(0.6629, dtype=torch.float64)
16 gae_duplicate tensor(0.6488, dtype=torch.float64) tensor(-9.7802, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7036, dtype=torch.float64) delta_t tensor(0.6574, dtype=torch.float64)
15 gae_duplicate tensor(0.4930, dtype=torch.float64) tensor(-7.9188, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6104, dtype=torch.float64) delta_t tensor(0.5582, dtype=torch.float64)
14 gae_duplicate tensor(-0.0224, dtype=torch.float64) tensor(-7.5245, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2503, dtype=torch.float64) delta_t tensor(0.2260, dtype=torch.float64)
13 gae_duplicate tensor(-1.5499, dtype=torch.float64) tensor(-4.2829, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0977, dtype=torch.float64) delta_t tensor(-0.0196, dtype=torch.float64)
12 gae_duplicate tensor(-2.1128, dtype=torch.float64) tensor(-0.2013, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4152, dtype=torch.float64) delta_t tensor(0.4394, dtype=torch.float64)
11 gae_duplicate tensor(0.0167, dtype=torch.float64) tensor(-3.4333, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1623, dtype=torch.float64) delta_t tensor(0.1749, dtype=torch.float64)
10 gae_duplicate tensor(-0.0709, dtype=torch.float64) tensor(-2.4949, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1340, dtype=torch.float64) delta_t tensor(-0.1270, dtype=torch.float64)
9 gae_duplicate tensor(-1.6775, dtype=torch.float64) tensor(3.0295, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0082, dtype=torch.float64) delta_t tensor(-0.0657, dtype=torch.float64)
8 gae_duplicate tensor(-0.8718, dtype=torch.float64) tensor(0.4640, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0378, dtype=torch.float64) delta_t tensor(-1.0149, dtype=torch.float64)
7 gae_duplicate tensor(-2.9955, dtype=torch.float64) tensor(14.3040, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5068, dtype=torch.float64) delta_t tensor(-0.5143, dtype=torch.float64)
6 gae_duplicate tensor(-2.3452, dtype=torch.float64) tensor(9.3344, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1563, dtype=torch.float64) delta_t tensor(-1.0154, dtype=torch.float64)
5 gae_duplicate tensor(-3.8476, dtype=torch.float64) tensor(13.1177, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4799, dtype=torch.float64) delta_t tensor(-0.4281, dtype=torch.float64)
4 gae_duplicate tensor(-3.1040, dtype=torch.float64) tensor(6.4737, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4251, dtype=torch.float64) delta_t tensor(-0.3563, dtype=torch.float64)
3 gae_duplicate tensor(-0.9430, dtype=torch.float64) tensor(4.3057, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2960, dtype=torch.float64) delta_t tensor(-0.3092, dtype=torch.float64)
2 gae_duplicate tensor(-0.4133, dtype=torch.float64) tensor(3.5163, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:179.0889434814453
value loss:140.58865356445312
entropies:200.0414276123047
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2476.3782)
ToM Target loss= tensor(1811.1979)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.9369518756866455 seconds
19 rew tensor(0.7616, dtype=torch.float64) delta_t tensor(0.5900, dtype=torch.float64)
19 gae_duplicate tensor(0.4037, dtype=torch.float64) tensor(-6.5717, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6706, dtype=torch.float64) delta_t tensor(0.5094, dtype=torch.float64)
18 gae_duplicate tensor(0.3405, dtype=torch.float64) tensor(-6.2305, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5946, dtype=torch.float64) delta_t tensor(0.3696, dtype=torch.float64)
17 gae_duplicate tensor(0.0205, dtype=torch.float64) tensor(-4.7869, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3939, dtype=torch.float64) delta_t tensor(0.1955, dtype=torch.float64)
16 gae_duplicate tensor(-0.6496, dtype=torch.float64) tensor(-4.1775, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7575, dtype=torch.float64) delta_t tensor(0.6100, dtype=torch.float64)
15 gae_duplicate tensor(0.3462, dtype=torch.float64) tensor(-7.0771, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6096, dtype=torch.float64) delta_t tensor(0.4449, dtype=torch.float64)
14 gae_duplicate tensor(0.1377, dtype=torch.float64) tensor(-6.3345, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5761, dtype=torch.float64) delta_t tensor(0.4622, dtype=torch.float64)
13 gae_duplicate tensor(0.1745, dtype=torch.float64) tensor(-5.3444, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5424, dtype=torch.float64) delta_t tensor(0.4861, dtype=torch.float64)
12 gae_duplicate tensor(-0.2197, dtype=torch.float64) tensor(-7.1818, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4943, dtype=torch.float64) delta_t tensor(0.4438, dtype=torch.float64)
11 gae_duplicate tensor(-0.0001, dtype=torch.float64) tensor(-4.3528, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3358, dtype=torch.float64) delta_t tensor(0.2439, dtype=torch.float64)
10 gae_duplicate tensor(-0.9424, dtype=torch.float64) tensor(-3.6082, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2394, dtype=torch.float64) delta_t tensor(-0.1694, dtype=torch.float64)
9 gae_duplicate tensor(-1.3964, dtype=torch.float64) tensor(1.4411, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0860, dtype=torch.float64) delta_t tensor(-0.0387, dtype=torch.float64)
8 gae_duplicate tensor(-0.8410, dtype=torch.float64) tensor(0.6037, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7721, dtype=torch.float64) delta_t tensor(-0.6768, dtype=torch.float64)
7 gae_duplicate tensor(-1.7770, dtype=torch.float64) tensor(6.9032, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7601, dtype=torch.float64) delta_t tensor(-0.7198, dtype=torch.float64)
6 gae_duplicate tensor(-1.9302, dtype=torch.float64) tensor(9.6230, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4298, dtype=torch.float64) delta_t tensor(-1.4173, dtype=torch.float64)
5 gae_duplicate tensor(-2.3404, dtype=torch.float64) tensor(21.1316, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3103, dtype=torch.float64) delta_t tensor(-1.2535, dtype=torch.float64)
4 gae_duplicate tensor(-8.2944, dtype=torch.float64) tensor(15.8019, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6007, dtype=torch.float64) delta_t tensor(-0.4873, dtype=torch.float64)
3 gae_duplicate tensor(-1.1162, dtype=torch.float64) tensor(6.9511, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3463, dtype=torch.float64) delta_t tensor(-0.3972, dtype=torch.float64)
2 gae_duplicate tensor(-1.2830, dtype=torch.float64) tensor(6.4141, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-511.204833984375
value loss:198.50924682617188
entropies:199.19357299804688
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.292960166931152 seconds
19 rew tensor(0.8029, dtype=torch.float64) delta_t tensor(0.6198, dtype=torch.float64)
19 gae_duplicate tensor(0.5196, dtype=torch.float64) tensor(-7.7159, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7950, dtype=torch.float64) delta_t tensor(0.6515, dtype=torch.float64)
18 gae_duplicate tensor(0.6140, dtype=torch.float64) tensor(-6.5548, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7955, dtype=torch.float64) delta_t tensor(0.6515, dtype=torch.float64)
17 gae_duplicate tensor(0.6107, dtype=torch.float64) tensor(-7.4935, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7793, dtype=torch.float64) delta_t tensor(0.6491, dtype=torch.float64)
16 gae_duplicate tensor(0.4818, dtype=torch.float64) tensor(-9.4442, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6952, dtype=torch.float64) delta_t tensor(0.5167, dtype=torch.float64)
15 gae_duplicate tensor(0.1999, dtype=torch.float64) tensor(-5.7572, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5215, dtype=torch.float64) delta_t tensor(0.4005, dtype=torch.float64)
14 gae_duplicate tensor(0.0023, dtype=torch.float64) tensor(-4.8116, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6718, dtype=torch.float64) delta_t tensor(0.5728, dtype=torch.float64)
13 gae_duplicate tensor(0.4884, dtype=torch.float64) tensor(-7.2144, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6238, dtype=torch.float64) delta_t tensor(0.6304, dtype=torch.float64)
12 gae_duplicate tensor(0.3706, dtype=torch.float64) tensor(-8.3940, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2716, dtype=torch.float64) delta_t tensor(0.2041, dtype=torch.float64)
11 gae_duplicate tensor(-1.2842, dtype=torch.float64) tensor(-2.7371, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5001, dtype=torch.float64) delta_t tensor(0.4418, dtype=torch.float64)
10 gae_duplicate tensor(-0.0060, dtype=torch.float64) tensor(-4.7200, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1795, dtype=torch.float64) delta_t tensor(0.1716, dtype=torch.float64)
9 gae_duplicate tensor(-1.4454, dtype=torch.float64) tensor(-1.4482, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4794, dtype=torch.float64) delta_t tensor(-0.3801, dtype=torch.float64)
8 gae_duplicate tensor(-1.9195, dtype=torch.float64) tensor(2.1009, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2414, dtype=torch.float64) delta_t tensor(-0.3276, dtype=torch.float64)
7 gae_duplicate tensor(-1.1138, dtype=torch.float64) tensor(3.0011, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5754, dtype=torch.float64) delta_t tensor(-0.4478, dtype=torch.float64)
6 gae_duplicate tensor(-1.0720, dtype=torch.float64) tensor(5.7894, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5500, dtype=torch.float64) delta_t tensor(-0.5621, dtype=torch.float64)
5 gae_duplicate tensor(-1.8878, dtype=torch.float64) tensor(5.6293, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3589, dtype=torch.float64) delta_t tensor(-2.2552, dtype=torch.float64)
4 gae_duplicate tensor(-7.8443, dtype=torch.float64) tensor(31.8502, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6108, dtype=torch.float64) delta_t tensor(-0.4050, dtype=torch.float64)
3 gae_duplicate tensor(-0.9084, dtype=torch.float64) tensor(7.6983, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5050, dtype=torch.float64) delta_t tensor(-0.5306, dtype=torch.float64)
2 gae_duplicate tensor(-1.3948, dtype=torch.float64) tensor(9.0340, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:7.082061767578125
value loss:180.6715087890625
entropies:198.20706176757812
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.817497968673706 seconds
19 rew tensor(0.8021, dtype=torch.float64) delta_t tensor(0.6393, dtype=torch.float64)
19 gae_duplicate tensor(0.5784, dtype=torch.float64) tensor(-5.6719, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7866, dtype=torch.float64) delta_t tensor(0.7109, dtype=torch.float64)
18 gae_duplicate tensor(0.6628, dtype=torch.float64) tensor(-8.5951, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7711, dtype=torch.float64) delta_t tensor(0.6364, dtype=torch.float64)
17 gae_duplicate tensor(0.4817, dtype=torch.float64) tensor(-9.4498, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7389, dtype=torch.float64) delta_t tensor(0.6129, dtype=torch.float64)
16 gae_duplicate tensor(0.4849, dtype=torch.float64) tensor(-8.3448, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6495, dtype=torch.float64) delta_t tensor(0.4852, dtype=torch.float64)
15 gae_duplicate tensor(0.1986, dtype=torch.float64) tensor(-6.1177, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4689, dtype=torch.float64) delta_t tensor(0.3544, dtype=torch.float64)
14 gae_duplicate tensor(-0.0184, dtype=torch.float64) tensor(-3.5879, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6246, dtype=torch.float64) delta_t tensor(0.5627, dtype=torch.float64)
13 gae_duplicate tensor(0.0408, dtype=torch.float64) tensor(-6.6978, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4781, dtype=torch.float64) delta_t tensor(0.4466, dtype=torch.float64)
12 gae_duplicate tensor(-0.1051, dtype=torch.float64) tensor(-6.9048, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5782, dtype=torch.float64) delta_t tensor(0.5234, dtype=torch.float64)
11 gae_duplicate tensor(0.0024, dtype=torch.float64) tensor(-4.7380, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3768, dtype=torch.float64) delta_t tensor(-0.4345, dtype=torch.float64)
10 gae_duplicate tensor(-2.8534, dtype=torch.float64) tensor(3.7914, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6728, dtype=torch.float64) delta_t tensor(-0.6810, dtype=torch.float64)
9 gae_duplicate tensor(-2.9321, dtype=torch.float64) tensor(9.5891, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3005, dtype=torch.float64) delta_t tensor(-0.2169, dtype=torch.float64)
8 gae_duplicate tensor(-1.4958, dtype=torch.float64) tensor(3.8984, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2299, dtype=torch.float64) delta_t tensor(-0.1929, dtype=torch.float64)
7 gae_duplicate tensor(-1.1067, dtype=torch.float64) tensor(0.9165, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5856, dtype=torch.float64) delta_t tensor(-0.5229, dtype=torch.float64)
6 gae_duplicate tensor(-2.4919, dtype=torch.float64) tensor(7.9411, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1530, dtype=torch.float64) delta_t tensor(-1.0761, dtype=torch.float64)
5 gae_duplicate tensor(-1.6654, dtype=torch.float64) tensor(16.6033, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8460, dtype=torch.float64) delta_t tensor(-1.7348, dtype=torch.float64)
4 gae_duplicate tensor(-6.7151, dtype=torch.float64) tensor(22.1163, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6274, dtype=torch.float64) delta_t tensor(-0.4878, dtype=torch.float64)
3 gae_duplicate tensor(-0.9768, dtype=torch.float64) tensor(6.5521, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6486, dtype=torch.float64) delta_t tensor(-0.5705, dtype=torch.float64)
2 gae_duplicate tensor(-1.0829, dtype=torch.float64) tensor(8.6781, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-754.644775390625
value loss:224.1976776123047
entropies:196.7909393310547
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.2383222579956055 seconds
19 rew tensor(0.7779, dtype=torch.float64) delta_t tensor(0.6017, dtype=torch.float64)
19 gae_duplicate tensor(0.4322, dtype=torch.float64) tensor(-5.6950, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7438, dtype=torch.float64) delta_t tensor(0.5810, dtype=torch.float64)
18 gae_duplicate tensor(0.2932, dtype=torch.float64) tensor(-7.1321, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6593, dtype=torch.float64) delta_t tensor(0.5116, dtype=torch.float64)
17 gae_duplicate tensor(0.0499, dtype=torch.float64) tensor(-6.8368, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5567, dtype=torch.float64) delta_t tensor(0.4629, dtype=torch.float64)
16 gae_duplicate tensor(-0.5514, dtype=torch.float64) tensor(-4.2500, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7142, dtype=torch.float64) delta_t tensor(0.5480, dtype=torch.float64)
15 gae_duplicate tensor(0.1205, dtype=torch.float64) tensor(-7.3676, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7229, dtype=torch.float64) delta_t tensor(0.5430, dtype=torch.float64)
14 gae_duplicate tensor(0.1332, dtype=torch.float64) tensor(-5.6281, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5509, dtype=torch.float64) delta_t tensor(0.5736, dtype=torch.float64)
13 gae_duplicate tensor(0.0835, dtype=torch.float64) tensor(-6.1135, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5283, dtype=torch.float64) delta_t tensor(0.4410, dtype=torch.float64)
12 gae_duplicate tensor(0.0164, dtype=torch.float64) tensor(-7.3142, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2444, dtype=torch.float64) delta_t tensor(0.2468, dtype=torch.float64)
11 gae_duplicate tensor(-0.2921, dtype=torch.float64) tensor(-2.7290, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4882, dtype=torch.float64) delta_t tensor(0.4699, dtype=torch.float64)
10 gae_duplicate tensor(-0.0367, dtype=torch.float64) tensor(-5.4395, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1602, dtype=torch.float64) delta_t tensor(-0.0988, dtype=torch.float64)
9 gae_duplicate tensor(-1.2607, dtype=torch.float64) tensor(2.3836, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0389, dtype=torch.float64) delta_t tensor(-0.0979, dtype=torch.float64)
8 gae_duplicate tensor(-1.7674, dtype=torch.float64) tensor(1.9170, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3699, dtype=torch.float64) delta_t tensor(-0.3248, dtype=torch.float64)
7 gae_duplicate tensor(-1.9330, dtype=torch.float64) tensor(4.1016, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6734, dtype=torch.float64) delta_t tensor(-0.6585, dtype=torch.float64)
6 gae_duplicate tensor(-2.4011, dtype=torch.float64) tensor(6.9643, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6830, dtype=torch.float64) delta_t tensor(-0.6302, dtype=torch.float64)
5 gae_duplicate tensor(-2.2047, dtype=torch.float64) tensor(7.0797, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5899, dtype=torch.float64) delta_t tensor(-0.5284, dtype=torch.float64)
4 gae_duplicate tensor(-1.6823, dtype=torch.float64) tensor(7.2814, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7244, dtype=torch.float64) delta_t tensor(-0.5146, dtype=torch.float64)
3 gae_duplicate tensor(-1.3279, dtype=torch.float64) tensor(5.9794, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6098, dtype=torch.float64) delta_t tensor(-0.5679, dtype=torch.float64)
2 gae_duplicate tensor(-1.2059, dtype=torch.float64) tensor(11.5271, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:370.5545654296875
value loss:93.88417053222656
entropies:195.71975708007812
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.099581003189087 seconds
19 rew tensor(0.8032, dtype=torch.float64) delta_t tensor(0.6127, dtype=torch.float64)
19 gae_duplicate tensor(0.4916, dtype=torch.float64) tensor(-5.4123, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8037, dtype=torch.float64) delta_t tensor(0.6334, dtype=torch.float64)
18 gae_duplicate tensor(0.5871, dtype=torch.float64) tensor(-6.8244, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8042, dtype=torch.float64) delta_t tensor(0.7116, dtype=torch.float64)
17 gae_duplicate tensor(0.6855, dtype=torch.float64) tensor(-9.6836, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8047, dtype=torch.float64) delta_t tensor(0.6809, dtype=torch.float64)
16 gae_duplicate tensor(0.7079, dtype=torch.float64) tensor(-10.1472, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7632, dtype=torch.float64) delta_t tensor(0.7079, dtype=torch.float64)
15 gae_duplicate tensor(0.5412, dtype=torch.float64) tensor(-7.8924, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7381, dtype=torch.float64) delta_t tensor(0.7083, dtype=torch.float64)
14 gae_duplicate tensor(0.5856, dtype=torch.float64) tensor(-12.3772, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7049, dtype=torch.float64) delta_t tensor(0.6628, dtype=torch.float64)
13 gae_duplicate tensor(0.6582, dtype=torch.float64) tensor(-8.0947, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6128, dtype=torch.float64) delta_t tensor(0.6017, dtype=torch.float64)
12 gae_duplicate tensor(0.3147, dtype=torch.float64) tensor(-7.6829, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5893, dtype=torch.float64) delta_t tensor(0.5558, dtype=torch.float64)
11 gae_duplicate tensor(0.0109, dtype=torch.float64) tensor(-6.2867, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1010, dtype=torch.float64) delta_t tensor(0.0839, dtype=torch.float64)
10 gae_duplicate tensor(-1.6917, dtype=torch.float64) tensor(-0.4495, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0934, dtype=torch.float64) delta_t tensor(-1.1134, dtype=torch.float64)
9 gae_duplicate tensor(-4.1122, dtype=torch.float64) tensor(14.3019, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6411, dtype=torch.float64) delta_t tensor(-0.6203, dtype=torch.float64)
8 gae_duplicate tensor(-3.3500, dtype=torch.float64) tensor(12.0255, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7798, dtype=torch.float64) delta_t tensor(-0.7415, dtype=torch.float64)
7 gae_duplicate tensor(-3.3101, dtype=torch.float64) tensor(6.9717, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5806, dtype=torch.float64) delta_t tensor(-0.5151, dtype=torch.float64)
6 gae_duplicate tensor(-2.6300, dtype=torch.float64) tensor(9.8480, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1607, dtype=torch.float64) delta_t tensor(-1.0402, dtype=torch.float64)
5 gae_duplicate tensor(-2.0447, dtype=torch.float64) tensor(8.8182, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3451, dtype=torch.float64) delta_t tensor(-1.3359, dtype=torch.float64)
4 gae_duplicate tensor(-4.4696, dtype=torch.float64) tensor(16.4738, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3909, dtype=torch.float64) delta_t tensor(-0.3012, dtype=torch.float64)
3 gae_duplicate tensor(-1.4573, dtype=torch.float64) tensor(4.4138, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1297, dtype=torch.float64) delta_t tensor(-0.1281, dtype=torch.float64)
2 gae_duplicate tensor(-0.7243, dtype=torch.float64) tensor(1.2152, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6.591745376586914
value loss:198.87339782714844
entropies:193.163330078125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2388.5232)
ToM Target loss= tensor(1809.9423)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.922513961791992 seconds
19 rew tensor(0.6704, dtype=torch.float64) delta_t tensor(0.5007, dtype=torch.float64)
19 gae_duplicate tensor(0.1825, dtype=torch.float64) tensor(-4.7797, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5702, dtype=torch.float64) delta_t tensor(0.3849, dtype=torch.float64)
18 gae_duplicate tensor(-0.5485, dtype=torch.float64) tensor(-4.5761, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7458, dtype=torch.float64) delta_t tensor(0.5812, dtype=torch.float64)
17 gae_duplicate tensor(0.3010, dtype=torch.float64) tensor(-6.6272, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6695, dtype=torch.float64) delta_t tensor(0.5565, dtype=torch.float64)
16 gae_duplicate tensor(0.2214, dtype=torch.float64) tensor(-6.7220, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5505, dtype=torch.float64) delta_t tensor(0.4270, dtype=torch.float64)
15 gae_duplicate tensor(-0.3260, dtype=torch.float64) tensor(-5.5244, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5052, dtype=torch.float64) delta_t tensor(0.4691, dtype=torch.float64)
14 gae_duplicate tensor(-0.0400, dtype=torch.float64) tensor(-7.2697, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5253, dtype=torch.float64) delta_t tensor(0.5839, dtype=torch.float64)
13 gae_duplicate tensor(0.3568, dtype=torch.float64) tensor(-7.4739, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3561, dtype=torch.float64) delta_t tensor(0.3254, dtype=torch.float64)
12 gae_duplicate tensor(-0.2837, dtype=torch.float64) tensor(-3.8317, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3302, dtype=torch.float64) delta_t tensor(0.3505, dtype=torch.float64)
11 gae_duplicate tensor(-0.4247, dtype=torch.float64) tensor(-5.7612, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1632, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
10 gae_duplicate tensor(-1.1180, dtype=torch.float64) tensor(-1.2593, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6588, dtype=torch.float64) delta_t tensor(-0.6434, dtype=torch.float64)
9 gae_duplicate tensor(-1.6665, dtype=torch.float64) tensor(11.0931, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5627, dtype=torch.float64) delta_t tensor(-0.6690, dtype=torch.float64)
8 gae_duplicate tensor(-2.0115, dtype=torch.float64) tensor(5.9119, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7420, dtype=torch.float64) delta_t tensor(-0.7512, dtype=torch.float64)
7 gae_duplicate tensor(-2.1412, dtype=torch.float64) tensor(10.1213, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2970, dtype=torch.float64) delta_t tensor(-0.3257, dtype=torch.float64)
6 gae_duplicate tensor(-1.5718, dtype=torch.float64) tensor(1.6500, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3580, dtype=torch.float64) delta_t tensor(-1.2480, dtype=torch.float64)
5 gae_duplicate tensor(-2.1551, dtype=torch.float64) tensor(10.6611, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6472, dtype=torch.float64) delta_t tensor(-0.5225, dtype=torch.float64)
4 gae_duplicate tensor(-3.9531, dtype=torch.float64) tensor(13.7014, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3367, dtype=torch.float64) delta_t tensor(-0.2085, dtype=torch.float64)
3 gae_duplicate tensor(-1.3466, dtype=torch.float64) tensor(1.3099, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2566, dtype=torch.float64) delta_t tensor(-0.1863, dtype=torch.float64)
2 gae_duplicate tensor(-0.4164, dtype=torch.float64) tensor(2.0357, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-130.2080535888672
value loss:140.2779083251953
entropies:191.5375213623047
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0999109745025635 seconds
19 rew tensor(0.7708, dtype=torch.float64) delta_t tensor(0.5863, dtype=torch.float64)
19 gae_duplicate tensor(0.4413, dtype=torch.float64) tensor(-6.2030, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7625, dtype=torch.float64) delta_t tensor(0.5352, dtype=torch.float64)
18 gae_duplicate tensor(0.3994, dtype=torch.float64) tensor(-7.2239, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7201, dtype=torch.float64) delta_t tensor(0.5388, dtype=torch.float64)
17 gae_duplicate tensor(0.3939, dtype=torch.float64) tensor(-7.5176, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6604, dtype=torch.float64) delta_t tensor(0.4507, dtype=torch.float64)
16 gae_duplicate tensor(0.0301, dtype=torch.float64) tensor(-4.5086, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5403, dtype=torch.float64) delta_t tensor(0.3967, dtype=torch.float64)
15 gae_duplicate tensor(-0.5810, dtype=torch.float64) tensor(-5.8556, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6815, dtype=torch.float64) delta_t tensor(0.5406, dtype=torch.float64)
14 gae_duplicate tensor(0.0791, dtype=torch.float64) tensor(-5.3703, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7568, dtype=torch.float64) delta_t tensor(0.6850, dtype=torch.float64)
13 gae_duplicate tensor(0.3703, dtype=torch.float64) tensor(-7.2980, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6732, dtype=torch.float64) delta_t tensor(0.5534, dtype=torch.float64)
12 gae_duplicate tensor(0.4502, dtype=torch.float64) tensor(-8.0119, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6150, dtype=torch.float64) delta_t tensor(0.5146, dtype=torch.float64)
11 gae_duplicate tensor(0.1748, dtype=torch.float64) tensor(-7.5569, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4722, dtype=torch.float64) delta_t tensor(0.3591, dtype=torch.float64)
10 gae_duplicate tensor(0.1438, dtype=torch.float64) tensor(-5.2546, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6052, dtype=torch.float64) delta_t tensor(-0.7210, dtype=torch.float64)
9 gae_duplicate tensor(-1.5155, dtype=torch.float64) tensor(4.8817, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3904, dtype=torch.float64) delta_t tensor(-0.4381, dtype=torch.float64)
8 gae_duplicate tensor(-1.8018, dtype=torch.float64) tensor(4.5103, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0438, dtype=torch.float64) delta_t tensor(-1.0901, dtype=torch.float64)
7 gae_duplicate tensor(-2.0619, dtype=torch.float64) tensor(11.8829, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0027, dtype=torch.float64) delta_t tensor(-0.8550, dtype=torch.float64)
6 gae_duplicate tensor(-2.9409, dtype=torch.float64) tensor(11.4583, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5619, dtype=torch.float64) delta_t tensor(-1.5470, dtype=torch.float64)
5 gae_duplicate tensor(-2.7831, dtype=torch.float64) tensor(17.4736, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4120, dtype=torch.float64) delta_t tensor(-2.3574, dtype=torch.float64)
4 gae_duplicate tensor(-5.2570, dtype=torch.float64) tensor(21.5180, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4488, dtype=torch.float64) delta_t tensor(-0.2771, dtype=torch.float64)
3 gae_duplicate tensor(-1.2382, dtype=torch.float64) tensor(4.9494, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2325, dtype=torch.float64) delta_t tensor(-0.1615, dtype=torch.float64)
2 gae_duplicate tensor(-0.8896, dtype=torch.float64) tensor(5.6137, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-663.6587524414062
value loss:216.74732971191406
entropies:189.5091552734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.895074129104614 seconds
19 rew tensor(0.6774, dtype=torch.float64) delta_t tensor(0.5169, dtype=torch.float64)
19 gae_duplicate tensor(-0.1282, dtype=torch.float64) tensor(-5.5090, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5762, dtype=torch.float64) delta_t tensor(0.4131, dtype=torch.float64)
18 gae_duplicate tensor(-0.7618, dtype=torch.float64) tensor(-3.9520, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8073, dtype=torch.float64) delta_t tensor(0.6557, dtype=torch.float64)
17 gae_duplicate tensor(0.5515, dtype=torch.float64) tensor(-7.3413, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8078, dtype=torch.float64) delta_t tensor(0.7500, dtype=torch.float64)
16 gae_duplicate tensor(0.6703, dtype=torch.float64) tensor(-9.0353, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7898, dtype=torch.float64) delta_t tensor(0.7241, dtype=torch.float64)
15 gae_duplicate tensor(0.6808, dtype=torch.float64) tensor(-8.2692, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5713, dtype=torch.float64) delta_t tensor(0.5899, dtype=torch.float64)
14 gae_duplicate tensor(-0.1455, dtype=torch.float64) tensor(-7.4543, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3056, dtype=torch.float64) delta_t tensor(0.3615, dtype=torch.float64)
13 gae_duplicate tensor(0.0321, dtype=torch.float64) tensor(-2.9431, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2221, dtype=torch.float64) delta_t tensor(-0.2675, dtype=torch.float64)
12 gae_duplicate tensor(-1.1612, dtype=torch.float64) tensor(0.9300, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3222, dtype=torch.float64) delta_t tensor(0.3201, dtype=torch.float64)
11 gae_duplicate tensor(-0.4699, dtype=torch.float64) tensor(-2.6103, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2183, dtype=torch.float64) delta_t tensor(-0.3241, dtype=torch.float64)
10 gae_duplicate tensor(-1.1017, dtype=torch.float64) tensor(1.1128, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0659, dtype=torch.float64) delta_t tensor(0.0726, dtype=torch.float64)
9 gae_duplicate tensor(-1.2917, dtype=torch.float64) tensor(-0.8103, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0632, dtype=torch.float64) delta_t tensor(0.0030, dtype=torch.float64)
8 gae_duplicate tensor(-0.8479, dtype=torch.float64) tensor(0.9010, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2587, dtype=torch.float64) delta_t tensor(-0.1108, dtype=torch.float64)
7 gae_duplicate tensor(-0.9858, dtype=torch.float64) tensor(0.2556, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1996, dtype=torch.float64) delta_t tensor(-0.1186, dtype=torch.float64)
6 gae_duplicate tensor(-0.7695, dtype=torch.float64) tensor(1.4058, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7410, dtype=torch.float64) delta_t tensor(-0.6079, dtype=torch.float64)
5 gae_duplicate tensor(-1.6695, dtype=torch.float64) tensor(4.9174, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2754, dtype=torch.float64) delta_t tensor(-0.1034, dtype=torch.float64)
4 gae_duplicate tensor(-1.3170, dtype=torch.float64) tensor(2.9305, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5335, dtype=torch.float64) delta_t tensor(-0.5228, dtype=torch.float64)
3 gae_duplicate tensor(-1.1326, dtype=torch.float64) tensor(9.8233, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2210, dtype=torch.float64) delta_t tensor(-0.3076, dtype=torch.float64)
2 gae_duplicate tensor(-0.9815, dtype=torch.float64) tensor(2.0301, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:816.167236328125
value loss:76.66758728027344
entropies:189.44223022460938
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.615848064422607 seconds
19 rew tensor(0.7949, dtype=torch.float64) delta_t tensor(0.6677, dtype=torch.float64)
19 gae_duplicate tensor(0.5757, dtype=torch.float64) tensor(-5.0744, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7876, dtype=torch.float64) delta_t tensor(0.7446, dtype=torch.float64)
18 gae_duplicate tensor(0.7014, dtype=torch.float64) tensor(-10.2477, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7803, dtype=torch.float64) delta_t tensor(0.6551, dtype=torch.float64)
17 gae_duplicate tensor(0.6819, dtype=torch.float64) tensor(-7.0446, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7483, dtype=torch.float64) delta_t tensor(0.7002, dtype=torch.float64)
16 gae_duplicate tensor(0.6594, dtype=torch.float64) tensor(-6.9084, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6737, dtype=torch.float64) delta_t tensor(0.6422, dtype=torch.float64)
15 gae_duplicate tensor(0.5594, dtype=torch.float64) tensor(-7.0548, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7159, dtype=torch.float64) delta_t tensor(0.7230, dtype=torch.float64)
14 gae_duplicate tensor(0.4895, dtype=torch.float64) tensor(-6.5289, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6384, dtype=torch.float64) delta_t tensor(0.6300, dtype=torch.float64)
13 gae_duplicate tensor(0.3664, dtype=torch.float64) tensor(-4.3223, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4480, dtype=torch.float64) delta_t tensor(0.5362, dtype=torch.float64)
12 gae_duplicate tensor(0.4160, dtype=torch.float64) tensor(-7.1405, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3616, dtype=torch.float64) delta_t tensor(0.3632, dtype=torch.float64)
11 gae_duplicate tensor(0.0582, dtype=torch.float64) tensor(-6.6398, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2453, dtype=torch.float64) delta_t tensor(0.1723, dtype=torch.float64)
10 gae_duplicate tensor(-0.5097, dtype=torch.float64) tensor(-3.4149, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1671, dtype=torch.float64) delta_t tensor(-0.2033, dtype=torch.float64)
9 gae_duplicate tensor(-1.3816, dtype=torch.float64) tensor(2.0313, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3905, dtype=torch.float64) delta_t tensor(-0.4772, dtype=torch.float64)
8 gae_duplicate tensor(-1.6627, dtype=torch.float64) tensor(5.4246, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1367, dtype=torch.float64) delta_t tensor(-1.1276, dtype=torch.float64)
7 gae_duplicate tensor(-2.9091, dtype=torch.float64) tensor(11.3188, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9750, dtype=torch.float64) delta_t tensor(-0.9938, dtype=torch.float64)
6 gae_duplicate tensor(-2.3817, dtype=torch.float64) tensor(13.0820, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5660, dtype=torch.float64) delta_t tensor(-1.5842, dtype=torch.float64)
5 gae_duplicate tensor(-3.0331, dtype=torch.float64) tensor(12.8049, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0637, dtype=torch.float64) delta_t tensor(-3.9585, dtype=torch.float64)
4 gae_duplicate tensor(-8.9618, dtype=torch.float64) tensor(40.2684, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5055, dtype=torch.float64) delta_t tensor(-0.3204, dtype=torch.float64)
3 gae_duplicate tensor(-1.5123, dtype=torch.float64) tensor(10.1439, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0737, dtype=torch.float64) delta_t tensor(-0.0863, dtype=torch.float64)
2 gae_duplicate tensor(-0.5288, dtype=torch.float64) tensor(2.0013, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1211.0206298828125
value loss:403.05694580078125
entropies:188.08221435546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.868001222610474 seconds
19 rew tensor(0.5604, dtype=torch.float64) delta_t tensor(0.3561, dtype=torch.float64)
19 gae_duplicate tensor(-0.6831, dtype=torch.float64) tensor(-1.6507, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7762, dtype=torch.float64) delta_t tensor(0.5936, dtype=torch.float64)
18 gae_duplicate tensor(0.4577, dtype=torch.float64) tensor(-7.2094, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7405, dtype=torch.float64) delta_t tensor(0.6512, dtype=torch.float64)
17 gae_duplicate tensor(0.2602, dtype=torch.float64) tensor(-6.8062, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6958, dtype=torch.float64) delta_t tensor(0.4955, dtype=torch.float64)
16 gae_duplicate tensor(-0.0018, dtype=torch.float64) tensor(-5.0944, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5887, dtype=torch.float64) delta_t tensor(0.4325, dtype=torch.float64)
15 gae_duplicate tensor(-0.5460, dtype=torch.float64) tensor(-5.5955, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7880, dtype=torch.float64) delta_t tensor(0.6408, dtype=torch.float64)
14 gae_duplicate tensor(0.5471, dtype=torch.float64) tensor(-6.0009, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6965, dtype=torch.float64) delta_t tensor(0.5378, dtype=torch.float64)
13 gae_duplicate tensor(0.4300, dtype=torch.float64) tensor(-5.8525, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5966, dtype=torch.float64) delta_t tensor(0.4919, dtype=torch.float64)
12 gae_duplicate tensor(0.1060, dtype=torch.float64) tensor(-3.6922, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6552, dtype=torch.float64) delta_t tensor(0.5661, dtype=torch.float64)
11 gae_duplicate tensor(0.2568, dtype=torch.float64) tensor(-6.2332, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4758, dtype=torch.float64) delta_t tensor(0.4561, dtype=torch.float64)
10 gae_duplicate tensor(0.1775, dtype=torch.float64) tensor(-5.5570, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1856, dtype=torch.float64) delta_t tensor(-1.3310, dtype=torch.float64)
9 gae_duplicate tensor(-4.4010, dtype=torch.float64) tensor(10.3986, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.4247, dtype=torch.float64) delta_t tensor(-1.3658, dtype=torch.float64)
8 gae_duplicate tensor(-3.1329, dtype=torch.float64) tensor(10.7723, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6762, dtype=torch.float64) delta_t tensor(-0.6549, dtype=torch.float64)
7 gae_duplicate tensor(-2.3866, dtype=torch.float64) tensor(10.3360, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0119, dtype=torch.float64) delta_t tensor(-0.9964, dtype=torch.float64)
6 gae_duplicate tensor(-1.7789, dtype=torch.float64) tensor(13.1037, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1161, dtype=torch.float64) delta_t tensor(-0.9288, dtype=torch.float64)
5 gae_duplicate tensor(-2.2068, dtype=torch.float64) tensor(11.3265, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0124, dtype=torch.float64) delta_t tensor(-0.8961, dtype=torch.float64)
4 gae_duplicate tensor(-4.9583, dtype=torch.float64) tensor(8.3188, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3606, dtype=torch.float64) delta_t tensor(-0.1888, dtype=torch.float64)
3 gae_duplicate tensor(-1.0609, dtype=torch.float64) tensor(3.5027, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2939, dtype=torch.float64) delta_t tensor(-0.2871, dtype=torch.float64)
2 gae_duplicate tensor(-1.1044, dtype=torch.float64) tensor(4.5053, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-702.4713745117188
value loss:189.16490173339844
entropies:188.24972534179688
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2387.6443)
ToM Target loss= tensor(1809.0676)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.687507152557373 seconds
19 rew tensor(0.6478, dtype=torch.float64) delta_t tensor(0.4303, dtype=torch.float64)
19 gae_duplicate tensor(-0.1157, dtype=torch.float64) tensor(-5.1567, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5110, dtype=torch.float64) delta_t tensor(0.3164, dtype=torch.float64)
18 gae_duplicate tensor(-0.7998, dtype=torch.float64) tensor(-4.4747, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6727, dtype=torch.float64) delta_t tensor(0.4748, dtype=torch.float64)
17 gae_duplicate tensor(0.0178, dtype=torch.float64) tensor(-7.1568, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5816, dtype=torch.float64) delta_t tensor(0.4370, dtype=torch.float64)
16 gae_duplicate tensor(-0.6967, dtype=torch.float64) tensor(-5.0334, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7720, dtype=torch.float64) delta_t tensor(0.6102, dtype=torch.float64)
15 gae_duplicate tensor(0.4739, dtype=torch.float64) tensor(-8.1536, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7486, dtype=torch.float64) delta_t tensor(0.5588, dtype=torch.float64)
14 gae_duplicate tensor(0.3913, dtype=torch.float64) tensor(-5.6356, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6169, dtype=torch.float64) delta_t tensor(0.4992, dtype=torch.float64)
13 gae_duplicate tensor(0.3765, dtype=torch.float64) tensor(-8.0544, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6533, dtype=torch.float64) delta_t tensor(0.5977, dtype=torch.float64)
12 gae_duplicate tensor(0.3972, dtype=torch.float64) tensor(-7.4787, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6058, dtype=torch.float64) delta_t tensor(0.5084, dtype=torch.float64)
11 gae_duplicate tensor(0.2512, dtype=torch.float64) tensor(-5.2619, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5159, dtype=torch.float64) delta_t tensor(0.5014, dtype=torch.float64)
10 gae_duplicate tensor(-0.0130, dtype=torch.float64) tensor(-4.6805, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5227, dtype=torch.float64) delta_t tensor(-0.6410, dtype=torch.float64)
9 gae_duplicate tensor(-2.5789, dtype=torch.float64) tensor(2.9547, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5810, dtype=torch.float64) delta_t tensor(-0.6353, dtype=torch.float64)
8 gae_duplicate tensor(-2.7786, dtype=torch.float64) tensor(7.9746, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1312, dtype=torch.float64) delta_t tensor(-1.2356, dtype=torch.float64)
7 gae_duplicate tensor(-2.8965, dtype=torch.float64) tensor(18.9718, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0082, dtype=torch.float64) delta_t tensor(-0.9843, dtype=torch.float64)
6 gae_duplicate tensor(-2.4166, dtype=torch.float64) tensor(16.0834, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9821, dtype=torch.float64) delta_t tensor(-0.8951, dtype=torch.float64)
5 gae_duplicate tensor(-2.3441, dtype=torch.float64) tensor(14.7993, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1118, dtype=torch.float64) delta_t tensor(-1.9558, dtype=torch.float64)
4 gae_duplicate tensor(-5.6244, dtype=torch.float64) tensor(22.8663, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4845, dtype=torch.float64) delta_t tensor(-0.4220, dtype=torch.float64)
3 gae_duplicate tensor(-1.7788, dtype=torch.float64) tensor(7.3260, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2112, dtype=torch.float64) delta_t tensor(-0.1827, dtype=torch.float64)
2 gae_duplicate tensor(-0.3499, dtype=torch.float64) tensor(2.5056, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1199.9598388671875
value loss:200.3766632080078
entropies:187.37991333007812
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.348827123641968 seconds
19 rew tensor(0.7352, dtype=torch.float64) delta_t tensor(0.5914, dtype=torch.float64)
19 gae_duplicate tensor(0.2917, dtype=torch.float64) tensor(-9.4016, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6924, dtype=torch.float64) delta_t tensor(0.5283, dtype=torch.float64)
18 gae_duplicate tensor(-0.0030, dtype=torch.float64) tensor(-5.1542, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5402, dtype=torch.float64) delta_t tensor(0.3909, dtype=torch.float64)
17 gae_duplicate tensor(-0.5950, dtype=torch.float64) tensor(-4.1941, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7230, dtype=torch.float64) delta_t tensor(0.5961, dtype=torch.float64)
16 gae_duplicate tensor(0.3352, dtype=torch.float64) tensor(-6.8240, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6814, dtype=torch.float64) delta_t tensor(0.5943, dtype=torch.float64)
15 gae_duplicate tensor(0.0909, dtype=torch.float64) tensor(-7.5600, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5042, dtype=torch.float64) delta_t tensor(0.4429, dtype=torch.float64)
14 gae_duplicate tensor(-0.3473, dtype=torch.float64) tensor(-4.2646, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6161, dtype=torch.float64) delta_t tensor(0.5671, dtype=torch.float64)
13 gae_duplicate tensor(0.2134, dtype=torch.float64) tensor(-4.8876, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4834, dtype=torch.float64) delta_t tensor(0.3747, dtype=torch.float64)
12 gae_duplicate tensor(0.0537, dtype=torch.float64) tensor(-4.9360, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4821, dtype=torch.float64) delta_t tensor(0.3598, dtype=torch.float64)
11 gae_duplicate tensor(-0.1061, dtype=torch.float64) tensor(-3.8292, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4157, dtype=torch.float64) delta_t tensor(0.3403, dtype=torch.float64)
10 gae_duplicate tensor(-0.0996, dtype=torch.float64) tensor(-4.6157, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3769, dtype=torch.float64) delta_t tensor(-0.4609, dtype=torch.float64)
9 gae_duplicate tensor(-1.5242, dtype=torch.float64) tensor(3.4907, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6648, dtype=torch.float64) delta_t tensor(-0.6254, dtype=torch.float64)
8 gae_duplicate tensor(-1.8849, dtype=torch.float64) tensor(8.5503, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1608, dtype=torch.float64) delta_t tensor(-1.1549, dtype=torch.float64)
7 gae_duplicate tensor(-3.5139, dtype=torch.float64) tensor(11.9706, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3606, dtype=torch.float64) delta_t tensor(-1.2737, dtype=torch.float64)
6 gae_duplicate tensor(-2.7707, dtype=torch.float64) tensor(19.3316, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8071, dtype=torch.float64) delta_t tensor(-0.7774, dtype=torch.float64)
5 gae_duplicate tensor(-3.3890, dtype=torch.float64) tensor(6.4397, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0561, dtype=torch.float64) delta_t tensor(-1.9192, dtype=torch.float64)
4 gae_duplicate tensor(-5.3742, dtype=torch.float64) tensor(26.2104, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1835, dtype=torch.float64) delta_t tensor(-0.1258, dtype=torch.float64)
3 gae_duplicate tensor(-1.4645, dtype=torch.float64) tensor(5.2068, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3117, dtype=torch.float64) delta_t tensor(-0.2184, dtype=torch.float64)
2 gae_duplicate tensor(-0.5993, dtype=torch.float64) tensor(2.2571, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1034.0084228515625
value loss:207.97119140625
entropies:186.4409942626953
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.257788181304932 seconds
19 rew tensor(0.7935, dtype=torch.float64) delta_t tensor(0.5775, dtype=torch.float64)
19 gae_duplicate tensor(0.4964, dtype=torch.float64) tensor(-7.3854, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7857, dtype=torch.float64) delta_t tensor(0.6104, dtype=torch.float64)
18 gae_duplicate tensor(0.5743, dtype=torch.float64) tensor(-6.4618, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7690, dtype=torch.float64) delta_t tensor(0.5823, dtype=torch.float64)
17 gae_duplicate tensor(0.5618, dtype=torch.float64) tensor(-7.8883, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7271, dtype=torch.float64) delta_t tensor(0.5534, dtype=torch.float64)
16 gae_duplicate tensor(0.3383, dtype=torch.float64) tensor(-5.5576, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6766, dtype=torch.float64) delta_t tensor(0.5019, dtype=torch.float64)
15 gae_duplicate tensor(-0.0028, dtype=torch.float64) tensor(-4.3739, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5418, dtype=torch.float64) delta_t tensor(0.4057, dtype=torch.float64)
14 gae_duplicate tensor(-0.5939, dtype=torch.float64) tensor(-4.1178, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7877, dtype=torch.float64) delta_t tensor(0.6470, dtype=torch.float64)
13 gae_duplicate tensor(0.5423, dtype=torch.float64) tensor(-7.6343, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8045, dtype=torch.float64) delta_t tensor(0.6661, dtype=torch.float64)
12 gae_duplicate tensor(0.6645, dtype=torch.float64) tensor(-5.3386, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7102, dtype=torch.float64) delta_t tensor(0.6971, dtype=torch.float64)
11 gae_duplicate tensor(0.5656, dtype=torch.float64) tensor(-6.0989, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5325, dtype=torch.float64) delta_t tensor(0.4066, dtype=torch.float64)
10 gae_duplicate tensor(0.2408, dtype=torch.float64) tensor(-5.2391, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4723, dtype=torch.float64) delta_t tensor(-0.6129, dtype=torch.float64)
9 gae_duplicate tensor(-2.6671, dtype=torch.float64) tensor(8.2446, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5285, dtype=torch.float64) delta_t tensor(-0.6472, dtype=torch.float64)
8 gae_duplicate tensor(-2.2579, dtype=torch.float64) tensor(13.0474, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6185, dtype=torch.float64) delta_t tensor(-0.6314, dtype=torch.float64)
7 gae_duplicate tensor(-1.5006, dtype=torch.float64) tensor(6.5863, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6994, dtype=torch.float64) delta_t tensor(-0.6453, dtype=torch.float64)
6 gae_duplicate tensor(-1.8530, dtype=torch.float64) tensor(7.6150, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5576, dtype=torch.float64) delta_t tensor(-1.5276, dtype=torch.float64)
5 gae_duplicate tensor(-3.4263, dtype=torch.float64) tensor(16.2265, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8656, dtype=torch.float64) delta_t tensor(-2.7812, dtype=torch.float64)
4 gae_duplicate tensor(-8.0218, dtype=torch.float64) tensor(16.5806, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3013, dtype=torch.float64) delta_t tensor(-0.2431, dtype=torch.float64)
3 gae_duplicate tensor(-1.0636, dtype=torch.float64) tensor(6.8170, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4993, dtype=torch.float64) delta_t tensor(-0.4537, dtype=torch.float64)
2 gae_duplicate tensor(-0.8309, dtype=torch.float64) tensor(5.7037, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-779.4739379882812
value loss:288.41143798828125
entropies:185.33554077148438
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.71802020072937 seconds
19 rew tensor(0.7789, dtype=torch.float64) delta_t tensor(0.5394, dtype=torch.float64)
19 gae_duplicate tensor(0.4052, dtype=torch.float64) tensor(-5.3016, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7376, dtype=torch.float64) delta_t tensor(0.5872, dtype=torch.float64)
18 gae_duplicate tensor(0.4344, dtype=torch.float64) tensor(-6.6198, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5685, dtype=torch.float64) delta_t tensor(0.4618, dtype=torch.float64)
17 gae_duplicate tensor(0.2542, dtype=torch.float64) tensor(-4.2881, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3922, dtype=torch.float64) delta_t tensor(0.2969, dtype=torch.float64)
16 gae_duplicate tensor(-0.0388, dtype=torch.float64) tensor(-4.0367, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2614, dtype=torch.float64) delta_t tensor(0.2370, dtype=torch.float64)
15 gae_duplicate tensor(-0.5382, dtype=torch.float64) tensor(-3.0807, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5156, dtype=torch.float64) delta_t tensor(0.4315, dtype=torch.float64)
14 gae_duplicate tensor(-0.2087, dtype=torch.float64) tensor(-4.7160, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1774, dtype=torch.float64) delta_t tensor(-0.2673, dtype=torch.float64)
13 gae_duplicate tensor(-3.0646, dtype=torch.float64) tensor(2.0466, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4007, dtype=torch.float64) delta_t tensor(0.4351, dtype=torch.float64)
12 gae_duplicate tensor(-0.7485, dtype=torch.float64) tensor(-3.5189, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2258, dtype=torch.float64) delta_t tensor(0.2296, dtype=torch.float64)
11 gae_duplicate tensor(-0.8715, dtype=torch.float64) tensor(-3.0509, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2988, dtype=torch.float64) delta_t tensor(0.1846, dtype=torch.float64)
10 gae_duplicate tensor(-0.4984, dtype=torch.float64) tensor(-1.5303, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1472, dtype=torch.float64) delta_t tensor(-0.1694, dtype=torch.float64)
9 gae_duplicate tensor(-2.3098, dtype=torch.float64) tensor(-0.1382, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1209, dtype=torch.float64) delta_t tensor(-0.0239, dtype=torch.float64)
8 gae_duplicate tensor(-1.5741, dtype=torch.float64) tensor(0.3578, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7047, dtype=torch.float64) delta_t tensor(-0.6789, dtype=torch.float64)
7 gae_duplicate tensor(-2.0459, dtype=torch.float64) tensor(6.2949, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9009, dtype=torch.float64) delta_t tensor(-0.8469, dtype=torch.float64)
6 gae_duplicate tensor(-2.3392, dtype=torch.float64) tensor(6.0866, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5714, dtype=torch.float64) delta_t tensor(-0.4310, dtype=torch.float64)
5 gae_duplicate tensor(-2.0334, dtype=torch.float64) tensor(6.8660, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1128, dtype=torch.float64) delta_t tensor(-1.0490, dtype=torch.float64)
4 gae_duplicate tensor(-3.1516, dtype=torch.float64) tensor(7.6679, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3127, dtype=torch.float64) delta_t tensor(-0.0771, dtype=torch.float64)
3 gae_duplicate tensor(-1.0753, dtype=torch.float64) tensor(4.3561, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3790, dtype=torch.float64) delta_t tensor(-0.3549, dtype=torch.float64)
2 gae_duplicate tensor(-0.5461, dtype=torch.float64) tensor(4.0717, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-86.14716339111328
value loss:128.33863830566406
entropies:185.29933166503906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.841917037963867 seconds
19 rew tensor(0.7646, dtype=torch.float64) delta_t tensor(0.5552, dtype=torch.float64)
19 gae_duplicate tensor(0.3954, dtype=torch.float64) tensor(-5.4875, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7393, dtype=torch.float64) delta_t tensor(0.5497, dtype=torch.float64)
18 gae_duplicate tensor(0.3988, dtype=torch.float64) tensor(-4.1386, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6895, dtype=torch.float64) delta_t tensor(0.4634, dtype=torch.float64)
17 gae_duplicate tensor(0.1378, dtype=torch.float64) tensor(-4.0994, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5634, dtype=torch.float64) delta_t tensor(0.3777, dtype=torch.float64)
16 gae_duplicate tensor(-0.0440, dtype=torch.float64) tensor(-4.7588, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3526, dtype=torch.float64) delta_t tensor(0.2720, dtype=torch.float64)
15 gae_duplicate tensor(-0.6656, dtype=torch.float64) tensor(-1.6386, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6569, dtype=torch.float64) delta_t tensor(0.6485, dtype=torch.float64)
14 gae_duplicate tensor(0.2413, dtype=torch.float64) tensor(-5.8872, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7175, dtype=torch.float64) delta_t tensor(0.6654, dtype=torch.float64)
13 gae_duplicate tensor(0.5331, dtype=torch.float64) tensor(-8.5082, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7594, dtype=torch.float64) delta_t tensor(0.7524, dtype=torch.float64)
12 gae_duplicate tensor(0.6849, dtype=torch.float64) tensor(-7.4943, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6389, dtype=torch.float64) delta_t tensor(0.6881, dtype=torch.float64)
11 gae_duplicate tensor(0.1690, dtype=torch.float64) tensor(-7.3045, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5622, dtype=torch.float64) delta_t tensor(0.5686, dtype=torch.float64)
10 gae_duplicate tensor(-0.0235, dtype=torch.float64) tensor(-5.0486, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5418, dtype=torch.float64) delta_t tensor(-0.6016, dtype=torch.float64)
9 gae_duplicate tensor(-1.4579, dtype=torch.float64) tensor(5.6134, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2358, dtype=torch.float64) delta_t tensor(-0.2588, dtype=torch.float64)
8 gae_duplicate tensor(-0.8552, dtype=torch.float64) tensor(2.0117, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2556, dtype=torch.float64) delta_t tensor(-0.1461, dtype=torch.float64)
7 gae_duplicate tensor(-0.9945, dtype=torch.float64) tensor(2.1025, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2366, dtype=torch.float64) delta_t tensor(-1.2334, dtype=torch.float64)
6 gae_duplicate tensor(-3.2283, dtype=torch.float64) tensor(17.8645, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4541, dtype=torch.float64) delta_t tensor(-1.3417, dtype=torch.float64)
5 gae_duplicate tensor(-2.6504, dtype=torch.float64) tensor(16.7726, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.8896, dtype=torch.float64) delta_t tensor(-4.7402, dtype=torch.float64)
4 gae_duplicate tensor(-9.7353, dtype=torch.float64) tensor(43.1451, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1641, dtype=torch.float64) delta_t tensor(0.0595, dtype=torch.float64)
3 gae_duplicate tensor(-0.7599, dtype=torch.float64) tensor(5.5621, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0054, dtype=torch.float64) delta_t tensor(0.0528, dtype=torch.float64)
2 gae_duplicate tensor(-0.3015, dtype=torch.float64) tensor(0.3479, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1438.9212646484375
value loss:446.7702941894531
entropies:183.16732788085938
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2391.0833)
ToM Target loss= tensor(1808.7506)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.554996967315674 seconds
19 rew tensor(0.7625, dtype=torch.float64) delta_t tensor(0.5779, dtype=torch.float64)
19 gae_duplicate tensor(0.4765, dtype=torch.float64) tensor(-5.9699, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7546, dtype=torch.float64) delta_t tensor(0.6109, dtype=torch.float64)
18 gae_duplicate tensor(0.5847, dtype=torch.float64) tensor(-6.5234, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7107, dtype=torch.float64) delta_t tensor(0.5672, dtype=torch.float64)
17 gae_duplicate tensor(0.3879, dtype=torch.float64) tensor(-5.0797, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6330, dtype=torch.float64) delta_t tensor(0.4659, dtype=torch.float64)
16 gae_duplicate tensor(-0.0162, dtype=torch.float64) tensor(-7.1645, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4841, dtype=torch.float64) delta_t tensor(0.3708, dtype=torch.float64)
15 gae_duplicate tensor(-0.6763, dtype=torch.float64) tensor(-3.3520, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6010, dtype=torch.float64) delta_t tensor(0.4682, dtype=torch.float64)
14 gae_duplicate tensor(-0.5078, dtype=torch.float64) tensor(-4.1681, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7743, dtype=torch.float64) delta_t tensor(0.8827, dtype=torch.float64)
13 gae_duplicate tensor(0.6190, dtype=torch.float64) tensor(-10.3831, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6169, dtype=torch.float64) delta_t tensor(0.5634, dtype=torch.float64)
12 gae_duplicate tensor(0.5303, dtype=torch.float64) tensor(-6.9003, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5836, dtype=torch.float64) delta_t tensor(0.5527, dtype=torch.float64)
11 gae_duplicate tensor(0.4817, dtype=torch.float64) tensor(-7.0522, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4236, dtype=torch.float64) delta_t tensor(0.4071, dtype=torch.float64)
10 gae_duplicate tensor(-0.5255, dtype=torch.float64) tensor(-3.9534, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1568, dtype=torch.float64) delta_t tensor(-0.0036, dtype=torch.float64)
9 gae_duplicate tensor(-1.3203, dtype=torch.float64) tensor(0.4800, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1946, dtype=torch.float64) delta_t tensor(-0.1276, dtype=torch.float64)
8 gae_duplicate tensor(-1.5098, dtype=torch.float64) tensor(1.6638, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3434, dtype=torch.float64) delta_t tensor(-0.3917, dtype=torch.float64)
7 gae_duplicate tensor(-1.6781, dtype=torch.float64) tensor(5.6253, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6832, dtype=torch.float64) delta_t tensor(-0.6561, dtype=torch.float64)
6 gae_duplicate tensor(-1.7642, dtype=torch.float64) tensor(4.7770, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7377, dtype=torch.float64) delta_t tensor(-0.6132, dtype=torch.float64)
5 gae_duplicate tensor(-2.3022, dtype=torch.float64) tensor(5.8748, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2092, dtype=torch.float64) delta_t tensor(-1.1621, dtype=torch.float64)
4 gae_duplicate tensor(-6.7425, dtype=torch.float64) tensor(14.8693, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5629, dtype=torch.float64) delta_t tensor(-0.4104, dtype=torch.float64)
3 gae_duplicate tensor(-1.1270, dtype=torch.float64) tensor(3.5697, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4151, dtype=torch.float64) delta_t tensor(-0.4005, dtype=torch.float64)
2 gae_duplicate tensor(-1.0305, dtype=torch.float64) tensor(5.2653, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:630.193359375
value loss:160.72042846679688
entropies:183.1875762939453
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.925192356109619 seconds
19 rew tensor(0.7622, dtype=torch.float64) delta_t tensor(0.5708, dtype=torch.float64)
19 gae_duplicate tensor(0.4577, dtype=torch.float64) tensor(-5.6584, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7103, dtype=torch.float64) delta_t tensor(0.5325, dtype=torch.float64)
18 gae_duplicate tensor(0.3377, dtype=torch.float64) tensor(-4.6508, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6405, dtype=torch.float64) delta_t tensor(0.5052, dtype=torch.float64)
17 gae_duplicate tensor(0.0271, dtype=torch.float64) tensor(-6.2126, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4844, dtype=torch.float64) delta_t tensor(0.4126, dtype=torch.float64)
16 gae_duplicate tensor(-0.6609, dtype=torch.float64) tensor(-1.7400, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6060, dtype=torch.float64) delta_t tensor(0.5446, dtype=torch.float64)
15 gae_duplicate tensor(-0.4168, dtype=torch.float64) tensor(-7.8457, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7898, dtype=torch.float64) delta_t tensor(0.6953, dtype=torch.float64)
14 gae_duplicate tensor(0.5912, dtype=torch.float64) tensor(-7.3427, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7724, dtype=torch.float64) delta_t tensor(0.8095, dtype=torch.float64)
13 gae_duplicate tensor(0.6668, dtype=torch.float64) tensor(-6.5355, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7168, dtype=torch.float64) delta_t tensor(0.7087, dtype=torch.float64)
12 gae_duplicate tensor(0.5069, dtype=torch.float64) tensor(-5.1673, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6616, dtype=torch.float64) delta_t tensor(0.6969, dtype=torch.float64)
11 gae_duplicate tensor(0.4884, dtype=torch.float64) tensor(-7.1539, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0622, dtype=torch.float64) delta_t tensor(-0.0606, dtype=torch.float64)
10 gae_duplicate tensor(-3.2513, dtype=torch.float64) tensor(-1.5541, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3502, dtype=torch.float64) delta_t tensor(-0.2496, dtype=torch.float64)
9 gae_duplicate tensor(-1.6185, dtype=torch.float64) tensor(0.4597, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2882, dtype=torch.float64) delta_t tensor(-0.1301, dtype=torch.float64)
8 gae_duplicate tensor(-2.6238, dtype=torch.float64) tensor(-1.1248, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3101, dtype=torch.float64) delta_t tensor(-0.2803, dtype=torch.float64)
7 gae_duplicate tensor(-1.9538, dtype=torch.float64) tensor(2.0107, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8484, dtype=torch.float64) delta_t tensor(-0.8814, dtype=torch.float64)
6 gae_duplicate tensor(-2.1399, dtype=torch.float64) tensor(9.5555, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2925, dtype=torch.float64) delta_t tensor(-1.0704, dtype=torch.float64)
5 gae_duplicate tensor(-2.7300, dtype=torch.float64) tensor(12.0265, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1439, dtype=torch.float64) delta_t tensor(-1.0375, dtype=torch.float64)
4 gae_duplicate tensor(-6.2774, dtype=torch.float64) tensor(24.2615, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9258, dtype=torch.float64) delta_t tensor(-0.7618, dtype=torch.float64)
3 gae_duplicate tensor(-1.1797, dtype=torch.float64) tensor(9.6911, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2097, dtype=torch.float64) delta_t tensor(-0.2223, dtype=torch.float64)
2 gae_duplicate tensor(-0.7409, dtype=torch.float64) tensor(4.7229, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-311.48291015625
value loss:193.49627685546875
entropies:182.06161499023438
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.010024785995483 seconds
19 rew tensor(0.7652, dtype=torch.float64) delta_t tensor(0.5708, dtype=torch.float64)
19 gae_duplicate tensor(0.4656, dtype=torch.float64) tensor(-7.1502, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7487, dtype=torch.float64) delta_t tensor(0.6032, dtype=torch.float64)
18 gae_duplicate tensor(0.5420, dtype=torch.float64) tensor(-7.7591, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7159, dtype=torch.float64) delta_t tensor(0.5714, dtype=torch.float64)
17 gae_duplicate tensor(0.5052, dtype=torch.float64) tensor(-4.9057, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6168, dtype=torch.float64) delta_t tensor(0.5004, dtype=torch.float64)
16 gae_duplicate tensor(0.2052, dtype=torch.float64) tensor(-5.3639, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4531, dtype=torch.float64) delta_t tensor(0.3719, dtype=torch.float64)
15 gae_duplicate tensor(-0.0608, dtype=torch.float64) tensor(-3.6788, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3340, dtype=torch.float64) delta_t tensor(0.2190, dtype=torch.float64)
14 gae_duplicate tensor(-0.5922, dtype=torch.float64) tensor(-5.3584, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7992, dtype=torch.float64) delta_t tensor(0.7304, dtype=torch.float64)
13 gae_duplicate tensor(0.5744, dtype=torch.float64) tensor(-7.0174, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7254, dtype=torch.float64) delta_t tensor(0.7219, dtype=torch.float64)
12 gae_duplicate tensor(0.2716, dtype=torch.float64) tensor(-9.7934, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6475, dtype=torch.float64) delta_t tensor(0.6548, dtype=torch.float64)
11 gae_duplicate tensor(0.4483, dtype=torch.float64) tensor(-6.6653, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3501, dtype=torch.float64) delta_t tensor(0.3831, dtype=torch.float64)
10 gae_duplicate tensor(-0.4136, dtype=torch.float64) tensor(-6.0005, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1949, dtype=torch.float64) delta_t tensor(-0.2800, dtype=torch.float64)
9 gae_duplicate tensor(-1.1742, dtype=torch.float64) tensor(1.3034, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8068, dtype=torch.float64) delta_t tensor(-0.8166, dtype=torch.float64)
8 gae_duplicate tensor(-2.5090, dtype=torch.float64) tensor(4.3434, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2822, dtype=torch.float64) delta_t tensor(-1.3969, dtype=torch.float64)
7 gae_duplicate tensor(-2.7947, dtype=torch.float64) tensor(8.8801, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3201, dtype=torch.float64) delta_t tensor(-1.2255, dtype=torch.float64)
6 gae_duplicate tensor(-2.6385, dtype=torch.float64) tensor(7.8381, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2587, dtype=torch.float64) delta_t tensor(-1.1060, dtype=torch.float64)
5 gae_duplicate tensor(-3.0278, dtype=torch.float64) tensor(11.7386, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9252, dtype=torch.float64) delta_t tensor(-1.7138, dtype=torch.float64)
4 gae_duplicate tensor(-5.2845, dtype=torch.float64) tensor(21.3792, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0180, dtype=torch.float64) delta_t tensor(0.0760, dtype=torch.float64)
3 gae_duplicate tensor(-0.5515, dtype=torch.float64) tensor(1.6559, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2394, dtype=torch.float64) delta_t tensor(-0.2169, dtype=torch.float64)
2 gae_duplicate tensor(-0.3552, dtype=torch.float64) tensor(1.9885, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:131.92620849609375
value loss:196.10337829589844
entropies:180.13458251953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.807004928588867 seconds
19 rew tensor(0.7710, dtype=torch.float64) delta_t tensor(0.5463, dtype=torch.float64)
19 gae_duplicate tensor(0.3032, dtype=torch.float64) tensor(-7.2876, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7488, dtype=torch.float64) delta_t tensor(0.5508, dtype=torch.float64)
18 gae_duplicate tensor(0.1550, dtype=torch.float64) tensor(-6.8756, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6890, dtype=torch.float64) delta_t tensor(0.5469, dtype=torch.float64)
17 gae_duplicate tensor(-0.0011, dtype=torch.float64) tensor(-5.6564, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6067, dtype=torch.float64) delta_t tensor(0.4687, dtype=torch.float64)
16 gae_duplicate tensor(-0.5125, dtype=torch.float64) tensor(-6.1848, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7948, dtype=torch.float64) delta_t tensor(0.6724, dtype=torch.float64)
15 gae_duplicate tensor(0.5970, dtype=torch.float64) tensor(-8.8430, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7877, dtype=torch.float64) delta_t tensor(0.6966, dtype=torch.float64)
14 gae_duplicate tensor(0.6395, dtype=torch.float64) tensor(-6.2295, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7711, dtype=torch.float64) delta_t tensor(0.7165, dtype=torch.float64)
13 gae_duplicate tensor(0.5128, dtype=torch.float64) tensor(-8.1190, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5546, dtype=torch.float64) delta_t tensor(0.4458, dtype=torch.float64)
12 gae_duplicate tensor(0.1205, dtype=torch.float64) tensor(-4.9475, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5902, dtype=torch.float64) delta_t tensor(0.5729, dtype=torch.float64)
11 gae_duplicate tensor(0.4721, dtype=torch.float64) tensor(-4.5127, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3962, dtype=torch.float64) delta_t tensor(0.3399, dtype=torch.float64)
10 gae_duplicate tensor(-0.2270, dtype=torch.float64) tensor(-3.2102, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0553, dtype=torch.float64) delta_t tensor(0.0169, dtype=torch.float64)
9 gae_duplicate tensor(-1.3855, dtype=torch.float64) tensor(0.1289, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0216, dtype=torch.float64) delta_t tensor(0.0087, dtype=torch.float64)
8 gae_duplicate tensor(-0.4440, dtype=torch.float64) tensor(-0.7158, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3371, dtype=torch.float64) delta_t tensor(-0.3214, dtype=torch.float64)
7 gae_duplicate tensor(-1.5775, dtype=torch.float64) tensor(2.8105, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6660, dtype=torch.float64) delta_t tensor(-0.6856, dtype=torch.float64)
6 gae_duplicate tensor(-1.9068, dtype=torch.float64) tensor(8.2299, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0738, dtype=torch.float64) delta_t tensor(-0.9118, dtype=torch.float64)
5 gae_duplicate tensor(-2.5666, dtype=torch.float64) tensor(12.1462, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5973, dtype=torch.float64) delta_t tensor(-2.3223, dtype=torch.float64)
4 gae_duplicate tensor(-12.5582, dtype=torch.float64) tensor(25.7626, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6018, dtype=torch.float64) delta_t tensor(-0.4700, dtype=torch.float64)
3 gae_duplicate tensor(-1.3272, dtype=torch.float64) tensor(8.4127, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1797, dtype=torch.float64) delta_t tensor(-0.2082, dtype=torch.float64)
2 gae_duplicate tensor(-0.7438, dtype=torch.float64) tensor(1.6775, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:90.4611587524414
value loss:330.784912109375
entropies:180.15316772460938
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0537190437316895 seconds
19 rew tensor(0.7503, dtype=torch.float64) delta_t tensor(0.5636, dtype=torch.float64)
19 gae_duplicate tensor(0.5078, dtype=torch.float64) tensor(-6.2816, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7336, dtype=torch.float64) delta_t tensor(0.5881, dtype=torch.float64)
18 gae_duplicate tensor(0.5612, dtype=torch.float64) tensor(-6.3672, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6822, dtype=torch.float64) delta_t tensor(0.5780, dtype=torch.float64)
17 gae_duplicate tensor(0.3924, dtype=torch.float64) tensor(-4.7308, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5719, dtype=torch.float64) delta_t tensor(0.4392, dtype=torch.float64)
16 gae_duplicate tensor(0.1178, dtype=torch.float64) tensor(-4.7686, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3594, dtype=torch.float64) delta_t tensor(0.2751, dtype=torch.float64)
15 gae_duplicate tensor(-0.3571, dtype=torch.float64) tensor(-3.7338, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1724, dtype=torch.float64) delta_t tensor(0.1530, dtype=torch.float64)
14 gae_duplicate tensor(-0.5278, dtype=torch.float64) tensor(0.7977, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7602, dtype=torch.float64) delta_t tensor(0.7067, dtype=torch.float64)
13 gae_duplicate tensor(0.4112, dtype=torch.float64) tensor(-7.8894, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7792, dtype=torch.float64) delta_t tensor(0.7336, dtype=torch.float64)
12 gae_duplicate tensor(0.5745, dtype=torch.float64) tensor(-6.5000, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7476, dtype=torch.float64) delta_t tensor(0.8145, dtype=torch.float64)
11 gae_duplicate tensor(0.8265, dtype=torch.float64) tensor(-10.0333, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4707, dtype=torch.float64) delta_t tensor(0.3630, dtype=torch.float64)
10 gae_duplicate tensor(-0.2701, dtype=torch.float64) tensor(-4.9772, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9426, dtype=torch.float64) delta_t tensor(-1.1144, dtype=torch.float64)
9 gae_duplicate tensor(-3.3059, dtype=torch.float64) tensor(8.5867, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9041, dtype=torch.float64) delta_t tensor(-1.0642, dtype=torch.float64)
8 gae_duplicate tensor(-3.0429, dtype=torch.float64) tensor(11.6625, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7137, dtype=torch.float64) delta_t tensor(-0.8018, dtype=torch.float64)
7 gae_duplicate tensor(-2.2053, dtype=torch.float64) tensor(7.7101, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0416, dtype=torch.float64) delta_t tensor(-1.1155, dtype=torch.float64)
6 gae_duplicate tensor(-2.5292, dtype=torch.float64) tensor(11.9348, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7322, dtype=torch.float64) delta_t tensor(-1.5346, dtype=torch.float64)
5 gae_duplicate tensor(-3.3669, dtype=torch.float64) tensor(11.5764, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8900, dtype=torch.float64) delta_t tensor(-2.7855, dtype=torch.float64)
4 gae_duplicate tensor(-6.1286, dtype=torch.float64) tensor(36.4162, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4840, dtype=torch.float64) delta_t tensor(-0.2860, dtype=torch.float64)
3 gae_duplicate tensor(-1.6645, dtype=torch.float64) tensor(4.0295, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1041, dtype=torch.float64) delta_t tensor(-0.0167, dtype=torch.float64)
2 gae_duplicate tensor(-0.3349, dtype=torch.float64) tensor(1.1258, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1420.120361328125
value loss:288.1516418457031
entropies:177.9852752685547
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2401.6792)
ToM Target loss= tensor(1808.4333)
optimized based on ToM loss
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt