obs <crafter.objects.Shelter object at 0x13b21a7f0> [ 0 39  0  0 39  0  0 12  0]
obs <crafter.objects.Warehouse object at 0x128c94520> [ 0 38  0  0 43  0  0  9  0]
obs <crafter.objects.Station object at 0x13b221520> [ 0  9  0  0  9  0  0 12  0]
obs <crafter.objects.Shelter object at 0x13b21a7f0> [ 0 39  0  0 39  0  0  9  0]
obs <crafter.objects.Warehouse object at 0x128c94520> [ 0 44  0  0 42  0  0  9  0]
obs <crafter.objects.Station object at 0x13b221520> [ 0  9  0  0  9  0  0 12  0]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0031769275665283203 seconds
19 rew tensor(0.8779, dtype=torch.float64) delta_t tensor(0.7346, dtype=torch.float64)
19 gae_duplicate tensor(0.5235, dtype=torch.float64) tensor(-7.9396, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8973, dtype=torch.float64) delta_t tensor(0.7917, dtype=torch.float64)
18 gae_duplicate tensor(0.7457, dtype=torch.float64) tensor(-10.4504, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8954, dtype=torch.float64) delta_t tensor(0.7618, dtype=torch.float64)
17 gae_duplicate tensor(0.7938, dtype=torch.float64) tensor(-9.8271, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8948, dtype=torch.float64) delta_t tensor(0.7078, dtype=torch.float64)
16 gae_duplicate tensor(0.5502, dtype=torch.float64) tensor(-9.0668, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.8015, dtype=torch.float64)
15 gae_duplicate tensor(0.0185, dtype=torch.float64) tensor(-10.9740, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.1268, dtype=torch.float64) delta_t tensor(1.1000, dtype=torch.float64)
14 gae_duplicate tensor(1.0300, dtype=torch.float64) tensor(-14.3162, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.2297, dtype=torch.float64) delta_t tensor(1.2101, dtype=torch.float64)
13 gae_duplicate tensor(1.1808, dtype=torch.float64) tensor(-15.5766, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.2770, dtype=torch.float64) delta_t tensor(1.2470, dtype=torch.float64)
12 gae_duplicate tensor(1.2778, dtype=torch.float64) tensor(-16.6377, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.3226, dtype=torch.float64) delta_t tensor(1.2876, dtype=torch.float64)
11 gae_duplicate tensor(1.0089, dtype=torch.float64) tensor(-17.3234, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(1.3128, dtype=torch.float64) delta_t tensor(1.2040, dtype=torch.float64)
10 gae_duplicate tensor(0.7789, dtype=torch.float64) tensor(-16.2516, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(1.2575, dtype=torch.float64) delta_t tensor(1.1743, dtype=torch.float64)
9 gae_duplicate tensor(0.5973, dtype=torch.float64) tensor(-15.1836, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(1.2412, dtype=torch.float64) delta_t tensor(1.1200, dtype=torch.float64)
8 gae_duplicate tensor(0.1425, dtype=torch.float64) tensor(-13.7166, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(1.2496, dtype=torch.float64) delta_t tensor(1.0990, dtype=torch.float64)
7 gae_duplicate tensor(0.8814, dtype=torch.float64) tensor(-15.1866, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4549, dtype=torch.float64) delta_t tensor(0.1561, dtype=torch.float64)
6 gae_duplicate tensor(-0.4416, dtype=torch.float64) tensor(-4.1724, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3194, dtype=torch.float64) delta_t tensor(-0.5226, dtype=torch.float64)
5 gae_duplicate tensor(-1.0056, dtype=torch.float64) tensor(6.6136, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0283, dtype=torch.float64) delta_t tensor(-1.2368, dtype=torch.float64)
4 gae_duplicate tensor(-1.4841, dtype=torch.float64) tensor(14.9276, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8452, dtype=torch.float64) delta_t tensor(-1.1032, dtype=torch.float64)
3 gae_duplicate tensor(-1.7053, dtype=torch.float64) tensor(13.4314, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0572, dtype=torch.float64) delta_t tensor(-1.2887, dtype=torch.float64)
2 gae_duplicate tensor(-1.5663, dtype=torch.float64) tensor(18.2280, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4403.6767578125
value loss:218.7411346435547
entropies:219.51832580566406
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 4.645011901855469 seconds
19 rew tensor(0.8237, dtype=torch.float64) delta_t tensor(0.6567, dtype=torch.float64)
19 gae_duplicate tensor(0.4509, dtype=torch.float64) tensor(-7.6304, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8424, dtype=torch.float64) delta_t tensor(0.7388, dtype=torch.float64)
18 gae_duplicate tensor(0.5089, dtype=torch.float64) tensor(-9.1809, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8625, dtype=torch.float64) delta_t tensor(0.7300, dtype=torch.float64)
17 gae_duplicate tensor(0.4501, dtype=torch.float64) tensor(-10.0218, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8791, dtype=torch.float64) delta_t tensor(0.7633, dtype=torch.float64)
16 gae_duplicate tensor(0.4248, dtype=torch.float64) tensor(-10.2386, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9025, dtype=torch.float64) delta_t tensor(0.8651, dtype=torch.float64)
15 gae_duplicate tensor(0.4270, dtype=torch.float64) tensor(-12.0739, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9280, dtype=torch.float64) delta_t tensor(0.8856, dtype=torch.float64)
14 gae_duplicate tensor(0.4386, dtype=torch.float64) tensor(-11.7695, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9509, dtype=torch.float64) delta_t tensor(0.9173, dtype=torch.float64)
13 gae_duplicate tensor(0.4241, dtype=torch.float64) tensor(-13.4148, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9911, dtype=torch.float64) delta_t tensor(0.9408, dtype=torch.float64)
12 gae_duplicate tensor(0.4897, dtype=torch.float64) tensor(-11.2388, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8723, dtype=torch.float64) delta_t tensor(0.8156, dtype=torch.float64)
11 gae_duplicate tensor(0.4935, dtype=torch.float64) tensor(-10.9501, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7471, dtype=torch.float64) delta_t tensor(0.6564, dtype=torch.float64)
10 gae_duplicate tensor(0.1292, dtype=torch.float64) tensor(-8.8135, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2474, dtype=torch.float64) delta_t tensor(0.1827, dtype=torch.float64)
9 gae_duplicate tensor(-0.7782, dtype=torch.float64) tensor(-3.8643, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2464, dtype=torch.float64) delta_t tensor(0.1266, dtype=torch.float64)
8 gae_duplicate tensor(-0.1490, dtype=torch.float64) tensor(-1.7780, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0050, dtype=torch.float64) delta_t tensor(-0.1482, dtype=torch.float64)
7 gae_duplicate tensor(-1.0590, dtype=torch.float64) tensor(2.0583, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7574, dtype=torch.float64) delta_t tensor(-1.0322, dtype=torch.float64)
6 gae_duplicate tensor(-1.4744, dtype=torch.float64) tensor(12.3661, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3106, dtype=torch.float64) delta_t tensor(-1.4999, dtype=torch.float64)
5 gae_duplicate tensor(-2.1061, dtype=torch.float64) tensor(19.8909, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1019, dtype=torch.float64) delta_t tensor(-2.2712, dtype=torch.float64)
4 gae_duplicate tensor(-4.7747, dtype=torch.float64) tensor(34.5911, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2212, dtype=torch.float64) delta_t tensor(-1.4668, dtype=torch.float64)
3 gae_duplicate tensor(-2.6032, dtype=torch.float64) tensor(18.4248, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1074, dtype=torch.float64) delta_t tensor(-1.3112, dtype=torch.float64)
2 gae_duplicate tensor(-2.1243, dtype=torch.float64) tensor(19.8577, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:96.9122543334961
value loss:233.70506286621094
entropies:218.70919799804688
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8739237785339355 seconds
19 rew tensor(0.8034, dtype=torch.float64) delta_t tensor(0.6498, dtype=torch.float64)
19 gae_duplicate tensor(0.2731, dtype=torch.float64) tensor(-7.6621, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8040, dtype=torch.float64) delta_t tensor(0.6458, dtype=torch.float64)
18 gae_duplicate tensor(0.4561, dtype=torch.float64) tensor(-8.0254, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7830, dtype=torch.float64) delta_t tensor(0.5907, dtype=torch.float64)
17 gae_duplicate tensor(0.2733, dtype=torch.float64) tensor(-7.3907, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7080, dtype=torch.float64) delta_t tensor(0.6077, dtype=torch.float64)
16 gae_duplicate tensor(-0.0103, dtype=torch.float64) tensor(-9.5155, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6010, dtype=torch.float64) delta_t tensor(0.5506, dtype=torch.float64)
15 gae_duplicate tensor(-0.6756, dtype=torch.float64) tensor(-7.9963, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8786, dtype=torch.float64) delta_t tensor(0.8354, dtype=torch.float64)
14 gae_duplicate tensor(0.5730, dtype=torch.float64) tensor(-9.5932, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8936, dtype=torch.float64) delta_t tensor(0.8445, dtype=torch.float64)
13 gae_duplicate tensor(0.5927, dtype=torch.float64) tensor(-12.4349, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9094, dtype=torch.float64) delta_t tensor(0.8539, dtype=torch.float64)
12 gae_duplicate tensor(0.5828, dtype=torch.float64) tensor(-10.1088, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9261, dtype=torch.float64) delta_t tensor(0.8694, dtype=torch.float64)
11 gae_duplicate tensor(0.5561, dtype=torch.float64) tensor(-12.6143, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8823, dtype=torch.float64) delta_t tensor(0.7758, dtype=torch.float64)
10 gae_duplicate tensor(0.3893, dtype=torch.float64) tensor(-10.9983, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5948, dtype=torch.float64) delta_t tensor(0.4866, dtype=torch.float64)
9 gae_duplicate tensor(0.2334, dtype=torch.float64) tensor(-6.1343, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4300, dtype=torch.float64) delta_t tensor(0.2689, dtype=torch.float64)
8 gae_duplicate tensor(-0.0281, dtype=torch.float64) tensor(-3.9566, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1205, dtype=torch.float64) delta_t tensor(0.0475, dtype=torch.float64)
7 gae_duplicate tensor(-0.5748, dtype=torch.float64) tensor(-0.8521, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4952, dtype=torch.float64) delta_t tensor(-0.8576, dtype=torch.float64)
6 gae_duplicate tensor(-1.3329, dtype=torch.float64) tensor(10.5337, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7813, dtype=torch.float64) delta_t tensor(-0.9445, dtype=torch.float64)
5 gae_duplicate tensor(-1.5640, dtype=torch.float64) tensor(10.9924, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4264, dtype=torch.float64) delta_t tensor(-1.6561, dtype=torch.float64)
4 gae_duplicate tensor(-2.2532, dtype=torch.float64) tensor(18.7983, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3586, dtype=torch.float64) delta_t tensor(-1.6263, dtype=torch.float64)
3 gae_duplicate tensor(-2.4387, dtype=torch.float64) tensor(21.7782, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0064, dtype=torch.float64) delta_t tensor(-1.2710, dtype=torch.float64)
2 gae_duplicate tensor(-1.8168, dtype=torch.float64) tensor(18.6023, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:917.5824584960938
value loss:167.0830078125
entropies:217.8315887451172
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.850717782974243 seconds
19 rew tensor(0.8204, dtype=torch.float64) delta_t tensor(0.6329, dtype=torch.float64)
19 gae_duplicate tensor(0.2817, dtype=torch.float64) tensor(-8.3602, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8293, dtype=torch.float64) delta_t tensor(0.6832, dtype=torch.float64)
18 gae_duplicate tensor(0.4982, dtype=torch.float64) tensor(-9.2192, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8384, dtype=torch.float64) delta_t tensor(0.6680, dtype=torch.float64)
17 gae_duplicate tensor(0.4725, dtype=torch.float64) tensor(-8.9842, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8480, dtype=torch.float64) delta_t tensor(0.7203, dtype=torch.float64)
16 gae_duplicate tensor(0.5317, dtype=torch.float64) tensor(-9.7203, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8578, dtype=torch.float64) delta_t tensor(0.7966, dtype=torch.float64)
15 gae_duplicate tensor(0.5655, dtype=torch.float64) tensor(-10.7557, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8680, dtype=torch.float64) delta_t tensor(0.8003, dtype=torch.float64)
14 gae_duplicate tensor(0.5848, dtype=torch.float64) tensor(-10.8187, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8786, dtype=torch.float64) delta_t tensor(0.8038, dtype=torch.float64)
13 gae_duplicate tensor(0.5910, dtype=torch.float64) tensor(-11.3900, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8896, dtype=torch.float64) delta_t tensor(0.8176, dtype=torch.float64)
12 gae_duplicate tensor(0.5974, dtype=torch.float64) tensor(-10.5042, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8569, dtype=torch.float64) delta_t tensor(0.7906, dtype=torch.float64)
11 gae_duplicate tensor(0.6040, dtype=torch.float64) tensor(-10.6618, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7890, dtype=torch.float64) delta_t tensor(0.6421, dtype=torch.float64)
10 gae_duplicate tensor(0.4777, dtype=torch.float64) tensor(-9.2300, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5868, dtype=torch.float64) delta_t tensor(0.4557, dtype=torch.float64)
9 gae_duplicate tensor(0.2929, dtype=torch.float64) tensor(-5.8564, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3325, dtype=torch.float64) delta_t tensor(0.1471, dtype=torch.float64)
8 gae_duplicate tensor(-0.1578, dtype=torch.float64) tensor(-2.2502, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0282, dtype=torch.float64) delta_t tensor(-0.1328, dtype=torch.float64)
7 gae_duplicate tensor(-0.4990, dtype=torch.float64) tensor(1.6266, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7565, dtype=torch.float64) delta_t tensor(-1.1219, dtype=torch.float64)
6 gae_duplicate tensor(-1.4141, dtype=torch.float64) tensor(14.1347, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0509, dtype=torch.float64) delta_t tensor(-1.1979, dtype=torch.float64)
5 gae_duplicate tensor(-1.8009, dtype=torch.float64) tensor(16.0478, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6274, dtype=torch.float64) delta_t tensor(-1.8465, dtype=torch.float64)
4 gae_duplicate tensor(-2.4758, dtype=torch.float64) tensor(25.4464, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4082, dtype=torch.float64) delta_t tensor(-1.6866, dtype=torch.float64)
3 gae_duplicate tensor(-2.3282, dtype=torch.float64) tensor(21.0288, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1619, dtype=torch.float64) delta_t tensor(-1.4381, dtype=torch.float64)
2 gae_duplicate tensor(-2.3488, dtype=torch.float64) tensor(20.7859, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:273.28765869140625
value loss:190.3837890625
entropies:217.83914184570312
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.721344709396362 seconds
19 rew tensor(0.8072, dtype=torch.float64) delta_t tensor(0.5950, dtype=torch.float64)
19 gae_duplicate tensor(0.2889, dtype=torch.float64) tensor(-6.7347, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.6046, dtype=torch.float64)
18 gae_duplicate tensor(0.4499, dtype=torch.float64) tensor(-7.6284, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8119, dtype=torch.float64) delta_t tensor(0.5729, dtype=torch.float64)
17 gae_duplicate tensor(0.4044, dtype=torch.float64) tensor(-8.1980, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8190, dtype=torch.float64) delta_t tensor(0.6429, dtype=torch.float64)
16 gae_duplicate tensor(0.4427, dtype=torch.float64) tensor(-9.3980, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8171, dtype=torch.float64) delta_t tensor(0.7238, dtype=torch.float64)
15 gae_duplicate tensor(0.6198, dtype=torch.float64) tensor(-9.1779, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8063, dtype=torch.float64) delta_t tensor(0.6813, dtype=torch.float64)
14 gae_duplicate tensor(0.3702, dtype=torch.float64) tensor(-8.4512, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7864, dtype=torch.float64) delta_t tensor(0.6771, dtype=torch.float64)
13 gae_duplicate tensor(0.3147, dtype=torch.float64) tensor(-9.8469, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8567, dtype=torch.float64) delta_t tensor(0.7428, dtype=torch.float64)
12 gae_duplicate tensor(0.6317, dtype=torch.float64) tensor(-10.7765, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8028, dtype=torch.float64) delta_t tensor(0.6767, dtype=torch.float64)
11 gae_duplicate tensor(0.2519, dtype=torch.float64) tensor(-9.5089, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6989, dtype=torch.float64) delta_t tensor(0.5448, dtype=torch.float64)
10 gae_duplicate tensor(0.1265, dtype=torch.float64) tensor(-8.3199, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0585, dtype=torch.float64) delta_t tensor(-0.1988, dtype=torch.float64)
9 gae_duplicate tensor(-2.7729, dtype=torch.float64) tensor(3.5629, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1094, dtype=torch.float64) delta_t tensor(-0.0704, dtype=torch.float64)
8 gae_duplicate tensor(-1.0520, dtype=torch.float64) tensor(1.0679, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0968, dtype=torch.float64) delta_t tensor(-0.0659, dtype=torch.float64)
7 gae_duplicate tensor(-0.2783, dtype=torch.float64) tensor(1.0911, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0322, dtype=torch.float64) delta_t tensor(-1.3537, dtype=torch.float64)
6 gae_duplicate tensor(-2.4307, dtype=torch.float64) tensor(18.4465, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8713, dtype=torch.float64) delta_t tensor(-2.0429, dtype=torch.float64)
5 gae_duplicate tensor(-5.4795, dtype=torch.float64) tensor(27.2945, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5077, dtype=torch.float64) delta_t tensor(-1.6725, dtype=torch.float64)
4 gae_duplicate tensor(-2.4458, dtype=torch.float64) tensor(21.9387, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4000, dtype=torch.float64) delta_t tensor(-1.6523, dtype=torch.float64)
3 gae_duplicate tensor(-2.4356, dtype=torch.float64) tensor(22.9313, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3111, dtype=torch.float64) delta_t tensor(-1.5657, dtype=torch.float64)
2 gae_duplicate tensor(-2.3096, dtype=torch.float64) tensor(23.8957, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1197.9493408203125
value loss:244.59967041015625
entropies:217.59727478027344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2505.9556)
ToM Target loss= tensor(1800.5923)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.811966180801392 seconds
19 rew tensor(0.7779, dtype=torch.float64) delta_t tensor(0.5478, dtype=torch.float64)
19 gae_duplicate tensor(0.4261, dtype=torch.float64) tensor(-6.6564, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7628, dtype=torch.float64) delta_t tensor(0.5678, dtype=torch.float64)
18 gae_duplicate tensor(0.4741, dtype=torch.float64) tensor(-7.6716, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6663, dtype=torch.float64) delta_t tensor(0.4414, dtype=torch.float64)
17 gae_duplicate tensor(0.1760, dtype=torch.float64) tensor(-5.8935, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5490, dtype=torch.float64) delta_t tensor(0.3845, dtype=torch.float64)
16 gae_duplicate tensor(-0.0590, dtype=torch.float64) tensor(-4.6034, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2600, dtype=torch.float64) delta_t tensor(0.1659, dtype=torch.float64)
15 gae_duplicate tensor(-0.6601, dtype=torch.float64) tensor(-2.3370, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8455, dtype=torch.float64) delta_t tensor(0.7359, dtype=torch.float64)
14 gae_duplicate tensor(0.5303, dtype=torch.float64) tensor(-9.1236, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8520, dtype=torch.float64) delta_t tensor(0.7529, dtype=torch.float64)
13 gae_duplicate tensor(0.6442, dtype=torch.float64) tensor(-10.1353, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8377, dtype=torch.float64) delta_t tensor(0.7181, dtype=torch.float64)
12 gae_duplicate tensor(0.6262, dtype=torch.float64) tensor(-10.2494, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6545, dtype=torch.float64) delta_t tensor(0.5569, dtype=torch.float64)
11 gae_duplicate tensor(0.1116, dtype=torch.float64) tensor(-7.1587, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5961, dtype=torch.float64) delta_t tensor(0.3976, dtype=torch.float64)
10 gae_duplicate tensor(-0.0563, dtype=torch.float64) tensor(-5.7593, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3382, dtype=torch.float64) delta_t tensor(0.1889, dtype=torch.float64)
9 gae_duplicate tensor(-0.0102, dtype=torch.float64) tensor(-3.0168, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0589, dtype=torch.float64) delta_t tensor(-0.1408, dtype=torch.float64)
8 gae_duplicate tensor(-0.6381, dtype=torch.float64) tensor(1.0343, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3090, dtype=torch.float64) delta_t tensor(-0.4628, dtype=torch.float64)
7 gae_duplicate tensor(-1.1503, dtype=torch.float64) tensor(6.2995, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8422, dtype=torch.float64) delta_t tensor(-1.1556, dtype=torch.float64)
6 gae_duplicate tensor(-1.8147, dtype=torch.float64) tensor(17.6739, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3122, dtype=torch.float64) delta_t tensor(-1.4793, dtype=torch.float64)
5 gae_duplicate tensor(-2.2483, dtype=torch.float64) tensor(16.9063, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6205, dtype=torch.float64) delta_t tensor(-1.8398, dtype=torch.float64)
4 gae_duplicate tensor(-2.4111, dtype=torch.float64) tensor(23.0026, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5669, dtype=torch.float64) delta_t tensor(-1.8429, dtype=torch.float64)
3 gae_duplicate tensor(-2.7328, dtype=torch.float64) tensor(24.4494, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0749, dtype=torch.float64) delta_t tensor(-1.3613, dtype=torch.float64)
2 gae_duplicate tensor(-2.4432, dtype=torch.float64) tensor(18.9311, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1323.9801025390625
value loss:186.22164916992188
entropies:217.03321838378906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.711741209030151 seconds
19 rew tensor(0.8255, dtype=torch.float64) delta_t tensor(0.5901, dtype=torch.float64)
19 gae_duplicate tensor(0.4940, dtype=torch.float64) tensor(-7.7779, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8305, dtype=torch.float64) delta_t tensor(0.6026, dtype=torch.float64)
18 gae_duplicate tensor(0.5916, dtype=torch.float64) tensor(-7.5359, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8357, dtype=torch.float64) delta_t tensor(0.6171, dtype=torch.float64)
17 gae_duplicate tensor(0.6229, dtype=torch.float64) tensor(-7.7063, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8409, dtype=torch.float64) delta_t tensor(0.6023, dtype=torch.float64)
16 gae_duplicate tensor(0.5409, dtype=torch.float64) tensor(-8.6795, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8463, dtype=torch.float64) delta_t tensor(0.7349, dtype=torch.float64)
15 gae_duplicate tensor(0.6575, dtype=torch.float64) tensor(-9.7051, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8517, dtype=torch.float64) delta_t tensor(0.7435, dtype=torch.float64)
14 gae_duplicate tensor(0.6704, dtype=torch.float64) tensor(-10.0633, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8573, dtype=torch.float64) delta_t tensor(0.7272, dtype=torch.float64)
13 gae_duplicate tensor(0.6881, dtype=torch.float64) tensor(-10.5058, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8629, dtype=torch.float64) delta_t tensor(0.7302, dtype=torch.float64)
12 gae_duplicate tensor(0.7034, dtype=torch.float64) tensor(-9.9499, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8687, dtype=torch.float64) delta_t tensor(0.7590, dtype=torch.float64)
11 gae_duplicate tensor(0.7076, dtype=torch.float64) tensor(-11.5388, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8321, dtype=torch.float64) delta_t tensor(0.6266, dtype=torch.float64)
10 gae_duplicate tensor(0.5180, dtype=torch.float64) tensor(-8.3830, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5328, dtype=torch.float64) delta_t tensor(0.3244, dtype=torch.float64)
9 gae_duplicate tensor(0.2441, dtype=torch.float64) tensor(-4.3565, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2811, dtype=torch.float64) delta_t tensor(0.0634, dtype=torch.float64)
8 gae_duplicate tensor(-0.1156, dtype=torch.float64) tensor(-1.1077, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0530, dtype=torch.float64) delta_t tensor(-0.2268, dtype=torch.float64)
7 gae_duplicate tensor(-0.6167, dtype=torch.float64) tensor(2.5875, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8177, dtype=torch.float64) delta_t tensor(-1.1814, dtype=torch.float64)
6 gae_duplicate tensor(-1.7148, dtype=torch.float64) tensor(12.6615, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1247, dtype=torch.float64) delta_t tensor(-1.2627, dtype=torch.float64)
5 gae_duplicate tensor(-1.8992, dtype=torch.float64) tensor(17.2995, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7843, dtype=torch.float64) delta_t tensor(-1.9693, dtype=torch.float64)
4 gae_duplicate tensor(-2.5351, dtype=torch.float64) tensor(25.4012, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5480, dtype=torch.float64) delta_t tensor(-1.8074, dtype=torch.float64)
3 gae_duplicate tensor(-2.4853, dtype=torch.float64) tensor(28.1966, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2451, dtype=torch.float64) delta_t tensor(-1.5288, dtype=torch.float64)
2 gae_duplicate tensor(-2.2164, dtype=torch.float64) tensor(22.1787, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-435.5189514160156
value loss:192.31903076171875
entropies:216.48770141601562
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.406341791152954 seconds
19 rew tensor(0.8145, dtype=torch.float64) delta_t tensor(0.5407, dtype=torch.float64)
19 gae_duplicate tensor(0.4477, dtype=torch.float64) tensor(-6.5793, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7764, dtype=torch.float64) delta_t tensor(0.5051, dtype=torch.float64)
18 gae_duplicate tensor(0.4401, dtype=torch.float64) tensor(-6.2497, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6985, dtype=torch.float64) delta_t tensor(0.4275, dtype=torch.float64)
17 gae_duplicate tensor(0.1946, dtype=torch.float64) tensor(-5.0881, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5965, dtype=torch.float64) delta_t tensor(0.3208, dtype=torch.float64)
16 gae_duplicate tensor(-0.1847, dtype=torch.float64) tensor(-5.5399, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3783, dtype=torch.float64) delta_t tensor(0.2309, dtype=torch.float64)
15 gae_duplicate tensor(-0.7270, dtype=torch.float64) tensor(-2.9757, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8285, dtype=torch.float64) delta_t tensor(0.6664, dtype=torch.float64)
14 gae_duplicate tensor(0.3457, dtype=torch.float64) tensor(-8.2042, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8184, dtype=torch.float64) delta_t tensor(0.6605, dtype=torch.float64)
13 gae_duplicate tensor(0.2903, dtype=torch.float64) tensor(-8.9161, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8057, dtype=torch.float64) delta_t tensor(0.6463, dtype=torch.float64)
12 gae_duplicate tensor(0.5035, dtype=torch.float64) tensor(-7.5820, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7164, dtype=torch.float64) delta_t tensor(0.5439, dtype=torch.float64)
11 gae_duplicate tensor(0.0845, dtype=torch.float64) tensor(-7.9185, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5945, dtype=torch.float64) delta_t tensor(0.3864, dtype=torch.float64)
10 gae_duplicate tensor(-0.0236, dtype=torch.float64) tensor(-4.6957, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0284, dtype=torch.float64) delta_t tensor(-0.1763, dtype=torch.float64)
9 gae_duplicate tensor(-1.5136, dtype=torch.float64) tensor(1.6376, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1545, dtype=torch.float64) delta_t tensor(-0.3834, dtype=torch.float64)
8 gae_duplicate tensor(-1.7419, dtype=torch.float64) tensor(4.3859, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3052, dtype=torch.float64) delta_t tensor(-0.5570, dtype=torch.float64)
7 gae_duplicate tensor(-1.0717, dtype=torch.float64) tensor(6.3188, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2241, dtype=torch.float64) delta_t tensor(-1.5027, dtype=torch.float64)
6 gae_duplicate tensor(-2.1066, dtype=torch.float64) tensor(20.5723, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7451, dtype=torch.float64) delta_t tensor(-1.9568, dtype=torch.float64)
5 gae_duplicate tensor(-3.3538, dtype=torch.float64) tensor(27.2117, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2424, dtype=torch.float64) delta_t tensor(-2.4318, dtype=torch.float64)
4 gae_duplicate tensor(-4.0004, dtype=torch.float64) tensor(30.7113, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2035, dtype=torch.float64) delta_t tensor(-1.4458, dtype=torch.float64)
3 gae_duplicate tensor(-1.9851, dtype=torch.float64) tensor(21.0583, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4034, dtype=torch.float64) delta_t tensor(-1.6625, dtype=torch.float64)
2 gae_duplicate tensor(-2.9700, dtype=torch.float64) tensor(19.2612, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2465.626220703125
value loss:249.43017578125
entropies:216.3044891357422
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1880598068237305 seconds
19 rew tensor(0.8140, dtype=torch.float64) delta_t tensor(0.5457, dtype=torch.float64)
19 gae_duplicate tensor(0.3295, dtype=torch.float64) tensor(-6.7454, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7879, dtype=torch.float64) delta_t tensor(0.4970, dtype=torch.float64)
18 gae_duplicate tensor(0.3967, dtype=torch.float64) tensor(-7.0717, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7201, dtype=torch.float64) delta_t tensor(0.4125, dtype=torch.float64)
17 gae_duplicate tensor(0.1942, dtype=torch.float64) tensor(-6.1607, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6223, dtype=torch.float64) delta_t tensor(0.3275, dtype=torch.float64)
16 gae_duplicate tensor(-0.1382, dtype=torch.float64) tensor(-5.4468, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4025, dtype=torch.float64) delta_t tensor(0.2681, dtype=torch.float64)
15 gae_duplicate tensor(-0.6620, dtype=torch.float64) tensor(-3.1696, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8586, dtype=torch.float64) delta_t tensor(0.6875, dtype=torch.float64)
14 gae_duplicate tensor(0.5982, dtype=torch.float64) tensor(-8.6621, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8419, dtype=torch.float64) delta_t tensor(0.6803, dtype=torch.float64)
13 gae_duplicate tensor(0.6015, dtype=torch.float64) tensor(-10.3801, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7937, dtype=torch.float64) delta_t tensor(0.6356, dtype=torch.float64)
12 gae_duplicate tensor(0.3681, dtype=torch.float64) tensor(-9.5502, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6719, dtype=torch.float64) delta_t tensor(0.5242, dtype=torch.float64)
11 gae_duplicate tensor(-0.3863, dtype=torch.float64) tensor(-7.4333, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6166, dtype=torch.float64) delta_t tensor(0.3823, dtype=torch.float64)
10 gae_duplicate tensor(-0.5558, dtype=torch.float64) tensor(-5.1816, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1029, dtype=torch.float64) delta_t tensor(-0.1237, dtype=torch.float64)
9 gae_duplicate tensor(-2.0025, dtype=torch.float64) tensor(0.4827, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0641, dtype=torch.float64) delta_t tensor(-0.1742, dtype=torch.float64)
8 gae_duplicate tensor(-1.1614, dtype=torch.float64) tensor(1.9474, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1384, dtype=torch.float64) delta_t tensor(-0.3687, dtype=torch.float64)
7 gae_duplicate tensor(-0.5773, dtype=torch.float64) tensor(4.9944, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7168, dtype=torch.float64) delta_t tensor(-0.9926, dtype=torch.float64)
6 gae_duplicate tensor(-1.6593, dtype=torch.float64) tensor(12.2497, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2204, dtype=torch.float64) delta_t tensor(-1.3612, dtype=torch.float64)
5 gae_duplicate tensor(-2.2263, dtype=torch.float64) tensor(17.6035, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7898, dtype=torch.float64) delta_t tensor(-1.9539, dtype=torch.float64)
4 gae_duplicate tensor(-2.5598, dtype=torch.float64) tensor(25.7648, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4254, dtype=torch.float64) delta_t tensor(-1.6481, dtype=torch.float64)
3 gae_duplicate tensor(-2.5724, dtype=torch.float64) tensor(22.0764, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2932, dtype=torch.float64) delta_t tensor(-1.5633, dtype=torch.float64)
2 gae_duplicate tensor(-2.5058, dtype=torch.float64) tensor(21.6392, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1369.315185546875
value loss:184.65655517578125
entropies:216.02040100097656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.860375165939331 seconds
19 rew tensor(0.8316, dtype=torch.float64) delta_t tensor(0.5507, dtype=torch.float64)
19 gae_duplicate tensor(0.4308, dtype=torch.float64) tensor(-6.6576, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7923, dtype=torch.float64) delta_t tensor(0.5075, dtype=torch.float64)
18 gae_duplicate tensor(0.4595, dtype=torch.float64) tensor(-6.4337, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7205, dtype=torch.float64) delta_t tensor(0.4366, dtype=torch.float64)
17 gae_duplicate tensor(0.2694, dtype=torch.float64) tensor(-6.6205, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6378, dtype=torch.float64) delta_t tensor(0.3372, dtype=torch.float64)
16 gae_duplicate tensor(-0.0731, dtype=torch.float64) tensor(-5.6014, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4057, dtype=torch.float64) delta_t tensor(0.2252, dtype=torch.float64)
15 gae_duplicate tensor(-0.7857, dtype=torch.float64) tensor(-2.4931, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8549, dtype=torch.float64) delta_t tensor(0.6570, dtype=torch.float64)
14 gae_duplicate tensor(0.5403, dtype=torch.float64) tensor(-8.5445, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8588, dtype=torch.float64) delta_t tensor(0.6818, dtype=torch.float64)
13 gae_duplicate tensor(0.5763, dtype=torch.float64) tensor(-9.3338, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7499, dtype=torch.float64) delta_t tensor(0.5870, dtype=torch.float64)
12 gae_duplicate tensor(0.3881, dtype=torch.float64) tensor(-7.5145, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6533, dtype=torch.float64) delta_t tensor(0.4824, dtype=torch.float64)
11 gae_duplicate tensor(0.0029, dtype=torch.float64) tensor(-6.4772, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6351, dtype=torch.float64) delta_t tensor(0.3405, dtype=torch.float64)
10 gae_duplicate tensor(-0.1465, dtype=torch.float64) tensor(-4.5963, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3787, dtype=torch.float64) delta_t tensor(0.1654, dtype=torch.float64)
9 gae_duplicate tensor(-0.2660, dtype=torch.float64) tensor(-1.8404, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2029, dtype=torch.float64) delta_t tensor(-0.0487, dtype=torch.float64)
8 gae_duplicate tensor(-0.5090, dtype=torch.float64) tensor(0.0829, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5219, dtype=torch.float64) delta_t tensor(-0.7687, dtype=torch.float64)
7 gae_duplicate tensor(-2.6918, dtype=torch.float64) tensor(10.3414, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6655, dtype=torch.float64) delta_t tensor(-0.9674, dtype=torch.float64)
6 gae_duplicate tensor(-2.3606, dtype=torch.float64) tensor(13.2355, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9325, dtype=torch.float64) delta_t tensor(-1.1147, dtype=torch.float64)
5 gae_duplicate tensor(-2.1054, dtype=torch.float64) tensor(12.7648, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4196, dtype=torch.float64) delta_t tensor(-1.6293, dtype=torch.float64)
4 gae_duplicate tensor(-2.3743, dtype=torch.float64) tensor(18.2812, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4024, dtype=torch.float64) delta_t tensor(-1.6502, dtype=torch.float64)
3 gae_duplicate tensor(-2.1840, dtype=torch.float64) tensor(19.0757, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0531, dtype=torch.float64) delta_t tensor(-1.3383, dtype=torch.float64)
2 gae_duplicate tensor(-2.2811, dtype=torch.float64) tensor(18.5045, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-981.1532592773438
value loss:162.29579162597656
entropies:216.1840362548828
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2490.0381)
ToM Target loss= tensor(1801.5220)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.193993806838989 seconds
19 rew tensor(0.8504, dtype=torch.float64) delta_t tensor(0.5691, dtype=torch.float64)
19 gae_duplicate tensor(0.3633, dtype=torch.float64) tensor(-5.9632, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8538, dtype=torch.float64) delta_t tensor(0.5670, dtype=torch.float64)
18 gae_duplicate tensor(0.4435, dtype=torch.float64) tensor(-7.9755, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8573, dtype=torch.float64) delta_t tensor(0.5769, dtype=torch.float64)
17 gae_duplicate tensor(0.3943, dtype=torch.float64) tensor(-7.3110, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8607, dtype=torch.float64) delta_t tensor(0.5930, dtype=torch.float64)
16 gae_duplicate tensor(0.4669, dtype=torch.float64) tensor(-8.5949, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8642, dtype=torch.float64) delta_t tensor(0.6907, dtype=torch.float64)
15 gae_duplicate tensor(0.5993, dtype=torch.float64) tensor(-9.1076, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8678, dtype=torch.float64) delta_t tensor(0.6890, dtype=torch.float64)
14 gae_duplicate tensor(0.6020, dtype=torch.float64) tensor(-9.2548, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8714, dtype=torch.float64) delta_t tensor(0.6995, dtype=torch.float64)
13 gae_duplicate tensor(0.6047, dtype=torch.float64) tensor(-8.7058, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8750, dtype=torch.float64) delta_t tensor(0.7221, dtype=torch.float64)
12 gae_duplicate tensor(0.6107, dtype=torch.float64) tensor(-9.0823, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8787, dtype=torch.float64) delta_t tensor(0.7228, dtype=torch.float64)
11 gae_duplicate tensor(0.6134, dtype=torch.float64) tensor(-10.4640, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8273, dtype=torch.float64) delta_t tensor(0.5647, dtype=torch.float64)
10 gae_duplicate tensor(0.3905, dtype=torch.float64) tensor(-7.3071, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4540, dtype=torch.float64) delta_t tensor(0.2012, dtype=torch.float64)
9 gae_duplicate tensor(-0.0117, dtype=torch.float64) tensor(-2.9310, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2650, dtype=torch.float64) delta_t tensor(0.0072, dtype=torch.float64)
8 gae_duplicate tensor(-0.2472, dtype=torch.float64) tensor(-0.3600, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2227, dtype=torch.float64) delta_t tensor(-0.4538, dtype=torch.float64)
7 gae_duplicate tensor(-1.1997, dtype=torch.float64) tensor(4.7039, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6672, dtype=torch.float64) delta_t tensor(-0.9633, dtype=torch.float64)
6 gae_duplicate tensor(-1.4573, dtype=torch.float64) tensor(12.6359, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9963, dtype=torch.float64) delta_t tensor(-1.1255, dtype=torch.float64)
5 gae_duplicate tensor(-1.6985, dtype=torch.float64) tensor(13.5876, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5225, dtype=torch.float64) delta_t tensor(-1.6854, dtype=torch.float64)
4 gae_duplicate tensor(-2.1207, dtype=torch.float64) tensor(23.5873, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4011, dtype=torch.float64) delta_t tensor(-1.6201, dtype=torch.float64)
3 gae_duplicate tensor(-2.3857, dtype=torch.float64) tensor(20.3908, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8899, dtype=torch.float64) delta_t tensor(-1.1434, dtype=torch.float64)
2 gae_duplicate tensor(-1.8603, dtype=torch.float64) tensor(17.2502, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-222.42108154296875
value loss:153.03790283203125
entropies:215.97373962402344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.717706918716431 seconds
19 rew tensor(0.8500, dtype=torch.float64) delta_t tensor(0.5200, dtype=torch.float64)
19 gae_duplicate tensor(0.4451, dtype=torch.float64) tensor(-7.1339, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8531, dtype=torch.float64) delta_t tensor(0.5109, dtype=torch.float64)
18 gae_duplicate tensor(0.3896, dtype=torch.float64) tensor(-6.3265, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8562, dtype=torch.float64) delta_t tensor(0.5170, dtype=torch.float64)
17 gae_duplicate tensor(0.4086, dtype=torch.float64) tensor(-6.9798, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8594, dtype=torch.float64) delta_t tensor(0.5399, dtype=torch.float64)
16 gae_duplicate tensor(0.4710, dtype=torch.float64) tensor(-6.8836, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8626, dtype=torch.float64) delta_t tensor(0.7027, dtype=torch.float64)
15 gae_duplicate tensor(0.5620, dtype=torch.float64) tensor(-8.8609, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8658, dtype=torch.float64) delta_t tensor(0.6968, dtype=torch.float64)
14 gae_duplicate tensor(0.5645, dtype=torch.float64) tensor(-8.3807, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8691, dtype=torch.float64) delta_t tensor(0.7086, dtype=torch.float64)
13 gae_duplicate tensor(0.5771, dtype=torch.float64) tensor(-10.0387, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8724, dtype=torch.float64) delta_t tensor(0.7189, dtype=torch.float64)
12 gae_duplicate tensor(0.5797, dtype=torch.float64) tensor(-9.0139, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8758, dtype=torch.float64) delta_t tensor(0.7118, dtype=torch.float64)
11 gae_duplicate tensor(0.6123, dtype=torch.float64) tensor(-10.1770, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7815, dtype=torch.float64) delta_t tensor(0.4537, dtype=torch.float64)
10 gae_duplicate tensor(0.1850, dtype=torch.float64) tensor(-5.7986, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4876, dtype=torch.float64) delta_t tensor(0.2153, dtype=torch.float64)
9 gae_duplicate tensor(0.0846, dtype=torch.float64) tensor(-3.2240, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1794, dtype=torch.float64) delta_t tensor(-0.0719, dtype=torch.float64)
8 gae_duplicate tensor(-0.2037, dtype=torch.float64) tensor(0.4098, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2330, dtype=torch.float64) delta_t tensor(-0.4795, dtype=torch.float64)
7 gae_duplicate tensor(-0.8734, dtype=torch.float64) tensor(5.4621, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7463, dtype=torch.float64) delta_t tensor(-1.0268, dtype=torch.float64)
6 gae_duplicate tensor(-1.1851, dtype=torch.float64) tensor(13.9875, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0789, dtype=torch.float64) delta_t tensor(-1.1673, dtype=torch.float64)
5 gae_duplicate tensor(-1.5945, dtype=torch.float64) tensor(14.3650, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7643, dtype=torch.float64) delta_t tensor(-1.9005, dtype=torch.float64)
4 gae_duplicate tensor(-2.3161, dtype=torch.float64) tensor(28.0719, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5146, dtype=torch.float64) delta_t tensor(-1.6921, dtype=torch.float64)
3 gae_duplicate tensor(-2.1586, dtype=torch.float64) tensor(21.2855, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0860, dtype=torch.float64) delta_t tensor(-1.3084, dtype=torch.float64)
2 gae_duplicate tensor(-1.9381, dtype=torch.float64) tensor(17.9274, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-711.907958984375
value loss:162.161865234375
entropies:216.74545288085938
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.983327388763428 seconds
19 rew tensor(0.8472, dtype=torch.float64) delta_t tensor(0.5271, dtype=torch.float64)
19 gae_duplicate tensor(0.3812, dtype=torch.float64) tensor(-6.5525, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8501, dtype=torch.float64) delta_t tensor(0.4996, dtype=torch.float64)
18 gae_duplicate tensor(0.4082, dtype=torch.float64) tensor(-5.8151, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8529, dtype=torch.float64) delta_t tensor(0.5135, dtype=torch.float64)
17 gae_duplicate tensor(0.4350, dtype=torch.float64) tensor(-6.8740, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8558, dtype=torch.float64) delta_t tensor(0.5490, dtype=torch.float64)
16 gae_duplicate tensor(0.4336, dtype=torch.float64) tensor(-7.2383, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8588, dtype=torch.float64) delta_t tensor(0.6926, dtype=torch.float64)
15 gae_duplicate tensor(0.6074, dtype=torch.float64) tensor(-8.5851, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8617, dtype=torch.float64) delta_t tensor(0.6742, dtype=torch.float64)
14 gae_duplicate tensor(0.5719, dtype=torch.float64) tensor(-8.5134, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8647, dtype=torch.float64) delta_t tensor(0.6907, dtype=torch.float64)
13 gae_duplicate tensor(0.6537, dtype=torch.float64) tensor(-8.7150, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8677, dtype=torch.float64) delta_t tensor(0.6863, dtype=torch.float64)
12 gae_duplicate tensor(0.6209, dtype=torch.float64) tensor(-9.2648, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8708, dtype=torch.float64) delta_t tensor(0.7002, dtype=torch.float64)
11 gae_duplicate tensor(0.6232, dtype=torch.float64) tensor(-8.8871, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8738, dtype=torch.float64) delta_t tensor(0.5458, dtype=torch.float64)
10 gae_duplicate tensor(0.3898, dtype=torch.float64) tensor(-7.9161, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5148, dtype=torch.float64) delta_t tensor(0.2223, dtype=torch.float64)
9 gae_duplicate tensor(0.1939, dtype=torch.float64) tensor(-3.2579, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2361, dtype=torch.float64) delta_t tensor(-0.0203, dtype=torch.float64)
8 gae_duplicate tensor(-0.1064, dtype=torch.float64) tensor(-0.1916, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1189, dtype=torch.float64) delta_t tensor(-0.4017, dtype=torch.float64)
7 gae_duplicate tensor(-0.4540, dtype=torch.float64) tensor(4.8578, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8359, dtype=torch.float64) delta_t tensor(-1.0976, dtype=torch.float64)
6 gae_duplicate tensor(-1.6532, dtype=torch.float64) tensor(12.1891, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1163, dtype=torch.float64) delta_t tensor(-1.1982, dtype=torch.float64)
5 gae_duplicate tensor(-1.7960, dtype=torch.float64) tensor(16.3964, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7702, dtype=torch.float64) delta_t tensor(-1.8754, dtype=torch.float64)
4 gae_duplicate tensor(-2.2938, dtype=torch.float64) tensor(22.1884, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4958, dtype=torch.float64) delta_t tensor(-1.6516, dtype=torch.float64)
3 gae_duplicate tensor(-2.2312, dtype=torch.float64) tensor(20.5581, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1685, dtype=torch.float64) delta_t tensor(-1.3543, dtype=torch.float64)
2 gae_duplicate tensor(-1.9231, dtype=torch.float64) tensor(17.5830, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-469.5415954589844
value loss:165.7260284423828
entropies:216.19900512695312
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6996400356292725 seconds
19 rew tensor(0.8449, dtype=torch.float64) delta_t tensor(0.5324, dtype=torch.float64)
19 gae_duplicate tensor(0.3376, dtype=torch.float64) tensor(-6.8851, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8476, dtype=torch.float64) delta_t tensor(0.4986, dtype=torch.float64)
18 gae_duplicate tensor(0.3868, dtype=torch.float64) tensor(-5.7611, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8502, dtype=torch.float64) delta_t tensor(0.5163, dtype=torch.float64)
17 gae_duplicate tensor(0.3311, dtype=torch.float64) tensor(-7.4808, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8529, dtype=torch.float64) delta_t tensor(0.5587, dtype=torch.float64)
16 gae_duplicate tensor(0.4119, dtype=torch.float64) tensor(-8.3441, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8556, dtype=torch.float64) delta_t tensor(0.6771, dtype=torch.float64)
15 gae_duplicate tensor(0.6199, dtype=torch.float64) tensor(-9.4366, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8583, dtype=torch.float64) delta_t tensor(0.6689, dtype=torch.float64)
14 gae_duplicate tensor(0.6220, dtype=torch.float64) tensor(-8.4136, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8610, dtype=torch.float64) delta_t tensor(0.6718, dtype=torch.float64)
13 gae_duplicate tensor(0.6176, dtype=torch.float64) tensor(-9.5229, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8638, dtype=torch.float64) delta_t tensor(0.6754, dtype=torch.float64)
12 gae_duplicate tensor(0.6198, dtype=torch.float64) tensor(-8.4807, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8666, dtype=torch.float64) delta_t tensor(0.6884, dtype=torch.float64)
11 gae_duplicate tensor(0.6140, dtype=torch.float64) tensor(-9.4113, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7625, dtype=torch.float64) delta_t tensor(0.4482, dtype=torch.float64)
10 gae_duplicate tensor(0.3184, dtype=torch.float64) tensor(-5.8250, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4231, dtype=torch.float64) delta_t tensor(0.0820, dtype=torch.float64)
9 gae_duplicate tensor(-0.0831, dtype=torch.float64) tensor(-1.6645, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2677, dtype=torch.float64) delta_t tensor(0.0242, dtype=torch.float64)
8 gae_duplicate tensor(-0.2180, dtype=torch.float64) tensor(-0.4995, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0946, dtype=torch.float64) delta_t tensor(-0.3911, dtype=torch.float64)
7 gae_duplicate tensor(-1.1524, dtype=torch.float64) tensor(4.3450, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9876, dtype=torch.float64) delta_t tensor(-1.2304, dtype=torch.float64)
6 gae_duplicate tensor(-1.6445, dtype=torch.float64) tensor(14.5499, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3210, dtype=torch.float64) delta_t tensor(-1.3960, dtype=torch.float64)
5 gae_duplicate tensor(-1.8047, dtype=torch.float64) tensor(18.9788, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7293, dtype=torch.float64) delta_t tensor(-1.7911, dtype=torch.float64)
4 gae_duplicate tensor(-2.2629, dtype=torch.float64) tensor(23.4655, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6278, dtype=torch.float64) delta_t tensor(-1.7766, dtype=torch.float64)
3 gae_duplicate tensor(-2.2864, dtype=torch.float64) tensor(25.7098, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2750, dtype=torch.float64) delta_t tensor(-1.4511, dtype=torch.float64)
2 gae_duplicate tensor(-2.1779, dtype=torch.float64) tensor(21.3186, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-997.9442749023438
value loss:176.11550903320312
entropies:215.65740966796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.772248983383179 seconds
19 rew tensor(0.8428, dtype=torch.float64) delta_t tensor(0.5102, dtype=torch.float64)
19 gae_duplicate tensor(0.4502, dtype=torch.float64) tensor(-5.7826, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8452, dtype=torch.float64) delta_t tensor(0.4652, dtype=torch.float64)
18 gae_duplicate tensor(0.3111, dtype=torch.float64) tensor(-6.1698, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8477, dtype=torch.float64) delta_t tensor(0.4802, dtype=torch.float64)
17 gae_duplicate tensor(0.3670, dtype=torch.float64) tensor(-6.4469, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8501, dtype=torch.float64) delta_t tensor(0.5020, dtype=torch.float64)
16 gae_duplicate tensor(0.4223, dtype=torch.float64) tensor(-6.7141, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8526, dtype=torch.float64) delta_t tensor(0.6581, dtype=torch.float64)
15 gae_duplicate tensor(0.5295, dtype=torch.float64) tensor(-8.1376, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8552, dtype=torch.float64) delta_t tensor(0.6477, dtype=torch.float64)
14 gae_duplicate tensor(0.5315, dtype=torch.float64) tensor(-8.8791, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8577, dtype=torch.float64) delta_t tensor(0.6598, dtype=torch.float64)
13 gae_duplicate tensor(0.5381, dtype=torch.float64) tensor(-10.1419, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8603, dtype=torch.float64) delta_t tensor(0.6673, dtype=torch.float64)
12 gae_duplicate tensor(0.5468, dtype=torch.float64) tensor(-10.2160, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8628, dtype=torch.float64) delta_t tensor(0.6764, dtype=torch.float64)
11 gae_duplicate tensor(0.5836, dtype=torch.float64) tensor(-9.0179, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8215, dtype=torch.float64) delta_t tensor(0.4647, dtype=torch.float64)
10 gae_duplicate tensor(0.3131, dtype=torch.float64) tensor(-6.2587, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4926, dtype=torch.float64) delta_t tensor(0.1468, dtype=torch.float64)
9 gae_duplicate tensor(-0.0191, dtype=torch.float64) tensor(-2.5330, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2671, dtype=torch.float64) delta_t tensor(0.0104, dtype=torch.float64)
8 gae_duplicate tensor(-0.2533, dtype=torch.float64) tensor(-0.1730, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0172, dtype=torch.float64) delta_t tensor(-0.3375, dtype=torch.float64)
7 gae_duplicate tensor(-0.5180, dtype=torch.float64) tensor(4.4791, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9689, dtype=torch.float64) delta_t tensor(-1.1766, dtype=torch.float64)
6 gae_duplicate tensor(-1.4799, dtype=torch.float64) tensor(14.5115, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2739, dtype=torch.float64) delta_t tensor(-1.3213, dtype=torch.float64)
5 gae_duplicate tensor(-2.0479, dtype=torch.float64) tensor(16.1640, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8994, dtype=torch.float64) delta_t tensor(-1.9409, dtype=torch.float64)
4 gae_duplicate tensor(-2.5690, dtype=torch.float64) tensor(21.6672, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6122, dtype=torch.float64) delta_t tensor(-1.7206, dtype=torch.float64)
3 gae_duplicate tensor(-2.1684, dtype=torch.float64) tensor(23.3304, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3875, dtype=torch.float64) delta_t tensor(-1.5253, dtype=torch.float64)
2 gae_duplicate tensor(-2.1701, dtype=torch.float64) tensor(21.1081, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-787.17138671875
value loss:172.8325653076172
entropies:215.23471069335938
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2472.2041)
ToM Target loss= tensor(1802.4509)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.005082130432129 seconds
19 rew tensor(0.8405, dtype=torch.float64) delta_t tensor(0.5189, dtype=torch.float64)
19 gae_duplicate tensor(0.3780, dtype=torch.float64) tensor(-5.8326, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8427, dtype=torch.float64) delta_t tensor(0.3893, dtype=torch.float64)
18 gae_duplicate tensor(0.2895, dtype=torch.float64) tensor(-4.9800, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8450, dtype=torch.float64) delta_t tensor(0.4481, dtype=torch.float64)
17 gae_duplicate tensor(0.3022, dtype=torch.float64) tensor(-5.5741, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8473, dtype=torch.float64) delta_t tensor(0.4776, dtype=torch.float64)
16 gae_duplicate tensor(0.3687, dtype=torch.float64) tensor(-6.4533, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8496, dtype=torch.float64) delta_t tensor(0.6298, dtype=torch.float64)
15 gae_duplicate tensor(0.5391, dtype=torch.float64) tensor(-7.6820, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8520, dtype=torch.float64) delta_t tensor(0.6177, dtype=torch.float64)
14 gae_duplicate tensor(0.5411, dtype=torch.float64) tensor(-8.3851, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8543, dtype=torch.float64) delta_t tensor(0.6342, dtype=torch.float64)
13 gae_duplicate tensor(0.5618, dtype=torch.float64) tensor(-9.1211, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8567, dtype=torch.float64) delta_t tensor(0.6350, dtype=torch.float64)
12 gae_duplicate tensor(0.5638, dtype=torch.float64) tensor(-7.3524, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8591, dtype=torch.float64) delta_t tensor(0.6411, dtype=torch.float64)
11 gae_duplicate tensor(0.5865, dtype=torch.float64) tensor(-8.0385, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8070, dtype=torch.float64) delta_t tensor(0.3830, dtype=torch.float64)
10 gae_duplicate tensor(0.2159, dtype=torch.float64) tensor(-5.5990, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4679, dtype=torch.float64) delta_t tensor(0.0731, dtype=torch.float64)
9 gae_duplicate tensor(-0.1460, dtype=torch.float64) tensor(-1.3345, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2094, dtype=torch.float64) delta_t tensor(-0.0152, dtype=torch.float64)
8 gae_duplicate tensor(-0.4273, dtype=torch.float64) tensor(-0.0596, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0880, dtype=torch.float64) delta_t tensor(-0.3773, dtype=torch.float64)
7 gae_duplicate tensor(-0.5889, dtype=torch.float64) tensor(4.4458, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1874, dtype=torch.float64) delta_t tensor(-1.3633, dtype=torch.float64)
6 gae_duplicate tensor(-1.7248, dtype=torch.float64) tensor(19.3534, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4855, dtype=torch.float64) delta_t tensor(-1.5340, dtype=torch.float64)
5 gae_duplicate tensor(-2.1401, dtype=torch.float64) tensor(18.7574, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9263, dtype=torch.float64) delta_t tensor(-1.9643, dtype=torch.float64)
4 gae_duplicate tensor(-2.6716, dtype=torch.float64) tensor(23.8496, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5726, dtype=torch.float64) delta_t tensor(-1.6608, dtype=torch.float64)
3 gae_duplicate tensor(-2.1350, dtype=torch.float64) tensor(22.4562, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4200, dtype=torch.float64) delta_t tensor(-1.5636, dtype=torch.float64)
2 gae_duplicate tensor(-2.1357, dtype=torch.float64) tensor(24.9003, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1599.288330078125
value loss:181.86074829101562
entropies:214.8826141357422
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.814330101013184 seconds
19 rew tensor(0.8385, dtype=torch.float64) delta_t tensor(0.4718, dtype=torch.float64)
19 gae_duplicate tensor(0.2969, dtype=torch.float64) tensor(-4.8933, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8406, dtype=torch.float64) delta_t tensor(0.4394, dtype=torch.float64)
18 gae_duplicate tensor(0.3363, dtype=torch.float64) tensor(-5.5482, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8427, dtype=torch.float64) delta_t tensor(0.4703, dtype=torch.float64)
17 gae_duplicate tensor(0.3644, dtype=torch.float64) tensor(-7.3449, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8449, dtype=torch.float64) delta_t tensor(0.5206, dtype=torch.float64)
16 gae_duplicate tensor(0.3779, dtype=torch.float64) tensor(-7.0141, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8470, dtype=torch.float64) delta_t tensor(0.6245, dtype=torch.float64)
15 gae_duplicate tensor(0.5187, dtype=torch.float64) tensor(-8.8402, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8492, dtype=torch.float64) delta_t tensor(0.6236, dtype=torch.float64)
14 gae_duplicate tensor(0.5627, dtype=torch.float64) tensor(-9.1914, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8514, dtype=torch.float64) delta_t tensor(0.6252, dtype=torch.float64)
13 gae_duplicate tensor(0.5911, dtype=torch.float64) tensor(-7.8885, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8536, dtype=torch.float64) delta_t tensor(0.6302, dtype=torch.float64)
12 gae_duplicate tensor(0.5904, dtype=torch.float64) tensor(-7.2484, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8559, dtype=torch.float64) delta_t tensor(0.6496, dtype=torch.float64)
11 gae_duplicate tensor(0.5922, dtype=torch.float64) tensor(-8.6033, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8581, dtype=torch.float64) delta_t tensor(0.4763, dtype=torch.float64)
10 gae_duplicate tensor(0.2796, dtype=torch.float64) tensor(-5.6665, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5455, dtype=torch.float64) delta_t tensor(0.1963, dtype=torch.float64)
9 gae_duplicate tensor(0.1227, dtype=torch.float64) tensor(-2.8272, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3317, dtype=torch.float64) delta_t tensor(0.0537, dtype=torch.float64)
8 gae_duplicate tensor(-0.0610, dtype=torch.float64) tensor(-0.8168, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0604, dtype=torch.float64) delta_t tensor(-0.4285, dtype=torch.float64)
7 gae_duplicate tensor(-0.7200, dtype=torch.float64) tensor(4.5939, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8377, dtype=torch.float64) delta_t tensor(-0.9885, dtype=torch.float64)
6 gae_duplicate tensor(-1.3770, dtype=torch.float64) tensor(11.4913, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1141, dtype=torch.float64) delta_t tensor(-1.1351, dtype=torch.float64)
5 gae_duplicate tensor(-1.6152, dtype=torch.float64) tensor(13.8220, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8102, dtype=torch.float64) delta_t tensor(-1.8366, dtype=torch.float64)
4 gae_duplicate tensor(-2.4651, dtype=torch.float64) tensor(20.3186, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5651, dtype=torch.float64) delta_t tensor(-1.6159, dtype=torch.float64)
3 gae_duplicate tensor(-2.2100, dtype=torch.float64) tensor(25.6315, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2525, dtype=torch.float64) delta_t tensor(-1.3655, dtype=torch.float64)
2 gae_duplicate tensor(-2.0188, dtype=torch.float64) tensor(18.2355, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-694.1918334960938
value loss:150.0111083984375
entropies:214.63327026367188
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.991446018218994 seconds
19 rew tensor(0.8374, dtype=torch.float64) delta_t tensor(0.4914, dtype=torch.float64)
19 gae_duplicate tensor(0.3830, dtype=torch.float64) tensor(-6.2443, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8394, dtype=torch.float64) delta_t tensor(0.4233, dtype=torch.float64)
18 gae_duplicate tensor(0.3145, dtype=torch.float64) tensor(-5.9078, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8414, dtype=torch.float64) delta_t tensor(0.4487, dtype=torch.float64)
17 gae_duplicate tensor(0.3217, dtype=torch.float64) tensor(-6.5178, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8434, dtype=torch.float64) delta_t tensor(0.5032, dtype=torch.float64)
16 gae_duplicate tensor(0.3977, dtype=torch.float64) tensor(-7.4875, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8454, dtype=torch.float64) delta_t tensor(0.6205, dtype=torch.float64)
15 gae_duplicate tensor(0.5390, dtype=torch.float64) tensor(-8.3321, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8475, dtype=torch.float64) delta_t tensor(0.6200, dtype=torch.float64)
14 gae_duplicate tensor(0.5408, dtype=torch.float64) tensor(-7.6493, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8496, dtype=torch.float64) delta_t tensor(0.6210, dtype=torch.float64)
13 gae_duplicate tensor(0.5426, dtype=torch.float64) tensor(-7.8184, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8516, dtype=torch.float64) delta_t tensor(0.6103, dtype=torch.float64)
12 gae_duplicate tensor(0.5443, dtype=torch.float64) tensor(-8.8096, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8537, dtype=torch.float64) delta_t tensor(0.6279, dtype=torch.float64)
11 gae_duplicate tensor(0.5637, dtype=torch.float64) tensor(-9.6556, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8015, dtype=torch.float64) delta_t tensor(0.3678, dtype=torch.float64)
10 gae_duplicate tensor(0.2064, dtype=torch.float64) tensor(-5.2428, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5140, dtype=torch.float64) delta_t tensor(0.1450, dtype=torch.float64)
9 gae_duplicate tensor(-0.0457, dtype=torch.float64) tensor(-1.9089, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2774, dtype=torch.float64) delta_t tensor(0.0180, dtype=torch.float64)
8 gae_duplicate tensor(-0.0666, dtype=torch.float64) tensor(-0.3389, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2017, dtype=torch.float64) delta_t tensor(-0.5659, dtype=torch.float64)
7 gae_duplicate tensor(-1.0697, dtype=torch.float64) tensor(5.8034, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9052, dtype=torch.float64) delta_t tensor(-1.0284, dtype=torch.float64)
6 gae_duplicate tensor(-1.5606, dtype=torch.float64) tensor(15.1315, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2101, dtype=torch.float64) delta_t tensor(-1.2099, dtype=torch.float64)
5 gae_duplicate tensor(-1.8483, dtype=torch.float64) tensor(15.9142, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8972, dtype=torch.float64) delta_t tensor(-1.8965, dtype=torch.float64)
4 gae_duplicate tensor(-2.3335, dtype=torch.float64) tensor(24.6577, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5960, dtype=torch.float64) delta_t tensor(-1.6170, dtype=torch.float64)
3 gae_duplicate tensor(-2.0381, dtype=torch.float64) tensor(20.4840, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2512, dtype=torch.float64) delta_t tensor(-1.3775, dtype=torch.float64)
2 gae_duplicate tensor(-2.2034, dtype=torch.float64) tensor(16.1057, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-837.2059326171875
value loss:156.3703155517578
entropies:214.47901916503906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.19182014465332 seconds
19 rew tensor(0.8354, dtype=torch.float64) delta_t tensor(0.4862, dtype=torch.float64)
19 gae_duplicate tensor(0.3922, dtype=torch.float64) tensor(-6.3623, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8373, dtype=torch.float64) delta_t tensor(0.3145, dtype=torch.float64)
18 gae_duplicate tensor(0.2198, dtype=torch.float64) tensor(-3.7431, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8392, dtype=torch.float64) delta_t tensor(0.3859, dtype=torch.float64)
17 gae_duplicate tensor(0.3058, dtype=torch.float64) tensor(-5.6035, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8411, dtype=torch.float64) delta_t tensor(0.4475, dtype=torch.float64)
16 gae_duplicate tensor(0.3931, dtype=torch.float64) tensor(-5.5163, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8430, dtype=torch.float64) delta_t tensor(0.6049, dtype=torch.float64)
15 gae_duplicate tensor(0.4700, dtype=torch.float64) tensor(-8.1134, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8449, dtype=torch.float64) delta_t tensor(0.5899, dtype=torch.float64)
14 gae_duplicate tensor(0.4643, dtype=torch.float64) tensor(-7.5155, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8469, dtype=torch.float64) delta_t tensor(0.5842, dtype=torch.float64)
13 gae_duplicate tensor(0.4660, dtype=torch.float64) tensor(-7.9010, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8488, dtype=torch.float64) delta_t tensor(0.5919, dtype=torch.float64)
12 gae_duplicate tensor(0.4634, dtype=torch.float64) tensor(-7.4798, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8508, dtype=torch.float64) delta_t tensor(0.6064, dtype=torch.float64)
11 gae_duplicate tensor(0.4827, dtype=torch.float64) tensor(-8.8672, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8528, dtype=torch.float64) delta_t tensor(0.3506, dtype=torch.float64)
10 gae_duplicate tensor(0.2181, dtype=torch.float64) tensor(-5.1433, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4892, dtype=torch.float64) delta_t tensor(0.0200, dtype=torch.float64)
9 gae_duplicate tensor(-0.0637, dtype=torch.float64) tensor(-0.8216, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2201, dtype=torch.float64) delta_t tensor(-0.0081, dtype=torch.float64)
8 gae_duplicate tensor(-0.2500, dtype=torch.float64) tensor(0.0558, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0574, dtype=torch.float64) delta_t tensor(-0.3885, dtype=torch.float64)
7 gae_duplicate tensor(-0.5946, dtype=torch.float64) tensor(5.2444, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0930, dtype=torch.float64) delta_t tensor(-1.1790, dtype=torch.float64)
6 gae_duplicate tensor(-1.5928, dtype=torch.float64) tensor(13.3682, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3577, dtype=torch.float64) delta_t tensor(-1.3546, dtype=torch.float64)
5 gae_duplicate tensor(-1.7937, dtype=torch.float64) tensor(19.2330, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8146, dtype=torch.float64) delta_t tensor(-1.7928, dtype=torch.float64)
4 gae_duplicate tensor(-2.5212, dtype=torch.float64) tensor(21.7029, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4910, dtype=torch.float64) delta_t tensor(-1.4873, dtype=torch.float64)
3 gae_duplicate tensor(-2.0926, dtype=torch.float64) tensor(17.3765, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3145, dtype=torch.float64) delta_t tensor(-1.3709, dtype=torch.float64)
2 gae_duplicate tensor(-2.1646, dtype=torch.float64) tensor(15.8891, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-967.5115966796875
value loss:150.458984375
entropies:214.46258544921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.350587844848633 seconds
19 rew tensor(0.8360, dtype=torch.float64) delta_t tensor(0.4417, dtype=torch.float64)
19 gae_duplicate tensor(0.2919, dtype=torch.float64) tensor(-5.8898, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8378, dtype=torch.float64) delta_t tensor(0.3812, dtype=torch.float64)
18 gae_duplicate tensor(0.2514, dtype=torch.float64) tensor(-5.2132, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8396, dtype=torch.float64) delta_t tensor(0.4077, dtype=torch.float64)
17 gae_duplicate tensor(0.2887, dtype=torch.float64) tensor(-5.1981, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8414, dtype=torch.float64) delta_t tensor(0.4438, dtype=torch.float64)
16 gae_duplicate tensor(0.3400, dtype=torch.float64) tensor(-5.0939, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8432, dtype=torch.float64) delta_t tensor(0.5840, dtype=torch.float64)
15 gae_duplicate tensor(0.4542, dtype=torch.float64) tensor(-7.4724, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8451, dtype=torch.float64) delta_t tensor(0.5770, dtype=torch.float64)
14 gae_duplicate tensor(0.4558, dtype=torch.float64) tensor(-7.2969, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8469, dtype=torch.float64) delta_t tensor(0.5829, dtype=torch.float64)
13 gae_duplicate tensor(0.4886, dtype=torch.float64) tensor(-7.3610, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8488, dtype=torch.float64) delta_t tensor(0.5833, dtype=torch.float64)
12 gae_duplicate tensor(0.4882, dtype=torch.float64) tensor(-8.9039, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7879, dtype=torch.float64) delta_t tensor(0.5455, dtype=torch.float64)
11 gae_duplicate tensor(0.1480, dtype=torch.float64) tensor(-6.9653, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6577, dtype=torch.float64) delta_t tensor(0.2459, dtype=torch.float64)
10 gae_duplicate tensor(-0.1609, dtype=torch.float64) tensor(-4.2309, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3170, dtype=torch.float64) delta_t tensor(-0.0704, dtype=torch.float64)
9 gae_duplicate tensor(-0.6533, dtype=torch.float64) tensor(0.8056, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1460, dtype=torch.float64) delta_t tensor(-0.1647, dtype=torch.float64)
8 gae_duplicate tensor(-0.7638, dtype=torch.float64) tensor(2.0577, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1930, dtype=torch.float64) delta_t tensor(-0.5359, dtype=torch.float64)
7 gae_duplicate tensor(-1.3073, dtype=torch.float64) tensor(6.1206, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9425, dtype=torch.float64) delta_t tensor(-1.0309, dtype=torch.float64)
6 gae_duplicate tensor(-1.2955, dtype=torch.float64) tensor(12.1938, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3721, dtype=torch.float64) delta_t tensor(-1.4005, dtype=torch.float64)
5 gae_duplicate tensor(-1.7458, dtype=torch.float64) tensor(17.2375, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6954, dtype=torch.float64) delta_t tensor(-1.6481, dtype=torch.float64)
4 gae_duplicate tensor(-2.0921, dtype=torch.float64) tensor(22.1745, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6229, dtype=torch.float64) delta_t tensor(-1.6114, dtype=torch.float64)
3 gae_duplicate tensor(-2.1670, dtype=torch.float64) tensor(21.6478, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2941, dtype=torch.float64) delta_t tensor(-1.4058, dtype=torch.float64)
2 gae_duplicate tensor(-1.8951, dtype=torch.float64) tensor(19.2728, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1402.5518798828125
value loss:147.83470153808594
entropies:214.9713592529297
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2456.9771)
ToM Target loss= tensor(1803.4341)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.715473175048828 seconds
19 rew tensor(0.8353, dtype=torch.float64) delta_t tensor(0.4689, dtype=torch.float64)
19 gae_duplicate tensor(0.3352, dtype=torch.float64) tensor(-4.8799, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8370, dtype=torch.float64) delta_t tensor(0.3105, dtype=torch.float64)
18 gae_duplicate tensor(0.2085, dtype=torch.float64) tensor(-4.2330, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8387, dtype=torch.float64) delta_t tensor(0.3687, dtype=torch.float64)
17 gae_duplicate tensor(0.1858, dtype=torch.float64) tensor(-4.8872, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8404, dtype=torch.float64) delta_t tensor(0.4456, dtype=torch.float64)
16 gae_duplicate tensor(0.3267, dtype=torch.float64) tensor(-5.7599, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8421, dtype=torch.float64) delta_t tensor(0.5884, dtype=torch.float64)
15 gae_duplicate tensor(0.4593, dtype=torch.float64) tensor(-7.6155, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8439, dtype=torch.float64) delta_t tensor(0.5640, dtype=torch.float64)
14 gae_duplicate tensor(0.4609, dtype=torch.float64) tensor(-7.1054, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8456, dtype=torch.float64) delta_t tensor(0.5772, dtype=torch.float64)
13 gae_duplicate tensor(0.4624, dtype=torch.float64) tensor(-7.2349, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8474, dtype=torch.float64) delta_t tensor(0.5833, dtype=torch.float64)
12 gae_duplicate tensor(0.4640, dtype=torch.float64) tensor(-7.7284, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8491, dtype=torch.float64) delta_t tensor(0.5897, dtype=torch.float64)
11 gae_duplicate tensor(0.4835, dtype=torch.float64) tensor(-7.8123, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7377, dtype=torch.float64) delta_t tensor(0.2576, dtype=torch.float64)
10 gae_duplicate tensor(-0.0660, dtype=torch.float64) tensor(-3.3054, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4668, dtype=torch.float64) delta_t tensor(0.0219, dtype=torch.float64)
9 gae_duplicate tensor(-0.1499, dtype=torch.float64) tensor(-0.4349, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1822, dtype=torch.float64) delta_t tensor(-0.1087, dtype=torch.float64)
8 gae_duplicate tensor(-0.4323, dtype=torch.float64) tensor(1.6198, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1016, dtype=torch.float64) delta_t tensor(-0.4472, dtype=torch.float64)
7 gae_duplicate tensor(-0.7051, dtype=torch.float64) tensor(6.6664, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0109, dtype=torch.float64) delta_t tensor(-1.0620, dtype=torch.float64)
6 gae_duplicate tensor(-1.4761, dtype=torch.float64) tensor(13.5210, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3785, dtype=torch.float64) delta_t tensor(-1.3364, dtype=torch.float64)
5 gae_duplicate tensor(-1.7796, dtype=torch.float64) tensor(16.5888, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9291, dtype=torch.float64) delta_t tensor(-1.8518, dtype=torch.float64)
4 gae_duplicate tensor(-2.2791, dtype=torch.float64) tensor(24.7451, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5717, dtype=torch.float64) delta_t tensor(-1.4928, dtype=torch.float64)
3 gae_duplicate tensor(-2.0075, dtype=torch.float64) tensor(20.3493, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4700, dtype=torch.float64) delta_t tensor(-1.4784, dtype=torch.float64)
2 gae_duplicate tensor(-1.8492, dtype=torch.float64) tensor(18.7639, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1523.9949951171875
value loss:151.146484375
entropies:215.12347412109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.658850193023682 seconds
19 rew tensor(0.8335, dtype=torch.float64) delta_t tensor(0.4551, dtype=torch.float64)
19 gae_duplicate tensor(0.1288, dtype=torch.float64) tensor(-5.7190, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8351, dtype=torch.float64) delta_t tensor(0.2756, dtype=torch.float64)
18 gae_duplicate tensor(0.2610, dtype=torch.float64) tensor(-4.1847, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8367, dtype=torch.float64) delta_t tensor(0.3595, dtype=torch.float64)
17 gae_duplicate tensor(0.3082, dtype=torch.float64) tensor(-5.0374, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8384, dtype=torch.float64) delta_t tensor(0.3717, dtype=torch.float64)
16 gae_duplicate tensor(0.2140, dtype=torch.float64) tensor(-4.6815, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8400, dtype=torch.float64) delta_t tensor(0.5813, dtype=torch.float64)
15 gae_duplicate tensor(0.4634, dtype=torch.float64) tensor(-6.9934, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8417, dtype=torch.float64) delta_t tensor(0.5764, dtype=torch.float64)
14 gae_duplicate tensor(0.5580, dtype=torch.float64) tensor(-7.8573, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8433, dtype=torch.float64) delta_t tensor(0.5759, dtype=torch.float64)
13 gae_duplicate tensor(0.5553, dtype=torch.float64) tensor(-6.7239, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8450, dtype=torch.float64) delta_t tensor(0.5903, dtype=torch.float64)
12 gae_duplicate tensor(0.5071, dtype=torch.float64) tensor(-8.0618, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8467, dtype=torch.float64) delta_t tensor(0.5797, dtype=torch.float64)
11 gae_duplicate tensor(0.5029, dtype=torch.float64) tensor(-7.1240, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8268, dtype=torch.float64) delta_t tensor(0.2672, dtype=torch.float64)
10 gae_duplicate tensor(0.1258, dtype=torch.float64) tensor(-4.0859, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5176, dtype=torch.float64) delta_t tensor(0.0113, dtype=torch.float64)
9 gae_duplicate tensor(-0.0635, dtype=torch.float64) tensor(-0.5269, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2873, dtype=torch.float64) delta_t tensor(0.0094, dtype=torch.float64)
8 gae_duplicate tensor(-0.1423, dtype=torch.float64) tensor(-0.2728, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0002, dtype=torch.float64) delta_t tensor(-0.4053, dtype=torch.float64)
7 gae_duplicate tensor(-0.7840, dtype=torch.float64) tensor(5.1375, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9677, dtype=torch.float64) delta_t tensor(-0.9746, dtype=torch.float64)
6 gae_duplicate tensor(-1.4675, dtype=torch.float64) tensor(15.4534, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2511, dtype=torch.float64) delta_t tensor(-1.1871, dtype=torch.float64)
5 gae_duplicate tensor(-1.7259, dtype=torch.float64) tensor(14.9109, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8287, dtype=torch.float64) delta_t tensor(-1.7379, dtype=torch.float64)
4 gae_duplicate tensor(-2.2082, dtype=torch.float64) tensor(23.8658, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5623, dtype=torch.float64) delta_t tensor(-1.4716, dtype=torch.float64)
3 gae_duplicate tensor(-1.9188, dtype=torch.float64) tensor(20.0501, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3120, dtype=torch.float64) delta_t tensor(-1.3064, dtype=torch.float64)
2 gae_duplicate tensor(-1.8593, dtype=torch.float64) tensor(20.4001, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1426.53955078125
value loss:133.1515350341797
entropies:215.36001586914062
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.889171838760376 seconds
19 rew tensor(0.8250, dtype=torch.float64) delta_t tensor(0.4120, dtype=torch.float64)
19 gae_duplicate tensor(0.3316, dtype=torch.float64) tensor(-4.3062, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8265, dtype=torch.float64) delta_t tensor(0.2822, dtype=torch.float64)
18 gae_duplicate tensor(0.1588, dtype=torch.float64) tensor(-3.9723, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8064, dtype=torch.float64) delta_t tensor(0.3655, dtype=torch.float64)
17 gae_duplicate tensor(0.1596, dtype=torch.float64) tensor(-4.8576, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7863, dtype=torch.float64) delta_t tensor(0.4144, dtype=torch.float64)
16 gae_duplicate tensor(0.3213, dtype=torch.float64) tensor(-5.7244, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7337, dtype=torch.float64) delta_t tensor(0.4817, dtype=torch.float64)
15 gae_duplicate tensor(0.0165, dtype=torch.float64) tensor(-6.6276, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8429, dtype=torch.float64) delta_t tensor(0.5886, dtype=torch.float64)
14 gae_duplicate tensor(0.4580, dtype=torch.float64) tensor(-6.7799, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8337, dtype=torch.float64) delta_t tensor(0.5883, dtype=torch.float64)
13 gae_duplicate tensor(0.4594, dtype=torch.float64) tensor(-9.0673, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7602, dtype=torch.float64) delta_t tensor(0.4998, dtype=torch.float64)
12 gae_duplicate tensor(0.3988, dtype=torch.float64) tensor(-6.5779, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7302, dtype=torch.float64) delta_t tensor(0.4796, dtype=torch.float64)
11 gae_duplicate tensor(-0.0968, dtype=torch.float64) tensor(-6.2088, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6272, dtype=torch.float64) delta_t tensor(0.2194, dtype=torch.float64)
10 gae_duplicate tensor(-0.0379, dtype=torch.float64) tensor(-3.5293, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3232, dtype=torch.float64) delta_t tensor(-0.1299, dtype=torch.float64)
9 gae_duplicate tensor(-0.6096, dtype=torch.float64) tensor(1.2202, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0402, dtype=torch.float64) delta_t tensor(-0.3171, dtype=torch.float64)
8 gae_duplicate tensor(-1.0889, dtype=torch.float64) tensor(3.4169, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3283, dtype=torch.float64) delta_t tensor(-0.6354, dtype=torch.float64)
7 gae_duplicate tensor(-1.3340, dtype=torch.float64) tensor(8.2246, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9737, dtype=torch.float64) delta_t tensor(-0.9552, dtype=torch.float64)
6 gae_duplicate tensor(-1.7495, dtype=torch.float64) tensor(12.2758, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4487, dtype=torch.float64) delta_t tensor(-1.4215, dtype=torch.float64)
5 gae_duplicate tensor(-2.1565, dtype=torch.float64) tensor(15.8483, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7610, dtype=torch.float64) delta_t tensor(-1.6466, dtype=torch.float64)
4 gae_duplicate tensor(-2.0987, dtype=torch.float64) tensor(20.3091, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5578, dtype=torch.float64) delta_t tensor(-1.4249, dtype=torch.float64)
3 gae_duplicate tensor(-2.3436, dtype=torch.float64) tensor(19.9974, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1852, dtype=torch.float64) delta_t tensor(-1.2149, dtype=torch.float64)
2 gae_duplicate tensor(-2.1484, dtype=torch.float64) tensor(17.4575, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1518.335693359375
value loss:139.76333618164062
entropies:215.52549743652344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.771974325180054 seconds
19 rew tensor(0.8349, dtype=torch.float64) delta_t tensor(0.3794, dtype=torch.float64)
19 gae_duplicate tensor(0.2406, dtype=torch.float64) tensor(-5.3637, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8363, dtype=torch.float64) delta_t tensor(0.3134, dtype=torch.float64)
18 gae_duplicate tensor(0.2808, dtype=torch.float64) tensor(-4.2894, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8378, dtype=torch.float64) delta_t tensor(0.3555, dtype=torch.float64)
17 gae_duplicate tensor(0.2901, dtype=torch.float64) tensor(-4.4841, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8393, dtype=torch.float64) delta_t tensor(0.3593, dtype=torch.float64)
16 gae_duplicate tensor(0.3423, dtype=torch.float64) tensor(-5.2785, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8408, dtype=torch.float64) delta_t tensor(0.5674, dtype=torch.float64)
15 gae_duplicate tensor(0.5012, dtype=torch.float64) tensor(-7.8861, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8424, dtype=torch.float64) delta_t tensor(0.5450, dtype=torch.float64)
14 gae_duplicate tensor(0.5094, dtype=torch.float64) tensor(-8.1947, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8439, dtype=torch.float64) delta_t tensor(0.5699, dtype=torch.float64)
13 gae_duplicate tensor(0.5186, dtype=torch.float64) tensor(-7.0779, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8454, dtype=torch.float64) delta_t tensor(0.5916, dtype=torch.float64)
12 gae_duplicate tensor(0.5730, dtype=torch.float64) tensor(-7.9005, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8470, dtype=torch.float64) delta_t tensor(0.5848, dtype=torch.float64)
11 gae_duplicate tensor(0.5926, dtype=torch.float64) tensor(-7.8472, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8485, dtype=torch.float64) delta_t tensor(0.3307, dtype=torch.float64)
10 gae_duplicate tensor(0.2806, dtype=torch.float64) tensor(-4.6513, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4599, dtype=torch.float64) delta_t tensor(-0.0923, dtype=torch.float64)
9 gae_duplicate tensor(-0.2072, dtype=torch.float64) tensor(0.6172, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1055, dtype=torch.float64) delta_t tensor(-0.1448, dtype=torch.float64)
8 gae_duplicate tensor(-0.3541, dtype=torch.float64) tensor(1.5625, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2977, dtype=torch.float64) delta_t tensor(-0.7075, dtype=torch.float64)
7 gae_duplicate tensor(-1.3188, dtype=torch.float64) tensor(8.0600, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9824, dtype=torch.float64) delta_t tensor(-0.9329, dtype=torch.float64)
6 gae_duplicate tensor(-1.9316, dtype=torch.float64) tensor(11.7559, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3846, dtype=torch.float64) delta_t tensor(-1.2695, dtype=torch.float64)
5 gae_duplicate tensor(-2.1654, dtype=torch.float64) tensor(18.1725, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8750, dtype=torch.float64) delta_t tensor(-1.7298, dtype=torch.float64)
4 gae_duplicate tensor(-2.5594, dtype=torch.float64) tensor(22.5431, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4935, dtype=torch.float64) delta_t tensor(-1.3363, dtype=torch.float64)
3 gae_duplicate tensor(-1.9197, dtype=torch.float64) tensor(20.7921, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2613, dtype=torch.float64) delta_t tensor(-1.2179, dtype=torch.float64)
2 gae_duplicate tensor(-2.0510, dtype=torch.float64) tensor(15.2899, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1328.338623046875
value loss:136.22166442871094
entropies:215.6782989501953
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.826492071151733 seconds
19 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.3489, dtype=torch.float64)
19 gae_duplicate tensor(0.1607, dtype=torch.float64) tensor(-3.9855, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8052, dtype=torch.float64) delta_t tensor(0.2798, dtype=torch.float64)
18 gae_duplicate tensor(0.2385, dtype=torch.float64) tensor(-3.8894, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7641, dtype=torch.float64) delta_t tensor(0.2941, dtype=torch.float64)
17 gae_duplicate tensor(0.0951, dtype=torch.float64) tensor(-4.2555, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6912, dtype=torch.float64) delta_t tensor(0.2414, dtype=torch.float64)
16 gae_duplicate tensor(-0.5966, dtype=torch.float64) tensor(-3.5868, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5654, dtype=torch.float64) delta_t tensor(0.3112, dtype=torch.float64)
15 gae_duplicate tensor(-1.0491, dtype=torch.float64) tensor(-4.4877, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8415, dtype=torch.float64) delta_t tensor(0.5635, dtype=torch.float64)
14 gae_duplicate tensor(0.4820, dtype=torch.float64) tensor(-6.7138, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8429, dtype=torch.float64) delta_t tensor(0.5555, dtype=torch.float64)
13 gae_duplicate tensor(0.4871, dtype=torch.float64) tensor(-7.1082, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8444, dtype=torch.float64) delta_t tensor(0.5875, dtype=torch.float64)
12 gae_duplicate tensor(0.5060, dtype=torch.float64) tensor(-6.8822, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8459, dtype=torch.float64) delta_t tensor(0.5803, dtype=torch.float64)
11 gae_duplicate tensor(0.5561, dtype=torch.float64) tensor(-8.3682, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7946, dtype=torch.float64) delta_t tensor(0.2551, dtype=torch.float64)
10 gae_duplicate tensor(0.2524, dtype=torch.float64) tensor(-3.9925, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4806, dtype=torch.float64) delta_t tensor(0.0103, dtype=torch.float64)
9 gae_duplicate tensor(-0.1074, dtype=torch.float64) tensor(-0.4951, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0359, dtype=torch.float64) delta_t tensor(-0.2601, dtype=torch.float64)
8 gae_duplicate tensor(-1.2963, dtype=torch.float64) tensor(2.9520, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1958, dtype=torch.float64) delta_t tensor(-0.6205, dtype=torch.float64)
7 gae_duplicate tensor(-1.0139, dtype=torch.float64) tensor(6.7522, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1508, dtype=torch.float64) delta_t tensor(-1.1485, dtype=torch.float64)
6 gae_duplicate tensor(-2.9989, dtype=torch.float64) tensor(13.3583, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2804, dtype=torch.float64) delta_t tensor(-1.1813, dtype=torch.float64)
5 gae_duplicate tensor(-2.1259, dtype=torch.float64) tensor(17.5792, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5907, dtype=torch.float64) delta_t tensor(-1.4446, dtype=torch.float64)
4 gae_duplicate tensor(-2.1235, dtype=torch.float64) tensor(16.4314, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4807, dtype=torch.float64) delta_t tensor(-1.3444, dtype=torch.float64)
3 gae_duplicate tensor(-1.9256, dtype=torch.float64) tensor(16.5863, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0939, dtype=torch.float64) delta_t tensor(-1.0977, dtype=torch.float64)
2 gae_duplicate tensor(-1.6240, dtype=torch.float64) tensor(13.0481, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1224.800537109375
value loss:131.7571563720703
entropies:215.91188049316406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2473.7146)
ToM Target loss= tensor(1805.4106)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.6676671504974365 seconds
19 rew tensor(0.7986, dtype=torch.float64) delta_t tensor(0.3511, dtype=torch.float64)
19 gae_duplicate tensor(-0.0066, dtype=torch.float64) tensor(-3.7016, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7708, dtype=torch.float64) delta_t tensor(0.1687, dtype=torch.float64)
18 gae_duplicate tensor(-0.0511, dtype=torch.float64) tensor(-2.4846, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7113, dtype=torch.float64) delta_t tensor(0.1979, dtype=torch.float64)
17 gae_duplicate tensor(-0.1149, dtype=torch.float64) tensor(-2.4571, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5860, dtype=torch.float64) delta_t tensor(0.0749, dtype=torch.float64)
16 gae_duplicate tensor(-0.6067, dtype=torch.float64) tensor(-1.7115, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3591, dtype=torch.float64) delta_t tensor(0.0913, dtype=torch.float64)
15 gae_duplicate tensor(-0.9903, dtype=torch.float64) tensor(-1.4624, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8428, dtype=torch.float64) delta_t tensor(0.5455, dtype=torch.float64)
14 gae_duplicate tensor(0.4466, dtype=torch.float64) tensor(-6.7080, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8442, dtype=torch.float64) delta_t tensor(0.5895, dtype=torch.float64)
13 gae_duplicate tensor(0.5788, dtype=torch.float64) tensor(-8.1401, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8350, dtype=torch.float64) delta_t tensor(0.5596, dtype=torch.float64)
12 gae_duplicate tensor(0.5206, dtype=torch.float64) tensor(-6.6443, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7100, dtype=torch.float64) delta_t tensor(0.4297, dtype=torch.float64)
11 gae_duplicate tensor(-0.1943, dtype=torch.float64) tensor(-5.2387, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5065, dtype=torch.float64) delta_t tensor(-0.0161, dtype=torch.float64)
10 gae_duplicate tensor(-0.8868, dtype=torch.float64) tensor(-0.7148, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1432, dtype=torch.float64) delta_t tensor(-0.6905, dtype=torch.float64)
9 gae_duplicate tensor(-3.4042, dtype=torch.float64) tensor(7.2846, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1553, dtype=torch.float64) delta_t tensor(-0.1246, dtype=torch.float64)
8 gae_duplicate tensor(-1.0388, dtype=torch.float64) tensor(2.6618, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0164, dtype=torch.float64) delta_t tensor(-0.3934, dtype=torch.float64)
7 gae_duplicate tensor(-0.6134, dtype=torch.float64) tensor(4.2953, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9384, dtype=torch.float64) delta_t tensor(-0.8146, dtype=torch.float64)
6 gae_duplicate tensor(-1.4714, dtype=torch.float64) tensor(8.9209, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4299, dtype=torch.float64) delta_t tensor(-1.2553, dtype=torch.float64)
5 gae_duplicate tensor(-1.8701, dtype=torch.float64) tensor(14.0443, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9085, dtype=torch.float64) delta_t tensor(-1.7033, dtype=torch.float64)
4 gae_duplicate tensor(-2.3427, dtype=torch.float64) tensor(20.2762, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6696, dtype=torch.float64) delta_t tensor(-1.4141, dtype=torch.float64)
3 gae_duplicate tensor(-1.7437, dtype=torch.float64) tensor(19.3501, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5619, dtype=torch.float64) delta_t tensor(-1.4053, dtype=torch.float64)
2 gae_duplicate tensor(-1.8562, dtype=torch.float64) tensor(20.5517, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2131.35400390625
value loss:151.06753540039062
entropies:216.4536590576172
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.879246234893799 seconds
19 rew tensor(0.8286, dtype=torch.float64) delta_t tensor(0.4725, dtype=torch.float64)
19 gae_duplicate tensor(0.1979, dtype=torch.float64) tensor(-5.8316, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8079, dtype=torch.float64) delta_t tensor(0.1951, dtype=torch.float64)
18 gae_duplicate tensor(-0.0031, dtype=torch.float64) tensor(-2.7549, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7654, dtype=torch.float64) delta_t tensor(0.2400, dtype=torch.float64)
17 gae_duplicate tensor(-0.1441, dtype=torch.float64) tensor(-3.6078, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7119, dtype=torch.float64) delta_t tensor(0.2600, dtype=torch.float64)
16 gae_duplicate tensor(-0.6005, dtype=torch.float64) tensor(-3.7085, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5928, dtype=torch.float64) delta_t tensor(0.3291, dtype=torch.float64)
15 gae_duplicate tensor(-0.9508, dtype=torch.float64) tensor(-3.7682, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8450, dtype=torch.float64) delta_t tensor(0.5585, dtype=torch.float64)
14 gae_duplicate tensor(0.4536, dtype=torch.float64) tensor(-6.8089, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8355, dtype=torch.float64) delta_t tensor(0.5540, dtype=torch.float64)
13 gae_duplicate tensor(0.5451, dtype=torch.float64) tensor(-7.8184, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8368, dtype=torch.float64) delta_t tensor(0.5506, dtype=torch.float64)
12 gae_duplicate tensor(0.5429, dtype=torch.float64) tensor(-7.8268, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7731, dtype=torch.float64) delta_t tensor(0.4879, dtype=torch.float64)
11 gae_duplicate tensor(0.1473, dtype=torch.float64) tensor(-7.1798, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6749, dtype=torch.float64) delta_t tensor(0.1240, dtype=torch.float64)
10 gae_duplicate tensor(-0.1149, dtype=torch.float64) tensor(-1.9663, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3597, dtype=torch.float64) delta_t tensor(-0.1438, dtype=torch.float64)
9 gae_duplicate tensor(-0.4963, dtype=torch.float64) tensor(1.2539, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1573, dtype=torch.float64) delta_t tensor(-0.1243, dtype=torch.float64)
8 gae_duplicate tensor(-0.6357, dtype=torch.float64) tensor(2.2532, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1546, dtype=torch.float64) delta_t tensor(-0.5168, dtype=torch.float64)
7 gae_duplicate tensor(-0.7551, dtype=torch.float64) tensor(6.0453, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0431, dtype=torch.float64) delta_t tensor(-0.8506, dtype=torch.float64)
6 gae_duplicate tensor(-1.0385, dtype=torch.float64) tensor(11.7107, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4746, dtype=torch.float64) delta_t tensor(-1.2709, dtype=torch.float64)
5 gae_duplicate tensor(-1.9002, dtype=torch.float64) tensor(17.3742, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9264, dtype=torch.float64) delta_t tensor(-1.6900, dtype=torch.float64)
4 gae_duplicate tensor(-2.3906, dtype=torch.float64) tensor(20.5282, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5387, dtype=torch.float64) delta_t tensor(-1.2418, dtype=torch.float64)
3 gae_duplicate tensor(-1.6062, dtype=torch.float64) tensor(16.1895, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4351, dtype=torch.float64) delta_t tensor(-1.2885, dtype=torch.float64)
2 gae_duplicate tensor(-2.1230, dtype=torch.float64) tensor(17.0859, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1521.112060546875
value loss:121.74080657958984
entropies:216.6853485107422
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.876255989074707 seconds
19 rew tensor(0.8298, dtype=torch.float64) delta_t tensor(0.5358, dtype=torch.float64)
19 gae_duplicate tensor(0.4030, dtype=torch.float64) tensor(-6.1084, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8100, dtype=torch.float64) delta_t tensor(0.1633, dtype=torch.float64)
18 gae_duplicate tensor(0.0257, dtype=torch.float64) tensor(-2.3034, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7795, dtype=torch.float64) delta_t tensor(0.2378, dtype=torch.float64)
17 gae_duplicate tensor(-0.1393, dtype=torch.float64) tensor(-2.8519, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7385, dtype=torch.float64) delta_t tensor(0.3398, dtype=torch.float64)
16 gae_duplicate tensor(-0.2565, dtype=torch.float64) tensor(-3.9659, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6343, dtype=torch.float64) delta_t tensor(0.3708, dtype=torch.float64)
15 gae_duplicate tensor(-0.6529, dtype=torch.float64) tensor(-4.7911, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8458, dtype=torch.float64) delta_t tensor(0.5639, dtype=torch.float64)
14 gae_duplicate tensor(0.5077, dtype=torch.float64) tensor(-7.8407, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8471, dtype=torch.float64) delta_t tensor(0.5666, dtype=torch.float64)
13 gae_duplicate tensor(0.5069, dtype=torch.float64) tensor(-8.0055, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8484, dtype=torch.float64) delta_t tensor(0.5799, dtype=torch.float64)
12 gae_duplicate tensor(0.5140, dtype=torch.float64) tensor(-6.9122, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8498, dtype=torch.float64) delta_t tensor(0.6135, dtype=torch.float64)
11 gae_duplicate tensor(0.5818, dtype=torch.float64) tensor(-8.2575, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6709, dtype=torch.float64) delta_t tensor(0.1781, dtype=torch.float64)
10 gae_duplicate tensor(0.0049, dtype=torch.float64) tensor(-2.6001, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3465, dtype=torch.float64) delta_t tensor(-0.1230, dtype=torch.float64)
9 gae_duplicate tensor(-0.5064, dtype=torch.float64) tensor(1.0398, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0640, dtype=torch.float64) delta_t tensor(-0.1978, dtype=torch.float64)
8 gae_duplicate tensor(-0.5753, dtype=torch.float64) tensor(2.2691, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1952, dtype=torch.float64) delta_t tensor(-0.5140, dtype=torch.float64)
7 gae_duplicate tensor(-0.7750, dtype=torch.float64) tensor(7.0186, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1358, dtype=torch.float64) delta_t tensor(-0.9106, dtype=torch.float64)
6 gae_duplicate tensor(-1.2189, dtype=torch.float64) tensor(10.1752, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5795, dtype=torch.float64) delta_t tensor(-1.3217, dtype=torch.float64)
5 gae_duplicate tensor(-1.8148, dtype=torch.float64) tensor(17.1976, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1059, dtype=torch.float64) delta_t tensor(-1.8398, dtype=torch.float64)
4 gae_duplicate tensor(-2.3120, dtype=torch.float64) tensor(22.6322, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7152, dtype=torch.float64) delta_t tensor(-1.3500, dtype=torch.float64)
3 gae_duplicate tensor(-1.7508, dtype=torch.float64) tensor(22.6436, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5565, dtype=torch.float64) delta_t tensor(-1.3020, dtype=torch.float64)
2 gae_duplicate tensor(-1.7561, dtype=torch.float64) tensor(16.6149, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1693.478271484375
value loss:135.34600830078125
entropies:217.34368896484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.739547252655029 seconds
19 rew tensor(0.8084, dtype=torch.float64) delta_t tensor(0.2450, dtype=torch.float64)
19 gae_duplicate tensor(0.0038, dtype=torch.float64) tensor(-3.1133, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8096, dtype=torch.float64) delta_t tensor(0.2909, dtype=torch.float64)
18 gae_duplicate tensor(0.0561, dtype=torch.float64) tensor(-3.3788, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7785, dtype=torch.float64) delta_t tensor(0.3691, dtype=torch.float64)
17 gae_duplicate tensor(0.0326, dtype=torch.float64) tensor(-5.2217, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6938, dtype=torch.float64) delta_t tensor(0.2079, dtype=torch.float64)
16 gae_duplicate tensor(-0.6391, dtype=torch.float64) tensor(-2.6982, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5768, dtype=torch.float64) delta_t tensor(0.2806, dtype=torch.float64)
15 gae_duplicate tensor(-1.1125, dtype=torch.float64) tensor(-4.1651, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8457, dtype=torch.float64) delta_t tensor(0.6180, dtype=torch.float64)
14 gae_duplicate tensor(0.4185, dtype=torch.float64) tensor(-7.9144, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8470, dtype=torch.float64) delta_t tensor(0.6115, dtype=torch.float64)
13 gae_duplicate tensor(0.5314, dtype=torch.float64) tensor(-7.5862, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8483, dtype=torch.float64) delta_t tensor(0.5930, dtype=torch.float64)
12 gae_duplicate tensor(0.5896, dtype=torch.float64) tensor(-8.9742, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8495, dtype=torch.float64) delta_t tensor(0.5963, dtype=torch.float64)
11 gae_duplicate tensor(0.5925, dtype=torch.float64) tensor(-8.3370, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8508, dtype=torch.float64) delta_t tensor(0.1751, dtype=torch.float64)
10 gae_duplicate tensor(0.1354, dtype=torch.float64) tensor(-2.8037, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5588, dtype=torch.float64) delta_t tensor(0.0588, dtype=torch.float64)
9 gae_duplicate tensor(-0.1179, dtype=torch.float64) tensor(-0.8906, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2766, dtype=torch.float64) delta_t tensor(-0.1322, dtype=torch.float64)
8 gae_duplicate tensor(-0.3331, dtype=torch.float64) tensor(1.3952, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2438, dtype=torch.float64) delta_t tensor(-0.8209, dtype=torch.float64)
7 gae_duplicate tensor(-1.1161, dtype=torch.float64) tensor(10.9609, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4777, dtype=torch.float64) delta_t tensor(-0.2135, dtype=torch.float64)
6 gae_duplicate tensor(-0.6412, dtype=torch.float64) tensor(3.8715, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9738, dtype=torch.float64) delta_t tensor(-0.7107, dtype=torch.float64)
5 gae_duplicate tensor(-1.2301, dtype=torch.float64) tensor(8.3350, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8530, dtype=torch.float64) delta_t tensor(-1.4822, dtype=torch.float64)
4 gae_duplicate tensor(-2.0965, dtype=torch.float64) tensor(18.8311, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5459, dtype=torch.float64) delta_t tensor(-1.1589, dtype=torch.float64)
3 gae_duplicate tensor(-1.9272, dtype=torch.float64) tensor(15.8762, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0505, dtype=torch.float64) delta_t tensor(-0.9053, dtype=torch.float64)
2 gae_duplicate tensor(-1.6062, dtype=torch.float64) tensor(12.5178, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-640.7681884765625
value loss:91.09687042236328
entropies:218.94837951660156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.729344844818115 seconds
19 rew tensor(0.8244, dtype=torch.float64) delta_t tensor(0.4331, dtype=torch.float64)
19 gae_duplicate tensor(0.2071, dtype=torch.float64) tensor(-5.0047, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8256, dtype=torch.float64) delta_t tensor(0.2628, dtype=torch.float64)
18 gae_duplicate tensor(0.1944, dtype=torch.float64) tensor(-3.8171, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7955, dtype=torch.float64) delta_t tensor(0.2646, dtype=torch.float64)
17 gae_duplicate tensor(0.0755, dtype=torch.float64) tensor(-3.6092, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7549, dtype=torch.float64) delta_t tensor(0.4113, dtype=torch.float64)
16 gae_duplicate tensor(0.1381, dtype=torch.float64) tensor(-5.0366, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7040, dtype=torch.float64) delta_t tensor(0.3504, dtype=torch.float64)
15 gae_duplicate tensor(-0.4485, dtype=torch.float64) tensor(-4.2809, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5594, dtype=torch.float64) delta_t tensor(0.2143, dtype=torch.float64)
14 gae_duplicate tensor(-0.9325, dtype=torch.float64) tensor(-3.1636, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7887, dtype=torch.float64) delta_t tensor(0.4424, dtype=torch.float64)
13 gae_duplicate tensor(0.0672, dtype=torch.float64) tensor(-5.3900, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.5035, dtype=torch.float64)
12 gae_duplicate tensor(0.3664, dtype=torch.float64) tensor(-7.3203, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7583, dtype=torch.float64) delta_t tensor(0.4493, dtype=torch.float64)
11 gae_duplicate tensor(-0.0503, dtype=torch.float64) tensor(-5.4581, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6491, dtype=torch.float64) delta_t tensor(0.2696, dtype=torch.float64)
10 gae_duplicate tensor(-0.2840, dtype=torch.float64) tensor(-3.5732, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2060, dtype=torch.float64) delta_t tensor(-0.6876, dtype=torch.float64)
9 gae_duplicate tensor(-2.4983, dtype=torch.float64) tensor(9.1803, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3825, dtype=torch.float64) delta_t tensor(-0.7114, dtype=torch.float64)
8 gae_duplicate tensor(-2.8585, dtype=torch.float64) tensor(10.3865, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1348, dtype=torch.float64) delta_t tensor(-0.5602, dtype=torch.float64)
7 gae_duplicate tensor(-1.9362, dtype=torch.float64) tensor(7.9259, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7586, dtype=torch.float64) delta_t tensor(-0.7693, dtype=torch.float64)
6 gae_duplicate tensor(-1.7402, dtype=torch.float64) tensor(9.8351, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5896, dtype=torch.float64) delta_t tensor(-1.4345, dtype=torch.float64)
5 gae_duplicate tensor(-3.0981, dtype=torch.float64) tensor(17.7542, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3533, dtype=torch.float64) delta_t tensor(-3.1645, dtype=torch.float64)
4 gae_duplicate tensor(-7.7277, dtype=torch.float64) tensor(43.3277, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2052, dtype=torch.float64) delta_t tensor(-1.0147, dtype=torch.float64)
3 gae_duplicate tensor(-1.5501, dtype=torch.float64) tensor(16.1914, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0385, dtype=torch.float64) delta_t tensor(-0.9396, dtype=torch.float64)
2 gae_duplicate tensor(-1.4770, dtype=torch.float64) tensor(11.3789, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2895.042236328125
value loss:288.9076232910156
entropies:218.30345153808594
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2473.3760)
ToM Target loss= tensor(1806.9875)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.041672229766846 seconds
19 rew tensor(0.7829, dtype=torch.float64) delta_t tensor(0.2746, dtype=torch.float64)
19 gae_duplicate tensor(-0.0051, dtype=torch.float64) tensor(-3.2428, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7622, dtype=torch.float64) delta_t tensor(0.1084, dtype=torch.float64)
18 gae_duplicate tensor(0.0118, dtype=torch.float64) tensor(-1.6744, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7095, dtype=torch.float64) delta_t tensor(0.1996, dtype=torch.float64)
17 gae_duplicate tensor(0.0708, dtype=torch.float64) tensor(-2.3537, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5384, dtype=torch.float64) delta_t tensor(0.0369, dtype=torch.float64)
16 gae_duplicate tensor(-0.6487, dtype=torch.float64) tensor(-0.5951, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3027, dtype=torch.float64) delta_t tensor(0.0436, dtype=torch.float64)
15 gae_duplicate tensor(-1.0387, dtype=torch.float64) tensor(-0.3272, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8402, dtype=torch.float64) delta_t tensor(0.6159, dtype=torch.float64)
14 gae_duplicate tensor(0.4840, dtype=torch.float64) tensor(-7.7529, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8414, dtype=torch.float64) delta_t tensor(0.5694, dtype=torch.float64)
13 gae_duplicate tensor(0.4799, dtype=torch.float64) tensor(-7.6519, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8425, dtype=torch.float64) delta_t tensor(0.6025, dtype=torch.float64)
12 gae_duplicate tensor(0.6156, dtype=torch.float64) tensor(-7.4154, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8437, dtype=torch.float64) delta_t tensor(0.6100, dtype=torch.float64)
11 gae_duplicate tensor(0.6156, dtype=torch.float64) tensor(-8.1615, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3748, dtype=torch.float64) delta_t tensor(-0.2777, dtype=torch.float64)
10 gae_duplicate tensor(-2.2909, dtype=torch.float64) tensor(2.1750, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4957, dtype=torch.float64) delta_t tensor(-0.0270, dtype=torch.float64)
9 gae_duplicate tensor(-0.2764, dtype=torch.float64) tensor(0.4915, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2065, dtype=torch.float64) delta_t tensor(-0.1935, dtype=torch.float64)
8 gae_duplicate tensor(-0.5418, dtype=torch.float64) tensor(2.1864, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1471, dtype=torch.float64) delta_t tensor(-0.5797, dtype=torch.float64)
7 gae_duplicate tensor(-0.9159, dtype=torch.float64) tensor(6.4369, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6357, dtype=torch.float64) delta_t tensor(-0.2489, dtype=torch.float64)
6 gae_duplicate tensor(-1.1082, dtype=torch.float64) tensor(3.2685, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2417, dtype=torch.float64) delta_t tensor(-0.9347, dtype=torch.float64)
5 gae_duplicate tensor(-1.4856, dtype=torch.float64) tensor(10.2241, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9329, dtype=torch.float64) delta_t tensor(-1.5398, dtype=torch.float64)
4 gae_duplicate tensor(-2.0660, dtype=torch.float64) tensor(20.9714, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6252, dtype=torch.float64) delta_t tensor(-1.1786, dtype=torch.float64)
3 gae_duplicate tensor(-1.6878, dtype=torch.float64) tensor(15.0565, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3864, dtype=torch.float64) delta_t tensor(-1.0995, dtype=torch.float64)
2 gae_duplicate tensor(-1.3870, dtype=torch.float64) tensor(15.1030, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1361.9774169921875
value loss:106.13435363769531
entropies:218.88479614257812
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.679300785064697 seconds
19 rew tensor(0.8270, dtype=torch.float64) delta_t tensor(0.5114, dtype=torch.float64)
19 gae_duplicate tensor(0.1688, dtype=torch.float64) tensor(-5.8757, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8069, dtype=torch.float64) delta_t tensor(0.2056, dtype=torch.float64)
18 gae_duplicate tensor(0.0916, dtype=torch.float64) tensor(-3.1614, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7656, dtype=torch.float64) delta_t tensor(0.3063, dtype=torch.float64)
17 gae_duplicate tensor(0.0499, dtype=torch.float64) tensor(-4.2439, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7136, dtype=torch.float64) delta_t tensor(0.3941, dtype=torch.float64)
16 gae_duplicate tensor(-0.0429, dtype=torch.float64) tensor(-4.9300, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6086, dtype=torch.float64) delta_t tensor(0.3263, dtype=torch.float64)
15 gae_duplicate tensor(-0.8825, dtype=torch.float64) tensor(-4.4553, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8106, dtype=torch.float64) delta_t tensor(0.4963, dtype=torch.float64)
14 gae_duplicate tensor(0.2826, dtype=torch.float64) tensor(-6.1957, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7906, dtype=torch.float64) delta_t tensor(0.5028, dtype=torch.float64)
13 gae_duplicate tensor(0.1169, dtype=torch.float64) tensor(-6.9052, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7914, dtype=torch.float64) delta_t tensor(0.4928, dtype=torch.float64)
12 gae_duplicate tensor(0.3412, dtype=torch.float64) tensor(-7.0348, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7290, dtype=torch.float64) delta_t tensor(0.4918, dtype=torch.float64)
11 gae_duplicate tensor(0.0399, dtype=torch.float64) tensor(-5.8624, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6078, dtype=torch.float64) delta_t tensor(0.2648, dtype=torch.float64)
10 gae_duplicate tensor(0.0055, dtype=torch.float64) tensor(-4.4457, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1371, dtype=torch.float64) delta_t tensor(-0.5602, dtype=torch.float64)
9 gae_duplicate tensor(-2.4681, dtype=torch.float64) tensor(5.6608, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2722, dtype=torch.float64) delta_t tensor(-0.6217, dtype=torch.float64)
8 gae_duplicate tensor(-2.8266, dtype=torch.float64) tensor(9.5018, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0555, dtype=torch.float64) delta_t tensor(-0.4460, dtype=torch.float64)
7 gae_duplicate tensor(-0.7877, dtype=torch.float64) tensor(6.3307, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7679, dtype=torch.float64) delta_t tensor(-0.5131, dtype=torch.float64)
6 gae_duplicate tensor(-0.7772, dtype=torch.float64) tensor(6.5359, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8783, dtype=torch.float64) delta_t tensor(-1.6300, dtype=torch.float64)
5 gae_duplicate tensor(-4.6055, dtype=torch.float64) tensor(20.1651, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7038, dtype=torch.float64) delta_t tensor(-1.3775, dtype=torch.float64)
4 gae_duplicate tensor(-1.8357, dtype=torch.float64) tensor(21.3335, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4059, dtype=torch.float64) delta_t tensor(-0.9943, dtype=torch.float64)
3 gae_duplicate tensor(-1.3994, dtype=torch.float64) tensor(14.6709, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2777, dtype=torch.float64) delta_t tensor(-0.9696, dtype=torch.float64)
2 gae_duplicate tensor(-1.7935, dtype=torch.float64) tensor(11.5280, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1573.4322509765625
value loss:143.66635131835938
entropies:217.96493530273438
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.091461181640625 seconds
19 rew tensor(0.8369, dtype=torch.float64) delta_t tensor(0.4939, dtype=torch.float64)
19 gae_duplicate tensor(0.1487, dtype=torch.float64) tensor(-5.5036, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8380, dtype=torch.float64) delta_t tensor(0.3963, dtype=torch.float64)
18 gae_duplicate tensor(0.1993, dtype=torch.float64) tensor(-5.2542, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8391, dtype=torch.float64) delta_t tensor(0.5146, dtype=torch.float64)
17 gae_duplicate tensor(0.2932, dtype=torch.float64) tensor(-5.9401, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8402, dtype=torch.float64) delta_t tensor(0.5183, dtype=torch.float64)
16 gae_duplicate tensor(0.2663, dtype=torch.float64) tensor(-7.5700, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8413, dtype=torch.float64) delta_t tensor(0.6171, dtype=torch.float64)
15 gae_duplicate tensor(0.5419, dtype=torch.float64) tensor(-8.9786, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8424, dtype=torch.float64) delta_t tensor(0.6051, dtype=torch.float64)
14 gae_duplicate tensor(0.5397, dtype=torch.float64) tensor(-7.7995, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8435, dtype=torch.float64) delta_t tensor(0.6138, dtype=torch.float64)
13 gae_duplicate tensor(0.5550, dtype=torch.float64) tensor(-8.2516, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8446, dtype=torch.float64) delta_t tensor(0.6205, dtype=torch.float64)
12 gae_duplicate tensor(0.6138, dtype=torch.float64) tensor(-8.2566, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8457, dtype=torch.float64) delta_t tensor(0.6499, dtype=torch.float64)
11 gae_duplicate tensor(0.6446, dtype=torch.float64) tensor(-9.0617, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7940, dtype=torch.float64) delta_t tensor(0.4619, dtype=torch.float64)
10 gae_duplicate tensor(0.1640, dtype=torch.float64) tensor(-6.6302, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4530, dtype=torch.float64) delta_t tensor(0.0610, dtype=torch.float64)
9 gae_duplicate tensor(-0.0645, dtype=torch.float64) tensor(-1.3812, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1924, dtype=torch.float64) delta_t tensor(-0.0799, dtype=torch.float64)
8 gae_duplicate tensor(-0.4278, dtype=torch.float64) tensor(0.5256, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1814, dtype=torch.float64) delta_t tensor(-0.5771, dtype=torch.float64)
7 gae_duplicate tensor(-1.2875, dtype=torch.float64) tensor(7.0883, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7106, dtype=torch.float64) delta_t tensor(-0.3528, dtype=torch.float64)
6 gae_duplicate tensor(-0.9780, dtype=torch.float64) tensor(4.7995, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1493, dtype=torch.float64) delta_t tensor(-0.7433, dtype=torch.float64)
5 gae_duplicate tensor(-1.2506, dtype=torch.float64) tensor(8.7406, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6211, dtype=torch.float64) delta_t tensor(-1.1227, dtype=torch.float64)
4 gae_duplicate tensor(-1.8941, dtype=torch.float64) tensor(14.2136, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5353, dtype=torch.float64) delta_t tensor(-1.0009, dtype=torch.float64)
3 gae_duplicate tensor(-1.6253, dtype=torch.float64) tensor(13.1877, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1212, dtype=torch.float64) delta_t tensor(-0.7097, dtype=torch.float64)
2 gae_duplicate tensor(-1.2946, dtype=torch.float64) tensor(9.3640, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:562.3012084960938
value loss:88.64104461669922
entropies:217.71759033203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.952960729598999 seconds
19 rew tensor(0.8361, dtype=torch.float64) delta_t tensor(0.5438, dtype=torch.float64)
19 gae_duplicate tensor(0.1143, dtype=torch.float64) tensor(-6.3354, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8372, dtype=torch.float64) delta_t tensor(0.3169, dtype=torch.float64)
18 gae_duplicate tensor(0.2090, dtype=torch.float64) tensor(-4.2887, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8382, dtype=torch.float64) delta_t tensor(0.4636, dtype=torch.float64)
17 gae_duplicate tensor(0.3446, dtype=torch.float64) tensor(-5.3195, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8393, dtype=torch.float64) delta_t tensor(0.4833, dtype=torch.float64)
16 gae_duplicate tensor(0.1788, dtype=torch.float64) tensor(-6.8994, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8404, dtype=torch.float64) delta_t tensor(0.6685, dtype=torch.float64)
15 gae_duplicate tensor(0.5870, dtype=torch.float64) tensor(-8.5628, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8414, dtype=torch.float64) delta_t tensor(0.6312, dtype=torch.float64)
14 gae_duplicate tensor(0.5542, dtype=torch.float64) tensor(-8.5206, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8425, dtype=torch.float64) delta_t tensor(0.6549, dtype=torch.float64)
13 gae_duplicate tensor(0.5658, dtype=torch.float64) tensor(-9.1802, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8436, dtype=torch.float64) delta_t tensor(0.6723, dtype=torch.float64)
12 gae_duplicate tensor(0.6558, dtype=torch.float64) tensor(-9.6251, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8446, dtype=torch.float64) delta_t tensor(0.7001, dtype=torch.float64)
11 gae_duplicate tensor(0.6841, dtype=torch.float64) tensor(-8.8369, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8457, dtype=torch.float64) delta_t tensor(0.4547, dtype=torch.float64)
10 gae_duplicate tensor(0.2081, dtype=torch.float64) tensor(-6.0542, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5145, dtype=torch.float64) delta_t tensor(0.0316, dtype=torch.float64)
9 gae_duplicate tensor(-0.1657, dtype=torch.float64) tensor(-1.1375, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2975, dtype=torch.float64) delta_t tensor(0.1094, dtype=torch.float64)
8 gae_duplicate tensor(-0.3714, dtype=torch.float64) tensor(-1.1965, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0571, dtype=torch.float64) delta_t tensor(-0.6190, dtype=torch.float64)
7 gae_duplicate tensor(-0.8212, dtype=torch.float64) tensor(6.8715, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7849, dtype=torch.float64) delta_t tensor(-0.2660, dtype=torch.float64)
6 gae_duplicate tensor(-0.6079, dtype=torch.float64) tensor(3.8654, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1120, dtype=torch.float64) delta_t tensor(-0.6934, dtype=torch.float64)
5 gae_duplicate tensor(-0.9519, dtype=torch.float64) tensor(8.1842, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7429, dtype=torch.float64) delta_t tensor(-1.2070, dtype=torch.float64)
4 gae_duplicate tensor(-1.6417, dtype=torch.float64) tensor(17.2252, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5193, dtype=torch.float64) delta_t tensor(-0.8849, dtype=torch.float64)
3 gae_duplicate tensor(-1.2994, dtype=torch.float64) tensor(11.9878, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1702, dtype=torch.float64) delta_t tensor(-0.6653, dtype=torch.float64)
2 gae_duplicate tensor(-1.0495, dtype=torch.float64) tensor(9.7787, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:610.36328125
value loss:82.07499694824219
entropies:217.87054443359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9047629833221436 seconds
19 rew tensor(0.8258, dtype=torch.float64) delta_t tensor(0.5445, dtype=torch.float64)
19 gae_duplicate tensor(0.2082, dtype=torch.float64) tensor(-6.5275, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8176, dtype=torch.float64) delta_t tensor(0.2410, dtype=torch.float64)
18 gae_duplicate tensor(0.1807, dtype=torch.float64) tensor(-3.4969, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8093, dtype=torch.float64) delta_t tensor(0.3412, dtype=torch.float64)
17 gae_duplicate tensor(0.2460, dtype=torch.float64) tensor(-4.9302, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7825, dtype=torch.float64) delta_t tensor(0.3754, dtype=torch.float64)
16 gae_duplicate tensor(0.2135, dtype=torch.float64) tensor(-5.2435, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7187, dtype=torch.float64) delta_t tensor(0.3962, dtype=torch.float64)
15 gae_duplicate tensor(-0.5620, dtype=torch.float64) tensor(-4.7176, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6088, dtype=torch.float64) delta_t tensor(0.3238, dtype=torch.float64)
14 gae_duplicate tensor(-1.0110, dtype=torch.float64) tensor(-3.3417, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8404, dtype=torch.float64) delta_t tensor(0.5588, dtype=torch.float64)
13 gae_duplicate tensor(0.3029, dtype=torch.float64) tensor(-7.0490, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8414, dtype=torch.float64) delta_t tensor(0.6015, dtype=torch.float64)
12 gae_duplicate tensor(0.4352, dtype=torch.float64) tensor(-7.6868, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8209, dtype=torch.float64) delta_t tensor(0.6074, dtype=torch.float64)
11 gae_duplicate tensor(0.4451, dtype=torch.float64) tensor(-7.9745, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6459, dtype=torch.float64) delta_t tensor(0.1679, dtype=torch.float64)
10 gae_duplicate tensor(-0.3622, dtype=torch.float64) tensor(-2.6870, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0250, dtype=torch.float64) delta_t tensor(-0.5380, dtype=torch.float64)
9 gae_duplicate tensor(-2.3617, dtype=torch.float64) tensor(5.5252, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0247, dtype=torch.float64) delta_t tensor(-0.2881, dtype=torch.float64)
8 gae_duplicate tensor(-1.5700, dtype=torch.float64) tensor(4.7844, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6187, dtype=torch.float64) delta_t tensor(-0.8906, dtype=torch.float64)
7 gae_duplicate tensor(-3.5165, dtype=torch.float64) tensor(9.7577, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2762, dtype=torch.float64) delta_t tensor(-0.9069, dtype=torch.float64)
6 gae_duplicate tensor(-3.0739, dtype=torch.float64) tensor(11.9819, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8600, dtype=torch.float64) delta_t tensor(-1.4520, dtype=torch.float64)
5 gae_duplicate tensor(-3.9415, dtype=torch.float64) tensor(18.3471, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6025, dtype=torch.float64) delta_t tensor(-2.1798, dtype=torch.float64)
4 gae_duplicate tensor(-5.9126, dtype=torch.float64) tensor(31.6572, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6061, dtype=torch.float64) delta_t tensor(-1.0561, dtype=torch.float64)
3 gae_duplicate tensor(-1.4216, dtype=torch.float64) tensor(13.6941, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4301, dtype=torch.float64) delta_t tensor(-0.9719, dtype=torch.float64)
2 gae_duplicate tensor(-1.3400, dtype=torch.float64) tensor(12.7372, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2013.0950927734375
value loss:209.3295135498047
entropies:217.85336303710938
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2465.0039)
ToM Target loss= tensor(1808.0212)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.766610860824585 seconds
19 rew tensor(0.8353, dtype=torch.float64) delta_t tensor(0.4366, dtype=torch.float64)
19 gae_duplicate tensor(0.2958, dtype=torch.float64) tensor(-4.8700, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8363, dtype=torch.float64) delta_t tensor(0.2561, dtype=torch.float64)
18 gae_duplicate tensor(0.1701, dtype=torch.float64) tensor(-4.1836, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8373, dtype=torch.float64) delta_t tensor(0.3640, dtype=torch.float64)
17 gae_duplicate tensor(0.1686, dtype=torch.float64) tensor(-4.6327, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8382, dtype=torch.float64) delta_t tensor(0.3209, dtype=torch.float64)
16 gae_duplicate tensor(0.2331, dtype=torch.float64) tensor(-3.8379, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8392, dtype=torch.float64) delta_t tensor(0.5761, dtype=torch.float64)
15 gae_duplicate tensor(0.4127, dtype=torch.float64) tensor(-8.5036, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8403, dtype=torch.float64) delta_t tensor(0.5456, dtype=torch.float64)
14 gae_duplicate tensor(0.4137, dtype=torch.float64) tensor(-7.5591, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8413, dtype=torch.float64) delta_t tensor(0.5673, dtype=torch.float64)
13 gae_duplicate tensor(0.4231, dtype=torch.float64) tensor(-7.1150, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8423, dtype=torch.float64) delta_t tensor(0.6144, dtype=torch.float64)
12 gae_duplicate tensor(0.4242, dtype=torch.float64) tensor(-8.4486, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7904, dtype=torch.float64) delta_t tensor(0.5331, dtype=torch.float64)
11 gae_duplicate tensor(0.4070, dtype=torch.float64) tensor(-6.5227, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7068, dtype=torch.float64) delta_t tensor(0.1180, dtype=torch.float64)
10 gae_duplicate tensor(-0.4402, dtype=torch.float64) tensor(-2.6022, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3975, dtype=torch.float64) delta_t tensor(-0.1174, dtype=torch.float64)
9 gae_duplicate tensor(-0.6469, dtype=torch.float64) tensor(0.8635, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1297, dtype=torch.float64) delta_t tensor(0.0122, dtype=torch.float64)
8 gae_duplicate tensor(-0.7651, dtype=torch.float64) tensor(-0.4859, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2248, dtype=torch.float64) delta_t tensor(-0.5074, dtype=torch.float64)
7 gae_duplicate tensor(-1.3209, dtype=torch.float64) tensor(5.3893, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9222, dtype=torch.float64) delta_t tensor(-0.3645, dtype=torch.float64)
6 gae_duplicate tensor(-1.2614, dtype=torch.float64) tensor(5.8516, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3199, dtype=torch.float64) delta_t tensor(-0.7890, dtype=torch.float64)
5 gae_duplicate tensor(-1.4864, dtype=torch.float64) tensor(9.3838, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8262, dtype=torch.float64) delta_t tensor(-1.2110, dtype=torch.float64)
4 gae_duplicate tensor(-1.9663, dtype=torch.float64) tensor(16.2848, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4591, dtype=torch.float64) delta_t tensor(-0.7472, dtype=torch.float64)
3 gae_duplicate tensor(-1.1732, dtype=torch.float64) tensor(10.0271, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2748, dtype=torch.float64) delta_t tensor(-0.8142, dtype=torch.float64)
2 gae_duplicate tensor(-1.4748, dtype=torch.float64) tensor(10.1306, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-9.341880798339844
value loss:74.40592193603516
entropies:218.01602172851562
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.812855958938599 seconds
19 rew tensor(0.8353, dtype=torch.float64) delta_t tensor(0.5380, dtype=torch.float64)
19 gae_duplicate tensor(0.3471, dtype=torch.float64) tensor(-6.3466, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8362, dtype=torch.float64) delta_t tensor(0.1464, dtype=torch.float64)
18 gae_duplicate tensor(0.0881, dtype=torch.float64) tensor(-2.4129, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8372, dtype=torch.float64) delta_t tensor(0.2740, dtype=torch.float64)
17 gae_duplicate tensor(0.1448, dtype=torch.float64) tensor(-3.2355, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8382, dtype=torch.float64) delta_t tensor(0.3111, dtype=torch.float64)
16 gae_duplicate tensor(0.1654, dtype=torch.float64) tensor(-3.9856, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8391, dtype=torch.float64) delta_t tensor(0.5667, dtype=torch.float64)
15 gae_duplicate tensor(0.4538, dtype=torch.float64) tensor(-6.8843, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8401, dtype=torch.float64) delta_t tensor(0.5453, dtype=torch.float64)
14 gae_duplicate tensor(0.4550, dtype=torch.float64) tensor(-6.8918, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8411, dtype=torch.float64) delta_t tensor(0.5522, dtype=torch.float64)
13 gae_duplicate tensor(0.4610, dtype=torch.float64) tensor(-7.0394, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8421, dtype=torch.float64) delta_t tensor(0.5775, dtype=torch.float64)
12 gae_duplicate tensor(0.4760, dtype=torch.float64) tensor(-7.3370, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8431, dtype=torch.float64) delta_t tensor(0.6112, dtype=torch.float64)
11 gae_duplicate tensor(0.5340, dtype=torch.float64) tensor(-8.3297, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6296, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
10 gae_duplicate tensor(-0.2845, dtype=torch.float64) tensor(-0.4216, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3502, dtype=torch.float64) delta_t tensor(-0.2645, dtype=torch.float64)
9 gae_duplicate tensor(-0.5658, dtype=torch.float64) tensor(2.9330, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1006, dtype=torch.float64) delta_t tensor(-0.0639, dtype=torch.float64)
8 gae_duplicate tensor(-0.4532, dtype=torch.float64) tensor(1.0096, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1462, dtype=torch.float64) delta_t tensor(-0.4027, dtype=torch.float64)
7 gae_duplicate tensor(-0.8732, dtype=torch.float64) tensor(5.6626, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0721, dtype=torch.float64) delta_t tensor(-0.4924, dtype=torch.float64)
6 gae_duplicate tensor(-1.0528, dtype=torch.float64) tensor(6.3569, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5024, dtype=torch.float64) delta_t tensor(-0.9992, dtype=torch.float64)
5 gae_duplicate tensor(-1.3885, dtype=torch.float64) tensor(14.2728, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0158, dtype=torch.float64) delta_t tensor(-1.4667, dtype=torch.float64)
4 gae_duplicate tensor(-1.9944, dtype=torch.float64) tensor(16.7247, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6451, dtype=torch.float64) delta_t tensor(-0.8753, dtype=torch.float64)
3 gae_duplicate tensor(-1.2465, dtype=torch.float64) tensor(14.7368, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5079, dtype=torch.float64) delta_t tensor(-0.9370, dtype=torch.float64)
2 gae_duplicate tensor(-1.3655, dtype=torch.float64) tensor(12.8389, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-818.6512451171875
value loss:85.6739501953125
entropies:217.904541015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.621938943862915 seconds
19 rew tensor(0.8345, dtype=torch.float64) delta_t tensor(0.4808, dtype=torch.float64)
19 gae_duplicate tensor(0.3042, dtype=torch.float64) tensor(-5.7653, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8355, dtype=torch.float64) delta_t tensor(0.1639, dtype=torch.float64)
18 gae_duplicate tensor(0.1228, dtype=torch.float64) tensor(-2.7231, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8364, dtype=torch.float64) delta_t tensor(0.2659, dtype=torch.float64)
17 gae_duplicate tensor(0.1427, dtype=torch.float64) tensor(-3.4062, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8373, dtype=torch.float64) delta_t tensor(0.4728, dtype=torch.float64)
16 gae_duplicate tensor(0.2717, dtype=torch.float64) tensor(-6.2613, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8383, dtype=torch.float64) delta_t tensor(0.5818, dtype=torch.float64)
15 gae_duplicate tensor(0.4537, dtype=torch.float64) tensor(-7.2322, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8392, dtype=torch.float64) delta_t tensor(0.5432, dtype=torch.float64)
14 gae_duplicate tensor(0.4547, dtype=torch.float64) tensor(-7.7252, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8402, dtype=torch.float64) delta_t tensor(0.5485, dtype=torch.float64)
13 gae_duplicate tensor(0.4558, dtype=torch.float64) tensor(-6.5352, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8411, dtype=torch.float64) delta_t tensor(0.5833, dtype=torch.float64)
12 gae_duplicate tensor(0.4568, dtype=torch.float64) tensor(-7.7084, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8421, dtype=torch.float64) delta_t tensor(0.5907, dtype=torch.float64)
11 gae_duplicate tensor(0.4841, dtype=torch.float64) tensor(-8.3844, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8431, dtype=torch.float64) delta_t tensor(0.2761, dtype=torch.float64)
10 gae_duplicate tensor(0.1480, dtype=torch.float64) tensor(-4.5833, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4485, dtype=torch.float64) delta_t tensor(-0.0339, dtype=torch.float64)
9 gae_duplicate tensor(-0.3530, dtype=torch.float64) tensor(-0.0076, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2000, dtype=torch.float64) delta_t tensor(0.1733, dtype=torch.float64)
8 gae_duplicate tensor(-0.0123, dtype=torch.float64) tensor(-1.8414, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1003, dtype=torch.float64) delta_t tensor(-0.4255, dtype=torch.float64)
7 gae_duplicate tensor(-0.6669, dtype=torch.float64) tensor(4.3398, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0614, dtype=torch.float64) delta_t tensor(-0.4004, dtype=torch.float64)
6 gae_duplicate tensor(-0.9795, dtype=torch.float64) tensor(5.9067, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3225, dtype=torch.float64) delta_t tensor(-0.7613, dtype=torch.float64)
5 gae_duplicate tensor(-1.4629, dtype=torch.float64) tensor(10.7306, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8242, dtype=torch.float64) delta_t tensor(-1.1471, dtype=torch.float64)
4 gae_duplicate tensor(-1.8217, dtype=torch.float64) tensor(15.6627, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5290, dtype=torch.float64) delta_t tensor(-0.7688, dtype=torch.float64)
3 gae_duplicate tensor(-1.2896, dtype=torch.float64) tensor(11.0556, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2729, dtype=torch.float64) delta_t tensor(-0.7149, dtype=torch.float64)
2 gae_duplicate tensor(-1.2710, dtype=torch.float64) tensor(10.1583, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:116.34080505371094
value loss:70.25438690185547
entropies:217.6527557373047
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8472900390625 seconds
19 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.3517, dtype=torch.float64)
19 gae_duplicate tensor(0.0748, dtype=torch.float64) tensor(-3.7948, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8044, dtype=torch.float64) delta_t tensor(0.2711, dtype=torch.float64)
18 gae_duplicate tensor(0.0405, dtype=torch.float64) tensor(-3.6575, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7735, dtype=torch.float64) delta_t tensor(0.3128, dtype=torch.float64)
17 gae_duplicate tensor(-0.1538, dtype=torch.float64) tensor(-4.1387, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6898, dtype=torch.float64) delta_t tensor(0.2187, dtype=torch.float64)
16 gae_duplicate tensor(-0.6260, dtype=torch.float64) tensor(-2.9223, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5744, dtype=torch.float64) delta_t tensor(0.2364, dtype=torch.float64)
15 gae_duplicate tensor(-1.1301, dtype=torch.float64) tensor(-3.1054, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8389, dtype=torch.float64) delta_t tensor(0.4670, dtype=torch.float64)
14 gae_duplicate tensor(0.3776, dtype=torch.float64) tensor(-5.5922, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8399, dtype=torch.float64) delta_t tensor(0.5055, dtype=torch.float64)
13 gae_duplicate tensor(0.4819, dtype=torch.float64) tensor(-5.9652, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8408, dtype=torch.float64) delta_t tensor(0.5324, dtype=torch.float64)
12 gae_duplicate tensor(0.5212, dtype=torch.float64) tensor(-6.9563, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8417, dtype=torch.float64) delta_t tensor(0.5588, dtype=torch.float64)
11 gae_duplicate tensor(0.5482, dtype=torch.float64) tensor(-7.8187, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6317, dtype=torch.float64) delta_t tensor(0.0584, dtype=torch.float64)
10 gae_duplicate tensor(-0.9689, dtype=torch.float64) tensor(-0.7991, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4791, dtype=torch.float64) delta_t tensor(-0.0562, dtype=torch.float64)
9 gae_duplicate tensor(-0.2083, dtype=torch.float64) tensor(0.4645, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2311, dtype=torch.float64) delta_t tensor(0.0743, dtype=torch.float64)
8 gae_duplicate tensor(-0.1556, dtype=torch.float64) tensor(-0.9440, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1151, dtype=torch.float64) delta_t tensor(-0.6147, dtype=torch.float64)
7 gae_duplicate tensor(-0.7290, dtype=torch.float64) tensor(7.5258, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8135, dtype=torch.float64) delta_t tensor(-0.1505, dtype=torch.float64)
6 gae_duplicate tensor(-0.3721, dtype=torch.float64) tensor(2.5024, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2319, dtype=torch.float64) delta_t tensor(-0.6734, dtype=torch.float64)
5 gae_duplicate tensor(-1.0067, dtype=torch.float64) tensor(8.4286, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8371, dtype=torch.float64) delta_t tensor(-1.1237, dtype=torch.float64)
4 gae_duplicate tensor(-1.7874, dtype=torch.float64) tensor(13.2443, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5717, dtype=torch.float64) delta_t tensor(-0.8122, dtype=torch.float64)
3 gae_duplicate tensor(-1.6518, dtype=torch.float64) tensor(10.3142, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2604, dtype=torch.float64) delta_t tensor(-0.5288, dtype=torch.float64)
2 gae_duplicate tensor(-1.1192, dtype=torch.float64) tensor(7.0710, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-178.0087890625
value loss:61.510154724121094
entropies:217.62278747558594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.98828125 seconds
19 rew tensor(0.8347, dtype=torch.float64) delta_t tensor(0.3487, dtype=torch.float64)
19 gae_duplicate tensor(0.0899, dtype=torch.float64) tensor(-4.0051, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8356, dtype=torch.float64) delta_t tensor(0.1784, dtype=torch.float64)
18 gae_duplicate tensor(0.0489, dtype=torch.float64) tensor(-2.3246, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8365, dtype=torch.float64) delta_t tensor(0.2613, dtype=torch.float64)
17 gae_duplicate tensor(0.0630, dtype=torch.float64) tensor(-4.0176, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8374, dtype=torch.float64) delta_t tensor(0.2767, dtype=torch.float64)
16 gae_duplicate tensor(0.1209, dtype=torch.float64) tensor(-3.4251, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8383, dtype=torch.float64) delta_t tensor(0.4593, dtype=torch.float64)
15 gae_duplicate tensor(0.3778, dtype=torch.float64) tensor(-6.0497, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8392, dtype=torch.float64) delta_t tensor(0.4475, dtype=torch.float64)
14 gae_duplicate tensor(0.3788, dtype=torch.float64) tensor(-6.6000, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8401, dtype=torch.float64) delta_t tensor(0.4499, dtype=torch.float64)
13 gae_duplicate tensor(0.3793, dtype=torch.float64) tensor(-5.9113, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8410, dtype=torch.float64) delta_t tensor(0.4641, dtype=torch.float64)
12 gae_duplicate tensor(0.3873, dtype=torch.float64) tensor(-5.7942, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8419, dtype=torch.float64) delta_t tensor(0.4909, dtype=torch.float64)
11 gae_duplicate tensor(0.4176, dtype=torch.float64) tensor(-6.7505, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8053, dtype=torch.float64) delta_t tensor(0.1225, dtype=torch.float64)
10 gae_duplicate tensor(-0.0999, dtype=torch.float64) tensor(-2.2611, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4799, dtype=torch.float64) delta_t tensor(-0.1444, dtype=torch.float64)
9 gae_duplicate tensor(-0.2938, dtype=torch.float64) tensor(1.7390, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2031, dtype=torch.float64) delta_t tensor(0.3325, dtype=torch.float64)
8 gae_duplicate tensor(0.1445, dtype=torch.float64) tensor(-4.4277, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3414, dtype=torch.float64) delta_t tensor(-0.6891, dtype=torch.float64)
7 gae_duplicate tensor(-1.4543, dtype=torch.float64) tensor(7.7537, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1539, dtype=torch.float64) delta_t tensor(-0.5282, dtype=torch.float64)
6 gae_duplicate tensor(-1.2211, dtype=torch.float64) tensor(6.3092, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4540, dtype=torch.float64) delta_t tensor(-0.7753, dtype=torch.float64)
5 gae_duplicate tensor(-1.1880, dtype=torch.float64) tensor(10.1334, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1061, dtype=torch.float64) delta_t tensor(-1.4405, dtype=torch.float64)
4 gae_duplicate tensor(-2.0183, dtype=torch.float64) tensor(18.6107, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5455, dtype=torch.float64) delta_t tensor(-0.6763, dtype=torch.float64)
3 gae_duplicate tensor(-1.1915, dtype=torch.float64) tensor(9.3186, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4891, dtype=torch.float64) delta_t tensor(-0.8638, dtype=torch.float64)
2 gae_duplicate tensor(-1.5315, dtype=torch.float64) tensor(10.9177, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-514.9201049804688
value loss:74.06858825683594
entropies:217.58726501464844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2450.9971)
ToM Target loss= tensor(1807.1530)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.026073217391968 seconds
19 rew tensor(0.8240, dtype=torch.float64) delta_t tensor(0.2151, dtype=torch.float64)
19 gae_duplicate tensor(0.0262, dtype=torch.float64) tensor(-2.6805, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8248, dtype=torch.float64) delta_t tensor(0.1721, dtype=torch.float64)
18 gae_duplicate tensor(0.0684, dtype=torch.float64) tensor(-2.1056, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.2638, dtype=torch.float64)
17 gae_duplicate tensor(0.1182, dtype=torch.float64) tensor(-3.4958, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7842, dtype=torch.float64) delta_t tensor(0.2718, dtype=torch.float64)
16 gae_duplicate tensor(0.0382, dtype=torch.float64) tensor(-3.9287, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7426, dtype=torch.float64) delta_t tensor(0.3826, dtype=torch.float64)
15 gae_duplicate tensor(-0.0329, dtype=torch.float64) tensor(-5.1619, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8385, dtype=torch.float64) delta_t tensor(0.4579, dtype=torch.float64)
14 gae_duplicate tensor(0.3729, dtype=torch.float64) tensor(-5.9561, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8394, dtype=torch.float64) delta_t tensor(0.4344, dtype=torch.float64)
13 gae_duplicate tensor(0.4052, dtype=torch.float64) tensor(-5.7157, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8403, dtype=torch.float64) delta_t tensor(0.4543, dtype=torch.float64)
12 gae_duplicate tensor(0.3917, dtype=torch.float64) tensor(-5.3819, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8412, dtype=torch.float64) delta_t tensor(0.5618, dtype=torch.float64)
11 gae_duplicate tensor(0.5308, dtype=torch.float64) tensor(-7.5726, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8421, dtype=torch.float64) delta_t tensor(0.3076, dtype=torch.float64)
10 gae_duplicate tensor(0.1010, dtype=torch.float64) tensor(-4.2538, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5005, dtype=torch.float64) delta_t tensor(-0.0569, dtype=torch.float64)
9 gae_duplicate tensor(-0.2552, dtype=torch.float64) tensor(0.3282, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1343, dtype=torch.float64) delta_t tensor(0.1912, dtype=torch.float64)
8 gae_duplicate tensor(-0.4272, dtype=torch.float64) tensor(-2.1858, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2605, dtype=torch.float64) delta_t tensor(-0.5775, dtype=torch.float64)
7 gae_duplicate tensor(-1.0730, dtype=torch.float64) tensor(6.9199, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1569, dtype=torch.float64) delta_t tensor(-0.4893, dtype=torch.float64)
6 gae_duplicate tensor(-1.1662, dtype=torch.float64) tensor(5.7820, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3867, dtype=torch.float64) delta_t tensor(-0.7768, dtype=torch.float64)
5 gae_duplicate tensor(-1.2157, dtype=torch.float64) tensor(10.0937, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8462, dtype=torch.float64) delta_t tensor(-1.1337, dtype=torch.float64)
4 gae_duplicate tensor(-1.5583, dtype=torch.float64) tensor(15.2374, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6985, dtype=torch.float64) delta_t tensor(-0.8384, dtype=torch.float64)
3 gae_duplicate tensor(-1.4355, dtype=torch.float64) tensor(12.3249, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2301, dtype=torch.float64) delta_t tensor(-0.7097, dtype=torch.float64)
2 gae_duplicate tensor(-1.1478, dtype=torch.float64) tensor(9.7857, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-472.33197021484375
value loss:65.19354248046875
entropies:217.37657165527344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.207535743713379 seconds
19 rew tensor(0.8245, dtype=torch.float64) delta_t tensor(0.4491, dtype=torch.float64)
19 gae_duplicate tensor(0.2289, dtype=torch.float64) tensor(-4.9444, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.1348, dtype=torch.float64)
18 gae_duplicate tensor(0.0289, dtype=torch.float64) tensor(-2.2164, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8053, dtype=torch.float64) delta_t tensor(0.3393, dtype=torch.float64)
17 gae_duplicate tensor(0.1308, dtype=torch.float64) tensor(-4.3533, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7749, dtype=torch.float64) delta_t tensor(0.4647, dtype=torch.float64)
16 gae_duplicate tensor(0.2176, dtype=torch.float64) tensor(-6.8652, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7028, dtype=torch.float64) delta_t tensor(0.2561, dtype=torch.float64)
15 gae_duplicate tensor(-0.6461, dtype=torch.float64) tensor(-4.1757, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5788, dtype=torch.float64) delta_t tensor(0.1686, dtype=torch.float64)
14 gae_duplicate tensor(-1.2249, dtype=torch.float64) tensor(-1.2888, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8392, dtype=torch.float64) delta_t tensor(0.4019, dtype=torch.float64)
13 gae_duplicate tensor(0.2537, dtype=torch.float64) tensor(-4.9309, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8401, dtype=torch.float64) delta_t tensor(0.4677, dtype=torch.float64)
12 gae_duplicate tensor(0.3805, dtype=torch.float64) tensor(-5.8305, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7881, dtype=torch.float64) delta_t tensor(0.4355, dtype=torch.float64)
11 gae_duplicate tensor(0.2981, dtype=torch.float64) tensor(-5.4042, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6734, dtype=torch.float64) delta_t tensor(0.0856, dtype=torch.float64)
10 gae_duplicate tensor(-0.2875, dtype=torch.float64) tensor(-1.3200, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0120, dtype=torch.float64) delta_t tensor(-0.6339, dtype=torch.float64)
9 gae_duplicate tensor(-2.6771, dtype=torch.float64) tensor(6.5460, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2185, dtype=torch.float64) delta_t tensor(-0.3417, dtype=torch.float64)
8 gae_duplicate tensor(-3.0158, dtype=torch.float64) tensor(3.9999, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2060, dtype=torch.float64) delta_t tensor(-0.4462, dtype=torch.float64)
7 gae_duplicate tensor(-1.6746, dtype=torch.float64) tensor(6.9814, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1101, dtype=torch.float64) delta_t tensor(-0.5733, dtype=torch.float64)
6 gae_duplicate tensor(-2.0018, dtype=torch.float64) tensor(7.0030, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6847, dtype=torch.float64) delta_t tensor(-1.1640, dtype=torch.float64)
5 gae_duplicate tensor(-2.9787, dtype=torch.float64) tensor(17.0554, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1767, dtype=torch.float64) delta_t tensor(-1.5583, dtype=torch.float64)
4 gae_duplicate tensor(-3.8742, dtype=torch.float64) tensor(22.5337, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5036, dtype=torch.float64) delta_t tensor(-0.7741, dtype=torch.float64)
3 gae_duplicate tensor(-1.1850, dtype=torch.float64) tensor(12.3545, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3107, dtype=torch.float64) delta_t tensor(-0.7862, dtype=torch.float64)
2 gae_duplicate tensor(-1.1690, dtype=torch.float64) tensor(10.0390, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1665.71875
value loss:131.7960205078125
entropies:217.28955078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.543351888656616 seconds
19 rew tensor(0.8212, dtype=torch.float64) delta_t tensor(0.3585, dtype=torch.float64)
19 gae_duplicate tensor(-0.0175, dtype=torch.float64) tensor(-3.9458, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8119, dtype=torch.float64) delta_t tensor(0.0401, dtype=torch.float64)
18 gae_duplicate tensor(-0.0002, dtype=torch.float64) tensor(-0.9208, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8026, dtype=torch.float64) delta_t tensor(0.2332, dtype=torch.float64)
17 gae_duplicate tensor(0.0887, dtype=torch.float64) tensor(-2.5519, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7730, dtype=torch.float64) delta_t tensor(0.1891, dtype=torch.float64)
16 gae_duplicate tensor(0.0857, dtype=torch.float64) tensor(-2.8743, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7030, dtype=torch.float64) delta_t tensor(0.2431, dtype=torch.float64)
15 gae_duplicate tensor(-0.6104, dtype=torch.float64) tensor(-3.3917, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5825, dtype=torch.float64) delta_t tensor(0.1499, dtype=torch.float64)
14 gae_duplicate tensor(-1.1724, dtype=torch.float64) tensor(-2.1269, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8355, dtype=torch.float64) delta_t tensor(0.4004, dtype=torch.float64)
13 gae_duplicate tensor(0.2648, dtype=torch.float64) tensor(-5.6292, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8364, dtype=torch.float64) delta_t tensor(0.4161, dtype=torch.float64)
12 gae_duplicate tensor(0.3618, dtype=torch.float64) tensor(-6.3668, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7845, dtype=torch.float64) delta_t tensor(0.3744, dtype=torch.float64)
11 gae_duplicate tensor(0.3555, dtype=torch.float64) tensor(-5.4243, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7336, dtype=torch.float64) delta_t tensor(0.0356, dtype=torch.float64)
10 gae_duplicate tensor(-0.1784, dtype=torch.float64) tensor(-1.2042, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1159, dtype=torch.float64) delta_t tensor(-0.5440, dtype=torch.float64)
9 gae_duplicate tensor(-2.6004, dtype=torch.float64) tensor(5.8271, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1655, dtype=torch.float64) delta_t tensor(-0.2401, dtype=torch.float64)
8 gae_duplicate tensor(-2.7204, dtype=torch.float64) tensor(3.3447, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1234, dtype=torch.float64) delta_t tensor(-0.5777, dtype=torch.float64)
7 gae_duplicate tensor(-1.3404, dtype=torch.float64) tensor(6.4329, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.5022, dtype=torch.float64) delta_t tensor(-0.9390, dtype=torch.float64)
6 gae_duplicate tensor(-4.2672, dtype=torch.float64) tensor(11.4758, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0751, dtype=torch.float64) delta_t tensor(-1.5106, dtype=torch.float64)
5 gae_duplicate tensor(-5.6540, dtype=torch.float64) tensor(21.3147, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7262, dtype=torch.float64) delta_t tensor(-2.0813, dtype=torch.float64)
4 gae_duplicate tensor(-6.7058, dtype=torch.float64) tensor(30.6978, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4347, dtype=torch.float64) delta_t tensor(-0.6707, dtype=torch.float64)
3 gae_duplicate tensor(-1.3387, dtype=torch.float64) tensor(9.4615, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2543, dtype=torch.float64) delta_t tensor(-0.7927, dtype=torch.float64)
2 gae_duplicate tensor(-1.3400, dtype=torch.float64) tensor(9.9729, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2346.376708984375
value loss:222.18426513671875
entropies:217.15684509277344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.988487958908081 seconds
19 rew tensor(0.8221, dtype=torch.float64) delta_t tensor(0.2966, dtype=torch.float64)
19 gae_duplicate tensor(-0.0039, dtype=torch.float64) tensor(-3.6351, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8020, dtype=torch.float64) delta_t tensor(0.0924, dtype=torch.float64)
18 gae_duplicate tensor(-0.0463, dtype=torch.float64) tensor(-1.5009, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7923, dtype=torch.float64) delta_t tensor(0.2152, dtype=torch.float64)
17 gae_duplicate tensor(0.0371, dtype=torch.float64) tensor(-2.8717, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7513, dtype=torch.float64) delta_t tensor(0.2066, dtype=torch.float64)
16 gae_duplicate tensor(-0.1608, dtype=torch.float64) tensor(-2.7170, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6685, dtype=torch.float64) delta_t tensor(0.2400, dtype=torch.float64)
15 gae_duplicate tensor(-0.4542, dtype=torch.float64) tensor(-2.8115, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8256, dtype=torch.float64) delta_t tensor(0.4145, dtype=torch.float64)
14 gae_duplicate tensor(0.3374, dtype=torch.float64) tensor(-5.0740, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8368, dtype=torch.float64) delta_t tensor(0.4769, dtype=torch.float64)
13 gae_duplicate tensor(0.3499, dtype=torch.float64) tensor(-6.0134, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8376, dtype=torch.float64) delta_t tensor(0.5249, dtype=torch.float64)
12 gae_duplicate tensor(0.3528, dtype=torch.float64) tensor(-7.0466, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7238, dtype=torch.float64) delta_t tensor(0.5482, dtype=torch.float64)
11 gae_duplicate tensor(0.4985, dtype=torch.float64) tensor(-7.0462, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6561, dtype=torch.float64) delta_t tensor(0.1310, dtype=torch.float64)
10 gae_duplicate tensor(-0.3112, dtype=torch.float64) tensor(-1.9099, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2487, dtype=torch.float64) delta_t tensor(-0.3188, dtype=torch.float64)
9 gae_duplicate tensor(-0.8394, dtype=torch.float64) tensor(3.3148, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1877, dtype=torch.float64) delta_t tensor(0.0112, dtype=torch.float64)
8 gae_duplicate tensor(-0.5087, dtype=torch.float64) tensor(0.3622, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2497, dtype=torch.float64) delta_t tensor(-0.5693, dtype=torch.float64)
7 gae_duplicate tensor(-1.3818, dtype=torch.float64) tensor(6.8639, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8497, dtype=torch.float64) delta_t tensor(-0.1528, dtype=torch.float64)
6 gae_duplicate tensor(-1.0778, dtype=torch.float64) tensor(3.1692, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1897, dtype=torch.float64) delta_t tensor(-0.4729, dtype=torch.float64)
5 gae_duplicate tensor(-0.9045, dtype=torch.float64) tensor(5.9349, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6166, dtype=torch.float64) delta_t tensor(-0.7542, dtype=torch.float64)
4 gae_duplicate tensor(-1.1094, dtype=torch.float64) tensor(10.4209, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5802, dtype=torch.float64) delta_t tensor(-0.6058, dtype=torch.float64)
3 gae_duplicate tensor(-1.3289, dtype=torch.float64) tensor(8.0844, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9772, dtype=torch.float64) delta_t tensor(-0.3516, dtype=torch.float64)
2 gae_duplicate tensor(-0.9401, dtype=torch.float64) tensor(5.4293, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-145.31088256835938
value loss:46.55119705200195
entropies:216.65716552734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.481812953948975 seconds
19 rew tensor(0.8236, dtype=torch.float64) delta_t tensor(0.3080, dtype=torch.float64)
19 gae_duplicate tensor(-0.0940, dtype=torch.float64) tensor(-3.2090, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8040, dtype=torch.float64) delta_t tensor(0.1593, dtype=torch.float64)
18 gae_duplicate tensor(-0.0914, dtype=torch.float64) tensor(-2.8915, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7640, dtype=torch.float64) delta_t tensor(0.1093, dtype=torch.float64)
17 gae_duplicate tensor(-0.3355, dtype=torch.float64) tensor(-1.5743, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7138, dtype=torch.float64) delta_t tensor(0.1821, dtype=torch.float64)
16 gae_duplicate tensor(-0.6248, dtype=torch.float64) tensor(-2.1148, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6027, dtype=torch.float64) delta_t tensor(0.2063, dtype=torch.float64)
15 gae_duplicate tensor(-1.1454, dtype=torch.float64) tensor(-2.6626, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8370, dtype=torch.float64) delta_t tensor(0.3462, dtype=torch.float64)
14 gae_duplicate tensor(0.1865, dtype=torch.float64) tensor(-4.7307, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8378, dtype=torch.float64) delta_t tensor(0.4025, dtype=torch.float64)
13 gae_duplicate tensor(0.2976, dtype=torch.float64) tensor(-5.8077, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8285, dtype=torch.float64) delta_t tensor(0.4172, dtype=torch.float64)
12 gae_duplicate tensor(0.2867, dtype=torch.float64) tensor(-5.3633, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6537, dtype=torch.float64) delta_t tensor(0.3625, dtype=torch.float64)
11 gae_duplicate tensor(-0.1056, dtype=torch.float64) tensor(-5.5151, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5483, dtype=torch.float64) delta_t tensor(0.0145, dtype=torch.float64)
10 gae_duplicate tensor(-0.2476, dtype=torch.float64) tensor(-0.4756, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2897, dtype=torch.float64) delta_t tensor(-0.4186, dtype=torch.float64)
9 gae_duplicate tensor(-1.1082, dtype=torch.float64) tensor(5.2362, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1255, dtype=torch.float64) delta_t tensor(-0.2146, dtype=torch.float64)
8 gae_duplicate tensor(-1.2169, dtype=torch.float64) tensor(2.6758, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0308, dtype=torch.float64) delta_t tensor(-0.2631, dtype=torch.float64)
7 gae_duplicate tensor(-0.8479, dtype=torch.float64) tensor(2.4921, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8727, dtype=torch.float64) delta_t tensor(-0.0365, dtype=torch.float64)
6 gae_duplicate tensor(-0.5424, dtype=torch.float64) tensor(0.6680, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4115, dtype=torch.float64) delta_t tensor(-0.7696, dtype=torch.float64)
5 gae_duplicate tensor(-1.7473, dtype=torch.float64) tensor(9.5893, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8417, dtype=torch.float64) delta_t tensor(-1.0359, dtype=torch.float64)
4 gae_duplicate tensor(-1.5063, dtype=torch.float64) tensor(13.8719, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6115, dtype=torch.float64) delta_t tensor(-0.5704, dtype=torch.float64)
3 gae_duplicate tensor(-1.0837, dtype=torch.float64) tensor(8.6118, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5393, dtype=torch.float64) delta_t tensor(-0.6714, dtype=torch.float64)
2 gae_duplicate tensor(-1.2160, dtype=torch.float64) tensor(7.7889, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-636.1463623046875
value loss:59.01881790161133
entropies:216.25735473632812
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2461.0339)
ToM Target loss= tensor(1807.2808)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.974660873413086 seconds
19 rew tensor(0.8235, dtype=torch.float64) delta_t tensor(0.2643, dtype=torch.float64)
19 gae_duplicate tensor(0.1646, dtype=torch.float64) tensor(-3.1776, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.1358, dtype=torch.float64)
18 gae_duplicate tensor(-0.0967, dtype=torch.float64) tensor(-1.8572, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8042, dtype=torch.float64) delta_t tensor(0.3260, dtype=torch.float64)
17 gae_duplicate tensor(-0.0191, dtype=torch.float64) tensor(-4.1073, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7738, dtype=torch.float64) delta_t tensor(0.1857, dtype=torch.float64)
16 gae_duplicate tensor(0.0363, dtype=torch.float64) tensor(-3.1395, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6916, dtype=torch.float64) delta_t tensor(0.1980, dtype=torch.float64)
15 gae_duplicate tensor(-0.7383, dtype=torch.float64) tensor(-2.1790, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5679, dtype=torch.float64) delta_t tensor(0.1438, dtype=torch.float64)
14 gae_duplicate tensor(-1.3210, dtype=torch.float64) tensor(-1.6139, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8378, dtype=torch.float64) delta_t tensor(0.3814, dtype=torch.float64)
13 gae_duplicate tensor(0.2150, dtype=torch.float64) tensor(-5.6348, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8386, dtype=torch.float64) delta_t tensor(0.3738, dtype=torch.float64)
12 gae_duplicate tensor(0.2741, dtype=torch.float64) tensor(-4.9241, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7965, dtype=torch.float64) delta_t tensor(0.3764, dtype=torch.float64)
11 gae_duplicate tensor(0.2847, dtype=torch.float64) tensor(-5.0433, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7341, dtype=torch.float64) delta_t tensor(0.0275, dtype=torch.float64)
10 gae_duplicate tensor(-0.2388, dtype=torch.float64) tensor(-1.1075, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0232, dtype=torch.float64) delta_t tensor(-0.7312, dtype=torch.float64)
9 gae_duplicate tensor(-2.7031, dtype=torch.float64) tensor(8.0351, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2110, dtype=torch.float64) delta_t tensor(-0.1877, dtype=torch.float64)
8 gae_duplicate tensor(-0.7883, dtype=torch.float64) tensor(3.1050, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0044, dtype=torch.float64) delta_t tensor(-0.4365, dtype=torch.float64)
7 gae_duplicate tensor(-0.7405, dtype=torch.float64) tensor(6.0231, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0861, dtype=torch.float64) delta_t tensor(-0.5599, dtype=torch.float64)
6 gae_duplicate tensor(-3.2253, dtype=torch.float64) tensor(6.2269, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5051, dtype=torch.float64) delta_t tensor(-0.8184, dtype=torch.float64)
5 gae_duplicate tensor(-3.1129, dtype=torch.float64) tensor(9.8366, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9705, dtype=torch.float64) delta_t tensor(-1.2515, dtype=torch.float64)
4 gae_duplicate tensor(-2.5702, dtype=torch.float64) tensor(17.7940, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3216, dtype=torch.float64) delta_t tensor(-0.4488, dtype=torch.float64)
3 gae_duplicate tensor(-1.0335, dtype=torch.float64) tensor(7.5368, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2862, dtype=torch.float64) delta_t tensor(-0.6936, dtype=torch.float64)
2 gae_duplicate tensor(-1.4215, dtype=torch.float64) tensor(9.2988, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1301.4625244140625
value loss:98.96134948730469
entropies:215.96900939941406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.383500099182129 seconds
19 rew tensor(0.8342, dtype=torch.float64) delta_t tensor(0.3840, dtype=torch.float64)
19 gae_duplicate tensor(0.1948, dtype=torch.float64) tensor(-4.6500, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8349, dtype=torch.float64) delta_t tensor(0.0162, dtype=torch.float64)
18 gae_duplicate tensor(0.0095, dtype=torch.float64) tensor(-0.6480, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8357, dtype=torch.float64) delta_t tensor(0.1455, dtype=torch.float64)
17 gae_duplicate tensor(0.0437, dtype=torch.float64) tensor(-1.7230, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8365, dtype=torch.float64) delta_t tensor(0.1093, dtype=torch.float64)
16 gae_duplicate tensor(0.0481, dtype=torch.float64) tensor(-1.3979, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8372, dtype=torch.float64) delta_t tensor(0.3198, dtype=torch.float64)
15 gae_duplicate tensor(0.2818, dtype=torch.float64) tensor(-3.9533, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8380, dtype=torch.float64) delta_t tensor(0.2958, dtype=torch.float64)
14 gae_duplicate tensor(0.2576, dtype=torch.float64) tensor(-3.3858, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8387, dtype=torch.float64) delta_t tensor(0.2908, dtype=torch.float64)
13 gae_duplicate tensor(0.2748, dtype=torch.float64) tensor(-4.4888, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8395, dtype=torch.float64) delta_t tensor(0.3612, dtype=torch.float64)
12 gae_duplicate tensor(0.2439, dtype=torch.float64) tensor(-5.4547, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7553, dtype=torch.float64) delta_t tensor(0.3053, dtype=torch.float64)
11 gae_duplicate tensor(0.1706, dtype=torch.float64) tensor(-3.9164, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5659, dtype=torch.float64) delta_t tensor(-0.1235, dtype=torch.float64)
10 gae_duplicate tensor(-0.4011, dtype=torch.float64) tensor(1.2642, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3725, dtype=torch.float64) delta_t tensor(-0.4139, dtype=torch.float64)
9 gae_duplicate tensor(-0.8245, dtype=torch.float64) tensor(5.8929, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0421, dtype=torch.float64) delta_t tensor(-0.1102, dtype=torch.float64)
8 gae_duplicate tensor(-1.1887, dtype=torch.float64) tensor(1.3963, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0877, dtype=torch.float64) delta_t tensor(-0.3126, dtype=torch.float64)
7 gae_duplicate tensor(-0.8214, dtype=torch.float64) tensor(3.4312, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9959, dtype=torch.float64) delta_t tensor(-0.1551, dtype=torch.float64)
6 gae_duplicate tensor(-0.4858, dtype=torch.float64) tensor(2.2980, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4458, dtype=torch.float64) delta_t tensor(-0.6578, dtype=torch.float64)
5 gae_duplicate tensor(-1.2801, dtype=torch.float64) tensor(7.8256, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8871, dtype=torch.float64) delta_t tensor(-1.0024, dtype=torch.float64)
4 gae_duplicate tensor(-1.5555, dtype=torch.float64) tensor(12.4899, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5836, dtype=torch.float64) delta_t tensor(-0.5032, dtype=torch.float64)
3 gae_duplicate tensor(-0.8500, dtype=torch.float64) tensor(7.1079, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4844, dtype=torch.float64) delta_t tensor(-0.6746, dtype=torch.float64)
2 gae_duplicate tensor(-1.2085, dtype=torch.float64) tensor(8.6464, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-785.289794921875
value loss:44.78453826904297
entropies:215.7972412109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.991379976272583 seconds
19 rew tensor(0.8341, dtype=torch.float64) delta_t tensor(0.3318, dtype=torch.float64)
19 gae_duplicate tensor(-0.0071, dtype=torch.float64) tensor(-4.5286, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8348, dtype=torch.float64) delta_t tensor(0.1116, dtype=torch.float64)
18 gae_duplicate tensor(-0.0332, dtype=torch.float64) tensor(-1.9172, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8355, dtype=torch.float64) delta_t tensor(0.1810, dtype=torch.float64)
17 gae_duplicate tensor(-0.0301, dtype=torch.float64) tensor(-2.3396, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8363, dtype=torch.float64) delta_t tensor(0.2063, dtype=torch.float64)
16 gae_duplicate tensor(-0.0040, dtype=torch.float64) tensor(-2.6622, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8370, dtype=torch.float64) delta_t tensor(0.3868, dtype=torch.float64)
15 gae_duplicate tensor(0.2426, dtype=torch.float64) tensor(-4.5481, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8378, dtype=torch.float64) delta_t tensor(0.3879, dtype=torch.float64)
14 gae_duplicate tensor(0.2433, dtype=torch.float64) tensor(-5.2814, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8385, dtype=torch.float64) delta_t tensor(0.4138, dtype=torch.float64)
13 gae_duplicate tensor(0.3068, dtype=torch.float64) tensor(-5.0806, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8393, dtype=torch.float64) delta_t tensor(0.4501, dtype=torch.float64)
12 gae_duplicate tensor(0.3075, dtype=torch.float64) tensor(-5.7776, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8400, dtype=torch.float64) delta_t tensor(0.4865, dtype=torch.float64)
11 gae_duplicate tensor(0.3083, dtype=torch.float64) tensor(-6.9112, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8408, dtype=torch.float64) delta_t tensor(0.3184, dtype=torch.float64)
10 gae_duplicate tensor(-0.0613, dtype=torch.float64) tensor(-4.1591, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4259, dtype=torch.float64) delta_t tensor(-0.1558, dtype=torch.float64)
9 gae_duplicate tensor(-0.3508, dtype=torch.float64) tensor(1.3100, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1356, dtype=torch.float64) delta_t tensor(0.2183, dtype=torch.float64)
8 gae_duplicate tensor(-0.2012, dtype=torch.float64) tensor(-2.6784, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4259, dtype=torch.float64) delta_t tensor(-0.8279, dtype=torch.float64)
7 gae_duplicate tensor(-1.5969, dtype=torch.float64) tensor(9.4297, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1190, dtype=torch.float64) delta_t tensor(-0.2573, dtype=torch.float64)
6 gae_duplicate tensor(-0.9961, dtype=torch.float64) tensor(3.9060, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3482, dtype=torch.float64) delta_t tensor(-0.5997, dtype=torch.float64)
5 gae_duplicate tensor(-0.9428, dtype=torch.float64) tensor(8.2581, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8304, dtype=torch.float64) delta_t tensor(-0.8431, dtype=torch.float64)
4 gae_duplicate tensor(-1.4038, dtype=torch.float64) tensor(10.0473, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7469, dtype=torch.float64) delta_t tensor(-0.6743, dtype=torch.float64)
3 gae_duplicate tensor(-1.1751, dtype=torch.float64) tensor(9.2804, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1108, dtype=torch.float64) delta_t tensor(-0.3900, dtype=torch.float64)
2 gae_duplicate tensor(-0.7781, dtype=torch.float64) tensor(4.8790, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-82.97893524169922
value loss:48.317527770996094
entropies:215.69091796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.011693716049194 seconds
19 rew tensor(0.8337, dtype=torch.float64) delta_t tensor(0.3872, dtype=torch.float64)
19 gae_duplicate tensor(0.2233, dtype=torch.float64) tensor(-4.7255, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8344, dtype=torch.float64) delta_t tensor(0.1415, dtype=torch.float64)
18 gae_duplicate tensor(-0.0524, dtype=torch.float64) tensor(-2.6547, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8351, dtype=torch.float64) delta_t tensor(0.2915, dtype=torch.float64)
17 gae_duplicate tensor(0.0020, dtype=torch.float64) tensor(-3.9465, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8359, dtype=torch.float64) delta_t tensor(0.3721, dtype=torch.float64)
16 gae_duplicate tensor(0.0295, dtype=torch.float64) tensor(-4.7173, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8366, dtype=torch.float64) delta_t tensor(0.4461, dtype=torch.float64)
15 gae_duplicate tensor(0.2805, dtype=torch.float64) tensor(-6.8784, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8373, dtype=torch.float64) delta_t tensor(0.4788, dtype=torch.float64)
14 gae_duplicate tensor(0.2814, dtype=torch.float64) tensor(-6.5782, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8380, dtype=torch.float64) delta_t tensor(0.3927, dtype=torch.float64)
13 gae_duplicate tensor(0.2823, dtype=torch.float64) tensor(-5.5179, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8388, dtype=torch.float64) delta_t tensor(0.4170, dtype=torch.float64)
12 gae_duplicate tensor(0.3132, dtype=torch.float64) tensor(-4.8763, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8395, dtype=torch.float64) delta_t tensor(0.4809, dtype=torch.float64)
11 gae_duplicate tensor(0.3993, dtype=torch.float64) tensor(-6.0946, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8210, dtype=torch.float64) delta_t tensor(0.2354, dtype=torch.float64)
10 gae_duplicate tensor(-0.1322, dtype=torch.float64) tensor(-3.4407, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4987, dtype=torch.float64) delta_t tensor(-0.1181, dtype=torch.float64)
9 gae_duplicate tensor(-0.2603, dtype=torch.float64) tensor(0.9323, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2927, dtype=torch.float64) delta_t tensor(0.3167, dtype=torch.float64)
8 gae_duplicate tensor(-0.1476, dtype=torch.float64) tensor(-3.3872, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1741, dtype=torch.float64) delta_t tensor(-0.8030, dtype=torch.float64)
7 gae_duplicate tensor(-1.6260, dtype=torch.float64) tensor(9.3772, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9622, dtype=torch.float64) delta_t tensor(-0.0012, dtype=torch.float64)
6 gae_duplicate tensor(-0.2069, dtype=torch.float64) tensor(1.0874, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2207, dtype=torch.float64) delta_t tensor(-0.3784, dtype=torch.float64)
5 gae_duplicate tensor(-0.6734, dtype=torch.float64) tensor(4.5737, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8867, dtype=torch.float64) delta_t tensor(-0.8719, dtype=torch.float64)
4 gae_duplicate tensor(-1.2644, dtype=torch.float64) tensor(11.4740, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6847, dtype=torch.float64) delta_t tensor(-0.5482, dtype=torch.float64)
3 gae_duplicate tensor(-0.8946, dtype=torch.float64) tensor(7.3325, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2505, dtype=torch.float64) delta_t tensor(-0.3858, dtype=torch.float64)
2 gae_duplicate tensor(-0.8179, dtype=torch.float64) tensor(4.7175, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:440.81500244140625
value loss:46.03187561035156
entropies:215.59988403320312
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0812668800354 seconds
19 rew tensor(0.8240, dtype=torch.float64) delta_t tensor(0.3668, dtype=torch.float64)
19 gae_duplicate tensor(0.1977, dtype=torch.float64) tensor(-4.4982, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8055, dtype=torch.float64) delta_t tensor(0.0350, dtype=torch.float64)
18 gae_duplicate tensor(-0.2085, dtype=torch.float64) tensor(-0.7058, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7677, dtype=torch.float64) delta_t tensor(0.1524, dtype=torch.float64)
17 gae_duplicate tensor(-0.4087, dtype=torch.float64) tensor(-1.6433, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7299, dtype=torch.float64) delta_t tensor(0.1190, dtype=torch.float64)
16 gae_duplicate tensor(-0.6804, dtype=torch.float64) tensor(-2.3590, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6249, dtype=torch.float64) delta_t tensor(0.2182, dtype=torch.float64)
15 gae_duplicate tensor(-1.0350, dtype=torch.float64) tensor(-2.4207, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8367, dtype=torch.float64) delta_t tensor(0.4074, dtype=torch.float64)
14 gae_duplicate tensor(0.1664, dtype=torch.float64) tensor(-5.1660, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8374, dtype=torch.float64) delta_t tensor(0.2867, dtype=torch.float64)
13 gae_duplicate tensor(0.2609, dtype=torch.float64) tensor(-3.5553, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8381, dtype=torch.float64) delta_t tensor(0.3019, dtype=torch.float64)
12 gae_duplicate tensor(0.2502, dtype=torch.float64) tensor(-3.8558, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8196, dtype=torch.float64) delta_t tensor(0.3666, dtype=torch.float64)
11 gae_duplicate tensor(0.1970, dtype=torch.float64) tensor(-5.3566, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8395, dtype=torch.float64) delta_t tensor(0.0791, dtype=torch.float64)
10 gae_duplicate tensor(-0.0044, dtype=torch.float64) tensor(-1.4342, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5628, dtype=torch.float64) delta_t tensor(-0.1735, dtype=torch.float64)
9 gae_duplicate tensor(-0.3844, dtype=torch.float64) tensor(1.8947, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2865, dtype=torch.float64) delta_t tensor(0.3429, dtype=torch.float64)
8 gae_duplicate tensor(0.0081, dtype=torch.float64) tensor(-4.7009, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1446, dtype=torch.float64) delta_t tensor(-0.7708, dtype=torch.float64)
7 gae_duplicate tensor(-0.9746, dtype=torch.float64) tensor(9.0975, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9604, dtype=torch.float64) delta_t tensor(0.0073, dtype=torch.float64)
6 gae_duplicate tensor(-0.7194, dtype=torch.float64) tensor(0.5888, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2574, dtype=torch.float64) delta_t tensor(-0.3617, dtype=torch.float64)
5 gae_duplicate tensor(-0.8402, dtype=torch.float64) tensor(5.4773, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9440, dtype=torch.float64) delta_t tensor(-0.8646, dtype=torch.float64)
4 gae_duplicate tensor(-1.7347, dtype=torch.float64) tensor(10.6795, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5351, dtype=torch.float64) delta_t tensor(-0.3929, dtype=torch.float64)
3 gae_duplicate tensor(-0.8012, dtype=torch.float64) tensor(5.3565, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3100, dtype=torch.float64) delta_t tensor(-0.3859, dtype=torch.float64)
2 gae_duplicate tensor(-0.9141, dtype=torch.float64) tensor(4.5482, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-108.88687896728516
value loss:39.128326416015625
entropies:215.5853271484375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2447.6865)
ToM Target loss= tensor(1807.3667)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.114465951919556 seconds
19 rew tensor(0.8331, dtype=torch.float64) delta_t tensor(0.3723, dtype=torch.float64)
19 gae_duplicate tensor(0.1835, dtype=torch.float64) tensor(-4.5522, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8338, dtype=torch.float64) delta_t tensor(-0.0173, dtype=torch.float64)
18 gae_duplicate tensor(-0.0835, dtype=torch.float64) tensor(-0.2444, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8345, dtype=torch.float64) delta_t tensor(0.1443, dtype=torch.float64)
17 gae_duplicate tensor(-0.0322, dtype=torch.float64) tensor(-1.5783, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8352, dtype=torch.float64) delta_t tensor(0.1008, dtype=torch.float64)
16 gae_duplicate tensor(-0.0118, dtype=torch.float64) tensor(-1.4864, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8359, dtype=torch.float64) delta_t tensor(0.3657, dtype=torch.float64)
15 gae_duplicate tensor(0.2442, dtype=torch.float64) tensor(-4.6090, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8366, dtype=torch.float64) delta_t tensor(0.3456, dtype=torch.float64)
14 gae_duplicate tensor(0.2450, dtype=torch.float64) tensor(-4.4656, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8373, dtype=torch.float64) delta_t tensor(0.3897, dtype=torch.float64)
13 gae_duplicate tensor(0.2458, dtype=torch.float64) tensor(-5.0306, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8380, dtype=torch.float64) delta_t tensor(0.3505, dtype=torch.float64)
12 gae_duplicate tensor(0.2465, dtype=torch.float64) tensor(-4.3374, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8387, dtype=torch.float64) delta_t tensor(0.3703, dtype=torch.float64)
11 gae_duplicate tensor(0.2716, dtype=torch.float64) tensor(-4.4893, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7985, dtype=torch.float64) delta_t tensor(0.0163, dtype=torch.float64)
10 gae_duplicate tensor(-0.1662, dtype=torch.float64) tensor(-0.9234, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5311, dtype=torch.float64) delta_t tensor(-0.1855, dtype=torch.float64)
9 gae_duplicate tensor(-0.3113, dtype=torch.float64) tensor(2.0996, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2216, dtype=torch.float64) delta_t tensor(0.1227, dtype=torch.float64)
8 gae_duplicate tensor(-0.3042, dtype=torch.float64) tensor(-1.2115, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0780, dtype=torch.float64) delta_t tensor(-0.6063, dtype=torch.float64)
7 gae_duplicate tensor(-0.8233, dtype=torch.float64) tensor(7.4754, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9754, dtype=torch.float64) delta_t tensor(-0.0058, dtype=torch.float64)
6 gae_duplicate tensor(-0.4971, dtype=torch.float64) tensor(0.7015, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3083, dtype=torch.float64) delta_t tensor(-0.4262, dtype=torch.float64)
5 gae_duplicate tensor(-1.0052, dtype=torch.float64) tensor(4.8213, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9496, dtype=torch.float64) delta_t tensor(-0.9679, dtype=torch.float64)
4 gae_duplicate tensor(-1.5735, dtype=torch.float64) tensor(11.9084, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6136, dtype=torch.float64) delta_t tensor(-0.4098, dtype=torch.float64)
3 gae_duplicate tensor(-0.8080, dtype=torch.float64) tensor(7.0337, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3576, dtype=torch.float64) delta_t tensor(-0.4298, dtype=torch.float64)
2 gae_duplicate tensor(-0.8740, dtype=torch.float64) tensor(5.0394, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-260.2468566894531
value loss:36.721649169921875
entropies:215.54736328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.769737005233765 seconds
19 rew tensor(0.8235, dtype=torch.float64) delta_t tensor(0.3287, dtype=torch.float64)
19 gae_duplicate tensor(-0.0381, dtype=torch.float64) tensor(-5.1179, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(-0.0975, dtype=torch.float64)
18 gae_duplicate tensor(-0.2192, dtype=torch.float64) tensor(0.9244, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7821, dtype=torch.float64) delta_t tensor(0.0182, dtype=torch.float64)
17 gae_duplicate tensor(-0.3570, dtype=torch.float64) tensor(0.0681, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7401, dtype=torch.float64) delta_t tensor(-0.0549, dtype=torch.float64)
16 gae_duplicate tensor(-0.5342, dtype=torch.float64) tensor(0.7353, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6554, dtype=torch.float64) delta_t tensor(0.1295, dtype=torch.float64)
15 gae_duplicate tensor(-0.9515, dtype=torch.float64) tensor(-1.7499, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8371, dtype=torch.float64) delta_t tensor(0.2902, dtype=torch.float64)
14 gae_duplicate tensor(0.1157, dtype=torch.float64) tensor(-3.6229, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8378, dtype=torch.float64) delta_t tensor(0.3112, dtype=torch.float64)
13 gae_duplicate tensor(0.2524, dtype=torch.float64) tensor(-4.2627, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8384, dtype=torch.float64) delta_t tensor(0.4973, dtype=torch.float64)
12 gae_duplicate tensor(0.2920, dtype=torch.float64) tensor(-5.8682, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7433, dtype=torch.float64) delta_t tensor(0.4711, dtype=torch.float64)
11 gae_duplicate tensor(0.2948, dtype=torch.float64) tensor(-6.6874, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5283, dtype=torch.float64) delta_t tensor(-0.1995, dtype=torch.float64)
10 gae_duplicate tensor(-0.6947, dtype=torch.float64) tensor(1.5366, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2902, dtype=torch.float64) delta_t tensor(-0.3718, dtype=torch.float64)
9 gae_duplicate tensor(-0.8730, dtype=torch.float64) tensor(4.4242, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0771, dtype=torch.float64) delta_t tensor(0.1320, dtype=torch.float64)
8 gae_duplicate tensor(-0.7191, dtype=torch.float64) tensor(-1.0808, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2362, dtype=torch.float64) delta_t tensor(-0.3876, dtype=torch.float64)
7 gae_duplicate tensor(-0.5479, dtype=torch.float64) tensor(4.7687, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1979, dtype=torch.float64) delta_t tensor(-0.3235, dtype=torch.float64)
6 gae_duplicate tensor(-1.4531, dtype=torch.float64) tensor(3.7659, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5461, dtype=torch.float64) delta_t tensor(-0.7186, dtype=torch.float64)
5 gae_duplicate tensor(-1.1074, dtype=torch.float64) tensor(8.5654, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9063, dtype=torch.float64) delta_t tensor(-0.9624, dtype=torch.float64)
4 gae_duplicate tensor(-1.5599, dtype=torch.float64) tensor(13.3186, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6921, dtype=torch.float64) delta_t tensor(-0.4886, dtype=torch.float64)
3 gae_duplicate tensor(-1.2862, dtype=torch.float64) tensor(6.6921, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3117, dtype=torch.float64) delta_t tensor(-0.5100, dtype=torch.float64)
2 gae_duplicate tensor(-0.6793, dtype=torch.float64) tensor(6.7120, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-871.1424560546875
value loss:46.89049530029297
entropies:215.4057159423828
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.862954139709473 seconds
19 rew tensor(0.8338, dtype=torch.float64) delta_t tensor(0.2122, dtype=torch.float64)
19 gae_duplicate tensor(-0.1475, dtype=torch.float64) tensor(-2.5554, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8345, dtype=torch.float64) delta_t tensor(-0.0203, dtype=torch.float64)
18 gae_duplicate tensor(-0.1284, dtype=torch.float64) tensor(-0.0160, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8352, dtype=torch.float64) delta_t tensor(0.1009, dtype=torch.float64)
17 gae_duplicate tensor(-0.0600, dtype=torch.float64) tensor(-1.2823, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8358, dtype=torch.float64) delta_t tensor(0.3585, dtype=torch.float64)
16 gae_duplicate tensor(-0.0169, dtype=torch.float64) tensor(-3.9644, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8365, dtype=torch.float64) delta_t tensor(0.2089, dtype=torch.float64)
15 gae_duplicate tensor(0.1533, dtype=torch.float64) tensor(-2.6183, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8372, dtype=torch.float64) delta_t tensor(0.2237, dtype=torch.float64)
14 gae_duplicate tensor(0.1540, dtype=torch.float64) tensor(-3.1766, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8379, dtype=torch.float64) delta_t tensor(0.2446, dtype=torch.float64)
13 gae_duplicate tensor(0.1920, dtype=torch.float64) tensor(-3.1121, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8385, dtype=torch.float64) delta_t tensor(0.2665, dtype=torch.float64)
12 gae_duplicate tensor(0.1927, dtype=torch.float64) tensor(-3.0528, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8392, dtype=torch.float64) delta_t tensor(0.3541, dtype=torch.float64)
11 gae_duplicate tensor(0.2550, dtype=torch.float64) tensor(-4.1898, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8192, dtype=torch.float64) delta_t tensor(0.0065, dtype=torch.float64)
10 gae_duplicate tensor(-0.1583, dtype=torch.float64) tensor(-0.5130, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5190, dtype=torch.float64) delta_t tensor(-0.1562, dtype=torch.float64)
9 gae_duplicate tensor(-0.3615, dtype=torch.float64) tensor(1.8284, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2397, dtype=torch.float64) delta_t tensor(0.0545, dtype=torch.float64)
8 gae_duplicate tensor(-0.4241, dtype=torch.float64) tensor(-0.1543, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1359, dtype=torch.float64) delta_t tensor(-0.7063, dtype=torch.float64)
7 gae_duplicate tensor(-1.3219, dtype=torch.float64) tensor(7.5244, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8901, dtype=torch.float64) delta_t tensor(0.1659, dtype=torch.float64)
6 gae_duplicate tensor(-0.1162, dtype=torch.float64) tensor(-0.9119, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2028, dtype=torch.float64) delta_t tensor(-0.2615, dtype=torch.float64)
5 gae_duplicate tensor(-0.5382, dtype=torch.float64) tensor(3.4775, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9333, dtype=torch.float64) delta_t tensor(-0.8431, dtype=torch.float64)
4 gae_duplicate tensor(-1.1902, dtype=torch.float64) tensor(9.0942, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6579, dtype=torch.float64) delta_t tensor(-0.3958, dtype=torch.float64)
3 gae_duplicate tensor(-0.5456, dtype=torch.float64) tensor(6.3257, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3255, dtype=torch.float64) delta_t tensor(-0.4226, dtype=torch.float64)
2 gae_duplicate tensor(-0.9815, dtype=torch.float64) tensor(5.7600, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-343.3848571777344
value loss:29.5892333984375
entropies:215.0345458984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0605809688568115 seconds
19 rew tensor(0.8233, dtype=torch.float64) delta_t tensor(0.4011, dtype=torch.float64)
19 gae_duplicate tensor(-0.0362, dtype=torch.float64) tensor(-4.2132, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.1850, dtype=torch.float64)
18 gae_duplicate tensor(-0.0328, dtype=torch.float64) tensor(-2.9555, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8037, dtype=torch.float64) delta_t tensor(0.3440, dtype=torch.float64)
17 gae_duplicate tensor(0.0648, dtype=torch.float64) tensor(-5.1090, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7730, dtype=torch.float64) delta_t tensor(0.1567, dtype=torch.float64)
16 gae_duplicate tensor(-0.0616, dtype=torch.float64) tensor(-2.0226, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6902, dtype=torch.float64) delta_t tensor(0.2127, dtype=torch.float64)
15 gae_duplicate tensor(-0.8235, dtype=torch.float64) tensor(-2.8487, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5657, dtype=torch.float64) delta_t tensor(0.1157, dtype=torch.float64)
14 gae_duplicate tensor(-1.4344, dtype=torch.float64) tensor(-1.6632, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8370, dtype=torch.float64) delta_t tensor(0.4090, dtype=torch.float64)
13 gae_duplicate tensor(0.1099, dtype=torch.float64) tensor(-4.5754, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8377, dtype=torch.float64) delta_t tensor(0.5058, dtype=torch.float64)
12 gae_duplicate tensor(0.2611, dtype=torch.float64) tensor(-6.7249, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8176, dtype=torch.float64) delta_t tensor(0.5667, dtype=torch.float64)
11 gae_duplicate tensor(0.2660, dtype=torch.float64) tensor(-7.2452, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6640, dtype=torch.float64) delta_t tensor(-0.0053, dtype=torch.float64)
10 gae_duplicate tensor(-0.4019, dtype=torch.float64) tensor(-0.9367, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2998, dtype=torch.float64) delta_t tensor(-0.9392, dtype=torch.float64)
9 gae_duplicate tensor(-4.0453, dtype=torch.float64) tensor(10.8136, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4800, dtype=torch.float64) delta_t tensor(-0.8749, dtype=torch.float64)
8 gae_duplicate tensor(-4.4904, dtype=torch.float64) tensor(9.4474, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7781, dtype=torch.float64) delta_t tensor(-1.1843, dtype=torch.float64)
7 gae_duplicate tensor(-4.7257, dtype=torch.float64) tensor(16.1582, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0577, dtype=torch.float64) delta_t tensor(-0.3526, dtype=torch.float64)
6 gae_duplicate tensor(-3.8333, dtype=torch.float64) tensor(4.3128, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5206, dtype=torch.float64) delta_t tensor(-0.5724, dtype=torch.float64)
5 gae_duplicate tensor(-3.2285, dtype=torch.float64) tensor(10.3869, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8055, dtype=torch.float64) delta_t tensor(-0.8398, dtype=torch.float64)
4 gae_duplicate tensor(-2.6111, dtype=torch.float64) tensor(10.0341, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2214, dtype=torch.float64) delta_t tensor(-0.2107, dtype=torch.float64)
3 gae_duplicate tensor(-1.0910, dtype=torch.float64) tensor(3.5023, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0522, dtype=torch.float64) delta_t tensor(-0.4417, dtype=torch.float64)
2 gae_duplicate tensor(-1.0639, dtype=torch.float64) tensor(5.2808, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1177.752685546875
value loss:184.78134155273438
entropies:214.7051239013672
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.854196786880493 seconds
19 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(0.1205, dtype=torch.float64)
19 gae_duplicate tensor(0.0169, dtype=torch.float64) tensor(-1.2628, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8031, dtype=torch.float64) delta_t tensor(-0.0429, dtype=torch.float64)
18 gae_duplicate tensor(-0.1775, dtype=torch.float64) tensor(0.3619, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7609, dtype=torch.float64) delta_t tensor(0.1046, dtype=torch.float64)
17 gae_duplicate tensor(-0.4066, dtype=torch.float64) tensor(-0.7875, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7080, dtype=torch.float64) delta_t tensor(0.0114, dtype=torch.float64)
16 gae_duplicate tensor(-0.7784, dtype=torch.float64) tensor(-0.2071, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5803, dtype=torch.float64) delta_t tensor(-0.0500, dtype=torch.float64)
15 gae_duplicate tensor(-1.3691, dtype=torch.float64) tensor(0.1524, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8372, dtype=torch.float64) delta_t tensor(0.2115, dtype=torch.float64)
14 gae_duplicate tensor(0.0890, dtype=torch.float64) tensor(-2.1643, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8379, dtype=torch.float64) delta_t tensor(0.2375, dtype=torch.float64)
13 gae_duplicate tensor(0.1983, dtype=torch.float64) tensor(-2.8171, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8279, dtype=torch.float64) delta_t tensor(0.2521, dtype=torch.float64)
12 gae_duplicate tensor(0.2082, dtype=torch.float64) tensor(-3.0188, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7217, dtype=torch.float64) delta_t tensor(0.1999, dtype=torch.float64)
11 gae_duplicate tensor(-0.2024, dtype=torch.float64) tensor(-2.7432, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7009, dtype=torch.float64) delta_t tensor(0.0286, dtype=torch.float64)
10 gae_duplicate tensor(-0.0530, dtype=torch.float64) tensor(-0.5222, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3918, dtype=torch.float64) delta_t tensor(-0.2756, dtype=torch.float64)
9 gae_duplicate tensor(-1.0264, dtype=torch.float64) tensor(3.9294, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0933, dtype=torch.float64) delta_t tensor(-0.0954, dtype=torch.float64)
8 gae_duplicate tensor(-1.3072, dtype=torch.float64) tensor(1.0022, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2990, dtype=torch.float64) delta_t tensor(-0.7050, dtype=torch.float64)
7 gae_duplicate tensor(-1.5082, dtype=torch.float64) tensor(6.8094, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8272, dtype=torch.float64) delta_t tensor(0.2130, dtype=torch.float64)
6 gae_duplicate tensor(-0.0861, dtype=torch.float64) tensor(-1.7646, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2673, dtype=torch.float64) delta_t tensor(-0.4379, dtype=torch.float64)
5 gae_duplicate tensor(-1.8127, dtype=torch.float64) tensor(4.4313, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9151, dtype=torch.float64) delta_t tensor(-0.6903, dtype=torch.float64)
4 gae_duplicate tensor(-1.4621, dtype=torch.float64) tensor(8.3792, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4605, dtype=torch.float64) delta_t tensor(-0.1996, dtype=torch.float64)
3 gae_duplicate tensor(-0.4802, dtype=torch.float64) tensor(3.9428, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1768, dtype=torch.float64) delta_t tensor(-0.3125, dtype=torch.float64)
2 gae_duplicate tensor(-1.5425, dtype=torch.float64) tensor(4.6974, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-701.4838256835938
value loss:39.7180061340332
entropies:213.4364471435547
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2432.6409)
ToM Target loss= tensor(1807.4373)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.049895286560059 seconds
19 rew tensor(0.8348, dtype=torch.float64) delta_t tensor(0.2904, dtype=torch.float64)
19 gae_duplicate tensor(-0.0733, dtype=torch.float64) tensor(-2.9898, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8354, dtype=torch.float64) delta_t tensor(0.1651, dtype=torch.float64)
18 gae_duplicate tensor(-0.0946, dtype=torch.float64) tensor(-3.5234, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8361, dtype=torch.float64) delta_t tensor(0.2695, dtype=torch.float64)
17 gae_duplicate tensor(-0.0263, dtype=torch.float64) tensor(-2.7212, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8367, dtype=torch.float64) delta_t tensor(0.3769, dtype=torch.float64)
16 gae_duplicate tensor(0.0026, dtype=torch.float64) tensor(-5.2003, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8373, dtype=torch.float64) delta_t tensor(0.4235, dtype=torch.float64)
15 gae_duplicate tensor(0.1624, dtype=torch.float64) tensor(-5.1383, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8380, dtype=torch.float64) delta_t tensor(0.3894, dtype=torch.float64)
14 gae_duplicate tensor(0.1631, dtype=torch.float64) tensor(-5.7696, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8386, dtype=torch.float64) delta_t tensor(0.4341, dtype=torch.float64)
13 gae_duplicate tensor(0.1811, dtype=torch.float64) tensor(-5.3174, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8101, dtype=torch.float64) delta_t tensor(0.4101, dtype=torch.float64)
12 gae_duplicate tensor(0.1818, dtype=torch.float64) tensor(-4.5078, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7720, dtype=torch.float64) delta_t tensor(0.4507, dtype=torch.float64)
11 gae_duplicate tensor(0.2716, dtype=torch.float64) tensor(-7.0206, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7725, dtype=torch.float64) delta_t tensor(0.2679, dtype=torch.float64)
10 gae_duplicate tensor(-0.0917, dtype=torch.float64) tensor(-4.7900, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4302, dtype=torch.float64) delta_t tensor(-0.0908, dtype=torch.float64)
9 gae_duplicate tensor(-0.4056, dtype=torch.float64) tensor(0.2059, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0288, dtype=torch.float64) delta_t tensor(-0.0751, dtype=torch.float64)
8 gae_duplicate tensor(-0.7329, dtype=torch.float64) tensor(1.6512, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3524, dtype=torch.float64) delta_t tensor(-0.7739, dtype=torch.float64)
7 gae_duplicate tensor(-1.2695, dtype=torch.float64) tensor(9.8369, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1264, dtype=torch.float64) delta_t tensor(-0.1850, dtype=torch.float64)
6 gae_duplicate tensor(-1.4994, dtype=torch.float64) tensor(3.8190, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4338, dtype=torch.float64) delta_t tensor(-0.4797, dtype=torch.float64)
5 gae_duplicate tensor(-0.9231, dtype=torch.float64) tensor(6.6032, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9085, dtype=torch.float64) delta_t tensor(-0.7576, dtype=torch.float64)
4 gae_duplicate tensor(-1.3232, dtype=torch.float64) tensor(9.3330, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8682, dtype=torch.float64) delta_t tensor(-0.5512, dtype=torch.float64)
3 gae_duplicate tensor(-1.2843, dtype=torch.float64) tensor(8.2507, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3354, dtype=torch.float64) delta_t tensor(-0.1861, dtype=torch.float64)
2 gae_duplicate tensor(-0.5681, dtype=torch.float64) tensor(3.1874, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:109.07384490966797
value loss:54.088436126708984
entropies:212.2109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.70241379737854 seconds
19 rew tensor(0.8342, dtype=torch.float64) delta_t tensor(0.1361, dtype=torch.float64)
19 gae_duplicate tensor(0.0756, dtype=torch.float64) tensor(-1.8731, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8348, dtype=torch.float64) delta_t tensor(0.0729, dtype=torch.float64)
18 gae_duplicate tensor(-0.1030, dtype=torch.float64) tensor(-1.2005, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8354, dtype=torch.float64) delta_t tensor(0.0776, dtype=torch.float64)
17 gae_duplicate tensor(-0.0330, dtype=torch.float64) tensor(-0.9934, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8361, dtype=torch.float64) delta_t tensor(0.1491, dtype=torch.float64)
16 gae_duplicate tensor(-0.0734, dtype=torch.float64) tensor(-1.3845, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8367, dtype=torch.float64) delta_t tensor(0.2088, dtype=torch.float64)
15 gae_duplicate tensor(0.1537, dtype=torch.float64) tensor(-2.3716, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8373, dtype=torch.float64) delta_t tensor(0.2073, dtype=torch.float64)
14 gae_duplicate tensor(0.1544, dtype=torch.float64) tensor(-2.8265, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8380, dtype=torch.float64) delta_t tensor(0.1974, dtype=torch.float64)
13 gae_duplicate tensor(0.1558, dtype=torch.float64) tensor(-2.1811, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8386, dtype=torch.float64) delta_t tensor(0.2094, dtype=torch.float64)
12 gae_duplicate tensor(0.1597, dtype=torch.float64) tensor(-2.6459, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8392, dtype=torch.float64) delta_t tensor(0.2325, dtype=torch.float64)
11 gae_duplicate tensor(0.2047, dtype=torch.float64) tensor(-2.5678, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8194, dtype=torch.float64) delta_t tensor(-0.0287, dtype=torch.float64)
10 gae_duplicate tensor(-0.1724, dtype=torch.float64) tensor(-0.0069, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5289, dtype=torch.float64) delta_t tensor(-0.2234, dtype=torch.float64)
9 gae_duplicate tensor(-0.5782, dtype=torch.float64) tensor(3.3305, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2591, dtype=torch.float64) delta_t tensor(0.3715, dtype=torch.float64)
8 gae_duplicate tensor(-0.4082, dtype=torch.float64) tensor(-4.6933, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1563, dtype=torch.float64) delta_t tensor(-0.5536, dtype=torch.float64)
7 gae_duplicate tensor(-1.5990, dtype=torch.float64) tensor(6.2163, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9893, dtype=torch.float64) delta_t tensor(0.1006, dtype=torch.float64)
6 gae_duplicate tensor(-0.5231, dtype=torch.float64) tensor(-0.7868, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3724, dtype=torch.float64) delta_t tensor(-0.3480, dtype=torch.float64)
5 gae_duplicate tensor(-1.0428, dtype=torch.float64) tensor(5.3175, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0159, dtype=torch.float64) delta_t tensor(-0.8887, dtype=torch.float64)
4 gae_duplicate tensor(-1.3486, dtype=torch.float64) tensor(11.4968, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7395, dtype=torch.float64) delta_t tensor(-0.5016, dtype=torch.float64)
3 gae_duplicate tensor(-1.1864, dtype=torch.float64) tensor(7.0833, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3673, dtype=torch.float64) delta_t tensor(-0.4571, dtype=torch.float64)
2 gae_duplicate tensor(-0.9929, dtype=torch.float64) tensor(6.0336, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-612.0933227539062
value loss:31.86116600036621
entropies:211.21197509765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.883779048919678 seconds
19 rew tensor(0.8340, dtype=torch.float64) delta_t tensor(0.1771, dtype=torch.float64)
19 gae_duplicate tensor(0.1264, dtype=torch.float64) tensor(-2.3254, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8346, dtype=torch.float64) delta_t tensor(-0.0569, dtype=torch.float64)
18 gae_duplicate tensor(-0.0926, dtype=torch.float64) tensor(0.4352, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8352, dtype=torch.float64) delta_t tensor(0.1052, dtype=torch.float64)
17 gae_duplicate tensor(-0.0224, dtype=torch.float64) tensor(-1.3709, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8358, dtype=torch.float64) delta_t tensor(0.1313, dtype=torch.float64)
16 gae_duplicate tensor(-0.0439, dtype=torch.float64) tensor(-1.9382, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8365, dtype=torch.float64) delta_t tensor(0.2028, dtype=torch.float64)
15 gae_duplicate tensor(0.1835, dtype=torch.float64) tensor(-2.5921, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8371, dtype=torch.float64) delta_t tensor(0.1924, dtype=torch.float64)
14 gae_duplicate tensor(0.1842, dtype=torch.float64) tensor(-2.1352, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8377, dtype=torch.float64) delta_t tensor(0.1979, dtype=torch.float64)
13 gae_duplicate tensor(0.1964, dtype=torch.float64) tensor(-2.9571, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8383, dtype=torch.float64) delta_t tensor(0.2162, dtype=torch.float64)
12 gae_duplicate tensor(0.1970, dtype=torch.float64) tensor(-2.9754, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8098, dtype=torch.float64) delta_t tensor(0.2467, dtype=torch.float64)
11 gae_duplicate tensor(0.1085, dtype=torch.float64) tensor(-3.6341, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7793, dtype=torch.float64) delta_t tensor(0.0318, dtype=torch.float64)
10 gae_duplicate tensor(-0.2794, dtype=torch.float64) tensor(-1.4026, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4886, dtype=torch.float64) delta_t tensor(-0.1347, dtype=torch.float64)
9 gae_duplicate tensor(-0.3713, dtype=torch.float64) tensor(1.3359, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2312, dtype=torch.float64) delta_t tensor(0.1593, dtype=torch.float64)
8 gae_duplicate tensor(-0.1488, dtype=torch.float64) tensor(-1.5798, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1814, dtype=torch.float64) delta_t tensor(-0.6208, dtype=torch.float64)
7 gae_duplicate tensor(-1.3219, dtype=torch.float64) tensor(8.1080, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0318, dtype=torch.float64) delta_t tensor(0.1397, dtype=torch.float64)
6 gae_duplicate tensor(-0.2298, dtype=torch.float64) tensor(-0.6701, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3713, dtype=torch.float64) delta_t tensor(-0.3105, dtype=torch.float64)
5 gae_duplicate tensor(-0.6217, dtype=torch.float64) tensor(3.9079, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9728, dtype=torch.float64) delta_t tensor(-0.8084, dtype=torch.float64)
4 gae_duplicate tensor(-1.1839, dtype=torch.float64) tensor(9.9869, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6583, dtype=torch.float64) delta_t tensor(-0.2984, dtype=torch.float64)
3 gae_duplicate tensor(-0.6507, dtype=torch.float64) tensor(4.8818, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3720, dtype=torch.float64) delta_t tensor(-0.4433, dtype=torch.float64)
2 gae_duplicate tensor(-1.1528, dtype=torch.float64) tensor(4.7990, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-393.3565673828125
value loss:24.425827026367188
entropies:210.58877563476562
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.018830060958862 seconds
19 rew tensor(0.8242, dtype=torch.float64) delta_t tensor(0.0669, dtype=torch.float64)
19 gae_duplicate tensor(-0.1680, dtype=torch.float64) tensor(-0.8067, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8039, dtype=torch.float64) delta_t tensor(0.0296, dtype=torch.float64)
18 gae_duplicate tensor(-0.2556, dtype=torch.float64) tensor(-0.5587, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7732, dtype=torch.float64) delta_t tensor(0.0748, dtype=torch.float64)
17 gae_duplicate tensor(-0.3925, dtype=torch.float64) tensor(-0.9258, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7320, dtype=torch.float64) delta_t tensor(-0.0429, dtype=torch.float64)
16 gae_duplicate tensor(-0.6859, dtype=torch.float64) tensor(0.1219, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6282, dtype=torch.float64) delta_t tensor(-0.0052, dtype=torch.float64)
15 gae_duplicate tensor(-1.0675, dtype=torch.float64) tensor(-0.6436, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8372, dtype=torch.float64) delta_t tensor(0.2066, dtype=torch.float64)
14 gae_duplicate tensor(0.1040, dtype=torch.float64) tensor(-2.6449, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8378, dtype=torch.float64) delta_t tensor(0.2171, dtype=torch.float64)
13 gae_duplicate tensor(0.1059, dtype=torch.float64) tensor(-2.5756, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8280, dtype=torch.float64) delta_t tensor(0.2363, dtype=torch.float64)
12 gae_duplicate tensor(0.1134, dtype=torch.float64) tensor(-2.8941, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7760, dtype=torch.float64) delta_t tensor(0.2779, dtype=torch.float64)
11 gae_duplicate tensor(-0.0050, dtype=torch.float64) tensor(-3.0407, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7765, dtype=torch.float64) delta_t tensor(0.1143, dtype=torch.float64)
10 gae_duplicate tensor(-0.1998, dtype=torch.float64) tensor(-1.8861, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4366, dtype=torch.float64) delta_t tensor(-0.2206, dtype=torch.float64)
9 gae_duplicate tensor(-0.3195, dtype=torch.float64) tensor(2.0933, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1368, dtype=torch.float64) delta_t tensor(0.1022, dtype=torch.float64)
8 gae_duplicate tensor(-0.4015, dtype=torch.float64) tensor(-1.1201, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3683, dtype=torch.float64) delta_t tensor(-0.7918, dtype=torch.float64)
7 gae_duplicate tensor(-1.2377, dtype=torch.float64) tensor(8.7128, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1020, dtype=torch.float64) delta_t tensor(-0.0069, dtype=torch.float64)
6 gae_duplicate tensor(-0.5280, dtype=torch.float64) tensor(1.2821, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4141, dtype=torch.float64) delta_t tensor(-0.4003, dtype=torch.float64)
5 gae_duplicate tensor(-0.8841, dtype=torch.float64) tensor(4.3476, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0365, dtype=torch.float64) delta_t tensor(-0.7411, dtype=torch.float64)
4 gae_duplicate tensor(-1.5742, dtype=torch.float64) tensor(8.9895, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7386, dtype=torch.float64) delta_t tensor(-0.3752, dtype=torch.float64)
3 gae_duplicate tensor(-0.6244, dtype=torch.float64) tensor(4.9109, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2778, dtype=torch.float64) delta_t tensor(-0.1448, dtype=torch.float64)
2 gae_duplicate tensor(-0.5920, dtype=torch.float64) tensor(2.1179, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-595.163818359375
value loss:28.87056541442871
entropies:210.5257110595703
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.636437892913818 seconds
19 rew tensor(0.8347, dtype=torch.float64) delta_t tensor(0.3900, dtype=torch.float64)
19 gae_duplicate tensor(0.0295, dtype=torch.float64) tensor(-5.0805, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8352, dtype=torch.float64) delta_t tensor(-0.0422, dtype=torch.float64)
18 gae_duplicate tensor(-0.1232, dtype=torch.float64) tensor(-0.0496, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8358, dtype=torch.float64) delta_t tensor(0.1245, dtype=torch.float64)
17 gae_duplicate tensor(-0.0216, dtype=torch.float64) tensor(-1.2814, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8364, dtype=torch.float64) delta_t tensor(0.2495, dtype=torch.float64)
16 gae_duplicate tensor(-0.0501, dtype=torch.float64) tensor(-2.5858, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8370, dtype=torch.float64) delta_t tensor(0.1796, dtype=torch.float64)
15 gae_duplicate tensor(0.0986, dtype=torch.float64) tensor(-2.3927, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8376, dtype=torch.float64) delta_t tensor(0.1843, dtype=torch.float64)
14 gae_duplicate tensor(0.0919, dtype=torch.float64) tensor(-2.4562, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8382, dtype=torch.float64) delta_t tensor(0.1815, dtype=torch.float64)
13 gae_duplicate tensor(0.0893, dtype=torch.float64) tensor(-2.8648, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8388, dtype=torch.float64) delta_t tensor(0.2335, dtype=torch.float64)
12 gae_duplicate tensor(0.0909, dtype=torch.float64) tensor(-3.0964, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8181, dtype=torch.float64) delta_t tensor(0.3479, dtype=torch.float64)
11 gae_duplicate tensor(0.1421, dtype=torch.float64) tensor(-4.9356, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7048, dtype=torch.float64) delta_t tensor(0.0540, dtype=torch.float64)
10 gae_duplicate tensor(-0.1483, dtype=torch.float64) tensor(-0.5510, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3726, dtype=torch.float64) delta_t tensor(-0.2910, dtype=torch.float64)
9 gae_duplicate tensor(-0.4547, dtype=torch.float64) tensor(3.3781, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2484, dtype=torch.float64) delta_t tensor(0.1860, dtype=torch.float64)
8 gae_duplicate tensor(-0.4281, dtype=torch.float64) tensor(-1.0516, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1129, dtype=torch.float64) delta_t tensor(-0.4808, dtype=torch.float64)
7 gae_duplicate tensor(-0.6787, dtype=torch.float64) tensor(6.2809, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0613, dtype=torch.float64) delta_t tensor(0.1083, dtype=torch.float64)
6 gae_duplicate tensor(-0.0774, dtype=torch.float64) tensor(-0.9084, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3934, dtype=torch.float64) delta_t tensor(-0.3462, dtype=torch.float64)
5 gae_duplicate tensor(-0.5527, dtype=torch.float64) tensor(3.7000, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8910, dtype=torch.float64) delta_t tensor(-0.7718, dtype=torch.float64)
4 gae_duplicate tensor(-1.0128, dtype=torch.float64) tensor(9.0994, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7175, dtype=torch.float64) delta_t tensor(-0.3209, dtype=torch.float64)
3 gae_duplicate tensor(-0.5102, dtype=torch.float64) tensor(5.2503, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4418, dtype=torch.float64) delta_t tensor(-0.2776, dtype=torch.float64)
2 gae_duplicate tensor(-0.6621, dtype=torch.float64) tensor(3.6064, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-184.0657196044922
value loss:22.625873565673828
entropies:210.32997131347656
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2422.0098)
ToM Target loss= tensor(1806.5017)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.756626129150391 seconds
19 rew tensor(0.8343, dtype=torch.float64) delta_t tensor(0.2752, dtype=torch.float64)
19 gae_duplicate tensor(-0.1740, dtype=torch.float64) tensor(-3.7667, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8349, dtype=torch.float64) delta_t tensor(0.0134, dtype=torch.float64)
18 gae_duplicate tensor(-0.0625, dtype=torch.float64) tensor(-0.2531, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8355, dtype=torch.float64) delta_t tensor(0.2293, dtype=torch.float64)
17 gae_duplicate tensor(-0.0029, dtype=torch.float64) tensor(-3.1357, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8361, dtype=torch.float64) delta_t tensor(0.0578, dtype=torch.float64)
16 gae_duplicate tensor(-0.0314, dtype=torch.float64) tensor(-0.6826, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8366, dtype=torch.float64) delta_t tensor(0.1754, dtype=torch.float64)
15 gae_duplicate tensor(0.1070, dtype=torch.float64) tensor(-1.7889, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8372, dtype=torch.float64) delta_t tensor(0.1686, dtype=torch.float64)
14 gae_duplicate tensor(0.1287, dtype=torch.float64) tensor(-2.2765, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8378, dtype=torch.float64) delta_t tensor(0.1804, dtype=torch.float64)
13 gae_duplicate tensor(0.1406, dtype=torch.float64) tensor(-2.9950, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8384, dtype=torch.float64) delta_t tensor(0.1973, dtype=torch.float64)
12 gae_duplicate tensor(0.1698, dtype=torch.float64) tensor(-2.4729, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8390, dtype=torch.float64) delta_t tensor(0.2917, dtype=torch.float64)
11 gae_duplicate tensor(0.1867, dtype=torch.float64) tensor(-3.3927, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7190, dtype=torch.float64) delta_t tensor(-0.0344, dtype=torch.float64)
10 gae_duplicate tensor(-0.1971, dtype=torch.float64) tensor(0.2634, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4618, dtype=torch.float64) delta_t tensor(-0.2315, dtype=torch.float64)
9 gae_duplicate tensor(-0.7816, dtype=torch.float64) tensor(3.0131, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2827, dtype=torch.float64) delta_t tensor(0.1344, dtype=torch.float64)
8 gae_duplicate tensor(-0.6982, dtype=torch.float64) tensor(-1.2560, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1318, dtype=torch.float64) delta_t tensor(-0.4532, dtype=torch.float64)
7 gae_duplicate tensor(-1.4829, dtype=torch.float64) tensor(3.8557, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8208, dtype=torch.float64) delta_t tensor(0.3453, dtype=torch.float64)
6 gae_duplicate tensor(-0.1717, dtype=torch.float64) tensor(-3.9372, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2448, dtype=torch.float64) delta_t tensor(-0.1136, dtype=torch.float64)
5 gae_duplicate tensor(-0.5780, dtype=torch.float64) tensor(0.3587, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8108, dtype=torch.float64) delta_t tensor(-0.5090, dtype=torch.float64)
4 gae_duplicate tensor(-0.8539, dtype=torch.float64) tensor(6.1107, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5632, dtype=torch.float64) delta_t tensor(-0.1905, dtype=torch.float64)
3 gae_duplicate tensor(-0.4090, dtype=torch.float64) tensor(3.2518, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1811, dtype=torch.float64) delta_t tensor(-0.4424, dtype=torch.float64)
2 gae_duplicate tensor(-1.0736, dtype=torch.float64) tensor(6.3808, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:60.16730499267578
value loss:26.082889556884766
entropies:210.31825256347656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7556610107421875 seconds
19 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.1189, dtype=torch.float64)
19 gae_duplicate tensor(0.0054, dtype=torch.float64) tensor(-1.4893, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8042, dtype=torch.float64) delta_t tensor(0.0019, dtype=torch.float64)
18 gae_duplicate tensor(-0.1751, dtype=torch.float64) tensor(-0.3222, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7630, dtype=torch.float64) delta_t tensor(0.0374, dtype=torch.float64)
17 gae_duplicate tensor(-0.3835, dtype=torch.float64) tensor(-0.1564, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7114, dtype=torch.float64) delta_t tensor(-0.0306, dtype=torch.float64)
16 gae_duplicate tensor(-0.7829, dtype=torch.float64) tensor(1.4778, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5867, dtype=torch.float64) delta_t tensor(-0.0204, dtype=torch.float64)
15 gae_duplicate tensor(-1.3763, dtype=torch.float64) tensor(1.7937, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8374, dtype=torch.float64) delta_t tensor(0.2357, dtype=torch.float64)
14 gae_duplicate tensor(0.0625, dtype=torch.float64) tensor(-2.2430, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8379, dtype=torch.float64) delta_t tensor(0.2797, dtype=torch.float64)
13 gae_duplicate tensor(0.1788, dtype=torch.float64) tensor(-3.1674, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8281, dtype=torch.float64) delta_t tensor(0.2696, dtype=torch.float64)
12 gae_duplicate tensor(0.1867, dtype=torch.float64) tensor(-2.7724, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7025, dtype=torch.float64) delta_t tensor(0.2198, dtype=torch.float64)
11 gae_duplicate tensor(-0.0850, dtype=torch.float64) tensor(-3.0747, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6728, dtype=torch.float64) delta_t tensor(0.0979, dtype=torch.float64)
10 gae_duplicate tensor(-0.3303, dtype=torch.float64) tensor(-0.6001, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3489, dtype=torch.float64) delta_t tensor(-0.2405, dtype=torch.float64)
9 gae_duplicate tensor(-1.0081, dtype=torch.float64) tensor(3.1967, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1329, dtype=torch.float64) delta_t tensor(-0.0817, dtype=torch.float64)
8 gae_duplicate tensor(-1.1318, dtype=torch.float64) tensor(2.5475, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3463, dtype=torch.float64) delta_t tensor(-0.6545, dtype=torch.float64)
7 gae_duplicate tensor(-1.7034, dtype=torch.float64) tensor(7.8275, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9301, dtype=torch.float64) delta_t tensor(0.1750, dtype=torch.float64)
6 gae_duplicate tensor(-0.2885, dtype=torch.float64) tensor(-0.8769, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4508, dtype=torch.float64) delta_t tensor(-0.5039, dtype=torch.float64)
5 gae_duplicate tensor(-1.6880, dtype=torch.float64) tensor(4.7234, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0611, dtype=torch.float64) delta_t tensor(-0.8250, dtype=torch.float64)
4 gae_duplicate tensor(-1.4783, dtype=torch.float64) tensor(11.2941, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4621, dtype=torch.float64) delta_t tensor(-0.0309, dtype=torch.float64)
3 gae_duplicate tensor(-0.4453, dtype=torch.float64) tensor(0.9269, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4422, dtype=torch.float64) delta_t tensor(-0.5399, dtype=torch.float64)
2 gae_duplicate tensor(-1.5167, dtype=torch.float64) tensor(5.3868, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-918.894775390625
value loss:49.08735656738281
entropies:210.61968994140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8271119594573975 seconds
19 rew tensor(0.8355, dtype=torch.float64) delta_t tensor(0.2958, dtype=torch.float64)
19 gae_duplicate tensor(-0.1695, dtype=torch.float64) tensor(-3.1543, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8360, dtype=torch.float64) delta_t tensor(0.0006, dtype=torch.float64)
18 gae_duplicate tensor(-0.0634, dtype=torch.float64) tensor(-0.2297, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8366, dtype=torch.float64) delta_t tensor(0.1225, dtype=torch.float64)
17 gae_duplicate tensor(0.0652, dtype=torch.float64) tensor(-1.3217, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8372, dtype=torch.float64) delta_t tensor(0.1256, dtype=torch.float64)
16 gae_duplicate tensor(-0.0144, dtype=torch.float64) tensor(-1.5713, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8377, dtype=torch.float64) delta_t tensor(0.1753, dtype=torch.float64)
15 gae_duplicate tensor(0.1214, dtype=torch.float64) tensor(-2.2321, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8383, dtype=torch.float64) delta_t tensor(0.1762, dtype=torch.float64)
14 gae_duplicate tensor(0.1329, dtype=torch.float64) tensor(-2.3467, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8389, dtype=torch.float64) delta_t tensor(0.1798, dtype=torch.float64)
13 gae_duplicate tensor(0.1269, dtype=torch.float64) tensor(-2.4007, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8394, dtype=torch.float64) delta_t tensor(0.2443, dtype=torch.float64)
12 gae_duplicate tensor(0.1258, dtype=torch.float64) tensor(-3.2161, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7566, dtype=torch.float64) delta_t tensor(0.2632, dtype=torch.float64)
11 gae_duplicate tensor(0.1705, dtype=torch.float64) tensor(-3.0524, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5362, dtype=torch.float64) delta_t tensor(-0.0074, dtype=torch.float64)
10 gae_duplicate tensor(-0.1134, dtype=torch.float64) tensor(-0.1874, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2984, dtype=torch.float64) delta_t tensor(-0.3765, dtype=torch.float64)
9 gae_duplicate tensor(-0.9755, dtype=torch.float64) tensor(4.2754, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0937, dtype=torch.float64) delta_t tensor(-0.2059, dtype=torch.float64)
8 gae_duplicate tensor(-1.0824, dtype=torch.float64) tensor(1.8857, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1758, dtype=torch.float64) delta_t tensor(-0.4001, dtype=torch.float64)
7 gae_duplicate tensor(-1.4815, dtype=torch.float64) tensor(2.5115, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8596, dtype=torch.float64) delta_t tensor(0.3420, dtype=torch.float64)
6 gae_duplicate tensor(0.0966, dtype=torch.float64) tensor(-4.0771, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3700, dtype=torch.float64) delta_t tensor(-0.1906, dtype=torch.float64)
5 gae_duplicate tensor(-0.5789, dtype=torch.float64) tensor(1.8804, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8545, dtype=torch.float64) delta_t tensor(-0.5519, dtype=torch.float64)
4 gae_duplicate tensor(-0.8848, dtype=torch.float64) tensor(6.9908, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6865, dtype=torch.float64) delta_t tensor(-0.2513, dtype=torch.float64)
3 gae_duplicate tensor(-0.5881, dtype=torch.float64) tensor(3.7086, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3456, dtype=torch.float64) delta_t tensor(-0.2172, dtype=torch.float64)
2 gae_duplicate tensor(-1.0332, dtype=torch.float64) tensor(3.1899, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-61.44976043701172
value loss:27.273866653442383
entropies:210.8125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.942631006240845 seconds
19 rew tensor(0.8352, dtype=torch.float64) delta_t tensor(0.1195, dtype=torch.float64)
19 gae_duplicate tensor(-0.0078, dtype=torch.float64) tensor(-1.3439, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8358, dtype=torch.float64) delta_t tensor(0.0718, dtype=torch.float64)
18 gae_duplicate tensor(-0.1144, dtype=torch.float64) tensor(-0.8521, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8363, dtype=torch.float64) delta_t tensor(0.1219, dtype=torch.float64)
17 gae_duplicate tensor(-0.0131, dtype=torch.float64) tensor(-1.7178, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8369, dtype=torch.float64) delta_t tensor(0.3321, dtype=torch.float64)
16 gae_duplicate tensor(0.0612, dtype=torch.float64) tensor(-3.4573, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8374, dtype=torch.float64) delta_t tensor(0.2545, dtype=torch.float64)
15 gae_duplicate tensor(0.0613, dtype=torch.float64) tensor(-2.9078, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8380, dtype=torch.float64) delta_t tensor(0.2581, dtype=torch.float64)
14 gae_duplicate tensor(0.0584, dtype=torch.float64) tensor(-3.0181, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8385, dtype=torch.float64) delta_t tensor(0.2658, dtype=torch.float64)
13 gae_duplicate tensor(0.0604, dtype=torch.float64) tensor(-3.6030, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8391, dtype=torch.float64) delta_t tensor(0.2674, dtype=torch.float64)
12 gae_duplicate tensor(0.0785, dtype=torch.float64) tensor(-2.9471, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8397, dtype=torch.float64) delta_t tensor(0.3273, dtype=torch.float64)
11 gae_duplicate tensor(0.1116, dtype=torch.float64) tensor(-4.9055, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7874, dtype=torch.float64) delta_t tensor(0.0872, dtype=torch.float64)
10 gae_duplicate tensor(-0.1090, dtype=torch.float64) tensor(-1.4327, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4881, dtype=torch.float64) delta_t tensor(-0.2217, dtype=torch.float64)
9 gae_duplicate tensor(-0.2927, dtype=torch.float64) tensor(2.5285, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2418, dtype=torch.float64) delta_t tensor(0.3231, dtype=torch.float64)
8 gae_duplicate tensor(-0.0004, dtype=torch.float64) tensor(-3.8089, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1558, dtype=torch.float64) delta_t tensor(-0.6724, dtype=torch.float64)
7 gae_duplicate tensor(-1.4629, dtype=torch.float64) tensor(6.7552, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0945, dtype=torch.float64) delta_t tensor(0.1472, dtype=torch.float64)
6 gae_duplicate tensor(-0.0832, dtype=torch.float64) tensor(-1.1339, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3542, dtype=torch.float64) delta_t tensor(-0.2024, dtype=torch.float64)
5 gae_duplicate tensor(-0.5075, dtype=torch.float64) tensor(2.0990, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0385, dtype=torch.float64) delta_t tensor(-0.7789, dtype=torch.float64)
4 gae_duplicate tensor(-1.1979, dtype=torch.float64) tensor(10.2511, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7760, dtype=torch.float64) delta_t tensor(-0.3098, dtype=torch.float64)
3 gae_duplicate tensor(-0.5252, dtype=torch.float64) tensor(5.5887, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4001, dtype=torch.float64) delta_t tensor(-0.2462, dtype=torch.float64)
2 gae_duplicate tensor(-0.9393, dtype=torch.float64) tensor(3.8093, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-34.534820556640625
value loss:30.15876007080078
entropies:211.1273193359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7710278034210205 seconds
19 rew tensor(0.8313, dtype=torch.float64) delta_t tensor(0.0996, dtype=torch.float64)
19 gae_duplicate tensor(-0.0776, dtype=torch.float64) tensor(-1.0339, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8318, dtype=torch.float64) delta_t tensor(-0.0162, dtype=torch.float64)
18 gae_duplicate tensor(-0.0812, dtype=torch.float64) tensor(0.1264, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8221, dtype=torch.float64) delta_t tensor(0.0637, dtype=torch.float64)
17 gae_duplicate tensor(-0.0210, dtype=torch.float64) tensor(-0.7842, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8226, dtype=torch.float64) delta_t tensor(0.1029, dtype=torch.float64)
16 gae_duplicate tensor(-0.0498, dtype=torch.float64) tensor(-1.4438, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8232, dtype=torch.float64) delta_t tensor(0.1804, dtype=torch.float64)
15 gae_duplicate tensor(0.1375, dtype=torch.float64) tensor(-1.9460, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(0.1685, dtype=torch.float64)
14 gae_duplicate tensor(0.1352, dtype=torch.float64) tensor(-2.0414, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7934, dtype=torch.float64) delta_t tensor(0.1434, dtype=torch.float64)
13 gae_duplicate tensor(0.0480, dtype=torch.float64) tensor(-1.8590, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8350, dtype=torch.float64) delta_t tensor(0.1843, dtype=torch.float64)
12 gae_duplicate tensor(0.1459, dtype=torch.float64) tensor(-2.3300, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8355, dtype=torch.float64) delta_t tensor(0.2171, dtype=torch.float64)
11 gae_duplicate tensor(0.1773, dtype=torch.float64) tensor(-2.4955, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7540, dtype=torch.float64) delta_t tensor(0.0663, dtype=torch.float64)
10 gae_duplicate tensor(-0.0712, dtype=torch.float64) tensor(-0.8844, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0153, dtype=torch.float64) delta_t tensor(-0.5995, dtype=torch.float64)
9 gae_duplicate tensor(-2.5225, dtype=torch.float64) tensor(5.4903, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2427, dtype=torch.float64) delta_t tensor(-0.1994, dtype=torch.float64)
8 gae_duplicate tensor(-2.6317, dtype=torch.float64) tensor(4.1577, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5972, dtype=torch.float64) delta_t tensor(-1.1350, dtype=torch.float64)
7 gae_duplicate tensor(-3.1798, dtype=torch.float64) tensor(15.2998, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1200, dtype=torch.float64) delta_t tensor(-0.3140, dtype=torch.float64)
6 gae_duplicate tensor(-2.2337, dtype=torch.float64) tensor(5.6499, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4298, dtype=torch.float64) delta_t tensor(-0.4475, dtype=torch.float64)
5 gae_duplicate tensor(-2.0510, dtype=torch.float64) tensor(4.7209, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3074, dtype=torch.float64) delta_t tensor(-2.2655, dtype=torch.float64)
4 gae_duplicate tensor(-10.1979, dtype=torch.float64) tensor(23.6781, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4551, dtype=torch.float64) delta_t tensor(-0.2648, dtype=torch.float64)
3 gae_duplicate tensor(-1.5845, dtype=torch.float64) tensor(6.4098, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2387, dtype=torch.float64) delta_t tensor(-0.2260, dtype=torch.float64)
2 gae_duplicate tensor(-0.7654, dtype=torch.float64) tensor(3.4154, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1986.6929931640625
value loss:228.63198852539062
entropies:211.20518493652344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2473.5298)
ToM Target loss= tensor(1805.3805)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.009644985198975 seconds
19 rew tensor(0.8315, dtype=torch.float64) delta_t tensor(0.1417, dtype=torch.float64)
19 gae_duplicate tensor(-0.0503, dtype=torch.float64) tensor(-1.4880, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8320, dtype=torch.float64) delta_t tensor(0.0753, dtype=torch.float64)
18 gae_duplicate tensor(-0.0069, dtype=torch.float64) tensor(-1.0999, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8326, dtype=torch.float64) delta_t tensor(0.1457, dtype=torch.float64)
17 gae_duplicate tensor(0.0338, dtype=torch.float64) tensor(-1.5444, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8331, dtype=torch.float64) delta_t tensor(0.2283, dtype=torch.float64)
16 gae_duplicate tensor(-0.0542, dtype=torch.float64) tensor(-2.6160, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8337, dtype=torch.float64) delta_t tensor(0.1580, dtype=torch.float64)
15 gae_duplicate tensor(0.1237, dtype=torch.float64) tensor(-2.0704, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8342, dtype=torch.float64) delta_t tensor(0.1930, dtype=torch.float64)
14 gae_duplicate tensor(0.1242, dtype=torch.float64) tensor(-2.6488, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8347, dtype=torch.float64) delta_t tensor(0.2412, dtype=torch.float64)
13 gae_duplicate tensor(0.1248, dtype=torch.float64) tensor(-3.0004, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8353, dtype=torch.float64) delta_t tensor(0.3128, dtype=torch.float64)
12 gae_duplicate tensor(0.1235, dtype=torch.float64) tensor(-3.7911, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7869, dtype=torch.float64) delta_t tensor(0.3070, dtype=torch.float64)
11 gae_duplicate tensor(-0.0104, dtype=torch.float64) tensor(-3.3883, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7483, dtype=torch.float64) delta_t tensor(0.2819, dtype=torch.float64)
10 gae_duplicate tensor(0.0146, dtype=torch.float64) tensor(-3.3127, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3443, dtype=torch.float64) delta_t tensor(-0.2692, dtype=torch.float64)
9 gae_duplicate tensor(-0.7284, dtype=torch.float64) tensor(3.0553, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0169, dtype=torch.float64) delta_t tensor(-0.2513, dtype=torch.float64)
8 gae_duplicate tensor(-0.9190, dtype=torch.float64) tensor(4.9889, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2877, dtype=torch.float64) delta_t tensor(-0.4937, dtype=torch.float64)
7 gae_duplicate tensor(-1.2067, dtype=torch.float64) tensor(6.7444, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8917, dtype=torch.float64) delta_t tensor(0.1214, dtype=torch.float64)
6 gae_duplicate tensor(-1.3755, dtype=torch.float64) tensor(-0.8359, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4200, dtype=torch.float64) delta_t tensor(-0.1858, dtype=torch.float64)
5 gae_duplicate tensor(-0.8746, dtype=torch.float64) tensor(2.3288, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7410, dtype=torch.float64) delta_t tensor(-0.2902, dtype=torch.float64)
4 gae_duplicate tensor(-0.7068, dtype=torch.float64) tensor(3.8510, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7812, dtype=torch.float64) delta_t tensor(-0.3168, dtype=torch.float64)
3 gae_duplicate tensor(-0.8938, dtype=torch.float64) tensor(4.4190, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2383, dtype=torch.float64) delta_t tensor(0.0203, dtype=torch.float64)
2 gae_duplicate tensor(-0.5407, dtype=torch.float64) tensor(0.1928, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-30.366466522216797
value loss:29.6662654876709
entropies:211.83621215820312
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.537975072860718 seconds
19 rew tensor(0.8024, dtype=torch.float64) delta_t tensor(-0.0219, dtype=torch.float64)
19 gae_duplicate tensor(-0.2278, dtype=torch.float64) tensor(0.3211, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8029, dtype=torch.float64) delta_t tensor(-0.0254, dtype=torch.float64)
18 gae_duplicate tensor(-0.2103, dtype=torch.float64) tensor(0.3275, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7642, dtype=torch.float64) delta_t tensor(0.1054, dtype=torch.float64)
17 gae_duplicate tensor(-0.3932, dtype=torch.float64) tensor(-0.8573, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6961, dtype=torch.float64) delta_t tensor(-0.0517, dtype=torch.float64)
16 gae_duplicate tensor(-0.8260, dtype=torch.float64) tensor(1.3174, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5791, dtype=torch.float64) delta_t tensor(-0.1002, dtype=torch.float64)
15 gae_duplicate tensor(-1.3328, dtype=torch.float64) tensor(0.4691, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8339, dtype=torch.float64) delta_t tensor(0.1482, dtype=torch.float64)
14 gae_duplicate tensor(0.1054, dtype=torch.float64) tensor(-1.6434, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8345, dtype=torch.float64) delta_t tensor(0.1601, dtype=torch.float64)
13 gae_duplicate tensor(0.1235, dtype=torch.float64) tensor(-2.1700, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8350, dtype=torch.float64) delta_t tensor(0.1669, dtype=torch.float64)
12 gae_duplicate tensor(0.1300, dtype=torch.float64) tensor(-2.3329, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8355, dtype=torch.float64) delta_t tensor(0.2075, dtype=torch.float64)
11 gae_duplicate tensor(0.1665, dtype=torch.float64) tensor(-3.0829, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8360, dtype=torch.float64) delta_t tensor(0.0320, dtype=torch.float64)
10 gae_duplicate tensor(-0.0444, dtype=torch.float64) tensor(-0.5145, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4992, dtype=torch.float64) delta_t tensor(-0.1448, dtype=torch.float64)
9 gae_duplicate tensor(-0.3465, dtype=torch.float64) tensor(1.2233, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2323, dtype=torch.float64) delta_t tensor(0.1922, dtype=torch.float64)
8 gae_duplicate tensor(-0.0048, dtype=torch.float64) tensor(-2.0941, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2367, dtype=torch.float64) delta_t tensor(-0.7478, dtype=torch.float64)
7 gae_duplicate tensor(-1.3330, dtype=torch.float64) tensor(7.8625, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8501, dtype=torch.float64) delta_t tensor(0.2939, dtype=torch.float64)
6 gae_duplicate tensor(-0.1518, dtype=torch.float64) tensor(-3.0210, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1187, dtype=torch.float64) delta_t tensor(-0.0054, dtype=torch.float64)
5 gae_duplicate tensor(-0.4321, dtype=torch.float64) tensor(-0.1238, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7812, dtype=torch.float64) delta_t tensor(-0.3772, dtype=torch.float64)
4 gae_duplicate tensor(-1.0720, dtype=torch.float64) tensor(3.7297, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5548, dtype=torch.float64) delta_t tensor(-0.0926, dtype=torch.float64)
3 gae_duplicate tensor(-0.5344, dtype=torch.float64) tensor(1.2377, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0900, dtype=torch.float64) delta_t tensor(0.0291, dtype=torch.float64)
2 gae_duplicate tensor(-0.4208, dtype=torch.float64) tensor(0.1839, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-68.12711334228516
value loss:22.59026336669922
entropies:212.03485107421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8283021450042725 seconds
19 rew tensor(0.8306, dtype=torch.float64) delta_t tensor(0.0419, dtype=torch.float64)
19 gae_duplicate tensor(-0.1654, dtype=torch.float64) tensor(-0.4446, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8311, dtype=torch.float64) delta_t tensor(0.0177, dtype=torch.float64)
18 gae_duplicate tensor(-0.0794, dtype=torch.float64) tensor(-0.3452, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8220, dtype=torch.float64) delta_t tensor(0.1076, dtype=torch.float64)
17 gae_duplicate tensor(0.0004, dtype=torch.float64) tensor(-1.1897, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8225, dtype=torch.float64) delta_t tensor(0.0930, dtype=torch.float64)
16 gae_duplicate tensor(-0.0969, dtype=torch.float64) tensor(-1.4509, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8230, dtype=torch.float64) delta_t tensor(0.1515, dtype=torch.float64)
15 gae_duplicate tensor(-0.0741, dtype=torch.float64) tensor(-1.6668, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.1384, dtype=torch.float64)
14 gae_duplicate tensor(-0.0779, dtype=torch.float64) tensor(-2.1539, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7950, dtype=torch.float64) delta_t tensor(0.1104, dtype=torch.float64)
13 gae_duplicate tensor(-0.0905, dtype=torch.float64) tensor(-1.2695, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8341, dtype=torch.float64) delta_t tensor(0.1938, dtype=torch.float64)
12 gae_duplicate tensor(0.0845, dtype=torch.float64) tensor(-2.6979, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8347, dtype=torch.float64) delta_t tensor(0.3241, dtype=torch.float64)
11 gae_duplicate tensor(0.2065, dtype=torch.float64) tensor(-3.6030, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6832, dtype=torch.float64) delta_t tensor(0.0627, dtype=torch.float64)
10 gae_duplicate tensor(-0.3713, dtype=torch.float64) tensor(-0.8734, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0254, dtype=torch.float64) delta_t tensor(-0.6243, dtype=torch.float64)
9 gae_duplicate tensor(-2.3680, dtype=torch.float64) tensor(6.6952, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0223, dtype=torch.float64) delta_t tensor(-0.1027, dtype=torch.float64)
8 gae_duplicate tensor(-1.6738, dtype=torch.float64) tensor(2.4456, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4557, dtype=torch.float64) delta_t tensor(-0.8979, dtype=torch.float64)
7 gae_duplicate tensor(-1.8619, dtype=torch.float64) tensor(12.2811, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7811, dtype=torch.float64) delta_t tensor(0.1503, dtype=torch.float64)
6 gae_duplicate tensor(-0.7236, dtype=torch.float64) tensor(-1.3310, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3636, dtype=torch.float64) delta_t tensor(-0.2782, dtype=torch.float64)
5 gae_duplicate tensor(-1.6964, dtype=torch.float64) tensor(3.5739, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6929, dtype=torch.float64) delta_t tensor(-1.5779, dtype=torch.float64)
4 gae_duplicate tensor(-7.1562, dtype=torch.float64) tensor(15.1290, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4603, dtype=torch.float64) delta_t tensor(-0.2670, dtype=torch.float64)
3 gae_duplicate tensor(-1.1774, dtype=torch.float64) tensor(4.6237, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0742, dtype=torch.float64) delta_t tensor(-0.2174, dtype=torch.float64)
2 gae_duplicate tensor(-0.9311, dtype=torch.float64) tensor(3.5997, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1165.804443359375
value loss:123.27952575683594
entropies:212.2642364501953
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.692380905151367 seconds
19 rew tensor(0.8301, dtype=torch.float64) delta_t tensor(0.0647, dtype=torch.float64)
19 gae_duplicate tensor(-0.0813, dtype=torch.float64) tensor(-0.6819, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8306, dtype=torch.float64) delta_t tensor(-0.0097, dtype=torch.float64)
18 gae_duplicate tensor(-0.0698, dtype=torch.float64) tensor(-0.0234, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8311, dtype=torch.float64) delta_t tensor(0.0968, dtype=torch.float64)
17 gae_duplicate tensor(-0.0323, dtype=torch.float64) tensor(-1.2696, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8316, dtype=torch.float64) delta_t tensor(0.0671, dtype=torch.float64)
16 gae_duplicate tensor(-0.0592, dtype=torch.float64) tensor(-0.9696, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8321, dtype=torch.float64) delta_t tensor(0.1714, dtype=torch.float64)
15 gae_duplicate tensor(0.0835, dtype=torch.float64) tensor(-2.2925, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8327, dtype=torch.float64) delta_t tensor(0.1605, dtype=torch.float64)
14 gae_duplicate tensor(0.0840, dtype=torch.float64) tensor(-1.6978, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8332, dtype=torch.float64) delta_t tensor(0.1606, dtype=torch.float64)
13 gae_duplicate tensor(0.0845, dtype=torch.float64) tensor(-2.1587, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8337, dtype=torch.float64) delta_t tensor(0.1801, dtype=torch.float64)
12 gae_duplicate tensor(0.0850, dtype=torch.float64) tensor(-2.7205, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8342, dtype=torch.float64) delta_t tensor(0.2046, dtype=torch.float64)
11 gae_duplicate tensor(0.1037, dtype=torch.float64) tensor(-2.2572, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8347, dtype=torch.float64) delta_t tensor(0.0651, dtype=torch.float64)
10 gae_duplicate tensor(-0.0472, dtype=torch.float64) tensor(-1.0562, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5277, dtype=torch.float64) delta_t tensor(-0.1781, dtype=torch.float64)
9 gae_duplicate tensor(-0.4903, dtype=torch.float64) tensor(1.6453, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2793, dtype=torch.float64) delta_t tensor(0.2240, dtype=torch.float64)
8 gae_duplicate tensor(-0.3674, dtype=torch.float64) tensor(-2.5516, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1540, dtype=torch.float64) delta_t tensor(-0.4642, dtype=torch.float64)
7 gae_duplicate tensor(-1.2730, dtype=torch.float64) tensor(5.2017, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9714, dtype=torch.float64) delta_t tensor(0.1702, dtype=torch.float64)
6 gae_duplicate tensor(-0.2778, dtype=torch.float64) tensor(-1.4811, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4074, dtype=torch.float64) delta_t tensor(-0.1313, dtype=torch.float64)
5 gae_duplicate tensor(-0.9600, dtype=torch.float64) tensor(1.2393, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9674, dtype=torch.float64) delta_t tensor(-0.5692, dtype=torch.float64)
4 gae_duplicate tensor(-1.1070, dtype=torch.float64) tensor(6.9396, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7952, dtype=torch.float64) delta_t tensor(-0.3480, dtype=torch.float64)
3 gae_duplicate tensor(-1.4119, dtype=torch.float64) tensor(4.4440, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3421, dtype=torch.float64) delta_t tensor(-0.1175, dtype=torch.float64)
2 gae_duplicate tensor(-0.7076, dtype=torch.float64) tensor(2.3819, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-135.26963806152344
value loss:22.87480926513672
entropies:213.1483154296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.847048759460449 seconds
19 rew tensor(0.8102, dtype=torch.float64) delta_t tensor(0.2547, dtype=torch.float64)
19 gae_duplicate tensor(0.0355, dtype=torch.float64) tensor(-2.3725, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7902, dtype=torch.float64) delta_t tensor(0.0358, dtype=torch.float64)
18 gae_duplicate tensor(-0.1890, dtype=torch.float64) tensor(-0.4680, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7494, dtype=torch.float64) delta_t tensor(0.0808, dtype=torch.float64)
17 gae_duplicate tensor(-0.3392, dtype=torch.float64) tensor(-0.8556, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6775, dtype=torch.float64) delta_t tensor(-0.0350, dtype=torch.float64)
16 gae_duplicate tensor(-0.6268, dtype=torch.float64) tensor(0.4734, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5335, dtype=torch.float64) delta_t tensor(-0.0419, dtype=torch.float64)
15 gae_duplicate tensor(-1.0476, dtype=torch.float64) tensor(0.8418, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8328, dtype=torch.float64) delta_t tensor(0.2570, dtype=torch.float64)
14 gae_duplicate tensor(0.1433, dtype=torch.float64) tensor(-3.4905, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8230, dtype=torch.float64) delta_t tensor(0.3202, dtype=torch.float64)
13 gae_duplicate tensor(0.1438, dtype=torch.float64) tensor(-3.7446, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7716, dtype=torch.float64) delta_t tensor(0.3280, dtype=torch.float64)
12 gae_duplicate tensor(0.1625, dtype=torch.float64) tensor(-4.1961, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7615, dtype=torch.float64) delta_t tensor(0.2259, dtype=torch.float64)
11 gae_duplicate tensor(0.1673, dtype=torch.float64) tensor(-2.6013, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6513, dtype=torch.float64) delta_t tensor(0.0513, dtype=torch.float64)
10 gae_duplicate tensor(-0.2894, dtype=torch.float64) tensor(-0.7639, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4748, dtype=torch.float64) delta_t tensor(-0.1376, dtype=torch.float64)
9 gae_duplicate tensor(-0.3183, dtype=torch.float64) tensor(1.0590, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1764, dtype=torch.float64) delta_t tensor(0.3520, dtype=torch.float64)
8 gae_duplicate tensor(-0.1543, dtype=torch.float64) tensor(-4.3845, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4233, dtype=torch.float64) delta_t tensor(-0.6916, dtype=torch.float64)
7 gae_duplicate tensor(-1.5694, dtype=torch.float64) tensor(7.5302, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1563, dtype=torch.float64) delta_t tensor(-0.0837, dtype=torch.float64)
6 gae_duplicate tensor(-1.2590, dtype=torch.float64) tensor(1.5834, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4637, dtype=torch.float64) delta_t tensor(-0.1741, dtype=torch.float64)
5 gae_duplicate tensor(-0.7799, dtype=torch.float64) tensor(2.7434, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9819, dtype=torch.float64) delta_t tensor(-0.6780, dtype=torch.float64)
4 gae_duplicate tensor(-1.4558, dtype=torch.float64) tensor(9.7422, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8437, dtype=torch.float64) delta_t tensor(-0.2751, dtype=torch.float64)
3 gae_duplicate tensor(-0.8914, dtype=torch.float64) tensor(4.3506, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2844, dtype=torch.float64) delta_t tensor(-0.1028, dtype=torch.float64)
2 gae_duplicate tensor(-0.5796, dtype=torch.float64) tensor(1.6934, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-295.51751708984375
value loss:34.37469482421875
entropies:213.71824645996094
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2443.4419)
ToM Target loss= tensor(1805.0819)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.020100831985474 seconds
19 rew tensor(0.8217, dtype=torch.float64) delta_t tensor(0.1192, dtype=torch.float64)
19 gae_duplicate tensor(-0.0013, dtype=torch.float64) tensor(-1.3797, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8028, dtype=torch.float64) delta_t tensor(0.0356, dtype=torch.float64)
18 gae_duplicate tensor(-0.1568, dtype=torch.float64) tensor(-0.6306, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7645, dtype=torch.float64) delta_t tensor(0.1326, dtype=torch.float64)
17 gae_duplicate tensor(-0.3833, dtype=torch.float64) tensor(-2.1667, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7165, dtype=torch.float64) delta_t tensor(0.1049, dtype=torch.float64)
16 gae_duplicate tensor(-0.7660, dtype=torch.float64) tensor(-2.1622, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6104, dtype=torch.float64) delta_t tensor(-0.0730, dtype=torch.float64)
15 gae_duplicate tensor(-1.2887, dtype=torch.float64) tensor(0.3481, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8335, dtype=torch.float64) delta_t tensor(0.1338, dtype=torch.float64)
14 gae_duplicate tensor(-0.0196, dtype=torch.float64) tensor(-1.6169, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8340, dtype=torch.float64) delta_t tensor(0.1698, dtype=torch.float64)
13 gae_duplicate tensor(0.1151, dtype=torch.float64) tensor(-2.1906, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8248, dtype=torch.float64) delta_t tensor(0.1967, dtype=torch.float64)
12 gae_duplicate tensor(0.1698, dtype=torch.float64) tensor(-2.7109, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7285, dtype=torch.float64) delta_t tensor(0.1266, dtype=torch.float64)
11 gae_duplicate tensor(-0.2334, dtype=torch.float64) tensor(-1.6196, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7096, dtype=torch.float64) delta_t tensor(0.1304, dtype=torch.float64)
10 gae_duplicate tensor(-0.0735, dtype=torch.float64) tensor(-1.7929, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4294, dtype=torch.float64) delta_t tensor(-0.1343, dtype=torch.float64)
9 gae_duplicate tensor(-0.7751, dtype=torch.float64) tensor(1.2627, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1931, dtype=torch.float64) delta_t tensor(0.0223, dtype=torch.float64)
8 gae_duplicate tensor(-1.0906, dtype=torch.float64) tensor(-0.8447, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0819, dtype=torch.float64) delta_t tensor(-0.5726, dtype=torch.float64)
7 gae_duplicate tensor(-1.1267, dtype=torch.float64) tensor(7.0100, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7470, dtype=torch.float64) delta_t tensor(0.5286, dtype=torch.float64)
6 gae_duplicate tensor(0.1378, dtype=torch.float64) tensor(-5.2059, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1616, dtype=torch.float64) delta_t tensor(0.1998, dtype=torch.float64)
5 gae_duplicate tensor(-0.9481, dtype=torch.float64) tensor(-2.5516, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7761, dtype=torch.float64) delta_t tensor(-0.2847, dtype=torch.float64)
4 gae_duplicate tensor(-0.9258, dtype=torch.float64) tensor(3.2030, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4532, dtype=torch.float64) delta_t tensor(0.0943, dtype=torch.float64)
3 gae_duplicate tensor(-0.3913, dtype=torch.float64) tensor(-0.5400, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2699, dtype=torch.float64) delta_t tensor(-0.0376, dtype=torch.float64)
2 gae_duplicate tensor(-0.5121, dtype=torch.float64) tensor(0.0326, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:449.5086975097656
value loss:26.12405776977539
entropies:213.85557556152344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.744539976119995 seconds
19 rew tensor(0.8311, dtype=torch.float64) delta_t tensor(0.1447, dtype=torch.float64)
19 gae_duplicate tensor(0.0016, dtype=torch.float64) tensor(-1.5878, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8316, dtype=torch.float64) delta_t tensor(0.0164, dtype=torch.float64)
18 gae_duplicate tensor(-0.0198, dtype=torch.float64) tensor(-0.4133, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8321, dtype=torch.float64) delta_t tensor(0.1384, dtype=torch.float64)
17 gae_duplicate tensor(0.0234, dtype=torch.float64) tensor(-1.9608, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8326, dtype=torch.float64) delta_t tensor(0.2161, dtype=torch.float64)
16 gae_duplicate tensor(-0.0443, dtype=torch.float64) tensor(-2.2038, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8331, dtype=torch.float64) delta_t tensor(0.1675, dtype=torch.float64)
15 gae_duplicate tensor(0.1290, dtype=torch.float64) tensor(-2.3976, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8335, dtype=torch.float64) delta_t tensor(0.1700, dtype=torch.float64)
14 gae_duplicate tensor(0.1295, dtype=torch.float64) tensor(-2.2675, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8340, dtype=torch.float64) delta_t tensor(0.1693, dtype=torch.float64)
13 gae_duplicate tensor(0.1328, dtype=torch.float64) tensor(-2.5640, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8345, dtype=torch.float64) delta_t tensor(0.1929, dtype=torch.float64)
12 gae_duplicate tensor(0.1409, dtype=torch.float64) tensor(-2.7143, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8350, dtype=torch.float64) delta_t tensor(0.2253, dtype=torch.float64)
11 gae_duplicate tensor(0.1722, dtype=torch.float64) tensor(-2.7891, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7677, dtype=torch.float64) delta_t tensor(0.1632, dtype=torch.float64)
10 gae_duplicate tensor(-0.3336, dtype=torch.float64) tensor(-2.4627, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5188, dtype=torch.float64) delta_t tensor(-0.0870, dtype=torch.float64)
9 gae_duplicate tensor(-0.3698, dtype=torch.float64) tensor(0.8601, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2921, dtype=torch.float64) delta_t tensor(0.1673, dtype=torch.float64)
8 gae_duplicate tensor(-0.2064, dtype=torch.float64) tensor(-1.5354, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0489, dtype=torch.float64) delta_t tensor(-0.4372, dtype=torch.float64)
7 gae_duplicate tensor(-0.8447, dtype=torch.float64) tensor(5.0593, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8386, dtype=torch.float64) delta_t tensor(0.4458, dtype=torch.float64)
6 gae_duplicate tensor(0.2031, dtype=torch.float64) tensor(-4.5842, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3009, dtype=torch.float64) delta_t tensor(0.2113, dtype=torch.float64)
5 gae_duplicate tensor(-0.0285, dtype=torch.float64) tensor(-3.0323, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9041, dtype=torch.float64) delta_t tensor(-0.3460, dtype=torch.float64)
4 gae_duplicate tensor(-0.5602, dtype=torch.float64) tensor(3.6845, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6599, dtype=torch.float64) delta_t tensor(-0.1312, dtype=torch.float64)
3 gae_duplicate tensor(-0.4570, dtype=torch.float64) tensor(2.2457, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3617, dtype=torch.float64) delta_t tensor(-0.1089, dtype=torch.float64)
2 gae_duplicate tensor(-0.7651, dtype=torch.float64) tensor(1.3272, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:585.5234375
value loss:14.499820709228516
entropies:214.30421447753906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.940820932388306 seconds
19 rew tensor(0.8305, dtype=torch.float64) delta_t tensor(0.1480, dtype=torch.float64)
19 gae_duplicate tensor(0.0635, dtype=torch.float64) tensor(-1.7611, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8310, dtype=torch.float64) delta_t tensor(0.0538, dtype=torch.float64)
18 gae_duplicate tensor(0.0059, dtype=torch.float64) tensor(-0.7873, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8212, dtype=torch.float64) delta_t tensor(0.1599, dtype=torch.float64)
17 gae_duplicate tensor(0.0436, dtype=torch.float64) tensor(-1.8692, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8216, dtype=torch.float64) delta_t tensor(0.1145, dtype=torch.float64)
16 gae_duplicate tensor(-0.0018, dtype=torch.float64) tensor(-1.2887, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(0.1729, dtype=torch.float64)
15 gae_duplicate tensor(0.1253, dtype=torch.float64) tensor(-2.4382, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7917, dtype=torch.float64) delta_t tensor(0.1474, dtype=torch.float64)
14 gae_duplicate tensor(0.1259, dtype=torch.float64) tensor(-2.0413, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7613, dtype=torch.float64) delta_t tensor(0.1038, dtype=torch.float64)
13 gae_duplicate tensor(-0.1570, dtype=torch.float64) tensor(-0.9920, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8337, dtype=torch.float64) delta_t tensor(0.1768, dtype=torch.float64)
12 gae_duplicate tensor(0.1498, dtype=torch.float64) tensor(-2.4719, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8342, dtype=torch.float64) delta_t tensor(0.2061, dtype=torch.float64)
11 gae_duplicate tensor(0.1709, dtype=torch.float64) tensor(-2.6815, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7722, dtype=torch.float64) delta_t tensor(0.0701, dtype=torch.float64)
10 gae_duplicate tensor(-0.0146, dtype=torch.float64) tensor(-1.1116, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0631, dtype=torch.float64) delta_t tensor(-0.6178, dtype=torch.float64)
9 gae_duplicate tensor(-2.5917, dtype=torch.float64) tensor(5.9771, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0608, dtype=torch.float64) delta_t tensor(0.1562, dtype=torch.float64)
8 gae_duplicate tensor(-1.6637, dtype=torch.float64) tensor(-0.7186, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3100, dtype=torch.float64) delta_t tensor(-0.7794, dtype=torch.float64)
7 gae_duplicate tensor(-1.8635, dtype=torch.float64) tensor(8.4949, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2751, dtype=torch.float64) delta_t tensor(-0.3140, dtype=torch.float64)
6 gae_duplicate tensor(-3.4614, dtype=torch.float64) tensor(5.1069, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5549, dtype=torch.float64) delta_t tensor(-0.3911, dtype=torch.float64)
5 gae_duplicate tensor(-3.0429, dtype=torch.float64) tensor(3.8841, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4423, dtype=torch.float64) delta_t tensor(-1.1813, dtype=torch.float64)
4 gae_duplicate tensor(-4.8328, dtype=torch.float64) tensor(11.8968, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5145, dtype=torch.float64) delta_t tensor(-0.2119, dtype=torch.float64)
3 gae_duplicate tensor(-1.1556, dtype=torch.float64) tensor(5.4291, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2066, dtype=torch.float64) delta_t tensor(-0.1735, dtype=torch.float64)
2 gae_duplicate tensor(-0.7968, dtype=torch.float64) tensor(1.9169, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-922.2159423828125
value loss:106.75811767578125
entropies:214.53445434570312
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8187549114227295 seconds
19 rew tensor(0.8104, dtype=torch.float64) delta_t tensor(0.1141, dtype=torch.float64)
19 gae_duplicate tensor(0.0262, dtype=torch.float64) tensor(-1.2329, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8005, dtype=torch.float64) delta_t tensor(0.0160, dtype=torch.float64)
18 gae_duplicate tensor(-0.0868, dtype=torch.float64) tensor(-0.3982, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7596, dtype=torch.float64) delta_t tensor(0.0835, dtype=torch.float64)
17 gae_duplicate tensor(-0.3149, dtype=torch.float64) tensor(-0.7403, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7084, dtype=torch.float64) delta_t tensor(0.0561, dtype=torch.float64)
16 gae_duplicate tensor(-0.6995, dtype=torch.float64) tensor(-0.4356, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5848, dtype=torch.float64) delta_t tensor(-0.1097, dtype=torch.float64)
15 gae_duplicate tensor(-1.3629, dtype=torch.float64) tensor(2.6970, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8330, dtype=torch.float64) delta_t tensor(0.1417, dtype=torch.float64)
14 gae_duplicate tensor(0.0460, dtype=torch.float64) tensor(-1.5276, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8335, dtype=torch.float64) delta_t tensor(0.1807, dtype=torch.float64)
13 gae_duplicate tensor(0.0866, dtype=torch.float64) tensor(-1.9336, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8236, dtype=torch.float64) delta_t tensor(0.1916, dtype=torch.float64)
12 gae_duplicate tensor(0.0786, dtype=torch.float64) tensor(-2.3227, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7209, dtype=torch.float64) delta_t tensor(0.1356, dtype=torch.float64)
11 gae_duplicate tensor(-0.1697, dtype=torch.float64) tensor(-2.0126, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6492, dtype=torch.float64) delta_t tensor(-0.0260, dtype=torch.float64)
10 gae_duplicate tensor(-0.2915, dtype=torch.float64) tensor(0.2555, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3409, dtype=torch.float64) delta_t tensor(-0.3369, dtype=torch.float64)
9 gae_duplicate tensor(-0.7917, dtype=torch.float64) tensor(3.2828, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1339, dtype=torch.float64) delta_t tensor(0.2571, dtype=torch.float64)
8 gae_duplicate tensor(-0.8562, dtype=torch.float64) tensor(-2.2865, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2701, dtype=torch.float64) delta_t tensor(-0.3562, dtype=torch.float64)
7 gae_duplicate tensor(-1.5405, dtype=torch.float64) tensor(4.0942, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0738, dtype=torch.float64) delta_t tensor(0.1926, dtype=torch.float64)
6 gae_duplicate tensor(-0.2327, dtype=torch.float64) tensor(-1.9241, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5176, dtype=torch.float64) delta_t tensor(-0.1565, dtype=torch.float64)
5 gae_duplicate tensor(-1.4324, dtype=torch.float64) tensor(1.6533, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0066, dtype=torch.float64) delta_t tensor(-0.5934, dtype=torch.float64)
4 gae_duplicate tensor(-1.1578, dtype=torch.float64) tensor(6.5911, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4832, dtype=torch.float64) delta_t tensor(0.0562, dtype=torch.float64)
3 gae_duplicate tensor(-0.3108, dtype=torch.float64) tensor(-0.1054, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4299, dtype=torch.float64) delta_t tensor(-0.3635, dtype=torch.float64)
2 gae_duplicate tensor(-1.1003, dtype=torch.float64) tensor(5.1745, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-356.5898132324219
value loss:32.40500259399414
entropies:215.30833435058594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.881298065185547 seconds
19 rew tensor(0.8310, dtype=torch.float64) delta_t tensor(0.1856, dtype=torch.float64)
19 gae_duplicate tensor(0.0489, dtype=torch.float64) tensor(-2.1908, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8315, dtype=torch.float64) delta_t tensor(0.0907, dtype=torch.float64)
18 gae_duplicate tensor(-0.0215, dtype=torch.float64) tensor(-1.2778, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8319, dtype=torch.float64) delta_t tensor(0.1652, dtype=torch.float64)
17 gae_duplicate tensor(0.0312, dtype=torch.float64) tensor(-2.1322, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8324, dtype=torch.float64) delta_t tensor(0.0403, dtype=torch.float64)
16 gae_duplicate tensor(-0.0391, dtype=torch.float64) tensor(-0.5450, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8329, dtype=torch.float64) delta_t tensor(0.1777, dtype=torch.float64)
15 gae_duplicate tensor(0.1224, dtype=torch.float64) tensor(-2.1296, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8333, dtype=torch.float64) delta_t tensor(0.1657, dtype=torch.float64)
14 gae_duplicate tensor(0.1229, dtype=torch.float64) tensor(-1.8239, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8338, dtype=torch.float64) delta_t tensor(0.1686, dtype=torch.float64)
13 gae_duplicate tensor(0.1234, dtype=torch.float64) tensor(-2.1198, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8343, dtype=torch.float64) delta_t tensor(0.1777, dtype=torch.float64)
12 gae_duplicate tensor(0.1238, dtype=torch.float64) tensor(-2.0553, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8348, dtype=torch.float64) delta_t tensor(0.2987, dtype=torch.float64)
11 gae_duplicate tensor(0.1473, dtype=torch.float64) tensor(-3.8386, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7838, dtype=torch.float64) delta_t tensor(0.1471, dtype=torch.float64)
10 gae_duplicate tensor(-0.1909, dtype=torch.float64) tensor(-2.0878, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3720, dtype=torch.float64) delta_t tensor(-0.2804, dtype=torch.float64)
9 gae_duplicate tensor(-0.4762, dtype=torch.float64) tensor(3.2829, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1367, dtype=torch.float64) delta_t tensor(0.5256, dtype=torch.float64)
8 gae_duplicate tensor(-0.0369, dtype=torch.float64) tensor(-5.9400, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2545, dtype=torch.float64) delta_t tensor(-0.3518, dtype=torch.float64)
7 gae_duplicate tensor(-0.5496, dtype=torch.float64) tensor(4.3426, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2183, dtype=torch.float64) delta_t tensor(0.0147, dtype=torch.float64)
6 gae_duplicate tensor(-0.6896, dtype=torch.float64) tensor(0.2919, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5074, dtype=torch.float64) delta_t tensor(-0.1162, dtype=torch.float64)
5 gae_duplicate tensor(-0.5012, dtype=torch.float64) tensor(1.5242, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9624, dtype=torch.float64) delta_t tensor(-0.5115, dtype=torch.float64)
4 gae_duplicate tensor(-1.3109, dtype=torch.float64) tensor(5.6556, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5322, dtype=torch.float64) delta_t tensor(0.0323, dtype=torch.float64)
3 gae_duplicate tensor(-0.1747, dtype=torch.float64) tensor(0.2535, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4759, dtype=torch.float64) delta_t tensor(-0.3414, dtype=torch.float64)
2 gae_duplicate tensor(-0.9629, dtype=torch.float64) tensor(3.4032, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:227.12327575683594
value loss:20.802814483642578
entropies:215.57318115234375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2428.9998)
ToM Target loss= tensor(1804.7596)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.852972984313965 seconds
19 rew tensor(0.8210, dtype=torch.float64) delta_t tensor(0.1290, dtype=torch.float64)
19 gae_duplicate tensor(0.0187, dtype=torch.float64) tensor(-1.6625, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8009, dtype=torch.float64) delta_t tensor(0.0850, dtype=torch.float64)
18 gae_duplicate tensor(-0.1156, dtype=torch.float64) tensor(-1.3155, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7706, dtype=torch.float64) delta_t tensor(0.1619, dtype=torch.float64)
17 gae_duplicate tensor(-0.2578, dtype=torch.float64) tensor(-2.2599, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7196, dtype=torch.float64) delta_t tensor(0.0743, dtype=torch.float64)
16 gae_duplicate tensor(-0.6221, dtype=torch.float64) tensor(-1.5527, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6173, dtype=torch.float64) delta_t tensor(-0.0549, dtype=torch.float64)
15 gae_duplicate tensor(-1.1986, dtype=torch.float64) tensor(-0.2514, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8333, dtype=torch.float64) delta_t tensor(0.1659, dtype=torch.float64)
14 gae_duplicate tensor(0.0300, dtype=torch.float64) tensor(-2.0245, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8337, dtype=torch.float64) delta_t tensor(0.1655, dtype=torch.float64)
13 gae_duplicate tensor(0.1550, dtype=torch.float64) tensor(-2.3729, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8342, dtype=torch.float64) delta_t tensor(0.1759, dtype=torch.float64)
12 gae_duplicate tensor(0.1680, dtype=torch.float64) tensor(-2.5563, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8347, dtype=torch.float64) delta_t tensor(0.2100, dtype=torch.float64)
11 gae_duplicate tensor(0.1903, dtype=torch.float64) tensor(-2.9128, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8351, dtype=torch.float64) delta_t tensor(0.1765, dtype=torch.float64)
10 gae_duplicate tensor(0.0410, dtype=torch.float64) tensor(-2.1154, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4835, dtype=torch.float64) delta_t tensor(-0.0257, dtype=torch.float64)
9 gae_duplicate tensor(-0.2697, dtype=torch.float64) tensor(0.2791, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1331, dtype=torch.float64) delta_t tensor(0.3430, dtype=torch.float64)
8 gae_duplicate tensor(0.0222, dtype=torch.float64) tensor(-4.0848, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2405, dtype=torch.float64) delta_t tensor(-0.8628, dtype=torch.float64)
7 gae_duplicate tensor(-1.4477, dtype=torch.float64) tensor(10.8370, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8947, dtype=torch.float64) delta_t tensor(0.3865, dtype=torch.float64)
6 gae_duplicate tensor(-0.7122, dtype=torch.float64) tensor(-4.1844, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1418, dtype=torch.float64) delta_t tensor(0.3515, dtype=torch.float64)
5 gae_duplicate tensor(-0.3519, dtype=torch.float64) tensor(-4.2284, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9030, dtype=torch.float64) delta_t tensor(-0.3067, dtype=torch.float64)
4 gae_duplicate tensor(-1.2982, dtype=torch.float64) tensor(2.9685, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4735, dtype=torch.float64) delta_t tensor(0.1172, dtype=torch.float64)
3 gae_duplicate tensor(-0.1024, dtype=torch.float64) tensor(-1.0753, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2236, dtype=torch.float64) delta_t tensor(0.1781, dtype=torch.float64)
2 gae_duplicate tensor(-0.5362, dtype=torch.float64) tensor(-2.6667, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:723.54833984375
value loss:26.058914184570312
entropies:216.07260131835938
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.73530387878418 seconds
19 rew tensor(0.8311, dtype=torch.float64) delta_t tensor(0.0909, dtype=torch.float64)
19 gae_duplicate tensor(-0.0557, dtype=torch.float64) tensor(-1.3417, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8316, dtype=torch.float64) delta_t tensor(0.0806, dtype=torch.float64)
18 gae_duplicate tensor(-0.0115, dtype=torch.float64) tensor(-0.8344, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8320, dtype=torch.float64) delta_t tensor(0.1460, dtype=torch.float64)
17 gae_duplicate tensor(0.0695, dtype=torch.float64) tensor(-1.7809, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8325, dtype=torch.float64) delta_t tensor(0.2033, dtype=torch.float64)
16 gae_duplicate tensor(0.0408, dtype=torch.float64) tensor(-2.3007, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8330, dtype=torch.float64) delta_t tensor(0.1252, dtype=torch.float64)
15 gae_duplicate tensor(0.0963, dtype=torch.float64) tensor(-1.7698, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8334, dtype=torch.float64) delta_t tensor(0.1283, dtype=torch.float64)
14 gae_duplicate tensor(0.0837, dtype=torch.float64) tensor(-1.8079, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8339, dtype=torch.float64) delta_t tensor(0.1288, dtype=torch.float64)
13 gae_duplicate tensor(0.0732, dtype=torch.float64) tensor(-1.5876, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8343, dtype=torch.float64) delta_t tensor(0.1548, dtype=torch.float64)
12 gae_duplicate tensor(0.0668, dtype=torch.float64) tensor(-2.1651, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8348, dtype=torch.float64) delta_t tensor(0.2114, dtype=torch.float64)
11 gae_duplicate tensor(0.1051, dtype=torch.float64) tensor(-2.8442, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7408, dtype=torch.float64) delta_t tensor(0.0318, dtype=torch.float64)
10 gae_duplicate tensor(-0.1042, dtype=torch.float64) tensor(-0.5061, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4533, dtype=torch.float64) delta_t tensor(-0.1966, dtype=torch.float64)
9 gae_duplicate tensor(-0.7438, dtype=torch.float64) tensor(2.9152, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2790, dtype=torch.float64) delta_t tensor(0.1204, dtype=torch.float64)
8 gae_duplicate tensor(-0.7978, dtype=torch.float64) tensor(-1.0106, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0902, dtype=torch.float64) delta_t tensor(-0.3596, dtype=torch.float64)
7 gae_duplicate tensor(-1.1946, dtype=torch.float64) tensor(4.7017, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7793, dtype=torch.float64) delta_t tensor(0.4731, dtype=torch.float64)
6 gae_duplicate tensor(0.0095, dtype=torch.float64) tensor(-5.5174, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2549, dtype=torch.float64) delta_t tensor(0.0684, dtype=torch.float64)
5 gae_duplicate tensor(-0.5039, dtype=torch.float64) tensor(-0.8918, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7773, dtype=torch.float64) delta_t tensor(-0.2692, dtype=torch.float64)
4 gae_duplicate tensor(-0.7180, dtype=torch.float64) tensor(2.8466, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6369, dtype=torch.float64) delta_t tensor(-0.0739, dtype=torch.float64)
3 gae_duplicate tensor(-0.2923, dtype=torch.float64) tensor(1.3543, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2269, dtype=torch.float64) delta_t tensor(-0.1340, dtype=torch.float64)
2 gae_duplicate tensor(-0.8430, dtype=torch.float64) tensor(2.1093, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:336.55035400390625
value loss:18.02470588684082
entropies:216.46255493164062
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.81878399848938 seconds
19 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(0.3503, dtype=torch.float64)
19 gae_duplicate tensor(0.0817, dtype=torch.float64) tensor(-4.6498, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8195, dtype=torch.float64) delta_t tensor(0.1386, dtype=torch.float64)
18 gae_duplicate tensor(-0.0494, dtype=torch.float64) tensor(-1.9705, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7998, dtype=torch.float64) delta_t tensor(0.1790, dtype=torch.float64)
17 gae_duplicate tensor(-0.0145, dtype=torch.float64) tensor(-2.7553, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7600, dtype=torch.float64) delta_t tensor(0.1544, dtype=torch.float64)
16 gae_duplicate tensor(-0.1339, dtype=torch.float64) tensor(-1.7361, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7201, dtype=torch.float64) delta_t tensor(0.1651, dtype=torch.float64)
15 gae_duplicate tensor(-0.3234, dtype=torch.float64) tensor(-1.8690, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5997, dtype=torch.float64) delta_t tensor(-0.0844, dtype=torch.float64)
14 gae_duplicate tensor(-1.2808, dtype=torch.float64) tensor(2.1443, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8315, dtype=torch.float64) delta_t tensor(0.1510, dtype=torch.float64)
13 gae_duplicate tensor(0.0322, dtype=torch.float64) tensor(-1.7311, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8319, dtype=torch.float64) delta_t tensor(0.1671, dtype=torch.float64)
12 gae_duplicate tensor(0.0944, dtype=torch.float64) tensor(-1.8880, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8324, dtype=torch.float64) delta_t tensor(0.1816, dtype=torch.float64)
11 gae_duplicate tensor(0.1156, dtype=torch.float64) tensor(-2.3858, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7393, dtype=torch.float64) delta_t tensor(0.0186, dtype=torch.float64)
10 gae_duplicate tensor(-0.1593, dtype=torch.float64) tensor(-0.4084, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0718, dtype=torch.float64) delta_t tensor(-0.5543, dtype=torch.float64)
9 gae_duplicate tensor(-2.2990, dtype=torch.float64) tensor(7.4008, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1518, dtype=torch.float64) delta_t tensor(-0.2148, dtype=torch.float64)
8 gae_duplicate tensor(-2.7736, dtype=torch.float64) tensor(5.4490, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2390, dtype=torch.float64) delta_t tensor(-0.6126, dtype=torch.float64)
7 gae_duplicate tensor(-1.9066, dtype=torch.float64) tensor(8.4714, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2259, dtype=torch.float64) delta_t tensor(-0.2255, dtype=torch.float64)
6 gae_duplicate tensor(-3.1002, dtype=torch.float64) tensor(5.7603, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5363, dtype=torch.float64) delta_t tensor(-0.3141, dtype=torch.float64)
5 gae_duplicate tensor(-3.0241, dtype=torch.float64) tensor(4.3147, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8683, dtype=torch.float64) delta_t tensor(-1.5736, dtype=torch.float64)
4 gae_duplicate tensor(-8.6085, dtype=torch.float64) tensor(15.4452, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3136, dtype=torch.float64) delta_t tensor(-0.0848, dtype=torch.float64)
3 gae_duplicate tensor(-1.3158, dtype=torch.float64) tensor(2.5122, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0682, dtype=torch.float64) delta_t tensor(-0.1631, dtype=torch.float64)
2 gae_duplicate tensor(-0.6513, dtype=torch.float64) tensor(1.9567, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1265.146728515625
value loss:184.5758056640625
entropies:216.4383544921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6721110343933105 seconds
19 rew tensor(0.8088, dtype=torch.float64) delta_t tensor(0.1394, dtype=torch.float64)
19 gae_duplicate tensor(-0.0766, dtype=torch.float64) tensor(-1.8316, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7986, dtype=torch.float64) delta_t tensor(0.0504, dtype=torch.float64)
18 gae_duplicate tensor(-0.0185, dtype=torch.float64) tensor(-0.8088, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7672, dtype=torch.float64) delta_t tensor(0.0583, dtype=torch.float64)
17 gae_duplicate tensor(-0.2112, dtype=torch.float64) tensor(-0.8667, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6827, dtype=torch.float64) delta_t tensor(-0.0885, dtype=torch.float64)
16 gae_duplicate tensor(-0.7500, dtype=torch.float64) tensor(0.6912, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5663, dtype=torch.float64) delta_t tensor(-0.1206, dtype=torch.float64)
15 gae_duplicate tensor(-1.4500, dtype=torch.float64) tensor(0.7564, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8318, dtype=torch.float64) delta_t tensor(0.1416, dtype=torch.float64)
14 gae_duplicate tensor(0.0184, dtype=torch.float64) tensor(-1.4175, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8005, dtype=torch.float64) delta_t tensor(0.1332, dtype=torch.float64)
13 gae_duplicate tensor(0.0485, dtype=torch.float64) tensor(-1.3972, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7903, dtype=torch.float64) delta_t tensor(0.2169, dtype=torch.float64)
12 gae_duplicate tensor(0.1143, dtype=torch.float64) tensor(-2.7776, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7801, dtype=torch.float64) delta_t tensor(0.2632, dtype=torch.float64)
11 gae_duplicate tensor(0.1104, dtype=torch.float64) tensor(-3.3284, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4114, dtype=torch.float64) delta_t tensor(-0.0891, dtype=torch.float64)
10 gae_duplicate tensor(-1.3634, dtype=torch.float64) tensor(0.5645, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1358, dtype=torch.float64) delta_t tensor(-0.6429, dtype=torch.float64)
9 gae_duplicate tensor(-3.4480, dtype=torch.float64) tensor(6.0300, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0513, dtype=torch.float64) delta_t tensor(0.0039, dtype=torch.float64)
8 gae_duplicate tensor(-1.1571, dtype=torch.float64) tensor(1.6113, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3301, dtype=torch.float64) delta_t tensor(-0.6616, dtype=torch.float64)
7 gae_duplicate tensor(-1.4676, dtype=torch.float64) tensor(7.2804, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9721, dtype=torch.float64) delta_t tensor(0.2455, dtype=torch.float64)
6 gae_duplicate tensor(0.0239, dtype=torch.float64) tensor(-2.1948, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3980, dtype=torch.float64) delta_t tensor(-0.2490, dtype=torch.float64)
5 gae_duplicate tensor(-1.4473, dtype=torch.float64) tensor(3.4695, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9606, dtype=torch.float64) delta_t tensor(-0.4728, dtype=torch.float64)
4 gae_duplicate tensor(-1.3906, dtype=torch.float64) tensor(6.2252, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6075, dtype=torch.float64) delta_t tensor(-0.0137, dtype=torch.float64)
3 gae_duplicate tensor(-0.2163, dtype=torch.float64) tensor(1.0769, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3135, dtype=torch.float64) delta_t tensor(-0.2248, dtype=torch.float64)
2 gae_duplicate tensor(-1.5122, dtype=torch.float64) tensor(3.7387, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-644.571533203125
value loss:52.369014739990234
entropies:216.635009765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.901311874389648 seconds
19 rew tensor(0.8101, dtype=torch.float64) delta_t tensor(0.2240, dtype=torch.float64)
19 gae_duplicate tensor(0.0253, dtype=torch.float64) tensor(-2.5266, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7899, dtype=torch.float64) delta_t tensor(0.0353, dtype=torch.float64)
18 gae_duplicate tensor(-0.1390, dtype=torch.float64) tensor(-0.8217, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7400, dtype=torch.float64) delta_t tensor(0.0532, dtype=torch.float64)
17 gae_duplicate tensor(-0.3042, dtype=torch.float64) tensor(-0.9012, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6702, dtype=torch.float64) delta_t tensor(-0.0658, dtype=torch.float64)
16 gae_duplicate tensor(-0.6273, dtype=torch.float64) tensor(0.4010, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5193, dtype=torch.float64) delta_t tensor(-0.1497, dtype=torch.float64)
15 gae_duplicate tensor(-1.1403, dtype=torch.float64) tensor(1.7152, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6194, dtype=torch.float64) delta_t tensor(-0.0976, dtype=torch.float64)
14 gae_duplicate tensor(-1.2091, dtype=torch.float64) tensor(2.2691, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8320, dtype=torch.float64) delta_t tensor(0.1294, dtype=torch.float64)
13 gae_duplicate tensor(-0.0025, dtype=torch.float64) tensor(-1.2125, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8324, dtype=torch.float64) delta_t tensor(0.1568, dtype=torch.float64)
12 gae_duplicate tensor(0.0782, dtype=torch.float64) tensor(-1.8475, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8226, dtype=torch.float64) delta_t tensor(0.1736, dtype=torch.float64)
11 gae_duplicate tensor(0.1039, dtype=torch.float64) tensor(-2.1757, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6921, dtype=torch.float64) delta_t tensor(0.0168, dtype=torch.float64)
10 gae_duplicate tensor(-0.1601, dtype=torch.float64) tensor(-0.2282, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0389, dtype=torch.float64) delta_t tensor(-0.5722, dtype=torch.float64)
9 gae_duplicate tensor(-2.4213, dtype=torch.float64) tensor(7.2278, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2606, dtype=torch.float64) delta_t tensor(-0.3031, dtype=torch.float64)
8 gae_duplicate tensor(-2.4310, dtype=torch.float64) tensor(3.6044, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5301, dtype=torch.float64) delta_t tensor(-0.7903, dtype=torch.float64)
7 gae_duplicate tensor(-2.7178, dtype=torch.float64) tensor(8.3188, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0719, dtype=torch.float64) delta_t tensor(-0.0966, dtype=torch.float64)
6 gae_duplicate tensor(-2.0027, dtype=torch.float64) tensor(1.2210, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5018, dtype=torch.float64) delta_t tensor(-0.3718, dtype=torch.float64)
5 gae_duplicate tensor(-1.6029, dtype=torch.float64) tensor(4.7927, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6983, dtype=torch.float64) delta_t tensor(-1.5467, dtype=torch.float64)
4 gae_duplicate tensor(-5.6848, dtype=torch.float64) tensor(17.0922, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4201, dtype=torch.float64) delta_t tensor(-0.0888, dtype=torch.float64)
3 gae_duplicate tensor(-0.9896, dtype=torch.float64) tensor(3.0689, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2861, dtype=torch.float64) delta_t tensor(-0.3568, dtype=torch.float64)
2 gae_duplicate tensor(-0.6668, dtype=torch.float64) tensor(4.3008, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1633.7052001953125
value loss:110.27910614013672
entropies:216.41921997070312
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2472.9456)
ToM Target loss= tensor(1806.0795)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.893495082855225 seconds
19 rew tensor(0.7903, dtype=torch.float64) delta_t tensor(0.1016, dtype=torch.float64)
19 gae_duplicate tensor(-0.0779, dtype=torch.float64) tensor(-1.3842, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7393, dtype=torch.float64) delta_t tensor(0.0389, dtype=torch.float64)
18 gae_duplicate tensor(-0.1662, dtype=torch.float64) tensor(-0.4793, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6672, dtype=torch.float64) delta_t tensor(0.0651, dtype=torch.float64)
17 gae_duplicate tensor(-0.2794, dtype=torch.float64) tensor(-0.6077, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4924, dtype=torch.float64) delta_t tensor(-0.2380, dtype=torch.float64)
16 gae_duplicate tensor(-0.6949, dtype=torch.float64) tensor(3.0790, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1940, dtype=torch.float64) delta_t tensor(-0.4885, dtype=torch.float64)
15 gae_duplicate tensor(-1.4116, dtype=torch.float64) tensor(5.3598, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8326, dtype=torch.float64) delta_t tensor(0.1651, dtype=torch.float64)
14 gae_duplicate tensor(0.0232, dtype=torch.float64) tensor(-1.4157, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8022, dtype=torch.float64) delta_t tensor(0.1605, dtype=torch.float64)
13 gae_duplicate tensor(0.1163, dtype=torch.float64) tensor(-2.1005, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7513, dtype=torch.float64) delta_t tensor(0.1962, dtype=torch.float64)
12 gae_duplicate tensor(0.0176, dtype=torch.float64) tensor(-2.7924, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6506, dtype=torch.float64) delta_t tensor(0.1806, dtype=torch.float64)
11 gae_duplicate tensor(-0.0650, dtype=torch.float64) tensor(-2.7409, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5896, dtype=torch.float64) delta_t tensor(0.0653, dtype=torch.float64)
10 gae_duplicate tensor(-0.2297, dtype=torch.float64) tensor(-0.8538, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2698, dtype=torch.float64) delta_t tensor(-0.3161, dtype=torch.float64)
9 gae_duplicate tensor(-0.7874, dtype=torch.float64) tensor(4.0728, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1160, dtype=torch.float64) delta_t tensor(0.2199, dtype=torch.float64)
8 gae_duplicate tensor(-0.4122, dtype=torch.float64) tensor(-2.0376, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2952, dtype=torch.float64) delta_t tensor(-0.5285, dtype=torch.float64)
7 gae_duplicate tensor(-0.9819, dtype=torch.float64) tensor(7.5325, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9986, dtype=torch.float64) delta_t tensor(0.0091, dtype=torch.float64)
6 gae_duplicate tensor(-0.8936, dtype=torch.float64) tensor(0.4957, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3381, dtype=torch.float64) delta_t tensor(-0.0745, dtype=torch.float64)
5 gae_duplicate tensor(-1.3809, dtype=torch.float64) tensor(1.3742, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8581, dtype=torch.float64) delta_t tensor(-0.3269, dtype=torch.float64)
4 gae_duplicate tensor(-1.3942, dtype=torch.float64) tensor(4.4341, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4766, dtype=torch.float64) delta_t tensor(0.1221, dtype=torch.float64)
3 gae_duplicate tensor(-0.5359, dtype=torch.float64) tensor(-1.2267, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3292, dtype=torch.float64) delta_t tensor(-0.2977, dtype=torch.float64)
2 gae_duplicate tensor(-1.2625, dtype=torch.float64) tensor(3.8459, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-563.0303344726562
value loss:37.07313919067383
entropies:216.91946411132812
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.009541034698486 seconds
19 rew tensor(0.8316, dtype=torch.float64) delta_t tensor(0.1764, dtype=torch.float64)
19 gae_duplicate tensor(0.0807, dtype=torch.float64) tensor(-1.8599, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8321, dtype=torch.float64) delta_t tensor(0.1167, dtype=torch.float64)
18 gae_duplicate tensor(0.0045, dtype=torch.float64) tensor(-1.6324, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8325, dtype=torch.float64) delta_t tensor(0.1847, dtype=torch.float64)
17 gae_duplicate tensor(0.1394, dtype=torch.float64) tensor(-2.2749, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8329, dtype=torch.float64) delta_t tensor(0.1323, dtype=torch.float64)
16 gae_duplicate tensor(0.0544, dtype=torch.float64) tensor(-1.4978, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8333, dtype=torch.float64) delta_t tensor(0.1548, dtype=torch.float64)
15 gae_duplicate tensor(0.1048, dtype=torch.float64) tensor(-2.0832, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8338, dtype=torch.float64) delta_t tensor(0.1558, dtype=torch.float64)
14 gae_duplicate tensor(0.1115, dtype=torch.float64) tensor(-2.5140, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8342, dtype=torch.float64) delta_t tensor(0.1649, dtype=torch.float64)
13 gae_duplicate tensor(0.1235, dtype=torch.float64) tensor(-2.0062, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8346, dtype=torch.float64) delta_t tensor(0.2013, dtype=torch.float64)
12 gae_duplicate tensor(0.1411, dtype=torch.float64) tensor(-2.4123, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8351, dtype=torch.float64) delta_t tensor(0.2648, dtype=torch.float64)
11 gae_duplicate tensor(0.1909, dtype=torch.float64) tensor(-3.8539, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6666, dtype=torch.float64) delta_t tensor(0.0419, dtype=torch.float64)
10 gae_duplicate tensor(-0.4235, dtype=torch.float64) tensor(-0.6034, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3397, dtype=torch.float64) delta_t tensor(-0.1847, dtype=torch.float64)
9 gae_duplicate tensor(-0.6703, dtype=torch.float64) tensor(2.3977, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1571, dtype=torch.float64) delta_t tensor(0.0544, dtype=torch.float64)
8 gae_duplicate tensor(-0.5443, dtype=torch.float64) tensor(-0.6657, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2959, dtype=torch.float64) delta_t tensor(-0.5721, dtype=torch.float64)
7 gae_duplicate tensor(-1.4693, dtype=torch.float64) tensor(6.5423, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9492, dtype=torch.float64) delta_t tensor(0.3403, dtype=torch.float64)
6 gae_duplicate tensor(-0.0956, dtype=torch.float64) tensor(-3.3883, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3850, dtype=torch.float64) delta_t tensor(-0.0309, dtype=torch.float64)
5 gae_duplicate tensor(-0.4443, dtype=torch.float64) tensor(0.0598, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9749, dtype=torch.float64) delta_t tensor(-0.4721, dtype=torch.float64)
4 gae_duplicate tensor(-1.0378, dtype=torch.float64) tensor(6.1068, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6503, dtype=torch.float64) delta_t tensor(-0.0327, dtype=torch.float64)
3 gae_duplicate tensor(-0.4143, dtype=torch.float64) tensor(1.0730, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3226, dtype=torch.float64) delta_t tensor(-0.1092, dtype=torch.float64)
2 gae_duplicate tensor(-1.0608, dtype=torch.float64) tensor(2.4191, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:183.9008331298828
value loss:21.875856399536133
entropies:216.99276733398438
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.053984642028809 seconds
19 rew tensor(0.8315, dtype=torch.float64) delta_t tensor(0.1598, dtype=torch.float64)
19 gae_duplicate tensor(0.0446, dtype=torch.float64) tensor(-1.9344, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8319, dtype=torch.float64) delta_t tensor(0.0910, dtype=torch.float64)
18 gae_duplicate tensor(0.0661, dtype=torch.float64) tensor(-1.3971, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8324, dtype=torch.float64) delta_t tensor(0.1919, dtype=torch.float64)
17 gae_duplicate tensor(0.1398, dtype=torch.float64) tensor(-2.1240, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8328, dtype=torch.float64) delta_t tensor(0.1672, dtype=torch.float64)
16 gae_duplicate tensor(0.0093, dtype=torch.float64) tensor(-2.2490, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8332, dtype=torch.float64) delta_t tensor(0.1601, dtype=torch.float64)
15 gae_duplicate tensor(0.1262, dtype=torch.float64) tensor(-1.8737, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8336, dtype=torch.float64) delta_t tensor(0.1596, dtype=torch.float64)
14 gae_duplicate tensor(0.1165, dtype=torch.float64) tensor(-2.3082, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8341, dtype=torch.float64) delta_t tensor(0.1515, dtype=torch.float64)
13 gae_duplicate tensor(0.1118, dtype=torch.float64) tensor(-2.1300, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8345, dtype=torch.float64) delta_t tensor(0.1643, dtype=torch.float64)
12 gae_duplicate tensor(0.1166, dtype=torch.float64) tensor(-2.4392, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8349, dtype=torch.float64) delta_t tensor(0.2046, dtype=torch.float64)
11 gae_duplicate tensor(0.1762, dtype=torch.float64) tensor(-2.4727, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7942, dtype=torch.float64) delta_t tensor(0.2102, dtype=torch.float64)
10 gae_duplicate tensor(0.0093, dtype=torch.float64) tensor(-3.2747, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4349, dtype=torch.float64) delta_t tensor(-0.1891, dtype=torch.float64)
9 gae_duplicate tensor(-0.3145, dtype=torch.float64) tensor(2.2627, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1790, dtype=torch.float64) delta_t tensor(0.4083, dtype=torch.float64)
8 gae_duplicate tensor(0.1762, dtype=torch.float64) tensor(-4.3947, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1385, dtype=torch.float64) delta_t tensor(-0.3919, dtype=torch.float64)
7 gae_duplicate tensor(-0.7534, dtype=torch.float64) tensor(4.0223, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0896, dtype=torch.float64) delta_t tensor(0.2456, dtype=torch.float64)
6 gae_duplicate tensor(-0.0725, dtype=torch.float64) tensor(-2.2522, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3573, dtype=torch.float64) delta_t tensor(0.1399, dtype=torch.float64)
5 gae_duplicate tensor(-0.5320, dtype=torch.float64) tensor(-1.6626, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9122, dtype=torch.float64) delta_t tensor(-0.4024, dtype=torch.float64)
4 gae_duplicate tensor(-0.9526, dtype=torch.float64) tensor(4.6832, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6068, dtype=torch.float64) delta_t tensor(-0.0079, dtype=torch.float64)
3 gae_duplicate tensor(-0.4285, dtype=torch.float64) tensor(0.3150, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3418, dtype=torch.float64) delta_t tensor(-0.0450, dtype=torch.float64)
2 gae_duplicate tensor(-0.8806, dtype=torch.float64) tensor(0.9245, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:619.960205078125
value loss:16.530914306640625
entropies:216.76089477539062
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.005046844482422 seconds
19 rew tensor(0.8313, dtype=torch.float64) delta_t tensor(0.1382, dtype=torch.float64)
19 gae_duplicate tensor(0.0744, dtype=torch.float64) tensor(-1.6849, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8317, dtype=torch.float64) delta_t tensor(0.1121, dtype=torch.float64)
18 gae_duplicate tensor(0.0443, dtype=torch.float64) tensor(-1.6436, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8322, dtype=torch.float64) delta_t tensor(0.2076, dtype=torch.float64)
17 gae_duplicate tensor(0.1032, dtype=torch.float64) tensor(-2.2316, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8326, dtype=torch.float64) delta_t tensor(0.1019, dtype=torch.float64)
16 gae_duplicate tensor(0.0175, dtype=torch.float64) tensor(-1.3419, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8330, dtype=torch.float64) delta_t tensor(0.1719, dtype=torch.float64)
15 gae_duplicate tensor(0.0865, dtype=torch.float64) tensor(-2.3806, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8334, dtype=torch.float64) delta_t tensor(0.1710, dtype=torch.float64)
14 gae_duplicate tensor(0.0870, dtype=torch.float64) tensor(-2.1087, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8338, dtype=torch.float64) delta_t tensor(0.1730, dtype=torch.float64)
13 gae_duplicate tensor(0.1059, dtype=torch.float64) tensor(-2.7276, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8343, dtype=torch.float64) delta_t tensor(0.1845, dtype=torch.float64)
12 gae_duplicate tensor(0.1063, dtype=torch.float64) tensor(-2.2747, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8347, dtype=torch.float64) delta_t tensor(0.2054, dtype=torch.float64)
11 gae_duplicate tensor(0.1302, dtype=torch.float64) tensor(-2.4509, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8351, dtype=torch.float64) delta_t tensor(0.1681, dtype=torch.float64)
10 gae_duplicate tensor(0.0560, dtype=torch.float64) tensor(-2.3746, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4657, dtype=torch.float64) delta_t tensor(-0.0973, dtype=torch.float64)
9 gae_duplicate tensor(-0.2704, dtype=torch.float64) tensor(0.9202, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1774, dtype=torch.float64) delta_t tensor(0.3219, dtype=torch.float64)
8 gae_duplicate tensor(-0.4811, dtype=torch.float64) tensor(-3.7957, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2420, dtype=torch.float64) delta_t tensor(-0.6155, dtype=torch.float64)
7 gae_duplicate tensor(-1.2138, dtype=torch.float64) tensor(6.4117, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9033, dtype=torch.float64) delta_t tensor(0.2468, dtype=torch.float64)
6 gae_duplicate tensor(-0.3504, dtype=torch.float64) tensor(-2.4441, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2992, dtype=torch.float64) delta_t tensor(0.2757, dtype=torch.float64)
5 gae_duplicate tensor(-0.2547, dtype=torch.float64) tensor(-3.7910, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8569, dtype=torch.float64) delta_t tensor(-0.3198, dtype=torch.float64)
4 gae_duplicate tensor(-1.0316, dtype=torch.float64) tensor(4.1558, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4771, dtype=torch.float64) delta_t tensor(0.0952, dtype=torch.float64)
3 gae_duplicate tensor(-0.4773, dtype=torch.float64) tensor(-0.7433, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2254, dtype=torch.float64) delta_t tensor(-0.0470, dtype=torch.float64)
2 gae_duplicate tensor(-0.5675, dtype=torch.float64) tensor(1.0583, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:661.120361328125
value loss:21.58201789855957
entropies:216.58767700195312
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.122569799423218 seconds
19 rew tensor(0.8209, dtype=torch.float64) delta_t tensor(0.0867, dtype=torch.float64)
19 gae_duplicate tensor(-0.0403, dtype=torch.float64) tensor(-1.0963, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8001, dtype=torch.float64) delta_t tensor(0.0423, dtype=torch.float64)
18 gae_duplicate tensor(-0.1536, dtype=torch.float64) tensor(-0.5021, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7687, dtype=torch.float64) delta_t tensor(0.1138, dtype=torch.float64)
17 gae_duplicate tensor(-0.2980, dtype=torch.float64) tensor(-1.3380, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7267, dtype=torch.float64) delta_t tensor(-0.0294, dtype=torch.float64)
16 gae_duplicate tensor(-0.6128, dtype=torch.float64) tensor(0.3089, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6212, dtype=torch.float64) delta_t tensor(-0.0604, dtype=torch.float64)
15 gae_duplicate tensor(-1.1978, dtype=torch.float64) tensor(1.0256, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8333, dtype=torch.float64) delta_t tensor(0.1430, dtype=torch.float64)
14 gae_duplicate tensor(0.0064, dtype=torch.float64) tensor(-1.5044, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8337, dtype=torch.float64) delta_t tensor(0.1475, dtype=torch.float64)
13 gae_duplicate tensor(0.1370, dtype=torch.float64) tensor(-1.9018, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8341, dtype=torch.float64) delta_t tensor(0.1598, dtype=torch.float64)
12 gae_duplicate tensor(0.1565, dtype=torch.float64) tensor(-2.0764, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8345, dtype=torch.float64) delta_t tensor(0.2089, dtype=torch.float64)
11 gae_duplicate tensor(0.1955, dtype=torch.float64) tensor(-2.4852, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7672, dtype=torch.float64) delta_t tensor(0.2342, dtype=torch.float64)
10 gae_duplicate tensor(0.1243, dtype=torch.float64) tensor(-3.1089, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4414, dtype=torch.float64) delta_t tensor(-0.1708, dtype=torch.float64)
9 gae_duplicate tensor(-0.5703, dtype=torch.float64) tensor(2.1166, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1001, dtype=torch.float64) delta_t tensor(0.0987, dtype=torch.float64)
8 gae_duplicate tensor(-0.8204, dtype=torch.float64) tensor(-0.9104, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1401, dtype=torch.float64) delta_t tensor(-0.4394, dtype=torch.float64)
7 gae_duplicate tensor(-0.7305, dtype=torch.float64) tensor(5.7326, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9654, dtype=torch.float64) delta_t tensor(0.3097, dtype=torch.float64)
6 gae_duplicate tensor(-0.4855, dtype=torch.float64) tensor(-3.6277, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3590, dtype=torch.float64) delta_t tensor(0.0668, dtype=torch.float64)
5 gae_duplicate tensor(-0.5078, dtype=torch.float64) tensor(-1.0419, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0204, dtype=torch.float64) delta_t tensor(-0.5214, dtype=torch.float64)
4 gae_duplicate tensor(-1.3483, dtype=torch.float64) tensor(6.6201, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5708, dtype=torch.float64) delta_t tensor(0.0804, dtype=torch.float64)
3 gae_duplicate tensor(-0.2130, dtype=torch.float64) tensor(-0.2763, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5024, dtype=torch.float64) delta_t tensor(-0.0880, dtype=torch.float64)
2 gae_duplicate tensor(-0.6248, dtype=torch.float64) tensor(0.9095, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:74.67643737792969
value loss:23.045875549316406
entropies:216.29136657714844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2441.2668)
ToM Target loss= tensor(1805.6393)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.009937047958374 seconds
19 rew tensor(0.8316, dtype=torch.float64) delta_t tensor(0.2560, dtype=torch.float64)
19 gae_duplicate tensor(0.0278, dtype=torch.float64) tensor(-3.4746, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8320, dtype=torch.float64) delta_t tensor(0.1484, dtype=torch.float64)
18 gae_duplicate tensor(0.0716, dtype=torch.float64) tensor(-2.5375, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8324, dtype=torch.float64) delta_t tensor(0.1750, dtype=torch.float64)
17 gae_duplicate tensor(0.1194, dtype=torch.float64) tensor(-1.9145, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8328, dtype=torch.float64) delta_t tensor(0.3433, dtype=torch.float64)
16 gae_duplicate tensor(0.0457, dtype=torch.float64) tensor(-4.2037, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8332, dtype=torch.float64) delta_t tensor(0.2631, dtype=torch.float64)
15 gae_duplicate tensor(0.1381, dtype=torch.float64) tensor(-3.8118, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8336, dtype=torch.float64) delta_t tensor(0.2701, dtype=torch.float64)
14 gae_duplicate tensor(0.1224, dtype=torch.float64) tensor(-3.4475, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8340, dtype=torch.float64) delta_t tensor(0.2881, dtype=torch.float64)
13 gae_duplicate tensor(0.1094, dtype=torch.float64) tensor(-4.1039, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8344, dtype=torch.float64) delta_t tensor(0.2979, dtype=torch.float64)
12 gae_duplicate tensor(0.0968, dtype=torch.float64) tensor(-3.6500, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.3117, dtype=torch.float64)
11 gae_duplicate tensor(0.0990, dtype=torch.float64) tensor(-4.5272, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7762, dtype=torch.float64) delta_t tensor(0.2864, dtype=torch.float64)
10 gae_duplicate tensor(-0.0496, dtype=torch.float64) tensor(-4.7328, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4267, dtype=torch.float64) delta_t tensor(-0.1036, dtype=torch.float64)
9 gae_duplicate tensor(-0.2601, dtype=torch.float64) tensor(0.6575, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1100, dtype=torch.float64) delta_t tensor(0.2762, dtype=torch.float64)
8 gae_duplicate tensor(-0.1550, dtype=torch.float64) tensor(-3.1256, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3095, dtype=torch.float64) delta_t tensor(-0.5104, dtype=torch.float64)
7 gae_duplicate tensor(-1.3932, dtype=torch.float64) tensor(5.7482, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0315, dtype=torch.float64) delta_t tensor(0.1667, dtype=torch.float64)
6 gae_duplicate tensor(-0.4947, dtype=torch.float64) tensor(-1.5829, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2984, dtype=torch.float64) delta_t tensor(0.1186, dtype=torch.float64)
5 gae_duplicate tensor(-0.3042, dtype=torch.float64) tensor(-1.1016, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7534, dtype=torch.float64) delta_t tensor(-0.1877, dtype=torch.float64)
4 gae_duplicate tensor(-0.8080, dtype=torch.float64) tensor(2.0220, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5741, dtype=torch.float64) delta_t tensor(-0.0325, dtype=torch.float64)
3 gae_duplicate tensor(-0.3338, dtype=torch.float64) tensor(0.1428, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0409, dtype=torch.float64) delta_t tensor(-0.1899, dtype=torch.float64)
2 gae_duplicate tensor(-0.8039, dtype=torch.float64) tensor(2.4076, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1085.634765625
value loss:25.426679611206055
entropies:215.80596923828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.768342018127441 seconds
19 rew tensor(0.8091, dtype=torch.float64) delta_t tensor(0.1121, dtype=torch.float64)
19 gae_duplicate tensor(-0.0270, dtype=torch.float64) tensor(-1.4290, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8095, dtype=torch.float64) delta_t tensor(0.0974, dtype=torch.float64)
18 gae_duplicate tensor(0.0164, dtype=torch.float64) tensor(-1.1045, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7790, dtype=torch.float64) delta_t tensor(0.1090, dtype=torch.float64)
17 gae_duplicate tensor(0.0560, dtype=torch.float64) tensor(-1.3503, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6969, dtype=torch.float64) delta_t tensor(0.0143, dtype=torch.float64)
16 gae_duplicate tensor(-0.0618, dtype=torch.float64) tensor(-0.2293, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6045, dtype=torch.float64) delta_t tensor(0.0102, dtype=torch.float64)
15 gae_duplicate tensor(-0.3946, dtype=torch.float64) tensor(-0.1017, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3782, dtype=torch.float64) delta_t tensor(-0.3093, dtype=torch.float64)
14 gae_duplicate tensor(-1.3794, dtype=torch.float64) tensor(2.5536, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8315, dtype=torch.float64) delta_t tensor(0.1532, dtype=torch.float64)
13 gae_duplicate tensor(-0.0074, dtype=torch.float64) tensor(-1.7108, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8319, dtype=torch.float64) delta_t tensor(0.1539, dtype=torch.float64)
12 gae_duplicate tensor(0.0814, dtype=torch.float64) tensor(-2.0984, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8323, dtype=torch.float64) delta_t tensor(0.1940, dtype=torch.float64)
11 gae_duplicate tensor(0.1050, dtype=torch.float64) tensor(-2.4557, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7398, dtype=torch.float64) delta_t tensor(0.1114, dtype=torch.float64)
10 gae_duplicate tensor(0.0270, dtype=torch.float64) tensor(-1.5883, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3804, dtype=torch.float64) delta_t tensor(-0.8648, dtype=torch.float64)
9 gae_duplicate tensor(-2.4855, dtype=torch.float64) tensor(11.2152, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2233, dtype=torch.float64) delta_t tensor(-0.1646, dtype=torch.float64)
8 gae_duplicate tensor(-2.6808, dtype=torch.float64) tensor(3.1808, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9192, dtype=torch.float64) delta_t tensor(-1.1398, dtype=torch.float64)
7 gae_duplicate tensor(-3.9842, dtype=torch.float64) tensor(15.2961, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2587, dtype=torch.float64) delta_t tensor(-0.6237, dtype=torch.float64)
6 gae_duplicate tensor(-3.1148, dtype=torch.float64) tensor(11.6653, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4993, dtype=torch.float64) delta_t tensor(-0.6486, dtype=torch.float64)
5 gae_duplicate tensor(-3.4740, dtype=torch.float64) tensor(9.1864, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6981, dtype=torch.float64) delta_t tensor(-1.7172, dtype=torch.float64)
4 gae_duplicate tensor(-8.9925, dtype=torch.float64) tensor(17.0383, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1653, dtype=torch.float64) delta_t tensor(-0.2865, dtype=torch.float64)
3 gae_duplicate tensor(-1.1881, dtype=torch.float64) tensor(5.0836, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9140, dtype=torch.float64) delta_t tensor(-0.4067, dtype=torch.float64)
2 gae_duplicate tensor(-0.7189, dtype=torch.float64) tensor(5.6720, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2516.413818359375
value loss:241.22386169433594
entropies:215.4097900390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.020141124725342 seconds
19 rew tensor(0.8197, dtype=torch.float64) delta_t tensor(0.1603, dtype=torch.float64)
19 gae_duplicate tensor(0.0531, dtype=torch.float64) tensor(-1.9557, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7995, dtype=torch.float64) delta_t tensor(0.0659, dtype=torch.float64)
18 gae_duplicate tensor(-0.1034, dtype=torch.float64) tensor(-1.1141, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7691, dtype=torch.float64) delta_t tensor(0.1420, dtype=torch.float64)
17 gae_duplicate tensor(-0.2549, dtype=torch.float64) tensor(-2.1661, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7181, dtype=torch.float64) delta_t tensor(0.0523, dtype=torch.float64)
16 gae_duplicate tensor(-0.6560, dtype=torch.float64) tensor(-1.1556, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6158, dtype=torch.float64) delta_t tensor(-0.0885, dtype=torch.float64)
15 gae_duplicate tensor(-1.1704, dtype=torch.float64) tensor(0.6459, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8316, dtype=torch.float64) delta_t tensor(0.1310, dtype=torch.float64)
14 gae_duplicate tensor(0.0576, dtype=torch.float64) tensor(-1.3280, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8320, dtype=torch.float64) delta_t tensor(0.1365, dtype=torch.float64)
13 gae_duplicate tensor(0.0991, dtype=torch.float64) tensor(-1.8521, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8324, dtype=torch.float64) delta_t tensor(0.1421, dtype=torch.float64)
12 gae_duplicate tensor(0.0995, dtype=torch.float64) tensor(-2.1704, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8328, dtype=torch.float64) delta_t tensor(0.1794, dtype=torch.float64)
11 gae_duplicate tensor(0.1426, dtype=torch.float64) tensor(-2.0775, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(0.2295, dtype=torch.float64)
10 gae_duplicate tensor(-0.0484, dtype=torch.float64) tensor(-3.2938, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4459, dtype=torch.float64) delta_t tensor(-0.1902, dtype=torch.float64)
9 gae_duplicate tensor(-0.2823, dtype=torch.float64) tensor(1.7636, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1186, dtype=torch.float64) delta_t tensor(0.3490, dtype=torch.float64)
8 gae_duplicate tensor(0.0935, dtype=torch.float64) tensor(-3.1018, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1896, dtype=torch.float64) delta_t tensor(-0.4908, dtype=torch.float64)
7 gae_duplicate tensor(-0.8218, dtype=torch.float64) tensor(4.5544, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0924, dtype=torch.float64) delta_t tensor(0.1606, dtype=torch.float64)
6 gae_duplicate tensor(-0.8352, dtype=torch.float64) tensor(-1.2732, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3590, dtype=torch.float64) delta_t tensor(0.0244, dtype=torch.float64)
5 gae_duplicate tensor(-0.4933, dtype=torch.float64) tensor(-0.2037, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9546, dtype=torch.float64) delta_t tensor(-0.4434, dtype=torch.float64)
4 gae_duplicate tensor(-1.2492, dtype=torch.float64) tensor(5.7775, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5275, dtype=torch.float64) delta_t tensor(0.0809, dtype=torch.float64)
3 gae_duplicate tensor(-0.3909, dtype=torch.float64) tensor(-0.3660, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3646, dtype=torch.float64) delta_t tensor(-0.0230, dtype=torch.float64)
2 gae_duplicate tensor(-0.9366, dtype=torch.float64) tensor(0.7032, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:271.29132080078125
value loss:21.724336624145508
entropies:215.54835510253906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.102209806442261 seconds
19 rew tensor(0.8302, dtype=torch.float64) delta_t tensor(0.1421, dtype=torch.float64)
19 gae_duplicate tensor(0.0160, dtype=torch.float64) tensor(-1.9304, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8306, dtype=torch.float64) delta_t tensor(0.0930, dtype=torch.float64)
18 gae_duplicate tensor(0.0544, dtype=torch.float64) tensor(-1.3095, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8310, dtype=torch.float64) delta_t tensor(0.1662, dtype=torch.float64)
17 gae_duplicate tensor(0.1133, dtype=torch.float64) tensor(-1.9372, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8314, dtype=torch.float64) delta_t tensor(0.1849, dtype=torch.float64)
16 gae_duplicate tensor(0.0595, dtype=torch.float64) tensor(-2.2967, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8318, dtype=torch.float64) delta_t tensor(0.1099, dtype=torch.float64)
15 gae_duplicate tensor(0.1111, dtype=torch.float64) tensor(-1.4570, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8322, dtype=torch.float64) delta_t tensor(0.1216, dtype=torch.float64)
14 gae_duplicate tensor(0.1115, dtype=torch.float64) tensor(-1.3959, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8326, dtype=torch.float64) delta_t tensor(0.1516, dtype=torch.float64)
13 gae_duplicate tensor(0.1119, dtype=torch.float64) tensor(-2.3480, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7618, dtype=torch.float64) delta_t tensor(0.1706, dtype=torch.float64)
12 gae_duplicate tensor(0.1094, dtype=torch.float64) tensor(-2.3041, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6897, dtype=torch.float64) delta_t tensor(0.0505, dtype=torch.float64)
11 gae_duplicate tensor(-0.3747, dtype=torch.float64) tensor(-1.1210, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5855, dtype=torch.float64) delta_t tensor(0.1117, dtype=torch.float64)
10 gae_duplicate tensor(-0.2053, dtype=torch.float64) tensor(-1.3547, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3614, dtype=torch.float64) delta_t tensor(-0.2717, dtype=torch.float64)
9 gae_duplicate tensor(-0.5250, dtype=torch.float64) tensor(3.8570, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0945, dtype=torch.float64) delta_t tensor(-0.0240, dtype=torch.float64)
8 gae_duplicate tensor(-1.1677, dtype=torch.float64) tensor(0.2725, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0878, dtype=torch.float64) delta_t tensor(-0.1864, dtype=torch.float64)
7 gae_duplicate tensor(-0.6614, dtype=torch.float64) tensor(2.0723, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9177, dtype=torch.float64) delta_t tensor(0.0266, dtype=torch.float64)
6 gae_duplicate tensor(-0.4066, dtype=torch.float64) tensor(-0.0700, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3595, dtype=torch.float64) delta_t tensor(0.0100, dtype=torch.float64)
5 gae_duplicate tensor(-0.3113, dtype=torch.float64) tensor(-0.0075, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6855, dtype=torch.float64) delta_t tensor(-0.1607, dtype=torch.float64)
4 gae_duplicate tensor(-1.0572, dtype=torch.float64) tensor(1.6655, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5863, dtype=torch.float64) delta_t tensor(-0.0394, dtype=torch.float64)
3 gae_duplicate tensor(-0.2518, dtype=torch.float64) tensor(0.8602, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3838, dtype=torch.float64) delta_t tensor(-0.3169, dtype=torch.float64)
2 gae_duplicate tensor(-1.0840, dtype=torch.float64) tensor(3.7746, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:142.34918212890625
value loss:15.361446380615234
entropies:215.21304321289062
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.98952317237854 seconds
19 rew tensor(0.8204, dtype=torch.float64) delta_t tensor(0.1422, dtype=torch.float64)
19 gae_duplicate tensor(-0.1378, dtype=torch.float64) tensor(-1.7127, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8003, dtype=torch.float64) delta_t tensor(0.1394, dtype=torch.float64)
18 gae_duplicate tensor(-0.0310, dtype=torch.float64) tensor(-1.9714, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7596, dtype=torch.float64) delta_t tensor(0.1690, dtype=torch.float64)
17 gae_duplicate tensor(-0.2649, dtype=torch.float64) tensor(-1.9532, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7087, dtype=torch.float64) delta_t tensor(-0.0155, dtype=torch.float64)
16 gae_duplicate tensor(-0.5982, dtype=torch.float64) tensor(-0.2508, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5962, dtype=torch.float64) delta_t tensor(-0.0740, dtype=torch.float64)
15 gae_duplicate tensor(-1.3950, dtype=torch.float64) tensor(0.8862, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8323, dtype=torch.float64) delta_t tensor(0.1612, dtype=torch.float64)
14 gae_duplicate tensor(-0.0517, dtype=torch.float64) tensor(-1.8301, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8327, dtype=torch.float64) delta_t tensor(0.2695, dtype=torch.float64)
13 gae_duplicate tensor(0.1248, dtype=torch.float64) tensor(-3.3138, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8331, dtype=torch.float64) delta_t tensor(0.2955, dtype=torch.float64)
12 gae_duplicate tensor(0.1347, dtype=torch.float64) tensor(-3.2444, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6387, dtype=torch.float64) delta_t tensor(0.1464, dtype=torch.float64)
11 gae_duplicate tensor(0.0813, dtype=torch.float64) tensor(-2.2162, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5772, dtype=torch.float64) delta_t tensor(0.1316, dtype=torch.float64)
10 gae_duplicate tensor(-0.0689, dtype=torch.float64) tensor(-1.9629, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2898, dtype=torch.float64) delta_t tensor(-0.3086, dtype=torch.float64)
9 gae_duplicate tensor(-1.3755, dtype=torch.float64) tensor(4.6156, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0951, dtype=torch.float64) delta_t tensor(-0.1216, dtype=torch.float64)
8 gae_duplicate tensor(-1.5885, dtype=torch.float64) tensor(1.4572, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0280, dtype=torch.float64) delta_t tensor(-0.1840, dtype=torch.float64)
7 gae_duplicate tensor(-0.5860, dtype=torch.float64) tensor(3.0722, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6770, dtype=torch.float64) delta_t tensor(0.4763, dtype=torch.float64)
6 gae_duplicate tensor(0.2378, dtype=torch.float64) tensor(-5.3759, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3069, dtype=torch.float64) delta_t tensor(0.0421, dtype=torch.float64)
5 gae_duplicate tensor(-1.3837, dtype=torch.float64) tensor(-0.1345, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6836, dtype=torch.float64) delta_t tensor(-0.1101, dtype=torch.float64)
4 gae_duplicate tensor(-0.6402, dtype=torch.float64) tensor(1.4778, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3981, dtype=torch.float64) delta_t tensor(0.1927, dtype=torch.float64)
3 gae_duplicate tensor(-0.1925, dtype=torch.float64) tensor(-2.6811, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2662, dtype=torch.float64) delta_t tensor(-0.1143, dtype=torch.float64)
2 gae_duplicate tensor(-0.5980, dtype=torch.float64) tensor(1.4932, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:452.4762878417969
value loss:30.13431167602539
entropies:215.19602966308594
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2422.5542)
ToM Target loss= tensor(1806.4182)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.73581600189209 seconds
19 rew tensor(0.8306, dtype=torch.float64) delta_t tensor(0.1274, dtype=torch.float64)
19 gae_duplicate tensor(-0.0059, dtype=torch.float64) tensor(-1.3798, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8309, dtype=torch.float64) delta_t tensor(0.1391, dtype=torch.float64)
18 gae_duplicate tensor(0.0252, dtype=torch.float64) tensor(-1.8367, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8313, dtype=torch.float64) delta_t tensor(0.2196, dtype=torch.float64)
17 gae_duplicate tensor(0.1052, dtype=torch.float64) tensor(-3.1552, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8317, dtype=torch.float64) delta_t tensor(0.1144, dtype=torch.float64)
16 gae_duplicate tensor(0.0077, dtype=torch.float64) tensor(-1.4940, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8321, dtype=torch.float64) delta_t tensor(0.1049, dtype=torch.float64)
15 gae_duplicate tensor(0.0743, dtype=torch.float64) tensor(-1.6839, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8325, dtype=torch.float64) delta_t tensor(0.1136, dtype=torch.float64)
14 gae_duplicate tensor(0.0759, dtype=torch.float64) tensor(-1.6529, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8329, dtype=torch.float64) delta_t tensor(0.1101, dtype=torch.float64)
13 gae_duplicate tensor(0.0828, dtype=torch.float64) tensor(-1.2695, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8333, dtype=torch.float64) delta_t tensor(0.1320, dtype=torch.float64)
12 gae_duplicate tensor(0.0950, dtype=torch.float64) tensor(-1.5152, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8337, dtype=torch.float64) delta_t tensor(0.1472, dtype=torch.float64)
11 gae_duplicate tensor(0.1255, dtype=torch.float64) tensor(-2.0321, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8128, dtype=torch.float64) delta_t tensor(0.1774, dtype=torch.float64)
10 gae_duplicate tensor(-0.0875, dtype=torch.float64) tensor(-3.0033, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5070, dtype=torch.float64) delta_t tensor(0.0650, dtype=torch.float64)
9 gae_duplicate tensor(-0.1984, dtype=torch.float64) tensor(-1.1334, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2810, dtype=torch.float64) delta_t tensor(0.2788, dtype=torch.float64)
8 gae_duplicate tensor(-0.3193, dtype=torch.float64) tensor(-3.4635, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1587, dtype=torch.float64) delta_t tensor(-0.6795, dtype=torch.float64)
7 gae_duplicate tensor(-1.3501, dtype=torch.float64) tensor(9.7593, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8057, dtype=torch.float64) delta_t tensor(0.3847, dtype=torch.float64)
6 gae_duplicate tensor(0.1127, dtype=torch.float64) tensor(-3.8959, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0733, dtype=torch.float64) delta_t tensor(0.3229, dtype=torch.float64)
5 gae_duplicate tensor(-0.0009, dtype=torch.float64) tensor(-4.2395, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8322, dtype=torch.float64) delta_t tensor(-0.2038, dtype=torch.float64)
4 gae_duplicate tensor(-0.6395, dtype=torch.float64) tensor(2.2323, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5675, dtype=torch.float64) delta_t tensor(0.0297, dtype=torch.float64)
3 gae_duplicate tensor(-0.2228, dtype=torch.float64) tensor(-0.1672, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1597, dtype=torch.float64) delta_t tensor(-0.0491, dtype=torch.float64)
2 gae_duplicate tensor(-0.9809, dtype=torch.float64) tensor(0.4771, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:661.6746215820312
value loss:17.07468605041504
entropies:214.6814727783203
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.038270950317383 seconds
19 rew tensor(0.8200, dtype=torch.float64) delta_t tensor(0.1073, dtype=torch.float64)
19 gae_duplicate tensor(0.0555, dtype=torch.float64) tensor(-1.2592, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8099, dtype=torch.float64) delta_t tensor(0.0467, dtype=torch.float64)
18 gae_duplicate tensor(-0.0840, dtype=torch.float64) tensor(-0.7415, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7789, dtype=torch.float64) delta_t tensor(0.1206, dtype=torch.float64)
17 gae_duplicate tensor(-0.1593, dtype=torch.float64) tensor(-1.3252, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7375, dtype=torch.float64) delta_t tensor(-0.0288, dtype=torch.float64)
16 gae_duplicate tensor(-0.5406, dtype=torch.float64) tensor(-0.3279, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6542, dtype=torch.float64) delta_t tensor(-0.0929, dtype=torch.float64)
15 gae_duplicate tensor(-1.0487, dtype=torch.float64) tensor(2.1294, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8321, dtype=torch.float64) delta_t tensor(0.0847, dtype=torch.float64)
14 gae_duplicate tensor(-0.0359, dtype=torch.float64) tensor(-0.8175, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8325, dtype=torch.float64) delta_t tensor(0.0941, dtype=torch.float64)
13 gae_duplicate tensor(0.0666, dtype=torch.float64) tensor(-1.3201, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8329, dtype=torch.float64) delta_t tensor(0.1049, dtype=torch.float64)
12 gae_duplicate tensor(0.0829, dtype=torch.float64) tensor(-1.3598, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8333, dtype=torch.float64) delta_t tensor(0.1625, dtype=torch.float64)
11 gae_duplicate tensor(0.1134, dtype=torch.float64) tensor(-1.6791, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7849, dtype=torch.float64) delta_t tensor(0.1186, dtype=torch.float64)
10 gae_duplicate tensor(0.0539, dtype=torch.float64) tensor(-1.6018, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4788, dtype=torch.float64) delta_t tensor(-0.2066, dtype=torch.float64)
9 gae_duplicate tensor(-0.5836, dtype=torch.float64) tensor(2.5853, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2839, dtype=torch.float64) delta_t tensor(0.2792, dtype=torch.float64)
8 gae_duplicate tensor(-0.5257, dtype=torch.float64) tensor(-2.4360, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0887, dtype=torch.float64) delta_t tensor(-0.3094, dtype=torch.float64)
7 gae_duplicate tensor(-0.6263, dtype=torch.float64) tensor(3.2172, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9211, dtype=torch.float64) delta_t tensor(0.2183, dtype=torch.float64)
6 gae_duplicate tensor(-0.5035, dtype=torch.float64) tensor(-1.6105, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2761, dtype=torch.float64) delta_t tensor(0.0818, dtype=torch.float64)
5 gae_duplicate tensor(-0.3787, dtype=torch.float64) tensor(-1.8228, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8119, dtype=torch.float64) delta_t tensor(-0.2878, dtype=torch.float64)
4 gae_duplicate tensor(-0.9542, dtype=torch.float64) tensor(4.1165, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4875, dtype=torch.float64) delta_t tensor(0.0812, dtype=torch.float64)
3 gae_duplicate tensor(-0.1971, dtype=torch.float64) tensor(-0.5067, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2724, dtype=torch.float64) delta_t tensor(-0.3729, dtype=torch.float64)
2 gae_duplicate tensor(-0.8352, dtype=torch.float64) tensor(4.4636, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-27.884004592895508
value loss:17.386240005493164
entropies:214.14743041992188
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.791738986968994 seconds
19 rew tensor(0.8304, dtype=torch.float64) delta_t tensor(0.1542, dtype=torch.float64)
19 gae_duplicate tensor(-0.0192, dtype=torch.float64) tensor(-1.8933, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8308, dtype=torch.float64) delta_t tensor(0.1116, dtype=torch.float64)
18 gae_duplicate tensor(0.0216, dtype=torch.float64) tensor(-1.4749, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8311, dtype=torch.float64) delta_t tensor(0.1997, dtype=torch.float64)
17 gae_duplicate tensor(0.1229, dtype=torch.float64) tensor(-3.0316, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8315, dtype=torch.float64) delta_t tensor(0.1520, dtype=torch.float64)
16 gae_duplicate tensor(0.0129, dtype=torch.float64) tensor(-1.7907, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8319, dtype=torch.float64) delta_t tensor(0.0891, dtype=torch.float64)
15 gae_duplicate tensor(0.0489, dtype=torch.float64) tensor(-1.3062, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8323, dtype=torch.float64) delta_t tensor(0.0761, dtype=torch.float64)
14 gae_duplicate tensor(0.0493, dtype=torch.float64) tensor(-1.1376, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8327, dtype=torch.float64) delta_t tensor(0.0830, dtype=torch.float64)
13 gae_duplicate tensor(0.0447, dtype=torch.float64) tensor(-1.2528, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8330, dtype=torch.float64) delta_t tensor(0.1204, dtype=torch.float64)
12 gae_duplicate tensor(0.0458, dtype=torch.float64) tensor(-1.5865, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8025, dtype=torch.float64) delta_t tensor(0.1335, dtype=torch.float64)
11 gae_duplicate tensor(0.0805, dtype=torch.float64) tensor(-1.7454, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6777, dtype=torch.float64) delta_t tensor(0.0549, dtype=torch.float64)
10 gae_duplicate tensor(-0.1719, dtype=torch.float64) tensor(-0.9324, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4128, dtype=torch.float64) delta_t tensor(-0.2935, dtype=torch.float64)
9 gae_duplicate tensor(-0.6531, dtype=torch.float64) tensor(3.6655, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1968, dtype=torch.float64) delta_t tensor(0.2312, dtype=torch.float64)
8 gae_duplicate tensor(-0.7472, dtype=torch.float64) tensor(-1.9428, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0692, dtype=torch.float64) delta_t tensor(-0.2001, dtype=torch.float64)
7 gae_duplicate tensor(-0.7075, dtype=torch.float64) tensor(2.3705, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0258, dtype=torch.float64) delta_t tensor(0.2069, dtype=torch.float64)
6 gae_duplicate tensor(-0.0063, dtype=torch.float64) tensor(-2.0938, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4079, dtype=torch.float64) delta_t tensor(0.1036, dtype=torch.float64)
5 gae_duplicate tensor(-0.2186, dtype=torch.float64) tensor(-1.6138, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7983, dtype=torch.float64) delta_t tensor(-0.2890, dtype=torch.float64)
4 gae_duplicate tensor(-0.6842, dtype=torch.float64) tensor(4.4859, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5228, dtype=torch.float64) delta_t tensor(0.0146, dtype=torch.float64)
3 gae_duplicate tensor(-0.2457, dtype=torch.float64) tensor(-0.2812, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3093, dtype=torch.float64) delta_t tensor(-0.2635, dtype=torch.float64)
2 gae_duplicate tensor(-0.9649, dtype=torch.float64) tensor(2.4294, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:290.28765869140625
value loss:14.824399948120117
entropies:213.61172485351562
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.875845909118652 seconds
19 rew tensor(0.8004, dtype=torch.float64) delta_t tensor(0.0656, dtype=torch.float64)
19 gae_duplicate tensor(-0.0784, dtype=torch.float64) tensor(-0.6837, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8008, dtype=torch.float64) delta_t tensor(0.0868, dtype=torch.float64)
18 gae_duplicate tensor(-0.0531, dtype=torch.float64) tensor(-1.0187, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7603, dtype=torch.float64) delta_t tensor(0.1349, dtype=torch.float64)
17 gae_duplicate tensor(-0.2490, dtype=torch.float64) tensor(-1.6200, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6892, dtype=torch.float64) delta_t tensor(0.0335, dtype=torch.float64)
16 gae_duplicate tensor(-0.6965, dtype=torch.float64) tensor(-0.4010, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5670, dtype=torch.float64) delta_t tensor(-0.1543, dtype=torch.float64)
15 gae_duplicate tensor(-1.4338, dtype=torch.float64) tensor(2.0539, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8326, dtype=torch.float64) delta_t tensor(0.1196, dtype=torch.float64)
14 gae_duplicate tensor(0.0629, dtype=torch.float64) tensor(-1.4067, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8330, dtype=torch.float64) delta_t tensor(0.1565, dtype=torch.float64)
13 gae_duplicate tensor(0.0553, dtype=torch.float64) tensor(-1.7446, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8333, dtype=torch.float64) delta_t tensor(0.2013, dtype=torch.float64)
12 gae_duplicate tensor(0.0524, dtype=torch.float64) tensor(-2.4876, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6910, dtype=torch.float64) delta_t tensor(0.0817, dtype=torch.float64)
11 gae_duplicate tensor(-0.2952, dtype=torch.float64) tensor(-0.9743, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5917, dtype=torch.float64) delta_t tensor(0.0683, dtype=torch.float64)
10 gae_duplicate tensor(-0.1662, dtype=torch.float64) tensor(-0.7728, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3239, dtype=torch.float64) delta_t tensor(-0.1178, dtype=torch.float64)
9 gae_duplicate tensor(-0.5634, dtype=torch.float64) tensor(1.8109, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0044, dtype=torch.float64) delta_t tensor(-0.1088, dtype=torch.float64)
8 gae_duplicate tensor(-1.1041, dtype=torch.float64) tensor(1.2068, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3599, dtype=torch.float64) delta_t tensor(-0.3965, dtype=torch.float64)
7 gae_duplicate tensor(-1.4311, dtype=torch.float64) tensor(4.6196, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9113, dtype=torch.float64) delta_t tensor(0.1198, dtype=torch.float64)
6 gae_duplicate tensor(-0.7454, dtype=torch.float64) tensor(-0.3247, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4109, dtype=torch.float64) delta_t tensor(-0.1438, dtype=torch.float64)
5 gae_duplicate tensor(-1.5443, dtype=torch.float64) tensor(3.2073, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7949, dtype=torch.float64) delta_t tensor(-0.3180, dtype=torch.float64)
4 gae_duplicate tensor(-0.6821, dtype=torch.float64) tensor(3.9084, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5403, dtype=torch.float64) delta_t tensor(0.0090, dtype=torch.float64)
3 gae_duplicate tensor(-0.5619, dtype=torch.float64) tensor(0.4513, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1964, dtype=torch.float64) delta_t tensor(-0.3156, dtype=torch.float64)
2 gae_duplicate tensor(-1.4302, dtype=torch.float64) tensor(4.8594, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-422.9613037109375
value loss:30.6578369140625
entropies:213.09332275390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.053325653076172 seconds
19 rew tensor(0.8112, dtype=torch.float64) delta_t tensor(0.0871, dtype=torch.float64)
19 gae_duplicate tensor(-0.1504, dtype=torch.float64) tensor(-1.1525, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7807, dtype=torch.float64) delta_t tensor(0.0817, dtype=torch.float64)
18 gae_duplicate tensor(-0.0754, dtype=torch.float64) tensor(-1.1328, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7295, dtype=torch.float64) delta_t tensor(0.0827, dtype=torch.float64)
17 gae_duplicate tensor(-0.2880, dtype=torch.float64) tensor(-1.0303, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6580, dtype=torch.float64) delta_t tensor(-0.0582, dtype=torch.float64)
16 gae_duplicate tensor(-0.6296, dtype=torch.float64) tensor(0.3899, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4633, dtype=torch.float64) delta_t tensor(-0.2383, dtype=torch.float64)
15 gae_duplicate tensor(-1.3811, dtype=torch.float64) tensor(4.0048, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5683, dtype=torch.float64) delta_t tensor(-0.1565, dtype=torch.float64)
14 gae_duplicate tensor(-1.4822, dtype=torch.float64) tensor(1.3976, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8333, dtype=torch.float64) delta_t tensor(0.1164, dtype=torch.float64)
13 gae_duplicate tensor(0.0270, dtype=torch.float64) tensor(-1.1482, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8336, dtype=torch.float64) delta_t tensor(0.1654, dtype=torch.float64)
12 gae_duplicate tensor(0.0421, dtype=torch.float64) tensor(-1.9274, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7824, dtype=torch.float64) delta_t tensor(0.1769, dtype=torch.float64)
11 gae_duplicate tensor(0.0609, dtype=torch.float64) tensor(-1.8150, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6697, dtype=torch.float64) delta_t tensor(0.1070, dtype=torch.float64)
10 gae_duplicate tensor(-0.0036, dtype=torch.float64) tensor(-1.9388, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0655, dtype=torch.float64) delta_t tensor(-0.5603, dtype=torch.float64)
9 gae_duplicate tensor(-2.4154, dtype=torch.float64) tensor(6.7479, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0414, dtype=torch.float64) delta_t tensor(-0.1531, dtype=torch.float64)
8 gae_duplicate tensor(-1.4833, dtype=torch.float64) tensor(1.7421, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1630, dtype=torch.float64) delta_t tensor(-0.4762, dtype=torch.float64)
7 gae_duplicate tensor(-1.5574, dtype=torch.float64) tensor(5.0434, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1059, dtype=torch.float64) delta_t tensor(-0.3006, dtype=torch.float64)
6 gae_duplicate tensor(-3.1982, dtype=torch.float64) tensor(6.7103, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6433, dtype=torch.float64) delta_t tensor(-0.5492, dtype=torch.float64)
5 gae_duplicate tensor(-2.9393, dtype=torch.float64) tensor(7.7990, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8820, dtype=torch.float64) delta_t tensor(-0.6467, dtype=torch.float64)
4 gae_duplicate tensor(-1.0918, dtype=torch.float64) tensor(9.0326, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6465, dtype=torch.float64) delta_t tensor(-0.2388, dtype=torch.float64)
3 gae_duplicate tensor(-0.6957, dtype=torch.float64) tensor(3.2381, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4644, dtype=torch.float64) delta_t tensor(-0.0909, dtype=torch.float64)
2 gae_duplicate tensor(-0.4510, dtype=torch.float64) tensor(1.3342, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1380.8232421875
value loss:66.61383056640625
entropies:212.2913360595703
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2409.9966)
ToM Target loss= tensor(1806.2737)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.089329242706299 seconds
19 rew tensor(0.8213, dtype=torch.float64) delta_t tensor(0.0757, dtype=torch.float64)
19 gae_duplicate tensor(-0.0835, dtype=torch.float64) tensor(-0.9636, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8004, dtype=torch.float64) delta_t tensor(0.0621, dtype=torch.float64)
18 gae_duplicate tensor(-0.1041, dtype=torch.float64) tensor(-0.8231, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7690, dtype=torch.float64) delta_t tensor(0.1094, dtype=torch.float64)
17 gae_duplicate tensor(-0.2474, dtype=torch.float64) tensor(-1.5724, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7163, dtype=torch.float64) delta_t tensor(0.0906, dtype=torch.float64)
16 gae_duplicate tensor(-0.6624, dtype=torch.float64) tensor(-1.6062, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6106, dtype=torch.float64) delta_t tensor(-0.1238, dtype=torch.float64)
15 gae_duplicate tensor(-1.2694, dtype=torch.float64) tensor(1.7691, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8334, dtype=torch.float64) delta_t tensor(0.1019, dtype=torch.float64)
14 gae_duplicate tensor(-0.0013, dtype=torch.float64) tensor(-1.0433, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8338, dtype=torch.float64) delta_t tensor(0.1031, dtype=torch.float64)
13 gae_duplicate tensor(-0.0091, dtype=torch.float64) tensor(-1.0238, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8342, dtype=torch.float64) delta_t tensor(0.1452, dtype=torch.float64)
12 gae_duplicate tensor(-0.0098, dtype=torch.float64) tensor(-1.7699, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8345, dtype=torch.float64) delta_t tensor(0.1845, dtype=torch.float64)
11 gae_duplicate tensor(0.0538, dtype=torch.float64) tensor(-1.8683, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7419, dtype=torch.float64) delta_t tensor(0.1067, dtype=torch.float64)
10 gae_duplicate tensor(-0.1458, dtype=torch.float64) tensor(-1.0834, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4344, dtype=torch.float64) delta_t tensor(-0.0561, dtype=torch.float64)
9 gae_duplicate tensor(-0.5332, dtype=torch.float64) tensor(0.1593, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2176, dtype=torch.float64) delta_t tensor(0.3191, dtype=torch.float64)
8 gae_duplicate tensor(-0.3963, dtype=torch.float64) tensor(-3.8305, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3688, dtype=torch.float64) delta_t tensor(-0.5335, dtype=torch.float64)
7 gae_duplicate tensor(-1.3446, dtype=torch.float64) tensor(5.3292, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0328, dtype=torch.float64) delta_t tensor(0.0647, dtype=torch.float64)
6 gae_duplicate tensor(-0.5564, dtype=torch.float64) tensor(-0.5025, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4055, dtype=torch.float64) delta_t tensor(0.0013, dtype=torch.float64)
5 gae_duplicate tensor(-0.6015, dtype=torch.float64) tensor(-0.9410, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8599, dtype=torch.float64) delta_t tensor(-0.3647, dtype=torch.float64)
4 gae_duplicate tensor(-1.3939, dtype=torch.float64) tensor(3.7778, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5277, dtype=torch.float64) delta_t tensor(-0.0087, dtype=torch.float64)
3 gae_duplicate tensor(-0.2580, dtype=torch.float64) tensor(0.3860, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1963, dtype=torch.float64) delta_t tensor(-0.5865, dtype=torch.float64)
2 gae_duplicate tensor(-1.1998, dtype=torch.float64) tensor(6.2008, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-59.35625457763672
value loss:26.228137969970703
entropies:210.92645263671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.17181396484375 seconds
19 rew tensor(0.8316, dtype=torch.float64) delta_t tensor(0.1129, dtype=torch.float64)
19 gae_duplicate tensor(-0.0265, dtype=torch.float64) tensor(-1.5097, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8320, dtype=torch.float64) delta_t tensor(0.1533, dtype=torch.float64)
18 gae_duplicate tensor(0.0200, dtype=torch.float64) tensor(-1.9827, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8324, dtype=torch.float64) delta_t tensor(0.1978, dtype=torch.float64)
17 gae_duplicate tensor(0.0980, dtype=torch.float64) tensor(-3.0475, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8327, dtype=torch.float64) delta_t tensor(0.1758, dtype=torch.float64)
16 gae_duplicate tensor(0.0524, dtype=torch.float64) tensor(-2.6300, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8331, dtype=torch.float64) delta_t tensor(0.0622, dtype=torch.float64)
15 gae_duplicate tensor(-0.0192, dtype=torch.float64) tensor(-0.9572, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8335, dtype=torch.float64) delta_t tensor(0.0744, dtype=torch.float64)
14 gae_duplicate tensor(-0.0188, dtype=torch.float64) tensor(-0.8916, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8338, dtype=torch.float64) delta_t tensor(0.0751, dtype=torch.float64)
13 gae_duplicate tensor(-0.0122, dtype=torch.float64) tensor(-1.1398, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8342, dtype=torch.float64) delta_t tensor(0.0766, dtype=torch.float64)
12 gae_duplicate tensor(-0.0119, dtype=torch.float64) tensor(-0.8107, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8346, dtype=torch.float64) delta_t tensor(0.1331, dtype=torch.float64)
11 gae_duplicate tensor(0.0169, dtype=torch.float64) tensor(-1.9667, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8349, dtype=torch.float64) delta_t tensor(0.1473, dtype=torch.float64)
10 gae_duplicate tensor(0.0389, dtype=torch.float64) tensor(-2.0769, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4743, dtype=torch.float64) delta_t tensor(-0.1464, dtype=torch.float64)
9 gae_duplicate tensor(-0.3418, dtype=torch.float64) tensor(1.7905, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3003, dtype=torch.float64) delta_t tensor(0.3242, dtype=torch.float64)
8 gae_duplicate tensor(-0.5006, dtype=torch.float64) tensor(-3.6850, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0464, dtype=torch.float64) delta_t tensor(-0.4316, dtype=torch.float64)
7 gae_duplicate tensor(-0.6739, dtype=torch.float64) tensor(4.8941, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7922, dtype=torch.float64) delta_t tensor(0.3220, dtype=torch.float64)
6 gae_duplicate tensor(0.0074, dtype=torch.float64) tensor(-3.6307, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1744, dtype=torch.float64) delta_t tensor(0.0495, dtype=torch.float64)
5 gae_duplicate tensor(-0.0703, dtype=torch.float64) tensor(-0.6655, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7118, dtype=torch.float64) delta_t tensor(-0.0788, dtype=torch.float64)
4 gae_duplicate tensor(-0.5804, dtype=torch.float64) tensor(1.0923, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4093, dtype=torch.float64) delta_t tensor(0.1406, dtype=torch.float64)
3 gae_duplicate tensor(-0.0658, dtype=torch.float64) tensor(-1.4679, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2711, dtype=torch.float64) delta_t tensor(-0.0630, dtype=torch.float64)
2 gae_duplicate tensor(-0.8753, dtype=torch.float64) tensor(-0.2559, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:644.0274047851562
value loss:13.488720893859863
entropies:210.2804412841797
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.999559164047241 seconds
19 rew tensor(0.8321, dtype=torch.float64) delta_t tensor(0.0942, dtype=torch.float64)
19 gae_duplicate tensor(-0.0366, dtype=torch.float64) tensor(-0.7877, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8324, dtype=torch.float64) delta_t tensor(0.1595, dtype=torch.float64)
18 gae_duplicate tensor(0.0471, dtype=torch.float64) tensor(-1.9120, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8328, dtype=torch.float64) delta_t tensor(0.1840, dtype=torch.float64)
17 gae_duplicate tensor(0.0932, dtype=torch.float64) tensor(-2.0895, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8331, dtype=torch.float64) delta_t tensor(0.1886, dtype=torch.float64)
16 gae_duplicate tensor(-0.0200, dtype=torch.float64) tensor(-2.5824, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8335, dtype=torch.float64) delta_t tensor(0.0748, dtype=torch.float64)
15 gae_duplicate tensor(-0.0057, dtype=torch.float64) tensor(-1.2271, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8339, dtype=torch.float64) delta_t tensor(0.0943, dtype=torch.float64)
14 gae_duplicate tensor(-0.0053, dtype=torch.float64) tensor(-1.0942, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8342, dtype=torch.float64) delta_t tensor(0.2402, dtype=torch.float64)
13 gae_duplicate tensor(0.0551, dtype=torch.float64) tensor(-2.3136, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7660, dtype=torch.float64) delta_t tensor(0.1967, dtype=torch.float64)
12 gae_duplicate tensor(0.0427, dtype=torch.float64) tensor(-3.3220, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6551, dtype=torch.float64) delta_t tensor(0.2436, dtype=torch.float64)
11 gae_duplicate tensor(0.0879, dtype=torch.float64) tensor(-2.8352, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6343, dtype=torch.float64) delta_t tensor(0.1657, dtype=torch.float64)
10 gae_duplicate tensor(0.0012, dtype=torch.float64) tensor(-2.1103, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2827, dtype=torch.float64) delta_t tensor(-0.2373, dtype=torch.float64)
9 gae_duplicate tensor(-0.7993, dtype=torch.float64) tensor(1.6080, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1682, dtype=torch.float64) delta_t tensor(0.0866, dtype=torch.float64)
8 gae_duplicate tensor(-0.8758, dtype=torch.float64) tensor(-0.6822, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3766, dtype=torch.float64) delta_t tensor(-0.6432, dtype=torch.float64)
7 gae_duplicate tensor(-1.1440, dtype=torch.float64) tensor(5.6405, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8268, dtype=torch.float64) delta_t tensor(0.0428, dtype=torch.float64)
6 gae_duplicate tensor(-0.5390, dtype=torch.float64) tensor(0.8097, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2153, dtype=torch.float64) delta_t tensor(0.0039, dtype=torch.float64)
5 gae_duplicate tensor(-0.2582, dtype=torch.float64) tensor(-0.0052, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6850, dtype=torch.float64) delta_t tensor(-0.2187, dtype=torch.float64)
4 gae_duplicate tensor(-0.5492, dtype=torch.float64) tensor(2.6734, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7341, dtype=torch.float64) delta_t tensor(-0.2162, dtype=torch.float64)
3 gae_duplicate tensor(-0.5167, dtype=torch.float64) tensor(2.3779, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3065, dtype=torch.float64) delta_t tensor(-0.0640, dtype=torch.float64)
2 gae_duplicate tensor(-0.5955, dtype=torch.float64) tensor(0.9500, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:210.7088623046875
value loss:17.757492065429688
entropies:209.76715087890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.944134950637817 seconds
19 rew tensor(0.8319, dtype=torch.float64) delta_t tensor(0.1349, dtype=torch.float64)
19 gae_duplicate tensor(-0.0709, dtype=torch.float64) tensor(-1.3715, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8323, dtype=torch.float64) delta_t tensor(0.0958, dtype=torch.float64)
18 gae_duplicate tensor(0.0345, dtype=torch.float64) tensor(-1.2315, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8326, dtype=torch.float64) delta_t tensor(0.1925, dtype=torch.float64)
17 gae_duplicate tensor(0.0828, dtype=torch.float64) tensor(-2.8900, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8330, dtype=torch.float64) delta_t tensor(0.0843, dtype=torch.float64)
16 gae_duplicate tensor(-0.0119, dtype=torch.float64) tensor(-1.3004, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8333, dtype=torch.float64) delta_t tensor(0.0802, dtype=torch.float64)
15 gae_duplicate tensor(0.0402, dtype=torch.float64) tensor(-1.1153, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8337, dtype=torch.float64) delta_t tensor(0.0747, dtype=torch.float64)
14 gae_duplicate tensor(0.0406, dtype=torch.float64) tensor(-1.3355, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8340, dtype=torch.float64) delta_t tensor(0.0646, dtype=torch.float64)
13 gae_duplicate tensor(0.0410, dtype=torch.float64) tensor(-0.6779, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8344, dtype=torch.float64) delta_t tensor(0.0811, dtype=torch.float64)
12 gae_duplicate tensor(0.0414, dtype=torch.float64) tensor(-0.8533, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8348, dtype=torch.float64) delta_t tensor(0.1166, dtype=torch.float64)
11 gae_duplicate tensor(0.0418, dtype=torch.float64) tensor(-1.3154, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.1693, dtype=torch.float64)
10 gae_duplicate tensor(0.0588, dtype=torch.float64) tensor(-2.2970, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4746, dtype=torch.float64) delta_t tensor(-0.2396, dtype=torch.float64)
9 gae_duplicate tensor(-0.3063, dtype=torch.float64) tensor(2.4429, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2050, dtype=torch.float64) delta_t tensor(0.2829, dtype=torch.float64)
8 gae_duplicate tensor(0.0794, dtype=torch.float64) tensor(-2.5358, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0303, dtype=torch.float64) delta_t tensor(-0.4871, dtype=torch.float64)
7 gae_duplicate tensor(-0.7879, dtype=torch.float64) tensor(5.4869, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9296, dtype=torch.float64) delta_t tensor(0.1811, dtype=torch.float64)
6 gae_duplicate tensor(-0.1201, dtype=torch.float64) tensor(-1.8879, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1878, dtype=torch.float64) delta_t tensor(0.1372, dtype=torch.float64)
5 gae_duplicate tensor(-0.4632, dtype=torch.float64) tensor(-1.3511, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7635, dtype=torch.float64) delta_t tensor(-0.1932, dtype=torch.float64)
4 gae_duplicate tensor(-0.8539, dtype=torch.float64) tensor(2.1997, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4241, dtype=torch.float64) delta_t tensor(0.1096, dtype=torch.float64)
3 gae_duplicate tensor(-0.1862, dtype=torch.float64) tensor(-0.7495, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2309, dtype=torch.float64) delta_t tensor(-0.0787, dtype=torch.float64)
2 gae_duplicate tensor(-0.8417, dtype=torch.float64) tensor(1.2471, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:305.50537109375
value loss:13.258867263793945
entropies:209.86241149902344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.603704929351807 seconds
19 rew tensor(0.8319, dtype=torch.float64) delta_t tensor(0.1060, dtype=torch.float64)
19 gae_duplicate tensor(-0.0198, dtype=torch.float64) tensor(-1.3909, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8322, dtype=torch.float64) delta_t tensor(0.0753, dtype=torch.float64)
18 gae_duplicate tensor(0.0176, dtype=torch.float64) tensor(-0.9756, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8326, dtype=torch.float64) delta_t tensor(0.1145, dtype=torch.float64)
17 gae_duplicate tensor(0.0604, dtype=torch.float64) tensor(-1.4799, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8329, dtype=torch.float64) delta_t tensor(0.0521, dtype=torch.float64)
16 gae_duplicate tensor(-0.0291, dtype=torch.float64) tensor(-0.8810, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8333, dtype=torch.float64) delta_t tensor(0.0558, dtype=torch.float64)
15 gae_duplicate tensor(-0.0114, dtype=torch.float64) tensor(-0.7047, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8336, dtype=torch.float64) delta_t tensor(0.0580, dtype=torch.float64)
14 gae_duplicate tensor(0.0101, dtype=torch.float64) tensor(-0.6016, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8340, dtype=torch.float64) delta_t tensor(0.0917, dtype=torch.float64)
13 gae_duplicate tensor(0.0105, dtype=torch.float64) tensor(-1.3992, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8344, dtype=torch.float64) delta_t tensor(0.1071, dtype=torch.float64)
12 gae_duplicate tensor(0.0109, dtype=torch.float64) tensor(-1.2898, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7415, dtype=torch.float64) delta_t tensor(0.0233, dtype=torch.float64)
11 gae_duplicate tensor(-0.1796, dtype=torch.float64) tensor(-0.3976, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7015, dtype=torch.float64) delta_t tensor(0.1020, dtype=torch.float64)
10 gae_duplicate tensor(-0.1295, dtype=torch.float64) tensor(-1.4072, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3688, dtype=torch.float64) delta_t tensor(-0.2863, dtype=torch.float64)
9 gae_duplicate tensor(-0.6571, dtype=torch.float64) tensor(3.1869, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1120, dtype=torch.float64) delta_t tensor(0.2114, dtype=torch.float64)
8 gae_duplicate tensor(-0.9359, dtype=torch.float64) tensor(-2.7557, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2600, dtype=torch.float64) delta_t tensor(-0.2309, dtype=torch.float64)
7 gae_duplicate tensor(-1.3762, dtype=torch.float64) tensor(3.7918, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1910, dtype=torch.float64) delta_t tensor(-0.0572, dtype=torch.float64)
6 gae_duplicate tensor(-0.3486, dtype=torch.float64) tensor(0.9496, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5934, dtype=torch.float64) delta_t tensor(-0.3315, dtype=torch.float64)
5 gae_duplicate tensor(-0.9558, dtype=torch.float64) tensor(3.7128, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0515, dtype=torch.float64) delta_t tensor(-0.6115, dtype=torch.float64)
4 gae_duplicate tensor(-0.9394, dtype=torch.float64) tensor(9.2547, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6519, dtype=torch.float64) delta_t tensor(-0.1108, dtype=torch.float64)
3 gae_duplicate tensor(-0.4762, dtype=torch.float64) tensor(2.0026, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4151, dtype=torch.float64) delta_t tensor(-0.5726, dtype=torch.float64)
2 gae_duplicate tensor(-1.4391, dtype=torch.float64) tensor(6.3653, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-613.070556640625
value loss:21.05927276611328
entropies:209.81573486328125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2418.6809)
ToM Target loss= tensor(1807.0859)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.19599986076355 seconds
19 rew tensor(0.8319, dtype=torch.float64) delta_t tensor(0.2646, dtype=torch.float64)
19 gae_duplicate tensor(0.0131, dtype=torch.float64) tensor(-3.5166, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8322, dtype=torch.float64) delta_t tensor(0.0580, dtype=torch.float64)
18 gae_duplicate tensor(0.0263, dtype=torch.float64) tensor(-1.0009, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8326, dtype=torch.float64) delta_t tensor(0.1117, dtype=torch.float64)
17 gae_duplicate tensor(0.0815, dtype=torch.float64) tensor(-1.5206, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8329, dtype=torch.float64) delta_t tensor(0.0050, dtype=torch.float64)
16 gae_duplicate tensor(-0.0628, dtype=torch.float64) tensor(-0.3294, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8333, dtype=torch.float64) delta_t tensor(0.0563, dtype=torch.float64)
15 gae_duplicate tensor(0.0228, dtype=torch.float64) tensor(-0.6212, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8336, dtype=torch.float64) delta_t tensor(0.0526, dtype=torch.float64)
14 gae_duplicate tensor(0.0232, dtype=torch.float64) tensor(-0.6797, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8340, dtype=torch.float64) delta_t tensor(0.0598, dtype=torch.float64)
13 gae_duplicate tensor(0.0273, dtype=torch.float64) tensor(-0.5491, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8343, dtype=torch.float64) delta_t tensor(0.1148, dtype=torch.float64)
12 gae_duplicate tensor(0.0276, dtype=torch.float64) tensor(-1.4196, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7832, dtype=torch.float64) delta_t tensor(0.0972, dtype=torch.float64)
11 gae_duplicate tensor(0.0564, dtype=torch.float64) tensor(-1.2965, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6592, dtype=torch.float64) delta_t tensor(-0.0567, dtype=torch.float64)
10 gae_duplicate tensor(-0.2488, dtype=torch.float64) tensor(0.4115, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4133, dtype=torch.float64) delta_t tensor(-0.3193, dtype=torch.float64)
9 gae_duplicate tensor(-0.4708, dtype=torch.float64) tensor(3.9999, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2988, dtype=torch.float64) delta_t tensor(0.2423, dtype=torch.float64)
8 gae_duplicate tensor(-0.0476, dtype=torch.float64) tensor(-2.9088, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0832, dtype=torch.float64) delta_t tensor(-0.3273, dtype=torch.float64)
7 gae_duplicate tensor(-0.5027, dtype=torch.float64) tensor(4.0478, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9159, dtype=torch.float64) delta_t tensor(0.1427, dtype=torch.float64)
6 gae_duplicate tensor(0.0281, dtype=torch.float64) tensor(-1.5456, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2778, dtype=torch.float64) delta_t tensor(-0.0343, dtype=torch.float64)
5 gae_duplicate tensor(-0.2568, dtype=torch.float64) tensor(0.1290, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7634, dtype=torch.float64) delta_t tensor(-0.3149, dtype=torch.float64)
4 gae_duplicate tensor(-0.7904, dtype=torch.float64) tensor(3.8690, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5781, dtype=torch.float64) delta_t tensor(-0.0584, dtype=torch.float64)
3 gae_duplicate tensor(-0.3709, dtype=torch.float64) tensor(0.8533, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2899, dtype=torch.float64) delta_t tensor(-0.1694, dtype=torch.float64)
2 gae_duplicate tensor(-0.7568, dtype=torch.float64) tensor(2.0537, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-36.82201385498047
value loss:8.56750774383545
entropies:209.34356689453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.970361709594727 seconds
19 rew tensor(0.7912, dtype=torch.float64) delta_t tensor(0.1480, dtype=torch.float64)
19 gae_duplicate tensor(0.0770, dtype=torch.float64) tensor(-1.9293, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7706, dtype=torch.float64) delta_t tensor(0.0347, dtype=torch.float64)
18 gae_duplicate tensor(0.0098, dtype=torch.float64) tensor(-0.6014, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6980, dtype=torch.float64) delta_t tensor(0.0003, dtype=torch.float64)
17 gae_duplicate tensor(-0.1994, dtype=torch.float64) tensor(-0.1971, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5625, dtype=torch.float64) delta_t tensor(-0.1887, dtype=torch.float64)
16 gae_duplicate tensor(-0.6654, dtype=torch.float64) tensor(2.6178, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3231, dtype=torch.float64) delta_t tensor(-0.4489, dtype=torch.float64)
15 gae_duplicate tensor(-1.5423, dtype=torch.float64) tensor(6.2516, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8340, dtype=torch.float64) delta_t tensor(0.0850, dtype=torch.float64)
14 gae_duplicate tensor(-0.0305, dtype=torch.float64) tensor(-0.6141, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8029, dtype=torch.float64) delta_t tensor(0.0623, dtype=torch.float64)
13 gae_duplicate tensor(0.0368, dtype=torch.float64) tensor(-0.7743, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7613, dtype=torch.float64) delta_t tensor(0.1139, dtype=torch.float64)
12 gae_duplicate tensor(-0.0674, dtype=torch.float64) tensor(-1.5590, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7406, dtype=torch.float64) delta_t tensor(0.1380, dtype=torch.float64)
11 gae_duplicate tensor(-0.1669, dtype=torch.float64) tensor(-1.3281, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4625, dtype=torch.float64) delta_t tensor(-0.0608, dtype=torch.float64)
10 gae_duplicate tensor(-0.2309, dtype=torch.float64) tensor(0.6429, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2659, dtype=torch.float64) delta_t tensor(-0.3609, dtype=torch.float64)
9 gae_duplicate tensor(-0.7559, dtype=torch.float64) tensor(4.1259, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0003, dtype=torch.float64) delta_t tensor(-0.0868, dtype=torch.float64)
8 gae_duplicate tensor(-0.9510, dtype=torch.float64) tensor(0.8082, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2556, dtype=torch.float64) delta_t tensor(-0.2489, dtype=torch.float64)
7 gae_duplicate tensor(-0.8861, dtype=torch.float64) tensor(3.0789, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1001, dtype=torch.float64) delta_t tensor(-0.0287, dtype=torch.float64)
6 gae_duplicate tensor(-0.3078, dtype=torch.float64) tensor(0.4552, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6376, dtype=torch.float64) delta_t tensor(-0.4923, dtype=torch.float64)
5 gae_duplicate tensor(-1.5736, dtype=torch.float64) tensor(6.5841, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0688, dtype=torch.float64) delta_t tensor(-0.6690, dtype=torch.float64)
4 gae_duplicate tensor(-1.2490, dtype=torch.float64) tensor(8.2732, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6494, dtype=torch.float64) delta_t tensor(-0.0927, dtype=torch.float64)
3 gae_duplicate tensor(-0.4470, dtype=torch.float64) tensor(1.3130, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5183, dtype=torch.float64) delta_t tensor(-0.5821, dtype=torch.float64)
2 gae_duplicate tensor(-1.5143, dtype=torch.float64) tensor(5.4054, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1209.6220703125
value loss:32.348487854003906
entropies:209.57257080078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.015053033828735 seconds
19 rew tensor(0.8224, dtype=torch.float64) delta_t tensor(-0.0348, dtype=torch.float64)
19 gae_duplicate tensor(-0.1323, dtype=torch.float64) tensor(0.1292, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8122, dtype=torch.float64) delta_t tensor(0.0052, dtype=torch.float64)
18 gae_duplicate tensor(-0.1406, dtype=torch.float64) tensor(0.2778, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7807, dtype=torch.float64) delta_t tensor(0.0353, dtype=torch.float64)
17 gae_duplicate tensor(-0.2585, dtype=torch.float64) tensor(-0.7637, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7386, dtype=torch.float64) delta_t tensor(-0.0871, dtype=torch.float64)
16 gae_duplicate tensor(-0.5788, dtype=torch.float64) tensor(1.1583, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6541, dtype=torch.float64) delta_t tensor(-0.1444, dtype=torch.float64)
15 gae_duplicate tensor(-1.1651, dtype=torch.float64) tensor(2.1692, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8345, dtype=torch.float64) delta_t tensor(0.0361, dtype=torch.float64)
14 gae_duplicate tensor(-0.1379, dtype=torch.float64) tensor(-0.4206, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8349, dtype=torch.float64) delta_t tensor(0.0445, dtype=torch.float64)
13 gae_duplicate tensor(-0.0317, dtype=torch.float64) tensor(-0.3533, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8352, dtype=torch.float64) delta_t tensor(0.0726, dtype=torch.float64)
12 gae_duplicate tensor(-0.0115, dtype=torch.float64) tensor(-0.8579, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8356, dtype=torch.float64) delta_t tensor(0.1259, dtype=torch.float64)
11 gae_duplicate tensor(0.0549, dtype=torch.float64) tensor(-1.4720, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.1574, dtype=torch.float64)
10 gae_duplicate tensor(0.0489, dtype=torch.float64) tensor(-1.6656, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4979, dtype=torch.float64) delta_t tensor(-0.0201, dtype=torch.float64)
9 gae_duplicate tensor(-0.3021, dtype=torch.float64) tensor(0.2238, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2300, dtype=torch.float64) delta_t tensor(0.3024, dtype=torch.float64)
8 gae_duplicate tensor(0.1676, dtype=torch.float64) tensor(-3.3320, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2914, dtype=torch.float64) delta_t tensor(-0.7216, dtype=torch.float64)
7 gae_duplicate tensor(-1.3911, dtype=torch.float64) tensor(7.8701, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9978, dtype=torch.float64) delta_t tensor(0.0652, dtype=torch.float64)
6 gae_duplicate tensor(-0.0826, dtype=torch.float64) tensor(0.1108, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2662, dtype=torch.float64) delta_t tensor(0.0591, dtype=torch.float64)
5 gae_duplicate tensor(-0.0860, dtype=torch.float64) tensor(-0.7059, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0705, dtype=torch.float64) delta_t tensor(-0.5737, dtype=torch.float64)
4 gae_duplicate tensor(-0.7615, dtype=torch.float64) tensor(7.7852, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8046, dtype=torch.float64) delta_t tensor(-0.2211, dtype=torch.float64)
3 gae_duplicate tensor(-0.3534, dtype=torch.float64) tensor(2.9557, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3160, dtype=torch.float64) delta_t tensor(-0.0826, dtype=torch.float64)
2 gae_duplicate tensor(-0.3511, dtype=torch.float64) tensor(1.3083, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-556.718505859375
value loss:17.023096084594727
entropies:209.4075164794922
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.127975940704346 seconds
19 rew tensor(0.8332, dtype=torch.float64) delta_t tensor(0.0273, dtype=torch.float64)
19 gae_duplicate tensor(-0.1111, dtype=torch.float64) tensor(-0.4638, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8335, dtype=torch.float64) delta_t tensor(0.0707, dtype=torch.float64)
18 gae_duplicate tensor(-0.0065, dtype=torch.float64) tensor(-0.8233, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8338, dtype=torch.float64) delta_t tensor(0.1551, dtype=torch.float64)
17 gae_duplicate tensor(0.0904, dtype=torch.float64) tensor(-1.9804, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8342, dtype=torch.float64) delta_t tensor(0.0569, dtype=torch.float64)
16 gae_duplicate tensor(-0.0107, dtype=torch.float64) tensor(-0.7040, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8345, dtype=torch.float64) delta_t tensor(0.0104, dtype=torch.float64)
15 gae_duplicate tensor(-0.0637, dtype=torch.float64) tensor(-0.2453, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8349, dtype=torch.float64) delta_t tensor(0.0113, dtype=torch.float64)
14 gae_duplicate tensor(-0.0682, dtype=torch.float64) tensor(-0.1698, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8352, dtype=torch.float64) delta_t tensor(0.0801, dtype=torch.float64)
13 gae_duplicate tensor(-0.0668, dtype=torch.float64) tensor(-0.6586, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8045, dtype=torch.float64) delta_t tensor(0.0594, dtype=torch.float64)
12 gae_duplicate tensor(-0.0597, dtype=torch.float64) tensor(-0.7287, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6694, dtype=torch.float64) delta_t tensor(0.0432, dtype=torch.float64)
11 gae_duplicate tensor(-0.3617, dtype=torch.float64) tensor(-0.5704, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5645, dtype=torch.float64) delta_t tensor(0.0814, dtype=torch.float64)
10 gae_duplicate tensor(-0.0670, dtype=torch.float64) tensor(-0.8658, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2871, dtype=torch.float64) delta_t tensor(-0.4161, dtype=torch.float64)
9 gae_duplicate tensor(-0.8328, dtype=torch.float64) tensor(5.3277, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1338, dtype=torch.float64) delta_t tensor(-0.0972, dtype=torch.float64)
8 gae_duplicate tensor(-1.3239, dtype=torch.float64) tensor(2.1689, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0025, dtype=torch.float64) delta_t tensor(-0.0400, dtype=torch.float64)
7 gae_duplicate tensor(-0.4540, dtype=torch.float64) tensor(0.4173, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8390, dtype=torch.float64) delta_t tensor(0.2267, dtype=torch.float64)
6 gae_duplicate tensor(-0.1235, dtype=torch.float64) tensor(-2.6334, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4102, dtype=torch.float64) delta_t tensor(-0.3329, dtype=torch.float64)
5 gae_duplicate tensor(-1.4667, dtype=torch.float64) tensor(2.3781, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7185, dtype=torch.float64) delta_t tensor(-0.2358, dtype=torch.float64)
4 gae_duplicate tensor(-0.5616, dtype=torch.float64) tensor(2.7333, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5358, dtype=torch.float64) delta_t tensor(-0.0057, dtype=torch.float64)
3 gae_duplicate tensor(-0.2437, dtype=torch.float64) tensor(-0.1061, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4568, dtype=torch.float64) delta_t tensor(-0.5917, dtype=torch.float64)
2 gae_duplicate tensor(-1.5196, dtype=torch.float64) tensor(6.9274, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-397.854736328125
value loss:24.197277069091797
entropies:209.65513610839844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.390082120895386 seconds
19 rew tensor(0.8231, dtype=torch.float64) delta_t tensor(0.0384, dtype=torch.float64)
19 gae_duplicate tensor(-0.0500, dtype=torch.float64) tensor(-0.3968, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8235, dtype=torch.float64) delta_t tensor(0.1137, dtype=torch.float64)
18 gae_duplicate tensor(0.0216, dtype=torch.float64) tensor(-1.8357, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8033, dtype=torch.float64) delta_t tensor(0.1446, dtype=torch.float64)
17 gae_duplicate tensor(-0.1409, dtype=torch.float64) tensor(-2.0563, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7832, dtype=torch.float64) delta_t tensor(0.0520, dtype=torch.float64)
16 gae_duplicate tensor(-0.3314, dtype=torch.float64) tensor(-0.5342, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7323, dtype=torch.float64) delta_t tensor(-0.0688, dtype=torch.float64)
15 gae_duplicate tensor(-0.8278, dtype=torch.float64) tensor(1.0166, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8349, dtype=torch.float64) delta_t tensor(0.0036, dtype=torch.float64)
14 gae_duplicate tensor(-0.2098, dtype=torch.float64) tensor(0.0667, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8352, dtype=torch.float64) delta_t tensor(0.0258, dtype=torch.float64)
13 gae_duplicate tensor(-0.1151, dtype=torch.float64) tensor(-0.3725, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8356, dtype=torch.float64) delta_t tensor(0.0469, dtype=torch.float64)
12 gae_duplicate tensor(-0.0714, dtype=torch.float64) tensor(-0.5872, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8049, dtype=torch.float64) delta_t tensor(0.0685, dtype=torch.float64)
11 gae_duplicate tensor(-0.0299, dtype=torch.float64) tensor(-0.8743, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7845, dtype=torch.float64) delta_t tensor(0.2750, dtype=torch.float64)
10 gae_duplicate tensor(-0.0641, dtype=torch.float64) tensor(-2.8569, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3934, dtype=torch.float64) delta_t tensor(-0.1531, dtype=torch.float64)
9 gae_duplicate tensor(-0.3136, dtype=torch.float64) tensor(1.7893, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0864, dtype=torch.float64) delta_t tensor(0.1083, dtype=torch.float64)
8 gae_duplicate tensor(-0.3374, dtype=torch.float64) tensor(-0.9478, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2845, dtype=torch.float64) delta_t tensor(-0.6014, dtype=torch.float64)
7 gae_duplicate tensor(-1.0987, dtype=torch.float64) tensor(7.0592, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9576, dtype=torch.float64) delta_t tensor(-0.0330, dtype=torch.float64)
6 gae_duplicate tensor(-1.1274, dtype=torch.float64) tensor(0.7368, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2470, dtype=torch.float64) delta_t tensor(0.1178, dtype=torch.float64)
5 gae_duplicate tensor(-0.7288, dtype=torch.float64) tensor(-2.5687, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7638, dtype=torch.float64) delta_t tensor(-0.2100, dtype=torch.float64)
4 gae_duplicate tensor(-0.7565, dtype=torch.float64) tensor(1.6954, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6413, dtype=torch.float64) delta_t tensor(-0.0913, dtype=torch.float64)
3 gae_duplicate tensor(-0.6396, dtype=torch.float64) tensor(1.4806, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1911, dtype=torch.float64) delta_t tensor(0.0329, dtype=torch.float64)
2 gae_duplicate tensor(-0.2401, dtype=torch.float64) tensor(-0.3923, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-52.87129592895508
value loss:17.322986602783203
entropies:209.33518981933594
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(2396.7815)
ToM Target loss= tensor(1806.7302)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.1506311893463135 seconds
19 rew tensor(0.8331, dtype=torch.float64) delta_t tensor(0.0402, dtype=torch.float64)
19 gae_duplicate tensor(-0.1352, dtype=torch.float64) tensor(-0.7091, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8334, dtype=torch.float64) delta_t tensor(0.0940, dtype=torch.float64)
18 gae_duplicate tensor(0.0123, dtype=torch.float64) tensor(-1.0309, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8338, dtype=torch.float64) delta_t tensor(0.1875, dtype=torch.float64)
17 gae_duplicate tensor(0.1287, dtype=torch.float64) tensor(-2.1572, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8341, dtype=torch.float64) delta_t tensor(0.1198, dtype=torch.float64)
16 gae_duplicate tensor(0.0186, dtype=torch.float64) tensor(-1.5822, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8344, dtype=torch.float64) delta_t tensor(0.0183, dtype=torch.float64)
15 gae_duplicate tensor(0.0058, dtype=torch.float64) tensor(-0.3531, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8348, dtype=torch.float64) delta_t tensor(0.0290, dtype=torch.float64)
14 gae_duplicate tensor(-0.0131, dtype=torch.float64) tensor(-0.3011, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8351, dtype=torch.float64) delta_t tensor(0.0352, dtype=torch.float64)
13 gae_duplicate tensor(0.0027, dtype=torch.float64) tensor(-0.4865, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8354, dtype=torch.float64) delta_t tensor(0.0555, dtype=torch.float64)
12 gae_duplicate tensor(0.0462, dtype=torch.float64) tensor(-0.7050, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8358, dtype=torch.float64) delta_t tensor(0.0854, dtype=torch.float64)
11 gae_duplicate tensor(0.0536, dtype=torch.float64) tensor(-1.3502, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.0544, dtype=torch.float64)
10 gae_duplicate tensor(0.0235, dtype=torch.float64) tensor(-0.7509, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5781, dtype=torch.float64) delta_t tensor(0.0193, dtype=torch.float64)
9 gae_duplicate tensor(-0.2747, dtype=torch.float64) tensor(-0.9204, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3716, dtype=torch.float64) delta_t tensor(0.3638, dtype=torch.float64)
8 gae_duplicate tensor(0.2670, dtype=torch.float64) tensor(-4.0323, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1045, dtype=torch.float64) delta_t tensor(-0.7286, dtype=torch.float64)
7 gae_duplicate tensor(-1.2289, dtype=torch.float64) tensor(6.5823, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6698, dtype=torch.float64) delta_t tensor(0.2864, dtype=torch.float64)
6 gae_duplicate tensor(-0.0949, dtype=torch.float64) tensor(-2.6634, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9586, dtype=torch.float64) delta_t tensor(0.3748, dtype=torch.float64)
5 gae_duplicate tensor(-0.3953, dtype=torch.float64) tensor(-4.0277, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7631, dtype=torch.float64) delta_t tensor(-0.1623, dtype=torch.float64)
4 gae_duplicate tensor(-0.7566, dtype=torch.float64) tensor(1.2019, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5479, dtype=torch.float64) delta_t tensor(0.0067, dtype=torch.float64)
3 gae_duplicate tensor(-0.1952, dtype=torch.float64) tensor(-0.0694, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0829, dtype=torch.float64) delta_t tensor(-0.0012, dtype=torch.float64)
2 gae_duplicate tensor(-0.7891, dtype=torch.float64) tensor(-0.1894, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:449.7866516113281
value loss:15.120057106018066
entropies:210.15550231933594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.831979036331177 seconds
19 rew tensor(0.8330, dtype=torch.float64) delta_t tensor(0.0994, dtype=torch.float64)
19 gae_duplicate tensor(-0.0383, dtype=torch.float64) tensor(-1.4228, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8333, dtype=torch.float64) delta_t tensor(0.1151, dtype=torch.float64)
18 gae_duplicate tensor(0.0435, dtype=torch.float64) tensor(-1.6798, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8336, dtype=torch.float64) delta_t tensor(0.1892, dtype=torch.float64)
17 gae_duplicate tensor(0.0985, dtype=torch.float64) tensor(-2.2069, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8340, dtype=torch.float64) delta_t tensor(0.0494, dtype=torch.float64)
16 gae_duplicate tensor(-0.0177, dtype=torch.float64) tensor(-0.6739, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8343, dtype=torch.float64) delta_t tensor(0.0458, dtype=torch.float64)
15 gae_duplicate tensor(-0.0105, dtype=torch.float64) tensor(-0.7285, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8346, dtype=torch.float64) delta_t tensor(0.0479, dtype=torch.float64)
14 gae_duplicate tensor(-0.0040, dtype=torch.float64) tensor(-0.4723, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8350, dtype=torch.float64) delta_t tensor(0.0512, dtype=torch.float64)
13 gae_duplicate tensor(0.0047, dtype=torch.float64) tensor(-0.5687, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8353, dtype=torch.float64) delta_t tensor(0.0620, dtype=torch.float64)
12 gae_duplicate tensor(0.0157, dtype=torch.float64) tensor(-0.8458, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8356, dtype=torch.float64) delta_t tensor(0.1425, dtype=torch.float64)
11 gae_duplicate tensor(0.0558, dtype=torch.float64) tensor(-1.4891, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7635, dtype=torch.float64) delta_t tensor(0.1270, dtype=torch.float64)
10 gae_duplicate tensor(-0.0352, dtype=torch.float64) tensor(-1.8194, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4426, dtype=torch.float64) delta_t tensor(-0.2050, dtype=torch.float64)
9 gae_duplicate tensor(-0.2864, dtype=torch.float64) tensor(2.1904, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2250, dtype=torch.float64) delta_t tensor(0.2177, dtype=torch.float64)
8 gae_duplicate tensor(-0.0601, dtype=torch.float64) tensor(-2.1233, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0846, dtype=torch.float64) delta_t tensor(-0.3745, dtype=torch.float64)
7 gae_duplicate tensor(-0.5374, dtype=torch.float64) tensor(5.2692, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9340, dtype=torch.float64) delta_t tensor(0.0714, dtype=torch.float64)
6 gae_duplicate tensor(-0.0967, dtype=torch.float64) tensor(-0.4549, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2539, dtype=torch.float64) delta_t tensor(0.0102, dtype=torch.float64)
5 gae_duplicate tensor(-0.2132, dtype=torch.float64) tensor(-0.0965, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8929, dtype=torch.float64) delta_t tensor(-0.3034, dtype=torch.float64)
4 gae_duplicate tensor(-0.9904, dtype=torch.float64) tensor(3.9492, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6059, dtype=torch.float64) delta_t tensor(-0.0088, dtype=torch.float64)
3 gae_duplicate tensor(-0.2345, dtype=torch.float64) tensor(0.5158, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4615, dtype=torch.float64) delta_t tensor(-0.0005, dtype=torch.float64)
2 gae_duplicate tensor(-0.3374, dtype=torch.float64) tensor(0.2669, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:48.184906005859375
value loss:8.795246124267578
entropies:210.3668670654297
Policy training finished
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt