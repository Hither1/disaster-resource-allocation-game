obs <crafter.objects.Shelter object at 0x140d5c0d0> [ 0 39  0  0 39  0  0 11  0]
obs <crafter.objects.Warehouse object at 0x1278fbe50> [ 0 39  0  0 39  0  0  9  0]
obs <crafter.objects.Station object at 0x1278d3610> [ 0  9  0  0  9  0  0 10  0]
obs <crafter.objects.Shelter object at 0x140d5c0d0> [ 0 39  0  0 39  0  0  8  0]
obs <crafter.objects.Warehouse object at 0x1278fbe50> [ 0 39  0  0 42  0  0  9  0]
obs <crafter.objects.Station object at 0x1278d3610> [ 0  9  0  0  9  0  0 10  0]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0026459693908691406 seconds
19 rew tensor(0.8547, dtype=torch.float64) delta_t tensor(0.5972, dtype=torch.float64)
19 gae_duplicate tensor(0.5261, dtype=torch.float64) tensor(-11.8011, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8684, dtype=torch.float64) delta_t tensor(0.6482, dtype=torch.float64)
18 gae_duplicate tensor(0.6491, dtype=torch.float64) tensor(-13.9734, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8856, dtype=torch.float64) delta_t tensor(0.6554, dtype=torch.float64)
17 gae_duplicate tensor(0.6225, dtype=torch.float64) tensor(-14.2907, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8943, dtype=torch.float64) delta_t tensor(0.6461, dtype=torch.float64)
16 gae_duplicate tensor(0.4259, dtype=torch.float64) tensor(-14.2658, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8706, dtype=torch.float64) delta_t tensor(0.6558, dtype=torch.float64)
15 gae_duplicate tensor(0.1442, dtype=torch.float64) tensor(-14.3787, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0248, dtype=torch.float64) delta_t tensor(0.8730, dtype=torch.float64)
14 gae_duplicate tensor(0.4855, dtype=torch.float64) tensor(-18.7244, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.1094, dtype=torch.float64) delta_t tensor(0.9565, dtype=torch.float64)
13 gae_duplicate tensor(0.7968, dtype=torch.float64) tensor(-20.8309, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.2787, dtype=torch.float64) delta_t tensor(1.1359, dtype=torch.float64)
12 gae_duplicate tensor(1.0435, dtype=torch.float64) tensor(-24.5368, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.4479, dtype=torch.float64) delta_t tensor(1.2428, dtype=torch.float64)
11 gae_duplicate tensor(1.1072, dtype=torch.float64) tensor(-27.0306, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(1.5559, dtype=torch.float64) delta_t tensor(1.3974, dtype=torch.float64)
10 gae_duplicate tensor(1.2197, dtype=torch.float64) tensor(-30.3470, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8720, dtype=torch.float64) delta_t tensor(0.6408, dtype=torch.float64)
9 gae_duplicate tensor(-0.6534, dtype=torch.float64) tensor(-15.8922, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6932, dtype=torch.float64) delta_t tensor(0.4601, dtype=torch.float64)
8 gae_duplicate tensor(-1.4780, dtype=torch.float64) tensor(-10.7230, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4857, dtype=torch.float64) delta_t tensor(0.2531, dtype=torch.float64)
7 gae_duplicate tensor(-1.0057, dtype=torch.float64) tensor(-6.0201, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4464, dtype=torch.float64) delta_t tensor(0.1921, dtype=torch.float64)
6 gae_duplicate tensor(-0.6038, dtype=torch.float64) tensor(-3.7352, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5372, dtype=torch.float64) delta_t tensor(-0.8042, dtype=torch.float64)
5 gae_duplicate tensor(-1.5430, dtype=torch.float64) tensor(15.5043, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8665, dtype=torch.float64) delta_t tensor(-1.1537, dtype=torch.float64)
4 gae_duplicate tensor(-2.2257, dtype=torch.float64) tensor(24.6665, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6807, dtype=torch.float64) delta_t tensor(-0.9443, dtype=torch.float64)
3 gae_duplicate tensor(-2.0818, dtype=torch.float64) tensor(21.8166, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3052, dtype=torch.float64) delta_t tensor(-0.3901, dtype=torch.float64)
2 gae_duplicate tensor(-1.3898, dtype=torch.float64) tensor(9.3530, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:8285.421875
value loss:194.31338500976562
entropies:355.1537780761719
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 4.665650129318237 seconds
19 rew tensor(0.7922, dtype=torch.float64) delta_t tensor(0.4904, dtype=torch.float64)
19 gae_duplicate tensor(0.0776, dtype=torch.float64) tensor(-9.7146, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7311, dtype=torch.float64) delta_t tensor(0.4796, dtype=torch.float64)
18 gae_duplicate tensor(-0.0921, dtype=torch.float64) tensor(-10.3755, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5449, dtype=torch.float64) delta_t tensor(0.2580, dtype=torch.float64)
17 gae_duplicate tensor(-0.6048, dtype=torch.float64) tensor(-6.1510, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5849, dtype=torch.float64) delta_t tensor(0.2967, dtype=torch.float64)
16 gae_duplicate tensor(-0.6412, dtype=torch.float64) tensor(-6.5155, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6598, dtype=torch.float64) delta_t tensor(0.4201, dtype=torch.float64)
15 gae_duplicate tensor(-0.0334, dtype=torch.float64) tensor(-8.9162, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6580, dtype=torch.float64) delta_t tensor(0.4143, dtype=torch.float64)
14 gae_duplicate tensor(-0.4443, dtype=torch.float64) tensor(-9.2228, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8050, dtype=torch.float64) delta_t tensor(0.5342, dtype=torch.float64)
13 gae_duplicate tensor(0.2099, dtype=torch.float64) tensor(-11.2146, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7554, dtype=torch.float64) delta_t tensor(0.5310, dtype=torch.float64)
12 gae_duplicate tensor(0.1446, dtype=torch.float64) tensor(-11.6522, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7302, dtype=torch.float64) delta_t tensor(0.4944, dtype=torch.float64)
11 gae_duplicate tensor(0.1360, dtype=torch.float64) tensor(-10.9463, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6426, dtype=torch.float64) delta_t tensor(0.4110, dtype=torch.float64)
10 gae_duplicate tensor(0.0657, dtype=torch.float64) tensor(-9.2292, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4822, dtype=torch.float64) delta_t tensor(-0.7783, dtype=torch.float64)
9 gae_duplicate tensor(-2.1062, dtype=torch.float64) tensor(14.4355, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4387, dtype=torch.float64) delta_t tensor(-0.6662, dtype=torch.float64)
8 gae_duplicate tensor(-1.9285, dtype=torch.float64) tensor(14.5145, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3920, dtype=torch.float64) delta_t tensor(-0.6394, dtype=torch.float64)
7 gae_duplicate tensor(-1.8546, dtype=torch.float64) tensor(14.3111, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0791, dtype=torch.float64) delta_t tensor(-1.3276, dtype=torch.float64)
6 gae_duplicate tensor(-2.3704, dtype=torch.float64) tensor(27.8426, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3051, dtype=torch.float64) delta_t tensor(-1.5590, dtype=torch.float64)
5 gae_duplicate tensor(-2.2957, dtype=torch.float64) tensor(34.9634, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7839, dtype=torch.float64) delta_t tensor(-2.0535, dtype=torch.float64)
4 gae_duplicate tensor(-4.5429, dtype=torch.float64) tensor(42.6242, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5359, dtype=torch.float64) delta_t tensor(-0.7757, dtype=torch.float64)
3 gae_duplicate tensor(-2.7751, dtype=torch.float64) tensor(20.5108, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3921, dtype=torch.float64) delta_t tensor(-0.6545, dtype=torch.float64)
2 gae_duplicate tensor(-1.2913, dtype=torch.float64) tensor(14.7205, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4954.88623046875
value loss:206.0863494873047
entropies:354.5158996582031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.398721933364868 seconds
19 rew tensor(0.8341, dtype=torch.float64) delta_t tensor(0.5136, dtype=torch.float64)
19 gae_duplicate tensor(0.3012, dtype=torch.float64) tensor(-10.0053, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8222, dtype=torch.float64) delta_t tensor(0.5390, dtype=torch.float64)
18 gae_duplicate tensor(0.4264, dtype=torch.float64) tensor(-11.7106, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7705, dtype=torch.float64) delta_t tensor(0.5020, dtype=torch.float64)
17 gae_duplicate tensor(0.1030, dtype=torch.float64) tensor(-11.4326, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6951, dtype=torch.float64) delta_t tensor(0.4651, dtype=torch.float64)
16 gae_duplicate tensor(-0.3217, dtype=torch.float64) tensor(-10.4049, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9024, dtype=torch.float64) delta_t tensor(0.6903, dtype=torch.float64)
15 gae_duplicate tensor(0.5206, dtype=torch.float64) tensor(-14.6286, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9175, dtype=torch.float64) delta_t tensor(0.6184, dtype=torch.float64)
14 gae_duplicate tensor(0.4632, dtype=torch.float64) tensor(-13.6642, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9257, dtype=torch.float64) delta_t tensor(0.6442, dtype=torch.float64)
13 gae_duplicate tensor(0.5445, dtype=torch.float64) tensor(-13.9145, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9501, dtype=torch.float64) delta_t tensor(0.6574, dtype=torch.float64)
12 gae_duplicate tensor(0.5091, dtype=torch.float64) tensor(-13.9691, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8591, dtype=torch.float64) delta_t tensor(0.6089, dtype=torch.float64)
11 gae_duplicate tensor(0.4849, dtype=torch.float64) tensor(-13.5145, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7864, dtype=torch.float64) delta_t tensor(0.4906, dtype=torch.float64)
10 gae_duplicate tensor(0.3388, dtype=torch.float64) tensor(-11.6174, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6202, dtype=torch.float64) delta_t tensor(0.3510, dtype=torch.float64)
9 gae_duplicate tensor(0.0775, dtype=torch.float64) tensor(-7.7356, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0933, dtype=torch.float64) delta_t tensor(-0.1963, dtype=torch.float64)
8 gae_duplicate tensor(-1.1875, dtype=torch.float64) tensor(2.5788, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2209, dtype=torch.float64) delta_t tensor(-0.5512, dtype=torch.float64)
7 gae_duplicate tensor(-1.4576, dtype=torch.float64) tensor(10.4397, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7850, dtype=torch.float64) delta_t tensor(-1.1013, dtype=torch.float64)
6 gae_duplicate tensor(-2.3858, dtype=torch.float64) tensor(22.7987, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1466, dtype=torch.float64) delta_t tensor(-1.4362, dtype=torch.float64)
5 gae_duplicate tensor(-2.9025, dtype=torch.float64) tensor(31.7088, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8512, dtype=torch.float64) delta_t tensor(-2.1637, dtype=torch.float64)
4 gae_duplicate tensor(-5.0138, dtype=torch.float64) tensor(43.4930, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6626, dtype=torch.float64) delta_t tensor(-0.8640, dtype=torch.float64)
3 gae_duplicate tensor(-2.2598, dtype=torch.float64) tensor(19.9279, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6962, dtype=torch.float64) delta_t tensor(-0.8832, dtype=torch.float64)
2 gae_duplicate tensor(-1.7801, dtype=torch.float64) tensor(18.4242, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1000.7847900390625
value loss:182.4640350341797
entropies:351.8677062988281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.292543888092041 seconds
19 rew tensor(0.8475, dtype=torch.float64) delta_t tensor(0.5391, dtype=torch.float64)
19 gae_duplicate tensor(0.4457, dtype=torch.float64) tensor(-10.5678, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8568, dtype=torch.float64) delta_t tensor(0.5581, dtype=torch.float64)
18 gae_duplicate tensor(0.5413, dtype=torch.float64) tensor(-12.0211, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8665, dtype=torch.float64) delta_t tensor(0.5684, dtype=torch.float64)
17 gae_duplicate tensor(0.4966, dtype=torch.float64) tensor(-12.5164, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8765, dtype=torch.float64) delta_t tensor(0.6224, dtype=torch.float64)
16 gae_duplicate tensor(0.5232, dtype=torch.float64) tensor(-13.7201, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8868, dtype=torch.float64) delta_t tensor(0.6219, dtype=torch.float64)
15 gae_duplicate tensor(0.5061, dtype=torch.float64) tensor(-13.5073, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8975, dtype=torch.float64) delta_t tensor(0.6625, dtype=torch.float64)
14 gae_duplicate tensor(0.6063, dtype=torch.float64) tensor(-14.3740, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8511, dtype=torch.float64) delta_t tensor(0.6060, dtype=torch.float64)
13 gae_duplicate tensor(0.3767, dtype=torch.float64) tensor(-13.3543, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(0.5724, dtype=torch.float64)
12 gae_duplicate tensor(0.0291, dtype=torch.float64) tensor(-12.6418, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8454, dtype=torch.float64) delta_t tensor(0.5896, dtype=torch.float64)
11 gae_duplicate tensor(0.3200, dtype=torch.float64) tensor(-12.8158, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6910, dtype=torch.float64) delta_t tensor(0.4232, dtype=torch.float64)
10 gae_duplicate tensor(0.1551, dtype=torch.float64) tensor(-9.5567, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3552, dtype=torch.float64) delta_t tensor(-0.6641, dtype=torch.float64)
9 gae_duplicate tensor(-2.8449, dtype=torch.float64) tensor(10.9754, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2182, dtype=torch.float64) delta_t tensor(-0.0302, dtype=torch.float64)
8 gae_duplicate tensor(-0.7694, dtype=torch.float64) tensor(1.9835, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5202, dtype=torch.float64) delta_t tensor(-0.7991, dtype=torch.float64)
7 gae_duplicate tensor(-2.5203, dtype=torch.float64) tensor(15.5173, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7887, dtype=torch.float64) delta_t tensor(-1.0982, dtype=torch.float64)
6 gae_duplicate tensor(-2.0159, dtype=torch.float64) tensor(22.2832, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0545, dtype=torch.float64) delta_t tensor(-1.3373, dtype=torch.float64)
5 gae_duplicate tensor(-2.5046, dtype=torch.float64) tensor(26.9337, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3056, dtype=torch.float64) delta_t tensor(-1.6562, dtype=torch.float64)
4 gae_duplicate tensor(-2.9356, dtype=torch.float64) tensor(34.8424, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9166, dtype=torch.float64) delta_t tensor(-1.2672, dtype=torch.float64)
3 gae_duplicate tensor(-2.8819, dtype=torch.float64) tensor(26.0809, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7401, dtype=torch.float64) delta_t tensor(-1.0183, dtype=torch.float64)
2 gae_duplicate tensor(-2.3725, dtype=torch.float64) tensor(25.3658, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2195.97119140625
value loss:186.91864013671875
entropies:351.7864074707031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.022229909896851 seconds
19 rew tensor(0.8416, dtype=torch.float64) delta_t tensor(0.4946, dtype=torch.float64)
19 gae_duplicate tensor(0.3606, dtype=torch.float64) tensor(-9.7502, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8405, dtype=torch.float64) delta_t tensor(0.5738, dtype=torch.float64)
18 gae_duplicate tensor(0.4466, dtype=torch.float64) tensor(-12.2530, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8402, dtype=torch.float64) delta_t tensor(0.5289, dtype=torch.float64)
17 gae_duplicate tensor(0.4212, dtype=torch.float64) tensor(-11.6652, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8308, dtype=torch.float64) delta_t tensor(0.5654, dtype=torch.float64)
16 gae_duplicate tensor(0.4543, dtype=torch.float64) tensor(-12.3263, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8053, dtype=torch.float64) delta_t tensor(0.5252, dtype=torch.float64)
15 gae_duplicate tensor(0.3631, dtype=torch.float64) tensor(-11.5623, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7561, dtype=torch.float64) delta_t tensor(0.5181, dtype=torch.float64)
14 gae_duplicate tensor(0.1905, dtype=torch.float64) tensor(-11.4691, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7737, dtype=torch.float64) delta_t tensor(0.5736, dtype=torch.float64)
13 gae_duplicate tensor(0.1598, dtype=torch.float64) tensor(-12.5623, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7887, dtype=torch.float64) delta_t tensor(0.5484, dtype=torch.float64)
12 gae_duplicate tensor(0.1555, dtype=torch.float64) tensor(-12.0775, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7280, dtype=torch.float64) delta_t tensor(0.4988, dtype=torch.float64)
11 gae_duplicate tensor(0.1773, dtype=torch.float64) tensor(-10.8999, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5803, dtype=torch.float64) delta_t tensor(0.3422, dtype=torch.float64)
10 gae_duplicate tensor(-0.0173, dtype=torch.float64) tensor(-7.8738, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3427, dtype=torch.float64) delta_t tensor(-0.6112, dtype=torch.float64)
9 gae_duplicate tensor(-2.6022, dtype=torch.float64) tensor(11.1782, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5757, dtype=torch.float64) delta_t tensor(-0.8632, dtype=torch.float64)
8 gae_duplicate tensor(-3.5383, dtype=torch.float64) tensor(18.0356, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0063, dtype=torch.float64) delta_t tensor(-0.3124, dtype=torch.float64)
7 gae_duplicate tensor(-0.8861, dtype=torch.float64) tensor(7.4916, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8851, dtype=torch.float64) delta_t tensor(-1.1900, dtype=torch.float64)
6 gae_duplicate tensor(-2.2414, dtype=torch.float64) tensor(24.2657, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5540, dtype=torch.float64) delta_t tensor(-1.8894, dtype=torch.float64)
5 gae_duplicate tensor(-3.4086, dtype=torch.float64) tensor(39.5531, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2880, dtype=torch.float64) delta_t tensor(-1.6119, dtype=torch.float64)
4 gae_duplicate tensor(-5.2271, dtype=torch.float64) tensor(38.2772, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7729, dtype=torch.float64) delta_t tensor(-1.0554, dtype=torch.float64)
3 gae_duplicate tensor(-2.0400, dtype=torch.float64) tensor(24.4267, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6822, dtype=torch.float64) delta_t tensor(-0.8860, dtype=torch.float64)
2 gae_duplicate tensor(-1.7038, dtype=torch.float64) tensor(21.1625, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3980.60791015625
value loss:213.23167419433594
entropies:352.7974853515625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3962.3596)
ToM Target loss= tensor(2862.4524)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.857173919677734 seconds
19 rew tensor(0.6911, dtype=torch.float64) delta_t tensor(0.3623, dtype=torch.float64)
19 gae_duplicate tensor(-0.2525, dtype=torch.float64) tensor(-7.1583, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5648, dtype=torch.float64) delta_t tensor(0.2911, dtype=torch.float64)
18 gae_duplicate tensor(-0.9007, dtype=torch.float64) tensor(-6.2550, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7990, dtype=torch.float64) delta_t tensor(0.5138, dtype=torch.float64)
17 gae_duplicate tensor(0.1444, dtype=torch.float64) tensor(-10.5645, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7615, dtype=torch.float64) delta_t tensor(0.4448, dtype=torch.float64)
16 gae_duplicate tensor(-0.1126, dtype=torch.float64) tensor(-9.9665, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6716, dtype=torch.float64) delta_t tensor(0.3743, dtype=torch.float64)
15 gae_duplicate tensor(-0.6488, dtype=torch.float64) tensor(-8.2139, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8535, dtype=torch.float64) delta_t tensor(0.6390, dtype=torch.float64)
14 gae_duplicate tensor(0.4118, dtype=torch.float64) tensor(-13.1939, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8434, dtype=torch.float64) delta_t tensor(0.5810, dtype=torch.float64)
13 gae_duplicate tensor(0.4833, dtype=torch.float64) tensor(-12.8609, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8120, dtype=torch.float64) delta_t tensor(0.5378, dtype=torch.float64)
12 gae_duplicate tensor(0.3425, dtype=torch.float64) tensor(-12.0459, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8913, dtype=torch.float64) delta_t tensor(0.5866, dtype=torch.float64)
11 gae_duplicate tensor(0.5286, dtype=torch.float64) tensor(-12.6652, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7487, dtype=torch.float64) delta_t tensor(0.5037, dtype=torch.float64)
10 gae_duplicate tensor(0.3000, dtype=torch.float64) tensor(-11.5873, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0399, dtype=torch.float64) delta_t tensor(-0.2243, dtype=torch.float64)
9 gae_duplicate tensor(-1.3508, dtype=torch.float64) tensor(3.1901, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6630, dtype=torch.float64) delta_t tensor(-0.9382, dtype=torch.float64)
8 gae_duplicate tensor(-2.9404, dtype=torch.float64) tensor(17.7022, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5408, dtype=torch.float64) delta_t tensor(-0.8666, dtype=torch.float64)
7 gae_duplicate tensor(-2.2319, dtype=torch.float64) tensor(18.7301, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8287, dtype=torch.float64) delta_t tensor(-1.0979, dtype=torch.float64)
6 gae_duplicate tensor(-2.5586, dtype=torch.float64) tensor(24.2281, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8330, dtype=torch.float64) delta_t tensor(-1.1343, dtype=torch.float64)
5 gae_duplicate tensor(-2.2891, dtype=torch.float64) tensor(24.3015, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1240, dtype=torch.float64) delta_t tensor(-1.3676, dtype=torch.float64)
4 gae_duplicate tensor(-2.2095, dtype=torch.float64) tensor(28.7102, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8995, dtype=torch.float64) delta_t tensor(-1.2544, dtype=torch.float64)
3 gae_duplicate tensor(-1.8676, dtype=torch.float64) tensor(29.1307, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7536, dtype=torch.float64) delta_t tensor(-0.9653, dtype=torch.float64)
2 gae_duplicate tensor(-1.4986, dtype=torch.float64) tensor(21.8885, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3517.092529296875
value loss:165.43588256835938
entropies:352.2523193359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.926126956939697 seconds
19 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(0.4996, dtype=torch.float64)
19 gae_duplicate tensor(0.3844, dtype=torch.float64) tensor(-9.8808, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7994, dtype=torch.float64) delta_t tensor(0.4767, dtype=torch.float64)
18 gae_duplicate tensor(0.3621, dtype=torch.float64) tensor(-10.4295, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7610, dtype=torch.float64) delta_t tensor(0.4469, dtype=torch.float64)
17 gae_duplicate tensor(0.1927, dtype=torch.float64) tensor(-10.0089, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6985, dtype=torch.float64) delta_t tensor(0.3234, dtype=torch.float64)
16 gae_duplicate tensor(-0.1400, dtype=torch.float64) tensor(-7.1687, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5598, dtype=torch.float64) delta_t tensor(0.2005, dtype=torch.float64)
15 gae_duplicate tensor(-0.7043, dtype=torch.float64) tensor(-4.8459, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6986, dtype=torch.float64) delta_t tensor(0.4160, dtype=torch.float64)
14 gae_duplicate tensor(-0.2050, dtype=torch.float64) tensor(-8.7801, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8349, dtype=torch.float64) delta_t tensor(0.5310, dtype=torch.float64)
13 gae_duplicate tensor(0.4937, dtype=torch.float64) tensor(-11.0593, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8433, dtype=torch.float64) delta_t tensor(0.5387, dtype=torch.float64)
12 gae_duplicate tensor(0.4194, dtype=torch.float64) tensor(-11.6228, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8080, dtype=torch.float64) delta_t tensor(0.4970, dtype=torch.float64)
11 gae_duplicate tensor(0.4490, dtype=torch.float64) tensor(-11.0466, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7645, dtype=torch.float64) delta_t tensor(0.5073, dtype=torch.float64)
10 gae_duplicate tensor(0.3615, dtype=torch.float64) tensor(-11.4505, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2078, dtype=torch.float64) delta_t tensor(-0.1283, dtype=torch.float64)
9 gae_duplicate tensor(-1.1534, dtype=torch.float64) tensor(1.4402, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0581, dtype=torch.float64) delta_t tensor(-0.3874, dtype=torch.float64)
8 gae_duplicate tensor(-2.9384, dtype=torch.float64) tensor(8.1681, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6450, dtype=torch.float64) delta_t tensor(-0.9598, dtype=torch.float64)
7 gae_duplicate tensor(-3.4475, dtype=torch.float64) tensor(18.1914, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0267, dtype=torch.float64) delta_t tensor(-1.3184, dtype=torch.float64)
6 gae_duplicate tensor(-2.9502, dtype=torch.float64) tensor(31.2550, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8874, dtype=torch.float64) delta_t tensor(-1.2446, dtype=torch.float64)
5 gae_duplicate tensor(-2.0601, dtype=torch.float64) tensor(26.9757, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7435, dtype=torch.float64) delta_t tensor(-2.1574, dtype=torch.float64)
4 gae_duplicate tensor(-6.8100, dtype=torch.float64) tensor(44.2246, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7595, dtype=torch.float64) delta_t tensor(-0.9616, dtype=torch.float64)
3 gae_duplicate tensor(-1.6448, dtype=torch.float64) tensor(22.5192, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5988, dtype=torch.float64) delta_t tensor(-0.8664, dtype=torch.float64)
2 gae_duplicate tensor(-1.3862, dtype=torch.float64) tensor(18.7017, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4154.89892578125
value loss:224.9465789794922
entropies:351.90545654296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8834779262542725 seconds
19 rew tensor(0.8318, dtype=torch.float64) delta_t tensor(0.4513, dtype=torch.float64)
19 gae_duplicate tensor(0.3436, dtype=torch.float64) tensor(-8.7959, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8362, dtype=torch.float64) delta_t tensor(0.5280, dtype=torch.float64)
18 gae_duplicate tensor(0.4488, dtype=torch.float64) tensor(-11.7038, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8221, dtype=torch.float64) delta_t tensor(0.5373, dtype=torch.float64)
17 gae_duplicate tensor(0.4179, dtype=torch.float64) tensor(-11.9386, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8173, dtype=torch.float64) delta_t tensor(0.5185, dtype=torch.float64)
16 gae_duplicate tensor(0.3507, dtype=torch.float64) tensor(-11.4116, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7681, dtype=torch.float64) delta_t tensor(0.4420, dtype=torch.float64)
15 gae_duplicate tensor(0.1802, dtype=torch.float64) tensor(-10.0479, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6878, dtype=torch.float64) delta_t tensor(0.4032, dtype=torch.float64)
14 gae_duplicate tensor(-0.4077, dtype=torch.float64) tensor(-8.6662, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7739, dtype=torch.float64) delta_t tensor(0.4680, dtype=torch.float64)
13 gae_duplicate tensor(-0.0739, dtype=torch.float64) tensor(-10.5135, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6714, dtype=torch.float64) delta_t tensor(0.4163, dtype=torch.float64)
12 gae_duplicate tensor(0.2456, dtype=torch.float64) tensor(-9.4965, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6339, dtype=torch.float64) delta_t tensor(0.3186, dtype=torch.float64)
11 gae_duplicate tensor(-0.0346, dtype=torch.float64) tensor(-7.3692, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3109, dtype=torch.float64) delta_t tensor(-0.0067, dtype=torch.float64)
10 gae_duplicate tensor(-1.2268, dtype=torch.float64) tensor(-0.1462, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3324, dtype=torch.float64) delta_t tensor(0.0220, dtype=torch.float64)
9 gae_duplicate tensor(-0.3761, dtype=torch.float64) tensor(-0.0845, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0314, dtype=torch.float64) delta_t tensor(-0.2937, dtype=torch.float64)
8 gae_duplicate tensor(-0.6580, dtype=torch.float64) tensor(6.2385, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5203, dtype=torch.float64) delta_t tensor(-0.8485, dtype=torch.float64)
7 gae_duplicate tensor(-1.7462, dtype=torch.float64) tensor(17.6939, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9757, dtype=torch.float64) delta_t tensor(-1.3237, dtype=torch.float64)
6 gae_duplicate tensor(-2.3916, dtype=torch.float64) tensor(22.6180, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6985, dtype=torch.float64) delta_t tensor(-1.0068, dtype=torch.float64)
5 gae_duplicate tensor(-1.9422, dtype=torch.float64) tensor(22.6812, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2836, dtype=torch.float64) delta_t tensor(-1.5641, dtype=torch.float64)
4 gae_duplicate tensor(-2.2545, dtype=torch.float64) tensor(30.6792, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2458, dtype=torch.float64) delta_t tensor(-1.5409, dtype=torch.float64)
3 gae_duplicate tensor(-2.2608, dtype=torch.float64) tensor(34.8531, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8642, dtype=torch.float64) delta_t tensor(-0.9312, dtype=torch.float64)
2 gae_duplicate tensor(-1.9673, dtype=torch.float64) tensor(18.2105, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3485.278076171875
value loss:145.01939392089844
entropies:348.37274169921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.15918493270874 seconds
19 rew tensor(0.8322, dtype=torch.float64) delta_t tensor(0.4790, dtype=torch.float64)
19 gae_duplicate tensor(0.3737, dtype=torch.float64) tensor(-9.4891, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8362, dtype=torch.float64) delta_t tensor(0.5211, dtype=torch.float64)
18 gae_duplicate tensor(0.4548, dtype=torch.float64) tensor(-11.5881, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8402, dtype=torch.float64) delta_t tensor(0.5357, dtype=torch.float64)
17 gae_duplicate tensor(0.4665, dtype=torch.float64) tensor(-11.8461, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8442, dtype=torch.float64) delta_t tensor(0.5163, dtype=torch.float64)
16 gae_duplicate tensor(0.4712, dtype=torch.float64) tensor(-11.7381, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8484, dtype=torch.float64) delta_t tensor(0.5381, dtype=torch.float64)
15 gae_duplicate tensor(0.4682, dtype=torch.float64) tensor(-12.1948, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8526, dtype=torch.float64) delta_t tensor(0.5192, dtype=torch.float64)
14 gae_duplicate tensor(0.4186, dtype=torch.float64) tensor(-11.4787, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8568, dtype=torch.float64) delta_t tensor(0.5782, dtype=torch.float64)
13 gae_duplicate tensor(0.5496, dtype=torch.float64) tensor(-12.0159, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7942, dtype=torch.float64) delta_t tensor(0.5055, dtype=torch.float64)
12 gae_duplicate tensor(0.2296, dtype=torch.float64) tensor(-10.5456, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7981, dtype=torch.float64) delta_t tensor(0.4020, dtype=torch.float64)
11 gae_duplicate tensor(0.2478, dtype=torch.float64) tensor(-8.6542, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7678, dtype=torch.float64) delta_t tensor(0.5217, dtype=torch.float64)
10 gae_duplicate tensor(0.2293, dtype=torch.float64) tensor(-11.0486, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0195, dtype=torch.float64) delta_t tensor(-0.2664, dtype=torch.float64)
9 gae_duplicate tensor(-2.3982, dtype=torch.float64) tensor(3.3386, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2889, dtype=torch.float64) delta_t tensor(-0.5417, dtype=torch.float64)
8 gae_duplicate tensor(-2.9710, dtype=torch.float64) tensor(11.8257, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6326, dtype=torch.float64) delta_t tensor(-0.9441, dtype=torch.float64)
7 gae_duplicate tensor(-2.8238, dtype=torch.float64) tensor(20.2010, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2353, dtype=torch.float64) delta_t tensor(-1.5674, dtype=torch.float64)
6 gae_duplicate tensor(-4.5903, dtype=torch.float64) tensor(29.2938, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3975, dtype=torch.float64) delta_t tensor(-1.6695, dtype=torch.float64)
5 gae_duplicate tensor(-4.7059, dtype=torch.float64) tensor(32.4317, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4117, dtype=torch.float64) delta_t tensor(-1.7521, dtype=torch.float64)
4 gae_duplicate tensor(-3.6608, dtype=torch.float64) tensor(35.2907, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0176, dtype=torch.float64) delta_t tensor(-1.2974, dtype=torch.float64)
3 gae_duplicate tensor(-2.1655, dtype=torch.float64) tensor(29.8489, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6982, dtype=torch.float64) delta_t tensor(-0.9554, dtype=torch.float64)
2 gae_duplicate tensor(-1.5401, dtype=torch.float64) tensor(17.2589, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3814.308349609375
value loss:237.8526611328125
entropies:349.1090087890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.714089870452881 seconds
19 rew tensor(0.6904, dtype=torch.float64) delta_t tensor(0.3291, dtype=torch.float64)
19 gae_duplicate tensor(-0.2082, dtype=torch.float64) tensor(-6.4270, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5555, dtype=torch.float64) delta_t tensor(0.1942, dtype=torch.float64)
18 gae_duplicate tensor(-0.6959, dtype=torch.float64) tensor(-4.7946, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6945, dtype=torch.float64) delta_t tensor(0.3391, dtype=torch.float64)
17 gae_duplicate tensor(0.1645, dtype=torch.float64) tensor(-7.1452, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5473, dtype=torch.float64) delta_t tensor(0.2323, dtype=torch.float64)
16 gae_duplicate tensor(-0.1026, dtype=torch.float64) tensor(-4.9840, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2930, dtype=torch.float64) delta_t tensor(0.0031, dtype=torch.float64)
15 gae_duplicate tensor(-0.6966, dtype=torch.float64) tensor(-0.6862, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7100, dtype=torch.float64) delta_t tensor(0.3723, dtype=torch.float64)
14 gae_duplicate tensor(-0.3591, dtype=torch.float64) tensor(-7.1248, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7333, dtype=torch.float64) delta_t tensor(0.4435, dtype=torch.float64)
13 gae_duplicate tensor(0.3268, dtype=torch.float64) tensor(-9.3289, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4729, dtype=torch.float64) delta_t tensor(0.1660, dtype=torch.float64)
12 gae_duplicate tensor(-0.1603, dtype=torch.float64) tensor(-4.3898, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4867, dtype=torch.float64) delta_t tensor(0.1081, dtype=torch.float64)
11 gae_duplicate tensor(-0.4848, dtype=torch.float64) tensor(-2.7461, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4018, dtype=torch.float64) delta_t tensor(0.1250, dtype=torch.float64)
10 gae_duplicate tensor(-0.6259, dtype=torch.float64) tensor(-2.8005, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0127, dtype=torch.float64) delta_t tensor(-0.3647, dtype=torch.float64)
9 gae_duplicate tensor(-0.9207, dtype=torch.float64) tensor(7.2216, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5164, dtype=torch.float64) delta_t tensor(-0.8522, dtype=torch.float64)
8 gae_duplicate tensor(-1.8708, dtype=torch.float64) tensor(16.6594, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0092, dtype=torch.float64) delta_t tensor(-1.2782, dtype=torch.float64)
7 gae_duplicate tensor(-3.1173, dtype=torch.float64) tensor(25.2127, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2579, dtype=torch.float64) delta_t tensor(-1.5983, dtype=torch.float64)
6 gae_duplicate tensor(-2.6387, dtype=torch.float64) tensor(35.8308, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9938, dtype=torch.float64) delta_t tensor(-2.3448, dtype=torch.float64)
5 gae_duplicate tensor(-3.6022, dtype=torch.float64) tensor(46.2941, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7759, dtype=torch.float64) delta_t tensor(-3.1329, dtype=torch.float64)
4 gae_duplicate tensor(-7.2392, dtype=torch.float64) tensor(65.8706, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2637, dtype=torch.float64) delta_t tensor(-0.5933, dtype=torch.float64)
3 gae_duplicate tensor(-2.5958, dtype=torch.float64) tensor(19.1683, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6756, dtype=torch.float64) delta_t tensor(-0.9825, dtype=torch.float64)
2 gae_duplicate tensor(-2.1222, dtype=torch.float64) tensor(21.3089, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-10200.017578125
value loss:325.2410583496094
entropies:350.0271301269531
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3951.5303)
ToM Target loss= tensor(2834.6018)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.322383880615234 seconds
19 rew tensor(0.6106, dtype=torch.float64) delta_t tensor(0.3021, dtype=torch.float64)
19 gae_duplicate tensor(-0.6978, dtype=torch.float64) tensor(-5.6211, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7860, dtype=torch.float64) delta_t tensor(0.4878, dtype=torch.float64)
18 gae_duplicate tensor(0.2958, dtype=torch.float64) tensor(-9.9156, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7494, dtype=torch.float64) delta_t tensor(0.4349, dtype=torch.float64)
17 gae_duplicate tensor(0.0679, dtype=torch.float64) tensor(-9.8695, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6890, dtype=torch.float64) delta_t tensor(0.3951, dtype=torch.float64)
16 gae_duplicate tensor(-0.2341, dtype=torch.float64) tensor(-8.9880, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8021, dtype=torch.float64) delta_t tensor(0.4861, dtype=torch.float64)
15 gae_duplicate tensor(0.4041, dtype=torch.float64) tensor(-10.2481, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7659, dtype=torch.float64) delta_t tensor(0.4546, dtype=torch.float64)
14 gae_duplicate tensor(0.3206, dtype=torch.float64) tensor(-9.9434, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7297, dtype=torch.float64) delta_t tensor(0.4175, dtype=torch.float64)
13 gae_duplicate tensor(0.0950, dtype=torch.float64) tensor(-9.4554, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6942, dtype=torch.float64) delta_t tensor(0.3665, dtype=torch.float64)
12 gae_duplicate tensor(-0.1898, dtype=torch.float64) tensor(-8.1911, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6683, dtype=torch.float64) delta_t tensor(0.3465, dtype=torch.float64)
11 gae_duplicate tensor(-0.1825, dtype=torch.float64) tensor(-7.5443, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5992, dtype=torch.float64) delta_t tensor(0.2770, dtype=torch.float64)
10 gae_duplicate tensor(-0.3634, dtype=torch.float64) tensor(-6.6407, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1069, dtype=torch.float64) delta_t tensor(-0.1998, dtype=torch.float64)
9 gae_duplicate tensor(-1.3635, dtype=torch.float64) tensor(2.8160, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3089, dtype=torch.float64) delta_t tensor(-0.5988, dtype=torch.float64)
8 gae_duplicate tensor(-1.6634, dtype=torch.float64) tensor(11.0343, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9329, dtype=torch.float64) delta_t tensor(-1.2688, dtype=torch.float64)
7 gae_duplicate tensor(-2.9656, dtype=torch.float64) tensor(25.5707, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1069, dtype=torch.float64) delta_t tensor(-1.4247, dtype=torch.float64)
6 gae_duplicate tensor(-3.2863, dtype=torch.float64) tensor(29.5103, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3092, dtype=torch.float64) delta_t tensor(-1.5753, dtype=torch.float64)
5 gae_duplicate tensor(-2.3565, dtype=torch.float64) tensor(35.0156, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2849, dtype=torch.float64) delta_t tensor(-2.6347, dtype=torch.float64)
4 gae_duplicate tensor(-6.2565, dtype=torch.float64) tensor(56.5505, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7583, dtype=torch.float64) delta_t tensor(-1.0156, dtype=torch.float64)
3 gae_duplicate tensor(-1.7404, dtype=torch.float64) tensor(24.1453, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4788, dtype=torch.float64) delta_t tensor(-0.7591, dtype=torch.float64)
2 gae_duplicate tensor(-1.6457, dtype=torch.float64) tensor(15.5549, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6238.86279296875
value loss:244.86891174316406
entropies:350.8426208496094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.375179052352905 seconds
19 rew tensor(0.8085, dtype=torch.float64) delta_t tensor(0.4726, dtype=torch.float64)
19 gae_duplicate tensor(0.3155, dtype=torch.float64) tensor(-9.4032, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8113, dtype=torch.float64) delta_t tensor(0.5030, dtype=torch.float64)
18 gae_duplicate tensor(0.3479, dtype=torch.float64) tensor(-10.9447, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7830, dtype=torch.float64) delta_t tensor(0.4875, dtype=torch.float64)
17 gae_duplicate tensor(0.1509, dtype=torch.float64) tensor(-10.6173, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7313, dtype=torch.float64) delta_t tensor(0.4169, dtype=torch.float64)
16 gae_duplicate tensor(-0.1520, dtype=torch.float64) tensor(-9.2479, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6485, dtype=torch.float64) delta_t tensor(0.3468, dtype=torch.float64)
15 gae_duplicate tensor(-0.6783, dtype=torch.float64) tensor(-7.8191, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8370, dtype=torch.float64) delta_t tensor(0.5069, dtype=torch.float64)
14 gae_duplicate tensor(0.4002, dtype=torch.float64) tensor(-10.9095, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8323, dtype=torch.float64) delta_t tensor(0.5180, dtype=torch.float64)
13 gae_duplicate tensor(0.3788, dtype=torch.float64) tensor(-11.2520, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8047, dtype=torch.float64) delta_t tensor(0.5000, dtype=torch.float64)
12 gae_duplicate tensor(0.2570, dtype=torch.float64) tensor(-11.0076, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7656, dtype=torch.float64) delta_t tensor(0.4865, dtype=torch.float64)
11 gae_duplicate tensor(0.2696, dtype=torch.float64) tensor(-10.4954, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7226, dtype=torch.float64) delta_t tensor(0.4257, dtype=torch.float64)
10 gae_duplicate tensor(0.2069, dtype=torch.float64) tensor(-9.7271, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4170, dtype=torch.float64) delta_t tensor(0.1433, dtype=torch.float64)
9 gae_duplicate tensor(-0.1952, dtype=torch.float64) tensor(-4.0854, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2879, dtype=torch.float64) delta_t tensor(0.0096, dtype=torch.float64)
8 gae_duplicate tensor(-0.1574, dtype=torch.float64) tensor(-0.4894, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2177, dtype=torch.float64) delta_t tensor(-0.4817, dtype=torch.float64)
7 gae_duplicate tensor(-1.3404, dtype=torch.float64) tensor(9.8887, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5073, dtype=torch.float64) delta_t tensor(-0.7828, dtype=torch.float64)
6 gae_duplicate tensor(-1.7810, dtype=torch.float64) tensor(14.3323, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9585, dtype=torch.float64) delta_t tensor(-1.2606, dtype=torch.float64)
5 gae_duplicate tensor(-2.2228, dtype=torch.float64) tensor(25.1666, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3139, dtype=torch.float64) delta_t tensor(-1.6007, dtype=torch.float64)
4 gae_duplicate tensor(-3.0303, dtype=torch.float64) tensor(29.7964, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0566, dtype=torch.float64) delta_t tensor(-1.2599, dtype=torch.float64)
3 gae_duplicate tensor(-2.5599, dtype=torch.float64) tensor(26.4974, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7732, dtype=torch.float64) delta_t tensor(-0.9567, dtype=torch.float64)
2 gae_duplicate tensor(-1.7433, dtype=torch.float64) tensor(21.6378, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1245.8648681640625
value loss:127.54381561279297
entropies:350.19921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.053277969360352 seconds
19 rew tensor(0.7926, dtype=torch.float64) delta_t tensor(0.4498, dtype=torch.float64)
19 gae_duplicate tensor(0.3952, dtype=torch.float64) tensor(-8.9190, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7725, dtype=torch.float64) delta_t tensor(0.4935, dtype=torch.float64)
18 gae_duplicate tensor(0.3345, dtype=torch.float64) tensor(-10.6620, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7202, dtype=torch.float64) delta_t tensor(0.3800, dtype=torch.float64)
17 gae_duplicate tensor(0.2349, dtype=torch.float64) tensor(-8.5290, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6155, dtype=torch.float64) delta_t tensor(0.3029, dtype=torch.float64)
16 gae_duplicate tensor(-0.0696, dtype=torch.float64) tensor(-6.8308, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4807, dtype=torch.float64) delta_t tensor(0.2115, dtype=torch.float64)
15 gae_duplicate tensor(-0.5151, dtype=torch.float64) tensor(-4.8245, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4763, dtype=torch.float64) delta_t tensor(0.2190, dtype=torch.float64)
14 gae_duplicate tensor(-0.5709, dtype=torch.float64) tensor(-4.7710, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7955, dtype=torch.float64) delta_t tensor(0.5171, dtype=torch.float64)
13 gae_duplicate tensor(0.3736, dtype=torch.float64) tensor(-10.6879, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.5645, dtype=torch.float64)
12 gae_duplicate tensor(0.4990, dtype=torch.float64) tensor(-12.1209, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8095, dtype=torch.float64) delta_t tensor(0.4958, dtype=torch.float64)
11 gae_duplicate tensor(0.3624, dtype=torch.float64) tensor(-11.1460, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8035, dtype=torch.float64) delta_t tensor(0.4712, dtype=torch.float64)
10 gae_duplicate tensor(0.4297, dtype=torch.float64) tensor(-10.4148, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3617, dtype=torch.float64) delta_t tensor(-0.7108, dtype=torch.float64)
9 gae_duplicate tensor(-1.6007, dtype=torch.float64) tensor(13.1690, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6138, dtype=torch.float64) delta_t tensor(-0.9504, dtype=torch.float64)
8 gae_duplicate tensor(-2.6894, dtype=torch.float64) tensor(20.3439, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9961, dtype=torch.float64) delta_t tensor(-1.3393, dtype=torch.float64)
7 gae_duplicate tensor(-4.0447, dtype=torch.float64) tensor(28.2890, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5526, dtype=torch.float64) delta_t tensor(-0.8753, dtype=torch.float64)
6 gae_duplicate tensor(-2.4073, dtype=torch.float64) tensor(19.5620, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4877, dtype=torch.float64) delta_t tensor(-1.7963, dtype=torch.float64)
5 gae_duplicate tensor(-3.7645, dtype=torch.float64) tensor(34.3500, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6273, dtype=torch.float64) delta_t tensor(-3.8976, dtype=torch.float64)
4 gae_duplicate tensor(-6.5248, dtype=torch.float64) tensor(77.0143, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5703, dtype=torch.float64) delta_t tensor(-0.8182, dtype=torch.float64)
3 gae_duplicate tensor(-2.1880, dtype=torch.float64) tensor(23.4017, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3809, dtype=torch.float64) delta_t tensor(-0.6539, dtype=torch.float64)
2 gae_duplicate tensor(-1.1150, dtype=torch.float64) tensor(13.7147, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-7706.1982421875
value loss:364.4613952636719
entropies:353.7359924316406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.137777805328369 seconds
19 rew tensor(0.8110, dtype=torch.float64) delta_t tensor(0.4481, dtype=torch.float64)
19 gae_duplicate tensor(0.3540, dtype=torch.float64) tensor(-8.8602, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8027, dtype=torch.float64) delta_t tensor(0.4907, dtype=torch.float64)
18 gae_duplicate tensor(0.4417, dtype=torch.float64) tensor(-10.5681, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7943, dtype=torch.float64) delta_t tensor(0.4595, dtype=torch.float64)
17 gae_duplicate tensor(0.4511, dtype=torch.float64) tensor(-10.1454, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7966, dtype=torch.float64) delta_t tensor(0.4565, dtype=torch.float64)
16 gae_duplicate tensor(0.4833, dtype=torch.float64) tensor(-10.0385, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7667, dtype=torch.float64) delta_t tensor(0.4211, dtype=torch.float64)
15 gae_duplicate tensor(0.2406, dtype=torch.float64) tensor(-9.3321, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7259, dtype=torch.float64) delta_t tensor(0.3718, dtype=torch.float64)
14 gae_duplicate tensor(-0.0107, dtype=torch.float64) tensor(-8.3355, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7603, dtype=torch.float64) delta_t tensor(0.4815, dtype=torch.float64)
13 gae_duplicate tensor(0.3257, dtype=torch.float64) tensor(-10.2396, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8268, dtype=torch.float64) delta_t tensor(0.5335, dtype=torch.float64)
12 gae_duplicate tensor(0.3925, dtype=torch.float64) tensor(-11.5514, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8294, dtype=torch.float64) delta_t tensor(0.5594, dtype=torch.float64)
11 gae_duplicate tensor(0.5522, dtype=torch.float64) tensor(-12.1514, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8213, dtype=torch.float64) delta_t tensor(0.5555, dtype=torch.float64)
10 gae_duplicate tensor(0.4535, dtype=torch.float64) tensor(-12.3295, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1607, dtype=torch.float64) delta_t tensor(-0.0972, dtype=torch.float64)
9 gae_duplicate tensor(-2.1816, dtype=torch.float64) tensor(0.8356, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2678, dtype=torch.float64) delta_t tensor(-0.5735, dtype=torch.float64)
8 gae_duplicate tensor(-4.0359, dtype=torch.float64) tensor(11.4416, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2246, dtype=torch.float64) delta_t tensor(-0.5388, dtype=torch.float64)
7 gae_duplicate tensor(-3.1376, dtype=torch.float64) tensor(11.7134, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6228, dtype=torch.float64) delta_t tensor(-0.8740, dtype=torch.float64)
6 gae_duplicate tensor(-2.1625, dtype=torch.float64) tensor(18.4383, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8651, dtype=torch.float64) delta_t tensor(-1.1675, dtype=torch.float64)
5 gae_duplicate tensor(-1.7630, dtype=torch.float64) tensor(25.4651, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5658, dtype=torch.float64) delta_t tensor(-1.8303, dtype=torch.float64)
4 gae_duplicate tensor(-4.1299, dtype=torch.float64) tensor(34.9611, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8320, dtype=torch.float64) delta_t tensor(-1.0827, dtype=torch.float64)
3 gae_duplicate tensor(-1.7312, dtype=torch.float64) tensor(24.3769, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7460, dtype=torch.float64) delta_t tensor(-0.9918, dtype=torch.float64)
2 gae_duplicate tensor(-1.5245, dtype=torch.float64) tensor(23.1709, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2625.35107421875
value loss:171.05667114257812
entropies:353.2839050292969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.798316717147827 seconds
19 rew tensor(0.7707, dtype=torch.float64) delta_t tensor(0.4379, dtype=torch.float64)
19 gae_duplicate tensor(0.2601, dtype=torch.float64) tensor(-8.6538, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7419, dtype=torch.float64) delta_t tensor(0.4458, dtype=torch.float64)
18 gae_duplicate tensor(0.2280, dtype=torch.float64) tensor(-9.6684, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6587, dtype=torch.float64) delta_t tensor(0.3558, dtype=torch.float64)
17 gae_duplicate tensor(-0.1060, dtype=torch.float64) tensor(-8.0129, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5216, dtype=torch.float64) delta_t tensor(0.2125, dtype=torch.float64)
16 gae_duplicate tensor(-0.6719, dtype=torch.float64) tensor(-4.9953, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6261, dtype=torch.float64) delta_t tensor(0.3426, dtype=torch.float64)
15 gae_duplicate tensor(-0.7184, dtype=torch.float64) tensor(-7.2544, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8253, dtype=torch.float64) delta_t tensor(0.5379, dtype=torch.float64)
14 gae_duplicate tensor(0.4064, dtype=torch.float64) tensor(-11.3585, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8027, dtype=torch.float64) delta_t tensor(0.5545, dtype=torch.float64)
13 gae_duplicate tensor(0.4688, dtype=torch.float64) tensor(-12.2673, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6008, dtype=torch.float64) delta_t tensor(0.3391, dtype=torch.float64)
12 gae_duplicate tensor(0.0074, dtype=torch.float64) tensor(-7.6369, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5834, dtype=torch.float64) delta_t tensor(0.3250, dtype=torch.float64)
11 gae_duplicate tensor(-0.0210, dtype=torch.float64) tensor(-7.0724, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2980, dtype=torch.float64) delta_t tensor(0.1130, dtype=torch.float64)
10 gae_duplicate tensor(-0.4173, dtype=torch.float64) tensor(-3.0894, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2247, dtype=torch.float64) delta_t tensor(-0.0222, dtype=torch.float64)
9 gae_duplicate tensor(-0.8419, dtype=torch.float64) tensor(0.2003, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0230, dtype=torch.float64) delta_t tensor(-0.3059, dtype=torch.float64)
8 gae_duplicate tensor(-0.8740, dtype=torch.float64) tensor(5.5668, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3259, dtype=torch.float64) delta_t tensor(-0.5812, dtype=torch.float64)
7 gae_duplicate tensor(-1.7727, dtype=torch.float64) tensor(12.3584, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7332, dtype=torch.float64) delta_t tensor(-1.0234, dtype=torch.float64)
6 gae_duplicate tensor(-2.5188, dtype=torch.float64) tensor(21.0237, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6114, dtype=torch.float64) delta_t tensor(-1.9008, dtype=torch.float64)
5 gae_duplicate tensor(-4.0468, dtype=torch.float64) tensor(38.9895, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2278, dtype=torch.float64) delta_t tensor(-1.5294, dtype=torch.float64)
4 gae_duplicate tensor(-3.6300, dtype=torch.float64) tensor(33.6522, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8887, dtype=torch.float64) delta_t tensor(-1.1735, dtype=torch.float64)
3 gae_duplicate tensor(-1.8646, dtype=torch.float64) tensor(26.6939, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7549, dtype=torch.float64) delta_t tensor(-1.0230, dtype=torch.float64)
2 gae_duplicate tensor(-1.7727, dtype=torch.float64) tensor(22.9611, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4492.9619140625
value loss:168.0966339111328
entropies:353.2750244140625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3950.4180)
ToM Target loss= tensor(2876.1018)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.0638439655303955 seconds
19 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.4489, dtype=torch.float64)
19 gae_duplicate tensor(0.3354, dtype=torch.float64) tensor(-8.8605, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8182, dtype=torch.float64) delta_t tensor(0.4890, dtype=torch.float64)
18 gae_duplicate tensor(0.4367, dtype=torch.float64) tensor(-10.5401, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8204, dtype=torch.float64) delta_t tensor(0.5428, dtype=torch.float64)
17 gae_duplicate tensor(0.5381, dtype=torch.float64) tensor(-11.8033, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8226, dtype=torch.float64) delta_t tensor(0.4812, dtype=torch.float64)
16 gae_duplicate tensor(0.4993, dtype=torch.float64) tensor(-10.6898, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8248, dtype=torch.float64) delta_t tensor(0.5448, dtype=torch.float64)
15 gae_duplicate tensor(0.5294, dtype=torch.float64) tensor(-11.8632, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8270, dtype=torch.float64) delta_t tensor(0.5542, dtype=torch.float64)
14 gae_duplicate tensor(0.4975, dtype=torch.float64) tensor(-12.1441, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8292, dtype=torch.float64) delta_t tensor(0.5257, dtype=torch.float64)
13 gae_duplicate tensor(0.4178, dtype=torch.float64) tensor(-11.5979, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7928, dtype=torch.float64) delta_t tensor(0.5483, dtype=torch.float64)
12 gae_duplicate tensor(0.4229, dtype=torch.float64) tensor(-12.1273, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7795, dtype=torch.float64) delta_t tensor(0.4798, dtype=torch.float64)
11 gae_duplicate tensor(0.1682, dtype=torch.float64) tensor(-10.7298, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7431, dtype=torch.float64) delta_t tensor(0.4641, dtype=torch.float64)
10 gae_duplicate tensor(-0.0704, dtype=torch.float64) tensor(-10.2618, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0658, dtype=torch.float64) delta_t tensor(-0.2409, dtype=torch.float64)
9 gae_duplicate tensor(-2.2924, dtype=torch.float64) tensor(3.7060, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0307, dtype=torch.float64) delta_t tensor(-0.3007, dtype=torch.float64)
8 gae_duplicate tensor(-1.8906, dtype=torch.float64) tensor(6.4081, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1992, dtype=torch.float64) delta_t tensor(-0.4673, dtype=torch.float64)
7 gae_duplicate tensor(-1.8698, dtype=torch.float64) tensor(9.6697, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4254, dtype=torch.float64) delta_t tensor(-0.7343, dtype=torch.float64)
6 gae_duplicate tensor(-1.4389, dtype=torch.float64) tensor(15.8342, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1039, dtype=torch.float64) delta_t tensor(-1.4294, dtype=torch.float64)
5 gae_duplicate tensor(-2.6316, dtype=torch.float64) tensor(30.5100, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5648, dtype=torch.float64) delta_t tensor(-1.8506, dtype=torch.float64)
4 gae_duplicate tensor(-3.0151, dtype=torch.float64) tensor(37.4127, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6199, dtype=torch.float64) delta_t tensor(-0.9084, dtype=torch.float64)
3 gae_duplicate tensor(-1.8742, dtype=torch.float64) tensor(22.5949, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8840, dtype=torch.float64) delta_t tensor(-1.0664, dtype=torch.float64)
2 gae_duplicate tensor(-1.6497, dtype=torch.float64) tensor(22.1494, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2129.657958984375
value loss:150.61663818359375
entropies:354.1951904296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.025581121444702 seconds
19 rew tensor(0.7839, dtype=torch.float64) delta_t tensor(0.4420, dtype=torch.float64)
19 gae_duplicate tensor(0.4206, dtype=torch.float64) tensor(-8.7514, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7593, dtype=torch.float64) delta_t tensor(0.4533, dtype=torch.float64)
18 gae_duplicate tensor(0.3640, dtype=torch.float64) tensor(-9.8173, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6943, dtype=torch.float64) delta_t tensor(0.3870, dtype=torch.float64)
17 gae_duplicate tensor(0.0966, dtype=torch.float64) tensor(-8.6351, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5656, dtype=torch.float64) delta_t tensor(0.2645, dtype=torch.float64)
16 gae_duplicate tensor(-0.2854, dtype=torch.float64) tensor(-6.1026, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3517, dtype=torch.float64) delta_t tensor(0.0484, dtype=torch.float64)
15 gae_duplicate tensor(-1.1105, dtype=torch.float64) tensor(-1.5511, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8277, dtype=torch.float64) delta_t tensor(0.5480, dtype=torch.float64)
14 gae_duplicate tensor(0.4528, dtype=torch.float64) tensor(-11.0309, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7960, dtype=torch.float64) delta_t tensor(0.5074, dtype=torch.float64)
13 gae_duplicate tensor(0.4516, dtype=torch.float64) tensor(-11.0737, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6863, dtype=torch.float64) delta_t tensor(0.3973, dtype=torch.float64)
12 gae_duplicate tensor(0.1076, dtype=torch.float64) tensor(-8.9773, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6208, dtype=torch.float64) delta_t tensor(0.3288, dtype=torch.float64)
11 gae_duplicate tensor(0.1605, dtype=torch.float64) tensor(-7.4051, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0430, dtype=torch.float64) delta_t tensor(-0.2493, dtype=torch.float64)
10 gae_duplicate tensor(-0.7777, dtype=torch.float64) tensor(4.1945, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4468, dtype=torch.float64) delta_t tensor(-0.7192, dtype=torch.float64)
9 gae_duplicate tensor(-3.5532, dtype=torch.float64) tensor(14.5469, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7396, dtype=torch.float64) delta_t tensor(-1.0340, dtype=torch.float64)
8 gae_duplicate tensor(-2.9593, dtype=torch.float64) tensor(21.9531, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2405, dtype=torch.float64) delta_t tensor(-0.5078, dtype=torch.float64)
7 gae_duplicate tensor(-1.2091, dtype=torch.float64) tensor(12.2559, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7086, dtype=torch.float64) delta_t tensor(-0.8970, dtype=torch.float64)
6 gae_duplicate tensor(-2.7264, dtype=torch.float64) tensor(19.4398, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4873, dtype=torch.float64) delta_t tensor(-1.6918, dtype=torch.float64)
5 gae_duplicate tensor(-3.4808, dtype=torch.float64) tensor(34.2992, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8008, dtype=torch.float64) delta_t tensor(-1.0612, dtype=torch.float64)
4 gae_duplicate tensor(-2.3840, dtype=torch.float64) tensor(24.4112, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6347, dtype=torch.float64) delta_t tensor(-0.9309, dtype=torch.float64)
3 gae_duplicate tensor(-1.5422, dtype=torch.float64) tensor(20.8177, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6218, dtype=torch.float64) delta_t tensor(-0.8967, dtype=torch.float64)
2 gae_duplicate tensor(-1.6722, dtype=torch.float64) tensor(19.0209, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5365.76953125
value loss:168.52096557617188
entropies:354.26068115234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.480203866958618 seconds
19 rew tensor(0.2560, dtype=torch.float64) delta_t tensor(-0.0822, dtype=torch.float64)
19 gae_duplicate tensor(-1.2252, dtype=torch.float64) tensor(1.6323, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7481, dtype=torch.float64) delta_t tensor(0.4453, dtype=torch.float64)
18 gae_duplicate tensor(0.2263, dtype=torch.float64) tensor(-8.6554, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6642, dtype=torch.float64) delta_t tensor(0.3688, dtype=torch.float64)
17 gae_duplicate tensor(-0.0724, dtype=torch.float64) tensor(-8.1569, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5151, dtype=torch.float64) delta_t tensor(0.2178, dtype=torch.float64)
16 gae_duplicate tensor(-0.6228, dtype=torch.float64) tensor(-5.1094, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6231, dtype=torch.float64) delta_t tensor(0.3390, dtype=torch.float64)
15 gae_duplicate tensor(-0.5901, dtype=torch.float64) tensor(-7.2293, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7642, dtype=torch.float64) delta_t tensor(0.4687, dtype=torch.float64)
14 gae_duplicate tensor(0.3858, dtype=torch.float64) tensor(-9.9921, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6955, dtype=torch.float64) delta_t tensor(0.4199, dtype=torch.float64)
13 gae_duplicate tensor(0.3024, dtype=torch.float64) tensor(-9.3006, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7572, dtype=torch.float64) delta_t tensor(0.4842, dtype=torch.float64)
12 gae_duplicate tensor(0.3383, dtype=torch.float64) tensor(-10.4996, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8357, dtype=torch.float64) delta_t tensor(0.5647, dtype=torch.float64)
11 gae_duplicate tensor(0.4844, dtype=torch.float64) tensor(-12.2111, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5548, dtype=torch.float64) delta_t tensor(0.2951, dtype=torch.float64)
10 gae_duplicate tensor(-0.4317, dtype=torch.float64) tensor(-7.0466, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8869, dtype=torch.float64) delta_t tensor(-1.1401, dtype=torch.float64)
9 gae_duplicate tensor(-3.3919, dtype=torch.float64) tensor(21.8342, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0575, dtype=torch.float64) delta_t tensor(-0.3402, dtype=torch.float64)
8 gae_duplicate tensor(-1.2132, dtype=torch.float64) tensor(8.8971, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2616, dtype=torch.float64) delta_t tensor(-0.5290, dtype=torch.float64)
7 gae_duplicate tensor(-1.9134, dtype=torch.float64) tensor(11.2870, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3948, dtype=torch.float64) delta_t tensor(-1.6337, dtype=torch.float64)
6 gae_duplicate tensor(-3.1588, dtype=torch.float64) tensor(32.3404, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7402, dtype=torch.float64) delta_t tensor(-1.8878, dtype=torch.float64)
5 gae_duplicate tensor(-3.2569, dtype=torch.float64) tensor(39.8305, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9234, dtype=torch.float64) delta_t tensor(-1.1356, dtype=torch.float64)
4 gae_duplicate tensor(-3.2018, dtype=torch.float64) tensor(27.4379, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6518, dtype=torch.float64) delta_t tensor(-0.8664, dtype=torch.float64)
3 gae_duplicate tensor(-1.6694, dtype=torch.float64) tensor(18.8147, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6071, dtype=torch.float64) delta_t tensor(-0.8287, dtype=torch.float64)
2 gae_duplicate tensor(-1.4980, dtype=torch.float64) tensor(17.9186, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5592.49072265625
value loss:191.95021057128906
entropies:354.6043395996094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.760513067245483 seconds
19 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.5153, dtype=torch.float64)
19 gae_duplicate tensor(0.3979, dtype=torch.float64) tensor(-10.1592, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7962, dtype=torch.float64) delta_t tensor(0.5495, dtype=torch.float64)
18 gae_duplicate tensor(0.5382, dtype=torch.float64) tensor(-11.8761, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7518, dtype=torch.float64) delta_t tensor(0.4879, dtype=torch.float64)
17 gae_duplicate tensor(0.3420, dtype=torch.float64) tensor(-10.8352, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6800, dtype=torch.float64) delta_t tensor(0.4062, dtype=torch.float64)
16 gae_duplicate tensor(-0.0978, dtype=torch.float64) tensor(-9.1123, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5771, dtype=torch.float64) delta_t tensor(0.3253, dtype=torch.float64)
15 gae_duplicate tensor(-0.6001, dtype=torch.float64) tensor(-7.3326, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7607, dtype=torch.float64) delta_t tensor(0.5158, dtype=torch.float64)
14 gae_duplicate tensor(0.3939, dtype=torch.float64) tensor(-10.9385, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7043, dtype=torch.float64) delta_t tensor(0.4942, dtype=torch.float64)
13 gae_duplicate tensor(0.2315, dtype=torch.float64) tensor(-10.8754, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8048, dtype=torch.float64) delta_t tensor(0.5379, dtype=torch.float64)
12 gae_duplicate tensor(0.5299, dtype=torch.float64) tensor(-11.7188, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6322, dtype=torch.float64) delta_t tensor(0.3956, dtype=torch.float64)
11 gae_duplicate tensor(0.2312, dtype=torch.float64) tensor(-8.9951, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5557, dtype=torch.float64) delta_t tensor(0.3284, dtype=torch.float64)
10 gae_duplicate tensor(0.0821, dtype=torch.float64) tensor(-7.3878, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0704, dtype=torch.float64) delta_t tensor(-0.1590, dtype=torch.float64)
9 gae_duplicate tensor(-1.3493, dtype=torch.float64) tensor(2.3580, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0640, dtype=torch.float64) delta_t tensor(-0.2846, dtype=torch.float64)
8 gae_duplicate tensor(-0.8358, dtype=torch.float64) tensor(5.5999, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2816, dtype=torch.float64) delta_t tensor(-0.4798, dtype=torch.float64)
7 gae_duplicate tensor(-1.6640, dtype=torch.float64) tensor(10.1667, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9805, dtype=torch.float64) delta_t tensor(-1.1527, dtype=torch.float64)
6 gae_duplicate tensor(-1.8087, dtype=torch.float64) tensor(24.9366, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0848, dtype=torch.float64) delta_t tensor(-1.3479, dtype=torch.float64)
5 gae_duplicate tensor(-2.3160, dtype=torch.float64) tensor(30.1692, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3380, dtype=torch.float64) delta_t tensor(-2.5714, dtype=torch.float64)
4 gae_duplicate tensor(-6.2571, dtype=torch.float64) tensor(54.5736, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7736, dtype=torch.float64) delta_t tensor(-0.9775, dtype=torch.float64)
3 gae_duplicate tensor(-2.1710, dtype=torch.float64) tensor(23.8437, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0512, dtype=torch.float64) delta_t tensor(-1.2135, dtype=torch.float64)
2 gae_duplicate tensor(-2.0528, dtype=torch.float64) tensor(24.9958, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4275.9541015625
value loss:200.7635498046875
entropies:354.34912109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.754510164260864 seconds
19 rew tensor(0.8285, dtype=torch.float64) delta_t tensor(0.5800, dtype=torch.float64)
19 gae_duplicate tensor(0.4619, dtype=torch.float64) tensor(-11.4693, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8302, dtype=torch.float64) delta_t tensor(0.5969, dtype=torch.float64)
18 gae_duplicate tensor(0.5456, dtype=torch.float64) tensor(-12.9379, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8320, dtype=torch.float64) delta_t tensor(0.6080, dtype=torch.float64)
17 gae_duplicate tensor(0.5557, dtype=torch.float64) tensor(-13.3312, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8338, dtype=torch.float64) delta_t tensor(0.5804, dtype=torch.float64)
16 gae_duplicate tensor(0.5703, dtype=torch.float64) tensor(-12.7992, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8356, dtype=torch.float64) delta_t tensor(0.5338, dtype=torch.float64)
15 gae_duplicate tensor(0.4742, dtype=torch.float64) tensor(-11.8450, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7523, dtype=torch.float64) delta_t tensor(0.4626, dtype=torch.float64)
14 gae_duplicate tensor(0.1888, dtype=torch.float64) tensor(-10.3221, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7203, dtype=torch.float64) delta_t tensor(0.4539, dtype=torch.float64)
13 gae_duplicate tensor(0.0331, dtype=torch.float64) tensor(-10.0169, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6873, dtype=torch.float64) delta_t tensor(0.4439, dtype=torch.float64)
12 gae_duplicate tensor(-0.0118, dtype=torch.float64) tensor(-9.7926, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6688, dtype=torch.float64) delta_t tensor(0.4083, dtype=torch.float64)
11 gae_duplicate tensor(0.0958, dtype=torch.float64) tensor(-8.9372, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2317, dtype=torch.float64) delta_t tensor(0.0710, dtype=torch.float64)
10 gae_duplicate tensor(-1.4983, dtype=torch.float64) tensor(-2.3227, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3949, dtype=torch.float64) delta_t tensor(0.2794, dtype=torch.float64)
9 gae_duplicate tensor(-0.3413, dtype=torch.float64) tensor(-5.6457, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1702, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
8 gae_duplicate tensor(-0.1599, dtype=torch.float64) tensor(-0.7070, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1385, dtype=torch.float64) delta_t tensor(-0.3188, dtype=torch.float64)
7 gae_duplicate tensor(-0.8011, dtype=torch.float64) tensor(6.1829, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8437, dtype=torch.float64) delta_t tensor(-1.0864, dtype=torch.float64)
6 gae_duplicate tensor(-1.5985, dtype=torch.float64) tensor(20.4708, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9003, dtype=torch.float64) delta_t tensor(-1.0420, dtype=torch.float64)
5 gae_duplicate tensor(-1.8100, dtype=torch.float64) tensor(24.0912, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1072, dtype=torch.float64) delta_t tensor(-1.2719, dtype=torch.float64)
4 gae_duplicate tensor(-2.3880, dtype=torch.float64) tensor(27.5495, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2955, dtype=torch.float64) delta_t tensor(-1.3545, dtype=torch.float64)
3 gae_duplicate tensor(-2.0656, dtype=torch.float64) tensor(29.0913, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1075, dtype=torch.float64) delta_t tensor(-1.2441, dtype=torch.float64)
2 gae_duplicate tensor(-1.6682, dtype=torch.float64) tensor(26.3608, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1371.10791015625
value loss:126.54560852050781
entropies:354.23779296875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3963.6538)
ToM Target loss= tensor(2922.4121)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.703800916671753 seconds
19 rew tensor(0.8087, dtype=torch.float64) delta_t tensor(0.5763, dtype=torch.float64)
19 gae_duplicate tensor(0.5061, dtype=torch.float64) tensor(-11.3901, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7769, dtype=torch.float64) delta_t tensor(0.5598, dtype=torch.float64)
18 gae_duplicate tensor(0.5139, dtype=torch.float64) tensor(-12.2043, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7286, dtype=torch.float64) delta_t tensor(0.4771, dtype=torch.float64)
17 gae_duplicate tensor(0.1982, dtype=torch.float64) tensor(-10.6643, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6479, dtype=torch.float64) delta_t tensor(0.4023, dtype=torch.float64)
16 gae_duplicate tensor(-0.0767, dtype=torch.float64) tensor(-9.0361, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4925, dtype=torch.float64) delta_t tensor(0.2505, dtype=torch.float64)
15 gae_duplicate tensor(-0.4207, dtype=torch.float64) tensor(-5.8489, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6619, dtype=torch.float64) delta_t tensor(0.4245, dtype=torch.float64)
14 gae_duplicate tensor(-0.2072, dtype=torch.float64) tensor(-9.0037, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7538, dtype=torch.float64) delta_t tensor(0.5302, dtype=torch.float64)
13 gae_duplicate tensor(0.3452, dtype=torch.float64) tensor(-11.4017, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7663, dtype=torch.float64) delta_t tensor(0.5555, dtype=torch.float64)
12 gae_duplicate tensor(0.3052, dtype=torch.float64) tensor(-12.1371, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7227, dtype=torch.float64) delta_t tensor(0.5050, dtype=torch.float64)
11 gae_duplicate tensor(0.2523, dtype=torch.float64) tensor(-11.1910, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6519, dtype=torch.float64) delta_t tensor(0.4681, dtype=torch.float64)
10 gae_duplicate tensor(0.2606, dtype=torch.float64) tensor(-10.3586, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2616, dtype=torch.float64) delta_t tensor(-0.4689, dtype=torch.float64)
9 gae_duplicate tensor(-1.6993, dtype=torch.float64) tensor(8.2506, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1920, dtype=torch.float64) delta_t tensor(-0.4471, dtype=torch.float64)
8 gae_duplicate tensor(-2.0839, dtype=torch.float64) tensor(9.6495, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6482, dtype=torch.float64) delta_t tensor(-0.8621, dtype=torch.float64)
7 gae_duplicate tensor(-2.2002, dtype=torch.float64) tensor(18.1632, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0495, dtype=torch.float64) delta_t tensor(-1.2196, dtype=torch.float64)
6 gae_duplicate tensor(-3.2571, dtype=torch.float64) tensor(26.5183, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8203, dtype=torch.float64) delta_t tensor(-1.9816, dtype=torch.float64)
5 gae_duplicate tensor(-2.9474, dtype=torch.float64) tensor(41.3114, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7654, dtype=torch.float64) delta_t tensor(-3.0173, dtype=torch.float64)
4 gae_duplicate tensor(-7.2977, dtype=torch.float64) tensor(63.1669, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3595, dtype=torch.float64) delta_t tensor(-0.5517, dtype=torch.float64)
3 gae_duplicate tensor(-1.9839, dtype=torch.float64) tensor(17.4646, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5756, dtype=torch.float64) delta_t tensor(-0.5569, dtype=torch.float64)
2 gae_duplicate tensor(-1.1912, dtype=torch.float64) tensor(11.7388, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5119.2919921875
value loss:275.433837890625
entropies:354.8353271484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.801131010055542 seconds
19 rew tensor(0.7824, dtype=torch.float64) delta_t tensor(0.5312, dtype=torch.float64)
19 gae_duplicate tensor(0.4426, dtype=torch.float64) tensor(-10.5054, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7839, dtype=torch.float64) delta_t tensor(0.5709, dtype=torch.float64)
18 gae_duplicate tensor(0.5005, dtype=torch.float64) tensor(-12.3473, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7477, dtype=torch.float64) delta_t tensor(0.5309, dtype=torch.float64)
17 gae_duplicate tensor(0.3091, dtype=torch.float64) tensor(-11.7480, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6795, dtype=torch.float64) delta_t tensor(0.4726, dtype=torch.float64)
16 gae_duplicate tensor(0.0070, dtype=torch.float64) tensor(-10.5049, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5821, dtype=torch.float64) delta_t tensor(0.3709, dtype=torch.float64)
15 gae_duplicate tensor(-0.7152, dtype=torch.float64) tensor(-8.3899, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7534, dtype=torch.float64) delta_t tensor(0.5496, dtype=torch.float64)
14 gae_duplicate tensor(0.4396, dtype=torch.float64) tensor(-11.7125, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6905, dtype=torch.float64) delta_t tensor(0.5325, dtype=torch.float64)
13 gae_duplicate tensor(0.3181, dtype=torch.float64) tensor(-11.7959, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7546, dtype=torch.float64) delta_t tensor(0.5863, dtype=torch.float64)
12 gae_duplicate tensor(0.4852, dtype=torch.float64) tensor(-12.7270, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6157, dtype=torch.float64) delta_t tensor(0.4407, dtype=torch.float64)
11 gae_duplicate tensor(0.0114, dtype=torch.float64) tensor(-10.0025, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5030, dtype=torch.float64) delta_t tensor(0.3525, dtype=torch.float64)
10 gae_duplicate tensor(-0.0481, dtype=torch.float64) tensor(-7.9634, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2056, dtype=torch.float64) delta_t tensor(-0.3797, dtype=torch.float64)
9 gae_duplicate tensor(-2.2999, dtype=torch.float64) tensor(6.9059, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0289, dtype=torch.float64) delta_t tensor(-0.1272, dtype=torch.float64)
8 gae_duplicate tensor(-0.8201, dtype=torch.float64) tensor(3.1028, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5101, dtype=torch.float64) delta_t tensor(-0.6711, dtype=torch.float64)
7 gae_duplicate tensor(-1.7349, dtype=torch.float64) tensor(13.5863, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0608, dtype=torch.float64) delta_t tensor(-1.1645, dtype=torch.float64)
6 gae_duplicate tensor(-2.0095, dtype=torch.float64) tensor(23.9155, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7141, dtype=torch.float64) delta_t tensor(-1.8287, dtype=torch.float64)
5 gae_duplicate tensor(-2.4770, dtype=torch.float64) tensor(36.4222, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6631, dtype=torch.float64) delta_t tensor(-3.7314, dtype=torch.float64)
4 gae_duplicate tensor(-12.5912, dtype=torch.float64) tensor(79.6123, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9210, dtype=torch.float64) delta_t tensor(-1.0753, dtype=torch.float64)
3 gae_duplicate tensor(-2.0213, dtype=torch.float64) tensor(29.8365, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8039, dtype=torch.float64) delta_t tensor(-0.8229, dtype=torch.float64)
2 gae_duplicate tensor(-1.6519, dtype=torch.float64) tensor(16.6855, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5623.61962890625
value loss:433.40374755859375
entropies:354.2146301269531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.785999774932861 seconds
19 rew tensor(0.7851, dtype=torch.float64) delta_t tensor(0.5751, dtype=torch.float64)
19 gae_duplicate tensor(0.4122, dtype=torch.float64) tensor(-11.3988, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7865, dtype=torch.float64) delta_t tensor(0.5939, dtype=torch.float64)
18 gae_duplicate tensor(0.4102, dtype=torch.float64) tensor(-12.8866, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7575, dtype=torch.float64) delta_t tensor(0.5644, dtype=torch.float64)
17 gae_duplicate tensor(0.2904, dtype=torch.float64) tensor(-12.4674, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7057, dtype=torch.float64) delta_t tensor(0.5219, dtype=torch.float64)
16 gae_duplicate tensor(0.0342, dtype=torch.float64) tensor(-11.5782, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6159, dtype=torch.float64) delta_t tensor(0.4251, dtype=torch.float64)
15 gae_duplicate tensor(-0.5445, dtype=torch.float64) tensor(-9.5657, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7929, dtype=torch.float64) delta_t tensor(0.6227, dtype=torch.float64)
14 gae_duplicate tensor(0.5556, dtype=torch.float64) tensor(-13.2692, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7624, dtype=torch.float64) delta_t tensor(0.5951, dtype=torch.float64)
13 gae_duplicate tensor(0.5122, dtype=torch.float64) tensor(-13.0723, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7637, dtype=torch.float64) delta_t tensor(0.6160, dtype=torch.float64)
12 gae_duplicate tensor(0.3862, dtype=torch.float64) tensor(-13.5049, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7322, dtype=torch.float64) delta_t tensor(0.6037, dtype=torch.float64)
11 gae_duplicate tensor(0.4040, dtype=torch.float64) tensor(-13.3165, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6904, dtype=torch.float64) delta_t tensor(0.5311, dtype=torch.float64)
10 gae_duplicate tensor(0.4524, dtype=torch.float64) tensor(-11.8095, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2437, dtype=torch.float64) delta_t tensor(0.1290, dtype=torch.float64)
9 gae_duplicate tensor(-0.3572, dtype=torch.float64) tensor(-3.7315, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1281, dtype=torch.float64) delta_t tensor(-0.2777, dtype=torch.float64)
8 gae_duplicate tensor(-1.3050, dtype=torch.float64) tensor(5.1051, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2240, dtype=torch.float64) delta_t tensor(-0.3653, dtype=torch.float64)
7 gae_duplicate tensor(-0.7285, dtype=torch.float64) tensor(7.8857, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8682, dtype=torch.float64) delta_t tensor(-0.9751, dtype=torch.float64)
6 gae_duplicate tensor(-1.1999, dtype=torch.float64) tensor(19.1680, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9193, dtype=torch.float64) delta_t tensor(-1.0324, dtype=torch.float64)
5 gae_duplicate tensor(-1.9574, dtype=torch.float64) tensor(22.2806, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4658, dtype=torch.float64) delta_t tensor(-1.5345, dtype=torch.float64)
4 gae_duplicate tensor(-2.2271, dtype=torch.float64) tensor(32.1745, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1518, dtype=torch.float64) delta_t tensor(-1.1871, dtype=torch.float64)
3 gae_duplicate tensor(-2.1578, dtype=torch.float64) tensor(24.7407, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0060, dtype=torch.float64) delta_t tensor(-1.0620, dtype=torch.float64)
2 gae_duplicate tensor(-2.0277, dtype=torch.float64) tensor(23.6994, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-552.2174072265625
value loss:129.09609985351562
entropies:354.583984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8749940395355225 seconds
19 rew tensor(0.8053, dtype=torch.float64) delta_t tensor(0.5830, dtype=torch.float64)
19 gae_duplicate tensor(0.4604, dtype=torch.float64) tensor(-11.5213, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8067, dtype=torch.float64) delta_t tensor(0.6185, dtype=torch.float64)
18 gae_duplicate tensor(0.5299, dtype=torch.float64) tensor(-13.3716, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8081, dtype=torch.float64) delta_t tensor(0.6269, dtype=torch.float64)
17 gae_duplicate tensor(0.5448, dtype=torch.float64) tensor(-13.7303, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7947, dtype=torch.float64) delta_t tensor(0.6419, dtype=torch.float64)
16 gae_duplicate tensor(0.5359, dtype=torch.float64) tensor(-14.0915, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7961, dtype=torch.float64) delta_t tensor(0.6247, dtype=torch.float64)
15 gae_duplicate tensor(0.5308, dtype=torch.float64) tensor(-13.7467, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7975, dtype=torch.float64) delta_t tensor(0.6283, dtype=torch.float64)
14 gae_duplicate tensor(0.5042, dtype=torch.float64) tensor(-13.8157, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7431, dtype=torch.float64) delta_t tensor(0.5759, dtype=torch.float64)
13 gae_duplicate tensor(0.4758, dtype=torch.float64) tensor(-12.7746, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7509, dtype=torch.float64) delta_t tensor(0.5652, dtype=torch.float64)
12 gae_duplicate tensor(0.4993, dtype=torch.float64) tensor(-12.4517, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7744, dtype=torch.float64) delta_t tensor(0.6426, dtype=torch.float64)
11 gae_duplicate tensor(0.4915, dtype=torch.float64) tensor(-13.9784, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5514, dtype=torch.float64) delta_t tensor(0.3811, dtype=torch.float64)
10 gae_duplicate tensor(0.1134, dtype=torch.float64) tensor(-8.9407, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1429, dtype=torch.float64) delta_t tensor(0.0361, dtype=torch.float64)
9 gae_duplicate tensor(-1.3507, dtype=torch.float64) tensor(-1.5452, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2911, dtype=torch.float64) delta_t tensor(-0.3792, dtype=torch.float64)
8 gae_duplicate tensor(-1.4672, dtype=torch.float64) tensor(7.3326, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3107, dtype=torch.float64) delta_t tensor(-0.4021, dtype=torch.float64)
7 gae_duplicate tensor(-2.2721, dtype=torch.float64) tensor(8.6114, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9700, dtype=torch.float64) delta_t tensor(-1.0769, dtype=torch.float64)
6 gae_duplicate tensor(-2.5736, dtype=torch.float64) tensor(22.3597, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0167, dtype=torch.float64) delta_t tensor(-1.0626, dtype=torch.float64)
5 gae_duplicate tensor(-1.5849, dtype=torch.float64) tensor(22.6582, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2984, dtype=torch.float64) delta_t tensor(-2.4288, dtype=torch.float64)
4 gae_duplicate tensor(-5.4282, dtype=torch.float64) tensor(48.8802, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9519, dtype=torch.float64) delta_t tensor(-1.1127, dtype=torch.float64)
3 gae_duplicate tensor(-2.1848, dtype=torch.float64) tensor(25.8916, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6443, dtype=torch.float64) delta_t tensor(-0.7491, dtype=torch.float64)
2 gae_duplicate tensor(-1.7733, dtype=torch.float64) tensor(17.2324, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1337.8292236328125
value loss:212.01828002929688
entropies:355.22576904296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.610382080078125 seconds
19 rew tensor(0.7984, dtype=torch.float64) delta_t tensor(0.6172, dtype=torch.float64)
19 gae_duplicate tensor(0.5146, dtype=torch.float64) tensor(-12.2107, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7920, dtype=torch.float64) delta_t tensor(0.6276, dtype=torch.float64)
18 gae_duplicate tensor(0.5136, dtype=torch.float64) tensor(-13.6101, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7779, dtype=torch.float64) delta_t tensor(0.6033, dtype=torch.float64)
17 gae_duplicate tensor(0.3615, dtype=torch.float64) tensor(-13.3031, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7561, dtype=torch.float64) delta_t tensor(0.5870, dtype=torch.float64)
16 gae_duplicate tensor(0.2163, dtype=torch.float64) tensor(-12.9431, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7113, dtype=torch.float64) delta_t tensor(0.5710, dtype=torch.float64)
15 gae_duplicate tensor(-0.0192, dtype=torch.float64) tensor(-12.5810, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6894, dtype=torch.float64) delta_t tensor(0.5850, dtype=torch.float64)
14 gae_duplicate tensor(-0.1473, dtype=torch.float64) tensor(-12.8172, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7326, dtype=torch.float64) delta_t tensor(0.5871, dtype=torch.float64)
13 gae_duplicate tensor(0.4203, dtype=torch.float64) tensor(-12.9234, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7074, dtype=torch.float64) delta_t tensor(0.5688, dtype=torch.float64)
12 gae_duplicate tensor(0.4007, dtype=torch.float64) tensor(-12.5478, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6397, dtype=torch.float64) delta_t tensor(0.5051, dtype=torch.float64)
11 gae_duplicate tensor(0.2973, dtype=torch.float64) tensor(-11.2370, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5711, dtype=torch.float64) delta_t tensor(0.4711, dtype=torch.float64)
10 gae_duplicate tensor(0.2441, dtype=torch.float64) tensor(-10.4525, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3202, dtype=torch.float64) delta_t tensor(0.2114, dtype=torch.float64)
9 gae_duplicate tensor(-0.1017, dtype=torch.float64) tensor(-5.2182, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1557, dtype=torch.float64) delta_t tensor(-0.2831, dtype=torch.float64)
8 gae_duplicate tensor(-1.6413, dtype=torch.float64) tensor(5.0706, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4346, dtype=torch.float64) delta_t tensor(-0.5049, dtype=torch.float64)
7 gae_duplicate tensor(-2.0095, dtype=torch.float64) tensor(10.4773, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1052, dtype=torch.float64) delta_t tensor(-1.2198, dtype=torch.float64)
6 gae_duplicate tensor(-3.0223, dtype=torch.float64) tensor(24.0460, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3119, dtype=torch.float64) delta_t tensor(-1.4861, dtype=torch.float64)
5 gae_duplicate tensor(-2.3009, dtype=torch.float64) tensor(30.4669, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1990, dtype=torch.float64) delta_t tensor(-1.2361, dtype=torch.float64)
4 gae_duplicate tensor(-4.8914, dtype=torch.float64) tensor(28.8690, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1455, dtype=torch.float64) delta_t tensor(-1.1457, dtype=torch.float64)
3 gae_duplicate tensor(-1.7536, dtype=torch.float64) tensor(25.6560, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9246, dtype=torch.float64) delta_t tensor(-0.9732, dtype=torch.float64)
2 gae_duplicate tensor(-1.3751, dtype=torch.float64) tensor(21.7210, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-984.7770385742188
value loss:172.71469116210938
entropies:354.7676086425781
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3965.2646)
ToM Target loss= tensor(2987.9834)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.826416254043579 seconds
19 rew tensor(0.7839, dtype=torch.float64) delta_t tensor(0.6158, dtype=torch.float64)
19 gae_duplicate tensor(0.5001, dtype=torch.float64) tensor(-12.1741, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7456, dtype=torch.float64) delta_t tensor(0.5995, dtype=torch.float64)
18 gae_duplicate tensor(0.5508, dtype=torch.float64) tensor(-13.0762, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7054, dtype=torch.float64) delta_t tensor(0.5419, dtype=torch.float64)
17 gae_duplicate tensor(0.3361, dtype=torch.float64) tensor(-12.0393, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5965, dtype=torch.float64) delta_t tensor(0.4130, dtype=torch.float64)
16 gae_duplicate tensor(0.0672, dtype=torch.float64) tensor(-9.3874, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4296, dtype=torch.float64) delta_t tensor(0.2681, dtype=torch.float64)
15 gae_duplicate tensor(-0.5412, dtype=torch.float64) tensor(-6.2499, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6157, dtype=torch.float64) delta_t tensor(0.4970, dtype=torch.float64)
14 gae_duplicate tensor(-0.0109, dtype=torch.float64) tensor(-10.4807, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8050, dtype=torch.float64) delta_t tensor(0.7127, dtype=torch.float64)
13 gae_duplicate tensor(0.5929, dtype=torch.float64) tensor(-15.1517, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7307, dtype=torch.float64) delta_t tensor(0.6837, dtype=torch.float64)
12 gae_duplicate tensor(0.3951, dtype=torch.float64) tensor(-15.0551, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6935, dtype=torch.float64) delta_t tensor(0.5845, dtype=torch.float64)
11 gae_duplicate tensor(0.3553, dtype=torch.float64) tensor(-13.0653, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1430, dtype=torch.float64) delta_t tensor(0.0657, dtype=torch.float64)
10 gae_duplicate tensor(-2.1457, dtype=torch.float64) tensor(-2.6253, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1202, dtype=torch.float64) delta_t tensor(-0.2470, dtype=torch.float64)
9 gae_duplicate tensor(-1.3861, dtype=torch.float64) tensor(4.6248, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3384, dtype=torch.float64) delta_t tensor(-0.3695, dtype=torch.float64)
8 gae_duplicate tensor(-2.5225, dtype=torch.float64) tensor(7.7887, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6732, dtype=torch.float64) delta_t tensor(-0.7454, dtype=torch.float64)
7 gae_duplicate tensor(-2.5116, dtype=torch.float64) tensor(15.4821, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9669, dtype=torch.float64) delta_t tensor(-1.0114, dtype=torch.float64)
6 gae_duplicate tensor(-1.6475, dtype=torch.float64) tensor(20.9764, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9935, dtype=torch.float64) delta_t tensor(-2.1428, dtype=torch.float64)
5 gae_duplicate tensor(-3.7950, dtype=torch.float64) tensor(44.2230, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9624, dtype=torch.float64) delta_t tensor(-2.9668, dtype=torch.float64)
4 gae_duplicate tensor(-8.3252, dtype=torch.float64) tensor(63.7620, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7604, dtype=torch.float64) delta_t tensor(-0.7350, dtype=torch.float64)
3 gae_duplicate tensor(-1.6966, dtype=torch.float64) tensor(21.1393, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4416, dtype=torch.float64) delta_t tensor(-0.5189, dtype=torch.float64)
2 gae_duplicate tensor(-1.4343, dtype=torch.float64) tensor(11.1294, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4406.2421875
value loss:324.8309326171875
entropies:355.2532653808594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.616422891616821 seconds
19 rew tensor(0.7919, dtype=torch.float64) delta_t tensor(0.6149, dtype=torch.float64)
19 gae_duplicate tensor(0.5199, dtype=torch.float64) tensor(-12.1585, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7706, dtype=torch.float64) delta_t tensor(0.6369, dtype=torch.float64)
18 gae_duplicate tensor(0.5907, dtype=torch.float64) tensor(-13.8011, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7491, dtype=torch.float64) delta_t tensor(0.6233, dtype=torch.float64)
17 gae_duplicate tensor(0.4404, dtype=torch.float64) tensor(-13.7090, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6977, dtype=torch.float64) delta_t tensor(0.5744, dtype=torch.float64)
16 gae_duplicate tensor(0.2573, dtype=torch.float64) tensor(-12.7409, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6161, dtype=torch.float64) delta_t tensor(0.4842, dtype=torch.float64)
15 gae_duplicate tensor(-0.0627, dtype=torch.float64) tensor(-10.8359, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7380, dtype=torch.float64) delta_t tensor(0.6245, dtype=torch.float64)
14 gae_duplicate tensor(0.3024, dtype=torch.float64) tensor(-13.4375, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7090, dtype=torch.float64) delta_t tensor(0.5715, dtype=torch.float64)
13 gae_duplicate tensor(0.3736, dtype=torch.float64) tensor(-12.6367, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7225, dtype=torch.float64) delta_t tensor(0.6189, dtype=torch.float64)
12 gae_duplicate tensor(0.1764, dtype=torch.float64) tensor(-13.5228, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7476, dtype=torch.float64) delta_t tensor(0.6314, dtype=torch.float64)
11 gae_duplicate tensor(0.4156, dtype=torch.float64) tensor(-13.8567, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6323, dtype=torch.float64) delta_t tensor(0.5750, dtype=torch.float64)
10 gae_duplicate tensor(0.0977, dtype=torch.float64) tensor(-12.7586, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0031, dtype=torch.float64) delta_t tensor(-0.0830, dtype=torch.float64)
9 gae_duplicate tensor(-2.2145, dtype=torch.float64) tensor(0.3635, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0483, dtype=torch.float64) delta_t tensor(-0.0155, dtype=torch.float64)
8 gae_duplicate tensor(-0.8522, dtype=torch.float64) tensor(0.3489, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3080, dtype=torch.float64) delta_t tensor(-0.3552, dtype=torch.float64)
7 gae_duplicate tensor(-1.7218, dtype=torch.float64) tensor(7.0888, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6933, dtype=torch.float64) delta_t tensor(-0.7642, dtype=torch.float64)
6 gae_duplicate tensor(-1.6718, dtype=torch.float64) tensor(15.8436, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2243, dtype=torch.float64) delta_t tensor(-1.1566, dtype=torch.float64)
5 gae_duplicate tensor(-2.5335, dtype=torch.float64) tensor(24.9318, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8872, dtype=torch.float64) delta_t tensor(-1.9308, dtype=torch.float64)
4 gae_duplicate tensor(-6.3002, dtype=torch.float64) tensor(41.2892, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9264, dtype=torch.float64) delta_t tensor(-0.7884, dtype=torch.float64)
3 gae_duplicate tensor(-1.2615, dtype=torch.float64) tensor(18.7770, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7722, dtype=torch.float64) delta_t tensor(-0.7609, dtype=torch.float64)
2 gae_duplicate tensor(-1.2821, dtype=torch.float64) tensor(15.1943, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:207.6243133544922
value loss:174.7065887451172
entropies:355.1327819824219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.95887303352356 seconds
19 rew tensor(0.5619, dtype=torch.float64) delta_t tensor(0.4207, dtype=torch.float64)
19 gae_duplicate tensor(-0.7551, dtype=torch.float64) tensor(-8.3082, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7423, dtype=torch.float64) delta_t tensor(0.6288, dtype=torch.float64)
18 gae_duplicate tensor(0.3780, dtype=torch.float64) tensor(-13.2697, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6852, dtype=torch.float64) delta_t tensor(0.5740, dtype=torch.float64)
17 gae_duplicate tensor(0.1011, dtype=torch.float64) tensor(-12.6950, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6069, dtype=torch.float64) delta_t tensor(0.4733, dtype=torch.float64)
16 gae_duplicate tensor(-0.4967, dtype=torch.float64) tensor(-10.6437, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7884, dtype=torch.float64) delta_t tensor(0.6620, dtype=torch.float64)
15 gae_duplicate tensor(0.5210, dtype=torch.float64) tensor(-14.1871, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7747, dtype=torch.float64) delta_t tensor(0.6677, dtype=torch.float64)
14 gae_duplicate tensor(0.5476, dtype=torch.float64) tensor(-14.6287, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7614, dtype=torch.float64) delta_t tensor(0.6420, dtype=torch.float64)
13 gae_duplicate tensor(0.5284, dtype=torch.float64) tensor(-14.1497, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7324, dtype=torch.float64) delta_t tensor(0.6796, dtype=torch.float64)
12 gae_duplicate tensor(0.2741, dtype=torch.float64) tensor(-14.8306, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6889, dtype=torch.float64) delta_t tensor(0.5665, dtype=torch.float64)
11 gae_duplicate tensor(0.1805, dtype=torch.float64) tensor(-12.6936, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5718, dtype=torch.float64) delta_t tensor(0.4565, dtype=torch.float64)
10 gae_duplicate tensor(-0.0311, dtype=torch.float64) tensor(-10.3020, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1517, dtype=torch.float64) delta_t tensor(0.1035, dtype=torch.float64)
9 gae_duplicate tensor(-1.2911, dtype=torch.float64) tensor(-3.0813, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0689, dtype=torch.float64) delta_t tensor(-0.0752, dtype=torch.float64)
8 gae_duplicate tensor(-0.7030, dtype=torch.float64) tensor(1.1670, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2543, dtype=torch.float64) delta_t tensor(-0.3487, dtype=torch.float64)
7 gae_duplicate tensor(-1.0643, dtype=torch.float64) tensor(7.0205, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9632, dtype=torch.float64) delta_t tensor(-0.9558, dtype=torch.float64)
6 gae_duplicate tensor(-1.8062, dtype=torch.float64) tensor(19.5605, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3118, dtype=torch.float64) delta_t tensor(-1.3362, dtype=torch.float64)
5 gae_duplicate tensor(-2.6896, dtype=torch.float64) tensor(28.4630, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3203, dtype=torch.float64) delta_t tensor(-3.3799, dtype=torch.float64)
4 gae_duplicate tensor(-8.0127, dtype=torch.float64) tensor(69.6818, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6848, dtype=torch.float64) delta_t tensor(-0.6192, dtype=torch.float64)
3 gae_duplicate tensor(-2.1674, dtype=torch.float64) tensor(17.9982, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5799, dtype=torch.float64) delta_t tensor(-0.4998, dtype=torch.float64)
2 gae_duplicate tensor(-1.1503, dtype=torch.float64) tensor(11.5422, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1534.6907958984375
value loss:300.201904296875
entropies:355.3222961425781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.731228828430176 seconds
19 rew tensor(0.7332, dtype=torch.float64) delta_t tensor(0.6384, dtype=torch.float64)
19 gae_duplicate tensor(0.4766, dtype=torch.float64) tensor(-12.6324, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7114, dtype=torch.float64) delta_t tensor(0.5846, dtype=torch.float64)
18 gae_duplicate tensor(0.4375, dtype=torch.float64) tensor(-12.8306, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6110, dtype=torch.float64) delta_t tensor(0.4790, dtype=torch.float64)
17 gae_duplicate tensor(0.1740, dtype=torch.float64) tensor(-10.7440, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4606, dtype=torch.float64) delta_t tensor(0.3248, dtype=torch.float64)
16 gae_duplicate tensor(-0.4009, dtype=torch.float64) tensor(-7.4909, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4504, dtype=torch.float64) delta_t tensor(0.3387, dtype=torch.float64)
15 gae_duplicate tensor(-0.7684, dtype=torch.float64) tensor(-7.4729, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6391, dtype=torch.float64) delta_t tensor(0.5498, dtype=torch.float64)
14 gae_duplicate tensor(0.0403, dtype=torch.float64) tensor(-11.6375, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7075, dtype=torch.float64) delta_t tensor(0.6071, dtype=torch.float64)
13 gae_duplicate tensor(0.3820, dtype=torch.float64) tensor(-13.1595, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6467, dtype=torch.float64) delta_t tensor(0.5550, dtype=torch.float64)
12 gae_duplicate tensor(0.2740, dtype=torch.float64) tensor(-12.3037, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6316, dtype=torch.float64) delta_t tensor(0.5697, dtype=torch.float64)
11 gae_duplicate tensor(0.2882, dtype=torch.float64) tensor(-12.4876, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5479, dtype=torch.float64) delta_t tensor(0.4882, dtype=torch.float64)
10 gae_duplicate tensor(0.1377, dtype=torch.float64) tensor(-10.8936, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6235, dtype=torch.float64) delta_t tensor(-0.7197, dtype=torch.float64)
9 gae_duplicate tensor(-2.0697, dtype=torch.float64) tensor(13.1620, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9033, dtype=torch.float64) delta_t tensor(-0.9696, dtype=torch.float64)
8 gae_duplicate tensor(-2.4198, dtype=torch.float64) tensor(20.5085, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4477, dtype=torch.float64) delta_t tensor(-0.4924, dtype=torch.float64)
7 gae_duplicate tensor(-2.0859, dtype=torch.float64) tensor(11.7886, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3396, dtype=torch.float64) delta_t tensor(-1.2962, dtype=torch.float64)
6 gae_duplicate tensor(-3.3431, dtype=torch.float64) tensor(27.0300, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0880, dtype=torch.float64) delta_t tensor(-1.0741, dtype=torch.float64)
5 gae_duplicate tensor(-2.4004, dtype=torch.float64) tensor(24.0840, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7858, dtype=torch.float64) delta_t tensor(-1.7173, dtype=torch.float64)
4 gae_duplicate tensor(-4.7109, dtype=torch.float64) tensor(36.3100, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6894, dtype=torch.float64) delta_t tensor(-0.7353, dtype=torch.float64)
3 gae_duplicate tensor(-1.3624, dtype=torch.float64) tensor(18.1860, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6695, dtype=torch.float64) delta_t tensor(-0.6147, dtype=torch.float64)
2 gae_duplicate tensor(-1.5612, dtype=torch.float64) tensor(14.3717, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3000.607666015625
value loss:204.33734130859375
entropies:355.762451171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7445127964019775 seconds
19 rew tensor(0.7687, dtype=torch.float64) delta_t tensor(0.6317, dtype=torch.float64)
19 gae_duplicate tensor(0.4246, dtype=torch.float64) tensor(-12.5060, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7294, dtype=torch.float64) delta_t tensor(0.6143, dtype=torch.float64)
18 gae_duplicate tensor(0.5249, dtype=torch.float64) tensor(-13.4135, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6982, dtype=torch.float64) delta_t tensor(0.5854, dtype=torch.float64)
17 gae_duplicate tensor(0.4288, dtype=torch.float64) tensor(-12.8893, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6025, dtype=torch.float64) delta_t tensor(0.5036, dtype=torch.float64)
16 gae_duplicate tensor(0.1022, dtype=torch.float64) tensor(-11.2606, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4425, dtype=torch.float64) delta_t tensor(0.3302, dtype=torch.float64)
15 gae_duplicate tensor(-0.4773, dtype=torch.float64) tensor(-7.6619, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7646, dtype=torch.float64) delta_t tensor(0.6557, dtype=torch.float64)
14 gae_duplicate tensor(0.4406, dtype=torch.float64) tensor(-13.6974, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7496, dtype=torch.float64) delta_t tensor(0.6728, dtype=torch.float64)
13 gae_duplicate tensor(0.4041, dtype=torch.float64) tensor(-14.6971, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7163, dtype=torch.float64) delta_t tensor(0.6578, dtype=torch.float64)
12 gae_duplicate tensor(0.5672, dtype=torch.float64) tensor(-14.5067, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7182, dtype=torch.float64) delta_t tensor(0.6897, dtype=torch.float64)
11 gae_duplicate tensor(0.4735, dtype=torch.float64) tensor(-15.0980, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6796, dtype=torch.float64) delta_t tensor(0.5955, dtype=torch.float64)
10 gae_duplicate tensor(0.4124, dtype=torch.float64) tensor(-13.2813, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1000, dtype=torch.float64) delta_t tensor(-0.1524, dtype=torch.float64)
9 gae_duplicate tensor(-1.5273, dtype=torch.float64) tensor(1.6887, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3363, dtype=torch.float64) delta_t tensor(-0.4341, dtype=torch.float64)
8 gae_duplicate tensor(-2.5964, dtype=torch.float64) tensor(8.7139, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8555, dtype=torch.float64) delta_t tensor(-0.8862, dtype=torch.float64)
7 gae_duplicate tensor(-1.8122, dtype=torch.float64) tensor(18.3941, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8245, dtype=torch.float64) delta_t tensor(-0.8169, dtype=torch.float64)
6 gae_duplicate tensor(-2.9529, dtype=torch.float64) tensor(18.0130, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2437, dtype=torch.float64) delta_t tensor(-1.2212, dtype=torch.float64)
5 gae_duplicate tensor(-2.6316, dtype=torch.float64) tensor(26.0699, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4216, dtype=torch.float64) delta_t tensor(-3.3809, dtype=torch.float64)
4 gae_duplicate tensor(-8.3461, dtype=torch.float64) tensor(69.8126, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4132, dtype=torch.float64) delta_t tensor(-0.2929, dtype=torch.float64)
3 gae_duplicate tensor(-1.7084, dtype=torch.float64) tensor(13.2647, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4975, dtype=torch.float64) delta_t tensor(-0.5067, dtype=torch.float64)
2 gae_duplicate tensor(-1.3788, dtype=torch.float64) tensor(12.0445, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2201.3427734375
value loss:338.41259765625
entropies:355.2268981933594
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3953.7590)
ToM Target loss= tensor(3002.1501)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.0722339153289795 seconds
19 rew tensor(0.7473, dtype=torch.float64) delta_t tensor(0.6063, dtype=torch.float64)
19 gae_duplicate tensor(0.4985, dtype=torch.float64) tensor(-12.0105, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7360, dtype=torch.float64) delta_t tensor(0.6102, dtype=torch.float64)
18 gae_duplicate tensor(0.5390, dtype=torch.float64) tensor(-13.2903, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6876, dtype=torch.float64) delta_t tensor(0.5915, dtype=torch.float64)
17 gae_duplicate tensor(0.4004, dtype=torch.float64) tensor(-13.0248, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5950, dtype=torch.float64) delta_t tensor(0.4970, dtype=torch.float64)
16 gae_duplicate tensor(0.2062, dtype=torch.float64) tensor(-11.1359, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4348, dtype=torch.float64) delta_t tensor(0.3163, dtype=torch.float64)
15 gae_duplicate tensor(-0.3801, dtype=torch.float64) tensor(-7.3638, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4608, dtype=torch.float64) delta_t tensor(0.3726, dtype=torch.float64)
14 gae_duplicate tensor(-0.1337, dtype=torch.float64) tensor(-8.1115, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6835, dtype=torch.float64) delta_t tensor(0.6107, dtype=torch.float64)
13 gae_duplicate tensor(0.3986, dtype=torch.float64) tensor(-12.8864, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6927, dtype=torch.float64) delta_t tensor(0.6227, dtype=torch.float64)
12 gae_duplicate tensor(0.2655, dtype=torch.float64) tensor(-13.5999, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7236, dtype=torch.float64) delta_t tensor(0.6548, dtype=torch.float64)
11 gae_duplicate tensor(0.6192, dtype=torch.float64) tensor(-14.3156, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6285, dtype=torch.float64) delta_t tensor(0.5772, dtype=torch.float64)
10 gae_duplicate tensor(0.5369, dtype=torch.float64) tensor(-12.8533, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0498, dtype=torch.float64) delta_t tensor(-0.0195, dtype=torch.float64)
9 gae_duplicate tensor(-1.4398, dtype=torch.float64) tensor(-0.9164, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6356, dtype=torch.float64) delta_t tensor(-0.5970, dtype=torch.float64)
8 gae_duplicate tensor(-3.3250, dtype=torch.float64) tensor(11.7251, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8702, dtype=torch.float64) delta_t tensor(-0.8624, dtype=torch.float64)
7 gae_duplicate tensor(-2.0056, dtype=torch.float64) tensor(18.2223, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3292, dtype=torch.float64) delta_t tensor(-1.2969, dtype=torch.float64)
6 gae_duplicate tensor(-3.5853, dtype=torch.float64) tensor(27.6283, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0980, dtype=torch.float64) delta_t tensor(-1.0530, dtype=torch.float64)
5 gae_duplicate tensor(-1.9620, dtype=torch.float64) tensor(23.6701, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7088, dtype=torch.float64) delta_t tensor(-2.6276, dtype=torch.float64)
4 gae_duplicate tensor(-6.5198, dtype=torch.float64) tensor(54.6072, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5266, dtype=torch.float64) delta_t tensor(-0.4075, dtype=torch.float64)
3 gae_duplicate tensor(-1.5890, dtype=torch.float64) tensor(13.8619, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3655, dtype=torch.float64) delta_t tensor(-0.2635, dtype=torch.float64)
2 gae_duplicate tensor(-0.6238, dtype=torch.float64) tensor(6.1937, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2061.52197265625
value loss:240.5614776611328
entropies:355.2166442871094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.000444173812866 seconds
19 rew tensor(0.6544, dtype=torch.float64) delta_t tensor(0.5684, dtype=torch.float64)
19 gae_duplicate tensor(0.0442, dtype=torch.float64) tensor(-11.2429, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5463, dtype=torch.float64) delta_t tensor(0.4230, dtype=torch.float64)
18 gae_duplicate tensor(-0.5361, dtype=torch.float64) tensor(-9.4849, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7093, dtype=torch.float64) delta_t tensor(0.5878, dtype=torch.float64)
17 gae_duplicate tensor(0.4315, dtype=torch.float64) tensor(-12.5969, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6253, dtype=torch.float64) delta_t tensor(0.4992, dtype=torch.float64)
16 gae_duplicate tensor(0.1588, dtype=torch.float64) tensor(-11.1211, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4956, dtype=torch.float64) delta_t tensor(0.4092, dtype=torch.float64)
15 gae_duplicate tensor(-0.3767, dtype=torch.float64) tensor(-9.2090, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6386, dtype=torch.float64) delta_t tensor(0.5590, dtype=torch.float64)
14 gae_duplicate tensor(-0.2116, dtype=torch.float64) tensor(-11.9894, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6973, dtype=torch.float64) delta_t tensor(0.6060, dtype=torch.float64)
13 gae_duplicate tensor(0.5010, dtype=torch.float64) tensor(-13.1917, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5906, dtype=torch.float64) delta_t tensor(0.5513, dtype=torch.float64)
12 gae_duplicate tensor(0.3706, dtype=torch.float64) tensor(-12.2056, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6511, dtype=torch.float64) delta_t tensor(0.5923, dtype=torch.float64)
11 gae_duplicate tensor(0.3580, dtype=torch.float64) tensor(-12.9437, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3849, dtype=torch.float64) delta_t tensor(0.4150, dtype=torch.float64)
10 gae_duplicate tensor(-0.1092, dtype=torch.float64) tensor(-9.3559, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0644, dtype=torch.float64) delta_t tensor(-1.0824, dtype=torch.float64)
9 gae_duplicate tensor(-4.3817, dtype=torch.float64) tensor(20.9202, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3608, dtype=torch.float64) delta_t tensor(-0.3883, dtype=torch.float64)
8 gae_duplicate tensor(-1.8070, dtype=torch.float64) tensor(9.7607, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3659, dtype=torch.float64) delta_t tensor(-0.3601, dtype=torch.float64)
7 gae_duplicate tensor(-1.9752, dtype=torch.float64) tensor(8.0756, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7252, dtype=torch.float64) delta_t tensor(-0.6019, dtype=torch.float64)
6 gae_duplicate tensor(-1.7033, dtype=torch.float64) tensor(12.6390, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0290, dtype=torch.float64) delta_t tensor(-0.9256, dtype=torch.float64)
5 gae_duplicate tensor(-2.0195, dtype=torch.float64) tensor(19.6899, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8971, dtype=torch.float64) delta_t tensor(-1.7778, dtype=torch.float64)
4 gae_duplicate tensor(-6.3903, dtype=torch.float64) tensor(38.0224, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7303, dtype=torch.float64) delta_t tensor(-0.7066, dtype=torch.float64)
3 gae_duplicate tensor(-1.8935, dtype=torch.float64) tensor(17.3886, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6449, dtype=torch.float64) delta_t tensor(-0.6070, dtype=torch.float64)
2 gae_duplicate tensor(-1.8175, dtype=torch.float64) tensor(13.5539, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1538.2076416015625
value loss:205.9752197265625
entropies:355.21600341796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.580353021621704 seconds
19 rew tensor(0.7208, dtype=torch.float64) delta_t tensor(0.6110, dtype=torch.float64)
19 gae_duplicate tensor(0.3294, dtype=torch.float64) tensor(-12.0963, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6421, dtype=torch.float64) delta_t tensor(0.5709, dtype=torch.float64)
18 gae_duplicate tensor(0.0595, dtype=torch.float64) tensor(-12.4954, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5049, dtype=torch.float64) delta_t tensor(0.4358, dtype=torch.float64)
17 gae_duplicate tensor(-0.4056, dtype=torch.float64) tensor(-9.8805, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5861, dtype=torch.float64) delta_t tensor(0.4999, dtype=torch.float64)
16 gae_duplicate tensor(-0.3880, dtype=torch.float64) tensor(-10.8529, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7590, dtype=torch.float64) delta_t tensor(0.6616, dtype=torch.float64)
15 gae_duplicate tensor(0.5025, dtype=torch.float64) tensor(-14.1617, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7375, dtype=torch.float64) delta_t tensor(0.6585, dtype=torch.float64)
14 gae_duplicate tensor(0.4066, dtype=torch.float64) tensor(-14.4300, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6860, dtype=torch.float64) delta_t tensor(0.5971, dtype=torch.float64)
13 gae_duplicate tensor(0.2715, dtype=torch.float64) tensor(-13.2463, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7389, dtype=torch.float64) delta_t tensor(0.6973, dtype=torch.float64)
12 gae_duplicate tensor(0.5649, dtype=torch.float64) tensor(-15.1139, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7704, dtype=torch.float64) delta_t tensor(0.7574, dtype=torch.float64)
11 gae_duplicate tensor(0.6436, dtype=torch.float64) tensor(-16.4744, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5861, dtype=torch.float64) delta_t tensor(0.5857, dtype=torch.float64)
10 gae_duplicate tensor(0.3925, dtype=torch.float64) tensor(-13.2450, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3080, dtype=torch.float64) delta_t tensor(-0.2473, dtype=torch.float64)
9 gae_duplicate tensor(-1.1223, dtype=torch.float64) tensor(3.5910, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5340, dtype=torch.float64) delta_t tensor(-0.5284, dtype=torch.float64)
8 gae_duplicate tensor(-3.2162, dtype=torch.float64) tensor(10.8081, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8691, dtype=torch.float64) delta_t tensor(-0.8781, dtype=torch.float64)
7 gae_duplicate tensor(-2.6363, dtype=torch.float64) tensor(18.4235, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1078, dtype=torch.float64) delta_t tensor(-1.0123, dtype=torch.float64)
6 gae_duplicate tensor(-2.0097, dtype=torch.float64) tensor(22.1670, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3835, dtype=torch.float64) delta_t tensor(-1.1953, dtype=torch.float64)
5 gae_duplicate tensor(-2.9132, dtype=torch.float64) tensor(25.5261, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9324, dtype=torch.float64) delta_t tensor(-1.7545, dtype=torch.float64)
4 gae_duplicate tensor(-5.8526, dtype=torch.float64) tensor(38.7375, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6842, dtype=torch.float64) delta_t tensor(-0.5044, dtype=torch.float64)
3 gae_duplicate tensor(-1.7176, dtype=torch.float64) tensor(13.1867, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5527, dtype=torch.float64) delta_t tensor(-0.4180, dtype=torch.float64)
2 gae_duplicate tensor(-1.3086, dtype=torch.float64) tensor(8.9038, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-600.6753540039062
value loss:201.86988830566406
entropies:355.2366027832031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.194460153579712 seconds
19 rew tensor(0.7872, dtype=torch.float64) delta_t tensor(0.7215, dtype=torch.float64)
19 gae_duplicate tensor(0.5909, dtype=torch.float64) tensor(-14.2637, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7730, dtype=torch.float64) delta_t tensor(0.7202, dtype=torch.float64)
18 gae_duplicate tensor(0.6272, dtype=torch.float64) tensor(-15.6525, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7508, dtype=torch.float64) delta_t tensor(0.6965, dtype=torch.float64)
17 gae_duplicate tensor(0.6020, dtype=torch.float64) tensor(-15.2946, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7444, dtype=torch.float64) delta_t tensor(0.6617, dtype=torch.float64)
16 gae_duplicate tensor(0.6108, dtype=torch.float64) tensor(-14.6042, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6774, dtype=torch.float64) delta_t tensor(0.5689, dtype=torch.float64)
15 gae_duplicate tensor(0.3550, dtype=torch.float64) tensor(-12.7250, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5865, dtype=torch.float64) delta_t tensor(0.5310, dtype=torch.float64)
14 gae_duplicate tensor(0.1940, dtype=torch.float64) tensor(-11.7668, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7841, dtype=torch.float64) delta_t tensor(0.7136, dtype=torch.float64)
13 gae_duplicate tensor(0.6488, dtype=torch.float64) tensor(-15.2968, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7693, dtype=torch.float64) delta_t tensor(0.7287, dtype=torch.float64)
12 gae_duplicate tensor(0.7695, dtype=torch.float64) tensor(-15.9337, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7545, dtype=torch.float64) delta_t tensor(0.7506, dtype=torch.float64)
11 gae_duplicate tensor(0.7391, dtype=torch.float64) tensor(-16.4149, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6872, dtype=torch.float64) delta_t tensor(0.7083, dtype=torch.float64)
10 gae_duplicate tensor(0.5810, dtype=torch.float64) tensor(-15.6603, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0069, dtype=torch.float64) delta_t tensor(0.0537, dtype=torch.float64)
9 gae_duplicate tensor(-1.1675, dtype=torch.float64) tensor(-2.4003, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1692, dtype=torch.float64) delta_t tensor(0.1777, dtype=torch.float64)
8 gae_duplicate tensor(-0.1277, dtype=torch.float64) tensor(-3.7774, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3118, dtype=torch.float64) delta_t tensor(-0.2842, dtype=torch.float64)
7 gae_duplicate tensor(-1.6055, dtype=torch.float64) tensor(5.2210, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6531, dtype=torch.float64) delta_t tensor(-0.5830, dtype=torch.float64)
6 gae_duplicate tensor(-0.9738, dtype=torch.float64) tensor(11.6920, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8923, dtype=torch.float64) delta_t tensor(-0.7446, dtype=torch.float64)
5 gae_duplicate tensor(-1.3465, dtype=torch.float64) tensor(16.4799, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2499, dtype=torch.float64) delta_t tensor(-1.1562, dtype=torch.float64)
4 gae_duplicate tensor(-2.2580, dtype=torch.float64) tensor(24.1950, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8446, dtype=torch.float64) delta_t tensor(-0.6800, dtype=torch.float64)
3 gae_duplicate tensor(-1.5724, dtype=torch.float64) tensor(15.1775, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5868, dtype=torch.float64) delta_t tensor(-0.3692, dtype=torch.float64)
2 gae_duplicate tensor(-1.0350, dtype=torch.float64) tensor(8.4330, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3824.218017578125
value loss:103.93089294433594
entropies:354.5826110839844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.797917366027832 seconds
19 rew tensor(0.6385, dtype=torch.float64) delta_t tensor(0.5153, dtype=torch.float64)
19 gae_duplicate tensor(-0.0594, dtype=torch.float64) tensor(-10.1670, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5286, dtype=torch.float64) delta_t tensor(0.3910, dtype=torch.float64)
18 gae_duplicate tensor(-0.7270, dtype=torch.float64) tensor(-8.7328, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6899, dtype=torch.float64) delta_t tensor(0.6147, dtype=torch.float64)
17 gae_duplicate tensor(0.0836, dtype=torch.float64) tensor(-13.0545, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6022, dtype=torch.float64) delta_t tensor(0.5126, dtype=torch.float64)
16 gae_duplicate tensor(-0.3910, dtype=torch.float64) tensor(-11.4516, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7570, dtype=torch.float64) delta_t tensor(0.7027, dtype=torch.float64)
15 gae_duplicate tensor(0.6082, dtype=torch.float64) tensor(-15.0314, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7073, dtype=torch.float64) delta_t tensor(0.6862, dtype=torch.float64)
14 gae_duplicate tensor(0.5856, dtype=torch.float64) tensor(-15.0604, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6895, dtype=torch.float64) delta_t tensor(0.7016, dtype=torch.float64)
13 gae_duplicate tensor(0.5811, dtype=torch.float64) tensor(-15.3779, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6875, dtype=torch.float64) delta_t tensor(0.6873, dtype=torch.float64)
12 gae_duplicate tensor(0.5350, dtype=torch.float64) tensor(-15.1382, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7502, dtype=torch.float64) delta_t tensor(0.7953, dtype=torch.float64)
11 gae_duplicate tensor(0.7370, dtype=torch.float64) tensor(-17.2502, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7069, dtype=torch.float64) delta_t tensor(0.7715, dtype=torch.float64)
10 gae_duplicate tensor(0.6498, dtype=torch.float64) tensor(-17.0377, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2684, dtype=torch.float64) delta_t tensor(-0.2849, dtype=torch.float64)
9 gae_duplicate tensor(-3.2259, dtype=torch.float64) tensor(3.9034, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0744, dtype=torch.float64) delta_t tensor(0.0472, dtype=torch.float64)
8 gae_duplicate tensor(-0.9362, dtype=torch.float64) tensor(-0.9582, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4829, dtype=torch.float64) delta_t tensor(-0.3512, dtype=torch.float64)
7 gae_duplicate tensor(-2.4394, dtype=torch.float64) tensor(6.6300, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7513, dtype=torch.float64) delta_t tensor(-0.6533, dtype=torch.float64)
6 gae_duplicate tensor(-1.3160, dtype=torch.float64) tensor(13.7558, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2191, dtype=torch.float64) delta_t tensor(-1.0639, dtype=torch.float64)
5 gae_duplicate tensor(-3.3452, dtype=torch.float64) tensor(21.7844, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2168, dtype=torch.float64) delta_t tensor(-1.0461, dtype=torch.float64)
4 gae_duplicate tensor(-4.0004, dtype=torch.float64) tensor(23.4162, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9119, dtype=torch.float64) delta_t tensor(-0.7530, dtype=torch.float64)
3 gae_duplicate tensor(-1.0486, dtype=torch.float64) tensor(16.6888, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5229, dtype=torch.float64) delta_t tensor(-0.3165, dtype=torch.float64)
2 gae_duplicate tensor(-0.7681, dtype=torch.float64) tensor(7.4131, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2370.510498046875
value loss:153.5828399658203
entropies:353.99737548828125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3946.2937)
ToM Target loss= tensor(3014.0850)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.704416036605835 seconds
19 rew tensor(0.5507, dtype=torch.float64) delta_t tensor(0.4756, dtype=torch.float64)
19 gae_duplicate tensor(-0.5804, dtype=torch.float64) tensor(-9.3698, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7209, dtype=torch.float64) delta_t tensor(0.6695, dtype=torch.float64)
18 gae_duplicate tensor(0.3917, dtype=torch.float64) tensor(-14.1625, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6478, dtype=torch.float64) delta_t tensor(0.5873, dtype=torch.float64)
17 gae_duplicate tensor(0.0621, dtype=torch.float64) tensor(-13.0546, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5295, dtype=torch.float64) delta_t tensor(0.4404, dtype=torch.float64)
16 gae_duplicate tensor(-0.4840, dtype=torch.float64) tensor(-10.0018, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6346, dtype=torch.float64) delta_t tensor(0.5583, dtype=torch.float64)
15 gae_duplicate tensor(0.0299, dtype=torch.float64) tensor(-12.0314, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6972, dtype=torch.float64) delta_t tensor(0.6026, dtype=torch.float64)
14 gae_duplicate tensor(0.4493, dtype=torch.float64) tensor(-13.1283, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6744, dtype=torch.float64) delta_t tensor(0.5941, dtype=torch.float64)
13 gae_duplicate tensor(0.4456, dtype=torch.float64) tensor(-13.0636, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7457, dtype=torch.float64) delta_t tensor(0.7357, dtype=torch.float64)
12 gae_duplicate tensor(0.5724, dtype=torch.float64) tensor(-15.7820, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7215, dtype=torch.float64) delta_t tensor(0.7325, dtype=torch.float64)
11 gae_duplicate tensor(0.5603, dtype=torch.float64) tensor(-16.5100, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6323, dtype=torch.float64) delta_t tensor(0.6101, dtype=torch.float64)
10 gae_duplicate tensor(0.4402, dtype=torch.float64) tensor(-13.8205, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4937, dtype=torch.float64) delta_t tensor(-0.3948, dtype=torch.float64)
9 gae_duplicate tensor(-2.8816, dtype=torch.float64) tensor(6.9753, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0503, dtype=torch.float64) delta_t tensor(-0.9733, dtype=torch.float64)
8 gae_duplicate tensor(-3.0049, dtype=torch.float64) tensor(20.0137, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8528, dtype=torch.float64) delta_t tensor(-0.8512, dtype=torch.float64)
7 gae_duplicate tensor(-1.8986, dtype=torch.float64) tensor(19.2181, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8804, dtype=torch.float64) delta_t tensor(-0.7805, dtype=torch.float64)
6 gae_duplicate tensor(-2.7710, dtype=torch.float64) tensor(17.1778, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2961, dtype=torch.float64) delta_t tensor(-1.1900, dtype=torch.float64)
5 gae_duplicate tensor(-2.1106, dtype=torch.float64) tensor(25.6580, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0303, dtype=torch.float64) delta_t tensor(-2.8339, dtype=torch.float64)
4 gae_duplicate tensor(-6.2590, dtype=torch.float64) tensor(58.9262, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3798, dtype=torch.float64) delta_t tensor(-0.2344, dtype=torch.float64)
3 gae_duplicate tensor(-1.1917, dtype=torch.float64) tensor(10.3994, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5028, dtype=torch.float64) delta_t tensor(-0.3563, dtype=torch.float64)
2 gae_duplicate tensor(-1.0674, dtype=torch.float64) tensor(7.3169, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1972.696044921875
value loss:269.38421630859375
entropies:354.06024169921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.953052282333374 seconds
19 rew tensor(0.7221, dtype=torch.float64) delta_t tensor(0.6197, dtype=torch.float64)
19 gae_duplicate tensor(0.4593, dtype=torch.float64) tensor(-12.2078, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7076, dtype=torch.float64) delta_t tensor(0.5942, dtype=torch.float64)
18 gae_duplicate tensor(0.3825, dtype=torch.float64) tensor(-13.0133, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6144, dtype=torch.float64) delta_t tensor(0.4949, dtype=torch.float64)
17 gae_duplicate tensor(0.1386, dtype=torch.float64) tensor(-11.0805, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4451, dtype=torch.float64) delta_t tensor(0.3810, dtype=torch.float64)
16 gae_duplicate tensor(-0.5282, dtype=torch.float64) tensor(-8.5746, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4979, dtype=torch.float64) delta_t tensor(0.3959, dtype=torch.float64)
15 gae_duplicate tensor(-0.8921, dtype=torch.float64) tensor(-8.6425, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7482, dtype=torch.float64) delta_t tensor(0.6223, dtype=torch.float64)
14 gae_duplicate tensor(0.5020, dtype=torch.float64) tensor(-13.1691, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6798, dtype=torch.float64) delta_t tensor(0.5764, dtype=torch.float64)
13 gae_duplicate tensor(0.3244, dtype=torch.float64) tensor(-12.7029, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7287, dtype=torch.float64) delta_t tensor(0.6576, dtype=torch.float64)
12 gae_duplicate tensor(0.4297, dtype=torch.float64) tensor(-14.1893, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6854, dtype=torch.float64) delta_t tensor(0.6740, dtype=torch.float64)
11 gae_duplicate tensor(0.0574, dtype=torch.float64) tensor(-14.7830, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6331, dtype=torch.float64) delta_t tensor(0.5891, dtype=torch.float64)
10 gae_duplicate tensor(0.0541, dtype=torch.float64) tensor(-13.1107, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2391, dtype=torch.float64) delta_t tensor(-0.2303, dtype=torch.float64)
9 gae_duplicate tensor(-1.9415, dtype=torch.float64) tensor(3.2017, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0230, dtype=torch.float64) delta_t tensor(-0.0929, dtype=torch.float64)
8 gae_duplicate tensor(-1.0197, dtype=torch.float64) tensor(2.1513, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1928, dtype=torch.float64) delta_t tensor(-0.1694, dtype=torch.float64)
7 gae_duplicate tensor(-1.1775, dtype=torch.float64) tensor(3.2330, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9224, dtype=torch.float64) delta_t tensor(-0.8633, dtype=torch.float64)
6 gae_duplicate tensor(-2.7911, dtype=torch.float64) tensor(17.6950, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3888, dtype=torch.float64) delta_t tensor(-1.1156, dtype=torch.float64)
5 gae_duplicate tensor(-4.4688, dtype=torch.float64) tensor(24.8926, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7883, dtype=torch.float64) delta_t tensor(-2.7121, dtype=torch.float64)
4 gae_duplicate tensor(-7.7993, dtype=torch.float64) tensor(59.4306, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7994, dtype=torch.float64) delta_t tensor(-0.6606, dtype=torch.float64)
3 gae_duplicate tensor(-1.5551, dtype=torch.float64) tensor(18.9803, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7374, dtype=torch.float64) delta_t tensor(-0.5880, dtype=torch.float64)
2 gae_duplicate tensor(-1.3497, dtype=torch.float64) tensor(12.4895, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1207.7205810546875
value loss:259.1278991699219
entropies:352.9549560546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.118886947631836 seconds
19 rew tensor(0.6338, dtype=torch.float64) delta_t tensor(0.4990, dtype=torch.float64)
19 gae_duplicate tensor(-0.0324, dtype=torch.float64) tensor(-9.8744, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4921, dtype=torch.float64) delta_t tensor(0.3939, dtype=torch.float64)
18 gae_duplicate tensor(-0.6363, dtype=torch.float64) tensor(-8.7730, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6235, dtype=torch.float64) delta_t tensor(0.5460, dtype=torch.float64)
17 gae_duplicate tensor(-0.0172, dtype=torch.float64) tensor(-11.6737, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4921, dtype=torch.float64) delta_t tensor(0.3659, dtype=torch.float64)
16 gae_duplicate tensor(-0.8511, dtype=torch.float64) tensor(-8.4212, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6957, dtype=torch.float64) delta_t tensor(0.5734, dtype=torch.float64)
15 gae_duplicate tensor(0.3116, dtype=torch.float64) tensor(-12.1562, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5994, dtype=torch.float64) delta_t tensor(0.5230, dtype=torch.float64)
14 gae_duplicate tensor(0.1070, dtype=torch.float64) tensor(-11.5940, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6874, dtype=torch.float64) delta_t tensor(0.6178, dtype=torch.float64)
13 gae_duplicate tensor(0.4190, dtype=torch.float64) tensor(-13.3794, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6307, dtype=torch.float64) delta_t tensor(0.6667, dtype=torch.float64)
12 gae_duplicate tensor(0.5017, dtype=torch.float64) tensor(-14.2593, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6931, dtype=torch.float64) delta_t tensor(0.6511, dtype=torch.float64)
11 gae_duplicate tensor(0.3120, dtype=torch.float64) tensor(-14.2088, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5990, dtype=torch.float64) delta_t tensor(0.5776, dtype=torch.float64)
10 gae_duplicate tensor(0.2625, dtype=torch.float64) tensor(-13.1122, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5251, dtype=torch.float64) delta_t tensor(-0.4923, dtype=torch.float64)
9 gae_duplicate tensor(-1.7717, dtype=torch.float64) tensor(8.1578, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6667, dtype=torch.float64) delta_t tensor(-0.6592, dtype=torch.float64)
8 gae_duplicate tensor(-2.1848, dtype=torch.float64) tensor(14.3007, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3896, dtype=torch.float64) delta_t tensor(-0.2806, dtype=torch.float64)
7 gae_duplicate tensor(-1.1970, dtype=torch.float64) tensor(7.1304, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4810, dtype=torch.float64) delta_t tensor(-1.3615, dtype=torch.float64)
6 gae_duplicate tensor(-2.5098, dtype=torch.float64) tensor(28.3853, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9259, dtype=torch.float64) delta_t tensor(-1.7250, dtype=torch.float64)
5 gae_duplicate tensor(-4.0549, dtype=torch.float64) tensor(31.8692, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6217, dtype=torch.float64) delta_t tensor(-1.4851, dtype=torch.float64)
4 gae_duplicate tensor(-7.1009, dtype=torch.float64) tensor(35.2823, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4339, dtype=torch.float64) delta_t tensor(-0.1822, dtype=torch.float64)
3 gae_duplicate tensor(-0.8571, dtype=torch.float64) tensor(6.0969, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3084, dtype=torch.float64) delta_t tensor(-0.0976, dtype=torch.float64)
2 gae_duplicate tensor(-0.4184, dtype=torch.float64) tensor(2.3279, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-964.5248413085938
value loss:234.22369384765625
entropies:352.6271057128906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.313633918762207 seconds
19 rew tensor(0.7813, dtype=torch.float64) delta_t tensor(0.7282, dtype=torch.float64)
19 gae_duplicate tensor(0.6228, dtype=torch.float64) tensor(-14.6102, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7822, dtype=torch.float64) delta_t tensor(0.7430, dtype=torch.float64)
18 gae_duplicate tensor(0.7135, dtype=torch.float64) tensor(-16.3312, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7748, dtype=torch.float64) delta_t tensor(0.7299, dtype=torch.float64)
17 gae_duplicate tensor(0.6737, dtype=torch.float64) tensor(-15.7447, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7838, dtype=torch.float64) delta_t tensor(0.7195, dtype=torch.float64)
16 gae_duplicate tensor(0.6750, dtype=torch.float64) tensor(-15.7291, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7520, dtype=torch.float64) delta_t tensor(0.6603, dtype=torch.float64)
15 gae_duplicate tensor(0.5888, dtype=torch.float64) tensor(-14.6248, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7690, dtype=torch.float64) delta_t tensor(0.7332, dtype=torch.float64)
14 gae_duplicate tensor(0.6454, dtype=torch.float64) tensor(-15.7958, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7617, dtype=torch.float64) delta_t tensor(0.7114, dtype=torch.float64)
13 gae_duplicate tensor(0.5231, dtype=torch.float64) tensor(-15.0566, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5965, dtype=torch.float64) delta_t tensor(0.5662, dtype=torch.float64)
12 gae_duplicate tensor(0.5017, dtype=torch.float64) tensor(-12.8375, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5908, dtype=torch.float64) delta_t tensor(0.6429, dtype=torch.float64)
11 gae_duplicate tensor(0.3715, dtype=torch.float64) tensor(-13.5013, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5738, dtype=torch.float64) delta_t tensor(0.5707, dtype=torch.float64)
10 gae_duplicate tensor(0.1528, dtype=torch.float64) tensor(-12.7544, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4103, dtype=torch.float64) delta_t tensor(0.5110, dtype=torch.float64)
9 gae_duplicate tensor(0.1562, dtype=torch.float64) tensor(-11.0916, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1677, dtype=torch.float64) delta_t tensor(0.2473, dtype=torch.float64)
8 gae_duplicate tensor(-0.0028, dtype=torch.float64) tensor(-6.2700, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2404, dtype=torch.float64) delta_t tensor(-0.1996, dtype=torch.float64)
7 gae_duplicate tensor(-1.2803, dtype=torch.float64) tensor(3.4423, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9680, dtype=torch.float64) delta_t tensor(-0.7382, dtype=torch.float64)
6 gae_duplicate tensor(-2.2832, dtype=torch.float64) tensor(15.3330, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0700, dtype=torch.float64) delta_t tensor(-0.9287, dtype=torch.float64)
5 gae_duplicate tensor(-2.5988, dtype=torch.float64) tensor(18.1543, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0140, dtype=torch.float64) delta_t tensor(-1.7958, dtype=torch.float64)
4 gae_duplicate tensor(-5.7202, dtype=torch.float64) tensor(37.9148, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7737, dtype=torch.float64) delta_t tensor(-0.7205, dtype=torch.float64)
3 gae_duplicate tensor(-1.1113, dtype=torch.float64) tensor(17.2364, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5415, dtype=torch.float64) delta_t tensor(-0.2269, dtype=torch.float64)
2 gae_duplicate tensor(-1.0113, dtype=torch.float64) tensor(6.3214, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3465.9384765625
value loss:162.6885986328125
entropies:352.20147705078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8290979862213135 seconds
19 rew tensor(0.7651, dtype=torch.float64) delta_t tensor(0.6287, dtype=torch.float64)
19 gae_duplicate tensor(0.5642, dtype=torch.float64) tensor(-12.5000, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7510, dtype=torch.float64) delta_t tensor(0.6222, dtype=torch.float64)
18 gae_duplicate tensor(0.5318, dtype=torch.float64) tensor(-13.6584, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7129, dtype=torch.float64) delta_t tensor(0.5992, dtype=torch.float64)
17 gae_duplicate tensor(0.4023, dtype=torch.float64) tensor(-13.0982, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6690, dtype=torch.float64) delta_t tensor(0.5500, dtype=torch.float64)
16 gae_duplicate tensor(0.1158, dtype=torch.float64) tensor(-12.1095, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5623, dtype=torch.float64) delta_t tensor(0.4673, dtype=torch.float64)
15 gae_duplicate tensor(-0.4974, dtype=torch.float64) tensor(-10.4646, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7371, dtype=torch.float64) delta_t tensor(0.6503, dtype=torch.float64)
14 gae_duplicate tensor(0.4815, dtype=torch.float64) tensor(-14.0822, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6774, dtype=torch.float64) delta_t tensor(0.6066, dtype=torch.float64)
13 gae_duplicate tensor(0.4446, dtype=torch.float64) tensor(-13.3373, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6956, dtype=torch.float64) delta_t tensor(0.7748, dtype=torch.float64)
12 gae_duplicate tensor(0.6068, dtype=torch.float64) tensor(-15.9749, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6492, dtype=torch.float64) delta_t tensor(0.6553, dtype=torch.float64)
11 gae_duplicate tensor(0.5407, dtype=torch.float64) tensor(-14.7736, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5710, dtype=torch.float64) delta_t tensor(0.5166, dtype=torch.float64)
10 gae_duplicate tensor(0.1108, dtype=torch.float64) tensor(-11.7563, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2528, dtype=torch.float64) delta_t tensor(-0.2055, dtype=torch.float64)
9 gae_duplicate tensor(-1.4822, dtype=torch.float64) tensor(2.9789, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2300, dtype=torch.float64) delta_t tensor(-0.3125, dtype=torch.float64)
8 gae_duplicate tensor(-0.9192, dtype=torch.float64) tensor(6.5770, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6930, dtype=torch.float64) delta_t tensor(-0.5970, dtype=torch.float64)
7 gae_duplicate tensor(-4.4355, dtype=torch.float64) tensor(12.2431, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6160, dtype=torch.float64) delta_t tensor(-0.5034, dtype=torch.float64)
6 gae_duplicate tensor(-3.2957, dtype=torch.float64) tensor(11.8018, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2831, dtype=torch.float64) delta_t tensor(-0.9820, dtype=torch.float64)
5 gae_duplicate tensor(-2.2063, dtype=torch.float64) tensor(20.2873, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5787, dtype=torch.float64) delta_t tensor(-1.3004, dtype=torch.float64)
4 gae_duplicate tensor(-5.2508, dtype=torch.float64) tensor(31.4658, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8074, dtype=torch.float64) delta_t tensor(-0.5228, dtype=torch.float64)
3 gae_duplicate tensor(-1.0428, dtype=torch.float64) tensor(11.9189, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6119, dtype=torch.float64) delta_t tensor(-0.3639, dtype=torch.float64)
2 gae_duplicate tensor(-1.0706, dtype=torch.float64) tensor(7.6732, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1352.677734375
value loss:183.36074829101562
entropies:351.876953125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3943.3511)
ToM Target loss= tensor(2997.7935)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.599081993103027 seconds
19 rew tensor(0.7711, dtype=torch.float64) delta_t tensor(0.6227, dtype=torch.float64)
19 gae_duplicate tensor(0.5467, dtype=torch.float64) tensor(-12.1383, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7627, dtype=torch.float64) delta_t tensor(0.6328, dtype=torch.float64)
18 gae_duplicate tensor(0.6189, dtype=torch.float64) tensor(-13.7794, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7361, dtype=torch.float64) delta_t tensor(0.6058, dtype=torch.float64)
17 gae_duplicate tensor(0.4373, dtype=torch.float64) tensor(-13.3140, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6822, dtype=torch.float64) delta_t tensor(0.5651, dtype=torch.float64)
16 gae_duplicate tensor(0.1816, dtype=torch.float64) tensor(-12.4457, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6009, dtype=torch.float64) delta_t tensor(0.5240, dtype=torch.float64)
15 gae_duplicate tensor(-0.2463, dtype=torch.float64) tensor(-11.8884, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6669, dtype=torch.float64) delta_t tensor(0.5160, dtype=torch.float64)
14 gae_duplicate tensor(-0.0977, dtype=torch.float64) tensor(-11.2709, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7692, dtype=torch.float64) delta_t tensor(0.6944, dtype=torch.float64)
13 gae_duplicate tensor(0.5373, dtype=torch.float64) tensor(-14.5062, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6753, dtype=torch.float64) delta_t tensor(0.6734, dtype=torch.float64)
12 gae_duplicate tensor(0.1926, dtype=torch.float64) tensor(-14.4609, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5704, dtype=torch.float64) delta_t tensor(0.4829, dtype=torch.float64)
11 gae_duplicate tensor(0.1214, dtype=torch.float64) tensor(-10.7217, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4901, dtype=torch.float64) delta_t tensor(0.5722, dtype=torch.float64)
10 gae_duplicate tensor(0.2170, dtype=torch.float64) tensor(-11.3435, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1371, dtype=torch.float64) delta_t tensor(-0.1450, dtype=torch.float64)
9 gae_duplicate tensor(-1.3201, dtype=torch.float64) tensor(1.9282, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0147, dtype=torch.float64) delta_t tensor(0.0933, dtype=torch.float64)
8 gae_duplicate tensor(-0.7190, dtype=torch.float64) tensor(-1.0200, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5674, dtype=torch.float64) delta_t tensor(-0.4316, dtype=torch.float64)
7 gae_duplicate tensor(-2.0467, dtype=torch.float64) tensor(8.9640, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5289, dtype=torch.float64) delta_t tensor(-0.2971, dtype=torch.float64)
6 gae_duplicate tensor(-1.8260, dtype=torch.float64) tensor(7.5674, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3022, dtype=torch.float64) delta_t tensor(-1.0463, dtype=torch.float64)
5 gae_duplicate tensor(-2.2692, dtype=torch.float64) tensor(21.8503, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8007, dtype=torch.float64) delta_t tensor(-1.6130, dtype=torch.float64)
4 gae_duplicate tensor(-5.1449, dtype=torch.float64) tensor(31.5354, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4842, dtype=torch.float64) delta_t tensor(-0.3225, dtype=torch.float64)
3 gae_duplicate tensor(-1.0195, dtype=torch.float64) tensor(9.8670, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6736, dtype=torch.float64) delta_t tensor(-0.4660, dtype=torch.float64)
2 gae_duplicate tensor(-1.0677, dtype=torch.float64) tensor(9.2050, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1847.7203369140625
value loss:153.505126953125
entropies:350.9319152832031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.411339044570923 seconds
19 rew tensor(0.7593, dtype=torch.float64) delta_t tensor(0.6046, dtype=torch.float64)
19 gae_duplicate tensor(0.5089, dtype=torch.float64) tensor(-11.8564, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7304, dtype=torch.float64) delta_t tensor(0.6060, dtype=torch.float64)
18 gae_duplicate tensor(0.4213, dtype=torch.float64) tensor(-13.1534, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6865, dtype=torch.float64) delta_t tensor(0.5201, dtype=torch.float64)
17 gae_duplicate tensor(0.2533, dtype=torch.float64) tensor(-11.7167, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5913, dtype=torch.float64) delta_t tensor(0.4564, dtype=torch.float64)
16 gae_duplicate tensor(0.0120, dtype=torch.float64) tensor(-10.3701, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4294, dtype=torch.float64) delta_t tensor(0.2541, dtype=torch.float64)
15 gae_duplicate tensor(-0.6533, dtype=torch.float64) tensor(-5.6910, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7691, dtype=torch.float64) delta_t tensor(0.6194, dtype=torch.float64)
14 gae_duplicate tensor(0.4298, dtype=torch.float64) tensor(-12.8244, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7475, dtype=torch.float64) delta_t tensor(0.5787, dtype=torch.float64)
13 gae_duplicate tensor(0.4459, dtype=torch.float64) tensor(-12.5727, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7621, dtype=torch.float64) delta_t tensor(0.6268, dtype=torch.float64)
12 gae_duplicate tensor(0.5504, dtype=torch.float64) tensor(-13.2730, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7317, dtype=torch.float64) delta_t tensor(0.5985, dtype=torch.float64)
11 gae_duplicate tensor(0.5131, dtype=torch.float64) tensor(-13.0628, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5675, dtype=torch.float64) delta_t tensor(0.5386, dtype=torch.float64)
10 gae_duplicate tensor(0.3281, dtype=torch.float64) tensor(-12.0312, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1810, dtype=torch.float64) delta_t tensor(-0.2720, dtype=torch.float64)
9 gae_duplicate tensor(-2.1038, dtype=torch.float64) tensor(4.3689, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3709, dtype=torch.float64) delta_t tensor(-0.2558, dtype=torch.float64)
8 gae_duplicate tensor(-2.4198, dtype=torch.float64) tensor(5.8491, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0831, dtype=torch.float64) delta_t tensor(-0.0857, dtype=torch.float64)
7 gae_duplicate tensor(-0.7957, dtype=torch.float64) tensor(1.9874, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8297, dtype=torch.float64) delta_t tensor(-0.8303, dtype=torch.float64)
6 gae_duplicate tensor(-1.9082, dtype=torch.float64) tensor(15.6493, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3367, dtype=torch.float64) delta_t tensor(-1.0857, dtype=torch.float64)
5 gae_duplicate tensor(-1.9337, dtype=torch.float64) tensor(26.6982, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7061, dtype=torch.float64) delta_t tensor(-1.4669, dtype=torch.float64)
4 gae_duplicate tensor(-4.9312, dtype=torch.float64) tensor(28.9152, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8410, dtype=torch.float64) delta_t tensor(-0.5771, dtype=torch.float64)
3 gae_duplicate tensor(-1.3796, dtype=torch.float64) tensor(14.9825, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8200, dtype=torch.float64) delta_t tensor(-0.6295, dtype=torch.float64)
2 gae_duplicate tensor(-1.2996, dtype=torch.float64) tensor(13.5018, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:153.48931884765625
value loss:146.72032165527344
entropies:351.34539794921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.684150695800781 seconds
19 rew tensor(0.7553, dtype=torch.float64) delta_t tensor(0.5627, dtype=torch.float64)
19 gae_duplicate tensor(0.4074, dtype=torch.float64) tensor(-10.9445, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7235, dtype=torch.float64) delta_t tensor(0.5642, dtype=torch.float64)
18 gae_duplicate tensor(0.2323, dtype=torch.float64) tensor(-12.3972, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6672, dtype=torch.float64) delta_t tensor(0.5421, dtype=torch.float64)
17 gae_duplicate tensor(-0.0263, dtype=torch.float64) tensor(-11.7510, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5702, dtype=torch.float64) delta_t tensor(0.4026, dtype=torch.float64)
16 gae_duplicate tensor(-0.7522, dtype=torch.float64) tensor(-9.3347, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7821, dtype=torch.float64) delta_t tensor(0.5943, dtype=torch.float64)
15 gae_duplicate tensor(0.4534, dtype=torch.float64) tensor(-12.5481, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7829, dtype=torch.float64) delta_t tensor(0.6244, dtype=torch.float64)
14 gae_duplicate tensor(0.5746, dtype=torch.float64) tensor(-13.4921, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7755, dtype=torch.float64) delta_t tensor(0.7091, dtype=torch.float64)
13 gae_duplicate tensor(0.5564, dtype=torch.float64) tensor(-15.0246, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6573, dtype=torch.float64) delta_t tensor(0.5085, dtype=torch.float64)
12 gae_duplicate tensor(0.3188, dtype=torch.float64) tensor(-11.3796, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6432, dtype=torch.float64) delta_t tensor(0.5589, dtype=torch.float64)
11 gae_duplicate tensor(0.3351, dtype=torch.float64) tensor(-12.0243, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5421, dtype=torch.float64) delta_t tensor(0.5369, dtype=torch.float64)
10 gae_duplicate tensor(0.0657, dtype=torch.float64) tensor(-12.0023, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2243, dtype=torch.float64) delta_t tensor(0.2461, dtype=torch.float64)
9 gae_duplicate tensor(-0.4546, dtype=torch.float64) tensor(-5.6015, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2680, dtype=torch.float64) delta_t tensor(0.1756, dtype=torch.float64)
8 gae_duplicate tensor(-0.0624, dtype=torch.float64) tensor(-4.0930, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0722, dtype=torch.float64) delta_t tensor(-0.1234, dtype=torch.float64)
7 gae_duplicate tensor(-0.9701, dtype=torch.float64) tensor(1.9222, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8854, dtype=torch.float64) delta_t tensor(-0.7605, dtype=torch.float64)
6 gae_duplicate tensor(-1.9873, dtype=torch.float64) tensor(15.2792, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2974, dtype=torch.float64) delta_t tensor(-1.1842, dtype=torch.float64)
5 gae_duplicate tensor(-2.2087, dtype=torch.float64) tensor(25.8054, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7452, dtype=torch.float64) delta_t tensor(-2.4249, dtype=torch.float64)
4 gae_duplicate tensor(-5.1862, dtype=torch.float64) tensor(47.4543, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5630, dtype=torch.float64) delta_t tensor(-0.3276, dtype=torch.float64)
3 gae_duplicate tensor(-1.2573, dtype=torch.float64) tensor(11.3364, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4728, dtype=torch.float64) delta_t tensor(-0.3089, dtype=torch.float64)
2 gae_duplicate tensor(-1.0310, dtype=torch.float64) tensor(6.6771, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1099.62060546875
value loss:175.624755859375
entropies:351.0041198730469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0559821128845215 seconds
19 rew tensor(0.7790, dtype=torch.float64) delta_t tensor(0.5966, dtype=torch.float64)
19 gae_duplicate tensor(0.4774, dtype=torch.float64) tensor(-11.4214, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7638, dtype=torch.float64) delta_t tensor(0.6306, dtype=torch.float64)
18 gae_duplicate tensor(0.5369, dtype=torch.float64) tensor(-13.6160, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7645, dtype=torch.float64) delta_t tensor(0.5968, dtype=torch.float64)
17 gae_duplicate tensor(0.5469, dtype=torch.float64) tensor(-13.2371, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7572, dtype=torch.float64) delta_t tensor(0.5964, dtype=torch.float64)
16 gae_duplicate tensor(0.5096, dtype=torch.float64) tensor(-13.2202, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7340, dtype=torch.float64) delta_t tensor(0.5946, dtype=torch.float64)
15 gae_duplicate tensor(0.4424, dtype=torch.float64) tensor(-12.5206, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6868, dtype=torch.float64) delta_t tensor(0.6221, dtype=torch.float64)
14 gae_duplicate tensor(0.3198, dtype=torch.float64) tensor(-13.8024, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7830, dtype=torch.float64) delta_t tensor(0.6701, dtype=torch.float64)
13 gae_duplicate tensor(0.5277, dtype=torch.float64) tensor(-13.9114, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7670, dtype=torch.float64) delta_t tensor(0.7434, dtype=torch.float64)
12 gae_duplicate tensor(0.6627, dtype=torch.float64) tensor(-15.1608, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7431, dtype=torch.float64) delta_t tensor(0.6656, dtype=torch.float64)
11 gae_duplicate tensor(0.5657, dtype=torch.float64) tensor(-14.5540, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6487, dtype=torch.float64) delta_t tensor(0.5873, dtype=torch.float64)
10 gae_duplicate tensor(0.3999, dtype=torch.float64) tensor(-12.8715, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1019, dtype=torch.float64) delta_t tensor(-0.2738, dtype=torch.float64)
9 gae_duplicate tensor(-2.5600, dtype=torch.float64) tensor(3.2719, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1108, dtype=torch.float64) delta_t tensor(-0.0097, dtype=torch.float64)
8 gae_duplicate tensor(-1.8022, dtype=torch.float64) tensor(1.2065, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0406, dtype=torch.float64) delta_t tensor(0.0566, dtype=torch.float64)
7 gae_duplicate tensor(-0.2999, dtype=torch.float64) tensor(-0.9408, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9306, dtype=torch.float64) delta_t tensor(-0.6840, dtype=torch.float64)
6 gae_duplicate tensor(-2.9777, dtype=torch.float64) tensor(11.4669, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9210, dtype=torch.float64) delta_t tensor(-0.7597, dtype=torch.float64)
5 gae_duplicate tensor(-2.0795, dtype=torch.float64) tensor(14.6563, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8846, dtype=torch.float64) delta_t tensor(-1.6363, dtype=torch.float64)
4 gae_duplicate tensor(-5.1405, dtype=torch.float64) tensor(33.9340, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4715, dtype=torch.float64) delta_t tensor(-0.2933, dtype=torch.float64)
3 gae_duplicate tensor(-1.0658, dtype=torch.float64) tensor(7.5499, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8089, dtype=torch.float64) delta_t tensor(-0.4981, dtype=torch.float64)
2 gae_duplicate tensor(-1.4338, dtype=torch.float64) tensor(10.4254, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2754.25146484375
value loss:146.05877685546875
entropies:348.19757080078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.978227138519287 seconds
19 rew tensor(0.7244, dtype=torch.float64) delta_t tensor(0.5488, dtype=torch.float64)
19 gae_duplicate tensor(0.3911, dtype=torch.float64) tensor(-10.8514, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6851, dtype=torch.float64) delta_t tensor(0.5366, dtype=torch.float64)
18 gae_duplicate tensor(0.3071, dtype=torch.float64) tensor(-11.7772, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5792, dtype=torch.float64) delta_t tensor(0.4203, dtype=torch.float64)
17 gae_duplicate tensor(-0.0468, dtype=torch.float64) tensor(-9.5276, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4158, dtype=torch.float64) delta_t tensor(0.2416, dtype=torch.float64)
16 gae_duplicate tensor(-0.6263, dtype=torch.float64) tensor(-5.9741, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4721, dtype=torch.float64) delta_t tensor(0.2955, dtype=torch.float64)
15 gae_duplicate tensor(-0.5834, dtype=torch.float64) tensor(-6.5039, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5639, dtype=torch.float64) delta_t tensor(0.3550, dtype=torch.float64)
14 gae_duplicate tensor(-0.7539, dtype=torch.float64) tensor(-7.6576, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7593, dtype=torch.float64) delta_t tensor(0.6164, dtype=torch.float64)
13 gae_duplicate tensor(0.4810, dtype=torch.float64) tensor(-12.6560, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6022, dtype=torch.float64) delta_t tensor(0.4288, dtype=torch.float64)
12 gae_duplicate tensor(0.1622, dtype=torch.float64) tensor(-9.0707, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6368, dtype=torch.float64) delta_t tensor(0.5507, dtype=torch.float64)
11 gae_duplicate tensor(0.1616, dtype=torch.float64) tensor(-10.6253, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5022, dtype=torch.float64) delta_t tensor(0.4332, dtype=torch.float64)
10 gae_duplicate tensor(0.3326, dtype=torch.float64) tensor(-10.0447, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4934, dtype=torch.float64) delta_t tensor(-0.6197, dtype=torch.float64)
9 gae_duplicate tensor(-1.8307, dtype=torch.float64) tensor(11.0488, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2284, dtype=torch.float64) delta_t tensor(-0.1864, dtype=torch.float64)
8 gae_duplicate tensor(-1.9645, dtype=torch.float64) tensor(5.3647, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0990, dtype=torch.float64) delta_t tensor(0.0324, dtype=torch.float64)
7 gae_duplicate tensor(-1.0199, dtype=torch.float64) tensor(0.4082, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8658, dtype=torch.float64) delta_t tensor(-0.7588, dtype=torch.float64)
6 gae_duplicate tensor(-1.5589, dtype=torch.float64) tensor(13.4970, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6534, dtype=torch.float64) delta_t tensor(-1.5393, dtype=torch.float64)
5 gae_duplicate tensor(-3.1332, dtype=torch.float64) tensor(35.1002, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1454, dtype=torch.float64) delta_t tensor(-0.8774, dtype=torch.float64)
4 gae_duplicate tensor(-2.5410, dtype=torch.float64) tensor(17.6561, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5882, dtype=torch.float64) delta_t tensor(-0.3980, dtype=torch.float64)
3 gae_duplicate tensor(-1.3843, dtype=torch.float64) tensor(9.7030, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5262, dtype=torch.float64) delta_t tensor(-0.2197, dtype=torch.float64)
2 gae_duplicate tensor(-0.8351, dtype=torch.float64) tensor(3.9435, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-203.52890014648438
value loss:119.22882080078125
entropies:347.2001037597656
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3942.8967)
ToM Target loss= tensor(3002.5149)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.723369359970093 seconds
19 rew tensor(0.7566, dtype=torch.float64) delta_t tensor(0.5127, dtype=torch.float64)
19 gae_duplicate tensor(0.4278, dtype=torch.float64) tensor(-10.2486, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7329, dtype=torch.float64) delta_t tensor(0.5437, dtype=torch.float64)
18 gae_duplicate tensor(0.4299, dtype=torch.float64) tensor(-11.8120, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7176, dtype=torch.float64) delta_t tensor(0.5413, dtype=torch.float64)
17 gae_duplicate tensor(0.3065, dtype=torch.float64) tensor(-11.5196, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6290, dtype=torch.float64) delta_t tensor(0.4558, dtype=torch.float64)
16 gae_duplicate tensor(0.0294, dtype=torch.float64) tensor(-10.7412, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5337, dtype=torch.float64) delta_t tensor(0.3858, dtype=torch.float64)
15 gae_duplicate tensor(-0.5944, dtype=torch.float64) tensor(-8.4677, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6496, dtype=torch.float64) delta_t tensor(0.5023, dtype=torch.float64)
14 gae_duplicate tensor(0.2367, dtype=torch.float64) tensor(-10.2664, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7345, dtype=torch.float64) delta_t tensor(0.5605, dtype=torch.float64)
13 gae_duplicate tensor(0.3754, dtype=torch.float64) tensor(-12.1540, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7268, dtype=torch.float64) delta_t tensor(0.5930, dtype=torch.float64)
12 gae_duplicate tensor(0.5752, dtype=torch.float64) tensor(-12.5625, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6875, dtype=torch.float64) delta_t tensor(0.5604, dtype=torch.float64)
11 gae_duplicate tensor(0.3581, dtype=torch.float64) tensor(-11.9527, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6554, dtype=torch.float64) delta_t tensor(0.5973, dtype=torch.float64)
10 gae_duplicate tensor(0.1216, dtype=torch.float64) tensor(-12.5964, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1692, dtype=torch.float64) delta_t tensor(-0.2764, dtype=torch.float64)
9 gae_duplicate tensor(-1.4270, dtype=torch.float64) tensor(4.1432, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0406, dtype=torch.float64) delta_t tensor(-0.0889, dtype=torch.float64)
8 gae_duplicate tensor(-1.7807, dtype=torch.float64) tensor(2.7858, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2440, dtype=torch.float64) delta_t tensor(-1.2602, dtype=torch.float64)
7 gae_duplicate tensor(-2.9038, dtype=torch.float64) tensor(23.8682, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9472, dtype=torch.float64) delta_t tensor(-0.8040, dtype=torch.float64)
6 gae_duplicate tensor(-3.0822, dtype=torch.float64) tensor(16.1088, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9998, dtype=torch.float64) delta_t tensor(-0.8159, dtype=torch.float64)
5 gae_duplicate tensor(-2.0718, dtype=torch.float64) tensor(17.3308, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5891, dtype=torch.float64) delta_t tensor(-3.3844, dtype=torch.float64)
4 gae_duplicate tensor(-12.1240, dtype=torch.float64) tensor(68.6210, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5698, dtype=torch.float64) delta_t tensor(-0.4699, dtype=torch.float64)
3 gae_duplicate tensor(-1.2350, dtype=torch.float64) tensor(14.9021, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2457, dtype=torch.float64) delta_t tensor(0.0384, dtype=torch.float64)
2 gae_duplicate tensor(-0.3310, dtype=torch.float64) tensor(0.5588, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2037.086181640625
value loss:387.39215087890625
entropies:345.20928955078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.144500017166138 seconds
19 rew tensor(0.7403, dtype=torch.float64) delta_t tensor(0.5170, dtype=torch.float64)
19 gae_duplicate tensor(0.4945, dtype=torch.float64) tensor(-10.0648, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7243, dtype=torch.float64) delta_t tensor(0.5284, dtype=torch.float64)
18 gae_duplicate tensor(0.4681, dtype=torch.float64) tensor(-10.5776, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6505, dtype=torch.float64) delta_t tensor(0.4333, dtype=torch.float64)
17 gae_duplicate tensor(0.3237, dtype=torch.float64) tensor(-9.7735, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5019, dtype=torch.float64) delta_t tensor(0.2985, dtype=torch.float64)
16 gae_duplicate tensor(-0.1998, dtype=torch.float64) tensor(-6.3515, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2962, dtype=torch.float64) delta_t tensor(0.1670, dtype=torch.float64)
15 gae_duplicate tensor(-0.4259, dtype=torch.float64) tensor(-2.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4767, dtype=torch.float64) delta_t tensor(0.3270, dtype=torch.float64)
14 gae_duplicate tensor(-0.4490, dtype=torch.float64) tensor(-6.9210, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7757, dtype=torch.float64) delta_t tensor(0.6118, dtype=torch.float64)
13 gae_duplicate tensor(0.4795, dtype=torch.float64) tensor(-13.1983, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7461, dtype=torch.float64) delta_t tensor(0.6693, dtype=torch.float64)
12 gae_duplicate tensor(0.4542, dtype=torch.float64) tensor(-12.9850, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7316, dtype=torch.float64) delta_t tensor(0.6736, dtype=torch.float64)
11 gae_duplicate tensor(0.4645, dtype=torch.float64) tensor(-13.6873, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6286, dtype=torch.float64) delta_t tensor(0.6173, dtype=torch.float64)
10 gae_duplicate tensor(0.0724, dtype=torch.float64) tensor(-13.3409, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1990, dtype=torch.float64) delta_t tensor(-0.3324, dtype=torch.float64)
9 gae_duplicate tensor(-1.6708, dtype=torch.float64) tensor(4.3500, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3528, dtype=torch.float64) delta_t tensor(-0.4338, dtype=torch.float64)
8 gae_duplicate tensor(-1.8595, dtype=torch.float64) tensor(11.0890, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0837, dtype=torch.float64) delta_t tensor(-0.2057, dtype=torch.float64)
7 gae_duplicate tensor(-0.6915, dtype=torch.float64) tensor(4.0737, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8244, dtype=torch.float64) delta_t tensor(-0.6585, dtype=torch.float64)
6 gae_duplicate tensor(-2.9546, dtype=torch.float64) tensor(12.9613, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6169, dtype=torch.float64) delta_t tensor(-0.5653, dtype=torch.float64)
5 gae_duplicate tensor(-1.5222, dtype=torch.float64) tensor(11.3737, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1544, dtype=torch.float64) delta_t tensor(-1.9256, dtype=torch.float64)
4 gae_duplicate tensor(-4.4027, dtype=torch.float64) tensor(33.4489, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7128, dtype=torch.float64) delta_t tensor(-0.4124, dtype=torch.float64)
3 gae_duplicate tensor(-1.1371, dtype=torch.float64) tensor(10.3164, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6027, dtype=torch.float64) delta_t tensor(-0.3349, dtype=torch.float64)
2 gae_duplicate tensor(-1.0227, dtype=torch.float64) tensor(6.2741, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:225.73703002929688
value loss:138.86166381835938
entropies:339.4645690917969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.044720888137817 seconds
19 rew tensor(0.5612, dtype=torch.float64) delta_t tensor(0.3260, dtype=torch.float64)
19 gae_duplicate tensor(-0.8853, dtype=torch.float64) tensor(-5.6569, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7580, dtype=torch.float64) delta_t tensor(0.5542, dtype=torch.float64)
18 gae_duplicate tensor(0.2928, dtype=torch.float64) tensor(-9.3394, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7256, dtype=torch.float64) delta_t tensor(0.5228, dtype=torch.float64)
17 gae_duplicate tensor(0.4007, dtype=torch.float64) tensor(-11.0408, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6922, dtype=torch.float64) delta_t tensor(0.4790, dtype=torch.float64)
16 gae_duplicate tensor(0.1344, dtype=torch.float64) tensor(-10.3931, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6098, dtype=torch.float64) delta_t tensor(0.4703, dtype=torch.float64)
15 gae_duplicate tensor(0.1276, dtype=torch.float64) tensor(-10.9947, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7312, dtype=torch.float64) delta_t tensor(0.5382, dtype=torch.float64)
14 gae_duplicate tensor(0.4044, dtype=torch.float64) tensor(-11.6793, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6877, dtype=torch.float64) delta_t tensor(0.5870, dtype=torch.float64)
13 gae_duplicate tensor(0.3301, dtype=torch.float64) tensor(-13.3041, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7403, dtype=torch.float64) delta_t tensor(0.6346, dtype=torch.float64)
12 gae_duplicate tensor(0.5631, dtype=torch.float64) tensor(-12.5325, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7627, dtype=torch.float64) delta_t tensor(0.7215, dtype=torch.float64)
11 gae_duplicate tensor(0.6253, dtype=torch.float64) tensor(-13.2922, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7050, dtype=torch.float64) delta_t tensor(0.6863, dtype=torch.float64)
10 gae_duplicate tensor(0.4029, dtype=torch.float64) tensor(-13.8016, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5541, dtype=torch.float64) delta_t tensor(-0.5598, dtype=torch.float64)
9 gae_duplicate tensor(-2.1725, dtype=torch.float64) tensor(8.5017, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6317, dtype=torch.float64) delta_t tensor(-0.5530, dtype=torch.float64)
8 gae_duplicate tensor(-2.4835, dtype=torch.float64) tensor(7.9484, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5477, dtype=torch.float64) delta_t tensor(-0.4495, dtype=torch.float64)
7 gae_duplicate tensor(-2.2456, dtype=torch.float64) tensor(9.1030, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7409, dtype=torch.float64) delta_t tensor(-0.6248, dtype=torch.float64)
6 gae_duplicate tensor(-2.8025, dtype=torch.float64) tensor(9.5974, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9683, dtype=torch.float64) delta_t tensor(-0.9096, dtype=torch.float64)
5 gae_duplicate tensor(-2.2684, dtype=torch.float64) tensor(15.7875, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7064, dtype=torch.float64) delta_t tensor(-0.4503, dtype=torch.float64)
4 gae_duplicate tensor(-1.6729, dtype=torch.float64) tensor(9.9071, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1188, dtype=torch.float64) delta_t tensor(0.1403, dtype=torch.float64)
3 gae_duplicate tensor(-0.8036, dtype=torch.float64) tensor(-1.6382, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5643, dtype=torch.float64) delta_t tensor(-0.3334, dtype=torch.float64)
2 gae_duplicate tensor(-0.8958, dtype=torch.float64) tensor(7.0232, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2383.853271484375
value loss:121.21456909179688
entropies:331.78887939453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.933043956756592 seconds
19 rew tensor(0.7519, dtype=torch.float64) delta_t tensor(0.5280, dtype=torch.float64)
19 gae_duplicate tensor(0.2904, dtype=torch.float64) tensor(-10.9405, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7281, dtype=torch.float64) delta_t tensor(0.5597, dtype=torch.float64)
18 gae_duplicate tensor(0.4282, dtype=torch.float64) tensor(-12.7473, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6716, dtype=torch.float64) delta_t tensor(0.4812, dtype=torch.float64)
17 gae_duplicate tensor(-0.0240, dtype=torch.float64) tensor(-8.9740, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5826, dtype=torch.float64) delta_t tensor(0.4044, dtype=torch.float64)
16 gae_duplicate tensor(-0.2462, dtype=torch.float64) tensor(-9.0116, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7785, dtype=torch.float64) delta_t tensor(0.6900, dtype=torch.float64)
15 gae_duplicate tensor(0.5332, dtype=torch.float64) tensor(-14.9558, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7791, dtype=torch.float64) delta_t tensor(0.6699, dtype=torch.float64)
14 gae_duplicate tensor(0.5339, dtype=torch.float64) tensor(-13.8971, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7469, dtype=torch.float64) delta_t tensor(0.6423, dtype=torch.float64)
13 gae_duplicate tensor(0.3881, dtype=torch.float64) tensor(-13.2505, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6821, dtype=torch.float64) delta_t tensor(0.6377, dtype=torch.float64)
12 gae_duplicate tensor(0.2878, dtype=torch.float64) tensor(-11.4380, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5730, dtype=torch.float64) delta_t tensor(0.5205, dtype=torch.float64)
11 gae_duplicate tensor(0.2456, dtype=torch.float64) tensor(-11.0979, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3187, dtype=torch.float64) delta_t tensor(0.1465, dtype=torch.float64)
10 gae_duplicate tensor(-0.0697, dtype=torch.float64) tensor(-4.2723, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0966, dtype=torch.float64) delta_t tensor(0.0455, dtype=torch.float64)
9 gae_duplicate tensor(-0.2344, dtype=torch.float64) tensor(-0.9259, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0914, dtype=torch.float64) delta_t tensor(-0.1137, dtype=torch.float64)
8 gae_duplicate tensor(-0.6258, dtype=torch.float64) tensor(2.7941, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2320, dtype=torch.float64) delta_t tensor(0.0056, dtype=torch.float64)
7 gae_duplicate tensor(-0.5860, dtype=torch.float64) tensor(-0.1653, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7527, dtype=torch.float64) delta_t tensor(-0.6940, dtype=torch.float64)
6 gae_duplicate tensor(-1.2849, dtype=torch.float64) tensor(14.2500, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9391, dtype=torch.float64) delta_t tensor(-0.7001, dtype=torch.float64)
5 gae_duplicate tensor(-1.3425, dtype=torch.float64) tensor(10.5091, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6907, dtype=torch.float64) delta_t tensor(-0.4121, dtype=torch.float64)
4 gae_duplicate tensor(-1.4487, dtype=torch.float64) tensor(9.1563, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5537, dtype=torch.float64) delta_t tensor(-0.3045, dtype=torch.float64)
3 gae_duplicate tensor(-1.2310, dtype=torch.float64) tensor(7.1257, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8418, dtype=torch.float64) delta_t tensor(-0.6236, dtype=torch.float64)
2 gae_duplicate tensor(-1.2577, dtype=torch.float64) tensor(12.3686, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2907.492431640625
value loss:77.08480072021484
entropies:325.965576171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.979731798171997 seconds
19 rew tensor(0.7670, dtype=torch.float64) delta_t tensor(0.5097, dtype=torch.float64)
19 gae_duplicate tensor(0.3961, dtype=torch.float64) tensor(-8.7315, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7597, dtype=torch.float64) delta_t tensor(0.5493, dtype=torch.float64)
18 gae_duplicate tensor(0.4897, dtype=torch.float64) tensor(-11.3103, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7525, dtype=torch.float64) delta_t tensor(0.4964, dtype=torch.float64)
17 gae_duplicate tensor(0.3841, dtype=torch.float64) tensor(-9.4265, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7296, dtype=torch.float64) delta_t tensor(0.4766, dtype=torch.float64)
16 gae_duplicate tensor(0.2406, dtype=torch.float64) tensor(-8.4145, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6753, dtype=torch.float64) delta_t tensor(0.4325, dtype=torch.float64)
15 gae_duplicate tensor(-0.0553, dtype=torch.float64) tensor(-8.4695, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5818, dtype=torch.float64) delta_t tensor(0.3428, dtype=torch.float64)
14 gae_duplicate tensor(-0.6368, dtype=torch.float64) tensor(-7.7381, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7781, dtype=torch.float64) delta_t tensor(0.5303, dtype=torch.float64)
13 gae_duplicate tensor(0.4620, dtype=torch.float64) tensor(-10.6244, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7787, dtype=torch.float64) delta_t tensor(0.5798, dtype=torch.float64)
12 gae_duplicate tensor(0.4723, dtype=torch.float64) tensor(-13.4481, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7473, dtype=torch.float64) delta_t tensor(0.6455, dtype=torch.float64)
11 gae_duplicate tensor(0.4899, dtype=torch.float64) tensor(-13.1422, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5416, dtype=torch.float64) delta_t tensor(0.3993, dtype=torch.float64)
10 gae_duplicate tensor(0.2183, dtype=torch.float64) tensor(-9.2848, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1124, dtype=torch.float64) delta_t tensor(0.0267, dtype=torch.float64)
9 gae_duplicate tensor(-1.5269, dtype=torch.float64) tensor(-2.9320, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2103, dtype=torch.float64) delta_t tensor(0.2782, dtype=torch.float64)
8 gae_duplicate tensor(0.0282, dtype=torch.float64) tensor(-3.6447, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1433, dtype=torch.float64) delta_t tensor(-0.1524, dtype=torch.float64)
7 gae_duplicate tensor(-0.7860, dtype=torch.float64) tensor(1.5347, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6337, dtype=torch.float64) delta_t tensor(-0.4487, dtype=torch.float64)
6 gae_duplicate tensor(-1.4825, dtype=torch.float64) tensor(8.1172, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6439, dtype=torch.float64) delta_t tensor(-0.4216, dtype=torch.float64)
5 gae_duplicate tensor(-3.0821, dtype=torch.float64) tensor(12.4308, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2456, dtype=torch.float64) delta_t tensor(-2.0411, dtype=torch.float64)
4 gae_duplicate tensor(-7.6900, dtype=torch.float64) tensor(45.4766, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9994, dtype=torch.float64) delta_t tensor(-0.8657, dtype=torch.float64)
3 gae_duplicate tensor(-1.1950, dtype=torch.float64) tensor(21.0904, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7257, dtype=torch.float64) delta_t tensor(-0.4894, dtype=torch.float64)
2 gae_duplicate tensor(-1.1046, dtype=torch.float64) tensor(10.0203, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:371.4922180175781
value loss:174.15040588378906
entropies:323.42169189453125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3923.6506)
ToM Target loss= tensor(2982.5842)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.057100057601929 seconds
19 rew tensor(0.7594, dtype=torch.float64) delta_t tensor(0.4855, dtype=torch.float64)
19 gae_duplicate tensor(0.4355, dtype=torch.float64) tensor(-8.7700, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7437, dtype=torch.float64) delta_t tensor(0.4870, dtype=torch.float64)
18 gae_duplicate tensor(0.3543, dtype=torch.float64) tensor(-10.0952, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7117, dtype=torch.float64) delta_t tensor(0.4972, dtype=torch.float64)
17 gae_duplicate tensor(0.1639, dtype=torch.float64) tensor(-8.8441, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6634, dtype=torch.float64) delta_t tensor(0.4723, dtype=torch.float64)
16 gae_duplicate tensor(-0.1416, dtype=torch.float64) tensor(-11.6401, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5500, dtype=torch.float64) delta_t tensor(0.2967, dtype=torch.float64)
15 gae_duplicate tensor(-1.0256, dtype=torch.float64) tensor(-5.1263, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7620, dtype=torch.float64) delta_t tensor(0.5941, dtype=torch.float64)
14 gae_duplicate tensor(0.1610, dtype=torch.float64) tensor(-10.6179, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7118, dtype=torch.float64) delta_t tensor(0.5692, dtype=torch.float64)
13 gae_duplicate tensor(0.2324, dtype=torch.float64) tensor(-9.6377, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6142, dtype=torch.float64) delta_t tensor(0.5238, dtype=torch.float64)
12 gae_duplicate tensor(0.1339, dtype=torch.float64) tensor(-9.8622, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5428, dtype=torch.float64) delta_t tensor(0.5290, dtype=torch.float64)
11 gae_duplicate tensor(0.1241, dtype=torch.float64) tensor(-9.2627, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3542, dtype=torch.float64) delta_t tensor(0.3937, dtype=torch.float64)
10 gae_duplicate tensor(-0.3181, dtype=torch.float64) tensor(-7.6334, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2504, dtype=torch.float64) delta_t tensor(-0.2605, dtype=torch.float64)
9 gae_duplicate tensor(-3.6155, dtype=torch.float64) tensor(6.1984, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2380, dtype=torch.float64) delta_t tensor(-0.2463, dtype=torch.float64)
8 gae_duplicate tensor(-1.0529, dtype=torch.float64) tensor(3.9659, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8160, dtype=torch.float64) delta_t tensor(-0.5945, dtype=torch.float64)
7 gae_duplicate tensor(-2.7261, dtype=torch.float64) tensor(7.9092, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6078, dtype=torch.float64) delta_t tensor(-0.4315, dtype=torch.float64)
6 gae_duplicate tensor(-2.0849, dtype=torch.float64) tensor(9.5150, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7524, dtype=torch.float64) delta_t tensor(-0.4575, dtype=torch.float64)
5 gae_duplicate tensor(-2.2053, dtype=torch.float64) tensor(10.0031, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8689, dtype=torch.float64) delta_t tensor(-0.6405, dtype=torch.float64)
4 gae_duplicate tensor(-2.7471, dtype=torch.float64) tensor(9.8901, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7266, dtype=torch.float64) delta_t tensor(-0.5384, dtype=torch.float64)
3 gae_duplicate tensor(-1.0502, dtype=torch.float64) tensor(8.5669, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2935, dtype=torch.float64) delta_t tensor(-0.0899, dtype=torch.float64)
2 gae_duplicate tensor(-0.6445, dtype=torch.float64) tensor(2.4240, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1697.708251953125
value loss:116.54447937011719
entropies:315.5762939453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.226155996322632 seconds
19 rew tensor(0.7445, dtype=torch.float64) delta_t tensor(0.3868, dtype=torch.float64)
19 gae_duplicate tensor(0.2761, dtype=torch.float64) tensor(-7.8943, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7213, dtype=torch.float64) delta_t tensor(0.4145, dtype=torch.float64)
18 gae_duplicate tensor(0.1954, dtype=torch.float64) tensor(-7.6956, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6664, dtype=torch.float64) delta_t tensor(0.3683, dtype=torch.float64)
17 gae_duplicate tensor(-0.1656, dtype=torch.float64) tensor(-8.4640, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5718, dtype=torch.float64) delta_t tensor(0.2556, dtype=torch.float64)
16 gae_duplicate tensor(-0.8821, dtype=torch.float64) tensor(-3.4100, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7782, dtype=torch.float64) delta_t tensor(0.4458, dtype=torch.float64)
15 gae_duplicate tensor(0.2926, dtype=torch.float64) tensor(-7.9663, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7788, dtype=torch.float64) delta_t tensor(0.5034, dtype=torch.float64)
14 gae_duplicate tensor(0.4106, dtype=torch.float64) tensor(-9.7444, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7794, dtype=torch.float64) delta_t tensor(0.4512, dtype=torch.float64)
13 gae_duplicate tensor(0.4230, dtype=torch.float64) tensor(-8.5169, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7800, dtype=torch.float64) delta_t tensor(0.4830, dtype=torch.float64)
12 gae_duplicate tensor(0.4307, dtype=torch.float64) tensor(-10.2752, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7568, dtype=torch.float64) delta_t tensor(0.6290, dtype=torch.float64)
11 gae_duplicate tensor(0.4306, dtype=torch.float64) tensor(-11.5268, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6991, dtype=torch.float64) delta_t tensor(0.5997, dtype=torch.float64)
10 gae_duplicate tensor(0.2931, dtype=torch.float64) tensor(-12.4585, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3400, dtype=torch.float64) delta_t tensor(0.2279, dtype=torch.float64)
9 gae_duplicate tensor(-0.6713, dtype=torch.float64) tensor(-7.1079, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0750, dtype=torch.float64) delta_t tensor(-0.2442, dtype=torch.float64)
8 gae_duplicate tensor(-1.7846, dtype=torch.float64) tensor(1.3070, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1722, dtype=torch.float64) delta_t tensor(-0.2216, dtype=torch.float64)
7 gae_duplicate tensor(-1.2284, dtype=torch.float64) tensor(4.0247, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6271, dtype=torch.float64) delta_t tensor(-0.3011, dtype=torch.float64)
6 gae_duplicate tensor(-1.0538, dtype=torch.float64) tensor(6.1268, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5360, dtype=torch.float64) delta_t tensor(-0.4495, dtype=torch.float64)
5 gae_duplicate tensor(-1.2683, dtype=torch.float64) tensor(8.9348, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8878, dtype=torch.float64) delta_t tensor(-0.6683, dtype=torch.float64)
4 gae_duplicate tensor(-1.1918, dtype=torch.float64) tensor(11.4497, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5827, dtype=torch.float64) delta_t tensor(-0.4146, dtype=torch.float64)
3 gae_duplicate tensor(-0.9091, dtype=torch.float64) tensor(5.6933, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7798, dtype=torch.float64) delta_t tensor(-0.5534, dtype=torch.float64)
2 gae_duplicate tensor(-0.8667, dtype=torch.float64) tensor(10.4246, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2458.453125
value loss:60.931583404541016
entropies:314.416259765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.217952013015747 seconds
19 rew tensor(0.7252, dtype=torch.float64) delta_t tensor(0.4026, dtype=torch.float64)
19 gae_duplicate tensor(0.0301, dtype=torch.float64) tensor(-5.7913, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6713, dtype=torch.float64) delta_t tensor(0.4062, dtype=torch.float64)
18 gae_duplicate tensor(-0.1229, dtype=torch.float64) tensor(-8.4428, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5862, dtype=torch.float64) delta_t tensor(0.2610, dtype=torch.float64)
17 gae_duplicate tensor(-0.8140, dtype=torch.float64) tensor(-3.7991, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7649, dtype=torch.float64) delta_t tensor(0.4400, dtype=torch.float64)
16 gae_duplicate tensor(0.2514, dtype=torch.float64) tensor(-7.6208, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7573, dtype=torch.float64) delta_t tensor(0.5002, dtype=torch.float64)
15 gae_duplicate tensor(0.3585, dtype=torch.float64) tensor(-10.2261, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7179, dtype=torch.float64) delta_t tensor(0.4425, dtype=torch.float64)
14 gae_duplicate tensor(0.3726, dtype=torch.float64) tensor(-9.5406, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6453, dtype=torch.float64) delta_t tensor(0.4687, dtype=torch.float64)
13 gae_duplicate tensor(0.2417, dtype=torch.float64) tensor(-11.8197, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6718, dtype=torch.float64) delta_t tensor(0.5193, dtype=torch.float64)
12 gae_duplicate tensor(0.2658, dtype=torch.float64) tensor(-7.2598, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7040, dtype=torch.float64) delta_t tensor(0.5023, dtype=torch.float64)
11 gae_duplicate tensor(0.3539, dtype=torch.float64) tensor(-10.6389, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5410, dtype=torch.float64) delta_t tensor(0.2977, dtype=torch.float64)
10 gae_duplicate tensor(-0.2492, dtype=torch.float64) tensor(-6.3176, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1750, dtype=torch.float64) delta_t tensor(0.1162, dtype=torch.float64)
9 gae_duplicate tensor(-1.1941, dtype=torch.float64) tensor(-5.7052, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6304, dtype=torch.float64) delta_t tensor(-0.6315, dtype=torch.float64)
8 gae_duplicate tensor(-1.7236, dtype=torch.float64) tensor(10.5569, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8994, dtype=torch.float64) delta_t tensor(-1.0151, dtype=torch.float64)
7 gae_duplicate tensor(-3.0343, dtype=torch.float64) tensor(22.7815, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6351, dtype=torch.float64) delta_t tensor(-0.5872, dtype=torch.float64)
6 gae_duplicate tensor(-1.9339, dtype=torch.float64) tensor(10.3708, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1136, dtype=torch.float64) delta_t tensor(-1.0088, dtype=torch.float64)
5 gae_duplicate tensor(-2.1836, dtype=torch.float64) tensor(17.6495, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.7273, dtype=torch.float64) delta_t tensor(-3.4733, dtype=torch.float64)
4 gae_duplicate tensor(-7.6727, dtype=torch.float64) tensor(54.8786, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5255, dtype=torch.float64) delta_t tensor(-0.2915, dtype=torch.float64)
3 gae_duplicate tensor(-1.7715, dtype=torch.float64) tensor(12.7452, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3373, dtype=torch.float64) delta_t tensor(-0.0464, dtype=torch.float64)
2 gae_duplicate tensor(-1.3578, dtype=torch.float64) tensor(0.6227, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2375.7626953125
value loss:292.38958740234375
entropies:310.46923828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.88308310508728 seconds
19 rew tensor(0.7191, dtype=torch.float64) delta_t tensor(0.3194, dtype=torch.float64)
19 gae_duplicate tensor(0.0509, dtype=torch.float64) tensor(-4.1241, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6505, dtype=torch.float64) delta_t tensor(0.3450, dtype=torch.float64)
18 gae_duplicate tensor(-0.2134, dtype=torch.float64) tensor(-6.0492, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5351, dtype=torch.float64) delta_t tensor(0.2160, dtype=torch.float64)
17 gae_duplicate tensor(-0.8855, dtype=torch.float64) tensor(-6.5308, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7262, dtype=torch.float64) delta_t tensor(0.4025, dtype=torch.float64)
16 gae_duplicate tensor(0.2947, dtype=torch.float64) tensor(-8.5119, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7039, dtype=torch.float64) delta_t tensor(0.4211, dtype=torch.float64)
15 gae_duplicate tensor(0.0296, dtype=torch.float64) tensor(-6.2707, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6179, dtype=torch.float64) delta_t tensor(0.4555, dtype=torch.float64)
14 gae_duplicate tensor(-0.3371, dtype=torch.float64) tensor(-7.1637, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6787, dtype=torch.float64) delta_t tensor(0.4965, dtype=torch.float64)
13 gae_duplicate tensor(0.3288, dtype=torch.float64) tensor(-10.6800, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6816, dtype=torch.float64) delta_t tensor(0.4748, dtype=torch.float64)
12 gae_duplicate tensor(0.3038, dtype=torch.float64) tensor(-8.5365, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5717, dtype=torch.float64) delta_t tensor(0.5386, dtype=torch.float64)
11 gae_duplicate tensor(0.1641, dtype=torch.float64) tensor(-9.3976, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4664, dtype=torch.float64) delta_t tensor(0.1903, dtype=torch.float64)
10 gae_duplicate tensor(-0.1966, dtype=torch.float64) tensor(-3.5241, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3798, dtype=torch.float64) delta_t tensor(-1.5525, dtype=torch.float64)
9 gae_duplicate tensor(-4.0126, dtype=torch.float64) tensor(20.1306, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2196, dtype=torch.float64) delta_t tensor(-0.4832, dtype=torch.float64)
8 gae_duplicate tensor(-2.0440, dtype=torch.float64) tensor(10.2519, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4646, dtype=torch.float64) delta_t tensor(-0.5464, dtype=torch.float64)
7 gae_duplicate tensor(-2.1590, dtype=torch.float64) tensor(10.7291, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1268, dtype=torch.float64) delta_t tensor(-1.0257, dtype=torch.float64)
6 gae_duplicate tensor(-4.5572, dtype=torch.float64) tensor(20.4138, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6961, dtype=torch.float64) delta_t tensor(-0.6308, dtype=torch.float64)
5 gae_duplicate tensor(-1.7968, dtype=torch.float64) tensor(10.2400, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1716, dtype=torch.float64) delta_t tensor(-0.8714, dtype=torch.float64)
4 gae_duplicate tensor(-1.8132, dtype=torch.float64) tensor(23.3100, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3925, dtype=torch.float64) delta_t tensor(-0.0776, dtype=torch.float64)
3 gae_duplicate tensor(-1.1829, dtype=torch.float64) tensor(0.3015, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5471, dtype=torch.float64) delta_t tensor(-0.3418, dtype=torch.float64)
2 gae_duplicate tensor(-0.9342, dtype=torch.float64) tensor(6.7154, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1773.1044921875
value loss:160.78172302246094
entropies:306.34222412109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.553217887878418 seconds
19 rew tensor(0.6758, dtype=torch.float64) delta_t tensor(0.3155, dtype=torch.float64)
19 gae_duplicate tensor(-0.0756, dtype=torch.float64) tensor(-4.9605, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5789, dtype=torch.float64) delta_t tensor(0.2408, dtype=torch.float64)
18 gae_duplicate tensor(-0.7932, dtype=torch.float64) tensor(-5.1725, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7739, dtype=torch.float64) delta_t tensor(0.4149, dtype=torch.float64)
17 gae_duplicate tensor(0.3178, dtype=torch.float64) tensor(-6.4083, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7745, dtype=torch.float64) delta_t tensor(0.5111, dtype=torch.float64)
16 gae_duplicate tensor(0.3615, dtype=torch.float64) tensor(-11.5002, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7751, dtype=torch.float64) delta_t tensor(0.6156, dtype=torch.float64)
15 gae_duplicate tensor(0.4412, dtype=torch.float64) tensor(-11.8044, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7756, dtype=torch.float64) delta_t tensor(0.6448, dtype=torch.float64)
14 gae_duplicate tensor(0.4430, dtype=torch.float64) tensor(-14.6504, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7762, dtype=torch.float64) delta_t tensor(0.6080, dtype=torch.float64)
13 gae_duplicate tensor(0.5654, dtype=torch.float64) tensor(-11.9887, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6931, dtype=torch.float64) delta_t tensor(0.4820, dtype=torch.float64)
12 gae_duplicate tensor(0.1658, dtype=torch.float64) tensor(-10.7786, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7020, dtype=torch.float64) delta_t tensor(0.5330, dtype=torch.float64)
11 gae_duplicate tensor(0.1476, dtype=torch.float64) tensor(-10.8861, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6952, dtype=torch.float64) delta_t tensor(0.6169, dtype=torch.float64)
10 gae_duplicate tensor(0.2055, dtype=torch.float64) tensor(-9.0572, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2491, dtype=torch.float64) delta_t tensor(-0.3931, dtype=torch.float64)
9 gae_duplicate tensor(-2.4586, dtype=torch.float64) tensor(6.5073, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7690, dtype=torch.float64) delta_t tensor(-0.6589, dtype=torch.float64)
8 gae_duplicate tensor(-4.9826, dtype=torch.float64) tensor(9.9569, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5837, dtype=torch.float64) delta_t tensor(-0.5649, dtype=torch.float64)
7 gae_duplicate tensor(-2.4693, dtype=torch.float64) tensor(7.8204, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4026, dtype=torch.float64) delta_t tensor(-0.1774, dtype=torch.float64)
6 gae_duplicate tensor(-0.8410, dtype=torch.float64) tensor(5.8785, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0149, dtype=torch.float64) delta_t tensor(-0.7121, dtype=torch.float64)
5 gae_duplicate tensor(-1.6160, dtype=torch.float64) tensor(12.6871, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6247, dtype=torch.float64) delta_t tensor(-0.4810, dtype=torch.float64)
4 gae_duplicate tensor(-1.5960, dtype=torch.float64) tensor(9.6150, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7195, dtype=torch.float64) delta_t tensor(-0.5529, dtype=torch.float64)
3 gae_duplicate tensor(-1.4996, dtype=torch.float64) tensor(7.4608, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4072, dtype=torch.float64) delta_t tensor(-0.2178, dtype=torch.float64)
2 gae_duplicate tensor(-0.9499, dtype=torch.float64) tensor(5.6945, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1622.480712890625
value loss:124.96958923339844
entropies:308.11224365234375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3905.8203)
ToM Target loss= tensor(2966.4287)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.917634010314941 seconds
19 rew tensor(0.6176, dtype=torch.float64) delta_t tensor(0.2109, dtype=torch.float64)
19 gae_duplicate tensor(-0.2072, dtype=torch.float64) tensor(-3.8240, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4792, dtype=torch.float64) delta_t tensor(0.0886, dtype=torch.float64)
18 gae_duplicate tensor(-0.8953, dtype=torch.float64) tensor(-3.1214, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7729, dtype=torch.float64) delta_t tensor(0.3887, dtype=torch.float64)
17 gae_duplicate tensor(0.2720, dtype=torch.float64) tensor(-8.3087, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7734, dtype=torch.float64) delta_t tensor(0.4552, dtype=torch.float64)
16 gae_duplicate tensor(0.3862, dtype=torch.float64) tensor(-8.8358, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7581, dtype=torch.float64) delta_t tensor(0.4711, dtype=torch.float64)
15 gae_duplicate tensor(0.3982, dtype=torch.float64) tensor(-10.0605, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7586, dtype=torch.float64) delta_t tensor(0.4790, dtype=torch.float64)
14 gae_duplicate tensor(0.4000, dtype=torch.float64) tensor(-8.4635, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6954, dtype=torch.float64) delta_t tensor(0.3826, dtype=torch.float64)
13 gae_duplicate tensor(0.2320, dtype=torch.float64) tensor(-7.4076, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7115, dtype=torch.float64) delta_t tensor(0.4483, dtype=torch.float64)
12 gae_duplicate tensor(0.1575, dtype=torch.float64) tensor(-9.7824, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6724, dtype=torch.float64) delta_t tensor(0.3812, dtype=torch.float64)
11 gae_duplicate tensor(-0.0667, dtype=torch.float64) tensor(-7.7196, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6969, dtype=torch.float64) delta_t tensor(0.5540, dtype=torch.float64)
10 gae_duplicate tensor(0.3987, dtype=torch.float64) tensor(-9.1714, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1059, dtype=torch.float64) delta_t tensor(0.0758, dtype=torch.float64)
9 gae_duplicate tensor(-1.6854, dtype=torch.float64) tensor(-2.2751, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3759, dtype=torch.float64) delta_t tensor(-0.4770, dtype=torch.float64)
8 gae_duplicate tensor(-1.9704, dtype=torch.float64) tensor(5.9009, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4313, dtype=torch.float64) delta_t tensor(-0.4156, dtype=torch.float64)
7 gae_duplicate tensor(-0.9316, dtype=torch.float64) tensor(7.2664, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0401, dtype=torch.float64) delta_t tensor(-0.8801, dtype=torch.float64)
6 gae_duplicate tensor(-2.3958, dtype=torch.float64) tensor(16.0702, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1202, dtype=torch.float64) delta_t tensor(-0.9843, dtype=torch.float64)
5 gae_duplicate tensor(-2.2366, dtype=torch.float64) tensor(19.0967, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4302, dtype=torch.float64) delta_t tensor(-2.3436, dtype=torch.float64)
4 gae_duplicate tensor(-7.0817, dtype=torch.float64) tensor(47.6046, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4145, dtype=torch.float64) delta_t tensor(-0.1984, dtype=torch.float64)
3 gae_duplicate tensor(-1.1852, dtype=torch.float64) tensor(5.9790, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5257, dtype=torch.float64) delta_t tensor(-0.3394, dtype=torch.float64)
2 gae_duplicate tensor(-1.5531, dtype=torch.float64) tensor(6.3227, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1664.9295654296875
value loss:172.45993041992188
entropies:312.32733154296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.967884063720703 seconds
19 rew tensor(0.7723, dtype=torch.float64) delta_t tensor(0.3826, dtype=torch.float64)
19 gae_duplicate tensor(0.2980, dtype=torch.float64) tensor(-7.3985, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7652, dtype=torch.float64) delta_t tensor(0.4483, dtype=torch.float64)
18 gae_duplicate tensor(0.3577, dtype=torch.float64) tensor(-8.5729, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7580, dtype=torch.float64) delta_t tensor(0.4462, dtype=torch.float64)
17 gae_duplicate tensor(0.3188, dtype=torch.float64) tensor(-8.5119, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7431, dtype=torch.float64) delta_t tensor(0.4209, dtype=torch.float64)
16 gae_duplicate tensor(0.2100, dtype=torch.float64) tensor(-7.5019, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7205, dtype=torch.float64) delta_t tensor(0.3998, dtype=torch.float64)
15 gae_duplicate tensor(0.0915, dtype=torch.float64) tensor(-7.6333, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6593, dtype=torch.float64) delta_t tensor(0.4729, dtype=torch.float64)
14 gae_duplicate tensor(0.1362, dtype=torch.float64) tensor(-8.5126, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7047, dtype=torch.float64) delta_t tensor(0.4128, dtype=torch.float64)
13 gae_duplicate tensor(0.1114, dtype=torch.float64) tensor(-7.0612, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6367, dtype=torch.float64) delta_t tensor(0.3361, dtype=torch.float64)
12 gae_duplicate tensor(0.1516, dtype=torch.float64) tensor(-7.0369, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6121, dtype=torch.float64) delta_t tensor(0.4561, dtype=torch.float64)
11 gae_duplicate tensor(0.1436, dtype=torch.float64) tensor(-9.4365, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4435, dtype=torch.float64) delta_t tensor(0.3502, dtype=torch.float64)
10 gae_duplicate tensor(-0.0340, dtype=torch.float64) tensor(-7.6847, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0398, dtype=torch.float64) delta_t tensor(-0.1863, dtype=torch.float64)
9 gae_duplicate tensor(-1.4377, dtype=torch.float64) tensor(1.5462, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2100, dtype=torch.float64) delta_t tensor(-0.3224, dtype=torch.float64)
8 gae_duplicate tensor(-1.3412, dtype=torch.float64) tensor(6.6246, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5835, dtype=torch.float64) delta_t tensor(-0.6969, dtype=torch.float64)
7 gae_duplicate tensor(-1.9375, dtype=torch.float64) tensor(12.3572, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8164, dtype=torch.float64) delta_t tensor(-0.6659, dtype=torch.float64)
6 gae_duplicate tensor(-2.6740, dtype=torch.float64) tensor(8.5357, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8497, dtype=torch.float64) delta_t tensor(-0.6466, dtype=torch.float64)
5 gae_duplicate tensor(-3.1088, dtype=torch.float64) tensor(11.5683, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9243, dtype=torch.float64) delta_t tensor(-1.7195, dtype=torch.float64)
4 gae_duplicate tensor(-6.7329, dtype=torch.float64) tensor(32.0933, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6260, dtype=torch.float64) delta_t tensor(-0.3190, dtype=torch.float64)
3 gae_duplicate tensor(-1.2521, dtype=torch.float64) tensor(5.1695, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3611, dtype=torch.float64) delta_t tensor(-0.2030, dtype=torch.float64)
2 gae_duplicate tensor(-0.9172, dtype=torch.float64) tensor(5.9652, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-327.71319580078125
value loss:150.852294921875
entropies:311.785888671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9420740604400635 seconds
19 rew tensor(0.7730, dtype=torch.float64) delta_t tensor(0.3576, dtype=torch.float64)
19 gae_duplicate tensor(0.2117, dtype=torch.float64) tensor(-5.1974, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7735, dtype=torch.float64) delta_t tensor(0.4112, dtype=torch.float64)
18 gae_duplicate tensor(0.3121, dtype=torch.float64) tensor(-7.8526, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7740, dtype=torch.float64) delta_t tensor(0.4049, dtype=torch.float64)
17 gae_duplicate tensor(0.3514, dtype=torch.float64) tensor(-5.9750, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7746, dtype=torch.float64) delta_t tensor(0.3899, dtype=torch.float64)
16 gae_duplicate tensor(0.3478, dtype=torch.float64) tensor(-7.9516, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7751, dtype=torch.float64) delta_t tensor(0.4190, dtype=torch.float64)
15 gae_duplicate tensor(0.4053, dtype=torch.float64) tensor(-8.9147, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7756, dtype=torch.float64) delta_t tensor(0.4308, dtype=torch.float64)
14 gae_duplicate tensor(0.3292, dtype=torch.float64) tensor(-8.9496, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7762, dtype=torch.float64) delta_t tensor(0.5763, dtype=torch.float64)
13 gae_duplicate tensor(0.4147, dtype=torch.float64) tensor(-9.3050, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6689, dtype=torch.float64) delta_t tensor(0.4674, dtype=torch.float64)
12 gae_duplicate tensor(0.2350, dtype=torch.float64) tensor(-7.1084, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6460, dtype=torch.float64) delta_t tensor(0.3569, dtype=torch.float64)
11 gae_duplicate tensor(0.0156, dtype=torch.float64) tensor(-7.5448, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5307, dtype=torch.float64) delta_t tensor(0.2559, dtype=torch.float64)
10 gae_duplicate tensor(-0.0841, dtype=torch.float64) tensor(-6.2001, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3556, dtype=torch.float64) delta_t tensor(0.1312, dtype=torch.float64)
9 gae_duplicate tensor(-0.1050, dtype=torch.float64) tensor(-1.8270, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1072, dtype=torch.float64) delta_t tensor(0.0112, dtype=torch.float64)
8 gae_duplicate tensor(-0.4880, dtype=torch.float64) tensor(-0.2269, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3301, dtype=torch.float64) delta_t tensor(-0.2880, dtype=torch.float64)
7 gae_duplicate tensor(-1.5861, dtype=torch.float64) tensor(7.9098, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7382, dtype=torch.float64) delta_t tensor(-0.5407, dtype=torch.float64)
6 gae_duplicate tensor(-1.7434, dtype=torch.float64) tensor(9.3072, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2425, dtype=torch.float64) delta_t tensor(-1.0694, dtype=torch.float64)
5 gae_duplicate tensor(-2.7858, dtype=torch.float64) tensor(24.0017, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9982, dtype=torch.float64) delta_t tensor(-0.7265, dtype=torch.float64)
4 gae_duplicate tensor(-1.3117, dtype=torch.float64) tensor(15.6159, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4682, dtype=torch.float64) delta_t tensor(-0.2978, dtype=torch.float64)
3 gae_duplicate tensor(-1.7883, dtype=torch.float64) tensor(7.3904, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7820, dtype=torch.float64) delta_t tensor(-0.6318, dtype=torch.float64)
2 gae_duplicate tensor(-1.4973, dtype=torch.float64) tensor(10.2994, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:51.58549499511719
value loss:72.15516662597656
entropies:314.6460876464844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.905751943588257 seconds
19 rew tensor(0.7732, dtype=torch.float64) delta_t tensor(0.3569, dtype=torch.float64)
19 gae_duplicate tensor(0.2624, dtype=torch.float64) tensor(-5.4310, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7658, dtype=torch.float64) delta_t tensor(0.4624, dtype=torch.float64)
18 gae_duplicate tensor(0.3362, dtype=torch.float64) tensor(-7.7847, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7504, dtype=torch.float64) delta_t tensor(0.3887, dtype=torch.float64)
17 gae_duplicate tensor(0.3441, dtype=torch.float64) tensor(-6.6120, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7259, dtype=torch.float64) delta_t tensor(0.3608, dtype=torch.float64)
16 gae_duplicate tensor(0.2497, dtype=torch.float64) tensor(-6.5814, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6946, dtype=torch.float64) delta_t tensor(0.3128, dtype=torch.float64)
15 gae_duplicate tensor(0.0107, dtype=torch.float64) tensor(-6.4591, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6231, dtype=torch.float64) delta_t tensor(0.4058, dtype=torch.float64)
14 gae_duplicate tensor(-0.1921, dtype=torch.float64) tensor(-9.2342, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7248, dtype=torch.float64) delta_t tensor(0.4705, dtype=torch.float64)
13 gae_duplicate tensor(0.1629, dtype=torch.float64) tensor(-8.8702, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5379, dtype=torch.float64) delta_t tensor(0.2411, dtype=torch.float64)
12 gae_duplicate tensor(-0.0616, dtype=torch.float64) tensor(-5.5028, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6148, dtype=torch.float64) delta_t tensor(0.5647, dtype=torch.float64)
11 gae_duplicate tensor(0.1309, dtype=torch.float64) tensor(-11.6566, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3546, dtype=torch.float64) delta_t tensor(0.0852, dtype=torch.float64)
10 gae_duplicate tensor(-0.5732, dtype=torch.float64) tensor(-2.1952, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0811, dtype=torch.float64) delta_t tensor(-0.1591, dtype=torch.float64)
9 gae_duplicate tensor(-1.7527, dtype=torch.float64) tensor(1.8888, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0360, dtype=torch.float64) delta_t tensor(-0.2557, dtype=torch.float64)
8 gae_duplicate tensor(-1.0441, dtype=torch.float64) tensor(5.5303, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2707, dtype=torch.float64) delta_t tensor(-0.4822, dtype=torch.float64)
7 gae_duplicate tensor(-2.2532, dtype=torch.float64) tensor(11.7387, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0957, dtype=torch.float64) delta_t tensor(-1.2447, dtype=torch.float64)
6 gae_duplicate tensor(-2.6030, dtype=torch.float64) tensor(24.9342, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2868, dtype=torch.float64) delta_t tensor(-1.3480, dtype=torch.float64)
5 gae_duplicate tensor(-2.4873, dtype=torch.float64) tensor(25.9733, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3502, dtype=torch.float64) delta_t tensor(-2.2214, dtype=torch.float64)
4 gae_duplicate tensor(-5.8932, dtype=torch.float64) tensor(35.3059, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6258, dtype=torch.float64) delta_t tensor(-0.4112, dtype=torch.float64)
3 gae_duplicate tensor(-1.5505, dtype=torch.float64) tensor(9.4971, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5266, dtype=torch.float64) delta_t tensor(-0.3204, dtype=torch.float64)
2 gae_duplicate tensor(-0.9579, dtype=torch.float64) tensor(6.8545, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2862.61181640625
value loss:176.85023498535156
entropies:323.16064453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.042673826217651 seconds
19 rew tensor(0.7578, dtype=torch.float64) delta_t tensor(0.3782, dtype=torch.float64)
19 gae_duplicate tensor(0.2347, dtype=torch.float64) tensor(-6.9344, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7500, dtype=torch.float64) delta_t tensor(0.4137, dtype=torch.float64)
18 gae_duplicate tensor(0.3685, dtype=torch.float64) tensor(-8.6777, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7342, dtype=torch.float64) delta_t tensor(0.3684, dtype=torch.float64)
17 gae_duplicate tensor(0.3420, dtype=torch.float64) tensor(-6.8805, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7274, dtype=torch.float64) delta_t tensor(0.3434, dtype=torch.float64)
16 gae_duplicate tensor(0.1967, dtype=torch.float64) tensor(-6.2309, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6892, dtype=torch.float64) delta_t tensor(0.3324, dtype=torch.float64)
15 gae_duplicate tensor(-0.0958, dtype=torch.float64) tensor(-5.8595, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6180, dtype=torch.float64) delta_t tensor(0.2897, dtype=torch.float64)
14 gae_duplicate tensor(-0.2863, dtype=torch.float64) tensor(-5.7047, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7349, dtype=torch.float64) delta_t tensor(0.5430, dtype=torch.float64)
13 gae_duplicate tensor(0.2102, dtype=torch.float64) tensor(-9.5793, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6717, dtype=torch.float64) delta_t tensor(0.3355, dtype=torch.float64)
12 gae_duplicate tensor(-0.0910, dtype=torch.float64) tensor(-6.9582, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6561, dtype=torch.float64) delta_t tensor(0.4848, dtype=torch.float64)
11 gae_duplicate tensor(0.0147, dtype=torch.float64) tensor(-11.3087, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5577, dtype=torch.float64) delta_t tensor(0.3089, dtype=torch.float64)
10 gae_duplicate tensor(-0.2278, dtype=torch.float64) tensor(-5.5768, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5108, dtype=torch.float64) delta_t tensor(0.3132, dtype=torch.float64)
9 gae_duplicate tensor(0.0089, dtype=torch.float64) tensor(-5.0368, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1957, dtype=torch.float64) delta_t tensor(0.0607, dtype=torch.float64)
8 gae_duplicate tensor(-0.5432, dtype=torch.float64) tensor(-1.4867, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2059, dtype=torch.float64) delta_t tensor(-0.0682, dtype=torch.float64)
7 gae_duplicate tensor(-0.8365, dtype=torch.float64) tensor(3.3532, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6274, dtype=torch.float64) delta_t tensor(-0.3579, dtype=torch.float64)
6 gae_duplicate tensor(-1.1273, dtype=torch.float64) tensor(5.3398, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0839, dtype=torch.float64) delta_t tensor(-1.0401, dtype=torch.float64)
5 gae_duplicate tensor(-1.5049, dtype=torch.float64) tensor(18.9059, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1222, dtype=torch.float64) delta_t tensor(-1.0597, dtype=torch.float64)
4 gae_duplicate tensor(-1.6132, dtype=torch.float64) tensor(22.1630, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6846, dtype=torch.float64) delta_t tensor(-0.5235, dtype=torch.float64)
3 gae_duplicate tensor(-1.5012, dtype=torch.float64) tensor(10.7122, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6635, dtype=torch.float64) delta_t tensor(-0.4245, dtype=torch.float64)
2 gae_duplicate tensor(-1.1297, dtype=torch.float64) tensor(7.4062, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:580.6961669921875
value loss:66.83290100097656
entropies:320.01898193359375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3890.4409)
ToM Target loss= tensor(2943.9785)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.866696834564209 seconds
19 rew tensor(0.7426, dtype=torch.float64) delta_t tensor(0.3090, dtype=torch.float64)
19 gae_duplicate tensor(0.1917, dtype=torch.float64) tensor(-4.8333, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7430, dtype=torch.float64) delta_t tensor(0.3200, dtype=torch.float64)
18 gae_duplicate tensor(0.2691, dtype=torch.float64) tensor(-7.2776, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6885, dtype=torch.float64) delta_t tensor(0.2743, dtype=torch.float64)
17 gae_duplicate tensor(0.0537, dtype=torch.float64) tensor(-4.9020, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6103, dtype=torch.float64) delta_t tensor(0.2275, dtype=torch.float64)
16 gae_duplicate tensor(-0.2697, dtype=torch.float64) tensor(-4.8225, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4531, dtype=torch.float64) delta_t tensor(0.0387, dtype=torch.float64)
15 gae_duplicate tensor(-1.0293, dtype=torch.float64) tensor(-1.0159, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5962, dtype=torch.float64) delta_t tensor(0.1380, dtype=torch.float64)
14 gae_duplicate tensor(-0.7852, dtype=torch.float64) tensor(-1.3192, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6964, dtype=torch.float64) delta_t tensor(0.3266, dtype=torch.float64)
13 gae_duplicate tensor(0.1033, dtype=torch.float64) tensor(-6.1565, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7294, dtype=torch.float64) delta_t tensor(0.3257, dtype=torch.float64)
12 gae_duplicate tensor(0.1260, dtype=torch.float64) tensor(-7.0467, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6980, dtype=torch.float64) delta_t tensor(0.6068, dtype=torch.float64)
11 gae_duplicate tensor(0.2020, dtype=torch.float64) tensor(-11.6290, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6351, dtype=torch.float64) delta_t tensor(0.5529, dtype=torch.float64)
10 gae_duplicate tensor(-0.1606, dtype=torch.float64) tensor(-11.3364, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1203, dtype=torch.float64) delta_t tensor(-0.1608, dtype=torch.float64)
9 gae_duplicate tensor(-1.7493, dtype=torch.float64) tensor(1.7120, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3613, dtype=torch.float64) delta_t tensor(-0.4023, dtype=torch.float64)
8 gae_duplicate tensor(-1.7169, dtype=torch.float64) tensor(7.5376, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5519, dtype=torch.float64) delta_t tensor(-0.6512, dtype=torch.float64)
7 gae_duplicate tensor(-2.2352, dtype=torch.float64) tensor(12.7373, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.7486, dtype=torch.float64) delta_t tensor(-1.7404, dtype=torch.float64)
6 gae_duplicate tensor(-4.0811, dtype=torch.float64) tensor(37.3657, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2668, dtype=torch.float64) delta_t tensor(-0.9715, dtype=torch.float64)
5 gae_duplicate tensor(-2.1502, dtype=torch.float64) tensor(23.4743, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4618, dtype=torch.float64) delta_t tensor(-2.3971, dtype=torch.float64)
4 gae_duplicate tensor(-5.6483, dtype=torch.float64) tensor(43.3872, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4925, dtype=torch.float64) delta_t tensor(-0.3176, dtype=torch.float64)
3 gae_duplicate tensor(-1.2466, dtype=torch.float64) tensor(10.0632, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5274, dtype=torch.float64) delta_t tensor(-0.3563, dtype=torch.float64)
2 gae_duplicate tensor(-1.2107, dtype=torch.float64) tensor(6.8033, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4554.75390625
value loss:221.9497833251953
entropies:321.1350402832031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.064538240432739 seconds
19 rew tensor(0.7596, dtype=torch.float64) delta_t tensor(0.3793, dtype=torch.float64)
19 gae_duplicate tensor(0.2182, dtype=torch.float64) tensor(-7.2423, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7679, dtype=torch.float64) delta_t tensor(0.4167, dtype=torch.float64)
18 gae_duplicate tensor(0.3089, dtype=torch.float64) tensor(-8.0210, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7528, dtype=torch.float64) delta_t tensor(0.3081, dtype=torch.float64)
17 gae_duplicate tensor(0.2508, dtype=torch.float64) tensor(-7.3346, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7301, dtype=torch.float64) delta_t tensor(0.3226, dtype=torch.float64)
16 gae_duplicate tensor(0.1299, dtype=torch.float64) tensor(-7.1739, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6995, dtype=torch.float64) delta_t tensor(0.2561, dtype=torch.float64)
15 gae_duplicate tensor(-0.1364, dtype=torch.float64) tensor(-4.9176, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6147, dtype=torch.float64) delta_t tensor(0.3955, dtype=torch.float64)
14 gae_duplicate tensor(-0.5677, dtype=torch.float64) tensor(-8.8579, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7541, dtype=torch.float64) delta_t tensor(0.3519, dtype=torch.float64)
13 gae_duplicate tensor(0.2329, dtype=torch.float64) tensor(-7.2539, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7466, dtype=torch.float64) delta_t tensor(0.4011, dtype=torch.float64)
12 gae_duplicate tensor(0.1668, dtype=torch.float64) tensor(-7.4509, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7154, dtype=torch.float64) delta_t tensor(0.5743, dtype=torch.float64)
11 gae_duplicate tensor(0.4521, dtype=torch.float64) tensor(-11.4562, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4070, dtype=torch.float64) delta_t tensor(0.1144, dtype=torch.float64)
10 gae_duplicate tensor(-0.9676, dtype=torch.float64) tensor(-3.4702, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2176, dtype=torch.float64) delta_t tensor(-0.3959, dtype=torch.float64)
9 gae_duplicate tensor(-2.5951, dtype=torch.float64) tensor(7.2425, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6008, dtype=torch.float64) delta_t tensor(-0.7596, dtype=torch.float64)
8 gae_duplicate tensor(-2.0961, dtype=torch.float64) tensor(13.9940, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7661, dtype=torch.float64) delta_t tensor(-0.8791, dtype=torch.float64)
7 gae_duplicate tensor(-2.5368, dtype=torch.float64) tensor(20.1065, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0722, dtype=torch.float64) delta_t tensor(-1.0361, dtype=torch.float64)
6 gae_duplicate tensor(-3.1466, dtype=torch.float64) tensor(19.6783, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3012, dtype=torch.float64) delta_t tensor(-1.1572, dtype=torch.float64)
5 gae_duplicate tensor(-2.7568, dtype=torch.float64) tensor(18.4458, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0954, dtype=torch.float64) delta_t tensor(-0.8782, dtype=torch.float64)
4 gae_duplicate tensor(-1.5372, dtype=torch.float64) tensor(20.8628, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3561, dtype=torch.float64) delta_t tensor(-0.1414, dtype=torch.float64)
3 gae_duplicate tensor(-1.3923, dtype=torch.float64) tensor(3.7806, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5449, dtype=torch.float64) delta_t tensor(-0.2909, dtype=torch.float64)
2 gae_duplicate tensor(-1.0380, dtype=torch.float64) tensor(3.9742, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1970.995361328125
value loss:130.66282653808594
entropies:318.70660400390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.633715867996216 seconds
19 rew tensor(0.7363, dtype=torch.float64) delta_t tensor(0.2200, dtype=torch.float64)
19 gae_duplicate tensor(0.1585, dtype=torch.float64) tensor(-4.2428, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6896, dtype=torch.float64) delta_t tensor(0.2768, dtype=torch.float64)
18 gae_duplicate tensor(0.1309, dtype=torch.float64) tensor(-5.0612, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6035, dtype=torch.float64) delta_t tensor(0.2092, dtype=torch.float64)
17 gae_duplicate tensor(-0.1538, dtype=torch.float64) tensor(-4.3919, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4780, dtype=torch.float64) delta_t tensor(0.0469, dtype=torch.float64)
16 gae_duplicate tensor(-0.8720, dtype=torch.float64) tensor(-0.6171, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5441, dtype=torch.float64) delta_t tensor(0.2153, dtype=torch.float64)
15 gae_duplicate tensor(-0.3206, dtype=torch.float64) tensor(-4.4311, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5270, dtype=torch.float64) delta_t tensor(0.2478, dtype=torch.float64)
14 gae_duplicate tensor(-0.0675, dtype=torch.float64) tensor(-5.4367, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6809, dtype=torch.float64) delta_t tensor(0.3273, dtype=torch.float64)
13 gae_duplicate tensor(0.1385, dtype=torch.float64) tensor(-4.9343, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6641, dtype=torch.float64) delta_t tensor(0.3257, dtype=torch.float64)
12 gae_duplicate tensor(0.0982, dtype=torch.float64) tensor(-6.3025, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7075, dtype=torch.float64) delta_t tensor(0.4248, dtype=torch.float64)
11 gae_duplicate tensor(0.2216, dtype=torch.float64) tensor(-9.1183, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6270, dtype=torch.float64) delta_t tensor(0.3448, dtype=torch.float64)
10 gae_duplicate tensor(0.2193, dtype=torch.float64) tensor(-6.8011, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2333, dtype=torch.float64) delta_t tensor(-0.4436, dtype=torch.float64)
9 gae_duplicate tensor(-1.5329, dtype=torch.float64) tensor(6.8860, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7738, dtype=torch.float64) delta_t tensor(-0.7957, dtype=torch.float64)
8 gae_duplicate tensor(-3.1829, dtype=torch.float64) tensor(13.8286, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7561, dtype=torch.float64) delta_t tensor(-0.7344, dtype=torch.float64)
7 gae_duplicate tensor(-1.9674, dtype=torch.float64) tensor(12.4360, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.6288, dtype=torch.float64) delta_t tensor(-1.4402, dtype=torch.float64)
6 gae_duplicate tensor(-3.3013, dtype=torch.float64) tensor(27.4098, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3714, dtype=torch.float64) delta_t tensor(-1.1528, dtype=torch.float64)
5 gae_duplicate tensor(-2.9733, dtype=torch.float64) tensor(17.4315, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7440, dtype=torch.float64) delta_t tensor(-1.6219, dtype=torch.float64)
4 gae_duplicate tensor(-4.5292, dtype=torch.float64) tensor(22.0532, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8402, dtype=torch.float64) delta_t tensor(-0.7030, dtype=torch.float64)
3 gae_duplicate tensor(-1.7600, dtype=torch.float64) tensor(17.3758, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5748, dtype=torch.float64) delta_t tensor(-0.3999, dtype=torch.float64)
2 gae_duplicate tensor(-1.2923, dtype=torch.float64) tensor(9.8965, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4188.2119140625
value loss:191.39842224121094
entropies:315.7938232421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7878618240356445 seconds
19 rew tensor(0.7771, dtype=torch.float64) delta_t tensor(0.3207, dtype=torch.float64)
19 gae_duplicate tensor(0.1742, dtype=torch.float64) tensor(-4.2722, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7697, dtype=torch.float64) delta_t tensor(0.3721, dtype=torch.float64)
18 gae_duplicate tensor(0.2824, dtype=torch.float64) tensor(-7.2749, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7621, dtype=torch.float64) delta_t tensor(0.5067, dtype=torch.float64)
17 gae_duplicate tensor(0.4070, dtype=torch.float64) tensor(-7.1247, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7307, dtype=torch.float64) delta_t tensor(0.4169, dtype=torch.float64)
16 gae_duplicate tensor(0.3354, dtype=torch.float64) tensor(-9.5033, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7232, dtype=torch.float64) delta_t tensor(0.4885, dtype=torch.float64)
15 gae_duplicate tensor(0.4214, dtype=torch.float64) tensor(-9.4210, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6678, dtype=torch.float64) delta_t tensor(0.4625, dtype=torch.float64)
14 gae_duplicate tensor(0.1673, dtype=torch.float64) tensor(-8.7206, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6596, dtype=torch.float64) delta_t tensor(0.5228, dtype=torch.float64)
13 gae_duplicate tensor(0.3947, dtype=torch.float64) tensor(-10.6168, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5559, dtype=torch.float64) delta_t tensor(0.3259, dtype=torch.float64)
12 gae_duplicate tensor(0.0199, dtype=torch.float64) tensor(-5.9541, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4849, dtype=torch.float64) delta_t tensor(0.2761, dtype=torch.float64)
11 gae_duplicate tensor(-0.2735, dtype=torch.float64) tensor(-7.4150, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3575, dtype=torch.float64) delta_t tensor(0.1283, dtype=torch.float64)
10 gae_duplicate tensor(-0.5931, dtype=torch.float64) tensor(-2.4294, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2107, dtype=torch.float64) delta_t tensor(-0.0566, dtype=torch.float64)
9 gae_duplicate tensor(-0.6616, dtype=torch.float64) tensor(1.3559, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0863, dtype=torch.float64) delta_t tensor(-0.1087, dtype=torch.float64)
8 gae_duplicate tensor(-1.8413, dtype=torch.float64) tensor(0.9727, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4481, dtype=torch.float64) delta_t tensor(-0.4172, dtype=torch.float64)
7 gae_duplicate tensor(-2.2698, dtype=torch.float64) tensor(7.3809, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2546, dtype=torch.float64) delta_t tensor(-0.0444, dtype=torch.float64)
6 gae_duplicate tensor(-0.4857, dtype=torch.float64) tensor(1.6295, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1246, dtype=torch.float64) delta_t tensor(-0.9767, dtype=torch.float64)
5 gae_duplicate tensor(-2.3922, dtype=torch.float64) tensor(16.9570, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9976, dtype=torch.float64) delta_t tensor(-0.7713, dtype=torch.float64)
4 gae_duplicate tensor(-2.0084, dtype=torch.float64) tensor(14.4342, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9631, dtype=torch.float64) delta_t tensor(-0.7070, dtype=torch.float64)
3 gae_duplicate tensor(-1.4465, dtype=torch.float64) tensor(11.2553, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6746, dtype=torch.float64) delta_t tensor(-0.3694, dtype=torch.float64)
2 gae_duplicate tensor(-1.3957, dtype=torch.float64) tensor(6.5607, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:573.63818359375
value loss:82.04732513427734
entropies:312.5957336425781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.524496793746948 seconds
19 rew tensor(0.7776, dtype=torch.float64) delta_t tensor(0.3464, dtype=torch.float64)
19 gae_duplicate tensor(0.2663, dtype=torch.float64) tensor(-6.5475, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7780, dtype=torch.float64) delta_t tensor(0.4343, dtype=torch.float64)
18 gae_duplicate tensor(0.3807, dtype=torch.float64) tensor(-9.6292, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7785, dtype=torch.float64) delta_t tensor(0.4165, dtype=torch.float64)
17 gae_duplicate tensor(0.4052, dtype=torch.float64) tensor(-7.6583, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7790, dtype=torch.float64) delta_t tensor(0.3687, dtype=torch.float64)
16 gae_duplicate tensor(0.3520, dtype=torch.float64) tensor(-7.5889, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7795, dtype=torch.float64) delta_t tensor(0.3534, dtype=torch.float64)
15 gae_duplicate tensor(0.3614, dtype=torch.float64) tensor(-6.4933, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7800, dtype=torch.float64) delta_t tensor(0.3553, dtype=torch.float64)
14 gae_duplicate tensor(0.3620, dtype=torch.float64) tensor(-5.2882, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7805, dtype=torch.float64) delta_t tensor(0.5309, dtype=torch.float64)
13 gae_duplicate tensor(0.3897, dtype=torch.float64) tensor(-10.3386, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7489, dtype=torch.float64) delta_t tensor(0.6656, dtype=torch.float64)
12 gae_duplicate tensor(0.4107, dtype=torch.float64) tensor(-14.4313, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6392, dtype=torch.float64) delta_t tensor(0.3812, dtype=torch.float64)
11 gae_duplicate tensor(0.0062, dtype=torch.float64) tensor(-7.0103, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6318, dtype=torch.float64) delta_t tensor(0.4753, dtype=torch.float64)
10 gae_duplicate tensor(0.0061, dtype=torch.float64) tensor(-10.1504, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3844, dtype=torch.float64) delta_t tensor(0.5578, dtype=torch.float64)
9 gae_duplicate tensor(0.0246, dtype=torch.float64) tensor(-8.9297, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1224, dtype=torch.float64) delta_t tensor(0.2692, dtype=torch.float64)
8 gae_duplicate tensor(-0.0637, dtype=torch.float64) tensor(-6.9209, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1876, dtype=torch.float64) delta_t tensor(-0.0492, dtype=torch.float64)
7 gae_duplicate tensor(-1.0932, dtype=torch.float64) tensor(2.0930, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6454, dtype=torch.float64) delta_t tensor(-0.6296, dtype=torch.float64)
6 gae_duplicate tensor(-1.2597, dtype=torch.float64) tensor(14.8228, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8301, dtype=torch.float64) delta_t tensor(-0.7361, dtype=torch.float64)
5 gae_duplicate tensor(-1.3702, dtype=torch.float64) tensor(10.8737, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0272, dtype=torch.float64) delta_t tensor(-0.8501, dtype=torch.float64)
4 gae_duplicate tensor(-1.3597, dtype=torch.float64) tensor(15.8823, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9257, dtype=torch.float64) delta_t tensor(-0.7297, dtype=torch.float64)
3 gae_duplicate tensor(-1.2364, dtype=torch.float64) tensor(11.4208, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8119, dtype=torch.float64) delta_t tensor(-0.5910, dtype=torch.float64)
2 gae_duplicate tensor(-1.0349, dtype=torch.float64) tensor(15.0053, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1583.5584716796875
value loss:71.25125122070312
entropies:312.72454833984375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3859.4463)
ToM Target loss= tensor(2949.1968)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.841266870498657 seconds
19 rew tensor(0.7764, dtype=torch.float64) delta_t tensor(0.2857, dtype=torch.float64)
19 gae_duplicate tensor(0.1613, dtype=torch.float64) tensor(-4.7859, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7769, dtype=torch.float64) delta_t tensor(0.3062, dtype=torch.float64)
18 gae_duplicate tensor(0.2352, dtype=torch.float64) tensor(-5.6537, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7698, dtype=torch.float64) delta_t tensor(0.4509, dtype=torch.float64)
17 gae_duplicate tensor(0.3442, dtype=torch.float64) tensor(-9.0213, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7627, dtype=torch.float64) delta_t tensor(0.4196, dtype=torch.float64)
16 gae_duplicate tensor(0.3487, dtype=torch.float64) tensor(-8.8299, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7632, dtype=torch.float64) delta_t tensor(0.4079, dtype=torch.float64)
15 gae_duplicate tensor(0.3056, dtype=torch.float64) tensor(-6.7052, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7400, dtype=torch.float64) delta_t tensor(0.4779, dtype=torch.float64)
14 gae_duplicate tensor(0.1071, dtype=torch.float64) tensor(-10.5442, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7112, dtype=torch.float64) delta_t tensor(0.5419, dtype=torch.float64)
13 gae_duplicate tensor(0.1811, dtype=torch.float64) tensor(-9.7283, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6546, dtype=torch.float64) delta_t tensor(0.5198, dtype=torch.float64)
12 gae_duplicate tensor(0.3325, dtype=torch.float64) tensor(-9.4063, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5538, dtype=torch.float64) delta_t tensor(0.5243, dtype=torch.float64)
11 gae_duplicate tensor(0.2230, dtype=torch.float64) tensor(-8.6273, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1697, dtype=torch.float64) delta_t tensor(0.0615, dtype=torch.float64)
10 gae_duplicate tensor(-1.3324, dtype=torch.float64) tensor(-2.4833, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0075, dtype=torch.float64) delta_t tensor(-0.1060, dtype=torch.float64)
9 gae_duplicate tensor(-1.4304, dtype=torch.float64) tensor(2.6853, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1341, dtype=torch.float64) delta_t tensor(0.1096, dtype=torch.float64)
8 gae_duplicate tensor(-0.6292, dtype=torch.float64) tensor(-2.2477, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7054, dtype=torch.float64) delta_t tensor(-0.7969, dtype=torch.float64)
7 gae_duplicate tensor(-1.8343, dtype=torch.float64) tensor(13.3464, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.9163, dtype=torch.float64) delta_t tensor(-1.6868, dtype=torch.float64)
6 gae_duplicate tensor(-5.1375, dtype=torch.float64) tensor(26.2532, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6883, dtype=torch.float64) delta_t tensor(-1.5253, dtype=torch.float64)
5 gae_duplicate tensor(-4.3524, dtype=torch.float64) tensor(28.5927, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2283, dtype=torch.float64) delta_t tensor(-2.0133, dtype=torch.float64)
4 gae_duplicate tensor(-6.2953, dtype=torch.float64) tensor(40.7642, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9185, dtype=torch.float64) delta_t tensor(-0.7843, dtype=torch.float64)
3 gae_duplicate tensor(-1.6472, dtype=torch.float64) tensor(18.6538, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7763, dtype=torch.float64) delta_t tensor(-0.6053, dtype=torch.float64)
2 gae_duplicate tensor(-1.4456, dtype=torch.float64) tensor(11.4194, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3523.28564453125
value loss:255.00128173828125
entropies:312.85675048828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.704147100448608 seconds
19 rew tensor(0.7505, dtype=torch.float64) delta_t tensor(0.2925, dtype=torch.float64)
19 gae_duplicate tensor(0.1518, dtype=torch.float64) tensor(-5.2176, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7281, dtype=torch.float64) delta_t tensor(0.3353, dtype=torch.float64)
18 gae_duplicate tensor(0.1373, dtype=torch.float64) tensor(-6.8638, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6830, dtype=torch.float64) delta_t tensor(0.2706, dtype=torch.float64)
17 gae_duplicate tensor(-0.1415, dtype=torch.float64) tensor(-5.6191, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5916, dtype=torch.float64) delta_t tensor(0.3099, dtype=torch.float64)
16 gae_duplicate tensor(-0.4354, dtype=torch.float64) tensor(-4.7496, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6964, dtype=torch.float64) delta_t tensor(0.2991, dtype=torch.float64)
15 gae_duplicate tensor(-0.0859, dtype=torch.float64) tensor(-8.7149, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6658, dtype=torch.float64) delta_t tensor(0.3201, dtype=torch.float64)
14 gae_duplicate tensor(-0.2023, dtype=torch.float64) tensor(-6.4764, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7180, dtype=torch.float64) delta_t tensor(0.3834, dtype=torch.float64)
13 gae_duplicate tensor(0.2012, dtype=torch.float64) tensor(-10.3047, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7417, dtype=torch.float64) delta_t tensor(0.5802, dtype=torch.float64)
12 gae_duplicate tensor(0.2420, dtype=torch.float64) tensor(-12.2119, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7421, dtype=torch.float64) delta_t tensor(0.4744, dtype=torch.float64)
11 gae_duplicate tensor(0.2068, dtype=torch.float64) tensor(-9.7370, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5050, dtype=torch.float64) delta_t tensor(0.2337, dtype=torch.float64)
10 gae_duplicate tensor(-0.1742, dtype=torch.float64) tensor(-5.0476, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4696, dtype=torch.float64) delta_t tensor(-0.6503, dtype=torch.float64)
9 gae_duplicate tensor(-3.3581, dtype=torch.float64) tensor(8.1291, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4552, dtype=torch.float64) delta_t tensor(-0.4282, dtype=torch.float64)
8 gae_duplicate tensor(-2.1087, dtype=torch.float64) tensor(2.5431, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3353, dtype=torch.float64) delta_t tensor(-0.4364, dtype=torch.float64)
7 gae_duplicate tensor(-1.2415, dtype=torch.float64) tensor(8.2827, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6269, dtype=torch.float64) delta_t tensor(-0.6257, dtype=torch.float64)
6 gae_duplicate tensor(-1.1486, dtype=torch.float64) tensor(9.8621, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4224, dtype=torch.float64) delta_t tensor(-1.5094, dtype=torch.float64)
5 gae_duplicate tensor(-3.1560, dtype=torch.float64) tensor(25.6889, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4152, dtype=torch.float64) delta_t tensor(-2.1400, dtype=torch.float64)
4 gae_duplicate tensor(-10.0060, dtype=torch.float64) tensor(31.3279, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6101, dtype=torch.float64) delta_t tensor(-0.4595, dtype=torch.float64)
3 gae_duplicate tensor(-1.6856, dtype=torch.float64) tensor(11.0956, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2195, dtype=torch.float64) delta_t tensor(-0.0349, dtype=torch.float64)
2 gae_duplicate tensor(-0.4684, dtype=torch.float64) tensor(2.1504, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1386.2186279296875
value loss:263.29052734375
entropies:306.7351379394531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.624469041824341 seconds
19 rew tensor(0.7553, dtype=torch.float64) delta_t tensor(0.4365, dtype=torch.float64)
19 gae_duplicate tensor(0.3173, dtype=torch.float64) tensor(-8.0611, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7472, dtype=torch.float64) delta_t tensor(0.4401, dtype=torch.float64)
18 gae_duplicate tensor(0.2687, dtype=torch.float64) tensor(-10.5284, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7476, dtype=torch.float64) delta_t tensor(0.3974, dtype=torch.float64)
17 gae_duplicate tensor(0.2605, dtype=torch.float64) tensor(-8.4806, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7223, dtype=torch.float64) delta_t tensor(0.3669, dtype=torch.float64)
16 gae_duplicate tensor(0.1571, dtype=torch.float64) tensor(-7.4320, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6541, dtype=torch.float64) delta_t tensor(0.3045, dtype=torch.float64)
15 gae_duplicate tensor(-0.3028, dtype=torch.float64) tensor(-4.6979, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5517, dtype=torch.float64) delta_t tensor(0.2097, dtype=torch.float64)
14 gae_duplicate tensor(-1.1289, dtype=torch.float64) tensor(-5.7259, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7748, dtype=torch.float64) delta_t tensor(0.4230, dtype=torch.float64)
13 gae_duplicate tensor(0.1414, dtype=torch.float64) tensor(-6.5166, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6899, dtype=torch.float64) delta_t tensor(0.5319, dtype=torch.float64)
12 gae_duplicate tensor(0.2977, dtype=torch.float64) tensor(-10.6335, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6254, dtype=torch.float64) delta_t tensor(0.3803, dtype=torch.float64)
11 gae_duplicate tensor(0.2110, dtype=torch.float64) tensor(-7.2916, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3641, dtype=torch.float64) delta_t tensor(0.2542, dtype=torch.float64)
10 gae_duplicate tensor(-0.4379, dtype=torch.float64) tensor(-4.7071, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2324, dtype=torch.float64) delta_t tensor(-0.3675, dtype=torch.float64)
9 gae_duplicate tensor(-1.7233, dtype=torch.float64) tensor(4.0244, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1711, dtype=torch.float64) delta_t tensor(-0.4771, dtype=torch.float64)
8 gae_duplicate tensor(-1.0953, dtype=torch.float64) tensor(9.7371, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9241, dtype=torch.float64) delta_t tensor(-0.9796, dtype=torch.float64)
7 gae_duplicate tensor(-2.0181, dtype=torch.float64) tensor(17.1577, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6901, dtype=torch.float64) delta_t tensor(-0.5263, dtype=torch.float64)
6 gae_duplicate tensor(-1.8469, dtype=torch.float64) tensor(10.7247, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0835, dtype=torch.float64) delta_t tensor(-0.8015, dtype=torch.float64)
5 gae_duplicate tensor(-1.7962, dtype=torch.float64) tensor(10.8247, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7879, dtype=torch.float64) delta_t tensor(-2.6345, dtype=torch.float64)
4 gae_duplicate tensor(-6.7267, dtype=torch.float64) tensor(44.3988, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2444, dtype=torch.float64) delta_t tensor(-0.0233, dtype=torch.float64)
3 gae_duplicate tensor(-1.4707, dtype=torch.float64) tensor(3.9670, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2366, dtype=torch.float64) delta_t tensor(-0.0298, dtype=torch.float64)
2 gae_duplicate tensor(-0.5791, dtype=torch.float64) tensor(1.2049, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1592.69189453125
value loss:193.4310302734375
entropies:305.9362487792969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.07217001914978 seconds
19 rew tensor(0.7642, dtype=torch.float64) delta_t tensor(0.3777, dtype=torch.float64)
19 gae_duplicate tensor(0.2913, dtype=torch.float64) tensor(-6.7444, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7647, dtype=torch.float64) delta_t tensor(0.4116, dtype=torch.float64)
18 gae_duplicate tensor(0.3648, dtype=torch.float64) tensor(-6.8817, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7480, dtype=torch.float64) delta_t tensor(0.3623, dtype=torch.float64)
17 gae_duplicate tensor(0.2560, dtype=torch.float64) tensor(-6.7207, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7143, dtype=torch.float64) delta_t tensor(0.3108, dtype=torch.float64)
16 gae_duplicate tensor(0.0542, dtype=torch.float64) tensor(-5.2264, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6636, dtype=torch.float64) delta_t tensor(0.3287, dtype=torch.float64)
15 gae_duplicate tensor(-0.2419, dtype=torch.float64) tensor(-5.5091, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5702, dtype=torch.float64) delta_t tensor(0.3238, dtype=torch.float64)
14 gae_duplicate tensor(-0.9847, dtype=torch.float64) tensor(-5.7479, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7751, dtype=torch.float64) delta_t tensor(0.5093, dtype=torch.float64)
13 gae_duplicate tensor(0.1827, dtype=torch.float64) tensor(-9.5044, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7755, dtype=torch.float64) delta_t tensor(0.5015, dtype=torch.float64)
12 gae_duplicate tensor(0.2672, dtype=torch.float64) tensor(-9.3200, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7514, dtype=torch.float64) delta_t tensor(0.4350, dtype=torch.float64)
11 gae_duplicate tensor(0.2657, dtype=torch.float64) tensor(-7.7574, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7443, dtype=torch.float64) delta_t tensor(0.6877, dtype=torch.float64)
10 gae_duplicate tensor(0.3133, dtype=torch.float64) tensor(-10.7885, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1387, dtype=torch.float64) delta_t tensor(-0.2433, dtype=torch.float64)
9 gae_duplicate tensor(-3.7626, dtype=torch.float64) tensor(2.3355, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2259, dtype=torch.float64) delta_t tensor(-0.4394, dtype=torch.float64)
8 gae_duplicate tensor(-2.3629, dtype=torch.float64) tensor(12.5973, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8530, dtype=torch.float64) delta_t tensor(-1.0483, dtype=torch.float64)
7 gae_duplicate tensor(-3.3258, dtype=torch.float64) tensor(20.1612, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6556, dtype=torch.float64) delta_t tensor(-0.4718, dtype=torch.float64)
6 gae_duplicate tensor(-1.4924, dtype=torch.float64) tensor(9.4450, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1655, dtype=torch.float64) delta_t tensor(-0.8057, dtype=torch.float64)
5 gae_duplicate tensor(-2.1206, dtype=torch.float64) tensor(19.3895, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0529, dtype=torch.float64) delta_t tensor(-0.9236, dtype=torch.float64)
4 gae_duplicate tensor(-1.6776, dtype=torch.float64) tensor(19.4393, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4777, dtype=torch.float64) delta_t tensor(-0.2550, dtype=torch.float64)
3 gae_duplicate tensor(-1.0576, dtype=torch.float64) tensor(3.9000, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4014, dtype=torch.float64) delta_t tensor(-0.1879, dtype=torch.float64)
2 gae_duplicate tensor(-0.5183, dtype=torch.float64) tensor(3.2716, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-964.0947875976562
value loss:112.67557525634766
entropies:302.94287109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.913313865661621 seconds
19 rew tensor(0.7234, dtype=torch.float64) delta_t tensor(0.2706, dtype=torch.float64)
19 gae_duplicate tensor(-0.0569, dtype=torch.float64) tensor(-4.5891, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6667, dtype=torch.float64) delta_t tensor(0.3073, dtype=torch.float64)
18 gae_duplicate tensor(-0.2466, dtype=torch.float64) tensor(-6.2285, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5697, dtype=torch.float64) delta_t tensor(0.2679, dtype=torch.float64)
17 gae_duplicate tensor(-0.3952, dtype=torch.float64) tensor(-3.6151, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7575, dtype=torch.float64) delta_t tensor(0.3796, dtype=torch.float64)
16 gae_duplicate tensor(0.3292, dtype=torch.float64) tensor(-6.9276, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7426, dtype=torch.float64) delta_t tensor(0.4233, dtype=torch.float64)
15 gae_duplicate tensor(0.2402, dtype=torch.float64) tensor(-8.0318, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7200, dtype=torch.float64) delta_t tensor(0.4449, dtype=torch.float64)
14 gae_duplicate tensor(0.0185, dtype=torch.float64) tensor(-7.2891, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6656, dtype=torch.float64) delta_t tensor(0.4008, dtype=torch.float64)
13 gae_duplicate tensor(-0.1635, dtype=torch.float64) tensor(-8.3984, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7749, dtype=torch.float64) delta_t tensor(0.4940, dtype=torch.float64)
12 gae_duplicate tensor(0.3091, dtype=torch.float64) tensor(-8.1050, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7173, dtype=torch.float64) delta_t tensor(0.6898, dtype=torch.float64)
11 gae_duplicate tensor(0.3996, dtype=torch.float64) tensor(-11.2297, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6179, dtype=torch.float64) delta_t tensor(0.4008, dtype=torch.float64)
10 gae_duplicate tensor(-0.1266, dtype=torch.float64) tensor(-10.6254, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0998, dtype=torch.float64) delta_t tensor(-0.0457, dtype=torch.float64)
9 gae_duplicate tensor(-1.8148, dtype=torch.float64) tensor(1.1023, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0140, dtype=torch.float64) delta_t tensor(0.1166, dtype=torch.float64)
8 gae_duplicate tensor(-1.0977, dtype=torch.float64) tensor(-1.4132, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2751, dtype=torch.float64) delta_t tensor(-0.4463, dtype=torch.float64)
7 gae_duplicate tensor(-0.8121, dtype=torch.float64) tensor(9.0386, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9549, dtype=torch.float64) delta_t tensor(-0.7184, dtype=torch.float64)
6 gae_duplicate tensor(-1.8184, dtype=torch.float64) tensor(12.7387, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9648, dtype=torch.float64) delta_t tensor(-0.6398, dtype=torch.float64)
5 gae_duplicate tensor(-1.3639, dtype=torch.float64) tensor(12.1357, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8752, dtype=torch.float64) delta_t tensor(-1.6606, dtype=torch.float64)
4 gae_duplicate tensor(-6.3958, dtype=torch.float64) tensor(24.4655, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7559, dtype=torch.float64) delta_t tensor(-0.4408, dtype=torch.float64)
3 gae_duplicate tensor(-1.2372, dtype=torch.float64) tensor(11.7446, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4378, dtype=torch.float64) delta_t tensor(-0.2438, dtype=torch.float64)
2 gae_duplicate tensor(-1.0561, dtype=torch.float64) tensor(6.6333, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-156.53269958496094
value loss:131.4514617919922
entropies:298.5893859863281
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3804.3008)
ToM Target loss= tensor(2957.4263)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.707479000091553 seconds
19 rew tensor(0.7726, dtype=torch.float64) delta_t tensor(0.3554, dtype=torch.float64)
19 gae_duplicate tensor(0.2603, dtype=torch.float64) tensor(-7.4713, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7645, dtype=torch.float64) delta_t tensor(0.3966, dtype=torch.float64)
18 gae_duplicate tensor(0.3010, dtype=torch.float64) tensor(-9.2345, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7564, dtype=torch.float64) delta_t tensor(0.3709, dtype=torch.float64)
17 gae_duplicate tensor(0.2504, dtype=torch.float64) tensor(-6.4477, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7398, dtype=torch.float64) delta_t tensor(0.3913, dtype=torch.float64)
16 gae_duplicate tensor(0.2676, dtype=torch.float64) tensor(-7.4497, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7147, dtype=torch.float64) delta_t tensor(0.3700, dtype=torch.float64)
15 gae_duplicate tensor(0.0533, dtype=torch.float64) tensor(-6.9014, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6640, dtype=torch.float64) delta_t tensor(0.2845, dtype=torch.float64)
14 gae_duplicate tensor(-0.3182, dtype=torch.float64) tensor(-7.5349, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7598, dtype=torch.float64) delta_t tensor(0.4679, dtype=torch.float64)
13 gae_duplicate tensor(0.3096, dtype=torch.float64) tensor(-8.4562, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7214, dtype=torch.float64) delta_t tensor(0.5006, dtype=torch.float64)
12 gae_duplicate tensor(0.3227, dtype=torch.float64) tensor(-11.2832, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7227, dtype=torch.float64) delta_t tensor(0.5721, dtype=torch.float64)
11 gae_duplicate tensor(0.1129, dtype=torch.float64) tensor(-8.6066, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6589, dtype=torch.float64) delta_t tensor(0.6453, dtype=torch.float64)
10 gae_duplicate tensor(0.1795, dtype=torch.float64) tensor(-12.4171, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0652, dtype=torch.float64) delta_t tensor(-0.1412, dtype=torch.float64)
9 gae_duplicate tensor(-1.8705, dtype=torch.float64) tensor(0.9394, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2774, dtype=torch.float64) delta_t tensor(-0.4017, dtype=torch.float64)
8 gae_duplicate tensor(-3.1234, dtype=torch.float64) tensor(6.1700, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0169, dtype=torch.float64) delta_t tensor(-0.0647, dtype=torch.float64)
7 gae_duplicate tensor(-0.5238, dtype=torch.float64) tensor(1.3662, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6687, dtype=torch.float64) delta_t tensor(-0.5135, dtype=torch.float64)
6 gae_duplicate tensor(-2.7413, dtype=torch.float64) tensor(8.1585, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9149, dtype=torch.float64) delta_t tensor(-0.5234, dtype=torch.float64)
5 gae_duplicate tensor(-1.2854, dtype=torch.float64) tensor(8.4005, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1515, dtype=torch.float64) delta_t tensor(-0.9194, dtype=torch.float64)
4 gae_duplicate tensor(-2.7705, dtype=torch.float64) tensor(12.1582, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8447, dtype=torch.float64) delta_t tensor(-0.5815, dtype=torch.float64)
3 gae_duplicate tensor(-1.1198, dtype=torch.float64) tensor(12.6898, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5026, dtype=torch.float64) delta_t tensor(-0.2903, dtype=torch.float64)
2 gae_duplicate tensor(-0.9657, dtype=torch.float64) tensor(5.8380, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1545.2655029296875
value loss:91.61815643310547
entropies:293.1940002441406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.772132158279419 seconds
19 rew tensor(0.5541, dtype=torch.float64) delta_t tensor(0.1182, dtype=torch.float64)
19 gae_duplicate tensor(-0.9846, dtype=torch.float64) tensor(-1.5241, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7283, dtype=torch.float64) delta_t tensor(0.3314, dtype=torch.float64)
18 gae_duplicate tensor(-0.0004, dtype=torch.float64) tensor(-4.8122, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6754, dtype=torch.float64) delta_t tensor(0.2999, dtype=torch.float64)
17 gae_duplicate tensor(-0.1974, dtype=torch.float64) tensor(-3.0121, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5922, dtype=torch.float64) delta_t tensor(0.1885, dtype=torch.float64)
16 gae_duplicate tensor(-0.8174, dtype=torch.float64) tensor(-4.1568, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7597, dtype=torch.float64) delta_t tensor(0.3344, dtype=torch.float64)
15 gae_duplicate tensor(0.0365, dtype=torch.float64) tensor(-4.9923, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7368, dtype=torch.float64) delta_t tensor(0.3465, dtype=torch.float64)
14 gae_duplicate tensor(0.0199, dtype=torch.float64) tensor(-7.8991, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7144, dtype=torch.float64) delta_t tensor(0.3084, dtype=torch.float64)
13 gae_duplicate tensor(-0.0981, dtype=torch.float64) tensor(-7.4307, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7761, dtype=torch.float64) delta_t tensor(0.3674, dtype=torch.float64)
12 gae_duplicate tensor(0.2074, dtype=torch.float64) tensor(-5.8741, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7765, dtype=torch.float64) delta_t tensor(0.5580, dtype=torch.float64)
11 gae_duplicate tensor(0.3943, dtype=torch.float64) tensor(-7.9471, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5637, dtype=torch.float64) delta_t tensor(0.5876, dtype=torch.float64)
10 gae_duplicate tensor(0.2407, dtype=torch.float64) tensor(-11.5829, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0673, dtype=torch.float64) delta_t tensor(-0.0537, dtype=torch.float64)
9 gae_duplicate tensor(-1.1688, dtype=torch.float64) tensor(-1.3569, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3157, dtype=torch.float64) delta_t tensor(-0.4535, dtype=torch.float64)
8 gae_duplicate tensor(-1.6768, dtype=torch.float64) tensor(3.4993, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6564, dtype=torch.float64) delta_t tensor(-0.7239, dtype=torch.float64)
7 gae_duplicate tensor(-1.8292, dtype=torch.float64) tensor(15.0762, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8054, dtype=torch.float64) delta_t tensor(-0.7384, dtype=torch.float64)
6 gae_duplicate tensor(-2.1404, dtype=torch.float64) tensor(13.1379, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9942, dtype=torch.float64) delta_t tensor(-0.8735, dtype=torch.float64)
5 gae_duplicate tensor(-2.2994, dtype=torch.float64) tensor(14.2546, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3578, dtype=torch.float64) delta_t tensor(-1.3920, dtype=torch.float64)
4 gae_duplicate tensor(-3.2439, dtype=torch.float64) tensor(22.0872, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4260, dtype=torch.float64) delta_t tensor(-0.2096, dtype=torch.float64)
3 gae_duplicate tensor(-0.9105, dtype=torch.float64) tensor(5.9978, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4337, dtype=torch.float64) delta_t tensor(-0.2336, dtype=torch.float64)
2 gae_duplicate tensor(-0.7413, dtype=torch.float64) tensor(3.8701, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1016.7988891601562
value loss:102.19631958007812
entropies:298.914794921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.549417972564697 seconds
19 rew tensor(0.7082, dtype=torch.float64) delta_t tensor(0.2665, dtype=torch.float64)
19 gae_duplicate tensor(0.1236, dtype=torch.float64) tensor(-3.1907, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6580, dtype=torch.float64) delta_t tensor(0.2250, dtype=torch.float64)
18 gae_duplicate tensor(-0.0330, dtype=torch.float64) tensor(-3.6214, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5320, dtype=torch.float64) delta_t tensor(0.1452, dtype=torch.float64)
17 gae_duplicate tensor(-0.2691, dtype=torch.float64) tensor(-2.1210, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2726, dtype=torch.float64) delta_t tensor(0.0034, dtype=torch.float64)
16 gae_duplicate tensor(-1.1681, dtype=torch.float64) tensor(-1.0030, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2918, dtype=torch.float64) delta_t tensor(-0.0189, dtype=torch.float64)
15 gae_duplicate tensor(-1.0496, dtype=torch.float64) tensor(-0.0111, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5399, dtype=torch.float64) delta_t tensor(0.2149, dtype=torch.float64)
14 gae_duplicate tensor(-1.0287, dtype=torch.float64) tensor(-3.5579, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7025, dtype=torch.float64) delta_t tensor(0.3079, dtype=torch.float64)
13 gae_duplicate tensor(0.0516, dtype=torch.float64) tensor(-4.7391, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6367, dtype=torch.float64) delta_t tensor(0.5394, dtype=torch.float64)
12 gae_duplicate tensor(0.0966, dtype=torch.float64) tensor(-9.4977, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5476, dtype=torch.float64) delta_t tensor(0.8312, dtype=torch.float64)
11 gae_duplicate tensor(0.4669, dtype=torch.float64) tensor(-13.9889, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3951, dtype=torch.float64) delta_t tensor(0.4117, dtype=torch.float64)
10 gae_duplicate tensor(-0.1350, dtype=torch.float64) tensor(-7.4703, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0865, dtype=torch.float64) delta_t tensor(-0.2609, dtype=torch.float64)
9 gae_duplicate tensor(-0.7368, dtype=torch.float64) tensor(5.0600, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3834, dtype=torch.float64) delta_t tensor(-0.4716, dtype=torch.float64)
8 gae_duplicate tensor(-1.9329, dtype=torch.float64) tensor(6.1636, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4126, dtype=torch.float64) delta_t tensor(-0.3673, dtype=torch.float64)
7 gae_duplicate tensor(-1.2243, dtype=torch.float64) tensor(3.4345, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0152, dtype=torch.float64) delta_t tensor(-0.9801, dtype=torch.float64)
6 gae_duplicate tensor(-2.4364, dtype=torch.float64) tensor(20.7434, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6225, dtype=torch.float64) delta_t tensor(-1.2196, dtype=torch.float64)
5 gae_duplicate tensor(-2.8011, dtype=torch.float64) tensor(28.4442, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1404, dtype=torch.float64) delta_t tensor(-0.8122, dtype=torch.float64)
4 gae_duplicate tensor(-3.7173, dtype=torch.float64) tensor(19.8082, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8248, dtype=torch.float64) delta_t tensor(-0.4970, dtype=torch.float64)
3 gae_duplicate tensor(-1.7483, dtype=torch.float64) tensor(8.2243, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3470, dtype=torch.float64) delta_t tensor(-0.0939, dtype=torch.float64)
2 gae_duplicate tensor(-0.7985, dtype=torch.float64) tensor(1.7251, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2478.27490234375
value loss:122.33705139160156
entropies:298.3533935546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.952700853347778 seconds
19 rew tensor(0.6606, dtype=torch.float64) delta_t tensor(0.3180, dtype=torch.float64)
19 gae_duplicate tensor(-0.2212, dtype=torch.float64) tensor(-3.1485, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5521, dtype=torch.float64) delta_t tensor(0.2340, dtype=torch.float64)
18 gae_duplicate tensor(-0.9253, dtype=torch.float64) tensor(-9.3042, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7252, dtype=torch.float64) delta_t tensor(0.5235, dtype=torch.float64)
17 gae_duplicate tensor(0.1180, dtype=torch.float64) tensor(-8.6123, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6407, dtype=torch.float64) delta_t tensor(0.3916, dtype=torch.float64)
16 gae_duplicate tensor(-0.2945, dtype=torch.float64) tensor(-8.3718, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5290, dtype=torch.float64) delta_t tensor(0.2674, dtype=torch.float64)
15 gae_duplicate tensor(-1.0851, dtype=torch.float64) tensor(-6.0284, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7230, dtype=torch.float64) delta_t tensor(0.4487, dtype=torch.float64)
14 gae_duplicate tensor(0.1107, dtype=torch.float64) tensor(-7.7964, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6659, dtype=torch.float64) delta_t tensor(0.5466, dtype=torch.float64)
13 gae_duplicate tensor(0.3040, dtype=torch.float64) tensor(-10.1709, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6941, dtype=torch.float64) delta_t tensor(0.4596, dtype=torch.float64)
12 gae_duplicate tensor(0.1975, dtype=torch.float64) tensor(-9.5838, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7021, dtype=torch.float64) delta_t tensor(0.4047, dtype=torch.float64)
11 gae_duplicate tensor(-0.0441, dtype=torch.float64) tensor(-6.0003, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6135, dtype=torch.float64) delta_t tensor(0.3927, dtype=torch.float64)
10 gae_duplicate tensor(-0.0392, dtype=torch.float64) tensor(-8.2148, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5443, dtype=torch.float64) delta_t tensor(-0.7854, dtype=torch.float64)
9 gae_duplicate tensor(-1.7829, dtype=torch.float64) tensor(12.1486, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9457, dtype=torch.float64) delta_t tensor(-0.9669, dtype=torch.float64)
8 gae_duplicate tensor(-2.9891, dtype=torch.float64) tensor(15.2406, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8554, dtype=torch.float64) delta_t tensor(-0.9899, dtype=torch.float64)
7 gae_duplicate tensor(-3.1370, dtype=torch.float64) tensor(25.1807, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7927, dtype=torch.float64) delta_t tensor(-0.8893, dtype=torch.float64)
6 gae_duplicate tensor(-2.6624, dtype=torch.float64) tensor(15.8693, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4349, dtype=torch.float64) delta_t tensor(-0.9910, dtype=torch.float64)
5 gae_duplicate tensor(-2.3034, dtype=torch.float64) tensor(20.7312, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0160, dtype=torch.float64) delta_t tensor(-1.7497, dtype=torch.float64)
4 gae_duplicate tensor(-3.8609, dtype=torch.float64) tensor(38.4547, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4397, dtype=torch.float64) delta_t tensor(-0.1320, dtype=torch.float64)
3 gae_duplicate tensor(-0.8234, dtype=torch.float64) tensor(4.3956, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3415, dtype=torch.float64) delta_t tensor(-0.0032, dtype=torch.float64)
2 gae_duplicate tensor(-0.5525, dtype=torch.float64) tensor(0.9593, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3089.5791015625
value loss:189.26754760742188
entropies:293.1712951660156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.224337816238403 seconds
19 rew tensor(0.7514, dtype=torch.float64) delta_t tensor(0.3112, dtype=torch.float64)
19 gae_duplicate tensor(0.1568, dtype=torch.float64) tensor(-6.6931, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7175, dtype=torch.float64) delta_t tensor(0.3315, dtype=torch.float64)
18 gae_duplicate tensor(0.1323, dtype=torch.float64) tensor(-5.8440, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6664, dtype=torch.float64) delta_t tensor(0.2750, dtype=torch.float64)
17 gae_duplicate tensor(-0.2145, dtype=torch.float64) tensor(-4.2724, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5639, dtype=torch.float64) delta_t tensor(0.1470, dtype=torch.float64)
16 gae_duplicate tensor(-1.0059, dtype=torch.float64) tensor(-1.2312, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7634, dtype=torch.float64) delta_t tensor(0.3977, dtype=torch.float64)
15 gae_duplicate tensor(0.2140, dtype=torch.float64) tensor(-7.4595, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7562, dtype=torch.float64) delta_t tensor(0.4670, dtype=torch.float64)
14 gae_duplicate tensor(0.3365, dtype=torch.float64) tensor(-8.5933, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7207, dtype=torch.float64) delta_t tensor(0.3709, dtype=torch.float64)
13 gae_duplicate tensor(0.2193, dtype=torch.float64) tensor(-4.9259, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6643, dtype=torch.float64) delta_t tensor(0.4314, dtype=torch.float64)
12 gae_duplicate tensor(0.1331, dtype=torch.float64) tensor(-7.8331, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6538, dtype=torch.float64) delta_t tensor(0.3798, dtype=torch.float64)
11 gae_duplicate tensor(0.0665, dtype=torch.float64) tensor(-8.6500, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5235, dtype=torch.float64) delta_t tensor(0.4115, dtype=torch.float64)
10 gae_duplicate tensor(0.0596, dtype=torch.float64) tensor(-6.8581, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2328, dtype=torch.float64) delta_t tensor(-0.3461, dtype=torch.float64)
9 gae_duplicate tensor(-1.9307, dtype=torch.float64) tensor(4.6698, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1624, dtype=torch.float64) delta_t tensor(-0.2083, dtype=torch.float64)
8 gae_duplicate tensor(-2.3204, dtype=torch.float64) tensor(0.4936, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5215, dtype=torch.float64) delta_t tensor(-0.3492, dtype=torch.float64)
7 gae_duplicate tensor(-2.3900, dtype=torch.float64) tensor(1.1598, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6691, dtype=torch.float64) delta_t tensor(-0.4696, dtype=torch.float64)
6 gae_duplicate tensor(-1.5721, dtype=torch.float64) tensor(10.7357, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1615, dtype=torch.float64) delta_t tensor(-0.9107, dtype=torch.float64)
5 gae_duplicate tensor(-3.0436, dtype=torch.float64) tensor(16.2020, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5292, dtype=torch.float64) delta_t tensor(-1.3734, dtype=torch.float64)
4 gae_duplicate tensor(-4.6446, dtype=torch.float64) tensor(24.0680, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6644, dtype=torch.float64) delta_t tensor(-0.4203, dtype=torch.float64)
3 gae_duplicate tensor(-1.6007, dtype=torch.float64) tensor(8.3331, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4292, dtype=torch.float64) delta_t tensor(-0.2527, dtype=torch.float64)
2 gae_duplicate tensor(-0.9187, dtype=torch.float64) tensor(4.7787, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-514.7182006835938
value loss:131.97463989257812
entropies:290.3287658691406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3725.6387)
ToM Target loss= tensor(2978.1938)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.237735271453857 seconds
19 rew tensor(0.7208, dtype=torch.float64) delta_t tensor(0.2704, dtype=torch.float64)
19 gae_duplicate tensor(0.1813, dtype=torch.float64) tensor(-4.7378, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6706, dtype=torch.float64) delta_t tensor(0.2735, dtype=torch.float64)
18 gae_duplicate tensor(0.1675, dtype=torch.float64) tensor(-4.6455, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5738, dtype=torch.float64) delta_t tensor(0.1995, dtype=torch.float64)
17 gae_duplicate tensor(-0.1859, dtype=torch.float64) tensor(-4.1887, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3714, dtype=torch.float64) delta_t tensor(0.0116, dtype=torch.float64)
16 gae_duplicate tensor(-1.0012, dtype=torch.float64) tensor(-0.2858, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3674, dtype=torch.float64) delta_t tensor(-0.0622, dtype=torch.float64)
15 gae_duplicate tensor(-0.9359, dtype=torch.float64) tensor(-0.0880, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6503, dtype=torch.float64) delta_t tensor(0.3621, dtype=torch.float64)
14 gae_duplicate tensor(-0.3963, dtype=torch.float64) tensor(-6.0736, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7057, dtype=torch.float64) delta_t tensor(0.4104, dtype=torch.float64)
13 gae_duplicate tensor(0.2294, dtype=torch.float64) tensor(-8.0556, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6975, dtype=torch.float64) delta_t tensor(0.3884, dtype=torch.float64)
12 gae_duplicate tensor(0.0124, dtype=torch.float64) tensor(-6.2522, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7052, dtype=torch.float64) delta_t tensor(0.4575, dtype=torch.float64)
11 gae_duplicate tensor(0.0950, dtype=torch.float64) tensor(-8.6754, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6416, dtype=torch.float64) delta_t tensor(0.5653, dtype=torch.float64)
10 gae_duplicate tensor(0.3777, dtype=torch.float64) tensor(-14.3973, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8562, dtype=torch.float64) delta_t tensor(-1.1295, dtype=torch.float64)
9 gae_duplicate tensor(-2.2969, dtype=torch.float64) tensor(20.2042, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8169, dtype=torch.float64) delta_t tensor(-1.1534, dtype=torch.float64)
8 gae_duplicate tensor(-2.6763, dtype=torch.float64) tensor(14.7158, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7259, dtype=torch.float64) delta_t tensor(-0.9598, dtype=torch.float64)
7 gae_duplicate tensor(-2.2608, dtype=torch.float64) tensor(12.3871, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3046, dtype=torch.float64) delta_t tensor(-1.2952, dtype=torch.float64)
6 gae_duplicate tensor(-3.2480, dtype=torch.float64) tensor(20.5535, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4985, dtype=torch.float64) delta_t tensor(-1.4524, dtype=torch.float64)
5 gae_duplicate tensor(-2.1864, dtype=torch.float64) tensor(21.1832, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9512, dtype=torch.float64) delta_t tensor(-3.8842, dtype=torch.float64)
4 gae_duplicate tensor(-5.5967, dtype=torch.float64) tensor(91.4434, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2122, dtype=torch.float64) delta_t tensor(0.2209, dtype=torch.float64)
3 gae_duplicate tensor(-0.7387, dtype=torch.float64) tensor(1.9308, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2615, dtype=torch.float64) delta_t tensor(-0.0048, dtype=torch.float64)
2 gae_duplicate tensor(-1.1151, dtype=torch.float64) tensor(-0.9349, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6778.97412109375
value loss:309.36541748046875
entropies:290.6656494140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.858515024185181 seconds
19 rew tensor(0.7183, dtype=torch.float64) delta_t tensor(0.3185, dtype=torch.float64)
19 gae_duplicate tensor(0.1729, dtype=torch.float64) tensor(-5.1372, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6523, dtype=torch.float64) delta_t tensor(0.3223, dtype=torch.float64)
18 gae_duplicate tensor(0.1042, dtype=torch.float64) tensor(-5.2488, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5214, dtype=torch.float64) delta_t tensor(0.1979, dtype=torch.float64)
17 gae_duplicate tensor(-0.1099, dtype=torch.float64) tensor(-2.7247, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3153, dtype=torch.float64) delta_t tensor(0.1725, dtype=torch.float64)
16 gae_duplicate tensor(-0.3841, dtype=torch.float64) tensor(-4.6652, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5249, dtype=torch.float64) delta_t tensor(0.2801, dtype=torch.float64)
15 gae_duplicate tensor(-0.9478, dtype=torch.float64) tensor(-4.8680, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7036, dtype=torch.float64) delta_t tensor(0.5580, dtype=torch.float64)
14 gae_duplicate tensor(0.2078, dtype=torch.float64) tensor(-11.0787, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6670, dtype=torch.float64) delta_t tensor(0.4984, dtype=torch.float64)
13 gae_duplicate tensor(0.3238, dtype=torch.float64) tensor(-8.8504, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7264, dtype=torch.float64) delta_t tensor(0.5494, dtype=torch.float64)
12 gae_duplicate tensor(0.2478, dtype=torch.float64) tensor(-14.8533, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7187, dtype=torch.float64) delta_t tensor(0.5933, dtype=torch.float64)
11 gae_duplicate tensor(0.2169, dtype=torch.float64) tensor(-10.0908, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6181, dtype=torch.float64) delta_t tensor(0.4050, dtype=torch.float64)
10 gae_duplicate tensor(0.0819, dtype=torch.float64) tensor(-8.0273, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1553, dtype=torch.float64) delta_t tensor(-0.3423, dtype=torch.float64)
9 gae_duplicate tensor(-1.6253, dtype=torch.float64) tensor(4.5692, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7113, dtype=torch.float64) delta_t tensor(-0.8932, dtype=torch.float64)
8 gae_duplicate tensor(-2.9796, dtype=torch.float64) tensor(12.8188, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6632, dtype=torch.float64) delta_t tensor(-0.6972, dtype=torch.float64)
7 gae_duplicate tensor(-1.7011, dtype=torch.float64) tensor(13.8362, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1174, dtype=torch.float64) delta_t tensor(-0.9903, dtype=torch.float64)
6 gae_duplicate tensor(-2.6236, dtype=torch.float64) tensor(15.0945, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5315, dtype=torch.float64) delta_t tensor(-1.3696, dtype=torch.float64)
5 gae_duplicate tensor(-2.0365, dtype=torch.float64) tensor(24.5009, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7934, dtype=torch.float64) delta_t tensor(-2.5911, dtype=torch.float64)
4 gae_duplicate tensor(-7.1762, dtype=torch.float64) tensor(45.4758, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6562, dtype=torch.float64) delta_t tensor(-0.2687, dtype=torch.float64)
3 gae_duplicate tensor(-1.1564, dtype=torch.float64) tensor(11.5814, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2646, dtype=torch.float64) delta_t tensor(0.1264, dtype=torch.float64)
2 gae_duplicate tensor(-0.1939, dtype=torch.float64) tensor(-0.1344, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2898.02392578125
value loss:243.068603515625
entropies:293.81298828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.743700981140137 seconds
19 rew tensor(0.7672, dtype=torch.float64) delta_t tensor(0.3472, dtype=torch.float64)
19 gae_duplicate tensor(0.2233, dtype=torch.float64) tensor(-5.7291, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7596, dtype=torch.float64) delta_t tensor(0.4458, dtype=torch.float64)
18 gae_duplicate tensor(0.2989, dtype=torch.float64) tensor(-9.3213, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7433, dtype=torch.float64) delta_t tensor(0.4424, dtype=torch.float64)
17 gae_duplicate tensor(0.3801, dtype=torch.float64) tensor(-7.4191, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7270, dtype=torch.float64) delta_t tensor(0.3767, dtype=torch.float64)
16 gae_duplicate tensor(0.3286, dtype=torch.float64) tensor(-6.3234, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6773, dtype=torch.float64) delta_t tensor(0.3079, dtype=torch.float64)
15 gae_duplicate tensor(0.1449, dtype=torch.float64) tensor(-5.1379, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5777, dtype=torch.float64) delta_t tensor(0.2214, dtype=torch.float64)
14 gae_duplicate tensor(-0.2286, dtype=torch.float64) tensor(-4.0677, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7290, dtype=torch.float64) delta_t tensor(0.3671, dtype=torch.float64)
13 gae_duplicate tensor(0.1866, dtype=torch.float64) tensor(-5.8003, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7294, dtype=torch.float64) delta_t tensor(0.5977, dtype=torch.float64)
12 gae_duplicate tensor(0.1928, dtype=torch.float64) tensor(-10.9406, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6725, dtype=torch.float64) delta_t tensor(0.3904, dtype=torch.float64)
11 gae_duplicate tensor(0.0176, dtype=torch.float64) tensor(-7.4925, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6264, dtype=torch.float64) delta_t tensor(0.5026, dtype=torch.float64)
10 gae_duplicate tensor(-0.0700, dtype=torch.float64) tensor(-6.2981, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2704, dtype=torch.float64) delta_t tensor(-0.4152, dtype=torch.float64)
9 gae_duplicate tensor(-1.7848, dtype=torch.float64) tensor(5.9405, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1236, dtype=torch.float64) delta_t tensor(-0.2120, dtype=torch.float64)
8 gae_duplicate tensor(-2.2934, dtype=torch.float64) tensor(8.6918, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3101, dtype=torch.float64) delta_t tensor(-0.2185, dtype=torch.float64)
7 gae_duplicate tensor(-1.4587, dtype=torch.float64) tensor(4.2709, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8092, dtype=torch.float64) delta_t tensor(-0.8136, dtype=torch.float64)
6 gae_duplicate tensor(-1.7678, dtype=torch.float64) tensor(14.2637, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2985, dtype=torch.float64) delta_t tensor(-1.0016, dtype=torch.float64)
5 gae_duplicate tensor(-2.5270, dtype=torch.float64) tensor(17.2024, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6249, dtype=torch.float64) delta_t tensor(-2.2237, dtype=torch.float64)
4 gae_duplicate tensor(-5.3656, dtype=torch.float64) tensor(50.2974, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3346, dtype=torch.float64) delta_t tensor(-0.0060, dtype=torch.float64)
3 gae_duplicate tensor(-1.4412, dtype=torch.float64) tensor(5.7807, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5517, dtype=torch.float64) delta_t tensor(-0.2637, dtype=torch.float64)
2 gae_duplicate tensor(-0.7448, dtype=torch.float64) tensor(5.0025, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2396.542236328125
value loss:157.13717651367188
entropies:292.08514404296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.13631796836853 seconds
19 rew tensor(0.7431, dtype=torch.float64) delta_t tensor(0.4596, dtype=torch.float64)
19 gae_duplicate tensor(0.2605, dtype=torch.float64) tensor(-7.5577, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6931, dtype=torch.float64) delta_t tensor(0.3985, dtype=torch.float64)
18 gae_duplicate tensor(0.1511, dtype=torch.float64) tensor(-8.7873, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6173, dtype=torch.float64) delta_t tensor(0.2843, dtype=torch.float64)
17 gae_duplicate tensor(-0.1608, dtype=torch.float64) tensor(-5.9779, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4645, dtype=torch.float64) delta_t tensor(0.1681, dtype=torch.float64)
16 gae_duplicate tensor(-0.7747, dtype=torch.float64) tensor(-2.5319, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5819, dtype=torch.float64) delta_t tensor(0.3346, dtype=torch.float64)
15 gae_duplicate tensor(-0.6582, dtype=torch.float64) tensor(-3.4960, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7361, dtype=torch.float64) delta_t tensor(0.4772, dtype=torch.float64)
14 gae_duplicate tensor(0.3541, dtype=torch.float64) tensor(-10.2482, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6601, dtype=torch.float64) delta_t tensor(0.6276, dtype=torch.float64)
13 gae_duplicate tensor(0.3634, dtype=torch.float64) tensor(-9.9991, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5450, dtype=torch.float64) delta_t tensor(0.4989, dtype=torch.float64)
12 gae_duplicate tensor(0.0654, dtype=torch.float64) tensor(-7.6993, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5696, dtype=torch.float64) delta_t tensor(0.5389, dtype=torch.float64)
11 gae_duplicate tensor(0.3132, dtype=torch.float64) tensor(-8.9005, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3235, dtype=torch.float64) delta_t tensor(0.2259, dtype=torch.float64)
10 gae_duplicate tensor(-0.1540, dtype=torch.float64) tensor(-7.5056, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2693, dtype=torch.float64) delta_t tensor(-0.4711, dtype=torch.float64)
9 gae_duplicate tensor(-1.6106, dtype=torch.float64) tensor(7.1261, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7496, dtype=torch.float64) delta_t tensor(-0.8640, dtype=torch.float64)
8 gae_duplicate tensor(-1.9599, dtype=torch.float64) tensor(10.0446, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1360, dtype=torch.float64) delta_t tensor(-1.2792, dtype=torch.float64)
7 gae_duplicate tensor(-2.0557, dtype=torch.float64) tensor(20.7759, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0536, dtype=torch.float64) delta_t tensor(-0.9772, dtype=torch.float64)
6 gae_duplicate tensor(-2.2406, dtype=torch.float64) tensor(18.0114, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6126, dtype=torch.float64) delta_t tensor(-1.6383, dtype=torch.float64)
5 gae_duplicate tensor(-4.1764, dtype=torch.float64) tensor(32.2195, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8055, dtype=torch.float64) delta_t tensor(-1.3954, dtype=torch.float64)
4 gae_duplicate tensor(-4.3639, dtype=torch.float64) tensor(20.8033, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3919, dtype=torch.float64) delta_t tensor(-0.1958, dtype=torch.float64)
3 gae_duplicate tensor(-0.8965, dtype=torch.float64) tensor(6.5575, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4088, dtype=torch.float64) delta_t tensor(-0.2720, dtype=torch.float64)
2 gae_duplicate tensor(-1.0529, dtype=torch.float64) tensor(6.7044, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2755.4384765625
value loss:178.25282287597656
entropies:297.47125244140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.870051145553589 seconds
19 rew tensor(0.7772, dtype=torch.float64) delta_t tensor(0.3996, dtype=torch.float64)
19 gae_duplicate tensor(0.2203, dtype=torch.float64) tensor(-7.2346, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7776, dtype=torch.float64) delta_t tensor(0.5046, dtype=torch.float64)
18 gae_duplicate tensor(0.4171, dtype=torch.float64) tensor(-8.8308, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7780, dtype=torch.float64) delta_t tensor(0.4807, dtype=torch.float64)
17 gae_duplicate tensor(0.4114, dtype=torch.float64) tensor(-8.4357, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7710, dtype=torch.float64) delta_t tensor(0.4586, dtype=torch.float64)
16 gae_duplicate tensor(0.3851, dtype=torch.float64) tensor(-7.8805, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7788, dtype=torch.float64) delta_t tensor(0.5048, dtype=torch.float64)
15 gae_duplicate tensor(0.4019, dtype=torch.float64) tensor(-7.6127, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7718, dtype=torch.float64) delta_t tensor(0.4540, dtype=torch.float64)
14 gae_duplicate tensor(0.3741, dtype=torch.float64) tensor(-9.4975, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7796, dtype=torch.float64) delta_t tensor(0.4950, dtype=torch.float64)
13 gae_duplicate tensor(0.3565, dtype=torch.float64) tensor(-7.6007, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7800, dtype=torch.float64) delta_t tensor(0.5240, dtype=torch.float64)
12 gae_duplicate tensor(0.3515, dtype=torch.float64) tensor(-8.9100, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7804, dtype=torch.float64) delta_t tensor(0.6092, dtype=torch.float64)
11 gae_duplicate tensor(0.4968, dtype=torch.float64) tensor(-10.6549, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7659, dtype=torch.float64) delta_t tensor(0.6665, dtype=torch.float64)
10 gae_duplicate tensor(0.5245, dtype=torch.float64) tensor(-11.3427, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5225, dtype=torch.float64) delta_t tensor(0.5869, dtype=torch.float64)
9 gae_duplicate tensor(0.2816, dtype=torch.float64) tensor(-7.9203, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1833, dtype=torch.float64) delta_t tensor(0.0825, dtype=torch.float64)
8 gae_duplicate tensor(-0.2725, dtype=torch.float64) tensor(-2.5895, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0109, dtype=torch.float64) delta_t tensor(0.0481, dtype=torch.float64)
7 gae_duplicate tensor(-0.4825, dtype=torch.float64) tensor(-1.2130, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3984, dtype=torch.float64) delta_t tensor(-0.0449, dtype=torch.float64)
6 gae_duplicate tensor(-0.3379, dtype=torch.float64) tensor(0.4413, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7256, dtype=torch.float64) delta_t tensor(-0.5349, dtype=torch.float64)
5 gae_duplicate tensor(-1.1194, dtype=torch.float64) tensor(11.3196, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3497, dtype=torch.float64) delta_t tensor(-1.1424, dtype=torch.float64)
4 gae_duplicate tensor(-1.5593, dtype=torch.float64) tensor(19.5747, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0624, dtype=torch.float64) delta_t tensor(-0.6480, dtype=torch.float64)
3 gae_duplicate tensor(-1.1977, dtype=torch.float64) tensor(13.7636, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8845, dtype=torch.float64) delta_t tensor(-0.6863, dtype=torch.float64)
2 gae_duplicate tensor(-1.1240, dtype=torch.float64) tensor(12.9445, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2170.827880859375
value loss:68.26378631591797
entropies:295.69061279296875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3716.2803)
ToM Target loss= tensor(3011.3740)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.798001289367676 seconds
19 rew tensor(0.7693, dtype=torch.float64) delta_t tensor(0.4015, dtype=torch.float64)
19 gae_duplicate tensor(0.2227, dtype=torch.float64) tensor(-4.9156, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7533, dtype=torch.float64) delta_t tensor(0.3805, dtype=torch.float64)
18 gae_duplicate tensor(0.3129, dtype=torch.float64) tensor(-6.4021, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7209, dtype=torch.float64) delta_t tensor(0.4323, dtype=torch.float64)
17 gae_duplicate tensor(0.1741, dtype=torch.float64) tensor(-8.5759, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6803, dtype=torch.float64) delta_t tensor(0.5393, dtype=torch.float64)
16 gae_duplicate tensor(0.2885, dtype=torch.float64) tensor(-10.6386, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5825, dtype=torch.float64) delta_t tensor(0.4663, dtype=torch.float64)
15 gae_duplicate tensor(0.3145, dtype=torch.float64) tensor(-10.7342, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7710, dtype=torch.float64) delta_t tensor(0.6637, dtype=torch.float64)
14 gae_duplicate tensor(0.3965, dtype=torch.float64) tensor(-10.0162, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7795, dtype=torch.float64) delta_t tensor(0.7593, dtype=torch.float64)
13 gae_duplicate tensor(0.3644, dtype=torch.float64) tensor(-15.6198, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7799, dtype=torch.float64) delta_t tensor(0.8621, dtype=torch.float64)
12 gae_duplicate tensor(0.5189, dtype=torch.float64) tensor(-17.4489, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7639, dtype=torch.float64) delta_t tensor(0.7493, dtype=torch.float64)
11 gae_duplicate tensor(0.4877, dtype=torch.float64) tensor(-12.8931, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7480, dtype=torch.float64) delta_t tensor(0.7451, dtype=torch.float64)
10 gae_duplicate tensor(0.6658, dtype=torch.float64) tensor(-12.8431, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5450, dtype=torch.float64) delta_t tensor(0.5980, dtype=torch.float64)
9 gae_duplicate tensor(0.4421, dtype=torch.float64) tensor(-12.2460, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3335, dtype=torch.float64) delta_t tensor(0.3979, dtype=torch.float64)
8 gae_duplicate tensor(0.2813, dtype=torch.float64) tensor(-8.0675, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3005, dtype=torch.float64) delta_t tensor(-0.2588, dtype=torch.float64)
7 gae_duplicate tensor(-0.4197, dtype=torch.float64) tensor(3.3970, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6326, dtype=torch.float64) delta_t tensor(-0.3323, dtype=torch.float64)
6 gae_duplicate tensor(-1.1897, dtype=torch.float64) tensor(5.4315, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9399, dtype=torch.float64) delta_t tensor(-0.5696, dtype=torch.float64)
5 gae_duplicate tensor(-1.8596, dtype=torch.float64) tensor(9.0962, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3868, dtype=torch.float64) delta_t tensor(-1.1135, dtype=torch.float64)
4 gae_duplicate tensor(-1.5453, dtype=torch.float64) tensor(23.9355, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9265, dtype=torch.float64) delta_t tensor(-0.5286, dtype=torch.float64)
3 gae_duplicate tensor(-1.2827, dtype=torch.float64) tensor(11.0194, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6306, dtype=torch.float64) delta_t tensor(-0.3324, dtype=torch.float64)
2 gae_duplicate tensor(-0.9706, dtype=torch.float64) tensor(6.1242, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3774.447998046875
value loss:91.21821594238281
entropies:300.03497314453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.949595212936401 seconds
19 rew tensor(0.5341, dtype=torch.float64) delta_t tensor(0.1657, dtype=torch.float64)
19 gae_duplicate tensor(-0.9856, dtype=torch.float64) tensor(-1.5693, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7386, dtype=torch.float64) delta_t tensor(0.4091, dtype=torch.float64)
18 gae_duplicate tensor(0.1919, dtype=torch.float64) tensor(-4.9875, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6914, dtype=torch.float64) delta_t tensor(0.4485, dtype=torch.float64)
17 gae_duplicate tensor(0.2462, dtype=torch.float64) tensor(-7.5037, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5808, dtype=torch.float64) delta_t tensor(0.3466, dtype=torch.float64)
16 gae_duplicate tensor(0.0148, dtype=torch.float64) tensor(-5.1090, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3897, dtype=torch.float64) delta_t tensor(0.1345, dtype=torch.float64)
15 gae_duplicate tensor(-0.5367, dtype=torch.float64) tensor(-3.5156, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6168, dtype=torch.float64) delta_t tensor(0.4911, dtype=torch.float64)
14 gae_duplicate tensor(0.0900, dtype=torch.float64) tensor(-10.4942, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7072, dtype=torch.float64) delta_t tensor(0.6351, dtype=torch.float64)
13 gae_duplicate tensor(0.3181, dtype=torch.float64) tensor(-11.1114, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1578, dtype=torch.float64) delta_t tensor(0.0487, dtype=torch.float64)
12 gae_duplicate tensor(-1.8767, dtype=torch.float64) tensor(-3.9899, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2496, dtype=torch.float64) delta_t tensor(0.3773, dtype=torch.float64)
11 gae_duplicate tensor(-1.2831, dtype=torch.float64) tensor(-1.0221, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4687, dtype=torch.float64) delta_t tensor(0.4613, dtype=torch.float64)
10 gae_duplicate tensor(0.1128, dtype=torch.float64) tensor(-7.2743, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1276, dtype=torch.float64) delta_t tensor(-0.2425, dtype=torch.float64)
9 gae_duplicate tensor(-1.4552, dtype=torch.float64) tensor(2.2215, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3900, dtype=torch.float64) delta_t tensor(-0.5443, dtype=torch.float64)
8 gae_duplicate tensor(-1.8687, dtype=torch.float64) tensor(13.4961, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9040, dtype=torch.float64) delta_t tensor(-0.9880, dtype=torch.float64)
7 gae_duplicate tensor(-2.1761, dtype=torch.float64) tensor(13.3569, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3793, dtype=torch.float64) delta_t tensor(-0.2550, dtype=torch.float64)
6 gae_duplicate tensor(-1.9774, dtype=torch.float64) tensor(8.7321, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1684, dtype=torch.float64) delta_t tensor(-0.7562, dtype=torch.float64)
5 gae_duplicate tensor(-2.2854, dtype=torch.float64) tensor(13.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1984, dtype=torch.float64) delta_t tensor(-1.9422, dtype=torch.float64)
4 gae_duplicate tensor(-5.2997, dtype=torch.float64) tensor(32.0382, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2704, dtype=torch.float64) delta_t tensor(-0.0234, dtype=torch.float64)
3 gae_duplicate tensor(-1.2398, dtype=torch.float64) tensor(3.6691, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1512, dtype=torch.float64) delta_t tensor(0.1699, dtype=torch.float64)
2 gae_duplicate tensor(-0.3246, dtype=torch.float64) tensor(-1.7373, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1649.6728515625
value loss:168.22830200195312
entropies:297.0511169433594
Policy training finished
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 809, in _callmethod
    conn.send((self._id, methodname, args, kwds))
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 206, in send
    self._send_bytes(_ForkingPickler.dumps(obj))
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
KeyboardInterrupt