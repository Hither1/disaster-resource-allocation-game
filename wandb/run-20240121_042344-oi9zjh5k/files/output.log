obs <crafter.objects.Shelter object at 0x150b837f0> [39  0 39  0  8  0]
obs <crafter.objects.Warehouse object at 0x11a6bb9d0> [42  0 40  0  9  0]
obs <crafter.objects.Station object at 0x150b883a0> [ 9  0  9  0 11  0]
obs <crafter.objects.Shelter object at 0x150b837f0> [39  0 39  0 12  0]
obs <crafter.objects.Warehouse object at 0x11a6bb9d0> [38  0 41  0  9  0]
obs <crafter.objects.Station object at 0x150b883a0> [ 9  0  9  0 12  0]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0031082630157470703 seconds
19 rew tensor(0.7680, dtype=torch.float64) delta_t tensor(0.7459, dtype=torch.float64)
19 gae_duplicate tensor(0.3984, dtype=torch.float64) tensor(-14.7963, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4489, dtype=torch.float64) delta_t tensor(0.4217, dtype=torch.float64)
18 gae_duplicate tensor(0.2968, dtype=torch.float64) tensor(-9.8143, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8101, dtype=torch.float64) delta_t tensor(0.7942, dtype=torch.float64)
17 gae_duplicate tensor(0.6004, dtype=torch.float64) tensor(-16.5383, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4708, dtype=torch.float64) delta_t tensor(0.4055, dtype=torch.float64)
16 gae_duplicate tensor(0.3629, dtype=torch.float64) tensor(-9.9615, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7611, dtype=torch.float64) delta_t tensor(0.7613, dtype=torch.float64)
15 gae_duplicate tensor(0.6453, dtype=torch.float64) tensor(-15.7598, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3919, dtype=torch.float64) delta_t tensor(0.3918, dtype=torch.float64)
14 gae_duplicate tensor(0.3598, dtype=torch.float64) tensor(-9.5691, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5592, dtype=torch.float64) delta_t tensor(0.6725, dtype=torch.float64)
13 gae_duplicate tensor(-0.8768, dtype=torch.float64) tensor(-14.4687, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3853, dtype=torch.float64) delta_t tensor(0.3776, dtype=torch.float64)
12 gae_duplicate tensor(-0.0116, dtype=torch.float64) tensor(-8.8130, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9510, dtype=torch.float64) delta_t tensor(0.9290, dtype=torch.float64)
11 gae_duplicate tensor(0.6688, dtype=torch.float64) tensor(-19.2354, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5043, dtype=torch.float64) delta_t tensor(0.4943, dtype=torch.float64)
10 gae_duplicate tensor(0.0865, dtype=torch.float64) tensor(-11.8001, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(1.0596, dtype=torch.float64) delta_t tensor(1.0121, dtype=torch.float64)
9 gae_duplicate tensor(0.7599, dtype=torch.float64) tensor(-20.9798, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5971, dtype=torch.float64) delta_t tensor(0.5590, dtype=torch.float64)
8 gae_duplicate tensor(0.1147, dtype=torch.float64) tensor(-13.4057, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(1.1817, dtype=torch.float64) delta_t tensor(1.1947, dtype=torch.float64)
7 gae_duplicate tensor(0.9011, dtype=torch.float64) tensor(-25.2936, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7995, dtype=torch.float64) delta_t tensor(0.7914, dtype=torch.float64)
6 gae_duplicate tensor(0.2468, dtype=torch.float64) tensor(-17.9555, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5643, dtype=torch.float64) delta_t tensor(-0.4115, dtype=torch.float64)
5 gae_duplicate tensor(-1.4969, dtype=torch.float64) tensor(6.4464, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1262, dtype=torch.float64) delta_t tensor(-0.9899, dtype=torch.float64)
4 gae_duplicate tensor(-1.7886, dtype=torch.float64) tensor(19.9555, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.6667, dtype=torch.float64) delta_t tensor(0.6654, dtype=torch.float64)
3 gae_duplicate tensor(-0.3045, dtype=torch.float64) tensor(-11.4666, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0962, dtype=torch.float64) delta_t tensor(-0.2444, dtype=torch.float64)
2 gae_duplicate tensor(-0.7836, dtype=torch.float64) tensor(3.6860, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:10151.6630859375
value loss:129.79330444335938
entropies:355.2412109375
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 5.238379001617432 seconds
19 rew tensor(0.6541, dtype=torch.float64) delta_t tensor(0.5687, dtype=torch.float64)
19 gae_duplicate tensor(0.3823, dtype=torch.float64) tensor(-11.3105, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5906, dtype=torch.float64) delta_t tensor(0.5417, dtype=torch.float64)
18 gae_duplicate tensor(0.2564, dtype=torch.float64) tensor(-11.8317, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5860, dtype=torch.float64) delta_t tensor(0.5832, dtype=torch.float64)
17 gae_duplicate tensor(0.3059, dtype=torch.float64) tensor(-12.8489, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4193, dtype=torch.float64) delta_t tensor(0.4101, dtype=torch.float64)
16 gae_duplicate tensor(0.1944, dtype=torch.float64) tensor(-9.3504, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3616, dtype=torch.float64) delta_t tensor(0.4041, dtype=torch.float64)
15 gae_duplicate tensor(-0.7225, dtype=torch.float64) tensor(-8.9519, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3244, dtype=torch.float64) delta_t tensor(0.3683, dtype=torch.float64)
14 gae_duplicate tensor(-0.1506, dtype=torch.float64) tensor(-8.1092, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6761, dtype=torch.float64) delta_t tensor(0.7276, dtype=torch.float64)
13 gae_duplicate tensor(0.2310, dtype=torch.float64) tensor(-14.9733, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2687, dtype=torch.float64) delta_t tensor(0.2394, dtype=torch.float64)
12 gae_duplicate tensor(-0.1497, dtype=torch.float64) tensor(-6.1463, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7110, dtype=torch.float64) delta_t tensor(0.6762, dtype=torch.float64)
11 gae_duplicate tensor(0.2457, dtype=torch.float64) tensor(-13.8328, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2935, dtype=torch.float64) delta_t tensor(0.2677, dtype=torch.float64)
10 gae_duplicate tensor(-0.1447, dtype=torch.float64) tensor(-6.7555, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.7299, dtype=torch.float64) delta_t tensor(0.6628, dtype=torch.float64)
9 gae_duplicate tensor(0.2236, dtype=torch.float64) tensor(-13.6140, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2360, dtype=torch.float64) delta_t tensor(0.1849, dtype=torch.float64)
8 gae_duplicate tensor(-0.2645, dtype=torch.float64) tensor(-5.0532, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.6645, dtype=torch.float64) delta_t tensor(0.6289, dtype=torch.float64)
7 gae_duplicate tensor(-0.0970, dtype=torch.float64) tensor(-12.9584, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1093, dtype=torch.float64) delta_t tensor(0.0456, dtype=torch.float64)
6 gae_duplicate tensor(-0.3083, dtype=torch.float64) tensor(-2.1851, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8781, dtype=torch.float64) delta_t tensor(-1.7667, dtype=torch.float64)
5 gae_duplicate tensor(-3.2770, dtype=torch.float64) tensor(34.5519, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8833, dtype=torch.float64) delta_t tensor(-1.7920, dtype=torch.float64)
4 gae_duplicate tensor(-4.5966, dtype=torch.float64) tensor(38.2831, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3320, dtype=torch.float64) delta_t tensor(-0.3783, dtype=torch.float64)
3 gae_duplicate tensor(-1.4500, dtype=torch.float64) tensor(11.3480, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4573, dtype=torch.float64) delta_t tensor(-0.6165, dtype=torch.float64)
2 gae_duplicate tensor(-1.6813, dtype=torch.float64) tensor(13.2112, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2092.40673828125
value loss:154.15313720703125
entropies:355.74554443359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.963489770889282 seconds
19 rew tensor(0.5901, dtype=torch.float64) delta_t tensor(0.5276, dtype=torch.float64)
19 gae_duplicate tensor(0.3262, dtype=torch.float64) tensor(-10.4236, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4570, dtype=torch.float64) delta_t tensor(0.3606, dtype=torch.float64)
18 gae_duplicate tensor(0.1760, dtype=torch.float64) tensor(-8.1686, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5872, dtype=torch.float64) delta_t tensor(0.5002, dtype=torch.float64)
17 gae_duplicate tensor(0.3656, dtype=torch.float64) tensor(-10.7225, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4485, dtype=torch.float64) delta_t tensor(0.4330, dtype=torch.float64)
16 gae_duplicate tensor(0.3096, dtype=torch.float64) tensor(-9.6208, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5899, dtype=torch.float64) delta_t tensor(0.6766, dtype=torch.float64)
15 gae_duplicate tensor(0.3626, dtype=torch.float64) tensor(-14.3401, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3797, dtype=torch.float64) delta_t tensor(0.3927, dtype=torch.float64)
14 gae_duplicate tensor(0.3166, dtype=torch.float64) tensor(-9.2029, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6475, dtype=torch.float64) delta_t tensor(0.7157, dtype=torch.float64)
13 gae_duplicate tensor(0.5978, dtype=torch.float64) tensor(-15.0975, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3430, dtype=torch.float64) delta_t tensor(0.3081, dtype=torch.float64)
12 gae_duplicate tensor(0.1296, dtype=torch.float64) tensor(-7.6007, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6816, dtype=torch.float64) delta_t tensor(0.6497, dtype=torch.float64)
11 gae_duplicate tensor(0.5807, dtype=torch.float64) tensor(-13.6033, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3725, dtype=torch.float64) delta_t tensor(0.3449, dtype=torch.float64)
10 gae_duplicate tensor(0.1215, dtype=torch.float64) tensor(-8.1882, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6932, dtype=torch.float64) delta_t tensor(0.6224, dtype=torch.float64)
9 gae_duplicate tensor(0.5614, dtype=torch.float64) tensor(-13.1110, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3379, dtype=torch.float64) delta_t tensor(0.2766, dtype=torch.float64)
8 gae_duplicate tensor(0.0381, dtype=torch.float64) tensor(-6.7714, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.6539, dtype=torch.float64) delta_t tensor(0.6440, dtype=torch.float64)
7 gae_duplicate tensor(0.5824, dtype=torch.float64) tensor(-13.4355, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3033, dtype=torch.float64) delta_t tensor(0.2285, dtype=torch.float64)
6 gae_duplicate tensor(-0.0114, dtype=torch.float64) tensor(-5.8590, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5602, dtype=torch.float64) delta_t tensor(-1.4192, dtype=torch.float64)
5 gae_duplicate tensor(-2.4519, dtype=torch.float64) tensor(27.4563, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3174, dtype=torch.float64) delta_t tensor(-3.2516, dtype=torch.float64)
4 gae_duplicate tensor(-5.6944, dtype=torch.float64) tensor(67.1756, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1634, dtype=torch.float64) delta_t tensor(-0.2481, dtype=torch.float64)
3 gae_duplicate tensor(-1.3289, dtype=torch.float64) tensor(11.5968, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4186, dtype=torch.float64) delta_t tensor(-0.5569, dtype=torch.float64)
2 gae_duplicate tensor(-1.1915, dtype=torch.float64) tensor(12.1876, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1401.247802734375
value loss:207.3257598876953
entropies:355.9466857910156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.39424991607666 seconds
19 rew tensor(0.6565, dtype=torch.float64) delta_t tensor(0.6039, dtype=torch.float64)
19 gae_duplicate tensor(0.4028, dtype=torch.float64) tensor(-11.9361, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3786, dtype=torch.float64) delta_t tensor(0.3183, dtype=torch.float64)
18 gae_duplicate tensor(0.3123, dtype=torch.float64) tensor(-7.4855, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6238, dtype=torch.float64) delta_t tensor(0.5975, dtype=torch.float64)
17 gae_duplicate tensor(0.3002, dtype=torch.float64) tensor(-12.5498, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2842, dtype=torch.float64) delta_t tensor(0.2598, dtype=torch.float64)
16 gae_duplicate tensor(0.2323, dtype=torch.float64) tensor(-6.3854, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6538, dtype=torch.float64) delta_t tensor(0.7092, dtype=torch.float64)
15 gae_duplicate tensor(0.6128, dtype=torch.float64) tensor(-14.6709, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2708, dtype=torch.float64) delta_t tensor(0.2193, dtype=torch.float64)
14 gae_duplicate tensor(0.2026, dtype=torch.float64) tensor(-5.7968, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6491, dtype=torch.float64) delta_t tensor(0.6726, dtype=torch.float64)
13 gae_duplicate tensor(0.4991, dtype=torch.float64) tensor(-13.8830, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2624, dtype=torch.float64) delta_t tensor(0.2047, dtype=torch.float64)
12 gae_duplicate tensor(0.1263, dtype=torch.float64) tensor(-5.4373, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6577, dtype=torch.float64) delta_t tensor(0.6449, dtype=torch.float64)
11 gae_duplicate tensor(0.5641, dtype=torch.float64) tensor(-13.2871, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2442, dtype=torch.float64) delta_t tensor(0.1785, dtype=torch.float64)
10 gae_duplicate tensor(0.0052, dtype=torch.float64) tensor(-4.8581, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6861, dtype=torch.float64) delta_t tensor(0.5973, dtype=torch.float64)
9 gae_duplicate tensor(0.4955, dtype=torch.float64) tensor(-12.3197, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2229, dtype=torch.float64) delta_t tensor(0.1354, dtype=torch.float64)
8 gae_duplicate tensor(-0.1209, dtype=torch.float64) tensor(-3.9079, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.6377, dtype=torch.float64) delta_t tensor(0.5943, dtype=torch.float64)
7 gae_duplicate tensor(0.5100, dtype=torch.float64) tensor(-12.1555, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1790, dtype=torch.float64) delta_t tensor(0.1416, dtype=torch.float64)
6 gae_duplicate tensor(-0.0884, dtype=torch.float64) tensor(-4.0153, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6655, dtype=torch.float64) delta_t tensor(-1.5332, dtype=torch.float64)
5 gae_duplicate tensor(-2.3193, dtype=torch.float64) tensor(29.8441, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7915, dtype=torch.float64) delta_t tensor(-0.7002, dtype=torch.float64)
4 gae_duplicate tensor(-3.4558, dtype=torch.float64) tensor(16.8557, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1373, dtype=torch.float64) delta_t tensor(0.1511, dtype=torch.float64)
3 gae_duplicate tensor(-0.5426, dtype=torch.float64) tensor(-1.3123, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5646, dtype=torch.float64) delta_t tensor(-0.7369, dtype=torch.float64)
2 gae_duplicate tensor(-1.5170, dtype=torch.float64) tensor(14.4620, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3621.19873046875
value loss:88.04917907714844
entropies:355.9456787109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.058868885040283 seconds
19 rew tensor(0.4852, dtype=torch.float64) delta_t tensor(0.3722, dtype=torch.float64)
19 gae_duplicate tensor(0.1575, dtype=torch.float64) tensor(-7.3224, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5142, dtype=torch.float64) delta_t tensor(0.4434, dtype=torch.float64)
18 gae_duplicate tensor(0.2701, dtype=torch.float64) tensor(-9.5036, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4403, dtype=torch.float64) delta_t tensor(0.3592, dtype=torch.float64)
17 gae_duplicate tensor(0.1603, dtype=torch.float64) tensor(-8.0492, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4991, dtype=torch.float64) delta_t tensor(0.5062, dtype=torch.float64)
16 gae_duplicate tensor(0.2570, dtype=torch.float64) tensor(-10.8034, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4462, dtype=torch.float64) delta_t tensor(0.4207, dtype=torch.float64)
15 gae_duplicate tensor(0.1001, dtype=torch.float64) tensor(-9.3709, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3541, dtype=torch.float64) delta_t tensor(0.4024, dtype=torch.float64)
14 gae_duplicate tensor(0.2374, dtype=torch.float64) tensor(-8.8884, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4916, dtype=torch.float64) delta_t tensor(0.5403, dtype=torch.float64)
13 gae_duplicate tensor(0.1515, dtype=torch.float64) tensor(-11.6056, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2621, dtype=torch.float64) delta_t tensor(0.2266, dtype=torch.float64)
12 gae_duplicate tensor(-0.0099, dtype=torch.float64) tensor(-5.6663, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5169, dtype=torch.float64) delta_t tensor(0.4725, dtype=torch.float64)
11 gae_duplicate tensor(0.1351, dtype=torch.float64) tensor(-9.8902, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2684, dtype=torch.float64) delta_t tensor(0.2119, dtype=torch.float64)
10 gae_duplicate tensor(-0.0427, dtype=torch.float64) tensor(-5.1970, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4650, dtype=torch.float64) delta_t tensor(0.3689, dtype=torch.float64)
9 gae_duplicate tensor(0.0790, dtype=torch.float64) tensor(-7.8183, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1431, dtype=torch.float64) delta_t tensor(0.0559, dtype=torch.float64)
8 gae_duplicate tensor(-0.2484, dtype=torch.float64) tensor(-1.9057, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4480, dtype=torch.float64) delta_t tensor(0.4011, dtype=torch.float64)
7 gae_duplicate tensor(-0.2142, dtype=torch.float64) tensor(-8.1479, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0616, dtype=torch.float64) delta_t tensor(-0.1748, dtype=torch.float64)
6 gae_duplicate tensor(-0.6734, dtype=torch.float64) tensor(2.6926, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3393, dtype=torch.float64) delta_t tensor(-1.2522, dtype=torch.float64)
5 gae_duplicate tensor(-1.6637, dtype=torch.float64) tensor(24.9462, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.9464, dtype=torch.float64) delta_t tensor(-4.9477, dtype=torch.float64)
4 gae_duplicate tensor(-7.5258, dtype=torch.float64) tensor(100.4927, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1541, dtype=torch.float64) delta_t tensor(-0.2756, dtype=torch.float64)
3 gae_duplicate tensor(-1.2146, dtype=torch.float64) tensor(15.4472, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1637, dtype=torch.float64) delta_t tensor(-0.3231, dtype=torch.float64)
2 gae_duplicate tensor(-0.7196, dtype=torch.float64) tensor(7.9758, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2654.925048828125
value loss:324.5240783691406
entropies:355.92388916015625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3956.8850)
ToM Target loss= tensor(2585.8105)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.4293999671936035 seconds
19 rew tensor(0.5457, dtype=torch.float64) delta_t tensor(0.4972, dtype=torch.float64)
19 gae_duplicate tensor(0.1924, dtype=torch.float64) tensor(-9.9096, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3299, dtype=torch.float64) delta_t tensor(0.2328, dtype=torch.float64)
18 gae_duplicate tensor(0.1857, dtype=torch.float64) tensor(-5.5881, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5764, dtype=torch.float64) delta_t tensor(0.4843, dtype=torch.float64)
17 gae_duplicate tensor(0.3976, dtype=torch.float64) tensor(-10.0547, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2685, dtype=torch.float64) delta_t tensor(0.1807, dtype=torch.float64)
16 gae_duplicate tensor(0.0100, dtype=torch.float64) tensor(-4.5824, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5804, dtype=torch.float64) delta_t tensor(0.5676, dtype=torch.float64)
15 gae_duplicate tensor(0.5117, dtype=torch.float64) tensor(-11.5549, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2591, dtype=torch.float64) delta_t tensor(0.1613, dtype=torch.float64)
14 gae_duplicate tensor(0.1351, dtype=torch.float64) tensor(-4.3016, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5905, dtype=torch.float64) delta_t tensor(0.6723, dtype=torch.float64)
13 gae_duplicate tensor(0.5205, dtype=torch.float64) tensor(-13.7628, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2457, dtype=torch.float64) delta_t tensor(0.2303, dtype=torch.float64)
12 gae_duplicate tensor(0.1052, dtype=torch.float64) tensor(-5.8769, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5951, dtype=torch.float64) delta_t tensor(0.5642, dtype=torch.float64)
11 gae_duplicate tensor(0.5011, dtype=torch.float64) tensor(-11.7605, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2775, dtype=torch.float64) delta_t tensor(0.2182, dtype=torch.float64)
10 gae_duplicate tensor(0.0630, dtype=torch.float64) tensor(-5.5041, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6054, dtype=torch.float64) delta_t tensor(0.4824, dtype=torch.float64)
9 gae_duplicate tensor(0.4212, dtype=torch.float64) tensor(-10.0506, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2365, dtype=torch.float64) delta_t tensor(0.1287, dtype=torch.float64)
8 gae_duplicate tensor(-0.0326, dtype=torch.float64) tensor(-3.5558, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5618, dtype=torch.float64) delta_t tensor(0.4959, dtype=torch.float64)
7 gae_duplicate tensor(0.4354, dtype=torch.float64) tensor(-10.1230, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1954, dtype=torch.float64) delta_t tensor(0.1213, dtype=torch.float64)
6 gae_duplicate tensor(-0.0477, dtype=torch.float64) tensor(-3.4704, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6241, dtype=torch.float64) delta_t tensor(-1.4847, dtype=torch.float64)
5 gae_duplicate tensor(-2.3204, dtype=torch.float64) tensor(28.8797, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1036, dtype=torch.float64) delta_t tensor(-2.0076, dtype=torch.float64)
4 gae_duplicate tensor(-5.5003, dtype=torch.float64) tensor(42.6402, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0722, dtype=torch.float64) delta_t tensor(-0.0997, dtype=torch.float64)
3 gae_duplicate tensor(-0.8729, dtype=torch.float64) tensor(6.4046, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3524, dtype=torch.float64) delta_t tensor(-0.5398, dtype=torch.float64)
2 gae_duplicate tensor(-0.7816, dtype=torch.float64) tensor(11.4493, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1022.8865356445312
value loss:125.82974243164062
entropies:355.82269287109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.086346864700317 seconds
19 rew tensor(0.5124, dtype=torch.float64) delta_t tensor(0.3666, dtype=torch.float64)
19 gae_duplicate tensor(0.2250, dtype=torch.float64) tensor(-7.1752, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5143, dtype=torch.float64) delta_t tensor(0.4304, dtype=torch.float64)
18 gae_duplicate tensor(0.1788, dtype=torch.float64) tensor(-9.2060, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5103, dtype=torch.float64) delta_t tensor(0.4176, dtype=torch.float64)
17 gae_duplicate tensor(0.2559, dtype=torch.float64) tensor(-9.2025, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4525, dtype=torch.float64) delta_t tensor(0.3413, dtype=torch.float64)
16 gae_duplicate tensor(0.0058, dtype=torch.float64) tensor(-7.5877, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4878, dtype=torch.float64) delta_t tensor(0.5267, dtype=torch.float64)
15 gae_duplicate tensor(0.2447, dtype=torch.float64) tensor(-11.4115, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2931, dtype=torch.float64) delta_t tensor(0.3606, dtype=torch.float64)
14 gae_duplicate tensor(0.0755, dtype=torch.float64) tensor(-8.3454, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5249, dtype=torch.float64) delta_t tensor(0.5824, dtype=torch.float64)
13 gae_duplicate tensor(0.3553, dtype=torch.float64) tensor(-12.3827, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2350, dtype=torch.float64) delta_t tensor(0.2711, dtype=torch.float64)
12 gae_duplicate tensor(-0.0892, dtype=torch.float64) tensor(-6.5781, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5444, dtype=torch.float64) delta_t tensor(0.5453, dtype=torch.float64)
11 gae_duplicate tensor(0.2895, dtype=torch.float64) tensor(-11.4353, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2253, dtype=torch.float64) delta_t tensor(0.1914, dtype=torch.float64)
10 gae_duplicate tensor(-0.2990, dtype=torch.float64) tensor(-4.9505, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4921, dtype=torch.float64) delta_t tensor(0.4462, dtype=torch.float64)
9 gae_duplicate tensor(0.2444, dtype=torch.float64) tensor(-9.2837, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0640, dtype=torch.float64) delta_t tensor(0.0252, dtype=torch.float64)
8 gae_duplicate tensor(-0.2636, dtype=torch.float64) tensor(-1.3523, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3166, dtype=torch.float64) delta_t tensor(0.3292, dtype=torch.float64)
7 gae_duplicate tensor(0.0230, dtype=torch.float64) tensor(-6.5500, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0837, dtype=torch.float64) delta_t tensor(-0.1285, dtype=torch.float64)
6 gae_duplicate tensor(-0.5811, dtype=torch.float64) tensor(1.9345, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2982, dtype=torch.float64) delta_t tensor(-1.2760, dtype=torch.float64)
5 gae_duplicate tensor(-2.0581, dtype=torch.float64) tensor(26.2363, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0728, dtype=torch.float64) delta_t tensor(-3.0951, dtype=torch.float64)
4 gae_duplicate tensor(-5.8506, dtype=torch.float64) tensor(63.7999, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1923, dtype=torch.float64) delta_t tensor(-0.3357, dtype=torch.float64)
3 gae_duplicate tensor(-0.9039, dtype=torch.float64) tensor(13.2776, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1655, dtype=torch.float64) delta_t tensor(-0.2594, dtype=torch.float64)
2 gae_duplicate tensor(-0.7189, dtype=torch.float64) tensor(6.4655, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-433.654052734375
value loss:186.9871826171875
entropies:355.5542907714844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.167031764984131 seconds
19 rew tensor(0.5795, dtype=torch.float64) delta_t tensor(0.5381, dtype=torch.float64)
19 gae_duplicate tensor(0.4232, dtype=torch.float64) tensor(-10.4829, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3385, dtype=torch.float64) delta_t tensor(0.2299, dtype=torch.float64)
18 gae_duplicate tensor(0.1209, dtype=torch.float64) tensor(-5.7915, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5824, dtype=torch.float64) delta_t tensor(0.4823, dtype=torch.float64)
17 gae_duplicate tensor(0.4527, dtype=torch.float64) tensor(-10.3020, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3358, dtype=torch.float64) delta_t tensor(0.2349, dtype=torch.float64)
16 gae_duplicate tensor(0.1131, dtype=torch.float64) tensor(-5.5900, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5785, dtype=torch.float64) delta_t tensor(0.5015, dtype=torch.float64)
15 gae_duplicate tensor(0.4442, dtype=torch.float64) tensor(-10.6875, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3392, dtype=torch.float64) delta_t tensor(0.2396, dtype=torch.float64)
14 gae_duplicate tensor(0.1703, dtype=torch.float64) tensor(-5.8062, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5732, dtype=torch.float64) delta_t tensor(0.5443, dtype=torch.float64)
13 gae_duplicate tensor(0.5180, dtype=torch.float64) tensor(-11.5264, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3265, dtype=torch.float64) delta_t tensor(0.2871, dtype=torch.float64)
12 gae_duplicate tensor(0.2243, dtype=torch.float64) tensor(-6.9719, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5743, dtype=torch.float64) delta_t tensor(0.5420, dtype=torch.float64)
11 gae_duplicate tensor(0.4651, dtype=torch.float64) tensor(-11.2354, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3465, dtype=torch.float64) delta_t tensor(0.2925, dtype=torch.float64)
10 gae_duplicate tensor(0.2153, dtype=torch.float64) tensor(-6.9296, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5943, dtype=torch.float64) delta_t tensor(0.4632, dtype=torch.float64)
9 gae_duplicate tensor(0.3797, dtype=torch.float64) tensor(-9.8005, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3124, dtype=torch.float64) delta_t tensor(0.2168, dtype=torch.float64)
8 gae_duplicate tensor(0.0743, dtype=torch.float64) tensor(-5.2779, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5501, dtype=torch.float64) delta_t tensor(0.4557, dtype=torch.float64)
7 gae_duplicate tensor(0.3823, dtype=torch.float64) tensor(-9.7304, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2695, dtype=torch.float64) delta_t tensor(0.1940, dtype=torch.float64)
6 gae_duplicate tensor(0.0927, dtype=torch.float64) tensor(-4.6116, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9441, dtype=torch.float64) delta_t tensor(-0.8285, dtype=torch.float64)
5 gae_duplicate tensor(-1.8390, dtype=torch.float64) tensor(15.9753, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1195, dtype=torch.float64) delta_t tensor(-2.0496, dtype=torch.float64)
4 gae_duplicate tensor(-7.1201, dtype=torch.float64) tensor(41.1688, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0355, dtype=torch.float64) delta_t tensor(-0.0055, dtype=torch.float64)
3 gae_duplicate tensor(-1.1540, dtype=torch.float64) tensor(4.5462, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3968, dtype=torch.float64) delta_t tensor(-0.5858, dtype=torch.float64)
2 gae_duplicate tensor(-0.7707, dtype=torch.float64) tensor(11.9933, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2121.3876953125
value loss:139.57177734375
entropies:355.0740051269531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.076912879943848 seconds
19 rew tensor(0.5298, dtype=torch.float64) delta_t tensor(0.4497, dtype=torch.float64)
19 gae_duplicate tensor(0.2001, dtype=torch.float64) tensor(-8.8525, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3870, dtype=torch.float64) delta_t tensor(0.2722, dtype=torch.float64)
18 gae_duplicate tensor(0.1641, dtype=torch.float64) tensor(-6.2376, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5809, dtype=torch.float64) delta_t tensor(0.4802, dtype=torch.float64)
17 gae_duplicate tensor(0.4070, dtype=torch.float64) tensor(-10.1301, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3361, dtype=torch.float64) delta_t tensor(0.2504, dtype=torch.float64)
16 gae_duplicate tensor(-0.1549, dtype=torch.float64) tensor(-5.9005, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5418, dtype=torch.float64) delta_t tensor(0.4649, dtype=torch.float64)
15 gae_duplicate tensor(0.2723, dtype=torch.float64) tensor(-10.0939, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2944, dtype=torch.float64) delta_t tensor(0.2523, dtype=torch.float64)
14 gae_duplicate tensor(-0.1658, dtype=torch.float64) tensor(-6.0896, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5539, dtype=torch.float64) delta_t tensor(0.6210, dtype=torch.float64)
13 gae_duplicate tensor(0.5437, dtype=torch.float64) tensor(-12.6085, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1701, dtype=torch.float64) delta_t tensor(0.1258, dtype=torch.float64)
12 gae_duplicate tensor(-0.0819, dtype=torch.float64) tensor(-3.7460, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5792, dtype=torch.float64) delta_t tensor(0.5142, dtype=torch.float64)
11 gae_duplicate tensor(0.4737, dtype=torch.float64) tensor(-10.5227, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1885, dtype=torch.float64) delta_t tensor(0.1111, dtype=torch.float64)
10 gae_duplicate tensor(-0.0580, dtype=torch.float64) tensor(-3.1116, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5810, dtype=torch.float64) delta_t tensor(0.4308, dtype=torch.float64)
9 gae_duplicate tensor(0.3790, dtype=torch.float64) tensor(-8.5566, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1463, dtype=torch.float64) delta_t tensor(-0.0017, dtype=torch.float64)
8 gae_duplicate tensor(-0.2461, dtype=torch.float64) tensor(-0.7934, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4506, dtype=torch.float64) delta_t tensor(0.3619, dtype=torch.float64)
7 gae_duplicate tensor(-0.0379, dtype=torch.float64) tensor(-7.3475, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0723, dtype=torch.float64) delta_t tensor(-0.0794, dtype=torch.float64)
6 gae_duplicate tensor(-0.3936, dtype=torch.float64) tensor(0.8610, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5802, dtype=torch.float64) delta_t tensor(-1.4637, dtype=torch.float64)
5 gae_duplicate tensor(-1.8978, dtype=torch.float64) tensor(29.5057, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.1901, dtype=torch.float64) delta_t tensor(-4.1816, dtype=torch.float64)
4 gae_duplicate tensor(-6.3818, dtype=torch.float64) tensor(86.9716, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2178, dtype=torch.float64) delta_t tensor(-0.3392, dtype=torch.float64)
3 gae_duplicate tensor(-1.0711, dtype=torch.float64) tensor(15.5915, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2263, dtype=torch.float64) delta_t tensor(-0.4008, dtype=torch.float64)
2 gae_duplicate tensor(-0.6667, dtype=torch.float64) tensor(8.9275, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2680.5966796875
value loss:266.4042053222656
entropies:354.7314147949219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.323936939239502 seconds
19 rew tensor(0.5586, dtype=torch.float64) delta_t tensor(0.4158, dtype=torch.float64)
19 gae_duplicate tensor(0.2376, dtype=torch.float64) tensor(-8.2999, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4421, dtype=torch.float64) delta_t tensor(0.2821, dtype=torch.float64)
18 gae_duplicate tensor(0.2013, dtype=torch.float64) tensor(-6.5041, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4780, dtype=torch.float64) delta_t tensor(0.3628, dtype=torch.float64)
17 gae_duplicate tensor(0.2084, dtype=torch.float64) tensor(-7.7030, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2993, dtype=torch.float64) delta_t tensor(0.2949, dtype=torch.float64)
16 gae_duplicate tensor(0.2088, dtype=torch.float64) tensor(-6.6416, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5618, dtype=torch.float64) delta_t tensor(0.6446, dtype=torch.float64)
15 gae_duplicate tensor(0.5438, dtype=torch.float64) tensor(-13.3878, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2197, dtype=torch.float64) delta_t tensor(0.1620, dtype=torch.float64)
14 gae_duplicate tensor(0.0469, dtype=torch.float64) tensor(-4.4618, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5689, dtype=torch.float64) delta_t tensor(0.5083, dtype=torch.float64)
13 gae_duplicate tensor(0.3916, dtype=torch.float64) tensor(-10.3345, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0247, dtype=torch.float64) delta_t tensor(-0.0194, dtype=torch.float64)
12 gae_duplicate tensor(-0.7690, dtype=torch.float64) tensor(-0.5204, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5787, dtype=torch.float64) delta_t tensor(0.4972, dtype=torch.float64)
11 gae_duplicate tensor(0.3759, dtype=torch.float64) tensor(-9.8686, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1974, dtype=torch.float64) delta_t tensor(0.1077, dtype=torch.float64)
10 gae_duplicate tensor(-0.0273, dtype=torch.float64) tensor(-3.1295, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5478, dtype=torch.float64) delta_t tensor(0.3693, dtype=torch.float64)
9 gae_duplicate tensor(0.1324, dtype=torch.float64) tensor(-7.5430, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1123, dtype=torch.float64) delta_t tensor(-0.0383, dtype=torch.float64)
8 gae_duplicate tensor(-0.1752, dtype=torch.float64) tensor(0.0587, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5432, dtype=torch.float64) delta_t tensor(0.4411, dtype=torch.float64)
7 gae_duplicate tensor(0.3896, dtype=torch.float64) tensor(-8.9305, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0275, dtype=torch.float64) delta_t tensor(-0.1267, dtype=torch.float64)
6 gae_duplicate tensor(-0.4609, dtype=torch.float64) tensor(1.8737, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7868, dtype=torch.float64) delta_t tensor(-1.6639, dtype=torch.float64)
5 gae_duplicate tensor(-2.5891, dtype=torch.float64) tensor(32.0697, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7414, dtype=torch.float64) delta_t tensor(-1.7064, dtype=torch.float64)
4 gae_duplicate tensor(-4.0404, dtype=torch.float64) tensor(38.2169, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1651, dtype=torch.float64) delta_t tensor(-0.2593, dtype=torch.float64)
3 gae_duplicate tensor(-0.7281, dtype=torch.float64) tensor(8.6706, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2810, dtype=torch.float64) delta_t tensor(-0.4876, dtype=torch.float64)
2 gae_duplicate tensor(-0.7953, dtype=torch.float64) tensor(10.4580, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-312.880615234375
value loss:103.83099365234375
entropies:354.2459411621094
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3952.7043)
ToM Target loss= tensor(2577.8591)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.806965112686157 seconds
19 rew tensor(0.5022, dtype=torch.float64) delta_t tensor(0.3851, dtype=torch.float64)
19 gae_duplicate tensor(0.1428, dtype=torch.float64) tensor(-7.5984, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3965, dtype=torch.float64) delta_t tensor(0.2575, dtype=torch.float64)
18 gae_duplicate tensor(0.1166, dtype=torch.float64) tensor(-5.6982, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5411, dtype=torch.float64) delta_t tensor(0.4650, dtype=torch.float64)
17 gae_duplicate tensor(0.2084, dtype=torch.float64) tensor(-9.5658, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3154, dtype=torch.float64) delta_t tensor(0.2903, dtype=torch.float64)
16 gae_duplicate tensor(-0.0803, dtype=torch.float64) tensor(-6.4705, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5422, dtype=torch.float64) delta_t tensor(0.5359, dtype=torch.float64)
15 gae_duplicate tensor(0.4160, dtype=torch.float64) tensor(-11.1788, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2559, dtype=torch.float64) delta_t tensor(0.1887, dtype=torch.float64)
14 gae_duplicate tensor(0.0882, dtype=torch.float64) tensor(-4.7780, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5627, dtype=torch.float64) delta_t tensor(0.5178, dtype=torch.float64)
13 gae_duplicate tensor(0.2862, dtype=torch.float64) tensor(-10.5425, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2205, dtype=torch.float64) delta_t tensor(0.1603, dtype=torch.float64)
12 gae_duplicate tensor(0.0418, dtype=torch.float64) tensor(-4.1019, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5803, dtype=torch.float64) delta_t tensor(0.5482, dtype=torch.float64)
11 gae_duplicate tensor(0.4822, dtype=torch.float64) tensor(-11.2705, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2080, dtype=torch.float64) delta_t tensor(0.1083, dtype=torch.float64)
10 gae_duplicate tensor(-0.0181, dtype=torch.float64) tensor(-3.2523, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5889, dtype=torch.float64) delta_t tensor(0.4480, dtype=torch.float64)
9 gae_duplicate tensor(0.3820, dtype=torch.float64) tensor(-8.9710, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1728, dtype=torch.float64) delta_t tensor(0.0374, dtype=torch.float64)
8 gae_duplicate tensor(-0.1552, dtype=torch.float64) tensor(-1.6726, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4791, dtype=torch.float64) delta_t tensor(0.3739, dtype=torch.float64)
7 gae_duplicate tensor(-0.0548, dtype=torch.float64) tensor(-7.3074, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0643, dtype=torch.float64) delta_t tensor(-0.0398, dtype=torch.float64)
6 gae_duplicate tensor(-0.4406, dtype=torch.float64) tensor(-0.1223, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1822, dtype=torch.float64) delta_t tensor(-2.0785, dtype=torch.float64)
5 gae_duplicate tensor(-2.9904, dtype=torch.float64) tensor(40.7831, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0417, dtype=torch.float64) delta_t tensor(-3.0025, dtype=torch.float64)
4 gae_duplicate tensor(-6.3350, dtype=torch.float64) tensor(63.6822, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1272, dtype=torch.float64) delta_t tensor(-0.2004, dtype=torch.float64)
3 gae_duplicate tensor(-0.9645, dtype=torch.float64) tensor(9.8266, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2863, dtype=torch.float64) delta_t tensor(-0.4830, dtype=torch.float64)
2 gae_duplicate tensor(-0.7389, dtype=torch.float64) tensor(10.6128, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1843.6927490234375
value loss:208.89132690429688
entropies:353.606201171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.086709022521973 seconds
19 rew tensor(0.5720, dtype=torch.float64) delta_t tensor(0.4611, dtype=torch.float64)
19 gae_duplicate tensor(0.2876, dtype=torch.float64) tensor(-9.0523, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3625, dtype=torch.float64) delta_t tensor(0.2212, dtype=torch.float64)
18 gae_duplicate tensor(0.1629, dtype=torch.float64) tensor(-5.3213, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5316, dtype=torch.float64) delta_t tensor(0.4021, dtype=torch.float64)
17 gae_duplicate tensor(0.0919, dtype=torch.float64) tensor(-8.5968, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3291, dtype=torch.float64) delta_t tensor(0.2460, dtype=torch.float64)
16 gae_duplicate tensor(0.1108, dtype=torch.float64) tensor(-5.6785, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5682, dtype=torch.float64) delta_t tensor(0.5110, dtype=torch.float64)
15 gae_duplicate tensor(0.4610, dtype=torch.float64) tensor(-10.9193, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2901, dtype=torch.float64) delta_t tensor(0.2493, dtype=torch.float64)
14 gae_duplicate tensor(0.0784, dtype=torch.float64) tensor(-5.9115, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5674, dtype=torch.float64) delta_t tensor(0.5368, dtype=torch.float64)
13 gae_duplicate tensor(0.4587, dtype=torch.float64) tensor(-10.7767, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2843, dtype=torch.float64) delta_t tensor(0.2168, dtype=torch.float64)
12 gae_duplicate tensor(0.0533, dtype=torch.float64) tensor(-5.5892, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5778, dtype=torch.float64) delta_t tensor(0.5435, dtype=torch.float64)
11 gae_duplicate tensor(0.4289, dtype=torch.float64) tensor(-11.6297, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2889, dtype=torch.float64) delta_t tensor(0.2358, dtype=torch.float64)
10 gae_duplicate tensor(-0.0062, dtype=torch.float64) tensor(-5.8884, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5880, dtype=torch.float64) delta_t tensor(0.4266, dtype=torch.float64)
9 gae_duplicate tensor(0.3157, dtype=torch.float64) tensor(-9.0654, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2518, dtype=torch.float64) delta_t tensor(0.1059, dtype=torch.float64)
8 gae_duplicate tensor(-0.1476, dtype=torch.float64) tensor(-2.8745, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5431, dtype=torch.float64) delta_t tensor(0.4478, dtype=torch.float64)
7 gae_duplicate tensor(0.3391, dtype=torch.float64) tensor(-9.1542, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2081, dtype=torch.float64) delta_t tensor(0.0881, dtype=torch.float64)
6 gae_duplicate tensor(-0.1471, dtype=torch.float64) tensor(-2.5733, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7840, dtype=torch.float64) delta_t tensor(-1.6491, dtype=torch.float64)
5 gae_duplicate tensor(-3.8959, dtype=torch.float64) tensor(31.5547, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9390, dtype=torch.float64) delta_t tensor(-2.8908, dtype=torch.float64)
4 gae_duplicate tensor(-5.7006, dtype=torch.float64) tensor(60.6548, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1753, dtype=torch.float64) delta_t tensor(-0.2727, dtype=torch.float64)
3 gae_duplicate tensor(-1.0268, dtype=torch.float64) tensor(10.4880, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2843, dtype=torch.float64) delta_t tensor(-0.4531, dtype=torch.float64)
2 gae_duplicate tensor(-0.6672, dtype=torch.float64) tensor(9.9128, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-612.5217895507812
value loss:181.65272521972656
entropies:352.734130859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.868181943893433 seconds
19 rew tensor(0.5344, dtype=torch.float64) delta_t tensor(0.3697, dtype=torch.float64)
19 gae_duplicate tensor(0.1463, dtype=torch.float64) tensor(-7.4409, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4306, dtype=torch.float64) delta_t tensor(0.2633, dtype=torch.float64)
18 gae_duplicate tensor(0.1245, dtype=torch.float64) tensor(-6.2719, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5281, dtype=torch.float64) delta_t tensor(0.3613, dtype=torch.float64)
17 gae_duplicate tensor(0.2020, dtype=torch.float64) tensor(-7.7707, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3909, dtype=torch.float64) delta_t tensor(0.2529, dtype=torch.float64)
16 gae_duplicate tensor(0.1141, dtype=torch.float64) tensor(-5.4851, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4985, dtype=torch.float64) delta_t tensor(0.4205, dtype=torch.float64)
15 gae_duplicate tensor(0.2302, dtype=torch.float64) tensor(-8.4465, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2769, dtype=torch.float64) delta_t tensor(0.2428, dtype=torch.float64)
14 gae_duplicate tensor(0.1285, dtype=torch.float64) tensor(-5.4561, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4066, dtype=torch.float64) delta_t tensor(0.4922, dtype=torch.float64)
13 gae_duplicate tensor(-0.1505, dtype=torch.float64) tensor(-10.3966, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2031, dtype=torch.float64) delta_t tensor(0.1633, dtype=torch.float64)
12 gae_duplicate tensor(0.1357, dtype=torch.float64) tensor(-4.1620, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5825, dtype=torch.float64) delta_t tensor(0.5265, dtype=torch.float64)
11 gae_duplicate tensor(0.4758, dtype=torch.float64) tensor(-10.6184, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2211, dtype=torch.float64) delta_t tensor(0.1725, dtype=torch.float64)
10 gae_duplicate tensor(0.0765, dtype=torch.float64) tensor(-4.4732, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5838, dtype=torch.float64) delta_t tensor(0.4092, dtype=torch.float64)
9 gae_duplicate tensor(0.3644, dtype=torch.float64) tensor(-8.3854, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1772, dtype=torch.float64) delta_t tensor(0.0244, dtype=torch.float64)
8 gae_duplicate tensor(-0.0665, dtype=torch.float64) tensor(-1.3595, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4719, dtype=torch.float64) delta_t tensor(0.3546, dtype=torch.float64)
7 gae_duplicate tensor(0.1334, dtype=torch.float64) tensor(-6.8892, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0664, dtype=torch.float64) delta_t tensor(-0.0906, dtype=torch.float64)
6 gae_duplicate tensor(-0.5551, dtype=torch.float64) tensor(0.8982, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5086, dtype=torch.float64) delta_t tensor(-1.3994, dtype=torch.float64)
5 gae_duplicate tensor(-2.3308, dtype=torch.float64) tensor(26.3694, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8989, dtype=torch.float64) delta_t tensor(-2.8877, dtype=torch.float64)
4 gae_duplicate tensor(-6.9762, dtype=torch.float64) tensor(66.1927, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1108, dtype=torch.float64) delta_t tensor(-0.2252, dtype=torch.float64)
3 gae_duplicate tensor(-0.8667, dtype=torch.float64) tensor(10.7638, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2325, dtype=torch.float64) delta_t tensor(-0.3897, dtype=torch.float64)
2 gae_duplicate tensor(-0.6420, dtype=torch.float64) tensor(8.7498, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1489.2869873046875
value loss:184.50184631347656
entropies:352.1824645996094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.13277792930603 seconds
19 rew tensor(0.5662, dtype=torch.float64) delta_t tensor(0.4194, dtype=torch.float64)
19 gae_duplicate tensor(0.3112, dtype=torch.float64) tensor(-7.7581, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3154, dtype=torch.float64) delta_t tensor(0.1441, dtype=torch.float64)
18 gae_duplicate tensor(0.0142, dtype=torch.float64) tensor(-3.6077, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5522, dtype=torch.float64) delta_t tensor(0.3865, dtype=torch.float64)
17 gae_duplicate tensor(0.2814, dtype=torch.float64) tensor(-7.6923, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2940, dtype=torch.float64) delta_t tensor(0.1858, dtype=torch.float64)
16 gae_duplicate tensor(0.0109, dtype=torch.float64) tensor(-4.2694, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5525, dtype=torch.float64) delta_t tensor(0.5486, dtype=torch.float64)
15 gae_duplicate tensor(0.3858, dtype=torch.float64) tensor(-11.2128, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2109, dtype=torch.float64) delta_t tensor(0.1347, dtype=torch.float64)
14 gae_duplicate tensor(-0.0110, dtype=torch.float64) tensor(-3.7656, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5639, dtype=torch.float64) delta_t tensor(0.5643, dtype=torch.float64)
13 gae_duplicate tensor(0.4575, dtype=torch.float64) tensor(-11.1877, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2138, dtype=torch.float64) delta_t tensor(0.1637, dtype=torch.float64)
12 gae_duplicate tensor(-0.0069, dtype=torch.float64) tensor(-4.3045, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5715, dtype=torch.float64) delta_t tensor(0.4622, dtype=torch.float64)
11 gae_duplicate tensor(0.4334, dtype=torch.float64) tensor(-9.6722, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2308, dtype=torch.float64) delta_t tensor(0.1244, dtype=torch.float64)
10 gae_duplicate tensor(-0.1529, dtype=torch.float64) tensor(-3.6051, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5804, dtype=torch.float64) delta_t tensor(0.3799, dtype=torch.float64)
9 gae_duplicate tensor(0.3172, dtype=torch.float64) tensor(-7.7229, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1873, dtype=torch.float64) delta_t tensor(-0.0095, dtype=torch.float64)
8 gae_duplicate tensor(-0.2037, dtype=torch.float64) tensor(-0.5556, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5357, dtype=torch.float64) delta_t tensor(0.3990, dtype=torch.float64)
7 gae_duplicate tensor(0.2992, dtype=torch.float64) tensor(-7.7150, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1437, dtype=torch.float64) delta_t tensor(-0.0185, dtype=torch.float64)
6 gae_duplicate tensor(-0.2420, dtype=torch.float64) tensor(-0.5368, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6325, dtype=torch.float64) delta_t tensor(-1.5096, dtype=torch.float64)
5 gae_duplicate tensor(-2.3648, dtype=torch.float64) tensor(30.9256, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5846, dtype=torch.float64) delta_t tensor(-3.5375, dtype=torch.float64)
4 gae_duplicate tensor(-7.3849, dtype=torch.float64) tensor(74.0012, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0936, dtype=torch.float64) delta_t tensor(-0.1666, dtype=torch.float64)
3 gae_duplicate tensor(-0.9075, dtype=torch.float64) tensor(10.8205, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2832, dtype=torch.float64) delta_t tensor(-0.4692, dtype=torch.float64)
2 gae_duplicate tensor(-0.7964, dtype=torch.float64) tensor(10.0715, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2374.45068359375
value loss:217.8494873046875
entropies:351.67864990234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.3620219230651855 seconds
19 rew tensor(0.4893, dtype=torch.float64) delta_t tensor(0.3171, dtype=torch.float64)
19 gae_duplicate tensor(0.1547, dtype=torch.float64) tensor(-6.2016, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4346, dtype=torch.float64) delta_t tensor(0.2814, dtype=torch.float64)
18 gae_duplicate tensor(0.1546, dtype=torch.float64) tensor(-6.1073, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4980, dtype=torch.float64) delta_t tensor(0.3817, dtype=torch.float64)
17 gae_duplicate tensor(0.2020, dtype=torch.float64) tensor(-7.9596, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3225, dtype=torch.float64) delta_t tensor(0.2703, dtype=torch.float64)
16 gae_duplicate tensor(-0.0026, dtype=torch.float64) tensor(-6.1806, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5491, dtype=torch.float64) delta_t tensor(0.5808, dtype=torch.float64)
15 gae_duplicate tensor(0.3609, dtype=torch.float64) tensor(-11.4429, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2340, dtype=torch.float64) delta_t tensor(0.1395, dtype=torch.float64)
14 gae_duplicate tensor(-0.0106, dtype=torch.float64) tensor(-3.8023, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5528, dtype=torch.float64) delta_t tensor(0.4595, dtype=torch.float64)
13 gae_duplicate tensor(0.2134, dtype=torch.float64) tensor(-9.1786, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2068, dtype=torch.float64) delta_t tensor(0.1688, dtype=torch.float64)
12 gae_duplicate tensor(0.0395, dtype=torch.float64) tensor(-4.1301, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5678, dtype=torch.float64) delta_t tensor(0.4941, dtype=torch.float64)
11 gae_duplicate tensor(0.4525, dtype=torch.float64) tensor(-9.7621, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1949, dtype=torch.float64) delta_t tensor(0.1099, dtype=torch.float64)
10 gae_duplicate tensor(-0.0198, dtype=torch.float64) tensor(-3.0791, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5428, dtype=torch.float64) delta_t tensor(0.3545, dtype=torch.float64)
9 gae_duplicate tensor(0.1029, dtype=torch.float64) tensor(-6.9349, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1098, dtype=torch.float64) delta_t tensor(-0.0794, dtype=torch.float64)
8 gae_duplicate tensor(-0.1952, dtype=torch.float64) tensor(0.8433, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5385, dtype=torch.float64) delta_t tensor(0.4072, dtype=torch.float64)
7 gae_duplicate tensor(0.3196, dtype=torch.float64) tensor(-7.4132, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0250, dtype=torch.float64) delta_t tensor(-0.1113, dtype=torch.float64)
6 gae_duplicate tensor(-0.2877, dtype=torch.float64) tensor(1.1749, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7802, dtype=torch.float64) delta_t tensor(-1.6458, dtype=torch.float64)
5 gae_duplicate tensor(-2.7099, dtype=torch.float64) tensor(31.8033, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0019, dtype=torch.float64) delta_t tensor(-2.9664, dtype=torch.float64)
4 gae_duplicate tensor(-5.6180, dtype=torch.float64) tensor(60.7949, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2386, dtype=torch.float64) delta_t tensor(-0.3132, dtype=torch.float64)
3 gae_duplicate tensor(-0.8227, dtype=torch.float64) tensor(12.2164, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2625, dtype=torch.float64) delta_t tensor(-0.4442, dtype=torch.float64)
2 gae_duplicate tensor(-0.6640, dtype=torch.float64) tensor(9.7329, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1950.8568115234375
value loss:163.75717163085938
entropies:350.7021484375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3942.5093)
ToM Target loss= tensor(2574.6748)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.8891730308532715 seconds
19 rew tensor(0.5486, dtype=torch.float64) delta_t tensor(0.3890, dtype=torch.float64)
19 gae_duplicate tensor(0.2046, dtype=torch.float64) tensor(-7.2809, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3911, dtype=torch.float64) delta_t tensor(0.1971, dtype=torch.float64)
18 gae_duplicate tensor(0.1218, dtype=torch.float64) tensor(-4.4055, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5292, dtype=torch.float64) delta_t tensor(0.3470, dtype=torch.float64)
17 gae_duplicate tensor(0.1764, dtype=torch.float64) tensor(-7.7058, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3089, dtype=torch.float64) delta_t tensor(0.1952, dtype=torch.float64)
16 gae_duplicate tensor(0.0985, dtype=torch.float64) tensor(-4.4421, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5653, dtype=torch.float64) delta_t tensor(0.5579, dtype=torch.float64)
15 gae_duplicate tensor(0.4209, dtype=torch.float64) tensor(-11.9676, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2090, dtype=torch.float64) delta_t tensor(0.1885, dtype=torch.float64)
14 gae_duplicate tensor(-0.0145, dtype=torch.float64) tensor(-4.4769, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5635, dtype=torch.float64) delta_t tensor(0.5353, dtype=torch.float64)
13 gae_duplicate tensor(0.4142, dtype=torch.float64) tensor(-10.5703, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2282, dtype=torch.float64) delta_t tensor(0.1721, dtype=torch.float64)
12 gae_duplicate tensor(-0.0488, dtype=torch.float64) tensor(-4.6723, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5738, dtype=torch.float64) delta_t tensor(0.4617, dtype=torch.float64)
11 gae_duplicate tensor(0.3287, dtype=torch.float64) tensor(-9.6055, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2376, dtype=torch.float64) delta_t tensor(0.1154, dtype=torch.float64)
10 gae_duplicate tensor(-0.2223, dtype=torch.float64) tensor(-3.1843, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5824, dtype=torch.float64) delta_t tensor(0.3600, dtype=torch.float64)
9 gae_duplicate tensor(0.3163, dtype=torch.float64) tensor(-7.0396, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1938, dtype=torch.float64) delta_t tensor(0.0096, dtype=torch.float64)
8 gae_duplicate tensor(-0.2039, dtype=torch.float64) tensor(-0.8600, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5375, dtype=torch.float64) delta_t tensor(0.3783, dtype=torch.float64)
7 gae_duplicate tensor(0.3409, dtype=torch.float64) tensor(-6.9884, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1498, dtype=torch.float64) delta_t tensor(-0.0290, dtype=torch.float64)
6 gae_duplicate tensor(-0.2519, dtype=torch.float64) tensor(-0.1033, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4287, dtype=torch.float64) delta_t tensor(-1.3001, dtype=torch.float64)
5 gae_duplicate tensor(-2.3555, dtype=torch.float64) tensor(24.8546, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1786, dtype=torch.float64) delta_t tensor(-3.1282, dtype=torch.float64)
4 gae_duplicate tensor(-5.7465, dtype=torch.float64) tensor(63.2236, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0333, dtype=torch.float64) delta_t tensor(-0.0982, dtype=torch.float64)
3 gae_duplicate tensor(-0.7695, dtype=torch.float64) tensor(9.3920, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2819, dtype=torch.float64) delta_t tensor(-0.4640, dtype=torch.float64)
2 gae_duplicate tensor(-0.7404, dtype=torch.float64) tensor(9.0161, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1346.403564453125
value loss:190.4234161376953
entropies:349.93560791015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.610895156860352 seconds
19 rew tensor(0.5402, dtype=torch.float64) delta_t tensor(0.3612, dtype=torch.float64)
19 gae_duplicate tensor(0.1677, dtype=torch.float64) tensor(-7.0296, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3403, dtype=torch.float64) delta_t tensor(0.1399, dtype=torch.float64)
18 gae_duplicate tensor(0.0837, dtype=torch.float64) tensor(-3.2227, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5543, dtype=torch.float64) delta_t tensor(0.3727, dtype=torch.float64)
17 gae_duplicate tensor(0.2461, dtype=torch.float64) tensor(-8.3325, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3295, dtype=torch.float64) delta_t tensor(0.1244, dtype=torch.float64)
16 gae_duplicate tensor(-0.0560, dtype=torch.float64) tensor(-3.0741, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5184, dtype=torch.float64) delta_t tensor(0.5149, dtype=torch.float64)
15 gae_duplicate tensor(0.1264, dtype=torch.float64) tensor(-9.7416, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2562, dtype=torch.float64) delta_t tensor(0.2586, dtype=torch.float64)
14 gae_duplicate tensor(0.1556, dtype=torch.float64) tensor(-6.5108, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5558, dtype=torch.float64) delta_t tensor(0.6415, dtype=torch.float64)
13 gae_duplicate tensor(0.5924, dtype=torch.float64) tensor(-13.1570, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2260, dtype=torch.float64) delta_t tensor(0.1766, dtype=torch.float64)
12 gae_duplicate tensor(0.0912, dtype=torch.float64) tensor(-4.7355, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5803, dtype=torch.float64) delta_t tensor(0.5030, dtype=torch.float64)
11 gae_duplicate tensor(0.4399, dtype=torch.float64) tensor(-10.4388, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2365, dtype=torch.float64) delta_t tensor(0.1651, dtype=torch.float64)
10 gae_duplicate tensor(0.0131, dtype=torch.float64) tensor(-4.3284, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5511, dtype=torch.float64) delta_t tensor(0.3725, dtype=torch.float64)
9 gae_duplicate tensor(0.3200, dtype=torch.float64) tensor(-7.5939, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1625, dtype=torch.float64) delta_t tensor(-0.0150, dtype=torch.float64)
8 gae_duplicate tensor(-0.1360, dtype=torch.float64) tensor(-0.5569, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5365, dtype=torch.float64) delta_t tensor(0.4347, dtype=torch.float64)
7 gae_duplicate tensor(0.3442, dtype=torch.float64) tensor(-8.8429, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0885, dtype=torch.float64) delta_t tensor(-0.0658, dtype=torch.float64)
6 gae_duplicate tensor(-0.2332, dtype=torch.float64) tensor(0.3843, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7580, dtype=torch.float64) delta_t tensor(-1.6231, dtype=torch.float64)
5 gae_duplicate tensor(-2.7507, dtype=torch.float64) tensor(32.5591, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.8689, dtype=torch.float64) delta_t tensor(-3.8339, dtype=torch.float64)
4 gae_duplicate tensor(-6.2058, dtype=torch.float64) tensor(75.3270, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1743, dtype=torch.float64) delta_t tensor(-0.2926, dtype=torch.float64)
3 gae_duplicate tensor(-0.9073, dtype=torch.float64) tensor(13.1232, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1816, dtype=torch.float64) delta_t tensor(-0.3261, dtype=torch.float64)
2 gae_duplicate tensor(-0.4874, dtype=torch.float64) tensor(6.6572, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2280.397216796875
value loss:214.05239868164062
entropies:348.7262878417969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.676260948181152 seconds
19 rew tensor(0.4987, dtype=torch.float64) delta_t tensor(0.3046, dtype=torch.float64)
19 gae_duplicate tensor(0.1936, dtype=torch.float64) tensor(-5.4985, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4556, dtype=torch.float64) delta_t tensor(0.2628, dtype=torch.float64)
18 gae_duplicate tensor(0.1610, dtype=torch.float64) tensor(-5.5571, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5426, dtype=torch.float64) delta_t tensor(0.4230, dtype=torch.float64)
17 gae_duplicate tensor(0.2695, dtype=torch.float64) tensor(-8.5355, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2871, dtype=torch.float64) delta_t tensor(0.1228, dtype=torch.float64)
16 gae_duplicate tensor(-0.1165, dtype=torch.float64) tensor(-2.8277, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4991, dtype=torch.float64) delta_t tensor(0.4045, dtype=torch.float64)
15 gae_duplicate tensor(0.0651, dtype=torch.float64) tensor(-8.2051, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2145, dtype=torch.float64) delta_t tensor(0.2016, dtype=torch.float64)
14 gae_duplicate tensor(-0.1128, dtype=torch.float64) tensor(-4.8571, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5599, dtype=torch.float64) delta_t tensor(0.6206, dtype=torch.float64)
13 gae_duplicate tensor(0.4764, dtype=torch.float64) tensor(-12.2100, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1560, dtype=torch.float64) delta_t tensor(0.0936, dtype=torch.float64)
12 gae_duplicate tensor(0.0188, dtype=torch.float64) tensor(-2.8435, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5825, dtype=torch.float64) delta_t tensor(0.4952, dtype=torch.float64)
11 gae_duplicate tensor(0.4082, dtype=torch.float64) tensor(-10.3588, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1664, dtype=torch.float64) delta_t tensor(0.0962, dtype=torch.float64)
10 gae_duplicate tensor(-0.0480, dtype=torch.float64) tensor(-2.7297, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5832, dtype=torch.float64) delta_t tensor(0.4075, dtype=torch.float64)
9 gae_duplicate tensor(0.3370, dtype=torch.float64) tensor(-8.1818, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1224, dtype=torch.float64) delta_t tensor(-0.0451, dtype=torch.float64)
8 gae_duplicate tensor(-0.1976, dtype=torch.float64) tensor(0.0625, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5382, dtype=torch.float64) delta_t tensor(0.4340, dtype=torch.float64)
7 gae_duplicate tensor(0.3475, dtype=torch.float64) tensor(-8.2475, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0784, dtype=torch.float64) delta_t tensor(-0.0722, dtype=torch.float64)
6 gae_duplicate tensor(-0.2028, dtype=torch.float64) tensor(0.5427, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5892, dtype=torch.float64) delta_t tensor(-1.4316, dtype=torch.float64)
5 gae_duplicate tensor(-1.6897, dtype=torch.float64) tensor(28.9145, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.2497, dtype=torch.float64) delta_t tensor(-3.2187, dtype=torch.float64)
4 gae_duplicate tensor(-5.1778, dtype=torch.float64) tensor(71.8626, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1974, dtype=torch.float64) delta_t tensor(-0.3155, dtype=torch.float64)
3 gae_duplicate tensor(-0.8960, dtype=torch.float64) tensor(11.4528, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1977, dtype=torch.float64) delta_t tensor(-0.3296, dtype=torch.float64)
2 gae_duplicate tensor(-0.5912, dtype=torch.float64) tensor(8.2572, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2310.00048828125
value loss:162.99044799804688
entropies:347.59210205078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.981149911880493 seconds
19 rew tensor(0.5749, dtype=torch.float64) delta_t tensor(0.3906, dtype=torch.float64)
19 gae_duplicate tensor(0.3219, dtype=torch.float64) tensor(-6.4959, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4866, dtype=torch.float64) delta_t tensor(0.2824, dtype=torch.float64)
18 gae_duplicate tensor(0.2351, dtype=torch.float64) tensor(-5.9270, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5404, dtype=torch.float64) delta_t tensor(0.3455, dtype=torch.float64)
17 gae_duplicate tensor(0.3025, dtype=torch.float64) tensor(-7.1956, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3804, dtype=torch.float64) delta_t tensor(0.2733, dtype=torch.float64)
16 gae_duplicate tensor(0.1327, dtype=torch.float64) tensor(-5.9318, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5268, dtype=torch.float64) delta_t tensor(0.4964, dtype=torch.float64)
15 gae_duplicate tensor(0.2857, dtype=torch.float64) tensor(-10.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2752, dtype=torch.float64) delta_t tensor(0.2099, dtype=torch.float64)
14 gae_duplicate tensor(-0.0189, dtype=torch.float64) tensor(-5.0126, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5000, dtype=torch.float64) delta_t tensor(0.4866, dtype=torch.float64)
13 gae_duplicate tensor(0.2938, dtype=torch.float64) tensor(-9.9893, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0056, dtype=torch.float64) delta_t tensor(0.0041, dtype=torch.float64)
12 gae_duplicate tensor(-0.4666, dtype=torch.float64) tensor(-0.4885, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5565, dtype=torch.float64) delta_t tensor(0.5042, dtype=torch.float64)
11 gae_duplicate tensor(0.3258, dtype=torch.float64) tensor(-9.8382, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1056, dtype=torch.float64) delta_t tensor(0.0739, dtype=torch.float64)
10 gae_duplicate tensor(-0.2192, dtype=torch.float64) tensor(-2.2175, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5369, dtype=torch.float64) delta_t tensor(0.3848, dtype=torch.float64)
9 gae_duplicate tensor(0.3134, dtype=torch.float64) tensor(-7.0805, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0352, dtype=torch.float64) delta_t tensor(-0.0979, dtype=torch.float64)
8 gae_duplicate tensor(-0.3944, dtype=torch.float64) tensor(1.4827, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4934, dtype=torch.float64) delta_t tensor(0.4161, dtype=torch.float64)
7 gae_duplicate tensor(0.2695, dtype=torch.float64) tensor(-7.7177, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0633, dtype=torch.float64) delta_t tensor(-0.2016, dtype=torch.float64)
6 gae_duplicate tensor(-0.5787, dtype=torch.float64) tensor(2.9609, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7417, dtype=torch.float64) delta_t tensor(-0.6225, dtype=torch.float64)
5 gae_duplicate tensor(-1.3886, dtype=torch.float64) tensor(13.3298, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.7883, dtype=torch.float64) delta_t tensor(-5.7825, dtype=torch.float64)
4 gae_duplicate tensor(-10.9979, dtype=torch.float64) tensor(108.1467, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0438, dtype=torch.float64) delta_t tensor(-0.1445, dtype=torch.float64)
3 gae_duplicate tensor(-1.1771, dtype=torch.float64) tensor(15.8624, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1155, dtype=torch.float64) delta_t tensor(-0.2439, dtype=torch.float64)
2 gae_duplicate tensor(-0.6223, dtype=torch.float64) tensor(5.6017, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3833.20654296875
value loss:411.5160217285156
entropies:345.97662353515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.096056938171387 seconds
19 rew tensor(0.5636, dtype=torch.float64) delta_t tensor(0.4377, dtype=torch.float64)
19 gae_duplicate tensor(0.3080, dtype=torch.float64) tensor(-7.6258, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4097, dtype=torch.float64) delta_t tensor(0.2373, dtype=torch.float64)
18 gae_duplicate tensor(0.1677, dtype=torch.float64) tensor(-5.5592, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4747, dtype=torch.float64) delta_t tensor(0.3822, dtype=torch.float64)
17 gae_duplicate tensor(-0.0149, dtype=torch.float64) tensor(-8.5563, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3445, dtype=torch.float64) delta_t tensor(0.3058, dtype=torch.float64)
16 gae_duplicate tensor(0.1546, dtype=torch.float64) tensor(-7.0809, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5516, dtype=torch.float64) delta_t tensor(0.5319, dtype=torch.float64)
15 gae_duplicate tensor(0.4077, dtype=torch.float64) tensor(-10.7123, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2621, dtype=torch.float64) delta_t tensor(0.1860, dtype=torch.float64)
14 gae_duplicate tensor(0.0048, dtype=torch.float64) tensor(-4.4053, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5440, dtype=torch.float64) delta_t tensor(0.5370, dtype=torch.float64)
13 gae_duplicate tensor(0.4278, dtype=torch.float64) tensor(-10.8608, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2491, dtype=torch.float64) delta_t tensor(0.1729, dtype=torch.float64)
12 gae_duplicate tensor(-0.0517, dtype=torch.float64) tensor(-4.6623, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5677, dtype=torch.float64) delta_t tensor(0.5103, dtype=torch.float64)
11 gae_duplicate tensor(0.4440, dtype=torch.float64) tensor(-9.8618, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2365, dtype=torch.float64) delta_t tensor(0.1463, dtype=torch.float64)
10 gae_duplicate tensor(-0.0971, dtype=torch.float64) tensor(-3.4553, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5686, dtype=torch.float64) delta_t tensor(0.3534, dtype=torch.float64)
9 gae_duplicate tensor(0.2974, dtype=torch.float64) tensor(-7.3694, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2009, dtype=torch.float64) delta_t tensor(0.0153, dtype=torch.float64)
8 gae_duplicate tensor(-0.2803, dtype=torch.float64) tensor(-1.1962, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5252, dtype=torch.float64) delta_t tensor(0.3732, dtype=torch.float64)
7 gae_duplicate tensor(0.3180, dtype=torch.float64) tensor(-7.3369, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1582, dtype=torch.float64) delta_t tensor(0.0147, dtype=torch.float64)
6 gae_duplicate tensor(-0.2370, dtype=torch.float64) tensor(-0.6628, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5700, dtype=torch.float64) delta_t tensor(-1.4144, dtype=torch.float64)
5 gae_duplicate tensor(-1.5378, dtype=torch.float64) tensor(30.0114, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3741, dtype=torch.float64) delta_t tensor(-2.2973, dtype=torch.float64)
4 gae_duplicate tensor(-4.6699, dtype=torch.float64) tensor(47.8652, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0415, dtype=torch.float64) delta_t tensor(-0.0754, dtype=torch.float64)
3 gae_duplicate tensor(-0.6531, dtype=torch.float64) tensor(5.8431, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2790, dtype=torch.float64) delta_t tensor(-0.4286, dtype=torch.float64)
2 gae_duplicate tensor(-0.6060, dtype=torch.float64) tensor(8.2878, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-236.78587341308594
value loss:110.38455963134766
entropies:344.54052734375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3907.1152)
ToM Target loss= tensor(2575.9036)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.549306154251099 seconds
19 rew tensor(0.4831, dtype=torch.float64) delta_t tensor(0.2539, dtype=torch.float64)
19 gae_duplicate tensor(0.0867, dtype=torch.float64) tensor(-4.8026, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3766, dtype=torch.float64) delta_t tensor(0.1691, dtype=torch.float64)
18 gae_duplicate tensor(0.0114, dtype=torch.float64) tensor(-3.5209, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5354, dtype=torch.float64) delta_t tensor(0.3354, dtype=torch.float64)
17 gae_duplicate tensor(0.2902, dtype=torch.float64) tensor(-6.6593, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2604, dtype=torch.float64) delta_t tensor(0.1808, dtype=torch.float64)
16 gae_duplicate tensor(-0.1815, dtype=torch.float64) tensor(-3.9806, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4632, dtype=torch.float64) delta_t tensor(0.6452, dtype=torch.float64)
15 gae_duplicate tensor(0.5360, dtype=torch.float64) tensor(-12.3135, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1498, dtype=torch.float64) delta_t tensor(0.1663, dtype=torch.float64)
14 gae_duplicate tensor(-0.0132, dtype=torch.float64) tensor(-4.7443, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5592, dtype=torch.float64) delta_t tensor(0.6155, dtype=torch.float64)
13 gae_duplicate tensor(0.5965, dtype=torch.float64) tensor(-12.6392, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1057, dtype=torch.float64) delta_t tensor(0.0598, dtype=torch.float64)
12 gae_duplicate tensor(-0.0318, dtype=torch.float64) tensor(-2.4901, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5597, dtype=torch.float64) delta_t tensor(0.4642, dtype=torch.float64)
11 gae_duplicate tensor(0.4087, dtype=torch.float64) tensor(-9.6110, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1072, dtype=torch.float64) delta_t tensor(0.0216, dtype=torch.float64)
10 gae_duplicate tensor(-0.0877, dtype=torch.float64) tensor(-1.3704, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5602, dtype=torch.float64) delta_t tensor(0.3351, dtype=torch.float64)
9 gae_duplicate tensor(0.2740, dtype=torch.float64) tensor(-6.9319, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0652, dtype=torch.float64) delta_t tensor(-0.1453, dtype=torch.float64)
8 gae_duplicate tensor(-0.2863, dtype=torch.float64) tensor(2.2175, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4598, dtype=torch.float64) delta_t tensor(0.2946, dtype=torch.float64)
7 gae_duplicate tensor(-0.0011, dtype=torch.float64) tensor(-5.3905, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0344, dtype=torch.float64) delta_t tensor(-0.1785, dtype=torch.float64)
6 gae_duplicate tensor(-0.4210, dtype=torch.float64) tensor(2.5519, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3119, dtype=torch.float64) delta_t tensor(-1.1596, dtype=torch.float64)
5 gae_duplicate tensor(-3.0273, dtype=torch.float64) tensor(22.1552, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9147, dtype=torch.float64) delta_t tensor(-3.8423, dtype=torch.float64)
4 gae_duplicate tensor(-9.5317, dtype=torch.float64) tensor(85.7736, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1081, dtype=torch.float64) delta_t tensor(-0.1413, dtype=torch.float64)
3 gae_duplicate tensor(-1.0122, dtype=torch.float64) tensor(11.2400, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2649, dtype=torch.float64) delta_t tensor(-0.4097, dtype=torch.float64)
2 gae_duplicate tensor(-0.6619, dtype=torch.float64) tensor(9.1062, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3256.345947265625
value loss:303.62548828125
entropies:342.48944091796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.398688077926636 seconds
19 rew tensor(0.5152, dtype=torch.float64) delta_t tensor(0.3559, dtype=torch.float64)
19 gae_duplicate tensor(0.0941, dtype=torch.float64) tensor(-5.8061, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5392, dtype=torch.float64) delta_t tensor(0.3991, dtype=torch.float64)
18 gae_duplicate tensor(0.3080, dtype=torch.float64) tensor(-7.6735, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3828, dtype=torch.float64) delta_t tensor(0.2182, dtype=torch.float64)
17 gae_duplicate tensor(-0.0039, dtype=torch.float64) tensor(-5.1336, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1413, dtype=torch.float64) delta_t tensor(0.2536, dtype=torch.float64)
16 gae_duplicate tensor(-0.2731, dtype=torch.float64) tensor(-5.5880, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5229, dtype=torch.float64) delta_t tensor(0.6657, dtype=torch.float64)
15 gae_duplicate tensor(0.6141, dtype=torch.float64) tensor(-12.2474, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1083, dtype=torch.float64) delta_t tensor(0.0869, dtype=torch.float64)
14 gae_duplicate tensor(-0.0636, dtype=torch.float64) tensor(-3.3131, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5599, dtype=torch.float64) delta_t tensor(0.5143, dtype=torch.float64)
13 gae_duplicate tensor(0.4661, dtype=torch.float64) tensor(-10.8830, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1096, dtype=torch.float64) delta_t tensor(0.0546, dtype=torch.float64)
12 gae_duplicate tensor(-0.1129, dtype=torch.float64) tensor(-1.8101, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5603, dtype=torch.float64) delta_t tensor(0.4427, dtype=torch.float64)
11 gae_duplicate tensor(0.4243, dtype=torch.float64) tensor(-9.1544, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1109, dtype=torch.float64) delta_t tensor(-0.0218, dtype=torch.float64)
10 gae_duplicate tensor(-0.3120, dtype=torch.float64) tensor(-0.4503, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5333, dtype=torch.float64) delta_t tensor(0.3070, dtype=torch.float64)
9 gae_duplicate tensor(0.1683, dtype=torch.float64) tensor(-5.4421, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0416, dtype=torch.float64) delta_t tensor(-0.1621, dtype=torch.float64)
8 gae_duplicate tensor(-0.2924, dtype=torch.float64) tensor(2.3424, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5179, dtype=torch.float64) delta_t tensor(0.3659, dtype=torch.float64)
7 gae_duplicate tensor(0.3340, dtype=torch.float64) tensor(-6.2908, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0277, dtype=torch.float64) delta_t tensor(-0.1864, dtype=torch.float64)
6 gae_duplicate tensor(-0.3113, dtype=torch.float64) tensor(2.5849, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4742, dtype=torch.float64) delta_t tensor(-1.3060, dtype=torch.float64)
5 gae_duplicate tensor(-2.3708, dtype=torch.float64) tensor(22.4926, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0224, dtype=torch.float64) delta_t tensor(-3.9517, dtype=torch.float64)
4 gae_duplicate tensor(-5.9667, dtype=torch.float64) tensor(74.8953, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0944, dtype=torch.float64) delta_t tensor(-0.1209, dtype=torch.float64)
3 gae_duplicate tensor(-0.6902, dtype=torch.float64) tensor(10.0584, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1593, dtype=torch.float64) delta_t tensor(-0.2922, dtype=torch.float64)
2 gae_duplicate tensor(-0.5296, dtype=torch.float64) tensor(6.3637, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2518.9091796875
value loss:214.30712890625
entropies:340.29962158203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.019508123397827 seconds
19 rew tensor(0.5021, dtype=torch.float64) delta_t tensor(0.2875, dtype=torch.float64)
19 gae_duplicate tensor(0.1355, dtype=torch.float64) tensor(-6.0741, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4564, dtype=torch.float64) delta_t tensor(0.2438, dtype=torch.float64)
18 gae_duplicate tensor(0.1650, dtype=torch.float64) tensor(-5.2426, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4889, dtype=torch.float64) delta_t tensor(0.2808, dtype=torch.float64)
17 gae_duplicate tensor(0.1330, dtype=torch.float64) tensor(-6.6625, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3995, dtype=torch.float64) delta_t tensor(0.3681, dtype=torch.float64)
16 gae_duplicate tensor(0.2127, dtype=torch.float64) tensor(-6.6524, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4816, dtype=torch.float64) delta_t tensor(0.5107, dtype=torch.float64)
15 gae_duplicate tensor(0.1501, dtype=torch.float64) tensor(-10.7654, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3074, dtype=torch.float64) delta_t tensor(0.3663, dtype=torch.float64)
14 gae_duplicate tensor(0.1188, dtype=torch.float64) tensor(-8.3450, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5472, dtype=torch.float64) delta_t tensor(0.5792, dtype=torch.float64)
13 gae_duplicate tensor(0.5224, dtype=torch.float64) tensor(-11.5202, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2727, dtype=torch.float64) delta_t tensor(0.2250, dtype=torch.float64)
12 gae_duplicate tensor(0.0585, dtype=torch.float64) tensor(-5.2547, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5627, dtype=torch.float64) delta_t tensor(0.4694, dtype=torch.float64)
11 gae_duplicate tensor(0.4443, dtype=torch.float64) tensor(-9.5787, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2741, dtype=torch.float64) delta_t tensor(0.1855, dtype=torch.float64)
10 gae_duplicate tensor(-0.0021, dtype=torch.float64) tensor(-4.4041, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5636, dtype=torch.float64) delta_t tensor(0.3404, dtype=torch.float64)
9 gae_duplicate tensor(0.2894, dtype=torch.float64) tensor(-6.7769, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2320, dtype=torch.float64) delta_t tensor(0.0387, dtype=torch.float64)
8 gae_duplicate tensor(-0.1764, dtype=torch.float64) tensor(-1.0219, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5210, dtype=torch.float64) delta_t tensor(0.3756, dtype=torch.float64)
7 gae_duplicate tensor(0.3128, dtype=torch.float64) tensor(-7.2474, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1899, dtype=torch.float64) delta_t tensor(0.0142, dtype=torch.float64)
6 gae_duplicate tensor(-0.1692, dtype=torch.float64) tensor(-1.2908, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5166, dtype=torch.float64) delta_t tensor(-1.3279, dtype=torch.float64)
5 gae_duplicate tensor(-2.0128, dtype=torch.float64) tensor(26.5748, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6068, dtype=torch.float64) delta_t tensor(-2.5044, dtype=torch.float64)
4 gae_duplicate tensor(-5.5930, dtype=torch.float64) tensor(48.3957, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0878, dtype=torch.float64) delta_t tensor(-0.0814, dtype=torch.float64)
3 gae_duplicate tensor(-0.6680, dtype=torch.float64) tensor(5.9338, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2261, dtype=torch.float64) delta_t tensor(-0.3549, dtype=torch.float64)
2 gae_duplicate tensor(-0.5333, dtype=torch.float64) tensor(7.5209, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:38.93798065185547
value loss:129.03424072265625
entropies:338.05755615234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.833703994750977 seconds
19 rew tensor(0.5229, dtype=torch.float64) delta_t tensor(0.3031, dtype=torch.float64)
19 gae_duplicate tensor(0.1932, dtype=torch.float64) tensor(-4.8882, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4370, dtype=torch.float64) delta_t tensor(0.3032, dtype=torch.float64)
18 gae_duplicate tensor(0.0826, dtype=torch.float64) tensor(-5.9365, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5088, dtype=torch.float64) delta_t tensor(0.5273, dtype=torch.float64)
17 gae_duplicate tensor(0.2549, dtype=torch.float64) tensor(-11.2713, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3711, dtype=torch.float64) delta_t tensor(0.3715, dtype=torch.float64)
16 gae_duplicate tensor(0.0715, dtype=torch.float64) tensor(-8.4339, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5401, dtype=torch.float64) delta_t tensor(0.6062, dtype=torch.float64)
15 gae_duplicate tensor(0.3601, dtype=torch.float64) tensor(-11.8285, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3213, dtype=torch.float64) delta_t tensor(0.3457, dtype=torch.float64)
14 gae_duplicate tensor(0.2247, dtype=torch.float64) tensor(-7.9777, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5474, dtype=torch.float64) delta_t tensor(0.5515, dtype=torch.float64)
13 gae_duplicate tensor(0.4830, dtype=torch.float64) tensor(-11.5882, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3367, dtype=torch.float64) delta_t tensor(0.2884, dtype=torch.float64)
12 gae_duplicate tensor(0.1824, dtype=torch.float64) tensor(-6.2653, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5261, dtype=torch.float64) delta_t tensor(0.4194, dtype=torch.float64)
11 gae_duplicate tensor(0.3552, dtype=torch.float64) tensor(-8.6801, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2936, dtype=torch.float64) delta_t tensor(0.1921, dtype=torch.float64)
10 gae_duplicate tensor(0.1203, dtype=torch.float64) tensor(-4.8175, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5187, dtype=torch.float64) delta_t tensor(0.2975, dtype=torch.float64)
9 gae_duplicate tensor(0.2153, dtype=torch.float64) tensor(-6.3257, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1767, dtype=torch.float64) delta_t tensor(-0.0074, dtype=torch.float64)
8 gae_duplicate tensor(-0.1563, dtype=torch.float64) tensor(-0.7433, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4471, dtype=torch.float64) delta_t tensor(0.2859, dtype=torch.float64)
7 gae_duplicate tensor(-0.1196, dtype=torch.float64) tensor(-5.0035, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0524, dtype=torch.float64) delta_t tensor(-0.1031, dtype=torch.float64)
6 gae_duplicate tensor(-0.2791, dtype=torch.float64) tensor(1.9480, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6208, dtype=torch.float64) delta_t tensor(-1.4418, dtype=torch.float64)
5 gae_duplicate tensor(-2.3150, dtype=torch.float64) tensor(24.8719, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9341, dtype=torch.float64) delta_t tensor(-2.8253, dtype=torch.float64)
4 gae_duplicate tensor(-6.1109, dtype=torch.float64) tensor(51.4693, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0821, dtype=torch.float64) delta_t tensor(-0.0745, dtype=torch.float64)
3 gae_duplicate tensor(-0.6728, dtype=torch.float64) tensor(6.9264, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2283, dtype=torch.float64) delta_t tensor(-0.3594, dtype=torch.float64)
2 gae_duplicate tensor(-0.5758, dtype=torch.float64) tensor(7.0615, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-10.806710243225098
value loss:168.4000244140625
entropies:336.5566711425781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.944804668426514 seconds
19 rew tensor(0.5222, dtype=torch.float64) delta_t tensor(0.3060, dtype=torch.float64)
19 gae_duplicate tensor(0.1218, dtype=torch.float64) tensor(-5.7594, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4079, dtype=torch.float64) delta_t tensor(0.1842, dtype=torch.float64)
18 gae_duplicate tensor(0.1346, dtype=torch.float64) tensor(-3.9344, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4947, dtype=torch.float64) delta_t tensor(0.3771, dtype=torch.float64)
17 gae_duplicate tensor(0.0600, dtype=torch.float64) tensor(-7.0617, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3810, dtype=torch.float64) delta_t tensor(0.2730, dtype=torch.float64)
16 gae_duplicate tensor(0.1291, dtype=torch.float64) tensor(-5.6930, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4277, dtype=torch.float64) delta_t tensor(0.5445, dtype=torch.float64)
15 gae_duplicate tensor(0.0415, dtype=torch.float64) tensor(-9.5082, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2421, dtype=torch.float64) delta_t tensor(0.2740, dtype=torch.float64)
14 gae_duplicate tensor(0.2017, dtype=torch.float64) tensor(-5.8106, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5540, dtype=torch.float64) delta_t tensor(0.5908, dtype=torch.float64)
13 gae_duplicate tensor(0.5230, dtype=torch.float64) tensor(-11.5889, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1238, dtype=torch.float64) delta_t tensor(0.0914, dtype=torch.float64)
12 gae_duplicate tensor(0.0163, dtype=torch.float64) tensor(-2.8585, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5618, dtype=torch.float64) delta_t tensor(0.4843, dtype=torch.float64)
11 gae_duplicate tensor(0.4382, dtype=torch.float64) tensor(-9.7402, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1250, dtype=torch.float64) delta_t tensor(0.0534, dtype=torch.float64)
10 gae_duplicate tensor(-0.0685, dtype=torch.float64) tensor(-2.1769, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5623, dtype=torch.float64) delta_t tensor(0.3477, dtype=torch.float64)
9 gae_duplicate tensor(0.2985, dtype=torch.float64) tensor(-7.6269, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0828, dtype=torch.float64) delta_t tensor(-0.0915, dtype=torch.float64)
8 gae_duplicate tensor(-0.2849, dtype=torch.float64) tensor(0.7312, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5193, dtype=torch.float64) delta_t tensor(0.3750, dtype=torch.float64)
7 gae_duplicate tensor(0.3078, dtype=torch.float64) tensor(-6.6478, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0406, dtype=torch.float64) delta_t tensor(-0.1220, dtype=torch.float64)
6 gae_duplicate tensor(-0.2589, dtype=torch.float64) tensor(1.3391, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3052, dtype=torch.float64) delta_t tensor(-1.0883, dtype=torch.float64)
5 gae_duplicate tensor(-2.2283, dtype=torch.float64) tensor(19.4958, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5762, dtype=torch.float64) delta_t tensor(-3.4724, dtype=torch.float64)
4 gae_duplicate tensor(-6.6232, dtype=torch.float64) tensor(71.7277, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1297, dtype=torch.float64) delta_t tensor(-0.1046, dtype=torch.float64)
3 gae_duplicate tensor(-0.7392, dtype=torch.float64) tensor(7.9607, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2601, dtype=torch.float64) delta_t tensor(-0.3754, dtype=torch.float64)
2 gae_duplicate tensor(-0.6001, dtype=torch.float64) tensor(7.8856, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1750.0760498046875
value loss:198.23394775390625
entropies:335.0665283203125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3871.0884)
ToM Target loss= tensor(2591.8589)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.175267696380615 seconds
19 rew tensor(0.4919, dtype=torch.float64) delta_t tensor(0.3522, dtype=torch.float64)
19 gae_duplicate tensor(0.1376, dtype=torch.float64) tensor(-6.0122, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4315, dtype=torch.float64) delta_t tensor(0.3379, dtype=torch.float64)
18 gae_duplicate tensor(0.1828, dtype=torch.float64) tensor(-6.7430, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4929, dtype=torch.float64) delta_t tensor(0.3651, dtype=torch.float64)
17 gae_duplicate tensor(0.1456, dtype=torch.float64) tensor(-7.9420, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4050, dtype=torch.float64) delta_t tensor(0.3094, dtype=torch.float64)
16 gae_duplicate tensor(0.1480, dtype=torch.float64) tensor(-6.0986, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4789, dtype=torch.float64) delta_t tensor(0.4497, dtype=torch.float64)
15 gae_duplicate tensor(0.1242, dtype=torch.float64) tensor(-9.0983, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2984, dtype=torch.float64) delta_t tensor(0.2488, dtype=torch.float64)
14 gae_duplicate tensor(0.1348, dtype=torch.float64) tensor(-5.9041, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5445, dtype=torch.float64) delta_t tensor(0.5633, dtype=torch.float64)
13 gae_duplicate tensor(0.4522, dtype=torch.float64) tensor(-11.3243, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2287, dtype=torch.float64) delta_t tensor(0.2027, dtype=torch.float64)
12 gae_duplicate tensor(0.0823, dtype=torch.float64) tensor(-5.0660, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5529, dtype=torch.float64) delta_t tensor(0.4475, dtype=torch.float64)
11 gae_duplicate tensor(0.3571, dtype=torch.float64) tensor(-8.9516, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2441, dtype=torch.float64) delta_t tensor(0.1540, dtype=torch.float64)
10 gae_duplicate tensor(-0.0827, dtype=torch.float64) tensor(-3.6920, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5605, dtype=torch.float64) delta_t tensor(0.3340, dtype=torch.float64)
9 gae_duplicate tensor(0.3046, dtype=torch.float64) tensor(-6.2539, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2019, dtype=torch.float64) delta_t tensor(0.0053, dtype=torch.float64)
8 gae_duplicate tensor(-0.1072, dtype=torch.float64) tensor(-0.8829, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4629, dtype=torch.float64) delta_t tensor(0.2863, dtype=torch.float64)
7 gae_duplicate tensor(-0.0558, dtype=torch.float64) tensor(-4.6732, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1048, dtype=torch.float64) delta_t tensor(-0.0357, dtype=torch.float64)
6 gae_duplicate tensor(-0.3864, dtype=torch.float64) tensor(0.3994, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3516, dtype=torch.float64) delta_t tensor(-1.1598, dtype=torch.float64)
5 gae_duplicate tensor(-2.0346, dtype=torch.float64) tensor(22.1183, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2990, dtype=torch.float64) delta_t tensor(-2.1596, dtype=torch.float64)
4 gae_duplicate tensor(-8.8195, dtype=torch.float64) tensor(45.1392, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0961, dtype=torch.float64) delta_t tensor(-0.0811, dtype=torch.float64)
3 gae_duplicate tensor(-0.8943, dtype=torch.float64) tensor(6.0922, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2434, dtype=torch.float64) delta_t tensor(-0.3434, dtype=torch.float64)
2 gae_duplicate tensor(-0.5873, dtype=torch.float64) tensor(6.1802, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:56.463199615478516
value loss:172.71060180664062
entropies:333.51416015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.247657060623169 seconds
19 rew tensor(0.5510, dtype=torch.float64) delta_t tensor(0.3968, dtype=torch.float64)
19 gae_duplicate tensor(0.2945, dtype=torch.float64) tensor(-7.5516, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3456, dtype=torch.float64) delta_t tensor(0.2333, dtype=torch.float64)
18 gae_duplicate tensor(0.1089, dtype=torch.float64) tensor(-4.2630, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5519, dtype=torch.float64) delta_t tensor(0.4360, dtype=torch.float64)
17 gae_duplicate tensor(0.3475, dtype=torch.float64) tensor(-8.9204, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2984, dtype=torch.float64) delta_t tensor(0.1250, dtype=torch.float64)
16 gae_duplicate tensor(0.0597, dtype=torch.float64) tensor(-4.2598, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5389, dtype=torch.float64) delta_t tensor(0.5358, dtype=torch.float64)
15 gae_duplicate tensor(0.3486, dtype=torch.float64) tensor(-9.9277, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2628, dtype=torch.float64) delta_t tensor(0.2325, dtype=torch.float64)
14 gae_duplicate tensor(0.0422, dtype=torch.float64) tensor(-5.3597, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5539, dtype=torch.float64) delta_t tensor(0.5958, dtype=torch.float64)
13 gae_duplicate tensor(0.4228, dtype=torch.float64) tensor(-11.6128, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2493, dtype=torch.float64) delta_t tensor(0.1897, dtype=torch.float64)
12 gae_duplicate tensor(0.0919, dtype=torch.float64) tensor(-4.5398, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5550, dtype=torch.float64) delta_t tensor(0.5037, dtype=torch.float64)
11 gae_duplicate tensor(0.3962, dtype=torch.float64) tensor(-9.5648, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2503, dtype=torch.float64) delta_t tensor(0.2066, dtype=torch.float64)
10 gae_duplicate tensor(0.1932, dtype=torch.float64) tensor(-4.5998, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5466, dtype=torch.float64) delta_t tensor(0.3700, dtype=torch.float64)
9 gae_duplicate tensor(0.2758, dtype=torch.float64) tensor(-7.8201, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1988, dtype=torch.float64) delta_t tensor(0.0521, dtype=torch.float64)
8 gae_duplicate tensor(-0.0822, dtype=torch.float64) tensor(-1.7704, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5196, dtype=torch.float64) delta_t tensor(0.3971, dtype=torch.float64)
7 gae_duplicate tensor(0.3243, dtype=torch.float64) tensor(-8.8450, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1403, dtype=torch.float64) delta_t tensor(0.0343, dtype=torch.float64)
6 gae_duplicate tensor(-0.1696, dtype=torch.float64) tensor(-1.0266, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8787, dtype=torch.float64) delta_t tensor(-1.6621, dtype=torch.float64)
5 gae_duplicate tensor(-3.4065, dtype=torch.float64) tensor(28.9035, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3596, dtype=torch.float64) delta_t tensor(-2.2317, dtype=torch.float64)
4 gae_duplicate tensor(-4.6646, dtype=torch.float64) tensor(39.7202, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0058, dtype=torch.float64) delta_t tensor(0.0269, dtype=torch.float64)
3 gae_duplicate tensor(-0.7114, dtype=torch.float64) tensor(3.8752, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3169, dtype=torch.float64) delta_t tensor(-0.4062, dtype=torch.float64)
2 gae_duplicate tensor(-0.5428, dtype=torch.float64) tensor(7.4873, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:454.4851989746094
value loss:121.02545928955078
entropies:331.7945251464844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.896040201187134 seconds
19 rew tensor(0.5033, dtype=torch.float64) delta_t tensor(0.2884, dtype=torch.float64)
19 gae_duplicate tensor(0.0912, dtype=torch.float64) tensor(-5.6351, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4466, dtype=torch.float64) delta_t tensor(0.2365, dtype=torch.float64)
18 gae_duplicate tensor(0.1531, dtype=torch.float64) tensor(-4.8000, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4721, dtype=torch.float64) delta_t tensor(0.3485, dtype=torch.float64)
17 gae_duplicate tensor(0.0859, dtype=torch.float64) tensor(-6.8020, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2970, dtype=torch.float64) delta_t tensor(0.2580, dtype=torch.float64)
16 gae_duplicate tensor(-0.1121, dtype=torch.float64) tensor(-6.6306, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5422, dtype=torch.float64) delta_t tensor(0.5788, dtype=torch.float64)
15 gae_duplicate tensor(0.3747, dtype=torch.float64) tensor(-12.5008, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1848, dtype=torch.float64) delta_t tensor(0.1837, dtype=torch.float64)
14 gae_duplicate tensor(0.1484, dtype=torch.float64) tensor(-4.4791, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5560, dtype=torch.float64) delta_t tensor(0.5460, dtype=torch.float64)
13 gae_duplicate tensor(0.4329, dtype=torch.float64) tensor(-8.9390, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1940, dtype=torch.float64) delta_t tensor(0.1875, dtype=torch.float64)
12 gae_duplicate tensor(0.0822, dtype=torch.float64) tensor(-4.8679, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5572, dtype=torch.float64) delta_t tensor(0.4901, dtype=torch.float64)
11 gae_duplicate tensor(0.4322, dtype=torch.float64) tensor(-9.5137, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2025, dtype=torch.float64) delta_t tensor(0.1444, dtype=torch.float64)
10 gae_duplicate tensor(0.0131, dtype=torch.float64) tensor(-4.1846, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5514, dtype=torch.float64) delta_t tensor(0.3559, dtype=torch.float64)
9 gae_duplicate tensor(0.2172, dtype=torch.float64) tensor(-6.3742, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1458, dtype=torch.float64) delta_t tensor(-0.0260, dtype=torch.float64)
8 gae_duplicate tensor(-0.2545, dtype=torch.float64) tensor(0.2776, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5217, dtype=torch.float64) delta_t tensor(0.3838, dtype=torch.float64)
7 gae_duplicate tensor(0.2991, dtype=torch.float64) tensor(-7.5751, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0891, dtype=torch.float64) delta_t tensor(-0.0152, dtype=torch.float64)
6 gae_duplicate tensor(-0.2307, dtype=torch.float64) tensor(-0.9071, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4389, dtype=torch.float64) delta_t tensor(-1.2125, dtype=torch.float64)
5 gae_duplicate tensor(-1.6377, dtype=torch.float64) tensor(24.6837, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7538, dtype=torch.float64) delta_t tensor(-1.6105, dtype=torch.float64)
4 gae_duplicate tensor(-3.8822, dtype=torch.float64) tensor(36.9268, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1680, dtype=torch.float64) delta_t tensor(-0.1472, dtype=torch.float64)
3 gae_duplicate tensor(-0.6670, dtype=torch.float64) tensor(5.5802, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3059, dtype=torch.float64) delta_t tensor(-0.3940, dtype=torch.float64)
2 gae_duplicate tensor(-0.5512, dtype=torch.float64) tensor(7.3820, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:362.05633544921875
value loss:86.06034851074219
entropies:330.85748291015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.19561505317688 seconds
19 rew tensor(0.5522, dtype=torch.float64) delta_t tensor(0.3254, dtype=torch.float64)
19 gae_duplicate tensor(0.2763, dtype=torch.float64) tensor(-6.1976, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4383, dtype=torch.float64) delta_t tensor(0.2036, dtype=torch.float64)
18 gae_duplicate tensor(0.1366, dtype=torch.float64) tensor(-4.9145, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4756, dtype=torch.float64) delta_t tensor(0.2606, dtype=torch.float64)
17 gae_duplicate tensor(0.0665, dtype=torch.float64) tensor(-4.4859, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3801, dtype=torch.float64) delta_t tensor(0.4242, dtype=torch.float64)
16 gae_duplicate tensor(0.1330, dtype=torch.float64) tensor(-7.8999, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5114, dtype=torch.float64) delta_t tensor(0.6244, dtype=torch.float64)
15 gae_duplicate tensor(0.2768, dtype=torch.float64) tensor(-10.6654, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2652, dtype=torch.float64) delta_t tensor(0.3162, dtype=torch.float64)
14 gae_duplicate tensor(0.1179, dtype=torch.float64) tensor(-7.3667, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5559, dtype=torch.float64) delta_t tensor(0.5713, dtype=torch.float64)
13 gae_duplicate tensor(0.5103, dtype=torch.float64) tensor(-11.6885, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2099, dtype=torch.float64) delta_t tensor(0.1946, dtype=torch.float64)
12 gae_duplicate tensor(0.0611, dtype=torch.float64) tensor(-4.7306, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5634, dtype=torch.float64) delta_t tensor(0.4990, dtype=torch.float64)
11 gae_duplicate tensor(0.4779, dtype=torch.float64) tensor(-9.3498, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2110, dtype=torch.float64) delta_t tensor(0.1354, dtype=torch.float64)
10 gae_duplicate tensor(0.0121, dtype=torch.float64) tensor(-3.4248, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5640, dtype=torch.float64) delta_t tensor(0.3537, dtype=torch.float64)
9 gae_duplicate tensor(0.3095, dtype=torch.float64) tensor(-8.5316, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1684, dtype=torch.float64) delta_t tensor(-0.0049, dtype=torch.float64)
8 gae_duplicate tensor(-0.1722, dtype=torch.float64) tensor(-0.5762, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5208, dtype=torch.float64) delta_t tensor(0.4018, dtype=torch.float64)
7 gae_duplicate tensor(0.3321, dtype=torch.float64) tensor(-7.3043, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1257, dtype=torch.float64) delta_t tensor(-0.0261, dtype=torch.float64)
6 gae_duplicate tensor(-0.1692, dtype=torch.float64) tensor(-0.6931, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5059, dtype=torch.float64) delta_t tensor(-1.2791, dtype=torch.float64)
5 gae_duplicate tensor(-1.4528, dtype=torch.float64) tensor(24.8683, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.4219, dtype=torch.float64) delta_t tensor(-4.2625, dtype=torch.float64)
4 gae_duplicate tensor(-6.2999, dtype=torch.float64) tensor(74.5498, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1290, dtype=torch.float64) delta_t tensor(-0.0960, dtype=torch.float64)
3 gae_duplicate tensor(-0.8985, dtype=torch.float64) tensor(10.0714, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1925, dtype=torch.float64) delta_t tensor(-0.2807, dtype=torch.float64)
2 gae_duplicate tensor(-0.5065, dtype=torch.float64) tensor(6.3921, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1603.840087890625
value loss:230.81300354003906
entropies:329.6137390136719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.965583801269531 seconds
19 rew tensor(0.5057, dtype=torch.float64) delta_t tensor(0.3112, dtype=torch.float64)
19 gae_duplicate tensor(0.0900, dtype=torch.float64) tensor(-6.3812, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4291, dtype=torch.float64) delta_t tensor(0.2921, dtype=torch.float64)
18 gae_duplicate tensor(0.0588, dtype=torch.float64) tensor(-6.4448, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4626, dtype=torch.float64) delta_t tensor(0.3134, dtype=torch.float64)
17 gae_duplicate tensor(0.0882, dtype=torch.float64) tensor(-5.9623, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1898, dtype=torch.float64) delta_t tensor(0.1572, dtype=torch.float64)
16 gae_duplicate tensor(-0.1813, dtype=torch.float64) tensor(-3.8837, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5315, dtype=torch.float64) delta_t tensor(0.5976, dtype=torch.float64)
15 gae_duplicate tensor(0.2486, dtype=torch.float64) tensor(-12.2936, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1973, dtype=torch.float64) delta_t tensor(0.2080, dtype=torch.float64)
14 gae_duplicate tensor(0.0600, dtype=torch.float64) tensor(-4.2317, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5477, dtype=torch.float64) delta_t tensor(0.6232, dtype=torch.float64)
13 gae_duplicate tensor(0.5581, dtype=torch.float64) tensor(-12.6710, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1917, dtype=torch.float64) delta_t tensor(0.1692, dtype=torch.float64)
12 gae_duplicate tensor(-0.0203, dtype=torch.float64) tensor(-5.0434, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5622, dtype=torch.float64) delta_t tensor(0.4929, dtype=torch.float64)
11 gae_duplicate tensor(0.4714, dtype=torch.float64) tensor(-10.0546, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1997, dtype=torch.float64) delta_t tensor(0.1216, dtype=torch.float64)
10 gae_duplicate tensor(-0.0508, dtype=torch.float64) tensor(-3.1493, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5364, dtype=torch.float64) delta_t tensor(0.3150, dtype=torch.float64)
9 gae_duplicate tensor(0.2069, dtype=torch.float64) tensor(-7.3114, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1308, dtype=torch.float64) delta_t tensor(-0.0487, dtype=torch.float64)
8 gae_duplicate tensor(-0.2477, dtype=torch.float64) tensor(0.4393, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5196, dtype=torch.float64) delta_t tensor(0.3732, dtype=torch.float64)
7 gae_duplicate tensor(0.3230, dtype=torch.float64) tensor(-6.7052, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0621, dtype=torch.float64) delta_t tensor(-0.0582, dtype=torch.float64)
6 gae_duplicate tensor(-0.2433, dtype=torch.float64) tensor(0.4764, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0881, dtype=torch.float64) delta_t tensor(-0.8525, dtype=torch.float64)
5 gae_duplicate tensor(-1.4285, dtype=torch.float64) tensor(16.4203, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0857, dtype=torch.float64) delta_t tensor(-3.9095, dtype=torch.float64)
4 gae_duplicate tensor(-7.5054, dtype=torch.float64) tensor(78.0029, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1339, dtype=torch.float64) delta_t tensor(-0.0679, dtype=torch.float64)
3 gae_duplicate tensor(-0.7796, dtype=torch.float64) tensor(8.7717, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2626, dtype=torch.float64) delta_t tensor(-0.3484, dtype=torch.float64)
2 gae_duplicate tensor(-0.5136, dtype=torch.float64) tensor(7.3717, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1565.850830078125
value loss:211.91168212890625
entropies:329.4281921386719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3829.1213)
ToM Target loss= tensor(2598.4180)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.053106069564819 seconds
19 rew tensor(0.4695, dtype=torch.float64) delta_t tensor(0.2542, dtype=torch.float64)
19 gae_duplicate tensor(0.1113, dtype=torch.float64) tensor(-5.9553, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4521, dtype=torch.float64) delta_t tensor(0.2418, dtype=torch.float64)
18 gae_duplicate tensor(0.1227, dtype=torch.float64) tensor(-5.3360, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4702, dtype=torch.float64) delta_t tensor(0.2472, dtype=torch.float64)
17 gae_duplicate tensor(0.0811, dtype=torch.float64) tensor(-5.3087, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3050, dtype=torch.float64) delta_t tensor(0.2817, dtype=torch.float64)
16 gae_duplicate tensor(-0.1166, dtype=torch.float64) tensor(-6.7689, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5247, dtype=torch.float64) delta_t tensor(0.6791, dtype=torch.float64)
15 gae_duplicate tensor(0.3743, dtype=torch.float64) tensor(-13.0263, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1286, dtype=torch.float64) delta_t tensor(0.1112, dtype=torch.float64)
14 gae_duplicate tensor(0.0640, dtype=torch.float64) tensor(-3.5935, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5534, dtype=torch.float64) delta_t tensor(0.6072, dtype=torch.float64)
13 gae_duplicate tensor(0.5502, dtype=torch.float64) tensor(-11.7876, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1374, dtype=torch.float64) delta_t tensor(0.1272, dtype=torch.float64)
12 gae_duplicate tensor(0.0975, dtype=torch.float64) tensor(-3.4565, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5613, dtype=torch.float64) delta_t tensor(0.5125, dtype=torch.float64)
11 gae_duplicate tensor(0.4981, dtype=torch.float64) tensor(-9.9259, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1459, dtype=torch.float64) delta_t tensor(0.0923, dtype=torch.float64)
10 gae_duplicate tensor(0.0238, dtype=torch.float64) tensor(-2.5582, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5617, dtype=torch.float64) delta_t tensor(0.3650, dtype=torch.float64)
9 gae_duplicate tensor(0.3271, dtype=torch.float64) tensor(-7.1923, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1035, dtype=torch.float64) delta_t tensor(-0.0706, dtype=torch.float64)
8 gae_duplicate tensor(-0.1373, dtype=torch.float64) tensor(0.4335, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5188, dtype=torch.float64) delta_t tensor(0.4014, dtype=torch.float64)
7 gae_duplicate tensor(0.3537, dtype=torch.float64) tensor(-7.8106, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0612, dtype=torch.float64) delta_t tensor(-0.1016, dtype=torch.float64)
6 gae_duplicate tensor(-0.1355, dtype=torch.float64) tensor(1.3157, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4979, dtype=torch.float64) delta_t tensor(-1.2331, dtype=torch.float64)
5 gae_duplicate tensor(-1.3943, dtype=torch.float64) tensor(22.1433, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9866, dtype=torch.float64) delta_t tensor(-3.8328, dtype=torch.float64)
4 gae_duplicate tensor(-6.9612, dtype=torch.float64) tensor(74.8772, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1504, dtype=torch.float64) delta_t tensor(-0.1118, dtype=torch.float64)
3 gae_duplicate tensor(-0.8716, dtype=torch.float64) tensor(9.4067, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1586, dtype=torch.float64) delta_t tensor(-0.1978, dtype=torch.float64)
2 gae_duplicate tensor(-0.4629, dtype=torch.float64) tensor(4.8582, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1725.7509765625
value loss:219.12538146972656
entropies:328.682373046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8966357707977295 seconds
19 rew tensor(0.4944, dtype=torch.float64) delta_t tensor(0.2647, dtype=torch.float64)
19 gae_duplicate tensor(0.1329, dtype=torch.float64) tensor(-4.2962, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3910, dtype=torch.float64) delta_t tensor(0.1694, dtype=torch.float64)
18 gae_duplicate tensor(0.0699, dtype=torch.float64) tensor(-4.3836, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4693, dtype=torch.float64) delta_t tensor(0.2509, dtype=torch.float64)
17 gae_duplicate tensor(0.1197, dtype=torch.float64) tensor(-5.4067, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3830, dtype=torch.float64) delta_t tensor(0.2207, dtype=torch.float64)
16 gae_duplicate tensor(0.0581, dtype=torch.float64) tensor(-4.6332, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4652, dtype=torch.float64) delta_t tensor(0.5684, dtype=torch.float64)
15 gae_duplicate tensor(0.0738, dtype=torch.float64) tensor(-12.1882, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2081, dtype=torch.float64) delta_t tensor(0.3127, dtype=torch.float64)
14 gae_duplicate tensor(0.2265, dtype=torch.float64) tensor(-6.4468, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5466, dtype=torch.float64) delta_t tensor(0.6459, dtype=torch.float64)
13 gae_duplicate tensor(0.6163, dtype=torch.float64) tensor(-12.9815, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1573, dtype=torch.float64) delta_t tensor(0.1512, dtype=torch.float64)
12 gae_duplicate tensor(0.0413, dtype=torch.float64) tensor(-4.6288, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5618, dtype=torch.float64) delta_t tensor(0.5145, dtype=torch.float64)
11 gae_duplicate tensor(0.4925, dtype=torch.float64) tensor(-9.8660, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1582, dtype=torch.float64) delta_t tensor(0.1232, dtype=torch.float64)
10 gae_duplicate tensor(-0.0537, dtype=torch.float64) tensor(-3.1677, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5622, dtype=torch.float64) delta_t tensor(0.3566, dtype=torch.float64)
9 gae_duplicate tensor(0.3221, dtype=torch.float64) tensor(-7.7546, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1158, dtype=torch.float64) delta_t tensor(-0.0267, dtype=torch.float64)
8 gae_duplicate tensor(-0.1578, dtype=torch.float64) tensor(-0.0686, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5192, dtype=torch.float64) delta_t tensor(0.3790, dtype=torch.float64)
7 gae_duplicate tensor(0.3042, dtype=torch.float64) tensor(-7.2569, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0733, dtype=torch.float64) delta_t tensor(-0.0538, dtype=torch.float64)
6 gae_duplicate tensor(-0.2310, dtype=torch.float64) tensor(-0.0963, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1492, dtype=torch.float64) delta_t tensor(-0.9013, dtype=torch.float64)
5 gae_duplicate tensor(-1.8438, dtype=torch.float64) tensor(19.1654, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3698, dtype=torch.float64) delta_t tensor(-2.1897, dtype=torch.float64)
4 gae_duplicate tensor(-7.0450, dtype=torch.float64) tensor(42.1628, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0969, dtype=torch.float64) delta_t tensor(-0.0023, dtype=torch.float64)
3 gae_duplicate tensor(-0.5462, dtype=torch.float64) tensor(4.7066, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3434, dtype=torch.float64) delta_t tensor(-0.4065, dtype=torch.float64)
2 gae_duplicate tensor(-0.6356, dtype=torch.float64) tensor(8.7019, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:366.7384948730469
value loss:141.48231506347656
entropies:329.4046936035156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0687642097473145 seconds
19 rew tensor(0.5396, dtype=torch.float64) delta_t tensor(0.3580, dtype=torch.float64)
19 gae_duplicate tensor(0.2468, dtype=torch.float64) tensor(-6.4997, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4388, dtype=torch.float64) delta_t tensor(0.2212, dtype=torch.float64)
18 gae_duplicate tensor(0.1777, dtype=torch.float64) tensor(-4.4615, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5113, dtype=torch.float64) delta_t tensor(0.3904, dtype=torch.float64)
17 gae_duplicate tensor(0.1366, dtype=torch.float64) tensor(-6.8887, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4264, dtype=torch.float64) delta_t tensor(0.3304, dtype=torch.float64)
16 gae_duplicate tensor(0.1399, dtype=torch.float64) tensor(-5.7905, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4978, dtype=torch.float64) delta_t tensor(0.3868, dtype=torch.float64)
15 gae_duplicate tensor(0.1677, dtype=torch.float64) tensor(-6.5743, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3251, dtype=torch.float64) delta_t tensor(0.3873, dtype=torch.float64)
14 gae_duplicate tensor(0.1285, dtype=torch.float64) tensor(-7.1285, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5348, dtype=torch.float64) delta_t tensor(0.6469, dtype=torch.float64)
13 gae_duplicate tensor(0.4947, dtype=torch.float64) tensor(-13.0613, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2452, dtype=torch.float64) delta_t tensor(0.2712, dtype=torch.float64)
12 gae_duplicate tensor(0.1442, dtype=torch.float64) tensor(-6.8899, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5568, dtype=torch.float64) delta_t tensor(0.5345, dtype=torch.float64)
11 gae_duplicate tensor(0.3803, dtype=torch.float64) tensor(-8.7686, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2539, dtype=torch.float64) delta_t tensor(0.2341, dtype=torch.float64)
10 gae_duplicate tensor(0.1443, dtype=torch.float64) tensor(-6.1792, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5137, dtype=torch.float64) delta_t tensor(0.3497, dtype=torch.float64)
9 gae_duplicate tensor(0.1739, dtype=torch.float64) tensor(-7.2267, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1684, dtype=torch.float64) delta_t tensor(0.0501, dtype=torch.float64)
8 gae_duplicate tensor(-0.1717, dtype=torch.float64) tensor(-1.6033, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4564, dtype=torch.float64) delta_t tensor(0.3716, dtype=torch.float64)
7 gae_duplicate tensor(0.0430, dtype=torch.float64) tensor(-6.5790, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0244, dtype=torch.float64) delta_t tensor(-0.0784, dtype=torch.float64)
6 gae_duplicate tensor(-0.4471, dtype=torch.float64) tensor(0.5118, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7789, dtype=torch.float64) delta_t tensor(-1.5233, dtype=torch.float64)
5 gae_duplicate tensor(-2.4000, dtype=torch.float64) tensor(28.8253, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.8638, dtype=torch.float64) delta_t tensor(-4.7154, dtype=torch.float64)
4 gae_duplicate tensor(-8.3073, dtype=torch.float64) tensor(97.7147, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0199, dtype=torch.float64) delta_t tensor(0.0240, dtype=torch.float64)
3 gae_duplicate tensor(-0.8775, dtype=torch.float64) tensor(6.2831, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1110, dtype=torch.float64) delta_t tensor(-0.1150, dtype=torch.float64)
2 gae_duplicate tensor(-0.5176, dtype=torch.float64) tensor(2.8091, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2707.20947265625
value loss:331.0498352050781
entropies:328.1777038574219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1084489822387695 seconds
19 rew tensor(0.5298, dtype=torch.float64) delta_t tensor(0.2973, dtype=torch.float64)
19 gae_duplicate tensor(0.1508, dtype=torch.float64) tensor(-4.5049, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3855, dtype=torch.float64) delta_t tensor(0.2444, dtype=torch.float64)
18 gae_duplicate tensor(0.0613, dtype=torch.float64) tensor(-5.8489, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4955, dtype=torch.float64) delta_t tensor(0.3489, dtype=torch.float64)
17 gae_duplicate tensor(0.2077, dtype=torch.float64) tensor(-6.7538, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3647, dtype=torch.float64) delta_t tensor(0.3531, dtype=torch.float64)
16 gae_duplicate tensor(0.0494, dtype=torch.float64) tensor(-7.3506, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5251, dtype=torch.float64) delta_t tensor(0.5888, dtype=torch.float64)
15 gae_duplicate tensor(0.3055, dtype=torch.float64) tensor(-12.9003, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2941, dtype=torch.float64) delta_t tensor(0.4093, dtype=torch.float64)
14 gae_duplicate tensor(0.2338, dtype=torch.float64) tensor(-8.9537, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5332, dtype=torch.float64) delta_t tensor(0.6109, dtype=torch.float64)
13 gae_duplicate tensor(0.5149, dtype=torch.float64) tensor(-12.0386, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3093, dtype=torch.float64) delta_t tensor(0.3325, dtype=torch.float64)
12 gae_duplicate tensor(0.1686, dtype=torch.float64) tensor(-7.6228, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5474, dtype=torch.float64) delta_t tensor(0.5279, dtype=torch.float64)
11 gae_duplicate tensor(0.4015, dtype=torch.float64) tensor(-10.2203, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3102, dtype=torch.float64) delta_t tensor(0.2785, dtype=torch.float64)
10 gae_duplicate tensor(0.1463, dtype=torch.float64) tensor(-5.6522, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4781, dtype=torch.float64) delta_t tensor(0.3273, dtype=torch.float64)
9 gae_duplicate tensor(0.2099, dtype=torch.float64) tensor(-5.7078, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1852, dtype=torch.float64) delta_t tensor(0.0565, dtype=torch.float64)
8 gae_duplicate tensor(-0.1451, dtype=torch.float64) tensor(-1.8707, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3512, dtype=torch.float64) delta_t tensor(0.2614, dtype=torch.float64)
7 gae_duplicate tensor(-0.0910, dtype=torch.float64) tensor(-5.4381, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0249, dtype=torch.float64) delta_t tensor(-0.1132, dtype=torch.float64)
6 gae_duplicate tensor(-0.3075, dtype=torch.float64) tensor(0.6277, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4093, dtype=torch.float64) delta_t tensor(-1.1499, dtype=torch.float64)
5 gae_duplicate tensor(-1.3014, dtype=torch.float64) tensor(24.1336, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-6.2490, dtype=torch.float64) delta_t tensor(-6.0998, dtype=torch.float64)
4 gae_duplicate tensor(-8.8296, dtype=torch.float64) tensor(103.0428, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0316, dtype=torch.float64) delta_t tensor(-0.0166, dtype=torch.float64)
3 gae_duplicate tensor(-0.8824, dtype=torch.float64) tensor(10.8623, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0316, dtype=torch.float64) delta_t tensor(-0.0068, dtype=torch.float64)
2 gae_duplicate tensor(-0.2627, dtype=torch.float64) tensor(0.8577, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2500.15966796875
value loss:439.9241943359375
entropies:327.5368957519531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.686838150024414 seconds
19 rew tensor(0.5385, dtype=torch.float64) delta_t tensor(0.3578, dtype=torch.float64)
19 gae_duplicate tensor(0.2086, dtype=torch.float64) tensor(-5.7133, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4165, dtype=torch.float64) delta_t tensor(0.2776, dtype=torch.float64)
18 gae_duplicate tensor(0.1320, dtype=torch.float64) tensor(-5.5574, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5182, dtype=torch.float64) delta_t tensor(0.3834, dtype=torch.float64)
17 gae_duplicate tensor(0.2511, dtype=torch.float64) tensor(-9.8071, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3701, dtype=torch.float64) delta_t tensor(0.2872, dtype=torch.float64)
16 gae_duplicate tensor(0.1273, dtype=torch.float64) tensor(-5.3906, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5107, dtype=torch.float64) delta_t tensor(0.5107, dtype=torch.float64)
15 gae_duplicate tensor(0.2439, dtype=torch.float64) tensor(-9.8510, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2708, dtype=torch.float64) delta_t tensor(0.4159, dtype=torch.float64)
14 gae_duplicate tensor(0.1914, dtype=torch.float64) tensor(-7.0515, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5255, dtype=torch.float64) delta_t tensor(0.6220, dtype=torch.float64)
13 gae_duplicate tensor(0.5006, dtype=torch.float64) tensor(-12.2726, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2580, dtype=torch.float64) delta_t tensor(0.2627, dtype=torch.float64)
12 gae_duplicate tensor(0.1452, dtype=torch.float64) tensor(-6.1025, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5472, dtype=torch.float64) delta_t tensor(0.4898, dtype=torch.float64)
11 gae_duplicate tensor(0.4411, dtype=torch.float64) tensor(-10.1315, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2588, dtype=torch.float64) delta_t tensor(0.2068, dtype=torch.float64)
10 gae_duplicate tensor(0.0949, dtype=torch.float64) tensor(-5.1954, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5227, dtype=torch.float64) delta_t tensor(0.3127, dtype=torch.float64)
9 gae_duplicate tensor(0.1866, dtype=torch.float64) tensor(-5.0687, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1929, dtype=torch.float64) delta_t tensor(0.0307, dtype=torch.float64)
8 gae_duplicate tensor(-0.1957, dtype=torch.float64) tensor(-1.3457, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5063, dtype=torch.float64) delta_t tensor(0.3682, dtype=torch.float64)
7 gae_duplicate tensor(0.3299, dtype=torch.float64) tensor(-7.5527, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1270, dtype=torch.float64) delta_t tensor(0.0097, dtype=torch.float64)
6 gae_duplicate tensor(-0.3321, dtype=torch.float64) tensor(-0.5208, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0665, dtype=torch.float64) delta_t tensor(-0.7887, dtype=torch.float64)
5 gae_duplicate tensor(-1.3979, dtype=torch.float64) tensor(12.7665, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.2029, dtype=torch.float64) delta_t tensor(-2.9834, dtype=torch.float64)
4 gae_duplicate tensor(-5.4948, dtype=torch.float64) tensor(67.6011, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0025, dtype=torch.float64) delta_t tensor(0.1013, dtype=torch.float64)
3 gae_duplicate tensor(-0.5887, dtype=torch.float64) tensor(3.5025, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2740, dtype=torch.float64) delta_t tensor(-0.2733, dtype=torch.float64)
2 gae_duplicate tensor(-0.4332, dtype=torch.float64) tensor(4.8591, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:64.36539459228516
value loss:155.00233459472656
entropies:327.9425964355469
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3790.3391)
ToM Target loss= tensor(2585.3264)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.8186869621276855 seconds
19 rew tensor(0.4954, dtype=torch.float64) delta_t tensor(0.2397, dtype=torch.float64)
19 gae_duplicate tensor(0.1698, dtype=torch.float64) tensor(-4.2778, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4137, dtype=torch.float64) delta_t tensor(0.1740, dtype=torch.float64)
18 gae_duplicate tensor(0.1203, dtype=torch.float64) tensor(-3.5250, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5046, dtype=torch.float64) delta_t tensor(0.3555, dtype=torch.float64)
17 gae_duplicate tensor(0.2000, dtype=torch.float64) tensor(-7.7254, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2742, dtype=torch.float64) delta_t tensor(0.3373, dtype=torch.float64)
16 gae_duplicate tensor(-0.1023, dtype=torch.float64) tensor(-5.8596, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4908, dtype=torch.float64) delta_t tensor(0.6977, dtype=torch.float64)
15 gae_duplicate tensor(0.6859, dtype=torch.float64) tensor(-13.9248, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2116, dtype=torch.float64) delta_t tensor(0.2568, dtype=torch.float64)
14 gae_duplicate tensor(0.1832, dtype=torch.float64) tensor(-6.2834, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5472, dtype=torch.float64) delta_t tensor(0.5607, dtype=torch.float64)
13 gae_duplicate tensor(0.5064, dtype=torch.float64) tensor(-11.9596, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1981, dtype=torch.float64) delta_t tensor(0.1609, dtype=torch.float64)
12 gae_duplicate tensor(0.0154, dtype=torch.float64) tensor(-3.9589, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5476, dtype=torch.float64) delta_t tensor(0.4849, dtype=torch.float64)
11 gae_duplicate tensor(0.4498, dtype=torch.float64) tensor(-9.6726, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1990, dtype=torch.float64) delta_t tensor(0.1398, dtype=torch.float64)
10 gae_duplicate tensor(-0.0093, dtype=torch.float64) tensor(-3.2583, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5481, dtype=torch.float64) delta_t tensor(0.3348, dtype=torch.float64)
9 gae_duplicate tensor(0.3132, dtype=torch.float64) tensor(-6.7170, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1579, dtype=torch.float64) delta_t tensor(-0.0151, dtype=torch.float64)
8 gae_duplicate tensor(-0.2042, dtype=torch.float64) tensor(-0.2058, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5066, dtype=torch.float64) delta_t tensor(0.3764, dtype=torch.float64)
7 gae_duplicate tensor(0.3474, dtype=torch.float64) tensor(-5.9523, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1169, dtype=torch.float64) delta_t tensor(-0.0377, dtype=torch.float64)
6 gae_duplicate tensor(-0.1670, dtype=torch.float64) tensor(0.0984, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3327, dtype=torch.float64) delta_t tensor(-1.0384, dtype=torch.float64)
5 gae_duplicate tensor(-1.2885, dtype=torch.float64) tensor(18.6869, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1810, dtype=torch.float64) delta_t tensor(-2.9514, dtype=torch.float64)
4 gae_duplicate tensor(-4.9564, dtype=torch.float64) tensor(64.4601, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2041, dtype=torch.float64) delta_t tensor(-0.1071, dtype=torch.float64)
3 gae_duplicate tensor(-0.6172, dtype=torch.float64) tensor(7.5264, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2110, dtype=torch.float64) delta_t tensor(-0.2467, dtype=torch.float64)
2 gae_duplicate tensor(-0.4189, dtype=torch.float64) tensor(5.1757, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-770.1455078125
value loss:148.69284057617188
entropies:326.9840087890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.785597085952759 seconds
19 rew tensor(0.4950, dtype=torch.float64) delta_t tensor(0.4267, dtype=torch.float64)
19 gae_duplicate tensor(0.2495, dtype=torch.float64) tensor(-5.8674, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3789, dtype=torch.float64) delta_t tensor(0.2772, dtype=torch.float64)
18 gae_duplicate tensor(0.1300, dtype=torch.float64) tensor(-7.0440, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5413, dtype=torch.float64) delta_t tensor(0.3927, dtype=torch.float64)
17 gae_duplicate tensor(0.3105, dtype=torch.float64) tensor(-8.3689, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2732, dtype=torch.float64) delta_t tensor(0.0918, dtype=torch.float64)
16 gae_duplicate tensor(-0.1719, dtype=torch.float64) tensor(-2.6666, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5204, dtype=torch.float64) delta_t tensor(0.3449, dtype=torch.float64)
15 gae_duplicate tensor(0.2331, dtype=torch.float64) tensor(-5.0953, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2106, dtype=torch.float64) delta_t tensor(0.1638, dtype=torch.float64)
14 gae_duplicate tensor(-0.1846, dtype=torch.float64) tensor(-4.4332, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5142, dtype=torch.float64) delta_t tensor(0.7033, dtype=torch.float64)
13 gae_duplicate tensor(0.5925, dtype=torch.float64) tensor(-12.2289, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1690, dtype=torch.float64) delta_t tensor(0.2128, dtype=torch.float64)
12 gae_duplicate tensor(0.0868, dtype=torch.float64) tensor(-5.2917, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5495, dtype=torch.float64) delta_t tensor(0.5653, dtype=torch.float64)
11 gae_duplicate tensor(0.5203, dtype=torch.float64) tensor(-10.2241, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1906, dtype=torch.float64) delta_t tensor(0.1936, dtype=torch.float64)
10 gae_duplicate tensor(0.0915, dtype=torch.float64) tensor(-4.6788, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5220, dtype=torch.float64) delta_t tensor(0.3731, dtype=torch.float64)
9 gae_duplicate tensor(0.2739, dtype=torch.float64) tensor(-7.3796, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1215, dtype=torch.float64) delta_t tensor(0.0203, dtype=torch.float64)
8 gae_duplicate tensor(-0.1149, dtype=torch.float64) tensor(-1.3209, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4943, dtype=torch.float64) delta_t tensor(0.4204, dtype=torch.float64)
7 gae_duplicate tensor(0.3102, dtype=torch.float64) tensor(-7.2623, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0385, dtype=torch.float64) delta_t tensor(-0.0449, dtype=torch.float64)
6 gae_duplicate tensor(-0.2472, dtype=torch.float64) tensor(0.1967, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6934, dtype=torch.float64) delta_t tensor(-1.4085, dtype=torch.float64)
5 gae_duplicate tensor(-1.9405, dtype=torch.float64) tensor(27.7744, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.2065, dtype=torch.float64) delta_t tensor(-2.9815, dtype=torch.float64)
4 gae_duplicate tensor(-4.7443, dtype=torch.float64) tensor(57.9304, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0936, dtype=torch.float64) delta_t tensor(0.0252, dtype=torch.float64)
3 gae_duplicate tensor(-0.4960, dtype=torch.float64) tensor(5.2207, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2269, dtype=torch.float64) delta_t tensor(-0.2274, dtype=torch.float64)
2 gae_duplicate tensor(-0.4262, dtype=torch.float64) tensor(3.5157, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-777.657958984375
value loss:143.87510681152344
entropies:325.0245361328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.849687814712524 seconds
19 rew tensor(0.5485, dtype=torch.float64) delta_t tensor(0.3968, dtype=torch.float64)
19 gae_duplicate tensor(0.2487, dtype=torch.float64) tensor(-6.9957, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3380, dtype=torch.float64) delta_t tensor(0.1438, dtype=torch.float64)
18 gae_duplicate tensor(0.0238, dtype=torch.float64) tensor(-4.1101, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5491, dtype=torch.float64) delta_t tensor(0.3650, dtype=torch.float64)
17 gae_duplicate tensor(0.2785, dtype=torch.float64) tensor(-7.4379, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3313, dtype=torch.float64) delta_t tensor(0.1908, dtype=torch.float64)
16 gae_duplicate tensor(0.0275, dtype=torch.float64) tensor(-4.0449, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5220, dtype=torch.float64) delta_t tensor(0.4638, dtype=torch.float64)
15 gae_duplicate tensor(0.2548, dtype=torch.float64) tensor(-9.4920, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3052, dtype=torch.float64) delta_t tensor(0.3341, dtype=torch.float64)
14 gae_duplicate tensor(0.0551, dtype=torch.float64) tensor(-8.9030, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5288, dtype=torch.float64) delta_t tensor(0.6170, dtype=torch.float64)
13 gae_duplicate tensor(0.4645, dtype=torch.float64) tensor(-11.7776, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3057, dtype=torch.float64) delta_t tensor(0.3203, dtype=torch.float64)
12 gae_duplicate tensor(0.2212, dtype=torch.float64) tensor(-6.3151, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5435, dtype=torch.float64) delta_t tensor(0.5936, dtype=torch.float64)
11 gae_duplicate tensor(0.5200, dtype=torch.float64) tensor(-9.5876, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3064, dtype=torch.float64) delta_t tensor(0.3246, dtype=torch.float64)
10 gae_duplicate tensor(0.2559, dtype=torch.float64) tensor(-6.5160, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5512, dtype=torch.float64) delta_t tensor(0.4756, dtype=torch.float64)
9 gae_duplicate tensor(0.3567, dtype=torch.float64) tensor(-10.2106, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2722, dtype=torch.float64) delta_t tensor(0.2179, dtype=torch.float64)
8 gae_duplicate tensor(0.1061, dtype=torch.float64) tensor(-4.2789, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5096, dtype=torch.float64) delta_t tensor(0.4836, dtype=torch.float64)
7 gae_duplicate tensor(0.3806, dtype=torch.float64) tensor(-9.0942, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2309, dtype=torch.float64) delta_t tensor(0.2262, dtype=torch.float64)
6 gae_duplicate tensor(0.0517, dtype=torch.float64) tensor(-5.3246, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4669, dtype=torch.float64) delta_t tensor(-1.1612, dtype=torch.float64)
5 gae_duplicate tensor(-1.2612, dtype=torch.float64) tensor(18.3607, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0469, dtype=torch.float64) delta_t tensor(-1.8072, dtype=torch.float64)
4 gae_duplicate tensor(-4.1683, dtype=torch.float64) tensor(37.1279, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1402, dtype=torch.float64) delta_t tensor(-0.0573, dtype=torch.float64)
3 gae_duplicate tensor(-0.6224, dtype=torch.float64) tensor(4.0429, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2126, dtype=torch.float64) delta_t tensor(-0.1964, dtype=torch.float64)
2 gae_duplicate tensor(-0.4053, dtype=torch.float64) tensor(3.0725, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2152.9580078125
value loss:101.03292846679688
entropies:322.869384765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.044176816940308 seconds
19 rew tensor(0.5032, dtype=torch.float64) delta_t tensor(0.3200, dtype=torch.float64)
19 gae_duplicate tensor(0.1123, dtype=torch.float64) tensor(-5.5776, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3468, dtype=torch.float64) delta_t tensor(0.1623, dtype=torch.float64)
18 gae_duplicate tensor(0.0881, dtype=torch.float64) tensor(-3.6354, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5080, dtype=torch.float64) delta_t tensor(0.3014, dtype=torch.float64)
17 gae_duplicate tensor(0.1243, dtype=torch.float64) tensor(-5.7301, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2115, dtype=torch.float64) delta_t tensor(0.0583, dtype=torch.float64)
16 gae_duplicate tensor(-0.1966, dtype=torch.float64) tensor(-2.0147, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5307, dtype=torch.float64) delta_t tensor(0.6431, dtype=torch.float64)
15 gae_duplicate tensor(0.3343, dtype=torch.float64) tensor(-12.4116, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0669, dtype=torch.float64) delta_t tensor(0.0286, dtype=torch.float64)
14 gae_duplicate tensor(-0.1966, dtype=torch.float64) tensor(-2.1201, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5518, dtype=torch.float64) delta_t tensor(0.5923, dtype=torch.float64)
13 gae_duplicate tensor(0.3508, dtype=torch.float64) tensor(-11.0520, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0748, dtype=torch.float64) delta_t tensor(0.0864, dtype=torch.float64)
12 gae_duplicate tensor(-0.0803, dtype=torch.float64) tensor(-2.1897, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5451, dtype=torch.float64) delta_t tensor(0.5291, dtype=torch.float64)
11 gae_duplicate tensor(0.4492, dtype=torch.float64) tensor(-8.7431, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0896, dtype=torch.float64) delta_t tensor(0.0559, dtype=torch.float64)
10 gae_duplicate tensor(-0.1357, dtype=torch.float64) tensor(-2.2453, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5376, dtype=torch.float64) delta_t tensor(0.3546, dtype=torch.float64)
9 gae_duplicate tensor(0.2682, dtype=torch.float64) tensor(-7.3762, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0334, dtype=torch.float64) delta_t tensor(-0.0986, dtype=torch.float64)
8 gae_duplicate tensor(-0.3304, dtype=torch.float64) tensor(1.2136, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5101, dtype=torch.float64) delta_t tensor(0.3959, dtype=torch.float64)
7 gae_duplicate tensor(0.2645, dtype=torch.float64) tensor(-7.9420, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0229, dtype=torch.float64) delta_t tensor(-0.1435, dtype=torch.float64)
6 gae_duplicate tensor(-0.4416, dtype=torch.float64) tensor(1.8910, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3095, dtype=torch.float64) delta_t tensor(-1.0029, dtype=torch.float64)
5 gae_duplicate tensor(-2.1367, dtype=torch.float64) tensor(20.4256, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4887, dtype=torch.float64) delta_t tensor(-2.2466, dtype=torch.float64)
4 gae_duplicate tensor(-4.9223, dtype=torch.float64) tensor(51.4161, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0985, dtype=torch.float64) delta_t tensor(-0.0223, dtype=torch.float64)
3 gae_duplicate tensor(-0.5582, dtype=torch.float64) tensor(3.6474, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2020, dtype=torch.float64) delta_t tensor(-0.1648, dtype=torch.float64)
2 gae_duplicate tensor(-0.3687, dtype=torch.float64) tensor(3.4961, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-683.5413818359375
value loss:111.13734436035156
entropies:321.2254333496094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.644896030426025 seconds
19 rew tensor(0.5311, dtype=torch.float64) delta_t tensor(0.4357, dtype=torch.float64)
19 gae_duplicate tensor(0.2242, dtype=torch.float64) tensor(-8.2758, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3722, dtype=torch.float64) delta_t tensor(0.2536, dtype=torch.float64)
18 gae_duplicate tensor(0.0368, dtype=torch.float64) tensor(-5.8697, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5273, dtype=torch.float64) delta_t tensor(0.4079, dtype=torch.float64)
17 gae_duplicate tensor(0.2493, dtype=torch.float64) tensor(-8.2776, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3081, dtype=torch.float64) delta_t tensor(0.1391, dtype=torch.float64)
16 gae_duplicate tensor(-0.0688, dtype=torch.float64) tensor(-2.6766, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5416, dtype=torch.float64) delta_t tensor(0.4727, dtype=torch.float64)
15 gae_duplicate tensor(0.3297, dtype=torch.float64) tensor(-7.6726, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2528, dtype=torch.float64) delta_t tensor(0.3132, dtype=torch.float64)
14 gae_duplicate tensor(-0.0057, dtype=torch.float64) tensor(-7.5222, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5071, dtype=torch.float64) delta_t tensor(0.6050, dtype=torch.float64)
13 gae_duplicate tensor(0.6050, dtype=torch.float64) tensor(-12.6434, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3234, dtype=torch.float64) delta_t tensor(0.3473, dtype=torch.float64)
12 gae_duplicate tensor(0.1083, dtype=torch.float64) tensor(-8.2390, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4733, dtype=torch.float64) delta_t tensor(0.4794, dtype=torch.float64)
11 gae_duplicate tensor(0.3784, dtype=torch.float64) tensor(-8.1409, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3310, dtype=torch.float64) delta_t tensor(0.3028, dtype=torch.float64)
10 gae_duplicate tensor(0.0580, dtype=torch.float64) tensor(-7.7461, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4466, dtype=torch.float64) delta_t tensor(0.2877, dtype=torch.float64)
9 gae_duplicate tensor(0.2095, dtype=torch.float64) tensor(-6.0803, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2280, dtype=torch.float64) delta_t tensor(0.1127, dtype=torch.float64)
8 gae_duplicate tensor(-0.1286, dtype=torch.float64) tensor(-1.7717, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3229, dtype=torch.float64) delta_t tensor(0.2652, dtype=torch.float64)
7 gae_duplicate tensor(0.0229, dtype=torch.float64) tensor(-4.8852, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0353, dtype=torch.float64) delta_t tensor(-0.0799, dtype=torch.float64)
6 gae_duplicate tensor(-0.3135, dtype=torch.float64) tensor(0.9378, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2906, dtype=torch.float64) delta_t tensor(-0.9983, dtype=torch.float64)
5 gae_duplicate tensor(-1.3064, dtype=torch.float64) tensor(19.8922, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.9543, dtype=torch.float64) delta_t tensor(-4.7646, dtype=torch.float64)
4 gae_duplicate tensor(-7.1066, dtype=torch.float64) tensor(87.7440, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0738, dtype=torch.float64) delta_t tensor(0.0512, dtype=torch.float64)
3 gae_duplicate tensor(-0.6115, dtype=torch.float64) tensor(6.3499, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0738, dtype=torch.float64) delta_t tensor(-0.0458, dtype=torch.float64)
2 gae_duplicate tensor(-0.3464, dtype=torch.float64) tensor(1.4067, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1518.494140625
value loss:292.42999267578125
entropies:318.1781311035156
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3738.3044)
ToM Target loss= tensor(2564.5803)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.900508880615234 seconds
19 rew tensor(0.5273, dtype=torch.float64) delta_t tensor(0.4199, dtype=torch.float64)
19 gae_duplicate tensor(0.2262, dtype=torch.float64) tensor(-6.2609, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3794, dtype=torch.float64) delta_t tensor(0.2143, dtype=torch.float64)
18 gae_duplicate tensor(0.1127, dtype=torch.float64) tensor(-4.8002, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4929, dtype=torch.float64) delta_t tensor(0.3282, dtype=torch.float64)
17 gae_duplicate tensor(0.1362, dtype=torch.float64) tensor(-7.7801, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3170, dtype=torch.float64) delta_t tensor(0.4003, dtype=torch.float64)
16 gae_duplicate tensor(0.1175, dtype=torch.float64) tensor(-7.4605, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5283, dtype=torch.float64) delta_t tensor(0.5417, dtype=torch.float64)
15 gae_duplicate tensor(0.3426, dtype=torch.float64) tensor(-11.4702, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2753, dtype=torch.float64) delta_t tensor(0.2842, dtype=torch.float64)
14 gae_duplicate tensor(0.1924, dtype=torch.float64) tensor(-5.7832, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5420, dtype=torch.float64) delta_t tensor(0.5376, dtype=torch.float64)
13 gae_duplicate tensor(0.4123, dtype=torch.float64) tensor(-11.8985, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2836, dtype=torch.float64) delta_t tensor(0.2138, dtype=torch.float64)
12 gae_duplicate tensor(0.1573, dtype=torch.float64) tensor(-5.2198, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5436, dtype=torch.float64) delta_t tensor(0.5734, dtype=torch.float64)
11 gae_duplicate tensor(0.4956, dtype=torch.float64) tensor(-10.1592, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2706, dtype=torch.float64) delta_t tensor(0.2262, dtype=torch.float64)
10 gae_duplicate tensor(0.1254, dtype=torch.float64) tensor(-4.3662, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5505, dtype=torch.float64) delta_t tensor(0.3643, dtype=torch.float64)
9 gae_duplicate tensor(0.3026, dtype=torch.float64) tensor(-7.0456, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2430, dtype=torch.float64) delta_t tensor(0.1299, dtype=torch.float64)
8 gae_duplicate tensor(-0.0904, dtype=torch.float64) tensor(-3.2463, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5089, dtype=torch.float64) delta_t tensor(0.3802, dtype=torch.float64)
7 gae_duplicate tensor(0.3048, dtype=torch.float64) tensor(-6.2123, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2017, dtype=torch.float64) delta_t tensor(0.1074, dtype=torch.float64)
6 gae_duplicate tensor(-0.0930, dtype=torch.float64) tensor(-2.3935, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1986, dtype=torch.float64) delta_t tensor(-0.8715, dtype=torch.float64)
5 gae_duplicate tensor(-1.2922, dtype=torch.float64) tensor(15.6539, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3602, dtype=torch.float64) delta_t tensor(-2.1009, dtype=torch.float64)
4 gae_duplicate tensor(-4.6910, dtype=torch.float64) tensor(29.9785, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0162, dtype=torch.float64) delta_t tensor(0.1609, dtype=torch.float64)
3 gae_duplicate tensor(-0.5030, dtype=torch.float64) tensor(1.7364, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3085, dtype=torch.float64) delta_t tensor(-0.2941, dtype=torch.float64)
2 gae_duplicate tensor(-0.5614, dtype=torch.float64) tensor(5.1482, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2159.543701171875
value loss:110.67803955078125
entropies:317.5431213378906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.054900884628296 seconds
19 rew tensor(0.5755, dtype=torch.float64) delta_t tensor(0.4004, dtype=torch.float64)
19 gae_duplicate tensor(0.2835, dtype=torch.float64) tensor(-7.3531, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4832, dtype=torch.float64) delta_t tensor(0.3221, dtype=torch.float64)
18 gae_duplicate tensor(0.1099, dtype=torch.float64) tensor(-5.4984, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5089, dtype=torch.float64) delta_t tensor(0.5324, dtype=torch.float64)
17 gae_duplicate tensor(0.1363, dtype=torch.float64) tensor(-11.0877, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3121, dtype=torch.float64) delta_t tensor(0.4519, dtype=torch.float64)
16 gae_duplicate tensor(-0.0290, dtype=torch.float64) tensor(-8.8606, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3286, dtype=torch.float64) delta_t tensor(0.5274, dtype=torch.float64)
15 gae_duplicate tensor(-0.6985, dtype=torch.float64) tensor(-7.6930, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2989, dtype=torch.float64) delta_t tensor(0.3924, dtype=torch.float64)
14 gae_duplicate tensor(0.1166, dtype=torch.float64) tensor(-8.6075, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4724, dtype=torch.float64) delta_t tensor(0.5208, dtype=torch.float64)
13 gae_duplicate tensor(0.0221, dtype=torch.float64) tensor(-12.5661, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3065, dtype=torch.float64) delta_t tensor(0.3311, dtype=torch.float64)
12 gae_duplicate tensor(0.0149, dtype=torch.float64) tensor(-5.4950, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1619, dtype=torch.float64) delta_t tensor(0.1621, dtype=torch.float64)
11 gae_duplicate tensor(-0.9068, dtype=torch.float64) tensor(-4.2831, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0117, dtype=torch.float64) delta_t tensor(-0.0304, dtype=torch.float64)
10 gae_duplicate tensor(-1.1366, dtype=torch.float64) tensor(-0.1275, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4073, dtype=torch.float64) delta_t tensor(0.3136, dtype=torch.float64)
9 gae_duplicate tensor(0.0356, dtype=torch.float64) tensor(-6.8102, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1210, dtype=torch.float64) delta_t tensor(0.0873, dtype=torch.float64)
8 gae_duplicate tensor(-0.1955, dtype=torch.float64) tensor(-1.7068, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4617, dtype=torch.float64) delta_t tensor(0.4527, dtype=torch.float64)
7 gae_duplicate tensor(0.2889, dtype=torch.float64) tensor(-10.1383, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1148, dtype=torch.float64) delta_t tensor(-0.1408, dtype=torch.float64)
6 gae_duplicate tensor(-0.5130, dtype=torch.float64) tensor(0.6642, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8697, dtype=torch.float64) delta_t tensor(-0.5995, dtype=torch.float64)
5 gae_duplicate tensor(-1.2705, dtype=torch.float64) tensor(11.2541, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1249, dtype=torch.float64) delta_t tensor(-2.9971, dtype=torch.float64)
4 gae_duplicate tensor(-7.7415, dtype=torch.float64) tensor(61.3977, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0102, dtype=torch.float64) delta_t tensor(0.0034, dtype=torch.float64)
3 gae_duplicate tensor(-0.6330, dtype=torch.float64) tensor(4.7328, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3191, dtype=torch.float64) delta_t tensor(-0.2499, dtype=torch.float64)
2 gae_duplicate tensor(-0.6344, dtype=torch.float64) tensor(4.9731, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:303.8851623535156
value loss:191.33038330078125
entropies:315.56329345703125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.908634662628174 seconds
19 rew tensor(0.4976, dtype=torch.float64) delta_t tensor(0.2892, dtype=torch.float64)
19 gae_duplicate tensor(0.0415, dtype=torch.float64) tensor(-4.6464, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4669, dtype=torch.float64) delta_t tensor(0.2500, dtype=torch.float64)
18 gae_duplicate tensor(0.1608, dtype=torch.float64) tensor(-4.2433, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4702, dtype=torch.float64) delta_t tensor(0.2416, dtype=torch.float64)
17 gae_duplicate tensor(0.1016, dtype=torch.float64) tensor(-5.3445, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2202, dtype=torch.float64) delta_t tensor(0.3285, dtype=torch.float64)
16 gae_duplicate tensor(-0.1551, dtype=torch.float64) tensor(-7.0995, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4918, dtype=torch.float64) delta_t tensor(0.5531, dtype=torch.float64)
15 gae_duplicate tensor(0.1362, dtype=torch.float64) tensor(-8.6194, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2809, dtype=torch.float64) delta_t tensor(0.3185, dtype=torch.float64)
14 gae_duplicate tensor(0.0038, dtype=torch.float64) tensor(-4.9092, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5405, dtype=torch.float64) delta_t tensor(0.5657, dtype=torch.float64)
13 gae_duplicate tensor(0.4485, dtype=torch.float64) tensor(-10.8787, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2466, dtype=torch.float64) delta_t tensor(0.2591, dtype=torch.float64)
12 gae_duplicate tensor(0.1522, dtype=torch.float64) tensor(-5.8640, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5403, dtype=torch.float64) delta_t tensor(0.5018, dtype=torch.float64)
11 gae_duplicate tensor(0.4963, dtype=torch.float64) tensor(-9.7704, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2548, dtype=torch.float64) delta_t tensor(0.2055, dtype=torch.float64)
10 gae_duplicate tensor(0.1206, dtype=torch.float64) tensor(-4.2828, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5482, dtype=torch.float64) delta_t tensor(0.3195, dtype=torch.float64)
9 gae_duplicate tensor(0.2972, dtype=torch.float64) tensor(-7.1037, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2136, dtype=torch.float64) delta_t tensor(0.0619, dtype=torch.float64)
8 gae_duplicate tensor(-0.0970, dtype=torch.float64) tensor(-2.1671, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5067, dtype=torch.float64) delta_t tensor(0.3499, dtype=torch.float64)
7 gae_duplicate tensor(0.2923, dtype=torch.float64) tensor(-5.3874, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1724, dtype=torch.float64) delta_t tensor(0.0305, dtype=torch.float64)
6 gae_duplicate tensor(-0.1005, dtype=torch.float64) tensor(-0.9146, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9064, dtype=torch.float64) delta_t tensor(-0.5802, dtype=torch.float64)
5 gae_duplicate tensor(-2.1384, dtype=torch.float64) tensor(16.3456, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5632, dtype=torch.float64) delta_t tensor(-3.2803, dtype=torch.float64)
4 gae_duplicate tensor(-6.8251, dtype=torch.float64) tensor(54.3601, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0018, dtype=torch.float64) delta_t tensor(0.1265, dtype=torch.float64)
3 gae_duplicate tensor(-0.8111, dtype=torch.float64) tensor(4.4687, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2845, dtype=torch.float64) delta_t tensor(-0.2206, dtype=torch.float64)
2 gae_duplicate tensor(-0.3652, dtype=torch.float64) tensor(4.8792, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-21.03797721862793
value loss:201.34423828125
entropies:313.4310607910156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.88633394241333 seconds
19 rew tensor(0.5535, dtype=torch.float64) delta_t tensor(0.3963, dtype=torch.float64)
19 gae_duplicate tensor(0.2595, dtype=torch.float64) tensor(-6.3013, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3842, dtype=torch.float64) delta_t tensor(0.2752, dtype=torch.float64)
18 gae_duplicate tensor(0.0311, dtype=torch.float64) tensor(-5.5418, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5471, dtype=torch.float64) delta_t tensor(0.5168, dtype=torch.float64)
17 gae_duplicate tensor(0.2981, dtype=torch.float64) tensor(-9.1779, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3781, dtype=torch.float64) delta_t tensor(0.2533, dtype=torch.float64)
16 gae_duplicate tensor(0.0193, dtype=torch.float64) tensor(-5.7884, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5322, dtype=torch.float64) delta_t tensor(0.4845, dtype=torch.float64)
15 gae_duplicate tensor(0.2826, dtype=torch.float64) tensor(-8.3989, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3048, dtype=torch.float64) delta_t tensor(0.3521, dtype=torch.float64)
14 gae_duplicate tensor(0.0022, dtype=torch.float64) tensor(-7.9159, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5265, dtype=torch.float64) delta_t tensor(0.6160, dtype=torch.float64)
13 gae_duplicate tensor(0.5476, dtype=torch.float64) tensor(-9.3411, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3051, dtype=torch.float64) delta_t tensor(0.3013, dtype=torch.float64)
12 gae_duplicate tensor(0.1458, dtype=torch.float64) tensor(-6.6264, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5480, dtype=torch.float64) delta_t tensor(0.4796, dtype=torch.float64)
11 gae_duplicate tensor(0.3807, dtype=torch.float64) tensor(-9.6542, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3124, dtype=torch.float64) delta_t tensor(0.2241, dtype=torch.float64)
10 gae_duplicate tensor(0.0137, dtype=torch.float64) tensor(-5.8749, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5336, dtype=torch.float64) delta_t tensor(0.3357, dtype=torch.float64)
9 gae_duplicate tensor(0.2836, dtype=torch.float64) tensor(-5.6397, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2562, dtype=torch.float64) delta_t tensor(0.1376, dtype=torch.float64)
8 gae_duplicate tensor(-0.1043, dtype=torch.float64) tensor(-3.4761, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4551, dtype=torch.float64) delta_t tensor(0.3440, dtype=torch.float64)
7 gae_duplicate tensor(0.1816, dtype=torch.float64) tensor(-6.2768, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1474, dtype=torch.float64) delta_t tensor(0.0525, dtype=torch.float64)
6 gae_duplicate tensor(-0.4145, dtype=torch.float64) tensor(-1.0803, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3530, dtype=torch.float64) delta_t tensor(-1.0226, dtype=torch.float64)
5 gae_duplicate tensor(-1.8813, dtype=torch.float64) tensor(15.5572, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6137, dtype=torch.float64) delta_t tensor(-2.3574, dtype=torch.float64)
4 gae_duplicate tensor(-4.6818, dtype=torch.float64) tensor(45.6131, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0715, dtype=torch.float64) delta_t tensor(0.2063, dtype=torch.float64)
3 gae_duplicate tensor(-0.5070, dtype=torch.float64) tensor(0.6202, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2630, dtype=torch.float64) delta_t tensor(-0.2143, dtype=torch.float64)
2 gae_duplicate tensor(-0.4259, dtype=torch.float64) tensor(3.6747, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1300.179931640625
value loss:133.79458618164062
entropies:310.22625732421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.596789121627808 seconds
19 rew tensor(0.5520, dtype=torch.float64) delta_t tensor(0.3816, dtype=torch.float64)
19 gae_duplicate tensor(0.2572, dtype=torch.float64) tensor(-6.4749, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3311, dtype=torch.float64) delta_t tensor(0.1073, dtype=torch.float64)
18 gae_duplicate tensor(0.0660, dtype=torch.float64) tensor(-2.4776, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5261, dtype=torch.float64) delta_t tensor(0.2953, dtype=torch.float64)
17 gae_duplicate tensor(0.1848, dtype=torch.float64) tensor(-6.9776, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3186, dtype=torch.float64) delta_t tensor(0.1418, dtype=torch.float64)
16 gae_duplicate tensor(0.0082, dtype=torch.float64) tensor(-2.8708, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5258, dtype=torch.float64) delta_t tensor(0.5462, dtype=torch.float64)
15 gae_duplicate tensor(0.2801, dtype=torch.float64) tensor(-8.6405, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2319, dtype=torch.float64) delta_t tensor(0.2374, dtype=torch.float64)
14 gae_duplicate tensor(0.0016, dtype=torch.float64) tensor(-4.8551, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5326, dtype=torch.float64) delta_t tensor(0.6030, dtype=torch.float64)
13 gae_duplicate tensor(0.3711, dtype=torch.float64) tensor(-10.9923, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2402, dtype=torch.float64) delta_t tensor(0.2835, dtype=torch.float64)
12 gae_duplicate tensor(0.0403, dtype=torch.float64) tensor(-5.1702, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5396, dtype=torch.float64) delta_t tensor(0.5337, dtype=torch.float64)
11 gae_duplicate tensor(0.4893, dtype=torch.float64) tensor(-8.2173, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2547, dtype=torch.float64) delta_t tensor(0.2314, dtype=torch.float64)
10 gae_duplicate tensor(0.0344, dtype=torch.float64) tensor(-4.7018, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5212, dtype=torch.float64) delta_t tensor(0.3388, dtype=torch.float64)
9 gae_duplicate tensor(0.1847, dtype=torch.float64) tensor(-6.4491, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1872, dtype=torch.float64) delta_t tensor(0.0765, dtype=torch.float64)
8 gae_duplicate tensor(-0.2820, dtype=torch.float64) tensor(-1.6204, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5058, dtype=torch.float64) delta_t tensor(0.3869, dtype=torch.float64)
7 gae_duplicate tensor(0.3279, dtype=torch.float64) tensor(-6.7178, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1197, dtype=torch.float64) delta_t tensor(0.0372, dtype=torch.float64)
6 gae_duplicate tensor(-0.4752, dtype=torch.float64) tensor(-1.9637, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3641, dtype=torch.float64) delta_t tensor(-1.0313, dtype=torch.float64)
5 gae_duplicate tensor(-3.0809, dtype=torch.float64) tensor(23.3851, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0697, dtype=torch.float64) delta_t tensor(-2.8016, dtype=torch.float64)
4 gae_duplicate tensor(-6.5118, dtype=torch.float64) tensor(48.9106, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0588, dtype=torch.float64) delta_t tensor(0.1670, dtype=torch.float64)
3 gae_duplicate tensor(-0.7972, dtype=torch.float64) tensor(3.3145, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2774, dtype=torch.float64) delta_t tensor(-0.2001, dtype=torch.float64)
2 gae_duplicate tensor(-0.4932, dtype=torch.float64) tensor(2.9029, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-103.53468322753906
value loss:173.61349487304688
entropies:306.6373596191406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3665.4150)
ToM Target loss= tensor(2552.3953)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.8682861328125 seconds
19 rew tensor(0.4814, dtype=torch.float64) delta_t tensor(0.2646, dtype=torch.float64)
19 gae_duplicate tensor(0.1136, dtype=torch.float64) tensor(-4.4372, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4646, dtype=torch.float64) delta_t tensor(0.2537, dtype=torch.float64)
18 gae_duplicate tensor(0.0838, dtype=torch.float64) tensor(-6.0163, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4886, dtype=torch.float64) delta_t tensor(0.2471, dtype=torch.float64)
17 gae_duplicate tensor(0.1772, dtype=torch.float64) tensor(-3.7781, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3702, dtype=torch.float64) delta_t tensor(0.2105, dtype=torch.float64)
16 gae_duplicate tensor(0.0149, dtype=torch.float64) tensor(-4.2112, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4191, dtype=torch.float64) delta_t tensor(0.5152, dtype=torch.float64)
15 gae_duplicate tensor(0.1081, dtype=torch.float64) tensor(-9.6243, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3633, dtype=torch.float64) delta_t tensor(0.4579, dtype=torch.float64)
14 gae_duplicate tensor(0.2112, dtype=torch.float64) tensor(-9.2428, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3845, dtype=torch.float64) delta_t tensor(0.4916, dtype=torch.float64)
13 gae_duplicate tensor(0.3171, dtype=torch.float64) tensor(-8.8682, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3277, dtype=torch.float64) delta_t tensor(0.3604, dtype=torch.float64)
12 gae_duplicate tensor(0.0860, dtype=torch.float64) tensor(-5.4758, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3868, dtype=torch.float64) delta_t tensor(0.4008, dtype=torch.float64)
11 gae_duplicate tensor(0.2665, dtype=torch.float64) tensor(-8.5683, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3226, dtype=torch.float64) delta_t tensor(0.3162, dtype=torch.float64)
10 gae_duplicate tensor(0.0688, dtype=torch.float64) tensor(-6.3628, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4004, dtype=torch.float64) delta_t tensor(0.2135, dtype=torch.float64)
9 gae_duplicate tensor(0.0738, dtype=torch.float64) tensor(-4.6986, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1853, dtype=torch.float64) delta_t tensor(0.0351, dtype=torch.float64)
8 gae_duplicate tensor(-0.1944, dtype=torch.float64) tensor(-1.7534, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2625, dtype=torch.float64) delta_t tensor(0.1570, dtype=torch.float64)
7 gae_duplicate tensor(-0.2251, dtype=torch.float64) tensor(-1.9581, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0778, dtype=torch.float64) delta_t tensor(-0.1291, dtype=torch.float64)
6 gae_duplicate tensor(-0.3909, dtype=torch.float64) tensor(2.6221, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2997, dtype=torch.float64) delta_t tensor(-0.9842, dtype=torch.float64)
5 gae_duplicate tensor(-1.2416, dtype=torch.float64) tensor(17.2785, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7343, dtype=torch.float64) delta_t tensor(-2.5037, dtype=torch.float64)
4 gae_duplicate tensor(-6.1919, dtype=torch.float64) tensor(36.3972, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0928, dtype=torch.float64) delta_t tensor(0.0606, dtype=torch.float64)
3 gae_duplicate tensor(-0.6910, dtype=torch.float64) tensor(3.0442, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1464, dtype=torch.float64) delta_t tensor(-0.0327, dtype=torch.float64)
2 gae_duplicate tensor(-0.3504, dtype=torch.float64) tensor(0.9341, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:713.3234252929688
value loss:160.39527893066406
entropies:301.9229431152344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.722589015960693 seconds
19 rew tensor(0.5387, dtype=torch.float64) delta_t tensor(0.3430, dtype=torch.float64)
19 gae_duplicate tensor(0.2300, dtype=torch.float64) tensor(-5.6882, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3892, dtype=torch.float64) delta_t tensor(0.1391, dtype=torch.float64)
18 gae_duplicate tensor(0.0241, dtype=torch.float64) tensor(-2.9366, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5330, dtype=torch.float64) delta_t tensor(0.2800, dtype=torch.float64)
17 gae_duplicate tensor(0.2027, dtype=torch.float64) tensor(-5.2370, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3008, dtype=torch.float64) delta_t tensor(0.1238, dtype=torch.float64)
16 gae_duplicate tensor(-0.1399, dtype=torch.float64) tensor(-3.0380, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5186, dtype=torch.float64) delta_t tensor(0.6205, dtype=torch.float64)
15 gae_duplicate tensor(0.2756, dtype=torch.float64) tensor(-10.6252, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2658, dtype=torch.float64) delta_t tensor(0.3078, dtype=torch.float64)
14 gae_duplicate tensor(0.0685, dtype=torch.float64) tensor(-6.1252, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5328, dtype=torch.float64) delta_t tensor(0.6177, dtype=torch.float64)
13 gae_duplicate tensor(0.5522, dtype=torch.float64) tensor(-12.8185, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2889, dtype=torch.float64) delta_t tensor(0.2642, dtype=torch.float64)
12 gae_duplicate tensor(0.1205, dtype=torch.float64) tensor(-4.4660, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5474, dtype=torch.float64) delta_t tensor(0.4964, dtype=torch.float64)
11 gae_duplicate tensor(0.5048, dtype=torch.float64) tensor(-7.6255, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2961, dtype=torch.float64) delta_t tensor(0.2275, dtype=torch.float64)
10 gae_duplicate tensor(0.0951, dtype=torch.float64) tensor(-5.7465, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5340, dtype=torch.float64) delta_t tensor(0.2894, dtype=torch.float64)
9 gae_duplicate tensor(0.2617, dtype=torch.float64) tensor(-6.1211, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2409, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
8 gae_duplicate tensor(-0.1743, dtype=torch.float64) tensor(-1.2717, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5061, dtype=torch.float64) delta_t tensor(0.3446, dtype=torch.float64)
7 gae_duplicate tensor(0.2834, dtype=torch.float64) tensor(-5.7632, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1857, dtype=torch.float64) delta_t tensor(0.0450, dtype=torch.float64)
6 gae_duplicate tensor(-0.1288, dtype=torch.float64) tensor(-1.1893, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6164, dtype=torch.float64) delta_t tensor(-1.2721, dtype=torch.float64)
5 gae_duplicate tensor(-1.8824, dtype=torch.float64) tensor(18.6733, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8185, dtype=torch.float64) delta_t tensor(-2.5140, dtype=torch.float64)
4 gae_duplicate tensor(-5.1154, dtype=torch.float64) tensor(30.4451, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0908, dtype=torch.float64) delta_t tensor(0.0909, dtype=torch.float64)
3 gae_duplicate tensor(-0.5872, dtype=torch.float64) tensor(2.3944, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2366, dtype=torch.float64) delta_t tensor(-0.1802, dtype=torch.float64)
2 gae_duplicate tensor(-0.3123, dtype=torch.float64) tensor(2.8975, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1228.4100341796875
value loss:133.4365234375
entropies:298.646240234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.714551687240601 seconds
19 rew tensor(0.4823, dtype=torch.float64) delta_t tensor(0.3183, dtype=torch.float64)
19 gae_duplicate tensor(0.0325, dtype=torch.float64) tensor(-6.8436, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4551, dtype=torch.float64) delta_t tensor(0.2829, dtype=torch.float64)
18 gae_duplicate tensor(0.0811, dtype=torch.float64) tensor(-3.9425, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5342, dtype=torch.float64) delta_t tensor(0.3548, dtype=torch.float64)
17 gae_duplicate tensor(0.1626, dtype=torch.float64) tensor(-6.2932, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2529, dtype=torch.float64) delta_t tensor(0.0566, dtype=torch.float64)
16 gae_duplicate tensor(-0.1432, dtype=torch.float64) tensor(-2.4442, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4467, dtype=torch.float64) delta_t tensor(0.5107, dtype=torch.float64)
15 gae_duplicate tensor(0.1111, dtype=torch.float64) tensor(-8.0619, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1519, dtype=torch.float64) delta_t tensor(0.1983, dtype=torch.float64)
14 gae_duplicate tensor(-0.0744, dtype=torch.float64) tensor(-4.9105, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4559, dtype=torch.float64) delta_t tensor(0.5452, dtype=torch.float64)
13 gae_duplicate tensor(0.2933, dtype=torch.float64) tensor(-9.7677, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0918, dtype=torch.float64) delta_t tensor(0.1003, dtype=torch.float64)
12 gae_duplicate tensor(-0.0462, dtype=torch.float64) tensor(-2.7448, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4954, dtype=torch.float64) delta_t tensor(0.4619, dtype=torch.float64)
11 gae_duplicate tensor(0.2737, dtype=torch.float64) tensor(-6.0826, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0730, dtype=torch.float64) delta_t tensor(0.0278, dtype=torch.float64)
10 gae_duplicate tensor(-0.0655, dtype=torch.float64) tensor(-1.4903, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4955, dtype=torch.float64) delta_t tensor(0.2645, dtype=torch.float64)
9 gae_duplicate tensor(0.0933, dtype=torch.float64) tensor(-4.4635, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0022, dtype=torch.float64) delta_t tensor(-0.1637, dtype=torch.float64)
8 gae_duplicate tensor(-0.2844, dtype=torch.float64) tensor(1.9731, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4170, dtype=torch.float64) delta_t tensor(0.2740, dtype=torch.float64)
7 gae_duplicate tensor(-0.1276, dtype=torch.float64) tensor(-3.6903, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1199, dtype=torch.float64) delta_t tensor(-0.1895, dtype=torch.float64)
6 gae_duplicate tensor(-0.2481, dtype=torch.float64) tensor(2.5401, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8563, dtype=torch.float64) delta_t tensor(-0.5208, dtype=torch.float64)
5 gae_duplicate tensor(-1.2975, dtype=torch.float64) tensor(9.3394, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0020, dtype=torch.float64) delta_t tensor(-3.7200, dtype=torch.float64)
4 gae_duplicate tensor(-7.4307, dtype=torch.float64) tensor(86.1839, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1010, dtype=torch.float64) delta_t tensor(0.0845, dtype=torch.float64)
3 gae_duplicate tensor(-0.5840, dtype=torch.float64) tensor(4.2523, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1848, dtype=torch.float64) delta_t tensor(-0.0795, dtype=torch.float64)
2 gae_duplicate tensor(-0.2983, dtype=torch.float64) tensor(3.0345, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2595.221435546875
value loss:198.26809692382812
entropies:294.2735900878906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.883671045303345 seconds
19 rew tensor(0.4199, dtype=torch.float64) delta_t tensor(0.1611, dtype=torch.float64)
19 gae_duplicate tensor(0.0315, dtype=torch.float64) tensor(-2.7567, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3708, dtype=torch.float64) delta_t tensor(0.1327, dtype=torch.float64)
18 gae_duplicate tensor(0.0110, dtype=torch.float64) tensor(-2.6306, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5127, dtype=torch.float64) delta_t tensor(0.2497, dtype=torch.float64)
17 gae_duplicate tensor(0.0870, dtype=torch.float64) tensor(-2.3902, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2720, dtype=torch.float64) delta_t tensor(-0.0035, dtype=torch.float64)
16 gae_duplicate tensor(-0.1731, dtype=torch.float64) tensor(0.0929, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4729, dtype=torch.float64) delta_t tensor(0.5930, dtype=torch.float64)
15 gae_duplicate tensor(0.0925, dtype=torch.float64) tensor(-10.8605, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1971, dtype=torch.float64) delta_t tensor(0.2692, dtype=torch.float64)
14 gae_duplicate tensor(-0.1525, dtype=torch.float64) tensor(-5.3360, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5348, dtype=torch.float64) delta_t tensor(0.6491, dtype=torch.float64)
13 gae_duplicate tensor(0.6133, dtype=torch.float64) tensor(-8.9335, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1514, dtype=torch.float64) delta_t tensor(0.1461, dtype=torch.float64)
12 gae_duplicate tensor(0.0914, dtype=torch.float64) tensor(-2.4943, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5488, dtype=torch.float64) delta_t tensor(0.5153, dtype=torch.float64)
11 gae_duplicate tensor(0.4679, dtype=torch.float64) tensor(-9.2143, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1587, dtype=torch.float64) delta_t tensor(0.1099, dtype=torch.float64)
10 gae_duplicate tensor(0.0503, dtype=torch.float64) tensor(-3.0486, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5490, dtype=torch.float64) delta_t tensor(0.3089, dtype=torch.float64)
9 gae_duplicate tensor(0.2593, dtype=torch.float64) tensor(-4.5598, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1172, dtype=torch.float64) delta_t tensor(-0.0451, dtype=torch.float64)
8 gae_duplicate tensor(-0.1573, dtype=torch.float64) tensor(0.8415, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5072, dtype=torch.float64) delta_t tensor(0.3503, dtype=torch.float64)
7 gae_duplicate tensor(0.2962, dtype=torch.float64) tensor(-5.3293, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0757, dtype=torch.float64) delta_t tensor(-0.0740, dtype=torch.float64)
6 gae_duplicate tensor(-0.1494, dtype=torch.float64) tensor(0.8621, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7462, dtype=torch.float64) delta_t tensor(-1.3955, dtype=torch.float64)
5 gae_duplicate tensor(-2.0449, dtype=torch.float64) tensor(23.4151, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3267, dtype=torch.float64) delta_t tensor(-2.0346, dtype=torch.float64)
4 gae_duplicate tensor(-4.1194, dtype=torch.float64) tensor(36.1874, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1336, dtype=torch.float64) delta_t tensor(0.0774, dtype=torch.float64)
3 gae_duplicate tensor(-0.4161, dtype=torch.float64) tensor(2.9193, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2527, dtype=torch.float64) delta_t tensor(-0.1921, dtype=torch.float64)
2 gae_duplicate tensor(-0.3628, dtype=torch.float64) tensor(3.5403, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-635.0631103515625
value loss:101.40547180175781
entropies:291.109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.787790060043335 seconds
19 rew tensor(0.5345, dtype=torch.float64) delta_t tensor(0.2988, dtype=torch.float64)
19 gae_duplicate tensor(0.1729, dtype=torch.float64) tensor(-4.6515, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3958, dtype=torch.float64) delta_t tensor(0.2512, dtype=torch.float64)
18 gae_duplicate tensor(0.0012, dtype=torch.float64) tensor(-3.8937, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5353, dtype=torch.float64) delta_t tensor(0.3696, dtype=torch.float64)
17 gae_duplicate tensor(0.2700, dtype=torch.float64) tensor(-5.0894, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3226, dtype=torch.float64) delta_t tensor(0.2209, dtype=torch.float64)
16 gae_duplicate tensor(-0.0661, dtype=torch.float64) tensor(-4.0841, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4813, dtype=torch.float64) delta_t tensor(0.6672, dtype=torch.float64)
15 gae_duplicate tensor(0.3345, dtype=torch.float64) tensor(-11.3526, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2763, dtype=torch.float64) delta_t tensor(0.3108, dtype=torch.float64)
14 gae_duplicate tensor(0.0862, dtype=torch.float64) tensor(-4.3760, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5335, dtype=torch.float64) delta_t tensor(0.5430, dtype=torch.float64)
13 gae_duplicate tensor(0.2500, dtype=torch.float64) tensor(-10.5600, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2355, dtype=torch.float64) delta_t tensor(0.2760, dtype=torch.float64)
12 gae_duplicate tensor(0.0362, dtype=torch.float64) tensor(-5.4394, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5415, dtype=torch.float64) delta_t tensor(0.5562, dtype=torch.float64)
11 gae_duplicate tensor(0.5075, dtype=torch.float64) tensor(-8.2569, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2284, dtype=torch.float64) delta_t tensor(0.2074, dtype=torch.float64)
10 gae_duplicate tensor(0.0249, dtype=torch.float64) tensor(-5.1799, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5496, dtype=torch.float64) delta_t tensor(0.3683, dtype=torch.float64)
9 gae_duplicate tensor(0.3044, dtype=torch.float64) tensor(-6.0208, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1869, dtype=torch.float64) delta_t tensor(0.0557, dtype=torch.float64)
8 gae_duplicate tensor(-0.1705, dtype=torch.float64) tensor(-0.8813, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4563, dtype=torch.float64) delta_t tensor(0.3448, dtype=torch.float64)
7 gae_duplicate tensor(0.0049, dtype=torch.float64) tensor(-5.4770, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0938, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
6 gae_duplicate tensor(-0.2238, dtype=torch.float64) tensor(0.0374, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4301, dtype=torch.float64) delta_t tensor(-1.0599, dtype=torch.float64)
5 gae_duplicate tensor(-1.8588, dtype=torch.float64) tensor(20.7874, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2650, dtype=torch.float64) delta_t tensor(-1.9688, dtype=torch.float64)
4 gae_duplicate tensor(-6.5091, dtype=torch.float64) tensor(24.1449, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0622, dtype=torch.float64) delta_t tensor(0.0966, dtype=torch.float64)
3 gae_duplicate tensor(-0.6786, dtype=torch.float64) tensor(1.8608, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1623, dtype=torch.float64) delta_t tensor(-0.0703, dtype=torch.float64)
2 gae_duplicate tensor(-0.4486, dtype=torch.float64) tensor(0.2342, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1445.19287109375
value loss:127.7275161743164
entropies:286.9937438964844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3560.4653)
ToM Target loss= tensor(2543.8081)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.114798069000244 seconds
19 rew tensor(0.5491, dtype=torch.float64) delta_t tensor(0.4602, dtype=torch.float64)
19 gae_duplicate tensor(0.3257, dtype=torch.float64) tensor(-8.1818, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2969, dtype=torch.float64) delta_t tensor(0.1242, dtype=torch.float64)
18 gae_duplicate tensor(-0.0008, dtype=torch.float64) tensor(-3.8931, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5257, dtype=torch.float64) delta_t tensor(0.4401, dtype=torch.float64)
17 gae_duplicate tensor(0.2655, dtype=torch.float64) tensor(-6.3922, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2742, dtype=torch.float64) delta_t tensor(0.1050, dtype=torch.float64)
16 gae_duplicate tensor(-0.0150, dtype=torch.float64) tensor(-3.1875, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5211, dtype=torch.float64) delta_t tensor(0.3337, dtype=torch.float64)
15 gae_duplicate tensor(0.0968, dtype=torch.float64) tensor(-6.0179, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2253, dtype=torch.float64) delta_t tensor(0.1748, dtype=torch.float64)
14 gae_duplicate tensor(-0.0062, dtype=torch.float64) tensor(-3.0930, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5291, dtype=torch.float64) delta_t tensor(0.5510, dtype=torch.float64)
13 gae_duplicate tensor(0.3725, dtype=torch.float64) tensor(-11.7445, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1974, dtype=torch.float64) delta_t tensor(0.1845, dtype=torch.float64)
12 gae_duplicate tensor(-0.0818, dtype=torch.float64) tensor(-4.0323, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5432, dtype=torch.float64) delta_t tensor(0.5558, dtype=torch.float64)
11 gae_duplicate tensor(0.4212, dtype=torch.float64) tensor(-8.6020, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2045, dtype=torch.float64) delta_t tensor(0.1803, dtype=torch.float64)
10 gae_duplicate tensor(-0.0078, dtype=torch.float64) tensor(-3.1971, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5038, dtype=torch.float64) delta_t tensor(0.3325, dtype=torch.float64)
9 gae_duplicate tensor(0.1316, dtype=torch.float64) tensor(-7.6732, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1236, dtype=torch.float64) delta_t tensor(-0.0109, dtype=torch.float64)
8 gae_duplicate tensor(-0.2487, dtype=torch.float64) tensor(-0.1871, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5081, dtype=torch.float64) delta_t tensor(0.3811, dtype=torch.float64)
7 gae_duplicate tensor(0.2808, dtype=torch.float64) tensor(-4.4322, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0356, dtype=torch.float64) delta_t tensor(-0.0424, dtype=torch.float64)
6 gae_duplicate tensor(-0.4440, dtype=torch.float64) tensor(0.7961, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3404, dtype=torch.float64) delta_t tensor(-0.9870, dtype=torch.float64)
5 gae_duplicate tensor(-2.8289, dtype=torch.float64) tensor(10.6756, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7466, dtype=torch.float64) delta_t tensor(-2.4541, dtype=torch.float64)
4 gae_duplicate tensor(-4.6515, dtype=torch.float64) tensor(31.9937, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0129, dtype=torch.float64) delta_t tensor(0.1710, dtype=torch.float64)
3 gae_duplicate tensor(-0.4972, dtype=torch.float64) tensor(1.6243, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2724, dtype=torch.float64) delta_t tensor(-0.1954, dtype=torch.float64)
2 gae_duplicate tensor(-0.4898, dtype=torch.float64) tensor(2.8344, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1149.9940185546875
value loss:123.71835327148438
entropies:282.7309875488281
Policy training finished
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 809, in _callmethod
    conn.send((self._id, methodname, args, kwds))
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 206, in send
    self._send_bytes(_ForkingPickler.dumps(obj))
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
KeyboardInterrupt