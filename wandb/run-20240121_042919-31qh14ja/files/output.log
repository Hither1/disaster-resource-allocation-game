obs <crafter.objects.Shelter object at 0x13ab9ce50> [39  0 39  0 12  0]
obs <crafter.objects.Warehouse object at 0x13abab910> [38  0 40  0  9  0]
obs <crafter.objects.Station object at 0x13abab310> [9 0 9 0 7 0]
obs <crafter.objects.Shelter object at 0x13ab9ce50> [39  0 39  0 10  0]
obs <crafter.objects.Warehouse object at 0x13abab910> [43  0 39  0  9  0]
obs <crafter.objects.Station object at 0x13abab310> [ 9  0  9  0 13  0]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0030591487884521484 seconds
19 rew tensor(0.5357, dtype=torch.float64) delta_t tensor(0.4610, dtype=torch.float64)
19 gae_duplicate tensor(0.2865, dtype=torch.float64) tensor(-9.1758, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4527, dtype=torch.float64) delta_t tensor(0.4270, dtype=torch.float64)
18 gae_duplicate tensor(0.2750, dtype=torch.float64) tensor(-9.2174, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5706, dtype=torch.float64) delta_t tensor(0.5834, dtype=torch.float64)
17 gae_duplicate tensor(0.3541, dtype=torch.float64) tensor(-12.4892, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3920, dtype=torch.float64) delta_t tensor(0.4152, dtype=torch.float64)
16 gae_duplicate tensor(0.3220, dtype=torch.float64) tensor(-9.4999, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5733, dtype=torch.float64) delta_t tensor(0.6820, dtype=torch.float64)
15 gae_duplicate tensor(0.4951, dtype=torch.float64) tensor(-14.4364, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3981, dtype=torch.float64) delta_t tensor(0.4104, dtype=torch.float64)
14 gae_duplicate tensor(0.3842, dtype=torch.float64) tensor(-9.7189, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6203, dtype=torch.float64) delta_t tensor(0.6835, dtype=torch.float64)
13 gae_duplicate tensor(0.3759, dtype=torch.float64) tensor(-14.7458, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4328, dtype=torch.float64) delta_t tensor(0.4301, dtype=torch.float64)
12 gae_duplicate tensor(0.4062, dtype=torch.float64) tensor(-9.9119, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6759, dtype=torch.float64) delta_t tensor(0.6774, dtype=torch.float64)
11 gae_duplicate tensor(0.4307, dtype=torch.float64) tensor(-14.3686, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5118, dtype=torch.float64) delta_t tensor(0.5170, dtype=torch.float64)
10 gae_duplicate tensor(0.4851, dtype=torch.float64) tensor(-11.8200, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.7467, dtype=torch.float64) delta_t tensor(0.7164, dtype=torch.float64)
9 gae_duplicate tensor(0.4296, dtype=torch.float64) tensor(-15.1983, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5692, dtype=torch.float64) delta_t tensor(0.5463, dtype=torch.float64)
8 gae_duplicate tensor(0.4925, dtype=torch.float64) tensor(-12.4865, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.8080, dtype=torch.float64) delta_t tensor(0.8204, dtype=torch.float64)
7 gae_duplicate tensor(0.3628, dtype=torch.float64) tensor(-17.6287, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6623, dtype=torch.float64) delta_t tensor(0.6134, dtype=torch.float64)
6 gae_duplicate tensor(0.3247, dtype=torch.float64) tensor(-13.6744, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7584, dtype=torch.float64) delta_t tensor(-0.6278, dtype=torch.float64)
5 gae_duplicate tensor(-1.7051, dtype=torch.float64) tensor(10.9091, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3776, dtype=torch.float64) delta_t tensor(-1.3127, dtype=torch.float64)
4 gae_duplicate tensor(-1.8484, dtype=torch.float64) tensor(26.9316, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2500, dtype=torch.float64) delta_t tensor(0.2092, dtype=torch.float64)
3 gae_duplicate tensor(-0.3111, dtype=torch.float64) tensor(-1.5916, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0., dtype=torch.float64) delta_t tensor(-0.1283, dtype=torch.float64)
2 gae_duplicate tensor(-0.2119, dtype=torch.float64) tensor(2.3740, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:7234.51416015625
value loss:90.77510070800781
entropies:355.2434997558594
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 5.131486892700195 seconds
19 rew tensor(0.4896, dtype=torch.float64) delta_t tensor(0.4486, dtype=torch.float64)
19 gae_duplicate tensor(0.3198, dtype=torch.float64) tensor(-8.9007, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3474, dtype=torch.float64) delta_t tensor(0.2893, dtype=torch.float64)
18 gae_duplicate tensor(0.1813, dtype=torch.float64) tensor(-6.5551, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4915, dtype=torch.float64) delta_t tensor(0.5496, dtype=torch.float64)
17 gae_duplicate tensor(0.4142, dtype=torch.float64) tensor(-11.6661, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3095, dtype=torch.float64) delta_t tensor(0.3663, dtype=torch.float64)
16 gae_duplicate tensor(0.1994, dtype=torch.float64) tensor(-8.3491, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5035, dtype=torch.float64) delta_t tensor(0.6112, dtype=torch.float64)
15 gae_duplicate tensor(0.6069, dtype=torch.float64) tensor(-12.8726, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2780, dtype=torch.float64) delta_t tensor(0.2955, dtype=torch.float64)
14 gae_duplicate tensor(0.2383, dtype=torch.float64) tensor(-7.0598, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5134, dtype=torch.float64) delta_t tensor(0.5507, dtype=torch.float64)
13 gae_duplicate tensor(0.5023, dtype=torch.float64) tensor(-11.4056, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2926, dtype=torch.float64) delta_t tensor(0.2863, dtype=torch.float64)
12 gae_duplicate tensor(0.2370, dtype=torch.float64) tensor(-6.7955, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5323, dtype=torch.float64) delta_t tensor(0.5292, dtype=torch.float64)
11 gae_duplicate tensor(0.4895, dtype=torch.float64) tensor(-11.0322, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3112, dtype=torch.float64) delta_t tensor(0.3014, dtype=torch.float64)
10 gae_duplicate tensor(0.2168, dtype=torch.float64) tensor(-7.0788, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5454, dtype=torch.float64) delta_t tensor(0.5165, dtype=torch.float64)
9 gae_duplicate tensor(0.4571, dtype=torch.float64) tensor(-10.7708, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3005, dtype=torch.float64) delta_t tensor(0.2687, dtype=torch.float64)
8 gae_duplicate tensor(0.1785, dtype=torch.float64) tensor(-6.3785, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5139, dtype=torch.float64) delta_t tensor(0.5236, dtype=torch.float64)
7 gae_duplicate tensor(0.3084, dtype=torch.float64) tensor(-11.0998, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2765, dtype=torch.float64) delta_t tensor(0.2226, dtype=torch.float64)
6 gae_duplicate tensor(0.0137, dtype=torch.float64) tensor(-5.4318, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8485, dtype=torch.float64) delta_t tensor(-0.7038, dtype=torch.float64)
5 gae_duplicate tensor(-1.0624, dtype=torch.float64) tensor(13.2995, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9165, dtype=torch.float64) delta_t tensor(-2.8362, dtype=torch.float64)
4 gae_duplicate tensor(-4.7134, dtype=torch.float64) tensor(57.2951, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0587, dtype=torch.float64) delta_t tensor(-0.1301, dtype=torch.float64)
3 gae_duplicate tensor(-0.7945, dtype=torch.float64) tensor(8.2042, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1261, dtype=torch.float64) delta_t tensor(-0.2563, dtype=torch.float64)
2 gae_duplicate tensor(-0.4720, dtype=torch.float64) tensor(5.8638, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2103.57080078125
value loss:133.60952758789062
entropies:355.77197265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.86811089515686 seconds
19 rew tensor(0.5099, dtype=torch.float64) delta_t tensor(0.5093, dtype=torch.float64)
19 gae_duplicate tensor(0.3624, dtype=torch.float64) tensor(-10.0297, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3407, dtype=torch.float64) delta_t tensor(0.2890, dtype=torch.float64)
18 gae_duplicate tensor(0.2718, dtype=torch.float64) tensor(-6.6733, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5173, dtype=torch.float64) delta_t tensor(0.4693, dtype=torch.float64)
17 gae_duplicate tensor(0.3976, dtype=torch.float64) tensor(-10.0937, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3461, dtype=torch.float64) delta_t tensor(0.3044, dtype=torch.float64)
16 gae_duplicate tensor(0.1854, dtype=torch.float64) tensor(-7.0122, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4889, dtype=torch.float64) delta_t tensor(0.4583, dtype=torch.float64)
15 gae_duplicate tensor(0.2008, dtype=torch.float64) tensor(-9.8283, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3091, dtype=torch.float64) delta_t tensor(0.2986, dtype=torch.float64)
14 gae_duplicate tensor(0.1905, dtype=torch.float64) tensor(-6.9393, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5168, dtype=torch.float64) delta_t tensor(0.6326, dtype=torch.float64)
13 gae_duplicate tensor(0.5317, dtype=torch.float64) tensor(-13.2642, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2568, dtype=torch.float64) delta_t tensor(0.2880, dtype=torch.float64)
12 gae_duplicate tensor(0.1002, dtype=torch.float64) tensor(-7.0240, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5261, dtype=torch.float64) delta_t tensor(0.5583, dtype=torch.float64)
11 gae_duplicate tensor(0.4581, dtype=torch.float64) tensor(-11.7316, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2889, dtype=torch.float64) delta_t tensor(0.3052, dtype=torch.float64)
10 gae_duplicate tensor(0.0878, dtype=torch.float64) tensor(-7.2480, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5403, dtype=torch.float64) delta_t tensor(0.5371, dtype=torch.float64)
9 gae_duplicate tensor(0.4629, dtype=torch.float64) tensor(-11.1724, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2666, dtype=torch.float64) delta_t tensor(0.2648, dtype=torch.float64)
8 gae_duplicate tensor(0.0124, dtype=torch.float64) tensor(-6.3053, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4941, dtype=torch.float64) delta_t tensor(0.5149, dtype=torch.float64)
7 gae_duplicate tensor(0.2876, dtype=torch.float64) tensor(-10.9590, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2248, dtype=torch.float64) delta_t tensor(0.2146, dtype=torch.float64)
6 gae_duplicate tensor(-0.2281, dtype=torch.float64) tensor(-5.3830, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0633, dtype=torch.float64) delta_t tensor(-0.9279, dtype=torch.float64)
5 gae_duplicate tensor(-1.3730, dtype=torch.float64) tensor(17.7699, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6198, dtype=torch.float64) delta_t tensor(-2.5554, dtype=torch.float64)
4 gae_duplicate tensor(-4.4446, dtype=torch.float64) tensor(52.4033, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0040, dtype=torch.float64) delta_t tensor(-0.0912, dtype=torch.float64)
3 gae_duplicate tensor(-0.6621, dtype=torch.float64) tensor(7.0389, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1231, dtype=torch.float64) delta_t tensor(-0.2350, dtype=torch.float64)
2 gae_duplicate tensor(-0.4569, dtype=torch.float64) tensor(5.3058, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2125.82568359375
value loss:121.39537811279297
entropies:355.76593017578125
Policy training finished
---------------------
gamma: 0.1
10 rew tensor(0.2546, dtype=torch.float64) delta_t tensor(0.2405, dtype=torch.float64)4, grad_fn=<SumBackward0>)
10 gae_duplicate tensor(0.1389, dtype=torch.float64) tensor(-5.8520, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5338, dtype=torch.float64) delta_t tensor(0.5083, dtype=torch.float64)
9 gae_duplicate tensor(0.4042, dtype=torch.float64) tensor(-10.7322, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2313, dtype=torch.float64) delta_t tensor(0.2006, dtype=torch.float64)
8 gae_duplicate tensor(0.0675, dtype=torch.float64) tensor(-5.0429, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4969, dtype=torch.float64) delta_t tensor(0.5103, dtype=torch.float64)
7 gae_duplicate tensor(0.4071, dtype=torch.float64) tensor(-10.6145, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2029, dtype=torch.float64) delta_t tensor(0.1548, dtype=torch.float64)
6 gae_duplicate tensor(0.0366, dtype=torch.float64) tensor(-4.1380, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8489, dtype=torch.float64) delta_t tensor(-0.6989, dtype=torch.float64)
5 gae_duplicate tensor(-1.1739, dtype=torch.float64) tensor(13.2854, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1081, dtype=torch.float64) delta_t tensor(-2.0274, dtype=torch.float64)
4 gae_duplicate tensor(-4.3601, dtype=torch.float64) tensor(41.9984, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0263, dtype=torch.float64) delta_t tensor(-0.0954, dtype=torch.float64)
3 gae_duplicate tensor(-0.6770, dtype=torch.float64) tensor(5.9916, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1592, dtype=torch.float64) delta_t tensor(-0.2943, dtype=torch.float64)
2 gae_duplicate tensor(-0.4635, dtype=torch.float64) tensor(6.4684, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2385.088623046875
value loss:101.68569946289062
entropies:355.871337890625
Policy training finished
---------------------
gamma: 0.1
4 gae_duplicate tensor(-4.4934, dtype=torch.float64) tensor(63.1073, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4795, dtype=torch.float64) delta_t tensor(0.4183, dtype=torch.float64)
17 gae_duplicate tensor(0.2564, dtype=torch.float64) tensor(-8.9306, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3324, dtype=torch.float64) delta_t tensor(0.3354, dtype=torch.float64)
16 gae_duplicate tensor(0.1982, dtype=torch.float64) tensor(-7.5296, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4943, dtype=torch.float64) delta_t tensor(0.6577, dtype=torch.float64)
15 gae_duplicate tensor(0.6437, dtype=torch.float64) tensor(-13.6453, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2801, dtype=torch.float64) delta_t tensor(0.2963, dtype=torch.float64)
14 gae_duplicate tensor(0.2806, dtype=torch.float64) tensor(-7.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5288, dtype=torch.float64) delta_t tensor(0.5784, dtype=torch.float64)
13 gae_duplicate tensor(0.5350, dtype=torch.float64) tensor(-12.2501, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3045, dtype=torch.float64) delta_t tensor(0.2673, dtype=torch.float64)
12 gae_duplicate tensor(0.2502, dtype=torch.float64) tensor(-6.5507, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5254, dtype=torch.float64) delta_t tensor(0.5547, dtype=torch.float64)
11 gae_duplicate tensor(0.4692, dtype=torch.float64) tensor(-11.6124, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3031, dtype=torch.float64) delta_t tensor(0.2960, dtype=torch.float64)
10 gae_duplicate tensor(0.2691, dtype=torch.float64) tensor(-7.0247, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5055, dtype=torch.float64) delta_t tensor(0.4842, dtype=torch.float64)
9 gae_duplicate tensor(0.2995, dtype=torch.float64) tensor(-10.2628, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2477, dtype=torch.float64) delta_t tensor(0.2425, dtype=torch.float64)
8 gae_duplicate tensor(0.0177, dtype=torch.float64) tensor(-5.8240, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5035, dtype=torch.float64) delta_t tensor(0.5456, dtype=torch.float64)
7 gae_duplicate tensor(0.4734, dtype=torch.float64) tensor(-11.4339, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1852, dtype=torch.float64) delta_t tensor(0.1406, dtype=torch.float64)
6 gae_duplicate tensor(-0.2728, dtype=torch.float64) tensor(-3.9355, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2945, dtype=torch.float64) delta_t tensor(-1.1441, dtype=torch.float64)
5 gae_duplicate tensor(-2.3139, dtype=torch.float64) tensor(22.1320, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1260, dtype=torch.float64) delta_t tensor(-3.0587, dtype=torch.float64)
4 gae_duplicate tensor(-4.4934, dtype=torch.float64) tensor(63.1073, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0338, dtype=torch.float64) delta_t tensor(-0.1004, dtype=torch.float64)
3 gae_duplicate tensor(-0.7263, dtype=torch.float64) tensor(8.1599, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1771, dtype=torch.float64) delta_t tensor(-0.3083, dtype=torch.float64)
2 gae_duplicate tensor(-0.6194, dtype=torch.float64) tensor(7.0088, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1061.708984375
value loss:148.87741088867188
entropies:355.8616943359375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3958.4238)
ToM Target loss= tensor(2578.9463)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.922343969345093 seconds
19 rew tensor(0.4646, dtype=torch.float64) delta_t tensor(0.3862, dtype=torch.float64)
19 gae_duplicate tensor(0.2026, dtype=torch.float64) tensor(-7.6898, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3393, dtype=torch.float64) delta_t tensor(0.3017, dtype=torch.float64)
18 gae_duplicate tensor(0.0130, dtype=torch.float64) tensor(-6.7475, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5095, dtype=torch.float64) delta_t tensor(0.4761, dtype=torch.float64)
17 gae_duplicate tensor(0.3842, dtype=torch.float64) tensor(-9.9557, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2067, dtype=torch.float64) delta_t tensor(0.1492, dtype=torch.float64)
16 gae_duplicate tensor(0.0186, dtype=torch.float64) tensor(-3.9160, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5082, dtype=torch.float64) delta_t tensor(0.6519, dtype=torch.float64)
15 gae_duplicate tensor(0.6071, dtype=torch.float64) tensor(-13.2069, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0814, dtype=torch.float64) delta_t tensor(0.1119, dtype=torch.float64)
14 gae_duplicate tensor(-0.0213, dtype=torch.float64) tensor(-3.5126, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5257, dtype=torch.float64) delta_t tensor(0.5972, dtype=torch.float64)
13 gae_duplicate tensor(0.5712, dtype=torch.float64) tensor(-12.1637, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1181, dtype=torch.float64) delta_t tensor(0.0938, dtype=torch.float64)
12 gae_duplicate tensor(-0.0096, dtype=torch.float64) tensor(-3.0616, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5353, dtype=torch.float64) delta_t tensor(0.5184, dtype=torch.float64)
11 gae_duplicate tensor(0.4294, dtype=torch.float64) tensor(-10.5645, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1230, dtype=torch.float64) delta_t tensor(0.0966, dtype=torch.float64)
10 gae_duplicate tensor(-0.0619, dtype=torch.float64) tensor(-2.9680, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5110, dtype=torch.float64) delta_t tensor(0.4669, dtype=torch.float64)
9 gae_duplicate tensor(0.3793, dtype=torch.float64) tensor(-9.4959, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0638, dtype=torch.float64) delta_t tensor(0.0097, dtype=torch.float64)
8 gae_duplicate tensor(-0.0751, dtype=torch.float64) tensor(-1.1364, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4874, dtype=torch.float64) delta_t tensor(0.4995, dtype=torch.float64)
7 gae_duplicate tensor(0.3931, dtype=torch.float64) tensor(-9.9494, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0080, dtype=torch.float64) delta_t tensor(-0.0894, dtype=torch.float64)
6 gae_duplicate tensor(-0.3164, dtype=torch.float64) tensor(0.7632, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0036, dtype=torch.float64) delta_t tensor(-0.8632, dtype=torch.float64)
5 gae_duplicate tensor(-2.3163, dtype=torch.float64) tensor(17.2989, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.2998, dtype=torch.float64) delta_t tensor(-3.2310, dtype=torch.float64)
4 gae_duplicate tensor(-5.8356, dtype=torch.float64) tensor(65.2295, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0727, dtype=torch.float64) delta_t tensor(-0.1458, dtype=torch.float64)
3 gae_duplicate tensor(-0.7388, dtype=torch.float64) tensor(9.4827, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1439, dtype=torch.float64) delta_t tensor(-0.2930, dtype=torch.float64)
2 gae_duplicate tensor(-0.5352, dtype=torch.float64) tensor(6.8504, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-379.91839599609375
value loss:150.3557891845703
entropies:355.77313232421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.629467964172363 seconds
19 rew tensor(0.4860, dtype=torch.float64) delta_t tensor(0.4656, dtype=torch.float64)
19 gae_duplicate tensor(0.2469, dtype=torch.float64) tensor(-9.1266, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3175, dtype=torch.float64) delta_t tensor(0.2558, dtype=torch.float64)
18 gae_duplicate tensor(0.2154, dtype=torch.float64) tensor(-5.9305, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5190, dtype=torch.float64) delta_t tensor(0.4834, dtype=torch.float64)
17 gae_duplicate tensor(0.3116, dtype=torch.float64) tensor(-10.2526, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1711, dtype=torch.float64) delta_t tensor(0.1936, dtype=torch.float64)
16 gae_duplicate tensor(-0.0620, dtype=torch.float64) tensor(-4.8050, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5141, dtype=torch.float64) delta_t tensor(0.5935, dtype=torch.float64)
15 gae_duplicate tensor(0.4771, dtype=torch.float64) tensor(-12.4337, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2572, dtype=torch.float64) delta_t tensor(0.2704, dtype=torch.float64)
14 gae_duplicate tensor(0.2067, dtype=torch.float64) tensor(-6.5772, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5354, dtype=torch.float64) delta_t tensor(0.5888, dtype=torch.float64)
13 gae_duplicate tensor(0.5798, dtype=torch.float64) tensor(-12.3456, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2622, dtype=torch.float64) delta_t tensor(0.2251, dtype=torch.float64)
12 gae_duplicate tensor(0.0967, dtype=torch.float64) tensor(-5.6816, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5301, dtype=torch.float64) delta_t tensor(0.5439, dtype=torch.float64)
11 gae_duplicate tensor(0.4430, dtype=torch.float64) tensor(-11.2993, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2526, dtype=torch.float64) delta_t tensor(0.2258, dtype=torch.float64)
10 gae_duplicate tensor(0.0654, dtype=torch.float64) tensor(-5.5784, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5468, dtype=torch.float64) delta_t tensor(0.5042, dtype=torch.float64)
9 gae_duplicate tensor(0.4216, dtype=torch.float64) tensor(-10.5110, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2322, dtype=torch.float64) delta_t tensor(0.2011, dtype=torch.float64)
8 gae_duplicate tensor(-0.0299, dtype=torch.float64) tensor(-4.9526, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5105, dtype=torch.float64) delta_t tensor(0.5201, dtype=torch.float64)
7 gae_duplicate tensor(0.4498, dtype=torch.float64) tensor(-10.6705, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1977, dtype=torch.float64) delta_t tensor(0.1798, dtype=torch.float64)
6 gae_duplicate tensor(-0.0028, dtype=torch.float64) tensor(-4.6689, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1622, dtype=torch.float64) delta_t tensor(-1.0025, dtype=torch.float64)
5 gae_duplicate tensor(-1.3123, dtype=torch.float64) tensor(19.6428, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6093, dtype=torch.float64) delta_t tensor(-2.4969, dtype=torch.float64)
4 gae_duplicate tensor(-4.4350, dtype=torch.float64) tensor(50.7927, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0228, dtype=torch.float64) delta_t tensor(0.0182, dtype=torch.float64)
3 gae_duplicate tensor(-0.6373, dtype=torch.float64) tensor(4.8071, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2683, dtype=torch.float64) delta_t tensor(-0.4057, dtype=torch.float64)
2 gae_duplicate tensor(-0.5882, dtype=torch.float64) tensor(8.5689, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1579.17041015625
value loss:122.26367950439453
entropies:355.6077575683594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.582364082336426 seconds
19 rew tensor(0.4965, dtype=torch.float64) delta_t tensor(0.4813, dtype=torch.float64)
19 gae_duplicate tensor(0.3029, dtype=torch.float64) tensor(-9.3594, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4779, dtype=torch.float64) delta_t tensor(0.4568, dtype=torch.float64)
18 gae_duplicate tensor(0.2758, dtype=torch.float64) tensor(-10.2120, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4356, dtype=torch.float64) delta_t tensor(0.4025, dtype=torch.float64)
17 gae_duplicate tensor(0.2011, dtype=torch.float64) tensor(-8.9544, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4435, dtype=torch.float64) delta_t tensor(0.5840, dtype=torch.float64)
16 gae_duplicate tensor(0.1897, dtype=torch.float64) tensor(-12.4195, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5300, dtype=torch.float64) delta_t tensor(0.6616, dtype=torch.float64)
15 gae_duplicate tensor(0.4696, dtype=torch.float64) tensor(-14.5348, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3071, dtype=torch.float64) delta_t tensor(0.3382, dtype=torch.float64)
14 gae_duplicate tensor(0.1739, dtype=torch.float64) tensor(-8.2617, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5591, dtype=torch.float64) delta_t tensor(0.6414, dtype=torch.float64)
13 gae_duplicate tensor(0.5510, dtype=torch.float64) tensor(-13.5586, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3049, dtype=torch.float64) delta_t tensor(0.3340, dtype=torch.float64)
12 gae_duplicate tensor(0.2000, dtype=torch.float64) tensor(-8.0397, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4036, dtype=torch.float64) delta_t tensor(0.4487, dtype=torch.float64)
11 gae_duplicate tensor(0.0502, dtype=torch.float64) tensor(-9.5349, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1627, dtype=torch.float64) delta_t tensor(0.1790, dtype=torch.float64)
10 gae_duplicate tensor(-0.0556, dtype=torch.float64) tensor(-4.5638, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2081, dtype=torch.float64) delta_t tensor(-0.2006, dtype=torch.float64)
9 gae_duplicate tensor(-3.8084, dtype=torch.float64) tensor(3.4728, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0865, dtype=torch.float64) delta_t tensor(0.0820, dtype=torch.float64)
8 gae_duplicate tensor(-0.8275, dtype=torch.float64) tensor(-1.4415, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4846, dtype=torch.float64) delta_t tensor(0.5307, dtype=torch.float64)
7 gae_duplicate tensor(0.3996, dtype=torch.float64) tensor(-10.6959, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0656, dtype=torch.float64) delta_t tensor(0.0503, dtype=torch.float64)
6 gae_duplicate tensor(-0.3636, dtype=torch.float64) tensor(-2.1390, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1245, dtype=torch.float64) delta_t tensor(-0.9671, dtype=torch.float64)
5 gae_duplicate tensor(-1.4230, dtype=torch.float64) tensor(18.5725, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0529, dtype=torch.float64) delta_t tensor(-1.9968, dtype=torch.float64)
4 gae_duplicate tensor(-5.3918, dtype=torch.float64) tensor(40.7336, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0102, dtype=torch.float64) delta_t tensor(-0.0398, dtype=torch.float64)
3 gae_duplicate tensor(-0.6687, dtype=torch.float64) tensor(5.0614, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2940, dtype=torch.float64) delta_t tensor(-0.4116, dtype=torch.float64)
2 gae_duplicate tensor(-0.8059, dtype=torch.float64) tensor(8.6599, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1913.6842041015625
value loss:135.4628143310547
entropies:355.23858642578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.460417032241821 seconds
19 rew tensor(0.4797, dtype=torch.float64) delta_t tensor(0.4515, dtype=torch.float64)
19 gae_duplicate tensor(0.2779, dtype=torch.float64) tensor(-8.8525, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4364, dtype=torch.float64) delta_t tensor(0.3973, dtype=torch.float64)
18 gae_duplicate tensor(0.2155, dtype=torch.float64) tensor(-8.8387, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5116, dtype=torch.float64) delta_t tensor(0.4622, dtype=torch.float64)
17 gae_duplicate tensor(0.2946, dtype=torch.float64) tensor(-9.9719, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3947, dtype=torch.float64) delta_t tensor(0.3734, dtype=torch.float64)
16 gae_duplicate tensor(0.0461, dtype=torch.float64) tensor(-8.6270, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5256, dtype=torch.float64) delta_t tensor(0.5532, dtype=torch.float64)
15 gae_duplicate tensor(0.2776, dtype=torch.float64) tensor(-11.9626, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2443, dtype=torch.float64) delta_t tensor(0.2718, dtype=torch.float64)
14 gae_duplicate tensor(0.1669, dtype=torch.float64) tensor(-6.7196, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5369, dtype=torch.float64) delta_t tensor(0.6214, dtype=torch.float64)
13 gae_duplicate tensor(0.5286, dtype=torch.float64) tensor(-12.6967, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1893, dtype=torch.float64) delta_t tensor(0.1760, dtype=torch.float64)
12 gae_duplicate tensor(0.1156, dtype=torch.float64) tensor(-4.7294, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5594, dtype=torch.float64) delta_t tensor(0.5352, dtype=torch.float64)
11 gae_duplicate tensor(0.4887, dtype=torch.float64) tensor(-11.0876, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2006, dtype=torch.float64) delta_t tensor(0.1568, dtype=torch.float64)
10 gae_duplicate tensor(0.0219, dtype=torch.float64) tensor(-4.1154, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5612, dtype=torch.float64) delta_t tensor(0.5146, dtype=torch.float64)
9 gae_duplicate tensor(0.4575, dtype=torch.float64) tensor(-10.3459, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1632, dtype=torch.float64) delta_t tensor(0.1210, dtype=torch.float64)
8 gae_duplicate tensor(0.0313, dtype=torch.float64) tensor(-3.5371, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4909, dtype=torch.float64) delta_t tensor(0.4831, dtype=torch.float64)
7 gae_duplicate tensor(0.3874, dtype=torch.float64) tensor(-10.0742, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0945, dtype=torch.float64) delta_t tensor(0.0422, dtype=torch.float64)
6 gae_duplicate tensor(-0.3244, dtype=torch.float64) tensor(-1.8637, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4033, dtype=torch.float64) delta_t tensor(-1.2541, dtype=torch.float64)
5 gae_duplicate tensor(-1.5328, dtype=torch.float64) tensor(24.8769, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0597, dtype=torch.float64) delta_t tensor(-1.9525, dtype=torch.float64)
4 gae_duplicate tensor(-4.4685, dtype=torch.float64) tensor(42.3085, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0113, dtype=torch.float64) delta_t tensor(-0.0096, dtype=torch.float64)
3 gae_duplicate tensor(-0.4998, dtype=torch.float64) tensor(4.2449, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2156, dtype=torch.float64) delta_t tensor(-0.3694, dtype=torch.float64)
2 gae_duplicate tensor(-0.5943, dtype=torch.float64) tensor(7.3022, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1777.371337890625
value loss:97.53832244873047
entropies:355.05621337890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.774676084518433 seconds
19 rew tensor(0.5183, dtype=torch.float64) delta_t tensor(0.4450, dtype=torch.float64)
19 gae_duplicate tensor(0.3915, dtype=torch.float64) tensor(-8.8178, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4478, dtype=torch.float64) delta_t tensor(0.3718, dtype=torch.float64)
18 gae_duplicate tensor(0.3209, dtype=torch.float64) tensor(-8.2303, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4862, dtype=torch.float64) delta_t tensor(0.4690, dtype=torch.float64)
17 gae_duplicate tensor(0.3749, dtype=torch.float64) tensor(-10.0855, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3668, dtype=torch.float64) delta_t tensor(0.4442, dtype=torch.float64)
16 gae_duplicate tensor(0.2944, dtype=torch.float64) tensor(-9.8100, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5168, dtype=torch.float64) delta_t tensor(0.6072, dtype=torch.float64)
15 gae_duplicate tensor(0.4950, dtype=torch.float64) tensor(-13.0562, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2954, dtype=torch.float64) delta_t tensor(0.2852, dtype=torch.float64)
14 gae_duplicate tensor(0.1035, dtype=torch.float64) tensor(-6.8526, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4732, dtype=torch.float64) delta_t tensor(0.5561, dtype=torch.float64)
13 gae_duplicate tensor(0.5367, dtype=torch.float64) tensor(-11.4840, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3014, dtype=torch.float64) delta_t tensor(0.3610, dtype=torch.float64)
12 gae_duplicate tensor(0.1209, dtype=torch.float64) tensor(-8.2654, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4497, dtype=torch.float64) delta_t tensor(0.4930, dtype=torch.float64)
11 gae_duplicate tensor(0.2006, dtype=torch.float64) tensor(-10.4321, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2828, dtype=torch.float64) delta_t tensor(0.3323, dtype=torch.float64)
10 gae_duplicate tensor(0.0414, dtype=torch.float64) tensor(-7.6546, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4516, dtype=torch.float64) delta_t tensor(0.4687, dtype=torch.float64)
9 gae_duplicate tensor(0.1515, dtype=torch.float64) tensor(-9.7830, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2460, dtype=torch.float64) delta_t tensor(0.2653, dtype=torch.float64)
8 gae_duplicate tensor(0.0320, dtype=torch.float64) tensor(-5.9681, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3789, dtype=torch.float64) delta_t tensor(0.4484, dtype=torch.float64)
7 gae_duplicate tensor(0.2015, dtype=torch.float64) tensor(-9.8029, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1660, dtype=torch.float64) delta_t tensor(0.1647, dtype=torch.float64)
6 gae_duplicate tensor(-0.3555, dtype=torch.float64) tensor(-4.4350, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9250, dtype=torch.float64) delta_t tensor(-0.8103, dtype=torch.float64)
5 gae_duplicate tensor(-1.1661, dtype=torch.float64) tensor(15.2820, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6444, dtype=torch.float64) delta_t tensor(-3.6172, dtype=torch.float64)
4 gae_duplicate tensor(-9.6631, dtype=torch.float64) tensor(74.9217, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0708, dtype=torch.float64) delta_t tensor(-0.1874, dtype=torch.float64)
3 gae_duplicate tensor(-1.0119, dtype=torch.float64) tensor(10.4342, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1110, dtype=torch.float64) delta_t tensor(-0.1915, dtype=torch.float64)
2 gae_duplicate tensor(-0.4548, dtype=torch.float64) tensor(4.8254, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:941.7947387695312
value loss:262.87139892578125
entropies:354.6946105957031
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3948.9817)
ToM Target loss= tensor(2593.2300)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.919210910797119 seconds
19 rew tensor(0.5269, dtype=torch.float64) delta_t tensor(0.4599, dtype=torch.float64)
19 gae_duplicate tensor(0.3484, dtype=torch.float64) tensor(-9.1787, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4364, dtype=torch.float64) delta_t tensor(0.4106, dtype=torch.float64)
18 gae_duplicate tensor(0.2200, dtype=torch.float64) tensor(-8.8822, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5362, dtype=torch.float64) delta_t tensor(0.5620, dtype=torch.float64)
17 gae_duplicate tensor(0.4829, dtype=torch.float64) tensor(-11.5661, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3416, dtype=torch.float64) delta_t tensor(0.3772, dtype=torch.float64)
16 gae_duplicate tensor(-0.0748, dtype=torch.float64) tensor(-8.4818, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4811, dtype=torch.float64) delta_t tensor(0.5399, dtype=torch.float64)
15 gae_duplicate tensor(0.4633, dtype=torch.float64) tensor(-11.4164, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2406, dtype=torch.float64) delta_t tensor(0.2929, dtype=torch.float64)
14 gae_duplicate tensor(0.0064, dtype=torch.float64) tensor(-6.7924, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4229, dtype=torch.float64) delta_t tensor(0.4986, dtype=torch.float64)
13 gae_duplicate tensor(0.1738, dtype=torch.float64) tensor(-10.4057, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2211, dtype=torch.float64) delta_t tensor(0.2402, dtype=torch.float64)
12 gae_duplicate tensor(-0.1259, dtype=torch.float64) tensor(-5.8171, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4370, dtype=torch.float64) delta_t tensor(0.4432, dtype=torch.float64)
11 gae_duplicate tensor(0.1745, dtype=torch.float64) tensor(-9.4039, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2293, dtype=torch.float64) delta_t tensor(0.2136, dtype=torch.float64)
10 gae_duplicate tensor(-0.2974, dtype=torch.float64) tensor(-5.0115, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4385, dtype=torch.float64) delta_t tensor(0.4157, dtype=torch.float64)
9 gae_duplicate tensor(0.1379, dtype=torch.float64) tensor(-8.5823, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1289, dtype=torch.float64) delta_t tensor(0.1052, dtype=torch.float64)
8 gae_duplicate tensor(-0.2355, dtype=torch.float64) tensor(-2.8268, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3017, dtype=torch.float64) delta_t tensor(0.2865, dtype=torch.float64)
7 gae_duplicate tensor(-0.1534, dtype=torch.float64) tensor(-5.9216, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0839, dtype=torch.float64) delta_t tensor(-0.1457, dtype=torch.float64)
6 gae_duplicate tensor(-0.5422, dtype=torch.float64) tensor(2.2049, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0325, dtype=torch.float64) delta_t tensor(-0.9643, dtype=torch.float64)
5 gae_duplicate tensor(-1.8709, dtype=torch.float64) tensor(18.8260, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0301, dtype=torch.float64) delta_t tensor(-4.0165, dtype=torch.float64)
4 gae_duplicate tensor(-6.9534, dtype=torch.float64) tensor(79.7509, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0086, dtype=torch.float64) delta_t tensor(-0.1013, dtype=torch.float64)
3 gae_duplicate tensor(-0.7627, dtype=torch.float64) tensor(9.7960, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0086, dtype=torch.float64) delta_t tensor(-0.1475, dtype=torch.float64)
2 gae_duplicate tensor(-0.5306, dtype=torch.float64) tensor(3.9987, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-651.3140869140625
value loss:216.65606689453125
entropies:354.23687744140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.134619951248169 seconds
19 rew tensor(0.4811, dtype=torch.float64) delta_t tensor(0.4611, dtype=torch.float64)
19 gae_duplicate tensor(0.3357, dtype=torch.float64) tensor(-9.0776, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3643, dtype=torch.float64) delta_t tensor(0.3134, dtype=torch.float64)
18 gae_duplicate tensor(0.2083, dtype=torch.float64) tensor(-7.2597, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5105, dtype=torch.float64) delta_t tensor(0.5214, dtype=torch.float64)
17 gae_duplicate tensor(0.4392, dtype=torch.float64) tensor(-10.8052, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3306, dtype=torch.float64) delta_t tensor(0.2865, dtype=torch.float64)
16 gae_duplicate tensor(0.1977, dtype=torch.float64) tensor(-6.8117, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4876, dtype=torch.float64) delta_t tensor(0.5557, dtype=torch.float64)
15 gae_duplicate tensor(0.4254, dtype=torch.float64) tensor(-11.6924, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2953, dtype=torch.float64) delta_t tensor(0.3032, dtype=torch.float64)
14 gae_duplicate tensor(0.2676, dtype=torch.float64) tensor(-7.0894, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5001, dtype=torch.float64) delta_t tensor(0.5657, dtype=torch.float64)
13 gae_duplicate tensor(0.5373, dtype=torch.float64) tensor(-11.6227, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2741, dtype=torch.float64) delta_t tensor(0.2473, dtype=torch.float64)
12 gae_duplicate tensor(0.0651, dtype=torch.float64) tensor(-6.1807, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5096, dtype=torch.float64) delta_t tensor(0.5163, dtype=torch.float64)
11 gae_duplicate tensor(0.4582, dtype=torch.float64) tensor(-11.3129, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2775, dtype=torch.float64) delta_t tensor(0.2637, dtype=torch.float64)
10 gae_duplicate tensor(0.1005, dtype=torch.float64) tensor(-6.3662, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5169, dtype=torch.float64) delta_t tensor(0.4830, dtype=torch.float64)
9 gae_duplicate tensor(0.3966, dtype=torch.float64) tensor(-10.1293, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2462, dtype=torch.float64) delta_t tensor(0.2112, dtype=torch.float64)
8 gae_duplicate tensor(-0.0132, dtype=torch.float64) tensor(-5.1586, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4789, dtype=torch.float64) delta_t tensor(0.5018, dtype=torch.float64)
7 gae_duplicate tensor(0.4094, dtype=torch.float64) tensor(-10.5188, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1958, dtype=torch.float64) delta_t tensor(0.1724, dtype=torch.float64)
6 gae_duplicate tensor(-0.0598, dtype=torch.float64) tensor(-4.1371, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0692, dtype=torch.float64) delta_t tensor(-0.9117, dtype=torch.float64)
5 gae_duplicate tensor(-2.0490, dtype=torch.float64) tensor(17.1424, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5276, dtype=torch.float64) delta_t tensor(-2.4002, dtype=torch.float64)
4 gae_duplicate tensor(-5.4843, dtype=torch.float64) tensor(50.3555, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0759, dtype=torch.float64) delta_t tensor(-0.0757, dtype=torch.float64)
3 gae_duplicate tensor(-0.7280, dtype=torch.float64) tensor(6.1789, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2372, dtype=torch.float64) delta_t tensor(-0.3856, dtype=torch.float64)
2 gae_duplicate tensor(-0.5601, dtype=torch.float64) tensor(8.2228, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1862.6102294921875
value loss:125.66059112548828
entropies:353.9405212402344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.492216110229492 seconds
19 rew tensor(0.5120, dtype=torch.float64) delta_t tensor(0.5054, dtype=torch.float64)
19 gae_duplicate tensor(0.2766, dtype=torch.float64) tensor(-10.0491, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3971, dtype=torch.float64) delta_t tensor(0.4162, dtype=torch.float64)
18 gae_duplicate tensor(0.2167, dtype=torch.float64) tensor(-9.4295, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5003, dtype=torch.float64) delta_t tensor(0.5119, dtype=torch.float64)
17 gae_duplicate tensor(0.3267, dtype=torch.float64) tensor(-11.0684, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3472, dtype=torch.float64) delta_t tensor(0.4213, dtype=torch.float64)
16 gae_duplicate tensor(0.2514, dtype=torch.float64) tensor(-8.8395, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4896, dtype=torch.float64) delta_t tensor(0.6091, dtype=torch.float64)
15 gae_duplicate tensor(0.5455, dtype=torch.float64) tensor(-12.5510, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2901, dtype=torch.float64) delta_t tensor(0.3136, dtype=torch.float64)
14 gae_duplicate tensor(0.2358, dtype=torch.float64) tensor(-7.1726, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4629, dtype=torch.float64) delta_t tensor(0.5360, dtype=torch.float64)
13 gae_duplicate tensor(0.2550, dtype=torch.float64) tensor(-11.4806, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2896, dtype=torch.float64) delta_t tensor(0.2964, dtype=torch.float64)
12 gae_duplicate tensor(0.2162, dtype=torch.float64) tensor(-6.8513, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4596, dtype=torch.float64) delta_t tensor(0.4727, dtype=torch.float64)
11 gae_duplicate tensor(0.1835, dtype=torch.float64) tensor(-9.9849, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2869, dtype=torch.float64) delta_t tensor(0.3015, dtype=torch.float64)
10 gae_duplicate tensor(0.2308, dtype=torch.float64) tensor(-6.9262, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4028, dtype=torch.float64) delta_t tensor(0.3812, dtype=torch.float64)
9 gae_duplicate tensor(0.0229, dtype=torch.float64) tensor(-8.0132, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1194, dtype=torch.float64) delta_t tensor(0.1166, dtype=torch.float64)
8 gae_duplicate tensor(-0.0142, dtype=torch.float64) tensor(-3.2227, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4932, dtype=torch.float64) delta_t tensor(0.5403, dtype=torch.float64)
7 gae_duplicate tensor(0.5341, dtype=torch.float64) tensor(-10.6115, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0591, dtype=torch.float64) delta_t tensor(-0.1003, dtype=torch.float64)
6 gae_duplicate tensor(-0.6656, dtype=torch.float64) tensor(0.9777, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0785, dtype=torch.float64) delta_t tensor(-0.9341, dtype=torch.float64)
5 gae_duplicate tensor(-1.9336, dtype=torch.float64) tensor(17.8909, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1059, dtype=torch.float64) delta_t tensor(-3.0882, dtype=torch.float64)
4 gae_duplicate tensor(-5.4869, dtype=torch.float64) tensor(65.7640, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0375, dtype=torch.float64) delta_t tensor(0.0036, dtype=torch.float64)
3 gae_duplicate tensor(-0.7021, dtype=torch.float64) tensor(6.0420, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2226, dtype=torch.float64) delta_t tensor(-0.3338, dtype=torch.float64)
2 gae_duplicate tensor(-0.6254, dtype=torch.float64) tensor(7.4287, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:881.7583618164062
value loss:162.95553588867188
entropies:353.64947509765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.929147958755493 seconds
19 rew tensor(0.5047, dtype=torch.float64) delta_t tensor(0.4467, dtype=torch.float64)
19 gae_duplicate tensor(0.3292, dtype=torch.float64) tensor(-8.3478, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4515, dtype=torch.float64) delta_t tensor(0.3808, dtype=torch.float64)
18 gae_duplicate tensor(0.3200, dtype=torch.float64) tensor(-8.3256, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4687, dtype=torch.float64) delta_t tensor(0.4560, dtype=torch.float64)
17 gae_duplicate tensor(0.2319, dtype=torch.float64) tensor(-9.4446, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3199, dtype=torch.float64) delta_t tensor(0.3689, dtype=torch.float64)
16 gae_duplicate tensor(0.2204, dtype=torch.float64) tensor(-8.2823, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4924, dtype=torch.float64) delta_t tensor(0.5606, dtype=torch.float64)
15 gae_duplicate tensor(0.2834, dtype=torch.float64) tensor(-11.6832, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1529, dtype=torch.float64) delta_t tensor(0.1452, dtype=torch.float64)
14 gae_duplicate tensor(0.0753, dtype=torch.float64) tensor(-3.9868, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5175, dtype=torch.float64) delta_t tensor(0.5510, dtype=torch.float64)
13 gae_duplicate tensor(0.5121, dtype=torch.float64) tensor(-10.7247, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1157, dtype=torch.float64) delta_t tensor(0.1106, dtype=torch.float64)
12 gae_duplicate tensor(0.0984, dtype=torch.float64) tensor(-3.2587, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5330, dtype=torch.float64) delta_t tensor(0.5087, dtype=torch.float64)
11 gae_duplicate tensor(0.4595, dtype=torch.float64) tensor(-10.4553, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1089, dtype=torch.float64) delta_t tensor(0.0726, dtype=torch.float64)
10 gae_duplicate tensor(0.0030, dtype=torch.float64) tensor(-2.4318, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5269, dtype=torch.float64) delta_t tensor(0.4699, dtype=torch.float64)
9 gae_duplicate tensor(0.4245, dtype=torch.float64) tensor(-9.5010, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0579, dtype=torch.float64) delta_t tensor(0.0023, dtype=torch.float64)
8 gae_duplicate tensor(-0.0480, dtype=torch.float64) tensor(-1.0252, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4874, dtype=torch.float64) delta_t tensor(0.4846, dtype=torch.float64)
7 gae_duplicate tensor(0.4220, dtype=torch.float64) tensor(-9.4876, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0059, dtype=torch.float64) delta_t tensor(-0.0762, dtype=torch.float64)
6 gae_duplicate tensor(-0.3379, dtype=torch.float64) tensor(0.4314, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1122, dtype=torch.float64) delta_t tensor(-0.9684, dtype=torch.float64)
5 gae_duplicate tensor(-2.4619, dtype=torch.float64) tensor(19.1947, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5873, dtype=torch.float64) delta_t tensor(-2.4916, dtype=torch.float64)
4 gae_duplicate tensor(-6.0451, dtype=torch.float64) tensor(48.9080, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0784, dtype=torch.float64) delta_t tensor(-0.0867, dtype=torch.float64)
3 gae_duplicate tensor(-0.6514, dtype=torch.float64) tensor(6.2684, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2383, dtype=torch.float64) delta_t tensor(-0.3806, dtype=torch.float64)
2 gae_duplicate tensor(-0.5582, dtype=torch.float64) tensor(8.0783, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:664.6257934570312
value loss:150.031494140625
entropies:353.2357482910156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.829314708709717 seconds
19 rew tensor(0.4875, dtype=torch.float64) delta_t tensor(0.3974, dtype=torch.float64)
19 gae_duplicate tensor(0.2215, dtype=torch.float64) tensor(-7.7821, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4690, dtype=torch.float64) delta_t tensor(0.4357, dtype=torch.float64)
18 gae_duplicate tensor(0.2757, dtype=torch.float64) tensor(-9.1952, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4460, dtype=torch.float64) delta_t tensor(0.4017, dtype=torch.float64)
17 gae_duplicate tensor(0.1275, dtype=torch.float64) tensor(-8.5268, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3489, dtype=torch.float64) delta_t tensor(0.3155, dtype=torch.float64)
16 gae_duplicate tensor(0.0593, dtype=torch.float64) tensor(-6.9485, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4981, dtype=torch.float64) delta_t tensor(0.6254, dtype=torch.float64)
15 gae_duplicate tensor(0.4126, dtype=torch.float64) tensor(-12.6753, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1967, dtype=torch.float64) delta_t tensor(0.2415, dtype=torch.float64)
14 gae_duplicate tensor(0.0963, dtype=torch.float64) tensor(-5.9304, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5329, dtype=torch.float64) delta_t tensor(0.6087, dtype=torch.float64)
13 gae_duplicate tensor(0.5528, dtype=torch.float64) tensor(-12.5599, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1959, dtype=torch.float64) delta_t tensor(0.1816, dtype=torch.float64)
12 gae_duplicate tensor(0.0634, dtype=torch.float64) tensor(-4.8928, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5412, dtype=torch.float64) delta_t tensor(0.5458, dtype=torch.float64)
11 gae_duplicate tensor(0.4920, dtype=torch.float64) tensor(-10.8841, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1979, dtype=torch.float64) delta_t tensor(0.1796, dtype=torch.float64)
10 gae_duplicate tensor(0.0451, dtype=torch.float64) tensor(-4.5834, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5278, dtype=torch.float64) delta_t tensor(0.5064, dtype=torch.float64)
9 gae_duplicate tensor(0.4489, dtype=torch.float64) tensor(-10.0323, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1454, dtype=torch.float64) delta_t tensor(0.1200, dtype=torch.float64)
8 gae_duplicate tensor(-0.0413, dtype=torch.float64) tensor(-3.1283, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5030, dtype=torch.float64) delta_t tensor(0.5451, dtype=torch.float64)
7 gae_duplicate tensor(0.4772, dtype=torch.float64) tensor(-10.7803, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0930, dtype=torch.float64) delta_t tensor(0.0455, dtype=torch.float64)
6 gae_duplicate tensor(-0.1405, dtype=torch.float64) tensor(-1.9194, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3594, dtype=torch.float64) delta_t tensor(-1.2018, dtype=torch.float64)
5 gae_duplicate tensor(-2.1680, dtype=torch.float64) tensor(22.6888, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.8486, dtype=torch.float64) delta_t tensor(-3.7514, dtype=torch.float64)
4 gae_duplicate tensor(-5.0360, dtype=torch.float64) tensor(76.5626, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1069, dtype=torch.float64) delta_t tensor(-0.1558, dtype=torch.float64)
3 gae_duplicate tensor(-0.7326, dtype=torch.float64) tensor(10.6992, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1825, dtype=torch.float64) delta_t tensor(-0.3123, dtype=torch.float64)
2 gae_duplicate tensor(-0.5344, dtype=torch.float64) tensor(7.2405, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-492.3421630859375
value loss:187.99122619628906
entropies:353.0184631347656
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3945.5981)
ToM Target loss= tensor(2609.0867)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.768446922302246 seconds
19 rew tensor(0.4796, dtype=torch.float64) delta_t tensor(0.4240, dtype=torch.float64)
19 gae_duplicate tensor(0.2852, dtype=torch.float64) tensor(-8.0497, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3927, dtype=torch.float64) delta_t tensor(0.3558, dtype=torch.float64)
18 gae_duplicate tensor(0.2010, dtype=torch.float64) tensor(-7.5661, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4547, dtype=torch.float64) delta_t tensor(0.4592, dtype=torch.float64)
17 gae_duplicate tensor(0.2931, dtype=torch.float64) tensor(-9.8137, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3873, dtype=torch.float64) delta_t tensor(0.3921, dtype=torch.float64)
16 gae_duplicate tensor(0.2059, dtype=torch.float64) tensor(-8.6722, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4822, dtype=torch.float64) delta_t tensor(0.5855, dtype=torch.float64)
15 gae_duplicate tensor(0.3693, dtype=torch.float64) tensor(-13.0782, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3407, dtype=torch.float64) delta_t tensor(0.3540, dtype=torch.float64)
14 gae_duplicate tensor(0.3148, dtype=torch.float64) tensor(-7.9219, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5043, dtype=torch.float64) delta_t tensor(0.5286, dtype=torch.float64)
13 gae_duplicate tensor(0.3530, dtype=torch.float64) tensor(-10.8471, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0096, dtype=torch.float64) delta_t tensor(0.0025, dtype=torch.float64)
12 gae_duplicate tensor(-1.6711, dtype=torch.float64) tensor(-1.4787, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4927, dtype=torch.float64) delta_t tensor(0.5096, dtype=torch.float64)
11 gae_duplicate tensor(0.3365, dtype=torch.float64) tensor(-10.1656, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3512, dtype=torch.float64) delta_t tensor(0.3311, dtype=torch.float64)
10 gae_duplicate tensor(0.2963, dtype=torch.float64) tensor(-7.3265, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5065, dtype=torch.float64) delta_t tensor(0.4932, dtype=torch.float64)
9 gae_duplicate tensor(0.2993, dtype=torch.float64) tensor(-10.0688, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3199, dtype=torch.float64) delta_t tensor(0.2983, dtype=torch.float64)
8 gae_duplicate tensor(0.2450, dtype=torch.float64) tensor(-6.8611, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4685, dtype=torch.float64) delta_t tensor(0.5056, dtype=torch.float64)
7 gae_duplicate tensor(0.2803, dtype=torch.float64) tensor(-10.3579, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2824, dtype=torch.float64) delta_t tensor(0.2536, dtype=torch.float64)
6 gae_duplicate tensor(0.1634, dtype=torch.float64) tensor(-6.4594, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6295, dtype=torch.float64) delta_t tensor(-1.4596, dtype=torch.float64)
5 gae_duplicate tensor(-1.9866, dtype=torch.float64) tensor(27.2706, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.2871, dtype=torch.float64) delta_t tensor(-4.1879, dtype=torch.float64)
4 gae_duplicate tensor(-6.5426, dtype=torch.float64) tensor(85.3553, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0241, dtype=torch.float64) delta_t tensor(-0.0415, dtype=torch.float64)
3 gae_duplicate tensor(-0.8615, dtype=torch.float64) tensor(9.8628, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1677, dtype=torch.float64) delta_t tensor(-0.2806, dtype=torch.float64)
2 gae_duplicate tensor(-0.4959, dtype=torch.float64) tensor(6.2777, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-640.5728759765625
value loss:261.4017639160156
entropies:352.579345703125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.129649877548218 seconds
19 rew tensor(0.5109, dtype=torch.float64) delta_t tensor(0.4594, dtype=torch.float64)
19 gae_duplicate tensor(0.3614, dtype=torch.float64) tensor(-9.2065, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4144, dtype=torch.float64) delta_t tensor(0.3465, dtype=torch.float64)
18 gae_duplicate tensor(0.2143, dtype=torch.float64) tensor(-7.2314, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5061, dtype=torch.float64) delta_t tensor(0.4856, dtype=torch.float64)
17 gae_duplicate tensor(0.4122, dtype=torch.float64) tensor(-10.9093, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3417, dtype=torch.float64) delta_t tensor(0.2887, dtype=torch.float64)
16 gae_duplicate tensor(0.1236, dtype=torch.float64) tensor(-6.7338, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5283, dtype=torch.float64) delta_t tensor(0.6053, dtype=torch.float64)
15 gae_duplicate tensor(0.4783, dtype=torch.float64) tensor(-11.8330, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2649, dtype=torch.float64) delta_t tensor(0.2741, dtype=torch.float64)
14 gae_duplicate tensor(0.1133, dtype=torch.float64) tensor(-7.1618, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5015, dtype=torch.float64) delta_t tensor(0.6349, dtype=torch.float64)
13 gae_duplicate tensor(0.6126, dtype=torch.float64) tensor(-13.2677, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2834, dtype=torch.float64) delta_t tensor(0.3060, dtype=torch.float64)
12 gae_duplicate tensor(0.1688, dtype=torch.float64) tensor(-7.1155, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4602, dtype=torch.float64) delta_t tensor(0.5006, dtype=torch.float64)
11 gae_duplicate tensor(0.3112, dtype=torch.float64) tensor(-10.6837, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2988, dtype=torch.float64) delta_t tensor(0.3290, dtype=torch.float64)
10 gae_duplicate tensor(0.1432, dtype=torch.float64) tensor(-7.4931, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4245, dtype=torch.float64) delta_t tensor(0.4176, dtype=torch.float64)
9 gae_duplicate tensor(0.2611, dtype=torch.float64) tensor(-8.9253, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1963, dtype=torch.float64) delta_t tensor(0.2036, dtype=torch.float64)
8 gae_duplicate tensor(0.0564, dtype=torch.float64) tensor(-4.9651, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3881, dtype=torch.float64) delta_t tensor(0.4301, dtype=torch.float64)
7 gae_duplicate tensor(-0.0260, dtype=torch.float64) tensor(-9.3394, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0181, dtype=torch.float64) delta_t tensor(-0.0056, dtype=torch.float64)
6 gae_duplicate tensor(-0.3925, dtype=torch.float64) tensor(-0.7182, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4149, dtype=torch.float64) delta_t tensor(-1.2891, dtype=torch.float64)
5 gae_duplicate tensor(-1.8480, dtype=torch.float64) tensor(24.8529, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1660, dtype=torch.float64) delta_t tensor(-3.1051, dtype=torch.float64)
4 gae_duplicate tensor(-6.5402, dtype=torch.float64) tensor(62.8512, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0006, dtype=torch.float64) delta_t tensor(-0.0617, dtype=torch.float64)
3 gae_duplicate tensor(-0.7708, dtype=torch.float64) tensor(7.1133, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1253, dtype=torch.float64) delta_t tensor(-0.2336, dtype=torch.float64)
2 gae_duplicate tensor(-0.4832, dtype=torch.float64) tensor(4.8086, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:766.7313842773438
value loss:182.03744506835938
entropies:351.8072814941406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.569366931915283 seconds
19 rew tensor(0.5000, dtype=torch.float64) delta_t tensor(0.4444, dtype=torch.float64)
19 gae_duplicate tensor(0.3732, dtype=torch.float64) tensor(-8.2199, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4274, dtype=torch.float64) delta_t tensor(0.4248, dtype=torch.float64)
18 gae_duplicate tensor(0.2849, dtype=torch.float64) tensor(-9.2072, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4876, dtype=torch.float64) delta_t tensor(0.4579, dtype=torch.float64)
17 gae_duplicate tensor(0.2774, dtype=torch.float64) tensor(-9.6022, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3273, dtype=torch.float64) delta_t tensor(0.3561, dtype=torch.float64)
16 gae_duplicate tensor(-0.0727, dtype=torch.float64) tensor(-7.2177, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5077, dtype=torch.float64) delta_t tensor(0.5749, dtype=torch.float64)
15 gae_duplicate tensor(0.4524, dtype=torch.float64) tensor(-12.4203, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2902, dtype=torch.float64) delta_t tensor(0.2792, dtype=torch.float64)
14 gae_duplicate tensor(-0.0849, dtype=torch.float64) tensor(-6.5624, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5165, dtype=torch.float64) delta_t tensor(0.6005, dtype=torch.float64)
13 gae_duplicate tensor(0.5790, dtype=torch.float64) tensor(-12.1379, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2863, dtype=torch.float64) delta_t tensor(0.2724, dtype=torch.float64)
12 gae_duplicate tensor(-0.0264, dtype=torch.float64) tensor(-6.1168, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5300, dtype=torch.float64) delta_t tensor(0.5200, dtype=torch.float64)
11 gae_duplicate tensor(0.4835, dtype=torch.float64) tensor(-11.1141, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2867, dtype=torch.float64) delta_t tensor(0.2715, dtype=torch.float64)
10 gae_duplicate tensor(-0.0106, dtype=torch.float64) tensor(-6.1704, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5106, dtype=torch.float64) delta_t tensor(0.4831, dtype=torch.float64)
9 gae_duplicate tensor(0.4160, dtype=torch.float64) tensor(-10.0471, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2215, dtype=torch.float64) delta_t tensor(0.1950, dtype=torch.float64)
8 gae_duplicate tensor(-0.1073, dtype=torch.float64) tensor(-4.9283, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4311, dtype=torch.float64) delta_t tensor(0.4451, dtype=torch.float64)
7 gae_duplicate tensor(0.0533, dtype=torch.float64) tensor(-8.8316, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1221, dtype=torch.float64) delta_t tensor(0.0687, dtype=torch.float64)
6 gae_duplicate tensor(-0.2001, dtype=torch.float64) tensor(-2.4214, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4677, dtype=torch.float64) delta_t tensor(-1.3276, dtype=torch.float64)
5 gae_duplicate tensor(-2.0466, dtype=torch.float64) tensor(27.4393, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5504, dtype=torch.float64) delta_t tensor(-3.4773, dtype=torch.float64)
4 gae_duplicate tensor(-4.7797, dtype=torch.float64) tensor(74.8061, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1021, dtype=torch.float64) delta_t tensor(-0.1823, dtype=torch.float64)
3 gae_duplicate tensor(-0.6746, dtype=torch.float64) tensor(9.8990, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1022, dtype=torch.float64) delta_t tensor(-0.2350, dtype=torch.float64)
2 gae_duplicate tensor(-0.4050, dtype=torch.float64) tensor(5.8918, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-258.95904541015625
value loss:181.3365478515625
entropies:351.3196105957031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.014191150665283 seconds
19 rew tensor(0.5294, dtype=torch.float64) delta_t tensor(0.5437, dtype=torch.float64)
19 gae_duplicate tensor(0.4378, dtype=torch.float64) tensor(-9.3380, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3419, dtype=torch.float64) delta_t tensor(0.3095, dtype=torch.float64)
18 gae_duplicate tensor(0.2068, dtype=torch.float64) tensor(-6.9145, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5325, dtype=torch.float64) delta_t tensor(0.4936, dtype=torch.float64)
17 gae_duplicate tensor(0.4023, dtype=torch.float64) tensor(-10.2582, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3177, dtype=torch.float64) delta_t tensor(0.2540, dtype=torch.float64)
16 gae_duplicate tensor(0.0473, dtype=torch.float64) tensor(-5.9659, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5034, dtype=torch.float64) delta_t tensor(0.5523, dtype=torch.float64)
15 gae_duplicate tensor(0.4678, dtype=torch.float64) tensor(-11.4674, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1859, dtype=torch.float64) delta_t tensor(0.1881, dtype=torch.float64)
14 gae_duplicate tensor(0.0417, dtype=torch.float64) tensor(-5.0443, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5201, dtype=torch.float64) delta_t tensor(0.6272, dtype=torch.float64)
13 gae_duplicate tensor(0.5476, dtype=torch.float64) tensor(-12.8094, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1417, dtype=torch.float64) delta_t tensor(0.1415, dtype=torch.float64)
12 gae_duplicate tensor(0.0343, dtype=torch.float64) tensor(-4.1184, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5341, dtype=torch.float64) delta_t tensor(0.5363, dtype=torch.float64)
11 gae_duplicate tensor(0.4914, dtype=torch.float64) tensor(-10.8840, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1571, dtype=torch.float64) delta_t tensor(0.1384, dtype=torch.float64)
10 gae_duplicate tensor(-0.0081, dtype=torch.float64) tensor(-3.6231, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5229, dtype=torch.float64) delta_t tensor(0.4928, dtype=torch.float64)
9 gae_duplicate tensor(0.4132, dtype=torch.float64) tensor(-9.6898, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1077, dtype=torch.float64) delta_t tensor(0.0805, dtype=torch.float64)
8 gae_duplicate tensor(-0.1142, dtype=torch.float64) tensor(-2.2874, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4697, dtype=torch.float64) delta_t tensor(0.4789, dtype=torch.float64)
7 gae_duplicate tensor(0.3101, dtype=torch.float64) tensor(-9.3909, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0317, dtype=torch.float64) delta_t tensor(-0.0236, dtype=torch.float64)
6 gae_duplicate tensor(-0.3046, dtype=torch.float64) tensor(-0.8232, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4329, dtype=torch.float64) delta_t tensor(-1.3003, dtype=torch.float64)
5 gae_duplicate tensor(-2.5969, dtype=torch.float64) tensor(27.5174, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.7590, dtype=torch.float64) delta_t tensor(-3.6948, dtype=torch.float64)
4 gae_duplicate tensor(-6.9335, dtype=torch.float64) tensor(77.3306, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0267, dtype=torch.float64) delta_t tensor(-0.0276, dtype=torch.float64)
3 gae_duplicate tensor(-0.8130, dtype=torch.float64) tensor(8.2082, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1586, dtype=torch.float64) delta_t tensor(-0.2798, dtype=torch.float64)
2 gae_duplicate tensor(-0.5364, dtype=torch.float64) tensor(5.8767, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-975.8253173828125
value loss:235.91542053222656
entropies:350.4666748046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.804162979125977 seconds
19 rew tensor(0.4795, dtype=torch.float64) delta_t tensor(0.4366, dtype=torch.float64)
19 gae_duplicate tensor(0.2277, dtype=torch.float64) tensor(-8.1918, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4426, dtype=torch.float64) delta_t tensor(0.4281, dtype=torch.float64)
18 gae_duplicate tensor(0.2851, dtype=torch.float64) tensor(-9.3564, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4605, dtype=torch.float64) delta_t tensor(0.4323, dtype=torch.float64)
17 gae_duplicate tensor(0.2704, dtype=torch.float64) tensor(-9.6248, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3413, dtype=torch.float64) delta_t tensor(0.3190, dtype=torch.float64)
16 gae_duplicate tensor(0.1529, dtype=torch.float64) tensor(-7.1760, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5024, dtype=torch.float64) delta_t tensor(0.5904, dtype=torch.float64)
15 gae_duplicate tensor(0.4082, dtype=torch.float64) tensor(-11.8367, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2773, dtype=torch.float64) delta_t tensor(0.2810, dtype=torch.float64)
14 gae_duplicate tensor(0.1331, dtype=torch.float64) tensor(-6.3420, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3325, dtype=torch.float64) delta_t tensor(0.4222, dtype=torch.float64)
13 gae_duplicate tensor(-0.2573, dtype=torch.float64) tensor(-9.6016, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2491, dtype=torch.float64) delta_t tensor(0.2605, dtype=torch.float64)
12 gae_duplicate tensor(0.0325, dtype=torch.float64) tensor(-5.9708, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5161, dtype=torch.float64) delta_t tensor(0.5223, dtype=torch.float64)
11 gae_duplicate tensor(0.4783, dtype=torch.float64) tensor(-10.5030, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2370, dtype=torch.float64) delta_t tensor(0.2267, dtype=torch.float64)
10 gae_duplicate tensor(-0.0627, dtype=torch.float64) tensor(-5.3689, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4898, dtype=torch.float64) delta_t tensor(0.4627, dtype=torch.float64)
9 gae_duplicate tensor(0.2917, dtype=torch.float64) tensor(-9.5929, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1717, dtype=torch.float64) delta_t tensor(0.1775, dtype=torch.float64)
8 gae_duplicate tensor(-0.1383, dtype=torch.float64) tensor(-4.9429, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4712, dtype=torch.float64) delta_t tensor(0.5241, dtype=torch.float64)
7 gae_duplicate tensor(0.4428, dtype=torch.float64) tensor(-10.5079, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0856, dtype=torch.float64) delta_t tensor(0.1201, dtype=torch.float64)
6 gae_duplicate tensor(-0.3408, dtype=torch.float64) tensor(-3.6082, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2407, dtype=torch.float64) delta_t tensor(-1.0918, dtype=torch.float64)
5 gae_duplicate tensor(-2.9418, dtype=torch.float64) tensor(22.8865, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4995, dtype=torch.float64) delta_t tensor(-1.3972, dtype=torch.float64)
4 gae_duplicate tensor(-4.6552, dtype=torch.float64) tensor(30.9333, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0748, dtype=torch.float64) delta_t tensor(-0.0999, dtype=torch.float64)
3 gae_duplicate tensor(-0.4373, dtype=torch.float64) tensor(4.9155, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3284, dtype=torch.float64) delta_t tensor(-0.4334, dtype=torch.float64)
2 gae_duplicate tensor(-0.6075, dtype=torch.float64) tensor(8.5688, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2352.91015625
value loss:92.39682006835938
entropies:349.4581298828125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3923.0059)
ToM Target loss= tensor(2618.0715)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.018992900848389 seconds
19 rew tensor(0.5240, dtype=torch.float64) delta_t tensor(0.5133, dtype=torch.float64)
19 gae_duplicate tensor(0.3832, dtype=torch.float64) tensor(-9.9083, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3964, dtype=torch.float64) delta_t tensor(0.3613, dtype=torch.float64)
18 gae_duplicate tensor(0.2732, dtype=torch.float64) tensor(-8.3014, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5274, dtype=torch.float64) delta_t tensor(0.4996, dtype=torch.float64)
17 gae_duplicate tensor(0.4785, dtype=torch.float64) tensor(-11.0728, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3653, dtype=torch.float64) delta_t tensor(0.3540, dtype=torch.float64)
16 gae_duplicate tensor(0.2255, dtype=torch.float64) tensor(-7.9879, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4886, dtype=torch.float64) delta_t tensor(0.6309, dtype=torch.float64)
15 gae_duplicate tensor(0.5109, dtype=torch.float64) tensor(-12.5090, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2929, dtype=torch.float64) delta_t tensor(0.3136, dtype=torch.float64)
14 gae_duplicate tensor(0.2439, dtype=torch.float64) tensor(-7.9135, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5352, dtype=torch.float64) delta_t tensor(0.5999, dtype=torch.float64)
13 gae_duplicate tensor(0.5551, dtype=torch.float64) tensor(-12.5429, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2710, dtype=torch.float64) delta_t tensor(0.2779, dtype=torch.float64)
12 gae_duplicate tensor(0.1376, dtype=torch.float64) tensor(-7.0358, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5295, dtype=torch.float64) delta_t tensor(0.5474, dtype=torch.float64)
11 gae_duplicate tensor(0.5088, dtype=torch.float64) tensor(-11.7861, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2791, dtype=torch.float64) delta_t tensor(0.2597, dtype=torch.float64)
10 gae_duplicate tensor(0.0210, dtype=torch.float64) tensor(-5.8595, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5370, dtype=torch.float64) delta_t tensor(0.5239, dtype=torch.float64)
9 gae_duplicate tensor(0.5153, dtype=torch.float64) tensor(-11.2157, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2411, dtype=torch.float64) delta_t tensor(0.2353, dtype=torch.float64)
8 gae_duplicate tensor(0.0471, dtype=torch.float64) tensor(-5.8158, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4637, dtype=torch.float64) delta_t tensor(0.4797, dtype=torch.float64)
7 gae_duplicate tensor(0.1759, dtype=torch.float64) tensor(-9.6011, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1682, dtype=torch.float64) delta_t tensor(0.1336, dtype=torch.float64)
6 gae_duplicate tensor(-0.2737, dtype=torch.float64) tensor(-3.2686, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3945, dtype=torch.float64) delta_t tensor(-1.2489, dtype=torch.float64)
5 gae_duplicate tensor(-2.0450, dtype=torch.float64) tensor(23.8275, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.8292, dtype=torch.float64) delta_t tensor(-3.7509, dtype=torch.float64)
4 gae_duplicate tensor(-5.5225, dtype=torch.float64) tensor(73.2362, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0239, dtype=torch.float64) delta_t tensor(-0.0829, dtype=torch.float64)
3 gae_duplicate tensor(-0.7384, dtype=torch.float64) tensor(9.2184, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1363, dtype=torch.float64) delta_t tensor(-0.2665, dtype=torch.float64)
2 gae_duplicate tensor(-0.5029, dtype=torch.float64) tensor(6.3531, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:563.934326171875
value loss:211.4143829345703
entropies:348.00341796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.024311780929565 seconds
19 rew tensor(0.4470, dtype=torch.float64) delta_t tensor(0.3770, dtype=torch.float64)
19 gae_duplicate tensor(0.1489, dtype=torch.float64) tensor(-7.0545, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4215, dtype=torch.float64) delta_t tensor(0.3477, dtype=torch.float64)
18 gae_duplicate tensor(0.1365, dtype=torch.float64) tensor(-7.0928, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4343, dtype=torch.float64) delta_t tensor(0.3471, dtype=torch.float64)
17 gae_duplicate tensor(0.1995, dtype=torch.float64) tensor(-8.0531, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3888, dtype=torch.float64) delta_t tensor(0.4794, dtype=torch.float64)
16 gae_duplicate tensor(0.1310, dtype=torch.float64) tensor(-10.1391, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5082, dtype=torch.float64) delta_t tensor(0.5885, dtype=torch.float64)
15 gae_duplicate tensor(0.4455, dtype=torch.float64) tensor(-11.3959, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2636, dtype=torch.float64) delta_t tensor(0.2783, dtype=torch.float64)
14 gae_duplicate tensor(0.2045, dtype=torch.float64) tensor(-6.4770, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5229, dtype=torch.float64) delta_t tensor(0.6145, dtype=torch.float64)
13 gae_duplicate tensor(0.6099, dtype=torch.float64) tensor(-13.1318, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2661, dtype=torch.float64) delta_t tensor(0.2476, dtype=torch.float64)
12 gae_duplicate tensor(0.1882, dtype=torch.float64) tensor(-5.9812, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5366, dtype=torch.float64) delta_t tensor(0.5410, dtype=torch.float64)
11 gae_duplicate tensor(0.5045, dtype=torch.float64) tensor(-11.8662, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2733, dtype=torch.float64) delta_t tensor(0.2629, dtype=torch.float64)
10 gae_duplicate tensor(0.1731, dtype=torch.float64) tensor(-6.0957, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5375, dtype=torch.float64) delta_t tensor(0.4999, dtype=torch.float64)
9 gae_duplicate tensor(0.4690, dtype=torch.float64) tensor(-9.4430, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2351, dtype=torch.float64) delta_t tensor(0.2108, dtype=torch.float64)
8 gae_duplicate tensor(0.1076, dtype=torch.float64) tensor(-4.8409, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4987, dtype=torch.float64) delta_t tensor(0.5194, dtype=torch.float64)
7 gae_duplicate tensor(0.4896, dtype=torch.float64) tensor(-9.9362, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1968, dtype=torch.float64) delta_t tensor(0.1637, dtype=torch.float64)
6 gae_duplicate tensor(0.1236, dtype=torch.float64) tensor(-4.2471, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3522, dtype=torch.float64) delta_t tensor(-1.1887, dtype=torch.float64)
5 gae_duplicate tensor(-2.7068, dtype=torch.float64) tensor(22.3405, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.2229, dtype=torch.float64) delta_t tensor(-3.1188, dtype=torch.float64)
4 gae_duplicate tensor(-4.7130, dtype=torch.float64) tensor(60.2090, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0453, dtype=torch.float64) delta_t tensor(-0.0803, dtype=torch.float64)
3 gae_duplicate tensor(-0.7413, dtype=torch.float64) tensor(7.2078, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2089, dtype=torch.float64) delta_t tensor(-0.3366, dtype=torch.float64)
2 gae_duplicate tensor(-0.5224, dtype=torch.float64) tensor(6.3109, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:969.3644409179688
value loss:159.87240600585938
entropies:347.00201416015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.727790832519531 seconds
19 rew tensor(0.4871, dtype=torch.float64) delta_t tensor(0.4310, dtype=torch.float64)
19 gae_duplicate tensor(0.3121, dtype=torch.float64) tensor(-9.2717, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4556, dtype=torch.float64) delta_t tensor(0.4292, dtype=torch.float64)
18 gae_duplicate tensor(0.2382, dtype=torch.float64) tensor(-9.0230, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4884, dtype=torch.float64) delta_t tensor(0.4529, dtype=torch.float64)
17 gae_duplicate tensor(0.3661, dtype=torch.float64) tensor(-10.6898, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3841, dtype=torch.float64) delta_t tensor(0.4188, dtype=torch.float64)
16 gae_duplicate tensor(0.2002, dtype=torch.float64) tensor(-8.9195, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5234, dtype=torch.float64) delta_t tensor(0.6181, dtype=torch.float64)
15 gae_duplicate tensor(0.4928, dtype=torch.float64) tensor(-13.1474, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2402, dtype=torch.float64) delta_t tensor(0.2785, dtype=torch.float64)
14 gae_duplicate tensor(0.2423, dtype=torch.float64) tensor(-6.5055, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5239, dtype=torch.float64) delta_t tensor(0.5774, dtype=torch.float64)
13 gae_duplicate tensor(0.5379, dtype=torch.float64) tensor(-11.9828, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2354, dtype=torch.float64) delta_t tensor(0.2278, dtype=torch.float64)
12 gae_duplicate tensor(0.0891, dtype=torch.float64) tensor(-5.7288, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5383, dtype=torch.float64) delta_t tensor(0.5364, dtype=torch.float64)
11 gae_duplicate tensor(0.4983, dtype=torch.float64) tensor(-10.8315, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2366, dtype=torch.float64) delta_t tensor(0.2093, dtype=torch.float64)
10 gae_duplicate tensor(-0.0025, dtype=torch.float64) tensor(-4.9773, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5391, dtype=torch.float64) delta_t tensor(0.5165, dtype=torch.float64)
9 gae_duplicate tensor(0.4763, dtype=torch.float64) tensor(-10.1970, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1980, dtype=torch.float64) delta_t tensor(0.1882, dtype=torch.float64)
8 gae_duplicate tensor(0.0266, dtype=torch.float64) tensor(-5.0498, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4672, dtype=torch.float64) delta_t tensor(0.4975, dtype=torch.float64)
7 gae_duplicate tensor(0.3062, dtype=torch.float64) tensor(-9.9446, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1337, dtype=torch.float64) delta_t tensor(0.1060, dtype=torch.float64)
6 gae_duplicate tensor(-0.2880, dtype=torch.float64) tensor(-2.8000, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1131, dtype=torch.float64) delta_t tensor(-0.9737, dtype=torch.float64)
5 gae_duplicate tensor(-1.2854, dtype=torch.float64) tensor(19.4017, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3795, dtype=torch.float64) delta_t tensor(-2.2989, dtype=torch.float64)
4 gae_duplicate tensor(-5.1516, dtype=torch.float64) tensor(48.2078, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0546, dtype=torch.float64) delta_t tensor(-0.1099, dtype=torch.float64)
3 gae_duplicate tensor(-0.5973, dtype=torch.float64) tensor(6.4706, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1634, dtype=torch.float64) delta_t tensor(-0.2968, dtype=torch.float64)
2 gae_duplicate tensor(-0.4627, dtype=torch.float64) tensor(6.4362, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1988.32666015625
value loss:116.1598129272461
entropies:346.3081970214844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.416007041931152 seconds
19 rew tensor(0.4955, dtype=torch.float64) delta_t tensor(0.4857, dtype=torch.float64)
19 gae_duplicate tensor(0.3059, dtype=torch.float64) tensor(-8.3122, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3930, dtype=torch.float64) delta_t tensor(0.3604, dtype=torch.float64)
18 gae_duplicate tensor(0.2925, dtype=torch.float64) tensor(-7.5242, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4903, dtype=torch.float64) delta_t tensor(0.4490, dtype=torch.float64)
17 gae_duplicate tensor(0.1955, dtype=torch.float64) tensor(-10.0830, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3317, dtype=torch.float64) delta_t tensor(0.2951, dtype=torch.float64)
16 gae_duplicate tensor(0.0473, dtype=torch.float64) tensor(-6.8614, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5189, dtype=torch.float64) delta_t tensor(0.6100, dtype=torch.float64)
15 gae_duplicate tensor(0.5408, dtype=torch.float64) tensor(-11.9989, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2658, dtype=torch.float64) delta_t tensor(0.2425, dtype=torch.float64)
14 gae_duplicate tensor(0.1344, dtype=torch.float64) tensor(-5.6974, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5322, dtype=torch.float64) delta_t tensor(0.6167, dtype=torch.float64)
13 gae_duplicate tensor(0.6037, dtype=torch.float64) tensor(-12.9877, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2592, dtype=torch.float64) delta_t tensor(0.2735, dtype=torch.float64)
12 gae_duplicate tensor(0.1144, dtype=torch.float64) tensor(-6.2481, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5266, dtype=torch.float64) delta_t tensor(0.5551, dtype=torch.float64)
11 gae_duplicate tensor(0.5409, dtype=torch.float64) tensor(-12.2659, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2811, dtype=torch.float64) delta_t tensor(0.2773, dtype=torch.float64)
10 gae_duplicate tensor(0.1036, dtype=torch.float64) tensor(-6.5311, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5409, dtype=torch.float64) delta_t tensor(0.5165, dtype=torch.float64)
9 gae_duplicate tensor(0.4894, dtype=torch.float64) tensor(-10.5685, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2421, dtype=torch.float64) delta_t tensor(0.2201, dtype=torch.float64)
8 gae_duplicate tensor(0.0432, dtype=torch.float64) tensor(-5.6738, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5014, dtype=torch.float64) delta_t tensor(0.5305, dtype=torch.float64)
7 gae_duplicate tensor(0.4765, dtype=torch.float64) tensor(-9.7906, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2031, dtype=torch.float64) delta_t tensor(0.1814, dtype=torch.float64)
6 gae_duplicate tensor(-0.0097, dtype=torch.float64) tensor(-4.5106, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8142, dtype=torch.float64) delta_t tensor(-1.6572, dtype=torch.float64)
5 gae_duplicate tensor(-3.1250, dtype=torch.float64) tensor(29.1220, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1263, dtype=torch.float64) delta_t tensor(-2.0274, dtype=torch.float64)
4 gae_duplicate tensor(-3.3913, dtype=torch.float64) tensor(40.9710, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0533, dtype=torch.float64) delta_t tensor(-0.0899, dtype=torch.float64)
3 gae_duplicate tensor(-0.6304, dtype=torch.float64) tensor(5.5580, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2088, dtype=torch.float64) delta_t tensor(-0.3243, dtype=torch.float64)
2 gae_duplicate tensor(-0.5774, dtype=torch.float64) tensor(6.4239, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1903.5242919921875
value loss:121.1822738647461
entropies:345.6430358886719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.501924991607666 seconds
19 rew tensor(0.5092, dtype=torch.float64) delta_t tensor(0.4715, dtype=torch.float64)
19 gae_duplicate tensor(0.3384, dtype=torch.float64) tensor(-9.1450, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3807, dtype=torch.float64) delta_t tensor(0.3130, dtype=torch.float64)
18 gae_duplicate tensor(0.2564, dtype=torch.float64) tensor(-6.6596, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5102, dtype=torch.float64) delta_t tensor(0.4942, dtype=torch.float64)
17 gae_duplicate tensor(0.3960, dtype=torch.float64) tensor(-10.0191, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1671, dtype=torch.float64) delta_t tensor(0.1979, dtype=torch.float64)
16 gae_duplicate tensor(-0.1107, dtype=torch.float64) tensor(-4.9368, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5247, dtype=torch.float64) delta_t tensor(0.6147, dtype=torch.float64)
15 gae_duplicate tensor(0.5132, dtype=torch.float64) tensor(-11.7375, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2912, dtype=torch.float64) delta_t tensor(0.2771, dtype=torch.float64)
14 gae_duplicate tensor(0.2025, dtype=torch.float64) tensor(-6.5384, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5257, dtype=torch.float64) delta_t tensor(0.5943, dtype=torch.float64)
13 gae_duplicate tensor(0.5002, dtype=torch.float64) tensor(-11.9363, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2711, dtype=torch.float64) delta_t tensor(0.2694, dtype=torch.float64)
12 gae_duplicate tensor(0.2155, dtype=torch.float64) tensor(-6.0536, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5330, dtype=torch.float64) delta_t tensor(0.5488, dtype=torch.float64)
11 gae_duplicate tensor(0.4966, dtype=torch.float64) tensor(-11.0726, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2726, dtype=torch.float64) delta_t tensor(0.2700, dtype=torch.float64)
10 gae_duplicate tensor(0.1938, dtype=torch.float64) tensor(-6.5572, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5288, dtype=torch.float64) delta_t tensor(0.4995, dtype=torch.float64)
9 gae_duplicate tensor(0.3814, dtype=torch.float64) tensor(-11.1213, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2213, dtype=torch.float64) delta_t tensor(0.2053, dtype=torch.float64)
8 gae_duplicate tensor(0.0238, dtype=torch.float64) tensor(-4.4466, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5012, dtype=torch.float64) delta_t tensor(0.5235, dtype=torch.float64)
7 gae_duplicate tensor(0.4427, dtype=torch.float64) tensor(-10.5127, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1701, dtype=torch.float64) delta_t tensor(0.1402, dtype=torch.float64)
6 gae_duplicate tensor(-0.0585, dtype=torch.float64) tensor(-3.5335, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2623, dtype=torch.float64) delta_t tensor(-1.1122, dtype=torch.float64)
5 gae_duplicate tensor(-1.3206, dtype=torch.float64) tensor(20.4340, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8349, dtype=torch.float64) delta_t tensor(-2.7326, dtype=torch.float64)
4 gae_duplicate tensor(-7.0484, dtype=torch.float64) tensor(56.7188, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0366, dtype=torch.float64) delta_t tensor(-0.0746, dtype=torch.float64)
3 gae_duplicate tensor(-0.9137, dtype=torch.float64) tensor(6.6626, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2354, dtype=torch.float64) delta_t tensor(-0.3621, dtype=torch.float64)
2 gae_duplicate tensor(-0.6585, dtype=torch.float64) tensor(7.7265, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1134.0614013671875
value loss:156.17117309570312
entropies:345.48760986328125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3907.6602)
ToM Target loss= tensor(2620.7407)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.96710467338562 seconds
19 rew tensor(0.5363, dtype=torch.float64) delta_t tensor(0.5886, dtype=torch.float64)
19 gae_duplicate tensor(0.4648, dtype=torch.float64) tensor(-11.3045, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3671, dtype=torch.float64) delta_t tensor(0.3589, dtype=torch.float64)
18 gae_duplicate tensor(0.1495, dtype=torch.float64) tensor(-7.6168, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5373, dtype=torch.float64) delta_t tensor(0.5338, dtype=torch.float64)
17 gae_duplicate tensor(0.4874, dtype=torch.float64) tensor(-11.6367, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3538, dtype=torch.float64) delta_t tensor(0.3079, dtype=torch.float64)
16 gae_duplicate tensor(0.0703, dtype=torch.float64) tensor(-6.9474, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4723, dtype=torch.float64) delta_t tensor(0.4401, dtype=torch.float64)
15 gae_duplicate tensor(0.2897, dtype=torch.float64) tensor(-9.0580, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2436, dtype=torch.float64) delta_t tensor(0.2670, dtype=torch.float64)
14 gae_duplicate tensor(0.0509, dtype=torch.float64) tensor(-6.1670, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5193, dtype=torch.float64) delta_t tensor(0.6251, dtype=torch.float64)
13 gae_duplicate tensor(0.5689, dtype=torch.float64) tensor(-12.9023, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1846, dtype=torch.float64) delta_t tensor(0.1658, dtype=torch.float64)
12 gae_duplicate tensor(0.1283, dtype=torch.float64) tensor(-4.7471, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5325, dtype=torch.float64) delta_t tensor(0.5597, dtype=torch.float64)
11 gae_duplicate tensor(0.4713, dtype=torch.float64) tensor(-11.2410, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1848, dtype=torch.float64) delta_t tensor(0.1547, dtype=torch.float64)
10 gae_duplicate tensor(0.0922, dtype=torch.float64) tensor(-4.0706, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5274, dtype=torch.float64) delta_t tensor(0.4915, dtype=torch.float64)
9 gae_duplicate tensor(0.4562, dtype=torch.float64) tensor(-9.4823, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1399, dtype=torch.float64) delta_t tensor(0.1076, dtype=torch.float64)
8 gae_duplicate tensor(0.0360, dtype=torch.float64) tensor(-3.0123, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4745, dtype=torch.float64) delta_t tensor(0.4723, dtype=torch.float64)
7 gae_duplicate tensor(0.2991, dtype=torch.float64) tensor(-8.4514, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0617, dtype=torch.float64) delta_t tensor(0.0272, dtype=torch.float64)
6 gae_duplicate tensor(-0.2603, dtype=torch.float64) tensor(-1.2579, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2380, dtype=torch.float64) delta_t tensor(-1.0874, dtype=torch.float64)
5 gae_duplicate tensor(-1.3276, dtype=torch.float64) tensor(20.5590, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1620, dtype=torch.float64) delta_t tensor(-2.0565, dtype=torch.float64)
4 gae_duplicate tensor(-8.3963, dtype=torch.float64) tensor(43.1277, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0116, dtype=torch.float64) delta_t tensor(-0.0219, dtype=torch.float64)
3 gae_duplicate tensor(-0.9750, dtype=torch.float64) tensor(4.8679, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2700, dtype=torch.float64) delta_t tensor(-0.3950, dtype=torch.float64)
2 gae_duplicate tensor(-0.5248, dtype=torch.float64) tensor(7.6896, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1616.022705078125
value loss:158.07797241210938
entropies:344.92626953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.912443161010742 seconds
19 rew tensor(0.5264, dtype=torch.float64) delta_t tensor(0.5057, dtype=torch.float64)
19 gae_duplicate tensor(0.3075, dtype=torch.float64) tensor(-10.0576, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4180, dtype=torch.float64) delta_t tensor(0.3569, dtype=torch.float64)
18 gae_duplicate tensor(0.3346, dtype=torch.float64) tensor(-7.6731, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4998, dtype=torch.float64) delta_t tensor(0.4334, dtype=torch.float64)
17 gae_duplicate tensor(0.3521, dtype=torch.float64) tensor(-9.0472, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3937, dtype=torch.float64) delta_t tensor(0.3968, dtype=torch.float64)
16 gae_duplicate tensor(0.2863, dtype=torch.float64) tensor(-10.0189, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4731, dtype=torch.float64) delta_t tensor(0.4663, dtype=torch.float64)
15 gae_duplicate tensor(0.1428, dtype=torch.float64) tensor(-9.4977, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2681, dtype=torch.float64) delta_t tensor(0.2378, dtype=torch.float64)
14 gae_duplicate tensor(0.0769, dtype=torch.float64) tensor(-5.2561, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4888, dtype=torch.float64) delta_t tensor(0.6107, dtype=torch.float64)
13 gae_duplicate tensor(0.5403, dtype=torch.float64) tensor(-12.0817, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1685, dtype=torch.float64) delta_t tensor(0.1880, dtype=torch.float64)
12 gae_duplicate tensor(0.0790, dtype=torch.float64) tensor(-4.6779, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5354, dtype=torch.float64) delta_t tensor(0.5779, dtype=torch.float64)
11 gae_duplicate tensor(0.5396, dtype=torch.float64) tensor(-11.7992, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1641, dtype=torch.float64) delta_t tensor(0.1797, dtype=torch.float64)
10 gae_duplicate tensor(0.0548, dtype=torch.float64) tensor(-4.7162, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5085, dtype=torch.float64) delta_t tensor(0.4897, dtype=torch.float64)
9 gae_duplicate tensor(0.3701, dtype=torch.float64) tensor(-9.7747, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0978, dtype=torch.float64) delta_t tensor(0.1064, dtype=torch.float64)
8 gae_duplicate tensor(-0.1109, dtype=torch.float64) tensor(-3.6212, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4962, dtype=torch.float64) delta_t tensor(0.5327, dtype=torch.float64)
7 gae_duplicate tensor(0.4941, dtype=torch.float64) tensor(-11.7570, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0314, dtype=torch.float64) delta_t tensor(0.0109, dtype=torch.float64)
6 gae_duplicate tensor(-0.4007, dtype=torch.float64) tensor(-1.6415, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0932, dtype=torch.float64) delta_t tensor(-0.9619, dtype=torch.float64)
5 gae_duplicate tensor(-1.3179, dtype=torch.float64) tensor(17.5195, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.1596, dtype=torch.float64) delta_t tensor(-4.1109, dtype=torch.float64)
4 gae_duplicate tensor(-8.0796, dtype=torch.float64) tensor(85.9376, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0186, dtype=torch.float64) delta_t tensor(-0.0920, dtype=torch.float64)
3 gae_duplicate tensor(-0.8584, dtype=torch.float64) tensor(9.8974, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1414, dtype=torch.float64) delta_t tensor(-0.2586, dtype=torch.float64)
2 gae_duplicate tensor(-0.5950, dtype=torch.float64) tensor(5.6719, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-492.88067626953125
value loss:284.86181640625
entropies:344.1943664550781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0817341804504395 seconds
19 rew tensor(0.5076, dtype=torch.float64) delta_t tensor(0.4941, dtype=torch.float64)
19 gae_duplicate tensor(0.3784, dtype=torch.float64) tensor(-9.8718, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3192, dtype=torch.float64) delta_t tensor(0.2660, dtype=torch.float64)
18 gae_duplicate tensor(0.2180, dtype=torch.float64) tensor(-6.3017, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5347, dtype=torch.float64) delta_t tensor(0.4824, dtype=torch.float64)
17 gae_duplicate tensor(0.4898, dtype=torch.float64) tensor(-10.5477, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2939, dtype=torch.float64) delta_t tensor(0.2030, dtype=torch.float64)
16 gae_duplicate tensor(0.0531, dtype=torch.float64) tensor(-4.8848, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5063, dtype=torch.float64) delta_t tensor(0.5404, dtype=torch.float64)
15 gae_duplicate tensor(0.4775, dtype=torch.float64) tensor(-11.1528, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2451, dtype=torch.float64) delta_t tensor(0.2297, dtype=torch.float64)
14 gae_duplicate tensor(0.0390, dtype=torch.float64) tensor(-5.4280, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5167, dtype=torch.float64) delta_t tensor(0.6278, dtype=torch.float64)
13 gae_duplicate tensor(0.5522, dtype=torch.float64) tensor(-10.8671, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0843, dtype=torch.float64) delta_t tensor(0.0952, dtype=torch.float64)
12 gae_duplicate tensor(-0.3410, dtype=torch.float64) tensor(-3.2479, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5295, dtype=torch.float64) delta_t tensor(0.5560, dtype=torch.float64)
11 gae_duplicate tensor(0.5157, dtype=torch.float64) tensor(-11.2464, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2386, dtype=torch.float64) delta_t tensor(0.2269, dtype=torch.float64)
10 gae_duplicate tensor(0.0830, dtype=torch.float64) tensor(-5.7626, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5368, dtype=torch.float64) delta_t tensor(0.5102, dtype=torch.float64)
9 gae_duplicate tensor(0.4907, dtype=torch.float64) tensor(-10.3233, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1993, dtype=torch.float64) delta_t tensor(0.1846, dtype=torch.float64)
8 gae_duplicate tensor(0.0154, dtype=torch.float64) tensor(-4.3748, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4970, dtype=torch.float64) delta_t tensor(0.5275, dtype=torch.float64)
7 gae_duplicate tensor(0.4968, dtype=torch.float64) tensor(-11.0316, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1599, dtype=torch.float64) delta_t tensor(0.1379, dtype=torch.float64)
6 gae_duplicate tensor(-0.0242, dtype=torch.float64) tensor(-3.8056, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0318, dtype=torch.float64) delta_t tensor(-0.8679, dtype=torch.float64)
5 gae_duplicate tensor(-2.2927, dtype=torch.float64) tensor(15.5808, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6345, dtype=torch.float64) delta_t tensor(-1.5355, dtype=torch.float64)
4 gae_duplicate tensor(-4.3794, dtype=torch.float64) tensor(35.7876, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0654, dtype=torch.float64) delta_t tensor(-0.0768, dtype=torch.float64)
3 gae_duplicate tensor(-0.7083, dtype=torch.float64) tensor(3.9553, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2427, dtype=torch.float64) delta_t tensor(-0.3764, dtype=torch.float64)
2 gae_duplicate tensor(-0.5070, dtype=torch.float64) tensor(7.7454, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2379.17431640625
value loss:102.93479919433594
entropies:343.61505126953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7396321296691895 seconds
19 rew tensor(0.5279, dtype=torch.float64) delta_t tensor(0.4914, dtype=torch.float64)
19 gae_duplicate tensor(0.4229, dtype=torch.float64) tensor(-10.2437, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4045, dtype=torch.float64) delta_t tensor(0.3343, dtype=torch.float64)
18 gae_duplicate tensor(0.2660, dtype=torch.float64) tensor(-7.7829, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5158, dtype=torch.float64) delta_t tensor(0.5041, dtype=torch.float64)
17 gae_duplicate tensor(0.3989, dtype=torch.float64) tensor(-9.6996, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3591, dtype=torch.float64) delta_t tensor(0.3915, dtype=torch.float64)
16 gae_duplicate tensor(0.3122, dtype=torch.float64) tensor(-8.3518, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4704, dtype=torch.float64) delta_t tensor(0.4925, dtype=torch.float64)
15 gae_duplicate tensor(0.2924, dtype=torch.float64) tensor(-8.8248, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3140, dtype=torch.float64) delta_t tensor(0.3328, dtype=torch.float64)
14 gae_duplicate tensor(0.2929, dtype=torch.float64) tensor(-7.8359, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5235, dtype=torch.float64) delta_t tensor(0.5733, dtype=torch.float64)
13 gae_duplicate tensor(0.5630, dtype=torch.float64) tensor(-11.8925, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2616, dtype=torch.float64) delta_t tensor(0.2603, dtype=torch.float64)
12 gae_duplicate tensor(0.1226, dtype=torch.float64) tensor(-6.1663, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5303, dtype=torch.float64) delta_t tensor(0.5319, dtype=torch.float64)
11 gae_duplicate tensor(0.4995, dtype=torch.float64) tensor(-10.5108, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2696, dtype=torch.float64) delta_t tensor(0.2509, dtype=torch.float64)
10 gae_duplicate tensor(0.0866, dtype=torch.float64) tensor(-5.6266, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5380, dtype=torch.float64) delta_t tensor(0.4955, dtype=torch.float64)
9 gae_duplicate tensor(0.4740, dtype=torch.float64) tensor(-11.0131, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2303, dtype=torch.float64) delta_t tensor(0.2016, dtype=torch.float64)
8 gae_duplicate tensor(0.0268, dtype=torch.float64) tensor(-4.5709, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4983, dtype=torch.float64) delta_t tensor(0.5150, dtype=torch.float64)
7 gae_duplicate tensor(0.4856, dtype=torch.float64) tensor(-10.9968, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1910, dtype=torch.float64) delta_t tensor(0.1498, dtype=torch.float64)
6 gae_duplicate tensor(-0.0109, dtype=torch.float64) tensor(-4.2221, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8933, dtype=torch.float64) delta_t tensor(-1.7281, dtype=torch.float64)
5 gae_duplicate tensor(-3.2655, dtype=torch.float64) tensor(33.2008, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4893, dtype=torch.float64) delta_t tensor(-3.3864, dtype=torch.float64)
4 gae_duplicate tensor(-5.3614, dtype=torch.float64) tensor(68.2443, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1272, dtype=torch.float64) delta_t tensor(-0.1786, dtype=torch.float64)
3 gae_duplicate tensor(-0.7846, dtype=torch.float64) tensor(10.2868, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2102, dtype=torch.float64) delta_t tensor(-0.3505, dtype=torch.float64)
2 gae_duplicate tensor(-0.5873, dtype=torch.float64) tensor(8.2469, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-213.53053283691406
value loss:195.9278564453125
entropies:342.6185302734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0908191204071045 seconds
19 rew tensor(0.5044, dtype=torch.float64) delta_t tensor(0.4510, dtype=torch.float64)
19 gae_duplicate tensor(0.3754, dtype=torch.float64) tensor(-9.3322, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3921, dtype=torch.float64) delta_t tensor(0.3236, dtype=torch.float64)
18 gae_duplicate tensor(0.2806, dtype=torch.float64) tensor(-7.1240, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4694, dtype=torch.float64) delta_t tensor(0.4599, dtype=torch.float64)
17 gae_duplicate tensor(0.2872, dtype=torch.float64) tensor(-8.7070, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3892, dtype=torch.float64) delta_t tensor(0.3514, dtype=torch.float64)
16 gae_duplicate tensor(0.2882, dtype=torch.float64) tensor(-8.1296, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4156, dtype=torch.float64) delta_t tensor(0.5236, dtype=torch.float64)
15 gae_duplicate tensor(0.1036, dtype=torch.float64) tensor(-11.7420, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3245, dtype=torch.float64) delta_t tensor(0.3835, dtype=torch.float64)
14 gae_duplicate tensor(0.3057, dtype=torch.float64) tensor(-7.4322, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4485, dtype=torch.float64) delta_t tensor(0.5217, dtype=torch.float64)
13 gae_duplicate tensor(0.0545, dtype=torch.float64) tensor(-10.5782, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2202, dtype=torch.float64) delta_t tensor(0.2267, dtype=torch.float64)
12 gae_duplicate tensor(0.1525, dtype=torch.float64) tensor(-5.8003, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5280, dtype=torch.float64) delta_t tensor(0.5592, dtype=torch.float64)
11 gae_duplicate tensor(0.5218, dtype=torch.float64) tensor(-12.2352, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1413, dtype=torch.float64) delta_t tensor(0.1705, dtype=torch.float64)
10 gae_duplicate tensor(-0.0250, dtype=torch.float64) tensor(-4.0816, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5066, dtype=torch.float64) delta_t tensor(0.4829, dtype=torch.float64)
9 gae_duplicate tensor(0.3880, dtype=torch.float64) tensor(-10.6213, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0731, dtype=torch.float64) delta_t tensor(0.0673, dtype=torch.float64)
8 gae_duplicate tensor(-0.4026, dtype=torch.float64) tensor(-2.6167, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4959, dtype=torch.float64) delta_t tensor(0.5370, dtype=torch.float64)
7 gae_duplicate tensor(0.4714, dtype=torch.float64) tensor(-9.7942, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0050, dtype=torch.float64) delta_t tensor(-0.0263, dtype=torch.float64)
6 gae_duplicate tensor(-0.6662, dtype=torch.float64) tensor(-0.4058, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3490, dtype=torch.float64) delta_t tensor(-1.2074, dtype=torch.float64)
5 gae_duplicate tensor(-1.4841, dtype=torch.float64) tensor(22.2374, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0871, dtype=torch.float64) delta_t tensor(-3.9945, dtype=torch.float64)
4 gae_duplicate tensor(-7.7577, dtype=torch.float64) tensor(78.5464, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0868, dtype=torch.float64) delta_t tensor(-0.1281, dtype=torch.float64)
3 gae_duplicate tensor(-0.8970, dtype=torch.float64) tensor(10.8959, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1883, dtype=torch.float64) delta_t tensor(-0.3112, dtype=torch.float64)
2 gae_duplicate tensor(-0.5052, dtype=torch.float64) tensor(7.6204, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-669.9550170898438
value loss:251.20469665527344
entropies:341.34002685546875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3879.7083)
ToM Target loss= tensor(2610.6416)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.452294111251831 seconds
19 rew tensor(0.4883, dtype=torch.float64) delta_t tensor(0.4521, dtype=torch.float64)
19 gae_duplicate tensor(0.2651, dtype=torch.float64) tensor(-9.6189, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3303, dtype=torch.float64) delta_t tensor(0.2540, dtype=torch.float64)
18 gae_duplicate tensor(0.0612, dtype=torch.float64) tensor(-6.2808, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4670, dtype=torch.float64) delta_t tensor(0.4082, dtype=torch.float64)
17 gae_duplicate tensor(0.2757, dtype=torch.float64) tensor(-8.7253, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3322, dtype=torch.float64) delta_t tensor(0.3412, dtype=torch.float64)
16 gae_duplicate tensor(0.0431, dtype=torch.float64) tensor(-7.5254, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4835, dtype=torch.float64) delta_t tensor(0.5459, dtype=torch.float64)
15 gae_duplicate tensor(0.2494, dtype=torch.float64) tensor(-11.3577, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2150, dtype=torch.float64) delta_t tensor(0.2665, dtype=torch.float64)
14 gae_duplicate tensor(0.1677, dtype=torch.float64) tensor(-6.1138, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5233, dtype=torch.float64) delta_t tensor(0.6115, dtype=torch.float64)
13 gae_duplicate tensor(0.5689, dtype=torch.float64) tensor(-12.6335, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1974, dtype=torch.float64) delta_t tensor(0.1739, dtype=torch.float64)
12 gae_duplicate tensor(0.1301, dtype=torch.float64) tensor(-4.2578, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5298, dtype=torch.float64) delta_t tensor(0.5574, dtype=torch.float64)
11 gae_duplicate tensor(0.5140, dtype=torch.float64) tensor(-10.4596, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1913, dtype=torch.float64) delta_t tensor(0.2000, dtype=torch.float64)
10 gae_duplicate tensor(0.1626, dtype=torch.float64) tensor(-5.0086, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5372, dtype=torch.float64) delta_t tensor(0.5134, dtype=torch.float64)
9 gae_duplicate tensor(0.4522, dtype=torch.float64) tensor(-10.1681, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1591, dtype=torch.float64) delta_t tensor(0.1370, dtype=torch.float64)
8 gae_duplicate tensor(0.0274, dtype=torch.float64) tensor(-3.5602, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4974, dtype=torch.float64) delta_t tensor(0.5274, dtype=torch.float64)
7 gae_duplicate tensor(0.4391, dtype=torch.float64) tensor(-11.3308, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1198, dtype=torch.float64) delta_t tensor(0.0783, dtype=torch.float64)
6 gae_duplicate tensor(0.0025, dtype=torch.float64) tensor(-2.6214, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2332, dtype=torch.float64) delta_t tensor(-1.0683, dtype=torch.float64)
5 gae_duplicate tensor(-1.9605, dtype=torch.float64) tensor(18.0527, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6468, dtype=torch.float64) delta_t tensor(-2.5495, dtype=torch.float64)
4 gae_duplicate tensor(-4.7605, dtype=torch.float64) tensor(50.8077, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0492, dtype=torch.float64) delta_t tensor(-0.0783, dtype=torch.float64)
3 gae_duplicate tensor(-0.6670, dtype=torch.float64) tensor(6.7952, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2507, dtype=torch.float64) delta_t tensor(-0.3753, dtype=torch.float64)
2 gae_duplicate tensor(-0.5898, dtype=torch.float64) tensor(7.1247, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1359.68017578125
value loss:132.32423400878906
entropies:340.4565734863281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.811160087585449 seconds
19 rew tensor(0.4598, dtype=torch.float64) delta_t tensor(0.4400, dtype=torch.float64)
19 gae_duplicate tensor(0.2816, dtype=torch.float64) tensor(-8.4498, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3252, dtype=torch.float64) delta_t tensor(0.3543, dtype=torch.float64)
18 gae_duplicate tensor(-0.0829, dtype=torch.float64) tensor(-8.7813, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2866, dtype=torch.float64) delta_t tensor(0.3008, dtype=torch.float64)
17 gae_duplicate tensor(-0.1938, dtype=torch.float64) tensor(-6.4970, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2275, dtype=torch.float64) delta_t tensor(0.1940, dtype=torch.float64)
16 gae_duplicate tensor(-0.5428, dtype=torch.float64) tensor(-5.0560, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0344, dtype=torch.float64) delta_t tensor(0.0885, dtype=torch.float64)
15 gae_duplicate tensor(-0.7139, dtype=torch.float64) tensor(-2.4486, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2642, dtype=torch.float64) delta_t tensor(0.2902, dtype=torch.float64)
14 gae_duplicate tensor(0.1271, dtype=torch.float64) tensor(-4.9027, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4960, dtype=torch.float64) delta_t tensor(0.5180, dtype=torch.float64)
13 gae_duplicate tensor(0.2488, dtype=torch.float64) tensor(-9.8513, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0347, dtype=torch.float64) delta_t tensor(0.0593, dtype=torch.float64)
12 gae_duplicate tensor(-0.2419, dtype=torch.float64) tensor(-2.3961, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5304, dtype=torch.float64) delta_t tensor(0.5407, dtype=torch.float64)
11 gae_duplicate tensor(0.5003, dtype=torch.float64) tensor(-11.4560, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1324, dtype=torch.float64) delta_t tensor(0.1136, dtype=torch.float64)
10 gae_duplicate tensor(-0.1289, dtype=torch.float64) tensor(-3.5550, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4809, dtype=torch.float64) delta_t tensor(0.4609, dtype=torch.float64)
9 gae_duplicate tensor(0.0811, dtype=torch.float64) tensor(-10.0160, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0362, dtype=torch.float64) delta_t tensor(0.0414, dtype=torch.float64)
8 gae_duplicate tensor(-0.1568, dtype=torch.float64) tensor(-1.1020, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4530, dtype=torch.float64) delta_t tensor(0.4985, dtype=torch.float64)
7 gae_duplicate tensor(0.1879, dtype=torch.float64) tensor(-9.1424, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1044, dtype=torch.float64) delta_t tensor(-0.1311, dtype=torch.float64)
6 gae_duplicate tensor(-0.5043, dtype=torch.float64) tensor(1.2711, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0664, dtype=torch.float64) delta_t tensor(-0.9305, dtype=torch.float64)
5 gae_duplicate tensor(-2.0395, dtype=torch.float64) tensor(19.3599, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0798, dtype=torch.float64) delta_t tensor(-3.0589, dtype=torch.float64)
4 gae_duplicate tensor(-6.5957, dtype=torch.float64) tensor(59.0518, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0310, dtype=torch.float64) delta_t tensor(-0.0179, dtype=torch.float64)
3 gae_duplicate tensor(-0.8346, dtype=torch.float64) tensor(6.9122, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2496, dtype=torch.float64) delta_t tensor(-0.3604, dtype=torch.float64)
2 gae_duplicate tensor(-0.7000, dtype=torch.float64) tensor(8.5528, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-712.4306030273438
value loss:184.30349731445312
entropies:339.9332275390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.155824899673462 seconds
19 rew tensor(0.5056, dtype=torch.float64) delta_t tensor(0.4244, dtype=torch.float64)
19 gae_duplicate tensor(0.2941, dtype=torch.float64) tensor(-7.9936, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4834, dtype=torch.float64) delta_t tensor(0.4042, dtype=torch.float64)
18 gae_duplicate tensor(0.3445, dtype=torch.float64) tensor(-8.2391, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5065, dtype=torch.float64) delta_t tensor(0.4740, dtype=torch.float64)
17 gae_duplicate tensor(0.3442, dtype=torch.float64) tensor(-9.6429, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2436, dtype=torch.float64) delta_t tensor(0.3110, dtype=torch.float64)
16 gae_duplicate tensor(-0.1582, dtype=torch.float64) tensor(-5.2648, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4901, dtype=torch.float64) delta_t tensor(0.5975, dtype=torch.float64)
15 gae_duplicate tensor(0.5240, dtype=torch.float64) tensor(-11.1808, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3008, dtype=torch.float64) delta_t tensor(0.3338, dtype=torch.float64)
14 gae_duplicate tensor(0.2808, dtype=torch.float64) tensor(-6.1960, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5324, dtype=torch.float64) delta_t tensor(0.5818, dtype=torch.float64)
13 gae_duplicate tensor(0.5562, dtype=torch.float64) tensor(-11.3647, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2796, dtype=torch.float64) delta_t tensor(0.2589, dtype=torch.float64)
12 gae_duplicate tensor(0.1423, dtype=torch.float64) tensor(-6.1774, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5398, dtype=torch.float64) delta_t tensor(0.5336, dtype=torch.float64)
11 gae_duplicate tensor(0.5302, dtype=torch.float64) tensor(-8.9358, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2805, dtype=torch.float64) delta_t tensor(0.2803, dtype=torch.float64)
10 gae_duplicate tensor(0.1676, dtype=torch.float64) tensor(-6.7154, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5156, dtype=torch.float64) delta_t tensor(0.4840, dtype=torch.float64)
9 gae_duplicate tensor(0.3364, dtype=torch.float64) tensor(-9.8146, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2163, dtype=torch.float64) delta_t tensor(0.1857, dtype=torch.float64)
8 gae_duplicate tensor(0.0296, dtype=torch.float64) tensor(-4.4660, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5005, dtype=torch.float64) delta_t tensor(0.5353, dtype=torch.float64)
7 gae_duplicate tensor(0.4987, dtype=torch.float64) tensor(-10.6372, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1521, dtype=torch.float64) delta_t tensor(0.0978, dtype=torch.float64)
6 gae_duplicate tensor(-0.1108, dtype=torch.float64) tensor(-2.9686, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5385, dtype=torch.float64) delta_t tensor(-1.3774, dtype=torch.float64)
5 gae_duplicate tensor(-2.8558, dtype=torch.float64) tensor(27.4501, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9333, dtype=torch.float64) delta_t tensor(-2.8311, dtype=torch.float64)
4 gae_duplicate tensor(-4.9944, dtype=torch.float64) tensor(60.0338, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1449, dtype=torch.float64) delta_t tensor(-0.1821, dtype=torch.float64)
3 gae_duplicate tensor(-0.7044, dtype=torch.float64) tensor(8.7923, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1524, dtype=torch.float64) delta_t tensor(-0.2978, dtype=torch.float64)
2 gae_duplicate tensor(-0.4330, dtype=torch.float64) tensor(7.2911, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:233.89442443847656
value loss:156.2669677734375
entropies:339.66986083984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.108538866043091 seconds
19 rew tensor(0.5082, dtype=torch.float64) delta_t tensor(0.4623, dtype=torch.float64)
19 gae_duplicate tensor(0.2674, dtype=torch.float64) tensor(-7.6360, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4035, dtype=torch.float64) delta_t tensor(0.3664, dtype=torch.float64)
18 gae_duplicate tensor(0.3012, dtype=torch.float64) tensor(-8.0870, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4890, dtype=torch.float64) delta_t tensor(0.5061, dtype=torch.float64)
17 gae_duplicate tensor(0.3844, dtype=torch.float64) tensor(-9.4988, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3903, dtype=torch.float64) delta_t tensor(0.3657, dtype=torch.float64)
16 gae_duplicate tensor(0.2774, dtype=torch.float64) tensor(-7.7820, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4655, dtype=torch.float64) delta_t tensor(0.5461, dtype=torch.float64)
15 gae_duplicate tensor(0.3594, dtype=torch.float64) tensor(-11.4613, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3194, dtype=torch.float64) delta_t tensor(0.3633, dtype=torch.float64)
14 gae_duplicate tensor(0.2893, dtype=torch.float64) tensor(-8.3318, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5039, dtype=torch.float64) delta_t tensor(0.5606, dtype=torch.float64)
13 gae_duplicate tensor(0.3326, dtype=torch.float64) tensor(-10.8605, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2821, dtype=torch.float64) delta_t tensor(0.2651, dtype=torch.float64)
12 gae_duplicate tensor(0.0603, dtype=torch.float64) tensor(-6.2299, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2513, dtype=torch.float64) delta_t tensor(0.2846, dtype=torch.float64)
11 gae_duplicate tensor(-1.0845, dtype=torch.float64) tensor(-4.6477, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2694, dtype=torch.float64) delta_t tensor(0.2588, dtype=torch.float64)
10 gae_duplicate tensor(0.0899, dtype=torch.float64) tensor(-5.2217, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5109, dtype=torch.float64) delta_t tensor(0.4876, dtype=torch.float64)
9 gae_duplicate tensor(0.2799, dtype=torch.float64) tensor(-9.0818, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2427, dtype=torch.float64) delta_t tensor(0.2094, dtype=torch.float64)
8 gae_duplicate tensor(-0.0308, dtype=torch.float64) tensor(-5.9656, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4707, dtype=torch.float64) delta_t tensor(0.4998, dtype=torch.float64)
7 gae_duplicate tensor(0.2873, dtype=torch.float64) tensor(-10.3948, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1902, dtype=torch.float64) delta_t tensor(0.1783, dtype=torch.float64)
6 gae_duplicate tensor(-0.0867, dtype=torch.float64) tensor(-4.7451, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1912, dtype=torch.float64) delta_t tensor(-1.0315, dtype=torch.float64)
5 gae_duplicate tensor(-1.3973, dtype=torch.float64) tensor(20.9755, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0735, dtype=torch.float64) delta_t tensor(-0.9472, dtype=torch.float64)
4 gae_duplicate tensor(-2.0972, dtype=torch.float64) tensor(20.8537, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0724, dtype=torch.float64) delta_t tensor(-0.0530, dtype=torch.float64)
3 gae_duplicate tensor(-0.3722, dtype=torch.float64) tensor(2.7668, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2382, dtype=torch.float64) delta_t tensor(-0.3355, dtype=torch.float64)
2 gae_duplicate tensor(-0.4517, dtype=torch.float64) tensor(7.0695, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3055.543701171875
value loss:55.724830627441406
entropies:338.8858642578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.809731960296631 seconds
19 rew tensor(0.4745, dtype=torch.float64) delta_t tensor(0.4009, dtype=torch.float64)
19 gae_duplicate tensor(0.2162, dtype=torch.float64) tensor(-7.0455, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4081, dtype=torch.float64) delta_t tensor(0.3289, dtype=torch.float64)
18 gae_duplicate tensor(0.2824, dtype=torch.float64) tensor(-6.7584, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5096, dtype=torch.float64) delta_t tensor(0.4418, dtype=torch.float64)
17 gae_duplicate tensor(0.2677, dtype=torch.float64) tensor(-10.5462, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2946, dtype=torch.float64) delta_t tensor(0.2482, dtype=torch.float64)
16 gae_duplicate tensor(0.0567, dtype=torch.float64) tensor(-6.6143, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4803, dtype=torch.float64) delta_t tensor(0.5867, dtype=torch.float64)
15 gae_duplicate tensor(0.4687, dtype=torch.float64) tensor(-11.1396, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1956, dtype=torch.float64) delta_t tensor(0.2225, dtype=torch.float64)
14 gae_duplicate tensor(0.0424, dtype=torch.float64) tensor(-4.5517, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5284, dtype=torch.float64) delta_t tensor(0.6307, dtype=torch.float64)
13 gae_duplicate tensor(0.6148, dtype=torch.float64) tensor(-12.1277, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1435, dtype=torch.float64) delta_t tensor(0.1284, dtype=torch.float64)
12 gae_duplicate tensor(-0.0679, dtype=torch.float64) tensor(-3.1402, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5425, dtype=torch.float64) delta_t tensor(0.5559, dtype=torch.float64)
11 gae_duplicate tensor(0.5220, dtype=torch.float64) tensor(-11.3201, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1507, dtype=torch.float64) delta_t tensor(0.1429, dtype=torch.float64)
10 gae_duplicate tensor(-0.1288, dtype=torch.float64) tensor(-3.9018, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5428, dtype=torch.float64) delta_t tensor(0.5340, dtype=torch.float64)
9 gae_duplicate tensor(0.5137, dtype=torch.float64) tensor(-9.5335, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1107, dtype=torch.float64) delta_t tensor(0.0961, dtype=torch.float64)
8 gae_duplicate tensor(-0.1566, dtype=torch.float64) tensor(-2.8291, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5023, dtype=torch.float64) delta_t tensor(0.5499, dtype=torch.float64)
7 gae_duplicate tensor(0.5242, dtype=torch.float64) tensor(-11.6140, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0707, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
6 gae_duplicate tensor(-0.2438, dtype=torch.float64) tensor(-1.8922, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2674, dtype=torch.float64) delta_t tensor(-1.1133, dtype=torch.float64)
5 gae_duplicate tensor(-1.3615, dtype=torch.float64) tensor(20.6330, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1149, dtype=torch.float64) delta_t tensor(-3.0425, dtype=torch.float64)
4 gae_duplicate tensor(-6.8702, dtype=torch.float64) tensor(63.5508, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1383, dtype=torch.float64) delta_t tensor(-0.2042, dtype=torch.float64)
3 gae_duplicate tensor(-0.7876, dtype=torch.float64) tensor(10.3173, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1447, dtype=torch.float64) delta_t tensor(-0.2639, dtype=torch.float64)
2 gae_duplicate tensor(-0.4457, dtype=torch.float64) tensor(5.5970, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:66.32550048828125
value loss:165.93350219726562
entropies:337.5592346191406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3856.9255)
ToM Target loss= tensor(2607.2493)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.980903148651123 seconds
19 rew tensor(0.4861, dtype=torch.float64) delta_t tensor(0.4774, dtype=torch.float64)
19 gae_duplicate tensor(0.2946, dtype=torch.float64) tensor(-8.9672, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3633, dtype=torch.float64) delta_t tensor(0.3224, dtype=torch.float64)
18 gae_duplicate tensor(0.1453, dtype=torch.float64) tensor(-6.8813, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5161, dtype=torch.float64) delta_t tensor(0.4590, dtype=torch.float64)
17 gae_duplicate tensor(0.3451, dtype=torch.float64) tensor(-10.2960, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3135, dtype=torch.float64) delta_t tensor(0.2819, dtype=torch.float64)
16 gae_duplicate tensor(0.0504, dtype=torch.float64) tensor(-7.1659, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5003, dtype=torch.float64) delta_t tensor(0.5222, dtype=torch.float64)
15 gae_duplicate tensor(0.3434, dtype=torch.float64) tensor(-10.6243, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2596, dtype=torch.float64) delta_t tensor(0.2526, dtype=torch.float64)
14 gae_duplicate tensor(0.0358, dtype=torch.float64) tensor(-5.8273, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5161, dtype=torch.float64) delta_t tensor(0.6459, dtype=torch.float64)
13 gae_duplicate tensor(0.5919, dtype=torch.float64) tensor(-13.0197, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2044, dtype=torch.float64) delta_t tensor(0.2112, dtype=torch.float64)
12 gae_duplicate tensor(0.1103, dtype=torch.float64) tensor(-4.9382, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5374, dtype=torch.float64) delta_t tensor(0.5598, dtype=torch.float64)
11 gae_duplicate tensor(0.5103, dtype=torch.float64) tensor(-10.9611, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2127, dtype=torch.float64) delta_t tensor(0.2031, dtype=torch.float64)
10 gae_duplicate tensor(0.1670, dtype=torch.float64) tensor(-4.1705, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5445, dtype=torch.float64) delta_t tensor(0.5175, dtype=torch.float64)
9 gae_duplicate tensor(0.4792, dtype=torch.float64) tensor(-10.3237, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1725, dtype=torch.float64) delta_t tensor(0.1487, dtype=torch.float64)
8 gae_duplicate tensor(0.0610, dtype=torch.float64) tensor(-3.2968, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5039, dtype=torch.float64) delta_t tensor(0.5277, dtype=torch.float64)
7 gae_duplicate tensor(0.4802, dtype=torch.float64) tensor(-8.6110, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1322, dtype=torch.float64) delta_t tensor(0.1419, dtype=torch.float64)
6 gae_duplicate tensor(0.0063, dtype=torch.float64) tensor(-3.3185, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3140, dtype=torch.float64) delta_t tensor(-1.1500, dtype=torch.float64)
5 gae_duplicate tensor(-1.3640, dtype=torch.float64) tensor(20.8686, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9448, dtype=torch.float64) delta_t tensor(-1.8164, dtype=torch.float64)
4 gae_duplicate tensor(-4.5877, dtype=torch.float64) tensor(37.3771, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0949, dtype=torch.float64) delta_t tensor(-0.0541, dtype=torch.float64)
3 gae_duplicate tensor(-0.6644, dtype=torch.float64) tensor(5.3302, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3066, dtype=torch.float64) delta_t tensor(-0.4510, dtype=torch.float64)
2 gae_duplicate tensor(-0.5933, dtype=torch.float64) tensor(8.3018, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1881.4998779296875
value loss:112.52082824707031
entropies:336.2236633300781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.978554725646973 seconds
19 rew tensor(0.4894, dtype=torch.float64) delta_t tensor(0.4243, dtype=torch.float64)
19 gae_duplicate tensor(0.2717, dtype=torch.float64) tensor(-6.8711, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4182, dtype=torch.float64) delta_t tensor(0.3342, dtype=torch.float64)
18 gae_duplicate tensor(0.2738, dtype=torch.float64) tensor(-7.9859, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4901, dtype=torch.float64) delta_t tensor(0.4180, dtype=torch.float64)
17 gae_duplicate tensor(0.2753, dtype=torch.float64) tensor(-8.7585, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3842, dtype=torch.float64) delta_t tensor(0.4240, dtype=torch.float64)
16 gae_duplicate tensor(0.2680, dtype=torch.float64) tensor(-8.7203, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4761, dtype=torch.float64) delta_t tensor(0.5480, dtype=torch.float64)
15 gae_duplicate tensor(0.2536, dtype=torch.float64) tensor(-8.6364, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3111, dtype=torch.float64) delta_t tensor(0.3609, dtype=torch.float64)
14 gae_duplicate tensor(0.3274, dtype=torch.float64) tensor(-7.4019, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5304, dtype=torch.float64) delta_t tensor(0.5913, dtype=torch.float64)
13 gae_duplicate tensor(0.5628, dtype=torch.float64) tensor(-10.4327, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2717, dtype=torch.float64) delta_t tensor(0.2403, dtype=torch.float64)
12 gae_duplicate tensor(0.1353, dtype=torch.float64) tensor(-5.3093, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5447, dtype=torch.float64) delta_t tensor(0.5378, dtype=torch.float64)
11 gae_duplicate tensor(0.5086, dtype=torch.float64) tensor(-10.3778, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2725, dtype=torch.float64) delta_t tensor(0.2587, dtype=torch.float64)
10 gae_duplicate tensor(0.1156, dtype=torch.float64) tensor(-5.6620, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5452, dtype=torch.float64) delta_t tensor(0.5060, dtype=torch.float64)
9 gae_duplicate tensor(0.4839, dtype=torch.float64) tensor(-10.7250, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2322, dtype=torch.float64) delta_t tensor(0.2021, dtype=torch.float64)
8 gae_duplicate tensor(0.0499, dtype=torch.float64) tensor(-5.3765, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5046, dtype=torch.float64) delta_t tensor(0.5317, dtype=torch.float64)
7 gae_duplicate tensor(0.5045, dtype=torch.float64) tensor(-9.6236, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1919, dtype=torch.float64) delta_t tensor(0.1316, dtype=torch.float64)
6 gae_duplicate tensor(0.0003, dtype=torch.float64) tensor(-3.7130, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1277, dtype=torch.float64) delta_t tensor(-0.9585, dtype=torch.float64)
5 gae_duplicate tensor(-1.9388, dtype=torch.float64) tensor(18.1242, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5696, dtype=torch.float64) delta_t tensor(-3.4712, dtype=torch.float64)
4 gae_duplicate tensor(-5.3778, dtype=torch.float64) tensor(73.6364, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1662, dtype=torch.float64) delta_t tensor(-0.2488, dtype=torch.float64)
3 gae_duplicate tensor(-0.7196, dtype=torch.float64) tensor(11.7806, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1727, dtype=torch.float64) delta_t tensor(-0.3053, dtype=torch.float64)
2 gae_duplicate tensor(-0.4333, dtype=torch.float64) tensor(6.7332, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-127.01904296875
value loss:167.40652465820312
entropies:334.343017578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6667320728302 seconds
19 rew tensor(0.5394, dtype=torch.float64) delta_t tensor(0.5670, dtype=torch.float64)
19 gae_duplicate tensor(0.3519, dtype=torch.float64) tensor(-10.8204, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3844, dtype=torch.float64) delta_t tensor(0.3760, dtype=torch.float64)
18 gae_duplicate tensor(0.1480, dtype=torch.float64) tensor(-8.3082, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5102, dtype=torch.float64) delta_t tensor(0.5502, dtype=torch.float64)
17 gae_duplicate tensor(0.3623, dtype=torch.float64) tensor(-11.1834, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3031, dtype=torch.float64) delta_t tensor(0.2940, dtype=torch.float64)
16 gae_duplicate tensor(0.1332, dtype=torch.float64) tensor(-6.0065, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5069, dtype=torch.float64) delta_t tensor(0.5562, dtype=torch.float64)
15 gae_duplicate tensor(0.3510, dtype=torch.float64) tensor(-11.4621, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2310, dtype=torch.float64) delta_t tensor(0.2433, dtype=torch.float64)
14 gae_duplicate tensor(0.1323, dtype=torch.float64) tensor(-6.7744, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5250, dtype=torch.float64) delta_t tensor(0.5744, dtype=torch.float64)
13 gae_duplicate tensor(0.4319, dtype=torch.float64) tensor(-10.9518, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1700, dtype=torch.float64) delta_t tensor(0.1922, dtype=torch.float64)
12 gae_duplicate tensor(0.1312, dtype=torch.float64) tensor(-4.0741, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5322, dtype=torch.float64) delta_t tensor(0.5547, dtype=torch.float64)
11 gae_duplicate tensor(0.4932, dtype=torch.float64) tensor(-8.8309, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1703, dtype=torch.float64) delta_t tensor(0.1605, dtype=torch.float64)
10 gae_duplicate tensor(0.0255, dtype=torch.float64) tensor(-3.4066, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5338, dtype=torch.float64) delta_t tensor(0.4856, dtype=torch.float64)
9 gae_duplicate tensor(0.4674, dtype=torch.float64) tensor(-10.1378, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1166, dtype=torch.float64) delta_t tensor(0.0874, dtype=torch.float64)
8 gae_duplicate tensor(-0.0325, dtype=torch.float64) tensor(-1.9749, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4797, dtype=torch.float64) delta_t tensor(0.4799, dtype=torch.float64)
7 gae_duplicate tensor(0.4517, dtype=torch.float64) tensor(-8.6390, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0367, dtype=torch.float64) delta_t tensor(0.0210, dtype=torch.float64)
6 gae_duplicate tensor(-0.0857, dtype=torch.float64) tensor(-1.3579, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5509, dtype=torch.float64) delta_t tensor(-1.4132, dtype=torch.float64)
5 gae_duplicate tensor(-2.1310, dtype=torch.float64) tensor(22.3103, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0870, dtype=torch.float64) delta_t tensor(-1.9708, dtype=torch.float64)
4 gae_duplicate tensor(-4.5286, dtype=torch.float64) tensor(41.6799, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0638, dtype=torch.float64) delta_t tensor(0.0864, dtype=torch.float64)
3 gae_duplicate tensor(-0.5574, dtype=torch.float64) tensor(1.9023, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2923, dtype=torch.float64) delta_t tensor(-0.4037, dtype=torch.float64)
2 gae_duplicate tensor(-0.5405, dtype=torch.float64) tensor(7.0230, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1584.986572265625
value loss:111.56361389160156
entropies:332.1828308105469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.745574951171875 seconds
19 rew tensor(0.5101, dtype=torch.float64) delta_t tensor(0.4760, dtype=torch.float64)
19 gae_duplicate tensor(0.2859, dtype=torch.float64) tensor(-9.4588, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3827, dtype=torch.float64) delta_t tensor(0.3700, dtype=torch.float64)
18 gae_duplicate tensor(0.2670, dtype=torch.float64) tensor(-7.0614, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5534, dtype=torch.float64) delta_t tensor(0.5485, dtype=torch.float64)
17 gae_duplicate tensor(0.4967, dtype=torch.float64) tensor(-10.4539, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2625, dtype=torch.float64) delta_t tensor(0.2681, dtype=torch.float64)
16 gae_duplicate tensor(-0.0389, dtype=torch.float64) tensor(-5.9292, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5033, dtype=torch.float64) delta_t tensor(0.6111, dtype=torch.float64)
15 gae_duplicate tensor(0.4870, dtype=torch.float64) tensor(-12.5162, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2774, dtype=torch.float64) delta_t tensor(0.2932, dtype=torch.float64)
14 gae_duplicate tensor(0.0407, dtype=torch.float64) tensor(-6.4902, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4741, dtype=torch.float64) delta_t tensor(0.5477, dtype=torch.float64)
13 gae_duplicate tensor(0.2870, dtype=torch.float64) tensor(-10.7558, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2860, dtype=torch.float64) delta_t tensor(0.2745, dtype=torch.float64)
12 gae_duplicate tensor(0.0404, dtype=torch.float64) tensor(-5.1266, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4746, dtype=torch.float64) delta_t tensor(0.4871, dtype=torch.float64)
11 gae_duplicate tensor(0.3167, dtype=torch.float64) tensor(-8.8328, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2867, dtype=torch.float64) delta_t tensor(0.2756, dtype=torch.float64)
10 gae_duplicate tensor(0.0065, dtype=torch.float64) tensor(-6.2460, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4816, dtype=torch.float64) delta_t tensor(0.4245, dtype=torch.float64)
9 gae_duplicate tensor(0.2303, dtype=torch.float64) tensor(-8.9389, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2231, dtype=torch.float64) delta_t tensor(0.1903, dtype=torch.float64)
8 gae_duplicate tensor(-0.1024, dtype=torch.float64) tensor(-4.3418, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4039, dtype=torch.float64) delta_t tensor(0.3795, dtype=torch.float64)
7 gae_duplicate tensor(-0.0970, dtype=torch.float64) tensor(-7.9545, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0870, dtype=torch.float64) delta_t tensor(0.0453, dtype=torch.float64)
6 gae_duplicate tensor(-0.3109, dtype=torch.float64) tensor(-1.9270, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0618, dtype=torch.float64) delta_t tensor(-0.9285, dtype=torch.float64)
5 gae_duplicate tensor(-1.4654, dtype=torch.float64) tensor(20.2631, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5081, dtype=torch.float64) delta_t tensor(-2.4280, dtype=torch.float64)
4 gae_duplicate tensor(-5.9934, dtype=torch.float64) tensor(51.6773, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0326, dtype=torch.float64) delta_t tensor(0.0149, dtype=torch.float64)
3 gae_duplicate tensor(-0.6576, dtype=torch.float64) tensor(3.9123, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2417, dtype=torch.float64) delta_t tensor(-0.3546, dtype=torch.float64)
2 gae_duplicate tensor(-0.5948, dtype=torch.float64) tensor(7.6699, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1126.3902587890625
value loss:138.55072021484375
entropies:330.24188232421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7648680210113525 seconds
19 rew tensor(0.5492, dtype=torch.float64) delta_t tensor(0.5524, dtype=torch.float64)
19 gae_duplicate tensor(0.4581, dtype=torch.float64) tensor(-9.5040, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3775, dtype=torch.float64) delta_t tensor(0.3498, dtype=torch.float64)
18 gae_duplicate tensor(0.1245, dtype=torch.float64) tensor(-7.2461, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5498, dtype=torch.float64) delta_t tensor(0.5351, dtype=torch.float64)
17 gae_duplicate tensor(0.4672, dtype=torch.float64) tensor(-10.6941, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3783, dtype=torch.float64) delta_t tensor(0.3347, dtype=torch.float64)
16 gae_duplicate tensor(0.1153, dtype=torch.float64) tensor(-6.3195, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5152, dtype=torch.float64) delta_t tensor(0.6903, dtype=torch.float64)
15 gae_duplicate tensor(0.5064, dtype=torch.float64) tensor(-14.4892, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3222, dtype=torch.float64) delta_t tensor(0.3956, dtype=torch.float64)
14 gae_duplicate tensor(0.2342, dtype=torch.float64) tensor(-9.6569, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5509, dtype=torch.float64) delta_t tensor(0.6645, dtype=torch.float64)
13 gae_duplicate tensor(0.5393, dtype=torch.float64) tensor(-14.5699, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3160, dtype=torch.float64) delta_t tensor(0.3757, dtype=torch.float64)
12 gae_duplicate tensor(0.1975, dtype=torch.float64) tensor(-9.0491, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5449, dtype=torch.float64) delta_t tensor(0.6104, dtype=torch.float64)
11 gae_duplicate tensor(0.4880, dtype=torch.float64) tensor(-12.3006, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1860, dtype=torch.float64) delta_t tensor(0.2423, dtype=torch.float64)
10 gae_duplicate tensor(0.0289, dtype=torch.float64) tensor(-5.6773, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5257, dtype=torch.float64) delta_t tensor(0.5557, dtype=torch.float64)
9 gae_duplicate tensor(0.4489, dtype=torch.float64) tensor(-10.6955, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6644, dtype=torch.float64) delta_t tensor(-0.6246, dtype=torch.float64)
8 gae_duplicate tensor(-4.8997, dtype=torch.float64) tensor(6.6750, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4583, dtype=torch.float64) delta_t tensor(0.5352, dtype=torch.float64)
7 gae_duplicate tensor(-0.0921, dtype=torch.float64) tensor(-9.2679, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1628, dtype=torch.float64) delta_t tensor(0.1965, dtype=torch.float64)
6 gae_duplicate tensor(0.0975, dtype=torch.float64) tensor(-3.7285, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2865, dtype=torch.float64) delta_t tensor(-1.1238, dtype=torch.float64)
5 gae_duplicate tensor(-1.9730, dtype=torch.float64) tensor(21.2304, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0519, dtype=torch.float64) delta_t tensor(-2.9737, dtype=torch.float64)
4 gae_duplicate tensor(-8.4689, dtype=torch.float64) tensor(71.9476, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0365, dtype=torch.float64) delta_t tensor(-0.0702, dtype=torch.float64)
3 gae_duplicate tensor(-1.1435, dtype=torch.float64) tensor(5.0041, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3341, dtype=torch.float64) delta_t tensor(-0.4266, dtype=torch.float64)
2 gae_duplicate tensor(-0.6994, dtype=torch.float64) tensor(9.0506, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:413.1496276855469
value loss:264.6717529296875
entropies:327.96417236328125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3835.5503)
ToM Target loss= tensor(2590.3184)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.930382013320923 seconds
19 rew tensor(0.5097, dtype=torch.float64) delta_t tensor(0.4695, dtype=torch.float64)
19 gae_duplicate tensor(0.3683, dtype=torch.float64) tensor(-6.5334, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4260, dtype=torch.float64) delta_t tensor(0.3834, dtype=torch.float64)
18 gae_duplicate tensor(0.3489, dtype=torch.float64) tensor(-8.9187, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5042, dtype=torch.float64) delta_t tensor(0.5448, dtype=torch.float64)
17 gae_duplicate tensor(0.2936, dtype=torch.float64) tensor(-12.4103, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3049, dtype=torch.float64) delta_t tensor(0.3224, dtype=torch.float64)
16 gae_duplicate tensor(0.1981, dtype=torch.float64) tensor(-6.5438, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5188, dtype=torch.float64) delta_t tensor(0.6099, dtype=torch.float64)
15 gae_duplicate tensor(0.5958, dtype=torch.float64) tensor(-12.9117, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2794, dtype=torch.float64) delta_t tensor(0.2524, dtype=torch.float64)
14 gae_duplicate tensor(0.2195, dtype=torch.float64) tensor(-5.2146, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5031, dtype=torch.float64) delta_t tensor(0.4912, dtype=torch.float64)
13 gae_duplicate tensor(0.3434, dtype=torch.float64) tensor(-11.7915, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2305, dtype=torch.float64) delta_t tensor(0.2344, dtype=torch.float64)
12 gae_duplicate tensor(0.1182, dtype=torch.float64) tensor(-5.1757, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5188, dtype=torch.float64) delta_t tensor(0.5144, dtype=torch.float64)
11 gae_duplicate tensor(0.4102, dtype=torch.float64) tensor(-9.6821, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1750, dtype=torch.float64) delta_t tensor(0.1474, dtype=torch.float64)
10 gae_duplicate tensor(0.0254, dtype=torch.float64) tensor(-2.8971, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4904, dtype=torch.float64) delta_t tensor(0.4420, dtype=torch.float64)
9 gae_duplicate tensor(0.3056, dtype=torch.float64) tensor(-8.4224, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0647, dtype=torch.float64) delta_t tensor(0.0067, dtype=torch.float64)
8 gae_duplicate tensor(-0.1656, dtype=torch.float64) tensor(-0.7168, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5053, dtype=torch.float64) delta_t tensor(0.5144, dtype=torch.float64)
7 gae_duplicate tensor(0.4629, dtype=torch.float64) tensor(-8.2279, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0322, dtype=torch.float64) delta_t tensor(-0.0753, dtype=torch.float64)
6 gae_duplicate tensor(-0.2478, dtype=torch.float64) tensor(0.6632, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1576, dtype=torch.float64) delta_t tensor(-1.0101, dtype=torch.float64)
5 gae_duplicate tensor(-1.4063, dtype=torch.float64) tensor(18.7298, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6619, dtype=torch.float64) delta_t tensor(-1.5298, dtype=torch.float64)
4 gae_duplicate tensor(-3.9600, dtype=torch.float64) tensor(27.0274, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1436, dtype=torch.float64) delta_t tensor(-0.1376, dtype=torch.float64)
3 gae_duplicate tensor(-0.6794, dtype=torch.float64) tensor(5.6984, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3136, dtype=torch.float64) delta_t tensor(-0.4843, dtype=torch.float64)
2 gae_duplicate tensor(-0.5649, dtype=torch.float64) tensor(9.3737, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1961.5233154296875
value loss:94.71807098388672
entropies:325.76837158203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.020481824874878 seconds
19 rew tensor(0.4979, dtype=torch.float64) delta_t tensor(0.4242, dtype=torch.float64)
19 gae_duplicate tensor(0.2020, dtype=torch.float64) tensor(-7.7465, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3771, dtype=torch.float64) delta_t tensor(0.2882, dtype=torch.float64)
18 gae_duplicate tensor(0.2596, dtype=torch.float64) tensor(-5.2515, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5186, dtype=torch.float64) delta_t tensor(0.4471, dtype=torch.float64)
17 gae_duplicate tensor(0.2865, dtype=torch.float64) tensor(-9.4407, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2986, dtype=torch.float64) delta_t tensor(0.2022, dtype=torch.float64)
16 gae_duplicate tensor(0.0420, dtype=torch.float64) tensor(-4.5747, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5115, dtype=torch.float64) delta_t tensor(0.6323, dtype=torch.float64)
15 gae_duplicate tensor(0.5497, dtype=torch.float64) tensor(-10.5444, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2177, dtype=torch.float64) delta_t tensor(0.2932, dtype=torch.float64)
14 gae_duplicate tensor(0.0583, dtype=torch.float64) tensor(-6.5557, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5309, dtype=torch.float64) delta_t tensor(0.6258, dtype=torch.float64)
13 gae_duplicate tensor(0.5749, dtype=torch.float64) tensor(-13.7087, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2460, dtype=torch.float64) delta_t tensor(0.2411, dtype=torch.float64)
12 gae_duplicate tensor(0.0671, dtype=torch.float64) tensor(-4.4002, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5460, dtype=torch.float64) delta_t tensor(0.5536, dtype=torch.float64)
11 gae_duplicate tensor(0.5120, dtype=torch.float64) tensor(-11.2909, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2467, dtype=torch.float64) delta_t tensor(0.2503, dtype=torch.float64)
10 gae_duplicate tensor(0.0438, dtype=torch.float64) tensor(-5.5510, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5465, dtype=torch.float64) delta_t tensor(0.5271, dtype=torch.float64)
9 gae_duplicate tensor(0.4761, dtype=torch.float64) tensor(-11.9914, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2060, dtype=torch.float64) delta_t tensor(0.1852, dtype=torch.float64)
8 gae_duplicate tensor(-0.0068, dtype=torch.float64) tensor(-3.8176, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5054, dtype=torch.float64) delta_t tensor(0.5524, dtype=torch.float64)
7 gae_duplicate tensor(0.5016, dtype=torch.float64) tensor(-11.5716, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1653, dtype=torch.float64) delta_t tensor(0.1170, dtype=torch.float64)
6 gae_duplicate tensor(-0.1219, dtype=torch.float64) tensor(-2.4439, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4250, dtype=torch.float64) delta_t tensor(-1.2622, dtype=torch.float64)
5 gae_duplicate tensor(-1.3387, dtype=torch.float64) tensor(25.9909, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3056, dtype=torch.float64) delta_t tensor(-3.2116, dtype=torch.float64)
4 gae_duplicate tensor(-6.8512, dtype=torch.float64) tensor(60.9121, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1083, dtype=torch.float64) delta_t tensor(-0.1797, dtype=torch.float64)
3 gae_duplicate tensor(-0.7999, dtype=torch.float64) tensor(10.2357, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1515, dtype=torch.float64) delta_t tensor(-0.2844, dtype=torch.float64)
2 gae_duplicate tensor(-0.5691, dtype=torch.float64) tensor(6.9829, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:169.9549102783203
value loss:188.40126037597656
entropies:324.013671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8069891929626465 seconds
19 rew tensor(0.5430, dtype=torch.float64) delta_t tensor(0.4776, dtype=torch.float64)
19 gae_duplicate tensor(0.3619, dtype=torch.float64) tensor(-8.2037, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4670, dtype=torch.float64) delta_t tensor(0.3874, dtype=torch.float64)
18 gae_duplicate tensor(0.3072, dtype=torch.float64) tensor(-7.5762, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4897, dtype=torch.float64) delta_t tensor(0.4584, dtype=torch.float64)
17 gae_duplicate tensor(0.3065, dtype=torch.float64) tensor(-9.1674, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3726, dtype=torch.float64) delta_t tensor(0.3228, dtype=torch.float64)
16 gae_duplicate tensor(0.3038, dtype=torch.float64) tensor(-6.7095, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4142, dtype=torch.float64) delta_t tensor(0.4452, dtype=torch.float64)
15 gae_duplicate tensor(0.0580, dtype=torch.float64) tensor(-7.5802, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2302, dtype=torch.float64) delta_t tensor(0.2627, dtype=torch.float64)
14 gae_duplicate tensor(0.1398, dtype=torch.float64) tensor(-5.0420, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5175, dtype=torch.float64) delta_t tensor(0.5834, dtype=torch.float64)
13 gae_duplicate tensor(0.4773, dtype=torch.float64) tensor(-10.8239, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1148, dtype=torch.float64) delta_t tensor(0.1430, dtype=torch.float64)
12 gae_duplicate tensor(-0.0230, dtype=torch.float64) tensor(-4.3787, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5389, dtype=torch.float64) delta_t tensor(0.5544, dtype=torch.float64)
11 gae_duplicate tensor(0.4902, dtype=torch.float64) tensor(-11.1877, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1085, dtype=torch.float64) delta_t tensor(0.1014, dtype=torch.float64)
10 gae_duplicate tensor(-0.0395, dtype=torch.float64) tensor(-3.4380, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5458, dtype=torch.float64) delta_t tensor(0.5250, dtype=torch.float64)
9 gae_duplicate tensor(0.4453, dtype=torch.float64) tensor(-11.8057, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0678, dtype=torch.float64) delta_t tensor(0.0440, dtype=torch.float64)
8 gae_duplicate tensor(-0.1415, dtype=torch.float64) tensor(-2.0674, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5046, dtype=torch.float64) delta_t tensor(0.5382, dtype=torch.float64)
7 gae_duplicate tensor(0.4635, dtype=torch.float64) tensor(-8.4621, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0270, dtype=torch.float64) delta_t tensor(-0.0076, dtype=torch.float64)
6 gae_duplicate tensor(-0.2318, dtype=torch.float64) tensor(-0.9188, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3061, dtype=torch.float64) delta_t tensor(-1.1618, dtype=torch.float64)
5 gae_duplicate tensor(-2.2227, dtype=torch.float64) tensor(21.2773, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7016, dtype=torch.float64) delta_t tensor(-2.6241, dtype=torch.float64)
4 gae_duplicate tensor(-6.7361, dtype=torch.float64) tensor(50.8795, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0701, dtype=torch.float64) delta_t tensor(-0.1013, dtype=torch.float64)
3 gae_duplicate tensor(-0.7440, dtype=torch.float64) tensor(4.3559, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2057, dtype=torch.float64) delta_t tensor(-0.3428, dtype=torch.float64)
2 gae_duplicate tensor(-0.5468, dtype=torch.float64) tensor(7.4065, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:638.739013671875
value loss:188.6306610107422
entropies:322.6993408203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.986634016036987 seconds
19 rew tensor(0.4910, dtype=torch.float64) delta_t tensor(0.4643, dtype=torch.float64)
19 gae_duplicate tensor(0.2968, dtype=torch.float64) tensor(-7.5710, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4336, dtype=torch.float64) delta_t tensor(0.4316, dtype=torch.float64)
18 gae_duplicate tensor(0.1990, dtype=torch.float64) tensor(-9.5932, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4898, dtype=torch.float64) delta_t tensor(0.4628, dtype=torch.float64)
17 gae_duplicate tensor(0.3488, dtype=torch.float64) tensor(-8.1880, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2344, dtype=torch.float64) delta_t tensor(0.2711, dtype=torch.float64)
16 gae_duplicate tensor(-0.0908, dtype=torch.float64) tensor(-6.0085, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5105, dtype=torch.float64) delta_t tensor(0.5579, dtype=torch.float64)
15 gae_duplicate tensor(0.3907, dtype=torch.float64) tensor(-9.6114, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2695, dtype=torch.float64) delta_t tensor(0.2461, dtype=torch.float64)
14 gae_duplicate tensor(0.0606, dtype=torch.float64) tensor(-5.7108, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5178, dtype=torch.float64) delta_t tensor(0.6005, dtype=torch.float64)
13 gae_duplicate tensor(0.5563, dtype=torch.float64) tensor(-9.1281, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2559, dtype=torch.float64) delta_t tensor(0.2567, dtype=torch.float64)
12 gae_duplicate tensor(0.0810, dtype=torch.float64) tensor(-5.3924, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5191, dtype=torch.float64) delta_t tensor(0.5236, dtype=torch.float64)
11 gae_duplicate tensor(0.4721, dtype=torch.float64) tensor(-10.5198, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2643, dtype=torch.float64) delta_t tensor(0.2291, dtype=torch.float64)
10 gae_duplicate tensor(-0.0035, dtype=torch.float64) tensor(-5.4431, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5128, dtype=torch.float64) delta_t tensor(0.4782, dtype=torch.float64)
9 gae_duplicate tensor(0.4324, dtype=torch.float64) tensor(-8.0226, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2102, dtype=torch.float64) delta_t tensor(0.1813, dtype=torch.float64)
8 gae_duplicate tensor(-0.0176, dtype=torch.float64) tensor(-4.4692, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4190, dtype=torch.float64) delta_t tensor(0.4055, dtype=torch.float64)
7 gae_duplicate tensor(0.0369, dtype=torch.float64) tensor(-8.1940, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0963, dtype=torch.float64) delta_t tensor(0.0884, dtype=torch.float64)
6 gae_duplicate tensor(-0.2801, dtype=torch.float64) tensor(-2.5332, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4803, dtype=torch.float64) delta_t tensor(-1.3454, dtype=torch.float64)
5 gae_duplicate tensor(-2.1022, dtype=torch.float64) tensor(25.7007, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0487, dtype=torch.float64) delta_t tensor(-1.9737, dtype=torch.float64)
4 gae_duplicate tensor(-6.2622, dtype=torch.float64) tensor(39.9557, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1785, dtype=torch.float64) delta_t tensor(0.2080, dtype=torch.float64)
3 gae_duplicate tensor(-0.6717, dtype=torch.float64) tensor(-0.4968, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2718, dtype=torch.float64) delta_t tensor(-0.3957, dtype=torch.float64)
2 gae_duplicate tensor(-0.6104, dtype=torch.float64) tensor(7.0695, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1433.4144287109375
value loss:134.17181396484375
entropies:322.2709655761719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.121521711349487 seconds
19 rew tensor(0.5256, dtype=torch.float64) delta_t tensor(0.4956, dtype=torch.float64)
19 gae_duplicate tensor(0.3139, dtype=torch.float64) tensor(-9.4196, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4482, dtype=torch.float64) delta_t tensor(0.3866, dtype=torch.float64)
18 gae_duplicate tensor(0.3135, dtype=torch.float64) tensor(-7.1241, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4900, dtype=torch.float64) delta_t tensor(0.5350, dtype=torch.float64)
17 gae_duplicate tensor(0.2781, dtype=torch.float64) tensor(-12.5651, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3866, dtype=torch.float64) delta_t tensor(0.4373, dtype=torch.float64)
16 gae_duplicate tensor(0.3174, dtype=torch.float64) tensor(-8.7539, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4768, dtype=torch.float64) delta_t tensor(0.5216, dtype=torch.float64)
15 gae_duplicate tensor(0.2862, dtype=torch.float64) tensor(-8.3718, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3116, dtype=torch.float64) delta_t tensor(0.3764, dtype=torch.float64)
14 gae_duplicate tensor(0.1561, dtype=torch.float64) tensor(-6.7814, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4970, dtype=torch.float64) delta_t tensor(0.5650, dtype=torch.float64)
13 gae_duplicate tensor(0.3955, dtype=torch.float64) tensor(-10.7488, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2930, dtype=torch.float64) delta_t tensor(0.2783, dtype=torch.float64)
12 gae_duplicate tensor(0.1193, dtype=torch.float64) tensor(-4.7985, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5104, dtype=torch.float64) delta_t tensor(0.5466, dtype=torch.float64)
11 gae_duplicate tensor(0.3851, dtype=torch.float64) tensor(-8.6578, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2719, dtype=torch.float64) delta_t tensor(0.2777, dtype=torch.float64)
10 gae_duplicate tensor(0.1041, dtype=torch.float64) tensor(-6.1181, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4351, dtype=torch.float64) delta_t tensor(0.4316, dtype=torch.float64)
9 gae_duplicate tensor(0.2242, dtype=torch.float64) tensor(-7.7616, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1325, dtype=torch.float64) delta_t tensor(0.1179, dtype=torch.float64)
8 gae_duplicate tensor(-0.0157, dtype=torch.float64) tensor(-2.5769, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5063, dtype=torch.float64) delta_t tensor(0.5512, dtype=torch.float64)
7 gae_duplicate tensor(0.5184, dtype=torch.float64) tensor(-10.7687, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0210, dtype=torch.float64) delta_t tensor(-0.0422, dtype=torch.float64)
6 gae_duplicate tensor(-0.3742, dtype=torch.float64) tensor(-0.5873, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7074, dtype=torch.float64) delta_t tensor(-1.5677, dtype=torch.float64)
5 gae_duplicate tensor(-2.7176, dtype=torch.float64) tensor(30.8158, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.2560, dtype=torch.float64) delta_t tensor(-3.1734, dtype=torch.float64)
4 gae_duplicate tensor(-5.2796, dtype=torch.float64) tensor(66.7781, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0533, dtype=torch.float64) delta_t tensor(-0.0576, dtype=torch.float64)
3 gae_duplicate tensor(-0.6652, dtype=torch.float64) tensor(8.0421, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2391, dtype=torch.float64) delta_t tensor(-0.3681, dtype=torch.float64)
2 gae_duplicate tensor(-0.5598, dtype=torch.float64) tensor(6.6588, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-478.81304931640625
value loss:179.49993896484375
entropies:321.0757751464844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3807.9648)
ToM Target loss= tensor(2575.5293)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.650670051574707 seconds
19 rew tensor(0.4896, dtype=torch.float64) delta_t tensor(0.4006, dtype=torch.float64)
19 gae_duplicate tensor(0.2456, dtype=torch.float64) tensor(-7.0715, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4512, dtype=torch.float64) delta_t tensor(0.3625, dtype=torch.float64)
18 gae_duplicate tensor(0.2619, dtype=torch.float64) tensor(-7.3220, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4828, dtype=torch.float64) delta_t tensor(0.3915, dtype=torch.float64)
17 gae_duplicate tensor(0.3424, dtype=torch.float64) tensor(-6.0719, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3302, dtype=torch.float64) delta_t tensor(0.4044, dtype=torch.float64)
16 gae_duplicate tensor(0.1154, dtype=torch.float64) tensor(-7.2623, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5025, dtype=torch.float64) delta_t tensor(0.6688, dtype=torch.float64)
15 gae_duplicate tensor(0.6776, dtype=torch.float64) tensor(-13.1658, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2287, dtype=torch.float64) delta_t tensor(0.2478, dtype=torch.float64)
14 gae_duplicate tensor(0.0741, dtype=torch.float64) tensor(-6.4456, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5442, dtype=torch.float64) delta_t tensor(0.5795, dtype=torch.float64)
13 gae_duplicate tensor(0.5324, dtype=torch.float64) tensor(-9.9142, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2436, dtype=torch.float64) delta_t tensor(0.2182, dtype=torch.float64)
12 gae_duplicate tensor(0.0656, dtype=torch.float64) tensor(-4.3935, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5446, dtype=torch.float64) delta_t tensor(0.5282, dtype=torch.float64)
11 gae_duplicate tensor(0.4869, dtype=torch.float64) tensor(-10.5241, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2442, dtype=torch.float64) delta_t tensor(0.2141, dtype=torch.float64)
10 gae_duplicate tensor(-0.0343, dtype=torch.float64) tensor(-4.9417, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5450, dtype=torch.float64) delta_t tensor(0.5130, dtype=torch.float64)
9 gae_duplicate tensor(0.4607, dtype=torch.float64) tensor(-10.4713, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2036, dtype=torch.float64) delta_t tensor(0.1727, dtype=torch.float64)
8 gae_duplicate tensor(-0.0039, dtype=torch.float64) tensor(-4.2173, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5041, dtype=torch.float64) delta_t tensor(0.5343, dtype=torch.float64)
7 gae_duplicate tensor(0.4823, dtype=torch.float64) tensor(-9.4470, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1630, dtype=torch.float64) delta_t tensor(0.0992, dtype=torch.float64)
6 gae_duplicate tensor(-0.1215, dtype=torch.float64) tensor(-2.3996, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4199, dtype=torch.float64) delta_t tensor(-1.2523, dtype=torch.float64)
5 gae_duplicate tensor(-1.9912, dtype=torch.float64) tensor(22.3203, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.3815, dtype=torch.float64) delta_t tensor(-5.3035, dtype=torch.float64)
4 gae_duplicate tensor(-7.2236, dtype=torch.float64) tensor(78.3924, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0759, dtype=torch.float64) delta_t tensor(-0.1469, dtype=torch.float64)
3 gae_duplicate tensor(-0.8355, dtype=torch.float64) tensor(13.2768, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1342, dtype=torch.float64) delta_t tensor(-0.2688, dtype=torch.float64)
2 gae_duplicate tensor(-0.4964, dtype=torch.float64) tensor(6.1555, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-976.9091796875
value loss:324.8491516113281
entropies:318.730224609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.103454828262329 seconds
19 rew tensor(0.5380, dtype=torch.float64) delta_t tensor(0.5104, dtype=torch.float64)
19 gae_duplicate tensor(0.3666, dtype=torch.float64) tensor(-8.6294, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4144, dtype=torch.float64) delta_t tensor(0.3701, dtype=torch.float64)
18 gae_duplicate tensor(0.2623, dtype=torch.float64) tensor(-6.7121, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5520, dtype=torch.float64) delta_t tensor(0.5159, dtype=torch.float64)
17 gae_duplicate tensor(0.4967, dtype=torch.float64) tensor(-10.9179, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2396, dtype=torch.float64) delta_t tensor(0.2023, dtype=torch.float64)
16 gae_duplicate tensor(-0.1116, dtype=torch.float64) tensor(-4.2677, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5191, dtype=torch.float64) delta_t tensor(0.5528, dtype=torch.float64)
15 gae_duplicate tensor(0.4625, dtype=torch.float64) tensor(-9.7063, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1384, dtype=torch.float64) delta_t tensor(0.1329, dtype=torch.float64)
14 gae_duplicate tensor(-0.1298, dtype=torch.float64) tensor(-2.7029, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5058, dtype=torch.float64) delta_t tensor(0.5587, dtype=torch.float64)
13 gae_duplicate tensor(0.3321, dtype=torch.float64) tensor(-11.7929, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0935, dtype=torch.float64) delta_t tensor(0.0970, dtype=torch.float64)
12 gae_duplicate tensor(-0.0542, dtype=torch.float64) tensor(-1.8192, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5320, dtype=torch.float64) delta_t tensor(0.5728, dtype=torch.float64)
11 gae_duplicate tensor(0.5027, dtype=torch.float64) tensor(-9.3913, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0742, dtype=torch.float64) delta_t tensor(0.0729, dtype=torch.float64)
10 gae_duplicate tensor(-0.0471, dtype=torch.float64) tensor(-2.0918, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5324, dtype=torch.float64) delta_t tensor(0.5328, dtype=torch.float64)
9 gae_duplicate tensor(0.4572, dtype=torch.float64) tensor(-12.1431, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0271, dtype=torch.float64) delta_t tensor(0.0127, dtype=torch.float64)
8 gae_duplicate tensor(-0.1451, dtype=torch.float64) tensor(-0.6912, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4910, dtype=torch.float64) delta_t tensor(0.5418, dtype=torch.float64)
7 gae_duplicate tensor(0.4428, dtype=torch.float64) tensor(-9.3479, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0410, dtype=torch.float64) delta_t tensor(-0.0750, dtype=torch.float64)
6 gae_duplicate tensor(-0.3997, dtype=torch.float64) tensor(8.8435e-05, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5621, dtype=torch.float64) delta_t tensor(-0.4235, dtype=torch.float64)
5 gae_duplicate tensor(-1.3081, dtype=torch.float64) tensor(6.9913, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0079, dtype=torch.float64) delta_t tensor(-1.9240, dtype=torch.float64)
4 gae_duplicate tensor(-4.1255, dtype=torch.float64) tensor(23.8889, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1310, dtype=torch.float64) delta_t tensor(-0.1631, dtype=torch.float64)
3 gae_duplicate tensor(-0.7314, dtype=torch.float64) tensor(5.9902, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2194, dtype=torch.float64) delta_t tensor(-0.3413, dtype=torch.float64)
2 gae_duplicate tensor(-0.6374, dtype=torch.float64) tensor(5.4607, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2499.98486328125
value loss:88.90389251708984
entropies:317.2983093261719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.005819797515869 seconds
19 rew tensor(0.5330, dtype=torch.float64) delta_t tensor(0.4944, dtype=torch.float64)
19 gae_duplicate tensor(0.3558, dtype=torch.float64) tensor(-10.0624, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3646, dtype=torch.float64) delta_t tensor(0.2836, dtype=torch.float64)
18 gae_duplicate tensor(0.2794, dtype=torch.float64) tensor(-4.1126, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5467, dtype=torch.float64) delta_t tensor(0.4908, dtype=torch.float64)
17 gae_duplicate tensor(0.4883, dtype=torch.float64) tensor(-9.4317, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3521, dtype=torch.float64) delta_t tensor(0.2593, dtype=torch.float64)
16 gae_duplicate tensor(0.2054, dtype=torch.float64) tensor(-5.6453, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4768, dtype=torch.float64) delta_t tensor(0.5509, dtype=torch.float64)
15 gae_duplicate tensor(0.3265, dtype=torch.float64) tensor(-10.3517, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2546, dtype=torch.float64) delta_t tensor(0.3089, dtype=torch.float64)
14 gae_duplicate tensor(0.2238, dtype=torch.float64) tensor(-7.7231, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5336, dtype=torch.float64) delta_t tensor(0.6620, dtype=torch.float64)
13 gae_duplicate tensor(0.6550, dtype=torch.float64) tensor(-13.8644, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2051, dtype=torch.float64) delta_t tensor(0.2077, dtype=torch.float64)
12 gae_duplicate tensor(0.1161, dtype=torch.float64) tensor(-5.6287, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5478, dtype=torch.float64) delta_t tensor(0.5631, dtype=torch.float64)
11 gae_duplicate tensor(0.5196, dtype=torch.float64) tensor(-9.3988, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2133, dtype=torch.float64) delta_t tensor(0.2112, dtype=torch.float64)
10 gae_duplicate tensor(0.0910, dtype=torch.float64) tensor(-3.8818, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5481, dtype=torch.float64) delta_t tensor(0.5328, dtype=torch.float64)
9 gae_duplicate tensor(0.4930, dtype=torch.float64) tensor(-9.9406, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1722, dtype=torch.float64) delta_t tensor(0.1521, dtype=torch.float64)
8 gae_duplicate tensor(0.0167, dtype=torch.float64) tensor(-3.0895, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5067, dtype=torch.float64) delta_t tensor(0.5537, dtype=torch.float64)
7 gae_duplicate tensor(0.5137, dtype=torch.float64) tensor(-10.2401, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1312, dtype=torch.float64) delta_t tensor(0.1011, dtype=torch.float64)
6 gae_duplicate tensor(-0.0269, dtype=torch.float64) tensor(-2.8191, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8826, dtype=torch.float64) delta_t tensor(-1.7164, dtype=torch.float64)
5 gae_duplicate tensor(-3.1667, dtype=torch.float64) tensor(29.3689, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7797, dtype=torch.float64) delta_t tensor(-1.6681, dtype=torch.float64)
4 gae_duplicate tensor(-3.6595, dtype=torch.float64) tensor(32.7625, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1929, dtype=torch.float64) delta_t tensor(-0.2488, dtype=torch.float64)
3 gae_duplicate tensor(-0.5458, dtype=torch.float64) tensor(7.4411, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2065, dtype=torch.float64) delta_t tensor(-0.3227, dtype=torch.float64)
2 gae_duplicate tensor(-0.4806, dtype=torch.float64) tensor(6.9948, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1514.130126953125
value loss:102.98129272460938
entropies:316.6149597167969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.693422079086304 seconds
19 rew tensor(0.4853, dtype=torch.float64) delta_t tensor(0.4536, dtype=torch.float64)
19 gae_duplicate tensor(0.2949, dtype=torch.float64) tensor(-9.0738, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5188, dtype=torch.float64) delta_t tensor(0.5396, dtype=torch.float64)
18 gae_duplicate tensor(0.3323, dtype=torch.float64) tensor(-11.7140, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4400, dtype=torch.float64) delta_t tensor(0.4290, dtype=torch.float64)
17 gae_duplicate tensor(0.1281, dtype=torch.float64) tensor(-6.8872, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4071, dtype=torch.float64) delta_t tensor(0.4163, dtype=torch.float64)
16 gae_duplicate tensor(0.1426, dtype=torch.float64) tensor(-10.2450, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4667, dtype=torch.float64) delta_t tensor(0.5292, dtype=torch.float64)
15 gae_duplicate tensor(0.3379, dtype=torch.float64) tensor(-11.9112, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2932, dtype=torch.float64) delta_t tensor(0.2822, dtype=torch.float64)
14 gae_duplicate tensor(0.0885, dtype=torch.float64) tensor(-5.0207, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4432, dtype=torch.float64) delta_t tensor(0.4708, dtype=torch.float64)
13 gae_duplicate tensor(0.2514, dtype=torch.float64) tensor(-7.1327, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2284, dtype=torch.float64) delta_t tensor(-0.1684, dtype=torch.float64)
12 gae_duplicate tensor(-1.8811, dtype=torch.float64) tensor(0.4973, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5344, dtype=torch.float64) delta_t tensor(0.6049, dtype=torch.float64)
11 gae_duplicate tensor(0.4546, dtype=torch.float64) tensor(-11.4236, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0792, dtype=torch.float64) delta_t tensor(0.1085, dtype=torch.float64)
10 gae_duplicate tensor(0.0309, dtype=torch.float64) tensor(-3.3873, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5489, dtype=torch.float64) delta_t tensor(0.5705, dtype=torch.float64)
9 gae_duplicate tensor(0.4710, dtype=torch.float64) tensor(-10.0244, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0380, dtype=torch.float64) delta_t tensor(0.0422, dtype=torch.float64)
8 gae_duplicate tensor(-0.1116, dtype=torch.float64) tensor(-2.0947, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4561, dtype=torch.float64) delta_t tensor(0.5109, dtype=torch.float64)
7 gae_duplicate tensor(0.1187, dtype=torch.float64) tensor(-8.7203, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0544, dtype=torch.float64) delta_t tensor(-0.0773, dtype=torch.float64)
6 gae_duplicate tensor(-0.3377, dtype=torch.float64) tensor(0.3875, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4092, dtype=torch.float64) delta_t tensor(-1.2838, dtype=torch.float64)
5 gae_duplicate tensor(-1.3874, dtype=torch.float64) tensor(22.4715, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3617, dtype=torch.float64) delta_t tensor(-3.3022, dtype=torch.float64)
4 gae_duplicate tensor(-5.3078, dtype=torch.float64) tensor(64.5922, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0266, dtype=torch.float64) delta_t tensor(-0.0582, dtype=torch.float64)
3 gae_duplicate tensor(-0.8983, dtype=torch.float64) tensor(7.2190, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2129, dtype=torch.float64) delta_t tensor(-0.3349, dtype=torch.float64)
2 gae_duplicate tensor(-0.5818, dtype=torch.float64) tensor(6.0946, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-281.1548156738281
value loss:182.50355529785156
entropies:315.9208068847656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.092387914657593 seconds
19 rew tensor(0.5483, dtype=torch.float64) delta_t tensor(0.5415, dtype=torch.float64)
19 gae_duplicate tensor(0.4330, dtype=torch.float64) tensor(-9.3941, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3398, dtype=torch.float64) delta_t tensor(0.2899, dtype=torch.float64)
18 gae_duplicate tensor(0.1981, dtype=torch.float64) tensor(-5.3307, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5487, dtype=torch.float64) delta_t tensor(0.5204, dtype=torch.float64)
17 gae_duplicate tensor(0.4630, dtype=torch.float64) tensor(-7.8981, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3404, dtype=torch.float64) delta_t tensor(0.2580, dtype=torch.float64)
16 gae_duplicate tensor(0.2004, dtype=torch.float64) tensor(-5.7062, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4915, dtype=torch.float64) delta_t tensor(0.5214, dtype=torch.float64)
15 gae_duplicate tensor(0.3943, dtype=torch.float64) tensor(-9.9730, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2764, dtype=torch.float64) delta_t tensor(0.3056, dtype=torch.float64)
14 gae_duplicate tensor(0.2210, dtype=torch.float64) tensor(-5.7219, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5059, dtype=torch.float64) delta_t tensor(0.5616, dtype=torch.float64)
13 gae_duplicate tensor(0.3253, dtype=torch.float64) tensor(-11.8517, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0669, dtype=torch.float64) delta_t tensor(0.0679, dtype=torch.float64)
12 gae_duplicate tensor(-0.5166, dtype=torch.float64) tensor(-2.7865, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5352, dtype=torch.float64) delta_t tensor(0.5354, dtype=torch.float64)
11 gae_duplicate tensor(0.5294, dtype=torch.float64) tensor(-9.0633, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1946, dtype=torch.float64) delta_t tensor(0.1659, dtype=torch.float64)
10 gae_duplicate tensor(0.0165, dtype=torch.float64) tensor(-4.1215, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5499, dtype=torch.float64) delta_t tensor(0.4860, dtype=torch.float64)
9 gae_duplicate tensor(0.4708, dtype=torch.float64) tensor(-8.5100, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1532, dtype=torch.float64) delta_t tensor(0.1050, dtype=torch.float64)
8 gae_duplicate tensor(-0.0641, dtype=torch.float64) tensor(-2.4402, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5082, dtype=torch.float64) delta_t tensor(0.4970, dtype=torch.float64)
7 gae_duplicate tensor(0.4773, dtype=torch.float64) tensor(-8.8406, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1119, dtype=torch.float64) delta_t tensor(0.0788, dtype=torch.float64)
6 gae_duplicate tensor(-0.0842, dtype=torch.float64) tensor(-2.8601, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7614, dtype=torch.float64) delta_t tensor(-0.5915, dtype=torch.float64)
5 gae_duplicate tensor(-1.3591, dtype=torch.float64) tensor(13.4307, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0170, dtype=torch.float64) delta_t tensor(-0.9113, dtype=torch.float64)
4 gae_duplicate tensor(-4.8102, dtype=torch.float64) tensor(17.5020, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1361, dtype=torch.float64) delta_t tensor(0.1864, dtype=torch.float64)
3 gae_duplicate tensor(-0.6533, dtype=torch.float64) tensor(-1.2745, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3289, dtype=torch.float64) delta_t tensor(-0.4357, dtype=torch.float64)
2 gae_duplicate tensor(-0.6312, dtype=torch.float64) tensor(6.6675, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3056.190673828125
value loss:73.11671447753906
entropies:315.20428466796875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3745.3933)
ToM Target loss= tensor(2562.2385)
optimized based on ToM loss
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt