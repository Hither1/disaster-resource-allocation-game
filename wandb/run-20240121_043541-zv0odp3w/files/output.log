obs <crafter.objects.Shelter object at 0x16885beb0> [39  0 39  0 11  0]
obs <crafter.objects.Warehouse object at 0x16886af40> [39  0 37  0  9  0]
obs <crafter.objects.Station object at 0x16886a3d0> [ 9  0  9  0 12  0]
obs <crafter.objects.Shelter object at 0x16885beb0> [39  0 39  0 12  0]
obs <crafter.objects.Warehouse object at 0x16886af40> [38  0 42  0  9  0]
obs <crafter.objects.Station object at 0x16886a3d0> [9 0 9 0 9 0]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0020847320556640625 seconds
19 rew tensor(-0.1361, dtype=torch.float64) delta_t tensor(-0.1556, dtype=torch.float64)
19 gae_duplicate tensor(-0.5017, dtype=torch.float64) tensor(3.1477, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.1683, dtype=torch.float64) delta_t tensor(0.1027, dtype=torch.float64)
18 gae_duplicate tensor(-0.0669, dtype=torch.float64) tensor(-1.6868, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.1112, dtype=torch.float64) delta_t tensor(-0.1764, dtype=torch.float64)
17 gae_duplicate tensor(-0.5969, dtype=torch.float64) tensor(3.2865, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1044, dtype=torch.float64) delta_t tensor(0.1271, dtype=torch.float64)
16 gae_duplicate tensor(-0.1334, dtype=torch.float64) tensor(-2.2234, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1719, dtype=torch.float64) delta_t tensor(-0.1132, dtype=torch.float64)
15 gae_duplicate tensor(-0.6251, dtype=torch.float64) tensor(1.7704, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2364, dtype=torch.float64) delta_t tensor(0.2559, dtype=torch.float64)
14 gae_duplicate tensor(-0.1289, dtype=torch.float64) tensor(-4.9256, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1699, dtype=torch.float64) delta_t tensor(-0.1060, dtype=torch.float64)
13 gae_duplicate tensor(-0.5947, dtype=torch.float64) tensor(1.6910, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2442, dtype=torch.float64) delta_t tensor(0.2555, dtype=torch.float64)
12 gae_duplicate tensor(-0.0203, dtype=torch.float64) tensor(-4.8348, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1661, dtype=torch.float64) delta_t tensor(-0.1344, dtype=torch.float64)
11 gae_duplicate tensor(-0.5607, dtype=torch.float64) tensor(2.2283, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2311, dtype=torch.float64) delta_t tensor(0.2339, dtype=torch.float64)
10 gae_duplicate tensor(-0.1582, dtype=torch.float64) tensor(-4.5178, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1227, dtype=torch.float64) delta_t tensor(-0.1448, dtype=torch.float64)
9 gae_duplicate tensor(-0.6096, dtype=torch.float64) tensor(2.3177, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1990, dtype=torch.float64) delta_t tensor(0.1952, dtype=torch.float64)
8 gae_duplicate tensor(-0.2110, dtype=torch.float64) tensor(-3.6349, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1332, dtype=torch.float64) delta_t tensor(-0.1150, dtype=torch.float64)
7 gae_duplicate tensor(-0.6576, dtype=torch.float64) tensor(1.8111, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1560, dtype=torch.float64) delta_t tensor(0.1478, dtype=torch.float64)
6 gae_duplicate tensor(-0.3383, dtype=torch.float64) tensor(-2.7160, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8904, dtype=torch.float64) delta_t tensor(-0.7346, dtype=torch.float64)
5 gae_duplicate tensor(-1.5685, dtype=torch.float64) tensor(14.6806, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6338, dtype=torch.float64) delta_t tensor(-1.5359, dtype=torch.float64)
4 gae_duplicate tensor(-1.7597, dtype=torch.float64) tensor(31.9653, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7388, dtype=torch.float64) delta_t tensor(-0.7325, dtype=torch.float64)
3 gae_duplicate tensor(-1.6272, dtype=torch.float64) tensor(17.8290, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1925, dtype=torch.float64) delta_t tensor(-0.3021, dtype=torch.float64)
2 gae_duplicate tensor(-1.3073, dtype=torch.float64) tensor(7.5520, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3537.887451171875
value loss:57.74602508544922
entropies:355.2513732910156
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 4.988391876220703 seconds
19 rew tensor(0.0559, dtype=torch.float64) delta_t tensor(0.0684, dtype=torch.float64)
19 gae_duplicate tensor(-0.1045, dtype=torch.float64) tensor(-1.3278, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.0863, dtype=torch.float64) delta_t tensor(0.1052, dtype=torch.float64)
18 gae_duplicate tensor(-0.1779, dtype=torch.float64) tensor(-2.1210, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0317, dtype=torch.float64) delta_t tensor(-0.0330, dtype=torch.float64)
17 gae_duplicate tensor(-0.4067, dtype=torch.float64) tensor(0.3364, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2648, dtype=torch.float64) delta_t tensor(0.3456, dtype=torch.float64)
16 gae_duplicate tensor(0.1106, dtype=torch.float64) tensor(-6.8466, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1319, dtype=torch.float64) delta_t tensor(0.0550, dtype=torch.float64)
15 gae_duplicate tensor(-0.1585, dtype=torch.float64) tensor(-1.7067, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3706, dtype=torch.float64) delta_t tensor(0.4444, dtype=torch.float64)
14 gae_duplicate tensor(0.1056, dtype=torch.float64) tensor(-8.8330, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1036, dtype=torch.float64) delta_t tensor(0.0500, dtype=torch.float64)
13 gae_duplicate tensor(-0.2041, dtype=torch.float64) tensor(-1.8460, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3765, dtype=torch.float64) delta_t tensor(0.4370, dtype=torch.float64)
12 gae_duplicate tensor(0.1001, dtype=torch.float64) tensor(-8.7509, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0881, dtype=torch.float64) delta_t tensor(-0.0094, dtype=torch.float64)
11 gae_duplicate tensor(-0.2799, dtype=torch.float64) tensor(-0.6438, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3881, dtype=torch.float64) delta_t tensor(0.4529, dtype=torch.float64)
10 gae_duplicate tensor(0.1399, dtype=torch.float64) tensor(-9.0373, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6242, dtype=torch.float64) delta_t tensor(-0.5613, dtype=torch.float64)
9 gae_duplicate tensor(-3.3423, dtype=torch.float64) tensor(10.4905, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1440, dtype=torch.float64) delta_t tensor(-0.1094, dtype=torch.float64)
8 gae_duplicate tensor(-3.4933, dtype=torch.float64) tensor(3.5508, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0888, dtype=torch.float64) delta_t tensor(0.0217, dtype=torch.float64)
7 gae_duplicate tensor(-0.3539, dtype=torch.float64) tensor(-0.1916, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4883, dtype=torch.float64) delta_t tensor(0.4790, dtype=torch.float64)
6 gae_duplicate tensor(0.3706, dtype=torch.float64) tensor(-9.2990, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2625, dtype=torch.float64) delta_t tensor(-1.0628, dtype=torch.float64)
5 gae_duplicate tensor(-1.8814, dtype=torch.float64) tensor(19.9252, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2247, dtype=torch.float64) delta_t tensor(-2.0927, dtype=torch.float64)
4 gae_duplicate tensor(-4.3603, dtype=torch.float64) tensor(43.1457, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5729, dtype=torch.float64) delta_t tensor(0.6282, dtype=torch.float64)
3 gae_duplicate tensor(-0.0686, dtype=torch.float64) tensor(-8.0126, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.9412, dtype=torch.float64) delta_t tensor(0.8527, dtype=torch.float64)
2 gae_duplicate tensor(0.4962, dtype=torch.float64) tensor(-17.5491, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-165.3063201904297
value loss:140.9644775390625
entropies:355.6275329589844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.378870964050293 seconds
19 rew tensor(-0.0654, dtype=torch.float64) delta_t tensor(-0.0639, dtype=torch.float64)
19 gae_duplicate tensor(-0.3906, dtype=torch.float64) tensor(1.2819, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.1676, dtype=torch.float64) delta_t tensor(0.1314, dtype=torch.float64)
18 gae_duplicate tensor(0.0219, dtype=torch.float64) tensor(-2.3974, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.1519, dtype=torch.float64) delta_t tensor(-0.1139, dtype=torch.float64)
17 gae_duplicate tensor(-0.4027, dtype=torch.float64) tensor(2.0538, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2656, dtype=torch.float64) delta_t tensor(0.3115, dtype=torch.float64)
16 gae_duplicate tensor(0.1265, dtype=torch.float64) tensor(-5.9654, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1497, dtype=torch.float64) delta_t tensor(0.0044, dtype=torch.float64)
15 gae_duplicate tensor(-0.1690, dtype=torch.float64) tensor(-0.7696, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2736, dtype=torch.float64) delta_t tensor(0.4193, dtype=torch.float64)
14 gae_duplicate tensor(0.2614, dtype=torch.float64) tensor(-8.2934, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1477, dtype=torch.float64) delta_t tensor(0.0168, dtype=torch.float64)
13 gae_duplicate tensor(-0.1933, dtype=torch.float64) tensor(-1.1826, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2997, dtype=torch.float64) delta_t tensor(0.3486, dtype=torch.float64)
12 gae_duplicate tensor(0.1357, dtype=torch.float64) tensor(-6.9942, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1321, dtype=torch.float64) delta_t tensor(-0.0439, dtype=torch.float64)
11 gae_duplicate tensor(-0.3218, dtype=torch.float64) tensor(0.1213, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2974, dtype=torch.float64) delta_t tensor(0.3657, dtype=torch.float64)
10 gae_duplicate tensor(0.1188, dtype=torch.float64) tensor(-7.2933, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1126, dtype=torch.float64) delta_t tensor(-0.0365, dtype=torch.float64)
9 gae_duplicate tensor(-0.3363, dtype=torch.float64) tensor(0.0200, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2755, dtype=torch.float64) delta_t tensor(0.3473, dtype=torch.float64)
8 gae_duplicate tensor(0.0758, dtype=torch.float64) tensor(-6.7653, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1538, dtype=torch.float64) delta_t tensor(-0.0192, dtype=torch.float64)
7 gae_duplicate tensor(-0.3441, dtype=torch.float64) tensor(-0.2797, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2530, dtype=torch.float64) delta_t tensor(0.3118, dtype=torch.float64)
6 gae_duplicate tensor(0.0860, dtype=torch.float64) tensor(-6.3078, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2595, dtype=torch.float64) delta_t tensor(-0.9978, dtype=torch.float64)
5 gae_duplicate tensor(-1.9742, dtype=torch.float64) tensor(18.9413, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0745, dtype=torch.float64) delta_t tensor(-1.8383, dtype=torch.float64)
4 gae_duplicate tensor(-3.6033, dtype=torch.float64) tensor(38.7926, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4863, dtype=torch.float64) delta_t tensor(0.6064, dtype=torch.float64)
3 gae_duplicate tensor(0.0117, dtype=torch.float64) tensor(-8.1978, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8411, dtype=torch.float64) delta_t tensor(0.8115, dtype=torch.float64)
2 gae_duplicate tensor(0.5563, dtype=torch.float64) tensor(-16.4252, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:425.7554931640625
value loss:72.7649917602539
entropies:355.2886962890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.111985206604004 seconds
19 rew tensor(0.0080, dtype=torch.float64) delta_t tensor(0.0579, dtype=torch.float64)
19 gae_duplicate tensor(-0.0795, dtype=torch.float64) tensor(-1.0285, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.0369, dtype=torch.float64) delta_t tensor(0.1196, dtype=torch.float64)
18 gae_duplicate tensor(-0.3627, dtype=torch.float64) tensor(-2.3564, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0592, dtype=torch.float64) delta_t tensor(0.0070, dtype=torch.float64)
17 gae_duplicate tensor(-0.2554, dtype=torch.float64) tensor(-0.4003, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0954, dtype=torch.float64) delta_t tensor(0.1288, dtype=torch.float64)
16 gae_duplicate tensor(-0.3650, dtype=torch.float64) tensor(-2.4891, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0198, dtype=torch.float64) delta_t tensor(0.0822, dtype=torch.float64)
15 gae_duplicate tensor(-0.0595, dtype=torch.float64) tensor(-1.8287, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2035, dtype=torch.float64) delta_t tensor(0.2788, dtype=torch.float64)
14 gae_duplicate tensor(0.0216, dtype=torch.float64) tensor(-5.6986, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1166, dtype=torch.float64) delta_t tensor(0.0310, dtype=torch.float64)
13 gae_duplicate tensor(-0.1170, dtype=torch.float64) tensor(-1.1566, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3695, dtype=torch.float64) delta_t tensor(0.4788, dtype=torch.float64)
12 gae_duplicate tensor(0.1675, dtype=torch.float64) tensor(-9.5631, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1395, dtype=torch.float64) delta_t tensor(0.0493, dtype=torch.float64)
11 gae_duplicate tensor(-0.1090, dtype=torch.float64) tensor(-1.8089, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2221, dtype=torch.float64) delta_t tensor(0.3381, dtype=torch.float64)
10 gae_duplicate tensor(-0.5696, dtype=torch.float64) tensor(-6.6475, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3206, dtype=torch.float64) delta_t tensor(-0.1362, dtype=torch.float64)
9 gae_duplicate tensor(-0.9055, dtype=torch.float64) tensor(2.0388, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1861, dtype=torch.float64) delta_t tensor(0.3272, dtype=torch.float64)
8 gae_duplicate tensor(-0.7244, dtype=torch.float64) tensor(-6.4680, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3128, dtype=torch.float64) delta_t tensor(-0.1244, dtype=torch.float64)
7 gae_duplicate tensor(-0.9654, dtype=torch.float64) tensor(1.9996, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2833, dtype=torch.float64) delta_t tensor(0.4322, dtype=torch.float64)
6 gae_duplicate tensor(-0.1169, dtype=torch.float64) tensor(-8.4319, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3467, dtype=torch.float64) delta_t tensor(-1.0822, dtype=torch.float64)
5 gae_duplicate tensor(-1.9348, dtype=torch.float64) tensor(19.4238, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4387, dtype=torch.float64) delta_t tensor(-2.2226, dtype=torch.float64)
4 gae_duplicate tensor(-4.2852, dtype=torch.float64) tensor(46.2868, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5617, dtype=torch.float64) delta_t tensor(0.7051, dtype=torch.float64)
3 gae_duplicate tensor(0.0131, dtype=torch.float64) tensor(-9.6159, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.9116, dtype=torch.float64) delta_t tensor(0.9165, dtype=torch.float64)
2 gae_duplicate tensor(0.4524, dtype=torch.float64) tensor(-19.4775, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:294.23944091796875
value loss:113.78359985351562
entropies:354.60711669921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.213663101196289 seconds
19 rew tensor(-0.1059, dtype=torch.float64) delta_t tensor(-0.0684, dtype=torch.float64)
19 gae_duplicate tensor(-0.2083, dtype=torch.float64) tensor(1.2621, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.1154, dtype=torch.float64) delta_t tensor(0.1175, dtype=torch.float64)
18 gae_duplicate tensor(-0.0817, dtype=torch.float64) tensor(-2.2146, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.1282, dtype=torch.float64) delta_t tensor(-0.0286, dtype=torch.float64)
17 gae_duplicate tensor(-0.1921, dtype=torch.float64) tensor(0.4425, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1875, dtype=torch.float64) delta_t tensor(0.2823, dtype=torch.float64)
16 gae_duplicate tensor(0.0595, dtype=torch.float64) tensor(-5.5147, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1569, dtype=torch.float64) delta_t tensor(0.0191, dtype=torch.float64)
15 gae_duplicate tensor(-0.1417, dtype=torch.float64) tensor(-0.8856, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2530, dtype=torch.float64) delta_t tensor(0.4318, dtype=torch.float64)
14 gae_duplicate tensor(0.2663, dtype=torch.float64) tensor(-8.6406, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1717, dtype=torch.float64) delta_t tensor(0.0203, dtype=torch.float64)
13 gae_duplicate tensor(-0.1374, dtype=torch.float64) tensor(-1.2928, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2861, dtype=torch.float64) delta_t tensor(0.3855, dtype=torch.float64)
12 gae_duplicate tensor(0.2042, dtype=torch.float64) tensor(-8.0071, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1658, dtype=torch.float64) delta_t tensor(-0.0160, dtype=torch.float64)
11 gae_duplicate tensor(-0.1521, dtype=torch.float64) tensor(-0.4748, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2756, dtype=torch.float64) delta_t tensor(0.3909, dtype=torch.float64)
10 gae_duplicate tensor(0.1499, dtype=torch.float64) tensor(-7.8135, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1540, dtype=torch.float64) delta_t tensor(-0.0180, dtype=torch.float64)
9 gae_duplicate tensor(-0.1678, dtype=torch.float64) tensor(-0.3543, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2463, dtype=torch.float64) delta_t tensor(0.3844, dtype=torch.float64)
8 gae_duplicate tensor(0.1941, dtype=torch.float64) tensor(-7.6954, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1734, dtype=torch.float64) delta_t tensor(0.0202, dtype=torch.float64)
7 gae_duplicate tensor(-0.1827, dtype=torch.float64) tensor(-1.1498, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2175, dtype=torch.float64) delta_t tensor(0.3291, dtype=torch.float64)
6 gae_duplicate tensor(0.1630, dtype=torch.float64) tensor(-6.7340, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5207, dtype=torch.float64) delta_t tensor(-1.2014, dtype=torch.float64)
5 gae_duplicate tensor(-1.8654, dtype=torch.float64) tensor(22.2813, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2170, dtype=torch.float64) delta_t tensor(-0.9140, dtype=torch.float64)
4 gae_duplicate tensor(-3.7068, dtype=torch.float64) tensor(20.6870, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.6231, dtype=torch.float64) delta_t tensor(0.7753, dtype=torch.float64)
3 gae_duplicate tensor(0.2921, dtype=torch.float64) tensor(-13.3567, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.9264, dtype=torch.float64) delta_t tensor(0.9190, dtype=torch.float64)
2 gae_duplicate tensor(0.7788, dtype=torch.float64) tensor(-19.3297, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1998.9864501953125
value loss:64.97184753417969
entropies:354.4867248535156
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3957.0286)
ToM Target loss= tensor(2554.8806)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.132048845291138 seconds
19 rew tensor(-0.0239, dtype=torch.float64) delta_t tensor(0.0610, dtype=torch.float64)
19 gae_duplicate tensor(-0.0924, dtype=torch.float64) tensor(-1.2747, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.0777, dtype=torch.float64) delta_t tensor(0.1217, dtype=torch.float64)
18 gae_duplicate tensor(-0.0980, dtype=torch.float64) tensor(-2.3998, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0058, dtype=torch.float64) delta_t tensor(0.0525, dtype=torch.float64)
17 gae_duplicate tensor(-0.1698, dtype=torch.float64) tensor(-1.2228, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1473, dtype=torch.float64) delta_t tensor(0.2539, dtype=torch.float64)
16 gae_duplicate tensor(-0.0227, dtype=torch.float64) tensor(-5.0489, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1258, dtype=torch.float64) delta_t tensor(0.0247, dtype=torch.float64)
15 gae_duplicate tensor(-0.2162, dtype=torch.float64) tensor(-0.9368, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2791, dtype=torch.float64) delta_t tensor(0.4052, dtype=torch.float64)
14 gae_duplicate tensor(0.0535, dtype=torch.float64) tensor(-7.9511, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1371, dtype=torch.float64) delta_t tensor(0.0768, dtype=torch.float64)
13 gae_duplicate tensor(-0.0333, dtype=torch.float64) tensor(-2.2901, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3303, dtype=torch.float64) delta_t tensor(0.4830, dtype=torch.float64)
12 gae_duplicate tensor(0.3967, dtype=torch.float64) tensor(-9.5355, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1598, dtype=torch.float64) delta_t tensor(0.0390, dtype=torch.float64)
11 gae_duplicate tensor(-0.0293, dtype=torch.float64) tensor(-1.7321, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3662, dtype=torch.float64) delta_t tensor(0.5029, dtype=torch.float64)
10 gae_duplicate tensor(0.3561, dtype=torch.float64) tensor(-10.1910, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0825, dtype=torch.float64) delta_t tensor(0.0960, dtype=torch.float64)
9 gae_duplicate tensor(-0.0733, dtype=torch.float64) tensor(-2.8289, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3948, dtype=torch.float64) delta_t tensor(0.5560, dtype=torch.float64)
8 gae_duplicate tensor(0.3470, dtype=torch.float64) tensor(-11.3187, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1814, dtype=torch.float64) delta_t tensor(0.0445, dtype=torch.float64)
7 gae_duplicate tensor(-0.0694, dtype=torch.float64) tensor(-1.9215, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4225, dtype=torch.float64) delta_t tensor(0.5649, dtype=torch.float64)
6 gae_duplicate tensor(0.2917, dtype=torch.float64) tensor(-11.8645, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4859, dtype=torch.float64) delta_t tensor(-1.1511, dtype=torch.float64)
5 gae_duplicate tensor(-1.8243, dtype=torch.float64) tensor(21.1695, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7331, dtype=torch.float64) delta_t tensor(-2.4668, dtype=torch.float64)
4 gae_duplicate tensor(-5.6910, dtype=torch.float64) tensor(50.4469, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5714, dtype=torch.float64) delta_t tensor(0.7011, dtype=torch.float64)
3 gae_duplicate tensor(0.1237, dtype=torch.float64) tensor(-8.9449, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8704, dtype=torch.float64) delta_t tensor(0.9003, dtype=torch.float64)
2 gae_duplicate tensor(0.5586, dtype=torch.float64) tensor(-19.2689, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1368.4110107421875
value loss:129.68882751464844
entropies:354.5639953613281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.858772039413452 seconds
19 rew tensor(-0.1637, dtype=torch.float64) delta_t tensor(-0.0891, dtype=torch.float64)
19 gae_duplicate tensor(-0.1954, dtype=torch.float64) tensor(1.7102, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.1543, dtype=torch.float64) delta_t tensor(0.1533, dtype=torch.float64)
18 gae_duplicate tensor(0.0266, dtype=torch.float64) tensor(-2.8498, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.1306, dtype=torch.float64) delta_t tensor(-0.1331, dtype=torch.float64)
17 gae_duplicate tensor(-0.2919, dtype=torch.float64) tensor(2.3589, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1739, dtype=torch.float64) delta_t tensor(0.2807, dtype=torch.float64)
16 gae_duplicate tensor(0.0256, dtype=torch.float64) tensor(-5.1545, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1784, dtype=torch.float64) delta_t tensor(-0.0239, dtype=torch.float64)
15 gae_duplicate tensor(-0.3281, dtype=torch.float64) tensor(-0.0234, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2012, dtype=torch.float64) delta_t tensor(0.3725, dtype=torch.float64)
14 gae_duplicate tensor(0.1330, dtype=torch.float64) tensor(-7.4450, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1812, dtype=torch.float64) delta_t tensor(0.0498, dtype=torch.float64)
13 gae_duplicate tensor(-0.0885, dtype=torch.float64) tensor(-1.6858, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2074, dtype=torch.float64) delta_t tensor(0.3074, dtype=torch.float64)
12 gae_duplicate tensor(0.1672, dtype=torch.float64) tensor(-6.1710, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1585, dtype=torch.float64) delta_t tensor(0.0032, dtype=torch.float64)
11 gae_duplicate tensor(-0.1783, dtype=torch.float64) tensor(-0.6986, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2130, dtype=torch.float64) delta_t tensor(0.3378, dtype=torch.float64)
10 gae_duplicate tensor(0.2112, dtype=torch.float64) tensor(-6.6857, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1569, dtype=torch.float64) delta_t tensor(-0.0106, dtype=torch.float64)
9 gae_duplicate tensor(-0.1938, dtype=torch.float64) tensor(-0.5254, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1740, dtype=torch.float64) delta_t tensor(0.3270, dtype=torch.float64)
8 gae_duplicate tensor(0.1893, dtype=torch.float64) tensor(-6.4719, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1932, dtype=torch.float64) delta_t tensor(0.0053, dtype=torch.float64)
7 gae_duplicate tensor(-0.2010, dtype=torch.float64) tensor(-0.7015, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1351, dtype=torch.float64) delta_t tensor(0.2438, dtype=torch.float64)
6 gae_duplicate tensor(0.0520, dtype=torch.float64) tensor(-4.8330, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3700, dtype=torch.float64) delta_t tensor(-1.0277, dtype=torch.float64)
5 gae_duplicate tensor(-1.3660, dtype=torch.float64) tensor(19.8635, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1914, dtype=torch.float64) delta_t tensor(-1.8338, dtype=torch.float64)
4 gae_duplicate tensor(-4.2692, dtype=torch.float64) tensor(38.5591, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.7036, dtype=torch.float64) delta_t tensor(0.8463, dtype=torch.float64)
3 gae_duplicate tensor(0.2677, dtype=torch.float64) tensor(-13.3183, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.9389, dtype=torch.float64) delta_t tensor(0.9362, dtype=torch.float64)
2 gae_duplicate tensor(0.7088, dtype=torch.float64) tensor(-19.7905, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:652.7711791992188
value loss:98.35604858398438
entropies:354.8891906738281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.749901056289673 seconds
19 rew tensor(-0.0486, dtype=torch.float64) delta_t tensor(-0.0772, dtype=torch.float64)
19 gae_duplicate tensor(-0.2164, dtype=torch.float64) tensor(1.4354, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.0355, dtype=torch.float64) delta_t tensor(-0.0087, dtype=torch.float64)
18 gae_duplicate tensor(-0.3585, dtype=torch.float64) tensor(0.4213, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.0308, dtype=torch.float64) delta_t tensor(0.1339, dtype=torch.float64)
17 gae_duplicate tensor(-0.1129, dtype=torch.float64) tensor(-2.6560, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0679, dtype=torch.float64) delta_t tensor(0.1809, dtype=torch.float64)
16 gae_duplicate tensor(-0.3611, dtype=torch.float64) tensor(-3.7276, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0217, dtype=torch.float64) delta_t tensor(0.2036, dtype=torch.float64)
15 gae_duplicate tensor(0.0638, dtype=torch.float64) tensor(-4.4691, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1759, dtype=torch.float64) delta_t tensor(0.3725, dtype=torch.float64)
14 gae_duplicate tensor(0.2603, dtype=torch.float64) tensor(-7.7329, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0773, dtype=torch.float64) delta_t tensor(0.1159, dtype=torch.float64)
13 gae_duplicate tensor(-0.0506, dtype=torch.float64) tensor(-3.2073, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2676, dtype=torch.float64) delta_t tensor(0.3908, dtype=torch.float64)
12 gae_duplicate tensor(0.1942, dtype=torch.float64) tensor(-8.2048, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0670, dtype=torch.float64) delta_t tensor(0.1100, dtype=torch.float64)
11 gae_duplicate tensor(-0.0675, dtype=torch.float64) tensor(-2.8402, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2673, dtype=torch.float64) delta_t tensor(0.4177, dtype=torch.float64)
10 gae_duplicate tensor(0.1970, dtype=torch.float64) tensor(-8.5940, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0653, dtype=torch.float64) delta_t tensor(0.0926, dtype=torch.float64)
9 gae_duplicate tensor(-0.0654, dtype=torch.float64) tensor(-2.7381, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2770, dtype=torch.float64) delta_t tensor(0.4260, dtype=torch.float64)
8 gae_duplicate tensor(0.2995, dtype=torch.float64) tensor(-8.5844, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0592, dtype=torch.float64) delta_t tensor(0.1088, dtype=torch.float64)
7 gae_duplicate tensor(-0.0807, dtype=torch.float64) tensor(-3.0458, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3719, dtype=torch.float64) delta_t tensor(0.4316, dtype=torch.float64)
6 gae_duplicate tensor(0.1610, dtype=torch.float64) tensor(-8.6550, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7813, dtype=torch.float64) delta_t tensor(-1.4472, dtype=torch.float64)
5 gae_duplicate tensor(-1.8955, dtype=torch.float64) tensor(27.0696, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1803, dtype=torch.float64) delta_t tensor(-2.8667, dtype=torch.float64)
4 gae_duplicate tensor(-4.5914, dtype=torch.float64) tensor(58.5182, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.7725, dtype=torch.float64) delta_t tensor(0.8537, dtype=torch.float64)
3 gae_duplicate tensor(0.0692, dtype=torch.float64) tensor(-10.8108, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8337, dtype=torch.float64) delta_t tensor(0.8522, dtype=torch.float64)
2 gae_duplicate tensor(0.4972, dtype=torch.float64) tensor(-17.9045, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:213.384033203125
value loss:141.15684509277344
entropies:354.8757629394531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.54414701461792 seconds
19 rew tensor(-0.0737, dtype=torch.float64) delta_t tensor(-0.0061, dtype=torch.float64)
19 gae_duplicate tensor(-0.2338, dtype=torch.float64) tensor(0.1628, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.1787, dtype=torch.float64) delta_t tensor(0.2348, dtype=torch.float64)
18 gae_duplicate tensor(0.0735, dtype=torch.float64) tensor(-4.6388, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.1589, dtype=torch.float64) delta_t tensor(-0.1089, dtype=torch.float64)
17 gae_duplicate tensor(-0.3348, dtype=torch.float64) tensor(1.5740, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2531, dtype=torch.float64) delta_t tensor(0.2662, dtype=torch.float64)
16 gae_duplicate tensor(0.1385, dtype=torch.float64) tensor(-5.2284, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0928, dtype=torch.float64) delta_t tensor(0.0577, dtype=torch.float64)
15 gae_duplicate tensor(-0.2025, dtype=torch.float64) tensor(-1.5940, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3042, dtype=torch.float64) delta_t tensor(0.4140, dtype=torch.float64)
14 gae_duplicate tensor(0.0734, dtype=torch.float64) tensor(-8.4047, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1703, dtype=torch.float64) delta_t tensor(0.1031, dtype=torch.float64)
13 gae_duplicate tensor(-0.0020, dtype=torch.float64) tensor(-2.8258, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3712, dtype=torch.float64) delta_t tensor(0.4957, dtype=torch.float64)
12 gae_duplicate tensor(0.2556, dtype=torch.float64) tensor(-10.0107, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1490, dtype=torch.float64) delta_t tensor(0.0431, dtype=torch.float64)
11 gae_duplicate tensor(-0.0860, dtype=torch.float64) tensor(-1.8917, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3827, dtype=torch.float64) delta_t tensor(0.5074, dtype=torch.float64)
10 gae_duplicate tensor(0.2192, dtype=torch.float64) tensor(-9.9535, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1468, dtype=torch.float64) delta_t tensor(0.0299, dtype=torch.float64)
9 gae_duplicate tensor(-0.0979, dtype=torch.float64) tensor(-1.5840, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3443, dtype=torch.float64) delta_t tensor(0.4901, dtype=torch.float64)
8 gae_duplicate tensor(0.2139, dtype=torch.float64) tensor(-9.8594, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1324, dtype=torch.float64) delta_t tensor(0.0516, dtype=torch.float64)
7 gae_duplicate tensor(-0.0925, dtype=torch.float64) tensor(-1.9955, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3561, dtype=torch.float64) delta_t tensor(0.4554, dtype=torch.float64)
6 gae_duplicate tensor(0.1979, dtype=torch.float64) tensor(-9.2186, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7013, dtype=torch.float64) delta_t tensor(-1.3498, dtype=torch.float64)
5 gae_duplicate tensor(-1.8001, dtype=torch.float64) tensor(26.5262, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3475, dtype=torch.float64) delta_t tensor(-3.0202, dtype=torch.float64)
4 gae_duplicate tensor(-6.1411, dtype=torch.float64) tensor(63.9690, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.7058, dtype=torch.float64) delta_t tensor(0.8411, dtype=torch.float64)
3 gae_duplicate tensor(-0.1298, dtype=torch.float64) tensor(-10.6493, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.9041, dtype=torch.float64) delta_t tensor(0.9415, dtype=torch.float64)
2 gae_duplicate tensor(0.4867, dtype=torch.float64) tensor(-18.8099, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:143.47622680664062
value loss:159.6495819091797
entropies:355.0946044921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.172967910766602 seconds
19 rew tensor(-0.0655, dtype=torch.float64) delta_t tensor(-0.0628, dtype=torch.float64)
19 gae_duplicate tensor(-0.2926, dtype=torch.float64) tensor(1.2638, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.1037, dtype=torch.float64) delta_t tensor(0.1268, dtype=torch.float64)
18 gae_duplicate tensor(-0.1581, dtype=torch.float64) tensor(-2.3117, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0888, dtype=torch.float64) delta_t tensor(-0.0714, dtype=torch.float64)
17 gae_duplicate tensor(-0.2880, dtype=torch.float64) tensor(1.2181, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1794, dtype=torch.float64) delta_t tensor(0.2519, dtype=torch.float64)
16 gae_duplicate tensor(-0.2208, dtype=torch.float64) tensor(-4.7741, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0591, dtype=torch.float64) delta_t tensor(0.1036, dtype=torch.float64)
15 gae_duplicate tensor(-0.0641, dtype=torch.float64) tensor(-2.5926, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1909, dtype=torch.float64) delta_t tensor(0.3514, dtype=torch.float64)
14 gae_duplicate tensor(0.1396, dtype=torch.float64) tensor(-7.0464, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0463, dtype=torch.float64) delta_t tensor(0.1905, dtype=torch.float64)
13 gae_duplicate tensor(-0.0554, dtype=torch.float64) tensor(-4.3594, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2573, dtype=torch.float64) delta_t tensor(0.3875, dtype=torch.float64)
12 gae_duplicate tensor(0.1615, dtype=torch.float64) tensor(-8.1415, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0340, dtype=torch.float64) delta_t tensor(0.1547, dtype=torch.float64)
11 gae_duplicate tensor(-0.0568, dtype=torch.float64) tensor(-3.9124, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2619, dtype=torch.float64) delta_t tensor(0.4063, dtype=torch.float64)
10 gae_duplicate tensor(0.1444, dtype=torch.float64) tensor(-8.4652, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0023, dtype=torch.float64) delta_t tensor(0.1415, dtype=torch.float64)
9 gae_duplicate tensor(-0.0816, dtype=torch.float64) tensor(-3.5255, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2914, dtype=torch.float64) delta_t tensor(0.4392, dtype=torch.float64)
8 gae_duplicate tensor(0.2467, dtype=torch.float64) tensor(-8.7539, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0418, dtype=torch.float64) delta_t tensor(0.1218, dtype=torch.float64)
7 gae_duplicate tensor(-0.0727, dtype=torch.float64) tensor(-3.3839, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4177, dtype=torch.float64) delta_t tensor(0.4689, dtype=torch.float64)
6 gae_duplicate tensor(0.0879, dtype=torch.float64) tensor(-9.4916, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4181, dtype=torch.float64) delta_t tensor(-1.0184, dtype=torch.float64)
5 gae_duplicate tensor(-1.4656, dtype=torch.float64) tensor(18.6236, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.1193, dtype=torch.float64) delta_t tensor(-3.8639, dtype=torch.float64)
4 gae_duplicate tensor(-9.0731, dtype=torch.float64) tensor(80.7055, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.6220, dtype=torch.float64) delta_t tensor(0.7186, dtype=torch.float64)
3 gae_duplicate tensor(-0.4420, dtype=torch.float64) tensor(-6.2483, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.7694, dtype=torch.float64) delta_t tensor(0.7974, dtype=torch.float64)
2 gae_duplicate tensor(0.4610, dtype=torch.float64) tensor(-16.3322, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-769.3792724609375
value loss:245.0177001953125
entropies:355.07745361328125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3949.4204)
ToM Target loss= tensor(2569.6272)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.114967107772827 seconds
19 rew tensor(-0.0369, dtype=torch.float64) delta_t tensor(-0.0296, dtype=torch.float64)
19 gae_duplicate tensor(-0.1783, dtype=torch.float64) tensor(0.5836, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.1473, dtype=torch.float64) delta_t tensor(0.1095, dtype=torch.float64)
18 gae_duplicate tensor(-0.2193, dtype=torch.float64) tensor(-2.2218, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0187, dtype=torch.float64) delta_t tensor(-0.0615, dtype=torch.float64)
17 gae_duplicate tensor(-0.1592, dtype=torch.float64) tensor(0.9825, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2230, dtype=torch.float64) delta_t tensor(0.3099, dtype=torch.float64)
16 gae_duplicate tensor(0.0134, dtype=torch.float64) tensor(-5.9011, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1574, dtype=torch.float64) delta_t tensor(0.0752, dtype=torch.float64)
15 gae_duplicate tensor(-0.1563, dtype=torch.float64) tensor(-2.0309, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3148, dtype=torch.float64) delta_t tensor(0.4576, dtype=torch.float64)
14 gae_duplicate tensor(0.2223, dtype=torch.float64) tensor(-9.1046, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1368, dtype=torch.float64) delta_t tensor(0.1047, dtype=torch.float64)
13 gae_duplicate tensor(0.0984, dtype=torch.float64) tensor(-2.9770, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3234, dtype=torch.float64) delta_t tensor(0.4141, dtype=torch.float64)
12 gae_duplicate tensor(0.2203, dtype=torch.float64) tensor(-8.5084, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1305, dtype=torch.float64) delta_t tensor(0.0505, dtype=torch.float64)
11 gae_duplicate tensor(0.0632, dtype=torch.float64) tensor(-1.8739, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3305, dtype=torch.float64) delta_t tensor(0.4534, dtype=torch.float64)
10 gae_duplicate tensor(0.2842, dtype=torch.float64) tensor(-9.1181, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1289, dtype=torch.float64) delta_t tensor(0.0092, dtype=torch.float64)
9 gae_duplicate tensor(0.0261, dtype=torch.float64) tensor(-1.0862, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2939, dtype=torch.float64) delta_t tensor(0.4098, dtype=torch.float64)
8 gae_duplicate tensor(0.2367, dtype=torch.float64) tensor(-8.2076, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1636, dtype=torch.float64) delta_t tensor(0.0324, dtype=torch.float64)
7 gae_duplicate tensor(0.0201, dtype=torch.float64) tensor(-1.4934, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2572, dtype=torch.float64) delta_t tensor(0.3034, dtype=torch.float64)
6 gae_duplicate tensor(0.0961, dtype=torch.float64) tensor(-6.0824, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5055, dtype=torch.float64) delta_t tensor(-1.0997, dtype=torch.float64)
5 gae_duplicate tensor(-1.4586, dtype=torch.float64) tensor(20.9973, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7795, dtype=torch.float64) delta_t tensor(-2.3658, dtype=torch.float64)
4 gae_duplicate tensor(-5.2250, dtype=torch.float64) tensor(49.4314, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.7952, dtype=torch.float64) delta_t tensor(0.9406, dtype=torch.float64)
3 gae_duplicate tensor(0.2047, dtype=torch.float64) tensor(-13.6519, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8301, dtype=torch.float64) delta_t tensor(0.8034, dtype=torch.float64)
2 gae_duplicate tensor(0.6798, dtype=torch.float64) tensor(-17.3594, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:855.7343139648438
value loss:134.7826690673828
entropies:354.9841613769531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8334479331970215 seconds
19 rew tensor(-0.1465, dtype=torch.float64) delta_t tensor(-0.0300, dtype=torch.float64)
19 gae_duplicate tensor(-0.2024, dtype=torch.float64) tensor(0.6451, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2404, dtype=torch.float64) delta_t tensor(0.2479, dtype=torch.float64)
18 gae_duplicate tensor(0.0769, dtype=torch.float64) tensor(-4.8219, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.1455, dtype=torch.float64) delta_t tensor(-0.1559, dtype=torch.float64)
17 gae_duplicate tensor(-0.3013, dtype=torch.float64) tensor(2.6836, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2399, dtype=torch.float64) delta_t tensor(0.1504, dtype=torch.float64)
16 gae_duplicate tensor(0.0409, dtype=torch.float64) tensor(-2.7754, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1565, dtype=torch.float64) delta_t tensor(-0.0294, dtype=torch.float64)
15 gae_duplicate tensor(-0.3197, dtype=torch.float64) tensor(0.3042, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2208, dtype=torch.float64) delta_t tensor(0.2816, dtype=torch.float64)
14 gae_duplicate tensor(0.0366, dtype=torch.float64) tensor(-5.4752, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1642, dtype=torch.float64) delta_t tensor(0.0622, dtype=torch.float64)
13 gae_duplicate tensor(-0.0168, dtype=torch.float64) tensor(-1.7597, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2246, dtype=torch.float64) delta_t tensor(0.3469, dtype=torch.float64)
12 gae_duplicate tensor(0.2499, dtype=torch.float64) tensor(-7.0345, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1478, dtype=torch.float64) delta_t tensor(0.0306, dtype=torch.float64)
11 gae_duplicate tensor(-0.0880, dtype=torch.float64) tensor(-1.3618, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2378, dtype=torch.float64) delta_t tensor(0.3239, dtype=torch.float64)
10 gae_duplicate tensor(0.2153, dtype=torch.float64) tensor(-6.5537, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1418, dtype=torch.float64) delta_t tensor(-0.0194, dtype=torch.float64)
9 gae_duplicate tensor(-0.1586, dtype=torch.float64) tensor(-0.2954, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2002, dtype=torch.float64) delta_t tensor(0.3165, dtype=torch.float64)
8 gae_duplicate tensor(0.1892, dtype=torch.float64) tensor(-6.3370, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1779, dtype=torch.float64) delta_t tensor(-0.0096, dtype=torch.float64)
7 gae_duplicate tensor(-0.1645, dtype=torch.float64) tensor(-0.4667, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1626, dtype=torch.float64) delta_t tensor(0.2499, dtype=torch.float64)
6 gae_duplicate tensor(0.1474, dtype=torch.float64) tensor(-4.9548, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5736, dtype=torch.float64) delta_t tensor(-1.1246, dtype=torch.float64)
5 gae_duplicate tensor(-1.9534, dtype=torch.float64) tensor(21.7344, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8273, dtype=torch.float64) delta_t tensor(-0.4472, dtype=torch.float64)
4 gae_duplicate tensor(-3.1364, dtype=torch.float64) tensor(11.3798, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5996, dtype=torch.float64) delta_t tensor(0.7610, dtype=torch.float64)
3 gae_duplicate tensor(0.4712, dtype=torch.float64) tensor(-13.7197, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.9914, dtype=torch.float64) delta_t tensor(0.9632, dtype=torch.float64)
2 gae_duplicate tensor(0.8441, dtype=torch.float64) tensor(-20.1235, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2006.533203125
value loss:51.22124099731445
entropies:354.8307189941406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.295172214508057 seconds
19 rew tensor(-0.0536, dtype=torch.float64) delta_t tensor(-0.1322, dtype=torch.float64)
19 gae_duplicate tensor(-0.3025, dtype=torch.float64) tensor(2.6190, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.0266, dtype=torch.float64) delta_t tensor(-0.0713, dtype=torch.float64)
18 gae_duplicate tensor(-0.2977, dtype=torch.float64) tensor(1.7100, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.0254, dtype=torch.float64) delta_t tensor(-0.0924, dtype=torch.float64)
17 gae_duplicate tensor(-0.2852, dtype=torch.float64) tensor(2.0997, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1564, dtype=torch.float64) delta_t tensor(0.2606, dtype=torch.float64)
16 gae_duplicate tensor(-0.0414, dtype=torch.float64) tensor(-4.7852, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.2518, dtype=torch.float64) delta_t tensor(-0.0020, dtype=torch.float64)
15 gae_duplicate tensor(-0.3042, dtype=torch.float64) tensor(-0.5122, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3200, dtype=torch.float64) delta_t tensor(0.4217, dtype=torch.float64)
14 gae_duplicate tensor(0.0936, dtype=torch.float64) tensor(-8.2805, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1346, dtype=torch.float64) delta_t tensor(0.1006, dtype=torch.float64)
13 gae_duplicate tensor(0.0470, dtype=torch.float64) tensor(-2.8589, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3579, dtype=torch.float64) delta_t tensor(0.4559, dtype=torch.float64)
12 gae_duplicate tensor(0.3066, dtype=torch.float64) tensor(-9.3198, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1333, dtype=torch.float64) delta_t tensor(0.0481, dtype=torch.float64)
11 gae_duplicate tensor(0.0150, dtype=torch.float64) tensor(-1.8865, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3638, dtype=torch.float64) delta_t tensor(0.4586, dtype=torch.float64)
10 gae_duplicate tensor(0.3257, dtype=torch.float64) tensor(-9.4146, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0938, dtype=torch.float64) delta_t tensor(0.0321, dtype=torch.float64)
9 gae_duplicate tensor(-0.0432, dtype=torch.float64) tensor(-1.5381, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3587, dtype=torch.float64) delta_t tensor(0.4465, dtype=torch.float64)
8 gae_duplicate tensor(0.3826, dtype=torch.float64) tensor(-9.1769, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0337, dtype=torch.float64) delta_t tensor(0.1119, dtype=torch.float64)
7 gae_duplicate tensor(-0.0179, dtype=torch.float64) tensor(-2.9031, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4620, dtype=torch.float64) delta_t tensor(0.4933, dtype=torch.float64)
6 gae_duplicate tensor(0.2652, dtype=torch.float64) tensor(-9.7187, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6192, dtype=torch.float64) delta_t tensor(-1.2434, dtype=torch.float64)
5 gae_duplicate tensor(-1.8675, dtype=torch.float64) tensor(22.9719, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6926, dtype=torch.float64) delta_t tensor(-3.3515, dtype=torch.float64)
4 gae_duplicate tensor(-8.1388, dtype=torch.float64) tensor(69.2570, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.7065, dtype=torch.float64) delta_t tensor(0.8431, dtype=torch.float64)
3 gae_duplicate tensor(-0.3722, dtype=torch.float64) tensor(-9.9007, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8605, dtype=torch.float64) delta_t tensor(0.8261, dtype=torch.float64)
2 gae_duplicate tensor(0.4481, dtype=torch.float64) tensor(-17.3660, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-689.4949951171875
value loss:234.43447875976562
entropies:354.42169189453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.80241584777832 seconds
19 rew tensor(-0.0989, dtype=torch.float64) delta_t tensor(-0.1268, dtype=torch.float64)
19 gae_duplicate tensor(-0.2706, dtype=torch.float64) tensor(2.4557, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.1730, dtype=torch.float64) delta_t tensor(0.0726, dtype=torch.float64)
18 gae_duplicate tensor(-0.2626, dtype=torch.float64) tensor(-1.1115, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.1340, dtype=torch.float64) delta_t tensor(-0.0050, dtype=torch.float64)
17 gae_duplicate tensor(-0.2781, dtype=torch.float64) tensor(-0.0309, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2754, dtype=torch.float64) delta_t tensor(0.3060, dtype=torch.float64)
16 gae_duplicate tensor(0.0341, dtype=torch.float64) tensor(-5.9688, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1386, dtype=torch.float64) delta_t tensor(-0.0776, dtype=torch.float64)
15 gae_duplicate tensor(-0.2985, dtype=torch.float64) tensor(0.8335, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3051, dtype=torch.float64) delta_t tensor(0.3285, dtype=torch.float64)
14 gae_duplicate tensor(0.0344, dtype=torch.float64) tensor(-6.3085, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1564, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
13 gae_duplicate tensor(0.0630, dtype=torch.float64) tensor(-1.6298, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2975, dtype=torch.float64) delta_t tensor(0.3716, dtype=torch.float64)
12 gae_duplicate tensor(0.2844, dtype=torch.float64) tensor(-7.3796, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1366, dtype=torch.float64) delta_t tensor(0.0164, dtype=torch.float64)
11 gae_duplicate tensor(0.0033, dtype=torch.float64) tensor(-1.1064, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3100, dtype=torch.float64) delta_t tensor(0.3800, dtype=torch.float64)
10 gae_duplicate tensor(0.3084, dtype=torch.float64) tensor(-7.4831, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1354, dtype=torch.float64) delta_t tensor(-0.0288, dtype=torch.float64)
9 gae_duplicate tensor(-0.0493, dtype=torch.float64) tensor(-0.1966, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2732, dtype=torch.float64) delta_t tensor(0.3481, dtype=torch.float64)
8 gae_duplicate tensor(0.2797, dtype=torch.float64) tensor(-6.6878, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1708, dtype=torch.float64) delta_t tensor(-0.0107, dtype=torch.float64)
7 gae_duplicate tensor(-0.0311, dtype=torch.float64) tensor(-0.4597, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2364, dtype=torch.float64) delta_t tensor(0.2603, dtype=torch.float64)
6 gae_duplicate tensor(0.1205, dtype=torch.float64) tensor(-5.2328, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5408, dtype=torch.float64) delta_t tensor(-1.1142, dtype=torch.float64)
5 gae_duplicate tensor(-2.1239, dtype=torch.float64) tensor(21.6392, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1025, dtype=torch.float64) delta_t tensor(-1.6864, dtype=torch.float64)
4 gae_duplicate tensor(-5.0441, dtype=torch.float64) tensor(35.2298, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.6988, dtype=torch.float64) delta_t tensor(0.8397, dtype=torch.float64)
3 gae_duplicate tensor(0.3350, dtype=torch.float64) tensor(-13.2202, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8857, dtype=torch.float64) delta_t tensor(0.8479, dtype=torch.float64)
2 gae_duplicate tensor(0.7124, dtype=torch.float64) tensor(-17.7952, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:684.8505859375
value loss:87.14286041259766
entropies:354.0504150390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.866127014160156 seconds
19 rew tensor(-0.0207, dtype=torch.float64) delta_t tensor(-0.0491, dtype=torch.float64)
19 gae_duplicate tensor(-0.2025, dtype=torch.float64) tensor(1.0382, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.0793, dtype=torch.float64) delta_t tensor(0.0980, dtype=torch.float64)
18 gae_duplicate tensor(-0.3065, dtype=torch.float64) tensor(-1.9436, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0835, dtype=torch.float64) delta_t tensor(-0.1051, dtype=torch.float64)
17 gae_duplicate tensor(-0.3040, dtype=torch.float64) tensor(1.9093, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1780, dtype=torch.float64) delta_t tensor(0.1670, dtype=torch.float64)
16 gae_duplicate tensor(-0.2231, dtype=torch.float64) tensor(-3.1158, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1057, dtype=torch.float64) delta_t tensor(-0.0387, dtype=torch.float64)
15 gae_duplicate tensor(-0.3235, dtype=torch.float64) tensor(0.3725, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2492, dtype=torch.float64) delta_t tensor(0.2903, dtype=torch.float64)
14 gae_duplicate tensor(-0.0370, dtype=torch.float64) tensor(-5.6404, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1486, dtype=torch.float64) delta_t tensor(0.0597, dtype=torch.float64)
13 gae_duplicate tensor(0.0190, dtype=torch.float64) tensor(-1.7650, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2785, dtype=torch.float64) delta_t tensor(0.3688, dtype=torch.float64)
12 gae_duplicate tensor(0.2128, dtype=torch.float64) tensor(-7.4216, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1408, dtype=torch.float64) delta_t tensor(0.0021, dtype=torch.float64)
11 gae_duplicate tensor(-0.0420, dtype=torch.float64) tensor(-0.7445, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2905, dtype=torch.float64) delta_t tensor(0.3347, dtype=torch.float64)
10 gae_duplicate tensor(0.1759, dtype=torch.float64) tensor(-6.8076, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1173, dtype=torch.float64) delta_t tensor(-0.0469, dtype=torch.float64)
9 gae_duplicate tensor(-0.1116, dtype=torch.float64) tensor(0.2954, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2647, dtype=torch.float64) delta_t tensor(0.3089, dtype=torch.float64)
8 gae_duplicate tensor(0.1791, dtype=torch.float64) tensor(-5.8042, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1029, dtype=torch.float64) delta_t tensor(-0.0130, dtype=torch.float64)
7 gae_duplicate tensor(-0.1286, dtype=torch.float64) tensor(-0.4885, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3002, dtype=torch.float64) delta_t tensor(0.3034, dtype=torch.float64)
6 gae_duplicate tensor(0.1544, dtype=torch.float64) tensor(-5.7085, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1566, dtype=torch.float64) delta_t tensor(-0.7271, dtype=torch.float64)
5 gae_duplicate tensor(-1.1244, dtype=torch.float64) tensor(13.5686, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3359, dtype=torch.float64) delta_t tensor(-3.0207, dtype=torch.float64)
4 gae_duplicate tensor(-7.6053, dtype=torch.float64) tensor(59.4797, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5440, dtype=torch.float64) delta_t tensor(0.6895, dtype=torch.float64)
3 gae_duplicate tensor(-0.2195, dtype=torch.float64) tensor(-7.2222, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.9230, dtype=torch.float64) delta_t tensor(0.8772, dtype=torch.float64)
2 gae_duplicate tensor(0.5375, dtype=torch.float64) tensor(-17.4561, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-772.8809204101562
value loss:170.59957885742188
entropies:353.3921203613281
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3948.1797)
ToM Target loss= tensor(2596.8088)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.980691909790039 seconds
19 rew tensor(0.0065, dtype=torch.float64) delta_t tensor(0.0232, dtype=torch.float64)
19 gae_duplicate tensor(-0.2622, dtype=torch.float64) tensor(-0.5198, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(-0.0530, dtype=torch.float64) delta_t tensor(-0.0911, dtype=torch.float64)
18 gae_duplicate tensor(-0.3711, dtype=torch.float64) tensor(1.7450, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.0063, dtype=torch.float64) delta_t tensor(-0.0591, dtype=torch.float64)
17 gae_duplicate tensor(-0.3212, dtype=torch.float64) tensor(1.3503, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.0045, dtype=torch.float64) delta_t tensor(-0.0009, dtype=torch.float64)
16 gae_duplicate tensor(-0.2756, dtype=torch.float64) tensor(0.3592, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0067, dtype=torch.float64) delta_t tensor(-0.0699, dtype=torch.float64)
15 gae_duplicate tensor(-0.1901, dtype=torch.float64) tensor(1.4360, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1722, dtype=torch.float64) delta_t tensor(0.2830, dtype=torch.float64)
14 gae_duplicate tensor(-0.0266, dtype=torch.float64) tensor(-5.1505, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1553, dtype=torch.float64) delta_t tensor(0.0425, dtype=torch.float64)
13 gae_duplicate tensor(0.0245, dtype=torch.float64) tensor(-1.3355, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3614, dtype=torch.float64) delta_t tensor(0.4097, dtype=torch.float64)
12 gae_duplicate tensor(0.2871, dtype=torch.float64) tensor(-8.3661, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1359, dtype=torch.float64) delta_t tensor(-0.0022, dtype=torch.float64)
11 gae_duplicate tensor(-0.0625, dtype=torch.float64) tensor(-0.6814, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3664, dtype=torch.float64) delta_t tensor(0.4163, dtype=torch.float64)
10 gae_duplicate tensor(0.2514, dtype=torch.float64) tensor(-8.3098, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1347, dtype=torch.float64) delta_t tensor(-0.0485, dtype=torch.float64)
9 gae_duplicate tensor(-0.1353, dtype=torch.float64) tensor(0.1210, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3298, dtype=torch.float64) delta_t tensor(0.3622, dtype=torch.float64)
8 gae_duplicate tensor(0.2043, dtype=torch.float64) tensor(-7.0276, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1187, dtype=torch.float64) delta_t tensor(-0.0135, dtype=torch.float64)
7 gae_duplicate tensor(-0.1197, dtype=torch.float64) tensor(-0.4808, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3445, dtype=torch.float64) delta_t tensor(0.3200, dtype=torch.float64)
6 gae_duplicate tensor(0.2353, dtype=torch.float64) tensor(-6.7802, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5704, dtype=torch.float64) delta_t tensor(-1.1378, dtype=torch.float64)
5 gae_duplicate tensor(-2.0740, dtype=torch.float64) tensor(21.0704, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6097, dtype=torch.float64) delta_t tensor(-2.2319, dtype=torch.float64)
4 gae_duplicate tensor(-4.4503, dtype=torch.float64) tensor(45.3198, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.7292, dtype=torch.float64) delta_t tensor(0.8066, dtype=torch.float64)
3 gae_duplicate tensor(0.1160, dtype=torch.float64) tensor(-11.9142, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8219, dtype=torch.float64) delta_t tensor(0.7480, dtype=torch.float64)
2 gae_duplicate tensor(0.5720, dtype=torch.float64) tensor(-14.9474, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-413.24224853515625
value loss:113.92377471923828
entropies:352.8577880859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.182494878768921 seconds
19 rew tensor(-0.1331, dtype=torch.float64) delta_t tensor(-0.1421, dtype=torch.float64)
19 gae_duplicate tensor(-0.3747, dtype=torch.float64) tensor(2.6505, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.1063, dtype=torch.float64) delta_t tensor(0.0191, dtype=torch.float64)
18 gae_duplicate tensor(-0.2538, dtype=torch.float64) tensor(-0.1970, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.1141, dtype=torch.float64) delta_t tensor(-0.0989, dtype=torch.float64)
17 gae_duplicate tensor(-0.3207, dtype=torch.float64) tensor(2.1804, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1180, dtype=torch.float64) delta_t tensor(0.1888, dtype=torch.float64)
16 gae_duplicate tensor(-0.0692, dtype=torch.float64) tensor(-3.6864, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1209, dtype=torch.float64) delta_t tensor(0.0180, dtype=torch.float64)
15 gae_duplicate tensor(-0.3472, dtype=torch.float64) tensor(-0.5921, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1482, dtype=torch.float64) delta_t tensor(0.3774, dtype=torch.float64)
14 gae_duplicate tensor(0.2055, dtype=torch.float64) tensor(-8.1452, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1448, dtype=torch.float64) delta_t tensor(0.0766, dtype=torch.float64)
13 gae_duplicate tensor(-0.0172, dtype=torch.float64) tensor(-2.3763, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1772, dtype=torch.float64) delta_t tensor(0.2514, dtype=torch.float64)
12 gae_duplicate tensor(0.1242, dtype=torch.float64) tensor(-5.1656, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3706, dtype=torch.float64) delta_t tensor(-0.1830, dtype=torch.float64)
11 gae_duplicate tensor(-1.0705, dtype=torch.float64) tensor(2.7903, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3032, dtype=torch.float64) delta_t tensor(-0.2165, dtype=torch.float64)
10 gae_duplicate tensor(-2.6949, dtype=torch.float64) tensor(4.9583, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8439, dtype=torch.float64) delta_t tensor(-0.7018, dtype=torch.float64)
9 gae_duplicate tensor(-4.2039, dtype=torch.float64) tensor(13.1946, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1806, dtype=torch.float64) delta_t tensor(0.2926, dtype=torch.float64)
8 gae_duplicate tensor(0.1105, dtype=torch.float64) tensor(-4.3273, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0677, dtype=torch.float64) delta_t tensor(0.0791, dtype=torch.float64)
7 gae_duplicate tensor(-0.1552, dtype=torch.float64) tensor(-2.1514, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0914, dtype=torch.float64) delta_t tensor(0.1385, dtype=torch.float64)
6 gae_duplicate tensor(-0.0259, dtype=torch.float64) tensor(-2.8942, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7853, dtype=torch.float64) delta_t tensor(-0.3888, dtype=torch.float64)
5 gae_duplicate tensor(-1.5384, dtype=torch.float64) tensor(7.6017, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7677, dtype=torch.float64) delta_t tensor(-1.3498, dtype=torch.float64)
4 gae_duplicate tensor(-2.9918, dtype=torch.float64) tensor(26.4041, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.7319, dtype=torch.float64) delta_t tensor(0.7877, dtype=torch.float64)
3 gae_duplicate tensor(0.3602, dtype=torch.float64) tensor(-12.6748, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8710, dtype=torch.float64) delta_t tensor(0.7779, dtype=torch.float64)
2 gae_duplicate tensor(0.6543, dtype=torch.float64) tensor(-14.8963, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-239.52871704101562
value loss:91.90335083007812
entropies:352.48468017578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.256036281585693 seconds
19 rew tensor(-0.0627, dtype=torch.float64) delta_t tensor(-0.2027, dtype=torch.float64)
19 gae_duplicate tensor(-0.3799, dtype=torch.float64) tensor(3.7517, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.0956, dtype=torch.float64) delta_t tensor(0.0479, dtype=torch.float64)
18 gae_duplicate tensor(-0.2938, dtype=torch.float64) tensor(-0.5214, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0845, dtype=torch.float64) delta_t tensor(-0.1818, dtype=torch.float64)
17 gae_duplicate tensor(-0.3026, dtype=torch.float64) tensor(3.3609, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1719, dtype=torch.float64) delta_t tensor(0.2308, dtype=torch.float64)
16 gae_duplicate tensor(-0.0132, dtype=torch.float64) tensor(-3.8354, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1561, dtype=torch.float64) delta_t tensor(0.0097, dtype=torch.float64)
15 gae_duplicate tensor(-0.2409, dtype=torch.float64) tensor(-0.6776, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2135, dtype=torch.float64) delta_t tensor(0.2522, dtype=torch.float64)
14 gae_duplicate tensor(0.0596, dtype=torch.float64) tensor(-4.8579, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1196, dtype=torch.float64) delta_t tensor(0.0474, dtype=torch.float64)
13 gae_duplicate tensor(-0.0717, dtype=torch.float64) tensor(-1.3228, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2355, dtype=torch.float64) delta_t tensor(0.2384, dtype=torch.float64)
12 gae_duplicate tensor(0.0092, dtype=torch.float64) tensor(-4.5682, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1172, dtype=torch.float64) delta_t tensor(0.0216, dtype=torch.float64)
11 gae_duplicate tensor(-0.0789, dtype=torch.float64) tensor(-0.9297, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2701, dtype=torch.float64) delta_t tensor(0.3222, dtype=torch.float64)
10 gae_duplicate tensor(0.1018, dtype=torch.float64) tensor(-6.3207, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0793, dtype=torch.float64) delta_t tensor(0.0230, dtype=torch.float64)
9 gae_duplicate tensor(-0.1413, dtype=torch.float64) tensor(-0.9633, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2954, dtype=torch.float64) delta_t tensor(0.3409, dtype=torch.float64)
8 gae_duplicate tensor(0.1401, dtype=torch.float64) tensor(-6.6801, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1708, dtype=torch.float64) delta_t tensor(-0.0114, dtype=torch.float64)
7 gae_duplicate tensor(-0.1164, dtype=torch.float64) tensor(-0.3939, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3139, dtype=torch.float64) delta_t tensor(0.2547, dtype=torch.float64)
6 gae_duplicate tensor(-0.0046, dtype=torch.float64) tensor(-5.2613, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9159, dtype=torch.float64) delta_t tensor(-1.4825, dtype=torch.float64)
5 gae_duplicate tensor(-2.1296, dtype=torch.float64) tensor(30.6973, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8131, dtype=torch.float64) delta_t tensor(-2.2623, dtype=torch.float64)
4 gae_duplicate tensor(-3.8442, dtype=torch.float64) tensor(49.7358, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.8626, dtype=torch.float64) delta_t tensor(0.9232, dtype=torch.float64)
3 gae_duplicate tensor(0.3141, dtype=torch.float64) tensor(-12.6648, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8648, dtype=torch.float64) delta_t tensor(0.7995, dtype=torch.float64)
2 gae_duplicate tensor(0.7523, dtype=torch.float64) tensor(-18.1091, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1198.816162109375
value loss:106.16705322265625
entropies:352.1324157714844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.966156005859375 seconds
19 rew tensor(-0.0484, dtype=torch.float64) delta_t tensor(-0.0054, dtype=torch.float64)
19 gae_duplicate tensor(-0.2549, dtype=torch.float64) tensor(0.1285, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.1332, dtype=torch.float64) delta_t tensor(0.0957, dtype=torch.float64)
18 gae_duplicate tensor(-0.3609, dtype=torch.float64) tensor(-1.7906, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0098, dtype=torch.float64) delta_t tensor(-0.1404, dtype=torch.float64)
17 gae_duplicate tensor(-0.3431, dtype=torch.float64) tensor(2.4354, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1938, dtype=torch.float64) delta_t tensor(0.0851, dtype=torch.float64)
16 gae_duplicate tensor(-0.2431, dtype=torch.float64) tensor(-1.3345, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0790, dtype=torch.float64) delta_t tensor(-0.1884, dtype=torch.float64)
15 gae_duplicate tensor(-0.3628, dtype=torch.float64) tensor(3.6315, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3358, dtype=torch.float64) delta_t tensor(0.3079, dtype=torch.float64)
14 gae_duplicate tensor(0.0356, dtype=torch.float64) tensor(-6.0853, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1585, dtype=torch.float64) delta_t tensor(0.0524, dtype=torch.float64)
13 gae_duplicate tensor(-0.0344, dtype=torch.float64) tensor(-1.6037, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3792, dtype=torch.float64) delta_t tensor(0.4071, dtype=torch.float64)
12 gae_duplicate tensor(0.2443, dtype=torch.float64) tensor(-7.9538, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1455, dtype=torch.float64) delta_t tensor(-0.0199, dtype=torch.float64)
11 gae_duplicate tensor(-0.0750, dtype=torch.float64) tensor(-0.4732, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3981, dtype=torch.float64) delta_t tensor(0.3664, dtype=torch.float64)
10 gae_duplicate tensor(0.1922, dtype=torch.float64) tensor(-6.9860, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1199, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
9 gae_duplicate tensor(-0.1876, dtype=torch.float64) tensor(-0.2422, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3790, dtype=torch.float64) delta_t tensor(0.3969, dtype=torch.float64)
8 gae_duplicate tensor(0.1724, dtype=torch.float64) tensor(-7.6416, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1741, dtype=torch.float64) delta_t tensor(-0.0301, dtype=torch.float64)
7 gae_duplicate tensor(-0.1903, dtype=torch.float64) tensor(-0.1507, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3599, dtype=torch.float64) delta_t tensor(0.3834, dtype=torch.float64)
6 gae_duplicate tensor(0.2050, dtype=torch.float64) tensor(-7.3315, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4761, dtype=torch.float64) delta_t tensor(-1.0412, dtype=torch.float64)
5 gae_duplicate tensor(-1.2999, dtype=torch.float64) tensor(20.4653, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3083, dtype=torch.float64) delta_t tensor(-1.7823, dtype=torch.float64)
4 gae_duplicate tensor(-4.3843, dtype=torch.float64) tensor(39.3494, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.6990, dtype=torch.float64) delta_t tensor(0.8783, dtype=torch.float64)
3 gae_duplicate tensor(0.4886, dtype=torch.float64) tensor(-14.4373, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.0088, dtype=torch.float64) delta_t tensor(0.9281, dtype=torch.float64)
2 gae_duplicate tensor(0.8611, dtype=torch.float64) tensor(-18.1277, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:345.05377197265625
value loss:87.38758087158203
entropies:351.6231384277344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8437182903289795 seconds
19 rew tensor(-0.0177, dtype=torch.float64) delta_t tensor(-0.1287, dtype=torch.float64)
19 gae_duplicate tensor(-0.3940, dtype=torch.float64) tensor(2.1905, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.1364, dtype=torch.float64) delta_t tensor(0.0436, dtype=torch.float64)
18 gae_duplicate tensor(-0.4097, dtype=torch.float64) tensor(-0.3514, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0842, dtype=torch.float64) delta_t tensor(-0.1460, dtype=torch.float64)
17 gae_duplicate tensor(-0.3670, dtype=torch.float64) tensor(3.0113, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3742, dtype=torch.float64) delta_t tensor(0.4551, dtype=torch.float64)
16 gae_duplicate tensor(0.0890, dtype=torch.float64) tensor(-8.4651, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1703, dtype=torch.float64) delta_t tensor(0.0135, dtype=torch.float64)
15 gae_duplicate tensor(-0.0326, dtype=torch.float64) tensor(-1.1990, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4662, dtype=torch.float64) delta_t tensor(0.4710, dtype=torch.float64)
14 gae_duplicate tensor(0.0887, dtype=torch.float64) tensor(-8.9455, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1443, dtype=torch.float64) delta_t tensor(-0.0254, dtype=torch.float64)
13 gae_duplicate tensor(-0.1420, dtype=torch.float64) tensor(-0.5294, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3502, dtype=torch.float64) delta_t tensor(0.3505, dtype=torch.float64)
12 gae_duplicate tensor(-0.3203, dtype=torch.float64) tensor(-7.0878, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1559, dtype=torch.float64) delta_t tensor(0.0007, dtype=torch.float64)
11 gae_duplicate tensor(-0.0503, dtype=torch.float64) tensor(-0.7421, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4658, dtype=torch.float64) delta_t tensor(0.4705, dtype=torch.float64)
10 gae_duplicate tensor(0.1525, dtype=torch.float64) tensor(-8.8434, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1050, dtype=torch.float64) delta_t tensor(-0.0237, dtype=torch.float64)
9 gae_duplicate tensor(-0.1192, dtype=torch.float64) tensor(-0.5405, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4721, dtype=torch.float64) delta_t tensor(0.5076, dtype=torch.float64)
8 gae_duplicate tensor(0.2159, dtype=torch.float64) tensor(-10.7170, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1657, dtype=torch.float64) delta_t tensor(-0.0308, dtype=torch.float64)
7 gae_duplicate tensor(-0.0945, dtype=torch.float64) tensor(-0.3950, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4905, dtype=torch.float64) delta_t tensor(0.5037, dtype=torch.float64)
6 gae_duplicate tensor(0.2590, dtype=torch.float64) tensor(-9.4949, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5302, dtype=torch.float64) delta_t tensor(-1.0601, dtype=torch.float64)
5 gae_duplicate tensor(-2.0771, dtype=torch.float64) tensor(21.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3899, dtype=torch.float64) delta_t tensor(-1.9268, dtype=torch.float64)
4 gae_duplicate tensor(-4.5287, dtype=torch.float64) tensor(37.7513, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.6531, dtype=torch.float64) delta_t tensor(0.8053, dtype=torch.float64)
3 gae_duplicate tensor(0.1100, dtype=torch.float64) tensor(-11.5288, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.9849, dtype=torch.float64) delta_t tensor(0.8970, dtype=torch.float64)
2 gae_duplicate tensor(0.5886, dtype=torch.float64) tensor(-17.8820, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1088.0531005859375
value loss:106.75324249267578
entropies:350.99530029296875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3934.0999)
ToM Target loss= tensor(2611.2061)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.810530185699463 seconds
19 rew tensor(-0.0352, dtype=torch.float64) delta_t tensor(-0.0541, dtype=torch.float64)
19 gae_duplicate tensor(-0.3207, dtype=torch.float64) tensor(1.0217, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.1451, dtype=torch.float64) delta_t tensor(0.1796, dtype=torch.float64)
18 gae_duplicate tensor(-0.4019, dtype=torch.float64) tensor(-3.2750, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0473, dtype=torch.float64) delta_t tensor(-0.0600, dtype=torch.float64)
17 gae_duplicate tensor(-0.3394, dtype=torch.float64) tensor(1.0443, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2637, dtype=torch.float64) delta_t tensor(0.2284, dtype=torch.float64)
16 gae_duplicate tensor(0.0310, dtype=torch.float64) tensor(-4.4575, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0612, dtype=torch.float64) delta_t tensor(-0.0935, dtype=torch.float64)
15 gae_duplicate tensor(-0.3404, dtype=torch.float64) tensor(1.2690, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3374, dtype=torch.float64) delta_t tensor(0.3075, dtype=torch.float64)
14 gae_duplicate tensor(0.0174, dtype=torch.float64) tensor(-6.5159, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0318, dtype=torch.float64) delta_t tensor(0.0897, dtype=torch.float64)
13 gae_duplicate tensor(-0.1934, dtype=torch.float64) tensor(-2.4831, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1905, dtype=torch.float64) delta_t tensor(0.2331, dtype=torch.float64)
12 gae_duplicate tensor(-0.8449, dtype=torch.float64) tensor(-5.3610, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0757, dtype=torch.float64) delta_t tensor(0.0497, dtype=torch.float64)
11 gae_duplicate tensor(-0.0893, dtype=torch.float64) tensor(-1.4640, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4783, dtype=torch.float64) delta_t tensor(0.4787, dtype=torch.float64)
10 gae_duplicate tensor(0.0344, dtype=torch.float64) tensor(-8.8641, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0519, dtype=torch.float64) delta_t tensor(-0.0134, dtype=torch.float64)
9 gae_duplicate tensor(-0.1374, dtype=torch.float64) tensor(-0.6429, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5071, dtype=torch.float64) delta_t tensor(0.4749, dtype=torch.float64)
8 gae_duplicate tensor(0.0115, dtype=torch.float64) tensor(-8.9770, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0561, dtype=torch.float64) delta_t tensor(-0.0236, dtype=torch.float64)
7 gae_duplicate tensor(-0.1129, dtype=torch.float64) tensor(-0.5317, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5899, dtype=torch.float64) delta_t tensor(0.4543, dtype=torch.float64)
6 gae_duplicate tensor(0.2531, dtype=torch.float64) tensor(-8.8963, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0001, dtype=torch.float64) delta_t tensor(-1.6047, dtype=torch.float64)
5 gae_duplicate tensor(-2.9223, dtype=torch.float64) tensor(31.0729, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4514, dtype=torch.float64) delta_t tensor(-3.0288, dtype=torch.float64)
4 gae_duplicate tensor(-8.2153, dtype=torch.float64) tensor(61.3171, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.6148, dtype=torch.float64) delta_t tensor(0.6830, dtype=torch.float64)
3 gae_duplicate tensor(-0.4275, dtype=torch.float64) tensor(-7.6654, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.7447, dtype=torch.float64) delta_t tensor(0.6920, dtype=torch.float64)
2 gae_duplicate tensor(0.3266, dtype=torch.float64) tensor(-14.4487, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1290.1375732421875
value loss:265.0659484863281
entropies:349.8445739746094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.902400016784668 seconds
19 rew tensor(-0.0671, dtype=torch.float64) delta_t tensor(-0.2125, dtype=torch.float64)
19 gae_duplicate tensor(-0.3720, dtype=torch.float64) tensor(4.1448, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.1013, dtype=torch.float64) delta_t tensor(0.0429, dtype=torch.float64)
18 gae_duplicate tensor(-0.3832, dtype=torch.float64) tensor(-0.1298, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0300, dtype=torch.float64) delta_t tensor(-0.0890, dtype=torch.float64)
17 gae_duplicate tensor(-0.3045, dtype=torch.float64) tensor(1.7758, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1718, dtype=torch.float64) delta_t tensor(0.2322, dtype=torch.float64)
16 gae_duplicate tensor(-0.3062, dtype=torch.float64) tensor(-4.5418, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0314, dtype=torch.float64) delta_t tensor(0.0373, dtype=torch.float64)
15 gae_duplicate tensor(-0.1714, dtype=torch.float64) tensor(-1.0940, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2972, dtype=torch.float64) delta_t tensor(0.3039, dtype=torch.float64)
14 gae_duplicate tensor(0.0164, dtype=torch.float64) tensor(-5.9781, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1475, dtype=torch.float64) delta_t tensor(-0.0306, dtype=torch.float64)
13 gae_duplicate tensor(-0.0655, dtype=torch.float64) tensor(0.0239, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4199, dtype=torch.float64) delta_t tensor(0.3781, dtype=torch.float64)
12 gae_duplicate tensor(0.1767, dtype=torch.float64) tensor(-7.0674, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1464, dtype=torch.float64) delta_t tensor(-0.0310, dtype=torch.float64)
11 gae_duplicate tensor(-0.0729, dtype=torch.float64) tensor(-0.1144, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4256, dtype=torch.float64) delta_t tensor(0.3817, dtype=torch.float64)
10 gae_duplicate tensor(0.1367, dtype=torch.float64) tensor(-7.0998, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1396, dtype=torch.float64) delta_t tensor(-0.1048, dtype=torch.float64)
9 gae_duplicate tensor(-0.1397, dtype=torch.float64) tensor(1.2612, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3889, dtype=torch.float64) delta_t tensor(0.3518, dtype=torch.float64)
8 gae_duplicate tensor(0.1647, dtype=torch.float64) tensor(-6.7215, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1753, dtype=torch.float64) delta_t tensor(-0.0805, dtype=torch.float64)
7 gae_duplicate tensor(-0.1460, dtype=torch.float64) tensor(0.8477, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3521, dtype=torch.float64) delta_t tensor(0.2334, dtype=torch.float64)
6 gae_duplicate tensor(0.0712, dtype=torch.float64) tensor(-4.4813, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5393, dtype=torch.float64) delta_t tensor(-0.9939, dtype=torch.float64)
5 gae_duplicate tensor(-1.3028, dtype=torch.float64) tensor(18.1820, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0536, dtype=torch.float64) delta_t tensor(-2.5220, dtype=torch.float64)
4 gae_duplicate tensor(-5.3071, dtype=torch.float64) tensor(51.2548, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.6304, dtype=torch.float64) delta_t tensor(0.7686, dtype=torch.float64)
3 gae_duplicate tensor(0.0251, dtype=torch.float64) tensor(-9.8333, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8490, dtype=torch.float64) delta_t tensor(0.7729, dtype=torch.float64)
2 gae_duplicate tensor(0.5873, dtype=torch.float64) tensor(-14.2960, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-965.4454956054688
value loss:125.1114273071289
entropies:349.2041931152344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.072761058807373 seconds
19 rew tensor(-0.1101, dtype=torch.float64) delta_t tensor(-0.2282, dtype=torch.float64)
19 gae_duplicate tensor(-0.4225, dtype=torch.float64) tensor(4.7752, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.0346, dtype=torch.float64) delta_t tensor(-0.1519, dtype=torch.float64)
18 gae_duplicate tensor(-0.4383, dtype=torch.float64) tensor(3.4063, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0375, dtype=torch.float64) delta_t tensor(-0.2274, dtype=torch.float64)
17 gae_duplicate tensor(-0.3864, dtype=torch.float64) tensor(5.2663, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1596, dtype=torch.float64) delta_t tensor(0.1622, dtype=torch.float64)
16 gae_duplicate tensor(-0.1935, dtype=torch.float64) tensor(-2.6261, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1022, dtype=torch.float64) delta_t tensor(-0.0520, dtype=torch.float64)
15 gae_duplicate tensor(-0.3106, dtype=torch.float64) tensor(0.8931, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3829, dtype=torch.float64) delta_t tensor(0.4416, dtype=torch.float64)
14 gae_duplicate tensor(0.2291, dtype=torch.float64) tensor(-8.0045, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1609, dtype=torch.float64) delta_t tensor(0.0231, dtype=torch.float64)
13 gae_duplicate tensor(0.0029, dtype=torch.float64) tensor(-1.3632, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4439, dtype=torch.float64) delta_t tensor(0.4192, dtype=torch.float64)
12 gae_duplicate tensor(0.2002, dtype=torch.float64) tensor(-8.5200, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1423, dtype=torch.float64) delta_t tensor(0.0368, dtype=torch.float64)
11 gae_duplicate tensor(0.0100, dtype=torch.float64) tensor(-1.6647, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4494, dtype=torch.float64) delta_t tensor(0.4178, dtype=torch.float64)
10 gae_duplicate tensor(0.1955, dtype=torch.float64) tensor(-8.2138, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0931, dtype=torch.float64) delta_t tensor(0.0113, dtype=torch.float64)
9 gae_duplicate tensor(-0.0674, dtype=torch.float64) tensor(-1.0098, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4608, dtype=torch.float64) delta_t tensor(0.4858, dtype=torch.float64)
8 gae_duplicate tensor(0.2650, dtype=torch.float64) tensor(-9.6532, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1770, dtype=torch.float64) delta_t tensor(-0.0188, dtype=torch.float64)
7 gae_duplicate tensor(-0.0488, dtype=torch.float64) tensor(-0.5493, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4720, dtype=torch.float64) delta_t tensor(0.3995, dtype=torch.float64)
6 gae_duplicate tensor(0.0939, dtype=torch.float64) tensor(-7.7128, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7234, dtype=torch.float64) delta_t tensor(-1.1241, dtype=torch.float64)
5 gae_duplicate tensor(-2.0823, dtype=torch.float64) tensor(22.2594, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6972, dtype=torch.float64) delta_t tensor(-2.1720, dtype=torch.float64)
4 gae_duplicate tensor(-2.9826, dtype=torch.float64) tensor(44.8432, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.6973, dtype=torch.float64) delta_t tensor(0.8018, dtype=torch.float64)
3 gae_duplicate tensor(0.3167, dtype=torch.float64) tensor(-11.0386, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8366, dtype=torch.float64) delta_t tensor(0.7692, dtype=torch.float64)
2 gae_duplicate tensor(0.5966, dtype=torch.float64) tensor(-16.7714, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-327.03759765625
value loss:90.8050308227539
entropies:348.052490234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.830586910247803 seconds
19 rew tensor(-0.0911, dtype=torch.float64) delta_t tensor(-0.1872, dtype=torch.float64)
19 gae_duplicate tensor(-0.4205, dtype=torch.float64) tensor(3.2281, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2246, dtype=torch.float64) delta_t tensor(0.0602, dtype=torch.float64)
18 gae_duplicate tensor(-0.2020, dtype=torch.float64) tensor(-1.2355, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.1512, dtype=torch.float64) delta_t tensor(-0.1822, dtype=torch.float64)
17 gae_duplicate tensor(-0.4060, dtype=torch.float64) tensor(3.9466, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2600, dtype=torch.float64) delta_t tensor(0.2171, dtype=torch.float64)
16 gae_duplicate tensor(-0.1497, dtype=torch.float64) tensor(-3.9193, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1631, dtype=torch.float64) delta_t tensor(-0.0308, dtype=torch.float64)
15 gae_duplicate tensor(-0.3326, dtype=torch.float64) tensor(0.2819, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2610, dtype=torch.float64) delta_t tensor(0.2022, dtype=torch.float64)
14 gae_duplicate tensor(0.0146, dtype=torch.float64) tensor(-3.9736, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1501, dtype=torch.float64) delta_t tensor(-0.0138, dtype=torch.float64)
13 gae_duplicate tensor(-0.0690, dtype=torch.float64) tensor(-0.0891, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2663, dtype=torch.float64) delta_t tensor(0.2016, dtype=torch.float64)
12 gae_duplicate tensor(0.0064, dtype=torch.float64) tensor(-3.5996, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1503, dtype=torch.float64) delta_t tensor(-0.0134, dtype=torch.float64)
11 gae_duplicate tensor(-0.0549, dtype=torch.float64) tensor(-0.1555, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2653, dtype=torch.float64) delta_t tensor(0.2502, dtype=torch.float64)
10 gae_duplicate tensor(0.1087, dtype=torch.float64) tensor(-5.3574, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1431, dtype=torch.float64) delta_t tensor(-0.0764, dtype=torch.float64)
9 gae_duplicate tensor(-0.1436, dtype=torch.float64) tensor(0.9845, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2348, dtype=torch.float64) delta_t tensor(0.2124, dtype=torch.float64)
8 gae_duplicate tensor(0.0409, dtype=torch.float64) tensor(-4.0270, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1795, dtype=torch.float64) delta_t tensor(-0.0506, dtype=torch.float64)
7 gae_duplicate tensor(-0.1749, dtype=torch.float64) tensor(0.6927, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1975, dtype=torch.float64) delta_t tensor(0.1634, dtype=torch.float64)
6 gae_duplicate tensor(-0.1212, dtype=torch.float64) tensor(-3.4623, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4542, dtype=torch.float64) delta_t tensor(-0.6181, dtype=torch.float64)
5 gae_duplicate tensor(-0.9942, dtype=torch.float64) tensor(10.5646, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5046, dtype=torch.float64) delta_t tensor(-2.0195, dtype=torch.float64)
4 gae_duplicate tensor(-3.6015, dtype=torch.float64) tensor(39.3164, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5442, dtype=torch.float64) delta_t tensor(0.7116, dtype=torch.float64)
3 gae_duplicate tensor(0.3105, dtype=torch.float64) tensor(-9.9954, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.9271, dtype=torch.float64) delta_t tensor(0.8753, dtype=torch.float64)
2 gae_duplicate tensor(0.6884, dtype=torch.float64) tensor(-17.5980, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-396.1570739746094
value loss:79.0337905883789
entropies:346.8468017578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.707952976226807 seconds
19 rew tensor(-0.0197, dtype=torch.float64) delta_t tensor(-0.2348, dtype=torch.float64)
19 gae_duplicate tensor(-0.3469, dtype=torch.float64) tensor(4.6607, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.0901, dtype=torch.float64) delta_t tensor(-0.1399, dtype=torch.float64)
18 gae_duplicate tensor(-0.3566, dtype=torch.float64) tensor(3.1223, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0750, dtype=torch.float64) delta_t tensor(-0.2728, dtype=torch.float64)
17 gae_duplicate tensor(-0.4337, dtype=torch.float64) tensor(5.3278, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3518, dtype=torch.float64) delta_t tensor(0.2818, dtype=torch.float64)
16 gae_duplicate tensor(-0.0533, dtype=torch.float64) tensor(-4.7123, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1730, dtype=torch.float64) delta_t tensor(0.0219, dtype=torch.float64)
15 gae_duplicate tensor(-0.2718, dtype=torch.float64) tensor(-1.1134, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3989, dtype=torch.float64) delta_t tensor(0.4494, dtype=torch.float64)
14 gae_duplicate tensor(0.2801, dtype=torch.float64) tensor(-8.7777, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1527, dtype=torch.float64) delta_t tensor(-0.0292, dtype=torch.float64)
13 gae_duplicate tensor(-0.0486, dtype=torch.float64) tensor(-0.2421, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4241, dtype=torch.float64) delta_t tensor(0.3261, dtype=torch.float64)
12 gae_duplicate tensor(0.1593, dtype=torch.float64) tensor(-6.0478, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1459, dtype=torch.float64) delta_t tensor(-0.0314, dtype=torch.float64)
11 gae_duplicate tensor(-0.0605, dtype=torch.float64) tensor(0.0153, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4240, dtype=torch.float64) delta_t tensor(0.3863, dtype=torch.float64)
10 gae_duplicate tensor(0.1852, dtype=torch.float64) tensor(-7.5719, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1262, dtype=torch.float64) delta_t tensor(-0.1045, dtype=torch.float64)
9 gae_duplicate tensor(-0.1263, dtype=torch.float64) tensor(1.3480, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4056, dtype=torch.float64) delta_t tensor(0.3447, dtype=torch.float64)
8 gae_duplicate tensor(0.1354, dtype=torch.float64) tensor(-5.9272, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1814, dtype=torch.float64) delta_t tensor(-0.0904, dtype=torch.float64)
7 gae_duplicate tensor(-0.1169, dtype=torch.float64) tensor(1.1359, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3871, dtype=torch.float64) delta_t tensor(0.2711, dtype=torch.float64)
6 gae_duplicate tensor(0.0957, dtype=torch.float64) tensor(-4.9264, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6872, dtype=torch.float64) delta_t tensor(-1.1769, dtype=torch.float64)
5 gae_duplicate tensor(-1.3523, dtype=torch.float64) tensor(21.0560, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4464, dtype=torch.float64) delta_t tensor(-1.6395, dtype=torch.float64)
4 gae_duplicate tensor(-3.6626, dtype=torch.float64) tensor(33.7486, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.8619, dtype=torch.float64) delta_t tensor(1.0698, dtype=torch.float64)
3 gae_duplicate tensor(0.3174, dtype=torch.float64) tensor(-17.4274, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.9183, dtype=torch.float64) delta_t tensor(0.8373, dtype=torch.float64)
2 gae_duplicate tensor(0.7519, dtype=torch.float64) tensor(-18.1777, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:150.0953369140625
value loss:83.83756256103516
entropies:345.9430236816406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3915.9248)
ToM Target loss= tensor(2612.5647)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.817317247390747 seconds
19 rew tensor(-0.0315, dtype=torch.float64) delta_t tensor(-0.0462, dtype=torch.float64)
19 gae_duplicate tensor(-0.3078, dtype=torch.float64) tensor(0.8291, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2717, dtype=torch.float64) delta_t tensor(0.1726, dtype=torch.float64)
18 gae_duplicate tensor(-0.1641, dtype=torch.float64) tensor(-3.2860, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.1122, dtype=torch.float64) delta_t tensor(-0.2842, dtype=torch.float64)
17 gae_duplicate tensor(-0.3477, dtype=torch.float64) tensor(5.4810, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4247, dtype=torch.float64) delta_t tensor(0.1560, dtype=torch.float64)
16 gae_duplicate tensor(0.0206, dtype=torch.float64) tensor(-2.4665, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1538, dtype=torch.float64) delta_t tensor(-0.1714, dtype=torch.float64)
15 gae_duplicate tensor(-0.3910, dtype=torch.float64) tensor(3.4952, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4360, dtype=torch.float64) delta_t tensor(0.4292, dtype=torch.float64)
14 gae_duplicate tensor(0.0401, dtype=torch.float64) tensor(-7.9666, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1655, dtype=torch.float64) delta_t tensor(-0.0044, dtype=torch.float64)
13 gae_duplicate tensor(-0.0392, dtype=torch.float64) tensor(-0.7363, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4473, dtype=torch.float64) delta_t tensor(0.3871, dtype=torch.float64)
12 gae_duplicate tensor(0.2499, dtype=torch.float64) tensor(-7.9506, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1458, dtype=torch.float64) delta_t tensor(-0.0136, dtype=torch.float64)
11 gae_duplicate tensor(-0.0216, dtype=torch.float64) tensor(-0.4822, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4600, dtype=torch.float64) delta_t tensor(0.3954, dtype=torch.float64)
10 gae_duplicate tensor(0.1867, dtype=torch.float64) tensor(-7.7058, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1449, dtype=torch.float64) delta_t tensor(-0.0568, dtype=torch.float64)
9 gae_duplicate tensor(-0.1079, dtype=torch.float64) tensor(0.2914, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4227, dtype=torch.float64) delta_t tensor(0.3943, dtype=torch.float64)
8 gae_duplicate tensor(0.1866, dtype=torch.float64) tensor(-7.4462, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1812, dtype=torch.float64) delta_t tensor(-0.0344, dtype=torch.float64)
7 gae_duplicate tensor(-0.0927, dtype=torch.float64) tensor(-0.0197, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3854, dtype=torch.float64) delta_t tensor(0.2800, dtype=torch.float64)
6 gae_duplicate tensor(0.1716, dtype=torch.float64) tensor(-5.2631, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7398, dtype=torch.float64) delta_t tensor(-1.1823, dtype=torch.float64)
5 gae_duplicate tensor(-2.2499, dtype=torch.float64) tensor(20.7215, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9909, dtype=torch.float64) delta_t tensor(-2.1840, dtype=torch.float64)
4 gae_duplicate tensor(-7.3300, dtype=torch.float64) tensor(47.9862, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.7839, dtype=torch.float64) delta_t tensor(0.9891, dtype=torch.float64)
3 gae_duplicate tensor(-0.1241, dtype=torch.float64) tensor(-14.7874, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8763, dtype=torch.float64) delta_t tensor(0.8248, dtype=torch.float64)
2 gae_duplicate tensor(0.6178, dtype=torch.float64) tensor(-16.6075, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-313.8775634765625
value loss:134.1591033935547
entropies:345.18695068359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.617487907409668 seconds
19 rew tensor(-0.0735, dtype=torch.float64) delta_t tensor(-0.2156, dtype=torch.float64)
19 gae_duplicate tensor(-0.4019, dtype=torch.float64) tensor(3.7835, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2049, dtype=torch.float64) delta_t tensor(0.0162, dtype=torch.float64)
18 gae_duplicate tensor(-0.0934, dtype=torch.float64) tensor(-0.0129, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.1528, dtype=torch.float64) delta_t tensor(-0.1405, dtype=torch.float64)
17 gae_duplicate tensor(-0.3544, dtype=torch.float64) tensor(2.7616, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2654, dtype=torch.float64) delta_t tensor(0.1605, dtype=torch.float64)
16 gae_duplicate tensor(-0.0749, dtype=torch.float64) tensor(-3.2223, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1518, dtype=torch.float64) delta_t tensor(-0.0407, dtype=torch.float64)
15 gae_duplicate tensor(-0.3826, dtype=torch.float64) tensor(0.2441, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2658, dtype=torch.float64) delta_t tensor(0.1837, dtype=torch.float64)
14 gae_duplicate tensor(0.0877, dtype=torch.float64) tensor(-3.6902, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1585, dtype=torch.float64) delta_t tensor(0.0134, dtype=torch.float64)
13 gae_duplicate tensor(-0.0130, dtype=torch.float64) tensor(-0.6510, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2643, dtype=torch.float64) delta_t tensor(0.2193, dtype=torch.float64)
12 gae_duplicate tensor(0.0860, dtype=torch.float64) tensor(-3.9288, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1450, dtype=torch.float64) delta_t tensor(0.0650, dtype=torch.float64)
11 gae_duplicate tensor(0.0225, dtype=torch.float64) tensor(-1.5144, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2770, dtype=torch.float64) delta_t tensor(0.2749, dtype=torch.float64)
10 gae_duplicate tensor(0.1812, dtype=torch.float64) tensor(-5.3230, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1445, dtype=torch.float64) delta_t tensor(-0.0101, dtype=torch.float64)
9 gae_duplicate tensor(-0.1051, dtype=torch.float64) tensor(-0.5117, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2397, dtype=torch.float64) delta_t tensor(0.3100, dtype=torch.float64)
8 gae_duplicate tensor(0.1292, dtype=torch.float64) tensor(-6.3737, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1811, dtype=torch.float64) delta_t tensor(0.0219, dtype=torch.float64)
7 gae_duplicate tensor(-0.0719, dtype=torch.float64) tensor(-0.9735, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2024, dtype=torch.float64) delta_t tensor(0.1573, dtype=torch.float64)
6 gae_duplicate tensor(-0.0248, dtype=torch.float64) tensor(-2.7102, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5645, dtype=torch.float64) delta_t tensor(-0.9593, dtype=torch.float64)
5 gae_duplicate tensor(-1.3326, dtype=torch.float64) tensor(17.5029, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5444, dtype=torch.float64) delta_t tensor(-2.6529, dtype=torch.float64)
4 gae_duplicate tensor(-5.0180, dtype=torch.float64) tensor(52.0581, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.8297, dtype=torch.float64) delta_t tensor(0.9101, dtype=torch.float64)
3 gae_duplicate tensor(0.2009, dtype=torch.float64) tensor(-11.0976, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8311, dtype=torch.float64) delta_t tensor(0.8038, dtype=torch.float64)
2 gae_duplicate tensor(0.7398, dtype=torch.float64) tensor(-15.8398, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1200.06787109375
value loss:107.92428588867188
entropies:344.50262451171875
Policy training finished
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
training start after waiting for 5.575268030166626 seconds
19 rew tensor(-0.0775, dtype=torch.float64) delta_t tensor(-0.3108, dtype=torch.float64)
19 gae_duplicate tensor(-0.4150, dtype=torch.float64) tensor(6.2668, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.0852, dtype=torch.float64) delta_t tensor(-0.0680, dtype=torch.float64)
18 gae_duplicate tensor(-0.2477, dtype=torch.float64) tensor(1.7668, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(-0.0441, dtype=torch.float64) delta_t tensor(-0.1824, dtype=torch.float64)
17 gae_duplicate tensor(-0.3979, dtype=torch.float64) tensor(4.1023, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2751, dtype=torch.float64) delta_t tensor(0.4366, dtype=torch.float64)
16 gae_duplicate tensor(-0.0933, dtype=torch.float64) tensor(-8.1726, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.1425, dtype=torch.float64) delta_t tensor(0.0650, dtype=torch.float64)
15 gae_duplicate tensor(-0.0951, dtype=torch.float64) tensor(-2.2517, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4435, dtype=torch.float64) delta_t tensor(0.4527, dtype=torch.float64)
14 gae_duplicate tensor(0.2250, dtype=torch.float64) tensor(-8.7712, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1449, dtype=torch.float64) delta_t tensor(-0.0077, dtype=torch.float64)
13 gae_duplicate tensor(-0.0870, dtype=torch.float64) tensor(-0.7567, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4906, dtype=torch.float64) delta_t tensor(0.3940, dtype=torch.float64)
12 gae_duplicate tensor(0.0699, dtype=torch.float64) tensor(-7.4118, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1440, dtype=torch.float64) delta_t tensor(0.0435, dtype=torch.float64)
11 gae_duplicate tensor(-0.0044, dtype=torch.float64) tensor(-1.6036, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4905, dtype=torch.float64) delta_t tensor(0.4896, dtype=torch.float64)
10 gae_duplicate tensor(0.2325, dtype=torch.float64) tensor(-9.8340, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0938, dtype=torch.float64) delta_t tensor(-0.0235, dtype=torch.float64)
9 gae_duplicate tensor(-0.0683, dtype=torch.float64) tensor(-0.6401, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5028, dtype=torch.float64) delta_t tensor(0.5137, dtype=torch.float64)
8 gae_duplicate tensor(0.2142, dtype=torch.float64) tensor(-9.6762, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1849, dtype=torch.float64) delta_t tensor(0.0419, dtype=torch.float64)
7 gae_duplicate tensor(-0.0411, dtype=torch.float64) tensor(-1.9738, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5150, dtype=torch.float64) delta_t tensor(0.4268, dtype=torch.float64)
6 gae_duplicate tensor(0.0318, dtype=torch.float64) tensor(-8.6988, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1950, dtype=torch.float64) delta_t tensor(-0.7152, dtype=torch.float64)
5 gae_duplicate tensor(-1.2431, dtype=torch.float64) tensor(12.1363, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.7906, dtype=torch.float64) delta_t tensor(-2.8224, dtype=torch.float64)
4 gae_duplicate tensor(-5.3840, dtype=torch.float64) tensor(50.8321, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.8812, dtype=torch.float64) delta_t tensor(1.1045, dtype=torch.float64)
3 gae_duplicate tensor(0.3079, dtype=torch.float64) tensor(-14.8331, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8827, dtype=torch.float64) delta_t tensor(0.8417, dtype=torch.float64)
2 gae_duplicate tensor(0.6506, dtype=torch.float64) tensor(-17.8846, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:846.978271484375
value loss:156.56744384765625
entropies:343.8122863769531
Policy training finished
---------------------
gamma: 0.1