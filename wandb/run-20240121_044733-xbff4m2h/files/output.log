obs <crafter.objects.Shelter object at 0x13862ee50> [39.  0.  0.  0. 39.  0.  0.  0.  8.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x138616cd0> [40.  0.  0.  0. 41.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x138616a60> [ 9.  0.  0.  0.  9.  0.  0.  0. 13.  0.  0.  0.]
obs <crafter.objects.Shelter object at 0x13862ee50> [39.  0.  0.  0. 39.  0.  0.  0.  6.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x138616cd0> [37.  0.  0.  0. 37.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x138616a60> [ 9.  0.  0.  0.  9.  0.  0.  0. 10.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0029959678649902344 seconds
19 rew tensor(0.6448, dtype=torch.float64) delta_t tensor(0.6606, dtype=torch.float64)
19 gae_duplicate tensor(0.4193, dtype=torch.float64) tensor(-13.0295, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4064, dtype=torch.float64) delta_t tensor(0.4273, dtype=torch.float64)
18 gae_duplicate tensor(0.3894, dtype=torch.float64) tensor(-9.7302, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7314, dtype=torch.float64) delta_t tensor(0.7466, dtype=torch.float64)
17 gae_duplicate tensor(0.4027, dtype=torch.float64) tensor(-15.7149, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3595, dtype=torch.float64) delta_t tensor(0.3758, dtype=torch.float64)
16 gae_duplicate tensor(0.3376, dtype=torch.float64) tensor(-9.0147, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7602, dtype=torch.float64) delta_t tensor(0.7600, dtype=torch.float64)
15 gae_duplicate tensor(0.6477, dtype=torch.float64) tensor(-15.8894, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3516, dtype=torch.float64) delta_t tensor(0.3122, dtype=torch.float64)
14 gae_duplicate tensor(0.1045, dtype=torch.float64) tensor(-7.6688, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7877, dtype=torch.float64) delta_t tensor(0.7646, dtype=torch.float64)
13 gae_duplicate tensor(0.6581, dtype=torch.float64) tensor(-15.6217, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4315, dtype=torch.float64) delta_t tensor(0.3410, dtype=torch.float64)
12 gae_duplicate tensor(0.3136, dtype=torch.float64) tensor(-8.3426, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8641, dtype=torch.float64) delta_t tensor(0.8790, dtype=torch.float64)
11 gae_duplicate tensor(0.7170, dtype=torch.float64) tensor(-18.1952, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5328, dtype=torch.float64) delta_t tensor(0.4794, dtype=torch.float64)
10 gae_duplicate tensor(0.4252, dtype=torch.float64) tensor(-11.2222, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.9543, dtype=torch.float64) delta_t tensor(0.9418, dtype=torch.float64)
9 gae_duplicate tensor(0.7191, dtype=torch.float64) tensor(-19.8415, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6235, dtype=torch.float64) delta_t tensor(0.5488, dtype=torch.float64)
8 gae_duplicate tensor(0.4964, dtype=torch.float64) tensor(-12.7255, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(1.0739, dtype=torch.float64) delta_t tensor(1.0200, dtype=torch.float64)
7 gae_duplicate tensor(0.7376, dtype=torch.float64) tensor(-21.4074, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.8101, dtype=torch.float64) delta_t tensor(0.7975, dtype=torch.float64)
6 gae_duplicate tensor(0.4123, dtype=torch.float64) tensor(-17.8601, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9894, dtype=torch.float64) delta_t tensor(-1.1236, dtype=torch.float64)
5 gae_duplicate tensor(-2.0086, dtype=torch.float64) tensor(20.3335, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7129, dtype=torch.float64) delta_t tensor(-1.8496, dtype=torch.float64)
4 gae_duplicate tensor(-2.1733, dtype=torch.float64) tensor(38.5842, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.7500, dtype=torch.float64) delta_t tensor(0.5321, dtype=torch.float64)
3 gae_duplicate tensor(-0.4907, dtype=torch.float64) tensor(-6.7886, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0., dtype=torch.float64) delta_t tensor(-0.0364, dtype=torch.float64)
2 gae_duplicate tensor(-0.0614, dtype=torch.float64) tensor(0.0569, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:7684.11572265625
value loss:128.34617614746094
entropies:355.81048583984375
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 5.066462993621826 seconds
19 rew tensor(0.5932, dtype=torch.float64) delta_t tensor(0.5156, dtype=torch.float64)
19 gae_duplicate tensor(0.3564, dtype=torch.float64) tensor(-10.1554, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4338, dtype=torch.float64) delta_t tensor(0.2639, dtype=torch.float64)
18 gae_duplicate tensor(0.0562, dtype=torch.float64) tensor(-6.2617, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7084, dtype=torch.float64) delta_t tensor(0.6240, dtype=torch.float64)
17 gae_duplicate tensor(0.3978, dtype=torch.float64) tensor(-12.7196, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1756, dtype=torch.float64) delta_t tensor(0.1110, dtype=torch.float64)
16 gae_duplicate tensor(-0.0754, dtype=torch.float64) tensor(-3.5247, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7072, dtype=torch.float64) delta_t tensor(0.5968, dtype=torch.float64)
15 gae_duplicate tensor(0.4266, dtype=torch.float64) tensor(-12.0298, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1936, dtype=torch.float64) delta_t tensor(0.0572, dtype=torch.float64)
14 gae_duplicate tensor(-0.2461, dtype=torch.float64) tensor(-2.3822, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7276, dtype=torch.float64) delta_t tensor(0.6177, dtype=torch.float64)
13 gae_duplicate tensor(0.4566, dtype=torch.float64) tensor(-12.7297, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2032, dtype=torch.float64) delta_t tensor(-0.0190, dtype=torch.float64)
12 gae_duplicate tensor(-0.1561, dtype=torch.float64) tensor(-0.9195, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7258, dtype=torch.float64) delta_t tensor(0.6113, dtype=torch.float64)
11 gae_duplicate tensor(0.4122, dtype=torch.float64) tensor(-12.4777, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2360, dtype=torch.float64) delta_t tensor(0.0253, dtype=torch.float64)
10 gae_duplicate tensor(-0.3330, dtype=torch.float64) tensor(-1.7261, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.7311, dtype=torch.float64) delta_t tensor(0.6237, dtype=torch.float64)
9 gae_duplicate tensor(0.3094, dtype=torch.float64) tensor(-12.7209, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1635, dtype=torch.float64) delta_t tensor(-0.0927, dtype=torch.float64)
8 gae_duplicate tensor(-0.6467, dtype=torch.float64) tensor(0.5919, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7025, dtype=torch.float64) delta_t tensor(0.5076, dtype=torch.float64)
7 gae_duplicate tensor(0.2408, dtype=torch.float64) tensor(-9.8834, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0860, dtype=torch.float64) delta_t tensor(-0.0827, dtype=torch.float64)
6 gae_duplicate tensor(-0.8632, dtype=torch.float64) tensor(0.7170, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5920, dtype=torch.float64) delta_t tensor(-1.7962, dtype=torch.float64)
5 gae_duplicate tensor(-3.5214, dtype=torch.float64) tensor(35.8629, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8866, dtype=torch.float64) delta_t tensor(-2.0999, dtype=torch.float64)
4 gae_duplicate tensor(-4.5799, dtype=torch.float64) tensor(45.0235, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1788, dtype=torch.float64) delta_t tensor(-0.4874, dtype=torch.float64)
3 gae_duplicate tensor(-1.3534, dtype=torch.float64) tensor(14.4115, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4872, dtype=torch.float64) delta_t tensor(-0.4978, dtype=torch.float64)
2 gae_duplicate tensor(-0.9123, dtype=torch.float64) tensor(11.2726, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-654.7855224609375
value loss:146.694580078125
entropies:355.4134521484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.120282888412476 seconds
19 rew tensor(0.6537, dtype=torch.float64) delta_t tensor(0.5336, dtype=torch.float64)
19 gae_duplicate tensor(0.3489, dtype=torch.float64) tensor(-10.4450, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6045, dtype=torch.float64) delta_t tensor(0.4103, dtype=torch.float64)
18 gae_duplicate tensor(0.0738, dtype=torch.float64) tensor(-9.3045, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6812, dtype=torch.float64) delta_t tensor(0.5167, dtype=torch.float64)
17 gae_duplicate tensor(0.2466, dtype=torch.float64) tensor(-10.9402, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1624, dtype=torch.float64) delta_t tensor(-0.0331, dtype=torch.float64)
16 gae_duplicate tensor(-0.7814, dtype=torch.float64) tensor(-0.4047, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6691, dtype=torch.float64) delta_t tensor(0.4495, dtype=torch.float64)
15 gae_duplicate tensor(0.2774, dtype=torch.float64) tensor(-9.0507, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2982, dtype=torch.float64) delta_t tensor(0.0598, dtype=torch.float64)
14 gae_duplicate tensor(-0.2463, dtype=torch.float64) tensor(-2.1194, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7323, dtype=torch.float64) delta_t tensor(0.5513, dtype=torch.float64)
13 gae_duplicate tensor(0.2694, dtype=torch.float64) tensor(-10.8364, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2793, dtype=torch.float64) delta_t tensor(0.0008, dtype=torch.float64)
12 gae_duplicate tensor(-0.1706, dtype=torch.float64) tensor(-1.0374, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7400, dtype=torch.float64) delta_t tensor(0.5315, dtype=torch.float64)
11 gae_duplicate tensor(0.3434, dtype=torch.float64) tensor(-10.4941, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3050, dtype=torch.float64) delta_t tensor(0.0622, dtype=torch.float64)
10 gae_duplicate tensor(-0.1049, dtype=torch.float64) tensor(-2.2606, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.7341, dtype=torch.float64) delta_t tensor(0.5019, dtype=torch.float64)
9 gae_duplicate tensor(0.3097, dtype=torch.float64) tensor(-10.5725, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2397, dtype=torch.float64) delta_t tensor(-0.0297, dtype=torch.float64)
8 gae_duplicate tensor(-0.2423, dtype=torch.float64) tensor(-0.4028, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7136, dtype=torch.float64) delta_t tensor(0.4438, dtype=torch.float64)
7 gae_duplicate tensor(0.2623, dtype=torch.float64) tensor(-8.7020, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1753, dtype=torch.float64) delta_t tensor(-0.0146, dtype=torch.float64)
6 gae_duplicate tensor(-0.3989, dtype=torch.float64) tensor(-0.6128, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2587, dtype=torch.float64) delta_t tensor(-1.5452, dtype=torch.float64)
5 gae_duplicate tensor(-2.5672, dtype=torch.float64) tensor(30.7323, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9847, dtype=torch.float64) delta_t tensor(-2.3206, dtype=torch.float64)
4 gae_duplicate tensor(-4.3069, dtype=torch.float64) tensor(48.2208, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2444, dtype=torch.float64) delta_t tensor(-0.6047, dtype=torch.float64)
3 gae_duplicate tensor(-1.1309, dtype=torch.float64) tensor(16.9206, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3180, dtype=torch.float64) delta_t tensor(-0.4296, dtype=torch.float64)
2 gae_duplicate tensor(-0.8300, dtype=torch.float64) tensor(10.1212, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1111.713134765625
value loss:141.49290466308594
entropies:355.09625244140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.188356161117554 seconds
19 rew tensor(0.6081, dtype=torch.float64) delta_t tensor(0.3810, dtype=torch.float64)
19 gae_duplicate tensor(0.1545, dtype=torch.float64) tensor(-7.5611, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5094, dtype=torch.float64) delta_t tensor(0.2823, dtype=torch.float64)
18 gae_duplicate tensor(0.1757, dtype=torch.float64) tensor(-6.4150, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5926, dtype=torch.float64) delta_t tensor(0.4042, dtype=torch.float64)
17 gae_duplicate tensor(0.2329, dtype=torch.float64) tensor(-8.7766, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4190, dtype=torch.float64) delta_t tensor(0.1845, dtype=torch.float64)
16 gae_duplicate tensor(-0.1484, dtype=torch.float64) tensor(-4.6065, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5629, dtype=torch.float64) delta_t tensor(0.3559, dtype=torch.float64)
15 gae_duplicate tensor(0.1136, dtype=torch.float64) tensor(-7.5441, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3575, dtype=torch.float64) delta_t tensor(0.0825, dtype=torch.float64)
14 gae_duplicate tensor(-0.2084, dtype=torch.float64) tensor(-2.3699, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6394, dtype=torch.float64) delta_t tensor(0.3815, dtype=torch.float64)
13 gae_duplicate tensor(0.2304, dtype=torch.float64) tensor(-7.7501, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2342, dtype=torch.float64) delta_t tensor(-0.0749, dtype=torch.float64)
12 gae_duplicate tensor(-0.2622, dtype=torch.float64) tensor(0.6295, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6669, dtype=torch.float64) delta_t tensor(0.4229, dtype=torch.float64)
11 gae_duplicate tensor(0.2499, dtype=torch.float64) tensor(-8.4738, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2631, dtype=torch.float64) delta_t tensor(-0.0324, dtype=torch.float64)
10 gae_duplicate tensor(-0.3268, dtype=torch.float64) tensor(-0.1877, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6476, dtype=torch.float64) delta_t tensor(0.3879, dtype=torch.float64)
9 gae_duplicate tensor(0.2801, dtype=torch.float64) tensor(-7.6992, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1907, dtype=torch.float64) delta_t tensor(-0.0898, dtype=torch.float64)
8 gae_duplicate tensor(-0.3568, dtype=torch.float64) tensor(0.8729, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.6338, dtype=torch.float64) delta_t tensor(0.3912, dtype=torch.float64)
7 gae_duplicate tensor(0.2725, dtype=torch.float64) tensor(-7.6472, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1189, dtype=torch.float64) delta_t tensor(-0.1324, dtype=torch.float64)
6 gae_duplicate tensor(-0.5418, dtype=torch.float64) tensor(1.6864, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3951, dtype=torch.float64) delta_t tensor(-1.6968, dtype=torch.float64)
5 gae_duplicate tensor(-3.6438, dtype=torch.float64) tensor(34.3413, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6898, dtype=torch.float64) delta_t tensor(-3.9343, dtype=torch.float64)
4 gae_duplicate tensor(-6.5588, dtype=torch.float64) tensor(79.0052, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0727, dtype=torch.float64) delta_t tensor(-0.3978, dtype=torch.float64)
3 gae_duplicate tensor(-1.6387, dtype=torch.float64) tensor(15.5837, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3679, dtype=torch.float64) delta_t tensor(-0.5482, dtype=torch.float64)
2 gae_duplicate tensor(-1.0939, dtype=torch.float64) tensor(12.2433, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4163.76318359375
value loss:266.5212707519531
entropies:355.11944580078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.012357950210571 seconds
19 rew tensor(0.5816, dtype=torch.float64) delta_t tensor(0.3153, dtype=torch.float64)
19 gae_duplicate tensor(0.1499, dtype=torch.float64) tensor(-6.2496, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4840, dtype=torch.float64) delta_t tensor(0.1720, dtype=torch.float64)
18 gae_duplicate tensor(-0.0756, dtype=torch.float64) tensor(-4.0376, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5327, dtype=torch.float64) delta_t tensor(0.2949, dtype=torch.float64)
17 gae_duplicate tensor(0.2129, dtype=torch.float64) tensor(-6.2516, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3867, dtype=torch.float64) delta_t tensor(0.1244, dtype=torch.float64)
16 gae_duplicate tensor(-0.0017, dtype=torch.float64) tensor(-3.0283, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5571, dtype=torch.float64) delta_t tensor(0.2931, dtype=torch.float64)
15 gae_duplicate tensor(-0.0068, dtype=torch.float64) tensor(-6.1727, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3389, dtype=torch.float64) delta_t tensor(0.0088, dtype=torch.float64)
14 gae_duplicate tensor(-0.1042, dtype=torch.float64) tensor(-0.7324, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5736, dtype=torch.float64) delta_t tensor(0.2915, dtype=torch.float64)
13 gae_duplicate tensor(-0.1152, dtype=torch.float64) tensor(-5.7668, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3391, dtype=torch.float64) delta_t tensor(0.0191, dtype=torch.float64)
12 gae_duplicate tensor(-0.0533, dtype=torch.float64) tensor(-0.9596, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5788, dtype=torch.float64) delta_t tensor(0.3016, dtype=torch.float64)
11 gae_duplicate tensor(-0.0063, dtype=torch.float64) tensor(-6.1830, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3248, dtype=torch.float64) delta_t tensor(0.0466, dtype=torch.float64)
10 gae_duplicate tensor(-0.0082, dtype=torch.float64) tensor(-1.5140, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5490, dtype=torch.float64) delta_t tensor(0.2353, dtype=torch.float64)
9 gae_duplicate tensor(-0.1897, dtype=torch.float64) tensor(-4.7757, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1921, dtype=torch.float64) delta_t tensor(-0.1382, dtype=torch.float64)
8 gae_duplicate tensor(-0.4365, dtype=torch.float64) tensor(2.1951, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5940, dtype=torch.float64) delta_t tensor(0.2380, dtype=torch.float64)
7 gae_duplicate tensor(0.0482, dtype=torch.float64) tensor(-4.4725, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0473, dtype=torch.float64) delta_t tensor(-0.2346, dtype=torch.float64)
6 gae_duplicate tensor(-0.9633, dtype=torch.float64) tensor(4.0976, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2425, dtype=torch.float64) delta_t tensor(-1.5379, dtype=torch.float64)
5 gae_duplicate tensor(-2.5310, dtype=torch.float64) tensor(31.5265, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3122, dtype=torch.float64) delta_t tensor(-3.5901, dtype=torch.float64)
4 gae_duplicate tensor(-7.2473, dtype=torch.float64) tensor(72.5497, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0939, dtype=torch.float64) delta_t tensor(-0.4346, dtype=torch.float64)
3 gae_duplicate tensor(-1.5748, dtype=torch.float64) tensor(16.1918, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4043, dtype=torch.float64) delta_t tensor(-0.5360, dtype=torch.float64)
2 gae_duplicate tensor(-1.0021, dtype=torch.float64) tensor(12.1196, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4876.931640625
value loss:220.4525604248047
entropies:355.3791198730469
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3976.5176)
ToM Target loss= tensor(3546.2761)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.259401798248291 seconds
19 rew tensor(0.5301, dtype=torch.float64) delta_t tensor(0.2864, dtype=torch.float64)
19 gae_duplicate tensor(0.1761, dtype=torch.float64) tensor(-5.5676, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4609, dtype=torch.float64) delta_t tensor(0.2460, dtype=torch.float64)
18 gae_duplicate tensor(0.1724, dtype=torch.float64) tensor(-5.3794, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5507, dtype=torch.float64) delta_t tensor(0.3879, dtype=torch.float64)
17 gae_duplicate tensor(0.2195, dtype=torch.float64) tensor(-8.2182, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3451, dtype=torch.float64) delta_t tensor(0.0786, dtype=torch.float64)
16 gae_duplicate tensor(-0.0614, dtype=torch.float64) tensor(-2.3477, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5717, dtype=torch.float64) delta_t tensor(0.2863, dtype=torch.float64)
15 gae_duplicate tensor(0.2143, dtype=torch.float64) tensor(-5.8683, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2749, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
14 gae_duplicate tensor(-0.2549, dtype=torch.float64) tensor(-0.3300, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6147, dtype=torch.float64) delta_t tensor(0.3336, dtype=torch.float64)
13 gae_duplicate tensor(0.1870, dtype=torch.float64) tensor(-6.5932, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2859, dtype=torch.float64) delta_t tensor(-0.0044, dtype=torch.float64)
12 gae_duplicate tensor(-0.1695, dtype=torch.float64) tensor(-0.5805, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6251, dtype=torch.float64) delta_t tensor(0.3324, dtype=torch.float64)
11 gae_duplicate tensor(0.2204, dtype=torch.float64) tensor(-6.5442, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2922, dtype=torch.float64) delta_t tensor(0.0265, dtype=torch.float64)
10 gae_duplicate tensor(-0.1116, dtype=torch.float64) tensor(-1.1852, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6291, dtype=torch.float64) delta_t tensor(0.3195, dtype=torch.float64)
9 gae_duplicate tensor(0.2553, dtype=torch.float64) tensor(-6.3955, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2505, dtype=torch.float64) delta_t tensor(-0.0745, dtype=torch.float64)
8 gae_duplicate tensor(-0.2753, dtype=torch.float64) tensor(0.7721, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5850, dtype=torch.float64) delta_t tensor(0.2681, dtype=torch.float64)
7 gae_duplicate tensor(0.1920, dtype=torch.float64) tensor(-5.2508, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2088, dtype=torch.float64) delta_t tensor(-0.0720, dtype=torch.float64)
6 gae_duplicate tensor(-0.2508, dtype=torch.float64) tensor(0.8737, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3908, dtype=torch.float64) delta_t tensor(-1.6588, dtype=torch.float64)
5 gae_duplicate tensor(-2.5090, dtype=torch.float64) tensor(32.7078, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4783, dtype=torch.float64) delta_t tensor(-3.7404, dtype=torch.float64)
4 gae_duplicate tensor(-5.8600, dtype=torch.float64) tensor(77.7588, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1994, dtype=torch.float64) delta_t tensor(-0.5219, dtype=torch.float64)
3 gae_duplicate tensor(-1.3345, dtype=torch.float64) tensor(17.8850, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3059, dtype=torch.float64) delta_t tensor(-0.4218, dtype=torch.float64)
2 gae_duplicate tensor(-0.7808, dtype=torch.float64) tensor(9.9200, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4721.47607421875
value loss:218.8200225830078
entropies:355.58380126953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.623037099838257 seconds
19 rew tensor(0.5692, dtype=torch.float64) delta_t tensor(0.3272, dtype=torch.float64)
19 gae_duplicate tensor(0.2178, dtype=torch.float64) tensor(-6.5397, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3811, dtype=torch.float64) delta_t tensor(0.1671, dtype=torch.float64)
18 gae_duplicate tensor(0.0954, dtype=torch.float64) tensor(-3.9293, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5798, dtype=torch.float64) delta_t tensor(0.3932, dtype=torch.float64)
17 gae_duplicate tensor(0.2741, dtype=torch.float64) tensor(-8.0584, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3565, dtype=torch.float64) delta_t tensor(0.1368, dtype=torch.float64)
16 gae_duplicate tensor(0.0263, dtype=torch.float64) tensor(-3.5278, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5729, dtype=torch.float64) delta_t tensor(0.3217, dtype=torch.float64)
15 gae_duplicate tensor(0.2715, dtype=torch.float64) tensor(-6.5969, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3613, dtype=torch.float64) delta_t tensor(0.1139, dtype=torch.float64)
14 gae_duplicate tensor(0.0827, dtype=torch.float64) tensor(-2.9084, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5871, dtype=torch.float64) delta_t tensor(0.3345, dtype=torch.float64)
13 gae_duplicate tensor(0.2551, dtype=torch.float64) tensor(-6.9582, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3736, dtype=torch.float64) delta_t tensor(0.1165, dtype=torch.float64)
12 gae_duplicate tensor(0.0278, dtype=torch.float64) tensor(-3.0355, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5828, dtype=torch.float64) delta_t tensor(0.3112, dtype=torch.float64)
11 gae_duplicate tensor(0.2592, dtype=torch.float64) tensor(-6.4634, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3803, dtype=torch.float64) delta_t tensor(0.1619, dtype=torch.float64)
10 gae_duplicate tensor(0.0986, dtype=torch.float64) tensor(-3.8259, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5745, dtype=torch.float64) delta_t tensor(0.3066, dtype=torch.float64)
9 gae_duplicate tensor(0.1128, dtype=torch.float64) tensor(-6.4423, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3197, dtype=torch.float64) delta_t tensor(0.0517, dtype=torch.float64)
8 gae_duplicate tensor(-0.1363, dtype=torch.float64) tensor(-1.6593, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5598, dtype=torch.float64) delta_t tensor(0.2939, dtype=torch.float64)
7 gae_duplicate tensor(0.2095, dtype=torch.float64) tensor(-6.0926, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2527, dtype=torch.float64) delta_t tensor(0.0311, dtype=torch.float64)
6 gae_duplicate tensor(-0.2663, dtype=torch.float64) tensor(-1.1679, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.1338, dtype=torch.float64) delta_t tensor(-2.3500, dtype=torch.float64)
5 gae_duplicate tensor(-3.9515, dtype=torch.float64) tensor(45.3953, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9470, dtype=torch.float64) delta_t tensor(-4.1448, dtype=torch.float64)
4 gae_duplicate tensor(-7.4910, dtype=torch.float64) tensor(86.3741, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0613, dtype=torch.float64) delta_t tensor(-0.2844, dtype=torch.float64)
3 gae_duplicate tensor(-1.1230, dtype=torch.float64) tensor(14.0647, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3161, dtype=torch.float64) delta_t tensor(-0.3822, dtype=torch.float64)
2 gae_duplicate tensor(-0.8515, dtype=torch.float64) tensor(8.9311, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4824.23291015625
value loss:282.3481140136719
entropies:355.5841064453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.535656929016113 seconds
19 rew tensor(0.5509, dtype=torch.float64) delta_t tensor(0.3973, dtype=torch.float64)
19 gae_duplicate tensor(0.2883, dtype=torch.float64) tensor(-7.8891, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4868, dtype=torch.float64) delta_t tensor(0.3591, dtype=torch.float64)
18 gae_duplicate tensor(0.2122, dtype=torch.float64) tensor(-7.8579, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5037, dtype=torch.float64) delta_t tensor(0.3973, dtype=torch.float64)
17 gae_duplicate tensor(0.2727, dtype=torch.float64) tensor(-8.6320, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3815, dtype=torch.float64) delta_t tensor(0.1921, dtype=torch.float64)
16 gae_duplicate tensor(0.1394, dtype=torch.float64) tensor(-4.7203, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5714, dtype=torch.float64) delta_t tensor(0.4101, dtype=torch.float64)
15 gae_duplicate tensor(0.3635, dtype=torch.float64) tensor(-8.4945, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2726, dtype=torch.float64) delta_t tensor(0.0881, dtype=torch.float64)
14 gae_duplicate tensor(-0.0896, dtype=torch.float64) tensor(-2.6161, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5978, dtype=torch.float64) delta_t tensor(0.4013, dtype=torch.float64)
13 gae_duplicate tensor(0.3455, dtype=torch.float64) tensor(-8.1365, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1424, dtype=torch.float64) delta_t tensor(-0.0560, dtype=torch.float64)
12 gae_duplicate tensor(-0.5401, dtype=torch.float64) tensor(0.2862, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5924, dtype=torch.float64) delta_t tensor(0.4044, dtype=torch.float64)
11 gae_duplicate tensor(0.2771, dtype=torch.float64) tensor(-8.0651, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2980, dtype=torch.float64) delta_t tensor(0.1356, dtype=torch.float64)
10 gae_duplicate tensor(-0.0256, dtype=torch.float64) tensor(-3.4463, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5886, dtype=torch.float64) delta_t tensor(0.3618, dtype=torch.float64)
9 gae_duplicate tensor(0.2394, dtype=torch.float64) tensor(-7.5582, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2424, dtype=torch.float64) delta_t tensor(-0.0062, dtype=torch.float64)
8 gae_duplicate tensor(-0.1830, dtype=torch.float64) tensor(-0.6209, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5444, dtype=torch.float64) delta_t tensor(0.2989, dtype=torch.float64)
7 gae_duplicate tensor(0.1977, dtype=torch.float64) tensor(-5.8949, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1653, dtype=torch.float64) delta_t tensor(-0.0120, dtype=torch.float64)
6 gae_duplicate tensor(-0.1806, dtype=torch.float64) tensor(-0.3447, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4676, dtype=torch.float64) delta_t tensor(-1.6066, dtype=torch.float64)
5 gae_duplicate tensor(-1.9843, dtype=torch.float64) tensor(31.8980, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3211, dtype=torch.float64) delta_t tensor(-2.4892, dtype=torch.float64)
4 gae_duplicate tensor(-5.6021, dtype=torch.float64) tensor(52.0883, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2353, dtype=torch.float64) delta_t tensor(-0.3970, dtype=torch.float64)
3 gae_duplicate tensor(-1.0775, dtype=torch.float64) tensor(13.1381, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3165, dtype=torch.float64) delta_t tensor(-0.2499, dtype=torch.float64)
2 gae_duplicate tensor(-0.4910, dtype=torch.float64) tensor(6.2280, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1681.5870361328125
value loss:132.33566284179688
entropies:355.6896667480469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.549851179122925 seconds
19 rew tensor(0.5675, dtype=torch.float64) delta_t tensor(0.4187, dtype=torch.float64)
19 gae_duplicate tensor(0.3494, dtype=torch.float64) tensor(-8.3115, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3187, dtype=torch.float64) delta_t tensor(0.1528, dtype=torch.float64)
18 gae_duplicate tensor(-0.0556, dtype=torch.float64) tensor(-3.8880, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5087, dtype=torch.float64) delta_t tensor(0.4582, dtype=torch.float64)
17 gae_duplicate tensor(0.2880, dtype=torch.float64) tensor(-9.4797, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3105, dtype=torch.float64) delta_t tensor(0.1988, dtype=torch.float64)
16 gae_duplicate tensor(0.0231, dtype=torch.float64) tensor(-4.8358, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4686, dtype=torch.float64) delta_t tensor(0.3963, dtype=torch.float64)
15 gae_duplicate tensor(0.0399, dtype=torch.float64) tensor(-8.2381, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2543, dtype=torch.float64) delta_t tensor(0.1240, dtype=torch.float64)
14 gae_duplicate tensor(0.0138, dtype=torch.float64) tensor(-3.2564, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5661, dtype=torch.float64) delta_t tensor(0.4314, dtype=torch.float64)
13 gae_duplicate tensor(0.3835, dtype=torch.float64) tensor(-8.8141, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1563, dtype=torch.float64) delta_t tensor(0.0166, dtype=torch.float64)
12 gae_duplicate tensor(-0.3206, dtype=torch.float64) tensor(-1.2577, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5748, dtype=torch.float64) delta_t tensor(0.4314, dtype=torch.float64)
11 gae_duplicate tensor(0.3743, dtype=torch.float64) tensor(-8.5994, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1744, dtype=torch.float64) delta_t tensor(0.0419, dtype=torch.float64)
10 gae_duplicate tensor(-0.3851, dtype=torch.float64) tensor(-1.7039, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5838, dtype=torch.float64) delta_t tensor(0.4303, dtype=torch.float64)
9 gae_duplicate tensor(0.3930, dtype=torch.float64) tensor(-8.8628, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1338, dtype=torch.float64) delta_t tensor(-0.0254, dtype=torch.float64)
8 gae_duplicate tensor(-0.3876, dtype=torch.float64) tensor(-0.3528, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5411, dtype=torch.float64) delta_t tensor(0.3813, dtype=torch.float64)
7 gae_duplicate tensor(0.3044, dtype=torch.float64) tensor(-7.5221, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0931, dtype=torch.float64) delta_t tensor(-0.0142, dtype=torch.float64)
6 gae_duplicate tensor(-0.2930, dtype=torch.float64) tensor(-0.4885, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8000, dtype=torch.float64) delta_t tensor(-1.8579, dtype=torch.float64)
5 gae_duplicate tensor(-2.5280, dtype=torch.float64) tensor(36.4929, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0680, dtype=torch.float64) delta_t tensor(-4.1099, dtype=torch.float64)
4 gae_duplicate tensor(-8.3797, dtype=torch.float64) tensor(84.8121, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0329, dtype=torch.float64) delta_t tensor(-0.0597, dtype=torch.float64)
3 gae_duplicate tensor(-0.8219, dtype=torch.float64) tensor(9.5357, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2591, dtype=torch.float64) delta_t tensor(-0.1601, dtype=torch.float64)
2 gae_duplicate tensor(-0.4743, dtype=torch.float64) tensor(4.2003, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3305.280517578125
value loss:274.11865234375
entropies:355.69287109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.379796028137207 seconds
19 rew tensor(0.5394, dtype=torch.float64) delta_t tensor(0.4963, dtype=torch.float64)
19 gae_duplicate tensor(0.2628, dtype=torch.float64) tensor(-9.7954, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3847, dtype=torch.float64) delta_t tensor(0.3416, dtype=torch.float64)
18 gae_duplicate tensor(0.1389, dtype=torch.float64) tensor(-7.7472, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5407, dtype=torch.float64) delta_t tensor(0.4858, dtype=torch.float64)
17 gae_duplicate tensor(0.3946, dtype=torch.float64) tensor(-10.2891, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3448, dtype=torch.float64) delta_t tensor(0.3178, dtype=torch.float64)
16 gae_duplicate tensor(0.2598, dtype=torch.float64) tensor(-7.3097, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5437, dtype=torch.float64) delta_t tensor(0.4597, dtype=torch.float64)
15 gae_duplicate tensor(0.3809, dtype=torch.float64) tensor(-9.8086, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2936, dtype=torch.float64) delta_t tensor(0.1902, dtype=torch.float64)
14 gae_duplicate tensor(0.1336, dtype=torch.float64) tensor(-4.7809, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5733, dtype=torch.float64) delta_t tensor(0.5125, dtype=torch.float64)
13 gae_duplicate tensor(0.4896, dtype=torch.float64) tensor(-10.5283, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2763, dtype=torch.float64) delta_t tensor(0.1686, dtype=torch.float64)
12 gae_duplicate tensor(0.1392, dtype=torch.float64) tensor(-4.4496, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5676, dtype=torch.float64) delta_t tensor(0.4952, dtype=torch.float64)
11 gae_duplicate tensor(0.4881, dtype=torch.float64) tensor(-10.2376, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2645, dtype=torch.float64) delta_t tensor(0.2072, dtype=torch.float64)
10 gae_duplicate tensor(0.1730, dtype=torch.float64) tensor(-5.1117, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5846, dtype=torch.float64) delta_t tensor(0.4819, dtype=torch.float64)
9 gae_duplicate tensor(0.4156, dtype=torch.float64) tensor(-9.9958, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2387, dtype=torch.float64) delta_t tensor(0.1406, dtype=torch.float64)
8 gae_duplicate tensor(0.0378, dtype=torch.float64) tensor(-3.8266, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4732, dtype=torch.float64) delta_t tensor(0.3875, dtype=torch.float64)
7 gae_duplicate tensor(0.0451, dtype=torch.float64) tensor(-7.9276, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1285, dtype=torch.float64) delta_t tensor(0.1142, dtype=torch.float64)
6 gae_duplicate tensor(-0.1124, dtype=torch.float64) tensor(-3.0756, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5309, dtype=torch.float64) delta_t tensor(-1.4747, dtype=torch.float64)
5 gae_duplicate tensor(-2.6381, dtype=torch.float64) tensor(28.9471, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4729, dtype=torch.float64) delta_t tensor(-3.4217, dtype=torch.float64)
4 gae_duplicate tensor(-5.4734, dtype=torch.float64) tensor(70.1706, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0444, dtype=torch.float64) delta_t tensor(0.1905, dtype=torch.float64)
3 gae_duplicate tensor(-0.4922, dtype=torch.float64) tensor(3.2772, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2374, dtype=torch.float64) delta_t tensor(-0.0312, dtype=torch.float64)
2 gae_duplicate tensor(-0.4157, dtype=torch.float64) tensor(0.9525, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-13.089719772338867
value loss:178.50131225585938
entropies:355.7532653808594
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3956.7432)
ToM Target loss= tensor(3524.0491)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.2967541217803955 seconds
19 rew tensor(0.5630, dtype=torch.float64) delta_t tensor(0.5510, dtype=torch.float64)
19 gae_duplicate tensor(0.4830, dtype=torch.float64) tensor(-10.8436, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4498, dtype=torch.float64) delta_t tensor(0.4217, dtype=torch.float64)
18 gae_duplicate tensor(0.3312, dtype=torch.float64) tensor(-9.4478, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5514, dtype=torch.float64) delta_t tensor(0.5736, dtype=torch.float64)
17 gae_duplicate tensor(0.5111, dtype=torch.float64) tensor(-12.2423, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4242, dtype=torch.float64) delta_t tensor(0.4183, dtype=torch.float64)
16 gae_duplicate tensor(0.3819, dtype=torch.float64) tensor(-9.4861, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3993, dtype=torch.float64) delta_t tensor(0.4136, dtype=torch.float64)
15 gae_duplicate tensor(-0.2309, dtype=torch.float64) tensor(-9.1691, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3323, dtype=torch.float64) delta_t tensor(0.3056, dtype=torch.float64)
14 gae_duplicate tensor(0.0980, dtype=torch.float64) tensor(-6.9913, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5538, dtype=torch.float64) delta_t tensor(0.5448, dtype=torch.float64)
13 gae_duplicate tensor(0.5458, dtype=torch.float64) tensor(-11.4146, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3151, dtype=torch.float64) delta_t tensor(0.2850, dtype=torch.float64)
12 gae_duplicate tensor(-0.0615, dtype=torch.float64) tensor(-6.8021, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5715, dtype=torch.float64) delta_t tensor(0.5471, dtype=torch.float64)
11 gae_duplicate tensor(0.5410, dtype=torch.float64) tensor(-11.4686, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3253, dtype=torch.float64) delta_t tensor(0.3267, dtype=torch.float64)
10 gae_duplicate tensor(-0.0153, dtype=torch.float64) tensor(-7.5494, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5455, dtype=torch.float64) delta_t tensor(0.4824, dtype=torch.float64)
9 gae_duplicate tensor(0.3511, dtype=torch.float64) tensor(-10.3863, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2495, dtype=torch.float64) delta_t tensor(0.1951, dtype=torch.float64)
8 gae_duplicate tensor(-0.0599, dtype=torch.float64) tensor(-4.9215, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4054, dtype=torch.float64) delta_t tensor(0.3409, dtype=torch.float64)
7 gae_duplicate tensor(0.0769, dtype=torch.float64) tensor(-7.1864, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0892, dtype=torch.float64) delta_t tensor(0.1569, dtype=torch.float64)
6 gae_duplicate tensor(-0.1499, dtype=torch.float64) tensor(-3.8151, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0368, dtype=torch.float64) delta_t tensor(-0.9170, dtype=torch.float64)
5 gae_duplicate tensor(-1.3490, dtype=torch.float64) tensor(17.7229, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.7022, dtype=torch.float64) delta_t tensor(-3.5404, dtype=torch.float64)
4 gae_duplicate tensor(-6.2355, dtype=torch.float64) tensor(71.7771, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0744, dtype=torch.float64) delta_t tensor(0.2166, dtype=torch.float64)
3 gae_duplicate tensor(-0.5242, dtype=torch.float64) tensor(2.9243, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0746, dtype=torch.float64) delta_t tensor(0.2917, dtype=torch.float64)
2 gae_duplicate tensor(0.0749, dtype=torch.float64) tensor(-5.4895, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1782.5457763671875
value loss:213.1747589111328
entropies:355.8622131347656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 6.196371078491211 seconds
19 rew tensor(0.5329, dtype=torch.float64) delta_t tensor(0.5065, dtype=torch.float64)
19 gae_duplicate tensor(0.3016, dtype=torch.float64) tensor(-10.0142, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4151, dtype=torch.float64) delta_t tensor(0.4120, dtype=torch.float64)
18 gae_duplicate tensor(0.2681, dtype=torch.float64) tensor(-9.1445, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4914, dtype=torch.float64) delta_t tensor(0.5589, dtype=torch.float64)
17 gae_duplicate tensor(0.4295, dtype=torch.float64) tensor(-11.9417, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3592, dtype=torch.float64) delta_t tensor(0.2874, dtype=torch.float64)
16 gae_duplicate tensor(0.2407, dtype=torch.float64) tensor(-6.8640, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4815, dtype=torch.float64) delta_t tensor(0.4819, dtype=torch.float64)
15 gae_duplicate tensor(0.2920, dtype=torch.float64) tensor(-10.1722, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1244, dtype=torch.float64) delta_t tensor(0.1367, dtype=torch.float64)
14 gae_duplicate tensor(-0.4918, dtype=torch.float64) tensor(-3.7242, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5232, dtype=torch.float64) delta_t tensor(0.5299, dtype=torch.float64)
13 gae_duplicate tensor(0.3488, dtype=torch.float64) tensor(-10.9346, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2479, dtype=torch.float64) delta_t tensor(0.2264, dtype=torch.float64)
12 gae_duplicate tensor(0.0388, dtype=torch.float64) tensor(-5.5343, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3770, dtype=torch.float64) delta_t tensor(0.3818, dtype=torch.float64)
11 gae_duplicate tensor(-0.4526, dtype=torch.float64) tensor(-8.0045, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2571, dtype=torch.float64) delta_t tensor(0.2819, dtype=torch.float64)
10 gae_duplicate tensor(0.0787, dtype=torch.float64) tensor(-6.3607, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5107, dtype=torch.float64) delta_t tensor(0.4884, dtype=torch.float64)
9 gae_duplicate tensor(0.2523, dtype=torch.float64) tensor(-10.2894, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2222, dtype=torch.float64) delta_t tensor(0.1882, dtype=torch.float64)
8 gae_duplicate tensor(-0.0858, dtype=torch.float64) tensor(-4.7723, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4675, dtype=torch.float64) delta_t tensor(0.4145, dtype=torch.float64)
7 gae_duplicate tensor(0.2196, dtype=torch.float64) tensor(-8.6668, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1799, dtype=torch.float64) delta_t tensor(0.1478, dtype=torch.float64)
6 gae_duplicate tensor(-0.0662, dtype=torch.float64) tensor(-3.8460, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2766, dtype=torch.float64) delta_t tensor(-1.1502, dtype=torch.float64)
5 gae_duplicate tensor(-2.2114, dtype=torch.float64) tensor(22.5021, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2636, dtype=torch.float64) delta_t tensor(-1.0930, dtype=torch.float64)
4 gae_duplicate tensor(-4.0370, dtype=torch.float64) tensor(24.0330, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0814, dtype=torch.float64) delta_t tensor(0.0796, dtype=torch.float64)
3 gae_duplicate tensor(-0.3437, dtype=torch.float64) tensor(0.8033, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3352, dtype=torch.float64) delta_t tensor(-0.0088, dtype=torch.float64)
2 gae_duplicate tensor(-0.2212, dtype=torch.float64) tensor(0.2355, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3289.453369140625
value loss:81.19692993164062
entropies:355.8883056640625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.509252071380615 seconds
19 rew tensor(0.5348, dtype=torch.float64) delta_t tensor(0.5014, dtype=torch.float64)
19 gae_duplicate tensor(0.3354, dtype=torch.float64) tensor(-9.9092, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4220, dtype=torch.float64) delta_t tensor(0.3507, dtype=torch.float64)
18 gae_duplicate tensor(0.0674, dtype=torch.float64) tensor(-7.8833, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5224, dtype=torch.float64) delta_t tensor(0.5520, dtype=torch.float64)
17 gae_duplicate tensor(0.4653, dtype=torch.float64) tensor(-11.6867, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3954, dtype=torch.float64) delta_t tensor(0.4203, dtype=torch.float64)
16 gae_duplicate tensor(0.0972, dtype=torch.float64) tensor(-9.5497, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5456, dtype=torch.float64) delta_t tensor(0.5600, dtype=torch.float64)
15 gae_duplicate tensor(0.5194, dtype=torch.float64) tensor(-12.1557, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3312, dtype=torch.float64) delta_t tensor(0.3308, dtype=torch.float64)
14 gae_duplicate tensor(0.1945, dtype=torch.float64) tensor(-7.8337, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5700, dtype=torch.float64) delta_t tensor(0.5641, dtype=torch.float64)
13 gae_duplicate tensor(0.5363, dtype=torch.float64) tensor(-11.9422, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3492, dtype=torch.float64) delta_t tensor(0.3428, dtype=torch.float64)
12 gae_duplicate tensor(0.1806, dtype=torch.float64) tensor(-8.0633, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4223, dtype=torch.float64) delta_t tensor(0.3922, dtype=torch.float64)
11 gae_duplicate tensor(-0.2107, dtype=torch.float64) tensor(-8.5997, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3370, dtype=torch.float64) delta_t tensor(0.3503, dtype=torch.float64)
10 gae_duplicate tensor(0.2121, dtype=torch.float64) tensor(-7.8097, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4431, dtype=torch.float64) delta_t tensor(-0.4912, dtype=torch.float64)
9 gae_duplicate tensor(-5.4214, dtype=torch.float64) tensor(8.9790, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2663, dtype=torch.float64) delta_t tensor(0.2046, dtype=torch.float64)
8 gae_duplicate tensor(-0.2008, dtype=torch.float64) tensor(-3.1243, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4719, dtype=torch.float64) delta_t tensor(0.4344, dtype=torch.float64)
7 gae_duplicate tensor(0.3274, dtype=torch.float64) tensor(-8.9124, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1033, dtype=torch.float64) delta_t tensor(0.1140, dtype=torch.float64)
6 gae_duplicate tensor(-0.2964, dtype=torch.float64) tensor(-3.1538, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0877, dtype=torch.float64) delta_t tensor(-0.9093, dtype=torch.float64)
5 gae_duplicate tensor(-2.1222, dtype=torch.float64) tensor(17.9167, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3628, dtype=torch.float64) delta_t tensor(-3.1325, dtype=torch.float64)
4 gae_duplicate tensor(-6.5517, dtype=torch.float64) tensor(63.0223, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0663, dtype=torch.float64) delta_t tensor(0.1160, dtype=torch.float64)
3 gae_duplicate tensor(-0.6481, dtype=torch.float64) tensor(4.0499, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3060, dtype=torch.float64) delta_t tensor(0.1158, dtype=torch.float64)
2 gae_duplicate tensor(-0.2944, dtype=torch.float64) tensor(-1.9128, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:906.6160278320312
value loss:218.16114807128906
entropies:355.8705139160156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.58284592628479 seconds
19 rew tensor(0.5446, dtype=torch.float64) delta_t tensor(0.5041, dtype=torch.float64)
19 gae_duplicate tensor(0.4010, dtype=torch.float64) tensor(-9.9565, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3896, dtype=torch.float64) delta_t tensor(0.2722, dtype=torch.float64)
18 gae_duplicate tensor(0.1677, dtype=torch.float64) tensor(-6.3790, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5352, dtype=torch.float64) delta_t tensor(0.5339, dtype=torch.float64)
17 gae_duplicate tensor(0.4685, dtype=torch.float64) tensor(-11.1914, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2411, dtype=torch.float64) delta_t tensor(0.2723, dtype=torch.float64)
16 gae_duplicate tensor(0.0916, dtype=torch.float64) tensor(-6.4886, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5325, dtype=torch.float64) delta_t tensor(0.5469, dtype=torch.float64)
15 gae_duplicate tensor(0.5337, dtype=torch.float64) tensor(-11.4220, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2325, dtype=torch.float64) delta_t tensor(0.1990, dtype=torch.float64)
14 gae_duplicate tensor(0.1103, dtype=torch.float64) tensor(-5.0735, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5708, dtype=torch.float64) delta_t tensor(0.5896, dtype=torch.float64)
13 gae_duplicate tensor(0.5488, dtype=torch.float64) tensor(-12.1808, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2420, dtype=torch.float64) delta_t tensor(0.1906, dtype=torch.float64)
12 gae_duplicate tensor(0.0923, dtype=torch.float64) tensor(-5.0291, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5648, dtype=torch.float64) delta_t tensor(0.5604, dtype=torch.float64)
11 gae_duplicate tensor(0.5157, dtype=torch.float64) tensor(-11.5761, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2370, dtype=torch.float64) delta_t tensor(0.2277, dtype=torch.float64)
10 gae_duplicate tensor(0.1277, dtype=torch.float64) tensor(-5.6420, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5733, dtype=torch.float64) delta_t tensor(0.5132, dtype=torch.float64)
9 gae_duplicate tensor(0.4935, dtype=torch.float64) tensor(-10.7506, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2025, dtype=torch.float64) delta_t tensor(0.1312, dtype=torch.float64)
8 gae_duplicate tensor(-0.0355, dtype=torch.float64) tensor(-3.6793, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5305, dtype=torch.float64) delta_t tensor(0.4671, dtype=torch.float64)
7 gae_duplicate tensor(0.4285, dtype=torch.float64) tensor(-9.6525, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1607, dtype=torch.float64) delta_t tensor(0.1568, dtype=torch.float64)
6 gae_duplicate tensor(0.0178, dtype=torch.float64) tensor(-4.0447, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5371, dtype=torch.float64) delta_t tensor(-1.3149, dtype=torch.float64)
5 gae_duplicate tensor(-1.5131, dtype=torch.float64) tensor(25.4828, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4093, dtype=torch.float64) delta_t tensor(-3.1471, dtype=torch.float64)
4 gae_duplicate tensor(-6.1734, dtype=torch.float64) tensor(64.8194, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0795, dtype=torch.float64) delta_t tensor(0.0720, dtype=torch.float64)
3 gae_duplicate tensor(-0.5698, dtype=torch.float64) tensor(5.0171, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3127, dtype=torch.float64) delta_t tensor(0.0765, dtype=torch.float64)
2 gae_duplicate tensor(-0.2596, dtype=torch.float64) tensor(-1.0176, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:917.18310546875
value loss:156.22264099121094
entropies:355.89154052734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.115398168563843 seconds
19 rew tensor(0.5220, dtype=torch.float64) delta_t tensor(0.4536, dtype=torch.float64)
19 gae_duplicate tensor(0.1096, dtype=torch.float64) tensor(-8.9698, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4124, dtype=torch.float64) delta_t tensor(0.3418, dtype=torch.float64)
18 gae_duplicate tensor(0.2452, dtype=torch.float64) tensor(-7.6675, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4946, dtype=torch.float64) delta_t tensor(0.5254, dtype=torch.float64)
17 gae_duplicate tensor(0.4647, dtype=torch.float64) tensor(-11.1383, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3780, dtype=torch.float64) delta_t tensor(0.3605, dtype=torch.float64)
16 gae_duplicate tensor(0.2257, dtype=torch.float64) tensor(-8.2366, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5112, dtype=torch.float64) delta_t tensor(0.5103, dtype=torch.float64)
15 gae_duplicate tensor(0.3566, dtype=torch.float64) tensor(-10.9694, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3135, dtype=torch.float64) delta_t tensor(0.2654, dtype=torch.float64)
14 gae_duplicate tensor(0.2379, dtype=torch.float64) tensor(-6.3521, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5272, dtype=torch.float64) delta_t tensor(0.5802, dtype=torch.float64)
13 gae_duplicate tensor(0.5498, dtype=torch.float64) tensor(-12.1180, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2470, dtype=torch.float64) delta_t tensor(0.1972, dtype=torch.float64)
12 gae_duplicate tensor(0.0109, dtype=torch.float64) tensor(-5.1095, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5731, dtype=torch.float64) delta_t tensor(0.5788, dtype=torch.float64)
11 gae_duplicate tensor(0.5022, dtype=torch.float64) tensor(-11.9653, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2502, dtype=torch.float64) delta_t tensor(0.2206, dtype=torch.float64)
10 gae_duplicate tensor(-0.0086, dtype=torch.float64) tensor(-5.5392, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5743, dtype=torch.float64) delta_t tensor(0.5020, dtype=torch.float64)
9 gae_duplicate tensor(0.4781, dtype=torch.float64) tensor(-10.4487, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2083, dtype=torch.float64) delta_t tensor(0.1175, dtype=torch.float64)
8 gae_duplicate tensor(-0.0308, dtype=torch.float64) tensor(-3.3794, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5314, dtype=torch.float64) delta_t tensor(0.4302, dtype=torch.float64)
7 gae_duplicate tensor(0.4131, dtype=torch.float64) tensor(-8.8567, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1663, dtype=torch.float64) delta_t tensor(0.1357, dtype=torch.float64)
6 gae_duplicate tensor(-0.1545, dtype=torch.float64) tensor(-3.5709, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5148, dtype=torch.float64) delta_t tensor(-1.2557, dtype=torch.float64)
5 gae_duplicate tensor(-2.3377, dtype=torch.float64) tensor(24.5563, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.2954, dtype=torch.float64) delta_t tensor(-2.9926, dtype=torch.float64)
4 gae_duplicate tensor(-4.5145, dtype=torch.float64) tensor(61.6711, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1467, dtype=torch.float64) delta_t tensor(0.0635, dtype=torch.float64)
3 gae_duplicate tensor(-0.4812, dtype=torch.float64) tensor(4.9103, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3275, dtype=torch.float64) delta_t tensor(0.1475, dtype=torch.float64)
2 gae_duplicate tensor(-0.0541, dtype=torch.float64) tensor(-2.4244, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1286.737060546875
value loss:160.53604125976562
entropies:355.93304443359375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3959.6685)
ToM Target loss= tensor(3518.7590)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.288509845733643 seconds
19 rew tensor(0.5296, dtype=torch.float64) delta_t tensor(0.3953, dtype=torch.float64)
19 gae_duplicate tensor(0.2656, dtype=torch.float64) tensor(-7.8312, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3889, dtype=torch.float64) delta_t tensor(0.2578, dtype=torch.float64)
18 gae_duplicate tensor(0.1205, dtype=torch.float64) tensor(-5.8862, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5589, dtype=torch.float64) delta_t tensor(0.5880, dtype=torch.float64)
17 gae_duplicate tensor(0.4741, dtype=torch.float64) tensor(-12.2138, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2770, dtype=torch.float64) delta_t tensor(0.1208, dtype=torch.float64)
16 gae_duplicate tensor(-0.0621, dtype=torch.float64) tensor(-3.6128, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5442, dtype=torch.float64) delta_t tensor(0.5643, dtype=torch.float64)
15 gae_duplicate tensor(0.4411, dtype=torch.float64) tensor(-11.4902, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1730, dtype=torch.float64) delta_t tensor(0.0942, dtype=torch.float64)
14 gae_duplicate tensor(-0.0814, dtype=torch.float64) tensor(-3.0218, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5673, dtype=torch.float64) delta_t tensor(0.5818, dtype=torch.float64)
13 gae_duplicate tensor(0.5057, dtype=torch.float64) tensor(-11.8243, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1972, dtype=torch.float64) delta_t tensor(0.1036, dtype=torch.float64)
12 gae_duplicate tensor(-0.1089, dtype=torch.float64) tensor(-3.2220, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5760, dtype=torch.float64) delta_t tensor(0.5429, dtype=torch.float64)
11 gae_duplicate tensor(0.4612, dtype=torch.float64) tensor(-11.0429, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2068, dtype=torch.float64) delta_t tensor(0.1067, dtype=torch.float64)
10 gae_duplicate tensor(-0.1697, dtype=torch.float64) tensor(-3.2231, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5632, dtype=torch.float64) delta_t tensor(0.4558, dtype=torch.float64)
9 gae_duplicate tensor(0.4256, dtype=torch.float64) tensor(-9.3420, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1506, dtype=torch.float64) delta_t tensor(0.0305, dtype=torch.float64)
8 gae_duplicate tensor(-0.1035, dtype=torch.float64) tensor(-1.5379, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5334, dtype=torch.float64) delta_t tensor(0.3942, dtype=torch.float64)
7 gae_duplicate tensor(0.3576, dtype=torch.float64) tensor(-7.9526, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0944, dtype=torch.float64) delta_t tensor(0.0394, dtype=torch.float64)
6 gae_duplicate tensor(-0.1764, dtype=torch.float64) tensor(-1.5739, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7046, dtype=torch.float64) delta_t tensor(-1.4412, dtype=torch.float64)
5 gae_duplicate tensor(-2.3211, dtype=torch.float64) tensor(28.3390, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6650, dtype=torch.float64) delta_t tensor(-2.2828, dtype=torch.float64)
4 gae_duplicate tensor(-4.5060, dtype=torch.float64) tensor(47.8608, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0814, dtype=torch.float64) delta_t tensor(0.1060, dtype=torch.float64)
3 gae_duplicate tensor(-0.5969, dtype=torch.float64) tensor(2.6824, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2109, dtype=torch.float64) delta_t tensor(0.2879, dtype=torch.float64)
2 gae_duplicate tensor(-0.2732, dtype=torch.float64) tensor(-5.4234, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1000.9544677734375
value loss:113.71792602539062
entropies:355.9421691894531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.224677085876465 seconds
19 rew tensor(0.5507, dtype=torch.float64) delta_t tensor(0.3917, dtype=torch.float64)
19 gae_duplicate tensor(0.2825, dtype=torch.float64) tensor(-7.7483, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3312, dtype=torch.float64) delta_t tensor(0.0640, dtype=torch.float64)
18 gae_duplicate tensor(-0.0993, dtype=torch.float64) tensor(-2.0383, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5663, dtype=torch.float64) delta_t tensor(0.4669, dtype=torch.float64)
17 gae_duplicate tensor(0.3795, dtype=torch.float64) tensor(-9.4364, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3040, dtype=torch.float64) delta_t tensor(0.2129, dtype=torch.float64)
16 gae_duplicate tensor(0.0563, dtype=torch.float64) tensor(-5.1522, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5379, dtype=torch.float64) delta_t tensor(0.4959, dtype=torch.float64)
15 gae_duplicate tensor(0.4369, dtype=torch.float64) tensor(-10.3193, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3057, dtype=torch.float64) delta_t tensor(0.1749, dtype=torch.float64)
14 gae_duplicate tensor(0.1414, dtype=torch.float64) tensor(-4.4928, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5612, dtype=torch.float64) delta_t tensor(0.4410, dtype=torch.float64)
13 gae_duplicate tensor(0.3507, dtype=torch.float64) tensor(-9.1660, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3079, dtype=torch.float64) delta_t tensor(0.1900, dtype=torch.float64)
12 gae_duplicate tensor(0.1780, dtype=torch.float64) tensor(-4.6734, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5630, dtype=torch.float64) delta_t tensor(0.4301, dtype=torch.float64)
11 gae_duplicate tensor(0.4197, dtype=torch.float64) tensor(-8.9705, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3242, dtype=torch.float64) delta_t tensor(0.1996, dtype=torch.float64)
10 gae_duplicate tensor(0.1588, dtype=torch.float64) tensor(-4.8455, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5713, dtype=torch.float64) delta_t tensor(0.4086, dtype=torch.float64)
9 gae_duplicate tensor(0.3585, dtype=torch.float64) tensor(-8.5637, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2824, dtype=torch.float64) delta_t tensor(0.1010, dtype=torch.float64)
8 gae_duplicate tensor(0.0392, dtype=torch.float64) tensor(-2.8526, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5288, dtype=torch.float64) delta_t tensor(0.3371, dtype=torch.float64)
7 gae_duplicate tensor(0.3273, dtype=torch.float64) tensor(-6.9549, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2405, dtype=torch.float64) delta_t tensor(0.0823, dtype=torch.float64)
6 gae_duplicate tensor(0.0368, dtype=torch.float64) tensor(-2.3223, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4953, dtype=torch.float64) delta_t tensor(-1.2849, dtype=torch.float64)
5 gae_duplicate tensor(-2.1556, dtype=torch.float64) tensor(25.1732, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.2492, dtype=torch.float64) delta_t tensor(-3.7939, dtype=torch.float64)
4 gae_duplicate tensor(-7.5806, dtype=torch.float64) tensor(77.5554, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0909, dtype=torch.float64) delta_t tensor(0.0772, dtype=torch.float64)
3 gae_duplicate tensor(-0.7662, dtype=torch.float64) tensor(6.2251, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2190, dtype=torch.float64) delta_t tensor(0.2390, dtype=torch.float64)
2 gae_duplicate tensor(-0.1263, dtype=torch.float64) tensor(-4.1055, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1030.9508056640625
value loss:211.097900390625
entropies:355.9499816894531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.129272937774658 seconds
19 rew tensor(0.5308, dtype=torch.float64) delta_t tensor(0.3151, dtype=torch.float64)
19 gae_duplicate tensor(0.1938, dtype=torch.float64) tensor(-6.2169, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4031, dtype=torch.float64) delta_t tensor(0.1932, dtype=torch.float64)
18 gae_duplicate tensor(0.0969, dtype=torch.float64) tensor(-4.4417, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5108, dtype=torch.float64) delta_t tensor(0.3823, dtype=torch.float64)
17 gae_duplicate tensor(0.2622, dtype=torch.float64) tensor(-8.0121, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3767, dtype=torch.float64) delta_t tensor(0.1764, dtype=torch.float64)
16 gae_duplicate tensor(0.0736, dtype=torch.float64) tensor(-4.2787, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5477, dtype=torch.float64) delta_t tensor(0.4618, dtype=torch.float64)
15 gae_duplicate tensor(0.3248, dtype=torch.float64) tensor(-9.5684, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3032, dtype=torch.float64) delta_t tensor(0.1260, dtype=torch.float64)
14 gae_duplicate tensor(0.0819, dtype=torch.float64) tensor(-3.4391, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5548, dtype=torch.float64) delta_t tensor(0.4322, dtype=torch.float64)
13 gae_duplicate tensor(0.3349, dtype=torch.float64) tensor(-8.8748, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1444, dtype=torch.float64) delta_t tensor(0.0269, dtype=torch.float64)
12 gae_duplicate tensor(-0.5066, dtype=torch.float64) tensor(-1.4090, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5487, dtype=torch.float64) delta_t tensor(0.5197, dtype=torch.float64)
11 gae_duplicate tensor(0.3842, dtype=torch.float64) tensor(-10.4238, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3062, dtype=torch.float64) delta_t tensor(0.1714, dtype=torch.float64)
10 gae_duplicate tensor(0.0846, dtype=torch.float64) tensor(-4.4414, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5078, dtype=torch.float64) delta_t tensor(0.3423, dtype=torch.float64)
9 gae_duplicate tensor(0.2303, dtype=torch.float64) tensor(-7.2175, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2006, dtype=torch.float64) delta_t tensor(0.1165, dtype=torch.float64)
8 gae_duplicate tensor(-0.0869, dtype=torch.float64) tensor(-3.0187, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4483, dtype=torch.float64) delta_t tensor(0.2520, dtype=torch.float64)
7 gae_duplicate tensor(0.0355, dtype=torch.float64) tensor(-5.2749, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0509, dtype=torch.float64) delta_t tensor(0.0369, dtype=torch.float64)
6 gae_duplicate tensor(-0.1363, dtype=torch.float64) tensor(-1.2571, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2130, dtype=torch.float64) delta_t tensor(-0.8420, dtype=torch.float64)
5 gae_duplicate tensor(-1.8643, dtype=torch.float64) tensor(16.5722, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4463, dtype=torch.float64) delta_t tensor(-3.0044, dtype=torch.float64)
4 gae_duplicate tensor(-7.0951, dtype=torch.float64) tensor(61.4336, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0761, dtype=torch.float64) delta_t tensor(0.2289, dtype=torch.float64)
3 gae_duplicate tensor(-0.2347, dtype=torch.float64) tensor(1.5665, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1409, dtype=torch.float64) delta_t tensor(0.3870, dtype=torch.float64)
2 gae_duplicate tensor(-0.0478, dtype=torch.float64) tensor(-7.5171, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:218.11822509765625
value loss:201.87881469726562
entropies:355.9274597167969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.620110750198364 seconds
19 rew tensor(0.5086, dtype=torch.float64) delta_t tensor(0.2771, dtype=torch.float64)
19 gae_duplicate tensor(0.0986, dtype=torch.float64) tensor(-5.3888, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3788, dtype=torch.float64) delta_t tensor(0.1224, dtype=torch.float64)
18 gae_duplicate tensor(-0.0226, dtype=torch.float64) tensor(-2.9351, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5257, dtype=torch.float64) delta_t tensor(0.4205, dtype=torch.float64)
17 gae_duplicate tensor(0.2384, dtype=torch.float64) tensor(-8.5602, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3350, dtype=torch.float64) delta_t tensor(0.1539, dtype=torch.float64)
16 gae_duplicate tensor(-0.0888, dtype=torch.float64) tensor(-3.9265, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5196, dtype=torch.float64) delta_t tensor(0.3948, dtype=torch.float64)
15 gae_duplicate tensor(0.2661, dtype=torch.float64) tensor(-8.1825, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2482, dtype=torch.float64) delta_t tensor(0.0779, dtype=torch.float64)
14 gae_duplicate tensor(0.0064, dtype=torch.float64) tensor(-2.3540, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5430, dtype=torch.float64) delta_t tensor(0.5749, dtype=torch.float64)
13 gae_duplicate tensor(0.2016, dtype=torch.float64) tensor(-11.6657, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0798, dtype=torch.float64) delta_t tensor(-0.0602, dtype=torch.float64)
12 gae_duplicate tensor(-0.2759, dtype=torch.float64) tensor(-0.0138, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5580, dtype=torch.float64) delta_t tensor(0.4907, dtype=torch.float64)
11 gae_duplicate tensor(0.3553, dtype=torch.float64) tensor(-9.6697, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2162, dtype=torch.float64) delta_t tensor(0.0217, dtype=torch.float64)
10 gae_duplicate tensor(-0.0626, dtype=torch.float64) tensor(-1.3818, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5659, dtype=torch.float64) delta_t tensor(0.3594, dtype=torch.float64)
9 gae_duplicate tensor(0.3039, dtype=torch.float64) tensor(-7.1986, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1743, dtype=torch.float64) delta_t tensor(-0.0671, dtype=torch.float64)
8 gae_duplicate tensor(-0.2101, dtype=torch.float64) tensor(0.6170, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5232, dtype=torch.float64) delta_t tensor(0.2760, dtype=torch.float64)
7 gae_duplicate tensor(0.2568, dtype=torch.float64) tensor(-5.4086, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1323, dtype=torch.float64) delta_t tensor(-0.0528, dtype=torch.float64)
6 gae_duplicate tensor(-0.0815, dtype=torch.float64) tensor(0.5095, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1763, dtype=torch.float64) delta_t tensor(-0.7630, dtype=torch.float64)
5 gae_duplicate tensor(-1.9251, dtype=torch.float64) tensor(15.4895, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0728, dtype=torch.float64) delta_t tensor(-2.4852, dtype=torch.float64)
4 gae_duplicate tensor(-5.2039, dtype=torch.float64) tensor(50.9269, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1454, dtype=torch.float64) delta_t tensor(-0.1351, dtype=torch.float64)
3 gae_duplicate tensor(-0.7488, dtype=torch.float64) tensor(7.7945, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3163, dtype=torch.float64) delta_t tensor(0.1585, dtype=torch.float64)
2 gae_duplicate tensor(-0.1814, dtype=torch.float64) tensor(-2.3771, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-434.93804931640625
value loss:107.94105529785156
entropies:355.8413391113281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.340131044387817 seconds
19 rew tensor(0.5362, dtype=torch.float64) delta_t tensor(0.2880, dtype=torch.float64)
19 gae_duplicate tensor(0.1519, dtype=torch.float64) tensor(-5.6105, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3700, dtype=torch.float64) delta_t tensor(-0.0066, dtype=torch.float64)
18 gae_duplicate tensor(-0.3958, dtype=torch.float64) tensor(-0.4013, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5097, dtype=torch.float64) delta_t tensor(0.2395, dtype=torch.float64)
17 gae_duplicate tensor(-0.0531, dtype=torch.float64) tensor(-4.8036, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3046, dtype=torch.float64) delta_t tensor(0.1542, dtype=torch.float64)
16 gae_duplicate tensor(-0.1951, dtype=torch.float64) tensor(-3.5007, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5311, dtype=torch.float64) delta_t tensor(0.4926, dtype=torch.float64)
15 gae_duplicate tensor(0.2311, dtype=torch.float64) tensor(-10.1579, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2216, dtype=torch.float64) delta_t tensor(0.0098, dtype=torch.float64)
14 gae_duplicate tensor(-0.1259, dtype=torch.float64) tensor(-1.2034, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5547, dtype=torch.float64) delta_t tensor(0.5142, dtype=torch.float64)
13 gae_duplicate tensor(0.3722, dtype=torch.float64) tensor(-10.2770, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2378, dtype=torch.float64) delta_t tensor(-0.0002, dtype=torch.float64)
12 gae_duplicate tensor(-0.2023, dtype=torch.float64) tensor(-1.0285, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5624, dtype=torch.float64) delta_t tensor(0.4385, dtype=torch.float64)
11 gae_duplicate tensor(0.3371, dtype=torch.float64) tensor(-8.6382, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2463, dtype=torch.float64) delta_t tensor(0.0257, dtype=torch.float64)
10 gae_duplicate tensor(-0.1883, dtype=torch.float64) tensor(-1.3915, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5360, dtype=torch.float64) delta_t tensor(0.2494, dtype=torch.float64)
9 gae_duplicate tensor(0.1052, dtype=torch.float64) tensor(-5.0492, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1772, dtype=torch.float64) delta_t tensor(-0.0652, dtype=torch.float64)
8 gae_duplicate tensor(-0.3897, dtype=torch.float64) tensor(0.8088, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5208, dtype=torch.float64) delta_t tensor(0.2414, dtype=torch.float64)
7 gae_duplicate tensor(0.1768, dtype=torch.float64) tensor(-4.6569, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1083, dtype=torch.float64) delta_t tensor(-0.1048, dtype=torch.float64)
6 gae_duplicate tensor(-0.3028, dtype=torch.float64) tensor(1.5565, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4811, dtype=torch.float64) delta_t tensor(-1.0535, dtype=torch.float64)
5 gae_duplicate tensor(-1.1939, dtype=torch.float64) tensor(21.3937, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9240, dtype=torch.float64) delta_t tensor(-3.4285, dtype=torch.float64)
4 gae_duplicate tensor(-6.7907, dtype=torch.float64) tensor(69.1758, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0779, dtype=torch.float64) delta_t tensor(0.1144, dtype=torch.float64)
3 gae_duplicate tensor(-0.5043, dtype=torch.float64) tensor(4.7062, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1396, dtype=torch.float64) delta_t tensor(0.5146, dtype=torch.float64)
2 gae_duplicate tensor(0.1164, dtype=torch.float64) tensor(-9.5954, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1787.672119140625
value loss:186.7372589111328
entropies:355.6365051269531
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3963.5923)
ToM Target loss= tensor(3517.0166)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.197669744491577 seconds
19 rew tensor(0.5408, dtype=torch.float64) delta_t tensor(0.4166, dtype=torch.float64)
19 gae_duplicate tensor(-0.0384, dtype=torch.float64) tensor(-8.3302, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4045, dtype=torch.float64) delta_t tensor(0.0677, dtype=torch.float64)
18 gae_duplicate tensor(-0.0284, dtype=torch.float64) tensor(-2.1866, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5350, dtype=torch.float64) delta_t tensor(0.2799, dtype=torch.float64)
17 gae_duplicate tensor(0.0035, dtype=torch.float64) tensor(-5.8531, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3773, dtype=torch.float64) delta_t tensor(0.1129, dtype=torch.float64)
16 gae_duplicate tensor(-0.1376, dtype=torch.float64) tensor(-2.7654, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4646, dtype=torch.float64) delta_t tensor(0.3429, dtype=torch.float64)
15 gae_duplicate tensor(0.1453, dtype=torch.float64) tensor(-6.9935, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1642, dtype=torch.float64) delta_t tensor(0.0107, dtype=torch.float64)
14 gae_duplicate tensor(-0.2085, dtype=torch.float64) tensor(-0.8848, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5574, dtype=torch.float64) delta_t tensor(0.6711, dtype=torch.float64)
13 gae_duplicate tensor(0.1807, dtype=torch.float64) tensor(-13.2880, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0446, dtype=torch.float64) delta_t tensor(-0.2859, dtype=torch.float64)
12 gae_duplicate tensor(-0.7527, dtype=torch.float64) tensor(4.4987, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5496, dtype=torch.float64) delta_t tensor(0.7052, dtype=torch.float64)
11 gae_duplicate tensor(0.3701, dtype=torch.float64) tensor(-13.6317, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0610, dtype=torch.float64) delta_t tensor(-0.2854, dtype=torch.float64)
10 gae_duplicate tensor(-0.8205, dtype=torch.float64) tensor(4.2971, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5507, dtype=torch.float64) delta_t tensor(0.4331, dtype=torch.float64)
9 gae_duplicate tensor(0.3005, dtype=torch.float64) tensor(-8.2043, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0047, dtype=torch.float64) delta_t tensor(-0.1822, dtype=torch.float64)
8 gae_duplicate tensor(-0.3391, dtype=torch.float64) tensor(2.8186, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5076, dtype=torch.float64) delta_t tensor(0.2787, dtype=torch.float64)
7 gae_duplicate tensor(0.2194, dtype=torch.float64) tensor(-5.1952, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0659, dtype=torch.float64) delta_t tensor(-0.1804, dtype=torch.float64)
6 gae_duplicate tensor(-0.3408, dtype=torch.float64) tensor(3.0723, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9081, dtype=torch.float64) delta_t tensor(-1.3826, dtype=torch.float64)
5 gae_duplicate tensor(-2.6930, dtype=torch.float64) tensor(27.4711, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6560, dtype=torch.float64) delta_t tensor(-2.1534, dtype=torch.float64)
4 gae_duplicate tensor(-5.3897, dtype=torch.float64) tensor(46.8336, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0173, dtype=torch.float64) delta_t tensor(0.3249, dtype=torch.float64)
3 gae_duplicate tensor(-0.1619, dtype=torch.float64) tensor(-1.8345, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2375, dtype=torch.float64) delta_t tensor(0.2780, dtype=torch.float64)
2 gae_duplicate tensor(-0.3721, dtype=torch.float64) tensor(-5.6768, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-859.8932495117188
value loss:127.95861053466797
entropies:355.36962890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.229341268539429 seconds
19 rew tensor(0.5451, dtype=torch.float64) delta_t tensor(0.1984, dtype=torch.float64)
19 gae_duplicate tensor(0.1160, dtype=torch.float64) tensor(-3.8247, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4041, dtype=torch.float64) delta_t tensor(-0.0202, dtype=torch.float64)
18 gae_duplicate tensor(-0.4624, dtype=torch.float64) tensor(0.0706, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5319, dtype=torch.float64) delta_t tensor(0.2227, dtype=torch.float64)
17 gae_duplicate tensor(-0.0311, dtype=torch.float64) tensor(-4.5045, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3280, dtype=torch.float64) delta_t tensor(0.0462, dtype=torch.float64)
16 gae_duplicate tensor(-0.2407, dtype=torch.float64) tensor(-1.3285, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5134, dtype=torch.float64) delta_t tensor(0.4109, dtype=torch.float64)
15 gae_duplicate tensor(0.1822, dtype=torch.float64) tensor(-8.2544, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2161, dtype=torch.float64) delta_t tensor(-0.0441, dtype=torch.float64)
14 gae_duplicate tensor(-0.2083, dtype=torch.float64) tensor(-0.0696, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5488, dtype=torch.float64) delta_t tensor(0.6300, dtype=torch.float64)
13 gae_duplicate tensor(0.3026, dtype=torch.float64) tensor(-12.6554, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1403, dtype=torch.float64) delta_t tensor(-0.1590, dtype=torch.float64)
12 gae_duplicate tensor(-0.4661, dtype=torch.float64) tensor(1.9622, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5637, dtype=torch.float64) delta_t tensor(0.6944, dtype=torch.float64)
11 gae_duplicate tensor(0.2762, dtype=torch.float64) tensor(-13.9297, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1345, dtype=torch.float64) delta_t tensor(-0.2530, dtype=torch.float64)
10 gae_duplicate tensor(-0.7735, dtype=torch.float64) tensor(3.5967, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5642, dtype=torch.float64) delta_t tensor(0.4392, dtype=torch.float64)
9 gae_duplicate tensor(0.1925, dtype=torch.float64) tensor(-8.2934, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0929, dtype=torch.float64) delta_t tensor(-0.2784, dtype=torch.float64)
8 gae_duplicate tensor(-0.4200, dtype=torch.float64) tensor(4.5568, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5217, dtype=torch.float64) delta_t tensor(0.2489, dtype=torch.float64)
7 gae_duplicate tensor(0.1388, dtype=torch.float64) tensor(-4.3254, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0512, dtype=torch.float64) delta_t tensor(-0.1331, dtype=torch.float64)
6 gae_duplicate tensor(-0.2440, dtype=torch.float64) tensor(2.1580, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1868, dtype=torch.float64) delta_t tensor(-0.6243, dtype=torch.float64)
5 gae_duplicate tensor(-1.0342, dtype=torch.float64) tensor(12.6199, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.4365, dtype=torch.float64) delta_t tensor(-3.8242, dtype=torch.float64)
4 gae_duplicate tensor(-5.1342, dtype=torch.float64) tensor(76.5015, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1269, dtype=torch.float64) delta_t tensor(0.2327, dtype=torch.float64)
3 gae_duplicate tensor(-0.6744, dtype=torch.float64) tensor(3.1758, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1271, dtype=torch.float64) delta_t tensor(0.6384, dtype=torch.float64)
2 gae_duplicate tensor(0.2868, dtype=torch.float64) tensor(-12.1717, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2001.1729736328125
value loss:172.8465576171875
entropies:354.9171142578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.413907051086426 seconds
19 rew tensor(0.5015, dtype=torch.float64) delta_t tensor(0.1459, dtype=torch.float64)
19 gae_duplicate tensor(-0.0646, dtype=torch.float64) tensor(-2.9726, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4041, dtype=torch.float64) delta_t tensor(0.0425, dtype=torch.float64)
18 gae_duplicate tensor(-0.1416, dtype=torch.float64) tensor(-1.2112, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5026, dtype=torch.float64) delta_t tensor(0.1488, dtype=torch.float64)
17 gae_duplicate tensor(0.0584, dtype=torch.float64) tensor(-3.1675, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3898, dtype=torch.float64) delta_t tensor(-0.0608, dtype=torch.float64)
16 gae_duplicate tensor(-0.5716, dtype=torch.float64) tensor(0.7970, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4802, dtype=torch.float64) delta_t tensor(0.2920, dtype=torch.float64)
15 gae_duplicate tensor(0.0340, dtype=torch.float64) tensor(-5.6496, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3012, dtype=torch.float64) delta_t tensor(0.1316, dtype=torch.float64)
14 gae_duplicate tensor(-0.0564, dtype=torch.float64) tensor(-3.0372, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5273, dtype=torch.float64) delta_t tensor(0.5054, dtype=torch.float64)
13 gae_duplicate tensor(-0.0103, dtype=torch.float64) tensor(-10.0145, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2282, dtype=torch.float64) delta_t tensor(-0.0155, dtype=torch.float64)
12 gae_duplicate tensor(-0.2303, dtype=torch.float64) tensor(-0.7365, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5642, dtype=torch.float64) delta_t tensor(0.4564, dtype=torch.float64)
11 gae_duplicate tensor(0.2724, dtype=torch.float64) tensor(-9.2177, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2436, dtype=torch.float64) delta_t tensor(-0.0146, dtype=torch.float64)
10 gae_duplicate tensor(-0.2264, dtype=torch.float64) tensor(-0.6331, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5650, dtype=torch.float64) delta_t tensor(0.2739, dtype=torch.float64)
9 gae_duplicate tensor(0.2219, dtype=torch.float64) tensor(-5.5040, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2018, dtype=torch.float64) delta_t tensor(-0.1263, dtype=torch.float64)
8 gae_duplicate tensor(-0.4215, dtype=torch.float64) tensor(1.9142, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5225, dtype=torch.float64) delta_t tensor(0.2168, dtype=torch.float64)
7 gae_duplicate tensor(0.1637, dtype=torch.float64) tensor(-4.0603, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1599, dtype=torch.float64) delta_t tensor(-0.0511, dtype=torch.float64)
6 gae_duplicate tensor(-0.2454, dtype=torch.float64) tensor(0.5770, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3509, dtype=torch.float64) delta_t tensor(-0.6218, dtype=torch.float64)
5 gae_duplicate tensor(-0.8324, dtype=torch.float64) tensor(12.7508, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8123, dtype=torch.float64) delta_t tensor(-2.0477, dtype=torch.float64)
4 gae_duplicate tensor(-5.7226, dtype=torch.float64) tensor(41.0036, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0660, dtype=torch.float64) delta_t tensor(0.1815, dtype=torch.float64)
3 gae_duplicate tensor(-0.4195, dtype=torch.float64) tensor(0.5610, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2460, dtype=torch.float64) delta_t tensor(0.4308, dtype=torch.float64)
2 gae_duplicate tensor(-0.2573, dtype=torch.float64) tensor(-8.6483, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-244.29664611816406
value loss:97.97486114501953
entropies:354.56817626953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.328434944152832 seconds
19 rew tensor(0.5418, dtype=torch.float64) delta_t tensor(0.1186, dtype=torch.float64)
19 gae_duplicate tensor(-0.3188, dtype=torch.float64) tensor(-2.3496, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4813, dtype=torch.float64) delta_t tensor(0.1620, dtype=torch.float64)
18 gae_duplicate tensor(-0.1300, dtype=torch.float64) tensor(-3.3141, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5145, dtype=torch.float64) delta_t tensor(0.3451, dtype=torch.float64)
17 gae_duplicate tensor(-0.2927, dtype=torch.float64) tensor(-7.0940, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4192, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
16 gae_duplicate tensor(-0.0990, dtype=torch.float64) tensor(-1.2682, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4758, dtype=torch.float64) delta_t tensor(0.5253, dtype=torch.float64)
15 gae_duplicate tensor(0.1669, dtype=torch.float64) tensor(-10.6054, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2024, dtype=torch.float64) delta_t tensor(0.0510, dtype=torch.float64)
14 gae_duplicate tensor(-0.0527, dtype=torch.float64) tensor(-2.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5524, dtype=torch.float64) delta_t tensor(0.7702, dtype=torch.float64)
13 gae_duplicate tensor(0.3598, dtype=torch.float64) tensor(-15.3985, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1033, dtype=torch.float64) delta_t tensor(-0.2754, dtype=torch.float64)
12 gae_duplicate tensor(-0.6208, dtype=torch.float64) tensor(3.8505, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5602, dtype=torch.float64) delta_t tensor(0.6320, dtype=torch.float64)
11 gae_duplicate tensor(0.2650, dtype=torch.float64) tensor(-12.2172, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1045, dtype=torch.float64) delta_t tensor(-0.2698, dtype=torch.float64)
10 gae_duplicate tensor(-1.0124, dtype=torch.float64) tensor(4.0260, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5316, dtype=torch.float64) delta_t tensor(0.3265, dtype=torch.float64)
9 gae_duplicate tensor(0.0654, dtype=torch.float64) tensor(-5.9512, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0340, dtype=torch.float64) delta_t tensor(-0.0392, dtype=torch.float64)
8 gae_duplicate tensor(-0.3013, dtype=torch.float64) tensor(0.0244, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4733, dtype=torch.float64) delta_t tensor(0.2001, dtype=torch.float64)
7 gae_duplicate tensor(0.1039, dtype=torch.float64) tensor(-3.7521, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0814, dtype=torch.float64) delta_t tensor(-0.1439, dtype=torch.float64)
6 gae_duplicate tensor(-0.3522, dtype=torch.float64) tensor(2.5748, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0132, dtype=torch.float64) delta_t tensor(-0.3354, dtype=torch.float64)
5 gae_duplicate tensor(-1.1177, dtype=torch.float64) tensor(6.5839, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.1602, dtype=torch.float64) delta_t tensor(-3.4682, dtype=torch.float64)
4 gae_duplicate tensor(-7.1438, dtype=torch.float64) tensor(67.3368, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0700, dtype=torch.float64) delta_t tensor(0.4898, dtype=torch.float64)
3 gae_duplicate tensor(-0.4649, dtype=torch.float64) tensor(-2.6671, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1757, dtype=torch.float64) delta_t tensor(0.4218, dtype=torch.float64)
2 gae_duplicate tensor(-0.1999, dtype=torch.float64) tensor(-8.3904, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-595.8184204101562
value loss:202.1613311767578
entropies:354.3816223144531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.218569993972778 seconds
19 rew tensor(0.5703, dtype=torch.float64) delta_t tensor(0.1735, dtype=torch.float64)
19 gae_duplicate tensor(-0.0509, dtype=torch.float64) tensor(-3.4414, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4535, dtype=torch.float64) delta_t tensor(-0.0590, dtype=torch.float64)
18 gae_duplicate tensor(-0.5988, dtype=torch.float64) tensor(0.6570, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4980, dtype=torch.float64) delta_t tensor(0.2529, dtype=torch.float64)
17 gae_duplicate tensor(0.0358, dtype=torch.float64) tensor(-4.8859, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4104, dtype=torch.float64) delta_t tensor(0.2117, dtype=torch.float64)
16 gae_duplicate tensor(-0.1596, dtype=torch.float64) tensor(-4.8809, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4788, dtype=torch.float64) delta_t tensor(0.1575, dtype=torch.float64)
15 gae_duplicate tensor(-0.1219, dtype=torch.float64) tensor(-3.3950, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3172, dtype=torch.float64) delta_t tensor(0.1104, dtype=torch.float64)
14 gae_duplicate tensor(-0.1809, dtype=torch.float64) tensor(-2.4423, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5291, dtype=torch.float64) delta_t tensor(0.5910, dtype=torch.float64)
13 gae_duplicate tensor(0.1608, dtype=torch.float64) tensor(-11.8597, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2449, dtype=torch.float64) delta_t tensor(0.0040, dtype=torch.float64)
12 gae_duplicate tensor(-0.1370, dtype=torch.float64) tensor(-1.1684, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5448, dtype=torch.float64) delta_t tensor(0.6419, dtype=torch.float64)
11 gae_duplicate tensor(0.2689, dtype=torch.float64) tensor(-12.2867, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2384, dtype=torch.float64) delta_t tensor(-0.1023, dtype=torch.float64)
10 gae_duplicate tensor(-0.6913, dtype=torch.float64) tensor(0.7823, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4941, dtype=torch.float64) delta_t tensor(0.3302, dtype=torch.float64)
9 gae_duplicate tensor(0.1456, dtype=torch.float64) tensor(-6.3813, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1394, dtype=torch.float64) delta_t tensor(0.0371, dtype=torch.float64)
8 gae_duplicate tensor(-0.3222, dtype=torch.float64) tensor(-1.3823, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4963, dtype=torch.float64) delta_t tensor(0.2032, dtype=torch.float64)
7 gae_duplicate tensor(0.0893, dtype=torch.float64) tensor(-4.1848, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0259, dtype=torch.float64) delta_t tensor(-0.0718, dtype=torch.float64)
6 gae_duplicate tensor(-0.2443, dtype=torch.float64) tensor(1.0100, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2855, dtype=torch.float64) delta_t tensor(-0.4559, dtype=torch.float64)
5 gae_duplicate tensor(-1.5847, dtype=torch.float64) tensor(8.9151, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.0870, dtype=torch.float64) delta_t tensor(-4.1889, dtype=torch.float64)
4 gae_duplicate tensor(-7.0525, dtype=torch.float64) tensor(83.3645, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0799, dtype=torch.float64) delta_t tensor(0.3903, dtype=torch.float64)
3 gae_duplicate tensor(-0.5010, dtype=torch.float64) tensor(0.9635, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0873, dtype=torch.float64) delta_t tensor(0.6918, dtype=torch.float64)
2 gae_duplicate tensor(0.2414, dtype=torch.float64) tensor(-13.6041, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1487.77587890625
value loss:257.8742370605469
entropies:354.3453063964844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3960.6377)
ToM Target loss= tensor(3521.9734)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.11480712890625 seconds
19 rew tensor(0.5122, dtype=torch.float64) delta_t tensor(0.0483, dtype=torch.float64)
19 gae_duplicate tensor(-0.4801, dtype=torch.float64) tensor(-1.0550, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3809, dtype=torch.float64) delta_t tensor(-0.0637, dtype=torch.float64)
18 gae_duplicate tensor(-0.3411, dtype=torch.float64) tensor(1.1374, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4869, dtype=torch.float64) delta_t tensor(0.1063, dtype=torch.float64)
17 gae_duplicate tensor(-0.2885, dtype=torch.float64) tensor(-2.0672, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3327, dtype=torch.float64) delta_t tensor(0.0191, dtype=torch.float64)
16 gae_duplicate tensor(-0.1731, dtype=torch.float64) tensor(-0.5176, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5096, dtype=torch.float64) delta_t tensor(0.5037, dtype=torch.float64)
15 gae_duplicate tensor(0.3419, dtype=torch.float64) tensor(-10.0479, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2080, dtype=torch.float64) delta_t tensor(-0.0931, dtype=torch.float64)
14 gae_duplicate tensor(-0.2145, dtype=torch.float64) tensor(0.9118, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5443, dtype=torch.float64) delta_t tensor(0.4479, dtype=torch.float64)
13 gae_duplicate tensor(0.1010, dtype=torch.float64) tensor(-8.6595, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1809, dtype=torch.float64) delta_t tensor(-0.1111, dtype=torch.float64)
12 gae_duplicate tensor(-0.3928, dtype=torch.float64) tensor(1.4049, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5522, dtype=torch.float64) delta_t tensor(0.4505, dtype=torch.float64)
11 gae_duplicate tensor(0.2514, dtype=torch.float64) tensor(-8.7532, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1894, dtype=torch.float64) delta_t tensor(-0.1688, dtype=torch.float64)
10 gae_duplicate tensor(-0.7959, dtype=torch.float64) tensor(2.7279, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5127, dtype=torch.float64) delta_t tensor(0.2606, dtype=torch.float64)
9 gae_duplicate tensor(0.0668, dtype=torch.float64) tensor(-4.7588, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1085, dtype=torch.float64) delta_t tensor(-0.1889, dtype=torch.float64)
8 gae_duplicate tensor(-0.3672, dtype=torch.float64) tensor(3.3105, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5111, dtype=torch.float64) delta_t tensor(0.2208, dtype=torch.float64)
7 gae_duplicate tensor(0.1282, dtype=torch.float64) tensor(-3.8825, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0277, dtype=torch.float64) delta_t tensor(-0.1352, dtype=torch.float64)
6 gae_duplicate tensor(-0.2802, dtype=torch.float64) tensor(2.3407, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2734, dtype=torch.float64) delta_t tensor(-0.4766, dtype=torch.float64)
5 gae_duplicate tensor(-0.7606, dtype=torch.float64) tensor(9.7110, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3589, dtype=torch.float64) delta_t tensor(-2.4430, dtype=torch.float64)
4 gae_duplicate tensor(-4.0403, dtype=torch.float64) tensor(49.8183, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0502, dtype=torch.float64) delta_t tensor(0.5018, dtype=torch.float64)
3 gae_duplicate tensor(-0.1612, dtype=torch.float64) tensor(-4.9006, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1457, dtype=torch.float64) delta_t tensor(0.5940, dtype=torch.float64)
2 gae_duplicate tensor(0.1105, dtype=torch.float64) tensor(-12.5393, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-861.404052734375
value loss:99.15052795410156
entropies:354.1679382324219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.474045991897583 seconds
19 rew tensor(0.4891, dtype=torch.float64) delta_t tensor(0.2366, dtype=torch.float64)
19 gae_duplicate tensor(0.0116, dtype=torch.float64) tensor(-4.6471, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3316, dtype=torch.float64) delta_t tensor(-0.2461, dtype=torch.float64)
18 gae_duplicate tensor(-0.6599, dtype=torch.float64) tensor(4.3813, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5051, dtype=torch.float64) delta_t tensor(0.2499, dtype=torch.float64)
17 gae_duplicate tensor(0.1717, dtype=torch.float64) tensor(-4.3780, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2766, dtype=torch.float64) delta_t tensor(0.0186, dtype=torch.float64)
16 gae_duplicate tensor(-0.3679, dtype=torch.float64) tensor(-1.0876, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5394, dtype=torch.float64) delta_t tensor(0.2036, dtype=torch.float64)
15 gae_duplicate tensor(-0.2030, dtype=torch.float64) tensor(-4.1411, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2308, dtype=torch.float64) delta_t tensor(-0.2127, dtype=torch.float64)
14 gae_duplicate tensor(-0.8514, dtype=torch.float64) tensor(3.9309, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5181, dtype=torch.float64) delta_t tensor(0.2893, dtype=torch.float64)
13 gae_duplicate tensor(-0.1563, dtype=torch.float64) tensor(-5.4937, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1899, dtype=torch.float64) delta_t tensor(0.0041, dtype=torch.float64)
12 gae_duplicate tensor(-0.1869, dtype=torch.float64) tensor(-0.5767, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5473, dtype=torch.float64) delta_t tensor(0.4082, dtype=torch.float64)
11 gae_duplicate tensor(0.2681, dtype=torch.float64) tensor(-8.3254, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2066, dtype=torch.float64) delta_t tensor(-0.0581, dtype=torch.float64)
10 gae_duplicate tensor(-0.2012, dtype=torch.float64) tensor(0.2875, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5545, dtype=torch.float64) delta_t tensor(0.2635, dtype=torch.float64)
9 gae_duplicate tensor(0.1715, dtype=torch.float64) tensor(-5.2550, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1656, dtype=torch.float64) delta_t tensor(-0.1610, dtype=torch.float64)
8 gae_duplicate tensor(-0.3542, dtype=torch.float64) tensor(2.5935, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5129, dtype=torch.float64) delta_t tensor(0.2322, dtype=torch.float64)
7 gae_duplicate tensor(0.1266, dtype=torch.float64) tensor(-4.4792, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1246, dtype=torch.float64) delta_t tensor(-0.0862, dtype=torch.float64)
6 gae_duplicate tensor(-0.2399, dtype=torch.float64) tensor(1.2398, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3482, dtype=torch.float64) delta_t tensor(-0.3142, dtype=torch.float64)
5 gae_duplicate tensor(-0.5923, dtype=torch.float64) tensor(6.3409, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7864, dtype=torch.float64) delta_t tensor(-1.6679, dtype=torch.float64)
4 gae_duplicate tensor(-4.2060, dtype=torch.float64) tensor(33.9773, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1284, dtype=torch.float64) delta_t tensor(0.1251, dtype=torch.float64)
3 gae_duplicate tensor(-0.9236, dtype=torch.float64) tensor(0.7697, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2690, dtype=torch.float64) delta_t tensor(0.6012, dtype=torch.float64)
2 gae_duplicate tensor(0.0308, dtype=torch.float64) tensor(-11.5358, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-290.00567626953125
value loss:72.77305603027344
entropies:353.824462890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.832279205322266 seconds
19 rew tensor(0.5501, dtype=torch.float64) delta_t tensor(0.1320, dtype=torch.float64)
19 gae_duplicate tensor(-0.5104, dtype=torch.float64) tensor(-2.7995, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4452, dtype=torch.float64) delta_t tensor(0.2224, dtype=torch.float64)
18 gae_duplicate tensor(-0.1140, dtype=torch.float64) tensor(-4.7454, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4990, dtype=torch.float64) delta_t tensor(0.2777, dtype=torch.float64)
17 gae_duplicate tensor(0.0726, dtype=torch.float64) tensor(-6.1839, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3993, dtype=torch.float64) delta_t tensor(-0.1525, dtype=torch.float64)
16 gae_duplicate tensor(-0.6772, dtype=torch.float64) tensor(2.3059, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4668, dtype=torch.float64) delta_t tensor(0.2651, dtype=torch.float64)
15 gae_duplicate tensor(0.0210, dtype=torch.float64) tensor(-5.1935, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2217, dtype=torch.float64) delta_t tensor(0.0227, dtype=torch.float64)
14 gae_duplicate tensor(-0.2357, dtype=torch.float64) tensor(-1.1069, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5316, dtype=torch.float64) delta_t tensor(0.6266, dtype=torch.float64)
13 gae_duplicate tensor(0.2396, dtype=torch.float64) tensor(-11.7793, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1108, dtype=torch.float64) delta_t tensor(-0.2476, dtype=torch.float64)
12 gae_duplicate tensor(-0.8931, dtype=torch.float64) tensor(3.8907, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5527, dtype=torch.float64) delta_t tensor(0.6082, dtype=torch.float64)
11 gae_duplicate tensor(0.2228, dtype=torch.float64) tensor(-11.5815, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1189, dtype=torch.float64) delta_t tensor(-0.3796, dtype=torch.float64)
10 gae_duplicate tensor(-1.0365, dtype=torch.float64) tensor(6.0640, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5087, dtype=torch.float64) delta_t tensor(0.2446, dtype=torch.float64)
9 gae_duplicate tensor(0.0870, dtype=torch.float64) tensor(-4.3035, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0337, dtype=torch.float64) delta_t tensor(-0.1239, dtype=torch.float64)
8 gae_duplicate tensor(-0.5422, dtype=torch.float64) tensor(1.7072, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4850, dtype=torch.float64) delta_t tensor(0.2368, dtype=torch.float64)
7 gae_duplicate tensor(0.1268, dtype=torch.float64) tensor(-4.4745, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0779, dtype=torch.float64) delta_t tensor(-0.1155, dtype=torch.float64)
6 gae_duplicate tensor(-0.3003, dtype=torch.float64) tensor(1.8540, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1296, dtype=torch.float64) delta_t tensor(-0.2020, dtype=torch.float64)
5 gae_duplicate tensor(-0.8173, dtype=torch.float64) tensor(4.3126, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.1193, dtype=torch.float64) delta_t tensor(-3.1220, dtype=torch.float64)
4 gae_duplicate tensor(-5.9461, dtype=torch.float64) tensor(62.5021, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0484, dtype=torch.float64) delta_t tensor(0.5577, dtype=torch.float64)
3 gae_duplicate tensor(0.0049, dtype=torch.float64) tensor(-4.7006, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1089, dtype=torch.float64) delta_t tensor(0.6806, dtype=torch.float64)
2 gae_duplicate tensor(0.2810, dtype=torch.float64) tensor(-13.5835, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-753.4154052734375
value loss:162.5137481689453
entropies:353.5625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 6.001335144042969 seconds
19 rew tensor(0.5010, dtype=torch.float64) delta_t tensor(0.2060, dtype=torch.float64)
19 gae_duplicate tensor(0.0368, dtype=torch.float64) tensor(-4.1945, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3192, dtype=torch.float64) delta_t tensor(-0.0187, dtype=torch.float64)
18 gae_duplicate tensor(-0.1121, dtype=torch.float64) tensor(-0.1520, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5314, dtype=torch.float64) delta_t tensor(0.0545, dtype=torch.float64)
17 gae_duplicate tensor(-0.4714, dtype=torch.float64) tensor(-1.1637, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2906, dtype=torch.float64) delta_t tensor(-0.2163, dtype=torch.float64)
16 gae_duplicate tensor(-0.6096, dtype=torch.float64) tensor(4.0394, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5035, dtype=torch.float64) delta_t tensor(0.4107, dtype=torch.float64)
15 gae_duplicate tensor(0.2169, dtype=torch.float64) tensor(-7.6257, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2225, dtype=torch.float64) delta_t tensor(-0.2137, dtype=torch.float64)
14 gae_duplicate tensor(-0.3782, dtype=torch.float64) tensor(3.2966, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5385, dtype=torch.float64) delta_t tensor(0.2221, dtype=torch.float64)
13 gae_duplicate tensor(-0.2819, dtype=torch.float64) tensor(-3.8449, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1672, dtype=torch.float64) delta_t tensor(0.0252, dtype=torch.float64)
12 gae_duplicate tensor(-0.0768, dtype=torch.float64) tensor(-0.9249, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5463, dtype=torch.float64) delta_t tensor(0.3674, dtype=torch.float64)
11 gae_duplicate tensor(0.3240, dtype=torch.float64) tensor(-7.3287, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1896, dtype=torch.float64) delta_t tensor(-0.0320, dtype=torch.float64)
10 gae_duplicate tensor(-0.1232, dtype=torch.float64) tensor(-0.0018, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5535, dtype=torch.float64) delta_t tensor(0.3224, dtype=torch.float64)
9 gae_duplicate tensor(0.2525, dtype=torch.float64) tensor(-6.6798, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1489, dtype=torch.float64) delta_t tensor(-0.1266, dtype=torch.float64)
8 gae_duplicate tensor(-0.2479, dtype=torch.float64) tensor(1.7916, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5123, dtype=torch.float64) delta_t tensor(0.2490, dtype=torch.float64)
7 gae_duplicate tensor(0.1479, dtype=torch.float64) tensor(-4.8291, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1082, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
6 gae_duplicate tensor(-0.0858, dtype=torch.float64) tensor(-0.0397, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8424, dtype=torch.float64) delta_t tensor(-0.7546, dtype=torch.float64)
5 gae_duplicate tensor(-1.7645, dtype=torch.float64) tensor(15.6747, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0591, dtype=torch.float64) delta_t tensor(-2.7735, dtype=torch.float64)
4 gae_duplicate tensor(-4.5724, dtype=torch.float64) tensor(54.3116, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1419, dtype=torch.float64) delta_t tensor(0.3919, dtype=torch.float64)
3 gae_duplicate tensor(-0.0914, dtype=torch.float64) tensor(-2.1030, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2095, dtype=torch.float64) delta_t tensor(0.5075, dtype=torch.float64)
2 gae_duplicate tensor(0.2811, dtype=torch.float64) tensor(-10.2220, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1715.576416015625
value loss:102.7117691040039
entropies:353.1681213378906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1022210121154785 seconds
19 rew tensor(0.4729, dtype=torch.float64) delta_t tensor(0.2305, dtype=torch.float64)
19 gae_duplicate tensor(-0.0422, dtype=torch.float64) tensor(-4.5671, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4351, dtype=torch.float64) delta_t tensor(-0.0043, dtype=torch.float64)
18 gae_duplicate tensor(-0.2988, dtype=torch.float64) tensor(-0.4517, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4938, dtype=torch.float64) delta_t tensor(0.1697, dtype=torch.float64)
17 gae_duplicate tensor(-0.3134, dtype=torch.float64) tensor(-3.0576, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3219, dtype=torch.float64) delta_t tensor(-0.1462, dtype=torch.float64)
16 gae_duplicate tensor(-0.7107, dtype=torch.float64) tensor(2.7635, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4528, dtype=torch.float64) delta_t tensor(0.3196, dtype=torch.float64)
15 gae_duplicate tensor(0.1107, dtype=torch.float64) tensor(-6.0495, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1953, dtype=torch.float64) delta_t tensor(0.0123, dtype=torch.float64)
14 gae_duplicate tensor(-0.3006, dtype=torch.float64) tensor(-0.8645, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5385, dtype=torch.float64) delta_t tensor(0.4803, dtype=torch.float64)
13 gae_duplicate tensor(-0.0512, dtype=torch.float64) tensor(-9.6864, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1112, dtype=torch.float64) delta_t tensor(-0.1913, dtype=torch.float64)
12 gae_duplicate tensor(-0.8139, dtype=torch.float64) tensor(3.1050, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5460, dtype=torch.float64) delta_t tensor(0.5930, dtype=torch.float64)
11 gae_duplicate tensor(0.2973, dtype=torch.float64) tensor(-11.6469, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1189, dtype=torch.float64) delta_t tensor(-0.2207, dtype=torch.float64)
10 gae_duplicate tensor(-0.6890, dtype=torch.float64) tensor(3.1760, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5531, dtype=torch.float64) delta_t tensor(0.2903, dtype=torch.float64)
9 gae_duplicate tensor(0.1975, dtype=torch.float64) tensor(-5.4882, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0783, dtype=torch.float64) delta_t tensor(-0.0644, dtype=torch.float64)
8 gae_duplicate tensor(-0.3490, dtype=torch.float64) tensor(0.6382, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4694, dtype=torch.float64) delta_t tensor(0.2595, dtype=torch.float64)
7 gae_duplicate tensor(0.1787, dtype=torch.float64) tensor(-4.7629, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0048, dtype=torch.float64) delta_t tensor(-0.0359, dtype=torch.float64)
6 gae_duplicate tensor(-0.2106, dtype=torch.float64) tensor(0.1894, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0254, dtype=torch.float64) delta_t tensor(0.0337, dtype=torch.float64)
5 gae_duplicate tensor(-0.4003, dtype=torch.float64) tensor(-0.5822, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.7267, dtype=torch.float64) delta_t tensor(-2.4846, dtype=torch.float64)
4 gae_duplicate tensor(-7.1482, dtype=torch.float64) tensor(49.1146, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0941, dtype=torch.float64) delta_t tensor(0.3816, dtype=torch.float64)
3 gae_duplicate tensor(-0.5063, dtype=torch.float64) tensor(-2.9775, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2032, dtype=torch.float64) delta_t tensor(0.6380, dtype=torch.float64)
2 gae_duplicate tensor(0.4695, dtype=torch.float64) tensor(-12.8848, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:122.44374084472656
value loss:123.034423828125
entropies:353.00714111328125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3962.4221)
ToM Target loss= tensor(3522.9292)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.566664934158325 seconds
19 rew tensor(0.5273, dtype=torch.float64) delta_t tensor(0.2486, dtype=torch.float64)
19 gae_duplicate tensor(0.1023, dtype=torch.float64) tensor(-4.9966, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4803, dtype=torch.float64) delta_t tensor(-0.2456, dtype=torch.float64)
18 gae_duplicate tensor(-0.7790, dtype=torch.float64) tensor(4.3145, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4411, dtype=torch.float64) delta_t tensor(0.2557, dtype=torch.float64)
17 gae_duplicate tensor(0.1583, dtype=torch.float64) tensor(-4.5829, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3574, dtype=torch.float64) delta_t tensor(0.2624, dtype=torch.float64)
16 gae_duplicate tensor(-0.0282, dtype=torch.float64) tensor(-5.5560, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5234, dtype=torch.float64) delta_t tensor(-0.1428, dtype=torch.float64)
15 gae_duplicate tensor(-0.3206, dtype=torch.float64) tensor(2.0076, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2557, dtype=torch.float64) delta_t tensor(0.1183, dtype=torch.float64)
14 gae_duplicate tensor(-0.0529, dtype=torch.float64) tensor(-2.1328, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5445, dtype=torch.float64) delta_t tensor(0.2923, dtype=torch.float64)
13 gae_duplicate tensor(0.1475, dtype=torch.float64) tensor(-5.9107, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2572, dtype=torch.float64) delta_t tensor(0.0459, dtype=torch.float64)
12 gae_duplicate tensor(-0.1809, dtype=torch.float64) tensor(-1.7514, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5456, dtype=torch.float64) delta_t tensor(0.3214, dtype=torch.float64)
11 gae_duplicate tensor(0.2789, dtype=torch.float64) tensor(-6.4004, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2648, dtype=torch.float64) delta_t tensor(0.0065, dtype=torch.float64)
10 gae_duplicate tensor(-0.1993, dtype=torch.float64) tensor(-0.6934, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5529, dtype=torch.float64) delta_t tensor(0.2231, dtype=torch.float64)
9 gae_duplicate tensor(0.1700, dtype=torch.float64) tensor(-4.2837, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2244, dtype=torch.float64) delta_t tensor(-0.0917, dtype=torch.float64)
8 gae_duplicate tensor(-0.3422, dtype=torch.float64) tensor(1.4673, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5120, dtype=torch.float64) delta_t tensor(0.1984, dtype=torch.float64)
7 gae_duplicate tensor(0.1609, dtype=torch.float64) tensor(-3.8701, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1839, dtype=torch.float64) delta_t tensor(-0.0601, dtype=torch.float64)
6 gae_duplicate tensor(-0.1699, dtype=torch.float64) tensor(0.8844, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4274, dtype=torch.float64) delta_t tensor(-0.1405, dtype=torch.float64)
5 gae_duplicate tensor(-0.9307, dtype=torch.float64) tensor(3.1430, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.1336, dtype=torch.float64) delta_t tensor(-2.6736, dtype=torch.float64)
4 gae_duplicate tensor(-5.2486, dtype=torch.float64) tensor(54.2478, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1540, dtype=torch.float64) delta_t tensor(0.3720, dtype=torch.float64)
3 gae_duplicate tensor(-0.2273, dtype=torch.float64) tensor(-2.2491, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2009, dtype=torch.float64) delta_t tensor(0.6167, dtype=torch.float64)
2 gae_duplicate tensor(0.4962, dtype=torch.float64) tensor(-12.1097, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-717.747314453125
value loss:101.94330596923828
entropies:352.77581787109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.875967979431152 seconds
19 rew tensor(0.5434, dtype=torch.float64) delta_t tensor(0.2574, dtype=torch.float64)
19 gae_duplicate tensor(0.1538, dtype=torch.float64) tensor(-5.1728, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3545, dtype=torch.float64) delta_t tensor(-0.1197, dtype=torch.float64)
18 gae_duplicate tensor(-0.4760, dtype=torch.float64) tensor(1.9005, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5433, dtype=torch.float64) delta_t tensor(0.2478, dtype=torch.float64)
17 gae_duplicate tensor(0.0813, dtype=torch.float64) tensor(-4.8623, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3283, dtype=torch.float64) delta_t tensor(-0.0980, dtype=torch.float64)
16 gae_duplicate tensor(-0.2018, dtype=torch.float64) tensor(1.4576, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5166, dtype=torch.float64) delta_t tensor(-0.0909, dtype=torch.float64)
15 gae_duplicate tensor(-0.3695, dtype=torch.float64) tensor(2.1272, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2183, dtype=torch.float64) delta_t tensor(0.0364, dtype=torch.float64)
14 gae_duplicate tensor(-0.2126, dtype=torch.float64) tensor(-0.5322, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5376, dtype=torch.float64) delta_t tensor(0.2750, dtype=torch.float64)
13 gae_duplicate tensor(-0.2444, dtype=torch.float64) tensor(-5.4033, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2271, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
12 gae_duplicate tensor(-0.1946, dtype=torch.float64) tensor(-0.9921, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5519, dtype=torch.float64) delta_t tensor(0.3087, dtype=torch.float64)
11 gae_duplicate tensor(0.2693, dtype=torch.float64) tensor(-6.4129, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2349, dtype=torch.float64) delta_t tensor(-0.0134, dtype=torch.float64)
10 gae_duplicate tensor(-0.1842, dtype=torch.float64) tensor(-0.3846, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5385, dtype=torch.float64) delta_t tensor(0.2296, dtype=torch.float64)
9 gae_duplicate tensor(0.1220, dtype=torch.float64) tensor(-4.7607, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1804, dtype=torch.float64) delta_t tensor(-0.1398, dtype=torch.float64)
8 gae_duplicate tensor(-0.4882, dtype=torch.float64) tensor(2.3004, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5114, dtype=torch.float64) delta_t tensor(0.2325, dtype=torch.float64)
7 gae_duplicate tensor(0.1768, dtype=torch.float64) tensor(-4.3372, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1259, dtype=torch.float64) delta_t tensor(-0.0994, dtype=torch.float64)
6 gae_duplicate tensor(-0.2436, dtype=torch.float64) tensor(1.5248, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1361, dtype=torch.float64) delta_t tensor(-0.1396, dtype=torch.float64)
5 gae_duplicate tensor(-0.7535, dtype=torch.float64) tensor(2.4675, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3350, dtype=torch.float64) delta_t tensor(-1.9569, dtype=torch.float64)
4 gae_duplicate tensor(-4.7555, dtype=torch.float64) tensor(38.5010, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0046, dtype=torch.float64) delta_t tensor(0.4535, dtype=torch.float64)
3 gae_duplicate tensor(0.0201, dtype=torch.float64) tensor(-5.2570, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2276, dtype=torch.float64) delta_t tensor(0.5239, dtype=torch.float64)
2 gae_duplicate tensor(0.3305, dtype=torch.float64) tensor(-10.7454, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-171.73472595214844
value loss:79.1082992553711
entropies:352.333984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.097633123397827 seconds
19 rew tensor(0.5546, dtype=torch.float64) delta_t tensor(0.2874, dtype=torch.float64)
19 gae_duplicate tensor(0.1781, dtype=torch.float64) tensor(-5.6276, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4065, dtype=torch.float64) delta_t tensor(0.1476, dtype=torch.float64)
18 gae_duplicate tensor(-0.1751, dtype=torch.float64) tensor(-3.4372, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5150, dtype=torch.float64) delta_t tensor(0.2569, dtype=torch.float64)
17 gae_duplicate tensor(0.2096, dtype=torch.float64) tensor(-5.4209, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3653, dtype=torch.float64) delta_t tensor(-0.2858, dtype=torch.float64)
16 gae_duplicate tensor(-0.9017, dtype=torch.float64) tensor(5.5863, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5201, dtype=torch.float64) delta_t tensor(0.2705, dtype=torch.float64)
15 gae_duplicate tensor(0.1733, dtype=torch.float64) tensor(-4.5948, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1759, dtype=torch.float64) delta_t tensor(-0.3011, dtype=torch.float64)
14 gae_duplicate tensor(-0.5606, dtype=torch.float64) tensor(5.3764, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5096, dtype=torch.float64) delta_t tensor(0.0817, dtype=torch.float64)
13 gae_duplicate tensor(-0.4422, dtype=torch.float64) tensor(-0.8039, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1197, dtype=torch.float64) delta_t tensor(0.0404, dtype=torch.float64)
12 gae_duplicate tensor(-0.0623, dtype=torch.float64) tensor(-0.9016, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5440, dtype=torch.float64) delta_t tensor(0.3108, dtype=torch.float64)
11 gae_duplicate tensor(-0.1974, dtype=torch.float64) tensor(-5.6203, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1203, dtype=torch.float64) delta_t tensor(-0.2554, dtype=torch.float64)
10 gae_duplicate tensor(-1.0733, dtype=torch.float64) tensor(4.6252, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5108, dtype=torch.float64) delta_t tensor(0.3830, dtype=torch.float64)
9 gae_duplicate tensor(0.2391, dtype=torch.float64) tensor(-6.9771, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0467, dtype=torch.float64) delta_t tensor(-0.1281, dtype=torch.float64)
8 gae_duplicate tensor(-0.4455, dtype=torch.float64) tensor(1.4801, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4966, dtype=torch.float64) delta_t tensor(0.4169, dtype=torch.float64)
7 gae_duplicate tensor(0.2791, dtype=torch.float64) tensor(-8.2515, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0472, dtype=torch.float64) delta_t tensor(0.0407, dtype=torch.float64)
6 gae_duplicate tensor(-0.2169, dtype=torch.float64) tensor(-1.7205, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8045, dtype=torch.float64) delta_t tensor(-0.6200, dtype=torch.float64)
5 gae_duplicate tensor(-2.4631, dtype=torch.float64) tensor(11.0183, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.7158, dtype=torch.float64) delta_t tensor(-2.5997, dtype=torch.float64)
4 gae_duplicate tensor(-6.9201, dtype=torch.float64) tensor(52.4420, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0322, dtype=torch.float64) delta_t tensor(0.6057, dtype=torch.float64)
3 gae_duplicate tensor(-0.0858, dtype=torch.float64) tensor(-6.1963, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1179, dtype=torch.float64) delta_t tensor(0.6350, dtype=torch.float64)
2 gae_duplicate tensor(0.1753, dtype=torch.float64) tensor(-13.4226, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1043.005615234375
value loss:152.32261657714844
entropies:352.1589660644531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.488429069519043 seconds
19 rew tensor(0.4812, dtype=torch.float64) delta_t tensor(0.0083, dtype=torch.float64)
19 gae_duplicate tensor(-0.7690, dtype=torch.float64) tensor(-0.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3983, dtype=torch.float64) delta_t tensor(0.0717, dtype=torch.float64)
18 gae_duplicate tensor(-0.2371, dtype=torch.float64) tensor(-1.5402, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4682, dtype=torch.float64) delta_t tensor(0.1244, dtype=torch.float64)
17 gae_duplicate tensor(-0.2520, dtype=torch.float64) tensor(-2.3314, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3322, dtype=torch.float64) delta_t tensor(-0.1341, dtype=torch.float64)
16 gae_duplicate tensor(-0.6468, dtype=torch.float64) tensor(2.2679, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4884, dtype=torch.float64) delta_t tensor(-0.0710, dtype=torch.float64)
15 gae_duplicate tensor(-0.5115, dtype=torch.float64) tensor(1.7450, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2241, dtype=torch.float64) delta_t tensor(-0.1501, dtype=torch.float64)
14 gae_duplicate tensor(-0.5073, dtype=torch.float64) tensor(2.9533, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5291, dtype=torch.float64) delta_t tensor(-0.0391, dtype=torch.float64)
13 gae_duplicate tensor(-0.4621, dtype=torch.float64) tensor(1.2443, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1829, dtype=torch.float64) delta_t tensor(0.0348, dtype=torch.float64)
12 gae_duplicate tensor(-0.1156, dtype=torch.float64) tensor(-0.7645, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5508, dtype=torch.float64) delta_t tensor(0.3234, dtype=torch.float64)
11 gae_duplicate tensor(0.2460, dtype=torch.float64) tensor(-6.5505, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1914, dtype=torch.float64) delta_t tensor(-0.0569, dtype=torch.float64)
10 gae_duplicate tensor(-0.1436, dtype=torch.float64) tensor(0.5254, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5512, dtype=torch.float64) delta_t tensor(0.2650, dtype=torch.float64)
9 gae_duplicate tensor(0.1524, dtype=torch.float64) tensor(-4.8495, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1510, dtype=torch.float64) delta_t tensor(-0.1447, dtype=torch.float64)
8 gae_duplicate tensor(-0.2551, dtype=torch.float64) tensor(2.3043, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5103, dtype=torch.float64) delta_t tensor(0.2584, dtype=torch.float64)
7 gae_duplicate tensor(0.1435, dtype=torch.float64) tensor(-4.8956, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1106, dtype=torch.float64) delta_t tensor(-0.0924, dtype=torch.float64)
6 gae_duplicate tensor(-0.3051, dtype=torch.float64) tensor(1.1972, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8071, dtype=torch.float64) delta_t tensor(-0.6277, dtype=torch.float64)
5 gae_duplicate tensor(-1.7141, dtype=torch.float64) tensor(13.6022, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7844, dtype=torch.float64) delta_t tensor(-1.1685, dtype=torch.float64)
4 gae_duplicate tensor(-5.3169, dtype=torch.float64) tensor(25.9276, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0597, dtype=torch.float64) delta_t tensor(0.5140, dtype=torch.float64)
3 gae_duplicate tensor(0.1303, dtype=torch.float64) tensor(-7.3230, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2479, dtype=torch.float64) delta_t tensor(0.4809, dtype=torch.float64)
2 gae_duplicate tensor(0.1729, dtype=torch.float64) tensor(-10.2573, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-803.9310913085938
value loss:87.27101135253906
entropies:351.844970703125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.186860084533691 seconds
19 rew tensor(0.4859, dtype=torch.float64) delta_t tensor(0.2063, dtype=torch.float64)
19 gae_duplicate tensor(0.0072, dtype=torch.float64) tensor(-3.9899, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4333, dtype=torch.float64) delta_t tensor(-0.2191, dtype=torch.float64)
18 gae_duplicate tensor(-0.7920, dtype=torch.float64) tensor(3.7724, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5135, dtype=torch.float64) delta_t tensor(0.2166, dtype=torch.float64)
17 gae_duplicate tensor(-0.0923, dtype=torch.float64) tensor(-4.1042, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3607, dtype=torch.float64) delta_t tensor(0.0658, dtype=torch.float64)
16 gae_duplicate tensor(-0.2379, dtype=torch.float64) tensor(-1.9293, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4951, dtype=torch.float64) delta_t tensor(-0.1740, dtype=torch.float64)
15 gae_duplicate tensor(-0.5048, dtype=torch.float64) tensor(3.0855, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2088, dtype=torch.float64) delta_t tensor(-0.0489, dtype=torch.float64)
14 gae_duplicate tensor(-0.2302, dtype=torch.float64) tensor(1.0578, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5278, dtype=torch.float64) delta_t tensor(-0.0272, dtype=torch.float64)
13 gae_duplicate tensor(-0.4433, dtype=torch.float64) tensor(0.6929, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1711, dtype=torch.float64) delta_t tensor(0.0393, dtype=torch.float64)
12 gae_duplicate tensor(-0.1748, dtype=torch.float64) tensor(-0.8141, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5483, dtype=torch.float64) delta_t tensor(0.3537, dtype=torch.float64)
11 gae_duplicate tensor(0.2737, dtype=torch.float64) tensor(-6.9429, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1855, dtype=torch.float64) delta_t tensor(-0.0382, dtype=torch.float64)
10 gae_duplicate tensor(-0.1796, dtype=torch.float64) tensor(-0.0506, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5356, dtype=torch.float64) delta_t tensor(0.2532, dtype=torch.float64)
9 gae_duplicate tensor(0.0993, dtype=torch.float64) tensor(-4.7505, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1323, dtype=torch.float64) delta_t tensor(-0.1598, dtype=torch.float64)
8 gae_duplicate tensor(-0.4339, dtype=torch.float64) tensor(2.6940, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4950, dtype=torch.float64) delta_t tensor(0.2485, dtype=torch.float64)
7 gae_duplicate tensor(0.1636, dtype=torch.float64) tensor(-4.8490, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0660, dtype=torch.float64) delta_t tensor(0.0322, dtype=torch.float64)
6 gae_duplicate tensor(-0.0975, dtype=torch.float64) tensor(-1.0888, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1154, dtype=torch.float64) delta_t tensor(0.2500, dtype=torch.float64)
5 gae_duplicate tensor(-0.5157, dtype=torch.float64) tensor(-5.7763, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.0255, dtype=torch.float64) delta_t tensor(-3.2474, dtype=torch.float64)
4 gae_duplicate tensor(-5.6008, dtype=torch.float64) tensor(63.5418, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0419, dtype=torch.float64) delta_t tensor(0.5388, dtype=torch.float64)
3 gae_duplicate tensor(0.1135, dtype=torch.float64) tensor(-4.1602, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1040, dtype=torch.float64) delta_t tensor(0.5547, dtype=torch.float64)
2 gae_duplicate tensor(0.2333, dtype=torch.float64) tensor(-11.3977, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1444.3529052734375
value loss:129.2898406982422
entropies:351.3161926269531
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3952.8926)
ToM Target loss= tensor(3533.0667)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.487161159515381 seconds
19 rew tensor(0.5533, dtype=torch.float64) delta_t tensor(0.3134, dtype=torch.float64)
19 gae_duplicate tensor(0.1900, dtype=torch.float64) tensor(-5.8763, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3813, dtype=torch.float64) delta_t tensor(-0.1804, dtype=torch.float64)
18 gae_duplicate tensor(-0.9091, dtype=torch.float64) tensor(3.0306, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5129, dtype=torch.float64) delta_t tensor(0.2619, dtype=torch.float64)
17 gae_duplicate tensor(0.1331, dtype=torch.float64) tensor(-4.9059, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3480, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
16 gae_duplicate tensor(-0.0941, dtype=torch.float64) tensor(-1.3113, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5273, dtype=torch.float64) delta_t tensor(-0.0452, dtype=torch.float64)
15 gae_duplicate tensor(-0.4534, dtype=torch.float64) tensor(0.6503, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2666, dtype=torch.float64) delta_t tensor(0.0901, dtype=torch.float64)
14 gae_duplicate tensor(-0.0037, dtype=torch.float64) tensor(-1.6127, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5417, dtype=torch.float64) delta_t tensor(0.0519, dtype=torch.float64)
13 gae_duplicate tensor(-0.4793, dtype=torch.float64) tensor(-1.2946, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2534, dtype=torch.float64) delta_t tensor(0.1474, dtype=torch.float64)
12 gae_duplicate tensor(-0.1542, dtype=torch.float64) tensor(-2.9081, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5410, dtype=torch.float64) delta_t tensor(0.3509, dtype=torch.float64)
11 gae_duplicate tensor(0.2637, dtype=torch.float64) tensor(-7.1757, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2750, dtype=torch.float64) delta_t tensor(0.0782, dtype=torch.float64)
10 gae_duplicate tensor(-0.0309, dtype=torch.float64) tensor(-2.2202, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5217, dtype=torch.float64) delta_t tensor(0.2725, dtype=torch.float64)
9 gae_duplicate tensor(0.1073, dtype=torch.float64) tensor(-5.4858, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2074, dtype=torch.float64) delta_t tensor(-0.0505, dtype=torch.float64)
8 gae_duplicate tensor(-0.4954, dtype=torch.float64) tensor(0.2356, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5086, dtype=torch.float64) delta_t tensor(0.2236, dtype=torch.float64)
7 gae_duplicate tensor(0.1611, dtype=torch.float64) tensor(-4.1453, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1398, dtype=torch.float64) delta_t tensor(0.0524, dtype=torch.float64)
6 gae_duplicate tensor(-0.0879, dtype=torch.float64) tensor(-1.3134, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2831, dtype=torch.float64) delta_t tensor(0.1100, dtype=torch.float64)
5 gae_duplicate tensor(-0.7344, dtype=torch.float64) tensor(-2.4952, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9102, dtype=torch.float64) delta_t tensor(-1.2855, dtype=torch.float64)
4 gae_duplicate tensor(-3.5078, dtype=torch.float64) tensor(27.9745, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0437, dtype=torch.float64) delta_t tensor(0.6327, dtype=torch.float64)
3 gae_duplicate tensor(0.1945, dtype=torch.float64) tensor(-10.4820, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2378, dtype=torch.float64) delta_t tensor(0.2976, dtype=torch.float64)
2 gae_duplicate tensor(0.0621, dtype=torch.float64) tensor(-6.4949, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1300.0426025390625
value loss:66.23307037353516
entropies:351.0665283203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.524785041809082 seconds
19 rew tensor(0.5052, dtype=torch.float64) delta_t tensor(0.2311, dtype=torch.float64)
19 gae_duplicate tensor(0.1104, dtype=torch.float64) tensor(-4.2938, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3272, dtype=torch.float64) delta_t tensor(-0.5511, dtype=torch.float64)
18 gae_duplicate tensor(-1.0701, dtype=torch.float64) tensor(10.6673, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5465, dtype=torch.float64) delta_t tensor(0.2878, dtype=torch.float64)
17 gae_duplicate tensor(0.1677, dtype=torch.float64) tensor(-4.8097, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2662, dtype=torch.float64) delta_t tensor(-0.3581, dtype=torch.float64)
16 gae_duplicate tensor(-0.5641, dtype=torch.float64) tensor(6.4338, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5258, dtype=torch.float64) delta_t tensor(-0.0492, dtype=torch.float64)
15 gae_duplicate tensor(-0.5137, dtype=torch.float64) tensor(1.6866, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2881, dtype=torch.float64) delta_t tensor(0.0524, dtype=torch.float64)
14 gae_duplicate tensor(-0.2076, dtype=torch.float64) tensor(-0.7851, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5278, dtype=torch.float64) delta_t tensor(0.0092, dtype=torch.float64)
13 gae_duplicate tensor(-0.5063, dtype=torch.float64) tensor(-0.0260, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1257, dtype=torch.float64) delta_t tensor(-0.0134, dtype=torch.float64)
12 gae_duplicate tensor(-0.6013, dtype=torch.float64) tensor(0.2039, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5412, dtype=torch.float64) delta_t tensor(0.3588, dtype=torch.float64)
11 gae_duplicate tensor(0.2687, dtype=torch.float64) tensor(-7.3067, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2635, dtype=torch.float64) delta_t tensor(0.0277, dtype=torch.float64)
10 gae_duplicate tensor(-0.0206, dtype=torch.float64) tensor(-1.1042, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5482, dtype=torch.float64) delta_t tensor(0.2831, dtype=torch.float64)
9 gae_duplicate tensor(0.1423, dtype=torch.float64) tensor(-5.6704, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2234, dtype=torch.float64) delta_t tensor(-0.0489, dtype=torch.float64)
8 gae_duplicate tensor(-0.1037, dtype=torch.float64) tensor(0.3578, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5078, dtype=torch.float64) delta_t tensor(0.2510, dtype=torch.float64)
7 gae_duplicate tensor(0.1060, dtype=torch.float64) tensor(-4.6718, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1832, dtype=torch.float64) delta_t tensor(-0.0081, dtype=torch.float64)
6 gae_duplicate tensor(-0.1326, dtype=torch.float64) tensor(-0.2701, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4033, dtype=torch.float64) delta_t tensor(0.3192, dtype=torch.float64)
5 gae_duplicate tensor(-0.6356, dtype=torch.float64) tensor(-7.2301, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.7175, dtype=torch.float64) delta_t tensor(-1.7636, dtype=torch.float64)
4 gae_duplicate tensor(-5.0418, dtype=torch.float64) tensor(38.5739, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0955, dtype=torch.float64) delta_t tensor(0.5407, dtype=torch.float64)
3 gae_duplicate tensor(0.0552, dtype=torch.float64) tensor(-7.2589, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1803, dtype=torch.float64) delta_t tensor(0.5074, dtype=torch.float64)
2 gae_duplicate tensor(0.1116, dtype=torch.float64) tensor(-10.0527, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-334.619140625
value loss:80.8824691772461
entropies:350.5806884765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.321868181228638 seconds
19 rew tensor(0.4940, dtype=torch.float64) delta_t tensor(0.1506, dtype=torch.float64)
19 gae_duplicate tensor(0.0140, dtype=torch.float64) tensor(-2.9449, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3770, dtype=torch.float64) delta_t tensor(-0.1613, dtype=torch.float64)
18 gae_duplicate tensor(-0.8088, dtype=torch.float64) tensor(3.1075, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5080, dtype=torch.float64) delta_t tensor(0.1404, dtype=torch.float64)
17 gae_duplicate tensor(-0.1638, dtype=torch.float64) tensor(-2.4283, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3442, dtype=torch.float64) delta_t tensor(0.0367, dtype=torch.float64)
16 gae_duplicate tensor(-0.5121, dtype=torch.float64) tensor(-0.7649, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3601, dtype=torch.float64) delta_t tensor(-0.3898, dtype=torch.float64)
15 gae_duplicate tensor(-1.2463, dtype=torch.float64) tensor(8.0414, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2368, dtype=torch.float64) delta_t tensor(-0.0172, dtype=torch.float64)
14 gae_duplicate tensor(-0.6788, dtype=torch.float64) tensor(1.3597, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5342, dtype=torch.float64) delta_t tensor(0.1027, dtype=torch.float64)
13 gae_duplicate tensor(-0.5294, dtype=torch.float64) tensor(-1.9195, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2189, dtype=torch.float64) delta_t tensor(0.0681, dtype=torch.float64)
12 gae_duplicate tensor(-0.1287, dtype=torch.float64) tensor(-1.4738, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5488, dtype=torch.float64) delta_t tensor(0.3341, dtype=torch.float64)
11 gae_duplicate tensor(0.2960, dtype=torch.float64) tensor(-5.8543, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2197, dtype=torch.float64) delta_t tensor(-0.0063, dtype=torch.float64)
10 gae_duplicate tensor(-0.1584, dtype=torch.float64) tensor(-0.6298, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5492, dtype=torch.float64) delta_t tensor(0.2197, dtype=torch.float64)
9 gae_duplicate tensor(0.1379, dtype=torch.float64) tensor(-4.3976, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1795, dtype=torch.float64) delta_t tensor(-0.1276, dtype=torch.float64)
8 gae_duplicate tensor(-0.3105, dtype=torch.float64) tensor(2.1843, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5087, dtype=torch.float64) delta_t tensor(0.2398, dtype=torch.float64)
7 gae_duplicate tensor(0.1373, dtype=torch.float64) tensor(-4.4525, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1393, dtype=torch.float64) delta_t tensor(-0.0439, dtype=torch.float64)
6 gae_duplicate tensor(-0.1587, dtype=torch.float64) tensor(0.5630, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7018, dtype=torch.float64) delta_t tensor(0.0975, dtype=torch.float64)
5 gae_duplicate tensor(-0.9124, dtype=torch.float64) tensor(-2.2402, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.2395, dtype=torch.float64) delta_t tensor(-1.0934, dtype=torch.float64)
4 gae_duplicate tensor(-3.0479, dtype=torch.float64) tensor(21.4634, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1214, dtype=torch.float64) delta_t tensor(0.3953, dtype=torch.float64)
3 gae_duplicate tensor(0.0961, dtype=torch.float64) tensor(-4.9217, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1446, dtype=torch.float64) delta_t tensor(0.5258, dtype=torch.float64)
2 gae_duplicate tensor(0.2093, dtype=torch.float64) tensor(-10.0825, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:196.63525390625
value loss:39.9022331237793
entropies:349.8582458496094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.198045253753662 seconds
19 rew tensor(0.5149, dtype=torch.float64) delta_t tensor(0.2010, dtype=torch.float64)
19 gae_duplicate tensor(0.0688, dtype=torch.float64) tensor(-4.1668, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4350, dtype=torch.float64) delta_t tensor(-0.5054, dtype=torch.float64)
18 gae_duplicate tensor(-1.1119, dtype=torch.float64) tensor(8.7301, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4980, dtype=torch.float64) delta_t tensor(0.2879, dtype=torch.float64)
17 gae_duplicate tensor(0.1763, dtype=torch.float64) tensor(-4.7689, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3318, dtype=torch.float64) delta_t tensor(-0.0527, dtype=torch.float64)
16 gae_duplicate tensor(-0.3147, dtype=torch.float64) tensor(0.9477, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4901, dtype=torch.float64) delta_t tensor(-0.2426, dtype=torch.float64)
15 gae_duplicate tensor(-0.5793, dtype=torch.float64) tensor(5.1290, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2053, dtype=torch.float64) delta_t tensor(0.0534, dtype=torch.float64)
14 gae_duplicate tensor(-0.1500, dtype=torch.float64) tensor(-0.3599, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5356, dtype=torch.float64) delta_t tensor(0.0417, dtype=torch.float64)
13 gae_duplicate tensor(-0.5407, dtype=torch.float64) tensor(-0.9603, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1484, dtype=torch.float64) delta_t tensor(-0.0216, dtype=torch.float64)
12 gae_duplicate tensor(-0.2235, dtype=torch.float64) tensor(0.4520, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5492, dtype=torch.float64) delta_t tensor(0.3478, dtype=torch.float64)
11 gae_duplicate tensor(0.2647, dtype=torch.float64) tensor(-6.4267, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1492, dtype=torch.float64) delta_t tensor(-0.0950, dtype=torch.float64)
10 gae_duplicate tensor(-0.2921, dtype=torch.float64) tensor(1.1767, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5495, dtype=torch.float64) delta_t tensor(0.2182, dtype=torch.float64)
9 gae_duplicate tensor(0.1111, dtype=torch.float64) tensor(-4.2470, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1091, dtype=torch.float64) delta_t tensor(-0.1930, dtype=torch.float64)
8 gae_duplicate tensor(-0.3800, dtype=torch.float64) tensor(3.4333, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4473, dtype=torch.float64) delta_t tensor(0.2644, dtype=torch.float64)
7 gae_duplicate tensor(0.0993, dtype=torch.float64) tensor(-5.2462, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0072, dtype=torch.float64) delta_t tensor(0.0388, dtype=torch.float64)
6 gae_duplicate tensor(-0.1559, dtype=torch.float64) tensor(-1.1456, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7953, dtype=torch.float64) delta_t tensor(-0.1494, dtype=torch.float64)
5 gae_duplicate tensor(-0.3992, dtype=torch.float64) tensor(3.1861, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9423, dtype=torch.float64) delta_t tensor(-2.0060, dtype=torch.float64)
4 gae_duplicate tensor(-3.8064, dtype=torch.float64) tensor(38.6125, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0476, dtype=torch.float64) delta_t tensor(0.8066, dtype=torch.float64)
3 gae_duplicate tensor(0.2986, dtype=torch.float64) tensor(-11.1634, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1214, dtype=torch.float64) delta_t tensor(0.6450, dtype=torch.float64)
2 gae_duplicate tensor(0.3316, dtype=torch.float64) tensor(-13.8491, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-598.2012329101562
value loss:68.53837585449219
entropies:348.8769226074219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.392930030822754 seconds
19 rew tensor(0.5314, dtype=torch.float64) delta_t tensor(0.2773, dtype=torch.float64)
19 gae_duplicate tensor(0.1595, dtype=torch.float64) tensor(-5.6041, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3638, dtype=torch.float64) delta_t tensor(-0.2558, dtype=torch.float64)
18 gae_duplicate tensor(-0.7309, dtype=torch.float64) tensor(4.0593, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5411, dtype=torch.float64) delta_t tensor(0.2997, dtype=torch.float64)
17 gae_duplicate tensor(0.1926, dtype=torch.float64) tensor(-5.3493, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3294, dtype=torch.float64) delta_t tensor(-0.2484, dtype=torch.float64)
16 gae_duplicate tensor(-0.5740, dtype=torch.float64) tensor(3.9744, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5086, dtype=torch.float64) delta_t tensor(-0.0234, dtype=torch.float64)
15 gae_duplicate tensor(-0.6149, dtype=torch.float64) tensor(0.2714, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2432, dtype=torch.float64) delta_t tensor(0.0204, dtype=torch.float64)
14 gae_duplicate tensor(-0.3540, dtype=torch.float64) tensor(-0.2037, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5275, dtype=torch.float64) delta_t tensor(0.2196, dtype=torch.float64)
13 gae_duplicate tensor(-0.6269, dtype=torch.float64) tensor(-4.3347, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2096, dtype=torch.float64) delta_t tensor(-0.0068, dtype=torch.float64)
12 gae_duplicate tensor(-0.1871, dtype=torch.float64) tensor(-0.3356, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5490, dtype=torch.float64) delta_t tensor(0.1878, dtype=torch.float64)
11 gae_duplicate tensor(-0.5708, dtype=torch.float64) tensor(-3.8842, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2114, dtype=torch.float64) delta_t tensor(0.0314, dtype=torch.float64)
10 gae_duplicate tensor(-0.2402, dtype=torch.float64) tensor(-1.2722, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5241, dtype=torch.float64) delta_t tensor(0.2128, dtype=torch.float64)
9 gae_duplicate tensor(0.0138, dtype=torch.float64) tensor(-4.1959, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1464, dtype=torch.float64) delta_t tensor(-0.1081, dtype=torch.float64)
8 gae_duplicate tensor(-0.2764, dtype=torch.float64) tensor(1.7245, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3933, dtype=torch.float64) delta_t tensor(0.2690, dtype=torch.float64)
7 gae_duplicate tensor(0.1787, dtype=torch.float64) tensor(-4.9263, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0031, dtype=torch.float64) delta_t tensor(0.1597, dtype=torch.float64)
6 gae_duplicate tensor(-0.1324, dtype=torch.float64) tensor(-3.2890, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4227, dtype=torch.float64) delta_t tensor(0.2431, dtype=torch.float64)
5 gae_duplicate tensor(-0.8475, dtype=torch.float64) tensor(-5.8373, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.8417, dtype=torch.float64) delta_t tensor(-2.0505, dtype=torch.float64)
4 gae_duplicate tensor(-5.0249, dtype=torch.float64) tensor(39.0613, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0275, dtype=torch.float64) delta_t tensor(0.6531, dtype=torch.float64)
3 gae_duplicate tensor(-0.0288, dtype=torch.float64) tensor(-7.9429, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1296, dtype=torch.float64) delta_t tensor(0.4724, dtype=torch.float64)
2 gae_duplicate tensor(-0.0683, dtype=torch.float64) tensor(-9.7379, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:328.4521789550781
value loss:89.61264038085938
entropies:347.955322265625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3940.2598)
ToM Target loss= tensor(3541.4761)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.46787691116333 seconds
19 rew tensor(0.5482, dtype=torch.float64) delta_t tensor(0.0458, dtype=torch.float64)
19 gae_duplicate tensor(-0.6867, dtype=torch.float64) tensor(-0.9211, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4238, dtype=torch.float64) delta_t tensor(-0.3666, dtype=torch.float64)
18 gae_duplicate tensor(-1.1265, dtype=torch.float64) tensor(7.9876, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5148, dtype=torch.float64) delta_t tensor(0.2831, dtype=torch.float64)
17 gae_duplicate tensor(0.1352, dtype=torch.float64) tensor(-5.0551, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3110, dtype=torch.float64) delta_t tensor(-0.2790, dtype=torch.float64)
16 gae_duplicate tensor(-0.6674, dtype=torch.float64) tensor(4.9171, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4541, dtype=torch.float64) delta_t tensor(-0.1498, dtype=torch.float64)
15 gae_duplicate tensor(-0.6761, dtype=torch.float64) tensor(3.7872, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2898, dtype=torch.float64) delta_t tensor(0.0275, dtype=torch.float64)
14 gae_duplicate tensor(-0.6482, dtype=torch.float64) tensor(0.2993, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4392, dtype=torch.float64) delta_t tensor(0.1967, dtype=torch.float64)
13 gae_duplicate tensor(-0.2129, dtype=torch.float64) tensor(-3.6614, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3188, dtype=torch.float64) delta_t tensor(0.0337, dtype=torch.float64)
12 gae_duplicate tensor(-0.2338, dtype=torch.float64) tensor(-1.1483, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4134, dtype=torch.float64) delta_t tensor(0.1994, dtype=torch.float64)
11 gae_duplicate tensor(-0.4192, dtype=torch.float64) tensor(-4.3317, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3261, dtype=torch.float64) delta_t tensor(0.1277, dtype=torch.float64)
10 gae_duplicate tensor(-0.1877, dtype=torch.float64) tensor(-3.1645, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4206, dtype=torch.float64) delta_t tensor(0.2007, dtype=torch.float64)
9 gae_duplicate tensor(0.0856, dtype=torch.float64) tensor(-4.1190, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2516, dtype=torch.float64) delta_t tensor(0.0523, dtype=torch.float64)
8 gae_duplicate tensor(-0.2824, dtype=torch.float64) tensor(-1.9384, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4755, dtype=torch.float64) delta_t tensor(0.1193, dtype=torch.float64)
7 gae_duplicate tensor(-0.3903, dtype=torch.float64) tensor(-2.3524, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0479, dtype=torch.float64) delta_t tensor(-0.0036, dtype=torch.float64)
6 gae_duplicate tensor(-0.1741, dtype=torch.float64) tensor(-0.3626, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1286, dtype=torch.float64) delta_t tensor(0.4973, dtype=torch.float64)
5 gae_duplicate tensor(-0.9322, dtype=torch.float64) tensor(-8.6057, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7993, dtype=torch.float64) delta_t tensor(-0.7458, dtype=torch.float64)
4 gae_duplicate tensor(-3.2678, dtype=torch.float64) tensor(14.9667, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0483, dtype=torch.float64) delta_t tensor(0.6963, dtype=torch.float64)
3 gae_duplicate tensor(0.0296, dtype=torch.float64) tensor(-11.4849, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2727, dtype=torch.float64) delta_t tensor(0.3388, dtype=torch.float64)
2 gae_duplicate tensor(0.1530, dtype=torch.float64) tensor(-7.5427, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1133.6153564453125
value loss:54.161659240722656
entropies:347.4134826660156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.273323059082031 seconds
19 rew tensor(0.5100, dtype=torch.float64) delta_t tensor(0.1061, dtype=torch.float64)
19 gae_duplicate tensor(-0.3947, dtype=torch.float64) tensor(-2.4463, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4862, dtype=torch.float64) delta_t tensor(0.1077, dtype=torch.float64)
18 gae_duplicate tensor(-0.3352, dtype=torch.float64) tensor(-2.5133, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4140, dtype=torch.float64) delta_t tensor(-0.0833, dtype=torch.float64)
17 gae_duplicate tensor(-0.4528, dtype=torch.float64) tensor(1.6400, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4042, dtype=torch.float64) delta_t tensor(-0.0994, dtype=torch.float64)
16 gae_duplicate tensor(-0.6723, dtype=torch.float64) tensor(1.4755, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5003, dtype=torch.float64) delta_t tensor(-0.2703, dtype=torch.float64)
15 gae_duplicate tensor(-0.6989, dtype=torch.float64) tensor(4.2626, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2372, dtype=torch.float64) delta_t tensor(0.0670, dtype=torch.float64)
14 gae_duplicate tensor(-0.0016, dtype=torch.float64) tensor(-0.7160, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5283, dtype=torch.float64) delta_t tensor(0.2636, dtype=torch.float64)
13 gae_duplicate tensor(0.0612, dtype=torch.float64) tensor(-5.3267, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1981, dtype=torch.float64) delta_t tensor(0.0113, dtype=torch.float64)
12 gae_duplicate tensor(-0.1407, dtype=torch.float64) tensor(-0.4184, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5219, dtype=torch.float64) delta_t tensor(0.2885, dtype=torch.float64)
11 gae_duplicate tensor(0.1973, dtype=torch.float64) tensor(-5.6539, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1989, dtype=torch.float64) delta_t tensor(-0.0788, dtype=torch.float64)
10 gae_duplicate tensor(-0.2117, dtype=torch.float64) tensor(0.9157, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5094, dtype=torch.float64) delta_t tensor(0.1309, dtype=torch.float64)
9 gae_duplicate tensor(0.0506, dtype=torch.float64) tensor(-2.7451, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1198, dtype=torch.float64) delta_t tensor(-0.1683, dtype=torch.float64)
8 gae_duplicate tensor(-0.3182, dtype=torch.float64) tensor(2.9300, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3771, dtype=torch.float64) delta_t tensor(0.2291, dtype=torch.float64)
7 gae_duplicate tensor(0.0685, dtype=torch.float64) tensor(-4.2179, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0447, dtype=torch.float64) delta_t tensor(0.1142, dtype=torch.float64)
6 gae_duplicate tensor(-0.2344, dtype=torch.float64) tensor(-1.8736, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5293, dtype=torch.float64) delta_t tensor(0.1473, dtype=torch.float64)
5 gae_duplicate tensor(-0.5985, dtype=torch.float64) tensor(-3.5744, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.1231, dtype=torch.float64) delta_t tensor(-2.3206, dtype=torch.float64)
4 gae_duplicate tensor(-6.2152, dtype=torch.float64) tensor(44.6450, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0120, dtype=torch.float64) delta_t tensor(0.7201, dtype=torch.float64)
3 gae_duplicate tensor(0.2416, dtype=torch.float64) tensor(-9.2208, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1460, dtype=torch.float64) delta_t tensor(0.3542, dtype=torch.float64)
2 gae_duplicate tensor(-0.0174, dtype=torch.float64) tensor(-9.2724, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-519.6277465820312
value loss:135.68353271484375
entropies:346.56829833984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.76827597618103 seconds
19 rew tensor(0.4400, dtype=torch.float64) delta_t tensor(-0.0085, dtype=torch.float64)
19 gae_duplicate tensor(-0.2080, dtype=torch.float64) tensor(0.2108, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4511, dtype=torch.float64) delta_t tensor(0.0242, dtype=torch.float64)
18 gae_duplicate tensor(-0.1374, dtype=torch.float64) tensor(-0.1892, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4672, dtype=torch.float64) delta_t tensor(0.0135, dtype=torch.float64)
17 gae_duplicate tensor(-0.5545, dtype=torch.float64) tensor(-0.4294, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3459, dtype=torch.float64) delta_t tensor(-0.2752, dtype=torch.float64)
16 gae_duplicate tensor(-0.8022, dtype=torch.float64) tensor(6.0705, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4535, dtype=torch.float64) delta_t tensor(-0.4010, dtype=torch.float64)
15 gae_duplicate tensor(-0.8618, dtype=torch.float64) tensor(7.6142, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2922, dtype=torch.float64) delta_t tensor(0.0941, dtype=torch.float64)
14 gae_duplicate tensor(-0.1920, dtype=torch.float64) tensor(-1.1365, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5084, dtype=torch.float64) delta_t tensor(0.0254, dtype=torch.float64)
13 gae_duplicate tensor(-0.7496, dtype=torch.float64) tensor(-0.3604, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2340, dtype=torch.float64) delta_t tensor(0.0206, dtype=torch.float64)
12 gae_duplicate tensor(-0.1119, dtype=torch.float64) tensor(-0.6537, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5287, dtype=torch.float64) delta_t tensor(0.2198, dtype=torch.float64)
11 gae_duplicate tensor(0.0852, dtype=torch.float64) tensor(-4.2771, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2083, dtype=torch.float64) delta_t tensor(-0.1176, dtype=torch.float64)
10 gae_duplicate tensor(-0.2696, dtype=torch.float64) tensor(1.5605, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5093, dtype=torch.float64) delta_t tensor(0.0790, dtype=torch.float64)
9 gae_duplicate tensor(-0.1688, dtype=torch.float64) tensor(-1.4517, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1287, dtype=torch.float64) delta_t tensor(-0.2119, dtype=torch.float64)
8 gae_duplicate tensor(-0.3374, dtype=torch.float64) tensor(4.2776, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4227, dtype=torch.float64) delta_t tensor(0.2339, dtype=torch.float64)
7 gae_duplicate tensor(0.0705, dtype=torch.float64) tensor(-3.8616, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0292, dtype=torch.float64) delta_t tensor(0.0032, dtype=torch.float64)
6 gae_duplicate tensor(-0.2233, dtype=torch.float64) tensor(-0.2071, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3918, dtype=torch.float64) delta_t tensor(0.2725, dtype=torch.float64)
5 gae_duplicate tensor(-0.6648, dtype=torch.float64) tensor(-5.6677, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9074, dtype=torch.float64) delta_t tensor(-0.8860, dtype=torch.float64)
4 gae_duplicate tensor(-5.5867, dtype=torch.float64) tensor(15.4556, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1126, dtype=torch.float64) delta_t tensor(0.7325, dtype=torch.float64)
3 gae_duplicate tensor(0.3365, dtype=torch.float64) tensor(-12.0976, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1324, dtype=torch.float64) delta_t tensor(0.1783, dtype=torch.float64)
2 gae_duplicate tensor(-0.0612, dtype=torch.float64) tensor(-4.1112, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-133.74359130859375
value loss:77.96581268310547
entropies:346.1409606933594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.5619797706604 seconds
19 rew tensor(0.5040, dtype=torch.float64) delta_t tensor(0.1675, dtype=torch.float64)
19 gae_duplicate tensor(0.0526, dtype=torch.float64) tensor(-2.9419, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4036, dtype=torch.float64) delta_t tensor(0.0790, dtype=torch.float64)
18 gae_duplicate tensor(-0.1739, dtype=torch.float64) tensor(-1.7089, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4892, dtype=torch.float64) delta_t tensor(0.1621, dtype=torch.float64)
17 gae_duplicate tensor(-0.1112, dtype=torch.float64) tensor(-3.2611, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3370, dtype=torch.float64) delta_t tensor(-0.2129, dtype=torch.float64)
16 gae_duplicate tensor(-0.4332, dtype=torch.float64) tensor(3.7487, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4518, dtype=torch.float64) delta_t tensor(-0.2147, dtype=torch.float64)
15 gae_duplicate tensor(-0.6342, dtype=torch.float64) tensor(3.7064, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2700, dtype=torch.float64) delta_t tensor(-0.0006, dtype=torch.float64)
14 gae_duplicate tensor(-0.4679, dtype=torch.float64) tensor(0.5443, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5314, dtype=torch.float64) delta_t tensor(-0.1340, dtype=torch.float64)
13 gae_duplicate tensor(-0.7718, dtype=torch.float64) tensor(2.7916, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1866, dtype=torch.float64) delta_t tensor(0.1546, dtype=torch.float64)
12 gae_duplicate tensor(-0.0282, dtype=torch.float64) tensor(-2.3146, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5379, dtype=torch.float64) delta_t tensor(0.2958, dtype=torch.float64)
11 gae_duplicate tensor(0.2095, dtype=torch.float64) tensor(-5.9473, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2003, dtype=torch.float64) delta_t tensor(-0.2910, dtype=torch.float64)
10 gae_duplicate tensor(-1.4848, dtype=torch.float64) tensor(4.8057, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5449, dtype=torch.float64) delta_t tensor(0.1682, dtype=torch.float64)
9 gae_duplicate tensor(0.0405, dtype=torch.float64) tensor(-3.0751, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1606, dtype=torch.float64) delta_t tensor(-0.1957, dtype=torch.float64)
8 gae_duplicate tensor(-0.4746, dtype=torch.float64) tensor(3.4533, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5049, dtype=torch.float64) delta_t tensor(0.1742, dtype=torch.float64)
7 gae_duplicate tensor(-0.0142, dtype=torch.float64) tensor(-2.8438, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1209, dtype=torch.float64) delta_t tensor(-0.1238, dtype=torch.float64)
6 gae_duplicate tensor(-0.1868, dtype=torch.float64) tensor(2.1282, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0963, dtype=torch.float64) delta_t tensor(0.6647, dtype=torch.float64)
5 gae_duplicate tensor(0.1681, dtype=torch.float64) tensor(-12.0881, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.7697, dtype=torch.float64) delta_t tensor(-2.4399, dtype=torch.float64)
4 gae_duplicate tensor(-6.1866, dtype=torch.float64) tensor(43.2668, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0501, dtype=torch.float64) delta_t tensor(0.7670, dtype=torch.float64)
3 gae_duplicate tensor(0.1650, dtype=torch.float64) tensor(-11.0956, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1099, dtype=torch.float64) delta_t tensor(0.2113, dtype=torch.float64)
2 gae_duplicate tensor(-0.3478, dtype=torch.float64) tensor(-5.1804, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-848.7169189453125
value loss:134.1441650390625
entropies:345.7332763671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.31848406791687 seconds
19 rew tensor(0.4772, dtype=torch.float64) delta_t tensor(0.1243, dtype=torch.float64)
19 gae_duplicate tensor(-0.0040, dtype=torch.float64) tensor(-2.8071, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3621, dtype=torch.float64) delta_t tensor(-0.2473, dtype=torch.float64)
18 gae_duplicate tensor(-1.0639, dtype=torch.float64) tensor(4.6679, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5245, dtype=torch.float64) delta_t tensor(0.2630, dtype=torch.float64)
17 gae_duplicate tensor(0.0225, dtype=torch.float64) tensor(-4.7936, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2376, dtype=torch.float64) delta_t tensor(-0.1852, dtype=torch.float64)
16 gae_duplicate tensor(-0.3525, dtype=torch.float64) tensor(3.1688, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4974, dtype=torch.float64) delta_t tensor(-0.2028, dtype=torch.float64)
15 gae_duplicate tensor(-0.7176, dtype=torch.float64) tensor(4.6791, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1978, dtype=torch.float64) delta_t tensor(-0.1370, dtype=torch.float64)
14 gae_duplicate tensor(-0.7648, dtype=torch.float64) tensor(2.7388, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5382, dtype=torch.float64) delta_t tensor(-0.0902, dtype=torch.float64)
13 gae_duplicate tensor(-0.7774, dtype=torch.float64) tensor(1.6729, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1733, dtype=torch.float64) delta_t tensor(0.0394, dtype=torch.float64)
12 gae_duplicate tensor(-0.1281, dtype=torch.float64) tensor(-0.5797, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5385, dtype=torch.float64) delta_t tensor(0.0889, dtype=torch.float64)
11 gae_duplicate tensor(-0.7836, dtype=torch.float64) tensor(-1.4132, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1871, dtype=torch.float64) delta_t tensor(-0.0525, dtype=torch.float64)
10 gae_duplicate tensor(-0.1696, dtype=torch.float64) tensor(0.7515, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5323, dtype=torch.float64) delta_t tensor(0.1613, dtype=torch.float64)
9 gae_duplicate tensor(0.0118, dtype=torch.float64) tensor(-2.8687, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1343, dtype=torch.float64) delta_t tensor(-0.1916, dtype=torch.float64)
8 gae_duplicate tensor(-0.3947, dtype=torch.float64) tensor(3.3388, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5052, dtype=torch.float64) delta_t tensor(0.2560, dtype=torch.float64)
7 gae_duplicate tensor(0.1065, dtype=torch.float64) tensor(-4.5252, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0816, dtype=torch.float64) delta_t tensor(-0.1463, dtype=torch.float64)
6 gae_duplicate tensor(-0.2350, dtype=torch.float64) tensor(2.3371, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6981, dtype=torch.float64) delta_t tensor(0.2701, dtype=torch.float64)
5 gae_duplicate tensor(-1.5512, dtype=torch.float64) tensor(-5.8125, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6635, dtype=torch.float64) delta_t tensor(-0.5505, dtype=torch.float64)
4 gae_duplicate tensor(-3.9886, dtype=torch.float64) tensor(8.7122, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1172, dtype=torch.float64) delta_t tensor(0.3974, dtype=torch.float64)
3 gae_duplicate tensor(-0.4431, dtype=torch.float64) tensor(-7.8436, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2428, dtype=torch.float64) delta_t tensor(0.0609, dtype=torch.float64)
2 gae_duplicate tensor(-0.2898, dtype=torch.float64) tensor(-1.7095, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-77.89778137207031
value loss:64.3012466430664
entropies:345.7255859375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3925.2869)
ToM Target loss= tensor(3547.3086)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.274191856384277 seconds
19 rew tensor(0.5151, dtype=torch.float64) delta_t tensor(0.1695, dtype=torch.float64)
19 gae_duplicate tensor(-0.1392, dtype=torch.float64) tensor(-3.2067, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5016, dtype=torch.float64) delta_t tensor(-0.0555, dtype=torch.float64)
18 gae_duplicate tensor(-0.4661, dtype=torch.float64) tensor(0.8434, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4811, dtype=torch.float64) delta_t tensor(-0.1396, dtype=torch.float64)
17 gae_duplicate tensor(-0.5831, dtype=torch.float64) tensor(2.9014, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3800, dtype=torch.float64) delta_t tensor(-0.4191, dtype=torch.float64)
16 gae_duplicate tensor(-0.9050, dtype=torch.float64) tensor(8.0078, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4501, dtype=torch.float64) delta_t tensor(-0.1829, dtype=torch.float64)
15 gae_duplicate tensor(-0.8940, dtype=torch.float64) tensor(4.7831, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3595, dtype=torch.float64) delta_t tensor(-0.3478, dtype=torch.float64)
14 gae_duplicate tensor(-0.8144, dtype=torch.float64) tensor(6.6597, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4265, dtype=torch.float64) delta_t tensor(-0.1469, dtype=torch.float64)
13 gae_duplicate tensor(-0.8479, dtype=torch.float64) tensor(3.6490, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3204, dtype=torch.float64) delta_t tensor(0.1237, dtype=torch.float64)
12 gae_duplicate tensor(-0.1809, dtype=torch.float64) tensor(-2.0521, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4400, dtype=torch.float64) delta_t tensor(0.1158, dtype=torch.float64)
11 gae_duplicate tensor(-0.1451, dtype=torch.float64) tensor(-2.5157, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3275, dtype=torch.float64) delta_t tensor(-0.0321, dtype=torch.float64)
10 gae_duplicate tensor(-0.2841, dtype=torch.float64) tensor(0.5303, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4405, dtype=torch.float64) delta_t tensor(-0.0039, dtype=torch.float64)
9 gae_duplicate tensor(-0.2732, dtype=torch.float64) tensor(0.0468, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2230, dtype=torch.float64) delta_t tensor(-0.1807, dtype=torch.float64)
8 gae_duplicate tensor(-0.3480, dtype=torch.float64) tensor(3.4781, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3228, dtype=torch.float64) delta_t tensor(0.1017, dtype=torch.float64)
7 gae_duplicate tensor(-0.0127, dtype=torch.float64) tensor(-1.6085, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0152, dtype=torch.float64) delta_t tensor(0.1489, dtype=torch.float64)
6 gae_duplicate tensor(-0.2384, dtype=torch.float64) tensor(-3.0932, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2503, dtype=torch.float64) delta_t tensor(0.5703, dtype=torch.float64)
5 gae_duplicate tensor(0.3096, dtype=torch.float64) tensor(-11.9988, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.8756, dtype=torch.float64) delta_t tensor(-1.8826, dtype=torch.float64)
4 gae_duplicate tensor(-7.2335, dtype=torch.float64) tensor(31.1650, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0135, dtype=torch.float64) delta_t tensor(0.4858, dtype=torch.float64)
3 gae_duplicate tensor(-0.2779, dtype=torch.float64) tensor(-6.5175, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1042, dtype=torch.float64) delta_t tensor(0.2624, dtype=torch.float64)
2 gae_duplicate tensor(-0.6475, dtype=torch.float64) tensor(-5.7413, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1461.3048095703125
value loss:126.89996337890625
entropies:346.0896301269531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.2229838371276855 seconds
19 rew tensor(0.5417, dtype=torch.float64) delta_t tensor(0.1830, dtype=torch.float64)
19 gae_duplicate tensor(0.1041, dtype=torch.float64) tensor(-3.3961, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3834, dtype=torch.float64) delta_t tensor(-0.2916, dtype=torch.float64)
18 gae_duplicate tensor(-0.6841, dtype=torch.float64) tensor(5.2785, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5422, dtype=torch.float64) delta_t tensor(0.2182, dtype=torch.float64)
17 gae_duplicate tensor(-0.6117, dtype=torch.float64) tensor(-4.4289, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3270, dtype=torch.float64) delta_t tensor(-0.2712, dtype=torch.float64)
16 gae_duplicate tensor(-0.8248, dtype=torch.float64) tensor(5.1765, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5148, dtype=torch.float64) delta_t tensor(-0.4589, dtype=torch.float64)
15 gae_duplicate tensor(-0.7341, dtype=torch.float64) tensor(9.0236, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2213, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
14 gae_duplicate tensor(-0.7514, dtype=torch.float64) tensor(1.0841, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5422, dtype=torch.float64) delta_t tensor(-0.0699, dtype=torch.float64)
13 gae_duplicate tensor(-0.8015, dtype=torch.float64) tensor(1.0952, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2222, dtype=torch.float64) delta_t tensor(0.0490, dtype=torch.float64)
12 gae_duplicate tensor(-0.2946, dtype=torch.float64) tensor(-0.6474, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5426, dtype=torch.float64) delta_t tensor(0.2368, dtype=torch.float64)
11 gae_duplicate tensor(0.1710, dtype=torch.float64) tensor(-4.8933, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2293, dtype=torch.float64) delta_t tensor(-0.0944, dtype=torch.float64)
10 gae_duplicate tensor(-0.4037, dtype=torch.float64) tensor(1.2103, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5429, dtype=torch.float64) delta_t tensor(0.1175, dtype=torch.float64)
9 gae_duplicate tensor(0.0298, dtype=torch.float64) tensor(-2.2301, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1898, dtype=torch.float64) delta_t tensor(-0.1909, dtype=torch.float64)
8 gae_duplicate tensor(-0.5664, dtype=torch.float64) tensor(3.4710, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5031, dtype=torch.float64) delta_t tensor(0.1140, dtype=torch.float64)
7 gae_duplicate tensor(-0.0662, dtype=torch.float64) tensor(-1.7915, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1503, dtype=torch.float64) delta_t tensor(-0.0968, dtype=torch.float64)
6 gae_duplicate tensor(-0.2975, dtype=torch.float64) tensor(1.5714, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5304, dtype=torch.float64) delta_t tensor(0.4082, dtype=torch.float64)
5 gae_duplicate tensor(-0.8173, dtype=torch.float64) tensor(-7.2793, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9690, dtype=torch.float64) delta_t tensor(-1.7192, dtype=torch.float64)
4 gae_duplicate tensor(-5.7399, dtype=torch.float64) tensor(27.8265, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0377, dtype=torch.float64) delta_t tensor(0.6784, dtype=torch.float64)
3 gae_duplicate tensor(0.0352, dtype=torch.float64) tensor(-10.4447, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1672, dtype=torch.float64) delta_t tensor(0.0067, dtype=torch.float64)
2 gae_duplicate tensor(-0.6551, dtype=torch.float64) tensor(-1.2133, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1141.8887939453125
value loss:77.82659912109375
entropies:346.73309326171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.171931028366089 seconds
19 rew tensor(0.5411, dtype=torch.float64) delta_t tensor(0.1986, dtype=torch.float64)
19 gae_duplicate tensor(0.0678, dtype=torch.float64) tensor(-3.8721, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3979, dtype=torch.float64) delta_t tensor(0.0381, dtype=torch.float64)
18 gae_duplicate tensor(-0.1712, dtype=torch.float64) tensor(-1.0038, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5153, dtype=torch.float64) delta_t tensor(0.2324, dtype=torch.float64)
17 gae_duplicate tensor(0.1050, dtype=torch.float64) tensor(-4.5423, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3788, dtype=torch.float64) delta_t tensor(-0.0724, dtype=torch.float64)
16 gae_duplicate tensor(-0.1804, dtype=torch.float64) tensor(1.2948, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4367, dtype=torch.float64) delta_t tensor(-0.1777, dtype=torch.float64)
15 gae_duplicate tensor(-0.6598, dtype=torch.float64) tensor(2.7873, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2279, dtype=torch.float64) delta_t tensor(0.2455, dtype=torch.float64)
14 gae_duplicate tensor(-0.2008, dtype=torch.float64) tensor(-4.9931, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5218, dtype=torch.float64) delta_t tensor(-0.6039, dtype=torch.float64)
13 gae_duplicate tensor(-0.9220, dtype=torch.float64) tensor(12.1043, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1028, dtype=torch.float64) delta_t tensor(0.1667, dtype=torch.float64)
12 gae_duplicate tensor(-0.0761, dtype=torch.float64) tensor(-2.1562, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5425, dtype=torch.float64) delta_t tensor(0.2928, dtype=torch.float64)
11 gae_duplicate tensor(0.2075, dtype=torch.float64) tensor(-5.6444, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1172, dtype=torch.float64) delta_t tensor(-0.3599, dtype=torch.float64)
10 gae_duplicate tensor(-1.6642, dtype=torch.float64) tensor(6.5107, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5427, dtype=torch.float64) delta_t tensor(0.1785, dtype=torch.float64)
9 gae_duplicate tensor(0.0380, dtype=torch.float64) tensor(-2.8214, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0777, dtype=torch.float64) delta_t tensor(-0.2148, dtype=torch.float64)
8 gae_duplicate tensor(-0.4217, dtype=torch.float64) tensor(3.5870, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4766, dtype=torch.float64) delta_t tensor(0.1934, dtype=torch.float64)
7 gae_duplicate tensor(0.0938, dtype=torch.float64) tensor(-3.2523, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0119, dtype=torch.float64) delta_t tensor(-0.0869, dtype=torch.float64)
6 gae_duplicate tensor(-0.3829, dtype=torch.float64) tensor(1.1144, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2281, dtype=torch.float64) delta_t tensor(0.1437, dtype=torch.float64)
5 gae_duplicate tensor(-0.8542, dtype=torch.float64) tensor(-1.8344, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8881, dtype=torch.float64) delta_t tensor(-0.8264, dtype=torch.float64)
4 gae_duplicate tensor(-4.4368, dtype=torch.float64) tensor(16.5167, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0116, dtype=torch.float64) delta_t tensor(0.6053, dtype=torch.float64)
3 gae_duplicate tensor(0.1590, dtype=torch.float64) tensor(-9.9941, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2390, dtype=torch.float64) delta_t tensor(-0.0664, dtype=torch.float64)
2 gae_duplicate tensor(-0.6526, dtype=torch.float64) tensor(1.2080, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-364.35845947265625
value loss:89.88672637939453
entropies:347.6276550292969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.3099730014801025 seconds
19 rew tensor(0.5192, dtype=torch.float64) delta_t tensor(0.1253, dtype=torch.float64)
19 gae_duplicate tensor(-0.0002, dtype=torch.float64) tensor(-2.5386, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4642, dtype=torch.float64) delta_t tensor(0.1447, dtype=torch.float64)
18 gae_duplicate tensor(-0.0096, dtype=torch.float64) tensor(-3.1619, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4935, dtype=torch.float64) delta_t tensor(0.1970, dtype=torch.float64)
17 gae_duplicate tensor(-0.0271, dtype=torch.float64) tensor(-3.7908, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4321, dtype=torch.float64) delta_t tensor(0.0157, dtype=torch.float64)
16 gae_duplicate tensor(-0.6325, dtype=torch.float64) tensor(-0.8856, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4614, dtype=torch.float64) delta_t tensor(-0.2381, dtype=torch.float64)
15 gae_duplicate tensor(-0.6167, dtype=torch.float64) tensor(4.7859, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3860, dtype=torch.float64) delta_t tensor(0.0303, dtype=torch.float64)
14 gae_duplicate tensor(-0.6033, dtype=torch.float64) tensor(-0.5488, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4627, dtype=torch.float64) delta_t tensor(-0.1328, dtype=torch.float64)
13 gae_duplicate tensor(-0.7383, dtype=torch.float64) tensor(2.0335, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3266, dtype=torch.float64) delta_t tensor(0.2727, dtype=torch.float64)
12 gae_duplicate tensor(0.0127, dtype=torch.float64) tensor(-4.5942, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4625, dtype=torch.float64) delta_t tensor(0.2718, dtype=torch.float64)
11 gae_duplicate tensor(0.0358, dtype=torch.float64) tensor(-5.8878, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3344, dtype=torch.float64) delta_t tensor(-0.0932, dtype=torch.float64)
10 gae_duplicate tensor(-1.3230, dtype=torch.float64) tensor(1.0065, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4570, dtype=torch.float64) delta_t tensor(0.1338, dtype=torch.float64)
9 gae_duplicate tensor(-0.1373, dtype=torch.float64) tensor(-2.6142, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2558, dtype=torch.float64) delta_t tensor(-0.0437, dtype=torch.float64)
8 gae_duplicate tensor(-0.4518, dtype=torch.float64) tensor(0.5207, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4045, dtype=torch.float64) delta_t tensor(0.1983, dtype=torch.float64)
7 gae_duplicate tensor(-0.0015, dtype=torch.float64) tensor(-3.3693, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1058, dtype=torch.float64) delta_t tensor(0.1925, dtype=torch.float64)
6 gae_duplicate tensor(-0.0854, dtype=torch.float64) tensor(-4.0960, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3487, dtype=torch.float64) delta_t tensor(0.7266, dtype=torch.float64)
5 gae_duplicate tensor(0.1294, dtype=torch.float64) tensor(-14.7164, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.4381, dtype=torch.float64) delta_t tensor(-1.8891, dtype=torch.float64)
4 gae_duplicate tensor(-3.6338, dtype=torch.float64) tensor(35.5742, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0260, dtype=torch.float64) delta_t tensor(0.1981, dtype=torch.float64)
3 gae_duplicate tensor(-0.7296, dtype=torch.float64) tensor(0.0244, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0260, dtype=torch.float64) delta_t tensor(0.6014, dtype=torch.float64)
2 gae_duplicate tensor(0.1948, dtype=torch.float64) tensor(-12.3648, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:695.675537109375
value loss:83.89070892333984
entropies:348.07904052734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.318451881408691 seconds
19 rew tensor(0.5134, dtype=torch.float64) delta_t tensor(0.1335, dtype=torch.float64)
19 gae_duplicate tensor(0.0291, dtype=torch.float64) tensor(-2.4957, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4009, dtype=torch.float64) delta_t tensor(0.0697, dtype=torch.float64)
18 gae_duplicate tensor(-0.1798, dtype=torch.float64) tensor(-1.4694, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4981, dtype=torch.float64) delta_t tensor(0.2392, dtype=torch.float64)
17 gae_duplicate tensor(0.0911, dtype=torch.float64) tensor(-4.6578, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3058, dtype=torch.float64) delta_t tensor(-0.2586, dtype=torch.float64)
16 gae_duplicate tensor(-0.5779, dtype=torch.float64) tensor(3.7850, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5069, dtype=torch.float64) delta_t tensor(-0.4388, dtype=torch.float64)
15 gae_duplicate tensor(-0.6688, dtype=torch.float64) tensor(9.0587, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2045, dtype=torch.float64) delta_t tensor(0.1268, dtype=torch.float64)
14 gae_duplicate tensor(-0.5691, dtype=torch.float64) tensor(-1.5166, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5276, dtype=torch.float64) delta_t tensor(0.2758, dtype=torch.float64)
13 gae_duplicate tensor(0.0920, dtype=torch.float64) tensor(-5.6650, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2246, dtype=torch.float64) delta_t tensor(0.0553, dtype=torch.float64)
12 gae_duplicate tensor(-0.1855, dtype=torch.float64) tensor(-1.7353, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5344, dtype=torch.float64) delta_t tensor(0.2619, dtype=torch.float64)
11 gae_duplicate tensor(0.2186, dtype=torch.float64) tensor(-5.1073, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2121, dtype=torch.float64) delta_t tensor(-0.0744, dtype=torch.float64)
10 gae_duplicate tensor(-0.2957, dtype=torch.float64) tensor(0.8542, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5150, dtype=torch.float64) delta_t tensor(0.0855, dtype=torch.float64)
9 gae_duplicate tensor(0.0172, dtype=torch.float64) tensor(-1.5784, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1464, dtype=torch.float64) delta_t tensor(-0.1998, dtype=torch.float64)
8 gae_duplicate tensor(-0.4365, dtype=torch.float64) tensor(3.8089, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4359, dtype=torch.float64) delta_t tensor(0.1814, dtype=torch.float64)
7 gae_duplicate tensor(0.0280, dtype=torch.float64) tensor(-3.0746, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0479, dtype=torch.float64) delta_t tensor(-0.0504, dtype=torch.float64)
6 gae_duplicate tensor(-0.2415, dtype=torch.float64) tensor(0.9958, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4698, dtype=torch.float64) delta_t tensor(0.2378, dtype=torch.float64)
5 gae_duplicate tensor(-0.6654, dtype=torch.float64) tensor(-4.5760, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.7195, dtype=torch.float64) delta_t tensor(-1.3538, dtype=torch.float64)
4 gae_duplicate tensor(-3.5653, dtype=torch.float64) tensor(24.7364, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0522, dtype=torch.float64) delta_t tensor(0.5550, dtype=torch.float64)
3 gae_duplicate tensor(-0.3042, dtype=torch.float64) tensor(-6.8987, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1177, dtype=torch.float64) delta_t tensor(0.2589, dtype=torch.float64)
2 gae_duplicate tensor(-0.3782, dtype=torch.float64) tensor(-5.2574, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-51.29530334472656
value loss:63.704341888427734
entropies:348.65081787109375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3920.9141)
ToM Target loss= tensor(3537.4297)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.413785219192505 seconds
19 rew tensor(0.5270, dtype=torch.float64) delta_t tensor(0.3022, dtype=torch.float64)
19 gae_duplicate tensor(0.1639, dtype=torch.float64) tensor(-5.7006, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3530, dtype=torch.float64) delta_t tensor(0.0593, dtype=torch.float64)
18 gae_duplicate tensor(-0.0509, dtype=torch.float64) tensor(-1.6741, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5205, dtype=torch.float64) delta_t tensor(0.2105, dtype=torch.float64)
17 gae_duplicate tensor(0.0967, dtype=torch.float64) tensor(-4.0206, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2617, dtype=torch.float64) delta_t tensor(-0.2010, dtype=torch.float64)
16 gae_duplicate tensor(-0.4178, dtype=torch.float64) tensor(3.3392, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5276, dtype=torch.float64) delta_t tensor(-0.0011, dtype=torch.float64)
15 gae_duplicate tensor(-0.6112, dtype=torch.float64) tensor(0.7455, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1893, dtype=torch.float64) delta_t tensor(-0.0328, dtype=torch.float64)
14 gae_duplicate tensor(-0.2141, dtype=torch.float64) tensor(0.5903, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5410, dtype=torch.float64) delta_t tensor(-0.0605, dtype=torch.float64)
13 gae_duplicate tensor(-0.5724, dtype=torch.float64) tensor(0.7837, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1695, dtype=torch.float64) delta_t tensor(0.1848, dtype=torch.float64)
12 gae_duplicate tensor(-0.1543, dtype=torch.float64) tensor(-3.3644, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5281, dtype=torch.float64) delta_t tensor(0.3518, dtype=torch.float64)
11 gae_duplicate tensor(0.2199, dtype=torch.float64) tensor(-7.2244, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1970, dtype=torch.float64) delta_t tensor(-0.0008, dtype=torch.float64)
10 gae_duplicate tensor(-0.2013, dtype=torch.float64) tensor(-0.7291, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5150, dtype=torch.float64) delta_t tensor(0.1586, dtype=torch.float64)
9 gae_duplicate tensor(-0.0245, dtype=torch.float64) tensor(-3.5612, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1310, dtype=torch.float64) delta_t tensor(-0.1554, dtype=torch.float64)
8 gae_duplicate tensor(-0.4536, dtype=torch.float64) tensor(2.4946, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5017, dtype=torch.float64) delta_t tensor(0.2316, dtype=torch.float64)
7 gae_duplicate tensor(0.0974, dtype=torch.float64) tensor(-4.0935, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0651, dtype=torch.float64) delta_t tensor(0.0434, dtype=torch.float64)
6 gae_duplicate tensor(-0.2364, dtype=torch.float64) tensor(-1.4130, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1275, dtype=torch.float64) delta_t tensor(0.6409, dtype=torch.float64)
5 gae_duplicate tensor(-0.3757, dtype=torch.float64) tensor(-11.9592, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8642, dtype=torch.float64) delta_t tensor(-0.7729, dtype=torch.float64)
4 gae_duplicate tensor(-5.0214, dtype=torch.float64) tensor(14.5664, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0439, dtype=torch.float64) delta_t tensor(0.6568, dtype=torch.float64)
3 gae_duplicate tensor(-0.3286, dtype=torch.float64) tensor(-11.7391, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2526, dtype=torch.float64) delta_t tensor(-0.1861, dtype=torch.float64)
2 gae_duplicate tensor(-0.8759, dtype=torch.float64) tensor(2.0299, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1575.986083984375
value loss:71.53780364990234
entropies:348.9278869628906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.320540904998779 seconds
19 rew tensor(0.4987, dtype=torch.float64) delta_t tensor(0.1018, dtype=torch.float64)
19 gae_duplicate tensor(-0.1255, dtype=torch.float64) tensor(-1.9435, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3430, dtype=torch.float64) delta_t tensor(-0.0630, dtype=torch.float64)
18 gae_duplicate tensor(-0.3174, dtype=torch.float64) tensor(1.1379, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4792, dtype=torch.float64) delta_t tensor(0.1222, dtype=torch.float64)
17 gae_duplicate tensor(-0.1203, dtype=torch.float64) tensor(-2.3614, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3170, dtype=torch.float64) delta_t tensor(-0.0334, dtype=torch.float64)
16 gae_duplicate tensor(-0.3076, dtype=torch.float64) tensor(0.3237, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4928, dtype=torch.float64) delta_t tensor(-0.1775, dtype=torch.float64)
15 gae_duplicate tensor(-0.6259, dtype=torch.float64) tensor(3.2770, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2413, dtype=torch.float64) delta_t tensor(-0.1227, dtype=torch.float64)
14 gae_duplicate tensor(-0.6635, dtype=torch.float64) tensor(2.6837, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5220, dtype=torch.float64) delta_t tensor(-0.3308, dtype=torch.float64)
13 gae_duplicate tensor(-0.7379, dtype=torch.float64) tensor(6.7658, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2061, dtype=torch.float64) delta_t tensor(0.1171, dtype=torch.float64)
12 gae_duplicate tensor(-0.0748, dtype=torch.float64) tensor(-1.6720, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5426, dtype=torch.float64) delta_t tensor(0.2534, dtype=torch.float64)
11 gae_duplicate tensor(0.1652, dtype=torch.float64) tensor(-5.1162, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2198, dtype=torch.float64) delta_t tensor(-0.0868, dtype=torch.float64)
10 gae_duplicate tensor(-0.1753, dtype=torch.float64) tensor(1.0555, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5429, dtype=torch.float64) delta_t tensor(0.1049, dtype=torch.float64)
9 gae_duplicate tensor(-0.0076, dtype=torch.float64) tensor(-1.8389, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1802, dtype=torch.float64) delta_t tensor(-0.1754, dtype=torch.float64)
8 gae_duplicate tensor(-0.2848, dtype=torch.float64) tensor(3.2195, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5030, dtype=torch.float64) delta_t tensor(0.1538, dtype=torch.float64)
7 gae_duplicate tensor(0.0733, dtype=torch.float64) tensor(-2.4710, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1407, dtype=torch.float64) delta_t tensor(-0.1606, dtype=torch.float64)
6 gae_duplicate tensor(-0.2769, dtype=torch.float64) tensor(2.8149, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5164, dtype=torch.float64) delta_t tensor(0.3415, dtype=torch.float64)
5 gae_duplicate tensor(-0.6870, dtype=torch.float64) tensor(-6.5302, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6703, dtype=torch.float64) delta_t tensor(-0.2486, dtype=torch.float64)
4 gae_duplicate tensor(-1.9856, dtype=torch.float64) tensor(1.6974, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1440, dtype=torch.float64) delta_t tensor(0.4039, dtype=torch.float64)
3 gae_duplicate tensor(-0.0913, dtype=torch.float64) tensor(-7.1913, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2230, dtype=torch.float64) delta_t tensor(-0.0170, dtype=torch.float64)
2 gae_duplicate tensor(-0.1974, dtype=torch.float64) tensor(-0.5873, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:269.4918518066406
value loss:41.00373458862305
entropies:349.1863098144531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.405654191970825 seconds
19 rew tensor(0.5486, dtype=torch.float64) delta_t tensor(0.0868, dtype=torch.float64)
19 gae_duplicate tensor(-0.0021, dtype=torch.float64) tensor(-1.6821, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3676, dtype=torch.float64) delta_t tensor(-0.1220, dtype=torch.float64)
18 gae_duplicate tensor(-0.2306, dtype=torch.float64) tensor(2.0896, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5295, dtype=torch.float64) delta_t tensor(0.1502, dtype=torch.float64)
17 gae_duplicate tensor(-0.0150, dtype=torch.float64) tensor(-2.4292, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3551, dtype=torch.float64) delta_t tensor(-0.0898, dtype=torch.float64)
16 gae_duplicate tensor(-0.1648, dtype=torch.float64) tensor(1.4400, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2237, dtype=torch.float64) delta_t tensor(-0.3862, dtype=torch.float64)
15 gae_duplicate tensor(-2.1383, dtype=torch.float64) tensor(7.7353, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2607, dtype=torch.float64) delta_t tensor(-0.2443, dtype=torch.float64)
14 gae_duplicate tensor(-0.7418, dtype=torch.float64) tensor(5.5028, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5165, dtype=torch.float64) delta_t tensor(-0.3056, dtype=torch.float64)
13 gae_duplicate tensor(-0.7842, dtype=torch.float64) tensor(6.9021, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2271, dtype=torch.float64) delta_t tensor(0.1241, dtype=torch.float64)
12 gae_duplicate tensor(-0.0978, dtype=torch.float64) tensor(-1.8944, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5433, dtype=torch.float64) delta_t tensor(0.2430, dtype=torch.float64)
11 gae_duplicate tensor(0.1666, dtype=torch.float64) tensor(-4.7804, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2343, dtype=torch.float64) delta_t tensor(-0.1062, dtype=torch.float64)
10 gae_duplicate tensor(-0.2433, dtype=torch.float64) tensor(1.4400, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5436, dtype=torch.float64) delta_t tensor(0.0490, dtype=torch.float64)
9 gae_duplicate tensor(-0.0258, dtype=torch.float64) tensor(-0.7703, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1946, dtype=torch.float64) delta_t tensor(-0.2073, dtype=torch.float64)
8 gae_duplicate tensor(-0.3813, dtype=torch.float64) tensor(4.2557, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4519, dtype=torch.float64) delta_t tensor(0.0803, dtype=torch.float64)
7 gae_duplicate tensor(-0.0191, dtype=torch.float64) tensor(-1.2376, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1031, dtype=torch.float64) delta_t tensor(-0.0003, dtype=torch.float64)
6 gae_duplicate tensor(-0.2167, dtype=torch.float64) tensor(-0.2352, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2762, dtype=torch.float64) delta_t tensor(0.5730, dtype=torch.float64)
5 gae_duplicate tensor(0.1487, dtype=torch.float64) tensor(-11.0608, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8963, dtype=torch.float64) delta_t tensor(-0.5973, dtype=torch.float64)
4 gae_duplicate tensor(-3.3296, dtype=torch.float64) tensor(10.4380, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0356, dtype=torch.float64) delta_t tensor(0.2532, dtype=torch.float64)
3 gae_duplicate tensor(-0.3074, dtype=torch.float64) tensor(-3.9701, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2251, dtype=torch.float64) delta_t tensor(0.0359, dtype=torch.float64)
2 gae_duplicate tensor(-0.7353, dtype=torch.float64) tensor(-0.7437, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-688.4127197265625
value loss:56.203182220458984
entropies:349.6969299316406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.439969062805176 seconds
19 rew tensor(0.5085, dtype=torch.float64) delta_t tensor(0.2984, dtype=torch.float64)
19 gae_duplicate tensor(0.0815, dtype=torch.float64) tensor(-6.1671, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4360, dtype=torch.float64) delta_t tensor(-0.0378, dtype=torch.float64)
18 gae_duplicate tensor(-0.1621, dtype=torch.float64) tensor(0.0324, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4973, dtype=torch.float64) delta_t tensor(0.0357, dtype=torch.float64)
17 gae_duplicate tensor(-0.2471, dtype=torch.float64) tensor(-1.0761, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3045, dtype=torch.float64) delta_t tensor(-0.2082, dtype=torch.float64)
16 gae_duplicate tensor(-0.4879, dtype=torch.float64) tensor(4.3137, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4373, dtype=torch.float64) delta_t tensor(-0.0980, dtype=torch.float64)
15 gae_duplicate tensor(-0.7606, dtype=torch.float64) tensor(1.9841, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1979, dtype=torch.float64) delta_t tensor(0.1807, dtype=torch.float64)
14 gae_duplicate tensor(-0.4267, dtype=torch.float64) tensor(-3.5394, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5246, dtype=torch.float64) delta_t tensor(-0.0283, dtype=torch.float64)
13 gae_duplicate tensor(-0.7085, dtype=torch.float64) tensor(0.2727, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0996, dtype=torch.float64) delta_t tensor(0.1097, dtype=torch.float64)
12 gae_duplicate tensor(-0.1779, dtype=torch.float64) tensor(-2.0546, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5445, dtype=torch.float64) delta_t tensor(0.2637, dtype=torch.float64)
11 gae_duplicate tensor(0.1097, dtype=torch.float64) tensor(-5.0432, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1132, dtype=torch.float64) delta_t tensor(-0.3751, dtype=torch.float64)
10 gae_duplicate tensor(-1.5839, dtype=torch.float64) tensor(5.8934, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5180, dtype=torch.float64) delta_t tensor(0.0599, dtype=torch.float64)
9 gae_duplicate tensor(-0.1453, dtype=torch.float64) tensor(-0.5094, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0468, dtype=torch.float64) delta_t tensor(-0.3457, dtype=torch.float64)
8 gae_duplicate tensor(-0.5997, dtype=torch.float64) tensor(6.2689, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4913, dtype=torch.float64) delta_t tensor(0.1906, dtype=torch.float64)
7 gae_duplicate tensor(-0.0109, dtype=torch.float64) tensor(-3.0084, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0329, dtype=torch.float64) delta_t tensor(-0.0984, dtype=torch.float64)
6 gae_duplicate tensor(-0.3354, dtype=torch.float64) tensor(1.5937, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6291, dtype=torch.float64) delta_t tensor(0.2511, dtype=torch.float64)
5 gae_duplicate tensor(-1.1510, dtype=torch.float64) tensor(-4.7736, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1474, dtype=torch.float64) delta_t tensor(-1.0582, dtype=torch.float64)
4 gae_duplicate tensor(-3.4777, dtype=torch.float64) tensor(19.8884, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1049, dtype=torch.float64) delta_t tensor(0.4358, dtype=torch.float64)
3 gae_duplicate tensor(-0.0780, dtype=torch.float64) tensor(-6.4839, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1705, dtype=torch.float64) delta_t tensor(0.1459, dtype=torch.float64)
2 gae_duplicate tensor(-0.2837, dtype=torch.float64) tensor(-3.2013, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-331.55987548828125
value loss:55.16506576538086
entropies:349.91314697265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.622269868850708 seconds
19 rew tensor(0.4840, dtype=torch.float64) delta_t tensor(-0.0066, dtype=torch.float64)
19 gae_duplicate tensor(-0.1618, dtype=torch.float64) tensor(0.2010, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4231, dtype=torch.float64) delta_t tensor(-0.0263, dtype=torch.float64)
18 gae_duplicate tensor(-0.2546, dtype=torch.float64) tensor(0.5750, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4845, dtype=torch.float64) delta_t tensor(0.0408, dtype=torch.float64)
17 gae_duplicate tensor(-0.1262, dtype=torch.float64) tensor(-0.8068, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4230, dtype=torch.float64) delta_t tensor(-0.0735, dtype=torch.float64)
16 gae_duplicate tensor(-0.4732, dtype=torch.float64) tensor(1.3491, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4050, dtype=torch.float64) delta_t tensor(-0.1517, dtype=torch.float64)
15 gae_duplicate tensor(-0.5638, dtype=torch.float64) tensor(3.1803, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3046, dtype=torch.float64) delta_t tensor(0.1302, dtype=torch.float64)
14 gae_duplicate tensor(-0.4669, dtype=torch.float64) tensor(-2.8308, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1252, dtype=torch.float64) delta_t tensor(-0.5838, dtype=torch.float64)
13 gae_duplicate tensor(-2.8867, dtype=torch.float64) tensor(12.6913, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1654, dtype=torch.float64) delta_t tensor(0.0914, dtype=torch.float64)
12 gae_duplicate tensor(-0.1713, dtype=torch.float64) tensor(-0.6431, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5452, dtype=torch.float64) delta_t tensor(0.2661, dtype=torch.float64)
11 gae_duplicate tensor(0.1635, dtype=torch.float64) tensor(-5.1906, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1726, dtype=torch.float64) delta_t tensor(-0.1599, dtype=torch.float64)
10 gae_duplicate tensor(-0.4668, dtype=torch.float64) tensor(2.3959, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5322, dtype=torch.float64) delta_t tensor(0.0881, dtype=torch.float64)
9 gae_duplicate tensor(-0.0344, dtype=torch.float64) tensor(-1.5638, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1196, dtype=torch.float64) delta_t tensor(-0.2444, dtype=torch.float64)
8 gae_duplicate tensor(-0.5538, dtype=torch.float64) tensor(4.5820, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5053, dtype=torch.float64) delta_t tensor(0.1040, dtype=torch.float64)
7 gae_duplicate tensor(-0.0658, dtype=torch.float64) tensor(-1.6066, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0665, dtype=torch.float64) delta_t tensor(-0.1258, dtype=torch.float64)
6 gae_duplicate tensor(-0.4435, dtype=torch.float64) tensor(2.2491, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9727, dtype=torch.float64) delta_t tensor(0.5902, dtype=torch.float64)
5 gae_duplicate tensor(-0.6575, dtype=torch.float64) tensor(-12.1111, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2454, dtype=torch.float64) delta_t tensor(-0.0254, dtype=torch.float64)
4 gae_duplicate tensor(-4.1606, dtype=torch.float64) tensor(-0.6005, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0373, dtype=torch.float64) delta_t tensor(0.5347, dtype=torch.float64)
3 gae_duplicate tensor(0.3040, dtype=torch.float64) tensor(-9.7005, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2210, dtype=torch.float64) delta_t tensor(-0.1197, dtype=torch.float64)
2 gae_duplicate tensor(-0.6659, dtype=torch.float64) tensor(1.4024, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:252.48873901367188
value loss:77.74479675292969
entropies:350.37115478515625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3910.2700)
ToM Target loss= tensor(3545.4817)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.499713897705078 seconds
19 rew tensor(0.5238, dtype=torch.float64) delta_t tensor(0.0527, dtype=torch.float64)
19 gae_duplicate tensor(0.0147, dtype=torch.float64) tensor(-0.9664, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3787, dtype=torch.float64) delta_t tensor(-0.1187, dtype=torch.float64)
18 gae_duplicate tensor(-0.2310, dtype=torch.float64) tensor(2.1238, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5374, dtype=torch.float64) delta_t tensor(0.1877, dtype=torch.float64)
17 gae_duplicate tensor(0.0187, dtype=torch.float64) tensor(-3.7297, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3515, dtype=torch.float64) delta_t tensor(-0.0700, dtype=torch.float64)
16 gae_duplicate tensor(-0.3403, dtype=torch.float64) tensor(1.0191, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4828, dtype=torch.float64) delta_t tensor(-0.1584, dtype=torch.float64)
15 gae_duplicate tensor(-0.4409, dtype=torch.float64) tensor(3.2913, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2631, dtype=torch.float64) delta_t tensor(0.2677, dtype=torch.float64)
14 gae_duplicate tensor(-0.4608, dtype=torch.float64) tensor(-4.8381, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5248, dtype=torch.float64) delta_t tensor(-0.0102, dtype=torch.float64)
13 gae_duplicate tensor(-0.5272, dtype=torch.float64) tensor(-0.0318, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2484, dtype=torch.float64) delta_t tensor(0.1170, dtype=torch.float64)
12 gae_duplicate tensor(-0.0480, dtype=torch.float64) tensor(-2.2231, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5457, dtype=torch.float64) delta_t tensor(0.2549, dtype=torch.float64)
11 gae_duplicate tensor(0.1793, dtype=torch.float64) tensor(-5.3336, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2489, dtype=torch.float64) delta_t tensor(-0.0796, dtype=torch.float64)
10 gae_duplicate tensor(-0.2115, dtype=torch.float64) tensor(0.9362, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5460, dtype=torch.float64) delta_t tensor(0.0796, dtype=torch.float64)
9 gae_duplicate tensor(-0.0551, dtype=torch.float64) tensor(-1.4535, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2091, dtype=torch.float64) delta_t tensor(-0.1837, dtype=torch.float64)
8 gae_duplicate tensor(-0.3354, dtype=torch.float64) tensor(3.3652, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5059, dtype=torch.float64) delta_t tensor(0.0832, dtype=torch.float64)
7 gae_duplicate tensor(-0.0249, dtype=torch.float64) tensor(-1.2646, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1693, dtype=torch.float64) delta_t tensor(-0.1993, dtype=torch.float64)
6 gae_duplicate tensor(-0.3544, dtype=torch.float64) tensor(4.0889, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6265, dtype=torch.float64) delta_t tensor(0.0754, dtype=torch.float64)
5 gae_duplicate tensor(-1.4482, dtype=torch.float64) tensor(-0.6609, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5326, dtype=torch.float64) delta_t tensor(-0.9475, dtype=torch.float64)
4 gae_duplicate tensor(-2.9089, dtype=torch.float64) tensor(19.2771, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0405, dtype=torch.float64) delta_t tensor(0.3232, dtype=torch.float64)
3 gae_duplicate tensor(-0.1699, dtype=torch.float64) tensor(-4.1758, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2014, dtype=torch.float64) delta_t tensor(-0.0070, dtype=torch.float64)
2 gae_duplicate tensor(-0.4803, dtype=torch.float64) tensor(-0.2596, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-589.5206298828125
value loss:45.62751007080078
entropies:350.5560607910156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.4883809089660645 seconds
19 rew tensor(0.5299, dtype=torch.float64) delta_t tensor(0.1563, dtype=torch.float64)
19 gae_duplicate tensor(-0.0376, dtype=torch.float64) tensor(-3.1246, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3749, dtype=torch.float64) delta_t tensor(-0.0067, dtype=torch.float64)
18 gae_duplicate tensor(-0.2263, dtype=torch.float64) tensor(-0.1580, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5040, dtype=torch.float64) delta_t tensor(0.1679, dtype=torch.float64)
17 gae_duplicate tensor(0.0622, dtype=torch.float64) tensor(-3.2496, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3557, dtype=torch.float64) delta_t tensor(0.0092, dtype=torch.float64)
16 gae_duplicate tensor(-0.3664, dtype=torch.float64) tensor(-0.6708, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5236, dtype=torch.float64) delta_t tensor(-0.1023, dtype=torch.float64)
15 gae_duplicate tensor(-0.4253, dtype=torch.float64) tensor(2.0565, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2438, dtype=torch.float64) delta_t tensor(0.0567, dtype=torch.float64)
14 gae_duplicate tensor(-0.4194, dtype=torch.float64) tensor(-0.8909, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5310, dtype=torch.float64) delta_t tensor(0.3163, dtype=torch.float64)
13 gae_duplicate tensor(-0.1405, dtype=torch.float64) tensor(-6.1712, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1043, dtype=torch.float64) delta_t tensor(0.0012, dtype=torch.float64)
12 gae_duplicate tensor(-0.3280, dtype=torch.float64) tensor(-0.7157, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5377, dtype=torch.float64) delta_t tensor(0.3016, dtype=torch.float64)
11 gae_duplicate tensor(0.1631, dtype=torch.float64) tensor(-5.9432, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2518, dtype=torch.float64) delta_t tensor(0.0312, dtype=torch.float64)
10 gae_duplicate tensor(-0.2051, dtype=torch.float64) tensor(-1.3306, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4921, dtype=torch.float64) delta_t tensor(0.0498, dtype=torch.float64)
9 gae_duplicate tensor(-0.0713, dtype=torch.float64) tensor(-1.0675, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1595, dtype=torch.float64) delta_t tensor(-0.2283, dtype=torch.float64)
8 gae_duplicate tensor(-0.5093, dtype=torch.float64) tensor(3.9755, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5047, dtype=torch.float64) delta_t tensor(0.1477, dtype=torch.float64)
7 gae_duplicate tensor(-0.0606, dtype=torch.float64) tensor(-2.4767, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0673, dtype=torch.float64) delta_t tensor(-0.1173, dtype=torch.float64)
6 gae_duplicate tensor(-0.2846, dtype=torch.float64) tensor(1.9334, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5091, dtype=torch.float64) delta_t tensor(0.3051, dtype=torch.float64)
5 gae_duplicate tensor(-0.3280, dtype=torch.float64) tensor(-5.3458, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0679, dtype=torch.float64) delta_t tensor(-1.3801, dtype=torch.float64)
4 gae_duplicate tensor(-3.5422, dtype=torch.float64) tensor(23.7360, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0035, dtype=torch.float64) delta_t tensor(0.3249, dtype=torch.float64)
3 gae_duplicate tensor(-0.3279, dtype=torch.float64) tensor(-3.9889, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1434, dtype=torch.float64) delta_t tensor(0.1698, dtype=torch.float64)
2 gae_duplicate tensor(-0.6976, dtype=torch.float64) tensor(-2.5600, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:228.94960021972656
value loss:62.78516387939453
entropies:350.4635925292969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.712996959686279 seconds
19 rew tensor(0.5491, dtype=torch.float64) delta_t tensor(0.1846, dtype=torch.float64)
19 gae_duplicate tensor(-0.0478, dtype=torch.float64) tensor(-3.2908, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3601, dtype=torch.float64) delta_t tensor(-0.0773, dtype=torch.float64)
18 gae_duplicate tensor(-0.2778, dtype=torch.float64) tensor(1.3428, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5363, dtype=torch.float64) delta_t tensor(0.1261, dtype=torch.float64)
17 gae_duplicate tensor(-0.1843, dtype=torch.float64) tensor(-2.0330, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3278, dtype=torch.float64) delta_t tensor(-0.2178, dtype=torch.float64)
16 gae_duplicate tensor(-0.4864, dtype=torch.float64) tensor(3.9385, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5237, dtype=torch.float64) delta_t tensor(0.2152, dtype=torch.float64)
15 gae_duplicate tensor(-0.1733, dtype=torch.float64) tensor(-3.9516, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3216, dtype=torch.float64) delta_t tensor(0.0358, dtype=torch.float64)
14 gae_duplicate tensor(-0.4080, dtype=torch.float64) tensor(-0.7318, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4715, dtype=torch.float64) delta_t tensor(0.1304, dtype=torch.float64)
13 gae_duplicate tensor(-0.4105, dtype=torch.float64) tensor(-2.7692, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3214, dtype=torch.float64) delta_t tensor(0.2261, dtype=torch.float64)
12 gae_duplicate tensor(-0.0451, dtype=torch.float64) tensor(-4.2501, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4780, dtype=torch.float64) delta_t tensor(0.2355, dtype=torch.float64)
11 gae_duplicate tensor(0.0162, dtype=torch.float64) tensor(-5.2328, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3357, dtype=torch.float64) delta_t tensor(0.0285, dtype=torch.float64)
10 gae_duplicate tensor(-0.1366, dtype=torch.float64) tensor(-0.9797, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4592, dtype=torch.float64) delta_t tensor(0.0407, dtype=torch.float64)
9 gae_duplicate tensor(-0.1797, dtype=torch.float64) tensor(-0.9946, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2436, dtype=torch.float64) delta_t tensor(-0.1414, dtype=torch.float64)
8 gae_duplicate tensor(-0.3731, dtype=torch.float64) tensor(2.6940, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4130, dtype=torch.float64) delta_t tensor(0.0833, dtype=torch.float64)
7 gae_duplicate tensor(-0.0183, dtype=torch.float64) tensor(-1.3885, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0929, dtype=torch.float64) delta_t tensor(0.0136, dtype=torch.float64)
6 gae_duplicate tensor(-0.3854, dtype=torch.float64) tensor(-0.2186, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3792, dtype=torch.float64) delta_t tensor(0.1540, dtype=torch.float64)
5 gae_duplicate tensor(-2.3623, dtype=torch.float64) tensor(-4.3858, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0577, dtype=torch.float64) delta_t tensor(-1.5766, dtype=torch.float64)
4 gae_duplicate tensor(-3.2134, dtype=torch.float64) tensor(31.0843, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0635, dtype=torch.float64) delta_t tensor(0.4638, dtype=torch.float64)
3 gae_duplicate tensor(-0.5450, dtype=torch.float64) tensor(-5.4457, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1616, dtype=torch.float64) delta_t tensor(0.1953, dtype=torch.float64)
2 gae_duplicate tensor(-0.7802, dtype=torch.float64) tensor(-4.4060, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-39.66768264770508
value loss:67.00460052490234
entropies:350.64013671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.295238971710205 seconds
19 rew tensor(0.4949, dtype=torch.float64) delta_t tensor(0.0661, dtype=torch.float64)
19 gae_duplicate tensor(-0.1344, dtype=torch.float64) tensor(-1.0652, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5102, dtype=torch.float64) delta_t tensor(0.0659, dtype=torch.float64)
18 gae_duplicate tensor(-0.1193, dtype=torch.float64) tensor(-1.3914, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4690, dtype=torch.float64) delta_t tensor(0.0893, dtype=torch.float64)
17 gae_duplicate tensor(-0.1612, dtype=torch.float64) tensor(-1.7530, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2877, dtype=torch.float64) delta_t tensor(-0.1761, dtype=torch.float64)
16 gae_duplicate tensor(-0.4756, dtype=torch.float64) tensor(2.9591, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4970, dtype=torch.float64) delta_t tensor(-0.2853, dtype=torch.float64)
15 gae_duplicate tensor(-0.3924, dtype=torch.float64) tensor(5.9514, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1939, dtype=torch.float64) delta_t tensor(0.2292, dtype=torch.float64)
14 gae_duplicate tensor(-0.1873, dtype=torch.float64) tensor(-3.7302, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5243, dtype=torch.float64) delta_t tensor(0.3834, dtype=torch.float64)
13 gae_duplicate tensor(0.2614, dtype=torch.float64) tensor(-7.8976, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1558, dtype=torch.float64) delta_t tensor(-0.0598, dtype=torch.float64)
12 gae_duplicate tensor(-0.2212, dtype=torch.float64) tensor(0.3284, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5441, dtype=torch.float64) delta_t tensor(0.2310, dtype=torch.float64)
11 gae_duplicate tensor(0.1580, dtype=torch.float64) tensor(-4.7655, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1431, dtype=torch.float64) delta_t tensor(-0.1793, dtype=torch.float64)
10 gae_duplicate tensor(-0.3180, dtype=torch.float64) tensor(2.9942, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5443, dtype=torch.float64) delta_t tensor(0.0536, dtype=torch.float64)
9 gae_duplicate tensor(-0.0432, dtype=torch.float64) tensor(-0.6815, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1034, dtype=torch.float64) delta_t tensor(-0.2894, dtype=torch.float64)
8 gae_duplicate tensor(-0.4798, dtype=torch.float64) tensor(5.4583, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4526, dtype=torch.float64) delta_t tensor(0.1083, dtype=torch.float64)
7 gae_duplicate tensor(-0.0836, dtype=torch.float64) tensor(-1.5991, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0120, dtype=torch.float64) delta_t tensor(-0.1490, dtype=torch.float64)
6 gae_duplicate tensor(-0.4227, dtype=torch.float64) tensor(2.5958, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4778, dtype=torch.float64) delta_t tensor(0.2706, dtype=torch.float64)
5 gae_duplicate tensor(-0.5932, dtype=torch.float64) tensor(-5.0849, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6837, dtype=torch.float64) delta_t tensor(-0.2924, dtype=torch.float64)
4 gae_duplicate tensor(-4.0354, dtype=torch.float64) tensor(4.4835, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0886, dtype=torch.float64) delta_t tensor(0.5109, dtype=torch.float64)
3 gae_duplicate tensor(-0.1303, dtype=torch.float64) tensor(-9.4712, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1687, dtype=torch.float64) delta_t tensor(0.2234, dtype=torch.float64)
2 gae_duplicate tensor(-0.0604, dtype=torch.float64) tensor(-5.9563, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:911.1138916015625
value loss:63.936851501464844
entropies:350.54144287109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1544349193573 seconds
19 rew tensor(0.5370, dtype=torch.float64) delta_t tensor(0.1250, dtype=torch.float64)
19 gae_duplicate tensor(0.0213, dtype=torch.float64) tensor(-2.5216, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3813, dtype=torch.float64) delta_t tensor(-0.0583, dtype=torch.float64)
18 gae_duplicate tensor(-0.2225, dtype=torch.float64) tensor(0.8126, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5101, dtype=torch.float64) delta_t tensor(0.0762, dtype=torch.float64)
17 gae_duplicate tensor(-0.1188, dtype=torch.float64) tensor(-1.3744, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3473, dtype=torch.float64) delta_t tensor(0.0325, dtype=torch.float64)
16 gae_duplicate tensor(-0.2924, dtype=torch.float64) tensor(-0.5833, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4851, dtype=torch.float64) delta_t tensor(-0.1203, dtype=torch.float64)
15 gae_duplicate tensor(-0.3656, dtype=torch.float64) tensor(1.9439, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2028, dtype=torch.float64) delta_t tensor(0.2795, dtype=torch.float64)
14 gae_duplicate tensor(-0.2936, dtype=torch.float64) tensor(-5.2168, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5243, dtype=torch.float64) delta_t tensor(0.2835, dtype=torch.float64)
13 gae_duplicate tensor(-0.3669, dtype=torch.float64) tensor(-6.2301, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1637, dtype=torch.float64) delta_t tensor(-0.0371, dtype=torch.float64)
12 gae_duplicate tensor(-0.2415, dtype=torch.float64) tensor(0.2147, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5447, dtype=torch.float64) delta_t tensor(0.2072, dtype=torch.float64)
11 gae_duplicate tensor(0.1326, dtype=torch.float64) tensor(-4.0549, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1710, dtype=torch.float64) delta_t tensor(-0.1922, dtype=torch.float64)
10 gae_duplicate tensor(-0.3128, dtype=torch.float64) tensor(3.4937, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5449, dtype=torch.float64) delta_t tensor(0.0180, dtype=torch.float64)
9 gae_duplicate tensor(-0.0805, dtype=torch.float64) tensor(0.0168, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1312, dtype=torch.float64) delta_t tensor(-0.2781, dtype=torch.float64)
8 gae_duplicate tensor(-0.4760, dtype=torch.float64) tensor(5.5945, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5048, dtype=torch.float64) delta_t tensor(0.0712, dtype=torch.float64)
7 gae_duplicate tensor(-0.0845, dtype=torch.float64) tensor(-0.8054, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0914, dtype=torch.float64) delta_t tensor(-0.2566, dtype=torch.float64)
6 gae_duplicate tensor(-0.3184, dtype=torch.float64) tensor(5.1089, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2298, dtype=torch.float64) delta_t tensor(0.1442, dtype=torch.float64)
5 gae_duplicate tensor(-0.7878, dtype=torch.float64) tensor(-2.9566, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0246, dtype=torch.float64) delta_t tensor(0.3401, dtype=torch.float64)
4 gae_duplicate tensor(-2.7269, dtype=torch.float64) tensor(-9.1369, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0664, dtype=torch.float64) delta_t tensor(0.6158, dtype=torch.float64)
3 gae_duplicate tensor(0.2587, dtype=torch.float64) tensor(-13.0705, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1976, dtype=torch.float64) delta_t tensor(-0.0819, dtype=torch.float64)
2 gae_duplicate tensor(-0.3861, dtype=torch.float64) tensor(0.1841, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1448.706787109375
value loss:48.506317138671875
entropies:350.7191162109375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3935.5198)
ToM Target loss= tensor(3540.9849)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.107064962387085 seconds
19 rew tensor(0.5434, dtype=torch.float64) delta_t tensor(0.0354, dtype=torch.float64)
19 gae_duplicate tensor(-0.0181, dtype=torch.float64) tensor(-0.6891, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3421, dtype=torch.float64) delta_t tensor(-0.1275, dtype=torch.float64)
18 gae_duplicate tensor(-0.2603, dtype=torch.float64) tensor(2.3805, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5175, dtype=torch.float64) delta_t tensor(0.1511, dtype=torch.float64)
17 gae_duplicate tensor(0.0101, dtype=torch.float64) tensor(-2.6897, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3027, dtype=torch.float64) delta_t tensor(-0.1134, dtype=torch.float64)
16 gae_duplicate tensor(-0.3209, dtype=torch.float64) tensor(2.0444, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4899, dtype=torch.float64) delta_t tensor(-0.1773, dtype=torch.float64)
15 gae_duplicate tensor(-0.3542, dtype=torch.float64) tensor(3.4921, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2430, dtype=torch.float64) delta_t tensor(0.2958, dtype=torch.float64)
14 gae_duplicate tensor(-0.3000, dtype=torch.float64) tensor(-5.5944, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5378, dtype=torch.float64) delta_t tensor(0.2694, dtype=torch.float64)
13 gae_duplicate tensor(-0.2811, dtype=torch.float64) tensor(-5.5138, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2164, dtype=torch.float64) delta_t tensor(0.0476, dtype=torch.float64)
12 gae_duplicate tensor(-0.1373, dtype=torch.float64) tensor(-1.4237, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5446, dtype=torch.float64) delta_t tensor(0.1219, dtype=torch.float64)
11 gae_duplicate tensor(-0.1030, dtype=torch.float64) tensor(-2.4372, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2235, dtype=torch.float64) delta_t tensor(-0.1203, dtype=torch.float64)
10 gae_duplicate tensor(-0.2803, dtype=torch.float64) tensor(2.2104, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5448, dtype=torch.float64) delta_t tensor(0.0329, dtype=torch.float64)
9 gae_duplicate tensor(-0.0847, dtype=torch.float64) tensor(-0.3001, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1837, dtype=torch.float64) delta_t tensor(-0.2207, dtype=torch.float64)
8 gae_duplicate tensor(-0.4087, dtype=torch.float64) tensor(4.0062, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5048, dtype=torch.float64) delta_t tensor(0.0536, dtype=torch.float64)
7 gae_duplicate tensor(-0.1146, dtype=torch.float64) tensor(-0.6194, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1438, dtype=torch.float64) delta_t tensor(-0.2326, dtype=torch.float64)
6 gae_duplicate tensor(-0.3413, dtype=torch.float64) tensor(4.1929, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9886, dtype=torch.float64) delta_t tensor(0.3251, dtype=torch.float64)
5 gae_duplicate tensor(-0.8619, dtype=torch.float64) tensor(-6.0532, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.2653, dtype=torch.float64) delta_t tensor(-1.0380, dtype=torch.float64)
4 gae_duplicate tensor(-4.2185, dtype=torch.float64) tensor(17.4276, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0832, dtype=torch.float64) delta_t tensor(0.4739, dtype=torch.float64)
3 gae_duplicate tensor(-0.1104, dtype=torch.float64) tensor(-7.0808, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2763, dtype=torch.float64) delta_t tensor(-0.0485, dtype=torch.float64)
2 gae_duplicate tensor(-0.4053, dtype=torch.float64) tensor(0.4010, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-297.5078125
value loss:62.01551818847656
entropies:351.12481689453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 6.0402960777282715 seconds
19 rew tensor(0.4956, dtype=torch.float64) delta_t tensor(0.0356, dtype=torch.float64)
19 gae_duplicate tensor(-0.1678, dtype=torch.float64) tensor(-0.6233, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4634, dtype=torch.float64) delta_t tensor(0.0211, dtype=torch.float64)
18 gae_duplicate tensor(-0.1218, dtype=torch.float64) tensor(-0.4207, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4413, dtype=torch.float64) delta_t tensor(0.0606, dtype=torch.float64)
17 gae_duplicate tensor(-0.1090, dtype=torch.float64) tensor(-1.1524, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4094, dtype=torch.float64) delta_t tensor(0.1259, dtype=torch.float64)
16 gae_duplicate tensor(-0.2533, dtype=torch.float64) tensor(-2.4595, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4555, dtype=torch.float64) delta_t tensor(-0.2194, dtype=torch.float64)
15 gae_duplicate tensor(-0.3750, dtype=torch.float64) tensor(4.2006, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2595, dtype=torch.float64) delta_t tensor(0.1705, dtype=torch.float64)
14 gae_duplicate tensor(-0.1612, dtype=torch.float64) tensor(-3.1826, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5106, dtype=torch.float64) delta_t tensor(0.1517, dtype=torch.float64)
13 gae_duplicate tensor(-0.1456, dtype=torch.float64) tensor(-3.1956, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1731, dtype=torch.float64) delta_t tensor(0.0176, dtype=torch.float64)
12 gae_duplicate tensor(-0.2492, dtype=torch.float64) tensor(-0.7472, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5372, dtype=torch.float64) delta_t tensor(0.2189, dtype=torch.float64)
11 gae_duplicate tensor(0.0928, dtype=torch.float64) tensor(-4.0958, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1538, dtype=torch.float64) delta_t tensor(-0.1732, dtype=torch.float64)
10 gae_duplicate tensor(-0.3079, dtype=torch.float64) tensor(3.0648, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5302, dtype=torch.float64) delta_t tensor(0.0112, dtype=torch.float64)
9 gae_duplicate tensor(-0.1111, dtype=torch.float64) tensor(0.0709, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1003, dtype=torch.float64) delta_t tensor(-0.3179, dtype=torch.float64)
8 gae_duplicate tensor(-0.6078, dtype=torch.float64) tensor(6.0474, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5039, dtype=torch.float64) delta_t tensor(0.0583, dtype=torch.float64)
7 gae_duplicate tensor(-0.1545, dtype=torch.float64) tensor(-0.4451, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0469, dtype=torch.float64) delta_t tensor(-0.2733, dtype=torch.float64)
6 gae_duplicate tensor(-0.4035, dtype=torch.float64) tensor(5.3387, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0813, dtype=torch.float64) delta_t tensor(0.3521, dtype=torch.float64)
5 gae_duplicate tensor(-0.5812, dtype=torch.float64) tensor(-5.7594, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9384, dtype=torch.float64) delta_t tensor(-1.4094, dtype=torch.float64)
4 gae_duplicate tensor(-4.5197, dtype=torch.float64) tensor(27.5832, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0764, dtype=torch.float64) delta_t tensor(0.3116, dtype=torch.float64)
3 gae_duplicate tensor(-0.3376, dtype=torch.float64) tensor(-3.1348, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1817, dtype=torch.float64) delta_t tensor(0.1609, dtype=torch.float64)
2 gae_duplicate tensor(-0.1421, dtype=torch.float64) tensor(-3.4006, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1050.148681640625
value loss:71.0063705444336
entropies:351.6954345703125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.267656087875366 seconds
19 rew tensor(0.5155, dtype=torch.float64) delta_t tensor(0.0166, dtype=torch.float64)
19 gae_duplicate tensor(-0.1718, dtype=torch.float64) tensor(-0.4368, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4145, dtype=torch.float64) delta_t tensor(-0.0260, dtype=torch.float64)
18 gae_duplicate tensor(-0.1662, dtype=torch.float64) tensor(0.5629, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4830, dtype=torch.float64) delta_t tensor(0.0464, dtype=torch.float64)
17 gae_duplicate tensor(-0.1476, dtype=torch.float64) tensor(-0.9154, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3755, dtype=torch.float64) delta_t tensor(-0.0579, dtype=torch.float64)
16 gae_duplicate tensor(-0.3387, dtype=torch.float64) tensor(0.6351, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4550, dtype=torch.float64) delta_t tensor(-0.2161, dtype=torch.float64)
15 gae_duplicate tensor(-0.3052, dtype=torch.float64) tensor(4.4173, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2272, dtype=torch.float64) delta_t tensor(0.3789, dtype=torch.float64)
14 gae_duplicate tensor(0.0761, dtype=torch.float64) tensor(-7.2331, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5370, dtype=torch.float64) delta_t tensor(0.3602, dtype=torch.float64)
13 gae_duplicate tensor(0.1164, dtype=torch.float64) tensor(-7.6727, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1523, dtype=torch.float64) delta_t tensor(-0.1201, dtype=torch.float64)
12 gae_duplicate tensor(-0.2616, dtype=torch.float64) tensor(1.4678, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5440, dtype=torch.float64) delta_t tensor(0.1498, dtype=torch.float64)
11 gae_duplicate tensor(0.0623, dtype=torch.float64) tensor(-2.8185, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1527, dtype=torch.float64) delta_t tensor(-0.1865, dtype=torch.float64)
10 gae_duplicate tensor(-0.3751, dtype=torch.float64) tensor(3.3884, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5044, dtype=torch.float64) delta_t tensor(-0.0443, dtype=torch.float64)
9 gae_duplicate tensor(-0.1625, dtype=torch.float64) tensor(1.2726, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0731, dtype=torch.float64) delta_t tensor(-0.3036, dtype=torch.float64)
8 gae_duplicate tensor(-0.5158, dtype=torch.float64) tensor(5.8934, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5040, dtype=torch.float64) delta_t tensor(0.1095, dtype=torch.float64)
7 gae_duplicate tensor(-0.1366, dtype=torch.float64) tensor(-1.3988, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0065, dtype=torch.float64) delta_t tensor(-0.2787, dtype=torch.float64)
6 gae_duplicate tensor(-0.4317, dtype=torch.float64) tensor(5.4723, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2478, dtype=torch.float64) delta_t tensor(0.4359, dtype=torch.float64)
5 gae_duplicate tensor(-0.9643, dtype=torch.float64) tensor(-8.3143, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0351, dtype=torch.float64) delta_t tensor(0.3013, dtype=torch.float64)
4 gae_duplicate tensor(-4.7518, dtype=torch.float64) tensor(-4.7067, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1441, dtype=torch.float64) delta_t tensor(0.5273, dtype=torch.float64)
3 gae_duplicate tensor(-0.0740, dtype=torch.float64) tensor(-10.2016, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1441, dtype=torch.float64) delta_t tensor(0.0713, dtype=torch.float64)
2 gae_duplicate tensor(-0.1209, dtype=torch.float64) tensor(-2.5689, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1155.444580078125
value loss:76.463134765625
entropies:351.968017578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.401504993438721 seconds
19 rew tensor(0.5304, dtype=torch.float64) delta_t tensor(-0.0078, dtype=torch.float64)
19 gae_duplicate tensor(-0.0965, dtype=torch.float64) tensor(0.1394, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4224, dtype=torch.float64) delta_t tensor(-0.0784, dtype=torch.float64)
18 gae_duplicate tensor(-0.2545, dtype=torch.float64) tensor(1.6312, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5238, dtype=torch.float64) delta_t tensor(0.0979, dtype=torch.float64)
17 gae_duplicate tensor(-0.0896, dtype=torch.float64) tensor(-1.7753, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3496, dtype=torch.float64) delta_t tensor(-0.1670, dtype=torch.float64)
16 gae_duplicate tensor(-0.3026, dtype=torch.float64) tensor(3.1394, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4894, dtype=torch.float64) delta_t tensor(-0.0095, dtype=torch.float64)
15 gae_duplicate tensor(-0.2878, dtype=torch.float64) tensor(0.9752, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3085, dtype=torch.float64) delta_t tensor(0.1786, dtype=torch.float64)
14 gae_duplicate tensor(-0.3241, dtype=torch.float64) tensor(-3.3406, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4703, dtype=torch.float64) delta_t tensor(0.2802, dtype=torch.float64)
13 gae_duplicate tensor(-0.2503, dtype=torch.float64) tensor(-6.1639, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2885, dtype=torch.float64) delta_t tensor(0.1367, dtype=torch.float64)
12 gae_duplicate tensor(-0.1080, dtype=torch.float64) tensor(-3.2613, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4838, dtype=torch.float64) delta_t tensor(0.1931, dtype=torch.float64)
11 gae_duplicate tensor(0.0825, dtype=torch.float64) tensor(-4.4815, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2823, dtype=torch.float64) delta_t tensor(-0.1263, dtype=torch.float64)
10 gae_duplicate tensor(-0.4298, dtype=torch.float64) tensor(2.0068, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4577, dtype=torch.float64) delta_t tensor(0.0073, dtype=torch.float64)
9 gae_duplicate tensor(-0.1453, dtype=torch.float64) tensor(0.1459, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1889, dtype=torch.float64) delta_t tensor(-0.2124, dtype=torch.float64)
8 gae_duplicate tensor(-0.3682, dtype=torch.float64) tensor(4.2467, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4101, dtype=torch.float64) delta_t tensor(0.0624, dtype=torch.float64)
7 gae_duplicate tensor(-0.1565, dtype=torch.float64) tensor(-0.9182, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0347, dtype=torch.float64) delta_t tensor(-0.0678, dtype=torch.float64)
6 gae_duplicate tensor(-0.4902, dtype=torch.float64) tensor(0.8832, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2106, dtype=torch.float64) delta_t tensor(0.2998, dtype=torch.float64)
5 gae_duplicate tensor(-0.7455, dtype=torch.float64) tensor(-6.2570, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0946, dtype=torch.float64) delta_t tensor(-0.5792, dtype=torch.float64)
4 gae_duplicate tensor(-2.5749, dtype=torch.float64) tensor(9.3760, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0219, dtype=torch.float64) delta_t tensor(0.4477, dtype=torch.float64)
3 gae_duplicate tensor(0.0362, dtype=torch.float64) tensor(-7.3798, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1182, dtype=torch.float64) delta_t tensor(0.1607, dtype=torch.float64)
2 gae_duplicate tensor(-0.2902, dtype=torch.float64) tensor(-3.9516, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:714.1712646484375
value loss:35.78323745727539
entropies:351.983642578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.5095508098602295 seconds
19 rew tensor(0.5483, dtype=torch.float64) delta_t tensor(0.0110, dtype=torch.float64)
19 gae_duplicate tensor(-0.0407, dtype=torch.float64) tensor(-0.2360, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4071, dtype=torch.float64) delta_t tensor(-0.0718, dtype=torch.float64)
18 gae_duplicate tensor(-0.2272, dtype=torch.float64) tensor(1.4878, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5351, dtype=torch.float64) delta_t tensor(0.2215, dtype=torch.float64)
17 gae_duplicate tensor(-0.0378, dtype=torch.float64) tensor(-4.0583, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3873, dtype=torch.float64) delta_t tensor(-0.0539, dtype=torch.float64)
16 gae_duplicate tensor(-0.1461, dtype=torch.float64) tensor(0.6648, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4958, dtype=torch.float64) delta_t tensor(-0.2008, dtype=torch.float64)
15 gae_duplicate tensor(-0.3290, dtype=torch.float64) tensor(4.0965, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2600, dtype=torch.float64) delta_t tensor(0.3670, dtype=torch.float64)
14 gae_duplicate tensor(0.0142, dtype=torch.float64) tensor(-6.5323, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5290, dtype=torch.float64) delta_t tensor(0.3049, dtype=torch.float64)
13 gae_duplicate tensor(0.2261, dtype=torch.float64) tensor(-6.1938, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2611, dtype=torch.float64) delta_t tensor(-0.0733, dtype=torch.float64)
12 gae_duplicate tensor(-0.3353, dtype=torch.float64) tensor(0.8340, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5428, dtype=torch.float64) delta_t tensor(0.1015, dtype=torch.float64)
11 gae_duplicate tensor(0.0480, dtype=torch.float64) tensor(-1.9690, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2615, dtype=torch.float64) delta_t tensor(-0.1571, dtype=torch.float64)
10 gae_duplicate tensor(-0.3261, dtype=torch.float64) tensor(2.7784, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5296, dtype=torch.float64) delta_t tensor(-0.0758, dtype=torch.float64)
9 gae_duplicate tensor(-0.1803, dtype=torch.float64) tensor(1.6352, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2083, dtype=torch.float64) delta_t tensor(-0.2908, dtype=torch.float64)
8 gae_duplicate tensor(-0.6422, dtype=torch.float64) tensor(6.0257, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5031, dtype=torch.float64) delta_t tensor(-0.0712, dtype=torch.float64)
7 gae_duplicate tensor(-0.2513, dtype=torch.float64) tensor(1.8861, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1550, dtype=torch.float64) delta_t tensor(-0.2680, dtype=torch.float64)
6 gae_duplicate tensor(-0.4782, dtype=torch.float64) tensor(5.4394, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8345, dtype=torch.float64) delta_t tensor(0.4421, dtype=torch.float64)
5 gae_duplicate tensor(-0.4851, dtype=torch.float64) tensor(-7.9853, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.5813, dtype=torch.float64) delta_t tensor(-1.9181, dtype=torch.float64)
4 gae_duplicate tensor(-7.0445, dtype=torch.float64) tensor(34.4483, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0903, dtype=torch.float64) delta_t tensor(0.2350, dtype=torch.float64)
3 gae_duplicate tensor(-0.4735, dtype=torch.float64) tensor(-0.8706, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0904, dtype=torch.float64) delta_t tensor(0.1853, dtype=torch.float64)
2 gae_duplicate tensor(-0.1001, dtype=torch.float64) tensor(-3.6435, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1596.6915283203125
value loss:107.21784973144531
entropies:352.2112731933594
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3971.4224)
ToM Target loss= tensor(3547.2988)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.316138982772827 seconds
19 rew tensor(0.5481, dtype=torch.float64) delta_t tensor(0.0489, dtype=torch.float64)
19 gae_duplicate tensor(-0.0342, dtype=torch.float64) tensor(-0.9378, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4208, dtype=torch.float64) delta_t tensor(-0.0406, dtype=torch.float64)
18 gae_duplicate tensor(-0.3627, dtype=torch.float64) tensor(0.6561, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4999, dtype=torch.float64) delta_t tensor(0.0591, dtype=torch.float64)
17 gae_duplicate tensor(-0.1526, dtype=torch.float64) tensor(-0.9255, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3401, dtype=torch.float64) delta_t tensor(-0.0902, dtype=torch.float64)
16 gae_duplicate tensor(-0.3542, dtype=torch.float64) tensor(1.4073, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5153, dtype=torch.float64) delta_t tensor(0.0197, dtype=torch.float64)
15 gae_duplicate tensor(-0.3453, dtype=torch.float64) tensor(-0.0655, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2519, dtype=torch.float64) delta_t tensor(0.1555, dtype=torch.float64)
14 gae_duplicate tensor(-0.0600, dtype=torch.float64) tensor(-3.3170, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5227, dtype=torch.float64) delta_t tensor(0.1790, dtype=torch.float64)
13 gae_duplicate tensor(0.0710, dtype=torch.float64) tensor(-3.7866, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2786, dtype=torch.float64) delta_t tensor(-0.1374, dtype=torch.float64)
12 gae_duplicate tensor(-0.3232, dtype=torch.float64) tensor(2.4113, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5100, dtype=torch.float64) delta_t tensor(0.0304, dtype=torch.float64)
11 gae_duplicate tensor(-0.1227, dtype=torch.float64) tensor(-0.3705, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2531, dtype=torch.float64) delta_t tensor(-0.2068, dtype=torch.float64)
10 gae_duplicate tensor(-0.2929, dtype=torch.float64) tensor(3.9970, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4367, dtype=torch.float64) delta_t tensor(-0.1385, dtype=torch.float64)
9 gae_duplicate tensor(-0.2535, dtype=torch.float64) tensor(3.1368, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1138, dtype=torch.float64) delta_t tensor(-0.2873, dtype=torch.float64)
8 gae_duplicate tensor(-0.5893, dtype=torch.float64) tensor(5.9774, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4185, dtype=torch.float64) delta_t tensor(0.1569, dtype=torch.float64)
7 gae_duplicate tensor(-0.1235, dtype=torch.float64) tensor(-2.3534, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0069, dtype=torch.float64) delta_t tensor(-0.2530, dtype=torch.float64)
6 gae_duplicate tensor(-0.4957, dtype=torch.float64) tensor(4.6401, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4734, dtype=torch.float64) delta_t tensor(-0.1544, dtype=torch.float64)
5 gae_duplicate tensor(-1.2489, dtype=torch.float64) tensor(3.4186, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5697, dtype=torch.float64) delta_t tensor(-1.4597, dtype=torch.float64)
4 gae_duplicate tensor(-6.4440, dtype=torch.float64) tensor(26.4097, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0042, dtype=torch.float64) delta_t tensor(0.6290, dtype=torch.float64)
3 gae_duplicate tensor(0.2924, dtype=torch.float64) tensor(-9.1770, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0897, dtype=torch.float64) delta_t tensor(0.2074, dtype=torch.float64)
2 gae_duplicate tensor(-0.4447, dtype=torch.float64) tensor(-5.5708, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1474.911376953125
value loss:102.85131072998047
entropies:352.60833740234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.204196929931641 seconds
19 rew tensor(0.5086, dtype=torch.float64) delta_t tensor(0.0240, dtype=torch.float64)
19 gae_duplicate tensor(-0.0710, dtype=torch.float64) tensor(-0.5254, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4059, dtype=torch.float64) delta_t tensor(-0.0838, dtype=torch.float64)
18 gae_duplicate tensor(-0.2288, dtype=torch.float64) tensor(1.5908, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5354, dtype=torch.float64) delta_t tensor(0.1131, dtype=torch.float64)
17 gae_duplicate tensor(-0.0578, dtype=torch.float64) tensor(-2.0261, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2391, dtype=torch.float64) delta_t tensor(-0.1791, dtype=torch.float64)
16 gae_duplicate tensor(-0.4708, dtype=torch.float64) tensor(3.2537, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5359, dtype=torch.float64) delta_t tensor(-0.0967, dtype=torch.float64)
15 gae_duplicate tensor(-0.3130, dtype=torch.float64) tensor(2.2161, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2057, dtype=torch.float64) delta_t tensor(0.2680, dtype=torch.float64)
14 gae_duplicate tensor(0.0179, dtype=torch.float64) tensor(-5.2831, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5427, dtype=torch.float64) delta_t tensor(0.2902, dtype=torch.float64)
13 gae_duplicate tensor(0.1459, dtype=torch.float64) tensor(-6.2794, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2331, dtype=torch.float64) delta_t tensor(-0.0980, dtype=torch.float64)
12 gae_duplicate tensor(-0.2708, dtype=torch.float64) tensor(1.1702, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5433, dtype=torch.float64) delta_t tensor(0.1043, dtype=torch.float64)
11 gae_duplicate tensor(0.0225, dtype=torch.float64) tensor(-1.9462, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0779, dtype=torch.float64) delta_t tensor(-0.2836, dtype=torch.float64)
10 gae_duplicate tensor(-0.5971, dtype=torch.float64) tensor(5.4757, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1441, dtype=torch.float64) delta_t tensor(-0.7268, dtype=torch.float64)
9 gae_duplicate tensor(-4.2428, dtype=torch.float64) tensor(14.2775, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1217, dtype=torch.float64) delta_t tensor(-0.3361, dtype=torch.float64)
8 gae_duplicate tensor(-0.8281, dtype=torch.float64) tensor(7.7746, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4251, dtype=torch.float64) delta_t tensor(0.1642, dtype=torch.float64)
7 gae_duplicate tensor(-0.0692, dtype=torch.float64) tensor(-2.5465, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0030, dtype=torch.float64) delta_t tensor(-0.3208, dtype=torch.float64)
6 gae_duplicate tensor(-0.5550, dtype=torch.float64) tensor(6.1217, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8513, dtype=torch.float64) delta_t tensor(0.5926, dtype=torch.float64)
5 gae_duplicate tensor(0.1797, dtype=torch.float64) tensor(-11.1150, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2828, dtype=torch.float64) delta_t tensor(-0.2234, dtype=torch.float64)
4 gae_duplicate tensor(-2.5049, dtype=torch.float64) tensor(4.0206, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0797, dtype=torch.float64) delta_t tensor(0.4950, dtype=torch.float64)
3 gae_duplicate tensor(0.2820, dtype=torch.float64) tensor(-9.1594, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2878, dtype=torch.float64) delta_t tensor(-0.1289, dtype=torch.float64)
2 gae_duplicate tensor(-0.1628, dtype=torch.float64) tensor(1.6105, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-561.3829956054688
value loss:63.19435119628906
entropies:353.1458740234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 6.09331202507019 seconds
19 rew tensor(0.5358, dtype=torch.float64) delta_t tensor(0.0706, dtype=torch.float64)
19 gae_duplicate tensor(-0.0439, dtype=torch.float64) tensor(-1.3794, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3670, dtype=torch.float64) delta_t tensor(-0.0970, dtype=torch.float64)
18 gae_duplicate tensor(-0.2548, dtype=torch.float64) tensor(1.8284, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5232, dtype=torch.float64) delta_t tensor(0.0740, dtype=torch.float64)
17 gae_duplicate tensor(-0.0448, dtype=torch.float64) tensor(-1.2465, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3007, dtype=torch.float64) delta_t tensor(-0.1922, dtype=torch.float64)
16 gae_duplicate tensor(-0.3481, dtype=torch.float64) tensor(3.6527, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5086, dtype=torch.float64) delta_t tensor(0.0891, dtype=torch.float64)
15 gae_duplicate tensor(-0.1553, dtype=torch.float64) tensor(-1.4134, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2690, dtype=torch.float64) delta_t tensor(0.1185, dtype=torch.float64)
14 gae_duplicate tensor(-0.3324, dtype=torch.float64) tensor(-2.5601, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4465, dtype=torch.float64) delta_t tensor(0.2457, dtype=torch.float64)
13 gae_duplicate tensor(-0.2064, dtype=torch.float64) tensor(-5.1589, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2828, dtype=torch.float64) delta_t tensor(0.0583, dtype=torch.float64)
12 gae_duplicate tensor(-0.2645, dtype=torch.float64) tensor(-1.6530, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4670, dtype=torch.float64) delta_t tensor(0.1048, dtype=torch.float64)
11 gae_duplicate tensor(-0.1488, dtype=torch.float64) tensor(-2.2476, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2966, dtype=torch.float64) delta_t tensor(-0.0856, dtype=torch.float64)
10 gae_duplicate tensor(-0.3275, dtype=torch.float64) tensor(1.4282, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4673, dtype=torch.float64) delta_t tensor(-0.0847, dtype=torch.float64)
9 gae_duplicate tensor(-0.2984, dtype=torch.float64) tensor(1.8124, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2291, dtype=torch.float64) delta_t tensor(-0.2162, dtype=torch.float64)
8 gae_duplicate tensor(-0.5024, dtype=torch.float64) tensor(4.4571, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3996, dtype=torch.float64) delta_t tensor(0.0105, dtype=torch.float64)
7 gae_duplicate tensor(-0.0955, dtype=torch.float64) tensor(0.1942, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0857, dtype=torch.float64) delta_t tensor(-0.1066, dtype=torch.float64)
6 gae_duplicate tensor(-0.3548, dtype=torch.float64) tensor(2.2293, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1199, dtype=torch.float64) delta_t tensor(0.5702, dtype=torch.float64)
5 gae_duplicate tensor(-0.2311, dtype=torch.float64) tensor(-10.5919, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9002, dtype=torch.float64) delta_t tensor(-0.7803, dtype=torch.float64)
4 gae_duplicate tensor(-5.6425, dtype=torch.float64) tensor(15.5193, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0872, dtype=torch.float64) delta_t tensor(0.4913, dtype=torch.float64)
3 gae_duplicate tensor(-0.1134, dtype=torch.float64) tensor(-7.9949, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1438, dtype=torch.float64) delta_t tensor(0.2208, dtype=torch.float64)
2 gae_duplicate tensor(-0.6899, dtype=torch.float64) tensor(-5.2107, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:354.5820007324219
value loss:68.4983139038086
entropies:353.700927734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.080695867538452 seconds
19 rew tensor(0.5491, dtype=torch.float64) delta_t tensor(0.2669, dtype=torch.float64)
19 gae_duplicate tensor(0.1357, dtype=torch.float64) tensor(-5.3901, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3793, dtype=torch.float64) delta_t tensor(0.0293, dtype=torch.float64)
18 gae_duplicate tensor(-0.0690, dtype=torch.float64) tensor(-1.0869, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5565, dtype=torch.float64) delta_t tensor(0.2171, dtype=torch.float64)
17 gae_duplicate tensor(0.0098, dtype=torch.float64) tensor(-4.2650, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3069, dtype=torch.float64) delta_t tensor(0.0076, dtype=torch.float64)
16 gae_duplicate tensor(-0.3068, dtype=torch.float64) tensor(-0.4958, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5370, dtype=torch.float64) delta_t tensor(0.2446, dtype=torch.float64)
15 gae_duplicate tensor(0.0398, dtype=torch.float64) tensor(-4.8258, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2086, dtype=torch.float64) delta_t tensor(-0.1620, dtype=torch.float64)
14 gae_duplicate tensor(-0.2944, dtype=torch.float64) tensor(2.7597, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4959, dtype=torch.float64) delta_t tensor(0.0486, dtype=torch.float64)
13 gae_duplicate tensor(-0.1320, dtype=torch.float64) tensor(-0.8657, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1476, dtype=torch.float64) delta_t tensor(0.0681, dtype=torch.float64)
12 gae_duplicate tensor(-0.3248, dtype=torch.float64) tensor(-1.5449, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5302, dtype=torch.float64) delta_t tensor(0.2610, dtype=torch.float64)
11 gae_duplicate tensor(0.0328, dtype=torch.float64) tensor(-5.4364, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1201, dtype=torch.float64) delta_t tensor(-0.1624, dtype=torch.float64)
10 gae_duplicate tensor(-0.3499, dtype=torch.float64) tensor(2.8105, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5440, dtype=torch.float64) delta_t tensor(0.0596, dtype=torch.float64)
9 gae_duplicate tensor(-0.1168, dtype=torch.float64) tensor(-0.9117, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0871, dtype=torch.float64) delta_t tensor(-0.2873, dtype=torch.float64)
8 gae_duplicate tensor(-0.5375, dtype=torch.float64) tensor(5.7122, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5037, dtype=torch.float64) delta_t tensor(0.1422, dtype=torch.float64)
7 gae_duplicate tensor(-0.0878, dtype=torch.float64) tensor(-2.1439, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0471, dtype=torch.float64) delta_t tensor(-0.1313, dtype=torch.float64)
6 gae_duplicate tensor(-0.3486, dtype=torch.float64) tensor(2.3521, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2766, dtype=torch.float64) delta_t tensor(0.1656, dtype=torch.float64)
5 gae_duplicate tensor(-0.8536, dtype=torch.float64) tensor(-2.8958, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2085, dtype=torch.float64) delta_t tensor(0.1164, dtype=torch.float64)
4 gae_duplicate tensor(-1.3435, dtype=torch.float64) tensor(-2.0275, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0590, dtype=torch.float64) delta_t tensor(0.4402, dtype=torch.float64)
3 gae_duplicate tensor(-0.0999, dtype=torch.float64) tensor(-8.9218, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2550, dtype=torch.float64) delta_t tensor(0.0982, dtype=torch.float64)
2 gae_duplicate tensor(-0.5486, dtype=torch.float64) tensor(-3.0184, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1534.9625244140625
value loss:28.678491592407227
entropies:354.0032653808594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.356993913650513 seconds
19 rew tensor(0.5500, dtype=torch.float64) delta_t tensor(0.1861, dtype=torch.float64)
19 gae_duplicate tensor(-0.0370, dtype=torch.float64) tensor(-3.6823, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4348, dtype=torch.float64) delta_t tensor(-0.0147, dtype=torch.float64)
18 gae_duplicate tensor(-0.2268, dtype=torch.float64) tensor(-0.1242, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4440, dtype=torch.float64) delta_t tensor(0.1999, dtype=torch.float64)
17 gae_duplicate tensor(-0.0491, dtype=torch.float64) tensor(-3.9405, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4086, dtype=torch.float64) delta_t tensor(0.2147, dtype=torch.float64)
16 gae_duplicate tensor(-0.1712, dtype=torch.float64) tensor(-4.6415, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4627, dtype=torch.float64) delta_t tensor(0.1748, dtype=torch.float64)
15 gae_duplicate tensor(-0.0706, dtype=torch.float64) tensor(-3.7757, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2565, dtype=torch.float64) delta_t tensor(0.3159, dtype=torch.float64)
14 gae_duplicate tensor(0.1407, dtype=torch.float64) tensor(-6.6231, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4883, dtype=torch.float64) delta_t tensor(0.3453, dtype=torch.float64)
13 gae_duplicate tensor(0.1609, dtype=torch.float64) tensor(-7.2472, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1618, dtype=torch.float64) delta_t tensor(-0.0841, dtype=torch.float64)
12 gae_duplicate tensor(-0.2725, dtype=torch.float64) tensor(0.8449, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4532, dtype=torch.float64) delta_t tensor(0.0679, dtype=torch.float64)
11 gae_duplicate tensor(-0.2204, dtype=torch.float64) tensor(-1.3188, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2040, dtype=torch.float64) delta_t tensor(-0.0716, dtype=torch.float64)
10 gae_duplicate tensor(-0.3178, dtype=torch.float64) tensor(1.3086, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3836, dtype=torch.float64) delta_t tensor(-0.0917, dtype=torch.float64)
9 gae_duplicate tensor(-0.3471, dtype=torch.float64) tensor(1.9017, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1152, dtype=torch.float64) delta_t tensor(-0.1892, dtype=torch.float64)
8 gae_duplicate tensor(-0.4291, dtype=torch.float64) tensor(4.0042, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3902, dtype=torch.float64) delta_t tensor(0.1301, dtype=torch.float64)
7 gae_duplicate tensor(-0.1168, dtype=torch.float64) tensor(-2.3815, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2195, dtype=torch.float64) delta_t tensor(-0.1769, dtype=torch.float64)
6 gae_duplicate tensor(-0.3011, dtype=torch.float64) tensor(3.1607, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1989, dtype=torch.float64) delta_t tensor(0.1170, dtype=torch.float64)
5 gae_duplicate tensor(-0.7855, dtype=torch.float64) tensor(-2.0183, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0607, dtype=torch.float64) delta_t tensor(-2.1865, dtype=torch.float64)
4 gae_duplicate tensor(-4.1757, dtype=torch.float64) tensor(41.5181, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0804, dtype=torch.float64) delta_t tensor(0.5774, dtype=torch.float64)
3 gae_duplicate tensor(0.1910, dtype=torch.float64) tensor(-7.0680, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2309, dtype=torch.float64) delta_t tensor(0.1911, dtype=torch.float64)
2 gae_duplicate tensor(-0.3603, dtype=torch.float64) tensor(-4.7522, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-374.51922607421875
value loss:78.6288833618164
entropies:354.125244140625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3962.2556)
ToM Target loss= tensor(3571.2803)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.271747827529907 seconds
19 rew tensor(0.4963, dtype=torch.float64) delta_t tensor(0.0728, dtype=torch.float64)
19 gae_duplicate tensor(-0.0284, dtype=torch.float64) tensor(-1.4453, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4552, dtype=torch.float64) delta_t tensor(0.2907, dtype=torch.float64)
18 gae_duplicate tensor(-0.1104, dtype=torch.float64) tensor(-5.8177, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4759, dtype=torch.float64) delta_t tensor(0.0692, dtype=torch.float64)
17 gae_duplicate tensor(-0.0150, dtype=torch.float64) tensor(-2.0150, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3677, dtype=torch.float64) delta_t tensor(0.2414, dtype=torch.float64)
16 gae_duplicate tensor(-0.2542, dtype=torch.float64) tensor(-4.9455, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4843, dtype=torch.float64) delta_t tensor(0.2005, dtype=torch.float64)
15 gae_duplicate tensor(-0.0500, dtype=torch.float64) tensor(-4.2968, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2610, dtype=torch.float64) delta_t tensor(0.1807, dtype=torch.float64)
14 gae_duplicate tensor(-0.2353, dtype=torch.float64) tensor(-3.9144, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5105, dtype=torch.float64) delta_t tensor(0.2964, dtype=torch.float64)
13 gae_duplicate tensor(0.0829, dtype=torch.float64) tensor(-6.2795, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1875, dtype=torch.float64) delta_t tensor(-0.0585, dtype=torch.float64)
12 gae_duplicate tensor(-0.2044, dtype=torch.float64) tensor(0.5776, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5445, dtype=torch.float64) delta_t tensor(0.1444, dtype=torch.float64)
11 gae_duplicate tensor(0.0407, dtype=torch.float64) tensor(-2.7057, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1678, dtype=torch.float64) delta_t tensor(-0.2124, dtype=torch.float64)
10 gae_duplicate tensor(-0.3465, dtype=torch.float64) tensor(4.0217, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5447, dtype=torch.float64) delta_t tensor(0.0213, dtype=torch.float64)
9 gae_duplicate tensor(-0.1028, dtype=torch.float64) tensor(-0.0118, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1278, dtype=torch.float64) delta_t tensor(-0.2634, dtype=torch.float64)
8 gae_duplicate tensor(-0.3835, dtype=torch.float64) tensor(4.9875, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5045, dtype=torch.float64) delta_t tensor(0.0321, dtype=torch.float64)
7 gae_duplicate tensor(-0.1729, dtype=torch.float64) tensor(-0.0937, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0878, dtype=torch.float64) delta_t tensor(-0.1784, dtype=torch.float64)
6 gae_duplicate tensor(-0.3511, dtype=torch.float64) tensor(3.5027, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4237, dtype=torch.float64) delta_t tensor(0.1879, dtype=torch.float64)
5 gae_duplicate tensor(-0.7078, dtype=torch.float64) tensor(-3.2971, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9153, dtype=torch.float64) delta_t tensor(-0.7747, dtype=torch.float64)
4 gae_duplicate tensor(-2.5714, dtype=torch.float64) tensor(14.5978, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2190, dtype=torch.float64) delta_t tensor(0.5422, dtype=torch.float64)
3 gae_duplicate tensor(0.2590, dtype=torch.float64) tensor(-9.2536, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2121, dtype=torch.float64) delta_t tensor(-0.1038, dtype=torch.float64)
2 gae_duplicate tensor(-0.1437, dtype=torch.float64) tensor(1.1542, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:726.9841918945312
value loss:46.96356964111328
entropies:354.3494873046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.291411876678467 seconds
19 rew tensor(0.5150, dtype=torch.float64) delta_t tensor(0.0813, dtype=torch.float64)
19 gae_duplicate tensor(-0.1327, dtype=torch.float64) tensor(-1.5537, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4696, dtype=torch.float64) delta_t tensor(0.0631, dtype=torch.float64)
18 gae_duplicate tensor(-0.2402, dtype=torch.float64) tensor(-1.3102, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4816, dtype=torch.float64) delta_t tensor(0.0801, dtype=torch.float64)
17 gae_duplicate tensor(-0.1320, dtype=torch.float64) tensor(-1.6861, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3818, dtype=torch.float64) delta_t tensor(0.1521, dtype=torch.float64)
16 gae_duplicate tensor(-0.2271, dtype=torch.float64) tensor(-2.9954, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4756, dtype=torch.float64) delta_t tensor(0.2751, dtype=torch.float64)
15 gae_duplicate tensor(-0.0629, dtype=torch.float64) tensor(-5.6663, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1734, dtype=torch.float64) delta_t tensor(0.2070, dtype=torch.float64)
14 gae_duplicate tensor(-0.0729, dtype=torch.float64) tensor(-4.6239, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5229, dtype=torch.float64) delta_t tensor(0.2713, dtype=torch.float64)
13 gae_duplicate tensor(0.1031, dtype=torch.float64) tensor(-5.9891, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1258, dtype=torch.float64) delta_t tensor(-0.1864, dtype=torch.float64)
12 gae_duplicate tensor(-0.3568, dtype=torch.float64) tensor(3.1600, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5435, dtype=torch.float64) delta_t tensor(0.1077, dtype=torch.float64)
11 gae_duplicate tensor(0.0194, dtype=torch.float64) tensor(-1.8385, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1126, dtype=torch.float64) delta_t tensor(-0.1929, dtype=torch.float64)
10 gae_duplicate tensor(-0.3704, dtype=torch.float64) tensor(3.6364, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4756, dtype=torch.float64) delta_t tensor(-0.0776, dtype=torch.float64)
9 gae_duplicate tensor(-0.1718, dtype=torch.float64) tensor(1.8829, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0047, dtype=torch.float64) delta_t tensor(-0.2680, dtype=torch.float64)
8 gae_duplicate tensor(-0.5173, dtype=torch.float64) tensor(5.2995, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4895, dtype=torch.float64) delta_t tensor(0.0652, dtype=torch.float64)
7 gae_duplicate tensor(-0.1304, dtype=torch.float64) tensor(-0.7025, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1170, dtype=torch.float64) delta_t tensor(-0.2935, dtype=torch.float64)
6 gae_duplicate tensor(-0.5050, dtype=torch.float64) tensor(5.8097, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0586, dtype=torch.float64) delta_t tensor(0.5345, dtype=torch.float64)
5 gae_duplicate tensor(-0.0293, dtype=torch.float64) tensor(-9.7167, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0131, dtype=torch.float64) delta_t tensor(-1.4530, dtype=torch.float64)
4 gae_duplicate tensor(-5.4706, dtype=torch.float64) tensor(27.8494, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0157, dtype=torch.float64) delta_t tensor(0.4614, dtype=torch.float64)
3 gae_duplicate tensor(-0.2671, dtype=torch.float64) tensor(-6.5531, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1040, dtype=torch.float64) delta_t tensor(0.1242, dtype=torch.float64)
2 gae_duplicate tensor(-0.5044, dtype=torch.float64) tensor(-3.0227, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-202.6334991455078
value loss:82.92152404785156
entropies:354.5743713378906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.5453808307647705 seconds
19 rew tensor(0.5098, dtype=torch.float64) delta_t tensor(0.0310, dtype=torch.float64)
19 gae_duplicate tensor(-0.0319, dtype=torch.float64) tensor(-0.6378, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4072, dtype=torch.float64) delta_t tensor(0.0968, dtype=torch.float64)
18 gae_duplicate tensor(-0.2570, dtype=torch.float64) tensor(-1.8340, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5428, dtype=torch.float64) delta_t tensor(0.0273, dtype=torch.float64)
17 gae_duplicate tensor(-0.0651, dtype=torch.float64) tensor(-0.7701, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3220, dtype=torch.float64) delta_t tensor(-0.0819, dtype=torch.float64)
16 gae_duplicate tensor(-0.2717, dtype=torch.float64) tensor(1.5200, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5013, dtype=torch.float64) delta_t tensor(0.0164, dtype=torch.float64)
15 gae_duplicate tensor(-0.1757, dtype=torch.float64) tensor(-0.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1863, dtype=torch.float64) delta_t tensor(0.0656, dtype=torch.float64)
14 gae_duplicate tensor(-0.2561, dtype=torch.float64) tensor(-1.4112, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5026, dtype=torch.float64) delta_t tensor(0.2236, dtype=torch.float64)
13 gae_duplicate tensor(-0.0225, dtype=torch.float64) tensor(-4.4637, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1321, dtype=torch.float64) delta_t tensor(-0.1914, dtype=torch.float64)
12 gae_duplicate tensor(-0.2638, dtype=torch.float64) tensor(3.3478, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5430, dtype=torch.float64) delta_t tensor(0.0528, dtype=torch.float64)
11 gae_duplicate tensor(-0.0193, dtype=torch.float64) tensor(-0.7509, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1123, dtype=torch.float64) delta_t tensor(-0.3271, dtype=torch.float64)
10 gae_duplicate tensor(-0.5830, dtype=torch.float64) tensor(6.5359, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5304, dtype=torch.float64) delta_t tensor(-0.0852, dtype=torch.float64)
9 gae_duplicate tensor(-0.2046, dtype=torch.float64) tensor(2.3031, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0533, dtype=torch.float64) delta_t tensor(-0.2200, dtype=torch.float64)
8 gae_duplicate tensor(-0.4105, dtype=torch.float64) tensor(4.4168, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4122, dtype=torch.float64) delta_t tensor(-0.0467, dtype=torch.float64)
7 gae_duplicate tensor(-0.2420, dtype=torch.float64) tensor(1.3048, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0711, dtype=torch.float64) delta_t tensor(-0.3278, dtype=torch.float64)
6 gae_duplicate tensor(-0.4357, dtype=torch.float64) tensor(6.6010, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7404, dtype=torch.float64) delta_t tensor(-0.2996, dtype=torch.float64)
5 gae_duplicate tensor(-1.4218, dtype=torch.float64) tensor(6.3381, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.6342, dtype=torch.float64) delta_t tensor(-2.7214, dtype=torch.float64)
4 gae_duplicate tensor(-4.9734, dtype=torch.float64) tensor(54.5386, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0380, dtype=torch.float64) delta_t tensor(0.4599, dtype=torch.float64)
3 gae_duplicate tensor(0.0128, dtype=torch.float64) tensor(-3.5864, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1053, dtype=torch.float64) delta_t tensor(0.0814, dtype=torch.float64)
2 gae_duplicate tensor(-0.4398, dtype=torch.float64) tensor(-1.6491, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3966.255859375
value loss:102.19390869140625
entropies:354.6385803222656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.5295250415802 seconds
19 rew tensor(0.5085, dtype=torch.float64) delta_t tensor(0.0132, dtype=torch.float64)
19 gae_duplicate tensor(-0.1347, dtype=torch.float64) tensor(-0.2424, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4361, dtype=torch.float64) delta_t tensor(-0.0036, dtype=torch.float64)
18 gae_duplicate tensor(-0.1646, dtype=torch.float64) tensor(0.0668, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4884, dtype=torch.float64) delta_t tensor(0.1033, dtype=torch.float64)
17 gae_duplicate tensor(-0.1443, dtype=torch.float64) tensor(-1.8853, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3825, dtype=torch.float64) delta_t tensor(0.0540, dtype=torch.float64)
16 gae_duplicate tensor(-0.1453, dtype=torch.float64) tensor(-1.2889, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4689, dtype=torch.float64) delta_t tensor(-0.0394, dtype=torch.float64)
15 gae_duplicate tensor(-0.2677, dtype=torch.float64) tensor(0.6272, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3219, dtype=torch.float64) delta_t tensor(0.3381, dtype=torch.float64)
14 gae_duplicate tensor(0.0404, dtype=torch.float64) tensor(-6.6225, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4496, dtype=torch.float64) delta_t tensor(0.1567, dtype=torch.float64)
13 gae_duplicate tensor(-0.2067, dtype=torch.float64) tensor(-3.6076, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3085, dtype=torch.float64) delta_t tensor(-0.0653, dtype=torch.float64)
12 gae_duplicate tensor(-0.2610, dtype=torch.float64) tensor(0.9149, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4566, dtype=torch.float64) delta_t tensor(-0.0008, dtype=torch.float64)
11 gae_duplicate tensor(-0.3126, dtype=torch.float64) tensor(0.1449, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3088, dtype=torch.float64) delta_t tensor(-0.1523, dtype=torch.float64)
10 gae_duplicate tensor(-0.2994, dtype=torch.float64) tensor(2.9902, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4569, dtype=torch.float64) delta_t tensor(-0.0925, dtype=torch.float64)
9 gae_duplicate tensor(-0.4251, dtype=torch.float64) tensor(2.1059, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2423, dtype=torch.float64) delta_t tensor(-0.2147, dtype=torch.float64)
8 gae_duplicate tensor(-0.3413, dtype=torch.float64) tensor(4.4087, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3835, dtype=torch.float64) delta_t tensor(-0.1065, dtype=torch.float64)
7 gae_duplicate tensor(-0.2322, dtype=torch.float64) tensor(2.5706, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0889, dtype=torch.float64) delta_t tensor(-0.1686, dtype=torch.float64)
6 gae_duplicate tensor(-0.3150, dtype=torch.float64) tensor(3.5847, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0357, dtype=torch.float64) delta_t tensor(-0.6597, dtype=torch.float64)
5 gae_duplicate tensor(-1.5975, dtype=torch.float64) tensor(13.1321, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1124, dtype=torch.float64) delta_t tensor(-0.6804, dtype=torch.float64)
4 gae_duplicate tensor(-2.1633, dtype=torch.float64) tensor(15.8633, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0364, dtype=torch.float64) delta_t tensor(0.5589, dtype=torch.float64)
3 gae_duplicate tensor(-0.3577, dtype=torch.float64) tensor(-9.1195, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1010, dtype=torch.float64) delta_t tensor(0.1083, dtype=torch.float64)
2 gae_duplicate tensor(-0.3807, dtype=torch.float64) tensor(-2.7905, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1221.78564453125
value loss:34.724945068359375
entropies:354.5724792480469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.618800163269043 seconds
19 rew tensor(0.4550, dtype=torch.float64) delta_t tensor(-0.0248, dtype=torch.float64)
19 gae_duplicate tensor(-0.1681, dtype=torch.float64) tensor(0.4763, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4621, dtype=torch.float64) delta_t tensor(0.0664, dtype=torch.float64)
18 gae_duplicate tensor(-0.0836, dtype=torch.float64) tensor(-1.1558, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4486, dtype=torch.float64) delta_t tensor(0.0592, dtype=torch.float64)
17 gae_duplicate tensor(-0.1950, dtype=torch.float64) tensor(-1.2437, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4421, dtype=torch.float64) delta_t tensor(0.2323, dtype=torch.float64)
16 gae_duplicate tensor(-0.0206, dtype=torch.float64) tensor(-4.6564, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3334, dtype=torch.float64) delta_t tensor(-0.2691, dtype=torch.float64)
15 gae_duplicate tensor(-0.8862, dtype=torch.float64) tensor(4.6430, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3489, dtype=torch.float64) delta_t tensor(0.3201, dtype=torch.float64)
14 gae_duplicate tensor(0.0332, dtype=torch.float64) tensor(-6.1207, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5295, dtype=torch.float64) delta_t tensor(0.2036, dtype=torch.float64)
13 gae_duplicate tensor(-0.0712, dtype=torch.float64) tensor(-4.7382, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2894, dtype=torch.float64) delta_t tensor(-0.0663, dtype=torch.float64)
12 gae_duplicate tensor(-0.1765, dtype=torch.float64) tensor(0.7991, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5431, dtype=torch.float64) delta_t tensor(0.1969, dtype=torch.float64)
11 gae_duplicate tensor(0.0700, dtype=torch.float64) tensor(-3.5973, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2829, dtype=torch.float64) delta_t tensor(-0.0549, dtype=torch.float64)
10 gae_duplicate tensor(-0.3067, dtype=torch.float64) tensor(0.7873, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5433, dtype=torch.float64) delta_t tensor(0.0741, dtype=torch.float64)
9 gae_duplicate tensor(-0.0701, dtype=torch.float64) tensor(-1.3123, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2500, dtype=torch.float64) delta_t tensor(-0.1166, dtype=torch.float64)
8 gae_duplicate tensor(-0.3276, dtype=torch.float64) tensor(2.1382, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5034, dtype=torch.float64) delta_t tensor(-0.0120, dtype=torch.float64)
7 gae_duplicate tensor(-0.2287, dtype=torch.float64) tensor(0.4178, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2103, dtype=torch.float64) delta_t tensor(-0.0650, dtype=torch.float64)
6 gae_duplicate tensor(-0.2414, dtype=torch.float64) tensor(1.3913, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5098, dtype=torch.float64) delta_t tensor(0.1449, dtype=torch.float64)
5 gae_duplicate tensor(-0.5998, dtype=torch.float64) tensor(-2.9815, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.2494, dtype=torch.float64) delta_t tensor(-0.3891, dtype=torch.float64)
4 gae_duplicate tensor(-4.7757, dtype=torch.float64) tensor(7.3331, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1143, dtype=torch.float64) delta_t tensor(0.6459, dtype=torch.float64)
3 gae_duplicate tensor(-0.6474, dtype=torch.float64) tensor(-11.0669, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1143, dtype=torch.float64) delta_t tensor(0.0408, dtype=torch.float64)
2 gae_duplicate tensor(-0.1039, dtype=torch.float64) tensor(-1.9188, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1027.8094482421875
value loss:58.49396896362305
entropies:354.3815612792969
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3954.1682)
ToM Target loss= tensor(3575.5928)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.569495677947998 seconds
19 rew tensor(0.5292, dtype=torch.float64) delta_t tensor(0.0967, dtype=torch.float64)
19 gae_duplicate tensor(-0.0407, dtype=torch.float64) tensor(-1.9705, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2751, dtype=torch.float64) delta_t tensor(-0.1352, dtype=torch.float64)
18 gae_duplicate tensor(-0.1919, dtype=torch.float64) tensor(2.4713, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5427, dtype=torch.float64) delta_t tensor(0.1275, dtype=torch.float64)
17 gae_duplicate tensor(0.0611, dtype=torch.float64) tensor(-2.2603, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2556, dtype=torch.float64) delta_t tensor(-0.1263, dtype=torch.float64)
16 gae_duplicate tensor(-0.2699, dtype=torch.float64) tensor(2.2586, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4885, dtype=torch.float64) delta_t tensor(-0.1323, dtype=torch.float64)
15 gae_duplicate tensor(-0.4405, dtype=torch.float64) tensor(2.7421, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1943, dtype=torch.float64) delta_t tensor(0.1641, dtype=torch.float64)
14 gae_duplicate tensor(-0.2708, dtype=torch.float64) tensor(-2.9071, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5298, dtype=torch.float64) delta_t tensor(0.1156, dtype=torch.float64)
13 gae_duplicate tensor(-0.3305, dtype=torch.float64) tensor(-2.5863, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1743, dtype=torch.float64) delta_t tensor(-0.1143, dtype=torch.float64)
12 gae_duplicate tensor(-0.2440, dtype=torch.float64) tensor(2.0017, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5433, dtype=torch.float64) delta_t tensor(0.1115, dtype=torch.float64)
11 gae_duplicate tensor(0.0455, dtype=torch.float64) tensor(-2.0482, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1811, dtype=torch.float64) delta_t tensor(-0.1987, dtype=torch.float64)
10 gae_duplicate tensor(-0.3054, dtype=torch.float64) tensor(3.7998, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5434, dtype=torch.float64) delta_t tensor(0.0093, dtype=torch.float64)
9 gae_duplicate tensor(-0.0678, dtype=torch.float64) tensor(0.2508, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1413, dtype=torch.float64) delta_t tensor(-0.2256, dtype=torch.float64)
8 gae_duplicate tensor(-0.3612, dtype=torch.float64) tensor(4.3117, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5034, dtype=torch.float64) delta_t tensor(0.0131, dtype=torch.float64)
7 gae_duplicate tensor(-0.1735, dtype=torch.float64) tensor(0.1550, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1015, dtype=torch.float64) delta_t tensor(-0.1811, dtype=torch.float64)
6 gae_duplicate tensor(-0.2849, dtype=torch.float64) tensor(3.7515, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3774, dtype=torch.float64) delta_t tensor(-0.0693, dtype=torch.float64)
5 gae_duplicate tensor(-0.7667, dtype=torch.float64) tensor(1.5096, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7109, dtype=torch.float64) delta_t tensor(-0.6402, dtype=torch.float64)
4 gae_duplicate tensor(-3.6993, dtype=torch.float64) tensor(13.4903, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0024, dtype=torch.float64) delta_t tensor(0.4139, dtype=torch.float64)
3 gae_duplicate tensor(-0.5774, dtype=torch.float64) tensor(-6.9840, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2485, dtype=torch.float64) delta_t tensor(-0.0476, dtype=torch.float64)
2 gae_duplicate tensor(-0.3078, dtype=torch.float64) tensor(0.1367, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1074.2166748046875
value loss:36.126869201660156
entropies:354.051025390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.561988115310669 seconds
19 rew tensor(0.4957, dtype=torch.float64) delta_t tensor(0.1168, dtype=torch.float64)
19 gae_duplicate tensor(0.0221, dtype=torch.float64) tensor(-2.3052, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3415, dtype=torch.float64) delta_t tensor(-0.0291, dtype=torch.float64)
18 gae_duplicate tensor(-0.0645, dtype=torch.float64) tensor(0.3411, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5296, dtype=torch.float64) delta_t tensor(0.1123, dtype=torch.float64)
17 gae_duplicate tensor(0.0730, dtype=torch.float64) tensor(-2.2290, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2743, dtype=torch.float64) delta_t tensor(-0.1476, dtype=torch.float64)
16 gae_duplicate tensor(-0.2544, dtype=torch.float64) tensor(2.8216, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5164, dtype=torch.float64) delta_t tensor(-0.0137, dtype=torch.float64)
15 gae_duplicate tensor(-0.2281, dtype=torch.float64) tensor(0.5556, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2208, dtype=torch.float64) delta_t tensor(0.1081, dtype=torch.float64)
14 gae_duplicate tensor(-0.3224, dtype=torch.float64) tensor(-1.9313, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5304, dtype=torch.float64) delta_t tensor(0.1382, dtype=torch.float64)
13 gae_duplicate tensor(-0.1645, dtype=torch.float64) tensor(-2.7891, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2209, dtype=torch.float64) delta_t tensor(0.0297, dtype=torch.float64)
12 gae_duplicate tensor(-0.1886, dtype=torch.float64) tensor(-0.9156, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5371, dtype=torch.float64) delta_t tensor(0.1649, dtype=torch.float64)
11 gae_duplicate tensor(0.0556, dtype=torch.float64) tensor(-3.3334, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2348, dtype=torch.float64) delta_t tensor(-0.1024, dtype=torch.float64)
10 gae_duplicate tensor(-0.2442, dtype=torch.float64) tensor(1.7245, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5440, dtype=torch.float64) delta_t tensor(0.0997, dtype=torch.float64)
9 gae_duplicate tensor(-0.0467, dtype=torch.float64) tensor(-1.7383, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1949, dtype=torch.float64) delta_t tensor(-0.1215, dtype=torch.float64)
8 gae_duplicate tensor(-0.2613, dtype=torch.float64) tensor(2.2059, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5040, dtype=torch.float64) delta_t tensor(0.0453, dtype=torch.float64)
7 gae_duplicate tensor(-0.0928, dtype=torch.float64) tensor(-0.6744, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1551, dtype=torch.float64) delta_t tensor(-0.0313, dtype=torch.float64)
6 gae_duplicate tensor(-0.2182, dtype=torch.float64) tensor(0.5538, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1304, dtype=torch.float64) delta_t tensor(0.5820, dtype=torch.float64)
5 gae_duplicate tensor(-0.5588, dtype=torch.float64) tensor(-11.1030, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5549, dtype=torch.float64) delta_t tensor(0.1711, dtype=torch.float64)
4 gae_duplicate tensor(-1.9566, dtype=torch.float64) tensor(-3.3857, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1623, dtype=torch.float64) delta_t tensor(0.2526, dtype=torch.float64)
3 gae_duplicate tensor(-0.4065, dtype=torch.float64) tensor(-5.2923, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1823, dtype=torch.float64) delta_t tensor(0.0064, dtype=torch.float64)
2 gae_duplicate tensor(-0.1850, dtype=torch.float64) tensor(-0.6171, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1422.5526123046875
value loss:34.191795349121094
entropies:353.64068603515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.362498044967651 seconds
19 rew tensor(0.5232, dtype=torch.float64) delta_t tensor(0.1495, dtype=torch.float64)
19 gae_duplicate tensor(0.0687, dtype=torch.float64) tensor(-2.9112, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3364, dtype=torch.float64) delta_t tensor(-0.0185, dtype=torch.float64)
18 gae_duplicate tensor(-0.1174, dtype=torch.float64) tensor(0.0996, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5235, dtype=torch.float64) delta_t tensor(0.1448, dtype=torch.float64)
17 gae_duplicate tensor(0.0381, dtype=torch.float64) tensor(-2.7436, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3300, dtype=torch.float64) delta_t tensor(0.0300, dtype=torch.float64)
16 gae_duplicate tensor(-0.2207, dtype=torch.float64) tensor(-0.6278, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5100, dtype=torch.float64) delta_t tensor(-0.0663, dtype=torch.float64)
15 gae_duplicate tensor(-0.2348, dtype=torch.float64) tensor(1.1614, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2690, dtype=torch.float64) delta_t tensor(0.1461, dtype=torch.float64)
14 gae_duplicate tensor(-0.3896, dtype=torch.float64) tensor(-2.5819, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5308, dtype=torch.float64) delta_t tensor(-0.0269, dtype=torch.float64)
13 gae_duplicate tensor(-0.3877, dtype=torch.float64) tensor(0.2662, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2629, dtype=torch.float64) delta_t tensor(0.0624, dtype=torch.float64)
12 gae_duplicate tensor(-0.0728, dtype=torch.float64) tensor(-1.2621, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5380, dtype=torch.float64) delta_t tensor(0.1697, dtype=torch.float64)
11 gae_duplicate tensor(0.0357, dtype=torch.float64) tensor(-3.5858, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2764, dtype=torch.float64) delta_t tensor(-0.0535, dtype=torch.float64)
10 gae_duplicate tensor(-0.1625, dtype=torch.float64) tensor(0.6770, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5448, dtype=torch.float64) delta_t tensor(0.1246, dtype=torch.float64)
9 gae_duplicate tensor(0.0297, dtype=torch.float64) tensor(-2.3152, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2364, dtype=torch.float64) delta_t tensor(-0.1071, dtype=torch.float64)
8 gae_duplicate tensor(-0.2162, dtype=torch.float64) tensor(1.8480, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5046, dtype=torch.float64) delta_t tensor(0.0100, dtype=torch.float64)
7 gae_duplicate tensor(-0.1061, dtype=torch.float64) tensor(0.0143, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1964, dtype=torch.float64) delta_t tensor(-0.0273, dtype=torch.float64)
6 gae_duplicate tensor(-0.1926, dtype=torch.float64) tensor(0.6106, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3855, dtype=torch.float64) delta_t tensor(0.0584, dtype=torch.float64)
5 gae_duplicate tensor(-0.2675, dtype=torch.float64) tensor(-1.1554, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2928, dtype=torch.float64) delta_t tensor(0.4281, dtype=torch.float64)
4 gae_duplicate tensor(-0.4195, dtype=torch.float64) tensor(-9.0295, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0502, dtype=torch.float64) delta_t tensor(0.3442, dtype=torch.float64)
3 gae_duplicate tensor(-0.2051, dtype=torch.float64) tensor(-7.4496, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2085, dtype=torch.float64) delta_t tensor(-0.1091, dtype=torch.float64)
2 gae_duplicate tensor(-0.4214, dtype=torch.float64) tensor(1.3448, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1397.24658203125
value loss:18.548490524291992
entropies:353.0596923828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.5484938621521 seconds
19 rew tensor(0.5500, dtype=torch.float64) delta_t tensor(0.1687, dtype=torch.float64)
19 gae_duplicate tensor(0.0908, dtype=torch.float64) tensor(-3.3473, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3280, dtype=torch.float64) delta_t tensor(-0.0227, dtype=torch.float64)
18 gae_duplicate tensor(-0.2569, dtype=torch.float64) tensor(0.1774, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5503, dtype=torch.float64) delta_t tensor(0.1209, dtype=torch.float64)
17 gae_duplicate tensor(-0.2254, dtype=torch.float64) tensor(-2.4314, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3080, dtype=torch.float64) delta_t tensor(-0.1026, dtype=torch.float64)
16 gae_duplicate tensor(-0.2462, dtype=torch.float64) tensor(1.7616, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5169, dtype=torch.float64) delta_t tensor(-0.2653, dtype=torch.float64)
15 gae_duplicate tensor(-0.6564, dtype=torch.float64) tensor(5.1158, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1940, dtype=torch.float64) delta_t tensor(0.2068, dtype=torch.float64)
14 gae_duplicate tensor(-0.0377, dtype=torch.float64) tensor(-3.3846, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5372, dtype=torch.float64) delta_t tensor(0.2081, dtype=torch.float64)
13 gae_duplicate tensor(0.0516, dtype=torch.float64) tensor(-4.2855, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2076, dtype=torch.float64) delta_t tensor(-0.1313, dtype=torch.float64)
12 gae_duplicate tensor(-0.2612, dtype=torch.float64) tensor(2.1516, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5442, dtype=torch.float64) delta_t tensor(0.1094, dtype=torch.float64)
11 gae_duplicate tensor(0.0291, dtype=torch.float64) tensor(-1.8187, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2080, dtype=torch.float64) delta_t tensor(-0.1187, dtype=torch.float64)
10 gae_duplicate tensor(-0.2668, dtype=torch.float64) tensor(2.1686, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5309, dtype=torch.float64) delta_t tensor(0.0420, dtype=torch.float64)
9 gae_duplicate tensor(-0.0668, dtype=torch.float64) tensor(-0.6540, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1545, dtype=torch.float64) delta_t tensor(-0.1783, dtype=torch.float64)
8 gae_duplicate tensor(-0.3604, dtype=torch.float64) tensor(3.6770, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4907, dtype=torch.float64) delta_t tensor(-0.0068, dtype=torch.float64)
7 gae_duplicate tensor(-0.1143, dtype=torch.float64) tensor(0.4123, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0876, dtype=torch.float64) delta_t tensor(-0.1304, dtype=torch.float64)
6 gae_duplicate tensor(-0.3255, dtype=torch.float64) tensor(2.7200, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2247, dtype=torch.float64) delta_t tensor(0.2755, dtype=torch.float64)
5 gae_duplicate tensor(-1.6683, dtype=torch.float64) tensor(-5.1935, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.8157, dtype=torch.float64) delta_t tensor(-0.9128, dtype=torch.float64)
4 gae_duplicate tensor(-2.0255, dtype=torch.float64) tensor(16.2207, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0702, dtype=torch.float64) delta_t tensor(0.1972, dtype=torch.float64)
3 gae_duplicate tensor(-0.5571, dtype=torch.float64) tensor(-2.2205, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1438, dtype=torch.float64) delta_t tensor(0.0828, dtype=torch.float64)
2 gae_duplicate tensor(-0.3866, dtype=torch.float64) tensor(-2.0119, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-584.2911987304688
value loss:40.26599884033203
entropies:352.5097351074219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.413918972015381 seconds
19 rew tensor(0.5167, dtype=torch.float64) delta_t tensor(0.1324, dtype=torch.float64)
19 gae_duplicate tensor(0.0597, dtype=torch.float64) tensor(-2.5749, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2476, dtype=torch.float64) delta_t tensor(-0.0988, dtype=torch.float64)
18 gae_duplicate tensor(-0.2042, dtype=torch.float64) tensor(1.7498, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5444, dtype=torch.float64) delta_t tensor(0.1332, dtype=torch.float64)
17 gae_duplicate tensor(0.0809, dtype=torch.float64) tensor(-2.4512, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2204, dtype=torch.float64) delta_t tensor(-0.1418, dtype=torch.float64)
16 gae_duplicate tensor(-0.2855, dtype=torch.float64) tensor(2.5093, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5381, dtype=torch.float64) delta_t tensor(-0.0340, dtype=torch.float64)
15 gae_duplicate tensor(-0.3877, dtype=torch.float64) tensor(1.0679, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2074, dtype=torch.float64) delta_t tensor(-0.0580, dtype=torch.float64)
14 gae_duplicate tensor(-0.2896, dtype=torch.float64) tensor(1.2457, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2624, dtype=torch.float64) delta_t tensor(-0.4141, dtype=torch.float64)
13 gae_duplicate tensor(-1.8754, dtype=torch.float64) tensor(7.5815, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2006, dtype=torch.float64) delta_t tensor(-0.0188, dtype=torch.float64)
12 gae_duplicate tensor(-0.2116, dtype=torch.float64) tensor(1.1784, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5381, dtype=torch.float64) delta_t tensor(0.1708, dtype=torch.float64)
11 gae_duplicate tensor(0.0203, dtype=torch.float64) tensor(-3.4464, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2145, dtype=torch.float64) delta_t tensor(-0.1271, dtype=torch.float64)
10 gae_duplicate tensor(-0.2356, dtype=torch.float64) tensor(2.0614, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5450, dtype=torch.float64) delta_t tensor(0.1244, dtype=torch.float64)
9 gae_duplicate tensor(-0.0080, dtype=torch.float64) tensor(-2.2339, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1812, dtype=torch.float64) delta_t tensor(-0.1063, dtype=torch.float64)
8 gae_duplicate tensor(-0.2107, dtype=torch.float64) tensor(1.9844, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5048, dtype=torch.float64) delta_t tensor(0.0683, dtype=torch.float64)
7 gae_duplicate tensor(-0.0974, dtype=torch.float64) tensor(-1.0394, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1411, dtype=torch.float64) delta_t tensor(-0.0077, dtype=torch.float64)
6 gae_duplicate tensor(-0.2317, dtype=torch.float64) tensor(0.0954, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9863, dtype=torch.float64) delta_t tensor(0.2429, dtype=torch.float64)
5 gae_duplicate tensor(-0.3893, dtype=torch.float64) tensor(-4.6550, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1219, dtype=torch.float64) delta_t tensor(0.0513, dtype=torch.float64)
4 gae_duplicate tensor(-2.4138, dtype=torch.float64) tensor(-1.2621, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0288, dtype=torch.float64) delta_t tensor(0.3328, dtype=torch.float64)
3 gae_duplicate tensor(-0.0995, dtype=torch.float64) tensor(-6.9607, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2919, dtype=torch.float64) delta_t tensor(-0.1042, dtype=torch.float64)
2 gae_duplicate tensor(-0.4129, dtype=torch.float64) tensor(1.6014, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:96.52346801757812
value loss:47.660526275634766
entropies:352.18548583984375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3924.7451)
ToM Target loss= tensor(3591.7981)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.343470811843872 seconds
19 rew tensor(0.4972, dtype=torch.float64) delta_t tensor(0.0834, dtype=torch.float64)
19 gae_duplicate tensor(0.0130, dtype=torch.float64) tensor(-1.5583, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4767, dtype=torch.float64) delta_t tensor(0.0755, dtype=torch.float64)
18 gae_duplicate tensor(-0.0414, dtype=torch.float64) tensor(-1.6560, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4909, dtype=torch.float64) delta_t tensor(0.0526, dtype=torch.float64)
17 gae_duplicate tensor(-0.0649, dtype=torch.float64) tensor(-1.2822, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4430, dtype=torch.float64) delta_t tensor(0.1178, dtype=torch.float64)
16 gae_duplicate tensor(-0.1267, dtype=torch.float64) tensor(-2.4319, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4433, dtype=torch.float64) delta_t tensor(-0.1448, dtype=torch.float64)
15 gae_duplicate tensor(-0.5556, dtype=torch.float64) tensor(2.6576, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3549, dtype=torch.float64) delta_t tensor(-0.0522, dtype=torch.float64)
14 gae_duplicate tensor(-0.4455, dtype=torch.float64) tensor(1.4460, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4915, dtype=torch.float64) delta_t tensor(0.0744, dtype=torch.float64)
13 gae_duplicate tensor(-0.4803, dtype=torch.float64) tensor(-1.3290, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3072, dtype=torch.float64) delta_t tensor(-0.0362, dtype=torch.float64)
12 gae_duplicate tensor(-0.2425, dtype=torch.float64) tensor(0.7090, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5052, dtype=torch.float64) delta_t tensor(0.0722, dtype=torch.float64)
11 gae_duplicate tensor(-0.0352, dtype=torch.float64) tensor(-1.2816, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3143, dtype=torch.float64) delta_t tensor(-0.0242, dtype=torch.float64)
10 gae_duplicate tensor(-0.2298, dtype=torch.float64) tensor(0.2989, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4918, dtype=torch.float64) delta_t tensor(0.0324, dtype=torch.float64)
9 gae_duplicate tensor(-0.0227, dtype=torch.float64) tensor(-0.6031, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2604, dtype=torch.float64) delta_t tensor(-0.1019, dtype=torch.float64)
8 gae_duplicate tensor(-0.3693, dtype=torch.float64) tensor(1.7880, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4652, dtype=torch.float64) delta_t tensor(-0.0619, dtype=torch.float64)
7 gae_duplicate tensor(-0.2409, dtype=torch.float64) tensor(1.3545, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1799, dtype=torch.float64) delta_t tensor(-0.0439, dtype=torch.float64)
6 gae_duplicate tensor(-0.1371, dtype=torch.float64) tensor(0.9620, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1378, dtype=torch.float64) delta_t tensor(0.0797, dtype=torch.float64)
5 gae_duplicate tensor(-1.0695, dtype=torch.float64) tensor(-1.8329, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8764, dtype=torch.float64) delta_t tensor(-0.1622, dtype=torch.float64)
4 gae_duplicate tensor(-2.3700, dtype=torch.float64) tensor(3.4876, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1176, dtype=torch.float64) delta_t tensor(0.2028, dtype=torch.float64)
3 gae_duplicate tensor(-0.2911, dtype=torch.float64) tensor(-3.8447, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2111, dtype=torch.float64) delta_t tensor(-0.0326, dtype=torch.float64)
2 gae_duplicate tensor(-0.2931, dtype=torch.float64) tensor(0.3953, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:51.90239334106445
value loss:33.65803909301758
entropies:351.9497985839844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.15578818321228 seconds
19 rew tensor(0.5230, dtype=torch.float64) delta_t tensor(0.1386, dtype=torch.float64)
19 gae_duplicate tensor(-0.1286, dtype=torch.float64) tensor(-2.5672, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3948, dtype=torch.float64) delta_t tensor(0.0002, dtype=torch.float64)
18 gae_duplicate tensor(-0.2499, dtype=torch.float64) tensor(-0.2756, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5435, dtype=torch.float64) delta_t tensor(0.1489, dtype=torch.float64)
17 gae_duplicate tensor(0.0152, dtype=torch.float64) tensor(-2.7464, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3342, dtype=torch.float64) delta_t tensor(-0.0702, dtype=torch.float64)
16 gae_duplicate tensor(-0.3941, dtype=torch.float64) tensor(1.0370, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4972, dtype=torch.float64) delta_t tensor(-0.0585, dtype=torch.float64)
15 gae_duplicate tensor(-0.5031, dtype=torch.float64) tensor(1.2778, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2133, dtype=torch.float64) delta_t tensor(-0.0254, dtype=torch.float64)
14 gae_duplicate tensor(-0.3735, dtype=torch.float64) tensor(0.4570, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5238, dtype=torch.float64) delta_t tensor(0.0966, dtype=torch.float64)
13 gae_duplicate tensor(-0.5875, dtype=torch.float64) tensor(-1.8389, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1605, dtype=torch.float64) delta_t tensor(-0.1048, dtype=torch.float64)
12 gae_duplicate tensor(-0.2823, dtype=torch.float64) tensor(1.9265, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5442, dtype=torch.float64) delta_t tensor(0.1384, dtype=torch.float64)
11 gae_duplicate tensor(0.0629, dtype=torch.float64) tensor(-2.4284, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1677, dtype=torch.float64) delta_t tensor(-0.1596, dtype=torch.float64)
10 gae_duplicate tensor(-0.4303, dtype=torch.float64) tensor(3.0039, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5308, dtype=torch.float64) delta_t tensor(0.0405, dtype=torch.float64)
9 gae_duplicate tensor(-0.0868, dtype=torch.float64) tensor(-0.4300, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1140, dtype=torch.float64) delta_t tensor(-0.1690, dtype=torch.float64)
8 gae_duplicate tensor(-0.3704, dtype=torch.float64) tensor(3.3775, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4709, dtype=torch.float64) delta_t tensor(0.0782, dtype=torch.float64)
7 gae_duplicate tensor(-0.1085, dtype=torch.float64) tensor(-1.1538, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0338, dtype=torch.float64) delta_t tensor(-0.0075, dtype=torch.float64)
6 gae_duplicate tensor(-0.2683, dtype=torch.float64) tensor(-0.2297, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1130, dtype=torch.float64) delta_t tensor(0.3038, dtype=torch.float64)
5 gae_duplicate tensor(-0.7018, dtype=torch.float64) tensor(-5.5126, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5121, dtype=torch.float64) delta_t tensor(-1.4190, dtype=torch.float64)
4 gae_duplicate tensor(-6.7428, dtype=torch.float64) tensor(26.8866, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0117, dtype=torch.float64) delta_t tensor(0.3986, dtype=torch.float64)
3 gae_duplicate tensor(-0.4146, dtype=torch.float64) tensor(-4.6877, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1325, dtype=torch.float64) delta_t tensor(0.0191, dtype=torch.float64)
2 gae_duplicate tensor(-0.8122, dtype=torch.float64) tensor(-0.7412, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-924.1282348632812
value loss:83.72210693359375
entropies:351.7008972167969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.108807802200317 seconds
19 rew tensor(0.5166, dtype=torch.float64) delta_t tensor(0.0999, dtype=torch.float64)
19 gae_duplicate tensor(-0.0143, dtype=torch.float64) tensor(-1.6706, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3747, dtype=torch.float64) delta_t tensor(-0.0111, dtype=torch.float64)
18 gae_duplicate tensor(-0.1560, dtype=torch.float64) tensor(-0.0048, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4958, dtype=torch.float64) delta_t tensor(0.0826, dtype=torch.float64)
17 gae_duplicate tensor(-0.0354, dtype=torch.float64) tensor(-1.4657, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3219, dtype=torch.float64) delta_t tensor(-0.1909, dtype=torch.float64)
16 gae_duplicate tensor(-0.4327, dtype=torch.float64) tensor(3.3122, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4829, dtype=torch.float64) delta_t tensor(-0.2148, dtype=torch.float64)
15 gae_duplicate tensor(-0.5656, dtype=torch.float64) tensor(4.8251, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3082, dtype=torch.float64) delta_t tensor(0.0871, dtype=torch.float64)
14 gae_duplicate tensor(-0.2337, dtype=torch.float64) tensor(-1.3331, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4830, dtype=torch.float64) delta_t tensor(-0.0520, dtype=torch.float64)
13 gae_duplicate tensor(-0.5198, dtype=torch.float64) tensor(0.9326, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2753, dtype=torch.float64) delta_t tensor(0.0314, dtype=torch.float64)
12 gae_duplicate tensor(-0.1435, dtype=torch.float64) tensor(-0.5079, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5370, dtype=torch.float64) delta_t tensor(0.1683, dtype=torch.float64)
11 gae_duplicate tensor(-0.0030, dtype=torch.float64) tensor(-3.7169, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2352, dtype=torch.float64) delta_t tensor(-0.0395, dtype=torch.float64)
10 gae_duplicate tensor(-0.2079, dtype=torch.float64) tensor(0.5432, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5305, dtype=torch.float64) delta_t tensor(0.1406, dtype=torch.float64)
9 gae_duplicate tensor(0.0334, dtype=torch.float64) tensor(-2.8493, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1818, dtype=torch.float64) delta_t tensor(-0.1117, dtype=torch.float64)
8 gae_duplicate tensor(-0.1919, dtype=torch.float64) tensor(2.0012, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4903, dtype=torch.float64) delta_t tensor(0.0314, dtype=torch.float64)
7 gae_duplicate tensor(-0.1208, dtype=torch.float64) tensor(-0.5587, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1150, dtype=torch.float64) delta_t tensor(0.0284, dtype=torch.float64)
6 gae_duplicate tensor(-0.1697, dtype=torch.float64) tensor(-0.6388, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5064, dtype=torch.float64) delta_t tensor(-0.3652, dtype=torch.float64)
5 gae_duplicate tensor(-1.2768, dtype=torch.float64) tensor(6.7457, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.4441, dtype=torch.float64) delta_t tensor(-1.6236, dtype=torch.float64)
4 gae_duplicate tensor(-4.2853, dtype=torch.float64) tensor(33.7094, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0638, dtype=torch.float64) delta_t tensor(-0.0034, dtype=torch.float64)
3 gae_duplicate tensor(-0.6515, dtype=torch.float64) tensor(3.3391, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1320, dtype=torch.float64) delta_t tensor(0.0453, dtype=torch.float64)
2 gae_duplicate tensor(-0.4762, dtype=torch.float64) tensor(-0.6634, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2362.798095703125
value loss:65.45922088623047
entropies:351.2278747558594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.556490898132324 seconds
19 rew tensor(0.4478, dtype=torch.float64) delta_t tensor(0.1570, dtype=torch.float64)
19 gae_duplicate tensor(0.0817, dtype=torch.float64) tensor(-3.1778, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3878, dtype=torch.float64) delta_t tensor(0.0705, dtype=torch.float64)
18 gae_duplicate tensor(0.0347, dtype=torch.float64) tensor(-1.7375, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5226, dtype=torch.float64) delta_t tensor(0.1772, dtype=torch.float64)
17 gae_duplicate tensor(0.1309, dtype=torch.float64) tensor(-3.4804, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2538, dtype=torch.float64) delta_t tensor(-0.0189, dtype=torch.float64)
16 gae_duplicate tensor(-0.2009, dtype=torch.float64) tensor(0.0682, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5163, dtype=torch.float64) delta_t tensor(-0.1493, dtype=torch.float64)
15 gae_duplicate tensor(-0.4802, dtype=torch.float64) tensor(3.0159, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2137, dtype=torch.float64) delta_t tensor(-0.0509, dtype=torch.float64)
14 gae_duplicate tensor(-0.5035, dtype=torch.float64) tensor(1.0879, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5367, dtype=torch.float64) delta_t tensor(0.0075, dtype=torch.float64)
13 gae_duplicate tensor(-0.3550, dtype=torch.float64) tensor(0.1993, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2207, dtype=torch.float64) delta_t tensor(-0.0022, dtype=torch.float64)
12 gae_duplicate tensor(-0.1127, dtype=torch.float64) tensor(0.0477, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5435, dtype=torch.float64) delta_t tensor(0.1642, dtype=torch.float64)
11 gae_duplicate tensor(0.1189, dtype=torch.float64) tensor(-3.1419, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2345, dtype=torch.float64) delta_t tensor(-0.0499, dtype=torch.float64)
10 gae_duplicate tensor(-0.1913, dtype=torch.float64) tensor(0.6715, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5437, dtype=torch.float64) delta_t tensor(0.1120, dtype=torch.float64)
9 gae_duplicate tensor(0.0531, dtype=torch.float64) tensor(-2.0881, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1945, dtype=torch.float64) delta_t tensor(-0.0694, dtype=torch.float64)
8 gae_duplicate tensor(-0.1557, dtype=torch.float64) tensor(1.1837, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5037, dtype=torch.float64) delta_t tensor(0.0194, dtype=torch.float64)
7 gae_duplicate tensor(-0.1293, dtype=torch.float64) tensor(-0.2567, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1546, dtype=torch.float64) delta_t tensor(-0.0033, dtype=torch.float64)
6 gae_duplicate tensor(-0.0861, dtype=torch.float64) tensor(0.0611, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9510, dtype=torch.float64) delta_t tensor(-0.5263, dtype=torch.float64)
5 gae_duplicate tensor(-1.4727, dtype=torch.float64) tensor(10.5668, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0513, dtype=torch.float64) delta_t tensor(-1.5331, dtype=torch.float64)
4 gae_duplicate tensor(-2.8263, dtype=torch.float64) tensor(32.0307, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0577, dtype=torch.float64) delta_t tensor(0.3445, dtype=torch.float64)
3 gae_duplicate tensor(-0.4026, dtype=torch.float64) tensor(-3.1717, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1700, dtype=torch.float64) delta_t tensor(0.0356, dtype=torch.float64)
2 gae_duplicate tensor(-0.3150, dtype=torch.float64) tensor(-0.8472, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1770.34912109375
value loss:47.100311279296875
entropies:350.5685729980469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 6.030125141143799 seconds
19 rew tensor(0.5094, dtype=torch.float64) delta_t tensor(0.2821, dtype=torch.float64)
19 gae_duplicate tensor(0.1298, dtype=torch.float64) tensor(-5.0890, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3883, dtype=torch.float64) delta_t tensor(0.1237, dtype=torch.float64)
18 gae_duplicate tensor(0.0405, dtype=torch.float64) tensor(-3.0364, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5299, dtype=torch.float64) delta_t tensor(0.2912, dtype=torch.float64)
17 gae_duplicate tensor(0.2230, dtype=torch.float64) tensor(-5.5074, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1976, dtype=torch.float64) delta_t tensor(-0.2184, dtype=torch.float64)
16 gae_duplicate tensor(-0.8830, dtype=torch.float64) tensor(3.2262, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5233, dtype=torch.float64) delta_t tensor(-0.0082, dtype=torch.float64)
15 gae_duplicate tensor(-0.3422, dtype=torch.float64) tensor(0.7958, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2323, dtype=torch.float64) delta_t tensor(-0.1381, dtype=torch.float64)
14 gae_duplicate tensor(-0.5154, dtype=torch.float64) tensor(2.5783, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5169, dtype=torch.float64) delta_t tensor(0.1318, dtype=torch.float64)
13 gae_duplicate tensor(-0.3123, dtype=torch.float64) tensor(-2.3320, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2264, dtype=torch.float64) delta_t tensor(0.0760, dtype=torch.float64)
12 gae_duplicate tensor(-0.1526, dtype=torch.float64) tensor(-1.9692, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5372, dtype=torch.float64) delta_t tensor(0.2281, dtype=torch.float64)
11 gae_duplicate tensor(0.1535, dtype=torch.float64) tensor(-4.4027, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2201, dtype=torch.float64) delta_t tensor(0.0011, dtype=torch.float64)
10 gae_duplicate tensor(-0.0762, dtype=torch.float64) tensor(-0.4125, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5303, dtype=torch.float64) delta_t tensor(0.1680, dtype=torch.float64)
9 gae_duplicate tensor(0.0272, dtype=torch.float64) tensor(-3.4019, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1664, dtype=torch.float64) delta_t tensor(-0.0363, dtype=torch.float64)
8 gae_duplicate tensor(-0.2434, dtype=torch.float64) tensor(0.3744, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5039, dtype=torch.float64) delta_t tensor(0.1119, dtype=torch.float64)
7 gae_duplicate tensor(-0.0968, dtype=torch.float64) tensor(-2.1167, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1127, dtype=torch.float64) delta_t tensor(-0.0157, dtype=torch.float64)
6 gae_duplicate tensor(-0.1522, dtype=torch.float64) tensor(0.0160, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2498, dtype=torch.float64) delta_t tensor(-0.2415, dtype=torch.float64)
5 gae_duplicate tensor(-0.7806, dtype=torch.float64) tensor(5.1520, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1595, dtype=torch.float64) delta_t tensor(-0.9769, dtype=torch.float64)
4 gae_duplicate tensor(-2.4959, dtype=torch.float64) tensor(18.2528, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0175, dtype=torch.float64) delta_t tensor(0.5206, dtype=torch.float64)
3 gae_duplicate tensor(0.0495, dtype=torch.float64) tensor(-8.0904, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2368, dtype=torch.float64) delta_t tensor(-0.0787, dtype=torch.float64)
2 gae_duplicate tensor(-0.3827, dtype=torch.float64) tensor(1.1924, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:163.1840362548828
value loss:28.057533264160156
entropies:349.6694030761719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3915.6860)
ToM Target loss= tensor(3610.4624)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.399139881134033 seconds
19 rew tensor(0.4895, dtype=torch.float64) delta_t tensor(0.2122, dtype=torch.float64)
19 gae_duplicate tensor(0.0592, dtype=torch.float64) tensor(-3.9619, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4155, dtype=torch.float64) delta_t tensor(0.0942, dtype=torch.float64)
18 gae_duplicate tensor(-0.0203, dtype=torch.float64) tensor(-2.4931, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5043, dtype=torch.float64) delta_t tensor(0.2120, dtype=torch.float64)
17 gae_duplicate tensor(0.0257, dtype=torch.float64) tensor(-3.9408, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2661, dtype=torch.float64) delta_t tensor(-0.1045, dtype=torch.float64)
16 gae_duplicate tensor(-0.1987, dtype=torch.float64) tensor(1.4543, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4968, dtype=torch.float64) delta_t tensor(-0.1404, dtype=torch.float64)
15 gae_duplicate tensor(-0.3572, dtype=torch.float64) tensor(2.6059, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1993, dtype=torch.float64) delta_t tensor(0.2457, dtype=torch.float64)
14 gae_duplicate tensor(0.0997, dtype=torch.float64) tensor(-5.0998, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5378, dtype=torch.float64) delta_t tensor(0.2401, dtype=torch.float64)
13 gae_duplicate tensor(0.1697, dtype=torch.float64) tensor(-5.1864, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1664, dtype=torch.float64) delta_t tensor(-0.0189, dtype=torch.float64)
12 gae_duplicate tensor(-0.0797, dtype=torch.float64) tensor(-0.1648, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5446, dtype=torch.float64) delta_t tensor(0.2093, dtype=torch.float64)
11 gae_duplicate tensor(0.1637, dtype=torch.float64) tensor(-4.1613, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1667, dtype=torch.float64) delta_t tensor(0.0134, dtype=torch.float64)
10 gae_duplicate tensor(-0.0728, dtype=torch.float64) tensor(-0.6722, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5447, dtype=torch.float64) delta_t tensor(0.1566, dtype=torch.float64)
9 gae_duplicate tensor(0.1178, dtype=torch.float64) tensor(-2.9509, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1267, dtype=torch.float64) delta_t tensor(-0.0596, dtype=torch.float64)
8 gae_duplicate tensor(-0.1421, dtype=torch.float64) tensor(0.8717, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4513, dtype=torch.float64) delta_t tensor(0.1627, dtype=torch.float64)
7 gae_duplicate tensor(0.0562, dtype=torch.float64) tensor(-3.2243, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0335, dtype=torch.float64) delta_t tensor(0.0129, dtype=torch.float64)
6 gae_duplicate tensor(-0.1414, dtype=torch.float64) tensor(-0.7823, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3572, dtype=torch.float64) delta_t tensor(0.1822, dtype=torch.float64)
5 gae_duplicate tensor(-0.7830, dtype=torch.float64) tensor(-3.5240, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0648, dtype=torch.float64) delta_t tensor(-0.3872, dtype=torch.float64)
4 gae_duplicate tensor(-2.0063, dtype=torch.float64) tensor(6.3362, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1042, dtype=torch.float64) delta_t tensor(0.5257, dtype=torch.float64)
3 gae_duplicate tensor(0.0059, dtype=torch.float64) tensor(-9.5200, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1843, dtype=torch.float64) delta_t tensor(0.0675, dtype=torch.float64)
2 gae_duplicate tensor(-0.2743, dtype=torch.float64) tensor(-1.8122, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1862.0384521484375
value loss:19.416234970092773
entropies:348.7969665527344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.204895973205566 seconds
19 rew tensor(0.5102, dtype=torch.float64) delta_t tensor(0.2821, dtype=torch.float64)
19 gae_duplicate tensor(0.1629, dtype=torch.float64) tensor(-5.5289, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3623, dtype=torch.float64) delta_t tensor(0.1687, dtype=torch.float64)
18 gae_duplicate tensor(0.0331, dtype=torch.float64) tensor(-3.8805, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5236, dtype=torch.float64) delta_t tensor(0.2191, dtype=torch.float64)
17 gae_duplicate tensor(0.1221, dtype=torch.float64) tensor(-4.6795, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3496, dtype=torch.float64) delta_t tensor(0.0950, dtype=torch.float64)
16 gae_duplicate tensor(0.0804, dtype=torch.float64) tensor(-2.0761, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5104, dtype=torch.float64) delta_t tensor(0.0301, dtype=torch.float64)
15 gae_duplicate tensor(-0.1374, dtype=torch.float64) tensor(-0.8169, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3024, dtype=torch.float64) delta_t tensor(0.0793, dtype=torch.float64)
14 gae_duplicate tensor(-0.0988, dtype=torch.float64) tensor(-1.6794, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5377, dtype=torch.float64) delta_t tensor(0.1283, dtype=torch.float64)
13 gae_duplicate tensor(-0.3547, dtype=torch.float64) tensor(-2.8025, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2888, dtype=torch.float64) delta_t tensor(0.1967, dtype=torch.float64)
12 gae_duplicate tensor(0.0402, dtype=torch.float64) tensor(-3.9645, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5313, dtype=torch.float64) delta_t tensor(0.2868, dtype=torch.float64)
11 gae_duplicate tensor(0.1964, dtype=torch.float64) tensor(-5.5966, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3026, dtype=torch.float64) delta_t tensor(0.1133, dtype=torch.float64)
10 gae_duplicate tensor(0.1113, dtype=torch.float64) tensor(-2.6395, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5450, dtype=torch.float64) delta_t tensor(0.2451, dtype=torch.float64)
9 gae_duplicate tensor(0.1829, dtype=torch.float64) tensor(-5.0471, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2626, dtype=torch.float64) delta_t tensor(0.0854, dtype=torch.float64)
8 gae_duplicate tensor(0.0361, dtype=torch.float64) tensor(-2.0029, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5049, dtype=torch.float64) delta_t tensor(0.1212, dtype=torch.float64)
7 gae_duplicate tensor(0.0522, dtype=torch.float64) tensor(-2.7749, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2226, dtype=torch.float64) delta_t tensor(0.1763, dtype=torch.float64)
6 gae_duplicate tensor(0.0488, dtype=torch.float64) tensor(-3.5394, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2737, dtype=torch.float64) delta_t tensor(0.3472, dtype=torch.float64)
5 gae_duplicate tensor(-0.6231, dtype=torch.float64) tensor(-7.7598, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5753, dtype=torch.float64) delta_t tensor(-0.6331, dtype=torch.float64)
4 gae_duplicate tensor(-1.8939, dtype=torch.float64) tensor(10.7025, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0767, dtype=torch.float64) delta_t tensor(0.5920, dtype=torch.float64)
3 gae_duplicate tensor(0.2597, dtype=torch.float64) tensor(-10.4766, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2243, dtype=torch.float64) delta_t tensor(0.0989, dtype=torch.float64)
2 gae_duplicate tensor(-0.1436, dtype=torch.float64) tensor(-3.1289, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3021.31201171875
value loss:27.457387924194336
entropies:348.2823791503906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.052932977676392 seconds
19 rew tensor(0.5239, dtype=torch.float64) delta_t tensor(0.2292, dtype=torch.float64)
19 gae_duplicate tensor(0.1146, dtype=torch.float64) tensor(-4.3291, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4679, dtype=torch.float64) delta_t tensor(0.1278, dtype=torch.float64)
18 gae_duplicate tensor(0.0518, dtype=torch.float64) tensor(-2.8696, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4906, dtype=torch.float64) delta_t tensor(0.1936, dtype=torch.float64)
17 gae_duplicate tensor(0.1601, dtype=torch.float64) tensor(-3.8442, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2718, dtype=torch.float64) delta_t tensor(-0.2709, dtype=torch.float64)
16 gae_duplicate tensor(-0.9142, dtype=torch.float64) tensor(5.6824, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5100, dtype=torch.float64) delta_t tensor(-0.1462, dtype=torch.float64)
15 gae_duplicate tensor(-0.4454, dtype=torch.float64) tensor(2.7675, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2405, dtype=torch.float64) delta_t tensor(0.1624, dtype=torch.float64)
14 gae_duplicate tensor(-0.0980, dtype=torch.float64) tensor(-2.8799, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5302, dtype=torch.float64) delta_t tensor(0.2179, dtype=torch.float64)
13 gae_duplicate tensor(0.1320, dtype=torch.float64) tensor(-4.5342, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2477, dtype=torch.float64) delta_t tensor(-0.0123, dtype=torch.float64)
12 gae_duplicate tensor(-0.1434, dtype=torch.float64) tensor(-0.1085, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5441, dtype=torch.float64) delta_t tensor(0.1823, dtype=torch.float64)
11 gae_duplicate tensor(0.1583, dtype=torch.float64) tensor(-3.6819, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2480, dtype=torch.float64) delta_t tensor(0.0866, dtype=torch.float64)
10 gae_duplicate tensor(0.0884, dtype=torch.float64) tensor(-2.0039, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4902, dtype=torch.float64) delta_t tensor(0.0915, dtype=torch.float64)
9 gae_duplicate tensor(-0.0021, dtype=torch.float64) tensor(-2.2406, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1541, dtype=torch.float64) delta_t tensor(-0.0459, dtype=torch.float64)
8 gae_duplicate tensor(-0.2687, dtype=torch.float64) tensor(0.9244, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5041, dtype=torch.float64) delta_t tensor(0.0511, dtype=torch.float64)
7 gae_duplicate tensor(-0.0622, dtype=torch.float64) tensor(-1.1103, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0601, dtype=torch.float64) delta_t tensor(-0.0478, dtype=torch.float64)
6 gae_duplicate tensor(-0.2121, dtype=torch.float64) tensor(0.8114, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4871, dtype=torch.float64) delta_t tensor(0.4928, dtype=torch.float64)
5 gae_duplicate tensor(-0.2483, dtype=torch.float64) tensor(-10.1843, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.3053, dtype=torch.float64) delta_t tensor(-0.7364, dtype=torch.float64)
4 gae_duplicate tensor(-4.1030, dtype=torch.float64) tensor(12.9108, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0760, dtype=torch.float64) delta_t tensor(0.6060, dtype=torch.float64)
3 gae_duplicate tensor(-0.0070, dtype=torch.float64) tensor(-10.4960, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0760, dtype=torch.float64) delta_t tensor(0.2362, dtype=torch.float64)
2 gae_duplicate tensor(0.0783, dtype=torch.float64) tensor(-5.9177, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1585.614990234375
value loss:53.947731018066406
entropies:348.12506103515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.271970987319946 seconds
19 rew tensor(0.5232, dtype=torch.float64) delta_t tensor(0.1757, dtype=torch.float64)
19 gae_duplicate tensor(0.1086, dtype=torch.float64) tensor(-3.2430, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3457, dtype=torch.float64) delta_t tensor(0.0213, dtype=torch.float64)
18 gae_duplicate tensor(-0.0720, dtype=torch.float64) tensor(-0.7066, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4986, dtype=torch.float64) delta_t tensor(0.0851, dtype=torch.float64)
17 gae_duplicate tensor(-0.1659, dtype=torch.float64) tensor(-1.8480, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3324, dtype=torch.float64) delta_t tensor(-0.0772, dtype=torch.float64)
16 gae_duplicate tensor(-0.1777, dtype=torch.float64) tensor(1.2324, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4645, dtype=torch.float64) delta_t tensor(0.0145, dtype=torch.float64)
15 gae_duplicate tensor(-0.2171, dtype=torch.float64) tensor(-0.1239, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2463, dtype=torch.float64) delta_t tensor(-0.0386, dtype=torch.float64)
14 gae_duplicate tensor(-0.3811, dtype=torch.float64) tensor(0.3832, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5171, dtype=torch.float64) delta_t tensor(0.0227, dtype=torch.float64)
13 gae_duplicate tensor(-0.3727, dtype=torch.float64) tensor(-0.5408, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1810, dtype=torch.float64) delta_t tensor(0.0190, dtype=torch.float64)
12 gae_duplicate tensor(-0.1030, dtype=torch.float64) tensor(-0.3364, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5374, dtype=torch.float64) delta_t tensor(0.1519, dtype=torch.float64)
11 gae_duplicate tensor(0.0517, dtype=torch.float64) tensor(-3.0261, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1949, dtype=torch.float64) delta_t tensor(-0.0880, dtype=torch.float64)
10 gae_duplicate tensor(-0.1355, dtype=torch.float64) tensor(1.2615, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5442, dtype=torch.float64) delta_t tensor(0.1046, dtype=torch.float64)
9 gae_duplicate tensor(0.0245, dtype=torch.float64) tensor(-1.7429, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1549, dtype=torch.float64) delta_t tensor(-0.0957, dtype=torch.float64)
8 gae_duplicate tensor(-0.2445, dtype=torch.float64) tensor(1.5915, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5041, dtype=torch.float64) delta_t tensor(0.0817, dtype=torch.float64)
7 gae_duplicate tensor(-0.0968, dtype=torch.float64) tensor(-1.4732, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1149, dtype=torch.float64) delta_t tensor(-0.0436, dtype=torch.float64)
6 gae_duplicate tensor(-0.1677, dtype=torch.float64) tensor(0.7725, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1164, dtype=torch.float64) delta_t tensor(0.3881, dtype=torch.float64)
5 gae_duplicate tensor(-0.8450, dtype=torch.float64) tensor(-7.8823, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3558, dtype=torch.float64) delta_t tensor(-0.0604, dtype=torch.float64)
4 gae_duplicate tensor(-3.6376, dtype=torch.float64) tensor(-0.9081, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0843, dtype=torch.float64) delta_t tensor(0.5215, dtype=torch.float64)
3 gae_duplicate tensor(0.3360, dtype=torch.float64) tensor(-9.7632, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2388, dtype=torch.float64) delta_t tensor(-0.1237, dtype=torch.float64)
2 gae_duplicate tensor(-0.3180, dtype=torch.float64) tensor(1.6391, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1240.538330078125
value loss:51.42448806762695
entropies:348.2697448730469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.374678134918213 seconds
19 rew tensor(0.4902, dtype=torch.float64) delta_t tensor(-0.0126, dtype=torch.float64)
19 gae_duplicate tensor(-0.1043, dtype=torch.float64) tensor(0.3300, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4212, dtype=torch.float64) delta_t tensor(-0.0148, dtype=torch.float64)
18 gae_duplicate tensor(-0.1167, dtype=torch.float64) tensor(0.3298, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4574, dtype=torch.float64) delta_t tensor(-0.0361, dtype=torch.float64)
17 gae_duplicate tensor(-0.2580, dtype=torch.float64) tensor(0.7077, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4151, dtype=torch.float64) delta_t tensor(-0.2670, dtype=torch.float64)
16 gae_duplicate tensor(-0.5213, dtype=torch.float64) tensor(5.2602, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5166, dtype=torch.float64) delta_t tensor(-0.2240, dtype=torch.float64)
15 gae_duplicate tensor(-0.7694, dtype=torch.float64) tensor(4.9955, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2877, dtype=torch.float64) delta_t tensor(-0.0644, dtype=torch.float64)
14 gae_duplicate tensor(-0.5175, dtype=torch.float64) tensor(1.8427, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5165, dtype=torch.float64) delta_t tensor(-0.0625, dtype=torch.float64)
13 gae_duplicate tensor(-0.5774, dtype=torch.float64) tensor(1.5226, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2672, dtype=torch.float64) delta_t tensor(-0.0315, dtype=torch.float64)
12 gae_duplicate tensor(-0.2017, dtype=torch.float64) tensor(0.6498, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5374, dtype=torch.float64) delta_t tensor(0.0720, dtype=torch.float64)
11 gae_duplicate tensor(-0.0342, dtype=torch.float64) tensor(-1.2399, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2606, dtype=torch.float64) delta_t tensor(-0.1090, dtype=torch.float64)
10 gae_duplicate tensor(-0.2257, dtype=torch.float64) tensor(1.8084, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5189, dtype=torch.float64) delta_t tensor(0.0133, dtype=torch.float64)
9 gae_duplicate tensor(-0.1493, dtype=torch.float64) tensor(-0.2851, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1885, dtype=torch.float64) delta_t tensor(-0.1831, dtype=torch.float64)
8 gae_duplicate tensor(-0.2901, dtype=torch.float64) tensor(3.5088, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4274, dtype=torch.float64) delta_t tensor(-0.0510, dtype=torch.float64)
7 gae_duplicate tensor(-0.1805, dtype=torch.float64) tensor(1.3082, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0779, dtype=torch.float64) delta_t tensor(-0.0741, dtype=torch.float64)
6 gae_duplicate tensor(-0.1837, dtype=torch.float64) tensor(1.5041, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9492, dtype=torch.float64) delta_t tensor(0.7824, dtype=torch.float64)
5 gae_duplicate tensor(-1.6363, dtype=torch.float64) tensor(-15.1484, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0210, dtype=torch.float64) delta_t tensor(0.9581, dtype=torch.float64)
4 gae_duplicate tensor(-2.0331, dtype=torch.float64) tensor(-20.0561, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0602, dtype=torch.float64) delta_t tensor(0.6249, dtype=torch.float64)
3 gae_duplicate tensor(0.0486, dtype=torch.float64) tensor(-14.6819, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1465, dtype=torch.float64) delta_t tensor(0.0026, dtype=torch.float64)
2 gae_duplicate tensor(-0.2422, dtype=torch.float64) tensor(-1.7928, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1495.42236328125
value loss:103.17021179199219
entropies:348.715576171875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3913.2385)
ToM Target loss= tensor(3627.4751)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.144846200942993 seconds
19 rew tensor(0.5230, dtype=torch.float64) delta_t tensor(-0.0479, dtype=torch.float64)
19 gae_duplicate tensor(-0.1671, dtype=torch.float64) tensor(1.0668, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2863, dtype=torch.float64) delta_t tensor(-0.2017, dtype=torch.float64)
18 gae_duplicate tensor(-0.2858, dtype=torch.float64) tensor(4.1424, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5440, dtype=torch.float64) delta_t tensor(-0.0095, dtype=torch.float64)
17 gae_duplicate tensor(-0.0921, dtype=torch.float64) tensor(0.5710, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2248, dtype=torch.float64) delta_t tensor(-0.4527, dtype=torch.float64)
16 gae_duplicate tensor(-0.6927, dtype=torch.float64) tensor(8.7656, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5240, dtype=torch.float64) delta_t tensor(-0.3095, dtype=torch.float64)
15 gae_duplicate tensor(-0.6577, dtype=torch.float64) tensor(6.8641, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2453, dtype=torch.float64) delta_t tensor(-0.1830, dtype=torch.float64)
14 gae_duplicate tensor(-0.4214, dtype=torch.float64) tensor(4.5924, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5377, dtype=torch.float64) delta_t tensor(-0.1508, dtype=torch.float64)
13 gae_duplicate tensor(-0.5479, dtype=torch.float64) tensor(3.4982, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1058, dtype=torch.float64) delta_t tensor(-0.2880, dtype=torch.float64)
12 gae_duplicate tensor(-0.6578, dtype=torch.float64) tensor(5.5004, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5308, dtype=torch.float64) delta_t tensor(-0.0757, dtype=torch.float64)
11 gae_duplicate tensor(-0.5708, dtype=torch.float64) tensor(2.0653, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2389, dtype=torch.float64) delta_t tensor(-0.1647, dtype=torch.float64)
10 gae_duplicate tensor(-0.2291, dtype=torch.float64) tensor(3.7427, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5447, dtype=torch.float64) delta_t tensor(-0.0188, dtype=torch.float64)
9 gae_duplicate tensor(-0.1690, dtype=torch.float64) tensor(0.6908, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2057, dtype=torch.float64) delta_t tensor(-0.2071, dtype=torch.float64)
8 gae_duplicate tensor(-0.3147, dtype=torch.float64) tensor(3.9437, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5044, dtype=torch.float64) delta_t tensor(-0.1175, dtype=torch.float64)
7 gae_duplicate tensor(-0.3315, dtype=torch.float64) tensor(2.7194, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1656, dtype=torch.float64) delta_t tensor(-0.2063, dtype=torch.float64)
6 gae_duplicate tensor(-0.2985, dtype=torch.float64) tensor(4.4412, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2189, dtype=torch.float64) delta_t tensor(0.0736, dtype=torch.float64)
5 gae_duplicate tensor(-0.9846, dtype=torch.float64) tensor(-1.4514, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6337, dtype=torch.float64) delta_t tensor(-0.0155, dtype=torch.float64)
4 gae_duplicate tensor(-2.1309, dtype=torch.float64) tensor(1.1908, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0444, dtype=torch.float64) delta_t tensor(0.5396, dtype=torch.float64)
3 gae_duplicate tensor(0.3312, dtype=torch.float64) tensor(-10.1430, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2413, dtype=torch.float64) delta_t tensor(-0.1478, dtype=torch.float64)
2 gae_duplicate tensor(-0.6824, dtype=torch.float64) tensor(2.2459, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2494.4345703125
value loss:45.41112518310547
entropies:349.3783874511719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.139816999435425 seconds
19 rew tensor(0.5445, dtype=torch.float64) delta_t tensor(-0.0082, dtype=torch.float64)
19 gae_duplicate tensor(-0.1063, dtype=torch.float64) tensor(0.1238, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4682, dtype=torch.float64) delta_t tensor(-0.0480, dtype=torch.float64)
18 gae_duplicate tensor(-0.2152, dtype=torch.float64) tensor(0.7909, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4722, dtype=torch.float64) delta_t tensor(-0.0914, dtype=torch.float64)
17 gae_duplicate tensor(-0.1832, dtype=torch.float64) tensor(1.9811, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3616, dtype=torch.float64) delta_t tensor(-0.2891, dtype=torch.float64)
16 gae_duplicate tensor(-0.6228, dtype=torch.float64) tensor(5.2911, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5173, dtype=torch.float64) delta_t tensor(-0.3553, dtype=torch.float64)
15 gae_duplicate tensor(-0.6786, dtype=torch.float64) tensor(8.3023, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2230, dtype=torch.float64) delta_t tensor(-0.1245, dtype=torch.float64)
14 gae_duplicate tensor(-0.4960, dtype=torch.float64) tensor(3.1432, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4552, dtype=torch.float64) delta_t tensor(0.0513, dtype=torch.float64)
13 gae_duplicate tensor(-0.1130, dtype=torch.float64) tensor(-0.7775, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2241, dtype=torch.float64) delta_t tensor(-0.1651, dtype=torch.float64)
12 gae_duplicate tensor(-0.3719, dtype=torch.float64) tensor(3.0915, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4823, dtype=torch.float64) delta_t tensor(-0.0586, dtype=torch.float64)
11 gae_duplicate tensor(-0.1841, dtype=torch.float64) tensor(1.4759, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2177, dtype=torch.float64) delta_t tensor(-0.1777, dtype=torch.float64)
10 gae_duplicate tensor(-0.4951, dtype=torch.float64) tensor(3.4895, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4435, dtype=torch.float64) delta_t tensor(-0.1829, dtype=torch.float64)
9 gae_duplicate tensor(-0.3119, dtype=torch.float64) tensor(3.9343, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1106, dtype=torch.float64) delta_t tensor(-0.3201, dtype=torch.float64)
8 gae_duplicate tensor(-0.5498, dtype=torch.float64) tensor(6.7220, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3943, dtype=torch.float64) delta_t tensor(-0.0730, dtype=torch.float64)
7 gae_duplicate tensor(-0.2218, dtype=torch.float64) tensor(2.0219, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0722, dtype=torch.float64) delta_t tensor(-0.1974, dtype=torch.float64)
6 gae_duplicate tensor(-0.3927, dtype=torch.float64) tensor(3.8772, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3629, dtype=torch.float64) delta_t tensor(0.3912, dtype=torch.float64)
5 gae_duplicate tensor(-0.8276, dtype=torch.float64) tensor(-6.9109, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0729, dtype=torch.float64) delta_t tensor(-0.0392, dtype=torch.float64)
4 gae_duplicate tensor(-2.3523, dtype=torch.float64) tensor(2.5558, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0714, dtype=torch.float64) delta_t tensor(0.0927, dtype=torch.float64)
3 gae_duplicate tensor(-0.2954, dtype=torch.float64) tensor(-1.9023, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0781, dtype=torch.float64) delta_t tensor(0.2049, dtype=torch.float64)
2 gae_duplicate tensor(-0.3073, dtype=torch.float64) tensor(-4.3938, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1866.4847412109375
value loss:48.06267547607422
entropies:349.7029724121094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.282666921615601 seconds
19 rew tensor(0.5099, dtype=torch.float64) delta_t tensor(-0.0752, dtype=torch.float64)
19 gae_duplicate tensor(-0.1652, dtype=torch.float64) tensor(1.4609, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3206, dtype=torch.float64) delta_t tensor(-0.2078, dtype=torch.float64)
18 gae_duplicate tensor(-0.3041, dtype=torch.float64) tensor(4.2734, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5092, dtype=torch.float64) delta_t tensor(-0.0658, dtype=torch.float64)
17 gae_duplicate tensor(-0.1974, dtype=torch.float64) tensor(1.6379, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3284, dtype=torch.float64) delta_t tensor(-0.2936, dtype=torch.float64)
16 gae_duplicate tensor(-0.5491, dtype=torch.float64) tensor(6.2005, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4680, dtype=torch.float64) delta_t tensor(-0.2461, dtype=torch.float64)
15 gae_duplicate tensor(-0.5013, dtype=torch.float64) tensor(5.7287, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3222, dtype=torch.float64) delta_t tensor(-0.1433, dtype=torch.float64)
14 gae_duplicate tensor(-0.4716, dtype=torch.float64) tensor(3.2766, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4627, dtype=torch.float64) delta_t tensor(-0.0960, dtype=torch.float64)
13 gae_duplicate tensor(-0.3373, dtype=torch.float64) tensor(2.2190, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2684, dtype=torch.float64) delta_t tensor(-0.0641, dtype=torch.float64)
12 gae_duplicate tensor(-0.2278, dtype=torch.float64) tensor(1.7210, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5306, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
11 gae_duplicate tensor(-0.1027, dtype=torch.float64) tensor(-0.6805, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2071, dtype=torch.float64) delta_t tensor(-0.2088, dtype=torch.float64)
10 gae_duplicate tensor(-0.3088, dtype=torch.float64) tensor(3.9997, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5306, dtype=torch.float64) delta_t tensor(-0.0505, dtype=torch.float64)
9 gae_duplicate tensor(-0.1883, dtype=torch.float64) tensor(1.5082, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1532, dtype=torch.float64) delta_t tensor(-0.2671, dtype=torch.float64)
8 gae_duplicate tensor(-0.4374, dtype=torch.float64) tensor(5.0876, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4973, dtype=torch.float64) delta_t tensor(-0.0703, dtype=torch.float64)
7 gae_duplicate tensor(-0.3133, dtype=torch.float64) tensor(1.7671, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0993, dtype=torch.float64) delta_t tensor(-0.1284, dtype=torch.float64)
6 gae_duplicate tensor(-0.3348, dtype=torch.float64) tensor(2.4864, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1341, dtype=torch.float64) delta_t tensor(0.6183, dtype=torch.float64)
5 gae_duplicate tensor(-0.4858, dtype=torch.float64) tensor(-13.2294, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4376, dtype=torch.float64) delta_t tensor(-0.7487, dtype=torch.float64)
4 gae_duplicate tensor(-5.5892, dtype=torch.float64) tensor(12.6826, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0526, dtype=torch.float64) delta_t tensor(0.5562, dtype=torch.float64)
3 gae_duplicate tensor(-0.4985, dtype=torch.float64) tensor(-8.3091, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1703, dtype=torch.float64) delta_t tensor(0.0953, dtype=torch.float64)
2 gae_duplicate tensor(-0.2244, dtype=torch.float64) tensor(-3.0650, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1647.7506103515625
value loss:80.33576202392578
entropies:349.68798828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.218529224395752 seconds
19 rew tensor(0.5228, dtype=torch.float64) delta_t tensor(-0.0471, dtype=torch.float64)
19 gae_duplicate tensor(-0.2046, dtype=torch.float64) tensor(0.8176, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3904, dtype=torch.float64) delta_t tensor(-0.1667, dtype=torch.float64)
18 gae_duplicate tensor(-0.3257, dtype=torch.float64) tensor(3.4069, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4610, dtype=torch.float64) delta_t tensor(-0.1132, dtype=torch.float64)
17 gae_duplicate tensor(-0.4216, dtype=torch.float64) tensor(2.3903, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3502, dtype=torch.float64) delta_t tensor(-0.2350, dtype=torch.float64)
16 gae_duplicate tensor(-0.5114, dtype=torch.float64) tensor(4.4864, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4469, dtype=torch.float64) delta_t tensor(-0.1323, dtype=torch.float64)
15 gae_duplicate tensor(-0.5399, dtype=torch.float64) tensor(2.9353, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2827, dtype=torch.float64) delta_t tensor(-0.0991, dtype=torch.float64)
14 gae_duplicate tensor(-0.3129, dtype=torch.float64) tensor(2.2060, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4403, dtype=torch.float64) delta_t tensor(-0.1948, dtype=torch.float64)
13 gae_duplicate tensor(-0.3979, dtype=torch.float64) tensor(4.3898, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2334, dtype=torch.float64) delta_t tensor(-0.0451, dtype=torch.float64)
12 gae_duplicate tensor(-0.3356, dtype=torch.float64) tensor(1.4120, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5372, dtype=torch.float64) delta_t tensor(0.0525, dtype=torch.float64)
11 gae_duplicate tensor(-0.1324, dtype=torch.float64) tensor(-0.9388, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1502, dtype=torch.float64) delta_t tensor(-0.2458, dtype=torch.float64)
10 gae_duplicate tensor(-0.6463, dtype=torch.float64) tensor(4.6740, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4904, dtype=torch.float64) delta_t tensor(-0.0520, dtype=torch.float64)
9 gae_duplicate tensor(-0.2279, dtype=torch.float64) tensor(1.4921, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0562, dtype=torch.float64) delta_t tensor(-0.4003, dtype=torch.float64)
8 gae_duplicate tensor(-0.9751, dtype=torch.float64) tensor(7.3857, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4972, dtype=torch.float64) delta_t tensor(0.0514, dtype=torch.float64)
7 gae_duplicate tensor(-0.2404, dtype=torch.float64) tensor(-0.2381, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0445, dtype=torch.float64) delta_t tensor(-0.2266, dtype=torch.float64)
6 gae_duplicate tensor(-0.4970, dtype=torch.float64) tensor(4.6043, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1001, dtype=torch.float64) delta_t tensor(0.3773, dtype=torch.float64)
5 gae_duplicate tensor(-0.0104, dtype=torch.float64) tensor(-7.2393, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8467, dtype=torch.float64) delta_t tensor(-0.0276, dtype=torch.float64)
4 gae_duplicate tensor(-3.7418, dtype=torch.float64) tensor(-0.5292, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0094, dtype=torch.float64) delta_t tensor(0.1892, dtype=torch.float64)
3 gae_duplicate tensor(-0.6823, dtype=torch.float64) tensor(-3.5863, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2105, dtype=torch.float64) delta_t tensor(-0.0548, dtype=torch.float64)
2 gae_duplicate tensor(-0.3140, dtype=torch.float64) tensor(1.0444, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1644.962158203125
value loss:55.117210388183594
entropies:349.80206298828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.976730108261108 seconds
19 rew tensor(0.4635, dtype=torch.float64) delta_t tensor(-0.0324, dtype=torch.float64)
19 gae_duplicate tensor(-0.1512, dtype=torch.float64) tensor(0.7322, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4277, dtype=torch.float64) delta_t tensor(-0.0328, dtype=torch.float64)
18 gae_duplicate tensor(-0.2124, dtype=torch.float64) tensor(0.6647, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4841, dtype=torch.float64) delta_t tensor(0.0340, dtype=torch.float64)
17 gae_duplicate tensor(-0.0757, dtype=torch.float64) tensor(-0.6998, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2083, dtype=torch.float64) delta_t tensor(-0.3656, dtype=torch.float64)
16 gae_duplicate tensor(-0.9017, dtype=torch.float64) tensor(6.9771, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5164, dtype=torch.float64) delta_t tensor(-0.0974, dtype=torch.float64)
15 gae_duplicate tensor(-0.2337, dtype=torch.float64) tensor(2.4960, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2748, dtype=torch.float64) delta_t tensor(0.0192, dtype=torch.float64)
14 gae_duplicate tensor(-0.2645, dtype=torch.float64) tensor(-0.2737, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5370, dtype=torch.float64) delta_t tensor(0.0961, dtype=torch.float64)
13 gae_duplicate tensor(0.0126, dtype=torch.float64) tensor(-1.6268, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2887, dtype=torch.float64) delta_t tensor(-0.0999, dtype=torch.float64)
12 gae_duplicate tensor(-0.2212, dtype=torch.float64) tensor(1.9362, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5440, dtype=torch.float64) delta_t tensor(-0.0006, dtype=torch.float64)
11 gae_duplicate tensor(-0.0478, dtype=torch.float64) tensor(0.2160, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2890, dtype=torch.float64) delta_t tensor(-0.0671, dtype=torch.float64)
10 gae_duplicate tensor(-0.1858, dtype=torch.float64) tensor(1.2889, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5052, dtype=torch.float64) delta_t tensor(-0.0941, dtype=torch.float64)
9 gae_duplicate tensor(-0.2117, dtype=torch.float64) tensor(1.8148, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2035, dtype=torch.float64) delta_t tensor(-0.1962, dtype=torch.float64)
8 gae_duplicate tensor(-0.3203, dtype=torch.float64) tensor(3.7941, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4401, dtype=torch.float64) delta_t tensor(-0.1221, dtype=torch.float64)
7 gae_duplicate tensor(-0.2828, dtype=torch.float64) tensor(2.8732, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0797, dtype=torch.float64) delta_t tensor(-0.1783, dtype=torch.float64)
6 gae_duplicate tensor(-0.3756, dtype=torch.float64) tensor(3.4993, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2665, dtype=torch.float64) delta_t tensor(0.1931, dtype=torch.float64)
5 gae_duplicate tensor(-0.8653, dtype=torch.float64) tensor(-3.5233, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.7631, dtype=torch.float64) delta_t tensor(-1.1019, dtype=torch.float64)
4 gae_duplicate tensor(-4.0006, dtype=torch.float64) tensor(21.4725, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0497, dtype=torch.float64) delta_t tensor(0.2966, dtype=torch.float64)
3 gae_duplicate tensor(-0.0902, dtype=torch.float64) tensor(-3.7297, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1750, dtype=torch.float64) delta_t tensor(0.1613, dtype=torch.float64)
2 gae_duplicate tensor(-0.1978, dtype=torch.float64) tensor(-3.2997, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1963.58544921875
value loss:56.7038688659668
entropies:350.1356506347656
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3925.3298)
ToM Target loss= tensor(3642.1536)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.21881103515625 seconds
19 rew tensor(0.5079, dtype=torch.float64) delta_t tensor(0.1402, dtype=torch.float64)
19 gae_duplicate tensor(-0.0827, dtype=torch.float64) tensor(-2.7798, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3700, dtype=torch.float64) delta_t tensor(0.0751, dtype=torch.float64)
18 gae_duplicate tensor(-0.0265, dtype=torch.float64) tensor(-1.7864, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5360, dtype=torch.float64) delta_t tensor(0.1427, dtype=torch.float64)
17 gae_duplicate tensor(0.0403, dtype=torch.float64) tensor(-2.7700, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3147, dtype=torch.float64) delta_t tensor(0.0437, dtype=torch.float64)
16 gae_duplicate tensor(-0.2002, dtype=torch.float64) tensor(-1.1253, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5361, dtype=torch.float64) delta_t tensor(0.0352, dtype=torch.float64)
15 gae_duplicate tensor(-0.0828, dtype=torch.float64) tensor(-0.9299, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1720, dtype=torch.float64) delta_t tensor(0.0458, dtype=torch.float64)
14 gae_duplicate tensor(-0.2119, dtype=torch.float64) tensor(-0.9425, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5368, dtype=torch.float64) delta_t tensor(0.1865, dtype=torch.float64)
13 gae_duplicate tensor(0.0574, dtype=torch.float64) tensor(-3.5297, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1654, dtype=torch.float64) delta_t tensor(-0.1030, dtype=torch.float64)
12 gae_duplicate tensor(-0.2069, dtype=torch.float64) tensor(1.6430, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5303, dtype=torch.float64) delta_t tensor(0.2096, dtype=torch.float64)
11 gae_duplicate tensor(0.0663, dtype=torch.float64) tensor(-4.1823, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1525, dtype=torch.float64) delta_t tensor(-0.0291, dtype=torch.float64)
10 gae_duplicate tensor(-0.2574, dtype=torch.float64) tensor(0.2236, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5436, dtype=torch.float64) delta_t tensor(0.0542, dtype=torch.float64)
9 gae_duplicate tensor(-0.0494, dtype=torch.float64) tensor(-1.0384, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1256, dtype=torch.float64) delta_t tensor(-0.1139, dtype=torch.float64)
8 gae_duplicate tensor(-0.3739, dtype=torch.float64) tensor(2.1266, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4762, dtype=torch.float64) delta_t tensor(0.0597, dtype=torch.float64)
7 gae_duplicate tensor(-0.1632, dtype=torch.float64) tensor(-0.8862, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0583, dtype=torch.float64) delta_t tensor(-0.0700, dtype=torch.float64)
6 gae_duplicate tensor(-0.3383, dtype=torch.float64) tensor(1.3584, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2587, dtype=torch.float64) delta_t tensor(0.3580, dtype=torch.float64)
5 gae_duplicate tensor(-0.1546, dtype=torch.float64) tensor(-7.0834, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6026, dtype=torch.float64) delta_t tensor(-1.3920, dtype=torch.float64)
4 gae_duplicate tensor(-3.0222, dtype=torch.float64) tensor(26.0596, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0875, dtype=torch.float64) delta_t tensor(0.4330, dtype=torch.float64)
3 gae_duplicate tensor(-0.1175, dtype=torch.float64) tensor(-5.7075, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1914, dtype=torch.float64) delta_t tensor(0.2034, dtype=torch.float64)
2 gae_duplicate tensor(-0.0825, dtype=torch.float64) tensor(-5.0310, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:249.95352172851562
value loss:48.739437103271484
entropies:350.47216796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.2415149211883545 seconds
19 rew tensor(0.5097, dtype=torch.float64) delta_t tensor(0.1602, dtype=torch.float64)
19 gae_duplicate tensor(0.0611, dtype=torch.float64) tensor(-3.1680, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4550, dtype=torch.float64) delta_t tensor(0.1662, dtype=torch.float64)
18 gae_duplicate tensor(0.0318, dtype=torch.float64) tensor(-3.3537, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4893, dtype=torch.float64) delta_t tensor(0.1113, dtype=torch.float64)
17 gae_duplicate tensor(-0.0589, dtype=torch.float64) tensor(-2.3900, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3748, dtype=torch.float64) delta_t tensor(0.0443, dtype=torch.float64)
16 gae_duplicate tensor(-0.1607, dtype=torch.float64) tensor(-1.1376, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5301, dtype=torch.float64) delta_t tensor(0.1688, dtype=torch.float64)
15 gae_duplicate tensor(0.0475, dtype=torch.float64) tensor(-3.3832, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3205, dtype=torch.float64) delta_t tensor(0.0973, dtype=torch.float64)
14 gae_duplicate tensor(-0.2256, dtype=torch.float64) tensor(-2.2308, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5370, dtype=torch.float64) delta_t tensor(0.2286, dtype=torch.float64)
13 gae_duplicate tensor(0.0668, dtype=torch.float64) tensor(-4.7707, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3209, dtype=torch.float64) delta_t tensor(0.1552, dtype=torch.float64)
12 gae_duplicate tensor(0.0470, dtype=torch.float64) tensor(-3.4533, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5237, dtype=torch.float64) delta_t tensor(0.2047, dtype=torch.float64)
11 gae_duplicate tensor(0.1414, dtype=torch.float64) tensor(-4.4387, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3076, dtype=torch.float64) delta_t tensor(0.1333, dtype=torch.float64)
10 gae_duplicate tensor(0.0345, dtype=torch.float64) tensor(-3.0851, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4762, dtype=torch.float64) delta_t tensor(0.1298, dtype=torch.float64)
9 gae_duplicate tensor(0.0691, dtype=torch.float64) tensor(-2.8853, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2060, dtype=torch.float64) delta_t tensor(-0.0032, dtype=torch.float64)
8 gae_duplicate tensor(-0.2134, dtype=torch.float64) tensor(-0.2672, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4971, dtype=torch.float64) delta_t tensor(0.0041, dtype=torch.float64)
7 gae_duplicate tensor(-0.1691, dtype=torch.float64) tensor(-0.2131, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0909, dtype=torch.float64) delta_t tensor(-0.0117, dtype=torch.float64)
6 gae_duplicate tensor(-0.3457, dtype=torch.float64) tensor(0.0178, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2351, dtype=torch.float64) delta_t tensor(-0.0837, dtype=torch.float64)
5 gae_duplicate tensor(-0.7653, dtype=torch.float64) tensor(1.1543, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9745, dtype=torch.float64) delta_t tensor(0.2222, dtype=torch.float64)
4 gae_duplicate tensor(-0.7673, dtype=torch.float64) tensor(-4.3138, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0328, dtype=torch.float64) delta_t tensor(0.4303, dtype=torch.float64)
3 gae_duplicate tensor(0.2403, dtype=torch.float64) tensor(-8.4044, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3078, dtype=torch.float64) delta_t tensor(0.2224, dtype=torch.float64)
2 gae_duplicate tensor(-0.0541, dtype=torch.float64) tensor(-5.2585, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2690.612548828125
value loss:20.411914825439453
entropies:351.0077209472656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.066573143005371 seconds
19 rew tensor(0.4905, dtype=torch.float64) delta_t tensor(0.1214, dtype=torch.float64)
19 gae_duplicate tensor(0.0175, dtype=torch.float64) tensor(-2.4948, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4348, dtype=torch.float64) delta_t tensor(0.0694, dtype=torch.float64)
18 gae_duplicate tensor(-0.1252, dtype=torch.float64) tensor(-1.5063, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4907, dtype=torch.float64) delta_t tensor(0.1054, dtype=torch.float64)
17 gae_duplicate tensor(-0.0355, dtype=torch.float64) tensor(-2.1776, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4001, dtype=torch.float64) delta_t tensor(0.0655, dtype=torch.float64)
16 gae_duplicate tensor(-0.0361, dtype=torch.float64) tensor(-1.4036, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3610, dtype=torch.float64) delta_t tensor(-0.0458, dtype=torch.float64)
15 gae_duplicate tensor(-0.5776, dtype=torch.float64) tensor(0.4149, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3407, dtype=torch.float64) delta_t tensor(0.1771, dtype=torch.float64)
14 gae_duplicate tensor(0.0346, dtype=torch.float64) tensor(-3.4736, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5040, dtype=torch.float64) delta_t tensor(0.3015, dtype=torch.float64)
13 gae_duplicate tensor(0.1680, dtype=torch.float64) tensor(-6.4478, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2750, dtype=torch.float64) delta_t tensor(0.1233, dtype=torch.float64)
12 gae_duplicate tensor(0.0096, dtype=torch.float64) tensor(-3.2609, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5445, dtype=torch.float64) delta_t tensor(0.1987, dtype=torch.float64)
11 gae_duplicate tensor(0.1641, dtype=torch.float64) tensor(-3.9541, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2614, dtype=torch.float64) delta_t tensor(0.0624, dtype=torch.float64)
10 gae_duplicate tensor(-0.0943, dtype=torch.float64) tensor(-1.8011, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5447, dtype=torch.float64) delta_t tensor(0.0947, dtype=torch.float64)
9 gae_duplicate tensor(0.0482, dtype=torch.float64) tensor(-1.9800, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2211, dtype=torch.float64) delta_t tensor(-0.0225, dtype=torch.float64)
8 gae_duplicate tensor(-0.1600, dtype=torch.float64) tensor(0.3595, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4906, dtype=torch.float64) delta_t tensor(0.0673, dtype=torch.float64)
7 gae_duplicate tensor(-0.0870, dtype=torch.float64) tensor(-1.3257, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1603, dtype=torch.float64) delta_t tensor(-0.0404, dtype=torch.float64)
6 gae_duplicate tensor(-0.0905, dtype=torch.float64) tensor(0.6570, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2761, dtype=torch.float64) delta_t tensor(0.1683, dtype=torch.float64)
5 gae_duplicate tensor(-0.6850, dtype=torch.float64) tensor(-2.9621, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1273, dtype=torch.float64) delta_t tensor(0.4146, dtype=torch.float64)
4 gae_duplicate tensor(-2.0702, dtype=torch.float64) tensor(-10.7377, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1603, dtype=torch.float64) delta_t tensor(0.3823, dtype=torch.float64)
3 gae_duplicate tensor(0.1141, dtype=torch.float64) tensor(-7.6151, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2128, dtype=torch.float64) delta_t tensor(-0.1241, dtype=torch.float64)
2 gae_duplicate tensor(-0.2343, dtype=torch.float64) tensor(1.5724, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2504.435302734375
value loss:51.971675872802734
entropies:351.6468811035156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1674559116363525 seconds
19 rew tensor(0.4829, dtype=torch.float64) delta_t tensor(0.1942, dtype=torch.float64)
19 gae_duplicate tensor(0.0852, dtype=torch.float64) tensor(-3.9040, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3895, dtype=torch.float64) delta_t tensor(0.1096, dtype=torch.float64)
18 gae_duplicate tensor(-0.0107, dtype=torch.float64) tensor(-2.5657, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4961, dtype=torch.float64) delta_t tensor(0.1309, dtype=torch.float64)
17 gae_duplicate tensor(0.0388, dtype=torch.float64) tensor(-3.0024, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2947, dtype=torch.float64) delta_t tensor(-0.0781, dtype=torch.float64)
16 gae_duplicate tensor(-0.1215, dtype=torch.float64) tensor(1.3182, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5374, dtype=torch.float64) delta_t tensor(0.0560, dtype=torch.float64)
15 gae_duplicate tensor(-0.0252, dtype=torch.float64) tensor(-0.9559, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2608, dtype=torch.float64) delta_t tensor(0.0051, dtype=torch.float64)
14 gae_duplicate tensor(-0.1982, dtype=torch.float64) tensor(-0.0135, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5180, dtype=torch.float64) delta_t tensor(0.1074, dtype=torch.float64)
13 gae_duplicate tensor(0.0567, dtype=torch.float64) tensor(-2.0859, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2281, dtype=torch.float64) delta_t tensor(0.1464, dtype=torch.float64)
12 gae_duplicate tensor(-0.0481, dtype=torch.float64) tensor(-3.0704, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5376, dtype=torch.float64) delta_t tensor(0.2386, dtype=torch.float64)
11 gae_duplicate tensor(0.1252, dtype=torch.float64) tensor(-4.9604, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2351, dtype=torch.float64) delta_t tensor(0.0792, dtype=torch.float64)
10 gae_duplicate tensor(-0.0747, dtype=torch.float64) tensor(-1.9528, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5033, dtype=torch.float64) delta_t tensor(0.1010, dtype=torch.float64)
9 gae_duplicate tensor(-0.0780, dtype=torch.float64) tensor(-2.0230, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1534, dtype=torch.float64) delta_t tensor(-0.0519, dtype=torch.float64)
8 gae_duplicate tensor(-0.1816, dtype=torch.float64) tensor(0.7943, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5043, dtype=torch.float64) delta_t tensor(0.0776, dtype=torch.float64)
7 gae_duplicate tensor(-0.1124, dtype=torch.float64) tensor(-1.4657, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0717, dtype=torch.float64) delta_t tensor(-0.0339, dtype=torch.float64)
6 gae_duplicate tensor(-0.2227, dtype=torch.float64) tensor(0.5177, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6488, dtype=torch.float64) delta_t tensor(-0.1055, dtype=torch.float64)
5 gae_duplicate tensor(-1.5965, dtype=torch.float64) tensor(2.7657, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.8318, dtype=torch.float64) delta_t tensor(-1.2643, dtype=torch.float64)
4 gae_duplicate tensor(-2.0884, dtype=torch.float64) tensor(25.2185, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0380, dtype=torch.float64) delta_t tensor(0.3836, dtype=torch.float64)
3 gae_duplicate tensor(-0.0931, dtype=torch.float64) tensor(-5.3045, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1592, dtype=torch.float64) delta_t tensor(0.1364, dtype=torch.float64)
2 gae_duplicate tensor(-0.2125, dtype=torch.float64) tensor(-3.1791, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:113.7584228515625
value loss:27.598922729492188
entropies:352.38079833984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.22252893447876 seconds
19 rew tensor(0.5309, dtype=torch.float64) delta_t tensor(0.1678, dtype=torch.float64)
19 gae_duplicate tensor(-0.0148, dtype=torch.float64) tensor(-3.2053, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4958, dtype=torch.float64) delta_t tensor(0.1958, dtype=torch.float64)
18 gae_duplicate tensor(-0.0163, dtype=torch.float64) tensor(-4.3688, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3506, dtype=torch.float64) delta_t tensor(0.0490, dtype=torch.float64)
17 gae_duplicate tensor(-0.3946, dtype=torch.float64) tensor(-1.5665, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3963, dtype=torch.float64) delta_t tensor(-0.0502, dtype=torch.float64)
16 gae_duplicate tensor(-0.1459, dtype=torch.float64) tensor(0.7242, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3612, dtype=torch.float64) delta_t tensor(-0.1980, dtype=torch.float64)
15 gae_duplicate tensor(-0.9017, dtype=torch.float64) tensor(4.0919, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1830, dtype=torch.float64) delta_t tensor(0.0787, dtype=torch.float64)
14 gae_duplicate tensor(-0.5033, dtype=torch.float64) tensor(-1.1401, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4316, dtype=torch.float64) delta_t tensor(0.1227, dtype=torch.float64)
13 gae_duplicate tensor(-0.0360, dtype=torch.float64) tensor(-2.6830, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3260, dtype=torch.float64) delta_t tensor(0.0968, dtype=torch.float64)
12 gae_duplicate tensor(-0.1021, dtype=torch.float64) tensor(-2.0458, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4256, dtype=torch.float64) delta_t tensor(0.0365, dtype=torch.float64)
11 gae_duplicate tensor(-0.2118, dtype=torch.float64) tensor(-1.0053, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3133, dtype=torch.float64) delta_t tensor(0.1730, dtype=torch.float64)
10 gae_duplicate tensor(-0.0425, dtype=torch.float64) tensor(-3.3823, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4257, dtype=torch.float64) delta_t tensor(-0.0182, dtype=torch.float64)
9 gae_duplicate tensor(-0.1178, dtype=torch.float64) tensor(0.0595, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1695, dtype=torch.float64) delta_t tensor(-0.0840, dtype=torch.float64)
8 gae_duplicate tensor(-0.2464, dtype=torch.float64) tensor(1.4610, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4970, dtype=torch.float64) delta_t tensor(-0.0685, dtype=torch.float64)
7 gae_duplicate tensor(-0.2220, dtype=torch.float64) tensor(1.4193, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0036, dtype=torch.float64) delta_t tensor(-0.1672, dtype=torch.float64)
6 gae_duplicate tensor(-0.3395, dtype=torch.float64) tensor(3.6335, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7067, dtype=torch.float64) delta_t tensor(0.5291, dtype=torch.float64)
5 gae_duplicate tensor(0.0848, dtype=torch.float64) tensor(-10.7931, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9626, dtype=torch.float64) delta_t tensor(-0.2476, dtype=torch.float64)
4 gae_duplicate tensor(-2.3940, dtype=torch.float64) tensor(4.3009, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0414, dtype=torch.float64) delta_t tensor(0.5070, dtype=torch.float64)
3 gae_duplicate tensor(0.1835, dtype=torch.float64) tensor(-9.6656, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2314, dtype=torch.float64) delta_t tensor(-0.0729, dtype=torch.float64)
2 gae_duplicate tensor(-0.1818, dtype=torch.float64) tensor(0.4814, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1183.6976318359375
value loss:44.73994827270508
entropies:352.8007507324219
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3944.2129)
ToM Target loss= tensor(3645.3538)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.910311222076416 seconds
19 rew tensor(0.5303, dtype=torch.float64) delta_t tensor(0.0263, dtype=torch.float64)
19 gae_duplicate tensor(-0.0469, dtype=torch.float64) tensor(-0.4916, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3681, dtype=torch.float64) delta_t tensor(-0.0443, dtype=torch.float64)
18 gae_duplicate tensor(-0.2388, dtype=torch.float64) tensor(0.8841, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5107, dtype=torch.float64) delta_t tensor(0.1565, dtype=torch.float64)
17 gae_duplicate tensor(-0.0895, dtype=torch.float64) tensor(-2.8776, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3091, dtype=torch.float64) delta_t tensor(-0.1562, dtype=torch.float64)
16 gae_duplicate tensor(-0.2694, dtype=torch.float64) tensor(2.7678, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5166, dtype=torch.float64) delta_t tensor(-0.0111, dtype=torch.float64)
15 gae_duplicate tensor(-0.1266, dtype=torch.float64) tensor(0.5771, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2903, dtype=torch.float64) delta_t tensor(0.0364, dtype=torch.float64)
14 gae_duplicate tensor(-0.2587, dtype=torch.float64) tensor(-0.6285, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5306, dtype=torch.float64) delta_t tensor(0.0758, dtype=torch.float64)
13 gae_duplicate tensor(-0.0452, dtype=torch.float64) tensor(-1.6733, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1247, dtype=torch.float64) delta_t tensor(-0.1223, dtype=torch.float64)
12 gae_duplicate tensor(-0.5671, dtype=torch.float64) tensor(2.3781, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5370, dtype=torch.float64) delta_t tensor(0.1003, dtype=torch.float64)
11 gae_duplicate tensor(0.0193, dtype=torch.float64) tensor(-1.7458, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2773, dtype=torch.float64) delta_t tensor(-0.0046, dtype=torch.float64)
10 gae_duplicate tensor(-0.0903, dtype=torch.float64) tensor(-0.0957, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5441, dtype=torch.float64) delta_t tensor(-0.0153, dtype=torch.float64)
9 gae_duplicate tensor(-0.0920, dtype=torch.float64) tensor(0.3030, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2371, dtype=torch.float64) delta_t tensor(-0.1137, dtype=torch.float64)
8 gae_duplicate tensor(-0.2487, dtype=torch.float64) tensor(2.2052, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5038, dtype=torch.float64) delta_t tensor(-0.0717, dtype=torch.float64)
7 gae_duplicate tensor(-0.2591, dtype=torch.float64) tensor(1.6488, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1969, dtype=torch.float64) delta_t tensor(-0.0696, dtype=torch.float64)
6 gae_duplicate tensor(-0.1886, dtype=torch.float64) tensor(1.6103, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2720, dtype=torch.float64) delta_t tensor(0.2576, dtype=torch.float64)
5 gae_duplicate tensor(-0.8410, dtype=torch.float64) tensor(-4.6048, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0774, dtype=torch.float64) delta_t tensor(-1.5273, dtype=torch.float64)
4 gae_duplicate tensor(-4.7845, dtype=torch.float64) tensor(29.0027, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0168, dtype=torch.float64) delta_t tensor(0.4750, dtype=torch.float64)
3 gae_duplicate tensor(-0.0427, dtype=torch.float64) tensor(-5.8710, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1627, dtype=torch.float64) delta_t tensor(-0.1535, dtype=torch.float64)
2 gae_duplicate tensor(-0.3358, dtype=torch.float64) tensor(2.5394, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1495.510498046875
value loss:71.03821563720703
entropies:353.3351745605469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.141738176345825 seconds
19 rew tensor(0.5222, dtype=torch.float64) delta_t tensor(0.0753, dtype=torch.float64)
19 gae_duplicate tensor(-0.0653, dtype=torch.float64) tensor(-1.5672, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4877, dtype=torch.float64) delta_t tensor(0.1937, dtype=torch.float64)
18 gae_duplicate tensor(-0.2096, dtype=torch.float64) tensor(-4.3425, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4133, dtype=torch.float64) delta_t tensor(0.0525, dtype=torch.float64)
17 gae_duplicate tensor(-0.1870, dtype=torch.float64) tensor(-1.1961, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3271, dtype=torch.float64) delta_t tensor(-0.2012, dtype=torch.float64)
16 gae_duplicate tensor(-0.2805, dtype=torch.float64) tensor(3.6249, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5030, dtype=torch.float64) delta_t tensor(-0.0918, dtype=torch.float64)
15 gae_duplicate tensor(-0.1532, dtype=torch.float64) tensor(2.1623, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1324, dtype=torch.float64) delta_t tensor(-0.0271, dtype=torch.float64)
14 gae_duplicate tensor(-0.1400, dtype=torch.float64) tensor(0.8234, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5432, dtype=torch.float64) delta_t tensor(0.0228, dtype=torch.float64)
13 gae_duplicate tensor(-0.0388, dtype=torch.float64) tensor(-0.3855, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1136, dtype=torch.float64) delta_t tensor(-0.1827, dtype=torch.float64)
12 gae_duplicate tensor(-0.2285, dtype=torch.float64) tensor(3.5558, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5433, dtype=torch.float64) delta_t tensor(-0.0148, dtype=torch.float64)
11 gae_duplicate tensor(-0.0837, dtype=torch.float64) tensor(0.6383, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1139, dtype=torch.float64) delta_t tensor(-0.0960, dtype=torch.float64)
10 gae_duplicate tensor(-0.1794, dtype=torch.float64) tensor(1.8887, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5163, dtype=torch.float64) delta_t tensor(-0.1512, dtype=torch.float64)
9 gae_duplicate tensor(-0.2192, dtype=torch.float64) tensor(3.0611, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0465, dtype=torch.float64) delta_t tensor(-0.2649, dtype=torch.float64)
8 gae_duplicate tensor(-0.3666, dtype=torch.float64) tensor(5.6430, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4647, dtype=torch.float64) delta_t tensor(-0.0309, dtype=torch.float64)
7 gae_duplicate tensor(-0.1881, dtype=torch.float64) tensor(1.1110, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0591, dtype=torch.float64) delta_t tensor(-0.2916, dtype=torch.float64)
6 gae_duplicate tensor(-0.4623, dtype=torch.float64) tensor(5.7185, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6426, dtype=torch.float64) delta_t tensor(-0.1893, dtype=torch.float64)
5 gae_duplicate tensor(-1.6932, dtype=torch.float64) tensor(4.1679, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7179, dtype=torch.float64) delta_t tensor(-0.2464, dtype=torch.float64)
4 gae_duplicate tensor(-4.7273, dtype=torch.float64) tensor(3.5399, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1346, dtype=torch.float64) delta_t tensor(0.0489, dtype=torch.float64)
3 gae_duplicate tensor(-0.5847, dtype=torch.float64) tensor(-0.2762, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1481, dtype=torch.float64) delta_t tensor(-0.1848, dtype=torch.float64)
2 gae_duplicate tensor(-0.4800, dtype=torch.float64) tensor(3.9091, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1827.592041015625
value loss:79.94693756103516
entropies:353.59661865234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.367606163024902 seconds
19 rew tensor(0.5239, dtype=torch.float64) delta_t tensor(0.0152, dtype=torch.float64)
19 gae_duplicate tensor(-0.0413, dtype=torch.float64) tensor(-0.3291, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2837, dtype=torch.float64) delta_t tensor(-0.0633, dtype=torch.float64)
18 gae_duplicate tensor(-0.1441, dtype=torch.float64) tensor(1.2689, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5432, dtype=torch.float64) delta_t tensor(-0.0227, dtype=torch.float64)
17 gae_duplicate tensor(-0.1491, dtype=torch.float64) tensor(0.5795, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2329, dtype=torch.float64) delta_t tensor(-0.2214, dtype=torch.float64)
16 gae_duplicate tensor(-0.5086, dtype=torch.float64) tensor(4.3206, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5370, dtype=torch.float64) delta_t tensor(0.0004, dtype=torch.float64)
15 gae_duplicate tensor(-0.0920, dtype=torch.float64) tensor(0.4061, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2064, dtype=torch.float64) delta_t tensor(-0.0312, dtype=torch.float64)
14 gae_duplicate tensor(-0.3121, dtype=torch.float64) tensor(0.7615, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5300, dtype=torch.float64) delta_t tensor(0.0885, dtype=torch.float64)
13 gae_duplicate tensor(-0.1018, dtype=torch.float64) tensor(-1.7450, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2196, dtype=torch.float64) delta_t tensor(-0.0512, dtype=torch.float64)
12 gae_duplicate tensor(-0.1810, dtype=torch.float64) tensor(0.8912, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5369, dtype=torch.float64) delta_t tensor(0.0366, dtype=torch.float64)
11 gae_duplicate tensor(-0.0643, dtype=torch.float64) tensor(-0.6152, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2337, dtype=torch.float64) delta_t tensor(-0.1316, dtype=torch.float64)
10 gae_duplicate tensor(-0.3793, dtype=torch.float64) tensor(2.3999, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5439, dtype=torch.float64) delta_t tensor(-0.0331, dtype=torch.float64)
9 gae_duplicate tensor(-0.1750, dtype=torch.float64) tensor(0.9677, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1935, dtype=torch.float64) delta_t tensor(-0.1542, dtype=torch.float64)
8 gae_duplicate tensor(-0.2531, dtype=torch.float64) tensor(3.1960, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4965, dtype=torch.float64) delta_t tensor(-0.0595, dtype=torch.float64)
7 gae_duplicate tensor(-0.2340, dtype=torch.float64) tensor(1.5702, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1532, dtype=torch.float64) delta_t tensor(-0.0676, dtype=torch.float64)
6 gae_duplicate tensor(-0.2352, dtype=torch.float64) tensor(1.4414, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2890, dtype=torch.float64) delta_t tensor(0.1995, dtype=torch.float64)
5 gae_duplicate tensor(-0.0790, dtype=torch.float64) tensor(-3.9174, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6447, dtype=torch.float64) delta_t tensor(-0.8500, dtype=torch.float64)
4 gae_duplicate tensor(-2.6075, dtype=torch.float64) tensor(16.5550, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1115, dtype=torch.float64) delta_t tensor(0.2016, dtype=torch.float64)
3 gae_duplicate tensor(-0.1945, dtype=torch.float64) tensor(-2.4404, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2877, dtype=torch.float64) delta_t tensor(-0.2490, dtype=torch.float64)
2 gae_duplicate tensor(-0.5580, dtype=torch.float64) tensor(4.9139, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1727.7066650390625
value loss:44.28085708618164
entropies:353.98175048828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.273138999938965 seconds
19 rew tensor(0.4829, dtype=torch.float64) delta_t tensor(-0.0186, dtype=torch.float64)
19 gae_duplicate tensor(-0.1245, dtype=torch.float64) tensor(0.3637, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4001, dtype=torch.float64) delta_t tensor(0.0942, dtype=torch.float64)
18 gae_duplicate tensor(-0.2264, dtype=torch.float64) tensor(-1.8295, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4823, dtype=torch.float64) delta_t tensor(-0.0431, dtype=torch.float64)
17 gae_duplicate tensor(-0.2905, dtype=torch.float64) tensor(0.6983, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2865, dtype=torch.float64) delta_t tensor(-0.2011, dtype=torch.float64)
16 gae_duplicate tensor(-0.2679, dtype=torch.float64) tensor(4.0755, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4885, dtype=torch.float64) delta_t tensor(0.0205, dtype=torch.float64)
15 gae_duplicate tensor(-0.2210, dtype=torch.float64) tensor(-0.1162, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2665, dtype=torch.float64) delta_t tensor(-0.0139, dtype=torch.float64)
14 gae_duplicate tensor(-0.0904, dtype=torch.float64) tensor(0.2826, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4817, dtype=torch.float64) delta_t tensor(0.0123, dtype=torch.float64)
13 gae_duplicate tensor(-0.0412, dtype=torch.float64) tensor(-0.2360, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2467, dtype=torch.float64) delta_t tensor(-0.0723, dtype=torch.float64)
12 gae_duplicate tensor(-0.1769, dtype=torch.float64) tensor(1.4646, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5090, dtype=torch.float64) delta_t tensor(0.0034, dtype=torch.float64)
11 gae_duplicate tensor(-0.0974, dtype=torch.float64) tensor(-0.0035, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2266, dtype=torch.float64) delta_t tensor(-0.0683, dtype=torch.float64)
10 gae_duplicate tensor(-0.2121, dtype=torch.float64) tensor(1.3292, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4691, dtype=torch.float64) delta_t tensor(-0.1262, dtype=torch.float64)
9 gae_duplicate tensor(-0.1786, dtype=torch.float64) tensor(2.6008, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0980, dtype=torch.float64) delta_t tensor(-0.2529, dtype=torch.float64)
8 gae_duplicate tensor(-0.3067, dtype=torch.float64) tensor(5.2070, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3621, dtype=torch.float64) delta_t tensor(-0.0398, dtype=torch.float64)
7 gae_duplicate tensor(-0.2834, dtype=torch.float64) tensor(1.2875, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0904, dtype=torch.float64) delta_t tensor(-0.1998, dtype=torch.float64)
6 gae_duplicate tensor(-0.3530, dtype=torch.float64) tensor(4.0075, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3570, dtype=torch.float64) delta_t tensor(0.2659, dtype=torch.float64)
5 gae_duplicate tensor(-0.2685, dtype=torch.float64) tensor(-4.9395, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.2657, dtype=torch.float64) delta_t tensor(-2.0151, dtype=torch.float64)
4 gae_duplicate tensor(-4.5683, dtype=torch.float64) tensor(37.5536, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0661, dtype=torch.float64) delta_t tensor(-0.0117, dtype=torch.float64)
3 gae_duplicate tensor(-0.5480, dtype=torch.float64) tensor(4.0981, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0941, dtype=torch.float64) delta_t tensor(-0.0137, dtype=torch.float64)
2 gae_duplicate tensor(-0.5638, dtype=torch.float64) tensor(0.6301, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3145.2294921875
value loss:57.395503997802734
entropies:354.23248291015625
Policy training finished
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
training start after waiting for 4.792183876037598 seconds
19 rew tensor(0.5093, dtype=torch.float64) delta_t tensor(0.0356, dtype=torch.float64)
19 gae_duplicate tensor(-0.0967, dtype=torch.float64) tensor(-0.6211, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3511, dtype=torch.float64) delta_t tensor(-0.0100, dtype=torch.float64)
18 gae_duplicate tensor(-0.1294, dtype=torch.float64) tensor(0.1152, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5313, dtype=torch.float64) delta_t tensor(0.0071, dtype=torch.float64)
17 gae_duplicate tensor(-0.0556, dtype=torch.float64) tensor(-0.1250, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2269, dtype=torch.float64) delta_t tensor(-0.1639, dtype=torch.float64)
16 gae_duplicate tensor(-0.3355, dtype=torch.float64) tensor(3.2155, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5243, dtype=torch.float64) delta_t tensor(0.0174, dtype=torch.float64)
15 gae_duplicate tensor(-0.1992, dtype=torch.float64) tensor(-0.0825, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2073, dtype=torch.float64) delta_t tensor(-0.0881, dtype=torch.float64)
14 gae_duplicate tensor(-0.2482, dtype=torch.float64) tensor(1.6876, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5308, dtype=torch.float64) delta_t tensor(0.0731, dtype=torch.float64)
13 gae_duplicate tensor(-0.1640, dtype=torch.float64) tensor(-1.2552, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2003, dtype=torch.float64) delta_t tensor(-0.0219, dtype=torch.float64)
12 gae_duplicate tensor(-0.2145, dtype=torch.float64) tensor(0.4256, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5375, dtype=torch.float64) delta_t tensor(0.0524, dtype=torch.float64)
11 gae_duplicate tensor(-0.0637, dtype=torch.float64) tensor(-0.9702, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2213, dtype=torch.float64) delta_t tensor(-0.0699, dtype=torch.float64)
10 gae_duplicate tensor(-0.1858, dtype=torch.float64) tensor(1.2722, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5447, dtype=torch.float64) delta_t tensor(-0.0206, dtype=torch.float64)
9 gae_duplicate tensor(-0.1897, dtype=torch.float64) tensor(0.5535, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1810, dtype=torch.float64) delta_t tensor(-0.1655, dtype=torch.float64)
8 gae_duplicate tensor(-0.3555, dtype=torch.float64) tensor(3.3509, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5042, dtype=torch.float64) delta_t tensor(-0.0334, dtype=torch.float64)
7 gae_duplicate tensor(-0.1324, dtype=torch.float64) tensor(0.9710, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1407, dtype=torch.float64) delta_t tensor(-0.1226, dtype=torch.float64)
6 gae_duplicate tensor(-0.3414, dtype=torch.float64) tensor(2.5729, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9825, dtype=torch.float64) delta_t tensor(0.3831, dtype=torch.float64)
5 gae_duplicate tensor(-0.1361, dtype=torch.float64) tensor(-6.8959, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2390, dtype=torch.float64) delta_t tensor(0.4688, dtype=torch.float64)
4 gae_duplicate tensor(-0.7650, dtype=torch.float64) tensor(-10.2335, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0967, dtype=torch.float64) delta_t tensor(0.1443, dtype=torch.float64)
3 gae_duplicate tensor(0.0395, dtype=torch.float64) tensor(-3.7250, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2702, dtype=torch.float64) delta_t tensor(-0.5448, dtype=torch.float64)
2 gae_duplicate tensor(-0.9141, dtype=torch.float64) tensor(10.3660, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-129.3272705078125
value loss:22.2999267578125
entropies:354.56329345703125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3935.9717)
ToM Target loss= tensor(3644.2876)
optimized based on ToM loss
---------------------
gamma: 0.1