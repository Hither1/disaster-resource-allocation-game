obs <crafter.objects.Shelter object at 0x13cd5b7f0> [39.  0.  0.  0. 39.  0.  0.  0. 10.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x11da945b0> [38.  0.  0.  0. 38.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x13cd61220> [ 9.  0.  0.  0.  9.  0.  0.  0. 15.  0.  0.  0.]
obs <crafter.objects.Shelter object at 0x13cd5b7f0> [39.  0.  0.  0. 39.  0.  0.  0. 12.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x11da945b0> [40.  0.  0.  0. 40.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x13cd61220> [ 9.  0.  0.  0.  9.  0.  0.  0. 12.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.003370046615600586 seconds
19 rew tensor(0.5411, dtype=torch.float64) delta_t tensor(0.5278, dtype=torch.float64)
19 gae_duplicate tensor(0.2475, dtype=torch.float64) tensor(-10.3523, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5036, dtype=torch.float64) delta_t tensor(0.5241, dtype=torch.float64)
18 gae_duplicate tensor(0.2979, dtype=torch.float64) tensor(-11.3279, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4807, dtype=torch.float64) delta_t tensor(0.3482, dtype=torch.float64)
17 gae_duplicate tensor(-0.1253, dtype=torch.float64) tensor(-8.0014, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5644, dtype=torch.float64) delta_t tensor(0.5395, dtype=torch.float64)
16 gae_duplicate tensor(0.1298, dtype=torch.float64) tensor(-11.5185, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3342, dtype=torch.float64) delta_t tensor(0.3104, dtype=torch.float64)
15 gae_duplicate tensor(-0.0995, dtype=torch.float64) tensor(-7.3299, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6577, dtype=torch.float64) delta_t tensor(0.6562, dtype=torch.float64)
14 gae_duplicate tensor(0.3229, dtype=torch.float64) tensor(-13.6441, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3664, dtype=torch.float64) delta_t tensor(0.3752, dtype=torch.float64)
13 gae_duplicate tensor(0.1499, dtype=torch.float64) tensor(-8.6646, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7064, dtype=torch.float64) delta_t tensor(0.6679, dtype=torch.float64)
12 gae_duplicate tensor(0.4934, dtype=torch.float64) tensor(-14.0933, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4364, dtype=torch.float64) delta_t tensor(0.4062, dtype=torch.float64)
11 gae_duplicate tensor(0.1503, dtype=torch.float64) tensor(-9.3942, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7522, dtype=torch.float64) delta_t tensor(0.7352, dtype=torch.float64)
10 gae_duplicate tensor(0.5036, dtype=torch.float64) tensor(-15.3518, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4833, dtype=torch.float64) delta_t tensor(0.3511, dtype=torch.float64)
9 gae_duplicate tensor(0.0183, dtype=torch.float64) tensor(-8.5497, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7975, dtype=torch.float64) delta_t tensor(0.8002, dtype=torch.float64)
8 gae_duplicate tensor(0.4401, dtype=torch.float64) tensor(-16.6454, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5956, dtype=torch.float64) delta_t tensor(0.4963, dtype=torch.float64)
7 gae_duplicate tensor(0.2743, dtype=torch.float64) tensor(-11.3821, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.8739, dtype=torch.float64) delta_t tensor(0.7993, dtype=torch.float64)
6 gae_duplicate tensor(0.4549, dtype=torch.float64) tensor(-16.9343, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2928, dtype=torch.float64) delta_t tensor(0.1661, dtype=torch.float64)
5 gae_duplicate tensor(-1.3551, dtype=torch.float64) tensor(-4.8699, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3539, dtype=torch.float64) delta_t tensor(-1.4430, dtype=torch.float64)
4 gae_duplicate tensor(-1.9905, dtype=torch.float64) tensor(27.9016, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.0000, dtype=torch.float64) delta_t tensor(0.8516, dtype=torch.float64)
3 gae_duplicate tensor(-0.3595, dtype=torch.float64) tensor(-13.7920, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0., dtype=torch.float64) delta_t tensor(-0.0425, dtype=torch.float64)
2 gae_duplicate tensor(-0.0596, dtype=torch.float64) tensor(-0.5721, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:8248.0966796875
value loss:100.75476837158203
entropies:355.8198547363281
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 5.229737043380737 seconds
19 rew tensor(0.2515, dtype=torch.float64) delta_t tensor(0.1941, dtype=torch.float64)
19 gae_duplicate tensor(-0.9403, dtype=torch.float64) tensor(-3.8566, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5574, dtype=torch.float64) delta_t tensor(0.4773, dtype=torch.float64)
18 gae_duplicate tensor(0.3042, dtype=torch.float64) tensor(-9.8010, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3790, dtype=torch.float64) delta_t tensor(0.3507, dtype=torch.float64)
17 gae_duplicate tensor(-0.0522, dtype=torch.float64) tensor(-7.8036, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6181, dtype=torch.float64) delta_t tensor(0.5688, dtype=torch.float64)
16 gae_duplicate tensor(0.3119, dtype=torch.float64) tensor(-12.1044, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0909, dtype=torch.float64) delta_t tensor(-0.0504, dtype=torch.float64)
15 gae_duplicate tensor(-0.0466, dtype=torch.float64) tensor(-0.1935, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6202, dtype=torch.float64) delta_t tensor(0.5758, dtype=torch.float64)
14 gae_duplicate tensor(0.3852, dtype=torch.float64) tensor(-11.4731, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1063, dtype=torch.float64) delta_t tensor(-0.0013, dtype=torch.float64)
13 gae_duplicate tensor(-0.0401, dtype=torch.float64) tensor(-1.1655, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6293, dtype=torch.float64) delta_t tensor(0.4670, dtype=torch.float64)
12 gae_duplicate tensor(0.1904, dtype=torch.float64) tensor(-9.5336, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1182, dtype=torch.float64) delta_t tensor(0.0745, dtype=torch.float64)
11 gae_duplicate tensor(-0.0844, dtype=torch.float64) tensor(-2.4224, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6331, dtype=torch.float64) delta_t tensor(0.5712, dtype=torch.float64)
10 gae_duplicate tensor(0.3594, dtype=torch.float64) tensor(-11.4794, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1232, dtype=torch.float64) delta_t tensor(-0.0538, dtype=torch.float64)
9 gae_duplicate tensor(-0.2413, dtype=torch.float64) tensor(-0.0583, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5910, dtype=torch.float64) delta_t tensor(0.5805, dtype=torch.float64)
8 gae_duplicate tensor(0.4039, dtype=torch.float64) tensor(-11.3066, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1003, dtype=torch.float64) delta_t tensor(0.0042, dtype=torch.float64)
7 gae_duplicate tensor(-0.1333, dtype=torch.float64) tensor(-1.2297, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5420, dtype=torch.float64) delta_t tensor(0.4021, dtype=torch.float64)
6 gae_duplicate tensor(0.2995, dtype=torch.float64) tensor(-8.2859, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0741, dtype=torch.float64) delta_t tensor(-0.2806, dtype=torch.float64)
5 gae_duplicate tensor(-0.4579, dtype=torch.float64) tensor(4.6957, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5147, dtype=torch.float64) delta_t tensor(-3.7575, dtype=torch.float64)
4 gae_duplicate tensor(-4.8001, dtype=torch.float64) tensor(74.6800, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3393, dtype=torch.float64) delta_t tensor(-0.5529, dtype=torch.float64)
3 gae_duplicate tensor(-1.4986, dtype=torch.float64) tensor(18.7015, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3748, dtype=torch.float64) delta_t tensor(-0.3658, dtype=torch.float64)
2 gae_duplicate tensor(-0.9165, dtype=torch.float64) tensor(9.1021, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-985.1248779296875
value loss:174.79278564453125
entropies:355.4615478515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.383302927017212 seconds
19 rew tensor(0.4449, dtype=torch.float64) delta_t tensor(0.3132, dtype=torch.float64)
19 gae_duplicate tensor(0.1504, dtype=torch.float64) tensor(-6.1554, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4736, dtype=torch.float64) delta_t tensor(0.3684, dtype=torch.float64)
18 gae_duplicate tensor(0.1458, dtype=torch.float64) tensor(-8.1603, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4051, dtype=torch.float64) delta_t tensor(0.2751, dtype=torch.float64)
17 gae_duplicate tensor(0.1030, dtype=torch.float64) tensor(-6.1523, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4913, dtype=torch.float64) delta_t tensor(0.3740, dtype=torch.float64)
16 gae_duplicate tensor(0.1748, dtype=torch.float64) tensor(-8.0394, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3830, dtype=torch.float64) delta_t tensor(0.2693, dtype=torch.float64)
15 gae_duplicate tensor(0.1794, dtype=torch.float64) tensor(-6.1005, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4916, dtype=torch.float64) delta_t tensor(0.3781, dtype=torch.float64)
14 gae_duplicate tensor(0.1357, dtype=torch.float64) tensor(-8.0580, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3988, dtype=torch.float64) delta_t tensor(0.2470, dtype=torch.float64)
13 gae_duplicate tensor(0.0279, dtype=torch.float64) tensor(-5.5512, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4921, dtype=torch.float64) delta_t tensor(0.3666, dtype=torch.float64)
12 gae_duplicate tensor(0.1873, dtype=torch.float64) tensor(-7.8516, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3687, dtype=torch.float64) delta_t tensor(0.2143, dtype=torch.float64)
11 gae_duplicate tensor(0.0630, dtype=torch.float64) tensor(-5.0500, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5184, dtype=torch.float64) delta_t tensor(0.3805, dtype=torch.float64)
10 gae_duplicate tensor(0.1887, dtype=torch.float64) tensor(-7.9257, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1354, dtype=torch.float64) delta_t tensor(-0.0179, dtype=torch.float64)
9 gae_duplicate tensor(-0.8960, dtype=torch.float64) tensor(-0.4737, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4523, dtype=torch.float64) delta_t tensor(-0.5434, dtype=torch.float64)
8 gae_duplicate tensor(-5.3863, dtype=torch.float64) tensor(10.9106, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3056, dtype=torch.float64) delta_t tensor(0.1198, dtype=torch.float64)
7 gae_duplicate tensor(-0.4114, dtype=torch.float64) tensor(-1.1990, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3836, dtype=torch.float64) delta_t tensor(0.2258, dtype=torch.float64)
6 gae_duplicate tensor(-0.1191, dtype=torch.float64) tensor(-4.6440, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0694, dtype=torch.float64) delta_t tensor(-0.2327, dtype=torch.float64)
5 gae_duplicate tensor(-0.4991, dtype=torch.float64) tensor(4.1036, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1592, dtype=torch.float64) delta_t tensor(-3.3064, dtype=torch.float64)
4 gae_duplicate tensor(-4.6932, dtype=torch.float64) tensor(65.2155, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0614, dtype=torch.float64) delta_t tensor(-0.1763, dtype=torch.float64)
3 gae_duplicate tensor(-1.2382, dtype=torch.float64) tensor(10.0926, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2415, dtype=torch.float64) delta_t tensor(-0.2833, dtype=torch.float64)
2 gae_duplicate tensor(-0.7669, dtype=torch.float64) tensor(6.7914, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1270.5247802734375
value loss:195.14657592773438
entropies:355.09619140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.453081846237183 seconds
19 rew tensor(0.4464, dtype=torch.float64) delta_t tensor(0.3278, dtype=torch.float64)
19 gae_duplicate tensor(0.1258, dtype=torch.float64) tensor(-6.5422, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3716, dtype=torch.float64) delta_t tensor(0.2669, dtype=torch.float64)
18 gae_duplicate tensor(0.1562, dtype=torch.float64) tensor(-5.9880, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3582, dtype=torch.float64) delta_t tensor(0.2260, dtype=torch.float64)
17 gae_duplicate tensor(0.0897, dtype=torch.float64) tensor(-5.1553, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4643, dtype=torch.float64) delta_t tensor(0.3563, dtype=torch.float64)
16 gae_duplicate tensor(0.2517, dtype=torch.float64) tensor(-7.7357, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2332, dtype=torch.float64) delta_t tensor(0.1028, dtype=torch.float64)
15 gae_duplicate tensor(-0.2218, dtype=torch.float64) tensor(-2.7606, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4844, dtype=torch.float64) delta_t tensor(0.3763, dtype=torch.float64)
14 gae_duplicate tensor(0.1580, dtype=torch.float64) tensor(-7.7974, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2540, dtype=torch.float64) delta_t tensor(0.1579, dtype=torch.float64)
13 gae_duplicate tensor(-0.1674, dtype=torch.float64) tensor(-3.9164, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4872, dtype=torch.float64) delta_t tensor(0.3780, dtype=torch.float64)
12 gae_duplicate tensor(0.2500, dtype=torch.float64) tensor(-7.8054, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2455, dtype=torch.float64) delta_t tensor(0.1187, dtype=torch.float64)
11 gae_duplicate tensor(-0.1532, dtype=torch.float64) tensor(-3.1487, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4698, dtype=torch.float64) delta_t tensor(0.3359, dtype=torch.float64)
10 gae_duplicate tensor(0.1666, dtype=torch.float64) tensor(-6.9153, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2550, dtype=torch.float64) delta_t tensor(0.1222, dtype=torch.float64)
9 gae_duplicate tensor(-0.1967, dtype=torch.float64) tensor(-3.0068, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4614, dtype=torch.float64) delta_t tensor(0.3867, dtype=torch.float64)
8 gae_duplicate tensor(0.2088, dtype=torch.float64) tensor(-7.8502, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2335, dtype=torch.float64) delta_t tensor(0.0729, dtype=torch.float64)
7 gae_duplicate tensor(-0.1956, dtype=torch.float64) tensor(-2.2104, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3821, dtype=torch.float64) delta_t tensor(0.2291, dtype=torch.float64)
6 gae_duplicate tensor(0.1358, dtype=torch.float64) tensor(-4.7061, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0299, dtype=torch.float64) delta_t tensor(-0.1739, dtype=torch.float64)
5 gae_duplicate tensor(-0.4702, dtype=torch.float64) tensor(3.0495, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0293, dtype=torch.float64) delta_t tensor(-3.2194, dtype=torch.float64)
4 gae_duplicate tensor(-6.2959, dtype=torch.float64) tensor(61.7695, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1243, dtype=torch.float64) delta_t tensor(-0.3059, dtype=torch.float64)
3 gae_duplicate tensor(-0.9539, dtype=torch.float64) tensor(12.2050, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2815, dtype=torch.float64) delta_t tensor(-0.2535, dtype=torch.float64)
2 gae_duplicate tensor(-0.5567, dtype=torch.float64) tensor(6.2109, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-511.4616394042969
value loss:135.5231170654297
entropies:355.0580749511719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.3777101039886475 seconds
19 rew tensor(0.4975, dtype=torch.float64) delta_t tensor(0.3762, dtype=torch.float64)
19 gae_duplicate tensor(0.2588, dtype=torch.float64) tensor(-7.4156, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5139, dtype=torch.float64) delta_t tensor(0.3891, dtype=torch.float64)
18 gae_duplicate tensor(0.1895, dtype=torch.float64) tensor(-8.3435, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4548, dtype=torch.float64) delta_t tensor(0.2948, dtype=torch.float64)
17 gae_duplicate tensor(0.1099, dtype=torch.float64) tensor(-6.6575, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5336, dtype=torch.float64) delta_t tensor(0.4053, dtype=torch.float64)
16 gae_duplicate tensor(0.2914, dtype=torch.float64) tensor(-8.5143, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2337, dtype=torch.float64) delta_t tensor(0.1177, dtype=torch.float64)
15 gae_duplicate tensor(0.0077, dtype=torch.float64) tensor(-3.3943, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5643, dtype=torch.float64) delta_t tensor(0.4417, dtype=torch.float64)
14 gae_duplicate tensor(0.3725, dtype=torch.float64) tensor(-9.0871, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2120, dtype=torch.float64) delta_t tensor(0.1085, dtype=torch.float64)
13 gae_duplicate tensor(0.0051, dtype=torch.float64) tensor(-3.0630, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5471, dtype=torch.float64) delta_t tensor(0.3938, dtype=torch.float64)
12 gae_duplicate tensor(0.2892, dtype=torch.float64) tensor(-7.9653, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1855, dtype=torch.float64) delta_t tensor(0.0330, dtype=torch.float64)
11 gae_duplicate tensor(-0.1641, dtype=torch.float64) tensor(-1.5847, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5290, dtype=torch.float64) delta_t tensor(0.3871, dtype=torch.float64)
10 gae_duplicate tensor(0.2433, dtype=torch.float64) tensor(-7.6605, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3447, dtype=torch.float64) delta_t tensor(-0.4807, dtype=torch.float64)
9 gae_duplicate tensor(-2.2969, dtype=torch.float64) tensor(9.4012, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3008, dtype=torch.float64) delta_t tensor(-0.4338, dtype=torch.float64)
8 gae_duplicate tensor(-4.7150, dtype=torch.float64) tensor(9.0826, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0400, dtype=torch.float64) delta_t tensor(-0.1092, dtype=torch.float64)
7 gae_duplicate tensor(-0.3884, dtype=torch.float64) tensor(3.0888, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3479, dtype=torch.float64) delta_t tensor(0.1840, dtype=torch.float64)
6 gae_duplicate tensor(-0.2893, dtype=torch.float64) tensor(-3.3022, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2886, dtype=torch.float64) delta_t tensor(-0.4557, dtype=torch.float64)
5 gae_duplicate tensor(-1.5020, dtype=torch.float64) tensor(8.9952, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6502, dtype=torch.float64) delta_t tensor(-3.8152, dtype=torch.float64)
4 gae_duplicate tensor(-5.5340, dtype=torch.float64) tensor(75.1132, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0908, dtype=torch.float64) delta_t tensor(-0.1366, dtype=torch.float64)
3 gae_duplicate tensor(-0.9737, dtype=torch.float64) tensor(10.2961, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2390, dtype=torch.float64) delta_t tensor(-0.1239, dtype=torch.float64)
2 gae_duplicate tensor(-0.5086, dtype=torch.float64) tensor(3.5777, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2934.506103515625
value loss:231.63092041015625
entropies:355.1779479980469
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3978.6604)
ToM Target loss= tensor(3494.0417)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.204603910446167 seconds
19 rew tensor(0.4635, dtype=torch.float64) delta_t tensor(0.3678, dtype=torch.float64)
19 gae_duplicate tensor(0.1226, dtype=torch.float64) tensor(-7.2427, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4197, dtype=torch.float64) delta_t tensor(0.3254, dtype=torch.float64)
18 gae_duplicate tensor(0.2001, dtype=torch.float64) tensor(-7.1400, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3831, dtype=torch.float64) delta_t tensor(0.2685, dtype=torch.float64)
17 gae_duplicate tensor(0.0373, dtype=torch.float64) tensor(-6.0337, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4783, dtype=torch.float64) delta_t tensor(0.3524, dtype=torch.float64)
16 gae_duplicate tensor(0.1610, dtype=torch.float64) tensor(-7.5937, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2204, dtype=torch.float64) delta_t tensor(0.1299, dtype=torch.float64)
15 gae_duplicate tensor(-0.0090, dtype=torch.float64) tensor(-3.1872, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5108, dtype=torch.float64) delta_t tensor(0.4135, dtype=torch.float64)
14 gae_duplicate tensor(0.2516, dtype=torch.float64) tensor(-8.6307, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1440, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
13 gae_duplicate tensor(-0.0819, dtype=torch.float64) tensor(-2.0023, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5049, dtype=torch.float64) delta_t tensor(0.3730, dtype=torch.float64)
12 gae_duplicate tensor(0.2209, dtype=torch.float64) tensor(-7.6804, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1352, dtype=torch.float64) delta_t tensor(0.0178, dtype=torch.float64)
11 gae_duplicate tensor(-0.1410, dtype=torch.float64) tensor(-1.0577, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4880, dtype=torch.float64) delta_t tensor(0.3440, dtype=torch.float64)
10 gae_duplicate tensor(0.2150, dtype=torch.float64) tensor(-6.9058, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1401, dtype=torch.float64) delta_t tensor(0.0612, dtype=torch.float64)
9 gae_duplicate tensor(-0.0123, dtype=torch.float64) tensor(-1.9504, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4452, dtype=torch.float64) delta_t tensor(0.3403, dtype=torch.float64)
8 gae_duplicate tensor(0.2280, dtype=torch.float64) tensor(-6.9309, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0864, dtype=torch.float64) delta_t tensor(-0.0296, dtype=torch.float64)
7 gae_duplicate tensor(-0.3098, dtype=torch.float64) tensor(-0.0461, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3973, dtype=torch.float64) delta_t tensor(0.2791, dtype=torch.float64)
6 gae_duplicate tensor(0.1916, dtype=torch.float64) tensor(-5.4637, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1114, dtype=torch.float64) delta_t tensor(-0.2541, dtype=torch.float64)
5 gae_duplicate tensor(-0.5448, dtype=torch.float64) tensor(4.4811, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9158, dtype=torch.float64) delta_t tensor(-4.0572, dtype=torch.float64)
4 gae_duplicate tensor(-5.7883, dtype=torch.float64) tensor(80.8032, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0779, dtype=torch.float64) delta_t tensor(-0.0952, dtype=torch.float64)
3 gae_duplicate tensor(-0.6465, dtype=torch.float64) tensor(9.8556, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1380, dtype=torch.float64) delta_t tensor(-0.0004, dtype=torch.float64)
2 gae_duplicate tensor(-0.2175, dtype=torch.float64) tensor(0.9902, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1406.2718505859375
value loss:179.30032348632812
entropies:355.4067687988281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.742232799530029 seconds
19 rew tensor(0.5075, dtype=torch.float64) delta_t tensor(0.4691, dtype=torch.float64)
19 gae_duplicate tensor(0.0735, dtype=torch.float64) tensor(-9.2894, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3953, dtype=torch.float64) delta_t tensor(0.3586, dtype=torch.float64)
18 gae_duplicate tensor(0.1484, dtype=torch.float64) tensor(-7.9641, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4640, dtype=torch.float64) delta_t tensor(0.3919, dtype=torch.float64)
17 gae_duplicate tensor(0.1104, dtype=torch.float64) tensor(-8.4318, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3861, dtype=torch.float64) delta_t tensor(0.3659, dtype=torch.float64)
16 gae_duplicate tensor(0.0500, dtype=torch.float64) tensor(-8.1544, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3786, dtype=torch.float64) delta_t tensor(0.2891, dtype=torch.float64)
15 gae_duplicate tensor(0.0757, dtype=torch.float64) tensor(-6.4085, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3762, dtype=torch.float64) delta_t tensor(0.3202, dtype=torch.float64)
14 gae_duplicate tensor(0.1230, dtype=torch.float64) tensor(-6.8131, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3833, dtype=torch.float64) delta_t tensor(0.3302, dtype=torch.float64)
13 gae_duplicate tensor(0.0788, dtype=torch.float64) tensor(-7.1703, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3545, dtype=torch.float64) delta_t tensor(0.2620, dtype=torch.float64)
12 gae_duplicate tensor(0.1448, dtype=torch.float64) tensor(-5.8723, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3616, dtype=torch.float64) delta_t tensor(0.3110, dtype=torch.float64)
11 gae_duplicate tensor(-0.0088, dtype=torch.float64) tensor(-6.7241, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3774, dtype=torch.float64) delta_t tensor(0.2735, dtype=torch.float64)
10 gae_duplicate tensor(0.1131, dtype=torch.float64) tensor(-6.0598, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2860, dtype=torch.float64) delta_t tensor(0.2362, dtype=torch.float64)
9 gae_duplicate tensor(-0.0638, dtype=torch.float64) tensor(-5.2467, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3558, dtype=torch.float64) delta_t tensor(0.2981, dtype=torch.float64)
8 gae_duplicate tensor(0.1469, dtype=torch.float64) tensor(-6.3625, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2644, dtype=torch.float64) delta_t tensor(0.1677, dtype=torch.float64)
7 gae_duplicate tensor(-0.1328, dtype=torch.float64) tensor(-4.0149, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2812, dtype=torch.float64) delta_t tensor(0.2620, dtype=torch.float64)
6 gae_duplicate tensor(0.1191, dtype=torch.float64) tensor(-5.5823, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0380, dtype=torch.float64) delta_t tensor(-0.1794, dtype=torch.float64)
5 gae_duplicate tensor(-0.4297, dtype=torch.float64) tensor(2.8405, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5737, dtype=torch.float64) delta_t tensor(-1.6625, dtype=torch.float64)
4 gae_duplicate tensor(-4.6003, dtype=torch.float64) tensor(33.5238, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0814, dtype=torch.float64) delta_t tensor(0.1131, dtype=torch.float64)
3 gae_duplicate tensor(-0.6738, dtype=torch.float64) tensor(0.9311, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3579, dtype=torch.float64) delta_t tensor(-0.2417, dtype=torch.float64)
2 gae_duplicate tensor(-0.5225, dtype=torch.float64) tensor(4.8656, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2708.4345703125
value loss:82.12625885009766
entropies:355.4231872558594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.234172105789185 seconds
19 rew tensor(0.3203, dtype=torch.float64) delta_t tensor(0.2850, dtype=torch.float64)
19 gae_duplicate tensor(0.0077, dtype=torch.float64) tensor(-5.6686, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5702, dtype=torch.float64) delta_t tensor(0.4789, dtype=torch.float64)
18 gae_duplicate tensor(0.3530, dtype=torch.float64) tensor(-9.9669, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3064, dtype=torch.float64) delta_t tensor(0.2052, dtype=torch.float64)
17 gae_duplicate tensor(0.0083, dtype=torch.float64) tensor(-4.8572, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5093, dtype=torch.float64) delta_t tensor(0.4296, dtype=torch.float64)
16 gae_duplicate tensor(0.3947, dtype=torch.float64) tensor(-9.1819, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2493, dtype=torch.float64) delta_t tensor(0.2039, dtype=torch.float64)
15 gae_duplicate tensor(0.1591, dtype=torch.float64) tensor(-4.8966, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5531, dtype=torch.float64) delta_t tensor(0.3969, dtype=torch.float64)
14 gae_duplicate tensor(0.3296, dtype=torch.float64) tensor(-8.3145, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1427, dtype=torch.float64) delta_t tensor(0.0824, dtype=torch.float64)
13 gae_duplicate tensor(-0.0361, dtype=torch.float64) tensor(-2.3768, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5611, dtype=torch.float64) delta_t tensor(0.4298, dtype=torch.float64)
12 gae_duplicate tensor(0.3197, dtype=torch.float64) tensor(-8.5691, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1530, dtype=torch.float64) delta_t tensor(0.0510, dtype=torch.float64)
11 gae_duplicate tensor(-0.1281, dtype=torch.float64) tensor(-1.9423, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5345, dtype=torch.float64) delta_t tensor(0.3582, dtype=torch.float64)
10 gae_duplicate tensor(0.2236, dtype=torch.float64) tensor(-7.1838, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1442, dtype=torch.float64) delta_t tensor(0.1356, dtype=torch.float64)
9 gae_duplicate tensor(0.0337, dtype=torch.float64) tensor(-3.4069, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4435, dtype=torch.float64) delta_t tensor(0.3107, dtype=torch.float64)
8 gae_duplicate tensor(0.1578, dtype=torch.float64) tensor(-6.5183, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0395, dtype=torch.float64) delta_t tensor(-0.0363, dtype=torch.float64)
7 gae_duplicate tensor(-0.3561, dtype=torch.float64) tensor(0.0803, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4299, dtype=torch.float64) delta_t tensor(0.3404, dtype=torch.float64)
6 gae_duplicate tensor(0.1985, dtype=torch.float64) tensor(-6.7114, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2179, dtype=torch.float64) delta_t tensor(-0.3069, dtype=torch.float64)
5 gae_duplicate tensor(-0.7958, dtype=torch.float64) tensor(5.4723, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3198, dtype=torch.float64) delta_t tensor(-2.3898, dtype=torch.float64)
4 gae_duplicate tensor(-6.1877, dtype=torch.float64) tensor(47.4725, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1632, dtype=torch.float64) delta_t tensor(0.0171, dtype=torch.float64)
3 gae_duplicate tensor(-0.4163, dtype=torch.float64) tensor(4.5119, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1726, dtype=torch.float64) delta_t tensor(0.0442, dtype=torch.float64)
2 gae_duplicate tensor(-0.5149, dtype=torch.float64) tensor(-0.4368, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1118.747802734375
value loss:106.41036224365234
entropies:355.3337707519531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.248449087142944 seconds
19 rew tensor(0.4177, dtype=torch.float64) delta_t tensor(0.3881, dtype=torch.float64)
19 gae_duplicate tensor(0.1472, dtype=torch.float64) tensor(-7.6879, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4264, dtype=torch.float64) delta_t tensor(0.3388, dtype=torch.float64)
18 gae_duplicate tensor(0.1109, dtype=torch.float64) tensor(-7.3831, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3547, dtype=torch.float64) delta_t tensor(0.2521, dtype=torch.float64)
17 gae_duplicate tensor(0.0941, dtype=torch.float64) tensor(-5.7454, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5281, dtype=torch.float64) delta_t tensor(0.3813, dtype=torch.float64)
16 gae_duplicate tensor(0.2752, dtype=torch.float64) tensor(-7.9317, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1181, dtype=torch.float64) delta_t tensor(0.0298, dtype=torch.float64)
15 gae_duplicate tensor(-0.2615, dtype=torch.float64) tensor(-1.3993, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5259, dtype=torch.float64) delta_t tensor(0.3474, dtype=torch.float64)
14 gae_duplicate tensor(0.2339, dtype=torch.float64) tensor(-6.8562, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0215, dtype=torch.float64) delta_t tensor(0.0184, dtype=torch.float64)
13 gae_duplicate tensor(-0.1302, dtype=torch.float64) tensor(-1.1050, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5504, dtype=torch.float64) delta_t tensor(0.4047, dtype=torch.float64)
12 gae_duplicate tensor(0.2163, dtype=torch.float64) tensor(-8.1479, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0063, dtype=torch.float64) delta_t tensor(-0.0496, dtype=torch.float64)
11 gae_duplicate tensor(-0.2759, dtype=torch.float64) tensor(0.1783, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4804, dtype=torch.float64) delta_t tensor(0.2646, dtype=torch.float64)
10 gae_duplicate tensor(0.1402, dtype=torch.float64) tensor(-5.3579, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0571, dtype=torch.float64) delta_t tensor(-0.0192, dtype=torch.float64)
9 gae_duplicate tensor(-0.1748, dtype=torch.float64) tensor(-0.1032, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5085, dtype=torch.float64) delta_t tensor(0.3254, dtype=torch.float64)
8 gae_duplicate tensor(0.1648, dtype=torch.float64) tensor(-6.4277, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1027, dtype=torch.float64) delta_t tensor(-0.1830, dtype=torch.float64)
7 gae_duplicate tensor(-0.5317, dtype=torch.float64) tensor(2.8547, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3858, dtype=torch.float64) delta_t tensor(0.2607, dtype=torch.float64)
6 gae_duplicate tensor(0.0580, dtype=torch.float64) tensor(-4.8562, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3061, dtype=torch.float64) delta_t tensor(-0.4049, dtype=torch.float64)
5 gae_duplicate tensor(-0.6250, dtype=torch.float64) tensor(7.4739, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.6786, dtype=torch.float64) delta_t tensor(-4.7236, dtype=torch.float64)
4 gae_duplicate tensor(-6.8756, dtype=torch.float64) tensor(93.6614, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1189, dtype=torch.float64) delta_t tensor(0.0303, dtype=torch.float64)
3 gae_duplicate tensor(-0.8694, dtype=torch.float64) tensor(8.7438, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1420, dtype=torch.float64) delta_t tensor(0.1752, dtype=torch.float64)
2 gae_duplicate tensor(-0.1227, dtype=torch.float64) tensor(-2.6942, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2645.62646484375
value loss:253.51263427734375
entropies:355.3388977050781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.98821496963501 seconds
19 rew tensor(0.3476, dtype=torch.float64) delta_t tensor(0.2528, dtype=torch.float64)
19 gae_duplicate tensor(-0.0616, dtype=torch.float64) tensor(-5.0839, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4558, dtype=torch.float64) delta_t tensor(0.3063, dtype=torch.float64)
18 gae_duplicate tensor(0.1157, dtype=torch.float64) tensor(-6.4810, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3572, dtype=torch.float64) delta_t tensor(0.2651, dtype=torch.float64)
17 gae_duplicate tensor(0.0624, dtype=torch.float64) tensor(-5.9108, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4060, dtype=torch.float64) delta_t tensor(0.2421, dtype=torch.float64)
16 gae_duplicate tensor(0.0880, dtype=torch.float64) tensor(-5.3825, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2291, dtype=torch.float64) delta_t tensor(0.1639, dtype=torch.float64)
15 gae_duplicate tensor(-0.0707, dtype=torch.float64) tensor(-3.7286, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4684, dtype=torch.float64) delta_t tensor(0.4234, dtype=torch.float64)
14 gae_duplicate tensor(0.2579, dtype=torch.float64) tensor(-8.8036, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1985, dtype=torch.float64) delta_t tensor(0.1587, dtype=torch.float64)
13 gae_duplicate tensor(-0.0826, dtype=torch.float64) tensor(-4.0111, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4699, dtype=torch.float64) delta_t tensor(0.3286, dtype=torch.float64)
12 gae_duplicate tensor(0.0952, dtype=torch.float64) tensor(-7.0083, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1791, dtype=torch.float64) delta_t tensor(0.1198, dtype=torch.float64)
11 gae_duplicate tensor(-0.2851, dtype=torch.float64) tensor(-2.9963, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4465, dtype=torch.float64) delta_t tensor(0.2849, dtype=torch.float64)
10 gae_duplicate tensor(0.2108, dtype=torch.float64) tensor(-5.9139, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1823, dtype=torch.float64) delta_t tensor(0.1896, dtype=torch.float64)
9 gae_duplicate tensor(-0.1427, dtype=torch.float64) tensor(-4.1934, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4296, dtype=torch.float64) delta_t tensor(0.3365, dtype=torch.float64)
8 gae_duplicate tensor(0.2705, dtype=torch.float64) tensor(-7.1994, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1629, dtype=torch.float64) delta_t tensor(0.0997, dtype=torch.float64)
7 gae_duplicate tensor(-0.2583, dtype=torch.float64) tensor(-2.6408, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3544, dtype=torch.float64) delta_t tensor(0.3209, dtype=torch.float64)
6 gae_duplicate tensor(0.2179, dtype=torch.float64) tensor(-6.5883, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0410, dtype=torch.float64) delta_t tensor(-0.1933, dtype=torch.float64)
5 gae_duplicate tensor(-0.7690, dtype=torch.float64) tensor(3.1433, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6618, dtype=torch.float64) delta_t tensor(-2.8179, dtype=torch.float64)
4 gae_duplicate tensor(-5.8350, dtype=torch.float64) tensor(56.4436, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1053, dtype=torch.float64) delta_t tensor(0.0525, dtype=torch.float64)
3 gae_duplicate tensor(-0.5417, dtype=torch.float64) tensor(4.6443, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2491, dtype=torch.float64) delta_t tensor(-0.0623, dtype=torch.float64)
2 gae_duplicate tensor(-0.3213, dtype=torch.float64) tensor(1.6256, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:448.633544921875
value loss:116.28982543945312
entropies:355.368896484375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3954.2617)
ToM Target loss= tensor(3535.9614)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.124552011489868 seconds
19 rew tensor(0.4239, dtype=torch.float64) delta_t tensor(0.3261, dtype=torch.float64)
19 gae_duplicate tensor(-0.1144, dtype=torch.float64) tensor(-6.2823, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4112, dtype=torch.float64) delta_t tensor(0.3199, dtype=torch.float64)
18 gae_duplicate tensor(0.2423, dtype=torch.float64) tensor(-6.9105, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4078, dtype=torch.float64) delta_t tensor(0.2775, dtype=torch.float64)
17 gae_duplicate tensor(0.0194, dtype=torch.float64) tensor(-6.2192, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4442, dtype=torch.float64) delta_t tensor(0.2875, dtype=torch.float64)
16 gae_duplicate tensor(0.0363, dtype=torch.float64) tensor(-6.2341, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3371, dtype=torch.float64) delta_t tensor(0.2895, dtype=torch.float64)
15 gae_duplicate tensor(-0.1084, dtype=torch.float64) tensor(-6.3494, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4378, dtype=torch.float64) delta_t tensor(0.3768, dtype=torch.float64)
14 gae_duplicate tensor(0.2501, dtype=torch.float64) tensor(-8.1656, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3635, dtype=torch.float64) delta_t tensor(0.2957, dtype=torch.float64)
13 gae_duplicate tensor(0.0850, dtype=torch.float64) tensor(-6.6071, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4482, dtype=torch.float64) delta_t tensor(0.3062, dtype=torch.float64)
12 gae_duplicate tensor(0.0718, dtype=torch.float64) tensor(-6.7504, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3538, dtype=torch.float64) delta_t tensor(0.2915, dtype=torch.float64)
11 gae_duplicate tensor(-0.0980, dtype=torch.float64) tensor(-6.5407, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4232, dtype=torch.float64) delta_t tensor(0.2720, dtype=torch.float64)
10 gae_duplicate tensor(0.1724, dtype=torch.float64) tensor(-5.8894, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0632, dtype=torch.float64) delta_t tensor(-0.1083, dtype=torch.float64)
9 gae_duplicate tensor(-1.8608, dtype=torch.float64) tensor(1.7599, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5311, dtype=torch.float64) delta_t tensor(-0.5982, dtype=torch.float64)
8 gae_duplicate tensor(-5.1080, dtype=torch.float64) tensor(12.0849, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3000, dtype=torch.float64) delta_t tensor(0.1906, dtype=torch.float64)
7 gae_duplicate tensor(-0.3983, dtype=torch.float64) tensor(-2.5491, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2822, dtype=torch.float64) delta_t tensor(0.2796, dtype=torch.float64)
6 gae_duplicate tensor(0.1245, dtype=torch.float64) tensor(-5.8363, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0921, dtype=torch.float64) delta_t tensor(0.0084, dtype=torch.float64)
5 gae_duplicate tensor(-0.3908, dtype=torch.float64) tensor(-0.7715, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6668, dtype=torch.float64) delta_t tensor(-2.8266, dtype=torch.float64)
4 gae_duplicate tensor(-6.8831, dtype=torch.float64) tensor(55.0628, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0174, dtype=torch.float64) delta_t tensor(0.1760, dtype=torch.float64)
3 gae_duplicate tensor(-0.5272, dtype=torch.float64) tensor(2.1283, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3175, dtype=torch.float64) delta_t tensor(-0.1105, dtype=torch.float64)
2 gae_duplicate tensor(-0.2836, dtype=torch.float64) tensor(2.3380, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2.463787078857422
value loss:187.30416870117188
entropies:355.4659118652344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.878679037094116 seconds
19 rew tensor(0.5342, dtype=torch.float64) delta_t tensor(0.5509, dtype=torch.float64)
19 gae_duplicate tensor(0.2612, dtype=torch.float64) tensor(-10.8520, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4139, dtype=torch.float64) delta_t tensor(0.3168, dtype=torch.float64)
18 gae_duplicate tensor(0.1734, dtype=torch.float64) tensor(-7.3079, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4059, dtype=torch.float64) delta_t tensor(0.3139, dtype=torch.float64)
17 gae_duplicate tensor(0.1520, dtype=torch.float64) tensor(-6.9395, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4996, dtype=torch.float64) delta_t tensor(0.2610, dtype=torch.float64)
16 gae_duplicate tensor(0.1725, dtype=torch.float64) tensor(-5.8024, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0364, dtype=torch.float64) delta_t tensor(0.0069, dtype=torch.float64)
15 gae_duplicate tensor(-0.2212, dtype=torch.float64) tensor(-0.7062, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5131, dtype=torch.float64) delta_t tensor(0.3436, dtype=torch.float64)
14 gae_duplicate tensor(0.2164, dtype=torch.float64) tensor(-6.9279, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0451, dtype=torch.float64) delta_t tensor(-0.0846, dtype=torch.float64)
13 gae_duplicate tensor(-0.2853, dtype=torch.float64) tensor(1.0319, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5136, dtype=torch.float64) delta_t tensor(0.2984, dtype=torch.float64)
12 gae_duplicate tensor(0.0912, dtype=torch.float64) tensor(-5.7832, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0313, dtype=torch.float64) delta_t tensor(-0.0909, dtype=torch.float64)
11 gae_duplicate tensor(-0.3875, dtype=torch.float64) tensor(1.2545, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4642, dtype=torch.float64) delta_t tensor(0.2359, dtype=torch.float64)
10 gae_duplicate tensor(0.1187, dtype=torch.float64) tensor(-4.5321, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0242, dtype=torch.float64) delta_t tensor(0.0321, dtype=torch.float64)
9 gae_duplicate tensor(-0.1236, dtype=torch.float64) tensor(-1.0573, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4706, dtype=torch.float64) delta_t tensor(0.2605, dtype=torch.float64)
8 gae_duplicate tensor(0.1617, dtype=torch.float64) tensor(-5.2743, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0172, dtype=torch.float64) delta_t tensor(-0.0744, dtype=torch.float64)
7 gae_duplicate tensor(-0.2832, dtype=torch.float64) tensor(0.8864, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3836, dtype=torch.float64) delta_t tensor(0.2647, dtype=torch.float64)
6 gae_duplicate tensor(0.0717, dtype=torch.float64) tensor(-5.2229, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4491, dtype=torch.float64) delta_t tensor(-0.6623, dtype=torch.float64)
5 gae_duplicate tensor(-1.9948, dtype=torch.float64) tensor(12.5187, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6912, dtype=torch.float64) delta_t tensor(-1.7239, dtype=torch.float64)
4 gae_duplicate tensor(-3.6896, dtype=torch.float64) tensor(34.9240, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2298, dtype=torch.float64) delta_t tensor(-0.0173, dtype=torch.float64)
3 gae_duplicate tensor(-0.3403, dtype=torch.float64) tensor(3.9434, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2973, dtype=torch.float64) delta_t tensor(0.0223, dtype=torch.float64)
2 gae_duplicate tensor(-0.1997, dtype=torch.float64) tensor(-0.0407, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:221.90997314453125
value loss:70.66929626464844
entropies:355.6471252441406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.980733871459961 seconds
19 rew tensor(0.3538, dtype=torch.float64) delta_t tensor(0.2712, dtype=torch.float64)
19 gae_duplicate tensor(0.0340, dtype=torch.float64) tensor(-5.3704, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3978, dtype=torch.float64) delta_t tensor(0.3189, dtype=torch.float64)
18 gae_duplicate tensor(0.2232, dtype=torch.float64) tensor(-6.7729, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3292, dtype=torch.float64) delta_t tensor(0.1494, dtype=torch.float64)
17 gae_duplicate tensor(-0.0260, dtype=torch.float64) tensor(-3.5933, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4327, dtype=torch.float64) delta_t tensor(0.2132, dtype=torch.float64)
16 gae_duplicate tensor(0.1026, dtype=torch.float64) tensor(-4.5986, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2059, dtype=torch.float64) delta_t tensor(0.1639, dtype=torch.float64)
15 gae_duplicate tensor(0.0472, dtype=torch.float64) tensor(-3.7179, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4469, dtype=torch.float64) delta_t tensor(0.2906, dtype=torch.float64)
14 gae_duplicate tensor(0.2327, dtype=torch.float64) tensor(-6.1926, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2394, dtype=torch.float64) delta_t tensor(0.1815, dtype=torch.float64)
13 gae_duplicate tensor(-0.0901, dtype=torch.float64) tensor(-4.1919, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4481, dtype=torch.float64) delta_t tensor(0.2557, dtype=torch.float64)
12 gae_duplicate tensor(0.0481, dtype=torch.float64) tensor(-5.5225, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2351, dtype=torch.float64) delta_t tensor(0.1205, dtype=torch.float64)
11 gae_duplicate tensor(-0.3172, dtype=torch.float64) tensor(-2.8798, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4300, dtype=torch.float64) delta_t tensor(0.2198, dtype=torch.float64)
10 gae_duplicate tensor(0.1673, dtype=torch.float64) tensor(-4.6526, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2183, dtype=torch.float64) delta_t tensor(0.2463, dtype=torch.float64)
9 gae_duplicate tensor(0.0809, dtype=torch.float64) tensor(-5.2897, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4061, dtype=torch.float64) delta_t tensor(0.2541, dtype=torch.float64)
8 gae_duplicate tensor(0.2207, dtype=torch.float64) tensor(-5.5601, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2008, dtype=torch.float64) delta_t tensor(0.1217, dtype=torch.float64)
7 gae_duplicate tensor(-0.1131, dtype=torch.float64) tensor(-2.9848, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3252, dtype=torch.float64) delta_t tensor(0.3061, dtype=torch.float64)
6 gae_duplicate tensor(0.2124, dtype=torch.float64) tensor(-6.3614, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0060, dtype=torch.float64) delta_t tensor(-0.1964, dtype=torch.float64)
5 gae_duplicate tensor(-0.5566, dtype=torch.float64) tensor(3.3213, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8442, dtype=torch.float64) delta_t tensor(-2.9465, dtype=torch.float64)
4 gae_duplicate tensor(-5.8266, dtype=torch.float64) tensor(58.0964, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1306, dtype=torch.float64) delta_t tensor(0.1073, dtype=torch.float64)
3 gae_duplicate tensor(-0.4460, dtype=torch.float64) tensor(3.7271, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3263, dtype=torch.float64) delta_t tensor(-0.0165, dtype=torch.float64)
2 gae_duplicate tensor(-0.1986, dtype=torch.float64) tensor(0.6980, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3.588071346282959
value loss:130.35968017578125
entropies:355.8294982910156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.106488943099976 seconds
19 rew tensor(0.4087, dtype=torch.float64) delta_t tensor(0.3040, dtype=torch.float64)
19 gae_duplicate tensor(-0.0667, dtype=torch.float64) tensor(-6.0126, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4879, dtype=torch.float64) delta_t tensor(0.3540, dtype=torch.float64)
18 gae_duplicate tensor(0.1176, dtype=torch.float64) tensor(-7.5986, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3161, dtype=torch.float64) delta_t tensor(0.1819, dtype=torch.float64)
17 gae_duplicate tensor(0.0010, dtype=torch.float64) tensor(-4.3525, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5053, dtype=torch.float64) delta_t tensor(0.2850, dtype=torch.float64)
16 gae_duplicate tensor(0.1806, dtype=torch.float64) tensor(-6.0794, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1411, dtype=torch.float64) delta_t tensor(0.0977, dtype=torch.float64)
15 gae_duplicate tensor(-0.1238, dtype=torch.float64) tensor(-2.5275, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5555, dtype=torch.float64) delta_t tensor(0.3053, dtype=torch.float64)
14 gae_duplicate tensor(0.2150, dtype=torch.float64) tensor(-6.2867, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0417, dtype=torch.float64) delta_t tensor(-0.0457, dtype=torch.float64)
13 gae_duplicate tensor(-0.1946, dtype=torch.float64) tensor(0.2713, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5476, dtype=torch.float64) delta_t tensor(0.2953, dtype=torch.float64)
12 gae_duplicate tensor(0.1838, dtype=torch.float64) tensor(-5.8141, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0354, dtype=torch.float64) delta_t tensor(-0.1263, dtype=torch.float64)
11 gae_duplicate tensor(-0.2604, dtype=torch.float64) tensor(1.9153, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5212, dtype=torch.float64) delta_t tensor(0.2445, dtype=torch.float64)
10 gae_duplicate tensor(0.1529, dtype=torch.float64) tensor(-4.6409, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0390, dtype=torch.float64) delta_t tensor(0.0800, dtype=torch.float64)
9 gae_duplicate tensor(-0.0661, dtype=torch.float64) tensor(-2.0445, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4722, dtype=torch.float64) delta_t tensor(0.2073, dtype=torch.float64)
8 gae_duplicate tensor(0.0656, dtype=torch.float64) tensor(-4.3018, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0369, dtype=torch.float64) delta_t tensor(-0.1449, dtype=torch.float64)
7 gae_duplicate tensor(-0.4205, dtype=torch.float64) tensor(2.4368, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4266, dtype=torch.float64) delta_t tensor(0.2883, dtype=torch.float64)
6 gae_duplicate tensor(0.1193, dtype=torch.float64) tensor(-5.4519, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2492, dtype=torch.float64) delta_t tensor(-0.2542, dtype=torch.float64)
5 gae_duplicate tensor(-0.5116, dtype=torch.float64) tensor(4.4727, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.5831, dtype=torch.float64) delta_t tensor(-4.6039, dtype=torch.float64)
4 gae_duplicate tensor(-6.6811, dtype=torch.float64) tensor(91.4366, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1447, dtype=torch.float64) delta_t tensor(0.1965, dtype=torch.float64)
3 gae_duplicate tensor(-0.4319, dtype=torch.float64) tensor(5.2531, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1583, dtype=torch.float64) delta_t tensor(0.1699, dtype=torch.float64)
2 gae_duplicate tensor(-0.2041, dtype=torch.float64) tensor(-2.8323, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2679.614501953125
value loss:235.28631591796875
entropies:355.94317626953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.700909852981567 seconds
19 rew tensor(0.3038, dtype=torch.float64) delta_t tensor(0.1618, dtype=torch.float64)
19 gae_duplicate tensor(-0.0830, dtype=torch.float64) tensor(-3.2001, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4616, dtype=torch.float64) delta_t tensor(0.2416, dtype=torch.float64)
18 gae_duplicate tensor(0.1804, dtype=torch.float64) tensor(-5.0789, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.1971, dtype=torch.float64) delta_t tensor(0.0474, dtype=torch.float64)
17 gae_duplicate tensor(-0.1009, dtype=torch.float64) tensor(-1.4424, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5109, dtype=torch.float64) delta_t tensor(0.2638, dtype=torch.float64)
16 gae_duplicate tensor(0.1181, dtype=torch.float64) tensor(-5.3582, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0755, dtype=torch.float64) delta_t tensor(0.0735, dtype=torch.float64)
15 gae_duplicate tensor(0.0170, dtype=torch.float64) tensor(-1.9826, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5451, dtype=torch.float64) delta_t tensor(0.3311, dtype=torch.float64)
14 gae_duplicate tensor(0.1738, dtype=torch.float64) tensor(-6.7247, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0379, dtype=torch.float64) delta_t tensor(-0.0279, dtype=torch.float64)
13 gae_duplicate tensor(-0.1727, dtype=torch.float64) tensor(-0.1269, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5250, dtype=torch.float64) delta_t tensor(0.3021, dtype=torch.float64)
12 gae_duplicate tensor(0.2016, dtype=torch.float64) tensor(-5.9710, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0035, dtype=torch.float64) delta_t tensor(-0.1379, dtype=torch.float64)
11 gae_duplicate tensor(-0.2087, dtype=torch.float64) tensor(2.1374, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5215, dtype=torch.float64) delta_t tensor(0.2321, dtype=torch.float64)
10 gae_duplicate tensor(0.1666, dtype=torch.float64) tensor(-4.4091, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0180, dtype=torch.float64) delta_t tensor(-0.0007, dtype=torch.float64)
9 gae_duplicate tensor(-0.1517, dtype=torch.float64) tensor(-0.4219, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5091, dtype=torch.float64) delta_t tensor(0.2958, dtype=torch.float64)
8 gae_duplicate tensor(0.1962, dtype=torch.float64) tensor(-5.8630, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0465, dtype=torch.float64) delta_t tensor(-0.1383, dtype=torch.float64)
7 gae_duplicate tensor(-0.4038, dtype=torch.float64) tensor(2.1241, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4238, dtype=torch.float64) delta_t tensor(0.3707, dtype=torch.float64)
6 gae_duplicate tensor(0.1863, dtype=torch.float64) tensor(-7.0817, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2155, dtype=torch.float64) delta_t tensor(-0.2849, dtype=torch.float64)
5 gae_duplicate tensor(-0.6106, dtype=torch.float64) tensor(4.8896, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.4083, dtype=torch.float64) delta_t tensor(-4.4310, dtype=torch.float64)
4 gae_duplicate tensor(-6.2211, dtype=torch.float64) tensor(87.5863, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0661, dtype=torch.float64) delta_t tensor(0.2703, dtype=torch.float64)
3 gae_duplicate tensor(-0.5559, dtype=torch.float64) tensor(3.4725, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2283, dtype=torch.float64) delta_t tensor(0.0987, dtype=torch.float64)
2 gae_duplicate tensor(-0.0377, dtype=torch.float64) tensor(-1.6083, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2846.91015625
value loss:226.66615295410156
entropies:355.8985595703125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3964.0171)
ToM Target loss= tensor(3528.7954)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.678555250167847 seconds
19 rew tensor(0.4506, dtype=torch.float64) delta_t tensor(0.3468, dtype=torch.float64)
19 gae_duplicate tensor(0.0025, dtype=torch.float64) tensor(-6.8141, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4776, dtype=torch.float64) delta_t tensor(0.3867, dtype=torch.float64)
18 gae_duplicate tensor(0.2339, dtype=torch.float64) tensor(-8.2977, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4233, dtype=torch.float64) delta_t tensor(0.2711, dtype=torch.float64)
17 gae_duplicate tensor(0.0625, dtype=torch.float64) tensor(-6.2772, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4567, dtype=torch.float64) delta_t tensor(0.2655, dtype=torch.float64)
16 gae_duplicate tensor(0.1859, dtype=torch.float64) tensor(-5.8448, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2835, dtype=torch.float64) delta_t tensor(0.2361, dtype=torch.float64)
15 gae_duplicate tensor(0.1037, dtype=torch.float64) tensor(-5.2998, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4666, dtype=torch.float64) delta_t tensor(0.2657, dtype=torch.float64)
14 gae_duplicate tensor(0.2375, dtype=torch.float64) tensor(-5.7558, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2428, dtype=torch.float64) delta_t tensor(0.2469, dtype=torch.float64)
13 gae_duplicate tensor(-0.0944, dtype=torch.float64) tensor(-5.4313, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4633, dtype=torch.float64) delta_t tensor(0.2953, dtype=torch.float64)
12 gae_duplicate tensor(0.1084, dtype=torch.float64) tensor(-6.3923, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2380, dtype=torch.float64) delta_t tensor(0.1803, dtype=torch.float64)
11 gae_duplicate tensor(-0.1908, dtype=torch.float64) tensor(-4.2271, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4514, dtype=torch.float64) delta_t tensor(0.2329, dtype=torch.float64)
10 gae_duplicate tensor(0.1374, dtype=torch.float64) tensor(-4.9791, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1748, dtype=torch.float64) delta_t tensor(0.1110, dtype=torch.float64)
9 gae_duplicate tensor(-0.1734, dtype=torch.float64) tensor(-2.6498, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4422, dtype=torch.float64) delta_t tensor(0.2678, dtype=torch.float64)
8 gae_duplicate tensor(0.1790, dtype=torch.float64) tensor(-5.5648, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1541, dtype=torch.float64) delta_t tensor(0.0261, dtype=torch.float64)
7 gae_duplicate tensor(-0.5688, dtype=torch.float64) tensor(-1.0621, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3585, dtype=torch.float64) delta_t tensor(0.3137, dtype=torch.float64)
6 gae_duplicate tensor(0.1295, dtype=torch.float64) tensor(-6.3700, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0900, dtype=torch.float64) delta_t tensor(-0.0612, dtype=torch.float64)
5 gae_duplicate tensor(-0.4693, dtype=torch.float64) tensor(0.5395, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0445, dtype=torch.float64) delta_t tensor(-4.0727, dtype=torch.float64)
4 gae_duplicate tensor(-7.0278, dtype=torch.float64) tensor(80.5887, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0121, dtype=torch.float64) delta_t tensor(0.3626, dtype=torch.float64)
3 gae_duplicate tensor(-0.3286, dtype=torch.float64) tensor(0.9161, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2125, dtype=torch.float64) delta_t tensor(0.1869, dtype=torch.float64)
2 gae_duplicate tensor(0.0141, dtype=torch.float64) tensor(-3.5900, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-284.43438720703125
value loss:203.3477020263672
entropies:355.77178955078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.040006875991821 seconds
19 rew tensor(0.4506, dtype=torch.float64) delta_t tensor(0.3746, dtype=torch.float64)
19 gae_duplicate tensor(-0.1570, dtype=torch.float64) tensor(-7.4466, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4934, dtype=torch.float64) delta_t tensor(0.3949, dtype=torch.float64)
18 gae_duplicate tensor(0.1654, dtype=torch.float64) tensor(-8.3167, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4119, dtype=torch.float64) delta_t tensor(0.4283, dtype=torch.float64)
17 gae_duplicate tensor(-0.0626, dtype=torch.float64) tensor(-9.3557, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5500, dtype=torch.float64) delta_t tensor(0.3936, dtype=torch.float64)
16 gae_duplicate tensor(0.2127, dtype=torch.float64) tensor(-8.7065, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2282, dtype=torch.float64) delta_t tensor(0.2036, dtype=torch.float64)
15 gae_duplicate tensor(-0.0522, dtype=torch.float64) tensor(-4.7792, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5217, dtype=torch.float64) delta_t tensor(0.2903, dtype=torch.float64)
14 gae_duplicate tensor(0.2312, dtype=torch.float64) tensor(-6.4042, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0326, dtype=torch.float64) delta_t tensor(-0.1117, dtype=torch.float64)
13 gae_duplicate tensor(-0.1654, dtype=torch.float64) tensor(1.5882, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5431, dtype=torch.float64) delta_t tensor(0.3582, dtype=torch.float64)
12 gae_duplicate tensor(0.2250, dtype=torch.float64) tensor(-6.9348, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0571, dtype=torch.float64) delta_t tensor(-0.2123, dtype=torch.float64)
11 gae_duplicate tensor(-0.2788, dtype=torch.float64) tensor(3.4648, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5095, dtype=torch.float64) delta_t tensor(0.2377, dtype=torch.float64)
10 gae_duplicate tensor(0.1700, dtype=torch.float64) tensor(-4.3404, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2303, dtype=torch.float64) delta_t tensor(-0.1887, dtype=torch.float64)
9 gae_duplicate tensor(-0.9469, dtype=torch.float64) tensor(3.2960, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4754, dtype=torch.float64) delta_t tensor(0.2096, dtype=torch.float64)
8 gae_duplicate tensor(0.1056, dtype=torch.float64) tensor(-3.8028, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1089, dtype=torch.float64) delta_t tensor(-0.2696, dtype=torch.float64)
7 gae_duplicate tensor(-0.4582, dtype=torch.float64) tensor(5.0193, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3686, dtype=torch.float64) delta_t tensor(0.2977, dtype=torch.float64)
6 gae_duplicate tensor(0.1008, dtype=torch.float64) tensor(-5.3423, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3549, dtype=torch.float64) delta_t tensor(-0.2554, dtype=torch.float64)
5 gae_duplicate tensor(-0.4478, dtype=torch.float64) tensor(4.5776, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.1597, dtype=torch.float64) delta_t tensor(-3.9781, dtype=torch.float64)
4 gae_duplicate tensor(-5.6393, dtype=torch.float64) tensor(79.3931, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0465, dtype=torch.float64) delta_t tensor(0.3896, dtype=torch.float64)
3 gae_duplicate tensor(-0.1278, dtype=torch.float64) tensor(0.2794, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0532, dtype=torch.float64) delta_t tensor(0.3984, dtype=torch.float64)
2 gae_duplicate tensor(0.0525, dtype=torch.float64) tensor(-7.5769, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1425.06884765625
value loss:207.38864135742188
entropies:355.5574035644531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.657371282577515 seconds
19 rew tensor(0.4688, dtype=torch.float64) delta_t tensor(0.3282, dtype=torch.float64)
19 gae_duplicate tensor(0.0488, dtype=torch.float64) tensor(-6.4118, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4141, dtype=torch.float64) delta_t tensor(0.2552, dtype=torch.float64)
18 gae_duplicate tensor(0.1665, dtype=torch.float64) tensor(-5.6951, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4540, dtype=torch.float64) delta_t tensor(0.2706, dtype=torch.float64)
17 gae_duplicate tensor(0.0128, dtype=torch.float64) tensor(-5.9515, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3870, dtype=torch.float64) delta_t tensor(0.1849, dtype=torch.float64)
16 gae_duplicate tensor(0.0527, dtype=torch.float64) tensor(-4.1705, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2925, dtype=torch.float64) delta_t tensor(0.1723, dtype=torch.float64)
15 gae_duplicate tensor(0.0026, dtype=torch.float64) tensor(-3.9012, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4216, dtype=torch.float64) delta_t tensor(0.2633, dtype=torch.float64)
14 gae_duplicate tensor(0.2025, dtype=torch.float64) tensor(-5.4421, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2197, dtype=torch.float64) delta_t tensor(0.0800, dtype=torch.float64)
13 gae_duplicate tensor(-0.0517, dtype=torch.float64) tensor(-2.0098, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4289, dtype=torch.float64) delta_t tensor(0.2053, dtype=torch.float64)
12 gae_duplicate tensor(0.0517, dtype=torch.float64) tensor(-4.1804, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2019, dtype=torch.float64) delta_t tensor(0.1150, dtype=torch.float64)
11 gae_duplicate tensor(-0.1097, dtype=torch.float64) tensor(-2.8244, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4157, dtype=torch.float64) delta_t tensor(0.2198, dtype=torch.float64)
10 gae_duplicate tensor(0.1856, dtype=torch.float64) tensor(-4.5715, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1883, dtype=torch.float64) delta_t tensor(0.1709, dtype=torch.float64)
9 gae_duplicate tensor(-0.0787, dtype=torch.float64) tensor(-3.8600, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3708, dtype=torch.float64) delta_t tensor(0.2126, dtype=torch.float64)
8 gae_duplicate tensor(0.0771, dtype=torch.float64) tensor(-4.5679, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1445, dtype=torch.float64) delta_t tensor(0.0587, dtype=torch.float64)
7 gae_duplicate tensor(-0.2126, dtype=torch.float64) tensor(-1.4852, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2425, dtype=torch.float64) delta_t tensor(0.2590, dtype=torch.float64)
6 gae_duplicate tensor(0.1471, dtype=torch.float64) tensor(-5.3952, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1501, dtype=torch.float64) delta_t tensor(-0.0410, dtype=torch.float64)
5 gae_duplicate tensor(-0.4906, dtype=torch.float64) tensor(0.2555, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.2807, dtype=torch.float64) delta_t tensor(-4.2110, dtype=torch.float64)
4 gae_duplicate tensor(-6.3113, dtype=torch.float64) tensor(84.9163, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0111, dtype=torch.float64) delta_t tensor(0.4149, dtype=torch.float64)
3 gae_duplicate tensor(-0.5242, dtype=torch.float64) tensor(0.0541, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1498, dtype=torch.float64) delta_t tensor(0.3738, dtype=torch.float64)
2 gae_duplicate tensor(0.1063, dtype=torch.float64) tensor(-7.4100, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1032.7652587890625
value loss:218.81761169433594
entropies:355.18572998046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.811638116836548 seconds
19 rew tensor(0.4298, dtype=torch.float64) delta_t tensor(0.3776, dtype=torch.float64)
19 gae_duplicate tensor(-0.1076, dtype=torch.float64) tensor(-7.1316, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4105, dtype=torch.float64) delta_t tensor(0.3427, dtype=torch.float64)
18 gae_duplicate tensor(0.2529, dtype=torch.float64) tensor(-7.3750, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3727, dtype=torch.float64) delta_t tensor(0.2331, dtype=torch.float64)
17 gae_duplicate tensor(-0.0362, dtype=torch.float64) tensor(-5.2304, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4592, dtype=torch.float64) delta_t tensor(0.2257, dtype=torch.float64)
16 gae_duplicate tensor(0.0884, dtype=torch.float64) tensor(-5.0838, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1010, dtype=torch.float64) delta_t tensor(0.0410, dtype=torch.float64)
15 gae_duplicate tensor(-0.1910, dtype=torch.float64) tensor(-1.3875, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4951, dtype=torch.float64) delta_t tensor(0.3253, dtype=torch.float64)
14 gae_duplicate tensor(0.2295, dtype=torch.float64) tensor(-6.5557, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0629, dtype=torch.float64) delta_t tensor(-0.0318, dtype=torch.float64)
13 gae_duplicate tensor(-0.2041, dtype=torch.float64) tensor(0.0508, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4955, dtype=torch.float64) delta_t tensor(0.3110, dtype=torch.float64)
12 gae_duplicate tensor(0.0812, dtype=torch.float64) tensor(-5.9978, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0513, dtype=torch.float64) delta_t tensor(0.0191, dtype=torch.float64)
11 gae_duplicate tensor(-0.1967, dtype=torch.float64) tensor(-0.9627, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4275, dtype=torch.float64) delta_t tensor(0.2152, dtype=torch.float64)
10 gae_duplicate tensor(0.1357, dtype=torch.float64) tensor(-4.2658, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0097, dtype=torch.float64) delta_t tensor(0.0306, dtype=torch.float64)
9 gae_duplicate tensor(-0.1905, dtype=torch.float64) tensor(-1.1087, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4537, dtype=torch.float64) delta_t tensor(0.2723, dtype=torch.float64)
8 gae_duplicate tensor(0.2012, dtype=torch.float64) tensor(-5.3926, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0408, dtype=torch.float64) delta_t tensor(-0.0734, dtype=torch.float64)
7 gae_duplicate tensor(-0.2342, dtype=torch.float64) tensor(0.8809, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3759, dtype=torch.float64) delta_t tensor(0.3329, dtype=torch.float64)
6 gae_duplicate tensor(0.2143, dtype=torch.float64) tensor(-6.3056, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2210, dtype=torch.float64) delta_t tensor(-0.2222, dtype=torch.float64)
5 gae_duplicate tensor(-0.8203, dtype=torch.float64) tensor(3.8294, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6090, dtype=torch.float64) delta_t tensor(-1.5016, dtype=torch.float64)
4 gae_duplicate tensor(-3.2172, dtype=torch.float64) tensor(31.3008, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1821, dtype=torch.float64) delta_t tensor(0.2464, dtype=torch.float64)
3 gae_duplicate tensor(-0.1496, dtype=torch.float64) tensor(-1.9152, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2561, dtype=torch.float64) delta_t tensor(0.2237, dtype=torch.float64)
2 gae_duplicate tensor(-0.2306, dtype=torch.float64) tensor(-4.6126, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1376.462890625
value loss:56.513404846191406
entropies:354.61810302734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.795932054519653 seconds
19 rew tensor(0.4287, dtype=torch.float64) delta_t tensor(0.2394, dtype=torch.float64)
19 gae_duplicate tensor(-0.0229, dtype=torch.float64) tensor(-4.6522, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4203, dtype=torch.float64) delta_t tensor(0.2818, dtype=torch.float64)
18 gae_duplicate tensor(0.2031, dtype=torch.float64) tensor(-6.1637, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3978, dtype=torch.float64) delta_t tensor(0.3362, dtype=torch.float64)
17 gae_duplicate tensor(0.0326, dtype=torch.float64) tensor(-7.4032, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4125, dtype=torch.float64) delta_t tensor(0.2038, dtype=torch.float64)
16 gae_duplicate tensor(0.0658, dtype=torch.float64) tensor(-4.6373, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2606, dtype=torch.float64) delta_t tensor(0.1643, dtype=torch.float64)
15 gae_duplicate tensor(-0.0425, dtype=torch.float64) tensor(-3.7438, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2974, dtype=torch.float64) delta_t tensor(0.1325, dtype=torch.float64)
14 gae_duplicate tensor(-0.6439, dtype=torch.float64) tensor(-2.9072, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2205, dtype=torch.float64) delta_t tensor(0.1386, dtype=torch.float64)
13 gae_duplicate tensor(-0.0441, dtype=torch.float64) tensor(-2.8433, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4628, dtype=torch.float64) delta_t tensor(0.2790, dtype=torch.float64)
12 gae_duplicate tensor(0.0567, dtype=torch.float64) tensor(-5.8070, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2217, dtype=torch.float64) delta_t tensor(0.1587, dtype=torch.float64)
11 gae_duplicate tensor(-0.0946, dtype=torch.float64) tensor(-3.6035, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4355, dtype=torch.float64) delta_t tensor(0.2567, dtype=torch.float64)
10 gae_duplicate tensor(0.2260, dtype=torch.float64) tensor(-5.2656, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2741, dtype=torch.float64) delta_t tensor(-0.2924, dtype=torch.float64)
9 gae_duplicate tensor(-2.8102, dtype=torch.float64) tensor(6.0038, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2639, dtype=torch.float64) delta_t tensor(0.1106, dtype=torch.float64)
8 gae_duplicate tensor(-0.9070, dtype=torch.float64) tensor(-1.5772, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1805, dtype=torch.float64) delta_t tensor(0.0354, dtype=torch.float64)
7 gae_duplicate tensor(-0.3112, dtype=torch.float64) tensor(-0.5493, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3439, dtype=torch.float64) delta_t tensor(0.3400, dtype=torch.float64)
6 gae_duplicate tensor(0.2662, dtype=torch.float64) tensor(-6.7441, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0406, dtype=torch.float64) delta_t tensor(0.1851, dtype=torch.float64)
5 gae_duplicate tensor(0.1074, dtype=torch.float64) tensor(-4.5523, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6543, dtype=torch.float64) delta_t tensor(-2.5318, dtype=torch.float64)
4 gae_duplicate tensor(-6.1799, dtype=torch.float64) tensor(51.4754, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0035, dtype=torch.float64) delta_t tensor(0.5069, dtype=torch.float64)
3 gae_duplicate tensor(-0.1477, dtype=torch.float64) tensor(-5.0690, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1752, dtype=torch.float64) delta_t tensor(0.3320, dtype=torch.float64)
2 gae_duplicate tensor(0.1524, dtype=torch.float64) tensor(-7.0366, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:718.5784301757812
value loss:130.40432739257812
entropies:353.7891845703125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3978.0994)
ToM Target loss= tensor(3510.9175)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.536221981048584 seconds
19 rew tensor(0.4811, dtype=torch.float64) delta_t tensor(0.4077, dtype=torch.float64)
19 gae_duplicate tensor(0.2645, dtype=torch.float64) tensor(-8.0075, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2936, dtype=torch.float64) delta_t tensor(0.1760, dtype=torch.float64)
18 gae_duplicate tensor(-0.0602, dtype=torch.float64) tensor(-4.4122, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4008, dtype=torch.float64) delta_t tensor(0.2952, dtype=torch.float64)
17 gae_duplicate tensor(0.1979, dtype=torch.float64) tensor(-6.4125, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.1596, dtype=torch.float64) delta_t tensor(0.0172, dtype=torch.float64)
16 gae_duplicate tensor(-0.4768, dtype=torch.float64) tensor(-1.1739, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2242, dtype=torch.float64) delta_t tensor(0.1435, dtype=torch.float64)
15 gae_duplicate tensor(-0.0295, dtype=torch.float64) tensor(-2.8136, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3746, dtype=torch.float64) delta_t tensor(0.1873, dtype=torch.float64)
14 gae_duplicate tensor(-0.0398, dtype=torch.float64) tensor(-3.9690, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1474, dtype=torch.float64) delta_t tensor(0.1457, dtype=torch.float64)
13 gae_duplicate tensor(-0.0748, dtype=torch.float64) tensor(-3.2900, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3815, dtype=torch.float64) delta_t tensor(0.2052, dtype=torch.float64)
12 gae_duplicate tensor(-0.1006, dtype=torch.float64) tensor(-4.2515, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1548, dtype=torch.float64) delta_t tensor(0.0671, dtype=torch.float64)
11 gae_duplicate tensor(-0.1782, dtype=torch.float64) tensor(-1.8161, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3611, dtype=torch.float64) delta_t tensor(0.1960, dtype=torch.float64)
10 gae_duplicate tensor(-0.1063, dtype=torch.float64) tensor(-3.9276, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1200, dtype=torch.float64) delta_t tensor(0.1808, dtype=torch.float64)
9 gae_duplicate tensor(-0.0670, dtype=torch.float64) tensor(-4.0885, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3402, dtype=torch.float64) delta_t tensor(0.2753, dtype=torch.float64)
8 gae_duplicate tensor(0.1425, dtype=torch.float64) tensor(-5.6530, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1144, dtype=torch.float64) delta_t tensor(-0.0013, dtype=torch.float64)
7 gae_duplicate tensor(-0.3555, dtype=torch.float64) tensor(-0.7808, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4285, dtype=torch.float64) delta_t tensor(-0.3463, dtype=torch.float64)
6 gae_duplicate tensor(-3.7771, dtype=torch.float64) tensor(8.4408, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1102, dtype=torch.float64) delta_t tensor(-0.0213, dtype=torch.float64)
5 gae_duplicate tensor(-0.4386, dtype=torch.float64) tensor(1.0695, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8184, dtype=torch.float64) delta_t tensor(-2.7239, dtype=torch.float64)
4 gae_duplicate tensor(-7.0483, dtype=torch.float64) tensor(55.1671, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0585, dtype=torch.float64) delta_t tensor(0.3795, dtype=torch.float64)
3 gae_duplicate tensor(-0.3034, dtype=torch.float64) tensor(-2.3422, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3407, dtype=torch.float64) delta_t tensor(0.2028, dtype=torch.float64)
2 gae_duplicate tensor(-0.0335, dtype=torch.float64) tensor(-4.2357, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-500.4107971191406
value loss:159.9593505859375
entropies:352.7180480957031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.026098728179932 seconds
19 rew tensor(0.3711, dtype=torch.float64) delta_t tensor(0.2894, dtype=torch.float64)
19 gae_duplicate tensor(-0.0081, dtype=torch.float64) tensor(-5.3001, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4771, dtype=torch.float64) delta_t tensor(0.2876, dtype=torch.float64)
18 gae_duplicate tensor(0.1389, dtype=torch.float64) tensor(-6.2540, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3526, dtype=torch.float64) delta_t tensor(0.2457, dtype=torch.float64)
17 gae_duplicate tensor(0.0426, dtype=torch.float64) tensor(-5.9848, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4812, dtype=torch.float64) delta_t tensor(0.2913, dtype=torch.float64)
16 gae_duplicate tensor(0.1518, dtype=torch.float64) tensor(-6.1963, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1902, dtype=torch.float64) delta_t tensor(0.1374, dtype=torch.float64)
15 gae_duplicate tensor(-0.0521, dtype=torch.float64) tensor(-3.1342, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4679, dtype=torch.float64) delta_t tensor(0.3175, dtype=torch.float64)
14 gae_duplicate tensor(0.2846, dtype=torch.float64) tensor(-6.5203, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1528, dtype=torch.float64) delta_t tensor(0.1164, dtype=torch.float64)
13 gae_duplicate tensor(0.0423, dtype=torch.float64) tensor(-3.1333, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5014, dtype=torch.float64) delta_t tensor(0.3396, dtype=torch.float64)
12 gae_duplicate tensor(0.1046, dtype=torch.float64) tensor(-7.0543, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1409, dtype=torch.float64) delta_t tensor(0.0344, dtype=torch.float64)
11 gae_duplicate tensor(-0.1166, dtype=torch.float64) tensor(-1.3470, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4964, dtype=torch.float64) delta_t tensor(0.2877, dtype=torch.float64)
10 gae_duplicate tensor(0.2520, dtype=torch.float64) tensor(-5.7534, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0286, dtype=torch.float64) delta_t tensor(-0.0869, dtype=torch.float64)
9 gae_duplicate tensor(-0.6569, dtype=torch.float64) tensor(0.8515, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4546, dtype=torch.float64) delta_t tensor(0.2718, dtype=torch.float64)
8 gae_duplicate tensor(0.1751, dtype=torch.float64) tensor(-5.0429, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0609, dtype=torch.float64) delta_t tensor(-0.0568, dtype=torch.float64)
7 gae_duplicate tensor(-0.3211, dtype=torch.float64) tensor(0.3032, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3445, dtype=torch.float64) delta_t tensor(0.3529, dtype=torch.float64)
6 gae_duplicate tensor(0.1722, dtype=torch.float64) tensor(-6.8548, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1989, dtype=torch.float64) delta_t tensor(-0.0978, dtype=torch.float64)
5 gae_duplicate tensor(-0.3898, dtype=torch.float64) tensor(1.1100, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1312, dtype=torch.float64) delta_t tensor(-2.8579, dtype=torch.float64)
4 gae_duplicate tensor(-5.3687, dtype=torch.float64) tensor(60.6091, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1061, dtype=torch.float64) delta_t tensor(0.4169, dtype=torch.float64)
3 gae_duplicate tensor(-0.2517, dtype=torch.float64) tensor(-2.5501, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2387, dtype=torch.float64) delta_t tensor(0.3074, dtype=torch.float64)
2 gae_duplicate tensor(-0.0498, dtype=torch.float64) tensor(-5.6674, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:332.7601318359375
value loss:138.3931884765625
entropies:351.3574523925781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.595232963562012 seconds
19 rew tensor(0.4679, dtype=torch.float64) delta_t tensor(0.2651, dtype=torch.float64)
19 gae_duplicate tensor(0.0527, dtype=torch.float64) tensor(-5.5648, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3525, dtype=torch.float64) delta_t tensor(0.1694, dtype=torch.float64)
18 gae_duplicate tensor(0.1506, dtype=torch.float64) tensor(-3.8140, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3372, dtype=torch.float64) delta_t tensor(0.1997, dtype=torch.float64)
17 gae_duplicate tensor(0.0623, dtype=torch.float64) tensor(-4.5959, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4782, dtype=torch.float64) delta_t tensor(0.2345, dtype=torch.float64)
16 gae_duplicate tensor(0.1118, dtype=torch.float64) tensor(-4.7408, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1712, dtype=torch.float64) delta_t tensor(0.0410, dtype=torch.float64)
15 gae_duplicate tensor(-0.0483, dtype=torch.float64) tensor(-1.2430, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3086, dtype=torch.float64) delta_t tensor(0.1731, dtype=torch.float64)
14 gae_duplicate tensor(-0.6357, dtype=torch.float64) tensor(-3.1868, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1878, dtype=torch.float64) delta_t tensor(0.0346, dtype=torch.float64)
13 gae_duplicate tensor(-0.0923, dtype=torch.float64) tensor(-0.9152, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4856, dtype=torch.float64) delta_t tensor(0.2790, dtype=torch.float64)
12 gae_duplicate tensor(0.1235, dtype=torch.float64) tensor(-5.4767, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1692, dtype=torch.float64) delta_t tensor(0.0545, dtype=torch.float64)
11 gae_duplicate tensor(-0.1015, dtype=torch.float64) tensor(-1.5772, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4664, dtype=torch.float64) delta_t tensor(0.2609, dtype=torch.float64)
10 gae_duplicate tensor(0.2340, dtype=torch.float64) tensor(-5.0071, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0140, dtype=torch.float64) delta_t tensor(-0.0853, dtype=torch.float64)
9 gae_duplicate tensor(-0.9247, dtype=torch.float64) tensor(0.6627, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4443, dtype=torch.float64) delta_t tensor(0.2534, dtype=torch.float64)
8 gae_duplicate tensor(0.2161, dtype=torch.float64) tensor(-4.9909, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1487, dtype=torch.float64) delta_t tensor(0.0478, dtype=torch.float64)
7 gae_duplicate tensor(-0.1443, dtype=torch.float64) tensor(-1.5672, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3673, dtype=torch.float64) delta_t tensor(0.3402, dtype=torch.float64)
6 gae_duplicate tensor(0.2402, dtype=torch.float64) tensor(-6.6441, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0339, dtype=torch.float64) delta_t tensor(0.0361, dtype=torch.float64)
5 gae_duplicate tensor(-0.2544, dtype=torch.float64) tensor(-1.6637, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6550, dtype=torch.float64) delta_t tensor(-3.3832, dtype=torch.float64)
4 gae_duplicate tensor(-6.4242, dtype=torch.float64) tensor(63.7440, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1164, dtype=torch.float64) delta_t tensor(0.4445, dtype=torch.float64)
3 gae_duplicate tensor(-0.1242, dtype=torch.float64) tensor(-2.0507, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1897, dtype=torch.float64) delta_t tensor(0.3521, dtype=torch.float64)
2 gae_duplicate tensor(0.1928, dtype=torch.float64) tensor(-7.4021, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-308.6036376953125
value loss:173.33197021484375
entropies:349.6793212890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.074721097946167 seconds
19 rew tensor(0.3256, dtype=torch.float64) delta_t tensor(0.3149, dtype=torch.float64)
19 gae_duplicate tensor(-0.1628, dtype=torch.float64) tensor(-5.5168, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4159, dtype=torch.float64) delta_t tensor(0.2304, dtype=torch.float64)
18 gae_duplicate tensor(0.0571, dtype=torch.float64) tensor(-4.9338, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2633, dtype=torch.float64) delta_t tensor(0.2163, dtype=torch.float64)
17 gae_duplicate tensor(-0.0860, dtype=torch.float64) tensor(-4.9654, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4781, dtype=torch.float64) delta_t tensor(0.2599, dtype=torch.float64)
16 gae_duplicate tensor(0.1381, dtype=torch.float64) tensor(-5.4743, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1024, dtype=torch.float64) delta_t tensor(-0.0399, dtype=torch.float64)
15 gae_duplicate tensor(-0.1789, dtype=torch.float64) tensor(0.0858, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4734, dtype=torch.float64) delta_t tensor(0.2959, dtype=torch.float64)
14 gae_duplicate tensor(0.1662, dtype=torch.float64) tensor(-5.5636, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1100, dtype=torch.float64) delta_t tensor(0.0580, dtype=torch.float64)
13 gae_duplicate tensor(-0.1236, dtype=torch.float64) tensor(-1.7029, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4870, dtype=torch.float64) delta_t tensor(0.3020, dtype=torch.float64)
12 gae_duplicate tensor(0.0734, dtype=torch.float64) tensor(-5.6310, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0976, dtype=torch.float64) delta_t tensor(-0.0033, dtype=torch.float64)
11 gae_duplicate tensor(-0.1143, dtype=torch.float64) tensor(-0.6874, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4593, dtype=torch.float64) delta_t tensor(0.2528, dtype=torch.float64)
10 gae_duplicate tensor(0.2112, dtype=torch.float64) tensor(-5.1730, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0907, dtype=torch.float64) delta_t tensor(0.0965, dtype=torch.float64)
9 gae_duplicate tensor(-0.0763, dtype=torch.float64) tensor(-2.4795, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4450, dtype=torch.float64) delta_t tensor(0.2625, dtype=torch.float64)
8 gae_duplicate tensor(0.2068, dtype=torch.float64) tensor(-5.4435, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0704, dtype=torch.float64) delta_t tensor(0.0025, dtype=torch.float64)
7 gae_duplicate tensor(-0.1931, dtype=torch.float64) tensor(-0.4549, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3668, dtype=torch.float64) delta_t tensor(0.3735, dtype=torch.float64)
6 gae_duplicate tensor(0.2521, dtype=torch.float64) tensor(-7.5816, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1153, dtype=torch.float64) delta_t tensor(-0.0595, dtype=torch.float64)
5 gae_duplicate tensor(-0.3304, dtype=torch.float64) tensor(0.1379, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7500, dtype=torch.float64) delta_t tensor(-1.5235, dtype=torch.float64)
4 gae_duplicate tensor(-3.4351, dtype=torch.float64) tensor(27.9157, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1433, dtype=torch.float64) delta_t tensor(0.4282, dtype=torch.float64)
3 gae_duplicate tensor(0.0007, dtype=torch.float64) tensor(-5.3557, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2755, dtype=torch.float64) delta_t tensor(0.2715, dtype=torch.float64)
2 gae_duplicate tensor(0.1507, dtype=torch.float64) tensor(-5.6695, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1984.6077880859375
value loss:52.59965515136719
entropies:348.2992248535156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.116365909576416 seconds
19 rew tensor(0.1605, dtype=torch.float64) delta_t tensor(0.0901, dtype=torch.float64)
19 gae_duplicate tensor(-0.5779, dtype=torch.float64) tensor(-2.2200, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4955, dtype=torch.float64) delta_t tensor(0.2765, dtype=torch.float64)
18 gae_duplicate tensor(0.1062, dtype=torch.float64) tensor(-5.6665, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2498, dtype=torch.float64) delta_t tensor(0.1493, dtype=torch.float64)
17 gae_duplicate tensor(-0.0572, dtype=torch.float64) tensor(-3.2878, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5441, dtype=torch.float64) delta_t tensor(0.3296, dtype=torch.float64)
16 gae_duplicate tensor(0.2389, dtype=torch.float64) tensor(-6.5864, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1967, dtype=torch.float64) delta_t tensor(0.0964, dtype=torch.float64)
15 gae_duplicate tensor(-0.1119, dtype=torch.float64) tensor(-2.3154, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5512, dtype=torch.float64) delta_t tensor(0.4277, dtype=torch.float64)
14 gae_duplicate tensor(0.2470, dtype=torch.float64) tensor(-8.2140, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1979, dtype=torch.float64) delta_t tensor(0.0548, dtype=torch.float64)
13 gae_duplicate tensor(-0.1311, dtype=torch.float64) tensor(-1.4968, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5450, dtype=torch.float64) delta_t tensor(0.3685, dtype=torch.float64)
12 gae_duplicate tensor(0.2504, dtype=torch.float64) tensor(-7.1041, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1777, dtype=torch.float64) delta_t tensor(0.0290, dtype=torch.float64)
11 gae_duplicate tensor(-0.1266, dtype=torch.float64) tensor(-0.8515, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5233, dtype=torch.float64) delta_t tensor(0.3142, dtype=torch.float64)
10 gae_duplicate tensor(0.2233, dtype=torch.float64) tensor(-6.4265, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1355, dtype=torch.float64) delta_t tensor(-0.2385, dtype=torch.float64)
9 gae_duplicate tensor(-1.2614, dtype=torch.float64) tensor(3.8523, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4464, dtype=torch.float64) delta_t tensor(-0.6417, dtype=torch.float64)
8 gae_duplicate tensor(-5.2635, dtype=torch.float64) tensor(10.0489, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0420, dtype=torch.float64) delta_t tensor(-0.1719, dtype=torch.float64)
7 gae_duplicate tensor(-1.0747, dtype=torch.float64) tensor(5.3260, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3681, dtype=torch.float64) delta_t tensor(0.3456, dtype=torch.float64)
6 gae_duplicate tensor(-0.0831, dtype=torch.float64) tensor(-5.9718, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1229, dtype=torch.float64) delta_t tensor(0.0261, dtype=torch.float64)
5 gae_duplicate tensor(-0.1821, dtype=torch.float64) tensor(-0.9863, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5918, dtype=torch.float64) delta_t tensor(-3.1861, dtype=torch.float64)
4 gae_duplicate tensor(-5.5487, dtype=torch.float64) tensor(62.1760, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1801, dtype=torch.float64) delta_t tensor(0.3734, dtype=torch.float64)
3 gae_duplicate tensor(-0.2156, dtype=torch.float64) tensor(-1.1493, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1081, dtype=torch.float64) delta_t tensor(0.3133, dtype=torch.float64)
2 gae_duplicate tensor(0.1029, dtype=torch.float64) tensor(-5.8977, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1348.14453125
value loss:192.4767608642578
entropies:347.2695007324219
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3971.3345)
ToM Target loss= tensor(3534.6631)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.9798431396484375 seconds
19 rew tensor(0.4372, dtype=torch.float64) delta_t tensor(0.2986, dtype=torch.float64)
19 gae_duplicate tensor(-0.0907, dtype=torch.float64) tensor(-6.0007, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4535, dtype=torch.float64) delta_t tensor(0.3127, dtype=torch.float64)
18 gae_duplicate tensor(0.1091, dtype=torch.float64) tensor(-6.1963, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3661, dtype=torch.float64) delta_t tensor(0.2247, dtype=torch.float64)
17 gae_duplicate tensor(-0.1517, dtype=torch.float64) tensor(-5.1360, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4905, dtype=torch.float64) delta_t tensor(0.3332, dtype=torch.float64)
16 gae_duplicate tensor(0.2347, dtype=torch.float64) tensor(-6.8515, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2712, dtype=torch.float64) delta_t tensor(0.1270, dtype=torch.float64)
15 gae_duplicate tensor(-0.1599, dtype=torch.float64) tensor(-3.5721, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5056, dtype=torch.float64) delta_t tensor(0.3075, dtype=torch.float64)
14 gae_duplicate tensor(0.2018, dtype=torch.float64) tensor(-6.5562, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2258, dtype=torch.float64) delta_t tensor(0.0946, dtype=torch.float64)
13 gae_duplicate tensor(-0.1778, dtype=torch.float64) tensor(-1.9803, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5130, dtype=torch.float64) delta_t tensor(0.3371, dtype=torch.float64)
12 gae_duplicate tensor(0.1496, dtype=torch.float64) tensor(-7.0156, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2203, dtype=torch.float64) delta_t tensor(0.0901, dtype=torch.float64)
11 gae_duplicate tensor(-0.2121, dtype=torch.float64) tensor(-2.6231, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4923, dtype=torch.float64) delta_t tensor(0.3250, dtype=torch.float64)
10 gae_duplicate tensor(0.2358, dtype=torch.float64) tensor(-6.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0767, dtype=torch.float64) delta_t tensor(-0.0862, dtype=torch.float64)
9 gae_duplicate tensor(-1.0522, dtype=torch.float64) tensor(0.8798, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3745, dtype=torch.float64) delta_t tensor(-0.4298, dtype=torch.float64)
8 gae_duplicate tensor(-4.1109, dtype=torch.float64) tensor(6.0252, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1414, dtype=torch.float64) delta_t tensor(-0.2231, dtype=torch.float64)
7 gae_duplicate tensor(-1.5947, dtype=torch.float64) tensor(5.6074, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3245, dtype=torch.float64) delta_t tensor(0.3630, dtype=torch.float64)
6 gae_duplicate tensor(0.1032, dtype=torch.float64) tensor(-6.5810, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2667, dtype=torch.float64) delta_t tensor(-0.0358, dtype=torch.float64)
5 gae_duplicate tensor(-1.1175, dtype=torch.float64) tensor(0.3914, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0865, dtype=torch.float64) delta_t tensor(-1.8918, dtype=torch.float64)
4 gae_duplicate tensor(-5.5867, dtype=torch.float64) tensor(36.9578, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2040, dtype=torch.float64) delta_t tensor(0.6189, dtype=torch.float64)
3 gae_duplicate tensor(0.1170, dtype=torch.float64) tensor(-8.3227, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3237, dtype=torch.float64) delta_t tensor(0.3271, dtype=torch.float64)
2 gae_duplicate tensor(-0.0526, dtype=torch.float64) tensor(-7.0262, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1209.345458984375
value loss:115.32445526123047
entropies:346.3885803222656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.948667764663696 seconds
19 rew tensor(0.3811, dtype=torch.float64) delta_t tensor(0.1640, dtype=torch.float64)
19 gae_duplicate tensor(-0.0088, dtype=torch.float64) tensor(-3.3320, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3911, dtype=torch.float64) delta_t tensor(0.1491, dtype=torch.float64)
18 gae_duplicate tensor(0.0541, dtype=torch.float64) tensor(-3.1206, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2745, dtype=torch.float64) delta_t tensor(0.1476, dtype=torch.float64)
17 gae_duplicate tensor(-0.0032, dtype=torch.float64) tensor(-3.1650, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4829, dtype=torch.float64) delta_t tensor(0.2667, dtype=torch.float64)
16 gae_duplicate tensor(0.0247, dtype=torch.float64) tensor(-6.2837, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1417, dtype=torch.float64) delta_t tensor(-0.0565, dtype=torch.float64)
15 gae_duplicate tensor(-0.2054, dtype=torch.float64) tensor(0.5188, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4795, dtype=torch.float64) delta_t tensor(0.3009, dtype=torch.float64)
14 gae_duplicate tensor(0.0306, dtype=torch.float64) tensor(-5.7260, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1491, dtype=torch.float64) delta_t tensor(0.0265, dtype=torch.float64)
13 gae_duplicate tensor(-0.0888, dtype=torch.float64) tensor(-1.0501, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4931, dtype=torch.float64) delta_t tensor(0.3058, dtype=torch.float64)
12 gae_duplicate tensor(0.0405, dtype=torch.float64) tensor(-5.7630, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1501, dtype=torch.float64) delta_t tensor(-0.0562, dtype=torch.float64)
11 gae_duplicate tensor(-0.1743, dtype=torch.float64) tensor(0.2185, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4841, dtype=torch.float64) delta_t tensor(0.2313, dtype=torch.float64)
10 gae_duplicate tensor(0.0199, dtype=torch.float64) tensor(-4.2838, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1379, dtype=torch.float64) delta_t tensor(0.0318, dtype=torch.float64)
9 gae_duplicate tensor(-0.1408, dtype=torch.float64) tensor(-0.9315, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4580, dtype=torch.float64) delta_t tensor(0.2578, dtype=torch.float64)
8 gae_duplicate tensor(0.1962, dtype=torch.float64) tensor(-5.5194, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1160, dtype=torch.float64) delta_t tensor(-0.0336, dtype=torch.float64)
7 gae_duplicate tensor(-0.2113, dtype=torch.float64) tensor(0.2452, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3733, dtype=torch.float64) delta_t tensor(0.3215, dtype=torch.float64)
6 gae_duplicate tensor(0.2364, dtype=torch.float64) tensor(-5.8263, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0662, dtype=torch.float64) delta_t tensor(0.0492, dtype=torch.float64)
5 gae_duplicate tensor(-0.3144, dtype=torch.float64) tensor(-1.3110, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.1461, dtype=torch.float64) delta_t tensor(-3.7487, dtype=torch.float64)
4 gae_duplicate tensor(-4.2093, dtype=torch.float64) tensor(71.3687, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1304, dtype=torch.float64) delta_t tensor(0.4742, dtype=torch.float64)
3 gae_duplicate tensor(-0.1826, dtype=torch.float64) tensor(-1.7398, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1962, dtype=torch.float64) delta_t tensor(0.4458, dtype=torch.float64)
2 gae_duplicate tensor(0.2395, dtype=torch.float64) tensor(-8.6193, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-940.0407104492188
value loss:138.75010681152344
entropies:345.7008361816406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.659825086593628 seconds
19 rew tensor(0.3909, dtype=torch.float64) delta_t tensor(0.2654, dtype=torch.float64)
19 gae_duplicate tensor(-0.0867, dtype=torch.float64) tensor(-5.2479, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4265, dtype=torch.float64) delta_t tensor(0.2620, dtype=torch.float64)
18 gae_duplicate tensor(0.0259, dtype=torch.float64) tensor(-5.7064, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3571, dtype=torch.float64) delta_t tensor(0.1558, dtype=torch.float64)
17 gae_duplicate tensor(-0.0509, dtype=torch.float64) tensor(-3.5892, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4780, dtype=torch.float64) delta_t tensor(0.2574, dtype=torch.float64)
16 gae_duplicate tensor(0.1731, dtype=torch.float64) tensor(-5.5930, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1017, dtype=torch.float64) delta_t tensor(-0.0093, dtype=torch.float64)
15 gae_duplicate tensor(-0.2538, dtype=torch.float64) tensor(-0.3915, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4929, dtype=torch.float64) delta_t tensor(0.3300, dtype=torch.float64)
14 gae_duplicate tensor(0.1639, dtype=torch.float64) tensor(-6.4458, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0732, dtype=torch.float64) delta_t tensor(0.0091, dtype=torch.float64)
13 gae_duplicate tensor(-0.2505, dtype=torch.float64) tensor(-0.7473, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4945, dtype=torch.float64) delta_t tensor(0.3051, dtype=torch.float64)
12 gae_duplicate tensor(0.1293, dtype=torch.float64) tensor(-5.7893, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0661, dtype=torch.float64) delta_t tensor(-0.0731, dtype=torch.float64)
11 gae_duplicate tensor(-0.3060, dtype=torch.float64) tensor(1.0382, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4721, dtype=torch.float64) delta_t tensor(0.2432, dtype=torch.float64)
10 gae_duplicate tensor(0.1839, dtype=torch.float64) tensor(-4.7523, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2757, dtype=torch.float64) delta_t tensor(-0.2790, dtype=torch.float64)
9 gae_duplicate tensor(-1.8494, dtype=torch.float64) tensor(6.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4586, dtype=torch.float64) delta_t tensor(0.2528, dtype=torch.float64)
8 gae_duplicate tensor(0.1087, dtype=torch.float64) tensor(-4.2381, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0071, dtype=torch.float64) delta_t tensor(-0.0708, dtype=torch.float64)
7 gae_duplicate tensor(-0.3664, dtype=torch.float64) tensor(0.5470, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3480, dtype=torch.float64) delta_t tensor(0.3675, dtype=torch.float64)
6 gae_duplicate tensor(0.2606, dtype=torch.float64) tensor(-7.0323, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2085, dtype=torch.float64) delta_t tensor(-0.1806, dtype=torch.float64)
5 gae_duplicate tensor(-0.4035, dtype=torch.float64) tensor(2.4198, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3228, dtype=torch.float64) delta_t tensor(-2.9325, dtype=torch.float64)
4 gae_duplicate tensor(-4.8894, dtype=torch.float64) tensor(57.8383, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1433, dtype=torch.float64) delta_t tensor(0.5230, dtype=torch.float64)
3 gae_duplicate tensor(0.0615, dtype=torch.float64) tensor(-4.6579, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2193, dtype=torch.float64) delta_t tensor(0.4213, dtype=torch.float64)
2 gae_duplicate tensor(0.2616, dtype=torch.float64) tensor(-9.0135, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-356.36773681640625
value loss:105.82670593261719
entropies:345.3218994140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.628554105758667 seconds
19 rew tensor(0.3687, dtype=torch.float64) delta_t tensor(0.2043, dtype=torch.float64)
19 gae_duplicate tensor(-0.0315, dtype=torch.float64) tensor(-4.2323, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4746, dtype=torch.float64) delta_t tensor(0.2316, dtype=torch.float64)
18 gae_duplicate tensor(0.0520, dtype=torch.float64) tensor(-4.9370, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3094, dtype=torch.float64) delta_t tensor(0.1325, dtype=torch.float64)
17 gae_duplicate tensor(-0.0098, dtype=torch.float64) tensor(-2.6068, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5497, dtype=torch.float64) delta_t tensor(0.2528, dtype=torch.float64)
16 gae_duplicate tensor(0.1754, dtype=torch.float64) tensor(-5.0838, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1729, dtype=torch.float64) delta_t tensor(0.0134, dtype=torch.float64)
15 gae_duplicate tensor(-0.2199, dtype=torch.float64) tensor(-0.7046, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5366, dtype=torch.float64) delta_t tensor(0.4460, dtype=torch.float64)
14 gae_duplicate tensor(0.2589, dtype=torch.float64) tensor(-9.0507, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1888, dtype=torch.float64) delta_t tensor(0.1501, dtype=torch.float64)
13 gae_duplicate tensor(-0.1644, dtype=torch.float64) tensor(-3.5902, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5243, dtype=torch.float64) delta_t tensor(0.3295, dtype=torch.float64)
12 gae_duplicate tensor(0.1646, dtype=torch.float64) tensor(-6.6181, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1419, dtype=torch.float64) delta_t tensor(0.0592, dtype=torch.float64)
11 gae_duplicate tensor(-0.1860, dtype=torch.float64) tensor(-2.0090, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5431, dtype=torch.float64) delta_t tensor(0.2977, dtype=torch.float64)
10 gae_duplicate tensor(0.2271, dtype=torch.float64) tensor(-5.7603, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1163, dtype=torch.float64) delta_t tensor(0.0993, dtype=torch.float64)
9 gae_duplicate tensor(-0.0750, dtype=torch.float64) tensor(-3.0140, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4921, dtype=torch.float64) delta_t tensor(0.2751, dtype=torch.float64)
8 gae_duplicate tensor(0.1870, dtype=torch.float64) tensor(-5.7248, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0715, dtype=torch.float64) delta_t tensor(-0.0401, dtype=torch.float64)
7 gae_duplicate tensor(-0.0886, dtype=torch.float64) tensor(0.2008, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3819, dtype=torch.float64) delta_t tensor(0.3799, dtype=torch.float64)
6 gae_duplicate tensor(0.2761, dtype=torch.float64) tensor(-7.6619, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1482, dtype=torch.float64) delta_t tensor(-0.0072, dtype=torch.float64)
5 gae_duplicate tensor(-0.3917, dtype=torch.float64) tensor(-0.1413, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7219, dtype=torch.float64) delta_t tensor(-2.2335, dtype=torch.float64)
4 gae_duplicate tensor(-3.9814, dtype=torch.float64) tensor(42.6109, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0675, dtype=torch.float64) delta_t tensor(0.6602, dtype=torch.float64)
3 gae_duplicate tensor(0.1250, dtype=torch.float64) tensor(-9.0076, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2762, dtype=torch.float64) delta_t tensor(0.3606, dtype=torch.float64)
2 gae_duplicate tensor(0.1406, dtype=torch.float64) tensor(-8.0505, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1817.4779052734375
value loss:80.94642639160156
entropies:344.7982177734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.693593978881836 seconds
19 rew tensor(0.4601, dtype=torch.float64) delta_t tensor(0.3229, dtype=torch.float64)
19 gae_duplicate tensor(-0.0313, dtype=torch.float64) tensor(-6.4736, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3664, dtype=torch.float64) delta_t tensor(0.1451, dtype=torch.float64)
18 gae_duplicate tensor(-0.0056, dtype=torch.float64) tensor(-3.6730, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4482, dtype=torch.float64) delta_t tensor(0.2236, dtype=torch.float64)
17 gae_duplicate tensor(-0.0189, dtype=torch.float64) tensor(-4.1188, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4158, dtype=torch.float64) delta_t tensor(0.1540, dtype=torch.float64)
16 gae_duplicate tensor(0.0604, dtype=torch.float64) tensor(-3.5549, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2348, dtype=torch.float64) delta_t tensor(0.0918, dtype=torch.float64)
15 gae_duplicate tensor(-0.2477, dtype=torch.float64) tensor(-2.4102, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4568, dtype=torch.float64) delta_t tensor(0.2463, dtype=torch.float64)
14 gae_duplicate tensor(0.0045, dtype=torch.float64) tensor(-4.2953, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2090, dtype=torch.float64) delta_t tensor(0.1051, dtype=torch.float64)
13 gae_duplicate tensor(-0.2502, dtype=torch.float64) tensor(-2.6667, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4571, dtype=torch.float64) delta_t tensor(0.1698, dtype=torch.float64)
12 gae_duplicate tensor(0.0375, dtype=torch.float64) tensor(-3.6503, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2030, dtype=torch.float64) delta_t tensor(0.1094, dtype=torch.float64)
11 gae_duplicate tensor(-0.1351, dtype=torch.float64) tensor(-2.8413, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4508, dtype=torch.float64) delta_t tensor(0.2139, dtype=torch.float64)
10 gae_duplicate tensor(0.0724, dtype=torch.float64) tensor(-4.6528, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0455, dtype=torch.float64) delta_t tensor(0.0543, dtype=torch.float64)
9 gae_duplicate tensor(-0.2170, dtype=torch.float64) tensor(-1.6669, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4213, dtype=torch.float64) delta_t tensor(0.2433, dtype=torch.float64)
8 gae_duplicate tensor(0.1787, dtype=torch.float64) tensor(-4.4668, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1679, dtype=torch.float64) delta_t tensor(0.0505, dtype=torch.float64)
7 gae_duplicate tensor(-0.2194, dtype=torch.float64) tensor(-1.5343, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2872, dtype=torch.float64) delta_t tensor(0.4443, dtype=torch.float64)
6 gae_duplicate tensor(0.2817, dtype=torch.float64) tensor(-8.5390, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1276, dtype=torch.float64) delta_t tensor(0.1007, dtype=torch.float64)
5 gae_duplicate tensor(-0.3602, dtype=torch.float64) tensor(-2.7756, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5503, dtype=torch.float64) delta_t tensor(-2.1385, dtype=torch.float64)
4 gae_duplicate tensor(-4.5934, dtype=torch.float64) tensor(38.3687, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0100, dtype=torch.float64) delta_t tensor(0.6737, dtype=torch.float64)
3 gae_duplicate tensor(0.1616, dtype=torch.float64) tensor(-9.5253, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2420, dtype=torch.float64) delta_t tensor(0.5506, dtype=torch.float64)
2 gae_duplicate tensor(0.3986, dtype=torch.float64) tensor(-12.0242, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2093.944580078125
value loss:88.75738525390625
entropies:344.7249450683594
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3956.9724)
ToM Target loss= tensor(3544.9460)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.844738245010376 seconds
19 rew tensor(0.4676, dtype=torch.float64) delta_t tensor(0.3181, dtype=torch.float64)
19 gae_duplicate tensor(-0.1005, dtype=torch.float64) tensor(-7.0093, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4556, dtype=torch.float64) delta_t tensor(0.1800, dtype=torch.float64)
18 gae_duplicate tensor(-0.0799, dtype=torch.float64) tensor(-4.6126, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4390, dtype=torch.float64) delta_t tensor(0.4579, dtype=torch.float64)
17 gae_duplicate tensor(-0.0687, dtype=torch.float64) tensor(-10.1050, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4474, dtype=torch.float64) delta_t tensor(0.2156, dtype=torch.float64)
16 gae_duplicate tensor(-0.0134, dtype=torch.float64) tensor(-5.0091, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2032, dtype=torch.float64) delta_t tensor(0.1213, dtype=torch.float64)
15 gae_duplicate tensor(-0.6401, dtype=torch.float64) tensor(-3.4911, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5025, dtype=torch.float64) delta_t tensor(0.2522, dtype=torch.float64)
14 gae_duplicate tensor(-0.0938, dtype=torch.float64) tensor(-5.0059, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2009, dtype=torch.float64) delta_t tensor(0.1078, dtype=torch.float64)
13 gae_duplicate tensor(-0.1519, dtype=torch.float64) tensor(-2.5765, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5096, dtype=torch.float64) delta_t tensor(0.3037, dtype=torch.float64)
12 gae_duplicate tensor(0.1052, dtype=torch.float64) tensor(-6.1620, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1950, dtype=torch.float64) delta_t tensor(0.0463, dtype=torch.float64)
11 gae_duplicate tensor(-0.2129, dtype=torch.float64) tensor(-1.1604, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4885, dtype=torch.float64) delta_t tensor(0.2448, dtype=torch.float64)
10 gae_duplicate tensor(-0.0508, dtype=torch.float64) tensor(-4.7531, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5582, dtype=torch.float64) delta_t tensor(-0.5150, dtype=torch.float64)
9 gae_duplicate tensor(-2.0684, dtype=torch.float64) tensor(8.1222, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3796, dtype=torch.float64) delta_t tensor(-0.4851, dtype=torch.float64)
8 gae_duplicate tensor(-3.9943, dtype=torch.float64) tensor(9.5700, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0792, dtype=torch.float64) delta_t tensor(-0.0353, dtype=torch.float64)
7 gae_duplicate tensor(-0.4855, dtype=torch.float64) tensor(1.9023, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2065, dtype=torch.float64) delta_t tensor(0.3017, dtype=torch.float64)
6 gae_duplicate tensor(0.0420, dtype=torch.float64) tensor(-6.0660, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1262, dtype=torch.float64) delta_t tensor(0.2675, dtype=torch.float64)
5 gae_duplicate tensor(-0.2329, dtype=torch.float64) tensor(-5.5297, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.7673, dtype=torch.float64) delta_t tensor(-3.2701, dtype=torch.float64)
4 gae_duplicate tensor(-6.1826, dtype=torch.float64) tensor(67.2240, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0686, dtype=torch.float64) delta_t tensor(0.7654, dtype=torch.float64)
3 gae_duplicate tensor(0.1946, dtype=torch.float64) tensor(-8.7727, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2442, dtype=torch.float64) delta_t tensor(0.4658, dtype=torch.float64)
2 gae_duplicate tensor(-0.1860, dtype=torch.float64) tensor(-9.8414, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-456.2408447265625
value loss:206.26779174804688
entropies:345.0496826171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.435527801513672 seconds
19 rew tensor(0.3697, dtype=torch.float64) delta_t tensor(0.2478, dtype=torch.float64)
19 gae_duplicate tensor(-0.2687, dtype=torch.float64) tensor(-5.1735, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4251, dtype=torch.float64) delta_t tensor(0.2132, dtype=torch.float64)
18 gae_duplicate tensor(0.0187, dtype=torch.float64) tensor(-4.8992, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2885, dtype=torch.float64) delta_t tensor(0.0779, dtype=torch.float64)
17 gae_duplicate tensor(-0.2062, dtype=torch.float64) tensor(-1.9921, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5419, dtype=torch.float64) delta_t tensor(0.1647, dtype=torch.float64)
16 gae_duplicate tensor(0.1086, dtype=torch.float64) tensor(-3.3626, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0162, dtype=torch.float64) delta_t tensor(0.0225, dtype=torch.float64)
15 gae_duplicate tensor(-0.1754, dtype=torch.float64) tensor(-0.9165, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5339, dtype=torch.float64) delta_t tensor(0.2453, dtype=torch.float64)
14 gae_duplicate tensor(0.1090, dtype=torch.float64) tensor(-4.6735, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0320, dtype=torch.float64) delta_t tensor(-0.0638, dtype=torch.float64)
13 gae_duplicate tensor(-0.2031, dtype=torch.float64) tensor(0.8768, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5410, dtype=torch.float64) delta_t tensor(0.2841, dtype=torch.float64)
12 gae_duplicate tensor(0.1165, dtype=torch.float64) tensor(-5.4936, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0260, dtype=torch.float64) delta_t tensor(-0.0647, dtype=torch.float64)
11 gae_duplicate tensor(-0.2040, dtype=torch.float64) tensor(0.6021, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5119, dtype=torch.float64) delta_t tensor(0.1625, dtype=torch.float64)
10 gae_duplicate tensor(0.1298, dtype=torch.float64) tensor(-3.0743, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0036, dtype=torch.float64) delta_t tensor(0.0557, dtype=torch.float64)
9 gae_duplicate tensor(-0.0120, dtype=torch.float64) tensor(-1.5161, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5062, dtype=torch.float64) delta_t tensor(0.1209, dtype=torch.float64)
8 gae_duplicate tensor(0.0689, dtype=torch.float64) tensor(-2.3711, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0405, dtype=torch.float64) delta_t tensor(-0.0746, dtype=torch.float64)
7 gae_duplicate tensor(-0.2924, dtype=torch.float64) tensor(0.6508, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4268, dtype=torch.float64) delta_t tensor(0.2786, dtype=torch.float64)
6 gae_duplicate tensor(0.1582, dtype=torch.float64) tensor(-5.9217, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2115, dtype=torch.float64) delta_t tensor(0.0198, dtype=torch.float64)
5 gae_duplicate tensor(-0.5449, dtype=torch.float64) tensor(-1.1273, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1301, dtype=torch.float64) delta_t tensor(-2.4511, dtype=torch.float64)
4 gae_duplicate tensor(-6.3814, dtype=torch.float64) tensor(41.7103, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1761, dtype=torch.float64) delta_t tensor(0.7205, dtype=torch.float64)
3 gae_duplicate tensor(0.1828, dtype=torch.float64) tensor(-9.5947, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1762, dtype=torch.float64) delta_t tensor(0.4968, dtype=torch.float64)
2 gae_duplicate tensor(0.2748, dtype=torch.float64) tensor(-10.7499, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:826.1718139648438
value loss:122.69063568115234
entropies:345.3304443359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.994987964630127 seconds
19 rew tensor(0.4368, dtype=torch.float64) delta_t tensor(0.3233, dtype=torch.float64)
19 gae_duplicate tensor(-0.2422, dtype=torch.float64) tensor(-6.0226, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4560, dtype=torch.float64) delta_t tensor(0.2279, dtype=torch.float64)
18 gae_duplicate tensor(0.0269, dtype=torch.float64) tensor(-4.4708, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4168, dtype=torch.float64) delta_t tensor(0.2751, dtype=torch.float64)
17 gae_duplicate tensor(-0.1437, dtype=torch.float64) tensor(-5.4138, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4926, dtype=torch.float64) delta_t tensor(0.1865, dtype=torch.float64)
16 gae_duplicate tensor(-0.1083, dtype=torch.float64) tensor(-3.8069, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2318, dtype=torch.float64) delta_t tensor(0.1041, dtype=torch.float64)
15 gae_duplicate tensor(-0.1809, dtype=torch.float64) tensor(-2.0275, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5000, dtype=torch.float64) delta_t tensor(0.1855, dtype=torch.float64)
14 gae_duplicate tensor(-0.1149, dtype=torch.float64) tensor(-3.1264, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2327, dtype=torch.float64) delta_t tensor(0.0968, dtype=torch.float64)
13 gae_duplicate tensor(-0.2704, dtype=torch.float64) tensor(-2.0591, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4925, dtype=torch.float64) delta_t tensor(0.3075, dtype=torch.float64)
12 gae_duplicate tensor(0.0663, dtype=torch.float64) tensor(-6.4223, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2347, dtype=torch.float64) delta_t tensor(0.0471, dtype=torch.float64)
11 gae_duplicate tensor(-0.3137, dtype=torch.float64) tensor(-1.0464, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4803, dtype=torch.float64) delta_t tensor(0.1982, dtype=torch.float64)
10 gae_duplicate tensor(-0.0356, dtype=torch.float64) tensor(-3.9419, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1815, dtype=torch.float64) delta_t tensor(-0.3096, dtype=torch.float64)
9 gae_duplicate tensor(-1.6915, dtype=torch.float64) tensor(6.7261, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3349, dtype=torch.float64) delta_t tensor(-0.5337, dtype=torch.float64)
8 gae_duplicate tensor(-3.7264, dtype=torch.float64) tensor(10.3375, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1607, dtype=torch.float64) delta_t tensor(0.0594, dtype=torch.float64)
7 gae_duplicate tensor(-0.2046, dtype=torch.float64) tensor(0.1018, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3142, dtype=torch.float64) delta_t tensor(0.2652, dtype=torch.float64)
6 gae_duplicate tensor(0.1667, dtype=torch.float64) tensor(-5.2720, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1532, dtype=torch.float64) delta_t tensor(0.0378, dtype=torch.float64)
5 gae_duplicate tensor(-1.2086, dtype=torch.float64) tensor(-2.9625, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3468, dtype=torch.float64) delta_t tensor(-1.8293, dtype=torch.float64)
4 gae_duplicate tensor(-3.5353, dtype=torch.float64) tensor(36.3674, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0432, dtype=torch.float64) delta_t tensor(0.7889, dtype=torch.float64)
3 gae_duplicate tensor(0.4183, dtype=torch.float64) tensor(-11.3554, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2973, dtype=torch.float64) delta_t tensor(0.4185, dtype=torch.float64)
2 gae_duplicate tensor(0.1213, dtype=torch.float64) tensor(-9.5861, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:661.556396484375
value loss:95.80253601074219
entropies:345.9569091796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.842680215835571 seconds
19 rew tensor(0.3374, dtype=torch.float64) delta_t tensor(0.0947, dtype=torch.float64)
19 gae_duplicate tensor(-0.4481, dtype=torch.float64) tensor(-1.9961, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3960, dtype=torch.float64) delta_t tensor(0.0389, dtype=torch.float64)
18 gae_duplicate tensor(-0.0958, dtype=torch.float64) tensor(-0.6585, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3832, dtype=torch.float64) delta_t tensor(0.3070, dtype=torch.float64)
17 gae_duplicate tensor(0.0801, dtype=torch.float64) tensor(-5.7991, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4376, dtype=torch.float64) delta_t tensor(0.0383, dtype=torch.float64)
16 gae_duplicate tensor(-0.0902, dtype=torch.float64) tensor(-1.3523, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1474, dtype=torch.float64) delta_t tensor(0.2608, dtype=torch.float64)
15 gae_duplicate tensor(-0.1395, dtype=torch.float64) tensor(-4.9971, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4921, dtype=torch.float64) delta_t tensor(0.1325, dtype=torch.float64)
14 gae_duplicate tensor(0.0050, dtype=torch.float64) tensor(-3.1252, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0250, dtype=torch.float64) delta_t tensor(0.0321, dtype=torch.float64)
13 gae_duplicate tensor(-0.2795, dtype=torch.float64) tensor(-0.4507, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4359, dtype=torch.float64) delta_t tensor(0.1742, dtype=torch.float64)
12 gae_duplicate tensor(0.0544, dtype=torch.float64) tensor(-3.1371, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0111, dtype=torch.float64) delta_t tensor(-0.1192, dtype=torch.float64)
11 gae_duplicate tensor(-0.3039, dtype=torch.float64) tensor(2.0559, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4030, dtype=torch.float64) delta_t tensor(0.1063, dtype=torch.float64)
10 gae_duplicate tensor(-0.0831, dtype=torch.float64) tensor(-1.7943, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1330, dtype=torch.float64) delta_t tensor(-0.0246, dtype=torch.float64)
9 gae_duplicate tensor(-0.6775, dtype=torch.float64) tensor(-0.0990, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3456, dtype=torch.float64) delta_t tensor(0.0402, dtype=torch.float64)
8 gae_duplicate tensor(-0.0700, dtype=torch.float64) tensor(-0.8799, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0662, dtype=torch.float64) delta_t tensor(-0.2583, dtype=torch.float64)
7 gae_duplicate tensor(-0.4942, dtype=torch.float64) tensor(5.2543, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2806, dtype=torch.float64) delta_t tensor(0.2218, dtype=torch.float64)
6 gae_duplicate tensor(-0.1137, dtype=torch.float64) tensor(-4.0427, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2511, dtype=torch.float64) delta_t tensor(0.5125, dtype=torch.float64)
5 gae_duplicate tensor(-0.4303, dtype=torch.float64) tensor(-9.8118, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.7649, dtype=torch.float64) delta_t tensor(-2.8963, dtype=torch.float64)
4 gae_duplicate tensor(-7.6119, dtype=torch.float64) tensor(55.0839, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0254, dtype=torch.float64) delta_t tensor(0.7753, dtype=torch.float64)
3 gae_duplicate tensor(0.0473, dtype=torch.float64) tensor(-9.0873, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1406, dtype=torch.float64) delta_t tensor(0.4306, dtype=torch.float64)
2 gae_duplicate tensor(0.0040, dtype=torch.float64) tensor(-8.9198, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-430.59307861328125
value loss:162.18392944335938
entropies:346.14630126953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.056067943572998 seconds
19 rew tensor(0.4813, dtype=torch.float64) delta_t tensor(0.5525, dtype=torch.float64)
19 gae_duplicate tensor(0.0506, dtype=torch.float64) tensor(-10.1294, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4659, dtype=torch.float64) delta_t tensor(0.2383, dtype=torch.float64)
18 gae_duplicate tensor(-0.0131, dtype=torch.float64) tensor(-5.2871, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4345, dtype=torch.float64) delta_t tensor(0.5446, dtype=torch.float64)
17 gae_duplicate tensor(-0.1355, dtype=torch.float64) tensor(-11.7633, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5035, dtype=torch.float64) delta_t tensor(0.1666, dtype=torch.float64)
16 gae_duplicate tensor(-0.0586, dtype=torch.float64) tensor(-4.5275, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2502, dtype=torch.float64) delta_t tensor(0.3350, dtype=torch.float64)
15 gae_duplicate tensor(-0.1398, dtype=torch.float64) tensor(-7.1291, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5586, dtype=torch.float64) delta_t tensor(0.2814, dtype=torch.float64)
14 gae_duplicate tensor(0.0153, dtype=torch.float64) tensor(-5.2926, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1474, dtype=torch.float64) delta_t tensor(0.1018, dtype=torch.float64)
13 gae_duplicate tensor(-0.2971, dtype=torch.float64) tensor(-2.5459, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5589, dtype=torch.float64) delta_t tensor(0.2281, dtype=torch.float64)
12 gae_duplicate tensor(0.0266, dtype=torch.float64) tensor(-4.6183, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1483, dtype=torch.float64) delta_t tensor(0.0215, dtype=torch.float64)
11 gae_duplicate tensor(-0.3215, dtype=torch.float64) tensor(-0.6992, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5300, dtype=torch.float64) delta_t tensor(0.1864, dtype=torch.float64)
10 gae_duplicate tensor(0.0320, dtype=torch.float64) tensor(-3.7838, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1519, dtype=torch.float64) delta_t tensor(-0.1650, dtype=torch.float64)
9 gae_duplicate tensor(-1.0078, dtype=torch.float64) tensor(2.2367, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2143, dtype=torch.float64) delta_t tensor(-0.5557, dtype=torch.float64)
8 gae_duplicate tensor(-3.6859, dtype=torch.float64) tensor(14.3563, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3623, dtype=torch.float64) delta_t tensor(-0.3950, dtype=torch.float64)
7 gae_duplicate tensor(-1.7942, dtype=torch.float64) tensor(10.0346, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3816, dtype=torch.float64) delta_t tensor(0.2105, dtype=torch.float64)
6 gae_duplicate tensor(-0.2540, dtype=torch.float64) tensor(-3.5665, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3790, dtype=torch.float64) delta_t tensor(0.3112, dtype=torch.float64)
5 gae_duplicate tensor(-1.2831, dtype=torch.float64) tensor(-6.2250, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1721, dtype=torch.float64) delta_t tensor(-0.4550, dtype=torch.float64)
4 gae_duplicate tensor(-1.0728, dtype=torch.float64) tensor(8.3821, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0629, dtype=torch.float64) delta_t tensor(0.5467, dtype=torch.float64)
3 gae_duplicate tensor(-0.2682, dtype=torch.float64) tensor(-9.2457, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1590, dtype=torch.float64) delta_t tensor(0.5175, dtype=torch.float64)
2 gae_duplicate tensor(0.3497, dtype=torch.float64) tensor(-10.8180, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2640.173095703125
value loss:66.39742279052734
entropies:345.9620361328125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3938.1606)
ToM Target loss= tensor(3542.1941)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.961115121841431 seconds
19 rew tensor(0.4604, dtype=torch.float64) delta_t tensor(0.4323, dtype=torch.float64)
19 gae_duplicate tensor(-0.2527, dtype=torch.float64) tensor(-8.1598, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4558, dtype=torch.float64) delta_t tensor(0.3884, dtype=torch.float64)
18 gae_duplicate tensor(-0.0577, dtype=torch.float64) tensor(-8.3303, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4275, dtype=torch.float64) delta_t tensor(0.3867, dtype=torch.float64)
17 gae_duplicate tensor(-0.1912, dtype=torch.float64) tensor(-8.9417, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4961, dtype=torch.float64) delta_t tensor(0.1194, dtype=torch.float64)
16 gae_duplicate tensor(-0.0637, dtype=torch.float64) tensor(-3.4240, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1710, dtype=torch.float64) delta_t tensor(0.0534, dtype=torch.float64)
15 gae_duplicate tensor(-0.3786, dtype=torch.float64) tensor(-0.9259, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5325, dtype=torch.float64) delta_t tensor(0.1576, dtype=torch.float64)
14 gae_duplicate tensor(-0.0801, dtype=torch.float64) tensor(-2.9283, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1667, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
13 gae_duplicate tensor(-0.3400, dtype=torch.float64) tensor(-1.4136, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5398, dtype=torch.float64) delta_t tensor(0.1633, dtype=torch.float64)
12 gae_duplicate tensor(-0.0417, dtype=torch.float64) tensor(-2.7385, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1610, dtype=torch.float64) delta_t tensor(0.0412, dtype=torch.float64)
11 gae_duplicate tensor(-0.3778, dtype=torch.float64) tensor(-0.9052, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3631, dtype=torch.float64) delta_t tensor(0.0735, dtype=torch.float64)
10 gae_duplicate tensor(-0.0250, dtype=torch.float64) tensor(-1.3555, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3335, dtype=torch.float64) delta_t tensor(-0.2107, dtype=torch.float64)
9 gae_duplicate tensor(-2.1468, dtype=torch.float64) tensor(4.2817, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0013, dtype=torch.float64) delta_t tensor(-0.1760, dtype=torch.float64)
8 gae_duplicate tensor(-2.1050, dtype=torch.float64) tensor(3.4439, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0720, dtype=torch.float64) delta_t tensor(-0.1611, dtype=torch.float64)
7 gae_duplicate tensor(-0.4291, dtype=torch.float64) tensor(3.2329, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2802, dtype=torch.float64) delta_t tensor(0.3526, dtype=torch.float64)
6 gae_duplicate tensor(0.1035, dtype=torch.float64) tensor(-5.7839, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1402, dtype=torch.float64) delta_t tensor(0.2103, dtype=torch.float64)
5 gae_duplicate tensor(-0.6827, dtype=torch.float64) tensor(-4.6072, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1085, dtype=torch.float64) delta_t tensor(-1.7864, dtype=torch.float64)
4 gae_duplicate tensor(-5.7884, dtype=torch.float64) tensor(40.0461, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0508, dtype=torch.float64) delta_t tensor(0.8562, dtype=torch.float64)
3 gae_duplicate tensor(0.5317, dtype=torch.float64) tensor(-14.8195, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3803, dtype=torch.float64) delta_t tensor(0.4707, dtype=torch.float64)
2 gae_duplicate tensor(0.1839, dtype=torch.float64) tensor(-10.1242, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1173.22265625
value loss:114.28577423095703
entropies:345.34765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.831111192703247 seconds
19 rew tensor(0.3942, dtype=torch.float64) delta_t tensor(-0.0943, dtype=torch.float64)
19 gae_duplicate tensor(-0.3405, dtype=torch.float64) tensor(1.7075, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4621, dtype=torch.float64) delta_t tensor(0.0452, dtype=torch.float64)
18 gae_duplicate tensor(-0.2062, dtype=torch.float64) tensor(-1.0087, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3673, dtype=torch.float64) delta_t tensor(-0.0189, dtype=torch.float64)
17 gae_duplicate tensor(-0.2391, dtype=torch.float64) tensor(0.7255, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4680, dtype=torch.float64) delta_t tensor(0.0754, dtype=torch.float64)
16 gae_duplicate tensor(-0.2170, dtype=torch.float64) tensor(-1.4930, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0953, dtype=torch.float64) delta_t tensor(-0.3055, dtype=torch.float64)
15 gae_duplicate tensor(-1.0807, dtype=torch.float64) tensor(5.6833, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4909, dtype=torch.float64) delta_t tensor(0.1179, dtype=torch.float64)
14 gae_duplicate tensor(-0.2568, dtype=torch.float64) tensor(-1.3207, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2373, dtype=torch.float64) delta_t tensor(-0.1420, dtype=torch.float64)
13 gae_duplicate tensor(-0.3832, dtype=torch.float64) tensor(2.3969, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5048, dtype=torch.float64) delta_t tensor(0.0159, dtype=torch.float64)
12 gae_duplicate tensor(-0.0510, dtype=torch.float64) tensor(0.0087, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2312, dtype=torch.float64) delta_t tensor(-0.1182, dtype=torch.float64)
11 gae_duplicate tensor(-0.3137, dtype=torch.float64) tensor(2.6454, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4830, dtype=torch.float64) delta_t tensor(-0.0326, dtype=torch.float64)
10 gae_duplicate tensor(-0.2317, dtype=torch.float64) tensor(0.8339, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0702, dtype=torch.float64) delta_t tensor(-0.1067, dtype=torch.float64)
9 gae_duplicate tensor(-0.5940, dtype=torch.float64) tensor(2.2315, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4345, dtype=torch.float64) delta_t tensor(0.0081, dtype=torch.float64)
8 gae_duplicate tensor(-0.2010, dtype=torch.float64) tensor(0.1779, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1751, dtype=torch.float64) delta_t tensor(-0.1597, dtype=torch.float64)
7 gae_duplicate tensor(-0.4944, dtype=torch.float64) tensor(2.5887, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3351, dtype=torch.float64) delta_t tensor(0.2591, dtype=torch.float64)
6 gae_duplicate tensor(0.0443, dtype=torch.float64) tensor(-5.0885, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0942, dtype=torch.float64) delta_t tensor(0.2239, dtype=torch.float64)
5 gae_duplicate tensor(-0.5584, dtype=torch.float64) tensor(-5.8631, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6967, dtype=torch.float64) delta_t tensor(-2.9241, dtype=torch.float64)
4 gae_duplicate tensor(-5.7799, dtype=torch.float64) tensor(60.5120, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0875, dtype=torch.float64) delta_t tensor(0.9252, dtype=torch.float64)
3 gae_duplicate tensor(0.3067, dtype=torch.float64) tensor(-12.0354, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2061, dtype=torch.float64) delta_t tensor(0.4986, dtype=torch.float64)
2 gae_duplicate tensor(0.1104, dtype=torch.float64) tensor(-10.6994, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2361.150146484375
value loss:133.09812927246094
entropies:344.4594421386719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.956484794616699 seconds
19 rew tensor(0.4484, dtype=torch.float64) delta_t tensor(0.1006, dtype=torch.float64)
19 gae_duplicate tensor(-0.1920, dtype=torch.float64) tensor(-2.3175, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3503, dtype=torch.float64) delta_t tensor(0.0495, dtype=torch.float64)
18 gae_duplicate tensor(-0.3612, dtype=torch.float64) tensor(-0.6728, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4607, dtype=torch.float64) delta_t tensor(0.1478, dtype=torch.float64)
17 gae_duplicate tensor(-0.2336, dtype=torch.float64) tensor(-3.0167, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3111, dtype=torch.float64) delta_t tensor(-0.1303, dtype=torch.float64)
16 gae_duplicate tensor(-0.2912, dtype=torch.float64) tensor(2.0977, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4166, dtype=torch.float64) delta_t tensor(0.0687, dtype=torch.float64)
15 gae_duplicate tensor(-0.2051, dtype=torch.float64) tensor(-1.4836, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3723, dtype=torch.float64) delta_t tensor(-0.0923, dtype=torch.float64)
14 gae_duplicate tensor(-0.2211, dtype=torch.float64) tensor(1.9981, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3784, dtype=torch.float64) delta_t tensor(-0.0420, dtype=torch.float64)
13 gae_duplicate tensor(-0.1948, dtype=torch.float64) tensor(0.8029, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3795, dtype=torch.float64) delta_t tensor(-0.0971, dtype=torch.float64)
12 gae_duplicate tensor(-0.3604, dtype=torch.float64) tensor(1.8755, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3790, dtype=torch.float64) delta_t tensor(-0.0972, dtype=torch.float64)
11 gae_duplicate tensor(-0.2148, dtype=torch.float64) tensor(1.7447, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3327, dtype=torch.float64) delta_t tensor(-0.1311, dtype=torch.float64)
10 gae_duplicate tensor(-0.3472, dtype=torch.float64) tensor(2.2154, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3097, dtype=torch.float64) delta_t tensor(-0.0396, dtype=torch.float64)
9 gae_duplicate tensor(-0.2908, dtype=torch.float64) tensor(1.0553, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3370, dtype=torch.float64) delta_t tensor(-0.0015, dtype=torch.float64)
8 gae_duplicate tensor(-0.2702, dtype=torch.float64) tensor(0.1580, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2840, dtype=torch.float64) delta_t tensor(-0.1974, dtype=torch.float64)
7 gae_duplicate tensor(-0.6973, dtype=torch.float64) tensor(3.8327, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0976, dtype=torch.float64) delta_t tensor(-0.0046, dtype=torch.float64)
6 gae_duplicate tensor(-1.5543, dtype=torch.float64) tensor(1.8359, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3458, dtype=torch.float64) delta_t tensor(0.0801, dtype=torch.float64)
5 gae_duplicate tensor(-1.7577, dtype=torch.float64) tensor(-0.4081, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1608, dtype=torch.float64) delta_t tensor(-1.7789, dtype=torch.float64)
4 gae_duplicate tensor(-5.5415, dtype=torch.float64) tensor(35.5172, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0939, dtype=torch.float64) delta_t tensor(0.7763, dtype=torch.float64)
3 gae_duplicate tensor(0.0710, dtype=torch.float64) tensor(-9.7316, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3200, dtype=torch.float64) delta_t tensor(0.3847, dtype=torch.float64)
2 gae_duplicate tensor(0.0640, dtype=torch.float64) tensor(-7.4623, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1606.8701171875
value loss:86.64901733398438
entropies:343.2337951660156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.957750082015991 seconds
19 rew tensor(0.4733, dtype=torch.float64) delta_t tensor(0.2410, dtype=torch.float64)
19 gae_duplicate tensor(-0.1319, dtype=torch.float64) tensor(-4.7328, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4043, dtype=torch.float64) delta_t tensor(-0.0495, dtype=torch.float64)
18 gae_duplicate tensor(-0.2629, dtype=torch.float64) tensor(0.8501, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3268, dtype=torch.float64) delta_t tensor(0.1206, dtype=torch.float64)
17 gae_duplicate tensor(-0.2056, dtype=torch.float64) tensor(-1.8587, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5326, dtype=torch.float64) delta_t tensor(0.0726, dtype=torch.float64)
16 gae_duplicate tensor(-0.1373, dtype=torch.float64) tensor(-1.0788, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1422, dtype=torch.float64) delta_t tensor(-0.0938, dtype=torch.float64)
15 gae_duplicate tensor(-0.4041, dtype=torch.float64) tensor(0.7244, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5452, dtype=torch.float64) delta_t tensor(0.2704, dtype=torch.float64)
14 gae_duplicate tensor(-0.1180, dtype=torch.float64) tensor(-4.8063, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1307, dtype=torch.float64) delta_t tensor(-0.0355, dtype=torch.float64)
13 gae_duplicate tensor(-0.2717, dtype=torch.float64) tensor(-0.1987, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5123, dtype=torch.float64) delta_t tensor(0.1769, dtype=torch.float64)
12 gae_duplicate tensor(-0.1094, dtype=torch.float64) tensor(-3.5996, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0756, dtype=torch.float64) delta_t tensor(0.0579, dtype=torch.float64)
11 gae_duplicate tensor(-0.4559, dtype=torch.float64) tensor(-1.3837, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5547, dtype=torch.float64) delta_t tensor(0.1298, dtype=torch.float64)
10 gae_duplicate tensor(-0.0626, dtype=torch.float64) tensor(-2.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2833, dtype=torch.float64) delta_t tensor(-0.2152, dtype=torch.float64)
9 gae_duplicate tensor(-1.0952, dtype=torch.float64) tensor(2.9384, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1507, dtype=torch.float64) delta_t tensor(-0.1646, dtype=torch.float64)
8 gae_duplicate tensor(-0.7012, dtype=torch.float64) tensor(3.0419, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0908, dtype=torch.float64) delta_t tensor(0.0713, dtype=torch.float64)
7 gae_duplicate tensor(-0.0915, dtype=torch.float64) tensor(-1.1162, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3385, dtype=torch.float64) delta_t tensor(0.0729, dtype=torch.float64)
6 gae_duplicate tensor(-0.0103, dtype=torch.float64) tensor(-1.5765, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2551, dtype=torch.float64) delta_t tensor(-0.0769, dtype=torch.float64)
5 gae_duplicate tensor(-0.6333, dtype=torch.float64) tensor(0.6024, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7014, dtype=torch.float64) delta_t tensor(-2.0289, dtype=torch.float64)
4 gae_duplicate tensor(-3.1855, dtype=torch.float64) tensor(39.9665, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0897, dtype=torch.float64) delta_t tensor(0.8668, dtype=torch.float64)
3 gae_duplicate tensor(0.4156, dtype=torch.float64) tensor(-12.5855, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3148, dtype=torch.float64) delta_t tensor(0.1540, dtype=torch.float64)
2 gae_duplicate tensor(-0.0596, dtype=torch.float64) tensor(-4.5294, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-513.0804443359375
value loss:68.7190170288086
entropies:341.6976623535156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9505228996276855 seconds
19 rew tensor(0.3171, dtype=torch.float64) delta_t tensor(-0.2193, dtype=torch.float64)
19 gae_duplicate tensor(-0.2688, dtype=torch.float64) tensor(4.1801, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4975, dtype=torch.float64) delta_t tensor(-0.0306, dtype=torch.float64)
18 gae_duplicate tensor(-0.1617, dtype=torch.float64) tensor(0.8870, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2715, dtype=torch.float64) delta_t tensor(-0.0853, dtype=torch.float64)
17 gae_duplicate tensor(-0.2834, dtype=torch.float64) tensor(0.8440, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5299, dtype=torch.float64) delta_t tensor(-0.0396, dtype=torch.float64)
16 gae_duplicate tensor(-0.1203, dtype=torch.float64) tensor(0.8311, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1632, dtype=torch.float64) delta_t tensor(-0.1190, dtype=torch.float64)
15 gae_duplicate tensor(-0.3042, dtype=torch.float64) tensor(1.6582, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5376, dtype=torch.float64) delta_t tensor(0.0443, dtype=torch.float64)
14 gae_duplicate tensor(-0.1168, dtype=torch.float64) tensor(-0.5683, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1164, dtype=torch.float64) delta_t tensor(-0.1273, dtype=torch.float64)
13 gae_duplicate tensor(-0.3272, dtype=torch.float64) tensor(2.2878, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5517, dtype=torch.float64) delta_t tensor(-0.0173, dtype=torch.float64)
12 gae_duplicate tensor(-0.1157, dtype=torch.float64) tensor(0.4952, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1015, dtype=torch.float64) delta_t tensor(-0.2443, dtype=torch.float64)
11 gae_duplicate tensor(-0.4418, dtype=torch.float64) tensor(4.6564, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5311, dtype=torch.float64) delta_t tensor(-0.0078, dtype=torch.float64)
10 gae_duplicate tensor(-0.0862, dtype=torch.float64) tensor(0.5931, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1039, dtype=torch.float64) delta_t tensor(-0.0931, dtype=torch.float64)
9 gae_duplicate tensor(-0.2772, dtype=torch.float64) tensor(2.2244, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5087, dtype=torch.float64) delta_t tensor(-0.0793, dtype=torch.float64)
8 gae_duplicate tensor(-0.1440, dtype=torch.float64) tensor(1.4980, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0750, dtype=torch.float64) delta_t tensor(-0.0958, dtype=torch.float64)
7 gae_duplicate tensor(-0.5663, dtype=torch.float64) tensor(2.1294, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4285, dtype=torch.float64) delta_t tensor(0.0149, dtype=torch.float64)
6 gae_duplicate tensor(-0.0218, dtype=torch.float64) tensor(-0.0728, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0982, dtype=torch.float64) delta_t tensor(0.1972, dtype=torch.float64)
5 gae_duplicate tensor(-0.3699, dtype=torch.float64) tensor(-4.2131, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.6647, dtype=torch.float64) delta_t tensor(-3.2451, dtype=torch.float64)
4 gae_duplicate tensor(-4.7784, dtype=torch.float64) tensor(60.9561, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1392, dtype=torch.float64) delta_t tensor(1.0088, dtype=torch.float64)
3 gae_duplicate tensor(0.2654, dtype=torch.float64) tensor(-11.7726, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1393, dtype=torch.float64) delta_t tensor(0.3115, dtype=torch.float64)
2 gae_duplicate tensor(0.0992, dtype=torch.float64) tensor(-6.8903, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3317.03857421875
value loss:130.85011291503906
entropies:340.5982971191406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3915.6091)
ToM Target loss= tensor(3563.9048)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.711522102355957 seconds
19 rew tensor(0.5283, dtype=torch.float64) delta_t tensor(0.0752, dtype=torch.float64)
19 gae_duplicate tensor(-0.1071, dtype=torch.float64) tensor(-1.0851, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2958, dtype=torch.float64) delta_t tensor(-0.1681, dtype=torch.float64)
18 gae_duplicate tensor(-0.3103, dtype=torch.float64) tensor(3.4554, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4891, dtype=torch.float64) delta_t tensor(0.3052, dtype=torch.float64)
17 gae_duplicate tensor(-0.0563, dtype=torch.float64) tensor(-6.7684, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3223, dtype=torch.float64) delta_t tensor(-0.1763, dtype=torch.float64)
16 gae_duplicate tensor(-0.2844, dtype=torch.float64) tensor(2.6364, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2830, dtype=torch.float64) delta_t tensor(-0.1902, dtype=torch.float64)
15 gae_duplicate tensor(-0.9949, dtype=torch.float64) tensor(4.2528, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3068, dtype=torch.float64) delta_t tensor(-0.0824, dtype=torch.float64)
14 gae_duplicate tensor(-0.2929, dtype=torch.float64) tensor(1.7739, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4489, dtype=torch.float64) delta_t tensor(-0.0614, dtype=torch.float64)
13 gae_duplicate tensor(-0.2606, dtype=torch.float64) tensor(1.5034, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3302, dtype=torch.float64) delta_t tensor(-0.0144, dtype=torch.float64)
12 gae_duplicate tensor(-0.2312, dtype=torch.float64) tensor(0.2369, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4515, dtype=torch.float64) delta_t tensor(0.0374, dtype=torch.float64)
11 gae_duplicate tensor(-0.0549, dtype=torch.float64) tensor(-0.8197, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3243, dtype=torch.float64) delta_t tensor(-0.1583, dtype=torch.float64)
10 gae_duplicate tensor(-0.2703, dtype=torch.float64) tensor(2.6479, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4212, dtype=torch.float64) delta_t tensor(0.3486, dtype=torch.float64)
9 gae_duplicate tensor(-0.0745, dtype=torch.float64) tensor(-5.6105, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2877, dtype=torch.float64) delta_t tensor(0.0158, dtype=torch.float64)
8 gae_duplicate tensor(-0.2001, dtype=torch.float64) tensor(-1.5482, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4151, dtype=torch.float64) delta_t tensor(-0.0051, dtype=torch.float64)
7 gae_duplicate tensor(-0.1170, dtype=torch.float64) tensor(-0.0648, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1856, dtype=torch.float64) delta_t tensor(0.2391, dtype=torch.float64)
6 gae_duplicate tensor(0.0115, dtype=torch.float64) tensor(-4.1559, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1728, dtype=torch.float64) delta_t tensor(0.0351, dtype=torch.float64)
5 gae_duplicate tensor(-0.2735, dtype=torch.float64) tensor(-2.0169, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7569, dtype=torch.float64) delta_t tensor(-1.5755, dtype=torch.float64)
4 gae_duplicate tensor(-4.1250, dtype=torch.float64) tensor(28.6299, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0069, dtype=torch.float64) delta_t tensor(1.0790, dtype=torch.float64)
3 gae_duplicate tensor(-0.0046, dtype=torch.float64) tensor(-16.1840, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3340, dtype=torch.float64) delta_t tensor(0.5749, dtype=torch.float64)
2 gae_duplicate tensor(0.4221, dtype=torch.float64) tensor(-12.1129, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:190.67446899414062
value loss:72.71113586425781
entropies:339.8271789550781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.296903133392334 seconds
19 rew tensor(0.4588, dtype=torch.float64) delta_t tensor(0.0868, dtype=torch.float64)
19 gae_duplicate tensor(-0.2862, dtype=torch.float64) tensor(-2.2931, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5441, dtype=torch.float64) delta_t tensor(0.0825, dtype=torch.float64)
18 gae_duplicate tensor(0.0139, dtype=torch.float64) tensor(-1.5723, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3667, dtype=torch.float64) delta_t tensor(0.1012, dtype=torch.float64)
17 gae_duplicate tensor(-0.2574, dtype=torch.float64) tensor(-1.9958, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5267, dtype=torch.float64) delta_t tensor(0.0765, dtype=torch.float64)
16 gae_duplicate tensor(-0.0231, dtype=torch.float64) tensor(-1.6149, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2444, dtype=torch.float64) delta_t tensor(0.1545, dtype=torch.float64)
15 gae_duplicate tensor(-0.1929, dtype=torch.float64) tensor(-2.2383, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5397, dtype=torch.float64) delta_t tensor(0.1888, dtype=torch.float64)
14 gae_duplicate tensor(0.0226, dtype=torch.float64) tensor(-4.1359, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1753, dtype=torch.float64) delta_t tensor(0.0315, dtype=torch.float64)
13 gae_duplicate tensor(-0.2707, dtype=torch.float64) tensor(-0.3479, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5166, dtype=torch.float64) delta_t tensor(0.2679, dtype=torch.float64)
12 gae_duplicate tensor(-0.0392, dtype=torch.float64) tensor(-5.1155, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0413, dtype=torch.float64) delta_t tensor(0.0313, dtype=torch.float64)
11 gae_duplicate tensor(-0.2504, dtype=torch.float64) tensor(-1.7694, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5180, dtype=torch.float64) delta_t tensor(0.0459, dtype=torch.float64)
10 gae_duplicate tensor(-0.0120, dtype=torch.float64) tensor(-0.9621, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0167, dtype=torch.float64) delta_t tensor(0.2028, dtype=torch.float64)
9 gae_duplicate tensor(-0.4769, dtype=torch.float64) tensor(-4.4585, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4120, dtype=torch.float64) delta_t tensor(-0.0672, dtype=torch.float64)
8 gae_duplicate tensor(-0.1749, dtype=torch.float64) tensor(0.6786, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1094, dtype=torch.float64) delta_t tensor(0.0693, dtype=torch.float64)
7 gae_duplicate tensor(-0.3049, dtype=torch.float64) tensor(-1.4349, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3066, dtype=torch.float64) delta_t tensor(0.1687, dtype=torch.float64)
6 gae_duplicate tensor(0.0915, dtype=torch.float64) tensor(-2.8311, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3941, dtype=torch.float64) delta_t tensor(0.2690, dtype=torch.float64)
5 gae_duplicate tensor(-0.5000, dtype=torch.float64) tensor(-5.8958, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.8554, dtype=torch.float64) delta_t tensor(-4.5040, dtype=torch.float64)
4 gae_duplicate tensor(-8.3934, dtype=torch.float64) tensor(86.1288, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0786, dtype=torch.float64) delta_t tensor(0.8837, dtype=torch.float64)
3 gae_duplicate tensor(-0.5759, dtype=torch.float64) tensor(-9.4550, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0858, dtype=torch.float64) delta_t tensor(0.5676, dtype=torch.float64)
2 gae_duplicate tensor(0.2165, dtype=torch.float64) tensor(-13.7558, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1545.953369140625
value loss:257.2128601074219
entropies:339.49969482421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.274837970733643 seconds
19 rew tensor(0.3941, dtype=torch.float64) delta_t tensor(0.0595, dtype=torch.float64)
19 gae_duplicate tensor(-0.1423, dtype=torch.float64) tensor(-1.2609, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4052, dtype=torch.float64) delta_t tensor(0.0148, dtype=torch.float64)
18 gae_duplicate tensor(-0.0195, dtype=torch.float64) tensor(-0.2928, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3346, dtype=torch.float64) delta_t tensor(-0.0030, dtype=torch.float64)
17 gae_duplicate tensor(-0.2774, dtype=torch.float64) tensor(-0.0921, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4723, dtype=torch.float64) delta_t tensor(0.0673, dtype=torch.float64)
16 gae_duplicate tensor(-0.1724, dtype=torch.float64) tensor(-1.4506, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1360, dtype=torch.float64) delta_t tensor(-0.1178, dtype=torch.float64)
15 gae_duplicate tensor(-0.2313, dtype=torch.float64) tensor(2.0629, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4797, dtype=torch.float64) delta_t tensor(0.1191, dtype=torch.float64)
14 gae_duplicate tensor(-0.1049, dtype=torch.float64) tensor(-2.1426, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1126, dtype=torch.float64) delta_t tensor(-0.0931, dtype=torch.float64)
13 gae_duplicate tensor(-0.2688, dtype=torch.float64) tensor(1.6190, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4866, dtype=torch.float64) delta_t tensor(0.1220, dtype=torch.float64)
12 gae_duplicate tensor(0.0099, dtype=torch.float64) tensor(-2.0765, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1069, dtype=torch.float64) delta_t tensor(0.0134, dtype=torch.float64)
11 gae_duplicate tensor(-0.4073, dtype=torch.float64) tensor(-0.8740, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4714, dtype=torch.float64) delta_t tensor(0.0392, dtype=torch.float64)
10 gae_duplicate tensor(-0.1441, dtype=torch.float64) tensor(-0.7848, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0912, dtype=torch.float64) delta_t tensor(0.1575, dtype=torch.float64)
9 gae_duplicate tensor(-0.1085, dtype=torch.float64) tensor(-3.5758, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4507, dtype=torch.float64) delta_t tensor(0.0024, dtype=torch.float64)
8 gae_duplicate tensor(-0.0719, dtype=torch.float64) tensor(-0.4942, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0783, dtype=torch.float64) delta_t tensor(0.0904, dtype=torch.float64)
7 gae_duplicate tensor(-0.1369, dtype=torch.float64) tensor(-1.1889, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3645, dtype=torch.float64) delta_t tensor(0.0990, dtype=torch.float64)
6 gae_duplicate tensor(-0.0239, dtype=torch.float64) tensor(-2.0800, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1091, dtype=torch.float64) delta_t tensor(0.1603, dtype=torch.float64)
5 gae_duplicate tensor(-0.4922, dtype=torch.float64) tensor(-1.8594, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4562, dtype=torch.float64) delta_t tensor(-2.1688, dtype=torch.float64)
4 gae_duplicate tensor(-3.8605, dtype=torch.float64) tensor(37.7090, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1224, dtype=torch.float64) delta_t tensor(1.2854, dtype=torch.float64)
3 gae_duplicate tensor(0.6558, dtype=torch.float64) tensor(-19.9392, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1998, dtype=torch.float64) delta_t tensor(0.4830, dtype=torch.float64)
2 gae_duplicate tensor(0.3356, dtype=torch.float64) tensor(-11.6176, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:358.593505859375
value loss:81.25165557861328
entropies:339.5776672363281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.678191900253296 seconds
19 rew tensor(0.4137, dtype=torch.float64) delta_t tensor(0.1941, dtype=torch.float64)
19 gae_duplicate tensor(0.0301, dtype=torch.float64) tensor(-3.2467, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3954, dtype=torch.float64) delta_t tensor(-0.0106, dtype=torch.float64)
18 gae_duplicate tensor(-0.0824, dtype=torch.float64) tensor(-0.1262, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3461, dtype=torch.float64) delta_t tensor(0.2678, dtype=torch.float64)
17 gae_duplicate tensor(-0.1824, dtype=torch.float64) tensor(-5.0144, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4271, dtype=torch.float64) delta_t tensor(0.0086, dtype=torch.float64)
16 gae_duplicate tensor(-0.1020, dtype=torch.float64) tensor(-0.7087, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2383, dtype=torch.float64) delta_t tensor(0.0475, dtype=torch.float64)
15 gae_duplicate tensor(-0.2862, dtype=torch.float64) tensor(-0.5379, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4572, dtype=torch.float64) delta_t tensor(0.0505, dtype=torch.float64)
14 gae_duplicate tensor(-0.1178, dtype=torch.float64) tensor(-1.3343, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2168, dtype=torch.float64) delta_t tensor(-0.0210, dtype=torch.float64)
13 gae_duplicate tensor(-0.2543, dtype=torch.float64) tensor(0.3299, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4639, dtype=torch.float64) delta_t tensor(0.0696, dtype=torch.float64)
12 gae_duplicate tensor(-0.0275, dtype=torch.float64) tensor(-1.1849, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2023, dtype=torch.float64) delta_t tensor(0.0042, dtype=torch.float64)
11 gae_duplicate tensor(-0.2797, dtype=torch.float64) tensor(-0.3355, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4351, dtype=torch.float64) delta_t tensor(0.0485, dtype=torch.float64)
10 gae_duplicate tensor(-0.1063, dtype=torch.float64) tensor(-1.0237, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1027, dtype=torch.float64) delta_t tensor(-0.1202, dtype=torch.float64)
9 gae_duplicate tensor(-1.6902, dtype=torch.float64) tensor(1.5407, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4211, dtype=torch.float64) delta_t tensor(0.0274, dtype=torch.float64)
8 gae_duplicate tensor(-0.1290, dtype=torch.float64) tensor(-0.3140, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1751, dtype=torch.float64) delta_t tensor(-0.0469, dtype=torch.float64)
7 gae_duplicate tensor(-0.3799, dtype=torch.float64) tensor(0.5184, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1959, dtype=torch.float64) delta_t tensor(-0.0131, dtype=torch.float64)
6 gae_duplicate tensor(-0.8237, dtype=torch.float64) tensor(-0.3510, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0405, dtype=torch.float64) delta_t tensor(0.4129, dtype=torch.float64)
5 gae_duplicate tensor(-0.0325, dtype=torch.float64) tensor(-8.3450, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.2360, dtype=torch.float64) delta_t tensor(-3.2353, dtype=torch.float64)
4 gae_duplicate tensor(-4.7021, dtype=torch.float64) tensor(62.8597, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1003, dtype=torch.float64) delta_t tensor(1.2290, dtype=torch.float64)
3 gae_duplicate tensor(0.4846, dtype=torch.float64) tensor(-19.1180, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2339, dtype=torch.float64) delta_t tensor(0.4156, dtype=torch.float64)
2 gae_duplicate tensor(0.1959, dtype=torch.float64) tensor(-9.2165, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-868.9746704101562
value loss:123.84283447265625
entropies:340.04632568359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.196584939956665 seconds
19 rew tensor(0.4843, dtype=torch.float64) delta_t tensor(0.2703, dtype=torch.float64)
19 gae_duplicate tensor(0.0547, dtype=torch.float64) tensor(-5.6784, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3723, dtype=torch.float64) delta_t tensor(0.1389, dtype=torch.float64)
18 gae_duplicate tensor(-0.1773, dtype=torch.float64) tensor(-3.2364, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4359, dtype=torch.float64) delta_t tensor(0.2522, dtype=torch.float64)
17 gae_duplicate tensor(-0.0036, dtype=torch.float64) tensor(-5.8566, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3571, dtype=torch.float64) delta_t tensor(0.1965, dtype=torch.float64)
16 gae_duplicate tensor(-0.0920, dtype=torch.float64) tensor(-4.6121, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3807, dtype=torch.float64) delta_t tensor(0.2095, dtype=torch.float64)
15 gae_duplicate tensor(-0.0485, dtype=torch.float64) tensor(-4.5625, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3994, dtype=torch.float64) delta_t tensor(0.1807, dtype=torch.float64)
14 gae_duplicate tensor(-0.1181, dtype=torch.float64) tensor(-3.0724, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3565, dtype=torch.float64) delta_t tensor(0.1648, dtype=torch.float64)
13 gae_duplicate tensor(-0.1090, dtype=torch.float64) tensor(-2.9659, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4065, dtype=torch.float64) delta_t tensor(0.2805, dtype=torch.float64)
12 gae_duplicate tensor(-0.1810, dtype=torch.float64) tensor(-4.9022, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3571, dtype=torch.float64) delta_t tensor(0.1460, dtype=torch.float64)
11 gae_duplicate tensor(-0.1303, dtype=torch.float64) tensor(-3.0678, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3854, dtype=torch.float64) delta_t tensor(0.1928, dtype=torch.float64)
10 gae_duplicate tensor(-0.1543, dtype=torch.float64) tensor(-3.3368, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3902, dtype=torch.float64) delta_t tensor(-0.3197, dtype=torch.float64)
9 gae_duplicate tensor(-3.1916, dtype=torch.float64) tensor(7.9309, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1404, dtype=torch.float64) delta_t tensor(-0.2884, dtype=torch.float64)
8 gae_duplicate tensor(-2.0770, dtype=torch.float64) tensor(7.6026, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1994, dtype=torch.float64) delta_t tensor(0.2680, dtype=torch.float64)
7 gae_duplicate tensor(-0.0213, dtype=torch.float64) tensor(-4.2502, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1482, dtype=torch.float64) delta_t tensor(0.1803, dtype=torch.float64)
6 gae_duplicate tensor(-0.0608, dtype=torch.float64) tensor(-4.6749, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0112, dtype=torch.float64) delta_t tensor(0.4099, dtype=torch.float64)
5 gae_duplicate tensor(-0.1316, dtype=torch.float64) tensor(-8.7274, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8587, dtype=torch.float64) delta_t tensor(-1.8518, dtype=torch.float64)
4 gae_duplicate tensor(-3.4733, dtype=torch.float64) tensor(33.2077, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0293, dtype=torch.float64) delta_t tensor(1.1231, dtype=torch.float64)
3 gae_duplicate tensor(0.0880, dtype=torch.float64) tensor(-19.7121, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3363, dtype=torch.float64) delta_t tensor(0.4398, dtype=torch.float64)
2 gae_duplicate tensor(0.3410, dtype=torch.float64) tensor(-10.2338, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2075.998779296875
value loss:124.00089263916016
entropies:340.7813720703125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3895.0300)
ToM Target loss= tensor(3574.5811)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.980736970901489 seconds
19 rew tensor(0.2786, dtype=torch.float64) delta_t tensor(0.2153, dtype=torch.float64)
19 gae_duplicate tensor(-0.1944, dtype=torch.float64) tensor(-4.1782, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4651, dtype=torch.float64) delta_t tensor(0.1029, dtype=torch.float64)
18 gae_duplicate tensor(0.0465, dtype=torch.float64) tensor(-2.6369, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2563, dtype=torch.float64) delta_t tensor(0.0884, dtype=torch.float64)
17 gae_duplicate tensor(-0.1532, dtype=torch.float64) tensor(-2.0662, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4886, dtype=torch.float64) delta_t tensor(0.1504, dtype=torch.float64)
16 gae_duplicate tensor(-0.0421, dtype=torch.float64) tensor(-3.0749, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2199, dtype=torch.float64) delta_t tensor(-0.0273, dtype=torch.float64)
15 gae_duplicate tensor(-0.1522, dtype=torch.float64) tensor(0.3437, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4940, dtype=torch.float64) delta_t tensor(0.1727, dtype=torch.float64)
14 gae_duplicate tensor(0.0221, dtype=torch.float64) tensor(-3.2363, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2183, dtype=torch.float64) delta_t tensor(0.1914, dtype=torch.float64)
13 gae_duplicate tensor(-0.1187, dtype=torch.float64) tensor(-3.6521, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5030, dtype=torch.float64) delta_t tensor(0.0960, dtype=torch.float64)
12 gae_duplicate tensor(-0.0872, dtype=torch.float64) tensor(-2.0547, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2130, dtype=torch.float64) delta_t tensor(0.1812, dtype=torch.float64)
11 gae_duplicate tensor(-0.0729, dtype=torch.float64) tensor(-4.1384, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4751, dtype=torch.float64) delta_t tensor(0.1175, dtype=torch.float64)
10 gae_duplicate tensor(-0.0314, dtype=torch.float64) tensor(-2.6107, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2131, dtype=torch.float64) delta_t tensor(0.2561, dtype=torch.float64)
9 gae_duplicate tensor(-0.0723, dtype=torch.float64) tensor(-5.2618, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4603, dtype=torch.float64) delta_t tensor(0.1054, dtype=torch.float64)
8 gae_duplicate tensor(0.0599, dtype=torch.float64) tensor(-2.7338, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1854, dtype=torch.float64) delta_t tensor(0.1005, dtype=torch.float64)
7 gae_duplicate tensor(-0.1972, dtype=torch.float64) tensor(-2.1743, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3677, dtype=torch.float64) delta_t tensor(0.3229, dtype=torch.float64)
6 gae_duplicate tensor(0.2094, dtype=torch.float64) tensor(-6.1890, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0208, dtype=torch.float64) delta_t tensor(0.3639, dtype=torch.float64)
5 gae_duplicate tensor(-0.1815, dtype=torch.float64) tensor(-8.2844, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1306, dtype=torch.float64) delta_t tensor(-1.7351, dtype=torch.float64)
4 gae_duplicate tensor(-4.0738, dtype=torch.float64) tensor(28.7137, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1378, dtype=torch.float64) delta_t tensor(1.1963, dtype=torch.float64)
3 gae_duplicate tensor(0.3375, dtype=torch.float64) tensor(-21.5693, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2444, dtype=torch.float64) delta_t tensor(0.5135, dtype=torch.float64)
2 gae_duplicate tensor(0.3740, dtype=torch.float64) tensor(-12.9626, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3027.22802734375
value loss:73.74376678466797
entropies:341.2660827636719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7457849979400635 seconds
19 rew tensor(0.3532, dtype=torch.float64) delta_t tensor(0.1972, dtype=torch.float64)
19 gae_duplicate tensor(-0.1263, dtype=torch.float64) tensor(-3.7095, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4833, dtype=torch.float64) delta_t tensor(0.2205, dtype=torch.float64)
18 gae_duplicate tensor(0.0537, dtype=torch.float64) tensor(-4.6924, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3040, dtype=torch.float64) delta_t tensor(0.1818, dtype=torch.float64)
17 gae_duplicate tensor(-0.0932, dtype=torch.float64) tensor(-4.7949, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5145, dtype=torch.float64) delta_t tensor(0.1607, dtype=torch.float64)
16 gae_duplicate tensor(0.1242, dtype=torch.float64) tensor(-3.5011, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1634, dtype=torch.float64) delta_t tensor(0.2210, dtype=torch.float64)
15 gae_duplicate tensor(-0.0530, dtype=torch.float64) tensor(-3.6049, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5319, dtype=torch.float64) delta_t tensor(0.2012, dtype=torch.float64)
14 gae_duplicate tensor(0.1097, dtype=torch.float64) tensor(-4.3727, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1263, dtype=torch.float64) delta_t tensor(-0.0579, dtype=torch.float64)
13 gae_duplicate tensor(-0.1400, dtype=torch.float64) tensor(0.8144, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5456, dtype=torch.float64) delta_t tensor(0.3339, dtype=torch.float64)
12 gae_duplicate tensor(0.1608, dtype=torch.float64) tensor(-6.7615, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1266, dtype=torch.float64) delta_t tensor(-0.0627, dtype=torch.float64)
11 gae_duplicate tensor(-0.1276, dtype=torch.float64) tensor(0.4728, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5015, dtype=torch.float64) delta_t tensor(0.1785, dtype=torch.float64)
10 gae_duplicate tensor(0.1582, dtype=torch.float64) tensor(-3.4266, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0832, dtype=torch.float64) delta_t tensor(0.1790, dtype=torch.float64)
9 gae_duplicate tensor(-0.0743, dtype=torch.float64) tensor(-4.5878, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5029, dtype=torch.float64) delta_t tensor(0.1263, dtype=torch.float64)
8 gae_duplicate tensor(0.1056, dtype=torch.float64) tensor(-2.9270, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0613, dtype=torch.float64) delta_t tensor(-0.0685, dtype=torch.float64)
7 gae_duplicate tensor(-0.3184, dtype=torch.float64) tensor(0.7823, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4383, dtype=torch.float64) delta_t tensor(0.2611, dtype=torch.float64)
6 gae_duplicate tensor(0.2255, dtype=torch.float64) tensor(-4.7036, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1101, dtype=torch.float64) delta_t tensor(0.6162, dtype=torch.float64)
5 gae_duplicate tensor(-0.0592, dtype=torch.float64) tensor(-12.1986, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.8179, dtype=torch.float64) delta_t tensor(-2.8061, dtype=torch.float64)
4 gae_duplicate tensor(-5.8104, dtype=torch.float64) tensor(45.2124, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1032, dtype=torch.float64) delta_t tensor(1.0496, dtype=torch.float64)
3 gae_duplicate tensor(0.3066, dtype=torch.float64) tensor(-15.1380, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1033, dtype=torch.float64) delta_t tensor(0.4479, dtype=torch.float64)
2 gae_duplicate tensor(0.4468, dtype=torch.float64) tensor(-9.2039, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1870.0115966796875
value loss:135.30267333984375
entropies:342.1257629394531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.114905118942261 seconds
19 rew tensor(0.3875, dtype=torch.float64) delta_t tensor(0.1756, dtype=torch.float64)
19 gae_duplicate tensor(-0.0820, dtype=torch.float64) tensor(-3.6539, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4762, dtype=torch.float64) delta_t tensor(0.2578, dtype=torch.float64)
18 gae_duplicate tensor(-0.0345, dtype=torch.float64) tensor(-4.1726, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3614, dtype=torch.float64) delta_t tensor(0.4006, dtype=torch.float64)
17 gae_duplicate tensor(-0.0656, dtype=torch.float64) tensor(-8.4219, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4491, dtype=torch.float64) delta_t tensor(0.2638, dtype=torch.float64)
16 gae_duplicate tensor(-0.0125, dtype=torch.float64) tensor(-5.7787, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3210, dtype=torch.float64) delta_t tensor(0.3242, dtype=torch.float64)
15 gae_duplicate tensor(-0.0546, dtype=torch.float64) tensor(-5.4513, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4836, dtype=torch.float64) delta_t tensor(0.2390, dtype=torch.float64)
14 gae_duplicate tensor(-0.0310, dtype=torch.float64) tensor(-5.4308, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2551, dtype=torch.float64) delta_t tensor(0.3859, dtype=torch.float64)
13 gae_duplicate tensor(-0.0033, dtype=torch.float64) tensor(-8.0917, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4840, dtype=torch.float64) delta_t tensor(0.2618, dtype=torch.float64)
12 gae_duplicate tensor(0.1040, dtype=torch.float64) tensor(-5.0744, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2557, dtype=torch.float64) delta_t tensor(0.2896, dtype=torch.float64)
11 gae_duplicate tensor(-0.0188, dtype=torch.float64) tensor(-6.2941, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4553, dtype=torch.float64) delta_t tensor(0.2566, dtype=torch.float64)
10 gae_duplicate tensor(-0.0727, dtype=torch.float64) tensor(-5.5013, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1841, dtype=torch.float64) delta_t tensor(-0.0002, dtype=torch.float64)
9 gae_duplicate tensor(-0.6980, dtype=torch.float64) tensor(-0.5277, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0156, dtype=torch.float64) delta_t tensor(-0.1836, dtype=torch.float64)
8 gae_duplicate tensor(-1.4445, dtype=torch.float64) tensor(2.5905, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0844, dtype=torch.float64) delta_t tensor(-0.0073, dtype=torch.float64)
7 gae_duplicate tensor(-0.8275, dtype=torch.float64) tensor(0.4220, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0862, dtype=torch.float64) delta_t tensor(0.0696, dtype=torch.float64)
6 gae_duplicate tensor(-0.7593, dtype=torch.float64) tensor(-1.1829, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2927, dtype=torch.float64) delta_t tensor(0.0039, dtype=torch.float64)
5 gae_duplicate tensor(-1.3993, dtype=torch.float64) tensor(-1.2520, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4834, dtype=torch.float64) delta_t tensor(-1.0852, dtype=torch.float64)
4 gae_duplicate tensor(-5.1295, dtype=torch.float64) tensor(22.5731, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0200, dtype=torch.float64) delta_t tensor(0.8432, dtype=torch.float64)
3 gae_duplicate tensor(-0.0792, dtype=torch.float64) tensor(-14.9414, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2100, dtype=torch.float64) delta_t tensor(0.4806, dtype=torch.float64)
2 gae_duplicate tensor(0.3988, dtype=torch.float64) tensor(-10.9761, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3210.22900390625
value loss:90.17240142822266
entropies:343.3050231933594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.797871112823486 seconds
19 rew tensor(0.4050, dtype=torch.float64) delta_t tensor(0.0723, dtype=torch.float64)
19 gae_duplicate tensor(-0.1525, dtype=torch.float64) tensor(-1.8222, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4402, dtype=torch.float64) delta_t tensor(0.0694, dtype=torch.float64)
18 gae_duplicate tensor(-0.0609, dtype=torch.float64) tensor(-1.5737, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2944, dtype=torch.float64) delta_t tensor(0.2663, dtype=torch.float64)
17 gae_duplicate tensor(-0.1160, dtype=torch.float64) tensor(-5.2854, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5259, dtype=torch.float64) delta_t tensor(0.1369, dtype=torch.float64)
16 gae_duplicate tensor(0.0991, dtype=torch.float64) tensor(-3.4154, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0970, dtype=torch.float64) delta_t tensor(0.0193, dtype=torch.float64)
15 gae_duplicate tensor(-0.2574, dtype=torch.float64) tensor(-1.1099, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5384, dtype=torch.float64) delta_t tensor(0.1503, dtype=torch.float64)
14 gae_duplicate tensor(0.0744, dtype=torch.float64) tensor(-2.9070, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0160, dtype=torch.float64) delta_t tensor(0.0305, dtype=torch.float64)
13 gae_duplicate tensor(-0.2271, dtype=torch.float64) tensor(-0.9564, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5462, dtype=torch.float64) delta_t tensor(0.1127, dtype=torch.float64)
12 gae_duplicate tensor(0.0351, dtype=torch.float64) tensor(-2.1061, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0105, dtype=torch.float64) delta_t tensor(-0.1414, dtype=torch.float64)
11 gae_duplicate tensor(-0.2161, dtype=torch.float64) tensor(2.5977, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5110, dtype=torch.float64) delta_t tensor(0.1605, dtype=torch.float64)
10 gae_duplicate tensor(0.0995, dtype=torch.float64) tensor(-2.9372, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0039, dtype=torch.float64) delta_t tensor(0.2171, dtype=torch.float64)
9 gae_duplicate tensor(-0.0990, dtype=torch.float64) tensor(-4.6275, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4766, dtype=torch.float64) delta_t tensor(0.0496, dtype=torch.float64)
8 gae_duplicate tensor(-0.0035, dtype=torch.float64) tensor(-1.3954, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0444, dtype=torch.float64) delta_t tensor(-0.0825, dtype=torch.float64)
7 gae_duplicate tensor(-0.3973, dtype=torch.float64) tensor(0.8917, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4256, dtype=torch.float64) delta_t tensor(0.2173, dtype=torch.float64)
6 gae_duplicate tensor(0.1918, dtype=torch.float64) tensor(-4.0801, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2427, dtype=torch.float64) delta_t tensor(0.3669, dtype=torch.float64)
5 gae_duplicate tensor(-0.2303, dtype=torch.float64) tensor(-6.3614, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9246, dtype=torch.float64) delta_t tensor(-2.2823, dtype=torch.float64)
4 gae_duplicate tensor(-4.7347, dtype=torch.float64) tensor(48.9153, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1164, dtype=torch.float64) delta_t tensor(0.9377, dtype=torch.float64)
3 gae_duplicate tensor(0.0436, dtype=torch.float64) tensor(-12.7758, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1295, dtype=torch.float64) delta_t tensor(0.4752, dtype=torch.float64)
2 gae_duplicate tensor(0.3177, dtype=torch.float64) tensor(-9.7676, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:377.7613525390625
value loss:98.6443099975586
entropies:344.186279296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.17493462562561 seconds
19 rew tensor(0.4173, dtype=torch.float64) delta_t tensor(0.0108, dtype=torch.float64)
19 gae_duplicate tensor(-0.1648, dtype=torch.float64) tensor(-0.2978, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4312, dtype=torch.float64) delta_t tensor(0.0527, dtype=torch.float64)
18 gae_duplicate tensor(-0.1159, dtype=torch.float64) tensor(-1.1938, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3618, dtype=torch.float64) delta_t tensor(0.1411, dtype=torch.float64)
17 gae_duplicate tensor(-0.1091, dtype=torch.float64) tensor(-2.9014, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5068, dtype=torch.float64) delta_t tensor(0.0266, dtype=torch.float64)
16 gae_duplicate tensor(-0.0978, dtype=torch.float64) tensor(-0.5891, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1169, dtype=torch.float64) delta_t tensor(-0.0262, dtype=torch.float64)
15 gae_duplicate tensor(-0.3367, dtype=torch.float64) tensor(0.3538, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5275, dtype=torch.float64) delta_t tensor(0.1294, dtype=torch.float64)
14 gae_duplicate tensor(-0.0005, dtype=torch.float64) tensor(-2.3162, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0865, dtype=torch.float64) delta_t tensor(0.0335, dtype=torch.float64)
13 gae_duplicate tensor(-0.2132, dtype=torch.float64) tensor(-0.5117, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5472, dtype=torch.float64) delta_t tensor(0.0578, dtype=torch.float64)
12 gae_duplicate tensor(0.0177, dtype=torch.float64) tensor(-1.3540, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0328, dtype=torch.float64) delta_t tensor(0.0804, dtype=torch.float64)
11 gae_duplicate tensor(-0.1963, dtype=torch.float64) tensor(-1.0031, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5186, dtype=torch.float64) delta_t tensor(0.0956, dtype=torch.float64)
10 gae_duplicate tensor(0.0602, dtype=torch.float64) tensor(-1.9886, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0342, dtype=torch.float64) delta_t tensor(0.1325, dtype=torch.float64)
9 gae_duplicate tensor(-0.1711, dtype=torch.float64) tensor(-2.4207, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5042, dtype=torch.float64) delta_t tensor(0.0294, dtype=torch.float64)
8 gae_duplicate tensor(-0.0472, dtype=torch.float64) tensor(-0.9424, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0059, dtype=torch.float64) delta_t tensor(0.0151, dtype=torch.float64)
7 gae_duplicate tensor(-0.3601, dtype=torch.float64) tensor(-0.1198, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3679, dtype=torch.float64) delta_t tensor(0.1400, dtype=torch.float64)
6 gae_duplicate tensor(0.0389, dtype=torch.float64) tensor(-2.6055, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2312, dtype=torch.float64) delta_t tensor(0.3397, dtype=torch.float64)
5 gae_duplicate tensor(-0.3580, dtype=torch.float64) tensor(-6.6283, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4234, dtype=torch.float64) delta_t tensor(-1.8860, dtype=torch.float64)
4 gae_duplicate tensor(-3.1367, dtype=torch.float64) tensor(31.0382, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1159, dtype=torch.float64) delta_t tensor(1.0051, dtype=torch.float64)
3 gae_duplicate tensor(0.3755, dtype=torch.float64) tensor(-14.1565, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1232, dtype=torch.float64) delta_t tensor(0.3718, dtype=torch.float64)
2 gae_duplicate tensor(0.0970, dtype=torch.float64) tensor(-8.5387, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:780.4752807617188
value loss:66.93460845947266
entropies:344.4827880859375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3892.4309)
ToM Target loss= tensor(3551.6082)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.963020086288452 seconds
19 rew tensor(0.3599, dtype=torch.float64) delta_t tensor(-0.1159, dtype=torch.float64)
19 gae_duplicate tensor(-0.2253, dtype=torch.float64) tensor(2.0480, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4230, dtype=torch.float64) delta_t tensor(-0.0504, dtype=torch.float64)
18 gae_duplicate tensor(-0.1186, dtype=torch.float64) tensor(1.0832, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3021, dtype=torch.float64) delta_t tensor(-0.0684, dtype=torch.float64)
17 gae_duplicate tensor(-0.1820, dtype=torch.float64) tensor(1.2399, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4661, dtype=torch.float64) delta_t tensor(-0.0385, dtype=torch.float64)
16 gae_duplicate tensor(-0.2380, dtype=torch.float64) tensor(0.9143, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1962, dtype=torch.float64) delta_t tensor(-0.1641, dtype=torch.float64)
15 gae_duplicate tensor(-0.2822, dtype=torch.float64) tensor(3.1622, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4885, dtype=torch.float64) delta_t tensor(0.0125, dtype=torch.float64)
14 gae_duplicate tensor(-0.1649, dtype=torch.float64) tensor(0.2422, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2052, dtype=torch.float64) delta_t tensor(-0.1522, dtype=torch.float64)
13 gae_duplicate tensor(-0.2564, dtype=torch.float64) tensor(2.7297, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4755, dtype=torch.float64) delta_t tensor(-0.0152, dtype=torch.float64)
12 gae_duplicate tensor(-0.2072, dtype=torch.float64) tensor(0.6152, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1712, dtype=torch.float64) delta_t tensor(-0.1963, dtype=torch.float64)
11 gae_duplicate tensor(-0.3163, dtype=torch.float64) tensor(3.7450, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4607, dtype=torch.float64) delta_t tensor(0.0040, dtype=torch.float64)
10 gae_duplicate tensor(-0.2155, dtype=torch.float64) tensor(0.2974, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1576, dtype=torch.float64) delta_t tensor(-0.1175, dtype=torch.float64)
9 gae_duplicate tensor(-0.3046, dtype=torch.float64) tensor(2.5575, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4459, dtype=torch.float64) delta_t tensor(-0.0421, dtype=torch.float64)
8 gae_duplicate tensor(-0.1304, dtype=torch.float64) tensor(0.9015, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1369, dtype=torch.float64) delta_t tensor(0.0545, dtype=torch.float64)
7 gae_duplicate tensor(-0.2442, dtype=torch.float64) tensor(-0.6827, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3733, dtype=torch.float64) delta_t tensor(0.0794, dtype=torch.float64)
6 gae_duplicate tensor(-0.0504, dtype=torch.float64) tensor(-1.4779, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0524, dtype=torch.float64) delta_t tensor(-0.0127, dtype=torch.float64)
5 gae_duplicate tensor(-0.3952, dtype=torch.float64) tensor(0.2615, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1817, dtype=torch.float64) delta_t tensor(-1.6104, dtype=torch.float64)
4 gae_duplicate tensor(-4.5725, dtype=torch.float64) tensor(27.7528, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1338, dtype=torch.float64) delta_t tensor(1.0274, dtype=torch.float64)
3 gae_duplicate tensor(0.2570, dtype=torch.float64) tensor(-17.6167, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2098, dtype=torch.float64) delta_t tensor(0.1333, dtype=torch.float64)
2 gae_duplicate tensor(0.0857, dtype=torch.float64) tensor(-3.8476, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1385.16162109375
value loss:60.87881088256836
entropies:345.0926818847656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.225186824798584 seconds
19 rew tensor(0.4879, dtype=torch.float64) delta_t tensor(0.0012, dtype=torch.float64)
19 gae_duplicate tensor(-0.2065, dtype=torch.float64) tensor(-0.1923, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3574, dtype=torch.float64) delta_t tensor(-0.1410, dtype=torch.float64)
18 gae_duplicate tensor(-0.2259, dtype=torch.float64) tensor(2.8528, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4160, dtype=torch.float64) delta_t tensor(0.0804, dtype=torch.float64)
17 gae_duplicate tensor(-0.2037, dtype=torch.float64) tensor(-1.1556, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3883, dtype=torch.float64) delta_t tensor(-0.1380, dtype=torch.float64)
16 gae_duplicate tensor(-0.2917, dtype=torch.float64) tensor(2.1253, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3631, dtype=torch.float64) delta_t tensor(-0.1135, dtype=torch.float64)
15 gae_duplicate tensor(-0.2504, dtype=torch.float64) tensor(2.5343, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4090, dtype=torch.float64) delta_t tensor(-0.0475, dtype=torch.float64)
14 gae_duplicate tensor(-0.1817, dtype=torch.float64) tensor(1.3114, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3721, dtype=torch.float64) delta_t tensor(-0.0915, dtype=torch.float64)
13 gae_duplicate tensor(-0.2784, dtype=torch.float64) tensor(1.7541, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3783, dtype=torch.float64) delta_t tensor(-0.1216, dtype=torch.float64)
12 gae_duplicate tensor(-0.2508, dtype=torch.float64) tensor(2.4967, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3267, dtype=torch.float64) delta_t tensor(-0.0282, dtype=torch.float64)
11 gae_duplicate tensor(-0.3335, dtype=torch.float64) tensor(0.4933, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3964, dtype=torch.float64) delta_t tensor(-0.1024, dtype=torch.float64)
10 gae_duplicate tensor(-0.2635, dtype=torch.float64) tensor(2.1717, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2819, dtype=torch.float64) delta_t tensor(-0.0717, dtype=torch.float64)
9 gae_duplicate tensor(-0.3203, dtype=torch.float64) tensor(1.5832, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3668, dtype=torch.float64) delta_t tensor(-0.0918, dtype=torch.float64)
8 gae_duplicate tensor(-0.1731, dtype=torch.float64) tensor(1.9550, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2677, dtype=torch.float64) delta_t tensor(-0.1080, dtype=torch.float64)
7 gae_duplicate tensor(-0.5171, dtype=torch.float64) tensor(1.9057, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2869, dtype=torch.float64) delta_t tensor(0.0200, dtype=torch.float64)
6 gae_duplicate tensor(-0.0678, dtype=torch.float64) tensor(-0.1916, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0334, dtype=torch.float64) delta_t tensor(0.0776, dtype=torch.float64)
5 gae_duplicate tensor(-0.2513, dtype=torch.float64) tensor(-0.8656, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8141, dtype=torch.float64) delta_t tensor(-1.7985, dtype=torch.float64)
4 gae_duplicate tensor(-3.3246, dtype=torch.float64) tensor(35.4342, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0525, dtype=torch.float64) delta_t tensor(0.9903, dtype=torch.float64)
3 gae_duplicate tensor(0.3403, dtype=torch.float64) tensor(-15.4524, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2523, dtype=torch.float64) delta_t tensor(0.2333, dtype=torch.float64)
2 gae_duplicate tensor(0.1401, dtype=torch.float64) tensor(-5.4678, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1891.2105712890625
value loss:67.95938110351562
entropies:346.01031494140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.914840221405029 seconds
19 rew tensor(0.4091, dtype=torch.float64) delta_t tensor(-0.0468, dtype=torch.float64)
19 gae_duplicate tensor(-0.2963, dtype=torch.float64) tensor(0.5567, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5212, dtype=torch.float64) delta_t tensor(-0.0320, dtype=torch.float64)
18 gae_duplicate tensor(-0.2043, dtype=torch.float64) tensor(0.2775, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3396, dtype=torch.float64) delta_t tensor(-0.0163, dtype=torch.float64)
17 gae_duplicate tensor(-0.2560, dtype=torch.float64) tensor(0.5223, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5392, dtype=torch.float64) delta_t tensor(0.0180, dtype=torch.float64)
16 gae_duplicate tensor(-0.1177, dtype=torch.float64) tensor(-0.2738, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1673, dtype=torch.float64) delta_t tensor(-0.1616, dtype=torch.float64)
15 gae_duplicate tensor(-0.3084, dtype=torch.float64) tensor(3.2514, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3542, dtype=torch.float64) delta_t tensor(-0.1521, dtype=torch.float64)
14 gae_duplicate tensor(-0.9830, dtype=torch.float64) tensor(2.6849, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0927, dtype=torch.float64) delta_t tensor(-0.1506, dtype=torch.float64)
13 gae_duplicate tensor(-0.3740, dtype=torch.float64) tensor(3.6926, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5255, dtype=torch.float64) delta_t tensor(-0.0204, dtype=torch.float64)
12 gae_duplicate tensor(-0.0971, dtype=torch.float64) tensor(0.7751, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0782, dtype=torch.float64) delta_t tensor(-0.1795, dtype=torch.float64)
11 gae_duplicate tensor(-0.3236, dtype=torch.float64) tensor(3.4366, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5328, dtype=torch.float64) delta_t tensor(0.0027, dtype=torch.float64)
10 gae_duplicate tensor(-0.0710, dtype=torch.float64) tensor(0.2941, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0568, dtype=torch.float64) delta_t tensor(-0.1340, dtype=torch.float64)
9 gae_duplicate tensor(-0.4313, dtype=torch.float64) tensor(2.2927, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4888, dtype=torch.float64) delta_t tensor(-0.0579, dtype=torch.float64)
8 gae_duplicate tensor(-0.1426, dtype=torch.float64) tensor(1.2910, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0205, dtype=torch.float64) delta_t tensor(-0.0803, dtype=torch.float64)
7 gae_duplicate tensor(-0.5489, dtype=torch.float64) tensor(1.5464, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2129, dtype=torch.float64) delta_t tensor(-0.0843, dtype=torch.float64)
6 gae_duplicate tensor(-0.8117, dtype=torch.float64) tensor(1.9571, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2102, dtype=torch.float64) delta_t tensor(-0.0955, dtype=torch.float64)
5 gae_duplicate tensor(-0.4889, dtype=torch.float64) tensor(1.9222, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.7331, dtype=torch.float64) delta_t tensor(-2.1793, dtype=torch.float64)
4 gae_duplicate tensor(-5.1350, dtype=torch.float64) tensor(42.1817, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0899, dtype=torch.float64) delta_t tensor(0.5123, dtype=torch.float64)
3 gae_duplicate tensor(-0.4455, dtype=torch.float64) tensor(-5.3606, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2591, dtype=torch.float64) delta_t tensor(0.0359, dtype=torch.float64)
2 gae_duplicate tensor(-0.1517, dtype=torch.float64) tensor(-1.5717, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3305.2783203125
value loss:107.05506896972656
entropies:346.50494384765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9748008251190186 seconds
19 rew tensor(0.4211, dtype=torch.float64) delta_t tensor(0.1028, dtype=torch.float64)
19 gae_duplicate tensor(-0.3426, dtype=torch.float64) tensor(-2.6763, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4233, dtype=torch.float64) delta_t tensor(-0.0679, dtype=torch.float64)
18 gae_duplicate tensor(-0.2162, dtype=torch.float64) tensor(0.9786, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3510, dtype=torch.float64) delta_t tensor(0.0735, dtype=torch.float64)
17 gae_duplicate tensor(-0.2809, dtype=torch.float64) tensor(-1.0522, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4301, dtype=torch.float64) delta_t tensor(-0.0763, dtype=torch.float64)
16 gae_duplicate tensor(-0.2217, dtype=torch.float64) tensor(1.2961, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1481, dtype=torch.float64) delta_t tensor(0.0052, dtype=torch.float64)
15 gae_duplicate tensor(-0.2855, dtype=torch.float64) tensor(0.4589, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4879, dtype=torch.float64) delta_t tensor(0.0084, dtype=torch.float64)
14 gae_duplicate tensor(-0.1184, dtype=torch.float64) tensor(-0.0549, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0964, dtype=torch.float64) delta_t tensor(-0.1845, dtype=torch.float64)
13 gae_duplicate tensor(-0.3157, dtype=torch.float64) tensor(3.8866, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4948, dtype=torch.float64) delta_t tensor(-0.0448, dtype=torch.float64)
12 gae_duplicate tensor(-0.2340, dtype=torch.float64) tensor(1.2812, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0885, dtype=torch.float64) delta_t tensor(-0.1321, dtype=torch.float64)
11 gae_duplicate tensor(-0.3733, dtype=torch.float64) tensor(2.3127, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4743, dtype=torch.float64) delta_t tensor(0.0053, dtype=torch.float64)
10 gae_duplicate tensor(-0.2152, dtype=torch.float64) tensor(0.0396, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0833, dtype=torch.float64) delta_t tensor(0.0426, dtype=torch.float64)
9 gae_duplicate tensor(-0.3776, dtype=torch.float64) tensor(-0.6042, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4071, dtype=torch.float64) delta_t tensor(-0.0941, dtype=torch.float64)
8 gae_duplicate tensor(-0.1857, dtype=torch.float64) tensor(1.6251, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0098, dtype=torch.float64) delta_t tensor(-0.0905, dtype=torch.float64)
7 gae_duplicate tensor(-0.4414, dtype=torch.float64) tensor(2.1147, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0845, dtype=torch.float64) delta_t tensor(-0.1841, dtype=torch.float64)
6 gae_duplicate tensor(-1.6793, dtype=torch.float64) tensor(3.9132, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6841, dtype=torch.float64) delta_t tensor(-0.3693, dtype=torch.float64)
5 gae_duplicate tensor(-2.7792, dtype=torch.float64) tensor(7.9235, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.7621, dtype=torch.float64) delta_t tensor(-2.3057, dtype=torch.float64)
4 gae_duplicate tensor(-5.9915, dtype=torch.float64) tensor(46.0364, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0318, dtype=torch.float64) delta_t tensor(0.4117, dtype=torch.float64)
3 gae_duplicate tensor(-0.4703, dtype=torch.float64) tensor(-3.0343, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1833, dtype=torch.float64) delta_t tensor(0.1966, dtype=torch.float64)
2 gae_duplicate tensor(-0.0943, dtype=torch.float64) tensor(-4.3755, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3337.484130859375
value loss:145.6230926513672
entropies:347.200439453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.760419130325317 seconds
19 rew tensor(0.4560, dtype=torch.float64) delta_t tensor(0.1146, dtype=torch.float64)
19 gae_duplicate tensor(-0.2061, dtype=torch.float64) tensor(-2.5851, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3731, dtype=torch.float64) delta_t tensor(0.0294, dtype=torch.float64)
18 gae_duplicate tensor(-0.1738, dtype=torch.float64) tensor(-0.6634, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3892, dtype=torch.float64) delta_t tensor(0.2498, dtype=torch.float64)
17 gae_duplicate tensor(-0.1925, dtype=torch.float64) tensor(-5.5829, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4345, dtype=torch.float64) delta_t tensor(0.0826, dtype=torch.float64)
16 gae_duplicate tensor(-0.1225, dtype=torch.float64) tensor(-1.9823, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2733, dtype=torch.float64) delta_t tensor(0.0990, dtype=torch.float64)
15 gae_duplicate tensor(-0.2219, dtype=torch.float64) tensor(-2.4533, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4271, dtype=torch.float64) delta_t tensor(0.1515, dtype=torch.float64)
14 gae_duplicate tensor(-0.1169, dtype=torch.float64) tensor(-3.3324, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2833, dtype=torch.float64) delta_t tensor(0.0623, dtype=torch.float64)
13 gae_duplicate tensor(-0.2960, dtype=torch.float64) tensor(-0.7555, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4482, dtype=torch.float64) delta_t tensor(0.1067, dtype=torch.float64)
12 gae_duplicate tensor(-0.1520, dtype=torch.float64) tensor(-2.0695, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2838, dtype=torch.float64) delta_t tensor(0.0497, dtype=torch.float64)
11 gae_duplicate tensor(-0.2614, dtype=torch.float64) tensor(-1.3307, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4341, dtype=torch.float64) delta_t tensor(0.1227, dtype=torch.float64)
10 gae_duplicate tensor(-0.1298, dtype=torch.float64) tensor(-2.0425, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6636, dtype=torch.float64) delta_t tensor(-0.7837, dtype=torch.float64)
9 gae_duplicate tensor(-1.8977, dtype=torch.float64) tensor(16.2259, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7730, dtype=torch.float64) delta_t tensor(-0.9134, dtype=torch.float64)
8 gae_duplicate tensor(-5.6953, dtype=torch.float64) tensor(18.0685, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1980, dtype=torch.float64) delta_t tensor(0.0385, dtype=torch.float64)
7 gae_duplicate tensor(-0.5699, dtype=torch.float64) tensor(1.0277, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2539, dtype=torch.float64) delta_t tensor(0.0815, dtype=torch.float64)
6 gae_duplicate tensor(-0.0202, dtype=torch.float64) tensor(-1.4772, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0313, dtype=torch.float64) delta_t tensor(0.2571, dtype=torch.float64)
5 gae_duplicate tensor(-0.2349, dtype=torch.float64) tensor(-6.5040, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0214, dtype=torch.float64) delta_t tensor(-0.9292, dtype=torch.float64)
4 gae_duplicate tensor(-2.8135, dtype=torch.float64) tensor(20.1059, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0151, dtype=torch.float64) delta_t tensor(0.7338, dtype=torch.float64)
3 gae_duplicate tensor(0.0771, dtype=torch.float64) tensor(-11.2394, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3170, dtype=torch.float64) delta_t tensor(0.2383, dtype=torch.float64)
2 gae_duplicate tensor(-0.0215, dtype=torch.float64) tensor(-6.0094, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-493.44952392578125
value loss:104.8819808959961
entropies:347.48199462890625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3893.4263)
ToM Target loss= tensor(3562.4919)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.254928827285767 seconds
19 rew tensor(0.3953, dtype=torch.float64) delta_t tensor(0.0717, dtype=torch.float64)
19 gae_duplicate tensor(-0.1462, dtype=torch.float64) tensor(-1.3625, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5479, dtype=torch.float64) delta_t tensor(0.1313, dtype=torch.float64)
18 gae_duplicate tensor(-0.0285, dtype=torch.float64) tensor(-2.2915, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3110, dtype=torch.float64) delta_t tensor(0.0306, dtype=torch.float64)
17 gae_duplicate tensor(-0.0647, dtype=torch.float64) tensor(-0.8372, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5393, dtype=torch.float64) delta_t tensor(0.1014, dtype=torch.float64)
16 gae_duplicate tensor(0.0166, dtype=torch.float64) tensor(-2.2052, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1821, dtype=torch.float64) delta_t tensor(-0.0815, dtype=torch.float64)
15 gae_duplicate tensor(-0.1459, dtype=torch.float64) tensor(1.3782, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5406, dtype=torch.float64) delta_t tensor(0.1496, dtype=torch.float64)
14 gae_duplicate tensor(0.0435, dtype=torch.float64) tensor(-2.8468, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1883, dtype=torch.float64) delta_t tensor(-0.0095, dtype=torch.float64)
13 gae_duplicate tensor(-0.0464, dtype=torch.float64) tensor(-0.2306, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5153, dtype=torch.float64) delta_t tensor(0.1545, dtype=torch.float64)
12 gae_duplicate tensor(0.0057, dtype=torch.float64) tensor(-3.1290, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1596, dtype=torch.float64) delta_t tensor(-0.0912, dtype=torch.float64)
11 gae_duplicate tensor(-0.2800, dtype=torch.float64) tensor(1.4118, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5194, dtype=torch.float64) delta_t tensor(0.1000, dtype=torch.float64)
10 gae_duplicate tensor(0.0435, dtype=torch.float64) tensor(-1.8429, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1498, dtype=torch.float64) delta_t tensor(-0.0977, dtype=torch.float64)
9 gae_duplicate tensor(-0.4636, dtype=torch.float64) tensor(1.4590, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4505, dtype=torch.float64) delta_t tensor(0.0480, dtype=torch.float64)
8 gae_duplicate tensor(-0.1281, dtype=torch.float64) tensor(-0.7752, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0672, dtype=torch.float64) delta_t tensor(-0.0103, dtype=torch.float64)
7 gae_duplicate tensor(-0.1786, dtype=torch.float64) tensor(0.2767, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4165, dtype=torch.float64) delta_t tensor(0.2223, dtype=torch.float64)
6 gae_duplicate tensor(0.1636, dtype=torch.float64) tensor(-4.6297, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1819, dtype=torch.float64) delta_t tensor(-0.0150, dtype=torch.float64)
5 gae_duplicate tensor(-0.4482, dtype=torch.float64) tensor(-0.2653, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8374, dtype=torch.float64) delta_t tensor(-1.0528, dtype=torch.float64)
4 gae_duplicate tensor(-3.4331, dtype=torch.float64) tensor(20.7361, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1515, dtype=torch.float64) delta_t tensor(0.8277, dtype=torch.float64)
3 gae_duplicate tensor(0.0671, dtype=torch.float64) tensor(-14.2757, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2131, dtype=torch.float64) delta_t tensor(0.0820, dtype=torch.float64)
2 gae_duplicate tensor(-0.1475, dtype=torch.float64) tensor(-2.8368, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:568.5904541015625
value loss:37.80207061767578
entropies:347.4118957519531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.07042121887207 seconds
19 rew tensor(0.3154, dtype=torch.float64) delta_t tensor(0.0343, dtype=torch.float64)
19 gae_duplicate tensor(-0.0626, dtype=torch.float64) tensor(-0.6166, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4418, dtype=torch.float64) delta_t tensor(0.0046, dtype=torch.float64)
18 gae_duplicate tensor(-0.0508, dtype=torch.float64) tensor(-0.1879, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2104, dtype=torch.float64) delta_t tensor(0.0173, dtype=torch.float64)
17 gae_duplicate tensor(-0.0575, dtype=torch.float64) tensor(-0.3602, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5474, dtype=torch.float64) delta_t tensor(0.1141, dtype=torch.float64)
16 gae_duplicate tensor(0.0709, dtype=torch.float64) tensor(-2.0842, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0764, dtype=torch.float64) delta_t tensor(-0.0575, dtype=torch.float64)
15 gae_duplicate tensor(-0.1373, dtype=torch.float64) tensor(0.8300, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5249, dtype=torch.float64) delta_t tensor(0.2103, dtype=torch.float64)
14 gae_duplicate tensor(0.0686, dtype=torch.float64) tensor(-3.7852, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0995, dtype=torch.float64) delta_t tensor(-0.0500, dtype=torch.float64)
13 gae_duplicate tensor(-0.1092, dtype=torch.float64) tensor(0.6475, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5208, dtype=torch.float64) delta_t tensor(0.1365, dtype=torch.float64)
12 gae_duplicate tensor(0.0664, dtype=torch.float64) tensor(-2.6801, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0594, dtype=torch.float64) delta_t tensor(-0.0631, dtype=torch.float64)
11 gae_duplicate tensor(-0.1439, dtype=torch.float64) tensor(0.9159, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5246, dtype=torch.float64) delta_t tensor(0.1889, dtype=torch.float64)
10 gae_duplicate tensor(0.0860, dtype=torch.float64) tensor(-3.8771, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0241, dtype=torch.float64) delta_t tensor(-0.0089, dtype=torch.float64)
9 gae_duplicate tensor(-0.2109, dtype=torch.float64) tensor(-0.5423, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5045, dtype=torch.float64) delta_t tensor(0.0967, dtype=torch.float64)
8 gae_duplicate tensor(0.0456, dtype=torch.float64) tensor(-1.7403, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0038, dtype=torch.float64) delta_t tensor(0.0673, dtype=torch.float64)
7 gae_duplicate tensor(-0.2991, dtype=torch.float64) tensor(-1.6209, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4251, dtype=torch.float64) delta_t tensor(0.2379, dtype=torch.float64)
6 gae_duplicate tensor(0.1957, dtype=torch.float64) tensor(-4.7253, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2990, dtype=torch.float64) delta_t tensor(-0.0498, dtype=torch.float64)
5 gae_duplicate tensor(-0.8580, dtype=torch.float64) tensor(0.8821, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5452, dtype=torch.float64) delta_t tensor(-1.4190, dtype=torch.float64)
4 gae_duplicate tensor(-4.0291, dtype=torch.float64) tensor(25.4548, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1573, dtype=torch.float64) delta_t tensor(0.6811, dtype=torch.float64)
3 gae_duplicate tensor(-0.0320, dtype=torch.float64) tensor(-10.0530, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1639, dtype=torch.float64) delta_t tensor(0.2153, dtype=torch.float64)
2 gae_duplicate tensor(0.1649, dtype=torch.float64) tensor(-5.1731, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:376.8172302246094
value loss:57.403175354003906
entropies:347.5406188964844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.874585151672363 seconds
19 rew tensor(0.3604, dtype=torch.float64) delta_t tensor(0.0583, dtype=torch.float64)
19 gae_duplicate tensor(-0.0981, dtype=torch.float64) tensor(-1.1402, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4442, dtype=torch.float64) delta_t tensor(0.1279, dtype=torch.float64)
18 gae_duplicate tensor(0.0397, dtype=torch.float64) tensor(-2.8255, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2864, dtype=torch.float64) delta_t tensor(0.0427, dtype=torch.float64)
17 gae_duplicate tensor(-0.0707, dtype=torch.float64) tensor(-1.1139, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4393, dtype=torch.float64) delta_t tensor(0.1012, dtype=torch.float64)
16 gae_duplicate tensor(0.0226, dtype=torch.float64) tensor(-1.9317, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2489, dtype=torch.float64) delta_t tensor(0.0129, dtype=torch.float64)
15 gae_duplicate tensor(-0.1416, dtype=torch.float64) tensor(-0.4715, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4458, dtype=torch.float64) delta_t tensor(0.1529, dtype=torch.float64)
14 gae_duplicate tensor(0.0405, dtype=torch.float64) tensor(-3.0655, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2792, dtype=torch.float64) delta_t tensor(0.0657, dtype=torch.float64)
13 gae_duplicate tensor(-0.1244, dtype=torch.float64) tensor(-1.4620, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4537, dtype=torch.float64) delta_t tensor(0.0985, dtype=torch.float64)
12 gae_duplicate tensor(-0.0055, dtype=torch.float64) tensor(-1.8003, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2731, dtype=torch.float64) delta_t tensor(0.0467, dtype=torch.float64)
11 gae_duplicate tensor(-0.1305, dtype=torch.float64) tensor(-1.1515, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4326, dtype=torch.float64) delta_t tensor(0.1166, dtype=torch.float64)
10 gae_duplicate tensor(-0.0105, dtype=torch.float64) tensor(-2.2107, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2431, dtype=torch.float64) delta_t tensor(0.0490, dtype=torch.float64)
9 gae_duplicate tensor(-0.1357, dtype=torch.float64) tensor(-1.0484, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3590, dtype=torch.float64) delta_t tensor(0.1110, dtype=torch.float64)
8 gae_duplicate tensor(-0.0628, dtype=torch.float64) tensor(-2.2284, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1851, dtype=torch.float64) delta_t tensor(-0.0211, dtype=torch.float64)
7 gae_duplicate tensor(-0.2130, dtype=torch.float64) tensor(0.4059, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3311, dtype=torch.float64) delta_t tensor(0.5959, dtype=torch.float64)
6 gae_duplicate tensor(0.1971, dtype=torch.float64) tensor(-11.9070, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0986, dtype=torch.float64) delta_t tensor(0.1015, dtype=torch.float64)
5 gae_duplicate tensor(-0.0298, dtype=torch.float64) tensor(-3.1941, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4502, dtype=torch.float64) delta_t tensor(-2.2183, dtype=torch.float64)
4 gae_duplicate tensor(-3.6810, dtype=torch.float64) tensor(43.5663, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0880, dtype=torch.float64) delta_t tensor(0.6436, dtype=torch.float64)
3 gae_duplicate tensor(-0.0008, dtype=torch.float64) tensor(-7.4376, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2850, dtype=torch.float64) delta_t tensor(0.3031, dtype=torch.float64)
2 gae_duplicate tensor(0.1061, dtype=torch.float64) tensor(-6.1476, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:184.89041137695312
value loss:68.56272888183594
entropies:347.9642333984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.757160902023315 seconds
19 rew tensor(0.3926, dtype=torch.float64) delta_t tensor(0.2736, dtype=torch.float64)
19 gae_duplicate tensor(-0.0187, dtype=torch.float64) tensor(-4.4368, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4257, dtype=torch.float64) delta_t tensor(0.1186, dtype=torch.float64)
18 gae_duplicate tensor(0.0274, dtype=torch.float64) tensor(-2.7751, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3147, dtype=torch.float64) delta_t tensor(0.2683, dtype=torch.float64)
17 gae_duplicate tensor(-0.0326, dtype=torch.float64) tensor(-4.6941, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4641, dtype=torch.float64) delta_t tensor(0.1674, dtype=torch.float64)
16 gae_duplicate tensor(0.0183, dtype=torch.float64) tensor(-3.4892, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1110, dtype=torch.float64) delta_t tensor(0.1406, dtype=torch.float64)
15 gae_duplicate tensor(-0.1069, dtype=torch.float64) tensor(-3.5647, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4904, dtype=torch.float64) delta_t tensor(0.1600, dtype=torch.float64)
14 gae_duplicate tensor(0.0505, dtype=torch.float64) tensor(-3.5532, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0915, dtype=torch.float64) delta_t tensor(-0.0219, dtype=torch.float64)
13 gae_duplicate tensor(-0.0899, dtype=torch.float64) tensor(0.0580, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4981, dtype=torch.float64) delta_t tensor(0.1205, dtype=torch.float64)
12 gae_duplicate tensor(-0.0084, dtype=torch.float64) tensor(-2.4612, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0909, dtype=torch.float64) delta_t tensor(-0.0126, dtype=torch.float64)
11 gae_duplicate tensor(-0.0933, dtype=torch.float64) tensor(0.0010, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4695, dtype=torch.float64) delta_t tensor(0.1975, dtype=torch.float64)
10 gae_duplicate tensor(-0.0287, dtype=torch.float64) tensor(-3.5606, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0782, dtype=torch.float64) delta_t tensor(-0.0530, dtype=torch.float64)
9 gae_duplicate tensor(-0.1670, dtype=torch.float64) tensor(0.6890, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4550, dtype=torch.float64) delta_t tensor(0.1226, dtype=torch.float64)
8 gae_duplicate tensor(0.0525, dtype=torch.float64) tensor(-2.2204, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0569, dtype=torch.float64) delta_t tensor(0.0635, dtype=torch.float64)
7 gae_duplicate tensor(-0.2364, dtype=torch.float64) tensor(-1.6815, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3685, dtype=torch.float64) delta_t tensor(0.2758, dtype=torch.float64)
6 gae_duplicate tensor(0.1881, dtype=torch.float64) tensor(-5.6799, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1301, dtype=torch.float64) delta_t tensor(0.1678, dtype=torch.float64)
5 gae_duplicate tensor(-0.0558, dtype=torch.float64) tensor(-3.7043, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9890, dtype=torch.float64) delta_t tensor(-2.1545, dtype=torch.float64)
4 gae_duplicate tensor(-4.6561, dtype=torch.float64) tensor(38.6859, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1433, dtype=torch.float64) delta_t tensor(0.8066, dtype=torch.float64)
3 gae_duplicate tensor(-0.1426, dtype=torch.float64) tensor(-11.0169, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2354, dtype=torch.float64) delta_t tensor(0.1653, dtype=torch.float64)
2 gae_duplicate tensor(0.0237, dtype=torch.float64) tensor(-4.8540, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:891.9673461914062
value loss:98.29065704345703
entropies:348.0096740722656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.902274131774902 seconds
19 rew tensor(0.4695, dtype=torch.float64) delta_t tensor(0.3180, dtype=torch.float64)
19 gae_duplicate tensor(-0.0869, dtype=torch.float64) tensor(-5.7185, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3859, dtype=torch.float64) delta_t tensor(0.1186, dtype=torch.float64)
18 gae_duplicate tensor(0.0241, dtype=torch.float64) tensor(-3.0827, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3747, dtype=torch.float64) delta_t tensor(0.4218, dtype=torch.float64)
17 gae_duplicate tensor(0.0166, dtype=torch.float64) tensor(-7.9507, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4880, dtype=torch.float64) delta_t tensor(0.1964, dtype=torch.float64)
16 gae_duplicate tensor(0.0558, dtype=torch.float64) tensor(-4.1783, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.2240, dtype=torch.float64) delta_t tensor(-0.1671, dtype=torch.float64)
15 gae_duplicate tensor(-1.8119, dtype=torch.float64) tensor(3.1869, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4885, dtype=torch.float64) delta_t tensor(0.1630, dtype=torch.float64)
14 gae_duplicate tensor(-0.0630, dtype=torch.float64) tensor(-3.1218, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0545, dtype=torch.float64) delta_t tensor(-0.0360, dtype=torch.float64)
13 gae_duplicate tensor(-0.1465, dtype=torch.float64) tensor(0.5350, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4821, dtype=torch.float64) delta_t tensor(0.1464, dtype=torch.float64)
12 gae_duplicate tensor(0.0259, dtype=torch.float64) tensor(-3.0445, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0549, dtype=torch.float64) delta_t tensor(-0.0204, dtype=torch.float64)
11 gae_duplicate tensor(-0.1145, dtype=torch.float64) tensor(0.0100, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4605, dtype=torch.float64) delta_t tensor(0.2140, dtype=torch.float64)
10 gae_duplicate tensor(0.0291, dtype=torch.float64) tensor(-4.1827, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3084, dtype=torch.float64) delta_t tensor(-0.3510, dtype=torch.float64)
9 gae_duplicate tensor(-1.7536, dtype=torch.float64) tensor(6.3423, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4452, dtype=torch.float64) delta_t tensor(0.1449, dtype=torch.float64)
8 gae_duplicate tensor(-0.0212, dtype=torch.float64) tensor(-2.2202, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0122, dtype=torch.float64) delta_t tensor(0.0178, dtype=torch.float64)
7 gae_duplicate tensor(-0.3082, dtype=torch.float64) tensor(-0.4180, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3588, dtype=torch.float64) delta_t tensor(0.4804, dtype=torch.float64)
6 gae_duplicate tensor(0.2346, dtype=torch.float64) tensor(-10.0000, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1775, dtype=torch.float64) delta_t tensor(0.1030, dtype=torch.float64)
5 gae_duplicate tensor(-0.1310, dtype=torch.float64) tensor(-3.2928, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0637, dtype=torch.float64) delta_t tensor(-2.4287, dtype=torch.float64)
4 gae_duplicate tensor(-4.4157, dtype=torch.float64) tensor(46.6012, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0237, dtype=torch.float64) delta_t tensor(0.6541, dtype=torch.float64)
3 gae_duplicate tensor(-0.1657, dtype=torch.float64) tensor(-8.9205, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2853, dtype=torch.float64) delta_t tensor(0.2411, dtype=torch.float64)
2 gae_duplicate tensor(-0.0753, dtype=torch.float64) tensor(-5.5085, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:173.97357177734375
value loss:109.56830596923828
entropies:348.4071044921875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3948.1133)
ToM Target loss= tensor(3557.4397)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.768161058425903 seconds
19 rew tensor(0.4201, dtype=torch.float64) delta_t tensor(0.1394, dtype=torch.float64)
19 gae_duplicate tensor(-0.0659, dtype=torch.float64) tensor(-2.2927, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4280, dtype=torch.float64) delta_t tensor(0.1240, dtype=torch.float64)
18 gae_duplicate tensor(-0.0122, dtype=torch.float64) tensor(-2.8685, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4199, dtype=torch.float64) delta_t tensor(0.2715, dtype=torch.float64)
17 gae_duplicate tensor(-0.0033, dtype=torch.float64) tensor(-4.9572, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4204, dtype=torch.float64) delta_t tensor(0.1347, dtype=torch.float64)
16 gae_duplicate tensor(0.0077, dtype=torch.float64) tensor(-3.2418, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1190, dtype=torch.float64) delta_t tensor(0.0333, dtype=torch.float64)
15 gae_duplicate tensor(-0.6875, dtype=torch.float64) tensor(-1.0219, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4348, dtype=torch.float64) delta_t tensor(0.1410, dtype=torch.float64)
14 gae_duplicate tensor(0.0151, dtype=torch.float64) tensor(-2.8620, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2308, dtype=torch.float64) delta_t tensor(0.0349, dtype=torch.float64)
13 gae_duplicate tensor(-0.0377, dtype=torch.float64) tensor(-0.9747, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4275, dtype=torch.float64) delta_t tensor(0.0887, dtype=torch.float64)
12 gae_duplicate tensor(-0.0371, dtype=torch.float64) tensor(-1.8823, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2312, dtype=torch.float64) delta_t tensor(0.0353, dtype=torch.float64)
11 gae_duplicate tensor(-0.0322, dtype=torch.float64) tensor(-0.8830, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4136, dtype=torch.float64) delta_t tensor(0.1498, dtype=torch.float64)
10 gae_duplicate tensor(-0.0026, dtype=torch.float64) tensor(-2.9168, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0672, dtype=torch.float64) delta_t tensor(-0.0977, dtype=torch.float64)
9 gae_duplicate tensor(-0.6516, dtype=torch.float64) tensor(1.4774, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3770, dtype=torch.float64) delta_t tensor(0.1144, dtype=torch.float64)
8 gae_duplicate tensor(0.0413, dtype=torch.float64) tensor(-2.0094, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1735, dtype=torch.float64) delta_t tensor(0.0607, dtype=torch.float64)
7 gae_duplicate tensor(-0.1954, dtype=torch.float64) tensor(-1.8095, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3120, dtype=torch.float64) delta_t tensor(0.2970, dtype=torch.float64)
6 gae_duplicate tensor(0.2684, dtype=torch.float64) tensor(-5.7226, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0430, dtype=torch.float64) delta_t tensor(0.2335, dtype=torch.float64)
5 gae_duplicate tensor(-0.1519, dtype=torch.float64) tensor(-5.2253, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0744, dtype=torch.float64) delta_t tensor(-1.3779, dtype=torch.float64)
4 gae_duplicate tensor(-2.9219, dtype=torch.float64) tensor(27.2961, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0875, dtype=torch.float64) delta_t tensor(0.3547, dtype=torch.float64)
3 gae_duplicate tensor(0.0572, dtype=torch.float64) tensor(-4.1911, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2521, dtype=torch.float64) delta_t tensor(0.1913, dtype=torch.float64)
2 gae_duplicate tensor(-0.0437, dtype=torch.float64) tensor(-4.5958, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:914.5574340820312
value loss:40.5853385925293
entropies:348.9730224609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.932661056518555 seconds
19 rew tensor(0.5085, dtype=torch.float64) delta_t tensor(0.2641, dtype=torch.float64)
19 gae_duplicate tensor(0.1101, dtype=torch.float64) tensor(-5.3668, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3665, dtype=torch.float64) delta_t tensor(0.1248, dtype=torch.float64)
18 gae_duplicate tensor(-0.0742, dtype=torch.float64) tensor(-2.6667, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4600, dtype=torch.float64) delta_t tensor(0.4012, dtype=torch.float64)
17 gae_duplicate tensor(0.1159, dtype=torch.float64) tensor(-8.4348, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4633, dtype=torch.float64) delta_t tensor(0.1330, dtype=torch.float64)
16 gae_duplicate tensor(-0.1196, dtype=torch.float64) tensor(-3.4097, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1145, dtype=torch.float64) delta_t tensor(-0.0118, dtype=torch.float64)
15 gae_duplicate tensor(-0.2676, dtype=torch.float64) tensor(-0.1023, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4573, dtype=torch.float64) delta_t tensor(0.1764, dtype=torch.float64)
14 gae_duplicate tensor(-0.0542, dtype=torch.float64) tensor(-3.2494, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1222, dtype=torch.float64) delta_t tensor(-0.0449, dtype=torch.float64)
13 gae_duplicate tensor(-0.2238, dtype=torch.float64) tensor(0.5973, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4572, dtype=torch.float64) delta_t tensor(0.1475, dtype=torch.float64)
12 gae_duplicate tensor(-0.1361, dtype=torch.float64) tensor(-2.8583, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1159, dtype=torch.float64) delta_t tensor(-0.0273, dtype=torch.float64)
11 gae_duplicate tensor(-0.2132, dtype=torch.float64) tensor(0.2360, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4491, dtype=torch.float64) delta_t tensor(0.2065, dtype=torch.float64)
10 gae_duplicate tensor(-0.0980, dtype=torch.float64) tensor(-4.2163, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1638, dtype=torch.float64) delta_t tensor(-0.2697, dtype=torch.float64)
9 gae_duplicate tensor(-1.3400, dtype=torch.float64) tensor(5.0275, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6442, dtype=torch.float64) delta_t tensor(-0.5736, dtype=torch.float64)
8 gae_duplicate tensor(-3.9666, dtype=torch.float64) tensor(10.9180, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2242, dtype=torch.float64) delta_t tensor(-0.1218, dtype=torch.float64)
7 gae_duplicate tensor(-1.3418, dtype=torch.float64) tensor(3.4197, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2884, dtype=torch.float64) delta_t tensor(0.2633, dtype=torch.float64)
6 gae_duplicate tensor(0.0640, dtype=torch.float64) tensor(-4.8878, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4306, dtype=torch.float64) delta_t tensor(-0.1978, dtype=torch.float64)
5 gae_duplicate tensor(-1.8682, dtype=torch.float64) tensor(4.1360, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4490, dtype=torch.float64) delta_t tensor(-0.1382, dtype=torch.float64)
4 gae_duplicate tensor(-1.1815, dtype=torch.float64) tensor(3.0471, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1015, dtype=torch.float64) delta_t tensor(0.2338, dtype=torch.float64)
3 gae_duplicate tensor(-0.1302, dtype=torch.float64) tensor(-4.2465, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3680, dtype=torch.float64) delta_t tensor(0.1243, dtype=torch.float64)
2 gae_duplicate tensor(-0.1108, dtype=torch.float64) tensor(-2.8015, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:708.0413208007812
value loss:49.62094497680664
entropies:349.2859191894531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.050445079803467 seconds
19 rew tensor(0.4402, dtype=torch.float64) delta_t tensor(0.1736, dtype=torch.float64)
19 gae_duplicate tensor(-0.1305, dtype=torch.float64) tensor(-3.6873, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3927, dtype=torch.float64) delta_t tensor(0.0382, dtype=torch.float64)
18 gae_duplicate tensor(-0.0559, dtype=torch.float64) tensor(-0.9087, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3561, dtype=torch.float64) delta_t tensor(0.2122, dtype=torch.float64)
17 gae_duplicate tensor(-0.0047, dtype=torch.float64) tensor(-4.0792, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4673, dtype=torch.float64) delta_t tensor(0.0814, dtype=torch.float64)
16 gae_duplicate tensor(-0.0772, dtype=torch.float64) tensor(-1.8559, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0909, dtype=torch.float64) delta_t tensor(-0.0245, dtype=torch.float64)
15 gae_duplicate tensor(-0.0980, dtype=torch.float64) tensor(0.3611, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4929, dtype=torch.float64) delta_t tensor(0.1666, dtype=torch.float64)
14 gae_duplicate tensor(0.0641, dtype=torch.float64) tensor(-3.3125, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0785, dtype=torch.float64) delta_t tensor(-0.0804, dtype=torch.float64)
13 gae_duplicate tensor(-0.1872, dtype=torch.float64) tensor(1.1477, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4910, dtype=torch.float64) delta_t tensor(0.0826, dtype=torch.float64)
12 gae_duplicate tensor(-0.0481, dtype=torch.float64) tensor(-1.4449, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0804, dtype=torch.float64) delta_t tensor(-0.0713, dtype=torch.float64)
11 gae_duplicate tensor(-0.1215, dtype=torch.float64) tensor(1.3413, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4687, dtype=torch.float64) delta_t tensor(0.1287, dtype=torch.float64)
10 gae_duplicate tensor(-0.0495, dtype=torch.float64) tensor(-2.3379, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0500, dtype=torch.float64) delta_t tensor(-0.1505, dtype=torch.float64)
9 gae_duplicate tensor(-0.2584, dtype=torch.float64) tensor(2.7979, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4561, dtype=torch.float64) delta_t tensor(0.0527, dtype=torch.float64)
8 gae_duplicate tensor(-0.0059, dtype=torch.float64) tensor(-0.7029, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0101, dtype=torch.float64) delta_t tensor(-0.1407, dtype=torch.float64)
7 gae_duplicate tensor(-0.3670, dtype=torch.float64) tensor(2.5694, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3688, dtype=torch.float64) delta_t tensor(0.2389, dtype=torch.float64)
6 gae_duplicate tensor(0.2050, dtype=torch.float64) tensor(-4.5554, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1793, dtype=torch.float64) delta_t tensor(-0.0521, dtype=torch.float64)
5 gae_duplicate tensor(-0.1851, dtype=torch.float64) tensor(0.5551, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6609, dtype=torch.float64) delta_t tensor(-0.2240, dtype=torch.float64)
4 gae_duplicate tensor(-3.0817, dtype=torch.float64) tensor(3.4432, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2208, dtype=torch.float64) delta_t tensor(-0.0811, dtype=torch.float64)
3 gae_duplicate tensor(-0.4860, dtype=torch.float64) tensor(2.1316, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3283, dtype=torch.float64) delta_t tensor(0.0504, dtype=torch.float64)
2 gae_duplicate tensor(-0.1703, dtype=torch.float64) tensor(-0.8272, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:411.2856140136719
value loss:26.225191116333008
entropies:349.62078857421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.022065877914429 seconds
19 rew tensor(0.4362, dtype=torch.float64) delta_t tensor(0.0493, dtype=torch.float64)
19 gae_duplicate tensor(-0.1475, dtype=torch.float64) tensor(-0.7976, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4283, dtype=torch.float64) delta_t tensor(-0.0106, dtype=torch.float64)
18 gae_duplicate tensor(-0.0777, dtype=torch.float64) tensor(0.0551, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4202, dtype=torch.float64) delta_t tensor(0.0659, dtype=torch.float64)
17 gae_duplicate tensor(-0.0433, dtype=torch.float64) tensor(-1.2072, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4417, dtype=torch.float64) delta_t tensor(-0.0148, dtype=torch.float64)
16 gae_duplicate tensor(-0.1043, dtype=torch.float64) tensor(0.1583, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3492, dtype=torch.float64) delta_t tensor(0.0278, dtype=torch.float64)
15 gae_duplicate tensor(-0.1307, dtype=torch.float64) tensor(-0.5280, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3272, dtype=torch.float64) delta_t tensor(-0.0052, dtype=torch.float64)
14 gae_duplicate tensor(-0.6578, dtype=torch.float64) tensor(-0.0291, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2814, dtype=torch.float64) delta_t tensor(-0.0033, dtype=torch.float64)
13 gae_duplicate tensor(-0.1085, dtype=torch.float64) tensor(0.1322, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4587, dtype=torch.float64) delta_t tensor(0.0586, dtype=torch.float64)
12 gae_duplicate tensor(-0.0584, dtype=torch.float64) tensor(-1.1965, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2534, dtype=torch.float64) delta_t tensor(-0.0135, dtype=torch.float64)
11 gae_duplicate tensor(-0.1182, dtype=torch.float64) tensor(0.1440, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4511, dtype=torch.float64) delta_t tensor(0.0616, dtype=torch.float64)
10 gae_duplicate tensor(-0.0387, dtype=torch.float64) tensor(-1.1927, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2082, dtype=torch.float64) delta_t tensor(-0.0333, dtype=torch.float64)
9 gae_duplicate tensor(-0.2028, dtype=torch.float64) tensor(0.7988, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4005, dtype=torch.float64) delta_t tensor(0.0565, dtype=torch.float64)
8 gae_duplicate tensor(-0.0844, dtype=torch.float64) tensor(-1.0669, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1503, dtype=torch.float64) delta_t tensor(-0.1360, dtype=torch.float64)
7 gae_duplicate tensor(-0.4817, dtype=torch.float64) tensor(2.9229, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3368, dtype=torch.float64) delta_t tensor(0.2570, dtype=torch.float64)
6 gae_duplicate tensor(0.1588, dtype=torch.float64) tensor(-4.5056, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1684, dtype=torch.float64) delta_t tensor(0.0483, dtype=torch.float64)
5 gae_duplicate tensor(-0.2871, dtype=torch.float64) tensor(-1.5564, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1597, dtype=torch.float64) delta_t tensor(-2.1220, dtype=torch.float64)
4 gae_duplicate tensor(-5.2352, dtype=torch.float64) tensor(36.5649, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0171, dtype=torch.float64) delta_t tensor(0.1325, dtype=torch.float64)
3 gae_duplicate tensor(-0.3220, dtype=torch.float64) tensor(1.2941, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2992, dtype=torch.float64) delta_t tensor(0.0058, dtype=torch.float64)
2 gae_duplicate tensor(-0.3783, dtype=torch.float64) tensor(0.1261, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1720.81982421875
value loss:88.17935180664062
entropies:350.15118408203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1734700202941895 seconds
19 rew tensor(0.5393, dtype=torch.float64) delta_t tensor(0.3246, dtype=torch.float64)
19 gae_duplicate tensor(-0.0783, dtype=torch.float64) tensor(-5.9546, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5114, dtype=torch.float64) delta_t tensor(0.0270, dtype=torch.float64)
18 gae_duplicate tensor(-0.1610, dtype=torch.float64) tensor(-1.3286, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4576, dtype=torch.float64) delta_t tensor(0.1195, dtype=torch.float64)
17 gae_duplicate tensor(-0.0142, dtype=torch.float64) tensor(-2.2714, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5199, dtype=torch.float64) delta_t tensor(0.1092, dtype=torch.float64)
16 gae_duplicate tensor(-0.0133, dtype=torch.float64) tensor(-2.2462, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1661, dtype=torch.float64) delta_t tensor(-0.0909, dtype=torch.float64)
15 gae_duplicate tensor(-0.1999, dtype=torch.float64) tensor(1.5968, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5075, dtype=torch.float64) delta_t tensor(0.0428, dtype=torch.float64)
14 gae_duplicate tensor(-0.0390, dtype=torch.float64) tensor(-0.6517, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1858, dtype=torch.float64) delta_t tensor(-0.1025, dtype=torch.float64)
13 gae_duplicate tensor(-0.2349, dtype=torch.float64) tensor(1.7893, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4671, dtype=torch.float64) delta_t tensor(-0.0265, dtype=torch.float64)
12 gae_duplicate tensor(-0.0815, dtype=torch.float64) tensor(0.7718, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1706, dtype=torch.float64) delta_t tensor(-0.0931, dtype=torch.float64)
11 gae_duplicate tensor(-0.1806, dtype=torch.float64) tensor(2.0566, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4614, dtype=torch.float64) delta_t tensor(0.0512, dtype=torch.float64)
10 gae_duplicate tensor(-0.0974, dtype=torch.float64) tensor(-0.7386, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1413, dtype=torch.float64) delta_t tensor(-0.4296, dtype=torch.float64)
9 gae_duplicate tensor(-1.6565, dtype=torch.float64) tensor(7.7312, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8662, dtype=torch.float64) delta_t tensor(-1.3688, dtype=torch.float64)
8 gae_duplicate tensor(-7.9392, dtype=torch.float64) tensor(28.8868, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0289, dtype=torch.float64) delta_t tensor(-0.2143, dtype=torch.float64)
7 gae_duplicate tensor(-0.7967, dtype=torch.float64) tensor(6.4911, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3030, dtype=torch.float64) delta_t tensor(0.0917, dtype=torch.float64)
6 gae_duplicate tensor(-0.3644, dtype=torch.float64) tensor(-1.1448, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2834, dtype=torch.float64) delta_t tensor(-0.0252, dtype=torch.float64)
5 gae_duplicate tensor(-0.2421, dtype=torch.float64) tensor(0.4987, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.3315, dtype=torch.float64) delta_t tensor(-3.3312, dtype=torch.float64)
4 gae_duplicate tensor(-10.3686, dtype=torch.float64) tensor(71.4387, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1243, dtype=torch.float64) delta_t tensor(0.0014, dtype=torch.float64)
3 gae_duplicate tensor(-0.5956, dtype=torch.float64) tensor(6.1397, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1894, dtype=torch.float64) delta_t tensor(0.1466, dtype=torch.float64)
2 gae_duplicate tensor(-0.1927, dtype=torch.float64) tensor(-2.4932, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6065.5908203125
value loss:322.7332763671875
entropies:350.8692626953125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3989.5471)
ToM Target loss= tensor(3552.3508)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.144015073776245 seconds
19 rew tensor(0.4704, dtype=torch.float64) delta_t tensor(-0.0072, dtype=torch.float64)
19 gae_duplicate tensor(-0.1674, dtype=torch.float64) tensor(0.1419, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4771, dtype=torch.float64) delta_t tensor(-0.0468, dtype=torch.float64)
18 gae_duplicate tensor(-0.1840, dtype=torch.float64) tensor(0.9292, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4352, dtype=torch.float64) delta_t tensor(0.0969, dtype=torch.float64)
17 gae_duplicate tensor(-0.0882, dtype=torch.float64) tensor(-1.8035, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4632, dtype=torch.float64) delta_t tensor(-0.0327, dtype=torch.float64)
16 gae_duplicate tensor(-0.1606, dtype=torch.float64) tensor(0.5736, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2731, dtype=torch.float64) delta_t tensor(-0.0405, dtype=torch.float64)
15 gae_duplicate tensor(-0.2046, dtype=torch.float64) tensor(0.7693, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5003, dtype=torch.float64) delta_t tensor(0.0291, dtype=torch.float64)
14 gae_duplicate tensor(-0.1121, dtype=torch.float64) tensor(-0.5419, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1661, dtype=torch.float64) delta_t tensor(-0.1427, dtype=torch.float64)
13 gae_duplicate tensor(-0.3138, dtype=torch.float64) tensor(2.5113, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4785, dtype=torch.float64) delta_t tensor(-0.0433, dtype=torch.float64)
12 gae_duplicate tensor(-0.1375, dtype=torch.float64) tensor(1.1470, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1297, dtype=torch.float64) delta_t tensor(-0.1302, dtype=torch.float64)
11 gae_duplicate tensor(-0.2115, dtype=torch.float64) tensor(2.5826, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4786, dtype=torch.float64) delta_t tensor(0.0300, dtype=torch.float64)
10 gae_duplicate tensor(-0.1415, dtype=torch.float64) tensor(-0.3091, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1238, dtype=torch.float64) delta_t tensor(-0.1453, dtype=torch.float64)
9 gae_duplicate tensor(-0.3146, dtype=torch.float64) tensor(2.7195, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4289, dtype=torch.float64) delta_t tensor(-0.0621, dtype=torch.float64)
8 gae_duplicate tensor(-0.1732, dtype=torch.float64) tensor(1.4216, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0653, dtype=torch.float64) delta_t tensor(-0.2528, dtype=torch.float64)
7 gae_duplicate tensor(-0.4494, dtype=torch.float64) tensor(4.8715, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3711, dtype=torch.float64) delta_t tensor(0.1555, dtype=torch.float64)
6 gae_duplicate tensor(0.0845, dtype=torch.float64) tensor(-2.4993, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1627, dtype=torch.float64) delta_t tensor(0.1925, dtype=torch.float64)
5 gae_duplicate tensor(-0.2200, dtype=torch.float64) tensor(-4.2796, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.3415, dtype=torch.float64) delta_t tensor(-3.7876, dtype=torch.float64)
4 gae_duplicate tensor(-6.0176, dtype=torch.float64) tensor(72.2825, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0600, dtype=torch.float64) delta_t tensor(0.0554, dtype=torch.float64)
3 gae_duplicate tensor(-0.6596, dtype=torch.float64) tensor(6.0176, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1267, dtype=torch.float64) delta_t tensor(0.2200, dtype=torch.float64)
2 gae_duplicate tensor(-0.0657, dtype=torch.float64) tensor(-3.7503, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4565.16259765625
value loss:166.1112060546875
entropies:351.2467041015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.711241006851196 seconds
19 rew tensor(0.2852, dtype=torch.float64) delta_t tensor(-0.0754, dtype=torch.float64)
19 gae_duplicate tensor(-0.1625, dtype=torch.float64) tensor(1.5884, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5011, dtype=torch.float64) delta_t tensor(-0.0087, dtype=torch.float64)
18 gae_duplicate tensor(-0.1341, dtype=torch.float64) tensor(0.3196, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2807, dtype=torch.float64) delta_t tensor(-0.0610, dtype=torch.float64)
17 gae_duplicate tensor(-0.1696, dtype=torch.float64) tensor(1.2740, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5004, dtype=torch.float64) delta_t tensor(-0.0380, dtype=torch.float64)
16 gae_duplicate tensor(-0.1151, dtype=torch.float64) tensor(0.8613, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2139, dtype=torch.float64) delta_t tensor(-0.0664, dtype=torch.float64)
15 gae_duplicate tensor(-0.1758, dtype=torch.float64) tensor(1.5545, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4939, dtype=torch.float64) delta_t tensor(0.0442, dtype=torch.float64)
14 gae_duplicate tensor(-0.1008, dtype=torch.float64) tensor(-0.8218, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2291, dtype=torch.float64) delta_t tensor(-0.0432, dtype=torch.float64)
13 gae_duplicate tensor(-0.1700, dtype=torch.float64) tensor(0.7847, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4953, dtype=torch.float64) delta_t tensor(-0.0379, dtype=torch.float64)
12 gae_duplicate tensor(-0.1046, dtype=torch.float64) tensor(0.8237, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2034, dtype=torch.float64) delta_t tensor(-0.0556, dtype=torch.float64)
11 gae_duplicate tensor(-0.1351, dtype=torch.float64) tensor(1.2680, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4866, dtype=torch.float64) delta_t tensor(-0.0025, dtype=torch.float64)
10 gae_duplicate tensor(-0.0845, dtype=torch.float64) tensor(0.1472, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1820, dtype=torch.float64) delta_t tensor(-0.1076, dtype=torch.float64)
9 gae_duplicate tensor(-0.2557, dtype=torch.float64) tensor(1.9996, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4657, dtype=torch.float64) delta_t tensor(-0.0285, dtype=torch.float64)
8 gae_duplicate tensor(-0.1241, dtype=torch.float64) tensor(0.7683, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1611, dtype=torch.float64) delta_t tensor(-0.1608, dtype=torch.float64)
7 gae_duplicate tensor(-0.2888, dtype=torch.float64) tensor(3.2551, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3881, dtype=torch.float64) delta_t tensor(0.1675, dtype=torch.float64)
6 gae_duplicate tensor(0.0763, dtype=torch.float64) tensor(-2.9157, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0557, dtype=torch.float64) delta_t tensor(-0.0214, dtype=torch.float64)
5 gae_duplicate tensor(-0.1279, dtype=torch.float64) tensor(0.2173, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6619, dtype=torch.float64) delta_t tensor(-1.4734, dtype=torch.float64)
4 gae_duplicate tensor(-3.8768, dtype=torch.float64) tensor(28.1238, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0809, dtype=torch.float64) delta_t tensor(-0.0660, dtype=torch.float64)
3 gae_duplicate tensor(-0.4161, dtype=torch.float64) tensor(4.1863, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2155, dtype=torch.float64) delta_t tensor(0.0974, dtype=torch.float64)
2 gae_duplicate tensor(-0.2461, dtype=torch.float64) tensor(-1.6226, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2352.815185546875
value loss:42.2706298828125
entropies:351.7938537597656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.046788215637207 seconds
19 rew tensor(0.4400, dtype=torch.float64) delta_t tensor(-0.0451, dtype=torch.float64)
19 gae_duplicate tensor(-0.3114, dtype=torch.float64) tensor(0.9105, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4139, dtype=torch.float64) delta_t tensor(0.0341, dtype=torch.float64)
18 gae_duplicate tensor(-0.1629, dtype=torch.float64) tensor(-0.4442, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3708, dtype=torch.float64) delta_t tensor(-0.0003, dtype=torch.float64)
17 gae_duplicate tensor(-0.1603, dtype=torch.float64) tensor(-0.0390, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4762, dtype=torch.float64) delta_t tensor(0.0280, dtype=torch.float64)
16 gae_duplicate tensor(-0.0947, dtype=torch.float64) tensor(-0.5618, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2879, dtype=torch.float64) delta_t tensor(-0.0432, dtype=torch.float64)
15 gae_duplicate tensor(-0.1399, dtype=torch.float64) tensor(0.8241, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4841, dtype=torch.float64) delta_t tensor(0.0698, dtype=torch.float64)
14 gae_duplicate tensor(-0.0423, dtype=torch.float64) tensor(-1.2897, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3095, dtype=torch.float64) delta_t tensor(-0.0182, dtype=torch.float64)
13 gae_duplicate tensor(-0.1313, dtype=torch.float64) tensor(0.1959, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4778, dtype=torch.float64) delta_t tensor(0.0037, dtype=torch.float64)
12 gae_duplicate tensor(-0.0629, dtype=torch.float64) tensor(-0.0387, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3033, dtype=torch.float64) delta_t tensor(-0.0482, dtype=torch.float64)
11 gae_duplicate tensor(-0.1977, dtype=torch.float64) tensor(1.0148, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4704, dtype=torch.float64) delta_t tensor(0.0335, dtype=torch.float64)
10 gae_duplicate tensor(-0.0623, dtype=torch.float64) tensor(-0.5731, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1019, dtype=torch.float64) delta_t tensor(0.2793, dtype=torch.float64)
9 gae_duplicate tensor(-0.2566, dtype=torch.float64) tensor(-5.1361, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4089, dtype=torch.float64) delta_t tensor(-0.6015, dtype=torch.float64)
8 gae_duplicate tensor(-3.5084, dtype=torch.float64) tensor(11.4305, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2016, dtype=torch.float64) delta_t tensor(-0.0944, dtype=torch.float64)
7 gae_duplicate tensor(-0.2721, dtype=torch.float64) tensor(3.1390, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3457, dtype=torch.float64) delta_t tensor(0.5929, dtype=torch.float64)
6 gae_duplicate tensor(0.0804, dtype=torch.float64) tensor(-11.4119, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1394, dtype=torch.float64) delta_t tensor(0.1295, dtype=torch.float64)
5 gae_duplicate tensor(-0.1376, dtype=torch.float64) tensor(-3.9492, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4451, dtype=torch.float64) delta_t tensor(-0.1010, dtype=torch.float64)
4 gae_duplicate tensor(-3.0220, dtype=torch.float64) tensor(0.1055, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0039, dtype=torch.float64) delta_t tensor(0.2079, dtype=torch.float64)
3 gae_duplicate tensor(-0.2797, dtype=torch.float64) tensor(-4.2363, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2903, dtype=torch.float64) delta_t tensor(-0.0441, dtype=torch.float64)
2 gae_duplicate tensor(-0.2863, dtype=torch.float64) tensor(0.2597, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:434.0714416503906
value loss:56.21430969238281
entropies:352.3841552734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.791830062866211 seconds
19 rew tensor(0.3495, dtype=torch.float64) delta_t tensor(0.0060, dtype=torch.float64)
19 gae_duplicate tensor(-0.1317, dtype=torch.float64) tensor(-0.0642, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4250, dtype=torch.float64) delta_t tensor(0.0093, dtype=torch.float64)
18 gae_duplicate tensor(-0.0983, dtype=torch.float64) tensor(-0.1697, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3092, dtype=torch.float64) delta_t tensor(0.0723, dtype=torch.float64)
17 gae_duplicate tensor(-0.0657, dtype=torch.float64) tensor(-1.3002, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4799, dtype=torch.float64) delta_t tensor(0.0544, dtype=torch.float64)
16 gae_duplicate tensor(-0.0540, dtype=torch.float64) tensor(-1.2183, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1372, dtype=torch.float64) delta_t tensor(-0.0135, dtype=torch.float64)
15 gae_duplicate tensor(-0.1027, dtype=torch.float64) tensor(0.1532, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4893, dtype=torch.float64) delta_t tensor(0.1347, dtype=torch.float64)
14 gae_duplicate tensor(0.0596, dtype=torch.float64) tensor(-2.6742, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1514, dtype=torch.float64) delta_t tensor(-0.0570, dtype=torch.float64)
13 gae_duplicate tensor(-0.1596, dtype=torch.float64) tensor(0.8991, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4760, dtype=torch.float64) delta_t tensor(0.0332, dtype=torch.float64)
12 gae_duplicate tensor(-0.0336, dtype=torch.float64) tensor(-0.5891, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1252, dtype=torch.float64) delta_t tensor(-0.0326, dtype=torch.float64)
11 gae_duplicate tensor(-0.0980, dtype=torch.float64) tensor(0.6026, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4737, dtype=torch.float64) delta_t tensor(0.0947, dtype=torch.float64)
10 gae_duplicate tensor(-0.0413, dtype=torch.float64) tensor(-1.8486, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1121, dtype=torch.float64) delta_t tensor(-0.0761, dtype=torch.float64)
9 gae_duplicate tensor(-0.1924, dtype=torch.float64) tensor(1.2976, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4531, dtype=torch.float64) delta_t tensor(0.0084, dtype=torch.float64)
8 gae_duplicate tensor(-0.0574, dtype=torch.float64) tensor(-0.1059, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0831, dtype=torch.float64) delta_t tensor(-0.1120, dtype=torch.float64)
7 gae_duplicate tensor(-0.2242, dtype=torch.float64) tensor(2.1913, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3738, dtype=torch.float64) delta_t tensor(0.2036, dtype=torch.float64)
6 gae_duplicate tensor(0.0530, dtype=torch.float64) tensor(-3.8571, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1039, dtype=torch.float64) delta_t tensor(0.0302, dtype=torch.float64)
5 gae_duplicate tensor(-0.0752, dtype=torch.float64) tensor(-1.0254, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1059, dtype=torch.float64) delta_t tensor(-0.0443, dtype=torch.float64)
4 gae_duplicate tensor(-2.1787, dtype=torch.float64) tensor(2.1022, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1817, dtype=torch.float64) delta_t tensor(0.2269, dtype=torch.float64)
3 gae_duplicate tensor(-0.4440, dtype=torch.float64) tensor(-4.1471, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2473, dtype=torch.float64) delta_t tensor(0.0957, dtype=torch.float64)
2 gae_duplicate tensor(-0.0142, dtype=torch.float64) tensor(-2.2515, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:552.9692993164062
value loss:40.98016357421875
entropies:353.07757568359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.904199123382568 seconds
19 rew tensor(0.2778, dtype=torch.float64) delta_t tensor(0.0046, dtype=torch.float64)
19 gae_duplicate tensor(-0.0638, dtype=torch.float64) tensor(-0.1588, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4991, dtype=torch.float64) delta_t tensor(0.0104, dtype=torch.float64)
18 gae_duplicate tensor(-0.0336, dtype=torch.float64) tensor(-0.2140, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2439, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
17 gae_duplicate tensor(-0.0630, dtype=torch.float64) tensor(-0.7217, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5262, dtype=torch.float64) delta_t tensor(0.1299, dtype=torch.float64)
16 gae_duplicate tensor(0.0721, dtype=torch.float64) tensor(-2.7892, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1871, dtype=torch.float64) delta_t tensor(0.0874, dtype=torch.float64)
15 gae_duplicate tensor(0.0161, dtype=torch.float64) tensor(-2.0372, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5402, dtype=torch.float64) delta_t tensor(0.1451, dtype=torch.float64)
14 gae_duplicate tensor(0.0286, dtype=torch.float64) tensor(-3.0170, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1952, dtype=torch.float64) delta_t tensor(-0.0017, dtype=torch.float64)
13 gae_duplicate tensor(-0.1098, dtype=torch.float64) tensor(-0.2208, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5334, dtype=torch.float64) delta_t tensor(0.0645, dtype=torch.float64)
12 gae_duplicate tensor(0.0282, dtype=torch.float64) tensor(-1.2615, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1737, dtype=torch.float64) delta_t tensor(0.0431, dtype=torch.float64)
11 gae_duplicate tensor(-0.0065, dtype=torch.float64) tensor(-0.9859, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5121, dtype=torch.float64) delta_t tensor(0.1393, dtype=torch.float64)
10 gae_duplicate tensor(0.0959, dtype=torch.float64) tensor(-2.9129, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1521, dtype=torch.float64) delta_t tensor(-0.0205, dtype=torch.float64)
9 gae_duplicate tensor(-0.1043, dtype=torch.float64) tensor(0.1556, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5050, dtype=torch.float64) delta_t tensor(0.0601, dtype=torch.float64)
8 gae_duplicate tensor(0.0375, dtype=torch.float64) tensor(-1.1755, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1237, dtype=torch.float64) delta_t tensor(-0.1102, dtype=torch.float64)
7 gae_duplicate tensor(-0.1750, dtype=torch.float64) tensor(2.0079, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4328, dtype=torch.float64) delta_t tensor(0.2656, dtype=torch.float64)
6 gae_duplicate tensor(0.2130, dtype=torch.float64) tensor(-4.8530, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0492, dtype=torch.float64) delta_t tensor(0.1092, dtype=torch.float64)
5 gae_duplicate tensor(0.0056, dtype=torch.float64) tensor(-2.7852, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8286, dtype=torch.float64) delta_t tensor(0.9831, dtype=torch.float64)
4 gae_duplicate tensor(0.0088, dtype=torch.float64) tensor(-19.4469, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1500, dtype=torch.float64) delta_t tensor(0.0265, dtype=torch.float64)
3 gae_duplicate tensor(-0.2077, dtype=torch.float64) tensor(-2.5673, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1500, dtype=torch.float64) delta_t tensor(0.3452, dtype=torch.float64)
2 gae_duplicate tensor(0.2171, dtype=torch.float64) tensor(-6.8589, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2596.0546875
value loss:17.72665786743164
entropies:353.4552001953125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3971.1709)
ToM Target loss= tensor(3559.0510)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.992647886276245 seconds
19 rew tensor(0.4759, dtype=torch.float64) delta_t tensor(0.0284, dtype=torch.float64)
19 gae_duplicate tensor(-0.0516, dtype=torch.float64) tensor(-0.5315, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4279, dtype=torch.float64) delta_t tensor(0.0574, dtype=torch.float64)
18 gae_duplicate tensor(-0.0597, dtype=torch.float64) tensor(-1.1883, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4544, dtype=torch.float64) delta_t tensor(0.0901, dtype=torch.float64)
17 gae_duplicate tensor(-0.0507, dtype=torch.float64) tensor(-1.8971, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4457, dtype=torch.float64) delta_t tensor(0.0509, dtype=torch.float64)
16 gae_duplicate tensor(0.0110, dtype=torch.float64) tensor(-1.1761, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3100, dtype=torch.float64) delta_t tensor(0.0265, dtype=torch.float64)
15 gae_duplicate tensor(-0.1670, dtype=torch.float64) tensor(-0.5593, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4675, dtype=torch.float64) delta_t tensor(0.0823, dtype=torch.float64)
14 gae_duplicate tensor(0.0095, dtype=torch.float64) tensor(-1.7343, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3021, dtype=torch.float64) delta_t tensor(0.0352, dtype=torch.float64)
13 gae_duplicate tensor(-0.1393, dtype=torch.float64) tensor(-0.9075, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4753, dtype=torch.float64) delta_t tensor(0.0144, dtype=torch.float64)
12 gae_duplicate tensor(-0.0249, dtype=torch.float64) tensor(-0.3772, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2943, dtype=torch.float64) delta_t tensor(0.0297, dtype=torch.float64)
11 gae_duplicate tensor(-0.0719, dtype=torch.float64) tensor(-0.5523, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4456, dtype=torch.float64) delta_t tensor(0.0692, dtype=torch.float64)
10 gae_duplicate tensor(-0.0178, dtype=torch.float64) tensor(-1.5049, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1518, dtype=torch.float64) delta_t tensor(-0.3624, dtype=torch.float64)
9 gae_duplicate tensor(-2.5177, dtype=torch.float64) tensor(6.7542, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2891, dtype=torch.float64) delta_t tensor(-0.6564, dtype=torch.float64)
8 gae_duplicate tensor(-4.4845, dtype=torch.float64) tensor(13.0995, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0500, dtype=torch.float64) delta_t tensor(-0.3377, dtype=torch.float64)
7 gae_duplicate tensor(-1.9163, dtype=torch.float64) tensor(7.9299, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3117, dtype=torch.float64) delta_t tensor(0.2678, dtype=torch.float64)
6 gae_duplicate tensor(-0.0834, dtype=torch.float64) tensor(-4.4912, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0509, dtype=torch.float64) delta_t tensor(0.6048, dtype=torch.float64)
5 gae_duplicate tensor(0.1563, dtype=torch.float64) tensor(-12.7221, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6211, dtype=torch.float64) delta_t tensor(-1.4841, dtype=torch.float64)
4 gae_duplicate tensor(-2.5937, dtype=torch.float64) tensor(27.4177, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0385, dtype=torch.float64) delta_t tensor(0.5275, dtype=torch.float64)
3 gae_duplicate tensor(-0.2715, dtype=torch.float64) tensor(-6.9398, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1758, dtype=torch.float64) delta_t tensor(0.1580, dtype=torch.float64)
2 gae_duplicate tensor(-0.0596, dtype=torch.float64) tensor(-3.8055, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1003.49462890625
value loss:94.57518768310547
entropies:353.7736511230469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.773648262023926 seconds
19 rew tensor(0.2861, dtype=torch.float64) delta_t tensor(0.0718, dtype=torch.float64)
19 gae_duplicate tensor(-0.0277, dtype=torch.float64) tensor(-1.3746, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4324, dtype=torch.float64) delta_t tensor(0.0079, dtype=torch.float64)
18 gae_duplicate tensor(-0.1222, dtype=torch.float64) tensor(-0.3059, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2551, dtype=torch.float64) delta_t tensor(0.0471, dtype=torch.float64)
17 gae_duplicate tensor(-0.1081, dtype=torch.float64) tensor(-0.9867, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4847, dtype=torch.float64) delta_t tensor(0.1082, dtype=torch.float64)
16 gae_duplicate tensor(0.0260, dtype=torch.float64) tensor(-2.1293, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0155, dtype=torch.float64) delta_t tensor(-0.1454, dtype=torch.float64)
15 gae_duplicate tensor(-0.8895, dtype=torch.float64) tensor(2.6422, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4980, dtype=torch.float64) delta_t tensor(0.0641, dtype=torch.float64)
14 gae_duplicate tensor(-0.0343, dtype=torch.float64) tensor(-1.0524, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1461, dtype=torch.float64) delta_t tensor(0.0166, dtype=torch.float64)
13 gae_duplicate tensor(-0.1053, dtype=torch.float64) tensor(-0.3997, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4981, dtype=torch.float64) delta_t tensor(-0.0090, dtype=torch.float64)
12 gae_duplicate tensor(-0.0549, dtype=torch.float64) tensor(0.1496, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1465, dtype=torch.float64) delta_t tensor(-0.0217, dtype=torch.float64)
11 gae_duplicate tensor(-0.2086, dtype=torch.float64) tensor(0.4685, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4693, dtype=torch.float64) delta_t tensor(0.1173, dtype=torch.float64)
10 gae_duplicate tensor(0.0475, dtype=torch.float64) tensor(-2.3012, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1102, dtype=torch.float64) delta_t tensor(-0.0330, dtype=torch.float64)
9 gae_duplicate tensor(-0.1698, dtype=torch.float64) tensor(0.4983, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4551, dtype=torch.float64) delta_t tensor(0.0625, dtype=torch.float64)
8 gae_duplicate tensor(-0.0517, dtype=torch.float64) tensor(-1.1741, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1039, dtype=torch.float64) delta_t tensor(-0.1033, dtype=torch.float64)
7 gae_duplicate tensor(-0.2807, dtype=torch.float64) tensor(1.9703, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3757, dtype=torch.float64) delta_t tensor(0.5447, dtype=torch.float64)
6 gae_duplicate tensor(0.1969, dtype=torch.float64) tensor(-10.7440, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4110, dtype=torch.float64) delta_t tensor(-0.0185, dtype=torch.float64)
5 gae_duplicate tensor(-0.3803, dtype=torch.float64) tensor(-0.7054, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8298, dtype=torch.float64) delta_t tensor(-0.2473, dtype=torch.float64)
4 gae_duplicate tensor(-3.1659, dtype=torch.float64) tensor(5.6544, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0153, dtype=torch.float64) delta_t tensor(0.5620, dtype=torch.float64)
3 gae_duplicate tensor(-0.5896, dtype=torch.float64) tensor(-10.5922, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3668, dtype=torch.float64) delta_t tensor(-0.0404, dtype=torch.float64)
2 gae_duplicate tensor(-0.3743, dtype=torch.float64) tensor(-0.1633, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1013.8338623046875
value loss:93.53865814208984
entropies:354.1978454589844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.84325098991394 seconds
19 rew tensor(0.5285, dtype=torch.float64) delta_t tensor(0.1124, dtype=torch.float64)
19 gae_duplicate tensor(-0.0180, dtype=torch.float64) tensor(-2.0958, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4413, dtype=torch.float64) delta_t tensor(0.0277, dtype=torch.float64)
18 gae_duplicate tensor(-0.0895, dtype=torch.float64) tensor(-0.7368, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4741, dtype=torch.float64) delta_t tensor(0.1911, dtype=torch.float64)
17 gae_duplicate tensor(0.0616, dtype=torch.float64) tensor(-3.8010, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4898, dtype=torch.float64) delta_t tensor(0.0829, dtype=torch.float64)
16 gae_duplicate tensor(-0.0683, dtype=torch.float64) tensor(-2.0594, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2720, dtype=torch.float64) delta_t tensor(0.0543, dtype=torch.float64)
15 gae_duplicate tensor(-0.0030, dtype=torch.float64) tensor(-1.2342, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5032, dtype=torch.float64) delta_t tensor(0.0214, dtype=torch.float64)
14 gae_duplicate tensor(-0.0215, dtype=torch.float64) tensor(-0.5492, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2799, dtype=torch.float64) delta_t tensor(-0.0114, dtype=torch.float64)
13 gae_duplicate tensor(-0.1524, dtype=torch.float64) tensor(0.2398, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5110, dtype=torch.float64) delta_t tensor(-0.0031, dtype=torch.float64)
12 gae_duplicate tensor(-0.0891, dtype=torch.float64) tensor(0.1615, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2803, dtype=torch.float64) delta_t tensor(0.0248, dtype=torch.float64)
11 gae_duplicate tensor(-0.0683, dtype=torch.float64) tensor(-0.5012, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4906, dtype=torch.float64) delta_t tensor(0.1359, dtype=torch.float64)
10 gae_duplicate tensor(-0.0280, dtype=torch.float64) tensor(-2.7340, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2243, dtype=torch.float64) delta_t tensor(-0.1743, dtype=torch.float64)
9 gae_duplicate tensor(-0.8167, dtype=torch.float64) tensor(3.1728, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2616, dtype=torch.float64) delta_t tensor(-1.6488, dtype=torch.float64)
8 gae_duplicate tensor(-5.8655, dtype=torch.float64) tensor(33.9520, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0400, dtype=torch.float64) delta_t tensor(-0.1222, dtype=torch.float64)
7 gae_duplicate tensor(-1.1193, dtype=torch.float64) tensor(5.5221, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3154, dtype=torch.float64) delta_t tensor(0.2075, dtype=torch.float64)
6 gae_duplicate tensor(-0.0448, dtype=torch.float64) tensor(-3.5132, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1205, dtype=torch.float64) delta_t tensor(0.0889, dtype=torch.float64)
5 gae_duplicate tensor(-0.0504, dtype=torch.float64) tensor(-2.0381, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1218, dtype=torch.float64) delta_t tensor(0.8387, dtype=torch.float64)
4 gae_duplicate tensor(-3.9652, dtype=torch.float64) tensor(-16.8368, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1480, dtype=torch.float64) delta_t tensor(0.3093, dtype=torch.float64)
3 gae_duplicate tensor(-0.1961, dtype=torch.float64) tensor(-7.2882, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2592, dtype=torch.float64) delta_t tensor(0.1670, dtype=torch.float64)
2 gae_duplicate tensor(-0.0793, dtype=torch.float64) tensor(-4.0524, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:141.48974609375
value loss:149.90609741210938
entropies:354.39959716796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.011971712112427 seconds
19 rew tensor(0.4649, dtype=torch.float64) delta_t tensor(0.0490, dtype=torch.float64)
19 gae_duplicate tensor(-0.0915, dtype=torch.float64) tensor(-1.0261, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3966, dtype=torch.float64) delta_t tensor(0.0354, dtype=torch.float64)
18 gae_duplicate tensor(-0.2186, dtype=torch.float64) tensor(-0.7596, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4014, dtype=torch.float64) delta_t tensor(0.3211, dtype=torch.float64)
17 gae_duplicate tensor(-0.0167, dtype=torch.float64) tensor(-6.6713, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4474, dtype=torch.float64) delta_t tensor(0.0396, dtype=torch.float64)
16 gae_duplicate tensor(-0.0495, dtype=torch.float64) tensor(-1.4785, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2720, dtype=torch.float64) delta_t tensor(0.0755, dtype=torch.float64)
15 gae_duplicate tensor(-0.0170, dtype=torch.float64) tensor(-1.5744, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4477, dtype=torch.float64) delta_t tensor(0.1107, dtype=torch.float64)
14 gae_duplicate tensor(-0.0394, dtype=torch.float64) tensor(-2.3388, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1552, dtype=torch.float64) delta_t tensor(-0.0329, dtype=torch.float64)
13 gae_duplicate tensor(-0.1436, dtype=torch.float64) tensor(0.3556, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4476, dtype=torch.float64) delta_t tensor(0.0092, dtype=torch.float64)
12 gae_duplicate tensor(-0.0975, dtype=torch.float64) tensor(-0.1115, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1330, dtype=torch.float64) delta_t tensor(-0.0252, dtype=torch.float64)
11 gae_duplicate tensor(-0.1479, dtype=torch.float64) tensor(0.5099, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4479, dtype=torch.float64) delta_t tensor(0.0755, dtype=torch.float64)
10 gae_duplicate tensor(-0.0712, dtype=torch.float64) tensor(-1.3749, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0966, dtype=torch.float64) delta_t tensor(-0.0548, dtype=torch.float64)
9 gae_duplicate tensor(-0.1919, dtype=torch.float64) tensor(0.9234, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4032, dtype=torch.float64) delta_t tensor(0.0019, dtype=torch.float64)
8 gae_duplicate tensor(-0.0821, dtype=torch.float64) tensor(0.0585, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0664, dtype=torch.float64) delta_t tensor(-0.1707, dtype=torch.float64)
7 gae_duplicate tensor(-0.5496, dtype=torch.float64) tensor(3.4995, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3404, dtype=torch.float64) delta_t tensor(0.2240, dtype=torch.float64)
6 gae_duplicate tensor(0.1380, dtype=torch.float64) tensor(-4.0429, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1813, dtype=torch.float64) delta_t tensor(0.1649, dtype=torch.float64)
5 gae_duplicate tensor(-0.0136, dtype=torch.float64) tensor(-3.7496, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5121, dtype=torch.float64) delta_t tensor(-0.8974, dtype=torch.float64)
4 gae_duplicate tensor(-5.3289, dtype=torch.float64) tensor(17.4909, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0391, dtype=torch.float64) delta_t tensor(0.4470, dtype=torch.float64)
3 gae_duplicate tensor(-0.2600, dtype=torch.float64) tensor(-7.3749, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2415, dtype=torch.float64) delta_t tensor(0.0710, dtype=torch.float64)
2 gae_duplicate tensor(-0.1826, dtype=torch.float64) tensor(-2.0761, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:430.3023681640625
value loss:61.39870834350586
entropies:354.440185546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.754115104675293 seconds
19 rew tensor(0.4485, dtype=torch.float64) delta_t tensor(-0.0191, dtype=torch.float64)
19 gae_duplicate tensor(-0.1141, dtype=torch.float64) tensor(0.3780, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4192, dtype=torch.float64) delta_t tensor(0.0151, dtype=torch.float64)
18 gae_duplicate tensor(-0.0623, dtype=torch.float64) tensor(-0.2455, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4264, dtype=torch.float64) delta_t tensor(0.0325, dtype=torch.float64)
17 gae_duplicate tensor(-0.1538, dtype=torch.float64) tensor(-0.6607, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4482, dtype=torch.float64) delta_t tensor(0.0509, dtype=torch.float64)
16 gae_duplicate tensor(-0.0579, dtype=torch.float64) tensor(-1.0041, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3292, dtype=torch.float64) delta_t tensor(-0.0079, dtype=torch.float64)
15 gae_duplicate tensor(-0.1625, dtype=torch.float64) tensor(0.1346, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4280, dtype=torch.float64) delta_t tensor(0.0578, dtype=torch.float64)
14 gae_duplicate tensor(0.0251, dtype=torch.float64) tensor(-1.1594, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2891, dtype=torch.float64) delta_t tensor(0.0218, dtype=torch.float64)
13 gae_duplicate tensor(-0.0754, dtype=torch.float64) tensor(-0.5635, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4557, dtype=torch.float64) delta_t tensor(-0.0317, dtype=torch.float64)
12 gae_duplicate tensor(-0.0676, dtype=torch.float64) tensor(0.5767, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2542, dtype=torch.float64) delta_t tensor(-0.0160, dtype=torch.float64)
11 gae_duplicate tensor(-0.1344, dtype=torch.float64) tensor(0.3142, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4266, dtype=torch.float64) delta_t tensor(0.0121, dtype=torch.float64)
10 gae_duplicate tensor(-0.0705, dtype=torch.float64) tensor(-0.1921, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2247, dtype=torch.float64) delta_t tensor(-0.0120, dtype=torch.float64)
9 gae_duplicate tensor(-0.1462, dtype=torch.float64) tensor(0.2016, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3856, dtype=torch.float64) delta_t tensor(-0.0282, dtype=torch.float64)
8 gae_duplicate tensor(-0.2001, dtype=torch.float64) tensor(0.6514, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1844, dtype=torch.float64) delta_t tensor(-0.0740, dtype=torch.float64)
7 gae_duplicate tensor(-0.2700, dtype=torch.float64) tensor(1.5188, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2564, dtype=torch.float64) delta_t tensor(0.1939, dtype=torch.float64)
6 gae_duplicate tensor(-0.0446, dtype=torch.float64) tensor(-3.7299, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1715, dtype=torch.float64) delta_t tensor(0.1656, dtype=torch.float64)
5 gae_duplicate tensor(-0.1421, dtype=torch.float64) tensor(-3.5111, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0570, dtype=torch.float64) delta_t tensor(-0.5195, dtype=torch.float64)
4 gae_duplicate tensor(-3.4962, dtype=torch.float64) tensor(9.7459, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0077, dtype=torch.float64) delta_t tensor(0.6621, dtype=torch.float64)
3 gae_duplicate tensor(-0.1864, dtype=torch.float64) tensor(-11.3367, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3136, dtype=torch.float64) delta_t tensor(-0.0256, dtype=torch.float64)
2 gae_duplicate tensor(-0.2889, dtype=torch.float64) tensor(-0.8117, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:427.7159118652344
value loss:57.74882507324219
entropies:354.5524597167969
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3974.1545)
ToM Target loss= tensor(3589.4062)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.0567121505737305 seconds
19 rew tensor(0.4559, dtype=torch.float64) delta_t tensor(0.0670, dtype=torch.float64)
19 gae_duplicate tensor(-0.0469, dtype=torch.float64) tensor(-1.4046, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3963, dtype=torch.float64) delta_t tensor(-0.0633, dtype=torch.float64)
18 gae_duplicate tensor(-0.2767, dtype=torch.float64) tensor(1.1504, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3170, dtype=torch.float64) delta_t tensor(0.1571, dtype=torch.float64)
17 gae_duplicate tensor(-0.0470, dtype=torch.float64) tensor(-3.0068, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5271, dtype=torch.float64) delta_t tensor(-0.0145, dtype=torch.float64)
16 gae_duplicate tensor(-0.0867, dtype=torch.float64) tensor(0.0229, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0368, dtype=torch.float64) delta_t tensor(-0.0220, dtype=torch.float64)
15 gae_duplicate tensor(-0.2805, dtype=torch.float64) tensor(0.4003, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5426, dtype=torch.float64) delta_t tensor(0.0275, dtype=torch.float64)
14 gae_duplicate tensor(-0.0397, dtype=torch.float64) tensor(-0.4519, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0384, dtype=torch.float64) delta_t tensor(-0.1184, dtype=torch.float64)
13 gae_duplicate tensor(-0.2806, dtype=torch.float64) tensor(2.4172, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5421, dtype=torch.float64) delta_t tensor(0.0262, dtype=torch.float64)
12 gae_duplicate tensor(-0.0241, dtype=torch.float64) tensor(-0.2836, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0523, dtype=torch.float64) delta_t tensor(-0.1178, dtype=torch.float64)
11 gae_duplicate tensor(-0.1498, dtype=torch.float64) tensor(2.3363, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5272, dtype=torch.float64) delta_t tensor(0.0792, dtype=torch.float64)
10 gae_duplicate tensor(0.0392, dtype=torch.float64) tensor(-1.3698, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0671, dtype=torch.float64) delta_t tensor(-0.1323, dtype=torch.float64)
9 gae_duplicate tensor(-0.2070, dtype=torch.float64) tensor(2.4897, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4763, dtype=torch.float64) delta_t tensor(-0.0786, dtype=torch.float64)
8 gae_duplicate tensor(-0.1191, dtype=torch.float64) tensor(1.7429, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1107, dtype=torch.float64) delta_t tensor(-0.1783, dtype=torch.float64)
7 gae_duplicate tensor(-0.4100, dtype=torch.float64) tensor(3.7499, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4264, dtype=torch.float64) delta_t tensor(0.1827, dtype=torch.float64)
6 gae_duplicate tensor(0.0976, dtype=torch.float64) tensor(-3.3092, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3142, dtype=torch.float64) delta_t tensor(0.0838, dtype=torch.float64)
5 gae_duplicate tensor(-0.1054, dtype=torch.float64) tensor(-2.1872, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1905, dtype=torch.float64) delta_t tensor(-0.2162, dtype=torch.float64)
4 gae_duplicate tensor(-4.4737, dtype=torch.float64) tensor(4.4318, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1828, dtype=torch.float64) delta_t tensor(-0.0074, dtype=torch.float64)
3 gae_duplicate tensor(-0.4589, dtype=torch.float64) tensor(0.3975, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2684, dtype=torch.float64) delta_t tensor(0.0285, dtype=torch.float64)
2 gae_duplicate tensor(-0.2359, dtype=torch.float64) tensor(-0.5065, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-453.1618347167969
value loss:48.6866455078125
entropies:354.5152893066406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6842429637908936 seconds
19 rew tensor(0.4527, dtype=torch.float64) delta_t tensor(-0.0957, dtype=torch.float64)
19 gae_duplicate tensor(-0.3181, dtype=torch.float64) tensor(1.8674, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4958, dtype=torch.float64) delta_t tensor(0.0227, dtype=torch.float64)
18 gae_duplicate tensor(-0.1631, dtype=torch.float64) tensor(-0.2157, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3976, dtype=torch.float64) delta_t tensor(-0.0072, dtype=torch.float64)
17 gae_duplicate tensor(-0.2520, dtype=torch.float64) tensor(0.1170, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4806, dtype=torch.float64) delta_t tensor(0.0073, dtype=torch.float64)
16 gae_duplicate tensor(-0.1023, dtype=torch.float64) tensor(-0.1475, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3269, dtype=torch.float64) delta_t tensor(0.0160, dtype=torch.float64)
15 gae_duplicate tensor(-0.1493, dtype=torch.float64) tensor(-0.4261, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5241, dtype=torch.float64) delta_t tensor(0.0646, dtype=torch.float64)
14 gae_duplicate tensor(-0.0651, dtype=torch.float64) tensor(-1.2802, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2435, dtype=torch.float64) delta_t tensor(-0.0519, dtype=torch.float64)
13 gae_duplicate tensor(-0.1190, dtype=torch.float64) tensor(0.9661, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5094, dtype=torch.float64) delta_t tensor(0.0304, dtype=torch.float64)
12 gae_duplicate tensor(-0.0568, dtype=torch.float64) tensor(-0.5085, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2148, dtype=torch.float64) delta_t tensor(-0.0175, dtype=torch.float64)
11 gae_duplicate tensor(-0.1644, dtype=torch.float64) tensor(0.3234, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5019, dtype=torch.float64) delta_t tensor(0.0514, dtype=torch.float64)
10 gae_duplicate tensor(-0.0345, dtype=torch.float64) tensor(-0.9959, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1511, dtype=torch.float64) delta_t tensor(-0.3459, dtype=torch.float64)
9 gae_duplicate tensor(-1.9636, dtype=torch.float64) tensor(6.4621, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5626, dtype=torch.float64) delta_t tensor(-1.0030, dtype=torch.float64)
8 gae_duplicate tensor(-6.0044, dtype=torch.float64) tensor(22.2441, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0875, dtype=torch.float64) delta_t tensor(0.0945, dtype=torch.float64)
7 gae_duplicate tensor(-0.3790, dtype=torch.float64) tensor(0.0951, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3417, dtype=torch.float64) delta_t tensor(0.1875, dtype=torch.float64)
6 gae_duplicate tensor(0.0321, dtype=torch.float64) tensor(-3.7021, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2301, dtype=torch.float64) delta_t tensor(0.3357, dtype=torch.float64)
5 gae_duplicate tensor(0.0749, dtype=torch.float64) tensor(-6.9469, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4121, dtype=torch.float64) delta_t tensor(-1.4622, dtype=torch.float64)
4 gae_duplicate tensor(-3.8119, dtype=torch.float64) tensor(28.0160, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0540, dtype=torch.float64) delta_t tensor(-0.0036, dtype=torch.float64)
3 gae_duplicate tensor(-0.4089, dtype=torch.float64) tensor(2.8360, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1773, dtype=torch.float64) delta_t tensor(0.0711, dtype=torch.float64)
2 gae_duplicate tensor(-0.3205, dtype=torch.float64) tensor(-1.2454, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2658.480224609375
value loss:106.76220703125
entropies:354.4639587402344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.798676252365112 seconds
19 rew tensor(0.3659, dtype=torch.float64) delta_t tensor(0.0758, dtype=torch.float64)
19 gae_duplicate tensor(-0.1680, dtype=torch.float64) tensor(-1.4954, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4256, dtype=torch.float64) delta_t tensor(-0.0422, dtype=torch.float64)
18 gae_duplicate tensor(-0.2729, dtype=torch.float64) tensor(0.6351, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3074, dtype=torch.float64) delta_t tensor(0.1517, dtype=torch.float64)
17 gae_duplicate tensor(-0.1219, dtype=torch.float64) tensor(-2.9273, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4978, dtype=torch.float64) delta_t tensor(-0.0360, dtype=torch.float64)
16 gae_duplicate tensor(-0.0820, dtype=torch.float64) tensor(0.3648, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0377, dtype=torch.float64) delta_t tensor(-0.0527, dtype=torch.float64)
15 gae_duplicate tensor(-0.1981, dtype=torch.float64) tensor(1.0927, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4924, dtype=torch.float64) delta_t tensor(0.0452, dtype=torch.float64)
14 gae_duplicate tensor(-0.0763, dtype=torch.float64) tensor(-0.8371, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0660, dtype=torch.float64) delta_t tensor(-0.0498, dtype=torch.float64)
13 gae_duplicate tensor(-0.2757, dtype=torch.float64) tensor(0.8450, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5129, dtype=torch.float64) delta_t tensor(-0.0217, dtype=torch.float64)
12 gae_duplicate tensor(-0.1115, dtype=torch.float64) tensor(0.4853, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0581, dtype=torch.float64) delta_t tensor(-0.0548, dtype=torch.float64)
11 gae_duplicate tensor(-0.1361, dtype=torch.float64) tensor(1.1787, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4694, dtype=torch.float64) delta_t tensor(0.0686, dtype=torch.float64)
10 gae_duplicate tensor(-0.0552, dtype=torch.float64) tensor(-1.2572, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0386, dtype=torch.float64) delta_t tensor(-0.0984, dtype=torch.float64)
9 gae_duplicate tensor(-0.2254, dtype=torch.float64) tensor(1.7283, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4694, dtype=torch.float64) delta_t tensor(-0.0482, dtype=torch.float64)
8 gae_duplicate tensor(-0.1077, dtype=torch.float64) tensor(1.0910, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0233, dtype=torch.float64) delta_t tensor(-0.0962, dtype=torch.float64)
7 gae_duplicate tensor(-0.2546, dtype=torch.float64) tensor(1.8914, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3823, dtype=torch.float64) delta_t tensor(0.1602, dtype=torch.float64)
6 gae_duplicate tensor(0.0832, dtype=torch.float64) tensor(-3.0537, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1957, dtype=torch.float64) delta_t tensor(0.0243, dtype=torch.float64)
5 gae_duplicate tensor(-0.1135, dtype=torch.float64) tensor(-0.7710, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4888, dtype=torch.float64) delta_t tensor(0.6047, dtype=torch.float64)
4 gae_duplicate tensor(-2.1272, dtype=torch.float64) tensor(-11.0956, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1383, dtype=torch.float64) delta_t tensor(-0.2429, dtype=torch.float64)
3 gae_duplicate tensor(-0.3697, dtype=torch.float64) tensor(3.5551, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2812, dtype=torch.float64) delta_t tensor(0.0149, dtype=torch.float64)
2 gae_duplicate tensor(-0.2456, dtype=torch.float64) tensor(0.0330, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:365.35052490234375
value loss:28.1004695892334
entropies:354.2773742675781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.687989950180054 seconds
19 rew tensor(0.4583, dtype=torch.float64) delta_t tensor(-0.0598, dtype=torch.float64)
19 gae_duplicate tensor(-0.1743, dtype=torch.float64) tensor(1.1798, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3497, dtype=torch.float64) delta_t tensor(0.0636, dtype=torch.float64)
18 gae_duplicate tensor(-0.0064, dtype=torch.float64) tensor(-1.1902, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4128, dtype=torch.float64) delta_t tensor(0.0912, dtype=torch.float64)
17 gae_duplicate tensor(-0.0830, dtype=torch.float64) tensor(-1.8335, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3918, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
16 gae_duplicate tensor(-0.0386, dtype=torch.float64) tensor(-0.7102, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2638, dtype=torch.float64) delta_t tensor(-0.0014, dtype=torch.float64)
15 gae_duplicate tensor(-0.2476, dtype=torch.float64) tensor(-0.1683, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4140, dtype=torch.float64) delta_t tensor(0.0699, dtype=torch.float64)
14 gae_duplicate tensor(-0.0737, dtype=torch.float64) tensor(-1.4667, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1752, dtype=torch.float64) delta_t tensor(-0.0864, dtype=torch.float64)
13 gae_duplicate tensor(-0.3020, dtype=torch.float64) tensor(1.4674, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3947, dtype=torch.float64) delta_t tensor(0.0390, dtype=torch.float64)
12 gae_duplicate tensor(-0.1085, dtype=torch.float64) tensor(-0.5906, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1942, dtype=torch.float64) delta_t tensor(-0.0655, dtype=torch.float64)
11 gae_duplicate tensor(-0.1513, dtype=torch.float64) tensor(1.1738, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3453, dtype=torch.float64) delta_t tensor(0.0382, dtype=torch.float64)
10 gae_duplicate tensor(-0.1753, dtype=torch.float64) tensor(-0.5654, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1184, dtype=torch.float64) delta_t tensor(-0.3421, dtype=torch.float64)
9 gae_duplicate tensor(-1.5694, dtype=torch.float64) tensor(6.1978, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3241, dtype=torch.float64) delta_t tensor(0.0546, dtype=torch.float64)
8 gae_duplicate tensor(-0.0841, dtype=torch.float64) tensor(-0.4476, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1222, dtype=torch.float64) delta_t tensor(-0.1484, dtype=torch.float64)
7 gae_duplicate tensor(-0.4458, dtype=torch.float64) tensor(2.8235, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2503, dtype=torch.float64) delta_t tensor(0.2513, dtype=torch.float64)
6 gae_duplicate tensor(0.1201, dtype=torch.float64) tensor(-4.7516, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3852, dtype=torch.float64) delta_t tensor(-0.0522, dtype=torch.float64)
5 gae_duplicate tensor(-1.7214, dtype=torch.float64) tensor(0.4969, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6862, dtype=torch.float64) delta_t tensor(-0.2589, dtype=torch.float64)
4 gae_duplicate tensor(-4.4237, dtype=torch.float64) tensor(3.6148, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0997, dtype=torch.float64) delta_t tensor(0.1161, dtype=torch.float64)
3 gae_duplicate tensor(-0.2032, dtype=torch.float64) tensor(-1.6835, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3486, dtype=torch.float64) delta_t tensor(-0.0977, dtype=torch.float64)
2 gae_duplicate tensor(-0.3958, dtype=torch.float64) tensor(1.9322, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-391.4310302734375
value loss:78.14321899414062
entropies:354.0208740234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.814947128295898 seconds
19 rew tensor(0.4031, dtype=torch.float64) delta_t tensor(-0.0064, dtype=torch.float64)
19 gae_duplicate tensor(-0.0946, dtype=torch.float64) tensor(0.1912, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4191, dtype=torch.float64) delta_t tensor(0.0062, dtype=torch.float64)
18 gae_duplicate tensor(-0.0739, dtype=torch.float64) tensor(-0.0685, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3824, dtype=torch.float64) delta_t tensor(0.0641, dtype=torch.float64)
17 gae_duplicate tensor(-0.0903, dtype=torch.float64) tensor(-1.2987, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4075, dtype=torch.float64) delta_t tensor(-0.0011, dtype=torch.float64)
16 gae_duplicate tensor(-0.0839, dtype=torch.float64) tensor(-0.0382, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3708, dtype=torch.float64) delta_t tensor(0.1430, dtype=torch.float64)
15 gae_duplicate tensor(-0.0106, dtype=torch.float64) tensor(-2.7672, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4337, dtype=torch.float64) delta_t tensor(0.0598, dtype=torch.float64)
14 gae_duplicate tensor(-0.0442, dtype=torch.float64) tensor(-1.4299, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3245, dtype=torch.float64) delta_t tensor(0.0654, dtype=torch.float64)
13 gae_duplicate tensor(-0.0004, dtype=torch.float64) tensor(-1.4227, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4483, dtype=torch.float64) delta_t tensor(-0.0086, dtype=torch.float64)
12 gae_duplicate tensor(-0.0553, dtype=torch.float64) tensor(0.0695, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3248, dtype=torch.float64) delta_t tensor(0.0806, dtype=torch.float64)
11 gae_duplicate tensor(-0.0277, dtype=torch.float64) tensor(-1.6885, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3992, dtype=torch.float64) delta_t tensor(0.0610, dtype=torch.float64)
10 gae_duplicate tensor(0.0089, dtype=torch.float64) tensor(-1.2729, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2704, dtype=torch.float64) delta_t tensor(0.0654, dtype=torch.float64)
9 gae_duplicate tensor(-0.0155, dtype=torch.float64) tensor(-1.4372, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3975, dtype=torch.float64) delta_t tensor(0.0247, dtype=torch.float64)
8 gae_duplicate tensor(-0.0404, dtype=torch.float64) tensor(-0.6592, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2283, dtype=torch.float64) delta_t tensor(-0.0463, dtype=torch.float64)
7 gae_duplicate tensor(-0.3045, dtype=torch.float64) tensor(0.8137, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2822, dtype=torch.float64) delta_t tensor(0.2027, dtype=torch.float64)
6 gae_duplicate tensor(0.0843, dtype=torch.float64) tensor(-3.6747, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0244, dtype=torch.float64) delta_t tensor(0.2692, dtype=torch.float64)
5 gae_duplicate tensor(0.1156, dtype=torch.float64) tensor(-5.6274, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.6629, dtype=torch.float64) delta_t tensor(-3.1603, dtype=torch.float64)
4 gae_duplicate tensor(-6.4761, dtype=torch.float64) tensor(62.9258, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0404, dtype=torch.float64) delta_t tensor(0.0737, dtype=torch.float64)
3 gae_duplicate tensor(-0.4061, dtype=torch.float64) tensor(4.6288, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2357, dtype=torch.float64) delta_t tensor(0.0792, dtype=torch.float64)
2 gae_duplicate tensor(-0.2281, dtype=torch.float64) tensor(-1.0348, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2590.85595703125
value loss:140.92965698242188
entropies:353.94146728515625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3940.7935)
ToM Target loss= tensor(3626.1182)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.86127781867981 seconds
19 rew tensor(0.4766, dtype=torch.float64) delta_t tensor(0.0926, dtype=torch.float64)
19 gae_duplicate tensor(-0.0150, dtype=torch.float64) tensor(-1.7216, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4873, dtype=torch.float64) delta_t tensor(0.0225, dtype=torch.float64)
18 gae_duplicate tensor(-0.1404, dtype=torch.float64) tensor(-0.6551, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3818, dtype=torch.float64) delta_t tensor(0.1202, dtype=torch.float64)
17 gae_duplicate tensor(-0.0347, dtype=torch.float64) tensor(-2.4128, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5150, dtype=torch.float64) delta_t tensor(0.1162, dtype=torch.float64)
16 gae_duplicate tensor(0.0474, dtype=torch.float64) tensor(-2.5394, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2463, dtype=torch.float64) delta_t tensor(0.0895, dtype=torch.float64)
15 gae_duplicate tensor(-0.0052, dtype=torch.float64) tensor(-2.0588, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5207, dtype=torch.float64) delta_t tensor(0.1033, dtype=torch.float64)
14 gae_duplicate tensor(0.0272, dtype=torch.float64) tensor(-2.1159, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2616, dtype=torch.float64) delta_t tensor(0.1060, dtype=torch.float64)
13 gae_duplicate tensor(-0.0034, dtype=torch.float64) tensor(-2.2678, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4643, dtype=torch.float64) delta_t tensor(0.0252, dtype=torch.float64)
12 gae_duplicate tensor(-0.0315, dtype=torch.float64) tensor(-0.7151, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2129, dtype=torch.float64) delta_t tensor(0.1107, dtype=torch.float64)
11 gae_duplicate tensor(-0.0157, dtype=torch.float64) tensor(-2.1243, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4915, dtype=torch.float64) delta_t tensor(0.1622, dtype=torch.float64)
10 gae_duplicate tensor(0.0919, dtype=torch.float64) tensor(-3.3713, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1280, dtype=torch.float64) delta_t tensor(-0.2593, dtype=torch.float64)
9 gae_duplicate tensor(-1.5629, dtype=torch.float64) tensor(4.5442, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1437, dtype=torch.float64) delta_t tensor(-0.5689, dtype=torch.float64)
8 gae_duplicate tensor(-3.3967, dtype=torch.float64) tensor(11.7197, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2192, dtype=torch.float64) delta_t tensor(0.0693, dtype=torch.float64)
7 gae_duplicate tensor(-0.1759, dtype=torch.float64) tensor(-0.1091, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0024, dtype=torch.float64) delta_t tensor(-0.1273, dtype=torch.float64)
6 gae_duplicate tensor(-1.3613, dtype=torch.float64) tensor(2.1663, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3944, dtype=torch.float64) delta_t tensor(0.2756, dtype=torch.float64)
5 gae_duplicate tensor(-0.7137, dtype=torch.float64) tensor(-5.6357, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6873, dtype=torch.float64) delta_t tensor(-0.8440, dtype=torch.float64)
4 gae_duplicate tensor(-2.9227, dtype=torch.float64) tensor(17.0511, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2398, dtype=torch.float64) delta_t tensor(-0.0731, dtype=torch.float64)
3 gae_duplicate tensor(-0.4804, dtype=torch.float64) tensor(3.0891, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0699, dtype=torch.float64) delta_t tensor(0.2424, dtype=torch.float64)
2 gae_duplicate tensor(-0.0681, dtype=torch.float64) tensor(-4.4184, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-550.4491577148438
value loss:52.85194396972656
entropies:353.69793701171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.962646961212158 seconds
19 rew tensor(0.5099, dtype=torch.float64) delta_t tensor(0.1389, dtype=torch.float64)
19 gae_duplicate tensor(0.0759, dtype=torch.float64) tensor(-2.5657, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3768, dtype=torch.float64) delta_t tensor(-0.0467, dtype=torch.float64)
18 gae_duplicate tensor(-0.0598, dtype=torch.float64) tensor(0.6507, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3363, dtype=torch.float64) delta_t tensor(0.2616, dtype=torch.float64)
17 gae_duplicate tensor(0.1088, dtype=torch.float64) tensor(-5.0563, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4808, dtype=torch.float64) delta_t tensor(0.0351, dtype=torch.float64)
16 gae_duplicate tensor(-0.0655, dtype=torch.float64) tensor(-1.2755, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0693, dtype=torch.float64) delta_t tensor(0.0838, dtype=torch.float64)
15 gae_duplicate tensor(-0.1042, dtype=torch.float64) tensor(-1.7449, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5510, dtype=torch.float64) delta_t tensor(0.0719, dtype=torch.float64)
14 gae_duplicate tensor(0.0203, dtype=torch.float64) tensor(-1.5820, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0063, dtype=torch.float64) delta_t tensor(-0.0561, dtype=torch.float64)
13 gae_duplicate tensor(-0.1579, dtype=torch.float64) tensor(0.9614, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5437, dtype=torch.float64) delta_t tensor(0.0720, dtype=torch.float64)
12 gae_duplicate tensor(-0.0292, dtype=torch.float64) tensor(-1.3527, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0159, dtype=torch.float64) delta_t tensor(0.0935, dtype=torch.float64)
11 gae_duplicate tensor(0.0213, dtype=torch.float64) tensor(-2.0045, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5217, dtype=torch.float64) delta_t tensor(0.1553, dtype=torch.float64)
10 gae_duplicate tensor(0.0988, dtype=torch.float64) tensor(-3.2808, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0070, dtype=torch.float64) delta_t tensor(0.0125, dtype=torch.float64)
9 gae_duplicate tensor(-0.0565, dtype=torch.float64) tensor(-0.5739, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5074, dtype=torch.float64) delta_t tensor(-0.0072, dtype=torch.float64)
8 gae_duplicate tensor(-0.0461, dtype=torch.float64) tensor(0.0731, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0364, dtype=torch.float64) delta_t tensor(-0.0750, dtype=torch.float64)
7 gae_duplicate tensor(-0.2752, dtype=torch.float64) tensor(1.4240, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4270, dtype=torch.float64) delta_t tensor(0.2099, dtype=torch.float64)
6 gae_duplicate tensor(0.1533, dtype=torch.float64) tensor(-4.0620, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2106, dtype=torch.float64) delta_t tensor(0.3836, dtype=torch.float64)
5 gae_duplicate tensor(0.0858, dtype=torch.float64) tensor(-8.0118, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6229, dtype=torch.float64) delta_t tensor(-0.4644, dtype=torch.float64)
4 gae_duplicate tensor(-2.9623, dtype=torch.float64) tensor(7.6023, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1303, dtype=torch.float64) delta_t tensor(-0.0346, dtype=torch.float64)
3 gae_duplicate tensor(-0.4251, dtype=torch.float64) tensor(1.5469, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1304, dtype=torch.float64) delta_t tensor(0.2707, dtype=torch.float64)
2 gae_duplicate tensor(-0.0457, dtype=torch.float64) tensor(-5.2789, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1229.2579345703125
value loss:36.89231872558594
entropies:353.30194091796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.014523029327393 seconds
19 rew tensor(0.4348, dtype=torch.float64) delta_t tensor(0.0709, dtype=torch.float64)
19 gae_duplicate tensor(-0.0575, dtype=torch.float64) tensor(-1.2548, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3939, dtype=torch.float64) delta_t tensor(0.0517, dtype=torch.float64)
18 gae_duplicate tensor(-0.1572, dtype=torch.float64) tensor(-1.1436, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3786, dtype=torch.float64) delta_t tensor(0.1672, dtype=torch.float64)
17 gae_duplicate tensor(-0.0286, dtype=torch.float64) tensor(-3.2241, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4493, dtype=torch.float64) delta_t tensor(0.1378, dtype=torch.float64)
16 gae_duplicate tensor(0.0635, dtype=torch.float64) tensor(-2.8857, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0940, dtype=torch.float64) delta_t tensor(-0.0268, dtype=torch.float64)
15 gae_duplicate tensor(-0.7402, dtype=torch.float64) tensor(-0.2053, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4557, dtype=torch.float64) delta_t tensor(0.1516, dtype=torch.float64)
14 gae_duplicate tensor(0.1133, dtype=torch.float64) tensor(-2.9361, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1570, dtype=torch.float64) delta_t tensor(0.0702, dtype=torch.float64)
13 gae_duplicate tensor(-0.1889, dtype=torch.float64) tensor(-1.7126, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4628, dtype=torch.float64) delta_t tensor(0.0747, dtype=torch.float64)
12 gae_duplicate tensor(0.0313, dtype=torch.float64) tensor(-1.6513, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1198, dtype=torch.float64) delta_t tensor(0.0346, dtype=torch.float64)
11 gae_duplicate tensor(-0.0470, dtype=torch.float64) tensor(-0.8781, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4480, dtype=torch.float64) delta_t tensor(0.1651, dtype=torch.float64)
10 gae_duplicate tensor(0.0994, dtype=torch.float64) tensor(-3.1261, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1726, dtype=torch.float64) delta_t tensor(-0.2348, dtype=torch.float64)
9 gae_duplicate tensor(-1.4325, dtype=torch.float64) tensor(4.3128, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4268, dtype=torch.float64) delta_t tensor(0.0761, dtype=torch.float64)
8 gae_duplicate tensor(-0.0229, dtype=torch.float64) tensor(-1.1401, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0847, dtype=torch.float64) delta_t tensor(0.0060, dtype=torch.float64)
7 gae_duplicate tensor(-0.1439, dtype=torch.float64) tensor(-0.2105, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2956, dtype=torch.float64) delta_t tensor(0.2727, dtype=torch.float64)
6 gae_duplicate tensor(0.0636, dtype=torch.float64) tensor(-5.3953, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1882, dtype=torch.float64) delta_t tensor(0.2584, dtype=torch.float64)
5 gae_duplicate tensor(-0.0340, dtype=torch.float64) tensor(-5.7771, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5764, dtype=torch.float64) delta_t tensor(-1.5640, dtype=torch.float64)
4 gae_duplicate tensor(-5.2868, dtype=torch.float64) tensor(28.0053, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0631, dtype=torch.float64) delta_t tensor(0.1355, dtype=torch.float64)
3 gae_duplicate tensor(-0.2961, dtype=torch.float64) tensor(0.5524, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2779, dtype=torch.float64) delta_t tensor(0.0783, dtype=torch.float64)
2 gae_duplicate tensor(-0.1174, dtype=torch.float64) tensor(-1.2261, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-100.94135284423828
value loss:61.88056182861328
entropies:353.1184387207031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.5892088413238525 seconds
19 rew tensor(0.4771, dtype=torch.float64) delta_t tensor(0.1934, dtype=torch.float64)
19 gae_duplicate tensor(0.1041, dtype=torch.float64) tensor(-3.8886, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2747, dtype=torch.float64) delta_t tensor(-0.0071, dtype=torch.float64)
18 gae_duplicate tensor(-0.3088, dtype=torch.float64) tensor(-0.2681, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3595, dtype=torch.float64) delta_t tensor(0.2003, dtype=torch.float64)
17 gae_duplicate tensor(0.1251, dtype=torch.float64) tensor(-3.9401, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3632, dtype=torch.float64) delta_t tensor(0.0755, dtype=torch.float64)
16 gae_duplicate tensor(-0.0206, dtype=torch.float64) tensor(-1.9681, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1798, dtype=torch.float64) delta_t tensor(0.0885, dtype=torch.float64)
15 gae_duplicate tensor(-0.0289, dtype=torch.float64) tensor(-1.9723, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3778, dtype=torch.float64) delta_t tensor(0.1258, dtype=torch.float64)
14 gae_duplicate tensor(0.0120, dtype=torch.float64) tensor(-2.5979, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1732, dtype=torch.float64) delta_t tensor(0.0272, dtype=torch.float64)
13 gae_duplicate tensor(-0.0263, dtype=torch.float64) tensor(-0.7655, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3634, dtype=torch.float64) delta_t tensor(0.0727, dtype=torch.float64)
12 gae_duplicate tensor(0.0126, dtype=torch.float64) tensor(-1.5114, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1447, dtype=torch.float64) delta_t tensor(0.0363, dtype=torch.float64)
11 gae_duplicate tensor(-0.0658, dtype=torch.float64) tensor(-0.8538, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3630, dtype=torch.float64) delta_t tensor(0.1595, dtype=torch.float64)
10 gae_duplicate tensor(0.0831, dtype=torch.float64) tensor(-3.1517, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1146, dtype=torch.float64) delta_t tensor(0.0433, dtype=torch.float64)
9 gae_duplicate tensor(-0.0913, dtype=torch.float64) tensor(-1.1749, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3419, dtype=torch.float64) delta_t tensor(0.0360, dtype=torch.float64)
8 gae_duplicate tensor(-0.0109, dtype=torch.float64) tensor(-0.8125, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1007, dtype=torch.float64) delta_t tensor(0.0032, dtype=torch.float64)
7 gae_duplicate tensor(-0.1270, dtype=torch.float64) tensor(-0.0834, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3058, dtype=torch.float64) delta_t tensor(-0.3126, dtype=torch.float64)
6 gae_duplicate tensor(-3.0981, dtype=torch.float64) tensor(5.8164, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0741, dtype=torch.float64) delta_t tensor(0.3579, dtype=torch.float64)
5 gae_duplicate tensor(0.0651, dtype=torch.float64) tensor(-6.2589, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6598, dtype=torch.float64) delta_t tensor(-1.1606, dtype=torch.float64)
4 gae_duplicate tensor(-6.1668, dtype=torch.float64) tensor(19.8887, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0813, dtype=torch.float64) delta_t tensor(0.0930, dtype=torch.float64)
3 gae_duplicate tensor(-0.3276, dtype=torch.float64) tensor(0.2595, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2706, dtype=torch.float64) delta_t tensor(0.0972, dtype=torch.float64)
2 gae_duplicate tensor(-0.1516, dtype=torch.float64) tensor(-1.8781, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:183.32846069335938
value loss:90.70486450195312
entropies:353.1349182128906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.000273704528809 seconds
19 rew tensor(0.5140, dtype=torch.float64) delta_t tensor(0.1159, dtype=torch.float64)
19 gae_duplicate tensor(-0.0039, dtype=torch.float64) tensor(-2.2038, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3687, dtype=torch.float64) delta_t tensor(0.1723, dtype=torch.float64)
18 gae_duplicate tensor(0.0621, dtype=torch.float64) tensor(-3.6528, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4893, dtype=torch.float64) delta_t tensor(0.2457, dtype=torch.float64)
17 gae_duplicate tensor(0.0307, dtype=torch.float64) tensor(-4.9773, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4386, dtype=torch.float64) delta_t tensor(0.1375, dtype=torch.float64)
16 gae_duplicate tensor(0.0088, dtype=torch.float64) tensor(-3.1061, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3037, dtype=torch.float64) delta_t tensor(0.1231, dtype=torch.float64)
15 gae_duplicate tensor(-0.0485, dtype=torch.float64) tensor(-2.6325, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4319, dtype=torch.float64) delta_t tensor(0.1670, dtype=torch.float64)
14 gae_duplicate tensor(0.1295, dtype=torch.float64) tensor(-3.4197, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3258, dtype=torch.float64) delta_t tensor(0.0802, dtype=torch.float64)
13 gae_duplicate tensor(-0.1096, dtype=torch.float64) tensor(-1.9819, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4390, dtype=torch.float64) delta_t tensor(0.1520, dtype=torch.float64)
12 gae_duplicate tensor(0.0624, dtype=torch.float64) tensor(-3.3228, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3108, dtype=torch.float64) delta_t tensor(0.1139, dtype=torch.float64)
11 gae_duplicate tensor(0.0125, dtype=torch.float64) tensor(-2.6544, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4393, dtype=torch.float64) delta_t tensor(0.1385, dtype=torch.float64)
10 gae_duplicate tensor(0.0526, dtype=torch.float64) tensor(-2.9586, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1649, dtype=torch.float64) delta_t tensor(0.0193, dtype=torch.float64)
9 gae_duplicate tensor(-0.4952, dtype=torch.float64) tensor(-0.5693, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8443, dtype=torch.float64) delta_t tensor(-1.1142, dtype=torch.float64)
8 gae_duplicate tensor(-6.8996, dtype=torch.float64) tensor(20.9185, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0937, dtype=torch.float64) delta_t tensor(-0.0145, dtype=torch.float64)
7 gae_duplicate tensor(-0.9347, dtype=torch.float64) tensor(2.8525, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3084, dtype=torch.float64) delta_t tensor(0.3084, dtype=torch.float64)
6 gae_duplicate tensor(0.2045, dtype=torch.float64) tensor(-5.4317, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0858, dtype=torch.float64) delta_t tensor(0.1810, dtype=torch.float64)
5 gae_duplicate tensor(-0.3576, dtype=torch.float64) tensor(-4.2982, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5906, dtype=torch.float64) delta_t tensor(-0.3874, dtype=torch.float64)
4 gae_duplicate tensor(-2.6893, dtype=torch.float64) tensor(6.4252, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1120, dtype=torch.float64) delta_t tensor(0.0645, dtype=torch.float64)
3 gae_duplicate tensor(-0.2741, dtype=torch.float64) tensor(-0.7625, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3339, dtype=torch.float64) delta_t tensor(-0.0012, dtype=torch.float64)
2 gae_duplicate tensor(-0.1562, dtype=torch.float64) tensor(0.0100, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:539.9307861328125
value loss:99.22439575195312
entropies:353.342529296875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3941.3909)
ToM Target loss= tensor(3652.9119)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.931119918823242 seconds
19 rew tensor(0.4104, dtype=torch.float64) delta_t tensor(0.1545, dtype=torch.float64)
19 gae_duplicate tensor(0.0129, dtype=torch.float64) tensor(-2.9544, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4173, dtype=torch.float64) delta_t tensor(0.0826, dtype=torch.float64)
18 gae_duplicate tensor(-0.0331, dtype=torch.float64) tensor(-1.9951, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3034, dtype=torch.float64) delta_t tensor(0.2307, dtype=torch.float64)
17 gae_duplicate tensor(0.0890, dtype=torch.float64) tensor(-4.7063, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5107, dtype=torch.float64) delta_t tensor(0.0759, dtype=torch.float64)
16 gae_duplicate tensor(-0.0121, dtype=torch.float64) tensor(-1.9224, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1426, dtype=torch.float64) delta_t tensor(0.0988, dtype=torch.float64)
15 gae_duplicate tensor(0.0052, dtype=torch.float64) tensor(-2.0434, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5112, dtype=torch.float64) delta_t tensor(0.1431, dtype=torch.float64)
14 gae_duplicate tensor(0.0323, dtype=torch.float64) tensor(-3.1970, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1428, dtype=torch.float64) delta_t tensor(0.0747, dtype=torch.float64)
13 gae_duplicate tensor(-0.0269, dtype=torch.float64) tensor(-1.8112, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5050, dtype=torch.float64) delta_t tensor(0.1058, dtype=torch.float64)
12 gae_duplicate tensor(0.0249, dtype=torch.float64) tensor(-2.3353, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1142, dtype=torch.float64) delta_t tensor(0.1513, dtype=torch.float64)
11 gae_duplicate tensor(0.0993, dtype=torch.float64) tensor(-3.2220, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4958, dtype=torch.float64) delta_t tensor(0.1552, dtype=torch.float64)
10 gae_duplicate tensor(0.1110, dtype=torch.float64) tensor(-3.4871, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1098, dtype=torch.float64) delta_t tensor(0.0971, dtype=torch.float64)
9 gae_duplicate tensor(0.0230, dtype=torch.float64) tensor(-2.1523, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4747, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
8 gae_duplicate tensor(-0.0326, dtype=torch.float64) tensor(-0.9912, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0802, dtype=torch.float64) delta_t tensor(0.0014, dtype=torch.float64)
7 gae_duplicate tensor(-0.0613, dtype=torch.float64) tensor(-0.1091, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3871, dtype=torch.float64) delta_t tensor(0.2589, dtype=torch.float64)
6 gae_duplicate tensor(0.1951, dtype=torch.float64) tensor(-5.3092, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1364, dtype=torch.float64) delta_t tensor(0.2292, dtype=torch.float64)
5 gae_duplicate tensor(-0.4049, dtype=torch.float64) tensor(-4.5684, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.2187, dtype=torch.float64) delta_t tensor(-1.3984, dtype=torch.float64)
4 gae_duplicate tensor(-2.9354, dtype=torch.float64) tensor(24.7668, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0822, dtype=torch.float64) delta_t tensor(0.1559, dtype=torch.float64)
3 gae_duplicate tensor(-0.3126, dtype=torch.float64) tensor(-0.4060, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2065, dtype=torch.float64) delta_t tensor(0.2122, dtype=torch.float64)
2 gae_duplicate tensor(-0.0434, dtype=torch.float64) tensor(-4.2736, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1023.2238159179688
value loss:52.999359130859375
entropies:353.6895751953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.045305252075195 seconds
19 rew tensor(0.3747, dtype=torch.float64) delta_t tensor(0.0793, dtype=torch.float64)
19 gae_duplicate tensor(-0.0013, dtype=torch.float64) tensor(-1.5923, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4391, dtype=torch.float64) delta_t tensor(0.0999, dtype=torch.float64)
18 gae_duplicate tensor(-0.0707, dtype=torch.float64) tensor(-2.2254, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3531, dtype=torch.float64) delta_t tensor(0.1525, dtype=torch.float64)
17 gae_duplicate tensor(0.0305, dtype=torch.float64) tensor(-3.2766, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4675, dtype=torch.float64) delta_t tensor(0.0380, dtype=torch.float64)
16 gae_duplicate tensor(-0.0182, dtype=torch.float64) tensor(-1.0380, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1856, dtype=torch.float64) delta_t tensor(0.1203, dtype=torch.float64)
15 gae_duplicate tensor(-0.0679, dtype=torch.float64) tensor(-2.2994, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4911, dtype=torch.float64) delta_t tensor(0.1561, dtype=torch.float64)
14 gae_duplicate tensor(0.0263, dtype=torch.float64) tensor(-3.2552, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1320, dtype=torch.float64) delta_t tensor(0.0704, dtype=torch.float64)
13 gae_duplicate tensor(-0.0613, dtype=torch.float64) tensor(-1.6341, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4913, dtype=torch.float64) delta_t tensor(0.1452, dtype=torch.float64)
12 gae_duplicate tensor(0.1093, dtype=torch.float64) tensor(-3.1087, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1167, dtype=torch.float64) delta_t tensor(0.1200, dtype=torch.float64)
11 gae_duplicate tensor(0.0107, dtype=torch.float64) tensor(-2.5552, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4527, dtype=torch.float64) delta_t tensor(0.1606, dtype=torch.float64)
10 gae_duplicate tensor(0.0649, dtype=torch.float64) tensor(-3.3601, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0810, dtype=torch.float64) delta_t tensor(0.1064, dtype=torch.float64)
9 gae_duplicate tensor(-0.0131, dtype=torch.float64) tensor(-2.4971, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4621, dtype=torch.float64) delta_t tensor(0.0742, dtype=torch.float64)
8 gae_duplicate tensor(-0.0485, dtype=torch.float64) tensor(-1.8034, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0283, dtype=torch.float64) delta_t tensor(-0.0429, dtype=torch.float64)
7 gae_duplicate tensor(-0.3601, dtype=torch.float64) tensor(0.7057, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3887, dtype=torch.float64) delta_t tensor(0.2423, dtype=torch.float64)
6 gae_duplicate tensor(0.1312, dtype=torch.float64) tensor(-4.5603, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1597, dtype=torch.float64) delta_t tensor(0.2269, dtype=torch.float64)
5 gae_duplicate tensor(-0.2962, dtype=torch.float64) tensor(-4.7862, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.6381, dtype=torch.float64) delta_t tensor(-3.5873, dtype=torch.float64)
4 gae_duplicate tensor(-6.8184, dtype=torch.float64) tensor(69.9625, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0996, dtype=torch.float64) delta_t tensor(0.2447, dtype=torch.float64)
3 gae_duplicate tensor(-0.4664, dtype=torch.float64) tensor(2.1525, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1598, dtype=torch.float64) delta_t tensor(0.2611, dtype=torch.float64)
2 gae_duplicate tensor(0.0290, dtype=torch.float64) tensor(-5.0514, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1703.5919189453125
value loss:145.8701629638672
entropies:354.1382141113281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.115815162658691 seconds
19 rew tensor(0.4862, dtype=torch.float64) delta_t tensor(0.1180, dtype=torch.float64)
19 gae_duplicate tensor(0.0182, dtype=torch.float64) tensor(-2.3168, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3867, dtype=torch.float64) delta_t tensor(0.1421, dtype=torch.float64)
18 gae_duplicate tensor(-0.0300, dtype=torch.float64) tensor(-3.0248, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4788, dtype=torch.float64) delta_t tensor(0.2463, dtype=torch.float64)
17 gae_duplicate tensor(0.0998, dtype=torch.float64) tensor(-5.1051, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3711, dtype=torch.float64) delta_t tensor(0.1404, dtype=torch.float64)
16 gae_duplicate tensor(0.0572, dtype=torch.float64) tensor(-3.4334, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2800, dtype=torch.float64) delta_t tensor(0.2074, dtype=torch.float64)
15 gae_duplicate tensor(0.0360, dtype=torch.float64) tensor(-4.4337, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3894, dtype=torch.float64) delta_t tensor(0.1418, dtype=torch.float64)
14 gae_duplicate tensor(0.0428, dtype=torch.float64) tensor(-3.1168, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2720, dtype=torch.float64) delta_t tensor(0.1335, dtype=torch.float64)
13 gae_duplicate tensor(0.1030, dtype=torch.float64) tensor(-2.9864, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3969, dtype=torch.float64) delta_t tensor(0.1424, dtype=torch.float64)
12 gae_duplicate tensor(0.1275, dtype=torch.float64) tensor(-3.0439, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2790, dtype=torch.float64) delta_t tensor(0.1039, dtype=torch.float64)
11 gae_duplicate tensor(0.0204, dtype=torch.float64) tensor(-2.4493, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3879, dtype=torch.float64) delta_t tensor(0.1668, dtype=torch.float64)
10 gae_duplicate tensor(0.1122, dtype=torch.float64) tensor(-3.5303, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2502, dtype=torch.float64) delta_t tensor(0.1459, dtype=torch.float64)
9 gae_duplicate tensor(-0.0372, dtype=torch.float64) tensor(-3.3922, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3467, dtype=torch.float64) delta_t tensor(0.1210, dtype=torch.float64)
8 gae_duplicate tensor(-0.0473, dtype=torch.float64) tensor(-2.7741, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2221, dtype=torch.float64) delta_t tensor(0.1008, dtype=torch.float64)
7 gae_duplicate tensor(0.0002, dtype=torch.float64) tensor(-2.2170, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2723, dtype=torch.float64) delta_t tensor(0.3708, dtype=torch.float64)
6 gae_duplicate tensor(0.2859, dtype=torch.float64) tensor(-7.6213, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0094, dtype=torch.float64) delta_t tensor(0.2984, dtype=torch.float64)
5 gae_duplicate tensor(0.1657, dtype=torch.float64) tensor(-6.6451, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6952, dtype=torch.float64) delta_t tensor(-0.1917, dtype=torch.float64)
4 gae_duplicate tensor(-2.5347, dtype=torch.float64) tensor(3.1174, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1057, dtype=torch.float64) delta_t tensor(0.0942, dtype=torch.float64)
3 gae_duplicate tensor(-0.0835, dtype=torch.float64) tensor(-1.6349, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3048, dtype=torch.float64) delta_t tensor(0.1561, dtype=torch.float64)
2 gae_duplicate tensor(0.0793, dtype=torch.float64) tensor(-3.3095, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3031.813720703125
value loss:22.21454620361328
entropies:354.484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.184354066848755 seconds
19 rew tensor(0.4476, dtype=torch.float64) delta_t tensor(0.1252, dtype=torch.float64)
19 gae_duplicate tensor(-0.0187, dtype=torch.float64) tensor(-2.3406, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4277, dtype=torch.float64) delta_t tensor(0.0811, dtype=torch.float64)
18 gae_duplicate tensor(-0.0624, dtype=torch.float64) tensor(-1.8676, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3774, dtype=torch.float64) delta_t tensor(0.2866, dtype=torch.float64)
17 gae_duplicate tensor(0.0942, dtype=torch.float64) tensor(-5.9060, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4762, dtype=torch.float64) delta_t tensor(0.1013, dtype=torch.float64)
16 gae_duplicate tensor(0.0080, dtype=torch.float64) tensor(-2.5295, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0625, dtype=torch.float64) delta_t tensor(-0.0531, dtype=torch.float64)
15 gae_duplicate tensor(-0.8733, dtype=torch.float64) tensor(0.8230, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5128, dtype=torch.float64) delta_t tensor(0.0796, dtype=torch.float64)
14 gae_duplicate tensor(-0.0169, dtype=torch.float64) tensor(-1.5119, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0843, dtype=torch.float64) delta_t tensor(0.0952, dtype=torch.float64)
13 gae_duplicate tensor(-0.0949, dtype=torch.float64) tensor(-2.0045, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5060, dtype=torch.float64) delta_t tensor(0.0750, dtype=torch.float64)
12 gae_duplicate tensor(-0.0054, dtype=torch.float64) tensor(-1.7304, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0841, dtype=torch.float64) delta_t tensor(0.0892, dtype=torch.float64)
11 gae_duplicate tensor(0.0352, dtype=torch.float64) tensor(-1.9034, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5059, dtype=torch.float64) delta_t tensor(0.1462, dtype=torch.float64)
10 gae_duplicate tensor(0.0388, dtype=torch.float64) tensor(-2.9710, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0967, dtype=torch.float64) delta_t tensor(-0.0944, dtype=torch.float64)
9 gae_duplicate tensor(-0.7445, dtype=torch.float64) tensor(1.4120, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3031, dtype=torch.float64) delta_t tensor(-0.1025, dtype=torch.float64)
8 gae_duplicate tensor(-0.7934, dtype=torch.float64) tensor(2.1874, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0478, dtype=torch.float64) delta_t tensor(0.0163, dtype=torch.float64)
7 gae_duplicate tensor(-0.0705, dtype=torch.float64) tensor(-0.1348, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3809, dtype=torch.float64) delta_t tensor(0.3008, dtype=torch.float64)
6 gae_duplicate tensor(0.1817, dtype=torch.float64) tensor(-5.9544, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4836, dtype=torch.float64) delta_t tensor(0.0630, dtype=torch.float64)
5 gae_duplicate tensor(-1.5646, dtype=torch.float64) tensor(-1.8334, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7000, dtype=torch.float64) delta_t tensor(-0.4567, dtype=torch.float64)
4 gae_duplicate tensor(-1.6741, dtype=torch.float64) tensor(9.2423, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0110, dtype=torch.float64) delta_t tensor(0.0963, dtype=torch.float64)
3 gae_duplicate tensor(-0.3568, dtype=torch.float64) tensor(-1.1081, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3346, dtype=torch.float64) delta_t tensor(0.0566, dtype=torch.float64)
2 gae_duplicate tensor(-0.2272, dtype=torch.float64) tensor(-1.2501, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:950.754150390625
value loss:24.100234985351562
entropies:354.8818359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.033147096633911 seconds
19 rew tensor(0.3739, dtype=torch.float64) delta_t tensor(0.0135, dtype=torch.float64)
19 gae_duplicate tensor(-0.0824, dtype=torch.float64) tensor(-0.2661, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3749, dtype=torch.float64) delta_t tensor(-0.0100, dtype=torch.float64)
18 gae_duplicate tensor(-0.1189, dtype=torch.float64) tensor(0.1487, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3323, dtype=torch.float64) delta_t tensor(0.0762, dtype=torch.float64)
17 gae_duplicate tensor(-0.0424, dtype=torch.float64) tensor(-1.4655, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4386, dtype=torch.float64) delta_t tensor(0.1220, dtype=torch.float64)
16 gae_duplicate tensor(-0.0212, dtype=torch.float64) tensor(-2.5354, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1543, dtype=torch.float64) delta_t tensor(0.0713, dtype=torch.float64)
15 gae_duplicate tensor(-0.0033, dtype=torch.float64) tensor(-1.6480, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4443, dtype=torch.float64) delta_t tensor(0.1298, dtype=torch.float64)
14 gae_duplicate tensor(0.0057, dtype=torch.float64) tensor(-2.7569, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1913, dtype=torch.float64) delta_t tensor(0.0337, dtype=torch.float64)
13 gae_duplicate tensor(-0.1015, dtype=torch.float64) tensor(-0.9556, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4527, dtype=torch.float64) delta_t tensor(0.0612, dtype=torch.float64)
12 gae_duplicate tensor(-0.0374, dtype=torch.float64) tensor(-1.2917, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1842, dtype=torch.float64) delta_t tensor(0.0174, dtype=torch.float64)
11 gae_duplicate tensor(-0.0525, dtype=torch.float64) tensor(-0.4468, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4390, dtype=torch.float64) delta_t tensor(0.1316, dtype=torch.float64)
10 gae_duplicate tensor(0.0520, dtype=torch.float64) tensor(-2.5522, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0083, dtype=torch.float64) delta_t tensor(-0.1090, dtype=torch.float64)
9 gae_duplicate tensor(-0.7203, dtype=torch.float64) tensor(1.7400, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4087, dtype=torch.float64) delta_t tensor(0.0609, dtype=torch.float64)
8 gae_duplicate tensor(-0.0691, dtype=torch.float64) tensor(-0.9851, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1478, dtype=torch.float64) delta_t tensor(0.0453, dtype=torch.float64)
7 gae_duplicate tensor(-0.0703, dtype=torch.float64) tensor(-0.9594, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3206, dtype=torch.float64) delta_t tensor(0.2691, dtype=torch.float64)
6 gae_duplicate tensor(0.1625, dtype=torch.float64) tensor(-5.3277, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0717, dtype=torch.float64) delta_t tensor(0.2185, dtype=torch.float64)
5 gae_duplicate tensor(0.0594, dtype=torch.float64) tensor(-4.8317, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7601, dtype=torch.float64) delta_t tensor(0.2158, dtype=torch.float64)
4 gae_duplicate tensor(-1.2976, dtype=torch.float64) tensor(-4.9110, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1161, dtype=torch.float64) delta_t tensor(0.0090, dtype=torch.float64)
3 gae_duplicate tensor(-0.3107, dtype=torch.float64) tensor(-0.7561, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3096, dtype=torch.float64) delta_t tensor(0.0888, dtype=torch.float64)
2 gae_duplicate tensor(-0.0326, dtype=torch.float64) tensor(-1.8496, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1613.221435546875
value loss:10.592201232910156
entropies:355.1067199707031
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3942.1904)
ToM Target loss= tensor(3688.8137)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.876347780227661 seconds
19 rew tensor(0.4758, dtype=torch.float64) delta_t tensor(-0.0350, dtype=torch.float64)
19 gae_duplicate tensor(-0.2363, dtype=torch.float64) tensor(0.7264, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4115, dtype=torch.float64) delta_t tensor(0.0171, dtype=torch.float64)
18 gae_duplicate tensor(-0.1206, dtype=torch.float64) tensor(-0.2381, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3847, dtype=torch.float64) delta_t tensor(0.0742, dtype=torch.float64)
17 gae_duplicate tensor(-0.1841, dtype=torch.float64) tensor(-1.5222, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4280, dtype=torch.float64) delta_t tensor(0.0658, dtype=torch.float64)
16 gae_duplicate tensor(-0.0539, dtype=torch.float64) tensor(-1.4471, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2343, dtype=torch.float64) delta_t tensor(0.0434, dtype=torch.float64)
15 gae_duplicate tensor(-0.0591, dtype=torch.float64) tensor(-0.9213, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4733, dtype=torch.float64) delta_t tensor(-0.0034, dtype=torch.float64)
14 gae_duplicate tensor(-0.1391, dtype=torch.float64) tensor(-0.0636, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1566, dtype=torch.float64) delta_t tensor(-0.0834, dtype=torch.float64)
13 gae_duplicate tensor(-0.1459, dtype=torch.float64) tensor(1.6716, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4734, dtype=torch.float64) delta_t tensor(-0.0735, dtype=torch.float64)
12 gae_duplicate tensor(-0.1118, dtype=torch.float64) tensor(1.5814, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1494, dtype=torch.float64) delta_t tensor(-0.0394, dtype=torch.float64)
11 gae_duplicate tensor(-0.1929, dtype=torch.float64) tensor(0.9375, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4431, dtype=torch.float64) delta_t tensor(0.0642, dtype=torch.float64)
10 gae_duplicate tensor(0.0154, dtype=torch.float64) tensor(-1.2068, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-3.5826e-05, dtype=torch.float64) delta_t tensor(-0.1817, dtype=torch.float64)
9 gae_duplicate tensor(-0.7415, dtype=torch.float64) tensor(3.4865, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3988, dtype=torch.float64) delta_t tensor(-0.0223, dtype=torch.float64)
8 gae_duplicate tensor(-0.1734, dtype=torch.float64) tensor(0.7799, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0825, dtype=torch.float64) delta_t tensor(-0.0638, dtype=torch.float64)
7 gae_duplicate tensor(-0.3002, dtype=torch.float64) tensor(1.3217, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2059, dtype=torch.float64) delta_t tensor(0.0747, dtype=torch.float64)
6 gae_duplicate tensor(-0.4789, dtype=torch.float64) tensor(-1.2997, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1797, dtype=torch.float64) delta_t tensor(0.6010, dtype=torch.float64)
5 gae_duplicate tensor(0.0358, dtype=torch.float64) tensor(-12.0832, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4182, dtype=torch.float64) delta_t tensor(-0.3159, dtype=torch.float64)
4 gae_duplicate tensor(-3.8334, dtype=torch.float64) tensor(5.5779, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0933, dtype=torch.float64) delta_t tensor(0.1110, dtype=torch.float64)
3 gae_duplicate tensor(-0.6645, dtype=torch.float64) tensor(-1.4400, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2657, dtype=torch.float64) delta_t tensor(0.0934, dtype=torch.float64)
2 gae_duplicate tensor(-0.1465, dtype=torch.float64) tensor(-1.9879, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:234.9192657470703
value loss:68.8515853881836
entropies:355.3331604003906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.083193778991699 seconds
19 rew tensor(0.3371, dtype=torch.float64) delta_t tensor(-0.0712, dtype=torch.float64)
19 gae_duplicate tensor(-0.2266, dtype=torch.float64) tensor(1.4579, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4337, dtype=torch.float64) delta_t tensor(-0.1348, dtype=torch.float64)
18 gae_duplicate tensor(-0.2628, dtype=torch.float64) tensor(2.7390, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3036, dtype=torch.float64) delta_t tensor(-0.0143, dtype=torch.float64)
17 gae_duplicate tensor(-0.2745, dtype=torch.float64) tensor(0.5864, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4666, dtype=torch.float64) delta_t tensor(0.0078, dtype=torch.float64)
16 gae_duplicate tensor(-0.1471, dtype=torch.float64) tensor(-0.1058, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0296, dtype=torch.float64) delta_t tensor(-0.2220, dtype=torch.float64)
15 gae_duplicate tensor(-1.0760, dtype=torch.float64) tensor(4.6192, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4690, dtype=torch.float64) delta_t tensor(0.1670, dtype=torch.float64)
14 gae_duplicate tensor(-0.1728, dtype=torch.float64) tensor(-2.8847, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1206, dtype=torch.float64) delta_t tensor(-0.0137, dtype=torch.float64)
13 gae_duplicate tensor(-0.1203, dtype=torch.float64) tensor(-0.0050, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5119, dtype=torch.float64) delta_t tensor(-0.0674, dtype=torch.float64)
12 gae_duplicate tensor(-0.1038, dtype=torch.float64) tensor(1.3263, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1055, dtype=torch.float64) delta_t tensor(-0.0627, dtype=torch.float64)
11 gae_duplicate tensor(-0.1476, dtype=torch.float64) tensor(1.4050, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5051, dtype=torch.float64) delta_t tensor(-0.0233, dtype=torch.float64)
10 gae_duplicate tensor(-0.1020, dtype=torch.float64) tensor(0.5952, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0538, dtype=torch.float64) delta_t tensor(-0.0600, dtype=torch.float64)
9 gae_duplicate tensor(-0.2378, dtype=torch.float64) tensor(1.2572, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4760, dtype=torch.float64) delta_t tensor(-0.0656, dtype=torch.float64)
8 gae_duplicate tensor(-0.2215, dtype=torch.float64) tensor(1.3866, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0315, dtype=torch.float64) delta_t tensor(-0.1196, dtype=torch.float64)
7 gae_duplicate tensor(-0.2397, dtype=torch.float64) tensor(2.4911, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3573, dtype=torch.float64) delta_t tensor(0.1931, dtype=torch.float64)
6 gae_duplicate tensor(-0.0101, dtype=torch.float64) tensor(-3.5695, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2185, dtype=torch.float64) delta_t tensor(0.6001, dtype=torch.float64)
5 gae_duplicate tensor(0.0397, dtype=torch.float64) tensor(-11.9842, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1766, dtype=torch.float64) delta_t tensor(-0.7245, dtype=torch.float64)
4 gae_duplicate tensor(-4.6643, dtype=torch.float64) tensor(12.9493, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1012, dtype=torch.float64) delta_t tensor(-0.1345, dtype=torch.float64)
3 gae_duplicate tensor(-0.4143, dtype=torch.float64) tensor(3.9156, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2665, dtype=torch.float64) delta_t tensor(0.0380, dtype=torch.float64)
2 gae_duplicate tensor(-0.2328, dtype=torch.float64) tensor(-0.2699, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-955.0739135742188
value loss:62.368309020996094
entropies:355.42578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.713946104049683 seconds
19 rew tensor(0.3802, dtype=torch.float64) delta_t tensor(0.1330, dtype=torch.float64)
19 gae_duplicate tensor(-0.2453, dtype=torch.float64) tensor(-2.4871, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5191, dtype=torch.float64) delta_t tensor(-0.0788, dtype=torch.float64)
18 gae_duplicate tensor(-0.2231, dtype=torch.float64) tensor(1.2900, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3513, dtype=torch.float64) delta_t tensor(0.1257, dtype=torch.float64)
17 gae_duplicate tensor(-0.1743, dtype=torch.float64) tensor(-2.3874, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5355, dtype=torch.float64) delta_t tensor(-0.0094, dtype=torch.float64)
16 gae_duplicate tensor(-0.1117, dtype=torch.float64) tensor(-0.0195, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0464, dtype=torch.float64) delta_t tensor(-0.0927, dtype=torch.float64)
15 gae_duplicate tensor(-0.1752, dtype=torch.float64) tensor(1.8415, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5565, dtype=torch.float64) delta_t tensor(-0.1602, dtype=torch.float64)
14 gae_duplicate tensor(-0.2165, dtype=torch.float64) tensor(3.4061, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0538, dtype=torch.float64) delta_t tensor(-0.1431, dtype=torch.float64)
13 gae_duplicate tensor(-0.2851, dtype=torch.float64) tensor(3.1864, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5565, dtype=torch.float64) delta_t tensor(-0.1739, dtype=torch.float64)
12 gae_duplicate tensor(-0.2457, dtype=torch.float64) tensor(3.7525, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0458, dtype=torch.float64) delta_t tensor(-0.0946, dtype=torch.float64)
11 gae_duplicate tensor(-0.2224, dtype=torch.float64) tensor(2.2667, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5123, dtype=torch.float64) delta_t tensor(-0.0334, dtype=torch.float64)
10 gae_duplicate tensor(-0.0871, dtype=torch.float64) tensor(0.8834, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0473, dtype=torch.float64) delta_t tensor(-0.1836, dtype=torch.float64)
9 gae_duplicate tensor(-0.3324, dtype=torch.float64) tensor(3.7575, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5124, dtype=torch.float64) delta_t tensor(-0.1774, dtype=torch.float64)
8 gae_duplicate tensor(-0.2341, dtype=torch.float64) tensor(3.7760, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0103, dtype=torch.float64) delta_t tensor(-0.1748, dtype=torch.float64)
7 gae_duplicate tensor(-0.3129, dtype=torch.float64) tensor(3.8984, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4309, dtype=torch.float64) delta_t tensor(0.0583, dtype=torch.float64)
6 gae_duplicate tensor(0.0184, dtype=torch.float64) tensor(-0.7707, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1665, dtype=torch.float64) delta_t tensor(0.0556, dtype=torch.float64)
5 gae_duplicate tensor(-0.0966, dtype=torch.float64) tensor(-1.2381, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.2154, dtype=torch.float64) delta_t tensor(0.0977, dtype=torch.float64)
4 gae_duplicate tensor(-3.6396, dtype=torch.float64) tensor(-1.5986, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1972, dtype=torch.float64) delta_t tensor(0.2991, dtype=torch.float64)
3 gae_duplicate tensor(-0.3519, dtype=torch.float64) tensor(-5.9232, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1973, dtype=torch.float64) delta_t tensor(0.0712, dtype=torch.float64)
2 gae_duplicate tensor(-0.0479, dtype=torch.float64) tensor(-2.0141, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-723.4345092773438
value loss:39.30463790893555
entropies:355.42578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.867846965789795 seconds
19 rew tensor(0.4592, dtype=torch.float64) delta_t tensor(-0.1184, dtype=torch.float64)
19 gae_duplicate tensor(-0.2769, dtype=torch.float64) tensor(2.2955, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4406, dtype=torch.float64) delta_t tensor(-0.1452, dtype=torch.float64)
18 gae_duplicate tensor(-0.4183, dtype=torch.float64) tensor(3.0581, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3710, dtype=torch.float64) delta_t tensor(0.0093, dtype=torch.float64)
17 gae_duplicate tensor(-0.2343, dtype=torch.float64) tensor(0.1345, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5505, dtype=torch.float64) delta_t tensor(-0.0582, dtype=torch.float64)
16 gae_duplicate tensor(-0.2566, dtype=torch.float64) tensor(1.1064, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1108, dtype=torch.float64) delta_t tensor(-0.1245, dtype=torch.float64)
15 gae_duplicate tensor(-0.3071, dtype=torch.float64) tensor(2.6208, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5648, dtype=torch.float64) delta_t tensor(-0.1258, dtype=torch.float64)
14 gae_duplicate tensor(-0.2815, dtype=torch.float64) tensor(2.6808, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1400, dtype=torch.float64) delta_t tensor(-0.1290, dtype=torch.float64)
13 gae_duplicate tensor(-0.3744, dtype=torch.float64) tensor(2.8736, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5649, dtype=torch.float64) delta_t tensor(-0.1435, dtype=torch.float64)
12 gae_duplicate tensor(-0.3138, dtype=torch.float64) tensor(3.2744, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1332, dtype=torch.float64) delta_t tensor(-0.1371, dtype=torch.float64)
11 gae_duplicate tensor(-0.3059, dtype=torch.float64) tensor(2.9318, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5365, dtype=torch.float64) delta_t tensor(-0.0397, dtype=torch.float64)
10 gae_duplicate tensor(-0.1493, dtype=torch.float64) tensor(1.0757, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0697, dtype=torch.float64) delta_t tensor(-0.3405, dtype=torch.float64)
9 gae_duplicate tensor(-0.8699, dtype=torch.float64) tensor(6.8653, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8291, dtype=torch.float64) delta_t tensor(-1.4889, dtype=torch.float64)
8 gae_duplicate tensor(-8.0591, dtype=torch.float64) tensor(28.5890, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0476, dtype=torch.float64) delta_t tensor(-0.1333, dtype=torch.float64)
7 gae_duplicate tensor(-0.6746, dtype=torch.float64) tensor(5.6009, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2538, dtype=torch.float64) delta_t tensor(-0.1292, dtype=torch.float64)
6 gae_duplicate tensor(-0.8096, dtype=torch.float64) tensor(2.9649, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6481, dtype=torch.float64) delta_t tensor(-0.2253, dtype=torch.float64)
5 gae_duplicate tensor(-1.5581, dtype=torch.float64) tensor(5.0682, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7081, dtype=torch.float64) delta_t tensor(-0.6318, dtype=torch.float64)
4 gae_duplicate tensor(-3.2446, dtype=torch.float64) tensor(13.2128, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1129, dtype=torch.float64) delta_t tensor(0.3204, dtype=torch.float64)
3 gae_duplicate tensor(-0.2534, dtype=torch.float64) tensor(-4.8306, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3105, dtype=torch.float64) delta_t tensor(-0.1480, dtype=torch.float64)
2 gae_duplicate tensor(-0.4405, dtype=torch.float64) tensor(2.4469, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4522.2666015625
value loss:130.21630859375
entropies:355.33740234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.62285590171814 seconds
19 rew tensor(0.3307, dtype=torch.float64) delta_t tensor(-0.1776, dtype=torch.float64)
19 gae_duplicate tensor(-0.3007, dtype=torch.float64) tensor(3.5034, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4131, dtype=torch.float64) delta_t tensor(-0.1883, dtype=torch.float64)
18 gae_duplicate tensor(-0.3742, dtype=torch.float64) tensor(3.9433, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2507, dtype=torch.float64) delta_t tensor(-0.1025, dtype=torch.float64)
17 gae_duplicate tensor(-0.3415, dtype=torch.float64) tensor(2.4319, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5068, dtype=torch.float64) delta_t tensor(-0.1593, dtype=torch.float64)
16 gae_duplicate tensor(-0.2605, dtype=torch.float64) tensor(3.4037, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0825, dtype=torch.float64) delta_t tensor(-0.1565, dtype=torch.float64)
15 gae_duplicate tensor(-0.3631, dtype=torch.float64) tensor(3.4312, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5001, dtype=torch.float64) delta_t tensor(-0.1736, dtype=torch.float64)
14 gae_duplicate tensor(-0.2890, dtype=torch.float64) tensor(3.7335, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1043, dtype=torch.float64) delta_t tensor(-0.1890, dtype=torch.float64)
13 gae_duplicate tensor(-0.4109, dtype=torch.float64) tensor(4.0132, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5069, dtype=torch.float64) delta_t tensor(-0.2023, dtype=torch.float64)
12 gae_duplicate tensor(-0.2856, dtype=torch.float64) tensor(4.4571, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0898, dtype=torch.float64) delta_t tensor(-0.1791, dtype=torch.float64)
11 gae_duplicate tensor(-0.3225, dtype=torch.float64) tensor(3.9518, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4766, dtype=torch.float64) delta_t tensor(-0.1171, dtype=torch.float64)
10 gae_duplicate tensor(-0.1954, dtype=torch.float64) tensor(2.7460, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2060, dtype=torch.float64) delta_t tensor(-0.4832, dtype=torch.float64)
9 gae_duplicate tensor(-1.7800, dtype=torch.float64) tensor(9.7881, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4626, dtype=torch.float64) delta_t tensor(-0.1895, dtype=torch.float64)
8 gae_duplicate tensor(-0.3017, dtype=torch.float64) tensor(4.7217, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0606, dtype=torch.float64) delta_t tensor(-0.1948, dtype=torch.float64)
7 gae_duplicate tensor(-0.3830, dtype=torch.float64) tensor(4.2964, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3816, dtype=torch.float64) delta_t tensor(0.0703, dtype=torch.float64)
6 gae_duplicate tensor(-0.0604, dtype=torch.float64) tensor(-0.9238, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1454, dtype=torch.float64) delta_t tensor(0.7334, dtype=torch.float64)
5 gae_duplicate tensor(-0.0348, dtype=torch.float64) tensor(-14.6342, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4148, dtype=torch.float64) delta_t tensor(-0.1826, dtype=torch.float64)
4 gae_duplicate tensor(-0.7007, dtype=torch.float64) tensor(2.3175, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0151, dtype=torch.float64) delta_t tensor(0.5324, dtype=torch.float64)
3 gae_duplicate tensor(0.1899, dtype=torch.float64) tensor(-10.0355, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3352, dtype=torch.float64) delta_t tensor(0.0094, dtype=torch.float64)
2 gae_duplicate tensor(-0.2514, dtype=torch.float64) tensor(-1.3221, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1706.4000244140625
value loss:32.30080032348633
entropies:355.34375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3952.5784)
ToM Target loss= tensor(3704.3584)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.941860198974609 seconds
19 rew tensor(0.4011, dtype=torch.float64) delta_t tensor(-0.0860, dtype=torch.float64)
19 gae_duplicate tensor(-0.2145, dtype=torch.float64) tensor(1.7685, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4653, dtype=torch.float64) delta_t tensor(-0.0827, dtype=torch.float64)
18 gae_duplicate tensor(-0.2675, dtype=torch.float64) tensor(1.7692, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3643, dtype=torch.float64) delta_t tensor(-0.0164, dtype=torch.float64)
17 gae_duplicate tensor(-0.2263, dtype=torch.float64) tensor(0.4077, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5006, dtype=torch.float64) delta_t tensor(-0.1232, dtype=torch.float64)
16 gae_duplicate tensor(-0.2055, dtype=torch.float64) tensor(2.4746, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1349, dtype=torch.float64) delta_t tensor(-0.1164, dtype=torch.float64)
15 gae_duplicate tensor(-0.2756, dtype=torch.float64) tensor(2.4941, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4863, dtype=torch.float64) delta_t tensor(-0.0367, dtype=torch.float64)
14 gae_duplicate tensor(-0.2245, dtype=torch.float64) tensor(0.9767, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1577, dtype=torch.float64) delta_t tensor(-0.1067, dtype=torch.float64)
13 gae_duplicate tensor(-0.3445, dtype=torch.float64) tensor(2.2153, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4778, dtype=torch.float64) delta_t tensor(0.0105, dtype=torch.float64)
12 gae_duplicate tensor(-0.2561, dtype=torch.float64) tensor(0.0801, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1284, dtype=torch.float64) delta_t tensor(-0.1181, dtype=torch.float64)
11 gae_duplicate tensor(-0.1651, dtype=torch.float64) tensor(2.3459, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4863, dtype=torch.float64) delta_t tensor(-0.1047, dtype=torch.float64)
10 gae_duplicate tensor(-0.1665, dtype=torch.float64) tensor(2.3245, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1051, dtype=torch.float64) delta_t tensor(-0.1417, dtype=torch.float64)
9 gae_duplicate tensor(-0.2759, dtype=torch.float64) tensor(3.0945, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4566, dtype=torch.float64) delta_t tensor(-0.1708, dtype=torch.float64)
8 gae_duplicate tensor(-0.2721, dtype=torch.float64) tensor(3.6526, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0834, dtype=torch.float64) delta_t tensor(-0.1467, dtype=torch.float64)
7 gae_duplicate tensor(-0.2769, dtype=torch.float64) tensor(3.2852, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3823, dtype=torch.float64) delta_t tensor(0.0356, dtype=torch.float64)
6 gae_duplicate tensor(-0.0719, dtype=torch.float64) tensor(-0.3564, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1102, dtype=torch.float64) delta_t tensor(0.2292, dtype=torch.float64)
5 gae_duplicate tensor(-0.0680, dtype=torch.float64) tensor(-4.4537, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4525, dtype=torch.float64) delta_t tensor(-0.5424, dtype=torch.float64)
4 gae_duplicate tensor(-3.1554, dtype=torch.float64) tensor(9.4585, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1722, dtype=torch.float64) delta_t tensor(1.0668, dtype=torch.float64)
3 gae_duplicate tensor(-0.0599, dtype=torch.float64) tensor(-20.3204, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2615, dtype=torch.float64) delta_t tensor(0.2227, dtype=torch.float64)
2 gae_duplicate tensor(-0.2304, dtype=torch.float64) tensor(-6.2856, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-362.2302551269531
value loss:54.501155853271484
entropies:355.32763671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7758629322052 seconds
19 rew tensor(0.3999, dtype=torch.float64) delta_t tensor(-0.1350, dtype=torch.float64)
19 gae_duplicate tensor(-0.2241, dtype=torch.float64) tensor(2.6949, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3850, dtype=torch.float64) delta_t tensor(-0.0162, dtype=torch.float64)
18 gae_duplicate tensor(-0.2331, dtype=torch.float64) tensor(0.5843, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3999, dtype=torch.float64) delta_t tensor(-0.0491, dtype=torch.float64)
17 gae_duplicate tensor(-0.1169, dtype=torch.float64) tensor(1.0181, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3645, dtype=torch.float64) delta_t tensor(-0.1042, dtype=torch.float64)
16 gae_duplicate tensor(-0.3021, dtype=torch.float64) tensor(2.1850, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3796, dtype=torch.float64) delta_t tensor(-0.0137, dtype=torch.float64)
15 gae_duplicate tensor(-0.1618, dtype=torch.float64) tensor(0.4793, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2128, dtype=torch.float64) delta_t tensor(-0.2242, dtype=torch.float64)
14 gae_duplicate tensor(-1.1308, dtype=torch.float64) tensor(4.4101, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3793, dtype=torch.float64) delta_t tensor(-0.0324, dtype=torch.float64)
13 gae_duplicate tensor(-0.1307, dtype=torch.float64) tensor(1.0969, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3930, dtype=torch.float64) delta_t tensor(-0.0974, dtype=torch.float64)
12 gae_duplicate tensor(-0.1789, dtype=torch.float64) tensor(2.0306, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3796, dtype=torch.float64) delta_t tensor(-0.0430, dtype=torch.float64)
11 gae_duplicate tensor(-0.1321, dtype=torch.float64) tensor(1.0176, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3647, dtype=torch.float64) delta_t tensor(-0.0694, dtype=torch.float64)
10 gae_duplicate tensor(-0.2287, dtype=torch.float64) tensor(1.4512, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3278, dtype=torch.float64) delta_t tensor(0.0017, dtype=torch.float64)
9 gae_duplicate tensor(-0.0921, dtype=torch.float64) tensor(0.0913, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3408, dtype=torch.float64) delta_t tensor(-0.0655, dtype=torch.float64)
8 gae_duplicate tensor(-0.1467, dtype=torch.float64) tensor(1.3081, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3070, dtype=torch.float64) delta_t tensor(-0.0744, dtype=torch.float64)
7 gae_duplicate tensor(-0.1690, dtype=torch.float64) tensor(1.6001, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2394, dtype=torch.float64) delta_t tensor(0.3492, dtype=torch.float64)
6 gae_duplicate tensor(0.0056, dtype=torch.float64) tensor(-6.8995, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0123, dtype=torch.float64) delta_t tensor(1.6786, dtype=torch.float64)
5 gae_duplicate tensor(0.3097, dtype=torch.float64) tensor(-34.0917, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3061, dtype=torch.float64) delta_t tensor(-1.4584, dtype=torch.float64)
4 gae_duplicate tensor(-4.1588, dtype=torch.float64) tensor(24.7893, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0939, dtype=torch.float64) delta_t tensor(1.2356, dtype=torch.float64)
3 gae_duplicate tensor(0.0976, dtype=torch.float64) tensor(-21.6434, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2561, dtype=torch.float64) delta_t tensor(-0.0261, dtype=torch.float64)
2 gae_duplicate tensor(-0.3798, dtype=torch.float64) tensor(-1.6092, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:956.3533935546875
value loss:90.9780502319336
entropies:355.3970947265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.554978847503662 seconds
19 rew tensor(0.5402, dtype=torch.float64) delta_t tensor(0.0060, dtype=torch.float64)
19 gae_duplicate tensor(-0.2931, dtype=torch.float64) tensor(-0.1317, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5326, dtype=torch.float64) delta_t tensor(0.0639, dtype=torch.float64)
18 gae_duplicate tensor(-0.1968, dtype=torch.float64) tensor(-1.2456, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5406, dtype=torch.float64) delta_t tensor(0.1416, dtype=torch.float64)
17 gae_duplicate tensor(-0.2084, dtype=torch.float64) tensor(-2.8456, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5412, dtype=torch.float64) delta_t tensor(-0.0071, dtype=torch.float64)
16 gae_duplicate tensor(-0.1611, dtype=torch.float64) tensor(-0.1112, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3828, dtype=torch.float64) delta_t tensor(0.0192, dtype=torch.float64)
15 gae_duplicate tensor(-0.2895, dtype=torch.float64) tensor(-0.4117, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4991, dtype=torch.float64) delta_t tensor(-0.0065, dtype=torch.float64)
14 gae_duplicate tensor(-0.0994, dtype=torch.float64) tensor(0.1164, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2965, dtype=torch.float64) delta_t tensor(-0.0153, dtype=torch.float64)
13 gae_duplicate tensor(-0.3273, dtype=torch.float64) tensor(0.3437, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5426, dtype=torch.float64) delta_t tensor(0.0048, dtype=torch.float64)
12 gae_duplicate tensor(-0.0858, dtype=torch.float64) tensor(-0.0610, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2297, dtype=torch.float64) delta_t tensor(-0.0261, dtype=torch.float64)
11 gae_duplicate tensor(-0.1787, dtype=torch.float64) tensor(0.5098, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5009, dtype=torch.float64) delta_t tensor(0.1189, dtype=torch.float64)
10 gae_duplicate tensor(-0.0820, dtype=torch.float64) tensor(-2.2673, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1177, dtype=torch.float64) delta_t tensor(-0.3240, dtype=torch.float64)
9 gae_duplicate tensor(-1.5960, dtype=torch.float64) tensor(6.3159, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1534, dtype=torch.float64) delta_t tensor(-0.4141, dtype=torch.float64)
8 gae_duplicate tensor(-2.4296, dtype=torch.float64) tensor(9.1578, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0691, dtype=torch.float64) delta_t tensor(0.0511, dtype=torch.float64)
7 gae_duplicate tensor(-0.3722, dtype=torch.float64) tensor(-0.2986, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1607, dtype=torch.float64) delta_t tensor(0.2312, dtype=torch.float64)
6 gae_duplicate tensor(0.0294, dtype=torch.float64) tensor(-4.6174, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2741, dtype=torch.float64) delta_t tensor(1.2679, dtype=torch.float64)
5 gae_duplicate tensor(-0.1247, dtype=torch.float64) tensor(-25.1926, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4251, dtype=torch.float64) delta_t tensor(-1.7250, dtype=torch.float64)
4 gae_duplicate tensor(-4.8479, dtype=torch.float64) tensor(30.7120, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1676, dtype=torch.float64) delta_t tensor(0.4457, dtype=torch.float64)
3 gae_duplicate tensor(-0.1266, dtype=torch.float64) tensor(-5.5195, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3058, dtype=torch.float64) delta_t tensor(0.2440, dtype=torch.float64)
2 gae_duplicate tensor(-0.4477, dtype=torch.float64) tensor(-5.4020, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-44.773719787597656
value loss:120.66993713378906
entropies:355.53631591796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.874125242233276 seconds
19 rew tensor(0.3507, dtype=torch.float64) delta_t tensor(0.0346, dtype=torch.float64)
19 gae_duplicate tensor(-0.1411, dtype=torch.float64) tensor(-0.7171, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4984, dtype=torch.float64) delta_t tensor(-0.0324, dtype=torch.float64)
18 gae_duplicate tensor(-0.1614, dtype=torch.float64) tensor(0.5688, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2846, dtype=torch.float64) delta_t tensor(0.3837, dtype=torch.float64)
17 gae_duplicate tensor(-0.1339, dtype=torch.float64) tensor(-7.6956, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5626, dtype=torch.float64) delta_t tensor(-0.0422, dtype=torch.float64)
16 gae_duplicate tensor(-0.1476, dtype=torch.float64) tensor(0.1585, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1225, dtype=torch.float64) delta_t tensor(0.0320, dtype=torch.float64)
15 gae_duplicate tensor(-0.1304, dtype=torch.float64) tensor(-0.5963, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5481, dtype=torch.float64) delta_t tensor(-0.0601, dtype=torch.float64)
14 gae_duplicate tensor(-0.1873, dtype=torch.float64) tensor(1.0833, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0440, dtype=torch.float64) delta_t tensor(-0.0878, dtype=torch.float64)
13 gae_duplicate tensor(-0.1701, dtype=torch.float64) tensor(1.8699, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5556, dtype=torch.float64) delta_t tensor(-0.0667, dtype=torch.float64)
12 gae_duplicate tensor(-0.1632, dtype=torch.float64) tensor(1.4820, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0299, dtype=torch.float64) delta_t tensor(0.0109, dtype=torch.float64)
11 gae_duplicate tensor(-0.0808, dtype=torch.float64) tensor(-0.0970, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5181, dtype=torch.float64) delta_t tensor(0.0032, dtype=torch.float64)
10 gae_duplicate tensor(-0.0584, dtype=torch.float64) tensor(-0.0567, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0371, dtype=torch.float64) delta_t tensor(-0.0919, dtype=torch.float64)
9 gae_duplicate tensor(-0.1429, dtype=torch.float64) tensor(1.7917, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5115, dtype=torch.float64) delta_t tensor(-0.1039, dtype=torch.float64)
8 gae_duplicate tensor(-0.1670, dtype=torch.float64) tensor(2.1800, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0006, dtype=torch.float64) delta_t tensor(-0.0938, dtype=torch.float64)
7 gae_duplicate tensor(-0.3044, dtype=torch.float64) tensor(2.0860, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4385, dtype=torch.float64) delta_t tensor(0.1053, dtype=torch.float64)
6 gae_duplicate tensor(0.0691, dtype=torch.float64) tensor(-1.8976, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1760, dtype=torch.float64) delta_t tensor(0.4587, dtype=torch.float64)
5 gae_duplicate tensor(0.1164, dtype=torch.float64) tensor(-9.2481, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9368, dtype=torch.float64) delta_t tensor(-0.7580, dtype=torch.float64)
4 gae_duplicate tensor(-3.7418, dtype=torch.float64) tensor(13.7415, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1685, dtype=torch.float64) delta_t tensor(1.5902, dtype=torch.float64)
3 gae_duplicate tensor(1.0146, dtype=torch.float64) tensor(-29.9104, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1685, dtype=torch.float64) delta_t tensor(0.1498, dtype=torch.float64)
2 gae_duplicate tensor(-0.0115, dtype=torch.float64) tensor(-6.0357, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1593.814208984375
value loss:96.43778991699219
entropies:355.61016845703125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.964953184127808 seconds
19 rew tensor(0.4775, dtype=torch.float64) delta_t tensor(-0.0334, dtype=torch.float64)
19 gae_duplicate tensor(-0.2991, dtype=torch.float64) tensor(0.6727, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4292, dtype=torch.float64) delta_t tensor(0.1466, dtype=torch.float64)
18 gae_duplicate tensor(0.0394, dtype=torch.float64) tensor(-2.8372, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4631, dtype=torch.float64) delta_t tensor(0.0514, dtype=torch.float64)
17 gae_duplicate tensor(-0.0890, dtype=torch.float64) tensor(-1.2855, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4295, dtype=torch.float64) delta_t tensor(0.0367, dtype=torch.float64)
16 gae_duplicate tensor(-0.0757, dtype=torch.float64) tensor(-0.8743, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3721, dtype=torch.float64) delta_t tensor(-0.0092, dtype=torch.float64)
15 gae_duplicate tensor(-0.0811, dtype=torch.float64) tensor(0.0833, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4292, dtype=torch.float64) delta_t tensor(0.0432, dtype=torch.float64)
14 gae_duplicate tensor(-0.1720, dtype=torch.float64) tensor(-0.8627, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3862, dtype=torch.float64) delta_t tensor(-0.0277, dtype=torch.float64)
13 gae_duplicate tensor(-0.1141, dtype=torch.float64) tensor(0.4822, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4218, dtype=torch.float64) delta_t tensor(0.0472, dtype=torch.float64)
12 gae_duplicate tensor(-0.1542, dtype=torch.float64) tensor(-0.8928, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3788, dtype=torch.float64) delta_t tensor(-0.0201, dtype=torch.float64)
11 gae_duplicate tensor(-0.1982, dtype=torch.float64) tensor(0.3586, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4144, dtype=torch.float64) delta_t tensor(0.0625, dtype=torch.float64)
10 gae_duplicate tensor(-0.0381, dtype=torch.float64) tensor(-1.1873, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0178, dtype=torch.float64) delta_t tensor(-0.2846, dtype=torch.float64)
9 gae_duplicate tensor(-1.8164, dtype=torch.float64) tensor(5.6258, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7657, dtype=torch.float64) delta_t tensor(-1.0670, dtype=torch.float64)
8 gae_duplicate tensor(-6.8019, dtype=torch.float64) tensor(20.8827, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1465, dtype=torch.float64) delta_t tensor(0.0201, dtype=torch.float64)
7 gae_duplicate tensor(-0.4983, dtype=torch.float64) tensor(1.7566, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2557, dtype=torch.float64) delta_t tensor(0.2216, dtype=torch.float64)
6 gae_duplicate tensor(-0.0358, dtype=torch.float64) tensor(-4.2840, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1638, dtype=torch.float64) delta_t tensor(0.3743, dtype=torch.float64)
5 gae_duplicate tensor(0.1594, dtype=torch.float64) tensor(-7.8522, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1231, dtype=torch.float64) delta_t tensor(-0.9057, dtype=torch.float64)
4 gae_duplicate tensor(-2.2544, dtype=torch.float64) tensor(17.2367, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0579, dtype=torch.float64) delta_t tensor(0.3620, dtype=torch.float64)
3 gae_duplicate tensor(-0.1911, dtype=torch.float64) tensor(-5.5752, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3303, dtype=torch.float64) delta_t tensor(0.0572, dtype=torch.float64)
2 gae_duplicate tensor(-0.2877, dtype=torch.float64) tensor(-1.6571, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1164.7159423828125
value loss:100.10542297363281
entropies:355.7287292480469
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3954.6931)
ToM Target loss= tensor(3715.0061)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.875870227813721 seconds
19 rew tensor(0.4466, dtype=torch.float64) delta_t tensor(-0.0076, dtype=torch.float64)
19 gae_duplicate tensor(-0.0771, dtype=torch.float64) tensor(0.1601, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4380, dtype=torch.float64) delta_t tensor(-0.0140, dtype=torch.float64)
18 gae_duplicate tensor(-0.1387, dtype=torch.float64) tensor(0.2754, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4090, dtype=torch.float64) delta_t tensor(0.1103, dtype=torch.float64)
17 gae_duplicate tensor(-0.0677, dtype=torch.float64) tensor(-2.1716, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4810, dtype=torch.float64) delta_t tensor(-0.0548, dtype=torch.float64)
16 gae_duplicate tensor(-0.0828, dtype=torch.float64) tensor(0.8724, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2299, dtype=torch.float64) delta_t tensor(0.0078, dtype=torch.float64)
15 gae_duplicate tensor(-0.1253, dtype=torch.float64) tensor(-0.0714, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4909, dtype=torch.float64) delta_t tensor(0.0308, dtype=torch.float64)
14 gae_duplicate tensor(-0.1339, dtype=torch.float64) tensor(-0.6095, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2123, dtype=torch.float64) delta_t tensor(-0.0276, dtype=torch.float64)
13 gae_duplicate tensor(-0.1685, dtype=torch.float64) tensor(0.5006, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4913, dtype=torch.float64) delta_t tensor(0.0265, dtype=torch.float64)
12 gae_duplicate tensor(-0.1255, dtype=torch.float64) tensor(-0.4901, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1684, dtype=torch.float64) delta_t tensor(0.0471, dtype=torch.float64)
11 gae_duplicate tensor(-0.0271, dtype=torch.float64) tensor(-0.9845, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4840, dtype=torch.float64) delta_t tensor(0.0169, dtype=torch.float64)
10 gae_duplicate tensor(-0.0305, dtype=torch.float64) tensor(-0.4305, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0248, dtype=torch.float64) delta_t tensor(-0.1209, dtype=torch.float64)
9 gae_duplicate tensor(-0.7227, dtype=torch.float64) tensor(2.3805, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4290, dtype=torch.float64) delta_t tensor(-0.0371, dtype=torch.float64)
8 gae_duplicate tensor(-0.1119, dtype=torch.float64) tensor(0.9622, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1073, dtype=torch.float64) delta_t tensor(-0.0300, dtype=torch.float64)
7 gae_duplicate tensor(-0.1418, dtype=torch.float64) tensor(0.6953, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3887, dtype=torch.float64) delta_t tensor(0.1905, dtype=torch.float64)
6 gae_duplicate tensor(0.1142, dtype=torch.float64) tensor(-3.7191, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1167, dtype=torch.float64) delta_t tensor(0.4761, dtype=torch.float64)
5 gae_duplicate tensor(0.1320, dtype=torch.float64) tensor(-9.9233, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3147, dtype=torch.float64) delta_t tensor(0.5436, dtype=torch.float64)
4 gae_duplicate tensor(-1.8672, dtype=torch.float64) tensor(-11.5166, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1421, dtype=torch.float64) delta_t tensor(0.7152, dtype=torch.float64)
3 gae_duplicate tensor(-0.1411, dtype=torch.float64) tensor(-15.3010, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2071, dtype=torch.float64) delta_t tensor(0.0323, dtype=torch.float64)
2 gae_duplicate tensor(-0.1178, dtype=torch.float64) tensor(-2.1500, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2146.061767578125
value loss:44.61100769042969
entropies:355.85247802734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.675390958786011 seconds
19 rew tensor(0.5052, dtype=torch.float64) delta_t tensor(0.0323, dtype=torch.float64)
19 gae_duplicate tensor(-0.0741, dtype=torch.float64) tensor(-0.6410, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3244, dtype=torch.float64) delta_t tensor(-0.0470, dtype=torch.float64)
18 gae_duplicate tensor(-0.2937, dtype=torch.float64) tensor(0.8859, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4329, dtype=torch.float64) delta_t tensor(0.1509, dtype=torch.float64)
17 gae_duplicate tensor(-0.0405, dtype=torch.float64) tensor(-2.9128, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4278, dtype=torch.float64) delta_t tensor(-0.0088, dtype=torch.float64)
16 gae_duplicate tensor(-0.0538, dtype=torch.float64) tensor(-0.1198, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1650, dtype=torch.float64) delta_t tensor(-0.0521, dtype=torch.float64)
15 gae_duplicate tensor(-0.2237, dtype=torch.float64) tensor(1.0172, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4274, dtype=torch.float64) delta_t tensor(0.0400, dtype=torch.float64)
14 gae_duplicate tensor(-0.0656, dtype=torch.float64) tensor(-0.6870, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1871, dtype=torch.float64) delta_t tensor(-0.0784, dtype=torch.float64)
13 gae_duplicate tensor(-0.3011, dtype=torch.float64) tensor(1.4696, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4348, dtype=torch.float64) delta_t tensor(-0.0166, dtype=torch.float64)
12 gae_duplicate tensor(-0.1173, dtype=torch.float64) tensor(0.4759, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1792, dtype=torch.float64) delta_t tensor(-0.0915, dtype=torch.float64)
11 gae_duplicate tensor(-0.1547, dtype=torch.float64) tensor(1.8610, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4119, dtype=torch.float64) delta_t tensor(0.0184, dtype=torch.float64)
10 gae_duplicate tensor(-0.0793, dtype=torch.float64) tensor(-0.1758, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0101, dtype=torch.float64) delta_t tensor(-0.2143, dtype=torch.float64)
9 gae_duplicate tensor(-0.7522, dtype=torch.float64) tensor(4.2152, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3905, dtype=torch.float64) delta_t tensor(0.0014, dtype=torch.float64)
8 gae_duplicate tensor(-0.1144, dtype=torch.float64) tensor(0.4033, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1279, dtype=torch.float64) delta_t tensor(-0.0489, dtype=torch.float64)
7 gae_duplicate tensor(-0.2150, dtype=torch.float64) tensor(1.0145, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1299, dtype=torch.float64) delta_t tensor(0.0290, dtype=torch.float64)
6 gae_duplicate tensor(-0.6281, dtype=torch.float64) tensor(-0.4743, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1241, dtype=torch.float64) delta_t tensor(0.1399, dtype=torch.float64)
5 gae_duplicate tensor(-0.0360, dtype=torch.float64) tensor(-2.8134, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0911, dtype=torch.float64) delta_t tensor(-0.3304, dtype=torch.float64)
4 gae_duplicate tensor(-3.1560, dtype=torch.float64) tensor(6.3400, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0739, dtype=torch.float64) delta_t tensor(0.2953, dtype=torch.float64)
3 gae_duplicate tensor(-0.5433, dtype=torch.float64) tensor(-5.1043, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3770, dtype=torch.float64) delta_t tensor(-0.1182, dtype=torch.float64)
2 gae_duplicate tensor(-0.2724, dtype=torch.float64) tensor(1.8007, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-450.05413818359375
value loss:28.724271774291992
entropies:355.9064636230469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.672252893447876 seconds
19 rew tensor(0.4481, dtype=torch.float64) delta_t tensor(0.0473, dtype=torch.float64)
19 gae_duplicate tensor(-0.1038, dtype=torch.float64) tensor(-0.9391, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4930, dtype=torch.float64) delta_t tensor(0.0186, dtype=torch.float64)
18 gae_duplicate tensor(-0.1179, dtype=torch.float64) tensor(-0.4575, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4280, dtype=torch.float64) delta_t tensor(0.1800, dtype=torch.float64)
17 gae_duplicate tensor(-0.0890, dtype=torch.float64) tensor(-3.5824, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5257, dtype=torch.float64) delta_t tensor(0.0808, dtype=torch.float64)
16 gae_duplicate tensor(-0.0715, dtype=torch.float64) tensor(-1.9526, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0721, dtype=torch.float64) delta_t tensor(-0.0206, dtype=torch.float64)
15 gae_duplicate tensor(-0.2613, dtype=torch.float64) tensor(0.2144, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5039, dtype=torch.float64) delta_t tensor(-0.0250, dtype=torch.float64)
14 gae_duplicate tensor(-0.1189, dtype=torch.float64) tensor(0.5152, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0254, dtype=torch.float64) delta_t tensor(-0.1001, dtype=torch.float64)
13 gae_duplicate tensor(-0.2672, dtype=torch.float64) tensor(2.0348, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4678, dtype=torch.float64) delta_t tensor(-0.0670, dtype=torch.float64)
12 gae_duplicate tensor(-0.1534, dtype=torch.float64) tensor(1.5243, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0108, dtype=torch.float64) delta_t tensor(-0.0455, dtype=torch.float64)
11 gae_duplicate tensor(-0.1103, dtype=torch.float64) tensor(1.0455, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4371, dtype=torch.float64) delta_t tensor(0.0483, dtype=torch.float64)
10 gae_duplicate tensor(0.0083, dtype=torch.float64) tensor(-0.8464, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0185, dtype=torch.float64) delta_t tensor(-0.0954, dtype=torch.float64)
9 gae_duplicate tensor(-0.2060, dtype=torch.float64) tensor(1.7978, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4152, dtype=torch.float64) delta_t tensor(-0.1094, dtype=torch.float64)
8 gae_duplicate tensor(-0.1546, dtype=torch.float64) tensor(2.3549, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0774, dtype=torch.float64) delta_t tensor(-0.1124, dtype=torch.float64)
7 gae_duplicate tensor(-0.1863, dtype=torch.float64) tensor(2.4623, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2907, dtype=torch.float64) delta_t tensor(0.0340, dtype=torch.float64)
6 gae_duplicate tensor(-0.3800, dtype=torch.float64) tensor(-0.4194, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3940, dtype=torch.float64) delta_t tensor(0.5474, dtype=torch.float64)
5 gae_duplicate tensor(0.0309, dtype=torch.float64) tensor(-10.8654, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.9585, dtype=torch.float64) delta_t tensor(-3.7887, dtype=torch.float64)
4 gae_duplicate tensor(-7.9566, dtype=torch.float64) tensor(74.0333, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1426, dtype=torch.float64) delta_t tensor(0.6638, dtype=torch.float64)
3 gae_duplicate tensor(-0.2753, dtype=torch.float64) tensor(-5.6756, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1494, dtype=torch.float64) delta_t tensor(0.1318, dtype=torch.float64)
2 gae_duplicate tensor(-0.1995, dtype=torch.float64) tensor(-3.2150, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3229.66748046875
value loss:194.53053283691406
entropies:355.92047119140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.515571117401123 seconds
19 rew tensor(0.5197, dtype=torch.float64) delta_t tensor(0.2568, dtype=torch.float64)
19 gae_duplicate tensor(-0.0495, dtype=torch.float64) tensor(-5.1004, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5171, dtype=torch.float64) delta_t tensor(0.0740, dtype=torch.float64)
18 gae_duplicate tensor(-0.1326, dtype=torch.float64) tensor(-1.9658, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4536, dtype=torch.float64) delta_t tensor(0.2063, dtype=torch.float64)
17 gae_duplicate tensor(-0.0285, dtype=torch.float64) tensor(-4.2654, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4317, dtype=torch.float64) delta_t tensor(0.0395, dtype=torch.float64)
16 gae_duplicate tensor(-0.0097, dtype=torch.float64) tensor(-1.2074, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1758, dtype=torch.float64) delta_t tensor(0.0766, dtype=torch.float64)
15 gae_duplicate tensor(-0.1711, dtype=torch.float64) tensor(-1.6366, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4653, dtype=torch.float64) delta_t tensor(-0.0641, dtype=torch.float64)
14 gae_duplicate tensor(-0.0828, dtype=torch.float64) tensor(1.1070, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0744, dtype=torch.float64) delta_t tensor(-0.0755, dtype=torch.float64)
13 gae_duplicate tensor(-0.2720, dtype=torch.float64) tensor(1.6127, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4654, dtype=torch.float64) delta_t tensor(-0.0912, dtype=torch.float64)
12 gae_duplicate tensor(-0.1339, dtype=torch.float64) tensor(1.9757, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0602, dtype=torch.float64) delta_t tensor(-0.0532, dtype=torch.float64)
11 gae_duplicate tensor(-0.1484, dtype=torch.float64) tensor(1.2570, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4294, dtype=torch.float64) delta_t tensor(0.0036, dtype=torch.float64)
10 gae_duplicate tensor(-0.1655, dtype=torch.float64) tensor(0.0578, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0353, dtype=torch.float64) delta_t tensor(-0.0784, dtype=torch.float64)
9 gae_duplicate tensor(-0.2187, dtype=torch.float64) tensor(1.5530, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3617, dtype=torch.float64) delta_t tensor(-0.0788, dtype=torch.float64)
8 gae_duplicate tensor(-0.1686, dtype=torch.float64) tensor(1.7188, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0370, dtype=torch.float64) delta_t tensor(-0.0670, dtype=torch.float64)
7 gae_duplicate tensor(-0.1933, dtype=torch.float64) tensor(1.4820, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2496, dtype=torch.float64) delta_t tensor(0.0667, dtype=torch.float64)
6 gae_duplicate tensor(-0.2574, dtype=torch.float64) tensor(-1.1665, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2076, dtype=torch.float64) delta_t tensor(0.4644, dtype=torch.float64)
5 gae_duplicate tensor(0.0117, dtype=torch.float64) tensor(-9.3355, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.8873, dtype=torch.float64) delta_t tensor(-1.4630, dtype=torch.float64)
4 gae_duplicate tensor(-2.6233, dtype=torch.float64) tensor(27.9410, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0113, dtype=torch.float64) delta_t tensor(0.4692, dtype=torch.float64)
3 gae_duplicate tensor(-0.3934, dtype=torch.float64) tensor(-6.5146, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2096, dtype=torch.float64) delta_t tensor(0.0135, dtype=torch.float64)
2 gae_duplicate tensor(-0.6260, dtype=torch.float64) tensor(-0.9514, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-450.4078063964844
value loss:42.0582389831543
entropies:355.91204833984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.969346761703491 seconds
19 rew tensor(0.3821, dtype=torch.float64) delta_t tensor(-0.0051, dtype=torch.float64)
19 gae_duplicate tensor(-0.1786, dtype=torch.float64) tensor(0.0943, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4665, dtype=torch.float64) delta_t tensor(-0.0275, dtype=torch.float64)
18 gae_duplicate tensor(-0.1679, dtype=torch.float64) tensor(0.5580, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3154, dtype=torch.float64) delta_t tensor(0.0934, dtype=torch.float64)
17 gae_duplicate tensor(-0.0721, dtype=torch.float64) tensor(-1.7961, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5403, dtype=torch.float64) delta_t tensor(0.0021, dtype=torch.float64)
16 gae_duplicate tensor(-0.1082, dtype=torch.float64) tensor(-0.2227, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1625, dtype=torch.float64) delta_t tensor(-0.0247, dtype=torch.float64)
15 gae_duplicate tensor(-0.2332, dtype=torch.float64) tensor(0.4673, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5627, dtype=torch.float64) delta_t tensor(-0.0120, dtype=torch.float64)
14 gae_duplicate tensor(-0.1094, dtype=torch.float64) tensor(0.2834, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1550, dtype=torch.float64) delta_t tensor(0.0051, dtype=torch.float64)
13 gae_duplicate tensor(-0.2396, dtype=torch.float64) tensor(-0.0721, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5483, dtype=torch.float64) delta_t tensor(-0.0055, dtype=torch.float64)
12 gae_duplicate tensor(-0.1500, dtype=torch.float64) tensor(0.1066, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1481, dtype=torch.float64) delta_t tensor(0.0313, dtype=torch.float64)
11 gae_duplicate tensor(-0.1046, dtype=torch.float64) tensor(-0.6148, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5256, dtype=torch.float64) delta_t tensor(0.0267, dtype=torch.float64)
10 gae_duplicate tensor(-0.0282, dtype=torch.float64) tensor(-0.5888, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6097, dtype=torch.float64) delta_t tensor(-0.7456, dtype=torch.float64)
9 gae_duplicate tensor(-4.2725, dtype=torch.float64) tensor(14.7602, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0378, dtype=torch.float64) delta_t tensor(-0.2820, dtype=torch.float64)
8 gae_duplicate tensor(-1.9172, dtype=torch.float64) tensor(7.0392, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0324, dtype=torch.float64) delta_t tensor(0.1315, dtype=torch.float64)
7 gae_duplicate tensor(-0.1088, dtype=torch.float64) tensor(-1.8562, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2749, dtype=torch.float64) delta_t tensor(0.1014, dtype=torch.float64)
6 gae_duplicate tensor(0.0476, dtype=torch.float64) tensor(-2.1857, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1278, dtype=torch.float64) delta_t tensor(0.4292, dtype=torch.float64)
5 gae_duplicate tensor(0.0356, dtype=torch.float64) tensor(-8.6306, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5022, dtype=torch.float64) delta_t tensor(-0.7487, dtype=torch.float64)
4 gae_duplicate tensor(-3.6618, dtype=torch.float64) tensor(14.0369, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0566, dtype=torch.float64) delta_t tensor(0.4356, dtype=torch.float64)
3 gae_duplicate tensor(-0.2416, dtype=torch.float64) tensor(-7.2442, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3509, dtype=torch.float64) delta_t tensor(-0.0841, dtype=torch.float64)
2 gae_duplicate tensor(-0.2925, dtype=torch.float64) tensor(0.9335, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-909.77294921875
value loss:71.88760375976562
entropies:355.92437744140625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3955.4485)
ToM Target loss= tensor(3727.8423)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.93785285949707 seconds
19 rew tensor(0.3571, dtype=torch.float64) delta_t tensor(-0.0206, dtype=torch.float64)
19 gae_duplicate tensor(-0.1354, dtype=torch.float64) tensor(0.4061, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4495, dtype=torch.float64) delta_t tensor(-0.0225, dtype=torch.float64)
18 gae_duplicate tensor(-0.0703, dtype=torch.float64) tensor(0.4844, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3717, dtype=torch.float64) delta_t tensor(-0.0266, dtype=torch.float64)
17 gae_duplicate tensor(-0.0826, dtype=torch.float64) tensor(0.5831, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4496, dtype=torch.float64) delta_t tensor(-0.0003, dtype=torch.float64)
16 gae_duplicate tensor(-0.0291, dtype=torch.float64) tensor(0.0619, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3651, dtype=torch.float64) delta_t tensor(0.0120, dtype=torch.float64)
15 gae_duplicate tensor(-0.0914, dtype=torch.float64) tensor(-0.2289, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4571, dtype=torch.float64) delta_t tensor(-0.0334, dtype=torch.float64)
14 gae_duplicate tensor(-0.1032, dtype=torch.float64) tensor(0.6353, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3722, dtype=torch.float64) delta_t tensor(-0.0151, dtype=torch.float64)
13 gae_duplicate tensor(-0.1016, dtype=torch.float64) tensor(0.3628, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4573, dtype=torch.float64) delta_t tensor(-0.0124, dtype=torch.float64)
12 gae_duplicate tensor(-0.0902, dtype=torch.float64) tensor(0.2850, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3647, dtype=torch.float64) delta_t tensor(0.0091, dtype=torch.float64)
11 gae_duplicate tensor(-0.0855, dtype=torch.float64) tensor(-0.1535, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4273, dtype=torch.float64) delta_t tensor(0.0243, dtype=torch.float64)
10 gae_duplicate tensor(-0.0497, dtype=torch.float64) tensor(-0.4916, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3514, dtype=torch.float64) delta_t tensor(0.0229, dtype=torch.float64)
9 gae_duplicate tensor(-0.0328, dtype=torch.float64) tensor(-0.5011, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4136, dtype=torch.float64) delta_t tensor(0.0151, dtype=torch.float64)
8 gae_duplicate tensor(-0.0608, dtype=torch.float64) tensor(-0.3512, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3287, dtype=torch.float64) delta_t tensor(0.0083, dtype=torch.float64)
7 gae_duplicate tensor(-0.0452, dtype=torch.float64) tensor(-0.2037, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3333, dtype=torch.float64) delta_t tensor(0.1991, dtype=torch.float64)
6 gae_duplicate tensor(0.1097, dtype=torch.float64) tensor(-3.9442, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1026, dtype=torch.float64) delta_t tensor(0.1754, dtype=torch.float64)
5 gae_duplicate tensor(0.1246, dtype=torch.float64) tensor(-3.8690, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5906, dtype=torch.float64) delta_t tensor(-1.7852, dtype=torch.float64)
4 gae_duplicate tensor(-3.6456, dtype=torch.float64) tensor(34.6684, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0598, dtype=torch.float64) delta_t tensor(0.3959, dtype=torch.float64)
3 gae_duplicate tensor(-0.0695, dtype=torch.float64) tensor(-4.3328, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2362, dtype=torch.float64) delta_t tensor(0.0080, dtype=torch.float64)
2 gae_duplicate tensor(-0.0826, dtype=torch.float64) tensor(-0.5934, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1328.2425537109375
value loss:52.70195007324219
entropies:355.91619873046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.324796915054321 seconds
19 rew tensor(0.4543, dtype=torch.float64) delta_t tensor(0.0181, dtype=torch.float64)
19 gae_duplicate tensor(-0.0674, dtype=torch.float64) tensor(-0.3594, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4529, dtype=torch.float64) delta_t tensor(1.6974e-05, dtype=torch.float64)
18 gae_duplicate tensor(-0.1664, dtype=torch.float64) tensor(-0.0267, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3928, dtype=torch.float64) delta_t tensor(0.0743, dtype=torch.float64)
17 gae_duplicate tensor(-0.0827, dtype=torch.float64) tensor(-1.4704, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5149, dtype=torch.float64) delta_t tensor(0.0128, dtype=torch.float64)
16 gae_duplicate tensor(-0.1147, dtype=torch.float64) tensor(-0.3983, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3313, dtype=torch.float64) delta_t tensor(0.0304, dtype=torch.float64)
15 gae_duplicate tensor(-0.1093, dtype=torch.float64) tensor(-0.6369, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5078, dtype=torch.float64) delta_t tensor(0.1163, dtype=torch.float64)
14 gae_duplicate tensor(0.0339, dtype=torch.float64) tensor(-2.3629, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3389, dtype=torch.float64) delta_t tensor(0.0144, dtype=torch.float64)
13 gae_duplicate tensor(-0.1277, dtype=torch.float64) tensor(-0.5111, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5153, dtype=torch.float64) delta_t tensor(0.0910, dtype=torch.float64)
12 gae_duplicate tensor(-0.0796, dtype=torch.float64) tensor(-1.8494, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3243, dtype=torch.float64) delta_t tensor(0.0512, dtype=torch.float64)
11 gae_duplicate tensor(-0.0602, dtype=torch.float64) tensor(-1.2095, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5011, dtype=torch.float64) delta_t tensor(0.0496, dtype=torch.float64)
10 gae_duplicate tensor(-0.1043, dtype=torch.float64) tensor(-1.1007, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2758, dtype=torch.float64) delta_t tensor(-0.5453, dtype=torch.float64)
9 gae_duplicate tensor(-1.6211, dtype=torch.float64) tensor(10.6181, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2722, dtype=torch.float64) delta_t tensor(-1.6661, dtype=torch.float64)
8 gae_duplicate tensor(-5.9429, dtype=torch.float64) tensor(34.1968, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3438, dtype=torch.float64) delta_t tensor(-0.3073, dtype=torch.float64)
7 gae_duplicate tensor(-2.1907, dtype=torch.float64) tensor(9.5267, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0162, dtype=torch.float64) delta_t tensor(-0.1581, dtype=torch.float64)
6 gae_duplicate tensor(-1.0331, dtype=torch.float64) tensor(4.0619, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0100, dtype=torch.float64) delta_t tensor(0.2232, dtype=torch.float64)
5 gae_duplicate tensor(0.0617, dtype=torch.float64) tensor(-4.0205, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4488, dtype=torch.float64) delta_t tensor(-0.9093, dtype=torch.float64)
4 gae_duplicate tensor(-2.9155, dtype=torch.float64) tensor(17.4824, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2094, dtype=torch.float64) delta_t tensor(0.1451, dtype=torch.float64)
3 gae_duplicate tensor(-0.3257, dtype=torch.float64) tensor(-1.1196, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1999, dtype=torch.float64) delta_t tensor(0.0520, dtype=torch.float64)
2 gae_duplicate tensor(-0.2163, dtype=torch.float64) tensor(-1.1341, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3319.16552734375
value loss:126.14546203613281
entropies:355.927734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.090688943862915 seconds
19 rew tensor(0.4065, dtype=torch.float64) delta_t tensor(0.0532, dtype=torch.float64)
19 gae_duplicate tensor(-0.1051, dtype=torch.float64) tensor(-1.0571, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4463, dtype=torch.float64) delta_t tensor(0.0428, dtype=torch.float64)
18 gae_duplicate tensor(-0.1106, dtype=torch.float64) tensor(-0.9516, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3724, dtype=torch.float64) delta_t tensor(0.0757, dtype=torch.float64)
17 gae_duplicate tensor(-0.0653, dtype=torch.float64) tensor(-1.5835, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4433, dtype=torch.float64) delta_t tensor(0.0216, dtype=torch.float64)
16 gae_duplicate tensor(-0.0319, dtype=torch.float64) tensor(-0.5931, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2729, dtype=torch.float64) delta_t tensor(0.0114, dtype=torch.float64)
15 gae_duplicate tensor(-0.0494, dtype=torch.float64) tensor(-0.2889, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4747, dtype=torch.float64) delta_t tensor(0.0655, dtype=torch.float64)
14 gae_duplicate tensor(-0.0726, dtype=torch.float64) tensor(-1.3269, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2717, dtype=torch.float64) delta_t tensor(0.0270, dtype=torch.float64)
13 gae_duplicate tensor(-0.1340, dtype=torch.float64) tensor(-0.6699, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4739, dtype=torch.float64) delta_t tensor(0.0452, dtype=torch.float64)
12 gae_duplicate tensor(-0.0800, dtype=torch.float64) tensor(-0.9585, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2570, dtype=torch.float64) delta_t tensor(0.0367, dtype=torch.float64)
11 gae_duplicate tensor(-0.0074, dtype=torch.float64) tensor(-0.8141, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4604, dtype=torch.float64) delta_t tensor(0.0441, dtype=torch.float64)
10 gae_duplicate tensor(-0.0185, dtype=torch.float64) tensor(-0.9441, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2506, dtype=torch.float64) delta_t tensor(0.0621, dtype=torch.float64)
9 gae_duplicate tensor(0.0047, dtype=torch.float64) tensor(-1.3318, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4382, dtype=torch.float64) delta_t tensor(0.0151, dtype=torch.float64)
8 gae_duplicate tensor(-0.0807, dtype=torch.float64) tensor(-0.4301, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2283, dtype=torch.float64) delta_t tensor(0.0469, dtype=torch.float64)
7 gae_duplicate tensor(-0.1159, dtype=torch.float64) tensor(-0.9672, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3583, dtype=torch.float64) delta_t tensor(0.2089, dtype=torch.float64)
6 gae_duplicate tensor(0.1054, dtype=torch.float64) tensor(-4.2290, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0345, dtype=torch.float64) delta_t tensor(0.0813, dtype=torch.float64)
5 gae_duplicate tensor(-0.5056, dtype=torch.float64) tensor(-2.0348, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9527, dtype=torch.float64) delta_t tensor(-1.6496, dtype=torch.float64)
4 gae_duplicate tensor(-4.4403, dtype=torch.float64) tensor(32.5061, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0072, dtype=torch.float64) delta_t tensor(0.2587, dtype=torch.float64)
3 gae_duplicate tensor(-0.4072, dtype=torch.float64) tensor(-1.8665, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2534, dtype=torch.float64) delta_t tensor(-0.0245, dtype=torch.float64)
2 gae_duplicate tensor(-0.1773, dtype=torch.float64) tensor(0.2925, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-784.6727294921875
value loss:63.97586441040039
entropies:355.9192199707031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.018326997756958 seconds
19 rew tensor(0.5265, dtype=torch.float64) delta_t tensor(0.0922, dtype=torch.float64)
19 gae_duplicate tensor(0.0112, dtype=torch.float64) tensor(-1.8096, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3785, dtype=torch.float64) delta_t tensor(0.1027, dtype=torch.float64)
18 gae_duplicate tensor(-0.0508, dtype=torch.float64) tensor(-2.2187, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4336, dtype=torch.float64) delta_t tensor(0.1873, dtype=torch.float64)
17 gae_duplicate tensor(0.0374, dtype=torch.float64) tensor(-3.9280, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4553, dtype=torch.float64) delta_t tensor(0.1016, dtype=torch.float64)
16 gae_duplicate tensor(0.0264, dtype=torch.float64) tensor(-2.4071, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2887, dtype=torch.float64) delta_t tensor(0.0980, dtype=torch.float64)
15 gae_duplicate tensor(0.0245, dtype=torch.float64) tensor(-2.1752, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4631, dtype=torch.float64) delta_t tensor(0.0446, dtype=torch.float64)
14 gae_duplicate tensor(-0.0220, dtype=torch.float64) tensor(-1.0964, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2510, dtype=torch.float64) delta_t tensor(0.0561, dtype=torch.float64)
13 gae_duplicate tensor(-0.0277, dtype=torch.float64) tensor(-1.2326, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4633, dtype=torch.float64) delta_t tensor(0.0561, dtype=torch.float64)
12 gae_duplicate tensor(-0.0258, dtype=torch.float64) tensor(-1.2272, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2297, dtype=torch.float64) delta_t tensor(0.1243, dtype=torch.float64)
11 gae_duplicate tensor(0.0132, dtype=torch.float64) tensor(-2.5569, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4346, dtype=torch.float64) delta_t tensor(0.1365, dtype=torch.float64)
10 gae_duplicate tensor(0.0844, dtype=torch.float64) tensor(-2.9426, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2362, dtype=torch.float64) delta_t tensor(0.1344, dtype=torch.float64)
9 gae_duplicate tensor(0.0651, dtype=torch.float64) tensor(-2.9716, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4041, dtype=torch.float64) delta_t tensor(0.0613, dtype=torch.float64)
8 gae_duplicate tensor(-0.0278, dtype=torch.float64) tensor(-1.5151, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1923, dtype=torch.float64) delta_t tensor(0.0551, dtype=torch.float64)
7 gae_duplicate tensor(-0.0197, dtype=torch.float64) tensor(-1.2415, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3534, dtype=torch.float64) delta_t tensor(0.2668, dtype=torch.float64)
6 gae_duplicate tensor(0.1943, dtype=torch.float64) tensor(-5.3965, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0622, dtype=torch.float64) delta_t tensor(0.3682, dtype=torch.float64)
5 gae_duplicate tensor(0.2437, dtype=torch.float64) tensor(-7.8302, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.0370, dtype=torch.float64) delta_t tensor(-1.6893, dtype=torch.float64)
4 gae_duplicate tensor(-4.3255, dtype=torch.float64) tensor(32.5918, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0266, dtype=torch.float64) delta_t tensor(0.2800, dtype=torch.float64)
3 gae_duplicate tensor(-0.4572, dtype=torch.float64) tensor(-2.1909, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2293, dtype=torch.float64) delta_t tensor(0.0393, dtype=torch.float64)
2 gae_duplicate tensor(-0.1933, dtype=torch.float64) tensor(-1.0218, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:507.0893859863281
value loss:52.374996185302734
entropies:355.8854064941406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.511076211929321 seconds
19 rew tensor(0.4189, dtype=torch.float64) delta_t tensor(0.1338, dtype=torch.float64)
19 gae_duplicate tensor(0.0164, dtype=torch.float64) tensor(-2.6680, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4213, dtype=torch.float64) delta_t tensor(0.0895, dtype=torch.float64)
18 gae_duplicate tensor(-0.0050, dtype=torch.float64) tensor(-2.0666, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3010, dtype=torch.float64) delta_t tensor(0.3139, dtype=torch.float64)
17 gae_duplicate tensor(0.1339, dtype=torch.float64) tensor(-6.4418, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4914, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
16 gae_duplicate tensor(-0.1398, dtype=torch.float64) tensor(-1.4087, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0509, dtype=torch.float64) delta_t tensor(0.0762, dtype=torch.float64)
15 gae_duplicate tensor(-0.0078, dtype=torch.float64) tensor(-1.6506, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5461, dtype=torch.float64) delta_t tensor(0.1475, dtype=torch.float64)
14 gae_duplicate tensor(0.0287, dtype=torch.float64) tensor(-3.1037, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1147, dtype=torch.float64) delta_t tensor(0.0252, dtype=torch.float64)
13 gae_duplicate tensor(-0.1103, dtype=torch.float64) tensor(-0.8329, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5314, dtype=torch.float64) delta_t tensor(0.1272, dtype=torch.float64)
12 gae_duplicate tensor(0.0365, dtype=torch.float64) tensor(-2.5851, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1273, dtype=torch.float64) delta_t tensor(0.0793, dtype=torch.float64)
11 gae_duplicate tensor(-0.0618, dtype=torch.float64) tensor(-1.8253, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5245, dtype=torch.float64) delta_t tensor(0.2039, dtype=torch.float64)
10 gae_duplicate tensor(0.1559, dtype=torch.float64) tensor(-4.2188, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1501, dtype=torch.float64) delta_t tensor(-0.0009, dtype=torch.float64)
9 gae_duplicate tensor(-0.1095, dtype=torch.float64) tensor(-0.4162, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5096, dtype=torch.float64) delta_t tensor(0.0707, dtype=torch.float64)
8 gae_duplicate tensor(0.0186, dtype=torch.float64) tensor(-1.4429, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1709, dtype=torch.float64) delta_t tensor(-0.0101, dtype=torch.float64)
7 gae_duplicate tensor(-0.2637, dtype=torch.float64) tensor(0.0634, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4288, dtype=torch.float64) delta_t tensor(0.2533, dtype=torch.float64)
6 gae_duplicate tensor(0.2143, dtype=torch.float64) tensor(-5.0324, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3468, dtype=torch.float64) delta_t tensor(0.3159, dtype=torch.float64)
5 gae_duplicate tensor(0.1535, dtype=torch.float64) tensor(-6.7272, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.7096, dtype=torch.float64) delta_t tensor(-1.0238, dtype=torch.float64)
4 gae_duplicate tensor(-5.1343, dtype=torch.float64) tensor(19.6157, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1695, dtype=torch.float64) delta_t tensor(0.0924, dtype=torch.float64)
3 gae_duplicate tensor(-0.3306, dtype=torch.float64) tensor(0.0850, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1767, dtype=torch.float64) delta_t tensor(0.0795, dtype=torch.float64)
2 gae_duplicate tensor(-0.2369, dtype=torch.float64) tensor(-1.5618, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1103.68798828125
value loss:57.028099060058594
entropies:355.83740234375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3956.8376)
ToM Target loss= tensor(3737.9629)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.279188871383667 seconds
19 rew tensor(0.3541, dtype=torch.float64) delta_t tensor(0.0657, dtype=torch.float64)
19 gae_duplicate tensor(0.0227, dtype=torch.float64) tensor(-1.3175, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4139, dtype=torch.float64) delta_t tensor(0.0199, dtype=torch.float64)
18 gae_duplicate tensor(-0.0128, dtype=torch.float64) tensor(-0.5242, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2964, dtype=torch.float64) delta_t tensor(0.2412, dtype=torch.float64)
17 gae_duplicate tensor(0.1435, dtype=torch.float64) tensor(-4.8216, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4961, dtype=torch.float64) delta_t tensor(0.0552, dtype=torch.float64)
16 gae_duplicate tensor(0.0051, dtype=torch.float64) tensor(-1.5811, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1295, dtype=torch.float64) delta_t tensor(0.0864, dtype=torch.float64)
15 gae_duplicate tensor(0.0049, dtype=torch.float64) tensor(-1.8825, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4894, dtype=torch.float64) delta_t tensor(0.1272, dtype=torch.float64)
14 gae_duplicate tensor(0.0567, dtype=torch.float64) tensor(-2.7069, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1445, dtype=torch.float64) delta_t tensor(0.0494, dtype=torch.float64)
13 gae_duplicate tensor(-0.0315, dtype=torch.float64) tensor(-1.2554, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4897, dtype=torch.float64) delta_t tensor(0.1325, dtype=torch.float64)
12 gae_duplicate tensor(0.0129, dtype=torch.float64) tensor(-2.7565, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1089, dtype=torch.float64) delta_t tensor(0.1065, dtype=torch.float64)
11 gae_duplicate tensor(0.0752, dtype=torch.float64) tensor(-2.3769, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4887, dtype=torch.float64) delta_t tensor(0.1294, dtype=torch.float64)
10 gae_duplicate tensor(0.0862, dtype=torch.float64) tensor(-2.8184, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1086, dtype=torch.float64) delta_t tensor(0.0754, dtype=torch.float64)
9 gae_duplicate tensor(-0.0097, dtype=torch.float64) tensor(-1.7398, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4604, dtype=torch.float64) delta_t tensor(0.0431, dtype=torch.float64)
8 gae_duplicate tensor(-0.0138, dtype=torch.float64) tensor(-1.0306, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0718, dtype=torch.float64) delta_t tensor(0.0858, dtype=torch.float64)
7 gae_duplicate tensor(0.0088, dtype=torch.float64) tensor(-1.7782, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3723, dtype=torch.float64) delta_t tensor(0.2451, dtype=torch.float64)
6 gae_duplicate tensor(0.1822, dtype=torch.float64) tensor(-5.0279, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1185, dtype=torch.float64) delta_t tensor(0.2322, dtype=torch.float64)
5 gae_duplicate tensor(0.1594, dtype=torch.float64) tensor(-5.0956, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.2981, dtype=torch.float64) delta_t tensor(-0.9028, dtype=torch.float64)
4 gae_duplicate tensor(-3.4757, dtype=torch.float64) tensor(17.5328, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1759, dtype=torch.float64) delta_t tensor(0.2809, dtype=torch.float64)
3 gae_duplicate tensor(-0.3892, dtype=torch.float64) tensor(-3.7147, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2558, dtype=torch.float64) delta_t tensor(0.0529, dtype=torch.float64)
2 gae_duplicate tensor(-0.1701, dtype=torch.float64) tensor(-1.4291, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1217.440185546875
value loss:41.773311614990234
entropies:355.807861328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.759762763977051 seconds
19 rew tensor(0.4621, dtype=torch.float64) delta_t tensor(0.1061, dtype=torch.float64)
19 gae_duplicate tensor(0.0197, dtype=torch.float64) tensor(-2.0864, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4348, dtype=torch.float64) delta_t tensor(0.0310, dtype=torch.float64)
18 gae_duplicate tensor(-0.0628, dtype=torch.float64) tensor(-0.8384, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3507, dtype=torch.float64) delta_t tensor(0.2320, dtype=torch.float64)
17 gae_duplicate tensor(0.1351, dtype=torch.float64) tensor(-4.6367, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5166, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
16 gae_duplicate tensor(-0.0444, dtype=torch.float64) tensor(-1.0252, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1002, dtype=torch.float64) delta_t tensor(0.0754, dtype=torch.float64)
15 gae_duplicate tensor(-0.1806, dtype=torch.float64) tensor(-1.5976, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5538, dtype=torch.float64) delta_t tensor(0.0802, dtype=torch.float64)
14 gae_duplicate tensor(-0.0038, dtype=torch.float64) tensor(-1.7245, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0701, dtype=torch.float64) delta_t tensor(-0.0245, dtype=torch.float64)
13 gae_duplicate tensor(-0.1803, dtype=torch.float64) tensor(0.3069, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5387, dtype=torch.float64) delta_t tensor(0.0917, dtype=torch.float64)
12 gae_duplicate tensor(-0.0055, dtype=torch.float64) tensor(-1.7849, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0331, dtype=torch.float64) delta_t tensor(0.1144, dtype=torch.float64)
11 gae_duplicate tensor(0.0230, dtype=torch.float64) tensor(-2.4087, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5322, dtype=torch.float64) delta_t tensor(0.0957, dtype=torch.float64)
10 gae_duplicate tensor(0.0767, dtype=torch.float64) tensor(-2.1395, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0706, dtype=torch.float64) delta_t tensor(0.0520, dtype=torch.float64)
9 gae_duplicate tensor(-0.0436, dtype=torch.float64) tensor(-1.2329, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5100, dtype=torch.float64) delta_t tensor(0.0149, dtype=torch.float64)
8 gae_duplicate tensor(-0.0218, dtype=torch.float64) tensor(-0.4219, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0268, dtype=torch.float64) delta_t tensor(0.0200, dtype=torch.float64)
7 gae_duplicate tensor(-0.1166, dtype=torch.float64) tensor(-0.4493, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4301, dtype=torch.float64) delta_t tensor(0.2172, dtype=torch.float64)
6 gae_duplicate tensor(0.1588, dtype=torch.float64) tensor(-4.3259, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1489, dtype=torch.float64) delta_t tensor(0.3048, dtype=torch.float64)
5 gae_duplicate tensor(0.1438, dtype=torch.float64) tensor(-6.5778, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.5945, dtype=torch.float64) delta_t tensor(-1.3381, dtype=torch.float64)
4 gae_duplicate tensor(-4.1077, dtype=torch.float64) tensor(25.1061, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1577, dtype=torch.float64) delta_t tensor(0.0578, dtype=torch.float64)
3 gae_duplicate tensor(-0.3275, dtype=torch.float64) tensor(1.4220, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1649, dtype=torch.float64) delta_t tensor(0.1131, dtype=torch.float64)
2 gae_duplicate tensor(-0.2893, dtype=torch.float64) tensor(-2.0902, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:255.2061004638672
value loss:47.40889358520508
entropies:355.7269287109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.376713037490845 seconds
19 rew tensor(0.3432, dtype=torch.float64) delta_t tensor(0.0260, dtype=torch.float64)
19 gae_duplicate tensor(-0.0859, dtype=torch.float64) tensor(-0.5046, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4237, dtype=torch.float64) delta_t tensor(0.0622, dtype=torch.float64)
18 gae_duplicate tensor(-0.0233, dtype=torch.float64) tensor(-1.2859, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3425, dtype=torch.float64) delta_t tensor(0.0649, dtype=torch.float64)
17 gae_duplicate tensor(0.0150, dtype=torch.float64) tensor(-1.3887, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3953, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
16 gae_duplicate tensor(-0.0475, dtype=torch.float64) tensor(-1.2300, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1555, dtype=torch.float64) delta_t tensor(-0.0400, dtype=torch.float64)
15 gae_duplicate tensor(-0.8026, dtype=torch.float64) tensor(0.6575, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4173, dtype=torch.float64) delta_t tensor(0.1078, dtype=torch.float64)
14 gae_duplicate tensor(0.0227, dtype=torch.float64) tensor(-2.0570, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2940, dtype=torch.float64) delta_t tensor(0.1132, dtype=torch.float64)
13 gae_duplicate tensor(-0.0148, dtype=torch.float64) tensor(-2.4998, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4313, dtype=torch.float64) delta_t tensor(0.0477, dtype=torch.float64)
12 gae_duplicate tensor(-0.0150, dtype=torch.float64) tensor(-1.1689, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2943, dtype=torch.float64) delta_t tensor(0.0698, dtype=torch.float64)
11 gae_duplicate tensor(-0.0208, dtype=torch.float64) tensor(-1.5091, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4100, dtype=torch.float64) delta_t tensor(0.1111, dtype=torch.float64)
10 gae_duplicate tensor(0.0190, dtype=torch.float64) tensor(-2.3259, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2362, dtype=torch.float64) delta_t tensor(0.1319, dtype=torch.float64)
9 gae_duplicate tensor(0.0127, dtype=torch.float64) tensor(-2.8447, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3876, dtype=torch.float64) delta_t tensor(0.0866, dtype=torch.float64)
8 gae_duplicate tensor(0.0061, dtype=torch.float64) tensor(-1.9893, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2222, dtype=torch.float64) delta_t tensor(0.0732, dtype=torch.float64)
7 gae_duplicate tensor(-0.0363, dtype=torch.float64) tensor(-1.6573, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3001, dtype=torch.float64) delta_t tensor(0.2648, dtype=torch.float64)
6 gae_duplicate tensor(0.1683, dtype=torch.float64) tensor(-5.4643, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0019, dtype=torch.float64) delta_t tensor(0.3914, dtype=torch.float64)
5 gae_duplicate tensor(0.2454, dtype=torch.float64) tensor(-8.3824, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6413, dtype=torch.float64) delta_t tensor(-1.2968, dtype=torch.float64)
4 gae_duplicate tensor(-4.0557, dtype=torch.float64) tensor(24.3947, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0392, dtype=torch.float64) delta_t tensor(0.1058, dtype=torch.float64)
3 gae_duplicate tensor(-0.1757, dtype=torch.float64) tensor(0.3865, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2464, dtype=torch.float64) delta_t tensor(0.1180, dtype=torch.float64)
2 gae_duplicate tensor(-0.1604, dtype=torch.float64) tensor(-2.2650, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:505.21588134765625
value loss:38.53113555908203
entropies:355.6988220214844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.827299118041992 seconds
19 rew tensor(0.3954, dtype=torch.float64) delta_t tensor(0.0652, dtype=torch.float64)
19 gae_duplicate tensor(-0.0423, dtype=torch.float64) tensor(-1.2913, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4742, dtype=torch.float64) delta_t tensor(0.0212, dtype=torch.float64)
18 gae_duplicate tensor(-0.0923, dtype=torch.float64) tensor(-0.5563, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3162, dtype=torch.float64) delta_t tensor(0.1281, dtype=torch.float64)
17 gae_duplicate tensor(0.0097, dtype=torch.float64) tensor(-2.5686, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5606, dtype=torch.float64) delta_t tensor(0.0741, dtype=torch.float64)
16 gae_duplicate tensor(-0.0455, dtype=torch.float64) tensor(-1.7326, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2158, dtype=torch.float64) delta_t tensor(0.0727, dtype=torch.float64)
15 gae_duplicate tensor(0.0005, dtype=torch.float64) tensor(-1.6107, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5460, dtype=torch.float64) delta_t tensor(0.0960, dtype=torch.float64)
14 gae_duplicate tensor(-0.0703, dtype=torch.float64) tensor(-2.0604, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2014, dtype=torch.float64) delta_t tensor(0.0785, dtype=torch.float64)
13 gae_duplicate tensor(-0.0612, dtype=torch.float64) tensor(-1.7168, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5609, dtype=torch.float64) delta_t tensor(0.0717, dtype=torch.float64)
12 gae_duplicate tensor(-0.0450, dtype=torch.float64) tensor(-1.5536, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1942, dtype=torch.float64) delta_t tensor(0.0993, dtype=torch.float64)
11 gae_duplicate tensor(0.0206, dtype=torch.float64) tensor(-2.1612, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5469, dtype=torch.float64) delta_t tensor(0.1243, dtype=torch.float64)
10 gae_duplicate tensor(0.0477, dtype=torch.float64) tensor(-2.6525, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2434, dtype=torch.float64) delta_t tensor(-0.3409, dtype=torch.float64)
9 gae_duplicate tensor(-2.3174, dtype=torch.float64) tensor(6.6262, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0868, dtype=torch.float64) delta_t tensor(-0.2947, dtype=torch.float64)
8 gae_duplicate tensor(-2.0419, dtype=torch.float64) tensor(6.6106, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1078, dtype=torch.float64) delta_t tensor(0.0063, dtype=torch.float64)
7 gae_duplicate tensor(-0.1382, dtype=torch.float64) tensor(0.4989, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3210, dtype=torch.float64) delta_t tensor(0.2020, dtype=torch.float64)
6 gae_duplicate tensor(0.1456, dtype=torch.float64) tensor(-3.9261, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0177, dtype=torch.float64) delta_t tensor(0.3312, dtype=torch.float64)
5 gae_duplicate tensor(0.0300, dtype=torch.float64) tensor(-6.9278, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2718, dtype=torch.float64) delta_t tensor(0.4699, dtype=torch.float64)
4 gae_duplicate tensor(-3.3091, dtype=torch.float64) tensor(-9.8069, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0078, dtype=torch.float64) delta_t tensor(0.1035, dtype=torch.float64)
3 gae_duplicate tensor(-0.0649, dtype=torch.float64) tensor(-3.0299, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2406, dtype=torch.float64) delta_t tensor(0.0799, dtype=torch.float64)
2 gae_duplicate tensor(-0.2194, dtype=torch.float64) tensor(-1.9005, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1510.9674072265625
value loss:78.40541076660156
entropies:355.72845458984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.528117895126343 seconds
19 rew tensor(0.5038, dtype=torch.float64) delta_t tensor(0.0304, dtype=torch.float64)
19 gae_duplicate tensor(-0.1627, dtype=torch.float64) tensor(-0.6052, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5035, dtype=torch.float64) delta_t tensor(0.0538, dtype=torch.float64)
18 gae_duplicate tensor(-0.0485, dtype=torch.float64) tensor(-1.0891, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4662, dtype=torch.float64) delta_t tensor(0.0737, dtype=torch.float64)
17 gae_duplicate tensor(-0.1404, dtype=torch.float64) tensor(-1.5426, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4519, dtype=torch.float64) delta_t tensor(0.0474, dtype=torch.float64)
16 gae_duplicate tensor(-0.1678, dtype=torch.float64) tensor(-1.0770, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4296, dtype=torch.float64) delta_t tensor(0.1228, dtype=torch.float64)
15 gae_duplicate tensor(-0.0984, dtype=torch.float64) tensor(-2.5532, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4297, dtype=torch.float64) delta_t tensor(0.0601, dtype=torch.float64)
14 gae_duplicate tensor(-0.0506, dtype=torch.float64) tensor(-1.4223, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3254, dtype=torch.float64) delta_t tensor(0.0513, dtype=torch.float64)
13 gae_duplicate tensor(-0.0623, dtype=torch.float64) tensor(-1.2044, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4460, dtype=torch.float64) delta_t tensor(0.0339, dtype=torch.float64)
12 gae_duplicate tensor(-0.0392, dtype=torch.float64) tensor(-0.8121, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2727, dtype=torch.float64) delta_t tensor(0.0554, dtype=torch.float64)
11 gae_duplicate tensor(-0.0304, dtype=torch.float64) tensor(-1.1800, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4236, dtype=torch.float64) delta_t tensor(0.0905, dtype=torch.float64)
10 gae_duplicate tensor(-0.0345, dtype=torch.float64) tensor(-1.9285, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1176, dtype=torch.float64) delta_t tensor(-0.0720, dtype=torch.float64)
9 gae_duplicate tensor(-0.5816, dtype=torch.float64) tensor(1.2069, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7015, dtype=torch.float64) delta_t tensor(-1.0144, dtype=torch.float64)
8 gae_duplicate tensor(-6.1886, dtype=torch.float64) tensor(20.5438, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1947, dtype=torch.float64) delta_t tensor(0.0443, dtype=torch.float64)
7 gae_duplicate tensor(-0.1859, dtype=torch.float64) tensor(1.1139, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3513, dtype=torch.float64) delta_t tensor(-0.3878, dtype=torch.float64)
6 gae_duplicate tensor(-1.4604, dtype=torch.float64) tensor(7.9587, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4982, dtype=torch.float64) delta_t tensor(0.0911, dtype=torch.float64)
5 gae_duplicate tensor(-1.5085, dtype=torch.float64) tensor(-1.0535, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3515, dtype=torch.float64) delta_t tensor(-0.6978, dtype=torch.float64)
4 gae_duplicate tensor(-5.4526, dtype=torch.float64) tensor(14.3955, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0397, dtype=torch.float64) delta_t tensor(0.1522, dtype=torch.float64)
3 gae_duplicate tensor(-0.1893, dtype=torch.float64) tensor(-1.6170, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1617, dtype=torch.float64) delta_t tensor(0.0706, dtype=torch.float64)
2 gae_duplicate tensor(-0.2184, dtype=torch.float64) tensor(-1.5134, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1587.54296875
value loss:120.912109375
entropies:355.70086669921875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3954.6726)
ToM Target loss= tensor(3744.2727)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.036993026733398 seconds
19 rew tensor(0.4585, dtype=torch.float64) delta_t tensor(0.0659, dtype=torch.float64)
19 gae_duplicate tensor(-0.1428, dtype=torch.float64) tensor(-1.2844, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3666, dtype=torch.float64) delta_t tensor(-0.0190, dtype=torch.float64)
18 gae_duplicate tensor(-0.1179, dtype=torch.float64) tensor(0.2545, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3423, dtype=torch.float64) delta_t tensor(0.1224, dtype=torch.float64)
17 gae_duplicate tensor(-0.0704, dtype=torch.float64) tensor(-2.4363, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3890, dtype=torch.float64) delta_t tensor(-0.0169, dtype=torch.float64)
16 gae_duplicate tensor(-0.1413, dtype=torch.float64) tensor(0.0892, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2170, dtype=torch.float64) delta_t tensor(-0.0324, dtype=torch.float64)
15 gae_duplicate tensor(-0.0977, dtype=torch.float64) tensor(0.6333, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3903, dtype=torch.float64) delta_t tensor(-0.0297, dtype=torch.float64)
14 gae_duplicate tensor(-0.1909, dtype=torch.float64) tensor(0.6550, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2239, dtype=torch.float64) delta_t tensor(-0.0523, dtype=torch.float64)
13 gae_duplicate tensor(-0.1027, dtype=torch.float64) tensor(1.0880, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3977, dtype=torch.float64) delta_t tensor(-0.0620, dtype=torch.float64)
12 gae_duplicate tensor(-0.1506, dtype=torch.float64) tensor(1.3404, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2241, dtype=torch.float64) delta_t tensor(-0.0482, dtype=torch.float64)
11 gae_duplicate tensor(-0.2385, dtype=torch.float64) tensor(1.1180, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3763, dtype=torch.float64) delta_t tensor(0.0086, dtype=torch.float64)
10 gae_duplicate tensor(-0.0946, dtype=torch.float64) tensor(-0.0617, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1879, dtype=torch.float64) delta_t tensor(-0.0123, dtype=torch.float64)
9 gae_duplicate tensor(-0.1293, dtype=torch.float64) tensor(0.2270, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3539, dtype=torch.float64) delta_t tensor(-0.0477, dtype=torch.float64)
8 gae_duplicate tensor(-0.1404, dtype=torch.float64) tensor(0.9607, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1079, dtype=torch.float64) delta_t tensor(-0.0923, dtype=torch.float64)
7 gae_duplicate tensor(-0.2370, dtype=torch.float64) tensor(1.9020, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2008, dtype=torch.float64) delta_t tensor(0.1378, dtype=torch.float64)
6 gae_duplicate tensor(-0.2097, dtype=torch.float64) tensor(-2.5424, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4870, dtype=torch.float64) delta_t tensor(-0.1001, dtype=torch.float64)
5 gae_duplicate tensor(-1.9461, dtype=torch.float64) tensor(1.8139, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3220, dtype=torch.float64) delta_t tensor(-2.2445, dtype=torch.float64)
4 gae_duplicate tensor(-8.7994, dtype=torch.float64) tensor(45.5394, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1050, dtype=torch.float64) delta_t tensor(0.2298, dtype=torch.float64)
3 gae_duplicate tensor(-0.2112, dtype=torch.float64) tensor(-0.0874, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2810, dtype=torch.float64) delta_t tensor(0.0799, dtype=torch.float64)
2 gae_duplicate tensor(-0.2987, dtype=torch.float64) tensor(-1.4422, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2675.42724609375
value loss:143.9349822998047
entropies:355.611083984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.796389102935791 seconds
19 rew tensor(0.4788, dtype=torch.float64) delta_t tensor(0.0120, dtype=torch.float64)
19 gae_duplicate tensor(-0.2047, dtype=torch.float64) tensor(-0.2066, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5061, dtype=torch.float64) delta_t tensor(0.0554, dtype=torch.float64)
18 gae_duplicate tensor(-0.1746, dtype=torch.float64) tensor(-1.1466, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4128, dtype=torch.float64) delta_t tensor(0.1351, dtype=torch.float64)
17 gae_duplicate tensor(-0.1604, dtype=torch.float64) tensor(-2.7570, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5154, dtype=torch.float64) delta_t tensor(0.0346, dtype=torch.float64)
16 gae_duplicate tensor(-0.1215, dtype=torch.float64) tensor(-0.9958, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1572, dtype=torch.float64) delta_t tensor(0.0504, dtype=torch.float64)
15 gae_duplicate tensor(-0.2503, dtype=torch.float64) tensor(-1.0895, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5600, dtype=torch.float64) delta_t tensor(-0.0109, dtype=torch.float64)
14 gae_duplicate tensor(-0.1049, dtype=torch.float64) tensor(0.0958, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0474, dtype=torch.float64) delta_t tensor(0.0588, dtype=torch.float64)
13 gae_duplicate tensor(-0.0672, dtype=torch.float64) tensor(-1.1003, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5380, dtype=torch.float64) delta_t tensor(-0.0102, dtype=torch.float64)
12 gae_duplicate tensor(-0.1012, dtype=torch.float64) tensor(0.0937, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0549, dtype=torch.float64) delta_t tensor(0.0256, dtype=torch.float64)
11 gae_duplicate tensor(-0.0644, dtype=torch.float64) tensor(-0.4718, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5454, dtype=torch.float64) delta_t tensor(0.0274, dtype=torch.float64)
10 gae_duplicate tensor(-0.1202, dtype=torch.float64) tensor(-0.6022, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2480, dtype=torch.float64) delta_t tensor(-0.2842, dtype=torch.float64)
9 gae_duplicate tensor(-1.4034, dtype=torch.float64) tensor(5.3307, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6517, dtype=torch.float64) delta_t tensor(-1.1897, dtype=torch.float64)
8 gae_duplicate tensor(-6.6140, dtype=torch.float64) tensor(24.7315, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0444, dtype=torch.float64) delta_t tensor(-0.0482, dtype=torch.float64)
7 gae_duplicate tensor(-0.2501, dtype=torch.float64) tensor(3.3780, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4216, dtype=torch.float64) delta_t tensor(0.0802, dtype=torch.float64)
6 gae_duplicate tensor(-0.0598, dtype=torch.float64) tensor(-1.2229, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3187, dtype=torch.float64) delta_t tensor(0.1860, dtype=torch.float64)
5 gae_duplicate tensor(-0.7153, dtype=torch.float64) tensor(-3.8174, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4055, dtype=torch.float64) delta_t tensor(-0.2923, dtype=torch.float64)
4 gae_duplicate tensor(-2.3457, dtype=torch.float64) tensor(5.6359, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1455, dtype=torch.float64) delta_t tensor(0.0022, dtype=torch.float64)
3 gae_duplicate tensor(-0.3998, dtype=torch.float64) tensor(0.4401, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1174, dtype=torch.float64) delta_t tensor(0.0146, dtype=torch.float64)
2 gae_duplicate tensor(-0.2420, dtype=torch.float64) tensor(-0.2855, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1500.5185546875
value loss:84.43235778808594
entropies:355.44378662109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.12575888633728 seconds
19 rew tensor(0.3958, dtype=torch.float64) delta_t tensor(-0.0527, dtype=torch.float64)
19 gae_duplicate tensor(-0.3578, dtype=torch.float64) tensor(1.0221, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4917, dtype=torch.float64) delta_t tensor(-0.0387, dtype=torch.float64)
18 gae_duplicate tensor(-0.1777, dtype=torch.float64) tensor(0.8710, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3316, dtype=torch.float64) delta_t tensor(0.1772, dtype=torch.float64)
17 gae_duplicate tensor(0.0160, dtype=torch.float64) tensor(-3.3792, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5015, dtype=torch.float64) delta_t tensor(0.0274, dtype=torch.float64)
16 gae_duplicate tensor(-0.1354, dtype=torch.float64) tensor(-0.8953, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1709, dtype=torch.float64) delta_t tensor(0.1090, dtype=torch.float64)
15 gae_duplicate tensor(-0.0801, dtype=torch.float64) tensor(-2.2675, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5528, dtype=torch.float64) delta_t tensor(-0.0716, dtype=torch.float64)
14 gae_duplicate tensor(-0.1483, dtype=torch.float64) tensor(1.1708, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0059, dtype=torch.float64) delta_t tensor(-0.0557, dtype=torch.float64)
13 gae_duplicate tensor(-0.1374, dtype=torch.float64) tensor(1.2210, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5455, dtype=torch.float64) delta_t tensor(-0.0717, dtype=torch.float64)
12 gae_duplicate tensor(-0.1533, dtype=torch.float64) tensor(1.5301, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0127, dtype=torch.float64) delta_t tensor(-0.0244, dtype=torch.float64)
11 gae_duplicate tensor(-0.1866, dtype=torch.float64) tensor(0.6557, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5233, dtype=torch.float64) delta_t tensor(0.0254, dtype=torch.float64)
10 gae_duplicate tensor(-0.0388, dtype=torch.float64) tensor(-0.4509, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0271, dtype=torch.float64) delta_t tensor(-0.0148, dtype=torch.float64)
9 gae_duplicate tensor(-0.1599, dtype=torch.float64) tensor(0.1992, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4500, dtype=torch.float64) delta_t tensor(-0.0972, dtype=torch.float64)
8 gae_duplicate tensor(-0.1801, dtype=torch.float64) tensor(2.0562, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1080, dtype=torch.float64) delta_t tensor(-0.1299, dtype=torch.float64)
7 gae_duplicate tensor(-0.2711, dtype=torch.float64) tensor(2.7287, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4136, dtype=torch.float64) delta_t tensor(0.1459, dtype=torch.float64)
6 gae_duplicate tensor(0.0546, dtype=torch.float64) tensor(-2.5544, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3574, dtype=torch.float64) delta_t tensor(0.4459, dtype=torch.float64)
5 gae_duplicate tensor(-0.1655, dtype=torch.float64) tensor(-9.2805, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9969, dtype=torch.float64) delta_t tensor(-1.0872, dtype=torch.float64)
4 gae_duplicate tensor(-3.5741, dtype=torch.float64) tensor(20.7169, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0154, dtype=torch.float64) delta_t tensor(0.1323, dtype=torch.float64)
3 gae_duplicate tensor(-0.2681, dtype=torch.float64) tensor(-0.6245, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1618, dtype=torch.float64) delta_t tensor(0.2179, dtype=torch.float64)
2 gae_duplicate tensor(-0.1536, dtype=torch.float64) tensor(-4.2707, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-552.1220092773438
value loss:54.78571701049805
entropies:355.1678466796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0544822216033936 seconds
19 rew tensor(0.5037, dtype=torch.float64) delta_t tensor(-0.0125, dtype=torch.float64)
19 gae_duplicate tensor(-0.1235, dtype=torch.float64) tensor(0.2751, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3893, dtype=torch.float64) delta_t tensor(-0.0657, dtype=torch.float64)
18 gae_duplicate tensor(-0.1829, dtype=torch.float64) tensor(1.3643, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4398, dtype=torch.float64) delta_t tensor(0.1905, dtype=torch.float64)
17 gae_duplicate tensor(-0.0732, dtype=torch.float64) tensor(-3.8048, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4177, dtype=torch.float64) delta_t tensor(-0.0044, dtype=torch.float64)
16 gae_duplicate tensor(-0.1082, dtype=torch.float64) tensor(-0.2570, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0283, dtype=torch.float64) delta_t tensor(-0.1114, dtype=torch.float64)
15 gae_duplicate tensor(-0.8360, dtype=torch.float64) tensor(1.9581, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4450, dtype=torch.float64) delta_t tensor(-0.0563, dtype=torch.float64)
14 gae_duplicate tensor(-0.1368, dtype=torch.float64) tensor(1.3050, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1493, dtype=torch.float64) delta_t tensor(-0.0337, dtype=torch.float64)
13 gae_duplicate tensor(-0.1879, dtype=torch.float64) tensor(0.7833, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4527, dtype=torch.float64) delta_t tensor(-0.0764, dtype=torch.float64)
12 gae_duplicate tensor(-0.1436, dtype=torch.float64) tensor(1.5996, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1423, dtype=torch.float64) delta_t tensor(-0.0295, dtype=torch.float64)
11 gae_duplicate tensor(-0.1261, dtype=torch.float64) tensor(0.7201, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4014, dtype=torch.float64) delta_t tensor(0.0016, dtype=torch.float64)
10 gae_duplicate tensor(-0.1027, dtype=torch.float64) tensor(0.0446, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0919, dtype=torch.float64) delta_t tensor(0.0058, dtype=torch.float64)
9 gae_duplicate tensor(-0.2139, dtype=torch.float64) tensor(-0.1426, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3943, dtype=torch.float64) delta_t tensor(-0.0220, dtype=torch.float64)
8 gae_duplicate tensor(-0.1454, dtype=torch.float64) tensor(0.4737, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0333, dtype=torch.float64) delta_t tensor(-0.1047, dtype=torch.float64)
7 gae_duplicate tensor(-0.3297, dtype=torch.float64) tensor(2.0573, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1930, dtype=torch.float64) delta_t tensor(0.0430, dtype=torch.float64)
6 gae_duplicate tensor(-0.5475, dtype=torch.float64) tensor(-0.6799, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4835, dtype=torch.float64) delta_t tensor(-0.0534, dtype=torch.float64)
5 gae_duplicate tensor(-1.5556, dtype=torch.float64) tensor(1.0820, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6193, dtype=torch.float64) delta_t tensor(-0.3935, dtype=torch.float64)
4 gae_duplicate tensor(-3.4820, dtype=torch.float64) tensor(8.0846, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0718, dtype=torch.float64) delta_t tensor(0.0089, dtype=torch.float64)
3 gae_duplicate tensor(-0.2796, dtype=torch.float64) tensor(0.5522, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2682, dtype=torch.float64) delta_t tensor(0.0992, dtype=torch.float64)
2 gae_duplicate tensor(-0.1371, dtype=torch.float64) tensor(-1.8182, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-830.0785522460938
value loss:34.140445709228516
entropies:354.8674011230469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.982630252838135 seconds
19 rew tensor(3.6167e-05, dtype=torch.float64) delta_t tensor(-0.2169, dtype=torch.float64)
19 gae_duplicate tensor(-0.7262, dtype=torch.float64) tensor(4.0290, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4340, dtype=torch.float64) delta_t tensor(-0.0316, dtype=torch.float64)
18 gae_duplicate tensor(-0.1352, dtype=torch.float64) tensor(1.0387, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2200, dtype=torch.float64) delta_t tensor(0.1680, dtype=torch.float64)
17 gae_duplicate tensor(-0.0269, dtype=torch.float64) tensor(-3.1432, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5443, dtype=torch.float64) delta_t tensor(-0.0168, dtype=torch.float64)
16 gae_duplicate tensor(-0.1130, dtype=torch.float64) tensor(0.0469, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0039, dtype=torch.float64) delta_t tensor(-0.0272, dtype=torch.float64)
15 gae_duplicate tensor(-0.2507, dtype=torch.float64) tensor(0.5060, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5524, dtype=torch.float64) delta_t tensor(-0.0274, dtype=torch.float64)
14 gae_duplicate tensor(-0.0606, dtype=torch.float64) tensor(0.5940, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0037, dtype=torch.float64) delta_t tensor(-0.0290, dtype=torch.float64)
13 gae_duplicate tensor(-0.2541, dtype=torch.float64) tensor(0.6942, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5313, dtype=torch.float64) delta_t tensor(-0.0196, dtype=torch.float64)
12 gae_duplicate tensor(-0.1056, dtype=torch.float64) tensor(0.4810, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0325, dtype=torch.float64) delta_t tensor(0.0444, dtype=torch.float64)
11 gae_duplicate tensor(-0.0477, dtype=torch.float64) tensor(-0.8590, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5369, dtype=torch.float64) delta_t tensor(0.0123, dtype=torch.float64)
10 gae_duplicate tensor(-0.0443, dtype=torch.float64) tensor(-0.2986, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0171, dtype=torch.float64) delta_t tensor(-0.0099, dtype=torch.float64)
9 gae_duplicate tensor(-0.1176, dtype=torch.float64) tensor(0.1483, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5087, dtype=torch.float64) delta_t tensor(-0.0722, dtype=torch.float64)
8 gae_duplicate tensor(-0.1296, dtype=torch.float64) tensor(1.4416, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0468, dtype=torch.float64) delta_t tensor(-0.0701, dtype=torch.float64)
7 gae_duplicate tensor(-0.1184, dtype=torch.float64) tensor(1.5142, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4211, dtype=torch.float64) delta_t tensor(0.1070, dtype=torch.float64)
6 gae_duplicate tensor(0.0589, dtype=torch.float64) tensor(-1.9361, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2218, dtype=torch.float64) delta_t tensor(0.1998, dtype=torch.float64)
5 gae_duplicate tensor(-0.1975, dtype=torch.float64) tensor(-3.7811, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.2595, dtype=torch.float64) delta_t tensor(-1.6043, dtype=torch.float64)
4 gae_duplicate tensor(-3.4560, dtype=torch.float64) tensor(31.5925, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1683, dtype=torch.float64) delta_t tensor(0.0081, dtype=torch.float64)
3 gae_duplicate tensor(-0.5009, dtype=torch.float64) tensor(2.9090, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1837, dtype=torch.float64) delta_t tensor(0.1268, dtype=torch.float64)
2 gae_duplicate tensor(-0.0221, dtype=torch.float64) tensor(-2.1507, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1868.38134765625
value loss:62.57366180419922
entropies:354.57537841796875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3955.7419)
ToM Target loss= tensor(3759.7476)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.765190362930298 seconds
19 rew tensor(0.4519, dtype=torch.float64) delta_t tensor(0.1331, dtype=torch.float64)
19 gae_duplicate tensor(-0.0214, dtype=torch.float64) tensor(-2.5474, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5032, dtype=torch.float64) delta_t tensor(0.1166, dtype=torch.float64)
18 gae_duplicate tensor(-0.2031, dtype=torch.float64) tensor(-2.5239, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4374, dtype=torch.float64) delta_t tensor(0.1941, dtype=torch.float64)
17 gae_duplicate tensor(-0.0176, dtype=torch.float64) tensor(-4.0107, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5071, dtype=torch.float64) delta_t tensor(0.0734, dtype=torch.float64)
16 gae_duplicate tensor(-0.0800, dtype=torch.float64) tensor(-1.8080, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1925, dtype=torch.float64) delta_t tensor(0.0936, dtype=torch.float64)
15 gae_duplicate tensor(-0.1992, dtype=torch.float64) tensor(-2.0416, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4920, dtype=torch.float64) delta_t tensor(0.0396, dtype=torch.float64)
14 gae_duplicate tensor(-0.1936, dtype=torch.float64) tensor(-0.8552, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1946, dtype=torch.float64) delta_t tensor(0.0991, dtype=torch.float64)
13 gae_duplicate tensor(-0.2030, dtype=torch.float64) tensor(-2.1890, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4728, dtype=torch.float64) delta_t tensor(0.1013, dtype=torch.float64)
12 gae_duplicate tensor(-0.0750, dtype=torch.float64) tensor(-2.1744, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1877, dtype=torch.float64) delta_t tensor(0.0495, dtype=torch.float64)
11 gae_duplicate tensor(-0.0770, dtype=torch.float64) tensor(-1.1753, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4382, dtype=torch.float64) delta_t tensor(0.0762, dtype=torch.float64)
10 gae_duplicate tensor(-0.0914, dtype=torch.float64) tensor(-1.5528, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1513, dtype=torch.float64) delta_t tensor(-0.2288, dtype=torch.float64)
9 gae_duplicate tensor(-1.4120, dtype=torch.float64) tensor(4.1327, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4170, dtype=torch.float64) delta_t tensor(-0.6592, dtype=torch.float64)
8 gae_duplicate tensor(-4.2226, dtype=torch.float64) tensor(12.8764, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0698, dtype=torch.float64) delta_t tensor(0.1598, dtype=torch.float64)
7 gae_duplicate tensor(-0.0604, dtype=torch.float64) tensor(-1.7719, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2943, dtype=torch.float64) delta_t tensor(0.2054, dtype=torch.float64)
6 gae_duplicate tensor(0.1037, dtype=torch.float64) tensor(-4.2121, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2178, dtype=torch.float64) delta_t tensor(0.2383, dtype=torch.float64)
5 gae_duplicate tensor(0.1561, dtype=torch.float64) tensor(-5.1028, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2026, dtype=torch.float64) delta_t tensor(0.2353, dtype=torch.float64)
4 gae_duplicate tensor(-1.7934, dtype=torch.float64) tensor(-5.7842, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1548, dtype=torch.float64) delta_t tensor(-0.0731, dtype=torch.float64)
3 gae_duplicate tensor(-0.2674, dtype=torch.float64) tensor(0.9876, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2955, dtype=torch.float64) delta_t tensor(0.0626, dtype=torch.float64)
2 gae_duplicate tensor(-0.2444, dtype=torch.float64) tensor(-0.8744, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1018.2365112304688
value loss:48.76133346557617
entropies:354.1476135253906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.990010023117065 seconds
19 rew tensor(0.3934, dtype=torch.float64) delta_t tensor(0.1044, dtype=torch.float64)
19 gae_duplicate tensor(-0.0377, dtype=torch.float64) tensor(-1.9206, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4311, dtype=torch.float64) delta_t tensor(0.0225, dtype=torch.float64)
18 gae_duplicate tensor(-0.0758, dtype=torch.float64) tensor(-0.7019, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2867, dtype=torch.float64) delta_t tensor(0.2035, dtype=torch.float64)
17 gae_duplicate tensor(0.0234, dtype=torch.float64) tensor(-3.9683, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5379, dtype=torch.float64) delta_t tensor(0.0333, dtype=torch.float64)
16 gae_duplicate tensor(-0.0597, dtype=torch.float64) tensor(-1.0683, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0936, dtype=torch.float64) delta_t tensor(0.0988, dtype=torch.float64)
15 gae_duplicate tensor(0.0157, dtype=torch.float64) tensor(-2.1522, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5445, dtype=torch.float64) delta_t tensor(0.0427, dtype=torch.float64)
14 gae_duplicate tensor(0.0018, dtype=torch.float64) tensor(-1.0268, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1019, dtype=torch.float64) delta_t tensor(0.0972, dtype=torch.float64)
13 gae_duplicate tensor(-0.0739, dtype=torch.float64) tensor(-2.1368, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5457, dtype=torch.float64) delta_t tensor(0.0501, dtype=torch.float64)
12 gae_duplicate tensor(-0.0493, dtype=torch.float64) tensor(-1.2025, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0954, dtype=torch.float64) delta_t tensor(0.0806, dtype=torch.float64)
11 gae_duplicate tensor(-0.0350, dtype=torch.float64) tensor(-1.7796, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5300, dtype=torch.float64) delta_t tensor(0.0973, dtype=torch.float64)
10 gae_duplicate tensor(0.0007, dtype=torch.float64) tensor(-2.1169, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0728, dtype=torch.float64) delta_t tensor(0.0409, dtype=torch.float64)
9 gae_duplicate tensor(-0.0115, dtype=torch.float64) tensor(-1.0481, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5090, dtype=torch.float64) delta_t tensor(0.0188, dtype=torch.float64)
8 gae_duplicate tensor(-0.0785, dtype=torch.float64) tensor(-0.4896, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0587, dtype=torch.float64) delta_t tensor(0.0370, dtype=torch.float64)
7 gae_duplicate tensor(0.0124, dtype=torch.float64) tensor(-0.8034, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4142, dtype=torch.float64) delta_t tensor(0.2159, dtype=torch.float64)
6 gae_duplicate tensor(0.1243, dtype=torch.float64) tensor(-4.1760, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1381, dtype=torch.float64) delta_t tensor(0.3589, dtype=torch.float64)
5 gae_duplicate tensor(0.1588, dtype=torch.float64) tensor(-7.6729, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.1775, dtype=torch.float64) delta_t tensor(-1.0503, dtype=torch.float64)
4 gae_duplicate tensor(-5.2597, dtype=torch.float64) tensor(18.7738, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1358, dtype=torch.float64) delta_t tensor(0.1307, dtype=torch.float64)
3 gae_duplicate tensor(-0.2472, dtype=torch.float64) tensor(-0.5919, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1941, dtype=torch.float64) delta_t tensor(0.3828, dtype=torch.float64)
2 gae_duplicate tensor(0.1890, dtype=torch.float64) tensor(-7.6849, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1079.8726806640625
value loss:99.40750122070312
entropies:353.8612976074219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.812903165817261 seconds
19 rew tensor(0.4547, dtype=torch.float64) delta_t tensor(0.0514, dtype=torch.float64)
19 gae_duplicate tensor(-0.0411, dtype=torch.float64) tensor(-1.0338, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3353, dtype=torch.float64) delta_t tensor(0.0739, dtype=torch.float64)
18 gae_duplicate tensor(-0.0901, dtype=torch.float64) tensor(-1.5355, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4048, dtype=torch.float64) delta_t tensor(0.0940, dtype=torch.float64)
17 gae_duplicate tensor(-0.0803, dtype=torch.float64) tensor(-1.8805, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3924, dtype=torch.float64) delta_t tensor(0.1090, dtype=torch.float64)
16 gae_duplicate tensor(0.0357, dtype=torch.float64) tensor(-2.3444, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2569, dtype=torch.float64) delta_t tensor(0.0290, dtype=torch.float64)
15 gae_duplicate tensor(-0.0794, dtype=torch.float64) tensor(-0.7498, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3855, dtype=torch.float64) delta_t tensor(0.0610, dtype=torch.float64)
14 gae_duplicate tensor(0.0002, dtype=torch.float64) tensor(-1.3087, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2730, dtype=torch.float64) delta_t tensor(0.0632, dtype=torch.float64)
13 gae_duplicate tensor(-0.1009, dtype=torch.float64) tensor(-1.3775, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3859, dtype=torch.float64) delta_t tensor(0.0647, dtype=torch.float64)
12 gae_duplicate tensor(-0.0327, dtype=torch.float64) tensor(-1.4371, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2731, dtype=torch.float64) delta_t tensor(0.0551, dtype=torch.float64)
11 gae_duplicate tensor(-0.0023, dtype=torch.float64) tensor(-1.2255, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3856, dtype=torch.float64) delta_t tensor(0.0368, dtype=torch.float64)
10 gae_duplicate tensor(-0.0053, dtype=torch.float64) tensor(-0.8667, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0989, dtype=torch.float64) delta_t tensor(-0.0579, dtype=torch.float64)
9 gae_duplicate tensor(-0.7126, dtype=torch.float64) tensor(1.1394, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3489, dtype=torch.float64) delta_t tensor(0.0490, dtype=torch.float64)
8 gae_duplicate tensor(-0.0330, dtype=torch.float64) tensor(-0.8449, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2366, dtype=torch.float64) delta_t tensor(0.0681, dtype=torch.float64)
7 gae_duplicate tensor(0.0150, dtype=torch.float64) tensor(-1.3740, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2612, dtype=torch.float64) delta_t tensor(0.2746, dtype=torch.float64)
6 gae_duplicate tensor(0.1471, dtype=torch.float64) tensor(-5.2722, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(5.3155e-05, dtype=torch.float64) delta_t tensor(0.2824, dtype=torch.float64)
5 gae_duplicate tensor(0.1817, dtype=torch.float64) tensor(-6.1675, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2751, dtype=torch.float64) delta_t tensor(-0.4952, dtype=torch.float64)
4 gae_duplicate tensor(-2.1093, dtype=torch.float64) tensor(8.3257, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0699, dtype=torch.float64) delta_t tensor(0.1991, dtype=torch.float64)
3 gae_duplicate tensor(-0.0356, dtype=torch.float64) tensor(-3.0547, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3291, dtype=torch.float64) delta_t tensor(0.2471, dtype=torch.float64)
2 gae_duplicate tensor(0.0719, dtype=torch.float64) tensor(-5.1631, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1317.701904296875
value loss:19.903499603271484
entropies:353.764892578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0608179569244385 seconds
19 rew tensor(0.3524, dtype=torch.float64) delta_t tensor(0.0125, dtype=torch.float64)
19 gae_duplicate tensor(-0.0541, dtype=torch.float64) tensor(-0.2676, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4457, dtype=torch.float64) delta_t tensor(0.0117, dtype=torch.float64)
18 gae_duplicate tensor(-0.0710, dtype=torch.float64) tensor(-0.2903, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3159, dtype=torch.float64) delta_t tensor(0.1744, dtype=torch.float64)
17 gae_duplicate tensor(0.0114, dtype=torch.float64) tensor(-3.5242, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4708, dtype=torch.float64) delta_t tensor(0.0617, dtype=torch.float64)
16 gae_duplicate tensor(0.0069, dtype=torch.float64) tensor(-1.5416, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1582, dtype=torch.float64) delta_t tensor(0.1056, dtype=torch.float64)
15 gae_duplicate tensor(0.0332, dtype=torch.float64) tensor(-2.1632, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5169, dtype=torch.float64) delta_t tensor(-0.0213, dtype=torch.float64)
14 gae_duplicate tensor(-0.0439, dtype=torch.float64) tensor(0.1975, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1343, dtype=torch.float64) delta_t tensor(0.0428, dtype=torch.float64)
13 gae_duplicate tensor(-0.0054, dtype=torch.float64) tensor(-0.8202, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5170, dtype=torch.float64) delta_t tensor(0.0015, dtype=torch.float64)
12 gae_duplicate tensor(-0.0694, dtype=torch.float64) tensor(-0.1174, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1202, dtype=torch.float64) delta_t tensor(0.0718, dtype=torch.float64)
11 gae_duplicate tensor(-0.0778, dtype=torch.float64) tensor(-1.4241, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4884, dtype=torch.float64) delta_t tensor(0.0697, dtype=torch.float64)
10 gae_duplicate tensor(-0.0095, dtype=torch.float64) tensor(-1.5002, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1121, dtype=torch.float64) delta_t tensor(0.0680, dtype=torch.float64)
9 gae_duplicate tensor(0.0159, dtype=torch.float64) tensor(-1.5225, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4734, dtype=torch.float64) delta_t tensor(0.0151, dtype=torch.float64)
8 gae_duplicate tensor(-0.0548, dtype=torch.float64) tensor(-0.5017, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0911, dtype=torch.float64) delta_t tensor(-0.0075, dtype=torch.float64)
7 gae_duplicate tensor(-0.1356, dtype=torch.float64) tensor(0.0924, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3132, dtype=torch.float64) delta_t tensor(0.1907, dtype=torch.float64)
6 gae_duplicate tensor(0.0139, dtype=torch.float64) tensor(-3.7030, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2064, dtype=torch.float64) delta_t tensor(0.1996, dtype=torch.float64)
5 gae_duplicate tensor(-0.7679, dtype=torch.float64) tensor(-4.3241, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.5837, dtype=torch.float64) delta_t tensor(-1.4065, dtype=torch.float64)
4 gae_duplicate tensor(-7.1691, dtype=torch.float64) tensor(27.3025, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0600, dtype=torch.float64) delta_t tensor(0.1617, dtype=torch.float64)
3 gae_duplicate tensor(-0.3636, dtype=torch.float64) tensor(-0.5124, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1867, dtype=torch.float64) delta_t tensor(0.2624, dtype=torch.float64)
2 gae_duplicate tensor(0.0174, dtype=torch.float64) tensor(-5.0713, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-112.19094848632812
value loss:102.26376342773438
entropies:353.8028564453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.101324081420898 seconds
19 rew tensor(0.4592, dtype=torch.float64) delta_t tensor(0.0194, dtype=torch.float64)
19 gae_duplicate tensor(-0.1280, dtype=torch.float64) tensor(-0.4137, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4702, dtype=torch.float64) delta_t tensor(0.0441, dtype=torch.float64)
18 gae_duplicate tensor(-0.1037, dtype=torch.float64) tensor(-0.8592, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3938, dtype=torch.float64) delta_t tensor(0.0717, dtype=torch.float64)
17 gae_duplicate tensor(0.0514, dtype=torch.float64) tensor(-1.4826, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4566, dtype=torch.float64) delta_t tensor(-0.0086, dtype=torch.float64)
16 gae_duplicate tensor(-0.0881, dtype=torch.float64) tensor(0.0074, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3272, dtype=torch.float64) delta_t tensor(0.0872, dtype=torch.float64)
15 gae_duplicate tensor(-0.0727, dtype=torch.float64) tensor(-1.7376, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4995, dtype=torch.float64) delta_t tensor(0.0278, dtype=torch.float64)
14 gae_duplicate tensor(-0.0741, dtype=torch.float64) tensor(-0.7113, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2420, dtype=torch.float64) delta_t tensor(0.0133, dtype=torch.float64)
13 gae_duplicate tensor(-0.0974, dtype=torch.float64) tensor(-0.3552, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4755, dtype=torch.float64) delta_t tensor(-0.0067, dtype=torch.float64)
12 gae_duplicate tensor(-0.0737, dtype=torch.float64) tensor(0.1016, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2113, dtype=torch.float64) delta_t tensor(0.0864, dtype=torch.float64)
11 gae_duplicate tensor(-0.0484, dtype=torch.float64) tensor(-1.6232, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4216, dtype=torch.float64) delta_t tensor(0.0411, dtype=torch.float64)
10 gae_duplicate tensor(-0.0737, dtype=torch.float64) tensor(-0.9751, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1243, dtype=torch.float64) delta_t tensor(0.0926, dtype=torch.float64)
9 gae_duplicate tensor(0.0204, dtype=torch.float64) tensor(-1.8596, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4559, dtype=torch.float64) delta_t tensor(-0.0026, dtype=torch.float64)
8 gae_duplicate tensor(-0.0487, dtype=torch.float64) tensor(-0.1391, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0527, dtype=torch.float64) delta_t tensor(-0.0504, dtype=torch.float64)
7 gae_duplicate tensor(-0.1287, dtype=torch.float64) tensor(0.9682, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3339, dtype=torch.float64) delta_t tensor(0.1868, dtype=torch.float64)
6 gae_duplicate tensor(0.0989, dtype=torch.float64) tensor(-3.7015, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2094, dtype=torch.float64) delta_t tensor(0.4890, dtype=torch.float64)
5 gae_duplicate tensor(0.1143, dtype=torch.float64) tensor(-9.9754, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.8202, dtype=torch.float64) delta_t tensor(0.4472, dtype=torch.float64)
4 gae_duplicate tensor(-0.3288, dtype=torch.float64) tensor(-9.4798, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0260, dtype=torch.float64) delta_t tensor(0.3171, dtype=torch.float64)
3 gae_duplicate tensor(-0.0235, dtype=torch.float64) tensor(-7.6400, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1393, dtype=torch.float64) delta_t tensor(0.4464, dtype=torch.float64)
2 gae_duplicate tensor(0.1121, dtype=torch.float64) tensor(-9.4711, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2569.210205078125
value loss:21.387493133544922
entropies:353.8255310058594
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3954.7581)
ToM Target loss= tensor(3776.8535)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.011852741241455 seconds
19 rew tensor(0.4867, dtype=torch.float64) delta_t tensor(-0.0523, dtype=torch.float64)
19 gae_duplicate tensor(-0.1821, dtype=torch.float64) tensor(0.9872, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2951, dtype=torch.float64) delta_t tensor(-0.0057, dtype=torch.float64)
18 gae_duplicate tensor(-0.1070, dtype=torch.float64) tensor(0.3060, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4557, dtype=torch.float64) delta_t tensor(-0.0194, dtype=torch.float64)
17 gae_duplicate tensor(-0.1657, dtype=torch.float64) tensor(0.4128, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3198, dtype=torch.float64) delta_t tensor(0.0043, dtype=torch.float64)
16 gae_duplicate tensor(-0.0929, dtype=torch.float64) tensor(-0.0339, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3798, dtype=torch.float64) delta_t tensor(-0.0473, dtype=torch.float64)
15 gae_duplicate tensor(-0.1883, dtype=torch.float64) tensor(0.9974, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3262, dtype=torch.float64) delta_t tensor(-0.0194, dtype=torch.float64)
14 gae_duplicate tensor(-0.1647, dtype=torch.float64) tensor(0.4291, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3941, dtype=torch.float64) delta_t tensor(-0.0201, dtype=torch.float64)
13 gae_duplicate tensor(-0.1349, dtype=torch.float64) tensor(0.4712, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3344, dtype=torch.float64) delta_t tensor(0.0002, dtype=torch.float64)
12 gae_duplicate tensor(-0.1220, dtype=torch.float64) tensor(0.0009, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3943, dtype=torch.float64) delta_t tensor(0.0187, dtype=torch.float64)
11 gae_duplicate tensor(-0.1283, dtype=torch.float64) tensor(-0.3428, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2725, dtype=torch.float64) delta_t tensor(0.0513, dtype=torch.float64)
10 gae_duplicate tensor(-0.1331, dtype=torch.float64) tensor(-1.0723, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0139, dtype=torch.float64) delta_t tensor(-0.2761, dtype=torch.float64)
9 gae_duplicate tensor(-1.5851, dtype=torch.float64) tensor(4.8391, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4456, dtype=torch.float64) delta_t tensor(-0.7547, dtype=torch.float64)
8 gae_duplicate tensor(-4.2552, dtype=torch.float64) tensor(14.8913, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2082, dtype=torch.float64) delta_t tensor(-0.4971, dtype=torch.float64)
7 gae_duplicate tensor(-2.7738, dtype=torch.float64) tensor(11.5463, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1813, dtype=torch.float64) delta_t tensor(0.1402, dtype=torch.float64)
6 gae_duplicate tensor(-0.0278, dtype=torch.float64) tensor(-1.6409, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0227, dtype=torch.float64) delta_t tensor(0.3837, dtype=torch.float64)
5 gae_duplicate tensor(0.1014, dtype=torch.float64) tensor(-7.4815, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4985, dtype=torch.float64) delta_t tensor(-0.9364, dtype=torch.float64)
4 gae_duplicate tensor(-3.9421, dtype=torch.float64) tensor(16.8459, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0428, dtype=torch.float64) delta_t tensor(0.2366, dtype=torch.float64)
3 gae_duplicate tensor(-0.2475, dtype=torch.float64) tensor(-2.9260, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3557, dtype=torch.float64) delta_t tensor(0.0924, dtype=torch.float64)
2 gae_duplicate tensor(-0.2781, dtype=torch.float64) tensor(-1.9970, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2052.12060546875
value loss:93.7083969116211
entropies:353.8881530761719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.257371187210083 seconds
19 rew tensor(0.5441, dtype=torch.float64) delta_t tensor(-0.0604, dtype=torch.float64)
19 gae_duplicate tensor(-0.1863, dtype=torch.float64) tensor(1.1779, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4421, dtype=torch.float64) delta_t tensor(-0.0722, dtype=torch.float64)
18 gae_duplicate tensor(-0.2158, dtype=torch.float64) tensor(1.5990, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4148, dtype=torch.float64) delta_t tensor(0.0945, dtype=torch.float64)
17 gae_duplicate tensor(-0.0181, dtype=torch.float64) tensor(-1.6473, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4975, dtype=torch.float64) delta_t tensor(-0.0529, dtype=torch.float64)
16 gae_duplicate tensor(-0.2311, dtype=torch.float64) tensor(0.9092, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2610, dtype=torch.float64) delta_t tensor(0.0613, dtype=torch.float64)
15 gae_duplicate tensor(-0.1102, dtype=torch.float64) tensor(-1.1697, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5445, dtype=torch.float64) delta_t tensor(-0.0184, dtype=torch.float64)
14 gae_duplicate tensor(-0.1674, dtype=torch.float64) tensor(0.2233, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1589, dtype=torch.float64) delta_t tensor(-0.0205, dtype=torch.float64)
13 gae_duplicate tensor(-0.1583, dtype=torch.float64) tensor(0.2937, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5391, dtype=torch.float64) delta_t tensor(-0.0383, dtype=torch.float64)
12 gae_duplicate tensor(-0.1812, dtype=torch.float64) tensor(0.7618, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1315, dtype=torch.float64) delta_t tensor(0.0719, dtype=torch.float64)
11 gae_duplicate tensor(-0.0683, dtype=torch.float64) tensor(-1.3641, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4873, dtype=torch.float64) delta_t tensor(0.0083, dtype=torch.float64)
10 gae_duplicate tensor(-0.1145, dtype=torch.float64) tensor(-0.2822, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2589, dtype=torch.float64) delta_t tensor(-0.3037, dtype=torch.float64)
9 gae_duplicate tensor(-1.6675, dtype=torch.float64) tensor(5.6934, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4224, dtype=torch.float64) delta_t tensor(-0.9583, dtype=torch.float64)
8 gae_duplicate tensor(-5.3502, dtype=torch.float64) tensor(21.2015, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2234, dtype=torch.float64) delta_t tensor(-0.2401, dtype=torch.float64)
7 gae_duplicate tensor(-1.0786, dtype=torch.float64) tensor(6.5784, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3228, dtype=torch.float64) delta_t tensor(0.0581, dtype=torch.float64)
6 gae_duplicate tensor(-0.0672, dtype=torch.float64) tensor(-0.4746, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4108, dtype=torch.float64) delta_t tensor(0.5025, dtype=torch.float64)
5 gae_duplicate tensor(0.0412, dtype=torch.float64) tensor(-10.4119, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4353, dtype=torch.float64) delta_t tensor(-1.1666, dtype=torch.float64)
4 gae_duplicate tensor(-4.0324, dtype=torch.float64) tensor(21.9269, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0911, dtype=torch.float64) delta_t tensor(0.2694, dtype=torch.float64)
3 gae_duplicate tensor(-0.0260, dtype=torch.float64) tensor(-3.0188, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0988, dtype=torch.float64) delta_t tensor(0.1826, dtype=torch.float64)
2 gae_duplicate tensor(-0.2921, dtype=torch.float64) tensor(-3.7933, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2158.580810546875
value loss:92.88998413085938
entropies:354.1029357910156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.373003959655762 seconds
19 rew tensor(0.3642, dtype=torch.float64) delta_t tensor(-0.1343, dtype=torch.float64)
19 gae_duplicate tensor(-0.3039, dtype=torch.float64) tensor(2.7490, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5137, dtype=torch.float64) delta_t tensor(-0.0659, dtype=torch.float64)
18 gae_duplicate tensor(-0.2310, dtype=torch.float64) tensor(1.6237, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2889, dtype=torch.float64) delta_t tensor(-0.0606, dtype=torch.float64)
17 gae_duplicate tensor(-0.2186, dtype=torch.float64) tensor(1.3590, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5209, dtype=torch.float64) delta_t tensor(-0.0675, dtype=torch.float64)
16 gae_duplicate tensor(-0.1829, dtype=torch.float64) tensor(1.5209, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1591, dtype=torch.float64) delta_t tensor(-0.0713, dtype=torch.float64)
15 gae_duplicate tensor(-0.1787, dtype=torch.float64) tensor(1.5153, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5444, dtype=torch.float64) delta_t tensor(-0.0604, dtype=torch.float64)
14 gae_duplicate tensor(-0.1833, dtype=torch.float64) tensor(1.3625, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0697, dtype=torch.float64) delta_t tensor(-0.1643, dtype=torch.float64)
13 gae_duplicate tensor(-0.2853, dtype=torch.float64) tensor(3.2247, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5364, dtype=torch.float64) delta_t tensor(-0.0580, dtype=torch.float64)
12 gae_duplicate tensor(-0.1684, dtype=torch.float64) tensor(1.5048, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0403, dtype=torch.float64) delta_t tensor(-0.0844, dtype=torch.float64)
11 gae_duplicate tensor(-0.2596, dtype=torch.float64) tensor(1.7940, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5305, dtype=torch.float64) delta_t tensor(-0.0727, dtype=torch.float64)
10 gae_duplicate tensor(-0.1519, dtype=torch.float64) tensor(1.6705, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0559, dtype=torch.float64) delta_t tensor(-0.0747, dtype=torch.float64)
9 gae_duplicate tensor(-0.1716, dtype=torch.float64) tensor(1.6184, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4628, dtype=torch.float64) delta_t tensor(-0.1393, dtype=torch.float64)
8 gae_duplicate tensor(-0.2588, dtype=torch.float64) tensor(2.9186, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0185, dtype=torch.float64) delta_t tensor(-0.1506, dtype=torch.float64)
7 gae_duplicate tensor(-0.2611, dtype=torch.float64) tensor(3.2220, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4351, dtype=torch.float64) delta_t tensor(0.0894, dtype=torch.float64)
6 gae_duplicate tensor(-0.0246, dtype=torch.float64) tensor(-1.5023, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2382, dtype=torch.float64) delta_t tensor(0.3689, dtype=torch.float64)
5 gae_duplicate tensor(-0.0051, dtype=torch.float64) tensor(-7.6292, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3839, dtype=torch.float64) delta_t tensor(0.1007, dtype=torch.float64)
4 gae_duplicate tensor(-4.1055, dtype=torch.float64) tensor(-3.8891, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0117, dtype=torch.float64) delta_t tensor(0.5951, dtype=torch.float64)
3 gae_duplicate tensor(0.0993, dtype=torch.float64) tensor(-12.1601, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2066, dtype=torch.float64) delta_t tensor(0.0535, dtype=torch.float64)
2 gae_duplicate tensor(-0.2977, dtype=torch.float64) tensor(-2.0678, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-32.70628356933594
value loss:82.13088989257812
entropies:354.13677978515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.058684825897217 seconds
19 rew tensor(0.4839, dtype=torch.float64) delta_t tensor(-0.1550, dtype=torch.float64)
19 gae_duplicate tensor(-0.2149, dtype=torch.float64) tensor(2.9750, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3463, dtype=torch.float64) delta_t tensor(-0.1366, dtype=torch.float64)
18 gae_duplicate tensor(-0.2584, dtype=torch.float64) tensor(3.0933, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3725, dtype=torch.float64) delta_t tensor(-0.0016, dtype=torch.float64)
17 gae_duplicate tensor(-0.1397, dtype=torch.float64) tensor(0.3423, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4506, dtype=torch.float64) delta_t tensor(-0.1086, dtype=torch.float64)
16 gae_duplicate tensor(-0.1959, dtype=torch.float64) tensor(2.1182, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0952, dtype=torch.float64) delta_t tensor(-0.3737, dtype=torch.float64)
15 gae_duplicate tensor(-1.8870, dtype=torch.float64) tensor(7.0370, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4431, dtype=torch.float64) delta_t tensor(-0.0759, dtype=torch.float64)
14 gae_duplicate tensor(-0.2391, dtype=torch.float64) tensor(2.2431, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2086, dtype=torch.float64) delta_t tensor(-0.0652, dtype=torch.float64)
13 gae_duplicate tensor(-0.1980, dtype=torch.float64) tensor(1.4775, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4659, dtype=torch.float64) delta_t tensor(-0.0624, dtype=torch.float64)
12 gae_duplicate tensor(-0.0904, dtype=torch.float64) tensor(1.4021, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2020, dtype=torch.float64) delta_t tensor(-0.1010, dtype=torch.float64)
11 gae_duplicate tensor(-0.1593, dtype=torch.float64) tensor(2.1967, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4585, dtype=torch.float64) delta_t tensor(-0.1135, dtype=torch.float64)
10 gae_duplicate tensor(-0.1957, dtype=torch.float64) tensor(2.5717, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1721, dtype=torch.float64) delta_t tensor(-0.0706, dtype=torch.float64)
9 gae_duplicate tensor(-0.1655, dtype=torch.float64) tensor(1.7016, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4224, dtype=torch.float64) delta_t tensor(-0.0714, dtype=torch.float64)
8 gae_duplicate tensor(-0.1977, dtype=torch.float64) tensor(1.6022, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1654, dtype=torch.float64) delta_t tensor(-0.1494, dtype=torch.float64)
7 gae_duplicate tensor(-0.2474, dtype=torch.float64) tensor(3.1920, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3060, dtype=torch.float64) delta_t tensor(0.1232, dtype=torch.float64)
6 gae_duplicate tensor(-0.0012, dtype=torch.float64) tensor(-2.1006, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4038, dtype=torch.float64) delta_t tensor(-0.0087, dtype=torch.float64)
5 gae_duplicate tensor(-0.9607, dtype=torch.float64) tensor(-0.1300, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0401, dtype=torch.float64) delta_t tensor(-1.0385, dtype=torch.float64)
4 gae_duplicate tensor(-3.6868, dtype=torch.float64) tensor(20.1320, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0511, dtype=torch.float64) delta_t tensor(0.3011, dtype=torch.float64)
3 gae_duplicate tensor(-0.3776, dtype=torch.float64) tensor(-3.9378, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3077, dtype=torch.float64) delta_t tensor(0.0796, dtype=torch.float64)
2 gae_duplicate tensor(-0.2143, dtype=torch.float64) tensor(-1.9997, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2467.153564453125
value loss:47.04525375366211
entropies:354.31378173828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.861691236495972 seconds
19 rew tensor(0.4785, dtype=torch.float64) delta_t tensor(-0.0868, dtype=torch.float64)
19 gae_duplicate tensor(-0.1699, dtype=torch.float64) tensor(1.7270, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4058, dtype=torch.float64) delta_t tensor(-0.0261, dtype=torch.float64)
18 gae_duplicate tensor(-0.0986, dtype=torch.float64) tensor(0.6468, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4708, dtype=torch.float64) delta_t tensor(0.0070, dtype=torch.float64)
17 gae_duplicate tensor(-0.0760, dtype=torch.float64) tensor(-0.0313, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4345, dtype=torch.float64) delta_t tensor(-0.0413, dtype=torch.float64)
16 gae_duplicate tensor(-0.1273, dtype=torch.float64) tensor(0.7943, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3677, dtype=torch.float64) delta_t tensor(-0.0413, dtype=torch.float64)
15 gae_duplicate tensor(-0.1624, dtype=torch.float64) tensor(0.9135, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4198, dtype=torch.float64) delta_t tensor(-0.0489, dtype=torch.float64)
14 gae_duplicate tensor(-0.1098, dtype=torch.float64) tensor(1.0849, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3554, dtype=torch.float64) delta_t tensor(-0.0162, dtype=torch.float64)
13 gae_duplicate tensor(-0.2013, dtype=torch.float64) tensor(0.4032, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4279, dtype=torch.float64) delta_t tensor(-0.0873, dtype=torch.float64)
12 gae_duplicate tensor(-0.1984, dtype=torch.float64) tensor(1.7696, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3280, dtype=torch.float64) delta_t tensor(-0.0559, dtype=torch.float64)
11 gae_duplicate tensor(-0.1578, dtype=torch.float64) tensor(1.2497, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4143, dtype=torch.float64) delta_t tensor(-0.0800, dtype=torch.float64)
10 gae_duplicate tensor(-0.1555, dtype=torch.float64) tensor(1.6642, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2845, dtype=torch.float64) delta_t tensor(-0.0408, dtype=torch.float64)
9 gae_duplicate tensor(-0.1474, dtype=torch.float64) tensor(0.9647, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3279, dtype=torch.float64) delta_t tensor(-0.0457, dtype=torch.float64)
8 gae_duplicate tensor(-0.1520, dtype=torch.float64) tensor(0.9703, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2204, dtype=torch.float64) delta_t tensor(-0.0861, dtype=torch.float64)
7 gae_duplicate tensor(-0.2012, dtype=torch.float64) tensor(1.8772, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1549, dtype=torch.float64) delta_t tensor(0.1714, dtype=torch.float64)
6 gae_duplicate tensor(0.0666, dtype=torch.float64) tensor(-3.3122, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3456, dtype=torch.float64) delta_t tensor(0.1019, dtype=torch.float64)
5 gae_duplicate tensor(-0.7119, dtype=torch.float64) tensor(-2.1457, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.0965, dtype=torch.float64) delta_t tensor(-1.5241, dtype=torch.float64)
4 gae_duplicate tensor(-8.6551, dtype=torch.float64) tensor(31.0099, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0669, dtype=torch.float64) delta_t tensor(0.2720, dtype=torch.float64)
3 gae_duplicate tensor(-0.1308, dtype=torch.float64) tensor(-2.4804, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2828, dtype=torch.float64) delta_t tensor(0.1244, dtype=torch.float64)
2 gae_duplicate tensor(-0.3489, dtype=torch.float64) tensor(-2.4482, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1967.2578125
value loss:147.5880126953125
entropies:354.6045837402344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3951.5823)
ToM Target loss= tensor(3803.3398)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.0824902057647705 seconds
19 rew tensor(0.4153, dtype=torch.float64) delta_t tensor(-0.0156, dtype=torch.float64)
19 gae_duplicate tensor(-0.1810, dtype=torch.float64) tensor(0.2992, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4803, dtype=torch.float64) delta_t tensor(0.0740, dtype=torch.float64)
18 gae_duplicate tensor(-0.2038, dtype=torch.float64) tensor(-1.4913, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3865, dtype=torch.float64) delta_t tensor(0.1671, dtype=torch.float64)
17 gae_duplicate tensor(-0.1414, dtype=torch.float64) tensor(-3.5203, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5646, dtype=torch.float64) delta_t tensor(0.0194, dtype=torch.float64)
16 gae_duplicate tensor(-0.0891, dtype=torch.float64) tensor(-0.5979, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1095, dtype=torch.float64) delta_t tensor(-0.0290, dtype=torch.float64)
15 gae_duplicate tensor(-0.2416, dtype=torch.float64) tensor(0.5042, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5574, dtype=torch.float64) delta_t tensor(-0.0028, dtype=torch.float64)
14 gae_duplicate tensor(-0.0627, dtype=torch.float64) tensor(0.1333, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0035, dtype=torch.float64) delta_t tensor(-0.0648, dtype=torch.float64)
13 gae_duplicate tensor(-0.2522, dtype=torch.float64) tensor(1.2925, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5292, dtype=torch.float64) delta_t tensor(-0.0227, dtype=torch.float64)
12 gae_duplicate tensor(-0.0795, dtype=torch.float64) tensor(0.5702, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0529, dtype=torch.float64) delta_t tensor(-0.0243, dtype=torch.float64)
11 gae_duplicate tensor(-0.1121, dtype=torch.float64) tensor(0.5421, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5276, dtype=torch.float64) delta_t tensor(-0.0182, dtype=torch.float64)
10 gae_duplicate tensor(-0.1516, dtype=torch.float64) tensor(0.4576, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0468, dtype=torch.float64) delta_t tensor(-0.0812, dtype=torch.float64)
9 gae_duplicate tensor(-0.1679, dtype=torch.float64) tensor(1.6784, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5066, dtype=torch.float64) delta_t tensor(-0.0772, dtype=torch.float64)
8 gae_duplicate tensor(-0.1374, dtype=torch.float64) tensor(1.6618, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0824, dtype=torch.float64) delta_t tensor(-0.1442, dtype=torch.float64)
7 gae_duplicate tensor(-0.3979, dtype=torch.float64) tensor(3.0985, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3914, dtype=torch.float64) delta_t tensor(0.1009, dtype=torch.float64)
6 gae_duplicate tensor(0.0268, dtype=torch.float64) tensor(-1.7323, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2994, dtype=torch.float64) delta_t tensor(0.2267, dtype=torch.float64)
5 gae_duplicate tensor(0.0595, dtype=torch.float64) tensor(-4.5803, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.4767, dtype=torch.float64) delta_t tensor(-1.4640, dtype=torch.float64)
4 gae_duplicate tensor(-6.3835, dtype=torch.float64) tensor(29.3253, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1648, dtype=torch.float64) delta_t tensor(0.3744, dtype=torch.float64)
3 gae_duplicate tensor(-0.2063, dtype=torch.float64) tensor(-4.4175, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1786, dtype=torch.float64) delta_t tensor(0.3750, dtype=torch.float64)
2 gae_duplicate tensor(-0.3289, dtype=torch.float64) tensor(-7.8383, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-926.576416015625
value loss:89.31169128417969
entropies:354.71673583984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.381900787353516 seconds
19 rew tensor(0.4849, dtype=torch.float64) delta_t tensor(-0.0043, dtype=torch.float64)
19 gae_duplicate tensor(-0.1364, dtype=torch.float64) tensor(0.0652, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3306, dtype=torch.float64) delta_t tensor(-0.0123, dtype=torch.float64)
18 gae_duplicate tensor(-0.1632, dtype=torch.float64) tensor(0.2595, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3711, dtype=torch.float64) delta_t tensor(0.1194, dtype=torch.float64)
17 gae_duplicate tensor(-0.0590, dtype=torch.float64) tensor(-2.1910, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4653, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
16 gae_duplicate tensor(-0.0463, dtype=torch.float64) tensor(-0.7013, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1255, dtype=torch.float64) delta_t tensor(-0.0268, dtype=torch.float64)
15 gae_duplicate tensor(-0.0829, dtype=torch.float64) tensor(0.4611, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4575, dtype=torch.float64) delta_t tensor(0.0166, dtype=torch.float64)
14 gae_duplicate tensor(-0.1163, dtype=torch.float64) tensor(-0.2634, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1318, dtype=torch.float64) delta_t tensor(-0.0108, dtype=torch.float64)
13 gae_duplicate tensor(-0.2070, dtype=torch.float64) tensor(0.1771, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4655, dtype=torch.float64) delta_t tensor(-0.0014, dtype=torch.float64)
12 gae_duplicate tensor(-0.0764, dtype=torch.float64) tensor(0.0274, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1181, dtype=torch.float64) delta_t tensor(-0.0106, dtype=torch.float64)
11 gae_duplicate tensor(-0.0759, dtype=torch.float64) tensor(0.2048, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4366, dtype=torch.float64) delta_t tensor(0.0026, dtype=torch.float64)
10 gae_duplicate tensor(-0.1262, dtype=torch.float64) tensor(0.0068, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0193, dtype=torch.float64) delta_t tensor(-0.1591, dtype=torch.float64)
9 gae_duplicate tensor(-0.7145, dtype=torch.float64) tensor(2.9565, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4219, dtype=torch.float64) delta_t tensor(0.0016, dtype=torch.float64)
8 gae_duplicate tensor(-0.0740, dtype=torch.float64) tensor(0.2812, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0965, dtype=torch.float64) delta_t tensor(-0.0507, dtype=torch.float64)
7 gae_duplicate tensor(-0.1530, dtype=torch.float64) tensor(1.0399, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3348, dtype=torch.float64) delta_t tensor(0.1971, dtype=torch.float64)
6 gae_duplicate tensor(0.0942, dtype=torch.float64) tensor(-3.7886, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1490, dtype=torch.float64) delta_t tensor(0.3569, dtype=torch.float64)
5 gae_duplicate tensor(0.0906, dtype=torch.float64) tensor(-7.5690, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5896, dtype=torch.float64) delta_t tensor(-1.1439, dtype=torch.float64)
4 gae_duplicate tensor(-3.6390, dtype=torch.float64) tensor(21.9760, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0331, dtype=torch.float64) delta_t tensor(0.3234, dtype=torch.float64)
3 gae_duplicate tensor(-0.2988, dtype=torch.float64) tensor(-4.2615, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2601, dtype=torch.float64) delta_t tensor(0.2684, dtype=torch.float64)
2 gae_duplicate tensor(0.1321, dtype=torch.float64) tensor(-5.5486, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-264.9017639160156
value loss:33.605228424072266
entropies:354.6839599609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.740941047668457 seconds
19 rew tensor(0.4454, dtype=torch.float64) delta_t tensor(0.0527, dtype=torch.float64)
19 gae_duplicate tensor(-0.0256, dtype=torch.float64) tensor(-1.1084, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4697, dtype=torch.float64) delta_t tensor(0.0206, dtype=torch.float64)
18 gae_duplicate tensor(-0.1035, dtype=torch.float64) tensor(-0.5067, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3726, dtype=torch.float64) delta_t tensor(0.0757, dtype=torch.float64)
17 gae_duplicate tensor(-0.0317, dtype=torch.float64) tensor(-1.6157, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5132, dtype=torch.float64) delta_t tensor(0.0474, dtype=torch.float64)
16 gae_duplicate tensor(-0.0404, dtype=torch.float64) tensor(-1.1114, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1663, dtype=torch.float64) delta_t tensor(0.0539, dtype=torch.float64)
15 gae_duplicate tensor(-0.0228, dtype=torch.float64) tensor(-1.2026, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5345, dtype=torch.float64) delta_t tensor(0.1016, dtype=torch.float64)
14 gae_duplicate tensor(-0.0105, dtype=torch.float64) tensor(-2.1690, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1364, dtype=torch.float64) delta_t tensor(0.0535, dtype=torch.float64)
13 gae_duplicate tensor(-0.0836, dtype=torch.float64) tensor(-1.1850, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5225, dtype=torch.float64) delta_t tensor(0.0547, dtype=torch.float64)
12 gae_duplicate tensor(-0.0153, dtype=torch.float64) tensor(-1.1907, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1165, dtype=torch.float64) delta_t tensor(0.0698, dtype=torch.float64)
11 gae_duplicate tensor(-0.0246, dtype=torch.float64) tensor(-1.4671, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5429, dtype=torch.float64) delta_t tensor(0.0116, dtype=torch.float64)
10 gae_duplicate tensor(-0.0602, dtype=torch.float64) tensor(-0.3755, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1024, dtype=torch.float64) delta_t tensor(0.0457, dtype=torch.float64)
9 gae_duplicate tensor(-0.0394, dtype=torch.float64) tensor(-0.9512, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4456, dtype=torch.float64) delta_t tensor(-0.0373, dtype=torch.float64)
8 gae_duplicate tensor(-0.1339, dtype=torch.float64) tensor(0.6144, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0128, dtype=torch.float64) delta_t tensor(-0.0036, dtype=torch.float64)
7 gae_duplicate tensor(-0.0898, dtype=torch.float64) tensor(0.1528, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4262, dtype=torch.float64) delta_t tensor(0.1893, dtype=torch.float64)
6 gae_duplicate tensor(0.1075, dtype=torch.float64) tensor(-3.6387, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2222, dtype=torch.float64) delta_t tensor(0.3866, dtype=torch.float64)
5 gae_duplicate tensor(-0.0056, dtype=torch.float64) tensor(-7.8843, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4819, dtype=torch.float64) delta_t tensor(0.2395, dtype=torch.float64)
4 gae_duplicate tensor(-2.6157, dtype=torch.float64) tensor(-6.1795, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1952, dtype=torch.float64) delta_t tensor(0.4178, dtype=torch.float64)
3 gae_duplicate tensor(-0.1401, dtype=torch.float64) tensor(-9.2148, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1952, dtype=torch.float64) delta_t tensor(0.1003, dtype=torch.float64)
2 gae_duplicate tensor(-0.2138, dtype=torch.float64) tensor(-2.6523, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2155.27783203125
value loss:42.58767318725586
entropies:354.6293029785156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.016621828079224 seconds
19 rew tensor(0.4458, dtype=torch.float64) delta_t tensor(0.0412, dtype=torch.float64)
19 gae_duplicate tensor(-0.0601, dtype=torch.float64) tensor(-0.8211, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3579, dtype=torch.float64) delta_t tensor(0.0302, dtype=torch.float64)
18 gae_duplicate tensor(-0.0801, dtype=torch.float64) tensor(-0.6782, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4229, dtype=torch.float64) delta_t tensor(0.1431, dtype=torch.float64)
17 gae_duplicate tensor(-0.0485, dtype=torch.float64) tensor(-2.8402, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3665, dtype=torch.float64) delta_t tensor(0.0311, dtype=torch.float64)
16 gae_duplicate tensor(-0.0253, dtype=torch.float64) tensor(-0.9300, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3073, dtype=torch.float64) delta_t tensor(0.0486, dtype=torch.float64)
15 gae_duplicate tensor(-0.0490, dtype=torch.float64) tensor(-1.0312, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3605, dtype=torch.float64) delta_t tensor(0.0203, dtype=torch.float64)
14 gae_duplicate tensor(-0.0376, dtype=torch.float64) tensor(-0.4963, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3360, dtype=torch.float64) delta_t tensor(0.0516, dtype=torch.float64)
13 gae_duplicate tensor(-0.0412, dtype=torch.float64) tensor(-1.0504, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3820, dtype=torch.float64) delta_t tensor(0.0256, dtype=torch.float64)
12 gae_duplicate tensor(-0.0232, dtype=torch.float64) tensor(-0.5826, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3362, dtype=torch.float64) delta_t tensor(0.0276, dtype=torch.float64)
11 gae_duplicate tensor(-0.0197, dtype=torch.float64) tensor(-0.6226, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3605, dtype=torch.float64) delta_t tensor(0.0211, dtype=torch.float64)
10 gae_duplicate tensor(-0.0344, dtype=torch.float64) tensor(-0.5207, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0015, dtype=torch.float64) delta_t tensor(-0.2331, dtype=torch.float64)
9 gae_duplicate tensor(-1.6345, dtype=torch.float64) tensor(4.7884, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3385, dtype=torch.float64) delta_t tensor(0.0554, dtype=torch.float64)
8 gae_duplicate tensor(-0.0212, dtype=torch.float64) tensor(-0.6331, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2927, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
7 gae_duplicate tensor(-0.0672, dtype=torch.float64) tensor(-0.6142, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2375, dtype=torch.float64) delta_t tensor(0.2610, dtype=torch.float64)
6 gae_duplicate tensor(0.1561, dtype=torch.float64) tensor(-5.0515, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0386, dtype=torch.float64) delta_t tensor(0.2759, dtype=torch.float64)
5 gae_duplicate tensor(0.1206, dtype=torch.float64) tensor(-5.9317, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7315, dtype=torch.float64) delta_t tensor(-1.3381, dtype=torch.float64)
4 gae_duplicate tensor(-2.6968, dtype=torch.float64) tensor(26.0202, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0258, dtype=torch.float64) delta_t tensor(0.2323, dtype=torch.float64)
3 gae_duplicate tensor(-0.1752, dtype=torch.float64) tensor(-2.0296, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3531, dtype=torch.float64) delta_t tensor(0.2732, dtype=torch.float64)
2 gae_duplicate tensor(0.1069, dtype=torch.float64) tensor(-5.5151, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-174.61585998535156
value loss:30.159013748168945
entropies:354.70623779296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.126267194747925 seconds
19 rew tensor(0.5017, dtype=torch.float64) delta_t tensor(0.1366, dtype=torch.float64)
19 gae_duplicate tensor(-0.0474, dtype=torch.float64) tensor(-2.7087, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4790, dtype=torch.float64) delta_t tensor(0.1037, dtype=torch.float64)
18 gae_duplicate tensor(-0.0337, dtype=torch.float64) tensor(-2.3629, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4225, dtype=torch.float64) delta_t tensor(0.1527, dtype=torch.float64)
17 gae_duplicate tensor(0.0215, dtype=torch.float64) tensor(-3.1413, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4655, dtype=torch.float64) delta_t tensor(0.0447, dtype=torch.float64)
16 gae_duplicate tensor(-0.0590, dtype=torch.float64) tensor(-1.1708, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1982, dtype=torch.float64) delta_t tensor(0.0662, dtype=torch.float64)
15 gae_duplicate tensor(-0.0729, dtype=torch.float64) tensor(-1.4506, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5020, dtype=torch.float64) delta_t tensor(0.0140, dtype=torch.float64)
14 gae_duplicate tensor(-0.0702, dtype=torch.float64) tensor(-0.3954, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1768, dtype=torch.float64) delta_t tensor(0.0159, dtype=torch.float64)
13 gae_duplicate tensor(-0.1107, dtype=torch.float64) tensor(-0.3223, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4814, dtype=torch.float64) delta_t tensor(0.0196, dtype=torch.float64)
12 gae_duplicate tensor(-0.0413, dtype=torch.float64) tensor(-0.4165, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1556, dtype=torch.float64) delta_t tensor(0.0948, dtype=torch.float64)
11 gae_duplicate tensor(-0.0047, dtype=torch.float64) tensor(-1.9108, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4723, dtype=torch.float64) delta_t tensor(0.0338, dtype=torch.float64)
10 gae_duplicate tensor(-0.0348, dtype=torch.float64) tensor(-0.8807, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1427, dtype=torch.float64) delta_t tensor(0.0658, dtype=torch.float64)
9 gae_duplicate tensor(-0.0397, dtype=torch.float64) tensor(-1.3544, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4016, dtype=torch.float64) delta_t tensor(0.0108, dtype=torch.float64)
8 gae_duplicate tensor(-0.0531, dtype=torch.float64) tensor(-0.3074, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0491, dtype=torch.float64) delta_t tensor(-0.0268, dtype=torch.float64)
7 gae_duplicate tensor(-0.1926, dtype=torch.float64) tensor(0.5677, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3635, dtype=torch.float64) delta_t tensor(0.2662, dtype=torch.float64)
6 gae_duplicate tensor(0.1295, dtype=torch.float64) tensor(-5.3043, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5129, dtype=torch.float64) delta_t tensor(0.0396, dtype=torch.float64)
5 gae_duplicate tensor(-1.5752, dtype=torch.float64) tensor(-1.1819, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.3974, dtype=torch.float64) delta_t tensor(-0.7881, dtype=torch.float64)
4 gae_duplicate tensor(-2.4665, dtype=torch.float64) tensor(16.3801, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1440, dtype=torch.float64) delta_t tensor(-0.0342, dtype=torch.float64)
3 gae_duplicate tensor(-0.5296, dtype=torch.float64) tensor(2.3425, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2205, dtype=torch.float64) delta_t tensor(0.0635, dtype=torch.float64)
2 gae_duplicate tensor(-0.5448, dtype=torch.float64) tensor(-1.0869, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:158.29470825195312
value loss:29.17009735107422
entropies:354.6468200683594
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3952.2017)
ToM Target loss= tensor(3832.2122)
optimized based on ToM loss
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt