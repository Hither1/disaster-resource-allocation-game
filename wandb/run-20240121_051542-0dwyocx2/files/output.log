obs <crafter.objects.Shelter object at 0x13cf1a880> [39.  0.  0.  0. 39.  0.  0.  0.  8.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x11acfbe80> [36.  0.  0.  0. 40.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x13cf22fa0> [ 9.  0.  0.  0.  9.  0.  0.  0. 12.  0.  0.  0.]
obs <crafter.objects.Shelter object at 0x13cf1a880> [39.  0.  0.  0. 39.  0.  0.  0. 10.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x11acfbe80> [41.  0.  0.  0. 41.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x13cf22fa0> [ 9.  0.  0.  0.  9.  0.  0.  0. 15.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.003200054168701172 seconds
19 rew tensor(0.6911, dtype=torch.float64) delta_t tensor(0.6483, dtype=torch.float64)
19 gae_duplicate tensor(0.3059, dtype=torch.float64) tensor(-12.7889, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3828, dtype=torch.float64) delta_t tensor(0.3531, dtype=torch.float64)
18 gae_duplicate tensor(0.1554, dtype=torch.float64) tensor(-8.2504, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6730, dtype=torch.float64) delta_t tensor(0.7137, dtype=torch.float64)
17 gae_duplicate tensor(0.4628, dtype=torch.float64) tensor(-14.9548, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4661, dtype=torch.float64) delta_t tensor(0.4863, dtype=torch.float64)
16 gae_duplicate tensor(0.1390, dtype=torch.float64) tensor(-11.1697, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4748, dtype=torch.float64) delta_t tensor(0.4872, dtype=torch.float64)
15 gae_duplicate tensor(0.2050, dtype=torch.float64) tensor(-10.7763, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5023, dtype=torch.float64) delta_t tensor(0.4704, dtype=torch.float64)
14 gae_duplicate tensor(0.1746, dtype=torch.float64) tensor(-10.3263, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5263, dtype=torch.float64) delta_t tensor(0.5200, dtype=torch.float64)
13 gae_duplicate tensor(0.0916, dtype=torch.float64) tensor(-11.2124, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5505, dtype=torch.float64) delta_t tensor(0.5708, dtype=torch.float64)
12 gae_duplicate tensor(0.4790, dtype=torch.float64) tensor(-12.3962, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5723, dtype=torch.float64) delta_t tensor(0.4945, dtype=torch.float64)
11 gae_duplicate tensor(0.1259, dtype=torch.float64) tensor(-10.9474, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6315, dtype=torch.float64) delta_t tensor(0.6061, dtype=torch.float64)
10 gae_duplicate tensor(0.4987, dtype=torch.float64) tensor(-13.0082, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6389, dtype=torch.float64) delta_t tensor(0.5570, dtype=torch.float64)
9 gae_duplicate tensor(0.2310, dtype=torch.float64) tensor(-12.4042, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6733, dtype=torch.float64) delta_t tensor(0.6783, dtype=torch.float64)
8 gae_duplicate tensor(0.4357, dtype=torch.float64) tensor(-14.5726, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7545, dtype=torch.float64) delta_t tensor(0.6326, dtype=torch.float64)
7 gae_duplicate tensor(0.2084, dtype=torch.float64) tensor(-14.1010, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7503, dtype=torch.float64) delta_t tensor(0.6782, dtype=torch.float64)
6 gae_duplicate tensor(0.4701, dtype=torch.float64) tensor(-14.7733, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.6979, dtype=torch.float64) delta_t tensor(0.5953, dtype=torch.float64)
5 gae_duplicate tensor(0.2754, dtype=torch.float64) tensor(-13.0749, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2373, dtype=torch.float64) delta_t tensor(-1.3597, dtype=torch.float64)
4 gae_duplicate tensor(-1.9844, dtype=torch.float64) tensor(25.5515, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.0000, dtype=torch.float64) delta_t tensor(0.8136, dtype=torch.float64)
3 gae_duplicate tensor(-0.5090, dtype=torch.float64) tensor(-13.5974, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0., dtype=torch.float64) delta_t tensor(-0.0154, dtype=torch.float64)
2 gae_duplicate tensor(-0.0141, dtype=torch.float64) tensor(-1.0477, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:9291.828125
value loss:105.33277893066406
entropies:355.81964111328125
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 5.4807140827178955 seconds
19 rew tensor(0.3861, dtype=torch.float64) delta_t tensor(0.1709, dtype=torch.float64)
19 gae_duplicate tensor(-0.0855, dtype=torch.float64) tensor(-3.3267, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4510, dtype=torch.float64) delta_t tensor(0.2860, dtype=torch.float64)
18 gae_duplicate tensor(0.2437, dtype=torch.float64) tensor(-6.0638, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3408, dtype=torch.float64) delta_t tensor(0.1574, dtype=torch.float64)
17 gae_duplicate tensor(-0.0824, dtype=torch.float64) tensor(-3.6713, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5057, dtype=torch.float64) delta_t tensor(0.3417, dtype=torch.float64)
16 gae_duplicate tensor(0.0527, dtype=torch.float64) tensor(-7.1628, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2118, dtype=torch.float64) delta_t tensor(-0.0029, dtype=torch.float64)
15 gae_duplicate tensor(-0.1173, dtype=torch.float64) tensor(-0.5929, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5331, dtype=torch.float64) delta_t tensor(0.3416, dtype=torch.float64)
14 gae_duplicate tensor(0.1763, dtype=torch.float64) tensor(-6.8960, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2054, dtype=torch.float64) delta_t tensor(-0.0100, dtype=torch.float64)
13 gae_duplicate tensor(-0.1860, dtype=torch.float64) tensor(-0.5211, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5412, dtype=torch.float64) delta_t tensor(0.3191, dtype=torch.float64)
12 gae_duplicate tensor(0.0723, dtype=torch.float64) tensor(-6.4441, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1928, dtype=torch.float64) delta_t tensor(-0.0323, dtype=torch.float64)
11 gae_duplicate tensor(-0.2417, dtype=torch.float64) tensor(0.0922, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5512, dtype=torch.float64) delta_t tensor(0.3704, dtype=torch.float64)
10 gae_duplicate tensor(0.1818, dtype=torch.float64) tensor(-7.3319, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2148, dtype=torch.float64) delta_t tensor(-0.0610, dtype=torch.float64)
9 gae_duplicate tensor(-0.3625, dtype=torch.float64) tensor(0.4595, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5362, dtype=torch.float64) delta_t tensor(0.4094, dtype=torch.float64)
8 gae_duplicate tensor(0.2210, dtype=torch.float64) tensor(-7.9013, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2106, dtype=torch.float64) delta_t tensor(-0.0309, dtype=torch.float64)
7 gae_duplicate tensor(-0.2593, dtype=torch.float64) tensor(-0.2020, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4031, dtype=torch.float64) delta_t tensor(0.1348, dtype=torch.float64)
6 gae_duplicate tensor(-0.4184, dtype=torch.float64) tensor(-2.7276, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0369, dtype=torch.float64) delta_t tensor(-0.3551, dtype=torch.float64)
5 gae_duplicate tensor(-0.7423, dtype=torch.float64) tensor(6.8365, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4665, dtype=torch.float64) delta_t tensor(-3.7660, dtype=torch.float64)
4 gae_duplicate tensor(-4.9725, dtype=torch.float64) tensor(75.9805, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1030, dtype=torch.float64) delta_t tensor(-0.3728, dtype=torch.float64)
3 gae_duplicate tensor(-1.3576, dtype=torch.float64) tensor(15.2812, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2394, dtype=torch.float64) delta_t tensor(-0.3729, dtype=torch.float64)
2 gae_duplicate tensor(-0.9733, dtype=torch.float64) tensor(8.8471, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3047.36767578125
value loss:158.33641052246094
entropies:355.4561462402344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.081212997436523 seconds
19 rew tensor(0.4016, dtype=torch.float64) delta_t tensor(0.1031, dtype=torch.float64)
19 gae_duplicate tensor(-0.1960, dtype=torch.float64) tensor(-1.8913, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3824, dtype=torch.float64) delta_t tensor(0.0757, dtype=torch.float64)
18 gae_duplicate tensor(-0.0253, dtype=torch.float64) tensor(-1.7939, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3411, dtype=torch.float64) delta_t tensor(0.0735, dtype=torch.float64)
17 gae_duplicate tensor(-0.0849, dtype=torch.float64) tensor(-1.5468, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4449, dtype=torch.float64) delta_t tensor(0.1559, dtype=torch.float64)
16 gae_duplicate tensor(-0.1036, dtype=torch.float64) tensor(-3.2360, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2069, dtype=torch.float64) delta_t tensor(-0.1588, dtype=torch.float64)
15 gae_duplicate tensor(-0.4562, dtype=torch.float64) tensor(2.6634, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4717, dtype=torch.float64) delta_t tensor(0.1871, dtype=torch.float64)
14 gae_duplicate tensor(-0.0012, dtype=torch.float64) tensor(-3.4080, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2087, dtype=torch.float64) delta_t tensor(-0.1141, dtype=torch.float64)
13 gae_duplicate tensor(-0.3566, dtype=torch.float64) tensor(1.8064, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4819, dtype=torch.float64) delta_t tensor(0.1418, dtype=torch.float64)
12 gae_duplicate tensor(-0.0320, dtype=torch.float64) tensor(-2.5860, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2122, dtype=torch.float64) delta_t tensor(-0.0668, dtype=torch.float64)
11 gae_duplicate tensor(-0.2696, dtype=torch.float64) tensor(1.0864, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4700, dtype=torch.float64) delta_t tensor(0.1738, dtype=torch.float64)
10 gae_duplicate tensor(-0.0411, dtype=torch.float64) tensor(-3.3012, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2004, dtype=torch.float64) delta_t tensor(-0.1805, dtype=torch.float64)
9 gae_duplicate tensor(-0.4736, dtype=torch.float64) tensor(3.4262, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4509, dtype=torch.float64) delta_t tensor(0.2097, dtype=torch.float64)
8 gae_duplicate tensor(-0.0403, dtype=torch.float64) tensor(-3.9209, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1975, dtype=torch.float64) delta_t tensor(-0.1868, dtype=torch.float64)
7 gae_duplicate tensor(-0.4356, dtype=torch.float64) tensor(3.1070, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1396, dtype=torch.float64) delta_t tensor(-0.2563, dtype=torch.float64)
6 gae_duplicate tensor(-1.6255, dtype=torch.float64) tensor(5.3980, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1564, dtype=torch.float64) delta_t tensor(-0.5597, dtype=torch.float64)
5 gae_duplicate tensor(-1.3950, dtype=torch.float64) tensor(11.5895, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5613, dtype=torch.float64) delta_t tensor(-2.9505, dtype=torch.float64)
4 gae_duplicate tensor(-6.1639, dtype=torch.float64) tensor(58.6296, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0527, dtype=torch.float64) delta_t tensor(-0.4756, dtype=torch.float64)
3 gae_duplicate tensor(-1.2669, dtype=torch.float64) tensor(15.4659, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2552, dtype=torch.float64) delta_t tensor(-0.4568, dtype=torch.float64)
2 gae_duplicate tensor(-1.1978, dtype=torch.float64) tensor(10.6032, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5068.7490234375
value loss:148.39991760253906
entropies:354.87994384765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.7184998989105225 seconds
19 rew tensor(0.3320, dtype=torch.float64) delta_t tensor(0.0034, dtype=torch.float64)
19 gae_duplicate tensor(-0.2553, dtype=torch.float64) tensor(-0.1511, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4861, dtype=torch.float64) delta_t tensor(0.1604, dtype=torch.float64)
18 gae_duplicate tensor(-0.0981, dtype=torch.float64) tensor(-3.1560, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3040, dtype=torch.float64) delta_t tensor(-0.0262, dtype=torch.float64)
17 gae_duplicate tensor(-0.2966, dtype=torch.float64) tensor(0.2500, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4236, dtype=torch.float64) delta_t tensor(0.0884, dtype=torch.float64)
16 gae_duplicate tensor(-0.2081, dtype=torch.float64) tensor(-1.7439, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2079, dtype=torch.float64) delta_t tensor(-0.1528, dtype=torch.float64)
15 gae_duplicate tensor(-0.3614, dtype=torch.float64) tensor(2.8337, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5079, dtype=torch.float64) delta_t tensor(0.2018, dtype=torch.float64)
14 gae_duplicate tensor(-0.1050, dtype=torch.float64) tensor(-3.7380, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1603, dtype=torch.float64) delta_t tensor(-0.1423, dtype=torch.float64)
13 gae_duplicate tensor(-0.2099, dtype=torch.float64) tensor(2.4263, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4966, dtype=torch.float64) delta_t tensor(0.1442, dtype=torch.float64)
12 gae_duplicate tensor(-0.0315, dtype=torch.float64) tensor(-2.6798, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1460, dtype=torch.float64) delta_t tensor(-0.1859, dtype=torch.float64)
11 gae_duplicate tensor(-0.3445, dtype=torch.float64) tensor(3.4610, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5008, dtype=torch.float64) delta_t tensor(0.1423, dtype=torch.float64)
10 gae_duplicate tensor(-0.1299, dtype=torch.float64) tensor(-2.3749, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1188, dtype=torch.float64) delta_t tensor(-0.2718, dtype=torch.float64)
9 gae_duplicate tensor(-0.5136, dtype=torch.float64) tensor(4.9582, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4309, dtype=torch.float64) delta_t tensor(0.1039, dtype=torch.float64)
8 gae_duplicate tensor(-0.1144, dtype=torch.float64) tensor(-1.6055, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0673, dtype=torch.float64) delta_t tensor(-0.2691, dtype=torch.float64)
7 gae_duplicate tensor(-0.5025, dtype=torch.float64) tensor(5.1723, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3629, dtype=torch.float64) delta_t tensor(-0.0325, dtype=torch.float64)
6 gae_duplicate tensor(-0.3683, dtype=torch.float64) tensor(1.1107, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1809, dtype=torch.float64) delta_t tensor(-0.5054, dtype=torch.float64)
5 gae_duplicate tensor(-0.8406, dtype=torch.float64) tensor(10.4925, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9822, dtype=torch.float64) delta_t tensor(-3.3382, dtype=torch.float64)
4 gae_duplicate tensor(-7.0166, dtype=torch.float64) tensor(65.3284, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0264, dtype=torch.float64) delta_t tensor(-0.3498, dtype=torch.float64)
3 gae_duplicate tensor(-1.1389, dtype=torch.float64) tensor(13.1590, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2166, dtype=torch.float64) delta_t tensor(-0.4772, dtype=torch.float64)
2 gae_duplicate tensor(-0.9089, dtype=torch.float64) tensor(10.4413, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5721.7119140625
value loss:153.7012939453125
entropies:354.6888427734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.42656397819519 seconds
19 rew tensor(0.4324, dtype=torch.float64) delta_t tensor(0.1074, dtype=torch.float64)
19 gae_duplicate tensor(-0.1332, dtype=torch.float64) tensor(-2.0655, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4056, dtype=torch.float64) delta_t tensor(0.1002, dtype=torch.float64)
18 gae_duplicate tensor(-0.0819, dtype=torch.float64) tensor(-2.1305, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4183, dtype=torch.float64) delta_t tensor(0.1274, dtype=torch.float64)
17 gae_duplicate tensor(0.0063, dtype=torch.float64) tensor(-2.7351, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3923, dtype=torch.float64) delta_t tensor(0.0826, dtype=torch.float64)
16 gae_duplicate tensor(-0.0731, dtype=torch.float64) tensor(-1.8030, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2899, dtype=torch.float64) delta_t tensor(-0.0228, dtype=torch.float64)
15 gae_duplicate tensor(-0.1871, dtype=torch.float64) tensor(0.3244, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3980, dtype=torch.float64) delta_t tensor(0.0649, dtype=torch.float64)
14 gae_duplicate tensor(-0.0965, dtype=torch.float64) tensor(-1.2475, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2747, dtype=torch.float64) delta_t tensor(-0.0812, dtype=torch.float64)
13 gae_duplicate tensor(-0.2655, dtype=torch.float64) tensor(1.4574, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3970, dtype=torch.float64) delta_t tensor(0.0745, dtype=torch.float64)
12 gae_duplicate tensor(-0.0381, dtype=torch.float64) tensor(-1.2887, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2819, dtype=torch.float64) delta_t tensor(-0.0707, dtype=torch.float64)
11 gae_duplicate tensor(-0.3447, dtype=torch.float64) tensor(1.1329, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4163, dtype=torch.float64) delta_t tensor(0.0828, dtype=torch.float64)
10 gae_duplicate tensor(-0.0833, dtype=torch.float64) tensor(-1.5450, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2507, dtype=torch.float64) delta_t tensor(-0.0930, dtype=torch.float64)
9 gae_duplicate tensor(-0.3832, dtype=torch.float64) tensor(1.7320, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3879, dtype=torch.float64) delta_t tensor(0.0823, dtype=torch.float64)
8 gae_duplicate tensor(-0.0519, dtype=torch.float64) tensor(-1.4749, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2431, dtype=torch.float64) delta_t tensor(-0.0867, dtype=torch.float64)
7 gae_duplicate tensor(-0.3709, dtype=torch.float64) tensor(1.5694, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2807, dtype=torch.float64) delta_t tensor(-0.0809, dtype=torch.float64)
6 gae_duplicate tensor(-0.3510, dtype=torch.float64) tensor(1.7437, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0169, dtype=torch.float64) delta_t tensor(-0.3388, dtype=torch.float64)
5 gae_duplicate tensor(-0.5613, dtype=torch.float64) tensor(6.9778, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6103, dtype=torch.float64) delta_t tensor(-3.9658, dtype=torch.float64)
4 gae_duplicate tensor(-7.5385, dtype=torch.float64) tensor(77.9033, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0307, dtype=torch.float64) delta_t tensor(-0.3734, dtype=torch.float64)
3 gae_duplicate tensor(-1.0558, dtype=torch.float64) tensor(15.3145, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1635, dtype=torch.float64) delta_t tensor(-0.3658, dtype=torch.float64)
2 gae_duplicate tensor(-0.8185, dtype=torch.float64) tensor(8.6436, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5631.26953125
value loss:196.94131469726562
entropies:354.779052734375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3979.0054)
ToM Target loss= tensor(3499.8848)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.300952196121216 seconds
19 rew tensor(0.4181, dtype=torch.float64) delta_t tensor(0.0908, dtype=torch.float64)
19 gae_duplicate tensor(-0.1928, dtype=torch.float64) tensor(-1.7725, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3562, dtype=torch.float64) delta_t tensor(0.0574, dtype=torch.float64)
18 gae_duplicate tensor(-0.0245, dtype=torch.float64) tensor(-1.2863, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2950, dtype=torch.float64) delta_t tensor(0.0104, dtype=torch.float64)
17 gae_duplicate tensor(-0.0698, dtype=torch.float64) tensor(-0.3300, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5139, dtype=torch.float64) delta_t tensor(0.2064, dtype=torch.float64)
16 gae_duplicate tensor(0.1643, dtype=torch.float64) tensor(-4.0465, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0078, dtype=torch.float64) delta_t tensor(-0.2632, dtype=torch.float64)
15 gae_duplicate tensor(-0.3435, dtype=torch.float64) tensor(4.6618, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5082, dtype=torch.float64) delta_t tensor(0.2068, dtype=torch.float64)
14 gae_duplicate tensor(0.1248, dtype=torch.float64) tensor(-3.6748, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0186, dtype=torch.float64) delta_t tensor(-0.2011, dtype=torch.float64)
13 gae_duplicate tensor(-0.3065, dtype=torch.float64) tensor(3.6062, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5096, dtype=torch.float64) delta_t tensor(0.1783, dtype=torch.float64)
12 gae_duplicate tensor(0.1146, dtype=torch.float64) tensor(-3.2694, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0017, dtype=torch.float64) delta_t tensor(-0.3019, dtype=torch.float64)
11 gae_duplicate tensor(-0.4298, dtype=torch.float64) tensor(5.5305, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4829, dtype=torch.float64) delta_t tensor(0.1542, dtype=torch.float64)
10 gae_duplicate tensor(0.1018, dtype=torch.float64) tensor(-2.4782, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0211, dtype=torch.float64) delta_t tensor(-0.2707, dtype=torch.float64)
9 gae_duplicate tensor(-0.4054, dtype=torch.float64) tensor(5.1768, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4781, dtype=torch.float64) delta_t tensor(0.1844, dtype=torch.float64)
8 gae_duplicate tensor(0.1415, dtype=torch.float64) tensor(-3.1323, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0062, dtype=torch.float64) delta_t tensor(-0.2791, dtype=torch.float64)
7 gae_duplicate tensor(-0.4706, dtype=torch.float64) tensor(5.1129, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4032, dtype=torch.float64) delta_t tensor(0.0596, dtype=torch.float64)
6 gae_duplicate tensor(-0.0002, dtype=torch.float64) tensor(-0.6415, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2976, dtype=torch.float64) delta_t tensor(-0.6200, dtype=torch.float64)
5 gae_duplicate tensor(-1.5185, dtype=torch.float64) tensor(12.4273, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4817, dtype=torch.float64) delta_t tensor(-3.8381, dtype=torch.float64)
4 gae_duplicate tensor(-6.7667, dtype=torch.float64) tensor(78.6430, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1467, dtype=torch.float64) delta_t tensor(-0.4030, dtype=torch.float64)
3 gae_duplicate tensor(-1.0082, dtype=torch.float64) tensor(15.5776, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1654, dtype=torch.float64) delta_t tensor(-0.2986, dtype=torch.float64)
2 gae_duplicate tensor(-0.4591, dtype=torch.float64) tensor(7.2733, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6434.25244140625
value loss:194.38536071777344
entropies:354.97906494140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.008525848388672 seconds
19 rew tensor(0.3788, dtype=torch.float64) delta_t tensor(0.1366, dtype=torch.float64)
19 gae_duplicate tensor(-0.0405, dtype=torch.float64) tensor(-2.6404, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3994, dtype=torch.float64) delta_t tensor(0.1582, dtype=torch.float64)
18 gae_duplicate tensor(-0.0292, dtype=torch.float64) tensor(-3.4157, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3378, dtype=torch.float64) delta_t tensor(0.1030, dtype=torch.float64)
17 gae_duplicate tensor(-0.0358, dtype=torch.float64) tensor(-2.3301, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4597, dtype=torch.float64) delta_t tensor(0.1912, dtype=torch.float64)
16 gae_duplicate tensor(0.0168, dtype=torch.float64) tensor(-3.9911, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1171, dtype=torch.float64) delta_t tensor(-0.1080, dtype=torch.float64)
15 gae_duplicate tensor(-0.4098, dtype=torch.float64) tensor(1.6583, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4626, dtype=torch.float64) delta_t tensor(0.2115, dtype=torch.float64)
14 gae_duplicate tensor(0.0487, dtype=torch.float64) tensor(-3.9358, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1266, dtype=torch.float64) delta_t tensor(-0.0621, dtype=torch.float64)
13 gae_duplicate tensor(-0.3123, dtype=torch.float64) tensor(0.7656, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4449, dtype=torch.float64) delta_t tensor(0.1732, dtype=torch.float64)
12 gae_duplicate tensor(0.0679, dtype=torch.float64) tensor(-3.3242, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0924, dtype=torch.float64) delta_t tensor(-0.1651, dtype=torch.float64)
11 gae_duplicate tensor(-0.4145, dtype=torch.float64) tensor(2.9642, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4456, dtype=torch.float64) delta_t tensor(0.1576, dtype=torch.float64)
10 gae_duplicate tensor(0.0082, dtype=torch.float64) tensor(-2.8549, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0707, dtype=torch.float64) delta_t tensor(-0.1213, dtype=torch.float64)
9 gae_duplicate tensor(-0.3153, dtype=torch.float64) tensor(2.0812, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4334, dtype=torch.float64) delta_t tensor(0.1744, dtype=torch.float64)
8 gae_duplicate tensor(0.0198, dtype=torch.float64) tensor(-3.2237, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0487, dtype=torch.float64) delta_t tensor(-0.1672, dtype=torch.float64)
7 gae_duplicate tensor(-0.3895, dtype=torch.float64) tensor(2.9878, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3767, dtype=torch.float64) delta_t tensor(0.1064, dtype=torch.float64)
6 gae_duplicate tensor(-0.0042, dtype=torch.float64) tensor(-1.7859, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1143, dtype=torch.float64) delta_t tensor(-0.3989, dtype=torch.float64)
5 gae_duplicate tensor(-0.7022, dtype=torch.float64) tensor(7.3681, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9066, dtype=torch.float64) delta_t tensor(-3.2210, dtype=torch.float64)
4 gae_duplicate tensor(-6.8986, dtype=torch.float64) tensor(65.9234, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1466, dtype=torch.float64) delta_t tensor(-0.3339, dtype=torch.float64)
3 gae_duplicate tensor(-0.9300, dtype=torch.float64) tensor(12.8946, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2118, dtype=torch.float64) delta_t tensor(-0.2713, dtype=torch.float64)
2 gae_duplicate tensor(-0.5626, dtype=torch.float64) tensor(6.5335, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4182.30126953125
value loss:147.80697631835938
entropies:354.98492431640625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.973733901977539 seconds
19 rew tensor(0.3383, dtype=torch.float64) delta_t tensor(0.1316, dtype=torch.float64)
19 gae_duplicate tensor(0.0163, dtype=torch.float64) tensor(-2.6436, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4196, dtype=torch.float64) delta_t tensor(0.1951, dtype=torch.float64)
18 gae_duplicate tensor(0.1431, dtype=torch.float64) tensor(-4.0981, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2808, dtype=torch.float64) delta_t tensor(0.0846, dtype=torch.float64)
17 gae_duplicate tensor(-0.0212, dtype=torch.float64) tensor(-2.0973, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4620, dtype=torch.float64) delta_t tensor(0.2423, dtype=torch.float64)
16 gae_duplicate tensor(0.0258, dtype=torch.float64) tensor(-5.1536, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2168, dtype=torch.float64) delta_t tensor(0.0391, dtype=torch.float64)
15 gae_duplicate tensor(-0.2010, dtype=torch.float64) tensor(-1.2134, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4621, dtype=torch.float64) delta_t tensor(0.2765, dtype=torch.float64)
14 gae_duplicate tensor(0.1297, dtype=torch.float64) tensor(-5.6277, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2408, dtype=torch.float64) delta_t tensor(0.0625, dtype=torch.float64)
13 gae_duplicate tensor(-0.0294, dtype=torch.float64) tensor(-1.7480, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4787, dtype=torch.float64) delta_t tensor(0.2530, dtype=torch.float64)
12 gae_duplicate tensor(0.0298, dtype=torch.float64) tensor(-5.0785, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2316, dtype=torch.float64) delta_t tensor(0.0698, dtype=torch.float64)
11 gae_duplicate tensor(-0.0563, dtype=torch.float64) tensor(-1.9027, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4739, dtype=torch.float64) delta_t tensor(0.2315, dtype=torch.float64)
10 gae_duplicate tensor(0.1013, dtype=torch.float64) tensor(-4.7472, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2270, dtype=torch.float64) delta_t tensor(0.0579, dtype=torch.float64)
9 gae_duplicate tensor(-0.0892, dtype=torch.float64) tensor(-1.6260, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4430, dtype=torch.float64) delta_t tensor(0.2312, dtype=torch.float64)
8 gae_duplicate tensor(0.1240, dtype=torch.float64) tensor(-4.8231, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2110, dtype=torch.float64) delta_t tensor(0.0048, dtype=torch.float64)
7 gae_duplicate tensor(-0.1927, dtype=torch.float64) tensor(-0.4927, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3525, dtype=torch.float64) delta_t tensor(0.1520, dtype=torch.float64)
6 gae_duplicate tensor(0.0436, dtype=torch.float64) tensor(-3.0340, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0243, dtype=torch.float64) delta_t tensor(-0.2313, dtype=torch.float64)
5 gae_duplicate tensor(-0.4315, dtype=torch.float64) tensor(4.4371, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9476, dtype=torch.float64) delta_t tensor(-2.2012, dtype=torch.float64)
4 gae_duplicate tensor(-5.6938, dtype=torch.float64) tensor(45.7636, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0969, dtype=torch.float64) delta_t tensor(-0.1391, dtype=torch.float64)
3 gae_duplicate tensor(-0.7285, dtype=torch.float64) tensor(7.0877, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1967, dtype=torch.float64) delta_t tensor(-0.1238, dtype=torch.float64)
2 gae_duplicate tensor(-0.3118, dtype=torch.float64) tensor(3.0702, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-963.7427978515625
value loss:97.29109191894531
entropies:354.86810302734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.346854209899902 seconds
19 rew tensor(0.4725, dtype=torch.float64) delta_t tensor(0.3463, dtype=torch.float64)
19 gae_duplicate tensor(0.2473, dtype=torch.float64) tensor(-6.8591, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3425, dtype=torch.float64) delta_t tensor(0.2334, dtype=torch.float64)
18 gae_duplicate tensor(0.1764, dtype=torch.float64) tensor(-5.3989, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3493, dtype=torch.float64) delta_t tensor(0.1889, dtype=torch.float64)
17 gae_duplicate tensor(0.0749, dtype=torch.float64) tensor(-4.2318, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4436, dtype=torch.float64) delta_t tensor(0.2329, dtype=torch.float64)
16 gae_duplicate tensor(0.0997, dtype=torch.float64) tensor(-4.9874, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1062, dtype=torch.float64) delta_t tensor(0.0190, dtype=torch.float64)
15 gae_duplicate tensor(-0.2121, dtype=torch.float64) tensor(-0.8958, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4768, dtype=torch.float64) delta_t tensor(0.3163, dtype=torch.float64)
14 gae_duplicate tensor(0.2156, dtype=torch.float64) tensor(-6.1403, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0830, dtype=torch.float64) delta_t tensor(0.0156, dtype=torch.float64)
13 gae_duplicate tensor(-0.0333, dtype=torch.float64) tensor(-0.9255, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4684, dtype=torch.float64) delta_t tensor(0.2828, dtype=torch.float64)
12 gae_duplicate tensor(0.1188, dtype=torch.float64) tensor(-5.7284, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0553, dtype=torch.float64) delta_t tensor(-0.0808, dtype=torch.float64)
11 gae_duplicate tensor(-0.2251, dtype=torch.float64) tensor(0.9498, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4651, dtype=torch.float64) delta_t tensor(0.2452, dtype=torch.float64)
10 gae_duplicate tensor(0.1957, dtype=torch.float64) tensor(-4.8810, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0315, dtype=torch.float64) delta_t tensor(-0.0046, dtype=torch.float64)
9 gae_duplicate tensor(-0.1681, dtype=torch.float64) tensor(-0.4010, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4455, dtype=torch.float64) delta_t tensor(0.2527, dtype=torch.float64)
8 gae_duplicate tensor(0.1882, dtype=torch.float64) tensor(-5.0477, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0197, dtype=torch.float64) delta_t tensor(-0.1063, dtype=torch.float64)
7 gae_duplicate tensor(-0.3132, dtype=torch.float64) tensor(1.5768, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3729, dtype=torch.float64) delta_t tensor(0.2250, dtype=torch.float64)
6 gae_duplicate tensor(0.0583, dtype=torch.float64) tensor(-4.2741, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1476, dtype=torch.float64) delta_t tensor(-0.2667, dtype=torch.float64)
5 gae_duplicate tensor(-0.5607, dtype=torch.float64) tensor(4.7399, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9190, dtype=torch.float64) delta_t tensor(-4.0618, dtype=torch.float64)
4 gae_duplicate tensor(-5.1969, dtype=torch.float64) tensor(79.3662, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1218, dtype=torch.float64) delta_t tensor(-0.0384, dtype=torch.float64)
3 gae_duplicate tensor(-0.7103, dtype=torch.float64) tensor(8.7296, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1914, dtype=torch.float64) delta_t tensor(-0.0185, dtype=torch.float64)
2 gae_duplicate tensor(-0.1862, dtype=torch.float64) tensor(1.3426, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2630.17333984375
value loss:167.177490234375
entropies:354.6221618652344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.3793299198150635 seconds
19 rew tensor(0.3711, dtype=torch.float64) delta_t tensor(0.3627, dtype=torch.float64)
19 gae_duplicate tensor(0.0765, dtype=torch.float64) tensor(-7.3159, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4650, dtype=torch.float64) delta_t tensor(0.3626, dtype=torch.float64)
18 gae_duplicate tensor(0.2386, dtype=torch.float64) tensor(-7.9153, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2774, dtype=torch.float64) delta_t tensor(0.1847, dtype=torch.float64)
17 gae_duplicate tensor(-0.0032, dtype=torch.float64) tensor(-4.2541, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5080, dtype=torch.float64) delta_t tensor(0.3601, dtype=torch.float64)
16 gae_duplicate tensor(0.2847, dtype=torch.float64) tensor(-7.5803, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1133, dtype=torch.float64) delta_t tensor(0.0413, dtype=torch.float64)
15 gae_duplicate tensor(-0.1361, dtype=torch.float64) tensor(-1.6571, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5257, dtype=torch.float64) delta_t tensor(0.4557, dtype=torch.float64)
14 gae_duplicate tensor(0.3198, dtype=torch.float64) tensor(-9.2537, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0480, dtype=torch.float64) delta_t tensor(-0.0164, dtype=torch.float64)
13 gae_duplicate tensor(-0.0824, dtype=torch.float64) tensor(-0.5915, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4735, dtype=torch.float64) delta_t tensor(0.3087, dtype=torch.float64)
12 gae_duplicate tensor(0.2072, dtype=torch.float64) tensor(-6.0894, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0170, dtype=torch.float64) delta_t tensor(-0.0739, dtype=torch.float64)
11 gae_duplicate tensor(-0.1636, dtype=torch.float64) tensor(0.8589, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5141, dtype=torch.float64) delta_t tensor(0.3210, dtype=torch.float64)
10 gae_duplicate tensor(0.2516, dtype=torch.float64) tensor(-6.2262, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0453, dtype=torch.float64) delta_t tensor(0.0306, dtype=torch.float64)
9 gae_duplicate tensor(-0.0695, dtype=torch.float64) tensor(-1.2303, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4703, dtype=torch.float64) delta_t tensor(0.3097, dtype=torch.float64)
8 gae_duplicate tensor(0.1678, dtype=torch.float64) tensor(-6.3856, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0987, dtype=torch.float64) delta_t tensor(-0.1009, dtype=torch.float64)
7 gae_duplicate tensor(-0.2657, dtype=torch.float64) tensor(1.3400, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4121, dtype=torch.float64) delta_t tensor(0.3440, dtype=torch.float64)
6 gae_duplicate tensor(0.2994, dtype=torch.float64) tensor(-6.6582, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2791, dtype=torch.float64) delta_t tensor(-0.3332, dtype=torch.float64)
5 gae_duplicate tensor(-0.6854, dtype=torch.float64) tensor(5.8720, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1771, dtype=torch.float64) delta_t tensor(-3.2023, dtype=torch.float64)
4 gae_duplicate tensor(-5.6473, dtype=torch.float64) tensor(63.3869, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1626, dtype=torch.float64) delta_t tensor(0.0380, dtype=torch.float64)
3 gae_duplicate tensor(-0.5443, dtype=torch.float64) tensor(5.5737, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1631, dtype=torch.float64) delta_t tensor(0.0885, dtype=torch.float64)
2 gae_duplicate tensor(-0.2359, dtype=torch.float64) tensor(-1.2670, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-668.48681640625
value loss:131.03955078125
entropies:354.5292663574219
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3954.0059)
ToM Target loss= tensor(3503.6025)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.936774969100952 seconds
19 rew tensor(0.4399, dtype=torch.float64) delta_t tensor(0.4138, dtype=torch.float64)
19 gae_duplicate tensor(0.0630, dtype=torch.float64) tensor(-7.7075, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4121, dtype=torch.float64) delta_t tensor(0.3607, dtype=torch.float64)
18 gae_duplicate tensor(0.3279, dtype=torch.float64) tensor(-7.9627, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4422, dtype=torch.float64) delta_t tensor(0.3966, dtype=torch.float64)
17 gae_duplicate tensor(0.1379, dtype=torch.float64) tensor(-8.3250, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3729, dtype=torch.float64) delta_t tensor(0.3747, dtype=torch.float64)
16 gae_duplicate tensor(0.3195, dtype=torch.float64) tensor(-8.2771, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2461, dtype=torch.float64) delta_t tensor(0.2414, dtype=torch.float64)
15 gae_duplicate tensor(-0.2773, dtype=torch.float64) tensor(-5.5355, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3950, dtype=torch.float64) delta_t tensor(0.3894, dtype=torch.float64)
14 gae_duplicate tensor(0.3352, dtype=torch.float64) tensor(-8.2660, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3769, dtype=torch.float64) delta_t tensor(0.3528, dtype=torch.float64)
13 gae_duplicate tensor(0.0633, dtype=torch.float64) tensor(-7.7484, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4120, dtype=torch.float64) delta_t tensor(0.3469, dtype=torch.float64)
12 gae_duplicate tensor(0.2457, dtype=torch.float64) tensor(-7.5484, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3722, dtype=torch.float64) delta_t tensor(0.4070, dtype=torch.float64)
11 gae_duplicate tensor(0.2184, dtype=torch.float64) tensor(-8.6796, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4016, dtype=torch.float64) delta_t tensor(0.3307, dtype=torch.float64)
10 gae_duplicate tensor(0.2981, dtype=torch.float64) tensor(-7.2270, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2139, dtype=torch.float64) delta_t tensor(0.2774, dtype=torch.float64)
9 gae_duplicate tensor(-0.2096, dtype=torch.float64) tensor(-6.2572, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3404, dtype=torch.float64) delta_t tensor(0.3251, dtype=torch.float64)
8 gae_duplicate tensor(0.1433, dtype=torch.float64) tensor(-6.8694, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3076, dtype=torch.float64) delta_t tensor(0.3131, dtype=torch.float64)
7 gae_duplicate tensor(-0.0335, dtype=torch.float64) tensor(-6.6868, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2997, dtype=torch.float64) delta_t tensor(0.3488, dtype=torch.float64)
6 gae_duplicate tensor(0.2986, dtype=torch.float64) tensor(-7.6371, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0151, dtype=torch.float64) delta_t tensor(0.0895, dtype=torch.float64)
5 gae_duplicate tensor(-0.0579, dtype=torch.float64) tensor(-2.5588, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.2120, dtype=torch.float64) delta_t tensor(-3.2814, dtype=torch.float64)
4 gae_duplicate tensor(-4.0170, dtype=torch.float64) tensor(65.3836, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0824, dtype=torch.float64) delta_t tensor(0.3273, dtype=torch.float64)
3 gae_duplicate tensor(-0.1984, dtype=torch.float64) tensor(-0.0704, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2233, dtype=torch.float64) delta_t tensor(0.1341, dtype=torch.float64)
2 gae_duplicate tensor(-0.0763, dtype=torch.float64) tensor(-2.4899, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2305.288330078125
value loss:123.25973510742188
entropies:354.56903076171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.238746166229248 seconds
19 rew tensor(0.2838, dtype=torch.float64) delta_t tensor(0.3958, dtype=torch.float64)
19 gae_duplicate tensor(0.1578, dtype=torch.float64) tensor(-7.9360, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4697, dtype=torch.float64) delta_t tensor(0.4185, dtype=torch.float64)
18 gae_duplicate tensor(0.4030, dtype=torch.float64) tensor(-9.1715, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2154, dtype=torch.float64) delta_t tensor(0.1946, dtype=torch.float64)
17 gae_duplicate tensor(-0.0216, dtype=torch.float64) tensor(-4.6763, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4875, dtype=torch.float64) delta_t tensor(0.4574, dtype=torch.float64)
16 gae_duplicate tensor(0.3406, dtype=torch.float64) tensor(-9.4279, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1020, dtype=torch.float64) delta_t tensor(0.1495, dtype=torch.float64)
15 gae_duplicate tensor(0.0480, dtype=torch.float64) tensor(-3.8367, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5351, dtype=torch.float64) delta_t tensor(0.5147, dtype=torch.float64)
14 gae_duplicate tensor(0.3848, dtype=torch.float64) tensor(-10.7424, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0714, dtype=torch.float64) delta_t tensor(0.1556, dtype=torch.float64)
13 gae_duplicate tensor(0.0351, dtype=torch.float64) tensor(-4.1584, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5299, dtype=torch.float64) delta_t tensor(0.4433, dtype=torch.float64)
12 gae_duplicate tensor(0.3412, dtype=torch.float64) tensor(-9.0774, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0528, dtype=torch.float64) delta_t tensor(0.1090, dtype=torch.float64)
11 gae_duplicate tensor(-0.0930, dtype=torch.float64) tensor(-2.9773, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5162, dtype=torch.float64) delta_t tensor(0.4019, dtype=torch.float64)
10 gae_duplicate tensor(0.3355, dtype=torch.float64) tensor(-8.0759, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0691, dtype=torch.float64) delta_t tensor(0.2422, dtype=torch.float64)
9 gae_duplicate tensor(0.0724, dtype=torch.float64) tensor(-5.7347, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4566, dtype=torch.float64) delta_t tensor(0.4424, dtype=torch.float64)
8 gae_duplicate tensor(0.1355, dtype=torch.float64) tensor(-9.1535, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0021, dtype=torch.float64) delta_t tensor(0.0428, dtype=torch.float64)
7 gae_duplicate tensor(-0.1646, dtype=torch.float64) tensor(-1.8630, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4211, dtype=torch.float64) delta_t tensor(0.5009, dtype=torch.float64)
6 gae_duplicate tensor(0.4047, dtype=torch.float64) tensor(-10.2675, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3390, dtype=torch.float64) delta_t tensor(-0.3348, dtype=torch.float64)
5 gae_duplicate tensor(-0.8335, dtype=torch.float64) tensor(5.4099, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.6535, dtype=torch.float64) delta_t tensor(-3.6171, dtype=torch.float64)
4 gae_duplicate tensor(-5.7447, dtype=torch.float64) tensor(70.6889, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0275, dtype=torch.float64) delta_t tensor(0.3354, dtype=torch.float64)
3 gae_duplicate tensor(-0.4239, dtype=torch.float64) tensor(0.6303, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2187, dtype=torch.float64) delta_t tensor(0.1418, dtype=torch.float64)
2 gae_duplicate tensor(-0.1226, dtype=torch.float64) tensor(-2.9163, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1161.723388671875
value loss:179.9239501953125
entropies:354.4764404296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.90803599357605 seconds
19 rew tensor(0.3282, dtype=torch.float64) delta_t tensor(0.4099, dtype=torch.float64)
19 gae_duplicate tensor(0.0189, dtype=torch.float64) tensor(-8.0076, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4523, dtype=torch.float64) delta_t tensor(0.5106, dtype=torch.float64)
18 gae_duplicate tensor(0.3878, dtype=torch.float64) tensor(-10.6412, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2981, dtype=torch.float64) delta_t tensor(0.3469, dtype=torch.float64)
17 gae_duplicate tensor(-0.0172, dtype=torch.float64) tensor(-7.9664, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4840, dtype=torch.float64) delta_t tensor(0.4852, dtype=torch.float64)
16 gae_duplicate tensor(0.3942, dtype=torch.float64) tensor(-10.4817, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2463, dtype=torch.float64) delta_t tensor(0.3420, dtype=torch.float64)
15 gae_duplicate tensor(0.1069, dtype=torch.float64) tensor(-7.8731, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4663, dtype=torch.float64) delta_t tensor(0.5296, dtype=torch.float64)
14 gae_duplicate tensor(0.4183, dtype=torch.float64) tensor(-11.6336, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1831, dtype=torch.float64) delta_t tensor(0.2483, dtype=torch.float64)
13 gae_duplicate tensor(0.1039, dtype=torch.float64) tensor(-5.9807, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4878, dtype=torch.float64) delta_t tensor(0.4491, dtype=torch.float64)
12 gae_duplicate tensor(0.2545, dtype=torch.float64) tensor(-9.6156, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1524, dtype=torch.float64) delta_t tensor(0.2376, dtype=torch.float64)
11 gae_duplicate tensor(0.1188, dtype=torch.float64) tensor(-5.7630, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4695, dtype=torch.float64) delta_t tensor(0.4435, dtype=torch.float64)
10 gae_duplicate tensor(0.3619, dtype=torch.float64) tensor(-9.2370, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0183, dtype=torch.float64) delta_t tensor(0.1992, dtype=torch.float64)
9 gae_duplicate tensor(-0.1370, dtype=torch.float64) tensor(-4.8906, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4348, dtype=torch.float64) delta_t tensor(0.4457, dtype=torch.float64)
8 gae_duplicate tensor(0.2410, dtype=torch.float64) tensor(-9.2756, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1207, dtype=torch.float64) delta_t tensor(0.1696, dtype=torch.float64)
7 gae_duplicate tensor(-0.1100, dtype=torch.float64) tensor(-4.1730, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3532, dtype=torch.float64) delta_t tensor(0.4802, dtype=torch.float64)
6 gae_duplicate tensor(0.2607, dtype=torch.float64) tensor(-9.7057, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0940, dtype=torch.float64) delta_t tensor(-0.0004, dtype=torch.float64)
5 gae_duplicate tensor(-0.1787, dtype=torch.float64) tensor(-0.9812, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.9985, dtype=torch.float64) delta_t tensor(-3.9784, dtype=torch.float64)
4 gae_duplicate tensor(-6.0125, dtype=torch.float64) tensor(75.2116, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0585, dtype=torch.float64) delta_t tensor(0.4700, dtype=torch.float64)
3 gae_duplicate tensor(-0.1530, dtype=torch.float64) tensor(-1.2799, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2152, dtype=torch.float64) delta_t tensor(0.2298, dtype=torch.float64)
2 gae_duplicate tensor(-0.1342, dtype=torch.float64) tensor(-4.6223, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2437.774658203125
value loss:184.64111328125
entropies:354.4997253417969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.109037160873413 seconds
19 rew tensor(0.4134, dtype=torch.float64) delta_t tensor(0.5029, dtype=torch.float64)
19 gae_duplicate tensor(0.1005, dtype=torch.float64) tensor(-9.7760, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4555, dtype=torch.float64) delta_t tensor(0.5735, dtype=torch.float64)
18 gae_duplicate tensor(0.4139, dtype=torch.float64) tensor(-12.3027, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3398, dtype=torch.float64) delta_t tensor(0.4257, dtype=torch.float64)
17 gae_duplicate tensor(0.1606, dtype=torch.float64) tensor(-9.3943, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4667, dtype=torch.float64) delta_t tensor(0.4874, dtype=torch.float64)
16 gae_duplicate tensor(0.4012, dtype=torch.float64) tensor(-10.6371, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2456, dtype=torch.float64) delta_t tensor(0.3840, dtype=torch.float64)
15 gae_duplicate tensor(0.2307, dtype=torch.float64) tensor(-8.4426, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4769, dtype=torch.float64) delta_t tensor(0.5191, dtype=torch.float64)
14 gae_duplicate tensor(0.3390, dtype=torch.float64) tensor(-11.1893, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1675, dtype=torch.float64) delta_t tensor(0.2564, dtype=torch.float64)
13 gae_duplicate tensor(0.0744, dtype=torch.float64) tensor(-6.1227, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4583, dtype=torch.float64) delta_t tensor(0.4834, dtype=torch.float64)
12 gae_duplicate tensor(0.3380, dtype=torch.float64) tensor(-10.4765, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1296, dtype=torch.float64) delta_t tensor(0.1640, dtype=torch.float64)
11 gae_duplicate tensor(0.0468, dtype=torch.float64) tensor(-4.3244, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4650, dtype=torch.float64) delta_t tensor(0.4512, dtype=torch.float64)
10 gae_duplicate tensor(0.4062, dtype=torch.float64) tensor(-9.5026, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0510, dtype=torch.float64) delta_t tensor(0.2865, dtype=torch.float64)
9 gae_duplicate tensor(0.1793, dtype=torch.float64) tensor(-6.5246, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3610, dtype=torch.float64) delta_t tensor(0.3300, dtype=torch.float64)
8 gae_duplicate tensor(0.0949, dtype=torch.float64) tensor(-7.3472, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0291, dtype=torch.float64) delta_t tensor(0.1454, dtype=torch.float64)
7 gae_duplicate tensor(-0.1592, dtype=torch.float64) tensor(-3.8061, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2658, dtype=torch.float64) delta_t tensor(0.4202, dtype=torch.float64)
6 gae_duplicate tensor(-0.1009, dtype=torch.float64) tensor(-8.4340, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1472, dtype=torch.float64) delta_t tensor(0.0681, dtype=torch.float64)
5 gae_duplicate tensor(-0.2483, dtype=torch.float64) tensor(-2.4539, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.4356, dtype=torch.float64) delta_t tensor(-4.2678, dtype=torch.float64)
4 gae_duplicate tensor(-6.6877, dtype=torch.float64) tensor(81.8548, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0161, dtype=torch.float64) delta_t tensor(0.4846, dtype=torch.float64)
3 gae_duplicate tensor(-0.2336, dtype=torch.float64) tensor(-1.1408, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1628, dtype=torch.float64) delta_t tensor(0.3281, dtype=torch.float64)
2 gae_duplicate tensor(-0.0498, dtype=torch.float64) tensor(-6.5454, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2418.79638671875
value loss:230.48716735839844
entropies:354.576171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.85871696472168 seconds
19 rew tensor(0.4055, dtype=torch.float64) delta_t tensor(0.6276, dtype=torch.float64)
19 gae_duplicate tensor(0.1729, dtype=torch.float64) tensor(-12.1816, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5115, dtype=torch.float64) delta_t tensor(0.5655, dtype=torch.float64)
18 gae_duplicate tensor(0.5115, dtype=torch.float64) tensor(-12.5862, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3557, dtype=torch.float64) delta_t tensor(0.3714, dtype=torch.float64)
17 gae_duplicate tensor(0.1908, dtype=torch.float64) tensor(-8.5219, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4755, dtype=torch.float64) delta_t tensor(0.5343, dtype=torch.float64)
16 gae_duplicate tensor(0.4398, dtype=torch.float64) tensor(-11.3466, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2228, dtype=torch.float64) delta_t tensor(0.3320, dtype=torch.float64)
15 gae_duplicate tensor(0.1484, dtype=torch.float64) tensor(-7.7385, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5311, dtype=torch.float64) delta_t tensor(0.5798, dtype=torch.float64)
14 gae_duplicate tensor(0.4480, dtype=torch.float64) tensor(-12.1268, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1855, dtype=torch.float64) delta_t tensor(0.3245, dtype=torch.float64)
13 gae_duplicate tensor(0.0884, dtype=torch.float64) tensor(-7.7139, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5060, dtype=torch.float64) delta_t tensor(0.5158, dtype=torch.float64)
12 gae_duplicate tensor(0.3327, dtype=torch.float64) tensor(-10.7948, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1680, dtype=torch.float64) delta_t tensor(0.3236, dtype=torch.float64)
11 gae_duplicate tensor(0.2069, dtype=torch.float64) tensor(-7.5296, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5046, dtype=torch.float64) delta_t tensor(0.5063, dtype=torch.float64)
10 gae_duplicate tensor(0.4280, dtype=torch.float64) tensor(-10.4032, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1409, dtype=torch.float64) delta_t tensor(0.3451, dtype=torch.float64)
9 gae_duplicate tensor(0.1151, dtype=torch.float64) tensor(-7.5809, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4537, dtype=torch.float64) delta_t tensor(0.4791, dtype=torch.float64)
8 gae_duplicate tensor(0.2059, dtype=torch.float64) tensor(-10.2305, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0846, dtype=torch.float64) delta_t tensor(0.2253, dtype=torch.float64)
7 gae_duplicate tensor(-0.0953, dtype=torch.float64) tensor(-5.5006, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3890, dtype=torch.float64) delta_t tensor(0.5576, dtype=torch.float64)
6 gae_duplicate tensor(0.5069, dtype=torch.float64) tensor(-11.4278, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1593, dtype=torch.float64) delta_t tensor(-0.0012, dtype=torch.float64)
5 gae_duplicate tensor(-0.3112, dtype=torch.float64) tensor(-1.2391, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0859, dtype=torch.float64) delta_t tensor(-1.9245, dtype=torch.float64)
4 gae_duplicate tensor(-4.4036, dtype=torch.float64) tensor(39.2621, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0059, dtype=torch.float64) delta_t tensor(0.4297, dtype=torch.float64)
3 gae_duplicate tensor(0.0271, dtype=torch.float64) tensor(-4.6410, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2108, dtype=torch.float64) delta_t tensor(0.3739, dtype=torch.float64)
2 gae_duplicate tensor(0.0823, dtype=torch.float64) tensor(-7.4056, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:5828.35205078125
value loss:116.37598419189453
entropies:354.78167724609375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3949.7654)
ToM Target loss= tensor(3506.3164)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.744201898574829 seconds
19 rew tensor(0.4322, dtype=torch.float64) delta_t tensor(0.6035, dtype=torch.float64)
19 gae_duplicate tensor(0.3776, dtype=torch.float64) tensor(-11.8974, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3464, dtype=torch.float64) delta_t tensor(0.3868, dtype=torch.float64)
18 gae_duplicate tensor(0.2183, dtype=torch.float64) tensor(-8.9895, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3576, dtype=torch.float64) delta_t tensor(0.3912, dtype=torch.float64)
17 gae_duplicate tensor(0.2512, dtype=torch.float64) tensor(-8.4536, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4357, dtype=torch.float64) delta_t tensor(0.4247, dtype=torch.float64)
16 gae_duplicate tensor(0.2587, dtype=torch.float64) tensor(-9.4018, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2123, dtype=torch.float64) delta_t tensor(0.2912, dtype=torch.float64)
15 gae_duplicate tensor(0.0944, dtype=torch.float64) tensor(-6.5106, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4428, dtype=torch.float64) delta_t tensor(0.6067, dtype=torch.float64)
14 gae_duplicate tensor(0.4399, dtype=torch.float64) tensor(-12.5574, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2287, dtype=torch.float64) delta_t tensor(0.3030, dtype=torch.float64)
13 gae_duplicate tensor(0.0938, dtype=torch.float64) tensor(-7.2246, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4307, dtype=torch.float64) delta_t tensor(0.3904, dtype=torch.float64)
12 gae_duplicate tensor(0.2070, dtype=torch.float64) tensor(-8.4153, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2100, dtype=torch.float64) delta_t tensor(0.3304, dtype=torch.float64)
11 gae_duplicate tensor(0.1029, dtype=torch.float64) tensor(-7.2038, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4384, dtype=torch.float64) delta_t tensor(0.4328, dtype=torch.float64)
10 gae_duplicate tensor(0.3961, dtype=torch.float64) tensor(-9.4025, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0832, dtype=torch.float64) delta_t tensor(0.2326, dtype=torch.float64)
9 gae_duplicate tensor(-0.1107, dtype=torch.float64) tensor(-5.6765, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4041, dtype=torch.float64) delta_t tensor(0.4888, dtype=torch.float64)
8 gae_duplicate tensor(0.3761, dtype=torch.float64) tensor(-10.3274, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1917, dtype=torch.float64) delta_t tensor(0.3298, dtype=torch.float64)
7 gae_duplicate tensor(0.2149, dtype=torch.float64) tensor(-7.3900, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3292, dtype=torch.float64) delta_t tensor(0.5106, dtype=torch.float64)
6 gae_duplicate tensor(0.3977, dtype=torch.float64) tensor(-10.7126, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0321, dtype=torch.float64) delta_t tensor(-0.0270, dtype=torch.float64)
5 gae_duplicate tensor(-0.1790, dtype=torch.float64) tensor(-0.6545, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9087, dtype=torch.float64) delta_t tensor(-2.8153, dtype=torch.float64)
4 gae_duplicate tensor(-7.7130, dtype=torch.float64) tensor(57.4151, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0587, dtype=torch.float64) delta_t tensor(0.4095, dtype=torch.float64)
3 gae_duplicate tensor(-0.3892, dtype=torch.float64) tensor(-2.5538, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2735, dtype=torch.float64) delta_t tensor(0.2641, dtype=torch.float64)
2 gae_duplicate tensor(0.1327, dtype=torch.float64) tensor(-5.4662, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3976.999755859375
value loss:155.76329040527344
entropies:354.8895263671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.774687051773071 seconds
19 rew tensor(0.3642, dtype=torch.float64) delta_t tensor(0.5143, dtype=torch.float64)
19 gae_duplicate tensor(0.0314, dtype=torch.float64) tensor(-10.1734, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4072, dtype=torch.float64) delta_t tensor(0.4726, dtype=torch.float64)
18 gae_duplicate tensor(0.3979, dtype=torch.float64) tensor(-10.9135, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2912, dtype=torch.float64) delta_t tensor(0.3784, dtype=torch.float64)
17 gae_duplicate tensor(0.0615, dtype=torch.float64) tensor(-8.3406, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4606, dtype=torch.float64) delta_t tensor(0.4801, dtype=torch.float64)
16 gae_duplicate tensor(0.3950, dtype=torch.float64) tensor(-9.9967, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1853, dtype=torch.float64) delta_t tensor(0.2800, dtype=torch.float64)
15 gae_duplicate tensor(0.0156, dtype=torch.float64) tensor(-6.9341, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4755, dtype=torch.float64) delta_t tensor(0.5789, dtype=torch.float64)
14 gae_duplicate tensor(0.4358, dtype=torch.float64) tensor(-11.6651, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1727, dtype=torch.float64) delta_t tensor(0.2470, dtype=torch.float64)
13 gae_duplicate tensor(0.1945, dtype=torch.float64) tensor(-6.0882, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4664, dtype=torch.float64) delta_t tensor(0.5064, dtype=torch.float64)
12 gae_duplicate tensor(0.2500, dtype=torch.float64) tensor(-10.6513, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1427, dtype=torch.float64) delta_t tensor(0.2639, dtype=torch.float64)
11 gae_duplicate tensor(-0.0523, dtype=torch.float64) tensor(-6.2202, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4703, dtype=torch.float64) delta_t tensor(0.4435, dtype=torch.float64)
10 gae_duplicate tensor(0.4025, dtype=torch.float64) tensor(-9.4935, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1228, dtype=torch.float64) delta_t tensor(0.3970, dtype=torch.float64)
9 gae_duplicate tensor(0.2081, dtype=torch.float64) tensor(-8.9626, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4084, dtype=torch.float64) delta_t tensor(0.4004, dtype=torch.float64)
8 gae_duplicate tensor(0.2628, dtype=torch.float64) tensor(-8.8789, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0619, dtype=torch.float64) delta_t tensor(0.2356, dtype=torch.float64)
7 gae_duplicate tensor(0.0653, dtype=torch.float64) tensor(-5.4156, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3871, dtype=torch.float64) delta_t tensor(0.5382, dtype=torch.float64)
6 gae_duplicate tensor(0.4471, dtype=torch.float64) tensor(-11.3116, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1547, dtype=torch.float64) delta_t tensor(0.1049, dtype=torch.float64)
5 gae_duplicate tensor(-0.3861, dtype=torch.float64) tensor(-3.2478, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5888, dtype=torch.float64) delta_t tensor(-3.3883, dtype=torch.float64)
4 gae_duplicate tensor(-4.2464, dtype=torch.float64) tensor(66.6843, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1084, dtype=torch.float64) delta_t tensor(0.4128, dtype=torch.float64)
3 gae_duplicate tensor(-0.1437, dtype=torch.float64) tensor(-1.5081, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1653, dtype=torch.float64) delta_t tensor(0.3616, dtype=torch.float64)
2 gae_duplicate tensor(0.0100, dtype=torch.float64) tensor(-7.8490, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3736.378173828125
value loss:140.38978576660156
entropies:354.7607727050781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.721276044845581 seconds
19 rew tensor(0.4871, dtype=torch.float64) delta_t tensor(0.7149, dtype=torch.float64)
19 gae_duplicate tensor(0.1744, dtype=torch.float64) tensor(-14.2945, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4404, dtype=torch.float64) delta_t tensor(0.6108, dtype=torch.float64)
18 gae_duplicate tensor(0.3978, dtype=torch.float64) tensor(-13.5978, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3901, dtype=torch.float64) delta_t tensor(0.5533, dtype=torch.float64)
17 gae_duplicate tensor(0.4065, dtype=torch.float64) tensor(-12.1988, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5251, dtype=torch.float64) delta_t tensor(0.5580, dtype=torch.float64)
16 gae_duplicate tensor(0.3351, dtype=torch.float64) tensor(-12.4224, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2187, dtype=torch.float64) delta_t tensor(0.4385, dtype=torch.float64)
15 gae_duplicate tensor(0.0987, dtype=torch.float64) tensor(-9.7092, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5468, dtype=torch.float64) delta_t tensor(0.6465, dtype=torch.float64)
14 gae_duplicate tensor(0.4130, dtype=torch.float64) tensor(-13.9356, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1788, dtype=torch.float64) delta_t tensor(0.3648, dtype=torch.float64)
13 gae_duplicate tensor(-0.0708, dtype=torch.float64) tensor(-8.7652, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5545, dtype=torch.float64) delta_t tensor(0.6188, dtype=torch.float64)
12 gae_duplicate tensor(0.3981, dtype=torch.float64) tensor(-13.4953, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1723, dtype=torch.float64) delta_t tensor(0.3280, dtype=torch.float64)
11 gae_duplicate tensor(-0.1528, dtype=torch.float64) tensor(-7.7288, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1320, dtype=torch.float64) delta_t tensor(0.1673, dtype=torch.float64)
10 gae_duplicate tensor(-0.4898, dtype=torch.float64) tensor(-4.0288, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3748, dtype=torch.float64) delta_t tensor(-0.1732, dtype=torch.float64)
9 gae_duplicate tensor(-1.8366, dtype=torch.float64) tensor(2.6414, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3210, dtype=torch.float64) delta_t tensor(-0.3584, dtype=torch.float64)
8 gae_duplicate tensor(-2.2155, dtype=torch.float64) tensor(7.9801, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1310, dtype=torch.float64) delta_t tensor(-0.0837, dtype=torch.float64)
7 gae_duplicate tensor(-1.2095, dtype=torch.float64) tensor(2.4349, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0344, dtype=torch.float64) delta_t tensor(0.0690, dtype=torch.float64)
6 gae_duplicate tensor(-1.9648, dtype=torch.float64) tensor(-0.9372, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2115, dtype=torch.float64) delta_t tensor(0.0623, dtype=torch.float64)
5 gae_duplicate tensor(-0.6819, dtype=torch.float64) tensor(-1.3008, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3171, dtype=torch.float64) delta_t tensor(-2.1322, dtype=torch.float64)
4 gae_duplicate tensor(-3.9659, dtype=torch.float64) tensor(40.4632, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0019, dtype=torch.float64) delta_t tensor(0.4571, dtype=torch.float64)
3 gae_duplicate tensor(-0.0383, dtype=torch.float64) tensor(-5.0395, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2165, dtype=torch.float64) delta_t tensor(0.2563, dtype=torch.float64)
2 gae_duplicate tensor(0.0593, dtype=torch.float64) tensor(-5.4929, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3653.3251953125
value loss:137.93548583984375
entropies:354.6340637207031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.079865217208862 seconds
19 rew tensor(0.3641, dtype=torch.float64) delta_t tensor(0.3557, dtype=torch.float64)
19 gae_duplicate tensor(0.0846, dtype=torch.float64) tensor(-7.5194, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4685, dtype=torch.float64) delta_t tensor(0.4408, dtype=torch.float64)
18 gae_duplicate tensor(0.3779, dtype=torch.float64) tensor(-9.5731, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3409, dtype=torch.float64) delta_t tensor(0.3102, dtype=torch.float64)
17 gae_duplicate tensor(0.1242, dtype=torch.float64) tensor(-6.8562, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5023, dtype=torch.float64) delta_t tensor(0.4767, dtype=torch.float64)
16 gae_duplicate tensor(0.4308, dtype=torch.float64) tensor(-10.2345, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2437, dtype=torch.float64) delta_t tensor(0.3173, dtype=torch.float64)
15 gae_duplicate tensor(0.2182, dtype=torch.float64) tensor(-7.3279, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4786, dtype=torch.float64) delta_t tensor(0.4268, dtype=torch.float64)
14 gae_duplicate tensor(0.3777, dtype=torch.float64) tensor(-8.9482, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2411, dtype=torch.float64) delta_t tensor(0.3364, dtype=torch.float64)
13 gae_duplicate tensor(0.0881, dtype=torch.float64) tensor(-7.6019, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4749, dtype=torch.float64) delta_t tensor(0.4619, dtype=torch.float64)
12 gae_duplicate tensor(0.3154, dtype=torch.float64) tensor(-9.8718, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1927, dtype=torch.float64) delta_t tensor(0.2868, dtype=torch.float64)
11 gae_duplicate tensor(0.1083, dtype=torch.float64) tensor(-6.4017, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4785, dtype=torch.float64) delta_t tensor(0.3767, dtype=torch.float64)
10 gae_duplicate tensor(0.3911, dtype=torch.float64) tensor(-8.2993, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1612, dtype=torch.float64) delta_t tensor(0.2076, dtype=torch.float64)
9 gae_duplicate tensor(0.1061, dtype=torch.float64) tensor(-5.0121, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4658, dtype=torch.float64) delta_t tensor(0.3864, dtype=torch.float64)
8 gae_duplicate tensor(0.3245, dtype=torch.float64) tensor(-8.1397, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1419, dtype=torch.float64) delta_t tensor(0.1749, dtype=torch.float64)
7 gae_duplicate tensor(-0.0916, dtype=torch.float64) tensor(-4.2499, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3530, dtype=torch.float64) delta_t tensor(0.4374, dtype=torch.float64)
6 gae_duplicate tensor(0.3179, dtype=torch.float64) tensor(-9.0614, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0969, dtype=torch.float64) delta_t tensor(0.0868, dtype=torch.float64)
5 gae_duplicate tensor(-0.3049, dtype=torch.float64) tensor(-2.6217, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.3459, dtype=torch.float64) delta_t tensor(-4.1532, dtype=torch.float64)
4 gae_duplicate tensor(-5.3602, dtype=torch.float64) tensor(81.2828, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0445, dtype=torch.float64) delta_t tensor(0.5144, dtype=torch.float64)
3 gae_duplicate tensor(-0.3347, dtype=torch.float64) tensor(-1.9559, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1522, dtype=torch.float64) delta_t tensor(0.3603, dtype=torch.float64)
2 gae_duplicate tensor(0.0362, dtype=torch.float64) tensor(-7.2794, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2046.4736328125
value loss:195.0045623779297
entropies:354.74346923828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.443947076797485 seconds
19 rew tensor(0.4980, dtype=torch.float64) delta_t tensor(0.5074, dtype=torch.float64)
19 gae_duplicate tensor(0.3518, dtype=torch.float64) tensor(-10.1908, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3151, dtype=torch.float64) delta_t tensor(0.3202, dtype=torch.float64)
18 gae_duplicate tensor(0.2806, dtype=torch.float64) tensor(-7.1048, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3694, dtype=torch.float64) delta_t tensor(0.2858, dtype=torch.float64)
17 gae_duplicate tensor(0.2009, dtype=torch.float64) tensor(-6.2424, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4309, dtype=torch.float64) delta_t tensor(0.2887, dtype=torch.float64)
16 gae_duplicate tensor(0.2286, dtype=torch.float64) tensor(-6.3209, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1061, dtype=torch.float64) delta_t tensor(0.1295, dtype=torch.float64)
15 gae_duplicate tensor(0.0467, dtype=torch.float64) tensor(-3.0919, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4518, dtype=torch.float64) delta_t tensor(0.4150, dtype=torch.float64)
14 gae_duplicate tensor(0.2775, dtype=torch.float64) tensor(-8.5539, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0878, dtype=torch.float64) delta_t tensor(0.1046, dtype=torch.float64)
13 gae_duplicate tensor(0.0317, dtype=torch.float64) tensor(-2.9714, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4597, dtype=torch.float64) delta_t tensor(0.3524, dtype=torch.float64)
12 gae_duplicate tensor(0.1144, dtype=torch.float64) tensor(-7.1196, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0757, dtype=torch.float64) delta_t tensor(0.0791, dtype=torch.float64)
11 gae_duplicate tensor(-0.1126, dtype=torch.float64) tensor(-2.1800, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4531, dtype=torch.float64) delta_t tensor(0.3277, dtype=torch.float64)
10 gae_duplicate tensor(0.2617, dtype=torch.float64) tensor(-6.7324, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0681, dtype=torch.float64) delta_t tensor(0.0855, dtype=torch.float64)
9 gae_duplicate tensor(-0.0018, dtype=torch.float64) tensor(-2.4753, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4248, dtype=torch.float64) delta_t tensor(0.3275, dtype=torch.float64)
8 gae_duplicate tensor(0.2671, dtype=torch.float64) tensor(-6.4891, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0495, dtype=torch.float64) delta_t tensor(0.0323, dtype=torch.float64)
7 gae_duplicate tensor(-0.2621, dtype=torch.float64) tensor(-1.4563, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3416, dtype=torch.float64) delta_t tensor(0.3473, dtype=torch.float64)
6 gae_duplicate tensor(0.2299, dtype=torch.float64) tensor(-7.1021, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1328, dtype=torch.float64) delta_t tensor(-0.0251, dtype=torch.float64)
5 gae_duplicate tensor(-0.3337, dtype=torch.float64) tensor(-0.1539, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.5236, dtype=torch.float64) delta_t tensor(-2.3490, dtype=torch.float64)
4 gae_duplicate tensor(-5.3517, dtype=torch.float64) tensor(46.0346, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0749, dtype=torch.float64) delta_t tensor(0.3803, dtype=torch.float64)
3 gae_duplicate tensor(-0.0047, dtype=torch.float64) tensor(-2.8755, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1821, dtype=torch.float64) delta_t tensor(0.2874, dtype=torch.float64)
2 gae_duplicate tensor(0.0395, dtype=torch.float64) tensor(-6.0409, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2121.79150390625
value loss:88.40985107421875
entropies:354.8558654785156
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3944.9392)
ToM Target loss= tensor(3496.3879)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.899071931838989 seconds
19 rew tensor(0.3615, dtype=torch.float64) delta_t tensor(0.3738, dtype=torch.float64)
19 gae_duplicate tensor(-0.0685, dtype=torch.float64) tensor(-7.3794, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4213, dtype=torch.float64) delta_t tensor(0.3557, dtype=torch.float64)
18 gae_duplicate tensor(0.2113, dtype=torch.float64) tensor(-7.9480, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3290, dtype=torch.float64) delta_t tensor(0.2343, dtype=torch.float64)
17 gae_duplicate tensor(-0.0155, dtype=torch.float64) tensor(-5.4295, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4992, dtype=torch.float64) delta_t tensor(0.3738, dtype=torch.float64)
16 gae_duplicate tensor(0.2933, dtype=torch.float64) tensor(-7.9623, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1474, dtype=torch.float64) delta_t tensor(0.1171, dtype=torch.float64)
15 gae_duplicate tensor(-0.1234, dtype=torch.float64) tensor(-3.2897, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4912, dtype=torch.float64) delta_t tensor(0.3496, dtype=torch.float64)
14 gae_duplicate tensor(0.2904, dtype=torch.float64) tensor(-7.0414, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1772, dtype=torch.float64) delta_t tensor(0.1351, dtype=torch.float64)
13 gae_duplicate tensor(-0.0325, dtype=torch.float64) tensor(-3.3174, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5068, dtype=torch.float64) delta_t tensor(0.4234, dtype=torch.float64)
12 gae_duplicate tensor(0.2226, dtype=torch.float64) tensor(-8.3509, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1785, dtype=torch.float64) delta_t tensor(0.1028, dtype=torch.float64)
11 gae_duplicate tensor(-0.1211, dtype=torch.float64) tensor(-2.8079, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4723, dtype=torch.float64) delta_t tensor(0.3429, dtype=torch.float64)
10 gae_duplicate tensor(0.2809, dtype=torch.float64) tensor(-7.0405, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0124, dtype=torch.float64) delta_t tensor(0.0138, dtype=torch.float64)
9 gae_duplicate tensor(-0.2880, dtype=torch.float64) tensor(-1.0481, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4656, dtype=torch.float64) delta_t tensor(0.3394, dtype=torch.float64)
8 gae_duplicate tensor(0.2550, dtype=torch.float64) tensor(-6.7969, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1386, dtype=torch.float64) delta_t tensor(0.0859, dtype=torch.float64)
7 gae_duplicate tensor(-0.1248, dtype=torch.float64) tensor(-2.3868, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3704, dtype=torch.float64) delta_t tensor(0.3635, dtype=torch.float64)
6 gae_duplicate tensor(0.3289, dtype=torch.float64) tensor(-7.2908, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2283, dtype=torch.float64) delta_t tensor(-0.2036, dtype=torch.float64)
5 gae_duplicate tensor(-1.2314, dtype=torch.float64) tensor(3.3006, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9582, dtype=torch.float64) delta_t tensor(-2.8843, dtype=torch.float64)
4 gae_duplicate tensor(-6.3598, dtype=torch.float64) tensor(55.6266, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0980, dtype=torch.float64) delta_t tensor(0.2443, dtype=torch.float64)
3 gae_duplicate tensor(-0.5096, dtype=torch.float64) tensor(0.8976, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2876, dtype=torch.float64) delta_t tensor(0.1478, dtype=torch.float64)
2 gae_duplicate tensor(-0.0132, dtype=torch.float64) tensor(-2.9060, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1047.384765625
value loss:138.67095947265625
entropies:354.9301452636719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.275653839111328 seconds
19 rew tensor(0.3773, dtype=torch.float64) delta_t tensor(0.2435, dtype=torch.float64)
19 gae_duplicate tensor(-0.1695, dtype=torch.float64) tensor(-4.9272, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4799, dtype=torch.float64) delta_t tensor(0.3427, dtype=torch.float64)
18 gae_duplicate tensor(0.1800, dtype=torch.float64) tensor(-7.1988, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3339, dtype=torch.float64) delta_t tensor(0.1796, dtype=torch.float64)
17 gae_duplicate tensor(-0.0613, dtype=torch.float64) tensor(-4.2571, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5016, dtype=torch.float64) delta_t tensor(0.3446, dtype=torch.float64)
16 gae_duplicate tensor(0.2479, dtype=torch.float64) tensor(-7.3908, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1613, dtype=torch.float64) delta_t tensor(0.0331, dtype=torch.float64)
15 gae_duplicate tensor(-0.0686, dtype=torch.float64) tensor(-1.3838, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5011, dtype=torch.float64) delta_t tensor(0.3821, dtype=torch.float64)
14 gae_duplicate tensor(0.2641, dtype=torch.float64) tensor(-7.6768, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1544, dtype=torch.float64) delta_t tensor(0.0904, dtype=torch.float64)
13 gae_duplicate tensor(-0.1241, dtype=torch.float64) tensor(-2.4703, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4867, dtype=torch.float64) delta_t tensor(0.2693, dtype=torch.float64)
12 gae_duplicate tensor(0.1113, dtype=torch.float64) tensor(-5.6461, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1341, dtype=torch.float64) delta_t tensor(0.0210, dtype=torch.float64)
11 gae_duplicate tensor(-0.1262, dtype=torch.float64) tensor(-1.0610, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4896, dtype=torch.float64) delta_t tensor(0.2848, dtype=torch.float64)
10 gae_duplicate tensor(0.2470, dtype=torch.float64) tensor(-5.9081, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1191, dtype=torch.float64) delta_t tensor(-0.0240, dtype=torch.float64)
9 gae_duplicate tensor(-0.2138, dtype=torch.float64) tensor(-0.0915, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4684, dtype=torch.float64) delta_t tensor(0.2795, dtype=torch.float64)
8 gae_duplicate tensor(0.2216, dtype=torch.float64) tensor(-5.5481, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0917, dtype=torch.float64) delta_t tensor(-0.0042, dtype=torch.float64)
7 gae_duplicate tensor(-0.1896, dtype=torch.float64) tensor(-0.4500, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3847, dtype=torch.float64) delta_t tensor(0.3218, dtype=torch.float64)
6 gae_duplicate tensor(0.2607, dtype=torch.float64) tensor(-6.4302, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1154, dtype=torch.float64) delta_t tensor(-0.1300, dtype=torch.float64)
5 gae_duplicate tensor(-0.4711, dtype=torch.float64) tensor(1.9603, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3380, dtype=torch.float64) delta_t tensor(-3.2728, dtype=torch.float64)
4 gae_duplicate tensor(-5.7674, dtype=torch.float64) tensor(63.9794, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0954, dtype=torch.float64) delta_t tensor(0.2355, dtype=torch.float64)
3 gae_duplicate tensor(-0.4247, dtype=torch.float64) tensor(1.7876, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2236, dtype=torch.float64) delta_t tensor(0.2032, dtype=torch.float64)
2 gae_duplicate tensor(0.0033, dtype=torch.float64) tensor(-3.8437, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-281.8426818847656
value loss:129.37710571289062
entropies:355.07318115234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.293092727661133 seconds
19 rew tensor(0.2880, dtype=torch.float64) delta_t tensor(0.1694, dtype=torch.float64)
19 gae_duplicate tensor(-0.1472, dtype=torch.float64) tensor(-3.1933, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4922, dtype=torch.float64) delta_t tensor(0.3702, dtype=torch.float64)
18 gae_duplicate tensor(0.2678, dtype=torch.float64) tensor(-7.5021, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2465, dtype=torch.float64) delta_t tensor(0.0878, dtype=torch.float64)
17 gae_duplicate tensor(-0.1691, dtype=torch.float64) tensor(-2.3881, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5471, dtype=torch.float64) delta_t tensor(0.3136, dtype=torch.float64)
16 gae_duplicate tensor(0.2163, dtype=torch.float64) tensor(-6.4530, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1033, dtype=torch.float64) delta_t tensor(-0.0143, dtype=torch.float64)
15 gae_duplicate tensor(-0.1481, dtype=torch.float64) tensor(-0.3909, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3818, dtype=torch.float64) delta_t tensor(0.1895, dtype=torch.float64)
14 gae_duplicate tensor(-0.7075, dtype=torch.float64) tensor(-3.8297, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1190, dtype=torch.float64) delta_t tensor(-0.0313, dtype=torch.float64)
13 gae_duplicate tensor(-0.1754, dtype=torch.float64) tensor(0.2834, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5323, dtype=torch.float64) delta_t tensor(0.3259, dtype=torch.float64)
12 gae_duplicate tensor(0.2076, dtype=torch.float64) tensor(-6.5167, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0920, dtype=torch.float64) delta_t tensor(-0.0577, dtype=torch.float64)
11 gae_duplicate tensor(-0.2575, dtype=torch.float64) tensor(0.3363, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5346, dtype=torch.float64) delta_t tensor(0.3214, dtype=torch.float64)
10 gae_duplicate tensor(0.1936, dtype=torch.float64) tensor(-6.3460, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2233, dtype=torch.float64) delta_t tensor(-0.3142, dtype=torch.float64)
9 gae_duplicate tensor(-1.2445, dtype=torch.float64) tensor(5.5842, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0750, dtype=torch.float64) delta_t tensor(-0.2179, dtype=torch.float64)
8 gae_duplicate tensor(-2.9786, dtype=torch.float64) tensor(4.4984, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0077, dtype=torch.float64) delta_t tensor(-0.1165, dtype=torch.float64)
7 gae_duplicate tensor(-0.2565, dtype=torch.float64) tensor(2.8288, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3493, dtype=torch.float64) delta_t tensor(0.2888, dtype=torch.float64)
6 gae_duplicate tensor(-0.1116, dtype=torch.float64) tensor(-5.3476, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4323, dtype=torch.float64) delta_t tensor(-0.4942, dtype=torch.float64)
5 gae_duplicate tensor(-1.8263, dtype=torch.float64) tensor(9.1942, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2280, dtype=torch.float64) delta_t tensor(-2.2595, dtype=torch.float64)
4 gae_duplicate tensor(-5.3489, dtype=torch.float64) tensor(45.1717, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1840, dtype=torch.float64) delta_t tensor(0.3353, dtype=torch.float64)
3 gae_duplicate tensor(-0.3125, dtype=torch.float64) tensor(-1.9962, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4005, dtype=torch.float64) delta_t tensor(-0.0566, dtype=torch.float64)
2 gae_duplicate tensor(-0.3069, dtype=torch.float64) tensor(0.9390, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1439.0286865234375
value loss:107.49281311035156
entropies:355.2431945800781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.782696962356567 seconds
19 rew tensor(0.3090, dtype=torch.float64) delta_t tensor(0.1011, dtype=torch.float64)
19 gae_duplicate tensor(-0.1946, dtype=torch.float64) tensor(-1.9492, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4309, dtype=torch.float64) delta_t tensor(0.2499, dtype=torch.float64)
18 gae_duplicate tensor(0.1186, dtype=torch.float64) tensor(-5.1642, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2205, dtype=torch.float64) delta_t tensor(0.0022, dtype=torch.float64)
17 gae_duplicate tensor(-0.1333, dtype=torch.float64) tensor(-0.5698, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5330, dtype=torch.float64) delta_t tensor(0.2582, dtype=torch.float64)
16 gae_duplicate tensor(0.2185, dtype=torch.float64) tensor(-5.0980, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0367, dtype=torch.float64) delta_t tensor(-0.1256, dtype=torch.float64)
15 gae_duplicate tensor(-0.2592, dtype=torch.float64) tensor(1.9933, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4114, dtype=torch.float64) delta_t tensor(0.1717, dtype=torch.float64)
14 gae_duplicate tensor(-0.4849, dtype=torch.float64) tensor(-3.3074, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0652, dtype=torch.float64) delta_t tensor(-0.1213, dtype=torch.float64)
13 gae_duplicate tensor(-0.2342, dtype=torch.float64) tensor(2.1132, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5478, dtype=torch.float64) delta_t tensor(0.2861, dtype=torch.float64)
12 gae_duplicate tensor(0.2103, dtype=torch.float64) tensor(-5.4949, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0513, dtype=torch.float64) delta_t tensor(-0.1601, dtype=torch.float64)
11 gae_duplicate tensor(-0.2601, dtype=torch.float64) tensor(2.5555, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5190, dtype=torch.float64) delta_t tensor(0.2538, dtype=torch.float64)
10 gae_duplicate tensor(0.1809, dtype=torch.float64) tensor(-4.6774, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0544, dtype=torch.float64) delta_t tensor(-0.1405, dtype=torch.float64)
9 gae_duplicate tensor(-0.2520, dtype=torch.float64) tensor(2.3039, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5058, dtype=torch.float64) delta_t tensor(0.2529, dtype=torch.float64)
8 gae_duplicate tensor(0.1653, dtype=torch.float64) tensor(-4.7480, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0261, dtype=torch.float64) delta_t tensor(-0.1349, dtype=torch.float64)
7 gae_duplicate tensor(-0.2598, dtype=torch.float64) tensor(2.1747, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4212, dtype=torch.float64) delta_t tensor(0.2450, dtype=torch.float64)
6 gae_duplicate tensor(0.1644, dtype=torch.float64) tensor(-4.6242, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1424, dtype=torch.float64) delta_t tensor(-0.3334, dtype=torch.float64)
5 gae_duplicate tensor(-0.4412, dtype=torch.float64) tensor(6.1852, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.4743, dtype=torch.float64) delta_t tensor(-3.4487, dtype=torch.float64)
4 gae_duplicate tensor(-6.3657, dtype=torch.float64) tensor(69.9047, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1698, dtype=torch.float64) delta_t tensor(-0.0059, dtype=torch.float64)
3 gae_duplicate tensor(-0.6093, dtype=torch.float64) tensor(6.9424, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2023, dtype=torch.float64) delta_t tensor(0.1237, dtype=torch.float64)
2 gae_duplicate tensor(-0.0437, dtype=torch.float64) tensor(-1.7477, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3162.75048828125
value loss:156.578369140625
entropies:355.44384765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.026069641113281 seconds
19 rew tensor(0.4806, dtype=torch.float64) delta_t tensor(0.2489, dtype=torch.float64)
19 gae_duplicate tensor(-0.0593, dtype=torch.float64) tensor(-4.8662, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4360, dtype=torch.float64) delta_t tensor(0.1717, dtype=torch.float64)
18 gae_duplicate tensor(-0.0098, dtype=torch.float64) tensor(-3.8797, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4091, dtype=torch.float64) delta_t tensor(0.2398, dtype=torch.float64)
17 gae_duplicate tensor(-0.0672, dtype=torch.float64) tensor(-5.1769, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4215, dtype=torch.float64) delta_t tensor(0.1795, dtype=torch.float64)
16 gae_duplicate tensor(0.0081, dtype=torch.float64) tensor(-4.0875, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3400, dtype=torch.float64) delta_t tensor(0.0991, dtype=torch.float64)
15 gae_duplicate tensor(-0.0976, dtype=torch.float64) tensor(-2.4332, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4538, dtype=torch.float64) delta_t tensor(0.2381, dtype=torch.float64)
14 gae_duplicate tensor(0.0884, dtype=torch.float64) tensor(-4.9489, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2060, dtype=torch.float64) delta_t tensor(-0.0125, dtype=torch.float64)
13 gae_duplicate tensor(-0.2085, dtype=torch.float64) tensor(-0.2378, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4690, dtype=torch.float64) delta_t tensor(0.1886, dtype=torch.float64)
12 gae_duplicate tensor(-0.0191, dtype=torch.float64) tensor(-3.6946, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1989, dtype=torch.float64) delta_t tensor(-0.0196, dtype=torch.float64)
11 gae_duplicate tensor(-0.2095, dtype=torch.float64) tensor(-0.0017, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4263, dtype=torch.float64) delta_t tensor(0.1724, dtype=torch.float64)
10 gae_duplicate tensor(0.0628, dtype=torch.float64) tensor(-3.4195, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1048, dtype=torch.float64) delta_t tensor(-0.2878, dtype=torch.float64)
9 gae_duplicate tensor(-1.1978, dtype=torch.float64) tensor(5.2871, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4265, dtype=torch.float64) delta_t tensor(0.1563, dtype=torch.float64)
8 gae_duplicate tensor(0.0156, dtype=torch.float64) tensor(-2.5964, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1132, dtype=torch.float64) delta_t tensor(-0.1086, dtype=torch.float64)
7 gae_duplicate tensor(-0.4568, dtype=torch.float64) tensor(1.8087, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3056, dtype=torch.float64) delta_t tensor(0.1575, dtype=torch.float64)
6 gae_duplicate tensor(0.0258, dtype=torch.float64) tensor(-2.8676, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1535, dtype=torch.float64) delta_t tensor(-0.1189, dtype=torch.float64)
5 gae_duplicate tensor(-0.3174, dtype=torch.float64) tensor(2.0991, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9095, dtype=torch.float64) delta_t tensor(-1.8237, dtype=torch.float64)
4 gae_duplicate tensor(-3.4301, dtype=torch.float64) tensor(35.9868, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0016, dtype=torch.float64) delta_t tensor(0.2328, dtype=torch.float64)
3 gae_duplicate tensor(-0.1697, dtype=torch.float64) tensor(-0.9920, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1771, dtype=torch.float64) delta_t tensor(0.2226, dtype=torch.float64)
2 gae_duplicate tensor(-0.1033, dtype=torch.float64) tensor(-4.4717, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-177.42784118652344
value loss:62.239524841308594
entropies:355.5346374511719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3947.7456)
ToM Target loss= tensor(3505.2368)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.89003586769104 seconds
19 rew tensor(0.3627, dtype=torch.float64) delta_t tensor(0.1619, dtype=torch.float64)
19 gae_duplicate tensor(-0.0742, dtype=torch.float64) tensor(-3.1476, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4721, dtype=torch.float64) delta_t tensor(0.1611, dtype=torch.float64)
18 gae_duplicate tensor(0.0657, dtype=torch.float64) tensor(-3.4663, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2918, dtype=torch.float64) delta_t tensor(0.0989, dtype=torch.float64)
17 gae_duplicate tensor(-0.0891, dtype=torch.float64) tensor(-2.2520, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5236, dtype=torch.float64) delta_t tensor(0.2153, dtype=torch.float64)
16 gae_duplicate tensor(0.1655, dtype=torch.float64) tensor(-4.4424, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1478, dtype=torch.float64) delta_t tensor(-0.1010, dtype=torch.float64)
15 gae_duplicate tensor(-0.1656, dtype=torch.float64) tensor(1.5658, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5525, dtype=torch.float64) delta_t tensor(0.2450, dtype=torch.float64)
14 gae_duplicate tensor(0.1832, dtype=torch.float64) tensor(-4.6532, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1048, dtype=torch.float64) delta_t tensor(-0.1375, dtype=torch.float64)
13 gae_duplicate tensor(-0.2438, dtype=torch.float64) tensor(2.2617, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5528, dtype=torch.float64) delta_t tensor(0.2757, dtype=torch.float64)
12 gae_duplicate tensor(0.1811, dtype=torch.float64) tensor(-5.2098, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0991, dtype=torch.float64) delta_t tensor(-0.1418, dtype=torch.float64)
11 gae_duplicate tensor(-0.2413, dtype=torch.float64) tensor(2.2784, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5229, dtype=torch.float64) delta_t tensor(0.2314, dtype=torch.float64)
10 gae_duplicate tensor(0.1880, dtype=torch.float64) tensor(-4.3574, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0848, dtype=torch.float64) delta_t tensor(-0.1938, dtype=torch.float64)
9 gae_duplicate tensor(-0.2844, dtype=torch.float64) tensor(3.4550, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5101, dtype=torch.float64) delta_t tensor(0.1963, dtype=torch.float64)
8 gae_duplicate tensor(0.1225, dtype=torch.float64) tensor(-3.5516, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0646, dtype=torch.float64) delta_t tensor(-0.2031, dtype=torch.float64)
7 gae_duplicate tensor(-0.3793, dtype=torch.float64) tensor(3.6488, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3754, dtype=torch.float64) delta_t tensor(0.1860, dtype=torch.float64)
6 gae_duplicate tensor(-0.0518, dtype=torch.float64) tensor(-3.2887, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1717, dtype=torch.float64) delta_t tensor(-0.0710, dtype=torch.float64)
5 gae_duplicate tensor(-0.3024, dtype=torch.float64) tensor(1.0644, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.6934, dtype=torch.float64) delta_t tensor(-2.5218, dtype=torch.float64)
4 gae_duplicate tensor(-5.4514, dtype=torch.float64) tensor(50.2968, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0879, dtype=torch.float64) delta_t tensor(0.3048, dtype=torch.float64)
3 gae_duplicate tensor(-0.1576, dtype=torch.float64) tensor(-0.9686, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0880, dtype=torch.float64) delta_t tensor(0.3129, dtype=torch.float64)
2 gae_duplicate tensor(0.0943, dtype=torch.float64) tensor(-6.2311, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1338.1546630859375
value loss:81.57015991210938
entropies:355.6569519042969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.992547273635864 seconds
19 rew tensor(0.4095, dtype=torch.float64) delta_t tensor(0.0897, dtype=torch.float64)
19 gae_duplicate tensor(-0.1885, dtype=torch.float64) tensor(-1.8082, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4356, dtype=torch.float64) delta_t tensor(0.2104, dtype=torch.float64)
18 gae_duplicate tensor(0.0114, dtype=torch.float64) tensor(-4.3248, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4105, dtype=torch.float64) delta_t tensor(0.1486, dtype=torch.float64)
17 gae_duplicate tensor(-0.0802, dtype=torch.float64) tensor(-3.3438, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4297, dtype=torch.float64) delta_t tensor(0.1536, dtype=torch.float64)
16 gae_duplicate tensor(-0.0641, dtype=torch.float64) tensor(-3.3136, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3386, dtype=torch.float64) delta_t tensor(0.1005, dtype=torch.float64)
15 gae_duplicate tensor(-0.0559, dtype=torch.float64) tensor(-2.3286, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4364, dtype=torch.float64) delta_t tensor(0.1798, dtype=torch.float64)
14 gae_duplicate tensor(-0.0188, dtype=torch.float64) tensor(-3.7899, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3611, dtype=torch.float64) delta_t tensor(0.0860, dtype=torch.float64)
13 gae_duplicate tensor(-0.0919, dtype=torch.float64) tensor(-2.1095, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4381, dtype=torch.float64) delta_t tensor(0.1534, dtype=torch.float64)
12 gae_duplicate tensor(-0.0547, dtype=torch.float64) tensor(-3.1754, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3617, dtype=torch.float64) delta_t tensor(0.0735, dtype=torch.float64)
11 gae_duplicate tensor(-0.1124, dtype=torch.float64) tensor(-1.7596, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4330, dtype=torch.float64) delta_t tensor(0.1501, dtype=torch.float64)
10 gae_duplicate tensor(0.0156, dtype=torch.float64) tensor(-3.1460, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3415, dtype=torch.float64) delta_t tensor(0.0670, dtype=torch.float64)
9 gae_duplicate tensor(-0.1458, dtype=torch.float64) tensor(-1.6248, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3888, dtype=torch.float64) delta_t tensor(0.1196, dtype=torch.float64)
8 gae_duplicate tensor(3.6738e-06, dtype=torch.float64) tensor(-2.5074, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3129, dtype=torch.float64) delta_t tensor(0.0321, dtype=torch.float64)
7 gae_duplicate tensor(-0.1485, dtype=torch.float64) tensor(-0.8915, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2972, dtype=torch.float64) delta_t tensor(0.1468, dtype=torch.float64)
6 gae_duplicate tensor(0.0254, dtype=torch.float64) tensor(-3.0122, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0603, dtype=torch.float64) delta_t tensor(-0.0462, dtype=torch.float64)
5 gae_duplicate tensor(-0.3035, dtype=torch.float64) tensor(0.5731, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1897, dtype=torch.float64) delta_t tensor(-3.2102, dtype=torch.float64)
4 gae_duplicate tensor(-4.0971, dtype=torch.float64) tensor(62.4454, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0252, dtype=torch.float64) delta_t tensor(0.1568, dtype=torch.float64)
3 gae_duplicate tensor(-0.2977, dtype=torch.float64) tensor(3.2716, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2955, dtype=torch.float64) delta_t tensor(0.0356, dtype=torch.float64)
2 gae_duplicate tensor(-0.2243, dtype=torch.float64) tensor(-0.3412, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1651.9769287109375
value loss:103.20133972167969
entropies:355.7140197753906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.734693765640259 seconds
19 rew tensor(0.4020, dtype=torch.float64) delta_t tensor(0.1542, dtype=torch.float64)
19 gae_duplicate tensor(-0.1689, dtype=torch.float64) tensor(-3.0800, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4629, dtype=torch.float64) delta_t tensor(0.2172, dtype=torch.float64)
18 gae_duplicate tensor(0.0579, dtype=torch.float64) tensor(-4.5469, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3692, dtype=torch.float64) delta_t tensor(0.0854, dtype=torch.float64)
17 gae_duplicate tensor(-0.1089, dtype=torch.float64) tensor(-2.1036, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4753, dtype=torch.float64) delta_t tensor(0.1852, dtype=torch.float64)
16 gae_duplicate tensor(0.0361, dtype=torch.float64) tensor(-3.8280, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2210, dtype=torch.float64) delta_t tensor(-0.0311, dtype=torch.float64)
15 gae_duplicate tensor(-0.1632, dtype=torch.float64) tensor(0.2134, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4836, dtype=torch.float64) delta_t tensor(0.1856, dtype=torch.float64)
14 gae_duplicate tensor(0.0520, dtype=torch.float64) tensor(-3.6150, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2231, dtype=torch.float64) delta_t tensor(-0.0427, dtype=torch.float64)
13 gae_duplicate tensor(-0.2759, dtype=torch.float64) tensor(0.4545, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4717, dtype=torch.float64) delta_t tensor(0.1866, dtype=torch.float64)
12 gae_duplicate tensor(0.1509, dtype=torch.float64) tensor(-3.6662, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2042, dtype=torch.float64) delta_t tensor(-0.0576, dtype=torch.float64)
11 gae_duplicate tensor(-0.2716, dtype=torch.float64) tensor(0.7434, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4562, dtype=torch.float64) delta_t tensor(0.1649, dtype=torch.float64)
10 gae_duplicate tensor(0.0567, dtype=torch.float64) tensor(-3.1746, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0118, dtype=torch.float64) delta_t tensor(-0.2686, dtype=torch.float64)
9 gae_duplicate tensor(-0.9126, dtype=torch.float64) tensor(4.9647, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4559, dtype=torch.float64) delta_t tensor(0.1582, dtype=torch.float64)
8 gae_duplicate tensor(0.0286, dtype=torch.float64) tensor(-2.6333, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0593, dtype=torch.float64) delta_t tensor(-0.1258, dtype=torch.float64)
7 gae_duplicate tensor(-0.2960, dtype=torch.float64) tensor(2.2577, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2733, dtype=torch.float64) delta_t tensor(0.1918, dtype=torch.float64)
6 gae_duplicate tensor(0.1581, dtype=torch.float64) tensor(-3.5351, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1668, dtype=torch.float64) delta_t tensor(-0.1498, dtype=torch.float64)
5 gae_duplicate tensor(-0.4342, dtype=torch.float64) tensor(2.5987, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5479, dtype=torch.float64) delta_t tensor(-3.4240, dtype=torch.float64)
4 gae_duplicate tensor(-7.9216, dtype=torch.float64) tensor(67.8055, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0359, dtype=torch.float64) delta_t tensor(0.2337, dtype=torch.float64)
3 gae_duplicate tensor(-0.4319, dtype=torch.float64) tensor(2.1983, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1803, dtype=torch.float64) delta_t tensor(0.1446, dtype=torch.float64)
2 gae_duplicate tensor(-0.2501, dtype=torch.float64) tensor(-2.5565, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2714.889404296875
value loss:180.03530883789062
entropies:355.78399658203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.188394069671631 seconds
19 rew tensor(0.3666, dtype=torch.float64) delta_t tensor(0.1406, dtype=torch.float64)
19 gae_duplicate tensor(-0.1130, dtype=torch.float64) tensor(-2.7444, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4797, dtype=torch.float64) delta_t tensor(0.1966, dtype=torch.float64)
18 gae_duplicate tensor(0.0362, dtype=torch.float64) tensor(-4.1624, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3675, dtype=torch.float64) delta_t tensor(0.0987, dtype=torch.float64)
17 gae_duplicate tensor(-0.0956, dtype=torch.float64) tensor(-2.3837, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4425, dtype=torch.float64) delta_t tensor(0.1537, dtype=torch.float64)
16 gae_duplicate tensor(-0.0826, dtype=torch.float64) tensor(-3.3095, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2293, dtype=torch.float64) delta_t tensor(0.0166, dtype=torch.float64)
15 gae_duplicate tensor(-0.2327, dtype=torch.float64) tensor(-0.6745, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4579, dtype=torch.float64) delta_t tensor(0.1634, dtype=torch.float64)
14 gae_duplicate tensor(-0.0095, dtype=torch.float64) tensor(-3.3003, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1703, dtype=torch.float64) delta_t tensor(-0.0531, dtype=torch.float64)
13 gae_duplicate tensor(-0.2618, dtype=torch.float64) tensor(0.7331, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4944, dtype=torch.float64) delta_t tensor(0.2084, dtype=torch.float64)
12 gae_duplicate tensor(-0.0451, dtype=torch.float64) tensor(-4.0404, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1270, dtype=torch.float64) delta_t tensor(-0.1030, dtype=torch.float64)
11 gae_duplicate tensor(-0.3334, dtype=torch.float64) tensor(1.6330, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4593, dtype=torch.float64) delta_t tensor(0.1789, dtype=torch.float64)
10 gae_duplicate tensor(-0.0419, dtype=torch.float64) tensor(-3.3522, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1906, dtype=torch.float64) delta_t tensor(-0.4134, dtype=torch.float64)
9 gae_duplicate tensor(-1.4886, dtype=torch.float64) tensor(7.7402, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4519, dtype=torch.float64) delta_t tensor(0.1784, dtype=torch.float64)
8 gae_duplicate tensor(-0.1318, dtype=torch.float64) tensor(-2.7477, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0856, dtype=torch.float64) delta_t tensor(-0.1351, dtype=torch.float64)
7 gae_duplicate tensor(-0.4205, dtype=torch.float64) tensor(2.3786, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0102, dtype=torch.float64) delta_t tensor(-0.1596, dtype=torch.float64)
6 gae_duplicate tensor(-1.8362, dtype=torch.float64) tensor(3.3167, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1725, dtype=torch.float64) delta_t tensor(-0.1825, dtype=torch.float64)
5 gae_duplicate tensor(-0.5798, dtype=torch.float64) tensor(3.9585, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-5.3820, dtype=torch.float64) delta_t tensor(-5.2562, dtype=torch.float64)
4 gae_duplicate tensor(-8.1184, dtype=torch.float64) tensor(104.4916, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0798, dtype=torch.float64) delta_t tensor(0.2414, dtype=torch.float64)
3 gae_duplicate tensor(-0.5797, dtype=torch.float64) tensor(5.7419, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1458, dtype=torch.float64) delta_t tensor(0.3102, dtype=torch.float64)
2 gae_duplicate tensor(0.0351, dtype=torch.float64) tensor(-5.5228, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5374.87890625
value loss:307.9439392089844
entropies:355.81927490234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7971601486206055 seconds
19 rew tensor(0.4900, dtype=torch.float64) delta_t tensor(0.2438, dtype=torch.float64)
19 gae_duplicate tensor(0.0655, dtype=torch.float64) tensor(-4.8061, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3444, dtype=torch.float64) delta_t tensor(0.1209, dtype=torch.float64)
18 gae_duplicate tensor(0.0575, dtype=torch.float64) tensor(-2.8621, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3486, dtype=torch.float64) delta_t tensor(0.1444, dtype=torch.float64)
17 gae_duplicate tensor(-0.0111, dtype=torch.float64) tensor(-3.1132, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4581, dtype=torch.float64) delta_t tensor(0.2256, dtype=torch.float64)
16 gae_duplicate tensor(0.1361, dtype=torch.float64) tensor(-4.7751, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1274, dtype=torch.float64) delta_t tensor(-0.0563, dtype=torch.float64)
15 gae_duplicate tensor(-0.2385, dtype=torch.float64) tensor(0.6384, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5012, dtype=torch.float64) delta_t tensor(0.3401, dtype=torch.float64)
14 gae_duplicate tensor(0.2113, dtype=torch.float64) tensor(-6.6991, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0874, dtype=torch.float64) delta_t tensor(-0.0897, dtype=torch.float64)
13 gae_duplicate tensor(-0.2396, dtype=torch.float64) tensor(1.0844, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5015, dtype=torch.float64) delta_t tensor(0.2743, dtype=torch.float64)
12 gae_duplicate tensor(0.1763, dtype=torch.float64) tensor(-5.2529, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0674, dtype=torch.float64) delta_t tensor(-0.1179, dtype=torch.float64)
11 gae_duplicate tensor(-0.2686, dtype=torch.float64) tensor(1.7558, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4938, dtype=torch.float64) delta_t tensor(0.2625, dtype=torch.float64)
10 gae_duplicate tensor(0.1929, dtype=torch.float64) tensor(-4.9902, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0669, dtype=torch.float64) delta_t tensor(-0.0830, dtype=torch.float64)
9 gae_duplicate tensor(-0.2441, dtype=torch.float64) tensor(1.1399, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4393, dtype=torch.float64) delta_t tensor(0.2118, dtype=torch.float64)
8 gae_duplicate tensor(0.0739, dtype=torch.float64) tensor(-4.0725, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0204, dtype=torch.float64) delta_t tensor(-0.1435, dtype=torch.float64)
7 gae_duplicate tensor(-0.2781, dtype=torch.float64) tensor(2.4369, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3798, dtype=torch.float64) delta_t tensor(0.2728, dtype=torch.float64)
6 gae_duplicate tensor(0.2186, dtype=torch.float64) tensor(-5.1304, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2247, dtype=torch.float64) delta_t tensor(-0.1151, dtype=torch.float64)
5 gae_duplicate tensor(-0.3538, dtype=torch.float64) tensor(1.7346, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3865, dtype=torch.float64) delta_t tensor(-2.2054, dtype=torch.float64)
4 gae_duplicate tensor(-3.2761, dtype=torch.float64) tensor(44.2549, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0720, dtype=torch.float64) delta_t tensor(0.2697, dtype=torch.float64)
3 gae_duplicate tensor(-0.2828, dtype=torch.float64) tensor(-0.9533, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2204, dtype=torch.float64) delta_t tensor(0.2773, dtype=torch.float64)
2 gae_duplicate tensor(-0.1234, dtype=torch.float64) tensor(-5.5067, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-359.7860107421875
value loss:67.69908142089844
entropies:355.84539794921875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3973.6355)
ToM Target loss= tensor(3492.9143)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.7596800327301025 seconds
19 rew tensor(0.3351, dtype=torch.float64) delta_t tensor(0.1665, dtype=torch.float64)
19 gae_duplicate tensor(-0.0468, dtype=torch.float64) tensor(-3.2485, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4746, dtype=torch.float64) delta_t tensor(0.3314, dtype=torch.float64)
18 gae_duplicate tensor(0.0719, dtype=torch.float64) tensor(-6.8499, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3367, dtype=torch.float64) delta_t tensor(0.1645, dtype=torch.float64)
17 gae_duplicate tensor(-0.0043, dtype=torch.float64) tensor(-3.9251, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4827, dtype=torch.float64) delta_t tensor(0.3205, dtype=torch.float64)
16 gae_duplicate tensor(0.0313, dtype=torch.float64) tensor(-6.7768, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0374, dtype=torch.float64) delta_t tensor(-0.2360, dtype=torch.float64)
15 gae_duplicate tensor(-1.7889, dtype=torch.float64) tensor(3.9240, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4675, dtype=torch.float64) delta_t tensor(0.2867, dtype=torch.float64)
14 gae_duplicate tensor(0.0451, dtype=torch.float64) tensor(-5.2945, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2484, dtype=torch.float64) delta_t tensor(0.0855, dtype=torch.float64)
13 gae_duplicate tensor(-0.0799, dtype=torch.float64) tensor(-2.2046, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4694, dtype=torch.float64) delta_t tensor(0.2881, dtype=torch.float64)
12 gae_duplicate tensor(0.0121, dtype=torch.float64) tensor(-5.9036, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2713, dtype=torch.float64) delta_t tensor(0.0991, dtype=torch.float64)
11 gae_duplicate tensor(-0.0621, dtype=torch.float64) tensor(-2.5470, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4296, dtype=torch.float64) delta_t tensor(0.2393, dtype=torch.float64)
10 gae_duplicate tensor(-0.0997, dtype=torch.float64) tensor(-4.9471, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2174, dtype=torch.float64) delta_t tensor(0.0432, dtype=torch.float64)
9 gae_duplicate tensor(-0.1050, dtype=torch.float64) tensor(-1.3507, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3579, dtype=torch.float64) delta_t tensor(0.1735, dtype=torch.float64)
8 gae_duplicate tensor(-0.1112, dtype=torch.float64) tensor(-3.5561, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1546, dtype=torch.float64) delta_t tensor(-0.0114, dtype=torch.float64)
7 gae_duplicate tensor(-0.1577, dtype=torch.float64) tensor(-0.1405, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2229, dtype=torch.float64) delta_t tensor(0.2376, dtype=torch.float64)
6 gae_duplicate tensor(-0.0688, dtype=torch.float64) tensor(-4.6888, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1513, dtype=torch.float64) delta_t tensor(0.0086, dtype=torch.float64)
5 gae_duplicate tensor(-0.3605, dtype=torch.float64) tensor(-0.7122, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4191, dtype=torch.float64) delta_t tensor(-2.1598, dtype=torch.float64)
4 gae_duplicate tensor(-7.7025, dtype=torch.float64) tensor(43.4116, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0074, dtype=torch.float64) delta_t tensor(0.4127, dtype=torch.float64)
3 gae_duplicate tensor(-0.0017, dtype=torch.float64) tensor(-3.8860, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2610, dtype=torch.float64) delta_t tensor(0.3219, dtype=torch.float64)
2 gae_duplicate tensor(0.0106, dtype=torch.float64) tensor(-6.7308, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:736.9605102539062
value loss:139.95216369628906
entropies:355.841064453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.518802881240845 seconds
19 rew tensor(0.4859, dtype=torch.float64) delta_t tensor(0.3402, dtype=torch.float64)
19 gae_duplicate tensor(0.0839, dtype=torch.float64) tensor(-6.7586, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3550, dtype=torch.float64) delta_t tensor(0.2696, dtype=torch.float64)
18 gae_duplicate tensor(0.1634, dtype=torch.float64) tensor(-5.9200, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3773, dtype=torch.float64) delta_t tensor(0.2199, dtype=torch.float64)
17 gae_duplicate tensor(0.0339, dtype=torch.float64) tensor(-4.9383, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4208, dtype=torch.float64) delta_t tensor(0.2865, dtype=torch.float64)
16 gae_duplicate tensor(0.1408, dtype=torch.float64) tensor(-6.0745, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1964, dtype=torch.float64) delta_t tensor(0.0961, dtype=torch.float64)
15 gae_duplicate tensor(-0.1328, dtype=torch.float64) tensor(-2.5375, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4245, dtype=torch.float64) delta_t tensor(0.2746, dtype=torch.float64)
14 gae_duplicate tensor(0.1088, dtype=torch.float64) tensor(-5.6849, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1700, dtype=torch.float64) delta_t tensor(0.0866, dtype=torch.float64)
13 gae_duplicate tensor(-0.1235, dtype=torch.float64) tensor(-2.3191, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4656, dtype=torch.float64) delta_t tensor(0.3133, dtype=torch.float64)
12 gae_duplicate tensor(0.2188, dtype=torch.float64) tensor(-6.4621, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1302, dtype=torch.float64) delta_t tensor(0.0250, dtype=torch.float64)
11 gae_duplicate tensor(-0.1614, dtype=torch.float64) tensor(-1.1540, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4503, dtype=torch.float64) delta_t tensor(0.3249, dtype=torch.float64)
10 gae_duplicate tensor(0.1802, dtype=torch.float64) tensor(-6.5010, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1033, dtype=torch.float64) delta_t tensor(0.0155, dtype=torch.float64)
9 gae_duplicate tensor(-0.1602, dtype=torch.float64) tensor(-0.9387, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4230, dtype=torch.float64) delta_t tensor(0.2834, dtype=torch.float64)
8 gae_duplicate tensor(0.1623, dtype=torch.float64) tensor(-5.7035, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0885, dtype=torch.float64) delta_t tensor(-0.0010, dtype=torch.float64)
7 gae_duplicate tensor(-0.1819, dtype=torch.float64) tensor(-0.6043, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2695, dtype=torch.float64) delta_t tensor(0.3329, dtype=torch.float64)
6 gae_duplicate tensor(0.1532, dtype=torch.float64) tensor(-6.6494, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2447, dtype=torch.float64) delta_t tensor(-0.0794, dtype=torch.float64)
5 gae_duplicate tensor(-0.3218, dtype=torch.float64) tensor(0.9397, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.7690, dtype=torch.float64) delta_t tensor(-2.5172, dtype=torch.float64)
4 gae_duplicate tensor(-7.1228, dtype=torch.float64) tensor(50.2491, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0036, dtype=torch.float64) delta_t tensor(0.4121, dtype=torch.float64)
3 gae_duplicate tensor(-0.1814, dtype=torch.float64) tensor(-3.1208, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2600, dtype=torch.float64) delta_t tensor(0.3975, dtype=torch.float64)
2 gae_duplicate tensor(0.0672, dtype=torch.float64) tensor(-8.1778, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1111.1318359375
value loss:135.28517150878906
entropies:355.8084411621094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.028354167938232 seconds
19 rew tensor(0.4977, dtype=torch.float64) delta_t tensor(0.3149, dtype=torch.float64)
19 gae_duplicate tensor(0.1440, dtype=torch.float64) tensor(-6.1898, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2703, dtype=torch.float64) delta_t tensor(0.2235, dtype=torch.float64)
18 gae_duplicate tensor(0.0379, dtype=torch.float64) tensor(-5.1094, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4605, dtype=torch.float64) delta_t tensor(0.3429, dtype=torch.float64)
17 gae_duplicate tensor(0.1403, dtype=torch.float64) tensor(-7.2665, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2773, dtype=torch.float64) delta_t tensor(0.1901, dtype=torch.float64)
16 gae_duplicate tensor(-0.0350, dtype=torch.float64) tensor(-4.5147, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3452, dtype=torch.float64) delta_t tensor(0.2732, dtype=torch.float64)
15 gae_duplicate tensor(-0.0340, dtype=torch.float64) tensor(-5.9088, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3100, dtype=torch.float64) delta_t tensor(0.2556, dtype=torch.float64)
14 gae_duplicate tensor(0.0295, dtype=torch.float64) tensor(-5.5643, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3500, dtype=torch.float64) delta_t tensor(0.2444, dtype=torch.float64)
13 gae_duplicate tensor(-0.0572, dtype=torch.float64) tensor(-5.4157, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3181, dtype=torch.float64) delta_t tensor(0.2062, dtype=torch.float64)
12 gae_duplicate tensor(-0.0046, dtype=torch.float64) tensor(-4.5632, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3440, dtype=torch.float64) delta_t tensor(0.2031, dtype=torch.float64)
11 gae_duplicate tensor(-0.2247, dtype=torch.float64) tensor(-4.4303, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3187, dtype=torch.float64) delta_t tensor(0.2416, dtype=torch.float64)
10 gae_duplicate tensor(0.0696, dtype=torch.float64) tensor(-5.2386, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3143, dtype=torch.float64) delta_t tensor(0.2959, dtype=torch.float64)
9 gae_duplicate tensor(-0.1907, dtype=torch.float64) tensor(-6.3658, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2759, dtype=torch.float64) delta_t tensor(0.2150, dtype=torch.float64)
8 gae_duplicate tensor(0.0695, dtype=torch.float64) tensor(-4.8433, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3082, dtype=torch.float64) delta_t tensor(0.2078, dtype=torch.float64)
7 gae_duplicate tensor(-0.2243, dtype=torch.float64) tensor(-4.5982, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1897, dtype=torch.float64) delta_t tensor(0.2870, dtype=torch.float64)
6 gae_duplicate tensor(0.0888, dtype=torch.float64) tensor(-6.1907, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2767, dtype=torch.float64) delta_t tensor(-0.0883, dtype=torch.float64)
5 gae_duplicate tensor(-2.3157, dtype=torch.float64) tensor(1.0323, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.2444, dtype=torch.float64) delta_t tensor(-2.0229, dtype=torch.float64)
4 gae_duplicate tensor(-5.4936, dtype=torch.float64) tensor(39.9977, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0123, dtype=torch.float64) delta_t tensor(0.4500, dtype=torch.float64)
3 gae_duplicate tensor(-0.0152, dtype=torch.float64) tensor(-4.9458, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3969, dtype=torch.float64) delta_t tensor(0.2729, dtype=torch.float64)
2 gae_duplicate tensor(0.1635, dtype=torch.float64) tensor(-5.8437, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2385.729248046875
value loss:86.58364868164062
entropies:355.7528991699219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.310549020767212 seconds
19 rew tensor(0.3668, dtype=torch.float64) delta_t tensor(0.4269, dtype=torch.float64)
19 gae_duplicate tensor(0.0019, dtype=torch.float64) tensor(-8.6671, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4258, dtype=torch.float64) delta_t tensor(0.3417, dtype=torch.float64)
18 gae_duplicate tensor(-0.0307, dtype=torch.float64) tensor(-7.5901, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3245, dtype=torch.float64) delta_t tensor(0.2721, dtype=torch.float64)
17 gae_duplicate tensor(0.0564, dtype=torch.float64) tensor(-6.1656, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4415, dtype=torch.float64) delta_t tensor(0.3140, dtype=torch.float64)
16 gae_duplicate tensor(-0.0048, dtype=torch.float64) tensor(-6.8942, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1474, dtype=torch.float64) delta_t tensor(0.0756, dtype=torch.float64)
15 gae_duplicate tensor(0.0153, dtype=torch.float64) tensor(-2.1734, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4698, dtype=torch.float64) delta_t tensor(0.3045, dtype=torch.float64)
14 gae_duplicate tensor(0.0227, dtype=torch.float64) tensor(-6.1833, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1637, dtype=torch.float64) delta_t tensor(0.0824, dtype=torch.float64)
13 gae_duplicate tensor(-0.1475, dtype=torch.float64) tensor(-2.2325, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4701, dtype=torch.float64) delta_t tensor(0.3393, dtype=torch.float64)
12 gae_duplicate tensor(-0.0269, dtype=torch.float64) tensor(-6.9860, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1645, dtype=torch.float64) delta_t tensor(0.0620, dtype=torch.float64)
11 gae_duplicate tensor(-0.1308, dtype=torch.float64) tensor(-1.8985, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4423, dtype=torch.float64) delta_t tensor(0.3297, dtype=torch.float64)
10 gae_duplicate tensor(0.0127, dtype=torch.float64) tensor(-6.6743, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1365, dtype=torch.float64) delta_t tensor(0.0701, dtype=torch.float64)
9 gae_duplicate tensor(-0.1268, dtype=torch.float64) tensor(-2.0293, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4277, dtype=torch.float64) delta_t tensor(0.2930, dtype=torch.float64)
8 gae_duplicate tensor(0.0815, dtype=torch.float64) tensor(-5.9123, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1228, dtype=torch.float64) delta_t tensor(0.0384, dtype=torch.float64)
7 gae_duplicate tensor(-0.1880, dtype=torch.float64) tensor(-1.3680, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3556, dtype=torch.float64) delta_t tensor(0.3809, dtype=torch.float64)
6 gae_duplicate tensor(0.1199, dtype=torch.float64) tensor(-7.6934, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0487, dtype=torch.float64) delta_t tensor(0.2532, dtype=torch.float64)
5 gae_duplicate tensor(-0.3394, dtype=torch.float64) tensor(-5.6793, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.6859, dtype=torch.float64) delta_t tensor(-4.1578, dtype=torch.float64)
4 gae_duplicate tensor(-7.6676, dtype=torch.float64) tensor(81.1220, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1439, dtype=torch.float64) delta_t tensor(0.5792, dtype=torch.float64)
3 gae_duplicate tensor(-0.0465, dtype=torch.float64) tensor(-3.3418, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2199, dtype=torch.float64) delta_t tensor(0.4695, dtype=torch.float64)
2 gae_duplicate tensor(0.2841, dtype=torch.float64) tensor(-9.5497, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:439.46221923828125
value loss:208.4858856201172
entropies:355.7212219238281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.974370956420898 seconds
19 rew tensor(0.3588, dtype=torch.float64) delta_t tensor(0.3790, dtype=torch.float64)
19 gae_duplicate tensor(-0.0754, dtype=torch.float64) tensor(-7.4377, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3954, dtype=torch.float64) delta_t tensor(0.4417, dtype=torch.float64)
18 gae_duplicate tensor(0.1353, dtype=torch.float64) tensor(-9.6162, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3442, dtype=torch.float64) delta_t tensor(0.2425, dtype=torch.float64)
17 gae_duplicate tensor(-0.0196, dtype=torch.float64) tensor(-5.7074, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4588, dtype=torch.float64) delta_t tensor(0.3107, dtype=torch.float64)
16 gae_duplicate tensor(0.0058, dtype=torch.float64) tensor(-6.6315, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0545, dtype=torch.float64) delta_t tensor(-0.0060, dtype=torch.float64)
15 gae_duplicate tensor(-0.1821, dtype=torch.float64) tensor(-0.5434, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4653, dtype=torch.float64) delta_t tensor(0.3366, dtype=torch.float64)
14 gae_duplicate tensor(0.0704, dtype=torch.float64) tensor(-6.7712, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0763, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
13 gae_duplicate tensor(-0.1918, dtype=torch.float64) tensor(-0.4088, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4573, dtype=torch.float64) delta_t tensor(0.2737, dtype=torch.float64)
12 gae_duplicate tensor(0.0303, dtype=torch.float64) tensor(-5.5032, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0618, dtype=torch.float64) delta_t tensor(0.0064, dtype=torch.float64)
11 gae_duplicate tensor(-0.1999, dtype=torch.float64) tensor(-0.6657, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4379, dtype=torch.float64) delta_t tensor(0.3166, dtype=torch.float64)
10 gae_duplicate tensor(0.0968, dtype=torch.float64) tensor(-6.3070, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0701, dtype=torch.float64) delta_t tensor(0.0286, dtype=torch.float64)
9 gae_duplicate tensor(-0.0943, dtype=torch.float64) tensor(-1.2339, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4223, dtype=torch.float64) delta_t tensor(0.2628, dtype=torch.float64)
8 gae_duplicate tensor(0.1089, dtype=torch.float64) tensor(-5.3112, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0348, dtype=torch.float64) delta_t tensor(0.0144, dtype=torch.float64)
7 gae_duplicate tensor(-0.0851, dtype=torch.float64) tensor(-0.8032, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3355, dtype=torch.float64) delta_t tensor(0.3899, dtype=torch.float64)
6 gae_duplicate tensor(0.1576, dtype=torch.float64) tensor(-7.7828, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2985, dtype=torch.float64) delta_t tensor(-0.1409, dtype=torch.float64)
5 gae_duplicate tensor(-1.0334, dtype=torch.float64) tensor(2.0446, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2556, dtype=torch.float64) delta_t tensor(-0.8569, dtype=torch.float64)
4 gae_duplicate tensor(-2.4668, dtype=torch.float64) tensor(16.8808, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1384, dtype=torch.float64) delta_t tensor(0.4378, dtype=torch.float64)
3 gae_duplicate tensor(0.1162, dtype=torch.float64) tensor(-7.0254, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2744, dtype=torch.float64) delta_t tensor(0.4455, dtype=torch.float64)
2 gae_duplicate tensor(0.2186, dtype=torch.float64) tensor(-9.5418, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3271.666748046875
value loss:39.069190979003906
entropies:355.73004150390625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3955.8257)
ToM Target loss= tensor(3517.2219)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.034876823425293 seconds
19 rew tensor(0.5213, dtype=torch.float64) delta_t tensor(0.3372, dtype=torch.float64)
19 gae_duplicate tensor(0.2410, dtype=torch.float64) tensor(-6.7186, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3193, dtype=torch.float64) delta_t tensor(0.1610, dtype=torch.float64)
18 gae_duplicate tensor(0.1285, dtype=torch.float64) tensor(-3.8559, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4511, dtype=torch.float64) delta_t tensor(0.2902, dtype=torch.float64)
17 gae_duplicate tensor(0.1206, dtype=torch.float64) tensor(-6.0684, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3632, dtype=torch.float64) delta_t tensor(0.1626, dtype=torch.float64)
16 gae_duplicate tensor(0.0703, dtype=torch.float64) tensor(-3.8305, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3491, dtype=torch.float64) delta_t tensor(0.1834, dtype=torch.float64)
15 gae_duplicate tensor(-0.0207, dtype=torch.float64) tensor(-4.0041, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3457, dtype=torch.float64) delta_t tensor(0.1993, dtype=torch.float64)
14 gae_duplicate tensor(0.0933, dtype=torch.float64) tensor(-4.2992, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3749, dtype=torch.float64) delta_t tensor(0.1720, dtype=torch.float64)
13 gae_duplicate tensor(-0.0900, dtype=torch.float64) tensor(-3.8816, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3078, dtype=torch.float64) delta_t tensor(0.0952, dtype=torch.float64)
12 gae_duplicate tensor(-0.0430, dtype=torch.float64) tensor(-2.2762, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3620, dtype=torch.float64) delta_t tensor(0.2020, dtype=torch.float64)
11 gae_duplicate tensor(-0.1101, dtype=torch.float64) tensor(-4.2062, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2949, dtype=torch.float64) delta_t tensor(0.1914, dtype=torch.float64)
10 gae_duplicate tensor(0.1538, dtype=torch.float64) tensor(-4.1979, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2043, dtype=torch.float64) delta_t tensor(0.1065, dtype=torch.float64)
9 gae_duplicate tensor(-0.3434, dtype=torch.float64) tensor(-2.5199, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2650, dtype=torch.float64) delta_t tensor(0.1467, dtype=torch.float64)
8 gae_duplicate tensor(-0.1032, dtype=torch.float64) tensor(-3.1821, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3020, dtype=torch.float64) delta_t tensor(0.2083, dtype=torch.float64)
7 gae_duplicate tensor(-0.0729, dtype=torch.float64) tensor(-4.4762, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1471, dtype=torch.float64) delta_t tensor(0.3022, dtype=torch.float64)
6 gae_duplicate tensor(0.1018, dtype=torch.float64) tensor(-6.4047, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0617, dtype=torch.float64) delta_t tensor(0.3015, dtype=torch.float64)
5 gae_duplicate tensor(-0.0505, dtype=torch.float64) tensor(-6.7095, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.3435, dtype=torch.float64) delta_t tensor(-2.9626, dtype=torch.float64)
4 gae_duplicate tensor(-5.4692, dtype=torch.float64) tensor(57.7277, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0523, dtype=torch.float64) delta_t tensor(0.6425, dtype=torch.float64)
3 gae_duplicate tensor(0.1806, dtype=torch.float64) tensor(-6.8449, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2435, dtype=torch.float64) delta_t tensor(0.5068, dtype=torch.float64)
2 gae_duplicate tensor(0.1734, dtype=torch.float64) tensor(-10.8070, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1337.918701171875
value loss:117.50276947021484
entropies:355.7719421386719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.208040952682495 seconds
19 rew tensor(0.3408, dtype=torch.float64) delta_t tensor(0.2385, dtype=torch.float64)
19 gae_duplicate tensor(-0.0643, dtype=torch.float64) tensor(-4.7805, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5067, dtype=torch.float64) delta_t tensor(0.2584, dtype=torch.float64)
18 gae_duplicate tensor(0.1923, dtype=torch.float64) tensor(-5.5209, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2891, dtype=torch.float64) delta_t tensor(0.1383, dtype=torch.float64)
17 gae_duplicate tensor(-0.0880, dtype=torch.float64) tensor(-3.3237, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5136, dtype=torch.float64) delta_t tensor(0.2992, dtype=torch.float64)
16 gae_duplicate tensor(0.1860, dtype=torch.float64) tensor(-6.2405, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1893, dtype=torch.float64) delta_t tensor(0.0456, dtype=torch.float64)
15 gae_duplicate tensor(-0.0511, dtype=torch.float64) tensor(-1.5015, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5420, dtype=torch.float64) delta_t tensor(0.3674, dtype=torch.float64)
14 gae_duplicate tensor(0.2463, dtype=torch.float64) tensor(-7.4516, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1419, dtype=torch.float64) delta_t tensor(0.0226, dtype=torch.float64)
13 gae_duplicate tensor(-0.0244, dtype=torch.float64) tensor(-1.1859, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4980, dtype=torch.float64) delta_t tensor(0.2797, dtype=torch.float64)
12 gae_duplicate tensor(0.2287, dtype=torch.float64) tensor(-5.7076, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0838, dtype=torch.float64) delta_t tensor(0.0479, dtype=torch.float64)
11 gae_duplicate tensor(-0.1095, dtype=torch.float64) tensor(-1.4988, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5292, dtype=torch.float64) delta_t tensor(0.3054, dtype=torch.float64)
10 gae_duplicate tensor(0.2684, dtype=torch.float64) tensor(-6.2389, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0481, dtype=torch.float64) delta_t tensor(-0.0019, dtype=torch.float64)
9 gae_duplicate tensor(-0.0285, dtype=torch.float64) tensor(-0.5868, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4766, dtype=torch.float64) delta_t tensor(0.2344, dtype=torch.float64)
8 gae_duplicate tensor(0.1583, dtype=torch.float64) tensor(-4.6790, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0172, dtype=torch.float64) delta_t tensor(-0.1351, dtype=torch.float64)
7 gae_duplicate tensor(-0.2793, dtype=torch.float64) tensor(2.2071, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3867, dtype=torch.float64) delta_t tensor(0.4035, dtype=torch.float64)
6 gae_duplicate tensor(0.3041, dtype=torch.float64) tensor(-7.6879, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2539, dtype=torch.float64) delta_t tensor(0.2015, dtype=torch.float64)
5 gae_duplicate tensor(-0.1583, dtype=torch.float64) tensor(-4.7474, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.1277, dtype=torch.float64) delta_t tensor(-2.4934, dtype=torch.float64)
4 gae_duplicate tensor(-4.9219, dtype=torch.float64) tensor(49.1839, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1153, dtype=torch.float64) delta_t tensor(0.6300, dtype=torch.float64)
3 gae_duplicate tensor(0.0803, dtype=torch.float64) tensor(-7.5781, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1537, dtype=torch.float64) delta_t tensor(0.5885, dtype=torch.float64)
2 gae_duplicate tensor(0.3108, dtype=torch.float64) tensor(-12.2976, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1504.2413330078125
value loss:113.97305297851562
entropies:355.83221435546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.942553758621216 seconds
19 rew tensor(0.3912, dtype=torch.float64) delta_t tensor(0.1754, dtype=torch.float64)
19 gae_duplicate tensor(-0.0361, dtype=torch.float64) tensor(-3.4793, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4283, dtype=torch.float64) delta_t tensor(0.1915, dtype=torch.float64)
18 gae_duplicate tensor(0.0850, dtype=torch.float64) tensor(-4.1100, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2854, dtype=torch.float64) delta_t tensor(0.0578, dtype=torch.float64)
17 gae_duplicate tensor(-0.0667, dtype=torch.float64) tensor(-1.5519, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5358, dtype=torch.float64) delta_t tensor(0.1977, dtype=torch.float64)
16 gae_duplicate tensor(0.1501, dtype=torch.float64) tensor(-4.0784, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0722, dtype=torch.float64) delta_t tensor(-0.1333, dtype=torch.float64)
15 gae_duplicate tensor(-0.1821, dtype=torch.float64) tensor(2.2139, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5348, dtype=torch.float64) delta_t tensor(0.2726, dtype=torch.float64)
14 gae_duplicate tensor(0.1455, dtype=torch.float64) tensor(-5.1162, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0872, dtype=torch.float64) delta_t tensor(-0.0855, dtype=torch.float64)
13 gae_duplicate tensor(-0.1863, dtype=torch.float64) tensor(1.1736, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5289, dtype=torch.float64) delta_t tensor(0.2497, dtype=torch.float64)
12 gae_duplicate tensor(0.1233, dtype=torch.float64) tensor(-4.8116, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0659, dtype=torch.float64) delta_t tensor(-0.0115, dtype=torch.float64)
11 gae_duplicate tensor(-0.1652, dtype=torch.float64) tensor(-0.2232, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4740, dtype=torch.float64) delta_t tensor(0.2205, dtype=torch.float64)
10 gae_duplicate tensor(0.1801, dtype=torch.float64) tensor(-4.4268, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0343, dtype=torch.float64) delta_t tensor(-0.0895, dtype=torch.float64)
9 gae_duplicate tensor(-0.1669, dtype=torch.float64) tensor(1.3369, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4858, dtype=torch.float64) delta_t tensor(0.1833, dtype=torch.float64)
8 gae_duplicate tensor(0.0789, dtype=torch.float64) tensor(-3.5111, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0476, dtype=torch.float64) delta_t tensor(-0.1347, dtype=torch.float64)
7 gae_duplicate tensor(-0.4730, dtype=torch.float64) tensor(2.2949, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4146, dtype=torch.float64) delta_t tensor(0.3740, dtype=torch.float64)
6 gae_duplicate tensor(0.2671, dtype=torch.float64) tensor(-7.1167, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2323, dtype=torch.float64) delta_t tensor(-0.0478, dtype=torch.float64)
5 gae_duplicate tensor(-0.3464, dtype=torch.float64) tensor(0.2411, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-6.3702, dtype=torch.float64) delta_t tensor(-5.8459, dtype=torch.float64)
4 gae_duplicate tensor(-9.1668, dtype=torch.float64) tensor(115.6332, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1550, dtype=torch.float64) delta_t tensor(0.6007, dtype=torch.float64)
3 gae_duplicate tensor(-0.1841, dtype=torch.float64) tensor(-0.2997, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1551, dtype=torch.float64) delta_t tensor(0.5616, dtype=torch.float64)
2 gae_duplicate tensor(0.3998, dtype=torch.float64) tensor(-11.1101, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4041.250244140625
value loss:356.18701171875
entropies:355.8536682128906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.903904676437378 seconds
19 rew tensor(0.5142, dtype=torch.float64) delta_t tensor(0.2777, dtype=torch.float64)
19 gae_duplicate tensor(0.0728, dtype=torch.float64) tensor(-5.5171, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3749, dtype=torch.float64) delta_t tensor(0.1667, dtype=torch.float64)
18 gae_duplicate tensor(0.0214, dtype=torch.float64) tensor(-3.8899, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4364, dtype=torch.float64) delta_t tensor(0.3919, dtype=torch.float64)
17 gae_duplicate tensor(0.1234, dtype=torch.float64) tensor(-8.2082, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3862, dtype=torch.float64) delta_t tensor(0.0835, dtype=torch.float64)
16 gae_duplicate tensor(-0.0092, dtype=torch.float64) tensor(-2.4977, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2154, dtype=torch.float64) delta_t tensor(0.0884, dtype=torch.float64)
15 gae_duplicate tensor(-0.1337, dtype=torch.float64) tensor(-1.9794, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4489, dtype=torch.float64) delta_t tensor(0.2008, dtype=torch.float64)
14 gae_duplicate tensor(-0.0124, dtype=torch.float64) tensor(-4.1756, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1186, dtype=torch.float64) delta_t tensor(0.0139, dtype=torch.float64)
13 gae_duplicate tensor(-0.1228, dtype=torch.float64) tensor(-0.6936, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4413, dtype=torch.float64) delta_t tensor(0.1430, dtype=torch.float64)
12 gae_duplicate tensor(-0.0144, dtype=torch.float64) tensor(-2.9360, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0979, dtype=torch.float64) delta_t tensor(0.0266, dtype=torch.float64)
11 gae_duplicate tensor(-0.1362, dtype=torch.float64) tensor(-0.8115, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4216, dtype=torch.float64) delta_t tensor(0.1740, dtype=torch.float64)
10 gae_duplicate tensor(0.0310, dtype=torch.float64) tensor(-3.5267, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0578, dtype=torch.float64) delta_t tensor(0.0508, dtype=torch.float64)
9 gae_duplicate tensor(-0.1607, dtype=torch.float64) tensor(-1.3931, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4129, dtype=torch.float64) delta_t tensor(0.1883, dtype=torch.float64)
8 gae_duplicate tensor(0.1026, dtype=torch.float64) tensor(-3.8463, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0236, dtype=torch.float64) delta_t tensor(-0.1270, dtype=torch.float64)
7 gae_duplicate tensor(-0.4312, dtype=torch.float64) tensor(2.0863, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1930, dtype=torch.float64) delta_t tensor(0.2447, dtype=torch.float64)
6 gae_duplicate tensor(-0.4054, dtype=torch.float64) tensor(-4.5937, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2191, dtype=torch.float64) delta_t tensor(0.1927, dtype=torch.float64)
5 gae_duplicate tensor(-0.3454, dtype=torch.float64) tensor(-4.2882, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.3320, dtype=torch.float64) delta_t tensor(-1.8917, dtype=torch.float64)
4 gae_duplicate tensor(-6.5314, dtype=torch.float64) tensor(37.2768, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0004, dtype=torch.float64) delta_t tensor(0.6261, dtype=torch.float64)
3 gae_duplicate tensor(0.1206, dtype=torch.float64) tensor(-8.6379, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2384, dtype=torch.float64) delta_t tensor(0.5605, dtype=torch.float64)
2 gae_duplicate tensor(0.3305, dtype=torch.float64) tensor(-11.9370, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1500.63671875
value loss:101.39348602294922
entropies:355.8470764160156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.302509069442749 seconds
19 rew tensor(0.3930, dtype=torch.float64) delta_t tensor(0.1160, dtype=torch.float64)
19 gae_duplicate tensor(-0.1742, dtype=torch.float64) tensor(-2.3148, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3963, dtype=torch.float64) delta_t tensor(0.1173, dtype=torch.float64)
18 gae_duplicate tensor(0.0300, dtype=torch.float64) tensor(-2.5384, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3189, dtype=torch.float64) delta_t tensor(0.0970, dtype=torch.float64)
17 gae_duplicate tensor(-0.0023, dtype=torch.float64) tensor(-2.1733, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4696, dtype=torch.float64) delta_t tensor(0.0973, dtype=torch.float64)
16 gae_duplicate tensor(-0.0969, dtype=torch.float64) tensor(-2.1649, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1589, dtype=torch.float64) delta_t tensor(-0.0957, dtype=torch.float64)
15 gae_duplicate tensor(-0.2053, dtype=torch.float64) tensor(1.6637, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4910, dtype=torch.float64) delta_t tensor(0.2322, dtype=torch.float64)
14 gae_duplicate tensor(-0.0743, dtype=torch.float64) tensor(-4.4874, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1674, dtype=torch.float64) delta_t tensor(-0.0883, dtype=torch.float64)
13 gae_duplicate tensor(-0.2032, dtype=torch.float64) tensor(1.2908, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4626, dtype=torch.float64) delta_t tensor(0.1367, dtype=torch.float64)
12 gae_duplicate tensor(-0.0649, dtype=torch.float64) tensor(-2.5523, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1243, dtype=torch.float64) delta_t tensor(-0.0489, dtype=torch.float64)
11 gae_duplicate tensor(-0.2080, dtype=torch.float64) tensor(0.7127, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4394, dtype=torch.float64) delta_t tensor(0.1365, dtype=torch.float64)
10 gae_duplicate tensor(-0.0111, dtype=torch.float64) tensor(-2.6349, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0646, dtype=torch.float64) delta_t tensor(-0.0598, dtype=torch.float64)
9 gae_duplicate tensor(-0.2072, dtype=torch.float64) tensor(0.9357, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4482, dtype=torch.float64) delta_t tensor(0.1229, dtype=torch.float64)
8 gae_duplicate tensor(0.0575, dtype=torch.float64) tensor(-2.3553, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0055, dtype=torch.float64) delta_t tensor(-0.0902, dtype=torch.float64)
7 gae_duplicate tensor(-0.2719, dtype=torch.float64) tensor(1.6036, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3617, dtype=torch.float64) delta_t tensor(0.3904, dtype=torch.float64)
6 gae_duplicate tensor(0.2807, dtype=torch.float64) tensor(-7.5741, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1829, dtype=torch.float64) delta_t tensor(-0.1178, dtype=torch.float64)
5 gae_duplicate tensor(-0.5338, dtype=torch.float64) tensor(1.6191, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2910, dtype=torch.float64) delta_t tensor(-0.8314, dtype=torch.float64)
4 gae_duplicate tensor(-3.5847, dtype=torch.float64) tensor(16.3570, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1913, dtype=torch.float64) delta_t tensor(0.5644, dtype=torch.float64)
3 gae_duplicate tensor(0.2499, dtype=torch.float64) tensor(-9.5895, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2988, dtype=torch.float64) delta_t tensor(0.3826, dtype=torch.float64)
2 gae_duplicate tensor(0.2403, dtype=torch.float64) tensor(-8.4858, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1129.07470703125
value loss:34.866302490234375
entropies:355.8441162109375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3963.2710)
ToM Target loss= tensor(3518.4419)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.1754491329193115 seconds
19 rew tensor(0.3819, dtype=torch.float64) delta_t tensor(0.0409, dtype=torch.float64)
19 gae_duplicate tensor(-0.2345, dtype=torch.float64) tensor(-0.8242, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3868, dtype=torch.float64) delta_t tensor(0.0374, dtype=torch.float64)
18 gae_duplicate tensor(-0.0228, dtype=torch.float64) tensor(-0.8097, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.3529, dtype=torch.float64) delta_t tensor(0.1347, dtype=torch.float64)
17 gae_duplicate tensor(-0.1814, dtype=torch.float64) tensor(-2.7401, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4252, dtype=torch.float64) delta_t tensor(0.0181, dtype=torch.float64)
16 gae_duplicate tensor(-0.1426, dtype=torch.float64) tensor(-0.6299, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2166, dtype=torch.float64) delta_t tensor(-0.0738, dtype=torch.float64)
15 gae_duplicate tensor(-0.2746, dtype=torch.float64) tensor(1.4062, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4205, dtype=torch.float64) delta_t tensor(0.0628, dtype=torch.float64)
14 gae_duplicate tensor(-0.1037, dtype=torch.float64) tensor(-1.0968, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2454, dtype=torch.float64) delta_t tensor(-0.0099, dtype=torch.float64)
13 gae_duplicate tensor(-0.2460, dtype=torch.float64) tensor(0.0959, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4412, dtype=torch.float64) delta_t tensor(0.0756, dtype=torch.float64)
12 gae_duplicate tensor(-0.1132, dtype=torch.float64) tensor(-1.4770, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2381, dtype=torch.float64) delta_t tensor(0.0210, dtype=torch.float64)
11 gae_duplicate tensor(-0.1478, dtype=torch.float64) tensor(-0.5550, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4132, dtype=torch.float64) delta_t tensor(0.0532, dtype=torch.float64)
10 gae_duplicate tensor(-0.1216, dtype=torch.float64) tensor(-1.1112, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2184, dtype=torch.float64) delta_t tensor(0.0336, dtype=torch.float64)
9 gae_duplicate tensor(-0.1643, dtype=torch.float64) tensor(-0.7671, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3984, dtype=torch.float64) delta_t tensor(0.0936, dtype=torch.float64)
8 gae_duplicate tensor(0.0389, dtype=torch.float64) tensor(-1.9311, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2037, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
7 gae_duplicate tensor(-0.1310, dtype=torch.float64) tensor(-0.9276, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3119, dtype=torch.float64) delta_t tensor(0.2206, dtype=torch.float64)
6 gae_duplicate tensor(0.1819, dtype=torch.float64) tensor(-4.4659, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0003, dtype=torch.float64) delta_t tensor(0.1076, dtype=torch.float64)
5 gae_duplicate tensor(-0.2912, dtype=torch.float64) tensor(-2.5985, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-3.5257, dtype=torch.float64) delta_t tensor(-3.0776, dtype=torch.float64)
4 gae_duplicate tensor(-5.1086, dtype=torch.float64) tensor(60.9198, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1219, dtype=torch.float64) delta_t tensor(0.7207, dtype=torch.float64)
3 gae_duplicate tensor(0.1387, dtype=torch.float64) tensor(-8.2343, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2584, dtype=torch.float64) delta_t tensor(0.4104, dtype=torch.float64)
2 gae_duplicate tensor(0.2768, dtype=torch.float64) tensor(-8.8641, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1467.114990234375
value loss:102.68798065185547
entropies:355.86181640625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0991370677948 seconds
19 rew tensor(0.2802, dtype=torch.float64) delta_t tensor(-0.1304, dtype=torch.float64)
19 gae_duplicate tensor(-0.3479, dtype=torch.float64) tensor(2.5687, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4619, dtype=torch.float64) delta_t tensor(0.1046, dtype=torch.float64)
18 gae_duplicate tensor(-0.1075, dtype=torch.float64) tensor(-1.7841, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2340, dtype=torch.float64) delta_t tensor(-0.1062, dtype=torch.float64)
17 gae_duplicate tensor(-0.3707, dtype=torch.float64) tensor(1.9180, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4933, dtype=torch.float64) delta_t tensor(0.2248, dtype=torch.float64)
16 gae_duplicate tensor(0.0426, dtype=torch.float64) tensor(-4.2516, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1668, dtype=torch.float64) delta_t tensor(-0.1296, dtype=torch.float64)
15 gae_duplicate tensor(-0.3106, dtype=torch.float64) tensor(2.1453, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4815, dtype=torch.float64) delta_t tensor(0.1343, dtype=torch.float64)
14 gae_duplicate tensor(0.0552, dtype=torch.float64) tensor(-2.4480, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1605, dtype=torch.float64) delta_t tensor(0.0108, dtype=torch.float64)
13 gae_duplicate tensor(-0.2322, dtype=torch.float64) tensor(-0.4591, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5018, dtype=torch.float64) delta_t tensor(0.2664, dtype=torch.float64)
12 gae_duplicate tensor(0.0024, dtype=torch.float64) tensor(-5.3459, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1824, dtype=torch.float64) delta_t tensor(-0.0018, dtype=torch.float64)
11 gae_duplicate tensor(-0.2853, dtype=torch.float64) tensor(-0.4832, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4883, dtype=torch.float64) delta_t tensor(0.1281, dtype=torch.float64)
10 gae_duplicate tensor(0.0551, dtype=torch.float64) tensor(-2.5852, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1396, dtype=torch.float64) delta_t tensor(0.0018, dtype=torch.float64)
9 gae_duplicate tensor(-0.1896, dtype=torch.float64) tensor(-0.2881, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4667, dtype=torch.float64) delta_t tensor(0.1244, dtype=torch.float64)
8 gae_duplicate tensor(0.0362, dtype=torch.float64) tensor(-2.4745, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1402, dtype=torch.float64) delta_t tensor(-0.1138, dtype=torch.float64)
7 gae_duplicate tensor(-0.3621, dtype=torch.float64) tensor(1.9838, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3802, dtype=torch.float64) delta_t tensor(0.2715, dtype=torch.float64)
6 gae_duplicate tensor(0.1211, dtype=torch.float64) tensor(-5.2214, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0771, dtype=torch.float64) delta_t tensor(0.3280, dtype=torch.float64)
5 gae_duplicate tensor(-0.2598, dtype=torch.float64) tensor(-7.0272, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-4.1065, dtype=torch.float64) delta_t tensor(-3.3088, dtype=torch.float64)
4 gae_duplicate tensor(-5.2574, dtype=torch.float64) tensor(64.0327, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0737, dtype=torch.float64) delta_t tensor(0.7663, dtype=torch.float64)
3 gae_duplicate tensor(0.1812, dtype=torch.float64) tensor(-8.7038, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1997, dtype=torch.float64) delta_t tensor(0.4277, dtype=torch.float64)
2 gae_duplicate tensor(0.2195, dtype=torch.float64) tensor(-9.2320, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1302.673583984375
value loss:124.39568328857422
entropies:355.8530578613281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.900815963745117 seconds
19 rew tensor(0.4369, dtype=torch.float64) delta_t tensor(-0.0014, dtype=torch.float64)
19 gae_duplicate tensor(-0.2122, dtype=torch.float64) tensor(0.0001, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.2771, dtype=torch.float64) delta_t tensor(-0.0634, dtype=torch.float64)
18 gae_duplicate tensor(-0.3072, dtype=torch.float64) tensor(1.2494, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4150, dtype=torch.float64) delta_t tensor(-0.0150, dtype=torch.float64)
17 gae_duplicate tensor(-0.1358, dtype=torch.float64) tensor(0.4158, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2864, dtype=torch.float64) delta_t tensor(-0.0808, dtype=torch.float64)
16 gae_duplicate tensor(-0.3224, dtype=torch.float64) tensor(1.6212, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0771, dtype=torch.float64) delta_t tensor(-0.2844, dtype=torch.float64)
15 gae_duplicate tensor(-1.7222, dtype=torch.float64) tensor(5.8764, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1306, dtype=torch.float64) delta_t tensor(-0.2605, dtype=torch.float64)
14 gae_duplicate tensor(-0.7918, dtype=torch.float64) tensor(5.7171, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4066, dtype=torch.float64) delta_t tensor(-0.0267, dtype=torch.float64)
13 gae_duplicate tensor(-0.2688, dtype=torch.float64) tensor(1.0967, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2937, dtype=torch.float64) delta_t tensor(-0.0865, dtype=torch.float64)
12 gae_duplicate tensor(-0.2635, dtype=torch.float64) tensor(1.8399, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3992, dtype=torch.float64) delta_t tensor(-0.0680, dtype=torch.float64)
11 gae_duplicate tensor(-0.2163, dtype=torch.float64) tensor(1.5165, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2864, dtype=torch.float64) delta_t tensor(-0.0155, dtype=torch.float64)
10 gae_duplicate tensor(-0.2688, dtype=torch.float64) tensor(0.4867, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3717, dtype=torch.float64) delta_t tensor(0.0994, dtype=torch.float64)
9 gae_duplicate tensor(-0.1867, dtype=torch.float64) tensor(-1.9080, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2511, dtype=torch.float64) delta_t tensor(0.0737, dtype=torch.float64)
8 gae_duplicate tensor(0.0072, dtype=torch.float64) tensor(-1.6433, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3642, dtype=torch.float64) delta_t tensor(-0.0118, dtype=torch.float64)
7 gae_duplicate tensor(-0.2132, dtype=torch.float64) tensor(0.0797, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1725, dtype=torch.float64) delta_t tensor(0.0980, dtype=torch.float64)
6 gae_duplicate tensor(-0.1545, dtype=torch.float64) tensor(-1.9268, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1498, dtype=torch.float64) delta_t tensor(0.3696, dtype=torch.float64)
5 gae_duplicate tensor(-0.2368, dtype=torch.float64) tensor(-7.4542, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.4618, dtype=torch.float64) delta_t tensor(-2.1832, dtype=torch.float64)
4 gae_duplicate tensor(-5.2035, dtype=torch.float64) tensor(42.3136, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0265, dtype=torch.float64) delta_t tensor(0.7854, dtype=torch.float64)
3 gae_duplicate tensor(0.2551, dtype=torch.float64) tensor(-11.2706, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3328, dtype=torch.float64) delta_t tensor(0.3628, dtype=torch.float64)
2 gae_duplicate tensor(0.3885, dtype=torch.float64) tensor(-8.2731, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1701.88330078125
value loss:98.5331802368164
entropies:355.87078857421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.980050802230835 seconds
19 rew tensor(0.4540, dtype=torch.float64) delta_t tensor(0.1038, dtype=torch.float64)
19 gae_duplicate tensor(-0.2471, dtype=torch.float64) tensor(-2.0198, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3895, dtype=torch.float64) delta_t tensor(0.1117, dtype=torch.float64)
18 gae_duplicate tensor(-0.0992, dtype=torch.float64) tensor(-2.3759, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2803, dtype=torch.float64) delta_t tensor(-0.0926, dtype=torch.float64)
17 gae_duplicate tensor(-0.9689, dtype=torch.float64) tensor(1.5892, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4472, dtype=torch.float64) delta_t tensor(-0.0284, dtype=torch.float64)
16 gae_duplicate tensor(-0.1977, dtype=torch.float64) tensor(0.7144, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0265, dtype=torch.float64) delta_t tensor(-0.4252, dtype=torch.float64)
15 gae_duplicate tensor(-1.7864, dtype=torch.float64) tensor(8.4199, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4552, dtype=torch.float64) delta_t tensor(0.1517, dtype=torch.float64)
14 gae_duplicate tensor(-0.1349, dtype=torch.float64) tensor(-2.1139, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2505, dtype=torch.float64) delta_t tensor(-0.1584, dtype=torch.float64)
13 gae_duplicate tensor(-0.4057, dtype=torch.float64) tensor(2.8948, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4480, dtype=torch.float64) delta_t tensor(0.0282, dtype=torch.float64)
12 gae_duplicate tensor(-0.2290, dtype=torch.float64) tensor(-0.2643, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2362, dtype=torch.float64) delta_t tensor(-0.1192, dtype=torch.float64)
11 gae_duplicate tensor(-0.2489, dtype=torch.float64) tensor(2.3450, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4559, dtype=torch.float64) delta_t tensor(-0.0112, dtype=torch.float64)
10 gae_duplicate tensor(-0.1967, dtype=torch.float64) tensor(0.4444, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1815, dtype=torch.float64) delta_t tensor(-0.4428, dtype=torch.float64)
9 gae_duplicate tensor(-2.2964, dtype=torch.float64) tensor(8.7954, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3971, dtype=torch.float64) delta_t tensor(0.0439, dtype=torch.float64)
8 gae_duplicate tensor(-0.1713, dtype=torch.float64) tensor(0.0153, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1928, dtype=torch.float64) delta_t tensor(-0.0904, dtype=torch.float64)
7 gae_duplicate tensor(-0.3124, dtype=torch.float64) tensor(1.7797, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1563, dtype=torch.float64) delta_t tensor(0.1583, dtype=torch.float64)
6 gae_duplicate tensor(-0.4927, dtype=torch.float64) tensor(-2.8963, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3396, dtype=torch.float64) delta_t tensor(-0.1132, dtype=torch.float64)
5 gae_duplicate tensor(-1.1372, dtype=torch.float64) tensor(1.8864, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7837, dtype=torch.float64) delta_t tensor(-1.3758, dtype=torch.float64)
4 gae_duplicate tensor(-2.5595, dtype=torch.float64) tensor(27.2815, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0175, dtype=torch.float64) delta_t tensor(0.6979, dtype=torch.float64)
3 gae_duplicate tensor(0.3276, dtype=torch.float64) tensor(-10.9776, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3834, dtype=torch.float64) delta_t tensor(0.2856, dtype=torch.float64)
2 gae_duplicate tensor(0.1216, dtype=torch.float64) tensor(-6.7417, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1650.015869140625
value loss:52.94709396362305
entropies:355.8743591308594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.096925973892212 seconds
19 rew tensor(0.3202, dtype=torch.float64) delta_t tensor(-0.0994, dtype=torch.float64)
19 gae_duplicate tensor(-0.1923, dtype=torch.float64) tensor(1.9527, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5093, dtype=torch.float64) delta_t tensor(0.0311, dtype=torch.float64)
18 gae_duplicate tensor(-0.0545, dtype=torch.float64) tensor(-0.4226, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.2965, dtype=torch.float64) delta_t tensor(-0.0434, dtype=torch.float64)
17 gae_duplicate tensor(-0.1830, dtype=torch.float64) tensor(0.8168, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5340, dtype=torch.float64) delta_t tensor(0.0628, dtype=torch.float64)
16 gae_duplicate tensor(-0.0076, dtype=torch.float64) tensor(-1.1566, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1980, dtype=torch.float64) delta_t tensor(-0.0152, dtype=torch.float64)
15 gae_duplicate tensor(-0.2272, dtype=torch.float64) tensor(0.1808, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5349, dtype=torch.float64) delta_t tensor(0.0805, dtype=torch.float64)
14 gae_duplicate tensor(-0.0093, dtype=torch.float64) tensor(-1.5846, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1553, dtype=torch.float64) delta_t tensor(-0.1036, dtype=torch.float64)
13 gae_duplicate tensor(-0.3043, dtype=torch.float64) tensor(1.8767, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5428, dtype=torch.float64) delta_t tensor(0.0544, dtype=torch.float64)
12 gae_duplicate tensor(-0.0196, dtype=torch.float64) tensor(-0.8749, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1470, dtype=torch.float64) delta_t tensor(-0.0920, dtype=torch.float64)
11 gae_duplicate tensor(-0.2055, dtype=torch.float64) tensor(1.7418, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5270, dtype=torch.float64) delta_t tensor(0.0814, dtype=torch.float64)
10 gae_duplicate tensor(0.0225, dtype=torch.float64) tensor(-1.4212, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1487, dtype=torch.float64) delta_t tensor(-0.1197, dtype=torch.float64)
9 gae_duplicate tensor(-0.2595, dtype=torch.float64) tensor(2.2084, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5062, dtype=torch.float64) delta_t tensor(0.0209, dtype=torch.float64)
8 gae_duplicate tensor(-0.0318, dtype=torch.float64) tensor(-0.1951, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1198, dtype=torch.float64) delta_t tensor(-0.2236, dtype=torch.float64)
7 gae_duplicate tensor(-0.4286, dtype=torch.float64) tensor(4.4393, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4132, dtype=torch.float64) delta_t tensor(0.2132, dtype=torch.float64)
6 gae_duplicate tensor(0.0481, dtype=torch.float64) tensor(-3.7491, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0752, dtype=torch.float64) delta_t tensor(0.3716, dtype=torch.float64)
5 gae_duplicate tensor(-0.0567, dtype=torch.float64) tensor(-7.7514, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.9264, dtype=torch.float64) delta_t tensor(-1.9758, dtype=torch.float64)
4 gae_duplicate tensor(-5.4876, dtype=torch.float64) tensor(38.5151, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1121, dtype=torch.float64) delta_t tensor(0.7731, dtype=torch.float64)
3 gae_duplicate tensor(0.0218, dtype=torch.float64) tensor(-11.3977, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2111, dtype=torch.float64) delta_t tensor(0.4344, dtype=torch.float64)
2 gae_duplicate tensor(0.2554, dtype=torch.float64) tensor(-9.7185, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-822.9090576171875
value loss:95.2527084350586
entropies:355.8773193359375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3956.6855)
ToM Target loss= tensor(3528.3169)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.607818841934204 seconds
19 rew tensor(0.5468, dtype=torch.float64) delta_t tensor(0.5870, dtype=torch.float64)
19 gae_duplicate tensor(0.0513, dtype=torch.float64) tensor(-11.5240, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4165, dtype=torch.float64) delta_t tensor(0.1281, dtype=torch.float64)
18 gae_duplicate tensor(-0.1664, dtype=torch.float64) tensor(-3.6947, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4734, dtype=torch.float64) delta_t tensor(0.3330, dtype=torch.float64)
17 gae_duplicate tensor(-0.0154, dtype=torch.float64) tensor(-7.0501, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4176, dtype=torch.float64) delta_t tensor(0.0914, dtype=torch.float64)
16 gae_duplicate tensor(-0.1831, dtype=torch.float64) tensor(-2.5469, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2733, dtype=torch.float64) delta_t tensor(0.0118, dtype=torch.float64)
15 gae_duplicate tensor(-0.3265, dtype=torch.float64) tensor(-0.4870, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4493, dtype=torch.float64) delta_t tensor(0.1261, dtype=torch.float64)
14 gae_duplicate tensor(-0.1128, dtype=torch.float64) tensor(-2.5784, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2660, dtype=torch.float64) delta_t tensor(0.0139, dtype=torch.float64)
13 gae_duplicate tensor(-0.2803, dtype=torch.float64) tensor(-0.4917, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4366, dtype=torch.float64) delta_t tensor(0.0944, dtype=torch.float64)
12 gae_duplicate tensor(-0.1883, dtype=torch.float64) tensor(-1.9431, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2467, dtype=torch.float64) delta_t tensor(0.1204, dtype=torch.float64)
11 gae_duplicate tensor(-0.3611, dtype=torch.float64) tensor(-2.5784, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4079, dtype=torch.float64) delta_t tensor(0.1383, dtype=torch.float64)
10 gae_duplicate tensor(-0.1607, dtype=torch.float64) tensor(-2.9918, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1036, dtype=torch.float64) delta_t tensor(-0.0868, dtype=torch.float64)
9 gae_duplicate tensor(-1.0774, dtype=torch.float64) tensor(1.3370, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6339, dtype=torch.float64) delta_t tensor(-0.8952, dtype=torch.float64)
8 gae_duplicate tensor(-5.6920, dtype=torch.float64) tensor(18.1319, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0084, dtype=torch.float64) delta_t tensor(-0.0356, dtype=torch.float64)
7 gae_duplicate tensor(-0.8633, dtype=torch.float64) tensor(2.5547, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2816, dtype=torch.float64) delta_t tensor(0.2029, dtype=torch.float64)
6 gae_duplicate tensor(-0.0657, dtype=torch.float64) tensor(-3.7384, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4022, dtype=torch.float64) delta_t tensor(-0.2763, dtype=torch.float64)
5 gae_duplicate tensor(-1.7865, dtype=torch.float64) tensor(5.1688, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2933, dtype=torch.float64) delta_t tensor(-0.9492, dtype=torch.float64)
4 gae_duplicate tensor(-3.7587, dtype=torch.float64) tensor(18.9907, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1657, dtype=torch.float64) delta_t tensor(0.5736, dtype=torch.float64)
3 gae_duplicate tensor(-0.1298, dtype=torch.float64) tensor(-9.3677, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2823, dtype=torch.float64) delta_t tensor(0.3910, dtype=torch.float64)
2 gae_duplicate tensor(0.1105, dtype=torch.float64) tensor(-8.6984, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:525.3267211914062
value loss:112.18714904785156
entropies:355.8631286621094
Policy training finished
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt