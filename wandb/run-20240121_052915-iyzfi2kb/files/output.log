obs <crafter.objects.Shelter object at 0x168b8d070> [39.  0.  0.  0. 39.  0.  0.  0.  8.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x12753b9d0> [36.  0.  0.  0. 37.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x168b95640> [ 9.  0.  0.  0.  9.  0.  0.  0. 12.  0.  0.  0.]
obs <crafter.objects.Shelter object at 0x168b8d070> [39.  0.  0.  0. 39.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x12753b9d0> [43.  0.  0.  0. 41.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x168b95640> [ 9.  0.  0.  0.  9.  0.  0.  0. 13.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.002273082733154297 seconds
19 rew tensor(0.8822, dtype=torch.float64) delta_t tensor(1.0396, dtype=torch.float64)
19 gae_duplicate tensor(0.8827, dtype=torch.float64) tensor(-20.4484, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(1.0109, dtype=torch.float64)
18 gae_duplicate tensor(0.9367, dtype=torch.float64) tensor(-22.0054, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9222, dtype=torch.float64) delta_t tensor(0.9754, dtype=torch.float64)
17 gae_duplicate tensor(0.8959, dtype=torch.float64) tensor(-21.4645, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9002, dtype=torch.float64) delta_t tensor(0.9530, dtype=torch.float64)
16 gae_duplicate tensor(0.9194, dtype=torch.float64) tensor(-20.8214, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7956, dtype=torch.float64) delta_t tensor(0.9043, dtype=torch.float64)
15 gae_duplicate tensor(0.5141, dtype=torch.float64) tensor(-20.1119, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.1434, dtype=torch.float64) delta_t tensor(1.2481, dtype=torch.float64)
14 gae_duplicate tensor(1.0853, dtype=torch.float64) tensor(-26.4637, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.2472, dtype=torch.float64) delta_t tensor(1.3412, dtype=torch.float64)
13 gae_duplicate tensor(1.1532, dtype=torch.float64) tensor(-28.6687, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.3878, dtype=torch.float64) delta_t tensor(1.6200, dtype=torch.float64)
12 gae_duplicate tensor(1.4786, dtype=torch.float64) tensor(-35.0332, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.5255, dtype=torch.float64) delta_t tensor(1.6009, dtype=torch.float64)
11 gae_duplicate tensor(1.3289, dtype=torch.float64) tensor(-35.1065, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(1.1240, dtype=torch.float64) delta_t tensor(1.2574, dtype=torch.float64)
10 gae_duplicate tensor(0.7162, dtype=torch.float64) tensor(-28.0714, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(1.0657, dtype=torch.float64) delta_t tensor(1.1554, dtype=torch.float64)
9 gae_duplicate tensor(0.2866, dtype=torch.float64) tensor(-25.8639, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2975, dtype=torch.float64) delta_t tensor(0.3582, dtype=torch.float64)
8 gae_duplicate tensor(-1.9426, dtype=torch.float64) tensor(-9.2362, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(1.5115, dtype=torch.float64) delta_t tensor(1.4580, dtype=torch.float64)
7 gae_duplicate tensor(0.6283, dtype=torch.float64) tensor(-29.6645, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.3035, dtype=torch.float64) delta_t tensor(1.3116, dtype=torch.float64)
6 gae_duplicate tensor(0.1934, dtype=torch.float64) tensor(-28.9208, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4329, dtype=torch.float64) delta_t tensor(0.5136, dtype=torch.float64)
5 gae_duplicate tensor(0.1281, dtype=torch.float64) tensor(-13.0105, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1673, dtype=torch.float64) delta_t tensor(-0.1097, dtype=torch.float64)
4 gae_duplicate tensor(-0.4853, dtype=torch.float64) tensor(0.9427, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9385, dtype=torch.float64) delta_t tensor(-0.8111, dtype=torch.float64)
3 gae_duplicate tensor(-1.0475, dtype=torch.float64) tensor(16.1291, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8650, dtype=torch.float64) delta_t tensor(-0.7365, dtype=torch.float64)
2 gae_duplicate tensor(-1.2257, dtype=torch.float64) tensor(16.0515, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:17819.408203125
value loss:277.704833984375
entropies:355.7687072753906
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 5.592036247253418 seconds
19 rew tensor(0.8609, dtype=torch.float64) delta_t tensor(0.8779, dtype=torch.float64)
19 gae_duplicate tensor(0.7577, dtype=torch.float64) tensor(-17.2506, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8495, dtype=torch.float64) delta_t tensor(0.8329, dtype=torch.float64)
18 gae_duplicate tensor(0.7552, dtype=torch.float64) tensor(-18.6106, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.7196, dtype=torch.float64)
17 gae_duplicate tensor(0.6213, dtype=torch.float64) tensor(-15.5421, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7040, dtype=torch.float64) delta_t tensor(0.5987, dtype=torch.float64)
16 gae_duplicate tensor(0.4474, dtype=torch.float64) tensor(-13.4681, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4551, dtype=torch.float64) delta_t tensor(0.4021, dtype=torch.float64)
15 gae_duplicate tensor(0.0768, dtype=torch.float64) tensor(-8.8326, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9776, dtype=torch.float64) delta_t tensor(0.9209, dtype=torch.float64)
14 gae_duplicate tensor(0.7698, dtype=torch.float64) tensor(-19.0352, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0066, dtype=torch.float64) delta_t tensor(0.9542, dtype=torch.float64)
13 gae_duplicate tensor(0.8601, dtype=torch.float64) tensor(-21.0483, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.0383, dtype=torch.float64) delta_t tensor(1.1790, dtype=torch.float64)
12 gae_duplicate tensor(1.0335, dtype=torch.float64) tensor(-25.3833, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.0547, dtype=torch.float64) delta_t tensor(0.9590, dtype=torch.float64)
11 gae_duplicate tensor(0.9100, dtype=torch.float64) tensor(-21.8822, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(1.0316, dtype=torch.float64) delta_t tensor(1.0412, dtype=torch.float64)
10 gae_duplicate tensor(0.9152, dtype=torch.float64) tensor(-22.8132, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0799, dtype=torch.float64) delta_t tensor(0.0316, dtype=torch.float64)
9 gae_duplicate tensor(-2.1454, dtype=torch.float64) tensor(-2.5416, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1878, dtype=torch.float64) delta_t tensor(-0.2454, dtype=torch.float64)
8 gae_duplicate tensor(-1.9239, dtype=torch.float64) tensor(4.8212, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0553, dtype=torch.float64) delta_t tensor(-0.1212, dtype=torch.float64)
7 gae_duplicate tensor(-2.0436, dtype=torch.float64) tensor(2.7267, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1625, dtype=torch.float64) delta_t tensor(0.1480, dtype=torch.float64)
6 gae_duplicate tensor(-0.0972, dtype=torch.float64) tensor(-2.6888, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7326, dtype=torch.float64) delta_t tensor(-0.7245, dtype=torch.float64)
5 gae_duplicate tensor(-1.0611, dtype=torch.float64) tensor(14.1307, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0598, dtype=torch.float64) delta_t tensor(-1.0909, dtype=torch.float64)
4 gae_duplicate tensor(-1.3558, dtype=torch.float64) tensor(23.0623, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3920, dtype=torch.float64) delta_t tensor(-1.3029, dtype=torch.float64)
3 gae_duplicate tensor(-1.8005, dtype=torch.float64) tensor(28.4996, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2828, dtype=torch.float64) delta_t tensor(-1.1883, dtype=torch.float64)
2 gae_duplicate tensor(-1.9393, dtype=torch.float64) tensor(26.2565, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4742.48291015625
value loss:168.99786376953125
entropies:355.1872863769531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.519407033920288 seconds
19 rew tensor(0.8675, dtype=torch.float64) delta_t tensor(0.5901, dtype=torch.float64)
19 gae_duplicate tensor(0.5145, dtype=torch.float64) tensor(-11.5906, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8489, dtype=torch.float64) delta_t tensor(0.5750, dtype=torch.float64)
18 gae_duplicate tensor(0.4852, dtype=torch.float64) tensor(-13.1076, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8299, dtype=torch.float64) delta_t tensor(0.4976, dtype=torch.float64)
17 gae_duplicate tensor(0.3536, dtype=torch.float64) tensor(-10.5310, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7478, dtype=torch.float64) delta_t tensor(0.4067, dtype=torch.float64)
16 gae_duplicate tensor(0.1675, dtype=torch.float64) tensor(-8.9456, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5494, dtype=torch.float64) delta_t tensor(0.2611, dtype=torch.float64)
15 gae_duplicate tensor(-0.1611, dtype=torch.float64) tensor(-6.0347, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9517, dtype=torch.float64) delta_t tensor(0.6590, dtype=torch.float64)
14 gae_duplicate tensor(0.5316, dtype=torch.float64) tensor(-13.1990, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9688, dtype=torch.float64) delta_t tensor(0.6697, dtype=torch.float64)
13 gae_duplicate tensor(0.6153, dtype=torch.float64) tensor(-14.2802, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9868, dtype=torch.float64) delta_t tensor(0.9978, dtype=torch.float64)
12 gae_duplicate tensor(0.8748, dtype=torch.float64) tensor(-21.7862, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.0059, dtype=torch.float64) delta_t tensor(0.6720, dtype=torch.float64)
11 gae_duplicate tensor(0.6260, dtype=torch.float64) tensor(-15.5204, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3223, dtype=torch.float64) delta_t tensor(0.0393, dtype=torch.float64)
10 gae_duplicate tensor(-1.6727, dtype=torch.float64) tensor(-2.1593, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0835, dtype=torch.float64) delta_t tensor(-0.1904, dtype=torch.float64)
9 gae_duplicate tensor(-2.2108, dtype=torch.float64) tensor(3.5617, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1800, dtype=torch.float64) delta_t tensor(-0.1571, dtype=torch.float64)
8 gae_duplicate tensor(-1.8798, dtype=torch.float64) tensor(2.9997, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2399, dtype=torch.float64) delta_t tensor(-0.5951, dtype=torch.float64)
7 gae_duplicate tensor(-3.3973, dtype=torch.float64) tensor(11.1535, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3275, dtype=torch.float64) delta_t tensor(-0.5054, dtype=torch.float64)
6 gae_duplicate tensor(-1.5014, dtype=torch.float64) tensor(11.2495, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1812, dtype=torch.float64) delta_t tensor(-1.3485, dtype=torch.float64)
5 gae_duplicate tensor(-3.2274, dtype=torch.float64) tensor(27.4142, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2636, dtype=torch.float64) delta_t tensor(-1.3789, dtype=torch.float64)
4 gae_duplicate tensor(-1.8452, dtype=torch.float64) tensor(29.5587, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5774, dtype=torch.float64) delta_t tensor(-1.5340, dtype=torch.float64)
3 gae_duplicate tensor(-2.3661, dtype=torch.float64) tensor(33.4395, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4072, dtype=torch.float64) delta_t tensor(-1.6304, dtype=torch.float64)
2 gae_duplicate tensor(-2.3223, dtype=torch.float64) tensor(35.5637, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2136.130126953125
value loss:189.65931701660156
entropies:354.456298828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.741186857223511 seconds
19 rew tensor(0.8604, dtype=torch.float64) delta_t tensor(0.3808, dtype=torch.float64)
19 gae_duplicate tensor(0.3043, dtype=torch.float64) tensor(-7.6995, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8375, dtype=torch.float64) delta_t tensor(0.3680, dtype=torch.float64)
18 gae_duplicate tensor(0.3041, dtype=torch.float64) tensor(-8.0464, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7938, dtype=torch.float64) delta_t tensor(0.2456, dtype=torch.float64)
17 gae_duplicate tensor(0.1649, dtype=torch.float64) tensor(-5.8649, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6748, dtype=torch.float64) delta_t tensor(0.1141, dtype=torch.float64)
16 gae_duplicate tensor(-0.0346, dtype=torch.float64) tensor(-2.9129, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4278, dtype=torch.float64) delta_t tensor(-0.1029, dtype=torch.float64)
15 gae_duplicate tensor(-0.4580, dtype=torch.float64) tensor(1.3562, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9373, dtype=torch.float64) delta_t tensor(0.3963, dtype=torch.float64)
14 gae_duplicate tensor(0.2966, dtype=torch.float64) tensor(-7.4458, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9494, dtype=torch.float64) delta_t tensor(0.4038, dtype=torch.float64)
13 gae_duplicate tensor(0.3411, dtype=torch.float64) tensor(-8.6856, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9619, dtype=torch.float64) delta_t tensor(0.8569, dtype=torch.float64)
12 gae_duplicate tensor(0.7485, dtype=torch.float64) tensor(-17.6650, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9750, dtype=torch.float64) delta_t tensor(0.4032, dtype=torch.float64)
11 gae_duplicate tensor(0.3965, dtype=torch.float64) tensor(-9.9504, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7648, dtype=torch.float64) delta_t tensor(0.3217, dtype=torch.float64)
10 gae_duplicate tensor(-0.7039, dtype=torch.float64) tensor(-7.5342, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2452, dtype=torch.float64) delta_t tensor(-0.6966, dtype=torch.float64)
9 gae_duplicate tensor(-2.2062, dtype=torch.float64) tensor(13.3770, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0343, dtype=torch.float64) delta_t tensor(-0.4325, dtype=torch.float64)
8 gae_duplicate tensor(-1.3944, dtype=torch.float64) tensor(10.0439, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2994, dtype=torch.float64) delta_t tensor(-0.7859, dtype=torch.float64)
7 gae_duplicate tensor(-2.2023, dtype=torch.float64) tensor(16.2288, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8498, dtype=torch.float64) delta_t tensor(-1.1538, dtype=torch.float64)
6 gae_duplicate tensor(-3.2318, dtype=torch.float64) tensor(24.1959, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0997, dtype=torch.float64) delta_t tensor(-1.3970, dtype=torch.float64)
5 gae_duplicate tensor(-4.0265, dtype=torch.float64) tensor(31.0930, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2203, dtype=torch.float64) delta_t tensor(-1.4264, dtype=torch.float64)
4 gae_duplicate tensor(-2.2835, dtype=torch.float64) tensor(30.3201, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3348, dtype=torch.float64) delta_t tensor(-1.4362, dtype=torch.float64)
3 gae_duplicate tensor(-1.8836, dtype=torch.float64) tensor(31.1735, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2159, dtype=torch.float64) delta_t tensor(-1.4050, dtype=torch.float64)
2 gae_duplicate tensor(-1.9751, dtype=torch.float64) tensor(30.3768, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6163.16357421875
value loss:184.26025390625
entropies:354.4335021972656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.016183137893677 seconds
19 rew tensor(0.8640, dtype=torch.float64) delta_t tensor(0.2301, dtype=torch.float64)
19 gae_duplicate tensor(0.1731, dtype=torch.float64) tensor(-4.6375, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8385, dtype=torch.float64) delta_t tensor(0.2338, dtype=torch.float64)
18 gae_duplicate tensor(0.1389, dtype=torch.float64) tensor(-4.9837, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7929, dtype=torch.float64) delta_t tensor(0.1229, dtype=torch.float64)
17 gae_duplicate tensor(-0.0044, dtype=torch.float64) tensor(-2.8949, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6709, dtype=torch.float64) delta_t tensor(-0.0052, dtype=torch.float64)
16 gae_duplicate tensor(-0.1936, dtype=torch.float64) tensor(-0.0687, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4196, dtype=torch.float64) delta_t tensor(-0.2497, dtype=torch.float64)
15 gae_duplicate tensor(-0.5947, dtype=torch.float64) tensor(4.8650, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9336, dtype=torch.float64) delta_t tensor(0.2638, dtype=torch.float64)
14 gae_duplicate tensor(0.1076, dtype=torch.float64) tensor(-4.7960, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9430, dtype=torch.float64) delta_t tensor(0.2714, dtype=torch.float64)
13 gae_duplicate tensor(0.1864, dtype=torch.float64) tensor(-5.7310, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9527, dtype=torch.float64) delta_t tensor(0.7689, dtype=torch.float64)
12 gae_duplicate tensor(0.6325, dtype=torch.float64) tensor(-15.2349, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9448, dtype=torch.float64) delta_t tensor(0.2369, dtype=torch.float64)
11 gae_duplicate tensor(0.2138, dtype=torch.float64) tensor(-6.3788, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2961, dtype=torch.float64) delta_t tensor(-0.2833, dtype=torch.float64)
10 gae_duplicate tensor(-2.0768, dtype=torch.float64) tensor(5.0351, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3173, dtype=torch.float64) delta_t tensor(-0.2262, dtype=torch.float64)
9 gae_duplicate tensor(-1.8713, dtype=torch.float64) tensor(4.5458, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1892, dtype=torch.float64) delta_t tensor(-0.3822, dtype=torch.float64)
8 gae_duplicate tensor(-2.3244, dtype=torch.float64) tensor(7.6942, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0520, dtype=torch.float64) delta_t tensor(-0.6102, dtype=torch.float64)
7 gae_duplicate tensor(-2.5439, dtype=torch.float64) tensor(13.4780, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1904, dtype=torch.float64) delta_t tensor(-0.5679, dtype=torch.float64)
6 gae_duplicate tensor(-1.1092, dtype=torch.float64) tensor(12.5925, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7720, dtype=torch.float64) delta_t tensor(-1.0694, dtype=torch.float64)
5 gae_duplicate tensor(-1.4583, dtype=torch.float64) tensor(22.9108, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1967, dtype=torch.float64) delta_t tensor(-1.4456, dtype=torch.float64)
4 gae_duplicate tensor(-2.1761, dtype=torch.float64) tensor(30.4797, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4521, dtype=torch.float64) delta_t tensor(-1.6090, dtype=torch.float64)
3 gae_duplicate tensor(-2.1711, dtype=torch.float64) tensor(35.1614, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2337, dtype=torch.float64) delta_t tensor(-1.5050, dtype=torch.float64)
2 gae_duplicate tensor(-2.4585, dtype=torch.float64) tensor(33.2270, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6860.03466796875
value loss:140.45989990234375
entropies:354.7430725097656
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3980.1560)
ToM Target loss= tensor(3525.6775)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.4234020709991455 seconds
19 rew tensor(0.8628, dtype=torch.float64) delta_t tensor(0.1678, dtype=torch.float64)
19 gae_duplicate tensor(0.0784, dtype=torch.float64) tensor(-3.2505, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8586, dtype=torch.float64) delta_t tensor(0.1914, dtype=torch.float64)
18 gae_duplicate tensor(0.0399, dtype=torch.float64) tensor(-4.1975, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(0.0653, dtype=torch.float64)
17 gae_duplicate tensor(-0.1089, dtype=torch.float64) tensor(-1.8916, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7230, dtype=torch.float64) delta_t tensor(-0.0437, dtype=torch.float64)
16 gae_duplicate tensor(-0.3009, dtype=torch.float64) tensor(0.7559, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5387, dtype=torch.float64) delta_t tensor(-0.2252, dtype=torch.float64)
15 gae_duplicate tensor(-0.7258, dtype=torch.float64) tensor(4.0227, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9195, dtype=torch.float64) delta_t tensor(0.1557, dtype=torch.float64)
14 gae_duplicate tensor(-0.0142, dtype=torch.float64) tensor(-2.6924, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9270, dtype=torch.float64) delta_t tensor(0.1597, dtype=torch.float64)
13 gae_duplicate tensor(0.0639, dtype=torch.float64) tensor(-3.4233, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9347, dtype=torch.float64) delta_t tensor(0.5306, dtype=torch.float64)
12 gae_duplicate tensor(0.0761, dtype=torch.float64) tensor(-11.0721, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9426, dtype=torch.float64) delta_t tensor(0.1306, dtype=torch.float64)
11 gae_duplicate tensor(0.0812, dtype=torch.float64) tensor(-3.5919, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9190, dtype=torch.float64) delta_t tensor(0.2810, dtype=torch.float64)
10 gae_duplicate tensor(0.0808, dtype=torch.float64) tensor(-5.7871, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5571, dtype=torch.float64) delta_t tensor(-1.1922, dtype=torch.float64)
9 gae_duplicate tensor(-4.7793, dtype=torch.float64) tensor(22.4174, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3588, dtype=torch.float64) delta_t tensor(-0.9733, dtype=torch.float64)
8 gae_duplicate tensor(-4.1000, dtype=torch.float64) tensor(20.8773, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3190, dtype=torch.float64) delta_t tensor(-0.2918, dtype=torch.float64)
7 gae_duplicate tensor(-0.6092, dtype=torch.float64) tensor(7.8052, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1283, dtype=torch.float64) delta_t tensor(-0.4872, dtype=torch.float64)
6 gae_duplicate tensor(-1.0151, dtype=torch.float64) tensor(10.2578, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7007, dtype=torch.float64) delta_t tensor(-0.9633, dtype=torch.float64)
5 gae_duplicate tensor(-1.1337, dtype=torch.float64) tensor(20.3012, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2997, dtype=torch.float64) delta_t tensor(-1.5254, dtype=torch.float64)
4 gae_duplicate tensor(-1.9377, dtype=torch.float64) tensor(32.3997, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4713, dtype=torch.float64) delta_t tensor(-1.4982, dtype=torch.float64)
3 gae_duplicate tensor(-1.9097, dtype=torch.float64) tensor(32.7954, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3320, dtype=torch.float64) delta_t tensor(-1.5589, dtype=torch.float64)
2 gae_duplicate tensor(-2.1224, dtype=torch.float64) tensor(33.3439, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-8145.5283203125
value loss:172.05282592773438
entropies:354.6325988769531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.062638998031616 seconds
19 rew tensor(0.8428, dtype=torch.float64) delta_t tensor(0.0517, dtype=torch.float64)
19 gae_duplicate tensor(-0.0119, dtype=torch.float64) tensor(-1.0049, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8286, dtype=torch.float64) delta_t tensor(0.0918, dtype=torch.float64)
18 gae_duplicate tensor(-0.0377, dtype=torch.float64) tensor(-1.9422, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7834, dtype=torch.float64) delta_t tensor(-0.0172, dtype=torch.float64)
17 gae_duplicate tensor(-0.1916, dtype=torch.float64) tensor(0.1261, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6685, dtype=torch.float64) delta_t tensor(-0.1716, dtype=torch.float64)
16 gae_duplicate tensor(-0.3746, dtype=torch.float64) tensor(3.3542, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4447, dtype=torch.float64) delta_t tensor(-0.3700, dtype=torch.float64)
15 gae_duplicate tensor(-0.8147, dtype=torch.float64) tensor(7.6886, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9016, dtype=torch.float64) delta_t tensor(0.0849, dtype=torch.float64)
14 gae_duplicate tensor(-0.1222, dtype=torch.float64) tensor(-0.9085, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9078, dtype=torch.float64) delta_t tensor(0.0544, dtype=torch.float64)
13 gae_duplicate tensor(-0.0477, dtype=torch.float64) tensor(-1.1663, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9140, dtype=torch.float64) delta_t tensor(0.5352, dtype=torch.float64)
12 gae_duplicate tensor(0.1856, dtype=torch.float64) tensor(-10.8041, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9204, dtype=torch.float64) delta_t tensor(0.0421, dtype=torch.float64)
11 gae_duplicate tensor(-0.0242, dtype=torch.float64) tensor(-1.8945, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9168, dtype=torch.float64) delta_t tensor(0.2146, dtype=torch.float64)
10 gae_duplicate tensor(0.1636, dtype=torch.float64) tensor(-4.4126, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0893, dtype=torch.float64) delta_t tensor(-1.7940, dtype=torch.float64)
9 gae_duplicate tensor(-5.6918, dtype=torch.float64) tensor(34.6180, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2304, dtype=torch.float64) delta_t tensor(-0.9286, dtype=torch.float64)
8 gae_duplicate tensor(-3.9455, dtype=torch.float64) tensor(20.7518, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4787, dtype=torch.float64) delta_t tensor(-1.1537, dtype=torch.float64)
7 gae_duplicate tensor(-4.0094, dtype=torch.float64) tensor(25.9484, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2344, dtype=torch.float64) delta_t tensor(-0.6365, dtype=torch.float64)
6 gae_duplicate tensor(-2.0517, dtype=torch.float64) tensor(15.0236, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6221, dtype=torch.float64) delta_t tensor(-0.9020, dtype=torch.float64)
5 gae_duplicate tensor(-1.1334, dtype=torch.float64) tensor(18.8665, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2156, dtype=torch.float64) delta_t tensor(-1.4923, dtype=torch.float64)
4 gae_duplicate tensor(-2.0346, dtype=torch.float64) tensor(31.5256, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3891, dtype=torch.float64) delta_t tensor(-1.5133, dtype=torch.float64)
3 gae_duplicate tensor(-2.0468, dtype=torch.float64) tensor(32.8567, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2259, dtype=torch.float64) delta_t tensor(-1.5371, dtype=torch.float64)
2 gae_duplicate tensor(-2.0603, dtype=torch.float64) tensor(33.0888, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-10988.419921875
value loss:223.17872619628906
entropies:354.83526611328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.379396200180054 seconds
19 rew tensor(0.8376, dtype=torch.float64) delta_t tensor(0.0402, dtype=torch.float64)
19 gae_duplicate tensor(0.0049, dtype=torch.float64) tensor(-0.7817, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8120, dtype=torch.float64) delta_t tensor(0.0456, dtype=torch.float64)
18 gae_duplicate tensor(-0.0333, dtype=torch.float64) tensor(-0.9335, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7435, dtype=torch.float64) delta_t tensor(-0.1168, dtype=torch.float64)
17 gae_duplicate tensor(-0.1820, dtype=torch.float64) tensor(2.1479, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6044, dtype=torch.float64) delta_t tensor(-0.2615, dtype=torch.float64)
16 gae_duplicate tensor(-0.3790, dtype=torch.float64) tensor(5.4510, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2797, dtype=torch.float64) delta_t tensor(-0.5995, dtype=torch.float64)
15 gae_duplicate tensor(-0.7991, dtype=torch.float64) tensor(12.0430, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9029, dtype=torch.float64) delta_t tensor(0.0252, dtype=torch.float64)
14 gae_duplicate tensor(-0.0947, dtype=torch.float64) tensor(0.7589, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9082, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
13 gae_duplicate tensor(-0.0220, dtype=torch.float64) tensor(-0.5004, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9136, dtype=torch.float64) delta_t tensor(0.6259, dtype=torch.float64)
12 gae_duplicate tensor(0.5517, dtype=torch.float64) tensor(-12.4465, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9192, dtype=torch.float64) delta_t tensor(-0.0097, dtype=torch.float64)
11 gae_duplicate tensor(-0.0101, dtype=torch.float64) tensor(-1.0709, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6997, dtype=torch.float64) delta_t tensor(-0.0033, dtype=torch.float64)
10 gae_duplicate tensor(-1.0013, dtype=torch.float64) tensor(-0.0201, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6682, dtype=torch.float64) delta_t tensor(-1.3789, dtype=torch.float64)
9 gae_duplicate tensor(-2.5188, dtype=torch.float64) tensor(27.6117, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8201, dtype=torch.float64) delta_t tensor(-1.5024, dtype=torch.float64)
8 gae_duplicate tensor(-3.0295, dtype=torch.float64) tensor(32.5660, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4563, dtype=torch.float64) delta_t tensor(-1.1169, dtype=torch.float64)
7 gae_duplicate tensor(-3.2513, dtype=torch.float64) tensor(25.1215, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1635, dtype=torch.float64) delta_t tensor(-1.6343, dtype=torch.float64)
6 gae_duplicate tensor(-4.2174, dtype=torch.float64) tensor(35.1112, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8606, dtype=torch.float64) delta_t tensor(-1.1342, dtype=torch.float64)
5 gae_duplicate tensor(-2.2626, dtype=torch.float64) tensor(26.2769, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0672, dtype=torch.float64) delta_t tensor(-1.2168, dtype=torch.float64)
4 gae_duplicate tensor(-1.8628, dtype=torch.float64) tensor(26.8409, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4595, dtype=torch.float64) delta_t tensor(-1.5356, dtype=torch.float64)
3 gae_duplicate tensor(-2.0079, dtype=torch.float64) tensor(33.0533, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3192, dtype=torch.float64) delta_t tensor(-1.4115, dtype=torch.float64)
2 gae_duplicate tensor(-1.8983, dtype=torch.float64) tensor(30.7764, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-13164.203125
value loss:232.78045654296875
entropies:355.1722412109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.963003873825073 seconds
19 rew tensor(0.8422, dtype=torch.float64) delta_t tensor(0.1321, dtype=torch.float64)
19 gae_duplicate tensor(0.0724, dtype=torch.float64) tensor(-2.6524, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8042, dtype=torch.float64) delta_t tensor(0.1253, dtype=torch.float64)
18 gae_duplicate tensor(0.0310, dtype=torch.float64) tensor(-2.7244, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7459, dtype=torch.float64) delta_t tensor(-0.0082, dtype=torch.float64)
17 gae_duplicate tensor(-0.1189, dtype=torch.float64) tensor(-0.0304, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5934, dtype=torch.float64) delta_t tensor(-0.1726, dtype=torch.float64)
16 gae_duplicate tensor(-0.3113, dtype=torch.float64) tensor(3.3087, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2632, dtype=torch.float64) delta_t tensor(-0.5174, dtype=torch.float64)
15 gae_duplicate tensor(-0.8076, dtype=torch.float64) tensor(10.3964, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9062, dtype=torch.float64) delta_t tensor(0.1300, dtype=torch.float64)
14 gae_duplicate tensor(-0.0502, dtype=torch.float64) tensor(-1.5352, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9110, dtype=torch.float64) delta_t tensor(0.1304, dtype=torch.float64)
13 gae_duplicate tensor(0.0208, dtype=torch.float64) tensor(-2.7263, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9158, dtype=torch.float64) delta_t tensor(0.6669, dtype=torch.float64)
12 gae_duplicate tensor(0.5989, dtype=torch.float64) tensor(-13.6454, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.1397, dtype=torch.float64)
11 gae_duplicate tensor(0.0378, dtype=torch.float64) tensor(-4.0713, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8304, dtype=torch.float64) delta_t tensor(0.2291, dtype=torch.float64)
10 gae_duplicate tensor(0.1160, dtype=torch.float64) tensor(-5.0365, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5811, dtype=torch.float64) delta_t tensor(-1.1733, dtype=torch.float64)
9 gae_duplicate tensor(-3.3304, dtype=torch.float64) tensor(23.3179, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2594, dtype=torch.float64) delta_t tensor(-0.3120, dtype=torch.float64)
8 gae_duplicate tensor(-1.5010, dtype=torch.float64) tensor(8.3369, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2649, dtype=torch.float64) delta_t tensor(-0.2970, dtype=torch.float64)
7 gae_duplicate tensor(-0.6124, dtype=torch.float64) tensor(6.6593, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1212, dtype=torch.float64) delta_t tensor(-0.3740, dtype=torch.float64)
6 gae_duplicate tensor(-0.5567, dtype=torch.float64) tensor(8.1027, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8798, dtype=torch.float64) delta_t tensor(-0.9163, dtype=torch.float64)
5 gae_duplicate tensor(-1.3298, dtype=torch.float64) tensor(18.6217, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2146, dtype=torch.float64) delta_t tensor(-1.2557, dtype=torch.float64)
4 gae_duplicate tensor(-1.9612, dtype=torch.float64) tensor(26.4937, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4200, dtype=torch.float64) delta_t tensor(-1.1542, dtype=torch.float64)
3 gae_duplicate tensor(-1.5637, dtype=torch.float64) tensor(25.3899, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2072, dtype=torch.float64) delta_t tensor(-1.2164, dtype=torch.float64)
2 gae_duplicate tensor(-1.5680, dtype=torch.float64) tensor(27.1284, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6863.96337890625
value loss:100.92991638183594
entropies:355.369140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.765661954879761 seconds
19 rew tensor(0.8567, dtype=torch.float64) delta_t tensor(0.3056, dtype=torch.float64)
19 gae_duplicate tensor(0.2323, dtype=torch.float64) tensor(-6.0463, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8180, dtype=torch.float64) delta_t tensor(0.2562, dtype=torch.float64)
18 gae_duplicate tensor(0.1928, dtype=torch.float64) tensor(-5.6134, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7791, dtype=torch.float64) delta_t tensor(0.1381, dtype=torch.float64)
17 gae_duplicate tensor(0.0395, dtype=torch.float64) tensor(-3.3371, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6554, dtype=torch.float64) delta_t tensor(-0.0010, dtype=torch.float64)
16 gae_duplicate tensor(-0.1685, dtype=torch.float64) tensor(-0.2798, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3730, dtype=torch.float64) delta_t tensor(-0.2885, dtype=torch.float64)
15 gae_duplicate tensor(-0.6703, dtype=torch.float64) tensor(5.8129, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9116, dtype=torch.float64) delta_t tensor(0.2508, dtype=torch.float64)
14 gae_duplicate tensor(0.1339, dtype=torch.float64) tensor(-4.4479, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9159, dtype=torch.float64) delta_t tensor(0.2503, dtype=torch.float64)
13 gae_duplicate tensor(0.2173, dtype=torch.float64) tensor(-5.3884, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9203, dtype=torch.float64) delta_t tensor(0.6693, dtype=torch.float64)
12 gae_duplicate tensor(0.2635, dtype=torch.float64) tensor(-14.0019, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9247, dtype=torch.float64) delta_t tensor(0.2586, dtype=torch.float64)
11 gae_duplicate tensor(0.2507, dtype=torch.float64) tensor(-6.5482, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6516, dtype=torch.float64) delta_t tensor(0.1679, dtype=torch.float64)
10 gae_duplicate tensor(-0.8946, dtype=torch.float64) tensor(-3.9538, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0569, dtype=torch.float64) delta_t tensor(-0.5293, dtype=torch.float64)
9 gae_duplicate tensor(-2.1288, dtype=torch.float64) tensor(9.8303, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2352, dtype=torch.float64) delta_t tensor(-0.1658, dtype=torch.float64)
8 gae_duplicate tensor(-1.2082, dtype=torch.float64) tensor(4.3100, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1199, dtype=torch.float64) delta_t tensor(-0.2703, dtype=torch.float64)
7 gae_duplicate tensor(-0.4952, dtype=torch.float64) tensor(5.6762, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4026, dtype=torch.float64) delta_t tensor(-0.4772, dtype=torch.float64)
6 gae_duplicate tensor(-0.8562, dtype=torch.float64) tensor(10.0020, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9586, dtype=torch.float64) delta_t tensor(-0.8205, dtype=torch.float64)
5 gae_duplicate tensor(-1.0726, dtype=torch.float64) tensor(17.2549, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4624, dtype=torch.float64) delta_t tensor(-1.2888, dtype=torch.float64)
4 gae_duplicate tensor(-1.7829, dtype=torch.float64) tensor(27.0367, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6643, dtype=torch.float64) delta_t tensor(-1.3673, dtype=torch.float64)
3 gae_duplicate tensor(-1.7674, dtype=torch.float64) tensor(29.9546, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3522, dtype=torch.float64) delta_t tensor(-1.4253, dtype=torch.float64)
2 gae_duplicate tensor(-1.8253, dtype=torch.float64) tensor(31.4307, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5047.32958984375
value loss:97.95935821533203
entropies:355.498046875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3955.0330)
ToM Target loss= tensor(3597.2051)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.434768915176392 seconds
19 rew tensor(0.8654, dtype=torch.float64) delta_t tensor(0.4421, dtype=torch.float64)
19 gae_duplicate tensor(0.3880, dtype=torch.float64) tensor(-8.5729, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8485, dtype=torch.float64) delta_t tensor(0.4286, dtype=torch.float64)
18 gae_duplicate tensor(0.3591, dtype=torch.float64) tensor(-9.3577, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8107, dtype=torch.float64) delta_t tensor(0.3018, dtype=torch.float64)
17 gae_duplicate tensor(0.2014, dtype=torch.float64) tensor(-6.8576, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7218, dtype=torch.float64) delta_t tensor(0.1810, dtype=torch.float64)
16 gae_duplicate tensor(-0.0059, dtype=torch.float64) tensor(-4.2265, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5406, dtype=torch.float64) delta_t tensor(-0.0025, dtype=torch.float64)
15 gae_duplicate tensor(-0.4149, dtype=torch.float64) tensor(-0.3559, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9097, dtype=torch.float64) delta_t tensor(0.3672, dtype=torch.float64)
14 gae_duplicate tensor(0.2767, dtype=torch.float64) tensor(-7.2689, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9136, dtype=torch.float64) delta_t tensor(0.3709, dtype=torch.float64)
13 gae_duplicate tensor(0.3496, dtype=torch.float64) tensor(-8.0401, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9175, dtype=torch.float64) delta_t tensor(0.7966, dtype=torch.float64)
12 gae_duplicate tensor(0.7088, dtype=torch.float64) tensor(-16.7108, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9215, dtype=torch.float64) delta_t tensor(0.3538, dtype=torch.float64)
11 gae_duplicate tensor(0.3685, dtype=torch.float64) tensor(-8.5914, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6929, dtype=torch.float64) delta_t tensor(0.3471, dtype=torch.float64)
10 gae_duplicate tensor(-0.6401, dtype=torch.float64) tensor(-7.7795, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5033, dtype=torch.float64) delta_t tensor(-0.8353, dtype=torch.float64)
9 gae_duplicate tensor(-3.1578, dtype=torch.float64) tensor(16.5771, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4733, dtype=torch.float64) delta_t tensor(-0.7813, dtype=torch.float64)
8 gae_duplicate tensor(-3.7506, dtype=torch.float64) tensor(16.7373, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1618, dtype=torch.float64) delta_t tensor(-0.4439, dtype=torch.float64)
7 gae_duplicate tensor(-2.4120, dtype=torch.float64) tensor(10.4905, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5585, dtype=torch.float64) delta_t tensor(-0.5379, dtype=torch.float64)
6 gae_duplicate tensor(-2.6098, dtype=torch.float64) tensor(11.9911, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9455, dtype=torch.float64) delta_t tensor(-0.7689, dtype=torch.float64)
5 gae_duplicate tensor(-1.9205, dtype=torch.float64) tensor(16.5218, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2070, dtype=torch.float64) delta_t tensor(-0.8776, dtype=torch.float64)
4 gae_duplicate tensor(-1.3409, dtype=torch.float64) tensor(19.0213, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4286, dtype=torch.float64) delta_t tensor(-0.9061, dtype=torch.float64)
3 gae_duplicate tensor(-1.1616, dtype=torch.float64) tensor(19.9713, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1846, dtype=torch.float64) delta_t tensor(-0.9719, dtype=torch.float64)
2 gae_duplicate tensor(-1.2263, dtype=torch.float64) tensor(21.1501, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3049.7724609375
value loss:135.17697143554688
entropies:355.6281433105469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.083843231201172 seconds
19 rew tensor(0.8478, dtype=torch.float64) delta_t tensor(0.5913, dtype=torch.float64)
19 gae_duplicate tensor(0.5308, dtype=torch.float64) tensor(-11.6204, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8085, dtype=torch.float64) delta_t tensor(0.5107, dtype=torch.float64)
18 gae_duplicate tensor(0.4983, dtype=torch.float64) tensor(-11.3555, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7485, dtype=torch.float64) delta_t tensor(0.3625, dtype=torch.float64)
17 gae_duplicate tensor(0.3388, dtype=torch.float64) tensor(-8.2421, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5933, dtype=torch.float64) delta_t tensor(0.1911, dtype=torch.float64)
16 gae_duplicate tensor(0.1081, dtype=torch.float64) tensor(-4.5192, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2380, dtype=torch.float64) delta_t tensor(-0.1416, dtype=torch.float64)
15 gae_duplicate tensor(-0.3792, dtype=torch.float64) tensor(2.4082, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9092, dtype=torch.float64) delta_t tensor(0.5276, dtype=torch.float64)
14 gae_duplicate tensor(0.4247, dtype=torch.float64) tensor(-10.2865, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9128, dtype=torch.float64) delta_t tensor(0.5252, dtype=torch.float64)
13 gae_duplicate tensor(0.5015, dtype=torch.float64) tensor(-11.4399, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9164, dtype=torch.float64) delta_t tensor(0.8633, dtype=torch.float64)
12 gae_duplicate tensor(0.5609, dtype=torch.float64) tensor(-18.1651, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9200, dtype=torch.float64) delta_t tensor(0.5312, dtype=torch.float64)
11 gae_duplicate tensor(0.5311, dtype=torch.float64) tensor(-12.2556, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2367, dtype=torch.float64) delta_t tensor(0.0218, dtype=torch.float64)
10 gae_duplicate tensor(-1.7420, dtype=torch.float64) tensor(-1.8456, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2384, dtype=torch.float64) delta_t tensor(0.0329, dtype=torch.float64)
9 gae_duplicate tensor(-1.8300, dtype=torch.float64) tensor(-0.8780, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0816, dtype=torch.float64) delta_t tensor(-0.0076, dtype=torch.float64)
8 gae_duplicate tensor(-2.0987, dtype=torch.float64) tensor(0.1104, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0153, dtype=torch.float64) delta_t tensor(-0.1357, dtype=torch.float64)
7 gae_duplicate tensor(-0.9995, dtype=torch.float64) tensor(2.5594, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2376, dtype=torch.float64) delta_t tensor(0.1112, dtype=torch.float64)
6 gae_duplicate tensor(-0.2881, dtype=torch.float64) tensor(-1.9761, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9453, dtype=torch.float64) delta_t tensor(-0.4789, dtype=torch.float64)
5 gae_duplicate tensor(-0.7698, dtype=torch.float64) tensor(9.2839, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4054, dtype=torch.float64) delta_t tensor(-0.8897, dtype=torch.float64)
4 gae_duplicate tensor(-1.2862, dtype=torch.float64) tensor(18.4612, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5498, dtype=torch.float64) delta_t tensor(-0.8324, dtype=torch.float64)
3 gae_duplicate tensor(-1.2141, dtype=torch.float64) tensor(18.3674, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3121, dtype=torch.float64) delta_t tensor(-0.8930, dtype=torch.float64)
2 gae_duplicate tensor(-1.2160, dtype=torch.float64) tensor(19.5132, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1085.5211181640625
value loss:80.43777465820312
entropies:355.6233825683594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.764570951461792 seconds
19 rew tensor(0.8541, dtype=torch.float64) delta_t tensor(0.6430, dtype=torch.float64)
19 gae_duplicate tensor(0.6053, dtype=torch.float64) tensor(-12.6488, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8260, dtype=torch.float64) delta_t tensor(0.5914, dtype=torch.float64)
18 gae_duplicate tensor(0.5563, dtype=torch.float64) tensor(-12.9184, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7774, dtype=torch.float64) delta_t tensor(0.4626, dtype=torch.float64)
17 gae_duplicate tensor(0.4018, dtype=torch.float64) tensor(-10.5048, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6565, dtype=torch.float64) delta_t tensor(0.3325, dtype=torch.float64)
16 gae_duplicate tensor(0.1839, dtype=torch.float64) tensor(-7.5354, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4121, dtype=torch.float64) delta_t tensor(0.0934, dtype=torch.float64)
15 gae_duplicate tensor(-0.2125, dtype=torch.float64) tensor(-2.6331, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9052, dtype=torch.float64) delta_t tensor(0.5878, dtype=torch.float64)
14 gae_duplicate tensor(0.5070, dtype=torch.float64) tensor(-12.1294, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9085, dtype=torch.float64) delta_t tensor(0.5911, dtype=torch.float64)
13 gae_duplicate tensor(0.5771, dtype=torch.float64) tensor(-12.8209, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9117, dtype=torch.float64) delta_t tensor(0.9817, dtype=torch.float64)
12 gae_duplicate tensor(0.9897, dtype=torch.float64) tensor(-21.0613, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8841, dtype=torch.float64) delta_t tensor(0.5671, dtype=torch.float64)
11 gae_duplicate tensor(0.5913, dtype=torch.float64) tensor(-13.2939, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8459, dtype=torch.float64) delta_t tensor(0.7095, dtype=torch.float64)
10 gae_duplicate tensor(0.6105, dtype=torch.float64) tensor(-15.3613, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7169, dtype=torch.float64) delta_t tensor(-1.8222, dtype=torch.float64)
9 gae_duplicate tensor(-3.9052, dtype=torch.float64) tensor(34.3584, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.1191, dtype=torch.float64) delta_t tensor(-2.2188, dtype=torch.float64)
8 gae_duplicate tensor(-6.0192, dtype=torch.float64) tensor(47.6422, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4286, dtype=torch.float64) delta_t tensor(-0.5253, dtype=torch.float64)
7 gae_duplicate tensor(-2.0149, dtype=torch.float64) tensor(15.3382, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4898, dtype=torch.float64) delta_t tensor(-0.4109, dtype=torch.float64)
6 gae_duplicate tensor(-3.4286, dtype=torch.float64) tensor(10.0052, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0403, dtype=torch.float64) delta_t tensor(-0.4725, dtype=torch.float64)
5 gae_duplicate tensor(-2.1888, dtype=torch.float64) tensor(10.4445, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1919, dtype=torch.float64) delta_t tensor(-0.5783, dtype=torch.float64)
4 gae_duplicate tensor(-1.1261, dtype=torch.float64) tensor(12.3806, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5038, dtype=torch.float64) delta_t tensor(-0.7662, dtype=torch.float64)
3 gae_duplicate tensor(-1.4239, dtype=torch.float64) tensor(16.2392, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3999, dtype=torch.float64) delta_t tensor(-0.8226, dtype=torch.float64)
2 gae_duplicate tensor(-1.3981, dtype=torch.float64) tensor(17.9466, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2442.22119140625
value loss:223.480712890625
entropies:355.70697021484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.433631896972656 seconds
19 rew tensor(0.8362, dtype=torch.float64) delta_t tensor(0.7257, dtype=torch.float64)
19 gae_duplicate tensor(0.7063, dtype=torch.float64) tensor(-14.4020, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8089, dtype=torch.float64) delta_t tensor(0.6579, dtype=torch.float64)
18 gae_duplicate tensor(0.6672, dtype=torch.float64) tensor(-14.6779, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7198, dtype=torch.float64) delta_t tensor(0.4680, dtype=torch.float64)
17 gae_duplicate tensor(0.5138, dtype=torch.float64) tensor(-10.6040, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5398, dtype=torch.float64) delta_t tensor(0.2694, dtype=torch.float64)
16 gae_duplicate tensor(0.2860, dtype=torch.float64) tensor(-6.4147, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1681, dtype=torch.float64) delta_t tensor(-0.0851, dtype=torch.float64)
15 gae_duplicate tensor(-0.1232, dtype=torch.float64) tensor(1.0446, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9035, dtype=torch.float64) delta_t tensor(0.6489, dtype=torch.float64)
14 gae_duplicate tensor(0.6016, dtype=torch.float64) tensor(-12.6273, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9065, dtype=torch.float64) delta_t tensor(0.6528, dtype=torch.float64)
13 gae_duplicate tensor(0.6770, dtype=torch.float64) tensor(-14.2255, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9095, dtype=torch.float64) delta_t tensor(1.0020, dtype=torch.float64)
12 gae_duplicate tensor(1.0279, dtype=torch.float64) tensor(-21.2780, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9126, dtype=torch.float64) delta_t tensor(0.6387, dtype=torch.float64)
11 gae_duplicate tensor(0.6925, dtype=torch.float64) tensor(-14.7783, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5063, dtype=torch.float64) delta_t tensor(0.4394, dtype=torch.float64)
10 gae_duplicate tensor(-0.2945, dtype=torch.float64) tensor(-10.2158, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6294, dtype=torch.float64) delta_t tensor(-1.6893, dtype=torch.float64)
9 gae_duplicate tensor(-2.7377, dtype=torch.float64) tensor(32.6492, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9120, dtype=torch.float64) delta_t tensor(-0.9075, dtype=torch.float64)
8 gae_duplicate tensor(-3.0996, dtype=torch.float64) tensor(21.1320, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3010, dtype=torch.float64) delta_t tensor(-0.3252, dtype=torch.float64)
7 gae_duplicate tensor(-1.6107, dtype=torch.float64) tensor(8.6066, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2601, dtype=torch.float64) delta_t tensor(-0.0964, dtype=torch.float64)
6 gae_duplicate tensor(-2.1273, dtype=torch.float64) tensor(2.7799, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6025, dtype=torch.float64) delta_t tensor(-1.0374, dtype=torch.float64)
5 gae_duplicate tensor(-3.7517, dtype=torch.float64) tensor(20.6072, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1989, dtype=torch.float64) delta_t tensor(-0.3945, dtype=torch.float64)
4 gae_duplicate tensor(-1.4390, dtype=torch.float64) tensor(9.7790, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4377, dtype=torch.float64) delta_t tensor(-0.4838, dtype=torch.float64)
3 gae_duplicate tensor(-0.8042, dtype=torch.float64) tensor(10.4742, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4055, dtype=torch.float64) delta_t tensor(-0.5799, dtype=torch.float64)
2 gae_duplicate tensor(-0.7955, dtype=torch.float64) tensor(12.5594, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-118.1186752319336
value loss:163.215087890625
entropies:355.7345886230469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.984773874282837 seconds
19 rew tensor(0.8558, dtype=torch.float64) delta_t tensor(0.8185, dtype=torch.float64)
19 gae_duplicate tensor(0.7788, dtype=torch.float64) tensor(-16.2280, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8482, dtype=torch.float64) delta_t tensor(0.7739, dtype=torch.float64)
18 gae_duplicate tensor(0.7468, dtype=torch.float64) tensor(-17.0141, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7795, dtype=torch.float64) delta_t tensor(0.6029, dtype=torch.float64)
17 gae_duplicate tensor(0.5891, dtype=torch.float64) tensor(-13.5567, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6697, dtype=torch.float64) delta_t tensor(0.4578, dtype=torch.float64)
16 gae_duplicate tensor(0.3621, dtype=torch.float64) tensor(-10.4333, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4283, dtype=torch.float64) delta_t tensor(0.2429, dtype=torch.float64)
15 gae_duplicate tensor(-0.0518, dtype=torch.float64) tensor(-5.8282, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9053, dtype=torch.float64) delta_t tensor(0.7177, dtype=torch.float64)
14 gae_duplicate tensor(0.6891, dtype=torch.float64) tensor(-14.8199, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9081, dtype=torch.float64) delta_t tensor(0.7215, dtype=torch.float64)
13 gae_duplicate tensor(0.7659, dtype=torch.float64) tensor(-15.8114, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9109, dtype=torch.float64) delta_t tensor(0.9786, dtype=torch.float64)
12 gae_duplicate tensor(0.9585, dtype=torch.float64) tensor(-21.1205, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9138, dtype=torch.float64) delta_t tensor(0.7224, dtype=torch.float64)
11 gae_duplicate tensor(0.7802, dtype=torch.float64) tensor(-16.3219, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7052, dtype=torch.float64) delta_t tensor(0.7273, dtype=torch.float64)
10 gae_duplicate tensor(-0.1896, dtype=torch.float64) tensor(-15.8374, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3110, dtype=torch.float64) delta_t tensor(-0.2659, dtype=torch.float64)
9 gae_duplicate tensor(-1.6956, dtype=torch.float64) tensor(3.6843, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4178, dtype=torch.float64) delta_t tensor(-0.2801, dtype=torch.float64)
8 gae_duplicate tensor(-2.9712, dtype=torch.float64) tensor(5.6188, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0016, dtype=torch.float64) delta_t tensor(0.1020, dtype=torch.float64)
7 gae_duplicate tensor(-2.0593, dtype=torch.float64) tensor(-1.4688, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7853, dtype=torch.float64) delta_t tensor(-0.2218, dtype=torch.float64)
6 gae_duplicate tensor(-2.1465, dtype=torch.float64) tensor(4.3384, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6029, dtype=torch.float64) delta_t tensor(0.1511, dtype=torch.float64)
5 gae_duplicate tensor(-0.3046, dtype=torch.float64) tensor(-2.6277, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9306, dtype=torch.float64) delta_t tensor(0.0018, dtype=torch.float64)
4 gae_duplicate tensor(-0.4858, dtype=torch.float64) tensor(-0.3337, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1392, dtype=torch.float64) delta_t tensor(-0.2277, dtype=torch.float64)
3 gae_duplicate tensor(-0.3722, dtype=torch.float64) tensor(4.4802, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0258, dtype=torch.float64) delta_t tensor(-0.1385, dtype=torch.float64)
2 gae_duplicate tensor(-0.5229, dtype=torch.float64) tensor(3.1166, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:6932.74169921875
value loss:111.6031494140625
entropies:355.819091796875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3957.5820)
ToM Target loss= tensor(3656.9609)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.40941309928894 seconds
19 rew tensor(0.8631, dtype=torch.float64) delta_t tensor(0.8818, dtype=torch.float64)
19 gae_duplicate tensor(0.8133, dtype=torch.float64) tensor(-17.5387, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8552, dtype=torch.float64) delta_t tensor(0.8615, dtype=torch.float64)
18 gae_duplicate tensor(0.8183, dtype=torch.float64) tensor(-18.8617, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8067, dtype=torch.float64) delta_t tensor(0.7252, dtype=torch.float64)
17 gae_duplicate tensor(0.6338, dtype=torch.float64) tensor(-16.1489, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7276, dtype=torch.float64) delta_t tensor(0.5541, dtype=torch.float64)
16 gae_duplicate tensor(0.4080, dtype=torch.float64) tensor(-12.6213, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5362, dtype=torch.float64) delta_t tensor(0.4196, dtype=torch.float64)
15 gae_duplicate tensor(-0.0042, dtype=torch.float64) tensor(-9.4494, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9029, dtype=torch.float64) delta_t tensor(0.7810, dtype=torch.float64)
14 gae_duplicate tensor(0.7114, dtype=torch.float64) tensor(-16.4498, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9055, dtype=torch.float64) delta_t tensor(0.7844, dtype=torch.float64)
13 gae_duplicate tensor(0.7817, dtype=torch.float64) tensor(-17.2212, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9082, dtype=torch.float64) delta_t tensor(0.9524, dtype=torch.float64)
12 gae_duplicate tensor(0.7726, dtype=torch.float64) tensor(-20.4743, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9108, dtype=torch.float64) delta_t tensor(0.7878, dtype=torch.float64)
11 gae_duplicate tensor(0.8074, dtype=torch.float64) tensor(-17.6152, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7050, dtype=torch.float64) delta_t tensor(0.7811, dtype=torch.float64)
10 gae_duplicate tensor(-0.1328, dtype=torch.float64) tensor(-17.2836, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4977, dtype=torch.float64) delta_t tensor(0.5966, dtype=torch.float64)
9 gae_duplicate tensor(-0.2562, dtype=torch.float64) tensor(-13.4748, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1289, dtype=torch.float64) delta_t tensor(0.3694, dtype=torch.float64)
8 gae_duplicate tensor(-1.5720, dtype=torch.float64) tensor(-8.6168, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1260, dtype=torch.float64) delta_t tensor(0.0464, dtype=torch.float64)
7 gae_duplicate tensor(-2.0553, dtype=torch.float64) tensor(-1.7879, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4728, dtype=torch.float64) delta_t tensor(0.2720, dtype=torch.float64)
6 gae_duplicate tensor(-2.0005, dtype=torch.float64) tensor(-5.4522, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1266, dtype=torch.float64) delta_t tensor(-0.1544, dtype=torch.float64)
5 gae_duplicate tensor(-2.6798, dtype=torch.float64) tensor(2.5272, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2220, dtype=torch.float64) delta_t tensor(-0.1594, dtype=torch.float64)
4 gae_duplicate tensor(-0.5770, dtype=torch.float64) tensor(3.4034, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2584, dtype=torch.float64) delta_t tensor(-0.1602, dtype=torch.float64)
3 gae_duplicate tensor(-0.4103, dtype=torch.float64) tensor(3.4897, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0520, dtype=torch.float64) delta_t tensor(-0.2846, dtype=torch.float64)
2 gae_duplicate tensor(-0.7781, dtype=torch.float64) tensor(6.0221, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:9491.791015625
value loss:117.47200012207031
entropies:355.9145812988281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.032701015472412 seconds
19 rew tensor(0.8793, dtype=torch.float64) delta_t tensor(0.8335, dtype=torch.float64)
19 gae_duplicate tensor(0.7973, dtype=torch.float64) tensor(-16.4501, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8712, dtype=torch.float64) delta_t tensor(0.7780, dtype=torch.float64)
18 gae_duplicate tensor(0.7589, dtype=torch.float64) tensor(-17.0710, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8631, dtype=torch.float64) delta_t tensor(0.6964, dtype=torch.float64)
17 gae_duplicate tensor(0.5949, dtype=torch.float64) tensor(-15.4756, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8343, dtype=torch.float64) delta_t tensor(0.6201, dtype=torch.float64)
16 gae_duplicate tensor(0.3770, dtype=torch.float64) tensor(-13.8449, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7744, dtype=torch.float64) delta_t tensor(0.5401, dtype=torch.float64)
15 gae_duplicate tensor(-0.0387, dtype=torch.float64) tensor(-12.1200, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.6699, dtype=torch.float64)
14 gae_duplicate tensor(0.6662, dtype=torch.float64) tensor(-14.3634, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9028, dtype=torch.float64) delta_t tensor(0.6743, dtype=torch.float64)
13 gae_duplicate tensor(0.6703, dtype=torch.float64) tensor(-14.8087, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9053, dtype=torch.float64) delta_t tensor(0.9338, dtype=torch.float64)
12 gae_duplicate tensor(0.7623, dtype=torch.float64) tensor(-19.8896, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9078, dtype=torch.float64) delta_t tensor(0.7094, dtype=torch.float64)
11 gae_duplicate tensor(0.6845, dtype=torch.float64) tensor(-16.0634, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7038, dtype=torch.float64) delta_t tensor(0.7424, dtype=torch.float64)
10 gae_duplicate tensor(-0.1778, dtype=torch.float64) tensor(-16.2751, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6862, dtype=torch.float64) delta_t tensor(0.7331, dtype=torch.float64)
9 gae_duplicate tensor(0.4869, dtype=torch.float64) tensor(-16.1625, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8299, dtype=torch.float64) delta_t tensor(-0.6188, dtype=torch.float64)
8 gae_duplicate tensor(-2.7156, dtype=torch.float64) tensor(10.7023, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8662, dtype=torch.float64) delta_t tensor(-0.7277, dtype=torch.float64)
7 gae_duplicate tensor(-3.4218, dtype=torch.float64) tensor(15.4056, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2177, dtype=torch.float64) delta_t tensor(0.4423, dtype=torch.float64)
6 gae_duplicate tensor(-0.6077, dtype=torch.float64) tensor(-7.2030, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7793, dtype=torch.float64) delta_t tensor(0.1030, dtype=torch.float64)
5 gae_duplicate tensor(-1.1652, dtype=torch.float64) tensor(-2.7377, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1342, dtype=torch.float64) delta_t tensor(-0.0259, dtype=torch.float64)
4 gae_duplicate tensor(-0.3667, dtype=torch.float64) tensor(0.2394, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3410, dtype=torch.float64) delta_t tensor(-0.2524, dtype=torch.float64)
3 gae_duplicate tensor(-0.3904, dtype=torch.float64) tensor(5.0266, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2235, dtype=torch.float64) delta_t tensor(-0.2192, dtype=torch.float64)
2 gae_duplicate tensor(-0.6811, dtype=torch.float64) tensor(4.8615, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:7800.2880859375
value loss:123.76160430908203
entropies:355.9361267089844
Policy training finished
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
training start after waiting for 5.131541967391968 seconds
19 rew tensor(0.8571, dtype=torch.float64) delta_t tensor(0.7001, dtype=torch.float64)
19 gae_duplicate tensor(0.6298, dtype=torch.float64) tensor(-13.8558, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8286, dtype=torch.float64) delta_t tensor(0.6255, dtype=torch.float64)
18 gae_duplicate tensor(0.5760, dtype=torch.float64) tensor(-13.7353, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8000, dtype=torch.float64) delta_t tensor(0.4930, dtype=torch.float64)
17 gae_duplicate tensor(0.4108, dtype=torch.float64) tensor(-11.1281, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7103, dtype=torch.float64) delta_t tensor(0.3643, dtype=torch.float64)
16 gae_duplicate tensor(0.1928, dtype=torch.float64) tensor(-8.3128, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5188, dtype=torch.float64) delta_t tensor(0.1263, dtype=torch.float64)
15 gae_duplicate tensor(-0.2930, dtype=torch.float64) tensor(-3.3365, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8955, dtype=torch.float64) delta_t tensor(0.5082, dtype=torch.float64)
14 gae_duplicate tensor(0.4342, dtype=torch.float64) tensor(-10.3718, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8978, dtype=torch.float64) delta_t tensor(0.5119, dtype=torch.float64)
13 gae_duplicate tensor(0.4953, dtype=torch.float64) tensor(-11.1605, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9001, dtype=torch.float64) delta_t tensor(0.8401, dtype=torch.float64)
12 gae_duplicate tensor(0.6152, dtype=torch.float64) tensor(-17.7359, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9024, dtype=torch.float64) delta_t tensor(0.5474, dtype=torch.float64)
11 gae_duplicate tensor(0.5112, dtype=torch.float64) tensor(-12.6228, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8541, dtype=torch.float64) delta_t tensor(0.7971, dtype=torch.float64)
10 gae_duplicate tensor(0.7805, dtype=torch.float64) tensor(-17.0366, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3713, dtype=torch.float64) delta_t tensor(-0.4174, dtype=torch.float64)
9 gae_duplicate tensor(-2.8159, dtype=torch.float64) tensor(6.5749, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7570, dtype=torch.float64) delta_t tensor(-0.6401, dtype=torch.float64)
8 gae_duplicate tensor(-4.0516, dtype=torch.float64) tensor(13.3050, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2242, dtype=torch.float64) delta_t tensor(0.3607, dtype=torch.float64)
7 gae_duplicate tensor(0.0207, dtype=torch.float64) tensor(-5.8056, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1922, dtype=torch.float64) delta_t tensor(0.5022, dtype=torch.float64)
6 gae_duplicate tensor(0.3168, dtype=torch.float64) tensor(-10.5007, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8650, dtype=torch.float64) delta_t tensor(0.1967, dtype=torch.float64)
5 gae_duplicate tensor(-0.0746, dtype=torch.float64) tensor(-4.9393, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3562, dtype=torch.float64) delta_t tensor(-0.2693, dtype=torch.float64)
4 gae_duplicate tensor(-0.6668, dtype=torch.float64) tensor(4.8218, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5041, dtype=torch.float64) delta_t tensor(-0.2479, dtype=torch.float64)
3 gae_duplicate tensor(-0.6215, dtype=torch.float64) tensor(5.3921, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3176, dtype=torch.float64) delta_t tensor(-0.3749, dtype=torch.float64)
2 gae_duplicate tensor(-0.9184, dtype=torch.float64) tensor(7.9323, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:5439.72509765625
value loss:93.33576965332031
entropies:355.9448547363281
Policy training finished
---------------------
gamma: 0.1