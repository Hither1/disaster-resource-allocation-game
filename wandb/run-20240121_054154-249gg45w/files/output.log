obs <crafter.objects.Shelter object at 0x13845beb0> [39.  0.  0.  0. 39.  0.  0.  0.  7.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x13846bf10> [43.  0.  0.  0. 36.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x13846b3d0> [ 9.  0.  0.  0.  9.  0.  0.  0. 12.  0.  0.  0.]
obs <crafter.objects.Shelter object at 0x13845beb0> [39.  0.  0.  0. 39.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x13846bf10> [37.  0.  0.  0. 41.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x13846b3d0> [ 9.  0.  0.  0.  9.  0.  0.  0. 12.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0033903121948242188 seconds
19 rew tensor(1.0153, dtype=torch.float64) delta_t tensor(1.1882, dtype=torch.float64)
19 gae_duplicate tensor(0.8280, dtype=torch.float64) tensor(-23.3914, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0739, dtype=torch.float64) delta_t tensor(1.2014, dtype=torch.float64)
18 gae_duplicate tensor(0.8450, dtype=torch.float64) tensor(-26.1161, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1447, dtype=torch.float64) delta_t tensor(1.2742, dtype=torch.float64)
17 gae_duplicate tensor(0.8910, dtype=torch.float64) tensor(-27.7007, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.2324, dtype=torch.float64) delta_t tensor(1.3542, dtype=torch.float64)
16 gae_duplicate tensor(0.9435, dtype=torch.float64) tensor(-29.3096, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.3454, dtype=torch.float64) delta_t tensor(1.4193, dtype=torch.float64)
15 gae_duplicate tensor(0.9559, dtype=torch.float64) tensor(-31.0823, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.4996, dtype=torch.float64) delta_t tensor(1.5713, dtype=torch.float64)
14 gae_duplicate tensor(1.0369, dtype=torch.float64) tensor(-33.9305, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.7296, dtype=torch.float64) delta_t tensor(1.8035, dtype=torch.float64)
13 gae_duplicate tensor(1.0804, dtype=torch.float64) tensor(-38.3615, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.3686, dtype=torch.float64) delta_t tensor(1.4113, dtype=torch.float64)
12 gae_duplicate tensor(1.0074, dtype=torch.float64) tensor(-31.7755, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.3864, dtype=torch.float64) delta_t tensor(1.4757, dtype=torch.float64)
11 gae_duplicate tensor(1.1057, dtype=torch.float64) tensor(-32.1151, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(1.2808, dtype=torch.float64) delta_t tensor(1.3134, dtype=torch.float64)
10 gae_duplicate tensor(0.9617, dtype=torch.float64) tensor(-28.9444, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8933, dtype=torch.float64) delta_t tensor(0.8339, dtype=torch.float64)
9 gae_duplicate tensor(0.5648, dtype=torch.float64) tensor(-19.5085, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5920, dtype=torch.float64) delta_t tensor(0.5290, dtype=torch.float64)
8 gae_duplicate tensor(-0.2843, dtype=torch.float64) tensor(-12.2953, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0015, dtype=torch.float64) delta_t tensor(-0.0949, dtype=torch.float64)
7 gae_duplicate tensor(-1.2005, dtype=torch.float64) tensor(0.4734, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.7231, dtype=torch.float64) delta_t tensor(0.6395, dtype=torch.float64)
6 gae_duplicate tensor(-0.7871, dtype=torch.float64) tensor(-12.6180, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0439, dtype=torch.float64) delta_t tensor(-0.0944, dtype=torch.float64)
5 gae_duplicate tensor(-1.8860, dtype=torch.float64) tensor(0.6583, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1222, dtype=torch.float64) delta_t tensor(-0.1072, dtype=torch.float64)
4 gae_duplicate tensor(-1.8301, dtype=torch.float64) tensor(2.2080, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6351, dtype=torch.float64) delta_t tensor(-0.6436, dtype=torch.float64)
3 gae_duplicate tensor(-0.8652, dtype=torch.float64) tensor(12.9187, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2034, dtype=torch.float64) delta_t tensor(-0.2163, dtype=torch.float64)
2 gae_duplicate tensor(-0.6356, dtype=torch.float64) tensor(5.5160, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:17474.16796875
value loss:282.25384521484375
entropies:355.7642822265625
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 4.9312989711761475 seconds
19 rew tensor(1.0048, dtype=torch.float64) delta_t tensor(1.0875, dtype=torch.float64)
19 gae_duplicate tensor(0.6324, dtype=torch.float64) tensor(-21.5047, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0324, dtype=torch.float64) delta_t tensor(1.0821, dtype=torch.float64)
18 gae_duplicate tensor(0.7052, dtype=torch.float64) tensor(-24.0529, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0624, dtype=torch.float64) delta_t tensor(1.0950, dtype=torch.float64)
17 gae_duplicate tensor(0.7361, dtype=torch.float64) tensor(-23.3559, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0953, dtype=torch.float64) delta_t tensor(1.1262, dtype=torch.float64)
16 gae_duplicate tensor(0.7787, dtype=torch.float64) tensor(-24.5890, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.1316, dtype=torch.float64) delta_t tensor(1.1563, dtype=torch.float64)
15 gae_duplicate tensor(0.7701, dtype=torch.float64) tensor(-24.6795, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.1719, dtype=torch.float64) delta_t tensor(1.1428, dtype=torch.float64)
14 gae_duplicate tensor(0.7410, dtype=torch.float64) tensor(-24.7833, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.2009, dtype=torch.float64) delta_t tensor(1.1881, dtype=torch.float64)
13 gae_duplicate tensor(0.6747, dtype=torch.float64) tensor(-26.4951, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8878, dtype=torch.float64) delta_t tensor(0.8683, dtype=torch.float64)
12 gae_duplicate tensor(0.4374, dtype=torch.float64) tensor(-19.8723, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4106, dtype=torch.float64) delta_t tensor(0.4273, dtype=torch.float64)
11 gae_duplicate tensor(-0.0274, dtype=torch.float64) tensor(-10.5533, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3536, dtype=torch.float64) delta_t tensor(0.3471, dtype=torch.float64)
10 gae_duplicate tensor(-0.3146, dtype=torch.float64) tensor(-7.9455, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0086, dtype=torch.float64) delta_t tensor(-0.0609, dtype=torch.float64)
9 gae_duplicate tensor(-0.7346, dtype=torch.float64) tensor(0.4382, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0501, dtype=torch.float64) delta_t tensor(-0.1052, dtype=torch.float64)
8 gae_duplicate tensor(-0.7639, dtype=torch.float64) tensor(2.0082, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0282, dtype=torch.float64) delta_t tensor(-0.0839, dtype=torch.float64)
7 gae_duplicate tensor(-0.6498, dtype=torch.float64) tensor(1.7537, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0336, dtype=torch.float64) delta_t tensor(-0.1710, dtype=torch.float64)
6 gae_duplicate tensor(-1.2657, dtype=torch.float64) tensor(3.7449, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4529, dtype=torch.float64) delta_t tensor(-0.6415, dtype=torch.float64)
5 gae_duplicate tensor(-0.9482, dtype=torch.float64) tensor(12.9097, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1989, dtype=torch.float64) delta_t tensor(-1.3834, dtype=torch.float64)
4 gae_duplicate tensor(-3.6195, dtype=torch.float64) tensor(29.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9634, dtype=torch.float64) delta_t tensor(-0.9320, dtype=torch.float64)
3 gae_duplicate tensor(-1.5034, dtype=torch.float64) tensor(21.5510, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8300, dtype=torch.float64) delta_t tensor(-0.7561, dtype=torch.float64)
2 gae_duplicate tensor(-1.3939, dtype=torch.float64) tensor(16.9831, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:6341.3525390625
value loss:177.02236938476562
entropies:355.2203674316406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.950031042098999 seconds
19 rew tensor(0.9841, dtype=torch.float64) delta_t tensor(0.7678, dtype=torch.float64)
19 gae_duplicate tensor(0.4074, dtype=torch.float64) tensor(-15.2114, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0013, dtype=torch.float64) delta_t tensor(0.8327, dtype=torch.float64)
18 gae_duplicate tensor(0.4971, dtype=torch.float64) tensor(-18.9233, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0193, dtype=torch.float64) delta_t tensor(0.8267, dtype=torch.float64)
17 gae_duplicate tensor(0.5125, dtype=torch.float64) tensor(-17.2889, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0384, dtype=torch.float64) delta_t tensor(0.8456, dtype=torch.float64)
16 gae_duplicate tensor(0.5303, dtype=torch.float64) tensor(-18.0283, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0587, dtype=torch.float64) delta_t tensor(0.8741, dtype=torch.float64)
15 gae_duplicate tensor(0.5306, dtype=torch.float64) tensor(-19.0230, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0802, dtype=torch.float64) delta_t tensor(0.8717, dtype=torch.float64)
14 gae_duplicate tensor(0.5383, dtype=torch.float64) tensor(-18.5339, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.1031, dtype=torch.float64) delta_t tensor(0.9590, dtype=torch.float64)
13 gae_duplicate tensor(0.6244, dtype=torch.float64) tensor(-20.4093, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(0.7328, dtype=torch.float64)
12 gae_duplicate tensor(0.4959, dtype=torch.float64) tensor(-16.3738, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5898, dtype=torch.float64) delta_t tensor(0.4556, dtype=torch.float64)
11 gae_duplicate tensor(-0.1250, dtype=torch.float64) tensor(-10.8868, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5261, dtype=torch.float64) delta_t tensor(0.4185, dtype=torch.float64)
10 gae_duplicate tensor(-0.1900, dtype=torch.float64) tensor(-9.0519, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0735, dtype=torch.float64) delta_t tensor(-0.1650, dtype=torch.float64)
9 gae_duplicate tensor(-0.4569, dtype=torch.float64) tensor(2.6167, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0290, dtype=torch.float64) delta_t tensor(-0.2967, dtype=torch.float64)
8 gae_duplicate tensor(-0.9022, dtype=torch.float64) tensor(6.2855, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0486, dtype=torch.float64) delta_t tensor(-0.3557, dtype=torch.float64)
7 gae_duplicate tensor(-1.0416, dtype=torch.float64) tensor(7.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0915, dtype=torch.float64) delta_t tensor(-0.3732, dtype=torch.float64)
6 gae_duplicate tensor(-1.3430, dtype=torch.float64) tensor(8.0380, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9164, dtype=torch.float64) delta_t tensor(-1.2823, dtype=torch.float64)
5 gae_duplicate tensor(-3.4028, dtype=torch.float64) tensor(26.5459, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8162, dtype=torch.float64) delta_t tensor(-1.2193, dtype=torch.float64)
4 gae_duplicate tensor(-1.5442, dtype=torch.float64) tensor(26.2497, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1993, dtype=torch.float64) delta_t tensor(-1.2350, dtype=torch.float64)
3 gae_duplicate tensor(-1.8243, dtype=torch.float64) tensor(27.4076, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9824, dtype=torch.float64) delta_t tensor(-1.1241, dtype=torch.float64)
2 gae_duplicate tensor(-1.5296, dtype=torch.float64) tensor(25.0653, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1755.8458251953125
value loss:157.9162139892578
entropies:354.44549560546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.952032804489136 seconds
19 rew tensor(0.9843, dtype=torch.float64) delta_t tensor(0.6095, dtype=torch.float64)
19 gae_duplicate tensor(0.2644, dtype=torch.float64) tensor(-12.5262, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9848, dtype=torch.float64) delta_t tensor(0.6197, dtype=torch.float64)
18 gae_duplicate tensor(0.3383, dtype=torch.float64) tensor(-13.2381, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9854, dtype=torch.float64) delta_t tensor(0.6088, dtype=torch.float64)
17 gae_duplicate tensor(0.3521, dtype=torch.float64) tensor(-13.4980, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0107, dtype=torch.float64) delta_t tensor(0.6355, dtype=torch.float64)
16 gae_duplicate tensor(0.3601, dtype=torch.float64) tensor(-13.5754, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0002, dtype=torch.float64) delta_t tensor(0.6295, dtype=torch.float64)
15 gae_duplicate tensor(0.3676, dtype=torch.float64) tensor(-14.1806, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0507, dtype=torch.float64) delta_t tensor(0.6985, dtype=torch.float64)
14 gae_duplicate tensor(0.3723, dtype=torch.float64) tensor(-14.6678, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0541, dtype=torch.float64) delta_t tensor(0.7512, dtype=torch.float64)
13 gae_duplicate tensor(0.3992, dtype=torch.float64) tensor(-16.4639, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8745, dtype=torch.float64) delta_t tensor(0.5252, dtype=torch.float64)
12 gae_duplicate tensor(-0.3400, dtype=torch.float64) tensor(-12.1352, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6447, dtype=torch.float64) delta_t tensor(0.3718, dtype=torch.float64)
11 gae_duplicate tensor(-0.3856, dtype=torch.float64) tensor(-8.5526, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4912, dtype=torch.float64) delta_t tensor(0.2420, dtype=torch.float64)
10 gae_duplicate tensor(-0.2320, dtype=torch.float64) tensor(-5.4631, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2112, dtype=torch.float64) delta_t tensor(-0.6402, dtype=torch.float64)
9 gae_duplicate tensor(-0.7854, dtype=torch.float64) tensor(11.7888, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3058, dtype=torch.float64) delta_t tensor(-0.7315, dtype=torch.float64)
8 gae_duplicate tensor(-1.0785, dtype=torch.float64) tensor(15.4514, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7856, dtype=torch.float64) delta_t tensor(-1.2134, dtype=torch.float64)
7 gae_duplicate tensor(-3.6380, dtype=torch.float64) tensor(25.9783, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2217, dtype=torch.float64) delta_t tensor(-0.5985, dtype=torch.float64)
6 gae_duplicate tensor(-0.9352, dtype=torch.float64) tensor(14.3348, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9129, dtype=torch.float64) delta_t tensor(-1.3608, dtype=torch.float64)
5 gae_duplicate tensor(-1.6560, dtype=torch.float64) tensor(29.4710, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8582, dtype=torch.float64) delta_t tensor(-1.3753, dtype=torch.float64)
4 gae_duplicate tensor(-1.9030, dtype=torch.float64) tensor(29.0512, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2652, dtype=torch.float64) delta_t tensor(-1.3651, dtype=torch.float64)
3 gae_duplicate tensor(-2.0634, dtype=torch.float64) tensor(29.5825, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9893, dtype=torch.float64) delta_t tensor(-1.2781, dtype=torch.float64)
2 gae_duplicate tensor(-1.7714, dtype=torch.float64) tensor(27.1721, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3255.87939453125
value loss:167.52317810058594
entropies:352.9430847167969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.271920919418335 seconds
19 rew tensor(0.9829, dtype=torch.float64) delta_t tensor(0.4160, dtype=torch.float64)
19 gae_duplicate tensor(0.1776, dtype=torch.float64) tensor(-8.4054, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9929, dtype=torch.float64) delta_t tensor(0.4575, dtype=torch.float64)
18 gae_duplicate tensor(0.1954, dtype=torch.float64) tensor(-9.6848, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0033, dtype=torch.float64) delta_t tensor(0.4643, dtype=torch.float64)
17 gae_duplicate tensor(0.1947, dtype=torch.float64) tensor(-10.2583, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0140, dtype=torch.float64) delta_t tensor(0.4789, dtype=torch.float64)
16 gae_duplicate tensor(0.2143, dtype=torch.float64) tensor(-10.5524, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0250, dtype=torch.float64) delta_t tensor(0.5039, dtype=torch.float64)
15 gae_duplicate tensor(0.3051, dtype=torch.float64) tensor(-11.3176, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0365, dtype=torch.float64) delta_t tensor(0.5805, dtype=torch.float64)
14 gae_duplicate tensor(0.3115, dtype=torch.float64) tensor(-12.9233, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0483, dtype=torch.float64) delta_t tensor(0.6046, dtype=torch.float64)
13 gae_duplicate tensor(0.3225, dtype=torch.float64) tensor(-12.4480, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7473, dtype=torch.float64) delta_t tensor(0.2831, dtype=torch.float64)
12 gae_duplicate tensor(-0.1210, dtype=torch.float64) tensor(-6.6774, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6000, dtype=torch.float64) delta_t tensor(0.2467, dtype=torch.float64)
11 gae_duplicate tensor(-0.3013, dtype=torch.float64) tensor(-5.5721, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5033, dtype=torch.float64) delta_t tensor(0.2248, dtype=torch.float64)
10 gae_duplicate tensor(-0.2319, dtype=torch.float64) tensor(-5.0397, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1040, dtype=torch.float64) delta_t tensor(-0.6245, dtype=torch.float64)
9 gae_duplicate tensor(-0.7990, dtype=torch.float64) tensor(12.1827, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2171, dtype=torch.float64) delta_t tensor(-0.7723, dtype=torch.float64)
8 gae_duplicate tensor(-1.0821, dtype=torch.float64) tensor(15.3341, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3834, dtype=torch.float64) delta_t tensor(-0.9149, dtype=torch.float64)
7 gae_duplicate tensor(-2.1918, dtype=torch.float64) tensor(19.5631, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0936, dtype=torch.float64) delta_t tensor(-0.5189, dtype=torch.float64)
6 gae_duplicate tensor(-0.7025, dtype=torch.float64) tensor(12.6048, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8581, dtype=torch.float64) delta_t tensor(-1.3736, dtype=torch.float64)
5 gae_duplicate tensor(-2.0977, dtype=torch.float64) tensor(28.9838, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3016, dtype=torch.float64) delta_t tensor(-1.9065, dtype=torch.float64)
4 gae_duplicate tensor(-3.7901, dtype=torch.float64) tensor(39.6990, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2101, dtype=torch.float64) delta_t tensor(-1.3203, dtype=torch.float64)
3 gae_duplicate tensor(-1.8847, dtype=torch.float64) tensor(30.7483, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0886, dtype=torch.float64) delta_t tensor(-1.5766, dtype=torch.float64)
2 gae_duplicate tensor(-2.0313, dtype=torch.float64) tensor(32.2912, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5415.5341796875
value loss:165.22909545898438
entropies:351.9438171386719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3992.1809)
ToM Target loss= tensor(3408.5110)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.023772954940796 seconds
19 rew tensor(0.9473, dtype=torch.float64) delta_t tensor(0.3209, dtype=torch.float64)
19 gae_duplicate tensor(0.0476, dtype=torch.float64) tensor(-5.8877, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9551, dtype=torch.float64) delta_t tensor(0.3265, dtype=torch.float64)
18 gae_duplicate tensor(0.1313, dtype=torch.float64) tensor(-6.9807, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9631, dtype=torch.float64) delta_t tensor(0.3302, dtype=torch.float64)
17 gae_duplicate tensor(0.0982, dtype=torch.float64) tensor(-8.2630, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9713, dtype=torch.float64) delta_t tensor(0.3111, dtype=torch.float64)
16 gae_duplicate tensor(0.0769, dtype=torch.float64) tensor(-6.5136, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9797, dtype=torch.float64) delta_t tensor(0.3468, dtype=torch.float64)
15 gae_duplicate tensor(0.1584, dtype=torch.float64) tensor(-7.0184, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9884, dtype=torch.float64) delta_t tensor(0.3591, dtype=torch.float64)
14 gae_duplicate tensor(0.0320, dtype=torch.float64) tensor(-7.8043, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9972, dtype=torch.float64) delta_t tensor(0.4518, dtype=torch.float64)
13 gae_duplicate tensor(0.1874, dtype=torch.float64) tensor(-9.7953, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7793, dtype=torch.float64) delta_t tensor(0.2740, dtype=torch.float64)
12 gae_duplicate tensor(-0.2507, dtype=torch.float64) tensor(-6.4113, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4499, dtype=torch.float64) delta_t tensor(0.0316, dtype=torch.float64)
11 gae_duplicate tensor(-0.5259, dtype=torch.float64) tensor(-0.8066, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3753, dtype=torch.float64) delta_t tensor(-0.0438, dtype=torch.float64)
10 gae_duplicate tensor(-0.5008, dtype=torch.float64) tensor(0.7385, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1486, dtype=torch.float64) delta_t tensor(-0.6798, dtype=torch.float64)
9 gae_duplicate tensor(-0.8348, dtype=torch.float64) tensor(13.6241, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3028, dtype=torch.float64) delta_t tensor(-0.9360, dtype=torch.float64)
8 gae_duplicate tensor(-1.1790, dtype=torch.float64) tensor(18.8052, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3048, dtype=torch.float64) delta_t tensor(-0.9483, dtype=torch.float64)
7 gae_duplicate tensor(-1.1998, dtype=torch.float64) tensor(21.1501, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3404, dtype=torch.float64) delta_t tensor(-0.8311, dtype=torch.float64)
6 gae_duplicate tensor(-2.0165, dtype=torch.float64) tensor(17.2606, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7257, dtype=torch.float64) delta_t tensor(-1.2386, dtype=torch.float64)
5 gae_duplicate tensor(-1.9256, dtype=torch.float64) tensor(25.6034, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7674, dtype=torch.float64) delta_t tensor(-2.3452, dtype=torch.float64)
4 gae_duplicate tensor(-8.1857, dtype=torch.float64) tensor(49.6126, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2498, dtype=torch.float64) delta_t tensor(-1.4935, dtype=torch.float64)
3 gae_duplicate tensor(-2.3500, dtype=torch.float64) tensor(34.5235, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8396, dtype=torch.float64) delta_t tensor(-1.3094, dtype=torch.float64)
2 gae_duplicate tensor(-1.9158, dtype=torch.float64) tensor(27.7585, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-8173.11669921875
value loss:231.7296600341797
entropies:351.7005615234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.3004701137542725 seconds
19 rew tensor(0.9572, dtype=torch.float64) delta_t tensor(0.1543, dtype=torch.float64)
19 gae_duplicate tensor(-0.0259, dtype=torch.float64) tensor(-3.0654, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9639, dtype=torch.float64) delta_t tensor(0.2004, dtype=torch.float64)
18 gae_duplicate tensor(0.0233, dtype=torch.float64) tensor(-3.9534, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9709, dtype=torch.float64) delta_t tensor(0.1992, dtype=torch.float64)
17 gae_duplicate tensor(-0.0017, dtype=torch.float64) tensor(-3.9558, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9779, dtype=torch.float64) delta_t tensor(0.2461, dtype=torch.float64)
16 gae_duplicate tensor(0.0128, dtype=torch.float64) tensor(-5.2779, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9852, dtype=torch.float64) delta_t tensor(0.3376, dtype=torch.float64)
15 gae_duplicate tensor(0.1183, dtype=torch.float64) tensor(-6.5606, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9926, dtype=torch.float64) delta_t tensor(0.3049, dtype=torch.float64)
14 gae_duplicate tensor(0.0743, dtype=torch.float64) tensor(-6.5009, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0001, dtype=torch.float64) delta_t tensor(0.4447, dtype=torch.float64)
13 gae_duplicate tensor(0.2482, dtype=torch.float64) tensor(-8.7878, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7496, dtype=torch.float64) delta_t tensor(0.2065, dtype=torch.float64)
12 gae_duplicate tensor(-0.3677, dtype=torch.float64) tensor(-5.1350, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3467, dtype=torch.float64) delta_t tensor(-0.1471, dtype=torch.float64)
11 gae_duplicate tensor(-0.7442, dtype=torch.float64) tensor(2.1914, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1839, dtype=torch.float64) delta_t tensor(-0.2147, dtype=torch.float64)
10 gae_duplicate tensor(-0.5549, dtype=torch.float64) tensor(4.4483, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1845, dtype=torch.float64) delta_t tensor(-0.7982, dtype=torch.float64)
9 gae_duplicate tensor(-1.2975, dtype=torch.float64) tensor(16.5085, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2677, dtype=torch.float64) delta_t tensor(-0.9482, dtype=torch.float64)
8 gae_duplicate tensor(-1.7432, dtype=torch.float64) tensor(19.9029, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4876, dtype=torch.float64) delta_t tensor(-1.1510, dtype=torch.float64)
7 gae_duplicate tensor(-2.4694, dtype=torch.float64) tensor(25.6813, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0533, dtype=torch.float64) delta_t tensor(-0.4782, dtype=torch.float64)
6 gae_duplicate tensor(-0.7517, dtype=torch.float64) tensor(11.5248, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5801, dtype=torch.float64) delta_t tensor(-1.1770, dtype=torch.float64)
5 gae_duplicate tensor(-1.4965, dtype=torch.float64) tensor(23.3767, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9344, dtype=torch.float64) delta_t tensor(-1.4040, dtype=torch.float64)
4 gae_duplicate tensor(-1.7458, dtype=torch.float64) tensor(30.5908, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1550, dtype=torch.float64) delta_t tensor(-1.2844, dtype=torch.float64)
3 gae_duplicate tensor(-1.8583, dtype=torch.float64) tensor(28.2762, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1565, dtype=torch.float64) delta_t tensor(-1.6963, dtype=torch.float64)
2 gae_duplicate tensor(-2.3118, dtype=torch.float64) tensor(34.8195, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-8415.44921875
value loss:134.37750244140625
entropies:351.6358642578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.391993045806885 seconds
19 rew tensor(0.9620, dtype=torch.float64) delta_t tensor(0.1639, dtype=torch.float64)
19 gae_duplicate tensor(-0.0366, dtype=torch.float64) tensor(-3.0789, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9679, dtype=torch.float64) delta_t tensor(0.1739, dtype=torch.float64)
18 gae_duplicate tensor(0.0187, dtype=torch.float64) tensor(-3.8718, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9740, dtype=torch.float64) delta_t tensor(0.1632, dtype=torch.float64)
17 gae_duplicate tensor(0.0048, dtype=torch.float64) tensor(-3.3165, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9802, dtype=torch.float64) delta_t tensor(0.1732, dtype=torch.float64)
16 gae_duplicate tensor(0.0119, dtype=torch.float64) tensor(-3.7789, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9865, dtype=torch.float64) delta_t tensor(0.2542, dtype=torch.float64)
15 gae_duplicate tensor(-0.0418, dtype=torch.float64) tensor(-5.2403, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9929, dtype=torch.float64) delta_t tensor(0.2654, dtype=torch.float64)
14 gae_duplicate tensor(0.0460, dtype=torch.float64) tensor(-5.9959, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9994, dtype=torch.float64) delta_t tensor(0.3974, dtype=torch.float64)
13 gae_duplicate tensor(0.2634, dtype=torch.float64) tensor(-7.6338, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8720, dtype=torch.float64) delta_t tensor(0.2579, dtype=torch.float64)
12 gae_duplicate tensor(-0.2677, dtype=torch.float64) tensor(-5.9818, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4839, dtype=torch.float64) delta_t tensor(-0.0379, dtype=torch.float64)
11 gae_duplicate tensor(-0.3709, dtype=torch.float64) tensor(0.5776, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4605, dtype=torch.float64) delta_t tensor(0.0347, dtype=torch.float64)
10 gae_duplicate tensor(-0.3280, dtype=torch.float64) tensor(-0.7490, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0893, dtype=torch.float64) delta_t tensor(-0.6337, dtype=torch.float64)
9 gae_duplicate tensor(-0.9758, dtype=torch.float64) tensor(12.6694, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3114, dtype=torch.float64) delta_t tensor(-0.9987, dtype=torch.float64)
8 gae_duplicate tensor(-1.1519, dtype=torch.float64) tensor(21.3974, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4721, dtype=torch.float64) delta_t tensor(-1.1627, dtype=torch.float64)
7 gae_duplicate tensor(-1.9660, dtype=torch.float64) tensor(23.9455, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2443, dtype=torch.float64) delta_t tensor(-1.7991, dtype=torch.float64)
6 gae_duplicate tensor(-3.3141, dtype=torch.float64) tensor(37.5751, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0545, dtype=torch.float64) delta_t tensor(-1.5600, dtype=torch.float64)
5 gae_duplicate tensor(-2.6439, dtype=torch.float64) tensor(36.0534, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8748, dtype=torch.float64) delta_t tensor(-1.3971, dtype=torch.float64)
4 gae_duplicate tensor(-2.0376, dtype=torch.float64) tensor(31.1649, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2435, dtype=torch.float64) delta_t tensor(-1.3253, dtype=torch.float64)
3 gae_duplicate tensor(-1.6807, dtype=torch.float64) tensor(29.3464, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1270, dtype=torch.float64) delta_t tensor(-1.6323, dtype=torch.float64)
2 gae_duplicate tensor(-2.2185, dtype=torch.float64) tensor(33.8421, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-10188.73828125
value loss:184.01876831054688
entropies:351.08489990234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.194804906845093 seconds
19 rew tensor(0.9603, dtype=torch.float64) delta_t tensor(0.1223, dtype=torch.float64)
19 gae_duplicate tensor(-0.0965, dtype=torch.float64) tensor(-2.4305, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9531, dtype=torch.float64) delta_t tensor(0.1221, dtype=torch.float64)
18 gae_duplicate tensor(-0.0329, dtype=torch.float64) tensor(-2.4218, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9582, dtype=torch.float64) delta_t tensor(0.1205, dtype=torch.float64)
17 gae_duplicate tensor(-0.0319, dtype=torch.float64) tensor(-2.6634, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9635, dtype=torch.float64) delta_t tensor(0.2044, dtype=torch.float64)
16 gae_duplicate tensor(-0.0246, dtype=torch.float64) tensor(-3.8116, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9564, dtype=torch.float64) delta_t tensor(0.2886, dtype=torch.float64)
15 gae_duplicate tensor(0.0518, dtype=torch.float64) tensor(-5.5935, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9617, dtype=torch.float64) delta_t tensor(0.2576, dtype=torch.float64)
14 gae_duplicate tensor(0.0587, dtype=torch.float64) tensor(-5.4924, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8921, dtype=torch.float64) delta_t tensor(0.3094, dtype=torch.float64)
13 gae_duplicate tensor(0.0599, dtype=torch.float64) tensor(-6.1601, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7508, dtype=torch.float64) delta_t tensor(0.1679, dtype=torch.float64)
12 gae_duplicate tensor(-0.4289, dtype=torch.float64) tensor(-4.1022, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4837, dtype=torch.float64) delta_t tensor(0.0206, dtype=torch.float64)
11 gae_duplicate tensor(-1.0386, dtype=torch.float64) tensor(-0.3634, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3025, dtype=torch.float64) delta_t tensor(-0.1438, dtype=torch.float64)
10 gae_duplicate tensor(-1.0893, dtype=torch.float64) tensor(3.2170, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2870, dtype=torch.float64) delta_t tensor(-0.8883, dtype=torch.float64)
9 gae_duplicate tensor(-1.7119, dtype=torch.float64) tensor(19.1087, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5625, dtype=torch.float64) delta_t tensor(-1.2053, dtype=torch.float64)
8 gae_duplicate tensor(-3.0404, dtype=torch.float64) tensor(25.9943, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5140, dtype=torch.float64) delta_t tensor(-1.1454, dtype=torch.float64)
7 gae_duplicate tensor(-2.4956, dtype=torch.float64) tensor(23.3789, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8710, dtype=torch.float64) delta_t tensor(-1.3982, dtype=torch.float64)
6 gae_duplicate tensor(-4.7291, dtype=torch.float64) tensor(30.1806, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2528, dtype=torch.float64) delta_t tensor(-1.7662, dtype=torch.float64)
5 gae_duplicate tensor(-4.1390, dtype=torch.float64) tensor(37.1035, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2553, dtype=torch.float64) delta_t tensor(-1.5102, dtype=torch.float64)
4 gae_duplicate tensor(-3.7180, dtype=torch.float64) tensor(31.3942, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1340, dtype=torch.float64) delta_t tensor(-1.2992, dtype=torch.float64)
3 gae_duplicate tensor(-1.9231, dtype=torch.float64) tensor(27.8664, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1030, dtype=torch.float64) delta_t tensor(-1.5584, dtype=torch.float64)
2 gae_duplicate tensor(-2.1714, dtype=torch.float64) tensor(35.9764, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-10958.3271484375
value loss:223.45111083984375
entropies:350.1656799316406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.580347299575806 seconds
19 rew tensor(0.9641, dtype=torch.float64) delta_t tensor(0.0999, dtype=torch.float64)
19 gae_duplicate tensor(-0.0327, dtype=torch.float64) tensor(-1.8977, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9689, dtype=torch.float64) delta_t tensor(0.1327, dtype=torch.float64)
18 gae_duplicate tensor(-0.0149, dtype=torch.float64) tensor(-2.6839, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9737, dtype=torch.float64) delta_t tensor(0.1407, dtype=torch.float64)
17 gae_duplicate tensor(-0.0058, dtype=torch.float64) tensor(-2.8708, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9786, dtype=torch.float64) delta_t tensor(0.1959, dtype=torch.float64)
16 gae_duplicate tensor(0.0171, dtype=torch.float64) tensor(-3.7815, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9836, dtype=torch.float64) delta_t tensor(0.2930, dtype=torch.float64)
15 gae_duplicate tensor(0.0739, dtype=torch.float64) tensor(-5.5958, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9886, dtype=torch.float64) delta_t tensor(0.2849, dtype=torch.float64)
14 gae_duplicate tensor(0.0746, dtype=torch.float64) tensor(-6.6699, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9937, dtype=torch.float64) delta_t tensor(0.5327, dtype=torch.float64)
13 gae_duplicate tensor(0.3409, dtype=torch.float64) tensor(-10.6767, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6102, dtype=torch.float64) delta_t tensor(0.1068, dtype=torch.float64)
12 gae_duplicate tensor(-0.1373, dtype=torch.float64) tensor(-3.0935, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2457, dtype=torch.float64) delta_t tensor(-0.2801, dtype=torch.float64)
11 gae_duplicate tensor(-0.6007, dtype=torch.float64) tensor(5.2295, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1625, dtype=torch.float64) delta_t tensor(-0.1878, dtype=torch.float64)
10 gae_duplicate tensor(-0.9116, dtype=torch.float64) tensor(4.3314, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0055, dtype=torch.float64) delta_t tensor(-0.6205, dtype=torch.float64)
9 gae_duplicate tensor(-1.0079, dtype=torch.float64) tensor(11.6491, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1940, dtype=torch.float64) delta_t tensor(-0.9134, dtype=torch.float64)
8 gae_duplicate tensor(-1.1981, dtype=torch.float64) tensor(18.8582, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2682, dtype=torch.float64) delta_t tensor(-0.9045, dtype=torch.float64)
7 gae_duplicate tensor(-1.7981, dtype=torch.float64) tensor(18.9113, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.4265, dtype=torch.float64) delta_t tensor(-1.9446, dtype=torch.float64)
6 gae_duplicate tensor(-4.3987, dtype=torch.float64) tensor(39.4420, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0181, dtype=torch.float64) delta_t tensor(-1.4209, dtype=torch.float64)
5 gae_duplicate tensor(-2.5122, dtype=torch.float64) tensor(32.4867, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7821, dtype=torch.float64) delta_t tensor(-0.9968, dtype=torch.float64)
4 gae_duplicate tensor(-1.8218, dtype=torch.float64) tensor(21.9066, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1138, dtype=torch.float64) delta_t tensor(-1.2360, dtype=torch.float64)
3 gae_duplicate tensor(-1.8231, dtype=torch.float64) tensor(26.6436, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0506, dtype=torch.float64) delta_t tensor(-1.6058, dtype=torch.float64)
2 gae_duplicate tensor(-2.0968, dtype=torch.float64) tensor(35.7367, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-9702.3525390625
value loss:171.37457275390625
entropies:349.5927429199219
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3945.3040)
ToM Target loss= tensor(3352.1990)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.867111921310425 seconds
19 rew tensor(0.9484, dtype=torch.float64) delta_t tensor(0.1346, dtype=torch.float64)
19 gae_duplicate tensor(0.0100, dtype=torch.float64) tensor(-2.1699, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9526, dtype=torch.float64) delta_t tensor(0.1930, dtype=torch.float64)
18 gae_duplicate tensor(0.0561, dtype=torch.float64) tensor(-3.9923, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9568, dtype=torch.float64) delta_t tensor(0.1437, dtype=torch.float64)
17 gae_duplicate tensor(0.0348, dtype=torch.float64) tensor(-2.9176, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9611, dtype=torch.float64) delta_t tensor(0.1678, dtype=torch.float64)
16 gae_duplicate tensor(0.0490, dtype=torch.float64) tensor(-3.6262, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9654, dtype=torch.float64) delta_t tensor(0.3168, dtype=torch.float64)
15 gae_duplicate tensor(0.1870, dtype=torch.float64) tensor(-6.6940, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9698, dtype=torch.float64) delta_t tensor(0.2517, dtype=torch.float64)
14 gae_duplicate tensor(0.0381, dtype=torch.float64) tensor(-5.5392, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9743, dtype=torch.float64) delta_t tensor(0.4513, dtype=torch.float64)
13 gae_duplicate tensor(0.2663, dtype=torch.float64) tensor(-8.9214, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8551, dtype=torch.float64) delta_t tensor(0.3225, dtype=torch.float64)
12 gae_duplicate tensor(0.0650, dtype=torch.float64) tensor(-7.1439, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2946, dtype=torch.float64) delta_t tensor(-0.1398, dtype=torch.float64)
11 gae_duplicate tensor(-0.4537, dtype=torch.float64) tensor(2.2037, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2536, dtype=torch.float64) delta_t tensor(-0.1493, dtype=torch.float64)
10 gae_duplicate tensor(-0.6391, dtype=torch.float64) tensor(2.8259, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0323, dtype=torch.float64) delta_t tensor(-0.5309, dtype=torch.float64)
9 gae_duplicate tensor(-0.6992, dtype=torch.float64) tensor(10.9308, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0880, dtype=torch.float64) delta_t tensor(-0.7026, dtype=torch.float64)
8 gae_duplicate tensor(-0.8547, dtype=torch.float64) tensor(14.3684, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7318, dtype=torch.float64) delta_t tensor(-1.3498, dtype=torch.float64)
7 gae_duplicate tensor(-4.0536, dtype=torch.float64) tensor(27.4583, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8521, dtype=torch.float64) delta_t tensor(-1.3023, dtype=torch.float64)
6 gae_duplicate tensor(-3.0700, dtype=torch.float64) tensor(28.6512, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3925, dtype=torch.float64) delta_t tensor(-1.7336, dtype=torch.float64)
5 gae_duplicate tensor(-3.9142, dtype=torch.float64) tensor(37.0994, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8722, dtype=torch.float64) delta_t tensor(-2.1383, dtype=torch.float64)
4 gae_duplicate tensor(-7.1699, dtype=torch.float64) tensor(46.2706, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1935, dtype=torch.float64) delta_t tensor(-1.3050, dtype=torch.float64)
3 gae_duplicate tensor(-2.2683, dtype=torch.float64) tensor(31.0995, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9279, dtype=torch.float64) delta_t tensor(-1.1964, dtype=torch.float64)
2 gae_duplicate tensor(-2.0640, dtype=torch.float64) tensor(24.8569, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-10071.2890625
value loss:261.4503479003906
entropies:349.00201416015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.353506088256836 seconds
19 rew tensor(0.9519, dtype=torch.float64) delta_t tensor(0.2120, dtype=torch.float64)
19 gae_duplicate tensor(0.1167, dtype=torch.float64) tensor(-4.0376, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9557, dtype=torch.float64) delta_t tensor(0.2343, dtype=torch.float64)
18 gae_duplicate tensor(0.0942, dtype=torch.float64) tensor(-4.9796, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9596, dtype=torch.float64) delta_t tensor(0.2757, dtype=torch.float64)
17 gae_duplicate tensor(0.1032, dtype=torch.float64) tensor(-5.7446, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9635, dtype=torch.float64) delta_t tensor(0.2385, dtype=torch.float64)
16 gae_duplicate tensor(0.1279, dtype=torch.float64) tensor(-4.9212, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9675, dtype=torch.float64) delta_t tensor(0.3101, dtype=torch.float64)
15 gae_duplicate tensor(0.2153, dtype=torch.float64) tensor(-6.2785, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9715, dtype=torch.float64) delta_t tensor(0.2991, dtype=torch.float64)
14 gae_duplicate tensor(0.1500, dtype=torch.float64) tensor(-6.8619, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9756, dtype=torch.float64) delta_t tensor(0.5393, dtype=torch.float64)
13 gae_duplicate tensor(0.4525, dtype=torch.float64) tensor(-11.3888, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7793, dtype=torch.float64) delta_t tensor(0.3739, dtype=torch.float64)
12 gae_duplicate tensor(-0.0087, dtype=torch.float64) tensor(-9.0175, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2367, dtype=torch.float64) delta_t tensor(-0.0828, dtype=torch.float64)
11 gae_duplicate tensor(-0.4471, dtype=torch.float64) tensor(0.5655, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0609, dtype=torch.float64) delta_t tensor(-0.2478, dtype=torch.float64)
10 gae_duplicate tensor(-0.5141, dtype=torch.float64) tensor(4.7752, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1715, dtype=torch.float64) delta_t tensor(-0.5888, dtype=torch.float64)
9 gae_duplicate tensor(-0.9564, dtype=torch.float64) tensor(11.5283, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2374, dtype=torch.float64) delta_t tensor(-0.7460, dtype=torch.float64)
8 gae_duplicate tensor(-1.0845, dtype=torch.float64) tensor(15.6896, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3864, dtype=torch.float64) delta_t tensor(-0.9009, dtype=torch.float64)
7 gae_duplicate tensor(-1.2762, dtype=torch.float64) tensor(19.4599, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8130, dtype=torch.float64) delta_t tensor(-1.1973, dtype=torch.float64)
6 gae_duplicate tensor(-3.1437, dtype=torch.float64) tensor(26.2442, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7603, dtype=torch.float64) delta_t tensor(-0.9644, dtype=torch.float64)
5 gae_duplicate tensor(-2.2217, dtype=torch.float64) tensor(21.1943, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3367, dtype=torch.float64) delta_t tensor(-1.4351, dtype=torch.float64)
4 gae_duplicate tensor(-4.2609, dtype=torch.float64) tensor(28.1441, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1786, dtype=torch.float64) delta_t tensor(-1.1217, dtype=torch.float64)
3 gae_duplicate tensor(-1.5194, dtype=torch.float64) tensor(24.9138, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8844, dtype=torch.float64) delta_t tensor(-1.0816, dtype=torch.float64)
2 gae_duplicate tensor(-1.8456, dtype=torch.float64) tensor(23.0861, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6702.162109375
value loss:137.1409912109375
entropies:348.55902099609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.713990211486816 seconds
19 rew tensor(0.9501, dtype=torch.float64) delta_t tensor(0.2714, dtype=torch.float64)
19 gae_duplicate tensor(0.1898, dtype=torch.float64) tensor(-5.1293, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9421, dtype=torch.float64) delta_t tensor(0.2578, dtype=torch.float64)
18 gae_duplicate tensor(0.1831, dtype=torch.float64) tensor(-5.2537, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9456, dtype=torch.float64) delta_t tensor(0.3485, dtype=torch.float64)
17 gae_duplicate tensor(0.1743, dtype=torch.float64) tensor(-7.6288, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9491, dtype=torch.float64) delta_t tensor(0.3354, dtype=torch.float64)
16 gae_duplicate tensor(0.2711, dtype=torch.float64) tensor(-7.5167, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9297, dtype=torch.float64) delta_t tensor(0.3351, dtype=torch.float64)
15 gae_duplicate tensor(0.0976, dtype=torch.float64) tensor(-7.5127, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9562, dtype=torch.float64) delta_t tensor(0.3787, dtype=torch.float64)
14 gae_duplicate tensor(0.2539, dtype=torch.float64) tensor(-8.7797, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9598, dtype=torch.float64) delta_t tensor(0.5399, dtype=torch.float64)
13 gae_duplicate tensor(0.4229, dtype=torch.float64) tensor(-11.1691, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8401, dtype=torch.float64) delta_t tensor(0.4160, dtype=torch.float64)
12 gae_duplicate tensor(0.0913, dtype=torch.float64) tensor(-9.9227, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4983, dtype=torch.float64) delta_t tensor(0.2367, dtype=torch.float64)
11 gae_duplicate tensor(-0.3710, dtype=torch.float64) tensor(-4.7660, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4115, dtype=torch.float64) delta_t tensor(0.1942, dtype=torch.float64)
10 gae_duplicate tensor(-0.4521, dtype=torch.float64) tensor(-4.6481, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0035, dtype=torch.float64) delta_t tensor(-0.3735, dtype=torch.float64)
9 gae_duplicate tensor(-0.5565, dtype=torch.float64) tensor(6.8546, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1484, dtype=torch.float64) delta_t tensor(-0.5392, dtype=torch.float64)
8 gae_duplicate tensor(-1.0895, dtype=torch.float64) tensor(10.8092, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2200, dtype=torch.float64) delta_t tensor(-0.6113, dtype=torch.float64)
7 gae_duplicate tensor(-1.2832, dtype=torch.float64) tensor(13.1064, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1738, dtype=torch.float64) delta_t tensor(-1.3995, dtype=torch.float64)
6 gae_duplicate tensor(-2.9446, dtype=torch.float64) tensor(27.1746, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7590, dtype=torch.float64) delta_t tensor(-1.8298, dtype=torch.float64)
5 gae_duplicate tensor(-4.8455, dtype=torch.float64) tensor(38.7369, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8601, dtype=torch.float64) delta_t tensor(-0.8004, dtype=torch.float64)
4 gae_duplicate tensor(-1.2381, dtype=torch.float64) tensor(18.2507, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2413, dtype=torch.float64) delta_t tensor(-1.0651, dtype=torch.float64)
3 gae_duplicate tensor(-1.4702, dtype=torch.float64) tensor(22.4033, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0212, dtype=torch.float64) delta_t tensor(-1.0923, dtype=torch.float64)
2 gae_duplicate tensor(-1.6689, dtype=torch.float64) tensor(22.6351, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4826.904296875
value loss:144.7081298828125
entropies:348.5832214355469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.427679061889648 seconds
19 rew tensor(0.9542, dtype=torch.float64) delta_t tensor(0.3002, dtype=torch.float64)
19 gae_duplicate tensor(0.2246, dtype=torch.float64) tensor(-5.2715, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9575, dtype=torch.float64) delta_t tensor(0.3272, dtype=torch.float64)
18 gae_duplicate tensor(0.2450, dtype=torch.float64) tensor(-7.1281, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9609, dtype=torch.float64) delta_t tensor(0.3396, dtype=torch.float64)
17 gae_duplicate tensor(0.2534, dtype=torch.float64) tensor(-6.7606, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9642, dtype=torch.float64) delta_t tensor(0.3883, dtype=torch.float64)
16 gae_duplicate tensor(0.2811, dtype=torch.float64) tensor(-8.4559, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9676, dtype=torch.float64) delta_t tensor(0.4456, dtype=torch.float64)
15 gae_duplicate tensor(0.4025, dtype=torch.float64) tensor(-9.5251, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9711, dtype=torch.float64) delta_t tensor(0.5307, dtype=torch.float64)
14 gae_duplicate tensor(0.4062, dtype=torch.float64) tensor(-10.8474, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9745, dtype=torch.float64) delta_t tensor(0.6068, dtype=torch.float64)
13 gae_duplicate tensor(0.4327, dtype=torch.float64) tensor(-13.5492, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8090, dtype=torch.float64) delta_t tensor(0.5302, dtype=torch.float64)
12 gae_duplicate tensor(0.2698, dtype=torch.float64) tensor(-12.6637, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5686, dtype=torch.float64) delta_t tensor(0.4044, dtype=torch.float64)
11 gae_duplicate tensor(0.0386, dtype=torch.float64) tensor(-9.0767, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3003, dtype=torch.float64) delta_t tensor(0.2145, dtype=torch.float64)
10 gae_duplicate tensor(0.0701, dtype=torch.float64) tensor(-5.3167, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3134, dtype=torch.float64) delta_t tensor(-0.5609, dtype=torch.float64)
9 gae_duplicate tensor(-0.7684, dtype=torch.float64) tensor(10.1592, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3887, dtype=torch.float64) delta_t tensor(-0.7118, dtype=torch.float64)
8 gae_duplicate tensor(-1.0164, dtype=torch.float64) tensor(15.5570, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7335, dtype=torch.float64) delta_t tensor(-0.9445, dtype=torch.float64)
7 gae_duplicate tensor(-2.9885, dtype=torch.float64) tensor(20.7766, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6000, dtype=torch.float64) delta_t tensor(-0.6905, dtype=torch.float64)
6 gae_duplicate tensor(-2.6796, dtype=torch.float64) tensor(15.3880, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9622, dtype=torch.float64) delta_t tensor(-0.9816, dtype=torch.float64)
5 gae_duplicate tensor(-1.8766, dtype=torch.float64) tensor(19.7727, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3059, dtype=torch.float64) delta_t tensor(-1.1675, dtype=torch.float64)
4 gae_duplicate tensor(-2.6182, dtype=torch.float64) tensor(23.6730, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0565, dtype=torch.float64) delta_t tensor(-0.8716, dtype=torch.float64)
3 gae_duplicate tensor(-1.2527, dtype=torch.float64) tensor(18.5445, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9899, dtype=torch.float64) delta_t tensor(-0.9968, dtype=torch.float64)
2 gae_duplicate tensor(-1.3749, dtype=torch.float64) tensor(22.1536, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3195.4619140625
value loss:111.85063171386719
entropies:349.0431823730469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.755820989608765 seconds
19 rew tensor(0.9520, dtype=torch.float64) delta_t tensor(0.3462, dtype=torch.float64)
19 gae_duplicate tensor(0.2293, dtype=torch.float64) tensor(-6.7547, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9551, dtype=torch.float64) delta_t tensor(0.4502, dtype=torch.float64)
18 gae_duplicate tensor(0.3183, dtype=torch.float64) tensor(-10.1636, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9581, dtype=torch.float64) delta_t tensor(0.4304, dtype=torch.float64)
17 gae_duplicate tensor(0.3440, dtype=torch.float64) tensor(-9.4154, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9613, dtype=torch.float64) delta_t tensor(0.4658, dtype=torch.float64)
16 gae_duplicate tensor(0.3806, dtype=torch.float64) tensor(-9.0166, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9644, dtype=torch.float64) delta_t tensor(0.4994, dtype=torch.float64)
15 gae_duplicate tensor(0.4046, dtype=torch.float64) tensor(-10.5279, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9676, dtype=torch.float64) delta_t tensor(0.5677, dtype=torch.float64)
14 gae_duplicate tensor(0.4075, dtype=torch.float64) tensor(-12.5331, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9400, dtype=torch.float64) delta_t tensor(0.5797, dtype=torch.float64)
13 gae_duplicate tensor(0.4344, dtype=torch.float64) tensor(-13.2052, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8380, dtype=torch.float64) delta_t tensor(0.5449, dtype=torch.float64)
12 gae_duplicate tensor(0.4503, dtype=torch.float64) tensor(-11.3759, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6506, dtype=torch.float64) delta_t tensor(0.5664, dtype=torch.float64)
11 gae_duplicate tensor(0.0241, dtype=torch.float64) tensor(-12.2999, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4776, dtype=torch.float64) delta_t tensor(0.3732, dtype=torch.float64)
10 gae_duplicate tensor(-0.3795, dtype=torch.float64) tensor(-7.6149, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1319, dtype=torch.float64) delta_t tensor(-0.3935, dtype=torch.float64)
9 gae_duplicate tensor(-0.4391, dtype=torch.float64) tensor(6.3927, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1923, dtype=torch.float64) delta_t tensor(-0.4407, dtype=torch.float64)
8 gae_duplicate tensor(-0.7473, dtype=torch.float64) tensor(9.6124, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1923, dtype=torch.float64) delta_t tensor(-0.2915, dtype=torch.float64)
7 gae_duplicate tensor(-0.6138, dtype=torch.float64) tensor(7.3601, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3937, dtype=torch.float64) delta_t tensor(-0.4008, dtype=torch.float64)
6 gae_duplicate tensor(-1.4188, dtype=torch.float64) tensor(8.6889, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3547, dtype=torch.float64) delta_t tensor(-1.2783, dtype=torch.float64)
5 gae_duplicate tensor(-2.5482, dtype=torch.float64) tensor(27.2552, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6348, dtype=torch.float64) delta_t tensor(-1.3282, dtype=torch.float64)
4 gae_duplicate tensor(-4.6113, dtype=torch.float64) tensor(31.6639, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9246, dtype=torch.float64) delta_t tensor(-0.6950, dtype=torch.float64)
3 gae_duplicate tensor(-1.2661, dtype=torch.float64) tensor(16.9367, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0255, dtype=torch.float64) delta_t tensor(-0.9657, dtype=torch.float64)
2 gae_duplicate tensor(-1.5657, dtype=torch.float64) tensor(19.8235, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1434.9549560546875
value loss:113.56572723388672
entropies:349.4261779785156
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3932.8015)
ToM Target loss= tensor(3301.3630)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.2766900062561035 seconds
19 rew tensor(0.9518, dtype=torch.float64) delta_t tensor(0.4381, dtype=torch.float64)
19 gae_duplicate tensor(0.2867, dtype=torch.float64) tensor(-8.9215, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9547, dtype=torch.float64) delta_t tensor(0.4699, dtype=torch.float64)
18 gae_duplicate tensor(0.4029, dtype=torch.float64) tensor(-10.8064, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9576, dtype=torch.float64) delta_t tensor(0.4983, dtype=torch.float64)
17 gae_duplicate tensor(0.4154, dtype=torch.float64) tensor(-9.6512, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9605, dtype=torch.float64) delta_t tensor(0.4853, dtype=torch.float64)
16 gae_duplicate tensor(0.4387, dtype=torch.float64) tensor(-10.9471, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9635, dtype=torch.float64) delta_t tensor(0.5715, dtype=torch.float64)
15 gae_duplicate tensor(0.4621, dtype=torch.float64) tensor(-11.1352, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9664, dtype=torch.float64) delta_t tensor(0.6029, dtype=torch.float64)
14 gae_duplicate tensor(0.4890, dtype=torch.float64) tensor(-12.2202, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9694, dtype=torch.float64) delta_t tensor(0.8068, dtype=torch.float64)
13 gae_duplicate tensor(0.6278, dtype=torch.float64) tensor(-17.4859, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7587, dtype=torch.float64) delta_t tensor(0.5768, dtype=torch.float64)
12 gae_duplicate tensor(0.5028, dtype=torch.float64) tensor(-13.1128, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4022, dtype=torch.float64) delta_t tensor(0.4324, dtype=torch.float64)
11 gae_duplicate tensor(0.0999, dtype=torch.float64) tensor(-9.7721, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2899, dtype=torch.float64) delta_t tensor(0.3088, dtype=torch.float64)
10 gae_duplicate tensor(-0.4527, dtype=torch.float64) tensor(-7.3037, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1456, dtype=torch.float64) delta_t tensor(-0.3248, dtype=torch.float64)
9 gae_duplicate tensor(-0.5624, dtype=torch.float64) tensor(5.7276, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2681, dtype=torch.float64) delta_t tensor(-0.4443, dtype=torch.float64)
8 gae_duplicate tensor(-0.6209, dtype=torch.float64) tensor(9.6869, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2990, dtype=torch.float64) delta_t tensor(-0.4355, dtype=torch.float64)
7 gae_duplicate tensor(-0.6514, dtype=torch.float64) tensor(9.4146, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2116, dtype=torch.float64) delta_t tensor(-1.1972, dtype=torch.float64)
6 gae_duplicate tensor(-4.0332, dtype=torch.float64) tensor(21.6573, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1299, dtype=torch.float64) delta_t tensor(-0.8447, dtype=torch.float64)
5 gae_duplicate tensor(-1.8674, dtype=torch.float64) tensor(19.7463, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4098, dtype=torch.float64) delta_t tensor(-0.9328, dtype=torch.float64)
4 gae_duplicate tensor(-3.6786, dtype=torch.float64) tensor(19.4181, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1144, dtype=torch.float64) delta_t tensor(-0.7685, dtype=torch.float64)
3 gae_duplicate tensor(-1.0662, dtype=torch.float64) tensor(16.5518, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0369, dtype=torch.float64) delta_t tensor(-0.9267, dtype=torch.float64)
2 gae_duplicate tensor(-1.3720, dtype=torch.float64) tensor(20.3223, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-697.6151733398438
value loss:127.18772888183594
entropies:349.9784240722656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.271862030029297 seconds
19 rew tensor(0.9541, dtype=torch.float64) delta_t tensor(0.5401, dtype=torch.float64)
19 gae_duplicate tensor(0.3745, dtype=torch.float64) tensor(-10.4182, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9568, dtype=torch.float64) delta_t tensor(0.4877, dtype=torch.float64)
18 gae_duplicate tensor(0.3890, dtype=torch.float64) tensor(-11.4896, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9596, dtype=torch.float64) delta_t tensor(0.5277, dtype=torch.float64)
17 gae_duplicate tensor(0.4066, dtype=torch.float64) tensor(-11.5377, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9623, dtype=torch.float64) delta_t tensor(0.5424, dtype=torch.float64)
16 gae_duplicate tensor(0.4649, dtype=torch.float64) tensor(-11.4014, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9651, dtype=torch.float64) delta_t tensor(0.6229, dtype=torch.float64)
15 gae_duplicate tensor(0.4683, dtype=torch.float64) tensor(-14.4152, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9679, dtype=torch.float64) delta_t tensor(0.7134, dtype=torch.float64)
14 gae_duplicate tensor(0.6542, dtype=torch.float64) tensor(-14.0826, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9707, dtype=torch.float64) delta_t tensor(0.8018, dtype=torch.float64)
13 gae_duplicate tensor(0.7171, dtype=torch.float64) tensor(-17.1754, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7785, dtype=torch.float64) delta_t tensor(0.6212, dtype=torch.float64)
12 gae_duplicate tensor(0.5405, dtype=torch.float64) tensor(-13.2676, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5252, dtype=torch.float64) delta_t tensor(0.5253, dtype=torch.float64)
11 gae_duplicate tensor(-0.1495, dtype=torch.float64) tensor(-11.2982, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3764, dtype=torch.float64) delta_t tensor(0.5436, dtype=torch.float64)
10 gae_duplicate tensor(0.0698, dtype=torch.float64) tensor(-12.6052, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1128, dtype=torch.float64) delta_t tensor(-0.1747, dtype=torch.float64)
9 gae_duplicate tensor(-0.5222, dtype=torch.float64) tensor(2.4866, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2722, dtype=torch.float64) delta_t tensor(-0.3764, dtype=torch.float64)
8 gae_duplicate tensor(-0.8520, dtype=torch.float64) tensor(7.7683, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2576, dtype=torch.float64) delta_t tensor(-0.2405, dtype=torch.float64)
7 gae_duplicate tensor(-0.8022, dtype=torch.float64) tensor(5.2844, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0931, dtype=torch.float64) delta_t tensor(0.0327, dtype=torch.float64)
6 gae_duplicate tensor(-0.3448, dtype=torch.float64) tensor(-0.0102, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7590, dtype=torch.float64) delta_t tensor(-0.3886, dtype=torch.float64)
5 gae_duplicate tensor(-1.0272, dtype=torch.float64) tensor(7.2865, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9235, dtype=torch.float64) delta_t tensor(-0.3672, dtype=torch.float64)
4 gae_duplicate tensor(-0.6828, dtype=torch.float64) tensor(8.2071, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2131, dtype=torch.float64) delta_t tensor(-0.7358, dtype=torch.float64)
3 gae_duplicate tensor(-1.2370, dtype=torch.float64) tensor(15.6728, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1162, dtype=torch.float64) delta_t tensor(-0.8429, dtype=torch.float64)
2 gae_duplicate tensor(-1.1230, dtype=torch.float64) tensor(20.2328, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3186.619384765625
value loss:66.96553039550781
entropies:350.2522277832031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.765998125076294 seconds
19 rew tensor(0.9440, dtype=torch.float64) delta_t tensor(0.5373, dtype=torch.float64)
19 gae_duplicate tensor(0.4078, dtype=torch.float64) tensor(-10.8771, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9465, dtype=torch.float64) delta_t tensor(0.5083, dtype=torch.float64)
18 gae_duplicate tensor(0.5148, dtype=torch.float64) tensor(-11.4274, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9490, dtype=torch.float64) delta_t tensor(0.5018, dtype=torch.float64)
17 gae_duplicate tensor(0.4672, dtype=torch.float64) tensor(-11.1657, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9515, dtype=torch.float64) delta_t tensor(0.4953, dtype=torch.float64)
16 gae_duplicate tensor(0.4081, dtype=torch.float64) tensor(-10.8836, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9436, dtype=torch.float64) delta_t tensor(0.5650, dtype=torch.float64)
15 gae_duplicate tensor(0.4947, dtype=torch.float64) tensor(-11.5581, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9672, dtype=torch.float64) delta_t tensor(0.5739, dtype=torch.float64)
14 gae_duplicate tensor(0.4753, dtype=torch.float64) tensor(-12.5232, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9698, dtype=torch.float64) delta_t tensor(0.7706, dtype=torch.float64)
13 gae_duplicate tensor(0.5670, dtype=torch.float64) tensor(-15.5436, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9620, dtype=torch.float64) delta_t tensor(0.8119, dtype=torch.float64)
12 gae_duplicate tensor(0.7414, dtype=torch.float64) tensor(-18.3406, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6023, dtype=torch.float64) delta_t tensor(0.7190, dtype=torch.float64)
11 gae_duplicate tensor(0.0732, dtype=torch.float64) tensor(-15.8915, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4894, dtype=torch.float64) delta_t tensor(0.5718, dtype=torch.float64)
10 gae_duplicate tensor(0.0287, dtype=torch.float64) tensor(-13.2529, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0234, dtype=torch.float64) delta_t tensor(-0.0091, dtype=torch.float64)
9 gae_duplicate tensor(-0.1982, dtype=torch.float64) tensor(-1.0649, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1911, dtype=torch.float64) delta_t tensor(-0.1941, dtype=torch.float64)
8 gae_duplicate tensor(-0.6210, dtype=torch.float64) tensor(4.1549, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3068, dtype=torch.float64) delta_t tensor(-0.2101, dtype=torch.float64)
7 gae_duplicate tensor(-0.7044, dtype=torch.float64) tensor(4.3619, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6416, dtype=torch.float64) delta_t tensor(-0.4654, dtype=torch.float64)
6 gae_duplicate tensor(-2.3499, dtype=torch.float64) tensor(9.1394, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8567, dtype=torch.float64) delta_t tensor(-0.4007, dtype=torch.float64)
5 gae_duplicate tensor(-1.3260, dtype=torch.float64) tensor(8.3790, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6303, dtype=torch.float64) delta_t tensor(-0.1086, dtype=torch.float64)
4 gae_duplicate tensor(-0.7251, dtype=torch.float64) tensor(2.8651, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0724, dtype=torch.float64) delta_t tensor(-0.5611, dtype=torch.float64)
3 gae_duplicate tensor(-0.7659, dtype=torch.float64) tensor(12.3832, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9524, dtype=torch.float64) delta_t tensor(-0.7026, dtype=torch.float64)
2 gae_duplicate tensor(-1.0659, dtype=torch.float64) tensor(14.0906, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4071.79638671875
value loss:73.09690856933594
entropies:350.1690979003906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.2205188274383545 seconds
19 rew tensor(0.9411, dtype=torch.float64) delta_t tensor(0.4361, dtype=torch.float64)
19 gae_duplicate tensor(0.3049, dtype=torch.float64) tensor(-9.2687, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9435, dtype=torch.float64) delta_t tensor(0.4658, dtype=torch.float64)
18 gae_duplicate tensor(0.3927, dtype=torch.float64) tensor(-9.5616, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9458, dtype=torch.float64) delta_t tensor(0.4891, dtype=torch.float64)
17 gae_duplicate tensor(0.4035, dtype=torch.float64) tensor(-10.3072, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9482, dtype=torch.float64) delta_t tensor(0.4925, dtype=torch.float64)
16 gae_duplicate tensor(0.4065, dtype=torch.float64) tensor(-10.9479, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9381, dtype=torch.float64) delta_t tensor(0.4403, dtype=torch.float64)
15 gae_duplicate tensor(0.3750, dtype=torch.float64) tensor(-10.0155, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9655, dtype=torch.float64) delta_t tensor(0.7033, dtype=torch.float64)
14 gae_duplicate tensor(0.4327, dtype=torch.float64) tensor(-14.3051, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9555, dtype=torch.float64) delta_t tensor(0.7798, dtype=torch.float64)
13 gae_duplicate tensor(0.4647, dtype=torch.float64) tensor(-17.0369, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5658, dtype=torch.float64) delta_t tensor(0.5475, dtype=torch.float64)
12 gae_duplicate tensor(0.2453, dtype=torch.float64) tensor(-12.2195, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4340, dtype=torch.float64) delta_t tensor(0.5359, dtype=torch.float64)
11 gae_duplicate tensor(0.0861, dtype=torch.float64) tensor(-10.7505, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1848, dtype=torch.float64) delta_t tensor(0.4738, dtype=torch.float64)
10 gae_duplicate tensor(0.1323, dtype=torch.float64) tensor(-10.1676, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3338, dtype=torch.float64) delta_t tensor(-0.2433, dtype=torch.float64)
9 gae_duplicate tensor(-0.3353, dtype=torch.float64) tensor(4.0153, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5311, dtype=torch.float64) delta_t tensor(-0.5861, dtype=torch.float64)
8 gae_duplicate tensor(-0.9373, dtype=torch.float64) tensor(12.2656, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9207, dtype=torch.float64) delta_t tensor(-0.7395, dtype=torch.float64)
7 gae_duplicate tensor(-3.4165, dtype=torch.float64) tensor(16.9906, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7178, dtype=torch.float64) delta_t tensor(-0.4791, dtype=torch.float64)
6 gae_duplicate tensor(-3.1369, dtype=torch.float64) tensor(10.1884, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4984, dtype=torch.float64) delta_t tensor(-1.0526, dtype=torch.float64)
5 gae_duplicate tensor(-3.4630, dtype=torch.float64) tensor(20.6650, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8149, dtype=torch.float64) delta_t tensor(-1.2229, dtype=torch.float64)
4 gae_duplicate tensor(-4.5091, dtype=torch.float64) tensor(26.0815, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1913, dtype=torch.float64) delta_t tensor(-0.6553, dtype=torch.float64)
3 gae_duplicate tensor(-1.4814, dtype=torch.float64) tensor(14.7654, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9316, dtype=torch.float64) delta_t tensor(-0.7263, dtype=torch.float64)
2 gae_duplicate tensor(-1.1374, dtype=torch.float64) tensor(16.5750, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-470.8207702636719
value loss:151.9416046142578
entropies:350.47296142578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.182701110839844 seconds
19 rew tensor(0.9541, dtype=torch.float64) delta_t tensor(0.4554, dtype=torch.float64)
19 gae_duplicate tensor(0.2037, dtype=torch.float64) tensor(-8.8881, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9564, dtype=torch.float64) delta_t tensor(0.4226, dtype=torch.float64)
18 gae_duplicate tensor(0.3052, dtype=torch.float64) tensor(-9.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9587, dtype=torch.float64) delta_t tensor(0.4051, dtype=torch.float64)
17 gae_duplicate tensor(0.3294, dtype=torch.float64) tensor(-8.3491, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9610, dtype=torch.float64) delta_t tensor(0.4534, dtype=torch.float64)
16 gae_duplicate tensor(0.3554, dtype=torch.float64) tensor(-10.0111, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9634, dtype=torch.float64) delta_t tensor(0.5287, dtype=torch.float64)
15 gae_duplicate tensor(0.3576, dtype=torch.float64) tensor(-10.6824, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9657, dtype=torch.float64) delta_t tensor(0.5291, dtype=torch.float64)
14 gae_duplicate tensor(0.3870, dtype=torch.float64) tensor(-11.4688, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9681, dtype=torch.float64) delta_t tensor(0.5816, dtype=torch.float64)
13 gae_duplicate tensor(0.4001, dtype=torch.float64) tensor(-12.7925, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9335, dtype=torch.float64) delta_t tensor(0.6453, dtype=torch.float64)
12 gae_duplicate tensor(0.4768, dtype=torch.float64) tensor(-13.6026, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7747, dtype=torch.float64) delta_t tensor(0.8897, dtype=torch.float64)
11 gae_duplicate tensor(0.2829, dtype=torch.float64) tensor(-18.0578, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6104, dtype=torch.float64) delta_t tensor(0.7356, dtype=torch.float64)
10 gae_duplicate tensor(0.3831, dtype=torch.float64) tensor(-15.2514, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1707, dtype=torch.float64) delta_t tensor(-0.1552, dtype=torch.float64)
9 gae_duplicate tensor(-0.3802, dtype=torch.float64) tensor(1.6144, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2065, dtype=torch.float64) delta_t tensor(-0.1687, dtype=torch.float64)
8 gae_duplicate tensor(-0.5524, dtype=torch.float64) tensor(3.2186, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3566, dtype=torch.float64) delta_t tensor(-0.2433, dtype=torch.float64)
7 gae_duplicate tensor(-0.8336, dtype=torch.float64) tensor(5.6905, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2701, dtype=torch.float64) delta_t tensor(0.0256, dtype=torch.float64)
6 gae_duplicate tensor(-0.2343, dtype=torch.float64) tensor(-0.0089, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9251, dtype=torch.float64) delta_t tensor(-0.3749, dtype=torch.float64)
5 gae_duplicate tensor(-0.9935, dtype=torch.float64) tensor(6.9886, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8738, dtype=torch.float64) delta_t tensor(-0.1523, dtype=torch.float64)
4 gae_duplicate tensor(-0.4724, dtype=torch.float64) tensor(3.6035, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1369, dtype=torch.float64) delta_t tensor(-0.5145, dtype=torch.float64)
3 gae_duplicate tensor(-0.8126, dtype=torch.float64) tensor(10.8465, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0640, dtype=torch.float64) delta_t tensor(-0.6979, dtype=torch.float64)
2 gae_duplicate tensor(-0.9708, dtype=torch.float64) tensor(14.7659, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3767.07763671875
value loss:55.528560638427734
entropies:350.18280029296875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3921.3174)
ToM Target loss= tensor(3263.4744)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.14599084854126 seconds
19 rew tensor(0.9556, dtype=torch.float64) delta_t tensor(0.3419, dtype=torch.float64)
19 gae_duplicate tensor(0.1341, dtype=torch.float64) tensor(-7.0858, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9578, dtype=torch.float64) delta_t tensor(0.3200, dtype=torch.float64)
18 gae_duplicate tensor(0.2418, dtype=torch.float64) tensor(-7.2542, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9600, dtype=torch.float64) delta_t tensor(0.3203, dtype=torch.float64)
17 gae_duplicate tensor(0.2524, dtype=torch.float64) tensor(-6.4280, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9623, dtype=torch.float64) delta_t tensor(0.3214, dtype=torch.float64)
16 gae_duplicate tensor(0.2552, dtype=torch.float64) tensor(-6.5864, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9645, dtype=torch.float64) delta_t tensor(0.3958, dtype=torch.float64)
15 gae_duplicate tensor(0.2740, dtype=torch.float64) tensor(-8.9658, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9668, dtype=torch.float64) delta_t tensor(0.3797, dtype=torch.float64)
14 gae_duplicate tensor(0.3002, dtype=torch.float64) tensor(-7.8616, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9690, dtype=torch.float64) delta_t tensor(0.7031, dtype=torch.float64)
13 gae_duplicate tensor(0.5157, dtype=torch.float64) tensor(-13.7199, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9369, dtype=torch.float64) delta_t tensor(0.7669, dtype=torch.float64)
12 gae_duplicate tensor(0.5154, dtype=torch.float64) tensor(-15.3997, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4551, dtype=torch.float64) delta_t tensor(0.5557, dtype=torch.float64)
11 gae_duplicate tensor(0.2217, dtype=torch.float64) tensor(-12.5523, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3613, dtype=torch.float64) delta_t tensor(0.5289, dtype=torch.float64)
10 gae_duplicate tensor(0.0238, dtype=torch.float64) tensor(-12.0200, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0694, dtype=torch.float64) delta_t tensor(-0.0222, dtype=torch.float64)
9 gae_duplicate tensor(-0.1709, dtype=torch.float64) tensor(-0.8323, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2239, dtype=torch.float64) delta_t tensor(-0.2943, dtype=torch.float64)
8 gae_duplicate tensor(-0.5977, dtype=torch.float64) tensor(5.6661, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3359, dtype=torch.float64) delta_t tensor(-0.3319, dtype=torch.float64)
7 gae_duplicate tensor(-0.7026, dtype=torch.float64) tensor(6.8628, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6633, dtype=torch.float64) delta_t tensor(-0.4262, dtype=torch.float64)
6 gae_duplicate tensor(-2.5105, dtype=torch.float64) tensor(8.9955, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9080, dtype=torch.float64) delta_t tensor(-0.3663, dtype=torch.float64)
5 gae_duplicate tensor(-1.4285, dtype=torch.float64) tensor(7.5755, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6855, dtype=torch.float64) delta_t tensor(0.0459, dtype=torch.float64)
4 gae_duplicate tensor(-0.2572, dtype=torch.float64) tensor(-0.1085, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2530, dtype=torch.float64) delta_t tensor(-0.5707, dtype=torch.float64)
3 gae_duplicate tensor(-0.9305, dtype=torch.float64) tensor(10.9708, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9763, dtype=torch.float64) delta_t tensor(-0.6800, dtype=torch.float64)
2 gae_duplicate tensor(-0.9783, dtype=torch.float64) tensor(14.3539, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2302.52099609375
value loss:57.94793701171875
entropies:350.13934326171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8937389850616455 seconds
19 rew tensor(0.9576, dtype=torch.float64) delta_t tensor(0.2517, dtype=torch.float64)
19 gae_duplicate tensor(0.0130, dtype=torch.float64) tensor(-4.8578, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9597, dtype=torch.float64) delta_t tensor(0.2270, dtype=torch.float64)
18 gae_duplicate tensor(0.1002, dtype=torch.float64) tensor(-4.9150, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9618, dtype=torch.float64) delta_t tensor(0.2219, dtype=torch.float64)
17 gae_duplicate tensor(0.1154, dtype=torch.float64) tensor(-4.7708, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9639, dtype=torch.float64) delta_t tensor(0.2187, dtype=torch.float64)
16 gae_duplicate tensor(0.1182, dtype=torch.float64) tensor(-4.8969, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9661, dtype=torch.float64) delta_t tensor(0.2433, dtype=torch.float64)
15 gae_duplicate tensor(0.1193, dtype=torch.float64) tensor(-5.0479, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9682, dtype=torch.float64) delta_t tensor(0.3705, dtype=torch.float64)
14 gae_duplicate tensor(0.2296, dtype=torch.float64) tensor(-7.2252, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9704, dtype=torch.float64) delta_t tensor(0.6339, dtype=torch.float64)
13 gae_duplicate tensor(0.3637, dtype=torch.float64) tensor(-12.8968, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8544, dtype=torch.float64) delta_t tensor(0.7125, dtype=torch.float64)
12 gae_duplicate tensor(0.5586, dtype=torch.float64) tensor(-15.4146, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4538, dtype=torch.float64) delta_t tensor(0.5140, dtype=torch.float64)
11 gae_duplicate tensor(0.1713, dtype=torch.float64) tensor(-11.0715, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2112, dtype=torch.float64) delta_t tensor(0.3773, dtype=torch.float64)
10 gae_duplicate tensor(0.1206, dtype=torch.float64) tensor(-9.1591, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2571, dtype=torch.float64) delta_t tensor(-0.2253, dtype=torch.float64)
9 gae_duplicate tensor(-0.4081, dtype=torch.float64) tensor(3.3934, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3487, dtype=torch.float64) delta_t tensor(-0.3260, dtype=torch.float64)
8 gae_duplicate tensor(-0.6629, dtype=torch.float64) tensor(6.4450, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4936, dtype=torch.float64) delta_t tensor(-0.4905, dtype=torch.float64)
7 gae_duplicate tensor(-0.8197, dtype=torch.float64) tensor(10.2142, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8365, dtype=torch.float64) delta_t tensor(-0.5361, dtype=torch.float64)
6 gae_duplicate tensor(-3.9703, dtype=torch.float64) tensor(13.5585, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7533, dtype=torch.float64) delta_t tensor(-0.1826, dtype=torch.float64)
5 gae_duplicate tensor(-0.5715, dtype=torch.float64) tensor(4.8846, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9914, dtype=torch.float64) delta_t tensor(-0.2083, dtype=torch.float64)
4 gae_duplicate tensor(-0.7036, dtype=torch.float64) tensor(4.5908, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2693, dtype=torch.float64) delta_t tensor(-0.5349, dtype=torch.float64)
3 gae_duplicate tensor(-0.8532, dtype=torch.float64) tensor(10.8531, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1260, dtype=torch.float64) delta_t tensor(-0.7427, dtype=torch.float64)
2 gae_duplicate tensor(-1.2866, dtype=torch.float64) tensor(15.4802, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:490.6573181152344
value loss:62.578399658203125
entropies:349.90771484375
Policy training finished
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt