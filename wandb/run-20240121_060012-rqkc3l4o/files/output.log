True
obs <crafter.objects.Shelter object at 0x1428acb80> [39.  0.  0.  0. 39.  0.  0.  0. 10.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [38.  0.  0.  0. 39.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [ 9.  0.  0.  0.  9.  0.  0.  0. 12.  0.  0.  0.]
obs <crafter.objects.Shelter object at 0x1428acb80> [39.  0.  0.  0. 39.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [42.  0.  0.  0. 39.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [ 9.  0.  0.  0.  9.  0.  0.  0. 12.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
obs_space.shape (3, 3, 12) lstm_out 32
feature_dim 71 lstm_out 32
2024-01-21 06:00:20,705 : lr: 0.001
2024-01-21 06:00:20,705 : gamma: 0.1
2024-01-21 06:00:20,705 : gamma_rate: 0.002
2024-01-21 06:00:20,706 : gamma_final: 0.9
2024-01-21 06:00:20,706 : tau: 1.0
2024-01-21 06:00:20,706 : entropy: 0.005
2024-01-21 06:00:20,706 : grad_entropy: 1.0
2024-01-21 06:00:20,706 : seed: 1
2024-01-21 06:00:20,706 : workers: 6
2024-01-21 06:00:20,706 : A2C_steps: 20
2024-01-21 06:00:20,706 : env_steps: 20
2024-01-21 06:00:20,706 : start_eps: 2000
2024-01-21 06:00:20,706 : ToM_train_loops: 1
2024-01-21 06:00:20,706 : policy_train_loops: 1
2024-01-21 06:00:20,706 : test_eps: 20
2024-01-21 06:00:20,706 : ToM_frozen: 5
2024-01-21 06:00:20,706 : env: RA
2024-01-21 06:00:20,706 : optimizer: Adam
2024-01-21 06:00:20,706 : amsgrad: True
2024-01-21 06:00:20,706 : load_model_dir: None
2024-01-21 06:00:20,706 : load_executor_dir: None
2024-01-21 06:00:20,706 : log_dir: logs/RA/Jan21_06-00
2024-01-21 06:00:20,706 : model: ToM2C
2024-01-21 06:00:20,706 : gpu_id: [-1]
2024-01-21 06:00:20,707 : norm_reward: True
2024-01-21 06:00:20,707 : train_comm: False
2024-01-21 06:00:20,707 : random_target: True
2024-01-21 06:00:20,707 : mask_actions: False
2024-01-21 06:00:20,707 : mask: False
2024-01-21 06:00:20,707 : render: False
2024-01-21 06:00:20,707 : fix: False
2024-01-21 06:00:20,707 : shared_optimizer: True
2024-01-21 06:00:20,707 : train_mode: -1
2024-01-21 06:00:20,707 : lstm_out: 32
2024-01-21 06:00:20,707 : sleep_time: 0
2024-01-21 06:00:20,707 : max_step: 3000000
2024-01-21 06:00:20,707 : render_save: False
2024-01-21 06:00:20,707 : num_agents: -1
2024-01-21 06:00:20,707 : num_targets: -1
Process Process-8:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/test.py", line 83, in test
    player.action_test()
  File "/Users/suhuangyuan/DRA/ToM2C/player_util.py", line 178, in action_test
    state_multi, self.reward, self.done, self.info = self.env.step(actions)#, obstacle=True)
  File "/Users/suhuangyuan/DRA/ToM2C/environment.py", line 88, in step
    if done_n: self.env.reset()
  File "/Users/suhuangyuan/DRA/crafter/env.py", line 135, in reset
    worldgen.generate_world(self.world, self.players)
  File "/Users/suhuangyuan/DRA/crafter/worldgen.py", line 27, in generate_world
    _set_material(world, (x, y), player, tunnels, simplex)
  File "/Users/suhuangyuan/DRA/crafter/worldgen.py", line 38, in _set_material
    start += 2 * simplex(x, y, 8, 3)
  File "/Users/suhuangyuan/DRA/crafter/worldgen.py", line 99, in _simplex
    noise = simplex.noise3(x / size, y / size, z)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/site-packages/opensimplex/api.py", line 168, in noise3
    return _noise3(x, y, z, self._perm, self._perm_grad_index3)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/site-packages/opensimplex/internals.py", line 352, in _noise3
    value += attn3 * attn3 * _extrapolate3(perm, perm_grad_index3, xsb + 0, ysb + 0, zsb + 1, dx3, dy3, dz3)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/site-packages/opensimplex/internals.py", line 60, in _extrapolate3
    return g1 * dx + g2 * dy + g3 * dz
KeyboardInterrupt
obs <crafter.objects.Shelter object at 0x1428acb80> [39.  0.  0.  0. 39.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [39.  0.  0.  0. 39.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [ 9.  0.  0.  0.  9.  0.  0.  0. 11.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
Day: 1 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0, 0, 0, 0, 0, 0, 0] 16 9 30 30
[0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1]
obs <crafter.objects.Shelter object at 0x1428acb80> [30.  0.  0.  9. 30.  0.  0.  9.  9.  0.  0.  9.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [ 9.  0.  0.  0.  9.  0.  0.  0. 11.  0.  0.  0.]
Day: 2 [2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 18 9 21 21
[0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 1, 1]
out_requests ['Shelter->Station: Please send 12 staff', 'Shelter->Warehouse: Please send 9 food 9 drink ']
obs <crafter.objects.Shelter object at 0x1428acb80> [21.  9.  0.  9. 21.  9.  0.  9.  9. 12.  0.  9.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [ 9.  0.  0.  0.  9.  0.  0.  0. 11.  0.  0.  0.]
Day: 3 [3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0] 20 19 11 11
[0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 1, 1, 0, 1]
out_requests ['Shelter->Warehouse: Please send 9 food 9 drink ']
obs <crafter.objects.Shelter object at 0x1428acb80> [11.  9.  0. 19. 11.  9.  0. 19. 19.  2.  0. 19.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [9. 0. 0. 0. 9. 0. 0. 0. 1. 0. 0. 0.]
Day: 4 [4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 0, 0, 0] 22 14 1 1
[0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 1, 1, 0, 2, 1, 1]
out_requests ['Shelter->Station: Please send 10 staff', 'Shelter->Warehouse: Please send 29 food 29 drink ', '5 staff is returning to station']
obs <crafter.objects.Shelter object at 0x1428acb80> [ 1. 29.  9. 19.  1. 29.  9. 19. 14. 12. 10. 19.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [9. 0. 0. 0. 9. 0. 0. 0. 6. 0. 0. 0.]
Day: 5 [5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 2.0, 2.0, 2.0, 2.0, 0, 0, 0, 0, 0] 24 13 15 15
[0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 3, 2, 2, 1, 3, 2, 2, 1, 1]
out_requests ['Shelter->Station: Please send 5 staff', 'Shelter->Warehouse: Please send 19 food 19 drink ', '2 staff is returning to station']
obs <crafter.objects.Shelter object at 0x1428acb80> [15. 19.  9. 15. 15. 19.  9. 15. 13. 16.  0. 15.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [9. 0. 0. 0. 9. 0. 0. 0. 7. 0. 0. 0.]
Day: 6 [4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 3.0, 3.0, 3.0, 3.0, 1.0, 1.0, 1.0, 0, 0, 0, 0, 0, 0] 19 7 21 21
[2, 2, 2, 2, 2, 2, 3, 2, 2, 1, 3, 2, 2, 2, 2, 1, 1, 1, 1]
out_requests ['Shelter->Warehouse: Please send 11 food 11 drink ', '6 staff is returning to station']
out_requests ['5 staff is returning to the station.']
obs <crafter.objects.Shelter object at 0x1428acb80> [21. 11. 29. 13. 21. 11. 29. 13.  7. 16.  1. 13.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  4.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [ 9.  0.  0.  0.  9.  0.  0.  0. 18.  0.  0.  0.]
Day: 7 [5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 4.0, 3.0, 3.0, 3.0, 1.0, 1.0, 1.0, 0, 0, 0, 0, 0, 0] 19 4 25 25
[2, 2, 2, 2, 2, 2, 3, 3, 3, 2, 4, 3, 3, 3, 3, 2, 2, 2, 2]
out_requests ['Shelter->Station: Please send 2 staff', 'Shelter->Warehouse: Please send 11 food 11 drink ', '3 staff is returning to station']
out_requests ['2 staff is returning to the station.']
obs <crafter.objects.Shelter object at 0x1428acb80> [25. 11. 19.  7. 25. 11. 19.  7.  4. 18.  0.  7.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  2.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [ 9.  0.  0.  0.  9.  0.  0.  0. 23.  0.  0.  0.]
Day: 8 [5.0, 4.0, 4.0, 4.0, 2.0, 2.0, 2.0, 1.0, 1.0, 0, 0, 0, 0] 13 7 27 27
[3, 3, 3, 2, 4, 3, 3, 3, 3, 3, 3, 3, 3]
out_requests ['Shelter->Warehouse: Please send 1 food 1 drink ', '2 staff is returning to station']
out_requests ['1 staff is returning to the station.']
obs <crafter.objects.Shelter object at 0x1428acb80> [27.  1. 11.  9. 27.  1. 11.  9.  7. 13.  0.  9.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  1.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [ 9.  0.  0.  0.  9.  0.  0.  0. 21.  0.  0.  0.]
Day: 9 [5.0, 5.0, 5.0, 3.0, 3.0, 3.0, 2.0, 1.0, 0, 0, 0, 0] 12 6 21 21
[3, 3, 2, 4, 3, 3, 3, 4, 4, 4, 4, 4]
out_requests ['Shelter->Station: Please send 1 staff', 'Shelter->Warehouse: Please send 11 food 11 drink ', '1 staff is returning to station']
out_requests ['1 staff is returning to the station.']
obs <crafter.objects.Shelter object at 0x1428acb80> [21. 11. 11.  7. 21. 11. 11.  7.  6. 14.  5.  7.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  0.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [ 9.  0.  0.  0.  9.  0.  0.  0. 23.  0.  0.  0.]
Day: 10 [4.0, 4.0, 4.0, 3.0, 2.0, 1.0, 1.0, 1.0, 1.0] 9 18 23 23
[4, 3, 3, 3, 4, 4, 4, 4, 4]
out_requests ['Shelter->Warehouse: Please send 5 food 5 drink ', '1 staff is returning to station']
out_requests ['Warehouse->Station: Please send 1 staff']
obs <crafter.objects.Shelter object at 0x1428acb80> [23.  5.  1.  9. 23.  5.  1.  9. 18.  1.  0.  9.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  0.  1.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [ 9.  0.  0.  0.  9.  0.  0.  0. 11.  0.  0.  0.]
Day: 11 [5.0, 5.0, 5.0, 4.0, 3.0, 2.0, 2.0, 2.0, 2.0] 9 15 19 19
[4, 3, 3, 3, 4, 4, 4, 4, 4]
out_requests ['Shelter->Station: Please send 2 staff', 'Shelter->Warehouse: Please send 11 food 11 drink ', '3 staff is returning to station']
obs <crafter.objects.Shelter object at 0x1428acb80> [19. 11. 11.  9. 19. 11. 11.  9. 15.  3. 13.  9.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  5.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [9. 0. 0. 0. 9. 0. 0. 0. 9. 0. 0. 0.]
Day: 12 [5.0, 4.0, 3.0, 3.0, 3.0, 3.0] 6 17 24 24
[3, 4, 4, 4, 4, 4]
out_requests ['Shelter->Station: Please send 3 staff', 'Shelter->Warehouse: Please send 9 food 9 drink ', '1 staff is returning to station']
obs <crafter.objects.Shelter object at 0x1428acb80> [24.  9.  5.  6. 24.  9.  5.  6. 17.  3.  0.  6.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  5.  0.  5.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [9. 0. 0. 0. 9. 0. 0. 0. 7. 0. 0. 0.]
Day: 13 [5.0, 4.0, 4.0, 4.0, 4.0] 5 17 28 28
[4, 4, 4, 4, 4]
out_requests ['Shelter->Warehouse: Please send 3 food 3 drink ', '2 staff is returning to station']
obs <crafter.objects.Shelter object at 0x1428acb80> [28.  3. 11.  5. 28.  3. 11.  5. 17.  1.  3.  5.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  5.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [9. 0. 0. 0. 9. 0. 0. 0. 7. 0. 0. 0.]
Day: 14 [5.0, 5.0, 5.0, 5.0] 4 15 27 27
[4, 4, 4, 4]
out_requests ['Shelter->Warehouse: Please send 4 food 4 drink ', '2 staff is returning to station']
obs <crafter.objects.Shelter object at 0x1428acb80> [27.  4.  9.  4. 27.  4.  9.  4. 15.  1.  2.  4.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  5.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [9. 0. 0. 0. 9. 0. 0. 0. 9. 0. 0. 0.]
Day: 15 [] 0 14 31 31
[]
out_requests ['Shelter->Warehouse: Please send 3 food 3 drink ', '1 staff is returning to station']
obs <crafter.objects.Shelter object at 0x1428acb80> [31.  3.  3.  0. 31.  3.  3.  0. 14.  1.  0.  0.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  5.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [ 9.  0.  0.  0.  9.  0.  0.  0. 10.  0.  0.  0.]
Day: 16 [] 0 14 34 34
[]
out_requests ['3 staff is returning to the station.']
obs <crafter.objects.Shelter object at 0x1428acb80> [34.  0.  4.  0. 34.  0.  4.  0. 14.  1.  0.  0.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  2.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [ 9.  0.  0.  0.  9.  0.  0.  0. 13.  0.  0.  0.]
Day: 17 [] 0 14 34 34
[]
out_requests ['1 staff is returning to the station.']
obs <crafter.objects.Shelter object at 0x1428acb80> [34.  0.  3.  0. 34.  0.  3.  0. 14.  1.  0.  0.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  1.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [ 9.  0.  0.  0.  9.  0.  0.  0. 14.  0.  0.  0.]
Day: 18 [] 0 14 34 34
[]
out_requests ['1 staff is returning to the station.']
obs <crafter.objects.Shelter object at 0x1428acb80> [34.  0.  0.  0. 34.  0.  0.  0. 14.  1.  0.  0.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  0.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [ 9.  0.  0.  0.  9.  0.  0.  0. 15.  0.  0.  0.]
Day: 19 [] 0 14 34 34
[]
out_requests ['Warehouse->Station: Please send 1 staff']
obs <crafter.objects.Shelter object at 0x1428acb80> [34.  0.  0.  0. 34.  0.  0.  0. 14.  1.  0.  0.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0.  0.  1.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [ 9.  0.  0.  0.  9.  0.  0.  0. 15.  0.  0.  0.]
Day: 20 [] 0 9 34 34
[]
out_requests ['5 staff is returning to station']
obs <crafter.objects.Shelter object at 0x1428acb80> [34.  0.  0.  0. 34.  0.  0.  0.  9.  1.  0.  0.]
obs <crafter.objects.Warehouse object at 0x1428a08b0> [60.  0.  0.  0. 60.  0.  0.  0. 13.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1428a0a00> [9. 0. 0. 0. 9. 0. 0. 0. 7. 0. 0. 0.]