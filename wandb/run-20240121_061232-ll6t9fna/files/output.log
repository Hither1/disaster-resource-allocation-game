obs <crafter.objects.Shelter object at 0x147a1a880> [39.  0.  0.  0. 39.  0.  0.  0. 20.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x122e7b9d0> [40.  0.  0.  0. 42.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x147a21610> [9. 0. 0. 0. 9. 0. 0. 0. 9. 0. 0. 0.]
obs <crafter.objects.Shelter object at 0x147a1a880> [39.  0.  0.  0. 39.  0.  0.  0. 15.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x122e7b9d0> [39.  0.  0.  0. 41.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x147a21610> [ 9.  0.  0.  0.  9.  0.  0.  0. 11.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 3.4011220932006836 seconds
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
19 rew tensor(0.8025, dtype=torch.float64) delta_t tensor(0.9384, dtype=torch.float64)
19 gae_duplicate tensor(0.8408, dtype=torch.float64) tensor(-18.4387, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8374, dtype=torch.float64) delta_t tensor(0.9511, dtype=torch.float64)
18 gae_duplicate tensor(0.9170, dtype=torch.float64) tensor(-20.6067, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8773, dtype=torch.float64) delta_t tensor(0.9703, dtype=torch.float64)
17 gae_duplicate tensor(0.9655, dtype=torch.float64) tensor(-21.2400, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9236, dtype=torch.float64) delta_t tensor(0.9462, dtype=torch.float64)
16 gae_duplicate tensor(0.9997, dtype=torch.float64) tensor(-20.6298, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9785, dtype=torch.float64) delta_t tensor(1.0894, dtype=torch.float64)
15 gae_duplicate tensor(1.1048, dtype=torch.float64) tensor(-23.5691, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0447, dtype=torch.float64) delta_t tensor(1.1491, dtype=torch.float64)
14 gae_duplicate tensor(1.1861, dtype=torch.float64) tensor(-24.8839, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.1270, dtype=torch.float64) delta_t tensor(1.2197, dtype=torch.float64)
13 gae_duplicate tensor(1.2614, dtype=torch.float64) tensor(-26.0951, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.2333, dtype=torch.float64) delta_t tensor(1.4461, dtype=torch.float64)
12 gae_duplicate tensor(1.4566, dtype=torch.float64) tensor(-31.2804, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.3783, dtype=torch.float64) delta_t tensor(1.4418, dtype=torch.float64)
11 gae_duplicate tensor(1.4867, dtype=torch.float64) tensor(-31.5089, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(1.5748, dtype=torch.float64) delta_t tensor(1.6001, dtype=torch.float64)
10 gae_duplicate tensor(1.5956, dtype=torch.float64) tensor(-34.4341, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(1.4564, dtype=torch.float64) delta_t tensor(1.5421, dtype=torch.float64)
9 gae_duplicate tensor(1.5237, dtype=torch.float64) tensor(-33.9826, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(1.4827, dtype=torch.float64) delta_t tensor(1.4566, dtype=torch.float64)
8 gae_duplicate tensor(1.3887, dtype=torch.float64) tensor(-31.8770, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(1.5445, dtype=torch.float64) delta_t tensor(1.5337, dtype=torch.float64)
7 gae_duplicate tensor(1.5948, dtype=torch.float64) tensor(-33.4500, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.4774, dtype=torch.float64) delta_t tensor(1.6683, dtype=torch.float64)
6 gae_duplicate tensor(1.3078, dtype=torch.float64) tensor(-36.3523, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(1.1145, dtype=torch.float64) delta_t tensor(1.1538, dtype=torch.float64)
5 gae_duplicate tensor(0.1916, dtype=torch.float64) tensor(-26.2708, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8610, dtype=torch.float64) delta_t tensor(-0.7360, dtype=torch.float64)
4 gae_duplicate tensor(-1.0021, dtype=torch.float64) tensor(11.9636, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0377, dtype=torch.float64) delta_t tensor(-0.9252, dtype=torch.float64)
3 gae_duplicate tensor(-1.2517, dtype=torch.float64) tensor(19.4079, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9783, dtype=torch.float64) delta_t tensor(-1.0181, dtype=torch.float64)
2 gae_duplicate tensor(-1.3413, dtype=torch.float64) tensor(21.9376, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:19414.69921875
value loss:307.2544860839844
entropies:355.771728515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.7659361362457275 seconds
19 rew tensor(0.7817, dtype=torch.float64) delta_t tensor(0.7927, dtype=torch.float64)
19 gae_duplicate tensor(0.6710, dtype=torch.float64) tensor(-15.5277, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7594, dtype=torch.float64) delta_t tensor(0.7693, dtype=torch.float64)
18 gae_duplicate tensor(0.5886, dtype=torch.float64) tensor(-17.2398, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6895, dtype=torch.float64) delta_t tensor(0.7073, dtype=torch.float64)
17 gae_duplicate tensor(0.3145, dtype=torch.float64) tensor(-15.3361, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7628, dtype=torch.float64) delta_t tensor(0.7485, dtype=torch.float64)
16 gae_duplicate tensor(0.2665, dtype=torch.float64) tensor(-16.3765, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8911, dtype=torch.float64) delta_t tensor(0.9287, dtype=torch.float64)
15 gae_duplicate tensor(0.8943, dtype=torch.float64) tensor(-19.4951, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9141, dtype=torch.float64) delta_t tensor(1.0371, dtype=torch.float64)
14 gae_duplicate tensor(0.9795, dtype=torch.float64) tensor(-22.5595, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9391, dtype=torch.float64) delta_t tensor(1.0071, dtype=torch.float64)
13 gae_duplicate tensor(1.0067, dtype=torch.float64) tensor(-22.5886, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9663, dtype=torch.float64) delta_t tensor(1.0201, dtype=torch.float64)
12 gae_duplicate tensor(0.8598, dtype=torch.float64) tensor(-22.6036, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9865, dtype=torch.float64) delta_t tensor(1.0143, dtype=torch.float64)
11 gae_duplicate tensor(1.0813, dtype=torch.float64) tensor(-22.6613, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9998, dtype=torch.float64) delta_t tensor(1.0344, dtype=torch.float64)
10 gae_duplicate tensor(1.1131, dtype=torch.float64) tensor(-22.7066, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1198, dtype=torch.float64) delta_t tensor(0.1553, dtype=torch.float64)
9 gae_duplicate tensor(-1.2586, dtype=torch.float64) tensor(-5.0662, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5722, dtype=torch.float64) delta_t tensor(-0.6364, dtype=torch.float64)
8 gae_duplicate tensor(-2.5942, dtype=torch.float64) tensor(12.2031, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3352, dtype=torch.float64) delta_t tensor(-0.3598, dtype=torch.float64)
7 gae_duplicate tensor(-2.2381, dtype=torch.float64) tensor(8.3560, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2978, dtype=torch.float64) delta_t tensor(-0.1702, dtype=torch.float64)
6 gae_duplicate tensor(-1.9298, dtype=torch.float64) tensor(4.6056, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4752, dtype=torch.float64) delta_t tensor(-0.4290, dtype=torch.float64)
5 gae_duplicate tensor(-1.3981, dtype=torch.float64) tensor(8.7075, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8306, dtype=torch.float64) delta_t tensor(-0.7199, dtype=torch.float64)
4 gae_duplicate tensor(-1.3138, dtype=torch.float64) tensor(15.0510, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2070, dtype=torch.float64) delta_t tensor(-1.2612, dtype=torch.float64)
3 gae_duplicate tensor(-1.7099, dtype=torch.float64) tensor(26.8910, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1476, dtype=torch.float64) delta_t tensor(-1.1530, dtype=torch.float64)
2 gae_duplicate tensor(-1.8204, dtype=torch.float64) tensor(25.3307, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:5358.96337890625
value loss:180.12867736816406
entropies:355.18682861328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.7598137855529785 seconds
19 rew tensor(0.7802, dtype=torch.float64) delta_t tensor(0.6712, dtype=torch.float64)
19 gae_duplicate tensor(0.4641, dtype=torch.float64) tensor(-13.2784, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7353, dtype=torch.float64) delta_t tensor(0.6130, dtype=torch.float64)
18 gae_duplicate tensor(0.3381, dtype=torch.float64) tensor(-14.0893, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6132, dtype=torch.float64) delta_t tensor(0.4844, dtype=torch.float64)
17 gae_duplicate tensor(-0.0249, dtype=torch.float64) tensor(-10.5414, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6278, dtype=torch.float64) delta_t tensor(0.4819, dtype=torch.float64)
16 gae_duplicate tensor(-0.0581, dtype=torch.float64) tensor(-10.6166, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8919, dtype=torch.float64) delta_t tensor(0.7793, dtype=torch.float64)
15 gae_duplicate tensor(0.7190, dtype=torch.float64) tensor(-16.1755, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9066, dtype=torch.float64) delta_t tensor(0.8417, dtype=torch.float64)
14 gae_duplicate tensor(0.8107, dtype=torch.float64) tensor(-18.0004, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9220, dtype=torch.float64) delta_t tensor(0.8925, dtype=torch.float64)
13 gae_duplicate tensor(0.8114, dtype=torch.float64) tensor(-19.0513, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9382, dtype=torch.float64) delta_t tensor(0.9116, dtype=torch.float64)
12 gae_duplicate tensor(0.8522, dtype=torch.float64) tensor(-19.9706, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9442, dtype=torch.float64) delta_t tensor(0.8443, dtype=torch.float64)
11 gae_duplicate tensor(0.8743, dtype=torch.float64) tensor(-18.5385, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7152, dtype=torch.float64) delta_t tensor(0.5803, dtype=torch.float64)
10 gae_duplicate tensor(-0.4529, dtype=torch.float64) tensor(-12.9487, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0901, dtype=torch.float64) delta_t tensor(-0.0047, dtype=torch.float64)
9 gae_duplicate tensor(-1.3721, dtype=torch.float64) tensor(-1.3650, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1077, dtype=torch.float64) delta_t tensor(-0.0554, dtype=torch.float64)
8 gae_duplicate tensor(-1.8594, dtype=torch.float64) tensor(0.7809, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2030, dtype=torch.float64) delta_t tensor(-0.3836, dtype=torch.float64)
7 gae_duplicate tensor(-2.3193, dtype=torch.float64) tensor(7.0827, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2248, dtype=torch.float64) delta_t tensor(-0.2181, dtype=torch.float64)
6 gae_duplicate tensor(-0.5373, dtype=torch.float64) tensor(5.0635, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6132, dtype=torch.float64) delta_t tensor(-0.6381, dtype=torch.float64)
5 gae_duplicate tensor(-0.9200, dtype=torch.float64) tensor(13.1531, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2877, dtype=torch.float64) delta_t tensor(-1.2612, dtype=torch.float64)
4 gae_duplicate tensor(-1.7286, dtype=torch.float64) tensor(25.9219, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4465, dtype=torch.float64) delta_t tensor(-1.4844, dtype=torch.float64)
3 gae_duplicate tensor(-1.9741, dtype=torch.float64) tensor(32.1636, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3240, dtype=torch.float64) delta_t tensor(-1.3445, dtype=torch.float64)
2 gae_duplicate tensor(-1.8502, dtype=torch.float64) tensor(29.8980, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2091.89697265625
value loss:149.54014587402344
entropies:354.66021728515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 6.087437629699707 seconds
19 rew tensor(0.8349, dtype=torch.float64) delta_t tensor(0.5571, dtype=torch.float64)
19 gae_duplicate tensor(0.4573, dtype=torch.float64) tensor(-11.3399, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8243, dtype=torch.float64) delta_t tensor(0.5519, dtype=torch.float64)
18 gae_duplicate tensor(0.4804, dtype=torch.float64) tensor(-12.0682, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(0.5346, dtype=torch.float64)
17 gae_duplicate tensor(0.4563, dtype=torch.float64) tensor(-11.7626, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7640, dtype=torch.float64) delta_t tensor(0.4729, dtype=torch.float64)
16 gae_duplicate tensor(0.2743, dtype=torch.float64) tensor(-10.5644, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6363, dtype=torch.float64) delta_t tensor(0.4102, dtype=torch.float64)
15 gae_duplicate tensor(-0.0785, dtype=torch.float64) tensor(-8.9846, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8945, dtype=torch.float64) delta_t tensor(0.6527, dtype=torch.float64)
14 gae_duplicate tensor(0.6298, dtype=torch.float64) tensor(-13.5470, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9055, dtype=torch.float64) delta_t tensor(0.7192, dtype=torch.float64)
13 gae_duplicate tensor(0.7148, dtype=torch.float64) tensor(-15.6248, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9168, dtype=torch.float64) delta_t tensor(0.8177, dtype=torch.float64)
12 gae_duplicate tensor(0.6515, dtype=torch.float64) tensor(-17.5543, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9286, dtype=torch.float64) delta_t tensor(0.6398, dtype=torch.float64)
11 gae_duplicate tensor(0.6830, dtype=torch.float64) tensor(-14.6709, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8927, dtype=torch.float64) delta_t tensor(0.5980, dtype=torch.float64)
10 gae_duplicate tensor(0.5485, dtype=torch.float64) tensor(-13.2351, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6560, dtype=torch.float64) delta_t tensor(0.4212, dtype=torch.float64)
9 gae_duplicate tensor(0.3322, dtype=torch.float64) tensor(-9.5990, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1692, dtype=torch.float64) delta_t tensor(-0.4327, dtype=torch.float64)
8 gae_duplicate tensor(-2.7976, dtype=torch.float64) tensor(8.5162, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0777, dtype=torch.float64) delta_t tensor(-0.3503, dtype=torch.float64)
7 gae_duplicate tensor(-1.2050, dtype=torch.float64) tensor(7.4169, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2227, dtype=torch.float64) delta_t tensor(-0.2936, dtype=torch.float64)
6 gae_duplicate tensor(-0.4806, dtype=torch.float64) tensor(6.5149, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6942, dtype=torch.float64) delta_t tensor(-0.7922, dtype=torch.float64)
5 gae_duplicate tensor(-1.2381, dtype=torch.float64) tensor(16.6422, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5311, dtype=torch.float64) delta_t tensor(-1.5491, dtype=torch.float64)
4 gae_duplicate tensor(-2.3280, dtype=torch.float64) tensor(31.5340, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6448, dtype=torch.float64) delta_t tensor(-1.6501, dtype=torch.float64)
3 gae_duplicate tensor(-2.2193, dtype=torch.float64) tensor(35.3338, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4767, dtype=torch.float64) delta_t tensor(-1.6874, dtype=torch.float64)
2 gae_duplicate tensor(-2.3425, dtype=torch.float64) tensor(36.6054, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-290.7781677246094
value loss:157.81076049804688
entropies:354.430908203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.773477077484131 seconds
19 rew tensor(0.7597, dtype=torch.float64) delta_t tensor(0.3257, dtype=torch.float64)
19 gae_duplicate tensor(0.1542, dtype=torch.float64) tensor(-6.5855, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6838, dtype=torch.float64) delta_t tensor(0.2504, dtype=torch.float64)
18 gae_duplicate tensor(0.0426, dtype=torch.float64) tensor(-5.6062, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5041, dtype=torch.float64) delta_t tensor(0.0826, dtype=torch.float64)
17 gae_duplicate tensor(-0.2965, dtype=torch.float64) tensor(-2.1106, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6188, dtype=torch.float64) delta_t tensor(0.1960, dtype=torch.float64)
16 gae_duplicate tensor(-0.3300, dtype=torch.float64) tensor(-4.3150, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8804, dtype=torch.float64) delta_t tensor(0.4817, dtype=torch.float64)
15 gae_duplicate tensor(0.4349, dtype=torch.float64) tensor(-10.0063, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8887, dtype=torch.float64) delta_t tensor(0.6208, dtype=torch.float64)
14 gae_duplicate tensor(0.5199, dtype=torch.float64) tensor(-13.4123, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8972, dtype=torch.float64) delta_t tensor(0.6753, dtype=torch.float64)
13 gae_duplicate tensor(0.4773, dtype=torch.float64) tensor(-13.8892, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9059, dtype=torch.float64) delta_t tensor(0.5646, dtype=torch.float64)
12 gae_duplicate tensor(0.5479, dtype=torch.float64) tensor(-12.2672, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8951, dtype=torch.float64) delta_t tensor(0.5748, dtype=torch.float64)
11 gae_duplicate tensor(0.5597, dtype=torch.float64) tensor(-12.9644, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0550, dtype=torch.float64) delta_t tensor(-0.2884, dtype=torch.float64)
10 gae_duplicate tensor(-1.7505, dtype=torch.float64) tensor(3.9207, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9962, dtype=torch.float64) delta_t tensor(-1.3362, dtype=torch.float64)
9 gae_duplicate tensor(-4.1514, dtype=torch.float64) tensor(26.2503, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1013, dtype=torch.float64) delta_t tensor(-0.2146, dtype=torch.float64)
8 gae_duplicate tensor(-2.9359, dtype=torch.float64) tensor(6.0306, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3069, dtype=torch.float64) delta_t tensor(-0.0688, dtype=torch.float64)
7 gae_duplicate tensor(-0.2127, dtype=torch.float64) tensor(2.0127, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1724, dtype=torch.float64) delta_t tensor(-0.3938, dtype=torch.float64)
6 gae_duplicate tensor(-0.6887, dtype=torch.float64) tensor(8.2985, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5953, dtype=torch.float64) delta_t tensor(-0.7218, dtype=torch.float64)
5 gae_duplicate tensor(-1.0324, dtype=torch.float64) tensor(15.3989, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0914, dtype=torch.float64) delta_t tensor(-1.1389, dtype=torch.float64)
4 gae_duplicate tensor(-1.6691, dtype=torch.float64) tensor(23.7941, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5553, dtype=torch.float64) delta_t tensor(-1.6340, dtype=torch.float64)
3 gae_duplicate tensor(-2.1463, dtype=torch.float64) tensor(34.9285, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3432, dtype=torch.float64) delta_t tensor(-1.3684, dtype=torch.float64)
2 gae_duplicate tensor(-1.8766, dtype=torch.float64) tensor(30.5285, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3876.07080078125
value loss:157.4664764404297
entropies:354.6189880371094
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3978.2124)
ToM Target loss= tensor(3555.9146)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.410331964492798 seconds
19 rew tensor(0.8403, dtype=torch.float64) delta_t tensor(0.3650, dtype=torch.float64)
19 gae_duplicate tensor(0.1506, dtype=torch.float64) tensor(-7.0532, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8368, dtype=torch.float64) delta_t tensor(0.4109, dtype=torch.float64)
18 gae_duplicate tensor(0.1032, dtype=torch.float64) tensor(-8.8688, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.3794, dtype=torch.float64)
17 gae_duplicate tensor(-0.0639, dtype=torch.float64) tensor(-8.8603, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7636, dtype=torch.float64) delta_t tensor(0.2707, dtype=torch.float64)
16 gae_duplicate tensor(-0.3756, dtype=torch.float64) tensor(-6.1345, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8826, dtype=torch.float64) delta_t tensor(0.4674, dtype=torch.float64)
15 gae_duplicate tensor(0.2689, dtype=torch.float64) tensor(-9.5169, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8895, dtype=torch.float64) delta_t tensor(0.4640, dtype=torch.float64)
14 gae_duplicate tensor(0.3393, dtype=torch.float64) tensor(-10.2060, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8965, dtype=torch.float64) delta_t tensor(0.5439, dtype=torch.float64)
13 gae_duplicate tensor(0.4769, dtype=torch.float64) tensor(-11.7284, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9037, dtype=torch.float64) delta_t tensor(0.5755, dtype=torch.float64)
12 gae_duplicate tensor(0.3600, dtype=torch.float64) tensor(-12.6344, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9111, dtype=torch.float64) delta_t tensor(0.4033, dtype=torch.float64)
11 gae_duplicate tensor(0.3672, dtype=torch.float64) tensor(-9.1070, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9092, dtype=torch.float64) delta_t tensor(0.4572, dtype=torch.float64)
10 gae_duplicate tensor(0.4196, dtype=torch.float64) tensor(-9.9438, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0648, dtype=torch.float64) delta_t tensor(-0.3437, dtype=torch.float64)
9 gae_duplicate tensor(-2.9904, dtype=torch.float64) tensor(5.4228, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1583, dtype=torch.float64) delta_t tensor(-0.2820, dtype=torch.float64)
8 gae_duplicate tensor(-1.2462, dtype=torch.float64) tensor(6.1590, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1161, dtype=torch.float64) delta_t tensor(-0.3195, dtype=torch.float64)
7 gae_duplicate tensor(-0.5839, dtype=torch.float64) tensor(7.0301, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1282, dtype=torch.float64) delta_t tensor(-0.2382, dtype=torch.float64)
6 gae_duplicate tensor(-0.5244, dtype=torch.float64) tensor(5.2730, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6016, dtype=torch.float64) delta_t tensor(-0.7044, dtype=torch.float64)
5 gae_duplicate tensor(-1.0393, dtype=torch.float64) tensor(14.4724, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5184, dtype=torch.float64) delta_t tensor(-1.5437, dtype=torch.float64)
4 gae_duplicate tensor(-2.0199, dtype=torch.float64) tensor(32.0220, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4193, dtype=torch.float64) delta_t tensor(-1.4162, dtype=torch.float64)
3 gae_duplicate tensor(-1.9335, dtype=torch.float64) tensor(31.1453, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2083, dtype=torch.float64) delta_t tensor(-1.4065, dtype=torch.float64)
2 gae_duplicate tensor(-2.0093, dtype=torch.float64) tensor(30.4014, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2141.015869140625
value loss:118.56355285644531
entropies:355.1473388671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.396732807159424 seconds
19 rew tensor(0.7342, dtype=torch.float64) delta_t tensor(0.0556, dtype=torch.float64)
19 gae_duplicate tensor(-0.0140, dtype=torch.float64) tensor(-1.1177, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6475, dtype=torch.float64) delta_t tensor(0.0004, dtype=torch.float64)
18 gae_duplicate tensor(-0.1276, dtype=torch.float64) tensor(-0.1253, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4395, dtype=torch.float64) delta_t tensor(-0.1970, dtype=torch.float64)
17 gae_duplicate tensor(-0.4857, dtype=torch.float64) tensor(3.7756, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5005, dtype=torch.float64) delta_t tensor(-0.1117, dtype=torch.float64)
16 gae_duplicate tensor(-0.5227, dtype=torch.float64) tensor(2.5363, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8647, dtype=torch.float64) delta_t tensor(0.2663, dtype=torch.float64)
15 gae_duplicate tensor(0.1796, dtype=torch.float64) tensor(-4.9176, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8704, dtype=torch.float64) delta_t tensor(0.4241, dtype=torch.float64)
14 gae_duplicate tensor(0.2509, dtype=torch.float64) tensor(-8.8858, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8761, dtype=torch.float64) delta_t tensor(0.4847, dtype=torch.float64)
13 gae_duplicate tensor(0.2904, dtype=torch.float64) tensor(-10.3203, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8819, dtype=torch.float64) delta_t tensor(0.3010, dtype=torch.float64)
12 gae_duplicate tensor(0.2703, dtype=torch.float64) tensor(-7.0216, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8679, dtype=torch.float64) delta_t tensor(0.3319, dtype=torch.float64)
11 gae_duplicate tensor(0.2495, dtype=torch.float64) tensor(-7.2945, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8341, dtype=torch.float64) delta_t tensor(0.2998, dtype=torch.float64)
10 gae_duplicate tensor(0.2480, dtype=torch.float64) tensor(-6.6218, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.9787, dtype=torch.float64) delta_t tensor(-2.5292, dtype=torch.float64)
9 gae_duplicate tensor(-5.2630, dtype=torch.float64) tensor(48.6381, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0959, dtype=torch.float64) delta_t tensor(-0.5995, dtype=torch.float64)
8 gae_duplicate tensor(-3.0073, dtype=torch.float64) tensor(16.9767, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1279, dtype=torch.float64) delta_t tensor(-0.5901, dtype=torch.float64)
7 gae_duplicate tensor(-2.3576, dtype=torch.float64) tensor(13.3790, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4206, dtype=torch.float64) delta_t tensor(-0.6526, dtype=torch.float64)
6 gae_duplicate tensor(-1.6939, dtype=torch.float64) tensor(13.9253, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4959, dtype=torch.float64) delta_t tensor(-0.6187, dtype=torch.float64)
5 gae_duplicate tensor(-0.7857, dtype=torch.float64) tensor(13.6013, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0666, dtype=torch.float64) delta_t tensor(-1.0966, dtype=torch.float64)
4 gae_duplicate tensor(-2.1582, dtype=torch.float64) tensor(23.1202, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5999, dtype=torch.float64) delta_t tensor(-1.7910, dtype=torch.float64)
3 gae_duplicate tensor(-2.3338, dtype=torch.float64) tensor(37.7051, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4296, dtype=torch.float64) delta_t tensor(-1.5679, dtype=torch.float64)
2 gae_duplicate tensor(-2.2059, dtype=torch.float64) tensor(34.3074, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-8825.6826171875
value loss:222.9514617919922
entropies:355.6241760253906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.512269020080566 seconds
19 rew tensor(0.8354, dtype=torch.float64) delta_t tensor(0.1455, dtype=torch.float64)
19 gae_duplicate tensor(0.0098, dtype=torch.float64) tensor(-2.8735, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8306, dtype=torch.float64) delta_t tensor(0.2173, dtype=torch.float64)
18 gae_duplicate tensor(-0.0237, dtype=torch.float64) tensor(-4.5697, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8074, dtype=torch.float64) delta_t tensor(0.1564, dtype=torch.float64)
17 gae_duplicate tensor(-0.1950, dtype=torch.float64) tensor(-3.5344, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7566, dtype=torch.float64) delta_t tensor(0.0955, dtype=torch.float64)
16 gae_duplicate tensor(-0.4997, dtype=torch.float64) tensor(-2.2472, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8709, dtype=torch.float64) delta_t tensor(0.2793, dtype=torch.float64)
15 gae_duplicate tensor(0.1272, dtype=torch.float64) tensor(-5.7361, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8759, dtype=torch.float64) delta_t tensor(0.2730, dtype=torch.float64)
14 gae_duplicate tensor(0.1944, dtype=torch.float64) tensor(-5.9910, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8809, dtype=torch.float64) delta_t tensor(0.3321, dtype=torch.float64)
13 gae_duplicate tensor(0.1783, dtype=torch.float64) tensor(-7.1607, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8860, dtype=torch.float64) delta_t tensor(0.4763, dtype=torch.float64)
12 gae_duplicate tensor(0.2117, dtype=torch.float64) tensor(-10.1518, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8913, dtype=torch.float64) delta_t tensor(0.2271, dtype=torch.float64)
11 gae_duplicate tensor(0.2260, dtype=torch.float64) tensor(-5.5011, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8874, dtype=torch.float64) delta_t tensor(0.2501, dtype=torch.float64)
10 gae_duplicate tensor(0.2437, dtype=torch.float64) tensor(-5.4889, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1864, dtype=torch.float64) delta_t tensor(-0.3921, dtype=torch.float64)
9 gae_duplicate tensor(-1.9447, dtype=torch.float64) tensor(7.2401, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2075, dtype=torch.float64) delta_t tensor(-0.7486, dtype=torch.float64)
8 gae_duplicate tensor(-3.4667, dtype=torch.float64) tensor(15.4831, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0742, dtype=torch.float64) delta_t tensor(-0.6281, dtype=torch.float64)
7 gae_duplicate tensor(-1.5413, dtype=torch.float64) tensor(13.9395, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3694, dtype=torch.float64) delta_t tensor(-0.4805, dtype=torch.float64)
6 gae_duplicate tensor(-1.7419, dtype=torch.float64) tensor(11.0318, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6586, dtype=torch.float64) delta_t tensor(-0.7228, dtype=torch.float64)
5 gae_duplicate tensor(-1.1573, dtype=torch.float64) tensor(15.3856, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6738, dtype=torch.float64) delta_t tensor(-1.6478, dtype=torch.float64)
4 gae_duplicate tensor(-2.2060, dtype=torch.float64) tensor(34.1196, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6662, dtype=torch.float64) delta_t tensor(-1.6086, dtype=torch.float64)
3 gae_duplicate tensor(-2.1834, dtype=torch.float64) tensor(35.2084, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4862, dtype=torch.float64) delta_t tensor(-1.6886, dtype=torch.float64)
2 gae_duplicate tensor(-2.0480, dtype=torch.float64) tensor(36.7531, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6355.06689453125
value loss:141.81765747070312
entropies:355.9190673828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.503558874130249 seconds
19 rew tensor(0.7821, dtype=torch.float64) delta_t tensor(0.1181, dtype=torch.float64)
19 gae_duplicate tensor(-0.1041, dtype=torch.float64) tensor(-2.3383, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7375, dtype=torch.float64) delta_t tensor(0.1245, dtype=torch.float64)
18 gae_duplicate tensor(-0.2067, dtype=torch.float64) tensor(-2.6955, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6248, dtype=torch.float64) delta_t tensor(-0.0176, dtype=torch.float64)
17 gae_duplicate tensor(-0.5216, dtype=torch.float64) tensor(0.0744, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6230, dtype=torch.float64) delta_t tensor(-0.0462, dtype=torch.float64)
16 gae_duplicate tensor(-0.5427, dtype=torch.float64) tensor(0.9092, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8612, dtype=torch.float64) delta_t tensor(0.2524, dtype=torch.float64)
15 gae_duplicate tensor(0.1394, dtype=torch.float64) tensor(-4.9004, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8655, dtype=torch.float64) delta_t tensor(0.3271, dtype=torch.float64)
14 gae_duplicate tensor(0.2073, dtype=torch.float64) tensor(-6.9562, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8699, dtype=torch.float64) delta_t tensor(0.3839, dtype=torch.float64)
13 gae_duplicate tensor(0.2089, dtype=torch.float64) tensor(-8.3010, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8743, dtype=torch.float64) delta_t tensor(0.3978, dtype=torch.float64)
12 gae_duplicate tensor(0.2238, dtype=torch.float64) tensor(-8.6869, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8694, dtype=torch.float64) delta_t tensor(0.2776, dtype=torch.float64)
11 gae_duplicate tensor(0.2546, dtype=torch.float64) tensor(-6.3615, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8440, dtype=torch.float64) delta_t tensor(0.2841, dtype=torch.float64)
10 gae_duplicate tensor(0.2511, dtype=torch.float64) tensor(-6.2527, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3278, dtype=torch.float64) delta_t tensor(-0.8493, dtype=torch.float64)
9 gae_duplicate tensor(-3.0202, dtype=torch.float64) tensor(16.1324, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2456, dtype=torch.float64) delta_t tensor(-1.7715, dtype=torch.float64)
8 gae_duplicate tensor(-4.7475, dtype=torch.float64) tensor(36.6204, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3304, dtype=torch.float64) delta_t tensor(-0.8061, dtype=torch.float64)
7 gae_duplicate tensor(-2.6568, dtype=torch.float64) tensor(19.6461, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4281, dtype=torch.float64) delta_t tensor(-0.5523, dtype=torch.float64)
6 gae_duplicate tensor(-3.0687, dtype=torch.float64) tensor(12.8735, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3802, dtype=torch.float64) delta_t tensor(-0.4400, dtype=torch.float64)
5 gae_duplicate tensor(-0.7842, dtype=torch.float64) tensor(9.9997, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0104, dtype=torch.float64) delta_t tensor(-0.9149, dtype=torch.float64)
4 gae_duplicate tensor(-1.5203, dtype=torch.float64) tensor(19.1500, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3568, dtype=torch.float64) delta_t tensor(-1.3755, dtype=torch.float64)
3 gae_duplicate tensor(-2.0217, dtype=torch.float64) tensor(29.1199, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2617, dtype=torch.float64) delta_t tensor(-1.3104, dtype=torch.float64)
2 gae_duplicate tensor(-1.9072, dtype=torch.float64) tensor(28.7945, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6944.7958984375
value loss:181.98936462402344
entropies:355.9451599121094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.30422306060791 seconds
19 rew tensor(0.7826, dtype=torch.float64) delta_t tensor(0.1659, dtype=torch.float64)
19 gae_duplicate tensor(-0.0528, dtype=torch.float64) tensor(-3.2922, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7348, dtype=torch.float64) delta_t tensor(0.1583, dtype=torch.float64)
18 gae_duplicate tensor(-0.1775, dtype=torch.float64) tensor(-3.4610, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6165, dtype=torch.float64) delta_t tensor(0.0320, dtype=torch.float64)
17 gae_duplicate tensor(-0.5245, dtype=torch.float64) tensor(-0.9617, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6292, dtype=torch.float64) delta_t tensor(-0.0025, dtype=torch.float64)
16 gae_duplicate tensor(-0.5494, dtype=torch.float64) tensor(-0.0295, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8630, dtype=torch.float64) delta_t tensor(0.2844, dtype=torch.float64)
15 gae_duplicate tensor(0.1151, dtype=torch.float64) tensor(-5.6315, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8669, dtype=torch.float64) delta_t tensor(0.3618, dtype=torch.float64)
14 gae_duplicate tensor(0.1832, dtype=torch.float64) tensor(-7.7127, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8708, dtype=torch.float64) delta_t tensor(0.4259, dtype=torch.float64)
13 gae_duplicate tensor(0.2860, dtype=torch.float64) tensor(-9.1814, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8748, dtype=torch.float64) delta_t tensor(0.3541, dtype=torch.float64)
12 gae_duplicate tensor(0.1986, dtype=torch.float64) tensor(-7.8988, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8683, dtype=torch.float64) delta_t tensor(0.3177, dtype=torch.float64)
11 gae_duplicate tensor(0.2788, dtype=torch.float64) tensor(-7.0706, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6575, dtype=torch.float64) delta_t tensor(0.1369, dtype=torch.float64)
10 gae_duplicate tensor(-0.8774, dtype=torch.float64) tensor(-3.3656, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6702, dtype=torch.float64) delta_t tensor(-1.1602, dtype=torch.float64)
9 gae_duplicate tensor(-3.3286, dtype=torch.float64) tensor(22.7197, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0851, dtype=torch.float64) delta_t tensor(-0.3847, dtype=torch.float64)
8 gae_duplicate tensor(-2.4288, dtype=torch.float64) tensor(9.8692, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0149, dtype=torch.float64) delta_t tensor(-0.4104, dtype=torch.float64)
7 gae_duplicate tensor(-1.5653, dtype=torch.float64) tensor(9.1221, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1514, dtype=torch.float64) delta_t tensor(-0.1977, dtype=torch.float64)
6 gae_duplicate tensor(-0.5575, dtype=torch.float64) tensor(4.8342, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5554, dtype=torch.float64) delta_t tensor(-0.4275, dtype=torch.float64)
5 gae_duplicate tensor(-0.6706, dtype=torch.float64) tensor(8.8841, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.1040, dtype=torch.float64) delta_t tensor(-0.9721, dtype=torch.float64)
4 gae_duplicate tensor(-1.3267, dtype=torch.float64) tensor(20.1414, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3155, dtype=torch.float64) delta_t tensor(-1.1680, dtype=torch.float64)
3 gae_duplicate tensor(-1.8686, dtype=torch.float64) tensor(25.0556, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1397, dtype=torch.float64) delta_t tensor(-1.0023, dtype=torch.float64)
2 gae_duplicate tensor(-1.5185, dtype=torch.float64) tensor(22.2746, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4108.07421875
value loss:99.85652923583984
entropies:355.93011474609375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3959.4570)
ToM Target loss= tensor(3586.1716)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 6.4435341358184814 seconds
19 rew tensor(0.7871, dtype=torch.float64) delta_t tensor(0.1582, dtype=torch.float64)
19 gae_duplicate tensor(-0.0479, dtype=torch.float64) tensor(-3.1479, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7407, dtype=torch.float64) delta_t tensor(0.1547, dtype=torch.float64)
18 gae_duplicate tensor(-0.1606, dtype=torch.float64) tensor(-3.3261, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6248, dtype=torch.float64) delta_t tensor(0.0355, dtype=torch.float64)
17 gae_duplicate tensor(-0.4791, dtype=torch.float64) tensor(-1.0781, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6229, dtype=torch.float64) delta_t tensor(-0.0118, dtype=torch.float64)
16 gae_duplicate tensor(-0.5242, dtype=torch.float64) tensor(0.0478, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8658, dtype=torch.float64) delta_t tensor(0.3079, dtype=torch.float64)
15 gae_duplicate tensor(0.2000, dtype=torch.float64) tensor(-6.0487, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8693, dtype=torch.float64) delta_t tensor(0.3760, dtype=torch.float64)
14 gae_duplicate tensor(0.2673, dtype=torch.float64) tensor(-8.0515, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8729, dtype=torch.float64) delta_t tensor(0.4342, dtype=torch.float64)
13 gae_duplicate tensor(0.2680, dtype=torch.float64) tensor(-9.4537, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8765, dtype=torch.float64) delta_t tensor(0.4481, dtype=torch.float64)
12 gae_duplicate tensor(0.2823, dtype=torch.float64) tensor(-9.7429, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8705, dtype=torch.float64) delta_t tensor(0.3053, dtype=torch.float64)
11 gae_duplicate tensor(0.3164, dtype=torch.float64) tensor(-7.0568, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4478, dtype=torch.float64) delta_t tensor(-0.0845, dtype=torch.float64)
10 gae_duplicate tensor(-0.9126, dtype=torch.float64) tensor(1.0789, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2816, dtype=torch.float64) delta_t tensor(-0.1869, dtype=torch.float64)
9 gae_duplicate tensor(-1.8642, dtype=torch.float64) tensor(3.7346, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1338, dtype=torch.float64) delta_t tensor(-0.5396, dtype=torch.float64)
8 gae_duplicate tensor(-3.3811, dtype=torch.float64) tensor(10.9779, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2305, dtype=torch.float64) delta_t tensor(-0.6532, dtype=torch.float64)
7 gae_duplicate tensor(-2.5154, dtype=torch.float64) tensor(13.8741, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2394, dtype=torch.float64) delta_t tensor(-0.2021, dtype=torch.float64)
6 gae_duplicate tensor(-0.5988, dtype=torch.float64) tensor(5.4214, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6663, dtype=torch.float64) delta_t tensor(-0.4382, dtype=torch.float64)
5 gae_duplicate tensor(-0.6467, dtype=torch.float64) tensor(9.2064, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4381, dtype=torch.float64) delta_t tensor(-1.1158, dtype=torch.float64)
4 gae_duplicate tensor(-1.8009, dtype=torch.float64) tensor(23.0230, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5642, dtype=torch.float64) delta_t tensor(-1.2016, dtype=torch.float64)
3 gae_duplicate tensor(-1.5374, dtype=torch.float64) tensor(25.9878, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3577, dtype=torch.float64) delta_t tensor(-1.1105, dtype=torch.float64)
2 gae_duplicate tensor(-1.7272, dtype=torch.float64) tensor(24.6246, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3879.912109375
value loss:95.54084014892578
entropies:355.85772705078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.520538806915283 seconds
19 rew tensor(0.7892, dtype=torch.float64) delta_t tensor(0.2376, dtype=torch.float64)
19 gae_duplicate tensor(-0.0118, dtype=torch.float64) tensor(-4.7274, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7415, dtype=torch.float64) delta_t tensor(0.2088, dtype=torch.float64)
18 gae_duplicate tensor(-0.1315, dtype=torch.float64) tensor(-4.6016, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6231, dtype=torch.float64) delta_t tensor(0.0826, dtype=torch.float64)
17 gae_duplicate tensor(-0.4649, dtype=torch.float64) tensor(-2.0919, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6247, dtype=torch.float64) delta_t tensor(0.0460, dtype=torch.float64)
16 gae_duplicate tensor(-0.4527, dtype=torch.float64) tensor(-1.1168, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8682, dtype=torch.float64) delta_t tensor(0.3406, dtype=torch.float64)
15 gae_duplicate tensor(0.2038, dtype=torch.float64) tensor(-6.8802, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8715, dtype=torch.float64) delta_t tensor(0.3944, dtype=torch.float64)
14 gae_duplicate tensor(0.2726, dtype=torch.float64) tensor(-8.4005, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8748, dtype=torch.float64) delta_t tensor(0.4319, dtype=torch.float64)
13 gae_duplicate tensor(0.3015, dtype=torch.float64) tensor(-9.3632, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8781, dtype=torch.float64) delta_t tensor(0.4675, dtype=torch.float64)
12 gae_duplicate tensor(0.2868, dtype=torch.float64) tensor(-10.1761, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8714, dtype=torch.float64) delta_t tensor(0.3933, dtype=torch.float64)
11 gae_duplicate tensor(0.3412, dtype=torch.float64) tensor(-8.8651, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2441, dtype=torch.float64) delta_t tensor(-0.2182, dtype=torch.float64)
10 gae_duplicate tensor(-2.0647, dtype=torch.float64) tensor(3.4457, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2438, dtype=torch.float64) delta_t tensor(-0.1617, dtype=torch.float64)
9 gae_duplicate tensor(-2.0362, dtype=torch.float64) tensor(3.5305, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4141, dtype=torch.float64) delta_t tensor(0.1227, dtype=torch.float64)
8 gae_duplicate tensor(-0.0624, dtype=torch.float64) tensor(-2.0729, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1263, dtype=torch.float64) delta_t tensor(-0.2182, dtype=torch.float64)
7 gae_duplicate tensor(-0.4203, dtype=torch.float64) tensor(4.1215, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2828, dtype=torch.float64) delta_t tensor(-0.1375, dtype=torch.float64)
6 gae_duplicate tensor(-0.4812, dtype=torch.float64) tensor(3.0506, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6997, dtype=torch.float64) delta_t tensor(-0.3447, dtype=torch.float64)
5 gae_duplicate tensor(-0.5866, dtype=torch.float64) tensor(7.1080, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4218, dtype=torch.float64) delta_t tensor(-0.9944, dtype=torch.float64)
4 gae_duplicate tensor(-1.6341, dtype=torch.float64) tensor(20.4491, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5665, dtype=torch.float64) delta_t tensor(-1.1076, dtype=torch.float64)
3 gae_duplicate tensor(-1.6168, dtype=torch.float64) tensor(23.8838, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3392, dtype=torch.float64) delta_t tensor(-0.9764, dtype=torch.float64)
2 gae_duplicate tensor(-1.3295, dtype=torch.float64) tensor(21.7169, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1662.6376953125
value loss:67.47196197509766
entropies:355.8251953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.232464790344238 seconds
19 rew tensor(0.8187, dtype=torch.float64) delta_t tensor(0.2967, dtype=torch.float64)
19 gae_duplicate tensor(0.1882, dtype=torch.float64) tensor(-5.8845, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8119, dtype=torch.float64) delta_t tensor(0.2979, dtype=torch.float64)
18 gae_duplicate tensor(0.1345, dtype=torch.float64) tensor(-6.5017, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7756, dtype=torch.float64) delta_t tensor(0.2752, dtype=torch.float64)
17 gae_duplicate tensor(-0.0458, dtype=torch.float64) tensor(-6.0542, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6795, dtype=torch.float64) delta_t tensor(0.1078, dtype=torch.float64)
16 gae_duplicate tensor(-0.3540, dtype=torch.float64) tensor(-2.7431, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7319, dtype=torch.float64) delta_t tensor(0.2255, dtype=torch.float64)
15 gae_duplicate tensor(-0.4799, dtype=torch.float64) tensor(-4.7113, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8703, dtype=torch.float64) delta_t tensor(0.4205, dtype=torch.float64)
14 gae_duplicate tensor(0.2959, dtype=torch.float64) tensor(-8.6706, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8733, dtype=torch.float64) delta_t tensor(0.3984, dtype=torch.float64)
13 gae_duplicate tensor(0.3185, dtype=torch.float64) tensor(-8.7611, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8764, dtype=torch.float64) delta_t tensor(0.5250, dtype=torch.float64)
12 gae_duplicate tensor(0.3703, dtype=torch.float64) tensor(-11.1510, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8794, dtype=torch.float64) delta_t tensor(0.3693, dtype=torch.float64)
11 gae_duplicate tensor(0.3690, dtype=torch.float64) tensor(-8.4483, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8418, dtype=torch.float64) delta_t tensor(0.3735, dtype=torch.float64)
10 gae_duplicate tensor(0.2457, dtype=torch.float64) tensor(-8.2067, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2199, dtype=torch.float64) delta_t tensor(-0.1798, dtype=torch.float64)
9 gae_duplicate tensor(-1.8107, dtype=torch.float64) tensor(2.6988, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8457, dtype=torch.float64) delta_t tensor(-1.1606, dtype=torch.float64)
8 gae_duplicate tensor(-4.7178, dtype=torch.float64) tensor(22.8621, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4546, dtype=torch.float64) delta_t tensor(-0.7556, dtype=torch.float64)
7 gae_duplicate tensor(-2.3159, dtype=torch.float64) tensor(16.9855, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1945, dtype=torch.float64) delta_t tensor(0.0925, dtype=torch.float64)
6 gae_duplicate tensor(-0.3852, dtype=torch.float64) tensor(-0.1073, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5741, dtype=torch.float64) delta_t tensor(-0.1524, dtype=torch.float64)
5 gae_duplicate tensor(-0.6058, dtype=torch.float64) tensor(2.9883, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4117, dtype=torch.float64) delta_t tensor(-0.8627, dtype=torch.float64)
4 gae_duplicate tensor(-1.4623, dtype=torch.float64) tensor(17.5633, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5866, dtype=torch.float64) delta_t tensor(-1.0189, dtype=torch.float64)
3 gae_duplicate tensor(-1.3983, dtype=torch.float64) tensor(21.8760, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4296, dtype=torch.float64) delta_t tensor(-1.0429, dtype=torch.float64)
2 gae_duplicate tensor(-1.5554, dtype=torch.float64) tensor(22.8047, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2069.181640625
value loss:109.31266784667969
entropies:355.8326416015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.4706549644470215 seconds
19 rew tensor(0.8302, dtype=torch.float64) delta_t tensor(0.3450, dtype=torch.float64)
19 gae_duplicate tensor(0.1824, dtype=torch.float64) tensor(-6.7801, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8124, dtype=torch.float64) delta_t tensor(0.3456, dtype=torch.float64)
18 gae_duplicate tensor(0.1519, dtype=torch.float64) tensor(-7.4681, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7747, dtype=torch.float64) delta_t tensor(0.2897, dtype=torch.float64)
17 gae_duplicate tensor(-0.0346, dtype=torch.float64) tensor(-6.4631, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6863, dtype=torch.float64) delta_t tensor(0.1459, dtype=torch.float64)
16 gae_duplicate tensor(-0.3698, dtype=torch.float64) tensor(-3.5163, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7353, dtype=torch.float64) delta_t tensor(0.2582, dtype=torch.float64)
15 gae_duplicate tensor(-0.4984, dtype=torch.float64) tensor(-5.3997, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8715, dtype=torch.float64) delta_t tensor(0.3686, dtype=torch.float64)
14 gae_duplicate tensor(0.2600, dtype=torch.float64) tensor(-7.8393, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8743, dtype=torch.float64) delta_t tensor(0.4917, dtype=torch.float64)
13 gae_duplicate tensor(0.3386, dtype=torch.float64) tensor(-10.4557, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8772, dtype=torch.float64) delta_t tensor(0.5347, dtype=torch.float64)
12 gae_duplicate tensor(0.3827, dtype=torch.float64) tensor(-11.5935, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8800, dtype=torch.float64) delta_t tensor(0.4126, dtype=torch.float64)
11 gae_duplicate tensor(0.4004, dtype=torch.float64) tensor(-9.3324, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4562, dtype=torch.float64) delta_t tensor(0.0437, dtype=torch.float64)
10 gae_duplicate tensor(-1.8799, dtype=torch.float64) tensor(-1.7934, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4256, dtype=torch.float64) delta_t tensor(0.0977, dtype=torch.float64)
9 gae_duplicate tensor(-1.0036, dtype=torch.float64) tensor(-2.1133, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0455, dtype=torch.float64) delta_t tensor(-0.2925, dtype=torch.float64)
8 gae_duplicate tensor(-2.1259, dtype=torch.float64) tensor(5.5696, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3755, dtype=torch.float64) delta_t tensor(-0.5778, dtype=torch.float64)
7 gae_duplicate tensor(-2.3663, dtype=torch.float64) tensor(12.0392, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3544, dtype=torch.float64) delta_t tensor(0.1029, dtype=torch.float64)
6 gae_duplicate tensor(-0.3727, dtype=torch.float64) tensor(-0.8848, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8229, dtype=torch.float64) delta_t tensor(-0.2728, dtype=torch.float64)
5 gae_duplicate tensor(-0.8130, dtype=torch.float64) tensor(5.2961, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5523, dtype=torch.float64) delta_t tensor(-0.8605, dtype=torch.float64)
4 gae_duplicate tensor(-1.5852, dtype=torch.float64) tensor(17.5609, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5238, dtype=torch.float64) delta_t tensor(-0.7844, dtype=torch.float64)
3 gae_duplicate tensor(-1.1296, dtype=torch.float64) tensor(17.3049, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2560, dtype=torch.float64) delta_t tensor(-0.7131, dtype=torch.float64)
2 gae_duplicate tensor(-1.2446, dtype=torch.float64) tensor(15.7772, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-91.1231460571289
value loss:67.3171615600586
entropies:355.8893127441406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.274754047393799 seconds
19 rew tensor(0.7853, dtype=torch.float64) delta_t tensor(0.2563, dtype=torch.float64)
19 gae_duplicate tensor(0.0914, dtype=torch.float64) tensor(-5.0655, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7275, dtype=torch.float64) delta_t tensor(0.2041, dtype=torch.float64)
18 gae_duplicate tensor(-0.0310, dtype=torch.float64) tensor(-4.5386, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5993, dtype=torch.float64) delta_t tensor(0.0733, dtype=torch.float64)
17 gae_duplicate tensor(-0.3593, dtype=torch.float64) tensor(-1.8837, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5681, dtype=torch.float64) delta_t tensor(0.0570, dtype=torch.float64)
16 gae_duplicate tensor(-0.3684, dtype=torch.float64) tensor(-1.3068, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7416, dtype=torch.float64) delta_t tensor(0.2352, dtype=torch.float64)
15 gae_duplicate tensor(-0.4469, dtype=torch.float64) tensor(-4.7579, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8737, dtype=torch.float64) delta_t tensor(0.4160, dtype=torch.float64)
14 gae_duplicate tensor(0.2397, dtype=torch.float64) tensor(-8.6744, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8763, dtype=torch.float64) delta_t tensor(0.5239, dtype=torch.float64)
13 gae_duplicate tensor(0.3158, dtype=torch.float64) tensor(-11.2254, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8790, dtype=torch.float64) delta_t tensor(0.4419, dtype=torch.float64)
12 gae_duplicate tensor(0.4354, dtype=torch.float64) tensor(-9.8183, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8618, dtype=torch.float64) delta_t tensor(0.5085, dtype=torch.float64)
11 gae_duplicate tensor(0.4877, dtype=torch.float64) tensor(-11.0643, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3598, dtype=torch.float64) delta_t tensor(-0.0258, dtype=torch.float64)
10 gae_duplicate tensor(-0.7081, dtype=torch.float64) tensor(-0.5654, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2298, dtype=torch.float64) delta_t tensor(-0.5702, dtype=torch.float64)
9 gae_duplicate tensor(-2.0774, dtype=torch.float64) tensor(11.2945, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3936, dtype=torch.float64) delta_t tensor(0.2407, dtype=torch.float64)
8 gae_duplicate tensor(-0.0345, dtype=torch.float64) tensor(-3.6349, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1045, dtype=torch.float64) delta_t tensor(-0.0454, dtype=torch.float64)
7 gae_duplicate tensor(-0.2919, dtype=torch.float64) tensor(0.5573, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3445, dtype=torch.float64) delta_t tensor(0.0025, dtype=torch.float64)
6 gae_duplicate tensor(-0.2999, dtype=torch.float64) tensor(-0.0126, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6940, dtype=torch.float64) delta_t tensor(-0.0191, dtype=torch.float64)
5 gae_duplicate tensor(-0.2901, dtype=torch.float64) tensor(0.3726, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3724, dtype=torch.float64) delta_t tensor(-0.6180, dtype=torch.float64)
4 gae_duplicate tensor(-1.3052, dtype=torch.float64) tensor(12.2321, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5414, dtype=torch.float64) delta_t tensor(-0.6258, dtype=torch.float64)
3 gae_duplicate tensor(-1.1906, dtype=torch.float64) tensor(13.5806, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3728, dtype=torch.float64) delta_t tensor(-0.5822, dtype=torch.float64)
2 gae_duplicate tensor(-1.2340, dtype=torch.float64) tensor(12.8685, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:532.5916748046875
value loss:46.8914909362793
entropies:355.88665771484375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3957.8359)
ToM Target loss= tensor(3606.7551)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.297242879867554 seconds
19 rew tensor(0.8178, dtype=torch.float64) delta_t tensor(0.4061, dtype=torch.float64)
19 gae_duplicate tensor(0.2524, dtype=torch.float64) tensor(-7.9673, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7996, dtype=torch.float64) delta_t tensor(0.3965, dtype=torch.float64)
18 gae_duplicate tensor(0.1832, dtype=torch.float64) tensor(-8.5795, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7511, dtype=torch.float64) delta_t tensor(0.3110, dtype=torch.float64)
17 gae_duplicate tensor(-0.0135, dtype=torch.float64) tensor(-7.0771, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6219, dtype=torch.float64) delta_t tensor(0.1002, dtype=torch.float64)
16 gae_duplicate tensor(-0.3563, dtype=torch.float64) tensor(-2.6919, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6136, dtype=torch.float64) delta_t tensor(0.1481, dtype=torch.float64)
15 gae_duplicate tensor(-0.4560, dtype=torch.float64) tensor(-3.2619, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8768, dtype=torch.float64) delta_t tensor(0.3991, dtype=torch.float64)
14 gae_duplicate tensor(0.2787, dtype=torch.float64) tensor(-8.1905, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8792, dtype=torch.float64) delta_t tensor(0.4443, dtype=torch.float64)
13 gae_duplicate tensor(0.3527, dtype=torch.float64) tensor(-9.5496, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8817, dtype=torch.float64) delta_t tensor(0.5928, dtype=torch.float64)
12 gae_duplicate tensor(0.4175, dtype=torch.float64) tensor(-12.7332, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8842, dtype=torch.float64) delta_t tensor(0.4604, dtype=torch.float64)
11 gae_duplicate tensor(0.4407, dtype=torch.float64) tensor(-10.3203, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2378, dtype=torch.float64) delta_t tensor(-0.1339, dtype=torch.float64)
10 gae_duplicate tensor(-1.8983, dtype=torch.float64) tensor(1.5630, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2678, dtype=torch.float64) delta_t tensor(-0.5256, dtype=torch.float64)
9 gae_duplicate tensor(-3.4954, dtype=torch.float64) tensor(10.6190, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3149, dtype=torch.float64) delta_t tensor(0.1249, dtype=torch.float64)
8 gae_duplicate tensor(-0.0398, dtype=torch.float64) tensor(-1.3926, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0637, dtype=torch.float64) delta_t tensor(-0.0757, dtype=torch.float64)
7 gae_duplicate tensor(-0.3090, dtype=torch.float64) tensor(1.3710, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3084, dtype=torch.float64) delta_t tensor(0.2281, dtype=torch.float64)
6 gae_duplicate tensor(-0.2496, dtype=torch.float64) tensor(-4.3456, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8225, dtype=torch.float64) delta_t tensor(-0.0464, dtype=torch.float64)
5 gae_duplicate tensor(-0.4104, dtype=torch.float64) tensor(0.4768, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5264, dtype=torch.float64) delta_t tensor(-0.6408, dtype=torch.float64)
4 gae_duplicate tensor(-1.2132, dtype=torch.float64) tensor(12.6891, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6593, dtype=torch.float64) delta_t tensor(-0.7102, dtype=torch.float64)
3 gae_duplicate tensor(-1.3250, dtype=torch.float64) tensor(15.3927, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4389, dtype=torch.float64) delta_t tensor(-0.7451, dtype=torch.float64)
2 gae_duplicate tensor(-1.4770, dtype=torch.float64) tensor(16.2582, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:861.8746337890625
value loss:66.58645629882812
entropies:355.8424377441406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 6.116402864456177 seconds
19 rew tensor(0.7879, dtype=torch.float64) delta_t tensor(0.2702, dtype=torch.float64)
19 gae_duplicate tensor(0.1136, dtype=torch.float64) tensor(-5.3682, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7179, dtype=torch.float64) delta_t tensor(0.2174, dtype=torch.float64)
18 gae_duplicate tensor(-0.0277, dtype=torch.float64) tensor(-4.8126, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5661, dtype=torch.float64) delta_t tensor(0.0609, dtype=torch.float64)
17 gae_duplicate tensor(-0.4002, dtype=torch.float64) tensor(-1.7526, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7566, dtype=torch.float64) delta_t tensor(0.2226, dtype=torch.float64)
16 gae_duplicate tensor(-0.3454, dtype=torch.float64) tensor(-4.5994, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8757, dtype=torch.float64) delta_t tensor(0.3703, dtype=torch.float64)
15 gae_duplicate tensor(0.3208, dtype=torch.float64) tensor(-7.5879, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8780, dtype=torch.float64) delta_t tensor(0.4855, dtype=torch.float64)
14 gae_duplicate tensor(0.3898, dtype=torch.float64) tensor(-10.6446, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8803, dtype=torch.float64) delta_t tensor(0.4680, dtype=torch.float64)
13 gae_duplicate tensor(0.3688, dtype=torch.float64) tensor(-10.1951, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8827, dtype=torch.float64) delta_t tensor(0.4864, dtype=torch.float64)
12 gae_duplicate tensor(0.4002, dtype=torch.float64) tensor(-10.7049, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8644, dtype=torch.float64) delta_t tensor(0.4726, dtype=torch.float64)
11 gae_duplicate tensor(0.3932, dtype=torch.float64) tensor(-10.3773, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2514, dtype=torch.float64) delta_t tensor(-0.1156, dtype=torch.float64)
10 gae_duplicate tensor(-1.7908, dtype=torch.float64) tensor(1.3745, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2618, dtype=torch.float64) delta_t tensor(-0.5564, dtype=torch.float64)
9 gae_duplicate tensor(-2.0689, dtype=torch.float64) tensor(10.9577, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2886, dtype=torch.float64) delta_t tensor(-0.5045, dtype=torch.float64)
8 gae_duplicate tensor(-2.4315, dtype=torch.float64) tensor(11.2610, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7823, dtype=torch.float64) delta_t tensor(-0.8674, dtype=torch.float64)
7 gae_duplicate tensor(-3.5921, dtype=torch.float64) tensor(17.8735, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1430, dtype=torch.float64) delta_t tensor(0.3783, dtype=torch.float64)
6 gae_duplicate tensor(-0.0950, dtype=torch.float64) tensor(-5.6416, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4547, dtype=torch.float64) delta_t tensor(0.2577, dtype=torch.float64)
5 gae_duplicate tensor(0.0524, dtype=torch.float64) tensor(-5.7252, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0866, dtype=torch.float64) delta_t tensor(-0.1456, dtype=torch.float64)
4 gae_duplicate tensor(-1.0153, dtype=torch.float64) tensor(2.2332, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4290, dtype=torch.float64) delta_t tensor(-0.4412, dtype=torch.float64)
3 gae_duplicate tensor(-0.7775, dtype=torch.float64) tensor(8.8994, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2865, dtype=torch.float64) delta_t tensor(-0.4173, dtype=torch.float64)
2 gae_duplicate tensor(-0.9372, dtype=torch.float64) tensor(8.9576, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:759.9922485351562
value loss:92.44233703613281
entropies:355.7152404785156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.671248912811279 seconds
19 rew tensor(0.8110, dtype=torch.float64) delta_t tensor(0.3814, dtype=torch.float64)
19 gae_duplicate tensor(0.2343, dtype=torch.float64) tensor(-7.4398, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7926, dtype=torch.float64) delta_t tensor(0.3743, dtype=torch.float64)
18 gae_duplicate tensor(0.1579, dtype=torch.float64) tensor(-8.1783, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7240, dtype=torch.float64) delta_t tensor(0.2573, dtype=torch.float64)
17 gae_duplicate tensor(-0.0420, dtype=torch.float64) tensor(-5.8312, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5652, dtype=torch.float64) delta_t tensor(0.0157, dtype=torch.float64)
16 gae_duplicate tensor(-0.4032, dtype=torch.float64) tensor(-0.8505, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7499, dtype=torch.float64) delta_t tensor(0.2566, dtype=torch.float64)
15 gae_duplicate tensor(-0.4550, dtype=torch.float64) tensor(-5.2298, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8788, dtype=torch.float64) delta_t tensor(0.3802, dtype=torch.float64)
14 gae_duplicate tensor(0.2696, dtype=torch.float64) tensor(-7.9202, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8810, dtype=torch.float64) delta_t tensor(0.4897, dtype=torch.float64)
13 gae_duplicate tensor(0.3494, dtype=torch.float64) tensor(-10.5922, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8832, dtype=torch.float64) delta_t tensor(0.5046, dtype=torch.float64)
12 gae_duplicate tensor(0.3610, dtype=torch.float64) tensor(-10.9813, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8854, dtype=torch.float64) delta_t tensor(0.4755, dtype=torch.float64)
11 gae_duplicate tensor(0.4458, dtype=torch.float64) tensor(-10.4794, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8383, dtype=torch.float64) delta_t tensor(0.4757, dtype=torch.float64)
10 gae_duplicate tensor(0.3518, dtype=torch.float64) tensor(-10.4288, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1875, dtype=torch.float64) delta_t tensor(-0.0351, dtype=torch.float64)
9 gae_duplicate tensor(-1.8573, dtype=torch.float64) tensor(-0.3439, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1032, dtype=torch.float64) delta_t tensor(0.0197, dtype=torch.float64)
8 gae_duplicate tensor(-0.9802, dtype=torch.float64) tensor(-0.4502, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0294, dtype=torch.float64) delta_t tensor(-0.0892, dtype=torch.float64)
7 gae_duplicate tensor(-0.6315, dtype=torch.float64) tensor(1.6218, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2924, dtype=torch.float64) delta_t tensor(0.4019, dtype=torch.float64)
6 gae_duplicate tensor(0.1003, dtype=torch.float64) tensor(-7.8519, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7144, dtype=torch.float64) delta_t tensor(0.2304, dtype=torch.float64)
5 gae_duplicate tensor(0.0172, dtype=torch.float64) tensor(-5.4185, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5306, dtype=torch.float64) delta_t tensor(-0.4856, dtype=torch.float64)
4 gae_duplicate tensor(-1.0158, dtype=torch.float64) tensor(9.1700, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5939, dtype=torch.float64) delta_t tensor(-0.4379, dtype=torch.float64)
3 gae_duplicate tensor(-0.7446, dtype=torch.float64) tensor(9.4483, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3394, dtype=torch.float64) delta_t tensor(-0.3797, dtype=torch.float64)
2 gae_duplicate tensor(-0.7604, dtype=torch.float64) tensor(8.5556, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3316.7919921875
value loss:39.59720230102539
entropies:355.6658630371094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.463178873062134 seconds
19 rew tensor(0.8276, dtype=torch.float64) delta_t tensor(0.3578, dtype=torch.float64)
19 gae_duplicate tensor(0.1706, dtype=torch.float64) tensor(-6.9047, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8090, dtype=torch.float64) delta_t tensor(0.3259, dtype=torch.float64)
18 gae_duplicate tensor(0.0796, dtype=torch.float64) tensor(-7.0946, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7494, dtype=torch.float64) delta_t tensor(0.2727, dtype=torch.float64)
17 gae_duplicate tensor(-0.1307, dtype=torch.float64) tensor(-6.0821, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6284, dtype=torch.float64) delta_t tensor(0.0061, dtype=torch.float64)
16 gae_duplicate tensor(-0.5170, dtype=torch.float64) tensor(-0.8398, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8748, dtype=torch.float64) delta_t tensor(0.3276, dtype=torch.float64)
15 gae_duplicate tensor(0.1745, dtype=torch.float64) tensor(-6.4816, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8768, dtype=torch.float64) delta_t tensor(0.3184, dtype=torch.float64)
14 gae_duplicate tensor(0.2456, dtype=torch.float64) tensor(-6.9672, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8789, dtype=torch.float64) delta_t tensor(0.4316, dtype=torch.float64)
13 gae_duplicate tensor(0.2908, dtype=torch.float64) tensor(-9.2854, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8810, dtype=torch.float64) delta_t tensor(0.4218, dtype=torch.float64)
12 gae_duplicate tensor(0.2576, dtype=torch.float64) tensor(-9.1986, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8831, dtype=torch.float64) delta_t tensor(0.4131, dtype=torch.float64)
11 gae_duplicate tensor(0.3711, dtype=torch.float64) tensor(-9.0764, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8648, dtype=torch.float64) delta_t tensor(0.4572, dtype=torch.float64)
10 gae_duplicate tensor(0.4325, dtype=torch.float64) tensor(-9.7794, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5403, dtype=torch.float64) delta_t tensor(-0.8418, dtype=torch.float64)
9 gae_duplicate tensor(-4.3966, dtype=torch.float64) tensor(15.4153, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2836, dtype=torch.float64) delta_t tensor(0.1462, dtype=torch.float64)
8 gae_duplicate tensor(-1.1529, dtype=torch.float64) tensor(-1.3006, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1770, dtype=torch.float64) delta_t tensor(0.0219, dtype=torch.float64)
7 gae_duplicate tensor(-0.1912, dtype=torch.float64) tensor(-0.5567, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1291, dtype=torch.float64) delta_t tensor(0.5440, dtype=torch.float64)
6 gae_duplicate tensor(0.0455, dtype=torch.float64) tensor(-10.6868, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6561, dtype=torch.float64) delta_t tensor(0.3439, dtype=torch.float64)
5 gae_duplicate tensor(0.1914, dtype=torch.float64) tensor(-7.9295, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4238, dtype=torch.float64) delta_t tensor(-0.3275, dtype=torch.float64)
4 gae_duplicate tensor(-0.6126, dtype=torch.float64) tensor(5.6462, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4127, dtype=torch.float64) delta_t tensor(-0.2272, dtype=torch.float64)
3 gae_duplicate tensor(-0.5495, dtype=torch.float64) tensor(5.1062, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.1538, dtype=torch.float64) delta_t tensor(-0.2791, dtype=torch.float64)
2 gae_duplicate tensor(-0.5436, dtype=torch.float64) tensor(5.9658, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3146.6650390625
value loss:64.38489532470703
entropies:355.6605224609375
Policy training finished
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt