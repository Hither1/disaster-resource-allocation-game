obs <crafter.objects.Shelter object at 0x16c21b880> 0 [39.  0.  0.  0. 39.  0.  0.  0. 21.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x12347bdf0> 0 [39.  0.  0.  0. 40.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x16c221100> 0 [9. 0. 0. 0. 9. 0. 0. 0. 9. 0. 0. 0.]
obs <crafter.objects.Shelter object at 0x16c21b880> 0 [39.  0.  0.  0. 39.  0.  0.  0. 20.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x12347bdf0> 0 [40.  0.  0.  0. 36.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x16c221100> 0 [ 9.  0.  0.  0.  9.  0.  0.  0. 14.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0019290447235107422 seconds
19 rew tensor(0.8078, dtype=torch.float64) delta_t tensor(0.9684, dtype=torch.float64)
19 gae_duplicate tensor(0.9229, dtype=torch.float64) tensor(-19.0382, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8430, dtype=torch.float64) delta_t tensor(1.0036, dtype=torch.float64)
18 gae_duplicate tensor(1.0368, dtype=torch.float64) tensor(-21.7127, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8834, dtype=torch.float64) delta_t tensor(1.0656, dtype=torch.float64)
17 gae_duplicate tensor(1.0806, dtype=torch.float64) tensor(-23.2178, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9304, dtype=torch.float64) delta_t tensor(1.1084, dtype=torch.float64)
16 gae_duplicate tensor(1.1485, dtype=torch.float64) tensor(-24.0057, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9860, dtype=torch.float64) delta_t tensor(1.1429, dtype=torch.float64)
15 gae_duplicate tensor(1.2049, dtype=torch.float64) tensor(-24.9980, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0533, dtype=torch.float64) delta_t tensor(1.2140, dtype=torch.float64)
14 gae_duplicate tensor(1.2701, dtype=torch.float64) tensor(-26.2884, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.1369, dtype=torch.float64) delta_t tensor(1.2829, dtype=torch.float64)
13 gae_duplicate tensor(1.3451, dtype=torch.float64) tensor(-27.4907, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.2452, dtype=torch.float64) delta_t tensor(1.4044, dtype=torch.float64)
12 gae_duplicate tensor(1.4238, dtype=torch.float64) tensor(-30.6512, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.3932, dtype=torch.float64) delta_t tensor(1.5516, dtype=torch.float64)
11 gae_duplicate tensor(1.5628, dtype=torch.float64) tensor(-33.6068, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(1.6141, dtype=torch.float64) delta_t tensor(1.7263, dtype=torch.float64)
10 gae_duplicate tensor(1.7484, dtype=torch.float64) tensor(-37.1103, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(1.4861, dtype=torch.float64) delta_t tensor(1.6715, dtype=torch.float64)
9 gae_duplicate tensor(1.6209, dtype=torch.float64) tensor(-36.8229, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(1.4350, dtype=torch.float64) delta_t tensor(1.4234, dtype=torch.float64)
8 gae_duplicate tensor(1.4118, dtype=torch.float64) tensor(-31.6746, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(1.4974, dtype=torch.float64) delta_t tensor(1.5648, dtype=torch.float64)
7 gae_duplicate tensor(1.5950, dtype=torch.float64) tensor(-33.8817, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.5306, dtype=torch.float64) delta_t tensor(1.6923, dtype=torch.float64)
6 gae_duplicate tensor(1.5562, dtype=torch.float64) tensor(-36.8532, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(1.0188, dtype=torch.float64) delta_t tensor(1.1035, dtype=torch.float64)
5 gae_duplicate tensor(0.6116, dtype=torch.float64) tensor(-25.3228, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0974, dtype=torch.float64) delta_t tensor(-0.9430, dtype=torch.float64)
4 gae_duplicate tensor(-1.1015, dtype=torch.float64) tensor(16.1027, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0665, dtype=torch.float64) delta_t tensor(-0.9406, dtype=torch.float64)
3 gae_duplicate tensor(-1.1184, dtype=torch.float64) tensor(20.1556, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8897, dtype=torch.float64) delta_t tensor(-0.9173, dtype=torch.float64)
2 gae_duplicate tensor(-1.1151, dtype=torch.float64) tensor(20.0245, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:20229.123046875
value loss:330.0882263183594
entropies:355.7655944824219
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 5.056597709655762 seconds
19 rew tensor(0.8171, dtype=torch.float64) delta_t tensor(0.8537, dtype=torch.float64)
19 gae_duplicate tensor(0.8078, dtype=torch.float64) tensor(-16.7670, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8346, dtype=torch.float64) delta_t tensor(0.8638, dtype=torch.float64)
18 gae_duplicate tensor(0.9046, dtype=torch.float64) tensor(-19.1936, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8533, dtype=torch.float64) delta_t tensor(0.8726, dtype=torch.float64)
17 gae_duplicate tensor(0.8987, dtype=torch.float64) tensor(-18.6600, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8733, dtype=torch.float64) delta_t tensor(0.9093, dtype=torch.float64)
16 gae_duplicate tensor(0.9470, dtype=torch.float64) tensor(-19.8727, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8949, dtype=torch.float64) delta_t tensor(0.9251, dtype=torch.float64)
15 gae_duplicate tensor(0.9613, dtype=torch.float64) tensor(-19.8178, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9181, dtype=torch.float64) delta_t tensor(0.9519, dtype=torch.float64)
14 gae_duplicate tensor(0.9855, dtype=torch.float64) tensor(-20.5903, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9432, dtype=torch.float64) delta_t tensor(0.9684, dtype=torch.float64)
13 gae_duplicate tensor(0.9867, dtype=torch.float64) tensor(-21.6534, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9706, dtype=torch.float64) delta_t tensor(0.9903, dtype=torch.float64)
12 gae_duplicate tensor(1.0259, dtype=torch.float64) tensor(-22.1611, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.0005, dtype=torch.float64) delta_t tensor(0.9802, dtype=torch.float64)
11 gae_duplicate tensor(1.0009, dtype=torch.float64) tensor(-21.8359, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(1.0333, dtype=torch.float64) delta_t tensor(1.0032, dtype=torch.float64)
10 gae_duplicate tensor(1.0439, dtype=torch.float64) tensor(-21.9845, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5516, dtype=torch.float64) delta_t tensor(0.5993, dtype=torch.float64)
9 gae_duplicate tensor(0.4101, dtype=torch.float64) tensor(-14.4445, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3533, dtype=torch.float64) delta_t tensor(0.2219, dtype=torch.float64)
8 gae_duplicate tensor(0.0129, dtype=torch.float64) tensor(-5.6596, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1405, dtype=torch.float64) delta_t tensor(0.0227, dtype=torch.float64)
7 gae_duplicate tensor(-0.1704, dtype=torch.float64) tensor(-0.9900, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1200, dtype=torch.float64) delta_t tensor(-0.0410, dtype=torch.float64)
6 gae_duplicate tensor(-0.3953, dtype=torch.float64) tensor(0.6498, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6280, dtype=torch.float64) delta_t tensor(-0.6446, dtype=torch.float64)
5 gae_duplicate tensor(-0.9828, dtype=torch.float64) tensor(12.8361, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5265, dtype=torch.float64) delta_t tensor(-1.4588, dtype=torch.float64)
4 gae_duplicate tensor(-1.8922, dtype=torch.float64) tensor(30.1548, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6647, dtype=torch.float64) delta_t tensor(-1.5735, dtype=torch.float64)
3 gae_duplicate tensor(-2.0497, dtype=torch.float64) tensor(34.6091, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5118, dtype=torch.float64) delta_t tensor(-1.6247, dtype=torch.float64)
2 gae_duplicate tensor(-2.0591, dtype=torch.float64) tensor(35.5114, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:5837.04541015625
value loss:184.56491088867188
entropies:355.20721435546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.980288028717041 seconds
19 rew tensor(0.8156, dtype=torch.float64) delta_t tensor(0.5859, dtype=torch.float64)
19 gae_duplicate tensor(0.5409, dtype=torch.float64) tensor(-11.4918, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8271, dtype=torch.float64) delta_t tensor(0.6263, dtype=torch.float64)
18 gae_duplicate tensor(0.6689, dtype=torch.float64) tensor(-13.9411, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8391, dtype=torch.float64) delta_t tensor(0.6479, dtype=torch.float64)
17 gae_duplicate tensor(0.6856, dtype=torch.float64) tensor(-13.6728, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8517, dtype=torch.float64) delta_t tensor(0.6556, dtype=torch.float64)
16 gae_duplicate tensor(0.7007, dtype=torch.float64) tensor(-14.2016, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8649, dtype=torch.float64) delta_t tensor(0.6516, dtype=torch.float64)
15 gae_duplicate tensor(0.6944, dtype=torch.float64) tensor(-14.3239, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8787, dtype=torch.float64) delta_t tensor(0.6708, dtype=torch.float64)
14 gae_duplicate tensor(0.7092, dtype=torch.float64) tensor(-14.4482, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8931, dtype=torch.float64) delta_t tensor(0.6820, dtype=torch.float64)
13 gae_duplicate tensor(0.7347, dtype=torch.float64) tensor(-14.7180, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9084, dtype=torch.float64) delta_t tensor(0.7068, dtype=torch.float64)
12 gae_duplicate tensor(0.7550, dtype=torch.float64) tensor(-15.5045, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9244, dtype=torch.float64) delta_t tensor(0.7411, dtype=torch.float64)
11 gae_duplicate tensor(0.7741, dtype=torch.float64) tensor(-16.0250, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9413, dtype=torch.float64) delta_t tensor(0.7108, dtype=torch.float64)
10 gae_duplicate tensor(0.7588, dtype=torch.float64) tensor(-15.3809, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6080, dtype=torch.float64) delta_t tensor(0.4470, dtype=torch.float64)
9 gae_duplicate tensor(0.4516, dtype=torch.float64) tensor(-10.8060, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3480, dtype=torch.float64) delta_t tensor(0.0530, dtype=torch.float64)
8 gae_duplicate tensor(-0.1901, dtype=torch.float64) tensor(-2.1831, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1584, dtype=torch.float64) delta_t tensor(-0.0917, dtype=torch.float64)
7 gae_duplicate tensor(-0.3862, dtype=torch.float64) tensor(1.5164, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0908, dtype=torch.float64) delta_t tensor(-0.0993, dtype=torch.float64)
6 gae_duplicate tensor(-0.4534, dtype=torch.float64) tensor(2.1269, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5886, dtype=torch.float64) delta_t tensor(-0.6902, dtype=torch.float64)
5 gae_duplicate tensor(-1.0060, dtype=torch.float64) tensor(13.9284, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6455, dtype=torch.float64) delta_t tensor(-1.6448, dtype=torch.float64)
4 gae_duplicate tensor(-2.0051, dtype=torch.float64) tensor(33.5202, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4568, dtype=torch.float64) delta_t tensor(-1.4432, dtype=torch.float64)
3 gae_duplicate tensor(-1.9176, dtype=torch.float64) tensor(32.0036, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3076, dtype=torch.float64) delta_t tensor(-1.5183, dtype=torch.float64)
2 gae_duplicate tensor(-1.9184, dtype=torch.float64) tensor(33.3317, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2078.640625
value loss:134.43991088867188
entropies:355.2108154296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.092660188674927 seconds
19 rew tensor(0.8061, dtype=torch.float64) delta_t tensor(0.2343, dtype=torch.float64)
19 gae_duplicate tensor(0.1683, dtype=torch.float64) tensor(-4.7527, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8245, dtype=torch.float64) delta_t tensor(0.3158, dtype=torch.float64)
18 gae_duplicate tensor(0.3033, dtype=torch.float64) tensor(-6.7489, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8334, dtype=torch.float64) delta_t tensor(0.3295, dtype=torch.float64)
17 gae_duplicate tensor(0.3036, dtype=torch.float64) tensor(-7.2606, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8326, dtype=torch.float64) delta_t tensor(0.3390, dtype=torch.float64)
16 gae_duplicate tensor(0.2805, dtype=torch.float64) tensor(-7.4270, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8419, dtype=torch.float64) delta_t tensor(0.3355, dtype=torch.float64)
15 gae_duplicate tensor(0.2746, dtype=torch.float64) tensor(-7.3943, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8614, dtype=torch.float64) delta_t tensor(0.3553, dtype=torch.float64)
14 gae_duplicate tensor(0.3408, dtype=torch.float64) tensor(-7.7743, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8716, dtype=torch.float64) delta_t tensor(0.3675, dtype=torch.float64)
13 gae_duplicate tensor(0.3640, dtype=torch.float64) tensor(-8.0019, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8821, dtype=torch.float64) delta_t tensor(0.3702, dtype=torch.float64)
12 gae_duplicate tensor(0.3728, dtype=torch.float64) tensor(-8.0796, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8931, dtype=torch.float64) delta_t tensor(0.3823, dtype=torch.float64)
11 gae_duplicate tensor(0.3659, dtype=torch.float64) tensor(-8.5173, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9044, dtype=torch.float64) delta_t tensor(0.3949, dtype=torch.float64)
10 gae_duplicate tensor(0.3814, dtype=torch.float64) tensor(-8.5458, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5083, dtype=torch.float64) delta_t tensor(0.0879, dtype=torch.float64)
9 gae_duplicate tensor(-0.0596, dtype=torch.float64) tensor(-2.5473, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2718, dtype=torch.float64) delta_t tensor(-0.2334, dtype=torch.float64)
8 gae_duplicate tensor(-0.3289, dtype=torch.float64) tensor(4.2880, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0144, dtype=torch.float64) delta_t tensor(-0.5152, dtype=torch.float64)
7 gae_duplicate tensor(-0.6562, dtype=torch.float64) tensor(10.6216, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2541, dtype=torch.float64) delta_t tensor(-0.3523, dtype=torch.float64)
6 gae_duplicate tensor(-0.5125, dtype=torch.float64) tensor(7.9705, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8202, dtype=torch.float64) delta_t tensor(-0.9885, dtype=torch.float64)
5 gae_duplicate tensor(-1.1204, dtype=torch.float64) tensor(20.7470, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9511, dtype=torch.float64) delta_t tensor(-2.0533, dtype=torch.float64)
4 gae_duplicate tensor(-2.5105, dtype=torch.float64) tensor(41.6916, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7894, dtype=torch.float64) delta_t tensor(-1.7530, dtype=torch.float64)
3 gae_duplicate tensor(-2.2673, dtype=torch.float64) tensor(38.5350, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5866, dtype=torch.float64) delta_t tensor(-1.9636, dtype=torch.float64)
2 gae_duplicate tensor(-2.4726, dtype=torch.float64) tensor(42.2000, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4902.0625
value loss:147.72528076171875
entropies:354.9695739746094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.880833148956299 seconds
19 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.0028, dtype=torch.float64)
19 gae_duplicate tensor(-0.0457, dtype=torch.float64) tensor(-0.0532, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8203, dtype=torch.float64) delta_t tensor(0.0945, dtype=torch.float64)
18 gae_duplicate tensor(0.0375, dtype=torch.float64) tensor(-1.8434, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8273, dtype=torch.float64) delta_t tensor(0.1282, dtype=torch.float64)
17 gae_duplicate tensor(0.0281, dtype=torch.float64) tensor(-2.6634, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8245, dtype=torch.float64) delta_t tensor(0.1312, dtype=torch.float64)
16 gae_duplicate tensor(0.0167, dtype=torch.float64) tensor(-2.8354, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8317, dtype=torch.float64) delta_t tensor(0.1314, dtype=torch.float64)
15 gae_duplicate tensor(0.0030, dtype=torch.float64) tensor(-2.9688, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8491, dtype=torch.float64) delta_t tensor(0.1482, dtype=torch.float64)
14 gae_duplicate tensor(0.0697, dtype=torch.float64) tensor(-3.2694, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8569, dtype=torch.float64) delta_t tensor(0.1447, dtype=torch.float64)
13 gae_duplicate tensor(0.0851, dtype=torch.float64) tensor(-3.1656, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8649, dtype=torch.float64) delta_t tensor(0.1560, dtype=torch.float64)
12 gae_duplicate tensor(0.0869, dtype=torch.float64) tensor(-3.3696, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8732, dtype=torch.float64) delta_t tensor(0.1591, dtype=torch.float64)
11 gae_duplicate tensor(0.0712, dtype=torch.float64) tensor(-3.6157, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8817, dtype=torch.float64) delta_t tensor(0.1705, dtype=torch.float64)
10 gae_duplicate tensor(0.0866, dtype=torch.float64) tensor(-3.6375, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5330, dtype=torch.float64) delta_t tensor(-0.0921, dtype=torch.float64)
9 gae_duplicate tensor(-0.3386, dtype=torch.float64) tensor(1.3254, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3244, dtype=torch.float64) delta_t tensor(-0.2860, dtype=torch.float64)
8 gae_duplicate tensor(-0.4209, dtype=torch.float64) tensor(5.7582, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0639, dtype=torch.float64) delta_t tensor(-0.5149, dtype=torch.float64)
7 gae_duplicate tensor(-0.7785, dtype=torch.float64) tensor(10.6731, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1959, dtype=torch.float64) delta_t tensor(-0.4278, dtype=torch.float64)
6 gae_duplicate tensor(-0.7734, dtype=torch.float64) tensor(9.6299, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7354, dtype=torch.float64) delta_t tensor(-0.9533, dtype=torch.float64)
5 gae_duplicate tensor(-1.3422, dtype=torch.float64) tensor(20.3009, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7960, dtype=torch.float64) delta_t tensor(-1.9794, dtype=torch.float64)
4 gae_duplicate tensor(-2.4930, dtype=torch.float64) tensor(40.6420, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6447, dtype=torch.float64) delta_t tensor(-1.6217, dtype=torch.float64)
3 gae_duplicate tensor(-2.2167, dtype=torch.float64) tensor(36.3539, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4202, dtype=torch.float64) delta_t tensor(-1.7210, dtype=torch.float64)
2 gae_duplicate tensor(-2.4183, dtype=torch.float64) tensor(37.4708, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-7371.3955078125
value loss:124.00399017333984
entropies:355.03558349609375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3978.3467)
ToM Target loss= tensor(3572.8276)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.663878917694092 seconds
19 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(-0.1465, dtype=torch.float64)
19 gae_duplicate tensor(-0.1819, dtype=torch.float64) tensor(2.8291, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8204, dtype=torch.float64) delta_t tensor(-0.0363, dtype=torch.float64)
18 gae_duplicate tensor(-0.0973, dtype=torch.float64) tensor(1.0103, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8263, dtype=torch.float64) delta_t tensor(-0.0076, dtype=torch.float64)
17 gae_duplicate tensor(-0.0936, dtype=torch.float64) tensor(0.3049, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8322, dtype=torch.float64) delta_t tensor(0.0008, dtype=torch.float64)
16 gae_duplicate tensor(-0.0753, dtype=torch.float64) tensor(-0.0127, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8383, dtype=torch.float64) delta_t tensor(-0.0044, dtype=torch.float64)
15 gae_duplicate tensor(-0.0685, dtype=torch.float64) tensor(0.1070, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8445, dtype=torch.float64) delta_t tensor(0.0018, dtype=torch.float64)
14 gae_duplicate tensor(-0.0618, dtype=torch.float64) tensor(-0.0311, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8508, dtype=torch.float64) delta_t tensor(0.0004, dtype=torch.float64)
13 gae_duplicate tensor(-0.0726, dtype=torch.float64) tensor(0.0256, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8573, dtype=torch.float64) delta_t tensor(0.0126, dtype=torch.float64)
12 gae_duplicate tensor(-0.0640, dtype=torch.float64) tensor(-0.2719, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8640, dtype=torch.float64) delta_t tensor(0.0183, dtype=torch.float64)
11 gae_duplicate tensor(-0.1229, dtype=torch.float64) tensor(-0.3675, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8708, dtype=torch.float64) delta_t tensor(0.0537, dtype=torch.float64)
10 gae_duplicate tensor(-0.0003, dtype=torch.float64) tensor(-1.0852, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4483, dtype=torch.float64) delta_t tensor(-0.3034, dtype=torch.float64)
9 gae_duplicate tensor(-0.5363, dtype=torch.float64) tensor(5.8966, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2243, dtype=torch.float64) delta_t tensor(-0.4942, dtype=torch.float64)
8 gae_duplicate tensor(-0.7176, dtype=torch.float64) tensor(10.3653, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0196, dtype=torch.float64) delta_t tensor(-0.6746, dtype=torch.float64)
7 gae_duplicate tensor(-0.9545, dtype=torch.float64) tensor(14.3660, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2346, dtype=torch.float64) delta_t tensor(-0.5621, dtype=torch.float64)
6 gae_duplicate tensor(-0.7996, dtype=torch.float64) tensor(12.3772, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7483, dtype=torch.float64) delta_t tensor(-0.9425, dtype=torch.float64)
5 gae_duplicate tensor(-1.1062, dtype=torch.float64) tensor(20.0408, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7367, dtype=torch.float64) delta_t tensor(-1.8828, dtype=torch.float64)
4 gae_duplicate tensor(-2.3644, dtype=torch.float64) tensor(39.4294, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5865, dtype=torch.float64) delta_t tensor(-1.4876, dtype=torch.float64)
3 gae_duplicate tensor(-2.0634, dtype=torch.float64) tensor(33.2562, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3790, dtype=torch.float64) delta_t tensor(-1.5660, dtype=torch.float64)
2 gae_duplicate tensor(-2.2427, dtype=torch.float64) tensor(33.6015, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-9375.3310546875
value loss:112.55609130859375
entropies:355.1478271484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.32045316696167 seconds
19 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(-0.1814, dtype=torch.float64)
19 gae_duplicate tensor(-0.2017, dtype=torch.float64) tensor(3.6463, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8210, dtype=torch.float64) delta_t tensor(-0.0745, dtype=torch.float64)
18 gae_duplicate tensor(-0.1184, dtype=torch.float64) tensor(1.8391, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8260, dtype=torch.float64) delta_t tensor(-0.0527, dtype=torch.float64)
17 gae_duplicate tensor(-0.1067, dtype=torch.float64) tensor(1.1934, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8311, dtype=torch.float64) delta_t tensor(-0.0544, dtype=torch.float64)
16 gae_duplicate tensor(-0.0948, dtype=torch.float64) tensor(1.1975, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8363, dtype=torch.float64) delta_t tensor(-0.0525, dtype=torch.float64)
15 gae_duplicate tensor(-0.1026, dtype=torch.float64) tensor(1.1378, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8415, dtype=torch.float64) delta_t tensor(-0.0481, dtype=torch.float64)
14 gae_duplicate tensor(-0.0969, dtype=torch.float64) tensor(1.0339, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8469, dtype=torch.float64) delta_t tensor(-0.0512, dtype=torch.float64)
13 gae_duplicate tensor(-0.0923, dtype=torch.float64) tensor(1.1390, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8524, dtype=torch.float64) delta_t tensor(-0.0370, dtype=torch.float64)
12 gae_duplicate tensor(-0.0805, dtype=torch.float64) tensor(0.8566, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8580, dtype=torch.float64) delta_t tensor(-0.0212, dtype=torch.float64)
11 gae_duplicate tensor(-0.1139, dtype=torch.float64) tensor(0.5014, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8636, dtype=torch.float64) delta_t tensor(0.0140, dtype=torch.float64)
10 gae_duplicate tensor(-0.0439, dtype=torch.float64) tensor(-0.2393, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3547, dtype=torch.float64) delta_t tensor(-0.3982, dtype=torch.float64)
9 gae_duplicate tensor(-0.6442, dtype=torch.float64) tensor(7.9330, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2117, dtype=torch.float64) delta_t tensor(-0.5060, dtype=torch.float64)
8 gae_duplicate tensor(-0.7058, dtype=torch.float64) tensor(10.6827, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0338, dtype=torch.float64) delta_t tensor(-0.7441, dtype=torch.float64)
7 gae_duplicate tensor(-0.9668, dtype=torch.float64) tensor(16.0605, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2472, dtype=torch.float64) delta_t tensor(-0.5845, dtype=torch.float64)
6 gae_duplicate tensor(-0.9709, dtype=torch.float64) tensor(13.0821, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7456, dtype=torch.float64) delta_t tensor(-0.8051, dtype=torch.float64)
5 gae_duplicate tensor(-1.0075, dtype=torch.float64) tensor(16.9669, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7641, dtype=torch.float64) delta_t tensor(-1.7335, dtype=torch.float64)
4 gae_duplicate tensor(-2.2111, dtype=torch.float64) tensor(35.9513, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6917, dtype=torch.float64) delta_t tensor(-1.4385, dtype=torch.float64)
3 gae_duplicate tensor(-1.8861, dtype=torch.float64) tensor(31.8823, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4525, dtype=torch.float64) delta_t tensor(-1.5651, dtype=torch.float64)
2 gae_duplicate tensor(-2.1185, dtype=torch.float64) tensor(33.5836, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-9732.12109375
value loss:106.76183319091797
entropies:355.3192138671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.822602033615112 seconds
19 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(-0.1631, dtype=torch.float64)
19 gae_duplicate tensor(-0.1824, dtype=torch.float64) tensor(3.2365, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8201, dtype=torch.float64) delta_t tensor(-0.0540, dtype=torch.float64)
18 gae_duplicate tensor(-0.0961, dtype=torch.float64) tensor(1.3847, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8244, dtype=torch.float64) delta_t tensor(-0.0383, dtype=torch.float64)
17 gae_duplicate tensor(-0.0906, dtype=torch.float64) tensor(0.9014, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8288, dtype=torch.float64) delta_t tensor(-0.0439, dtype=torch.float64)
16 gae_duplicate tensor(-0.0652, dtype=torch.float64) tensor(0.9678, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8333, dtype=torch.float64) delta_t tensor(-0.0476, dtype=torch.float64)
15 gae_duplicate tensor(-0.0764, dtype=torch.float64) tensor(1.0171, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8379, dtype=torch.float64) delta_t tensor(-0.0481, dtype=torch.float64)
14 gae_duplicate tensor(-0.0698, dtype=torch.float64) tensor(1.0610, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8425, dtype=torch.float64) delta_t tensor(-0.0374, dtype=torch.float64)
13 gae_duplicate tensor(-0.0649, dtype=torch.float64) tensor(0.8329, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8472, dtype=torch.float64) delta_t tensor(-0.0287, dtype=torch.float64)
12 gae_duplicate tensor(-0.0580, dtype=torch.float64) tensor(0.6443, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8520, dtype=torch.float64) delta_t tensor(0.0099, dtype=torch.float64)
11 gae_duplicate tensor(-0.0514, dtype=torch.float64) tensor(-0.1260, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8569, dtype=torch.float64) delta_t tensor(0.0284, dtype=torch.float64)
10 gae_duplicate tensor(0.0100, dtype=torch.float64) tensor(-0.5695, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4918, dtype=torch.float64) delta_t tensor(-0.2174, dtype=torch.float64)
9 gae_duplicate tensor(-0.4311, dtype=torch.float64) tensor(4.1675, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2655, dtype=torch.float64) delta_t tensor(-0.4098, dtype=torch.float64)
8 gae_duplicate tensor(-0.5896, dtype=torch.float64) tensor(8.6609, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0103, dtype=torch.float64) delta_t tensor(-0.6917, dtype=torch.float64)
7 gae_duplicate tensor(-0.9456, dtype=torch.float64) tensor(14.4757, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2050, dtype=torch.float64) delta_t tensor(-0.1749, dtype=torch.float64)
6 gae_duplicate tensor(-0.3706, dtype=torch.float64) tensor(4.8804, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7572, dtype=torch.float64) delta_t tensor(-0.6705, dtype=torch.float64)
5 gae_duplicate tensor(-0.8472, dtype=torch.float64) tensor(13.9126, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8814, dtype=torch.float64) delta_t tensor(-1.6990, dtype=torch.float64)
4 gae_duplicate tensor(-1.8988, dtype=torch.float64) tensor(35.1864, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7051, dtype=torch.float64) delta_t tensor(-1.2894, dtype=torch.float64)
3 gae_duplicate tensor(-1.7012, dtype=torch.float64) tensor(28.9426, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4601, dtype=torch.float64) delta_t tensor(-1.5971, dtype=torch.float64)
2 gae_duplicate tensor(-1.9080, dtype=torch.float64) tensor(33.9748, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-8387.7529296875
value loss:88.548583984375
entropies:355.545654296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.783349990844727 seconds
19 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(-0.0984, dtype=torch.float64)
19 gae_duplicate tensor(-0.1830, dtype=torch.float64) tensor(1.9561, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8199, dtype=torch.float64) delta_t tensor(0.0189, dtype=torch.float64)
18 gae_duplicate tensor(-0.0098, dtype=torch.float64) tensor(-0.1807, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8238, dtype=torch.float64) delta_t tensor(0.0144, dtype=torch.float64)
17 gae_duplicate tensor(-0.0426, dtype=torch.float64) tensor(-0.3165, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8277, dtype=torch.float64) delta_t tensor(0.0111, dtype=torch.float64)
16 gae_duplicate tensor(-0.0625, dtype=torch.float64) tensor(-0.2479, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8317, dtype=torch.float64) delta_t tensor(0.0037, dtype=torch.float64)
15 gae_duplicate tensor(-0.0689, dtype=torch.float64) tensor(-0.0920, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8357, dtype=torch.float64) delta_t tensor(0.0092, dtype=torch.float64)
14 gae_duplicate tensor(-0.0644, dtype=torch.float64) tensor(-0.1913, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8398, dtype=torch.float64) delta_t tensor(0.0056, dtype=torch.float64)
13 gae_duplicate tensor(-0.0609, dtype=torch.float64) tensor(-0.1285, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8439, dtype=torch.float64) delta_t tensor(0.0320, dtype=torch.float64)
12 gae_duplicate tensor(-0.0544, dtype=torch.float64) tensor(-0.6489, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8481, dtype=torch.float64) delta_t tensor(0.0795, dtype=torch.float64)
11 gae_duplicate tensor(0.0013, dtype=torch.float64) tensor(-1.6511, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8524, dtype=torch.float64) delta_t tensor(0.1150, dtype=torch.float64)
10 gae_duplicate tensor(0.0868, dtype=torch.float64) tensor(-2.4754, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4215, dtype=torch.float64) delta_t tensor(-0.2045, dtype=torch.float64)
9 gae_duplicate tensor(-0.3015, dtype=torch.float64) tensor(3.8167, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1953, dtype=torch.float64) delta_t tensor(-0.3678, dtype=torch.float64)
8 gae_duplicate tensor(-0.6318, dtype=torch.float64) tensor(7.6570, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0407, dtype=torch.float64) delta_t tensor(-0.6319, dtype=torch.float64)
7 gae_duplicate tensor(-0.9494, dtype=torch.float64) tensor(13.1580, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1940, dtype=torch.float64) delta_t tensor(-0.0863, dtype=torch.float64)
6 gae_duplicate tensor(-0.3986, dtype=torch.float64) tensor(3.0480, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7463, dtype=torch.float64) delta_t tensor(-0.5025, dtype=torch.float64)
5 gae_duplicate tensor(-0.5727, dtype=torch.float64) tensor(10.0904, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8937, dtype=torch.float64) delta_t tensor(-1.5076, dtype=torch.float64)
4 gae_duplicate tensor(-2.0700, dtype=torch.float64) tensor(30.6255, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6943, dtype=torch.float64) delta_t tensor(-1.0675, dtype=torch.float64)
3 gae_duplicate tensor(-1.6499, dtype=torch.float64) tensor(24.1693, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4668, dtype=torch.float64) delta_t tensor(-1.3158, dtype=torch.float64)
2 gae_duplicate tensor(-1.8135, dtype=torch.float64) tensor(28.8888, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6439.8330078125
value loss:64.67906951904297
entropies:355.7195129394531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.2543299198150635 seconds
19 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(0.0802, dtype=torch.float64)
19 gae_duplicate tensor(0.0206, dtype=torch.float64) tensor(-1.5966, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8198, dtype=torch.float64) delta_t tensor(0.1742, dtype=torch.float64)
18 gae_duplicate tensor(0.1169, dtype=torch.float64) tensor(-3.6110, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8233, dtype=torch.float64) delta_t tensor(0.2096, dtype=torch.float64)
17 gae_duplicate tensor(0.1540, dtype=torch.float64) tensor(-4.4785, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8268, dtype=torch.float64) delta_t tensor(0.2031, dtype=torch.float64)
16 gae_duplicate tensor(0.1409, dtype=torch.float64) tensor(-4.4486, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8304, dtype=torch.float64) delta_t tensor(0.2036, dtype=torch.float64)
15 gae_duplicate tensor(0.1399, dtype=torch.float64) tensor(-4.4592, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8340, dtype=torch.float64) delta_t tensor(0.1920, dtype=torch.float64)
14 gae_duplicate tensor(0.1174, dtype=torch.float64) tensor(-4.2594, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8376, dtype=torch.float64) delta_t tensor(0.2169, dtype=torch.float64)
13 gae_duplicate tensor(0.1353, dtype=torch.float64) tensor(-4.6821, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8413, dtype=torch.float64) delta_t tensor(0.2358, dtype=torch.float64)
12 gae_duplicate tensor(0.1606, dtype=torch.float64) tensor(-5.1685, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8450, dtype=torch.float64) delta_t tensor(0.2800, dtype=torch.float64)
11 gae_duplicate tensor(0.2044, dtype=torch.float64) tensor(-6.0301, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8488, dtype=torch.float64) delta_t tensor(0.2815, dtype=torch.float64)
10 gae_duplicate tensor(0.1680, dtype=torch.float64) tensor(-6.1754, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4661, dtype=torch.float64) delta_t tensor(0.0465, dtype=torch.float64)
9 gae_duplicate tensor(-0.0167, dtype=torch.float64) tensor(-1.5362, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2175, dtype=torch.float64) delta_t tensor(-0.1063, dtype=torch.float64)
8 gae_duplicate tensor(-0.3675, dtype=torch.float64) tensor(1.9891, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0114, dtype=torch.float64) delta_t tensor(-0.2269, dtype=torch.float64)
7 gae_duplicate tensor(-0.5599, dtype=torch.float64) tensor(4.5963, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2279, dtype=torch.float64) delta_t tensor(0.1429, dtype=torch.float64)
6 gae_duplicate tensor(-0.1159, dtype=torch.float64) tensor(-2.3610, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8079, dtype=torch.float64) delta_t tensor(-0.2791, dtype=torch.float64)
5 gae_duplicate tensor(-0.7384, dtype=torch.float64) tensor(5.2583, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6814, dtype=torch.float64) delta_t tensor(-1.1264, dtype=torch.float64)
4 gae_duplicate tensor(-1.6398, dtype=torch.float64) tensor(22.6437, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4714, dtype=torch.float64) delta_t tensor(-0.6931, dtype=torch.float64)
3 gae_duplicate tensor(-1.3097, dtype=torch.float64) tensor(15.9877, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2337, dtype=torch.float64) delta_t tensor(-0.8250, dtype=torch.float64)
2 gae_duplicate tensor(-1.4674, dtype=torch.float64) tensor(18.1194, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1164.60888671875
value loss:35.80730056762695
entropies:355.79254150390625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3957.6865)
ToM Target loss= tensor(3521.4033)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.36389684677124 seconds
19 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(0.1225, dtype=torch.float64)
19 gae_duplicate tensor(0.0219, dtype=torch.float64) tensor(-2.4151, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8200, dtype=torch.float64) delta_t tensor(0.2104, dtype=torch.float64)
18 gae_duplicate tensor(0.1099, dtype=torch.float64) tensor(-4.4036, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8231, dtype=torch.float64) delta_t tensor(0.2564, dtype=torch.float64)
17 gae_duplicate tensor(0.1028, dtype=torch.float64) tensor(-5.4740, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8263, dtype=torch.float64) delta_t tensor(0.2316, dtype=torch.float64)
16 gae_duplicate tensor(0.1246, dtype=torch.float64) tensor(-5.1538, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8295, dtype=torch.float64) delta_t tensor(0.2552, dtype=torch.float64)
15 gae_duplicate tensor(0.1179, dtype=torch.float64) tensor(-5.5627, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8328, dtype=torch.float64) delta_t tensor(0.2369, dtype=torch.float64)
14 gae_duplicate tensor(0.1216, dtype=torch.float64) tensor(-5.2514, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8361, dtype=torch.float64) delta_t tensor(0.2419, dtype=torch.float64)
13 gae_duplicate tensor(0.1153, dtype=torch.float64) tensor(-5.3054, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8394, dtype=torch.float64) delta_t tensor(0.2778, dtype=torch.float64)
12 gae_duplicate tensor(0.1468, dtype=torch.float64) tensor(-6.0566, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8428, dtype=torch.float64) delta_t tensor(0.2997, dtype=torch.float64)
11 gae_duplicate tensor(0.1504, dtype=torch.float64) tensor(-6.4870, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8462, dtype=torch.float64) delta_t tensor(0.3632, dtype=torch.float64)
10 gae_duplicate tensor(0.2586, dtype=torch.float64) tensor(-7.8214, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4208, dtype=torch.float64) delta_t tensor(0.0334, dtype=torch.float64)
9 gae_duplicate tensor(-0.0339, dtype=torch.float64) tensor(-1.4419, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2437, dtype=torch.float64) delta_t tensor(-0.0444, dtype=torch.float64)
8 gae_duplicate tensor(-0.1852, dtype=torch.float64) tensor(0.7262, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0047, dtype=torch.float64) delta_t tensor(-0.2358, dtype=torch.float64)
7 gae_duplicate tensor(-0.3991, dtype=torch.float64) tensor(4.6997, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3159, dtype=torch.float64) delta_t tensor(0.1816, dtype=torch.float64)
6 gae_duplicate tensor(-0.0600, dtype=torch.float64) tensor(-3.1045, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8350, dtype=torch.float64) delta_t tensor(-0.1063, dtype=torch.float64)
5 gae_duplicate tensor(-0.2549, dtype=torch.float64) tensor(1.8260, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8750, dtype=torch.float64) delta_t tensor(-1.0733, dtype=torch.float64)
4 gae_duplicate tensor(-1.3568, dtype=torch.float64) tensor(21.4332, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7286, dtype=torch.float64) delta_t tensor(-0.7111, dtype=torch.float64)
3 gae_duplicate tensor(-1.1615, dtype=torch.float64) tensor(16.2996, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4957, dtype=torch.float64) delta_t tensor(-0.7819, dtype=torch.float64)
2 gae_duplicate tensor(-1.2370, dtype=torch.float64) tensor(17.0141, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-286.23822021484375
value loss:33.642330169677734
entropies:355.8726806640625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.083094120025635 seconds
19 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.2389, dtype=torch.float64)
19 gae_duplicate tensor(0.1208, dtype=torch.float64) tensor(-4.7178, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8194, dtype=torch.float64) delta_t tensor(0.3164, dtype=torch.float64)
18 gae_duplicate tensor(0.2483, dtype=torch.float64) tensor(-6.7493, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8223, dtype=torch.float64) delta_t tensor(0.3247, dtype=torch.float64)
17 gae_duplicate tensor(0.1788, dtype=torch.float64) tensor(-7.0853, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8252, dtype=torch.float64) delta_t tensor(0.3278, dtype=torch.float64)
16 gae_duplicate tensor(0.1832, dtype=torch.float64) tensor(-7.1129, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8281, dtype=torch.float64) delta_t tensor(0.3332, dtype=torch.float64)
15 gae_duplicate tensor(0.1765, dtype=torch.float64) tensor(-7.2845, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8311, dtype=torch.float64) delta_t tensor(0.3696, dtype=torch.float64)
14 gae_duplicate tensor(0.1791, dtype=torch.float64) tensor(-8.1151, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8341, dtype=torch.float64) delta_t tensor(0.3382, dtype=torch.float64)
13 gae_duplicate tensor(0.1904, dtype=torch.float64) tensor(-7.5456, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8371, dtype=torch.float64) delta_t tensor(0.3660, dtype=torch.float64)
12 gae_duplicate tensor(0.2105, dtype=torch.float64) tensor(-7.9864, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8402, dtype=torch.float64) delta_t tensor(0.3593, dtype=torch.float64)
11 gae_duplicate tensor(0.2711, dtype=torch.float64) tensor(-7.8296, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8433, dtype=torch.float64) delta_t tensor(0.4524, dtype=torch.float64)
10 gae_duplicate tensor(0.3811, dtype=torch.float64) tensor(-9.7330, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4266, dtype=torch.float64) delta_t tensor(0.1305, dtype=torch.float64)
9 gae_duplicate tensor(0.0477, dtype=torch.float64) tensor(-3.5507, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2182, dtype=torch.float64) delta_t tensor(0.0415, dtype=torch.float64)
8 gae_duplicate tensor(-0.1593, dtype=torch.float64) tensor(-1.1852, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0095, dtype=torch.float64) delta_t tensor(-0.1126, dtype=torch.float64)
7 gae_duplicate tensor(-0.5047, dtype=torch.float64) tensor(2.0658, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3028, dtype=torch.float64) delta_t tensor(0.3878, dtype=torch.float64)
6 gae_duplicate tensor(0.1902, dtype=torch.float64) tensor(-7.4941, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8031, dtype=torch.float64) delta_t tensor(0.0439, dtype=torch.float64)
5 gae_duplicate tensor(-0.1911, dtype=torch.float64) tensor(-1.6070, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7794, dtype=torch.float64) delta_t tensor(-0.8515, dtype=torch.float64)
4 gae_duplicate tensor(-1.4252, dtype=torch.float64) tensor(16.6575, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5887, dtype=torch.float64) delta_t tensor(-0.4649, dtype=torch.float64)
3 gae_duplicate tensor(-0.9317, dtype=torch.float64) tensor(10.8443, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3927, dtype=torch.float64) delta_t tensor(-0.5853, dtype=torch.float64)
2 gae_duplicate tensor(-1.2389, dtype=torch.float64) tensor(12.6375, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2376.6484375
value loss:33.96491622924805
entropies:355.882568359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.059271812438965 seconds
19 rew tensor(0.8180, dtype=torch.float64) delta_t tensor(0.1944, dtype=torch.float64)
19 gae_duplicate tensor(0.1190, dtype=torch.float64) tensor(-3.8406, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8206, dtype=torch.float64) delta_t tensor(0.2659, dtype=torch.float64)
18 gae_duplicate tensor(0.2165, dtype=torch.float64) tensor(-5.6301, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8233, dtype=torch.float64) delta_t tensor(0.2597, dtype=torch.float64)
17 gae_duplicate tensor(0.2121, dtype=torch.float64) tensor(-5.7092, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.2465, dtype=torch.float64)
16 gae_duplicate tensor(0.1736, dtype=torch.float64) tensor(-5.4551, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8178, dtype=torch.float64) delta_t tensor(0.2533, dtype=torch.float64)
15 gae_duplicate tensor(0.1596, dtype=torch.float64) tensor(-5.5648, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8313, dtype=torch.float64) delta_t tensor(0.2584, dtype=torch.float64)
14 gae_duplicate tensor(0.1987, dtype=torch.float64) tensor(-5.6815, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8340, dtype=torch.float64) delta_t tensor(0.2756, dtype=torch.float64)
13 gae_duplicate tensor(0.2343, dtype=torch.float64) tensor(-6.0157, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8368, dtype=torch.float64) delta_t tensor(0.2994, dtype=torch.float64)
12 gae_duplicate tensor(0.2676, dtype=torch.float64) tensor(-6.5285, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8397, dtype=torch.float64) delta_t tensor(0.3020, dtype=torch.float64)
11 gae_duplicate tensor(0.2196, dtype=torch.float64) tensor(-6.6436, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8318, dtype=torch.float64) delta_t tensor(0.4150, dtype=torch.float64)
10 gae_duplicate tensor(0.3150, dtype=torch.float64) tensor(-8.8575, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3220, dtype=torch.float64) delta_t tensor(0.0097, dtype=torch.float64)
9 gae_duplicate tensor(-0.1495, dtype=torch.float64) tensor(-1.0680, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0923, dtype=torch.float64) delta_t tensor(-0.1048, dtype=torch.float64)
8 gae_duplicate tensor(-0.3581, dtype=torch.float64) tensor(1.9665, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0973, dtype=torch.float64) delta_t tensor(-0.2123, dtype=torch.float64)
7 gae_duplicate tensor(-0.5266, dtype=torch.float64) tensor(4.4125, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4004, dtype=torch.float64) delta_t tensor(0.0347, dtype=torch.float64)
6 gae_duplicate tensor(-0.5186, dtype=torch.float64) tensor(-0.2630, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8888, dtype=torch.float64) delta_t tensor(0.1173, dtype=torch.float64)
5 gae_duplicate tensor(-0.2426, dtype=torch.float64) tensor(-2.3537, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8487, dtype=torch.float64) delta_t tensor(-0.7697, dtype=torch.float64)
4 gae_duplicate tensor(-1.1272, dtype=torch.float64) tensor(14.9416, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8436, dtype=torch.float64) delta_t tensor(-0.4311, dtype=torch.float64)
3 gae_duplicate tensor(-1.0078, dtype=torch.float64) tensor(9.9806, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5664, dtype=torch.float64) delta_t tensor(-0.4619, dtype=torch.float64)
2 gae_duplicate tensor(-1.0241, dtype=torch.float64) tensor(10.1685, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1099.545654296875
value loss:24.840023040771484
entropies:355.91375732421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6696460247039795 seconds
19 rew tensor(0.8208, dtype=torch.float64) delta_t tensor(0.1562, dtype=torch.float64)
19 gae_duplicate tensor(0.0810, dtype=torch.float64) tensor(-3.0855, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8233, dtype=torch.float64) delta_t tensor(0.2261, dtype=torch.float64)
18 gae_duplicate tensor(0.1638, dtype=torch.float64) tensor(-4.7814, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8258, dtype=torch.float64) delta_t tensor(0.2186, dtype=torch.float64)
17 gae_duplicate tensor(0.1568, dtype=torch.float64) tensor(-4.7953, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8175, dtype=torch.float64) delta_t tensor(0.2153, dtype=torch.float64)
16 gae_duplicate tensor(0.1123, dtype=torch.float64) tensor(-4.7354, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8200, dtype=torch.float64) delta_t tensor(0.2085, dtype=torch.float64)
15 gae_duplicate tensor(0.1051, dtype=torch.float64) tensor(-4.5970, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8333, dtype=torch.float64) delta_t tensor(0.2223, dtype=torch.float64)
14 gae_duplicate tensor(0.1605, dtype=torch.float64) tensor(-4.8651, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8358, dtype=torch.float64) delta_t tensor(0.2321, dtype=torch.float64)
13 gae_duplicate tensor(0.1697, dtype=torch.float64) tensor(-5.0742, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8074, dtype=torch.float64) delta_t tensor(0.2189, dtype=torch.float64)
12 gae_duplicate tensor(0.1164, dtype=torch.float64) tensor(-4.8469, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7571, dtype=torch.float64) delta_t tensor(0.1944, dtype=torch.float64)
11 gae_duplicate tensor(0.0459, dtype=torch.float64) tensor(-4.3237, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7173, dtype=torch.float64) delta_t tensor(0.2545, dtype=torch.float64)
10 gae_duplicate tensor(-0.0486, dtype=torch.float64) tensor(-5.4788, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3330, dtype=torch.float64) delta_t tensor(-0.0271, dtype=torch.float64)
9 gae_duplicate tensor(-0.1642, dtype=torch.float64) tensor(-0.0009, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1346, dtype=torch.float64) delta_t tensor(-0.0407, dtype=torch.float64)
8 gae_duplicate tensor(-0.3003, dtype=torch.float64) tensor(0.7928, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1072, dtype=torch.float64) delta_t tensor(-0.2450, dtype=torch.float64)
7 gae_duplicate tensor(-0.4634, dtype=torch.float64) tensor(4.9472, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3980, dtype=torch.float64) delta_t tensor(0.0353, dtype=torch.float64)
6 gae_duplicate tensor(-0.4841, dtype=torch.float64) tensor(-0.1847, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8689, dtype=torch.float64) delta_t tensor(0.2541, dtype=torch.float64)
5 gae_duplicate tensor(0.0438, dtype=torch.float64) tensor(-5.0322, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7055, dtype=torch.float64) delta_t tensor(-0.4515, dtype=torch.float64)
4 gae_duplicate tensor(-0.6648, dtype=torch.float64) tensor(8.4083, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8629, dtype=torch.float64) delta_t tensor(-0.3084, dtype=torch.float64)
3 gae_duplicate tensor(-0.5675, dtype=torch.float64) tensor(6.9267, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5755, dtype=torch.float64) delta_t tensor(-0.3384, dtype=torch.float64)
2 gae_duplicate tensor(-0.6631, dtype=torch.float64) tensor(7.4138, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1162.759033203125
value loss:14.913857460021973
entropies:355.94122314453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.040406942367554 seconds
19 rew tensor(0.8202, dtype=torch.float64) delta_t tensor(0.1711, dtype=torch.float64)
19 gae_duplicate tensor(0.0958, dtype=torch.float64) tensor(-3.3856, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8119, dtype=torch.float64) delta_t tensor(0.2474, dtype=torch.float64)
18 gae_duplicate tensor(0.2008, dtype=torch.float64) tensor(-5.2282, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.2362, dtype=torch.float64)
17 gae_duplicate tensor(0.1212, dtype=torch.float64) tensor(-5.1946, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8060, dtype=torch.float64) delta_t tensor(0.2153, dtype=torch.float64)
16 gae_duplicate tensor(0.1277, dtype=torch.float64) tensor(-4.7767, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8082, dtype=torch.float64) delta_t tensor(0.2116, dtype=torch.float64)
15 gae_duplicate tensor(0.1196, dtype=torch.float64) tensor(-4.6698, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8315, dtype=torch.float64) delta_t tensor(0.2400, dtype=torch.float64)
14 gae_duplicate tensor(0.1221, dtype=torch.float64) tensor(-5.2024, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8339, dtype=torch.float64) delta_t tensor(0.2656, dtype=torch.float64)
13 gae_duplicate tensor(0.1472, dtype=torch.float64) tensor(-5.7805, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8363, dtype=torch.float64) delta_t tensor(0.2783, dtype=torch.float64)
12 gae_duplicate tensor(0.1517, dtype=torch.float64) tensor(-6.0868, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8387, dtype=torch.float64) delta_t tensor(0.3055, dtype=torch.float64)
11 gae_duplicate tensor(0.1988, dtype=torch.float64) tensor(-6.6512, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8307, dtype=torch.float64) delta_t tensor(0.4014, dtype=torch.float64)
10 gae_duplicate tensor(0.3207, dtype=torch.float64) tensor(-8.5819, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3710, dtype=torch.float64) delta_t tensor(0.0351, dtype=torch.float64)
9 gae_duplicate tensor(-0.1385, dtype=torch.float64) tensor(-1.5501, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2779, dtype=torch.float64) delta_t tensor(0.1455, dtype=torch.float64)
8 gae_duplicate tensor(0.0252, dtype=torch.float64) tensor(-3.0386, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0477, dtype=torch.float64) delta_t tensor(-0.0195, dtype=torch.float64)
7 gae_duplicate tensor(-0.2690, dtype=torch.float64) tensor(0.0916, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2134, dtype=torch.float64) delta_t tensor(0.5059, dtype=torch.float64)
6 gae_duplicate tensor(0.1532, dtype=torch.float64) tensor(-9.9912, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7462, dtype=torch.float64) delta_t tensor(0.5246, dtype=torch.float64)
5 gae_duplicate tensor(0.3634, dtype=torch.float64) tensor(-11.3955, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7915, dtype=torch.float64) delta_t tensor(-0.5287, dtype=torch.float64)
4 gae_duplicate tensor(-0.8193, dtype=torch.float64) tensor(9.3215, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7229, dtype=torch.float64) delta_t tensor(-0.0881, dtype=torch.float64)
3 gae_duplicate tensor(-0.4087, dtype=torch.float64) tensor(2.6752, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5047, dtype=torch.float64) delta_t tensor(-0.2918, dtype=torch.float64)
2 gae_duplicate tensor(-0.7795, dtype=torch.float64) tensor(6.0528, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3327.066650390625
value loss:22.4549560546875
entropies:355.9465637207031
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3958.1079)
ToM Target loss= tensor(3531.2065)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.227495908737183 seconds
19 rew tensor(0.8203, dtype=torch.float64) delta_t tensor(0.1091, dtype=torch.float64)
19 gae_duplicate tensor(0.0231, dtype=torch.float64) tensor(-2.1583, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8224, dtype=torch.float64) delta_t tensor(0.1909, dtype=torch.float64)
18 gae_duplicate tensor(0.0990, dtype=torch.float64) tensor(-3.9920, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8246, dtype=torch.float64) delta_t tensor(0.2252, dtype=torch.float64)
17 gae_duplicate tensor(0.0576, dtype=torch.float64) tensor(-4.8514, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8268, dtype=torch.float64) delta_t tensor(0.2184, dtype=torch.float64)
16 gae_duplicate tensor(0.0863, dtype=torch.float64) tensor(-4.8016, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8290, dtype=torch.float64) delta_t tensor(0.2117, dtype=torch.float64)
15 gae_duplicate tensor(0.0626, dtype=torch.float64) tensor(-4.6671, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8312, dtype=torch.float64) delta_t tensor(0.2199, dtype=torch.float64)
14 gae_duplicate tensor(0.0650, dtype=torch.float64) tensor(-4.8183, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8334, dtype=torch.float64) delta_t tensor(0.2325, dtype=torch.float64)
13 gae_duplicate tensor(0.1444, dtype=torch.float64) tensor(-5.0820, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8357, dtype=torch.float64) delta_t tensor(0.2791, dtype=torch.float64)
12 gae_duplicate tensor(0.1198, dtype=torch.float64) tensor(-6.0281, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8380, dtype=torch.float64) delta_t tensor(0.3227, dtype=torch.float64)
11 gae_duplicate tensor(0.1345, dtype=torch.float64) tensor(-6.9815, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8402, dtype=torch.float64) delta_t tensor(0.4296, dtype=torch.float64)
10 gae_duplicate tensor(0.2589, dtype=torch.float64) tensor(-9.1930, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4418, dtype=torch.float64) delta_t tensor(0.1486, dtype=torch.float64)
9 gae_duplicate tensor(-0.1285, dtype=torch.float64) tensor(-3.8613, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1896, dtype=torch.float64) delta_t tensor(0.0729, dtype=torch.float64)
8 gae_duplicate tensor(-0.1966, dtype=torch.float64) tensor(-1.8303, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0018, dtype=torch.float64) delta_t tensor(-0.0167, dtype=torch.float64)
7 gae_duplicate tensor(-0.5883, dtype=torch.float64) tensor(0.1496, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2084, dtype=torch.float64) delta_t tensor(0.7644, dtype=torch.float64)
6 gae_duplicate tensor(0.1857, dtype=torch.float64) tensor(-15.0918, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7543, dtype=torch.float64) delta_t tensor(0.6107, dtype=torch.float64)
5 gae_duplicate tensor(0.5871, dtype=torch.float64) tensor(-13.5896, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7798, dtype=torch.float64) delta_t tensor(-0.4002, dtype=torch.float64)
4 gae_duplicate tensor(-0.4198, dtype=torch.float64) tensor(6.5547, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5398, dtype=torch.float64) delta_t tensor(0.2221, dtype=torch.float64)
3 gae_duplicate tensor(-0.0872, dtype=torch.float64) tensor(-3.7290, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3601, dtype=torch.float64) delta_t tensor(0.1138, dtype=torch.float64)
2 gae_duplicate tensor(-0.0585, dtype=torch.float64) tensor(-2.6229, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4579.9677734375
value loss:22.201128005981445
entropies:355.94921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.843249797821045 seconds
19 rew tensor(0.8202, dtype=torch.float64) delta_t tensor(-0.0296, dtype=torch.float64)
19 gae_duplicate tensor(-0.0536, dtype=torch.float64) tensor(0.5851, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8222, dtype=torch.float64) delta_t tensor(0.0652, dtype=torch.float64)
18 gae_duplicate tensor(0.0464, dtype=torch.float64) tensor(-1.2308, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8243, dtype=torch.float64) delta_t tensor(0.1178, dtype=torch.float64)
17 gae_duplicate tensor(0.0507, dtype=torch.float64) tensor(-2.4544, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8263, dtype=torch.float64) delta_t tensor(0.0896, dtype=torch.float64)
16 gae_duplicate tensor(0.0472, dtype=torch.float64) tensor(-2.0181, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8284, dtype=torch.float64) delta_t tensor(0.0799, dtype=torch.float64)
15 gae_duplicate tensor(0.0221, dtype=torch.float64) tensor(-1.7790, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8305, dtype=torch.float64) delta_t tensor(0.0892, dtype=torch.float64)
14 gae_duplicate tensor(0.0302, dtype=torch.float64) tensor(-1.9451, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8326, dtype=torch.float64) delta_t tensor(0.1030, dtype=torch.float64)
13 gae_duplicate tensor(0.0346, dtype=torch.float64) tensor(-2.2319, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8347, dtype=torch.float64) delta_t tensor(0.1484, dtype=torch.float64)
12 gae_duplicate tensor(0.0634, dtype=torch.float64) tensor(-3.1608, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8368, dtype=torch.float64) delta_t tensor(0.1818, dtype=torch.float64)
11 gae_duplicate tensor(0.1229, dtype=torch.float64) tensor(-3.9147, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8390, dtype=torch.float64) delta_t tensor(0.3177, dtype=torch.float64)
10 gae_duplicate tensor(0.2731, dtype=torch.float64) tensor(-6.6713, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4278, dtype=torch.float64) delta_t tensor(-0.0102, dtype=torch.float64)
9 gae_duplicate tensor(-0.1162, dtype=torch.float64) tensor(-0.4657, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2170, dtype=torch.float64) delta_t tensor(0.0973, dtype=torch.float64)
8 gae_duplicate tensor(-0.0785, dtype=torch.float64) tensor(-1.9713, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0281, dtype=torch.float64) delta_t tensor(-0.0034, dtype=torch.float64)
7 gae_duplicate tensor(-0.6242, dtype=torch.float64) tensor(-0.1408, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2566, dtype=torch.float64) delta_t tensor(0.8988, dtype=torch.float64)
6 gae_duplicate tensor(0.5495, dtype=torch.float64) tensor(-17.7843, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7835, dtype=torch.float64) delta_t tensor(0.6355, dtype=torch.float64)
5 gae_duplicate tensor(0.2958, dtype=torch.float64) tensor(-14.3558, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7752, dtype=torch.float64) delta_t tensor(-0.2354, dtype=torch.float64)
4 gae_duplicate tensor(-0.6948, dtype=torch.float64) tensor(3.2207, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5756, dtype=torch.float64) delta_t tensor(0.2700, dtype=torch.float64)
3 gae_duplicate tensor(-0.2041, dtype=torch.float64) tensor(-5.0175, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3943, dtype=torch.float64) delta_t tensor(0.1223, dtype=torch.float64)
2 gae_duplicate tensor(-0.1713, dtype=torch.float64) tensor(-2.9245, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3373.94921875
value loss:18.78134536743164
entropies:355.9490661621094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9799113273620605 seconds
19 rew tensor(0.8199, dtype=torch.float64) delta_t tensor(-0.1868, dtype=torch.float64)
19 gae_duplicate tensor(-0.1999, dtype=torch.float64) tensor(3.6931, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8218, dtype=torch.float64) delta_t tensor(-0.0697, dtype=torch.float64)
18 gae_duplicate tensor(-0.1012, dtype=torch.float64) tensor(1.7477, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8237, dtype=torch.float64) delta_t tensor(-0.0427, dtype=torch.float64)
17 gae_duplicate tensor(-0.1100, dtype=torch.float64) tensor(1.0180, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8256, dtype=torch.float64) delta_t tensor(-0.0799, dtype=torch.float64)
16 gae_duplicate tensor(-0.1097, dtype=torch.float64) tensor(1.6798, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8276, dtype=torch.float64) delta_t tensor(-0.0779, dtype=torch.float64)
15 gae_duplicate tensor(-0.1250, dtype=torch.float64) tensor(1.7088, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8295, dtype=torch.float64) delta_t tensor(-0.0805, dtype=torch.float64)
14 gae_duplicate tensor(-0.1393, dtype=torch.float64) tensor(1.7610, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8315, dtype=torch.float64) delta_t tensor(-0.0575, dtype=torch.float64)
13 gae_duplicate tensor(-0.1044, dtype=torch.float64) tensor(1.3124, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8335, dtype=torch.float64) delta_t tensor(-0.0195, dtype=torch.float64)
12 gae_duplicate tensor(-0.0780, dtype=torch.float64) tensor(0.5173, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8355, dtype=torch.float64) delta_t tensor(0.0381, dtype=torch.float64)
11 gae_duplicate tensor(-0.0377, dtype=torch.float64) tensor(-0.7025, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8375, dtype=torch.float64) delta_t tensor(0.1662, dtype=torch.float64)
10 gae_duplicate tensor(0.1085, dtype=torch.float64) tensor(-3.3566, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3946, dtype=torch.float64) delta_t tensor(-0.1767, dtype=torch.float64)
9 gae_duplicate tensor(-0.4153, dtype=torch.float64) tensor(3.1510, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2060, dtype=torch.float64) delta_t tensor(0.0604, dtype=torch.float64)
8 gae_duplicate tensor(-0.2707, dtype=torch.float64) tensor(-0.8763, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0044, dtype=torch.float64) delta_t tensor(-0.2227, dtype=torch.float64)
7 gae_duplicate tensor(-0.7345, dtype=torch.float64) tensor(4.3150, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3308, dtype=torch.float64) delta_t tensor(0.7018, dtype=torch.float64)
6 gae_duplicate tensor(0.2043, dtype=torch.float64) tensor(-13.4510, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9515, dtype=torch.float64) delta_t tensor(0.4658, dtype=torch.float64)
5 gae_duplicate tensor(0.2467, dtype=torch.float64) tensor(-10.5740, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9637, dtype=torch.float64) delta_t tensor(-0.4459, dtype=torch.float64)
4 gae_duplicate tensor(-0.7295, dtype=torch.float64) tensor(7.7625, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7892, dtype=torch.float64) delta_t tensor(0.1304, dtype=torch.float64)
3 gae_duplicate tensor(-0.2363, dtype=torch.float64) tensor(-1.8032, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5889, dtype=torch.float64) delta_t tensor(-0.0119, dtype=torch.float64)
2 gae_duplicate tensor(-0.3540, dtype=torch.float64) tensor(0.0555, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:14.122344970703125
value loss:14.170089721679688
entropies:355.94708251953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.890111923217773 seconds
19 rew tensor(0.8197, dtype=torch.float64) delta_t tensor(-0.3280, dtype=torch.float64)
19 gae_duplicate tensor(-0.4139, dtype=torch.float64) tensor(6.4852, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8216, dtype=torch.float64) delta_t tensor(-0.2107, dtype=torch.float64)
18 gae_duplicate tensor(-0.3336, dtype=torch.float64) tensor(4.8143, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8234, dtype=torch.float64) delta_t tensor(-0.2223, dtype=torch.float64)
17 gae_duplicate tensor(-0.3472, dtype=torch.float64) tensor(4.8739, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8252, dtype=torch.float64) delta_t tensor(-0.2082, dtype=torch.float64)
16 gae_duplicate tensor(-0.3361, dtype=torch.float64) tensor(4.6078, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8270, dtype=torch.float64) delta_t tensor(-0.2120, dtype=torch.float64)
15 gae_duplicate tensor(-0.3482, dtype=torch.float64) tensor(4.6514, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8289, dtype=torch.float64) delta_t tensor(-0.2142, dtype=torch.float64)
14 gae_duplicate tensor(-0.3462, dtype=torch.float64) tensor(4.7025, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8308, dtype=torch.float64) delta_t tensor(-0.1983, dtype=torch.float64)
13 gae_duplicate tensor(-0.3356, dtype=torch.float64) tensor(4.3915, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8327, dtype=torch.float64) delta_t tensor(-0.1674, dtype=torch.float64)
12 gae_duplicate tensor(-0.3156, dtype=torch.float64) tensor(3.7499, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8346, dtype=torch.float64) delta_t tensor(-0.1124, dtype=torch.float64)
11 gae_duplicate tensor(-0.2475, dtype=torch.float64) tensor(2.5987, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8365, dtype=torch.float64) delta_t tensor(-0.0120, dtype=torch.float64)
10 gae_duplicate tensor(-0.1856, dtype=torch.float64) tensor(0.4977, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4253, dtype=torch.float64) delta_t tensor(-0.2567, dtype=torch.float64)
9 gae_duplicate tensor(-0.4489, dtype=torch.float64) tensor(5.1279, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2248, dtype=torch.float64) delta_t tensor(-0.0929, dtype=torch.float64)
8 gae_duplicate tensor(-0.2266, dtype=torch.float64) tensor(2.3508, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0394, dtype=torch.float64) delta_t tensor(-0.2728, dtype=torch.float64)
7 gae_duplicate tensor(-0.5464, dtype=torch.float64) tensor(5.6216, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2928, dtype=torch.float64) delta_t tensor(0.5180, dtype=torch.float64)
6 gae_duplicate tensor(-0.0130, dtype=torch.float64) tensor(-9.6768, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8302, dtype=torch.float64) delta_t tensor(0.5525, dtype=torch.float64)
5 gae_duplicate tensor(0.4156, dtype=torch.float64) tensor(-11.8942, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9033, dtype=torch.float64) delta_t tensor(-0.3681, dtype=torch.float64)
4 gae_duplicate tensor(-0.5139, dtype=torch.float64) tensor(6.0899, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7253, dtype=torch.float64) delta_t tensor(0.2270, dtype=torch.float64)
3 gae_duplicate tensor(-0.0680, dtype=torch.float64) tensor(-3.8777, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4591, dtype=torch.float64) delta_t tensor(0.1940, dtype=torch.float64)
2 gae_duplicate tensor(0.0689, dtype=torch.float64) tensor(-4.2239, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1764.1844482421875
value loss:17.33539581298828
entropies:355.9496154785156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.801159858703613 seconds
19 rew tensor(0.8194, dtype=torch.float64) delta_t tensor(-0.4310, dtype=torch.float64)
19 gae_duplicate tensor(-0.4820, dtype=torch.float64) tensor(8.5221, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8211, dtype=torch.float64) delta_t tensor(-0.2809, dtype=torch.float64)
18 gae_duplicate tensor(-0.3987, dtype=torch.float64) tensor(6.4077, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8228, dtype=torch.float64) delta_t tensor(-0.2617, dtype=torch.float64)
17 gae_duplicate tensor(-0.4153, dtype=torch.float64) tensor(5.8160, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8246, dtype=torch.float64) delta_t tensor(-0.2882, dtype=torch.float64)
16 gae_duplicate tensor(-0.4136, dtype=torch.float64) tensor(6.2792, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8263, dtype=torch.float64) delta_t tensor(-0.2857, dtype=torch.float64)
15 gae_duplicate tensor(-0.4239, dtype=torch.float64) tensor(6.2758, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8281, dtype=torch.float64) delta_t tensor(-0.2774, dtype=torch.float64)
14 gae_duplicate tensor(-0.4219, dtype=torch.float64) tensor(6.1132, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8298, dtype=torch.float64) delta_t tensor(-0.2763, dtype=torch.float64)
13 gae_duplicate tensor(-0.4151, dtype=torch.float64) tensor(6.0747, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8316, dtype=torch.float64) delta_t tensor(-0.2322, dtype=torch.float64)
12 gae_duplicate tensor(-0.3901, dtype=torch.float64) tensor(5.1986, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8334, dtype=torch.float64) delta_t tensor(-0.1702, dtype=torch.float64)
11 gae_duplicate tensor(-0.3580, dtype=torch.float64) tensor(3.8878, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8352, dtype=torch.float64) delta_t tensor(-0.0795, dtype=torch.float64)
10 gae_duplicate tensor(-0.2449, dtype=torch.float64) tensor(1.9602, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4563, dtype=torch.float64) delta_t tensor(-0.2902, dtype=torch.float64)
9 gae_duplicate tensor(-0.5160, dtype=torch.float64) tensor(5.9356, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2033, dtype=torch.float64) delta_t tensor(-0.1303, dtype=torch.float64)
8 gae_duplicate tensor(-0.2475, dtype=torch.float64) tensor(3.1615, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0398, dtype=torch.float64) delta_t tensor(-0.3519, dtype=torch.float64)
7 gae_duplicate tensor(-0.5615, dtype=torch.float64) tensor(7.2823, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2813, dtype=torch.float64) delta_t tensor(0.7421, dtype=torch.float64)
6 gae_duplicate tensor(0.4609, dtype=torch.float64) tensor(-13.9593, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8074, dtype=torch.float64) delta_t tensor(0.6078, dtype=torch.float64)
5 gae_duplicate tensor(0.4542, dtype=torch.float64) tensor(-13.3809, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0064, dtype=torch.float64) delta_t tensor(-0.5275, dtype=torch.float64)
4 gae_duplicate tensor(-0.9193, dtype=torch.float64) tensor(9.0849, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7664, dtype=torch.float64) delta_t tensor(0.2364, dtype=torch.float64)
3 gae_duplicate tensor(-0.1489, dtype=torch.float64) tensor(-3.7730, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5217, dtype=torch.float64) delta_t tensor(0.1133, dtype=torch.float64)
2 gae_duplicate tensor(-0.1835, dtype=torch.float64) tensor(-2.6100, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2703.029296875
value loss:24.637222290039062
entropies:355.9466552734375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3954.1982)
ToM Target loss= tensor(3502.4778)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.181749105453491 seconds
19 rew tensor(0.8196, dtype=torch.float64) delta_t tensor(-0.4916, dtype=torch.float64)
19 gae_duplicate tensor(-0.5275, dtype=torch.float64) tensor(9.7214, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8213, dtype=torch.float64) delta_t tensor(-0.3522, dtype=torch.float64)
18 gae_duplicate tensor(-0.4477, dtype=torch.float64) tensor(7.9380, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8229, dtype=torch.float64) delta_t tensor(-0.3422, dtype=torch.float64)
17 gae_duplicate tensor(-0.4411, dtype=torch.float64) tensor(7.5568, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(-0.3665, dtype=torch.float64)
16 gae_duplicate tensor(-0.4869, dtype=torch.float64) tensor(8.0050, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(-0.3689, dtype=torch.float64)
15 gae_duplicate tensor(-0.4955, dtype=torch.float64) tensor(8.1037, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8278, dtype=torch.float64) delta_t tensor(-0.3612, dtype=torch.float64)
14 gae_duplicate tensor(-0.4460, dtype=torch.float64) tensor(7.9446, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8295, dtype=torch.float64) delta_t tensor(-0.3292, dtype=torch.float64)
13 gae_duplicate tensor(-0.4121, dtype=torch.float64) tensor(7.2966, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8312, dtype=torch.float64) delta_t tensor(-0.3055, dtype=torch.float64)
12 gae_duplicate tensor(-0.4183, dtype=torch.float64) tensor(6.7525, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8329, dtype=torch.float64) delta_t tensor(-0.2307, dtype=torch.float64)
11 gae_duplicate tensor(-0.3385, dtype=torch.float64) tensor(5.2347, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8346, dtype=torch.float64) delta_t tensor(-0.1097, dtype=torch.float64)
10 gae_duplicate tensor(-0.2660, dtype=torch.float64) tensor(2.6840, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2995, dtype=torch.float64) delta_t tensor(-0.5019, dtype=torch.float64)
9 gae_duplicate tensor(-0.6933, dtype=torch.float64) tensor(10.1898, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1625, dtype=torch.float64) delta_t tensor(-0.2447, dtype=torch.float64)
8 gae_duplicate tensor(-0.7193, dtype=torch.float64) tensor(5.8613, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0589, dtype=torch.float64) delta_t tensor(-0.4865, dtype=torch.float64)
7 gae_duplicate tensor(-0.8169, dtype=torch.float64) tensor(10.2003, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2907, dtype=torch.float64) delta_t tensor(0.3557, dtype=torch.float64)
6 gae_duplicate tensor(-0.3479, dtype=torch.float64) tensor(-5.9819, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7848, dtype=torch.float64) delta_t tensor(0.5821, dtype=torch.float64)
5 gae_duplicate tensor(0.1550, dtype=torch.float64) tensor(-12.1257, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9424, dtype=torch.float64) delta_t tensor(-0.4249, dtype=torch.float64)
4 gae_duplicate tensor(-0.5661, dtype=torch.float64) tensor(7.1905, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8683, dtype=torch.float64) delta_t tensor(0.2101, dtype=torch.float64)
3 gae_duplicate tensor(-0.0396, dtype=torch.float64) tensor(-3.4448, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6253, dtype=torch.float64) delta_t tensor(0.1141, dtype=torch.float64)
2 gae_duplicate tensor(-0.1116, dtype=torch.float64) tensor(-2.6151, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4443.7265625
value loss:28.009716033935547
entropies:355.9383239746094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.049167156219482 seconds
19 rew tensor(0.8202, dtype=torch.float64) delta_t tensor(-0.4277, dtype=torch.float64)
19 gae_duplicate tensor(-0.4566, dtype=torch.float64) tensor(8.4578, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8218, dtype=torch.float64) delta_t tensor(-0.2920, dtype=torch.float64)
18 gae_duplicate tensor(-0.3700, dtype=torch.float64) tensor(6.6200, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8233, dtype=torch.float64) delta_t tensor(-0.2463, dtype=torch.float64)
17 gae_duplicate tensor(-0.3671, dtype=torch.float64) tensor(5.5380, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(-0.2865, dtype=torch.float64)
16 gae_duplicate tensor(-0.4111, dtype=torch.float64) tensor(6.2166, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(-0.2888, dtype=torch.float64)
15 gae_duplicate tensor(-0.4251, dtype=torch.float64) tensor(6.3337, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8280, dtype=torch.float64) delta_t tensor(-0.2842, dtype=torch.float64)
14 gae_duplicate tensor(-0.3788, dtype=torch.float64) tensor(6.2453, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8296, dtype=torch.float64) delta_t tensor(-0.2720, dtype=torch.float64)
13 gae_duplicate tensor(-0.3521, dtype=torch.float64) tensor(5.9841, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8313, dtype=torch.float64) delta_t tensor(-0.2231, dtype=torch.float64)
12 gae_duplicate tensor(-0.3544, dtype=torch.float64) tensor(5.0088, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8329, dtype=torch.float64) delta_t tensor(-0.1716, dtype=torch.float64)
11 gae_duplicate tensor(-0.3486, dtype=torch.float64) tensor(3.8976, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4087, dtype=torch.float64) delta_t tensor(-0.4855, dtype=torch.float64)
10 gae_duplicate tensor(-2.8243, dtype=torch.float64) tensor(9.9921, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2640, dtype=torch.float64) delta_t tensor(-0.4975, dtype=torch.float64)
9 gae_duplicate tensor(-1.9297, dtype=torch.float64) tensor(10.8091, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2464, dtype=torch.float64) delta_t tensor(-0.0959, dtype=torch.float64)
8 gae_duplicate tensor(-0.4030, dtype=torch.float64) tensor(2.9798, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0173, dtype=torch.float64) delta_t tensor(-0.1658, dtype=torch.float64)
7 gae_duplicate tensor(-0.3966, dtype=torch.float64) tensor(3.5963, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3239, dtype=torch.float64) delta_t tensor(0.5530, dtype=torch.float64)
6 gae_duplicate tensor(-0.3514, dtype=torch.float64) tensor(-10.5920, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8396, dtype=torch.float64) delta_t tensor(0.6324, dtype=torch.float64)
5 gae_duplicate tensor(-0.0189, dtype=torch.float64) tensor(-13.5654, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8197, dtype=torch.float64) delta_t tensor(-0.2715, dtype=torch.float64)
4 gae_duplicate tensor(-0.4739, dtype=torch.float64) tensor(4.0189, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7261, dtype=torch.float64) delta_t tensor(0.3039, dtype=torch.float64)
3 gae_duplicate tensor(-0.2796, dtype=torch.float64) tensor(-5.6019, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5454, dtype=torch.float64) delta_t tensor(-0.0291, dtype=torch.float64)
2 gae_duplicate tensor(-0.7986, dtype=torch.float64) tensor(0.0529, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3119.659912109375
value loss:42.02997589111328
entropies:355.93243408203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.044530868530273 seconds
19 rew tensor(0.8090, dtype=torch.float64) delta_t tensor(-0.3616, dtype=torch.float64)
19 gae_duplicate tensor(-0.4317, dtype=torch.float64) tensor(7.1493, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8104, dtype=torch.float64) delta_t tensor(-0.2336, dtype=torch.float64)
18 gae_duplicate tensor(-0.3247, dtype=torch.float64) tensor(5.3270, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8226, dtype=torch.float64) delta_t tensor(-0.1968, dtype=torch.float64)
17 gae_duplicate tensor(-0.3095, dtype=torch.float64) tensor(4.4206, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(-0.2214, dtype=torch.float64)
16 gae_duplicate tensor(-0.3534, dtype=torch.float64) tensor(4.8185, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(-0.2251, dtype=torch.float64)
15 gae_duplicate tensor(-0.3615, dtype=torch.float64) tensor(4.9186, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8271, dtype=torch.float64) delta_t tensor(-0.2173, dtype=torch.float64)
14 gae_duplicate tensor(-0.3272, dtype=torch.float64) tensor(4.8143, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8286, dtype=torch.float64) delta_t tensor(-0.2003, dtype=torch.float64)
13 gae_duplicate tensor(-0.3191, dtype=torch.float64) tensor(4.4229, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8302, dtype=torch.float64) delta_t tensor(-0.1613, dtype=torch.float64)
12 gae_duplicate tensor(-0.2823, dtype=torch.float64) tensor(3.6381, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8317, dtype=torch.float64) delta_t tensor(-0.1271, dtype=torch.float64)
11 gae_duplicate tensor(-0.2611, dtype=torch.float64) tensor(2.8737, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8333, dtype=torch.float64) delta_t tensor(0.0137, dtype=torch.float64)
10 gae_duplicate tensor(-0.1203, dtype=torch.float64) tensor(0.0210, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5606, dtype=torch.float64) delta_t tensor(-0.1658, dtype=torch.float64)
9 gae_duplicate tensor(-0.3650, dtype=torch.float64) tensor(3.2937, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2431, dtype=torch.float64) delta_t tensor(0.0353, dtype=torch.float64)
8 gae_duplicate tensor(-0.1367, dtype=torch.float64) tensor(-0.3699, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0435, dtype=torch.float64) delta_t tensor(-0.1886, dtype=torch.float64)
7 gae_duplicate tensor(-0.3203, dtype=torch.float64) tensor(3.6973, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2838, dtype=torch.float64) delta_t tensor(0.7992, dtype=torch.float64)
6 gae_duplicate tensor(0.5434, dtype=torch.float64) tensor(-15.4161, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8323, dtype=torch.float64) delta_t tensor(0.7232, dtype=torch.float64)
5 gae_duplicate tensor(0.5831, dtype=torch.float64) tensor(-15.8290, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8866, dtype=torch.float64) delta_t tensor(-0.2259, dtype=torch.float64)
4 gae_duplicate tensor(-0.4697, dtype=torch.float64) tensor(2.9116, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6212, dtype=torch.float64) delta_t tensor(0.4471, dtype=torch.float64)
3 gae_duplicate tensor(0.1917, dtype=torch.float64) tensor(-8.5957, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4169, dtype=torch.float64) delta_t tensor(0.1847, dtype=torch.float64)
2 gae_duplicate tensor(-0.1028, dtype=torch.float64) tensor(-4.4987, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-506.35357666015625
value loss:21.392715454101562
entropies:355.9250183105469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.820290803909302 seconds
19 rew tensor(0.8204, dtype=torch.float64) delta_t tensor(-0.2914, dtype=torch.float64)
19 gae_duplicate tensor(-0.3013, dtype=torch.float64) tensor(5.7638, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8218, dtype=torch.float64) delta_t tensor(-0.1753, dtype=torch.float64)
18 gae_duplicate tensor(-0.2179, dtype=torch.float64) tensor(4.0428, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8233, dtype=torch.float64) delta_t tensor(-0.1837, dtype=torch.float64)
17 gae_duplicate tensor(-0.2258, dtype=torch.float64) tensor(4.0428, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8039, dtype=torch.float64) delta_t tensor(-0.2090, dtype=torch.float64)
16 gae_duplicate tensor(-0.2593, dtype=torch.float64) tensor(4.5272, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8053, dtype=torch.float64) delta_t tensor(-0.2134, dtype=torch.float64)
15 gae_duplicate tensor(-0.2720, dtype=torch.float64) tensor(4.6795, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8275, dtype=torch.float64) delta_t tensor(-0.1901, dtype=torch.float64)
14 gae_duplicate tensor(-0.2314, dtype=torch.float64) tensor(4.2380, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8290, dtype=torch.float64) delta_t tensor(-0.1809, dtype=torch.float64)
13 gae_duplicate tensor(-0.2361, dtype=torch.float64) tensor(4.0039, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8201, dtype=torch.float64) delta_t tensor(-0.1671, dtype=torch.float64)
12 gae_duplicate tensor(-0.2184, dtype=torch.float64) tensor(3.6976, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8112, dtype=torch.float64) delta_t tensor(-0.1506, dtype=torch.float64)
11 gae_duplicate tensor(-0.2650, dtype=torch.float64) tensor(3.3384, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6047, dtype=torch.float64) delta_t tensor(-0.2247, dtype=torch.float64)
10 gae_duplicate tensor(-1.3805, dtype=torch.float64) tensor(4.7732, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2463, dtype=torch.float64) delta_t tensor(-0.4696, dtype=torch.float64)
9 gae_duplicate tensor(-1.6551, dtype=torch.float64) tensor(9.7935, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2330, dtype=torch.float64) delta_t tensor(0.0023, dtype=torch.float64)
8 gae_duplicate tensor(-0.3072, dtype=torch.float64) tensor(0.9300, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0602, dtype=torch.float64) delta_t tensor(-0.1884, dtype=torch.float64)
7 gae_duplicate tensor(-0.3866, dtype=torch.float64) tensor(3.8176, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4478, dtype=torch.float64) delta_t tensor(0.2754, dtype=torch.float64)
6 gae_duplicate tensor(-0.5684, dtype=torch.float64) tensor(-5.0646, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0056, dtype=torch.float64) delta_t tensor(0.4673, dtype=torch.float64)
5 gae_duplicate tensor(0.1232, dtype=torch.float64) tensor(-9.8060, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9242, dtype=torch.float64) delta_t tensor(-0.2295, dtype=torch.float64)
4 gae_duplicate tensor(-0.4069, dtype=torch.float64) tensor(3.5679, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.0557, dtype=torch.float64) delta_t tensor(0.1639, dtype=torch.float64)
3 gae_duplicate tensor(-0.1636, dtype=torch.float64) tensor(-2.9003, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7514, dtype=torch.float64) delta_t tensor(0.0106, dtype=torch.float64)
2 gae_duplicate tensor(-0.2473, dtype=torch.float64) tensor(-0.4905, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2415.65771484375
value loss:19.61655044555664
entropies:355.9275207519531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.79777193069458 seconds
19 rew tensor(0.8202, dtype=torch.float64) delta_t tensor(-0.1630, dtype=torch.float64)
19 gae_duplicate tensor(-0.1888, dtype=torch.float64) tensor(3.2220, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8215, dtype=torch.float64) delta_t tensor(-0.0580, dtype=torch.float64)
18 gae_duplicate tensor(-0.1059, dtype=torch.float64) tensor(1.4716, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8229, dtype=torch.float64) delta_t tensor(-0.0518, dtype=torch.float64)
17 gae_duplicate tensor(-0.1060, dtype=torch.float64) tensor(1.1738, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8243, dtype=torch.float64) delta_t tensor(-0.0565, dtype=torch.float64)
16 gae_duplicate tensor(-0.0976, dtype=torch.float64) tensor(1.2396, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8257, dtype=torch.float64) delta_t tensor(-0.0576, dtype=torch.float64)
15 gae_duplicate tensor(-0.1027, dtype=torch.float64) tensor(1.2681, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8271, dtype=torch.float64) delta_t tensor(-0.0553, dtype=torch.float64)
14 gae_duplicate tensor(-0.1012, dtype=torch.float64) tensor(1.2144, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8285, dtype=torch.float64) delta_t tensor(-0.0369, dtype=torch.float64)
13 gae_duplicate tensor(-0.0922, dtype=torch.float64) tensor(0.8529, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8299, dtype=torch.float64) delta_t tensor(-0.0224, dtype=torch.float64)
12 gae_duplicate tensor(-0.0709, dtype=torch.float64) tensor(0.5297, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8314, dtype=torch.float64) delta_t tensor(0.0396, dtype=torch.float64)
11 gae_duplicate tensor(-0.0263, dtype=torch.float64) tensor(-0.7354, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8328, dtype=torch.float64) delta_t tensor(0.1790, dtype=torch.float64)
10 gae_duplicate tensor(0.1100, dtype=torch.float64) tensor(-3.6213, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3718, dtype=torch.float64) delta_t tensor(-0.1898, dtype=torch.float64)
9 gae_duplicate tensor(-0.3769, dtype=torch.float64) tensor(3.3734, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2034, dtype=torch.float64) delta_t tensor(0.1324, dtype=torch.float64)
8 gae_duplicate tensor(-0.2236, dtype=torch.float64) tensor(-2.2922, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0281, dtype=torch.float64) delta_t tensor(-0.0856, dtype=torch.float64)
7 gae_duplicate tensor(-0.2788, dtype=torch.float64) tensor(1.4672, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2913, dtype=torch.float64) delta_t tensor(0.5062, dtype=torch.float64)
6 gae_duplicate tensor(0.1919, dtype=torch.float64) tensor(-9.8885, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8683, dtype=torch.float64) delta_t tensor(0.7251, dtype=torch.float64)
5 gae_duplicate tensor(0.5898, dtype=torch.float64) tensor(-15.3609, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8964, dtype=torch.float64) delta_t tensor(-0.1549, dtype=torch.float64)
4 gae_duplicate tensor(-0.4046, dtype=torch.float64) tensor(1.5186, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8406, dtype=torch.float64) delta_t tensor(0.3390, dtype=torch.float64)
3 gae_duplicate tensor(0.1116, dtype=torch.float64) tensor(-6.5774, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5963, dtype=torch.float64) delta_t tensor(0.2385, dtype=torch.float64)
2 gae_duplicate tensor(0.0508, dtype=torch.float64) tensor(-5.3683, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1335.589111328125
value loss:13.801933288574219
entropies:355.9248046875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3951.1655)
ToM Target loss= tensor(3546.6694)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.975359916687012 seconds
19 rew tensor(0.8197, dtype=torch.float64) delta_t tensor(-0.0761, dtype=torch.float64)
19 gae_duplicate tensor(-0.1000, dtype=torch.float64) tensor(1.5053, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8210, dtype=torch.float64) delta_t tensor(0.0129, dtype=torch.float64)
18 gae_duplicate tensor(-0.0092, dtype=torch.float64) tensor(-0.1040, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8223, dtype=torch.float64) delta_t tensor(0.0509, dtype=torch.float64)
17 gae_duplicate tensor(0.0077, dtype=torch.float64) tensor(-1.0163, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(0.0061, dtype=torch.float64)
16 gae_duplicate tensor(-0.0325, dtype=torch.float64) tensor(-0.2204, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.0211, dtype=torch.float64)
15 gae_duplicate tensor(-0.0373, dtype=torch.float64) tensor(-0.4383, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8263, dtype=torch.float64) delta_t tensor(0.0325, dtype=torch.float64)
14 gae_duplicate tensor(-0.0157, dtype=torch.float64) tensor(-0.6828, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8276, dtype=torch.float64) delta_t tensor(0.0378, dtype=torch.float64)
13 gae_duplicate tensor(-0.0349, dtype=torch.float64) tensor(-0.8131, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8290, dtype=torch.float64) delta_t tensor(0.0687, dtype=torch.float64)
12 gae_duplicate tensor(0.0034, dtype=torch.float64) tensor(-1.4401, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8303, dtype=torch.float64) delta_t tensor(0.1225, dtype=torch.float64)
11 gae_duplicate tensor(-0.0035, dtype=torch.float64) tensor(-2.5644, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8103, dtype=torch.float64) delta_t tensor(0.2418, dtype=torch.float64)
10 gae_duplicate tensor(0.0917, dtype=torch.float64) tensor(-5.0400, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4746, dtype=torch.float64) delta_t tensor(-0.0117, dtype=torch.float64)
9 gae_duplicate tensor(-0.0687, dtype=torch.float64) tensor(-0.2712, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2437, dtype=torch.float64) delta_t tensor(0.2719, dtype=torch.float64)
8 gae_duplicate tensor(0.0455, dtype=torch.float64) tensor(-5.4156, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0127, dtype=torch.float64) delta_t tensor(0.0895, dtype=torch.float64)
7 gae_duplicate tensor(-0.1382, dtype=torch.float64) tensor(-2.3152, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2710, dtype=torch.float64) delta_t tensor(0.7238, dtype=torch.float64)
6 gae_duplicate tensor(-0.3126, dtype=torch.float64) tensor(-14.5190, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8064, dtype=torch.float64) delta_t tensor(0.8668, dtype=torch.float64)
5 gae_duplicate tensor(0.5246, dtype=torch.float64) tensor(-18.6155, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8361, dtype=torch.float64) delta_t tensor(-0.0653, dtype=torch.float64)
4 gae_duplicate tensor(-0.2730, dtype=torch.float64) tensor(-0.5666, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7624, dtype=torch.float64) delta_t tensor(0.4501, dtype=torch.float64)
3 gae_duplicate tensor(-0.0582, dtype=torch.float64) tensor(-8.9843, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5599, dtype=torch.float64) delta_t tensor(0.3114, dtype=torch.float64)
2 gae_duplicate tensor(-0.2440, dtype=torch.float64) tensor(-7.0315, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3604.689453125
value loss:22.60247802734375
entropies:355.9410400390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.276111125946045 seconds
19 rew tensor(0.8190, dtype=torch.float64) delta_t tensor(-0.0285, dtype=torch.float64)
19 gae_duplicate tensor(-0.0605, dtype=torch.float64) tensor(0.5630, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8203, dtype=torch.float64) delta_t tensor(0.0672, dtype=torch.float64)
18 gae_duplicate tensor(0.0273, dtype=torch.float64) tensor(-1.2720, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8216, dtype=torch.float64) delta_t tensor(0.0935, dtype=torch.float64)
17 gae_duplicate tensor(0.0607, dtype=torch.float64) tensor(-1.9769, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8228, dtype=torch.float64) delta_t tensor(0.0758, dtype=torch.float64)
16 gae_duplicate tensor(0.0648, dtype=torch.float64) tensor(-1.6949, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8241, dtype=torch.float64) delta_t tensor(0.0871, dtype=torch.float64)
15 gae_duplicate tensor(0.0656, dtype=torch.float64) tensor(-1.8935, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8254, dtype=torch.float64) delta_t tensor(0.0712, dtype=torch.float64)
14 gae_duplicate tensor(0.0671, dtype=torch.float64) tensor(-1.5969, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8267, dtype=torch.float64) delta_t tensor(0.0823, dtype=torch.float64)
13 gae_duplicate tensor(0.0627, dtype=torch.float64) tensor(-1.7871, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8280, dtype=torch.float64) delta_t tensor(0.1143, dtype=torch.float64)
12 gae_duplicate tensor(0.0671, dtype=torch.float64) tensor(-2.4386, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8293, dtype=torch.float64) delta_t tensor(0.1869, dtype=torch.float64)
11 gae_duplicate tensor(0.1266, dtype=torch.float64) tensor(-3.9387, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8307, dtype=torch.float64) delta_t tensor(0.2927, dtype=torch.float64)
10 gae_duplicate tensor(0.1841, dtype=torch.float64) tensor(-6.1841, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4428, dtype=torch.float64) delta_t tensor(0.0310, dtype=torch.float64)
9 gae_duplicate tensor(-0.1087, dtype=torch.float64) tensor(-1.2310, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2435, dtype=torch.float64) delta_t tensor(0.3763, dtype=torch.float64)
8 gae_duplicate tensor(0.0006, dtype=torch.float64) tensor(-7.5678, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0020, dtype=torch.float64) delta_t tensor(0.1414, dtype=torch.float64)
7 gae_duplicate tensor(-0.0763, dtype=torch.float64) tensor(-3.5496, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2496, dtype=torch.float64) delta_t tensor(0.6859, dtype=torch.float64)
6 gae_duplicate tensor(0.2443, dtype=torch.float64) tensor(-13.9191, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8061, dtype=torch.float64) delta_t tensor(0.8575, dtype=torch.float64)
5 gae_duplicate tensor(0.7176, dtype=torch.float64) tensor(-18.3559, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9817, dtype=torch.float64) delta_t tensor(-0.1757, dtype=torch.float64)
4 gae_duplicate tensor(-0.5111, dtype=torch.float64) tensor(1.6347, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8663, dtype=torch.float64) delta_t tensor(0.3871, dtype=torch.float64)
3 gae_duplicate tensor(0.1256, dtype=torch.float64) tensor(-7.5113, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6214, dtype=torch.float64) delta_t tensor(0.3018, dtype=torch.float64)
2 gae_duplicate tensor(0.0503, dtype=torch.float64) tensor(-6.7129, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4193.2568359375
value loss:22.105525970458984
entropies:355.94903564453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.658211946487427 seconds
19 rew tensor(0.8186, dtype=torch.float64) delta_t tensor(-0.0140, dtype=torch.float64)
19 gae_duplicate tensor(-0.0571, dtype=torch.float64) tensor(0.2771, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8199, dtype=torch.float64) delta_t tensor(0.0775, dtype=torch.float64)
18 gae_duplicate tensor(0.0470, dtype=torch.float64) tensor(-1.5048, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8211, dtype=torch.float64) delta_t tensor(0.1195, dtype=torch.float64)
17 gae_duplicate tensor(0.1041, dtype=torch.float64) tensor(-2.5163, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8117, dtype=torch.float64) delta_t tensor(0.0795, dtype=torch.float64)
16 gae_duplicate tensor(0.0698, dtype=torch.float64) tensor(-1.8267, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(0.0859, dtype=torch.float64)
15 gae_duplicate tensor(0.0629, dtype=torch.float64) tensor(-1.8868, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8247, dtype=torch.float64) delta_t tensor(0.1003, dtype=torch.float64)
14 gae_duplicate tensor(0.0654, dtype=torch.float64) tensor(-2.1728, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8260, dtype=torch.float64) delta_t tensor(0.1073, dtype=torch.float64)
13 gae_duplicate tensor(0.0864, dtype=torch.float64) tensor(-2.3288, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8272, dtype=torch.float64) delta_t tensor(0.1447, dtype=torch.float64)
12 gae_duplicate tensor(0.0761, dtype=torch.float64) tensor(-3.0885, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8285, dtype=torch.float64) delta_t tensor(0.1767, dtype=torch.float64)
11 gae_duplicate tensor(0.0322, dtype=torch.float64) tensor(-3.8135, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8298, dtype=torch.float64) delta_t tensor(0.2778, dtype=torch.float64)
10 gae_duplicate tensor(0.0860, dtype=torch.float64) tensor(-5.8796, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4943, dtype=torch.float64) delta_t tensor(0.0775, dtype=torch.float64)
9 gae_duplicate tensor(-0.2869, dtype=torch.float64) tensor(-2.1157, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1893, dtype=torch.float64) delta_t tensor(0.2953, dtype=torch.float64)
8 gae_duplicate tensor(-0.1635, dtype=torch.float64) tensor(-6.0507, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0208, dtype=torch.float64) delta_t tensor(0.1952, dtype=torch.float64)
7 gae_duplicate tensor(-0.1420, dtype=torch.float64) tensor(-4.4547, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2319, dtype=torch.float64) delta_t tensor(0.6709, dtype=torch.float64)
6 gae_duplicate tensor(-0.1967, dtype=torch.float64) tensor(-13.7335, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7887, dtype=torch.float64) delta_t tensor(0.8423, dtype=torch.float64)
5 gae_duplicate tensor(0.2949, dtype=torch.float64) tensor(-18.0451, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8200, dtype=torch.float64) delta_t tensor(-0.0637, dtype=torch.float64)
4 gae_duplicate tensor(-0.1824, dtype=torch.float64) tensor(-0.5453, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6597, dtype=torch.float64) delta_t tensor(0.5120, dtype=torch.float64)
3 gae_duplicate tensor(-0.0617, dtype=torch.float64) tensor(-10.1740, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4131, dtype=torch.float64) delta_t tensor(0.3048, dtype=torch.float64)
2 gae_duplicate tensor(-0.0810, dtype=torch.float64) tensor(-7.0488, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4596.9453125
value loss:25.182327270507812
entropies:355.9419860839844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.908496856689453 seconds
19 rew tensor(0.8188, dtype=torch.float64) delta_t tensor(-0.0630, dtype=torch.float64)
19 gae_duplicate tensor(-0.1044, dtype=torch.float64) tensor(1.2499, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8200, dtype=torch.float64) delta_t tensor(0.0260, dtype=torch.float64)
18 gae_duplicate tensor(-0.0012, dtype=torch.float64) tensor(-0.3898, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8211, dtype=torch.float64) delta_t tensor(0.0615, dtype=torch.float64)
17 gae_duplicate tensor(0.0120, dtype=torch.float64) tensor(-1.2562, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8223, dtype=torch.float64) delta_t tensor(0.0318, dtype=torch.float64)
16 gae_duplicate tensor(-0.0244, dtype=torch.float64) tensor(-0.7497, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8235, dtype=torch.float64) delta_t tensor(0.0403, dtype=torch.float64)
15 gae_duplicate tensor(-0.0183, dtype=torch.float64) tensor(-0.8691, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8247, dtype=torch.float64) delta_t tensor(0.0434, dtype=torch.float64)
14 gae_duplicate tensor(-0.0186, dtype=torch.float64) tensor(-0.9435, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8259, dtype=torch.float64) delta_t tensor(0.0367, dtype=torch.float64)
13 gae_duplicate tensor(-0.0036, dtype=torch.float64) tensor(-0.8187, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8272, dtype=torch.float64) delta_t tensor(0.0571, dtype=torch.float64)
12 gae_duplicate tensor(0.0247, dtype=torch.float64) tensor(-1.2080, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8284, dtype=torch.float64) delta_t tensor(0.1228, dtype=torch.float64)
11 gae_duplicate tensor(0.0411, dtype=torch.float64) tensor(-2.5496, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8296, dtype=torch.float64) delta_t tensor(0.3046, dtype=torch.float64)
10 gae_duplicate tensor(0.2237, dtype=torch.float64) tensor(-6.2828, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3465, dtype=torch.float64) delta_t tensor(-0.1295, dtype=torch.float64)
9 gae_duplicate tensor(-0.3474, dtype=torch.float64) tensor(1.9432, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1683, dtype=torch.float64) delta_t tensor(0.2515, dtype=torch.float64)
8 gae_duplicate tensor(0.0428, dtype=torch.float64) tensor(-4.7749, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0213, dtype=torch.float64) delta_t tensor(0.0799, dtype=torch.float64)
7 gae_duplicate tensor(-0.0593, dtype=torch.float64) tensor(-2.0678, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3888, dtype=torch.float64) delta_t tensor(0.5221, dtype=torch.float64)
6 gae_duplicate tensor(0.0712, dtype=torch.float64) tensor(-10.5655, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9132, dtype=torch.float64) delta_t tensor(0.6293, dtype=torch.float64)
5 gae_duplicate tensor(0.4292, dtype=torch.float64) tensor(-13.5152, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9830, dtype=torch.float64) delta_t tensor(-0.2499, dtype=torch.float64)
4 gae_duplicate tensor(-0.4979, dtype=torch.float64) tensor(3.5922, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8871, dtype=torch.float64) delta_t tensor(0.3018, dtype=torch.float64)
3 gae_duplicate tensor(-0.0216, dtype=torch.float64) tensor(-5.5934, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6520, dtype=torch.float64) delta_t tensor(0.0929, dtype=torch.float64)
2 gae_duplicate tensor(-0.5582, dtype=torch.float64) tensor(-2.3918, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2452.19921875
value loss:13.21681022644043
entropies:355.9291687011719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.659496784210205 seconds
19 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(-0.0923, dtype=torch.float64)
19 gae_duplicate tensor(-0.1589, dtype=torch.float64) tensor(1.8282, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8202, dtype=torch.float64) delta_t tensor(-0.0037, dtype=torch.float64)
18 gae_duplicate tensor(-0.0776, dtype=torch.float64) tensor(0.2539, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8214, dtype=torch.float64) delta_t tensor(0.0195, dtype=torch.float64)
17 gae_duplicate tensor(-0.0878, dtype=torch.float64) tensor(-0.3537, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8225, dtype=torch.float64) delta_t tensor(0.0160, dtype=torch.float64)
16 gae_duplicate tensor(-0.0710, dtype=torch.float64) tensor(-0.3522, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8237, dtype=torch.float64) delta_t tensor(0.0039, dtype=torch.float64)
15 gae_duplicate tensor(-0.0873, dtype=torch.float64) tensor(-0.1136, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8248, dtype=torch.float64) delta_t tensor(0.0037, dtype=torch.float64)
14 gae_duplicate tensor(-0.0861, dtype=torch.float64) tensor(-0.0862, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8260, dtype=torch.float64) delta_t tensor(0.0224, dtype=torch.float64)
13 gae_duplicate tensor(-0.0694, dtype=torch.float64) tensor(-0.4540, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8272, dtype=torch.float64) delta_t tensor(0.0318, dtype=torch.float64)
12 gae_duplicate tensor(-0.0552, dtype=torch.float64) tensor(-0.6779, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8283, dtype=torch.float64) delta_t tensor(0.1093, dtype=torch.float64)
11 gae_duplicate tensor(0.0075, dtype=torch.float64) tensor(-2.2341, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8295, dtype=torch.float64) delta_t tensor(0.2201, dtype=torch.float64)
10 gae_duplicate tensor(0.1187, dtype=torch.float64) tensor(-4.5868, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3364, dtype=torch.float64) delta_t tensor(-0.1626, dtype=torch.float64)
9 gae_duplicate tensor(-0.3211, dtype=torch.float64) tensor(2.7612, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1578, dtype=torch.float64) delta_t tensor(0.2433, dtype=torch.float64)
8 gae_duplicate tensor(0.0568, dtype=torch.float64) tensor(-4.5431, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1265, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
7 gae_duplicate tensor(-0.1796, dtype=torch.float64) tensor(-0.5739, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3997, dtype=torch.float64) delta_t tensor(0.2975, dtype=torch.float64)
6 gae_duplicate tensor(-0.0861, dtype=torch.float64) tensor(-5.9555, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9347, dtype=torch.float64) delta_t tensor(0.5558, dtype=torch.float64)
5 gae_duplicate tensor(0.3621, dtype=torch.float64) tensor(-11.5632, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9612, dtype=torch.float64) delta_t tensor(-0.3185, dtype=torch.float64)
4 gae_duplicate tensor(-0.6044, dtype=torch.float64) tensor(5.1076, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8436, dtype=torch.float64) delta_t tensor(0.2320, dtype=torch.float64)
3 gae_duplicate tensor(-0.0381, dtype=torch.float64) tensor(-4.0694, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5340, dtype=torch.float64) delta_t tensor(0.0734, dtype=torch.float64)
2 gae_duplicate tensor(-0.2549, dtype=torch.float64) tensor(-1.8735, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1388.1556396484375
value loss:9.185773849487305
entropies:355.92254638671875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3960.6196)
ToM Target loss= tensor(3557.0898)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.795082092285156 seconds
19 rew tensor(0.8189, dtype=torch.float64) delta_t tensor(-0.1875, dtype=torch.float64)
19 gae_duplicate tensor(-0.2356, dtype=torch.float64) tensor(3.7177, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8200, dtype=torch.float64) delta_t tensor(-0.0805, dtype=torch.float64)
18 gae_duplicate tensor(-0.1432, dtype=torch.float64) tensor(1.9684, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8211, dtype=torch.float64) delta_t tensor(-0.0745, dtype=torch.float64)
17 gae_duplicate tensor(-0.1562, dtype=torch.float64) tensor(1.6688, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8222, dtype=torch.float64) delta_t tensor(-0.0952, dtype=torch.float64)
16 gae_duplicate tensor(-0.1671, dtype=torch.float64) tensor(2.0459, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8234, dtype=torch.float64) delta_t tensor(-0.0959, dtype=torch.float64)
15 gae_duplicate tensor(-0.1764, dtype=torch.float64) tensor(2.1012, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8245, dtype=torch.float64) delta_t tensor(-0.0971, dtype=torch.float64)
14 gae_duplicate tensor(-0.1752, dtype=torch.float64) tensor(2.1244, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8256, dtype=torch.float64) delta_t tensor(-0.0803, dtype=torch.float64)
13 gae_duplicate tensor(-0.1504, dtype=torch.float64) tensor(1.8030, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8267, dtype=torch.float64) delta_t tensor(-0.0680, dtype=torch.float64)
12 gae_duplicate tensor(-0.1432, dtype=torch.float64) tensor(1.5251, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8279, dtype=torch.float64) delta_t tensor(-0.0024, dtype=torch.float64)
11 gae_duplicate tensor(-0.1019, dtype=torch.float64) tensor(0.2027, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8290, dtype=torch.float64) delta_t tensor(0.1444, dtype=torch.float64)
10 gae_duplicate tensor(0.0040, dtype=torch.float64) tensor(-2.8329, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3468, dtype=torch.float64) delta_t tensor(-0.2886, dtype=torch.float64)
9 gae_duplicate tensor(-0.3937, dtype=torch.float64) tensor(5.4292, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2323, dtype=torch.float64) delta_t tensor(0.1433, dtype=torch.float64)
8 gae_duplicate tensor(-0.1011, dtype=torch.float64) tensor(-2.2941, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0541, dtype=torch.float64) delta_t tensor(-0.0530, dtype=torch.float64)
7 gae_duplicate tensor(-0.1810, dtype=torch.float64) tensor(0.8211, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2297, dtype=torch.float64) delta_t tensor(0.2008, dtype=torch.float64)
6 gae_duplicate tensor(-0.1385, dtype=torch.float64) tensor(-3.8964, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8277, dtype=torch.float64) delta_t tensor(0.5378, dtype=torch.float64)
5 gae_duplicate tensor(0.2617, dtype=torch.float64) tensor(-11.0139, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8771, dtype=torch.float64) delta_t tensor(-0.2573, dtype=torch.float64)
4 gae_duplicate tensor(-0.3672, dtype=torch.float64) tensor(3.9787, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8009, dtype=torch.float64) delta_t tensor(0.2714, dtype=torch.float64)
3 gae_duplicate tensor(0.0133, dtype=torch.float64) tensor(-4.9580, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6182, dtype=torch.float64) delta_t tensor(0.1220, dtype=torch.float64)
2 gae_duplicate tensor(-0.0056, dtype=torch.float64) tensor(-2.9047, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-68.36235046386719
value loss:8.289883613586426
entropies:355.9256896972656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.951422214508057 seconds
19 rew tensor(0.8184, dtype=torch.float64) delta_t tensor(-0.2265, dtype=torch.float64)
19 gae_duplicate tensor(-0.2843, dtype=torch.float64) tensor(4.4747, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8195, dtype=torch.float64) delta_t tensor(-0.1226, dtype=torch.float64)
18 gae_duplicate tensor(-0.1877, dtype=torch.float64) tensor(2.8853, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8206, dtype=torch.float64) delta_t tensor(-0.1046, dtype=torch.float64)
17 gae_duplicate tensor(-0.1894, dtype=torch.float64) tensor(2.3562, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8113, dtype=torch.float64) delta_t tensor(-0.1383, dtype=torch.float64)
16 gae_duplicate tensor(-0.2139, dtype=torch.float64) tensor(2.9862, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8123, dtype=torch.float64) delta_t tensor(-0.1311, dtype=torch.float64)
15 gae_duplicate tensor(-0.2150, dtype=torch.float64) tensor(2.8945, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8238, dtype=torch.float64) delta_t tensor(-0.1319, dtype=torch.float64)
14 gae_duplicate tensor(-0.2284, dtype=torch.float64) tensor(2.8873, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8249, dtype=torch.float64) delta_t tensor(-0.1230, dtype=torch.float64)
13 gae_duplicate tensor(-0.2286, dtype=torch.float64) tensor(2.7146, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8260, dtype=torch.float64) delta_t tensor(-0.1187, dtype=torch.float64)
12 gae_duplicate tensor(-0.1961, dtype=torch.float64) tensor(2.6141, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8271, dtype=torch.float64) delta_t tensor(-0.0468, dtype=torch.float64)
11 gae_duplicate tensor(-0.1441, dtype=torch.float64) tensor(1.1926, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8282, dtype=torch.float64) delta_t tensor(0.0071, dtype=torch.float64)
10 gae_duplicate tensor(-0.0590, dtype=torch.float64) tensor(-0.0231, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4931, dtype=torch.float64) delta_t tensor(-0.1468, dtype=torch.float64)
9 gae_duplicate tensor(-0.3132, dtype=torch.float64) tensor(2.9132, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2427, dtype=torch.float64) delta_t tensor(0.3185, dtype=torch.float64)
8 gae_duplicate tensor(0.1399, dtype=torch.float64) tensor(-6.0099, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0923, dtype=torch.float64) delta_t tensor(-0.1334, dtype=torch.float64)
7 gae_duplicate tensor(-0.1965, dtype=torch.float64) tensor(2.0230, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3750, dtype=torch.float64) delta_t tensor(0.4269, dtype=torch.float64)
6 gae_duplicate tensor(0.2405, dtype=torch.float64) tensor(-8.2425, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9510, dtype=torch.float64) delta_t tensor(0.4449, dtype=torch.float64)
5 gae_duplicate tensor(0.2585, dtype=torch.float64) tensor(-9.6277, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1443, dtype=torch.float64) delta_t tensor(-0.6137, dtype=torch.float64)
4 gae_duplicate tensor(-1.1684, dtype=torch.float64) tensor(11.1296, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9243, dtype=torch.float64) delta_t tensor(0.0323, dtype=torch.float64)
3 gae_duplicate tensor(-0.4555, dtype=torch.float64) tensor(0.4839, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5954, dtype=torch.float64) delta_t tensor(0.0774, dtype=torch.float64)
2 gae_duplicate tensor(-0.2534, dtype=torch.float64) tensor(-1.4882, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-968.9517822265625
value loss:12.39598560333252
entropies:355.92718505859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.90104603767395 seconds
19 rew tensor(0.8178, dtype=torch.float64) delta_t tensor(-0.2292, dtype=torch.float64)
19 gae_duplicate tensor(-0.3146, dtype=torch.float64) tensor(4.5355, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8188, dtype=torch.float64) delta_t tensor(-0.1442, dtype=torch.float64)
18 gae_duplicate tensor(-0.2287, dtype=torch.float64) tensor(3.2948, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8199, dtype=torch.float64) delta_t tensor(-0.1173, dtype=torch.float64)
17 gae_duplicate tensor(-0.2431, dtype=torch.float64) tensor(2.6433, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8209, dtype=torch.float64) delta_t tensor(-0.1400, dtype=torch.float64)
16 gae_duplicate tensor(-0.2482, dtype=torch.float64) tensor(3.0273, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8220, dtype=torch.float64) delta_t tensor(-0.1263, dtype=torch.float64)
15 gae_duplicate tensor(-0.2473, dtype=torch.float64) tensor(2.7934, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8230, dtype=torch.float64) delta_t tensor(-0.1280, dtype=torch.float64)
14 gae_duplicate tensor(-0.2452, dtype=torch.float64) tensor(2.8245, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8241, dtype=torch.float64) delta_t tensor(-0.1327, dtype=torch.float64)
13 gae_duplicate tensor(-0.2531, dtype=torch.float64) tensor(2.8973, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8251, dtype=torch.float64) delta_t tensor(-0.1473, dtype=torch.float64)
12 gae_duplicate tensor(-0.2313, dtype=torch.float64) tensor(3.2051, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8262, dtype=torch.float64) delta_t tensor(-0.1148, dtype=torch.float64)
11 gae_duplicate tensor(-0.2233, dtype=torch.float64) tensor(2.5875, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8273, dtype=torch.float64) delta_t tensor(-0.0185, dtype=torch.float64)
10 gae_duplicate tensor(-0.1562, dtype=torch.float64) tensor(0.6274, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4926, dtype=torch.float64) delta_t tensor(-0.2460, dtype=torch.float64)
9 gae_duplicate tensor(-0.4676, dtype=torch.float64) tensor(4.9286, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2526, dtype=torch.float64) delta_t tensor(0.0864, dtype=torch.float64)
8 gae_duplicate tensor(-0.3909, dtype=torch.float64) tensor(-1.2167, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0022, dtype=torch.float64) delta_t tensor(-0.0966, dtype=torch.float64)
7 gae_duplicate tensor(-0.2706, dtype=torch.float64) tensor(1.7860, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3005, dtype=torch.float64) delta_t tensor(-0.0029, dtype=torch.float64)
6 gae_duplicate tensor(-0.4312, dtype=torch.float64) tensor(0.2413, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7712, dtype=torch.float64) delta_t tensor(0.4282, dtype=torch.float64)
5 gae_duplicate tensor(-0.0678, dtype=torch.float64) tensor(-8.4514, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8527, dtype=torch.float64) delta_t tensor(-0.4338, dtype=torch.float64)
4 gae_duplicate tensor(-0.6497, dtype=torch.float64) tensor(7.7295, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8788, dtype=torch.float64) delta_t tensor(0.0412, dtype=torch.float64)
3 gae_duplicate tensor(-0.5569, dtype=torch.float64) tensor(-0.0348, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6025, dtype=torch.float64) delta_t tensor(-0.0591, dtype=torch.float64)
2 gae_duplicate tensor(-0.7321, dtype=torch.float64) tensor(1.1736, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1964.0753173828125
value loss:10.731789588928223
entropies:355.9372863769531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.669642925262451 seconds
19 rew tensor(0.8177, dtype=torch.float64) delta_t tensor(-0.1722, dtype=torch.float64)
19 gae_duplicate tensor(-0.2824, dtype=torch.float64) tensor(3.3986, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8187, dtype=torch.float64) delta_t tensor(-0.0710, dtype=torch.float64)
18 gae_duplicate tensor(-0.1623, dtype=torch.float64) tensor(1.7466, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8197, dtype=torch.float64) delta_t tensor(-0.0622, dtype=torch.float64)
17 gae_duplicate tensor(-0.1989, dtype=torch.float64) tensor(1.4006, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7995, dtype=torch.float64) delta_t tensor(-0.1331, dtype=torch.float64)
16 gae_duplicate tensor(-0.2447, dtype=torch.float64) tensor(2.7725, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8005, dtype=torch.float64) delta_t tensor(-0.1256, dtype=torch.float64)
15 gae_duplicate tensor(-0.2390, dtype=torch.float64) tensor(2.7613, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8226, dtype=torch.float64) delta_t tensor(-0.1074, dtype=torch.float64)
14 gae_duplicate tensor(-0.2532, dtype=torch.float64) tensor(2.4043, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8236, dtype=torch.float64) delta_t tensor(-0.1058, dtype=torch.float64)
13 gae_duplicate tensor(-0.2529, dtype=torch.float64) tensor(2.3278, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8247, dtype=torch.float64) delta_t tensor(-0.1029, dtype=torch.float64)
12 gae_duplicate tensor(-0.2270, dtype=torch.float64) tensor(2.2578, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7945, dtype=torch.float64) delta_t tensor(-0.0681, dtype=torch.float64)
11 gae_duplicate tensor(-0.1571, dtype=torch.float64) tensor(1.5711, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8267, dtype=torch.float64) delta_t tensor(0.0030, dtype=torch.float64)
10 gae_duplicate tensor(-0.0930, dtype=torch.float64) tensor(0.0980, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4622, dtype=torch.float64) delta_t tensor(-0.1995, dtype=torch.float64)
9 gae_duplicate tensor(-0.3339, dtype=torch.float64) tensor(3.9591, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2008, dtype=torch.float64) delta_t tensor(0.0779, dtype=torch.float64)
8 gae_duplicate tensor(-0.0309, dtype=torch.float64) tensor(-1.1463, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1025, dtype=torch.float64) delta_t tensor(-0.1394, dtype=torch.float64)
7 gae_duplicate tensor(-0.2920, dtype=torch.float64) tensor(2.6471, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4793, dtype=torch.float64) delta_t tensor(-0.0659, dtype=torch.float64)
6 gae_duplicate tensor(-0.7051, dtype=torch.float64) tensor(1.5736, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0015, dtype=torch.float64) delta_t tensor(0.1721, dtype=torch.float64)
5 gae_duplicate tensor(-0.3859, dtype=torch.float64) tensor(-3.2466, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0145, dtype=torch.float64) delta_t tensor(-0.5970, dtype=torch.float64)
4 gae_duplicate tensor(-0.9559, dtype=torch.float64) tensor(11.4857, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.0252, dtype=torch.float64) delta_t tensor(-0.0996, dtype=torch.float64)
3 gae_duplicate tensor(-0.6304, dtype=torch.float64) tensor(3.1160, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7178, dtype=torch.float64) delta_t tensor(-0.1845, dtype=torch.float64)
2 gae_duplicate tensor(-0.7131, dtype=torch.float64) tensor(3.9633, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2422.981201171875
value loss:10.64640998840332
entropies:355.9469909667969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.324628829956055 seconds
19 rew tensor(0.8176, dtype=torch.float64) delta_t tensor(-0.1684, dtype=torch.float64)
19 gae_duplicate tensor(-0.2889, dtype=torch.float64) tensor(3.3294, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8186, dtype=torch.float64) delta_t tensor(-0.0374, dtype=torch.float64)
18 gae_duplicate tensor(-0.1864, dtype=torch.float64) tensor(1.0733, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8195, dtype=torch.float64) delta_t tensor(-0.0465, dtype=torch.float64)
17 gae_duplicate tensor(-0.1408, dtype=torch.float64) tensor(1.0275, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8205, dtype=torch.float64) delta_t tensor(-0.1181, dtype=torch.float64)
16 gae_duplicate tensor(-0.1987, dtype=torch.float64) tensor(2.4382, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8215, dtype=torch.float64) delta_t tensor(-0.0968, dtype=torch.float64)
15 gae_duplicate tensor(-0.1923, dtype=torch.float64) tensor(2.1596, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8225, dtype=torch.float64) delta_t tensor(-0.1162, dtype=torch.float64)
14 gae_duplicate tensor(-0.2141, dtype=torch.float64) tensor(2.5136, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8235, dtype=torch.float64) delta_t tensor(-0.0914, dtype=torch.float64)
13 gae_duplicate tensor(-0.2227, dtype=torch.float64) tensor(2.0585, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8245, dtype=torch.float64) delta_t tensor(-0.0957, dtype=torch.float64)
12 gae_duplicate tensor(-0.1925, dtype=torch.float64) tensor(2.0963, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8255, dtype=torch.float64) delta_t tensor(-0.0504, dtype=torch.float64)
11 gae_duplicate tensor(-0.1739, dtype=torch.float64) tensor(1.2054, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8265, dtype=torch.float64) delta_t tensor(0.0368, dtype=torch.float64)
10 gae_duplicate tensor(-0.0936, dtype=torch.float64) tensor(-0.6057, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4503, dtype=torch.float64) delta_t tensor(-0.1939, dtype=torch.float64)
9 gae_duplicate tensor(-0.3297, dtype=torch.float64) tensor(3.7716, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2203, dtype=torch.float64) delta_t tensor(0.1614, dtype=torch.float64)
8 gae_duplicate tensor(0.0341, dtype=torch.float64) tensor(-2.8122, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0307, dtype=torch.float64) delta_t tensor(-0.1073, dtype=torch.float64)
7 gae_duplicate tensor(-0.2105, dtype=torch.float64) tensor(1.8435, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3128, dtype=torch.float64) delta_t tensor(0.1437, dtype=torch.float64)
6 gae_duplicate tensor(-0.2410, dtype=torch.float64) tensor(-2.6582, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8254, dtype=torch.float64) delta_t tensor(0.3748, dtype=torch.float64)
5 gae_duplicate tensor(0.0140, dtype=torch.float64) tensor(-7.6806, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9139, dtype=torch.float64) delta_t tensor(-0.5220, dtype=torch.float64)
4 gae_duplicate tensor(-0.8016, dtype=torch.float64) tensor(9.5525, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6904, dtype=torch.float64) delta_t tensor(0.0729, dtype=torch.float64)
3 gae_duplicate tensor(-0.1781, dtype=torch.float64) tensor(-0.4874, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4437, dtype=torch.float64) delta_t tensor(-0.0098, dtype=torch.float64)
2 gae_duplicate tensor(-0.1778, dtype=torch.float64) tensor(0.1458, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1120.537841796875
value loss:7.278118133544922
entropies:355.94891357421875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3957.3130)
ToM Target loss= tensor(3589.8352)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.979585886001587 seconds
19 rew tensor(0.8180, dtype=torch.float64) delta_t tensor(-0.1972, dtype=torch.float64)
19 gae_duplicate tensor(-0.2746, dtype=torch.float64) tensor(3.9005, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8190, dtype=torch.float64) delta_t tensor(0.0286, dtype=torch.float64)
18 gae_duplicate tensor(-0.1128, dtype=torch.float64) tensor(-0.1758, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8199, dtype=torch.float64) delta_t tensor(-0.0102, dtype=torch.float64)
17 gae_duplicate tensor(-0.0819, dtype=torch.float64) tensor(0.1839, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8209, dtype=torch.float64) delta_t tensor(-0.1040, dtype=torch.float64)
16 gae_duplicate tensor(-0.1673, dtype=torch.float64) tensor(2.0743, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8218, dtype=torch.float64) delta_t tensor(-0.0749, dtype=torch.float64)
15 gae_duplicate tensor(-0.1572, dtype=torch.float64) tensor(1.6881, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8228, dtype=torch.float64) delta_t tensor(-0.1188, dtype=torch.float64)
14 gae_duplicate tensor(-0.1871, dtype=torch.float64) tensor(2.5194, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8238, dtype=torch.float64) delta_t tensor(-0.1093, dtype=torch.float64)
13 gae_duplicate tensor(-0.1809, dtype=torch.float64) tensor(2.4136, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8247, dtype=torch.float64) delta_t tensor(-0.0881, dtype=torch.float64)
12 gae_duplicate tensor(-0.1507, dtype=torch.float64) tensor(1.9840, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8257, dtype=torch.float64) delta_t tensor(-0.0496, dtype=torch.float64)
11 gae_duplicate tensor(-0.1217, dtype=torch.float64) tensor(1.1801, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8267, dtype=torch.float64) delta_t tensor(0.1519, dtype=torch.float64)
10 gae_duplicate tensor(-0.0413, dtype=torch.float64) tensor(-2.8803, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3879, dtype=torch.float64) delta_t tensor(-0.1227, dtype=torch.float64)
9 gae_duplicate tensor(-0.2187, dtype=torch.float64) tensor(2.1394, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1261, dtype=torch.float64) delta_t tensor(0.1356, dtype=torch.float64)
8 gae_duplicate tensor(-0.0100, dtype=torch.float64) tensor(-2.4675, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1045, dtype=torch.float64) delta_t tensor(-0.0258, dtype=torch.float64)
7 gae_duplicate tensor(-0.2647, dtype=torch.float64) tensor(0.2576, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3663, dtype=torch.float64) delta_t tensor(0.1793, dtype=torch.float64)
6 gae_duplicate tensor(-0.1414, dtype=torch.float64) tensor(-3.5187, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8485, dtype=torch.float64) delta_t tensor(0.4185, dtype=torch.float64)
5 gae_duplicate tensor(0.1698, dtype=torch.float64) tensor(-8.6396, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8142, dtype=torch.float64) delta_t tensor(-0.4145, dtype=torch.float64)
4 gae_duplicate tensor(-0.6613, dtype=torch.float64) tensor(7.3253, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5684, dtype=torch.float64) delta_t tensor(0.1093, dtype=torch.float64)
3 gae_duplicate tensor(-0.1435, dtype=torch.float64) tensor(-1.4241, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3310, dtype=torch.float64) delta_t tensor(-0.0019, dtype=torch.float64)
2 gae_duplicate tensor(-0.1308, dtype=torch.float64) tensor(-0.1083, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-444.4908447265625
value loss:7.292712211608887
entropies:355.9488525390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.144001007080078 seconds
19 rew tensor(0.8181, dtype=torch.float64) delta_t tensor(-0.0675, dtype=torch.float64)
19 gae_duplicate tensor(-0.2263, dtype=torch.float64) tensor(1.3340, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8190, dtype=torch.float64) delta_t tensor(0.0657, dtype=torch.float64)
18 gae_duplicate tensor(-0.0549, dtype=torch.float64) tensor(-1.1679, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8200, dtype=torch.float64) delta_t tensor(0.0705, dtype=torch.float64)
17 gae_duplicate tensor(-0.0469, dtype=torch.float64) tensor(-1.5110, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8209, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
16 gae_duplicate tensor(-0.1078, dtype=torch.float64) tensor(-0.7017, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8218, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
15 gae_duplicate tensor(-0.0859, dtype=torch.float64) tensor(-0.5724, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8228, dtype=torch.float64) delta_t tensor(0.0102, dtype=torch.float64)
14 gae_duplicate tensor(-0.1294, dtype=torch.float64) tensor(-0.2587, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8237, dtype=torch.float64) delta_t tensor(0.0100, dtype=torch.float64)
13 gae_duplicate tensor(-0.1116, dtype=torch.float64) tensor(-0.2222, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8246, dtype=torch.float64) delta_t tensor(0.0495, dtype=torch.float64)
12 gae_duplicate tensor(-0.0391, dtype=torch.float64) tensor(-0.9995, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8256, dtype=torch.float64) delta_t tensor(0.0550, dtype=torch.float64)
11 gae_duplicate tensor(-0.0510, dtype=torch.float64) tensor(-1.1890, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8265, dtype=torch.float64) delta_t tensor(0.1522, dtype=torch.float64)
10 gae_duplicate tensor(-0.0025, dtype=torch.float64) tensor(-3.1297, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4289, dtype=torch.float64) delta_t tensor(-0.0479, dtype=torch.float64)
9 gae_duplicate tensor(-0.1550, dtype=torch.float64) tensor(0.6326, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1568, dtype=torch.float64) delta_t tensor(0.1522, dtype=torch.float64)
8 gae_duplicate tensor(-0.0047, dtype=torch.float64) tensor(-2.9475, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0205, dtype=torch.float64) delta_t tensor(-0.0580, dtype=torch.float64)
7 gae_duplicate tensor(-0.2405, dtype=torch.float64) tensor(0.8546, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3244, dtype=torch.float64) delta_t tensor(0.1036, dtype=torch.float64)
6 gae_duplicate tensor(-0.1806, dtype=torch.float64) tensor(-1.9620, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8902, dtype=torch.float64) delta_t tensor(0.3121, dtype=torch.float64)
5 gae_duplicate tensor(-0.0696, dtype=torch.float64) tensor(-6.3690, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9177, dtype=torch.float64) delta_t tensor(-0.5459, dtype=torch.float64)
4 gae_duplicate tensor(-0.7311, dtype=torch.float64) tensor(10.1541, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6516, dtype=torch.float64) delta_t tensor(0.1224, dtype=torch.float64)
3 gae_duplicate tensor(-0.0957, dtype=torch.float64) tensor(-1.4011, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4675, dtype=torch.float64) delta_t tensor(-0.0543, dtype=torch.float64)
2 gae_duplicate tensor(-0.1311, dtype=torch.float64) tensor(0.9340, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:364.1045227050781
value loss:6.8086771965026855
entropies:355.9490661621094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.18921971321106 seconds
19 rew tensor(0.8182, dtype=torch.float64) delta_t tensor(-0.0001, dtype=torch.float64)
19 gae_duplicate tensor(-0.1502, dtype=torch.float64) tensor(0.0028, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(0.0737, dtype=torch.float64)
18 gae_duplicate tensor(-0.0443, dtype=torch.float64) tensor(-1.4550, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8200, dtype=torch.float64) delta_t tensor(0.0958, dtype=torch.float64)
17 gae_duplicate tensor(-0.0330, dtype=torch.float64) tensor(-2.0429, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8209, dtype=torch.float64) delta_t tensor(0.0920, dtype=torch.float64)
16 gae_duplicate tensor(0.0306, dtype=torch.float64) tensor(-2.0202, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8219, dtype=torch.float64) delta_t tensor(0.0665, dtype=torch.float64)
15 gae_duplicate tensor(-0.0894, dtype=torch.float64) tensor(-1.5153, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8228, dtype=torch.float64) delta_t tensor(0.0936, dtype=torch.float64)
14 gae_duplicate tensor(-0.0180, dtype=torch.float64) tensor(-2.0042, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8237, dtype=torch.float64) delta_t tensor(0.0690, dtype=torch.float64)
13 gae_duplicate tensor(-0.1007, dtype=torch.float64) tensor(-1.5663, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8246, dtype=torch.float64) delta_t tensor(0.0903, dtype=torch.float64)
12 gae_duplicate tensor(-0.0688, dtype=torch.float64) tensor(-1.9457, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8255, dtype=torch.float64) delta_t tensor(0.1091, dtype=torch.float64)
11 gae_duplicate tensor(-0.0042, dtype=torch.float64) tensor(-2.3519, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8264, dtype=torch.float64) delta_t tensor(0.2461, dtype=torch.float64)
10 gae_duplicate tensor(0.0326, dtype=torch.float64) tensor(-5.1009, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4592, dtype=torch.float64) delta_t tensor(0.0352, dtype=torch.float64)
9 gae_duplicate tensor(-0.1223, dtype=torch.float64) tensor(-1.2061, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1968, dtype=torch.float64) delta_t tensor(0.2488, dtype=torch.float64)
8 gae_duplicate tensor(0.1083, dtype=torch.float64) tensor(-5.0427, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0967, dtype=torch.float64) delta_t tensor(0.0093, dtype=torch.float64)
7 gae_duplicate tensor(-0.1239, dtype=torch.float64) tensor(-0.6892, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3802, dtype=torch.float64) delta_t tensor(0.0597, dtype=torch.float64)
6 gae_duplicate tensor(-0.1430, dtype=torch.float64) tensor(-1.2490, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8738, dtype=torch.float64) delta_t tensor(0.3053, dtype=torch.float64)
5 gae_duplicate tensor(0.2118, dtype=torch.float64) tensor(-6.1639, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8412, dtype=torch.float64) delta_t tensor(-0.5533, dtype=torch.float64)
4 gae_duplicate tensor(-0.7168, dtype=torch.float64) tensor(10.3222, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5946, dtype=torch.float64) delta_t tensor(-0.0109, dtype=torch.float64)
3 gae_duplicate tensor(-0.1887, dtype=torch.float64) tensor(1.2456, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3046, dtype=torch.float64) delta_t tensor(-0.0783, dtype=torch.float64)
2 gae_duplicate tensor(-0.2280, dtype=torch.float64) tensor(1.6730, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1043.830322265625
value loss:7.732019424438477
entropies:355.94805908203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.949668645858765 seconds
19 rew tensor(0.8183, dtype=torch.float64) delta_t tensor(-0.0027, dtype=torch.float64)
19 gae_duplicate tensor(-0.1542, dtype=torch.float64) tensor(0.0513, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8192, dtype=torch.float64) delta_t tensor(0.1113, dtype=torch.float64)
18 gae_duplicate tensor(0.0033, dtype=torch.float64) tensor(-2.1904, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8201, dtype=torch.float64) delta_t tensor(0.1148, dtype=torch.float64)
17 gae_duplicate tensor(0.0048, dtype=torch.float64) tensor(-2.4832, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8104, dtype=torch.float64) delta_t tensor(0.1073, dtype=torch.float64)
16 gae_duplicate tensor(0.0754, dtype=torch.float64) tensor(-2.3659, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8113, dtype=torch.float64) delta_t tensor(0.0779, dtype=torch.float64)
15 gae_duplicate tensor(0.0142, dtype=torch.float64) tensor(-1.7835, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8227, dtype=torch.float64) delta_t tensor(0.1024, dtype=torch.float64)
14 gae_duplicate tensor(-0.0624, dtype=torch.float64) tensor(-2.1950, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8236, dtype=torch.float64) delta_t tensor(0.1216, dtype=torch.float64)
13 gae_duplicate tensor(-0.0344, dtype=torch.float64) tensor(-2.6230, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8245, dtype=torch.float64) delta_t tensor(0.1385, dtype=torch.float64)
12 gae_duplicate tensor(0.0307, dtype=torch.float64) tensor(-2.9930, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8254, dtype=torch.float64) delta_t tensor(0.1279, dtype=torch.float64)
11 gae_duplicate tensor(0.0227, dtype=torch.float64) tensor(-2.8363, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4057, dtype=torch.float64) delta_t tensor(-0.1954, dtype=torch.float64)
10 gae_duplicate tensor(-2.3296, dtype=torch.float64) tensor(3.5201, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4584, dtype=torch.float64) delta_t tensor(0.0178, dtype=torch.float64)
9 gae_duplicate tensor(-0.1841, dtype=torch.float64) tensor(-0.0003, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2586, dtype=torch.float64) delta_t tensor(0.1845, dtype=torch.float64)
8 gae_duplicate tensor(0.0896, dtype=torch.float64) tensor(-3.6445, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0590, dtype=torch.float64) delta_t tensor(0.0997, dtype=torch.float64)
7 gae_duplicate tensor(-0.0472, dtype=torch.float64) tensor(-2.3371, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2562, dtype=torch.float64) delta_t tensor(0.0538, dtype=torch.float64)
6 gae_duplicate tensor(-0.2586, dtype=torch.float64) tensor(-1.2958, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8028, dtype=torch.float64) delta_t tensor(0.2887, dtype=torch.float64)
5 gae_duplicate tensor(-0.2700, dtype=torch.float64) tensor(-5.8376, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6972, dtype=torch.float64) delta_t tensor(-0.3542, dtype=torch.float64)
4 gae_duplicate tensor(-0.5440, dtype=torch.float64) tensor(6.4124, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6594, dtype=torch.float64) delta_t tensor(4.5699e-05, dtype=torch.float64)
3 gae_duplicate tensor(-0.6138, dtype=torch.float64) tensor(0.6485, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4536, dtype=torch.float64) delta_t tensor(-0.1378, dtype=torch.float64)
2 gae_duplicate tensor(-0.6927, dtype=torch.float64) tensor(2.7760, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:939.4793090820312
value loss:16.34545135498047
entropies:355.94158935546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.2375078201293945 seconds
19 rew tensor(0.8184, dtype=torch.float64) delta_t tensor(0.0262, dtype=torch.float64)
19 gae_duplicate tensor(-0.0187, dtype=torch.float64) tensor(-0.5196, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8193, dtype=torch.float64) delta_t tensor(0.1245, dtype=torch.float64)
18 gae_duplicate tensor(0.1062, dtype=torch.float64) tensor(-2.5190, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8201, dtype=torch.float64) delta_t tensor(0.1381, dtype=torch.float64)
17 gae_duplicate tensor(0.1147, dtype=torch.float64) tensor(-2.9845, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8210, dtype=torch.float64) delta_t tensor(0.1214, dtype=torch.float64)
16 gae_duplicate tensor(0.1195, dtype=torch.float64) tensor(-2.6951, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8219, dtype=torch.float64) delta_t tensor(0.0924, dtype=torch.float64)
15 gae_duplicate tensor(0.0126, dtype=torch.float64) tensor(-2.1018, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8227, dtype=torch.float64) delta_t tensor(0.0947, dtype=torch.float64)
14 gae_duplicate tensor(-0.0069, dtype=torch.float64) tensor(-2.0765, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8236, dtype=torch.float64) delta_t tensor(0.1030, dtype=torch.float64)
13 gae_duplicate tensor(-0.0093, dtype=torch.float64) tensor(-2.2522, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8245, dtype=torch.float64) delta_t tensor(0.1346, dtype=torch.float64)
12 gae_duplicate tensor(0.0759, dtype=torch.float64) tensor(-2.8897, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8253, dtype=torch.float64) delta_t tensor(0.1710, dtype=torch.float64)
11 gae_duplicate tensor(0.0734, dtype=torch.float64) tensor(-3.6741, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8262, dtype=torch.float64) delta_t tensor(0.2298, dtype=torch.float64)
10 gae_duplicate tensor(0.1210, dtype=torch.float64) tensor(-4.8994, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4060, dtype=torch.float64) delta_t tensor(0.0544, dtype=torch.float64)
9 gae_duplicate tensor(-0.0779, dtype=torch.float64) tensor(-1.5647, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1224, dtype=torch.float64) delta_t tensor(0.0878, dtype=torch.float64)
8 gae_duplicate tensor(0.0293, dtype=torch.float64) tensor(-1.8900, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0462, dtype=torch.float64) delta_t tensor(-0.0764, dtype=torch.float64)
7 gae_duplicate tensor(-0.1863, dtype=torch.float64) tensor(1.3157, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3401, dtype=torch.float64) delta_t tensor(0.0112, dtype=torch.float64)
6 gae_duplicate tensor(-0.3603, dtype=torch.float64) tensor(-0.0864, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9180, dtype=torch.float64) delta_t tensor(0.1997, dtype=torch.float64)
5 gae_duplicate tensor(0.0242, dtype=torch.float64) tensor(-3.9512, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9697, dtype=torch.float64) delta_t tensor(-0.6276, dtype=torch.float64)
4 gae_duplicate tensor(-0.8579, dtype=torch.float64) tensor(12.0135, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7652, dtype=torch.float64) delta_t tensor(-0.0257, dtype=torch.float64)
3 gae_duplicate tensor(-0.3730, dtype=torch.float64) tensor(1.7116, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5592, dtype=torch.float64) delta_t tensor(-0.1632, dtype=torch.float64)
2 gae_duplicate tensor(-0.3711, dtype=torch.float64) tensor(3.3989, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:749.7838745117188
value loss:7.673004150390625
entropies:355.9424743652344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3959.9509)
ToM Target loss= tensor(3579.1248)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.965066194534302 seconds
19 rew tensor(0.8180, dtype=torch.float64) delta_t tensor(0.0147, dtype=torch.float64)
19 gae_duplicate tensor(0.0030, dtype=torch.float64) tensor(-0.2897, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8188, dtype=torch.float64) delta_t tensor(0.0996, dtype=torch.float64)
18 gae_duplicate tensor(0.0854, dtype=torch.float64) tensor(-2.0011, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8197, dtype=torch.float64) delta_t tensor(0.0963, dtype=torch.float64)
17 gae_duplicate tensor(0.0801, dtype=torch.float64) tensor(-2.1072, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8100, dtype=torch.float64) delta_t tensor(0.0718, dtype=torch.float64)
16 gae_duplicate tensor(0.0296, dtype=torch.float64) tensor(-1.6287, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8109, dtype=torch.float64) delta_t tensor(0.0714, dtype=torch.float64)
15 gae_duplicate tensor(0.0455, dtype=torch.float64) tensor(-1.5753, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8221, dtype=torch.float64) delta_t tensor(0.0833, dtype=torch.float64)
14 gae_duplicate tensor(0.0621, dtype=torch.float64) tensor(-1.8069, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8230, dtype=torch.float64) delta_t tensor(0.0608, dtype=torch.float64)
13 gae_duplicate tensor(-0.0959, dtype=torch.float64) tensor(-1.3831, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8238, dtype=torch.float64) delta_t tensor(0.0853, dtype=torch.float64)
12 gae_duplicate tensor(-0.1095, dtype=torch.float64) tensor(-1.8242, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8038, dtype=torch.float64) delta_t tensor(0.1092, dtype=torch.float64)
11 gae_duplicate tensor(-0.0123, dtype=torch.float64) tensor(-2.3454, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7732, dtype=torch.float64) delta_t tensor(0.1518, dtype=torch.float64)
10 gae_duplicate tensor(-0.0242, dtype=torch.float64) tensor(-3.2377, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4377, dtype=torch.float64) delta_t tensor(-0.0703, dtype=torch.float64)
9 gae_duplicate tensor(-0.2816, dtype=torch.float64) tensor(1.0681, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2280, dtype=torch.float64) delta_t tensor(0.1427, dtype=torch.float64)
8 gae_duplicate tensor(-0.1950, dtype=torch.float64) tensor(-2.7197, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0447, dtype=torch.float64) delta_t tensor(-0.0925, dtype=torch.float64)
7 gae_duplicate tensor(-0.3411, dtype=torch.float64) tensor(1.5537, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3487, dtype=torch.float64) delta_t tensor(-0.0907, dtype=torch.float64)
6 gae_duplicate tensor(-0.5174, dtype=torch.float64) tensor(1.9400, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8733, dtype=torch.float64) delta_t tensor(0.1133, dtype=torch.float64)
5 gae_duplicate tensor(-0.6542, dtype=torch.float64) tensor(-2.0536, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0693, dtype=torch.float64) delta_t tensor(-0.7428, dtype=torch.float64)
4 gae_duplicate tensor(-1.0789, dtype=torch.float64) tensor(14.4782, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9499, dtype=torch.float64) delta_t tensor(-0.1958, dtype=torch.float64)
3 gae_duplicate tensor(-0.5643, dtype=torch.float64) tensor(5.3123, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7454, dtype=torch.float64) delta_t tensor(-0.4020, dtype=torch.float64)
2 gae_duplicate tensor(-1.2499, dtype=torch.float64) tensor(8.4844, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-628.77001953125
value loss:13.781013488769531
entropies:355.9419860839844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.275371789932251 seconds
19 rew tensor(0.8185, dtype=torch.float64) delta_t tensor(-0.0141, dtype=torch.float64)
19 gae_duplicate tensor(-0.0298, dtype=torch.float64) tensor(0.2800, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8193, dtype=torch.float64) delta_t tensor(0.0685, dtype=torch.float64)
18 gae_duplicate tensor(0.0477, dtype=torch.float64) tensor(-1.3260, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8201, dtype=torch.float64) delta_t tensor(0.0688, dtype=torch.float64)
17 gae_duplicate tensor(0.0439, dtype=torch.float64) tensor(-1.4937, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8210, dtype=torch.float64) delta_t tensor(0.0629, dtype=torch.float64)
16 gae_duplicate tensor(0.0485, dtype=torch.float64) tensor(-1.3933, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8218, dtype=torch.float64) delta_t tensor(0.0578, dtype=torch.float64)
15 gae_duplicate tensor(0.0519, dtype=torch.float64) tensor(-1.2820, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8226, dtype=torch.float64) delta_t tensor(0.0636, dtype=torch.float64)
14 gae_duplicate tensor(0.0528, dtype=torch.float64) tensor(-1.3866, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8234, dtype=torch.float64) delta_t tensor(0.0777, dtype=torch.float64)
13 gae_duplicate tensor(0.0294, dtype=torch.float64) tensor(-1.6764, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8243, dtype=torch.float64) delta_t tensor(0.1102, dtype=torch.float64)
12 gae_duplicate tensor(0.0006, dtype=torch.float64) tensor(-2.3398, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8251, dtype=torch.float64) delta_t tensor(0.1001, dtype=torch.float64)
11 gae_duplicate tensor(-0.0273, dtype=torch.float64) tensor(-2.2129, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8259, dtype=torch.float64) delta_t tensor(0.2517, dtype=torch.float64)
10 gae_duplicate tensor(0.0078, dtype=torch.float64) tensor(-5.2025, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3019, dtype=torch.float64) delta_t tensor(-0.1235, dtype=torch.float64)
9 gae_duplicate tensor(-0.2555, dtype=torch.float64) tensor(1.9225, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0605, dtype=torch.float64) delta_t tensor(-0.0851, dtype=torch.float64)
8 gae_duplicate tensor(-0.4217, dtype=torch.float64) tensor(1.8773, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0970, dtype=torch.float64) delta_t tensor(-0.1991, dtype=torch.float64)
7 gae_duplicate tensor(-0.4528, dtype=torch.float64) tensor(4.1282, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3490, dtype=torch.float64) delta_t tensor(-0.2106, dtype=torch.float64)
6 gae_duplicate tensor(-0.6112, dtype=torch.float64) tensor(4.5744, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8737, dtype=torch.float64) delta_t tensor(0.1299, dtype=torch.float64)
5 gae_duplicate tensor(-0.1893, dtype=torch.float64) tensor(-2.1118, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7985, dtype=torch.float64) delta_t tensor(-0.4456, dtype=torch.float64)
4 gae_duplicate tensor(-0.8670, dtype=torch.float64) tensor(8.5982, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7818, dtype=torch.float64) delta_t tensor(-0.0614, dtype=torch.float64)
3 gae_duplicate tensor(-0.2501, dtype=torch.float64) tensor(2.0736, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5131, dtype=torch.float64) delta_t tensor(-0.1196, dtype=torch.float64)
2 gae_duplicate tensor(-0.2860, dtype=torch.float64) tensor(2.5724, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-398.5985412597656
value loss:6.965664386749268
entropies:355.9486083984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.274674892425537 seconds
19 rew tensor(0.8185, dtype=torch.float64) delta_t tensor(-0.0392, dtype=torch.float64)
19 gae_duplicate tensor(-0.0527, dtype=torch.float64) tensor(0.7758, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8193, dtype=torch.float64) delta_t tensor(0.0512, dtype=torch.float64)
18 gae_duplicate tensor(0.0273, dtype=torch.float64) tensor(-0.9340, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8201, dtype=torch.float64) delta_t tensor(0.0761, dtype=torch.float64)
17 gae_duplicate tensor(0.0508, dtype=torch.float64) tensor(-1.5994, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8209, dtype=torch.float64) delta_t tensor(0.0507, dtype=torch.float64)
16 gae_duplicate tensor(0.0442, dtype=torch.float64) tensor(-1.1623, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8217, dtype=torch.float64) delta_t tensor(0.0418, dtype=torch.float64)
15 gae_duplicate tensor(0.0326, dtype=torch.float64) tensor(-0.9413, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8225, dtype=torch.float64) delta_t tensor(0.0176, dtype=torch.float64)
14 gae_duplicate tensor(-0.1279, dtype=torch.float64) tensor(-0.4420, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8233, dtype=torch.float64) delta_t tensor(0.0194, dtype=torch.float64)
13 gae_duplicate tensor(-0.0968, dtype=torch.float64) tensor(-0.4286, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8241, dtype=torch.float64) delta_t tensor(0.0380, dtype=torch.float64)
12 gae_duplicate tensor(-0.1408, dtype=torch.float64) tensor(-0.7930, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8249, dtype=torch.float64) delta_t tensor(0.0535, dtype=torch.float64)
11 gae_duplicate tensor(-0.1044, dtype=torch.float64) tensor(-1.1374, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8258, dtype=torch.float64) delta_t tensor(0.0275, dtype=torch.float64)
10 gae_duplicate tensor(-0.0306, dtype=torch.float64) tensor(-0.6564, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4794, dtype=torch.float64) delta_t tensor(-0.0229, dtype=torch.float64)
9 gae_duplicate tensor(-0.1806, dtype=torch.float64) tensor(0.3866, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2169, dtype=torch.float64) delta_t tensor(0.1462, dtype=torch.float64)
8 gae_duplicate tensor(0.0108, dtype=torch.float64) tensor(-2.8522, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0561, dtype=torch.float64) delta_t tensor(-0.1071, dtype=torch.float64)
7 gae_duplicate tensor(-0.2557, dtype=torch.float64) tensor(1.8325, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3815, dtype=torch.float64) delta_t tensor(-0.0477, dtype=torch.float64)
6 gae_duplicate tensor(-0.2629, dtype=torch.float64) tensor(1.1256, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9377, dtype=torch.float64) delta_t tensor(0.2266, dtype=torch.float64)
5 gae_duplicate tensor(0.1184, dtype=torch.float64) tensor(-4.3652, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9253, dtype=torch.float64) delta_t tensor(-0.5410, dtype=torch.float64)
4 gae_duplicate tensor(-0.8707, dtype=torch.float64) tensor(10.2549, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6785, dtype=torch.float64) delta_t tensor(-0.0687, dtype=torch.float64)
3 gae_duplicate tensor(-0.3532, dtype=torch.float64) tensor(2.3864, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4088, dtype=torch.float64) delta_t tensor(-0.2332, dtype=torch.float64)
2 gae_duplicate tensor(-0.3939, dtype=torch.float64) tensor(4.8458, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-436.0809020996094
value loss:5.434001445770264
entropies:355.9490051269531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.391369819641113 seconds
19 rew tensor(0.8187, dtype=torch.float64) delta_t tensor(-0.0894, dtype=torch.float64)
19 gae_duplicate tensor(-0.1780, dtype=torch.float64) tensor(1.7660, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8195, dtype=torch.float64) delta_t tensor(0.0040, dtype=torch.float64)
18 gae_duplicate tensor(-0.0865, dtype=torch.float64) tensor(0.0981, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8203, dtype=torch.float64) delta_t tensor(0.0350, dtype=torch.float64)
17 gae_duplicate tensor(-0.0027, dtype=torch.float64) tensor(-0.6829, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8210, dtype=torch.float64) delta_t tensor(0.0269, dtype=torch.float64)
16 gae_duplicate tensor(0.0049, dtype=torch.float64) tensor(-0.6004, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8218, dtype=torch.float64) delta_t tensor(-0.0047, dtype=torch.float64)
15 gae_duplicate tensor(-0.0848, dtype=torch.float64) tensor(0.0332, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8226, dtype=torch.float64) delta_t tensor(-0.0180, dtype=torch.float64)
14 gae_duplicate tensor(-0.0764, dtype=torch.float64) tensor(0.3580, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8234, dtype=torch.float64) delta_t tensor(-0.0154, dtype=torch.float64)
13 gae_duplicate tensor(-0.1227, dtype=torch.float64) tensor(0.3409, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8242, dtype=torch.float64) delta_t tensor(0.0211, dtype=torch.float64)
12 gae_duplicate tensor(-0.0544, dtype=torch.float64) tensor(-0.3828, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8250, dtype=torch.float64) delta_t tensor(0.0306, dtype=torch.float64)
11 gae_duplicate tensor(-0.0274, dtype=torch.float64) tensor(-0.6431, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8258, dtype=torch.float64) delta_t tensor(0.1669, dtype=torch.float64)
10 gae_duplicate tensor(0.0971, dtype=torch.float64) tensor(-3.3662, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4166, dtype=torch.float64) delta_t tensor(-0.0925, dtype=torch.float64)
9 gae_duplicate tensor(-0.3089, dtype=torch.float64) tensor(1.4915, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1330, dtype=torch.float64) delta_t tensor(0.0498, dtype=torch.float64)
8 gae_duplicate tensor(-0.2807, dtype=torch.float64) tensor(-0.8370, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0983, dtype=torch.float64) delta_t tensor(-0.1993, dtype=torch.float64)
7 gae_duplicate tensor(-0.3634, dtype=torch.float64) tensor(3.8581, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4555, dtype=torch.float64) delta_t tensor(-0.1147, dtype=torch.float64)
6 gae_duplicate tensor(-0.4826, dtype=torch.float64) tensor(2.6605, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9806, dtype=torch.float64) delta_t tensor(0.1103, dtype=torch.float64)
5 gae_duplicate tensor(-0.1285, dtype=torch.float64) tensor(-1.9089, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9692, dtype=torch.float64) delta_t tensor(-0.6293, dtype=torch.float64)
4 gae_duplicate tensor(-0.9906, dtype=torch.float64) tensor(12.2535, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7434, dtype=torch.float64) delta_t tensor(-0.1177, dtype=torch.float64)
3 gae_duplicate tensor(-0.3078, dtype=torch.float64) tensor(3.5499, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4949, dtype=torch.float64) delta_t tensor(-0.2451, dtype=torch.float64)
2 gae_duplicate tensor(-0.3878, dtype=torch.float64) tensor(5.2027, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1348.42578125
value loss:7.732818126678467
entropies:355.94757080078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.85033392906189 seconds
19 rew tensor(0.8188, dtype=torch.float64) delta_t tensor(-0.1096, dtype=torch.float64)
19 gae_duplicate tensor(-0.2093, dtype=torch.float64) tensor(2.1638, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8195, dtype=torch.float64) delta_t tensor(-0.0045, dtype=torch.float64)
18 gae_duplicate tensor(-0.0588, dtype=torch.float64) tensor(0.3055, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8203, dtype=torch.float64) delta_t tensor(0.0105, dtype=torch.float64)
17 gae_duplicate tensor(-0.0364, dtype=torch.float64) tensor(-0.1776, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8211, dtype=torch.float64) delta_t tensor(0.0059, dtype=torch.float64)
16 gae_duplicate tensor(-0.0398, dtype=torch.float64) tensor(-0.1340, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8218, dtype=torch.float64) delta_t tensor(-0.0143, dtype=torch.float64)
15 gae_duplicate tensor(-0.1086, dtype=torch.float64) tensor(0.2691, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8226, dtype=torch.float64) delta_t tensor(-0.0077, dtype=torch.float64)
14 gae_duplicate tensor(-0.0778, dtype=torch.float64) tensor(0.1790, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8234, dtype=torch.float64) delta_t tensor(-0.0307, dtype=torch.float64)
13 gae_duplicate tensor(-0.1301, dtype=torch.float64) tensor(0.6240, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8241, dtype=torch.float64) delta_t tensor(-0.0491, dtype=torch.float64)
12 gae_duplicate tensor(-0.1523, dtype=torch.float64) tensor(1.0310, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8249, dtype=torch.float64) delta_t tensor(-0.0150, dtype=torch.float64)
11 gae_duplicate tensor(-0.0963, dtype=torch.float64) tensor(0.4007, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8257, dtype=torch.float64) delta_t tensor(0.1200, dtype=torch.float64)
10 gae_duplicate tensor(-0.0129, dtype=torch.float64) tensor(-2.3268, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0408, dtype=torch.float64) delta_t tensor(-0.5669, dtype=torch.float64)
9 gae_duplicate tensor(-2.5492, dtype=torch.float64) tensor(10.9673, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2468, dtype=torch.float64) delta_t tensor(0.0692, dtype=torch.float64)
8 gae_duplicate tensor(-0.2720, dtype=torch.float64) tensor(-0.2721, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0160, dtype=torch.float64) delta_t tensor(-0.1177, dtype=torch.float64)
7 gae_duplicate tensor(-0.3027, dtype=torch.float64) tensor(2.2984, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3626, dtype=torch.float64) delta_t tensor(-0.1181, dtype=torch.float64)
6 gae_duplicate tensor(-0.3854, dtype=torch.float64) tensor(2.5518, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8874, dtype=torch.float64) delta_t tensor(0.1133, dtype=torch.float64)
5 gae_duplicate tensor(-0.3782, dtype=torch.float64) tensor(-1.9774, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6972, dtype=torch.float64) delta_t tensor(-0.3318, dtype=torch.float64)
4 gae_duplicate tensor(-0.6801, dtype=torch.float64) tensor(6.3495, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6365, dtype=torch.float64) delta_t tensor(-0.0888, dtype=torch.float64)
3 gae_duplicate tensor(-0.6282, dtype=torch.float64) tensor(2.3848, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3561, dtype=torch.float64) delta_t tensor(-0.2145, dtype=torch.float64)
2 gae_duplicate tensor(-0.6310, dtype=torch.float64) tensor(4.4790, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1668.3582763671875
value loss:15.439949989318848
entropies:355.943603515625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3955.0144)
ToM Target loss= tensor(3611.3333)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.8911497592926025 seconds
19 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(-0.0978, dtype=torch.float64)
19 gae_duplicate tensor(-0.1101, dtype=torch.float64) tensor(1.9324, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8199, dtype=torch.float64) delta_t tensor(-0.0064, dtype=torch.float64)
18 gae_duplicate tensor(-0.0321, dtype=torch.float64) tensor(0.3200, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8206, dtype=torch.float64) delta_t tensor(-0.0086, dtype=torch.float64)
17 gae_duplicate tensor(-0.0274, dtype=torch.float64) tensor(0.2012, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8214, dtype=torch.float64) delta_t tensor(-0.0053, dtype=torch.float64)
16 gae_duplicate tensor(-0.0286, dtype=torch.float64) tensor(0.1253, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8221, dtype=torch.float64) delta_t tensor(-0.0180, dtype=torch.float64)
15 gae_duplicate tensor(-0.0271, dtype=torch.float64) tensor(0.3694, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8229, dtype=torch.float64) delta_t tensor(-0.0151, dtype=torch.float64)
14 gae_duplicate tensor(-0.0321, dtype=torch.float64) tensor(0.3355, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8236, dtype=torch.float64) delta_t tensor(-0.0019, dtype=torch.float64)
13 gae_duplicate tensor(-0.0188, dtype=torch.float64) tensor(0.0712, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8244, dtype=torch.float64) delta_t tensor(0.0302, dtype=torch.float64)
12 gae_duplicate tensor(0.0019, dtype=torch.float64) tensor(-0.5897, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8251, dtype=torch.float64) delta_t tensor(0.0383, dtype=torch.float64)
11 gae_duplicate tensor(0.0201, dtype=torch.float64) tensor(-0.8163, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8259, dtype=torch.float64) delta_t tensor(0.1723, dtype=torch.float64)
10 gae_duplicate tensor(0.0060, dtype=torch.float64) tensor(-3.4908, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3001, dtype=torch.float64) delta_t tensor(-0.2198, dtype=torch.float64)
9 gae_duplicate tensor(-0.2848, dtype=torch.float64) tensor(3.9996, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1112, dtype=torch.float64) delta_t tensor(-0.1096, dtype=torch.float64)
8 gae_duplicate tensor(-0.3675, dtype=torch.float64) tensor(2.5656, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0783, dtype=torch.float64) delta_t tensor(-0.2434, dtype=torch.float64)
7 gae_duplicate tensor(-0.3271, dtype=torch.float64) tensor(5.0656, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4148, dtype=torch.float64) delta_t tensor(-0.3476, dtype=torch.float64)
6 gae_duplicate tensor(-0.5295, dtype=torch.float64) tensor(7.3777, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9407, dtype=torch.float64) delta_t tensor(0.0450, dtype=torch.float64)
5 gae_duplicate tensor(-0.1231, dtype=torch.float64) tensor(-0.1547, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8449, dtype=torch.float64) delta_t tensor(-0.4432, dtype=torch.float64)
4 gae_duplicate tensor(-0.8663, dtype=torch.float64) tensor(8.7514, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8703, dtype=torch.float64) delta_t tensor(-0.1232, dtype=torch.float64)
3 gae_duplicate tensor(-0.2779, dtype=torch.float64) tensor(3.3105, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5802, dtype=torch.float64) delta_t tensor(-0.2632, dtype=torch.float64)
2 gae_duplicate tensor(-0.3781, dtype=torch.float64) tensor(5.5386, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1981.3768310546875
value loss:6.751195907592773
entropies:355.9483947753906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.066534996032715 seconds
19 rew tensor(0.8189, dtype=torch.float64) delta_t tensor(-0.0781, dtype=torch.float64)
19 gae_duplicate tensor(-0.0898, dtype=torch.float64) tensor(1.5433, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8197, dtype=torch.float64) delta_t tensor(0.0147, dtype=torch.float64)
18 gae_duplicate tensor(0.0013, dtype=torch.float64) tensor(-0.1358, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8204, dtype=torch.float64) delta_t tensor(0.0222, dtype=torch.float64)
17 gae_duplicate tensor(0.0038, dtype=torch.float64) tensor(-0.4519, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8211, dtype=torch.float64) delta_t tensor(0.0131, dtype=torch.float64)
16 gae_duplicate tensor(0.0088, dtype=torch.float64) tensor(-0.3050, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8219, dtype=torch.float64) delta_t tensor(0.0046, dtype=torch.float64)
15 gae_duplicate tensor(-0.0068, dtype=torch.float64) tensor(-0.1205, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8226, dtype=torch.float64) delta_t tensor(0.0069, dtype=torch.float64)
14 gae_duplicate tensor(-0.0059, dtype=torch.float64) tensor(-0.1481, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8233, dtype=torch.float64) delta_t tensor(0.0075, dtype=torch.float64)
13 gae_duplicate tensor(-0.0220, dtype=torch.float64) tensor(-0.1630, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8241, dtype=torch.float64) delta_t tensor(0.0183, dtype=torch.float64)
12 gae_duplicate tensor(-0.0796, dtype=torch.float64) tensor(-0.3773, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8248, dtype=torch.float64) delta_t tensor(0.0391, dtype=torch.float64)
11 gae_duplicate tensor(-0.0825, dtype=torch.float64) tensor(-0.8113, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8256, dtype=torch.float64) delta_t tensor(0.1444, dtype=torch.float64)
10 gae_duplicate tensor(0.0593, dtype=torch.float64) tensor(-2.9371, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4055, dtype=torch.float64) delta_t tensor(-0.1326, dtype=torch.float64)
9 gae_duplicate tensor(-0.2234, dtype=torch.float64) tensor(2.3298, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1849, dtype=torch.float64) delta_t tensor(-0.0222, dtype=torch.float64)
8 gae_duplicate tensor(-0.2172, dtype=torch.float64) tensor(0.6713, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0037, dtype=torch.float64) delta_t tensor(-0.1488, dtype=torch.float64)
7 gae_duplicate tensor(-0.4269, dtype=torch.float64) tensor(3.0109, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2770, dtype=torch.float64) delta_t tensor(-0.1613, dtype=torch.float64)
6 gae_duplicate tensor(-0.3783, dtype=torch.float64) tensor(3.4903, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8129, dtype=torch.float64) delta_t tensor(0.1592, dtype=torch.float64)
5 gae_duplicate tensor(-0.1075, dtype=torch.float64) tensor(-2.7964, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9071, dtype=torch.float64) delta_t tensor(-0.5161, dtype=torch.float64)
4 gae_duplicate tensor(-0.7613, dtype=torch.float64) tensor(9.9303, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8269, dtype=torch.float64) delta_t tensor(-0.0387, dtype=torch.float64)
3 gae_duplicate tensor(-0.5935, dtype=torch.float64) tensor(1.7568, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6634, dtype=torch.float64) delta_t tensor(-0.3312, dtype=torch.float64)
2 gae_duplicate tensor(-0.7549, dtype=torch.float64) tensor(6.7283, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1241.6881103515625
value loss:6.844291687011719
entropies:355.94915771484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.244933128356934 seconds
19 rew tensor(0.8184, dtype=torch.float64) delta_t tensor(-0.0469, dtype=torch.float64)
19 gae_duplicate tensor(-0.0716, dtype=torch.float64) tensor(0.9273, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(0.0449, dtype=torch.float64)
18 gae_duplicate tensor(0.0314, dtype=torch.float64) tensor(-0.7941, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8198, dtype=torch.float64) delta_t tensor(0.0643, dtype=torch.float64)
17 gae_duplicate tensor(0.0298, dtype=torch.float64) tensor(-1.3515, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8205, dtype=torch.float64) delta_t tensor(0.0462, dtype=torch.float64)
16 gae_duplicate tensor(0.0216, dtype=torch.float64) tensor(-1.0501, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8212, dtype=torch.float64) delta_t tensor(0.0435, dtype=torch.float64)
15 gae_duplicate tensor(0.0236, dtype=torch.float64) tensor(-0.9640, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8219, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
14 gae_duplicate tensor(0.0067, dtype=torch.float64) tensor(-0.6487, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8227, dtype=torch.float64) delta_t tensor(0.0177, dtype=torch.float64)
13 gae_duplicate tensor(-0.1056, dtype=torch.float64) tensor(-0.4152, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8234, dtype=torch.float64) delta_t tensor(0.0123, dtype=torch.float64)
12 gae_duplicate tensor(-0.1097, dtype=torch.float64) tensor(-0.2867, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8241, dtype=torch.float64) delta_t tensor(0.0220, dtype=torch.float64)
11 gae_duplicate tensor(-0.1059, dtype=torch.float64) tensor(-0.4649, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8248, dtype=torch.float64) delta_t tensor(0.1128, dtype=torch.float64)
10 gae_duplicate tensor(-0.0711, dtype=torch.float64) tensor(-2.2741, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5092, dtype=torch.float64) delta_t tensor(-0.0302, dtype=torch.float64)
9 gae_duplicate tensor(-0.3272, dtype=torch.float64) tensor(0.3748, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2878, dtype=torch.float64) delta_t tensor(0.1267, dtype=torch.float64)
8 gae_duplicate tensor(-0.2604, dtype=torch.float64) tensor(-2.4661, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1086, dtype=torch.float64) delta_t tensor(-0.0063, dtype=torch.float64)
7 gae_duplicate tensor(-0.2725, dtype=torch.float64) tensor(-0.1231, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1537, dtype=torch.float64) delta_t tensor(0.0258, dtype=torch.float64)
6 gae_duplicate tensor(-0.4772, dtype=torch.float64) tensor(-0.5264, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6686, dtype=torch.float64) delta_t tensor(0.4352, dtype=torch.float64)
5 gae_duplicate tensor(-0.2161, dtype=torch.float64) tensor(-8.6583, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7619, dtype=torch.float64) delta_t tensor(-0.4018, dtype=torch.float64)
4 gae_duplicate tensor(-0.6115, dtype=torch.float64) tensor(7.0794, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6178, dtype=torch.float64) delta_t tensor(0.0670, dtype=torch.float64)
3 gae_duplicate tensor(-0.2068, dtype=torch.float64) tensor(-0.6165, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3785, dtype=torch.float64) delta_t tensor(0.0057, dtype=torch.float64)
2 gae_duplicate tensor(-0.2271, dtype=torch.float64) tensor(-0.1771, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:575.3892211914062
value loss:7.498793125152588
entropies:355.94781494140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.957178831100464 seconds
19 rew tensor(0.8077, dtype=torch.float64) delta_t tensor(-0.0470, dtype=torch.float64)
19 gae_duplicate tensor(-0.1018, dtype=torch.float64) tensor(0.9287, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8084, dtype=torch.float64) delta_t tensor(0.0518, dtype=torch.float64)
18 gae_duplicate tensor(-0.0377, dtype=torch.float64) tensor(-0.9334, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8196, dtype=torch.float64) delta_t tensor(0.0775, dtype=torch.float64)
17 gae_duplicate tensor(0.0288, dtype=torch.float64) tensor(-1.6258, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8098, dtype=torch.float64) delta_t tensor(0.0482, dtype=torch.float64)
16 gae_duplicate tensor(-0.0177, dtype=torch.float64) tensor(-1.1162, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8105, dtype=torch.float64) delta_t tensor(0.0432, dtype=torch.float64)
15 gae_duplicate tensor(-0.0270, dtype=torch.float64) tensor(-0.9666, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8217, dtype=torch.float64) delta_t tensor(0.0629, dtype=torch.float64)
14 gae_duplicate tensor(0.0306, dtype=torch.float64) tensor(-1.3405, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8224, dtype=torch.float64) delta_t tensor(0.0935, dtype=torch.float64)
13 gae_duplicate tensor(0.0382, dtype=torch.float64) tensor(-1.9839, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8231, dtype=torch.float64) delta_t tensor(0.1144, dtype=torch.float64)
12 gae_duplicate tensor(0.0460, dtype=torch.float64) tensor(-2.4591, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8238, dtype=torch.float64) delta_t tensor(0.0829, dtype=torch.float64)
11 gae_duplicate tensor(0.0499, dtype=torch.float64) tensor(-1.8873, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8245, dtype=torch.float64) delta_t tensor(0.2551, dtype=torch.float64)
10 gae_duplicate tensor(0.1075, dtype=torch.float64) tensor(-5.2395, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3713, dtype=torch.float64) delta_t tensor(-0.0269, dtype=torch.float64)
9 gae_duplicate tensor(-0.2165, dtype=torch.float64) tensor(0.0044, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2237, dtype=torch.float64) delta_t tensor(0.1282, dtype=torch.float64)
8 gae_duplicate tensor(-0.3413, dtype=torch.float64) tensor(-2.5321, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0456, dtype=torch.float64) delta_t tensor(0.0270, dtype=torch.float64)
7 gae_duplicate tensor(-0.2839, dtype=torch.float64) tensor(-0.7890, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3330, dtype=torch.float64) delta_t tensor(0.0157, dtype=torch.float64)
6 gae_duplicate tensor(-0.4373, dtype=torch.float64) tensor(-0.3878, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9011, dtype=torch.float64) delta_t tensor(0.1408, dtype=torch.float64)
5 gae_duplicate tensor(-0.0881, dtype=torch.float64) tensor(-2.8209, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7854, dtype=torch.float64) delta_t tensor(-0.3253, dtype=torch.float64)
4 gae_duplicate tensor(-0.7578, dtype=torch.float64) tensor(6.1507, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6852, dtype=torch.float64) delta_t tensor(0.0580, dtype=torch.float64)
3 gae_duplicate tensor(-0.2177, dtype=torch.float64) tensor(-0.5306, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4569, dtype=torch.float64) delta_t tensor(-0.1367, dtype=torch.float64)
2 gae_duplicate tensor(-0.3515, dtype=torch.float64) tensor(2.6494, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:707.38623046875
value loss:7.952183246612549
entropies:355.94781494140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.019316911697388 seconds
19 rew tensor(0.8184, dtype=torch.float64) delta_t tensor(-0.0612, dtype=torch.float64)
19 gae_duplicate tensor(-0.1678, dtype=torch.float64) tensor(1.2089, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(0.0470, dtype=torch.float64)
18 gae_duplicate tensor(0.0219, dtype=torch.float64) tensor(-0.8080, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8198, dtype=torch.float64) delta_t tensor(0.0546, dtype=torch.float64)
17 gae_duplicate tensor(0.0241, dtype=torch.float64) tensor(-1.1604, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8204, dtype=torch.float64) delta_t tensor(0.0427, dtype=torch.float64)
16 gae_duplicate tensor(0.0274, dtype=torch.float64) tensor(-0.9585, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8211, dtype=torch.float64) delta_t tensor(0.0327, dtype=torch.float64)
15 gae_duplicate tensor(0.0250, dtype=torch.float64) tensor(-0.7422, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8218, dtype=torch.float64) delta_t tensor(0.0321, dtype=torch.float64)
14 gae_duplicate tensor(0.0257, dtype=torch.float64) tensor(-0.7074, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8225, dtype=torch.float64) delta_t tensor(0.0370, dtype=torch.float64)
13 gae_duplicate tensor(-0.0114, dtype=torch.float64) tensor(-0.8033, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8232, dtype=torch.float64) delta_t tensor(0.0475, dtype=torch.float64)
12 gae_duplicate tensor(-0.0371, dtype=torch.float64) tensor(-1.0216, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8239, dtype=torch.float64) delta_t tensor(0.0821, dtype=torch.float64)
11 gae_duplicate tensor(0.0142, dtype=torch.float64) tensor(-1.7231, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8246, dtype=torch.float64) delta_t tensor(0.1982, dtype=torch.float64)
10 gae_duplicate tensor(0.1010, dtype=torch.float64) tensor(-4.0891, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3827, dtype=torch.float64) delta_t tensor(-0.1158, dtype=torch.float64)
9 gae_duplicate tensor(-0.2379, dtype=torch.float64) tensor(1.8859, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1928, dtype=torch.float64) delta_t tensor(0.1175, dtype=torch.float64)
8 gae_duplicate tensor(-0.1480, dtype=torch.float64) tensor(-2.1349, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1437, dtype=torch.float64) delta_t tensor(-0.1905, dtype=torch.float64)
7 gae_duplicate tensor(-0.3254, dtype=torch.float64) tensor(3.5631, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4167, dtype=torch.float64) delta_t tensor(-0.0745, dtype=torch.float64)
6 gae_duplicate tensor(-0.5850, dtype=torch.float64) tensor(1.8295, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9652, dtype=torch.float64) delta_t tensor(0.2029, dtype=torch.float64)
5 gae_duplicate tensor(-0.2107, dtype=torch.float64) tensor(-3.8280, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8503, dtype=torch.float64) delta_t tensor(-0.3167, dtype=torch.float64)
4 gae_duplicate tensor(-0.7204, dtype=torch.float64) tensor(5.8726, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6856, dtype=torch.float64) delta_t tensor(0.0457, dtype=torch.float64)
3 gae_duplicate tensor(-0.2793, dtype=torch.float64) tensor(-0.3140, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3520, dtype=torch.float64) delta_t tensor(-0.0768, dtype=torch.float64)
2 gae_duplicate tensor(-0.2921, dtype=torch.float64) tensor(1.4884, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:35.76492691040039
value loss:5.926506996154785
entropies:355.94580078125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3954.9365)
ToM Target loss= tensor(3621.8176)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.801908016204834 seconds
19 rew tensor(0.8182, dtype=torch.float64) delta_t tensor(-0.0533, dtype=torch.float64)
19 gae_duplicate tensor(-0.0703, dtype=torch.float64) tensor(1.0558, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8188, dtype=torch.float64) delta_t tensor(0.0330, dtype=torch.float64)
18 gae_duplicate tensor(0.0160, dtype=torch.float64) tensor(-0.5475, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8195, dtype=torch.float64) delta_t tensor(0.0377, dtype=torch.float64)
17 gae_duplicate tensor(0.0204, dtype=torch.float64) tensor(-0.7981, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8202, dtype=torch.float64) delta_t tensor(0.0363, dtype=torch.float64)
16 gae_duplicate tensor(0.0188, dtype=torch.float64) tensor(-0.7967, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8208, dtype=torch.float64) delta_t tensor(0.0229, dtype=torch.float64)
15 gae_duplicate tensor(0.0116, dtype=torch.float64) tensor(-0.5319, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8215, dtype=torch.float64) delta_t tensor(0.0281, dtype=torch.float64)
14 gae_duplicate tensor(0.0124, dtype=torch.float64) tensor(-0.6066, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8222, dtype=torch.float64) delta_t tensor(0.0296, dtype=torch.float64)
13 gae_duplicate tensor(-0.0002, dtype=torch.float64) tensor(-0.6467, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8229, dtype=torch.float64) delta_t tensor(0.0535, dtype=torch.float64)
12 gae_duplicate tensor(0.0412, dtype=torch.float64) tensor(-1.1235, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8236, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
11 gae_duplicate tensor(-0.0097, dtype=torch.float64) tensor(-1.2529, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8242, dtype=torch.float64) delta_t tensor(0.1771, dtype=torch.float64)
10 gae_duplicate tensor(0.1336, dtype=torch.float64) tensor(-3.6224, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4030, dtype=torch.float64) delta_t tensor(-0.1362, dtype=torch.float64)
9 gae_duplicate tensor(-0.2634, dtype=torch.float64) tensor(2.3304, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2450, dtype=torch.float64) delta_t tensor(0.0561, dtype=torch.float64)
8 gae_duplicate tensor(-0.1983, dtype=torch.float64) tensor(-0.8785, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0556, dtype=torch.float64) delta_t tensor(-0.0914, dtype=torch.float64)
7 gae_duplicate tensor(-0.2963, dtype=torch.float64) tensor(1.7217, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2397, dtype=torch.float64) delta_t tensor(-0.1007, dtype=torch.float64)
6 gae_duplicate tensor(-0.3152, dtype=torch.float64) tensor(2.1630, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7973, dtype=torch.float64) delta_t tensor(0.3298, dtype=torch.float64)
5 gae_duplicate tensor(0.2170, dtype=torch.float64) tensor(-6.3046, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8719, dtype=torch.float64) delta_t tensor(-0.2930, dtype=torch.float64)
4 gae_duplicate tensor(-0.5051, dtype=torch.float64) tensor(5.1616, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8560, dtype=torch.float64) delta_t tensor(0.0592, dtype=torch.float64)
3 gae_duplicate tensor(-0.2919, dtype=torch.float64) tensor(-0.6530, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6068, dtype=torch.float64) delta_t tensor(-0.1115, dtype=torch.float64)
2 gae_duplicate tensor(-0.4672, dtype=torch.float64) tensor(2.1401, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:76.14635467529297
value loss:4.613497257232666
entropies:355.9461669921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.947556734085083 seconds
19 rew tensor(0.8184, dtype=torch.float64) delta_t tensor(-0.0788, dtype=torch.float64)
19 gae_duplicate tensor(-0.1169, dtype=torch.float64) tensor(1.5549, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8190, dtype=torch.float64) delta_t tensor(0.0176, dtype=torch.float64)
18 gae_duplicate tensor(-0.0071, dtype=torch.float64) tensor(-0.1925, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8197, dtype=torch.float64) delta_t tensor(0.0576, dtype=torch.float64)
17 gae_duplicate tensor(-0.0025, dtype=torch.float64) tensor(-1.1567, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8203, dtype=torch.float64) delta_t tensor(0.0357, dtype=torch.float64)
16 gae_duplicate tensor(0.0085, dtype=torch.float64) tensor(-0.8210, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8210, dtype=torch.float64) delta_t tensor(0.0312, dtype=torch.float64)
15 gae_duplicate tensor(0.0085, dtype=torch.float64) tensor(-0.7003, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8217, dtype=torch.float64) delta_t tensor(-0.0091, dtype=torch.float64)
14 gae_duplicate tensor(-0.0827, dtype=torch.float64) tensor(0.1108, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8223, dtype=torch.float64) delta_t tensor(0.0027, dtype=torch.float64)
13 gae_duplicate tensor(-0.0863, dtype=torch.float64) tensor(-0.0411, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8230, dtype=torch.float64) delta_t tensor(0.0063, dtype=torch.float64)
12 gae_duplicate tensor(-0.0533, dtype=torch.float64) tensor(-0.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8237, dtype=torch.float64) delta_t tensor(0.0607, dtype=torch.float64)
11 gae_duplicate tensor(-0.0183, dtype=torch.float64) tensor(-1.2125, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8243, dtype=torch.float64) delta_t tensor(0.1736, dtype=torch.float64)
10 gae_duplicate tensor(0.0666, dtype=torch.float64) tensor(-3.5583, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4232, dtype=torch.float64) delta_t tensor(-0.0488, dtype=torch.float64)
9 gae_duplicate tensor(-0.3067, dtype=torch.float64) tensor(0.6036, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1500, dtype=torch.float64) delta_t tensor(0.1419, dtype=torch.float64)
8 gae_duplicate tensor(-0.0774, dtype=torch.float64) tensor(-2.7443, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1771, dtype=torch.float64) delta_t tensor(-0.1597, dtype=torch.float64)
7 gae_duplicate tensor(-0.5399, dtype=torch.float64) tensor(2.8788, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4613, dtype=torch.float64) delta_t tensor(-0.0073, dtype=torch.float64)
6 gae_duplicate tensor(-0.5106, dtype=torch.float64) tensor(0.4366, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0096, dtype=torch.float64) delta_t tensor(0.3332, dtype=torch.float64)
5 gae_duplicate tensor(-0.0824, dtype=torch.float64) tensor(-6.5510, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9775, dtype=torch.float64) delta_t tensor(-0.4071, dtype=torch.float64)
4 gae_duplicate tensor(-0.8497, dtype=torch.float64) tensor(7.3983, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7722, dtype=torch.float64) delta_t tensor(0.0115, dtype=torch.float64)
3 gae_duplicate tensor(-0.1329, dtype=torch.float64) tensor(0.5123, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4164, dtype=torch.float64) delta_t tensor(-0.0620, dtype=torch.float64)
2 gae_duplicate tensor(-0.2239, dtype=torch.float64) tensor(1.2778, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:29.811025619506836
value loss:5.753304481506348
entropies:355.9452819824219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.870881795883179 seconds
19 rew tensor(0.8182, dtype=torch.float64) delta_t tensor(-0.0785, dtype=torch.float64)
19 gae_duplicate tensor(-0.0934, dtype=torch.float64) tensor(1.5530, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8189, dtype=torch.float64) delta_t tensor(0.0176, dtype=torch.float64)
18 gae_duplicate tensor(-0.0111, dtype=torch.float64) tensor(-0.1935, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8195, dtype=torch.float64) delta_t tensor(0.0201, dtype=torch.float64)
17 gae_duplicate tensor(0.0040, dtype=torch.float64) tensor(-0.4155, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8202, dtype=torch.float64) delta_t tensor(0.0019, dtype=torch.float64)
16 gae_duplicate tensor(-0.0047, dtype=torch.float64) tensor(-0.0786, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8208, dtype=torch.float64) delta_t tensor(-0.0045, dtype=torch.float64)
15 gae_duplicate tensor(-0.0151, dtype=torch.float64) tensor(0.0802, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8215, dtype=torch.float64) delta_t tensor(-0.0065, dtype=torch.float64)
14 gae_duplicate tensor(-0.0247, dtype=torch.float64) tensor(0.1374, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8221, dtype=torch.float64) delta_t tensor(0.0076, dtype=torch.float64)
13 gae_duplicate tensor(-0.0058, dtype=torch.float64) tensor(-0.1377, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8228, dtype=torch.float64) delta_t tensor(0.0431, dtype=torch.float64)
12 gae_duplicate tensor(0.0149, dtype=torch.float64) tensor(-0.8686, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8234, dtype=torch.float64) delta_t tensor(0.0573, dtype=torch.float64)
11 gae_duplicate tensor(0.0343, dtype=torch.float64) tensor(-1.2175, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8241, dtype=torch.float64) delta_t tensor(0.1523, dtype=torch.float64)
10 gae_duplicate tensor(0.0315, dtype=torch.float64) tensor(-3.1271, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3815, dtype=torch.float64) delta_t tensor(-0.1131, dtype=torch.float64)
9 gae_duplicate tensor(-0.2377, dtype=torch.float64) tensor(1.9206, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1917, dtype=torch.float64) delta_t tensor(0.0556, dtype=torch.float64)
8 gae_duplicate tensor(-0.1165, dtype=torch.float64) tensor(-0.9084, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0135, dtype=torch.float64) delta_t tensor(-0.1153, dtype=torch.float64)
7 gae_duplicate tensor(-0.3095, dtype=torch.float64) tensor(2.1948, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2499, dtype=torch.float64) delta_t tensor(-0.1095, dtype=torch.float64)
6 gae_duplicate tensor(-0.3331, dtype=torch.float64) tensor(2.3814, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7972, dtype=torch.float64) delta_t tensor(0.3795, dtype=torch.float64)
5 gae_duplicate tensor(0.1560, dtype=torch.float64) tensor(-7.2629, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9769, dtype=torch.float64) delta_t tensor(-0.4069, dtype=torch.float64)
4 gae_duplicate tensor(-1.0006, dtype=torch.float64) tensor(7.3226, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7917, dtype=torch.float64) delta_t tensor(0.1486, dtype=torch.float64)
3 gae_duplicate tensor(-0.2607, dtype=torch.float64) tensor(-2.2075, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6061, dtype=torch.float64) delta_t tensor(0.0008, dtype=torch.float64)
2 gae_duplicate tensor(-0.2395, dtype=torch.float64) tensor(-0.2367, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-38.64292907714844
value loss:5.1697001457214355
entropies:355.946044921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.873463153839111 seconds
19 rew tensor(0.8186, dtype=torch.float64) delta_t tensor(-0.0753, dtype=torch.float64)
19 gae_duplicate tensor(-0.1365, dtype=torch.float64) tensor(1.4898, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8192, dtype=torch.float64) delta_t tensor(0.0050, dtype=torch.float64)
18 gae_duplicate tensor(-0.0287, dtype=torch.float64) tensor(0.0488, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8199, dtype=torch.float64) delta_t tensor(0.0322, dtype=torch.float64)
17 gae_duplicate tensor(-0.0188, dtype=torch.float64) tensor(-0.6335, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8205, dtype=torch.float64) delta_t tensor(0.0126, dtype=torch.float64)
16 gae_duplicate tensor(-0.0285, dtype=torch.float64) tensor(-0.3131, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8211, dtype=torch.float64) delta_t tensor(-9.4105e-05, dtype=torch.float64)
15 gae_duplicate tensor(-0.0397, dtype=torch.float64) tensor(-0.0302, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8218, dtype=torch.float64) delta_t tensor(0.0025, dtype=torch.float64)
14 gae_duplicate tensor(-0.0382, dtype=torch.float64) tensor(-0.0521, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8224, dtype=torch.float64) delta_t tensor(-0.0007, dtype=torch.float64)
13 gae_duplicate tensor(-0.0425, dtype=torch.float64) tensor(0.0090, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8231, dtype=torch.float64) delta_t tensor(0.0348, dtype=torch.float64)
12 gae_duplicate tensor(-0.0124, dtype=torch.float64) tensor(-0.6879, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8237, dtype=torch.float64) delta_t tensor(0.0802, dtype=torch.float64)
11 gae_duplicate tensor(-0.0097, dtype=torch.float64) tensor(-1.6521, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8244, dtype=torch.float64) delta_t tensor(0.1723, dtype=torch.float64)
10 gae_duplicate tensor(0.0157, dtype=torch.float64) tensor(-3.5754, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3813, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
9 gae_duplicate tensor(-0.1361, dtype=torch.float64) tensor(-1.4237, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1078, dtype=torch.float64) delta_t tensor(0.0579, dtype=torch.float64)
8 gae_duplicate tensor(-0.0054, dtype=torch.float64) tensor(-1.2885, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1657, dtype=torch.float64) delta_t tensor(-0.1445, dtype=torch.float64)
7 gae_duplicate tensor(-0.3215, dtype=torch.float64) tensor(2.7277, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4183, dtype=torch.float64) delta_t tensor(0.1160, dtype=torch.float64)
6 gae_duplicate tensor(-0.1823, dtype=torch.float64) tensor(-2.0193, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9663, dtype=torch.float64) delta_t tensor(0.3130, dtype=torch.float64)
5 gae_duplicate tensor(0.2146, dtype=torch.float64) tensor(-6.3896, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9157, dtype=torch.float64) delta_t tensor(-0.2233, dtype=torch.float64)
4 gae_duplicate tensor(-0.4083, dtype=torch.float64) tensor(3.7759, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6463, dtype=torch.float64) delta_t tensor(0.1284, dtype=torch.float64)
3 gae_duplicate tensor(-0.0522, dtype=torch.float64) tensor(-2.1650, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3753, dtype=torch.float64) delta_t tensor(0.0256, dtype=torch.float64)
2 gae_duplicate tensor(-0.1268, dtype=torch.float64) tensor(-0.7241, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:600.672607421875
value loss:4.375661373138428
entropies:355.9464111328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.883937835693359 seconds
19 rew tensor(0.8184, dtype=torch.float64) delta_t tensor(-0.0845, dtype=torch.float64)
19 gae_duplicate tensor(-0.1145, dtype=torch.float64) tensor(1.6732, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(-0.0069, dtype=torch.float64)
18 gae_duplicate tensor(-0.0286, dtype=torch.float64) tensor(0.3022, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8197, dtype=torch.float64) delta_t tensor(-0.0004, dtype=torch.float64)
17 gae_duplicate tensor(-0.0377, dtype=torch.float64) tensor(0.0383, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8098, dtype=torch.float64) delta_t tensor(-0.0169, dtype=torch.float64)
16 gae_duplicate tensor(-0.0660, dtype=torch.float64) tensor(0.3392, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8104, dtype=torch.float64) delta_t tensor(-0.0397, dtype=torch.float64)
15 gae_duplicate tensor(-0.0776, dtype=torch.float64) tensor(0.8212, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8215, dtype=torch.float64) delta_t tensor(-0.0195, dtype=torch.float64)
14 gae_duplicate tensor(-0.0516, dtype=torch.float64) tensor(0.4669, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8222, dtype=torch.float64) delta_t tensor(-0.0269, dtype=torch.float64)
13 gae_duplicate tensor(-0.0661, dtype=torch.float64) tensor(0.5799, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8228, dtype=torch.float64) delta_t tensor(-0.0100, dtype=torch.float64)
12 gae_duplicate tensor(-0.0486, dtype=torch.float64) tensor(0.2547, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8234, dtype=torch.float64) delta_t tensor(0.0169, dtype=torch.float64)
11 gae_duplicate tensor(-0.0323, dtype=torch.float64) tensor(-0.3070, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8241, dtype=torch.float64) delta_t tensor(0.1674, dtype=torch.float64)
10 gae_duplicate tensor(0.0541, dtype=torch.float64) tensor(-3.3346, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3922, dtype=torch.float64) delta_t tensor(-0.1100, dtype=torch.float64)
9 gae_duplicate tensor(-0.2765, dtype=torch.float64) tensor(1.8405, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1709, dtype=torch.float64) delta_t tensor(0.0314, dtype=torch.float64)
8 gae_duplicate tensor(-0.1893, dtype=torch.float64) tensor(-0.4390, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0609, dtype=torch.float64) delta_t tensor(-0.1378, dtype=torch.float64)
7 gae_duplicate tensor(-0.3283, dtype=torch.float64) tensor(2.6870, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3977, dtype=torch.float64) delta_t tensor(-0.0916, dtype=torch.float64)
6 gae_duplicate tensor(-0.5210, dtype=torch.float64) tensor(2.0765, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9560, dtype=torch.float64) delta_t tensor(0.2085, dtype=torch.float64)
5 gae_duplicate tensor(-0.0655, dtype=torch.float64) tensor(-3.9184, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8742, dtype=torch.float64) delta_t tensor(-0.3345, dtype=torch.float64)
4 gae_duplicate tensor(-0.6397, dtype=torch.float64) tensor(6.2216, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8784, dtype=torch.float64) delta_t tensor(0.0019, dtype=torch.float64)
3 gae_duplicate tensor(-0.5406, dtype=torch.float64) tensor(0.5777, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6505, dtype=torch.float64) delta_t tensor(-0.2104, dtype=torch.float64)
2 gae_duplicate tensor(-0.7572, dtype=torch.float64) tensor(4.2307, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-858.0817260742188
value loss:7.220224380493164
entropies:355.94647216796875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3953.9897)
ToM Target loss= tensor(3629.0820)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.05927300453186 seconds
19 rew tensor(0.8185, dtype=torch.float64) delta_t tensor(-0.1318, dtype=torch.float64)
19 gae_duplicate tensor(-0.1609, dtype=torch.float64) tensor(2.6067, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(-0.0384, dtype=torch.float64)
18 gae_duplicate tensor(-0.0697, dtype=torch.float64) tensor(1.0206, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8198, dtype=torch.float64) delta_t tensor(-0.0263, dtype=torch.float64)
17 gae_duplicate tensor(-0.0582, dtype=torch.float64) tensor(0.6227, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8204, dtype=torch.float64) delta_t tensor(-0.0495, dtype=torch.float64)
16 gae_duplicate tensor(-0.0647, dtype=torch.float64) tensor(1.0430, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8210, dtype=torch.float64) delta_t tensor(-0.0552, dtype=torch.float64)
15 gae_duplicate tensor(-0.0784, dtype=torch.float64) tensor(1.1959, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8216, dtype=torch.float64) delta_t tensor(-0.0510, dtype=torch.float64)
14 gae_duplicate tensor(-0.0701, dtype=torch.float64) tensor(1.1293, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8222, dtype=torch.float64) delta_t tensor(-0.0412, dtype=torch.float64)
13 gae_duplicate tensor(-0.0815, dtype=torch.float64) tensor(0.9302, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8228, dtype=torch.float64) delta_t tensor(-0.0109, dtype=torch.float64)
12 gae_duplicate tensor(-0.0429, dtype=torch.float64) tensor(0.3095, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8235, dtype=torch.float64) delta_t tensor(0.0077, dtype=torch.float64)
11 gae_duplicate tensor(-0.0512, dtype=torch.float64) tensor(-0.1218, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8241, dtype=torch.float64) delta_t tensor(0.1183, dtype=torch.float64)
10 gae_duplicate tensor(-0.0046, dtype=torch.float64) tensor(-2.3511, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3396, dtype=torch.float64) delta_t tensor(-0.2250, dtype=torch.float64)
9 gae_duplicate tensor(-0.4501, dtype=torch.float64) tensor(4.2107, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1923, dtype=torch.float64) delta_t tensor(-0.0132, dtype=torch.float64)
8 gae_duplicate tensor(-0.2919, dtype=torch.float64) tensor(0.6840, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0237, dtype=torch.float64) delta_t tensor(-0.1301, dtype=torch.float64)
7 gae_duplicate tensor(-0.1977, dtype=torch.float64) tensor(2.6388, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2817, dtype=torch.float64) delta_t tensor(-0.1017, dtype=torch.float64)
6 gae_duplicate tensor(-0.3600, dtype=torch.float64) tensor(2.2814, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7977, dtype=torch.float64) delta_t tensor(0.4157, dtype=torch.float64)
5 gae_duplicate tensor(0.2063, dtype=torch.float64) tensor(-7.9947, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8305, dtype=torch.float64) delta_t tensor(-0.1799, dtype=torch.float64)
4 gae_duplicate tensor(-0.2397, dtype=torch.float64) tensor(2.7591, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7711, dtype=torch.float64) delta_t tensor(0.1727, dtype=torch.float64)
3 gae_duplicate tensor(0.0563, dtype=torch.float64) tensor(-3.1412, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5528, dtype=torch.float64) delta_t tensor(0.0156, dtype=torch.float64)
2 gae_duplicate tensor(-0.2728, dtype=torch.float64) tensor(-0.6191, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-485.1153869628906
value loss:4.2715606689453125
entropies:355.9466857910156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.383170127868652 seconds
19 rew tensor(0.8186, dtype=torch.float64) delta_t tensor(-0.1420, dtype=torch.float64)
19 gae_duplicate tensor(-0.1758, dtype=torch.float64) tensor(2.8101, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8192, dtype=torch.float64) delta_t tensor(-0.0286, dtype=torch.float64)
18 gae_duplicate tensor(-0.0718, dtype=torch.float64) tensor(0.8480, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8198, dtype=torch.float64) delta_t tensor(0.0248, dtype=torch.float64)
17 gae_duplicate tensor(-0.0290, dtype=torch.float64) tensor(-0.4062, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8204, dtype=torch.float64) delta_t tensor(-0.0209, dtype=torch.float64)
16 gae_duplicate tensor(-0.0544, dtype=torch.float64) tensor(0.3728, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8210, dtype=torch.float64) delta_t tensor(-0.0320, dtype=torch.float64)
15 gae_duplicate tensor(-0.0593, dtype=torch.float64) tensor(0.6688, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8216, dtype=torch.float64) delta_t tensor(-0.0469, dtype=torch.float64)
14 gae_duplicate tensor(-0.0801, dtype=torch.float64) tensor(0.9950, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8222, dtype=torch.float64) delta_t tensor(-0.0603, dtype=torch.float64)
13 gae_duplicate tensor(-0.0794, dtype=torch.float64) tensor(1.2935, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8228, dtype=torch.float64) delta_t tensor(-0.0382, dtype=torch.float64)
12 gae_duplicate tensor(-0.0983, dtype=torch.float64) tensor(0.8846, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8234, dtype=torch.float64) delta_t tensor(-0.0011, dtype=torch.float64)
11 gae_duplicate tensor(-0.0729, dtype=torch.float64) tensor(0.1113, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8240, dtype=torch.float64) delta_t tensor(0.0775, dtype=torch.float64)
10 gae_duplicate tensor(-0.0202, dtype=torch.float64) tensor(-1.5243, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4968, dtype=torch.float64) delta_t tensor(-0.0194, dtype=torch.float64)
9 gae_duplicate tensor(-0.1216, dtype=torch.float64) tensor(0.2337, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2121, dtype=torch.float64) delta_t tensor(0.1789, dtype=torch.float64)
8 gae_duplicate tensor(0.0523, dtype=torch.float64) tensor(-3.5088, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0938, dtype=torch.float64) delta_t tensor(-0.0982, dtype=torch.float64)
7 gae_duplicate tensor(-0.2363, dtype=torch.float64) tensor(1.5876, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3999, dtype=torch.float64) delta_t tensor(0.1428, dtype=torch.float64)
6 gae_duplicate tensor(-0.0698, dtype=torch.float64) tensor(-2.6618, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9062, dtype=torch.float64) delta_t tensor(0.4993, dtype=torch.float64)
5 gae_duplicate tensor(0.3305, dtype=torch.float64) tensor(-10.1418, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8348, dtype=torch.float64) delta_t tensor(-0.0943, dtype=torch.float64)
4 gae_duplicate tensor(-0.3147, dtype=torch.float64) tensor(0.8510, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5850, dtype=torch.float64) delta_t tensor(0.0705, dtype=torch.float64)
3 gae_duplicate tensor(-0.1836, dtype=torch.float64) tensor(-1.3081, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.2707, dtype=torch.float64) delta_t tensor(-0.0173, dtype=torch.float64)
2 gae_duplicate tensor(-0.1925, dtype=torch.float64) tensor(0.2091, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:372.912109375
value loss:5.313730239868164
entropies:355.94525146484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.448369264602661 seconds
19 rew tensor(0.8187, dtype=torch.float64) delta_t tensor(-0.1125, dtype=torch.float64)
19 gae_duplicate tensor(-0.1236, dtype=torch.float64) tensor(2.2177, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8193, dtype=torch.float64) delta_t tensor(-0.0095, dtype=torch.float64)
18 gae_duplicate tensor(-0.0305, dtype=torch.float64) tensor(0.4118, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8199, dtype=torch.float64) delta_t tensor(-0.0081, dtype=torch.float64)
17 gae_duplicate tensor(-0.0371, dtype=torch.float64) tensor(0.2001, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8205, dtype=torch.float64) delta_t tensor(-0.0280, dtype=torch.float64)
16 gae_duplicate tensor(-0.0579, dtype=torch.float64) tensor(0.5727, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8211, dtype=torch.float64) delta_t tensor(-0.0280, dtype=torch.float64)
15 gae_duplicate tensor(-0.0676, dtype=torch.float64) tensor(0.6135, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8217, dtype=torch.float64) delta_t tensor(-0.0331, dtype=torch.float64)
14 gae_duplicate tensor(-0.0550, dtype=torch.float64) tensor(0.7128, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8223, dtype=torch.float64) delta_t tensor(-0.0306, dtype=torch.float64)
13 gae_duplicate tensor(-0.0616, dtype=torch.float64) tensor(0.6776, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8229, dtype=torch.float64) delta_t tensor(-0.0040, dtype=torch.float64)
12 gae_duplicate tensor(-0.0245, dtype=torch.float64) tensor(0.1461, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8021, dtype=torch.float64) delta_t tensor(0.0140, dtype=torch.float64)
11 gae_duplicate tensor(-0.1157, dtype=torch.float64) tensor(-0.2650, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7920, dtype=torch.float64) delta_t tensor(0.1349, dtype=torch.float64)
10 gae_duplicate tensor(-0.0883, dtype=torch.float64) tensor(-2.6956, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4020, dtype=torch.float64) delta_t tensor(-0.0848, dtype=torch.float64)
9 gae_duplicate tensor(-0.2339, dtype=torch.float64) tensor(1.4128, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1173, dtype=torch.float64) delta_t tensor(0.0156, dtype=torch.float64)
8 gae_duplicate tensor(-0.2069, dtype=torch.float64) tensor(-0.1707, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1152, dtype=torch.float64) delta_t tensor(-0.1983, dtype=torch.float64)
7 gae_duplicate tensor(-0.3064, dtype=torch.float64) tensor(3.9036, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3790, dtype=torch.float64) delta_t tensor(0.0250, dtype=torch.float64)
6 gae_duplicate tensor(-0.3884, dtype=torch.float64) tensor(-0.1009, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8855, dtype=torch.float64) delta_t tensor(0.3016, dtype=torch.float64)
5 gae_duplicate tensor(-0.0405, dtype=torch.float64) tensor(-5.9673, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9189, dtype=torch.float64) delta_t tensor(-0.2560, dtype=torch.float64)
4 gae_duplicate tensor(-0.5357, dtype=torch.float64) tensor(4.4701, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7555, dtype=torch.float64) delta_t tensor(0.1151, dtype=torch.float64)
3 gae_duplicate tensor(-0.0619, dtype=torch.float64) tensor(-1.8324, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5050, dtype=torch.float64) delta_t tensor(-0.0113, dtype=torch.float64)
2 gae_duplicate tensor(-0.2286, dtype=torch.float64) tensor(0.0387, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-330.7669372558594
value loss:4.182547092437744
entropies:355.9397277832031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.689871788024902 seconds
19 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(-0.1200, dtype=torch.float64)
19 gae_duplicate tensor(-0.1436, dtype=torch.float64) tensor(2.3708, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8196, dtype=torch.float64) delta_t tensor(-0.0195, dtype=torch.float64)
18 gae_duplicate tensor(-0.0505, dtype=torch.float64) tensor(0.6256, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8202, dtype=torch.float64) delta_t tensor(-0.0081, dtype=torch.float64)
17 gae_duplicate tensor(-0.0632, dtype=torch.float64) tensor(0.2233, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8208, dtype=torch.float64) delta_t tensor(-0.0238, dtype=torch.float64)
16 gae_duplicate tensor(-0.0443, dtype=torch.float64) tensor(0.4924, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8214, dtype=torch.float64) delta_t tensor(-0.0246, dtype=torch.float64)
15 gae_duplicate tensor(-0.0577, dtype=torch.float64) tensor(0.5352, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8220, dtype=torch.float64) delta_t tensor(-0.0290, dtype=torch.float64)
14 gae_duplicate tensor(-0.0570, dtype=torch.float64) tensor(0.6263, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8226, dtype=torch.float64) delta_t tensor(-0.0221, dtype=torch.float64)
13 gae_duplicate tensor(-0.0990, dtype=torch.float64) tensor(0.5034, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8231, dtype=torch.float64) delta_t tensor(-0.0022, dtype=torch.float64)
12 gae_duplicate tensor(-0.0400, dtype=torch.float64) tensor(0.0980, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8237, dtype=torch.float64) delta_t tensor(0.0179, dtype=torch.float64)
11 gae_duplicate tensor(-0.0444, dtype=torch.float64) tensor(-0.3447, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8243, dtype=torch.float64) delta_t tensor(0.1699, dtype=torch.float64)
10 gae_duplicate tensor(0.0654, dtype=torch.float64) tensor(-3.4020, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2758, dtype=torch.float64) delta_t tensor(-0.1990, dtype=torch.float64)
9 gae_duplicate tensor(-0.3016, dtype=torch.float64) tensor(3.5794, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1280, dtype=torch.float64) delta_t tensor(0.0191, dtype=torch.float64)
8 gae_duplicate tensor(-0.1328, dtype=torch.float64) tensor(-0.0182, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1041, dtype=torch.float64) delta_t tensor(-0.2049, dtype=torch.float64)
7 gae_duplicate tensor(-0.2782, dtype=torch.float64) tensor(4.0368, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3680, dtype=torch.float64) delta_t tensor(-0.0993, dtype=torch.float64)
6 gae_duplicate tensor(-0.4222, dtype=torch.float64) tensor(2.3741, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9058, dtype=torch.float64) delta_t tensor(0.3257, dtype=torch.float64)
5 gae_duplicate tensor(0.0877, dtype=torch.float64) tensor(-6.2047, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9179, dtype=torch.float64) delta_t tensor(-0.1911, dtype=torch.float64)
4 gae_duplicate tensor(-0.4173, dtype=torch.float64) tensor(3.1562, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8167, dtype=torch.float64) delta_t tensor(0.1407, dtype=torch.float64)
3 gae_duplicate tensor(0.0064, dtype=torch.float64) tensor(-2.4641, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5662, dtype=torch.float64) delta_t tensor(0.0740, dtype=torch.float64)
2 gae_duplicate tensor(-0.1042, dtype=torch.float64) tensor(-1.7095, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-337.9288330078125
value loss:4.449388027191162
entropies:355.9332580566406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.802484035491943 seconds
19 rew tensor(0.8193, dtype=torch.float64) delta_t tensor(-0.0820, dtype=torch.float64)
19 gae_duplicate tensor(-0.1082, dtype=torch.float64) tensor(1.6189, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8199, dtype=torch.float64) delta_t tensor(0.0099, dtype=torch.float64)
18 gae_duplicate tensor(-0.0063, dtype=torch.float64) tensor(-0.0346, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8204, dtype=torch.float64) delta_t tensor(0.0148, dtype=torch.float64)
17 gae_duplicate tensor(-0.0102, dtype=torch.float64) tensor(-0.2940, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8103, dtype=torch.float64) delta_t tensor(-0.0101, dtype=torch.float64)
16 gae_duplicate tensor(-0.0491, dtype=torch.float64) tensor(0.1710, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8109, dtype=torch.float64) delta_t tensor(-0.0297, dtype=torch.float64)
15 gae_duplicate tensor(-0.0572, dtype=torch.float64) tensor(0.6025, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8221, dtype=torch.float64) delta_t tensor(-0.0225, dtype=torch.float64)
14 gae_duplicate tensor(-0.0426, dtype=torch.float64) tensor(0.5066, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8227, dtype=torch.float64) delta_t tensor(-0.0188, dtype=torch.float64)
13 gae_duplicate tensor(-0.0461, dtype=torch.float64) tensor(0.4244, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8233, dtype=torch.float64) delta_t tensor(0.0262, dtype=torch.float64)
12 gae_duplicate tensor(-0.0148, dtype=torch.float64) tensor(-0.4779, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8239, dtype=torch.float64) delta_t tensor(0.0492, dtype=torch.float64)
11 gae_duplicate tensor(0.0196, dtype=torch.float64) tensor(-1.0184, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7925, dtype=torch.float64) delta_t tensor(0.1195, dtype=torch.float64)
10 gae_duplicate tensor(0.0281, dtype=torch.float64) tensor(-2.4704, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3492, dtype=torch.float64) delta_t tensor(-0.1379, dtype=torch.float64)
9 gae_duplicate tensor(-0.6044, dtype=torch.float64) tensor(2.4790, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0854, dtype=torch.float64) delta_t tensor(0.0310, dtype=torch.float64)
8 gae_duplicate tensor(-0.4718, dtype=torch.float64) tensor(-0.3576, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1251, dtype=torch.float64) delta_t tensor(-0.1601, dtype=torch.float64)
7 gae_duplicate tensor(-0.3283, dtype=torch.float64) tensor(3.1342, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3996, dtype=torch.float64) delta_t tensor(-0.0134, dtype=torch.float64)
6 gae_duplicate tensor(-0.5297, dtype=torch.float64) tensor(0.5713, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9476, dtype=torch.float64) delta_t tensor(0.3212, dtype=torch.float64)
5 gae_duplicate tensor(-0.1488, dtype=torch.float64) tensor(-6.2864, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0020, dtype=torch.float64) delta_t tensor(-0.2026, dtype=torch.float64)
4 gae_duplicate tensor(-0.4251, dtype=torch.float64) tensor(3.3723, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8382, dtype=torch.float64) delta_t tensor(0.0750, dtype=torch.float64)
3 gae_duplicate tensor(-0.3132, dtype=torch.float64) tensor(-1.1396, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5882, dtype=torch.float64) delta_t tensor(-0.0270, dtype=torch.float64)
2 gae_duplicate tensor(-0.5047, dtype=torch.float64) tensor(0.4235, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-162.2487030029297
value loss:5.466104507446289
entropies:355.9374084472656
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3954.8372)
ToM Target loss= tensor(3628.8774)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.752360105514526 seconds
19 rew tensor(0.8088, dtype=torch.float64) delta_t tensor(-0.0662, dtype=torch.float64)
19 gae_duplicate tensor(-0.0810, dtype=torch.float64) tensor(1.3042, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8093, dtype=torch.float64) delta_t tensor(0.0172, dtype=torch.float64)
18 gae_duplicate tensor(-0.0189, dtype=torch.float64) tensor(-0.2096, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8099, dtype=torch.float64) delta_t tensor(0.0207, dtype=torch.float64)
17 gae_duplicate tensor(0.0096, dtype=torch.float64) tensor(-0.4298, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7998, dtype=torch.float64) delta_t tensor(-0.0090, dtype=torch.float64)
16 gae_duplicate tensor(-0.0645, dtype=torch.float64) tensor(0.1340, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8004, dtype=torch.float64) delta_t tensor(-0.0122, dtype=torch.float64)
15 gae_duplicate tensor(-0.0382, dtype=torch.float64) tensor(0.2549, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8221, dtype=torch.float64) delta_t tensor(-0.0005, dtype=torch.float64)
14 gae_duplicate tensor(-0.0206, dtype=torch.float64) tensor(0.0354, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8227, dtype=torch.float64) delta_t tensor(0.0058, dtype=torch.float64)
13 gae_duplicate tensor(-0.0131, dtype=torch.float64) tensor(-0.1101, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8233, dtype=torch.float64) delta_t tensor(0.0455, dtype=torch.float64)
12 gae_duplicate tensor(0.0212, dtype=torch.float64) tensor(-0.9108, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8238, dtype=torch.float64) delta_t tensor(0.0673, dtype=torch.float64)
11 gae_duplicate tensor(0.0353, dtype=torch.float64) tensor(-1.4104, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8244, dtype=torch.float64) delta_t tensor(0.1861, dtype=torch.float64)
10 gae_duplicate tensor(0.1335, dtype=torch.float64) tensor(-3.8295, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4242, dtype=torch.float64) delta_t tensor(-0.0332, dtype=torch.float64)
9 gae_duplicate tensor(-0.1009, dtype=torch.float64) tensor(0.2759, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1074, dtype=torch.float64) delta_t tensor(0.0485, dtype=torch.float64)
8 gae_duplicate tensor(-0.2352, dtype=torch.float64) tensor(-0.9252, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1035, dtype=torch.float64) delta_t tensor(-0.1689, dtype=torch.float64)
7 gae_duplicate tensor(-0.3437, dtype=torch.float64) tensor(3.2508, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3563, dtype=torch.float64) delta_t tensor(0.0253, dtype=torch.float64)
6 gae_duplicate tensor(-0.1009, dtype=torch.float64) tensor(-0.1787, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8618, dtype=torch.float64) delta_t tensor(0.3768, dtype=torch.float64)
5 gae_duplicate tensor(0.2394, dtype=torch.float64) tensor(-7.4605, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.0213, dtype=torch.float64) delta_t tensor(-0.2600, dtype=torch.float64)
4 gae_duplicate tensor(-0.6361, dtype=torch.float64) tensor(4.3954, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8134, dtype=torch.float64) delta_t tensor(0.0814, dtype=torch.float64)
3 gae_duplicate tensor(-0.0970, dtype=torch.float64) tensor(-1.1694, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5741, dtype=torch.float64) delta_t tensor(-0.0045, dtype=torch.float64)
2 gae_duplicate tensor(-0.2347, dtype=torch.float64) tensor(-0.0226, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:282.22930908203125
value loss:4.104175567626953
entropies:355.9361877441406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9319517612457275 seconds
19 rew tensor(0.8193, dtype=torch.float64) delta_t tensor(-0.0781, dtype=torch.float64)
19 gae_duplicate tensor(-0.1532, dtype=torch.float64) tensor(1.5438, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8198, dtype=torch.float64) delta_t tensor(0.0295, dtype=torch.float64)
18 gae_duplicate tensor(-0.0028, dtype=torch.float64) tensor(-0.4253, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8204, dtype=torch.float64) delta_t tensor(0.0472, dtype=torch.float64)
17 gae_duplicate tensor(0.0191, dtype=torch.float64) tensor(-0.9785, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8209, dtype=torch.float64) delta_t tensor(0.0237, dtype=torch.float64)
16 gae_duplicate tensor(-0.0067, dtype=torch.float64) tensor(-0.5665, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8215, dtype=torch.float64) delta_t tensor(0.0129, dtype=torch.float64)
15 gae_duplicate tensor(-0.0204, dtype=torch.float64) tensor(-0.3094, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8220, dtype=torch.float64) delta_t tensor(-0.0060, dtype=torch.float64)
14 gae_duplicate tensor(-0.0103, dtype=torch.float64) tensor(0.0871, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8226, dtype=torch.float64) delta_t tensor(-0.0111, dtype=torch.float64)
13 gae_duplicate tensor(-0.0653, dtype=torch.float64) tensor(0.2290, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8232, dtype=torch.float64) delta_t tensor(0.0115, dtype=torch.float64)
12 gae_duplicate tensor(-0.0283, dtype=torch.float64) tensor(-0.2028, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8237, dtype=torch.float64) delta_t tensor(0.0468, dtype=torch.float64)
11 gae_duplicate tensor(0.0047, dtype=torch.float64) tensor(-0.9450, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8243, dtype=torch.float64) delta_t tensor(0.1462, dtype=torch.float64)
10 gae_duplicate tensor(0.0786, dtype=torch.float64) tensor(-2.9848, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4977, dtype=torch.float64) delta_t tensor(-0.0202, dtype=torch.float64)
9 gae_duplicate tensor(-0.1534, dtype=torch.float64) tensor(0.1003, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2340, dtype=torch.float64) delta_t tensor(0.1837, dtype=torch.float64)
8 gae_duplicate tensor(0.0780, dtype=torch.float64) tensor(-3.6106, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0184, dtype=torch.float64) delta_t tensor(-0.0459, dtype=torch.float64)
7 gae_duplicate tensor(-0.2503, dtype=torch.float64) tensor(0.5386, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3030, dtype=torch.float64) delta_t tensor(0.1434, dtype=torch.float64)
6 gae_duplicate tensor(-0.2848, dtype=torch.float64) tensor(-2.7776, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8622, dtype=torch.float64) delta_t tensor(0.5618, dtype=torch.float64)
5 gae_duplicate tensor(0.3608, dtype=torch.float64) tensor(-11.3812, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8551, dtype=torch.float64) delta_t tensor(-0.0448, dtype=torch.float64)
4 gae_duplicate tensor(-0.1943, dtype=torch.float64) tensor(-0.2579, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6051, dtype=torch.float64) delta_t tensor(0.1376, dtype=torch.float64)
3 gae_duplicate tensor(-0.0963, dtype=torch.float64) tensor(-2.7511, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3336, dtype=torch.float64) delta_t tensor(0.0569, dtype=torch.float64)
2 gae_duplicate tensor(-0.1175, dtype=torch.float64) tensor(-1.4011, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1312.92626953125
value loss:5.932657241821289
entropies:355.93035888671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.355370998382568 seconds
19 rew tensor(0.8090, dtype=torch.float64) delta_t tensor(-0.0631, dtype=torch.float64)
19 gae_duplicate tensor(-0.1294, dtype=torch.float64) tensor(1.2553, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8096, dtype=torch.float64) delta_t tensor(0.0251, dtype=torch.float64)
18 gae_duplicate tensor(-0.0493, dtype=torch.float64) tensor(-0.3689, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8101, dtype=torch.float64) delta_t tensor(0.0128, dtype=torch.float64)
17 gae_duplicate tensor(-0.0477, dtype=torch.float64) tensor(-0.2957, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8001, dtype=torch.float64) delta_t tensor(-0.0039, dtype=torch.float64)
16 gae_duplicate tensor(-0.0658, dtype=torch.float64) tensor(0.0511, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8006, dtype=torch.float64) delta_t tensor(-0.0081, dtype=torch.float64)
15 gae_duplicate tensor(-0.0735, dtype=torch.float64) tensor(0.1643, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8221, dtype=torch.float64) delta_t tensor(0.0119, dtype=torch.float64)
14 gae_duplicate tensor(-0.0033, dtype=torch.float64) tensor(-0.2194, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8227, dtype=torch.float64) delta_t tensor(0.0362, dtype=torch.float64)
13 gae_duplicate tensor(0.0029, dtype=torch.float64) tensor(-0.7318, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8232, dtype=torch.float64) delta_t tensor(0.0762, dtype=torch.float64)
12 gae_duplicate tensor(0.0335, dtype=torch.float64) tensor(-1.5755, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8238, dtype=torch.float64) delta_t tensor(0.0796, dtype=torch.float64)
11 gae_duplicate tensor(0.0364, dtype=torch.float64) tensor(-1.7314, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.2313, dtype=torch.float64)
10 gae_duplicate tensor(0.0657, dtype=torch.float64) tensor(-4.7448, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2762, dtype=torch.float64) delta_t tensor(-0.1313, dtype=torch.float64)
9 gae_duplicate tensor(-0.3989, dtype=torch.float64) tensor(2.1460, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0029, dtype=torch.float64) delta_t tensor(-0.0504, dtype=torch.float64)
8 gae_duplicate tensor(-0.3556, dtype=torch.float64) tensor(1.1889, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1660, dtype=torch.float64) delta_t tensor(-0.1800, dtype=torch.float64)
7 gae_duplicate tensor(-0.3146, dtype=torch.float64) tensor(3.7004, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4713, dtype=torch.float64) delta_t tensor(-0.0674, dtype=torch.float64)
6 gae_duplicate tensor(-0.4688, dtype=torch.float64) tensor(1.7005, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0295, dtype=torch.float64) delta_t tensor(0.2072, dtype=torch.float64)
5 gae_duplicate tensor(-0.1779, dtype=torch.float64) tensor(-3.9111, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-2.1456, dtype=torch.float64) delta_t tensor(-0.2800, dtype=torch.float64)
4 gae_duplicate tensor(-0.9784, dtype=torch.float64) tensor(5.1086, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.0451, dtype=torch.float64) delta_t tensor(-0.0248, dtype=torch.float64)
3 gae_duplicate tensor(-0.4038, dtype=torch.float64) tensor(1.0048, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7961, dtype=torch.float64) delta_t tensor(-0.1382, dtype=torch.float64)
2 gae_duplicate tensor(-0.5466, dtype=torch.float64) tensor(2.8536, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-398.2157287597656
value loss:6.9334797859191895
entropies:355.9115905761719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.767168045043945 seconds
19 rew tensor(0.8192, dtype=torch.float64) delta_t tensor(-0.0801, dtype=torch.float64)
19 gae_duplicate tensor(-0.1291, dtype=torch.float64) tensor(1.5682, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8197, dtype=torch.float64) delta_t tensor(0.0199, dtype=torch.float64)
18 gae_duplicate tensor(-0.0027, dtype=torch.float64) tensor(-0.2354, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8203, dtype=torch.float64) delta_t tensor(0.0343, dtype=torch.float64)
17 gae_duplicate tensor(0.0116, dtype=torch.float64) tensor(-0.7002, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7996, dtype=torch.float64) delta_t tensor(0.0031, dtype=torch.float64)
16 gae_duplicate tensor(-0.0443, dtype=torch.float64) tensor(-0.1278, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8001, dtype=torch.float64) delta_t tensor(-0.0086, dtype=torch.float64)
15 gae_duplicate tensor(-0.0517, dtype=torch.float64) tensor(0.1558, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8218, dtype=torch.float64) delta_t tensor(-0.0073, dtype=torch.float64)
14 gae_duplicate tensor(-0.0699, dtype=torch.float64) tensor(0.1619, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8224, dtype=torch.float64) delta_t tensor(0.0007, dtype=torch.float64)
13 gae_duplicate tensor(-0.0613, dtype=torch.float64) tensor(-0.0032, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8229, dtype=torch.float64) delta_t tensor(0.0110, dtype=torch.float64)
12 gae_duplicate tensor(-0.0880, dtype=torch.float64) tensor(-0.2209, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8234, dtype=torch.float64) delta_t tensor(0.0030, dtype=torch.float64)
11 gae_duplicate tensor(-0.0828, dtype=torch.float64) tensor(-0.0827, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6024, dtype=torch.float64) delta_t tensor(-0.0994, dtype=torch.float64)
10 gae_duplicate tensor(-1.1917, dtype=torch.float64) tensor(2.0088, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5188, dtype=torch.float64) delta_t tensor(-0.1191, dtype=torch.float64)
9 gae_duplicate tensor(-0.2559, dtype=torch.float64) tensor(2.5390, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3189, dtype=torch.float64) delta_t tensor(0.1297, dtype=torch.float64)
8 gae_duplicate tensor(-0.1082, dtype=torch.float64) tensor(-2.3093, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1505, dtype=torch.float64) delta_t tensor(0.0755, dtype=torch.float64)
7 gae_duplicate tensor(-0.0714, dtype=torch.float64) tensor(-1.7345, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2707, dtype=torch.float64) delta_t tensor(0.0306, dtype=torch.float64)
6 gae_duplicate tensor(-0.2976, dtype=torch.float64) tensor(-0.7563, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8073, dtype=torch.float64) delta_t tensor(0.3638, dtype=torch.float64)
5 gae_duplicate tensor(0.0314, dtype=torch.float64) tensor(-7.3092, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8705, dtype=torch.float64) delta_t tensor(-0.0332, dtype=torch.float64)
4 gae_duplicate tensor(-0.4281, dtype=torch.float64) tensor(-0.0883, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8960, dtype=torch.float64) delta_t tensor(0.0413, dtype=torch.float64)
3 gae_duplicate tensor(-0.3421, dtype=torch.float64) tensor(-0.8482, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6882, dtype=torch.float64) delta_t tensor(-0.1503, dtype=torch.float64)
2 gae_duplicate tensor(-0.4758, dtype=torch.float64) tensor(2.9036, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:178.1658172607422
value loss:7.395092964172363
entropies:355.8856201171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.26464319229126 seconds
19 rew tensor(0.8190, dtype=torch.float64) delta_t tensor(-0.0761, dtype=torch.float64)
19 gae_duplicate tensor(-0.1168, dtype=torch.float64) tensor(1.5018, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8195, dtype=torch.float64) delta_t tensor(0.0222, dtype=torch.float64)
18 gae_duplicate tensor(-0.0151, dtype=torch.float64) tensor(-0.2906, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8200, dtype=torch.float64) delta_t tensor(0.0435, dtype=torch.float64)
17 gae_duplicate tensor(0.0017, dtype=torch.float64) tensor(-0.8753, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8206, dtype=torch.float64) delta_t tensor(0.0193, dtype=torch.float64)
16 gae_duplicate tensor(-0.0114, dtype=torch.float64) tensor(-0.4637, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8211, dtype=torch.float64) delta_t tensor(-0.0013, dtype=torch.float64)
15 gae_duplicate tensor(-0.0261, dtype=torch.float64) tensor(-0.0225, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8216, dtype=torch.float64) delta_t tensor(-0.0192, dtype=torch.float64)
14 gae_duplicate tensor(-0.0600, dtype=torch.float64) tensor(0.3798, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8221, dtype=torch.float64) delta_t tensor(-0.0084, dtype=torch.float64)
13 gae_duplicate tensor(-0.0483, dtype=torch.float64) tensor(0.2007, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8227, dtype=torch.float64) delta_t tensor(-0.0004, dtype=torch.float64)
12 gae_duplicate tensor(-0.0577, dtype=torch.float64) tensor(0.0222, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8232, dtype=torch.float64) delta_t tensor(0.0221, dtype=torch.float64)
11 gae_duplicate tensor(-0.0377, dtype=torch.float64) tensor(-0.4402, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8237, dtype=torch.float64) delta_t tensor(0.1206, dtype=torch.float64)
10 gae_duplicate tensor(-0.0145, dtype=torch.float64) tensor(-2.4245, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4656, dtype=torch.float64) delta_t tensor(-0.0639, dtype=torch.float64)
9 gae_duplicate tensor(-0.1625, dtype=torch.float64) tensor(1.0147, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2445, dtype=torch.float64) delta_t tensor(0.1496, dtype=torch.float64)
8 gae_duplicate tensor(0.0563, dtype=torch.float64) tensor(-2.8780, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0549, dtype=torch.float64) delta_t tensor(0.0089, dtype=torch.float64)
7 gae_duplicate tensor(-0.1416, dtype=torch.float64) tensor(-0.4425, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1983, dtype=torch.float64) delta_t tensor(0.1897, dtype=torch.float64)
6 gae_duplicate tensor(-0.2434, dtype=torch.float64) tensor(-3.7564, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7567, dtype=torch.float64) delta_t tensor(0.4614, dtype=torch.float64)
5 gae_duplicate tensor(0.1883, dtype=torch.float64) tensor(-9.4742, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8713, dtype=torch.float64) delta_t tensor(-0.1221, dtype=torch.float64)
4 gae_duplicate tensor(-0.3414, dtype=torch.float64) tensor(1.4773, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6428, dtype=torch.float64) delta_t tensor(0.1207, dtype=torch.float64)
3 gae_duplicate tensor(-0.0707, dtype=torch.float64) tensor(-2.2344, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4346, dtype=torch.float64) delta_t tensor(0.0354, dtype=torch.float64)
2 gae_duplicate tensor(-0.1943, dtype=torch.float64) tensor(-0.8936, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:962.2914428710938
value loss:5.280049800872803
entropies:355.87554931640625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3957.5874)
ToM Target loss= tensor(3636.7046)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.107990026473999 seconds
19 rew tensor(0.8192, dtype=torch.float64) delta_t tensor(-0.1057, dtype=torch.float64)
19 gae_duplicate tensor(-0.1208, dtype=torch.float64) tensor(2.0961, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8197, dtype=torch.float64) delta_t tensor(-0.0085, dtype=torch.float64)
18 gae_duplicate tensor(-0.0344, dtype=torch.float64) tensor(0.3786, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8203, dtype=torch.float64) delta_t tensor(0.0024, dtype=torch.float64)
17 gae_duplicate tensor(-0.0243, dtype=torch.float64) tensor(-0.0142, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8208, dtype=torch.float64) delta_t tensor(-0.0123, dtype=torch.float64)
16 gae_duplicate tensor(-0.0210, dtype=torch.float64) tensor(0.2434, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8213, dtype=torch.float64) delta_t tensor(-0.0231, dtype=torch.float64)
15 gae_duplicate tensor(-0.0593, dtype=torch.float64) tensor(0.4757, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8218, dtype=torch.float64) delta_t tensor(-0.0210, dtype=torch.float64)
14 gae_duplicate tensor(-0.0423, dtype=torch.float64) tensor(0.4634, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8223, dtype=torch.float64) delta_t tensor(-0.0065, dtype=torch.float64)
13 gae_duplicate tensor(-0.0409, dtype=torch.float64) tensor(0.1716, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8229, dtype=torch.float64) delta_t tensor(0.0180, dtype=torch.float64)
12 gae_duplicate tensor(-0.0369, dtype=torch.float64) tensor(-0.3438, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8234, dtype=torch.float64) delta_t tensor(0.0109, dtype=torch.float64)
11 gae_duplicate tensor(-0.0692, dtype=torch.float64) tensor(-0.2470, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8239, dtype=torch.float64) delta_t tensor(0.1477, dtype=torch.float64)
10 gae_duplicate tensor(-0.0230, dtype=torch.float64) tensor(-2.9597, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3188, dtype=torch.float64) delta_t tensor(-0.2080, dtype=torch.float64)
9 gae_duplicate tensor(-0.2676, dtype=torch.float64) tensor(3.8036, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1081, dtype=torch.float64) delta_t tensor(-0.0003, dtype=torch.float64)
8 gae_duplicate tensor(-0.4065, dtype=torch.float64) tensor(0.3794, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0606, dtype=torch.float64) delta_t tensor(-0.0740, dtype=torch.float64)
7 gae_duplicate tensor(-0.2684, dtype=torch.float64) tensor(1.5071, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4501, dtype=torch.float64) delta_t tensor(-0.1220, dtype=torch.float64)
6 gae_duplicate tensor(-0.3424, dtype=torch.float64) tensor(2.5448, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0089, dtype=torch.float64) delta_t tensor(0.1293, dtype=torch.float64)
5 gae_duplicate tensor(-0.1431, dtype=torch.float64) tensor(-2.3174, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8526, dtype=torch.float64) delta_t tensor(0.0272, dtype=torch.float64)
4 gae_duplicate tensor(-0.5311, dtype=torch.float64) tensor(-0.7879, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8125, dtype=torch.float64) delta_t tensor(0.0251, dtype=torch.float64)
3 gae_duplicate tensor(-0.1652, dtype=torch.float64) tensor(-0.5710, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5628, dtype=torch.float64) delta_t tensor(-0.1369, dtype=torch.float64)
2 gae_duplicate tensor(-0.3297, dtype=torch.float64) tensor(2.6582, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-500.0400085449219
value loss:3.927417278289795
entropies:355.8161926269531
Policy training finished
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt