obs <crafter.objects.Shelter object at 0x144a43910> 0 [39.  0.  0.  0. 39.  0.  0.  0. 16.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x1262bbe80> 0 [38.  0.  0.  0. 37.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x144a494f0> 0 [ 9.  0.  0.  0.  9.  0.  0.  0. 12.  0.  0.  0.]
obs <crafter.objects.Shelter object at 0x144a43910> 0 [39.  0.  0.  0. 39.  0.  0.  0. 20.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x1262bbe80> 0 [38.  0.  0.  0. 43.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x144a494f0> 0 [ 9.  0.  0.  0.  9.  0.  0.  0. 12.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.002274036407470703 seconds
19 rew tensor(0.8164, dtype=torch.float64) delta_t tensor(0.6439, dtype=torch.float64)
19 gae_duplicate tensor(0.5023, dtype=torch.float64) tensor(-12.6240, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8905, dtype=torch.float64) delta_t tensor(0.7511, dtype=torch.float64)
18 gae_duplicate tensor(0.6521, dtype=torch.float64) tensor(-16.0894, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8622, dtype=torch.float64) delta_t tensor(0.7341, dtype=torch.float64)
17 gae_duplicate tensor(0.6596, dtype=torch.float64) tensor(-16.1330, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8591, dtype=torch.float64) delta_t tensor(0.7577, dtype=torch.float64)
16 gae_duplicate tensor(0.6692, dtype=torch.float64) tensor(-16.6151, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8249, dtype=torch.float64) delta_t tensor(0.6805, dtype=torch.float64)
15 gae_duplicate tensor(0.5718, dtype=torch.float64) tensor(-15.1591, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7599, dtype=torch.float64) delta_t tensor(0.6644, dtype=torch.float64)
14 gae_duplicate tensor(0.5075, dtype=torch.float64) tensor(-14.5695, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4990, dtype=torch.float64) delta_t tensor(0.3902, dtype=torch.float64)
13 gae_duplicate tensor(-0.6858, dtype=torch.float64) tensor(-9.0248, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8937, dtype=torch.float64) delta_t tensor(0.8691, dtype=torch.float64)
12 gae_duplicate tensor(-0.0136, dtype=torch.float64) tensor(-18.0053, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6567, dtype=torch.float64) delta_t tensor(0.4648, dtype=torch.float64)
11 gae_duplicate tensor(-0.3778, dtype=torch.float64) tensor(-10.9381, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4356, dtype=torch.float64) delta_t tensor(0.4471, dtype=torch.float64)
10 gae_duplicate tensor(-0.2859, dtype=torch.float64) tensor(-9.9258, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0181, dtype=torch.float64) delta_t tensor(-0.1469, dtype=torch.float64)
9 gae_duplicate tensor(-2.5241, dtype=torch.float64) tensor(1.8206, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.9945, dtype=torch.float64) delta_t tensor(1.0169, dtype=torch.float64)
8 gae_duplicate tensor(0.4035, dtype=torch.float64) tensor(-19.7953, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8072, dtype=torch.float64) delta_t tensor(-0.9181, dtype=torch.float64)
7 gae_duplicate tensor(-1.8140, dtype=torch.float64) tensor(16.0461, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0542, dtype=torch.float64) delta_t tensor(-0.0665, dtype=torch.float64)
6 gae_duplicate tensor(-1.3640, dtype=torch.float64) tensor(3.0801, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6594, dtype=torch.float64) delta_t tensor(-0.7563, dtype=torch.float64)
5 gae_duplicate tensor(-2.0003, dtype=torch.float64) tensor(15.0402, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.0286, dtype=torch.float64) delta_t tensor(0.9135, dtype=torch.float64)
4 gae_duplicate tensor(-0.4085, dtype=torch.float64) tensor(-16.4555, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2627, dtype=torch.float64) delta_t tensor(0.2681, dtype=torch.float64)
3 gae_duplicate tensor(0.0304, dtype=torch.float64) tensor(-6.9254, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.7941, dtype=torch.float64) delta_t tensor(0.6688, dtype=torch.float64)
2 gae_duplicate tensor(-0.7928, dtype=torch.float64) tensor(-13.8901, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:8552.751953125
value loss:133.89694213867188
entropies:355.8147888183594
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 5.184957981109619 seconds
19 rew tensor(0.8938, dtype=torch.float64) delta_t tensor(0.5555, dtype=torch.float64)
19 gae_duplicate tensor(0.4011, dtype=torch.float64) tensor(-10.9847, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8493, dtype=torch.float64) delta_t tensor(0.5492, dtype=torch.float64)
18 gae_duplicate tensor(0.3420, dtype=torch.float64) tensor(-12.0876, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8112, dtype=torch.float64) delta_t tensor(0.5343, dtype=torch.float64)
17 gae_duplicate tensor(0.4512, dtype=torch.float64) tensor(-11.5120, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6731, dtype=torch.float64) delta_t tensor(0.3943, dtype=torch.float64)
16 gae_duplicate tensor(0.1946, dtype=torch.float64) tensor(-9.0197, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8821, dtype=torch.float64) delta_t tensor(0.6600, dtype=torch.float64)
15 gae_duplicate tensor(0.5387, dtype=torch.float64) tensor(-13.8379, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3699, dtype=torch.float64) delta_t tensor(0.0687, dtype=torch.float64)
14 gae_duplicate tensor(-1.3352, dtype=torch.float64) tensor(-2.5131, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7485, dtype=torch.float64) delta_t tensor(0.5376, dtype=torch.float64)
13 gae_duplicate tensor(0.3419, dtype=torch.float64) tensor(-11.0325, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2014, dtype=torch.float64) delta_t tensor(-0.0256, dtype=torch.float64)
12 gae_duplicate tensor(-1.6894, dtype=torch.float64) tensor(-0.5382, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4452, dtype=torch.float64) delta_t tensor(0.2830, dtype=torch.float64)
11 gae_duplicate tensor(-1.1296, dtype=torch.float64) tensor(-5.7293, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7646, dtype=torch.float64) delta_t tensor(-0.9483, dtype=torch.float64)
10 gae_duplicate tensor(-2.0651, dtype=torch.float64) tensor(18.0893, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0720, dtype=torch.float64) delta_t tensor(-0.2065, dtype=torch.float64)
9 gae_duplicate tensor(-1.5231, dtype=torch.float64) tensor(5.8002, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1474, dtype=torch.float64) delta_t tensor(-0.0427, dtype=torch.float64)
8 gae_duplicate tensor(-0.9083, dtype=torch.float64) tensor(1.3718, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0617, dtype=torch.float64) delta_t tensor(-0.3271, dtype=torch.float64)
7 gae_duplicate tensor(-3.1351, dtype=torch.float64) tensor(6.5560, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7065, dtype=torch.float64) delta_t tensor(-0.8614, dtype=torch.float64)
6 gae_duplicate tensor(-2.3220, dtype=torch.float64) tensor(18.2564, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0822, dtype=torch.float64) delta_t tensor(-0.1719, dtype=torch.float64)
5 gae_duplicate tensor(-1.4190, dtype=torch.float64) tensor(5.2321, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0400, dtype=torch.float64) delta_t tensor(-0.2136, dtype=torch.float64)
4 gae_duplicate tensor(-1.6968, dtype=torch.float64) tensor(5.1476, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1027, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
3 gae_duplicate tensor(-1.3212, dtype=torch.float64) tensor(-0.3218, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3206, dtype=torch.float64) delta_t tensor(-0.4484, dtype=torch.float64)
2 gae_duplicate tensor(-1.7418, dtype=torch.float64) tensor(8.7087, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:358.4366760253906
value loss:109.08457946777344
entropies:355.418701171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.044609069824219 seconds
19 rew tensor(0.9230, dtype=torch.float64) delta_t tensor(0.4385, dtype=torch.float64)
19 gae_duplicate tensor(0.2964, dtype=torch.float64) tensor(-8.5720, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6549, dtype=torch.float64) delta_t tensor(0.2542, dtype=torch.float64)
18 gae_duplicate tensor(-0.8996, dtype=torch.float64) tensor(-6.0517, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6615, dtype=torch.float64) delta_t tensor(0.2620, dtype=torch.float64)
17 gae_duplicate tensor(-0.8631, dtype=torch.float64) tensor(-5.3487, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7612, dtype=torch.float64) delta_t tensor(0.4599, dtype=torch.float64)
16 gae_duplicate tensor(0.3423, dtype=torch.float64) tensor(-9.6193, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4424, dtype=torch.float64) delta_t tensor(0.0718, dtype=torch.float64)
15 gae_duplicate tensor(-0.6715, dtype=torch.float64) tensor(-2.3280, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2703, dtype=torch.float64) delta_t tensor(-0.0983, dtype=torch.float64)
14 gae_duplicate tensor(-0.6298, dtype=torch.float64) tensor(1.9539, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4969, dtype=torch.float64) delta_t tensor(0.2521, dtype=torch.float64)
13 gae_duplicate tensor(-0.6893, dtype=torch.float64) tensor(-4.8134, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5266, dtype=torch.float64) delta_t tensor(0.1778, dtype=torch.float64)
12 gae_duplicate tensor(-0.1713, dtype=torch.float64) tensor(-4.1312, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4202, dtype=torch.float64) delta_t tensor(0.1322, dtype=torch.float64)
11 gae_duplicate tensor(-0.6298, dtype=torch.float64) tensor(-3.1518, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3264, dtype=torch.float64) delta_t tensor(-0.5895, dtype=torch.float64)
10 gae_duplicate tensor(-2.0263, dtype=torch.float64) tensor(10.9871, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5174, dtype=torch.float64) delta_t tensor(-1.8031, dtype=torch.float64)
9 gae_duplicate tensor(-3.5343, dtype=torch.float64) tensor(37.9493, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9713, dtype=torch.float64) delta_t tensor(-1.1962, dtype=torch.float64)
8 gae_duplicate tensor(-4.6186, dtype=torch.float64) tensor(28.0822, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1223, dtype=torch.float64) delta_t tensor(-0.3923, dtype=torch.float64)
7 gae_duplicate tensor(-3.7060, dtype=torch.float64) tensor(11.0180, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0906, dtype=torch.float64) delta_t tensor(-0.3397, dtype=torch.float64)
6 gae_duplicate tensor(-1.2946, dtype=torch.float64) tensor(7.9198, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0588, dtype=torch.float64) delta_t tensor(-0.2537, dtype=torch.float64)
5 gae_duplicate tensor(-1.2282, dtype=torch.float64) tensor(5.4984, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0785, dtype=torch.float64) delta_t tensor(-0.1913, dtype=torch.float64)
4 gae_duplicate tensor(-1.3399, dtype=torch.float64) tensor(4.3768, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2083, dtype=torch.float64) delta_t tensor(0.1329, dtype=torch.float64)
3 gae_duplicate tensor(-0.6481, dtype=torch.float64) tensor(-2.2129, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3392, dtype=torch.float64) delta_t tensor(-0.6512, dtype=torch.float64)
2 gae_duplicate tensor(-1.5367, dtype=torch.float64) tensor(12.4675, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4093.079345703125
value loss:152.25534057617188
entropies:354.74639892578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.858197927474976 seconds
19 rew tensor(0.8837, dtype=torch.float64) delta_t tensor(0.3148, dtype=torch.float64)
19 gae_duplicate tensor(0.2412, dtype=torch.float64) tensor(-6.3062, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7999, dtype=torch.float64) delta_t tensor(0.3064, dtype=torch.float64)
18 gae_duplicate tensor(-0.0731, dtype=torch.float64) tensor(-6.8175, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7880, dtype=torch.float64) delta_t tensor(0.3797, dtype=torch.float64)
17 gae_duplicate tensor(0.2302, dtype=torch.float64) tensor(-8.2529, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5685, dtype=torch.float64) delta_t tensor(0.1308, dtype=torch.float64)
16 gae_duplicate tensor(-0.2404, dtype=torch.float64) tensor(-3.5547, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5057, dtype=torch.float64) delta_t tensor(0.1246, dtype=torch.float64)
15 gae_duplicate tensor(-1.0761, dtype=torch.float64) tensor(-2.4765, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1652, dtype=torch.float64) delta_t tensor(-0.2055, dtype=torch.float64)
14 gae_duplicate tensor(-0.6940, dtype=torch.float64) tensor(3.4688, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4019, dtype=torch.float64) delta_t tensor(0.1367, dtype=torch.float64)
13 gae_duplicate tensor(-0.5385, dtype=torch.float64) tensor(-2.7451, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1070, dtype=torch.float64) delta_t tensor(-0.4478, dtype=torch.float64)
12 gae_duplicate tensor(-2.3024, dtype=torch.float64) tensor(7.9496, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1976, dtype=torch.float64) delta_t tensor(-0.5460, dtype=torch.float64)
11 gae_duplicate tensor(-1.8126, dtype=torch.float64) tensor(12.1822, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0852, dtype=torch.float64) delta_t tensor(-0.3344, dtype=torch.float64)
10 gae_duplicate tensor(-2.0820, dtype=torch.float64) tensor(8.3373, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6171, dtype=torch.float64) delta_t tensor(-1.9385, dtype=torch.float64)
9 gae_duplicate tensor(-4.4224, dtype=torch.float64) tensor(38.5638, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7642, dtype=torch.float64) delta_t tensor(-0.9818, dtype=torch.float64)
8 gae_duplicate tensor(-4.0582, dtype=torch.float64) tensor(22.6230, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3612, dtype=torch.float64) delta_t tensor(-0.7099, dtype=torch.float64)
7 gae_duplicate tensor(-2.8695, dtype=torch.float64) tensor(16.8128, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1261, dtype=torch.float64) delta_t tensor(-0.3908, dtype=torch.float64)
6 gae_duplicate tensor(-1.9056, dtype=torch.float64) tensor(9.0744, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0287, dtype=torch.float64) delta_t tensor(-0.3261, dtype=torch.float64)
5 gae_duplicate tensor(-1.1618, dtype=torch.float64) tensor(7.6776, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3134, dtype=torch.float64) delta_t tensor(-0.0523, dtype=torch.float64)
4 gae_duplicate tensor(-0.9739, dtype=torch.float64) tensor(1.5198, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0738, dtype=torch.float64) delta_t tensor(0.0191, dtype=torch.float64)
3 gae_duplicate tensor(-0.6135, dtype=torch.float64) tensor(-0.3517, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2212, dtype=torch.float64) delta_t tensor(-0.5557, dtype=torch.float64)
2 gae_duplicate tensor(-1.2985, dtype=torch.float64) tensor(10.6474, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5946.54736328125
value loss:188.08258056640625
entropies:353.877685546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.210474014282227 seconds
19 rew tensor(0.8577, dtype=torch.float64) delta_t tensor(0.2254, dtype=torch.float64)
19 gae_duplicate tensor(0.0925, dtype=torch.float64) tensor(-4.6337, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4038, dtype=torch.float64) delta_t tensor(-0.1430, dtype=torch.float64)
18 gae_duplicate tensor(-1.0650, dtype=torch.float64) tensor(1.7981, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4433, dtype=torch.float64) delta_t tensor(-0.0814, dtype=torch.float64)
17 gae_duplicate tensor(-0.9609, dtype=torch.float64) tensor(1.8524, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6863, dtype=torch.float64) delta_t tensor(0.2052, dtype=torch.float64)
16 gae_duplicate tensor(0.0429, dtype=torch.float64) tensor(-3.8352, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7520, dtype=torch.float64) delta_t tensor(0.2890, dtype=torch.float64)
15 gae_duplicate tensor(0.1831, dtype=torch.float64) tensor(-6.4246, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6468, dtype=torch.float64) delta_t tensor(0.2200, dtype=torch.float64)
14 gae_duplicate tensor(4.1764e-05, dtype=torch.float64) tensor(-4.8601, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7737, dtype=torch.float64) delta_t tensor(0.3824, dtype=torch.float64)
13 gae_duplicate tensor(0.2966, dtype=torch.float64) tensor(-7.8912, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0018, dtype=torch.float64) delta_t tensor(-0.4262, dtype=torch.float64)
12 gae_duplicate tensor(-1.0764, dtype=torch.float64) tensor(7.8769, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1648, dtype=torch.float64) delta_t tensor(-0.2077, dtype=torch.float64)
11 gae_duplicate tensor(-0.9316, dtype=torch.float64) tensor(5.3233, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0745, dtype=torch.float64) delta_t tensor(-0.4858, dtype=torch.float64)
10 gae_duplicate tensor(-1.4534, dtype=torch.float64) tensor(9.5521, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8313, dtype=torch.float64) delta_t tensor(-1.2387, dtype=torch.float64)
9 gae_duplicate tensor(-3.6524, dtype=torch.float64) tensor(26.6655, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6302, dtype=torch.float64) delta_t tensor(-1.9840, dtype=torch.float64)
8 gae_duplicate tensor(-4.6505, dtype=torch.float64) tensor(39.4878, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4351, dtype=torch.float64) delta_t tensor(0.0297, dtype=torch.float64)
7 gae_duplicate tensor(-1.4720, dtype=torch.float64) tensor(3.1396, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5851, dtype=torch.float64) delta_t tensor(-0.8758, dtype=torch.float64)
6 gae_duplicate tensor(-3.9818, dtype=torch.float64) tensor(17.3908, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0661, dtype=torch.float64) delta_t tensor(-0.4819, dtype=torch.float64)
5 gae_duplicate tensor(-3.4178, dtype=torch.float64) tensor(11.4536, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3059, dtype=torch.float64) delta_t tensor(-0.6813, dtype=torch.float64)
4 gae_duplicate tensor(-1.9062, dtype=torch.float64) tensor(14.2157, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4462, dtype=torch.float64) delta_t tensor(0.3929, dtype=torch.float64)
3 gae_duplicate tensor(-0.1729, dtype=torch.float64) tensor(-6.5739, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4639, dtype=torch.float64) delta_t tensor(-0.8491, dtype=torch.float64)
2 gae_duplicate tensor(-0.9782, dtype=torch.float64) tensor(16.2596, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6618.41064453125
value loss:191.41343688964844
entropies:353.2870788574219
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3987.2986)
ToM Target loss= tensor(3523.3423)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.197887897491455 seconds
19 rew tensor(0.8497, dtype=torch.float64) delta_t tensor(0.2321, dtype=torch.float64)
19 gae_duplicate tensor(0.1579, dtype=torch.float64) tensor(-4.4329, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6185, dtype=torch.float64) delta_t tensor(0.1076, dtype=torch.float64)
18 gae_duplicate tensor(-0.9850, dtype=torch.float64) tensor(-2.0458, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8326, dtype=torch.float64) delta_t tensor(0.2798, dtype=torch.float64)
17 gae_duplicate tensor(0.1839, dtype=torch.float64) tensor(-6.1608, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7695, dtype=torch.float64) delta_t tensor(0.3176, dtype=torch.float64)
16 gae_duplicate tensor(0.2712, dtype=torch.float64) tensor(-6.6702, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6153, dtype=torch.float64) delta_t tensor(0.1643, dtype=torch.float64)
15 gae_duplicate tensor(-0.8388, dtype=torch.float64) tensor(-4.0995, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6109, dtype=torch.float64) delta_t tensor(0.1746, dtype=torch.float64)
14 gae_duplicate tensor(0.0875, dtype=torch.float64) tensor(-3.8763, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3643, dtype=torch.float64) delta_t tensor(0.0171, dtype=torch.float64)
13 gae_duplicate tensor(-0.7396, dtype=torch.float64) tensor(-0.7913, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5682, dtype=torch.float64) delta_t tensor(0.2082, dtype=torch.float64)
12 gae_duplicate tensor(-0.0897, dtype=torch.float64) tensor(-4.2721, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2040, dtype=torch.float64) delta_t tensor(-0.1345, dtype=torch.float64)
11 gae_duplicate tensor(-0.5859, dtype=torch.float64) tensor(2.5461, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2998, dtype=torch.float64) delta_t tensor(-0.6171, dtype=torch.float64)
10 gae_duplicate tensor(-1.8122, dtype=torch.float64) tensor(13.0056, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.1457, dtype=torch.float64) delta_t tensor(-2.3930, dtype=torch.float64)
9 gae_duplicate tensor(-5.9454, dtype=torch.float64) tensor(49.3235, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6660, dtype=torch.float64) delta_t tensor(-1.9118, dtype=torch.float64)
8 gae_duplicate tensor(-4.5973, dtype=torch.float64) tensor(39.3587, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6953, dtype=torch.float64) delta_t tensor(-0.9593, dtype=torch.float64)
7 gae_duplicate tensor(-2.8037, dtype=torch.float64) tensor(21.9286, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0791, dtype=torch.float64) delta_t tensor(-0.2127, dtype=torch.float64)
6 gae_duplicate tensor(-2.0267, dtype=torch.float64) tensor(6.1623, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2409, dtype=torch.float64) delta_t tensor(-0.5507, dtype=torch.float64)
5 gae_duplicate tensor(-2.3304, dtype=torch.float64) tensor(12.3576, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5306, dtype=torch.float64) delta_t tensor(0.1789, dtype=torch.float64)
4 gae_duplicate tensor(-0.1903, dtype=torch.float64) tensor(-2.2673, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0342, dtype=torch.float64) delta_t tensor(-0.0593, dtype=torch.float64)
3 gae_duplicate tensor(-0.6705, dtype=torch.float64) tensor(1.0956, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1194, dtype=torch.float64) delta_t tensor(-0.4619, dtype=torch.float64)
2 gae_duplicate tensor(-0.6874, dtype=torch.float64) tensor(8.7811, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6572.2783203125
value loss:225.57855224609375
entropies:353.1689453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.954499244689941 seconds
19 rew tensor(0.8728, dtype=torch.float64) delta_t tensor(0.3372, dtype=torch.float64)
19 gae_duplicate tensor(0.2407, dtype=torch.float64) tensor(-6.8494, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.2993, dtype=torch.float64)
18 gae_duplicate tensor(0.0100, dtype=torch.float64) tensor(-6.3399, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7905, dtype=torch.float64) delta_t tensor(0.3415, dtype=torch.float64)
17 gae_duplicate tensor(0.1443, dtype=torch.float64) tensor(-6.8418, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7378, dtype=torch.float64) delta_t tensor(0.2844, dtype=torch.float64)
16 gae_duplicate tensor(0.2577, dtype=torch.float64) tensor(-6.2734, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6279, dtype=torch.float64) delta_t tensor(0.2638, dtype=torch.float64)
15 gae_duplicate tensor(0.0169, dtype=torch.float64) tensor(-5.5391, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5652, dtype=torch.float64) delta_t tensor(0.1806, dtype=torch.float64)
14 gae_duplicate tensor(-0.5025, dtype=torch.float64) tensor(-4.0238, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3023, dtype=torch.float64) delta_t tensor(0.0405, dtype=torch.float64)
13 gae_duplicate tensor(-1.1209, dtype=torch.float64) tensor(-0.8585, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7512, dtype=torch.float64) delta_t tensor(0.4078, dtype=torch.float64)
12 gae_duplicate tensor(-0.0549, dtype=torch.float64) tensor(-8.4045, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2216, dtype=torch.float64) delta_t tensor(-0.5531, dtype=torch.float64)
11 gae_duplicate tensor(-1.2453, dtype=torch.float64) tensor(9.3463, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0780, dtype=torch.float64) delta_t tensor(-0.2905, dtype=torch.float64)
10 gae_duplicate tensor(-1.3260, dtype=torch.float64) tensor(6.1890, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2767, dtype=torch.float64) delta_t tensor(-1.4872, dtype=torch.float64)
9 gae_duplicate tensor(-3.5923, dtype=torch.float64) tensor(30.9837, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5285, dtype=torch.float64) delta_t tensor(-0.6969, dtype=torch.float64)
8 gae_duplicate tensor(-5.3879, dtype=torch.float64) tensor(18.3711, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9571, dtype=torch.float64) delta_t tensor(-1.1832, dtype=torch.float64)
7 gae_duplicate tensor(-3.0301, dtype=torch.float64) tensor(25.8532, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0803, dtype=torch.float64) delta_t tensor(-0.0774, dtype=torch.float64)
6 gae_duplicate tensor(-2.0968, dtype=torch.float64) tensor(4.6609, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4626, dtype=torch.float64) delta_t tensor(-0.6102, dtype=torch.float64)
5 gae_duplicate tensor(-1.1691, dtype=torch.float64) tensor(11.7460, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5669, dtype=torch.float64) delta_t tensor(0.2562, dtype=torch.float64)
4 gae_duplicate tensor(-0.7040, dtype=torch.float64) tensor(-3.7346, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2644, dtype=torch.float64) delta_t tensor(-0.2524, dtype=torch.float64)
3 gae_duplicate tensor(-0.9634, dtype=torch.float64) tensor(4.4089, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0586, dtype=torch.float64) delta_t tensor(-0.2079, dtype=torch.float64)
2 gae_duplicate tensor(-0.7227, dtype=torch.float64) tensor(4.1491, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3704.869384765625
value loss:151.86741638183594
entropies:353.1022644042969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.791691064834595 seconds
19 rew tensor(0.9170, dtype=torch.float64) delta_t tensor(0.4218, dtype=torch.float64)
19 gae_duplicate tensor(0.2858, dtype=torch.float64) tensor(-8.2040, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8965, dtype=torch.float64) delta_t tensor(0.4571, dtype=torch.float64)
18 gae_duplicate tensor(0.3919, dtype=torch.float64) tensor(-9.9632, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8300, dtype=torch.float64) delta_t tensor(0.4267, dtype=torch.float64)
17 gae_duplicate tensor(0.3728, dtype=torch.float64) tensor(-9.0407, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6999, dtype=torch.float64) delta_t tensor(0.3405, dtype=torch.float64)
16 gae_duplicate tensor(0.1730, dtype=torch.float64) tensor(-7.7549, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6779, dtype=torch.float64) delta_t tensor(0.3232, dtype=torch.float64)
15 gae_duplicate tensor(0.2692, dtype=torch.float64) tensor(-7.0334, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3059, dtype=torch.float64) delta_t tensor(-0.0153, dtype=torch.float64)
14 gae_duplicate tensor(-1.0930, dtype=torch.float64) tensor(-0.5896, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5015, dtype=torch.float64) delta_t tensor(0.2316, dtype=torch.float64)
13 gae_duplicate tensor(-0.5970, dtype=torch.float64) tensor(-4.3073, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4700, dtype=torch.float64) delta_t tensor(0.1365, dtype=torch.float64)
12 gae_duplicate tensor(-0.1046, dtype=torch.float64) tensor(-3.0094, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5859, dtype=torch.float64) delta_t tensor(0.3273, dtype=torch.float64)
11 gae_duplicate tensor(-0.0151, dtype=torch.float64) tensor(-6.9245, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.0486, dtype=torch.float64) delta_t tensor(-1.1984, dtype=torch.float64)
10 gae_duplicate tensor(-2.1744, dtype=torch.float64) tensor(22.5781, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6866, dtype=torch.float64) delta_t tensor(-0.8976, dtype=torch.float64)
9 gae_duplicate tensor(-2.2351, dtype=torch.float64) tensor(20.7699, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1539, dtype=torch.float64) delta_t tensor(-0.0012, dtype=torch.float64)
8 gae_duplicate tensor(-0.5431, dtype=torch.float64) tensor(1.8908, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4015, dtype=torch.float64) delta_t tensor(-0.6505, dtype=torch.float64)
7 gae_duplicate tensor(-2.9015, dtype=torch.float64) tensor(12.1379, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8572, dtype=torch.float64) delta_t tensor(-0.9037, dtype=torch.float64)
6 gae_duplicate tensor(-3.0764, dtype=torch.float64) tensor(20.0079, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0682, dtype=torch.float64) delta_t tensor(-0.1968, dtype=torch.float64)
5 gae_duplicate tensor(-1.2777, dtype=torch.float64) tensor(6.1976, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1580, dtype=torch.float64) delta_t tensor(-0.2839, dtype=torch.float64)
4 gae_duplicate tensor(-0.8702, dtype=torch.float64) tensor(5.8954, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3105, dtype=torch.float64) delta_t tensor(0.2803, dtype=torch.float64)
3 gae_duplicate tensor(-0.5497, dtype=torch.float64) tensor(-5.2832, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3799, dtype=torch.float64) delta_t tensor(-0.5512, dtype=torch.float64)
2 gae_duplicate tensor(-0.8973, dtype=torch.float64) tensor(10.1567, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2121.577392578125
value loss:97.32015228271484
entropies:352.8610534667969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.267900228500366 seconds
19 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.4383, dtype=torch.float64)
19 gae_duplicate tensor(0.2892, dtype=torch.float64) tensor(-8.6599, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8351, dtype=torch.float64) delta_t tensor(0.4758, dtype=torch.float64)
18 gae_duplicate tensor(0.3857, dtype=torch.float64) tensor(-9.9608, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7933, dtype=torch.float64) delta_t tensor(0.4132, dtype=torch.float64)
17 gae_duplicate tensor(0.3122, dtype=torch.float64) tensor(-8.9950, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5196, dtype=torch.float64) delta_t tensor(0.2173, dtype=torch.float64)
16 gae_duplicate tensor(-0.5937, dtype=torch.float64) tensor(-5.1015, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7056, dtype=torch.float64) delta_t tensor(0.4168, dtype=torch.float64)
15 gae_duplicate tensor(0.0508, dtype=torch.float64) tensor(-8.1443, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5700, dtype=torch.float64) delta_t tensor(0.2637, dtype=torch.float64)
14 gae_duplicate tensor(0.0723, dtype=torch.float64) tensor(-5.6386, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2903, dtype=torch.float64) delta_t tensor(0.0758, dtype=torch.float64)
13 gae_duplicate tensor(-0.8835, dtype=torch.float64) tensor(-1.9475, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5090, dtype=torch.float64) delta_t tensor(0.2542, dtype=torch.float64)
12 gae_duplicate tensor(0.0706, dtype=torch.float64) tensor(-5.2376, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2376, dtype=torch.float64) delta_t tensor(0.0868, dtype=torch.float64)
11 gae_duplicate tensor(-1.9065, dtype=torch.float64) tensor(-2.7022, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1224, dtype=torch.float64) delta_t tensor(-0.3091, dtype=torch.float64)
10 gae_duplicate tensor(-1.1723, dtype=torch.float64) tensor(6.5154, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0552, dtype=torch.float64) delta_t tensor(-0.1865, dtype=torch.float64)
9 gae_duplicate tensor(-2.5687, dtype=torch.float64) tensor(3.4192, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1320, dtype=torch.float64) delta_t tensor(-0.0289, dtype=torch.float64)
8 gae_duplicate tensor(-0.5160, dtype=torch.float64) tensor(0.9607, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0347, dtype=torch.float64) delta_t tensor(-0.1550, dtype=torch.float64)
7 gae_duplicate tensor(-1.8799, dtype=torch.float64) tensor(3.4666, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1383, dtype=torch.float64) delta_t tensor(-0.1949, dtype=torch.float64)
6 gae_duplicate tensor(-0.8124, dtype=torch.float64) tensor(4.1325, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0909, dtype=torch.float64) delta_t tensor(-0.1144, dtype=torch.float64)
5 gae_duplicate tensor(-0.7365, dtype=torch.float64) tensor(2.6040, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2791, dtype=torch.float64) delta_t tensor(-0.2654, dtype=torch.float64)
4 gae_duplicate tensor(-0.9555, dtype=torch.float64) tensor(5.3927, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4055, dtype=torch.float64) delta_t tensor(0.3897, dtype=torch.float64)
3 gae_duplicate tensor(-0.4490, dtype=torch.float64) tensor(-6.6306, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5767, dtype=torch.float64) delta_t tensor(-0.5941, dtype=torch.float64)
2 gae_duplicate tensor(-0.9551, dtype=torch.float64) tensor(11.5075, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1255.8602294921875
value loss:62.903316497802734
entropies:352.5859680175781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.923706769943237 seconds
19 rew tensor(0.9157, dtype=torch.float64) delta_t tensor(0.4348, dtype=torch.float64)
19 gae_duplicate tensor(0.3386, dtype=torch.float64) tensor(-8.6683, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8952, dtype=torch.float64) delta_t tensor(0.4667, dtype=torch.float64)
18 gae_duplicate tensor(0.2487, dtype=torch.float64) tensor(-10.0534, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8252, dtype=torch.float64) delta_t tensor(0.4296, dtype=torch.float64)
17 gae_duplicate tensor(0.3554, dtype=torch.float64) tensor(-9.3172, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7646, dtype=torch.float64) delta_t tensor(0.4137, dtype=torch.float64)
16 gae_duplicate tensor(0.3323, dtype=torch.float64) tensor(-8.7308, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7610, dtype=torch.float64) delta_t tensor(0.4280, dtype=torch.float64)
15 gae_duplicate tensor(0.2056, dtype=torch.float64) tensor(-8.8596, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5216, dtype=torch.float64) delta_t tensor(0.2011, dtype=torch.float64)
14 gae_duplicate tensor(-0.5181, dtype=torch.float64) tensor(-5.1463, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6029, dtype=torch.float64) delta_t tensor(0.3946, dtype=torch.float64)
13 gae_duplicate tensor(0.2397, dtype=torch.float64) tensor(-7.9913, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5484, dtype=torch.float64) delta_t tensor(0.3191, dtype=torch.float64)
12 gae_duplicate tensor(0.0106, dtype=torch.float64) tensor(-7.0467, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0014, dtype=torch.float64) delta_t tensor(-0.0584, dtype=torch.float64)
11 gae_duplicate tensor(-0.9739, dtype=torch.float64) tensor(0.2891, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0804, dtype=torch.float64) delta_t tensor(-0.1699, dtype=torch.float64)
10 gae_duplicate tensor(-1.5138, dtype=torch.float64) tensor(3.2941, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.4194, dtype=torch.float64) delta_t tensor(-2.4177, dtype=torch.float64)
9 gae_duplicate tensor(-4.6099, dtype=torch.float64) tensor(46.7315, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0797, dtype=torch.float64) delta_t tensor(-1.0994, dtype=torch.float64)
8 gae_duplicate tensor(-3.6235, dtype=torch.float64) tensor(27.7001, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3850, dtype=torch.float64) delta_t tensor(-0.4085, dtype=torch.float64)
7 gae_duplicate tensor(-2.2195, dtype=torch.float64) tensor(9.9200, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0447, dtype=torch.float64) delta_t tensor(0.0337, dtype=torch.float64)
6 gae_duplicate tensor(-0.6417, dtype=torch.float64) tensor(0.9084, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0703, dtype=torch.float64) delta_t tensor(-0.1112, dtype=torch.float64)
5 gae_duplicate tensor(-0.4852, dtype=torch.float64) tensor(2.3132, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3165, dtype=torch.float64) delta_t tensor(0.1759, dtype=torch.float64)
4 gae_duplicate tensor(-0.6048, dtype=torch.float64) tensor(-3.5517, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1242, dtype=torch.float64) delta_t tensor(0.2480, dtype=torch.float64)
3 gae_duplicate tensor(-0.0248, dtype=torch.float64) tensor(-5.4845, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3203, dtype=torch.float64) delta_t tensor(-0.4013, dtype=torch.float64)
2 gae_duplicate tensor(-0.7819, dtype=torch.float64) tensor(7.9945, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1407.328857421875
value loss:158.04257202148438
entropies:352.0907287597656
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3947.2627)
ToM Target loss= tensor(3521.9170)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.941394090652466 seconds
19 rew tensor(0.8639, dtype=torch.float64) delta_t tensor(0.3874, dtype=torch.float64)
19 gae_duplicate tensor(0.2010, dtype=torch.float64) tensor(-6.9477, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8247, dtype=torch.float64) delta_t tensor(0.3793, dtype=torch.float64)
18 gae_duplicate tensor(0.2727, dtype=torch.float64) tensor(-7.8344, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7422, dtype=torch.float64) delta_t tensor(0.3406, dtype=torch.float64)
17 gae_duplicate tensor(0.2848, dtype=torch.float64) tensor(-7.2063, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5265, dtype=torch.float64) delta_t tensor(0.2028, dtype=torch.float64)
16 gae_duplicate tensor(-0.7125, dtype=torch.float64) tensor(-5.0777, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5567, dtype=torch.float64) delta_t tensor(0.2401, dtype=torch.float64)
15 gae_duplicate tensor(0.0930, dtype=torch.float64) tensor(-5.3489, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3928, dtype=torch.float64) delta_t tensor(0.1110, dtype=torch.float64)
14 gae_duplicate tensor(-1.0417, dtype=torch.float64) tensor(-2.7490, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5510, dtype=torch.float64) delta_t tensor(0.4851, dtype=torch.float64)
13 gae_duplicate tensor(0.3315, dtype=torch.float64) tensor(-9.3971, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3619, dtype=torch.float64) delta_t tensor(0.2030, dtype=torch.float64)
12 gae_duplicate tensor(-0.8479, dtype=torch.float64) tensor(-4.9334, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0895, dtype=torch.float64) delta_t tensor(-0.1991, dtype=torch.float64)
11 gae_duplicate tensor(-1.8222, dtype=torch.float64) tensor(2.4480, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1619, dtype=torch.float64) delta_t tensor(0.1696, dtype=torch.float64)
10 gae_duplicate tensor(-0.7421, dtype=torch.float64) tensor(-2.8439, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5094, dtype=torch.float64) delta_t tensor(-0.5590, dtype=torch.float64)
9 gae_duplicate tensor(-5.4184, dtype=torch.float64) tensor(13.4702, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7507, dtype=torch.float64) delta_t tensor(-0.7176, dtype=torch.float64)
8 gae_duplicate tensor(-2.2163, dtype=torch.float64) tensor(14.8203, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4366, dtype=torch.float64) delta_t tensor(-0.4748, dtype=torch.float64)
7 gae_duplicate tensor(-2.7011, dtype=torch.float64) tensor(9.9410, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7611, dtype=torch.float64) delta_t tensor(-0.7386, dtype=torch.float64)
6 gae_duplicate tensor(-3.2178, dtype=torch.float64) tensor(16.6820, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2917, dtype=torch.float64) delta_t tensor(-0.3101, dtype=torch.float64)
5 gae_duplicate tensor(-2.4070, dtype=torch.float64) tensor(7.3684, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2747, dtype=torch.float64) delta_t tensor(0.1543, dtype=torch.float64)
4 gae_duplicate tensor(-0.6744, dtype=torch.float64) tensor(-2.6246, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0446, dtype=torch.float64) delta_t tensor(0.1105, dtype=torch.float64)
3 gae_duplicate tensor(-0.6837, dtype=torch.float64) tensor(-2.4237, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1682, dtype=torch.float64) delta_t tensor(-0.2445, dtype=torch.float64)
2 gae_duplicate tensor(-0.6083, dtype=torch.float64) tensor(4.2791, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-722.5836181640625
value loss:141.122802734375
entropies:351.77099609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.987446069717407 seconds
19 rew tensor(0.8827, dtype=torch.float64) delta_t tensor(0.3968, dtype=torch.float64)
19 gae_duplicate tensor(0.2090, dtype=torch.float64) tensor(-7.9174, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8797, dtype=torch.float64) delta_t tensor(0.4238, dtype=torch.float64)
18 gae_duplicate tensor(0.2477, dtype=torch.float64) tensor(-9.4055, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7324, dtype=torch.float64) delta_t tensor(0.3617, dtype=torch.float64)
17 gae_duplicate tensor(0.2043, dtype=torch.float64) tensor(-7.8782, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5787, dtype=torch.float64) delta_t tensor(0.2312, dtype=torch.float64)
16 gae_duplicate tensor(-0.5879, dtype=torch.float64) tensor(-4.9049, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5924, dtype=torch.float64) delta_t tensor(0.2913, dtype=torch.float64)
15 gae_duplicate tensor(0.1873, dtype=torch.float64) tensor(-6.1309, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4483, dtype=torch.float64) delta_t tensor(0.2576, dtype=torch.float64)
14 gae_duplicate tensor(-0.7247, dtype=torch.float64) tensor(-5.4730, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6211, dtype=torch.float64) delta_t tensor(0.4407, dtype=torch.float64)
13 gae_duplicate tensor(0.1928, dtype=torch.float64) tensor(-9.2770, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6371, dtype=torch.float64) delta_t tensor(0.5352, dtype=torch.float64)
12 gae_duplicate tensor(0.2183, dtype=torch.float64) tensor(-10.9407, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.9345, dtype=torch.float64) delta_t tensor(-1.0438, dtype=torch.float64)
11 gae_duplicate tensor(-2.0804, dtype=torch.float64) tensor(18.0722, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3525, dtype=torch.float64) delta_t tensor(-0.3535, dtype=torch.float64)
10 gae_duplicate tensor(-0.8732, dtype=torch.float64) tensor(8.4584, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0736, dtype=torch.float64) delta_t tensor(-0.9600, dtype=torch.float64)
9 gae_duplicate tensor(-2.5075, dtype=torch.float64) tensor(18.4617, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5811, dtype=torch.float64) delta_t tensor(-0.5106, dtype=torch.float64)
8 gae_duplicate tensor(-3.9459, dtype=torch.float64) tensor(11.2162, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1590, dtype=torch.float64) delta_t tensor(-1.1322, dtype=torch.float64)
7 gae_duplicate tensor(-3.1627, dtype=torch.float64) tensor(25.1076, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5393, dtype=torch.float64) delta_t tensor(-0.4492, dtype=torch.float64)
6 gae_duplicate tensor(-2.6110, dtype=torch.float64) tensor(9.9832, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9752, dtype=torch.float64) delta_t tensor(-0.8508, dtype=torch.float64)
5 gae_duplicate tensor(-3.7072, dtype=torch.float64) tensor(18.3415, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5639, dtype=torch.float64) delta_t tensor(0.4409, dtype=torch.float64)
4 gae_duplicate tensor(-0.0321, dtype=torch.float64) tensor(-6.8068, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4661, dtype=torch.float64) delta_t tensor(-0.1711, dtype=torch.float64)
3 gae_duplicate tensor(-0.8854, dtype=torch.float64) tensor(2.1764, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1419, dtype=torch.float64) delta_t tensor(0.0553, dtype=torch.float64)
2 gae_duplicate tensor(-0.5358, dtype=torch.float64) tensor(-0.7388, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2381.392822265625
value loss:173.37252807617188
entropies:351.18121337890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.90018105506897 seconds
19 rew tensor(0.8788, dtype=torch.float64) delta_t tensor(0.3390, dtype=torch.float64)
19 gae_duplicate tensor(0.2387, dtype=torch.float64) tensor(-6.4316, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8516, dtype=torch.float64) delta_t tensor(0.3694, dtype=torch.float64)
18 gae_duplicate tensor(0.2707, dtype=torch.float64) tensor(-7.5534, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7605, dtype=torch.float64) delta_t tensor(0.3078, dtype=torch.float64)
17 gae_duplicate tensor(0.1588, dtype=torch.float64) tensor(-7.1582, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7419, dtype=torch.float64) delta_t tensor(0.3299, dtype=torch.float64)
16 gae_duplicate tensor(0.1748, dtype=torch.float64) tensor(-7.4954, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6589, dtype=torch.float64) delta_t tensor(0.2888, dtype=torch.float64)
15 gae_duplicate tensor(0.1916, dtype=torch.float64) tensor(-6.4719, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4464, dtype=torch.float64) delta_t tensor(0.1858, dtype=torch.float64)
14 gae_duplicate tensor(-0.6432, dtype=torch.float64) tensor(-4.8546, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6057, dtype=torch.float64) delta_t tensor(0.5416, dtype=torch.float64)
13 gae_duplicate tensor(0.1663, dtype=torch.float64) tensor(-10.9604, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0902, dtype=torch.float64) delta_t tensor(-0.0794, dtype=torch.float64)
12 gae_duplicate tensor(-0.7396, dtype=torch.float64) tensor(0.4784, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0298, dtype=torch.float64) delta_t tensor(-0.0777, dtype=torch.float64)
11 gae_duplicate tensor(-1.7225, dtype=torch.float64) tensor(1.7320, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3246, dtype=torch.float64) delta_t tensor(-0.2574, dtype=torch.float64)
10 gae_duplicate tensor(-2.2408, dtype=torch.float64) tensor(4.7672, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9156, dtype=torch.float64) delta_t tensor(-0.9129, dtype=torch.float64)
9 gae_duplicate tensor(-3.1494, dtype=torch.float64) tensor(19.6980, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.5761, dtype=torch.float64) delta_t tensor(-1.3934, dtype=torch.float64)
8 gae_duplicate tensor(-3.4363, dtype=torch.float64) tensor(26.3608, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4000, dtype=torch.float64) delta_t tensor(-0.3421, dtype=torch.float64)
7 gae_duplicate tensor(-1.9433, dtype=torch.float64) tensor(9.4733, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1215, dtype=torch.float64) delta_t tensor(0.2345, dtype=torch.float64)
6 gae_duplicate tensor(-0.1812, dtype=torch.float64) tensor(-3.5824, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0728, dtype=torch.float64) delta_t tensor(0.0763, dtype=torch.float64)
5 gae_duplicate tensor(-0.8682, dtype=torch.float64) tensor(-1.4768, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1645, dtype=torch.float64) delta_t tensor(0.1632, dtype=torch.float64)
4 gae_duplicate tensor(-0.3412, dtype=torch.float64) tensor(-2.9801, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1219, dtype=torch.float64) delta_t tensor(0.3315, dtype=torch.float64)
3 gae_duplicate tensor(-0.6634, dtype=torch.float64) tensor(-6.9954, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3207, dtype=torch.float64) delta_t tensor(-0.2660, dtype=torch.float64)
2 gae_duplicate tensor(-0.6017, dtype=torch.float64) tensor(4.8542, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-170.54580688476562
value loss:133.1385040283203
entropies:350.89483642578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.247844934463501 seconds
19 rew tensor(0.8881, dtype=torch.float64) delta_t tensor(0.3197, dtype=torch.float64)
19 gae_duplicate tensor(0.2395, dtype=torch.float64) tensor(-5.9476, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8310, dtype=torch.float64) delta_t tensor(0.3614, dtype=torch.float64)
18 gae_duplicate tensor(0.2542, dtype=torch.float64) tensor(-7.7240, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7987, dtype=torch.float64) delta_t tensor(0.2955, dtype=torch.float64)
17 gae_duplicate tensor(0.2268, dtype=torch.float64) tensor(-6.3783, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4805, dtype=torch.float64) delta_t tensor(0.1124, dtype=torch.float64)
16 gae_duplicate tensor(-0.9466, dtype=torch.float64) tensor(-3.2444, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6111, dtype=torch.float64) delta_t tensor(0.1300, dtype=torch.float64)
15 gae_duplicate tensor(-0.9189, dtype=torch.float64) tensor(-2.8199, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5787, dtype=torch.float64) delta_t tensor(0.2831, dtype=torch.float64)
14 gae_duplicate tensor(0.1501, dtype=torch.float64) tensor(-5.5920, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6753, dtype=torch.float64) delta_t tensor(0.5444, dtype=torch.float64)
13 gae_duplicate tensor(0.3457, dtype=torch.float64) tensor(-11.3183, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5463, dtype=torch.float64) delta_t tensor(0.2968, dtype=torch.float64)
12 gae_duplicate tensor(0.2213, dtype=torch.float64) tensor(-7.2160, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0316, dtype=torch.float64) delta_t tensor(-0.0577, dtype=torch.float64)
11 gae_duplicate tensor(-0.9723, dtype=torch.float64) tensor(0.4027, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3100, dtype=torch.float64) delta_t tensor(-0.3815, dtype=torch.float64)
10 gae_duplicate tensor(-1.3396, dtype=torch.float64) tensor(7.5637, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2547, dtype=torch.float64) delta_t tensor(-1.1931, dtype=torch.float64)
9 gae_duplicate tensor(-4.0575, dtype=torch.float64) tensor(21.7643, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8843, dtype=torch.float64) delta_t tensor(-0.7285, dtype=torch.float64)
8 gae_duplicate tensor(-4.3250, dtype=torch.float64) tensor(17.8402, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1611, dtype=torch.float64) delta_t tensor(0.2018, dtype=torch.float64)
7 gae_duplicate tensor(-1.2242, dtype=torch.float64) tensor(-2.0769, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1666, dtype=torch.float64) delta_t tensor(0.1374, dtype=torch.float64)
6 gae_duplicate tensor(-0.4354, dtype=torch.float64) tensor(-2.9880, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0758, dtype=torch.float64) delta_t tensor(0.1606, dtype=torch.float64)
5 gae_duplicate tensor(-0.2653, dtype=torch.float64) tensor(-3.2780, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0164, dtype=torch.float64) delta_t tensor(0.0042, dtype=torch.float64)
4 gae_duplicate tensor(-0.5759, dtype=torch.float64) tensor(-0.1874, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3032, dtype=torch.float64) delta_t tensor(0.5490, dtype=torch.float64)
3 gae_duplicate tensor(0.0269, dtype=torch.float64) tensor(-9.9722, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3805, dtype=torch.float64) delta_t tensor(-0.3050, dtype=torch.float64)
2 gae_duplicate tensor(-0.5572, dtype=torch.float64) tensor(4.9560, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:780.94091796875
value loss:117.98888397216797
entropies:350.86004638671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.797464847564697 seconds
19 rew tensor(0.8744, dtype=torch.float64) delta_t tensor(0.2494, dtype=torch.float64)
19 gae_duplicate tensor(0.1411, dtype=torch.float64) tensor(-4.8012, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8465, dtype=torch.float64) delta_t tensor(0.3156, dtype=torch.float64)
18 gae_duplicate tensor(0.2148, dtype=torch.float64) tensor(-6.8582, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8587, dtype=torch.float64) delta_t tensor(0.2820, dtype=torch.float64)
17 gae_duplicate tensor(0.2220, dtype=torch.float64) tensor(-6.3236, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6273, dtype=torch.float64) delta_t tensor(0.2883, dtype=torch.float64)
16 gae_duplicate tensor(0.0590, dtype=torch.float64) tensor(-5.9062, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6841, dtype=torch.float64) delta_t tensor(0.1363, dtype=torch.float64)
15 gae_duplicate tensor(0.0439, dtype=torch.float64) tensor(-3.2867, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2288, dtype=torch.float64) delta_t tensor(0.1426, dtype=torch.float64)
14 gae_duplicate tensor(-0.8725, dtype=torch.float64) tensor(-2.9736, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3236, dtype=torch.float64) delta_t tensor(0.1665, dtype=torch.float64)
13 gae_duplicate tensor(-2.1593, dtype=torch.float64) tensor(-2.5004, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0292, dtype=torch.float64) delta_t tensor(0.1490, dtype=torch.float64)
12 gae_duplicate tensor(-0.8481, dtype=torch.float64) tensor(-2.4089, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0238, dtype=torch.float64) delta_t tensor(-0.0393, dtype=torch.float64)
11 gae_duplicate tensor(-1.6856, dtype=torch.float64) tensor(-0.4741, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0792, dtype=torch.float64) delta_t tensor(0.1488, dtype=torch.float64)
10 gae_duplicate tensor(-0.9410, dtype=torch.float64) tensor(-2.4587, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3239, dtype=torch.float64) delta_t tensor(0.3637, dtype=torch.float64)
9 gae_duplicate tensor(-0.6604, dtype=torch.float64) tensor(-7.1746, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1912, dtype=torch.float64) delta_t tensor(-0.8812, dtype=torch.float64)
8 gae_duplicate tensor(-2.3195, dtype=torch.float64) tensor(17.1826, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0051, dtype=torch.float64) delta_t tensor(0.0761, dtype=torch.float64)
7 gae_duplicate tensor(-1.5643, dtype=torch.float64) tensor(-1.3513, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8103, dtype=torch.float64) delta_t tensor(-0.4277, dtype=torch.float64)
6 gae_duplicate tensor(-2.8248, dtype=torch.float64) tensor(9.9941, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4863, dtype=torch.float64) delta_t tensor(0.3673, dtype=torch.float64)
5 gae_duplicate tensor(0.1068, dtype=torch.float64) tensor(-6.6317, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2855, dtype=torch.float64) delta_t tensor(-0.0718, dtype=torch.float64)
4 gae_duplicate tensor(-0.4945, dtype=torch.float64) tensor(0.6283, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5732, dtype=torch.float64) delta_t tensor(0.7729, dtype=torch.float64)
3 gae_duplicate tensor(0.6472, dtype=torch.float64) tensor(-15.3819, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6005, dtype=torch.float64) delta_t tensor(-0.4983, dtype=torch.float64)
2 gae_duplicate tensor(-0.6343, dtype=torch.float64) tensor(8.0084, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1672.032470703125
value loss:82.00340270996094
entropies:350.8189697265625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3934.0598)
ToM Target loss= tensor(3490.8833)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.645906925201416 seconds
19 rew tensor(0.8840, dtype=torch.float64) delta_t tensor(0.1717, dtype=torch.float64)
19 gae_duplicate tensor(-0.0156, dtype=torch.float64) tensor(-3.3542, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8744, dtype=torch.float64) delta_t tensor(0.2438, dtype=torch.float64)
18 gae_duplicate tensor(0.1110, dtype=torch.float64) tensor(-5.4742, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8479, dtype=torch.float64) delta_t tensor(0.2504, dtype=torch.float64)
17 gae_duplicate tensor(0.0754, dtype=torch.float64) tensor(-4.8232, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7996, dtype=torch.float64) delta_t tensor(0.2970, dtype=torch.float64)
16 gae_duplicate tensor(0.1630, dtype=torch.float64) tensor(-6.8079, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6660, dtype=torch.float64) delta_t tensor(0.1966, dtype=torch.float64)
15 gae_duplicate tensor(-0.0270, dtype=torch.float64) tensor(-4.2936, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4067, dtype=torch.float64) delta_t tensor(0.1012, dtype=torch.float64)
14 gae_duplicate tensor(-0.8794, dtype=torch.float64) tensor(-2.5481, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6784, dtype=torch.float64) delta_t tensor(0.6563, dtype=torch.float64)
13 gae_duplicate tensor(0.1350, dtype=torch.float64) tensor(-12.3073, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3838, dtype=torch.float64) delta_t tensor(0.2158, dtype=torch.float64)
12 gae_duplicate tensor(-0.6243, dtype=torch.float64) tensor(-5.6964, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8159, dtype=torch.float64) delta_t tensor(-0.7879, dtype=torch.float64)
11 gae_duplicate tensor(-2.0481, dtype=torch.float64) tensor(15.3970, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1453, dtype=torch.float64) delta_t tensor(0.1041, dtype=torch.float64)
10 gae_duplicate tensor(-0.9808, dtype=torch.float64) tensor(0.3317, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5279, dtype=torch.float64) delta_t tensor(-1.3624, dtype=torch.float64)
9 gae_duplicate tensor(-4.0646, dtype=torch.float64) tensor(25.9231, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.2054, dtype=torch.float64) delta_t tensor(-1.9063, dtype=torch.float64)
8 gae_duplicate tensor(-3.3774, dtype=torch.float64) tensor(39.9155, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2463, dtype=torch.float64) delta_t tensor(-0.0088, dtype=torch.float64)
7 gae_duplicate tensor(-2.0731, dtype=torch.float64) tensor(4.8430, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2820, dtype=torch.float64) delta_t tensor(0.3339, dtype=torch.float64)
6 gae_duplicate tensor(-0.3172, dtype=torch.float64) tensor(-5.9830, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0309, dtype=torch.float64) delta_t tensor(0.2815, dtype=torch.float64)
5 gae_duplicate tensor(0.0848, dtype=torch.float64) tensor(-6.5781, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2981, dtype=torch.float64) delta_t tensor(0.3203, dtype=torch.float64)
4 gae_duplicate tensor(-0.3508, dtype=torch.float64) tensor(-6.2961, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1986, dtype=torch.float64) delta_t tensor(0.5891, dtype=torch.float64)
3 gae_duplicate tensor(0.3035, dtype=torch.float64) tensor(-11.8282, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3489, dtype=torch.float64) delta_t tensor(-0.2942, dtype=torch.float64)
2 gae_duplicate tensor(-0.7144, dtype=torch.float64) tensor(4.8258, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-917.9266357421875
value loss:148.2581024169922
entropies:350.51544189453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.871880054473877 seconds
19 rew tensor(0.8747, dtype=torch.float64) delta_t tensor(0.0825, dtype=torch.float64)
19 gae_duplicate tensor(-0.1265, dtype=torch.float64) tensor(-1.5156, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7793, dtype=torch.float64) delta_t tensor(0.0746, dtype=torch.float64)
18 gae_duplicate tensor(-0.0399, dtype=torch.float64) tensor(-1.8633, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7431, dtype=torch.float64) delta_t tensor(0.1499, dtype=torch.float64)
17 gae_duplicate tensor(0.0072, dtype=torch.float64) tensor(-3.0976, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7355, dtype=torch.float64) delta_t tensor(0.0858, dtype=torch.float64)
16 gae_duplicate tensor(-0.1265, dtype=torch.float64) tensor(-1.8940, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4242, dtype=torch.float64) delta_t tensor(-0.0501, dtype=torch.float64)
15 gae_duplicate tensor(-0.9936, dtype=torch.float64) tensor(1.0784, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6639, dtype=torch.float64) delta_t tensor(0.2978, dtype=torch.float64)
14 gae_duplicate tensor(0.1326, dtype=torch.float64) tensor(-5.3025, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5201, dtype=torch.float64) delta_t tensor(0.4508, dtype=torch.float64)
13 gae_duplicate tensor(-0.0588, dtype=torch.float64) tensor(-9.9075, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4482, dtype=torch.float64) delta_t tensor(0.2798, dtype=torch.float64)
12 gae_duplicate tensor(-0.6465, dtype=torch.float64) tensor(-6.6257, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2492, dtype=torch.float64) delta_t tensor(-0.2033, dtype=torch.float64)
11 gae_duplicate tensor(-0.8676, dtype=torch.float64) tensor(2.4911, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2503, dtype=torch.float64) delta_t tensor(0.5123, dtype=torch.float64)
10 gae_duplicate tensor(-0.3465, dtype=torch.float64) tensor(-10.1894, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.7433, dtype=torch.float64) delta_t tensor(-2.4288, dtype=torch.float64)
9 gae_duplicate tensor(-6.5393, dtype=torch.float64) tensor(47.6477, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3196, dtype=torch.float64) delta_t tensor(-0.0948, dtype=torch.float64)
8 gae_duplicate tensor(-3.0133, dtype=torch.float64) tensor(7.0728, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8444, dtype=torch.float64) delta_t tensor(-0.5810, dtype=torch.float64)
7 gae_duplicate tensor(-2.7285, dtype=torch.float64) tensor(11.8556, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1637, dtype=torch.float64) delta_t tensor(0.3490, dtype=torch.float64)
6 gae_duplicate tensor(-0.4814, dtype=torch.float64) tensor(-6.4627, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4286, dtype=torch.float64) delta_t tensor(-0.0471, dtype=torch.float64)
5 gae_duplicate tensor(-0.4548, dtype=torch.float64) tensor(0.2038, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4332, dtype=torch.float64) delta_t tensor(0.4738, dtype=torch.float64)
4 gae_duplicate tensor(-0.0446, dtype=torch.float64) tensor(-9.3623, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1985, dtype=torch.float64) delta_t tensor(0.2167, dtype=torch.float64)
3 gae_duplicate tensor(-0.3049, dtype=torch.float64) tensor(-5.1305, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0544, dtype=torch.float64) delta_t tensor(-0.0297, dtype=torch.float64)
2 gae_duplicate tensor(-0.3590, dtype=torch.float64) tensor(0.0742, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-584.43701171875
value loss:151.00332641601562
entropies:350.113525390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7278430461883545 seconds
19 rew tensor(0.8654, dtype=torch.float64) delta_t tensor(0.0086, dtype=torch.float64)
19 gae_duplicate tensor(-0.1675, dtype=torch.float64) tensor(-0.2240, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8762, dtype=torch.float64) delta_t tensor(0.1061, dtype=torch.float64)
18 gae_duplicate tensor(-0.0533, dtype=torch.float64) tensor(-2.3421, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7802, dtype=torch.float64) delta_t tensor(-0.0026, dtype=torch.float64)
17 gae_duplicate tensor(-0.0832, dtype=torch.float64) tensor(-0.3328, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6514, dtype=torch.float64) delta_t tensor(0.1861, dtype=torch.float64)
16 gae_duplicate tensor(-0.0446, dtype=torch.float64) tensor(-3.9344, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7020, dtype=torch.float64) delta_t tensor(-0.0080, dtype=torch.float64)
15 gae_duplicate tensor(-0.1324, dtype=torch.float64) tensor(-0.1027, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5242, dtype=torch.float64) delta_t tensor(0.2069, dtype=torch.float64)
14 gae_duplicate tensor(-0.1259, dtype=torch.float64) tensor(-4.0985, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6697, dtype=torch.float64) delta_t tensor(0.3283, dtype=torch.float64)
13 gae_duplicate tensor(-0.0886, dtype=torch.float64) tensor(-6.0360, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1965, dtype=torch.float64) delta_t tensor(0.0474, dtype=torch.float64)
12 gae_duplicate tensor(-0.7089, dtype=torch.float64) tensor(-1.4535, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7985, dtype=torch.float64) delta_t tensor(-0.7222, dtype=torch.float64)
11 gae_duplicate tensor(-1.7759, dtype=torch.float64) tensor(13.2180, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0530, dtype=torch.float64) delta_t tensor(0.3089, dtype=torch.float64)
10 gae_duplicate tensor(-0.7573, dtype=torch.float64) tensor(-5.0961, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0800, dtype=torch.float64) delta_t tensor(0.1481, dtype=torch.float64)
9 gae_duplicate tensor(-1.2250, dtype=torch.float64) tensor(-3.1428, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1815, dtype=torch.float64) delta_t tensor(-0.6990, dtype=torch.float64)
8 gae_duplicate tensor(-3.1771, dtype=torch.float64) tensor(14.7717, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3808, dtype=torch.float64) delta_t tensor(-0.2769, dtype=torch.float64)
7 gae_duplicate tensor(-3.2115, dtype=torch.float64) tensor(5.4410, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5003, dtype=torch.float64) delta_t tensor(-0.0906, dtype=torch.float64)
6 gae_duplicate tensor(-1.9917, dtype=torch.float64) tensor(2.7604, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1577, dtype=torch.float64) delta_t tensor(0.2661, dtype=torch.float64)
5 gae_duplicate tensor(-0.3859, dtype=torch.float64) tensor(-4.6419, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0535, dtype=torch.float64) delta_t tensor(0.0341, dtype=torch.float64)
4 gae_duplicate tensor(-0.5310, dtype=torch.float64) tensor(-1.1195, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3225, dtype=torch.float64) delta_t tensor(0.5818, dtype=torch.float64)
3 gae_duplicate tensor(0.0495, dtype=torch.float64) tensor(-12.3059, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4152, dtype=torch.float64) delta_t tensor(-0.3124, dtype=torch.float64)
2 gae_duplicate tensor(-0.5462, dtype=torch.float64) tensor(5.1264, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:95.22550201416016
value loss:88.38005828857422
entropies:349.806396484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.238038063049316 seconds
19 rew tensor(0.8670, dtype=torch.float64) delta_t tensor(-0.0782, dtype=torch.float64)
19 gae_duplicate tensor(-0.1495, dtype=torch.float64) tensor(1.7331, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7762, dtype=torch.float64) delta_t tensor(-0.0824, dtype=torch.float64)
18 gae_duplicate tensor(-0.2878, dtype=torch.float64) tensor(1.8375, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8180, dtype=torch.float64) delta_t tensor(0.0703, dtype=torch.float64)
17 gae_duplicate tensor(-0.0419, dtype=torch.float64) tensor(-1.1471, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7564, dtype=torch.float64) delta_t tensor(0.1072, dtype=torch.float64)
16 gae_duplicate tensor(0.0039, dtype=torch.float64) tensor(-2.2116, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6173, dtype=torch.float64) delta_t tensor(0.0099, dtype=torch.float64)
15 gae_duplicate tensor(-0.2231, dtype=torch.float64) tensor(-0.3710, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3648, dtype=torch.float64) delta_t tensor(0.0549, dtype=torch.float64)
14 gae_duplicate tensor(-0.8130, dtype=torch.float64) tensor(-1.3389, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6445, dtype=torch.float64) delta_t tensor(0.6714, dtype=torch.float64)
13 gae_duplicate tensor(0.4759, dtype=torch.float64) tensor(-13.2002, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3078, dtype=torch.float64) delta_t tensor(0.1221, dtype=torch.float64)
12 gae_duplicate tensor(-0.8966, dtype=torch.float64) tensor(-3.4274, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4966, dtype=torch.float64) delta_t tensor(-0.4901, dtype=torch.float64)
11 gae_duplicate tensor(-1.5921, dtype=torch.float64) tensor(8.1228, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2176, dtype=torch.float64) delta_t tensor(0.1594, dtype=torch.float64)
10 gae_duplicate tensor(-0.5957, dtype=torch.float64) tensor(-2.4494, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.9478, dtype=torch.float64) delta_t tensor(-1.7547, dtype=torch.float64)
9 gae_duplicate tensor(-3.6726, dtype=torch.float64) tensor(35.3711, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2872, dtype=torch.float64) delta_t tensor(-0.8822, dtype=torch.float64)
8 gae_duplicate tensor(-3.3528, dtype=torch.float64) tensor(19.7208, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2863, dtype=torch.float64) delta_t tensor(-0.0978, dtype=torch.float64)
7 gae_duplicate tensor(-1.9798, dtype=torch.float64) tensor(3.3339, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2033, dtype=torch.float64) delta_t tensor(0.4080, dtype=torch.float64)
6 gae_duplicate tensor(-0.1826, dtype=torch.float64) tensor(-8.2491, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0697, dtype=torch.float64) delta_t tensor(0.2984, dtype=torch.float64)
5 gae_duplicate tensor(0.2009, dtype=torch.float64) tensor(-6.3319, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2580, dtype=torch.float64) delta_t tensor(0.3349, dtype=torch.float64)
4 gae_duplicate tensor(-0.0513, dtype=torch.float64) tensor(-7.2516, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1354, dtype=torch.float64) delta_t tensor(0.5847, dtype=torch.float64)
3 gae_duplicate tensor(0.3848, dtype=torch.float64) tensor(-11.7031, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3165, dtype=torch.float64) delta_t tensor(-0.2615, dtype=torch.float64)
2 gae_duplicate tensor(-0.4628, dtype=torch.float64) tensor(4.1276, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-988.8882446289062
value loss:122.84060668945312
entropies:349.4362487792969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.721297025680542 seconds
19 rew tensor(0.8879, dtype=torch.float64) delta_t tensor(-0.1579, dtype=torch.float64)
19 gae_duplicate tensor(-0.2269, dtype=torch.float64) tensor(2.9572, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(-0.0428, dtype=torch.float64)
18 gae_duplicate tensor(-0.1033, dtype=torch.float64) tensor(1.0995, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8499, dtype=torch.float64) delta_t tensor(-0.0821, dtype=torch.float64)
17 gae_duplicate tensor(-0.1649, dtype=torch.float64) tensor(1.6414, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7345, dtype=torch.float64) delta_t tensor(-0.0151, dtype=torch.float64)
16 gae_duplicate tensor(-0.2928, dtype=torch.float64) tensor(0.6351, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6732, dtype=torch.float64) delta_t tensor(-0.0822, dtype=torch.float64)
15 gae_duplicate tensor(-0.2920, dtype=torch.float64) tensor(1.0825, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5746, dtype=torch.float64) delta_t tensor(0.0951, dtype=torch.float64)
14 gae_duplicate tensor(-0.1889, dtype=torch.float64) tensor(-2.0009, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5164, dtype=torch.float64) delta_t tensor(0.1264, dtype=torch.float64)
13 gae_duplicate tensor(-0.8857, dtype=torch.float64) tensor(-2.5112, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2418, dtype=torch.float64) delta_t tensor(-0.0317, dtype=torch.float64)
12 gae_duplicate tensor(-1.3140, dtype=torch.float64) tensor(0.1237, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0905, dtype=torch.float64) delta_t tensor(-0.0889, dtype=torch.float64)
11 gae_duplicate tensor(-0.7512, dtype=torch.float64) tensor(1.2809, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6551, dtype=torch.float64) delta_t tensor(-0.2118, dtype=torch.float64)
10 gae_duplicate tensor(-1.5900, dtype=torch.float64) tensor(3.8167, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8425, dtype=torch.float64) delta_t tensor(-0.7074, dtype=torch.float64)
9 gae_duplicate tensor(-3.8451, dtype=torch.float64) tensor(12.3684, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8686, dtype=torch.float64) delta_t tensor(-0.4447, dtype=torch.float64)
8 gae_duplicate tensor(-2.1101, dtype=torch.float64) tensor(10.0020, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1422, dtype=torch.float64) delta_t tensor(0.0585, dtype=torch.float64)
7 gae_duplicate tensor(-1.5268, dtype=torch.float64) tensor(0.1611, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7149, dtype=torch.float64) delta_t tensor(-0.2201, dtype=torch.float64)
6 gae_duplicate tensor(-4.6477, dtype=torch.float64) tensor(7.7861, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0119, dtype=torch.float64) delta_t tensor(0.0127, dtype=torch.float64)
5 gae_duplicate tensor(-1.3164, dtype=torch.float64) tensor(0.9053, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0937, dtype=torch.float64) delta_t tensor(0.2330, dtype=torch.float64)
4 gae_duplicate tensor(-0.1864, dtype=torch.float64) tensor(-4.6339, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2264, dtype=torch.float64) delta_t tensor(0.3259, dtype=torch.float64)
3 gae_duplicate tensor(-0.0570, dtype=torch.float64) tensor(-6.7670, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4644, dtype=torch.float64) delta_t tensor(-0.3665, dtype=torch.float64)
2 gae_duplicate tensor(-0.7067, dtype=torch.float64) tensor(6.7628, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1968.579833984375
value loss:110.15721893310547
entropies:349.06689453125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3912.0322)
ToM Target loss= tensor(3491.0413)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.650586843490601 seconds
19 rew tensor(0.8075, dtype=torch.float64) delta_t tensor(-0.2789, dtype=torch.float64)
19 gae_duplicate tensor(-0.3648, dtype=torch.float64) tensor(5.5916, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8072, dtype=torch.float64) delta_t tensor(-0.1248, dtype=torch.float64)
18 gae_duplicate tensor(-0.3056, dtype=torch.float64) tensor(3.4269, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7512, dtype=torch.float64) delta_t tensor(-0.1948, dtype=torch.float64)
17 gae_duplicate tensor(-0.2897, dtype=torch.float64) tensor(3.7161, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7364, dtype=torch.float64) delta_t tensor(0.0033, dtype=torch.float64)
16 gae_duplicate tensor(-0.1814, dtype=torch.float64) tensor(-0.1221, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4470, dtype=torch.float64) delta_t tensor(-0.2173, dtype=torch.float64)
15 gae_duplicate tensor(-1.1426, dtype=torch.float64) tensor(4.2964, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5804, dtype=torch.float64) delta_t tensor(0.1619, dtype=torch.float64)
14 gae_duplicate tensor(-0.2731, dtype=torch.float64) tensor(-2.8234, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4724, dtype=torch.float64) delta_t tensor(0.1776, dtype=torch.float64)
13 gae_duplicate tensor(-0.6875, dtype=torch.float64) tensor(-3.7623, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5220, dtype=torch.float64) delta_t tensor(0.4021, dtype=torch.float64)
12 gae_duplicate tensor(-0.1043, dtype=torch.float64) tensor(-7.6884, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1608, dtype=torch.float64) delta_t tensor(-0.4930, dtype=torch.float64)
11 gae_duplicate tensor(-1.8658, dtype=torch.float64) tensor(9.2535, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0485, dtype=torch.float64) delta_t tensor(0.1478, dtype=torch.float64)
10 gae_duplicate tensor(-1.0135, dtype=torch.float64) tensor(-1.0459, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.1624, dtype=torch.float64) delta_t tensor(-1.8603, dtype=torch.float64)
9 gae_duplicate tensor(-4.1953, dtype=torch.float64) tensor(38.1296, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2815, dtype=torch.float64) delta_t tensor(0.0685, dtype=torch.float64)
8 gae_duplicate tensor(-2.0690, dtype=torch.float64) tensor(2.4245, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2878, dtype=torch.float64) delta_t tensor(-0.1313, dtype=torch.float64)
7 gae_duplicate tensor(-1.8121, dtype=torch.float64) tensor(1.6542, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2554, dtype=torch.float64) delta_t tensor(0.1568, dtype=torch.float64)
6 gae_duplicate tensor(-1.5653, dtype=torch.float64) tensor(-3.0964, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1205, dtype=torch.float64) delta_t tensor(0.1098, dtype=torch.float64)
5 gae_duplicate tensor(-1.3657, dtype=torch.float64) tensor(-1.7608, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2368, dtype=torch.float64) delta_t tensor(0.3319, dtype=torch.float64)
4 gae_duplicate tensor(0.0326, dtype=torch.float64) tensor(-6.6851, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0851, dtype=torch.float64) delta_t tensor(0.4285, dtype=torch.float64)
3 gae_duplicate tensor(0.0904, dtype=torch.float64) tensor(-8.2834, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2109, dtype=torch.float64) delta_t tensor(-0.1535, dtype=torch.float64)
2 gae_duplicate tensor(-0.3926, dtype=torch.float64) tensor(2.2921, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2011.9945068359375
value loss:125.44947052001953
entropies:348.365234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7941508293151855 seconds
19 rew tensor(0.8348, dtype=torch.float64) delta_t tensor(-0.2478, dtype=torch.float64)
19 gae_duplicate tensor(-0.3584, dtype=torch.float64) tensor(4.8215, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7957, dtype=torch.float64) delta_t tensor(-0.2072, dtype=torch.float64)
18 gae_duplicate tensor(-0.4299, dtype=torch.float64) tensor(4.5117, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7599, dtype=torch.float64) delta_t tensor(-0.0906, dtype=torch.float64)
17 gae_duplicate tensor(-0.3782, dtype=torch.float64) tensor(1.9710, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7230, dtype=torch.float64) delta_t tensor(0.0029, dtype=torch.float64)
16 gae_duplicate tensor(-0.2805, dtype=torch.float64) tensor(0.4843, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6380, dtype=torch.float64) delta_t tensor(-0.1510, dtype=torch.float64)
15 gae_duplicate tensor(-0.3926, dtype=torch.float64) tensor(2.9269, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1921, dtype=torch.float64) delta_t tensor(-0.0351, dtype=torch.float64)
14 gae_duplicate tensor(-0.7425, dtype=torch.float64) tensor(1.1618, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6245, dtype=torch.float64) delta_t tensor(0.4155, dtype=torch.float64)
13 gae_duplicate tensor(-0.3945, dtype=torch.float64) tensor(-7.6506, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2593, dtype=torch.float64) delta_t tensor(0.1415, dtype=torch.float64)
12 gae_duplicate tensor(-1.0139, dtype=torch.float64) tensor(-3.8137, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1643, dtype=torch.float64) delta_t tensor(-0.1092, dtype=torch.float64)
11 gae_duplicate tensor(-0.6802, dtype=torch.float64) tensor(1.1066, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1744, dtype=torch.float64) delta_t tensor(0.5862, dtype=torch.float64)
10 gae_duplicate tensor(-0.3583, dtype=torch.float64) tensor(-13.0125, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6133, dtype=torch.float64) delta_t tensor(-1.4727, dtype=torch.float64)
9 gae_duplicate tensor(-3.4840, dtype=torch.float64) tensor(26.3592, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4843, dtype=torch.float64) delta_t tensor(0.0344, dtype=torch.float64)
8 gae_duplicate tensor(-2.6444, dtype=torch.float64) tensor(-0.1018, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0349, dtype=torch.float64) delta_t tensor(0.2679, dtype=torch.float64)
7 gae_duplicate tensor(-1.5795, dtype=torch.float64) tensor(-5.3133, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1096, dtype=torch.float64) delta_t tensor(0.7747, dtype=torch.float64)
6 gae_duplicate tensor(0.6115, dtype=torch.float64) tensor(-15.0261, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2249, dtype=torch.float64) delta_t tensor(0.3549, dtype=torch.float64)
5 gae_duplicate tensor(0.2896, dtype=torch.float64) tensor(-7.9756, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0179, dtype=torch.float64) delta_t tensor(0.2136, dtype=torch.float64)
4 gae_duplicate tensor(-0.3660, dtype=torch.float64) tensor(-4.8470, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2923, dtype=torch.float64) delta_t tensor(0.5774, dtype=torch.float64)
3 gae_duplicate tensor(0.1495, dtype=torch.float64) tensor(-11.4753, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4444, dtype=torch.float64) delta_t tensor(-0.3035, dtype=torch.float64)
2 gae_duplicate tensor(-0.4615, dtype=torch.float64) tensor(4.5195, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1059.3323974609375
value loss:90.8485336303711
entropies:347.2197265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.154044151306152 seconds
19 rew tensor(0.8588, dtype=torch.float64) delta_t tensor(-0.2676, dtype=torch.float64)
19 gae_duplicate tensor(-0.3647, dtype=torch.float64) tensor(4.3144, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5832, dtype=torch.float64) delta_t tensor(-0.2896, dtype=torch.float64)
18 gae_duplicate tensor(-1.5234, dtype=torch.float64) tensor(5.6958, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7612, dtype=torch.float64) delta_t tensor(0.0346, dtype=torch.float64)
17 gae_duplicate tensor(-0.2924, dtype=torch.float64) tensor(-0.2215, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6858, dtype=torch.float64) delta_t tensor(-0.1037, dtype=torch.float64)
16 gae_duplicate tensor(-0.3790, dtype=torch.float64) tensor(2.5750, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2902, dtype=torch.float64) delta_t tensor(-0.0974, dtype=torch.float64)
15 gae_duplicate tensor(-1.2976, dtype=torch.float64) tensor(2.0384, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4833, dtype=torch.float64) delta_t tensor(-0.0135, dtype=torch.float64)
14 gae_duplicate tensor(-0.9780, dtype=torch.float64) tensor(-0.4067, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2930, dtype=torch.float64) delta_t tensor(0.3497, dtype=torch.float64)
13 gae_duplicate tensor(-0.4318, dtype=torch.float64) tensor(-5.6782, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6878, dtype=torch.float64) delta_t tensor(0.4132, dtype=torch.float64)
12 gae_duplicate tensor(0.0814, dtype=torch.float64) tensor(-8.7427, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1291, dtype=torch.float64) delta_t tensor(0.0052, dtype=torch.float64)
11 gae_duplicate tensor(-0.8044, dtype=torch.float64) tensor(-0.1082, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0689, dtype=torch.float64) delta_t tensor(0.0910, dtype=torch.float64)
10 gae_duplicate tensor(-0.8603, dtype=torch.float64) tensor(-1.4781, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6951, dtype=torch.float64) delta_t tensor(-1.0215, dtype=torch.float64)
9 gae_duplicate tensor(-3.0875, dtype=torch.float64) tensor(19.7828, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3985, dtype=torch.float64) delta_t tensor(-0.3298, dtype=torch.float64)
8 gae_duplicate tensor(-4.3455, dtype=torch.float64) tensor(9.8824, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6239, dtype=torch.float64) delta_t tensor(-1.1073, dtype=torch.float64)
7 gae_duplicate tensor(-2.2408, dtype=torch.float64) tensor(25.4513, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1960, dtype=torch.float64) delta_t tensor(0.1454, dtype=torch.float64)
6 gae_duplicate tensor(-1.0077, dtype=torch.float64) tensor(-0.8666, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4713, dtype=torch.float64) delta_t tensor(0.0800, dtype=torch.float64)
5 gae_duplicate tensor(-0.5647, dtype=torch.float64) tensor(-1.5511, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4378, dtype=torch.float64) delta_t tensor(0.4709, dtype=torch.float64)
4 gae_duplicate tensor(0.1464, dtype=torch.float64) tensor(-9.4338, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3302, dtype=torch.float64) delta_t tensor(0.3116, dtype=torch.float64)
3 gae_duplicate tensor(-0.1713, dtype=torch.float64) tensor(-8.0784, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0332, dtype=torch.float64) delta_t tensor(0.0018, dtype=torch.float64)
2 gae_duplicate tensor(-0.5501, dtype=torch.float64) tensor(-1.3469, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1812.30712890625
value loss:124.1314926147461
entropies:346.6730041503906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.900715112686157 seconds
19 rew tensor(0.8800, dtype=torch.float64) delta_t tensor(-0.2343, dtype=torch.float64)
19 gae_duplicate tensor(-0.4096, dtype=torch.float64) tensor(4.2322, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6953, dtype=torch.float64) delta_t tensor(-0.1746, dtype=torch.float64)
18 gae_duplicate tensor(-1.3855, dtype=torch.float64) tensor(3.4755, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8626, dtype=torch.float64) delta_t tensor(0.0585, dtype=torch.float64)
17 gae_duplicate tensor(-0.4389, dtype=torch.float64) tensor(-0.8959, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6601, dtype=torch.float64) delta_t tensor(0.2449, dtype=torch.float64)
16 gae_duplicate tensor(-0.2939, dtype=torch.float64) tensor(-4.7398, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4593, dtype=torch.float64) delta_t tensor(-0.0837, dtype=torch.float64)
15 gae_duplicate tensor(-0.8477, dtype=torch.float64) tensor(0.9572, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4910, dtype=torch.float64) delta_t tensor(0.2935, dtype=torch.float64)
14 gae_duplicate tensor(-0.2294, dtype=torch.float64) tensor(-5.5914, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6810, dtype=torch.float64) delta_t tensor(0.5729, dtype=torch.float64)
13 gae_duplicate tensor(-0.2349, dtype=torch.float64) tensor(-11.5400, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1787, dtype=torch.float64) delta_t tensor(0.0723, dtype=torch.float64)
12 gae_duplicate tensor(-0.8009, dtype=torch.float64) tensor(-2.0825, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0360, dtype=torch.float64) delta_t tensor(-0.1511, dtype=torch.float64)
11 gae_duplicate tensor(-0.8123, dtype=torch.float64) tensor(2.0516, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0369, dtype=torch.float64) delta_t tensor(0.5196, dtype=torch.float64)
10 gae_duplicate tensor(-0.0798, dtype=torch.float64) tensor(-8.5202, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8748, dtype=torch.float64) delta_t tensor(-0.7065, dtype=torch.float64)
9 gae_duplicate tensor(-3.1410, dtype=torch.float64) tensor(12.0700, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1052, dtype=torch.float64) delta_t tensor(-0.2730, dtype=torch.float64)
8 gae_duplicate tensor(-2.6829, dtype=torch.float64) tensor(6.0766, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0861, dtype=torch.float64) delta_t tensor(-0.0290, dtype=torch.float64)
7 gae_duplicate tensor(-2.7986, dtype=torch.float64) tensor(-1.0055, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3051, dtype=torch.float64) delta_t tensor(0.5379, dtype=torch.float64)
6 gae_duplicate tensor(-0.0108, dtype=torch.float64) tensor(-10.0873, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2622, dtype=torch.float64) delta_t tensor(0.3068, dtype=torch.float64)
5 gae_duplicate tensor(0.2103, dtype=torch.float64) tensor(-7.3300, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2610, dtype=torch.float64) delta_t tensor(0.1165, dtype=torch.float64)
4 gae_duplicate tensor(-0.1282, dtype=torch.float64) tensor(-3.3681, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4385, dtype=torch.float64) delta_t tensor(0.5130, dtype=torch.float64)
3 gae_duplicate tensor(0.2967, dtype=torch.float64) tensor(-10.4797, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5203, dtype=torch.float64) delta_t tensor(-0.3120, dtype=torch.float64)
2 gae_duplicate tensor(-0.4239, dtype=torch.float64) tensor(5.2057, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1611.6077880859375
value loss:86.67033386230469
entropies:345.41754150390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.731725692749023 seconds
19 rew tensor(0.8343, dtype=torch.float64) delta_t tensor(-0.3413, dtype=torch.float64)
19 gae_duplicate tensor(-0.4227, dtype=torch.float64) tensor(6.8631, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8357, dtype=torch.float64) delta_t tensor(-0.2207, dtype=torch.float64)
18 gae_duplicate tensor(-0.3733, dtype=torch.float64) tensor(5.2825, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8280, dtype=torch.float64) delta_t tensor(-0.0941, dtype=torch.float64)
17 gae_duplicate tensor(-0.2860, dtype=torch.float64) tensor(2.0876, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8099, dtype=torch.float64) delta_t tensor(-0.0968, dtype=torch.float64)
16 gae_duplicate tensor(-0.2921, dtype=torch.float64) tensor(2.3538, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7040, dtype=torch.float64) delta_t tensor(-0.0163, dtype=torch.float64)
15 gae_duplicate tensor(-0.3841, dtype=torch.float64) tensor(0.1578, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7036, dtype=torch.float64) delta_t tensor(0.1839, dtype=torch.float64)
14 gae_duplicate tensor(-0.1974, dtype=torch.float64) tensor(-3.2930, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5846, dtype=torch.float64) delta_t tensor(0.4592, dtype=torch.float64)
13 gae_duplicate tensor(0.1919, dtype=torch.float64) tensor(-8.4444, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5796, dtype=torch.float64) delta_t tensor(0.4682, dtype=torch.float64)
12 gae_duplicate tensor(0.3276, dtype=torch.float64) tensor(-8.5103, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6234, dtype=torch.float64) delta_t tensor(-0.1094, dtype=torch.float64)
11 gae_duplicate tensor(-0.7016, dtype=torch.float64) tensor(0.6412, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1732, dtype=torch.float64) delta_t tensor(0.1796, dtype=torch.float64)
10 gae_duplicate tensor(-0.6129, dtype=torch.float64) tensor(-3.2506, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.6810, dtype=torch.float64) delta_t tensor(-1.9766, dtype=torch.float64)
9 gae_duplicate tensor(-5.1977, dtype=torch.float64) tensor(36.0188, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.0554, dtype=torch.float64) delta_t tensor(-1.5024, dtype=torch.float64)
8 gae_duplicate tensor(-3.8796, dtype=torch.float64) tensor(33.4519, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2218, dtype=torch.float64) delta_t tensor(-0.4758, dtype=torch.float64)
7 gae_duplicate tensor(-2.8258, dtype=torch.float64) tensor(14.4655, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1815, dtype=torch.float64) delta_t tensor(0.3565, dtype=torch.float64)
6 gae_duplicate tensor(-1.2260, dtype=torch.float64) tensor(-7.1327, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0803, dtype=torch.float64) delta_t tensor(0.5681, dtype=torch.float64)
5 gae_duplicate tensor(0.2930, dtype=torch.float64) tensor(-11.4018, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4851, dtype=torch.float64) delta_t tensor(0.5325, dtype=torch.float64)
4 gae_duplicate tensor(0.2475, dtype=torch.float64) tensor(-11.0561, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0147, dtype=torch.float64) delta_t tensor(0.5547, dtype=torch.float64)
3 gae_duplicate tensor(0.4065, dtype=torch.float64) tensor(-11.4579, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2154, dtype=torch.float64) delta_t tensor(-0.1470, dtype=torch.float64)
2 gae_duplicate tensor(-0.2940, dtype=torch.float64) tensor(1.5497, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2162.618896484375
value loss:152.43360900878906
entropies:344.7113037109375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3903.4543)
ToM Target loss= tensor(3507.4187)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.9384331703186035 seconds
19 rew tensor(0.8752, dtype=torch.float64) delta_t tensor(-0.2443, dtype=torch.float64)
19 gae_duplicate tensor(-0.3516, dtype=torch.float64) tensor(4.4886, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8496, dtype=torch.float64) delta_t tensor(0.0802, dtype=torch.float64)
18 gae_duplicate tensor(-0.3073, dtype=torch.float64) tensor(-1.5006, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7878, dtype=torch.float64) delta_t tensor(0.0721, dtype=torch.float64)
17 gae_duplicate tensor(-0.3142, dtype=torch.float64) tensor(-1.5951, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6353, dtype=torch.float64) delta_t tensor(0.2128, dtype=torch.float64)
16 gae_duplicate tensor(-0.2076, dtype=torch.float64) tensor(-3.6595, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6907, dtype=torch.float64) delta_t tensor(-0.0165, dtype=torch.float64)
15 gae_duplicate tensor(-0.3004, dtype=torch.float64) tensor(-0.3267, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3822, dtype=torch.float64) delta_t tensor(0.1785, dtype=torch.float64)
14 gae_duplicate tensor(-0.7064, dtype=torch.float64) tensor(-2.6928, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6047, dtype=torch.float64) delta_t tensor(0.4181, dtype=torch.float64)
13 gae_duplicate tensor(-0.0300, dtype=torch.float64) tensor(-7.5658, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2489, dtype=torch.float64) delta_t tensor(0.2693, dtype=torch.float64)
12 gae_duplicate tensor(-0.5589, dtype=torch.float64) tensor(-6.3315, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0366, dtype=torch.float64) delta_t tensor(-0.0643, dtype=torch.float64)
11 gae_duplicate tensor(-0.7119, dtype=torch.float64) tensor(0.1666, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0548, dtype=torch.float64) delta_t tensor(0.4997, dtype=torch.float64)
10 gae_duplicate tensor(-0.7990, dtype=torch.float64) tensor(-9.9544, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8903, dtype=torch.float64) delta_t tensor(-0.7723, dtype=torch.float64)
9 gae_duplicate tensor(-2.8606, dtype=torch.float64) tensor(14.4109, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1219, dtype=torch.float64) delta_t tensor(0.5705, dtype=torch.float64)
8 gae_duplicate tensor(-0.6210, dtype=torch.float64) tensor(-9.6691, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1993, dtype=torch.float64) delta_t tensor(0.4580, dtype=torch.float64)
7 gae_duplicate tensor(-0.6093, dtype=torch.float64) tensor(-9.8632, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0006, dtype=torch.float64) delta_t tensor(0.7907, dtype=torch.float64)
6 gae_duplicate tensor(0.4479, dtype=torch.float64) tensor(-16.1484, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1425, dtype=torch.float64) delta_t tensor(0.3380, dtype=torch.float64)
5 gae_duplicate tensor(0.2428, dtype=torch.float64) tensor(-7.9232, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0294, dtype=torch.float64) delta_t tensor(0.3723, dtype=torch.float64)
4 gae_duplicate tensor(0.0214, dtype=torch.float64) tensor(-8.0116, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1758, dtype=torch.float64) delta_t tensor(0.3319, dtype=torch.float64)
3 gae_duplicate tensor(0.0034, dtype=torch.float64) tensor(-7.0772, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4390, dtype=torch.float64) delta_t tensor(-0.1635, dtype=torch.float64)
2 gae_duplicate tensor(-0.2630, dtype=torch.float64) tensor(2.3574, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3735.515869140625
value loss:66.29183959960938
entropies:343.9101257324219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.147742986679077 seconds
19 rew tensor(0.8651, dtype=torch.float64) delta_t tensor(-0.3194, dtype=torch.float64)
19 gae_duplicate tensor(-0.4450, dtype=torch.float64) tensor(5.6209, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7873, dtype=torch.float64) delta_t tensor(-0.2295, dtype=torch.float64)
18 gae_duplicate tensor(-0.3267, dtype=torch.float64) tensor(4.4746, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7515, dtype=torch.float64) delta_t tensor(0.0210, dtype=torch.float64)
17 gae_duplicate tensor(-0.3052, dtype=torch.float64) tensor(-0.2060, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7321, dtype=torch.float64) delta_t tensor(0.0579, dtype=torch.float64)
16 gae_duplicate tensor(-0.2603, dtype=torch.float64) tensor(-1.4435, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6380, dtype=torch.float64) delta_t tensor(0.1248, dtype=torch.float64)
15 gae_duplicate tensor(-0.3792, dtype=torch.float64) tensor(-2.6109, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6246, dtype=torch.float64) delta_t tensor(0.3464, dtype=torch.float64)
14 gae_duplicate tensor(-0.0400, dtype=torch.float64) tensor(-6.7996, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4711, dtype=torch.float64) delta_t tensor(0.4368, dtype=torch.float64)
13 gae_duplicate tensor(0.3473, dtype=torch.float64) tensor(-9.6639, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6382, dtype=torch.float64) delta_t tensor(0.5470, dtype=torch.float64)
12 gae_duplicate tensor(0.3904, dtype=torch.float64) tensor(-11.0344, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2271, dtype=torch.float64) delta_t tensor(0.0924, dtype=torch.float64)
11 gae_duplicate tensor(-1.6253, dtype=torch.float64) tensor(-1.3117, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1330, dtype=torch.float64) delta_t tensor(-0.0234, dtype=torch.float64)
10 gae_duplicate tensor(-1.7692, dtype=torch.float64) tensor(0.4288, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5143, dtype=torch.float64) delta_t tensor(-0.8018, dtype=torch.float64)
9 gae_duplicate tensor(-3.5680, dtype=torch.float64) tensor(17.0366, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0305, dtype=torch.float64) delta_t tensor(0.5453, dtype=torch.float64)
8 gae_duplicate tensor(-1.1817, dtype=torch.float64) tensor(-9.1133, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9384, dtype=torch.float64) delta_t tensor(-0.5006, dtype=torch.float64)
7 gae_duplicate tensor(-4.0215, dtype=torch.float64) tensor(7.4701, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4653, dtype=torch.float64) delta_t tensor(0.2368, dtype=torch.float64)
6 gae_duplicate tensor(-1.5011, dtype=torch.float64) tensor(-3.3809, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3174, dtype=torch.float64) delta_t tensor(0.0935, dtype=torch.float64)
5 gae_duplicate tensor(-1.5208, dtype=torch.float64) tensor(-1.7174, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1927, dtype=torch.float64) delta_t tensor(0.4193, dtype=torch.float64)
4 gae_duplicate tensor(0.1701, dtype=torch.float64) tensor(-7.8078, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0555, dtype=torch.float64) delta_t tensor(0.4531, dtype=torch.float64)
3 gae_duplicate tensor(0.0548, dtype=torch.float64) tensor(-10.0492, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2040, dtype=torch.float64) delta_t tensor(-0.1199, dtype=torch.float64)
2 gae_duplicate tensor(-0.4331, dtype=torch.float64) tensor(1.4202, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1456.5595703125
value loss:116.23776245117188
entropies:342.82647705078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.130479097366333 seconds
19 rew tensor(0.8676, dtype=torch.float64) delta_t tensor(-0.3379, dtype=torch.float64)
19 gae_duplicate tensor(-0.4435, dtype=torch.float64) tensor(6.4760, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8702, dtype=torch.float64) delta_t tensor(-0.1184, dtype=torch.float64)
18 gae_duplicate tensor(-0.2604, dtype=torch.float64) tensor(2.7596, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7917, dtype=torch.float64) delta_t tensor(-0.2787, dtype=torch.float64)
17 gae_duplicate tensor(-0.4084, dtype=torch.float64) tensor(5.4053, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6827, dtype=torch.float64) delta_t tensor(0.5298, dtype=torch.float64)
16 gae_duplicate tensor(0.3982, dtype=torch.float64) tensor(-9.2306, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6876, dtype=torch.float64) delta_t tensor(0.0900, dtype=torch.float64)
15 gae_duplicate tensor(-0.3487, dtype=torch.float64) tensor(-2.7159, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2608, dtype=torch.float64) delta_t tensor(0.2229, dtype=torch.float64)
14 gae_duplicate tensor(-0.7297, dtype=torch.float64) tensor(-5.1844, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7834, dtype=torch.float64) delta_t tensor(0.5093, dtype=torch.float64)
13 gae_duplicate tensor(0.4084, dtype=torch.float64) tensor(-9.7110, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0934, dtype=torch.float64) delta_t tensor(0.1927, dtype=torch.float64)
12 gae_duplicate tensor(-0.7691, dtype=torch.float64) tensor(-5.6919, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3589, dtype=torch.float64) delta_t tensor(-0.5622, dtype=torch.float64)
11 gae_duplicate tensor(-1.7970, dtype=torch.float64) tensor(8.7852, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5052, dtype=torch.float64) delta_t tensor(0.2578, dtype=torch.float64)
10 gae_duplicate tensor(-0.3152, dtype=torch.float64) tensor(-4.4340, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0193, dtype=torch.float64) delta_t tensor(-0.1884, dtype=torch.float64)
9 gae_duplicate tensor(-0.6401, dtype=torch.float64) tensor(3.1643, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1153, dtype=torch.float64) delta_t tensor(-0.0922, dtype=torch.float64)
8 gae_duplicate tensor(-2.4436, dtype=torch.float64) tensor(2.1736, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4153, dtype=torch.float64) delta_t tensor(0.2866, dtype=torch.float64)
7 gae_duplicate tensor(-0.5722, dtype=torch.float64) tensor(-5.1515, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3734, dtype=torch.float64) delta_t tensor(0.8445, dtype=torch.float64)
6 gae_duplicate tensor(0.4299, dtype=torch.float64) tensor(-15.9325, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4885, dtype=torch.float64) delta_t tensor(0.2761, dtype=torch.float64)
5 gae_duplicate tensor(0.2456, dtype=torch.float64) tensor(-6.6508, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4058, dtype=torch.float64) delta_t tensor(0.1610, dtype=torch.float64)
4 gae_duplicate tensor(-0.0213, dtype=torch.float64) tensor(-3.6714, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5845, dtype=torch.float64) delta_t tensor(0.4699, dtype=torch.float64)
3 gae_duplicate tensor(0.4049, dtype=torch.float64) tensor(-9.8750, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6602, dtype=torch.float64) delta_t tensor(-0.4083, dtype=torch.float64)
2 gae_duplicate tensor(-0.4794, dtype=torch.float64) tensor(6.2071, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2244.893798828125
value loss:52.767791748046875
entropies:341.1354064941406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.825595140457153 seconds
19 rew tensor(0.9005, dtype=torch.float64) delta_t tensor(-0.2727, dtype=torch.float64)
19 gae_duplicate tensor(-0.3277, dtype=torch.float64) tensor(4.6519, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8814, dtype=torch.float64) delta_t tensor(0.1241, dtype=torch.float64)
18 gae_duplicate tensor(-0.3309, dtype=torch.float64) tensor(-2.1136, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8642, dtype=torch.float64) delta_t tensor(0.0343, dtype=torch.float64)
17 gae_duplicate tensor(-0.2719, dtype=torch.float64) tensor(-0.9200, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5871, dtype=torch.float64) delta_t tensor(0.3299, dtype=torch.float64)
16 gae_duplicate tensor(-0.1679, dtype=torch.float64) tensor(-6.4985, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7190, dtype=torch.float64) delta_t tensor(0.2995, dtype=torch.float64)
15 gae_duplicate tensor(-0.1247, dtype=torch.float64) tensor(-5.7071, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1585, dtype=torch.float64) delta_t tensor(0.0283, dtype=torch.float64)
14 gae_duplicate tensor(-0.9509, dtype=torch.float64) tensor(-1.4944, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7368, dtype=torch.float64) delta_t tensor(0.5297, dtype=torch.float64)
13 gae_duplicate tensor(0.4041, dtype=torch.float64) tensor(-11.0457, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0521, dtype=torch.float64) delta_t tensor(0.2223, dtype=torch.float64)
12 gae_duplicate tensor(-0.4122, dtype=torch.float64) tensor(-5.4077, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7457, dtype=torch.float64) delta_t tensor(-0.7466, dtype=torch.float64)
11 gae_duplicate tensor(-1.7780, dtype=torch.float64) tensor(11.1686, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4576, dtype=torch.float64) delta_t tensor(0.2796, dtype=torch.float64)
10 gae_duplicate tensor(-0.8663, dtype=torch.float64) tensor(-3.0969, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7330, dtype=torch.float64) delta_t tensor(-0.5642, dtype=torch.float64)
9 gae_duplicate tensor(-2.5440, dtype=torch.float64) tensor(8.0319, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6393, dtype=torch.float64) delta_t tensor(0.4441, dtype=torch.float64)
8 gae_duplicate tensor(-1.4905, dtype=torch.float64) tensor(-9.1140, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5027, dtype=torch.float64) delta_t tensor(0.5666, dtype=torch.float64)
7 gae_duplicate tensor(0.4761, dtype=torch.float64) tensor(-11.5907, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1917, dtype=torch.float64) delta_t tensor(0.9757, dtype=torch.float64)
6 gae_duplicate tensor(0.9565, dtype=torch.float64) tensor(-19.4138, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3037, dtype=torch.float64) delta_t tensor(0.3826, dtype=torch.float64)
5 gae_duplicate tensor(0.2701, dtype=torch.float64) tensor(-8.2933, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2069, dtype=torch.float64) delta_t tensor(0.3821, dtype=torch.float64)
4 gae_duplicate tensor(0.0161, dtype=torch.float64) tensor(-8.2899, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4688, dtype=torch.float64) delta_t tensor(0.4799, dtype=torch.float64)
3 gae_duplicate tensor(0.3629, dtype=torch.float64) tensor(-9.8542, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5789, dtype=torch.float64) delta_t tensor(-0.3376, dtype=torch.float64)
2 gae_duplicate tensor(-0.4266, dtype=torch.float64) tensor(5.4490, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3879.263427734375
value loss:83.65074920654297
entropies:340.03619384765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.902498006820679 seconds
19 rew tensor(0.8518, dtype=torch.float64) delta_t tensor(-0.3194, dtype=torch.float64)
19 gae_duplicate tensor(-0.5258, dtype=torch.float64) tensor(5.9595, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(-0.3021, dtype=torch.float64)
18 gae_duplicate tensor(-0.4736, dtype=torch.float64) tensor(6.0060, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7854, dtype=torch.float64) delta_t tensor(-0.0205, dtype=torch.float64)
17 gae_duplicate tensor(-0.3542, dtype=torch.float64) tensor(1.1067, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7407, dtype=torch.float64) delta_t tensor(0.3520, dtype=torch.float64)
16 gae_duplicate tensor(0.0428, dtype=torch.float64) tensor(-6.2987, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4268, dtype=torch.float64) delta_t tensor(-0.1111, dtype=torch.float64)
15 gae_duplicate tensor(-0.8729, dtype=torch.float64) tensor(2.1713, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6311, dtype=torch.float64) delta_t tensor(0.4778, dtype=torch.float64)
14 gae_duplicate tensor(0.2635, dtype=torch.float64) tensor(-10.0130, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6243, dtype=torch.float64) delta_t tensor(0.3915, dtype=torch.float64)
13 gae_duplicate tensor(0.3150, dtype=torch.float64) tensor(-8.0093, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2334, dtype=torch.float64) delta_t tensor(0.1702, dtype=torch.float64)
12 gae_duplicate tensor(-0.8933, dtype=torch.float64) tensor(-4.0899, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2033, dtype=torch.float64) delta_t tensor(-0.2786, dtype=torch.float64)
11 gae_duplicate tensor(-1.6997, dtype=torch.float64) tensor(3.5658, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0555, dtype=torch.float64) delta_t tensor(0.0849, dtype=torch.float64)
10 gae_duplicate tensor(-1.0733, dtype=torch.float64) tensor(-0.9074, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1092, dtype=torch.float64) delta_t tensor(-0.9071, dtype=torch.float64)
9 gae_duplicate tensor(-2.2356, dtype=torch.float64) tensor(14.7422, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3104, dtype=torch.float64) delta_t tensor(-0.5983, dtype=torch.float64)
8 gae_duplicate tensor(-2.4661, dtype=torch.float64) tensor(13.4331, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1135, dtype=torch.float64) delta_t tensor(0.4321, dtype=torch.float64)
7 gae_duplicate tensor(-0.7948, dtype=torch.float64) tensor(-7.7596, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5418, dtype=torch.float64) delta_t tensor(0.1736, dtype=torch.float64)
6 gae_duplicate tensor(-3.2461, dtype=torch.float64) tensor(-4.9863, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0598, dtype=torch.float64) delta_t tensor(0.0522, dtype=torch.float64)
5 gae_duplicate tensor(-2.4947, dtype=torch.float64) tensor(-4.1647, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.0373, dtype=torch.float64) delta_t tensor(-0.5215, dtype=torch.float64)
4 gae_duplicate tensor(-5.3752, dtype=torch.float64) tensor(7.3319, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4213, dtype=torch.float64) delta_t tensor(0.4730, dtype=torch.float64)
3 gae_duplicate tensor(-0.2545, dtype=torch.float64) tensor(-6.9906, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4588, dtype=torch.float64) delta_t tensor(-0.3461, dtype=torch.float64)
2 gae_duplicate tensor(-0.5335, dtype=torch.float64) tensor(5.7674, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-462.36700439453125
value loss:153.8414764404297
entropies:339.5926818847656
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3912.6099)
ToM Target loss= tensor(3533.5925)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.024894952774048 seconds
19 rew tensor(0.8511, dtype=torch.float64) delta_t tensor(-0.3997, dtype=torch.float64)
19 gae_duplicate tensor(-0.5372, dtype=torch.float64) tensor(6.4979, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8055, dtype=torch.float64) delta_t tensor(-0.0844, dtype=torch.float64)
18 gae_duplicate tensor(-0.4725, dtype=torch.float64) tensor(2.1937, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7861, dtype=torch.float64) delta_t tensor(-0.0028, dtype=torch.float64)
17 gae_duplicate tensor(-0.4202, dtype=torch.float64) tensor(0.4061, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6038, dtype=torch.float64) delta_t tensor(0.2346, dtype=torch.float64)
16 gae_duplicate tensor(-0.2740, dtype=torch.float64) tensor(-4.4401, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3045, dtype=torch.float64) delta_t tensor(-0.1998, dtype=torch.float64)
15 gae_duplicate tensor(-0.8884, dtype=torch.float64) tensor(3.0632, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2652, dtype=torch.float64) delta_t tensor(0.0054, dtype=torch.float64)
14 gae_duplicate tensor(-0.9988, dtype=torch.float64) tensor(-0.3171, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4531, dtype=torch.float64) delta_t tensor(0.2327, dtype=torch.float64)
13 gae_duplicate tensor(-0.8878, dtype=torch.float64) tensor(-3.8085, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0243, dtype=torch.float64) delta_t tensor(-0.0291, dtype=torch.float64)
12 gae_duplicate tensor(-0.8207, dtype=torch.float64) tensor(0.0972, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5888, dtype=torch.float64) delta_t tensor(0.5990, dtype=torch.float64)
11 gae_duplicate tensor(0.4105, dtype=torch.float64) tensor(-10.8151, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.0725, dtype=torch.float64) delta_t tensor(-0.8297, dtype=torch.float64)
10 gae_duplicate tensor(-1.8752, dtype=torch.float64) tensor(13.6008, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1523, dtype=torch.float64) delta_t tensor(-0.7647, dtype=torch.float64)
9 gae_duplicate tensor(-3.0909, dtype=torch.float64) tensor(16.4854, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.4744, dtype=torch.float64) delta_t tensor(-0.6285, dtype=torch.float64)
8 gae_duplicate tensor(-3.4677, dtype=torch.float64) tensor(14.2551, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4661, dtype=torch.float64) delta_t tensor(0.9303, dtype=torch.float64)
7 gae_duplicate tensor(0.3122, dtype=torch.float64) tensor(-16.9873, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2603, dtype=torch.float64) delta_t tensor(0.5865, dtype=torch.float64)
6 gae_duplicate tensor(-0.2113, dtype=torch.float64) tensor(-11.5989, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2352, dtype=torch.float64) delta_t tensor(0.3197, dtype=torch.float64)
5 gae_duplicate tensor(0.0582, dtype=torch.float64) tensor(-6.1380, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0913, dtype=torch.float64) delta_t tensor(0.2974, dtype=torch.float64)
4 gae_duplicate tensor(0.0815, dtype=torch.float64) tensor(-7.2409, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2769, dtype=torch.float64) delta_t tensor(0.4569, dtype=torch.float64)
3 gae_duplicate tensor(0.0670, dtype=torch.float64) tensor(-9.5546, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4571, dtype=torch.float64) delta_t tensor(-0.3293, dtype=torch.float64)
2 gae_duplicate tensor(-0.6048, dtype=torch.float64) tensor(4.9397, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:413.79974365234375
value loss:107.55949401855469
entropies:339.7025146484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.840144157409668 seconds
19 rew tensor(0.8545, dtype=torch.float64) delta_t tensor(-0.3304, dtype=torch.float64)
19 gae_duplicate tensor(-0.4912, dtype=torch.float64) tensor(6.8293, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7971, dtype=torch.float64) delta_t tensor(-0.3614, dtype=torch.float64)
18 gae_duplicate tensor(-0.4975, dtype=torch.float64) tensor(6.9485, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7800, dtype=torch.float64) delta_t tensor(-0.0507, dtype=torch.float64)
17 gae_duplicate tensor(-0.4523, dtype=torch.float64) tensor(1.6595, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8175, dtype=torch.float64) delta_t tensor(0.0962, dtype=torch.float64)
16 gae_duplicate tensor(-0.3610, dtype=torch.float64) tensor(-1.0942, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6368, dtype=torch.float64) delta_t tensor(0.1353, dtype=torch.float64)
15 gae_duplicate tensor(-0.2892, dtype=torch.float64) tensor(-3.1702, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3313, dtype=torch.float64) delta_t tensor(-0.1853, dtype=torch.float64)
14 gae_duplicate tensor(-0.7058, dtype=torch.float64) tensor(2.8864, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4805, dtype=torch.float64) delta_t tensor(0.4388, dtype=torch.float64)
13 gae_duplicate tensor(0.1471, dtype=torch.float64) tensor(-7.1953, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6717, dtype=torch.float64) delta_t tensor(0.4917, dtype=torch.float64)
12 gae_duplicate tensor(0.4248, dtype=torch.float64) tensor(-10.8304, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3559, dtype=torch.float64) delta_t tensor(0.3461, dtype=torch.float64)
11 gae_duplicate tensor(-0.1014, dtype=torch.float64) tensor(-6.6633, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3750, dtype=torch.float64) delta_t tensor(0.2282, dtype=torch.float64)
10 gae_duplicate tensor(-0.4202, dtype=torch.float64) tensor(-5.9414, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-4.2460, dtype=torch.float64) delta_t tensor(-3.2473, dtype=torch.float64)
9 gae_duplicate tensor(-4.0392, dtype=torch.float64) tensor(56.5009, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3407, dtype=torch.float64) delta_t tensor(0.4244, dtype=torch.float64)
8 gae_duplicate tensor(-0.7970, dtype=torch.float64) tensor(-2.3858, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9195, dtype=torch.float64) delta_t tensor(0.0263, dtype=torch.float64)
7 gae_duplicate tensor(-1.6810, dtype=torch.float64) tensor(0.1567, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4989, dtype=torch.float64) delta_t tensor(0.8577, dtype=torch.float64)
6 gae_duplicate tensor(0.2820, dtype=torch.float64) tensor(-16.0147, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3916, dtype=torch.float64) delta_t tensor(0.3971, dtype=torch.float64)
5 gae_duplicate tensor(0.2205, dtype=torch.float64) tensor(-10.2712, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5592, dtype=torch.float64) delta_t tensor(0.4951, dtype=torch.float64)
4 gae_duplicate tensor(0.4911, dtype=torch.float64) tensor(-9.5497, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2023, dtype=torch.float64) delta_t tensor(0.4562, dtype=torch.float64)
3 gae_duplicate tensor(0.2423, dtype=torch.float64) tensor(-9.1415, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1133, dtype=torch.float64) delta_t tensor(-0.1361, dtype=torch.float64)
2 gae_duplicate tensor(-0.3745, dtype=torch.float64) tensor(1.7600, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:206.13430786132812
value loss:146.2477569580078
entropies:339.8338623046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.899548292160034 seconds
19 rew tensor(0.8435, dtype=torch.float64) delta_t tensor(-0.4288, dtype=torch.float64)
19 gae_duplicate tensor(-0.5266, dtype=torch.float64) tensor(7.7849, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(-0.2027, dtype=torch.float64)
18 gae_duplicate tensor(-0.4585, dtype=torch.float64) tensor(5.0491, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7785, dtype=torch.float64) delta_t tensor(-0.2455, dtype=torch.float64)
17 gae_duplicate tensor(-0.4774, dtype=torch.float64) tensor(4.7681, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6832, dtype=torch.float64) delta_t tensor(0.2759, dtype=torch.float64)
16 gae_duplicate tensor(-0.0545, dtype=torch.float64) tensor(-6.0768, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6714, dtype=torch.float64) delta_t tensor(-0.1538, dtype=torch.float64)
15 gae_duplicate tensor(-0.5002, dtype=torch.float64) tensor(3.4559, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5485, dtype=torch.float64) delta_t tensor(0.3675, dtype=torch.float64)
14 gae_duplicate tensor(0.2559, dtype=torch.float64) tensor(-6.6830, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6924, dtype=torch.float64) delta_t tensor(0.3669, dtype=torch.float64)
13 gae_duplicate tensor(0.2726, dtype=torch.float64) tensor(-7.3632, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4298, dtype=torch.float64) delta_t tensor(0.3489, dtype=torch.float64)
12 gae_duplicate tensor(0.2837, dtype=torch.float64) tensor(-7.2561, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0145, dtype=torch.float64) delta_t tensor(-0.1914, dtype=torch.float64)
11 gae_duplicate tensor(-0.7970, dtype=torch.float64) tensor(2.7797, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3054, dtype=torch.float64) delta_t tensor(-0.2560, dtype=torch.float64)
10 gae_duplicate tensor(-1.0003, dtype=torch.float64) tensor(4.7178, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0022, dtype=torch.float64) delta_t tensor(-0.7725, dtype=torch.float64)
9 gae_duplicate tensor(-2.9236, dtype=torch.float64) tensor(15.5985, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8565, dtype=torch.float64) delta_t tensor(-0.1748, dtype=torch.float64)
8 gae_duplicate tensor(-2.4133, dtype=torch.float64) tensor(6.0388, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1928, dtype=torch.float64) delta_t tensor(-0.0135, dtype=torch.float64)
7 gae_duplicate tensor(-1.6206, dtype=torch.float64) tensor(2.5044, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5806, dtype=torch.float64) delta_t tensor(0.3576, dtype=torch.float64)
6 gae_duplicate tensor(-1.5507, dtype=torch.float64) tensor(-6.1649, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0522, dtype=torch.float64) delta_t tensor(0.0237, dtype=torch.float64)
5 gae_duplicate tensor(-1.1514, dtype=torch.float64) tensor(-1.4216, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0366, dtype=torch.float64) delta_t tensor(0.2457, dtype=torch.float64)
4 gae_duplicate tensor(0.0427, dtype=torch.float64) tensor(-4.4781, dtype=torch.float64, grad_fn=<SumBackward0>)
3 gae_duplicate tensor(0.2102, dtype=torch.float64) tensor(-8.1020, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4029, dtype=torch.float64) delta_t tensor(-0.3492, dtype=torch.float64)
2 gae_duplicate tensor(-0.5192, dtype=torch.float64) tensor(4.7795, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-628.09130859375
value loss:78.239501953125
entropies:340.0559997558594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7940590381622314 seconds
19 rew tensor(0.8175, dtype=torch.float64) delta_t tensor(-0.2705, dtype=torch.float64)
19 gae_duplicate tensor(-0.4747, dtype=torch.float64) tensor(5.6175, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7986, dtype=torch.float64) delta_t tensor(-0.2064, dtype=torch.float64)
18 gae_duplicate tensor(-0.5243, dtype=torch.float64) tensor(4.3469, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7420, dtype=torch.float64) delta_t tensor(0.0213, dtype=torch.float64)
17 gae_duplicate tensor(-0.3334, dtype=torch.float64) tensor(-0.4612, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7290, dtype=torch.float64) delta_t tensor(0.1075, dtype=torch.float64)
16 gae_duplicate tensor(-0.2347, dtype=torch.float64) tensor(-2.2884, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6280, dtype=torch.float64) delta_t tensor(0.1386, dtype=torch.float64)
15 gae_duplicate tensor(-0.4697, dtype=torch.float64) tensor(-3.0244, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4484, dtype=torch.float64) delta_t tensor(0.0247, dtype=torch.float64)
14 gae_duplicate tensor(-0.6788, dtype=torch.float64) tensor(-0.8839, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4197, dtype=torch.float64) delta_t tensor(0.3730, dtype=torch.float64)
13 gae_duplicate tensor(-0.7714, dtype=torch.float64) tensor(-6.8789, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5760, dtype=torch.float64) delta_t tensor(0.4021, dtype=torch.float64)
12 gae_duplicate tensor(0.1489, dtype=torch.float64) tensor(-8.3588, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1777, dtype=torch.float64) delta_t tensor(0.6551, dtype=torch.float64)
11 gae_duplicate tensor(0.1030, dtype=torch.float64) tensor(-13.7158, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4689, dtype=torch.float64) delta_t tensor(-0.5659, dtype=torch.float64)
10 gae_duplicate tensor(-2.1839, dtype=torch.float64) tensor(9.2928, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.5131, dtype=torch.float64) delta_t tensor(-1.7575, dtype=torch.float64)
9 gae_duplicate tensor(-3.4215, dtype=torch.float64) tensor(33.5540, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.1116, dtype=torch.float64) delta_t tensor(-1.6551, dtype=torch.float64)
8 gae_duplicate tensor(-4.8340, dtype=torch.float64) tensor(32.6632, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3136, dtype=torch.float64) delta_t tensor(0.3654, dtype=torch.float64)
7 gae_duplicate tensor(-0.4021, dtype=torch.float64) tensor(-4.1277, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2398, dtype=torch.float64) delta_t tensor(0.8346, dtype=torch.float64)
6 gae_duplicate tensor(0.4763, dtype=torch.float64) tensor(-16.1400, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1175, dtype=torch.float64) delta_t tensor(0.4020, dtype=torch.float64)
5 gae_duplicate tensor(0.1395, dtype=torch.float64) tensor(-8.9895, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2494, dtype=torch.float64) delta_t tensor(0.3704, dtype=torch.float64)
4 gae_duplicate tensor(-0.0128, dtype=torch.float64) tensor(-6.8832, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0542, dtype=torch.float64) delta_t tensor(0.3651, dtype=torch.float64)
3 gae_duplicate tensor(0.0965, dtype=torch.float64) tensor(-8.8961, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3524, dtype=torch.float64) delta_t tensor(-0.3062, dtype=torch.float64)
2 gae_duplicate tensor(-0.6334, dtype=torch.float64) tensor(4.7638, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-609.6017456054688
value loss:153.55300903320312
entropies:339.6862487792969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.953739881515503 seconds
19 rew tensor(0.7471, dtype=torch.float64) delta_t tensor(-0.3893, dtype=torch.float64)
19 gae_duplicate tensor(-0.5758, dtype=torch.float64) tensor(7.3135, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7292, dtype=torch.float64) delta_t tensor(-0.1462, dtype=torch.float64)
18 gae_duplicate tensor(-0.4753, dtype=torch.float64) tensor(4.0472, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7478, dtype=torch.float64) delta_t tensor(0.0689, dtype=torch.float64)
17 gae_duplicate tensor(-0.4151, dtype=torch.float64) tensor(-0.9408, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7109, dtype=torch.float64) delta_t tensor(0.2107, dtype=torch.float64)
16 gae_duplicate tensor(-0.3369, dtype=torch.float64) tensor(-3.9344, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6592, dtype=torch.float64) delta_t tensor(0.0822, dtype=torch.float64)
15 gae_duplicate tensor(-0.4344, dtype=torch.float64) tensor(-1.4912, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6133, dtype=torch.float64) delta_t tensor(0.3231, dtype=torch.float64)
14 gae_duplicate tensor(-0.1111, dtype=torch.float64) tensor(-6.0061, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6531, dtype=torch.float64) delta_t tensor(0.4352, dtype=torch.float64)
13 gae_duplicate tensor(0.2796, dtype=torch.float64) tensor(-9.4042, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2852, dtype=torch.float64) delta_t tensor(0.1955, dtype=torch.float64)
12 gae_duplicate tensor(-0.7513, dtype=torch.float64) tensor(-4.8491, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2533, dtype=torch.float64) delta_t tensor(-0.0792, dtype=torch.float64)
11 gae_duplicate tensor(-1.9837, dtype=torch.float64) tensor(-0.3580, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1997, dtype=torch.float64) delta_t tensor(0.4311, dtype=torch.float64)
10 gae_duplicate tensor(-0.6205, dtype=torch.float64) tensor(-7.6713, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.0677, dtype=torch.float64) delta_t tensor(-1.6588, dtype=torch.float64)
9 gae_duplicate tensor(-2.7636, dtype=torch.float64) tensor(31.3562, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.9610, dtype=torch.float64) delta_t tensor(-1.4471, dtype=torch.float64)
8 gae_duplicate tensor(-4.6157, dtype=torch.float64) tensor(30.6014, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5073, dtype=torch.float64) delta_t tensor(-0.0679, dtype=torch.float64)
7 gae_duplicate tensor(-0.8405, dtype=torch.float64) tensor(4.4016, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3580, dtype=torch.float64) delta_t tensor(0.2702, dtype=torch.float64)
6 gae_duplicate tensor(-2.8633, dtype=torch.float64) tensor(-2.9997, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4439, dtype=torch.float64) delta_t tensor(-0.2689, dtype=torch.float64)
5 gae_duplicate tensor(-3.4413, dtype=torch.float64) tensor(4.3705, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0036, dtype=torch.float64) delta_t tensor(0.0380, dtype=torch.float64)
4 gae_duplicate tensor(-1.2610, dtype=torch.float64) tensor(0.1820, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2053, dtype=torch.float64) delta_t tensor(0.2556, dtype=torch.float64)
3 gae_duplicate tensor(-0.0721, dtype=torch.float64) tensor(-4.6398, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3183, dtype=torch.float64) delta_t tensor(-0.3245, dtype=torch.float64)
2 gae_duplicate tensor(-0.5508, dtype=torch.float64) tensor(5.3801, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2540.896728515625
value loss:148.93275451660156
entropies:339.187255859375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3883.9910)
ToM Target loss= tensor(3554.9312)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.58392596244812 seconds
19 rew tensor(0.8741, dtype=torch.float64) delta_t tensor(-0.2565, dtype=torch.float64)
19 gae_duplicate tensor(-0.4703, dtype=torch.float64) tensor(5.2903, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.0392, dtype=torch.float64)
18 gae_duplicate tensor(-0.3692, dtype=torch.float64) tensor(0.3482, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7811, dtype=torch.float64) delta_t tensor(-0.0251, dtype=torch.float64)
17 gae_duplicate tensor(-0.3682, dtype=torch.float64) tensor(0.5837, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6524, dtype=torch.float64) delta_t tensor(0.3247, dtype=torch.float64)
16 gae_duplicate tensor(0.0634, dtype=torch.float64) tensor(-5.8568, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5072, dtype=torch.float64) delta_t tensor(0.0988, dtype=torch.float64)
15 gae_duplicate tensor(-0.8946, dtype=torch.float64) tensor(-3.5736, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2932, dtype=torch.float64) delta_t tensor(0.1205, dtype=torch.float64)
14 gae_duplicate tensor(-0.8253, dtype=torch.float64) tensor(-2.1293, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4466, dtype=torch.float64) delta_t tensor(0.3634, dtype=torch.float64)
13 gae_duplicate tensor(-0.8190, dtype=torch.float64) tensor(-8.1287, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0584, dtype=torch.float64) delta_t tensor(-0.0178, dtype=torch.float64)
12 gae_duplicate tensor(-0.8895, dtype=torch.float64) tensor(-0.6803, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2466, dtype=torch.float64) delta_t tensor(-0.1605, dtype=torch.float64)
11 gae_duplicate tensor(-0.7686, dtype=torch.float64) tensor(4.7595, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2070, dtype=torch.float64) delta_t tensor(0.2101, dtype=torch.float64)
10 gae_duplicate tensor(-1.6175, dtype=torch.float64) tensor(-2.0293, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6121, dtype=torch.float64) delta_t tensor(-0.3005, dtype=torch.float64)
9 gae_duplicate tensor(-2.2941, dtype=torch.float64) tensor(5.0482, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.4025, dtype=torch.float64) delta_t tensor(-0.6722, dtype=torch.float64)
8 gae_duplicate tensor(-3.9731, dtype=torch.float64) tensor(12.4694, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2950, dtype=torch.float64) delta_t tensor(0.6116, dtype=torch.float64)
7 gae_duplicate tensor(0.0724, dtype=torch.float64) tensor(-9.2025, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0664, dtype=torch.float64) delta_t tensor(0.7865, dtype=torch.float64)
6 gae_duplicate tensor(0.1175, dtype=torch.float64) tensor(-15.0326, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0289, dtype=torch.float64) delta_t tensor(0.2750, dtype=torch.float64)
5 gae_duplicate tensor(0.1833, dtype=torch.float64) tensor(-6.9771, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0635, dtype=torch.float64) delta_t tensor(0.1533, dtype=torch.float64)
4 gae_duplicate tensor(-0.2792, dtype=torch.float64) tensor(-2.9039, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1675, dtype=torch.float64) delta_t tensor(0.3407, dtype=torch.float64)
3 gae_duplicate tensor(0.0572, dtype=torch.float64) tensor(-5.8851, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3284, dtype=torch.float64) delta_t tensor(-0.2860, dtype=torch.float64)
2 gae_duplicate tensor(-0.4503, dtype=torch.float64) tensor(5.1569, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1460.5245361328125
value loss:96.47716522216797
entropies:339.22430419921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.068387031555176 seconds
19 rew tensor(0.8761, dtype=torch.float64) delta_t tensor(-0.2220, dtype=torch.float64)
19 gae_duplicate tensor(-0.4510, dtype=torch.float64) tensor(3.9501, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8189, dtype=torch.float64) delta_t tensor(-0.1340, dtype=torch.float64)
18 gae_duplicate tensor(-0.4027, dtype=torch.float64) tensor(3.0825, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7582, dtype=torch.float64) delta_t tensor(0.1990, dtype=torch.float64)
17 gae_duplicate tensor(-0.3376, dtype=torch.float64) tensor(-4.1860, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7374, dtype=torch.float64) delta_t tensor(0.2201, dtype=torch.float64)
16 gae_duplicate tensor(-0.1567, dtype=torch.float64) tensor(-4.5178, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3860, dtype=torch.float64) delta_t tensor(0.0947, dtype=torch.float64)
15 gae_duplicate tensor(-0.9290, dtype=torch.float64) tensor(-3.0307, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3922, dtype=torch.float64) delta_t tensor(0.0246, dtype=torch.float64)
14 gae_duplicate tensor(-0.6975, dtype=torch.float64) tensor(-0.7966, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5175, dtype=torch.float64) delta_t tensor(0.3308, dtype=torch.float64)
13 gae_duplicate tensor(0.1773, dtype=torch.float64) tensor(-5.8086, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3949, dtype=torch.float64) delta_t tensor(0.2516, dtype=torch.float64)
12 gae_duplicate tensor(-0.7232, dtype=torch.float64) tensor(-5.9915, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0387, dtype=torch.float64) delta_t tensor(0.0357, dtype=torch.float64)
11 gae_duplicate tensor(-0.6815, dtype=torch.float64) tensor(-0.6603, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2077, dtype=torch.float64) delta_t tensor(0.4313, dtype=torch.float64)
10 gae_duplicate tensor(-0.9630, dtype=torch.float64) tensor(-9.5288, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8058, dtype=torch.float64) delta_t tensor(-0.1918, dtype=torch.float64)
9 gae_duplicate tensor(-2.1820, dtype=torch.float64) tensor(1.9386, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8745, dtype=torch.float64) delta_t tensor(-0.5212, dtype=torch.float64)
8 gae_duplicate tensor(-2.5027, dtype=torch.float64) tensor(11.9630, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8865, dtype=torch.float64) delta_t tensor(-0.1757, dtype=torch.float64)
7 gae_duplicate tensor(-1.7308, dtype=torch.float64) tensor(3.5129, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4684, dtype=torch.float64) delta_t tensor(-0.0804, dtype=torch.float64)
6 gae_duplicate tensor(-3.0620, dtype=torch.float64) tensor(1.6999, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4567, dtype=torch.float64) delta_t tensor(0.1026, dtype=torch.float64)
5 gae_duplicate tensor(-1.1315, dtype=torch.float64) tensor(-1.5900, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3839, dtype=torch.float64) delta_t tensor(0.3358, dtype=torch.float64)
4 gae_duplicate tensor(0.0645, dtype=torch.float64) tensor(-6.1062, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1230, dtype=torch.float64) delta_t tensor(0.1158, dtype=torch.float64)
3 gae_duplicate tensor(-0.2289, dtype=torch.float64) tensor(-2.7160, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2365, dtype=torch.float64) delta_t tensor(-0.1621, dtype=torch.float64)
2 gae_duplicate tensor(-0.4702, dtype=torch.float64) tensor(2.6871, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:777.8711547851562
value loss:90.3948974609375
entropies:338.6670837402344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.741132736206055 seconds
19 rew tensor(0.8759, dtype=torch.float64) delta_t tensor(-0.0945, dtype=torch.float64)
19 gae_duplicate tensor(-0.3321, dtype=torch.float64) tensor(2.0689, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7908, dtype=torch.float64) delta_t tensor(-0.0470, dtype=torch.float64)
18 gae_duplicate tensor(-0.3212, dtype=torch.float64) tensor(0.8075, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7803, dtype=torch.float64) delta_t tensor(0.2942, dtype=torch.float64)
17 gae_duplicate tensor(-0.2046, dtype=torch.float64) tensor(-5.2248, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6251, dtype=torch.float64) delta_t tensor(0.2977, dtype=torch.float64)
16 gae_duplicate tensor(0.0171, dtype=torch.float64) tensor(-6.3978, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5952, dtype=torch.float64) delta_t tensor(0.2030, dtype=torch.float64)
15 gae_duplicate tensor(-0.3036, dtype=torch.float64) tensor(-4.8299, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1538, dtype=torch.float64) delta_t tensor(0.0145, dtype=torch.float64)
14 gae_duplicate tensor(-0.7585, dtype=torch.float64) tensor(-0.4484, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5743, dtype=torch.float64) delta_t tensor(0.3303, dtype=torch.float64)
13 gae_duplicate tensor(0.1325, dtype=torch.float64) tensor(-5.9863, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1818, dtype=torch.float64) delta_t tensor(-0.2086, dtype=torch.float64)
12 gae_duplicate tensor(-1.0583, dtype=torch.float64) tensor(1.8873, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1733, dtype=torch.float64) delta_t tensor(0.0400, dtype=torch.float64)
11 gae_duplicate tensor(-0.8470, dtype=torch.float64) tensor(-1.1301, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2986, dtype=torch.float64) delta_t tensor(0.1843, dtype=torch.float64)
10 gae_duplicate tensor(-0.5559, dtype=torch.float64) tensor(-2.3257, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9205, dtype=torch.float64) delta_t tensor(-0.6437, dtype=torch.float64)
9 gae_duplicate tensor(-3.3061, dtype=torch.float64) tensor(13.1983, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.3282, dtype=torch.float64) delta_t tensor(-1.4630, dtype=torch.float64)
8 gae_duplicate tensor(-3.4847, dtype=torch.float64) tensor(27.6305, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5720, dtype=torch.float64) delta_t tensor(0.7424, dtype=torch.float64)
7 gae_duplicate tensor(0.2760, dtype=torch.float64) tensor(-11.0494, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0885, dtype=torch.float64) delta_t tensor(0.9367, dtype=torch.float64)
6 gae_duplicate tensor(0.8470, dtype=torch.float64) tensor(-17.2446, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3062, dtype=torch.float64) delta_t tensor(0.4137, dtype=torch.float64)
5 gae_duplicate tensor(-0.0466, dtype=torch.float64) tensor(-9.3794, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0541, dtype=torch.float64) delta_t tensor(0.2504, dtype=torch.float64)
4 gae_duplicate tensor(0.0770, dtype=torch.float64) tensor(-6.4593, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3362, dtype=torch.float64) delta_t tensor(0.2307, dtype=torch.float64)
3 gae_duplicate tensor(0.1317, dtype=torch.float64) tensor(-5.0047, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4514, dtype=torch.float64) delta_t tensor(-0.3297, dtype=torch.float64)
2 gae_duplicate tensor(-0.6203, dtype=torch.float64) tensor(5.4024, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1230.8709716796875
value loss:112.1840591430664
entropies:338.3358154296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.731132984161377 seconds
19 rew tensor(0.8557, dtype=torch.float64) delta_t tensor(-0.3725, dtype=torch.float64)
19 gae_duplicate tensor(-0.4380, dtype=torch.float64) tensor(6.3239, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8478, dtype=torch.float64) delta_t tensor(0.1078, dtype=torch.float64)
18 gae_duplicate tensor(-0.2984, dtype=torch.float64) tensor(-1.6864, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7992, dtype=torch.float64) delta_t tensor(-0.1534, dtype=torch.float64)
17 gae_duplicate tensor(-0.3452, dtype=torch.float64) tensor(2.6239, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6915, dtype=torch.float64) delta_t tensor(0.1340, dtype=torch.float64)
16 gae_duplicate tensor(-0.2646, dtype=torch.float64) tensor(-2.9180, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7104, dtype=torch.float64) delta_t tensor(0.1072, dtype=torch.float64)
15 gae_duplicate tensor(-0.3663, dtype=torch.float64) tensor(-2.0686, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3113, dtype=torch.float64) delta_t tensor(-0.0064, dtype=torch.float64)
14 gae_duplicate tensor(-0.8597, dtype=torch.float64) tensor(0.3809, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4860, dtype=torch.float64) delta_t tensor(0.2550, dtype=torch.float64)
13 gae_duplicate tensor(-0.7583, dtype=torch.float64) tensor(-4.9073, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3937, dtype=torch.float64) delta_t tensor(0.2958, dtype=torch.float64)
12 gae_duplicate tensor(0.1524, dtype=torch.float64) tensor(-5.7241, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4501, dtype=torch.float64) delta_t tensor(-0.3990, dtype=torch.float64)
11 gae_duplicate tensor(-1.7974, dtype=torch.float64) tensor(9.1999, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2499, dtype=torch.float64) delta_t tensor(-0.0963, dtype=torch.float64)
10 gae_duplicate tensor(-1.6379, dtype=torch.float64) tensor(1.0147, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8718, dtype=torch.float64) delta_t tensor(-0.5664, dtype=torch.float64)
9 gae_duplicate tensor(-1.3756, dtype=torch.float64) tensor(10.0010, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5945, dtype=torch.float64) delta_t tensor(0.0617, dtype=torch.float64)
8 gae_duplicate tensor(-4.1300, dtype=torch.float64) tensor(-1.7758, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0870, dtype=torch.float64) delta_t tensor(0.3537, dtype=torch.float64)
7 gae_duplicate tensor(-0.1441, dtype=torch.float64) tensor(-6.1038, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5410, dtype=torch.float64) delta_t tensor(0.3768, dtype=torch.float64)
6 gae_duplicate tensor(-2.4014, dtype=torch.float64) tensor(-8.2845, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1892, dtype=torch.float64) delta_t tensor(0.2698, dtype=torch.float64)
5 gae_duplicate tensor(0.1345, dtype=torch.float64) tensor(-5.0990, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0494, dtype=torch.float64) delta_t tensor(-0.0302, dtype=torch.float64)
4 gae_duplicate tensor(-0.4367, dtype=torch.float64) tensor(-0.5311, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3394, dtype=torch.float64) delta_t tensor(0.3951, dtype=torch.float64)
3 gae_duplicate tensor(0.2747, dtype=torch.float64) tensor(-6.9521, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4653, dtype=torch.float64) delta_t tensor(-0.3928, dtype=torch.float64)
2 gae_duplicate tensor(-0.5200, dtype=torch.float64) tensor(6.8867, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:428.1363525390625
value loss:87.73990631103516
entropies:338.2489929199219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.018768787384033 seconds
19 rew tensor(0.8791, dtype=torch.float64) delta_t tensor(-0.3117, dtype=torch.float64)
19 gae_duplicate tensor(-0.4761, dtype=torch.float64) tensor(6.0984, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8119, dtype=torch.float64) delta_t tensor(0.0605, dtype=torch.float64)
18 gae_duplicate tensor(-0.3366, dtype=torch.float64) tensor(-0.4097, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8302, dtype=torch.float64) delta_t tensor(0.1239, dtype=torch.float64)
17 gae_duplicate tensor(-0.1642, dtype=torch.float64) tensor(-2.3107, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6920, dtype=torch.float64) delta_t tensor(0.0465, dtype=torch.float64)
16 gae_duplicate tensor(-0.1434, dtype=torch.float64) tensor(-1.0939, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6553, dtype=torch.float64) delta_t tensor(0.1109, dtype=torch.float64)
15 gae_duplicate tensor(-0.4221, dtype=torch.float64) tensor(-2.5972, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3439, dtype=torch.float64) delta_t tensor(0.0884, dtype=torch.float64)
14 gae_duplicate tensor(-0.7787, dtype=torch.float64) tensor(-2.7938, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6915, dtype=torch.float64) delta_t tensor(0.3877, dtype=torch.float64)
13 gae_duplicate tensor(0.0862, dtype=torch.float64) tensor(-8.2102, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3366, dtype=torch.float64) delta_t tensor(0.2936, dtype=torch.float64)
12 gae_duplicate tensor(0.2493, dtype=torch.float64) tensor(-6.2689, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.3499, dtype=torch.float64) delta_t tensor(-1.3094, dtype=torch.float64)
11 gae_duplicate tensor(-1.9848, dtype=torch.float64) tensor(23.0038, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5001, dtype=torch.float64) delta_t tensor(0.0314, dtype=torch.float64)
10 gae_duplicate tensor(-2.9777, dtype=torch.float64) tensor(-0.1363, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3242, dtype=torch.float64) delta_t tensor(-0.0337, dtype=torch.float64)
9 gae_duplicate tensor(-1.5770, dtype=torch.float64) tensor(1.1574, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7954, dtype=torch.float64) delta_t tensor(-0.0574, dtype=torch.float64)
8 gae_duplicate tensor(-1.4415, dtype=torch.float64) tensor(-1.7976, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1895, dtype=torch.float64) delta_t tensor(-0.0613, dtype=torch.float64)
7 gae_duplicate tensor(-1.6609, dtype=torch.float64) tensor(4.1347, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6702, dtype=torch.float64) delta_t tensor(0.0786, dtype=torch.float64)
6 gae_duplicate tensor(-2.0927, dtype=torch.float64) tensor(-2.2114, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0184, dtype=torch.float64) delta_t tensor(0.1306, dtype=torch.float64)
5 gae_duplicate tensor(-0.3900, dtype=torch.float64) tensor(-2.5849, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1628, dtype=torch.float64) delta_t tensor(0.1523, dtype=torch.float64)
4 gae_duplicate tensor(0.0316, dtype=torch.float64) tensor(-3.7914, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1225, dtype=torch.float64) delta_t tensor(0.0093, dtype=torch.float64)
3 gae_duplicate tensor(-0.5913, dtype=torch.float64) tensor(-0.4782, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1831, dtype=torch.float64) delta_t tensor(-0.2082, dtype=torch.float64)
2 gae_duplicate tensor(-0.6331, dtype=torch.float64) tensor(3.7419, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-277.7969665527344
value loss:83.5826416015625
entropies:338.5252685546875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3885.1272)
ToM Target loss= tensor(3568.4592)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.866750955581665 seconds
19 rew tensor(0.8408, dtype=torch.float64) delta_t tensor(-0.3218, dtype=torch.float64)
19 gae_duplicate tensor(-0.4442, dtype=torch.float64) tensor(5.9961, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8427, dtype=torch.float64) delta_t tensor(-0.1280, dtype=torch.float64)
18 gae_duplicate tensor(-0.4160, dtype=torch.float64) tensor(2.8497, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7738, dtype=torch.float64) delta_t tensor(-0.0579, dtype=torch.float64)
17 gae_duplicate tensor(-0.3581, dtype=torch.float64) tensor(1.1966, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6832, dtype=torch.float64) delta_t tensor(0.1667, dtype=torch.float64)
16 gae_duplicate tensor(-0.1535, dtype=torch.float64) tensor(-3.0853, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6694, dtype=torch.float64) delta_t tensor(0.1012, dtype=torch.float64)
15 gae_duplicate tensor(-0.4213, dtype=torch.float64) tensor(-3.0460, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4506, dtype=torch.float64) delta_t tensor(0.0710, dtype=torch.float64)
14 gae_duplicate tensor(-0.7393, dtype=torch.float64) tensor(-1.8437, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4486, dtype=torch.float64) delta_t tensor(0.2075, dtype=torch.float64)
13 gae_duplicate tensor(-0.8413, dtype=torch.float64) tensor(-3.8945, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3557, dtype=torch.float64) delta_t tensor(0.1443, dtype=torch.float64)
12 gae_duplicate tensor(-1.1205, dtype=torch.float64) tensor(-3.6886, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5240, dtype=torch.float64) delta_t tensor(-0.4078, dtype=torch.float64)
11 gae_duplicate tensor(-1.9998, dtype=torch.float64) tensor(6.4993, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1664, dtype=torch.float64) delta_t tensor(-0.1540, dtype=torch.float64)
10 gae_duplicate tensor(-1.0268, dtype=torch.float64) tensor(3.1769, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4539, dtype=torch.float64) delta_t tensor(0.2381, dtype=torch.float64)
9 gae_duplicate tensor(-1.2402, dtype=torch.float64) tensor(-4.7406, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0733, dtype=torch.float64) delta_t tensor(-0.6465, dtype=torch.float64)
8 gae_duplicate tensor(-2.5618, dtype=torch.float64) tensor(8.2511, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6988, dtype=torch.float64) delta_t tensor(-1.0630, dtype=torch.float64)
7 gae_duplicate tensor(-2.8518, dtype=torch.float64) tensor(18.3265, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2226, dtype=torch.float64) delta_t tensor(0.2061, dtype=torch.float64)
6 gae_duplicate tensor(-1.6867, dtype=torch.float64) tensor(-0.9254, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3899, dtype=torch.float64) delta_t tensor(0.1140, dtype=torch.float64)
5 gae_duplicate tensor(-1.1001, dtype=torch.float64) tensor(-2.5699, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3772, dtype=torch.float64) delta_t tensor(0.1207, dtype=torch.float64)
4 gae_duplicate tensor(-0.5093, dtype=torch.float64) tensor(-2.9289, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0594, dtype=torch.float64) delta_t tensor(0.0921, dtype=torch.float64)
3 gae_duplicate tensor(-0.0987, dtype=torch.float64) tensor(-2.0320, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1456, dtype=torch.float64) delta_t tensor(-0.2366, dtype=torch.float64)
2 gae_duplicate tensor(-0.5899, dtype=torch.float64) tensor(4.7164, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1293.479736328125
value loss:100.38249206542969
entropies:339.13067626953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.050095081329346 seconds
19 rew tensor(0.8597, dtype=torch.float64) delta_t tensor(-0.3259, dtype=torch.float64)
19 gae_duplicate tensor(-0.4277, dtype=torch.float64) tensor(5.7241, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8284, dtype=torch.float64) delta_t tensor(0.0052, dtype=torch.float64)
18 gae_duplicate tensor(-0.3147, dtype=torch.float64) tensor(0.1226, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8011, dtype=torch.float64) delta_t tensor(0.0815, dtype=torch.float64)
17 gae_duplicate tensor(-0.2471, dtype=torch.float64) tensor(-1.3043, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5917, dtype=torch.float64) delta_t tensor(0.0176, dtype=torch.float64)
16 gae_duplicate tensor(-0.3665, dtype=torch.float64) tensor(-1.0338, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7078, dtype=torch.float64) delta_t tensor(0.2262, dtype=torch.float64)
15 gae_duplicate tensor(-0.0197, dtype=torch.float64) tensor(-4.1619, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3581, dtype=torch.float64) delta_t tensor(0.0225, dtype=torch.float64)
14 gae_duplicate tensor(-0.7371, dtype=torch.float64) tensor(-0.7551, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4100, dtype=torch.float64) delta_t tensor(0.1404, dtype=torch.float64)
13 gae_duplicate tensor(-0.7834, dtype=torch.float64) tensor(-2.4400, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5437, dtype=torch.float64) delta_t tensor(0.3587, dtype=torch.float64)
12 gae_duplicate tensor(0.1194, dtype=torch.float64) tensor(-8.1004, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1483, dtype=torch.float64) delta_t tensor(-0.0605, dtype=torch.float64)
11 gae_duplicate tensor(-1.9349, dtype=torch.float64) tensor(1.1749, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6319, dtype=torch.float64) delta_t tensor(-0.4893, dtype=torch.float64)
10 gae_duplicate tensor(-1.9936, dtype=torch.float64) tensor(10.1267, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1112, dtype=torch.float64) delta_t tensor(0.4692, dtype=torch.float64)
9 gae_duplicate tensor(-1.3945, dtype=torch.float64) tensor(-6.3192, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2377, dtype=torch.float64) delta_t tensor(0.5179, dtype=torch.float64)
8 gae_duplicate tensor(0.3776, dtype=torch.float64) tensor(-10.5145, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6696, dtype=torch.float64) delta_t tensor(-0.2011, dtype=torch.float64)
7 gae_duplicate tensor(-1.6538, dtype=torch.float64) tensor(1.5007, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2956, dtype=torch.float64) delta_t tensor(0.2408, dtype=torch.float64)
6 gae_duplicate tensor(-1.5234, dtype=torch.float64) tensor(-5.7850, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1160, dtype=torch.float64) delta_t tensor(0.2057, dtype=torch.float64)
5 gae_duplicate tensor(0.0778, dtype=torch.float64) tensor(-4.2909, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1046, dtype=torch.float64) delta_t tensor(0.0812, dtype=torch.float64)
4 gae_duplicate tensor(-0.2867, dtype=torch.float64) tensor(-1.2598, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0850, dtype=torch.float64) delta_t tensor(0.2000, dtype=torch.float64)
3 gae_duplicate tensor(0.0690, dtype=torch.float64) tensor(-3.8207, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3100, dtype=torch.float64) delta_t tensor(-0.3104, dtype=torch.float64)
2 gae_duplicate tensor(-0.6262, dtype=torch.float64) tensor(5.3314, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1301.5726318359375
value loss:54.017120361328125
entropies:340.39703369140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.761988162994385 seconds
19 rew tensor(0.8289, dtype=torch.float64) delta_t tensor(-0.2604, dtype=torch.float64)
19 gae_duplicate tensor(-0.3562, dtype=torch.float64) tensor(5.2369, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5328, dtype=torch.float64) delta_t tensor(-0.3182, dtype=torch.float64)
18 gae_duplicate tensor(-1.2353, dtype=torch.float64) tensor(6.4347, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7594, dtype=torch.float64) delta_t tensor(0.0433, dtype=torch.float64)
17 gae_duplicate tensor(-0.2994, dtype=torch.float64) tensor(-0.5075, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7031, dtype=torch.float64) delta_t tensor(0.1475, dtype=torch.float64)
16 gae_duplicate tensor(-0.2638, dtype=torch.float64) tensor(-2.8078, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6372, dtype=torch.float64) delta_t tensor(0.0065, dtype=torch.float64)
15 gae_duplicate tensor(-0.2498, dtype=torch.float64) tensor(-0.1654, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2021, dtype=torch.float64) delta_t tensor(-0.1260, dtype=torch.float64)
14 gae_duplicate tensor(-0.7999, dtype=torch.float64) tensor(2.6531, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6336, dtype=torch.float64) delta_t tensor(0.4011, dtype=torch.float64)
13 gae_duplicate tensor(0.1392, dtype=torch.float64) tensor(-7.3985, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5889, dtype=torch.float64) delta_t tensor(0.4152, dtype=torch.float64)
12 gae_duplicate tensor(0.1858, dtype=torch.float64) tensor(-8.9226, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0254, dtype=torch.float64) delta_t tensor(-0.1228, dtype=torch.float64)
11 gae_duplicate tensor(-1.0837, dtype=torch.float64) tensor(2.1461, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1285, dtype=torch.float64) delta_t tensor(-0.0270, dtype=torch.float64)
10 gae_duplicate tensor(-1.9931, dtype=torch.float64) tensor(-0.5067, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.2332, dtype=torch.float64) delta_t tensor(-1.7636, dtype=torch.float64)
9 gae_duplicate tensor(-2.4689, dtype=torch.float64) tensor(31.0312, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.6617, dtype=torch.float64) delta_t tensor(-2.0491, dtype=torch.float64)
8 gae_duplicate tensor(-5.8494, dtype=torch.float64) tensor(39.9739, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3597, dtype=torch.float64) delta_t tensor(0.0102, dtype=torch.float64)
7 gae_duplicate tensor(-2.6094, dtype=torch.float64) tensor(4.7463, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2950, dtype=torch.float64) delta_t tensor(0.5221, dtype=torch.float64)
6 gae_duplicate tensor(0.1615, dtype=torch.float64) tensor(-9.2903, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1566, dtype=torch.float64) delta_t tensor(0.3341, dtype=torch.float64)
5 gae_duplicate tensor(0.0631, dtype=torch.float64) tensor(-6.4104, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2634, dtype=torch.float64) delta_t tensor(0.0547, dtype=torch.float64)
4 gae_duplicate tensor(-0.6176, dtype=torch.float64) tensor(-1.1365, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1911, dtype=torch.float64) delta_t tensor(0.0331, dtype=torch.float64)
3 gae_duplicate tensor(-0.1733, dtype=torch.float64) tensor(-0.3541, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3405, dtype=torch.float64) delta_t tensor(-0.3608, dtype=torch.float64)
2 gae_duplicate tensor(-0.6325, dtype=torch.float64) tensor(6.8491, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3416.941162109375
value loss:159.38232421875
entropies:341.08795166015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.570307016372681 seconds
19 rew tensor(0.8487, dtype=torch.float64) delta_t tensor(-0.2932, dtype=torch.float64)
19 gae_duplicate tensor(-0.4401, dtype=torch.float64) tensor(5.1216, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5933, dtype=torch.float64) delta_t tensor(-0.2141, dtype=torch.float64)
18 gae_duplicate tensor(-1.1105, dtype=torch.float64) tensor(5.5055, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7648, dtype=torch.float64) delta_t tensor(0.0096, dtype=torch.float64)
17 gae_duplicate tensor(-0.3164, dtype=torch.float64) tensor(0.3210, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6473, dtype=torch.float64) delta_t tensor(0.1045, dtype=torch.float64)
16 gae_duplicate tensor(-0.0753, dtype=torch.float64) tensor(-2.2906, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2638, dtype=torch.float64) delta_t tensor(-0.3232, dtype=torch.float64)
15 gae_duplicate tensor(-1.2392, dtype=torch.float64) tensor(5.6950, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4173, dtype=torch.float64) delta_t tensor(0.1940, dtype=torch.float64)
14 gae_duplicate tensor(-0.7627, dtype=torch.float64) tensor(-3.4965, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5215, dtype=torch.float64) delta_t tensor(0.1685, dtype=torch.float64)
13 gae_duplicate tensor(-0.0241, dtype=torch.float64) tensor(-3.2776, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0343, dtype=torch.float64) delta_t tensor(0.0519, dtype=torch.float64)
12 gae_duplicate tensor(-1.0524, dtype=torch.float64) tensor(-2.3585, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3808, dtype=torch.float64) delta_t tensor(-0.7141, dtype=torch.float64)
11 gae_duplicate tensor(-1.8037, dtype=torch.float64) tensor(15.3604, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3078, dtype=torch.float64) delta_t tensor(0.0226, dtype=torch.float64)
10 gae_duplicate tensor(-0.9417, dtype=torch.float64) tensor(1.4138, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1751, dtype=torch.float64) delta_t tensor(-0.8016, dtype=torch.float64)
9 gae_duplicate tensor(-2.2296, dtype=torch.float64) tensor(15.7166, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.9358, dtype=torch.float64) delta_t tensor(-1.3635, dtype=torch.float64)
8 gae_duplicate tensor(-4.2481, dtype=torch.float64) tensor(32.7483, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0836, dtype=torch.float64) delta_t tensor(0.3981, dtype=torch.float64)
7 gae_duplicate tensor(-0.4764, dtype=torch.float64) tensor(-5.3246, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1715, dtype=torch.float64) delta_t tensor(0.7390, dtype=torch.float64)
6 gae_duplicate tensor(0.3757, dtype=torch.float64) tensor(-15.5807, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1657, dtype=torch.float64) delta_t tensor(0.2733, dtype=torch.float64)
5 gae_duplicate tensor(0.1760, dtype=torch.float64) tensor(-6.2571, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1955, dtype=torch.float64) delta_t tensor(0.0033, dtype=torch.float64)
4 gae_duplicate tensor(-0.2925, dtype=torch.float64) tensor(-0.7106, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1553, dtype=torch.float64) delta_t tensor(0.1165, dtype=torch.float64)
3 gae_duplicate tensor(-0.0555, dtype=torch.float64) tensor(-1.8257, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3191, dtype=torch.float64) delta_t tensor(-0.3471, dtype=torch.float64)
2 gae_duplicate tensor(-0.5095, dtype=torch.float64) tensor(6.2414, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2630.579345703125
value loss:110.62142181396484
entropies:342.5516662597656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.004534959793091 seconds
19 rew tensor(0.8888, dtype=torch.float64) delta_t tensor(-0.1924, dtype=torch.float64)
19 gae_duplicate tensor(-0.3108, dtype=torch.float64) tensor(3.4653, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.4742, dtype=torch.float64) delta_t tensor(-0.3188, dtype=torch.float64)
18 gae_duplicate tensor(-1.2358, dtype=torch.float64) tensor(6.2463, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7823, dtype=torch.float64) delta_t tensor(0.0229, dtype=torch.float64)
17 gae_duplicate tensor(-0.2712, dtype=torch.float64) tensor(0.0328, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6579, dtype=torch.float64) delta_t tensor(0.0217, dtype=torch.float64)
16 gae_duplicate tensor(-0.0950, dtype=torch.float64) tensor(-0.3466, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4096, dtype=torch.float64) delta_t tensor(-0.3330, dtype=torch.float64)
15 gae_duplicate tensor(-1.3476, dtype=torch.float64) tensor(5.6026, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3607, dtype=torch.float64) delta_t tensor(0.0739, dtype=torch.float64)
14 gae_duplicate tensor(-0.8229, dtype=torch.float64) tensor(-1.3489, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6172, dtype=torch.float64) delta_t tensor(0.1894, dtype=torch.float64)
13 gae_duplicate tensor(-0.0549, dtype=torch.float64) tensor(-3.7122, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5023, dtype=torch.float64) delta_t tensor(0.3468, dtype=torch.float64)
12 gae_duplicate tensor(0.1861, dtype=torch.float64) tensor(-6.4594, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1634, dtype=torch.float64) delta_t tensor(-0.4510, dtype=torch.float64)
11 gae_duplicate tensor(-1.7442, dtype=torch.float64) tensor(9.3839, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2367, dtype=torch.float64) delta_t tensor(0.4474, dtype=torch.float64)
10 gae_duplicate tensor(-0.5155, dtype=torch.float64) tensor(-7.5162, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.1243, dtype=torch.float64) delta_t tensor(-1.9723, dtype=torch.float64)
9 gae_duplicate tensor(-5.0271, dtype=torch.float64) tensor(38.7113, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.6798, dtype=torch.float64) delta_t tensor(-2.0072, dtype=torch.float64)
8 gae_duplicate tensor(-4.3807, dtype=torch.float64) tensor(41.0998, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2184, dtype=torch.float64) delta_t tensor(-0.0219, dtype=torch.float64)
7 gae_duplicate tensor(-0.7854, dtype=torch.float64) tensor(4.6188, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1564, dtype=torch.float64) delta_t tensor(0.3205, dtype=torch.float64)
6 gae_duplicate tensor(-2.0559, dtype=torch.float64) tensor(-5.0809, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3084, dtype=torch.float64) delta_t tensor(0.3226, dtype=torch.float64)
5 gae_duplicate tensor(0.0341, dtype=torch.float64) tensor(-5.9876, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1776, dtype=torch.float64) delta_t tensor(-0.0051, dtype=torch.float64)
4 gae_duplicate tensor(-0.3657, dtype=torch.float64) tensor(-0.7844, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2676, dtype=torch.float64) delta_t tensor(0.0642, dtype=torch.float64)
3 gae_duplicate tensor(-0.1533, dtype=torch.float64) tensor(-1.1578, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3864, dtype=torch.float64) delta_t tensor(-0.4087, dtype=torch.float64)
2 gae_duplicate tensor(-0.5381, dtype=torch.float64) tensor(8.2169, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4681.79150390625
value loss:163.40106201171875
entropies:343.2212829589844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3889.4714)
ToM Target loss= tensor(3587.8311)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.0563578605651855 seconds
19 rew tensor(0.8202, dtype=torch.float64) delta_t tensor(-0.2542, dtype=torch.float64)
19 gae_duplicate tensor(-0.3898, dtype=torch.float64) tensor(4.8355, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8297, dtype=torch.float64) delta_t tensor(-0.0739, dtype=torch.float64)
18 gae_duplicate tensor(-0.2784, dtype=torch.float64) tensor(1.3605, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7447, dtype=torch.float64) delta_t tensor(-0.1279, dtype=torch.float64)
17 gae_duplicate tensor(-0.2812, dtype=torch.float64) tensor(2.8518, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6910, dtype=torch.float64) delta_t tensor(0.1580, dtype=torch.float64)
16 gae_duplicate tensor(-0.1204, dtype=torch.float64) tensor(-2.8112, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6848, dtype=torch.float64) delta_t tensor(-0.0072, dtype=torch.float64)
15 gae_duplicate tensor(-0.3731, dtype=torch.float64) tensor(-0.3335, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5362, dtype=torch.float64) delta_t tensor(0.0914, dtype=torch.float64)
14 gae_duplicate tensor(-0.3176, dtype=torch.float64) tensor(-1.7957, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5968, dtype=torch.float64) delta_t tensor(0.3247, dtype=torch.float64)
13 gae_duplicate tensor(0.2878, dtype=torch.float64) tensor(-6.0156, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4169, dtype=torch.float64) delta_t tensor(0.3303, dtype=torch.float64)
12 gae_duplicate tensor(0.2167, dtype=torch.float64) tensor(-7.5030, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2281, dtype=torch.float64) delta_t tensor(-0.3883, dtype=torch.float64)
11 gae_duplicate tensor(-0.9181, dtype=torch.float64) tensor(6.0821, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2869, dtype=torch.float64) delta_t tensor(-0.2055, dtype=torch.float64)
10 gae_duplicate tensor(-1.9342, dtype=torch.float64) tensor(4.1614, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6889, dtype=torch.float64) delta_t tensor(-1.5007, dtype=torch.float64)
9 gae_duplicate tensor(-2.8629, dtype=torch.float64) tensor(30.1545, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.8079, dtype=torch.float64) delta_t tensor(-1.1021, dtype=torch.float64)
8 gae_duplicate tensor(-2.8162, dtype=torch.float64) tensor(24.7353, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0729, dtype=torch.float64) delta_t tensor(0.2359, dtype=torch.float64)
7 gae_duplicate tensor(-1.6916, dtype=torch.float64) tensor(-1.4272, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4346, dtype=torch.float64) delta_t tensor(0.1715, dtype=torch.float64)
6 gae_duplicate tensor(-2.2392, dtype=torch.float64) tensor(-3.5813, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2836, dtype=torch.float64) delta_t tensor(0.3077, dtype=torch.float64)
5 gae_duplicate tensor(0.0935, dtype=torch.float64) tensor(-5.9625, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0040, dtype=torch.float64) delta_t tensor(0.0109, dtype=torch.float64)
4 gae_duplicate tensor(-0.4409, dtype=torch.float64) tensor(-0.9725, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3607, dtype=torch.float64) delta_t tensor(0.1574, dtype=torch.float64)
3 gae_duplicate tensor(-0.1061, dtype=torch.float64) tensor(-2.5089, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4483, dtype=torch.float64) delta_t tensor(-0.3739, dtype=torch.float64)
2 gae_duplicate tensor(-0.4505, dtype=torch.float64) tensor(7.0920, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2704.33935546875
value loss:105.20214080810547
entropies:343.6763610839844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9013447761535645 seconds
19 rew tensor(0.8621, dtype=torch.float64) delta_t tensor(-0.1048, dtype=torch.float64)
19 gae_duplicate tensor(-0.1435, dtype=torch.float64) tensor(1.9440, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6137, dtype=torch.float64) delta_t tensor(-0.0667, dtype=torch.float64)
18 gae_duplicate tensor(-0.8684, dtype=torch.float64) tensor(1.8103, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(0.0606, dtype=torch.float64)
17 gae_duplicate tensor(-0.2003, dtype=torch.float64) tensor(-0.8114, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6750, dtype=torch.float64) delta_t tensor(0.2362, dtype=torch.float64)
16 gae_duplicate tensor(0.0484, dtype=torch.float64) tensor(-4.3374, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7413, dtype=torch.float64) delta_t tensor(0.1789, dtype=torch.float64)
15 gae_duplicate tensor(-0.0959, dtype=torch.float64) tensor(-3.3284, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3637, dtype=torch.float64) delta_t tensor(-0.0278, dtype=torch.float64)
14 gae_duplicate tensor(-0.7088, dtype=torch.float64) tensor(0.4873, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6737, dtype=torch.float64) delta_t tensor(0.3985, dtype=torch.float64)
13 gae_duplicate tensor(0.3352, dtype=torch.float64) tensor(-7.4589, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3781, dtype=torch.float64) delta_t tensor(0.2375, dtype=torch.float64)
12 gae_duplicate tensor(-0.8994, dtype=torch.float64) tensor(-6.2597, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2268, dtype=torch.float64) delta_t tensor(-0.3850, dtype=torch.float64)
11 gae_duplicate tensor(-1.7959, dtype=torch.float64) tensor(5.6969, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0112, dtype=torch.float64) delta_t tensor(0.1914, dtype=torch.float64)
10 gae_duplicate tensor(-1.9011, dtype=torch.float64) tensor(-2.2114, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4897, dtype=torch.float64) delta_t tensor(-1.0136, dtype=torch.float64)
9 gae_duplicate tensor(-3.1833, dtype=torch.float64) tensor(18.6348, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6158, dtype=torch.float64) delta_t tensor(-0.1659, dtype=torch.float64)
8 gae_duplicate tensor(-1.5360, dtype=torch.float64) tensor(5.8142, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5524, dtype=torch.float64) delta_t tensor(-1.0877, dtype=torch.float64)
7 gae_duplicate tensor(-2.5412, dtype=torch.float64) tensor(23.2145, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1323, dtype=torch.float64) delta_t tensor(0.1486, dtype=torch.float64)
6 gae_duplicate tensor(-2.6771, dtype=torch.float64) tensor(-2.2397, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1207, dtype=torch.float64) delta_t tensor(0.1258, dtype=torch.float64)
5 gae_duplicate tensor(-0.3359, dtype=torch.float64) tensor(-2.5002, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2660, dtype=torch.float64) delta_t tensor(0.2055, dtype=torch.float64)
4 gae_duplicate tensor(-0.1235, dtype=torch.float64) tensor(-4.4390, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0114, dtype=torch.float64) delta_t tensor(0.0762, dtype=torch.float64)
3 gae_duplicate tensor(-0.2541, dtype=torch.float64) tensor(-1.5947, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2128, dtype=torch.float64) delta_t tensor(-0.2206, dtype=torch.float64)
2 gae_duplicate tensor(-0.5192, dtype=torch.float64) tensor(4.0177, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1520.6318359375
value loss:105.79415893554688
entropies:344.1833801269531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9224159717559814 seconds
19 rew tensor(0.8793, dtype=torch.float64) delta_t tensor(-0.0384, dtype=torch.float64)
19 gae_duplicate tensor(-0.2057, dtype=torch.float64) tensor(0.6005, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8694, dtype=torch.float64) delta_t tensor(0.0583, dtype=torch.float64)
18 gae_duplicate tensor(-0.0630, dtype=torch.float64) tensor(-1.0918, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8019, dtype=torch.float64) delta_t tensor(0.1271, dtype=torch.float64)
17 gae_duplicate tensor(-0.1130, dtype=torch.float64) tensor(-2.3528, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6753, dtype=torch.float64) delta_t tensor(0.0413, dtype=torch.float64)
16 gae_duplicate tensor(-0.2129, dtype=torch.float64) tensor(-0.9421, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4811, dtype=torch.float64) delta_t tensor(-0.0313, dtype=torch.float64)
15 gae_duplicate tensor(-0.7015, dtype=torch.float64) tensor(0.4472, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6231, dtype=torch.float64) delta_t tensor(0.2876, dtype=torch.float64)
14 gae_duplicate tensor(0.0723, dtype=torch.float64) tensor(-5.8630, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5598, dtype=torch.float64) delta_t tensor(0.3781, dtype=torch.float64)
13 gae_duplicate tensor(0.1638, dtype=torch.float64) tensor(-7.2396, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3202, dtype=torch.float64) delta_t tensor(0.2614, dtype=torch.float64)
12 gae_duplicate tensor(-0.5248, dtype=torch.float64) tensor(-5.9000, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0744, dtype=torch.float64) delta_t tensor(0.0265, dtype=torch.float64)
11 gae_duplicate tensor(-0.9132, dtype=torch.float64) tensor(-2.6089, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2499, dtype=torch.float64) delta_t tensor(-0.0650, dtype=torch.float64)
10 gae_duplicate tensor(-2.0082, dtype=torch.float64) tensor(0.6820, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3634, dtype=torch.float64) delta_t tensor(-0.7911, dtype=torch.float64)
9 gae_duplicate tensor(-3.1789, dtype=torch.float64) tensor(16.2430, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4965, dtype=torch.float64) delta_t tensor(0.0193, dtype=torch.float64)
8 gae_duplicate tensor(-2.7423, dtype=torch.float64) tensor(3.6550, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2390, dtype=torch.float64) delta_t tensor(0.2098, dtype=torch.float64)
7 gae_duplicate tensor(-2.1529, dtype=torch.float64) tensor(-5.3497, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3295, dtype=torch.float64) delta_t tensor(0.0668, dtype=torch.float64)
6 gae_duplicate tensor(-1.9168, dtype=torch.float64) tensor(-1.5893, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1832, dtype=torch.float64) delta_t tensor(0.1901, dtype=torch.float64)
5 gae_duplicate tensor(-0.3262, dtype=torch.float64) tensor(-4.1399, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3257, dtype=torch.float64) delta_t tensor(0.2671, dtype=torch.float64)
4 gae_duplicate tensor(-0.0107, dtype=torch.float64) tensor(-6.0967, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0367, dtype=torch.float64) delta_t tensor(0.0844, dtype=torch.float64)
3 gae_duplicate tensor(-0.1414, dtype=torch.float64) tensor(-2.2857, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2296, dtype=torch.float64) delta_t tensor(-0.1789, dtype=torch.float64)
2 gae_duplicate tensor(-0.4687, dtype=torch.float64) tensor(3.3128, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1015.0543823242188
value loss:84.86368560791016
entropies:344.36029052734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.696745872497559 seconds
19 rew tensor(0.8514, dtype=torch.float64) delta_t tensor(0.0441, dtype=torch.float64)
19 gae_duplicate tensor(-0.0193, dtype=torch.float64) tensor(-0.8358, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7965, dtype=torch.float64) delta_t tensor(0.0893, dtype=torch.float64)
18 gae_duplicate tensor(-0.1109, dtype=torch.float64) tensor(-1.7324, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7778, dtype=torch.float64) delta_t tensor(0.1572, dtype=torch.float64)
17 gae_duplicate tensor(0.0564, dtype=torch.float64) tensor(-3.7676, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7088, dtype=torch.float64) delta_t tensor(0.2606, dtype=torch.float64)
16 gae_duplicate tensor(0.1287, dtype=torch.float64) tensor(-5.3404, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6445, dtype=torch.float64) delta_t tensor(0.2163, dtype=torch.float64)
15 gae_duplicate tensor(-0.0684, dtype=torch.float64) tensor(-4.8845, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4286, dtype=torch.float64) delta_t tensor(0.1335, dtype=torch.float64)
14 gae_duplicate tensor(-0.5274, dtype=torch.float64) tensor(-3.0231, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6460, dtype=torch.float64) delta_t tensor(0.4561, dtype=torch.float64)
13 gae_duplicate tensor(0.2458, dtype=torch.float64) tensor(-9.3397, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3048, dtype=torch.float64) delta_t tensor(0.2315, dtype=torch.float64)
12 gae_duplicate tensor(-0.5735, dtype=torch.float64) tensor(-5.6252, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3074, dtype=torch.float64) delta_t tensor(-0.1167, dtype=torch.float64)
11 gae_duplicate tensor(-1.5848, dtype=torch.float64) tensor(1.4941, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2574, dtype=torch.float64) delta_t tensor(0.4415, dtype=torch.float64)
10 gae_duplicate tensor(-0.7850, dtype=torch.float64) tensor(-9.3813, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.0054, dtype=torch.float64) delta_t tensor(-1.5510, dtype=torch.float64)
9 gae_duplicate tensor(-3.0518, dtype=torch.float64) tensor(29.7453, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6256, dtype=torch.float64) delta_t tensor(-1.0514, dtype=torch.float64)
8 gae_duplicate tensor(-2.7539, dtype=torch.float64) tensor(20.8910, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0280, dtype=torch.float64) delta_t tensor(0.4406, dtype=torch.float64)
7 gae_duplicate tensor(-0.1789, dtype=torch.float64) tensor(-6.7690, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0441, dtype=torch.float64) delta_t tensor(0.5411, dtype=torch.float64)
6 gae_duplicate tensor(-0.6128, dtype=torch.float64) tensor(-10.0193, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0349, dtype=torch.float64) delta_t tensor(0.1739, dtype=torch.float64)
5 gae_duplicate tensor(-0.8265, dtype=torch.float64) tensor(-3.8341, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1178, dtype=torch.float64) delta_t tensor(-0.0918, dtype=torch.float64)
4 gae_duplicate tensor(-1.0295, dtype=torch.float64) tensor(1.8701, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3245, dtype=torch.float64) delta_t tensor(0.2125, dtype=torch.float64)
3 gae_duplicate tensor(-0.0751, dtype=torch.float64) tensor(-4.3820, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4276, dtype=torch.float64) delta_t tensor(-0.2364, dtype=torch.float64)
2 gae_duplicate tensor(-0.3969, dtype=torch.float64) tensor(4.4159, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:474.92333984375
value loss:91.50518798828125
entropies:344.5966796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.281749963760376 seconds
19 rew tensor(0.8637, dtype=torch.float64) delta_t tensor(0.0120, dtype=torch.float64)
19 gae_duplicate tensor(-0.1205, dtype=torch.float64) tensor(-0.1952, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8124, dtype=torch.float64) delta_t tensor(0.2101, dtype=torch.float64)
18 gae_duplicate tensor(0.0523, dtype=torch.float64) tensor(-3.9008, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8062, dtype=torch.float64) delta_t tensor(0.2629, dtype=torch.float64)
17 gae_duplicate tensor(-0.0488, dtype=torch.float64) tensor(-5.4613, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6252, dtype=torch.float64) delta_t tensor(0.1520, dtype=torch.float64)
16 gae_duplicate tensor(-0.0501, dtype=torch.float64) tensor(-3.8485, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7254, dtype=torch.float64) delta_t tensor(0.3710, dtype=torch.float64)
15 gae_duplicate tensor(-0.1023, dtype=torch.float64) tensor(-6.8093, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2532, dtype=torch.float64) delta_t tensor(0.0660, dtype=torch.float64)
14 gae_duplicate tensor(-0.8527, dtype=torch.float64) tensor(-2.2344, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3197, dtype=torch.float64) delta_t tensor(0.1209, dtype=torch.float64)
13 gae_duplicate tensor(-0.7045, dtype=torch.float64) tensor(-2.4783, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1117, dtype=torch.float64) delta_t tensor(0.1709, dtype=torch.float64)
12 gae_duplicate tensor(-0.5906, dtype=torch.float64) tensor(-3.1867, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2146, dtype=torch.float64) delta_t tensor(-0.3617, dtype=torch.float64)
11 gae_duplicate tensor(-1.5694, dtype=torch.float64) tensor(6.7931, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2096, dtype=torch.float64) delta_t tensor(0.1175, dtype=torch.float64)
10 gae_duplicate tensor(-0.6616, dtype=torch.float64) tensor(-1.9795, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8301, dtype=torch.float64) delta_t tensor(-0.5904, dtype=torch.float64)
9 gae_duplicate tensor(-3.3068, dtype=torch.float64) tensor(14.5569, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2308, dtype=torch.float64) delta_t tensor(-0.4218, dtype=torch.float64)
8 gae_duplicate tensor(-2.5713, dtype=torch.float64) tensor(10.7721, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1118, dtype=torch.float64) delta_t tensor(0.0336, dtype=torch.float64)
7 gae_duplicate tensor(-1.8281, dtype=torch.float64) tensor(0.1557, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0882, dtype=torch.float64) delta_t tensor(0.7408, dtype=torch.float64)
6 gae_duplicate tensor(0.0568, dtype=torch.float64) tensor(-14.3132, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2673, dtype=torch.float64) delta_t tensor(0.2695, dtype=torch.float64)
5 gae_duplicate tensor(0.1276, dtype=torch.float64) tensor(-6.3792, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0718, dtype=torch.float64) delta_t tensor(0.1424, dtype=torch.float64)
4 gae_duplicate tensor(-0.1289, dtype=torch.float64) tensor(-3.7482, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3110, dtype=torch.float64) delta_t tensor(0.3126, dtype=torch.float64)
3 gae_duplicate tensor(-0.0046, dtype=torch.float64) tensor(-6.5074, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3909, dtype=torch.float64) delta_t tensor(-0.2221, dtype=torch.float64)
2 gae_duplicate tensor(-0.4834, dtype=torch.float64) tensor(3.2096, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1286.818115234375
value loss:82.9584732055664
entropies:344.9144287109375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3874.4419)
ToM Target loss= tensor(3598.5618)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.008095026016235 seconds
19 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.1478, dtype=torch.float64)
19 gae_duplicate tensor(0.0161, dtype=torch.float64) tensor(-2.3996, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8119, dtype=torch.float64) delta_t tensor(0.1520, dtype=torch.float64)
18 gae_duplicate tensor(-0.0582, dtype=torch.float64) tensor(-3.1135, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7692, dtype=torch.float64) delta_t tensor(0.2008, dtype=torch.float64)
17 gae_duplicate tensor(0.1161, dtype=torch.float64) tensor(-4.3308, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7584, dtype=torch.float64) delta_t tensor(0.2883, dtype=torch.float64)
16 gae_duplicate tensor(0.1523, dtype=torch.float64) tensor(-6.0806, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6999, dtype=torch.float64) delta_t tensor(0.2819, dtype=torch.float64)
15 gae_duplicate tensor(-0.0175, dtype=torch.float64) tensor(-5.5326, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6801, dtype=torch.float64) delta_t tensor(0.2519, dtype=torch.float64)
14 gae_duplicate tensor(0.0128, dtype=torch.float64) tensor(-5.2502, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5369, dtype=torch.float64) delta_t tensor(0.4171, dtype=torch.float64)
13 gae_duplicate tensor(0.3037, dtype=torch.float64) tensor(-8.9492, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6773, dtype=torch.float64) delta_t tensor(0.6660, dtype=torch.float64)
12 gae_duplicate tensor(0.5088, dtype=torch.float64) tensor(-13.5986, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5124, dtype=torch.float64) delta_t tensor(-0.3397, dtype=torch.float64)
11 gae_duplicate tensor(-1.6494, dtype=torch.float64) tensor(3.9883, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1224, dtype=torch.float64) delta_t tensor(0.2195, dtype=torch.float64)
10 gae_duplicate tensor(-1.9810, dtype=torch.float64) tensor(-2.2774, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.5043, dtype=torch.float64) delta_t tensor(-1.4733, dtype=torch.float64)
9 gae_duplicate tensor(-3.4080, dtype=torch.float64) tensor(29.8086, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6497, dtype=torch.float64) delta_t tensor(-0.3235, dtype=torch.float64)
8 gae_duplicate tensor(-1.9938, dtype=torch.float64) tensor(9.7099, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9063, dtype=torch.float64) delta_t tensor(0.0294, dtype=torch.float64)
7 gae_duplicate tensor(-2.4795, dtype=torch.float64) tensor(0.6415, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4325, dtype=torch.float64) delta_t tensor(0.6605, dtype=torch.float64)
6 gae_duplicate tensor(0.3116, dtype=torch.float64) tensor(-12.7785, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3925, dtype=torch.float64) delta_t tensor(0.4133, dtype=torch.float64)
5 gae_duplicate tensor(0.0605, dtype=torch.float64) tensor(-9.8336, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5088, dtype=torch.float64) delta_t tensor(0.4620, dtype=torch.float64)
4 gae_duplicate tensor(0.1667, dtype=torch.float64) tensor(-10.1709, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1292, dtype=torch.float64) delta_t tensor(0.0311, dtype=torch.float64)
3 gae_duplicate tensor(-0.1100, dtype=torch.float64) tensor(-1.3587, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1112, dtype=torch.float64) delta_t tensor(-0.0116, dtype=torch.float64)
2 gae_duplicate tensor(-0.2585, dtype=torch.float64) tensor(0.0754, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2145.264892578125
value loss:113.83673858642578
entropies:344.6797790527344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.273815870285034 seconds
19 rew tensor(0.8478, dtype=torch.float64) delta_t tensor(0.0965, dtype=torch.float64)
19 gae_duplicate tensor(-0.1814, dtype=torch.float64) tensor(-2.2231, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8017, dtype=torch.float64) delta_t tensor(0.1251, dtype=torch.float64)
18 gae_duplicate tensor(-0.0534, dtype=torch.float64) tensor(-2.6992, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8141, dtype=torch.float64) delta_t tensor(0.2223, dtype=torch.float64)
17 gae_duplicate tensor(0.1229, dtype=torch.float64) tensor(-4.5999, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7266, dtype=torch.float64) delta_t tensor(0.2337, dtype=torch.float64)
16 gae_duplicate tensor(-0.0793, dtype=torch.float64) tensor(-4.3976, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5946, dtype=torch.float64) delta_t tensor(0.2265, dtype=torch.float64)
15 gae_duplicate tensor(0.0092, dtype=torch.float64) tensor(-4.5894, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2468, dtype=torch.float64) delta_t tensor(0.0327, dtype=torch.float64)
14 gae_duplicate tensor(-0.5349, dtype=torch.float64) tensor(-0.2562, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4878, dtype=torch.float64) delta_t tensor(0.4223, dtype=torch.float64)
13 gae_duplicate tensor(0.2699, dtype=torch.float64) tensor(-8.3734, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4027, dtype=torch.float64) delta_t tensor(0.4188, dtype=torch.float64)
12 gae_duplicate tensor(-0.3885, dtype=torch.float64) tensor(-7.9644, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4227, dtype=torch.float64) delta_t tensor(-0.1367, dtype=torch.float64)
11 gae_duplicate tensor(-1.0312, dtype=torch.float64) tensor(3.2785, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0648, dtype=torch.float64) delta_t tensor(0.4323, dtype=torch.float64)
10 gae_duplicate tensor(-0.2954, dtype=torch.float64) tensor(-7.6700, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.1115, dtype=torch.float64) delta_t tensor(-1.3638, dtype=torch.float64)
9 gae_duplicate tensor(-3.8053, dtype=torch.float64) tensor(24.5199, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2025, dtype=torch.float64) delta_t tensor(-0.5897, dtype=torch.float64)
8 gae_duplicate tensor(-2.3409, dtype=torch.float64) tensor(10.9608, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5785, dtype=torch.float64) delta_t tensor(0.0659, dtype=torch.float64)
7 gae_duplicate tensor(-1.8827, dtype=torch.float64) tensor(2.2721, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2802, dtype=torch.float64) delta_t tensor(0.5559, dtype=torch.float64)
6 gae_duplicate tensor(-0.2874, dtype=torch.float64) tensor(-9.5635, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1637, dtype=torch.float64) delta_t tensor(0.3439, dtype=torch.float64)
5 gae_duplicate tensor(-0.0077, dtype=torch.float64) tensor(-7.7783, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2812, dtype=torch.float64) delta_t tensor(0.3914, dtype=torch.float64)
4 gae_duplicate tensor(0.2293, dtype=torch.float64) tensor(-7.6549, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0322, dtype=torch.float64) delta_t tensor(0.1105, dtype=torch.float64)
3 gae_duplicate tensor(-0.1469, dtype=torch.float64) tensor(-2.6340, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2583, dtype=torch.float64) delta_t tensor(-0.0985, dtype=torch.float64)
2 gae_duplicate tensor(-0.4006, dtype=torch.float64) tensor(1.4752, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1413.526611328125
value loss:102.25324249267578
entropies:344.24249267578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.275759696960449 seconds
19 rew tensor(0.8806, dtype=torch.float64) delta_t tensor(0.0929, dtype=torch.float64)
19 gae_duplicate tensor(-0.0257, dtype=torch.float64) tensor(-1.7073, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8637, dtype=torch.float64) delta_t tensor(0.1758, dtype=torch.float64)
18 gae_duplicate tensor(-0.0693, dtype=torch.float64) tensor(-3.2892, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8352, dtype=torch.float64) delta_t tensor(0.0666, dtype=torch.float64)
17 gae_duplicate tensor(0.0165, dtype=torch.float64) tensor(-1.5769, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7350, dtype=torch.float64) delta_t tensor(0.1633, dtype=torch.float64)
16 gae_duplicate tensor(-0.0346, dtype=torch.float64) tensor(-3.1408, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4386, dtype=torch.float64) delta_t tensor(-0.2199, dtype=torch.float64)
15 gae_duplicate tensor(-0.7749, dtype=torch.float64) tensor(3.2012, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5959, dtype=torch.float64) delta_t tensor(0.2748, dtype=torch.float64)
14 gae_duplicate tensor(0.0487, dtype=torch.float64) tensor(-4.9844, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6938, dtype=torch.float64) delta_t tensor(0.5217, dtype=torch.float64)
13 gae_duplicate tensor(0.2440, dtype=torch.float64) tensor(-10.0287, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4183, dtype=torch.float64) delta_t tensor(0.2351, dtype=torch.float64)
12 gae_duplicate tensor(-0.1010, dtype=torch.float64) tensor(-5.3777, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1910, dtype=torch.float64) delta_t tensor(-0.1941, dtype=torch.float64)
11 gae_duplicate tensor(-0.7284, dtype=torch.float64) tensor(3.0218, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.9487, dtype=torch.float64) delta_t tensor(-0.7753, dtype=torch.float64)
10 gae_duplicate tensor(-2.0438, dtype=torch.float64) tensor(14.3732, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8359, dtype=torch.float64) delta_t tensor(-0.6360, dtype=torch.float64)
9 gae_duplicate tensor(-1.8577, dtype=torch.float64) tensor(15.1021, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9437, dtype=torch.float64) delta_t tensor(0.0744, dtype=torch.float64)
8 gae_duplicate tensor(-2.1806, dtype=torch.float64) tensor(-1.7623, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.6317, dtype=torch.float64) delta_t tensor(0.7407, dtype=torch.float64)
7 gae_duplicate tensor(0.6395, dtype=torch.float64) tensor(-13.4488, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1545, dtype=torch.float64) delta_t tensor(0.8017, dtype=torch.float64)
6 gae_duplicate tensor(0.7338, dtype=torch.float64) tensor(-18.0202, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3189, dtype=torch.float64) delta_t tensor(0.2131, dtype=torch.float64)
5 gae_duplicate tensor(-0.0831, dtype=torch.float64) tensor(-6.4629, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2534, dtype=torch.float64) delta_t tensor(0.0325, dtype=torch.float64)
4 gae_duplicate tensor(-0.3117, dtype=torch.float64) tensor(-1.4209, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5405, dtype=torch.float64) delta_t tensor(0.3487, dtype=torch.float64)
3 gae_duplicate tensor(0.1628, dtype=torch.float64) tensor(-6.3350, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6361, dtype=torch.float64) delta_t tensor(-0.3423, dtype=torch.float64)
2 gae_duplicate tensor(-0.5032, dtype=torch.float64) tensor(6.1512, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1835.416748046875
value loss:71.14521026611328
entropies:343.28338623046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.01371693611145 seconds
19 rew tensor(0.8795, dtype=torch.float64) delta_t tensor(0.0858, dtype=torch.float64)
19 gae_duplicate tensor(-0.1144, dtype=torch.float64) tensor(-1.7438, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8275, dtype=torch.float64) delta_t tensor(0.0553, dtype=torch.float64)
18 gae_duplicate tensor(-0.0885, dtype=torch.float64) tensor(-1.4857, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7889, dtype=torch.float64) delta_t tensor(0.1082, dtype=torch.float64)
17 gae_duplicate tensor(-0.0738, dtype=torch.float64) tensor(-2.1802, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7336, dtype=torch.float64) delta_t tensor(0.0335, dtype=torch.float64)
16 gae_duplicate tensor(-0.1653, dtype=torch.float64) tensor(-0.7809, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3768, dtype=torch.float64) delta_t tensor(-0.1875, dtype=torch.float64)
15 gae_duplicate tensor(-1.0838, dtype=torch.float64) tensor(3.3771, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5124, dtype=torch.float64) delta_t tensor(0.1953, dtype=torch.float64)
14 gae_duplicate tensor(-0.5739, dtype=torch.float64) tensor(-3.3919, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5442, dtype=torch.float64) delta_t tensor(0.4096, dtype=torch.float64)
13 gae_duplicate tensor(0.2038, dtype=torch.float64) tensor(-8.2729, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6438, dtype=torch.float64) delta_t tensor(0.3854, dtype=torch.float64)
12 gae_duplicate tensor(-0.0355, dtype=torch.float64) tensor(-8.5064, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3462, dtype=torch.float64) delta_t tensor(-0.2762, dtype=torch.float64)
11 gae_duplicate tensor(-1.4674, dtype=torch.float64) tensor(4.1939, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3228, dtype=torch.float64) delta_t tensor(0.4958, dtype=torch.float64)
10 gae_duplicate tensor(-0.3466, dtype=torch.float64) tensor(-8.1121, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-3.5166, dtype=torch.float64) delta_t tensor(-2.8411, dtype=torch.float64)
9 gae_duplicate tensor(-5.5653, dtype=torch.float64) tensor(62.6001, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.5391, dtype=torch.float64) delta_t tensor(-0.9090, dtype=torch.float64)
8 gae_duplicate tensor(-2.6088, dtype=torch.float64) tensor(25.9679, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5139, dtype=torch.float64) delta_t tensor(0.0130, dtype=torch.float64)
7 gae_duplicate tensor(-2.3288, dtype=torch.float64) tensor(1.6349, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0610, dtype=torch.float64) delta_t tensor(0.3308, dtype=torch.float64)
6 gae_duplicate tensor(-1.9091, dtype=torch.float64) tensor(-5.0393, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1147, dtype=torch.float64) delta_t tensor(0.2385, dtype=torch.float64)
5 gae_duplicate tensor(-0.2535, dtype=torch.float64) tensor(-5.1491, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4176, dtype=torch.float64) delta_t tensor(0.2994, dtype=torch.float64)
4 gae_duplicate tensor(-0.0928, dtype=torch.float64) tensor(-6.7089, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1686, dtype=torch.float64) delta_t tensor(-0.0636, dtype=torch.float64)
3 gae_duplicate tensor(-0.5483, dtype=torch.float64) tensor(0.5347, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0794, dtype=torch.float64) delta_t tensor(-0.0409, dtype=torch.float64)
2 gae_duplicate tensor(-0.2985, dtype=torch.float64) tensor(0.8100, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2670.955078125
value loss:152.901611328125
entropies:342.95233154296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.719244003295898 seconds
19 rew tensor(0.8464, dtype=torch.float64) delta_t tensor(-0.0484, dtype=torch.float64)
19 gae_duplicate tensor(-0.2667, dtype=torch.float64) tensor(0.9212, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8080, dtype=torch.float64) delta_t tensor(0.1111, dtype=torch.float64)
18 gae_duplicate tensor(-0.1495, dtype=torch.float64) tensor(-1.9893, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8408, dtype=torch.float64) delta_t tensor(0.0006, dtype=torch.float64)
17 gae_duplicate tensor(-0.0359, dtype=torch.float64) tensor(-0.2346, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6548, dtype=torch.float64) delta_t tensor(0.0043, dtype=torch.float64)
16 gae_duplicate tensor(-0.1285, dtype=torch.float64) tensor(-0.1164, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7265, dtype=torch.float64) delta_t tensor(-0.0750, dtype=torch.float64)
15 gae_duplicate tensor(-0.1395, dtype=torch.float64) tensor(1.3299, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4204, dtype=torch.float64) delta_t tensor(-0.0807, dtype=torch.float64)
14 gae_duplicate tensor(-0.6588, dtype=torch.float64) tensor(1.6446, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6399, dtype=torch.float64) delta_t tensor(0.0313, dtype=torch.float64)
13 gae_duplicate tensor(-0.1247, dtype=torch.float64) tensor(-0.4468, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3116, dtype=torch.float64) delta_t tensor(-0.4705, dtype=torch.float64)
12 gae_duplicate tensor(-1.9242, dtype=torch.float64) tensor(9.8599, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1878, dtype=torch.float64) delta_t tensor(0.0222, dtype=torch.float64)
11 gae_duplicate tensor(-1.3215, dtype=torch.float64) tensor(-0.0088, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7081, dtype=torch.float64) delta_t tensor(-0.5696, dtype=torch.float64)
10 gae_duplicate tensor(-2.0557, dtype=torch.float64) tensor(13.0924, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0104, dtype=torch.float64) delta_t tensor(0.3975, dtype=torch.float64)
9 gae_duplicate tensor(-0.9714, dtype=torch.float64) tensor(-7.7435, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5254, dtype=torch.float64) delta_t tensor(0.0116, dtype=torch.float64)
8 gae_duplicate tensor(-3.2822, dtype=torch.float64) tensor(-2.6615, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0084, dtype=torch.float64) delta_t tensor(0.4087, dtype=torch.float64)
7 gae_duplicate tensor(-1.5127, dtype=torch.float64) tensor(-6.6086, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3201, dtype=torch.float64) delta_t tensor(0.2349, dtype=torch.float64)
6 gae_duplicate tensor(-2.1380, dtype=torch.float64) tensor(-4.2607, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4633, dtype=torch.float64) delta_t tensor(-0.5270, dtype=torch.float64)
5 gae_duplicate tensor(-3.7917, dtype=torch.float64) tensor(9.1591, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0270, dtype=torch.float64) delta_t tensor(0.0689, dtype=torch.float64)
4 gae_duplicate tensor(-0.4082, dtype=torch.float64) tensor(-0.7624, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3215, dtype=torch.float64) delta_t tensor(0.2590, dtype=torch.float64)
3 gae_duplicate tensor(0.0499, dtype=torch.float64) tensor(-4.9744, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4758, dtype=torch.float64) delta_t tensor(-0.2614, dtype=torch.float64)
2 gae_duplicate tensor(-0.5134, dtype=torch.float64) tensor(4.7181, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-681.9527587890625
value loss:93.43682861328125
entropies:342.0968017578125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3845.0667)
ToM Target loss= tensor(3605.3955)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.095395088195801 seconds
19 rew tensor(0.8477, dtype=torch.float64) delta_t tensor(-0.0815, dtype=torch.float64)
19 gae_duplicate tensor(-0.2018, dtype=torch.float64) tensor(1.5439, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8486, dtype=torch.float64) delta_t tensor(0.0384, dtype=torch.float64)
18 gae_duplicate tensor(-0.0213, dtype=torch.float64) tensor(-0.4619, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8193, dtype=torch.float64) delta_t tensor(-0.0100, dtype=torch.float64)
17 gae_duplicate tensor(-0.1519, dtype=torch.float64) tensor(0.1341, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7935, dtype=torch.float64) delta_t tensor(0.0679, dtype=torch.float64)
16 gae_duplicate tensor(-0.0550, dtype=torch.float64) tensor(-1.4238, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7205, dtype=torch.float64) delta_t tensor(0.0656, dtype=torch.float64)
15 gae_duplicate tensor(-0.2016, dtype=torch.float64) tensor(-1.2372, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6881, dtype=torch.float64) delta_t tensor(0.0417, dtype=torch.float64)
14 gae_duplicate tensor(-0.0689, dtype=torch.float64) tensor(-0.9547, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5379, dtype=torch.float64) delta_t tensor(0.2206, dtype=torch.float64)
13 gae_duplicate tensor(-0.2167, dtype=torch.float64) tensor(-4.1673, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3033, dtype=torch.float64) delta_t tensor(0.3712, dtype=torch.float64)
12 gae_duplicate tensor(-0.5862, dtype=torch.float64) tensor(-6.8676, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3067, dtype=torch.float64) delta_t tensor(-0.3910, dtype=torch.float64)
11 gae_duplicate tensor(-1.5645, dtype=torch.float64) tensor(6.6715, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3072, dtype=torch.float64) delta_t tensor(0.7928, dtype=torch.float64)
10 gae_duplicate tensor(0.4858, dtype=torch.float64) tensor(-15.0988, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.1938, dtype=torch.float64) delta_t tensor(-1.3735, dtype=torch.float64)
9 gae_duplicate tensor(-4.2906, dtype=torch.float64) tensor(25.3636, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4477, dtype=torch.float64) delta_t tensor(0.0412, dtype=torch.float64)
8 gae_duplicate tensor(-2.3732, dtype=torch.float64) tensor(-0.7450, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8039, dtype=torch.float64) delta_t tensor(-0.3372, dtype=torch.float64)
7 gae_duplicate tensor(-2.0364, dtype=torch.float64) tensor(8.0313, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6061, dtype=torch.float64) delta_t tensor(-0.1754, dtype=torch.float64)
6 gae_duplicate tensor(-3.8826, dtype=torch.float64) tensor(6.9905, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1263, dtype=torch.float64) delta_t tensor(0.2525, dtype=torch.float64)
5 gae_duplicate tensor(-0.4066, dtype=torch.float64) tensor(-4.5064, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3967, dtype=torch.float64) delta_t tensor(0.2173, dtype=torch.float64)
4 gae_duplicate tensor(-0.0603, dtype=torch.float64) tensor(-4.5387, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1795, dtype=torch.float64) delta_t tensor(-0.0862, dtype=torch.float64)
3 gae_duplicate tensor(-0.4274, dtype=torch.float64) tensor(1.0632, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1755, dtype=torch.float64) delta_t tensor(-0.0615, dtype=torch.float64)
2 gae_duplicate tensor(-0.2620, dtype=torch.float64) tensor(1.4664, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-700.27783203125
value loss:134.38343811035156
entropies:341.00738525390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.008471965789795 seconds
19 rew tensor(0.8571, dtype=torch.float64) delta_t tensor(-0.0010, dtype=torch.float64)
19 gae_duplicate tensor(-0.1678, dtype=torch.float64) tensor(-0.0386, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8282, dtype=torch.float64) delta_t tensor(0.0834, dtype=torch.float64)
18 gae_duplicate tensor(-0.1176, dtype=torch.float64) tensor(-1.4332, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6115, dtype=torch.float64) delta_t tensor(-0.1594, dtype=torch.float64)
17 gae_duplicate tensor(-1.2150, dtype=torch.float64) tensor(2.6939, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4726, dtype=torch.float64) delta_t tensor(-0.2338, dtype=torch.float64)
16 gae_duplicate tensor(-1.2853, dtype=torch.float64) tensor(4.6690, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6428, dtype=torch.float64) delta_t tensor(-0.0120, dtype=torch.float64)
15 gae_duplicate tensor(-0.2474, dtype=torch.float64) tensor(0.9593, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1951, dtype=torch.float64) delta_t tensor(0.1537, dtype=torch.float64)
14 gae_duplicate tensor(-0.7394, dtype=torch.float64) tensor(-3.7663, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2356, dtype=torch.float64) delta_t tensor(-0.0509, dtype=torch.float64)
13 gae_duplicate tensor(-0.6850, dtype=torch.float64) tensor(0.7480, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1867, dtype=torch.float64) delta_t tensor(0.1275, dtype=torch.float64)
12 gae_duplicate tensor(-0.8822, dtype=torch.float64) tensor(-2.3460, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1279, dtype=torch.float64) delta_t tensor(-0.0743, dtype=torch.float64)
11 gae_duplicate tensor(-1.2657, dtype=torch.float64) tensor(1.5163, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7887, dtype=torch.float64) delta_t tensor(-0.4622, dtype=torch.float64)
10 gae_duplicate tensor(-2.0095, dtype=torch.float64) tensor(6.8111, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6207, dtype=torch.float64) delta_t tensor(-0.8013, dtype=torch.float64)
9 gae_duplicate tensor(-3.6448, dtype=torch.float64) tensor(14.3425, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0629, dtype=torch.float64) delta_t tensor(0.1248, dtype=torch.float64)
8 gae_duplicate tensor(-2.1588, dtype=torch.float64) tensor(1.0349, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5818, dtype=torch.float64) delta_t tensor(0.1026, dtype=torch.float64)
7 gae_duplicate tensor(-1.3872, dtype=torch.float64) tensor(-1.4643, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3058, dtype=torch.float64) delta_t tensor(0.5875, dtype=torch.float64)
6 gae_duplicate tensor(-0.1503, dtype=torch.float64) tensor(-11.4736, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1668, dtype=torch.float64) delta_t tensor(0.2854, dtype=torch.float64)
5 gae_duplicate tensor(0.1942, dtype=torch.float64) tensor(-6.0155, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2614, dtype=torch.float64) delta_t tensor(0.1367, dtype=torch.float64)
4 gae_duplicate tensor(-0.3856, dtype=torch.float64) tensor(-3.0064, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0003, dtype=torch.float64) delta_t tensor(0.1103, dtype=torch.float64)
3 gae_duplicate tensor(-0.2038, dtype=torch.float64) tensor(-2.6626, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2303, dtype=torch.float64) delta_t tensor(-0.1096, dtype=torch.float64)
2 gae_duplicate tensor(-0.3539, dtype=torch.float64) tensor(1.7644, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-217.71128845214844
value loss:91.59088134765625
entropies:339.7672424316406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.71311092376709 seconds
19 rew tensor(0.8948, dtype=torch.float64) delta_t tensor(0.0731, dtype=torch.float64)
19 gae_duplicate tensor(-0.0282, dtype=torch.float64) tensor(-1.6262, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8859, dtype=torch.float64) delta_t tensor(0.1074, dtype=torch.float64)
18 gae_duplicate tensor(-0.0731, dtype=torch.float64) tensor(-2.4074, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7828, dtype=torch.float64) delta_t tensor(0.0222, dtype=torch.float64)
17 gae_duplicate tensor(-0.1040, dtype=torch.float64) tensor(-0.6921, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6736, dtype=torch.float64) delta_t tensor(-0.0732, dtype=torch.float64)
16 gae_duplicate tensor(-0.1456, dtype=torch.float64) tensor(1.3312, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7518, dtype=torch.float64) delta_t tensor(0.0114, dtype=torch.float64)
15 gae_duplicate tensor(-0.1599, dtype=torch.float64) tensor(-0.2188, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6063, dtype=torch.float64) delta_t tensor(0.1479, dtype=torch.float64)
14 gae_duplicate tensor(-0.1545, dtype=torch.float64) tensor(-3.3613, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6262, dtype=torch.float64) delta_t tensor(0.0317, dtype=torch.float64)
13 gae_duplicate tensor(-0.2089, dtype=torch.float64) tensor(-1.1369, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5195, dtype=torch.float64) delta_t tensor(0.1269, dtype=torch.float64)
12 gae_duplicate tensor(-0.1388, dtype=torch.float64) tensor(-1.9706, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4734, dtype=torch.float64) delta_t tensor(-0.8346, dtype=torch.float64)
11 gae_duplicate tensor(-2.5309, dtype=torch.float64) tensor(15.9586, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1337, dtype=torch.float64) delta_t tensor(-0.1408, dtype=torch.float64)
10 gae_duplicate tensor(-0.9838, dtype=torch.float64) tensor(4.3005, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2431, dtype=torch.float64) delta_t tensor(0.4344, dtype=torch.float64)
9 gae_duplicate tensor(-1.0553, dtype=torch.float64) tensor(-9.3911, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2288, dtype=torch.float64) delta_t tensor(0.5237, dtype=torch.float64)
8 gae_duplicate tensor(-0.1886, dtype=torch.float64) tensor(-10.0589, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2466, dtype=torch.float64) delta_t tensor(-0.6758, dtype=torch.float64)
7 gae_duplicate tensor(-2.3196, dtype=torch.float64) tensor(9.6478, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1321, dtype=torch.float64) delta_t tensor(-0.7113, dtype=torch.float64)
6 gae_duplicate tensor(-2.6452, dtype=torch.float64) tensor(15.1387, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7543, dtype=torch.float64) delta_t tensor(-0.4554, dtype=torch.float64)
5 gae_duplicate tensor(-2.5615, dtype=torch.float64) tensor(10.2690, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1481, dtype=torch.float64) delta_t tensor(0.0399, dtype=torch.float64)
4 gae_duplicate tensor(-0.5024, dtype=torch.float64) tensor(-0.1836, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0085, dtype=torch.float64) delta_t tensor(0.2115, dtype=torch.float64)
3 gae_duplicate tensor(-0.0914, dtype=torch.float64) tensor(-4.1345, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1790, dtype=torch.float64) delta_t tensor(-0.1146, dtype=torch.float64)
2 gae_duplicate tensor(-0.3594, dtype=torch.float64) tensor(2.5095, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1386.119873046875
value loss:91.62547302246094
entropies:338.96917724609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.760425090789795 seconds
19 rew tensor(0.8755, dtype=torch.float64) delta_t tensor(-0.0397, dtype=torch.float64)
19 gae_duplicate tensor(-0.1238, dtype=torch.float64) tensor(0.6415, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5732, dtype=torch.float64) delta_t tensor(-0.1328, dtype=torch.float64)
18 gae_duplicate tensor(-1.1997, dtype=torch.float64) tensor(2.1450, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7925, dtype=torch.float64) delta_t tensor(-0.0292, dtype=torch.float64)
17 gae_duplicate tensor(-0.1268, dtype=torch.float64) tensor(0.6586, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6430, dtype=torch.float64) delta_t tensor(-0.0418, dtype=torch.float64)
16 gae_duplicate tensor(-0.1643, dtype=torch.float64) tensor(0.9585, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5827, dtype=torch.float64) delta_t tensor(-0.1921, dtype=torch.float64)
15 gae_duplicate tensor(-1.2647, dtype=torch.float64) tensor(3.7700, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3914, dtype=torch.float64) delta_t tensor(-0.2043, dtype=torch.float64)
14 gae_duplicate tensor(-1.0686, dtype=torch.float64) tensor(4.4123, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6296, dtype=torch.float64) delta_t tensor(-0.0397, dtype=torch.float64)
13 gae_duplicate tensor(-0.1943, dtype=torch.float64) tensor(1.5184, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5065, dtype=torch.float64) delta_t tensor(-0.0199, dtype=torch.float64)
12 gae_duplicate tensor(-0.1330, dtype=torch.float64) tensor(0.5353, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1879, dtype=torch.float64) delta_t tensor(-0.2059, dtype=torch.float64)
11 gae_duplicate tensor(-1.0718, dtype=torch.float64) tensor(3.0485, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0556, dtype=torch.float64) delta_t tensor(0.2900, dtype=torch.float64)
10 gae_duplicate tensor(-0.5630, dtype=torch.float64) tensor(-4.8037, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4737, dtype=torch.float64) delta_t tensor(-0.9519, dtype=torch.float64)
9 gae_duplicate tensor(-2.5926, dtype=torch.float64) tensor(17.2829, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5683, dtype=torch.float64) delta_t tensor(-0.0821, dtype=torch.float64)
8 gae_duplicate tensor(-1.2659, dtype=torch.float64) tensor(3.7717, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7192, dtype=torch.float64) delta_t tensor(-0.2130, dtype=torch.float64)
7 gae_duplicate tensor(-1.3770, dtype=torch.float64) tensor(3.9789, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0175, dtype=torch.float64) delta_t tensor(0.5559, dtype=torch.float64)
6 gae_duplicate tensor(0.3225, dtype=torch.float64) tensor(-11.3469, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0834, dtype=torch.float64) delta_t tensor(0.2893, dtype=torch.float64)
5 gae_duplicate tensor(0.1463, dtype=torch.float64) tensor(-6.1576, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0554, dtype=torch.float64) delta_t tensor(0.1160, dtype=torch.float64)
4 gae_duplicate tensor(-0.1995, dtype=torch.float64) tensor(-3.2790, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2849, dtype=torch.float64) delta_t tensor(0.1885, dtype=torch.float64)
3 gae_duplicate tensor(-0.0434, dtype=torch.float64) tensor(-4.0150, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4128, dtype=torch.float64) delta_t tensor(-0.2334, dtype=torch.float64)
2 gae_duplicate tensor(-0.4790, dtype=torch.float64) tensor(3.9326, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1012.1680908203125
value loss:52.58586120605469
entropies:338.38043212890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.5675787925720215 seconds
19 rew tensor(0.8482, dtype=torch.float64) delta_t tensor(-0.0497, dtype=torch.float64)
19 gae_duplicate tensor(-0.2154, dtype=torch.float64) tensor(1.1486, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7915, dtype=torch.float64) delta_t tensor(0.1230, dtype=torch.float64)
18 gae_duplicate tensor(-0.0636, dtype=torch.float64) tensor(-2.6501, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8397, dtype=torch.float64) delta_t tensor(-0.0169, dtype=torch.float64)
17 gae_duplicate tensor(-0.0939, dtype=torch.float64) tensor(0.1205, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6269, dtype=torch.float64) delta_t tensor(0.0414, dtype=torch.float64)
16 gae_duplicate tensor(-0.1078, dtype=torch.float64) tensor(-0.9996, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7150, dtype=torch.float64) delta_t tensor(-0.0348, dtype=torch.float64)
15 gae_duplicate tensor(-0.1908, dtype=torch.float64) tensor(0.1546, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4828, dtype=torch.float64) delta_t tensor(0.1032, dtype=torch.float64)
14 gae_duplicate tensor(-0.0962, dtype=torch.float64) tensor(-1.5766, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6821, dtype=torch.float64) delta_t tensor(0.0792, dtype=torch.float64)
13 gae_duplicate tensor(-0.0643, dtype=torch.float64) tensor(-1.7835, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1105, dtype=torch.float64) delta_t tensor(-0.0298, dtype=torch.float64)
12 gae_duplicate tensor(-0.8692, dtype=torch.float64) tensor(0.8667, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1457, dtype=torch.float64) delta_t tensor(-0.2770, dtype=torch.float64)
11 gae_duplicate tensor(-1.7581, dtype=torch.float64) tensor(5.0500, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4605, dtype=torch.float64) delta_t tensor(0.3632, dtype=torch.float64)
10 gae_duplicate tensor(-0.4889, dtype=torch.float64) tensor(-7.3685, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5736, dtype=torch.float64) delta_t tensor(-0.2325, dtype=torch.float64)
9 gae_duplicate tensor(-3.5569, dtype=torch.float64) tensor(5.1521, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6853, dtype=torch.float64) delta_t tensor(-0.8531, dtype=torch.float64)
8 gae_duplicate tensor(-4.4755, dtype=torch.float64) tensor(15.1391, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1162, dtype=torch.float64) delta_t tensor(-0.0732, dtype=torch.float64)
7 gae_duplicate tensor(-1.1375, dtype=torch.float64) tensor(3.4123, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2721, dtype=torch.float64) delta_t tensor(0.7531, dtype=torch.float64)
6 gae_duplicate tensor(-0.0388, dtype=torch.float64) tensor(-14.5283, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2718, dtype=torch.float64) delta_t tensor(0.2224, dtype=torch.float64)
5 gae_duplicate tensor(0.0640, dtype=torch.float64) tensor(-5.8791, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0901, dtype=torch.float64) delta_t tensor(0.0182, dtype=torch.float64)
4 gae_duplicate tensor(-0.3072, dtype=torch.float64) tensor(-0.7026, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3979, dtype=torch.float64) delta_t tensor(0.2501, dtype=torch.float64)
3 gae_duplicate tensor(-0.1919, dtype=torch.float64) tensor(-4.3820, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5095, dtype=torch.float64) delta_t tensor(-0.2371, dtype=torch.float64)
2 gae_duplicate tensor(-0.4227, dtype=torch.float64) tensor(3.7093, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:184.9235382080078
value loss:99.73666381835938
entropies:338.4914245605469
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3847.4282)
ToM Target loss= tensor(3607.6509)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.072304010391235 seconds
19 rew tensor(0.8377, dtype=torch.float64) delta_t tensor(0.0559, dtype=torch.float64)
19 gae_duplicate tensor(-0.1369, dtype=torch.float64) tensor(-1.0805, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7673, dtype=torch.float64) delta_t tensor(0.0798, dtype=torch.float64)
18 gae_duplicate tensor(-0.1155, dtype=torch.float64) tensor(-1.5318, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7479, dtype=torch.float64) delta_t tensor(0.0717, dtype=torch.float64)
17 gae_duplicate tensor(-0.0034, dtype=torch.float64) tensor(-1.6609, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7025, dtype=torch.float64) delta_t tensor(0.0303, dtype=torch.float64)
16 gae_duplicate tensor(-0.1284, dtype=torch.float64) tensor(-0.7061, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6026, dtype=torch.float64) delta_t tensor(-0.0359, dtype=torch.float64)
15 gae_duplicate tensor(-0.1182, dtype=torch.float64) tensor(0.5818, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3338, dtype=torch.float64) delta_t tensor(-0.2463, dtype=torch.float64)
14 gae_duplicate tensor(-1.2028, dtype=torch.float64) tensor(6.0502, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3639, dtype=torch.float64) delta_t tensor(-0.0961, dtype=torch.float64)
13 gae_duplicate tensor(-1.0946, dtype=torch.float64) tensor(2.3963, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5479, dtype=torch.float64) delta_t tensor(0.2321, dtype=torch.float64)
12 gae_duplicate tensor(0.0217, dtype=torch.float64) tensor(-3.8691, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3340, dtype=torch.float64) delta_t tensor(-0.6207, dtype=torch.float64)
11 gae_duplicate tensor(-1.2896, dtype=torch.float64) tensor(10.9562, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3851, dtype=torch.float64) delta_t tensor(0.6063, dtype=torch.float64)
10 gae_duplicate tensor(0.1239, dtype=torch.float64) tensor(-8.5425, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.0898, dtype=torch.float64) delta_t tensor(-1.5725, dtype=torch.float64)
9 gae_duplicate tensor(-3.9990, dtype=torch.float64) tensor(25.1352, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4427, dtype=torch.float64) delta_t tensor(-0.0796, dtype=torch.float64)
8 gae_duplicate tensor(-1.6043, dtype=torch.float64) tensor(5.0572, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8393, dtype=torch.float64) delta_t tensor(-0.5351, dtype=torch.float64)
7 gae_duplicate tensor(-2.2786, dtype=torch.float64) tensor(10.5574, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1893, dtype=torch.float64) delta_t tensor(0.6468, dtype=torch.float64)
6 gae_duplicate tensor(-0.0633, dtype=torch.float64) tensor(-11.3172, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1232, dtype=torch.float64) delta_t tensor(0.3536, dtype=torch.float64)
5 gae_duplicate tensor(0.0726, dtype=torch.float64) tensor(-8.1536, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2236, dtype=torch.float64) delta_t tensor(0.2046, dtype=torch.float64)
4 gae_duplicate tensor(-0.3913, dtype=torch.float64) tensor(-4.4718, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0584, dtype=torch.float64) delta_t tensor(0.1571, dtype=torch.float64)
3 gae_duplicate tensor(-0.1456, dtype=torch.float64) tensor(-3.4128, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1417, dtype=torch.float64) delta_t tensor(-0.0371, dtype=torch.float64)
2 gae_duplicate tensor(-0.3348, dtype=torch.float64) tensor(0.1536, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-963.2135620117188
value loss:106.89461517333984
entropies:339.1402587890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.96533989906311 seconds
19 rew tensor(0.8929, dtype=torch.float64) delta_t tensor(0.1406, dtype=torch.float64)
19 gae_duplicate tensor(0.0407, dtype=torch.float64) tensor(-2.7398, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8556, dtype=torch.float64) delta_t tensor(0.1764, dtype=torch.float64)
18 gae_duplicate tensor(-0.0739, dtype=torch.float64) tensor(-3.7875, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8369, dtype=torch.float64) delta_t tensor(0.1440, dtype=torch.float64)
17 gae_duplicate tensor(0.0620, dtype=torch.float64) tensor(-2.9750, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7997, dtype=torch.float64) delta_t tensor(0.1482, dtype=torch.float64)
16 gae_duplicate tensor(0.0219, dtype=torch.float64) tensor(-2.9028, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7433, dtype=torch.float64) delta_t tensor(0.2195, dtype=torch.float64)
15 gae_duplicate tensor(-0.1070, dtype=torch.float64) tensor(-5.1118, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6865, dtype=torch.float64) delta_t tensor(0.1286, dtype=torch.float64)
14 gae_duplicate tensor(-0.0381, dtype=torch.float64) tensor(-3.3380, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4792, dtype=torch.float64) delta_t tensor(-0.0525, dtype=torch.float64)
13 gae_duplicate tensor(-1.1765, dtype=torch.float64) tensor(1.5918, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6591, dtype=torch.float64) delta_t tensor(0.0819, dtype=torch.float64)
12 gae_duplicate tensor(-0.1855, dtype=torch.float64) tensor(-1.6644, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1928, dtype=torch.float64) delta_t tensor(-0.4974, dtype=torch.float64)
11 gae_duplicate tensor(-2.0751, dtype=torch.float64) tensor(9.1059, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3574, dtype=torch.float64) delta_t tensor(0.0207, dtype=torch.float64)
10 gae_duplicate tensor(-1.0567, dtype=torch.float64) tensor(0.5969, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.5028, dtype=torch.float64) delta_t tensor(-1.5284, dtype=torch.float64)
9 gae_duplicate tensor(-3.4888, dtype=torch.float64) tensor(29.0359, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.0235, dtype=torch.float64) delta_t tensor(-1.6020, dtype=torch.float64)
8 gae_duplicate tensor(-3.0754, dtype=torch.float64) tensor(33.6615, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5966, dtype=torch.float64) delta_t tensor(0.0887, dtype=torch.float64)
7 gae_duplicate tensor(-1.5096, dtype=torch.float64) tensor(1.1754, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1796, dtype=torch.float64) delta_t tensor(0.5176, dtype=torch.float64)
6 gae_duplicate tensor(-0.4334, dtype=torch.float64) tensor(-8.9856, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2450, dtype=torch.float64) delta_t tensor(0.1754, dtype=torch.float64)
5 gae_duplicate tensor(-1.0766, dtype=torch.float64) tensor(-4.8439, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2571, dtype=torch.float64) delta_t tensor(0.1243, dtype=torch.float64)
4 gae_duplicate tensor(-0.6295, dtype=torch.float64) tensor(-2.1703, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0835, dtype=torch.float64) delta_t tensor(0.0752, dtype=torch.float64)
3 gae_duplicate tensor(-0.1820, dtype=torch.float64) tensor(-1.0729, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2361, dtype=torch.float64) delta_t tensor(-0.0583, dtype=torch.float64)
2 gae_duplicate tensor(-0.1337, dtype=torch.float64) tensor(0.9504, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2063.872802734375
value loss:136.871826171875
entropies:338.8534240722656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.555521011352539 seconds
19 rew tensor(0.8621, dtype=torch.float64) delta_t tensor(0.0900, dtype=torch.float64)
19 gae_duplicate tensor(0.0437, dtype=torch.float64) tensor(-1.7647, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8252, dtype=torch.float64) delta_t tensor(0.2241, dtype=torch.float64)
18 gae_duplicate tensor(0.0425, dtype=torch.float64) tensor(-4.4663, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8052, dtype=torch.float64) delta_t tensor(0.1260, dtype=torch.float64)
17 gae_duplicate tensor(0.0624, dtype=torch.float64) tensor(-2.6783, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7391, dtype=torch.float64) delta_t tensor(0.1180, dtype=torch.float64)
16 gae_duplicate tensor(0.0466, dtype=torch.float64) tensor(-2.7290, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6972, dtype=torch.float64) delta_t tensor(0.1257, dtype=torch.float64)
15 gae_duplicate tensor(-0.0228, dtype=torch.float64) tensor(-2.4527, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3928, dtype=torch.float64) delta_t tensor(-0.1334, dtype=torch.float64)
14 gae_duplicate tensor(-1.1812, dtype=torch.float64) tensor(2.5366, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5082, dtype=torch.float64) delta_t tensor(-0.0172, dtype=torch.float64)
13 gae_duplicate tensor(-1.0910, dtype=torch.float64) tensor(0.5264, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5555, dtype=torch.float64) delta_t tensor(0.1687, dtype=torch.float64)
12 gae_duplicate tensor(-0.0786, dtype=torch.float64) tensor(-2.7567, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1621, dtype=torch.float64) delta_t tensor(-0.3564, dtype=torch.float64)
11 gae_duplicate tensor(-0.9996, dtype=torch.float64) tensor(6.0965, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2904, dtype=torch.float64) delta_t tensor(0.3529, dtype=torch.float64)
10 gae_duplicate tensor(-0.3446, dtype=torch.float64) tensor(-5.4982, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2617, dtype=torch.float64) delta_t tensor(-0.4587, dtype=torch.float64)
9 gae_duplicate tensor(-3.0906, dtype=torch.float64) tensor(7.2801, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6507, dtype=torch.float64) delta_t tensor(-0.0717, dtype=torch.float64)
8 gae_duplicate tensor(-1.3439, dtype=torch.float64) tensor(2.6436, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5111, dtype=torch.float64) delta_t tensor(-0.0953, dtype=torch.float64)
7 gae_duplicate tensor(-2.0640, dtype=torch.float64) tensor(2.7587, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3515, dtype=torch.float64) delta_t tensor(0.3216, dtype=torch.float64)
6 gae_duplicate tensor(-2.3097, dtype=torch.float64) tensor(-5.9952, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0347, dtype=torch.float64) delta_t tensor(0.2500, dtype=torch.float64)
5 gae_duplicate tensor(-0.2853, dtype=torch.float64) tensor(-4.6593, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1272, dtype=torch.float64) delta_t tensor(0.1464, dtype=torch.float64)
4 gae_duplicate tensor(-0.3274, dtype=torch.float64) tensor(-3.8101, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0487, dtype=torch.float64) delta_t tensor(0.1531, dtype=torch.float64)
3 gae_duplicate tensor(-0.2982, dtype=torch.float64) tensor(-3.0393, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2519, dtype=torch.float64) delta_t tensor(-0.0077, dtype=torch.float64)
2 gae_duplicate tensor(-0.2767, dtype=torch.float64) tensor(0.0978, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:875.6336669921875
value loss:75.24344635009766
entropies:338.9191589355469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.986738204956055 seconds
19 rew tensor(0.8812, dtype=torch.float64) delta_t tensor(0.1977, dtype=torch.float64)
19 gae_duplicate tensor(0.0725, dtype=torch.float64) tensor(-3.1824, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6330, dtype=torch.float64) delta_t tensor(0.0573, dtype=torch.float64)
18 gae_duplicate tensor(-0.9786, dtype=torch.float64) tensor(-2.2292, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6138, dtype=torch.float64) delta_t tensor(-0.0002, dtype=torch.float64)
17 gae_duplicate tensor(-1.0760, dtype=torch.float64) tensor(-0.3125, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5465, dtype=torch.float64) delta_t tensor(-0.0264, dtype=torch.float64)
16 gae_duplicate tensor(-1.0566, dtype=torch.float64) tensor(-0.0346, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4506, dtype=torch.float64) delta_t tensor(-0.0661, dtype=torch.float64)
15 gae_duplicate tensor(-1.1113, dtype=torch.float64) tensor(2.1717, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6732, dtype=torch.float64) delta_t tensor(0.3372, dtype=torch.float64)
14 gae_duplicate tensor(0.0279, dtype=torch.float64) tensor(-6.6167, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5292, dtype=torch.float64) delta_t tensor(0.2186, dtype=torch.float64)
13 gae_duplicate tensor(-0.0033, dtype=torch.float64) tensor(-4.6677, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3909, dtype=torch.float64) delta_t tensor(0.3005, dtype=torch.float64)
12 gae_duplicate tensor(-0.1377, dtype=torch.float64) tensor(-5.6125, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0830, dtype=torch.float64) delta_t tensor(-0.0986, dtype=torch.float64)
11 gae_duplicate tensor(-1.5806, dtype=torch.float64) tensor(1.2433, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0424, dtype=torch.float64) delta_t tensor(0.2727, dtype=torch.float64)
10 gae_duplicate tensor(-0.6804, dtype=torch.float64) tensor(-4.2348, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.3232, dtype=torch.float64) delta_t tensor(-1.4314, dtype=torch.float64)
9 gae_duplicate tensor(-5.1574, dtype=torch.float64) tensor(29.3499, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3678, dtype=torch.float64) delta_t tensor(-0.0049, dtype=torch.float64)
8 gae_duplicate tensor(-3.0947, dtype=torch.float64) tensor(1.1049, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0335, dtype=torch.float64) delta_t tensor(-0.2891, dtype=torch.float64)
7 gae_duplicate tensor(-2.2244, dtype=torch.float64) tensor(3.5915, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1064, dtype=torch.float64) delta_t tensor(0.3177, dtype=torch.float64)
6 gae_duplicate tensor(-0.6859, dtype=torch.float64) tensor(-7.2583, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1832, dtype=torch.float64) delta_t tensor(0.4442, dtype=torch.float64)
5 gae_duplicate tensor(0.1483, dtype=torch.float64) tensor(-8.3650, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2539, dtype=torch.float64) delta_t tensor(0.3408, dtype=torch.float64)
4 gae_duplicate tensor(-0.0819, dtype=torch.float64) tensor(-7.5092, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0103, dtype=torch.float64) delta_t tensor(0.1044, dtype=torch.float64)
3 gae_duplicate tensor(-0.2838, dtype=torch.float64) tensor(-2.2402, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2356, dtype=torch.float64) delta_t tensor(-0.0424, dtype=torch.float64)
2 gae_duplicate tensor(-0.4079, dtype=torch.float64) tensor(0.9115, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:658.7220458984375
value loss:115.08838653564453
entropies:338.37078857421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.679720878601074 seconds
19 rew tensor(0.8427, dtype=torch.float64) delta_t tensor(0.1583, dtype=torch.float64)
19 gae_duplicate tensor(0.1223, dtype=torch.float64) tensor(-3.0600, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8243, dtype=torch.float64) delta_t tensor(0.2065, dtype=torch.float64)
18 gae_duplicate tensor(0.1532, dtype=torch.float64) tensor(-3.8835, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6057, dtype=torch.float64) delta_t tensor(-0.0098, dtype=torch.float64)
17 gae_duplicate tensor(-1.0030, dtype=torch.float64) tensor(-1.0490, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7676, dtype=torch.float64) delta_t tensor(0.2145, dtype=torch.float64)
16 gae_duplicate tensor(0.0104, dtype=torch.float64) tensor(-4.0549, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7005, dtype=torch.float64) delta_t tensor(0.1225, dtype=torch.float64)
15 gae_duplicate tensor(-0.0261, dtype=torch.float64) tensor(-2.7553, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6244, dtype=torch.float64) delta_t tensor(0.1919, dtype=torch.float64)
14 gae_duplicate tensor(0.0908, dtype=torch.float64) tensor(-3.6664, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7096, dtype=torch.float64) delta_t tensor(0.3289, dtype=torch.float64)
13 gae_duplicate tensor(0.0229, dtype=torch.float64) tensor(-7.4871, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4336, dtype=torch.float64) delta_t tensor(0.2626, dtype=torch.float64)
12 gae_duplicate tensor(0.0377, dtype=torch.float64) tensor(-6.2585, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3506, dtype=torch.float64) delta_t tensor(-0.4476, dtype=torch.float64)
11 gae_duplicate tensor(-2.1583, dtype=torch.float64) tensor(5.5922, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0143, dtype=torch.float64) delta_t tensor(0.4946, dtype=torch.float64)
10 gae_duplicate tensor(-0.4476, dtype=torch.float64) tensor(-8.1832, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0483, dtype=torch.float64) delta_t tensor(-0.3967, dtype=torch.float64)
9 gae_duplicate tensor(-4.4274, dtype=torch.float64) tensor(8.4476, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3243, dtype=torch.float64) delta_t tensor(-0.4052, dtype=torch.float64)
8 gae_duplicate tensor(-1.9343, dtype=torch.float64) tensor(9.4966, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4341, dtype=torch.float64) delta_t tensor(-0.1803, dtype=torch.float64)
7 gae_duplicate tensor(-1.6294, dtype=torch.float64) tensor(3.8139, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3369, dtype=torch.float64) delta_t tensor(0.4980, dtype=torch.float64)
6 gae_duplicate tensor(-2.1348, dtype=torch.float64) tensor(-10.7535, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2752, dtype=torch.float64) delta_t tensor(0.0225, dtype=torch.float64)
5 gae_duplicate tensor(-2.0738, dtype=torch.float64) tensor(-1.4805, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1551, dtype=torch.float64) delta_t tensor(0.1897, dtype=torch.float64)
4 gae_duplicate tensor(-0.3711, dtype=torch.float64) tensor(-3.6342, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1201, dtype=torch.float64) delta_t tensor(0.1982, dtype=torch.float64)
3 gae_duplicate tensor(-0.1622, dtype=torch.float64) tensor(-3.5087, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2598, dtype=torch.float64) delta_t tensor(-0.0415, dtype=torch.float64)
2 gae_duplicate tensor(-0.2151, dtype=torch.float64) tensor(0.3738, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1639.443603515625
value loss:105.45298767089844
entropies:338.1038818359375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3841.9453)
ToM Target loss= tensor(3604.8411)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.672959089279175 seconds
19 rew tensor(0.8428, dtype=torch.float64) delta_t tensor(0.1260, dtype=torch.float64)
19 gae_duplicate tensor(0.0196, dtype=torch.float64) tensor(-2.1686, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7865, dtype=torch.float64) delta_t tensor(0.1881, dtype=torch.float64)
18 gae_duplicate tensor(0.0487, dtype=torch.float64) tensor(-3.7236, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8063, dtype=torch.float64) delta_t tensor(0.1502, dtype=torch.float64)
17 gae_duplicate tensor(0.0500, dtype=torch.float64) tensor(-2.9962, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5263, dtype=torch.float64) delta_t tensor(-0.0430, dtype=torch.float64)
16 gae_duplicate tensor(-1.1000, dtype=torch.float64) tensor(1.1010, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5013, dtype=torch.float64) delta_t tensor(-0.0466, dtype=torch.float64)
15 gae_duplicate tensor(-1.1106, dtype=torch.float64) tensor(0.8057, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6211, dtype=torch.float64) delta_t tensor(0.1090, dtype=torch.float64)
14 gae_duplicate tensor(-0.1758, dtype=torch.float64) tensor(-1.6556, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5742, dtype=torch.float64) delta_t tensor(0.1005, dtype=torch.float64)
13 gae_duplicate tensor(-0.0126, dtype=torch.float64) tensor(-1.9495, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1553, dtype=torch.float64) delta_t tensor(-0.1685, dtype=torch.float64)
12 gae_duplicate tensor(-1.1364, dtype=torch.float64) tensor(3.0081, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2460, dtype=torch.float64) delta_t tensor(-0.3742, dtype=torch.float64)
11 gae_duplicate tensor(-1.0988, dtype=torch.float64) tensor(10.4036, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6011, dtype=torch.float64) delta_t tensor(-0.2431, dtype=torch.float64)
10 gae_duplicate tensor(-2.0456, dtype=torch.float64) tensor(6.4980, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3716, dtype=torch.float64) delta_t tensor(0.3312, dtype=torch.float64)
9 gae_duplicate tensor(-3.2311, dtype=torch.float64) tensor(-5.4223, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1847, dtype=torch.float64) delta_t tensor(0.6109, dtype=torch.float64)
8 gae_duplicate tensor(-0.3216, dtype=torch.float64) tensor(-13.8361, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1586, dtype=torch.float64) delta_t tensor(0.5411, dtype=torch.float64)
7 gae_duplicate tensor(-1.2372, dtype=torch.float64) tensor(-11.9108, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1030, dtype=torch.float64) delta_t tensor(0.4520, dtype=torch.float64)
6 gae_duplicate tensor(-1.9728, dtype=torch.float64) tensor(-10.0041, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0529, dtype=torch.float64) delta_t tensor(0.2959, dtype=torch.float64)
5 gae_duplicate tensor(-0.0111, dtype=torch.float64) tensor(-6.4733, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1838, dtype=torch.float64) delta_t tensor(0.3243, dtype=torch.float64)
4 gae_duplicate tensor(-0.2105, dtype=torch.float64) tensor(-6.6589, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1236, dtype=torch.float64) delta_t tensor(0.2302, dtype=torch.float64)
3 gae_duplicate tensor(-0.0890, dtype=torch.float64) tensor(-5.6018, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3747, dtype=torch.float64) delta_t tensor(0.0007, dtype=torch.float64)
2 gae_duplicate tensor(-0.3755, dtype=torch.float64) tensor(-0.1335, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2647.4423828125
value loss:87.41120147705078
entropies:338.1928405761719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.78843092918396 seconds
19 rew tensor(0.8507, dtype=torch.float64) delta_t tensor(0.1245, dtype=torch.float64)
19 gae_duplicate tensor(0.0595, dtype=torch.float64) tensor(-2.5076, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8240, dtype=torch.float64) delta_t tensor(0.2126, dtype=torch.float64)
18 gae_duplicate tensor(0.1299, dtype=torch.float64) tensor(-4.0828, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8235, dtype=torch.float64) delta_t tensor(0.1375, dtype=torch.float64)
17 gae_duplicate tensor(0.0502, dtype=torch.float64) tensor(-3.1308, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6433, dtype=torch.float64) delta_t tensor(0.0990, dtype=torch.float64)
16 gae_duplicate tensor(-0.0570, dtype=torch.float64) tensor(-2.3209, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6800, dtype=torch.float64) delta_t tensor(0.0941, dtype=torch.float64)
15 gae_duplicate tensor(-0.0576, dtype=torch.float64) tensor(-1.8936, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3662, dtype=torch.float64) delta_t tensor(-0.0578, dtype=torch.float64)
14 gae_duplicate tensor(-1.0581, dtype=torch.float64) tensor(1.3581, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6803, dtype=torch.float64) delta_t tensor(0.2840, dtype=torch.float64)
13 gae_duplicate tensor(-0.1816, dtype=torch.float64) tensor(-5.7426, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4603, dtype=torch.float64) delta_t tensor(0.3032, dtype=torch.float64)
12 gae_duplicate tensor(0.0813, dtype=torch.float64) tensor(-5.9564, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4496, dtype=torch.float64) delta_t tensor(-0.5140, dtype=torch.float64)
11 gae_duplicate tensor(-1.4715, dtype=torch.float64) tensor(10.0503, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0750, dtype=torch.float64) delta_t tensor(0.5482, dtype=torch.float64)
10 gae_duplicate tensor(-0.1545, dtype=torch.float64) tensor(-9.7297, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7207, dtype=torch.float64) delta_t tensor(-0.0210, dtype=torch.float64)
9 gae_duplicate tensor(-3.3831, dtype=torch.float64) tensor(0.4126, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6290, dtype=torch.float64) delta_t tensor(0.0207, dtype=torch.float64)
8 gae_duplicate tensor(-1.1161, dtype=torch.float64) tensor(-0.8989, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2527, dtype=torch.float64) delta_t tensor(-0.0069, dtype=torch.float64)
7 gae_duplicate tensor(-1.1020, dtype=torch.float64) tensor(-0.3245, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2288, dtype=torch.float64) delta_t tensor(0.6323, dtype=torch.float64)
6 gae_duplicate tensor(-0.9835, dtype=torch.float64) tensor(-12.0053, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0738, dtype=torch.float64) delta_t tensor(0.0988, dtype=torch.float64)
5 gae_duplicate tensor(-1.0512, dtype=torch.float64) tensor(-2.7564, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0307, dtype=torch.float64) delta_t tensor(0.1864, dtype=torch.float64)
4 gae_duplicate tensor(-0.3861, dtype=torch.float64) tensor(-3.1612, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2301, dtype=torch.float64) delta_t tensor(0.2438, dtype=torch.float64)
3 gae_duplicate tensor(-0.0712, dtype=torch.float64) tensor(-4.0917, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3441, dtype=torch.float64) delta_t tensor(-0.0961, dtype=torch.float64)
2 gae_duplicate tensor(-0.2065, dtype=torch.float64) tensor(1.5403, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2351.66015625
value loss:68.57752990722656
entropies:338.36981201171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.720862865447998 seconds
19 rew tensor(0.8231, dtype=torch.float64) delta_t tensor(0.0463, dtype=torch.float64)
19 gae_duplicate tensor(-0.0390, dtype=torch.float64) tensor(-0.7321, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7656, dtype=torch.float64) delta_t tensor(0.0820, dtype=torch.float64)
18 gae_duplicate tensor(-0.2001, dtype=torch.float64) tensor(-1.0133, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7300, dtype=torch.float64) delta_t tensor(0.0849, dtype=torch.float64)
17 gae_duplicate tensor(-0.0010, dtype=torch.float64) tensor(-1.7358, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7735, dtype=torch.float64) delta_t tensor(0.0729, dtype=torch.float64)
16 gae_duplicate tensor(-0.0079, dtype=torch.float64) tensor(-1.7704, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5277, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
15 gae_duplicate tensor(-0.1373, dtype=torch.float64) tensor(0.2079, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3754, dtype=torch.float64) delta_t tensor(-0.1190, dtype=torch.float64)
14 gae_duplicate tensor(-0.5353, dtype=torch.float64) tensor(1.9369, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5191, dtype=torch.float64) delta_t tensor(0.1663, dtype=torch.float64)
13 gae_duplicate tensor(-0.0698, dtype=torch.float64) tensor(-2.4433, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5990, dtype=torch.float64) delta_t tensor(0.1769, dtype=torch.float64)
12 gae_duplicate tensor(-0.1429, dtype=torch.float64) tensor(-4.2199, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8243, dtype=torch.float64) delta_t tensor(-0.6701, dtype=torch.float64)
11 gae_duplicate tensor(-1.7713, dtype=torch.float64) tensor(11.5989, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2402, dtype=torch.float64) delta_t tensor(0.4519, dtype=torch.float64)
10 gae_duplicate tensor(-0.5058, dtype=torch.float64) tensor(-6.8640, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.0644, dtype=torch.float64) delta_t tensor(-1.1581, dtype=torch.float64)
9 gae_duplicate tensor(-3.3333, dtype=torch.float64) tensor(21.2716, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6073, dtype=torch.float64) delta_t tensor(0.1010, dtype=torch.float64)
8 gae_duplicate tensor(-2.1830, dtype=torch.float64) tensor(-0.2048, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4668, dtype=torch.float64) delta_t tensor(0.1763, dtype=torch.float64)
7 gae_duplicate tensor(-0.9749, dtype=torch.float64) tensor(-4.3573, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2667, dtype=torch.float64) delta_t tensor(0.6943, dtype=torch.float64)
6 gae_duplicate tensor(0.3328, dtype=torch.float64) tensor(-11.9572, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1826, dtype=torch.float64) delta_t tensor(0.2819, dtype=torch.float64)
5 gae_duplicate tensor(0.0621, dtype=torch.float64) tensor(-7.0029, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2499, dtype=torch.float64) delta_t tensor(0.1790, dtype=torch.float64)
4 gae_duplicate tensor(-0.3634, dtype=torch.float64) tensor(-3.7553, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0224, dtype=torch.float64) delta_t tensor(0.1225, dtype=torch.float64)
3 gae_duplicate tensor(-0.3071, dtype=torch.float64) tensor(-2.7467, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2237, dtype=torch.float64) delta_t tensor(-0.0535, dtype=torch.float64)
2 gae_duplicate tensor(-0.2843, dtype=torch.float64) tensor(0.9978, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:599.4144287109375
value loss:79.93316650390625
entropies:337.89544677734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.63833212852478 seconds
19 rew tensor(0.8899, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
19 gae_duplicate tensor(-0.1198, dtype=torch.float64) tensor(0.0158, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8435, dtype=torch.float64) delta_t tensor(0.1573, dtype=torch.float64)
18 gae_duplicate tensor(-0.1481, dtype=torch.float64) tensor(-2.8455, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7860, dtype=torch.float64) delta_t tensor(-0.0335, dtype=torch.float64)
17 gae_duplicate tensor(-0.1404, dtype=torch.float64) tensor(0.2839, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5892, dtype=torch.float64) delta_t tensor(-0.0268, dtype=torch.float64)
16 gae_duplicate tensor(-0.1239, dtype=torch.float64) tensor(0.6588, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6820, dtype=torch.float64) delta_t tensor(-0.0999, dtype=torch.float64)
15 gae_duplicate tensor(-0.1635, dtype=torch.float64) tensor(2.1337, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2859, dtype=torch.float64) delta_t tensor(-0.2722, dtype=torch.float64)
14 gae_duplicate tensor(-1.2083, dtype=torch.float64) tensor(5.0331, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4950, dtype=torch.float64) delta_t tensor(-0.2020, dtype=torch.float64)
13 gae_duplicate tensor(-1.1826, dtype=torch.float64) tensor(4.4155, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3783, dtype=torch.float64) delta_t tensor(-0.0166, dtype=torch.float64)
12 gae_duplicate tensor(-0.3036, dtype=torch.float64) tensor(0.9340, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5924, dtype=torch.float64) delta_t tensor(0.3010, dtype=torch.float64)
11 gae_duplicate tensor(0.0282, dtype=torch.float64) tensor(-5.7376, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5666, dtype=torch.float64) delta_t tensor(-0.5595, dtype=torch.float64)
10 gae_duplicate tensor(-2.4687, dtype=torch.float64) tensor(10.0039, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2913, dtype=torch.float64) delta_t tensor(0.3023, dtype=torch.float64)
9 gae_duplicate tensor(-1.7549, dtype=torch.float64) tensor(-4.1501, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8480, dtype=torch.float64) delta_t tensor(-0.0575, dtype=torch.float64)
8 gae_duplicate tensor(-2.1070, dtype=torch.float64) tensor(2.5931, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0334, dtype=torch.float64) delta_t tensor(0.1278, dtype=torch.float64)
7 gae_duplicate tensor(-1.5083, dtype=torch.float64) tensor(-3.1593, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5254, dtype=torch.float64) delta_t tensor(0.3689, dtype=torch.float64)
6 gae_duplicate tensor(-2.3075, dtype=torch.float64) tensor(-8.2913, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0076, dtype=torch.float64) delta_t tensor(-0.0050, dtype=torch.float64)
5 gae_duplicate tensor(-1.1424, dtype=torch.float64) tensor(0.2989, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0991, dtype=torch.float64) delta_t tensor(0.0215, dtype=torch.float64)
4 gae_duplicate tensor(-0.4347, dtype=torch.float64) tensor(-0.3003, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3320, dtype=torch.float64) delta_t tensor(0.1532, dtype=torch.float64)
3 gae_duplicate tensor(-0.4810, dtype=torch.float64) tensor(-2.4282, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4389, dtype=torch.float64) delta_t tensor(-0.1733, dtype=torch.float64)
2 gae_duplicate tensor(-0.3277, dtype=torch.float64) tensor(2.3513, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-188.68812561035156
value loss:75.8069076538086
entropies:336.9337158203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.781750917434692 seconds
19 rew tensor(0.8491, dtype=torch.float64) delta_t tensor(-0.1647, dtype=torch.float64)
19 gae_duplicate tensor(-0.2387, dtype=torch.float64) tensor(2.6536, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8402, dtype=torch.float64) delta_t tensor(0.0497, dtype=torch.float64)
18 gae_duplicate tensor(-0.1546, dtype=torch.float64) tensor(-0.5148, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8202, dtype=torch.float64) delta_t tensor(-0.0227, dtype=torch.float64)
17 gae_duplicate tensor(-0.1983, dtype=torch.float64) tensor(0.3321, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7138, dtype=torch.float64) delta_t tensor(-0.0522, dtype=torch.float64)
16 gae_duplicate tensor(-0.1892, dtype=torch.float64) tensor(1.0274, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8322, dtype=torch.float64) delta_t tensor(0.0645, dtype=torch.float64)
15 gae_duplicate tensor(-0.1232, dtype=torch.float64) tensor(-1.1131, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5884, dtype=torch.float64) delta_t tensor(-0.0812, dtype=torch.float64)
14 gae_duplicate tensor(-0.2521, dtype=torch.float64) tensor(1.1402, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6129, dtype=torch.float64) delta_t tensor(-0.0351, dtype=torch.float64)
13 gae_duplicate tensor(-0.1893, dtype=torch.float64) tensor(0.6821, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2331, dtype=torch.float64) delta_t tensor(-0.1003, dtype=torch.float64)
12 gae_duplicate tensor(-1.3217, dtype=torch.float64) tensor(1.9820, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3006, dtype=torch.float64) delta_t tensor(0.2758, dtype=torch.float64)
11 gae_duplicate tensor(-0.5640, dtype=torch.float64) tensor(-5.0839, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3543, dtype=torch.float64) delta_t tensor(-0.2559, dtype=torch.float64)
10 gae_duplicate tensor(-1.4112, dtype=torch.float64) tensor(3.7217, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.0530, dtype=torch.float64) delta_t tensor(-1.1216, dtype=torch.float64)
9 gae_duplicate tensor(-5.3356, dtype=torch.float64) tensor(20.1191, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2346, dtype=torch.float64) delta_t tensor(-0.6332, dtype=torch.float64)
8 gae_duplicate tensor(-3.3692, dtype=torch.float64) tensor(13.0031, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3619, dtype=torch.float64) delta_t tensor(0.0258, dtype=torch.float64)
7 gae_duplicate tensor(-0.2669, dtype=torch.float64) tensor(0.5421, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2535, dtype=torch.float64) delta_t tensor(0.2517, dtype=torch.float64)
6 gae_duplicate tensor(-0.9019, dtype=torch.float64) tensor(-6.0602, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0070, dtype=torch.float64) delta_t tensor(0.4253, dtype=torch.float64)
5 gae_duplicate tensor(0.1544, dtype=torch.float64) tensor(-7.6597, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2393, dtype=torch.float64) delta_t tensor(0.1727, dtype=torch.float64)
4 gae_duplicate tensor(-0.1216, dtype=torch.float64) tensor(-3.5650, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1459, dtype=torch.float64) delta_t tensor(0.0043, dtype=torch.float64)
3 gae_duplicate tensor(-0.2661, dtype=torch.float64) tensor(-0.4081, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3509, dtype=torch.float64) delta_t tensor(-0.1620, dtype=torch.float64)
2 gae_duplicate tensor(-0.3083, dtype=torch.float64) tensor(3.0254, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1377.091064453125
value loss:104.90011596679688
entropies:335.56256103515625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3778.9453)
ToM Target loss= tensor(3603.6807)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.75219988822937 seconds
19 rew tensor(0.8867, dtype=torch.float64) delta_t tensor(-0.1001, dtype=torch.float64)
19 gae_duplicate tensor(-0.1905, dtype=torch.float64) tensor(1.5764, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8679, dtype=torch.float64) delta_t tensor(0.0490, dtype=torch.float64)
18 gae_duplicate tensor(-0.0904, dtype=torch.float64) tensor(-0.3985, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8687, dtype=torch.float64) delta_t tensor(-0.0381, dtype=torch.float64)
17 gae_duplicate tensor(-0.1236, dtype=torch.float64) tensor(0.5824, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7732, dtype=torch.float64) delta_t tensor(0.0105, dtype=torch.float64)
16 gae_duplicate tensor(-0.0889, dtype=torch.float64) tensor(-0.2526, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7809, dtype=torch.float64) delta_t tensor(0.0304, dtype=torch.float64)
15 gae_duplicate tensor(-0.2687, dtype=torch.float64) tensor(-0.3866, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6382, dtype=torch.float64) delta_t tensor(-0.0236, dtype=torch.float64)
14 gae_duplicate tensor(-0.1724, dtype=torch.float64) tensor(0.2937, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6402, dtype=torch.float64) delta_t tensor(0.0393, dtype=torch.float64)
13 gae_duplicate tensor(-0.2850, dtype=torch.float64) tensor(-0.7321, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2806, dtype=torch.float64) delta_t tensor(-0.1181, dtype=torch.float64)
12 gae_duplicate tensor(-0.7465, dtype=torch.float64) tensor(2.3818, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0888, dtype=torch.float64) delta_t tensor(-0.3983, dtype=torch.float64)
11 gae_duplicate tensor(-1.1807, dtype=torch.float64) tensor(7.3786, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6370, dtype=torch.float64) delta_t tensor(-0.5166, dtype=torch.float64)
10 gae_duplicate tensor(-1.8069, dtype=torch.float64) tensor(11.7931, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.9647, dtype=torch.float64) delta_t tensor(-1.1647, dtype=torch.float64)
9 gae_duplicate tensor(-5.6116, dtype=torch.float64) tensor(19.9972, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4496, dtype=torch.float64) delta_t tensor(0.1745, dtype=torch.float64)
8 gae_duplicate tensor(-1.0785, dtype=torch.float64) tensor(-1.6826, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7847, dtype=torch.float64) delta_t tensor(-0.3737, dtype=torch.float64)
7 gae_duplicate tensor(-2.5102, dtype=torch.float64) tensor(5.0346, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1844, dtype=torch.float64) delta_t tensor(0.6015, dtype=torch.float64)
6 gae_duplicate tensor(0.0773, dtype=torch.float64) tensor(-11.7077, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6670, dtype=torch.float64) delta_t tensor(-0.4066, dtype=torch.float64)
5 gae_duplicate tensor(-3.7393, dtype=torch.float64) tensor(9.4015, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0393, dtype=torch.float64) delta_t tensor(-0.0005, dtype=torch.float64)
4 gae_duplicate tensor(-1.1664, dtype=torch.float64) tensor(1.7339, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2239, dtype=torch.float64) delta_t tensor(0.0196, dtype=torch.float64)
3 gae_duplicate tensor(-0.3927, dtype=torch.float64) tensor(0.0881, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3885, dtype=torch.float64) delta_t tensor(-0.2485, dtype=torch.float64)
2 gae_duplicate tensor(-0.5395, dtype=torch.float64) tensor(4.2942, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2757.7685546875
value loss:118.56629943847656
entropies:334.86090087890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.84932804107666 seconds
19 rew tensor(0.8275, dtype=torch.float64) delta_t tensor(-0.1790, dtype=torch.float64)
19 gae_duplicate tensor(-0.3451, dtype=torch.float64) tensor(3.1851, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6302, dtype=torch.float64) delta_t tensor(-0.1557, dtype=torch.float64)
18 gae_duplicate tensor(-1.2840, dtype=torch.float64) tensor(2.4119, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8387, dtype=torch.float64) delta_t tensor(-0.1340, dtype=torch.float64)
17 gae_duplicate tensor(-0.2363, dtype=torch.float64) tensor(2.8658, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6769, dtype=torch.float64) delta_t tensor(-0.0684, dtype=torch.float64)
16 gae_duplicate tensor(-0.2027, dtype=torch.float64) tensor(1.8108, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7728, dtype=torch.float64) delta_t tensor(-0.0387, dtype=torch.float64)
15 gae_duplicate tensor(-0.2047, dtype=torch.float64) tensor(1.0928, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5138, dtype=torch.float64) delta_t tensor(-0.1155, dtype=torch.float64)
14 gae_duplicate tensor(-0.2257, dtype=torch.float64) tensor(2.3231, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7065, dtype=torch.float64) delta_t tensor(0.1042, dtype=torch.float64)
13 gae_duplicate tensor(-0.2223, dtype=torch.float64) tensor(-1.7120, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4269, dtype=torch.float64) delta_t tensor(0.1536, dtype=torch.float64)
12 gae_duplicate tensor(-0.1575, dtype=torch.float64) tensor(-2.9077, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5100, dtype=torch.float64) delta_t tensor(-0.5332, dtype=torch.float64)
11 gae_duplicate tensor(-1.1544, dtype=torch.float64) tensor(9.7156, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1407, dtype=torch.float64) delta_t tensor(0.1740, dtype=torch.float64)
10 gae_duplicate tensor(-0.7017, dtype=torch.float64) tensor(-1.8465, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.0135, dtype=torch.float64) delta_t tensor(-1.1870, dtype=torch.float64)
9 gae_duplicate tensor(-3.0179, dtype=torch.float64) tensor(22.6470, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3444, dtype=torch.float64) delta_t tensor(-0.0119, dtype=torch.float64)
8 gae_duplicate tensor(-1.3494, dtype=torch.float64) tensor(2.0082, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6263, dtype=torch.float64) delta_t tensor(-0.1862, dtype=torch.float64)
7 gae_duplicate tensor(-1.4872, dtype=torch.float64) tensor(3.5436, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3204, dtype=torch.float64) delta_t tensor(0.0229, dtype=torch.float64)
6 gae_duplicate tensor(-2.3583, dtype=torch.float64) tensor(-0.8308, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2636, dtype=torch.float64) delta_t tensor(0.1508, dtype=torch.float64)
5 gae_duplicate tensor(-1.0748, dtype=torch.float64) tensor(-2.5517, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1629, dtype=torch.float64) delta_t tensor(0.0187, dtype=torch.float64)
4 gae_duplicate tensor(-0.3888, dtype=torch.float64) tensor(-1.0998, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0993, dtype=torch.float64) delta_t tensor(0.0683, dtype=torch.float64)
3 gae_duplicate tensor(-0.1828, dtype=torch.float64) tensor(-1.5246, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3040, dtype=torch.float64) delta_t tensor(-0.1683, dtype=torch.float64)
2 gae_duplicate tensor(-0.3265, dtype=torch.float64) tensor(2.2853, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2326.90673828125
value loss:71.53626251220703
entropies:334.9354553222656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.88051700592041 seconds
19 rew tensor(0.8379, dtype=torch.float64) delta_t tensor(-0.0595, dtype=torch.float64)
19 gae_duplicate tensor(-0.2425, dtype=torch.float64) tensor(0.9416, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8181, dtype=torch.float64) delta_t tensor(-0.0779, dtype=torch.float64)
18 gae_duplicate tensor(-0.2249, dtype=torch.float64) tensor(1.4862, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7139, dtype=torch.float64) delta_t tensor(-0.0874, dtype=torch.float64)
17 gae_duplicate tensor(-0.2032, dtype=torch.float64) tensor(1.8090, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5729, dtype=torch.float64) delta_t tensor(-0.2631, dtype=torch.float64)
16 gae_duplicate tensor(-1.2773, dtype=torch.float64) tensor(5.2921, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5508, dtype=torch.float64) delta_t tensor(-0.1364, dtype=torch.float64)
15 gae_duplicate tensor(-0.3645, dtype=torch.float64) tensor(2.8591, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4873, dtype=torch.float64) delta_t tensor(-0.1353, dtype=torch.float64)
14 gae_duplicate tensor(-1.3199, dtype=torch.float64) tensor(2.7668, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4933, dtype=torch.float64) delta_t tensor(-0.1245, dtype=torch.float64)
13 gae_duplicate tensor(-0.3568, dtype=torch.float64) tensor(2.5568, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6367, dtype=torch.float64) delta_t tensor(0.1081, dtype=torch.float64)
12 gae_duplicate tensor(-0.0784, dtype=torch.float64) tensor(-1.3966, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1992, dtype=torch.float64) delta_t tensor(-0.2885, dtype=torch.float64)
11 gae_duplicate tensor(-1.4671, dtype=torch.float64) tensor(3.8764, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0569, dtype=torch.float64) delta_t tensor(0.0431, dtype=torch.float64)
10 gae_duplicate tensor(-0.6580, dtype=torch.float64) tensor(0.0449, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.6137, dtype=torch.float64) delta_t tensor(-1.7062, dtype=torch.float64)
9 gae_duplicate tensor(-4.1033, dtype=torch.float64) tensor(28.4502, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1188, dtype=torch.float64) delta_t tensor(-0.6210, dtype=torch.float64)
8 gae_duplicate tensor(-3.7774, dtype=torch.float64) tensor(10.3910, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5966, dtype=torch.float64) delta_t tensor(0.1439, dtype=torch.float64)
7 gae_duplicate tensor(-1.0591, dtype=torch.float64) tensor(-3.3148, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1518, dtype=torch.float64) delta_t tensor(0.4760, dtype=torch.float64)
6 gae_duplicate tensor(-0.8584, dtype=torch.float64) tensor(-10.5558, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0818, dtype=torch.float64) delta_t tensor(0.3170, dtype=torch.float64)
5 gae_duplicate tensor(0.0445, dtype=torch.float64) tensor(-6.9223, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3610, dtype=torch.float64) delta_t tensor(0.1398, dtype=torch.float64)
4 gae_duplicate tensor(-0.3861, dtype=torch.float64) tensor(-3.2985, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0446, dtype=torch.float64) delta_t tensor(-0.0538, dtype=torch.float64)
3 gae_duplicate tensor(-0.3666, dtype=torch.float64) tensor(0.7225, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2176, dtype=torch.float64) delta_t tensor(-0.1669, dtype=torch.float64)
2 gae_duplicate tensor(-0.4529, dtype=torch.float64) tensor(3.3909, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2201.877685546875
value loss:104.89482879638672
entropies:335.2058410644531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.762970209121704 seconds
19 rew tensor(0.8542, dtype=torch.float64) delta_t tensor(-0.0158, dtype=torch.float64)
19 gae_duplicate tensor(-0.1843, dtype=torch.float64) tensor(0.5819, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7589, dtype=torch.float64) delta_t tensor(-0.0809, dtype=torch.float64)
18 gae_duplicate tensor(-0.3169, dtype=torch.float64) tensor(1.4696, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7780, dtype=torch.float64) delta_t tensor(0.0168, dtype=torch.float64)
17 gae_duplicate tensor(-0.1406, dtype=torch.float64) tensor(-0.1319, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7496, dtype=torch.float64) delta_t tensor(-0.0537, dtype=torch.float64)
16 gae_duplicate tensor(-0.1750, dtype=torch.float64) tensor(1.0033, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5397, dtype=torch.float64) delta_t tensor(-0.1161, dtype=torch.float64)
15 gae_duplicate tensor(-0.2377, dtype=torch.float64) tensor(2.6298, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2412, dtype=torch.float64) delta_t tensor(-0.2652, dtype=torch.float64)
14 gae_duplicate tensor(-1.3356, dtype=torch.float64) tensor(4.8862, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5116, dtype=torch.float64) delta_t tensor(-0.0729, dtype=torch.float64)
13 gae_duplicate tensor(-0.2260, dtype=torch.float64) tensor(1.3974, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4082, dtype=torch.float64) delta_t tensor(-0.1064, dtype=torch.float64)
12 gae_duplicate tensor(-0.7754, dtype=torch.float64) tensor(2.4625, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2031, dtype=torch.float64) delta_t tensor(0.2580, dtype=torch.float64)
11 gae_duplicate tensor(-1.0141, dtype=torch.float64) tensor(-6.6780, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2848, dtype=torch.float64) delta_t tensor(0.2067, dtype=torch.float64)
10 gae_duplicate tensor(-0.5901, dtype=torch.float64) tensor(-4.0450, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7973, dtype=torch.float64) delta_t tensor(-0.9686, dtype=torch.float64)
9 gae_duplicate tensor(-3.5883, dtype=torch.float64) tensor(20.9192, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.2663, dtype=torch.float64) delta_t tensor(-1.8016, dtype=torch.float64)
8 gae_duplicate tensor(-3.4836, dtype=torch.float64) tensor(40.0045, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6395, dtype=torch.float64) delta_t tensor(0.1096, dtype=torch.float64)
7 gae_duplicate tensor(-1.2636, dtype=torch.float64) tensor(-0.3849, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0753, dtype=torch.float64) delta_t tensor(0.1102, dtype=torch.float64)
6 gae_duplicate tensor(-1.8566, dtype=torch.float64) tensor(-1.4331, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0396, dtype=torch.float64) delta_t tensor(0.3823, dtype=torch.float64)
5 gae_duplicate tensor(-0.0047, dtype=torch.float64) tensor(-8.0013, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2646, dtype=torch.float64) delta_t tensor(0.2274, dtype=torch.float64)
4 gae_duplicate tensor(-0.0037, dtype=torch.float64) tensor(-5.1789, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0828, dtype=torch.float64) delta_t tensor(0.0760, dtype=torch.float64)
3 gae_duplicate tensor(-0.0980, dtype=torch.float64) tensor(-1.9832, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2837, dtype=torch.float64) delta_t tensor(-0.1753, dtype=torch.float64)
2 gae_duplicate tensor(-0.4651, dtype=torch.float64) tensor(3.0267, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2820.164306640625
value loss:118.19671630859375
entropies:336.05535888671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0083887577056885 seconds
19 rew tensor(0.8745, dtype=torch.float64) delta_t tensor(0.0232, dtype=torch.float64)
19 gae_duplicate tensor(-0.1076, dtype=torch.float64) tensor(-0.3499, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6301, dtype=torch.float64) delta_t tensor(-0.1049, dtype=torch.float64)
18 gae_duplicate tensor(-1.1772, dtype=torch.float64) tensor(1.5427, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7777, dtype=torch.float64) delta_t tensor(0.0625, dtype=torch.float64)
17 gae_duplicate tensor(-0.1137, dtype=torch.float64) tensor(-1.1656, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4869, dtype=torch.float64) delta_t tensor(-0.2223, dtype=torch.float64)
16 gae_duplicate tensor(-1.2310, dtype=torch.float64) tensor(3.8306, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6375, dtype=torch.float64) delta_t tensor(-0.0544, dtype=torch.float64)
15 gae_duplicate tensor(-0.3139, dtype=torch.float64) tensor(1.5202, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2220, dtype=torch.float64) delta_t tensor(-0.2747, dtype=torch.float64)
14 gae_duplicate tensor(-1.1618, dtype=torch.float64) tensor(3.8793, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5325, dtype=torch.float64) delta_t tensor(-0.0248, dtype=torch.float64)
13 gae_duplicate tensor(-0.2755, dtype=torch.float64) tensor(1.1083, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5850, dtype=torch.float64) delta_t tensor(0.1690, dtype=torch.float64)
12 gae_duplicate tensor(-0.0748, dtype=torch.float64) tensor(-2.9359, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0738, dtype=torch.float64) delta_t tensor(-0.0800, dtype=torch.float64)
11 gae_duplicate tensor(-1.0072, dtype=torch.float64) tensor(2.5318, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4184, dtype=torch.float64) delta_t tensor(-0.0404, dtype=torch.float64)
10 gae_duplicate tensor(-1.5375, dtype=torch.float64) tensor(0.5617, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.9760, dtype=torch.float64) delta_t tensor(-1.1697, dtype=torch.float64)
9 gae_duplicate tensor(-2.9441, dtype=torch.float64) tensor(21.5588, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2263, dtype=torch.float64) delta_t tensor(0.0327, dtype=torch.float64)
8 gae_duplicate tensor(-2.1424, dtype=torch.float64) tensor(-0.8515, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8838, dtype=torch.float64) delta_t tensor(-0.0130, dtype=torch.float64)
7 gae_duplicate tensor(-1.1082, dtype=torch.float64) tensor(0.1871, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2756, dtype=torch.float64) delta_t tensor(0.5560, dtype=torch.float64)
6 gae_duplicate tensor(-0.2896, dtype=torch.float64) tensor(-8.1858, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1826, dtype=torch.float64) delta_t tensor(0.4351, dtype=torch.float64)
5 gae_duplicate tensor(0.1636, dtype=torch.float64) tensor(-7.7730, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3029, dtype=torch.float64) delta_t tensor(0.3067, dtype=torch.float64)
4 gae_duplicate tensor(-0.0588, dtype=torch.float64) tensor(-7.8665, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0599, dtype=torch.float64) delta_t tensor(-0.0346, dtype=torch.float64)
3 gae_duplicate tensor(-0.2452, dtype=torch.float64) tensor(-0.0029, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1857, dtype=torch.float64) delta_t tensor(-0.0957, dtype=torch.float64)
2 gae_duplicate tensor(-0.3134, dtype=torch.float64) tensor(1.4879, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-581.0219116210938
value loss:69.44746398925781
entropies:336.4938049316406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3827.6946)
ToM Target loss= tensor(3607.1011)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.078296899795532 seconds
19 rew tensor(0.7984, dtype=torch.float64) delta_t tensor(-0.1097, dtype=torch.float64)
19 gae_duplicate tensor(-0.1969, dtype=torch.float64) tensor(2.1470, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7698, dtype=torch.float64) delta_t tensor(0.0951, dtype=torch.float64)
18 gae_duplicate tensor(-0.0318, dtype=torch.float64) tensor(-1.6096, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8083, dtype=torch.float64) delta_t tensor(-0.0266, dtype=torch.float64)
17 gae_duplicate tensor(-0.1087, dtype=torch.float64) tensor(0.2074, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6162, dtype=torch.float64) delta_t tensor(-0.0299, dtype=torch.float64)
16 gae_duplicate tensor(-0.1033, dtype=torch.float64) tensor(0.6651, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7605, dtype=torch.float64) delta_t tensor(0.0561, dtype=torch.float64)
15 gae_duplicate tensor(-0.1408, dtype=torch.float64) tensor(-0.8385, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5574, dtype=torch.float64) delta_t tensor(0.0028, dtype=torch.float64)
14 gae_duplicate tensor(-0.1339, dtype=torch.float64) tensor(-0.4979, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6833, dtype=torch.float64) delta_t tensor(0.0763, dtype=torch.float64)
13 gae_duplicate tensor(-0.0730, dtype=torch.float64) tensor(-1.2931, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0532, dtype=torch.float64) delta_t tensor(-0.0298, dtype=torch.float64)
12 gae_duplicate tensor(-0.9795, dtype=torch.float64) tensor(0.7605, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1167, dtype=torch.float64) delta_t tensor(0.2741, dtype=torch.float64)
11 gae_duplicate tensor(-0.3864, dtype=torch.float64) tensor(-5.4513, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0108, dtype=torch.float64) delta_t tensor(0.2624, dtype=torch.float64)
10 gae_duplicate tensor(-0.3512, dtype=torch.float64) tensor(-5.3789, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1663, dtype=torch.float64) delta_t tensor(-0.2725, dtype=torch.float64)
9 gae_duplicate tensor(-3.2321, dtype=torch.float64) tensor(3.8179, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3657, dtype=torch.float64) delta_t tensor(0.3690, dtype=torch.float64)
8 gae_duplicate tensor(-1.0184, dtype=torch.float64) tensor(-7.8390, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0014, dtype=torch.float64) delta_t tensor(0.0666, dtype=torch.float64)
7 gae_duplicate tensor(-0.9742, dtype=torch.float64) tensor(-0.7741, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8329, dtype=torch.float64) delta_t tensor(-0.2121, dtype=torch.float64)
6 gae_duplicate tensor(-2.2174, dtype=torch.float64) tensor(3.3238, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3280, dtype=torch.float64) delta_t tensor(-0.1519, dtype=torch.float64)
5 gae_duplicate tensor(-2.4387, dtype=torch.float64) tensor(3.0124, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0052, dtype=torch.float64) delta_t tensor(0.2397, dtype=torch.float64)
4 gae_duplicate tensor(-0.1815, dtype=torch.float64) tensor(-4.3851, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1576, dtype=torch.float64) delta_t tensor(0.1204, dtype=torch.float64)
3 gae_duplicate tensor(-0.2416, dtype=torch.float64) tensor(-2.3406, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3768, dtype=torch.float64) delta_t tensor(-0.1358, dtype=torch.float64)
2 gae_duplicate tensor(-0.3604, dtype=torch.float64) tensor(1.9825, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:691.5042724609375
value loss:80.07286834716797
entropies:337.1824951171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.881289958953857 seconds
19 rew tensor(0.8639, dtype=torch.float64) delta_t tensor(0.0012, dtype=torch.float64)
19 gae_duplicate tensor(-0.0624, dtype=torch.float64) tensor(0.0697, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8644, dtype=torch.float64) delta_t tensor(0.0814, dtype=torch.float64)
18 gae_duplicate tensor(-0.0394, dtype=torch.float64) tensor(-1.3888, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7978, dtype=torch.float64) delta_t tensor(0.0395, dtype=torch.float64)
17 gae_duplicate tensor(-0.0219, dtype=torch.float64) tensor(-0.9002, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7534, dtype=torch.float64) delta_t tensor(0.0831, dtype=torch.float64)
16 gae_duplicate tensor(-0.0166, dtype=torch.float64) tensor(-1.4147, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7609, dtype=torch.float64) delta_t tensor(0.0941, dtype=torch.float64)
15 gae_duplicate tensor(-0.0914, dtype=torch.float64) tensor(-2.0031, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6777, dtype=torch.float64) delta_t tensor(0.1179, dtype=torch.float64)
14 gae_duplicate tensor(-0.0547, dtype=torch.float64) tensor(-2.4340, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4572, dtype=torch.float64) delta_t tensor(-0.1380, dtype=torch.float64)
13 gae_duplicate tensor(-1.0959, dtype=torch.float64) tensor(2.4791, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2460, dtype=torch.float64) delta_t tensor(-0.0233, dtype=torch.float64)
12 gae_duplicate tensor(-1.0479, dtype=torch.float64) tensor(0.2174, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.9125, dtype=torch.float64) delta_t tensor(-0.9012, dtype=torch.float64)
11 gae_duplicate tensor(-2.2125, dtype=torch.float64) tensor(14.8953, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3012, dtype=torch.float64) delta_t tensor(0.5499, dtype=torch.float64)
10 gae_duplicate tensor(-0.3488, dtype=torch.float64) tensor(-8.5333, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2428, dtype=torch.float64) delta_t tensor(-0.6358, dtype=torch.float64)
9 gae_duplicate tensor(-2.9946, dtype=torch.float64) tensor(15.6886, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6679, dtype=torch.float64) delta_t tensor(-0.2368, dtype=torch.float64)
8 gae_duplicate tensor(-2.2809, dtype=torch.float64) tensor(4.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2838, dtype=torch.float64) delta_t tensor(0.2022, dtype=torch.float64)
7 gae_duplicate tensor(-1.0198, dtype=torch.float64) tensor(-2.4498, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2783, dtype=torch.float64) delta_t tensor(0.2718, dtype=torch.float64)
6 gae_duplicate tensor(-1.9320, dtype=torch.float64) tensor(-7.5211, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1768, dtype=torch.float64) delta_t tensor(0.3697, dtype=torch.float64)
5 gae_duplicate tensor(0.2153, dtype=torch.float64) tensor(-8.3038, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1166, dtype=torch.float64) delta_t tensor(0.1398, dtype=torch.float64)
4 gae_duplicate tensor(-0.2820, dtype=torch.float64) tensor(-3.8942, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2241, dtype=torch.float64) delta_t tensor(0.1083, dtype=torch.float64)
3 gae_duplicate tensor(-0.1846, dtype=torch.float64) tensor(-2.3543, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4194, dtype=torch.float64) delta_t tensor(-0.1199, dtype=torch.float64)
2 gae_duplicate tensor(-0.2238, dtype=torch.float64) tensor(1.9794, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3.0810277462005615
value loss:84.36693572998047
entropies:338.11822509765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.953289985656738 seconds
19 rew tensor(0.8755, dtype=torch.float64) delta_t tensor(0.0818, dtype=torch.float64)
19 gae_duplicate tensor(-0.0672, dtype=torch.float64) tensor(-1.6419, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8291, dtype=torch.float64) delta_t tensor(0.2257, dtype=torch.float64)
18 gae_duplicate tensor(0.1164, dtype=torch.float64) tensor(-4.4831, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7908, dtype=torch.float64) delta_t tensor(0.0737, dtype=torch.float64)
17 gae_duplicate tensor(-0.0441, dtype=torch.float64) tensor(-1.8673, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6159, dtype=torch.float64) delta_t tensor(0.0937, dtype=torch.float64)
16 gae_duplicate tensor(0.0477, dtype=torch.float64) tensor(-1.9204, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4274, dtype=torch.float64) delta_t tensor(-0.1953, dtype=torch.float64)
15 gae_duplicate tensor(-1.1551, dtype=torch.float64) tensor(2.7907, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2737, dtype=torch.float64) delta_t tensor(-0.0249, dtype=torch.float64)
14 gae_duplicate tensor(-1.2064, dtype=torch.float64) tensor(2.5832, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6670, dtype=torch.float64) delta_t tensor(0.0990, dtype=torch.float64)
13 gae_duplicate tensor(-0.0305, dtype=torch.float64) tensor(-1.7707, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2433, dtype=torch.float64) delta_t tensor(-0.2979, dtype=torch.float64)
12 gae_duplicate tensor(-1.2285, dtype=torch.float64) tensor(3.4592, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2399, dtype=torch.float64) delta_t tensor(0.1378, dtype=torch.float64)
11 gae_duplicate tensor(-0.8961, dtype=torch.float64) tensor(-1.6197, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0438, dtype=torch.float64) delta_t tensor(0.4483, dtype=torch.float64)
10 gae_duplicate tensor(-0.1229, dtype=torch.float64) tensor(-8.7024, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7814, dtype=torch.float64) delta_t tensor(-0.2832, dtype=torch.float64)
9 gae_duplicate tensor(-2.6391, dtype=torch.float64) tensor(4.5907, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7629, dtype=torch.float64) delta_t tensor(0.1528, dtype=torch.float64)
8 gae_duplicate tensor(-1.8949, dtype=torch.float64) tensor(-4.4594, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2953, dtype=torch.float64) delta_t tensor(0.2807, dtype=torch.float64)
7 gae_duplicate tensor(0.0486, dtype=torch.float64) tensor(-5.7112, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1420, dtype=torch.float64) delta_t tensor(0.9687, dtype=torch.float64)
6 gae_duplicate tensor(0.1460, dtype=torch.float64) tensor(-17.8600, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2536, dtype=torch.float64) delta_t tensor(0.3549, dtype=torch.float64)
5 gae_duplicate tensor(0.0751, dtype=torch.float64) tensor(-8.7582, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0940, dtype=torch.float64) delta_t tensor(0.1361, dtype=torch.float64)
4 gae_duplicate tensor(-0.1653, dtype=torch.float64) tensor(-3.5349, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3422, dtype=torch.float64) delta_t tensor(0.3493, dtype=torch.float64)
3 gae_duplicate tensor(0.2855, dtype=torch.float64) tensor(-6.7383, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4376, dtype=torch.float64) delta_t tensor(-0.1364, dtype=torch.float64)
2 gae_duplicate tensor(-0.3007, dtype=torch.float64) tensor(1.3169, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2841.947998046875
value loss:63.75479507446289
entropies:339.635009765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.923063039779663 seconds
19 rew tensor(0.8270, dtype=torch.float64) delta_t tensor(0.0453, dtype=torch.float64)
19 gae_duplicate tensor(-0.1246, dtype=torch.float64) tensor(-0.6171, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7793, dtype=torch.float64) delta_t tensor(0.0553, dtype=torch.float64)
18 gae_duplicate tensor(-0.0748, dtype=torch.float64) tensor(-1.1060, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7132, dtype=torch.float64) delta_t tensor(0.0458, dtype=torch.float64)
17 gae_duplicate tensor(0.0175, dtype=torch.float64) tensor(-1.0315, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5453, dtype=torch.float64) delta_t tensor(-0.0724, dtype=torch.float64)
16 gae_duplicate tensor(-1.0715, dtype=torch.float64) tensor(0.9647, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5513, dtype=torch.float64) delta_t tensor(0.0083, dtype=torch.float64)
15 gae_duplicate tensor(-0.2004, dtype=torch.float64) tensor(0.0471, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6089, dtype=torch.float64) delta_t tensor(0.2621, dtype=torch.float64)
14 gae_duplicate tensor(0.0382, dtype=torch.float64) tensor(-4.7021, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5983, dtype=torch.float64) delta_t tensor(0.2145, dtype=torch.float64)
13 gae_duplicate tensor(0.0222, dtype=torch.float64) tensor(-4.3690, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4558, dtype=torch.float64) delta_t tensor(0.4071, dtype=torch.float64)
12 gae_duplicate tensor(0.1088, dtype=torch.float64) tensor(-8.3203, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8545, dtype=torch.float64) delta_t tensor(-0.5324, dtype=torch.float64)
11 gae_duplicate tensor(-1.4071, dtype=torch.float64) tensor(9.0201, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1942, dtype=torch.float64) delta_t tensor(0.6767, dtype=torch.float64)
10 gae_duplicate tensor(-0.5758, dtype=torch.float64) tensor(-12.2762, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7804, dtype=torch.float64) delta_t tensor(-0.9634, dtype=torch.float64)
9 gae_duplicate tensor(-3.1003, dtype=torch.float64) tensor(16.1510, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.7876, dtype=torch.float64) delta_t tensor(-0.9056, dtype=torch.float64)
8 gae_duplicate tensor(-2.1936, dtype=torch.float64) tensor(17.1185, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4616, dtype=torch.float64) delta_t tensor(0.0238, dtype=torch.float64)
7 gae_duplicate tensor(-2.1711, dtype=torch.float64) tensor(1.0481, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1110, dtype=torch.float64) delta_t tensor(0.5696, dtype=torch.float64)
6 gae_duplicate tensor(-1.5472, dtype=torch.float64) tensor(-12.6383, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0647, dtype=torch.float64) delta_t tensor(0.4510, dtype=torch.float64)
5 gae_duplicate tensor(0.1290, dtype=torch.float64) tensor(-8.7984, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3591, dtype=torch.float64) delta_t tensor(0.2600, dtype=torch.float64)
4 gae_duplicate tensor(0.1363, dtype=torch.float64) tensor(-6.2143, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0762, dtype=torch.float64) delta_t tensor(0.0396, dtype=torch.float64)
3 gae_duplicate tensor(-0.3101, dtype=torch.float64) tensor(-1.3955, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2330, dtype=torch.float64) delta_t tensor(-0.0815, dtype=torch.float64)
2 gae_duplicate tensor(-0.1747, dtype=torch.float64) tensor(1.2218, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:766.3424682617188
value loss:94.94835662841797
entropies:341.1847229003906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.602804183959961 seconds
19 rew tensor(0.8531, dtype=torch.float64) delta_t tensor(0.0277, dtype=torch.float64)
19 gae_duplicate tensor(-0.1072, dtype=torch.float64) tensor(-0.5146, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8542, dtype=torch.float64) delta_t tensor(0.1363, dtype=torch.float64)
18 gae_duplicate tensor(-0.0180, dtype=torch.float64) tensor(-2.6996, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8352, dtype=torch.float64) delta_t tensor(0.1362, dtype=torch.float64)
17 gae_duplicate tensor(0.0151, dtype=torch.float64) tensor(-2.8139, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7593, dtype=torch.float64) delta_t tensor(0.1124, dtype=torch.float64)
16 gae_duplicate tensor(0.0319, dtype=torch.float64) tensor(-2.8276, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7681, dtype=torch.float64) delta_t tensor(0.1480, dtype=torch.float64)
15 gae_duplicate tensor(-0.0496, dtype=torch.float64) tensor(-3.0733, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6443, dtype=torch.float64) delta_t tensor(0.1096, dtype=torch.float64)
14 gae_duplicate tensor(-0.0167, dtype=torch.float64) tensor(-2.3448, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5967, dtype=torch.float64) delta_t tensor(0.1278, dtype=torch.float64)
13 gae_duplicate tensor(-0.0809, dtype=torch.float64) tensor(-2.5575, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5494, dtype=torch.float64) delta_t tensor(0.2885, dtype=torch.float64)
12 gae_duplicate tensor(0.0171, dtype=torch.float64) tensor(-5.6841, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3035, dtype=torch.float64) delta_t tensor(0.0927, dtype=torch.float64)
11 gae_duplicate tensor(-0.2022, dtype=torch.float64) tensor(-2.1442, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0953, dtype=torch.float64) delta_t tensor(0.1705, dtype=torch.float64)
10 gae_duplicate tensor(-0.1166, dtype=torch.float64) tensor(-3.4523, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-3.1551, dtype=torch.float64) delta_t tensor(-2.3835, dtype=torch.float64)
9 gae_duplicate tensor(-4.4978, dtype=torch.float64) tensor(44.6215, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1113, dtype=torch.float64) delta_t tensor(0.6387, dtype=torch.float64)
8 gae_duplicate tensor(-0.1697, dtype=torch.float64) tensor(-7.8153, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7917, dtype=torch.float64) delta_t tensor(-0.4398, dtype=torch.float64)
7 gae_duplicate tensor(-2.0824, dtype=torch.float64) tensor(7.6111, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2285, dtype=torch.float64) delta_t tensor(0.2720, dtype=torch.float64)
6 gae_duplicate tensor(-2.3078, dtype=torch.float64) tensor(-5.2276, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6329, dtype=torch.float64) delta_t tensor(-0.1852, dtype=torch.float64)
5 gae_duplicate tensor(-2.5038, dtype=torch.float64) tensor(2.4051, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2236, dtype=torch.float64) delta_t tensor(0.2154, dtype=torch.float64)
4 gae_duplicate tensor(-0.1694, dtype=torch.float64) tensor(-3.6046, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0292, dtype=torch.float64) delta_t tensor(0.0846, dtype=torch.float64)
3 gae_duplicate tensor(-0.1942, dtype=torch.float64) tensor(-1.2984, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1846, dtype=torch.float64) delta_t tensor(-0.0847, dtype=torch.float64)
2 gae_duplicate tensor(-0.3715, dtype=torch.float64) tensor(1.5855, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-641.5780029296875
value loss:130.97694396972656
entropies:343.1025695800781
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3880.0508)
ToM Target loss= tensor(3619.3286)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.698649883270264 seconds
19 rew tensor(0.7865, dtype=torch.float64) delta_t tensor(0.0208, dtype=torch.float64)
19 gae_duplicate tensor(-0.1085, dtype=torch.float64) tensor(-0.6001, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5303, dtype=torch.float64) delta_t tensor(-0.0879, dtype=torch.float64)
18 gae_duplicate tensor(-0.9971, dtype=torch.float64) tensor(1.9638, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7687, dtype=torch.float64) delta_t tensor(0.0967, dtype=torch.float64)
17 gae_duplicate tensor(-0.0040, dtype=torch.float64) tensor(-1.6078, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6632, dtype=torch.float64) delta_t tensor(0.0921, dtype=torch.float64)
16 gae_duplicate tensor(0.0181, dtype=torch.float64) tensor(-1.8047, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6643, dtype=torch.float64) delta_t tensor(0.0482, dtype=torch.float64)
15 gae_duplicate tensor(-0.0339, dtype=torch.float64) tensor(-0.9376, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2005, dtype=torch.float64) delta_t tensor(-0.2900, dtype=torch.float64)
14 gae_duplicate tensor(-1.0224, dtype=torch.float64) tensor(5.1146, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5885, dtype=torch.float64) delta_t tensor(0.0600, dtype=torch.float64)
13 gae_duplicate tensor(-0.1448, dtype=torch.float64) tensor(-0.5810, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3428, dtype=torch.float64) delta_t tensor(0.1792, dtype=torch.float64)
12 gae_duplicate tensor(-0.7578, dtype=torch.float64) tensor(-2.8274, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3678, dtype=torch.float64) delta_t tensor(-0.2026, dtype=torch.float64)
11 gae_duplicate tensor(-2.0859, dtype=torch.float64) tensor(1.7583, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1436, dtype=torch.float64) delta_t tensor(0.4210, dtype=torch.float64)
10 gae_duplicate tensor(-0.1446, dtype=torch.float64) tensor(-9.3446, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.6469, dtype=torch.float64) delta_t tensor(-2.0457, dtype=torch.float64)
9 gae_duplicate tensor(-3.7903, dtype=torch.float64) tensor(37.0711, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.0024, dtype=torch.float64) delta_t tensor(-1.1838, dtype=torch.float64)
8 gae_duplicate tensor(-3.2023, dtype=torch.float64) tensor(25.9170, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1023, dtype=torch.float64) delta_t tensor(0.3646, dtype=torch.float64)
7 gae_duplicate tensor(-0.8800, dtype=torch.float64) tensor(-2.7047, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0260, dtype=torch.float64) delta_t tensor(0.5977, dtype=torch.float64)
6 gae_duplicate tensor(-0.5920, dtype=torch.float64) tensor(-12.3870, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2966, dtype=torch.float64) delta_t tensor(0.2779, dtype=torch.float64)
5 gae_duplicate tensor(0.0846, dtype=torch.float64) tensor(-6.2920, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0318, dtype=torch.float64) delta_t tensor(0.0210, dtype=torch.float64)
4 gae_duplicate tensor(-0.2706, dtype=torch.float64) tensor(-1.2658, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3433, dtype=torch.float64) delta_t tensor(0.1715, dtype=torch.float64)
3 gae_duplicate tensor(0.0064, dtype=torch.float64) tensor(-3.2180, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4412, dtype=torch.float64) delta_t tensor(-0.1952, dtype=torch.float64)
2 gae_duplicate tensor(-0.2994, dtype=torch.float64) tensor(3.6947, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1818.2802734375
value loss:117.22791290283203
entropies:344.64166259765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.659150838851929 seconds
19 rew tensor(0.8637, dtype=torch.float64) delta_t tensor(0.0439, dtype=torch.float64)
19 gae_duplicate tensor(-0.0413, dtype=torch.float64) tensor(-0.8727, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7484, dtype=torch.float64) delta_t tensor(0.0973, dtype=torch.float64)
18 gae_duplicate tensor(0.0003, dtype=torch.float64) tensor(-1.8475, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7788, dtype=torch.float64) delta_t tensor(0.1253, dtype=torch.float64)
17 gae_duplicate tensor(-0.0939, dtype=torch.float64) tensor(-2.4949, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6439, dtype=torch.float64) delta_t tensor(0.0477, dtype=torch.float64)
16 gae_duplicate tensor(-0.0169, dtype=torch.float64) tensor(-1.1664, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6830, dtype=torch.float64) delta_t tensor(0.0797, dtype=torch.float64)
15 gae_duplicate tensor(-0.0065, dtype=torch.float64) tensor(-1.6091, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5374, dtype=torch.float64) delta_t tensor(0.0738, dtype=torch.float64)
14 gae_duplicate tensor(-0.0306, dtype=torch.float64) tensor(-1.4939, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2309, dtype=torch.float64) delta_t tensor(-0.2857, dtype=torch.float64)
13 gae_duplicate tensor(-1.0147, dtype=torch.float64) tensor(6.0938, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3262, dtype=torch.float64) delta_t tensor(0.0138, dtype=torch.float64)
12 gae_duplicate tensor(-1.2854, dtype=torch.float64) tensor(1.5482, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3439, dtype=torch.float64) delta_t tensor(0.2601, dtype=torch.float64)
11 gae_duplicate tensor(-0.2451, dtype=torch.float64) tensor(-4.9342, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4240, dtype=torch.float64) delta_t tensor(-0.2280, dtype=torch.float64)
10 gae_duplicate tensor(-2.2649, dtype=torch.float64) tensor(6.8550, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0455, dtype=torch.float64) delta_t tensor(-0.1770, dtype=torch.float64)
9 gae_duplicate tensor(-2.4220, dtype=torch.float64) tensor(5.0656, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0971, dtype=torch.float64) delta_t tensor(0.1399, dtype=torch.float64)
8 gae_duplicate tensor(-0.9150, dtype=torch.float64) tensor(-2.3474, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5914, dtype=torch.float64) delta_t tensor(-0.7147, dtype=torch.float64)
7 gae_duplicate tensor(-2.5700, dtype=torch.float64) tensor(12.8178, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6179, dtype=torch.float64) delta_t tensor(-0.3333, dtype=torch.float64)
6 gae_duplicate tensor(-2.8171, dtype=torch.float64) tensor(6.3537, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6977, dtype=torch.float64) delta_t tensor(0.0128, dtype=torch.float64)
5 gae_duplicate tensor(-1.9450, dtype=torch.float64) tensor(-0.3571, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3841, dtype=torch.float64) delta_t tensor(0.2340, dtype=torch.float64)
4 gae_duplicate tensor(-0.2746, dtype=torch.float64) tensor(-4.3113, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1995, dtype=torch.float64) delta_t tensor(0.1473, dtype=torch.float64)
3 gae_duplicate tensor(0.0284, dtype=torch.float64) tensor(-3.2591, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0858, dtype=torch.float64) delta_t tensor(-0.0226, dtype=torch.float64)
2 gae_duplicate tensor(-0.2549, dtype=torch.float64) tensor(0.1673, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-860.798095703125
value loss:101.1473388671875
entropies:346.6016540527344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.741790056228638 seconds
19 rew tensor(0.8234, dtype=torch.float64) delta_t tensor(0.0125, dtype=torch.float64)
19 gae_duplicate tensor(-0.0725, dtype=torch.float64) tensor(-0.1731, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8028, dtype=torch.float64) delta_t tensor(0.1398, dtype=torch.float64)
18 gae_duplicate tensor(0.0618, dtype=torch.float64) tensor(-2.7159, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8042, dtype=torch.float64) delta_t tensor(0.1016, dtype=torch.float64)
17 gae_duplicate tensor(0.0233, dtype=torch.float64) tensor(-2.3487, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7454, dtype=torch.float64) delta_t tensor(0.1548, dtype=torch.float64)
16 gae_duplicate tensor(-0.0048, dtype=torch.float64) tensor(-3.0672, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7299, dtype=torch.float64) delta_t tensor(0.2133, dtype=torch.float64)
15 gae_duplicate tensor(-0.0029, dtype=torch.float64) tensor(-4.0079, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3935, dtype=torch.float64) delta_t tensor(-0.0367, dtype=torch.float64)
14 gae_duplicate tensor(-0.9935, dtype=torch.float64) tensor(0.2382, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6545, dtype=torch.float64) delta_t tensor(0.1895, dtype=torch.float64)
13 gae_duplicate tensor(0.0978, dtype=torch.float64) tensor(-3.5945, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2779, dtype=torch.float64) delta_t tensor(0.2103, dtype=torch.float64)
12 gae_duplicate tensor(0.1026, dtype=torch.float64) tensor(-4.1051, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4800, dtype=torch.float64) delta_t tensor(-0.1748, dtype=torch.float64)
11 gae_duplicate tensor(-1.6913, dtype=torch.float64) tensor(3.9661, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4005, dtype=torch.float64) delta_t tensor(0.7782, dtype=torch.float64)
10 gae_duplicate tensor(0.1096, dtype=torch.float64) tensor(-15.2068, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-3.2700, dtype=torch.float64) delta_t tensor(-2.0974, dtype=torch.float64)
9 gae_duplicate tensor(-3.9793, dtype=torch.float64) tensor(37.0523, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7600, dtype=torch.float64) delta_t tensor(-0.0222, dtype=torch.float64)
8 gae_duplicate tensor(-2.0072, dtype=torch.float64) tensor(3.7554, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5034, dtype=torch.float64) delta_t tensor(0.2586, dtype=torch.float64)
7 gae_duplicate tensor(-0.8722, dtype=torch.float64) tensor(-4.2450, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2455, dtype=torch.float64) delta_t tensor(0.3676, dtype=torch.float64)
6 gae_duplicate tensor(-1.9991, dtype=torch.float64) tensor(-8.0443, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0246, dtype=torch.float64) delta_t tensor(0.5385, dtype=torch.float64)
5 gae_duplicate tensor(0.3271, dtype=torch.float64) tensor(-12.0479, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4391, dtype=torch.float64) delta_t tensor(0.2836, dtype=torch.float64)
4 gae_duplicate tensor(0.1001, dtype=torch.float64) tensor(-6.4620, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0312, dtype=torch.float64) delta_t tensor(0.0123, dtype=torch.float64)
3 gae_duplicate tensor(-0.1807, dtype=torch.float64) tensor(-0.9125, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2419, dtype=torch.float64) delta_t tensor(-0.0313, dtype=torch.float64)
2 gae_duplicate tensor(-0.1208, dtype=torch.float64) tensor(0.5036, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1062.6151123046875
value loss:112.1409912109375
entropies:347.4043884277344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.796298980712891 seconds
19 rew tensor(0.8416, dtype=torch.float64) delta_t tensor(0.0745, dtype=torch.float64)
19 gae_duplicate tensor(-0.0026, dtype=torch.float64) tensor(-1.4666, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6154, dtype=torch.float64) delta_t tensor(-0.0439, dtype=torch.float64)
18 gae_duplicate tensor(-0.9829, dtype=torch.float64) tensor(0.2315, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8332, dtype=torch.float64) delta_t tensor(0.1226, dtype=torch.float64)
17 gae_duplicate tensor(0.0554, dtype=torch.float64) tensor(-2.3029, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6905, dtype=torch.float64) delta_t tensor(0.1447, dtype=torch.float64)
16 gae_duplicate tensor(0.0320, dtype=torch.float64) tensor(-2.9536, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5399, dtype=torch.float64) delta_t tensor(-0.0568, dtype=torch.float64)
15 gae_duplicate tensor(-0.8952, dtype=torch.float64) tensor(0.1006, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5852, dtype=torch.float64) delta_t tensor(0.2132, dtype=torch.float64)
14 gae_duplicate tensor(0.0911, dtype=torch.float64) tensor(-4.4558, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6891, dtype=torch.float64) delta_t tensor(0.2948, dtype=torch.float64)
13 gae_duplicate tensor(0.1192, dtype=torch.float64) tensor(-5.8800, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0959, dtype=torch.float64) delta_t tensor(0.1583, dtype=torch.float64)
12 gae_duplicate tensor(-1.2466, dtype=torch.float64) tensor(-3.4190, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1555, dtype=torch.float64) delta_t tensor(0.3409, dtype=torch.float64)
11 gae_duplicate tensor(-0.6279, dtype=torch.float64) tensor(-6.0921, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4574, dtype=torch.float64) delta_t tensor(0.1888, dtype=torch.float64)
10 gae_duplicate tensor(-1.9580, dtype=torch.float64) tensor(-5.1274, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.1684, dtype=torch.float64) delta_t tensor(-1.2732, dtype=torch.float64)
9 gae_duplicate tensor(-3.7384, dtype=torch.float64) tensor(24.2178, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.0562, dtype=torch.float64) delta_t tensor(-1.0850, dtype=torch.float64)
8 gae_duplicate tensor(-4.0037, dtype=torch.float64) tensor(20.0312, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7359, dtype=torch.float64) delta_t tensor(-0.2664, dtype=torch.float64)
7 gae_duplicate tensor(-3.3665, dtype=torch.float64) tensor(6.2842, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1854, dtype=torch.float64) delta_t tensor(0.5936, dtype=torch.float64)
6 gae_duplicate tensor(-1.9827, dtype=torch.float64) tensor(-9.8345, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2460, dtype=torch.float64) delta_t tensor(0.0970, dtype=torch.float64)
5 gae_duplicate tensor(-1.7311, dtype=torch.float64) tensor(-3.1118, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2436, dtype=torch.float64) delta_t tensor(0.1749, dtype=torch.float64)
4 gae_duplicate tensor(-0.0773, dtype=torch.float64) tensor(-4.2421, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1548, dtype=torch.float64) delta_t tensor(0.0983, dtype=torch.float64)
3 gae_duplicate tensor(-0.2318, dtype=torch.float64) tensor(-2.1982, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3044, dtype=torch.float64) delta_t tensor(-0.1024, dtype=torch.float64)
2 gae_duplicate tensor(-0.1818, dtype=torch.float64) tensor(1.7122, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-174.75184631347656
value loss:144.23922729492188
entropies:348.4942626953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7371509075164795 seconds
19 rew tensor(0.8423, dtype=torch.float64) delta_t tensor(0.1038, dtype=torch.float64)
19 gae_duplicate tensor(-0.0282, dtype=torch.float64) tensor(-2.1414, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7666, dtype=torch.float64) delta_t tensor(0.1070, dtype=torch.float64)
18 gae_duplicate tensor(0.0052, dtype=torch.float64) tensor(-2.1074, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7387, dtype=torch.float64) delta_t tensor(0.1372, dtype=torch.float64)
17 gae_duplicate tensor(0.0474, dtype=torch.float64) tensor(-3.0736, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7190, dtype=torch.float64) delta_t tensor(0.1072, dtype=torch.float64)
16 gae_duplicate tensor(0.0279, dtype=torch.float64) tensor(-2.6447, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4812, dtype=torch.float64) delta_t tensor(-0.0141, dtype=torch.float64)
15 gae_duplicate tensor(-1.1422, dtype=torch.float64) tensor(-0.7079, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6314, dtype=torch.float64) delta_t tensor(0.3008, dtype=torch.float64)
14 gae_duplicate tensor(0.0569, dtype=torch.float64) tensor(-5.5038, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3305, dtype=torch.float64) delta_t tensor(0.1581, dtype=torch.float64)
13 gae_duplicate tensor(-0.4269, dtype=torch.float64) tensor(-3.1899, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5682, dtype=torch.float64) delta_t tensor(0.4573, dtype=torch.float64)
12 gae_duplicate tensor(0.0474, dtype=torch.float64) tensor(-9.0092, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7687, dtype=torch.float64) delta_t tensor(-0.1112, dtype=torch.float64)
11 gae_duplicate tensor(-1.2396, dtype=torch.float64) tensor(1.1067, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3803, dtype=torch.float64) delta_t tensor(0.6104, dtype=torch.float64)
10 gae_duplicate tensor(-0.1459, dtype=torch.float64) tensor(-11.9611, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.0216, dtype=torch.float64) delta_t tensor(-0.6811, dtype=torch.float64)
9 gae_duplicate tensor(-1.6606, dtype=torch.float64) tensor(13.8321, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.4155, dtype=torch.float64) delta_t tensor(-0.6123, dtype=torch.float64)
8 gae_duplicate tensor(-1.9787, dtype=torch.float64) tensor(13.6372, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6993, dtype=torch.float64) delta_t tensor(0.0674, dtype=torch.float64)
7 gae_duplicate tensor(-2.0855, dtype=torch.float64) tensor(-0.2005, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1971, dtype=torch.float64) delta_t tensor(0.2670, dtype=torch.float64)
6 gae_duplicate tensor(-3.4291, dtype=torch.float64) tensor(-8.0999, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2606, dtype=torch.float64) delta_t tensor(0.1788, dtype=torch.float64)
5 gae_duplicate tensor(-0.7536, dtype=torch.float64) tensor(-4.9801, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4806, dtype=torch.float64) delta_t tensor(0.3513, dtype=torch.float64)
4 gae_duplicate tensor(0.1768, dtype=torch.float64) tensor(-7.1691, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1275, dtype=torch.float64) delta_t tensor(0.0099, dtype=torch.float64)
3 gae_duplicate tensor(-0.1104, dtype=torch.float64) tensor(-0.9270, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0936, dtype=torch.float64) delta_t tensor(0.0014, dtype=torch.float64)
2 gae_duplicate tensor(-0.1537, dtype=torch.float64) tensor(-0.0671, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1698.72021484375
value loss:98.83430480957031
entropies:349.77520751953125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(4023.8452)
ToM Target loss= tensor(3621.1743)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.9278740882873535 seconds
19 rew tensor(0.8423, dtype=torch.float64) delta_t tensor(0.1011, dtype=torch.float64)
19 gae_duplicate tensor(0.0253, dtype=torch.float64) tensor(-2.0517, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3538, dtype=torch.float64) delta_t tensor(-0.2931, dtype=torch.float64)
18 gae_duplicate tensor(-1.0836, dtype=torch.float64) tensor(5.0850, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7760, dtype=torch.float64) delta_t tensor(0.1518, dtype=torch.float64)
17 gae_duplicate tensor(0.0317, dtype=torch.float64) tensor(-2.4696, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7287, dtype=torch.float64) delta_t tensor(0.1253, dtype=torch.float64)
16 gae_duplicate tensor(0.0520, dtype=torch.float64) tensor(-2.7324, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0963, dtype=torch.float64) delta_t tensor(-0.4489, dtype=torch.float64)
15 gae_duplicate tensor(-1.0789, dtype=torch.float64) tensor(8.0371, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4726, dtype=torch.float64) delta_t tensor(0.0827, dtype=torch.float64)
14 gae_duplicate tensor(-0.7390, dtype=torch.float64) tensor(-0.5942, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4157, dtype=torch.float64) delta_t tensor(0.2325, dtype=torch.float64)
13 gae_duplicate tensor(-0.7097, dtype=torch.float64) tensor(-4.8279, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7204, dtype=torch.float64) delta_t tensor(0.6666, dtype=torch.float64)
12 gae_duplicate tensor(0.2765, dtype=torch.float64) tensor(-12.7260, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0684, dtype=torch.float64) delta_t tensor(0.3419, dtype=torch.float64)
11 gae_duplicate tensor(-0.2649, dtype=torch.float64) tensor(-7.6429, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0831, dtype=torch.float64) delta_t tensor(0.3809, dtype=torch.float64)
10 gae_duplicate tensor(-0.2002, dtype=torch.float64) tensor(-7.7421, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4065, dtype=torch.float64) delta_t tensor(-0.2265, dtype=torch.float64)
9 gae_duplicate tensor(-2.6814, dtype=torch.float64) tensor(2.8445, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3594, dtype=torch.float64) delta_t tensor(-0.6444, dtype=torch.float64)
8 gae_duplicate tensor(-3.1440, dtype=torch.float64) tensor(11.6339, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8427, dtype=torch.float64) delta_t tensor(0.0607, dtype=torch.float64)
7 gae_duplicate tensor(-1.8293, dtype=torch.float64) tensor(0.1959, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4806, dtype=torch.float64) delta_t tensor(-0.1871, dtype=torch.float64)
6 gae_duplicate tensor(-2.2566, dtype=torch.float64) tensor(3.7915, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3304, dtype=torch.float64) delta_t tensor(0.1174, dtype=torch.float64)
5 gae_duplicate tensor(-1.4897, dtype=torch.float64) tensor(-2.0634, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3544, dtype=torch.float64) delta_t tensor(0.3476, dtype=torch.float64)
4 gae_duplicate tensor(0.2140, dtype=torch.float64) tensor(-7.3664, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2186, dtype=torch.float64) delta_t tensor(0.0270, dtype=torch.float64)
3 gae_duplicate tensor(-0.2315, dtype=torch.float64) tensor(-1.2628, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0670, dtype=torch.float64) delta_t tensor(0.0135, dtype=torch.float64)
2 gae_duplicate tensor(-0.1715, dtype=torch.float64) tensor(-0.2981, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:995.5150146484375
value loss:122.54795837402344
entropies:350.7959899902344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.693441867828369 seconds
19 rew tensor(0.8422, dtype=torch.float64) delta_t tensor(0.1381, dtype=torch.float64)
19 gae_duplicate tensor(0.0350, dtype=torch.float64) tensor(-2.7307, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5844, dtype=torch.float64) delta_t tensor(-0.0852, dtype=torch.float64)
18 gae_duplicate tensor(-1.1089, dtype=torch.float64) tensor(1.1753, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7674, dtype=torch.float64) delta_t tensor(0.1457, dtype=torch.float64)
17 gae_duplicate tensor(0.0339, dtype=torch.float64) tensor(-2.8483, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5018, dtype=torch.float64) delta_t tensor(-0.0970, dtype=torch.float64)
16 gae_duplicate tensor(-1.0415, dtype=torch.float64) tensor(1.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3519, dtype=torch.float64) delta_t tensor(-0.2038, dtype=torch.float64)
15 gae_duplicate tensor(-1.0073, dtype=torch.float64) tensor(4.4378, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6249, dtype=torch.float64) delta_t tensor(0.3681, dtype=torch.float64)
14 gae_duplicate tensor(-0.0690, dtype=torch.float64) tensor(-7.0954, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3510, dtype=torch.float64) delta_t tensor(0.1236, dtype=torch.float64)
13 gae_duplicate tensor(-0.7914, dtype=torch.float64) tensor(-3.8475, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4352, dtype=torch.float64) delta_t tensor(0.0650, dtype=torch.float64)
12 gae_duplicate tensor(-1.2236, dtype=torch.float64) tensor(-1.6177, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1120, dtype=torch.float64) delta_t tensor(0.1850, dtype=torch.float64)
11 gae_duplicate tensor(-1.3553, dtype=torch.float64) tensor(-3.4175, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4960, dtype=torch.float64) delta_t tensor(-0.1746, dtype=torch.float64)
10 gae_duplicate tensor(-1.6916, dtype=torch.float64) tensor(3.5871, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2168, dtype=torch.float64) delta_t tensor(-0.0993, dtype=torch.float64)
9 gae_duplicate tensor(-2.7852, dtype=torch.float64) tensor(2.6444, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7921, dtype=torch.float64) delta_t tensor(-0.2274, dtype=torch.float64)
8 gae_duplicate tensor(-3.1218, dtype=torch.float64) tensor(3.5470, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2227, dtype=torch.float64) delta_t tensor(0.6429, dtype=torch.float64)
7 gae_duplicate tensor(-0.8030, dtype=torch.float64) tensor(-11.4708, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2478, dtype=torch.float64) delta_t tensor(0.4607, dtype=torch.float64)
6 gae_duplicate tensor(-0.1200, dtype=torch.float64) tensor(-10.0724, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1889, dtype=torch.float64) delta_t tensor(0.3074, dtype=torch.float64)
5 gae_duplicate tensor(-0.0011, dtype=torch.float64) tensor(-7.1055, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1800, dtype=torch.float64) delta_t tensor(0.3863, dtype=torch.float64)
4 gae_duplicate tensor(0.2612, dtype=torch.float64) tensor(-8.1038, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0430, dtype=torch.float64) delta_t tensor(0.1316, dtype=torch.float64)
3 gae_duplicate tensor(0.0291, dtype=torch.float64) tensor(-3.5460, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2424, dtype=torch.float64) delta_t tensor(-0.0890, dtype=torch.float64)
2 gae_duplicate tensor(-0.2908, dtype=torch.float64) tensor(1.2483, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2245.943603515625
value loss:87.06491088867188
entropies:351.8838806152344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.010368824005127 seconds
19 rew tensor(0.8540, dtype=torch.float64) delta_t tensor(-0.0240, dtype=torch.float64)
19 gae_duplicate tensor(-0.1613, dtype=torch.float64) tensor(0.4660, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8255, dtype=torch.float64) delta_t tensor(0.0368, dtype=torch.float64)
18 gae_duplicate tensor(-0.0395, dtype=torch.float64) tensor(-0.7810, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7593, dtype=torch.float64) delta_t tensor(-0.0095, dtype=torch.float64)
17 gae_duplicate tensor(-0.0952, dtype=torch.float64) tensor(0.1702, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6929, dtype=torch.float64) delta_t tensor(0.0036, dtype=torch.float64)
16 gae_duplicate tensor(-0.0700, dtype=torch.float64) tensor(-0.0591, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5887, dtype=torch.float64) delta_t tensor(-0.0439, dtype=torch.float64)
15 gae_duplicate tensor(-0.1540, dtype=torch.float64) tensor(0.7956, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6085, dtype=torch.float64) delta_t tensor(0.0252, dtype=torch.float64)
14 gae_duplicate tensor(-0.0776, dtype=torch.float64) tensor(-0.3966, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1514, dtype=torch.float64) delta_t tensor(-0.2812, dtype=torch.float64)
13 gae_duplicate tensor(-1.3151, dtype=torch.float64) tensor(5.4777, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5163, dtype=torch.float64) delta_t tensor(0.0033, dtype=torch.float64)
12 gae_duplicate tensor(-0.1547, dtype=torch.float64) tensor(0.5287, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3242, dtype=torch.float64) delta_t tensor(-0.2559, dtype=torch.float64)
11 gae_duplicate tensor(-1.2615, dtype=torch.float64) tensor(4.6271, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5661, dtype=torch.float64) delta_t tensor(-0.5703, dtype=torch.float64)
10 gae_duplicate tensor(-2.0954, dtype=torch.float64) tensor(10.5699, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7845, dtype=torch.float64) delta_t tensor(-1.1044, dtype=torch.float64)
9 gae_duplicate tensor(-2.6713, dtype=torch.float64) tensor(20.3395, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8683, dtype=torch.float64) delta_t tensor(-0.5609, dtype=torch.float64)
8 gae_duplicate tensor(-1.6971, dtype=torch.float64) tensor(13.3527, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4348, dtype=torch.float64) delta_t tensor(0.0612, dtype=torch.float64)
7 gae_duplicate tensor(-2.1718, dtype=torch.float64) tensor(0.3045, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0199, dtype=torch.float64) delta_t tensor(0.4349, dtype=torch.float64)
6 gae_duplicate tensor(0.1026, dtype=torch.float64) tensor(-8.1133, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1562, dtype=torch.float64) delta_t tensor(0.3394, dtype=torch.float64)
5 gae_duplicate tensor(-0.1220, dtype=torch.float64) tensor(-7.2520, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3070, dtype=torch.float64) delta_t tensor(0.1409, dtype=torch.float64)
4 gae_duplicate tensor(-0.3982, dtype=torch.float64) tensor(-3.3138, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0487, dtype=torch.float64) delta_t tensor(0.0292, dtype=torch.float64)
3 gae_duplicate tensor(-0.1226, dtype=torch.float64) tensor(-0.8142, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1430, dtype=torch.float64) delta_t tensor(-0.1015, dtype=torch.float64)
2 gae_duplicate tensor(-0.2698, dtype=torch.float64) tensor(1.7098, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2126.2568359375
value loss:81.0411376953125
entropies:352.6728210449219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.631834268569946 seconds
19 rew tensor(0.8627, dtype=torch.float64) delta_t tensor(-0.0700, dtype=torch.float64)
19 gae_duplicate tensor(-0.1880, dtype=torch.float64) tensor(1.4056, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7943, dtype=torch.float64) delta_t tensor(0.0680, dtype=torch.float64)
18 gae_duplicate tensor(-0.1187, dtype=torch.float64) tensor(-1.0523, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8058, dtype=torch.float64) delta_t tensor(-0.0315, dtype=torch.float64)
17 gae_duplicate tensor(-0.1574, dtype=torch.float64) tensor(0.4624, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5861, dtype=torch.float64) delta_t tensor(-0.0697, dtype=torch.float64)
16 gae_duplicate tensor(-0.1850, dtype=torch.float64) tensor(1.4536, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7030, dtype=torch.float64) delta_t tensor(-0.0904, dtype=torch.float64)
15 gae_duplicate tensor(-0.1646, dtype=torch.float64) tensor(1.9674, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4918, dtype=torch.float64) delta_t tensor(-0.0903, dtype=torch.float64)
14 gae_duplicate tensor(-0.1615, dtype=torch.float64) tensor(1.9796, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7116, dtype=torch.float64) delta_t tensor(-0.0192, dtype=torch.float64)
13 gae_duplicate tensor(-0.1646, dtype=torch.float64) tensor(0.5214, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0148, dtype=torch.float64) delta_t tensor(-0.2379, dtype=torch.float64)
12 gae_duplicate tensor(-0.9246, dtype=torch.float64) tensor(4.4886, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4401, dtype=torch.float64) delta_t tensor(-0.1592, dtype=torch.float64)
11 gae_duplicate tensor(-1.0765, dtype=torch.float64) tensor(3.2402, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6107, dtype=torch.float64) delta_t tensor(-0.0487, dtype=torch.float64)
10 gae_duplicate tensor(-1.3648, dtype=torch.float64) tensor(2.0528, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3665, dtype=torch.float64) delta_t tensor(-0.1130, dtype=torch.float64)
9 gae_duplicate tensor(-1.8712, dtype=torch.float64) tensor(3.0821, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0009, dtype=torch.float64) delta_t tensor(0.6578, dtype=torch.float64)
8 gae_duplicate tensor(0.4268, dtype=torch.float64) tensor(-12.4741, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0905, dtype=torch.float64) delta_t tensor(-0.2413, dtype=torch.float64)
7 gae_duplicate tensor(-1.7154, dtype=torch.float64) tensor(3.9641, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6030, dtype=torch.float64) delta_t tensor(0.2223, dtype=torch.float64)
6 gae_duplicate tensor(-2.2971, dtype=torch.float64) tensor(-2.9703, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2240, dtype=torch.float64) delta_t tensor(0.0477, dtype=torch.float64)
5 gae_duplicate tensor(-0.0849, dtype=torch.float64) tensor(-1.2470, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1429, dtype=torch.float64) delta_t tensor(-0.1628, dtype=torch.float64)
4 gae_duplicate tensor(-0.3680, dtype=torch.float64) tensor(3.1759, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2396, dtype=torch.float64) delta_t tensor(0.0943, dtype=torch.float64)
3 gae_duplicate tensor(-0.0477, dtype=torch.float64) tensor(-1.5468, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4798, dtype=torch.float64) delta_t tensor(-0.2095, dtype=torch.float64)
2 gae_duplicate tensor(-0.3581, dtype=torch.float64) tensor(3.8427, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-762.0828857421875
value loss:48.761505126953125
entropies:353.3560485839844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.5247581005096436 seconds
19 rew tensor(0.8445, dtype=torch.float64) delta_t tensor(-0.1268, dtype=torch.float64)
19 gae_duplicate tensor(-0.1958, dtype=torch.float64) tensor(2.5934, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7875, dtype=torch.float64) delta_t tensor(-0.0786, dtype=torch.float64)
18 gae_duplicate tensor(-0.1394, dtype=torch.float64) tensor(1.7775, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7966, dtype=torch.float64) delta_t tensor(-0.0885, dtype=torch.float64)
17 gae_duplicate tensor(-0.1667, dtype=torch.float64) tensor(1.9604, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7220, dtype=torch.float64) delta_t tensor(-0.0474, dtype=torch.float64)
16 gae_duplicate tensor(-0.1360, dtype=torch.float64) tensor(1.1426, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4653, dtype=torch.float64) delta_t tensor(-0.2985, dtype=torch.float64)
15 gae_duplicate tensor(-1.3254, dtype=torch.float64) tensor(6.5940, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5995, dtype=torch.float64) delta_t tensor(-0.0022, dtype=torch.float64)
14 gae_duplicate tensor(-0.1848, dtype=torch.float64) tensor(0.6056, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7029, dtype=torch.float64) delta_t tensor(0.0518, dtype=torch.float64)
13 gae_duplicate tensor(-0.1512, dtype=torch.float64) tensor(-1.1871, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2556, dtype=torch.float64) delta_t tensor(-0.1262, dtype=torch.float64)
12 gae_duplicate tensor(-0.7819, dtype=torch.float64) tensor(2.2863, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2074, dtype=torch.float64) delta_t tensor(-0.5367, dtype=torch.float64)
11 gae_duplicate tensor(-1.9836, dtype=torch.float64) tensor(10.9180, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1081, dtype=torch.float64) delta_t tensor(0.0603, dtype=torch.float64)
10 gae_duplicate tensor(-1.3387, dtype=torch.float64) tensor(-0.5599, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2388, dtype=torch.float64) delta_t tensor(-1.0383, dtype=torch.float64)
9 gae_duplicate tensor(-2.6366, dtype=torch.float64) tensor(20.5511, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9018, dtype=torch.float64) delta_t tensor(-0.5361, dtype=torch.float64)
8 gae_duplicate tensor(-3.0327, dtype=torch.float64) tensor(10.9474, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4544, dtype=torch.float64) delta_t tensor(-0.3147, dtype=torch.float64)
7 gae_duplicate tensor(-2.3372, dtype=torch.float64) tensor(7.5804, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2861, dtype=torch.float64) delta_t tensor(0.0129, dtype=torch.float64)
6 gae_duplicate tensor(-2.3378, dtype=torch.float64) tensor(1.0745, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0594, dtype=torch.float64) delta_t tensor(0.1136, dtype=torch.float64)
5 gae_duplicate tensor(-0.9184, dtype=torch.float64) tensor(-2.5364, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1620, dtype=torch.float64) delta_t tensor(-0.0493, dtype=torch.float64)
4 gae_duplicate tensor(-0.3975, dtype=torch.float64) tensor(0.8557, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1522, dtype=torch.float64) delta_t tensor(-0.0796, dtype=torch.float64)
3 gae_duplicate tensor(-0.4881, dtype=torch.float64) tensor(1.5907, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3366, dtype=torch.float64) delta_t tensor(-0.1872, dtype=torch.float64)
2 gae_duplicate tensor(-0.2662, dtype=torch.float64) tensor(3.8904, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3880.09375
value loss:91.77313232421875
entropies:353.78057861328125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(4046.2603)
ToM Target loss= tensor(3621.7463)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.782081842422485 seconds
19 rew tensor(0.8649, dtype=torch.float64) delta_t tensor(0.0697, dtype=torch.float64)
19 gae_duplicate tensor(-0.0216, dtype=torch.float64) tensor(-1.3825, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8354, dtype=torch.float64) delta_t tensor(0.1540, dtype=torch.float64)
18 gae_duplicate tensor(-0.0516, dtype=torch.float64) tensor(-3.1745, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8070, dtype=torch.float64) delta_t tensor(0.0552, dtype=torch.float64)
17 gae_duplicate tensor(0.0251, dtype=torch.float64) tensor(-1.4306, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5591, dtype=torch.float64) delta_t tensor(-0.0194, dtype=torch.float64)
16 gae_duplicate tensor(-0.0990, dtype=torch.float64) tensor(0.2608, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4739, dtype=torch.float64) delta_t tensor(-0.2026, dtype=torch.float64)
15 gae_duplicate tensor(-1.3091, dtype=torch.float64) tensor(3.7805, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4664, dtype=torch.float64) delta_t tensor(0.1516, dtype=torch.float64)
14 gae_duplicate tensor(-0.0272, dtype=torch.float64) tensor(-2.6442, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6339, dtype=torch.float64) delta_t tensor(0.0528, dtype=torch.float64)
13 gae_duplicate tensor(-0.0326, dtype=torch.float64) tensor(-1.1946, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3246, dtype=torch.float64) delta_t tensor(0.1931, dtype=torch.float64)
12 gae_duplicate tensor(-0.1285, dtype=torch.float64) tensor(-4.1876, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3695, dtype=torch.float64) delta_t tensor(-0.5841, dtype=torch.float64)
11 gae_duplicate tensor(-1.8511, dtype=torch.float64) tensor(11.1276, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6582, dtype=torch.float64) delta_t tensor(-0.1702, dtype=torch.float64)
10 gae_duplicate tensor(-0.7912, dtype=torch.float64) tensor(4.4027, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0727, dtype=torch.float64) delta_t tensor(-0.9003, dtype=torch.float64)
9 gae_duplicate tensor(-2.7758, dtype=torch.float64) tensor(18.6563, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2428, dtype=torch.float64) delta_t tensor(-0.6412, dtype=torch.float64)
8 gae_duplicate tensor(-2.8333, dtype=torch.float64) tensor(14.8623, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5740, dtype=torch.float64) delta_t tensor(0.2399, dtype=torch.float64)
7 gae_duplicate tensor(0.0412, dtype=torch.float64) tensor(-3.2966, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2576, dtype=torch.float64) delta_t tensor(0.3299, dtype=torch.float64)
6 gae_duplicate tensor(-0.4050, dtype=torch.float64) tensor(-6.6416, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3830, dtype=torch.float64) delta_t tensor(0.1691, dtype=torch.float64)
5 gae_duplicate tensor(-0.0745, dtype=torch.float64) tensor(-4.1904, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3066, dtype=torch.float64) delta_t tensor(-0.0787, dtype=torch.float64)
4 gae_duplicate tensor(-0.4333, dtype=torch.float64) tensor(0.8548, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5553, dtype=torch.float64) delta_t tensor(0.2171, dtype=torch.float64)
3 gae_duplicate tensor(0.0466, dtype=torch.float64) tensor(-4.2347, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5866, dtype=torch.float64) delta_t tensor(-0.2646, dtype=torch.float64)
2 gae_duplicate tensor(-0.3244, dtype=torch.float64) tensor(4.8540, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1522.4190673828125
value loss:61.484710693359375
entropies:354.26324462890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.74522590637207 seconds
19 rew tensor(0.8186, dtype=torch.float64) delta_t tensor(0.1680, dtype=torch.float64)
19 gae_duplicate tensor(0.0869, dtype=torch.float64) tensor(-3.2538, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7883, dtype=torch.float64) delta_t tensor(0.2213, dtype=torch.float64)
18 gae_duplicate tensor(0.1582, dtype=torch.float64) tensor(-4.7529, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7526, dtype=torch.float64) delta_t tensor(0.1806, dtype=torch.float64)
17 gae_duplicate tensor(0.1176, dtype=torch.float64) tensor(-3.9745, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5769, dtype=torch.float64) delta_t tensor(0.1628, dtype=torch.float64)
16 gae_duplicate tensor(0.0419, dtype=torch.float64) tensor(-3.5954, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6677, dtype=torch.float64) delta_t tensor(0.1548, dtype=torch.float64)
15 gae_duplicate tensor(0.0862, dtype=torch.float64) tensor(-3.3291, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4708, dtype=torch.float64) delta_t tensor(0.2275, dtype=torch.float64)
14 gae_duplicate tensor(0.0058, dtype=torch.float64) tensor(-4.9994, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6969, dtype=torch.float64) delta_t tensor(0.3483, dtype=torch.float64)
13 gae_duplicate tensor(0.2236, dtype=torch.float64) tensor(-7.2199, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3367, dtype=torch.float64) delta_t tensor(0.4303, dtype=torch.float64)
12 gae_duplicate tensor(0.0952, dtype=torch.float64) tensor(-9.3354, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1782, dtype=torch.float64) delta_t tensor(-0.1924, dtype=torch.float64)
11 gae_duplicate tensor(-1.1154, dtype=torch.float64) tensor(2.5869, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6863, dtype=torch.float64) delta_t tensor(-0.0631, dtype=torch.float64)
10 gae_duplicate tensor(-1.5493, dtype=torch.float64) tensor(1.5169, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5369, dtype=torch.float64) delta_t tensor(-0.1910, dtype=torch.float64)
9 gae_duplicate tensor(-0.9948, dtype=torch.float64) tensor(3.7464, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8269, dtype=torch.float64) delta_t tensor(-0.2104, dtype=torch.float64)
8 gae_duplicate tensor(-1.8006, dtype=torch.float64) tensor(5.0043, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1219, dtype=torch.float64) delta_t tensor(0.0050, dtype=torch.float64)
7 gae_duplicate tensor(-1.7393, dtype=torch.float64) tensor(0.3196, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3715, dtype=torch.float64) delta_t tensor(0.1078, dtype=torch.float64)
6 gae_duplicate tensor(-0.7499, dtype=torch.float64) tensor(-1.9729, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2796, dtype=torch.float64) delta_t tensor(0.2676, dtype=torch.float64)
5 gae_duplicate tensor(-0.0139, dtype=torch.float64) tensor(-5.3652, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1481, dtype=torch.float64) delta_t tensor(0.0359, dtype=torch.float64)
4 gae_duplicate tensor(-0.3968, dtype=torch.float64) tensor(-1.4997, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4037, dtype=torch.float64) delta_t tensor(0.2467, dtype=torch.float64)
3 gae_duplicate tensor(0.0190, dtype=torch.float64) tensor(-4.9705, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4708, dtype=torch.float64) delta_t tensor(-0.1455, dtype=torch.float64)
2 gae_duplicate tensor(-0.2250, dtype=torch.float64) tensor(2.3102, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1998.58984375
value loss:48.484825134277344
entropies:354.6801452636719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.94180703163147 seconds
19 rew tensor(0.8566, dtype=torch.float64) delta_t tensor(0.2798, dtype=torch.float64)
19 gae_duplicate tensor(0.1240, dtype=torch.float64) tensor(-5.5983, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8765, dtype=torch.float64) delta_t tensor(0.3477, dtype=torch.float64)
18 gae_duplicate tensor(0.3081, dtype=torch.float64) tensor(-7.4121, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(0.2782, dtype=torch.float64)
17 gae_duplicate tensor(0.2646, dtype=torch.float64) tensor(-6.2668, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6003, dtype=torch.float64) delta_t tensor(0.1631, dtype=torch.float64)
16 gae_duplicate tensor(0.0724, dtype=torch.float64) tensor(-3.8305, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7328, dtype=torch.float64) delta_t tensor(0.2801, dtype=torch.float64)
15 gae_duplicate tensor(0.1671, dtype=torch.float64) tensor(-5.8735, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4180, dtype=torch.float64) delta_t tensor(0.2096, dtype=torch.float64)
14 gae_duplicate tensor(0.1079, dtype=torch.float64) tensor(-4.6361, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5040, dtype=torch.float64) delta_t tensor(0.2081, dtype=torch.float64)
13 gae_duplicate tensor(-0.6956, dtype=torch.float64) tensor(-4.5684, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1340, dtype=torch.float64) delta_t tensor(0.0256, dtype=torch.float64)
12 gae_duplicate tensor(-1.6754, dtype=torch.float64) tensor(-0.7080, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3455, dtype=torch.float64) delta_t tensor(-0.0122, dtype=torch.float64)
11 gae_duplicate tensor(-1.1631, dtype=torch.float64) tensor(0.3201, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6602, dtype=torch.float64) delta_t tensor(-0.0470, dtype=torch.float64)
10 gae_duplicate tensor(-0.5641, dtype=torch.float64) tensor(0.5651, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3654, dtype=torch.float64) delta_t tensor(0.2074, dtype=torch.float64)
9 gae_duplicate tensor(-1.4255, dtype=torch.float64) tensor(-3.9984, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2383, dtype=torch.float64) delta_t tensor(-0.4820, dtype=torch.float64)
8 gae_duplicate tensor(-4.1631, dtype=torch.float64) tensor(10.1183, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0078, dtype=torch.float64) delta_t tensor(0.1652, dtype=torch.float64)
7 gae_duplicate tensor(-1.0308, dtype=torch.float64) tensor(-2.6947, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1793, dtype=torch.float64) delta_t tensor(0.3790, dtype=torch.float64)
6 gae_duplicate tensor(-0.0538, dtype=torch.float64) tensor(-7.6511, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3601, dtype=torch.float64) delta_t tensor(0.3461, dtype=torch.float64)
5 gae_duplicate tensor(0.2936, dtype=torch.float64) tensor(-7.4974, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0927, dtype=torch.float64) delta_t tensor(-0.0129, dtype=torch.float64)
4 gae_duplicate tensor(-0.2860, dtype=torch.float64) tensor(-0.5225, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4347, dtype=torch.float64) delta_t tensor(0.2598, dtype=torch.float64)
3 gae_duplicate tensor(0.0421, dtype=torch.float64) tensor(-5.2124, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4774, dtype=torch.float64) delta_t tensor(-0.1302, dtype=torch.float64)
2 gae_duplicate tensor(-0.2203, dtype=torch.float64) tensor(2.0396, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2789.222412109375
value loss:66.3782958984375
entropies:355.0044860839844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.483972787857056 seconds
19 rew tensor(0.8093, dtype=torch.float64) delta_t tensor(0.2238, dtype=torch.float64)
19 gae_duplicate tensor(0.1289, dtype=torch.float64) tensor(-4.5252, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8193, dtype=torch.float64) delta_t tensor(0.3001, dtype=torch.float64)
18 gae_duplicate tensor(0.2082, dtype=torch.float64) tensor(-6.3945, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7729, dtype=torch.float64) delta_t tensor(0.2727, dtype=torch.float64)
17 gae_duplicate tensor(0.1695, dtype=torch.float64) tensor(-6.0675, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7833, dtype=torch.float64) delta_t tensor(0.2739, dtype=torch.float64)
16 gae_duplicate tensor(0.1070, dtype=torch.float64) tensor(-6.0506, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6465, dtype=torch.float64) delta_t tensor(0.2162, dtype=torch.float64)
15 gae_duplicate tensor(0.0981, dtype=torch.float64) tensor(-4.7927, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5722, dtype=torch.float64) delta_t tensor(0.2091, dtype=torch.float64)
14 gae_duplicate tensor(0.1256, dtype=torch.float64) tensor(-4.8172, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6496, dtype=torch.float64) delta_t tensor(0.3591, dtype=torch.float64)
13 gae_duplicate tensor(0.0855, dtype=torch.float64) tensor(-7.4456, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4959, dtype=torch.float64) delta_t tensor(0.2133, dtype=torch.float64)
12 gae_duplicate tensor(0.0094, dtype=torch.float64) tensor(-4.8049, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2900, dtype=torch.float64) delta_t tensor(0.0937, dtype=torch.float64)
11 gae_duplicate tensor(-0.3176, dtype=torch.float64) tensor(-2.4451, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0369, dtype=torch.float64) delta_t tensor(0.3324, dtype=torch.float64)
10 gae_duplicate tensor(-0.3536, dtype=torch.float64) tensor(-6.9594, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6880, dtype=torch.float64) delta_t tensor(-1.0871, dtype=torch.float64)
9 gae_duplicate tensor(-2.4507, dtype=torch.float64) tensor(20.8928, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1355, dtype=torch.float64) delta_t tensor(-0.2987, dtype=torch.float64)
8 gae_duplicate tensor(-1.9525, dtype=torch.float64) tensor(8.2812, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9639, dtype=torch.float64) delta_t tensor(-0.7717, dtype=torch.float64)
7 gae_duplicate tensor(-2.8828, dtype=torch.float64) tensor(16.4894, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4681, dtype=torch.float64) delta_t tensor(-0.0686, dtype=torch.float64)
6 gae_duplicate tensor(-3.1121, dtype=torch.float64) tensor(3.5645, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0486, dtype=torch.float64) delta_t tensor(0.1108, dtype=torch.float64)
5 gae_duplicate tensor(-1.4430, dtype=torch.float64) tensor(-2.2625, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1507, dtype=torch.float64) delta_t tensor(0.1234, dtype=torch.float64)
4 gae_duplicate tensor(-0.2826, dtype=torch.float64) tensor(-2.5277, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2208, dtype=torch.float64) delta_t tensor(0.1314, dtype=torch.float64)
3 gae_duplicate tensor(-0.1866, dtype=torch.float64) tensor(-2.9352, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3417, dtype=torch.float64) delta_t tensor(-0.0640, dtype=torch.float64)
2 gae_duplicate tensor(-0.2269, dtype=torch.float64) tensor(0.9738, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:542.746337890625
value loss:87.08268737792969
entropies:355.1408996582031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.195330858230591 seconds
19 rew tensor(0.8683, dtype=torch.float64) delta_t tensor(0.2305, dtype=torch.float64)
19 gae_duplicate tensor(0.1024, dtype=torch.float64) tensor(-4.5930, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8390, dtype=torch.float64) delta_t tensor(0.2777, dtype=torch.float64)
18 gae_duplicate tensor(0.2147, dtype=torch.float64) tensor(-6.2116, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8109, dtype=torch.float64) delta_t tensor(0.2452, dtype=torch.float64)
17 gae_duplicate tensor(0.1880, dtype=torch.float64) tensor(-5.5161, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6181, dtype=torch.float64) delta_t tensor(0.1636, dtype=torch.float64)
16 gae_duplicate tensor(0.1218, dtype=torch.float64) tensor(-3.8169, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6668, dtype=torch.float64) delta_t tensor(0.2082, dtype=torch.float64)
15 gae_duplicate tensor(0.1101, dtype=torch.float64) tensor(-4.5564, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1964, dtype=torch.float64) delta_t tensor(-0.0971, dtype=torch.float64)
14 gae_duplicate tensor(-1.1596, dtype=torch.float64) tensor(1.2319, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5070, dtype=torch.float64) delta_t tensor(0.3248, dtype=torch.float64)
13 gae_duplicate tensor(-0.9423, dtype=torch.float64) tensor(-6.7803, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1365, dtype=torch.float64) delta_t tensor(-0.0742, dtype=torch.float64)
12 gae_duplicate tensor(-1.0903, dtype=torch.float64) tensor(0.8023, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0019, dtype=torch.float64) delta_t tensor(0.4561, dtype=torch.float64)
11 gae_duplicate tensor(-0.2143, dtype=torch.float64) tensor(-9.0076, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2414, dtype=torch.float64) delta_t tensor(0.2734, dtype=torch.float64)
10 gae_duplicate tensor(-0.5312, dtype=torch.float64) tensor(-6.0746, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1493, dtype=torch.float64) delta_t tensor(-0.5335, dtype=torch.float64)
9 gae_duplicate tensor(-3.6561, dtype=torch.float64) tensor(10.5229, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3932, dtype=torch.float64) delta_t tensor(-0.6332, dtype=torch.float64)
8 gae_duplicate tensor(-2.6365, dtype=torch.float64) tensor(14.0161, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5529, dtype=torch.float64) delta_t tensor(0.7217, dtype=torch.float64)
7 gae_duplicate tensor(0.2344, dtype=torch.float64) tensor(-12.7933, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2139, dtype=torch.float64) delta_t tensor(0.3398, dtype=torch.float64)
6 gae_duplicate tensor(-0.2492, dtype=torch.float64) tensor(-7.8905, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3125, dtype=torch.float64) delta_t tensor(0.2870, dtype=torch.float64)
5 gae_duplicate tensor(0.1794, dtype=torch.float64) tensor(-6.4737, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1368, dtype=torch.float64) delta_t tensor(-0.0288, dtype=torch.float64)
4 gae_duplicate tensor(-0.2471, dtype=torch.float64) tensor(-0.1214, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4391, dtype=torch.float64) delta_t tensor(0.2610, dtype=torch.float64)
3 gae_duplicate tensor(-0.0797, dtype=torch.float64) tensor(-5.2633, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4995, dtype=torch.float64) delta_t tensor(-0.1361, dtype=torch.float64)
2 gae_duplicate tensor(-0.2341, dtype=torch.float64) tensor(2.1627, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2623.66259765625
value loss:82.65349578857422
entropies:355.28802490234375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(4040.9004)
ToM Target loss= tensor(3619.3438)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.80122709274292 seconds
19 rew tensor(0.8488, dtype=torch.float64) delta_t tensor(0.0930, dtype=torch.float64)
19 gae_duplicate tensor(-0.0475, dtype=torch.float64) tensor(-1.8221, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8201, dtype=torch.float64) delta_t tensor(0.1426, dtype=torch.float64)
18 gae_duplicate tensor(0.0670, dtype=torch.float64) tensor(-3.0441, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7626, dtype=torch.float64) delta_t tensor(0.1095, dtype=torch.float64)
17 gae_duplicate tensor(0.0077, dtype=torch.float64) tensor(-2.4937, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6746, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
16 gae_duplicate tensor(-0.0238, dtype=torch.float64) tensor(-1.3429, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6755, dtype=torch.float64) delta_t tensor(0.1027, dtype=torch.float64)
15 gae_duplicate tensor(-0.0933, dtype=torch.float64) tensor(-2.1893, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3968, dtype=torch.float64) delta_t tensor(-0.1025, dtype=torch.float64)
14 gae_duplicate tensor(-0.9708, dtype=torch.float64) tensor(1.7075, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5513, dtype=torch.float64) delta_t tensor(0.2515, dtype=torch.float64)
13 gae_duplicate tensor(-0.2223, dtype=torch.float64) tensor(-4.6985, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5798, dtype=torch.float64) delta_t tensor(0.1413, dtype=torch.float64)
12 gae_duplicate tensor(-0.0642, dtype=torch.float64) tensor(-3.3487, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3812, dtype=torch.float64) delta_t tensor(-0.1323, dtype=torch.float64)
11 gae_duplicate tensor(-1.2227, dtype=torch.float64) tensor(2.3751, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3094, dtype=torch.float64) delta_t tensor(-0.1089, dtype=torch.float64)
10 gae_duplicate tensor(-1.4827, dtype=torch.float64) tensor(2.2036, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.5540, dtype=torch.float64) delta_t tensor(-1.9267, dtype=torch.float64)
9 gae_duplicate tensor(-4.7134, dtype=torch.float64) tensor(38.2124, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1129, dtype=torch.float64) delta_t tensor(-0.5711, dtype=torch.float64)
8 gae_duplicate tensor(-3.4554, dtype=torch.float64) tensor(14.8067, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8018, dtype=torch.float64) delta_t tensor(-0.3991, dtype=torch.float64)
7 gae_duplicate tensor(-2.9714, dtype=torch.float64) tensor(9.1590, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2954, dtype=torch.float64) delta_t tensor(-0.2256, dtype=torch.float64)
6 gae_duplicate tensor(-2.0983, dtype=torch.float64) tensor(5.4069, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0503, dtype=torch.float64) delta_t tensor(0.1391, dtype=torch.float64)
5 gae_duplicate tensor(-0.2892, dtype=torch.float64) tensor(-2.2315, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2295, dtype=torch.float64) delta_t tensor(0.1944, dtype=torch.float64)
4 gae_duplicate tensor(-0.3961, dtype=torch.float64) tensor(-4.1245, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1603, dtype=torch.float64) delta_t tensor(0.1132, dtype=torch.float64)
3 gae_duplicate tensor(-0.0575, dtype=torch.float64) tensor(-2.6315, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2982, dtype=torch.float64) delta_t tensor(-0.1405, dtype=torch.float64)
2 gae_duplicate tensor(-0.2757, dtype=torch.float64) tensor(2.5101, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2712.513671875
value loss:133.47349548339844
entropies:355.3711853027344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.722702980041504 seconds
19 rew tensor(0.7815, dtype=torch.float64) delta_t tensor(-0.0701, dtype=torch.float64)
19 gae_duplicate tensor(-0.1326, dtype=torch.float64) tensor(1.3631, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7906, dtype=torch.float64) delta_t tensor(0.0320, dtype=torch.float64)
18 gae_duplicate tensor(-0.0591, dtype=torch.float64) tensor(-0.4887, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5350, dtype=torch.float64) delta_t tensor(-0.2072, dtype=torch.float64)
17 gae_duplicate tensor(-1.2246, dtype=torch.float64) tensor(3.9396, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7422, dtype=torch.float64) delta_t tensor(0.0074, dtype=torch.float64)
16 gae_duplicate tensor(-0.0756, dtype=torch.float64) tensor(0.2453, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6189, dtype=torch.float64) delta_t tensor(-0.0537, dtype=torch.float64)
15 gae_duplicate tensor(-0.1465, dtype=torch.float64) tensor(1.0771, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6443, dtype=torch.float64) delta_t tensor(0.0261, dtype=torch.float64)
14 gae_duplicate tensor(-0.1143, dtype=torch.float64) tensor(-0.4381, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6306, dtype=torch.float64) delta_t tensor(0.1555, dtype=torch.float64)
13 gae_duplicate tensor(-0.1013, dtype=torch.float64) tensor(-3.0570, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2603, dtype=torch.float64) delta_t tensor(-0.2269, dtype=torch.float64)
12 gae_duplicate tensor(-1.3450, dtype=torch.float64) tensor(3.9731, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2006, dtype=torch.float64) delta_t tensor(0.1647, dtype=torch.float64)
11 gae_duplicate tensor(-0.2651, dtype=torch.float64) tensor(-2.9854, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1140, dtype=torch.float64) delta_t tensor(0.2636, dtype=torch.float64)
10 gae_duplicate tensor(-0.3999, dtype=torch.float64) tensor(-5.6592, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4744, dtype=torch.float64) delta_t tensor(-0.8964, dtype=torch.float64)
9 gae_duplicate tensor(-2.3400, dtype=torch.float64) tensor(17.5098, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2494, dtype=torch.float64) delta_t tensor(-0.7701, dtype=torch.float64)
8 gae_duplicate tensor(-4.1467, dtype=torch.float64) tensor(16.8447, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2773, dtype=torch.float64) delta_t tensor(0.0595, dtype=torch.float64)
7 gae_duplicate tensor(-2.7714, dtype=torch.float64) tensor(0.6659, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5713, dtype=torch.float64) delta_t tensor(-0.3571, dtype=torch.float64)
6 gae_duplicate tensor(-2.2894, dtype=torch.float64) tensor(7.1365, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9273, dtype=torch.float64) delta_t tensor(-0.9529, dtype=torch.float64)
5 gae_duplicate tensor(-3.7630, dtype=torch.float64) tensor(19.3826, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0836, dtype=torch.float64) delta_t tensor(-0.1154, dtype=torch.float64)
4 gae_duplicate tensor(-1.0768, dtype=torch.float64) tensor(4.2480, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0090, dtype=torch.float64) delta_t tensor(0.0537, dtype=torch.float64)
3 gae_duplicate tensor(-0.1250, dtype=torch.float64) tensor(-0.6382, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2035, dtype=torch.float64) delta_t tensor(-0.1279, dtype=torch.float64)
2 gae_duplicate tensor(-0.2357, dtype=torch.float64) tensor(2.5310, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3641.10693359375
value loss:127.04512023925781
entropies:355.544921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.833216905593872 seconds
19 rew tensor(0.8666, dtype=torch.float64) delta_t tensor(-0.0190, dtype=torch.float64)
19 gae_duplicate tensor(-0.1396, dtype=torch.float64) tensor(0.3712, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5936, dtype=torch.float64) delta_t tensor(-0.1888, dtype=torch.float64)
18 gae_duplicate tensor(-1.2366, dtype=torch.float64) tensor(3.7869, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8287, dtype=torch.float64) delta_t tensor(0.0171, dtype=torch.float64)
17 gae_duplicate tensor(-0.0526, dtype=torch.float64) tensor(0.0399, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6380, dtype=torch.float64) delta_t tensor(-0.0956, dtype=torch.float64)
16 gae_duplicate tensor(-0.1939, dtype=torch.float64) tensor(1.8927, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5651, dtype=torch.float64) delta_t tensor(-0.1666, dtype=torch.float64)
15 gae_duplicate tensor(-1.0849, dtype=torch.float64) tensor(3.4098, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3484, dtype=torch.float64) delta_t tensor(-0.2324, dtype=torch.float64)
14 gae_duplicate tensor(-1.3928, dtype=torch.float64) tensor(4.9691, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7059, dtype=torch.float64) delta_t tensor(0.2383, dtype=torch.float64)
13 gae_duplicate tensor(-0.0933, dtype=torch.float64) tensor(-4.2524, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4770, dtype=torch.float64) delta_t tensor(0.0498, dtype=torch.float64)
12 gae_duplicate tensor(-0.3372, dtype=torch.float64) tensor(-1.3085, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5370, dtype=torch.float64) delta_t tensor(-0.5033, dtype=torch.float64)
11 gae_duplicate tensor(-1.5316, dtype=torch.float64) tensor(9.8040, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2008, dtype=torch.float64) delta_t tensor(0.1812, dtype=torch.float64)
10 gae_duplicate tensor(-0.2404, dtype=torch.float64) tensor(-2.5750, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7887, dtype=torch.float64) delta_t tensor(-0.4418, dtype=torch.float64)
9 gae_duplicate tensor(-3.7143, dtype=torch.float64) tensor(8.2413, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1101, dtype=torch.float64) delta_t tensor(-0.8293, dtype=torch.float64)
8 gae_duplicate tensor(-3.7035, dtype=torch.float64) tensor(17.9410, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0356, dtype=torch.float64) delta_t tensor(0.1151, dtype=torch.float64)
7 gae_duplicate tensor(-0.6872, dtype=torch.float64) tensor(-0.4872, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1393, dtype=torch.float64) delta_t tensor(0.1719, dtype=torch.float64)
6 gae_duplicate tensor(-0.3561, dtype=torch.float64) tensor(-3.4116, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0340, dtype=torch.float64) delta_t tensor(0.0078, dtype=torch.float64)
5 gae_duplicate tensor(-0.7362, dtype=torch.float64) tensor(-0.4898, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1203, dtype=torch.float64) delta_t tensor(0.0150, dtype=torch.float64)
4 gae_duplicate tensor(-0.4806, dtype=torch.float64) tensor(-0.3487, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1922, dtype=torch.float64) delta_t tensor(0.0020, dtype=torch.float64)
3 gae_duplicate tensor(-0.2261, dtype=torch.float64) tensor(-0.1153, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4201, dtype=torch.float64) delta_t tensor(-0.1739, dtype=torch.float64)
2 gae_duplicate tensor(-0.3298, dtype=torch.float64) tensor(3.4271, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2304.34716796875
value loss:76.44584655761719
entropies:355.7369689941406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.645106315612793 seconds
19 rew tensor(0.8179, dtype=torch.float64) delta_t tensor(-0.1450, dtype=torch.float64)
19 gae_duplicate tensor(-0.2207, dtype=torch.float64) tensor(2.8625, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7331, dtype=torch.float64) delta_t tensor(-0.0916, dtype=torch.float64)
18 gae_duplicate tensor(-0.1708, dtype=torch.float64) tensor(2.0899, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5613, dtype=torch.float64) delta_t tensor(-0.2888, dtype=torch.float64)
17 gae_duplicate tensor(-1.2456, dtype=torch.float64) tensor(5.9039, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6965, dtype=torch.float64) delta_t tensor(-0.1046, dtype=torch.float64)
16 gae_duplicate tensor(-0.3375, dtype=torch.float64) tensor(2.6357, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6284, dtype=torch.float64) delta_t tensor(-0.1142, dtype=torch.float64)
15 gae_duplicate tensor(-0.3153, dtype=torch.float64) tensor(2.5165, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4286, dtype=torch.float64) delta_t tensor(-0.2512, dtype=torch.float64)
14 gae_duplicate tensor(-1.1956, dtype=torch.float64) tensor(5.1333, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4254, dtype=torch.float64) delta_t tensor(-0.1490, dtype=torch.float64)
13 gae_duplicate tensor(-1.2072, dtype=torch.float64) tensor(3.5299, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5661, dtype=torch.float64) delta_t tensor(-0.0710, dtype=torch.float64)
12 gae_duplicate tensor(-0.2762, dtype=torch.float64) tensor(1.7582, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4029, dtype=torch.float64) delta_t tensor(-0.7620, dtype=torch.float64)
11 gae_duplicate tensor(-2.2316, dtype=torch.float64) tensor(15.2177, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0349, dtype=torch.float64) delta_t tensor(-0.2133, dtype=torch.float64)
10 gae_duplicate tensor(-2.4740, dtype=torch.float64) tensor(5.7559, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.2229, dtype=torch.float64) delta_t tensor(-1.8553, dtype=torch.float64)
9 gae_duplicate tensor(-4.7777, dtype=torch.float64) tensor(37.0694, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0532, dtype=torch.float64) delta_t tensor(-0.5322, dtype=torch.float64)
8 gae_duplicate tensor(-4.2211, dtype=torch.float64) tensor(14.3028, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1669, dtype=torch.float64) delta_t tensor(-0.0327, dtype=torch.float64)
7 gae_duplicate tensor(-1.9001, dtype=torch.float64) tensor(2.2366, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5695, dtype=torch.float64) delta_t tensor(-0.3290, dtype=torch.float64)
6 gae_duplicate tensor(-2.8331, dtype=torch.float64) tensor(6.7289, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3258, dtype=torch.float64) delta_t tensor(-0.6462, dtype=torch.float64)
5 gae_duplicate tensor(-3.1217, dtype=torch.float64) tensor(13.1616, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2894, dtype=torch.float64) delta_t tensor(0.2179, dtype=torch.float64)
4 gae_duplicate tensor(-0.1798, dtype=torch.float64) tensor(-2.9604, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1793, dtype=torch.float64) delta_t tensor(-0.0716, dtype=torch.float64)
3 gae_duplicate tensor(-0.3314, dtype=torch.float64) tensor(1.1045, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3566, dtype=torch.float64) delta_t tensor(-0.1853, dtype=torch.float64)
2 gae_duplicate tensor(-0.4118, dtype=torch.float64) tensor(3.7873, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6729.1298828125
value loss:185.37782287597656
entropies:355.820556640625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.92043399810791 seconds
19 rew tensor(0.8666, dtype=torch.float64) delta_t tensor(-0.0179, dtype=torch.float64)
19 gae_duplicate tensor(-0.1310, dtype=torch.float64) tensor(0.3542, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8668, dtype=torch.float64) delta_t tensor(0.0776, dtype=torch.float64)
18 gae_duplicate tensor(0.0117, dtype=torch.float64) tensor(-1.4984, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8479, dtype=torch.float64) delta_t tensor(0.0860, dtype=torch.float64)
17 gae_duplicate tensor(0.0024, dtype=torch.float64) tensor(-1.8385, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6663, dtype=torch.float64) delta_t tensor(-0.0213, dtype=torch.float64)
16 gae_duplicate tensor(-0.0640, dtype=torch.float64) tensor(0.2422, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6269, dtype=torch.float64) delta_t tensor(-0.0601, dtype=torch.float64)
15 gae_duplicate tensor(-0.1070, dtype=torch.float64) tensor(1.2081, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2503, dtype=torch.float64) delta_t tensor(-0.2687, dtype=torch.float64)
14 gae_duplicate tensor(-1.2696, dtype=torch.float64) tensor(5.4523, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4895, dtype=torch.float64) delta_t tensor(-0.0117, dtype=torch.float64)
13 gae_duplicate tensor(-1.0141, dtype=torch.float64) tensor(0.7280, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1017, dtype=torch.float64) delta_t tensor(-0.2023, dtype=torch.float64)
12 gae_duplicate tensor(-1.2406, dtype=torch.float64) tensor(4.0333, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3890, dtype=torch.float64) delta_t tensor(-0.3329, dtype=torch.float64)
11 gae_duplicate tensor(-2.2996, dtype=torch.float64) tensor(6.9046, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0100, dtype=torch.float64) delta_t tensor(0.4280, dtype=torch.float64)
10 gae_duplicate tensor(-0.4082, dtype=torch.float64) tensor(-7.8647, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1585, dtype=torch.float64) delta_t tensor(0.2859, dtype=torch.float64)
9 gae_duplicate tensor(-1.1545, dtype=torch.float64) tensor(-6.3262, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9577, dtype=torch.float64) delta_t tensor(-0.3413, dtype=torch.float64)
8 gae_duplicate tensor(-3.0716, dtype=torch.float64) tensor(6.0430, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3013, dtype=torch.float64) delta_t tensor(0.1468, dtype=torch.float64)
7 gae_duplicate tensor(-1.0856, dtype=torch.float64) tensor(-2.3060, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6223, dtype=torch.float64) delta_t tensor(-0.1856, dtype=torch.float64)
6 gae_duplicate tensor(-2.3563, dtype=torch.float64) tensor(3.3941, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1942, dtype=torch.float64) delta_t tensor(-0.0759, dtype=torch.float64)
5 gae_duplicate tensor(-1.0674, dtype=torch.float64) tensor(1.8278, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1374, dtype=torch.float64) delta_t tensor(-0.0672, dtype=torch.float64)
4 gae_duplicate tensor(-0.3953, dtype=torch.float64) tensor(1.5292, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2594, dtype=torch.float64) delta_t tensor(0.1197, dtype=torch.float64)
3 gae_duplicate tensor(-0.3796, dtype=torch.float64) tensor(-2.2101, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3679, dtype=torch.float64) delta_t tensor(-0.1445, dtype=torch.float64)
2 gae_duplicate tensor(-0.2619, dtype=torch.float64) tensor(2.6515, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-761.6136474609375
value loss:67.51425170898438
entropies:355.9114074707031
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(4061.9631)
ToM Target loss= tensor(3607.8557)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.8385138511657715 seconds
19 rew tensor(0.8664, dtype=torch.float64) delta_t tensor(0.0725, dtype=torch.float64)
19 gae_duplicate tensor(-0.0683, dtype=torch.float64) tensor(-1.4369, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8182, dtype=torch.float64) delta_t tensor(0.1036, dtype=torch.float64)
18 gae_duplicate tensor(0.0349, dtype=torch.float64) tensor(-2.1940, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8295, dtype=torch.float64) delta_t tensor(0.1466, dtype=torch.float64)
17 gae_duplicate tensor(0.0537, dtype=torch.float64) tensor(-3.1226, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6303, dtype=torch.float64) delta_t tensor(0.0138, dtype=torch.float64)
16 gae_duplicate tensor(-0.0888, dtype=torch.float64) tensor(-0.5872, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4046, dtype=torch.float64) delta_t tensor(-0.2212, dtype=torch.float64)
15 gae_duplicate tensor(-1.2900, dtype=torch.float64) tensor(4.3033, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2968, dtype=torch.float64) delta_t tensor(-0.2086, dtype=torch.float64)
14 gae_duplicate tensor(-1.1890, dtype=torch.float64) tensor(4.5423, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5867, dtype=torch.float64) delta_t tensor(0.0619, dtype=torch.float64)
13 gae_duplicate tensor(-0.1564, dtype=torch.float64) tensor(-0.7656, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4214, dtype=torch.float64) delta_t tensor(0.0088, dtype=torch.float64)
12 gae_duplicate tensor(-0.1079, dtype=torch.float64) tensor(-0.2489, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0087, dtype=torch.float64) delta_t tensor(-0.0805, dtype=torch.float64)
11 gae_duplicate tensor(-0.9597, dtype=torch.float64) tensor(1.5852, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3314, dtype=torch.float64) delta_t tensor(-0.0296, dtype=torch.float64)
10 gae_duplicate tensor(-1.2723, dtype=torch.float64) tensor(0.7453, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.8334, dtype=torch.float64) delta_t tensor(-1.2948, dtype=torch.float64)
9 gae_duplicate tensor(-2.3621, dtype=torch.float64) tensor(25.6387, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5579, dtype=torch.float64) delta_t tensor(-0.5128, dtype=torch.float64)
8 gae_duplicate tensor(-3.8555, dtype=torch.float64) tensor(12.7338, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7747, dtype=torch.float64) delta_t tensor(-0.7384, dtype=torch.float64)
7 gae_duplicate tensor(-3.6240, dtype=torch.float64) tensor(15.8849, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2491, dtype=torch.float64) delta_t tensor(0.0274, dtype=torch.float64)
6 gae_duplicate tensor(-1.4055, dtype=torch.float64) tensor(1.0421, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0470, dtype=torch.float64) delta_t tensor(-0.0326, dtype=torch.float64)
5 gae_duplicate tensor(-1.0518, dtype=torch.float64) tensor(0.7521, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0113, dtype=torch.float64) delta_t tensor(0.1260, dtype=torch.float64)
4 gae_duplicate tensor(-0.3893, dtype=torch.float64) tensor(-2.4165, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0470, dtype=torch.float64) delta_t tensor(0.0227, dtype=torch.float64)
3 gae_duplicate tensor(-0.4366, dtype=torch.float64) tensor(-0.6883, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2270, dtype=torch.float64) delta_t tensor(-0.0678, dtype=torch.float64)
2 gae_duplicate tensor(-0.2468, dtype=torch.float64) tensor(1.2718, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3176.2509765625
value loss:95.52149200439453
entropies:355.9488220214844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.762516975402832 seconds
19 rew tensor(0.8570, dtype=torch.float64) delta_t tensor(0.0843, dtype=torch.float64)
19 gae_duplicate tensor(-0.0194, dtype=torch.float64) tensor(-1.6631, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7600, dtype=torch.float64) delta_t tensor(0.0988, dtype=torch.float64)
18 gae_duplicate tensor(0.0576, dtype=torch.float64) tensor(-2.1153, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7524, dtype=torch.float64) delta_t tensor(0.1187, dtype=torch.float64)
17 gae_duplicate tensor(0.0680, dtype=torch.float64) tensor(-2.5728, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6935, dtype=torch.float64) delta_t tensor(0.0988, dtype=torch.float64)
16 gae_duplicate tensor(0.0784, dtype=torch.float64) tensor(-2.1869, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3495, dtype=torch.float64) delta_t tensor(-0.1737, dtype=torch.float64)
15 gae_duplicate tensor(-1.1955, dtype=torch.float64) tensor(3.2137, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2085, dtype=torch.float64) delta_t tensor(-0.2356, dtype=torch.float64)
14 gae_duplicate tensor(-1.0509, dtype=torch.float64) tensor(5.0604, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5807, dtype=torch.float64) delta_t tensor(0.1548, dtype=torch.float64)
13 gae_duplicate tensor(-0.1582, dtype=torch.float64) tensor(-2.5062, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4638, dtype=torch.float64) delta_t tensor(0.1143, dtype=torch.float64)
12 gae_duplicate tensor(-0.1179, dtype=torch.float64) tensor(-2.5057, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4665, dtype=torch.float64) delta_t tensor(0.0340, dtype=torch.float64)
11 gae_duplicate tensor(-1.0483, dtype=torch.float64) tensor(-0.8797, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1063, dtype=torch.float64) delta_t tensor(0.2582, dtype=torch.float64)
10 gae_duplicate tensor(-1.1502, dtype=torch.float64) tensor(-5.2483, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.1323, dtype=torch.float64) delta_t tensor(-1.3726, dtype=torch.float64)
9 gae_duplicate tensor(-4.4032, dtype=torch.float64) tensor(26.7510, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.5809, dtype=torch.float64) delta_t tensor(-1.8429, dtype=torch.float64)
8 gae_duplicate tensor(-3.5973, dtype=torch.float64) tensor(39.1566, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0521, dtype=torch.float64) delta_t tensor(0.2643, dtype=torch.float64)
7 gae_duplicate tensor(-2.2129, dtype=torch.float64) tensor(-1.3491, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1396, dtype=torch.float64) delta_t tensor(0.6187, dtype=torch.float64)
6 gae_duplicate tensor(-0.4087, dtype=torch.float64) tensor(-12.3302, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1946, dtype=torch.float64) delta_t tensor(0.3976, dtype=torch.float64)
5 gae_duplicate tensor(0.2688, dtype=torch.float64) tensor(-9.1051, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1783, dtype=torch.float64) delta_t tensor(0.2745, dtype=torch.float64)
4 gae_duplicate tensor(0.1812, dtype=torch.float64) tensor(-6.3490, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2424, dtype=torch.float64) delta_t tensor(0.1509, dtype=torch.float64)
3 gae_duplicate tensor(0.0228, dtype=torch.float64) tensor(-3.5952, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3700, dtype=torch.float64) delta_t tensor(-0.0610, dtype=torch.float64)
2 gae_duplicate tensor(-0.1366, dtype=torch.float64) tensor(0.8565, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1318.1922607421875
value loss:133.44540405273438
entropies:355.871826171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.12293815612793 seconds
19 rew tensor(0.8851, dtype=torch.float64) delta_t tensor(0.2190, dtype=torch.float64)
19 gae_duplicate tensor(0.1909, dtype=torch.float64) tensor(-4.3709, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8284, dtype=torch.float64) delta_t tensor(0.2333, dtype=torch.float64)
18 gae_duplicate tensor(0.1486, dtype=torch.float64) tensor(-5.0643, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7604, dtype=torch.float64) delta_t tensor(0.2030, dtype=torch.float64)
17 gae_duplicate tensor(0.1490, dtype=torch.float64) tensor(-4.4870, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6753, dtype=torch.float64) delta_t tensor(0.1470, dtype=torch.float64)
16 gae_duplicate tensor(0.0738, dtype=torch.float64) tensor(-3.3093, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4560, dtype=torch.float64) delta_t tensor(-0.0412, dtype=torch.float64)
15 gae_duplicate tensor(-1.1036, dtype=torch.float64) tensor(0.3341, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4096, dtype=torch.float64) delta_t tensor(-0.0150, dtype=torch.float64)
14 gae_duplicate tensor(-0.8585, dtype=torch.float64) tensor(0.4086, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4757, dtype=torch.float64) delta_t tensor(0.1202, dtype=torch.float64)
13 gae_duplicate tensor(-0.0691, dtype=torch.float64) tensor(-2.3528, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5588, dtype=torch.float64) delta_t tensor(0.2927, dtype=torch.float64)
12 gae_duplicate tensor(0.1903, dtype=torch.float64) tensor(-6.0065, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2830, dtype=torch.float64) delta_t tensor(0.1420, dtype=torch.float64)
11 gae_duplicate tensor(-1.0149, dtype=torch.float64) tensor(-3.1458, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3679, dtype=torch.float64) delta_t tensor(0.5674, dtype=torch.float64)
10 gae_duplicate tensor(0.2778, dtype=torch.float64) tensor(-11.4530, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3242, dtype=torch.float64) delta_t tensor(-0.6131, dtype=torch.float64)
9 gae_duplicate tensor(-2.1295, dtype=torch.float64) tensor(10.5380, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.8355, dtype=torch.float64) delta_t tensor(-1.0431, dtype=torch.float64)
8 gae_duplicate tensor(-3.6599, dtype=torch.float64) tensor(22.2534, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0189, dtype=torch.float64) delta_t tensor(0.3939, dtype=torch.float64)
7 gae_duplicate tensor(-1.4187, dtype=torch.float64) tensor(-5.6824, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3041, dtype=torch.float64) delta_t tensor(0.2019, dtype=torch.float64)
6 gae_duplicate tensor(-2.2382, dtype=torch.float64) tensor(-4.1317, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0927, dtype=torch.float64) delta_t tensor(0.3031, dtype=torch.float64)
5 gae_duplicate tensor(-0.1140, dtype=torch.float64) tensor(-6.4923, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1439, dtype=torch.float64) delta_t tensor(0.2080, dtype=torch.float64)
4 gae_duplicate tensor(-0.1103, dtype=torch.float64) tensor(-4.7294, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1124, dtype=torch.float64) delta_t tensor(0.2219, dtype=torch.float64)
3 gae_duplicate tensor(0.1739, dtype=torch.float64) tensor(-4.8101, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2957, dtype=torch.float64) delta_t tensor(0.0351, dtype=torch.float64)
2 gae_duplicate tensor(-0.0520, dtype=torch.float64) tensor(-1.1501, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1721.1600341796875
value loss:86.36537170410156
entropies:355.6114807128906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.591829061508179 seconds
19 rew tensor(0.6288, dtype=torch.float64) delta_t tensor(-0.0124, dtype=torch.float64)
19 gae_duplicate tensor(-1.0020, dtype=torch.float64) tensor(0.0206, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7988, dtype=torch.float64) delta_t tensor(0.2395, dtype=torch.float64)
18 gae_duplicate tensor(0.0666, dtype=torch.float64) tensor(-4.7787, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7702, dtype=torch.float64) delta_t tensor(0.2472, dtype=torch.float64)
17 gae_duplicate tensor(0.2173, dtype=torch.float64) tensor(-5.4393, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7610, dtype=torch.float64) delta_t tensor(0.2653, dtype=torch.float64)
16 gae_duplicate tensor(0.2324, dtype=torch.float64) tensor(-5.8069, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6169, dtype=torch.float64) delta_t tensor(0.1622, dtype=torch.float64)
15 gae_duplicate tensor(0.1002, dtype=torch.float64) tensor(-3.7459, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2440, dtype=torch.float64) delta_t tensor(-0.1186, dtype=torch.float64)
14 gae_duplicate tensor(-0.8979, dtype=torch.float64) tensor(2.0728, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6173, dtype=torch.float64) delta_t tensor(0.2028, dtype=torch.float64)
13 gae_duplicate tensor(-0.0465, dtype=torch.float64) tensor(-3.8567, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5127, dtype=torch.float64) delta_t tensor(0.2258, dtype=torch.float64)
12 gae_duplicate tensor(0.1448, dtype=torch.float64) tensor(-4.9524, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3470, dtype=torch.float64) delta_t tensor(-0.3182, dtype=torch.float64)
11 gae_duplicate tensor(-1.7406, dtype=torch.float64) tensor(6.0020, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3692, dtype=torch.float64) delta_t tensor(0.7952, dtype=torch.float64)
10 gae_duplicate tensor(0.4144, dtype=torch.float64) tensor(-14.9486, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8434, dtype=torch.float64) delta_t tensor(-0.3012, dtype=torch.float64)
9 gae_duplicate tensor(-3.0936, dtype=torch.float64) tensor(4.3659, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6237, dtype=torch.float64) delta_t tensor(-0.9979, dtype=torch.float64)
8 gae_duplicate tensor(-2.7068, dtype=torch.float64) tensor(20.3905, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5505, dtype=torch.float64) delta_t tensor(-0.2445, dtype=torch.float64)
7 gae_duplicate tensor(-2.6214, dtype=torch.float64) tensor(6.1380, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2812, dtype=torch.float64) delta_t tensor(0.3115, dtype=torch.float64)
6 gae_duplicate tensor(-2.1729, dtype=torch.float64) tensor(-4.9972, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1852, dtype=torch.float64) delta_t tensor(0.4310, dtype=torch.float64)
5 gae_duplicate tensor(-0.1569, dtype=torch.float64) tensor(-9.2659, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1792, dtype=torch.float64) delta_t tensor(0.2190, dtype=torch.float64)
4 gae_duplicate tensor(-0.1948, dtype=torch.float64) tensor(-5.1682, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1272, dtype=torch.float64) delta_t tensor(0.2197, dtype=torch.float64)
3 gae_duplicate tensor(0.1679, dtype=torch.float64) tensor(-4.8852, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2631, dtype=torch.float64) delta_t tensor(0.0429, dtype=torch.float64)
2 gae_duplicate tensor(-0.0720, dtype=torch.float64) tensor(-1.3553, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1535.500244140625
value loss:92.92410278320312
entropies:355.1022644042969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.663683891296387 seconds
19 rew tensor(0.8670, dtype=torch.float64) delta_t tensor(0.2353, dtype=torch.float64)
19 gae_duplicate tensor(0.1083, dtype=torch.float64) tensor(-4.6366, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6483, dtype=torch.float64) delta_t tensor(0.1047, dtype=torch.float64)
18 gae_duplicate tensor(-0.9518, dtype=torch.float64) tensor(-2.3259, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8576, dtype=torch.float64) delta_t tensor(0.3003, dtype=torch.float64)
17 gae_duplicate tensor(0.2263, dtype=torch.float64) tensor(-6.1398, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6458, dtype=torch.float64) delta_t tensor(0.2107, dtype=torch.float64)
16 gae_duplicate tensor(0.1987, dtype=torch.float64) tensor(-4.8058, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5329, dtype=torch.float64) delta_t tensor(0.0612, dtype=torch.float64)
15 gae_duplicate tensor(-0.7676, dtype=torch.float64) tensor(-1.7555, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0640, dtype=torch.float64) delta_t tensor(-0.2083, dtype=torch.float64)
14 gae_duplicate tensor(-1.1503, dtype=torch.float64) tensor(3.9353, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1733, dtype=torch.float64) delta_t tensor(-0.2715, dtype=torch.float64)
13 gae_duplicate tensor(-1.0252, dtype=torch.float64) tensor(6.0704, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3765, dtype=torch.float64) delta_t tensor(0.2380, dtype=torch.float64)
12 gae_duplicate tensor(0.0991, dtype=torch.float64) tensor(-4.0480, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4157, dtype=torch.float64) delta_t tensor(0.6341, dtype=torch.float64)
11 gae_duplicate tensor(0.1608, dtype=torch.float64) tensor(-13.1533, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4551, dtype=torch.float64) delta_t tensor(0.0129, dtype=torch.float64)
10 gae_duplicate tensor(-1.5622, dtype=torch.float64) tensor(-1.2178, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1472, dtype=torch.float64) delta_t tensor(-0.4067, dtype=torch.float64)
9 gae_duplicate tensor(-2.1316, dtype=torch.float64) tensor(7.7292, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8562, dtype=torch.float64) delta_t tensor(-0.1541, dtype=torch.float64)
8 gae_duplicate tensor(-2.2035, dtype=torch.float64) tensor(4.3249, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1836, dtype=torch.float64) delta_t tensor(0.4787, dtype=torch.float64)
7 gae_duplicate tensor(-1.3628, dtype=torch.float64) tensor(-9.5275, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0870, dtype=torch.float64) delta_t tensor(0.5512, dtype=torch.float64)
6 gae_duplicate tensor(0.0431, dtype=torch.float64) tensor(-11.4697, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3158, dtype=torch.float64) delta_t tensor(0.3831, dtype=torch.float64)
5 gae_duplicate tensor(0.2977, dtype=torch.float64) tensor(-8.7667, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0581, dtype=torch.float64) delta_t tensor(0.0827, dtype=torch.float64)
4 gae_duplicate tensor(-0.1864, dtype=torch.float64) tensor(-2.4365, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3999, dtype=torch.float64) delta_t tensor(0.2862, dtype=torch.float64)
3 gae_duplicate tensor(0.1470, dtype=torch.float64) tensor(-5.7178, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4679, dtype=torch.float64) delta_t tensor(0.0491, dtype=torch.float64)
2 gae_duplicate tensor(-0.0307, dtype=torch.float64) tensor(-1.5337, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2899.8994140625
value loss:70.48770904541016
entropies:354.60565185546875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(4038.7197)
ToM Target loss= tensor(3595.2839)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.687439203262329 seconds
19 rew tensor(0.8279, dtype=torch.float64) delta_t tensor(0.1313, dtype=torch.float64)
19 gae_duplicate tensor(0.0368, dtype=torch.float64) tensor(-2.5887, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8289, dtype=torch.float64) delta_t tensor(0.2006, dtype=torch.float64)
18 gae_duplicate tensor(0.1234, dtype=torch.float64) tensor(-4.2568, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7905, dtype=torch.float64) delta_t tensor(0.1751, dtype=torch.float64)
17 gae_duplicate tensor(0.1086, dtype=torch.float64) tensor(-4.0577, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7039, dtype=torch.float64) delta_t tensor(0.1482, dtype=torch.float64)
16 gae_duplicate tensor(0.0583, dtype=torch.float64) tensor(-3.1344, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6464, dtype=torch.float64) delta_t tensor(0.1225, dtype=torch.float64)
15 gae_duplicate tensor(0.0808, dtype=torch.float64) tensor(-2.7638, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5406, dtype=torch.float64) delta_t tensor(0.1564, dtype=torch.float64)
14 gae_duplicate tensor(0.0498, dtype=torch.float64) tensor(-3.3950, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4642, dtype=torch.float64) delta_t tensor(0.0124, dtype=torch.float64)
13 gae_duplicate tensor(-0.9597, dtype=torch.float64) tensor(-0.7602, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4321, dtype=torch.float64) delta_t tensor(0.1809, dtype=torch.float64)
12 gae_duplicate tensor(-0.0683, dtype=torch.float64) tensor(-3.6103, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2368, dtype=torch.float64) delta_t tensor(-0.0084, dtype=torch.float64)
11 gae_duplicate tensor(-1.0765, dtype=torch.float64) tensor(-0.3227, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3841, dtype=torch.float64) delta_t tensor(-0.1852, dtype=torch.float64)
10 gae_duplicate tensor(-2.1956, dtype=torch.float64) tensor(4.2483, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0247, dtype=torch.float64) delta_t tensor(-0.2465, dtype=torch.float64)
9 gae_duplicate tensor(-3.1445, dtype=torch.float64) tensor(4.2110, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3741, dtype=torch.float64) delta_t tensor(-0.5195, dtype=torch.float64)
8 gae_duplicate tensor(-2.7693, dtype=torch.float64) tensor(12.5429, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1105, dtype=torch.float64) delta_t tensor(0.2025, dtype=torch.float64)
7 gae_duplicate tensor(-1.4574, dtype=torch.float64) tensor(-2.9263, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0311, dtype=torch.float64) delta_t tensor(0.5318, dtype=torch.float64)
6 gae_duplicate tensor(-0.0992, dtype=torch.float64) tensor(-11.0790, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2970, dtype=torch.float64) delta_t tensor(0.3820, dtype=torch.float64)
5 gae_duplicate tensor(0.2104, dtype=torch.float64) tensor(-8.6643, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0205, dtype=torch.float64) delta_t tensor(0.2067, dtype=torch.float64)
4 gae_duplicate tensor(-0.1618, dtype=torch.float64) tensor(-4.5601, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3804, dtype=torch.float64) delta_t tensor(0.2084, dtype=torch.float64)
3 gae_duplicate tensor(0.1201, dtype=torch.float64) tensor(-4.5607, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4500, dtype=torch.float64) delta_t tensor(-0.0106, dtype=torch.float64)
2 gae_duplicate tensor(-0.1197, dtype=torch.float64) tensor(-0.2575, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1844.957275390625
value loss:84.89839172363281
entropies:353.8839416503906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.730926752090454 seconds
19 rew tensor(0.8858, dtype=torch.float64) delta_t tensor(0.0730, dtype=torch.float64)
19 gae_duplicate tensor(0.0332, dtype=torch.float64) tensor(-1.5155, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8091, dtype=torch.float64) delta_t tensor(0.1015, dtype=torch.float64)
18 gae_duplicate tensor(0.0178, dtype=torch.float64) tensor(-2.0371, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7434, dtype=torch.float64) delta_t tensor(0.0848, dtype=torch.float64)
17 gae_duplicate tensor(0.0085, dtype=torch.float64) tensor(-1.7740, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7413, dtype=torch.float64) delta_t tensor(0.1138, dtype=torch.float64)
16 gae_duplicate tensor(-0.0182, dtype=torch.float64) tensor(-2.4441, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5880, dtype=torch.float64) delta_t tensor(0.0928, dtype=torch.float64)
15 gae_duplicate tensor(0.0098, dtype=torch.float64) tensor(-2.0199, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6046, dtype=torch.float64) delta_t tensor(0.1511, dtype=torch.float64)
14 gae_duplicate tensor(0.0677, dtype=torch.float64) tensor(-3.1918, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4976, dtype=torch.float64) delta_t tensor(0.2556, dtype=torch.float64)
13 gae_duplicate tensor(-0.0349, dtype=torch.float64) tensor(-4.9985, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3636, dtype=torch.float64) delta_t tensor(-0.0052, dtype=torch.float64)
12 gae_duplicate tensor(-0.8771, dtype=torch.float64) tensor(-0.3223, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8186, dtype=torch.float64) delta_t tensor(-0.6159, dtype=torch.float64)
11 gae_duplicate tensor(-1.4128, dtype=torch.float64) tensor(12.3619, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0123, dtype=torch.float64) delta_t tensor(0.6043, dtype=torch.float64)
10 gae_duplicate tensor(-0.3605, dtype=torch.float64) tensor(-10.6725, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9762, dtype=torch.float64) delta_t tensor(-0.2151, dtype=torch.float64)
9 gae_duplicate tensor(-3.1355, dtype=torch.float64) tensor(3.0638, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5687, dtype=torch.float64) delta_t tensor(-0.5064, dtype=torch.float64)
8 gae_duplicate tensor(-2.5714, dtype=torch.float64) tensor(10.3261, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7935, dtype=torch.float64) delta_t tensor(-1.0807, dtype=torch.float64)
7 gae_duplicate tensor(-2.6599, dtype=torch.float64) tensor(22.9538, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4123, dtype=torch.float64) delta_t tensor(-0.2640, dtype=torch.float64)
6 gae_duplicate tensor(-2.1280, dtype=torch.float64) tensor(7.6426, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4451, dtype=torch.float64) delta_t tensor(0.2835, dtype=torch.float64)
5 gae_duplicate tensor(-0.0966, dtype=torch.float64) tensor(-4.8960, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5347, dtype=torch.float64) delta_t tensor(0.3577, dtype=torch.float64)
4 gae_duplicate tensor(0.2306, dtype=torch.float64) tensor(-6.9140, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4110, dtype=torch.float64) delta_t tensor(0.1682, dtype=torch.float64)
3 gae_duplicate tensor(-0.0545, dtype=torch.float64) tensor(-4.1041, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0740, dtype=torch.float64) delta_t tensor(0.0460, dtype=torch.float64)
2 gae_duplicate tensor(-0.1431, dtype=torch.float64) tensor(-1.3063, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-643.4971923828125
value loss:81.94414520263672
entropies:352.8796691894531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.645323038101196 seconds
19 rew tensor(0.8472, dtype=torch.float64) delta_t tensor(-0.0398, dtype=torch.float64)
19 gae_duplicate tensor(-0.1412, dtype=torch.float64) tensor(0.8526, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8190, dtype=torch.float64) delta_t tensor(0.0605, dtype=torch.float64)
18 gae_duplicate tensor(-0.0619, dtype=torch.float64) tensor(-1.0757, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7710, dtype=torch.float64) delta_t tensor(0.0265, dtype=torch.float64)
17 gae_duplicate tensor(-0.0439, dtype=torch.float64) tensor(-0.5814, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7036, dtype=torch.float64) delta_t tensor(0.0054, dtype=torch.float64)
16 gae_duplicate tensor(-0.1121, dtype=torch.float64) tensor(-0.2770, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5734, dtype=torch.float64) delta_t tensor(-0.1010, dtype=torch.float64)
15 gae_duplicate tensor(-1.0967, dtype=torch.float64) tensor(1.7116, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3994, dtype=torch.float64) delta_t tensor(-0.1806, dtype=torch.float64)
14 gae_duplicate tensor(-1.1183, dtype=torch.float64) tensor(3.8847, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2517, dtype=torch.float64) delta_t tensor(-0.3547, dtype=torch.float64)
13 gae_duplicate tensor(-1.1495, dtype=torch.float64) tensor(6.8731, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3990, dtype=torch.float64) delta_t tensor(-0.1165, dtype=torch.float64)
12 gae_duplicate tensor(-1.1814, dtype=torch.float64) tensor(2.8195, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4415, dtype=torch.float64) delta_t tensor(-0.6189, dtype=torch.float64)
11 gae_duplicate tensor(-2.1430, dtype=torch.float64) tensor(12.1473, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0972, dtype=torch.float64) delta_t tensor(0.3477, dtype=torch.float64)
10 gae_duplicate tensor(-0.8185, dtype=torch.float64) tensor(-5.1055, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7034, dtype=torch.float64) delta_t tensor(-0.9173, dtype=torch.float64)
9 gae_duplicate tensor(-4.6335, dtype=torch.float64) tensor(16.2366, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8618, dtype=torch.float64) delta_t tensor(-0.1102, dtype=torch.float64)
8 gae_duplicate tensor(-2.5744, dtype=torch.float64) tensor(3.3860, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0674, dtype=torch.float64) delta_t tensor(0.4968, dtype=torch.float64)
7 gae_duplicate tensor(-0.2109, dtype=torch.float64) tensor(-9.7108, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4183, dtype=torch.float64) delta_t tensor(-0.1124, dtype=torch.float64)
6 gae_duplicate tensor(-2.9327, dtype=torch.float64) tensor(1.2113, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0327, dtype=torch.float64) delta_t tensor(0.2567, dtype=torch.float64)
5 gae_duplicate tensor(-0.0849, dtype=torch.float64) tensor(-5.1028, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3379, dtype=torch.float64) delta_t tensor(0.1535, dtype=torch.float64)
4 gae_duplicate tensor(-0.3397, dtype=torch.float64) tensor(-3.7710, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0821, dtype=torch.float64) delta_t tensor(-0.0265, dtype=torch.float64)
3 gae_duplicate tensor(-0.2190, dtype=torch.float64) tensor(0.1145, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2747, dtype=torch.float64) delta_t tensor(-0.0258, dtype=torch.float64)
2 gae_duplicate tensor(-0.2397, dtype=torch.float64) tensor(0.5075, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1397.42724609375
value loss:118.69842529296875
entropies:351.5227355957031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.659221887588501 seconds
19 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(-0.1303, dtype=torch.float64)
19 gae_duplicate tensor(-0.2251, dtype=torch.float64) tensor(2.3565, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8083, dtype=torch.float64) delta_t tensor(-0.0342, dtype=torch.float64)
18 gae_duplicate tensor(-0.1258, dtype=torch.float64) tensor(0.9068, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7701, dtype=torch.float64) delta_t tensor(-0.0631, dtype=torch.float64)
17 gae_duplicate tensor(-0.1382, dtype=torch.float64) tensor(1.4088, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7217, dtype=torch.float64) delta_t tensor(-0.0435, dtype=torch.float64)
16 gae_duplicate tensor(-0.2101, dtype=torch.float64) tensor(1.0831, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6858, dtype=torch.float64) delta_t tensor(-0.0497, dtype=torch.float64)
15 gae_duplicate tensor(-0.1653, dtype=torch.float64) tensor(1.0199, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5605, dtype=torch.float64) delta_t tensor(-0.0585, dtype=torch.float64)
14 gae_duplicate tensor(-0.1548, dtype=torch.float64) tensor(1.1816, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3993, dtype=torch.float64) delta_t tensor(-0.1586, dtype=torch.float64)
13 gae_duplicate tensor(-1.0855, dtype=torch.float64) tensor(3.8804, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4953, dtype=torch.float64) delta_t tensor(0.0195, dtype=torch.float64)
12 gae_duplicate tensor(-0.2388, dtype=torch.float64) tensor(-0.1724, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0799, dtype=torch.float64) delta_t tensor(-0.0981, dtype=torch.float64)
11 gae_duplicate tensor(-0.9562, dtype=torch.float64) tensor(1.5593, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1426, dtype=torch.float64) delta_t tensor(0.5151, dtype=torch.float64)
10 gae_duplicate tensor(-0.0507, dtype=torch.float64) tensor(-9.1949, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9740, dtype=torch.float64) delta_t tensor(-0.2447, dtype=torch.float64)
9 gae_duplicate tensor(-2.2532, dtype=torch.float64) tensor(2.1178, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0485, dtype=torch.float64) delta_t tensor(0.3864, dtype=torch.float64)
8 gae_duplicate tensor(-0.5478, dtype=torch.float64) tensor(-7.5787, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9660, dtype=torch.float64) delta_t tensor(-0.7998, dtype=torch.float64)
7 gae_duplicate tensor(-2.1518, dtype=torch.float64) tensor(13.2834, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3841, dtype=torch.float64) delta_t tensor(-0.0860, dtype=torch.float64)
6 gae_duplicate tensor(-2.3278, dtype=torch.float64) tensor(3.1024, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4415, dtype=torch.float64) delta_t tensor(-0.2506, dtype=torch.float64)
5 gae_duplicate tensor(-3.0270, dtype=torch.float64) tensor(4.7426, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0498, dtype=torch.float64) delta_t tensor(0.3114, dtype=torch.float64)
4 gae_duplicate tensor(0.0366, dtype=torch.float64) tensor(-5.1299, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0640, dtype=torch.float64) delta_t tensor(0.1293, dtype=torch.float64)
3 gae_duplicate tensor(-0.0071, dtype=torch.float64) tensor(-2.9119, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2283, dtype=torch.float64) delta_t tensor(-0.1055, dtype=torch.float64)
2 gae_duplicate tensor(-0.2400, dtype=torch.float64) tensor(1.8741, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-825.1738891601562
value loss:69.21376037597656
entropies:350.4344482421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.101832151412964 seconds
19 rew tensor(0.8675, dtype=torch.float64) delta_t tensor(-0.0982, dtype=torch.float64)
19 gae_duplicate tensor(-0.2707, dtype=torch.float64) tensor(2.1321, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8380, dtype=torch.float64) delta_t tensor(-0.0276, dtype=torch.float64)
18 gae_duplicate tensor(-0.2012, dtype=torch.float64) tensor(0.8387, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7722, dtype=torch.float64) delta_t tensor(-0.0981, dtype=torch.float64)
17 gae_duplicate tensor(-0.1652, dtype=torch.float64) tensor(1.9749, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5678, dtype=torch.float64) delta_t tensor(-0.1551, dtype=torch.float64)
16 gae_duplicate tensor(-0.2296, dtype=torch.float64) tensor(3.2641, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7142, dtype=torch.float64) delta_t tensor(-0.0964, dtype=torch.float64)
15 gae_duplicate tensor(-0.2212, dtype=torch.float64) tensor(2.2861, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2284, dtype=torch.float64) delta_t tensor(-0.2450, dtype=torch.float64)
14 gae_duplicate tensor(-1.2644, dtype=torch.float64) tensor(5.1559, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4755, dtype=torch.float64) delta_t tensor(-0.1324, dtype=torch.float64)
13 gae_duplicate tensor(-1.3119, dtype=torch.float64) tensor(3.0119, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1859, dtype=torch.float64) delta_t tensor(-0.2393, dtype=torch.float64)
12 gae_duplicate tensor(-0.9772, dtype=torch.float64) tensor(5.1417, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1525, dtype=torch.float64) delta_t tensor(0.2149, dtype=torch.float64)
11 gae_duplicate tensor(-1.1301, dtype=torch.float64) tensor(-3.7378, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1961, dtype=torch.float64) delta_t tensor(0.4865, dtype=torch.float64)
10 gae_duplicate tensor(-0.4175, dtype=torch.float64) tensor(-10.7646, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2416, dtype=torch.float64) delta_t tensor(0.1669, dtype=torch.float64)
9 gae_duplicate tensor(-2.1992, dtype=torch.float64) tensor(-2.9226, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5422, dtype=torch.float64) delta_t tensor(0.1656, dtype=torch.float64)
8 gae_duplicate tensor(-1.1347, dtype=torch.float64) tensor(-3.2496, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4214, dtype=torch.float64) delta_t tensor(-0.0730, dtype=torch.float64)
7 gae_duplicate tensor(-1.2746, dtype=torch.float64) tensor(1.4313, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4018, dtype=torch.float64) delta_t tensor(0.3975, dtype=torch.float64)
6 gae_duplicate tensor(-0.2975, dtype=torch.float64) tensor(-7.7187, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.5026, dtype=torch.float64) delta_t tensor(0.0895, dtype=torch.float64)
5 gae_duplicate tensor(-0.0489, dtype=torch.float64) tensor(-2.6354, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4220, dtype=torch.float64) delta_t tensor(0.0694, dtype=torch.float64)
4 gae_duplicate tensor(-0.2772, dtype=torch.float64) tensor(-1.4374, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5620, dtype=torch.float64) delta_t tensor(0.0904, dtype=torch.float64)
3 gae_duplicate tensor(-0.0306, dtype=torch.float64) tensor(-2.0141, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6692, dtype=torch.float64) delta_t tensor(-0.2074, dtype=torch.float64)
2 gae_duplicate tensor(-0.2947, dtype=torch.float64) tensor(3.9347, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:192.24563598632812
value loss:51.07346725463867
entropies:349.67718505859375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(4009.7124)
ToM Target loss= tensor(3570.3987)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.885922908782959 seconds
19 rew tensor(0.8561, dtype=torch.float64) delta_t tensor(-0.1674, dtype=torch.float64)
19 gae_duplicate tensor(-0.2900, dtype=torch.float64) tensor(3.3819, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8079, dtype=torch.float64) delta_t tensor(-0.0959, dtype=torch.float64)
18 gae_duplicate tensor(-0.2532, dtype=torch.float64) tensor(2.3017, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7706, dtype=torch.float64) delta_t tensor(-0.0762, dtype=torch.float64)
17 gae_duplicate tensor(-0.2411, dtype=torch.float64) tensor(1.7383, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6945, dtype=torch.float64) delta_t tensor(-0.1120, dtype=torch.float64)
16 gae_duplicate tensor(-0.2461, dtype=torch.float64) tensor(2.3069, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6559, dtype=torch.float64) delta_t tensor(-0.1406, dtype=torch.float64)
15 gae_duplicate tensor(-0.2445, dtype=torch.float64) tensor(3.4084, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4438, dtype=torch.float64) delta_t tensor(-0.2578, dtype=torch.float64)
14 gae_duplicate tensor(-1.2818, dtype=torch.float64) tensor(5.0812, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5476, dtype=torch.float64) delta_t tensor(-0.1301, dtype=torch.float64)
13 gae_duplicate tensor(-0.3889, dtype=torch.float64) tensor(3.2354, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0859, dtype=torch.float64) delta_t tensor(-0.2180, dtype=torch.float64)
12 gae_duplicate tensor(-1.0423, dtype=torch.float64) tensor(5.1218, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4811, dtype=torch.float64) delta_t tensor(0.4834, dtype=torch.float64)
11 gae_duplicate tensor(-0.0485, dtype=torch.float64) tensor(-8.3515, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5430, dtype=torch.float64) delta_t tensor(-0.5036, dtype=torch.float64)
10 gae_duplicate tensor(-1.2389, dtype=torch.float64) tensor(9.5424, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.9563, dtype=torch.float64) delta_t tensor(-1.0026, dtype=torch.float64)
9 gae_duplicate tensor(-4.7142, dtype=torch.float64) tensor(20.3971, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.9370, dtype=torch.float64) delta_t tensor(-1.4376, dtype=torch.float64)
8 gae_duplicate tensor(-3.6821, dtype=torch.float64) tensor(29.6659, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3397, dtype=torch.float64) delta_t tensor(0.3317, dtype=torch.float64)
7 gae_duplicate tensor(-2.9420, dtype=torch.float64) tensor(-4.1413, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1198, dtype=torch.float64) delta_t tensor(-0.0341, dtype=torch.float64)
6 gae_duplicate tensor(-2.1399, dtype=torch.float64) tensor(0.4021, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3649, dtype=torch.float64) delta_t tensor(-0.1284, dtype=torch.float64)
5 gae_duplicate tensor(-2.2910, dtype=torch.float64) tensor(2.0924, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3192, dtype=torch.float64) delta_t tensor(-0.3724, dtype=torch.float64)
4 gae_duplicate tensor(-3.7282, dtype=torch.float64) tensor(7.5939, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1874, dtype=torch.float64) delta_t tensor(-0.0115, dtype=torch.float64)
3 gae_duplicate tensor(-0.4091, dtype=torch.float64) tensor(0.9570, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3104, dtype=torch.float64) delta_t tensor(-0.1607, dtype=torch.float64)
2 gae_duplicate tensor(-0.3015, dtype=torch.float64) tensor(3.0253, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4833.10986328125
value loss:166.22116088867188
entropies:348.6215515136719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.553579092025757 seconds
19 rew tensor(0.8557, dtype=torch.float64) delta_t tensor(-0.0947, dtype=torch.float64)
19 gae_duplicate tensor(-0.1525, dtype=torch.float64) tensor(1.8551, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3495, dtype=torch.float64) delta_t tensor(-0.4453, dtype=torch.float64)
18 gae_duplicate tensor(-1.2685, dtype=torch.float64) tensor(8.2260, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8368, dtype=torch.float64) delta_t tensor(0.0166, dtype=torch.float64)
17 gae_duplicate tensor(-0.0898, dtype=torch.float64) tensor(0.5103, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6830, dtype=torch.float64) delta_t tensor(-0.0421, dtype=torch.float64)
16 gae_duplicate tensor(-0.1103, dtype=torch.float64) tensor(0.9188, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3403, dtype=torch.float64) delta_t tensor(-0.3928, dtype=torch.float64)
15 gae_duplicate tensor(-1.0850, dtype=torch.float64) tensor(8.3581, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5961, dtype=torch.float64) delta_t tensor(0.0088, dtype=torch.float64)
14 gae_duplicate tensor(-0.1245, dtype=torch.float64) tensor(0.6530, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4618, dtype=torch.float64) delta_t tensor(-0.0940, dtype=torch.float64)
13 gae_duplicate tensor(-1.0989, dtype=torch.float64) tensor(1.0146, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4074, dtype=torch.float64) delta_t tensor(-0.1385, dtype=torch.float64)
12 gae_duplicate tensor(-1.2045, dtype=torch.float64) tensor(2.2105, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3430, dtype=torch.float64) delta_t tensor(0.3566, dtype=torch.float64)
11 gae_duplicate tensor(-0.3474, dtype=torch.float64) tensor(-6.6789, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0611, dtype=torch.float64) delta_t tensor(0.3399, dtype=torch.float64)
10 gae_duplicate tensor(-0.2198, dtype=torch.float64) tensor(-7.0428, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.8805, dtype=torch.float64) delta_t tensor(-1.9020, dtype=torch.float64)
9 gae_duplicate tensor(-4.3743, dtype=torch.float64) tensor(31.0886, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.8012, dtype=torch.float64) delta_t tensor(-1.4101, dtype=torch.float64)
8 gae_duplicate tensor(-3.4582, dtype=torch.float64) tensor(31.5572, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5626, dtype=torch.float64) delta_t tensor(0.1680, dtype=torch.float64)
7 gae_duplicate tensor(-1.4155, dtype=torch.float64) tensor(-0.5604, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4699, dtype=torch.float64) delta_t tensor(0.6903, dtype=torch.float64)
6 gae_duplicate tensor(0.0188, dtype=torch.float64) tensor(-12.7381, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1170, dtype=torch.float64) delta_t tensor(0.3762, dtype=torch.float64)
5 gae_duplicate tensor(0.3973, dtype=torch.float64) tensor(-8.8905, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4896, dtype=torch.float64) delta_t tensor(0.1908, dtype=torch.float64)
4 gae_duplicate tensor(0.0715, dtype=torch.float64) tensor(-4.3524, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0609, dtype=torch.float64) delta_t tensor(-0.0563, dtype=torch.float64)
3 gae_duplicate tensor(-0.2123, dtype=torch.float64) tensor(0.5556, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1519, dtype=torch.float64) delta_t tensor(-0.0815, dtype=torch.float64)
2 gae_duplicate tensor(-0.1537, dtype=torch.float64) tensor(1.6383, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2703.197265625
value loss:121.52863311767578
entropies:347.23321533203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.759912967681885 seconds
19 rew tensor(0.8555, dtype=torch.float64) delta_t tensor(0.0112, dtype=torch.float64)
19 gae_duplicate tensor(-0.1057, dtype=torch.float64) tensor(-0.1370, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.0681, dtype=torch.float64)
18 gae_duplicate tensor(-0.1465, dtype=torch.float64) tensor(-1.3703, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8178, dtype=torch.float64) delta_t tensor(0.0929, dtype=torch.float64)
17 gae_duplicate tensor(-0.0403, dtype=torch.float64) tensor(-1.8289, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7317, dtype=torch.float64) delta_t tensor(0.0850, dtype=torch.float64)
16 gae_duplicate tensor(-0.0510, dtype=torch.float64) tensor(-1.7517, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6552, dtype=torch.float64) delta_t tensor(0.0548, dtype=torch.float64)
15 gae_duplicate tensor(-0.0121, dtype=torch.float64) tensor(-1.0993, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5998, dtype=torch.float64) delta_t tensor(0.1419, dtype=torch.float64)
14 gae_duplicate tensor(0.0358, dtype=torch.float64) tensor(-2.9973, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5493, dtype=torch.float64) delta_t tensor(0.0847, dtype=torch.float64)
13 gae_duplicate tensor(-0.0947, dtype=torch.float64) tensor(-1.7348, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5812, dtype=torch.float64) delta_t tensor(0.1944, dtype=torch.float64)
12 gae_duplicate tensor(0.0848, dtype=torch.float64) tensor(-3.9029, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3244, dtype=torch.float64) delta_t tensor(-0.2353, dtype=torch.float64)
11 gae_duplicate tensor(-1.2192, dtype=torch.float64) tensor(5.1240, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1769, dtype=torch.float64) delta_t tensor(0.1630, dtype=torch.float64)
10 gae_duplicate tensor(-1.2756, dtype=torch.float64) tensor(-2.8106, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.1512, dtype=torch.float64) delta_t tensor(-1.2806, dtype=torch.float64)
9 gae_duplicate tensor(-3.0244, dtype=torch.float64) tensor(22.6159, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4899, dtype=torch.float64) delta_t tensor(0.0389, dtype=torch.float64)
8 gae_duplicate tensor(-1.3669, dtype=torch.float64) tensor(2.4682, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1029, dtype=torch.float64) delta_t tensor(0.1308, dtype=torch.float64)
7 gae_duplicate tensor(-1.3052, dtype=torch.float64) tensor(-2.4759, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0366, dtype=torch.float64) delta_t tensor(0.5218, dtype=torch.float64)
6 gae_duplicate tensor(-0.3729, dtype=torch.float64) tensor(-12.0267, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0660, dtype=torch.float64) delta_t tensor(0.2265, dtype=torch.float64)
5 gae_duplicate tensor(0.0712, dtype=torch.float64) tensor(-5.8760, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0354, dtype=torch.float64) delta_t tensor(0.1770, dtype=torch.float64)
4 gae_duplicate tensor(-0.1027, dtype=torch.float64) tensor(-4.0222, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2189, dtype=torch.float64) delta_t tensor(0.0771, dtype=torch.float64)
3 gae_duplicate tensor(-0.1068, dtype=torch.float64) tensor(-1.9503, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4029, dtype=torch.float64) delta_t tensor(-0.0675, dtype=torch.float64)
2 gae_duplicate tensor(-0.2425, dtype=torch.float64) tensor(1.2347, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:583.7156372070312
value loss:61.72369384765625
entropies:346.2705383300781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.644867181777954 seconds
19 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.0272, dtype=torch.float64)
19 gae_duplicate tensor(-0.0523, dtype=torch.float64) tensor(-0.5980, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7782, dtype=torch.float64) delta_t tensor(0.0736, dtype=torch.float64)
18 gae_duplicate tensor(-0.0927, dtype=torch.float64) tensor(-1.3420, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7399, dtype=torch.float64) delta_t tensor(0.1345, dtype=torch.float64)
17 gae_duplicate tensor(0.0434, dtype=torch.float64) tensor(-2.7355, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7221, dtype=torch.float64) delta_t tensor(0.0907, dtype=torch.float64)
16 gae_duplicate tensor(0.0197, dtype=torch.float64) tensor(-2.0381, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3790, dtype=torch.float64) delta_t tensor(-0.1248, dtype=torch.float64)
15 gae_duplicate tensor(-1.0921, dtype=torch.float64) tensor(1.7737, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1014, dtype=torch.float64) delta_t tensor(-0.3975, dtype=torch.float64)
14 gae_duplicate tensor(-0.9935, dtype=torch.float64) tensor(7.7490, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5412, dtype=torch.float64) delta_t tensor(0.1321, dtype=torch.float64)
13 gae_duplicate tensor(-0.0857, dtype=torch.float64) tensor(-1.8057, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4092, dtype=torch.float64) delta_t tensor(0.0801, dtype=torch.float64)
12 gae_duplicate tensor(-0.8224, dtype=torch.float64) tensor(-1.2148, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0675, dtype=torch.float64) delta_t tensor(0.4460, dtype=torch.float64)
11 gae_duplicate tensor(-0.0268, dtype=torch.float64) tensor(-9.4394, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0258, dtype=torch.float64) delta_t tensor(0.2579, dtype=torch.float64)
10 gae_duplicate tensor(-0.7925, dtype=torch.float64) tensor(-5.2639, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.3352, dtype=torch.float64) delta_t tensor(-1.2496, dtype=torch.float64)
9 gae_duplicate tensor(-3.1839, dtype=torch.float64) tensor(25.0438, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2763, dtype=torch.float64) delta_t tensor(-0.7172, dtype=torch.float64)
8 gae_duplicate tensor(-2.2417, dtype=torch.float64) tensor(17.1288, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2794, dtype=torch.float64) delta_t tensor(0.5049, dtype=torch.float64)
7 gae_duplicate tensor(-0.3125, dtype=torch.float64) tensor(-10.1745, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0809, dtype=torch.float64) delta_t tensor(0.2676, dtype=torch.float64)
6 gae_duplicate tensor(-2.0926, dtype=torch.float64) tensor(-5.6259, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1475, dtype=torch.float64) delta_t tensor(0.3923, dtype=torch.float64)
5 gae_duplicate tensor(0.0835, dtype=torch.float64) tensor(-7.8299, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3064, dtype=torch.float64) delta_t tensor(0.3293, dtype=torch.float64)
4 gae_duplicate tensor(0.2135, dtype=torch.float64) tensor(-6.2059, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0505, dtype=torch.float64) delta_t tensor(0.2009, dtype=torch.float64)
3 gae_duplicate tensor(0.0269, dtype=torch.float64) tensor(-4.5129, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2007, dtype=torch.float64) delta_t tensor(-0.0265, dtype=torch.float64)
2 gae_duplicate tensor(-0.2567, dtype=torch.float64) tensor(0.1662, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:280.6011047363281
value loss:81.89524841308594
entropies:345.8070373535156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.127686977386475 seconds
19 rew tensor(0.8831, dtype=torch.float64) delta_t tensor(0.1152, dtype=torch.float64)
19 gae_duplicate tensor(0.0835, dtype=torch.float64) tensor(-2.2736, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8264, dtype=torch.float64) delta_t tensor(0.1524, dtype=torch.float64)
18 gae_duplicate tensor(0.0617, dtype=torch.float64) tensor(-3.0350, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8552, dtype=torch.float64) delta_t tensor(0.1690, dtype=torch.float64)
17 gae_duplicate tensor(0.0990, dtype=torch.float64) tensor(-3.6226, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7799, dtype=torch.float64) delta_t tensor(0.1769, dtype=torch.float64)
16 gae_duplicate tensor(0.0686, dtype=torch.float64) tensor(-3.5999, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7698, dtype=torch.float64) delta_t tensor(0.2096, dtype=torch.float64)
15 gae_duplicate tensor(0.0556, dtype=torch.float64) tensor(-4.5511, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6943, dtype=torch.float64) delta_t tensor(0.2597, dtype=torch.float64)
14 gae_duplicate tensor(0.1648, dtype=torch.float64) tensor(-4.9313, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6369, dtype=torch.float64) delta_t tensor(0.1707, dtype=torch.float64)
13 gae_duplicate tensor(0.1279, dtype=torch.float64) tensor(-4.4519, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3913, dtype=torch.float64) delta_t tensor(0.2440, dtype=torch.float64)
12 gae_duplicate tensor(-0.0055, dtype=torch.float64) tensor(-4.6443, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0817, dtype=torch.float64) delta_t tensor(0.1090, dtype=torch.float64)
11 gae_duplicate tensor(-0.9396, dtype=torch.float64) tensor(-2.7466, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1228, dtype=torch.float64) delta_t tensor(0.2491, dtype=torch.float64)
10 gae_duplicate tensor(-0.9085, dtype=torch.float64) tensor(-5.1469, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.4128, dtype=torch.float64) delta_t tensor(-1.3112, dtype=torch.float64)
9 gae_duplicate tensor(-3.1646, dtype=torch.float64) tensor(22.5473, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3150, dtype=torch.float64) delta_t tensor(-0.0383, dtype=torch.float64)
8 gae_duplicate tensor(-2.0454, dtype=torch.float64) tensor(3.1493, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7660, dtype=torch.float64) delta_t tensor(0.1468, dtype=torch.float64)
7 gae_duplicate tensor(-1.0892, dtype=torch.float64) tensor(-1.2377, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0017, dtype=torch.float64) delta_t tensor(-0.7149, dtype=torch.float64)
6 gae_duplicate tensor(-2.0807, dtype=torch.float64) tensor(13.0793, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8567, dtype=torch.float64) delta_t tensor(-0.1339, dtype=torch.float64)
5 gae_duplicate tensor(-2.2935, dtype=torch.float64) tensor(4.5723, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4881, dtype=torch.float64) delta_t tensor(0.2448, dtype=torch.float64)
4 gae_duplicate tensor(0.0237, dtype=torch.float64) tensor(-4.8091, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1568, dtype=torch.float64) delta_t tensor(0.0017, dtype=torch.float64)
3 gae_duplicate tensor(-0.1855, dtype=torch.float64) tensor(-0.5893, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0669, dtype=torch.float64) delta_t tensor(0.0244, dtype=torch.float64)
2 gae_duplicate tensor(-0.0834, dtype=torch.float64) tensor(-0.4857, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:56.806766510009766
value loss:99.3068618774414
entropies:344.9449768066406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3988.3923)
ToM Target loss= tensor(3565.3831)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.6247780323028564 seconds
19 rew tensor(0.8450, dtype=torch.float64) delta_t tensor(0.1572, dtype=torch.float64)
19 gae_duplicate tensor(0.0542, dtype=torch.float64) tensor(-2.8987, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8260, dtype=torch.float64) delta_t tensor(0.2007, dtype=torch.float64)
18 gae_duplicate tensor(0.0573, dtype=torch.float64) tensor(-4.0815, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7584, dtype=torch.float64) delta_t tensor(0.1955, dtype=torch.float64)
17 gae_duplicate tensor(0.1636, dtype=torch.float64) tensor(-3.6657, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7212, dtype=torch.float64) delta_t tensor(0.1971, dtype=torch.float64)
16 gae_duplicate tensor(0.1066, dtype=torch.float64) tensor(-4.1902, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2005, dtype=torch.float64) delta_t tensor(-0.1638, dtype=torch.float64)
15 gae_duplicate tensor(-1.0599, dtype=torch.float64) tensor(1.7273, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6461, dtype=torch.float64) delta_t tensor(0.2858, dtype=torch.float64)
14 gae_duplicate tensor(0.1382, dtype=torch.float64) tensor(-5.1472, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5572, dtype=torch.float64) delta_t tensor(0.3680, dtype=torch.float64)
13 gae_duplicate tensor(0.0883, dtype=torch.float64) tensor(-6.9017, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6084, dtype=torch.float64) delta_t tensor(0.4069, dtype=torch.float64)
12 gae_duplicate tensor(0.2333, dtype=torch.float64) tensor(-8.4139, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3941, dtype=torch.float64) delta_t tensor(0.0696, dtype=torch.float64)
11 gae_duplicate tensor(-0.8769, dtype=torch.float64) tensor(-3.9461, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0743, dtype=torch.float64) delta_t tensor(0.2839, dtype=torch.float64)
10 gae_duplicate tensor(0.0847, dtype=torch.float64) tensor(-5.3419, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.0009, dtype=torch.float64) delta_t tensor(-0.8778, dtype=torch.float64)
9 gae_duplicate tensor(-3.0328, dtype=torch.float64) tensor(13.2693, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4951, dtype=torch.float64) delta_t tensor(-0.3631, dtype=torch.float64)
8 gae_duplicate tensor(-3.7521, dtype=torch.float64) tensor(8.3418, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9218, dtype=torch.float64) delta_t tensor(-0.1228, dtype=torch.float64)
7 gae_duplicate tensor(-1.3104, dtype=torch.float64) tensor(2.4024, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3225, dtype=torch.float64) delta_t tensor(0.5629, dtype=torch.float64)
6 gae_duplicate tensor(-0.2100, dtype=torch.float64) tensor(-9.9684, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3403, dtype=torch.float64) delta_t tensor(0.2288, dtype=torch.float64)
5 gae_duplicate tensor(-0.3904, dtype=torch.float64) tensor(-5.4309, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2949, dtype=torch.float64) delta_t tensor(0.2285, dtype=torch.float64)
4 gae_duplicate tensor(-0.2262, dtype=torch.float64) tensor(-5.2477, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0850, dtype=torch.float64) delta_t tensor(0.1067, dtype=torch.float64)
3 gae_duplicate tensor(-0.0189, dtype=torch.float64) tensor(-2.6631, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2305, dtype=torch.float64) delta_t tensor(0.0354, dtype=torch.float64)
2 gae_duplicate tensor(-0.0653, dtype=torch.float64) tensor(-0.8746, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2230.626953125
value loss:93.61507415771484
entropies:344.56787109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.797981023788452 seconds
19 rew tensor(0.8541, dtype=torch.float64) delta_t tensor(0.1102, dtype=torch.float64)
19 gae_duplicate tensor(-0.0009, dtype=torch.float64) tensor(-1.9705, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8265, dtype=torch.float64) delta_t tensor(0.1574, dtype=torch.float64)
18 gae_duplicate tensor(0.0963, dtype=torch.float64) tensor(-3.4358, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7313, dtype=torch.float64) delta_t tensor(0.1244, dtype=torch.float64)
17 gae_duplicate tensor(-0.0127, dtype=torch.float64) tensor(-2.6769, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7506, dtype=torch.float64) delta_t tensor(0.1524, dtype=torch.float64)
16 gae_duplicate tensor(0.0511, dtype=torch.float64) tensor(-3.2088, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6257, dtype=torch.float64) delta_t tensor(0.1383, dtype=torch.float64)
15 gae_duplicate tensor(0.0653, dtype=torch.float64) tensor(-3.1228, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5020, dtype=torch.float64) delta_t tensor(0.0127, dtype=torch.float64)
14 gae_duplicate tensor(-0.9384, dtype=torch.float64) tensor(-1.3401, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5220, dtype=torch.float64) delta_t tensor(0.1586, dtype=torch.float64)
13 gae_duplicate tensor(-0.0086, dtype=torch.float64) tensor(-2.6795, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6460, dtype=torch.float64) delta_t tensor(0.3300, dtype=torch.float64)
12 gae_duplicate tensor(0.2362, dtype=torch.float64) tensor(-6.5639, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2083, dtype=torch.float64) delta_t tensor(0.3919, dtype=torch.float64)
11 gae_duplicate tensor(0.1539, dtype=torch.float64) tensor(-7.0646, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3727, dtype=torch.float64) delta_t tensor(0.0133, dtype=torch.float64)
10 gae_duplicate tensor(-1.0230, dtype=torch.float64) tensor(-1.1530, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0605, dtype=torch.float64) delta_t tensor(-0.1232, dtype=torch.float64)
9 gae_duplicate tensor(-4.0865, dtype=torch.float64) tensor(-2.2385, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0658, dtype=torch.float64) delta_t tensor(0.1689, dtype=torch.float64)
8 gae_duplicate tensor(-1.4316, dtype=torch.float64) tensor(-2.8308, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0908, dtype=torch.float64) delta_t tensor(-0.6621, dtype=torch.float64)
7 gae_duplicate tensor(-2.3491, dtype=torch.float64) tensor(12.3008, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0893, dtype=torch.float64) delta_t tensor(-0.7427, dtype=torch.float64)
6 gae_duplicate tensor(-3.2048, dtype=torch.float64) tensor(14.6809, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4071, dtype=torch.float64) delta_t tensor(0.0676, dtype=torch.float64)
5 gae_duplicate tensor(-0.8817, dtype=torch.float64) tensor(-0.0003, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0747, dtype=torch.float64) delta_t tensor(0.3868, dtype=torch.float64)
4 gae_duplicate tensor(-0.0764, dtype=torch.float64) tensor(-7.1995, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0692, dtype=torch.float64) delta_t tensor(0.1711, dtype=torch.float64)
3 gae_duplicate tensor(-0.1851, dtype=torch.float64) tensor(-3.9210, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2235, dtype=torch.float64) delta_t tensor(-0.0173, dtype=torch.float64)
2 gae_duplicate tensor(-0.1238, dtype=torch.float64) tensor(-0.1465, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1125.7635498046875
value loss:91.52182006835938
entropies:344.6595458984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.790645122528076 seconds
19 rew tensor(0.8640, dtype=torch.float64) delta_t tensor(0.1039, dtype=torch.float64)
19 gae_duplicate tensor(-0.0144, dtype=torch.float64) tensor(-1.9067, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.1415, dtype=torch.float64)
18 gae_duplicate tensor(0.0635, dtype=torch.float64) tensor(-2.8547, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7699, dtype=torch.float64) delta_t tensor(0.1727, dtype=torch.float64)
17 gae_duplicate tensor(0.1308, dtype=torch.float64) tensor(-3.4252, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6842, dtype=torch.float64) delta_t tensor(0.1191, dtype=torch.float64)
16 gae_duplicate tensor(0.0478, dtype=torch.float64) tensor(-2.7427, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6072, dtype=torch.float64) delta_t tensor(0.1172, dtype=torch.float64)
15 gae_duplicate tensor(0.0539, dtype=torch.float64) tensor(-2.5131, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4389, dtype=torch.float64) delta_t tensor(0.0650, dtype=torch.float64)
14 gae_duplicate tensor(-0.9521, dtype=torch.float64) tensor(-1.3043, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5997, dtype=torch.float64) delta_t tensor(0.1464, dtype=torch.float64)
13 gae_duplicate tensor(-0.0268, dtype=torch.float64) tensor(-3.2910, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3472, dtype=torch.float64) delta_t tensor(0.0711, dtype=torch.float64)
12 gae_duplicate tensor(-0.7716, dtype=torch.float64) tensor(-0.7613, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1714, dtype=torch.float64) delta_t tensor(-0.2166, dtype=torch.float64)
11 gae_duplicate tensor(-1.8292, dtype=torch.float64) tensor(4.1849, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0453, dtype=torch.float64) delta_t tensor(0.2806, dtype=torch.float64)
10 gae_duplicate tensor(-0.7243, dtype=torch.float64) tensor(-5.6734, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0492, dtype=torch.float64) delta_t tensor(-0.3290, dtype=torch.float64)
9 gae_duplicate tensor(-1.5436, dtype=torch.float64) tensor(5.5113, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1812, dtype=torch.float64) delta_t tensor(-0.6622, dtype=torch.float64)
8 gae_duplicate tensor(-2.3224, dtype=torch.float64) tensor(15.8777, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7905, dtype=torch.float64) delta_t tensor(-1.3619, dtype=torch.float64)
7 gae_duplicate tensor(-3.2644, dtype=torch.float64) tensor(26.6820, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9476, dtype=torch.float64) delta_t tensor(-0.5155, dtype=torch.float64)
6 gae_duplicate tensor(-3.3107, dtype=torch.float64) tensor(14.7143, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3874, dtype=torch.float64) delta_t tensor(0.0826, dtype=torch.float64)
5 gae_duplicate tensor(-2.0277, dtype=torch.float64) tensor(-1.7070, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2621, dtype=torch.float64) delta_t tensor(0.3238, dtype=torch.float64)
4 gae_duplicate tensor(0.0708, dtype=torch.float64) tensor(-6.4862, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0104, dtype=torch.float64) delta_t tensor(0.0431, dtype=torch.float64)
3 gae_duplicate tensor(-0.4372, dtype=torch.float64) tensor(-1.6702, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1806, dtype=torch.float64) delta_t tensor(-0.0008, dtype=torch.float64)
2 gae_duplicate tensor(-0.0862, dtype=torch.float64) tensor(-0.0442, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1853.0531005859375
value loss:104.2797622680664
entropies:345.1358947753906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.736761093139648 seconds
19 rew tensor(0.8346, dtype=torch.float64) delta_t tensor(0.0978, dtype=torch.float64)
19 gae_duplicate tensor(-0.0006, dtype=torch.float64) tensor(-2.0013, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7881, dtype=torch.float64) delta_t tensor(0.1483, dtype=torch.float64)
18 gae_duplicate tensor(0.0775, dtype=torch.float64) tensor(-3.0440, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7679, dtype=torch.float64) delta_t tensor(0.1954, dtype=torch.float64)
17 gae_duplicate tensor(0.1170, dtype=torch.float64) tensor(-3.9721, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6561, dtype=torch.float64) delta_t tensor(0.1389, dtype=torch.float64)
16 gae_duplicate tensor(0.0965, dtype=torch.float64) tensor(-3.0152, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4007, dtype=torch.float64) delta_t tensor(-0.0615, dtype=torch.float64)
15 gae_duplicate tensor(-1.0172, dtype=torch.float64) tensor(0.8187, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6171, dtype=torch.float64) delta_t tensor(0.2262, dtype=torch.float64)
14 gae_duplicate tensor(0.0792, dtype=torch.float64) tensor(-4.5009, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5329, dtype=torch.float64) delta_t tensor(0.1895, dtype=torch.float64)
13 gae_duplicate tensor(0.0597, dtype=torch.float64) tensor(-4.3696, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3172, dtype=torch.float64) delta_t tensor(0.1510, dtype=torch.float64)
12 gae_duplicate tensor(-0.8044, dtype=torch.float64) tensor(-3.7313, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1020, dtype=torch.float64) delta_t tensor(0.3470, dtype=torch.float64)
11 gae_duplicate tensor(-0.8046, dtype=torch.float64) tensor(-7.8704, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7721, dtype=torch.float64) delta_t tensor(-0.3663, dtype=torch.float64)
10 gae_duplicate tensor(-1.7581, dtype=torch.float64) tensor(5.9597, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4528, dtype=torch.float64) delta_t tensor(-0.7018, dtype=torch.float64)
9 gae_duplicate tensor(-4.1654, dtype=torch.float64) tensor(15.9843, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.0301, dtype=torch.float64) delta_t tensor(-0.9462, dtype=torch.float64)
8 gae_duplicate tensor(-3.4078, dtype=torch.float64) tensor(15.8759, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0384, dtype=torch.float64) delta_t tensor(0.5440, dtype=torch.float64)
7 gae_duplicate tensor(-1.0261, dtype=torch.float64) tensor(-8.1202, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2360, dtype=torch.float64) delta_t tensor(0.5118, dtype=torch.float64)
6 gae_duplicate tensor(-2.0738, dtype=torch.float64) tensor(-8.4197, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1129, dtype=torch.float64) delta_t tensor(0.1425, dtype=torch.float64)
5 gae_duplicate tensor(-0.8223, dtype=torch.float64) tensor(-3.6762, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1257, dtype=torch.float64) delta_t tensor(0.3267, dtype=torch.float64)
4 gae_duplicate tensor(-0.1900, dtype=torch.float64) tensor(-6.4356, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1777, dtype=torch.float64) delta_t tensor(0.2545, dtype=torch.float64)
3 gae_duplicate tensor(0.0681, dtype=torch.float64) tensor(-5.5780, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2876, dtype=torch.float64) delta_t tensor(0.0196, dtype=torch.float64)
2 gae_duplicate tensor(-0.1801, dtype=torch.float64) tensor(-0.8948, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1364.2957763671875
value loss:122.61920928955078
entropies:345.1873779296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.092889070510864 seconds
19 rew tensor(0.8839, dtype=torch.float64) delta_t tensor(0.1274, dtype=torch.float64)
19 gae_duplicate tensor(0.0948, dtype=torch.float64) tensor(-2.3086, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8463, dtype=torch.float64) delta_t tensor(0.2155, dtype=torch.float64)
18 gae_duplicate tensor(0.0784, dtype=torch.float64) tensor(-4.7189, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7989, dtype=torch.float64) delta_t tensor(0.1875, dtype=torch.float64)
17 gae_duplicate tensor(0.0749, dtype=torch.float64) tensor(-3.9606, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6739, dtype=torch.float64) delta_t tensor(0.2194, dtype=torch.float64)
16 gae_duplicate tensor(0.0666, dtype=torch.float64) tensor(-4.2536, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5706, dtype=torch.float64) delta_t tensor(0.1069, dtype=torch.float64)
15 gae_duplicate tensor(0.0776, dtype=torch.float64) tensor(-2.5550, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2295, dtype=torch.float64) delta_t tensor(0.0817, dtype=torch.float64)
14 gae_duplicate tensor(-0.9152, dtype=torch.float64) tensor(-1.8245, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2455, dtype=torch.float64) delta_t tensor(-0.2379, dtype=torch.float64)
13 gae_duplicate tensor(-1.0890, dtype=torch.float64) tensor(4.9961, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3500, dtype=torch.float64) delta_t tensor(0.2335, dtype=torch.float64)
12 gae_duplicate tensor(0.0061, dtype=torch.float64) tensor(-4.3394, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3687, dtype=torch.float64) delta_t tensor(-0.5287, dtype=torch.float64)
11 gae_duplicate tensor(-1.7309, dtype=torch.float64) tensor(10.9536, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5692, dtype=torch.float64) delta_t tensor(0.2088, dtype=torch.float64)
10 gae_duplicate tensor(-0.9583, dtype=torch.float64) tensor(-2.8815, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2613, dtype=torch.float64) delta_t tensor(0.3390, dtype=torch.float64)
9 gae_duplicate tensor(-1.3187, dtype=torch.float64) tensor(-8.2703, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3834, dtype=torch.float64) delta_t tensor(0.2391, dtype=torch.float64)
8 gae_duplicate tensor(-0.9719, dtype=torch.float64) tensor(-4.4342, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3165, dtype=torch.float64) delta_t tensor(-0.1799, dtype=torch.float64)
7 gae_duplicate tensor(-1.0653, dtype=torch.float64) tensor(3.1434, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5659, dtype=torch.float64) delta_t tensor(0.1009, dtype=torch.float64)
6 gae_duplicate tensor(-2.7583, dtype=torch.float64) tensor(-0.4365, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0557, dtype=torch.float64) delta_t tensor(0.3798, dtype=torch.float64)
5 gae_duplicate tensor(0.2301, dtype=torch.float64) tensor(-6.9097, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0594, dtype=torch.float64) delta_t tensor(0.0650, dtype=torch.float64)
4 gae_duplicate tensor(-0.2568, dtype=torch.float64) tensor(-2.3604, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1235, dtype=torch.float64) delta_t tensor(0.3053, dtype=torch.float64)
3 gae_duplicate tensor(0.1166, dtype=torch.float64) tensor(-6.4345, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2823, dtype=torch.float64) delta_t tensor(-0.0211, dtype=torch.float64)
2 gae_duplicate tensor(-0.1673, dtype=torch.float64) tensor(-0.3213, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1900.141357421875
value loss:70.22249603271484
entropies:345.59649658203125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3969.7915)
ToM Target loss= tensor(3570.1379)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.615477085113525 seconds
19 rew tensor(0.8170, dtype=torch.float64) delta_t tensor(0.0207, dtype=torch.float64)
19 gae_duplicate tensor(-0.0765, dtype=torch.float64) tensor(-0.4391, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7891, dtype=torch.float64) delta_t tensor(0.0983, dtype=torch.float64)
18 gae_duplicate tensor(0.0081, dtype=torch.float64) tensor(-1.9456, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7312, dtype=torch.float64) delta_t tensor(0.0883, dtype=torch.float64)
17 gae_duplicate tensor(0.0259, dtype=torch.float64) tensor(-1.8817, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5976, dtype=torch.float64) delta_t tensor(0.0433, dtype=torch.float64)
16 gae_duplicate tensor(-0.0098, dtype=torch.float64) tensor(-1.0250, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6552, dtype=torch.float64) delta_t tensor(0.1102, dtype=torch.float64)
15 gae_duplicate tensor(0.0271, dtype=torch.float64) tensor(-2.2393, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5227, dtype=torch.float64) delta_t tensor(0.1519, dtype=torch.float64)
14 gae_duplicate tensor(0.0556, dtype=torch.float64) tensor(-3.1576, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5675, dtype=torch.float64) delta_t tensor(0.1103, dtype=torch.float64)
13 gae_duplicate tensor(0.0901, dtype=torch.float64) tensor(-2.4310, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2410, dtype=torch.float64) delta_t tensor(0.2365, dtype=torch.float64)
12 gae_duplicate tensor(0.1029, dtype=torch.float64) tensor(-4.6619, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4225, dtype=torch.float64) delta_t tensor(-0.6451, dtype=torch.float64)
11 gae_duplicate tensor(-2.0863, dtype=torch.float64) tensor(10.5859, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1614, dtype=torch.float64) delta_t tensor(0.1645, dtype=torch.float64)
10 gae_duplicate tensor(-1.1703, dtype=torch.float64) tensor(-2.8786, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1193, dtype=torch.float64) delta_t tensor(0.2171, dtype=torch.float64)
9 gae_duplicate tensor(-1.7607, dtype=torch.float64) tensor(-3.5665, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4948, dtype=torch.float64) delta_t tensor(0.4054, dtype=torch.float64)
8 gae_duplicate tensor(-0.1418, dtype=torch.float64) tensor(-9.8508, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3782, dtype=torch.float64) delta_t tensor(-0.3527, dtype=torch.float64)
7 gae_duplicate tensor(-1.3209, dtype=torch.float64) tensor(6.1180, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3545, dtype=torch.float64) delta_t tensor(0.2652, dtype=torch.float64)
6 gae_duplicate tensor(-0.2253, dtype=torch.float64) tensor(-3.6861, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1236, dtype=torch.float64) delta_t tensor(0.2601, dtype=torch.float64)
5 gae_duplicate tensor(0.0139, dtype=torch.float64) tensor(-5.6669, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0935, dtype=torch.float64) delta_t tensor(0.0954, dtype=torch.float64)
4 gae_duplicate tensor(-0.1817, dtype=torch.float64) tensor(-2.6238, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2175, dtype=torch.float64) delta_t tensor(0.1415, dtype=torch.float64)
3 gae_duplicate tensor(0.0419, dtype=torch.float64) tensor(-3.2660, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3889, dtype=torch.float64) delta_t tensor(0.0121, dtype=torch.float64)
2 gae_duplicate tensor(-0.0693, dtype=torch.float64) tensor(-0.7776, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1709.948486328125
value loss:39.58406448364258
entropies:345.5679626464844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.058719158172607 seconds
19 rew tensor(0.8272, dtype=torch.float64) delta_t tensor(-0.0512, dtype=torch.float64)
19 gae_duplicate tensor(-0.1145, dtype=torch.float64) tensor(0.9306, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3874, dtype=torch.float64) delta_t tensor(-0.3427, dtype=torch.float64)
18 gae_duplicate tensor(-1.1362, dtype=torch.float64) tensor(6.2785, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8466, dtype=torch.float64) delta_t tensor(0.0657, dtype=torch.float64)
17 gae_duplicate tensor(-0.0321, dtype=torch.float64) tensor(-0.5106, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7339, dtype=torch.float64) delta_t tensor(0.0847, dtype=torch.float64)
16 gae_duplicate tensor(0.0098, dtype=torch.float64) tensor(-1.7789, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7601, dtype=torch.float64) delta_t tensor(0.1393, dtype=torch.float64)
15 gae_duplicate tensor(0.0013, dtype=torch.float64) tensor(-2.5738, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2538, dtype=torch.float64) delta_t tensor(-0.1910, dtype=torch.float64)
14 gae_duplicate tensor(-0.9063, dtype=torch.float64) tensor(2.7139, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6447, dtype=torch.float64) delta_t tensor(0.2263, dtype=torch.float64)
13 gae_duplicate tensor(0.0875, dtype=torch.float64) tensor(-4.1111, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6473, dtype=torch.float64) delta_t tensor(0.3020, dtype=torch.float64)
12 gae_duplicate tensor(0.1417, dtype=torch.float64) tensor(-6.2644, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3593, dtype=torch.float64) delta_t tensor(-0.0993, dtype=torch.float64)
11 gae_duplicate tensor(-0.8633, dtype=torch.float64) tensor(1.5608, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0232, dtype=torch.float64) delta_t tensor(0.0069, dtype=torch.float64)
10 gae_duplicate tensor(-2.2539, dtype=torch.float64) tensor(-1.0179, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.7751, dtype=torch.float64) delta_t tensor(-1.6397, dtype=torch.float64)
9 gae_duplicate tensor(-3.1163, dtype=torch.float64) tensor(31.8538, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7735, dtype=torch.float64) delta_t tensor(-0.6919, dtype=torch.float64)
8 gae_duplicate tensor(-2.8862, dtype=torch.float64) tensor(15.5587, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5550, dtype=torch.float64) delta_t tensor(0.5774, dtype=torch.float64)
7 gae_duplicate tensor(-1.0907, dtype=torch.float64) tensor(-9.4568, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4949, dtype=torch.float64) delta_t tensor(0.8778, dtype=torch.float64)
6 gae_duplicate tensor(0.2921, dtype=torch.float64) tensor(-16.9848, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1642, dtype=torch.float64) delta_t tensor(0.3882, dtype=torch.float64)
5 gae_duplicate tensor(-0.2342, dtype=torch.float64) tensor(-9.0092, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4398, dtype=torch.float64) delta_t tensor(0.2159, dtype=torch.float64)
4 gae_duplicate tensor(-0.1044, dtype=torch.float64) tensor(-4.6944, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0497, dtype=torch.float64) delta_t tensor(-0.0412, dtype=torch.float64)
3 gae_duplicate tensor(-0.2050, dtype=torch.float64) tensor(0.3570, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2119, dtype=torch.float64) delta_t tensor(-0.0181, dtype=torch.float64)
2 gae_duplicate tensor(-0.1342, dtype=torch.float64) tensor(0.3850, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-268.1669616699219
value loss:109.55720520019531
entropies:345.9337158203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.830627202987671 seconds
19 rew tensor(0.8563, dtype=torch.float64) delta_t tensor(-0.0317, dtype=torch.float64)
19 gae_duplicate tensor(-0.1707, dtype=torch.float64) tensor(0.5961, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6174, dtype=torch.float64) delta_t tensor(-0.1475, dtype=torch.float64)
18 gae_duplicate tensor(-1.1652, dtype=torch.float64) tensor(2.8092, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7787, dtype=torch.float64) delta_t tensor(0.0337, dtype=torch.float64)
17 gae_duplicate tensor(-0.0141, dtype=torch.float64) tensor(-0.3107, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6565, dtype=torch.float64) delta_t tensor(0.0128, dtype=torch.float64)
16 gae_duplicate tensor(-0.0836, dtype=torch.float64) tensor(-0.0673, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6542, dtype=torch.float64) delta_t tensor(0.0406, dtype=torch.float64)
15 gae_duplicate tensor(-0.0408, dtype=torch.float64) tensor(-0.8663, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3222, dtype=torch.float64) delta_t tensor(-0.1280, dtype=torch.float64)
14 gae_duplicate tensor(-0.9382, dtype=torch.float64) tensor(2.1290, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5859, dtype=torch.float64) delta_t tensor(0.0900, dtype=torch.float64)
13 gae_duplicate tensor(-0.0294, dtype=torch.float64) tensor(-1.3537, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5163, dtype=torch.float64) delta_t tensor(0.1679, dtype=torch.float64)
12 gae_duplicate tensor(0.0938, dtype=torch.float64) tensor(-3.5446, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0631, dtype=torch.float64) delta_t tensor(-0.3569, dtype=torch.float64)
11 gae_duplicate tensor(-0.9754, dtype=torch.float64) tensor(6.5733, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1630, dtype=torch.float64) delta_t tensor(-0.1443, dtype=torch.float64)
10 gae_duplicate tensor(-2.1057, dtype=torch.float64) tensor(3.3336, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7976, dtype=torch.float64) delta_t tensor(-1.2201, dtype=torch.float64)
9 gae_duplicate tensor(-3.1549, dtype=torch.float64) tensor(21.7494, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3194, dtype=torch.float64) delta_t tensor(-0.2540, dtype=torch.float64)
8 gae_duplicate tensor(-1.2023, dtype=torch.float64) tensor(6.9495, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0951, dtype=torch.float64) delta_t tensor(0.4093, dtype=torch.float64)
7 gae_duplicate tensor(-0.1838, dtype=torch.float64) tensor(-6.7833, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0894, dtype=torch.float64) delta_t tensor(0.4376, dtype=torch.float64)
6 gae_duplicate tensor(-0.1121, dtype=torch.float64) tensor(-8.6345, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0825, dtype=torch.float64) delta_t tensor(0.2310, dtype=torch.float64)
5 gae_duplicate tensor(0.0317, dtype=torch.float64) tensor(-5.2074, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0050, dtype=torch.float64) delta_t tensor(-0.0187, dtype=torch.float64)
4 gae_duplicate tensor(-0.3347, dtype=torch.float64) tensor(-0.1803, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2162, dtype=torch.float64) delta_t tensor(-0.0707, dtype=torch.float64)
3 gae_duplicate tensor(-0.5817, dtype=torch.float64) tensor(1.1606, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3324, dtype=torch.float64) delta_t tensor(-0.0280, dtype=torch.float64)
2 gae_duplicate tensor(-0.1480, dtype=torch.float64) tensor(0.6340, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1118.8345947265625
value loss:73.517333984375
entropies:346.5269775390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.532876968383789 seconds
19 rew tensor(0.8654, dtype=torch.float64) delta_t tensor(-0.0177, dtype=torch.float64)
19 gae_duplicate tensor(-0.1424, dtype=torch.float64) tensor(0.2452, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7683, dtype=torch.float64) delta_t tensor(0.0201, dtype=torch.float64)
18 gae_duplicate tensor(-0.1023, dtype=torch.float64) tensor(-0.5025, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7319, dtype=torch.float64) delta_t tensor(0.0226, dtype=torch.float64)
17 gae_duplicate tensor(-0.0024, dtype=torch.float64) tensor(-0.4776, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4919, dtype=torch.float64) delta_t tensor(-0.1393, dtype=torch.float64)
16 gae_duplicate tensor(-1.0584, dtype=torch.float64) tensor(3.5515, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3873, dtype=torch.float64) delta_t tensor(-0.1620, dtype=torch.float64)
15 gae_duplicate tensor(-1.1668, dtype=torch.float64) tensor(3.0617, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3626, dtype=torch.float64) delta_t tensor(-0.0480, dtype=torch.float64)
14 gae_duplicate tensor(-1.1255, dtype=torch.float64) tensor(1.4443, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5905, dtype=torch.float64) delta_t tensor(0.0987, dtype=torch.float64)
13 gae_duplicate tensor(-0.0507, dtype=torch.float64) tensor(-1.7561, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4798, dtype=torch.float64) delta_t tensor(0.1751, dtype=torch.float64)
12 gae_duplicate tensor(-0.0022, dtype=torch.float64) tensor(-3.3043, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1215, dtype=torch.float64) delta_t tensor(0.0266, dtype=torch.float64)
11 gae_duplicate tensor(-0.8227, dtype=torch.float64) tensor(-0.3733, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1783, dtype=torch.float64) delta_t tensor(-0.3548, dtype=torch.float64)
10 gae_duplicate tensor(-2.1428, dtype=torch.float64) tensor(6.8100, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5619, dtype=torch.float64) delta_t tensor(-0.7075, dtype=torch.float64)
9 gae_duplicate tensor(-2.7370, dtype=torch.float64) tensor(15.8149, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2236, dtype=torch.float64) delta_t tensor(-0.7129, dtype=torch.float64)
8 gae_duplicate tensor(-2.1633, dtype=torch.float64) tensor(15.7907, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0708, dtype=torch.float64) delta_t tensor(0.5086, dtype=torch.float64)
7 gae_duplicate tensor(-0.0904, dtype=torch.float64) tensor(-8.3256, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2182, dtype=torch.float64) delta_t tensor(0.1753, dtype=torch.float64)
6 gae_duplicate tensor(-1.6660, dtype=torch.float64) tensor(-5.4012, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0120, dtype=torch.float64) delta_t tensor(0.3171, dtype=torch.float64)
5 gae_duplicate tensor(0.0253, dtype=torch.float64) tensor(-5.5728, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1703, dtype=torch.float64) delta_t tensor(0.0623, dtype=torch.float64)
4 gae_duplicate tensor(-0.2471, dtype=torch.float64) tensor(-1.9066, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2014, dtype=torch.float64) delta_t tensor(-0.0071, dtype=torch.float64)
3 gae_duplicate tensor(-0.3224, dtype=torch.float64) tensor(-0.0596, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3142, dtype=torch.float64) delta_t tensor(-0.0471, dtype=torch.float64)
2 gae_duplicate tensor(-0.1235, dtype=torch.float64) tensor(0.8737, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1169.0684814453125
value loss:74.5638427734375
entropies:347.4170837402344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.852892160415649 seconds
19 rew tensor(0.8844, dtype=torch.float64) delta_t tensor(-0.0243, dtype=torch.float64)
19 gae_duplicate tensor(-0.0539, dtype=torch.float64) tensor(0.4590, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8189, dtype=torch.float64) delta_t tensor(0.0276, dtype=torch.float64)
18 gae_duplicate tensor(-0.0693, dtype=torch.float64) tensor(-0.5093, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8290, dtype=torch.float64) delta_t tensor(0.0821, dtype=torch.float64)
17 gae_duplicate tensor(0.0120, dtype=torch.float64) tensor(-1.6218, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7044, dtype=torch.float64) delta_t tensor(0.0407, dtype=torch.float64)
16 gae_duplicate tensor(-0.0458, dtype=torch.float64) tensor(-0.9331, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6198, dtype=torch.float64) delta_t tensor(0.0649, dtype=torch.float64)
15 gae_duplicate tensor(-0.0344, dtype=torch.float64) tensor(-1.3155, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4730, dtype=torch.float64) delta_t tensor(-0.0382, dtype=torch.float64)
14 gae_duplicate tensor(-1.0170, dtype=torch.float64) tensor(0.9436, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3172, dtype=torch.float64) delta_t tensor(-0.1216, dtype=torch.float64)
13 gae_duplicate tensor(-1.2027, dtype=torch.float64) tensor(3.2186, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4178, dtype=torch.float64) delta_t tensor(0.0164, dtype=torch.float64)
12 gae_duplicate tensor(-0.8480, dtype=torch.float64) tensor(-0.3368, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3781, dtype=torch.float64) delta_t tensor(-0.4305, dtype=torch.float64)
11 gae_duplicate tensor(-1.7076, dtype=torch.float64) tensor(8.8210, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1784, dtype=torch.float64) delta_t tensor(-0.3010, dtype=torch.float64)
10 gae_duplicate tensor(-1.8918, dtype=torch.float64) tensor(7.1522, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2844, dtype=torch.float64) delta_t tensor(-0.3343, dtype=torch.float64)
9 gae_duplicate tensor(-3.0470, dtype=torch.float64) tensor(6.5786, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0964, dtype=torch.float64) delta_t tensor(-0.7540, dtype=torch.float64)
8 gae_duplicate tensor(-2.7832, dtype=torch.float64) tensor(15.2099, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9604, dtype=torch.float64) delta_t tensor(-0.1514, dtype=torch.float64)
7 gae_duplicate tensor(-1.2737, dtype=torch.float64) tensor(6.3733, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0963, dtype=torch.float64) delta_t tensor(0.4240, dtype=torch.float64)
6 gae_duplicate tensor(-0.8624, dtype=torch.float64) tensor(-8.9740, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2888, dtype=torch.float64) delta_t tensor(0.3495, dtype=torch.float64)
5 gae_duplicate tensor(0.0489, dtype=torch.float64) tensor(-7.4631, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4097, dtype=torch.float64) delta_t tensor(0.2299, dtype=torch.float64)
4 gae_duplicate tensor(-0.3055, dtype=torch.float64) tensor(-5.5120, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2208, dtype=torch.float64) delta_t tensor(0.0965, dtype=torch.float64)
3 gae_duplicate tensor(-0.0997, dtype=torch.float64) tensor(-2.3122, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0578, dtype=torch.float64) delta_t tensor(0.0427, dtype=torch.float64)
2 gae_duplicate tensor(-0.0354, dtype=torch.float64) tensor(-1.1821, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1098.1109619140625
value loss:76.20394134521484
entropies:347.82708740234375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3962.5725)
ToM Target loss= tensor(3577.9927)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.739431142807007 seconds
19 rew tensor(0.8367, dtype=torch.float64) delta_t tensor(-0.0006, dtype=torch.float64)
19 gae_duplicate tensor(-0.1170, dtype=torch.float64) tensor(-0.0265, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8099, dtype=torch.float64) delta_t tensor(0.0656, dtype=torch.float64)
18 gae_duplicate tensor(-0.0306, dtype=torch.float64) tensor(-1.2461, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7514, dtype=torch.float64) delta_t tensor(0.0526, dtype=torch.float64)
17 gae_duplicate tensor(-0.0247, dtype=torch.float64) tensor(-1.1653, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5223, dtype=torch.float64) delta_t tensor(-0.1353, dtype=torch.float64)
16 gae_duplicate tensor(-0.9936, dtype=torch.float64) tensor(2.3449, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5508, dtype=torch.float64) delta_t tensor(-0.0083, dtype=torch.float64)
15 gae_duplicate tensor(-0.1043, dtype=torch.float64) tensor(0.4854, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6095, dtype=torch.float64) delta_t tensor(0.1813, dtype=torch.float64)
14 gae_duplicate tensor(0.0962, dtype=torch.float64) tensor(-3.1698, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6276, dtype=torch.float64) delta_t tensor(0.1223, dtype=torch.float64)
13 gae_duplicate tensor(0.0325, dtype=torch.float64) tensor(-2.5962, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4942, dtype=torch.float64) delta_t tensor(0.2169, dtype=torch.float64)
12 gae_duplicate tensor(0.0783, dtype=torch.float64) tensor(-4.7917, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2623, dtype=torch.float64) delta_t tensor(-0.4406, dtype=torch.float64)
11 gae_duplicate tensor(-1.0134, dtype=torch.float64) tensor(8.7908, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4647, dtype=torch.float64) delta_t tensor(-0.5803, dtype=torch.float64)
10 gae_duplicate tensor(-2.1587, dtype=torch.float64) tensor(12.2929, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9402, dtype=torch.float64) delta_t tensor(-0.0188, dtype=torch.float64)
9 gae_duplicate tensor(-1.6958, dtype=torch.float64) tensor(1.8631, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6359, dtype=torch.float64) delta_t tensor(0.0240, dtype=torch.float64)
8 gae_duplicate tensor(-0.8247, dtype=torch.float64) tensor(-0.7663, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9267, dtype=torch.float64) delta_t tensor(-0.4686, dtype=torch.float64)
7 gae_duplicate tensor(-2.1300, dtype=torch.float64) tensor(8.5111, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1578, dtype=torch.float64) delta_t tensor(0.3885, dtype=torch.float64)
6 gae_duplicate tensor(-1.9252, dtype=torch.float64) tensor(-7.9209, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0333, dtype=torch.float64) delta_t tensor(0.3492, dtype=torch.float64)
5 gae_duplicate tensor(-0.1287, dtype=torch.float64) tensor(-7.2159, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2417, dtype=torch.float64) delta_t tensor(0.1496, dtype=torch.float64)
4 gae_duplicate tensor(-0.3346, dtype=torch.float64) tensor(-3.2012, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1026, dtype=torch.float64) delta_t tensor(-0.0413, dtype=torch.float64)
3 gae_duplicate tensor(-0.3177, dtype=torch.float64) tensor(0.4451, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2546, dtype=torch.float64) delta_t tensor(-0.0082, dtype=torch.float64)
2 gae_duplicate tensor(-0.2068, dtype=torch.float64) tensor(0.3199, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-253.3913116455078
value loss:53.31680679321289
entropies:347.834228515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7463219165802 seconds
19 rew tensor(0.8649, dtype=torch.float64) delta_t tensor(0.0531, dtype=torch.float64)
19 gae_duplicate tensor(-0.0573, dtype=torch.float64) tensor(-1.0386, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8650, dtype=torch.float64) delta_t tensor(0.1477, dtype=torch.float64)
18 gae_duplicate tensor(0.0500, dtype=torch.float64) tensor(-3.0826, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7978, dtype=torch.float64) delta_t tensor(0.1502, dtype=torch.float64)
17 gae_duplicate tensor(0.0655, dtype=torch.float64) tensor(-3.0665, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7507, dtype=torch.float64) delta_t tensor(0.1737, dtype=torch.float64)
16 gae_duplicate tensor(0.0961, dtype=torch.float64) tensor(-3.8774, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6842, dtype=torch.float64) delta_t tensor(0.2137, dtype=torch.float64)
15 gae_duplicate tensor(0.0259, dtype=torch.float64) tensor(-4.3704, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6566, dtype=torch.float64) delta_t tensor(0.2560, dtype=torch.float64)
14 gae_duplicate tensor(0.1689, dtype=torch.float64) tensor(-5.3229, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5960, dtype=torch.float64) delta_t tensor(0.2366, dtype=torch.float64)
13 gae_duplicate tensor(0.0943, dtype=torch.float64) tensor(-5.2661, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0027, dtype=torch.float64) delta_t tensor(-0.3136, dtype=torch.float64)
12 gae_duplicate tensor(-1.0539, dtype=torch.float64) tensor(4.8136, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2197, dtype=torch.float64) delta_t tensor(0.2125, dtype=torch.float64)
11 gae_duplicate tensor(-0.6433, dtype=torch.float64) tensor(-3.6856, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3896, dtype=torch.float64) delta_t tensor(-0.5518, dtype=torch.float64)
10 gae_duplicate tensor(-0.9991, dtype=torch.float64) tensor(9.2058, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.8810, dtype=torch.float64) delta_t tensor(-1.0943, dtype=torch.float64)
9 gae_duplicate tensor(-3.5806, dtype=torch.float64) tensor(21.6109, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2947, dtype=torch.float64) delta_t tensor(0.0527, dtype=torch.float64)
8 gae_duplicate tensor(-1.9756, dtype=torch.float64) tensor(1.6874, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2646, dtype=torch.float64) delta_t tensor(-0.5077, dtype=torch.float64)
7 gae_duplicate tensor(-3.6254, dtype=torch.float64) tensor(11.1134, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1341, dtype=torch.float64) delta_t tensor(0.3986, dtype=torch.float64)
6 gae_duplicate tensor(-1.0105, dtype=torch.float64) tensor(-6.3164, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5394, dtype=torch.float64) delta_t tensor(0.0811, dtype=torch.float64)
5 gae_duplicate tensor(-1.0253, dtype=torch.float64) tensor(-3.5183, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4084, dtype=torch.float64) delta_t tensor(0.2610, dtype=torch.float64)
4 gae_duplicate tensor(-0.3509, dtype=torch.float64) tensor(-5.0208, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1549, dtype=torch.float64) delta_t tensor(0.0293, dtype=torch.float64)
3 gae_duplicate tensor(-0.1899, dtype=torch.float64) tensor(-0.8960, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0577, dtype=torch.float64) delta_t tensor(0.0468, dtype=torch.float64)
2 gae_duplicate tensor(-0.0879, dtype=torch.float64) tensor(-0.8958, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-205.923828125
value loss:94.98390197753906
entropies:347.9523620605469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.816154956817627 seconds
19 rew tensor(0.8648, dtype=torch.float64) delta_t tensor(0.0224, dtype=torch.float64)
19 gae_duplicate tensor(-0.0348, dtype=torch.float64) tensor(-0.4669, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8065, dtype=torch.float64) delta_t tensor(0.1235, dtype=torch.float64)
18 gae_duplicate tensor(-0.0008, dtype=torch.float64) tensor(-2.3658, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7498, dtype=torch.float64) delta_t tensor(0.0785, dtype=torch.float64)
17 gae_duplicate tensor(-0.0170, dtype=torch.float64) tensor(-1.7840, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7499, dtype=torch.float64) delta_t tensor(0.1493, dtype=torch.float64)
16 gae_duplicate tensor(0.0974, dtype=torch.float64) tensor(-3.1782, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7024, dtype=torch.float64) delta_t tensor(0.1443, dtype=torch.float64)
15 gae_duplicate tensor(0.0555, dtype=torch.float64) tensor(-2.9351, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4016, dtype=torch.float64) delta_t tensor(0.0088, dtype=torch.float64)
14 gae_duplicate tensor(-1.0981, dtype=torch.float64) tensor(-0.2569, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4130, dtype=torch.float64) delta_t tensor(0.0039, dtype=torch.float64)
13 gae_duplicate tensor(-0.9535, dtype=torch.float64) tensor(-0.2772, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4924, dtype=torch.float64) delta_t tensor(0.2909, dtype=torch.float64)
12 gae_duplicate tensor(0.1942, dtype=torch.float64) tensor(-5.5733, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2050, dtype=torch.float64) delta_t tensor(-0.0415, dtype=torch.float64)
11 gae_duplicate tensor(-0.8271, dtype=torch.float64) tensor(-0.5896, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1951, dtype=torch.float64) delta_t tensor(0.1787, dtype=torch.float64)
10 gae_duplicate tensor(-0.8318, dtype=torch.float64) tensor(-3.4909, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8856, dtype=torch.float64) delta_t tensor(-0.3212, dtype=torch.float64)
9 gae_duplicate tensor(-1.8452, dtype=torch.float64) tensor(5.3775, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9220, dtype=torch.float64) delta_t tensor(0.0359, dtype=torch.float64)
8 gae_duplicate tensor(-2.2124, dtype=torch.float64) tensor(-1.2683, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4495, dtype=torch.float64) delta_t tensor(0.8753, dtype=torch.float64)
7 gae_duplicate tensor(0.2284, dtype=torch.float64) tensor(-16.7229, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3775, dtype=torch.float64) delta_t tensor(0.1243, dtype=torch.float64)
6 gae_duplicate tensor(-1.1195, dtype=torch.float64) tensor(-5.7892, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1597, dtype=torch.float64) delta_t tensor(-0.0894, dtype=torch.float64)
5 gae_duplicate tensor(-2.1557, dtype=torch.float64) tensor(0.0914, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1890, dtype=torch.float64) delta_t tensor(-0.1931, dtype=torch.float64)
4 gae_duplicate tensor(-1.3809, dtype=torch.float64) tensor(4.0158, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3434, dtype=torch.float64) delta_t tensor(0.0706, dtype=torch.float64)
3 gae_duplicate tensor(-0.1616, dtype=torch.float64) tensor(-1.3446, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4564, dtype=torch.float64) delta_t tensor(-0.0213, dtype=torch.float64)
2 gae_duplicate tensor(-0.1383, dtype=torch.float64) tensor(0.2024, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1869.1458740234375
value loss:62.00898742675781
entropies:348.40789794921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.252264976501465 seconds
19 rew tensor(0.8744, dtype=torch.float64) delta_t tensor(0.0706, dtype=torch.float64)
19 gae_duplicate tensor(-0.0328, dtype=torch.float64) tensor(-1.2410, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8362, dtype=torch.float64) delta_t tensor(0.1344, dtype=torch.float64)
18 gae_duplicate tensor(0.0680, dtype=torch.float64) tensor(-2.8013, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7980, dtype=torch.float64) delta_t tensor(0.1764, dtype=torch.float64)
17 gae_duplicate tensor(0.1025, dtype=torch.float64) tensor(-3.8305, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7803, dtype=torch.float64) delta_t tensor(0.2055, dtype=torch.float64)
16 gae_duplicate tensor(0.0916, dtype=torch.float64) tensor(-3.9004, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7310, dtype=torch.float64) delta_t tensor(0.3008, dtype=torch.float64)
15 gae_duplicate tensor(0.1053, dtype=torch.float64) tensor(-6.2162, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2980, dtype=torch.float64) delta_t tensor(-0.0906, dtype=torch.float64)
14 gae_duplicate tensor(-0.9102, dtype=torch.float64) tensor(0.4478, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2799, dtype=torch.float64) delta_t tensor(0.0111, dtype=torch.float64)
13 gae_duplicate tensor(-0.9971, dtype=torch.float64) tensor(-0.5650, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4655, dtype=torch.float64) delta_t tensor(0.2398, dtype=torch.float64)
12 gae_duplicate tensor(-0.4489, dtype=torch.float64) tensor(-4.7126, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0175, dtype=torch.float64) delta_t tensor(0.1713, dtype=torch.float64)
11 gae_duplicate tensor(-0.6271, dtype=torch.float64) tensor(-3.9481, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1175, dtype=torch.float64) delta_t tensor(0.3154, dtype=torch.float64)
10 gae_duplicate tensor(-0.8731, dtype=torch.float64) tensor(-6.3212, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.0915, dtype=torch.float64) delta_t tensor(-0.7092, dtype=torch.float64)
9 gae_duplicate tensor(-2.7567, dtype=torch.float64) tensor(13.9069, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4298, dtype=torch.float64) delta_t tensor(0.2301, dtype=torch.float64)
8 gae_duplicate tensor(-1.2512, dtype=torch.float64) tensor(-3.3005, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1395, dtype=torch.float64) delta_t tensor(-0.0593, dtype=torch.float64)
7 gae_duplicate tensor(-2.0235, dtype=torch.float64) tensor(-0.1683, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0759, dtype=torch.float64) delta_t tensor(0.2646, dtype=torch.float64)
6 gae_duplicate tensor(-2.1858, dtype=torch.float64) tensor(-4.8160, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2520, dtype=torch.float64) delta_t tensor(0.4293, dtype=torch.float64)
5 gae_duplicate tensor(0.0879, dtype=torch.float64) tensor(-8.6206, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3920, dtype=torch.float64) delta_t tensor(0.2349, dtype=torch.float64)
4 gae_duplicate tensor(-0.3676, dtype=torch.float64) tensor(-5.4740, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1269, dtype=torch.float64) delta_t tensor(0.0396, dtype=torch.float64)
3 gae_duplicate tensor(-0.1572, dtype=torch.float64) tensor(-1.4995, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1153, dtype=torch.float64) delta_t tensor(0.0592, dtype=torch.float64)
2 gae_duplicate tensor(-0.0783, dtype=torch.float64) tensor(-1.2650, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2299.318603515625
value loss:79.60910034179688
entropies:349.134033203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.046233177185059 seconds
19 rew tensor(0.8556, dtype=torch.float64) delta_t tensor(-0.0125, dtype=torch.float64)
19 gae_duplicate tensor(-0.1409, dtype=torch.float64) tensor(0.2006, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7976, dtype=torch.float64) delta_t tensor(0.0403, dtype=torch.float64)
18 gae_duplicate tensor(0.0047, dtype=torch.float64) tensor(-0.6924, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7690, dtype=torch.float64) delta_t tensor(0.0730, dtype=torch.float64)
17 gae_duplicate tensor(0.0237, dtype=torch.float64) tensor(-1.5420, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7121, dtype=torch.float64) delta_t tensor(0.0662, dtype=torch.float64)
16 gae_duplicate tensor(0.0321, dtype=torch.float64) tensor(-1.4734, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3739, dtype=torch.float64) delta_t tensor(-0.1521, dtype=torch.float64)
15 gae_duplicate tensor(-1.0970, dtype=torch.float64) tensor(2.8197, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4357, dtype=torch.float64) delta_t tensor(0.0351, dtype=torch.float64)
14 gae_duplicate tensor(-0.9587, dtype=torch.float64) tensor(-0.3958, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5678, dtype=torch.float64) delta_t tensor(0.1346, dtype=torch.float64)
13 gae_duplicate tensor(-0.0956, dtype=torch.float64) tensor(-2.4307, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5339, dtype=torch.float64) delta_t tensor(0.2688, dtype=torch.float64)
12 gae_duplicate tensor(0.1055, dtype=torch.float64) tensor(-5.4229, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4897, dtype=torch.float64) delta_t tensor(0.0835, dtype=torch.float64)
11 gae_duplicate tensor(-1.1501, dtype=torch.float64) tensor(-2.2293, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0851, dtype=torch.float64) delta_t tensor(0.0322, dtype=torch.float64)
10 gae_duplicate tensor(-1.8971, dtype=torch.float64) tensor(-0.4862, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.0404, dtype=torch.float64) delta_t tensor(-0.9664, dtype=torch.float64)
9 gae_duplicate tensor(-1.7832, dtype=torch.float64) tensor(19.1303, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.9308, dtype=torch.float64) delta_t tensor(-0.6523, dtype=torch.float64)
8 gae_duplicate tensor(-2.3491, dtype=torch.float64) tensor(14.5277, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3231, dtype=torch.float64) delta_t tensor(0.2695, dtype=torch.float64)
7 gae_duplicate tensor(-1.1893, dtype=torch.float64) tensor(-3.8205, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4744, dtype=torch.float64) delta_t tensor(0.2018, dtype=torch.float64)
6 gae_duplicate tensor(-3.5680, dtype=torch.float64) tensor(-4.7457, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2034, dtype=torch.float64) delta_t tensor(0.3742, dtype=torch.float64)
5 gae_duplicate tensor(0.0069, dtype=torch.float64) tensor(-7.7952, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2817, dtype=torch.float64) delta_t tensor(0.1031, dtype=torch.float64)
4 gae_duplicate tensor(-0.2397, dtype=torch.float64) tensor(-2.6720, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2247, dtype=torch.float64) delta_t tensor(-0.0187, dtype=torch.float64)
3 gae_duplicate tensor(-0.1423, dtype=torch.float64) tensor(0.1169, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3207, dtype=torch.float64) delta_t tensor(-0.0727, dtype=torch.float64)
2 gae_duplicate tensor(-0.2016, dtype=torch.float64) tensor(1.4085, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-337.3824768066406
value loss:87.95195770263672
entropies:350.0289611816406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3988.4973)
ToM Target loss= tensor(3583.7427)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.875563859939575 seconds
19 rew tensor(0.8266, dtype=torch.float64) delta_t tensor(-0.1201, dtype=torch.float64)
19 gae_duplicate tensor(-0.2283, dtype=torch.float64) tensor(2.5002, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8361, dtype=torch.float64) delta_t tensor(0.0352, dtype=torch.float64)
18 gae_duplicate tensor(-0.1032, dtype=torch.float64) tensor(-0.4849, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7304, dtype=torch.float64) delta_t tensor(0.0138, dtype=torch.float64)
17 gae_duplicate tensor(-0.1497, dtype=torch.float64) tensor(-0.5030, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7016, dtype=torch.float64) delta_t tensor(0.0253, dtype=torch.float64)
16 gae_duplicate tensor(-0.0749, dtype=torch.float64) tensor(-0.4674, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6438, dtype=torch.float64) delta_t tensor(0.0568, dtype=torch.float64)
15 gae_duplicate tensor(-0.0871, dtype=torch.float64) tensor(-1.1079, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5883, dtype=torch.float64) delta_t tensor(0.1357, dtype=torch.float64)
14 gae_duplicate tensor(0.0645, dtype=torch.float64) tensor(-2.7758, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3356, dtype=torch.float64) delta_t tensor(-0.0647, dtype=torch.float64)
13 gae_duplicate tensor(-0.9651, dtype=torch.float64) tensor(0.7198, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4838, dtype=torch.float64) delta_t tensor(0.2481, dtype=torch.float64)
12 gae_duplicate tensor(0.1383, dtype=torch.float64) tensor(-4.6970, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.0934, dtype=torch.float64) delta_t tensor(-0.6558, dtype=torch.float64)
11 gae_duplicate tensor(-1.8594, dtype=torch.float64) tensor(12.4689, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1916, dtype=torch.float64) delta_t tensor(0.4356, dtype=torch.float64)
10 gae_duplicate tensor(-1.4164, dtype=torch.float64) tensor(-7.3271, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2317, dtype=torch.float64) delta_t tensor(-0.0771, dtype=torch.float64)
9 gae_duplicate tensor(-1.5717, dtype=torch.float64) tensor(1.0047, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.9648, dtype=torch.float64) delta_t tensor(-1.2527, dtype=torch.float64)
8 gae_duplicate tensor(-3.0763, dtype=torch.float64) tensor(22.8717, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2765, dtype=torch.float64) delta_t tensor(0.7462, dtype=torch.float64)
7 gae_duplicate tensor(-0.1665, dtype=torch.float64) tensor(-12.6968, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3204, dtype=torch.float64) delta_t tensor(0.7980, dtype=torch.float64)
6 gae_duplicate tensor(0.3093, dtype=torch.float64) tensor(-17.0805, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2069, dtype=torch.float64) delta_t tensor(0.2855, dtype=torch.float64)
5 gae_duplicate tensor(0.2669, dtype=torch.float64) tensor(-7.3299, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4352, dtype=torch.float64) delta_t tensor(0.1386, dtype=torch.float64)
4 gae_duplicate tensor(-0.0134, dtype=torch.float64) tensor(-3.3658, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1601, dtype=torch.float64) delta_t tensor(-0.0880, dtype=torch.float64)
3 gae_duplicate tensor(-0.5635, dtype=torch.float64) tensor(1.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0691, dtype=torch.float64) delta_t tensor(-0.0457, dtype=torch.float64)
2 gae_duplicate tensor(-0.1310, dtype=torch.float64) tensor(1.0535, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:774.202392578125
value loss:76.52760314941406
entropies:350.6488342285156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.565914154052734 seconds
19 rew tensor(0.8741, dtype=torch.float64) delta_t tensor(-0.1548, dtype=torch.float64)
19 gae_duplicate tensor(-0.2515, dtype=torch.float64) tensor(2.8854, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6437, dtype=torch.float64) delta_t tensor(-0.2198, dtype=torch.float64)
18 gae_duplicate tensor(-1.2075, dtype=torch.float64) tensor(5.0320, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5939, dtype=torch.float64) delta_t tensor(-0.2753, dtype=torch.float64)
17 gae_duplicate tensor(-1.2094, dtype=torch.float64) tensor(5.3035, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6841, dtype=torch.float64) delta_t tensor(-0.0758, dtype=torch.float64)
16 gae_duplicate tensor(-0.1529, dtype=torch.float64) tensor(1.9189, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7216, dtype=torch.float64) delta_t tensor(-0.0082, dtype=torch.float64)
15 gae_duplicate tensor(-0.1518, dtype=torch.float64) tensor(0.3305, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5881, dtype=torch.float64) delta_t tensor(-0.0033, dtype=torch.float64)
14 gae_duplicate tensor(-0.1388, dtype=torch.float64) tensor(0.1372, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2116, dtype=torch.float64) delta_t tensor(-0.1407, dtype=torch.float64)
13 gae_duplicate tensor(-1.1707, dtype=torch.float64) tensor(2.8297, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4228, dtype=torch.float64) delta_t tensor(0.0642, dtype=torch.float64)
12 gae_duplicate tensor(-0.1445, dtype=torch.float64) tensor(-1.0285, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2960, dtype=torch.float64) delta_t tensor(0.3152, dtype=torch.float64)
11 gae_duplicate tensor(-0.8766, dtype=torch.float64) tensor(-6.6596, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0102, dtype=torch.float64) delta_t tensor(0.6896, dtype=torch.float64)
10 gae_duplicate tensor(-0.1379, dtype=torch.float64) tensor(-13.5659, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4224, dtype=torch.float64) delta_t tensor(-0.1176, dtype=torch.float64)
9 gae_duplicate tensor(-3.9207, dtype=torch.float64) tensor(0.9512, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3581, dtype=torch.float64) delta_t tensor(0.1644, dtype=torch.float64)
8 gae_duplicate tensor(-3.0973, dtype=torch.float64) tensor(-3.3122, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6273, dtype=torch.float64) delta_t tensor(0.3098, dtype=torch.float64)
7 gae_duplicate tensor(-1.0771, dtype=torch.float64) tensor(-5.7208, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1014, dtype=torch.float64) delta_t tensor(0.1554, dtype=torch.float64)
6 gae_duplicate tensor(-1.9627, dtype=torch.float64) tensor(-2.6147, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3326, dtype=torch.float64) delta_t tensor(0.0085, dtype=torch.float64)
5 gae_duplicate tensor(-0.9415, dtype=torch.float64) tensor(-0.1356, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3510, dtype=torch.float64) delta_t tensor(0.0121, dtype=torch.float64)
4 gae_duplicate tensor(-0.3428, dtype=torch.float64) tensor(-0.3389, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0439, dtype=torch.float64) delta_t tensor(-0.1975, dtype=torch.float64)
3 gae_duplicate tensor(-0.4735, dtype=torch.float64) tensor(4.1166, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2037, dtype=torch.float64) delta_t tensor(-0.0661, dtype=torch.float64)
2 gae_duplicate tensor(-0.1546, dtype=torch.float64) tensor(1.5506, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:354.41717529296875
value loss:108.84996032714844
entropies:351.4399108886719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.923982858657837 seconds
19 rew tensor(0.8635, dtype=torch.float64) delta_t tensor(-0.2031, dtype=torch.float64)
19 gae_duplicate tensor(-0.3715, dtype=torch.float64) tensor(3.7804, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8733, dtype=torch.float64) delta_t tensor(-0.0434, dtype=torch.float64)
18 gae_duplicate tensor(-0.2363, dtype=torch.float64) tensor(1.3842, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7685, dtype=torch.float64) delta_t tensor(-0.1123, dtype=torch.float64)
17 gae_duplicate tensor(-0.3406, dtype=torch.float64) tensor(2.3768, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7293, dtype=torch.float64) delta_t tensor(-0.0809, dtype=torch.float64)
16 gae_duplicate tensor(-0.1857, dtype=torch.float64) tensor(1.9759, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6750, dtype=torch.float64) delta_t tensor(-0.0168, dtype=torch.float64)
15 gae_duplicate tensor(-0.2282, dtype=torch.float64) tensor(0.5027, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6438, dtype=torch.float64) delta_t tensor(0.0992, dtype=torch.float64)
14 gae_duplicate tensor(-0.1523, dtype=torch.float64) tensor(-1.9121, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4523, dtype=torch.float64) delta_t tensor(-0.2071, dtype=torch.float64)
13 gae_duplicate tensor(-1.2136, dtype=torch.float64) tensor(3.8935, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5671, dtype=torch.float64) delta_t tensor(0.1030, dtype=torch.float64)
12 gae_duplicate tensor(-0.1412, dtype=torch.float64) tensor(-1.6065, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5152, dtype=torch.float64) delta_t tensor(-0.5645, dtype=torch.float64)
11 gae_duplicate tensor(-1.8513, dtype=torch.float64) tensor(10.5375, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0485, dtype=torch.float64) delta_t tensor(0.2810, dtype=torch.float64)
10 gae_duplicate tensor(-1.7368, dtype=torch.float64) tensor(-4.3372, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.3323, dtype=torch.float64) delta_t tensor(-1.2215, dtype=torch.float64)
9 gae_duplicate tensor(-4.0654, dtype=torch.float64) tensor(20.9422, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9953, dtype=torch.float64) delta_t tensor(-0.4264, dtype=torch.float64)
8 gae_duplicate tensor(-2.1031, dtype=torch.float64) tensor(10.5384, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0291, dtype=torch.float64) delta_t tensor(-0.3303, dtype=torch.float64)
7 gae_duplicate tensor(-2.7140, dtype=torch.float64) tensor(7.1245, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0261, dtype=torch.float64) delta_t tensor(0.3681, dtype=torch.float64)
6 gae_duplicate tensor(-0.9442, dtype=torch.float64) tensor(-6.0748, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4647, dtype=torch.float64) delta_t tensor(-0.2399, dtype=torch.float64)
5 gae_duplicate tensor(-2.2940, dtype=torch.float64) tensor(4.9640, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0626, dtype=torch.float64) delta_t tensor(-0.2541, dtype=torch.float64)
4 gae_duplicate tensor(-1.2322, dtype=torch.float64) tensor(5.7770, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0967, dtype=torch.float64) delta_t tensor(-0.2817, dtype=torch.float64)
3 gae_duplicate tensor(-0.5333, dtype=torch.float64) tensor(6.1661, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2082, dtype=torch.float64) delta_t tensor(-0.1843, dtype=torch.float64)
2 gae_duplicate tensor(-0.3626, dtype=torch.float64) tensor(4.2475, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3890.117919921875
value loss:121.47537231445312
entropies:351.8460998535156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.55580735206604 seconds
19 rew tensor(0.8634, dtype=torch.float64) delta_t tensor(-0.1969, dtype=torch.float64)
19 gae_duplicate tensor(-0.3082, dtype=torch.float64) tensor(3.8515, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7859, dtype=torch.float64) delta_t tensor(-0.1100, dtype=torch.float64)
18 gae_duplicate tensor(-0.1857, dtype=torch.float64) tensor(2.5127, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(-0.0559, dtype=torch.float64)
17 gae_duplicate tensor(-0.1230, dtype=torch.float64) tensor(1.3590, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6158, dtype=torch.float64) delta_t tensor(-0.1126, dtype=torch.float64)
16 gae_duplicate tensor(-0.2259, dtype=torch.float64) tensor(2.5811, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6720, dtype=torch.float64) delta_t tensor(-0.0128, dtype=torch.float64)
15 gae_duplicate tensor(-0.1390, dtype=torch.float64) tensor(0.4795, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4703, dtype=torch.float64) delta_t tensor(0.0396, dtype=torch.float64)
14 gae_duplicate tensor(-0.0808, dtype=torch.float64) tensor(-0.6980, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4474, dtype=torch.float64) delta_t tensor(0.2803, dtype=torch.float64)
13 gae_duplicate tensor(-0.2582, dtype=torch.float64) tensor(-5.2981, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0110, dtype=torch.float64) delta_t tensor(-0.2063, dtype=torch.float64)
12 gae_duplicate tensor(-1.1318, dtype=torch.float64) tensor(3.0183, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1869, dtype=torch.float64) delta_t tensor(0.1103, dtype=torch.float64)
11 gae_duplicate tensor(-0.9184, dtype=torch.float64) tensor(-2.2268, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1451, dtype=torch.float64) delta_t tensor(0.3951, dtype=torch.float64)
10 gae_duplicate tensor(-1.1278, dtype=torch.float64) tensor(-9.2040, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6426, dtype=torch.float64) delta_t tensor(-0.9303, dtype=torch.float64)
9 gae_duplicate tensor(-2.6024, dtype=torch.float64) tensor(16.2868, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.5455, dtype=torch.float64) delta_t tensor(-1.1112, dtype=torch.float64)
8 gae_duplicate tensor(-4.6639, dtype=torch.float64) tensor(23.0614, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4628, dtype=torch.float64) delta_t tensor(-0.1911, dtype=torch.float64)
7 gae_duplicate tensor(-1.0892, dtype=torch.float64) tensor(5.8340, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6306, dtype=torch.float64) delta_t tensor(-0.0657, dtype=torch.float64)
6 gae_duplicate tensor(-2.1169, dtype=torch.float64) tensor(1.8694, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0266, dtype=torch.float64) delta_t tensor(0.2532, dtype=torch.float64)
5 gae_duplicate tensor(-0.0625, dtype=torch.float64) tensor(-4.7517, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2118, dtype=torch.float64) delta_t tensor(-0.0427, dtype=torch.float64)
4 gae_duplicate tensor(-0.4163, dtype=torch.float64) tensor(0.3730, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0331, dtype=torch.float64) delta_t tensor(-0.0617, dtype=torch.float64)
3 gae_duplicate tensor(-0.3874, dtype=torch.float64) tensor(1.5283, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2093, dtype=torch.float64) delta_t tensor(-0.1666, dtype=torch.float64)
2 gae_duplicate tensor(-0.2487, dtype=torch.float64) tensor(3.3022, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2464.603271484375
value loss:97.869384765625
entropies:352.44500732421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.848490953445435 seconds
19 rew tensor(0.8518, dtype=torch.float64) delta_t tensor(-0.2014, dtype=torch.float64)
19 gae_duplicate tensor(-0.2822, dtype=torch.float64) tensor(4.0466, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8043, dtype=torch.float64) delta_t tensor(-0.0848, dtype=torch.float64)
18 gae_duplicate tensor(-0.2142, dtype=torch.float64) tensor(2.1402, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(-0.1072, dtype=torch.float64)
17 gae_duplicate tensor(-0.2262, dtype=torch.float64) tensor(2.3385, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7270, dtype=torch.float64) delta_t tensor(-0.0863, dtype=torch.float64)
16 gae_duplicate tensor(-0.2235, dtype=torch.float64) tensor(1.9833, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5938, dtype=torch.float64) delta_t tensor(-0.1778, dtype=torch.float64)
15 gae_duplicate tensor(-1.2673, dtype=torch.float64) tensor(3.7741, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6417, dtype=torch.float64) delta_t tensor(-0.0060, dtype=torch.float64)
14 gae_duplicate tensor(-0.2751, dtype=torch.float64) tensor(0.3679, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6923, dtype=torch.float64) delta_t tensor(0.0336, dtype=torch.float64)
13 gae_duplicate tensor(-0.1258, dtype=torch.float64) tensor(-0.6335, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5838, dtype=torch.float64) delta_t tensor(0.1660, dtype=torch.float64)
12 gae_duplicate tensor(-0.0809, dtype=torch.float64) tensor(-3.1794, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1542, dtype=torch.float64) delta_t tensor(-0.0022, dtype=torch.float64)
11 gae_duplicate tensor(-1.0374, dtype=torch.float64) tensor(0.6269, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0174, dtype=torch.float64) delta_t tensor(0.1497, dtype=torch.float64)
10 gae_duplicate tensor(-1.1744, dtype=torch.float64) tensor(-3.7962, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.9765, dtype=torch.float64) delta_t tensor(-2.2123, dtype=torch.float64)
9 gae_duplicate tensor(-5.8223, dtype=torch.float64) tensor(44.5992, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5421, dtype=torch.float64) delta_t tensor(-0.0642, dtype=torch.float64)
8 gae_duplicate tensor(-1.7027, dtype=torch.float64) tensor(6.7988, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3768, dtype=torch.float64) delta_t tensor(0.0463, dtype=torch.float64)
7 gae_duplicate tensor(-1.9383, dtype=torch.float64) tensor(0.2604, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0488, dtype=torch.float64) delta_t tensor(0.2119, dtype=torch.float64)
6 gae_duplicate tensor(-0.3338, dtype=torch.float64) tensor(-3.6694, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4756, dtype=torch.float64) delta_t tensor(-0.6497, dtype=torch.float64)
5 gae_duplicate tensor(-3.5973, dtype=torch.float64) tensor(12.3392, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0775, dtype=torch.float64) delta_t tensor(-0.1527, dtype=torch.float64)
4 gae_duplicate tensor(-0.6244, dtype=torch.float64) tensor(4.4727, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3934, dtype=torch.float64) delta_t tensor(-0.0482, dtype=torch.float64)
3 gae_duplicate tensor(-0.2157, dtype=torch.float64) tensor(1.3805, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5215, dtype=torch.float64) delta_t tensor(-0.1796, dtype=torch.float64)
2 gae_duplicate tensor(-0.3296, dtype=torch.float64) tensor(3.4777, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4271.0380859375
value loss:156.60386657714844
entropies:353.1378173828125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(4002.7266)
ToM Target loss= tensor(3594.1584)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.802268028259277 seconds
19 rew tensor(0.7861, dtype=torch.float64) delta_t tensor(-0.1666, dtype=torch.float64)
19 gae_duplicate tensor(-0.2267, dtype=torch.float64) tensor(3.1921, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5141, dtype=torch.float64) delta_t tensor(-0.2803, dtype=torch.float64)
18 gae_duplicate tensor(-1.2582, dtype=torch.float64) tensor(6.4708, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5665, dtype=torch.float64) delta_t tensor(-0.2018, dtype=torch.float64)
17 gae_duplicate tensor(-1.1767, dtype=torch.float64) tensor(4.1851, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6701, dtype=torch.float64) delta_t tensor(0.0074, dtype=torch.float64)
16 gae_duplicate tensor(-0.1407, dtype=torch.float64) tensor(0.2886, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4982, dtype=torch.float64) delta_t tensor(-0.1803, dtype=torch.float64)
15 gae_duplicate tensor(-1.0690, dtype=torch.float64) tensor(3.5788, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3383, dtype=torch.float64) delta_t tensor(-0.1183, dtype=torch.float64)
14 gae_duplicate tensor(-1.0322, dtype=torch.float64) tensor(2.2937, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4662, dtype=torch.float64) delta_t tensor(0.1646, dtype=torch.float64)
13 gae_duplicate tensor(-0.2300, dtype=torch.float64) tensor(-3.0465, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1927, dtype=torch.float64) delta_t tensor(-0.2517, dtype=torch.float64)
12 gae_duplicate tensor(-0.9267, dtype=torch.float64) tensor(4.2993, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0274, dtype=torch.float64) delta_t tensor(0.0862, dtype=torch.float64)
11 gae_duplicate tensor(-0.9092, dtype=torch.float64) tensor(-1.1807, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0454, dtype=torch.float64) delta_t tensor(0.2417, dtype=torch.float64)
10 gae_duplicate tensor(-1.0290, dtype=torch.float64) tensor(-5.0780, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3666, dtype=torch.float64) delta_t tensor(-0.3403, dtype=torch.float64)
9 gae_duplicate tensor(-1.8059, dtype=torch.float64) tensor(6.9320, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.2357, dtype=torch.float64) delta_t tensor(-1.4618, dtype=torch.float64)
8 gae_duplicate tensor(-4.7923, dtype=torch.float64) tensor(29.0076, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3148, dtype=torch.float64) delta_t tensor(0.2305, dtype=torch.float64)
7 gae_duplicate tensor(-0.7867, dtype=torch.float64) tensor(-1.6665, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5781, dtype=torch.float64) delta_t tensor(-0.2820, dtype=torch.float64)
6 gae_duplicate tensor(-2.9773, dtype=torch.float64) tensor(5.7960, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1854, dtype=torch.float64) delta_t tensor(0.1911, dtype=torch.float64)
5 gae_duplicate tensor(-0.3112, dtype=torch.float64) tensor(-3.2924, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2696, dtype=torch.float64) delta_t tensor(-0.0555, dtype=torch.float64)
4 gae_duplicate tensor(-0.3576, dtype=torch.float64) tensor(0.8034, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1531, dtype=torch.float64) delta_t tensor(-0.1752, dtype=torch.float64)
3 gae_duplicate tensor(-0.2743, dtype=torch.float64) tensor(3.3668, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2821, dtype=torch.float64) delta_t tensor(-0.1684, dtype=torch.float64)
2 gae_duplicate tensor(-0.2783, dtype=torch.float64) tensor(3.5751, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3309.80615234375
value loss:106.68911743164062
entropies:353.5213928222656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.886149168014526 seconds
19 rew tensor(0.8620, dtype=torch.float64) delta_t tensor(-0.0221, dtype=torch.float64)
19 gae_duplicate tensor(-0.0987, dtype=torch.float64) tensor(0.4439, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7776, dtype=torch.float64) delta_t tensor(0.0298, dtype=torch.float64)
18 gae_duplicate tensor(-0.0329, dtype=torch.float64) tensor(-0.5581, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7406, dtype=torch.float64) delta_t tensor(0.0502, dtype=torch.float64)
17 gae_duplicate tensor(-0.0834, dtype=torch.float64) tensor(-1.0280, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7193, dtype=torch.float64) delta_t tensor(0.0970, dtype=torch.float64)
16 gae_duplicate tensor(0.0229, dtype=torch.float64) tensor(-2.0050, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1786, dtype=torch.float64) delta_t tensor(-0.3313, dtype=torch.float64)
15 gae_duplicate tensor(-1.1382, dtype=torch.float64) tensor(6.3394, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4240, dtype=torch.float64) delta_t tensor(0.3065, dtype=torch.float64)
14 gae_duplicate tensor(-0.3044, dtype=torch.float64) tensor(-5.2777, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5692, dtype=torch.float64) delta_t tensor(0.4101, dtype=torch.float64)
13 gae_duplicate tensor(-0.0530, dtype=torch.float64) tensor(-8.9407, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4889, dtype=torch.float64) delta_t tensor(0.3219, dtype=torch.float64)
12 gae_duplicate tensor(0.1686, dtype=torch.float64) tensor(-7.4084, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2607, dtype=torch.float64) delta_t tensor(0.0763, dtype=torch.float64)
11 gae_duplicate tensor(-0.7188, dtype=torch.float64) tensor(-2.5037, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2082, dtype=torch.float64) delta_t tensor(0.2160, dtype=torch.float64)
10 gae_duplicate tensor(-0.8371, dtype=torch.float64) tensor(-5.3707, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2575, dtype=torch.float64) delta_t tensor(-0.2081, dtype=torch.float64)
9 gae_duplicate tensor(-1.4740, dtype=torch.float64) tensor(4.0121, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1014, dtype=torch.float64) delta_t tensor(-0.2353, dtype=torch.float64)
8 gae_duplicate tensor(-1.0978, dtype=torch.float64) tensor(5.1101, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2019, dtype=torch.float64) delta_t tensor(0.7981, dtype=torch.float64)
7 gae_duplicate tensor(-0.8457, dtype=torch.float64) tensor(-14.9290, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3820, dtype=torch.float64) delta_t tensor(0.1030, dtype=torch.float64)
6 gae_duplicate tensor(-2.8159, dtype=torch.float64) tensor(-3.7887, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1223, dtype=torch.float64) delta_t tensor(0.2711, dtype=torch.float64)
5 gae_duplicate tensor(-0.1454, dtype=torch.float64) tensor(-5.9093, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1811, dtype=torch.float64) delta_t tensor(0.0816, dtype=torch.float64)
4 gae_duplicate tensor(-0.2116, dtype=torch.float64) tensor(-2.0941, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1768, dtype=torch.float64) delta_t tensor(0.1110, dtype=torch.float64)
3 gae_duplicate tensor(-0.0379, dtype=torch.float64) tensor(-2.3220, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3025, dtype=torch.float64) delta_t tensor(-0.0748, dtype=torch.float64)
2 gae_duplicate tensor(-0.1678, dtype=torch.float64) tensor(1.2286, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2334.50439453125
value loss:67.9675064086914
entropies:353.9679260253906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.037832021713257 seconds
19 rew tensor(0.8822, dtype=torch.float64) delta_t tensor(0.0557, dtype=torch.float64)
19 gae_duplicate tensor(-0.0002, dtype=torch.float64) tensor(-1.0967, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8172, dtype=torch.float64) delta_t tensor(0.1509, dtype=torch.float64)
18 gae_duplicate tensor(0.0371, dtype=torch.float64) tensor(-2.9979, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7790, dtype=torch.float64) delta_t tensor(0.1233, dtype=torch.float64)
17 gae_duplicate tensor(0.0390, dtype=torch.float64) tensor(-2.8869, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7017, dtype=torch.float64) delta_t tensor(0.1578, dtype=torch.float64)
16 gae_duplicate tensor(0.1440, dtype=torch.float64) tensor(-3.4792, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6473, dtype=torch.float64) delta_t tensor(0.1536, dtype=torch.float64)
15 gae_duplicate tensor(0.0543, dtype=torch.float64) tensor(-3.4077, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3372, dtype=torch.float64) delta_t tensor(0.2482, dtype=torch.float64)
14 gae_duplicate tensor(0.1344, dtype=torch.float64) tensor(-5.2025, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6581, dtype=torch.float64) delta_t tensor(0.7499, dtype=torch.float64)
13 gae_duplicate tensor(0.0530, dtype=torch.float64) tensor(-15.4589, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3843, dtype=torch.float64) delta_t tensor(0.3959, dtype=torch.float64)
12 gae_duplicate tensor(0.2585, dtype=torch.float64) tensor(-9.1779, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6164, dtype=torch.float64) delta_t tensor(-0.0403, dtype=torch.float64)
11 gae_duplicate tensor(-0.6827, dtype=torch.float64) tensor(-0.0968, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0966, dtype=torch.float64) delta_t tensor(0.5372, dtype=torch.float64)
10 gae_duplicate tensor(0.2771, dtype=torch.float64) tensor(-10.4780, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9665, dtype=torch.float64) delta_t tensor(0.1923, dtype=torch.float64)
9 gae_duplicate tensor(-0.7138, dtype=torch.float64) tensor(-5.3733, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.9615, dtype=torch.float64) delta_t tensor(-0.8552, dtype=torch.float64)
8 gae_duplicate tensor(-3.3873, dtype=torch.float64) tensor(16.3695, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3242, dtype=torch.float64) delta_t tensor(0.8412, dtype=torch.float64)
7 gae_duplicate tensor(-0.7843, dtype=torch.float64) tensor(-14.8077, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1338, dtype=torch.float64) delta_t tensor(1.0161, dtype=torch.float64)
6 gae_duplicate tensor(0.5184, dtype=torch.float64) tensor(-21.3096, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2865, dtype=torch.float64) delta_t tensor(0.3148, dtype=torch.float64)
5 gae_duplicate tensor(0.2900, dtype=torch.float64) tensor(-8.5432, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1350, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
4 gae_duplicate tensor(-0.1275, dtype=torch.float64) tensor(-1.9283, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2863, dtype=torch.float64) delta_t tensor(0.0109, dtype=torch.float64)
3 gae_duplicate tensor(-0.0829, dtype=torch.float64) tensor(-0.3711, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3758, dtype=torch.float64) delta_t tensor(-0.0241, dtype=torch.float64)
2 gae_duplicate tensor(-0.1292, dtype=torch.float64) tensor(0.4216, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4754.81298828125
value loss:72.20225524902344
entropies:354.4814147949219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.380788087844849 seconds
19 rew tensor(0.8624, dtype=torch.float64) delta_t tensor(-0.0103, dtype=torch.float64)
19 gae_duplicate tensor(-0.1068, dtype=torch.float64) tensor(0.1768, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8431, dtype=torch.float64) delta_t tensor(0.0856, dtype=torch.float64)
18 gae_duplicate tensor(0.0445, dtype=torch.float64) tensor(-1.6656, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7947, dtype=torch.float64) delta_t tensor(0.0638, dtype=torch.float64)
17 gae_duplicate tensor(-0.0384, dtype=torch.float64) tensor(-1.3777, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8059, dtype=torch.float64) delta_t tensor(0.1018, dtype=torch.float64)
16 gae_duplicate tensor(0.0196, dtype=torch.float64) tensor(-2.1895, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7110, dtype=torch.float64) delta_t tensor(0.0763, dtype=torch.float64)
15 gae_duplicate tensor(-0.0065, dtype=torch.float64) tensor(-1.7515, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6936, dtype=torch.float64) delta_t tensor(0.1465, dtype=torch.float64)
14 gae_duplicate tensor(0.0230, dtype=torch.float64) tensor(-3.1557, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6423, dtype=torch.float64) delta_t tensor(0.1978, dtype=torch.float64)
13 gae_duplicate tensor(-0.0145, dtype=torch.float64) tensor(-4.3710, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6107, dtype=torch.float64) delta_t tensor(0.4286, dtype=torch.float64)
12 gae_duplicate tensor(0.1282, dtype=torch.float64) tensor(-9.0828, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3571, dtype=torch.float64) delta_t tensor(0.5727, dtype=torch.float64)
11 gae_duplicate tensor(0.1071, dtype=torch.float64) tensor(-12.0056, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4293, dtype=torch.float64) delta_t tensor(-0.1805, dtype=torch.float64)
10 gae_duplicate tensor(-1.2174, dtype=torch.float64) tensor(2.0710, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.8353, dtype=torch.float64) delta_t tensor(-1.2402, dtype=torch.float64)
9 gae_duplicate tensor(-4.7599, dtype=torch.float64) tensor(23.8388, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4257, dtype=torch.float64) delta_t tensor(-0.2771, dtype=torch.float64)
8 gae_duplicate tensor(-2.9517, dtype=torch.float64) tensor(7.0910, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8148, dtype=torch.float64) delta_t tensor(0.1162, dtype=torch.float64)
7 gae_duplicate tensor(-1.8448, dtype=torch.float64) tensor(-1.7484, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6480, dtype=torch.float64) delta_t tensor(-0.3990, dtype=torch.float64)
6 gae_duplicate tensor(-2.6036, dtype=torch.float64) tensor(7.0435, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5010, dtype=torch.float64) delta_t tensor(-0.1391, dtype=torch.float64)
5 gae_duplicate tensor(-1.0872, dtype=torch.float64) tensor(3.4352, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2330, dtype=torch.float64) delta_t tensor(-0.0011, dtype=torch.float64)
4 gae_duplicate tensor(-0.3775, dtype=torch.float64) tensor(0.2916, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0484, dtype=torch.float64) delta_t tensor(-0.1496, dtype=torch.float64)
3 gae_duplicate tensor(-0.4924, dtype=torch.float64) tensor(3.1346, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1776, dtype=torch.float64) delta_t tensor(-0.0051, dtype=torch.float64)
2 gae_duplicate tensor(-0.0886, dtype=torch.float64) tensor(0.4086, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-643.599609375
value loss:113.6008071899414
entropies:354.98431396484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0325539112091064 seconds
19 rew tensor(0.8340, dtype=torch.float64) delta_t tensor(-0.0141, dtype=torch.float64)
19 gae_duplicate tensor(-0.1548, dtype=torch.float64) tensor(0.2545, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5973, dtype=torch.float64) delta_t tensor(-0.1272, dtype=torch.float64)
18 gae_duplicate tensor(-1.0946, dtype=torch.float64) tensor(2.7448, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5567, dtype=torch.float64) delta_t tensor(-0.1242, dtype=torch.float64)
17 gae_duplicate tensor(-1.1067, dtype=torch.float64) tensor(2.7924, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4728, dtype=torch.float64) delta_t tensor(-0.1000, dtype=torch.float64)
16 gae_duplicate tensor(-0.8385, dtype=torch.float64) tensor(2.3391, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6044, dtype=torch.float64) delta_t tensor(0.0447, dtype=torch.float64)
15 gae_duplicate tensor(-0.1135, dtype=torch.float64) tensor(-0.6266, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5783, dtype=torch.float64) delta_t tensor(0.3486, dtype=torch.float64)
14 gae_duplicate tensor(0.0561, dtype=torch.float64) tensor(-6.8961, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5760, dtype=torch.float64) delta_t tensor(0.4736, dtype=torch.float64)
13 gae_duplicate tensor(0.0269, dtype=torch.float64) tensor(-9.8997, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3881, dtype=torch.float64) delta_t tensor(0.3770, dtype=torch.float64)
12 gae_duplicate tensor(-0.7358, dtype=torch.float64) tensor(-8.8961, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3349, dtype=torch.float64) delta_t tensor(0.2181, dtype=torch.float64)
11 gae_duplicate tensor(-0.8418, dtype=torch.float64) tensor(-5.1122, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1076, dtype=torch.float64) delta_t tensor(0.3544, dtype=torch.float64)
10 gae_duplicate tensor(-0.9763, dtype=torch.float64) tensor(-7.5330, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.1020, dtype=torch.float64) delta_t tensor(-1.0590, dtype=torch.float64)
9 gae_duplicate tensor(-2.8296, dtype=torch.float64) tensor(19.3715, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9194, dtype=torch.float64) delta_t tensor(-0.1252, dtype=torch.float64)
8 gae_duplicate tensor(-1.7839, dtype=torch.float64) tensor(4.5545, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5690, dtype=torch.float64) delta_t tensor(0.2426, dtype=torch.float64)
7 gae_duplicate tensor(-2.1594, dtype=torch.float64) tensor(-4.2380, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2451, dtype=torch.float64) delta_t tensor(0.4844, dtype=torch.float64)
6 gae_duplicate tensor(0.0626, dtype=torch.float64) tensor(-9.9564, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0033, dtype=torch.float64) delta_t tensor(0.2686, dtype=torch.float64)
5 gae_duplicate tensor(-0.1636, dtype=torch.float64) tensor(-6.2209, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1792, dtype=torch.float64) delta_t tensor(0.0403, dtype=torch.float64)
4 gae_duplicate tensor(-0.3018, dtype=torch.float64) tensor(-1.4494, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1768, dtype=torch.float64) delta_t tensor(-0.1208, dtype=torch.float64)
3 gae_duplicate tensor(-0.3773, dtype=torch.float64) tensor(2.2875, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3059, dtype=torch.float64) delta_t tensor(-0.0815, dtype=torch.float64)
2 gae_duplicate tensor(-0.1689, dtype=torch.float64) tensor(1.7889, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1237.5726318359375
value loss:84.96778869628906
entropies:355.44854736328125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3999.9492)
ToM Target loss= tensor(3604.2446)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.905045032501221 seconds
19 rew tensor(0.8638, dtype=torch.float64) delta_t tensor(-0.1227, dtype=torch.float64)
19 gae_duplicate tensor(-0.1741, dtype=torch.float64) tensor(2.4143, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6262, dtype=torch.float64) delta_t tensor(-0.2099, dtype=torch.float64)
18 gae_duplicate tensor(-1.1591, dtype=torch.float64) tensor(4.3961, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8446, dtype=torch.float64) delta_t tensor(-0.0268, dtype=torch.float64)
17 gae_duplicate tensor(-0.1336, dtype=torch.float64) tensor(0.9775, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6734, dtype=torch.float64) delta_t tensor(-0.0398, dtype=torch.float64)
16 gae_duplicate tensor(-0.1511, dtype=torch.float64) tensor(0.8916, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4999, dtype=torch.float64) delta_t tensor(-0.2073, dtype=torch.float64)
15 gae_duplicate tensor(-1.2204, dtype=torch.float64) tensor(4.2289, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4059, dtype=torch.float64) delta_t tensor(-0.1019, dtype=torch.float64)
14 gae_duplicate tensor(-0.9344, dtype=torch.float64) tensor(2.3685, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4416, dtype=torch.float64) delta_t tensor(0.0518, dtype=torch.float64)
13 gae_duplicate tensor(-1.1846, dtype=torch.float64) tensor(-0.8811, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4908, dtype=torch.float64) delta_t tensor(0.2438, dtype=torch.float64)
12 gae_duplicate tensor(-0.1801, dtype=torch.float64) tensor(-4.9425, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3957, dtype=torch.float64) delta_t tensor(-0.2253, dtype=torch.float64)
11 gae_duplicate tensor(-1.2653, dtype=torch.float64) tensor(4.1180, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0398, dtype=torch.float64) delta_t tensor(0.1625, dtype=torch.float64)
10 gae_duplicate tensor(-0.7852, dtype=torch.float64) tensor(-2.9350, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0561, dtype=torch.float64) delta_t tensor(-0.2879, dtype=torch.float64)
9 gae_duplicate tensor(-3.4076, dtype=torch.float64) tensor(5.7914, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0310, dtype=torch.float64) delta_t tensor(-0.2325, dtype=torch.float64)
8 gae_duplicate tensor(-1.9458, dtype=torch.float64) tensor(5.2773, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2622, dtype=torch.float64) delta_t tensor(0.6526, dtype=torch.float64)
7 gae_duplicate tensor(-0.2134, dtype=torch.float64) tensor(-12.2966, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1351, dtype=torch.float64) delta_t tensor(0.5182, dtype=torch.float64)
6 gae_duplicate tensor(-0.0350, dtype=torch.float64) tensor(-11.4591, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1881, dtype=torch.float64) delta_t tensor(-0.0903, dtype=torch.float64)
5 gae_duplicate tensor(-0.2228, dtype=torch.float64) tensor(0.6671, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1369, dtype=torch.float64) delta_t tensor(-0.1345, dtype=torch.float64)
4 gae_duplicate tensor(-0.4164, dtype=torch.float64) tensor(2.7121, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1897, dtype=torch.float64) delta_t tensor(-0.1562, dtype=torch.float64)
3 gae_duplicate tensor(-0.2936, dtype=torch.float64) tensor(3.3567, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4135, dtype=torch.float64) delta_t tensor(-0.1096, dtype=torch.float64)
2 gae_duplicate tensor(-0.2193, dtype=torch.float64) tensor(2.5139, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-484.81134033203125
value loss:64.43651580810547
entropies:355.783447265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.844721078872681 seconds
19 rew tensor(0.8538, dtype=torch.float64) delta_t tensor(-0.1937, dtype=torch.float64)
19 gae_duplicate tensor(-0.3174, dtype=torch.float64) tensor(3.8162, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5704, dtype=torch.float64) delta_t tensor(-0.3147, dtype=torch.float64)
18 gae_duplicate tensor(-1.2956, dtype=torch.float64) tensor(6.6049, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8068, dtype=torch.float64) delta_t tensor(-0.0731, dtype=torch.float64)
17 gae_duplicate tensor(-0.1572, dtype=torch.float64) tensor(2.1005, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6662, dtype=torch.float64) delta_t tensor(-0.0979, dtype=torch.float64)
16 gae_duplicate tensor(-0.1668, dtype=torch.float64) tensor(2.1665, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4553, dtype=torch.float64) delta_t tensor(-0.3145, dtype=torch.float64)
15 gae_duplicate tensor(-1.1179, dtype=torch.float64) tensor(6.4148, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1500, dtype=torch.float64) delta_t tensor(-0.3125, dtype=torch.float64)
14 gae_duplicate tensor(-1.1455, dtype=torch.float64) tensor(6.8381, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6539, dtype=torch.float64) delta_t tensor(0.2381, dtype=torch.float64)
13 gae_duplicate tensor(-0.2605, dtype=torch.float64) tensor(-3.9797, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3998, dtype=torch.float64) delta_t tensor(0.0549, dtype=torch.float64)
12 gae_duplicate tensor(-0.0212, dtype=torch.float64) tensor(-1.4823, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2879, dtype=torch.float64) delta_t tensor(-0.0890, dtype=torch.float64)
11 gae_duplicate tensor(-1.1951, dtype=torch.float64) tensor(1.6219, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0600, dtype=torch.float64) delta_t tensor(-0.1261, dtype=torch.float64)
10 gae_duplicate tensor(-1.2277, dtype=torch.float64) tensor(2.7176, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0387, dtype=torch.float64) delta_t tensor(-0.3184, dtype=torch.float64)
9 gae_duplicate tensor(-4.0476, dtype=torch.float64) tensor(6.3726, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.9004, dtype=torch.float64) delta_t tensor(-0.8005, dtype=torch.float64)
8 gae_duplicate tensor(-2.0349, dtype=torch.float64) tensor(16.4961, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0919, dtype=torch.float64) delta_t tensor(-0.1674, dtype=torch.float64)
7 gae_duplicate tensor(-1.5370, dtype=torch.float64) tensor(4.9931, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3123, dtype=torch.float64) delta_t tensor(0.3288, dtype=torch.float64)
6 gae_duplicate tensor(-2.5032, dtype=torch.float64) tensor(-5.9617, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3468, dtype=torch.float64) delta_t tensor(0.0148, dtype=torch.float64)
5 gae_duplicate tensor(-0.4501, dtype=torch.float64) tensor(-0.8800, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0230, dtype=torch.float64) delta_t tensor(-0.2159, dtype=torch.float64)
4 gae_duplicate tensor(-0.4137, dtype=torch.float64) tensor(4.1894, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3705, dtype=torch.float64) delta_t tensor(-0.2200, dtype=torch.float64)
3 gae_duplicate tensor(-0.3592, dtype=torch.float64) tensor(4.7811, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4620, dtype=torch.float64) delta_t tensor(-0.2540, dtype=torch.float64)
2 gae_duplicate tensor(-0.3852, dtype=torch.float64) tensor(5.5134, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3461.510498046875
value loss:92.57433319091797
entropies:355.90814208984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.637849807739258 seconds
19 rew tensor(0.8634, dtype=torch.float64) delta_t tensor(-0.1559, dtype=torch.float64)
19 gae_duplicate tensor(-0.2333, dtype=torch.float64) tensor(3.0842, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6259, dtype=torch.float64) delta_t tensor(-0.2342, dtype=torch.float64)
18 gae_duplicate tensor(-1.3176, dtype=torch.float64) tensor(4.9322, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7987, dtype=torch.float64) delta_t tensor(-0.0696, dtype=torch.float64)
17 gae_duplicate tensor(-0.1502, dtype=torch.float64) tensor(1.8706, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6765, dtype=torch.float64) delta_t tensor(-0.0475, dtype=torch.float64)
16 gae_duplicate tensor(-0.1137, dtype=torch.float64) tensor(1.1219, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7211, dtype=torch.float64) delta_t tensor(-0.0425, dtype=torch.float64)
15 gae_duplicate tensor(-0.1895, dtype=torch.float64) tensor(0.9561, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3531, dtype=torch.float64) delta_t tensor(-0.1874, dtype=torch.float64)
14 gae_duplicate tensor(-1.1134, dtype=torch.float64) tensor(3.8294, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4997, dtype=torch.float64) delta_t tensor(0.0966, dtype=torch.float64)
13 gae_duplicate tensor(-0.4054, dtype=torch.float64) tensor(-1.5102, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3335, dtype=torch.float64) delta_t tensor(-0.0150, dtype=torch.float64)
12 gae_duplicate tensor(-1.1457, dtype=torch.float64) tensor(0.1415, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2123, dtype=torch.float64) delta_t tensor(-0.3249, dtype=torch.float64)
11 gae_duplicate tensor(-1.2133, dtype=torch.float64) tensor(6.4542, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3526, dtype=torch.float64) delta_t tensor(0.4535, dtype=torch.float64)
10 gae_duplicate tensor(0.0105, dtype=torch.float64) tensor(-8.3243, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9115, dtype=torch.float64) delta_t tensor(-0.2204, dtype=torch.float64)
9 gae_duplicate tensor(-3.0115, dtype=torch.float64) tensor(3.5184, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1194, dtype=torch.float64) delta_t tensor(0.3398, dtype=torch.float64)
8 gae_duplicate tensor(-0.5142, dtype=torch.float64) tensor(-6.3880, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0520, dtype=torch.float64) delta_t tensor(-1.0061, dtype=torch.float64)
7 gae_duplicate tensor(-1.4402, dtype=torch.float64) tensor(19.2093, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4713, dtype=torch.float64) delta_t tensor(-0.2193, dtype=torch.float64)
6 gae_duplicate tensor(-2.0988, dtype=torch.float64) tensor(6.2506, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0463, dtype=torch.float64) delta_t tensor(-0.1407, dtype=torch.float64)
5 gae_duplicate tensor(-0.6603, dtype=torch.float64) tensor(3.4073, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0848, dtype=torch.float64) delta_t tensor(-0.1446, dtype=torch.float64)
4 gae_duplicate tensor(-0.4357, dtype=torch.float64) tensor(3.1958, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2082, dtype=torch.float64) delta_t tensor(-0.2050, dtype=torch.float64)
3 gae_duplicate tensor(-0.3278, dtype=torch.float64) tensor(4.3811, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3108, dtype=torch.float64) delta_t tensor(-0.2142, dtype=torch.float64)
2 gae_duplicate tensor(-0.3283, dtype=torch.float64) tensor(4.6729, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2839.46728515625
value loss:60.08795166015625
entropies:355.9422607421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.831753969192505 seconds
19 rew tensor(0.8729, dtype=torch.float64) delta_t tensor(0.0537, dtype=torch.float64)
19 gae_duplicate tensor(-0.0184, dtype=torch.float64) tensor(-1.0587, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5694, dtype=torch.float64) delta_t tensor(-0.0891, dtype=torch.float64)
18 gae_duplicate tensor(-1.0815, dtype=torch.float64) tensor(1.6728, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8450, dtype=torch.float64) delta_t tensor(0.1306, dtype=torch.float64)
17 gae_duplicate tensor(0.0175, dtype=torch.float64) tensor(-2.4196, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7142, dtype=torch.float64) delta_t tensor(0.1093, dtype=torch.float64)
16 gae_duplicate tensor(-0.0232, dtype=torch.float64) tensor(-2.4009, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6436, dtype=torch.float64) delta_t tensor(0.0512, dtype=torch.float64)
15 gae_duplicate tensor(-0.9700, dtype=torch.float64) tensor(-1.2686, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4951, dtype=torch.float64) delta_t tensor(0.0056, dtype=torch.float64)
14 gae_duplicate tensor(-0.8733, dtype=torch.float64) tensor(-0.2202, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7306, dtype=torch.float64) delta_t tensor(0.2647, dtype=torch.float64)
13 gae_duplicate tensor(0.0074, dtype=torch.float64) tensor(-5.2586, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4356, dtype=torch.float64) delta_t tensor(0.2452, dtype=torch.float64)
12 gae_duplicate tensor(-0.8698, dtype=torch.float64) tensor(-5.4008, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1004, dtype=torch.float64) delta_t tensor(0.0418, dtype=torch.float64)
11 gae_duplicate tensor(-0.9756, dtype=torch.float64) tensor(-1.3695, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1704, dtype=torch.float64) delta_t tensor(0.3310, dtype=torch.float64)
10 gae_duplicate tensor(-1.4297, dtype=torch.float64) tensor(-6.7317, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.9922, dtype=torch.float64) delta_t tensor(-0.6615, dtype=torch.float64)
9 gae_duplicate tensor(-2.6143, dtype=torch.float64) tensor(12.4657, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8345, dtype=torch.float64) delta_t tensor(-0.5689, dtype=torch.float64)
8 gae_duplicate tensor(-1.5513, dtype=torch.float64) tensor(12.5009, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7400, dtype=torch.float64) delta_t tensor(0.2251, dtype=torch.float64)
7 gae_duplicate tensor(-1.1933, dtype=torch.float64) tensor(-3.1037, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1874, dtype=torch.float64) delta_t tensor(0.3018, dtype=torch.float64)
6 gae_duplicate tensor(-1.1355, dtype=torch.float64) tensor(-6.2984, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2392, dtype=torch.float64) delta_t tensor(-0.0520, dtype=torch.float64)
5 gae_duplicate tensor(-1.0346, dtype=torch.float64) tensor(0.3942, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3446, dtype=torch.float64) delta_t tensor(-0.0444, dtype=torch.float64)
4 gae_duplicate tensor(-0.4482, dtype=torch.float64) tensor(0.9220, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0908, dtype=torch.float64) delta_t tensor(-0.1195, dtype=torch.float64)
3 gae_duplicate tensor(-0.2996, dtype=torch.float64) tensor(2.4591, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2572, dtype=torch.float64) delta_t tensor(-0.0473, dtype=torch.float64)
2 gae_duplicate tensor(-0.1467, dtype=torch.float64) tensor(1.1859, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:116.12274169921875
value loss:71.99018859863281
entropies:355.9423828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6794819831848145 seconds
19 rew tensor(0.8637, dtype=torch.float64) delta_t tensor(0.1256, dtype=torch.float64)
19 gae_duplicate tensor(0.0233, dtype=torch.float64) tensor(-2.4884, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8062, dtype=torch.float64) delta_t tensor(0.2050, dtype=torch.float64)
18 gae_duplicate tensor(0.0962, dtype=torch.float64) tensor(-4.3080, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8256, dtype=torch.float64) delta_t tensor(0.2056, dtype=torch.float64)
17 gae_duplicate tensor(0.1140, dtype=torch.float64) tensor(-4.4712, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5954, dtype=torch.float64) delta_t tensor(0.2254, dtype=torch.float64)
16 gae_duplicate tensor(0.1610, dtype=torch.float64) tensor(-4.9265, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7126, dtype=torch.float64) delta_t tensor(0.1457, dtype=torch.float64)
15 gae_duplicate tensor(0.1157, dtype=torch.float64) tensor(-3.3689, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3980, dtype=torch.float64) delta_t tensor(0.3057, dtype=torch.float64)
14 gae_duplicate tensor(0.1299, dtype=torch.float64) tensor(-6.3774, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3378, dtype=torch.float64) delta_t tensor(0.0843, dtype=torch.float64)
13 gae_duplicate tensor(-1.0280, dtype=torch.float64) tensor(-2.2692, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2647, dtype=torch.float64) delta_t tensor(0.3346, dtype=torch.float64)
12 gae_duplicate tensor(0.1523, dtype=torch.float64) tensor(-6.8745, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3762, dtype=torch.float64) delta_t tensor(0.3913, dtype=torch.float64)
11 gae_duplicate tensor(0.0076, dtype=torch.float64) tensor(-8.4650, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2360, dtype=torch.float64) delta_t tensor(0.2027, dtype=torch.float64)
10 gae_duplicate tensor(-0.8732, dtype=torch.float64) tensor(-4.8410, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6868, dtype=torch.float64) delta_t tensor(-0.1802, dtype=torch.float64)
9 gae_duplicate tensor(-2.5744, dtype=torch.float64) tensor(3.1666, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4724, dtype=torch.float64) delta_t tensor(0.5666, dtype=torch.float64)
8 gae_duplicate tensor(0.1645, dtype=torch.float64) tensor(-10.8918, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.6631, dtype=torch.float64) delta_t tensor(0.0771, dtype=torch.float64)
7 gae_duplicate tensor(-0.1747, dtype=torch.float64) tensor(-2.5933, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3852, dtype=torch.float64) delta_t tensor(0.7413, dtype=torch.float64)
6 gae_duplicate tensor(0.1842, dtype=torch.float64) tensor(-14.8611, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4727, dtype=torch.float64) delta_t tensor(-0.0203, dtype=torch.float64)
5 gae_duplicate tensor(-0.2084, dtype=torch.float64) tensor(-1.0838, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4056, dtype=torch.float64) delta_t tensor(-0.0668, dtype=torch.float64)
4 gae_duplicate tensor(-0.2681, dtype=torch.float64) tensor(1.2324, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5983, dtype=torch.float64) delta_t tensor(0.0297, dtype=torch.float64)
3 gae_duplicate tensor(-0.0262, dtype=torch.float64) tensor(-0.4641, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6525, dtype=torch.float64) delta_t tensor(-0.0852, dtype=torch.float64)
2 gae_duplicate tensor(-0.1886, dtype=torch.float64) tensor(1.6257, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3805.916259765625
value loss:48.2354736328125
entropies:355.9077453613281
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3998.2322)
ToM Target loss= tensor(3608.4160)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.927947044372559 seconds
19 rew tensor(0.8449, dtype=torch.float64) delta_t tensor(0.1395, dtype=torch.float64)
19 gae_duplicate tensor(0.0373, dtype=torch.float64) tensor(-2.7637, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5569, dtype=torch.float64) delta_t tensor(-0.0189, dtype=torch.float64)
18 gae_duplicate tensor(-0.9372, dtype=torch.float64) tensor(0.0547, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8061, dtype=torch.float64) delta_t tensor(0.2303, dtype=torch.float64)
17 gae_duplicate tensor(0.1495, dtype=torch.float64) tensor(-4.5395, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6555, dtype=torch.float64) delta_t tensor(0.2126, dtype=torch.float64)
16 gae_duplicate tensor(0.1476, dtype=torch.float64) tensor(-4.6081, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6737, dtype=torch.float64) delta_t tensor(0.2441, dtype=torch.float64)
15 gae_duplicate tensor(0.1033, dtype=torch.float64) tensor(-5.2877, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0263, dtype=torch.float64) delta_t tensor(-0.2470, dtype=torch.float64)
14 gae_duplicate tensor(-0.9124, dtype=torch.float64) tensor(4.4010, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4327, dtype=torch.float64) delta_t tensor(0.3371, dtype=torch.float64)
13 gae_duplicate tensor(-0.3649, dtype=torch.float64) tensor(-6.0961, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5537, dtype=torch.float64) delta_t tensor(0.3684, dtype=torch.float64)
12 gae_duplicate tensor(0.1784, dtype=torch.float64) tensor(-7.9242, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8953, dtype=torch.float64) delta_t tensor(-0.1983, dtype=torch.float64)
11 gae_duplicate tensor(-1.0257, dtype=torch.float64) tensor(3.0150, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2101, dtype=torch.float64) delta_t tensor(0.4547, dtype=torch.float64)
10 gae_duplicate tensor(-0.6947, dtype=torch.float64) tensor(-8.8423, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.0910, dtype=torch.float64) delta_t tensor(-0.6436, dtype=torch.float64)
9 gae_duplicate tensor(-1.5088, dtype=torch.float64) tensor(11.7862, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6381, dtype=torch.float64) delta_t tensor(-0.6188, dtype=torch.float64)
8 gae_duplicate tensor(-3.8760, dtype=torch.float64) tensor(13.8762, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0482, dtype=torch.float64) delta_t tensor(0.4422, dtype=torch.float64)
7 gae_duplicate tensor(-1.0443, dtype=torch.float64) tensor(-7.1639, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2135, dtype=torch.float64) delta_t tensor(0.1701, dtype=torch.float64)
6 gae_duplicate tensor(-2.5685, dtype=torch.float64) tensor(-4.0762, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1163, dtype=torch.float64) delta_t tensor(0.2930, dtype=torch.float64)
5 gae_duplicate tensor(-0.0265, dtype=torch.float64) tensor(-6.1934, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3327, dtype=torch.float64) delta_t tensor(0.0654, dtype=torch.float64)
4 gae_duplicate tensor(-0.2834, dtype=torch.float64) tensor(-1.9041, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1755, dtype=torch.float64) delta_t tensor(-0.0252, dtype=torch.float64)
3 gae_duplicate tensor(-0.0811, dtype=torch.float64) tensor(0.3022, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2988, dtype=torch.float64) delta_t tensor(-0.0277, dtype=torch.float64)
2 gae_duplicate tensor(-0.1431, dtype=torch.float64) tensor(0.5918, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1274.0247802734375
value loss:83.99659729003906
entropies:355.7995910644531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.547389030456543 seconds
19 rew tensor(0.8626, dtype=torch.float64) delta_t tensor(0.1698, dtype=torch.float64)
19 gae_duplicate tensor(0.0618, dtype=torch.float64) tensor(-3.3684, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6230, dtype=torch.float64) delta_t tensor(0.0386, dtype=torch.float64)
18 gae_duplicate tensor(-0.9380, dtype=torch.float64) tensor(-1.1015, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8441, dtype=torch.float64) delta_t tensor(0.2529, dtype=torch.float64)
17 gae_duplicate tensor(0.1884, dtype=torch.float64) tensor(-5.1320, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7882, dtype=torch.float64) delta_t tensor(0.2909, dtype=torch.float64)
16 gae_duplicate tensor(0.2524, dtype=torch.float64) tensor(-6.2363, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5767, dtype=torch.float64) delta_t tensor(0.1200, dtype=torch.float64)
15 gae_duplicate tensor(-0.7882, dtype=torch.float64) tensor(-2.9724, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6653, dtype=torch.float64) delta_t tensor(0.3065, dtype=torch.float64)
14 gae_duplicate tensor(0.0482, dtype=torch.float64) tensor(-6.3429, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6719, dtype=torch.float64) delta_t tensor(0.3621, dtype=torch.float64)
13 gae_duplicate tensor(0.1102, dtype=torch.float64) tensor(-7.7665, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5186, dtype=torch.float64) delta_t tensor(0.2909, dtype=torch.float64)
12 gae_duplicate tensor(-0.1236, dtype=torch.float64) tensor(-6.4212, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4627, dtype=torch.float64) delta_t tensor(0.5294, dtype=torch.float64)
11 gae_duplicate tensor(0.0615, dtype=torch.float64) tensor(-10.9800, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0040, dtype=torch.float64) delta_t tensor(0.2108, dtype=torch.float64)
10 gae_duplicate tensor(-1.1831, dtype=torch.float64) tensor(-5.3498, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.9738, dtype=torch.float64) delta_t tensor(-1.6113, dtype=torch.float64)
9 gae_duplicate tensor(-3.7262, dtype=torch.float64) tensor(31.9608, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8634, dtype=torch.float64) delta_t tensor(-0.3747, dtype=torch.float64)
8 gae_duplicate tensor(-2.2231, dtype=torch.float64) tensor(10.8359, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7106, dtype=torch.float64) delta_t tensor(0.1998, dtype=torch.float64)
7 gae_duplicate tensor(-0.5918, dtype=torch.float64) tensor(-2.8972, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0870, dtype=torch.float64) delta_t tensor(-0.1618, dtype=torch.float64)
6 gae_duplicate tensor(-0.9803, dtype=torch.float64) tensor(2.9826, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7081, dtype=torch.float64) delta_t tensor(-0.4202, dtype=torch.float64)
5 gae_duplicate tensor(-3.5846, dtype=torch.float64) tensor(8.8533, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3764, dtype=torch.float64) delta_t tensor(0.1146, dtype=torch.float64)
4 gae_duplicate tensor(-0.1037, dtype=torch.float64) tensor(-1.4520, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0633, dtype=torch.float64) delta_t tensor(-0.0032, dtype=torch.float64)
3 gae_duplicate tensor(-0.2175, dtype=torch.float64) tensor(-0.1060, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2165, dtype=torch.float64) delta_t tensor(-0.0526, dtype=torch.float64)
2 gae_duplicate tensor(-0.2216, dtype=torch.float64) tensor(0.9757, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:147.96380615234375
value loss:118.54783630371094
entropies:355.5804138183594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.869556188583374 seconds
19 rew tensor(0.8535, dtype=torch.float64) delta_t tensor(0.1254, dtype=torch.float64)
19 gae_duplicate tensor(-0.0129, dtype=torch.float64) tensor(-2.4527, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7499, dtype=torch.float64) delta_t tensor(0.1564, dtype=torch.float64)
18 gae_duplicate tensor(0.0738, dtype=torch.float64) tensor(-3.4125, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7395, dtype=torch.float64) delta_t tensor(0.2003, dtype=torch.float64)
17 gae_duplicate tensor(0.1443, dtype=torch.float64) tensor(-4.3151, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6444, dtype=torch.float64) delta_t tensor(0.1508, dtype=torch.float64)
16 gae_duplicate tensor(0.0253, dtype=torch.float64) tensor(-3.4378, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5114, dtype=torch.float64) delta_t tensor(0.1959, dtype=torch.float64)
15 gae_duplicate tensor(0.0523, dtype=torch.float64) tensor(-4.0577, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4173, dtype=torch.float64) delta_t tensor(0.1099, dtype=torch.float64)
14 gae_duplicate tensor(-0.9518, dtype=torch.float64) tensor(-2.6507, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4802, dtype=torch.float64) delta_t tensor(0.4452, dtype=torch.float64)
13 gae_duplicate tensor(0.1082, dtype=torch.float64) tensor(-9.0483, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1819, dtype=torch.float64) delta_t tensor(-0.0419, dtype=torch.float64)
12 gae_duplicate tensor(-1.2603, dtype=torch.float64) tensor(-0.1480, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3085, dtype=torch.float64) delta_t tensor(-0.0060, dtype=torch.float64)
11 gae_duplicate tensor(-1.1571, dtype=torch.float64) tensor(0.1271, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4563, dtype=torch.float64) delta_t tensor(0.8398, dtype=torch.float64)
10 gae_duplicate tensor(0.0226, dtype=torch.float64) tensor(-16.2192, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.5510, dtype=torch.float64) delta_t tensor(-1.3914, dtype=torch.float64)
9 gae_duplicate tensor(-3.7752, dtype=torch.float64) tensor(27.3609, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.8436, dtype=torch.float64) delta_t tensor(-1.2119, dtype=torch.float64)
8 gae_duplicate tensor(-1.9409, dtype=torch.float64) tensor(26.3970, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4196, dtype=torch.float64) delta_t tensor(0.1592, dtype=torch.float64)
7 gae_duplicate tensor(-1.4933, dtype=torch.float64) tensor(-0.1939, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2200, dtype=torch.float64) delta_t tensor(0.3652, dtype=torch.float64)
6 gae_duplicate tensor(-0.7957, dtype=torch.float64) tensor(-7.1499, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4947, dtype=torch.float64) delta_t tensor(-0.0921, dtype=torch.float64)
5 gae_duplicate tensor(-2.1059, dtype=torch.float64) tensor(1.0198, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2388, dtype=torch.float64) delta_t tensor(-0.1351, dtype=torch.float64)
4 gae_duplicate tensor(-1.4561, dtype=torch.float64) tensor(3.0135, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0934, dtype=torch.float64) delta_t tensor(-0.0491, dtype=torch.float64)
3 gae_duplicate tensor(-0.3228, dtype=torch.float64) tensor(1.2125, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1059, dtype=torch.float64) delta_t tensor(-0.0179, dtype=torch.float64)
2 gae_duplicate tensor(-0.1336, dtype=torch.float64) tensor(0.4553, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-446.9202880859375
value loss:110.32233428955078
entropies:355.1958923339844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6296257972717285 seconds
19 rew tensor(0.8823, dtype=torch.float64) delta_t tensor(0.1141, dtype=torch.float64)
19 gae_duplicate tensor(0.0878, dtype=torch.float64) tensor(-2.2541, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8538, dtype=torch.float64) delta_t tensor(0.1807, dtype=torch.float64)
18 gae_duplicate tensor(0.1017, dtype=torch.float64) tensor(-3.8929, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8352, dtype=torch.float64) delta_t tensor(0.2046, dtype=torch.float64)
17 gae_duplicate tensor(0.1287, dtype=torch.float64) tensor(-4.4266, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7395, dtype=torch.float64) delta_t tensor(0.1448, dtype=torch.float64)
16 gae_duplicate tensor(0.0616, dtype=torch.float64) tensor(-3.2189, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6825, dtype=torch.float64) delta_t tensor(0.2334, dtype=torch.float64)
15 gae_duplicate tensor(0.0409, dtype=torch.float64) tensor(-4.9208, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6437, dtype=torch.float64) delta_t tensor(0.1866, dtype=torch.float64)
14 gae_duplicate tensor(0.0866, dtype=torch.float64) tensor(-4.1109, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5125, dtype=torch.float64) delta_t tensor(0.2690, dtype=torch.float64)
13 gae_duplicate tensor(0.1127, dtype=torch.float64) tensor(-5.8397, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3882, dtype=torch.float64) delta_t tensor(0.0887, dtype=torch.float64)
12 gae_duplicate tensor(-0.9161, dtype=torch.float64) tensor(-1.9030, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0694, dtype=torch.float64) delta_t tensor(0.5510, dtype=torch.float64)
11 gae_duplicate tensor(-0.9470, dtype=torch.float64) tensor(-11.0972, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.1814, dtype=torch.float64) delta_t tensor(-1.3381, dtype=torch.float64)
10 gae_duplicate tensor(-1.9679, dtype=torch.float64) tensor(25.1662, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0657, dtype=torch.float64) delta_t tensor(0.2665, dtype=torch.float64)
9 gae_duplicate tensor(-0.6293, dtype=torch.float64) tensor(-2.6353, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3835, dtype=torch.float64) delta_t tensor(-0.9573, dtype=torch.float64)
8 gae_duplicate tensor(-3.6226, dtype=torch.float64) tensor(18.6210, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8806, dtype=torch.float64) delta_t tensor(0.5214, dtype=torch.float64)
7 gae_duplicate tensor(-0.8718, dtype=torch.float64) tensor(-8.7301, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1573, dtype=torch.float64) delta_t tensor(-0.7910, dtype=torch.float64)
6 gae_duplicate tensor(-2.9173, dtype=torch.float64) tensor(14.5802, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8512, dtype=torch.float64) delta_t tensor(-0.1111, dtype=torch.float64)
5 gae_duplicate tensor(-2.1533, dtype=torch.float64) tensor(3.6296, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1275, dtype=torch.float64) delta_t tensor(-0.2708, dtype=torch.float64)
4 gae_duplicate tensor(-2.3085, dtype=torch.float64) tensor(5.8896, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1644, dtype=torch.float64) delta_t tensor(0.0361, dtype=torch.float64)
3 gae_duplicate tensor(-0.4096, dtype=torch.float64) tensor(-0.2081, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1465, dtype=torch.float64) delta_t tensor(0.0240, dtype=torch.float64)
2 gae_duplicate tensor(-0.1945, dtype=torch.float64) tensor(-0.5164, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-858.902099609375
value loss:116.83891296386719
entropies:354.60504150390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.741674900054932 seconds
19 rew tensor(0.8729, dtype=torch.float64) delta_t tensor(0.1539, dtype=torch.float64)
19 gae_duplicate tensor(0.1081, dtype=torch.float64) tensor(-3.0675, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5505, dtype=torch.float64) delta_t tensor(-0.0156, dtype=torch.float64)
18 gae_duplicate tensor(-0.9377, dtype=torch.float64) tensor(0.3636, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8063, dtype=torch.float64) delta_t tensor(0.2230, dtype=torch.float64)
17 gae_duplicate tensor(0.1566, dtype=torch.float64) tensor(-4.3730, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6921, dtype=torch.float64) delta_t tensor(0.2020, dtype=torch.float64)
16 gae_duplicate tensor(0.1498, dtype=torch.float64) tensor(-4.4941, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7002, dtype=torch.float64) delta_t tensor(0.2621, dtype=torch.float64)
15 gae_duplicate tensor(0.0837, dtype=torch.float64) tensor(-5.4310, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2805, dtype=torch.float64) delta_t tensor(-0.0504, dtype=torch.float64)
14 gae_duplicate tensor(-0.8051, dtype=torch.float64) tensor(0.8166, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5979, dtype=torch.float64) delta_t tensor(0.3637, dtype=torch.float64)
13 gae_duplicate tensor(-0.0079, dtype=torch.float64) tensor(-7.3419, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5396, dtype=torch.float64) delta_t tensor(0.4370, dtype=torch.float64)
12 gae_duplicate tensor(0.2387, dtype=torch.float64) tensor(-8.9051, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1146, dtype=torch.float64) delta_t tensor(0.3971, dtype=torch.float64)
11 gae_duplicate tensor(-0.1307, dtype=torch.float64) tensor(-9.1324, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2711, dtype=torch.float64) delta_t tensor(0.7271, dtype=torch.float64)
10 gae_duplicate tensor(-0.4272, dtype=torch.float64) tensor(-15.8294, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.3756, dtype=torch.float64) delta_t tensor(-1.0978, dtype=torch.float64)
9 gae_duplicate tensor(-1.7325, dtype=torch.float64) tensor(20.7896, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9287, dtype=torch.float64) delta_t tensor(-0.2548, dtype=torch.float64)
8 gae_duplicate tensor(-2.8374, dtype=torch.float64) tensor(7.3075, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5654, dtype=torch.float64) delta_t tensor(0.1279, dtype=torch.float64)
7 gae_duplicate tensor(-1.1953, dtype=torch.float64) tensor(-1.9670, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1145, dtype=torch.float64) delta_t tensor(0.4158, dtype=torch.float64)
6 gae_duplicate tensor(-0.7397, dtype=torch.float64) tensor(-8.3697, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0813, dtype=torch.float64) delta_t tensor(0.2129, dtype=torch.float64)
5 gae_duplicate tensor(-0.0367, dtype=torch.float64) tensor(-5.0754, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3544, dtype=torch.float64) delta_t tensor(0.0564, dtype=torch.float64)
4 gae_duplicate tensor(-0.1712, dtype=torch.float64) tensor(-1.5281, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0325, dtype=torch.float64) delta_t tensor(-0.0473, dtype=torch.float64)
3 gae_duplicate tensor(-0.2067, dtype=torch.float64) tensor(0.7514, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2095, dtype=torch.float64) delta_t tensor(0.0748, dtype=torch.float64)
2 gae_duplicate tensor(0.0232, dtype=torch.float64) tensor(-1.4393, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2438.384033203125
value loss:71.44940948486328
entropies:353.955810546875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3999.0190)
ToM Target loss= tensor(3612.0781)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.932790040969849 seconds
19 rew tensor(0.8343, dtype=torch.float64) delta_t tensor(0.0604, dtype=torch.float64)
19 gae_duplicate tensor(-0.0372, dtype=torch.float64) tensor(-1.1507, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5802, dtype=torch.float64) delta_t tensor(-0.0754, dtype=torch.float64)
18 gae_duplicate tensor(-1.0003, dtype=torch.float64) tensor(1.5737, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7787, dtype=torch.float64) delta_t tensor(0.1545, dtype=torch.float64)
17 gae_duplicate tensor(0.1146, dtype=torch.float64) tensor(-2.7250, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6739, dtype=torch.float64) delta_t tensor(0.1369, dtype=torch.float64)
16 gae_duplicate tensor(0.0682, dtype=torch.float64) tensor(-3.0618, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4958, dtype=torch.float64) delta_t tensor(-0.0511, dtype=torch.float64)
15 gae_duplicate tensor(-0.8405, dtype=torch.float64) tensor(0.8709, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4130, dtype=torch.float64) delta_t tensor(0.0774, dtype=torch.float64)
14 gae_duplicate tensor(-0.9197, dtype=torch.float64) tensor(-1.6150, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6281, dtype=torch.float64) delta_t tensor(0.1942, dtype=torch.float64)
13 gae_duplicate tensor(0.0194, dtype=torch.float64) tensor(-4.1162, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4814, dtype=torch.float64) delta_t tensor(0.3476, dtype=torch.float64)
12 gae_duplicate tensor(0.2031, dtype=torch.float64) tensor(-7.6090, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6263, dtype=torch.float64) delta_t tensor(-0.1866, dtype=torch.float64)
11 gae_duplicate tensor(-1.2846, dtype=torch.float64) tensor(2.3558, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0247, dtype=torch.float64) delta_t tensor(0.8644, dtype=torch.float64)
10 gae_duplicate tensor(-0.4379, dtype=torch.float64) tensor(-16.2397, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3596, dtype=torch.float64) delta_t tensor(-0.3796, dtype=torch.float64)
9 gae_duplicate tensor(-1.6162, dtype=torch.float64) tensor(5.7518, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.8232, dtype=torch.float64) delta_t tensor(-0.6466, dtype=torch.float64)
8 gae_duplicate tensor(-2.2811, dtype=torch.float64) tensor(14.2410, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2919, dtype=torch.float64) delta_t tensor(0.6696, dtype=torch.float64)
7 gae_duplicate tensor(-0.1956, dtype=torch.float64) tensor(-12.2525, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1381, dtype=torch.float64) delta_t tensor(0.9771, dtype=torch.float64)
6 gae_duplicate tensor(0.3463, dtype=torch.float64) tensor(-20.6073, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2340, dtype=torch.float64) delta_t tensor(0.1095, dtype=torch.float64)
5 gae_duplicate tensor(-0.0850, dtype=torch.float64) tensor(-4.0250, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1108, dtype=torch.float64) delta_t tensor(0.0402, dtype=torch.float64)
4 gae_duplicate tensor(-0.1568, dtype=torch.float64) tensor(-1.3330, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3028, dtype=torch.float64) delta_t tensor(0.0100, dtype=torch.float64)
3 gae_duplicate tensor(-0.0810, dtype=torch.float64) tensor(-0.3321, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4032, dtype=torch.float64) delta_t tensor(0.0091, dtype=torch.float64)
2 gae_duplicate tensor(-0.0656, dtype=torch.float64) tensor(-0.2112, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2630.8447265625
value loss:69.9830322265625
entropies:353.20367431640625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.671678066253662 seconds
19 rew tensor(0.8167, dtype=torch.float64) delta_t tensor(-0.0919, dtype=torch.float64)
19 gae_duplicate tensor(-0.1912, dtype=torch.float64) tensor(1.6782, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8073, dtype=torch.float64) delta_t tensor(0.0420, dtype=torch.float64)
18 gae_duplicate tensor(-0.1007, dtype=torch.float64) tensor(-0.6268, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7128, dtype=torch.float64) delta_t tensor(-0.0344, dtype=torch.float64)
17 gae_duplicate tensor(-0.1173, dtype=torch.float64) tensor(0.5639, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7022, dtype=torch.float64) delta_t tensor(0.0577, dtype=torch.float64)
16 gae_duplicate tensor(-0.0078, dtype=torch.float64) tensor(-1.0600, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7420, dtype=torch.float64) delta_t tensor(0.1196, dtype=torch.float64)
15 gae_duplicate tensor(-0.0193, dtype=torch.float64) tensor(-2.5168, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3985, dtype=torch.float64) delta_t tensor(-0.1184, dtype=torch.float64)
14 gae_duplicate tensor(-1.1192, dtype=torch.float64) tensor(1.6605, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5507, dtype=torch.float64) delta_t tensor(0.2481, dtype=torch.float64)
13 gae_duplicate tensor(-0.1263, dtype=torch.float64) tensor(-4.3397, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5499, dtype=torch.float64) delta_t tensor(0.5449, dtype=torch.float64)
12 gae_duplicate tensor(0.2246, dtype=torch.float64) tensor(-10.5588, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1847, dtype=torch.float64) delta_t tensor(0.5208, dtype=torch.float64)
11 gae_duplicate tensor(-0.6736, dtype=torch.float64) tensor(-10.4806, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7514, dtype=torch.float64) delta_t tensor(-0.0462, dtype=torch.float64)
10 gae_duplicate tensor(-1.5826, dtype=torch.float64) tensor(-0.0757, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2615, dtype=torch.float64) delta_t tensor(-0.1010, dtype=torch.float64)
9 gae_duplicate tensor(-2.7694, dtype=torch.float64) tensor(2.2443, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0367, dtype=torch.float64) delta_t tensor(0.6844, dtype=torch.float64)
8 gae_duplicate tensor(-0.4896, dtype=torch.float64) tensor(-14.2590, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2927, dtype=torch.float64) delta_t tensor(0.6749, dtype=torch.float64)
7 gae_duplicate tensor(-0.9725, dtype=torch.float64) tensor(-13.8903, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2245, dtype=torch.float64) delta_t tensor(0.2535, dtype=torch.float64)
6 gae_duplicate tensor(-2.1181, dtype=torch.float64) tensor(-7.6128, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3311, dtype=torch.float64) delta_t tensor(-0.1022, dtype=torch.float64)
5 gae_duplicate tensor(-1.1146, dtype=torch.float64) tensor(1.0204, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4279, dtype=torch.float64) delta_t tensor(0.0440, dtype=torch.float64)
4 gae_duplicate tensor(-0.0362, dtype=torch.float64) tensor(-0.7071, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0428, dtype=torch.float64) delta_t tensor(0.0347, dtype=torch.float64)
3 gae_duplicate tensor(-0.2096, dtype=torch.float64) tensor(-0.6539, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2397, dtype=torch.float64) delta_t tensor(0.0272, dtype=torch.float64)
2 gae_duplicate tensor(-0.0243, dtype=torch.float64) tensor(-0.6435, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3158.746826171875
value loss:86.66178131103516
entropies:352.42578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.702907085418701 seconds
19 rew tensor(0.8173, dtype=torch.float64) delta_t tensor(-0.2457, dtype=torch.float64)
19 gae_duplicate tensor(-0.3304, dtype=torch.float64) tensor(4.7044, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8086, dtype=torch.float64) delta_t tensor(-0.1356, dtype=torch.float64)
18 gae_duplicate tensor(-0.2817, dtype=torch.float64) tensor(2.9134, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7892, dtype=torch.float64) delta_t tensor(-0.0939, dtype=torch.float64)
17 gae_duplicate tensor(-0.2390, dtype=torch.float64) tensor(2.0679, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7511, dtype=torch.float64) delta_t tensor(-0.1265, dtype=torch.float64)
16 gae_duplicate tensor(-0.3146, dtype=torch.float64) tensor(2.8117, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6347, dtype=torch.float64) delta_t tensor(-0.1477, dtype=torch.float64)
15 gae_duplicate tensor(-0.2741, dtype=torch.float64) tensor(3.0887, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0683, dtype=torch.float64) delta_t tensor(-0.6241, dtype=torch.float64)
14 gae_duplicate tensor(-1.2527, dtype=torch.float64) tensor(12.4026, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4127, dtype=torch.float64) delta_t tensor(-0.2648, dtype=torch.float64)
13 gae_duplicate tensor(-1.2385, dtype=torch.float64) tensor(6.4840, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5866, dtype=torch.float64) delta_t tensor(-0.0083, dtype=torch.float64)
12 gae_duplicate tensor(-0.1076, dtype=torch.float64) tensor(0.8404, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0377, dtype=torch.float64) delta_t tensor(-0.2157, dtype=torch.float64)
11 gae_duplicate tensor(-0.9779, dtype=torch.float64) tensor(4.3702, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4938, dtype=torch.float64) delta_t tensor(-0.6310, dtype=torch.float64)
10 gae_duplicate tensor(-2.0165, dtype=torch.float64) tensor(13.3248, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9118, dtype=torch.float64) delta_t tensor(-0.0297, dtype=torch.float64)
9 gae_duplicate tensor(-2.3335, dtype=torch.float64) tensor(4.6910, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4937, dtype=torch.float64) delta_t tensor(0.3029, dtype=torch.float64)
8 gae_duplicate tensor(-1.7460, dtype=torch.float64) tensor(-4.8931, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7282, dtype=torch.float64) delta_t tensor(-0.1072, dtype=torch.float64)
7 gae_duplicate tensor(-1.0818, dtype=torch.float64) tensor(1.6576, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2056, dtype=torch.float64) delta_t tensor(-0.1505, dtype=torch.float64)
6 gae_duplicate tensor(-1.3739, dtype=torch.float64) tensor(2.8967, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3638, dtype=torch.float64) delta_t tensor(-0.2493, dtype=torch.float64)
5 gae_duplicate tensor(-1.0556, dtype=torch.float64) tensor(5.6470, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2642, dtype=torch.float64) delta_t tensor(0.0525, dtype=torch.float64)
4 gae_duplicate tensor(-0.2217, dtype=torch.float64) tensor(-0.4053, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1573, dtype=torch.float64) delta_t tensor(-0.0200, dtype=torch.float64)
3 gae_duplicate tensor(-0.2389, dtype=torch.float64) tensor(0.4532, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3163, dtype=torch.float64) delta_t tensor(-0.1580, dtype=torch.float64)
2 gae_duplicate tensor(-0.3081, dtype=torch.float64) tensor(3.2318, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3674.445556640625
value loss:70.83395385742188
entropies:351.6925048828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.566877841949463 seconds
19 rew tensor(0.8267, dtype=torch.float64) delta_t tensor(-0.3567, dtype=torch.float64)
19 gae_duplicate tensor(-0.4270, dtype=torch.float64) tensor(6.9112, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8089, dtype=torch.float64) delta_t tensor(-0.2245, dtype=torch.float64)
18 gae_duplicate tensor(-0.3242, dtype=torch.float64) tensor(4.7326, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7893, dtype=torch.float64) delta_t tensor(-0.2319, dtype=torch.float64)
17 gae_duplicate tensor(-0.3594, dtype=torch.float64) tensor(4.8998, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6754, dtype=torch.float64) delta_t tensor(-0.1973, dtype=torch.float64)
16 gae_duplicate tensor(-0.3015, dtype=torch.float64) tensor(4.2313, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6926, dtype=torch.float64) delta_t tensor(-0.2691, dtype=torch.float64)
15 gae_duplicate tensor(-0.3948, dtype=torch.float64) tensor(5.6291, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5030, dtype=torch.float64) delta_t tensor(-0.1296, dtype=torch.float64)
14 gae_duplicate tensor(-0.3006, dtype=torch.float64) tensor(3.1610, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4902, dtype=torch.float64) delta_t tensor(-0.3674, dtype=torch.float64)
13 gae_duplicate tensor(-1.2470, dtype=torch.float64) tensor(7.2851, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3292, dtype=torch.float64) delta_t tensor(0.1194, dtype=torch.float64)
12 gae_duplicate tensor(-0.2274, dtype=torch.float64) tensor(-1.8054, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4738, dtype=torch.float64) delta_t tensor(-0.5703, dtype=torch.float64)
11 gae_duplicate tensor(-1.5991, dtype=torch.float64) tensor(10.3863, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2061, dtype=torch.float64) delta_t tensor(0.3588, dtype=torch.float64)
10 gae_duplicate tensor(-0.8327, dtype=torch.float64) tensor(-5.4448, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2409, dtype=torch.float64) delta_t tensor(0.0882, dtype=torch.float64)
9 gae_duplicate tensor(-0.6708, dtype=torch.float64) tensor(-1.6957, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9693, dtype=torch.float64) delta_t tensor(-0.0387, dtype=torch.float64)
8 gae_duplicate tensor(-2.2102, dtype=torch.float64) tensor(1.5729, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0323, dtype=torch.float64) delta_t tensor(-0.3733, dtype=torch.float64)
7 gae_duplicate tensor(-2.8606, dtype=torch.float64) tensor(5.6757, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7803, dtype=torch.float64) delta_t tensor(-0.0574, dtype=torch.float64)
6 gae_duplicate tensor(-2.6809, dtype=torch.float64) tensor(3.0650, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3224, dtype=torch.float64) delta_t tensor(-0.1198, dtype=torch.float64)
5 gae_duplicate tensor(-0.3293, dtype=torch.float64) tensor(2.4690, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1455, dtype=torch.float64) delta_t tensor(-0.1075, dtype=torch.float64)
4 gae_duplicate tensor(-0.3766, dtype=torch.float64) tensor(2.6522, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4540, dtype=torch.float64) delta_t tensor(-0.1149, dtype=torch.float64)
3 gae_duplicate tensor(-0.3436, dtype=torch.float64) tensor(2.6442, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4802, dtype=torch.float64) delta_t tensor(-0.1835, dtype=torch.float64)
2 gae_duplicate tensor(-0.2707, dtype=torch.float64) tensor(3.7621, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3341.86328125
value loss:75.84676361083984
entropies:350.9627380371094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.775921106338501 seconds
19 rew tensor(0.8842, dtype=torch.float64) delta_t tensor(-0.3174, dtype=torch.float64)
19 gae_duplicate tensor(-0.3650, dtype=torch.float64) tensor(5.7054, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8555, dtype=torch.float64) delta_t tensor(-0.1826, dtype=torch.float64)
18 gae_duplicate tensor(-0.3437, dtype=torch.float64) tensor(4.0362, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7706, dtype=torch.float64) delta_t tensor(-0.2503, dtype=torch.float64)
17 gae_duplicate tensor(-0.3912, dtype=torch.float64) tensor(5.4023, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6661, dtype=torch.float64) delta_t tensor(-0.2673, dtype=torch.float64)
16 gae_duplicate tensor(-0.3463, dtype=torch.float64) tensor(5.5890, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7030, dtype=torch.float64) delta_t tensor(-0.2418, dtype=torch.float64)
15 gae_duplicate tensor(-0.3308, dtype=torch.float64) tensor(5.2568, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3785, dtype=torch.float64) delta_t tensor(-0.4201, dtype=torch.float64)
14 gae_duplicate tensor(-1.3369, dtype=torch.float64) tensor(8.2997, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6544, dtype=torch.float64) delta_t tensor(-0.2012, dtype=torch.float64)
13 gae_duplicate tensor(-0.3533, dtype=torch.float64) tensor(5.1181, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5337, dtype=torch.float64) delta_t tensor(-0.1263, dtype=torch.float64)
12 gae_duplicate tensor(-0.2318, dtype=torch.float64) tensor(2.6406, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4800, dtype=torch.float64) delta_t tensor(-0.8555, dtype=torch.float64)
11 gae_duplicate tensor(-2.5761, dtype=torch.float64) tensor(17.5409, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2370, dtype=torch.float64) delta_t tensor(0.1607, dtype=torch.float64)
10 gae_duplicate tensor(-0.7782, dtype=torch.float64) tensor(-2.2037, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7358, dtype=torch.float64) delta_t tensor(-0.0339, dtype=torch.float64)
9 gae_duplicate tensor(-1.8421, dtype=torch.float64) tensor(0.7883, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6879, dtype=torch.float64) delta_t tensor(-0.1024, dtype=torch.float64)
8 gae_duplicate tensor(-1.8864, dtype=torch.float64) tensor(1.1401, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1319, dtype=torch.float64) delta_t tensor(0.4541, dtype=torch.float64)
7 gae_duplicate tensor(-1.1852, dtype=torch.float64) tensor(-9.2693, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2284, dtype=torch.float64) delta_t tensor(0.0583, dtype=torch.float64)
6 gae_duplicate tensor(-2.1565, dtype=torch.float64) tensor(-1.9453, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1954, dtype=torch.float64) delta_t tensor(-0.2841, dtype=torch.float64)
5 gae_duplicate tensor(-0.9662, dtype=torch.float64) tensor(5.2163, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1590, dtype=torch.float64) delta_t tensor(-0.1513, dtype=torch.float64)
4 gae_duplicate tensor(-0.4752, dtype=torch.float64) tensor(3.3489, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1613, dtype=torch.float64) delta_t tensor(-0.0095, dtype=torch.float64)
3 gae_duplicate tensor(-0.1783, dtype=torch.float64) tensor(0.5874, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3213, dtype=torch.float64) delta_t tensor(-0.1362, dtype=torch.float64)
2 gae_duplicate tensor(-0.3151, dtype=torch.float64) tensor(2.5152, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3321.934326171875
value loss:75.15438842773438
entropies:350.0771179199219
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3976.4487)
ToM Target loss= tensor(3608.0312)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.922672986984253 seconds
19 rew tensor(0.8361, dtype=torch.float64) delta_t tensor(-0.3015, dtype=torch.float64)
19 gae_duplicate tensor(-0.3614, dtype=torch.float64) tensor(6.1582, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3095, dtype=torch.float64) delta_t tensor(-0.6336, dtype=torch.float64)
18 gae_duplicate tensor(-1.4338, dtype=torch.float64) tensor(11.7796, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7802, dtype=torch.float64) delta_t tensor(-0.1357, dtype=torch.float64)
17 gae_duplicate tensor(-0.3251, dtype=torch.float64) tensor(3.8516, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6741, dtype=torch.float64) delta_t tensor(-0.2101, dtype=torch.float64)
16 gae_duplicate tensor(-0.3254, dtype=torch.float64) tensor(4.5065, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0808, dtype=torch.float64) delta_t tensor(-0.7314, dtype=torch.float64)
15 gae_duplicate tensor(-1.3876, dtype=torch.float64) tensor(15.1548, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3262, dtype=torch.float64) delta_t tensor(-0.4873, dtype=torch.float64)
14 gae_duplicate tensor(-1.2882, dtype=torch.float64) tensor(10.6646, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6014, dtype=torch.float64) delta_t tensor(-0.1369, dtype=torch.float64)
13 gae_duplicate tensor(-0.3533, dtype=torch.float64) tensor(3.8886, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7215, dtype=torch.float64) delta_t tensor(-0.0756, dtype=torch.float64)
12 gae_duplicate tensor(-0.1452, dtype=torch.float64) tensor(1.8125, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0256, dtype=torch.float64) delta_t tensor(-0.1420, dtype=torch.float64)
11 gae_duplicate tensor(-1.0197, dtype=torch.float64) tensor(3.0189, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2260, dtype=torch.float64) delta_t tensor(-0.0087, dtype=torch.float64)
10 gae_duplicate tensor(-0.9800, dtype=torch.float64) tensor(0.0464, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.8285, dtype=torch.float64) delta_t tensor(-1.8946, dtype=torch.float64)
9 gae_duplicate tensor(-3.0407, dtype=torch.float64) tensor(35.5375, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.4983, dtype=torch.float64) delta_t tensor(-0.4431, dtype=torch.float64)
8 gae_duplicate tensor(-2.7667, dtype=torch.float64) tensor(13.1263, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8809, dtype=torch.float64) delta_t tensor(-0.1978, dtype=torch.float64)
7 gae_duplicate tensor(-1.4589, dtype=torch.float64) tensor(3.6328, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1838, dtype=torch.float64) delta_t tensor(0.3991, dtype=torch.float64)
6 gae_duplicate tensor(-0.2707, dtype=torch.float64) tensor(-7.0634, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1080, dtype=torch.float64) delta_t tensor(0.0307, dtype=torch.float64)
5 gae_duplicate tensor(-0.1602, dtype=torch.float64) tensor(-1.5782, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5013, dtype=torch.float64) delta_t tensor(-0.0868, dtype=torch.float64)
4 gae_duplicate tensor(-0.2752, dtype=torch.float64) tensor(1.4881, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0894, dtype=torch.float64) delta_t tensor(-0.0782, dtype=torch.float64)
3 gae_duplicate tensor(-0.4382, dtype=torch.float64) tensor(1.6274, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1292, dtype=torch.float64) delta_t tensor(-0.0984, dtype=torch.float64)
2 gae_duplicate tensor(-0.1752, dtype=torch.float64) tensor(2.2171, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6027.236328125
value loss:100.6330337524414
entropies:349.2812805175781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.726494073867798 seconds
19 rew tensor(0.8551, dtype=torch.float64) delta_t tensor(-0.2326, dtype=torch.float64)
19 gae_duplicate tensor(-0.3304, dtype=torch.float64) tensor(4.4168, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(-0.1238, dtype=torch.float64)
18 gae_duplicate tensor(-0.2741, dtype=torch.float64) tensor(2.9387, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7983, dtype=torch.float64) delta_t tensor(-0.1309, dtype=torch.float64)
17 gae_duplicate tensor(-0.2255, dtype=torch.float64) tensor(2.8460, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5221, dtype=torch.float64) delta_t tensor(-0.3376, dtype=torch.float64)
16 gae_duplicate tensor(-1.2639, dtype=torch.float64) tensor(6.2122, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6931, dtype=torch.float64) delta_t tensor(-0.1076, dtype=torch.float64)
15 gae_duplicate tensor(-0.2169, dtype=torch.float64) tensor(2.6799, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4279, dtype=torch.float64) delta_t tensor(-0.2640, dtype=torch.float64)
14 gae_duplicate tensor(-1.2903, dtype=torch.float64) tensor(4.7129, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5776, dtype=torch.float64) delta_t tensor(-0.0399, dtype=torch.float64)
13 gae_duplicate tensor(-0.3351, dtype=torch.float64) tensor(1.2577, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2434, dtype=torch.float64) delta_t tensor(-0.0940, dtype=torch.float64)
12 gae_duplicate tensor(-1.0769, dtype=torch.float64) tensor(1.6574, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3856, dtype=torch.float64) delta_t tensor(-0.2366, dtype=torch.float64)
11 gae_duplicate tensor(-1.4032, dtype=torch.float64) tensor(4.3048, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3246, dtype=torch.float64) delta_t tensor(0.4288, dtype=torch.float64)
10 gae_duplicate tensor(-0.2751, dtype=torch.float64) tensor(-7.3017, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.7351, dtype=torch.float64) delta_t tensor(-1.9074, dtype=torch.float64)
9 gae_duplicate tensor(-3.6620, dtype=torch.float64) tensor(39.7163, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.5076, dtype=torch.float64) delta_t tensor(-0.4285, dtype=torch.float64)
8 gae_duplicate tensor(-2.6075, dtype=torch.float64) tensor(11.3361, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1182, dtype=torch.float64) delta_t tensor(0.8159, dtype=torch.float64)
7 gae_duplicate tensor(-0.0787, dtype=torch.float64) tensor(-13.4841, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1448, dtype=torch.float64) delta_t tensor(0.2501, dtype=torch.float64)
6 gae_duplicate tensor(-1.1733, dtype=torch.float64) tensor(-6.4042, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0365, dtype=torch.float64) delta_t tensor(-0.1884, dtype=torch.float64)
5 gae_duplicate tensor(-1.3629, dtype=torch.float64) tensor(3.1989, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2982, dtype=torch.float64) delta_t tensor(0.2142, dtype=torch.float64)
4 gae_duplicate tensor(-0.2823, dtype=torch.float64) tensor(-4.3037, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1368, dtype=torch.float64) delta_t tensor(-0.0551, dtype=torch.float64)
3 gae_duplicate tensor(-0.1152, dtype=torch.float64) tensor(0.6684, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3060, dtype=torch.float64) delta_t tensor(-0.0620, dtype=torch.float64)
2 gae_duplicate tensor(-0.4058, dtype=torch.float64) tensor(1.3070, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3105.171142578125
value loss:115.58683013916016
entropies:348.75775146484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1470677852630615 seconds
19 rew tensor(0.8839, dtype=torch.float64) delta_t tensor(-0.1141, dtype=torch.float64)
19 gae_duplicate tensor(-0.1600, dtype=torch.float64) tensor(2.0913, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8177, dtype=torch.float64) delta_t tensor(-0.0221, dtype=torch.float64)
18 gae_duplicate tensor(-0.0816, dtype=torch.float64) tensor(0.6473, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8261, dtype=torch.float64) delta_t tensor(0.0080, dtype=torch.float64)
17 gae_duplicate tensor(-0.0876, dtype=torch.float64) tensor(-0.0353, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6842, dtype=torch.float64) delta_t tensor(-0.0807, dtype=torch.float64)
16 gae_duplicate tensor(-0.1749, dtype=torch.float64) tensor(1.5556, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4235, dtype=torch.float64) delta_t tensor(-0.2457, dtype=torch.float64)
15 gae_duplicate tensor(-1.1805, dtype=torch.float64) tensor(5.3540, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2512, dtype=torch.float64) delta_t tensor(-0.3528, dtype=torch.float64)
14 gae_duplicate tensor(-1.2031, dtype=torch.float64) tensor(6.9332, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5510, dtype=torch.float64) delta_t tensor(0.0821, dtype=torch.float64)
13 gae_duplicate tensor(-0.2022, dtype=torch.float64) tensor(-0.6224, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3705, dtype=torch.float64) delta_t tensor(-0.1500, dtype=torch.float64)
12 gae_duplicate tensor(-1.3044, dtype=torch.float64) tensor(3.5818, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2708, dtype=torch.float64) delta_t tensor(0.2155, dtype=torch.float64)
11 gae_duplicate tensor(-0.8460, dtype=torch.float64) tensor(-3.2058, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2342, dtype=torch.float64) delta_t tensor(-0.1585, dtype=torch.float64)
10 gae_duplicate tensor(-3.4468, dtype=torch.float64) tensor(4.8274, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5723, dtype=torch.float64) delta_t tensor(-0.6091, dtype=torch.float64)
9 gae_duplicate tensor(-2.9596, dtype=torch.float64) tensor(13.4239, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0727, dtype=torch.float64) delta_t tensor(0.5549, dtype=torch.float64)
8 gae_duplicate tensor(-0.1339, dtype=torch.float64) tensor(-9.6593, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2921, dtype=torch.float64) delta_t tensor(0.5271, dtype=torch.float64)
7 gae_duplicate tensor(-0.1141, dtype=torch.float64) tensor(-9.8448, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3358, dtype=torch.float64) delta_t tensor(0.1238, dtype=torch.float64)
6 gae_duplicate tensor(-1.1490, dtype=torch.float64) tensor(-2.4926, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2221, dtype=torch.float64) delta_t tensor(-0.1200, dtype=torch.float64)
5 gae_duplicate tensor(-0.3368, dtype=torch.float64) tensor(1.7312, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1874, dtype=torch.float64) delta_t tensor(-0.0486, dtype=torch.float64)
4 gae_duplicate tensor(-0.3118, dtype=torch.float64) tensor(1.1292, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0735, dtype=torch.float64) delta_t tensor(0.0294, dtype=torch.float64)
3 gae_duplicate tensor(-0.2044, dtype=torch.float64) tensor(-0.5157, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2714, dtype=torch.float64) delta_t tensor(-0.0131, dtype=torch.float64)
2 gae_duplicate tensor(-0.1814, dtype=torch.float64) tensor(0.2189, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-910.4633178710938
value loss:68.6106185913086
entropies:348.52880859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.748783111572266 seconds
19 rew tensor(0.8558, dtype=torch.float64) delta_t tensor(-0.0490, dtype=torch.float64)
19 gae_duplicate tensor(-0.1611, dtype=torch.float64) tensor(0.8515, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7787, dtype=torch.float64) delta_t tensor(-0.0046, dtype=torch.float64)
18 gae_duplicate tensor(-0.0728, dtype=torch.float64) tensor(0.2091, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7990, dtype=torch.float64) delta_t tensor(0.0250, dtype=torch.float64)
17 gae_duplicate tensor(-0.0421, dtype=torch.float64) tensor(-0.4384, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5302, dtype=torch.float64) delta_t tensor(-0.1770, dtype=torch.float64)
16 gae_duplicate tensor(-0.9980, dtype=torch.float64) tensor(3.1133, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6755, dtype=torch.float64) delta_t tensor(-0.0004, dtype=torch.float64)
15 gae_duplicate tensor(-0.0692, dtype=torch.float64) tensor(0.2313, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6275, dtype=torch.float64) delta_t tensor(0.0917, dtype=torch.float64)
14 gae_duplicate tensor(-0.0423, dtype=torch.float64) tensor(-1.5853, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6176, dtype=torch.float64) delta_t tensor(0.0962, dtype=torch.float64)
13 gae_duplicate tensor(0.0014, dtype=torch.float64) tensor(-2.0623, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3324, dtype=torch.float64) delta_t tensor(-0.0663, dtype=torch.float64)
12 gae_duplicate tensor(-0.8563, dtype=torch.float64) tensor(0.9980, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3930, dtype=torch.float64) delta_t tensor(-0.3048, dtype=torch.float64)
11 gae_duplicate tensor(-1.3907, dtype=torch.float64) tensor(5.3246, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2274, dtype=torch.float64) delta_t tensor(-0.2105, dtype=torch.float64)
10 gae_duplicate tensor(-1.3825, dtype=torch.float64) tensor(4.0333, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8690, dtype=torch.float64) delta_t tensor(0.0563, dtype=torch.float64)
9 gae_duplicate tensor(-1.4909, dtype=torch.float64) tensor(1.4874, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.1792, dtype=torch.float64) delta_t tensor(-1.2354, dtype=torch.float64)
8 gae_duplicate tensor(-2.5606, dtype=torch.float64) tensor(21.2394, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1781, dtype=torch.float64) delta_t tensor(0.7129, dtype=torch.float64)
7 gae_duplicate tensor(-1.1299, dtype=torch.float64) tensor(-11.2413, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6935, dtype=torch.float64) delta_t tensor(-0.0515, dtype=torch.float64)
6 gae_duplicate tensor(-2.2900, dtype=torch.float64) tensor(0.2361, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0890, dtype=torch.float64) delta_t tensor(0.1559, dtype=torch.float64)
5 gae_duplicate tensor(-0.0511, dtype=torch.float64) tensor(-3.3766, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3238, dtype=torch.float64) delta_t tensor(0.1323, dtype=torch.float64)
4 gae_duplicate tensor(-0.1134, dtype=torch.float64) tensor(-2.9609, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0810, dtype=torch.float64) delta_t tensor(0.0939, dtype=torch.float64)
3 gae_duplicate tensor(-0.0274, dtype=torch.float64) tensor(-2.0179, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2415, dtype=torch.float64) delta_t tensor(0.0437, dtype=torch.float64)
2 gae_duplicate tensor(-0.0774, dtype=torch.float64) tensor(-1.0004, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-798.0695190429688
value loss:73.21450805664062
entropies:347.6661376953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.786297082901001 seconds
19 rew tensor(0.8656, dtype=torch.float64) delta_t tensor(0.0547, dtype=torch.float64)
19 gae_duplicate tensor(-0.0331, dtype=torch.float64) tensor(-1.2031, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8278, dtype=torch.float64) delta_t tensor(0.1456, dtype=torch.float64)
18 gae_duplicate tensor(0.0204, dtype=torch.float64) tensor(-3.1702, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8082, dtype=torch.float64) delta_t tensor(0.1258, dtype=torch.float64)
17 gae_duplicate tensor(0.0754, dtype=torch.float64) tensor(-2.6364, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6348, dtype=torch.float64) delta_t tensor(0.0991, dtype=torch.float64)
16 gae_duplicate tensor(0.0536, dtype=torch.float64) tensor(-2.0175, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7711, dtype=torch.float64) delta_t tensor(0.1557, dtype=torch.float64)
15 gae_duplicate tensor(0.1207, dtype=torch.float64) tensor(-3.1376, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3004, dtype=torch.float64) delta_t tensor(-0.0828, dtype=torch.float64)
14 gae_duplicate tensor(-0.9799, dtype=torch.float64) tensor(0.8339, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5996, dtype=torch.float64) delta_t tensor(0.2396, dtype=torch.float64)
13 gae_duplicate tensor(-0.0451, dtype=torch.float64) tensor(-4.0972, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4148, dtype=torch.float64) delta_t tensor(0.3186, dtype=torch.float64)
12 gae_duplicate tensor(0.1591, dtype=torch.float64) tensor(-6.6906, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0439, dtype=torch.float64) delta_t tensor(0.3370, dtype=torch.float64)
11 gae_duplicate tensor(-0.2563, dtype=torch.float64) tensor(-6.9035, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.9103, dtype=torch.float64) delta_t tensor(-0.4853, dtype=torch.float64)
10 gae_duplicate tensor(-2.3121, dtype=torch.float64) tensor(8.8616, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1279, dtype=torch.float64) delta_t tensor(0.5431, dtype=torch.float64)
9 gae_duplicate tensor(-1.4336, dtype=torch.float64) tensor(-8.5033, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2554, dtype=torch.float64) delta_t tensor(0.6401, dtype=torch.float64)
8 gae_duplicate tensor(-0.6000, dtype=torch.float64) tensor(-12.6597, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0128, dtype=torch.float64) delta_t tensor(0.7446, dtype=torch.float64)
7 gae_duplicate tensor(-1.0938, dtype=torch.float64) tensor(-17.3133, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3804, dtype=torch.float64) delta_t tensor(0.0120, dtype=torch.float64)
6 gae_duplicate tensor(-1.1865, dtype=torch.float64) tensor(-1.9987, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0218, dtype=torch.float64) delta_t tensor(0.0389, dtype=torch.float64)
5 gae_duplicate tensor(-0.2266, dtype=torch.float64) tensor(-0.8763, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0207, dtype=torch.float64) delta_t tensor(0.0536, dtype=torch.float64)
4 gae_duplicate tensor(-0.1598, dtype=torch.float64) tensor(-0.9642, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3364, dtype=torch.float64) delta_t tensor(0.2462, dtype=torch.float64)
3 gae_duplicate tensor(0.0716, dtype=torch.float64) tensor(-4.9831, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4275, dtype=torch.float64) delta_t tensor(0.0862, dtype=torch.float64)
2 gae_duplicate tensor(-0.0615, dtype=torch.float64) tensor(-2.0229, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3658.276123046875
value loss:63.54811096191406
entropies:347.27142333984375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3956.7366)
ToM Target loss= tensor(3602.0735)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.7435691356658936 seconds
19 rew tensor(0.8101, dtype=torch.float64) delta_t tensor(0.0737, dtype=torch.float64)
19 gae_duplicate tensor(-0.0686, dtype=torch.float64) tensor(-1.5020, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8082, dtype=torch.float64) delta_t tensor(0.1285, dtype=torch.float64)
18 gae_duplicate tensor(0.0604, dtype=torch.float64) tensor(-2.8691, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6280, dtype=torch.float64) delta_t tensor(0.0890, dtype=torch.float64)
17 gae_duplicate tensor(0.0626, dtype=torch.float64) tensor(-1.9031, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5396, dtype=torch.float64) delta_t tensor(-0.0448, dtype=torch.float64)
16 gae_duplicate tensor(-0.9571, dtype=torch.float64) tensor(0.6562, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.0978, dtype=torch.float64) delta_t tensor(-0.2760, dtype=torch.float64)
15 gae_duplicate tensor(-1.0452, dtype=torch.float64) tensor(5.3995, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5277, dtype=torch.float64) delta_t tensor(0.2955, dtype=torch.float64)
14 gae_duplicate tensor(-0.8481, dtype=torch.float64) tensor(-4.4978, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4263, dtype=torch.float64) delta_t tensor(0.2441, dtype=torch.float64)
13 gae_duplicate tensor(0.0674, dtype=torch.float64) tensor(-5.1850, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7042, dtype=torch.float64) delta_t tensor(0.3778, dtype=torch.float64)
12 gae_duplicate tensor(0.0658, dtype=torch.float64) tensor(-8.0402, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6083, dtype=torch.float64) delta_t tensor(-0.4202, dtype=torch.float64)
11 gae_duplicate tensor(-1.2070, dtype=torch.float64) tensor(6.6202, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0327, dtype=torch.float64) delta_t tensor(0.3855, dtype=torch.float64)
10 gae_duplicate tensor(-1.3350, dtype=torch.float64) tensor(-6.8069, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.9337, dtype=torch.float64) delta_t tensor(-0.7509, dtype=torch.float64)
9 gae_duplicate tensor(-1.8102, dtype=torch.float64) tensor(12.9171, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.5214, dtype=torch.float64) delta_t tensor(-0.6230, dtype=torch.float64)
8 gae_duplicate tensor(-2.1061, dtype=torch.float64) tensor(15.9162, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3931, dtype=torch.float64) delta_t tensor(0.7210, dtype=torch.float64)
7 gae_duplicate tensor(-0.1121, dtype=torch.float64) tensor(-11.6310, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5323, dtype=torch.float64) delta_t tensor(1.0202, dtype=torch.float64)
6 gae_duplicate tensor(0.8071, dtype=torch.float64) tensor(-20.5890, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2578, dtype=torch.float64) delta_t tensor(0.1999, dtype=torch.float64)
5 gae_duplicate tensor(0.1731, dtype=torch.float64) tensor(-6.4881, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5531, dtype=torch.float64) delta_t tensor(0.2386, dtype=torch.float64)
4 gae_duplicate tensor(-0.0492, dtype=torch.float64) tensor(-5.5470, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1596, dtype=torch.float64) delta_t tensor(0.0688, dtype=torch.float64)
3 gae_duplicate tensor(-0.0850, dtype=torch.float64) tensor(-1.8482, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0503, dtype=torch.float64) delta_t tensor(0.1570, dtype=torch.float64)
2 gae_duplicate tensor(0.0447, dtype=torch.float64) tensor(-3.4017, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2001.6287841796875
value loss:81.5545425415039
entropies:346.5547180175781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.753759860992432 seconds
19 rew tensor(0.8461, dtype=torch.float64) delta_t tensor(0.0030, dtype=torch.float64)
19 gae_duplicate tensor(-0.0770, dtype=torch.float64) tensor(-0.1306, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8367, dtype=torch.float64) delta_t tensor(0.1316, dtype=torch.float64)
18 gae_duplicate tensor(0.0414, dtype=torch.float64) tensor(-2.3553, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8081, dtype=torch.float64) delta_t tensor(0.1447, dtype=torch.float64)
17 gae_duplicate tensor(0.0221, dtype=torch.float64) tensor(-3.0672, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7787, dtype=torch.float64) delta_t tensor(0.1526, dtype=torch.float64)
16 gae_duplicate tensor(0.0901, dtype=torch.float64) tensor(-3.3694, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4576, dtype=torch.float64) delta_t tensor(-0.0591, dtype=torch.float64)
15 gae_duplicate tensor(-1.1151, dtype=torch.float64) tensor(0.9318, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4649, dtype=torch.float64) delta_t tensor(-0.0152, dtype=torch.float64)
14 gae_duplicate tensor(-0.9413, dtype=torch.float64) tensor(0.4223, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5039, dtype=torch.float64) delta_t tensor(0.1191, dtype=torch.float64)
13 gae_duplicate tensor(-0.0596, dtype=torch.float64) tensor(-2.2265, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4248, dtype=torch.float64) delta_t tensor(0.2934, dtype=torch.float64)
12 gae_duplicate tensor(-0.7232, dtype=torch.float64) tensor(-6.6001, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1936, dtype=torch.float64) delta_t tensor(-0.0654, dtype=torch.float64)
11 gae_duplicate tensor(-0.7658, dtype=torch.float64) tensor(0.0715, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5796, dtype=torch.float64) delta_t tensor(-0.1829, dtype=torch.float64)
10 gae_duplicate tensor(-3.3386, dtype=torch.float64) tensor(3.7357, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.9098, dtype=torch.float64) delta_t tensor(-0.7930, dtype=torch.float64)
9 gae_duplicate tensor(-2.8959, dtype=torch.float64) tensor(17.6341, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1144, dtype=torch.float64) delta_t tensor(0.5111, dtype=torch.float64)
8 gae_duplicate tensor(-2.7475, dtype=torch.float64) tensor(-8.6105, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1982, dtype=torch.float64) delta_t tensor(-0.1483, dtype=torch.float64)
7 gae_duplicate tensor(-1.2111, dtype=torch.float64) tensor(1.4437, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1852, dtype=torch.float64) delta_t tensor(0.6576, dtype=torch.float64)
6 gae_duplicate tensor(-0.1970, dtype=torch.float64) tensor(-11.4879, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4442, dtype=torch.float64) delta_t tensor(0.0237, dtype=torch.float64)
5 gae_duplicate tensor(-0.3412, dtype=torch.float64) tensor(-1.5733, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4245, dtype=torch.float64) delta_t tensor(0.2378, dtype=torch.float64)
4 gae_duplicate tensor(-0.0263, dtype=torch.float64) tensor(-4.2634, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1482, dtype=torch.float64) delta_t tensor(0.0898, dtype=torch.float64)
3 gae_duplicate tensor(-0.0242, dtype=torch.float64) tensor(-2.2986, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1165, dtype=torch.float64) delta_t tensor(0.0820, dtype=torch.float64)
2 gae_duplicate tensor(-0.1564, dtype=torch.float64) tensor(-1.8242, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1179.28076171875
value loss:95.8688735961914
entropies:345.866943359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.847325086593628 seconds
19 rew tensor(0.8561, dtype=torch.float64) delta_t tensor(-0.0195, dtype=torch.float64)
19 gae_duplicate tensor(-0.1132, dtype=torch.float64) tensor(0.4005, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8174, dtype=torch.float64) delta_t tensor(0.0342, dtype=torch.float64)
18 gae_duplicate tensor(-0.0510, dtype=torch.float64) tensor(-0.6039, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7698, dtype=torch.float64) delta_t tensor(0.0448, dtype=torch.float64)
17 gae_duplicate tensor(-0.0184, dtype=torch.float64) tensor(-0.8863, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7404, dtype=torch.float64) delta_t tensor(0.0316, dtype=torch.float64)
16 gae_duplicate tensor(-0.0460, dtype=torch.float64) tensor(-0.7309, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6642, dtype=torch.float64) delta_t tensor(0.0428, dtype=torch.float64)
15 gae_duplicate tensor(-0.0464, dtype=torch.float64) tensor(-0.7110, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4498, dtype=torch.float64) delta_t tensor(-0.1317, dtype=torch.float64)
14 gae_duplicate tensor(-1.0625, dtype=torch.float64) tensor(2.0416, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5788, dtype=torch.float64) delta_t tensor(0.0846, dtype=torch.float64)
13 gae_duplicate tensor(-0.1352, dtype=torch.float64) tensor(-1.4116, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6362, dtype=torch.float64) delta_t tensor(0.1448, dtype=torch.float64)
12 gae_duplicate tensor(-0.0186, dtype=torch.float64) tensor(-3.0012, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1865, dtype=torch.float64) delta_t tensor(0.1214, dtype=torch.float64)
11 gae_duplicate tensor(-0.3783, dtype=torch.float64) tensor(-2.5803, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.9221, dtype=torch.float64) delta_t tensor(-0.7849, dtype=torch.float64)
10 gae_duplicate tensor(-2.2045, dtype=torch.float64) tensor(16.0638, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3088, dtype=torch.float64) delta_t tensor(-0.2668, dtype=torch.float64)
9 gae_duplicate tensor(-3.0376, dtype=torch.float64) tensor(4.3301, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1739, dtype=torch.float64) delta_t tensor(0.4972, dtype=torch.float64)
8 gae_duplicate tensor(-1.8673, dtype=torch.float64) tensor(-8.8016, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8963, dtype=torch.float64) delta_t tensor(-0.0633, dtype=torch.float64)
7 gae_duplicate tensor(-1.2220, dtype=torch.float64) tensor(-0.6124, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0731, dtype=torch.float64) delta_t tensor(0.1933, dtype=torch.float64)
6 gae_duplicate tensor(-1.2797, dtype=torch.float64) tensor(-2.4667, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2356, dtype=torch.float64) delta_t tensor(-0.0424, dtype=torch.float64)
5 gae_duplicate tensor(-0.3432, dtype=torch.float64) tensor(-0.0267, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3077, dtype=torch.float64) delta_t tensor(0.0123, dtype=torch.float64)
4 gae_duplicate tensor(-0.2774, dtype=torch.float64) tensor(-0.1386, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0598, dtype=torch.float64) delta_t tensor(-0.0524, dtype=torch.float64)
3 gae_duplicate tensor(-0.1842, dtype=torch.float64) tensor(1.0274, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1987, dtype=torch.float64) delta_t tensor(0.0083, dtype=torch.float64)
2 gae_duplicate tensor(-0.1420, dtype=torch.float64) tensor(0.0132, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-196.07177734375
value loss:68.58476257324219
entropies:345.1795349121094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.686211824417114 seconds
19 rew tensor(0.8649, dtype=torch.float64) delta_t tensor(-0.0724, dtype=torch.float64)
19 gae_duplicate tensor(-0.1749, dtype=torch.float64) tensor(1.4871, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8747, dtype=torch.float64) delta_t tensor(0.0613, dtype=torch.float64)
18 gae_duplicate tensor(-0.0475, dtype=torch.float64) tensor(-1.0953, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7799, dtype=torch.float64) delta_t tensor(0.0119, dtype=torch.float64)
17 gae_duplicate tensor(-0.0174, dtype=torch.float64) tensor(-0.2618, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7716, dtype=torch.float64) delta_t tensor(0.0370, dtype=torch.float64)
16 gae_duplicate tensor(-0.0271, dtype=torch.float64) tensor(-0.6934, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7423, dtype=torch.float64) delta_t tensor(0.0534, dtype=torch.float64)
15 gae_duplicate tensor(-0.1012, dtype=torch.float64) tensor(-1.3433, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6202, dtype=torch.float64) delta_t tensor(0.0879, dtype=torch.float64)
14 gae_duplicate tensor(0.0162, dtype=torch.float64) tensor(-1.6920, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6075, dtype=torch.float64) delta_t tensor(0.0703, dtype=torch.float64)
13 gae_duplicate tensor(0.0012, dtype=torch.float64) tensor(-1.5894, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4972, dtype=torch.float64) delta_t tensor(0.0614, dtype=torch.float64)
12 gae_duplicate tensor(-0.0721, dtype=torch.float64) tensor(-1.3780, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4809, dtype=torch.float64) delta_t tensor(-0.4633, dtype=torch.float64)
11 gae_duplicate tensor(-1.4512, dtype=torch.float64) tensor(8.1656, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2438, dtype=torch.float64) delta_t tensor(0.2261, dtype=torch.float64)
10 gae_duplicate tensor(-0.4750, dtype=torch.float64) tensor(-3.4957, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.3519, dtype=torch.float64) delta_t tensor(-1.5269, dtype=torch.float64)
9 gae_duplicate tensor(-4.3685, dtype=torch.float64) tensor(28.5441, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0264, dtype=torch.float64) delta_t tensor(-0.7118, dtype=torch.float64)
8 gae_duplicate tensor(-2.4263, dtype=torch.float64) tensor(19.0485, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3409, dtype=torch.float64) delta_t tensor(-0.6663, dtype=torch.float64)
7 gae_duplicate tensor(-1.6331, dtype=torch.float64) tensor(12.9586, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1560, dtype=torch.float64) delta_t tensor(0.3909, dtype=torch.float64)
6 gae_duplicate tensor(-0.2524, dtype=torch.float64) tensor(-7.4143, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0300, dtype=torch.float64) delta_t tensor(-0.0766, dtype=torch.float64)
5 gae_duplicate tensor(-0.2202, dtype=torch.float64) tensor(0.9791, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3103, dtype=torch.float64) delta_t tensor(-0.0621, dtype=torch.float64)
4 gae_duplicate tensor(-0.2871, dtype=torch.float64) tensor(1.2960, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1047, dtype=torch.float64) delta_t tensor(-0.0954, dtype=torch.float64)
3 gae_duplicate tensor(-0.2172, dtype=torch.float64) tensor(1.9762, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2568, dtype=torch.float64) delta_t tensor(-0.0520, dtype=torch.float64)
2 gae_duplicate tensor(-0.1656, dtype=torch.float64) tensor(1.1512, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3151.7646484375
value loss:84.45684814453125
entropies:344.5785217285156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.844615936279297 seconds
19 rew tensor(0.8753, dtype=torch.float64) delta_t tensor(0.0413, dtype=torch.float64)
19 gae_duplicate tensor(0.0046, dtype=torch.float64) tensor(-0.7363, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6059, dtype=torch.float64) delta_t tensor(-0.0783, dtype=torch.float64)
18 gae_duplicate tensor(-1.0688, dtype=torch.float64) tensor(1.3175, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6828, dtype=torch.float64) delta_t tensor(0.0429, dtype=torch.float64)
17 gae_duplicate tensor(0.0112, dtype=torch.float64) tensor(-0.6673, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3946, dtype=torch.float64) delta_t tensor(-0.1429, dtype=torch.float64)
16 gae_duplicate tensor(-1.0727, dtype=torch.float64) tensor(2.3832, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4496, dtype=torch.float64) delta_t tensor(-0.1155, dtype=torch.float64)
15 gae_duplicate tensor(-0.9035, dtype=torch.float64) tensor(2.2088, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0700, dtype=torch.float64) delta_t tensor(-0.3873, dtype=torch.float64)
14 gae_duplicate tensor(-1.1029, dtype=torch.float64) tensor(6.9065, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2300, dtype=torch.float64) delta_t tensor(-0.0862, dtype=torch.float64)
13 gae_duplicate tensor(-1.0892, dtype=torch.float64) tensor(2.8921, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4946, dtype=torch.float64) delta_t tensor(0.1445, dtype=torch.float64)
12 gae_duplicate tensor(-0.0937, dtype=torch.float64) tensor(-2.2832, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0030, dtype=torch.float64) delta_t tensor(0.1433, dtype=torch.float64)
11 gae_duplicate tensor(-0.6925, dtype=torch.float64) tensor(-2.2127, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1925, dtype=torch.float64) delta_t tensor(0.3233, dtype=torch.float64)
10 gae_duplicate tensor(-0.5934, dtype=torch.float64) tensor(-6.8564, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3896, dtype=torch.float64) delta_t tensor(-0.5529, dtype=torch.float64)
9 gae_duplicate tensor(-3.0309, dtype=torch.float64) tensor(9.4074, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.7509, dtype=torch.float64) delta_t tensor(-0.9593, dtype=torch.float64)
8 gae_duplicate tensor(-2.5347, dtype=torch.float64) tensor(16.0919, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0156, dtype=torch.float64) delta_t tensor(0.4577, dtype=torch.float64)
7 gae_duplicate tensor(-0.4002, dtype=torch.float64) tensor(-6.6095, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2175, dtype=torch.float64) delta_t tensor(0.6091, dtype=torch.float64)
6 gae_duplicate tensor(0.0687, dtype=torch.float64) tensor(-12.2254, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1637, dtype=torch.float64) delta_t tensor(0.0350, dtype=torch.float64)
5 gae_duplicate tensor(-0.1431, dtype=torch.float64) tensor(-1.8789, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1900, dtype=torch.float64) delta_t tensor(-0.0428, dtype=torch.float64)
4 gae_duplicate tensor(-0.4391, dtype=torch.float64) tensor(0.5407, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1466, dtype=torch.float64) delta_t tensor(-0.0164, dtype=torch.float64)
3 gae_duplicate tensor(-0.2633, dtype=torch.float64) tensor(0.2676, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3062, dtype=torch.float64) delta_t tensor(-0.0335, dtype=torch.float64)
2 gae_duplicate tensor(-0.1354, dtype=torch.float64) tensor(0.6042, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-586.9894409179688
value loss:72.58067321777344
entropies:343.9547119140625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3934.7263)
ToM Target loss= tensor(3604.7354)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.8538818359375 seconds
19 rew tensor(0.8657, dtype=torch.float64) delta_t tensor(0.0206, dtype=torch.float64)
19 gae_duplicate tensor(-0.0479, dtype=torch.float64) tensor(-0.3851, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8471, dtype=torch.float64) delta_t tensor(0.1028, dtype=torch.float64)
18 gae_duplicate tensor(0.0122, dtype=torch.float64) tensor(-1.9465, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7615, dtype=torch.float64) delta_t tensor(0.0914, dtype=torch.float64)
17 gae_duplicate tensor(0.0258, dtype=torch.float64) tensor(-1.8768, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6279, dtype=torch.float64) delta_t tensor(0.0363, dtype=torch.float64)
16 gae_duplicate tensor(-0.0864, dtype=torch.float64) tensor(-0.8119, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4467, dtype=torch.float64) delta_t tensor(-0.1224, dtype=torch.float64)
15 gae_duplicate tensor(-1.0575, dtype=torch.float64) tensor(1.9451, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3860, dtype=torch.float64) delta_t tensor(-0.0854, dtype=torch.float64)
14 gae_duplicate tensor(-0.9956, dtype=torch.float64) tensor(2.1655, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3687, dtype=torch.float64) delta_t tensor(-0.0979, dtype=torch.float64)
13 gae_duplicate tensor(-1.1504, dtype=torch.float64) tensor(1.9752, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2565, dtype=torch.float64) delta_t tensor(-0.0452, dtype=torch.float64)
12 gae_duplicate tensor(-1.1857, dtype=torch.float64) tensor(0.3491, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0333, dtype=torch.float64) delta_t tensor(0.0169, dtype=torch.float64)
11 gae_duplicate tensor(-0.6576, dtype=torch.float64) tensor(0.3516, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2992, dtype=torch.float64) delta_t tensor(0.0352, dtype=torch.float64)
10 gae_duplicate tensor(-1.8903, dtype=torch.float64) tensor(1.4922, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0021, dtype=torch.float64) delta_t tensor(-0.4844, dtype=torch.float64)
9 gae_duplicate tensor(-1.8055, dtype=torch.float64) tensor(8.2322, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0053, dtype=torch.float64) delta_t tensor(-0.3496, dtype=torch.float64)
8 gae_duplicate tensor(-2.4275, dtype=torch.float64) tensor(8.5269, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0051, dtype=torch.float64) delta_t tensor(0.4256, dtype=torch.float64)
7 gae_duplicate tensor(-1.3199, dtype=torch.float64) tensor(-8.6611, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0106, dtype=torch.float64) delta_t tensor(0.5294, dtype=torch.float64)
6 gae_duplicate tensor(-0.0049, dtype=torch.float64) tensor(-11.2039, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1548, dtype=torch.float64) delta_t tensor(-0.0351, dtype=torch.float64)
5 gae_duplicate tensor(-0.2486, dtype=torch.float64) tensor(-0.4986, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0076, dtype=torch.float64) delta_t tensor(-0.0705, dtype=torch.float64)
4 gae_duplicate tensor(-0.3410, dtype=torch.float64) tensor(1.3113, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2978, dtype=torch.float64) delta_t tensor(0.0624, dtype=torch.float64)
3 gae_duplicate tensor(-0.0079, dtype=torch.float64) tensor(-1.0296, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4006, dtype=torch.float64) delta_t tensor(-0.0557, dtype=torch.float64)
2 gae_duplicate tensor(-0.1976, dtype=torch.float64) tensor(0.9898, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-142.8184814453125
value loss:54.55703353881836
entropies:343.9010314941406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.568849086761475 seconds
19 rew tensor(0.8655, dtype=torch.float64) delta_t tensor(0.0624, dtype=torch.float64)
19 gae_duplicate tensor(-0.0480, dtype=torch.float64) tensor(-1.0569, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7603, dtype=torch.float64) delta_t tensor(0.0902, dtype=torch.float64)
18 gae_duplicate tensor(0.0279, dtype=torch.float64) tensor(-1.6569, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7713, dtype=torch.float64) delta_t tensor(0.1222, dtype=torch.float64)
17 gae_duplicate tensor(0.0819, dtype=torch.float64) tensor(-2.7495, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6936, dtype=torch.float64) delta_t tensor(0.0985, dtype=torch.float64)
16 gae_duplicate tensor(0.0720, dtype=torch.float64) tensor(-2.0232, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5896, dtype=torch.float64) delta_t tensor(0.0517, dtype=torch.float64)
15 gae_duplicate tensor(0.0287, dtype=torch.float64) tensor(-1.2888, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3875, dtype=torch.float64) delta_t tensor(-0.0526, dtype=torch.float64)
14 gae_duplicate tensor(-0.9858, dtype=torch.float64) tensor(0.2862, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6484, dtype=torch.float64) delta_t tensor(0.2935, dtype=torch.float64)
13 gae_duplicate tensor(-0.0319, dtype=torch.float64) tensor(-5.4325, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4817, dtype=torch.float64) delta_t tensor(0.1164, dtype=torch.float64)
12 gae_duplicate tensor(-0.0363, dtype=torch.float64) tensor(-3.2963, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1491, dtype=torch.float64) delta_t tensor(-0.1554, dtype=torch.float64)
11 gae_duplicate tensor(-1.3798, dtype=torch.float64) tensor(1.9289, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1456, dtype=torch.float64) delta_t tensor(0.6608, dtype=torch.float64)
10 gae_duplicate tensor(-0.4489, dtype=torch.float64) tensor(-13.4837, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.8369, dtype=torch.float64) delta_t tensor(-1.1285, dtype=torch.float64)
9 gae_duplicate tensor(-4.0379, dtype=torch.float64) tensor(19.1936, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.5932, dtype=torch.float64) delta_t tensor(-0.8535, dtype=torch.float64)
8 gae_duplicate tensor(-3.4271, dtype=torch.float64) tensor(20.4549, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4595, dtype=torch.float64) delta_t tensor(0.0704, dtype=torch.float64)
7 gae_duplicate tensor(-1.9969, dtype=torch.float64) tensor(1.1793, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3585, dtype=torch.float64) delta_t tensor(0.2268, dtype=torch.float64)
6 gae_duplicate tensor(-1.1786, dtype=torch.float64) tensor(-5.9709, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0161, dtype=torch.float64) delta_t tensor(0.0815, dtype=torch.float64)
5 gae_duplicate tensor(0.0059, dtype=torch.float64) tensor(-2.0969, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3569, dtype=torch.float64) delta_t tensor(0.0161, dtype=torch.float64)
4 gae_duplicate tensor(-0.0985, dtype=torch.float64) tensor(-0.5687, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0853, dtype=torch.float64) delta_t tensor(0.0244, dtype=torch.float64)
3 gae_duplicate tensor(-0.1365, dtype=torch.float64) tensor(-0.5096, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1108, dtype=torch.float64) delta_t tensor(-0.0012, dtype=torch.float64)
2 gae_duplicate tensor(-0.0544, dtype=torch.float64) tensor(0.0144, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-250.6855010986328
value loss:87.54672241210938
entropies:343.7819519042969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.067216873168945 seconds
19 rew tensor(0.8660, dtype=torch.float64) delta_t tensor(0.0535, dtype=torch.float64)
19 gae_duplicate tensor(-0.0085, dtype=torch.float64) tensor(-1.1886, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8181, dtype=torch.float64) delta_t tensor(0.1291, dtype=torch.float64)
18 gae_duplicate tensor(0.0209, dtype=torch.float64) tensor(-2.3099, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7603, dtype=torch.float64) delta_t tensor(0.1111, dtype=torch.float64)
17 gae_duplicate tensor(0.0791, dtype=torch.float64) tensor(-2.3040, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7031, dtype=torch.float64) delta_t tensor(0.1448, dtype=torch.float64)
16 gae_duplicate tensor(0.1301, dtype=torch.float64) tensor(-2.9264, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7050, dtype=torch.float64) delta_t tensor(0.1418, dtype=torch.float64)
15 gae_duplicate tensor(0.0043, dtype=torch.float64) tensor(-2.6229, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3833, dtype=torch.float64) delta_t tensor(-0.0444, dtype=torch.float64)
14 gae_duplicate tensor(-1.0938, dtype=torch.float64) tensor(1.5274, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3785, dtype=torch.float64) delta_t tensor(0.0059, dtype=torch.float64)
13 gae_duplicate tensor(-0.9744, dtype=torch.float64) tensor(0.3899, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3473, dtype=torch.float64) delta_t tensor(0.1239, dtype=torch.float64)
12 gae_duplicate tensor(-0.9056, dtype=torch.float64) tensor(-2.9657, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0888, dtype=torch.float64) delta_t tensor(0.1565, dtype=torch.float64)
11 gae_duplicate tensor(-0.8611, dtype=torch.float64) tensor(-3.7971, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0120, dtype=torch.float64) delta_t tensor(0.3824, dtype=torch.float64)
10 gae_duplicate tensor(0.1169, dtype=torch.float64) tensor(-7.2477, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7562, dtype=torch.float64) delta_t tensor(-1.0650, dtype=torch.float64)
9 gae_duplicate tensor(-3.0360, dtype=torch.float64) tensor(17.3358, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8170, dtype=torch.float64) delta_t tensor(-0.3888, dtype=torch.float64)
8 gae_duplicate tensor(-2.4615, dtype=torch.float64) tensor(10.8718, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3637, dtype=torch.float64) delta_t tensor(0.3340, dtype=torch.float64)
7 gae_duplicate tensor(-1.2481, dtype=torch.float64) tensor(-4.5835, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5111, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
6 gae_duplicate tensor(-1.1462, dtype=torch.float64) tensor(-1.8249, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0115, dtype=torch.float64) delta_t tensor(0.0160, dtype=torch.float64)
5 gae_duplicate tensor(-0.1392, dtype=torch.float64) tensor(-0.5065, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1075, dtype=torch.float64) delta_t tensor(-0.0629, dtype=torch.float64)
4 gae_duplicate tensor(-0.4175, dtype=torch.float64) tensor(1.2413, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1053, dtype=torch.float64) delta_t tensor(0.0453, dtype=torch.float64)
3 gae_duplicate tensor(-0.1551, dtype=torch.float64) tensor(-0.7504, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2630, dtype=torch.float64) delta_t tensor(0.0037, dtype=torch.float64)
2 gae_duplicate tensor(-0.0757, dtype=torch.float64) tensor(-0.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:9.551349639892578
value loss:76.41952514648438
entropies:343.7143249511719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.595602035522461 seconds
19 rew tensor(0.8360, dtype=torch.float64) delta_t tensor(0.1035, dtype=torch.float64)
19 gae_duplicate tensor(0.0562, dtype=torch.float64) tensor(-2.0727, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.3635, dtype=torch.float64) delta_t tensor(-0.2563, dtype=torch.float64)
18 gae_duplicate tensor(-1.0543, dtype=torch.float64) tensor(3.9537, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7896, dtype=torch.float64) delta_t tensor(0.1585, dtype=torch.float64)
17 gae_duplicate tensor(0.0069, dtype=torch.float64) tensor(-2.5423, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7309, dtype=torch.float64) delta_t tensor(0.1880, dtype=torch.float64)
16 gae_duplicate tensor(0.1412, dtype=torch.float64) tensor(-4.3042, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6857, dtype=torch.float64) delta_t tensor(0.2179, dtype=torch.float64)
15 gae_duplicate tensor(0.1368, dtype=torch.float64) tensor(-4.8097, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2906, dtype=torch.float64) delta_t tensor(-0.1080, dtype=torch.float64)
14 gae_duplicate tensor(-0.8714, dtype=torch.float64) tensor(2.1351, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4346, dtype=torch.float64) delta_t tensor(0.1816, dtype=torch.float64)
13 gae_duplicate tensor(-0.8732, dtype=torch.float64) tensor(-3.2476, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4612, dtype=torch.float64) delta_t tensor(0.1182, dtype=torch.float64)
12 gae_duplicate tensor(-0.6915, dtype=torch.float64) tensor(-2.8818, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2786, dtype=torch.float64) delta_t tensor(0.2816, dtype=torch.float64)
11 gae_duplicate tensor(-0.7260, dtype=torch.float64) tensor(-5.9585, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5389, dtype=torch.float64) delta_t tensor(0.7693, dtype=torch.float64)
10 gae_duplicate tensor(0.6056, dtype=torch.float64) tensor(-13.7232, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.8835, dtype=torch.float64) delta_t tensor(-1.7735, dtype=torch.float64)
9 gae_duplicate tensor(-4.0484, dtype=torch.float64) tensor(26.5674, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.4744, dtype=torch.float64) delta_t tensor(-0.6510, dtype=torch.float64)
8 gae_duplicate tensor(-2.9018, dtype=torch.float64) tensor(13.2389, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8188, dtype=torch.float64) delta_t tensor(-0.1265, dtype=torch.float64)
7 gae_duplicate tensor(-1.5511, dtype=torch.float64) tensor(4.7084, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0559, dtype=torch.float64) delta_t tensor(0.4944, dtype=torch.float64)
6 gae_duplicate tensor(-0.2166, dtype=torch.float64) tensor(-9.3620, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0669, dtype=torch.float64) delta_t tensor(0.0216, dtype=torch.float64)
5 gae_duplicate tensor(-0.0642, dtype=torch.float64) tensor(-1.2953, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2388, dtype=torch.float64) delta_t tensor(0.0399, dtype=torch.float64)
4 gae_duplicate tensor(-0.0823, dtype=torch.float64) tensor(-0.8723, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1448, dtype=torch.float64) delta_t tensor(0.0292, dtype=torch.float64)
3 gae_duplicate tensor(-0.1231, dtype=torch.float64) tensor(-0.7224, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3113, dtype=torch.float64) delta_t tensor(-0.0309, dtype=torch.float64)
2 gae_duplicate tensor(-0.1662, dtype=torch.float64) tensor(0.4588, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-53.3731575012207
value loss:109.26873779296875
entropies:343.5877380371094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7456278800964355 seconds
19 rew tensor(0.8548, dtype=torch.float64) delta_t tensor(0.0679, dtype=torch.float64)
19 gae_duplicate tensor(-0.0010, dtype=torch.float64) tensor(-1.4604, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7601, dtype=torch.float64) delta_t tensor(0.1155, dtype=torch.float64)
18 gae_duplicate tensor(0.0669, dtype=torch.float64) tensor(-2.5360, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8079, dtype=torch.float64) delta_t tensor(0.1631, dtype=torch.float64)
17 gae_duplicate tensor(0.1172, dtype=torch.float64) tensor(-3.1976, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6836, dtype=torch.float64) delta_t tensor(0.1518, dtype=torch.float64)
16 gae_duplicate tensor(0.0806, dtype=torch.float64) tensor(-2.9642, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5979, dtype=torch.float64) delta_t tensor(0.0947, dtype=torch.float64)
15 gae_duplicate tensor(0.0601, dtype=torch.float64) tensor(-2.0460, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3305, dtype=torch.float64) delta_t tensor(0.0488, dtype=torch.float64)
14 gae_duplicate tensor(-0.9371, dtype=torch.float64) tensor(-0.3369, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4601, dtype=torch.float64) delta_t tensor(0.0899, dtype=torch.float64)
13 gae_duplicate tensor(-0.9680, dtype=torch.float64) tensor(-0.4767, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3764, dtype=torch.float64) delta_t tensor(0.2038, dtype=torch.float64)
12 gae_duplicate tensor(-0.0333, dtype=torch.float64) tensor(-4.0572, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2185, dtype=torch.float64) delta_t tensor(-0.0014, dtype=torch.float64)
11 gae_duplicate tensor(-1.4870, dtype=torch.float64) tensor(-1.7107, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4642, dtype=torch.float64) delta_t tensor(-0.0752, dtype=torch.float64)
10 gae_duplicate tensor(-0.8514, dtype=torch.float64) tensor(1.7584, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9741, dtype=torch.float64) delta_t tensor(-0.3345, dtype=torch.float64)
9 gae_duplicate tensor(-1.8244, dtype=torch.float64) tensor(5.8553, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.2783, dtype=torch.float64) delta_t tensor(-1.2688, dtype=torch.float64)
8 gae_duplicate tensor(-5.0850, dtype=torch.float64) tensor(20.0985, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3319, dtype=torch.float64) delta_t tensor(0.8426, dtype=torch.float64)
7 gae_duplicate tensor(-0.3096, dtype=torch.float64) tensor(-13.7647, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0789, dtype=torch.float64) delta_t tensor(0.6132, dtype=torch.float64)
6 gae_duplicate tensor(0.0045, dtype=torch.float64) tensor(-12.8032, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2198, dtype=torch.float64) delta_t tensor(-0.0542, dtype=torch.float64)
5 gae_duplicate tensor(-0.4456, dtype=torch.float64) tensor(-0.1717, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0964, dtype=torch.float64) delta_t tensor(-0.0492, dtype=torch.float64)
4 gae_duplicate tensor(-0.2206, dtype=torch.float64) tensor(0.9958, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3260, dtype=torch.float64) delta_t tensor(0.0356, dtype=torch.float64)
3 gae_duplicate tensor(-0.1128, dtype=torch.float64) tensor(-0.5589, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4072, dtype=torch.float64) delta_t tensor(-0.0243, dtype=torch.float64)
2 gae_duplicate tensor(-0.1743, dtype=torch.float64) tensor(0.3333, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:827.452392578125
value loss:103.54737854003906
entropies:343.94647216796875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3921.4849)
ToM Target loss= tensor(3603.5327)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.9014599323272705 seconds
19 rew tensor(0.8166, dtype=torch.float64) delta_t tensor(0.0376, dtype=torch.float64)
19 gae_duplicate tensor(-0.0498, dtype=torch.float64) tensor(-0.6608, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5913, dtype=torch.float64) delta_t tensor(-0.0802, dtype=torch.float64)
18 gae_duplicate tensor(-1.0193, dtype=torch.float64) tensor(1.0370, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7885, dtype=torch.float64) delta_t tensor(0.1326, dtype=torch.float64)
17 gae_duplicate tensor(0.0867, dtype=torch.float64) tensor(-2.3706, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7406, dtype=torch.float64) delta_t tensor(0.1361, dtype=torch.float64)
16 gae_duplicate tensor(0.0637, dtype=torch.float64) tensor(-2.9339, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6019, dtype=torch.float64) delta_t tensor(0.0362, dtype=torch.float64)
15 gae_duplicate tensor(-0.8569, dtype=torch.float64) tensor(-1.7659, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6935, dtype=torch.float64) delta_t tensor(0.2613, dtype=torch.float64)
14 gae_duplicate tensor(0.1301, dtype=torch.float64) tensor(-5.1641, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5558, dtype=torch.float64) delta_t tensor(0.1295, dtype=torch.float64)
13 gae_duplicate tensor(-0.8178, dtype=torch.float64) tensor(-1.8224, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4760, dtype=torch.float64) delta_t tensor(0.2215, dtype=torch.float64)
12 gae_duplicate tensor(0.1218, dtype=torch.float64) tensor(-4.3806, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3224, dtype=torch.float64) delta_t tensor(0.2817, dtype=torch.float64)
11 gae_duplicate tensor(-1.3913, dtype=torch.float64) tensor(-5.4595, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2361, dtype=torch.float64) delta_t tensor(0.1512, dtype=torch.float64)
10 gae_duplicate tensor(-1.3950, dtype=torch.float64) tensor(-4.9942, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.9481, dtype=torch.float64) delta_t tensor(-1.7866, dtype=torch.float64)
9 gae_duplicate tensor(-3.4062, dtype=torch.float64) tensor(35.6076, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.6408, dtype=torch.float64) delta_t tensor(-1.9368, dtype=torch.float64)
8 gae_duplicate tensor(-3.0429, dtype=torch.float64) tensor(45.0675, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6927, dtype=torch.float64) delta_t tensor(0.1143, dtype=torch.float64)
7 gae_duplicate tensor(-1.3072, dtype=torch.float64) tensor(2.1449, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3635, dtype=torch.float64) delta_t tensor(0.7564, dtype=torch.float64)
6 gae_duplicate tensor(-0.0091, dtype=torch.float64) tensor(-14.1795, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0408, dtype=torch.float64) delta_t tensor(-0.0471, dtype=torch.float64)
5 gae_duplicate tensor(-0.3365, dtype=torch.float64) tensor(-0.7805, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3919, dtype=torch.float64) delta_t tensor(0.0152, dtype=torch.float64)
4 gae_duplicate tensor(-0.1815, dtype=torch.float64) tensor(-0.5282, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1089, dtype=torch.float64) delta_t tensor(-0.0330, dtype=torch.float64)
3 gae_duplicate tensor(-0.1102, dtype=torch.float64) tensor(0.5766, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2583, dtype=torch.float64) delta_t tensor(-0.0377, dtype=torch.float64)
2 gae_duplicate tensor(-0.1632, dtype=torch.float64) tensor(0.9208, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2269.937744140625
value loss:130.57034301757812
entropies:344.3604736328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.834147214889526 seconds
19 rew tensor(0.8641, dtype=torch.float64) delta_t tensor(0.0963, dtype=torch.float64)
19 gae_duplicate tensor(-0.0220, dtype=torch.float64) tensor(-1.8847, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.1670, dtype=torch.float64)
18 gae_duplicate tensor(0.1074, dtype=torch.float64) tensor(-3.6753, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7680, dtype=torch.float64) delta_t tensor(0.1398, dtype=torch.float64)
17 gae_duplicate tensor(0.0562, dtype=torch.float64) tensor(-3.4794, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6375, dtype=torch.float64) delta_t tensor(0.0917, dtype=torch.float64)
16 gae_duplicate tensor(-0.0525, dtype=torch.float64) tensor(-2.1074, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6063, dtype=torch.float64) delta_t tensor(0.1323, dtype=torch.float64)
15 gae_duplicate tensor(0.0628, dtype=torch.float64) tensor(-2.3524, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3903, dtype=torch.float64) delta_t tensor(-0.0333, dtype=torch.float64)
14 gae_duplicate tensor(-0.9312, dtype=torch.float64) tensor(0.1472, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5491, dtype=torch.float64) delta_t tensor(0.2299, dtype=torch.float64)
13 gae_duplicate tensor(0.0811, dtype=torch.float64) tensor(-4.8050, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4063, dtype=torch.float64) delta_t tensor(0.0691, dtype=torch.float64)
12 gae_duplicate tensor(-0.6575, dtype=torch.float64) tensor(-1.6505, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1854, dtype=torch.float64) delta_t tensor(0.1454, dtype=torch.float64)
11 gae_duplicate tensor(-0.5123, dtype=torch.float64) tensor(-3.4282, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0337, dtype=torch.float64) delta_t tensor(0.5159, dtype=torch.float64)
10 gae_duplicate tensor(-0.5319, dtype=torch.float64) tensor(-7.5900, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1139, dtype=torch.float64) delta_t tensor(-0.2815, dtype=torch.float64)
9 gae_duplicate tensor(-1.7595, dtype=torch.float64) tensor(5.0614, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7833, dtype=torch.float64) delta_t tensor(-0.2243, dtype=torch.float64)
8 gae_duplicate tensor(-4.4218, dtype=torch.float64) tensor(3.1844, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1789, dtype=torch.float64) delta_t tensor(-0.1613, dtype=torch.float64)
7 gae_duplicate tensor(-1.2897, dtype=torch.float64) tensor(3.7244, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1496, dtype=torch.float64) delta_t tensor(0.5462, dtype=torch.float64)
6 gae_duplicate tensor(-0.5162, dtype=torch.float64) tensor(-8.4905, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2932, dtype=torch.float64) delta_t tensor(0.0964, dtype=torch.float64)
5 gae_duplicate tensor(-0.1909, dtype=torch.float64) tensor(-2.2099, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4411, dtype=torch.float64) delta_t tensor(0.0216, dtype=torch.float64)
4 gae_duplicate tensor(-0.1471, dtype=torch.float64) tensor(-0.6657, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1589, dtype=torch.float64) delta_t tensor(-0.0818, dtype=torch.float64)
3 gae_duplicate tensor(-0.3302, dtype=torch.float64) tensor(1.7989, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1115, dtype=torch.float64) delta_t tensor(-0.0023, dtype=torch.float64)
2 gae_duplicate tensor(-0.0566, dtype=torch.float64) tensor(0.2201, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1429.891357421875
value loss:74.57170104980469
entropies:344.6250915527344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.973015069961548 seconds
19 rew tensor(0.8639, dtype=torch.float64) delta_t tensor(0.0010, dtype=torch.float64)
19 gae_duplicate tensor(-0.1050, dtype=torch.float64) tensor(-0.0547, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(0.0599, dtype=torch.float64)
18 gae_duplicate tensor(-8.9523e-05, dtype=torch.float64) tensor(-0.9934, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7870, dtype=torch.float64) delta_t tensor(0.1507, dtype=torch.float64)
17 gae_duplicate tensor(0.0642, dtype=torch.float64) tensor(-2.7109, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7309, dtype=torch.float64) delta_t tensor(0.0652, dtype=torch.float64)
16 gae_duplicate tensor(0.0453, dtype=torch.float64) tensor(-1.5188, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3495, dtype=torch.float64) delta_t tensor(-0.1244, dtype=torch.float64)
15 gae_duplicate tensor(-0.9731, dtype=torch.float64) tensor(1.6243, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5270, dtype=torch.float64) delta_t tensor(0.0120, dtype=torch.float64)
14 gae_duplicate tensor(-1.0374, dtype=torch.float64) tensor(0.3731, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3364, dtype=torch.float64) delta_t tensor(-0.0568, dtype=torch.float64)
13 gae_duplicate tensor(-0.9642, dtype=torch.float64) tensor(1.5787, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4006, dtype=torch.float64) delta_t tensor(0.0240, dtype=torch.float64)
12 gae_duplicate tensor(-0.8109, dtype=torch.float64) tensor(-0.7428, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0744, dtype=torch.float64) delta_t tensor(-0.1527, dtype=torch.float64)
11 gae_duplicate tensor(-0.9275, dtype=torch.float64) tensor(3.1208, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4581, dtype=torch.float64) delta_t tensor(0.5280, dtype=torch.float64)
10 gae_duplicate tensor(0.0928, dtype=torch.float64) tensor(-9.8243, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1724, dtype=torch.float64) delta_t tensor(-0.1623, dtype=torch.float64)
9 gae_duplicate tensor(-1.6022, dtype=torch.float64) tensor(2.5235, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1945, dtype=torch.float64) delta_t tensor(-0.4902, dtype=torch.float64)
8 gae_duplicate tensor(-1.8011, dtype=torch.float64) tensor(10.2155, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9656, dtype=torch.float64) delta_t tensor(-0.0897, dtype=torch.float64)
7 gae_duplicate tensor(-3.1255, dtype=torch.float64) tensor(5.4429, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3794, dtype=torch.float64) delta_t tensor(0.0184, dtype=torch.float64)
6 gae_duplicate tensor(-2.3034, dtype=torch.float64) tensor(-0.0757, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1567, dtype=torch.float64) delta_t tensor(0.1268, dtype=torch.float64)
5 gae_duplicate tensor(-0.2408, dtype=torch.float64) tensor(-2.3215, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4850, dtype=torch.float64) delta_t tensor(0.0407, dtype=torch.float64)
4 gae_duplicate tensor(-0.2225, dtype=torch.float64) tensor(-1.1326, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2217, dtype=torch.float64) delta_t tensor(0.0257, dtype=torch.float64)
3 gae_duplicate tensor(-0.1708, dtype=torch.float64) tensor(-0.5865, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0108, dtype=torch.float64) delta_t tensor(-0.0186, dtype=torch.float64)
2 gae_duplicate tensor(-0.1316, dtype=torch.float64) tensor(0.1798, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-368.2491149902344
value loss:70.33875274658203
entropies:344.394287109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.72589898109436 seconds
19 rew tensor(0.8641, dtype=torch.float64) delta_t tensor(-0.0169, dtype=torch.float64)
19 gae_duplicate tensor(-0.1034, dtype=torch.float64) tensor(0.2336, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7972, dtype=torch.float64) delta_t tensor(0.1031, dtype=torch.float64)
18 gae_duplicate tensor(-0.0109, dtype=torch.float64) tensor(-2.3620, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7798, dtype=torch.float64) delta_t tensor(0.1011, dtype=torch.float64)
17 gae_duplicate tensor(-0.0425, dtype=torch.float64) tensor(-1.8404, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5498, dtype=torch.float64) delta_t tensor(0.0594, dtype=torch.float64)
16 gae_duplicate tensor(-0.0028, dtype=torch.float64) tensor(-1.3575, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7214, dtype=torch.float64) delta_t tensor(0.0842, dtype=torch.float64)
15 gae_duplicate tensor(0.0173, dtype=torch.float64) tensor(-1.7595, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0575, dtype=torch.float64) delta_t tensor(-0.2606, dtype=torch.float64)
14 gae_duplicate tensor(-1.0637, dtype=torch.float64) tensor(4.5740, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4259, dtype=torch.float64) delta_t tensor(-0.1418, dtype=torch.float64)
13 gae_duplicate tensor(-1.0390, dtype=torch.float64) tensor(3.5631, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3407, dtype=torch.float64) delta_t tensor(0.2278, dtype=torch.float64)
12 gae_duplicate tensor(-0.0523, dtype=torch.float64) tensor(-3.8833, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4729, dtype=torch.float64) delta_t tensor(0.3623, dtype=torch.float64)
11 gae_duplicate tensor(-0.4277, dtype=torch.float64) tensor(-6.9393, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2153, dtype=torch.float64) delta_t tensor(0.0496, dtype=torch.float64)
10 gae_duplicate tensor(-0.6292, dtype=torch.float64) tensor(-1.9248, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2511, dtype=torch.float64) delta_t tensor(-1.0339, dtype=torch.float64)
9 gae_duplicate tensor(-3.6747, dtype=torch.float64) tensor(21.8077, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0667, dtype=torch.float64) delta_t tensor(0.5086, dtype=torch.float64)
8 gae_duplicate tensor(-0.1242, dtype=torch.float64) tensor(-8.2531, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0072, dtype=torch.float64) delta_t tensor(0.2334, dtype=torch.float64)
7 gae_duplicate tensor(-1.0565, dtype=torch.float64) tensor(-5.2230, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3998, dtype=torch.float64) delta_t tensor(0.1150, dtype=torch.float64)
6 gae_duplicate tensor(0.0404, dtype=torch.float64) tensor(-2.4895, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2264, dtype=torch.float64) delta_t tensor(-0.1094, dtype=torch.float64)
5 gae_duplicate tensor(-0.3199, dtype=torch.float64) tensor(1.7634, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4695, dtype=torch.float64) delta_t tensor(-0.2511, dtype=torch.float64)
4 gae_duplicate tensor(-0.4245, dtype=torch.float64) tensor(4.7784, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5512, dtype=torch.float64) delta_t tensor(0.0529, dtype=torch.float64)
3 gae_duplicate tensor(-0.2145, dtype=torch.float64) tensor(-0.2881, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6025, dtype=torch.float64) delta_t tensor(-0.1310, dtype=torch.float64)
2 gae_duplicate tensor(-0.2386, dtype=torch.float64) tensor(2.3469, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-241.24024963378906
value loss:54.60065841674805
entropies:344.1713562011719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.766816139221191 seconds
19 rew tensor(0.6891, dtype=torch.float64) delta_t tensor(-0.2420, dtype=torch.float64)
19 gae_duplicate tensor(-1.1725, dtype=torch.float64) tensor(4.4517, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8369, dtype=torch.float64) delta_t tensor(0.0547, dtype=torch.float64)
18 gae_duplicate tensor(-0.1229, dtype=torch.float64) tensor(-0.5667, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6131, dtype=torch.float64) delta_t tensor(-0.1438, dtype=torch.float64)
17 gae_duplicate tensor(-1.0543, dtype=torch.float64) tensor(2.4683, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7030, dtype=torch.float64) delta_t tensor(0.0785, dtype=torch.float64)
16 gae_duplicate tensor(-0.0368, dtype=torch.float64) tensor(-1.1632, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4362, dtype=torch.float64) delta_t tensor(-0.1651, dtype=torch.float64)
15 gae_duplicate tensor(-1.0351, dtype=torch.float64) tensor(2.7890, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3542, dtype=torch.float64) delta_t tensor(-0.0584, dtype=torch.float64)
14 gae_duplicate tensor(-0.9751, dtype=torch.float64) tensor(1.8309, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6650, dtype=torch.float64) delta_t tensor(0.1132, dtype=torch.float64)
13 gae_duplicate tensor(0.0443, dtype=torch.float64) tensor(-1.9498, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2872, dtype=torch.float64) delta_t tensor(-0.0572, dtype=torch.float64)
12 gae_duplicate tensor(-0.8535, dtype=torch.float64) tensor(0.3680, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2698, dtype=torch.float64) delta_t tensor(-0.3894, dtype=torch.float64)
11 gae_duplicate tensor(-0.9451, dtype=torch.float64) tensor(6.9983, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2323, dtype=torch.float64) delta_t tensor(-0.0863, dtype=torch.float64)
10 gae_duplicate tensor(-1.0026, dtype=torch.float64) tensor(3.7086, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6733, dtype=torch.float64) delta_t tensor(-0.2327, dtype=torch.float64)
9 gae_duplicate tensor(-1.7618, dtype=torch.float64) tensor(3.2900, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3537, dtype=torch.float64) delta_t tensor(0.1035, dtype=torch.float64)
8 gae_duplicate tensor(-1.3526, dtype=torch.float64) tensor(-1.7247, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0651, dtype=torch.float64) delta_t tensor(0.6591, dtype=torch.float64)
7 gae_duplicate tensor(0.1146, dtype=torch.float64) tensor(-11.8073, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0787, dtype=torch.float64) delta_t tensor(0.3808, dtype=torch.float64)
6 gae_duplicate tensor(0.0377, dtype=torch.float64) tensor(-7.8355, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0182, dtype=torch.float64) delta_t tensor(-0.1604, dtype=torch.float64)
5 gae_duplicate tensor(-0.3070, dtype=torch.float64) tensor(2.4460, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0410, dtype=torch.float64) delta_t tensor(-0.1258, dtype=torch.float64)
4 gae_duplicate tensor(-0.4309, dtype=torch.float64) tensor(2.0420, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1831, dtype=torch.float64) delta_t tensor(-0.0748, dtype=torch.float64)
3 gae_duplicate tensor(-0.2479, dtype=torch.float64) tensor(1.7989, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3939, dtype=torch.float64) delta_t tensor(-0.0929, dtype=torch.float64)
2 gae_duplicate tensor(-0.2529, dtype=torch.float64) tensor(2.0104, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-587.209716796875
value loss:43.69146728515625
entropies:343.8486328125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3930.8225)
ToM Target loss= tensor(3606.2195)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.869802951812744 seconds
19 rew tensor(0.8545, dtype=torch.float64) delta_t tensor(-0.0400, dtype=torch.float64)
19 gae_duplicate tensor(-0.0896, dtype=torch.float64) tensor(0.6487, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8355, dtype=torch.float64) delta_t tensor(0.0489, dtype=torch.float64)
18 gae_duplicate tensor(-0.0726, dtype=torch.float64) tensor(-0.8229, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8174, dtype=torch.float64) delta_t tensor(0.0787, dtype=torch.float64)
17 gae_duplicate tensor(-0.1001, dtype=torch.float64) tensor(-1.1336, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8077, dtype=torch.float64) delta_t tensor(0.0580, dtype=torch.float64)
16 gae_duplicate tensor(-0.0237, dtype=torch.float64) tensor(-1.2691, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5045, dtype=torch.float64) delta_t tensor(-0.0980, dtype=torch.float64)
15 gae_duplicate tensor(-1.0341, dtype=torch.float64) tensor(0.9943, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7219, dtype=torch.float64) delta_t tensor(0.1199, dtype=torch.float64)
14 gae_duplicate tensor(-0.0307, dtype=torch.float64) tensor(-1.9339, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6079, dtype=torch.float64) delta_t tensor(0.1641, dtype=torch.float64)
13 gae_duplicate tensor(-0.0288, dtype=torch.float64) tensor(-3.5932, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7055, dtype=torch.float64) delta_t tensor(0.1708, dtype=torch.float64)
12 gae_duplicate tensor(0.0804, dtype=torch.float64) tensor(-3.4833, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1607, dtype=torch.float64) delta_t tensor(0.2888, dtype=torch.float64)
11 gae_duplicate tensor(0.0915, dtype=torch.float64) tensor(-6.7331, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1162, dtype=torch.float64) delta_t tensor(-0.2630, dtype=torch.float64)
10 gae_duplicate tensor(-2.2733, dtype=torch.float64) tensor(2.7989, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.9838, dtype=torch.float64) delta_t tensor(-1.6213, dtype=torch.float64)
9 gae_duplicate tensor(-4.1260, dtype=torch.float64) tensor(28.0632, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5109, dtype=torch.float64) delta_t tensor(-0.3784, dtype=torch.float64)
8 gae_duplicate tensor(-2.0564, dtype=torch.float64) tensor(10.5753, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1600, dtype=torch.float64) delta_t tensor(0.1336, dtype=torch.float64)
7 gae_duplicate tensor(-1.1953, dtype=torch.float64) tensor(-1.3834, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5829, dtype=torch.float64) delta_t tensor(-0.5740, dtype=torch.float64)
6 gae_duplicate tensor(-2.1375, dtype=torch.float64) tensor(11.1128, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5836, dtype=torch.float64) delta_t tensor(-1.2739, dtype=torch.float64)
5 gae_duplicate tensor(-3.5078, dtype=torch.float64) tensor(27.3649, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2671, dtype=torch.float64) delta_t tensor(-0.1922, dtype=torch.float64)
4 gae_duplicate tensor(-2.6080, dtype=torch.float64) tensor(5.1377, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1979, dtype=torch.float64) delta_t tensor(-0.1764, dtype=torch.float64)
3 gae_duplicate tensor(-0.4199, dtype=torch.float64) tensor(4.2790, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0291, dtype=torch.float64) delta_t tensor(-0.1226, dtype=torch.float64)
2 gae_duplicate tensor(-0.7121, dtype=torch.float64) tensor(2.5069, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4041.71142578125
value loss:137.98045349121094
entropies:343.4898986816406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7050580978393555 seconds
19 rew tensor(0.8250, dtype=torch.float64) delta_t tensor(-0.0573, dtype=torch.float64)
19 gae_duplicate tensor(-0.1423, dtype=torch.float64) tensor(1.2521, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7488, dtype=torch.float64) delta_t tensor(0.0318, dtype=torch.float64)
18 gae_duplicate tensor(-0.0653, dtype=torch.float64) tensor(-0.6634, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7303, dtype=torch.float64) delta_t tensor(0.0386, dtype=torch.float64)
17 gae_duplicate tensor(-0.0734, dtype=torch.float64) tensor(-0.7999, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7036, dtype=torch.float64) delta_t tensor(0.0619, dtype=torch.float64)
16 gae_duplicate tensor(0.0076, dtype=torch.float64) tensor(-1.3194, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5495, dtype=torch.float64) delta_t tensor(-0.0072, dtype=torch.float64)
15 gae_duplicate tensor(-0.0356, dtype=torch.float64) tensor(0.0179, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5522, dtype=torch.float64) delta_t tensor(0.1124, dtype=torch.float64)
14 gae_duplicate tensor(0.0640, dtype=torch.float64) tensor(-1.9303, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5962, dtype=torch.float64) delta_t tensor(0.1284, dtype=torch.float64)
13 gae_duplicate tensor(0.0800, dtype=torch.float64) tensor(-2.5845, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1601, dtype=torch.float64) delta_t tensor(-0.2274, dtype=torch.float64)
12 gae_duplicate tensor(-1.0581, dtype=torch.float64) tensor(2.6325, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3108, dtype=torch.float64) delta_t tensor(-0.3748, dtype=torch.float64)
11 gae_duplicate tensor(-1.3055, dtype=torch.float64) tensor(8.4982, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4692, dtype=torch.float64) delta_t tensor(0.5188, dtype=torch.float64)
10 gae_duplicate tensor(0.2672, dtype=torch.float64) tensor(-8.3321, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6216, dtype=torch.float64) delta_t tensor(-0.9467, dtype=torch.float64)
9 gae_duplicate tensor(-4.0416, dtype=torch.float64) tensor(16.2512, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0446, dtype=torch.float64) delta_t tensor(0.0820, dtype=torch.float64)
8 gae_duplicate tensor(-0.9528, dtype=torch.float64) tensor(1.6342, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5015, dtype=torch.float64) delta_t tensor(0.0353, dtype=torch.float64)
7 gae_duplicate tensor(-2.0779, dtype=torch.float64) tensor(0.2238, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4002, dtype=torch.float64) delta_t tensor(-0.1321, dtype=torch.float64)
6 gae_duplicate tensor(-2.9848, dtype=torch.float64) tensor(2.0460, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2520, dtype=torch.float64) delta_t tensor(-0.1261, dtype=torch.float64)
5 gae_duplicate tensor(-0.4505, dtype=torch.float64) tensor(2.5270, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1176, dtype=torch.float64) delta_t tensor(-0.1219, dtype=torch.float64)
4 gae_duplicate tensor(-0.2823, dtype=torch.float64) tensor(2.4836, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2900, dtype=torch.float64) delta_t tensor(-0.0626, dtype=torch.float64)
3 gae_duplicate tensor(-0.1777, dtype=torch.float64) tensor(1.4357, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3993, dtype=torch.float64) delta_t tensor(-0.0760, dtype=torch.float64)
2 gae_duplicate tensor(-0.1554, dtype=torch.float64) tensor(1.5356, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1437.8094482421875
value loss:77.2107925415039
entropies:343.59515380859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.76475191116333 seconds
19 rew tensor(0.8250, dtype=torch.float64) delta_t tensor(0.0393, dtype=torch.float64)
19 gae_duplicate tensor(-0.1204, dtype=torch.float64) tensor(-0.8691, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8059, dtype=torch.float64) delta_t tensor(0.1310, dtype=torch.float64)
18 gae_duplicate tensor(0.0045, dtype=torch.float64) tensor(-2.3521, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7405, dtype=torch.float64) delta_t tensor(0.1396, dtype=torch.float64)
17 gae_duplicate tensor(0.0608, dtype=torch.float64) tensor(-3.0936, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5493, dtype=torch.float64) delta_t tensor(-0.0737, dtype=torch.float64)
16 gae_duplicate tensor(-0.9953, dtype=torch.float64) tensor(1.3529, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6460, dtype=torch.float64) delta_t tensor(0.1507, dtype=torch.float64)
15 gae_duplicate tensor(0.0204, dtype=torch.float64) tensor(-2.9043, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6537, dtype=torch.float64) delta_t tensor(0.1659, dtype=torch.float64)
14 gae_duplicate tensor(0.0886, dtype=torch.float64) tensor(-3.4407, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5807, dtype=torch.float64) delta_t tensor(0.2248, dtype=torch.float64)
13 gae_duplicate tensor(0.0645, dtype=torch.float64) tensor(-5.1425, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6338, dtype=torch.float64) delta_t tensor(0.2220, dtype=torch.float64)
12 gae_duplicate tensor(0.1638, dtype=torch.float64) tensor(-4.6199, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3300, dtype=torch.float64) delta_t tensor(0.3186, dtype=torch.float64)
11 gae_duplicate tensor(-0.5702, dtype=torch.float64) tensor(-6.1050, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3076, dtype=torch.float64) delta_t tensor(-0.3845, dtype=torch.float64)
10 gae_duplicate tensor(-1.8964, dtype=torch.float64) tensor(5.1011, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.9731, dtype=torch.float64) delta_t tensor(-1.8443, dtype=torch.float64)
9 gae_duplicate tensor(-3.8104, dtype=torch.float64) tensor(31.9171, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1305, dtype=torch.float64) delta_t tensor(0.6435, dtype=torch.float64)
8 gae_duplicate tensor(-0.4751, dtype=torch.float64) tensor(-9.4884, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2588, dtype=torch.float64) delta_t tensor(-0.3622, dtype=torch.float64)
7 gae_duplicate tensor(-2.8498, dtype=torch.float64) tensor(4.1777, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3006, dtype=torch.float64) delta_t tensor(-0.1825, dtype=torch.float64)
6 gae_duplicate tensor(-1.9994, dtype=torch.float64) tensor(4.4156, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6521, dtype=torch.float64) delta_t tensor(-0.3772, dtype=torch.float64)
5 gae_duplicate tensor(-2.5914, dtype=torch.float64) tensor(7.5979, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3973, dtype=torch.float64) delta_t tensor(0.0498, dtype=torch.float64)
4 gae_duplicate tensor(-0.2361, dtype=torch.float64) tensor(-0.3919, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2709, dtype=torch.float64) delta_t tensor(-0.0425, dtype=torch.float64)
3 gae_duplicate tensor(-0.1833, dtype=torch.float64) tensor(1.0061, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0589, dtype=torch.float64) delta_t tensor(0.0777, dtype=torch.float64)
2 gae_duplicate tensor(-0.1322, dtype=torch.float64) tensor(-1.4176, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-942.84619140625
value loss:114.02534484863281
entropies:343.4176330566406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7445387840271 seconds
19 rew tensor(0.8726, dtype=torch.float64) delta_t tensor(0.0909, dtype=torch.float64)
19 gae_duplicate tensor(0.0515, dtype=torch.float64) tensor(-1.5800, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5438, dtype=torch.float64) delta_t tensor(-0.0754, dtype=torch.float64)
18 gae_duplicate tensor(-0.9970, dtype=torch.float64) tensor(1.2403, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7597, dtype=torch.float64) delta_t tensor(0.1550, dtype=torch.float64)
17 gae_duplicate tensor(0.0242, dtype=torch.float64) tensor(-3.0086, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6547, dtype=torch.float64) delta_t tensor(0.1581, dtype=torch.float64)
16 gae_duplicate tensor(0.1007, dtype=torch.float64) tensor(-3.3496, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6266, dtype=torch.float64) delta_t tensor(0.1879, dtype=torch.float64)
15 gae_duplicate tensor(0.0918, dtype=torch.float64) tensor(-3.9183, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0237, dtype=torch.float64) delta_t tensor(-0.3532, dtype=torch.float64)
14 gae_duplicate tensor(-0.9349, dtype=torch.float64) tensor(6.7005, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5790, dtype=torch.float64) delta_t tensor(0.2662, dtype=torch.float64)
13 gae_duplicate tensor(0.1151, dtype=torch.float64) tensor(-4.4933, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4321, dtype=torch.float64) delta_t tensor(0.1050, dtype=torch.float64)
12 gae_duplicate tensor(-0.8047, dtype=torch.float64) tensor(-2.4008, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1052, dtype=torch.float64) delta_t tensor(0.1844, dtype=torch.float64)
11 gae_duplicate tensor(-1.1872, dtype=torch.float64) tensor(-3.0691, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3338, dtype=torch.float64) delta_t tensor(0.5032, dtype=torch.float64)
10 gae_duplicate tensor(-0.6258, dtype=torch.float64) tensor(-11.8782, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.8496, dtype=torch.float64) delta_t tensor(-0.6632, dtype=torch.float64)
9 gae_duplicate tensor(-1.4758, dtype=torch.float64) tensor(12.2744, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6695, dtype=torch.float64) delta_t tensor(-0.7352, dtype=torch.float64)
8 gae_duplicate tensor(-1.6263, dtype=torch.float64) tensor(14.8976, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0399, dtype=torch.float64) delta_t tensor(0.7350, dtype=torch.float64)
7 gae_duplicate tensor(-1.2389, dtype=torch.float64) tensor(-14.1274, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1212, dtype=torch.float64) delta_t tensor(0.5559, dtype=torch.float64)
6 gae_duplicate tensor(-0.4847, dtype=torch.float64) tensor(-11.4462, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0924, dtype=torch.float64) delta_t tensor(0.0926, dtype=torch.float64)
5 gae_duplicate tensor(-0.1640, dtype=torch.float64) tensor(-2.4444, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2410, dtype=torch.float64) delta_t tensor(0.0760, dtype=torch.float64)
4 gae_duplicate tensor(-0.1429, dtype=torch.float64) tensor(-1.8637, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1477, dtype=torch.float64) delta_t tensor(0.1100, dtype=torch.float64)
3 gae_duplicate tensor(0.0166, dtype=torch.float64) tensor(-2.1741, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3219, dtype=torch.float64) delta_t tensor(0.0622, dtype=torch.float64)
2 gae_duplicate tensor(-0.0822, dtype=torch.float64) tensor(-1.4896, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1642.259521484375
value loss:59.93986129760742
entropies:343.6658630371094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.841186761856079 seconds
19 rew tensor(0.8361, dtype=torch.float64) delta_t tensor(0.0600, dtype=torch.float64)
19 gae_duplicate tensor(-0.0156, dtype=torch.float64) tensor(-1.3785, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8078, dtype=torch.float64) delta_t tensor(0.1437, dtype=torch.float64)
18 gae_duplicate tensor(0.0737, dtype=torch.float64) tensor(-2.8017, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7606, dtype=torch.float64) delta_t tensor(0.1841, dtype=torch.float64)
17 gae_duplicate tensor(0.1148, dtype=torch.float64) tensor(-3.5656, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7015, dtype=torch.float64) delta_t tensor(0.1508, dtype=torch.float64)
16 gae_duplicate tensor(0.0893, dtype=torch.float64) tensor(-3.5444, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5709, dtype=torch.float64) delta_t tensor(0.1462, dtype=torch.float64)
15 gae_duplicate tensor(0.0002, dtype=torch.float64) tensor(-3.0265, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1924, dtype=torch.float64) delta_t tensor(-0.1173, dtype=torch.float64)
14 gae_duplicate tensor(-0.8425, dtype=torch.float64) tensor(2.0488, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3853, dtype=torch.float64) delta_t tensor(0.0500, dtype=torch.float64)
13 gae_duplicate tensor(-1.0398, dtype=torch.float64) tensor(-0.1663, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5293, dtype=torch.float64) delta_t tensor(0.3142, dtype=torch.float64)
12 gae_duplicate tensor(0.1223, dtype=torch.float64) tensor(-6.4922, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6626, dtype=torch.float64) delta_t tensor(-0.5379, dtype=torch.float64)
11 gae_duplicate tensor(-1.3180, dtype=torch.float64) tensor(8.8301, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1713, dtype=torch.float64) delta_t tensor(-0.0048, dtype=torch.float64)
10 gae_duplicate tensor(-0.6985, dtype=torch.float64) tensor(2.3605, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8568, dtype=torch.float64) delta_t tensor(0.0968, dtype=torch.float64)
9 gae_duplicate tensor(-1.3684, dtype=torch.float64) tensor(-2.3040, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1945, dtype=torch.float64) delta_t tensor(-0.3644, dtype=torch.float64)
8 gae_duplicate tensor(-1.6368, dtype=torch.float64) tensor(7.3319, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4631, dtype=torch.float64) delta_t tensor(0.3110, dtype=torch.float64)
7 gae_duplicate tensor(-1.5147, dtype=torch.float64) tensor(-6.0705, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5689, dtype=torch.float64) delta_t tensor(-0.2421, dtype=torch.float64)
6 gae_duplicate tensor(-1.9668, dtype=torch.float64) tensor(3.7920, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0850, dtype=torch.float64) delta_t tensor(0.1298, dtype=torch.float64)
5 gae_duplicate tensor(-0.2462, dtype=torch.float64) tensor(-2.2734, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1086, dtype=torch.float64) delta_t tensor(-0.0027, dtype=torch.float64)
4 gae_duplicate tensor(-0.1267, dtype=torch.float64) tensor(-0.0366, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2287, dtype=torch.float64) delta_t tensor(0.0730, dtype=torch.float64)
3 gae_duplicate tensor(-0.0108, dtype=torch.float64) tensor(-1.5223, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3453, dtype=torch.float64) delta_t tensor(0.0525, dtype=torch.float64)
2 gae_duplicate tensor(-0.0706, dtype=torch.float64) tensor(-1.4544, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:461.8812255859375
value loss:57.48152542114258
entropies:343.9325866699219
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3918.7896)
ToM Target loss= tensor(3615.2947)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.008139610290527 seconds
19 rew tensor(0.8633, dtype=torch.float64) delta_t tensor(0.0852, dtype=torch.float64)
19 gae_duplicate tensor(0.0095, dtype=torch.float64) tensor(-1.6962, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(0.1566, dtype=torch.float64)
18 gae_duplicate tensor(0.0804, dtype=torch.float64) tensor(-3.0579, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.1779, dtype=torch.float64)
17 gae_duplicate tensor(0.1145, dtype=torch.float64) tensor(-3.6608, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7870, dtype=torch.float64) delta_t tensor(0.2085, dtype=torch.float64)
16 gae_duplicate tensor(0.1402, dtype=torch.float64) tensor(-4.3853, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6816, dtype=torch.float64) delta_t tensor(0.2290, dtype=torch.float64)
15 gae_duplicate tensor(0.0910, dtype=torch.float64) tensor(-4.4893, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4691, dtype=torch.float64) delta_t tensor(0.1076, dtype=torch.float64)
14 gae_duplicate tensor(-0.8633, dtype=torch.float64) tensor(-2.4796, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4163, dtype=torch.float64) delta_t tensor(0.1174, dtype=torch.float64)
13 gae_duplicate tensor(-0.7802, dtype=torch.float64) tensor(-2.8917, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6081, dtype=torch.float64) delta_t tensor(0.3689, dtype=torch.float64)
12 gae_duplicate tensor(0.3298, dtype=torch.float64) tensor(-6.4887, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3126, dtype=torch.float64) delta_t tensor(-0.2953, dtype=torch.float64)
11 gae_duplicate tensor(-1.9495, dtype=torch.float64) tensor(4.6407, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0869, dtype=torch.float64) delta_t tensor(0.1314, dtype=torch.float64)
10 gae_duplicate tensor(-1.7150, dtype=torch.float64) tensor(-3.2671, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.2989, dtype=torch.float64) delta_t tensor(-1.1806, dtype=torch.float64)
9 gae_duplicate tensor(-3.7760, dtype=torch.float64) tensor(20.1428, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9980, dtype=torch.float64) delta_t tensor(-0.0095, dtype=torch.float64)
8 gae_duplicate tensor(-2.5094, dtype=torch.float64) tensor(3.0367, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2387, dtype=torch.float64) delta_t tensor(0.3365, dtype=torch.float64)
7 gae_duplicate tensor(-0.7026, dtype=torch.float64) tensor(-4.3919, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1824, dtype=torch.float64) delta_t tensor(0.3998, dtype=torch.float64)
6 gae_duplicate tensor(0.1942, dtype=torch.float64) tensor(-8.0077, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2016, dtype=torch.float64) delta_t tensor(-0.1396, dtype=torch.float64)
5 gae_duplicate tensor(-0.9597, dtype=torch.float64) tensor(3.1529, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0967, dtype=torch.float64) delta_t tensor(0.0990, dtype=torch.float64)
4 gae_duplicate tensor(-0.0497, dtype=torch.float64) tensor(-2.1318, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3298, dtype=torch.float64) delta_t tensor(0.1294, dtype=torch.float64)
3 gae_duplicate tensor(-0.0687, dtype=torch.float64) tensor(-2.6284, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4371, dtype=torch.float64) delta_t tensor(0.0526, dtype=torch.float64)
2 gae_duplicate tensor(-0.0343, dtype=torch.float64) tensor(-1.1782, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:975.3048095703125
value loss:94.8892593383789
entropies:344.1127624511719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.722238063812256 seconds
19 rew tensor(0.8637, dtype=torch.float64) delta_t tensor(0.0312, dtype=torch.float64)
19 gae_duplicate tensor(-0.0304, dtype=torch.float64) tensor(-0.5653, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8440, dtype=torch.float64) delta_t tensor(0.1186, dtype=torch.float64)
18 gae_duplicate tensor(0.0172, dtype=torch.float64) tensor(-2.0548, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8347, dtype=torch.float64) delta_t tensor(0.1801, dtype=torch.float64)
17 gae_duplicate tensor(0.0211, dtype=torch.float64) tensor(-3.5486, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7588, dtype=torch.float64) delta_t tensor(0.1916, dtype=torch.float64)
16 gae_duplicate tensor(0.0848, dtype=torch.float64) tensor(-3.7632, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4343, dtype=torch.float64) delta_t tensor(0.0018, dtype=torch.float64)
15 gae_duplicate tensor(-0.8628, dtype=torch.float64) tensor(-0.2045, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6163, dtype=torch.float64) delta_t tensor(0.2905, dtype=torch.float64)
14 gae_duplicate tensor(0.1664, dtype=torch.float64) tensor(-5.5942, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4781, dtype=torch.float64) delta_t tensor(0.0886, dtype=torch.float64)
13 gae_duplicate tensor(-0.9651, dtype=torch.float64) tensor(-0.9696, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5220, dtype=torch.float64) delta_t tensor(0.3134, dtype=torch.float64)
12 gae_duplicate tensor(0.1848, dtype=torch.float64) tensor(-6.0036, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4905, dtype=torch.float64) delta_t tensor(-0.5554, dtype=torch.float64)
11 gae_duplicate tensor(-1.8374, dtype=torch.float64) tensor(12.6079, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3989, dtype=torch.float64) delta_t tensor(0.4178, dtype=torch.float64)
10 gae_duplicate tensor(0.1362, dtype=torch.float64) tensor(-6.8654, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5752, dtype=torch.float64) delta_t tensor(-0.5529, dtype=torch.float64)
9 gae_duplicate tensor(-2.4702, dtype=torch.float64) tensor(8.8306, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6547, dtype=torch.float64) delta_t tensor(-0.0656, dtype=torch.float64)
8 gae_duplicate tensor(-2.7261, dtype=torch.float64) tensor(1.4343, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3656, dtype=torch.float64) delta_t tensor(0.5960, dtype=torch.float64)
7 gae_duplicate tensor(-0.7971, dtype=torch.float64) tensor(-14.1986, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0727, dtype=torch.float64) delta_t tensor(0.6959, dtype=torch.float64)
6 gae_duplicate tensor(-0.3181, dtype=torch.float64) tensor(-15.0973, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2296, dtype=torch.float64) delta_t tensor(-0.0844, dtype=torch.float64)
5 gae_duplicate tensor(-0.8863, dtype=torch.float64) tensor(-0.1284, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1567, dtype=torch.float64) delta_t tensor(0.2000, dtype=torch.float64)
4 gae_duplicate tensor(-0.0314, dtype=torch.float64) tensor(-3.5868, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2277, dtype=torch.float64) delta_t tensor(0.1109, dtype=torch.float64)
3 gae_duplicate tensor(-0.0123, dtype=torch.float64) tensor(-2.5421, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3165, dtype=torch.float64) delta_t tensor(0.0810, dtype=torch.float64)
2 gae_duplicate tensor(-0.0439, dtype=torch.float64) tensor(-1.7335, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2282.132080078125
value loss:69.0473861694336
entropies:344.25830078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.817903757095337 seconds
19 rew tensor(0.8821, dtype=torch.float64) delta_t tensor(-0.0810, dtype=torch.float64)
19 gae_duplicate tensor(-0.1247, dtype=torch.float64) tensor(1.3546, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7591, dtype=torch.float64) delta_t tensor(-0.0519, dtype=torch.float64)
18 gae_duplicate tensor(-0.1206, dtype=torch.float64) tensor(1.0959, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7500, dtype=torch.float64) delta_t tensor(0.0237, dtype=torch.float64)
17 gae_duplicate tensor(-0.0837, dtype=torch.float64) tensor(-0.2712, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7309, dtype=torch.float64) delta_t tensor(-0.0131, dtype=torch.float64)
16 gae_duplicate tensor(-0.0808, dtype=torch.float64) tensor(-0.0002, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4362, dtype=torch.float64) delta_t tensor(-0.0556, dtype=torch.float64)
15 gae_duplicate tensor(-1.0017, dtype=torch.float64) tensor(0.7184, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3012, dtype=torch.float64) delta_t tensor(-0.2944, dtype=torch.float64)
14 gae_duplicate tensor(-1.0685, dtype=torch.float64) tensor(5.7896, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4841, dtype=torch.float64) delta_t tensor(0.1418, dtype=torch.float64)
13 gae_duplicate tensor(-0.0211, dtype=torch.float64) tensor(-1.9170, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7113, dtype=torch.float64) delta_t tensor(0.1482, dtype=torch.float64)
12 gae_duplicate tensor(0.0576, dtype=torch.float64) tensor(-3.0622, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8117, dtype=torch.float64) delta_t tensor(-0.7079, dtype=torch.float64)
11 gae_duplicate tensor(-1.8935, dtype=torch.float64) tensor(12.6761, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4790, dtype=torch.float64) delta_t tensor(0.1246, dtype=torch.float64)
10 gae_duplicate tensor(-0.6409, dtype=torch.float64) tensor(-1.0386, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.2260, dtype=torch.float64) delta_t tensor(-0.9843, dtype=torch.float64)
9 gae_duplicate tensor(-2.5341, dtype=torch.float64) tensor(16.7234, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3255, dtype=torch.float64) delta_t tensor(-0.7180, dtype=torch.float64)
8 gae_duplicate tensor(-1.7369, dtype=torch.float64) tensor(14.0143, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4109, dtype=torch.float64) delta_t tensor(-0.3558, dtype=torch.float64)
7 gae_duplicate tensor(-1.9782, dtype=torch.float64) tensor(8.5214, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5495, dtype=torch.float64) delta_t tensor(0.6172, dtype=torch.float64)
6 gae_duplicate tensor(-0.0821, dtype=torch.float64) tensor(-10.6497, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2094, dtype=torch.float64) delta_t tensor(0.2007, dtype=torch.float64)
5 gae_duplicate tensor(-0.1729, dtype=torch.float64) tensor(-4.8033, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5967, dtype=torch.float64) delta_t tensor(0.0944, dtype=torch.float64)
4 gae_duplicate tensor(-0.0704, dtype=torch.float64) tensor(-2.5226, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1629, dtype=torch.float64) delta_t tensor(0.1515, dtype=torch.float64)
3 gae_duplicate tensor(-0.0476, dtype=torch.float64) tensor(-3.1982, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1373, dtype=torch.float64) delta_t tensor(0.0697, dtype=torch.float64)
2 gae_duplicate tensor(0.0353, dtype=torch.float64) tensor(-1.7990, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1801.197021484375
value loss:67.68065643310547
entropies:344.7679138183594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.733433961868286 seconds
19 rew tensor(0.8530, dtype=torch.float64) delta_t tensor(-0.1952, dtype=torch.float64)
19 gae_duplicate tensor(-0.2726, dtype=torch.float64) tensor(4.0676, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(-0.0714, dtype=torch.float64)
18 gae_duplicate tensor(-0.1751, dtype=torch.float64) tensor(1.7926, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8343, dtype=torch.float64) delta_t tensor(-0.0422, dtype=torch.float64)
17 gae_duplicate tensor(-0.1121, dtype=torch.float64) tensor(0.8981, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7305, dtype=torch.float64) delta_t tensor(-0.0581, dtype=torch.float64)
16 gae_duplicate tensor(-0.1150, dtype=torch.float64) tensor(1.1652, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6536, dtype=torch.float64) delta_t tensor(-0.0622, dtype=torch.float64)
15 gae_duplicate tensor(-0.2324, dtype=torch.float64) tensor(1.3490, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5597, dtype=torch.float64) delta_t tensor(0.0644, dtype=torch.float64)
14 gae_duplicate tensor(-0.1266, dtype=torch.float64) tensor(-1.1064, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6558, dtype=torch.float64) delta_t tensor(0.0473, dtype=torch.float64)
13 gae_duplicate tensor(-0.1495, dtype=torch.float64) tensor(-1.4355, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5302, dtype=torch.float64) delta_t tensor(0.0715, dtype=torch.float64)
12 gae_duplicate tensor(-0.0125, dtype=torch.float64) tensor(-1.6255, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4587, dtype=torch.float64) delta_t tensor(-0.6019, dtype=torch.float64)
11 gae_duplicate tensor(-1.1363, dtype=torch.float64) tensor(11.3223, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4180, dtype=torch.float64) delta_t tensor(0.2248, dtype=torch.float64)
10 gae_duplicate tensor(0.0331, dtype=torch.float64) tensor(-3.1448, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.6026, dtype=torch.float64) delta_t tensor(-1.4893, dtype=torch.float64)
9 gae_duplicate tensor(-3.5149, dtype=torch.float64) tensor(30.5600, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.0971, dtype=torch.float64) delta_t tensor(-1.2230, dtype=torch.float64)
8 gae_duplicate tensor(-2.9124, dtype=torch.float64) tensor(26.0339, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0144, dtype=torch.float64) delta_t tensor(-0.3422, dtype=torch.float64)
7 gae_duplicate tensor(-1.3728, dtype=torch.float64) tensor(10.1387, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4776, dtype=torch.float64) delta_t tensor(0.0070, dtype=torch.float64)
6 gae_duplicate tensor(-2.9748, dtype=torch.float64) tensor(-0.2079, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1167, dtype=torch.float64) delta_t tensor(0.0397, dtype=torch.float64)
5 gae_duplicate tensor(-0.2580, dtype=torch.float64) tensor(-0.9050, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3591, dtype=torch.float64) delta_t tensor(-0.0396, dtype=torch.float64)
4 gae_duplicate tensor(-0.1719, dtype=torch.float64) tensor(0.7136, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1239, dtype=torch.float64) delta_t tensor(-0.0236, dtype=torch.float64)
3 gae_duplicate tensor(-0.1288, dtype=torch.float64) tensor(0.4640, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2403, dtype=torch.float64) delta_t tensor(-0.0642, dtype=torch.float64)
2 gae_duplicate tensor(-0.4790, dtype=torch.float64) tensor(1.3445, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4490.17529296875
value loss:95.29912567138672
entropies:345.3771667480469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.775935888290405 seconds
19 rew tensor(0.8445, dtype=torch.float64) delta_t tensor(-0.1937, dtype=torch.float64)
19 gae_duplicate tensor(-0.2923, dtype=torch.float64) tensor(3.7038, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(-0.0861, dtype=torch.float64)
18 gae_duplicate tensor(-0.1856, dtype=torch.float64) tensor(2.2417, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7676, dtype=torch.float64) delta_t tensor(-0.0708, dtype=torch.float64)
17 gae_duplicate tensor(-0.1525, dtype=torch.float64) tensor(1.6631, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6734, dtype=torch.float64) delta_t tensor(-0.0750, dtype=torch.float64)
16 gae_duplicate tensor(-0.1273, dtype=torch.float64) tensor(1.7477, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4478, dtype=torch.float64) delta_t tensor(-0.2599, dtype=torch.float64)
15 gae_duplicate tensor(-1.1049, dtype=torch.float64) tensor(5.0010, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3809, dtype=torch.float64) delta_t tensor(-0.0835, dtype=torch.float64)
14 gae_duplicate tensor(-0.8604, dtype=torch.float64) tensor(2.4531, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6150, dtype=torch.float64) delta_t tensor(0.0372, dtype=torch.float64)
13 gae_duplicate tensor(-0.1289, dtype=torch.float64) tensor(-0.3841, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3920, dtype=torch.float64) delta_t tensor(0.1693, dtype=torch.float64)
12 gae_duplicate tensor(0.0408, dtype=torch.float64) tensor(-3.2286, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.9545, dtype=torch.float64) delta_t tensor(-0.7353, dtype=torch.float64)
11 gae_duplicate tensor(-2.0033, dtype=torch.float64) tensor(12.5966, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0844, dtype=torch.float64) delta_t tensor(0.3924, dtype=torch.float64)
10 gae_duplicate tensor(-0.9286, dtype=torch.float64) tensor(-5.2087, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4079, dtype=torch.float64) delta_t tensor(-0.5985, dtype=torch.float64)
9 gae_duplicate tensor(-2.4814, dtype=torch.float64) tensor(9.4322, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3098, dtype=torch.float64) delta_t tensor(-0.4670, dtype=torch.float64)
8 gae_duplicate tensor(-1.9142, dtype=torch.float64) tensor(8.4913, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2514, dtype=torch.float64) delta_t tensor(0.4506, dtype=torch.float64)
7 gae_duplicate tensor(-0.8590, dtype=torch.float64) tensor(-7.3741, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0686, dtype=torch.float64) delta_t tensor(0.6799, dtype=torch.float64)
6 gae_duplicate tensor(0.1351, dtype=torch.float64) tensor(-14.0702, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0869, dtype=torch.float64) delta_t tensor(0.0441, dtype=torch.float64)
5 gae_duplicate tensor(-0.3235, dtype=torch.float64) tensor(-2.4442, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0495, dtype=torch.float64) delta_t tensor(0.1832, dtype=torch.float64)
4 gae_duplicate tensor(-0.1155, dtype=torch.float64) tensor(-3.4034, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2698, dtype=torch.float64) delta_t tensor(0.0637, dtype=torch.float64)
3 gae_duplicate tensor(-0.0139, dtype=torch.float64) tensor(-1.6050, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3874, dtype=torch.float64) delta_t tensor(-0.0018, dtype=torch.float64)
2 gae_duplicate tensor(-0.1899, dtype=torch.float64) tensor(-0.0709, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-608.55224609375
value loss:69.55061340332031
entropies:345.645263671875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3967.6741)
ToM Target loss= tensor(3627.3826)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.071205139160156 seconds
19 rew tensor(0.8339, dtype=torch.float64) delta_t tensor(-0.1654, dtype=torch.float64)
19 gae_duplicate tensor(-0.2773, dtype=torch.float64) tensor(3.4031, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5792, dtype=torch.float64) delta_t tensor(-0.2124, dtype=torch.float64)
18 gae_duplicate tensor(-1.1552, dtype=torch.float64) tensor(5.3304, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6087, dtype=torch.float64) delta_t tensor(-0.1907, dtype=torch.float64)
17 gae_duplicate tensor(-1.2013, dtype=torch.float64) tensor(4.4700, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7015, dtype=torch.float64) delta_t tensor(0.0379, dtype=torch.float64)
16 gae_duplicate tensor(-0.1175, dtype=torch.float64) tensor(-0.4545, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6840, dtype=torch.float64) delta_t tensor(0.0261, dtype=torch.float64)
15 gae_duplicate tensor(-0.0484, dtype=torch.float64) tensor(-0.4587, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1701, dtype=torch.float64) delta_t tensor(-0.2353, dtype=torch.float64)
14 gae_duplicate tensor(-1.0368, dtype=torch.float64) tensor(4.3204, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6174, dtype=torch.float64) delta_t tensor(0.2071, dtype=torch.float64)
13 gae_duplicate tensor(-0.0310, dtype=torch.float64) tensor(-3.9190, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2851, dtype=torch.float64) delta_t tensor(0.0597, dtype=torch.float64)
12 gae_duplicate tensor(-0.7676, dtype=torch.float64) tensor(-1.4191, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0168, dtype=torch.float64) delta_t tensor(0.3143, dtype=torch.float64)
11 gae_duplicate tensor(-1.8429, dtype=torch.float64) tensor(-6.4678, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3848, dtype=torch.float64) delta_t tensor(0.2259, dtype=torch.float64)
10 gae_duplicate tensor(-1.3085, dtype=torch.float64) tensor(-5.4670, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6227, dtype=torch.float64) delta_t tensor(-0.4343, dtype=torch.float64)
9 gae_duplicate tensor(-2.3832, dtype=torch.float64) tensor(8.2452, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.5674, dtype=torch.float64) delta_t tensor(-0.4955, dtype=torch.float64)
8 gae_duplicate tensor(-3.1609, dtype=torch.float64) tensor(10.9730, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1970, dtype=torch.float64) delta_t tensor(0.9179, dtype=torch.float64)
7 gae_duplicate tensor(-0.6570, dtype=torch.float64) tensor(-14.6193, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0763, dtype=torch.float64) delta_t tensor(0.7905, dtype=torch.float64)
6 gae_duplicate tensor(-0.4370, dtype=torch.float64) tensor(-15.0876, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0869, dtype=torch.float64) delta_t tensor(0.1025, dtype=torch.float64)
5 gae_duplicate tensor(-0.1790, dtype=torch.float64) tensor(-4.0207, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3317, dtype=torch.float64) delta_t tensor(0.0815, dtype=torch.float64)
4 gae_duplicate tensor(-0.0382, dtype=torch.float64) tensor(-2.2624, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0464, dtype=torch.float64) delta_t tensor(0.0837, dtype=torch.float64)
3 gae_duplicate tensor(-0.0314, dtype=torch.float64) tensor(-1.8202, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2682, dtype=torch.float64) delta_t tensor(0.0651, dtype=torch.float64)
2 gae_duplicate tensor(0.0146, dtype=torch.float64) tensor(-1.5099, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1027.84619140625
value loss:91.40260314941406
entropies:345.9927673339844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.5334792137146 seconds
19 rew tensor(0.8535, dtype=torch.float64) delta_t tensor(-0.1430, dtype=torch.float64)
19 gae_duplicate tensor(-0.2099, dtype=torch.float64) tensor(2.4435, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8067, dtype=torch.float64) delta_t tensor(-0.0434, dtype=torch.float64)
18 gae_duplicate tensor(-0.1627, dtype=torch.float64) tensor(1.2402, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7881, dtype=torch.float64) delta_t tensor(-0.0048, dtype=torch.float64)
17 gae_duplicate tensor(-0.1150, dtype=torch.float64) tensor(0.2828, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7313, dtype=torch.float64) delta_t tensor(0.0323, dtype=torch.float64)
16 gae_duplicate tensor(-0.0502, dtype=torch.float64) tensor(-0.5251, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6177, dtype=torch.float64) delta_t tensor(0.0025, dtype=torch.float64)
15 gae_duplicate tensor(-0.1105, dtype=torch.float64) tensor(-0.1264, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1656, dtype=torch.float64) delta_t tensor(-0.2296, dtype=torch.float64)
14 gae_duplicate tensor(-1.0470, dtype=torch.float64) tensor(4.5969, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5901, dtype=torch.float64) delta_t tensor(0.1860, dtype=torch.float64)
13 gae_duplicate tensor(-0.0088, dtype=torch.float64) tensor(-3.4531, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5114, dtype=torch.float64) delta_t tensor(0.1704, dtype=torch.float64)
12 gae_duplicate tensor(0.1211, dtype=torch.float64) tensor(-3.5846, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5163, dtype=torch.float64) delta_t tensor(-0.3474, dtype=torch.float64)
11 gae_duplicate tensor(-1.6605, dtype=torch.float64) tensor(7.0059, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2223, dtype=torch.float64) delta_t tensor(0.3674, dtype=torch.float64)
10 gae_duplicate tensor(-0.6515, dtype=torch.float64) tensor(-5.4140, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5526, dtype=torch.float64) delta_t tensor(-0.2002, dtype=torch.float64)
9 gae_duplicate tensor(-2.4109, dtype=torch.float64) tensor(1.0808, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.5723, dtype=torch.float64) delta_t tensor(-0.4868, dtype=torch.float64)
8 gae_duplicate tensor(-2.6812, dtype=torch.float64) tensor(11.2565, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4658, dtype=torch.float64) delta_t tensor(0.6257, dtype=torch.float64)
7 gae_duplicate tensor(-1.0861, dtype=torch.float64) tensor(-10.4441, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1489, dtype=torch.float64) delta_t tensor(0.3978, dtype=torch.float64)
6 gae_duplicate tensor(-0.6142, dtype=torch.float64) tensor(-6.8204, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0214, dtype=torch.float64) delta_t tensor(0.2361, dtype=torch.float64)
5 gae_duplicate tensor(0.0851, dtype=torch.float64) tensor(-5.4188, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3420, dtype=torch.float64) delta_t tensor(0.1114, dtype=torch.float64)
4 gae_duplicate tensor(0.0034, dtype=torch.float64) tensor(-2.4930, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0097, dtype=torch.float64) delta_t tensor(0.1938, dtype=torch.float64)
3 gae_duplicate tensor(0.0568, dtype=torch.float64) tensor(-3.8027, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1628, dtype=torch.float64) delta_t tensor(0.0755, dtype=torch.float64)
2 gae_duplicate tensor(0.0294, dtype=torch.float64) tensor(-1.7406, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:766.0567016601562
value loss:70.55569458007812
entropies:346.0249938964844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.872028112411499 seconds
19 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(-0.0679, dtype=torch.float64)
19 gae_duplicate tensor(-0.1836, dtype=torch.float64) tensor(1.1663, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5712, dtype=torch.float64) delta_t tensor(-0.1464, dtype=torch.float64)
18 gae_duplicate tensor(-0.9456, dtype=torch.float64) tensor(3.3666, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7781, dtype=torch.float64) delta_t tensor(0.0764, dtype=torch.float64)
17 gae_duplicate tensor(-0.0200, dtype=torch.float64) tensor(-1.0668, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7112, dtype=torch.float64) delta_t tensor(0.1361, dtype=torch.float64)
16 gae_duplicate tensor(0.0200, dtype=torch.float64) tensor(-2.7980, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6169, dtype=torch.float64) delta_t tensor(0.1268, dtype=torch.float64)
15 gae_duplicate tensor(-0.0971, dtype=torch.float64) tensor(-2.5761, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2019, dtype=torch.float64) delta_t tensor(-0.1418, dtype=torch.float64)
14 gae_duplicate tensor(-0.7086, dtype=torch.float64) tensor(2.4445, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5220, dtype=torch.float64) delta_t tensor(0.5274, dtype=torch.float64)
13 gae_duplicate tensor(0.0712, dtype=torch.float64) tensor(-9.8851, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1877, dtype=torch.float64) delta_t tensor(-0.0319, dtype=torch.float64)
12 gae_duplicate tensor(-0.5983, dtype=torch.float64) tensor(-0.0945, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2691, dtype=torch.float64) delta_t tensor(0.1530, dtype=torch.float64)
11 gae_duplicate tensor(-3.0082, dtype=torch.float64) tensor(-0.6427, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6577, dtype=torch.float64) delta_t tensor(-0.1054, dtype=torch.float64)
10 gae_duplicate tensor(-2.0030, dtype=torch.float64) tensor(0.2879, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2991, dtype=torch.float64) delta_t tensor(0.6860, dtype=torch.float64)
9 gae_duplicate tensor(-0.5850, dtype=torch.float64) tensor(-13.4397, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1780, dtype=torch.float64) delta_t tensor(0.3832, dtype=torch.float64)
8 gae_duplicate tensor(-1.9299, dtype=torch.float64) tensor(-8.5355, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1042, dtype=torch.float64) delta_t tensor(-0.1515, dtype=torch.float64)
7 gae_duplicate tensor(-3.3005, dtype=torch.float64) tensor(0.5701, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1975, dtype=torch.float64) delta_t tensor(0.3060, dtype=torch.float64)
6 gae_duplicate tensor(-0.5039, dtype=torch.float64) tensor(-5.2360, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4078, dtype=torch.float64) delta_t tensor(0.1864, dtype=torch.float64)
5 gae_duplicate tensor(-0.2712, dtype=torch.float64) tensor(-4.1278, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3024, dtype=torch.float64) delta_t tensor(0.3037, dtype=torch.float64)
4 gae_duplicate tensor(0.0921, dtype=torch.float64) tensor(-6.7228, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2845, dtype=torch.float64) delta_t tensor(0.3383, dtype=torch.float64)
3 gae_duplicate tensor(0.1306, dtype=torch.float64) tensor(-7.8422, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0300, dtype=torch.float64) delta_t tensor(0.0919, dtype=torch.float64)
2 gae_duplicate tensor(-0.1175, dtype=torch.float64) tensor(-2.4168, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3014.263916015625
value loss:102.1500473022461
entropies:345.7886962890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.78101921081543 seconds
19 rew tensor(0.8731, dtype=torch.float64) delta_t tensor(-0.0842, dtype=torch.float64)
19 gae_duplicate tensor(-0.1361, dtype=torch.float64) tensor(1.7711, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5846, dtype=torch.float64) delta_t tensor(-0.1697, dtype=torch.float64)
18 gae_duplicate tensor(-1.1270, dtype=torch.float64) tensor(2.9554, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7966, dtype=torch.float64) delta_t tensor(0.0602, dtype=torch.float64)
17 gae_duplicate tensor(-0.0239, dtype=torch.float64) tensor(-0.7196, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6190, dtype=torch.float64) delta_t tensor(0.0432, dtype=torch.float64)
16 gae_duplicate tensor(-0.1014, dtype=torch.float64) tensor(-0.8994, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4909, dtype=torch.float64) delta_t tensor(-0.1305, dtype=torch.float64)
15 gae_duplicate tensor(-0.9558, dtype=torch.float64) tensor(2.9829, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3551, dtype=torch.float64) delta_t tensor(0.0116, dtype=torch.float64)
14 gae_duplicate tensor(-0.8678, dtype=torch.float64) tensor(0.1257, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4186, dtype=torch.float64) delta_t tensor(-0.0420, dtype=torch.float64)
13 gae_duplicate tensor(-1.1423, dtype=torch.float64) tensor(0.3487, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4692, dtype=torch.float64) delta_t tensor(0.2253, dtype=torch.float64)
12 gae_duplicate tensor(-0.0012, dtype=torch.float64) tensor(-4.6230, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1968, dtype=torch.float64) delta_t tensor(0.2997, dtype=torch.float64)
11 gae_duplicate tensor(-1.2091, dtype=torch.float64) tensor(-6.0144, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5404, dtype=torch.float64) delta_t tensor(-0.4660, dtype=torch.float64)
10 gae_duplicate tensor(-1.6942, dtype=torch.float64) tensor(7.8102, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8023, dtype=torch.float64) delta_t tensor(0.1483, dtype=torch.float64)
9 gae_duplicate tensor(-1.2094, dtype=torch.float64) tensor(-1.1951, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0564, dtype=torch.float64) delta_t tensor(-0.1444, dtype=torch.float64)
8 gae_duplicate tensor(-2.4265, dtype=torch.float64) tensor(1.5081, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1684, dtype=torch.float64) delta_t tensor(0.2736, dtype=torch.float64)
7 gae_duplicate tensor(-0.7384, dtype=torch.float64) tensor(-5.0158, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3132, dtype=torch.float64) delta_t tensor(0.1184, dtype=torch.float64)
6 gae_duplicate tensor(-0.9439, dtype=torch.float64) tensor(-2.6882, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1218, dtype=torch.float64) delta_t tensor(-0.0707, dtype=torch.float64)
5 gae_duplicate tensor(-0.4227, dtype=torch.float64) tensor(1.4035, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0429, dtype=torch.float64) delta_t tensor(0.0144, dtype=torch.float64)
4 gae_duplicate tensor(-0.0816, dtype=torch.float64) tensor(-0.3678, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1871, dtype=torch.float64) delta_t tensor(0.1290, dtype=torch.float64)
3 gae_duplicate tensor(-0.0614, dtype=torch.float64) tensor(-2.6623, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3126, dtype=torch.float64) delta_t tensor(-0.0222, dtype=torch.float64)
2 gae_duplicate tensor(-0.0910, dtype=torch.float64) tensor(0.1764, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:182.24493408203125
value loss:51.36504364013672
entropies:345.7232666015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7355570793151855 seconds
19 rew tensor(0.8643, dtype=torch.float64) delta_t tensor(-0.1414, dtype=torch.float64)
19 gae_duplicate tensor(-0.1622, dtype=torch.float64) tensor(2.4460, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8169, dtype=torch.float64) delta_t tensor(-0.0137, dtype=torch.float64)
18 gae_duplicate tensor(-0.1033, dtype=torch.float64) tensor(0.5614, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7611, dtype=torch.float64) delta_t tensor(-0.0239, dtype=torch.float64)
17 gae_duplicate tensor(-0.1440, dtype=torch.float64) tensor(0.4304, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6361, dtype=torch.float64) delta_t tensor(-0.0083, dtype=torch.float64)
16 gae_duplicate tensor(-0.0623, dtype=torch.float64) tensor(0.2612, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6928, dtype=torch.float64) delta_t tensor(-0.0040, dtype=torch.float64)
15 gae_duplicate tensor(-0.0390, dtype=torch.float64) tensor(0.0537, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5222, dtype=torch.float64) delta_t tensor(0.0571, dtype=torch.float64)
14 gae_duplicate tensor(-0.0636, dtype=torch.float64) tensor(-0.9591, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4046, dtype=torch.float64) delta_t tensor(-0.1179, dtype=torch.float64)
13 gae_duplicate tensor(-1.1816, dtype=torch.float64) tensor(1.5492, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4094, dtype=torch.float64) delta_t tensor(0.1996, dtype=torch.float64)
12 gae_duplicate tensor(0.0492, dtype=torch.float64) tensor(-3.5228, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4361, dtype=torch.float64) delta_t tensor(0.2995, dtype=torch.float64)
11 gae_duplicate tensor(-0.1314, dtype=torch.float64) tensor(-6.0291, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5487, dtype=torch.float64) delta_t tensor(-0.3718, dtype=torch.float64)
10 gae_duplicate tensor(-0.9641, dtype=torch.float64) tensor(7.8433, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0415, dtype=torch.float64) delta_t tensor(0.6058, dtype=torch.float64)
9 gae_duplicate tensor(-0.1435, dtype=torch.float64) tensor(-10.7028, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3686, dtype=torch.float64) delta_t tensor(0.0125, dtype=torch.float64)
8 gae_duplicate tensor(-2.4658, dtype=torch.float64) tensor(-2.3002, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4700, dtype=torch.float64) delta_t tensor(0.0061, dtype=torch.float64)
7 gae_duplicate tensor(-1.5985, dtype=torch.float64) tensor(1.5889, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5967, dtype=torch.float64) delta_t tensor(-0.0590, dtype=torch.float64)
6 gae_duplicate tensor(-1.1844, dtype=torch.float64) tensor(1.1830, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1421, dtype=torch.float64) delta_t tensor(-0.3665, dtype=torch.float64)
5 gae_duplicate tensor(-1.7481, dtype=torch.float64) tensor(6.2787, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0660, dtype=torch.float64) delta_t tensor(0.1148, dtype=torch.float64)
4 gae_duplicate tensor(-0.2375, dtype=torch.float64) tensor(-1.4923, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1198, dtype=torch.float64) delta_t tensor(0.1093, dtype=torch.float64)
3 gae_duplicate tensor(-0.0865, dtype=torch.float64) tensor(-2.1899, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2933, dtype=torch.float64) delta_t tensor(0.0114, dtype=torch.float64)
2 gae_duplicate tensor(-0.0971, dtype=torch.float64) tensor(-0.4614, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:201.5790557861328
value loss:44.46792984008789
entropies:345.7772216796875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3946.2842)
ToM Target loss= tensor(3647.6860)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.129914045333862 seconds
19 rew tensor(0.8439, dtype=torch.float64) delta_t tensor(-0.1347, dtype=torch.float64)
19 gae_duplicate tensor(-0.2443, dtype=torch.float64) tensor(2.4822, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6040, dtype=torch.float64) delta_t tensor(-0.2321, dtype=torch.float64)
18 gae_duplicate tensor(-1.2706, dtype=torch.float64) tensor(4.5749, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7505, dtype=torch.float64) delta_t tensor(-0.0028, dtype=torch.float64)
17 gae_duplicate tensor(-0.1057, dtype=torch.float64) tensor(0.3800, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5453, dtype=torch.float64) delta_t tensor(-0.1719, dtype=torch.float64)
16 gae_duplicate tensor(-1.0835, dtype=torch.float64) tensor(4.0390, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6179, dtype=torch.float64) delta_t tensor(0.0265, dtype=torch.float64)
15 gae_duplicate tensor(-0.1070, dtype=torch.float64) tensor(-0.1531, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4248, dtype=torch.float64) delta_t tensor(-0.0995, dtype=torch.float64)
14 gae_duplicate tensor(-1.0278, dtype=torch.float64) tensor(1.6878, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6462, dtype=torch.float64) delta_t tensor(0.1457, dtype=torch.float64)
13 gae_duplicate tensor(0.0195, dtype=torch.float64) tensor(-2.4159, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6272, dtype=torch.float64) delta_t tensor(0.1828, dtype=torch.float64)
12 gae_duplicate tensor(0.1391, dtype=torch.float64) tensor(-3.9605, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2238, dtype=torch.float64) delta_t tensor(0.2979, dtype=torch.float64)
11 gae_duplicate tensor(-0.6511, dtype=torch.float64) tensor(-6.8234, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1058, dtype=torch.float64) delta_t tensor(-0.1007, dtype=torch.float64)
10 gae_duplicate tensor(-0.5310, dtype=torch.float64) tensor(1.1708, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.8371, dtype=torch.float64) delta_t tensor(-2.3248, dtype=torch.float64)
9 gae_duplicate tensor(-4.7002, dtype=torch.float64) tensor(45.2842, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9687, dtype=torch.float64) delta_t tensor(-0.0705, dtype=torch.float64)
8 gae_duplicate tensor(-1.5925, dtype=torch.float64) tensor(5.7965, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7268, dtype=torch.float64) delta_t tensor(-0.1185, dtype=torch.float64)
7 gae_duplicate tensor(-1.3058, dtype=torch.float64) tensor(2.1539, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1369, dtype=torch.float64) delta_t tensor(0.4688, dtype=torch.float64)
6 gae_duplicate tensor(-0.9771, dtype=torch.float64) tensor(-8.3598, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3789, dtype=torch.float64) delta_t tensor(-0.7338, dtype=torch.float64)
5 gae_duplicate tensor(-2.1234, dtype=torch.float64) tensor(13.1045, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1992, dtype=torch.float64) delta_t tensor(0.0504, dtype=torch.float64)
4 gae_duplicate tensor(-0.3895, dtype=torch.float64) tensor(0.5074, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1430, dtype=torch.float64) delta_t tensor(-0.0804, dtype=torch.float64)
3 gae_duplicate tensor(-0.2032, dtype=torch.float64) tensor(1.4607, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3162, dtype=torch.float64) delta_t tensor(-0.0681, dtype=torch.float64)
2 gae_duplicate tensor(-0.1463, dtype=torch.float64) tensor(1.6381, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3471.94091796875
value loss:113.12588500976562
entropies:345.61065673828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.709743022918701 seconds
19 rew tensor(0.8544, dtype=torch.float64) delta_t tensor(-0.0373, dtype=torch.float64)
19 gae_duplicate tensor(-0.1355, dtype=torch.float64) tensor(0.7827, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7604, dtype=torch.float64) delta_t tensor(0.0276, dtype=torch.float64)
18 gae_duplicate tensor(-0.1515, dtype=torch.float64) tensor(-0.7625, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7314, dtype=torch.float64) delta_t tensor(0.0884, dtype=torch.float64)
17 gae_duplicate tensor(0.0420, dtype=torch.float64) tensor(-1.9230, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6923, dtype=torch.float64) delta_t tensor(0.0789, dtype=torch.float64)
16 gae_duplicate tensor(0.0249, dtype=torch.float64) tensor(-1.6499, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5608, dtype=torch.float64) delta_t tensor(0.1077, dtype=torch.float64)
15 gae_duplicate tensor(0.0187, dtype=torch.float64) tensor(-2.2725, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2116, dtype=torch.float64) delta_t tensor(-0.1907, dtype=torch.float64)
14 gae_duplicate tensor(-0.9608, dtype=torch.float64) tensor(3.3693, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5428, dtype=torch.float64) delta_t tensor(0.3173, dtype=torch.float64)
13 gae_duplicate tensor(0.0929, dtype=torch.float64) tensor(-5.4198, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4175, dtype=torch.float64) delta_t tensor(0.1338, dtype=torch.float64)
12 gae_duplicate tensor(-0.7454, dtype=torch.float64) tensor(-3.1889, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0051, dtype=torch.float64) delta_t tensor(0.3376, dtype=torch.float64)
11 gae_duplicate tensor(-0.4456, dtype=torch.float64) tensor(-6.4141, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0914, dtype=torch.float64) delta_t tensor(0.3828, dtype=torch.float64)
10 gae_duplicate tensor(-0.4167, dtype=torch.float64) tensor(-8.9695, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7623, dtype=torch.float64) delta_t tensor(-0.7635, dtype=torch.float64)
9 gae_duplicate tensor(-2.3338, dtype=torch.float64) tensor(12.6521, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.0509, dtype=torch.float64) delta_t tensor(-1.1033, dtype=torch.float64)
8 gae_duplicate tensor(-2.7928, dtype=torch.float64) tensor(20.7127, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1352, dtype=torch.float64) delta_t tensor(-0.0923, dtype=torch.float64)
7 gae_duplicate tensor(-2.8957, dtype=torch.float64) tensor(6.8961, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2458, dtype=torch.float64) delta_t tensor(0.4104, dtype=torch.float64)
6 gae_duplicate tensor(-2.2186, dtype=torch.float64) tensor(-5.4977, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0385, dtype=torch.float64) delta_t tensor(0.0899, dtype=torch.float64)
5 gae_duplicate tensor(-0.1993, dtype=torch.float64) tensor(-2.9082, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3468, dtype=torch.float64) delta_t tensor(0.0335, dtype=torch.float64)
4 gae_duplicate tensor(-0.1254, dtype=torch.float64) tensor(-0.7230, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0675, dtype=torch.float64) delta_t tensor(0.0809, dtype=torch.float64)
3 gae_duplicate tensor(-0.0496, dtype=torch.float64) tensor(-1.6813, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2205, dtype=torch.float64) delta_t tensor(-0.0129, dtype=torch.float64)
2 gae_duplicate tensor(-0.0692, dtype=torch.float64) tensor(0.1426, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-263.1175842285156
value loss:96.97949981689453
entropies:345.5098571777344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.757009983062744 seconds
19 rew tensor(0.8442, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
19 gae_duplicate tensor(-0.0620, dtype=torch.float64) tensor(-0.9693, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7676, dtype=torch.float64) delta_t tensor(0.1189, dtype=torch.float64)
18 gae_duplicate tensor(0.0321, dtype=torch.float64) tensor(-2.2680, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7864, dtype=torch.float64) delta_t tensor(0.1766, dtype=torch.float64)
17 gae_duplicate tensor(0.0805, dtype=torch.float64) tensor(-3.0837, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7217, dtype=torch.float64) delta_t tensor(0.1667, dtype=torch.float64)
16 gae_duplicate tensor(0.1041, dtype=torch.float64) tensor(-3.4280, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6245, dtype=torch.float64) delta_t tensor(0.2083, dtype=torch.float64)
15 gae_duplicate tensor(0.0795, dtype=torch.float64) tensor(-4.4558, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4417, dtype=torch.float64) delta_t tensor(0.0903, dtype=torch.float64)
14 gae_duplicate tensor(-0.8618, dtype=torch.float64) tensor(-1.7406, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5962, dtype=torch.float64) delta_t tensor(0.3960, dtype=torch.float64)
13 gae_duplicate tensor(0.1134, dtype=torch.float64) tensor(-7.2596, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4143, dtype=torch.float64) delta_t tensor(0.1352, dtype=torch.float64)
12 gae_duplicate tensor(-0.8865, dtype=torch.float64) tensor(-2.8202, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3579, dtype=torch.float64) delta_t tensor(-0.0566, dtype=torch.float64)
11 gae_duplicate tensor(-0.3651, dtype=torch.float64) tensor(0.7939, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1783, dtype=torch.float64) delta_t tensor(0.3712, dtype=torch.float64)
10 gae_duplicate tensor(-1.2645, dtype=torch.float64) tensor(-8.0961, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.3113, dtype=torch.float64) delta_t tensor(-0.8112, dtype=torch.float64)
9 gae_duplicate tensor(-3.2686, dtype=torch.float64) tensor(15.1797, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.4121, dtype=torch.float64) delta_t tensor(-0.2289, dtype=torch.float64)
8 gae_duplicate tensor(-2.5105, dtype=torch.float64) tensor(4.8415, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4851, dtype=torch.float64) delta_t tensor(0.8169, dtype=torch.float64)
7 gae_duplicate tensor(-0.4150, dtype=torch.float64) tensor(-13.1742, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2042, dtype=torch.float64) delta_t tensor(0.9913, dtype=torch.float64)
6 gae_duplicate tensor(0.0426, dtype=torch.float64) tensor(-19.5917, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6958, dtype=torch.float64) delta_t tensor(-0.4782, dtype=torch.float64)
5 gae_duplicate tensor(-3.3918, dtype=torch.float64) tensor(5.9685, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1657, dtype=torch.float64) delta_t tensor(-0.1470, dtype=torch.float64)
4 gae_duplicate tensor(-1.4964, dtype=torch.float64) tensor(4.7535, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1496, dtype=torch.float64) delta_t tensor(0.0502, dtype=torch.float64)
3 gae_duplicate tensor(-0.0945, dtype=torch.float64) tensor(-0.5456, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2745, dtype=torch.float64) delta_t tensor(0.0146, dtype=torch.float64)
2 gae_duplicate tensor(-0.0342, dtype=torch.float64) tensor(-0.3484, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1863.953369140625
value loss:102.16854095458984
entropies:345.27593994140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.392926216125488 seconds
19 rew tensor(0.8357, dtype=torch.float64) delta_t tensor(0.0750, dtype=torch.float64)
19 gae_duplicate tensor(0.0051, dtype=torch.float64) tensor(-1.4455, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6112, dtype=torch.float64) delta_t tensor(-0.0182, dtype=torch.float64)
18 gae_duplicate tensor(-0.9028, dtype=torch.float64) tensor(0.8443, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7691, dtype=torch.float64) delta_t tensor(0.2061, dtype=torch.float64)
17 gae_duplicate tensor(0.1000, dtype=torch.float64) tensor(-3.5936, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4966, dtype=torch.float64) delta_t tensor(-0.0187, dtype=torch.float64)
16 gae_duplicate tensor(-0.9238, dtype=torch.float64) tensor(1.0101, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6362, dtype=torch.float64) delta_t tensor(0.2765, dtype=torch.float64)
15 gae_duplicate tensor(0.1280, dtype=torch.float64) tensor(-5.3332, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1488, dtype=torch.float64) delta_t tensor(-0.2874, dtype=torch.float64)
14 gae_duplicate tensor(-0.8341, dtype=torch.float64) tensor(4.5536, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4937, dtype=torch.float64) delta_t tensor(0.3585, dtype=torch.float64)
13 gae_duplicate tensor(0.2838, dtype=torch.float64) tensor(-6.5748, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7222, dtype=torch.float64) delta_t tensor(0.3946, dtype=torch.float64)
12 gae_duplicate tensor(0.2804, dtype=torch.float64) tensor(-8.4533, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2011, dtype=torch.float64) delta_t tensor(0.4801, dtype=torch.float64)
11 gae_duplicate tensor(-0.4482, dtype=torch.float64) tensor(-9.8436, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2565, dtype=torch.float64) delta_t tensor(0.0495, dtype=torch.float64)
10 gae_duplicate tensor(-0.3392, dtype=torch.float64) tensor(-2.0284, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2378, dtype=torch.float64) delta_t tensor(-0.0382, dtype=torch.float64)
9 gae_duplicate tensor(-1.3432, dtype=torch.float64) tensor(3.5978, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4488, dtype=torch.float64) delta_t tensor(0.1723, dtype=torch.float64)
8 gae_duplicate tensor(-1.0075, dtype=torch.float64) tensor(-3.4535, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3078, dtype=torch.float64) delta_t tensor(0.4691, dtype=torch.float64)
7 gae_duplicate tensor(-1.6282, dtype=torch.float64) tensor(-10.0723, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3031, dtype=torch.float64) delta_t tensor(0.2023, dtype=torch.float64)
6 gae_duplicate tensor(-2.6365, dtype=torch.float64) tensor(-4.4261, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2865, dtype=torch.float64) delta_t tensor(0.3488, dtype=torch.float64)
5 gae_duplicate tensor(-0.1416, dtype=torch.float64) tensor(-7.7384, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4648, dtype=torch.float64) delta_t tensor(0.0703, dtype=torch.float64)
4 gae_duplicate tensor(-0.0258, dtype=torch.float64) tensor(-2.4445, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1905, dtype=torch.float64) delta_t tensor(0.0151, dtype=torch.float64)
3 gae_duplicate tensor(-0.1478, dtype=torch.float64) tensor(-0.2999, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1127, dtype=torch.float64) delta_t tensor(0.0645, dtype=torch.float64)
2 gae_duplicate tensor(-0.0353, dtype=torch.float64) tensor(-1.2988, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2984.873046875
value loss:82.28793334960938
entropies:344.94921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.826030254364014 seconds
19 rew tensor(0.8448, dtype=torch.float64) delta_t tensor(0.0324, dtype=torch.float64)
19 gae_duplicate tensor(-0.0487, dtype=torch.float64) tensor(-0.4985, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7968, dtype=torch.float64) delta_t tensor(0.1319, dtype=torch.float64)
18 gae_duplicate tensor(0.0393, dtype=torch.float64) tensor(-2.3963, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7885, dtype=torch.float64) delta_t tensor(0.1453, dtype=torch.float64)
17 gae_duplicate tensor(0.0522, dtype=torch.float64) tensor(-2.9048, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6642, dtype=torch.float64) delta_t tensor(0.2391, dtype=torch.float64)
16 gae_duplicate tensor(0.1399, dtype=torch.float64) tensor(-4.9103, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4989, dtype=torch.float64) delta_t tensor(-0.0558, dtype=torch.float64)
15 gae_duplicate tensor(-0.8028, dtype=torch.float64) tensor(1.2912, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2696, dtype=torch.float64) delta_t tensor(0.2000, dtype=torch.float64)
14 gae_duplicate tensor(-0.9283, dtype=torch.float64) tensor(-3.9919, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7507, dtype=torch.float64) delta_t tensor(0.2087, dtype=torch.float64)
13 gae_duplicate tensor(0.0769, dtype=torch.float64) tensor(-4.6185, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3341, dtype=torch.float64) delta_t tensor(0.3564, dtype=torch.float64)
12 gae_duplicate tensor(0.2425, dtype=torch.float64) tensor(-7.6601, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2228, dtype=torch.float64) delta_t tensor(-0.1236, dtype=torch.float64)
11 gae_duplicate tensor(-1.2239, dtype=torch.float64) tensor(2.0910, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4966, dtype=torch.float64) delta_t tensor(-0.0243, dtype=torch.float64)
10 gae_duplicate tensor(-1.6420, dtype=torch.float64) tensor(-0.0456, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1295, dtype=torch.float64) delta_t tensor(-0.5172, dtype=torch.float64)
9 gae_duplicate tensor(-2.3778, dtype=torch.float64) tensor(9.8294, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0542, dtype=torch.float64) delta_t tensor(0.6621, dtype=torch.float64)
8 gae_duplicate tensor(-2.1902, dtype=torch.float64) tensor(-9.7126, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5217, dtype=torch.float64) delta_t tensor(1.0338, dtype=torch.float64)
7 gae_duplicate tensor(-0.2854, dtype=torch.float64) tensor(-21.1609, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0175, dtype=torch.float64) delta_t tensor(0.8196, dtype=torch.float64)
6 gae_duplicate tensor(-0.1722, dtype=torch.float64) tensor(-19.9028, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2956, dtype=torch.float64) delta_t tensor(-0.1305, dtype=torch.float64)
5 gae_duplicate tensor(-0.3037, dtype=torch.float64) tensor(0.5131, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1688, dtype=torch.float64) delta_t tensor(0.0116, dtype=torch.float64)
4 gae_duplicate tensor(-0.0697, dtype=torch.float64) tensor(-0.1418, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5389, dtype=torch.float64) delta_t tensor(0.0067, dtype=torch.float64)
3 gae_duplicate tensor(-0.0507, dtype=torch.float64) tensor(-0.1490, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6055, dtype=torch.float64) delta_t tensor(-0.0402, dtype=torch.float64)
2 gae_duplicate tensor(-0.1206, dtype=torch.float64) tensor(0.7398, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3342.91748046875
value loss:92.04425811767578
entropies:344.54693603515625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3940.8008)
ToM Target loss= tensor(3662.1208)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.040447950363159 seconds
19 rew tensor(0.8540, dtype=torch.float64) delta_t tensor(-0.0515, dtype=torch.float64)
19 gae_duplicate tensor(-0.1109, dtype=torch.float64) tensor(0.9533, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8255, dtype=torch.float64) delta_t tensor(0.0824, dtype=torch.float64)
18 gae_duplicate tensor(-0.0721, dtype=torch.float64) tensor(-1.5572, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7782, dtype=torch.float64) delta_t tensor(-0.0105, dtype=torch.float64)
17 gae_duplicate tensor(-0.1007, dtype=torch.float64) tensor(0.0598, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7112, dtype=torch.float64) delta_t tensor(0.1088, dtype=torch.float64)
16 gae_duplicate tensor(-0.0141, dtype=torch.float64) tensor(-2.1669, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7881, dtype=torch.float64) delta_t tensor(0.1233, dtype=torch.float64)
15 gae_duplicate tensor(-0.0009, dtype=torch.float64) tensor(-2.6347, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3352, dtype=torch.float64) delta_t tensor(-0.0358, dtype=torch.float64)
14 gae_duplicate tensor(-0.7527, dtype=torch.float64) tensor(0.0367, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7406, dtype=torch.float64) delta_t tensor(0.2114, dtype=torch.float64)
13 gae_duplicate tensor(-0.0005, dtype=torch.float64) tensor(-4.3647, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2696, dtype=torch.float64) delta_t tensor(0.0338, dtype=torch.float64)
12 gae_duplicate tensor(-0.8261, dtype=torch.float64) tensor(-1.0402, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4258, dtype=torch.float64) delta_t tensor(0.2374, dtype=torch.float64)
11 gae_duplicate tensor(-0.2196, dtype=torch.float64) tensor(-4.6713, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1436, dtype=torch.float64) delta_t tensor(0.3862, dtype=torch.float64)
10 gae_duplicate tensor(-0.7232, dtype=torch.float64) tensor(-8.9998, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6629, dtype=torch.float64) delta_t tensor(0.2893, dtype=torch.float64)
9 gae_duplicate tensor(-2.1833, dtype=torch.float64) tensor(-6.8458, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6564, dtype=torch.float64) delta_t tensor(0.3685, dtype=torch.float64)
8 gae_duplicate tensor(-1.7102, dtype=torch.float64) tensor(-7.6379, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4178, dtype=torch.float64) delta_t tensor(0.2847, dtype=torch.float64)
7 gae_duplicate tensor(-0.6047, dtype=torch.float64) tensor(-7.6228, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3699, dtype=torch.float64) delta_t tensor(0.6476, dtype=torch.float64)
6 gae_duplicate tensor(-1.5469, dtype=torch.float64) tensor(-12.5768, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2250, dtype=torch.float64) delta_t tensor(-0.2344, dtype=torch.float64)
5 gae_duplicate tensor(-0.6280, dtype=torch.float64) tensor(3.0075, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0796, dtype=torch.float64) delta_t tensor(-0.1292, dtype=torch.float64)
4 gae_duplicate tensor(-0.2717, dtype=torch.float64) tensor(2.7294, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2036, dtype=torch.float64) delta_t tensor(-0.0734, dtype=torch.float64)
3 gae_duplicate tensor(-0.3296, dtype=torch.float64) tensor(1.5453, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3462, dtype=torch.float64) delta_t tensor(-0.0451, dtype=torch.float64)
2 gae_duplicate tensor(-0.1400, dtype=torch.float64) tensor(1.0290, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2647.977783203125
value loss:69.53584289550781
entropies:344.0962219238281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.2434070110321045 seconds
19 rew tensor(0.8532, dtype=torch.float64) delta_t tensor(-0.1413, dtype=torch.float64)
19 gae_duplicate tensor(-0.2472, dtype=torch.float64) tensor(2.8132, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(-0.0145, dtype=torch.float64)
18 gae_duplicate tensor(-0.1671, dtype=torch.float64) tensor(0.5511, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8348, dtype=torch.float64) delta_t tensor(-0.0071, dtype=torch.float64)
17 gae_duplicate tensor(-0.1357, dtype=torch.float64) tensor(0.1967, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6423, dtype=torch.float64) delta_t tensor(-0.0094, dtype=torch.float64)
16 gae_duplicate tensor(-0.2040, dtype=torch.float64) tensor(0.1460, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6112, dtype=torch.float64) delta_t tensor(-0.1028, dtype=torch.float64)
15 gae_duplicate tensor(-1.1539, dtype=torch.float64) tensor(2.3430, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5564, dtype=torch.float64) delta_t tensor(0.1680, dtype=torch.float64)
14 gae_duplicate tensor(-0.1516, dtype=torch.float64) tensor(-2.4572, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7132, dtype=torch.float64) delta_t tensor(0.2056, dtype=torch.float64)
13 gae_duplicate tensor(-0.1515, dtype=torch.float64) tensor(-4.1202, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3042, dtype=torch.float64) delta_t tensor(0.1940, dtype=torch.float64)
12 gae_duplicate tensor(-0.9789, dtype=torch.float64) tensor(-3.9254, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4563, dtype=torch.float64) delta_t tensor(-0.4102, dtype=torch.float64)
11 gae_duplicate tensor(-1.6401, dtype=torch.float64) tensor(7.0240, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0449, dtype=torch.float64) delta_t tensor(0.0246, dtype=torch.float64)
10 gae_duplicate tensor(-0.7752, dtype=torch.float64) tensor(0.6522, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5655, dtype=torch.float64) delta_t tensor(-0.8567, dtype=torch.float64)
9 gae_duplicate tensor(-3.4234, dtype=torch.float64) tensor(17.1819, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1295, dtype=torch.float64) delta_t tensor(0.8469, dtype=torch.float64)
8 gae_duplicate tensor(-0.2075, dtype=torch.float64) tensor(-15.1402, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2077, dtype=torch.float64) delta_t tensor(1.0424, dtype=torch.float64)
7 gae_duplicate tensor(0.5201, dtype=torch.float64) tensor(-20.4956, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0103, dtype=torch.float64) delta_t tensor(0.7770, dtype=torch.float64)
6 gae_duplicate tensor(-0.1423, dtype=torch.float64) tensor(-16.3271, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2841, dtype=torch.float64) delta_t tensor(-0.3838, dtype=torch.float64)
5 gae_duplicate tensor(-1.0491, dtype=torch.float64) tensor(6.9205, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0210, dtype=torch.float64) delta_t tensor(-0.3339, dtype=torch.float64)
4 gae_duplicate tensor(-1.5614, dtype=torch.float64) tensor(7.5054, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2007, dtype=torch.float64) delta_t tensor(-0.1100, dtype=torch.float64)
3 gae_duplicate tensor(-0.3488, dtype=torch.float64) tensor(3.0253, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4033, dtype=torch.float64) delta_t tensor(-0.1354, dtype=torch.float64)
2 gae_duplicate tensor(-0.4335, dtype=torch.float64) tensor(2.7939, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:518.0039672851562
value loss:88.00015258789062
entropies:343.9292907714844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.139153957366943 seconds
19 rew tensor(0.8824, dtype=torch.float64) delta_t tensor(-0.2925, dtype=torch.float64)
19 gae_duplicate tensor(-0.3147, dtype=torch.float64) tensor(5.9648, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8548, dtype=torch.float64) delta_t tensor(-0.1636, dtype=torch.float64)
18 gae_duplicate tensor(-0.3165, dtype=torch.float64) tensor(3.4873, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8362, dtype=torch.float64) delta_t tensor(-0.0952, dtype=torch.float64)
17 gae_duplicate tensor(-0.2073, dtype=torch.float64) tensor(2.2636, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7222, dtype=torch.float64) delta_t tensor(-0.1929, dtype=torch.float64)
16 gae_duplicate tensor(-0.3169, dtype=torch.float64) tensor(3.9855, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4213, dtype=torch.float64) delta_t tensor(-0.3132, dtype=torch.float64)
15 gae_duplicate tensor(-1.1827, dtype=torch.float64) tensor(6.9854, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3014, dtype=torch.float64) delta_t tensor(-0.4672, dtype=torch.float64)
14 gae_duplicate tensor(-1.2582, dtype=torch.float64) tensor(8.3298, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5156, dtype=torch.float64) delta_t tensor(-0.1346, dtype=torch.float64)
13 gae_duplicate tensor(-0.2226, dtype=torch.float64) tensor(3.4842, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6428, dtype=torch.float64) delta_t tensor(-0.0048, dtype=torch.float64)
12 gae_duplicate tensor(-0.1818, dtype=torch.float64) tensor(0.4062, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1062, dtype=torch.float64) delta_t tensor(-0.0533, dtype=torch.float64)
11 gae_duplicate tensor(-1.6001, dtype=torch.float64) tensor(1.5732, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0073, dtype=torch.float64) delta_t tensor(-0.0220, dtype=torch.float64)
10 gae_duplicate tensor(-0.8204, dtype=torch.float64) tensor(0.6929, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2240, dtype=torch.float64) delta_t tensor(-0.0528, dtype=torch.float64)
9 gae_duplicate tensor(-2.4155, dtype=torch.float64) tensor(1.4403, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2613, dtype=torch.float64) delta_t tensor(0.1519, dtype=torch.float64)
8 gae_duplicate tensor(-0.6253, dtype=torch.float64) tensor(-2.3334, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.8925, dtype=torch.float64) delta_t tensor(-0.8398, dtype=torch.float64)
7 gae_duplicate tensor(-2.9236, dtype=torch.float64) tensor(18.4769, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5281, dtype=torch.float64) delta_t tensor(0.1359, dtype=torch.float64)
6 gae_duplicate tensor(-2.0105, dtype=torch.float64) tensor(-1.8948, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3013, dtype=torch.float64) delta_t tensor(0.1179, dtype=torch.float64)
5 gae_duplicate tensor(-0.4084, dtype=torch.float64) tensor(-2.3976, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3859, dtype=torch.float64) delta_t tensor(-0.2757, dtype=torch.float64)
4 gae_duplicate tensor(-0.5164, dtype=torch.float64) tensor(4.9245, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3035, dtype=torch.float64) delta_t tensor(-0.2898, dtype=torch.float64)
3 gae_duplicate tensor(-0.4821, dtype=torch.float64) tensor(6.1651, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0355, dtype=torch.float64) delta_t tensor(-0.2358, dtype=torch.float64)
2 gae_duplicate tensor(-0.3914, dtype=torch.float64) tensor(5.1232, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3693.3310546875
value loss:78.06542205810547
entropies:343.59332275390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.950736999511719 seconds
19 rew tensor(0.8622, dtype=torch.float64) delta_t tensor(-0.2811, dtype=torch.float64)
19 gae_duplicate tensor(-0.3683, dtype=torch.float64) tensor(5.4259, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8532, dtype=torch.float64) delta_t tensor(-0.1569, dtype=torch.float64)
18 gae_duplicate tensor(-0.3027, dtype=torch.float64) tensor(3.2308, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7572, dtype=torch.float64) delta_t tensor(-0.1342, dtype=torch.float64)
17 gae_duplicate tensor(-0.2521, dtype=torch.float64) tensor(2.8101, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5186, dtype=torch.float64) delta_t tensor(-0.3264, dtype=torch.float64)
16 gae_duplicate tensor(-1.3206, dtype=torch.float64) tensor(7.6403, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6626, dtype=torch.float64) delta_t tensor(-0.1336, dtype=torch.float64)
15 gae_duplicate tensor(-0.3866, dtype=torch.float64) tensor(3.0031, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5681, dtype=torch.float64) delta_t tensor(-0.1037, dtype=torch.float64)
14 gae_duplicate tensor(-0.2111, dtype=torch.float64) tensor(2.3045, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5598, dtype=torch.float64) delta_t tensor(-0.0418, dtype=torch.float64)
13 gae_duplicate tensor(-0.1724, dtype=torch.float64) tensor(0.9039, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3140, dtype=torch.float64) delta_t tensor(-0.1634, dtype=torch.float64)
12 gae_duplicate tensor(-1.1006, dtype=torch.float64) tensor(2.4741, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0716, dtype=torch.float64) delta_t tensor(-0.1319, dtype=torch.float64)
11 gae_duplicate tensor(-1.9226, dtype=torch.float64) tensor(4.3909, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7025, dtype=torch.float64) delta_t tensor(-0.6699, dtype=torch.float64)
10 gae_duplicate tensor(-3.1092, dtype=torch.float64) tensor(13.6282, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.9412, dtype=torch.float64) delta_t tensor(-0.9433, dtype=torch.float64)
9 gae_duplicate tensor(-3.6951, dtype=torch.float64) tensor(20.0000, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3329, dtype=torch.float64) delta_t tensor(0.2032, dtype=torch.float64)
8 gae_duplicate tensor(-1.8295, dtype=torch.float64) tensor(-1.1955, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4637, dtype=torch.float64) delta_t tensor(0.3339, dtype=torch.float64)
7 gae_duplicate tensor(-0.7686, dtype=torch.float64) tensor(-5.0796, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0369, dtype=torch.float64) delta_t tensor(0.3692, dtype=torch.float64)
6 gae_duplicate tensor(-0.2824, dtype=torch.float64) tensor(-6.9624, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1489, dtype=torch.float64) delta_t tensor(0.0139, dtype=torch.float64)
5 gae_duplicate tensor(-0.6022, dtype=torch.float64) tensor(-0.6639, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2050, dtype=torch.float64) delta_t tensor(-0.2657, dtype=torch.float64)
4 gae_duplicate tensor(-0.4213, dtype=torch.float64) tensor(4.6294, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0779, dtype=torch.float64) delta_t tensor(-0.2636, dtype=torch.float64)
3 gae_duplicate tensor(-0.3861, dtype=torch.float64) tensor(5.4988, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1929, dtype=torch.float64) delta_t tensor(-0.2596, dtype=torch.float64)
2 gae_duplicate tensor(-0.3569, dtype=torch.float64) tensor(5.0255, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3714.064208984375
value loss:92.70868682861328
entropies:342.9735412597656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8412909507751465 seconds
19 rew tensor(0.8820, dtype=torch.float64) delta_t tensor(-0.2842, dtype=torch.float64)
19 gae_duplicate tensor(-0.3002, dtype=torch.float64) tensor(5.8411, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8444, dtype=torch.float64) delta_t tensor(-0.1382, dtype=torch.float64)
18 gae_duplicate tensor(-0.2424, dtype=torch.float64) tensor(3.1598, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7022, dtype=torch.float64) delta_t tensor(-0.2216, dtype=torch.float64)
17 gae_duplicate tensor(-0.3043, dtype=torch.float64) tensor(4.5906, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7101, dtype=torch.float64) delta_t tensor(-0.1447, dtype=torch.float64)
16 gae_duplicate tensor(-0.2418, dtype=torch.float64) tensor(2.9585, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6366, dtype=torch.float64) delta_t tensor(-0.1870, dtype=torch.float64)
15 gae_duplicate tensor(-0.3113, dtype=torch.float64) tensor(3.9806, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5475, dtype=torch.float64) delta_t tensor(-0.0592, dtype=torch.float64)
14 gae_duplicate tensor(-0.1950, dtype=torch.float64) tensor(1.6074, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6381, dtype=torch.float64) delta_t tensor(-0.0303, dtype=torch.float64)
13 gae_duplicate tensor(-0.1912, dtype=torch.float64) tensor(0.8259, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2576, dtype=torch.float64) delta_t tensor(-0.1845, dtype=torch.float64)
12 gae_duplicate tensor(-1.1386, dtype=torch.float64) tensor(3.3321, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1162, dtype=torch.float64) delta_t tensor(-0.0228, dtype=torch.float64)
11 gae_duplicate tensor(-1.1202, dtype=torch.float64) tensor(0.6099, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0972, dtype=torch.float64) delta_t tensor(0.1228, dtype=torch.float64)
10 gae_duplicate tensor(-0.7933, dtype=torch.float64) tensor(-2.6774, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9182, dtype=torch.float64) delta_t tensor(-0.2991, dtype=torch.float64)
9 gae_duplicate tensor(-1.3973, dtype=torch.float64) tensor(4.8030, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1542, dtype=torch.float64) delta_t tensor(-0.4666, dtype=torch.float64)
8 gae_duplicate tensor(-2.0807, dtype=torch.float64) tensor(9.8023, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0728, dtype=torch.float64) delta_t tensor(0.3624, dtype=torch.float64)
7 gae_duplicate tensor(-0.3044, dtype=torch.float64) tensor(-6.0932, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4165, dtype=torch.float64) delta_t tensor(0.1634, dtype=torch.float64)
6 gae_duplicate tensor(-0.9384, dtype=torch.float64) tensor(-3.1227, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2786, dtype=torch.float64) delta_t tensor(-0.4538, dtype=torch.float64)
5 gae_duplicate tensor(-2.7405, dtype=torch.float64) tensor(8.6111, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2243, dtype=torch.float64) delta_t tensor(-0.4934, dtype=torch.float64)
4 gae_duplicate tensor(-1.7208, dtype=torch.float64) tensor(9.2143, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2810, dtype=torch.float64) delta_t tensor(-0.2373, dtype=torch.float64)
3 gae_duplicate tensor(-0.5610, dtype=torch.float64) tensor(5.4423, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3773, dtype=torch.float64) delta_t tensor(-0.2856, dtype=torch.float64)
2 gae_duplicate tensor(-0.4041, dtype=torch.float64) tensor(5.4556, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3242.81640625
value loss:53.41122817993164
entropies:342.1817932128906
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3899.5881)
ToM Target loss= tensor(3669.1570)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.8792500495910645 seconds
19 rew tensor(0.8721, dtype=torch.float64) delta_t tensor(-0.1304, dtype=torch.float64)
19 gae_duplicate tensor(-0.1783, dtype=torch.float64) tensor(2.4474, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8067, dtype=torch.float64) delta_t tensor(-0.0432, dtype=torch.float64)
18 gae_duplicate tensor(-0.1442, dtype=torch.float64) tensor(0.9502, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7680, dtype=torch.float64) delta_t tensor(-0.0648, dtype=torch.float64)
17 gae_duplicate tensor(-0.1362, dtype=torch.float64) tensor(1.2646, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6738, dtype=torch.float64) delta_t tensor(-0.0268, dtype=torch.float64)
16 gae_duplicate tensor(-0.1493, dtype=torch.float64) tensor(0.8519, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7500, dtype=torch.float64) delta_t tensor(0.0253, dtype=torch.float64)
15 gae_duplicate tensor(-0.1525, dtype=torch.float64) tensor(-0.0530, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5694, dtype=torch.float64) delta_t tensor(0.0997, dtype=torch.float64)
14 gae_duplicate tensor(0.0022, dtype=torch.float64) tensor(-2.0513, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5970, dtype=torch.float64) delta_t tensor(-0.0008, dtype=torch.float64)
13 gae_duplicate tensor(-0.0747, dtype=torch.float64) tensor(-0.3187, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1746, dtype=torch.float64) delta_t tensor(0.0009, dtype=torch.float64)
12 gae_duplicate tensor(-0.9659, dtype=torch.float64) tensor(-0.0322, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0740, dtype=torch.float64) delta_t tensor(-0.1909, dtype=torch.float64)
11 gae_duplicate tensor(-1.8270, dtype=torch.float64) tensor(2.9786, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6372, dtype=torch.float64) delta_t tensor(-0.1429, dtype=torch.float64)
10 gae_duplicate tensor(-2.0123, dtype=torch.float64) tensor(1.6562, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1749, dtype=torch.float64) delta_t tensor(0.6105, dtype=torch.float64)
9 gae_duplicate tensor(-0.2574, dtype=torch.float64) tensor(-12.8658, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.4689, dtype=torch.float64) delta_t tensor(-0.1494, dtype=torch.float64)
8 gae_duplicate tensor(-3.9454, dtype=torch.float64) tensor(2.9326, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0988, dtype=torch.float64) delta_t tensor(0.2227, dtype=torch.float64)
7 gae_duplicate tensor(-0.8889, dtype=torch.float64) tensor(-3.6347, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1724, dtype=torch.float64) delta_t tensor(0.4900, dtype=torch.float64)
6 gae_duplicate tensor(-1.0253, dtype=torch.float64) tensor(-9.1669, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2246, dtype=torch.float64) delta_t tensor(-0.1676, dtype=torch.float64)
5 gae_duplicate tensor(-0.4715, dtype=torch.float64) tensor(3.0247, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0395, dtype=torch.float64) delta_t tensor(-0.1080, dtype=torch.float64)
4 gae_duplicate tensor(-0.3394, dtype=torch.float64) tensor(2.5055, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1678, dtype=torch.float64) delta_t tensor(-0.1885, dtype=torch.float64)
3 gae_duplicate tensor(-0.5751, dtype=torch.float64) tensor(3.4570, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4193, dtype=torch.float64) delta_t tensor(-0.0698, dtype=torch.float64)
2 gae_duplicate tensor(-0.1302, dtype=torch.float64) tensor(1.6662, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:144.6757049560547
value loss:79.80067443847656
entropies:341.68878173828125
Policy training finished
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 809, in _callmethod
    conn.send((self._id, methodname, args, kwds))
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 206, in send
    self._send_bytes(_ForkingPickler.dumps(obj))
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
KeyboardInterrupt