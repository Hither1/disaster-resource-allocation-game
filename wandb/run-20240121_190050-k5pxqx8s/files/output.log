obs <crafter.objects.Shelter object at 0x12d51b940> 0 [39.  0.  0.  0. 39.  0.  0.  0. 16.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x11ba3bb80> 0 [40.  0.  0.  0. 41.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x12d522910> 0 [ 9.  0.  0.  0.  9.  0.  0.  0. 16.  0.  0.  0.]
obs <crafter.objects.Shelter object at 0x12d51b940> 0 [39.  0.  0.  0. 39.  0.  0.  0. 17.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x11ba3bb80> 0 [38.  0.  0.  0. 39.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x12d522910> 0 [ 9.  0.  0.  0.  9.  0.  0.  0. 10.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0035271644592285156 seconds
19 rew tensor(0.9189, dtype=torch.float64) delta_t tensor(0.8419, dtype=torch.float64)
19 gae_duplicate tensor(0.5796, dtype=torch.float64) tensor(-16.5964, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8566, dtype=torch.float64) delta_t tensor(0.7781, dtype=torch.float64)
18 gae_duplicate tensor(0.7051, dtype=torch.float64) tensor(-16.9915, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9209, dtype=torch.float64) delta_t tensor(0.8618, dtype=torch.float64)
17 gae_duplicate tensor(0.6369, dtype=torch.float64) tensor(-18.6897, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9181, dtype=torch.float64) delta_t tensor(0.8804, dtype=torch.float64)
16 gae_duplicate tensor(0.7679, dtype=torch.float64) tensor(-19.1003, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7981, dtype=torch.float64) delta_t tensor(0.7674, dtype=torch.float64)
15 gae_duplicate tensor(0.6379, dtype=torch.float64) tensor(-17.0901, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7937, dtype=torch.float64) delta_t tensor(0.7323, dtype=torch.float64)
14 gae_duplicate tensor(0.6253, dtype=torch.float64) tensor(-16.0673, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9647, dtype=torch.float64) delta_t tensor(0.9442, dtype=torch.float64)
13 gae_duplicate tensor(0.6719, dtype=torch.float64) tensor(-19.9360, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8489, dtype=torch.float64) delta_t tensor(0.7837, dtype=torch.float64)
12 gae_duplicate tensor(0.5221, dtype=torch.float64) tensor(-17.5173, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0955, dtype=torch.float64) delta_t tensor(-0.0888, dtype=torch.float64)
11 gae_duplicate tensor(-0.9061, dtype=torch.float64) tensor(0.0476, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5294, dtype=torch.float64) delta_t tensor(0.4820, dtype=torch.float64)
10 gae_duplicate tensor(-0.1084, dtype=torch.float64) tensor(-9.4418, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4426, dtype=torch.float64) delta_t tensor(-0.4671, dtype=torch.float64)
9 gae_duplicate tensor(-2.1151, dtype=torch.float64) tensor(8.1025, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0276, dtype=torch.float64) delta_t tensor(-1.0222, dtype=torch.float64)
8 gae_duplicate tensor(-2.4826, dtype=torch.float64) tensor(20.9432, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3223, dtype=torch.float64) delta_t tensor(-0.3844, dtype=torch.float64)
7 gae_duplicate tensor(-2.1894, dtype=torch.float64) tensor(10.0119, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1039, dtype=torch.float64) delta_t tensor(0.1168, dtype=torch.float64)
6 gae_duplicate tensor(-1.7424, dtype=torch.float64) tensor(-1.1544, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.5415, dtype=torch.float64) delta_t tensor(0.4977, dtype=torch.float64)
5 gae_duplicate tensor(-0.3986, dtype=torch.float64) tensor(-9.9991, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.8623, dtype=torch.float64) delta_t tensor(0.8068, dtype=torch.float64)
4 gae_duplicate tensor(-0.3510, dtype=torch.float64) tensor(-16.9789, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.0085, dtype=torch.float64) delta_t tensor(1.0161, dtype=torch.float64)
3 gae_duplicate tensor(0.2729, dtype=torch.float64) tensor(-21.6984, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.7081, dtype=torch.float64) delta_t tensor(0.6886, dtype=torch.float64)
2 gae_duplicate tensor(-0.9844, dtype=torch.float64) tensor(-15.6508, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:9505.51953125
value loss:177.7482452392578
entropies:355.724365234375
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 4.802438020706177 seconds
19 rew tensor(0.9419, dtype=torch.float64) delta_t tensor(0.8375, dtype=torch.float64)
19 gae_duplicate tensor(0.7434, dtype=torch.float64) tensor(-16.4411, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9212, dtype=torch.float64) delta_t tensor(0.8363, dtype=torch.float64)
18 gae_duplicate tensor(0.8469, dtype=torch.float64) tensor(-18.6102, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9258, dtype=torch.float64) delta_t tensor(0.8569, dtype=torch.float64)
17 gae_duplicate tensor(0.7660, dtype=torch.float64) tensor(-18.2423, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8459, dtype=torch.float64) delta_t tensor(0.7738, dtype=torch.float64)
16 gae_duplicate tensor(0.6286, dtype=torch.float64) tensor(-17.1600, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8432, dtype=torch.float64) delta_t tensor(0.7755, dtype=torch.float64)
15 gae_duplicate tensor(0.6912, dtype=torch.float64) tensor(-16.6546, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7373, dtype=torch.float64) delta_t tensor(0.6527, dtype=torch.float64)
14 gae_duplicate tensor(0.5441, dtype=torch.float64) tensor(-14.3420, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7678, dtype=torch.float64) delta_t tensor(0.6985, dtype=torch.float64)
13 gae_duplicate tensor(0.5526, dtype=torch.float64) tensor(-15.5431, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2961, dtype=torch.float64) delta_t tensor(0.2344, dtype=torch.float64)
12 gae_duplicate tensor(-1.7049, dtype=torch.float64) tensor(-6.2261, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5268, dtype=torch.float64) delta_t tensor(0.5107, dtype=torch.float64)
11 gae_duplicate tensor(-0.3766, dtype=torch.float64) tensor(-10.8743, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.0166, dtype=torch.float64) delta_t tensor(-1.0226, dtype=torch.float64)
10 gae_duplicate tensor(-2.5117, dtype=torch.float64) tensor(19.1114, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6451, dtype=torch.float64) delta_t tensor(-0.6580, dtype=torch.float64)
9 gae_duplicate tensor(-2.3239, dtype=torch.float64) tensor(15.7346, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1507, dtype=torch.float64) delta_t tensor(-0.1649, dtype=torch.float64)
8 gae_duplicate tensor(-1.8163, dtype=torch.float64) tensor(4.4430, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4058, dtype=torch.float64) delta_t tensor(-0.3919, dtype=torch.float64)
7 gae_duplicate tensor(-2.5917, dtype=torch.float64) tensor(8.1801, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4825, dtype=torch.float64) delta_t tensor(-0.5086, dtype=torch.float64)
6 gae_duplicate tensor(-1.6276, dtype=torch.float64) tensor(10.8817, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0549, dtype=torch.float64) delta_t tensor(-0.0732, dtype=torch.float64)
5 gae_duplicate tensor(-1.0351, dtype=torch.float64) tensor(2.3728, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2013, dtype=torch.float64) delta_t tensor(0.1233, dtype=torch.float64)
4 gae_duplicate tensor(-1.1277, dtype=torch.float64) tensor(-2.9059, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2026, dtype=torch.float64) delta_t tensor(0.1663, dtype=torch.float64)
3 gae_duplicate tensor(-0.6427, dtype=torch.float64) tensor(-3.5467, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2628, dtype=torch.float64) delta_t tensor(-0.3133, dtype=torch.float64)
2 gae_duplicate tensor(-1.5034, dtype=torch.float64) tensor(6.0334, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3888.7626953125
value loss:137.7094268798828
entropies:355.0406799316406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.34971809387207 seconds
19 rew tensor(0.9361, dtype=torch.float64) delta_t tensor(0.7868, dtype=torch.float64)
19 gae_duplicate tensor(0.6781, dtype=torch.float64) tensor(-15.3554, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9085, dtype=torch.float64) delta_t tensor(0.7773, dtype=torch.float64)
18 gae_duplicate tensor(0.7127, dtype=torch.float64) tensor(-17.7471, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8918, dtype=torch.float64) delta_t tensor(0.7878, dtype=torch.float64)
17 gae_duplicate tensor(0.6821, dtype=torch.float64) tensor(-16.4849, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6982, dtype=torch.float64) delta_t tensor(0.5849, dtype=torch.float64)
16 gae_duplicate tensor(0.5049, dtype=torch.float64) tensor(-13.0185, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5436, dtype=torch.float64) delta_t tensor(0.4389, dtype=torch.float64)
15 gae_duplicate tensor(-0.7340, dtype=torch.float64) tensor(-9.8706, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6964, dtype=torch.float64) delta_t tensor(0.5851, dtype=torch.float64)
14 gae_duplicate tensor(0.4242, dtype=torch.float64) tensor(-12.1965, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4184, dtype=torch.float64) delta_t tensor(0.2968, dtype=torch.float64)
13 gae_duplicate tensor(-0.6469, dtype=torch.float64) tensor(-6.9931, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1505, dtype=torch.float64) delta_t tensor(0.0517, dtype=torch.float64)
12 gae_duplicate tensor(-0.7425, dtype=torch.float64) tensor(-1.4237, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5014, dtype=torch.float64) delta_t tensor(-0.6142, dtype=torch.float64)
11 gae_duplicate tensor(-1.9679, dtype=torch.float64) tensor(11.1747, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0672, dtype=torch.float64) delta_t tensor(-0.1253, dtype=torch.float64)
10 gae_duplicate tensor(-1.3322, dtype=torch.float64) tensor(3.7353, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9138, dtype=torch.float64) delta_t tensor(-0.9790, dtype=torch.float64)
9 gae_duplicate tensor(-3.0893, dtype=torch.float64) tensor(21.2355, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5380, dtype=torch.float64) delta_t tensor(-0.5752, dtype=torch.float64)
8 gae_duplicate tensor(-3.3036, dtype=torch.float64) tensor(14.4523, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0634, dtype=torch.float64) delta_t tensor(0.0174, dtype=torch.float64)
7 gae_duplicate tensor(-2.5073, dtype=torch.float64) tensor(1.0719, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1515, dtype=torch.float64) delta_t tensor(-0.1556, dtype=torch.float64)
6 gae_duplicate tensor(-1.0748, dtype=torch.float64) tensor(3.0124, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0697, dtype=torch.float64) delta_t tensor(-0.0187, dtype=torch.float64)
5 gae_duplicate tensor(-1.8095, dtype=torch.float64) tensor(1.1860, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0218, dtype=torch.float64) delta_t tensor(-0.1026, dtype=torch.float64)
4 gae_duplicate tensor(-0.7946, dtype=torch.float64) tensor(2.0380, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1980, dtype=torch.float64) delta_t tensor(0.1760, dtype=torch.float64)
3 gae_duplicate tensor(-1.7054, dtype=torch.float64) tensor(-3.0174, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3264, dtype=torch.float64) delta_t tensor(-0.3887, dtype=torch.float64)
2 gae_duplicate tensor(-0.7677, dtype=torch.float64) tensor(7.3073, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1572.6171875
value loss:138.28195190429688
entropies:354.27880859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9834630489349365 seconds
19 rew tensor(0.9158, dtype=torch.float64) delta_t tensor(0.7352, dtype=torch.float64)
19 gae_duplicate tensor(0.6549, dtype=torch.float64) tensor(-14.9244, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8757, dtype=torch.float64) delta_t tensor(0.7097, dtype=torch.float64)
18 gae_duplicate tensor(0.6729, dtype=torch.float64) tensor(-15.2641, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8400, dtype=torch.float64) delta_t tensor(0.6816, dtype=torch.float64)
17 gae_duplicate tensor(0.6302, dtype=torch.float64) tensor(-15.1929, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8180, dtype=torch.float64) delta_t tensor(0.6581, dtype=torch.float64)
16 gae_duplicate tensor(0.6290, dtype=torch.float64) tensor(-14.3391, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7744, dtype=torch.float64) delta_t tensor(0.6131, dtype=torch.float64)
15 gae_duplicate tensor(0.4016, dtype=torch.float64) tensor(-13.4802, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5487, dtype=torch.float64) delta_t tensor(0.4052, dtype=torch.float64)
14 gae_duplicate tensor(-0.5157, dtype=torch.float64) tensor(-9.6586, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6569, dtype=torch.float64) delta_t tensor(0.5040, dtype=torch.float64)
13 gae_duplicate tensor(0.2063, dtype=torch.float64) tensor(-11.0389, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6475, dtype=torch.float64) delta_t tensor(0.5080, dtype=torch.float64)
12 gae_duplicate tensor(0.3097, dtype=torch.float64) tensor(-10.7932, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3555, dtype=torch.float64) delta_t tensor(0.2139, dtype=torch.float64)
11 gae_duplicate tensor(-1.3933, dtype=torch.float64) tensor(-6.1984, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3012, dtype=torch.float64) delta_t tensor(0.1686, dtype=torch.float64)
10 gae_duplicate tensor(-0.9986, dtype=torch.float64) tensor(-4.1344, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-3.0042, dtype=torch.float64) delta_t tensor(-3.1277, dtype=torch.float64)
9 gae_duplicate tensor(-4.5466, dtype=torch.float64) tensor(60.9110, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3991, dtype=torch.float64) delta_t tensor(-1.5133, dtype=torch.float64)
8 gae_duplicate tensor(-3.5635, dtype=torch.float64) tensor(36.0407, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1239, dtype=torch.float64) delta_t tensor(-0.2749, dtype=torch.float64)
7 gae_duplicate tensor(-3.0024, dtype=torch.float64) tensor(10.1102, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1052, dtype=torch.float64) delta_t tensor(-0.1604, dtype=torch.float64)
6 gae_duplicate tensor(-1.8280, dtype=torch.float64) tensor(4.5622, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4237, dtype=torch.float64) delta_t tensor(-0.6024, dtype=torch.float64)
5 gae_duplicate tensor(-2.7811, dtype=torch.float64) tensor(12.5628, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2376, dtype=torch.float64) delta_t tensor(0.0652, dtype=torch.float64)
4 gae_duplicate tensor(-0.4622, dtype=torch.float64) tensor(-0.0981, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3098, dtype=torch.float64) delta_t tensor(0.2100, dtype=torch.float64)
3 gae_duplicate tensor(-0.1381, dtype=torch.float64) tensor(-3.8456, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4957, dtype=torch.float64) delta_t tensor(-0.6221, dtype=torch.float64)
2 gae_duplicate tensor(-1.1527, dtype=torch.float64) tensor(11.6084, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1004.0938720703125
value loss:229.78384399414062
entropies:353.4078063964844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.925047874450684 seconds
19 rew tensor(0.8954, dtype=torch.float64) delta_t tensor(0.6746, dtype=torch.float64)
19 gae_duplicate tensor(0.5998, dtype=torch.float64) tensor(-13.6120, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8806, dtype=torch.float64) delta_t tensor(0.6922, dtype=torch.float64)
18 gae_duplicate tensor(0.6623, dtype=torch.float64) tensor(-14.6934, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8009, dtype=torch.float64) delta_t tensor(0.6108, dtype=torch.float64)
17 gae_duplicate tensor(0.4607, dtype=torch.float64) tensor(-13.5042, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4884, dtype=torch.float64) delta_t tensor(0.3002, dtype=torch.float64)
16 gae_duplicate tensor(-0.5390, dtype=torch.float64) tensor(-6.9329, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7236, dtype=torch.float64) delta_t tensor(0.5354, dtype=torch.float64)
15 gae_duplicate tensor(0.1355, dtype=torch.float64) tensor(-11.8488, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3772, dtype=torch.float64) delta_t tensor(0.2084, dtype=torch.float64)
14 gae_duplicate tensor(-0.9525, dtype=torch.float64) tensor(-4.9588, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6884, dtype=torch.float64) delta_t tensor(0.5213, dtype=torch.float64)
13 gae_duplicate tensor(0.3178, dtype=torch.float64) tensor(-10.7505, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4302, dtype=torch.float64) delta_t tensor(0.2706, dtype=torch.float64)
12 gae_duplicate tensor(-0.7841, dtype=torch.float64) tensor(-6.2205, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3732, dtype=torch.float64) delta_t tensor(0.2604, dtype=torch.float64)
11 gae_duplicate tensor(-0.7814, dtype=torch.float64) tensor(-5.1671, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0357, dtype=torch.float64) delta_t tensor(-0.1101, dtype=torch.float64)
10 gae_duplicate tensor(-1.0434, dtype=torch.float64) tensor(1.5810, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7469, dtype=torch.float64) delta_t tensor(-0.8257, dtype=torch.float64)
9 gae_duplicate tensor(-5.0172, dtype=torch.float64) tensor(14.6248, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1238, dtype=torch.float64) delta_t tensor(-0.2012, dtype=torch.float64)
8 gae_duplicate tensor(-2.3264, dtype=torch.float64) tensor(5.1792, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5212, dtype=torch.float64) delta_t tensor(-0.5198, dtype=torch.float64)
7 gae_duplicate tensor(-1.9868, dtype=torch.float64) tensor(11.2469, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5216, dtype=torch.float64) delta_t tensor(-0.5993, dtype=torch.float64)
6 gae_duplicate tensor(-2.9679, dtype=torch.float64) tensor(12.0840, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2597, dtype=torch.float64) delta_t tensor(-0.3617, dtype=torch.float64)
5 gae_duplicate tensor(-2.1267, dtype=torch.float64) tensor(9.2092, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1084, dtype=torch.float64) delta_t tensor(-0.0367, dtype=torch.float64)
4 gae_duplicate tensor(-1.0650, dtype=torch.float64) tensor(1.6075, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0407, dtype=torch.float64) delta_t tensor(-0.0606, dtype=torch.float64)
3 gae_duplicate tensor(-0.9089, dtype=torch.float64) tensor(1.0429, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3002, dtype=torch.float64) delta_t tensor(-0.4341, dtype=torch.float64)
2 gae_duplicate tensor(-1.4571, dtype=torch.float64) tensor(9.0466, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1096.3206787109375
value loss:140.01925659179688
entropies:352.76898193359375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3982.5901)
ToM Target loss= tensor(3526.0222)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.5020740032196045 seconds
19 rew tensor(0.8216, dtype=torch.float64) delta_t tensor(0.5807, dtype=torch.float64)
19 gae_duplicate tensor(0.5124, dtype=torch.float64) tensor(-11.0337, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5776, dtype=torch.float64) delta_t tensor(0.3658, dtype=torch.float64)
18 gae_duplicate tensor(-0.5447, dtype=torch.float64) tensor(-8.9568, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5028, dtype=torch.float64) delta_t tensor(0.2850, dtype=torch.float64)
17 gae_duplicate tensor(-0.8328, dtype=torch.float64) tensor(-6.5807, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7133, dtype=torch.float64) delta_t tensor(0.5090, dtype=torch.float64)
16 gae_duplicate tensor(0.3265, dtype=torch.float64) tensor(-10.4946, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4998, dtype=torch.float64) delta_t tensor(0.3004, dtype=torch.float64)
15 gae_duplicate tensor(-0.3771, dtype=torch.float64) tensor(-6.5959, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6492, dtype=torch.float64) delta_t tensor(0.4504, dtype=torch.float64)
14 gae_duplicate tensor(0.3499, dtype=torch.float64) tensor(-9.6161, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2147, dtype=torch.float64) delta_t tensor(0.0179, dtype=torch.float64)
13 gae_duplicate tensor(-0.9132, dtype=torch.float64) tensor(-1.0629, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3830, dtype=torch.float64) delta_t tensor(0.1961, dtype=torch.float64)
12 gae_duplicate tensor(-0.9027, dtype=torch.float64) tensor(-4.4710, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0392, dtype=torch.float64) delta_t tensor(-0.1357, dtype=torch.float64)
11 gae_duplicate tensor(-1.7969, dtype=torch.float64) tensor(1.4729, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0682, dtype=torch.float64) delta_t tensor(-0.0891, dtype=torch.float64)
10 gae_duplicate tensor(-1.0097, dtype=torch.float64) tensor(1.5926, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3802, dtype=torch.float64) delta_t tensor(-1.5357, dtype=torch.float64)
9 gae_duplicate tensor(-4.2203, dtype=torch.float64) tensor(29.8146, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.6247, dtype=torch.float64) delta_t tensor(-2.7614, dtype=torch.float64)
8 gae_duplicate tensor(-4.3157, dtype=torch.float64) tensor(54.4282, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2119, dtype=torch.float64) delta_t tensor(-0.3372, dtype=torch.float64)
7 gae_duplicate tensor(-3.3754, dtype=torch.float64) tensor(14.0586, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4229, dtype=torch.float64) delta_t tensor(-0.5314, dtype=torch.float64)
6 gae_duplicate tensor(-2.7772, dtype=torch.float64) tensor(11.7164, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2897, dtype=torch.float64) delta_t tensor(-0.4365, dtype=torch.float64)
5 gae_duplicate tensor(-3.3631, dtype=torch.float64) tensor(8.9821, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3243, dtype=torch.float64) delta_t tensor(0.1277, dtype=torch.float64)
4 gae_duplicate tensor(-0.2310, dtype=torch.float64) tensor(-1.3028, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0219, dtype=torch.float64) delta_t tensor(-0.0989, dtype=torch.float64)
3 gae_duplicate tensor(-1.0906, dtype=torch.float64) tensor(1.5085, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2354, dtype=torch.float64) delta_t tensor(-0.3626, dtype=torch.float64)
2 gae_duplicate tensor(-0.8485, dtype=torch.float64) tensor(7.0318, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3901.72802734375
value loss:237.4069061279297
entropies:352.58551025390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.262028932571411 seconds
19 rew tensor(0.8323, dtype=torch.float64) delta_t tensor(0.5558, dtype=torch.float64)
19 gae_duplicate tensor(0.4581, dtype=torch.float64) tensor(-11.1689, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8055, dtype=torch.float64) delta_t tensor(0.5683, dtype=torch.float64)
18 gae_duplicate tensor(0.4441, dtype=torch.float64) tensor(-12.1532, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8180, dtype=torch.float64) delta_t tensor(0.5809, dtype=torch.float64)
17 gae_duplicate tensor(0.4838, dtype=torch.float64) tensor(-11.7608, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6712, dtype=torch.float64) delta_t tensor(0.4486, dtype=torch.float64)
16 gae_duplicate tensor(0.3614, dtype=torch.float64) tensor(-9.9681, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7381, dtype=torch.float64) delta_t tensor(0.4990, dtype=torch.float64)
15 gae_duplicate tensor(0.3484, dtype=torch.float64) tensor(-10.3057, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4456, dtype=torch.float64) delta_t tensor(0.2275, dtype=torch.float64)
14 gae_duplicate tensor(-0.8657, dtype=torch.float64) tensor(-5.3739, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4597, dtype=torch.float64) delta_t tensor(0.2330, dtype=torch.float64)
13 gae_duplicate tensor(-0.7182, dtype=torch.float64) tensor(-4.6924, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1736, dtype=torch.float64) delta_t tensor(-0.0312, dtype=torch.float64)
12 gae_duplicate tensor(-0.9720, dtype=torch.float64) tensor(-0.5887, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0410, dtype=torch.float64) delta_t tensor(-0.1019, dtype=torch.float64)
11 gae_duplicate tensor(-1.0300, dtype=torch.float64) tensor(1.8839, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2188, dtype=torch.float64) delta_t tensor(-0.3613, dtype=torch.float64)
10 gae_duplicate tensor(-1.0396, dtype=torch.float64) tensor(7.1524, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9033, dtype=torch.float64) delta_t tensor(-1.0089, dtype=torch.float64)
9 gae_duplicate tensor(-6.5779, dtype=torch.float64) tensor(18.5068, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3525, dtype=torch.float64) delta_t tensor(0.2274, dtype=torch.float64)
8 gae_duplicate tensor(-0.1556, dtype=torch.float64) tensor(-2.1596, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8379, dtype=torch.float64) delta_t tensor(-0.8589, dtype=torch.float64)
7 gae_duplicate tensor(-3.1225, dtype=torch.float64) tensor(18.0929, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5399, dtype=torch.float64) delta_t tensor(-0.6547, dtype=torch.float64)
6 gae_duplicate tensor(-2.8320, dtype=torch.float64) tensor(14.1428, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4071, dtype=torch.float64) delta_t tensor(-0.5416, dtype=torch.float64)
5 gae_duplicate tensor(-2.0227, dtype=torch.float64) tensor(12.3923, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1129, dtype=torch.float64) delta_t tensor(-0.0601, dtype=torch.float64)
4 gae_duplicate tensor(-0.6381, dtype=torch.float64) tensor(1.9170, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0535, dtype=torch.float64) delta_t tensor(-0.1907, dtype=torch.float64)
3 gae_duplicate tensor(-0.8882, dtype=torch.float64) tensor(3.8484, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2054, dtype=torch.float64) delta_t tensor(-0.3538, dtype=torch.float64)
2 gae_duplicate tensor(-0.8798, dtype=torch.float64) tensor(6.6402, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-981.1917724609375
value loss:162.50152587890625
entropies:352.969482421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.834843873977661 seconds
19 rew tensor(0.8313, dtype=torch.float64) delta_t tensor(0.5480, dtype=torch.float64)
19 gae_duplicate tensor(0.3566, dtype=torch.float64) tensor(-10.5604, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7493, dtype=torch.float64) delta_t tensor(0.4972, dtype=torch.float64)
18 gae_duplicate tensor(0.4316, dtype=torch.float64) tensor(-10.9354, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7480, dtype=torch.float64) delta_t tensor(0.4970, dtype=torch.float64)
17 gae_duplicate tensor(0.3601, dtype=torch.float64) tensor(-10.7465, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4676, dtype=torch.float64) delta_t tensor(0.2172, dtype=torch.float64)
16 gae_duplicate tensor(-0.5026, dtype=torch.float64) tensor(-5.6800, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6660, dtype=torch.float64) delta_t tensor(0.4211, dtype=torch.float64)
15 gae_duplicate tensor(0.0866, dtype=torch.float64) tensor(-8.5658, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3481, dtype=torch.float64) delta_t tensor(0.1095, dtype=torch.float64)
14 gae_duplicate tensor(-1.2382, dtype=torch.float64) tensor(-3.0164, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6857, dtype=torch.float64) delta_t tensor(0.4802, dtype=torch.float64)
13 gae_duplicate tensor(0.2542, dtype=torch.float64) tensor(-9.1719, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1451, dtype=torch.float64) delta_t tensor(-0.0536, dtype=torch.float64)
12 gae_duplicate tensor(-1.3225, dtype=torch.float64) tensor(0.0451, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3225, dtype=torch.float64) delta_t tensor(-0.4669, dtype=torch.float64)
11 gae_duplicate tensor(-1.8439, dtype=torch.float64) tensor(9.6098, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2526, dtype=torch.float64) delta_t tensor(-0.4099, dtype=torch.float64)
10 gae_duplicate tensor(-1.2257, dtype=torch.float64) tensor(8.7608, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4550, dtype=torch.float64) delta_t tensor(-1.5530, dtype=torch.float64)
9 gae_duplicate tensor(-3.0371, dtype=torch.float64) tensor(30.7111, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3224, dtype=torch.float64) delta_t tensor(0.2078, dtype=torch.float64)
8 gae_duplicate tensor(-0.3141, dtype=torch.float64) tensor(-1.1440, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4758, dtype=torch.float64) delta_t tensor(-0.5123, dtype=torch.float64)
7 gae_duplicate tensor(-2.3827, dtype=torch.float64) tensor(10.1272, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4453, dtype=torch.float64) delta_t tensor(-0.5600, dtype=torch.float64)
6 gae_duplicate tensor(-3.3658, dtype=torch.float64) tensor(11.3749, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1461, dtype=torch.float64) delta_t tensor(-0.3229, dtype=torch.float64)
5 gae_duplicate tensor(-1.2127, dtype=torch.float64) tensor(8.1957, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1361, dtype=torch.float64) delta_t tensor(-0.0545, dtype=torch.float64)
4 gae_duplicate tensor(-1.0310, dtype=torch.float64) tensor(2.0265, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0432, dtype=torch.float64) delta_t tensor(-0.1127, dtype=torch.float64)
3 gae_duplicate tensor(-0.8889, dtype=torch.float64) tensor(2.5811, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2550, dtype=torch.float64) delta_t tensor(-0.4274, dtype=torch.float64)
2 gae_duplicate tensor(-1.0816, dtype=torch.float64) tensor(8.4754, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1828.0758056640625
value loss:113.38727569580078
entropies:353.2230224609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.936513185501099 seconds
19 rew tensor(0.8833, dtype=torch.float64) delta_t tensor(0.5700, dtype=torch.float64)
19 gae_duplicate tensor(0.4921, dtype=torch.float64) tensor(-11.3330, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6049, dtype=torch.float64) delta_t tensor(0.3277, dtype=torch.float64)
18 gae_duplicate tensor(-0.6932, dtype=torch.float64) tensor(-7.4687, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8446, dtype=torch.float64) delta_t tensor(0.5644, dtype=torch.float64)
17 gae_duplicate tensor(0.4645, dtype=torch.float64) tensor(-11.7511, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7117, dtype=torch.float64) delta_t tensor(0.4496, dtype=torch.float64)
16 gae_duplicate tensor(0.4063, dtype=torch.float64) tensor(-9.5671, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5215, dtype=torch.float64) delta_t tensor(0.2482, dtype=torch.float64)
15 gae_duplicate tensor(-0.8946, dtype=torch.float64) tensor(-5.7363, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2180, dtype=torch.float64) delta_t tensor(-0.0286, dtype=torch.float64)
14 gae_duplicate tensor(-0.8732, dtype=torch.float64) tensor(0.3375, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7074, dtype=torch.float64) delta_t tensor(0.4515, dtype=torch.float64)
13 gae_duplicate tensor(0.2199, dtype=torch.float64) tensor(-8.6563, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1152, dtype=torch.float64) delta_t tensor(-0.1142, dtype=torch.float64)
12 gae_duplicate tensor(-1.1974, dtype=torch.float64) tensor(1.0811, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0663, dtype=torch.float64) delta_t tensor(-0.1542, dtype=torch.float64)
11 gae_duplicate tensor(-1.4950, dtype=torch.float64) tensor(2.6144, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1832, dtype=torch.float64) delta_t tensor(-0.0153, dtype=torch.float64)
10 gae_duplicate tensor(-1.4010, dtype=torch.float64) tensor(0.6640, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4857, dtype=torch.float64) delta_t tensor(-1.6838, dtype=torch.float64)
9 gae_duplicate tensor(-5.9723, dtype=torch.float64) tensor(36.1266, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9106, dtype=torch.float64) delta_t tensor(-1.0479, dtype=torch.float64)
8 gae_duplicate tensor(-3.0850, dtype=torch.float64) tensor(22.9001, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0839, dtype=torch.float64) delta_t tensor(-0.1060, dtype=torch.float64)
7 gae_duplicate tensor(-1.9314, dtype=torch.float64) tensor(3.9287, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1884, dtype=torch.float64) delta_t tensor(-0.2968, dtype=torch.float64)
6 gae_duplicate tensor(-0.9500, dtype=torch.float64) tensor(5.8112, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1480, dtype=torch.float64) delta_t tensor(-0.0922, dtype=torch.float64)
5 gae_duplicate tensor(-1.0409, dtype=torch.float64) tensor(2.5559, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1448, dtype=torch.float64) delta_t tensor(-0.0865, dtype=torch.float64)
4 gae_duplicate tensor(-0.6935, dtype=torch.float64) tensor(1.9430, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2734, dtype=torch.float64) delta_t tensor(0.0866, dtype=torch.float64)
3 gae_duplicate tensor(-0.6281, dtype=torch.float64) tensor(-1.2001, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3945, dtype=torch.float64) delta_t tensor(-0.5945, dtype=torch.float64)
2 gae_duplicate tensor(-1.1325, dtype=torch.float64) tensor(12.3649, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1964.5390625
value loss:150.5869598388672
entropies:353.1083984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.733703851699829 seconds
19 rew tensor(0.8955, dtype=torch.float64) delta_t tensor(0.5582, dtype=torch.float64)
19 gae_duplicate tensor(0.4890, dtype=torch.float64) tensor(-11.1952, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8439, dtype=torch.float64) delta_t tensor(0.5626, dtype=torch.float64)
18 gae_duplicate tensor(0.4467, dtype=torch.float64) tensor(-12.1269, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8201, dtype=torch.float64) delta_t tensor(0.5213, dtype=torch.float64)
17 gae_duplicate tensor(0.5458, dtype=torch.float64) tensor(-11.2501, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5932, dtype=torch.float64) delta_t tensor(0.3517, dtype=torch.float64)
16 gae_duplicate tensor(0.2366, dtype=torch.float64) tensor(-7.8385, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7278, dtype=torch.float64) delta_t tensor(0.4291, dtype=torch.float64)
15 gae_duplicate tensor(0.3071, dtype=torch.float64) tensor(-9.0986, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2690, dtype=torch.float64) delta_t tensor(0.0657, dtype=torch.float64)
14 gae_duplicate tensor(-0.7714, dtype=torch.float64) tensor(-2.0395, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5279, dtype=torch.float64) delta_t tensor(0.2585, dtype=torch.float64)
13 gae_duplicate tensor(-0.9202, dtype=torch.float64) tensor(-5.2336, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0503, dtype=torch.float64) delta_t tensor(-0.1118, dtype=torch.float64)
12 gae_duplicate tensor(-1.3534, dtype=torch.float64) tensor(1.8149, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0232, dtype=torch.float64) delta_t tensor(-0.2183, dtype=torch.float64)
11 gae_duplicate tensor(-0.9704, dtype=torch.float64) tensor(4.0148, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3575, dtype=torch.float64) delta_t tensor(-0.4929, dtype=torch.float64)
10 gae_duplicate tensor(-1.1140, dtype=torch.float64) tensor(9.6592, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4868, dtype=torch.float64) delta_t tensor(-0.7055, dtype=torch.float64)
9 gae_duplicate tensor(-2.6899, dtype=torch.float64) tensor(13.8214, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9004, dtype=torch.float64) delta_t tensor(-0.9597, dtype=torch.float64)
8 gae_duplicate tensor(-5.9029, dtype=torch.float64) tensor(20.2458, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0539, dtype=torch.float64) delta_t tensor(-0.1069, dtype=torch.float64)
7 gae_duplicate tensor(-2.1026, dtype=torch.float64) tensor(3.7984, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6988, dtype=torch.float64) delta_t tensor(-0.7339, dtype=torch.float64)
6 gae_duplicate tensor(-2.5038, dtype=torch.float64) tensor(15.1762, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2406, dtype=torch.float64) delta_t tensor(-0.0163, dtype=torch.float64)
5 gae_duplicate tensor(-1.1794, dtype=torch.float64) tensor(1.8063, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3610, dtype=torch.float64) delta_t tensor(-0.4916, dtype=torch.float64)
4 gae_duplicate tensor(-1.2040, dtype=torch.float64) tensor(9.6648, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3854, dtype=torch.float64) delta_t tensor(0.2583, dtype=torch.float64)
3 gae_duplicate tensor(-1.1897, dtype=torch.float64) tensor(-4.5915, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4960, dtype=torch.float64) delta_t tensor(-0.6222, dtype=torch.float64)
2 gae_duplicate tensor(-1.1609, dtype=torch.float64) tensor(12.4079, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1663.179443359375
value loss:133.081787109375
entropies:352.7805480957031
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3945.8872)
ToM Target loss= tensor(3540.6382)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.987475872039795 seconds
19 rew tensor(0.8684, dtype=torch.float64) delta_t tensor(0.5208, dtype=torch.float64)
19 gae_duplicate tensor(0.4499, dtype=torch.float64) tensor(-9.4616, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8525, dtype=torch.float64) delta_t tensor(0.5475, dtype=torch.float64)
18 gae_duplicate tensor(0.4269, dtype=torch.float64) tensor(-11.5169, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8324, dtype=torch.float64) delta_t tensor(0.5200, dtype=torch.float64)
17 gae_duplicate tensor(0.4966, dtype=torch.float64) tensor(-11.0194, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6680, dtype=torch.float64) delta_t tensor(0.3936, dtype=torch.float64)
16 gae_duplicate tensor(0.3605, dtype=torch.float64) tensor(-8.9109, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7026, dtype=torch.float64) delta_t tensor(0.4010, dtype=torch.float64)
15 gae_duplicate tensor(0.2664, dtype=torch.float64) tensor(-8.7328, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5274, dtype=torch.float64) delta_t tensor(0.2841, dtype=torch.float64)
14 gae_duplicate tensor(0.1168, dtype=torch.float64) tensor(-6.2237, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7670, dtype=torch.float64) delta_t tensor(0.4763, dtype=torch.float64)
13 gae_duplicate tensor(0.4318, dtype=torch.float64) tensor(-9.9077, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4012, dtype=torch.float64) delta_t tensor(0.2067, dtype=torch.float64)
12 gae_duplicate tensor(0.0150, dtype=torch.float64) tensor(-4.7793, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2604, dtype=torch.float64) delta_t tensor(-0.4731, dtype=torch.float64)
11 gae_duplicate tensor(-0.9955, dtype=torch.float64) tensor(7.8702, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4272, dtype=torch.float64) delta_t tensor(-0.5970, dtype=torch.float64)
10 gae_duplicate tensor(-1.6710, dtype=torch.float64) tensor(12.3708, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.1273, dtype=torch.float64) delta_t tensor(-2.3065, dtype=torch.float64)
9 gae_duplicate tensor(-5.6725, dtype=torch.float64) tensor(46.3255, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0920, dtype=torch.float64) delta_t tensor(-0.1989, dtype=torch.float64)
8 gae_duplicate tensor(-1.1632, dtype=torch.float64) tensor(8.4935, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0103, dtype=torch.float64) delta_t tensor(-0.1338, dtype=torch.float64)
7 gae_duplicate tensor(-2.2260, dtype=torch.float64) tensor(3.8601, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2565, dtype=torch.float64) delta_t tensor(-0.3469, dtype=torch.float64)
6 gae_duplicate tensor(-0.8690, dtype=torch.float64) tensor(7.5509, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2201, dtype=torch.float64) delta_t tensor(-0.4705, dtype=torch.float64)
5 gae_duplicate tensor(-2.8172, dtype=torch.float64) tensor(9.8403, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0817, dtype=torch.float64) delta_t tensor(-0.2558, dtype=torch.float64)
4 gae_duplicate tensor(-0.9450, dtype=torch.float64) tensor(5.5157, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3975, dtype=torch.float64) delta_t tensor(0.2105, dtype=torch.float64)
3 gae_duplicate tensor(-0.3323, dtype=torch.float64) tensor(-3.5762, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4673, dtype=torch.float64) delta_t tensor(-0.6121, dtype=torch.float64)
2 gae_duplicate tensor(-1.0344, dtype=torch.float64) tensor(11.2928, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2200.764892578125
value loss:172.53060913085938
entropies:352.7143249511719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.324425935745239 seconds
19 rew tensor(0.8703, dtype=torch.float64) delta_t tensor(0.5256, dtype=torch.float64)
19 gae_duplicate tensor(0.4298, dtype=torch.float64) tensor(-10.3236, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8579, dtype=torch.float64) delta_t tensor(0.5463, dtype=torch.float64)
18 gae_duplicate tensor(0.4377, dtype=torch.float64) tensor(-12.0597, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7478, dtype=torch.float64) delta_t tensor(0.4572, dtype=torch.float64)
17 gae_duplicate tensor(0.3078, dtype=torch.float64) tensor(-10.3793, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4711, dtype=torch.float64) delta_t tensor(0.1684, dtype=torch.float64)
16 gae_duplicate tensor(-0.6357, dtype=torch.float64) tensor(-3.8489, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5628, dtype=torch.float64) delta_t tensor(0.2867, dtype=torch.float64)
15 gae_duplicate tensor(0.0197, dtype=torch.float64) tensor(-6.0703, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4488, dtype=torch.float64) delta_t tensor(0.1699, dtype=torch.float64)
14 gae_duplicate tensor(-0.6575, dtype=torch.float64) tensor(-4.0282, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0126, dtype=torch.float64) delta_t tensor(-0.2163, dtype=torch.float64)
13 gae_duplicate tensor(-1.3442, dtype=torch.float64) tensor(4.1476, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5948, dtype=torch.float64) delta_t tensor(0.3487, dtype=torch.float64)
12 gae_duplicate tensor(-0.1249, dtype=torch.float64) tensor(-6.7084, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1289, dtype=torch.float64) delta_t tensor(-0.2380, dtype=torch.float64)
11 gae_duplicate tensor(-1.6996, dtype=torch.float64) tensor(3.4793, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4909, dtype=torch.float64) delta_t tensor(-0.6788, dtype=torch.float64)
10 gae_duplicate tensor(-1.4467, dtype=torch.float64) tensor(13.3908, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1927, dtype=torch.float64) delta_t tensor(-1.2244, dtype=torch.float64)
9 gae_duplicate tensor(-4.7138, dtype=torch.float64) tensor(26.0302, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3460, dtype=torch.float64) delta_t tensor(-0.5272, dtype=torch.float64)
8 gae_duplicate tensor(-4.5431, dtype=torch.float64) tensor(11.7410, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1482, dtype=torch.float64) delta_t tensor(-1.0923, dtype=torch.float64)
7 gae_duplicate tensor(-3.3096, dtype=torch.float64) tensor(23.9293, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1542, dtype=torch.float64) delta_t tensor(-0.0344, dtype=torch.float64)
6 gae_duplicate tensor(-1.4518, dtype=torch.float64) tensor(3.2707, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4153, dtype=torch.float64) delta_t tensor(-0.5267, dtype=torch.float64)
5 gae_duplicate tensor(-1.3335, dtype=torch.float64) tensor(9.9698, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4863, dtype=torch.float64) delta_t tensor(0.3016, dtype=torch.float64)
4 gae_duplicate tensor(-0.4638, dtype=torch.float64) tensor(-4.8384, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2942, dtype=torch.float64) delta_t tensor(-0.3955, dtype=torch.float64)
3 gae_duplicate tensor(-1.0755, dtype=torch.float64) tensor(7.5469, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0339, dtype=torch.float64) delta_t tensor(-0.1856, dtype=torch.float64)
2 gae_duplicate tensor(-0.8524, dtype=torch.float64) tensor(4.0352, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2756.540771484375
value loss:147.2682342529297
entropies:352.63385009765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.5261170864105225 seconds
19 rew tensor(0.8676, dtype=torch.float64) delta_t tensor(0.5076, dtype=torch.float64)
19 gae_duplicate tensor(0.4508, dtype=torch.float64) tensor(-9.8423, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8002, dtype=torch.float64) delta_t tensor(0.4853, dtype=torch.float64)
18 gae_duplicate tensor(0.3822, dtype=torch.float64) tensor(-9.9072, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7562, dtype=torch.float64) delta_t tensor(0.4400, dtype=torch.float64)
17 gae_duplicate tensor(0.3777, dtype=torch.float64) tensor(-9.8634, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6639, dtype=torch.float64) delta_t tensor(0.3675, dtype=torch.float64)
16 gae_duplicate tensor(0.2158, dtype=torch.float64) tensor(-8.4425, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6148, dtype=torch.float64) delta_t tensor(0.3209, dtype=torch.float64)
15 gae_duplicate tensor(0.2192, dtype=torch.float64) tensor(-7.0883, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1953, dtype=torch.float64) delta_t tensor(-0.0482, dtype=torch.float64)
14 gae_duplicate tensor(-0.8131, dtype=torch.float64) tensor(0.6534, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5768, dtype=torch.float64) delta_t tensor(0.3298, dtype=torch.float64)
13 gae_duplicate tensor(0.0513, dtype=torch.float64) tensor(-6.5578, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3014, dtype=torch.float64) delta_t tensor(0.0747, dtype=torch.float64)
12 gae_duplicate tensor(-1.0549, dtype=torch.float64) tensor(-2.3587, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0601, dtype=torch.float64) delta_t tensor(-0.2820, dtype=torch.float64)
11 gae_duplicate tensor(-1.7931, dtype=torch.float64) tensor(5.5381, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0226, dtype=torch.float64) delta_t tensor(-0.1960, dtype=torch.float64)
10 gae_duplicate tensor(-1.4283, dtype=torch.float64) tensor(4.0168, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.1068, dtype=torch.float64) delta_t tensor(-2.3055, dtype=torch.float64)
9 gae_duplicate tensor(-5.1516, dtype=torch.float64) tensor(47.5655, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.9766, dtype=torch.float64) delta_t tensor(-2.1177, dtype=torch.float64)
8 gae_duplicate tensor(-4.0206, dtype=torch.float64) tensor(45.5859, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4437, dtype=torch.float64) delta_t tensor(-0.5967, dtype=torch.float64)
7 gae_duplicate tensor(-3.1064, dtype=torch.float64) tensor(16.7773, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1730, dtype=torch.float64) delta_t tensor(0.0749, dtype=torch.float64)
6 gae_duplicate tensor(-0.4253, dtype=torch.float64) tensor(0.2199, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1550, dtype=torch.float64) delta_t tensor(-0.3881, dtype=torch.float64)
5 gae_duplicate tensor(-2.6299, dtype=torch.float64) tensor(7.7059, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1099, dtype=torch.float64) delta_t tensor(-0.0614, dtype=torch.float64)
4 gae_duplicate tensor(-0.8673, dtype=torch.float64) tensor(2.0444, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3274, dtype=torch.float64) delta_t tensor(0.1803, dtype=torch.float64)
3 gae_duplicate tensor(-0.1599, dtype=torch.float64) tensor(-3.4121, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3923, dtype=torch.float64) delta_t tensor(-0.5505, dtype=torch.float64)
2 gae_duplicate tensor(-0.9977, dtype=torch.float64) tensor(10.7137, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4596.0234375
value loss:210.60992431640625
entropies:352.5782775878906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.789813995361328 seconds
19 rew tensor(0.8134, dtype=torch.float64) delta_t tensor(0.4543, dtype=torch.float64)
19 gae_duplicate tensor(0.3689, dtype=torch.float64) tensor(-8.3084, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(0.4958, dtype=torch.float64)
18 gae_duplicate tensor(0.4818, dtype=torch.float64) tensor(-10.8558, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7268, dtype=torch.float64) delta_t tensor(0.4014, dtype=torch.float64)
17 gae_duplicate tensor(0.4258, dtype=torch.float64) tensor(-8.6248, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4709, dtype=torch.float64) delta_t tensor(0.1933, dtype=torch.float64)
16 gae_duplicate tensor(-0.8392, dtype=torch.float64) tensor(-4.1910, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6645, dtype=torch.float64) delta_t tensor(0.3324, dtype=torch.float64)
15 gae_duplicate tensor(0.2751, dtype=torch.float64) tensor(-6.7644, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3278, dtype=torch.float64) delta_t tensor(0.1148, dtype=torch.float64)
14 gae_duplicate tensor(-0.9595, dtype=torch.float64) tensor(-2.7060, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4668, dtype=torch.float64) delta_t tensor(0.1525, dtype=torch.float64)
13 gae_duplicate tensor(-1.0313, dtype=torch.float64) tensor(-3.4303, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3554, dtype=torch.float64) delta_t tensor(0.1700, dtype=torch.float64)
12 gae_duplicate tensor(0.0304, dtype=torch.float64) tensor(-3.7355, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.9392, dtype=torch.float64) delta_t tensor(-1.2359, dtype=torch.float64)
11 gae_duplicate tensor(-2.0787, dtype=torch.float64) tensor(23.5139, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2686, dtype=torch.float64) delta_t tensor(0.1493, dtype=torch.float64)
10 gae_duplicate tensor(-0.3099, dtype=torch.float64) tensor(-0.3711, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7428, dtype=torch.float64) delta_t tensor(-1.0045, dtype=torch.float64)
9 gae_duplicate tensor(-3.6135, dtype=torch.float64) tensor(19.0198, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.8343, dtype=torch.float64) delta_t tensor(-1.8772, dtype=torch.float64)
8 gae_duplicate tensor(-5.3285, dtype=torch.float64) tensor(42.6424, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0980, dtype=torch.float64) delta_t tensor(-0.1413, dtype=torch.float64)
7 gae_duplicate tensor(-1.3867, dtype=torch.float64) tensor(7.1326, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0594, dtype=torch.float64) delta_t tensor(-0.0999, dtype=torch.float64)
6 gae_duplicate tensor(-0.4914, dtype=torch.float64) tensor(2.8035, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4787, dtype=torch.float64) delta_t tensor(0.2347, dtype=torch.float64)
5 gae_duplicate tensor(0.0972, dtype=torch.float64) tensor(-4.4157, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0760, dtype=torch.float64) delta_t tensor(-0.2513, dtype=torch.float64)
4 gae_duplicate tensor(-0.6243, dtype=torch.float64) tensor(4.3720, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4022, dtype=torch.float64) delta_t tensor(0.2659, dtype=torch.float64)
3 gae_duplicate tensor(-0.0038, dtype=torch.float64) tensor(-4.5534, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4892, dtype=torch.float64) delta_t tensor(-0.6406, dtype=torch.float64)
2 gae_duplicate tensor(-0.8931, dtype=torch.float64) tensor(12.5731, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3016.546142578125
value loss:138.17025756835938
entropies:352.2223205566406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9331769943237305 seconds
19 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.4505, dtype=torch.float64)
19 gae_duplicate tensor(0.3231, dtype=torch.float64) tensor(-8.7322, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5407, dtype=torch.float64) delta_t tensor(0.2229, dtype=torch.float64)
18 gae_duplicate tensor(-0.8994, dtype=torch.float64) tensor(-5.8651, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7618, dtype=torch.float64) delta_t tensor(0.4425, dtype=torch.float64)
17 gae_duplicate tensor(0.3921, dtype=torch.float64) tensor(-9.3260, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6884, dtype=torch.float64) delta_t tensor(0.3685, dtype=torch.float64)
16 gae_duplicate tensor(0.2441, dtype=torch.float64) tensor(-7.6184, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6750, dtype=torch.float64) delta_t tensor(0.3742, dtype=torch.float64)
15 gae_duplicate tensor(0.2513, dtype=torch.float64) tensor(-8.0448, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2741, dtype=torch.float64) delta_t tensor(-0.0225, dtype=torch.float64)
14 gae_duplicate tensor(-0.8763, dtype=torch.float64) tensor(-0.1213, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5915, dtype=torch.float64) delta_t tensor(0.3494, dtype=torch.float64)
13 gae_duplicate tensor(0.0955, dtype=torch.float64) tensor(-7.0819, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6294, dtype=torch.float64) delta_t tensor(0.3873, dtype=torch.float64)
12 gae_duplicate tensor(0.2651, dtype=torch.float64) tensor(-8.4439, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0025, dtype=torch.float64) delta_t tensor(-0.1454, dtype=torch.float64)
11 gae_duplicate tensor(-1.5113, dtype=torch.float64) tensor(1.7881, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0319, dtype=torch.float64) delta_t tensor(-0.2256, dtype=torch.float64)
10 gae_duplicate tensor(-1.2854, dtype=torch.float64) tensor(4.1909, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.9175, dtype=torch.float64) delta_t tensor(-1.9803, dtype=torch.float64)
9 gae_duplicate tensor(-3.4368, dtype=torch.float64) tensor(37.7853, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1740, dtype=torch.float64) delta_t tensor(-1.3264, dtype=torch.float64)
8 gae_duplicate tensor(-6.0476, dtype=torch.float64) tensor(26.6124, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4013, dtype=torch.float64) delta_t tensor(-0.3942, dtype=torch.float64)
7 gae_duplicate tensor(-1.4830, dtype=torch.float64) tensor(10.9412, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1547, dtype=torch.float64) delta_t tensor(0.0344, dtype=torch.float64)
6 gae_duplicate tensor(-0.8734, dtype=torch.float64) tensor(0.3146, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1315, dtype=torch.float64) delta_t tensor(-0.1950, dtype=torch.float64)
5 gae_duplicate tensor(-0.8399, dtype=torch.float64) tensor(3.9782, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4049, dtype=torch.float64) delta_t tensor(0.2862, dtype=torch.float64)
4 gae_duplicate tensor(-0.4325, dtype=torch.float64) tensor(-4.8465, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0888, dtype=torch.float64) delta_t tensor(-0.1718, dtype=torch.float64)
3 gae_duplicate tensor(-0.5878, dtype=torch.float64) tensor(2.7556, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2099, dtype=torch.float64) delta_t tensor(-0.3067, dtype=torch.float64)
2 gae_duplicate tensor(-1.0889, dtype=torch.float64) tensor(5.7967, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1935.3912353515625
value loss:156.98167419433594
entropies:351.53253173828125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3934.2129)
ToM Target loss= tensor(3553.1665)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.679119110107422 seconds
19 rew tensor(0.8688, dtype=torch.float64) delta_t tensor(0.5074, dtype=torch.float64)
19 gae_duplicate tensor(0.4513, dtype=torch.float64) tensor(-10.1679, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7612, dtype=torch.float64) delta_t tensor(0.4327, dtype=torch.float64)
18 gae_duplicate tensor(0.4013, dtype=torch.float64) tensor(-10.0300, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7268, dtype=torch.float64) delta_t tensor(0.4109, dtype=torch.float64)
17 gae_duplicate tensor(0.3954, dtype=torch.float64) tensor(-8.2415, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7525, dtype=torch.float64) delta_t tensor(0.4302, dtype=torch.float64)
16 gae_duplicate tensor(0.3894, dtype=torch.float64) tensor(-9.5512, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6377, dtype=torch.float64) delta_t tensor(0.3463, dtype=torch.float64)
15 gae_duplicate tensor(0.1837, dtype=torch.float64) tensor(-7.1929, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4424, dtype=torch.float64) delta_t tensor(0.1587, dtype=torch.float64)
14 gae_duplicate tensor(-0.8407, dtype=torch.float64) tensor(-4.1798, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5199, dtype=torch.float64) delta_t tensor(0.2886, dtype=torch.float64)
13 gae_duplicate tensor(0.0119, dtype=torch.float64) tensor(-6.4005, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4023, dtype=torch.float64) delta_t tensor(0.1959, dtype=torch.float64)
12 gae_duplicate tensor(-0.8614, dtype=torch.float64) tensor(-3.9256, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0459, dtype=torch.float64) delta_t tensor(-0.1607, dtype=torch.float64)
11 gae_duplicate tensor(-1.1714, dtype=torch.float64) tensor(2.6841, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2899, dtype=torch.float64) delta_t tensor(0.1251, dtype=torch.float64)
10 gae_duplicate tensor(-0.9355, dtype=torch.float64) tensor(-2.6931, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.1509, dtype=torch.float64) delta_t tensor(-2.3061, dtype=torch.float64)
9 gae_duplicate tensor(-3.8319, dtype=torch.float64) tensor(41.7051, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0991, dtype=torch.float64) delta_t tensor(-1.2292, dtype=torch.float64)
8 gae_duplicate tensor(-3.8097, dtype=torch.float64) tensor(29.0847, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1445, dtype=torch.float64) delta_t tensor(0.0430, dtype=torch.float64)
7 gae_duplicate tensor(-1.5611, dtype=torch.float64) tensor(1.9932, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1338, dtype=torch.float64) delta_t tensor(-0.2111, dtype=torch.float64)
6 gae_duplicate tensor(-1.8584, dtype=torch.float64) tensor(3.7622, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0934, dtype=torch.float64) delta_t tensor(-0.0616, dtype=torch.float64)
5 gae_duplicate tensor(-0.5799, dtype=torch.float64) tensor(1.5892, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2093, dtype=torch.float64) delta_t tensor(0.1037, dtype=torch.float64)
4 gae_duplicate tensor(-0.3761, dtype=torch.float64) tensor(-1.9886, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2080, dtype=torch.float64) delta_t tensor(0.0982, dtype=torch.float64)
3 gae_duplicate tensor(-0.3287, dtype=torch.float64) tensor(-2.0210, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3674, dtype=torch.float64) delta_t tensor(-0.4715, dtype=torch.float64)
2 gae_duplicate tensor(-0.7831, dtype=torch.float64) tensor(9.2293, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1372.1900634765625
value loss:129.57284545898438
entropies:351.08740234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.236561298370361 seconds
19 rew tensor(0.8441, dtype=torch.float64) delta_t tensor(0.4665, dtype=torch.float64)
19 gae_duplicate tensor(0.3220, dtype=torch.float64) tensor(-9.2119, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8440, dtype=torch.float64) delta_t tensor(0.5287, dtype=torch.float64)
18 gae_duplicate tensor(0.3632, dtype=torch.float64) tensor(-12.2035, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8497, dtype=torch.float64) delta_t tensor(0.5038, dtype=torch.float64)
17 gae_duplicate tensor(0.4512, dtype=torch.float64) tensor(-10.5023, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6111, dtype=torch.float64) delta_t tensor(0.3510, dtype=torch.float64)
16 gae_duplicate tensor(0.2673, dtype=torch.float64) tensor(-7.6112, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7600, dtype=torch.float64) delta_t tensor(0.4204, dtype=torch.float64)
15 gae_duplicate tensor(0.3254, dtype=torch.float64) tensor(-9.7978, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.1481, dtype=torch.float64) delta_t tensor(-0.3618, dtype=torch.float64)
14 gae_duplicate tensor(-1.0749, dtype=torch.float64) tensor(5.4374, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5360, dtype=torch.float64) delta_t tensor(0.2136, dtype=torch.float64)
13 gae_duplicate tensor(-0.7439, dtype=torch.float64) tensor(-3.4534, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3737, dtype=torch.float64) delta_t tensor(0.2022, dtype=torch.float64)
12 gae_duplicate tensor(-0.0117, dtype=torch.float64) tensor(-4.1524, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0626, dtype=torch.float64) delta_t tensor(-0.3720, dtype=torch.float64)
11 gae_duplicate tensor(-1.8271, dtype=torch.float64) tensor(6.0463, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0542, dtype=torch.float64) delta_t tensor(0.0723, dtype=torch.float64)
10 gae_duplicate tensor(-1.0300, dtype=torch.float64) tensor(-1.1442, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0151, dtype=torch.float64) delta_t tensor(-0.2764, dtype=torch.float64)
9 gae_duplicate tensor(-2.0017, dtype=torch.float64) tensor(4.9483, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8673, dtype=torch.float64) delta_t tensor(-0.7282, dtype=torch.float64)
8 gae_duplicate tensor(-2.7586, dtype=torch.float64) tensor(15.6343, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4810, dtype=torch.float64) delta_t tensor(0.2467, dtype=torch.float64)
7 gae_duplicate tensor(-0.8751, dtype=torch.float64) tensor(-3.0496, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6327, dtype=torch.float64) delta_t tensor(-0.5635, dtype=torch.float64)
6 gae_duplicate tensor(-1.5169, dtype=torch.float64) tensor(10.6577, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.5161, dtype=torch.float64) delta_t tensor(0.3581, dtype=torch.float64)
5 gae_duplicate tensor(0.1803, dtype=torch.float64) tensor(-5.7830, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3781, dtype=torch.float64) delta_t tensor(-0.3907, dtype=torch.float64)
4 gae_duplicate tensor(-0.8008, dtype=torch.float64) tensor(7.4001, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5809, dtype=torch.float64) delta_t tensor(0.4574, dtype=torch.float64)
3 gae_duplicate tensor(0.1996, dtype=torch.float64) tensor(-8.4431, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6331, dtype=torch.float64) delta_t tensor(-0.7138, dtype=torch.float64)
2 gae_duplicate tensor(-0.9028, dtype=torch.float64) tensor(14.4937, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:484.9039001464844
value loss:71.28531646728516
entropies:350.9966125488281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.674781322479248 seconds
19 rew tensor(0.8862, dtype=torch.float64) delta_t tensor(0.5062, dtype=torch.float64)
19 gae_duplicate tensor(0.4427, dtype=torch.float64) tensor(-10.3822, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8485, dtype=torch.float64) delta_t tensor(0.5191, dtype=torch.float64)
18 gae_duplicate tensor(0.4698, dtype=torch.float64) tensor(-11.3202, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8612, dtype=torch.float64) delta_t tensor(0.5181, dtype=torch.float64)
17 gae_duplicate tensor(0.5314, dtype=torch.float64) tensor(-10.9085, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7368, dtype=torch.float64) delta_t tensor(0.4220, dtype=torch.float64)
16 gae_duplicate tensor(0.2868, dtype=torch.float64) tensor(-9.5169, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7964, dtype=torch.float64) delta_t tensor(0.4929, dtype=torch.float64)
15 gae_duplicate tensor(0.4541, dtype=torch.float64) tensor(-10.3153, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6533, dtype=torch.float64) delta_t tensor(0.3756, dtype=torch.float64)
14 gae_duplicate tensor(0.2311, dtype=torch.float64) tensor(-7.9477, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6357, dtype=torch.float64) delta_t tensor(0.4389, dtype=torch.float64)
13 gae_duplicate tensor(0.2907, dtype=torch.float64) tensor(-9.3778, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5599, dtype=torch.float64) delta_t tensor(0.3441, dtype=torch.float64)
12 gae_duplicate tensor(0.2726, dtype=torch.float64) tensor(-8.1283, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7326, dtype=torch.float64) delta_t tensor(-0.8192, dtype=torch.float64)
11 gae_duplicate tensor(-1.6367, dtype=torch.float64) tensor(15.3696, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2455, dtype=torch.float64) delta_t tensor(0.0819, dtype=torch.float64)
10 gae_duplicate tensor(-1.0353, dtype=torch.float64) tensor(0.3281, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-3.5082, dtype=torch.float64) delta_t tensor(-3.4771, dtype=torch.float64)
9 gae_duplicate tensor(-5.5115, dtype=torch.float64) tensor(64.0948, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9230, dtype=torch.float64) delta_t tensor(-1.0374, dtype=torch.float64)
8 gae_duplicate tensor(-3.4484, dtype=torch.float64) tensor(27.4377, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5952, dtype=torch.float64) delta_t tensor(-0.4952, dtype=torch.float64)
7 gae_duplicate tensor(-2.7755, dtype=torch.float64) tensor(12.5737, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4925, dtype=torch.float64) delta_t tensor(-0.6043, dtype=torch.float64)
6 gae_duplicate tensor(-2.3052, dtype=torch.float64) tensor(12.0597, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2111, dtype=torch.float64) delta_t tensor(-0.2541, dtype=torch.float64)
5 gae_duplicate tensor(-0.8130, dtype=torch.float64) tensor(5.8199, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2135, dtype=torch.float64) delta_t tensor(0.1216, dtype=torch.float64)
4 gae_duplicate tensor(-0.6508, dtype=torch.float64) tensor(-1.6042, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0250, dtype=torch.float64) delta_t tensor(-0.0347, dtype=torch.float64)
3 gae_duplicate tensor(-0.3661, dtype=torch.float64) tensor(0.7093, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1836, dtype=torch.float64) delta_t tensor(-0.2796, dtype=torch.float64)
2 gae_duplicate tensor(-0.6099, dtype=torch.float64) tensor(5.4307, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3568.16845703125
value loss:226.07960510253906
entropies:350.9259033203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.836867094039917 seconds
19 rew tensor(0.8557, dtype=torch.float64) delta_t tensor(0.4900, dtype=torch.float64)
19 gae_duplicate tensor(0.3712, dtype=torch.float64) tensor(-10.5789, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6249, dtype=torch.float64) delta_t tensor(0.2912, dtype=torch.float64)
18 gae_duplicate tensor(-0.8398, dtype=torch.float64) tensor(-7.1101, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7752, dtype=torch.float64) delta_t tensor(0.4600, dtype=torch.float64)
17 gae_duplicate tensor(0.4198, dtype=torch.float64) tensor(-9.5036, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7628, dtype=torch.float64) delta_t tensor(0.4478, dtype=torch.float64)
16 gae_duplicate tensor(0.2962, dtype=torch.float64) tensor(-9.6854, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4977, dtype=torch.float64) delta_t tensor(0.1914, dtype=torch.float64)
15 gae_duplicate tensor(-0.6539, dtype=torch.float64) tensor(-4.5655, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7039, dtype=torch.float64) delta_t tensor(0.4276, dtype=torch.float64)
14 gae_duplicate tensor(0.2673, dtype=torch.float64) tensor(-8.6752, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6471, dtype=torch.float64) delta_t tensor(0.4138, dtype=torch.float64)
13 gae_duplicate tensor(0.2115, dtype=torch.float64) tensor(-8.6969, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5815, dtype=torch.float64) delta_t tensor(0.3420, dtype=torch.float64)
12 gae_duplicate tensor(0.1795, dtype=torch.float64) tensor(-7.7459, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0250, dtype=torch.float64) delta_t tensor(-0.1375, dtype=torch.float64)
11 gae_duplicate tensor(-1.7641, dtype=torch.float64) tensor(1.8144, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0423, dtype=torch.float64) delta_t tensor(-0.1757, dtype=torch.float64)
10 gae_duplicate tensor(-1.3375, dtype=torch.float64) tensor(4.3343, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6803, dtype=torch.float64) delta_t tensor(-1.7472, dtype=torch.float64)
9 gae_duplicate tensor(-4.4991, dtype=torch.float64) tensor(34.7835, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6574, dtype=torch.float64) delta_t tensor(-1.7830, dtype=torch.float64)
8 gae_duplicate tensor(-4.4025, dtype=torch.float64) tensor(41.5175, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3230, dtype=torch.float64) delta_t tensor(-0.3063, dtype=torch.float64)
7 gae_duplicate tensor(-1.5335, dtype=torch.float64) tensor(10.4956, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3503, dtype=torch.float64) delta_t tensor(0.2743, dtype=torch.float64)
6 gae_duplicate tensor(-0.0662, dtype=torch.float64) tensor(-4.4636, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5342, dtype=torch.float64) delta_t tensor(-0.5819, dtype=torch.float64)
5 gae_duplicate tensor(-2.0332, dtype=torch.float64) tensor(10.6124, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2051, dtype=torch.float64) delta_t tensor(-0.2521, dtype=torch.float64)
4 gae_duplicate tensor(-3.5917, dtype=torch.float64) tensor(7.4131, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0514, dtype=torch.float64) delta_t tensor(-0.0027, dtype=torch.float64)
3 gae_duplicate tensor(-0.7123, dtype=torch.float64) tensor(0.3970, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2305, dtype=torch.float64) delta_t tensor(-0.3276, dtype=torch.float64)
2 gae_duplicate tensor(-1.0044, dtype=torch.float64) tensor(6.6912, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2634.631103515625
value loss:186.5618896484375
entropies:351.07745361328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.112004041671753 seconds
19 rew tensor(0.8613, dtype=torch.float64) delta_t tensor(0.4888, dtype=torch.float64)
19 gae_duplicate tensor(0.4437, dtype=torch.float64) tensor(-9.7622, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8056, dtype=torch.float64) delta_t tensor(0.4921, dtype=torch.float64)
18 gae_duplicate tensor(0.4317, dtype=torch.float64) tensor(-10.2662, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7795, dtype=torch.float64) delta_t tensor(0.4637, dtype=torch.float64)
17 gae_duplicate tensor(0.3547, dtype=torch.float64) tensor(-9.9196, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6953, dtype=torch.float64) delta_t tensor(0.3992, dtype=torch.float64)
16 gae_duplicate tensor(0.2214, dtype=torch.float64) tensor(-9.1763, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4241, dtype=torch.float64) delta_t tensor(0.1457, dtype=torch.float64)
15 gae_duplicate tensor(-0.9956, dtype=torch.float64) tensor(-4.2121, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5726, dtype=torch.float64) delta_t tensor(0.3049, dtype=torch.float64)
14 gae_duplicate tensor(0.1810, dtype=torch.float64) tensor(-6.2238, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5442, dtype=torch.float64) delta_t tensor(0.3682, dtype=torch.float64)
13 gae_duplicate tensor(0.2607, dtype=torch.float64) tensor(-7.5303, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4345, dtype=torch.float64) delta_t tensor(0.2270, dtype=torch.float64)
12 gae_duplicate tensor(-0.7625, dtype=torch.float64) tensor(-4.8208, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0526, dtype=torch.float64) delta_t tensor(-0.0623, dtype=torch.float64)
11 gae_duplicate tensor(-0.8816, dtype=torch.float64) tensor(0.7026, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0298, dtype=torch.float64) delta_t tensor(-0.1444, dtype=torch.float64)
10 gae_duplicate tensor(-0.9816, dtype=torch.float64) tensor(2.1562, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5753, dtype=torch.float64) delta_t tensor(-1.4613, dtype=torch.float64)
9 gae_duplicate tensor(-4.2023, dtype=torch.float64) tensor(29.5746, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2035, dtype=torch.float64) delta_t tensor(0.1184, dtype=torch.float64)
8 gae_duplicate tensor(-1.0589, dtype=torch.float64) tensor(0.5988, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5484, dtype=torch.float64) delta_t tensor(-1.3648, dtype=torch.float64)
7 gae_duplicate tensor(-3.5990, dtype=torch.float64) tensor(28.6032, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3216, dtype=torch.float64) delta_t tensor(-0.4053, dtype=torch.float64)
6 gae_duplicate tensor(-2.3100, dtype=torch.float64) tensor(9.9430, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3430, dtype=torch.float64) delta_t tensor(-0.2834, dtype=torch.float64)
5 gae_duplicate tensor(-0.9276, dtype=torch.float64) tensor(6.4519, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3499, dtype=torch.float64) delta_t tensor(0.3590, dtype=torch.float64)
4 gae_duplicate tensor(-0.6835, dtype=torch.float64) tensor(-5.8583, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1033, dtype=torch.float64) delta_t tensor(-0.1240, dtype=torch.float64)
3 gae_duplicate tensor(-0.5425, dtype=torch.float64) tensor(1.6357, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1484, dtype=torch.float64) delta_t tensor(-0.1713, dtype=torch.float64)
2 gae_duplicate tensor(-0.7470, dtype=torch.float64) tensor(3.4514, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-923.5980834960938
value loss:131.130859375
entropies:351.1761779785156
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3927.7903)
ToM Target loss= tensor(3558.8906)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.871537923812866 seconds
19 rew tensor(0.8323, dtype=torch.float64) delta_t tensor(0.4608, dtype=torch.float64)
19 gae_duplicate tensor(0.3257, dtype=torch.float64) tensor(-9.0521, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8328, dtype=torch.float64) delta_t tensor(0.4898, dtype=torch.float64)
18 gae_duplicate tensor(0.3512, dtype=torch.float64) tensor(-10.6901, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8065, dtype=torch.float64) delta_t tensor(0.4888, dtype=torch.float64)
17 gae_duplicate tensor(0.3627, dtype=torch.float64) tensor(-9.7813, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7507, dtype=torch.float64) delta_t tensor(0.4261, dtype=torch.float64)
16 gae_duplicate tensor(0.4161, dtype=torch.float64) tensor(-8.8690, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6419, dtype=torch.float64) delta_t tensor(0.3369, dtype=torch.float64)
15 gae_duplicate tensor(0.2363, dtype=torch.float64) tensor(-7.8219, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4649, dtype=torch.float64) delta_t tensor(0.1800, dtype=torch.float64)
14 gae_duplicate tensor(-0.7388, dtype=torch.float64) tensor(-4.2662, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5997, dtype=torch.float64) delta_t tensor(0.3278, dtype=torch.float64)
13 gae_duplicate tensor(0.0771, dtype=torch.float64) tensor(-6.5809, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5810, dtype=torch.float64) delta_t tensor(0.3804, dtype=torch.float64)
12 gae_duplicate tensor(0.3347, dtype=torch.float64) tensor(-7.7026, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1091, dtype=torch.float64) delta_t tensor(-0.0198, dtype=torch.float64)
11 gae_duplicate tensor(-1.0654, dtype=torch.float64) tensor(-0.5187, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4115, dtype=torch.float64) delta_t tensor(-0.5476, dtype=torch.float64)
10 gae_duplicate tensor(-1.8531, dtype=torch.float64) tensor(10.5483, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4867, dtype=torch.float64) delta_t tensor(-1.5257, dtype=torch.float64)
9 gae_duplicate tensor(-3.9872, dtype=torch.float64) tensor(30.1935, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2558, dtype=torch.float64) delta_t tensor(-0.3414, dtype=torch.float64)
8 gae_duplicate tensor(-2.4008, dtype=torch.float64) tensor(8.9497, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9806, dtype=torch.float64) delta_t tensor(-0.9428, dtype=torch.float64)
7 gae_duplicate tensor(-2.5370, dtype=torch.float64) tensor(21.1200, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5367, dtype=torch.float64) delta_t tensor(-0.5817, dtype=torch.float64)
6 gae_duplicate tensor(-2.2690, dtype=torch.float64) tensor(12.9011, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2230, dtype=torch.float64) delta_t tensor(-0.2412, dtype=torch.float64)
5 gae_duplicate tensor(-1.7973, dtype=torch.float64) tensor(5.8056, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2996, dtype=torch.float64) delta_t tensor(0.2883, dtype=torch.float64)
4 gae_duplicate tensor(-0.2899, dtype=torch.float64) tensor(-5.0247, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0036, dtype=torch.float64) delta_t tensor(-0.0209, dtype=torch.float64)
3 gae_duplicate tensor(-0.5644, dtype=torch.float64) tensor(-0.2181, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2370, dtype=torch.float64) delta_t tensor(-0.2878, dtype=torch.float64)
2 gae_duplicate tensor(-0.7044, dtype=torch.float64) tensor(5.3985, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1411.9449462890625
value loss:137.11985778808594
entropies:351.18206787109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.085910081863403 seconds
19 rew tensor(0.8531, dtype=torch.float64) delta_t tensor(0.4754, dtype=torch.float64)
19 gae_duplicate tensor(0.4074, dtype=torch.float64) tensor(-9.4980, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7815, dtype=torch.float64) delta_t tensor(0.4554, dtype=torch.float64)
18 gae_duplicate tensor(0.3790, dtype=torch.float64) tensor(-9.7972, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7883, dtype=torch.float64) delta_t tensor(0.4593, dtype=torch.float64)
17 gae_duplicate tensor(0.4539, dtype=torch.float64) tensor(-9.5016, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6795, dtype=torch.float64) delta_t tensor(0.3772, dtype=torch.float64)
16 gae_duplicate tensor(0.3298, dtype=torch.float64) tensor(-8.2416, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6315, dtype=torch.float64) delta_t tensor(0.3498, dtype=torch.float64)
15 gae_duplicate tensor(0.2302, dtype=torch.float64) tensor(-7.4845, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3999, dtype=torch.float64) delta_t tensor(0.1300, dtype=torch.float64)
14 gae_duplicate tensor(-0.6544, dtype=torch.float64) tensor(-2.8338, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5626, dtype=torch.float64) delta_t tensor(0.4097, dtype=torch.float64)
13 gae_duplicate tensor(0.0996, dtype=torch.float64) tensor(-7.9415, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5906, dtype=torch.float64) delta_t tensor(0.3584, dtype=torch.float64)
12 gae_duplicate tensor(0.1405, dtype=torch.float64) tensor(-7.6869, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.9482, dtype=torch.float64) delta_t tensor(-0.9963, dtype=torch.float64)
11 gae_duplicate tensor(-1.8580, dtype=torch.float64) tensor(18.1950, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1071, dtype=torch.float64) delta_t tensor(-0.0600, dtype=torch.float64)
10 gae_duplicate tensor(-0.9042, dtype=torch.float64) tensor(3.7024, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4588, dtype=torch.float64) delta_t tensor(-1.3731, dtype=torch.float64)
9 gae_duplicate tensor(-2.6325, dtype=torch.float64) tensor(27.1570, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6709, dtype=torch.float64) delta_t tensor(-1.7603, dtype=torch.float64)
8 gae_duplicate tensor(-3.3944, dtype=torch.float64) tensor(38.0122, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4700, dtype=torch.float64) delta_t tensor(-0.3152, dtype=torch.float64)
7 gae_duplicate tensor(-2.1862, dtype=torch.float64) tensor(8.7553, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0848, dtype=torch.float64) delta_t tensor(-0.1654, dtype=torch.float64)
6 gae_duplicate tensor(-2.1035, dtype=torch.float64) tensor(4.4361, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1332, dtype=torch.float64) delta_t tensor(-0.0895, dtype=torch.float64)
5 gae_duplicate tensor(-0.5856, dtype=torch.float64) tensor(2.1232, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3830, dtype=torch.float64) delta_t tensor(0.3914, dtype=torch.float64)
4 gae_duplicate tensor(-0.3918, dtype=torch.float64) tensor(-7.4823, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0334, dtype=torch.float64) delta_t tensor(0.0382, dtype=torch.float64)
3 gae_duplicate tensor(-0.3730, dtype=torch.float64) tensor(-1.5685, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2141, dtype=torch.float64) delta_t tensor(-0.2462, dtype=torch.float64)
2 gae_duplicate tensor(-0.6629, dtype=torch.float64) tensor(4.8226, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1993.9140625
value loss:140.4403076171875
entropies:351.2995910644531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.878745079040527 seconds
19 rew tensor(0.8723, dtype=torch.float64) delta_t tensor(0.4879, dtype=torch.float64)
19 gae_duplicate tensor(0.4139, dtype=torch.float64) tensor(-8.7558, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8282, dtype=torch.float64) delta_t tensor(0.4896, dtype=torch.float64)
18 gae_duplicate tensor(0.3739, dtype=torch.float64) tensor(-10.1097, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7420, dtype=torch.float64) delta_t tensor(0.4127, dtype=torch.float64)
17 gae_duplicate tensor(0.3635, dtype=torch.float64) tensor(-8.2345, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7139, dtype=torch.float64) delta_t tensor(0.4074, dtype=torch.float64)
16 gae_duplicate tensor(0.3623, dtype=torch.float64) tensor(-8.7615, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4703, dtype=torch.float64) delta_t tensor(0.1709, dtype=torch.float64)
15 gae_duplicate tensor(-0.8075, dtype=torch.float64) tensor(-3.8750, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6576, dtype=torch.float64) delta_t tensor(0.3822, dtype=torch.float64)
14 gae_duplicate tensor(0.2730, dtype=torch.float64) tensor(-8.2080, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6531, dtype=torch.float64) delta_t tensor(0.3931, dtype=torch.float64)
13 gae_duplicate tensor(0.2753, dtype=torch.float64) tensor(-8.0783, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3547, dtype=torch.float64) delta_t tensor(0.1680, dtype=torch.float64)
12 gae_duplicate tensor(-0.7060, dtype=torch.float64) tensor(-4.1234, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0829, dtype=torch.float64) delta_t tensor(-0.1974, dtype=torch.float64)
11 gae_duplicate tensor(-0.8994, dtype=torch.float64) tensor(3.1916, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2079, dtype=torch.float64) delta_t tensor(-0.3351, dtype=torch.float64)
10 gae_duplicate tensor(-1.1735, dtype=torch.float64) tensor(7.2907, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2956, dtype=torch.float64) delta_t tensor(-1.2784, dtype=torch.float64)
9 gae_duplicate tensor(-4.0560, dtype=torch.float64) tensor(24.9034, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6023, dtype=torch.float64) delta_t tensor(-0.6118, dtype=torch.float64)
8 gae_duplicate tensor(-2.9207, dtype=torch.float64) tensor(15.0219, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0031, dtype=torch.float64) delta_t tensor(-0.9191, dtype=torch.float64)
7 gae_duplicate tensor(-3.6953, dtype=torch.float64) tensor(19.6582, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4104, dtype=torch.float64) delta_t tensor(-0.3861, dtype=torch.float64)
6 gae_duplicate tensor(-3.6642, dtype=torch.float64) tensor(9.6639, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3957, dtype=torch.float64) delta_t tensor(-0.3361, dtype=torch.float64)
5 gae_duplicate tensor(-2.3015, dtype=torch.float64) tensor(7.1510, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1932, dtype=torch.float64) delta_t tensor(0.2655, dtype=torch.float64)
4 gae_duplicate tensor(-0.2598, dtype=torch.float64) tensor(-4.3989, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0046, dtype=torch.float64) delta_t tensor(0.0454, dtype=torch.float64)
3 gae_duplicate tensor(-0.7372, dtype=torch.float64) tensor(-1.0837, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2335, dtype=torch.float64) delta_t tensor(-0.2863, dtype=torch.float64)
2 gae_duplicate tensor(-0.8275, dtype=torch.float64) tensor(5.5326, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1541.1568603515625
value loss:164.08148193359375
entropies:351.07696533203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.698393821716309 seconds
19 rew tensor(0.8654, dtype=torch.float64) delta_t tensor(0.4880, dtype=torch.float64)
19 gae_duplicate tensor(0.4329, dtype=torch.float64) tensor(-9.5972, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8507, dtype=torch.float64) delta_t tensor(0.5225, dtype=torch.float64)
18 gae_duplicate tensor(0.3795, dtype=torch.float64) tensor(-11.3323, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8229, dtype=torch.float64) delta_t tensor(0.4928, dtype=torch.float64)
17 gae_duplicate tensor(0.4152, dtype=torch.float64) tensor(-10.5598, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6094, dtype=torch.float64) delta_t tensor(0.3328, dtype=torch.float64)
16 gae_duplicate tensor(0.3209, dtype=torch.float64) tensor(-7.3747, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4392, dtype=torch.float64) delta_t tensor(0.1300, dtype=torch.float64)
15 gae_duplicate tensor(-0.7777, dtype=torch.float64) tensor(-3.2687, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3545, dtype=torch.float64) delta_t tensor(0.1556, dtype=torch.float64)
14 gae_duplicate tensor(-0.8641, dtype=torch.float64) tensor(-3.4488, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4507, dtype=torch.float64) delta_t tensor(0.1834, dtype=torch.float64)
13 gae_duplicate tensor(-0.7630, dtype=torch.float64) tensor(-4.1587, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2428, dtype=torch.float64) delta_t tensor(0.1001, dtype=torch.float64)
12 gae_duplicate tensor(-0.8231, dtype=torch.float64) tensor(-2.1021, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0107, dtype=torch.float64) delta_t tensor(-0.1723, dtype=torch.float64)
11 gae_duplicate tensor(-1.8940, dtype=torch.float64) tensor(3.5272, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4538, dtype=torch.float64) delta_t tensor(-0.4525, dtype=torch.float64)
10 gae_duplicate tensor(-1.6224, dtype=torch.float64) tensor(8.8934, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0693, dtype=torch.float64) delta_t tensor(-0.1664, dtype=torch.float64)
9 gae_duplicate tensor(-0.9388, dtype=torch.float64) tensor(3.6521, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7431, dtype=torch.float64) delta_t tensor(-0.5956, dtype=torch.float64)
8 gae_duplicate tensor(-2.7353, dtype=torch.float64) tensor(10.7600, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4240, dtype=torch.float64) delta_t tensor(-0.4525, dtype=torch.float64)
7 gae_duplicate tensor(-3.4898, dtype=torch.float64) tensor(10.5654, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2327, dtype=torch.float64) delta_t tensor(-0.0708, dtype=torch.float64)
6 gae_duplicate tensor(-1.0769, dtype=torch.float64) tensor(2.6117, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1897, dtype=torch.float64) delta_t tensor(0.1673, dtype=torch.float64)
5 gae_duplicate tensor(-0.6821, dtype=torch.float64) tensor(-3.0516, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0777, dtype=torch.float64) delta_t tensor(0.0361, dtype=torch.float64)
4 gae_duplicate tensor(-0.4723, dtype=torch.float64) tensor(-0.5425, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3197, dtype=torch.float64) delta_t tensor(0.3088, dtype=torch.float64)
3 gae_duplicate tensor(-0.4551, dtype=torch.float64) tensor(-5.9709, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4594, dtype=torch.float64) delta_t tensor(-0.5021, dtype=torch.float64)
2 gae_duplicate tensor(-0.8165, dtype=torch.float64) tensor(8.4775, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:603.05517578125
value loss:87.3359146118164
entropies:350.4981689453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.015053987503052 seconds
19 rew tensor(0.8716, dtype=torch.float64) delta_t tensor(0.4974, dtype=torch.float64)
19 gae_duplicate tensor(0.4043, dtype=torch.float64) tensor(-9.6241, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8549, dtype=torch.float64) delta_t tensor(0.5180, dtype=torch.float64)
18 gae_duplicate tensor(0.4173, dtype=torch.float64) tensor(-10.8622, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6986, dtype=torch.float64) delta_t tensor(0.4061, dtype=torch.float64)
17 gae_duplicate tensor(0.3845, dtype=torch.float64) tensor(-8.7402, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4653, dtype=torch.float64) delta_t tensor(0.1546, dtype=torch.float64)
16 gae_duplicate tensor(-0.6907, dtype=torch.float64) tensor(-4.4066, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6149, dtype=torch.float64) delta_t tensor(0.3575, dtype=torch.float64)
15 gae_duplicate tensor(0.0923, dtype=torch.float64) tensor(-7.7834, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6571, dtype=torch.float64) delta_t tensor(0.3798, dtype=torch.float64)
14 gae_duplicate tensor(0.2496, dtype=torch.float64) tensor(-8.5423, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4558, dtype=torch.float64) delta_t tensor(0.2836, dtype=torch.float64)
13 gae_duplicate tensor(0.2201, dtype=torch.float64) tensor(-6.1193, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6194, dtype=torch.float64) delta_t tensor(0.4143, dtype=torch.float64)
12 gae_duplicate tensor(0.2478, dtype=torch.float64) tensor(-8.0638, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4015, dtype=torch.float64) delta_t tensor(0.4826, dtype=torch.float64)
11 gae_duplicate tensor(0.3397, dtype=torch.float64) tensor(-10.5451, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1217, dtype=torch.float64) delta_t tensor(-0.2025, dtype=torch.float64)
10 gae_duplicate tensor(-0.9662, dtype=torch.float64) tensor(2.0841, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.1138, dtype=torch.float64) delta_t tensor(-1.8267, dtype=torch.float64)
9 gae_duplicate tensor(-5.9169, dtype=torch.float64) tensor(36.5723, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3999, dtype=torch.float64) delta_t tensor(0.4403, dtype=torch.float64)
8 gae_duplicate tensor(-0.1299, dtype=torch.float64) tensor(-4.8927, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0711, dtype=torch.float64) delta_t tensor(-0.7408, dtype=torch.float64)
7 gae_duplicate tensor(-2.8739, dtype=torch.float64) tensor(12.0054, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1339, dtype=torch.float64) delta_t tensor(-0.1236, dtype=torch.float64)
6 gae_duplicate tensor(-2.1113, dtype=torch.float64) tensor(3.2406, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5640, dtype=torch.float64) delta_t tensor(-0.3958, dtype=torch.float64)
5 gae_duplicate tensor(-1.8516, dtype=torch.float64) tensor(7.6796, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3059, dtype=torch.float64) delta_t tensor(0.3807, dtype=torch.float64)
4 gae_duplicate tensor(-0.6058, dtype=torch.float64) tensor(-6.1697, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1932, dtype=torch.float64) delta_t tensor(-0.1331, dtype=torch.float64)
3 gae_duplicate tensor(-0.4872, dtype=torch.float64) tensor(1.8726, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1103, dtype=torch.float64) delta_t tensor(-0.1242, dtype=torch.float64)
2 gae_duplicate tensor(-0.8182, dtype=torch.float64) tensor(2.0237, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1000.022216796875
value loss:149.75071716308594
entropies:350.44287109375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3922.8862)
ToM Target loss= tensor(3571.6946)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.998703956604004 seconds
19 rew tensor(0.8843, dtype=torch.float64) delta_t tensor(0.4855, dtype=torch.float64)
19 gae_duplicate tensor(0.4427, dtype=torch.float64) tensor(-9.0693, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8125, dtype=torch.float64) delta_t tensor(0.4709, dtype=torch.float64)
18 gae_duplicate tensor(0.3588, dtype=torch.float64) tensor(-10.1071, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7805, dtype=torch.float64) delta_t tensor(0.4618, dtype=torch.float64)
17 gae_duplicate tensor(0.3737, dtype=torch.float64) tensor(-9.5354, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5862, dtype=torch.float64) delta_t tensor(0.2909, dtype=torch.float64)
16 gae_duplicate tensor(0.2686, dtype=torch.float64) tensor(-6.4429, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5894, dtype=torch.float64) delta_t tensor(0.3198, dtype=torch.float64)
15 gae_duplicate tensor(0.2471, dtype=torch.float64) tensor(-6.7582, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2028, dtype=torch.float64) delta_t tensor(-0.0393, dtype=torch.float64)
14 gae_duplicate tensor(-0.7682, dtype=torch.float64) tensor(-0.1631, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3346, dtype=torch.float64) delta_t tensor(0.1139, dtype=torch.float64)
13 gae_duplicate tensor(-0.8652, dtype=torch.float64) tensor(-2.4810, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5338, dtype=torch.float64) delta_t tensor(0.3732, dtype=torch.float64)
12 gae_duplicate tensor(0.1932, dtype=torch.float64) tensor(-7.6342, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3204, dtype=torch.float64) delta_t tensor(-0.3954, dtype=torch.float64)
11 gae_duplicate tensor(-1.7721, dtype=torch.float64) tensor(7.4836, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0383, dtype=torch.float64) delta_t tensor(-0.0956, dtype=torch.float64)
10 gae_duplicate tensor(-1.0181, dtype=torch.float64) tensor(2.1969, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7463, dtype=torch.float64) delta_t tensor(-0.6910, dtype=torch.float64)
9 gae_duplicate tensor(-2.7572, dtype=torch.float64) tensor(12.4808, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8487, dtype=torch.float64) delta_t tensor(-0.7878, dtype=torch.float64)
8 gae_duplicate tensor(-3.2847, dtype=torch.float64) tensor(16.5495, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7573, dtype=torch.float64) delta_t tensor(-0.6007, dtype=torch.float64)
7 gae_duplicate tensor(-2.2331, dtype=torch.float64) tensor(13.5584, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0758, dtype=torch.float64) delta_t tensor(-0.0206, dtype=torch.float64)
6 gae_duplicate tensor(-1.0246, dtype=torch.float64) tensor(1.8787, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0878, dtype=torch.float64) delta_t tensor(0.0219, dtype=torch.float64)
5 gae_duplicate tensor(-0.7538, dtype=torch.float64) tensor(-0.2413, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1579, dtype=torch.float64) delta_t tensor(0.2959, dtype=torch.float64)
4 gae_duplicate tensor(-0.4323, dtype=torch.float64) tensor(-5.5066, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0627, dtype=torch.float64) delta_t tensor(0.1286, dtype=torch.float64)
3 gae_duplicate tensor(-0.4991, dtype=torch.float64) tensor(-2.8231, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2168, dtype=torch.float64) delta_t tensor(-0.2321, dtype=torch.float64)
2 gae_duplicate tensor(-0.7922, dtype=torch.float64) tensor(4.0375, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:44.478355407714844
value loss:97.97750854492188
entropies:350.6410217285156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.890317678451538 seconds
19 rew tensor(0.8643, dtype=torch.float64) delta_t tensor(0.4450, dtype=torch.float64)
19 gae_duplicate tensor(0.3897, dtype=torch.float64) tensor(-8.8044, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8753, dtype=torch.float64) delta_t tensor(0.5171, dtype=torch.float64)
18 gae_duplicate tensor(0.5081, dtype=torch.float64) tensor(-10.8438, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7624, dtype=torch.float64) delta_t tensor(0.4000, dtype=torch.float64)
17 gae_duplicate tensor(0.3590, dtype=torch.float64) tensor(-9.1330, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6773, dtype=torch.float64) delta_t tensor(0.3776, dtype=torch.float64)
16 gae_duplicate tensor(0.3172, dtype=torch.float64) tensor(-7.7139, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4998, dtype=torch.float64) delta_t tensor(0.1707, dtype=torch.float64)
15 gae_duplicate tensor(-0.8523, dtype=torch.float64) tensor(-4.3910, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5806, dtype=torch.float64) delta_t tensor(0.4456, dtype=torch.float64)
14 gae_duplicate tensor(0.2836, dtype=torch.float64) tensor(-8.9122, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5729, dtype=torch.float64) delta_t tensor(0.3382, dtype=torch.float64)
13 gae_duplicate tensor(0.2466, dtype=torch.float64) tensor(-7.5876, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4077, dtype=torch.float64) delta_t tensor(0.3386, dtype=torch.float64)
12 gae_duplicate tensor(0.1908, dtype=torch.float64) tensor(-6.8735, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1930, dtype=torch.float64) delta_t tensor(-0.3186, dtype=torch.float64)
11 gae_duplicate tensor(-1.8073, dtype=torch.float64) tensor(4.7965, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1841, dtype=torch.float64) delta_t tensor(-0.1046, dtype=torch.float64)
10 gae_duplicate tensor(-0.8083, dtype=torch.float64) tensor(2.4028, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.8598, dtype=torch.float64) delta_t tensor(-1.8577, dtype=torch.float64)
9 gae_duplicate tensor(-5.5047, dtype=torch.float64) tensor(35.5733, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2649, dtype=torch.float64) delta_t tensor(-1.0909, dtype=torch.float64)
8 gae_duplicate tensor(-4.6875, dtype=torch.float64) tensor(24.6990, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2661, dtype=torch.float64) delta_t tensor(-0.1986, dtype=torch.float64)
7 gae_duplicate tensor(-1.1593, dtype=torch.float64) tensor(6.5217, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4266, dtype=torch.float64) delta_t tensor(-0.2461, dtype=torch.float64)
6 gae_duplicate tensor(-0.9121, dtype=torch.float64) tensor(4.8972, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0979, dtype=torch.float64) delta_t tensor(0.1231, dtype=torch.float64)
5 gae_duplicate tensor(-0.5483, dtype=torch.float64) tensor(-1.9103, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0616, dtype=torch.float64) delta_t tensor(0.1799, dtype=torch.float64)
4 gae_duplicate tensor(-0.4425, dtype=torch.float64) tensor(-3.5369, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2330, dtype=torch.float64) delta_t tensor(0.2324, dtype=torch.float64)
3 gae_duplicate tensor(-0.3515, dtype=torch.float64) tensor(-5.1389, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3286, dtype=torch.float64) delta_t tensor(-0.3315, dtype=torch.float64)
2 gae_duplicate tensor(-0.6830, dtype=torch.float64) tensor(6.6537, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-672.48779296875
value loss:146.49639892578125
entropies:350.9533386230469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.898727178573608 seconds
19 rew tensor(0.8654, dtype=torch.float64) delta_t tensor(0.4383, dtype=torch.float64)
19 gae_duplicate tensor(0.3320, dtype=torch.float64) tensor(-8.6892, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8369, dtype=torch.float64) delta_t tensor(0.4611, dtype=torch.float64)
18 gae_duplicate tensor(0.3856, dtype=torch.float64) tensor(-9.9966, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7789, dtype=torch.float64) delta_t tensor(0.4021, dtype=torch.float64)
17 gae_duplicate tensor(0.3844, dtype=torch.float64) tensor(-8.2363, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6669, dtype=torch.float64) delta_t tensor(0.3355, dtype=torch.float64)
16 gae_duplicate tensor(0.3261, dtype=torch.float64) tensor(-7.2112, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6356, dtype=torch.float64) delta_t tensor(0.2839, dtype=torch.float64)
15 gae_duplicate tensor(0.2132, dtype=torch.float64) tensor(-5.8206, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3471, dtype=torch.float64) delta_t tensor(0.1204, dtype=torch.float64)
14 gae_duplicate tensor(-0.8036, dtype=torch.float64) tensor(-3.1601, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4185, dtype=torch.float64) delta_t tensor(0.1236, dtype=torch.float64)
13 gae_duplicate tensor(-0.8292, dtype=torch.float64) tensor(-2.8885, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2433, dtype=torch.float64) delta_t tensor(0.1475, dtype=torch.float64)
12 gae_duplicate tensor(-0.6471, dtype=torch.float64) tensor(-2.9214, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3685, dtype=torch.float64) delta_t tensor(-0.6255, dtype=torch.float64)
11 gae_duplicate tensor(-1.9333, dtype=torch.float64) tensor(11.5411, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1837, dtype=torch.float64) delta_t tensor(0.2135, dtype=torch.float64)
10 gae_duplicate tensor(-1.0763, dtype=torch.float64) tensor(-2.4419, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.9396, dtype=torch.float64) delta_t tensor(-2.1151, dtype=torch.float64)
9 gae_duplicate tensor(-3.8007, dtype=torch.float64) tensor(42.3884, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.4214, dtype=torch.float64) delta_t tensor(-1.1989, dtype=torch.float64)
8 gae_duplicate tensor(-3.5639, dtype=torch.float64) tensor(27.7547, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5343, dtype=torch.float64) delta_t tensor(0.4221, dtype=torch.float64)
7 gae_duplicate tensor(-0.0446, dtype=torch.float64) tensor(-5.9505, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0297, dtype=torch.float64) delta_t tensor(0.1929, dtype=torch.float64)
6 gae_duplicate tensor(-0.2651, dtype=torch.float64) tensor(-4.3091, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3210, dtype=torch.float64) delta_t tensor(0.3518, dtype=torch.float64)
5 gae_duplicate tensor(0.2342, dtype=torch.float64) tensor(-7.1268, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0451, dtype=torch.float64) delta_t tensor(0.0433, dtype=torch.float64)
4 gae_duplicate tensor(-0.4891, dtype=torch.float64) tensor(-1.4836, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3846, dtype=torch.float64) delta_t tensor(0.3503, dtype=torch.float64)
3 gae_duplicate tensor(0.0965, dtype=torch.float64) tensor(-7.0517, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4890, dtype=torch.float64) delta_t tensor(-0.5119, dtype=torch.float64)
2 gae_duplicate tensor(-0.7439, dtype=torch.float64) tensor(9.2198, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-830.2125854492188
value loss:124.49983215332031
entropies:351.54693603515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.835718870162964 seconds
19 rew tensor(0.8583, dtype=torch.float64) delta_t tensor(0.4455, dtype=torch.float64)
19 gae_duplicate tensor(0.3536, dtype=torch.float64) tensor(-8.3269, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7351, dtype=torch.float64) delta_t tensor(0.3427, dtype=torch.float64)
18 gae_duplicate tensor(0.1840, dtype=torch.float64) tensor(-7.6060, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7048, dtype=torch.float64) delta_t tensor(0.3823, dtype=torch.float64)
17 gae_duplicate tensor(0.3714, dtype=torch.float64) tensor(-8.4334, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4989, dtype=torch.float64) delta_t tensor(0.1705, dtype=torch.float64)
16 gae_duplicate tensor(-0.8141, dtype=torch.float64) tensor(-3.8714, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4650, dtype=torch.float64) delta_t tensor(0.1727, dtype=torch.float64)
15 gae_duplicate tensor(0.0551, dtype=torch.float64) tensor(-3.6108, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2151, dtype=torch.float64) delta_t tensor(-0.0082, dtype=torch.float64)
14 gae_duplicate tensor(-0.7260, dtype=torch.float64) tensor(-0.5286, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5558, dtype=torch.float64) delta_t tensor(0.3383, dtype=torch.float64)
13 gae_duplicate tensor(0.1783, dtype=torch.float64) tensor(-6.9735, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5110, dtype=torch.float64) delta_t tensor(0.3594, dtype=torch.float64)
12 gae_duplicate tensor(0.1783, dtype=torch.float64) tensor(-7.4451, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4968, dtype=torch.float64) delta_t tensor(-0.6084, dtype=torch.float64)
11 gae_duplicate tensor(-1.9491, dtype=torch.float64) tensor(10.2689, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1813, dtype=torch.float64) delta_t tensor(0.0879, dtype=torch.float64)
10 gae_duplicate tensor(-1.1177, dtype=torch.float64) tensor(-1.0512, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.0337, dtype=torch.float64) delta_t tensor(-2.0196, dtype=torch.float64)
9 gae_duplicate tensor(-5.1894, dtype=torch.float64) tensor(36.3290, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0052, dtype=torch.float64) delta_t tensor(-0.8727, dtype=torch.float64)
8 gae_duplicate tensor(-2.9678, dtype=torch.float64) tensor(21.3016, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1045, dtype=torch.float64) delta_t tensor(0.0237, dtype=torch.float64)
7 gae_duplicate tensor(-0.7894, dtype=torch.float64) tensor(2.2782, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1832, dtype=torch.float64) delta_t tensor(0.3270, dtype=torch.float64)
6 gae_duplicate tensor(-0.0113, dtype=torch.float64) tensor(-6.0130, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0977, dtype=torch.float64) delta_t tensor(0.1486, dtype=torch.float64)
5 gae_duplicate tensor(-0.5284, dtype=torch.float64) tensor(-3.4672, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1521, dtype=torch.float64) delta_t tensor(0.2542, dtype=torch.float64)
4 gae_duplicate tensor(-0.3192, dtype=torch.float64) tensor(-5.0343, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1743, dtype=torch.float64) delta_t tensor(0.1576, dtype=torch.float64)
3 gae_duplicate tensor(-0.4594, dtype=torch.float64) tensor(-4.0230, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3115, dtype=torch.float64) delta_t tensor(-0.3397, dtype=torch.float64)
2 gae_duplicate tensor(-0.6421, dtype=torch.float64) tensor(6.0551, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-626.78125
value loss:129.0704803466797
entropies:351.7319030761719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.2138307094573975 seconds
19 rew tensor(0.8186, dtype=torch.float64) delta_t tensor(0.3703, dtype=torch.float64)
19 gae_duplicate tensor(0.3046, dtype=torch.float64) tensor(-6.9741, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8009, dtype=torch.float64) delta_t tensor(0.3837, dtype=torch.float64)
18 gae_duplicate tensor(0.1463, dtype=torch.float64) tensor(-8.0739, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7641, dtype=torch.float64) delta_t tensor(0.3876, dtype=torch.float64)
17 gae_duplicate tensor(0.3408, dtype=torch.float64) tensor(-8.6724, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7827, dtype=torch.float64) delta_t tensor(0.4043, dtype=torch.float64)
16 gae_duplicate tensor(0.3558, dtype=torch.float64) tensor(-8.6315, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6442, dtype=torch.float64) delta_t tensor(0.3043, dtype=torch.float64)
15 gae_duplicate tensor(0.1761, dtype=torch.float64) tensor(-6.6495, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4757, dtype=torch.float64) delta_t tensor(0.2326, dtype=torch.float64)
14 gae_duplicate tensor(-0.7322, dtype=torch.float64) tensor(-5.8478, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6637, dtype=torch.float64) delta_t tensor(0.4132, dtype=torch.float64)
13 gae_duplicate tensor(0.1494, dtype=torch.float64) tensor(-9.0436, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3373, dtype=torch.float64) delta_t tensor(0.1667, dtype=torch.float64)
12 gae_duplicate tensor(-0.6671, dtype=torch.float64) tensor(-3.7177, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3656, dtype=torch.float64) delta_t tensor(-0.4545, dtype=torch.float64)
11 gae_duplicate tensor(-1.9286, dtype=torch.float64) tensor(8.1187, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3431, dtype=torch.float64) delta_t tensor(0.2538, dtype=torch.float64)
10 gae_duplicate tensor(0.0319, dtype=torch.float64) tensor(-4.3372, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6458, dtype=torch.float64) delta_t tensor(-1.5427, dtype=torch.float64)
9 gae_duplicate tensor(-4.0614, dtype=torch.float64) tensor(27.9744, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.4876, dtype=torch.float64) delta_t tensor(-1.5143, dtype=torch.float64)
8 gae_duplicate tensor(-4.1742, dtype=torch.float64) tensor(34.9044, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3575, dtype=torch.float64) delta_t tensor(-1.1619, dtype=torch.float64)
7 gae_duplicate tensor(-4.5166, dtype=torch.float64) tensor(26.1973, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1130, dtype=torch.float64) delta_t tensor(-0.0962, dtype=torch.float64)
6 gae_duplicate tensor(-2.3831, dtype=torch.float64) tensor(3.4473, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2193, dtype=torch.float64) delta_t tensor(-0.0939, dtype=torch.float64)
5 gae_duplicate tensor(-2.0873, dtype=torch.float64) tensor(2.9577, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3909, dtype=torch.float64) delta_t tensor(0.4133, dtype=torch.float64)
4 gae_duplicate tensor(0.1656, dtype=torch.float64) tensor(-7.9610, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0546, dtype=torch.float64) delta_t tensor(0.0012, dtype=torch.float64)
3 gae_duplicate tensor(-0.4206, dtype=torch.float64) tensor(-0.6791, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2087, dtype=torch.float64) delta_t tensor(-0.2599, dtype=torch.float64)
2 gae_duplicate tensor(-0.5884, dtype=torch.float64) tensor(4.9719, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2146.222412109375
value loss:188.70001220703125
entropies:352.1849365234375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3967.1746)
ToM Target loss= tensor(3573.6790)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.869525194168091 seconds
19 rew tensor(0.8637, dtype=torch.float64) delta_t tensor(0.3916, dtype=torch.float64)
19 gae_duplicate tensor(0.3134, dtype=torch.float64) tensor(-7.4516, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5646, dtype=torch.float64) delta_t tensor(0.1708, dtype=torch.float64)
18 gae_duplicate tensor(-0.9197, dtype=torch.float64) tensor(-4.2859, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7767, dtype=torch.float64) delta_t tensor(0.3864, dtype=torch.float64)
17 gae_duplicate tensor(0.2822, dtype=torch.float64) tensor(-8.2290, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6678, dtype=torch.float64) delta_t tensor(0.2922, dtype=torch.float64)
16 gae_duplicate tensor(0.2383, dtype=torch.float64) tensor(-6.5851, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1074, dtype=torch.float64) delta_t tensor(-0.2366, dtype=torch.float64)
15 gae_duplicate tensor(-0.9114, dtype=torch.float64) tensor(3.6126, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4476, dtype=torch.float64) delta_t tensor(0.1206, dtype=torch.float64)
14 gae_duplicate tensor(-0.8063, dtype=torch.float64) tensor(-2.0845, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4188, dtype=torch.float64) delta_t tensor(0.2281, dtype=torch.float64)
13 gae_duplicate tensor(-0.7764, dtype=torch.float64) tensor(-4.4989, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4467, dtype=torch.float64) delta_t tensor(0.1466, dtype=torch.float64)
12 gae_duplicate tensor(-0.8096, dtype=torch.float64) tensor(-3.1373, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0630, dtype=torch.float64) delta_t tensor(-0.1198, dtype=torch.float64)
11 gae_duplicate tensor(-0.8927, dtype=torch.float64) tensor(1.7047, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1878, dtype=torch.float64) delta_t tensor(-0.0343, dtype=torch.float64)
10 gae_duplicate tensor(-0.7637, dtype=torch.float64) tensor(0.5658, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.9284, dtype=torch.float64) delta_t tensor(-1.7696, dtype=torch.float64)
9 gae_duplicate tensor(-4.3075, dtype=torch.float64) tensor(34.9468, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.1624, dtype=torch.float64) delta_t tensor(-2.1959, dtype=torch.float64)
8 gae_duplicate tensor(-4.2394, dtype=torch.float64) tensor(48.9262, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5181, dtype=torch.float64) delta_t tensor(-0.2826, dtype=torch.float64)
7 gae_duplicate tensor(-2.2016, dtype=torch.float64) tensor(10.2071, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2653, dtype=torch.float64) delta_t tensor(0.2771, dtype=torch.float64)
6 gae_duplicate tensor(-1.0480, dtype=torch.float64) tensor(-4.0651, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0433, dtype=torch.float64) delta_t tensor(0.0795, dtype=torch.float64)
5 gae_duplicate tensor(-0.4258, dtype=torch.float64) tensor(-1.9730, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4241, dtype=torch.float64) delta_t tensor(0.4835, dtype=torch.float64)
4 gae_duplicate tensor(-0.0062, dtype=torch.float64) tensor(-9.6878, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0205, dtype=torch.float64) delta_t tensor(0.0010, dtype=torch.float64)
3 gae_duplicate tensor(-0.3058, dtype=torch.float64) tensor(-0.8707, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2138, dtype=torch.float64) delta_t tensor(-0.2638, dtype=torch.float64)
2 gae_duplicate tensor(-0.6759, dtype=torch.float64) tensor(4.9921, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2907.896240234375
value loss:175.88330078125
entropies:352.7184143066406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8153908252716064 seconds
19 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.3509, dtype=torch.float64)
19 gae_duplicate tensor(0.2009, dtype=torch.float64) tensor(-6.9195, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7776, dtype=torch.float64) delta_t tensor(0.3692, dtype=torch.float64)
18 gae_duplicate tensor(0.3361, dtype=torch.float64) tensor(-7.5632, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7103, dtype=torch.float64) delta_t tensor(0.3496, dtype=torch.float64)
17 gae_duplicate tensor(0.2589, dtype=torch.float64) tensor(-7.5635, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4569, dtype=torch.float64) delta_t tensor(0.0892, dtype=torch.float64)
16 gae_duplicate tensor(-0.9817, dtype=torch.float64) tensor(-2.7876, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3784, dtype=torch.float64) delta_t tensor(0.1157, dtype=torch.float64)
15 gae_duplicate tensor(-0.8108, dtype=torch.float64) tensor(-2.6315, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3949, dtype=torch.float64) delta_t tensor(0.1059, dtype=torch.float64)
14 gae_duplicate tensor(-0.8091, dtype=torch.float64) tensor(-2.0651, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4694, dtype=torch.float64) delta_t tensor(0.3220, dtype=torch.float64)
13 gae_duplicate tensor(0.1896, dtype=torch.float64) tensor(-6.3496, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5865, dtype=torch.float64) delta_t tensor(0.3880, dtype=torch.float64)
12 gae_duplicate tensor(0.3198, dtype=torch.float64) tensor(-8.1584, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0322, dtype=torch.float64) delta_t tensor(0.0356, dtype=torch.float64)
11 gae_duplicate tensor(-0.7081, dtype=torch.float64) tensor(-1.1855, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1180, dtype=torch.float64) delta_t tensor(-0.1841, dtype=torch.float64)
10 gae_duplicate tensor(-0.9115, dtype=torch.float64) tensor(3.9538, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.8204, dtype=torch.float64) delta_t tensor(-1.6403, dtype=torch.float64)
9 gae_duplicate tensor(-4.3654, dtype=torch.float64) tensor(30.7162, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4144, dtype=torch.float64) delta_t tensor(-0.3927, dtype=torch.float64)
8 gae_duplicate tensor(-3.4476, dtype=torch.float64) tensor(10.2560, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3969, dtype=torch.float64) delta_t tensor(-0.0737, dtype=torch.float64)
7 gae_duplicate tensor(-1.6102, dtype=torch.float64) tensor(3.0124, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1884, dtype=torch.float64) delta_t tensor(0.2125, dtype=torch.float64)
6 gae_duplicate tensor(-0.7620, dtype=torch.float64) tensor(-4.0374, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1279, dtype=torch.float64) delta_t tensor(0.0443, dtype=torch.float64)
5 gae_duplicate tensor(-0.6148, dtype=torch.float64) tensor(-1.6030, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3515, dtype=torch.float64) delta_t tensor(0.3673, dtype=torch.float64)
4 gae_duplicate tensor(-0.0176, dtype=torch.float64) tensor(-7.6801, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0760, dtype=torch.float64) delta_t tensor(-0.0012, dtype=torch.float64)
3 gae_duplicate tensor(-0.3316, dtype=torch.float64) tensor(-0.7955, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1876, dtype=torch.float64) delta_t tensor(-0.2413, dtype=torch.float64)
2 gae_duplicate tensor(-0.6164, dtype=torch.float64) tensor(4.7750, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:262.5225830078125
value loss:112.69438934326172
entropies:352.93603515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.027464151382446 seconds
19 rew tensor(0.8629, dtype=torch.float64) delta_t tensor(0.3792, dtype=torch.float64)
19 gae_duplicate tensor(0.2877, dtype=torch.float64) tensor(-7.4316, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6364, dtype=torch.float64) delta_t tensor(0.2365, dtype=torch.float64)
18 gae_duplicate tensor(-0.7273, dtype=torch.float64) tensor(-5.6195, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7957, dtype=torch.float64) delta_t tensor(0.3761, dtype=torch.float64)
17 gae_duplicate tensor(0.2681, dtype=torch.float64) tensor(-7.9863, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6719, dtype=torch.float64) delta_t tensor(0.2951, dtype=torch.float64)
16 gae_duplicate tensor(0.2468, dtype=torch.float64) tensor(-6.7793, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4803, dtype=torch.float64) delta_t tensor(0.1578, dtype=torch.float64)
15 gae_duplicate tensor(-0.9547, dtype=torch.float64) tensor(-3.9091, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6064, dtype=torch.float64) delta_t tensor(0.3606, dtype=torch.float64)
14 gae_duplicate tensor(0.2034, dtype=torch.float64) tensor(-7.6422, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5662, dtype=torch.float64) delta_t tensor(0.4492, dtype=torch.float64)
13 gae_duplicate tensor(0.2928, dtype=torch.float64) tensor(-9.6173, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5801, dtype=torch.float64) delta_t tensor(0.4193, dtype=torch.float64)
12 gae_duplicate tensor(0.3076, dtype=torch.float64) tensor(-8.9152, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3393, dtype=torch.float64) delta_t tensor(-0.3429, dtype=torch.float64)
11 gae_duplicate tensor(-1.8862, dtype=torch.float64) tensor(5.8536, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0535, dtype=torch.float64) delta_t tensor(0.0464, dtype=torch.float64)
10 gae_duplicate tensor(-2.0449, dtype=torch.float64) tensor(0.4885, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.4134, dtype=torch.float64) delta_t tensor(-2.2058, dtype=torch.float64)
9 gae_duplicate tensor(-4.8431, dtype=torch.float64) tensor(43.6524, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4792, dtype=torch.float64) delta_t tensor(-0.2190, dtype=torch.float64)
8 gae_duplicate tensor(-3.2840, dtype=torch.float64) tensor(9.7618, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0116, dtype=torch.float64) delta_t tensor(0.2584, dtype=torch.float64)
7 gae_duplicate tensor(-0.7062, dtype=torch.float64) tensor(-4.1489, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1014, dtype=torch.float64) delta_t tensor(0.3920, dtype=torch.float64)
6 gae_duplicate tensor(0.2594, dtype=torch.float64) tensor(-7.8997, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0411, dtype=torch.float64) delta_t tensor(0.1422, dtype=torch.float64)
5 gae_duplicate tensor(-0.2256, dtype=torch.float64) tensor(-3.2702, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1005, dtype=torch.float64) delta_t tensor(0.2053, dtype=torch.float64)
4 gae_duplicate tensor(-0.2878, dtype=torch.float64) tensor(-4.3772, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2218, dtype=torch.float64) delta_t tensor(0.1868, dtype=torch.float64)
3 gae_duplicate tensor(-0.1882, dtype=torch.float64) tensor(-4.5896, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3406, dtype=torch.float64) delta_t tensor(-0.3707, dtype=torch.float64)
2 gae_duplicate tensor(-0.7178, dtype=torch.float64) tensor(6.6521, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:756.6011352539062
value loss:134.92974853515625
entropies:353.3165283203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.088035821914673 seconds
19 rew tensor(0.8324, dtype=torch.float64) delta_t tensor(0.3509, dtype=torch.float64)
19 gae_duplicate tensor(0.2721, dtype=torch.float64) tensor(-7.0789, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7847, dtype=torch.float64) delta_t tensor(0.3563, dtype=torch.float64)
18 gae_duplicate tensor(0.2748, dtype=torch.float64) tensor(-7.7785, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7868, dtype=torch.float64) delta_t tensor(0.3725, dtype=torch.float64)
17 gae_duplicate tensor(0.3256, dtype=torch.float64) tensor(-8.2928, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7179, dtype=torch.float64) delta_t tensor(0.3284, dtype=torch.float64)
16 gae_duplicate tensor(0.2096, dtype=torch.float64) tensor(-7.4965, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4561, dtype=torch.float64) delta_t tensor(0.1127, dtype=torch.float64)
15 gae_duplicate tensor(-0.7734, dtype=torch.float64) tensor(-2.8084, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4454, dtype=torch.float64) delta_t tensor(0.1184, dtype=torch.float64)
14 gae_duplicate tensor(-0.7634, dtype=torch.float64) tensor(-2.0307, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6745, dtype=torch.float64) delta_t tensor(0.4432, dtype=torch.float64)
13 gae_duplicate tensor(0.1774, dtype=torch.float64) tensor(-9.1097, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6292, dtype=torch.float64) delta_t tensor(0.4769, dtype=torch.float64)
12 gae_duplicate tensor(0.3741, dtype=torch.float64) tensor(-10.4799, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5077, dtype=torch.float64) delta_t tensor(-0.6295, dtype=torch.float64)
11 gae_duplicate tensor(-0.9170, dtype=torch.float64) tensor(11.6462, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3070, dtype=torch.float64) delta_t tensor(0.3204, dtype=torch.float64)
10 gae_duplicate tensor(-0.8626, dtype=torch.float64) tensor(-5.5194, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6118, dtype=torch.float64) delta_t tensor(-1.5449, dtype=torch.float64)
9 gae_duplicate tensor(-3.6087, dtype=torch.float64) tensor(32.1397, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.5743, dtype=torch.float64) delta_t tensor(-1.4240, dtype=torch.float64)
8 gae_duplicate tensor(-3.2585, dtype=torch.float64) tensor(29.3819, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1607, dtype=torch.float64) delta_t tensor(0.0429, dtype=torch.float64)
7 gae_duplicate tensor(-1.9825, dtype=torch.float64) tensor(2.2188, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1064, dtype=torch.float64) delta_t tensor(0.0705, dtype=torch.float64)
6 gae_duplicate tensor(-0.8689, dtype=torch.float64) tensor(-1.4599, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2306, dtype=torch.float64) delta_t tensor(-0.1901, dtype=torch.float64)
5 gae_duplicate tensor(-2.5966, dtype=torch.float64) tensor(3.9204, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2649, dtype=torch.float64) delta_t tensor(0.3636, dtype=torch.float64)
4 gae_duplicate tensor(-0.0762, dtype=torch.float64) tensor(-6.5665, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1641, dtype=torch.float64) delta_t tensor(0.1290, dtype=torch.float64)
3 gae_duplicate tensor(0.0059, dtype=torch.float64) tensor(-3.2771, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3305, dtype=torch.float64) delta_t tensor(-0.3851, dtype=torch.float64)
2 gae_duplicate tensor(-0.8477, dtype=torch.float64) tensor(7.0874, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-878.2306518554688
value loss:126.95978546142578
entropies:353.4346923828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.960891962051392 seconds
19 rew tensor(0.8809, dtype=torch.float64) delta_t tensor(0.3694, dtype=torch.float64)
19 gae_duplicate tensor(0.3385, dtype=torch.float64) tensor(-7.2050, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8821, dtype=torch.float64) delta_t tensor(0.4562, dtype=torch.float64)
18 gae_duplicate tensor(0.4344, dtype=torch.float64) tensor(-9.8767, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8651, dtype=torch.float64) delta_t tensor(0.4093, dtype=torch.float64)
17 gae_duplicate tensor(0.3416, dtype=torch.float64) tensor(-8.5789, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7600, dtype=torch.float64) delta_t tensor(0.4119, dtype=torch.float64)
16 gae_duplicate tensor(0.2738, dtype=torch.float64) tensor(-8.7522, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7773, dtype=torch.float64) delta_t tensor(0.3986, dtype=torch.float64)
15 gae_duplicate tensor(0.1649, dtype=torch.float64) tensor(-8.8074, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6053, dtype=torch.float64) delta_t tensor(0.3324, dtype=torch.float64)
14 gae_duplicate tensor(0.2722, dtype=torch.float64) tensor(-7.4887, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5988, dtype=torch.float64) delta_t tensor(0.2969, dtype=torch.float64)
13 gae_duplicate tensor(-0.7097, dtype=torch.float64) tensor(-6.6086, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3367, dtype=torch.float64) delta_t tensor(0.2556, dtype=torch.float64)
12 gae_duplicate tensor(-1.0405, dtype=torch.float64) tensor(-5.4941, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3919, dtype=torch.float64) delta_t tensor(0.2979, dtype=torch.float64)
11 gae_duplicate tensor(-0.7663, dtype=torch.float64) tensor(-6.1928, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0069, dtype=torch.float64) delta_t tensor(0.1480, dtype=torch.float64)
10 gae_duplicate tensor(-0.4444, dtype=torch.float64) tensor(-3.1638, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.8779, dtype=torch.float64) delta_t tensor(-1.8102, dtype=torch.float64)
9 gae_duplicate tensor(-4.4235, dtype=torch.float64) tensor(35.1038, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0724, dtype=torch.float64) delta_t tensor(-0.7874, dtype=torch.float64)
8 gae_duplicate tensor(-3.1103, dtype=torch.float64) tensor(19.0893, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6911, dtype=torch.float64) delta_t tensor(-0.4178, dtype=torch.float64)
7 gae_duplicate tensor(-1.7994, dtype=torch.float64) tensor(9.8509, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5896, dtype=torch.float64) delta_t tensor(-0.2757, dtype=torch.float64)
6 gae_duplicate tensor(-1.2537, dtype=torch.float64) tensor(6.1668, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0072, dtype=torch.float64) delta_t tensor(0.0120, dtype=torch.float64)
5 gae_duplicate tensor(-0.3530, dtype=torch.float64) tensor(0.2922, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0839, dtype=torch.float64) delta_t tensor(0.1230, dtype=torch.float64)
4 gae_duplicate tensor(-0.5127, dtype=torch.float64) tensor(-2.2841, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1718, dtype=torch.float64) delta_t tensor(0.1467, dtype=torch.float64)
3 gae_duplicate tensor(-0.2660, dtype=torch.float64) tensor(-3.3020, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3075, dtype=torch.float64) delta_t tensor(-0.4174, dtype=torch.float64)
2 gae_duplicate tensor(-0.8788, dtype=torch.float64) tensor(8.0868, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-140.55050659179688
value loss:128.6012725830078
entropies:353.44390869140625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3946.9465)
ToM Target loss= tensor(3568.0652)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.91076922416687 seconds
19 rew tensor(0.8526, dtype=torch.float64) delta_t tensor(0.3494, dtype=torch.float64)
19 gae_duplicate tensor(0.2376, dtype=torch.float64) tensor(-7.0581, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7980, dtype=torch.float64) delta_t tensor(0.3456, dtype=torch.float64)
18 gae_duplicate tensor(0.2338, dtype=torch.float64) tensor(-7.6442, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7094, dtype=torch.float64) delta_t tensor(0.2960, dtype=torch.float64)
17 gae_duplicate tensor(0.2809, dtype=torch.float64) tensor(-6.4286, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7208, dtype=torch.float64) delta_t tensor(0.3278, dtype=torch.float64)
16 gae_duplicate tensor(0.2653, dtype=torch.float64) tensor(-7.2463, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3942, dtype=torch.float64) delta_t tensor(0.0931, dtype=torch.float64)
15 gae_duplicate tensor(-0.9582, dtype=torch.float64) tensor(-2.6214, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4237, dtype=torch.float64) delta_t tensor(0.1454, dtype=torch.float64)
14 gae_duplicate tensor(-0.9804, dtype=torch.float64) tensor(-3.2462, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5125, dtype=torch.float64) delta_t tensor(0.4612, dtype=torch.float64)
13 gae_duplicate tensor(0.2032, dtype=torch.float64) tensor(-9.6660, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6186, dtype=torch.float64) delta_t tensor(0.3950, dtype=torch.float64)
12 gae_duplicate tensor(0.2892, dtype=torch.float64) tensor(-9.0968, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3544, dtype=torch.float64) delta_t tensor(-0.2110, dtype=torch.float64)
11 gae_duplicate tensor(-0.7875, dtype=torch.float64) tensor(3.1283, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4451, dtype=torch.float64) delta_t tensor(0.3420, dtype=torch.float64)
10 gae_duplicate tensor(0.0886, dtype=torch.float64) tensor(-6.1001, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4937, dtype=torch.float64) delta_t tensor(-1.0532, dtype=torch.float64)
9 gae_duplicate tensor(-3.6353, dtype=torch.float64) tensor(19.0508, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4800, dtype=torch.float64) delta_t tensor(-0.3408, dtype=torch.float64)
8 gae_duplicate tensor(-2.7102, dtype=torch.float64) tensor(8.9722, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2978, dtype=torch.float64) delta_t tensor(-0.7827, dtype=torch.float64)
7 gae_duplicate tensor(-1.8195, dtype=torch.float64) tensor(16.6374, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0692, dtype=torch.float64) delta_t tensor(0.1746, dtype=torch.float64)
6 gae_duplicate tensor(-1.1138, dtype=torch.float64) tensor(-1.6207, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6314, dtype=torch.float64) delta_t tensor(-0.4103, dtype=torch.float64)
5 gae_duplicate tensor(-2.9431, dtype=torch.float64) tensor(8.0408, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3607, dtype=torch.float64) delta_t tensor(0.3620, dtype=torch.float64)
4 gae_duplicate tensor(-0.5544, dtype=torch.float64) tensor(-6.1764, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1560, dtype=torch.float64) delta_t tensor(-0.0623, dtype=torch.float64)
3 gae_duplicate tensor(-0.5202, dtype=torch.float64) tensor(0.3846, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0659, dtype=torch.float64) delta_t tensor(-0.2038, dtype=torch.float64)
2 gae_duplicate tensor(-0.8345, dtype=torch.float64) tensor(4.0915, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:260.9714050292969
value loss:107.97273254394531
entropies:353.2957763671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.701526165008545 seconds
19 rew tensor(0.8658, dtype=torch.float64) delta_t tensor(0.3288, dtype=torch.float64)
19 gae_duplicate tensor(0.2717, dtype=torch.float64) tensor(-6.8348, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8303, dtype=torch.float64) delta_t tensor(0.3903, dtype=torch.float64)
18 gae_duplicate tensor(0.2490, dtype=torch.float64) tensor(-8.0336, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8488, dtype=torch.float64) delta_t tensor(0.3676, dtype=torch.float64)
17 gae_duplicate tensor(0.3378, dtype=torch.float64) tensor(-7.9387, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7016, dtype=torch.float64) delta_t tensor(0.2911, dtype=torch.float64)
16 gae_duplicate tensor(0.2134, dtype=torch.float64) tensor(-6.4886, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7752, dtype=torch.float64) delta_t tensor(0.3823, dtype=torch.float64)
15 gae_duplicate tensor(0.2456, dtype=torch.float64) tensor(-8.4353, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6279, dtype=torch.float64) delta_t tensor(0.4317, dtype=torch.float64)
14 gae_duplicate tensor(0.3188, dtype=torch.float64) tensor(-9.3838, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6913, dtype=torch.float64) delta_t tensor(0.4091, dtype=torch.float64)
13 gae_duplicate tensor(0.1504, dtype=torch.float64) tensor(-9.5538, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3286, dtype=torch.float64) delta_t tensor(0.4036, dtype=torch.float64)
12 gae_duplicate tensor(-0.5360, dtype=torch.float64) tensor(-9.3945, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4369, dtype=torch.float64) delta_t tensor(-0.5354, dtype=torch.float64)
11 gae_duplicate tensor(-1.9512, dtype=torch.float64) tensor(9.4511, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0791, dtype=torch.float64) delta_t tensor(0.2710, dtype=torch.float64)
10 gae_duplicate tensor(-0.4175, dtype=torch.float64) tensor(-4.5483, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.7719, dtype=torch.float64) delta_t tensor(-2.6490, dtype=torch.float64)
9 gae_duplicate tensor(-6.1085, dtype=torch.float64) tensor(51.7239, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7391, dtype=torch.float64) delta_t tensor(-0.4244, dtype=torch.float64)
8 gae_duplicate tensor(-1.9971, dtype=torch.float64) tensor(12.8906, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2226, dtype=torch.float64) delta_t tensor(0.0100, dtype=torch.float64)
7 gae_duplicate tensor(-1.7007, dtype=torch.float64) tensor(0.8479, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1098, dtype=torch.float64) delta_t tensor(0.2035, dtype=torch.float64)
6 gae_duplicate tensor(-0.8078, dtype=torch.float64) tensor(-3.8153, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2458, dtype=torch.float64) delta_t tensor(-0.2089, dtype=torch.float64)
5 gae_duplicate tensor(-2.7682, dtype=torch.float64) tensor(3.2597, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1898, dtype=torch.float64) delta_t tensor(0.2190, dtype=torch.float64)
4 gae_duplicate tensor(-0.0126, dtype=torch.float64) tensor(-3.8127, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1852, dtype=torch.float64) delta_t tensor(0.1195, dtype=torch.float64)
3 gae_duplicate tensor(-0.1657, dtype=torch.float64) tensor(-2.5716, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3415, dtype=torch.float64) delta_t tensor(-0.4272, dtype=torch.float64)
2 gae_duplicate tensor(-0.7469, dtype=torch.float64) tensor(7.9661, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-383.1412353515625
value loss:177.73770141601562
entropies:353.37701416015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.332688808441162 seconds
19 rew tensor(0.8476, dtype=torch.float64) delta_t tensor(0.3086, dtype=torch.float64)
19 gae_duplicate tensor(0.1834, dtype=torch.float64) tensor(-6.1237, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8108, dtype=torch.float64) delta_t tensor(0.3783, dtype=torch.float64)
18 gae_duplicate tensor(0.3171, dtype=torch.float64) tensor(-8.0896, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7925, dtype=torch.float64) delta_t tensor(0.3230, dtype=torch.float64)
17 gae_duplicate tensor(0.3015, dtype=torch.float64) tensor(-7.1539, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6991, dtype=torch.float64) delta_t tensor(0.3858, dtype=torch.float64)
16 gae_duplicate tensor(0.2502, dtype=torch.float64) tensor(-8.6561, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6523, dtype=torch.float64) delta_t tensor(0.3091, dtype=torch.float64)
15 gae_duplicate tensor(0.1847, dtype=torch.float64) tensor(-6.8048, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5003, dtype=torch.float64) delta_t tensor(0.3551, dtype=torch.float64)
14 gae_duplicate tensor(0.1975, dtype=torch.float64) tensor(-7.1089, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4025, dtype=torch.float64) delta_t tensor(0.3516, dtype=torch.float64)
13 gae_duplicate tensor(-0.7960, dtype=torch.float64) tensor(-7.9679, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2875, dtype=torch.float64) delta_t tensor(0.3166, dtype=torch.float64)
12 gae_duplicate tensor(-0.3921, dtype=torch.float64) tensor(-7.2015, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3425, dtype=torch.float64) delta_t tensor(-0.1911, dtype=torch.float64)
11 gae_duplicate tensor(-0.8780, dtype=torch.float64) tensor(2.9356, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.9467, dtype=torch.float64) delta_t tensor(-0.9775, dtype=torch.float64)
10 gae_duplicate tensor(-2.2213, dtype=torch.float64) tensor(19.9093, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4231, dtype=torch.float64) delta_t tensor(-0.9902, dtype=torch.float64)
9 gae_duplicate tensor(-2.7984, dtype=torch.float64) tensor(21.3903, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2468, dtype=torch.float64) delta_t tensor(-0.0053, dtype=torch.float64)
8 gae_duplicate tensor(-1.9210, dtype=torch.float64) tensor(1.9713, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0234, dtype=torch.float64) delta_t tensor(0.4290, dtype=torch.float64)
7 gae_duplicate tensor(-0.5641, dtype=torch.float64) tensor(-8.4501, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2438, dtype=torch.float64) delta_t tensor(0.5086, dtype=torch.float64)
6 gae_duplicate tensor(0.4202, dtype=torch.float64) tensor(-10.2578, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0799, dtype=torch.float64) delta_t tensor(0.1369, dtype=torch.float64)
5 gae_duplicate tensor(-0.2702, dtype=torch.float64) tensor(-3.9224, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2643, dtype=torch.float64) delta_t tensor(0.3188, dtype=torch.float64)
4 gae_duplicate tensor(-0.0173, dtype=torch.float64) tensor(-6.5807, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1454, dtype=torch.float64) delta_t tensor(0.0806, dtype=torch.float64)
3 gae_duplicate tensor(-0.3295, dtype=torch.float64) tensor(-2.2127, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2506, dtype=torch.float64) delta_t tensor(-0.3304, dtype=torch.float64)
2 gae_duplicate tensor(-0.5511, dtype=torch.float64) tensor(6.5583, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1943.8251953125
value loss:81.4534683227539
entropies:353.7026062011719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.783383131027222 seconds
19 rew tensor(0.8297, dtype=torch.float64) delta_t tensor(0.2859, dtype=torch.float64)
19 gae_duplicate tensor(0.2126, dtype=torch.float64) tensor(-5.4317, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5222, dtype=torch.float64) delta_t tensor(0.0322, dtype=torch.float64)
18 gae_duplicate tensor(-0.9665, dtype=torch.float64) tensor(-1.2230, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5339, dtype=torch.float64) delta_t tensor(0.0958, dtype=torch.float64)
17 gae_duplicate tensor(-0.9595, dtype=torch.float64) tensor(-1.8454, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6677, dtype=torch.float64) delta_t tensor(0.2387, dtype=torch.float64)
16 gae_duplicate tensor(0.1039, dtype=torch.float64) tensor(-5.2160, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3785, dtype=torch.float64) delta_t tensor(0.0271, dtype=torch.float64)
15 gae_duplicate tensor(-0.8952, dtype=torch.float64) tensor(-0.6505, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4556, dtype=torch.float64) delta_t tensor(0.1980, dtype=torch.float64)
14 gae_duplicate tensor(-0.7885, dtype=torch.float64) tensor(-3.9124, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5599, dtype=torch.float64) delta_t tensor(0.4409, dtype=torch.float64)
13 gae_duplicate tensor(0.3351, dtype=torch.float64) tensor(-9.4142, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2039, dtype=torch.float64) delta_t tensor(0.1242, dtype=torch.float64)
12 gae_duplicate tensor(-0.7017, dtype=torch.float64) tensor(-3.2604, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2564, dtype=torch.float64) delta_t tensor(-0.3028, dtype=torch.float64)
11 gae_duplicate tensor(-1.7783, dtype=torch.float64) tensor(5.1406, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2866, dtype=torch.float64) delta_t tensor(0.2798, dtype=torch.float64)
10 gae_duplicate tensor(-0.6718, dtype=torch.float64) tensor(-4.5094, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6035, dtype=torch.float64) delta_t tensor(-1.3520, dtype=torch.float64)
9 gae_duplicate tensor(-3.5721, dtype=torch.float64) tensor(26.8248, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.2330, dtype=torch.float64) delta_t tensor(-1.9945, dtype=torch.float64)
8 gae_duplicate tensor(-4.0502, dtype=torch.float64) tensor(40.3216, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6088, dtype=torch.float64) delta_t tensor(-0.2959, dtype=torch.float64)
7 gae_duplicate tensor(-1.8661, dtype=torch.float64) tensor(9.3043, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2861, dtype=torch.float64) delta_t tensor(0.5103, dtype=torch.float64)
6 gae_duplicate tensor(0.0838, dtype=torch.float64) tensor(-8.6219, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1176, dtype=torch.float64) delta_t tensor(0.2347, dtype=torch.float64)
5 gae_duplicate tensor(-0.1337, dtype=torch.float64) tensor(-5.4938, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2077, dtype=torch.float64) delta_t tensor(0.2697, dtype=torch.float64)
4 gae_duplicate tensor(-0.3901, dtype=torch.float64) tensor(-6.3104, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1680, dtype=torch.float64) delta_t tensor(0.0906, dtype=torch.float64)
3 gae_duplicate tensor(-0.1515, dtype=torch.float64) tensor(-2.5033, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3130, dtype=torch.float64) delta_t tensor(-0.3784, dtype=torch.float64)
2 gae_duplicate tensor(-0.8815, dtype=torch.float64) tensor(7.1761, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1735.8111572265625
value loss:148.0711212158203
entropies:353.8832092285156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.943460941314697 seconds
19 rew tensor(0.8127, dtype=torch.float64) delta_t tensor(0.2599, dtype=torch.float64)
19 gae_duplicate tensor(0.1876, dtype=torch.float64) tensor(-5.1176, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7378, dtype=torch.float64) delta_t tensor(0.2486, dtype=torch.float64)
18 gae_duplicate tensor(0.0428, dtype=torch.float64) tensor(-5.2699, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7208, dtype=torch.float64) delta_t tensor(0.2829, dtype=torch.float64)
17 gae_duplicate tensor(0.2747, dtype=torch.float64) tensor(-6.0354, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6603, dtype=torch.float64) delta_t tensor(0.3135, dtype=torch.float64)
16 gae_duplicate tensor(0.2159, dtype=torch.float64) tensor(-6.9792, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5416, dtype=torch.float64) delta_t tensor(0.1299, dtype=torch.float64)
15 gae_duplicate tensor(0.0875, dtype=torch.float64) tensor(-3.1506, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1872, dtype=torch.float64) delta_t tensor(0.1707, dtype=torch.float64)
14 gae_duplicate tensor(-0.7945, dtype=torch.float64) tensor(-3.6760, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3818, dtype=torch.float64) delta_t tensor(0.1390, dtype=torch.float64)
13 gae_duplicate tensor(-0.9469, dtype=torch.float64) tensor(-3.0573, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2006, dtype=torch.float64) delta_t tensor(0.2952, dtype=torch.float64)
12 gae_duplicate tensor(-0.5039, dtype=torch.float64) tensor(-5.8452, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3384, dtype=torch.float64) delta_t tensor(-0.5276, dtype=torch.float64)
11 gae_duplicate tensor(-1.9081, dtype=torch.float64) tensor(9.9395, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1335, dtype=torch.float64) delta_t tensor(0.2930, dtype=torch.float64)
10 gae_duplicate tensor(-0.7710, dtype=torch.float64) tensor(-4.9519, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3232, dtype=torch.float64) delta_t tensor(-1.2804, dtype=torch.float64)
9 gae_duplicate tensor(-2.4315, dtype=torch.float64) tensor(25.3173, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.2834, dtype=torch.float64) delta_t tensor(-1.7576, dtype=torch.float64)
8 gae_duplicate tensor(-2.9417, dtype=torch.float64) tensor(39.0274, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2202, dtype=torch.float64) delta_t tensor(0.3046, dtype=torch.float64)
7 gae_duplicate tensor(-1.6440, dtype=torch.float64) tensor(-2.0148, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0636, dtype=torch.float64) delta_t tensor(0.5733, dtype=torch.float64)
6 gae_duplicate tensor(0.4743, dtype=torch.float64) tensor(-11.5113, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3525, dtype=torch.float64) delta_t tensor(0.3468, dtype=torch.float64)
5 gae_duplicate tensor(0.2683, dtype=torch.float64) tensor(-8.0199, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1045, dtype=torch.float64) delta_t tensor(0.2339, dtype=torch.float64)
4 gae_duplicate tensor(-0.1118, dtype=torch.float64) tensor(-5.5141, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2939, dtype=torch.float64) delta_t tensor(0.2067, dtype=torch.float64)
3 gae_duplicate tensor(-0.0744, dtype=torch.float64) tensor(-4.6048, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4056, dtype=torch.float64) delta_t tensor(-0.3835, dtype=torch.float64)
2 gae_duplicate tensor(-0.5471, dtype=torch.float64) tensor(7.1032, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-400.1634826660156
value loss:109.27285766601562
entropies:354.205078125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3958.1035)
ToM Target loss= tensor(3573.6567)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.910749197006226 seconds
19 rew tensor(0.8503, dtype=torch.float64) delta_t tensor(0.2347, dtype=torch.float64)
19 gae_duplicate tensor(0.1739, dtype=torch.float64) tensor(-4.7736, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8411, dtype=torch.float64) delta_t tensor(0.3001, dtype=torch.float64)
18 gae_duplicate tensor(0.2503, dtype=torch.float64) tensor(-6.1511, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7855, dtype=torch.float64) delta_t tensor(0.2864, dtype=torch.float64)
17 gae_duplicate tensor(0.2139, dtype=torch.float64) tensor(-6.1956, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7771, dtype=torch.float64) delta_t tensor(0.3063, dtype=torch.float64)
16 gae_duplicate tensor(0.1636, dtype=torch.float64) tensor(-6.6696, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7113, dtype=torch.float64) delta_t tensor(0.3310, dtype=torch.float64)
15 gae_duplicate tensor(0.2263, dtype=torch.float64) tensor(-7.0422, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3116, dtype=torch.float64) delta_t tensor(-0.0024, dtype=torch.float64)
14 gae_duplicate tensor(-0.8427, dtype=torch.float64) tensor(-0.9078, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5513, dtype=torch.float64) delta_t tensor(0.5003, dtype=torch.float64)
13 gae_duplicate tensor(0.0885, dtype=torch.float64) tensor(-9.6099, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5967, dtype=torch.float64) delta_t tensor(0.4065, dtype=torch.float64)
12 gae_duplicate tensor(0.2004, dtype=torch.float64) tensor(-8.7921, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5845, dtype=torch.float64) delta_t tensor(-0.2831, dtype=torch.float64)
11 gae_duplicate tensor(-1.8108, dtype=torch.float64) tensor(4.7456, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0575, dtype=torch.float64) delta_t tensor(-0.2185, dtype=torch.float64)
10 gae_duplicate tensor(-1.7135, dtype=torch.float64) tensor(4.6761, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.2186, dtype=torch.float64) delta_t tensor(-1.6151, dtype=torch.float64)
9 gae_duplicate tensor(-4.3378, dtype=torch.float64) tensor(32.1247, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2367, dtype=torch.float64) delta_t tensor(-1.1773, dtype=torch.float64)
8 gae_duplicate tensor(-2.7189, dtype=torch.float64) tensor(25.7734, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8477, dtype=torch.float64) delta_t tensor(-0.1896, dtype=torch.float64)
7 gae_duplicate tensor(-1.5382, dtype=torch.float64) tensor(6.7740, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5485, dtype=torch.float64) delta_t tensor(-0.4804, dtype=torch.float64)
6 gae_duplicate tensor(-3.1698, dtype=torch.float64) tensor(11.4813, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3904, dtype=torch.float64) delta_t tensor(-0.1229, dtype=torch.float64)
5 gae_duplicate tensor(-1.8441, dtype=torch.float64) tensor(3.5841, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4754, dtype=torch.float64) delta_t tensor(0.3182, dtype=torch.float64)
4 gae_duplicate tensor(0.0319, dtype=torch.float64) tensor(-6.0864, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0362, dtype=torch.float64) delta_t tensor(-0.1156, dtype=torch.float64)
3 gae_duplicate tensor(-0.5310, dtype=torch.float64) tensor(1.5569, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1881, dtype=torch.float64) delta_t tensor(-0.3906, dtype=torch.float64)
2 gae_duplicate tensor(-0.8826, dtype=torch.float64) tensor(7.9782, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2388.818115234375
value loss:142.81277465820312
entropies:354.3260192871094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.703189134597778 seconds
19 rew tensor(0.8597, dtype=torch.float64) delta_t tensor(0.2305, dtype=torch.float64)
19 gae_duplicate tensor(0.1146, dtype=torch.float64) tensor(-4.5492, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7742, dtype=torch.float64) delta_t tensor(0.2914, dtype=torch.float64)
18 gae_duplicate tensor(0.1735, dtype=torch.float64) tensor(-5.9977, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7676, dtype=torch.float64) delta_t tensor(0.2498, dtype=torch.float64)
17 gae_duplicate tensor(0.1456, dtype=torch.float64) tensor(-5.3912, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6270, dtype=torch.float64) delta_t tensor(0.2483, dtype=torch.float64)
16 gae_duplicate tensor(0.1903, dtype=torch.float64) tensor(-5.2721, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6901, dtype=torch.float64) delta_t tensor(0.2639, dtype=torch.float64)
15 gae_duplicate tensor(0.0606, dtype=torch.float64) tensor(-5.8959, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3446, dtype=torch.float64) delta_t tensor(0.2638, dtype=torch.float64)
14 gae_duplicate tensor(-0.8259, dtype=torch.float64) tensor(-6.0954, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5969, dtype=torch.float64) delta_t tensor(0.2969, dtype=torch.float64)
13 gae_duplicate tensor(0.0912, dtype=torch.float64) tensor(-6.2949, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2573, dtype=torch.float64) delta_t tensor(0.4831, dtype=torch.float64)
12 gae_duplicate tensor(-0.1810, dtype=torch.float64) tensor(-10.5425, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2287, dtype=torch.float64) delta_t tensor(-0.3707, dtype=torch.float64)
11 gae_duplicate tensor(-1.9807, dtype=torch.float64) tensor(5.5894, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2985, dtype=torch.float64) delta_t tensor(0.0849, dtype=torch.float64)
10 gae_duplicate tensor(-1.5153, dtype=torch.float64) tensor(-1.2710, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7586, dtype=torch.float64) delta_t tensor(-1.6397, dtype=torch.float64)
9 gae_duplicate tensor(-3.7940, dtype=torch.float64) tensor(30.4204, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5962, dtype=torch.float64) delta_t tensor(-0.1260, dtype=torch.float64)
8 gae_duplicate tensor(-3.2646, dtype=torch.float64) tensor(6.5635, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2572, dtype=torch.float64) delta_t tensor(0.4252, dtype=torch.float64)
7 gae_duplicate tensor(-0.4099, dtype=torch.float64) tensor(-7.5982, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1166, dtype=torch.float64) delta_t tensor(0.3695, dtype=torch.float64)
6 gae_duplicate tensor(-0.8278, dtype=torch.float64) tensor(-8.2283, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1523, dtype=torch.float64) delta_t tensor(0.1112, dtype=torch.float64)
5 gae_duplicate tensor(-0.0943, dtype=torch.float64) tensor(-2.8718, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0462, dtype=torch.float64) delta_t tensor(0.1676, dtype=torch.float64)
4 gae_duplicate tensor(-0.0358, dtype=torch.float64) tensor(-3.5219, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3338, dtype=torch.float64) delta_t tensor(0.1202, dtype=torch.float64)
3 gae_duplicate tensor(-0.3609, dtype=torch.float64) tensor(-2.7050, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4497, dtype=torch.float64) delta_t tensor(-0.4905, dtype=torch.float64)
2 gae_duplicate tensor(-0.8038, dtype=torch.float64) tensor(9.2143, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1224.51025390625
value loss:119.31432342529297
entropies:354.2520446777344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.059875726699829 seconds
19 rew tensor(0.8786, dtype=torch.float64) delta_t tensor(0.2163, dtype=torch.float64)
19 gae_duplicate tensor(0.1929, dtype=torch.float64) tensor(-4.2812, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8318, dtype=torch.float64) delta_t tensor(0.2982, dtype=torch.float64)
18 gae_duplicate tensor(0.2418, dtype=torch.float64) tensor(-6.0785, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8049, dtype=torch.float64) delta_t tensor(0.2254, dtype=torch.float64)
17 gae_duplicate tensor(0.1152, dtype=torch.float64) tensor(-5.0586, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6812, dtype=torch.float64) delta_t tensor(0.2731, dtype=torch.float64)
16 gae_duplicate tensor(0.1840, dtype=torch.float64) tensor(-5.4584, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7374, dtype=torch.float64) delta_t tensor(0.2293, dtype=torch.float64)
15 gae_duplicate tensor(0.0778, dtype=torch.float64) tensor(-5.1437, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5393, dtype=torch.float64) delta_t tensor(0.4205, dtype=torch.float64)
14 gae_duplicate tensor(0.2287, dtype=torch.float64) tensor(-8.9404, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4454, dtype=torch.float64) delta_t tensor(0.2219, dtype=torch.float64)
13 gae_duplicate tensor(-0.8363, dtype=torch.float64) tensor(-4.9943, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3710, dtype=torch.float64) delta_t tensor(0.5859, dtype=torch.float64)
12 gae_duplicate tensor(0.1500, dtype=torch.float64) tensor(-12.0130, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4602, dtype=torch.float64) delta_t tensor(-0.4753, dtype=torch.float64)
11 gae_duplicate tensor(-1.4026, dtype=torch.float64) tensor(7.8501, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.1831, dtype=torch.float64) delta_t tensor(-0.9050, dtype=torch.float64)
10 gae_duplicate tensor(-1.7127, dtype=torch.float64) tensor(18.0211, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5189, dtype=torch.float64) delta_t tensor(-0.3488, dtype=torch.float64)
9 gae_duplicate tensor(-2.5211, dtype=torch.float64) tensor(8.9408, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9873, dtype=torch.float64) delta_t tensor(-0.4776, dtype=torch.float64)
8 gae_duplicate tensor(-3.2495, dtype=torch.float64) tensor(9.8546, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2119, dtype=torch.float64) delta_t tensor(0.4310, dtype=torch.float64)
7 gae_duplicate tensor(-0.4971, dtype=torch.float64) tensor(-7.8451, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0094, dtype=torch.float64) delta_t tensor(0.5598, dtype=torch.float64)
6 gae_duplicate tensor(0.3745, dtype=torch.float64) tensor(-11.4886, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1101, dtype=torch.float64) delta_t tensor(0.1456, dtype=torch.float64)
5 gae_duplicate tensor(-0.0316, dtype=torch.float64) tensor(-3.9500, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0684, dtype=torch.float64) delta_t tensor(0.0966, dtype=torch.float64)
4 gae_duplicate tensor(-0.1656, dtype=torch.float64) tensor(-2.2902, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4826, dtype=torch.float64) delta_t tensor(0.2789, dtype=torch.float64)
3 gae_duplicate tensor(0.0434, dtype=torch.float64) tensor(-5.6137, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4868, dtype=torch.float64) delta_t tensor(-0.4160, dtype=torch.float64)
2 gae_duplicate tensor(-0.6509, dtype=torch.float64) tensor(7.6887, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1567.5404052734375
value loss:92.57911682128906
entropies:354.3288269042969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.734703063964844 seconds
19 rew tensor(0.8513, dtype=torch.float64) delta_t tensor(0.1907, dtype=torch.float64)
19 gae_duplicate tensor(0.1369, dtype=torch.float64) tensor(-3.7734, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7480, dtype=torch.float64) delta_t tensor(0.1979, dtype=torch.float64)
18 gae_duplicate tensor(0.1377, dtype=torch.float64) tensor(-4.2514, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7679, dtype=torch.float64) delta_t tensor(0.2166, dtype=torch.float64)
17 gae_duplicate tensor(0.0768, dtype=torch.float64) tensor(-4.6349, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6447, dtype=torch.float64) delta_t tensor(0.2129, dtype=torch.float64)
16 gae_duplicate tensor(0.0781, dtype=torch.float64) tensor(-4.7662, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6431, dtype=torch.float64) delta_t tensor(0.1520, dtype=torch.float64)
15 gae_duplicate tensor(0.0465, dtype=torch.float64) tensor(-3.5871, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3903, dtype=torch.float64) delta_t tensor(0.2202, dtype=torch.float64)
14 gae_duplicate tensor(-0.8514, dtype=torch.float64) tensor(-4.6820, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4407, dtype=torch.float64) delta_t tensor(0.0700, dtype=torch.float64)
13 gae_duplicate tensor(-0.8177, dtype=torch.float64) tensor(-1.8214, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4725, dtype=torch.float64) delta_t tensor(0.4735, dtype=torch.float64)
12 gae_duplicate tensor(0.1220, dtype=torch.float64) tensor(-9.3320, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1901, dtype=torch.float64) delta_t tensor(-0.3765, dtype=torch.float64)
11 gae_duplicate tensor(-1.9483, dtype=torch.float64) tensor(6.3071, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1272, dtype=torch.float64) delta_t tensor(0.4495, dtype=torch.float64)
10 gae_duplicate tensor(-1.0740, dtype=torch.float64) tensor(-8.7568, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0414, dtype=torch.float64) delta_t tensor(-0.9660, dtype=torch.float64)
9 gae_duplicate tensor(-2.5118, dtype=torch.float64) tensor(18.1486, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3323, dtype=torch.float64) delta_t tensor(-0.8195, dtype=torch.float64)
8 gae_duplicate tensor(-3.1404, dtype=torch.float64) tensor(18.5928, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5297, dtype=torch.float64) delta_t tensor(-0.3490, dtype=torch.float64)
7 gae_duplicate tensor(-1.9005, dtype=torch.float64) tensor(8.9475, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1358, dtype=torch.float64) delta_t tensor(0.3168, dtype=torch.float64)
6 gae_duplicate tensor(-0.9350, dtype=torch.float64) tensor(-5.6291, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2124, dtype=torch.float64) delta_t tensor(0.1425, dtype=torch.float64)
5 gae_duplicate tensor(-0.0837, dtype=torch.float64) tensor(-3.3735, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1252, dtype=torch.float64) delta_t tensor(0.0804, dtype=torch.float64)
4 gae_duplicate tensor(-0.4474, dtype=torch.float64) tensor(-1.7350, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2025, dtype=torch.float64) delta_t tensor(-0.0185, dtype=torch.float64)
3 gae_duplicate tensor(-0.2537, dtype=torch.float64) tensor(0.1284, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3616, dtype=torch.float64) delta_t tensor(-0.4933, dtype=torch.float64)
2 gae_duplicate tensor(-0.6817, dtype=torch.float64) tensor(9.8268, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-398.570556640625
value loss:88.0394287109375
entropies:354.5203857421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.666677951812744 seconds
19 rew tensor(0.8345, dtype=torch.float64) delta_t tensor(0.1813, dtype=torch.float64)
19 gae_duplicate tensor(0.1014, dtype=torch.float64) tensor(-3.5333, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7696, dtype=torch.float64) delta_t tensor(0.2020, dtype=torch.float64)
18 gae_duplicate tensor(-0.0287, dtype=torch.float64) tensor(-4.3871, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7318, dtype=torch.float64) delta_t tensor(0.2662, dtype=torch.float64)
17 gae_duplicate tensor(0.1961, dtype=torch.float64) tensor(-5.5957, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6423, dtype=torch.float64) delta_t tensor(0.1577, dtype=torch.float64)
16 gae_duplicate tensor(0.0442, dtype=torch.float64) tensor(-3.7314, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5822, dtype=torch.float64) delta_t tensor(0.1792, dtype=torch.float64)
15 gae_duplicate tensor(0.0214, dtype=torch.float64) tensor(-3.9095, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0590, dtype=torch.float64) delta_t tensor(-0.1575, dtype=torch.float64)
14 gae_duplicate tensor(-0.8894, dtype=torch.float64) tensor(2.9480, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4855, dtype=torch.float64) delta_t tensor(0.2567, dtype=torch.float64)
13 gae_duplicate tensor(0.0417, dtype=torch.float64) tensor(-4.9694, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5374, dtype=torch.float64) delta_t tensor(0.5668, dtype=torch.float64)
12 gae_duplicate tensor(0.3433, dtype=torch.float64) tensor(-11.9160, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0792, dtype=torch.float64) delta_t tensor(-0.0899, dtype=torch.float64)
11 gae_duplicate tensor(-1.8366, dtype=torch.float64) tensor(0.9358, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0226, dtype=torch.float64) delta_t tensor(0.1569, dtype=torch.float64)
10 gae_duplicate tensor(-0.9827, dtype=torch.float64) tensor(-2.8974, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4476, dtype=torch.float64) delta_t tensor(-1.1742, dtype=torch.float64)
9 gae_duplicate tensor(-3.0326, dtype=torch.float64) tensor(22.9888, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6405, dtype=torch.float64) delta_t tensor(-1.2399, dtype=torch.float64)
8 gae_duplicate tensor(-4.1449, dtype=torch.float64) tensor(26.8153, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3686, dtype=torch.float64) delta_t tensor(0.7072, dtype=torch.float64)
7 gae_duplicate tensor(0.3992, dtype=torch.float64) tensor(-11.3134, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4291, dtype=torch.float64) delta_t tensor(-0.0575, dtype=torch.float64)
6 gae_duplicate tensor(-1.7591, dtype=torch.float64) tensor(-0.1507, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0814, dtype=torch.float64) delta_t tensor(0.0837, dtype=torch.float64)
5 gae_duplicate tensor(-0.2680, dtype=torch.float64) tensor(-1.6924, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1509, dtype=torch.float64) delta_t tensor(0.0584, dtype=torch.float64)
4 gae_duplicate tensor(-0.4510, dtype=torch.float64) tensor(-1.3577, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2093, dtype=torch.float64) delta_t tensor(0.1079, dtype=torch.float64)
3 gae_duplicate tensor(-0.1714, dtype=torch.float64) tensor(-2.2559, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3411, dtype=torch.float64) delta_t tensor(-0.3938, dtype=torch.float64)
2 gae_duplicate tensor(-0.6788, dtype=torch.float64) tensor(7.5885, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-288.32830810546875
value loss:124.27528381347656
entropies:354.6109619140625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3953.9937)
ToM Target loss= tensor(3576.5117)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.233551979064941 seconds
19 rew tensor(0.8536, dtype=torch.float64) delta_t tensor(0.1844, dtype=torch.float64)
19 gae_duplicate tensor(0.0919, dtype=torch.float64) tensor(-3.6284, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8065, dtype=torch.float64) delta_t tensor(0.1869, dtype=torch.float64)
18 gae_duplicate tensor(0.0804, dtype=torch.float64) tensor(-3.8473, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7896, dtype=torch.float64) delta_t tensor(0.3094, dtype=torch.float64)
17 gae_duplicate tensor(0.1111, dtype=torch.float64) tensor(-6.4530, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6825, dtype=torch.float64) delta_t tensor(0.1453, dtype=torch.float64)
16 gae_duplicate tensor(0.0368, dtype=torch.float64) tensor(-3.4018, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5424, dtype=torch.float64) delta_t tensor(0.2084, dtype=torch.float64)
15 gae_duplicate tensor(0.0151, dtype=torch.float64) tensor(-4.5316, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4754, dtype=torch.float64) delta_t tensor(0.1834, dtype=torch.float64)
14 gae_duplicate tensor(-0.9167, dtype=torch.float64) tensor(-3.8952, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4759, dtype=torch.float64) delta_t tensor(0.3179, dtype=torch.float64)
13 gae_duplicate tensor(0.0604, dtype=torch.float64) tensor(-6.7948, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5976, dtype=torch.float64) delta_t tensor(0.4412, dtype=torch.float64)
12 gae_duplicate tensor(0.2137, dtype=torch.float64) tensor(-9.5330, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7239, dtype=torch.float64) delta_t tensor(-0.5222, dtype=torch.float64)
11 gae_duplicate tensor(-1.9583, dtype=torch.float64) tensor(9.8643, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3658, dtype=torch.float64) delta_t tensor(-0.4363, dtype=torch.float64)
10 gae_duplicate tensor(-2.0709, dtype=torch.float64) tensor(9.5324, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8890, dtype=torch.float64) delta_t tensor(-0.2841, dtype=torch.float64)
9 gae_duplicate tensor(-2.5063, dtype=torch.float64) tensor(6.9912, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9221, dtype=torch.float64) delta_t tensor(-0.8201, dtype=torch.float64)
8 gae_duplicate tensor(-2.8454, dtype=torch.float64) tensor(16.0595, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6900, dtype=torch.float64) delta_t tensor(-1.0142, dtype=torch.float64)
7 gae_duplicate tensor(-2.7597, dtype=torch.float64) tensor(23.4440, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1637, dtype=torch.float64) delta_t tensor(-0.0687, dtype=torch.float64)
6 gae_duplicate tensor(-2.0754, dtype=torch.float64) tensor(3.5993, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4415, dtype=torch.float64) delta_t tensor(-0.1286, dtype=torch.float64)
5 gae_duplicate tensor(-1.3565, dtype=torch.float64) tensor(2.9264, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4800, dtype=torch.float64) delta_t tensor(0.2660, dtype=torch.float64)
4 gae_duplicate tensor(0.0628, dtype=torch.float64) tensor(-5.0502, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1732, dtype=torch.float64) delta_t tensor(-0.1357, dtype=torch.float64)
3 gae_duplicate tensor(-0.2279, dtype=torch.float64) tensor(2.1951, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0535, dtype=torch.float64) delta_t tensor(-0.2513, dtype=torch.float64)
2 gae_duplicate tensor(-0.4276, dtype=torch.float64) tensor(5.1731, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1858.8824462890625
value loss:113.15946960449219
entropies:354.73199462890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7256999015808105 seconds
19 rew tensor(0.8645, dtype=torch.float64) delta_t tensor(0.1445, dtype=torch.float64)
19 gae_duplicate tensor(0.1143, dtype=torch.float64) tensor(-2.9383, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5655, dtype=torch.float64) delta_t tensor(0.0263, dtype=torch.float64)
18 gae_duplicate tensor(-1.0183, dtype=torch.float64) tensor(-1.2598, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8565, dtype=torch.float64) delta_t tensor(0.2521, dtype=torch.float64)
17 gae_duplicate tensor(0.1032, dtype=torch.float64) tensor(-5.0114, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5814, dtype=torch.float64) delta_t tensor(0.2145, dtype=torch.float64)
16 gae_duplicate tensor(0.0209, dtype=torch.float64) tensor(-4.7006, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3172, dtype=torch.float64) delta_t tensor(-0.2094, dtype=torch.float64)
15 gae_duplicate tensor(-0.8952, dtype=torch.float64) tensor(3.6485, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0988, dtype=torch.float64) delta_t tensor(0.0372, dtype=torch.float64)
14 gae_duplicate tensor(-0.9529, dtype=torch.float64) tensor(-0.2573, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4903, dtype=torch.float64) delta_t tensor(0.0600, dtype=torch.float64)
13 gae_duplicate tensor(-0.7866, dtype=torch.float64) tensor(-1.1745, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2390, dtype=torch.float64) delta_t tensor(0.1977, dtype=torch.float64)
12 gae_duplicate tensor(-0.8786, dtype=torch.float64) tensor(-3.7336, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4574, dtype=torch.float64) delta_t tensor(-0.6969, dtype=torch.float64)
11 gae_duplicate tensor(-1.9467, dtype=torch.float64) tensor(13.7015, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0122, dtype=torch.float64) delta_t tensor(0.1790, dtype=torch.float64)
10 gae_duplicate tensor(-0.9382, dtype=torch.float64) tensor(-2.1080, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2800, dtype=torch.float64) delta_t tensor(-1.2760, dtype=torch.float64)
9 gae_duplicate tensor(-3.0475, dtype=torch.float64) tensor(24.2722, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.8052, dtype=torch.float64) delta_t tensor(-1.4320, dtype=torch.float64)
8 gae_duplicate tensor(-4.1690, dtype=torch.float64) tensor(32.1114, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2230, dtype=torch.float64) delta_t tensor(-0.0853, dtype=torch.float64)
7 gae_duplicate tensor(-1.9010, dtype=torch.float64) tensor(5.0254, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0380, dtype=torch.float64) delta_t tensor(0.4468, dtype=torch.float64)
6 gae_duplicate tensor(-0.8716, dtype=torch.float64) tensor(-8.3358, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2111, dtype=torch.float64) delta_t tensor(0.2464, dtype=torch.float64)
5 gae_duplicate tensor(-0.0963, dtype=torch.float64) tensor(-5.4730, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2251, dtype=torch.float64) delta_t tensor(0.1755, dtype=torch.float64)
4 gae_duplicate tensor(-0.1241, dtype=torch.float64) tensor(-4.0270, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1529, dtype=torch.float64) delta_t tensor(0.0521, dtype=torch.float64)
3 gae_duplicate tensor(-0.1416, dtype=torch.float64) tensor(-1.4558, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2802, dtype=torch.float64) delta_t tensor(-0.2647, dtype=torch.float64)
2 gae_duplicate tensor(-0.4599, dtype=torch.float64) tensor(5.0914, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2438.04052734375
value loss:141.28590393066406
entropies:354.69879150390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.986469030380249 seconds
19 rew tensor(0.8082, dtype=torch.float64) delta_t tensor(0.0970, dtype=torch.float64)
19 gae_duplicate tensor(-0.0357, dtype=torch.float64) tensor(-1.9554, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7970, dtype=torch.float64) delta_t tensor(0.1942, dtype=torch.float64)
18 gae_duplicate tensor(0.1210, dtype=torch.float64) tensor(-4.1943, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8001, dtype=torch.float64) delta_t tensor(0.1639, dtype=torch.float64)
17 gae_duplicate tensor(0.0490, dtype=torch.float64) tensor(-3.6977, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6923, dtype=torch.float64) delta_t tensor(0.2625, dtype=torch.float64)
16 gae_duplicate tensor(0.1070, dtype=torch.float64) tensor(-5.3616, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4782, dtype=torch.float64) delta_t tensor(-0.0992, dtype=torch.float64)
15 gae_duplicate tensor(-0.9618, dtype=torch.float64) tensor(1.4157, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3259, dtype=torch.float64) delta_t tensor(0.1832, dtype=torch.float64)
14 gae_duplicate tensor(-0.8813, dtype=torch.float64) tensor(-3.5239, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5397, dtype=torch.float64) delta_t tensor(0.0776, dtype=torch.float64)
13 gae_duplicate tensor(-0.8210, dtype=torch.float64) tensor(-1.9259, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0046, dtype=torch.float64) delta_t tensor(0.1035, dtype=torch.float64)
12 gae_duplicate tensor(-0.4009, dtype=torch.float64) tensor(-2.4981, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1134, dtype=torch.float64) delta_t tensor(-0.2887, dtype=torch.float64)
11 gae_duplicate tensor(-1.9130, dtype=torch.float64) tensor(5.4927, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2730, dtype=torch.float64) delta_t tensor(-0.0273, dtype=torch.float64)
10 gae_duplicate tensor(-0.9453, dtype=torch.float64) tensor(0.7409, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5580, dtype=torch.float64) delta_t tensor(-1.7758, dtype=torch.float64)
9 gae_duplicate tensor(-4.0320, dtype=torch.float64) tensor(34.3946, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.5953, dtype=torch.float64) delta_t tensor(-1.0211, dtype=torch.float64)
8 gae_duplicate tensor(-3.1604, dtype=torch.float64) tensor(24.5083, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.6678, dtype=torch.float64) delta_t tensor(0.5605, dtype=torch.float64)
7 gae_duplicate tensor(0.3040, dtype=torch.float64) tensor(-8.8334, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1563, dtype=torch.float64) delta_t tensor(0.5221, dtype=torch.float64)
6 gae_duplicate tensor(-0.2573, dtype=torch.float64) tensor(-11.4741, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3256, dtype=torch.float64) delta_t tensor(0.1367, dtype=torch.float64)
5 gae_duplicate tensor(-0.4720, dtype=torch.float64) tensor(-3.8726, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1026, dtype=torch.float64) delta_t tensor(0.0350, dtype=torch.float64)
4 gae_duplicate tensor(-0.2102, dtype=torch.float64) tensor(-1.0425, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4436, dtype=torch.float64) delta_t tensor(0.2477, dtype=torch.float64)
3 gae_duplicate tensor(-0.0363, dtype=torch.float64) tensor(-5.0408, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5414, dtype=torch.float64) delta_t tensor(-0.5042, dtype=torch.float64)
2 gae_duplicate tensor(-1.1280, dtype=torch.float64) tensor(9.1858, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1300.8951416015625
value loss:118.70848846435547
entropies:354.54150390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.806427240371704 seconds
19 rew tensor(0.8834, dtype=torch.float64) delta_t tensor(0.1357, dtype=torch.float64)
19 gae_duplicate tensor(0.1017, dtype=torch.float64) tensor(-2.5210, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7979, dtype=torch.float64) delta_t tensor(0.1676, dtype=torch.float64)
18 gae_duplicate tensor(0.0768, dtype=torch.float64) tensor(-3.5961, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8075, dtype=torch.float64) delta_t tensor(0.1627, dtype=torch.float64)
17 gae_duplicate tensor(0.1357, dtype=torch.float64) tensor(-3.6716, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7229, dtype=torch.float64) delta_t tensor(0.1596, dtype=torch.float64)
16 gae_duplicate tensor(0.0424, dtype=torch.float64) tensor(-3.3630, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4944, dtype=torch.float64) delta_t tensor(0.0016, dtype=torch.float64)
15 gae_duplicate tensor(-1.0323, dtype=torch.float64) tensor(-0.1806, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4357, dtype=torch.float64) delta_t tensor(0.0824, dtype=torch.float64)
14 gae_duplicate tensor(-0.6282, dtype=torch.float64) tensor(-1.6716, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5910, dtype=torch.float64) delta_t tensor(0.4469, dtype=torch.float64)
13 gae_duplicate tensor(0.0668, dtype=torch.float64) tensor(-8.9353, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5818, dtype=torch.float64) delta_t tensor(0.5362, dtype=torch.float64)
12 gae_duplicate tensor(0.3869, dtype=torch.float64) tensor(-12.1860, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.9243, dtype=torch.float64) delta_t tensor(-0.8344, dtype=torch.float64)
11 gae_duplicate tensor(-1.9514, dtype=torch.float64) tensor(15.7310, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4394, dtype=torch.float64) delta_t tensor(0.5018, dtype=torch.float64)
10 gae_duplicate tensor(0.1797, dtype=torch.float64) tensor(-8.5371, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.6414, dtype=torch.float64) delta_t tensor(-2.2727, dtype=torch.float64)
9 gae_duplicate tensor(-4.1909, dtype=torch.float64) tensor(44.7159, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3958, dtype=torch.float64) delta_t tensor(-1.1014, dtype=torch.float64)
8 gae_duplicate tensor(-3.0939, dtype=torch.float64) tensor(25.2013, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2509, dtype=torch.float64) delta_t tensor(0.1736, dtype=torch.float64)
7 gae_duplicate tensor(-1.5457, dtype=torch.float64) tensor(-1.0369, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2651, dtype=torch.float64) delta_t tensor(0.5517, dtype=torch.float64)
6 gae_duplicate tensor(0.3021, dtype=torch.float64) tensor(-10.8662, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0335, dtype=torch.float64) delta_t tensor(0.1312, dtype=torch.float64)
5 gae_duplicate tensor(-0.0898, dtype=torch.float64) tensor(-3.6376, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2839, dtype=torch.float64) delta_t tensor(0.2023, dtype=torch.float64)
4 gae_duplicate tensor(-0.1257, dtype=torch.float64) tensor(-4.2517, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1426, dtype=torch.float64) delta_t tensor(0.1040, dtype=torch.float64)
3 gae_duplicate tensor(-0.1174, dtype=torch.float64) tensor(-2.4795, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3182, dtype=torch.float64) delta_t tensor(-0.2767, dtype=torch.float64)
2 gae_duplicate tensor(-0.6113, dtype=torch.float64) tensor(5.0299, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1377.88818359375
value loss:133.786376953125
entropies:354.4717712402344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.781104326248169 seconds
19 rew tensor(0.8456, dtype=torch.float64) delta_t tensor(0.0976, dtype=torch.float64)
19 gae_duplicate tensor(0.0595, dtype=torch.float64) tensor(-1.9456, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8567, dtype=torch.float64) delta_t tensor(0.2337, dtype=torch.float64)
18 gae_duplicate tensor(0.1217, dtype=torch.float64) tensor(-4.8544, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8088, dtype=torch.float64) delta_t tensor(0.1604, dtype=torch.float64)
17 gae_duplicate tensor(0.0820, dtype=torch.float64) tensor(-3.7562, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7136, dtype=torch.float64) delta_t tensor(0.1701, dtype=torch.float64)
16 gae_duplicate tensor(0.0768, dtype=torch.float64) tensor(-3.7818, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6945, dtype=torch.float64) delta_t tensor(0.1617, dtype=torch.float64)
15 gae_duplicate tensor(0.0205, dtype=torch.float64) tensor(-3.5250, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6286, dtype=torch.float64) delta_t tensor(0.2759, dtype=torch.float64)
14 gae_duplicate tensor(0.0563, dtype=torch.float64) tensor(-5.9444, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6213, dtype=torch.float64) delta_t tensor(0.4239, dtype=torch.float64)
13 gae_duplicate tensor(0.2546, dtype=torch.float64) tensor(-8.8757, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5809, dtype=torch.float64) delta_t tensor(0.4370, dtype=torch.float64)
12 gae_duplicate tensor(0.3116, dtype=torch.float64) tensor(-9.4161, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2106, dtype=torch.float64) delta_t tensor(0.4955, dtype=torch.float64)
11 gae_duplicate tensor(-0.1897, dtype=torch.float64) tensor(-10.8038, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.1500, dtype=torch.float64) delta_t tensor(-1.1500, dtype=torch.float64)
10 gae_duplicate tensor(-2.1961, dtype=torch.float64) tensor(21.8877, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5114, dtype=torch.float64) delta_t tensor(-0.8173, dtype=torch.float64)
9 gae_duplicate tensor(-4.2529, dtype=torch.float64) tensor(17.7147, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1351, dtype=torch.float64) delta_t tensor(0.0025, dtype=torch.float64)
8 gae_duplicate tensor(-2.0127, dtype=torch.float64) tensor(2.2722, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4435, dtype=torch.float64) delta_t tensor(0.3365, dtype=torch.float64)
7 gae_duplicate tensor(-1.4864, dtype=torch.float64) tensor(-6.6487, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2851, dtype=torch.float64) delta_t tensor(-0.0754, dtype=torch.float64)
6 gae_duplicate tensor(-1.7374, dtype=torch.float64) tensor(0.5608, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2581, dtype=torch.float64) delta_t tensor(0.1054, dtype=torch.float64)
5 gae_duplicate tensor(-0.0787, dtype=torch.float64) tensor(-2.0924, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3129, dtype=torch.float64) delta_t tensor(0.2025, dtype=torch.float64)
4 gae_duplicate tensor(-0.5482, dtype=torch.float64) tensor(-4.0834, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0661, dtype=torch.float64) delta_t tensor(0.0197, dtype=torch.float64)
3 gae_duplicate tensor(-0.1567, dtype=torch.float64) tensor(-0.8377, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2117, dtype=torch.float64) delta_t tensor(-0.1765, dtype=torch.float64)
2 gae_duplicate tensor(-0.5201, dtype=torch.float64) tensor(3.5341, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1016.470947265625
value loss:91.38385009765625
entropies:354.47052001953125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3945.9749)
ToM Target loss= tensor(3577.7649)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.816647052764893 seconds
19 rew tensor(0.8179, dtype=torch.float64) delta_t tensor(0.0718, dtype=torch.float64)
19 gae_duplicate tensor(0.0147, dtype=torch.float64) tensor(-1.3740, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8189, dtype=torch.float64) delta_t tensor(0.1644, dtype=torch.float64)
18 gae_duplicate tensor(0.0584, dtype=torch.float64) tensor(-3.4300, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7914, dtype=torch.float64) delta_t tensor(0.1527, dtype=torch.float64)
17 gae_duplicate tensor(0.1324, dtype=torch.float64) tensor(-3.4413, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7430, dtype=torch.float64) delta_t tensor(0.2463, dtype=torch.float64)
16 gae_duplicate tensor(0.1189, dtype=torch.float64) tensor(-5.2717, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4219, dtype=torch.float64) delta_t tensor(-0.1110, dtype=torch.float64)
15 gae_duplicate tensor(-1.0275, dtype=torch.float64) tensor(1.8072, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3857, dtype=torch.float64) delta_t tensor(0.3115, dtype=torch.float64)
14 gae_duplicate tensor(-0.8623, dtype=torch.float64) tensor(-6.2274, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6027, dtype=torch.float64) delta_t tensor(0.3471, dtype=torch.float64)
13 gae_duplicate tensor(0.0249, dtype=torch.float64) tensor(-7.4727, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1988, dtype=torch.float64) delta_t tensor(0.3658, dtype=torch.float64)
12 gae_duplicate tensor(-0.6235, dtype=torch.float64) tensor(-8.1935, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7640, dtype=torch.float64) delta_t tensor(-0.8205, dtype=torch.float64)
11 gae_duplicate tensor(-1.8873, dtype=torch.float64) tensor(15.2428, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1011, dtype=torch.float64) delta_t tensor(0.5017, dtype=torch.float64)
10 gae_duplicate tensor(-0.3226, dtype=torch.float64) tensor(-8.0930, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5547, dtype=torch.float64) delta_t tensor(-1.4008, dtype=torch.float64)
9 gae_duplicate tensor(-3.3708, dtype=torch.float64) tensor(25.7219, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6911, dtype=torch.float64) delta_t tensor(-1.2228, dtype=torch.float64)
8 gae_duplicate tensor(-2.8353, dtype=torch.float64) tensor(26.5823, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1150, dtype=torch.float64) delta_t tensor(0.3447, dtype=torch.float64)
7 gae_duplicate tensor(-0.4788, dtype=torch.float64) tensor(-3.8674, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1471, dtype=torch.float64) delta_t tensor(0.5652, dtype=torch.float64)
6 gae_duplicate tensor(0.4572, dtype=torch.float64) tensor(-11.8325, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2492, dtype=torch.float64) delta_t tensor(0.1765, dtype=torch.float64)
5 gae_duplicate tensor(0.0704, dtype=torch.float64) tensor(-4.5923, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2248, dtype=torch.float64) delta_t tensor(0.0835, dtype=torch.float64)
4 gae_duplicate tensor(-0.3825, dtype=torch.float64) tensor(-2.1008, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1899, dtype=torch.float64) delta_t tensor(0.1108, dtype=torch.float64)
3 gae_duplicate tensor(-0.0387, dtype=torch.float64) tensor(-2.4257, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3480, dtype=torch.float64) delta_t tensor(-0.2337, dtype=torch.float64)
2 gae_duplicate tensor(-0.4291, dtype=torch.float64) tensor(4.4722, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-392.937255859375
value loss:90.99166870117188
entropies:354.46044921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.714024066925049 seconds
19 rew tensor(0.7899, dtype=torch.float64) delta_t tensor(0.0649, dtype=torch.float64)
19 gae_duplicate tensor(0.0190, dtype=torch.float64) tensor(-1.3407, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8005, dtype=torch.float64) delta_t tensor(0.1893, dtype=torch.float64)
18 gae_duplicate tensor(0.0348, dtype=torch.float64) tensor(-3.7802, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7613, dtype=torch.float64) delta_t tensor(0.1529, dtype=torch.float64)
17 gae_duplicate tensor(0.1082, dtype=torch.float64) tensor(-3.4339, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6558, dtype=torch.float64) delta_t tensor(0.2105, dtype=torch.float64)
16 gae_duplicate tensor(0.1496, dtype=torch.float64) tensor(-4.5532, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6945, dtype=torch.float64) delta_t tensor(0.1667, dtype=torch.float64)
15 gae_duplicate tensor(-0.0614, dtype=torch.float64) tensor(-3.6170, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5323, dtype=torch.float64) delta_t tensor(0.4322, dtype=torch.float64)
14 gae_duplicate tensor(0.1384, dtype=torch.float64) tensor(-8.7941, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6514, dtype=torch.float64) delta_t tensor(0.4135, dtype=torch.float64)
13 gae_duplicate tensor(0.2019, dtype=torch.float64) tensor(-9.2637, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4626, dtype=torch.float64) delta_t tensor(0.5851, dtype=torch.float64)
12 gae_duplicate tensor(0.3619, dtype=torch.float64) tensor(-12.0952, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0948, dtype=torch.float64) delta_t tensor(-0.0071, dtype=torch.float64)
11 gae_duplicate tensor(-0.6877, dtype=torch.float64) tensor(-1.4898, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4443, dtype=torch.float64) delta_t tensor(-0.1680, dtype=torch.float64)
10 gae_duplicate tensor(-1.1111, dtype=torch.float64) tensor(3.2609, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6802, dtype=torch.float64) delta_t tensor(-1.2573, dtype=torch.float64)
9 gae_duplicate tensor(-3.3546, dtype=torch.float64) tensor(25.0470, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.5148, dtype=torch.float64) delta_t tensor(-1.1193, dtype=torch.float64)
8 gae_duplicate tensor(-2.8584, dtype=torch.float64) tensor(25.1487, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5889, dtype=torch.float64) delta_t tensor(-0.1500, dtype=torch.float64)
7 gae_duplicate tensor(-2.5850, dtype=torch.float64) tensor(5.3754, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1369, dtype=torch.float64) delta_t tensor(0.5457, dtype=torch.float64)
6 gae_duplicate tensor(0.2942, dtype=torch.float64) tensor(-10.1784, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1080, dtype=torch.float64) delta_t tensor(0.1717, dtype=torch.float64)
5 gae_duplicate tensor(0.0393, dtype=torch.float64) tensor(-4.3916, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2051, dtype=torch.float64) delta_t tensor(0.0964, dtype=torch.float64)
4 gae_duplicate tensor(-0.1365, dtype=torch.float64) tensor(-2.3906, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2202, dtype=torch.float64) delta_t tensor(0.1360, dtype=torch.float64)
3 gae_duplicate tensor(-0.2879, dtype=torch.float64) tensor(-2.9838, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3185, dtype=torch.float64) delta_t tensor(-0.2439, dtype=torch.float64)
2 gae_duplicate tensor(-0.4524, dtype=torch.float64) tensor(4.5457, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:170.73681640625
value loss:99.14251708984375
entropies:354.57464599609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.013142108917236 seconds
19 rew tensor(0.8562, dtype=torch.float64) delta_t tensor(0.0932, dtype=torch.float64)
19 gae_duplicate tensor(0.0251, dtype=torch.float64) tensor(-1.8361, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8269, dtype=torch.float64) delta_t tensor(0.1341, dtype=torch.float64)
18 gae_duplicate tensor(0.0177, dtype=torch.float64) tensor(-2.8172, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8078, dtype=torch.float64) delta_t tensor(0.1543, dtype=torch.float64)
17 gae_duplicate tensor(0.0904, dtype=torch.float64) tensor(-3.3480, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7906, dtype=torch.float64) delta_t tensor(0.2578, dtype=torch.float64)
16 gae_duplicate tensor(0.1470, dtype=torch.float64) tensor(-5.3721, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4071, dtype=torch.float64) delta_t tensor(-0.1284, dtype=torch.float64)
15 gae_duplicate tensor(-1.0431, dtype=torch.float64) tensor(1.8734, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5937, dtype=torch.float64) delta_t tensor(0.3810, dtype=torch.float64)
14 gae_duplicate tensor(0.1261, dtype=torch.float64) tensor(-7.3709, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6443, dtype=torch.float64) delta_t tensor(0.3232, dtype=torch.float64)
13 gae_duplicate tensor(0.1904, dtype=torch.float64) tensor(-6.8011, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5005, dtype=torch.float64) delta_t tensor(0.5248, dtype=torch.float64)
12 gae_duplicate tensor(0.1692, dtype=torch.float64) tensor(-10.6075, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0792, dtype=torch.float64) delta_t tensor(-0.1418, dtype=torch.float64)
11 gae_duplicate tensor(-0.8588, dtype=torch.float64) tensor(1.3491, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0132, dtype=torch.float64) delta_t tensor(0.1759, dtype=torch.float64)
10 gae_duplicate tensor(-0.4621, dtype=torch.float64) tensor(-3.4514, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.9944, dtype=torch.float64) delta_t tensor(-1.6865, dtype=torch.float64)
9 gae_duplicate tensor(-3.6682, dtype=torch.float64) tensor(33.6741, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0811, dtype=torch.float64) delta_t tensor(-0.6903, dtype=torch.float64)
8 gae_duplicate tensor(-3.0879, dtype=torch.float64) tensor(15.6935, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1520, dtype=torch.float64) delta_t tensor(0.1906, dtype=torch.float64)
7 gae_duplicate tensor(-1.4784, dtype=torch.float64) tensor(-1.8223, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0104, dtype=torch.float64) delta_t tensor(0.3626, dtype=torch.float64)
6 gae_duplicate tensor(-0.6765, dtype=torch.float64) tensor(-7.4462, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1428, dtype=torch.float64) delta_t tensor(0.0775, dtype=torch.float64)
5 gae_duplicate tensor(-0.1043, dtype=torch.float64) tensor(-2.3259, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1725, dtype=torch.float64) delta_t tensor(0.0746, dtype=torch.float64)
4 gae_duplicate tensor(-0.1927, dtype=torch.float64) tensor(-1.6758, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2077, dtype=torch.float64) delta_t tensor(-0.0624, dtype=torch.float64)
3 gae_duplicate tensor(-0.2770, dtype=torch.float64) tensor(1.0029, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3933, dtype=torch.float64) delta_t tensor(-0.3730, dtype=torch.float64)
2 gae_duplicate tensor(-0.7267, dtype=torch.float64) tensor(7.3151, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-421.5261535644531
value loss:96.48580169677734
entropies:354.5340576171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.031566143035889 seconds
19 rew tensor(0.8771, dtype=torch.float64) delta_t tensor(0.0935, dtype=torch.float64)
19 gae_duplicate tensor(0.0586, dtype=torch.float64) tensor(-1.8370, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8309, dtype=torch.float64) delta_t tensor(0.1659, dtype=torch.float64)
18 gae_duplicate tensor(0.0701, dtype=torch.float64) tensor(-3.4697, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8593, dtype=torch.float64) delta_t tensor(0.2440, dtype=torch.float64)
17 gae_duplicate tensor(0.1281, dtype=torch.float64) tensor(-5.1656, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6487, dtype=torch.float64) delta_t tensor(0.0696, dtype=torch.float64)
16 gae_duplicate tensor(-0.0095, dtype=torch.float64) tensor(-1.8770, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6288, dtype=torch.float64) delta_t tensor(0.1456, dtype=torch.float64)
15 gae_duplicate tensor(0.0312, dtype=torch.float64) tensor(-2.9000, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4271, dtype=torch.float64) delta_t tensor(0.0855, dtype=torch.float64)
14 gae_duplicate tensor(-0.9074, dtype=torch.float64) tensor(-1.8770, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5363, dtype=torch.float64) delta_t tensor(0.3452, dtype=torch.float64)
13 gae_duplicate tensor(0.0168, dtype=torch.float64) tensor(-6.9950, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5360, dtype=torch.float64) delta_t tensor(0.3863, dtype=torch.float64)
12 gae_duplicate tensor(0.1609, dtype=torch.float64) tensor(-8.2033, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1625, dtype=torch.float64) delta_t tensor(0.0140, dtype=torch.float64)
11 gae_duplicate tensor(-0.9014, dtype=torch.float64) tensor(-1.0896, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4881, dtype=torch.float64) delta_t tensor(-0.4664, dtype=torch.float64)
10 gae_duplicate tensor(-1.7135, dtype=torch.float64) tensor(8.8652, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2902, dtype=torch.float64) delta_t tensor(0.2408, dtype=torch.float64)
9 gae_duplicate tensor(-1.8284, dtype=torch.float64) tensor(-3.4877, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6774, dtype=torch.float64) delta_t tensor(-0.5195, dtype=torch.float64)
8 gae_duplicate tensor(-3.1328, dtype=torch.float64) tensor(9.7740, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4187, dtype=torch.float64) delta_t tensor(-0.8245, dtype=torch.float64)
7 gae_duplicate tensor(-1.9581, dtype=torch.float64) tensor(17.7220, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.3284, dtype=torch.float64) delta_t tensor(-1.1428, dtype=torch.float64)
6 gae_duplicate tensor(-3.3297, dtype=torch.float64) tensor(23.7078, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0504, dtype=torch.float64) delta_t tensor(-0.8434, dtype=torch.float64)
5 gae_duplicate tensor(-2.5069, dtype=torch.float64) tensor(20.0149, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1747, dtype=torch.float64) delta_t tensor(0.0197, dtype=torch.float64)
4 gae_duplicate tensor(-1.2757, dtype=torch.float64) tensor(1.6326, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3193, dtype=torch.float64) delta_t tensor(-0.0723, dtype=torch.float64)
3 gae_duplicate tensor(-0.4001, dtype=torch.float64) tensor(1.6113, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0594, dtype=torch.float64) delta_t tensor(-0.1752, dtype=torch.float64)
2 gae_duplicate tensor(-0.6869, dtype=torch.float64) tensor(3.6258, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2798.54052734375
value loss:131.3043212890625
entropies:354.615478515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.908692359924316 seconds
19 rew tensor(0.8670, dtype=torch.float64) delta_t tensor(0.0784, dtype=torch.float64)
19 gae_duplicate tensor(0.0044, dtype=torch.float64) tensor(-1.5509, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7996, dtype=torch.float64) delta_t tensor(0.1346, dtype=torch.float64)
18 gae_duplicate tensor(0.0951, dtype=torch.float64) tensor(-2.8273, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8393, dtype=torch.float64) delta_t tensor(0.1432, dtype=torch.float64)
17 gae_duplicate tensor(0.1143, dtype=torch.float64) tensor(-3.0260, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6953, dtype=torch.float64) delta_t tensor(0.1626, dtype=torch.float64)
16 gae_duplicate tensor(0.0591, dtype=torch.float64) tensor(-3.4667, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7341, dtype=torch.float64) delta_t tensor(0.0818, dtype=torch.float64)
15 gae_duplicate tensor(-0.0400, dtype=torch.float64) tensor(-1.8844, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5536, dtype=torch.float64) delta_t tensor(0.4222, dtype=torch.float64)
14 gae_duplicate tensor(0.1324, dtype=torch.float64) tensor(-8.3308, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6798, dtype=torch.float64) delta_t tensor(0.2274, dtype=torch.float64)
13 gae_duplicate tensor(0.0256, dtype=torch.float64) tensor(-5.2893, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3443, dtype=torch.float64) delta_t tensor(0.6381, dtype=torch.float64)
12 gae_duplicate tensor(0.1946, dtype=torch.float64) tensor(-13.0750, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6837, dtype=torch.float64) delta_t tensor(-0.8896, dtype=torch.float64)
11 gae_duplicate tensor(-1.7732, dtype=torch.float64) tensor(15.8126, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1596, dtype=torch.float64) delta_t tensor(0.3033, dtype=torch.float64)
10 gae_duplicate tensor(-0.6778, dtype=torch.float64) tensor(-4.7610, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2649, dtype=torch.float64) delta_t tensor(-1.2144, dtype=torch.float64)
9 gae_duplicate tensor(-2.8058, dtype=torch.float64) tensor(23.3275, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.9770, dtype=torch.float64) delta_t tensor(-2.3460, dtype=torch.float64)
8 gae_duplicate tensor(-4.8301, dtype=torch.float64) tensor(49.6393, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3881, dtype=torch.float64) delta_t tensor(0.4902, dtype=torch.float64)
7 gae_duplicate tensor(-0.2242, dtype=torch.float64) tensor(-4.7555, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0250, dtype=torch.float64) delta_t tensor(0.5976, dtype=torch.float64)
6 gae_duplicate tensor(0.4331, dtype=torch.float64) tensor(-12.3021, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3605, dtype=torch.float64) delta_t tensor(0.1894, dtype=torch.float64)
5 gae_duplicate tensor(0.0522, dtype=torch.float64) tensor(-4.8197, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0336, dtype=torch.float64) delta_t tensor(0.0313, dtype=torch.float64)
4 gae_duplicate tensor(-0.1184, dtype=torch.float64) tensor(-1.1454, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3653, dtype=torch.float64) delta_t tensor(0.0620, dtype=torch.float64)
3 gae_duplicate tensor(-0.0801, dtype=torch.float64) tensor(-1.4153, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4323, dtype=torch.float64) delta_t tensor(-0.2689, dtype=torch.float64)
2 gae_duplicate tensor(-0.4316, dtype=torch.float64) tensor(5.0333, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1454.54638671875
value loss:128.56895446777344
entropies:354.54302978515625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3948.4568)
ToM Target loss= tensor(3585.5757)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.826601982116699 seconds
19 rew tensor(0.8276, dtype=torch.float64) delta_t tensor(0.0908, dtype=torch.float64)
19 gae_duplicate tensor(-0.0393, dtype=torch.float64) tensor(-1.8431, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8107, dtype=torch.float64) delta_t tensor(0.1557, dtype=torch.float64)
18 gae_duplicate tensor(0.0083, dtype=torch.float64) tensor(-3.2644, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7295, dtype=torch.float64) delta_t tensor(0.1295, dtype=torch.float64)
17 gae_duplicate tensor(0.0352, dtype=torch.float64) tensor(-2.7624, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5047, dtype=torch.float64) delta_t tensor(-0.0869, dtype=torch.float64)
16 gae_duplicate tensor(-0.9382, dtype=torch.float64) tensor(1.1615, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6634, dtype=torch.float64) delta_t tensor(0.1526, dtype=torch.float64)
15 gae_duplicate tensor(-0.0002, dtype=torch.float64) tensor(-2.7272, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4845, dtype=torch.float64) delta_t tensor(0.0831, dtype=torch.float64)
14 gae_duplicate tensor(-0.8212, dtype=torch.float64) tensor(-1.5975, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5311, dtype=torch.float64) delta_t tensor(0.3782, dtype=torch.float64)
13 gae_duplicate tensor(0.0751, dtype=torch.float64) tensor(-7.5023, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4458, dtype=torch.float64) delta_t tensor(0.2850, dtype=torch.float64)
12 gae_duplicate tensor(-0.3860, dtype=torch.float64) tensor(-6.1437, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2814, dtype=torch.float64) delta_t tensor(0.4879, dtype=torch.float64)
11 gae_duplicate tensor(-0.1802, dtype=torch.float64) tensor(-10.2825, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3989, dtype=torch.float64) delta_t tensor(0.4575, dtype=torch.float64)
10 gae_duplicate tensor(0.2544, dtype=torch.float64) tensor(-10.4222, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5177, dtype=torch.float64) delta_t tensor(-0.8867, dtype=torch.float64)
9 gae_duplicate tensor(-2.4076, dtype=torch.float64) tensor(16.8894, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3743, dtype=torch.float64) delta_t tensor(0.5419, dtype=torch.float64)
8 gae_duplicate tensor(0.2209, dtype=torch.float64) tensor(-9.2363, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6103, dtype=torch.float64) delta_t tensor(0.2124, dtype=torch.float64)
7 gae_duplicate tensor(-1.4643, dtype=torch.float64) tensor(-5.3190, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3338, dtype=torch.float64) delta_t tensor(0.5613, dtype=torch.float64)
6 gae_duplicate tensor(0.3816, dtype=torch.float64) tensor(-11.3637, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3415, dtype=torch.float64) delta_t tensor(0.0543, dtype=torch.float64)
5 gae_duplicate tensor(-0.3638, dtype=torch.float64) tensor(-2.2875, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4577, dtype=torch.float64) delta_t tensor(0.4332, dtype=torch.float64)
4 gae_duplicate tensor(0.1590, dtype=torch.float64) tensor(-8.5854, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1651, dtype=torch.float64) delta_t tensor(0.0020, dtype=torch.float64)
3 gae_duplicate tensor(-0.3079, dtype=torch.float64) tensor(-0.8653, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1866, dtype=torch.float64) delta_t tensor(-0.1132, dtype=torch.float64)
2 gae_duplicate tensor(-0.4615, dtype=torch.float64) tensor(2.1762, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3358.981689453125
value loss:57.40782165527344
entropies:354.3758544921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.112745046615601 seconds
19 rew tensor(0.8449, dtype=torch.float64) delta_t tensor(0.0672, dtype=torch.float64)
19 gae_duplicate tensor(0.0182, dtype=torch.float64) tensor(-1.2967, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6005, dtype=torch.float64) delta_t tensor(-0.0729, dtype=torch.float64)
18 gae_duplicate tensor(-1.0840, dtype=torch.float64) tensor(1.0971, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7980, dtype=torch.float64) delta_t tensor(0.1553, dtype=torch.float64)
17 gae_duplicate tensor(0.0574, dtype=torch.float64) tensor(-2.8712, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7062, dtype=torch.float64) delta_t tensor(0.1212, dtype=torch.float64)
16 gae_duplicate tensor(0.0630, dtype=torch.float64) tensor(-2.7110, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4566, dtype=torch.float64) delta_t tensor(-0.0552, dtype=torch.float64)
15 gae_duplicate tensor(-0.8966, dtype=torch.float64) tensor(1.0525, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3975, dtype=torch.float64) delta_t tensor(0.0101, dtype=torch.float64)
14 gae_duplicate tensor(-0.8612, dtype=torch.float64) tensor(-0.1936, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4103, dtype=torch.float64) delta_t tensor(0.1359, dtype=torch.float64)
13 gae_duplicate tensor(-0.7616, dtype=torch.float64) tensor(-2.6711, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6212, dtype=torch.float64) delta_t tensor(0.4750, dtype=torch.float64)
12 gae_duplicate tensor(0.1409, dtype=torch.float64) tensor(-9.6299, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0482, dtype=torch.float64) delta_t tensor(0.1600, dtype=torch.float64)
11 gae_duplicate tensor(-0.9693, dtype=torch.float64) tensor(-4.2529, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3960, dtype=torch.float64) delta_t tensor(-0.2136, dtype=torch.float64)
10 gae_duplicate tensor(-1.9305, dtype=torch.float64) tensor(3.3576, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.8658, dtype=torch.float64) delta_t tensor(-1.3631, dtype=torch.float64)
9 gae_duplicate tensor(-4.2093, dtype=torch.float64) tensor(27.9511, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1769, dtype=torch.float64) delta_t tensor(-0.8477, dtype=torch.float64)
8 gae_duplicate tensor(-3.7348, dtype=torch.float64) tensor(21.7838, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3340, dtype=torch.float64) delta_t tensor(0.2255, dtype=torch.float64)
7 gae_duplicate tensor(-1.5556, dtype=torch.float64) tensor(-2.8746, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2504, dtype=torch.float64) delta_t tensor(0.6214, dtype=torch.float64)
6 gae_duplicate tensor(0.2739, dtype=torch.float64) tensor(-12.3164, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1314, dtype=torch.float64) delta_t tensor(0.0430, dtype=torch.float64)
5 gae_duplicate tensor(-0.0894, dtype=torch.float64) tensor(-2.0093, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2590, dtype=torch.float64) delta_t tensor(0.2367, dtype=torch.float64)
4 gae_duplicate tensor(-0.0471, dtype=torch.float64) tensor(-4.7989, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0223, dtype=torch.float64) delta_t tensor(0.0267, dtype=torch.float64)
3 gae_duplicate tensor(-0.1529, dtype=torch.float64) tensor(-1.0622, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1912, dtype=torch.float64) delta_t tensor(-0.1368, dtype=torch.float64)
2 gae_duplicate tensor(-0.6436, dtype=torch.float64) tensor(2.8310, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-710.3936157226562
value loss:123.26805114746094
entropies:354.02398681640625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.872023105621338 seconds
19 rew tensor(0.8838, dtype=torch.float64) delta_t tensor(0.0924, dtype=torch.float64)
19 gae_duplicate tensor(0.0442, dtype=torch.float64) tensor(-1.8836, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8548, dtype=torch.float64) delta_t tensor(0.1829, dtype=torch.float64)
18 gae_duplicate tensor(0.1343, dtype=torch.float64) tensor(-3.5994, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7514, dtype=torch.float64) delta_t tensor(0.1021, dtype=torch.float64)
17 gae_duplicate tensor(0.0483, dtype=torch.float64) tensor(-2.4524, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7084, dtype=torch.float64) delta_t tensor(0.1307, dtype=torch.float64)
16 gae_duplicate tensor(0.0230, dtype=torch.float64) tensor(-2.8866, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6750, dtype=torch.float64) delta_t tensor(0.1240, dtype=torch.float64)
15 gae_duplicate tensor(0.0075, dtype=torch.float64) tensor(-2.6325, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6329, dtype=torch.float64) delta_t tensor(0.2792, dtype=torch.float64)
14 gae_duplicate tensor(0.0387, dtype=torch.float64) tensor(-5.5285, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4709, dtype=torch.float64) delta_t tensor(0.2504, dtype=torch.float64)
13 gae_duplicate tensor(-0.7156, dtype=torch.float64) tensor(-5.5221, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3553, dtype=torch.float64) delta_t tensor(0.2126, dtype=torch.float64)
12 gae_duplicate tensor(-0.8159, dtype=torch.float64) tensor(-4.3260, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0760, dtype=torch.float64) delta_t tensor(0.2064, dtype=torch.float64)
11 gae_duplicate tensor(-0.9412, dtype=torch.float64) tensor(-4.4594, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4195, dtype=torch.float64) delta_t tensor(-0.2622, dtype=torch.float64)
10 gae_duplicate tensor(-1.9964, dtype=torch.float64) tensor(4.7115, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0017, dtype=torch.float64) delta_t tensor(-0.4110, dtype=torch.float64)
9 gae_duplicate tensor(-3.1057, dtype=torch.float64) tensor(8.8445, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1804, dtype=torch.float64) delta_t tensor(0.5111, dtype=torch.float64)
8 gae_duplicate tensor(-0.8925, dtype=torch.float64) tensor(-10.0023, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1339, dtype=torch.float64) delta_t tensor(-0.4908, dtype=torch.float64)
7 gae_duplicate tensor(-3.8154, dtype=torch.float64) tensor(7.7508, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1125, dtype=torch.float64) delta_t tensor(0.3547, dtype=torch.float64)
6 gae_duplicate tensor(-1.3766, dtype=torch.float64) tensor(-6.0889, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1651, dtype=torch.float64) delta_t tensor(-0.0827, dtype=torch.float64)
5 gae_duplicate tensor(-0.6708, dtype=torch.float64) tensor(1.0802, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1365, dtype=torch.float64) delta_t tensor(0.1620, dtype=torch.float64)
4 gae_duplicate tensor(0.0050, dtype=torch.float64) tensor(-3.1435, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0698, dtype=torch.float64) delta_t tensor(0.0524, dtype=torch.float64)
3 gae_duplicate tensor(-0.4235, dtype=torch.float64) tensor(-1.6056, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1794, dtype=torch.float64) delta_t tensor(-0.1904, dtype=torch.float64)
2 gae_duplicate tensor(-0.4861, dtype=torch.float64) tensor(3.6381, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1422.2528076171875
value loss:82.05656433105469
entropies:353.553466796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8997838497161865 seconds
19 rew tensor(0.8436, dtype=torch.float64) delta_t tensor(0.0545, dtype=torch.float64)
19 gae_duplicate tensor(-0.0118, dtype=torch.float64) tensor(-1.1003, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8160, dtype=torch.float64) delta_t tensor(0.0952, dtype=torch.float64)
18 gae_duplicate tensor(-0.0013, dtype=torch.float64) tensor(-1.8598, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7114, dtype=torch.float64) delta_t tensor(0.0812, dtype=torch.float64)
17 gae_duplicate tensor(0.0166, dtype=torch.float64) tensor(-1.7699, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7594, dtype=torch.float64) delta_t tensor(0.0907, dtype=torch.float64)
16 gae_duplicate tensor(0.0391, dtype=torch.float64) tensor(-2.0095, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6350, dtype=torch.float64) delta_t tensor(0.1447, dtype=torch.float64)
15 gae_duplicate tensor(-0.0516, dtype=torch.float64) tensor(-3.0438, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6056, dtype=torch.float64) delta_t tensor(0.0707, dtype=torch.float64)
14 gae_duplicate tensor(-0.9426, dtype=torch.float64) tensor(-1.3232, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5015, dtype=torch.float64) delta_t tensor(0.5089, dtype=torch.float64)
13 gae_duplicate tensor(0.0465, dtype=torch.float64) tensor(-9.8607, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6724, dtype=torch.float64) delta_t tensor(0.3919, dtype=torch.float64)
12 gae_duplicate tensor(0.2251, dtype=torch.float64) tensor(-8.7602, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4686, dtype=torch.float64) delta_t tensor(0.0504, dtype=torch.float64)
11 gae_duplicate tensor(-1.2541, dtype=torch.float64) tensor(-2.0920, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3716, dtype=torch.float64) delta_t tensor(-0.5147, dtype=torch.float64)
10 gae_duplicate tensor(-1.7164, dtype=torch.float64) tensor(10.1931, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.4001, dtype=torch.float64) delta_t tensor(-1.5087, dtype=torch.float64)
9 gae_duplicate tensor(-4.5128, dtype=torch.float64) tensor(34.1365, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7288, dtype=torch.float64) delta_t tensor(-0.7111, dtype=torch.float64)
8 gae_duplicate tensor(-2.5820, dtype=torch.float64) tensor(16.8482, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6987, dtype=torch.float64) delta_t tensor(0.2927, dtype=torch.float64)
7 gae_duplicate tensor(-0.3135, dtype=torch.float64) tensor(-3.7275, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1923, dtype=torch.float64) delta_t tensor(0.2255, dtype=torch.float64)
6 gae_duplicate tensor(-1.5903, dtype=torch.float64) tensor(-4.5457, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7665, dtype=torch.float64) delta_t tensor(-0.2674, dtype=torch.float64)
5 gae_duplicate tensor(-2.4131, dtype=torch.float64) tensor(3.8783, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0652, dtype=torch.float64) delta_t tensor(-0.3040, dtype=torch.float64)
4 gae_duplicate tensor(-3.4956, dtype=torch.float64) tensor(6.6140, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1905, dtype=torch.float64) delta_t tensor(0.0229, dtype=torch.float64)
3 gae_duplicate tensor(-0.4092, dtype=torch.float64) tensor(0.3363, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0285, dtype=torch.float64) delta_t tensor(0.0655, dtype=torch.float64)
2 gae_duplicate tensor(-0.3059, dtype=torch.float64) tensor(-1.3016, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1748.4398193359375
value loss:128.6561737060547
entropies:353.24993896484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.602684020996094 seconds
19 rew tensor(0.8835, dtype=torch.float64) delta_t tensor(0.0894, dtype=torch.float64)
19 gae_duplicate tensor(0.0201, dtype=torch.float64) tensor(-1.7175, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8746, dtype=torch.float64) delta_t tensor(0.2014, dtype=torch.float64)
18 gae_duplicate tensor(0.1228, dtype=torch.float64) tensor(-4.2400, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7596, dtype=torch.float64) delta_t tensor(0.1226, dtype=torch.float64)
17 gae_duplicate tensor(-0.0024, dtype=torch.float64) tensor(-2.7916, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4529, dtype=torch.float64) delta_t tensor(-0.0887, dtype=torch.float64)
16 gae_duplicate tensor(-0.9302, dtype=torch.float64) tensor(1.4327, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6663, dtype=torch.float64) delta_t tensor(0.0951, dtype=torch.float64)
15 gae_duplicate tensor(-0.0427, dtype=torch.float64) tensor(-1.6568, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5742, dtype=torch.float64) delta_t tensor(0.2759, dtype=torch.float64)
14 gae_duplicate tensor(0.0686, dtype=torch.float64) tensor(-5.8476, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6020, dtype=torch.float64) delta_t tensor(0.2279, dtype=torch.float64)
13 gae_duplicate tensor(0.0554, dtype=torch.float64) tensor(-4.7598, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2875, dtype=torch.float64) delta_t tensor(0.2550, dtype=torch.float64)
12 gae_duplicate tensor(-0.4395, dtype=torch.float64) tensor(-5.1531, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1305, dtype=torch.float64) delta_t tensor(0.1954, dtype=torch.float64)
11 gae_duplicate tensor(-0.8782, dtype=torch.float64) tensor(-5.6564, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5073, dtype=torch.float64) delta_t tensor(-0.1992, dtype=torch.float64)
10 gae_duplicate tensor(-0.7653, dtype=torch.float64) tensor(3.0804, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3180, dtype=torch.float64) delta_t tensor(-0.7776, dtype=torch.float64)
9 gae_duplicate tensor(-4.4484, dtype=torch.float64) tensor(14.9949, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1749, dtype=torch.float64) delta_t tensor(0.2625, dtype=torch.float64)
8 gae_duplicate tensor(-1.4344, dtype=torch.float64) tensor(-3.2532, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8416, dtype=torch.float64) delta_t tensor(-0.1128, dtype=torch.float64)
7 gae_duplicate tensor(-2.2552, dtype=torch.float64) tensor(0.7598, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0853, dtype=torch.float64) delta_t tensor(0.3726, dtype=torch.float64)
6 gae_duplicate tensor(-0.8753, dtype=torch.float64) tensor(-7.0917, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1550, dtype=torch.float64) delta_t tensor(0.0697, dtype=torch.float64)
5 gae_duplicate tensor(-0.0951, dtype=torch.float64) tensor(-2.0816, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1520, dtype=torch.float64) delta_t tensor(0.1233, dtype=torch.float64)
4 gae_duplicate tensor(-0.3944, dtype=torch.float64) tensor(-2.7890, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0341, dtype=torch.float64) delta_t tensor(0.0805, dtype=torch.float64)
3 gae_duplicate tensor(-0.2207, dtype=torch.float64) tensor(-2.0261, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2233, dtype=torch.float64) delta_t tensor(-0.2403, dtype=torch.float64)
2 gae_duplicate tensor(-0.4972, dtype=torch.float64) tensor(4.6918, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1206.4127197265625
value loss:72.66388702392578
entropies:352.7369384765625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3946.7859)
ToM Target loss= tensor(3594.6958)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.8253350257873535 seconds
19 rew tensor(0.8561, dtype=torch.float64) delta_t tensor(0.0353, dtype=torch.float64)
19 gae_duplicate tensor(-0.0645, dtype=torch.float64) tensor(-0.6920, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8257, dtype=torch.float64) delta_t tensor(0.1225, dtype=torch.float64)
18 gae_duplicate tensor(0.0014, dtype=torch.float64) tensor(-2.3874, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7977, dtype=torch.float64) delta_t tensor(0.1123, dtype=torch.float64)
17 gae_duplicate tensor(0.0491, dtype=torch.float64) tensor(-2.4565, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6969, dtype=torch.float64) delta_t tensor(0.1232, dtype=torch.float64)
16 gae_duplicate tensor(0.0651, dtype=torch.float64) tensor(-2.5752, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2304, dtype=torch.float64) delta_t tensor(-0.3142, dtype=torch.float64)
15 gae_duplicate tensor(-1.1182, dtype=torch.float64) tensor(5.2864, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3961, dtype=torch.float64) delta_t tensor(0.1652, dtype=torch.float64)
14 gae_duplicate tensor(-0.6355, dtype=torch.float64) tensor(-2.7908, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6134, dtype=torch.float64) delta_t tensor(0.3735, dtype=torch.float64)
13 gae_duplicate tensor(-0.0426, dtype=torch.float64) tensor(-7.6313, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3021, dtype=torch.float64) delta_t tensor(0.2521, dtype=torch.float64)
12 gae_duplicate tensor(-1.0482, dtype=torch.float64) tensor(-5.5721, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6846, dtype=torch.float64) delta_t tensor(-0.5462, dtype=torch.float64)
11 gae_duplicate tensor(-1.8664, dtype=torch.float64) tensor(11.7797, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0676, dtype=torch.float64) delta_t tensor(0.2533, dtype=torch.float64)
10 gae_duplicate tensor(-1.5934, dtype=torch.float64) tensor(-2.8136, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3686, dtype=torch.float64) delta_t tensor(-0.0322, dtype=torch.float64)
9 gae_duplicate tensor(-1.4524, dtype=torch.float64) tensor(0.3460, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.5910, dtype=torch.float64) delta_t tensor(-1.1854, dtype=torch.float64)
8 gae_duplicate tensor(-2.9941, dtype=torch.float64) tensor(24.6051, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9243, dtype=torch.float64) delta_t tensor(-0.5189, dtype=torch.float64)
7 gae_duplicate tensor(-3.8881, dtype=torch.float64) tensor(11.3625, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0586, dtype=torch.float64) delta_t tensor(0.4177, dtype=torch.float64)
6 gae_duplicate tensor(-0.8236, dtype=torch.float64) tensor(-7.1255, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1018, dtype=torch.float64) delta_t tensor(0.0099, dtype=torch.float64)
5 gae_duplicate tensor(-0.2923, dtype=torch.float64) tensor(-1.1323, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3530, dtype=torch.float64) delta_t tensor(0.1097, dtype=torch.float64)
4 gae_duplicate tensor(-0.0448, dtype=torch.float64) tensor(-2.0851, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0956, dtype=torch.float64) delta_t tensor(-0.0218, dtype=torch.float64)
3 gae_duplicate tensor(-0.2496, dtype=torch.float64) tensor(0.2707, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3496, dtype=torch.float64) delta_t tensor(-0.1597, dtype=torch.float64)
2 gae_duplicate tensor(-0.3944, dtype=torch.float64) tensor(3.2089, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1153.435791015625
value loss:114.77911376953125
entropies:352.5126037597656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.220760822296143 seconds
19 rew tensor(0.8557, dtype=torch.float64) delta_t tensor(0.0580, dtype=torch.float64)
19 gae_duplicate tensor(-0.0567, dtype=torch.float64) tensor(-1.1198, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8189, dtype=torch.float64) delta_t tensor(0.0745, dtype=torch.float64)
18 gae_duplicate tensor(-0.0475, dtype=torch.float64) tensor(-1.6719, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7453, dtype=torch.float64) delta_t tensor(0.0958, dtype=torch.float64)
17 gae_duplicate tensor(-0.0008, dtype=torch.float64) tensor(-2.0898, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7619, dtype=torch.float64) delta_t tensor(0.1830, dtype=torch.float64)
16 gae_duplicate tensor(0.0638, dtype=torch.float64) tensor(-3.5201, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5353, dtype=torch.float64) delta_t tensor(0.1099, dtype=torch.float64)
15 gae_duplicate tensor(-0.0546, dtype=torch.float64) tensor(-2.5386, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4070, dtype=torch.float64) delta_t tensor(0.1545, dtype=torch.float64)
14 gae_duplicate tensor(-0.9166, dtype=torch.float64) tensor(-3.8767, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3509, dtype=torch.float64) delta_t tensor(0.2732, dtype=torch.float64)
13 gae_duplicate tensor(-0.3183, dtype=torch.float64) tensor(-5.6203, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3813, dtype=torch.float64) delta_t tensor(0.3168, dtype=torch.float64)
12 gae_duplicate tensor(-0.4430, dtype=torch.float64) tensor(-6.9423, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0017, dtype=torch.float64) delta_t tensor(0.2166, dtype=torch.float64)
11 gae_duplicate tensor(-0.4117, dtype=torch.float64) tensor(-5.8475, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3038, dtype=torch.float64) delta_t tensor(-0.2438, dtype=torch.float64)
10 gae_duplicate tensor(-1.8319, dtype=torch.float64) tensor(4.4344, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.1830, dtype=torch.float64) delta_t tensor(-1.5757, dtype=torch.float64)
9 gae_duplicate tensor(-2.7546, dtype=torch.float64) tensor(31.0986, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6095, dtype=torch.float64) delta_t tensor(-0.3334, dtype=torch.float64)
8 gae_duplicate tensor(-2.8783, dtype=torch.float64) tensor(8.1640, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3421, dtype=torch.float64) delta_t tensor(0.3012, dtype=torch.float64)
7 gae_duplicate tensor(-0.5897, dtype=torch.float64) tensor(-5.3601, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2855, dtype=torch.float64) delta_t tensor(0.0081, dtype=torch.float64)
6 gae_duplicate tensor(-2.9699, dtype=torch.float64) tensor(-0.8005, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4222, dtype=torch.float64) delta_t tensor(-0.3783, dtype=torch.float64)
5 gae_duplicate tensor(-2.8425, dtype=torch.float64) tensor(8.1946, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1230, dtype=torch.float64) delta_t tensor(-0.0716, dtype=torch.float64)
4 gae_duplicate tensor(-1.3528, dtype=torch.float64) tensor(2.1850, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0417, dtype=torch.float64) delta_t tensor(0.0171, dtype=torch.float64)
3 gae_duplicate tensor(-0.1675, dtype=torch.float64) tensor(-0.0611, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1940, dtype=torch.float64) delta_t tensor(-0.0652, dtype=torch.float64)
2 gae_duplicate tensor(-0.3968, dtype=torch.float64) tensor(1.4264, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-961.974365234375
value loss:111.33021545410156
entropies:352.0243835449219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8630430698394775 seconds
19 rew tensor(0.8310, dtype=torch.float64) delta_t tensor(-0.0177, dtype=torch.float64)
19 gae_duplicate tensor(-0.1727, dtype=torch.float64) tensor(0.3747, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8573, dtype=torch.float64) delta_t tensor(0.1068, dtype=torch.float64)
18 gae_duplicate tensor(0.0635, dtype=torch.float64) tensor(-2.1221, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8132, dtype=torch.float64) delta_t tensor(0.0975, dtype=torch.float64)
17 gae_duplicate tensor(-0.0697, dtype=torch.float64) tensor(-2.1609, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7230, dtype=torch.float64) delta_t tensor(0.0832, dtype=torch.float64)
16 gae_duplicate tensor(-0.0523, dtype=torch.float64) tensor(-1.7824, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6668, dtype=torch.float64) delta_t tensor(0.0827, dtype=torch.float64)
15 gae_duplicate tensor(-0.0123, dtype=torch.float64) tensor(-1.6167, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2467, dtype=torch.float64) delta_t tensor(-0.0720, dtype=torch.float64)
14 gae_duplicate tensor(-0.9730, dtype=torch.float64) tensor(1.1691, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4204, dtype=torch.float64) delta_t tensor(0.1245, dtype=torch.float64)
13 gae_duplicate tensor(-0.7998, dtype=torch.float64) tensor(-2.6747, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5528, dtype=torch.float64) delta_t tensor(0.4967, dtype=torch.float64)
12 gae_duplicate tensor(0.2517, dtype=torch.float64) tensor(-9.6848, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2674, dtype=torch.float64) delta_t tensor(-0.2509, dtype=torch.float64)
11 gae_duplicate tensor(-1.8626, dtype=torch.float64) tensor(4.5102, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1919, dtype=torch.float64) delta_t tensor(-0.0259, dtype=torch.float64)
10 gae_duplicate tensor(-1.5902, dtype=torch.float64) tensor(0.6642, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.8309, dtype=torch.float64) delta_t tensor(-1.3839, dtype=torch.float64)
9 gae_duplicate tensor(-3.3802, dtype=torch.float64) tensor(26.0920, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0180, dtype=torch.float64) delta_t tensor(-0.5987, dtype=torch.float64)
8 gae_duplicate tensor(-2.8035, dtype=torch.float64) tensor(14.4384, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6786, dtype=torch.float64) delta_t tensor(-0.1588, dtype=torch.float64)
7 gae_duplicate tensor(-1.7859, dtype=torch.float64) tensor(3.3452, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1700, dtype=torch.float64) delta_t tensor(0.1733, dtype=torch.float64)
6 gae_duplicate tensor(-0.8679, dtype=torch.float64) tensor(-3.6838, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0002, dtype=torch.float64) delta_t tensor(-0.0151, dtype=torch.float64)
5 gae_duplicate tensor(-0.1185, dtype=torch.float64) tensor(-0.0486, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2329, dtype=torch.float64) delta_t tensor(0.1699, dtype=torch.float64)
4 gae_duplicate tensor(-0.1207, dtype=torch.float64) tensor(-3.6361, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1517, dtype=torch.float64) delta_t tensor(-0.0321, dtype=torch.float64)
3 gae_duplicate tensor(-0.2414, dtype=torch.float64) tensor(0.2870, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2633, dtype=torch.float64) delta_t tensor(-0.1938, dtype=torch.float64)
2 gae_duplicate tensor(-0.7366, dtype=torch.float64) tensor(3.6941, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1561.89208984375
value loss:111.04730224609375
entropies:351.8302917480469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.443979024887085 seconds
19 rew tensor(0.8758, dtype=torch.float64) delta_t tensor(0.0108, dtype=torch.float64)
19 gae_duplicate tensor(-0.0573, dtype=torch.float64) tensor(-0.2016, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8564, dtype=torch.float64) delta_t tensor(0.1058, dtype=torch.float64)
18 gae_duplicate tensor(-0.0429, dtype=torch.float64) tensor(-1.9250, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7892, dtype=torch.float64) delta_t tensor(0.0890, dtype=torch.float64)
17 gae_duplicate tensor(-0.0397, dtype=torch.float64) tensor(-2.0781, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7337, dtype=torch.float64) delta_t tensor(0.0285, dtype=torch.float64)
16 gae_duplicate tensor(-0.1006, dtype=torch.float64) tensor(-0.7534, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6968, dtype=torch.float64) delta_t tensor(0.2109, dtype=torch.float64)
15 gae_duplicate tensor(0.0316, dtype=torch.float64) tensor(-4.3503, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4926, dtype=torch.float64) delta_t tensor(-0.0700, dtype=torch.float64)
14 gae_duplicate tensor(-0.9458, dtype=torch.float64) tensor(0.9531, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4711, dtype=torch.float64) delta_t tensor(0.5022, dtype=torch.float64)
13 gae_duplicate tensor(0.1393, dtype=torch.float64) tensor(-9.1282, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7618, dtype=torch.float64) delta_t tensor(0.4575, dtype=torch.float64)
12 gae_duplicate tensor(0.3391, dtype=torch.float64) tensor(-9.5978, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.9226, dtype=torch.float64) delta_t tensor(-0.4615, dtype=torch.float64)
11 gae_duplicate tensor(-2.2336, dtype=torch.float64) tensor(7.2695, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1704, dtype=torch.float64) delta_t tensor(0.1471, dtype=torch.float64)
10 gae_duplicate tensor(-0.7755, dtype=torch.float64) tensor(-1.6678, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.3240, dtype=torch.float64) delta_t tensor(-1.3654, dtype=torch.float64)
9 gae_duplicate tensor(-4.1668, dtype=torch.float64) tensor(25.6872, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2077, dtype=torch.float64) delta_t tensor(-0.1427, dtype=torch.float64)
8 gae_duplicate tensor(-1.6645, dtype=torch.float64) tensor(4.8450, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7316, dtype=torch.float64) delta_t tensor(0.3443, dtype=torch.float64)
7 gae_duplicate tensor(-0.2041, dtype=torch.float64) tensor(-5.9039, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0954, dtype=torch.float64) delta_t tensor(0.2417, dtype=torch.float64)
6 gae_duplicate tensor(-1.7341, dtype=torch.float64) tensor(-5.9379, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3845, dtype=torch.float64) delta_t tensor(-0.0407, dtype=torch.float64)
5 gae_duplicate tensor(-0.1668, dtype=torch.float64) tensor(0.2603, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5084, dtype=torch.float64) delta_t tensor(0.1366, dtype=torch.float64)
4 gae_duplicate tensor(-0.2616, dtype=torch.float64) tensor(-3.0177, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1560, dtype=torch.float64) delta_t tensor(0.0067, dtype=torch.float64)
3 gae_duplicate tensor(-0.1846, dtype=torch.float64) tensor(-0.3355, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0904, dtype=torch.float64) delta_t tensor(-0.1476, dtype=torch.float64)
2 gae_duplicate tensor(-0.4359, dtype=torch.float64) tensor(2.8805, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:67.06134033203125
value loss:81.64350891113281
entropies:351.9145202636719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.200268030166626 seconds
19 rew tensor(0.8537, dtype=torch.float64) delta_t tensor(-0.0135, dtype=torch.float64)
19 gae_duplicate tensor(-0.0509, dtype=torch.float64) tensor(0.2897, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8368, dtype=torch.float64) delta_t tensor(0.0813, dtype=torch.float64)
18 gae_duplicate tensor(-0.0256, dtype=torch.float64) tensor(-1.5015, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8548, dtype=torch.float64) delta_t tensor(0.1098, dtype=torch.float64)
17 gae_duplicate tensor(0.0699, dtype=torch.float64) tensor(-2.3980, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7620, dtype=torch.float64) delta_t tensor(0.1555, dtype=torch.float64)
16 gae_duplicate tensor(0.0344, dtype=torch.float64) tensor(-3.1030, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7030, dtype=torch.float64) delta_t tensor(0.1219, dtype=torch.float64)
15 gae_duplicate tensor(-0.0856, dtype=torch.float64) tensor(-2.6332, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6069, dtype=torch.float64) delta_t tensor(0.3464, dtype=torch.float64)
14 gae_duplicate tensor(0.1162, dtype=torch.float64) tensor(-6.4247, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7419, dtype=torch.float64) delta_t tensor(0.4218, dtype=torch.float64)
13 gae_duplicate tensor(0.0533, dtype=torch.float64) tensor(-9.3701, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5004, dtype=torch.float64) delta_t tensor(0.5659, dtype=torch.float64)
12 gae_duplicate tensor(0.3141, dtype=torch.float64) tensor(-11.6877, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3145, dtype=torch.float64) delta_t tensor(-0.1521, dtype=torch.float64)
11 gae_duplicate tensor(-1.7727, dtype=torch.float64) tensor(1.4523, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1393, dtype=torch.float64) delta_t tensor(0.4380, dtype=torch.float64)
10 gae_duplicate tensor(0.0085, dtype=torch.float64) tensor(-8.4317, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.2116, dtype=torch.float64) delta_t tensor(-1.7216, dtype=torch.float64)
9 gae_duplicate tensor(-4.1488, dtype=torch.float64) tensor(36.3088, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.7063, dtype=torch.float64) delta_t tensor(-1.2647, dtype=torch.float64)
8 gae_duplicate tensor(-2.9678, dtype=torch.float64) tensor(26.5003, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5497, dtype=torch.float64) delta_t tensor(0.0409, dtype=torch.float64)
7 gae_duplicate tensor(-1.3416, dtype=torch.float64) tensor(1.4530, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1411, dtype=torch.float64) delta_t tensor(0.6060, dtype=torch.float64)
6 gae_duplicate tensor(0.4325, dtype=torch.float64) tensor(-11.8330, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4106, dtype=torch.float64) delta_t tensor(-0.4049, dtype=torch.float64)
5 gae_duplicate tensor(-1.2880, dtype=torch.float64) tensor(6.9159, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2094, dtype=torch.float64) delta_t tensor(0.1820, dtype=torch.float64)
4 gae_duplicate tensor(-0.1992, dtype=torch.float64) tensor(-2.6631, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1219, dtype=torch.float64) delta_t tensor(0.0679, dtype=torch.float64)
3 gae_duplicate tensor(-0.0521, dtype=torch.float64) tensor(-1.6723, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2541, dtype=torch.float64) delta_t tensor(-0.2281, dtype=torch.float64)
2 gae_duplicate tensor(-0.4894, dtype=torch.float64) tensor(4.3023, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-932.3107299804688
value loss:121.41893768310547
entropies:352.2222900390625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3944.3462)
ToM Target loss= tensor(3597.9407)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.734178066253662 seconds
19 rew tensor(0.8547, dtype=torch.float64) delta_t tensor(-0.0210, dtype=torch.float64)
19 gae_duplicate tensor(-0.0792, dtype=torch.float64) tensor(0.3747, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8377, dtype=torch.float64) delta_t tensor(0.0870, dtype=torch.float64)
18 gae_duplicate tensor(0.0174, dtype=torch.float64) tensor(-1.7558, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8281, dtype=torch.float64) delta_t tensor(0.0893, dtype=torch.float64)
17 gae_duplicate tensor(0.0191, dtype=torch.float64) tensor(-2.0271, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6976, dtype=torch.float64) delta_t tensor(0.0700, dtype=torch.float64)
16 gae_duplicate tensor(-0.1097, dtype=torch.float64) tensor(-1.5661, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6939, dtype=torch.float64) delta_t tensor(0.0947, dtype=torch.float64)
15 gae_duplicate tensor(-0.0152, dtype=torch.float64) tensor(-2.0946, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3839, dtype=torch.float64) delta_t tensor(0.0579, dtype=torch.float64)
14 gae_duplicate tensor(-0.9178, dtype=torch.float64) tensor(-1.6878, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6226, dtype=torch.float64) delta_t tensor(0.3922, dtype=torch.float64)
13 gae_duplicate tensor(-0.0379, dtype=torch.float64) tensor(-8.2179, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4804, dtype=torch.float64) delta_t tensor(0.4805, dtype=torch.float64)
12 gae_duplicate tensor(0.3483, dtype=torch.float64) tensor(-9.8138, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3668, dtype=torch.float64) delta_t tensor(-0.1243, dtype=torch.float64)
11 gae_duplicate tensor(-1.3030, dtype=torch.float64) tensor(2.1962, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5730, dtype=torch.float64) delta_t tensor(-0.2689, dtype=torch.float64)
10 gae_duplicate tensor(-1.6147, dtype=torch.float64) tensor(4.9435, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0087, dtype=torch.float64) delta_t tensor(-0.4311, dtype=torch.float64)
9 gae_duplicate tensor(-2.3885, dtype=torch.float64) tensor(8.8896, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5137, dtype=torch.float64) delta_t tensor(-0.0847, dtype=torch.float64)
8 gae_duplicate tensor(-1.9900, dtype=torch.float64) tensor(5.1164, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1783, dtype=torch.float64) delta_t tensor(0.4361, dtype=torch.float64)
7 gae_duplicate tensor(-1.1203, dtype=torch.float64) tensor(-7.0633, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0626, dtype=torch.float64) delta_t tensor(0.4291, dtype=torch.float64)
6 gae_duplicate tensor(-0.7435, dtype=torch.float64) tensor(-10.0580, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0331, dtype=torch.float64) delta_t tensor(0.0125, dtype=torch.float64)
5 gae_duplicate tensor(-0.1281, dtype=torch.float64) tensor(-1.1533, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1141, dtype=torch.float64) delta_t tensor(0.0415, dtype=torch.float64)
4 gae_duplicate tensor(-0.2708, dtype=torch.float64) tensor(-0.9487, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2506, dtype=torch.float64) delta_t tensor(0.1254, dtype=torch.float64)
3 gae_duplicate tensor(0.0283, dtype=torch.float64) tensor(-2.6466, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3454, dtype=torch.float64) delta_t tensor(-0.1752, dtype=torch.float64)
2 gae_duplicate tensor(-0.4669, dtype=torch.float64) tensor(3.1623, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1219.804443359375
value loss:67.27977752685547
entropies:352.2470397949219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.84579610824585 seconds
19 rew tensor(0.8747, dtype=torch.float64) delta_t tensor(0.0127, dtype=torch.float64)
19 gae_duplicate tensor(-0.0277, dtype=torch.float64) tensor(-0.2138, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6269, dtype=torch.float64) delta_t tensor(-0.0967, dtype=torch.float64)
18 gae_duplicate tensor(-1.1567, dtype=torch.float64) tensor(1.4231, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7716, dtype=torch.float64) delta_t tensor(0.0891, dtype=torch.float64)
17 gae_duplicate tensor(-0.0213, dtype=torch.float64) tensor(-1.6440, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6640, dtype=torch.float64) delta_t tensor(0.0803, dtype=torch.float64)
16 gae_duplicate tensor(0.0068, dtype=torch.float64) tensor(-1.6604, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4628, dtype=torch.float64) delta_t tensor(-0.1144, dtype=torch.float64)
15 gae_duplicate tensor(-0.9475, dtype=torch.float64) tensor(2.2293, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5202, dtype=torch.float64) delta_t tensor(0.2347, dtype=torch.float64)
14 gae_duplicate tensor(-0.0717, dtype=torch.float64) tensor(-4.2678, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4503, dtype=torch.float64) delta_t tensor(0.1075, dtype=torch.float64)
13 gae_duplicate tensor(-0.7606, dtype=torch.float64) tensor(-2.8008, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2809, dtype=torch.float64) delta_t tensor(0.2062, dtype=torch.float64)
12 gae_duplicate tensor(-0.3707, dtype=torch.float64) tensor(-4.2138, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3659, dtype=torch.float64) delta_t tensor(0.2591, dtype=torch.float64)
11 gae_duplicate tensor(-0.9443, dtype=torch.float64) tensor(-5.3669, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7852, dtype=torch.float64) delta_t tensor(-0.4352, dtype=torch.float64)
10 gae_duplicate tensor(-2.9330, dtype=torch.float64) tensor(7.1391, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4262, dtype=torch.float64) delta_t tensor(-0.3248, dtype=torch.float64)
9 gae_duplicate tensor(-1.9291, dtype=torch.float64) tensor(7.2489, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9368, dtype=torch.float64) delta_t tensor(-0.2192, dtype=torch.float64)
8 gae_duplicate tensor(-3.5524, dtype=torch.float64) tensor(3.2182, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0900, dtype=torch.float64) delta_t tensor(0.1130, dtype=torch.float64)
7 gae_duplicate tensor(-1.8134, dtype=torch.float64) tensor(-1.6010, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5886, dtype=torch.float64) delta_t tensor(0.0522, dtype=torch.float64)
6 gae_duplicate tensor(-3.3218, dtype=torch.float64) tensor(-1.9049, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1755, dtype=torch.float64) delta_t tensor(0.0206, dtype=torch.float64)
5 gae_duplicate tensor(-0.3788, dtype=torch.float64) tensor(-0.5642, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0085, dtype=torch.float64) delta_t tensor(0.1726, dtype=torch.float64)
4 gae_duplicate tensor(-0.1801, dtype=torch.float64) tensor(-3.4595, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3044, dtype=torch.float64) delta_t tensor(0.1395, dtype=torch.float64)
3 gae_duplicate tensor(-0.2256, dtype=torch.float64) tensor(-3.0879, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4416, dtype=torch.float64) delta_t tensor(-0.2330, dtype=torch.float64)
2 gae_duplicate tensor(-0.5655, dtype=torch.float64) tensor(4.8238, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:158.89596557617188
value loss:106.7803955078125
entropies:352.0323486328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0352349281311035 seconds
19 rew tensor(0.8486, dtype=torch.float64) delta_t tensor(0.0022, dtype=torch.float64)
19 gae_duplicate tensor(-0.1118, dtype=torch.float64) tensor(-0.1151, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8674, dtype=torch.float64) delta_t tensor(0.0876, dtype=torch.float64)
18 gae_duplicate tensor(-0.0032, dtype=torch.float64) tensor(-1.6871, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5480, dtype=torch.float64) delta_t tensor(-0.1288, dtype=torch.float64)
17 gae_duplicate tensor(-0.8849, dtype=torch.float64) tensor(2.6077, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7141, dtype=torch.float64) delta_t tensor(0.0531, dtype=torch.float64)
16 gae_duplicate tensor(-0.0647, dtype=torch.float64) tensor(-0.8516, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6126, dtype=torch.float64) delta_t tensor(-0.0348, dtype=torch.float64)
15 gae_duplicate tensor(-0.1313, dtype=torch.float64) tensor(0.6059, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3745, dtype=torch.float64) delta_t tensor(0.3288, dtype=torch.float64)
14 gae_duplicate tensor(-0.7108, dtype=torch.float64) tensor(-6.6646, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5702, dtype=torch.float64) delta_t tensor(0.2169, dtype=torch.float64)
13 gae_duplicate tensor(-0.0239, dtype=torch.float64) tensor(-4.9907, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3227, dtype=torch.float64) delta_t tensor(0.6774, dtype=torch.float64)
12 gae_duplicate tensor(0.5444, dtype=torch.float64) tensor(-13.8910, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2378, dtype=torch.float64) delta_t tensor(-0.2689, dtype=torch.float64)
11 gae_duplicate tensor(-1.5850, dtype=torch.float64) tensor(3.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3053, dtype=torch.float64) delta_t tensor(0.2345, dtype=torch.float64)
10 gae_duplicate tensor(-0.5195, dtype=torch.float64) tensor(-3.9156, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3853, dtype=torch.float64) delta_t tensor(-0.1958, dtype=torch.float64)
9 gae_duplicate tensor(-1.6528, dtype=torch.float64) tensor(4.5373, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2904, dtype=torch.float64) delta_t tensor(-0.4926, dtype=torch.float64)
8 gae_duplicate tensor(-2.3311, dtype=torch.float64) tensor(9.3400, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1423, dtype=torch.float64) delta_t tensor(0.3797, dtype=torch.float64)
7 gae_duplicate tensor(-0.5927, dtype=torch.float64) tensor(-5.9716, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1045, dtype=torch.float64) delta_t tensor(0.6377, dtype=torch.float64)
6 gae_duplicate tensor(0.5748, dtype=torch.float64) tensor(-13.2274, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2988, dtype=torch.float64) delta_t tensor(0.0984, dtype=torch.float64)
5 gae_duplicate tensor(0.0159, dtype=torch.float64) tensor(-3.2381, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0100, dtype=torch.float64) delta_t tensor(0.0420, dtype=torch.float64)
4 gae_duplicate tensor(-0.1020, dtype=torch.float64) tensor(-1.2024, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3103, dtype=torch.float64) delta_t tensor(-0.0514, dtype=torch.float64)
3 gae_duplicate tensor(-0.2008, dtype=torch.float64) tensor(0.8354, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3784, dtype=torch.float64) delta_t tensor(-0.1571, dtype=torch.float64)
2 gae_duplicate tensor(-0.4032, dtype=torch.float64) tensor(3.3601, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1591.62646484375
value loss:53.89210510253906
entropies:352.0697021484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.312900066375732 seconds
19 rew tensor(0.8461, dtype=torch.float64) delta_t tensor(-0.0549, dtype=torch.float64)
19 gae_duplicate tensor(-0.1503, dtype=torch.float64) tensor(1.0156, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6419, dtype=torch.float64) delta_t tensor(-0.1174, dtype=torch.float64)
18 gae_duplicate tensor(-1.1851, dtype=torch.float64) tensor(2.2570, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7991, dtype=torch.float64) delta_t tensor(0.0323, dtype=torch.float64)
17 gae_duplicate tensor(-0.0723, dtype=torch.float64) tensor(-0.4404, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6859, dtype=torch.float64) delta_t tensor(0.0465, dtype=torch.float64)
16 gae_duplicate tensor(-0.0776, dtype=torch.float64) tensor(-0.9116, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5472, dtype=torch.float64) delta_t tensor(-0.1276, dtype=torch.float64)
15 gae_duplicate tensor(-1.0350, dtype=torch.float64) tensor(2.2806, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5329, dtype=torch.float64) delta_t tensor(0.0950, dtype=torch.float64)
14 gae_duplicate tensor(-0.0960, dtype=torch.float64) tensor(-1.6805, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4647, dtype=torch.float64) delta_t tensor(0.0258, dtype=torch.float64)
13 gae_duplicate tensor(-0.7586, dtype=torch.float64) tensor(-1.0244, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5115, dtype=torch.float64) delta_t tensor(0.3407, dtype=torch.float64)
12 gae_duplicate tensor(-0.0091, dtype=torch.float64) tensor(-6.7197, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0495, dtype=torch.float64) delta_t tensor(-0.0206, dtype=torch.float64)
11 gae_duplicate tensor(-0.8487, dtype=torch.float64) tensor(0.5415, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2640, dtype=torch.float64) delta_t tensor(-0.1703, dtype=torch.float64)
10 gae_duplicate tensor(-1.7638, dtype=torch.float64) tensor(3.2858, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5573, dtype=torch.float64) delta_t tensor(-1.1692, dtype=torch.float64)
9 gae_duplicate tensor(-4.2237, dtype=torch.float64) tensor(22.9172, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3297, dtype=torch.float64) delta_t tensor(-0.9561, dtype=torch.float64)
8 gae_duplicate tensor(-4.9838, dtype=torch.float64) tensor(19.7863, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1094, dtype=torch.float64) delta_t tensor(0.6169, dtype=torch.float64)
7 gae_duplicate tensor(-0.1795, dtype=torch.float64) tensor(-10.6600, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1431, dtype=torch.float64) delta_t tensor(0.2415, dtype=torch.float64)
6 gae_duplicate tensor(-2.0225, dtype=torch.float64) tensor(-5.1086, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3839, dtype=torch.float64) delta_t tensor(-0.3200, dtype=torch.float64)
5 gae_duplicate tensor(-2.6415, dtype=torch.float64) tensor(5.4890, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2963, dtype=torch.float64) delta_t tensor(0.1339, dtype=torch.float64)
4 gae_duplicate tensor(-0.1641, dtype=torch.float64) tensor(-1.8817, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0308, dtype=torch.float64) delta_t tensor(-0.0174, dtype=torch.float64)
3 gae_duplicate tensor(-0.3001, dtype=torch.float64) tensor(0.1660, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2057, dtype=torch.float64) delta_t tensor(-0.1327, dtype=torch.float64)
2 gae_duplicate tensor(-0.4529, dtype=torch.float64) tensor(2.5279, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1814.4130859375
value loss:128.9372100830078
entropies:352.0837097167969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.841838121414185 seconds
19 rew tensor(0.8260, dtype=torch.float64) delta_t tensor(-0.0400, dtype=torch.float64)
19 gae_duplicate tensor(-0.1395, dtype=torch.float64) tensor(0.7900, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8066, dtype=torch.float64) delta_t tensor(0.0098, dtype=torch.float64)
18 gae_duplicate tensor(-0.1202, dtype=torch.float64) tensor(-0.0865, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7235, dtype=torch.float64) delta_t tensor(0.0165, dtype=torch.float64)
17 gae_duplicate tensor(-0.0384, dtype=torch.float64) tensor(-0.3156, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6011, dtype=torch.float64) delta_t tensor(-0.0934, dtype=torch.float64)
16 gae_duplicate tensor(-0.9715, dtype=torch.float64) tensor(1.8680, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4293, dtype=torch.float64) delta_t tensor(-0.1341, dtype=torch.float64)
15 gae_duplicate tensor(-1.0697, dtype=torch.float64) tensor(2.7481, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7037, dtype=torch.float64) delta_t tensor(0.2654, dtype=torch.float64)
14 gae_duplicate tensor(0.0040, dtype=torch.float64) tensor(-4.7549, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5259, dtype=torch.float64) delta_t tensor(0.6009, dtype=torch.float64)
13 gae_duplicate tensor(0.4399, dtype=torch.float64) tensor(-12.6028, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6258, dtype=torch.float64) delta_t tensor(0.4562, dtype=torch.float64)
12 gae_duplicate tensor(0.1904, dtype=torch.float64) tensor(-10.7312, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8721, dtype=torch.float64) delta_t tensor(-0.2495, dtype=torch.float64)
11 gae_duplicate tensor(-1.1373, dtype=torch.float64) tensor(3.9099, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3147, dtype=torch.float64) delta_t tensor(0.3510, dtype=torch.float64)
10 gae_duplicate tensor(-0.5538, dtype=torch.float64) tensor(-6.7338, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-3.2772, dtype=torch.float64) delta_t tensor(-2.1502, dtype=torch.float64)
9 gae_duplicate tensor(-3.6312, dtype=torch.float64) tensor(39.1360, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9782, dtype=torch.float64) delta_t tensor(-0.9013, dtype=torch.float64)
8 gae_duplicate tensor(-3.9353, dtype=torch.float64) tensor(21.3905, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8105, dtype=torch.float64) delta_t tensor(0.3248, dtype=torch.float64)
7 gae_duplicate tensor(-1.3231, dtype=torch.float64) tensor(-4.9334, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5297, dtype=torch.float64) delta_t tensor(0.6170, dtype=torch.float64)
6 gae_duplicate tensor(0.4468, dtype=torch.float64) tensor(-12.8211, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4909, dtype=torch.float64) delta_t tensor(0.0222, dtype=torch.float64)
5 gae_duplicate tensor(-0.0909, dtype=torch.float64) tensor(-1.5657, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.6442, dtype=torch.float64) delta_t tensor(0.1795, dtype=torch.float64)
4 gae_duplicate tensor(0.0419, dtype=torch.float64) tensor(-3.4514, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2822, dtype=torch.float64) delta_t tensor(-0.0686, dtype=torch.float64)
3 gae_duplicate tensor(-0.1621, dtype=torch.float64) tensor(0.8426, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0216, dtype=torch.float64) delta_t tensor(0.1462, dtype=torch.float64)
2 gae_duplicate tensor(-0.2045, dtype=torch.float64) tensor(-2.7596, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-631.2986450195312
value loss:115.76793670654297
entropies:352.3247375488281
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3942.3730)
ToM Target loss= tensor(3602.2976)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.80264687538147 seconds
19 rew tensor(0.8268, dtype=torch.float64) delta_t tensor(-0.0516, dtype=torch.float64)
19 gae_duplicate tensor(-0.1248, dtype=torch.float64) tensor(0.9511, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7422, dtype=torch.float64) delta_t tensor(-0.0309, dtype=torch.float64)
18 gae_duplicate tensor(-0.2156, dtype=torch.float64) tensor(0.5975, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6842, dtype=torch.float64) delta_t tensor(0.0312, dtype=torch.float64)
17 gae_duplicate tensor(-0.0506, dtype=torch.float64) tensor(-0.5204, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6986, dtype=torch.float64) delta_t tensor(0.0620, dtype=torch.float64)
16 gae_duplicate tensor(-0.0278, dtype=torch.float64) tensor(-1.1911, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2997, dtype=torch.float64) delta_t tensor(-0.1555, dtype=torch.float64)
15 gae_duplicate tensor(-1.1826, dtype=torch.float64) tensor(2.8783, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4860, dtype=torch.float64) delta_t tensor(0.0578, dtype=torch.float64)
14 gae_duplicate tensor(-0.9088, dtype=torch.float64) tensor(-0.9549, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2343, dtype=torch.float64) delta_t tensor(0.1156, dtype=torch.float64)
13 gae_duplicate tensor(-1.1337, dtype=torch.float64) tensor(-2.1532, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6684, dtype=torch.float64) delta_t tensor(0.3878, dtype=torch.float64)
12 gae_duplicate tensor(0.1988, dtype=torch.float64) tensor(-7.7203, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6059, dtype=torch.float64) delta_t tensor(-0.2948, dtype=torch.float64)
11 gae_duplicate tensor(-0.5210, dtype=torch.float64) tensor(5.3837, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0393, dtype=torch.float64) delta_t tensor(-0.0973, dtype=torch.float64)
10 gae_duplicate tensor(-1.7840, dtype=torch.float64) tensor(2.3996, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6460, dtype=torch.float64) delta_t tensor(-0.8801, dtype=torch.float64)
9 gae_duplicate tensor(-3.4974, dtype=torch.float64) tensor(17.5395, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1798, dtype=torch.float64) delta_t tensor(-0.1416, dtype=torch.float64)
8 gae_duplicate tensor(-2.8388, dtype=torch.float64) tensor(3.2543, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9336, dtype=torch.float64) delta_t tensor(-0.0565, dtype=torch.float64)
7 gae_duplicate tensor(-1.3382, dtype=torch.float64) tensor(1.9459, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0739, dtype=torch.float64) delta_t tensor(0.2235, dtype=torch.float64)
6 gae_duplicate tensor(-2.0224, dtype=torch.float64) tensor(-4.1308, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2395, dtype=torch.float64) delta_t tensor(0.0111, dtype=torch.float64)
5 gae_duplicate tensor(-0.1516, dtype=torch.float64) tensor(-0.6115, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4338, dtype=torch.float64) delta_t tensor(0.0563, dtype=torch.float64)
4 gae_duplicate tensor(-0.2375, dtype=torch.float64) tensor(-1.2087, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1334, dtype=torch.float64) delta_t tensor(0.0815, dtype=torch.float64)
3 gae_duplicate tensor(-0.0841, dtype=torch.float64) tensor(-1.6524, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1424, dtype=torch.float64) delta_t tensor(-0.1793, dtype=torch.float64)
2 gae_duplicate tensor(-0.4310, dtype=torch.float64) tensor(3.2738, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1071.58935546875
value loss:87.4412841796875
entropies:352.7462158203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.011708974838257 seconds
19 rew tensor(0.8634, dtype=torch.float64) delta_t tensor(-0.0374, dtype=torch.float64)
19 gae_duplicate tensor(-0.1105, dtype=torch.float64) tensor(0.7577, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7964, dtype=torch.float64) delta_t tensor(0.0155, dtype=torch.float64)
18 gae_duplicate tensor(-0.1042, dtype=torch.float64) tensor(-0.2193, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8077, dtype=torch.float64) delta_t tensor(0.0665, dtype=torch.float64)
17 gae_duplicate tensor(-0.0801, dtype=torch.float64) tensor(-1.2655, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6558, dtype=torch.float64) delta_t tensor(0.0698, dtype=torch.float64)
16 gae_duplicate tensor(-0.1133, dtype=torch.float64) tensor(-1.5878, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4240, dtype=torch.float64) delta_t tensor(-0.1432, dtype=torch.float64)
15 gae_duplicate tensor(-1.1097, dtype=torch.float64) tensor(2.2346, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2994, dtype=torch.float64) delta_t tensor(0.0176, dtype=torch.float64)
14 gae_duplicate tensor(-0.6745, dtype=torch.float64) tensor(0.4518, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5519, dtype=torch.float64) delta_t tensor(0.3880, dtype=torch.float64)
13 gae_duplicate tensor(-0.0016, dtype=torch.float64) tensor(-7.4498, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3176, dtype=torch.float64) delta_t tensor(0.1675, dtype=torch.float64)
12 gae_duplicate tensor(-1.1920, dtype=torch.float64) tensor(-4.2746, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0802, dtype=torch.float64) delta_t tensor(0.1853, dtype=torch.float64)
11 gae_duplicate tensor(-0.5929, dtype=torch.float64) tensor(-3.3486, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0179, dtype=torch.float64) delta_t tensor(0.1576, dtype=torch.float64)
10 gae_duplicate tensor(-0.7223, dtype=torch.float64) tensor(-3.3270, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6723, dtype=torch.float64) delta_t tensor(-1.0995, dtype=torch.float64)
9 gae_duplicate tensor(-3.4002, dtype=torch.float64) tensor(22.3551, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4242, dtype=torch.float64) delta_t tensor(0.0096, dtype=torch.float64)
8 gae_duplicate tensor(-2.7048, dtype=torch.float64) tensor(1.3256, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6301, dtype=torch.float64) delta_t tensor(-0.0053, dtype=torch.float64)
7 gae_duplicate tensor(-2.7263, dtype=torch.float64) tensor(-0.7295, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2553, dtype=torch.float64) delta_t tensor(0.2591, dtype=torch.float64)
6 gae_duplicate tensor(-2.1503, dtype=torch.float64) tensor(-5.3322, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0555, dtype=torch.float64) delta_t tensor(0.0049, dtype=torch.float64)
5 gae_duplicate tensor(-0.3273, dtype=torch.float64) tensor(-0.4850, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1095, dtype=torch.float64) delta_t tensor(0.0395, dtype=torch.float64)
4 gae_duplicate tensor(-0.2144, dtype=torch.float64) tensor(-0.5998, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1588, dtype=torch.float64) delta_t tensor(0.0054, dtype=torch.float64)
3 gae_duplicate tensor(-0.1301, dtype=torch.float64) tensor(-0.1575, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2856, dtype=torch.float64) delta_t tensor(-0.1769, dtype=torch.float64)
2 gae_duplicate tensor(-0.5572, dtype=torch.float64) tensor(3.4071, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-190.14463806152344
value loss:100.1255111694336
entropies:353.1955871582031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.938315153121948 seconds
19 rew tensor(0.8233, dtype=torch.float64) delta_t tensor(-0.0674, dtype=torch.float64)
19 gae_duplicate tensor(-0.1392, dtype=torch.float64) tensor(1.4032, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7882, dtype=torch.float64) delta_t tensor(-0.0087, dtype=torch.float64)
18 gae_duplicate tensor(-0.1167, dtype=torch.float64) tensor(0.2564, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7317, dtype=torch.float64) delta_t tensor(-0.0057, dtype=torch.float64)
17 gae_duplicate tensor(-0.0831, dtype=torch.float64) tensor(0.1687, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7092, dtype=torch.float64) delta_t tensor(0.0452, dtype=torch.float64)
16 gae_duplicate tensor(-0.0346, dtype=torch.float64) tensor(-0.8239, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5624, dtype=torch.float64) delta_t tensor(-0.0286, dtype=torch.float64)
15 gae_duplicate tensor(-0.1360, dtype=torch.float64) tensor(0.4846, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2490, dtype=torch.float64) delta_t tensor(-0.0800, dtype=torch.float64)
14 gae_duplicate tensor(-0.9213, dtype=torch.float64) tensor(1.3670, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5537, dtype=torch.float64) delta_t tensor(0.4521, dtype=torch.float64)
13 gae_duplicate tensor(0.1728, dtype=torch.float64) tensor(-9.2547, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3748, dtype=torch.float64) delta_t tensor(0.2322, dtype=torch.float64)
12 gae_duplicate tensor(-0.4598, dtype=torch.float64) tensor(-5.4100, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3955, dtype=torch.float64) delta_t tensor(-0.1591, dtype=torch.float64)
11 gae_duplicate tensor(-1.7427, dtype=torch.float64) tensor(3.3103, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0774, dtype=torch.float64) delta_t tensor(0.1818, dtype=torch.float64)
10 gae_duplicate tensor(-0.5540, dtype=torch.float64) tensor(-3.2013, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.8519, dtype=torch.float64) delta_t tensor(-2.1857, dtype=torch.float64)
9 gae_duplicate tensor(-4.1139, dtype=torch.float64) tensor(42.7063, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.0821, dtype=torch.float64) delta_t tensor(-1.7895, dtype=torch.float64)
8 gae_duplicate tensor(-4.8916, dtype=torch.float64) tensor(38.2163, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9412, dtype=torch.float64) delta_t tensor(-0.2186, dtype=torch.float64)
7 gae_duplicate tensor(-1.9240, dtype=torch.float64) tensor(8.0721, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2562, dtype=torch.float64) delta_t tensor(0.0121, dtype=torch.float64)
6 gae_duplicate tensor(-1.8695, dtype=torch.float64) tensor(0.8339, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0393, dtype=torch.float64) delta_t tensor(0.0733, dtype=torch.float64)
5 gae_duplicate tensor(-0.3346, dtype=torch.float64) tensor(-1.5021, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3764, dtype=torch.float64) delta_t tensor(0.0581, dtype=torch.float64)
4 gae_duplicate tensor(-0.1251, dtype=torch.float64) tensor(-1.2166, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0406, dtype=torch.float64) delta_t tensor(-0.0557, dtype=torch.float64)
3 gae_duplicate tensor(-0.4557, dtype=torch.float64) tensor(0.9003, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1915, dtype=torch.float64) delta_t tensor(-0.0040, dtype=torch.float64)
2 gae_duplicate tensor(-0.3101, dtype=torch.float64) tensor(-0.0592, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4213.00830078125
value loss:172.8470916748047
entropies:353.45135498046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.008040189743042 seconds
19 rew tensor(0.8719, dtype=torch.float64) delta_t tensor(-0.0319, dtype=torch.float64)
19 gae_duplicate tensor(-0.0634, dtype=torch.float64) tensor(0.6296, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8337, dtype=torch.float64) delta_t tensor(0.0526, dtype=torch.float64)
18 gae_duplicate tensor(-0.1025, dtype=torch.float64) tensor(-0.9327, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8351, dtype=torch.float64) delta_t tensor(0.0748, dtype=torch.float64)
17 gae_duplicate tensor(-0.0422, dtype=torch.float64) tensor(-1.6708, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6182, dtype=torch.float64) delta_t tensor(-0.0220, dtype=torch.float64)
16 gae_duplicate tensor(-0.1213, dtype=torch.float64) tensor(0.2577, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6781, dtype=torch.float64) delta_t tensor(0.0511, dtype=torch.float64)
15 gae_duplicate tensor(-0.0821, dtype=torch.float64) tensor(-0.9743, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5237, dtype=torch.float64) delta_t tensor(0.1022, dtype=torch.float64)
14 gae_duplicate tensor(-0.0638, dtype=torch.float64) tensor(-2.1642, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2389, dtype=torch.float64) delta_t tensor(-0.0493, dtype=torch.float64)
13 gae_duplicate tensor(-1.0148, dtype=torch.float64) tensor(1.1085, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4392, dtype=torch.float64) delta_t tensor(0.4212, dtype=torch.float64)
12 gae_duplicate tensor(0.1882, dtype=torch.float64) tensor(-8.1231, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1542, dtype=torch.float64) delta_t tensor(0.1235, dtype=torch.float64)
11 gae_duplicate tensor(-0.7338, dtype=torch.float64) tensor(-3.2033, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0691, dtype=torch.float64) delta_t tensor(0.4571, dtype=torch.float64)
10 gae_duplicate tensor(-1.5683, dtype=torch.float64) tensor(-9.7344, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1722, dtype=torch.float64) delta_t tensor(-0.7601, dtype=torch.float64)
9 gae_duplicate tensor(-4.5336, dtype=torch.float64) tensor(13.4741, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2588, dtype=torch.float64) delta_t tensor(0.5182, dtype=torch.float64)
8 gae_duplicate tensor(-1.0654, dtype=torch.float64) tensor(-8.6032, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0752, dtype=torch.float64) delta_t tensor(0.3081, dtype=torch.float64)
7 gae_duplicate tensor(-1.2436, dtype=torch.float64) tensor(-6.7036, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4332, dtype=torch.float64) delta_t tensor(0.2852, dtype=torch.float64)
6 gae_duplicate tensor(-0.5956, dtype=torch.float64) tensor(-6.3898, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0503, dtype=torch.float64) delta_t tensor(-0.1013, dtype=torch.float64)
5 gae_duplicate tensor(-0.2264, dtype=torch.float64) tensor(1.4158, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1188, dtype=torch.float64) delta_t tensor(0.1046, dtype=torch.float64)
4 gae_duplicate tensor(-0.0672, dtype=torch.float64) tensor(-1.9198, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1888, dtype=torch.float64) delta_t tensor(0.0128, dtype=torch.float64)
3 gae_duplicate tensor(-0.1164, dtype=torch.float64) tensor(-0.3819, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3461, dtype=torch.float64) delta_t tensor(-0.1949, dtype=torch.float64)
2 gae_duplicate tensor(-0.5839, dtype=torch.float64) tensor(3.7242, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1534.784423828125
value loss:83.10135650634766
entropies:353.85516357421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.674558162689209 seconds
19 rew tensor(0.8252, dtype=torch.float64) delta_t tensor(-0.0683, dtype=torch.float64)
19 gae_duplicate tensor(-0.1173, dtype=torch.float64) tensor(1.3579, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7333, dtype=torch.float64) delta_t tensor(-0.0314, dtype=torch.float64)
18 gae_duplicate tensor(-0.2083, dtype=torch.float64) tensor(0.8080, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7140, dtype=torch.float64) delta_t tensor(0.0214, dtype=torch.float64)
17 gae_duplicate tensor(-0.1159, dtype=torch.float64) tensor(-0.2890, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6952, dtype=torch.float64) delta_t tensor(0.0155, dtype=torch.float64)
16 gae_duplicate tensor(-0.1418, dtype=torch.float64) tensor(-0.3384, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5882, dtype=torch.float64) delta_t tensor(-0.0332, dtype=torch.float64)
15 gae_duplicate tensor(-0.1205, dtype=torch.float64) tensor(0.5726, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2421, dtype=torch.float64) delta_t tensor(-0.1703, dtype=torch.float64)
14 gae_duplicate tensor(-0.9809, dtype=torch.float64) tensor(3.5314, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5243, dtype=torch.float64) delta_t tensor(0.2020, dtype=torch.float64)
13 gae_duplicate tensor(-0.0930, dtype=torch.float64) tensor(-3.6798, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3378, dtype=torch.float64) delta_t tensor(0.2068, dtype=torch.float64)
12 gae_duplicate tensor(-0.5128, dtype=torch.float64) tensor(-4.3460, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1202, dtype=torch.float64) delta_t tensor(0.1660, dtype=torch.float64)
11 gae_duplicate tensor(-1.7096, dtype=torch.float64) tensor(-4.1934, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3460, dtype=torch.float64) delta_t tensor(-0.2615, dtype=torch.float64)
10 gae_duplicate tensor(-0.8094, dtype=torch.float64) tensor(4.7253, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0567, dtype=torch.float64) delta_t tensor(-0.6476, dtype=torch.float64)
9 gae_duplicate tensor(-2.7157, dtype=torch.float64) tensor(13.5061, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3748, dtype=torch.float64) delta_t tensor(-0.9590, dtype=torch.float64)
8 gae_duplicate tensor(-3.0301, dtype=torch.float64) tensor(19.9027, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6330, dtype=torch.float64) delta_t tensor(-0.1653, dtype=torch.float64)
7 gae_duplicate tensor(-2.4905, dtype=torch.float64) tensor(6.0082, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0225, dtype=torch.float64) delta_t tensor(0.4493, dtype=torch.float64)
6 gae_duplicate tensor(-1.2776, dtype=torch.float64) tensor(-8.6510, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2882, dtype=torch.float64) delta_t tensor(-0.2404, dtype=torch.float64)
5 gae_duplicate tensor(-2.4181, dtype=torch.float64) tensor(4.0400, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2322, dtype=torch.float64) delta_t tensor(0.2321, dtype=torch.float64)
4 gae_duplicate tensor(0.0167, dtype=torch.float64) tensor(-4.0879, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0318, dtype=torch.float64) delta_t tensor(-0.0253, dtype=torch.float64)
3 gae_duplicate tensor(-0.1964, dtype=torch.float64) tensor(0.0969, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1943, dtype=torch.float64) delta_t tensor(-0.1066, dtype=torch.float64)
2 gae_duplicate tensor(-0.2678, dtype=torch.float64) tensor(2.0485, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1770.300537109375
value loss:109.54345703125
entropies:354.2620849609375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3948.8120)
ToM Target loss= tensor(3607.4561)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.795224905014038 seconds
19 rew tensor(0.8523, dtype=torch.float64) delta_t tensor(-0.0344, dtype=torch.float64)
19 gae_duplicate tensor(-0.1081, dtype=torch.float64) tensor(0.6579, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5365, dtype=torch.float64) delta_t tensor(-0.2183, dtype=torch.float64)
18 gae_duplicate tensor(-1.2550, dtype=torch.float64) tensor(4.2127, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7981, dtype=torch.float64) delta_t tensor(0.0466, dtype=torch.float64)
17 gae_duplicate tensor(-0.0367, dtype=torch.float64) tensor(-0.4950, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6257, dtype=torch.float64) delta_t tensor(0.0712, dtype=torch.float64)
16 gae_duplicate tensor(-0.0347, dtype=torch.float64) tensor(-1.3838, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4471, dtype=torch.float64) delta_t tensor(-0.1497, dtype=torch.float64)
15 gae_duplicate tensor(-1.0138, dtype=torch.float64) tensor(2.9515, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1553, dtype=torch.float64) delta_t tensor(0.0237, dtype=torch.float64)
14 gae_duplicate tensor(-0.8070, dtype=torch.float64) tensor(-0.0145, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4658, dtype=torch.float64) delta_t tensor(0.3009, dtype=torch.float64)
13 gae_duplicate tensor(-0.7258, dtype=torch.float64) tensor(-5.9803, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2502, dtype=torch.float64) delta_t tensor(0.1909, dtype=torch.float64)
12 gae_duplicate tensor(-0.6338, dtype=torch.float64) tensor(-4.1218, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1860, dtype=torch.float64) delta_t tensor(-0.0990, dtype=torch.float64)
11 gae_duplicate tensor(-1.6300, dtype=torch.float64) tensor(1.1728, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1658, dtype=torch.float64) delta_t tensor(0.0252, dtype=torch.float64)
10 gae_duplicate tensor(-0.6283, dtype=torch.float64) tensor(-0.5385, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7239, dtype=torch.float64) delta_t tensor(-1.3314, dtype=torch.float64)
9 gae_duplicate tensor(-3.0112, dtype=torch.float64) tensor(24.7458, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.1604, dtype=torch.float64) delta_t tensor(-1.6572, dtype=torch.float64)
8 gae_duplicate tensor(-3.8351, dtype=torch.float64) tensor(36.5534, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2631, dtype=torch.float64) delta_t tensor(0.6645, dtype=torch.float64)
7 gae_duplicate tensor(-0.7421, dtype=torch.float64) tensor(-9.2550, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0179, dtype=torch.float64) delta_t tensor(0.4706, dtype=torch.float64)
6 gae_duplicate tensor(-0.6850, dtype=torch.float64) tensor(-9.7731, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2467, dtype=torch.float64) delta_t tensor(0.1134, dtype=torch.float64)
5 gae_duplicate tensor(-0.0482, dtype=torch.float64) tensor(-3.3188, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1862, dtype=torch.float64) delta_t tensor(0.0592, dtype=torch.float64)
4 gae_duplicate tensor(-0.2173, dtype=torch.float64) tensor(-1.3648, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2313, dtype=torch.float64) delta_t tensor(0.0244, dtype=torch.float64)
3 gae_duplicate tensor(-0.2059, dtype=torch.float64) tensor(-0.7811, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3350, dtype=torch.float64) delta_t tensor(-0.1167, dtype=torch.float64)
2 gae_duplicate tensor(-0.3401, dtype=torch.float64) tensor(2.2921, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2015.927734375
value loss:116.140380859375
entropies:354.5208740234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.024672985076904 seconds
19 rew tensor(0.8611, dtype=torch.float64) delta_t tensor(-0.0348, dtype=torch.float64)
19 gae_duplicate tensor(-0.0634, dtype=torch.float64) tensor(0.6934, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8524, dtype=torch.float64) delta_t tensor(0.0577, dtype=torch.float64)
18 gae_duplicate tensor(-0.0114, dtype=torch.float64) tensor(-1.0852, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8434, dtype=torch.float64) delta_t tensor(0.0813, dtype=torch.float64)
17 gae_duplicate tensor(0.0038, dtype=torch.float64) tensor(-1.7421, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7690, dtype=torch.float64) delta_t tensor(0.0516, dtype=torch.float64)
16 gae_duplicate tensor(-0.0057, dtype=torch.float64) tensor(-1.1408, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7118, dtype=torch.float64) delta_t tensor(0.1383, dtype=torch.float64)
15 gae_duplicate tensor(-0.0835, dtype=torch.float64) tensor(-2.7511, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6747, dtype=torch.float64) delta_t tensor(0.2976, dtype=torch.float64)
14 gae_duplicate tensor(0.1178, dtype=torch.float64) tensor(-6.1885, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5512, dtype=torch.float64) delta_t tensor(0.4573, dtype=torch.float64)
13 gae_duplicate tensor(0.1483, dtype=torch.float64) tensor(-9.8281, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6060, dtype=torch.float64) delta_t tensor(0.4550, dtype=torch.float64)
12 gae_duplicate tensor(0.3061, dtype=torch.float64) tensor(-9.9646, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4265, dtype=torch.float64) delta_t tensor(-0.0780, dtype=torch.float64)
11 gae_duplicate tensor(-1.6252, dtype=torch.float64) tensor(0.8352, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0522, dtype=torch.float64) delta_t tensor(0.2226, dtype=torch.float64)
10 gae_duplicate tensor(-0.4808, dtype=torch.float64) tensor(-4.1570, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.0918, dtype=torch.float64) delta_t tensor(-1.1435, dtype=torch.float64)
9 gae_duplicate tensor(-3.2729, dtype=torch.float64) tensor(23.2435, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3188, dtype=torch.float64) delta_t tensor(-0.0918, dtype=torch.float64)
8 gae_duplicate tensor(-1.5042, dtype=torch.float64) tensor(3.5184, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9860, dtype=torch.float64) delta_t tensor(0.0353, dtype=torch.float64)
7 gae_duplicate tensor(-1.5980, dtype=torch.float64) tensor(0.1330, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2148, dtype=torch.float64) delta_t tensor(0.0594, dtype=torch.float64)
6 gae_duplicate tensor(-1.5017, dtype=torch.float64) tensor(-1.8176, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2695, dtype=torch.float64) delta_t tensor(0.1561, dtype=torch.float64)
5 gae_duplicate tensor(0.0015, dtype=torch.float64) tensor(-3.1441, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4483, dtype=torch.float64) delta_t tensor(0.1733, dtype=torch.float64)
4 gae_duplicate tensor(-0.0700, dtype=torch.float64) tensor(-3.7882, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1380, dtype=torch.float64) delta_t tensor(-0.0625, dtype=torch.float64)
3 gae_duplicate tensor(-0.1931, dtype=torch.float64) tensor(0.9372, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1143, dtype=torch.float64) delta_t tensor(-0.0776, dtype=torch.float64)
2 gae_duplicate tensor(-0.3279, dtype=torch.float64) tensor(1.6686, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:691.464599609375
value loss:80.77825927734375
entropies:354.61151123046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.753652811050415 seconds
19 rew tensor(0.8215, dtype=torch.float64) delta_t tensor(-0.0172, dtype=torch.float64)
19 gae_duplicate tensor(-0.0880, dtype=torch.float64) tensor(0.3523, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5850, dtype=torch.float64) delta_t tensor(-0.1682, dtype=torch.float64)
18 gae_duplicate tensor(-1.1575, dtype=torch.float64) tensor(3.5392, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7375, dtype=torch.float64) delta_t tensor(0.0390, dtype=torch.float64)
17 gae_duplicate tensor(-0.2006, dtype=torch.float64) tensor(-0.5523, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7157, dtype=torch.float64) delta_t tensor(0.0885, dtype=torch.float64)
16 gae_duplicate tensor(-0.0145, dtype=torch.float64) tensor(-1.8855, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4514, dtype=torch.float64) delta_t tensor(-0.0156, dtype=torch.float64)
15 gae_duplicate tensor(-1.0366, dtype=torch.float64) tensor(-0.0541, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5065, dtype=torch.float64) delta_t tensor(0.1173, dtype=torch.float64)
14 gae_duplicate tensor(-0.4603, dtype=torch.float64) tensor(-2.3618, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3318, dtype=torch.float64) delta_t tensor(0.2327, dtype=torch.float64)
13 gae_duplicate tensor(-0.6355, dtype=torch.float64) tensor(-4.9716, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6686, dtype=torch.float64) delta_t tensor(0.4389, dtype=torch.float64)
12 gae_duplicate tensor(0.3328, dtype=torch.float64) tensor(-9.0516, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2442, dtype=torch.float64) delta_t tensor(0.1604, dtype=torch.float64)
11 gae_duplicate tensor(-1.2466, dtype=torch.float64) tensor(-4.0837, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0097, dtype=torch.float64) delta_t tensor(0.0479, dtype=torch.float64)
10 gae_duplicate tensor(-1.6989, dtype=torch.float64) tensor(-0.8522, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5356, dtype=torch.float64) delta_t tensor(-0.6122, dtype=torch.float64)
9 gae_duplicate tensor(-3.2150, dtype=torch.float64) tensor(11.6036, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7197, dtype=torch.float64) delta_t tensor(-0.5374, dtype=torch.float64)
8 gae_duplicate tensor(-2.2917, dtype=torch.float64) tensor(11.3557, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5631, dtype=torch.float64) delta_t tensor(0.4467, dtype=torch.float64)
7 gae_duplicate tensor(-1.0028, dtype=torch.float64) tensor(-8.2893, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2828, dtype=torch.float64) delta_t tensor(0.5063, dtype=torch.float64)
6 gae_duplicate tensor(-0.4387, dtype=torch.float64) tensor(-10.5245, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2361, dtype=torch.float64) delta_t tensor(0.0131, dtype=torch.float64)
5 gae_duplicate tensor(-0.2141, dtype=torch.float64) tensor(-1.3157, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4351, dtype=torch.float64) delta_t tensor(0.2258, dtype=torch.float64)
4 gae_duplicate tensor(-0.1331, dtype=torch.float64) tensor(-4.5032, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0969, dtype=torch.float64) delta_t tensor(-0.0181, dtype=torch.float64)
3 gae_duplicate tensor(-0.3331, dtype=torch.float64) tensor(-0.2595, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1835, dtype=torch.float64) delta_t tensor(-0.1683, dtype=torch.float64)
2 gae_duplicate tensor(-0.3652, dtype=torch.float64) tensor(3.3080, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:905.7606201171875
value loss:83.68278503417969
entropies:354.543212890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.886429071426392 seconds
19 rew tensor(0.8802, dtype=torch.float64) delta_t tensor(0.0325, dtype=torch.float64)
19 gae_duplicate tensor(-0.0176, dtype=torch.float64) tensor(-0.6592, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8807, dtype=torch.float64) delta_t tensor(0.1177, dtype=torch.float64)
18 gae_duplicate tensor(0.0792, dtype=torch.float64) tensor(-2.3153, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8120, dtype=torch.float64) delta_t tensor(0.0830, dtype=torch.float64)
17 gae_duplicate tensor(-0.0256, dtype=torch.float64) tensor(-1.9304, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7965, dtype=torch.float64) delta_t tensor(0.0959, dtype=torch.float64)
16 gae_duplicate tensor(-0.0111, dtype=torch.float64) tensor(-2.0515, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6918, dtype=torch.float64) delta_t tensor(0.1108, dtype=torch.float64)
15 gae_duplicate tensor(-0.0847, dtype=torch.float64) tensor(-2.4849, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6875, dtype=torch.float64) delta_t tensor(0.3033, dtype=torch.float64)
14 gae_duplicate tensor(-0.0029, dtype=torch.float64) tensor(-5.9884, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5597, dtype=torch.float64) delta_t tensor(0.4094, dtype=torch.float64)
13 gae_duplicate tensor(0.0610, dtype=torch.float64) tensor(-8.7465, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6351, dtype=torch.float64) delta_t tensor(0.5462, dtype=torch.float64)
12 gae_duplicate tensor(0.3211, dtype=torch.float64) tensor(-11.6574, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2217, dtype=torch.float64) delta_t tensor(0.5034, dtype=torch.float64)
11 gae_duplicate tensor(-0.2726, dtype=torch.float64) tensor(-11.1579, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.0409, dtype=torch.float64) delta_t tensor(-0.8910, dtype=torch.float64)
10 gae_duplicate tensor(-2.5914, dtype=torch.float64) tensor(17.0366, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4727, dtype=torch.float64) delta_t tensor(-0.6566, dtype=torch.float64)
9 gae_duplicate tensor(-2.4256, dtype=torch.float64) tensor(14.7023, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5370, dtype=torch.float64) delta_t tensor(-0.1976, dtype=torch.float64)
8 gae_duplicate tensor(-3.9828, dtype=torch.float64) tensor(5.1770, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6092, dtype=torch.float64) delta_t tensor(0.3615, dtype=torch.float64)
7 gae_duplicate tensor(-1.3025, dtype=torch.float64) tensor(-6.1773, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3464, dtype=torch.float64) delta_t tensor(0.7212, dtype=torch.float64)
6 gae_duplicate tensor(0.4117, dtype=torch.float64) tensor(-14.8477, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6857, dtype=torch.float64) delta_t tensor(-0.3759, dtype=torch.float64)
5 gae_duplicate tensor(-1.9759, dtype=torch.float64) tensor(5.9105, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1107, dtype=torch.float64) delta_t tensor(0.0574, dtype=torch.float64)
4 gae_duplicate tensor(-0.7259, dtype=torch.float64) tensor(-0.6185, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0324, dtype=torch.float64) delta_t tensor(0.0157, dtype=torch.float64)
3 gae_duplicate tensor(-0.2600, dtype=torch.float64) tensor(-0.3931, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3075, dtype=torch.float64) delta_t tensor(-0.1484, dtype=torch.float64)
2 gae_duplicate tensor(-0.4922, dtype=torch.float64) tensor(2.8156, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1167.0926513671875
value loss:101.4647216796875
entropies:354.6224060058594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.076664924621582 seconds
19 rew tensor(0.8709, dtype=torch.float64) delta_t tensor(0.0122, dtype=torch.float64)
19 gae_duplicate tensor(-0.0635, dtype=torch.float64) tensor(-0.2621, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7938, dtype=torch.float64) delta_t tensor(0.0740, dtype=torch.float64)
18 gae_duplicate tensor(-0.0121, dtype=torch.float64) tensor(-1.5188, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7857, dtype=torch.float64) delta_t tensor(0.0619, dtype=torch.float64)
17 gae_duplicate tensor(-0.0244, dtype=torch.float64) tensor(-1.3577, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6999, dtype=torch.float64) delta_t tensor(0.1180, dtype=torch.float64)
16 gae_duplicate tensor(-0.0160, dtype=torch.float64) tensor(-2.3936, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4396, dtype=torch.float64) delta_t tensor(-0.1508, dtype=torch.float64)
15 gae_duplicate tensor(-1.0718, dtype=torch.float64) tensor(3.0030, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5475, dtype=torch.float64) delta_t tensor(0.4161, dtype=torch.float64)
14 gae_duplicate tensor(0.0567, dtype=torch.float64) tensor(-7.7967, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6363, dtype=torch.float64) delta_t tensor(0.3215, dtype=torch.float64)
13 gae_duplicate tensor(0.1020, dtype=torch.float64) tensor(-7.1277, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1693, dtype=torch.float64) delta_t tensor(0.3959, dtype=torch.float64)
12 gae_duplicate tensor(-0.8600, dtype=torch.float64) tensor(-8.3314, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6536, dtype=torch.float64) delta_t tensor(-0.6379, dtype=torch.float64)
11 gae_duplicate tensor(-1.4524, dtype=torch.float64) tensor(11.6445, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2109, dtype=torch.float64) delta_t tensor(0.6682, dtype=torch.float64)
10 gae_duplicate tensor(0.4734, dtype=torch.float64) tensor(-12.3795, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7274, dtype=torch.float64) delta_t tensor(-0.3622, dtype=torch.float64)
9 gae_duplicate tensor(-2.6109, dtype=torch.float64) tensor(6.4709, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.5124, dtype=torch.float64) delta_t tensor(-1.7163, dtype=torch.float64)
8 gae_duplicate tensor(-3.2593, dtype=torch.float64) tensor(35.1227, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1511, dtype=torch.float64) delta_t tensor(0.6009, dtype=torch.float64)
7 gae_duplicate tensor(-1.0741, dtype=torch.float64) tensor(-8.1521, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2846, dtype=torch.float64) delta_t tensor(0.4425, dtype=torch.float64)
6 gae_duplicate tensor(-1.3949, dtype=torch.float64) tensor(-9.7327, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1076, dtype=torch.float64) delta_t tensor(0.0024, dtype=torch.float64)
5 gae_duplicate tensor(-1.1577, dtype=torch.float64) tensor(-1.0141, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1924, dtype=torch.float64) delta_t tensor(0.2285, dtype=torch.float64)
4 gae_duplicate tensor(-0.0532, dtype=torch.float64) tensor(-4.5882, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1865, dtype=torch.float64) delta_t tensor(-0.0682, dtype=torch.float64)
3 gae_duplicate tensor(-0.1910, dtype=torch.float64) tensor(0.9149, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2913, dtype=torch.float64) delta_t tensor(-0.0615, dtype=torch.float64)
2 gae_duplicate tensor(-0.1890, dtype=torch.float64) tensor(1.2845, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:239.82546997070312
value loss:94.495849609375
entropies:354.5558166503906
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3946.4609)
ToM Target loss= tensor(3614.1431)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.950769901275635 seconds
19 rew tensor(0.8700, dtype=torch.float64) delta_t tensor(0.0200, dtype=torch.float64)
19 gae_duplicate tensor(-0.0872, dtype=torch.float64) tensor(-0.4204, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7660, dtype=torch.float64) delta_t tensor(0.0545, dtype=torch.float64)
18 gae_duplicate tensor(-0.0244, dtype=torch.float64) tensor(-1.0805, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8330, dtype=torch.float64) delta_t tensor(0.0838, dtype=torch.float64)
17 gae_duplicate tensor(0.0079, dtype=torch.float64) tensor(-1.6449, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6516, dtype=torch.float64) delta_t tensor(0.0976, dtype=torch.float64)
16 gae_duplicate tensor(-0.0604, dtype=torch.float64) tensor(-1.9683, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6892, dtype=torch.float64) delta_t tensor(0.0905, dtype=torch.float64)
15 gae_duplicate tensor(0.0198, dtype=torch.float64) tensor(-1.9812, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5551, dtype=torch.float64) delta_t tensor(0.3615, dtype=torch.float64)
14 gae_duplicate tensor(0.1228, dtype=torch.float64) tensor(-7.3652, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7577, dtype=torch.float64) delta_t tensor(0.4083, dtype=torch.float64)
13 gae_duplicate tensor(0.0002, dtype=torch.float64) tensor(-8.7960, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2382, dtype=torch.float64) delta_t tensor(0.3321, dtype=torch.float64)
12 gae_duplicate tensor(-0.7206, dtype=torch.float64) tensor(-7.8824, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1055, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
11 gae_duplicate tensor(-1.4841, dtype=torch.float64) tensor(-1.7604, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1135, dtype=torch.float64) delta_t tensor(0.3044, dtype=torch.float64)
10 gae_duplicate tensor(-1.7441, dtype=torch.float64) tensor(-5.9000, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1981, dtype=torch.float64) delta_t tensor(-0.6506, dtype=torch.float64)
9 gae_duplicate tensor(-3.5835, dtype=torch.float64) tensor(12.7298, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1169, dtype=torch.float64) delta_t tensor(-0.4119, dtype=torch.float64)
8 gae_duplicate tensor(-2.9174, dtype=torch.float64) tensor(9.3413, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1839, dtype=torch.float64) delta_t tensor(0.3906, dtype=torch.float64)
7 gae_duplicate tensor(-0.9048, dtype=torch.float64) tensor(-6.4795, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4494, dtype=torch.float64) delta_t tensor(0.0639, dtype=torch.float64)
6 gae_duplicate tensor(-1.7601, dtype=torch.float64) tensor(-1.3851, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7926, dtype=torch.float64) delta_t tensor(-0.9470, dtype=torch.float64)
5 gae_duplicate tensor(-4.3174, dtype=torch.float64) tensor(18.2044, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1176, dtype=torch.float64) delta_t tensor(0.1946, dtype=torch.float64)
4 gae_duplicate tensor(-0.2902, dtype=torch.float64) tensor(-1.8806, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2808, dtype=torch.float64) delta_t tensor(-0.1052, dtype=torch.float64)
3 gae_duplicate tensor(-0.2136, dtype=torch.float64) tensor(1.8625, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3456, dtype=torch.float64) delta_t tensor(-0.3041, dtype=torch.float64)
2 gae_duplicate tensor(-0.5406, dtype=torch.float64) tensor(6.4734, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-99.28235626220703
value loss:136.87957763671875
entropies:354.3413391113281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1510539054870605 seconds
19 rew tensor(0.8703, dtype=torch.float64) delta_t tensor(-0.0049, dtype=torch.float64)
19 gae_duplicate tensor(-0.0628, dtype=torch.float64) tensor(0.0798, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8142, dtype=torch.float64) delta_t tensor(0.0466, dtype=torch.float64)
18 gae_duplicate tensor(-0.0448, dtype=torch.float64) tensor(-0.8926, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7641, dtype=torch.float64) delta_t tensor(0.0636, dtype=torch.float64)
17 gae_duplicate tensor(-0.0543, dtype=torch.float64) tensor(-1.5033, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6901, dtype=torch.float64) delta_t tensor(0.0276, dtype=torch.float64)
16 gae_duplicate tensor(-0.0224, dtype=torch.float64) tensor(-0.6564, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4442, dtype=torch.float64) delta_t tensor(0.0447, dtype=torch.float64)
15 gae_duplicate tensor(-1.0723, dtype=torch.float64) tensor(-1.1290, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4639, dtype=torch.float64) delta_t tensor(0.1538, dtype=torch.float64)
14 gae_duplicate tensor(-1.1664, dtype=torch.float64) tensor(-3.1154, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2984, dtype=torch.float64) delta_t tensor(0.3256, dtype=torch.float64)
13 gae_duplicate tensor(-1.0751, dtype=torch.float64) tensor(-6.0967, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4489, dtype=torch.float64) delta_t tensor(0.3867, dtype=torch.float64)
12 gae_duplicate tensor(-0.3195, dtype=torch.float64) tensor(-8.6450, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3959, dtype=torch.float64) delta_t tensor(0.0705, dtype=torch.float64)
11 gae_duplicate tensor(-0.2782, dtype=torch.float64) tensor(-2.2610, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0766, dtype=torch.float64) delta_t tensor(0.3765, dtype=torch.float64)
10 gae_duplicate tensor(-0.8610, dtype=torch.float64) tensor(-7.6711, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.6058, dtype=torch.float64) delta_t tensor(-0.6902, dtype=torch.float64)
9 gae_duplicate tensor(-2.2152, dtype=torch.float64) tensor(14.3257, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5928, dtype=torch.float64) delta_t tensor(-0.0214, dtype=torch.float64)
8 gae_duplicate tensor(-2.5930, dtype=torch.float64) tensor(0.9161, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1455, dtype=torch.float64) delta_t tensor(0.7640, dtype=torch.float64)
7 gae_duplicate tensor(0.0259, dtype=torch.float64) tensor(-15.0864, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1781, dtype=torch.float64) delta_t tensor(0.6776, dtype=torch.float64)
6 gae_duplicate tensor(0.5842, dtype=torch.float64) tensor(-14.3980, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2005, dtype=torch.float64) delta_t tensor(0.0591, dtype=torch.float64)
5 gae_duplicate tensor(-0.0663, dtype=torch.float64) tensor(-2.7336, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2529, dtype=torch.float64) delta_t tensor(0.0867, dtype=torch.float64)
4 gae_duplicate tensor(-0.5670, dtype=torch.float64) tensor(-2.1059, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0342, dtype=torch.float64) delta_t tensor(0.1046, dtype=torch.float64)
3 gae_duplicate tensor(0.0182, dtype=torch.float64) tensor(-2.3345, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1805, dtype=torch.float64) delta_t tensor(-0.0248, dtype=torch.float64)
2 gae_duplicate tensor(-0.3845, dtype=torch.float64) tensor(0.0923, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2778.028564453125
value loss:74.01746368408203
entropies:353.9718017578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.698160886764526 seconds
19 rew tensor(0.8788, dtype=torch.float64) delta_t tensor(0.0053, dtype=torch.float64)
19 gae_duplicate tensor(-0.0262, dtype=torch.float64) tensor(-0.1186, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7876, dtype=torch.float64) delta_t tensor(0.0475, dtype=torch.float64)
18 gae_duplicate tensor(-0.0415, dtype=torch.float64) tensor(-1.0006, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8232, dtype=torch.float64) delta_t tensor(0.0548, dtype=torch.float64)
17 gae_duplicate tensor(0.0253, dtype=torch.float64) tensor(-1.1463, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6374, dtype=torch.float64) delta_t tensor(0.0764, dtype=torch.float64)
16 gae_duplicate tensor(-0.0782, dtype=torch.float64) tensor(-1.6307, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6855, dtype=torch.float64) delta_t tensor(0.0768, dtype=torch.float64)
15 gae_duplicate tensor(-0.0098, dtype=torch.float64) tensor(-1.5887, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4990, dtype=torch.float64) delta_t tensor(0.4085, dtype=torch.float64)
14 gae_duplicate tensor(0.0850, dtype=torch.float64) tensor(-8.4287, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6985, dtype=torch.float64) delta_t tensor(0.3768, dtype=torch.float64)
13 gae_duplicate tensor(-0.0372, dtype=torch.float64) tensor(-7.7398, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0244, dtype=torch.float64) delta_t tensor(0.2045, dtype=torch.float64)
12 gae_duplicate tensor(-0.7712, dtype=torch.float64) tensor(-4.5978, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0159, dtype=torch.float64) delta_t tensor(0.0558, dtype=torch.float64)
11 gae_duplicate tensor(-1.3322, dtype=torch.float64) tensor(-1.9461, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3816, dtype=torch.float64) delta_t tensor(0.2269, dtype=torch.float64)
10 gae_duplicate tensor(-1.2068, dtype=torch.float64) tensor(-4.5662, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5085, dtype=torch.float64) delta_t tensor(-1.1273, dtype=torch.float64)
9 gae_duplicate tensor(-3.6073, dtype=torch.float64) tensor(21.5860, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8599, dtype=torch.float64) delta_t tensor(-0.0008, dtype=torch.float64)
8 gae_duplicate tensor(-2.2493, dtype=torch.float64) tensor(2.0791, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1085, dtype=torch.float64) delta_t tensor(0.2687, dtype=torch.float64)
7 gae_duplicate tensor(-2.4831, dtype=torch.float64) tensor(-4.8160, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1062, dtype=torch.float64) delta_t tensor(0.7463, dtype=torch.float64)
6 gae_duplicate tensor(0.3439, dtype=torch.float64) tensor(-14.9804, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2899, dtype=torch.float64) delta_t tensor(0.0441, dtype=torch.float64)
5 gae_duplicate tensor(-0.1162, dtype=torch.float64) tensor(-2.2912, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0877, dtype=torch.float64) delta_t tensor(0.1635, dtype=torch.float64)
4 gae_duplicate tensor(-0.0979, dtype=torch.float64) tensor(-3.4207, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4108, dtype=torch.float64) delta_t tensor(-0.1289, dtype=torch.float64)
3 gae_duplicate tensor(-0.2296, dtype=torch.float64) tensor(2.0878, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4589, dtype=torch.float64) delta_t tensor(-0.1511, dtype=torch.float64)
2 gae_duplicate tensor(-0.3553, dtype=torch.float64) tensor(3.1240, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1491.880615234375
value loss:92.9156494140625
entropies:353.51898193359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.740386962890625 seconds
19 rew tensor(0.8781, dtype=torch.float64) delta_t tensor(-0.0421, dtype=torch.float64)
19 gae_duplicate tensor(-0.0789, dtype=torch.float64) tensor(0.7782, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8593, dtype=torch.float64) delta_t tensor(0.0510, dtype=torch.float64)
18 gae_duplicate tensor(0.0096, dtype=torch.float64) tensor(-0.8666, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7948, dtype=torch.float64) delta_t tensor(-0.0110, dtype=torch.float64)
17 gae_duplicate tensor(-0.1038, dtype=torch.float64) tensor(0.1192, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7554, dtype=torch.float64) delta_t tensor(0.0183, dtype=torch.float64)
16 gae_duplicate tensor(-0.0769, dtype=torch.float64) tensor(-0.3168, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7363, dtype=torch.float64) delta_t tensor(0.0484, dtype=torch.float64)
15 gae_duplicate tensor(-0.1066, dtype=torch.float64) tensor(-1.0329, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6499, dtype=torch.float64) delta_t tensor(0.2482, dtype=torch.float64)
14 gae_duplicate tensor(0.1072, dtype=torch.float64) tensor(-5.1696, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5893, dtype=torch.float64) delta_t tensor(0.3014, dtype=torch.float64)
13 gae_duplicate tensor(0.0752, dtype=torch.float64) tensor(-6.3545, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4821, dtype=torch.float64) delta_t tensor(0.4433, dtype=torch.float64)
12 gae_duplicate tensor(0.3267, dtype=torch.float64) tensor(-9.6829, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0808, dtype=torch.float64) delta_t tensor(0.3557, dtype=torch.float64)
11 gae_duplicate tensor(-0.5754, dtype=torch.float64) tensor(-8.0397, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2129, dtype=torch.float64) delta_t tensor(0.1459, dtype=torch.float64)
10 gae_duplicate tensor(-1.2849, dtype=torch.float64) tensor(-3.3151, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.2122, dtype=torch.float64) delta_t tensor(-1.4809, dtype=torch.float64)
9 gae_duplicate tensor(-4.2638, dtype=torch.float64) tensor(30.9556, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0683, dtype=torch.float64) delta_t tensor(-0.5350, dtype=torch.float64)
8 gae_duplicate tensor(-2.6702, dtype=torch.float64) tensor(12.5511, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1763, dtype=torch.float64) delta_t tensor(0.5808, dtype=torch.float64)
7 gae_duplicate tensor(-0.1230, dtype=torch.float64) tensor(-10.1208, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1368, dtype=torch.float64) delta_t tensor(0.6217, dtype=torch.float64)
6 gae_duplicate tensor(0.5858, dtype=torch.float64) tensor(-13.2128, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0349, dtype=torch.float64) delta_t tensor(0.0516, dtype=torch.float64)
5 gae_duplicate tensor(-0.0868, dtype=torch.float64) tensor(-2.3963, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2505, dtype=torch.float64) delta_t tensor(0.0160, dtype=torch.float64)
4 gae_duplicate tensor(-0.0597, dtype=torch.float64) tensor(-0.5925, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1160, dtype=torch.float64) delta_t tensor(-0.0770, dtype=torch.float64)
3 gae_duplicate tensor(-0.2018, dtype=torch.float64) tensor(1.5187, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2659, dtype=torch.float64) delta_t tensor(-0.1089, dtype=torch.float64)
2 gae_duplicate tensor(-0.3306, dtype=torch.float64) tensor(2.4711, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:590.8436889648438
value loss:94.42469024658203
entropies:352.9759216308594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.449173927307129 seconds
19 rew tensor(0.8415, dtype=torch.float64) delta_t tensor(-0.0745, dtype=torch.float64)
19 gae_duplicate tensor(-0.1764, dtype=torch.float64) tensor(1.5688, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7860, dtype=torch.float64) delta_t tensor(-0.0305, dtype=torch.float64)
18 gae_duplicate tensor(-0.1320, dtype=torch.float64) tensor(0.7291, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7278, dtype=torch.float64) delta_t tensor(-0.0587, dtype=torch.float64)
17 gae_duplicate tensor(-0.1579, dtype=torch.float64) tensor(1.3031, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6913, dtype=torch.float64) delta_t tensor(-0.0099, dtype=torch.float64)
16 gae_duplicate tensor(-0.0544, dtype=torch.float64) tensor(0.3396, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6075, dtype=torch.float64) delta_t tensor(-0.0013, dtype=torch.float64)
15 gae_duplicate tensor(-0.0609, dtype=torch.float64) tensor(0.1011, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2824, dtype=torch.float64) delta_t tensor(-0.1985, dtype=torch.float64)
14 gae_duplicate tensor(-0.9120, dtype=torch.float64) tensor(3.4607, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6470, dtype=torch.float64) delta_t tensor(0.2427, dtype=torch.float64)
13 gae_duplicate tensor(0.0260, dtype=torch.float64) tensor(-4.3419, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5864, dtype=torch.float64) delta_t tensor(0.3096, dtype=torch.float64)
12 gae_duplicate tensor(-0.0565, dtype=torch.float64) tensor(-6.1023, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1196, dtype=torch.float64) delta_t tensor(0.0251, dtype=torch.float64)
11 gae_duplicate tensor(-0.7826, dtype=torch.float64) tensor(-1.5302, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3500, dtype=torch.float64) delta_t tensor(-0.1704, dtype=torch.float64)
10 gae_duplicate tensor(-0.8313, dtype=torch.float64) tensor(3.0753, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.0869, dtype=torch.float64) delta_t tensor(-1.3883, dtype=torch.float64)
9 gae_duplicate tensor(-3.3475, dtype=torch.float64) tensor(26.1785, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8919, dtype=torch.float64) delta_t tensor(-0.5629, dtype=torch.float64)
8 gae_duplicate tensor(-3.9452, dtype=torch.float64) tensor(13.2505, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5771, dtype=torch.float64) delta_t tensor(0.2613, dtype=torch.float64)
7 gae_duplicate tensor(-1.1639, dtype=torch.float64) tensor(-3.7004, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4254, dtype=torch.float64) delta_t tensor(-0.2258, dtype=torch.float64)
6 gae_duplicate tensor(-2.1537, dtype=torch.float64) tensor(4.7746, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4697, dtype=torch.float64) delta_t tensor(-0.3495, dtype=torch.float64)
5 gae_duplicate tensor(-2.4255, dtype=torch.float64) tensor(7.9021, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4022, dtype=torch.float64) delta_t tensor(0.0409, dtype=torch.float64)
4 gae_duplicate tensor(-0.1779, dtype=torch.float64) tensor(-0.1463, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0476, dtype=torch.float64) delta_t tensor(-0.1833, dtype=torch.float64)
3 gae_duplicate tensor(-0.4583, dtype=torch.float64) tensor(3.6242, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1245, dtype=torch.float64) delta_t tensor(-0.1455, dtype=torch.float64)
2 gae_duplicate tensor(-0.4294, dtype=torch.float64) tensor(3.2691, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2997.89013671875
value loss:111.66815185546875
entropies:352.2201843261719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3945.8606)
ToM Target loss= tensor(3636.1494)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.904381036758423 seconds
19 rew tensor(0.8788, dtype=torch.float64) delta_t tensor(-0.0630, dtype=torch.float64)
19 gae_duplicate tensor(-0.0984, dtype=torch.float64) tensor(1.3326, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(-0.0208, dtype=torch.float64)
18 gae_duplicate tensor(-0.1455, dtype=torch.float64) tensor(0.4967, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(-0.0045, dtype=torch.float64)
17 gae_duplicate tensor(-0.0895, dtype=torch.float64) tensor(0.1980, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7115, dtype=torch.float64) delta_t tensor(0.0016, dtype=torch.float64)
16 gae_duplicate tensor(-0.0421, dtype=torch.float64) tensor(-0.0386, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4663, dtype=torch.float64) delta_t tensor(-0.1915, dtype=torch.float64)
15 gae_duplicate tensor(-1.0920, dtype=torch.float64) tensor(3.3464, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5309, dtype=torch.float64) delta_t tensor(0.1973, dtype=torch.float64)
14 gae_duplicate tensor(-0.1090, dtype=torch.float64) tensor(-3.2594, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5992, dtype=torch.float64) delta_t tensor(0.3246, dtype=torch.float64)
13 gae_duplicate tensor(0.1951, dtype=torch.float64) tensor(-6.7007, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4739, dtype=torch.float64) delta_t tensor(0.3449, dtype=torch.float64)
12 gae_duplicate tensor(0.1696, dtype=torch.float64) tensor(-7.1788, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4906, dtype=torch.float64) delta_t tensor(-0.3583, dtype=torch.float64)
11 gae_duplicate tensor(-1.5874, dtype=torch.float64) tensor(6.2214, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0358, dtype=torch.float64) delta_t tensor(0.1879, dtype=torch.float64)
10 gae_duplicate tensor(-0.5284, dtype=torch.float64) tensor(-2.7879, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5089, dtype=torch.float64) delta_t tensor(-0.8913, dtype=torch.float64)
9 gae_duplicate tensor(-2.5693, dtype=torch.float64) tensor(15.6006, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2543, dtype=torch.float64) delta_t tensor(-0.6879, dtype=torch.float64)
8 gae_duplicate tensor(-2.4621, dtype=torch.float64) tensor(14.5091, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2833, dtype=torch.float64) delta_t tensor(0.2948, dtype=torch.float64)
7 gae_duplicate tensor(-1.1544, dtype=torch.float64) tensor(-3.4266, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2163, dtype=torch.float64) delta_t tensor(0.2189, dtype=torch.float64)
6 gae_duplicate tensor(-0.8966, dtype=torch.float64) tensor(-4.3972, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0259, dtype=torch.float64) delta_t tensor(-0.0604, dtype=torch.float64)
5 gae_duplicate tensor(-0.2206, dtype=torch.float64) tensor(0.7721, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2333, dtype=torch.float64) delta_t tensor(0.0025, dtype=torch.float64)
4 gae_duplicate tensor(-0.1762, dtype=torch.float64) tensor(0.1053, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0995, dtype=torch.float64) delta_t tensor(-0.1065, dtype=torch.float64)
3 gae_duplicate tensor(-0.4888, dtype=torch.float64) tensor(2.2312, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2618, dtype=torch.float64) delta_t tensor(-0.1333, dtype=torch.float64)
2 gae_duplicate tensor(-0.4598, dtype=torch.float64) tensor(2.9044, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1171.093017578125
value loss:67.36184692382812
entropies:351.66693115234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.912785768508911 seconds
19 rew tensor(0.8773, dtype=torch.float64) delta_t tensor(-0.0715, dtype=torch.float64)
19 gae_duplicate tensor(-0.1089, dtype=torch.float64) tensor(1.3937, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8491, dtype=torch.float64) delta_t tensor(-0.0074, dtype=torch.float64)
18 gae_duplicate tensor(-0.1388, dtype=torch.float64) tensor(0.3831, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8206, dtype=torch.float64) delta_t tensor(0.0114, dtype=torch.float64)
17 gae_duplicate tensor(-0.0932, dtype=torch.float64) tensor(-0.1929, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7447, dtype=torch.float64) delta_t tensor(-0.0174, dtype=torch.float64)
16 gae_duplicate tensor(-0.0461, dtype=torch.float64) tensor(0.3250, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6510, dtype=torch.float64) delta_t tensor(-0.0268, dtype=torch.float64)
15 gae_duplicate tensor(-0.1330, dtype=torch.float64) tensor(0.6835, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4308, dtype=torch.float64) delta_t tensor(-0.0616, dtype=torch.float64)
14 gae_duplicate tensor(-0.9546, dtype=torch.float64) tensor(0.9454, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5687, dtype=torch.float64) delta_t tensor(0.1857, dtype=torch.float64)
13 gae_duplicate tensor(-0.0107, dtype=torch.float64) tensor(-3.9404, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5653, dtype=torch.float64) delta_t tensor(0.2574, dtype=torch.float64)
12 gae_duplicate tensor(0.1193, dtype=torch.float64) tensor(-5.1052, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1346, dtype=torch.float64) delta_t tensor(-0.1272, dtype=torch.float64)
11 gae_duplicate tensor(-1.0348, dtype=torch.float64) tensor(1.9974, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0258, dtype=torch.float64) delta_t tensor(0.1228, dtype=torch.float64)
10 gae_duplicate tensor(-0.7151, dtype=torch.float64) tensor(-1.9522, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.4280, dtype=torch.float64) delta_t tensor(-1.8373, dtype=torch.float64)
9 gae_duplicate tensor(-4.1866, dtype=torch.float64) tensor(34.5222, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0338, dtype=torch.float64) delta_t tensor(-0.5977, dtype=torch.float64)
8 gae_duplicate tensor(-4.0323, dtype=torch.float64) tensor(16.0828, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0785, dtype=torch.float64) delta_t tensor(0.6877, dtype=torch.float64)
7 gae_duplicate tensor(0.1152, dtype=torch.float64) tensor(-11.9555, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2307, dtype=torch.float64) delta_t tensor(0.2335, dtype=torch.float64)
6 gae_duplicate tensor(-1.7612, dtype=torch.float64) tensor(-6.6384, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0315, dtype=torch.float64) delta_t tensor(-0.0155, dtype=torch.float64)
5 gae_duplicate tensor(-0.3130, dtype=torch.float64) tensor(-0.2694, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1419, dtype=torch.float64) delta_t tensor(0.0065, dtype=torch.float64)
4 gae_duplicate tensor(-0.3285, dtype=torch.float64) tensor(-0.0405, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2247, dtype=torch.float64) delta_t tensor(-0.1010, dtype=torch.float64)
3 gae_duplicate tensor(-0.3762, dtype=torch.float64) tensor(2.0619, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3471, dtype=torch.float64) delta_t tensor(-0.0686, dtype=torch.float64)
2 gae_duplicate tensor(-0.5147, dtype=torch.float64) tensor(1.4742, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1702.6553955078125
value loss:113.70399475097656
entropies:351.2044372558594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8820319175720215 seconds
19 rew tensor(0.8577, dtype=torch.float64) delta_t tensor(-0.0678, dtype=torch.float64)
19 gae_duplicate tensor(-0.1583, dtype=torch.float64) tensor(1.3093, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8191, dtype=torch.float64) delta_t tensor(-0.0036, dtype=torch.float64)
18 gae_duplicate tensor(-0.1040, dtype=torch.float64) tensor(0.2492, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7928, dtype=torch.float64) delta_t tensor(0.0598, dtype=torch.float64)
17 gae_duplicate tensor(-0.0484, dtype=torch.float64) tensor(-1.2092, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6492, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
16 gae_duplicate tensor(-0.1243, dtype=torch.float64) tensor(0.2846, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5614, dtype=torch.float64) delta_t tensor(0.0054, dtype=torch.float64)
15 gae_duplicate tensor(-0.1865, dtype=torch.float64) tensor(0.0284, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6042, dtype=torch.float64) delta_t tensor(0.3374, dtype=torch.float64)
14 gae_duplicate tensor(0.0346, dtype=torch.float64) tensor(-7.0128, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5700, dtype=torch.float64) delta_t tensor(0.3238, dtype=torch.float64)
13 gae_duplicate tensor(0.1270, dtype=torch.float64) tensor(-6.6690, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3108, dtype=torch.float64) delta_t tensor(0.1675, dtype=torch.float64)
12 gae_duplicate tensor(-0.7272, dtype=torch.float64) tensor(-4.0808, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0819, dtype=torch.float64) delta_t tensor(0.2192, dtype=torch.float64)
11 gae_duplicate tensor(-0.5742, dtype=torch.float64) tensor(-4.0721, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3006, dtype=torch.float64) delta_t tensor(-0.0473, dtype=torch.float64)
10 gae_duplicate tensor(-0.7127, dtype=torch.float64) tensor(0.7865, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.1289, dtype=torch.float64) delta_t tensor(-1.4135, dtype=torch.float64)
9 gae_duplicate tensor(-4.0555, dtype=torch.float64) tensor(26.4110, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0300, dtype=torch.float64) delta_t tensor(-0.5395, dtype=torch.float64)
8 gae_duplicate tensor(-2.5660, dtype=torch.float64) tensor(14.1106, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6546, dtype=torch.float64) delta_t tensor(0.1606, dtype=torch.float64)
7 gae_duplicate tensor(-1.3432, dtype=torch.float64) tensor(-2.6928, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3115, dtype=torch.float64) delta_t tensor(0.1376, dtype=torch.float64)
6 gae_duplicate tensor(-2.5942, dtype=torch.float64) tensor(-2.1841, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3123, dtype=torch.float64) delta_t tensor(-0.1862, dtype=torch.float64)
5 gae_duplicate tensor(-1.5591, dtype=torch.float64) tensor(2.6162, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3438, dtype=torch.float64) delta_t tensor(0.1261, dtype=torch.float64)
4 gae_duplicate tensor(-0.0861, dtype=torch.float64) tensor(-2.1845, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0272, dtype=torch.float64) delta_t tensor(-0.0717, dtype=torch.float64)
3 gae_duplicate tensor(-0.2163, dtype=torch.float64) tensor(0.8176, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1363, dtype=torch.float64) delta_t tensor(-0.1062, dtype=torch.float64)
2 gae_duplicate tensor(-0.3740, dtype=torch.float64) tensor(2.1631, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1103.03662109375
value loss:103.89525604248047
entropies:351.073974609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.83844780921936 seconds
19 rew tensor(0.8200, dtype=torch.float64) delta_t tensor(-0.0837, dtype=torch.float64)
19 gae_duplicate tensor(-0.2553, dtype=torch.float64) tensor(1.7954, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8671, dtype=torch.float64) delta_t tensor(0.0666, dtype=torch.float64)
18 gae_duplicate tensor(-0.0239, dtype=torch.float64) tensor(-1.1469, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7256, dtype=torch.float64) delta_t tensor(-0.0418, dtype=torch.float64)
17 gae_duplicate tensor(-0.1634, dtype=torch.float64) tensor(0.7554, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5905, dtype=torch.float64) delta_t tensor(-0.0108, dtype=torch.float64)
16 gae_duplicate tensor(-0.1194, dtype=torch.float64) tensor(0.3386, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7449, dtype=torch.float64) delta_t tensor(0.0469, dtype=torch.float64)
15 gae_duplicate tensor(-0.0556, dtype=torch.float64) tensor(-0.8466, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1043, dtype=torch.float64) delta_t tensor(-0.2243, dtype=torch.float64)
14 gae_duplicate tensor(-0.9707, dtype=torch.float64) tensor(3.6429, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4448, dtype=torch.float64) delta_t tensor(0.0070, dtype=torch.float64)
13 gae_duplicate tensor(-0.9614, dtype=torch.float64) tensor(0.1070, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1818, dtype=torch.float64) delta_t tensor(0.2196, dtype=torch.float64)
12 gae_duplicate tensor(-0.5932, dtype=torch.float64) tensor(-4.4303, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4402, dtype=torch.float64) delta_t tensor(0.3604, dtype=torch.float64)
11 gae_duplicate tensor(-0.5614, dtype=torch.float64) tensor(-6.7700, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4853, dtype=torch.float64) delta_t tensor(-0.1960, dtype=torch.float64)
10 gae_duplicate tensor(-1.9325, dtype=torch.float64) tensor(3.2457, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.4285, dtype=torch.float64) delta_t tensor(-1.1100, dtype=torch.float64)
9 gae_duplicate tensor(-4.0719, dtype=torch.float64) tensor(23.8787, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9077, dtype=torch.float64) delta_t tensor(-0.2784, dtype=torch.float64)
8 gae_duplicate tensor(-2.7055, dtype=torch.float64) tensor(6.8063, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4599, dtype=torch.float64) delta_t tensor(0.8217, dtype=torch.float64)
7 gae_duplicate tensor(0.6375, dtype=torch.float64) tensor(-15.0385, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3122, dtype=torch.float64) delta_t tensor(0.3463, dtype=torch.float64)
6 gae_duplicate tensor(-1.2419, dtype=torch.float64) tensor(-7.8010, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3289, dtype=torch.float64) delta_t tensor(0.1062, dtype=torch.float64)
5 gae_duplicate tensor(0.0091, dtype=torch.float64) tensor(-2.8346, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0083, dtype=torch.float64) delta_t tensor(0.1555, dtype=torch.float64)
4 gae_duplicate tensor(-0.0715, dtype=torch.float64) tensor(-3.2269, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3463, dtype=torch.float64) delta_t tensor(-0.0298, dtype=torch.float64)
3 gae_duplicate tensor(-0.2921, dtype=torch.float64) tensor(0.2037, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4298, dtype=torch.float64) delta_t tensor(-0.1327, dtype=torch.float64)
2 gae_duplicate tensor(-0.3446, dtype=torch.float64) tensor(2.6701, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-167.6600341796875
value loss:95.09962463378906
entropies:351.15673828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.259976148605347 seconds
19 rew tensor(0.8768, dtype=torch.float64) delta_t tensor(-0.0601, dtype=torch.float64)
19 gae_duplicate tensor(-0.1070, dtype=torch.float64) tensor(1.2991, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8680, dtype=torch.float64) delta_t tensor(0.0416, dtype=torch.float64)
18 gae_duplicate tensor(-0.0650, dtype=torch.float64) tensor(-0.7777, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8488, dtype=torch.float64) delta_t tensor(0.0273, dtype=torch.float64)
17 gae_duplicate tensor(-0.0315, dtype=torch.float64) tensor(-0.6619, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7038, dtype=torch.float64) delta_t tensor(-0.0415, dtype=torch.float64)
16 gae_duplicate tensor(-0.1120, dtype=torch.float64) tensor(0.8114, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7372, dtype=torch.float64) delta_t tensor(0.0086, dtype=torch.float64)
15 gae_duplicate tensor(-0.1835, dtype=torch.float64) tensor(-0.1752, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5630, dtype=torch.float64) delta_t tensor(0.1073, dtype=torch.float64)
14 gae_duplicate tensor(-0.1158, dtype=torch.float64) tensor(-1.9248, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6142, dtype=torch.float64) delta_t tensor(0.1662, dtype=torch.float64)
13 gae_duplicate tensor(-0.1689, dtype=torch.float64) tensor(-3.4554, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4223, dtype=torch.float64) delta_t tensor(0.4366, dtype=torch.float64)
12 gae_duplicate tensor(0.2226, dtype=torch.float64) tensor(-8.6458, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6750, dtype=torch.float64) delta_t tensor(-0.5749, dtype=torch.float64)
11 gae_duplicate tensor(-1.7820, dtype=torch.float64) tensor(11.3390, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.8509, dtype=torch.float64) delta_t tensor(-0.4108, dtype=torch.float64)
10 gae_duplicate tensor(-1.3678, dtype=torch.float64) tensor(9.0126, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0526, dtype=torch.float64) delta_t tensor(-0.6075, dtype=torch.float64)
9 gae_duplicate tensor(-2.7644, dtype=torch.float64) tensor(12.0343, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4816, dtype=torch.float64) delta_t tensor(0.1609, dtype=torch.float64)
8 gae_duplicate tensor(-1.6412, dtype=torch.float64) tensor(-2.1103, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2614, dtype=torch.float64) delta_t tensor(0.3039, dtype=torch.float64)
7 gae_duplicate tensor(-0.9367, dtype=torch.float64) tensor(-6.3296, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4074, dtype=torch.float64) delta_t tensor(0.2485, dtype=torch.float64)
6 gae_duplicate tensor(-1.8088, dtype=torch.float64) tensor(-5.0568, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0735, dtype=torch.float64) delta_t tensor(-0.0172, dtype=torch.float64)
5 gae_duplicate tensor(-0.2227, dtype=torch.float64) tensor(-0.1617, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0332, dtype=torch.float64) delta_t tensor(0.0200, dtype=torch.float64)
4 gae_duplicate tensor(-0.1238, dtype=torch.float64) tensor(-0.5204, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2571, dtype=torch.float64) delta_t tensor(0.0036, dtype=torch.float64)
3 gae_duplicate tensor(-0.2037, dtype=torch.float64) tensor(-0.2594, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4459, dtype=torch.float64) delta_t tensor(-0.2172, dtype=torch.float64)
2 gae_duplicate tensor(-0.3575, dtype=torch.float64) tensor(4.0791, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-553.591796875
value loss:65.38105773925781
entropies:351.0387268066406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3940.5483)
ToM Target loss= tensor(3670.7800)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.074034214019775 seconds
19 rew tensor(0.8395, dtype=torch.float64) delta_t tensor(-0.0635, dtype=torch.float64)
19 gae_duplicate tensor(-0.1259, dtype=torch.float64) tensor(1.2554, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8135, dtype=torch.float64) delta_t tensor(0.0303, dtype=torch.float64)
18 gae_duplicate tensor(-0.0765, dtype=torch.float64) tensor(-0.4188, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7653, dtype=torch.float64) delta_t tensor(-0.0305, dtype=torch.float64)
17 gae_duplicate tensor(-0.1315, dtype=torch.float64) tensor(0.5388, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6563, dtype=torch.float64) delta_t tensor(0.0059, dtype=torch.float64)
16 gae_duplicate tensor(-0.0823, dtype=torch.float64) tensor(-0.0988, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6838, dtype=torch.float64) delta_t tensor(0.0104, dtype=torch.float64)
15 gae_duplicate tensor(-0.0694, dtype=torch.float64) tensor(-0.2213, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4586, dtype=torch.float64) delta_t tensor(0.1789, dtype=torch.float64)
14 gae_duplicate tensor(-0.0783, dtype=torch.float64) tensor(-3.6721, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4810, dtype=torch.float64) delta_t tensor(0.0995, dtype=torch.float64)
13 gae_duplicate tensor(-0.8084, dtype=torch.float64) tensor(-2.6825, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3830, dtype=torch.float64) delta_t tensor(-0.3617, dtype=torch.float64)
12 gae_duplicate tensor(-0.8035, dtype=torch.float64) tensor(7.1998, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1302, dtype=torch.float64) delta_t tensor(0.1795, dtype=torch.float64)
11 gae_duplicate tensor(-0.8172, dtype=torch.float64) tensor(-2.7782, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6562, dtype=torch.float64) delta_t tensor(-0.3278, dtype=torch.float64)
10 gae_duplicate tensor(-2.1838, dtype=torch.float64) tensor(5.2421, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9613, dtype=torch.float64) delta_t tensor(-0.6452, dtype=torch.float64)
9 gae_duplicate tensor(-2.2074, dtype=torch.float64) tensor(13.1773, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3347, dtype=torch.float64) delta_t tensor(-0.5901, dtype=torch.float64)
8 gae_duplicate tensor(-2.7454, dtype=torch.float64) tensor(12.1779, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0753, dtype=torch.float64) delta_t tensor(0.4741, dtype=torch.float64)
7 gae_duplicate tensor(-1.5605, dtype=torch.float64) tensor(-8.5198, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1138, dtype=torch.float64) delta_t tensor(0.8095, dtype=torch.float64)
6 gae_duplicate tensor(0.6658, dtype=torch.float64) tensor(-15.8860, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1470, dtype=torch.float64) delta_t tensor(-0.0616, dtype=torch.float64)
5 gae_duplicate tensor(-0.3751, dtype=torch.float64) tensor(-0.6076, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0840, dtype=torch.float64) delta_t tensor(0.0633, dtype=torch.float64)
4 gae_duplicate tensor(-0.2665, dtype=torch.float64) tensor(-1.1403, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3148, dtype=torch.float64) delta_t tensor(-0.0947, dtype=torch.float64)
3 gae_duplicate tensor(-0.4100, dtype=torch.float64) tensor(1.8052, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4792, dtype=torch.float64) delta_t tensor(-0.1370, dtype=torch.float64)
2 gae_duplicate tensor(-0.4596, dtype=torch.float64) tensor(2.7559, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-533.5773315429688
value loss:71.84213256835938
entropies:350.85040283203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.937486171722412 seconds
19 rew tensor(0.8008, dtype=torch.float64) delta_t tensor(-0.0788, dtype=torch.float64)
19 gae_duplicate tensor(-0.1614, dtype=torch.float64) tensor(1.5858, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7641, dtype=torch.float64) delta_t tensor(-0.0097, dtype=torch.float64)
18 gae_duplicate tensor(-0.1358, dtype=torch.float64) tensor(0.4459, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7732, dtype=torch.float64) delta_t tensor(0.0198, dtype=torch.float64)
17 gae_duplicate tensor(-0.0905, dtype=torch.float64) tensor(-0.2059, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7367, dtype=torch.float64) delta_t tensor(0.0675, dtype=torch.float64)
16 gae_duplicate tensor(-0.0425, dtype=torch.float64) tensor(-1.3181, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6232, dtype=torch.float64) delta_t tensor(-0.0058, dtype=torch.float64)
15 gae_duplicate tensor(-0.1341, dtype=torch.float64) tensor(0.1099, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5666, dtype=torch.float64) delta_t tensor(0.1579, dtype=torch.float64)
14 gae_duplicate tensor(-0.0953, dtype=torch.float64) tensor(-3.4503, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6795, dtype=torch.float64) delta_t tensor(0.2645, dtype=torch.float64)
13 gae_duplicate tensor(0.1886, dtype=torch.float64) tensor(-5.3184, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5397, dtype=torch.float64) delta_t tensor(0.2463, dtype=torch.float64)
12 gae_duplicate tensor(0.1279, dtype=torch.float64) tensor(-5.3052, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4349, dtype=torch.float64) delta_t tensor(-0.5181, dtype=torch.float64)
11 gae_duplicate tensor(-0.9386, dtype=torch.float64) tensor(8.4410, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2913, dtype=torch.float64) delta_t tensor(0.2282, dtype=torch.float64)
10 gae_duplicate tensor(-0.9186, dtype=torch.float64) tensor(-3.4434, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7644, dtype=torch.float64) delta_t tensor(-1.2941, dtype=torch.float64)
9 gae_duplicate tensor(-4.2370, dtype=torch.float64) tensor(25.9269, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.2387, dtype=torch.float64) delta_t tensor(-1.6720, dtype=torch.float64)
8 gae_duplicate tensor(-3.3239, dtype=torch.float64) tensor(33.7528, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0640, dtype=torch.float64) delta_t tensor(-0.5635, dtype=torch.float64)
7 gae_duplicate tensor(-2.7407, dtype=torch.float64) tensor(14.7912, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6115, dtype=torch.float64) delta_t tensor(-0.2353, dtype=torch.float64)
6 gae_duplicate tensor(-3.1170, dtype=torch.float64) tensor(8.0904, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1746, dtype=torch.float64) delta_t tensor(-0.2990, dtype=torch.float64)
5 gae_duplicate tensor(-2.4443, dtype=torch.float64) tensor(5.4048, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2097, dtype=torch.float64) delta_t tensor(0.1857, dtype=torch.float64)
4 gae_duplicate tensor(-0.7608, dtype=torch.float64) tensor(-3.2454, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1314, dtype=torch.float64) delta_t tensor(-0.0901, dtype=torch.float64)
3 gae_duplicate tensor(-0.2554, dtype=torch.float64) tensor(1.4949, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2376, dtype=torch.float64) delta_t tensor(-0.0428, dtype=torch.float64)
2 gae_duplicate tensor(-0.3443, dtype=torch.float64) tensor(0.9437, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4344.5693359375
value loss:133.9629669189453
entropies:350.9072265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8983659744262695 seconds
19 rew tensor(0.8772, dtype=torch.float64) delta_t tensor(0.0094, dtype=torch.float64)
19 gae_duplicate tensor(-0.0443, dtype=torch.float64) tensor(-0.1902, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8400, dtype=torch.float64) delta_t tensor(0.0600, dtype=torch.float64)
18 gae_duplicate tensor(-0.0659, dtype=torch.float64) tensor(-1.1314, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7383, dtype=torch.float64) delta_t tensor(0.0271, dtype=torch.float64)
17 gae_duplicate tensor(-0.1088, dtype=torch.float64) tensor(-0.5283, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7678, dtype=torch.float64) delta_t tensor(0.0529, dtype=torch.float64)
16 gae_duplicate tensor(-0.0388, dtype=torch.float64) tensor(-1.1012, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6740, dtype=torch.float64) delta_t tensor(0.1394, dtype=torch.float64)
15 gae_duplicate tensor(-0.0977, dtype=torch.float64) tensor(-2.7830, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5113, dtype=torch.float64) delta_t tensor(-0.0845, dtype=torch.float64)
14 gae_duplicate tensor(-0.9277, dtype=torch.float64) tensor(1.4139, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4426, dtype=torch.float64) delta_t tensor(0.3526, dtype=torch.float64)
13 gae_duplicate tensor(0.1828, dtype=torch.float64) tensor(-6.6238, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5371, dtype=torch.float64) delta_t tensor(0.1973, dtype=torch.float64)
12 gae_duplicate tensor(-0.5037, dtype=torch.float64) tensor(-4.7873, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2644, dtype=torch.float64) delta_t tensor(0.6269, dtype=torch.float64)
11 gae_duplicate tensor(0.0546, dtype=torch.float64) tensor(-12.7131, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3151, dtype=torch.float64) delta_t tensor(0.4646, dtype=torch.float64)
10 gae_duplicate tensor(-0.4447, dtype=torch.float64) tensor(-9.9871, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.9999, dtype=torch.float64) delta_t tensor(-0.7306, dtype=torch.float64)
9 gae_duplicate tensor(-2.1755, dtype=torch.float64) tensor(13.1560, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2245, dtype=torch.float64) delta_t tensor(0.0363, dtype=torch.float64)
8 gae_duplicate tensor(-1.7819, dtype=torch.float64) tensor(1.9677, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4662, dtype=torch.float64) delta_t tensor(-0.1597, dtype=torch.float64)
7 gae_duplicate tensor(-1.3601, dtype=torch.float64) tensor(2.2187, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9339, dtype=torch.float64) delta_t tensor(-0.6672, dtype=torch.float64)
6 gae_duplicate tensor(-2.0417, dtype=torch.float64) tensor(12.0362, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6461, dtype=torch.float64) delta_t tensor(-0.0597, dtype=torch.float64)
5 gae_duplicate tensor(-1.1006, dtype=torch.float64) tensor(1.9788, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5750, dtype=torch.float64) delta_t tensor(0.3451, dtype=torch.float64)
4 gae_duplicate tensor(0.1420, dtype=torch.float64) tensor(-6.3887, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3923, dtype=torch.float64) delta_t tensor(0.0445, dtype=torch.float64)
3 gae_duplicate tensor(-0.2238, dtype=torch.float64) tensor(-1.5273, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0692, dtype=torch.float64) delta_t tensor(0.0450, dtype=torch.float64)
2 gae_duplicate tensor(-0.1326, dtype=torch.float64) tensor(-1.0109, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:769.2791137695312
value loss:79.83480072021484
entropies:351.0255126953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6728739738464355 seconds
19 rew tensor(0.8315, dtype=torch.float64) delta_t tensor(-0.0021, dtype=torch.float64)
19 gae_duplicate tensor(-0.1000, dtype=torch.float64) tensor(0.0309, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8042, dtype=torch.float64) delta_t tensor(0.0390, dtype=torch.float64)
18 gae_duplicate tensor(-0.0744, dtype=torch.float64) tensor(-0.7632, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7096, dtype=torch.float64) delta_t tensor(0.0326, dtype=torch.float64)
17 gae_duplicate tensor(-0.0181, dtype=torch.float64) tensor(-0.6947, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6982, dtype=torch.float64) delta_t tensor(0.0359, dtype=torch.float64)
16 gae_duplicate tensor(-0.0162, dtype=torch.float64) tensor(-0.7683, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3921, dtype=torch.float64) delta_t tensor(-0.1625, dtype=torch.float64)
15 gae_duplicate tensor(-0.9932, dtype=torch.float64) tensor(2.9860, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6911, dtype=torch.float64) delta_t tensor(0.1982, dtype=torch.float64)
14 gae_duplicate tensor(0.0546, dtype=torch.float64) tensor(-3.9306, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3272, dtype=torch.float64) delta_t tensor(-0.0373, dtype=torch.float64)
13 gae_duplicate tensor(-1.1330, dtype=torch.float64) tensor(0.6640, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1634, dtype=torch.float64) delta_t tensor(0.0205, dtype=torch.float64)
12 gae_duplicate tensor(-1.1354, dtype=torch.float64) tensor(-0.4255, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1014, dtype=torch.float64) delta_t tensor(0.2041, dtype=torch.float64)
11 gae_duplicate tensor(-0.4957, dtype=torch.float64) tensor(-4.3594, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2086, dtype=torch.float64) delta_t tensor(-0.1622, dtype=torch.float64)
10 gae_duplicate tensor(-1.7497, dtype=torch.float64) tensor(3.3052, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8697, dtype=torch.float64) delta_t tensor(-0.3738, dtype=torch.float64)
9 gae_duplicate tensor(-2.1103, dtype=torch.float64) tensor(7.3231, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0652, dtype=torch.float64) delta_t tensor(-0.5223, dtype=torch.float64)
8 gae_duplicate tensor(-2.3122, dtype=torch.float64) tensor(10.6925, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1867, dtype=torch.float64) delta_t tensor(0.8059, dtype=torch.float64)
7 gae_duplicate tensor(-0.2172, dtype=torch.float64) tensor(-14.7937, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0166, dtype=torch.float64) delta_t tensor(0.6144, dtype=torch.float64)
6 gae_duplicate tensor(-1.3524, dtype=torch.float64) tensor(-12.2574, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2396, dtype=torch.float64) delta_t tensor(-0.2333, dtype=torch.float64)
5 gae_duplicate tensor(-2.3671, dtype=torch.float64) tensor(1.8708, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2767, dtype=torch.float64) delta_t tensor(0.3127, dtype=torch.float64)
4 gae_duplicate tensor(0.1367, dtype=torch.float64) tensor(-5.3747, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1374, dtype=torch.float64) delta_t tensor(0.0881, dtype=torch.float64)
3 gae_duplicate tensor(-0.0208, dtype=torch.float64) tensor(-2.3099, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3699, dtype=torch.float64) delta_t tensor(-0.0265, dtype=torch.float64)
2 gae_duplicate tensor(-0.1930, dtype=torch.float64) tensor(0.1554, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:912.2366333007812
value loss:81.5727767944336
entropies:351.2576599121094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.639263153076172 seconds
19 rew tensor(0.8479, dtype=torch.float64) delta_t tensor(0.0085, dtype=torch.float64)
19 gae_duplicate tensor(-0.1115, dtype=torch.float64) tensor(-0.1015, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8291, dtype=torch.float64) delta_t tensor(0.1076, dtype=torch.float64)
18 gae_duplicate tensor(0.0112, dtype=torch.float64) tensor(-2.2386, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8306, dtype=torch.float64) delta_t tensor(0.1319, dtype=torch.float64)
17 gae_duplicate tensor(0.0868, dtype=torch.float64) tensor(-2.7335, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7108, dtype=torch.float64) delta_t tensor(0.0997, dtype=torch.float64)
16 gae_duplicate tensor(0.0058, dtype=torch.float64) tensor(-2.1885, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7265, dtype=torch.float64) delta_t tensor(0.1559, dtype=torch.float64)
15 gae_duplicate tensor(-0.0206, dtype=torch.float64) tensor(-3.3168, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5714, dtype=torch.float64) delta_t tensor(0.3071, dtype=torch.float64)
14 gae_duplicate tensor(0.0790, dtype=torch.float64) tensor(-6.7071, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3730, dtype=torch.float64) delta_t tensor(0.1782, dtype=torch.float64)
13 gae_duplicate tensor(-0.8215, dtype=torch.float64) tensor(-3.7250, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1471, dtype=torch.float64) delta_t tensor(0.2874, dtype=torch.float64)
12 gae_duplicate tensor(-0.2786, dtype=torch.float64) tensor(-5.7160, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2637, dtype=torch.float64) delta_t tensor(0.6089, dtype=torch.float64)
11 gae_duplicate tensor(-0.4649, dtype=torch.float64) tensor(-13.1846, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0564, dtype=torch.float64) delta_t tensor(0.6969, dtype=torch.float64)
10 gae_duplicate tensor(-0.1114, dtype=torch.float64) tensor(-14.5814, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.0012, dtype=torch.float64) delta_t tensor(-1.0144, dtype=torch.float64)
9 gae_duplicate tensor(-4.2213, dtype=torch.float64) tensor(19.2982, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2271, dtype=torch.float64) delta_t tensor(0.9351, dtype=torch.float64)
8 gae_duplicate tensor(0.3857, dtype=torch.float64) tensor(-16.5065, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7229, dtype=torch.float64) delta_t tensor(0.2965, dtype=torch.float64)
7 gae_duplicate tensor(-0.9421, dtype=torch.float64) tensor(-7.1031, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5834, dtype=torch.float64) delta_t tensor(0.1984, dtype=torch.float64)
6 gae_duplicate tensor(-1.8372, dtype=torch.float64) tensor(-4.1920, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1166, dtype=torch.float64) delta_t tensor(0.2191, dtype=torch.float64)
5 gae_duplicate tensor(0.0229, dtype=torch.float64) tensor(-4.7409, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0443, dtype=torch.float64) delta_t tensor(0.3248, dtype=torch.float64)
4 gae_duplicate tensor(0.0743, dtype=torch.float64) tensor(-6.4221, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1569, dtype=torch.float64) delta_t tensor(0.1960, dtype=torch.float64)
3 gae_duplicate tensor(0.1749, dtype=torch.float64) tensor(-4.8522, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2841, dtype=torch.float64) delta_t tensor(-0.0752, dtype=torch.float64)
2 gae_duplicate tensor(-0.4287, dtype=torch.float64) tensor(1.3152, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4100.640625
value loss:101.67501831054688
entropies:351.71356201171875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3935.0457)
ToM Target loss= tensor(3691.8816)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.917051076889038 seconds
19 rew tensor(0.8774, dtype=torch.float64) delta_t tensor(0.0531, dtype=torch.float64)
19 gae_duplicate tensor(0.0058, dtype=torch.float64) tensor(-0.9644, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7934, dtype=torch.float64) delta_t tensor(0.0983, dtype=torch.float64)
18 gae_duplicate tensor(-0.0150, dtype=torch.float64) tensor(-1.9378, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7365, dtype=torch.float64) delta_t tensor(0.0725, dtype=torch.float64)
17 gae_duplicate tensor(-0.0309, dtype=torch.float64) tensor(-1.4766, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5647, dtype=torch.float64) delta_t tensor(0.0675, dtype=torch.float64)
16 gae_duplicate tensor(0.0027, dtype=torch.float64) tensor(-1.3987, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6985, dtype=torch.float64) delta_t tensor(0.1420, dtype=torch.float64)
15 gae_duplicate tensor(0.0611, dtype=torch.float64) tensor(-2.9873, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0852, dtype=torch.float64) delta_t tensor(-0.1534, dtype=torch.float64)
14 gae_duplicate tensor(-0.9028, dtype=torch.float64) tensor(2.8252, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4700, dtype=torch.float64) delta_t tensor(0.0230, dtype=torch.float64)
13 gae_duplicate tensor(-0.8226, dtype=torch.float64) tensor(0.0483, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0098, dtype=torch.float64) delta_t tensor(0.0095, dtype=torch.float64)
12 gae_duplicate tensor(-0.8350, dtype=torch.float64) tensor(-0.3228, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2483, dtype=torch.float64) delta_t tensor(0.0507, dtype=torch.float64)
11 gae_duplicate tensor(-0.8116, dtype=torch.float64) tensor(-1.0729, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0752, dtype=torch.float64) delta_t tensor(0.4348, dtype=torch.float64)
10 gae_duplicate tensor(-1.3464, dtype=torch.float64) tensor(-8.6324, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0700, dtype=torch.float64) delta_t tensor(-0.7252, dtype=torch.float64)
9 gae_duplicate tensor(-2.4440, dtype=torch.float64) tensor(11.4880, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6578, dtype=torch.float64) delta_t tensor(0.2893, dtype=torch.float64)
8 gae_duplicate tensor(-2.3930, dtype=torch.float64) tensor(-3.6004, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2889, dtype=torch.float64) delta_t tensor(0.5891, dtype=torch.float64)
7 gae_duplicate tensor(-0.0491, dtype=torch.float64) tensor(-11.8957, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2098, dtype=torch.float64) delta_t tensor(0.9119, dtype=torch.float64)
6 gae_duplicate tensor(0.8005, dtype=torch.float64) tensor(-18.1333, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3854, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
5 gae_duplicate tensor(-0.1164, dtype=torch.float64) tensor(-3.3335, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3405, dtype=torch.float64) delta_t tensor(0.2234, dtype=torch.float64)
4 gae_duplicate tensor(-0.0689, dtype=torch.float64) tensor(-4.6895, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5582, dtype=torch.float64) delta_t tensor(0.1495, dtype=torch.float64)
3 gae_duplicate tensor(-0.1738, dtype=torch.float64) tensor(-3.6415, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5939, dtype=torch.float64) delta_t tensor(-0.1753, dtype=torch.float64)
2 gae_duplicate tensor(-0.2551, dtype=torch.float64) tensor(2.8654, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2435.4384765625
value loss:66.48155212402344
entropies:351.8611145019531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.779093027114868 seconds
19 rew tensor(0.8768, dtype=torch.float64) delta_t tensor(0.0466, dtype=torch.float64)
19 gae_duplicate tensor(0.0134, dtype=torch.float64) tensor(-0.9251, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8027, dtype=torch.float64) delta_t tensor(0.0718, dtype=torch.float64)
18 gae_duplicate tensor(-0.0058, dtype=torch.float64) tensor(-1.6210, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7924, dtype=torch.float64) delta_t tensor(0.0809, dtype=torch.float64)
17 gae_duplicate tensor(-0.0059, dtype=torch.float64) tensor(-1.7381, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7008, dtype=torch.float64) delta_t tensor(0.0901, dtype=torch.float64)
16 gae_duplicate tensor(0.0449, dtype=torch.float64) tensor(-1.8005, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6901, dtype=torch.float64) delta_t tensor(0.1463, dtype=torch.float64)
15 gae_duplicate tensor(-0.0081, dtype=torch.float64) tensor(-3.2978, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6359, dtype=torch.float64) delta_t tensor(0.3151, dtype=torch.float64)
14 gae_duplicate tensor(0.0946, dtype=torch.float64) tensor(-6.2195, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6626, dtype=torch.float64) delta_t tensor(0.3386, dtype=torch.float64)
13 gae_duplicate tensor(0.0827, dtype=torch.float64) tensor(-7.0395, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5136, dtype=torch.float64) delta_t tensor(0.4653, dtype=torch.float64)
12 gae_duplicate tensor(0.1397, dtype=torch.float64) tensor(-10.0587, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6398, dtype=torch.float64) delta_t tensor(-0.3838, dtype=torch.float64)
11 gae_duplicate tensor(-2.1829, dtype=torch.float64) tensor(4.9699, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1134, dtype=torch.float64) delta_t tensor(0.3492, dtype=torch.float64)
10 gae_duplicate tensor(-0.8896, dtype=torch.float64) tensor(-7.2044, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.9178, dtype=torch.float64) delta_t tensor(-0.9857, dtype=torch.float64)
9 gae_duplicate tensor(-3.4845, dtype=torch.float64) tensor(17.7859, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.6080, dtype=torch.float64) delta_t tensor(-0.8807, dtype=torch.float64)
8 gae_duplicate tensor(-3.7125, dtype=torch.float64) tensor(19.3478, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1536, dtype=torch.float64) delta_t tensor(-0.1575, dtype=torch.float64)
7 gae_duplicate tensor(-1.9524, dtype=torch.float64) tensor(4.5254, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1945, dtype=torch.float64) delta_t tensor(0.4511, dtype=torch.float64)
6 gae_duplicate tensor(-1.8830, dtype=torch.float64) tensor(-8.2926, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2763, dtype=torch.float64) delta_t tensor(0.0904, dtype=torch.float64)
5 gae_duplicate tensor(-0.9779, dtype=torch.float64) tensor(-2.6265, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3404, dtype=torch.float64) delta_t tensor(0.4073, dtype=torch.float64)
4 gae_duplicate tensor(0.1198, dtype=torch.float64) tensor(-8.4407, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0174, dtype=torch.float64) delta_t tensor(0.0886, dtype=torch.float64)
3 gae_duplicate tensor(-0.0168, dtype=torch.float64) tensor(-2.5859, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1259, dtype=torch.float64) delta_t tensor(0.0092, dtype=torch.float64)
2 gae_duplicate tensor(-0.1003, dtype=torch.float64) tensor(-0.4206, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:749.5861206054688
value loss:110.31843566894531
entropies:352.1161193847656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.117417812347412 seconds
19 rew tensor(0.8282, dtype=torch.float64) delta_t tensor(-0.0183, dtype=torch.float64)
19 gae_duplicate tensor(-0.1164, dtype=torch.float64) tensor(0.3431, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7908, dtype=torch.float64) delta_t tensor(0.0845, dtype=torch.float64)
18 gae_duplicate tensor(-0.0472, dtype=torch.float64) tensor(-1.6212, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7652, dtype=torch.float64) delta_t tensor(0.1127, dtype=torch.float64)
17 gae_duplicate tensor(0.0174, dtype=torch.float64) tensor(-2.2623, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6038, dtype=torch.float64) delta_t tensor(0.0189, dtype=torch.float64)
16 gae_duplicate tensor(-0.0818, dtype=torch.float64) tensor(-0.6074, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4135, dtype=torch.float64) delta_t tensor(-0.0120, dtype=torch.float64)
15 gae_duplicate tensor(-1.0745, dtype=torch.float64) tensor(0.4588, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5663, dtype=torch.float64) delta_t tensor(0.1985, dtype=torch.float64)
14 gae_duplicate tensor(-0.0904, dtype=torch.float64) tensor(-3.8804, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3321, dtype=torch.float64) delta_t tensor(0.2030, dtype=torch.float64)
13 gae_duplicate tensor(-0.9319, dtype=torch.float64) tensor(-4.0494, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1853, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
12 gae_duplicate tensor(-1.0522, dtype=torch.float64) tensor(-1.8043, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3127, dtype=torch.float64) delta_t tensor(-0.1086, dtype=torch.float64)
11 gae_duplicate tensor(-0.9373, dtype=torch.float64) tensor(2.0415, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1984, dtype=torch.float64) delta_t tensor(0.0080, dtype=torch.float64)
10 gae_duplicate tensor(-1.5850, dtype=torch.float64) tensor(0.0159, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6528, dtype=torch.float64) delta_t tensor(0.2527, dtype=torch.float64)
9 gae_duplicate tensor(-2.7398, dtype=torch.float64) tensor(-4.7704, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3877, dtype=torch.float64) delta_t tensor(0.7077, dtype=torch.float64)
8 gae_duplicate tensor(0.4007, dtype=torch.float64) tensor(-14.4280, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5777, dtype=torch.float64) delta_t tensor(0.5020, dtype=torch.float64)
7 gae_duplicate tensor(-0.6870, dtype=torch.float64) tensor(-11.6596, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0924, dtype=torch.float64) delta_t tensor(0.3838, dtype=torch.float64)
6 gae_duplicate tensor(-1.6851, dtype=torch.float64) tensor(-9.0437, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2411, dtype=torch.float64) delta_t tensor(0.1601, dtype=torch.float64)
5 gae_duplicate tensor(0.0312, dtype=torch.float64) tensor(-3.9638, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2463, dtype=torch.float64) delta_t tensor(0.2439, dtype=torch.float64)
4 gae_duplicate tensor(0.1624, dtype=torch.float64) tensor(-5.0854, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0755, dtype=torch.float64) delta_t tensor(0.1419, dtype=torch.float64)
3 gae_duplicate tensor(0.0084, dtype=torch.float64) tensor(-3.3798, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1735, dtype=torch.float64) delta_t tensor(-0.0231, dtype=torch.float64)
2 gae_duplicate tensor(-0.2023, dtype=torch.float64) tensor(0.4159, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3321.945068359375
value loss:68.71534729003906
entropies:352.5716857910156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.972622871398926 seconds
19 rew tensor(0.8409, dtype=torch.float64) delta_t tensor(-0.0418, dtype=torch.float64)
19 gae_duplicate tensor(-0.2082, dtype=torch.float64) tensor(0.7994, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8028, dtype=torch.float64) delta_t tensor(0.0597, dtype=torch.float64)
18 gae_duplicate tensor(-0.0467, dtype=torch.float64) tensor(-1.0997, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8323, dtype=torch.float64) delta_t tensor(0.0646, dtype=torch.float64)
17 gae_duplicate tensor(-0.0158, dtype=torch.float64) tensor(-1.3495, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6145, dtype=torch.float64) delta_t tensor(0.0510, dtype=torch.float64)
16 gae_duplicate tensor(-0.1079, dtype=torch.float64) tensor(-1.1293, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6785, dtype=torch.float64) delta_t tensor(0.0444, dtype=torch.float64)
15 gae_duplicate tensor(-0.0923, dtype=torch.float64) tensor(-0.9569, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1950, dtype=torch.float64) delta_t tensor(0.0410, dtype=torch.float64)
14 gae_duplicate tensor(-0.8415, dtype=torch.float64) tensor(-0.8076, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5387, dtype=torch.float64) delta_t tensor(0.0373, dtype=torch.float64)
13 gae_duplicate tensor(-0.9017, dtype=torch.float64) tensor(-0.9514, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0285, dtype=torch.float64) delta_t tensor(0.1219, dtype=torch.float64)
12 gae_duplicate tensor(-0.6395, dtype=torch.float64) tensor(-2.5258, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4253, dtype=torch.float64) delta_t tensor(-0.6905, dtype=torch.float64)
11 gae_duplicate tensor(-0.8844, dtype=torch.float64) tensor(13.6162, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2580, dtype=torch.float64) delta_t tensor(0.3175, dtype=torch.float64)
10 gae_duplicate tensor(-0.7665, dtype=torch.float64) tensor(-4.6560, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2140, dtype=torch.float64) delta_t tensor(-0.0371, dtype=torch.float64)
9 gae_duplicate tensor(-2.3604, dtype=torch.float64) tensor(-0.1394, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7988, dtype=torch.float64) delta_t tensor(0.2200, dtype=torch.float64)
8 gae_duplicate tensor(-2.1861, dtype=torch.float64) tensor(-4.4037, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5914, dtype=torch.float64) delta_t tensor(0.8156, dtype=torch.float64)
7 gae_duplicate tensor(0.7118, dtype=torch.float64) tensor(-16.7235, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6540, dtype=torch.float64) delta_t tensor(0.5258, dtype=torch.float64)
6 gae_duplicate tensor(-1.3776, dtype=torch.float64) tensor(-12.4529, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.5000, dtype=torch.float64) delta_t tensor(0.0719, dtype=torch.float64)
5 gae_duplicate tensor(-0.1802, dtype=torch.float64) tensor(-2.5521, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3280, dtype=torch.float64) delta_t tensor(0.1276, dtype=torch.float64)
4 gae_duplicate tensor(-0.0883, dtype=torch.float64) tensor(-2.7744, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5412, dtype=torch.float64) delta_t tensor(0.0641, dtype=torch.float64)
3 gae_duplicate tensor(-0.1070, dtype=torch.float64) tensor(-1.5399, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5983, dtype=torch.float64) delta_t tensor(-0.1899, dtype=torch.float64)
2 gae_duplicate tensor(-0.3095, dtype=torch.float64) tensor(3.5080, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1856.2015380859375
value loss:57.48921585083008
entropies:352.8979797363281
Policy training finished
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt