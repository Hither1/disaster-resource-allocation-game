True
obs <crafter.objects.Shelter object at 0x16b341d30> 0 [39.  0.  0.  0. 39.  0.  0.  0. 19.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x16b32d550> 0 [39.  0.  0.  0. 37.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x16b32dd30> 0 [ 9.  0.  0.  0.  9.  0.  0.  0. 14.  0.  0.  0.]
obs <crafter.objects.Shelter object at 0x16b341d30> 0 [39.  0.  0.  0. 39.  0.  0.  0. 20.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x16b32d550> 0 [39.  0.  0.  0. 39.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x16b32dd30> 0 [ 9.  0.  0.  0.  9.  0.  0.  0. 12.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
feature_dim 71 lstm_out 32
2024-01-21 19:10:52,635 : lr: 0.001
2024-01-21 19:10:52,635 : gamma: 0.1
2024-01-21 19:10:52,636 : gamma_rate: 0.002
2024-01-21 19:10:52,636 : gamma_final: 0.9
2024-01-21 19:10:52,636 : tau: 1.0
2024-01-21 19:10:52,636 : entropy: 0.005
2024-01-21 19:10:52,636 : grad_entropy: 1.0
2024-01-21 19:10:52,636 : seed: 1
2024-01-21 19:10:52,636 : workers: 6
2024-01-21 19:10:52,636 : A2C_steps: 20
2024-01-21 19:10:52,636 : env_steps: 20
2024-01-21 19:10:52,636 : start_eps: 2000
2024-01-21 19:10:52,636 : ToM_train_loops: 1
2024-01-21 19:10:52,636 : policy_train_loops: 1
2024-01-21 19:10:52,636 : test_eps: 20
2024-01-21 19:10:52,636 : ToM_frozen: 5
2024-01-21 19:10:52,636 : env: RA
2024-01-21 19:10:52,636 : optimizer: Adam
2024-01-21 19:10:52,636 : amsgrad: True
2024-01-21 19:10:52,636 : load_model_dir: None
2024-01-21 19:10:52,637 : load_executor_dir: None
2024-01-21 19:10:52,637 : log_dir: logs/RA/Jan21_19-10
2024-01-21 19:10:52,637 : model: ToM2C
2024-01-21 19:10:52,637 : gpu_id: [-1]
2024-01-21 19:10:52,637 : norm_reward: True
2024-01-21 19:10:52,637 : train_comm: False
2024-01-21 19:10:52,637 : random_target: True
2024-01-21 19:10:52,637 : mask_actions: False
2024-01-21 19:10:52,637 : mask: False
2024-01-21 19:10:52,637 : render: False
2024-01-21 19:10:52,637 : fix: False
2024-01-21 19:10:52,637 : shared_optimizer: True
2024-01-21 19:10:52,637 : train_mode: -1
2024-01-21 19:10:52,637 : lstm_out: 32
2024-01-21 19:10:52,637 : sleep_time: 0
2024-01-21 19:10:52,637 : max_step: 3000000
2024-01-21 19:10:52,637 : render_save: False
2024-01-21 19:10:52,637 : num_agents: -1
2024-01-21 19:10:52,637 : num_targets: -1
obs <crafter.objects.Shelter object at 0x16b341d30> 0 [39.  0.  0.  0. 39.  0.  0.  0. 16.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x16b32d550> 0 [38.  0.  0.  0. 40.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x16b32dd30> 0 [ 9.  0.  0.  0.  9.  0.  0.  0. 12.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
att_features torch.Size([1, 3, 3, 32])
> /Users/suhuangyuan/DRA/ToM2C/model_ra.py(761)forward()
-> att_features = att_features[:, :, :self.num_targets]
(Pdb)
Process Process-8:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/test.py", line 83, in test
    player.action_test()
  File "/Users/suhuangyuan/DRA/ToM2C/player_util.py", line 152, in action_test
    self.model(self.state, self.hself, self.hToM, True, available_actions=available_actions)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/model_ra.py", line 761, in forward
    att_features = att_features[:, :, :self.num_targets]
  File "/Users/suhuangyuan/DRA/ToM2C/model_ra.py", line 761, in forward
    att_features = att_features[:, :, :self.num_targets]
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit