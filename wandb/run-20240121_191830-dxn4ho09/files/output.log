obs <crafter.objects.Shelter object at 0x13c2ac7c0> 0 [39.  0.  0.  0. 39.  0.  0.  0. 22.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x11b5145b0> 0 [38.  0.  0.  0. 40.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x13c2b1940> 0 [9. 0. 0. 0. 9. 0. 0. 0. 9. 0. 0. 0.]
obs <crafter.objects.Shelter object at 0x13c2ac7c0> 0 [39.  0.  0.  0. 39.  0.  0.  0. 21.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x11b5145b0> 0 [39.  0.  0.  0. 38.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x13c2b1940> 0 [ 9.  0.  0.  0.  9.  0.  0.  0. 12.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0029289722442626953 seconds
19 rew tensor(0.9497, dtype=torch.float64) delta_t tensor(0.8934, dtype=torch.float64)
19 gae_duplicate tensor(0.6793, dtype=torch.float64) tensor(-17.6184, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9453, dtype=torch.float64) delta_t tensor(0.8921, dtype=torch.float64)
18 gae_duplicate tensor(0.7852, dtype=torch.float64) tensor(-19.4239, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9500, dtype=torch.float64) delta_t tensor(0.9036, dtype=torch.float64)
17 gae_duplicate tensor(0.8253, dtype=torch.float64) tensor(-19.8950, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8596, dtype=torch.float64) delta_t tensor(0.7546, dtype=torch.float64)
16 gae_duplicate tensor(0.6505, dtype=torch.float64) tensor(-15.9462, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0527, dtype=torch.float64) delta_t tensor(0.9565, dtype=torch.float64)
15 gae_duplicate tensor(0.6876, dtype=torch.float64) tensor(-19.8118, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8602, dtype=torch.float64) delta_t tensor(0.7758, dtype=torch.float64)
14 gae_duplicate tensor(0.6283, dtype=torch.float64) tensor(-17.4267, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0070, dtype=torch.float64) delta_t tensor(0.8917, dtype=torch.float64)
13 gae_duplicate tensor(0.5627, dtype=torch.float64) tensor(-18.8007, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8328, dtype=torch.float64) delta_t tensor(0.7254, dtype=torch.float64)
12 gae_duplicate tensor(0.4497, dtype=torch.float64) tensor(-16.2918, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2386, dtype=torch.float64) delta_t tensor(0.1856, dtype=torch.float64)
11 gae_duplicate tensor(-0.5788, dtype=torch.float64) tensor(-5.1716, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1006, dtype=torch.float64) delta_t tensor(-0.2617, dtype=torch.float64)
10 gae_duplicate tensor(-1.7881, dtype=torch.float64) tensor(4.0262, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1077, dtype=torch.float64) delta_t tensor(-1.1472, dtype=torch.float64)
9 gae_duplicate tensor(-2.6741, dtype=torch.float64) tensor(22.8753, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7887, dtype=torch.float64) delta_t tensor(-0.9039, dtype=torch.float64)
8 gae_duplicate tensor(-2.3442, dtype=torch.float64) tensor(19.7128, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7002, dtype=torch.float64) delta_t tensor(0.6842, dtype=torch.float64)
7 gae_duplicate tensor(-1.6655, dtype=torch.float64) tensor(-12.3502, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0701, dtype=torch.float64) delta_t tensor(-0.1490, dtype=torch.float64)
6 gae_duplicate tensor(-1.4573, dtype=torch.float64) tensor(1.2016, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.7682, dtype=torch.float64) delta_t tensor(0.7613, dtype=torch.float64)
5 gae_duplicate tensor(-0.2204, dtype=torch.float64) tensor(-14.9472, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5406, dtype=torch.float64) delta_t tensor(0.5036, dtype=torch.float64)
4 gae_duplicate tensor(-0.2225, dtype=torch.float64) tensor(-11.7214, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(1.1916, dtype=torch.float64) delta_t tensor(1.2281, dtype=torch.float64)
3 gae_duplicate tensor(0.7299, dtype=torch.float64) tensor(-24.5472, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1359, dtype=torch.float64) delta_t tensor(0.1927, dtype=torch.float64)
2 gae_duplicate tensor(-0.8476, dtype=torch.float64) tensor(-6.7815, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:9242.080078125
value loss:188.60301208496094
entropies:353.6011047363281
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 5.781087398529053 seconds
19 rew tensor(0.8978, dtype=torch.float64) delta_t tensor(0.7990, dtype=torch.float64)
19 gae_duplicate tensor(0.6446, dtype=torch.float64) tensor(-15.3029, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8329, dtype=torch.float64) delta_t tensor(0.6853, dtype=torch.float64)
18 gae_duplicate tensor(0.5478, dtype=torch.float64) tensor(-15.6085, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8868, dtype=torch.float64) delta_t tensor(0.7774, dtype=torch.float64)
17 gae_duplicate tensor(0.6265, dtype=torch.float64) tensor(-16.5936, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6850, dtype=torch.float64) delta_t tensor(0.5423, dtype=torch.float64)
16 gae_duplicate tensor(0.4321, dtype=torch.float64) tensor(-12.2030, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6125, dtype=torch.float64) delta_t tensor(0.5157, dtype=torch.float64)
15 gae_duplicate tensor(-0.2854, dtype=torch.float64) tensor(-11.2309, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5710, dtype=torch.float64) delta_t tensor(0.4083, dtype=torch.float64)
14 gae_duplicate tensor(0.2419, dtype=torch.float64) tensor(-8.9069, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7400, dtype=torch.float64) delta_t tensor(0.6508, dtype=torch.float64)
13 gae_duplicate tensor(0.2121, dtype=torch.float64) tensor(-13.7596, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3315, dtype=torch.float64) delta_t tensor(0.1581, dtype=torch.float64)
12 gae_duplicate tensor(-0.2920, dtype=torch.float64) tensor(-4.6972, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3237, dtype=torch.float64) delta_t tensor(0.2576, dtype=torch.float64)
11 gae_duplicate tensor(-0.5058, dtype=torch.float64) tensor(-5.3348, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4803, dtype=torch.float64) delta_t tensor(-0.6550, dtype=torch.float64)
10 gae_duplicate tensor(-3.0979, dtype=torch.float64) tensor(11.7722, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9735, dtype=torch.float64) delta_t tensor(-1.0229, dtype=torch.float64)
9 gae_duplicate tensor(-3.5266, dtype=torch.float64) tensor(22.5056, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1397, dtype=torch.float64) delta_t tensor(-1.3481, dtype=torch.float64)
8 gae_duplicate tensor(-4.4679, dtype=torch.float64) tensor(29.4292, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7029, dtype=torch.float64) delta_t tensor(0.6577, dtype=torch.float64)
7 gae_duplicate tensor(0.0647, dtype=torch.float64) tensor(-9.9950, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2571, dtype=torch.float64) delta_t tensor(-0.3409, dtype=torch.float64)
6 gae_duplicate tensor(-1.0590, dtype=torch.float64) tensor(6.1299, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3558, dtype=torch.float64) delta_t tensor(0.3142, dtype=torch.float64)
5 gae_duplicate tensor(-0.3249, dtype=torch.float64) tensor(-5.5499, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2573, dtype=torch.float64) delta_t tensor(-0.2676, dtype=torch.float64)
4 gae_duplicate tensor(-1.0491, dtype=torch.float64) tensor(4.8858, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5240, dtype=torch.float64) delta_t tensor(0.5299, dtype=torch.float64)
3 gae_duplicate tensor(-0.1369, dtype=torch.float64) tensor(-9.5744, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6885, dtype=torch.float64) delta_t tensor(-0.6269, dtype=torch.float64)
2 gae_duplicate tensor(-1.1321, dtype=torch.float64) tensor(11.5962, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2195.9306640625
value loss:154.46176147460938
entropies:354.48345947265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.821008205413818 seconds
19 rew tensor(0.8785, dtype=torch.float64) delta_t tensor(0.7380, dtype=torch.float64)
19 gae_duplicate tensor(0.6631, dtype=torch.float64) tensor(-14.4971, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8769, dtype=torch.float64) delta_t tensor(0.6817, dtype=torch.float64)
18 gae_duplicate tensor(0.4502, dtype=torch.float64) tensor(-15.2145, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8526, dtype=torch.float64) delta_t tensor(0.7327, dtype=torch.float64)
17 gae_duplicate tensor(0.6670, dtype=torch.float64) tensor(-15.1829, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6873, dtype=torch.float64) delta_t tensor(0.5176, dtype=torch.float64)
16 gae_duplicate tensor(0.3857, dtype=torch.float64) tensor(-11.4672, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7430, dtype=torch.float64) delta_t tensor(0.6256, dtype=torch.float64)
15 gae_duplicate tensor(0.5186, dtype=torch.float64) tensor(-13.4249, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2094, dtype=torch.float64) delta_t tensor(-0.0213, dtype=torch.float64)
14 gae_duplicate tensor(-1.4776, dtype=torch.float64) tensor(-0.3289, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7684, dtype=torch.float64) delta_t tensor(0.6775, dtype=torch.float64)
13 gae_duplicate tensor(0.5148, dtype=torch.float64) tensor(-13.5339, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0929, dtype=torch.float64) delta_t tensor(-0.1056, dtype=torch.float64)
12 gae_duplicate tensor(-1.0621, dtype=torch.float64) tensor(0.4651, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3653, dtype=torch.float64) delta_t tensor(-0.4421, dtype=torch.float64)
11 gae_duplicate tensor(-1.7946, dtype=torch.float64) tensor(8.7898, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1305, dtype=torch.float64) delta_t tensor(-0.0319, dtype=torch.float64)
10 gae_duplicate tensor(-0.2854, dtype=torch.float64) tensor(1.4109, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4864, dtype=torch.float64) delta_t tensor(-0.5556, dtype=torch.float64)
9 gae_duplicate tensor(-2.4942, dtype=torch.float64) tensor(10.7182, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.8871, dtype=torch.float64) delta_t tensor(-2.0021, dtype=torch.float64)
8 gae_duplicate tensor(-4.0082, dtype=torch.float64) tensor(40.8777, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2212, dtype=torch.float64) delta_t tensor(0.1340, dtype=torch.float64)
7 gae_duplicate tensor(-1.1289, dtype=torch.float64) tensor(1.0981, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5185, dtype=torch.float64) delta_t tensor(-0.5958, dtype=torch.float64)
6 gae_duplicate tensor(-1.1748, dtype=torch.float64) tensor(11.2388, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4875, dtype=torch.float64) delta_t tensor(0.4019, dtype=torch.float64)
5 gae_duplicate tensor(-0.0271, dtype=torch.float64) tensor(-6.5267, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3741, dtype=torch.float64) delta_t tensor(-0.3789, dtype=torch.float64)
4 gae_duplicate tensor(-1.2975, dtype=torch.float64) tensor(6.6469, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.5735, dtype=torch.float64) delta_t tensor(0.5131, dtype=torch.float64)
3 gae_duplicate tensor(0.2178, dtype=torch.float64) tensor(-9.6015, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7223, dtype=torch.float64) delta_t tensor(-0.6655, dtype=torch.float64)
2 gae_duplicate tensor(-1.3344, dtype=torch.float64) tensor(11.9156, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:261.6518859863281
value loss:142.53578186035156
entropies:354.2171630859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.777858018875122 seconds
19 rew tensor(0.8421, dtype=torch.float64) delta_t tensor(0.6667, dtype=torch.float64)
19 gae_duplicate tensor(0.5502, dtype=torch.float64) tensor(-13.5839, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5341, dtype=torch.float64) delta_t tensor(0.3144, dtype=torch.float64)
18 gae_duplicate tensor(-1.0009, dtype=torch.float64) tensor(-6.8925, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8360, dtype=torch.float64) delta_t tensor(0.6858, dtype=torch.float64)
17 gae_duplicate tensor(0.6509, dtype=torch.float64) tensor(-14.2024, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6504, dtype=torch.float64) delta_t tensor(0.4722, dtype=torch.float64)
16 gae_duplicate tensor(0.4664, dtype=torch.float64) tensor(-10.2760, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4540, dtype=torch.float64) delta_t tensor(0.2916, dtype=torch.float64)
15 gae_duplicate tensor(-0.6680, dtype=torch.float64) tensor(-7.0605, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5472, dtype=torch.float64) delta_t tensor(0.3586, dtype=torch.float64)
14 gae_duplicate tensor(0.1499, dtype=torch.float64) tensor(-7.7833, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4341, dtype=torch.float64) delta_t tensor(0.2651, dtype=torch.float64)
13 gae_duplicate tensor(-0.7552, dtype=torch.float64) tensor(-5.8945, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4871, dtype=torch.float64) delta_t tensor(0.3054, dtype=torch.float64)
12 gae_duplicate tensor(-0.0109, dtype=torch.float64) tensor(-6.2698, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3333, dtype=torch.float64) delta_t tensor(-0.4801, dtype=torch.float64)
11 gae_duplicate tensor(-1.6182, dtype=torch.float64) tensor(8.5727, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0740, dtype=torch.float64) delta_t tensor(-0.0748, dtype=torch.float64)
10 gae_duplicate tensor(-0.8954, dtype=torch.float64) tensor(2.1390, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7191, dtype=torch.float64) delta_t tensor(-1.8614, dtype=torch.float64)
9 gae_duplicate tensor(-5.5656, dtype=torch.float64) tensor(37.9385, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.3579, dtype=torch.float64) delta_t tensor(-2.4654, dtype=torch.float64)
8 gae_duplicate tensor(-5.8185, dtype=torch.float64) tensor(53.2278, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0694, dtype=torch.float64) delta_t tensor(-0.0617, dtype=torch.float64)
7 gae_duplicate tensor(-2.5248, dtype=torch.float64) tensor(6.1862, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3387, dtype=torch.float64) delta_t tensor(-0.4015, dtype=torch.float64)
6 gae_duplicate tensor(-1.8024, dtype=torch.float64) tensor(9.5099, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1111, dtype=torch.float64) delta_t tensor(-0.1987, dtype=torch.float64)
5 gae_duplicate tensor(-1.8499, dtype=torch.float64) tensor(4.5693, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2609, dtype=torch.float64) delta_t tensor(0.1850, dtype=torch.float64)
4 gae_duplicate tensor(-0.2462, dtype=torch.float64) tensor(-3.1065, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0625, dtype=torch.float64) delta_t tensor(-0.0132, dtype=torch.float64)
3 gae_duplicate tensor(-0.3820, dtype=torch.float64) tensor(0.0933, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3762, dtype=torch.float64) delta_t tensor(-0.4205, dtype=torch.float64)
2 gae_duplicate tensor(-0.8784, dtype=torch.float64) tensor(8.2190, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3086.53662109375
value loss:235.06378173828125
entropies:354.36029052734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.40255069732666 seconds
19 rew tensor(0.8405, dtype=torch.float64) delta_t tensor(0.6297, dtype=torch.float64)
19 gae_duplicate tensor(0.5387, dtype=torch.float64) tensor(-12.6230, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8095, dtype=torch.float64) delta_t tensor(0.5751, dtype=torch.float64)
18 gae_duplicate tensor(0.4673, dtype=torch.float64) tensor(-12.4521, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8295, dtype=torch.float64) delta_t tensor(0.6385, dtype=torch.float64)
17 gae_duplicate tensor(0.6305, dtype=torch.float64) tensor(-13.6309, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5274, dtype=torch.float64) delta_t tensor(0.2946, dtype=torch.float64)
16 gae_duplicate tensor(-0.6368, dtype=torch.float64) tensor(-7.2313, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5813, dtype=torch.float64) delta_t tensor(0.3253, dtype=torch.float64)
15 gae_duplicate tensor(-0.4774, dtype=torch.float64) tensor(-7.0339, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5995, dtype=torch.float64) delta_t tensor(0.3948, dtype=torch.float64)
14 gae_duplicate tensor(0.2683, dtype=torch.float64) tensor(-8.4631, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5820, dtype=torch.float64) delta_t tensor(0.3364, dtype=torch.float64)
13 gae_duplicate tensor(-0.0463, dtype=torch.float64) tensor(-7.7275, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6567, dtype=torch.float64) delta_t tensor(0.5058, dtype=torch.float64)
12 gae_duplicate tensor(0.2802, dtype=torch.float64) tensor(-10.8604, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0238, dtype=torch.float64) delta_t tensor(-0.1496, dtype=torch.float64)
11 gae_duplicate tensor(-0.8792, dtype=torch.float64) tensor(2.0791, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3651, dtype=torch.float64) delta_t tensor(-0.5378, dtype=torch.float64)
10 gae_duplicate tensor(-1.6171, dtype=torch.float64) tensor(11.0468, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.6390, dtype=torch.float64) delta_t tensor(-2.7905, dtype=torch.float64)
9 gae_duplicate tensor(-6.1453, dtype=torch.float64) tensor(55.1604, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7568, dtype=torch.float64) delta_t tensor(-0.8870, dtype=torch.float64)
8 gae_duplicate tensor(-2.9782, dtype=torch.float64) tensor(22.5940, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1851, dtype=torch.float64) delta_t tensor(-0.2836, dtype=torch.float64)
7 gae_duplicate tensor(-1.6142, dtype=torch.float64) tensor(8.2851, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3198, dtype=torch.float64) delta_t tensor(0.2527, dtype=torch.float64)
6 gae_duplicate tensor(-0.1836, dtype=torch.float64) tensor(-4.0964, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2198, dtype=torch.float64) delta_t tensor(-0.2997, dtype=torch.float64)
5 gae_duplicate tensor(-0.9188, dtype=torch.float64) tensor(5.4838, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2859, dtype=torch.float64) delta_t tensor(0.1905, dtype=torch.float64)
4 gae_duplicate tensor(-0.5570, dtype=torch.float64) tensor(-3.2446, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1109, dtype=torch.float64) delta_t tensor(0.0912, dtype=torch.float64)
3 gae_duplicate tensor(-0.5646, dtype=torch.float64) tensor(-2.1821, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2989, dtype=torch.float64) delta_t tensor(-0.3214, dtype=torch.float64)
2 gae_duplicate tensor(-0.7335, dtype=torch.float64) tensor(5.6766, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1217.7489013671875
value loss:196.66932678222656
entropies:354.1278991699219
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3974.7644)
ToM Target loss= tensor(3527.2629)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.671649932861328 seconds
19 rew tensor(0.8354, dtype=torch.float64) delta_t tensor(0.5985, dtype=torch.float64)
19 gae_duplicate tensor(0.4987, dtype=torch.float64) tensor(-11.7432, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5996, dtype=torch.float64) delta_t tensor(0.3519, dtype=torch.float64)
18 gae_duplicate tensor(-0.6936, dtype=torch.float64) tensor(-8.3123, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7712, dtype=torch.float64) delta_t tensor(0.5532, dtype=torch.float64)
17 gae_duplicate tensor(0.4589, dtype=torch.float64) tensor(-12.3323, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6549, dtype=torch.float64) delta_t tensor(0.4419, dtype=torch.float64)
16 gae_duplicate tensor(0.2998, dtype=torch.float64) tensor(-9.7544, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2389, dtype=torch.float64) delta_t tensor(0.0123, dtype=torch.float64)
15 gae_duplicate tensor(-1.1304, dtype=torch.float64) tensor(-1.5302, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3978, dtype=torch.float64) delta_t tensor(0.2061, dtype=torch.float64)
14 gae_duplicate tensor(-0.8451, dtype=torch.float64) tensor(-4.4237, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4784, dtype=torch.float64) delta_t tensor(0.2676, dtype=torch.float64)
13 gae_duplicate tensor(-0.5404, dtype=torch.float64) tensor(-5.6363, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4723, dtype=torch.float64) delta_t tensor(0.3058, dtype=torch.float64)
12 gae_duplicate tensor(0.0543, dtype=torch.float64) tensor(-6.2781, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3617, dtype=torch.float64) delta_t tensor(-0.5419, dtype=torch.float64)
11 gae_duplicate tensor(-1.7232, dtype=torch.float64) tensor(9.9671, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0980, dtype=torch.float64) delta_t tensor(-0.2342, dtype=torch.float64)
10 gae_duplicate tensor(-1.7649, dtype=torch.float64) tensor(5.6373, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.1272, dtype=torch.float64) delta_t tensor(-1.2774, dtype=torch.float64)
9 gae_duplicate tensor(-2.5385, dtype=torch.float64) tensor(25.2022, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.3119, dtype=torch.float64) delta_t tensor(-2.4363, dtype=torch.float64)
8 gae_duplicate tensor(-4.5706, dtype=torch.float64) tensor(48.5964, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1343, dtype=torch.float64) delta_t tensor(-0.2738, dtype=torch.float64)
7 gae_duplicate tensor(-2.4156, dtype=torch.float64) tensor(10.7506, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1699, dtype=torch.float64) delta_t tensor(-0.2234, dtype=torch.float64)
6 gae_duplicate tensor(-2.1230, dtype=torch.float64) tensor(5.5284, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0357, dtype=torch.float64) delta_t tensor(-0.1570, dtype=torch.float64)
5 gae_duplicate tensor(-2.1674, dtype=torch.float64) tensor(3.4034, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2103, dtype=torch.float64) delta_t tensor(0.1439, dtype=torch.float64)
4 gae_duplicate tensor(-0.3756, dtype=torch.float64) tensor(-2.5201, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0604, dtype=torch.float64) delta_t tensor(-0.0516, dtype=torch.float64)
3 gae_duplicate tensor(-0.8160, dtype=torch.float64) tensor(0.4717, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2621, dtype=torch.float64) delta_t tensor(-0.3221, dtype=torch.float64)
2 gae_duplicate tensor(-0.6256, dtype=torch.float64) tensor(6.4401, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2982.83642578125
value loss:186.96151733398438
entropies:354.20367431640625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 6.25792384147644 seconds
19 rew tensor(0.8217, dtype=torch.float64) delta_t tensor(0.5581, dtype=torch.float64)
19 gae_duplicate tensor(0.4872, dtype=torch.float64) tensor(-11.1853, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8267, dtype=torch.float64) delta_t tensor(0.5676, dtype=torch.float64)
18 gae_duplicate tensor(0.5743, dtype=torch.float64) tensor(-12.2276, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7829, dtype=torch.float64) delta_t tensor(0.5374, dtype=torch.float64)
17 gae_duplicate tensor(0.4651, dtype=torch.float64) tensor(-11.5155, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7230, dtype=torch.float64) delta_t tensor(0.4824, dtype=torch.float64)
16 gae_duplicate tensor(0.3046, dtype=torch.float64) tensor(-11.0310, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7023, dtype=torch.float64) delta_t tensor(0.4433, dtype=torch.float64)
15 gae_duplicate tensor(0.3061, dtype=torch.float64) tensor(-9.6114, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5729, dtype=torch.float64) delta_t tensor(0.3993, dtype=torch.float64)
14 gae_duplicate tensor(0.2786, dtype=torch.float64) tensor(-8.6315, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5900, dtype=torch.float64) delta_t tensor(0.3251, dtype=torch.float64)
13 gae_duplicate tensor(0.2241, dtype=torch.float64) tensor(-7.2513, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5223, dtype=torch.float64) delta_t tensor(0.3767, dtype=torch.float64)
12 gae_duplicate tensor(0.1192, dtype=torch.float64) tensor(-8.2162, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6538, dtype=torch.float64) delta_t tensor(-0.8188, dtype=torch.float64)
11 gae_duplicate tensor(-1.7643, dtype=torch.float64) tensor(15.2881, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3524, dtype=torch.float64) delta_t tensor(0.2284, dtype=torch.float64)
10 gae_duplicate tensor(-0.2118, dtype=torch.float64) tensor(-3.0651, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.8302, dtype=torch.float64) delta_t tensor(-1.9729, dtype=torch.float64)
9 gae_duplicate tensor(-4.7472, dtype=torch.float64) tensor(37.9733, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3363, dtype=torch.float64) delta_t tensor(-0.4434, dtype=torch.float64)
8 gae_duplicate tensor(-2.4389, dtype=torch.float64) tensor(12.9811, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0447, dtype=torch.float64) delta_t tensor(-1.1306, dtype=torch.float64)
7 gae_duplicate tensor(-3.3946, dtype=torch.float64) tensor(24.1142, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1855, dtype=torch.float64) delta_t tensor(0.1476, dtype=torch.float64)
6 gae_duplicate tensor(-0.2314, dtype=torch.float64) tensor(-0.5568, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0907, dtype=torch.float64) delta_t tensor(-0.0365, dtype=torch.float64)
5 gae_duplicate tensor(-0.6020, dtype=torch.float64) tensor(0.5797, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1806, dtype=torch.float64) delta_t tensor(0.1022, dtype=torch.float64)
4 gae_duplicate tensor(-0.5049, dtype=torch.float64) tensor(-1.6800, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1877, dtype=torch.float64) delta_t tensor(0.1108, dtype=torch.float64)
3 gae_duplicate tensor(-0.1946, dtype=torch.float64) tensor(-2.3219, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3062, dtype=torch.float64) delta_t tensor(-0.4204, dtype=torch.float64)
2 gae_duplicate tensor(-0.6597, dtype=torch.float64) tensor(8.0399, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-726.5819702148438
value loss:163.11630249023438
entropies:354.4905090332031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.684790849685669 seconds
19 rew tensor(0.7791, dtype=torch.float64) delta_t tensor(0.4803, dtype=torch.float64)
19 gae_duplicate tensor(0.3725, dtype=torch.float64) tensor(-9.4769, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7706, dtype=torch.float64) delta_t tensor(0.5088, dtype=torch.float64)
18 gae_duplicate tensor(0.4087, dtype=torch.float64) tensor(-10.7642, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7083, dtype=torch.float64) delta_t tensor(0.4525, dtype=torch.float64)
17 gae_duplicate tensor(0.3894, dtype=torch.float64) tensor(-9.6812, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7749, dtype=torch.float64) delta_t tensor(0.5231, dtype=torch.float64)
16 gae_duplicate tensor(0.4103, dtype=torch.float64) tensor(-11.1240, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5715, dtype=torch.float64) delta_t tensor(0.3314, dtype=torch.float64)
15 gae_duplicate tensor(0.2750, dtype=torch.float64) tensor(-7.6283, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3787, dtype=torch.float64) delta_t tensor(0.1689, dtype=torch.float64)
14 gae_duplicate tensor(-0.5994, dtype=torch.float64) tensor(-3.9675, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5350, dtype=torch.float64) delta_t tensor(0.3064, dtype=torch.float64)
13 gae_duplicate tensor(0.0528, dtype=torch.float64) tensor(-6.2698, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6406, dtype=torch.float64) delta_t tensor(0.4949, dtype=torch.float64)
12 gae_duplicate tensor(0.2175, dtype=torch.float64) tensor(-10.1696, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1042, dtype=torch.float64) delta_t tensor(-0.0520, dtype=torch.float64)
11 gae_duplicate tensor(-1.6660, dtype=torch.float64) tensor(-0.0995, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1111, dtype=torch.float64) delta_t tensor(-0.0418, dtype=torch.float64)
10 gae_duplicate tensor(-1.2052, dtype=torch.float64) tensor(0.7414, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7224, dtype=torch.float64) delta_t tensor(-1.8587, dtype=torch.float64)
9 gae_duplicate tensor(-3.1868, dtype=torch.float64) tensor(38.2155, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.4877, dtype=torch.float64) delta_t tensor(-1.6153, dtype=torch.float64)
8 gae_duplicate tensor(-3.5730, dtype=torch.float64) tensor(35.2496, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5831, dtype=torch.float64) delta_t tensor(-0.6574, dtype=torch.float64)
7 gae_duplicate tensor(-1.6678, dtype=torch.float64) tensor(16.3344, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2232, dtype=torch.float64) delta_t tensor(-0.3269, dtype=torch.float64)
6 gae_duplicate tensor(-2.1538, dtype=torch.float64) tensor(8.4938, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6504, dtype=torch.float64) delta_t tensor(-0.7350, dtype=torch.float64)
5 gae_duplicate tensor(-3.5239, dtype=torch.float64) tensor(15.0142, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0156, dtype=torch.float64) delta_t tensor(-0.0598, dtype=torch.float64)
4 gae_duplicate tensor(-1.8472, dtype=torch.float64) tensor(2.7286, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0577, dtype=torch.float64) delta_t tensor(-0.0967, dtype=torch.float64)
3 gae_duplicate tensor(-0.3480, dtype=torch.float64) tensor(2.2362, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2750, dtype=torch.float64) delta_t tensor(-0.3920, dtype=torch.float64)
2 gae_duplicate tensor(-0.6935, dtype=torch.float64) tensor(8.1563, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3227.11767578125
value loss:165.78094482421875
entropies:354.5398254394531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.719585180282593 seconds
19 rew tensor(0.8227, dtype=torch.float64) delta_t tensor(0.5194, dtype=torch.float64)
19 gae_duplicate tensor(0.4637, dtype=torch.float64) tensor(-10.3307, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8384, dtype=torch.float64) delta_t tensor(0.5740, dtype=torch.float64)
18 gae_duplicate tensor(0.5360, dtype=torch.float64) tensor(-12.0144, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7845, dtype=torch.float64) delta_t tensor(0.5059, dtype=torch.float64)
17 gae_duplicate tensor(0.4617, dtype=torch.float64) tensor(-11.2449, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6884, dtype=torch.float64) delta_t tensor(0.5220, dtype=torch.float64)
16 gae_duplicate tensor(0.3210, dtype=torch.float64) tensor(-10.9705, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6495, dtype=torch.float64) delta_t tensor(0.3731, dtype=torch.float64)
15 gae_duplicate tensor(0.2849, dtype=torch.float64) tensor(-8.4795, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4887, dtype=torch.float64) delta_t tensor(0.3725, dtype=torch.float64)
14 gae_duplicate tensor(0.2012, dtype=torch.float64) tensor(-8.2832, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7310, dtype=torch.float64) delta_t tensor(0.4627, dtype=torch.float64)
13 gae_duplicate tensor(0.3322, dtype=torch.float64) tensor(-9.6178, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1180, dtype=torch.float64) delta_t tensor(-0.1572, dtype=torch.float64)
12 gae_duplicate tensor(-1.0417, dtype=torch.float64) tensor(2.0712, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0531, dtype=torch.float64) delta_t tensor(-0.3044, dtype=torch.float64)
11 gae_duplicate tensor(-0.7836, dtype=torch.float64) tensor(6.1803, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0263, dtype=torch.float64) delta_t tensor(-0.0161, dtype=torch.float64)
10 gae_duplicate tensor(-0.8116, dtype=torch.float64) tensor(0.9794, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1742, dtype=torch.float64) delta_t tensor(-0.4043, dtype=torch.float64)
9 gae_duplicate tensor(-0.6626, dtype=torch.float64) tensor(8.1756, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.8228, dtype=torch.float64) delta_t tensor(-1.7267, dtype=torch.float64)
8 gae_duplicate tensor(-4.8480, dtype=torch.float64) tensor(35.6555, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1178, dtype=torch.float64) delta_t tensor(-0.0703, dtype=torch.float64)
7 gae_duplicate tensor(-3.1853, dtype=torch.float64) tensor(5.6317, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7737, dtype=torch.float64) delta_t tensor(-0.6061, dtype=torch.float64)
6 gae_duplicate tensor(-3.8060, dtype=torch.float64) tensor(13.3299, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.4607, dtype=torch.float64) delta_t tensor(0.2145, dtype=torch.float64)
5 gae_duplicate tensor(-0.0162, dtype=torch.float64) tensor(-3.0466, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1451, dtype=torch.float64) delta_t tensor(-0.0562, dtype=torch.float64)
4 gae_duplicate tensor(-0.3674, dtype=torch.float64) tensor(0.7021, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4300, dtype=torch.float64) delta_t tensor(0.3028, dtype=torch.float64)
3 gae_duplicate tensor(0.1007, dtype=torch.float64) tensor(-5.7748, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5563, dtype=torch.float64) delta_t tensor(-0.5069, dtype=torch.float64)
2 gae_duplicate tensor(-0.7113, dtype=torch.float64) tensor(9.7519, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-242.30935668945312
value loss:129.100830078125
entropies:354.4123229980469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.574950933456421 seconds
19 rew tensor(0.8449, dtype=torch.float64) delta_t tensor(0.5277, dtype=torch.float64)
19 gae_duplicate tensor(0.4017, dtype=torch.float64) tensor(-10.4454, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8039, dtype=torch.float64) delta_t tensor(0.5433, dtype=torch.float64)
18 gae_duplicate tensor(0.3653, dtype=torch.float64) tensor(-11.4049, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7557, dtype=torch.float64) delta_t tensor(0.4625, dtype=torch.float64)
17 gae_duplicate tensor(0.4349, dtype=torch.float64) tensor(-10.0912, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6062, dtype=torch.float64) delta_t tensor(0.4252, dtype=torch.float64)
16 gae_duplicate tensor(0.3025, dtype=torch.float64) tensor(-9.3094, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7130, dtype=torch.float64) delta_t tensor(0.4219, dtype=torch.float64)
15 gae_duplicate tensor(0.2663, dtype=torch.float64) tensor(-9.0403, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5106, dtype=torch.float64) delta_t tensor(0.4117, dtype=torch.float64)
14 gae_duplicate tensor(0.3029, dtype=torch.float64) tensor(-9.1636, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7181, dtype=torch.float64) delta_t tensor(0.4384, dtype=torch.float64)
13 gae_duplicate tensor(0.3931, dtype=torch.float64) tensor(-9.8638, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2117, dtype=torch.float64) delta_t tensor(0.1855, dtype=torch.float64)
12 gae_duplicate tensor(-0.8430, dtype=torch.float64) tensor(-4.8456, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2550, dtype=torch.float64) delta_t tensor(0.0612, dtype=torch.float64)
11 gae_duplicate tensor(-0.7009, dtype=torch.float64) tensor(-1.7321, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3906, dtype=torch.float64) delta_t tensor(-0.4030, dtype=torch.float64)
10 gae_duplicate tensor(-1.0993, dtype=torch.float64) tensor(7.8041, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0663, dtype=torch.float64) delta_t tensor(-0.2136, dtype=torch.float64)
9 gae_duplicate tensor(-1.0720, dtype=torch.float64) tensor(4.8385, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2918, dtype=torch.float64) delta_t tensor(-1.2634, dtype=torch.float64)
8 gae_duplicate tensor(-4.5953, dtype=torch.float64) tensor(23.9279, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6694, dtype=torch.float64) delta_t tensor(-0.7999, dtype=torch.float64)
7 gae_duplicate tensor(-3.5631, dtype=torch.float64) tensor(18.3282, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7654, dtype=torch.float64) delta_t tensor(-0.6999, dtype=torch.float64)
6 gae_duplicate tensor(-2.3595, dtype=torch.float64) tensor(15.8588, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3463, dtype=torch.float64) delta_t tensor(-0.5378, dtype=torch.float64)
5 gae_duplicate tensor(-2.4006, dtype=torch.float64) tensor(12.3814, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0987, dtype=torch.float64) delta_t tensor(0.1066, dtype=torch.float64)
4 gae_duplicate tensor(-0.4918, dtype=torch.float64) tensor(-1.1907, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1477, dtype=torch.float64) delta_t tensor(0.0670, dtype=torch.float64)
3 gae_duplicate tensor(-0.6728, dtype=torch.float64) tensor(-1.9049, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2643, dtype=torch.float64) delta_t tensor(-0.2948, dtype=torch.float64)
2 gae_duplicate tensor(-0.5681, dtype=torch.float64) tensor(5.5102, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-617.1033325195312
value loss:148.13104248046875
entropies:354.14190673828125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3953.3711)
ToM Target loss= tensor(3539.6782)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.4392969608306885 seconds
19 rew tensor(0.8048, dtype=torch.float64) delta_t tensor(0.4764, dtype=torch.float64)
19 gae_duplicate tensor(0.3697, dtype=torch.float64) tensor(-9.4058, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5280, dtype=torch.float64) delta_t tensor(0.2711, dtype=torch.float64)
18 gae_duplicate tensor(-0.5944, dtype=torch.float64) tensor(-6.7770, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6131, dtype=torch.float64) delta_t tensor(0.3233, dtype=torch.float64)
17 gae_duplicate tensor(-0.5817, dtype=torch.float64) tensor(-6.6766, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6483, dtype=torch.float64) delta_t tensor(0.4728, dtype=torch.float64)
16 gae_duplicate tensor(0.2749, dtype=torch.float64) tensor(-9.6817, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6237, dtype=torch.float64) delta_t tensor(0.3889, dtype=torch.float64)
15 gae_duplicate tensor(0.3269, dtype=torch.float64) tensor(-8.8838, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5206, dtype=torch.float64) delta_t tensor(0.4135, dtype=torch.float64)
14 gae_duplicate tensor(0.3620, dtype=torch.float64) tensor(-9.1765, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6215, dtype=torch.float64) delta_t tensor(0.3657, dtype=torch.float64)
13 gae_duplicate tensor(0.2147, dtype=torch.float64) tensor(-7.8240, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2897, dtype=torch.float64) delta_t tensor(0.2314, dtype=torch.float64)
12 gae_duplicate tensor(-0.4076, dtype=torch.float64) tensor(-5.5440, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0133, dtype=torch.float64) delta_t tensor(-0.1511, dtype=torch.float64)
11 gae_duplicate tensor(-0.8829, dtype=torch.float64) tensor(2.2529, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1759, dtype=torch.float64) delta_t tensor(-0.2329, dtype=torch.float64)
10 gae_duplicate tensor(-1.2694, dtype=torch.float64) tensor(4.7750, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5098, dtype=torch.float64) delta_t tensor(-1.6557, dtype=torch.float64)
9 gae_duplicate tensor(-5.3195, dtype=torch.float64) tensor(33.7862, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.3277, dtype=torch.float64) delta_t tensor(-2.3484, dtype=torch.float64)
8 gae_duplicate tensor(-5.3672, dtype=torch.float64) tensor(48.1842, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2236, dtype=torch.float64) delta_t tensor(0.1243, dtype=torch.float64)
7 gae_duplicate tensor(-1.9447, dtype=torch.float64) tensor(2.5768, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0293, dtype=torch.float64) delta_t tensor(0.0599, dtype=torch.float64)
6 gae_duplicate tensor(-0.8864, dtype=torch.float64) tensor(-0.9686, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2914, dtype=torch.float64) delta_t tensor(0.1512, dtype=torch.float64)
5 gae_duplicate tensor(-0.1636, dtype=torch.float64) tensor(-3.1420, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1515, dtype=torch.float64) delta_t tensor(0.1436, dtype=torch.float64)
4 gae_duplicate tensor(-0.3869, dtype=torch.float64) tensor(-3.0572, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2432, dtype=torch.float64) delta_t tensor(0.0650, dtype=torch.float64)
3 gae_duplicate tensor(-0.1226, dtype=torch.float64) tensor(-1.4555, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4154, dtype=torch.float64) delta_t tensor(-0.3637, dtype=torch.float64)
2 gae_duplicate tensor(-0.6583, dtype=torch.float64) tensor(7.1543, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1506.9788818359375
value loss:188.07070922851562
entropies:354.0622863769531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 6.248166084289551 seconds
19 rew tensor(0.8165, dtype=torch.float64) delta_t tensor(0.5066, dtype=torch.float64)
19 gae_duplicate tensor(0.4227, dtype=torch.float64) tensor(-9.9270, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7729, dtype=torch.float64) delta_t tensor(0.4923, dtype=torch.float64)
18 gae_duplicate tensor(0.2141, dtype=torch.float64) tensor(-10.3615, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7646, dtype=torch.float64) delta_t tensor(0.4814, dtype=torch.float64)
17 gae_duplicate tensor(0.4222, dtype=torch.float64) tensor(-10.7933, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6866, dtype=torch.float64) delta_t tensor(0.4538, dtype=torch.float64)
16 gae_duplicate tensor(0.3430, dtype=torch.float64) tensor(-9.9977, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6804, dtype=torch.float64) delta_t tensor(0.5112, dtype=torch.float64)
15 gae_duplicate tensor(0.4444, dtype=torch.float64) tensor(-10.6336, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4104, dtype=torch.float64) delta_t tensor(0.2365, dtype=torch.float64)
14 gae_duplicate tensor(-0.7286, dtype=torch.float64) tensor(-5.7143, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6040, dtype=torch.float64) delta_t tensor(0.4260, dtype=torch.float64)
13 gae_duplicate tensor(0.2370, dtype=torch.float64) tensor(-8.7600, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5825, dtype=torch.float64) delta_t tensor(0.4314, dtype=torch.float64)
12 gae_duplicate tensor(0.0585, dtype=torch.float64) tensor(-9.0976, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0483, dtype=torch.float64) delta_t tensor(0.0397, dtype=torch.float64)
11 gae_duplicate tensor(-1.6052, dtype=torch.float64) tensor(-1.9921, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0423, dtype=torch.float64) delta_t tensor(-0.1093, dtype=torch.float64)
10 gae_duplicate tensor(-2.4916, dtype=torch.float64) tensor(2.7805, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.9935, dtype=torch.float64) delta_t tensor(-2.9661, dtype=torch.float64)
9 gae_duplicate tensor(-5.1709, dtype=torch.float64) tensor(59.1759, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0619, dtype=torch.float64) delta_t tensor(-1.2102, dtype=torch.float64)
8 gae_duplicate tensor(-3.5347, dtype=torch.float64) tensor(29.7420, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6525, dtype=torch.float64) delta_t tensor(-0.6003, dtype=torch.float64)
7 gae_duplicate tensor(-3.5430, dtype=torch.float64) tensor(16.0969, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1233, dtype=torch.float64) delta_t tensor(-0.2143, dtype=torch.float64)
6 gae_duplicate tensor(-1.1314, dtype=torch.float64) tensor(5.6794, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2428, dtype=torch.float64) delta_t tensor(-0.2621, dtype=torch.float64)
5 gae_duplicate tensor(-1.4311, dtype=torch.float64) tensor(5.6590, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2288, dtype=torch.float64) delta_t tensor(0.1308, dtype=torch.float64)
4 gae_duplicate tensor(-0.4701, dtype=torch.float64) tensor(-1.7992, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1845, dtype=torch.float64) delta_t tensor(0.1056, dtype=torch.float64)
3 gae_duplicate tensor(-0.2502, dtype=torch.float64) tensor(-2.3424, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3061, dtype=torch.float64) delta_t tensor(-0.4847, dtype=torch.float64)
2 gae_duplicate tensor(-0.6907, dtype=torch.float64) tensor(9.5921, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2650.189453125
value loss:220.52928161621094
entropies:354.1279602050781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.378050804138184 seconds
19 rew tensor(0.8230, dtype=torch.float64) delta_t tensor(0.5494, dtype=torch.float64)
19 gae_duplicate tensor(0.4541, dtype=torch.float64) tensor(-11.0481, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7846, dtype=torch.float64) delta_t tensor(0.5091, dtype=torch.float64)
18 gae_duplicate tensor(0.3340, dtype=torch.float64) tensor(-10.8361, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7215, dtype=torch.float64) delta_t tensor(0.4814, dtype=torch.float64)
17 gae_duplicate tensor(0.4680, dtype=torch.float64) tensor(-10.5931, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4029, dtype=torch.float64) delta_t tensor(0.2612, dtype=torch.float64)
16 gae_duplicate tensor(-0.7295, dtype=torch.float64) tensor(-6.5841, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6454, dtype=torch.float64) delta_t tensor(0.4645, dtype=torch.float64)
15 gae_duplicate tensor(0.3344, dtype=torch.float64) tensor(-10.1030, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3747, dtype=torch.float64) delta_t tensor(0.2977, dtype=torch.float64)
14 gae_duplicate tensor(-0.5519, dtype=torch.float64) tensor(-7.0815, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5929, dtype=torch.float64) delta_t tensor(0.3645, dtype=torch.float64)
13 gae_duplicate tensor(0.2543, dtype=torch.float64) tensor(-8.0103, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4697, dtype=torch.float64) delta_t tensor(0.4299, dtype=torch.float64)
12 gae_duplicate tensor(0.2575, dtype=torch.float64) tensor(-9.5714, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0997, dtype=torch.float64) delta_t tensor(-0.1664, dtype=torch.float64)
11 gae_duplicate tensor(-0.8972, dtype=torch.float64) tensor(2.0729, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0880, dtype=torch.float64) delta_t tensor(-0.1239, dtype=torch.float64)
10 gae_duplicate tensor(-1.3610, dtype=torch.float64) tensor(2.7791, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7669, dtype=torch.float64) delta_t tensor(-0.8126, dtype=torch.float64)
9 gae_duplicate tensor(-2.4885, dtype=torch.float64) tensor(16.2250, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8239, dtype=torch.float64) delta_t tensor(-0.8374, dtype=torch.float64)
8 gae_duplicate tensor(-2.8489, dtype=torch.float64) tensor(17.4504, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0026, dtype=torch.float64) delta_t tensor(-0.0650, dtype=torch.float64)
7 gae_duplicate tensor(-2.5303, dtype=torch.float64) tensor(2.8988, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4823, dtype=torch.float64) delta_t tensor(-0.4564, dtype=torch.float64)
6 gae_duplicate tensor(-2.4271, dtype=torch.float64) tensor(9.7498, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6421, dtype=torch.float64) delta_t tensor(-0.7001, dtype=torch.float64)
5 gae_duplicate tensor(-4.3844, dtype=torch.float64) tensor(14.9107, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1217, dtype=torch.float64) delta_t tensor(0.1277, dtype=torch.float64)
4 gae_duplicate tensor(-0.1910, dtype=torch.float64) tensor(-0.9533, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1771, dtype=torch.float64) delta_t tensor(0.0013, dtype=torch.float64)
3 gae_duplicate tensor(-0.7344, dtype=torch.float64) tensor(-0.3464, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2621, dtype=torch.float64) delta_t tensor(-0.4454, dtype=torch.float64)
2 gae_duplicate tensor(-0.6230, dtype=torch.float64) tensor(9.0031, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-93.57804870605469
value loss:120.37580871582031
entropies:354.07098388671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.693740129470825 seconds
19 rew tensor(0.8195, dtype=torch.float64) delta_t tensor(0.5139, dtype=torch.float64)
19 gae_duplicate tensor(0.3870, dtype=torch.float64) tensor(-9.6235, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7969, dtype=torch.float64) delta_t tensor(0.4732, dtype=torch.float64)
18 gae_duplicate tensor(0.4182, dtype=torch.float64) tensor(-10.8280, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8077, dtype=torch.float64) delta_t tensor(0.5944, dtype=torch.float64)
17 gae_duplicate tensor(0.4238, dtype=torch.float64) tensor(-12.2754, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6631, dtype=torch.float64) delta_t tensor(0.4223, dtype=torch.float64)
16 gae_duplicate tensor(0.2422, dtype=torch.float64) tensor(-9.5020, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5882, dtype=torch.float64) delta_t tensor(0.3954, dtype=torch.float64)
15 gae_duplicate tensor(0.2357, dtype=torch.float64) tensor(-8.8822, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4459, dtype=torch.float64) delta_t tensor(0.3297, dtype=torch.float64)
14 gae_duplicate tensor(-0.7863, dtype=torch.float64) tensor(-7.5478, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5270, dtype=torch.float64) delta_t tensor(0.4252, dtype=torch.float64)
13 gae_duplicate tensor(0.2963, dtype=torch.float64) tensor(-8.9384, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5413, dtype=torch.float64) delta_t tensor(0.3701, dtype=torch.float64)
12 gae_duplicate tensor(0.0895, dtype=torch.float64) tensor(-8.1534, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6663, dtype=torch.float64) delta_t tensor(-0.6639, dtype=torch.float64)
11 gae_duplicate tensor(-2.0111, dtype=torch.float64) tensor(12.3931, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1668, dtype=torch.float64) delta_t tensor(-0.2961, dtype=torch.float64)
10 gae_duplicate tensor(-1.8803, dtype=torch.float64) tensor(6.9320, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.0339, dtype=torch.float64) delta_t tensor(-0.9583, dtype=torch.float64)
9 gae_duplicate tensor(-2.6966, dtype=torch.float64) tensor(20.8557, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1957, dtype=torch.float64) delta_t tensor(-1.2770, dtype=torch.float64)
8 gae_duplicate tensor(-4.0785, dtype=torch.float64) tensor(26.3112, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2014, dtype=torch.float64) delta_t tensor(-1.0609, dtype=torch.float64)
7 gae_duplicate tensor(-2.9766, dtype=torch.float64) tensor(23.3758, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1591, dtype=torch.float64) delta_t tensor(-0.2574, dtype=torch.float64)
6 gae_duplicate tensor(-1.8531, dtype=torch.float64) tensor(7.4826, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6891, dtype=torch.float64) delta_t tensor(-0.7436, dtype=torch.float64)
5 gae_duplicate tensor(-2.8176, dtype=torch.float64) tensor(14.7761, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3361, dtype=torch.float64) delta_t tensor(0.1817, dtype=torch.float64)
4 gae_duplicate tensor(-0.8685, dtype=torch.float64) tensor(-2.3732, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1997, dtype=torch.float64) delta_t tensor(-0.2895, dtype=torch.float64)
3 gae_duplicate tensor(-0.5709, dtype=torch.float64) tensor(5.3220, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0019, dtype=torch.float64) delta_t tensor(-0.2845, dtype=torch.float64)
2 gae_duplicate tensor(-0.4745, dtype=torch.float64) tensor(5.9867, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2542.421142578125
value loss:155.96983337402344
entropies:354.12945556640625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.331156969070435 seconds
19 rew tensor(0.8497, dtype=torch.float64) delta_t tensor(0.5092, dtype=torch.float64)
19 gae_duplicate tensor(0.3828, dtype=torch.float64) tensor(-10.0000, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6171, dtype=torch.float64) delta_t tensor(0.3760, dtype=torch.float64)
18 gae_duplicate tensor(-0.6170, dtype=torch.float64) tensor(-8.5156, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8285, dtype=torch.float64) delta_t tensor(0.5206, dtype=torch.float64)
17 gae_duplicate tensor(0.3543, dtype=torch.float64) tensor(-11.2315, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6951, dtype=torch.float64) delta_t tensor(0.5288, dtype=torch.float64)
16 gae_duplicate tensor(0.3115, dtype=torch.float64) tensor(-11.3269, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4798, dtype=torch.float64) delta_t tensor(0.2298, dtype=torch.float64)
15 gae_duplicate tensor(-0.5888, dtype=torch.float64) tensor(-6.0407, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5535, dtype=torch.float64) delta_t tensor(0.5104, dtype=torch.float64)
14 gae_duplicate tensor(0.4184, dtype=torch.float64) tensor(-11.1220, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2868, dtype=torch.float64) delta_t tensor(0.0943, dtype=torch.float64)
13 gae_duplicate tensor(-0.6348, dtype=torch.float64) tensor(-3.2621, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2834, dtype=torch.float64) delta_t tensor(0.2754, dtype=torch.float64)
12 gae_duplicate tensor(-0.4437, dtype=torch.float64) tensor(-5.9871, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0875, dtype=torch.float64) delta_t tensor(-0.0572, dtype=torch.float64)
11 gae_duplicate tensor(-0.9220, dtype=torch.float64) tensor(0.5625, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3970, dtype=torch.float64) delta_t tensor(-0.3560, dtype=torch.float64)
10 gae_duplicate tensor(-0.9308, dtype=torch.float64) tensor(6.5693, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9189, dtype=torch.float64) delta_t tensor(-0.9760, dtype=torch.float64)
9 gae_duplicate tensor(-3.8920, dtype=torch.float64) tensor(18.5744, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0404, dtype=torch.float64) delta_t tensor(-0.9499, dtype=torch.float64)
8 gae_duplicate tensor(-3.4157, dtype=torch.float64) tensor(20.6383, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3717, dtype=torch.float64) delta_t tensor(-0.3939, dtype=torch.float64)
7 gae_duplicate tensor(-2.1667, dtype=torch.float64) tensor(10.0907, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0120, dtype=torch.float64) delta_t tensor(0.0925, dtype=torch.float64)
6 gae_duplicate tensor(-1.0300, dtype=torch.float64) tensor(-0.6182, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0079, dtype=torch.float64) delta_t tensor(-0.0805, dtype=torch.float64)
5 gae_duplicate tensor(-0.5824, dtype=torch.float64) tensor(1.5117, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1827, dtype=torch.float64) delta_t tensor(0.2219, dtype=torch.float64)
4 gae_duplicate tensor(-0.1861, dtype=torch.float64) tensor(-4.1540, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1463, dtype=torch.float64) delta_t tensor(0.1288, dtype=torch.float64)
3 gae_duplicate tensor(-0.4367, dtype=torch.float64) tensor(-3.1477, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2964, dtype=torch.float64) delta_t tensor(-0.3529, dtype=torch.float64)
2 gae_duplicate tensor(-0.6305, dtype=torch.float64) tensor(6.5351, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:494.2274169921875
value loss:111.69499206542969
entropies:354.2709655761719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3950.4702)
ToM Target loss= tensor(3566.2498)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.052497863769531 seconds
19 rew tensor(0.8027, dtype=torch.float64) delta_t tensor(0.4537, dtype=torch.float64)
19 gae_duplicate tensor(0.3048, dtype=torch.float64) tensor(-9.0962, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7451, dtype=torch.float64) delta_t tensor(0.4205, dtype=torch.float64)
18 gae_duplicate tensor(0.2872, dtype=torch.float64) tensor(-9.2493, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7459, dtype=torch.float64) delta_t tensor(0.4927, dtype=torch.float64)
17 gae_duplicate tensor(0.4450, dtype=torch.float64) tensor(-10.2778, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7005, dtype=torch.float64) delta_t tensor(0.4549, dtype=torch.float64)
16 gae_duplicate tensor(0.3304, dtype=torch.float64) tensor(-10.1203, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6085, dtype=torch.float64) delta_t tensor(0.3967, dtype=torch.float64)
15 gae_duplicate tensor(0.2280, dtype=torch.float64) tensor(-8.8077, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2772, dtype=torch.float64) delta_t tensor(0.0482, dtype=torch.float64)
14 gae_duplicate tensor(-0.6966, dtype=torch.float64) tensor(-1.4979, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6059, dtype=torch.float64) delta_t tensor(0.4590, dtype=torch.float64)
13 gae_duplicate tensor(0.3418, dtype=torch.float64) tensor(-9.4218, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2178, dtype=torch.float64) delta_t tensor(0.0973, dtype=torch.float64)
12 gae_duplicate tensor(-0.8895, dtype=torch.float64) tensor(-3.0467, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3924, dtype=torch.float64) delta_t tensor(0.3862, dtype=torch.float64)
11 gae_duplicate tensor(-0.3298, dtype=torch.float64) tensor(-7.9603, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4963, dtype=torch.float64) delta_t tensor(0.3668, dtype=torch.float64)
10 gae_duplicate tensor(0.2000, dtype=torch.float64) tensor(-8.3324, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.9432, dtype=torch.float64) delta_t tensor(-2.8862, dtype=torch.float64)
9 gae_duplicate tensor(-4.4627, dtype=torch.float64) tensor(54.4468, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3848, dtype=torch.float64) delta_t tensor(-1.4878, dtype=torch.float64)
8 gae_duplicate tensor(-5.0933, dtype=torch.float64) tensor(33.9745, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7982, dtype=torch.float64) delta_t tensor(-0.6778, dtype=torch.float64)
7 gae_duplicate tensor(-3.4277, dtype=torch.float64) tensor(17.1853, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1606, dtype=torch.float64) delta_t tensor(-0.2873, dtype=torch.float64)
6 gae_duplicate tensor(-2.0014, dtype=torch.float64) tensor(7.2396, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2807, dtype=torch.float64) delta_t tensor(-0.1585, dtype=torch.float64)
5 gae_duplicate tensor(-1.4714, dtype=torch.float64) tensor(3.6666, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3995, dtype=torch.float64) delta_t tensor(0.3371, dtype=torch.float64)
4 gae_duplicate tensor(0.1079, dtype=torch.float64) tensor(-6.0572, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0059, dtype=torch.float64) delta_t tensor(-0.1327, dtype=torch.float64)
3 gae_duplicate tensor(-0.6015, dtype=torch.float64) tensor(1.9828, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1492, dtype=torch.float64) delta_t tensor(-0.1334, dtype=torch.float64)
2 gae_duplicate tensor(-0.5898, dtype=torch.float64) tensor(2.8272, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2118.29296875
value loss:221.636474609375
entropies:354.5008239746094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.306733846664429 seconds
19 rew tensor(0.8200, dtype=torch.float64) delta_t tensor(0.4614, dtype=torch.float64)
19 gae_duplicate tensor(0.3613, dtype=torch.float64) tensor(-8.9597, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7972, dtype=torch.float64) delta_t tensor(0.6011, dtype=torch.float64)
18 gae_duplicate tensor(0.4351, dtype=torch.float64) tensor(-13.1184, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7188, dtype=torch.float64) delta_t tensor(0.4707, dtype=torch.float64)
17 gae_duplicate tensor(0.2716, dtype=torch.float64) tensor(-10.4290, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4438, dtype=torch.float64) delta_t tensor(0.3110, dtype=torch.float64)
16 gae_duplicate tensor(-0.6126, dtype=torch.float64) tensor(-7.0592, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6722, dtype=torch.float64) delta_t tensor(0.4558, dtype=torch.float64)
15 gae_duplicate tensor(0.2765, dtype=torch.float64) tensor(-9.6044, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3543, dtype=torch.float64) delta_t tensor(0.3529, dtype=torch.float64)
14 gae_duplicate tensor(-0.5717, dtype=torch.float64) tensor(-7.7539, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5517, dtype=torch.float64) delta_t tensor(0.3578, dtype=torch.float64)
13 gae_duplicate tensor(0.2644, dtype=torch.float64) tensor(-7.6742, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1229, dtype=torch.float64) delta_t tensor(0.1659, dtype=torch.float64)
12 gae_duplicate tensor(-0.5220, dtype=torch.float64) tensor(-3.8975, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5259, dtype=torch.float64) delta_t tensor(0.3585, dtype=torch.float64)
11 gae_duplicate tensor(0.2331, dtype=torch.float64) tensor(-7.6511, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0832, dtype=torch.float64) delta_t tensor(0.1605, dtype=torch.float64)
10 gae_duplicate tensor(-1.0401, dtype=torch.float64) tensor(-3.4428, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.2485, dtype=torch.float64) delta_t tensor(-2.3307, dtype=torch.float64)
9 gae_duplicate tensor(-4.7932, dtype=torch.float64) tensor(44.8996, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1136, dtype=torch.float64) delta_t tensor(0.0033, dtype=torch.float64)
8 gae_duplicate tensor(-1.1028, dtype=torch.float64) tensor(4.5114, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2493, dtype=torch.float64) delta_t tensor(-0.3075, dtype=torch.float64)
7 gae_duplicate tensor(-1.6276, dtype=torch.float64) tensor(7.1937, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0593, dtype=torch.float64) delta_t tensor(0.2454, dtype=torch.float64)
6 gae_duplicate tensor(-0.2146, dtype=torch.float64) tensor(-3.9695, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0245, dtype=torch.float64) delta_t tensor(-0.1121, dtype=torch.float64)
5 gae_duplicate tensor(-0.5454, dtype=torch.float64) tensor(2.0484, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0715, dtype=torch.float64) delta_t tensor(0.1383, dtype=torch.float64)
4 gae_duplicate tensor(-0.4298, dtype=torch.float64) tensor(-2.6062, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1721, dtype=torch.float64) delta_t tensor(0.0288, dtype=torch.float64)
3 gae_duplicate tensor(-0.6113, dtype=torch.float64) tensor(-0.7495, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3145, dtype=torch.float64) delta_t tensor(-0.3556, dtype=torch.float64)
2 gae_duplicate tensor(-0.4729, dtype=torch.float64) tensor(7.0958, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1047.1949462890625
value loss:119.10455322265625
entropies:354.79022216796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.371906995773315 seconds
19 rew tensor(0.8344, dtype=torch.float64) delta_t tensor(0.4225, dtype=torch.float64)
19 gae_duplicate tensor(0.3312, dtype=torch.float64) tensor(-8.4610, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7951, dtype=torch.float64) delta_t tensor(0.5614, dtype=torch.float64)
18 gae_duplicate tensor(0.3433, dtype=torch.float64) tensor(-11.6705, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5865, dtype=torch.float64) delta_t tensor(0.2406, dtype=torch.float64)
17 gae_duplicate tensor(-0.4732, dtype=torch.float64) tensor(-6.0194, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6701, dtype=torch.float64) delta_t tensor(0.5134, dtype=torch.float64)
16 gae_duplicate tensor(0.1419, dtype=torch.float64) tensor(-10.7218, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6993, dtype=torch.float64) delta_t tensor(0.3314, dtype=torch.float64)
15 gae_duplicate tensor(0.2868, dtype=torch.float64) tensor(-7.6002, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5492, dtype=torch.float64) delta_t tensor(0.6000, dtype=torch.float64)
14 gae_duplicate tensor(0.4171, dtype=torch.float64) tensor(-12.5264, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6460, dtype=torch.float64) delta_t tensor(0.2867, dtype=torch.float64)
13 gae_duplicate tensor(0.1639, dtype=torch.float64) tensor(-6.9292, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2110, dtype=torch.float64) delta_t tensor(0.3366, dtype=torch.float64)
12 gae_duplicate tensor(-0.6725, dtype=torch.float64) tensor(-7.3897, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0586, dtype=torch.float64) delta_t tensor(-0.2374, dtype=torch.float64)
11 gae_duplicate tensor(-0.9103, dtype=torch.float64) tensor(3.7080, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6378, dtype=torch.float64) delta_t tensor(-0.4079, dtype=torch.float64)
10 gae_duplicate tensor(-1.8548, dtype=torch.float64) tensor(8.5636, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8113, dtype=torch.float64) delta_t tensor(-1.0865, dtype=torch.float64)
9 gae_duplicate tensor(-2.9930, dtype=torch.float64) tensor(22.6139, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6992, dtype=torch.float64) delta_t tensor(-0.3567, dtype=torch.float64)
8 gae_duplicate tensor(-2.2823, dtype=torch.float64) tensor(8.9903, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5978, dtype=torch.float64) delta_t tensor(0.4343, dtype=torch.float64)
7 gae_duplicate tensor(0.0743, dtype=torch.float64) tensor(-7.8522, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5140, dtype=torch.float64) delta_t tensor(-0.1910, dtype=torch.float64)
6 gae_duplicate tensor(-2.2386, dtype=torch.float64) tensor(2.6008, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3839, dtype=torch.float64) delta_t tensor(0.1141, dtype=torch.float64)
5 gae_duplicate tensor(-0.1215, dtype=torch.float64) tensor(-1.8947, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1747, dtype=torch.float64) delta_t tensor(0.0902, dtype=torch.float64)
4 gae_duplicate tensor(-0.5905, dtype=torch.float64) tensor(-2.1256, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4361, dtype=torch.float64) delta_t tensor(0.2986, dtype=torch.float64)
3 gae_duplicate tensor(0.0744, dtype=torch.float64) tensor(-5.8770, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5646, dtype=torch.float64) delta_t tensor(-0.3629, dtype=torch.float64)
2 gae_duplicate tensor(-0.6172, dtype=torch.float64) tensor(6.3607, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1860.5963134765625
value loss:91.21149444580078
entropies:354.9229431152344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.872974872589111 seconds
19 rew tensor(0.8465, dtype=torch.float64) delta_t tensor(0.4170, dtype=torch.float64)
19 gae_duplicate tensor(0.2777, dtype=torch.float64) tensor(-8.3491, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7557, dtype=torch.float64) delta_t tensor(0.4811, dtype=torch.float64)
18 gae_duplicate tensor(0.3286, dtype=torch.float64) tensor(-10.1523, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7539, dtype=torch.float64) delta_t tensor(0.4167, dtype=torch.float64)
17 gae_duplicate tensor(0.3062, dtype=torch.float64) tensor(-9.2440, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5994, dtype=torch.float64) delta_t tensor(0.4805, dtype=torch.float64)
16 gae_duplicate tensor(0.2821, dtype=torch.float64) tensor(-10.3133, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3679, dtype=torch.float64) delta_t tensor(0.1610, dtype=torch.float64)
15 gae_duplicate tensor(-0.6434, dtype=torch.float64) tensor(-4.2864, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4725, dtype=torch.float64) delta_t tensor(0.4655, dtype=torch.float64)
14 gae_duplicate tensor(0.2526, dtype=torch.float64) tensor(-9.5626, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5725, dtype=torch.float64) delta_t tensor(0.3840, dtype=torch.float64)
13 gae_duplicate tensor(0.1860, dtype=torch.float64) tensor(-8.4564, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2249, dtype=torch.float64) delta_t tensor(0.1260, dtype=torch.float64)
12 gae_duplicate tensor(-0.7044, dtype=torch.float64) tensor(-3.0998, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8200, dtype=torch.float64) delta_t tensor(-0.8536, dtype=torch.float64)
11 gae_duplicate tensor(-2.0003, dtype=torch.float64) tensor(17.0522, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2052, dtype=torch.float64) delta_t tensor(0.2241, dtype=torch.float64)
10 gae_duplicate tensor(-0.6993, dtype=torch.float64) tensor(-2.9960, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3600, dtype=torch.float64) delta_t tensor(-1.4022, dtype=torch.float64)
9 gae_duplicate tensor(-3.4949, dtype=torch.float64) tensor(27.2425, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6807, dtype=torch.float64) delta_t tensor(-0.6592, dtype=torch.float64)
8 gae_duplicate tensor(-3.6843, dtype=torch.float64) tensor(16.6145, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3579, dtype=torch.float64) delta_t tensor(0.4098, dtype=torch.float64)
7 gae_duplicate tensor(0.1715, dtype=torch.float64) tensor(-6.4149, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1725, dtype=torch.float64) delta_t tensor(0.2855, dtype=torch.float64)
6 gae_duplicate tensor(0.0832, dtype=torch.float64) tensor(-6.3959, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1731, dtype=torch.float64) delta_t tensor(0.1062, dtype=torch.float64)
5 gae_duplicate tensor(-0.0955, dtype=torch.float64) tensor(-2.6673, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0738, dtype=torch.float64) delta_t tensor(0.1812, dtype=torch.float64)
4 gae_duplicate tensor(-0.3639, dtype=torch.float64) tensor(-3.6730, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2659, dtype=torch.float64) delta_t tensor(0.0956, dtype=torch.float64)
3 gae_duplicate tensor(-0.3183, dtype=torch.float64) tensor(-2.3123, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4042, dtype=torch.float64) delta_t tensor(-0.2411, dtype=torch.float64)
2 gae_duplicate tensor(-0.5124, dtype=torch.float64) tensor(4.4217, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1124.0924072265625
value loss:95.53260803222656
entropies:355.1214599609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.505307197570801 seconds
19 rew tensor(0.8501, dtype=torch.float64) delta_t tensor(0.3532, dtype=torch.float64)
19 gae_duplicate tensor(0.2720, dtype=torch.float64) tensor(-7.0133, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8014, dtype=torch.float64) delta_t tensor(0.5136, dtype=torch.float64)
18 gae_duplicate tensor(0.2826, dtype=torch.float64) tensor(-10.8228, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7845, dtype=torch.float64) delta_t tensor(0.3755, dtype=torch.float64)
17 gae_duplicate tensor(0.3386, dtype=torch.float64) tensor(-8.6258, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6427, dtype=torch.float64) delta_t tensor(0.5132, dtype=torch.float64)
16 gae_duplicate tensor(0.2203, dtype=torch.float64) tensor(-11.1477, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6423, dtype=torch.float64) delta_t tensor(0.2406, dtype=torch.float64)
15 gae_duplicate tensor(0.1569, dtype=torch.float64) tensor(-5.9506, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5146, dtype=torch.float64) delta_t tensor(0.5557, dtype=torch.float64)
14 gae_duplicate tensor(0.3680, dtype=torch.float64) tensor(-11.3723, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6405, dtype=torch.float64) delta_t tensor(0.2778, dtype=torch.float64)
13 gae_duplicate tensor(0.2116, dtype=torch.float64) tensor(-6.5052, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3364, dtype=torch.float64) delta_t tensor(0.4297, dtype=torch.float64)
12 gae_duplicate tensor(0.2379, dtype=torch.float64) tensor(-9.1448, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0931, dtype=torch.float64) delta_t tensor(-0.3813, dtype=torch.float64)
11 gae_duplicate tensor(-2.0315, dtype=torch.float64) tensor(7.3127, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3882, dtype=torch.float64) delta_t tensor(-0.1076, dtype=torch.float64)
10 gae_duplicate tensor(-1.7486, dtype=torch.float64) tensor(2.7107, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6327, dtype=torch.float64) delta_t tensor(-0.8512, dtype=torch.float64)
9 gae_duplicate tensor(-3.6785, dtype=torch.float64) tensor(17.8975, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.0260, dtype=torch.float64) delta_t tensor(-0.6619, dtype=torch.float64)
8 gae_duplicate tensor(-3.5347, dtype=torch.float64) tensor(14.7425, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0465, dtype=torch.float64) delta_t tensor(-0.2072, dtype=torch.float64)
7 gae_duplicate tensor(-1.1469, dtype=torch.float64) tensor(5.5882, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4939, dtype=torch.float64) delta_t tensor(-0.0777, dtype=torch.float64)
6 gae_duplicate tensor(-2.2014, dtype=torch.float64) tensor(1.6833, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2366, dtype=torch.float64) delta_t tensor(-0.0086, dtype=torch.float64)
5 gae_duplicate tensor(-0.6487, dtype=torch.float64) tensor(0.3331, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0217, dtype=torch.float64) delta_t tensor(0.1717, dtype=torch.float64)
4 gae_duplicate tensor(-0.1214, dtype=torch.float64) tensor(-3.2565, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1929, dtype=torch.float64) delta_t tensor(0.0108, dtype=torch.float64)
3 gae_duplicate tensor(-0.5333, dtype=torch.float64) tensor(-0.6838, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4093, dtype=torch.float64) delta_t tensor(-0.2796, dtype=torch.float64)
2 gae_duplicate tensor(-0.4937, dtype=torch.float64) tensor(5.4491, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:919.596923828125
value loss:94.86492919921875
entropies:355.2024841308594
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3947.9509)
ToM Target loss= tensor(3582.0713)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.566449880599976 seconds
19 rew tensor(0.7960, dtype=torch.float64) delta_t tensor(0.3871, dtype=torch.float64)
19 gae_duplicate tensor(0.1914, dtype=torch.float64) tensor(-7.5586, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7446, dtype=torch.float64) delta_t tensor(0.3589, dtype=torch.float64)
18 gae_duplicate tensor(0.1044, dtype=torch.float64) tensor(-7.8573, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7622, dtype=torch.float64) delta_t tensor(0.4122, dtype=torch.float64)
17 gae_duplicate tensor(0.3432, dtype=torch.float64) tensor(-8.7524, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6660, dtype=torch.float64) delta_t tensor(0.4015, dtype=torch.float64)
16 gae_duplicate tensor(0.2229, dtype=torch.float64) tensor(-8.6017, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5842, dtype=torch.float64) delta_t tensor(0.2662, dtype=torch.float64)
15 gae_duplicate tensor(0.1187, dtype=torch.float64) tensor(-6.1900, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2092, dtype=torch.float64) delta_t tensor(0.2266, dtype=torch.float64)
14 gae_duplicate tensor(-0.6922, dtype=torch.float64) tensor(-5.1520, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5382, dtype=torch.float64) delta_t tensor(0.2360, dtype=torch.float64)
13 gae_duplicate tensor(0.0183, dtype=torch.float64) tensor(-5.1393, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3898, dtype=torch.float64) delta_t tensor(0.4229, dtype=torch.float64)
12 gae_duplicate tensor(0.3189, dtype=torch.float64) tensor(-8.8166, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0237, dtype=torch.float64) delta_t tensor(-0.1444, dtype=torch.float64)
11 gae_duplicate tensor(-2.0692, dtype=torch.float64) tensor(1.7744, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5332, dtype=torch.float64) delta_t tensor(-0.4174, dtype=torch.float64)
10 gae_duplicate tensor(-2.1141, dtype=torch.float64) tensor(8.3471, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4101, dtype=torch.float64) delta_t tensor(-0.5324, dtype=torch.float64)
9 gae_duplicate tensor(-2.0573, dtype=torch.float64) tensor(11.1998, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.4860, dtype=torch.float64) delta_t tensor(-1.2710, dtype=torch.float64)
8 gae_duplicate tensor(-3.8705, dtype=torch.float64) tensor(27.2546, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0812, dtype=torch.float64) delta_t tensor(0.0033, dtype=torch.float64)
7 gae_duplicate tensor(-1.8275, dtype=torch.float64) tensor(2.8975, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2715, dtype=torch.float64) delta_t tensor(-0.0091, dtype=torch.float64)
6 gae_duplicate tensor(-1.9015, dtype=torch.float64) tensor(0.4815, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.2408, dtype=torch.float64) delta_t tensor(0.0633, dtype=torch.float64)
5 gae_duplicate tensor(-0.7770, dtype=torch.float64) tensor(-1.1466, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0707, dtype=torch.float64) delta_t tensor(0.0669, dtype=torch.float64)
4 gae_duplicate tensor(-0.3713, dtype=torch.float64) tensor(-1.3206, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2063, dtype=torch.float64) delta_t tensor(0.0579, dtype=torch.float64)
3 gae_duplicate tensor(-0.1735, dtype=torch.float64) tensor(-1.2358, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4142, dtype=torch.float64) delta_t tensor(-0.2405, dtype=torch.float64)
2 gae_duplicate tensor(-0.6190, dtype=torch.float64) tensor(4.5884, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:186.39389038085938
value loss:107.3247299194336
entropies:355.2099304199219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.517246961593628 seconds
19 rew tensor(0.8615, dtype=torch.float64) delta_t tensor(0.3477, dtype=torch.float64)
19 gae_duplicate tensor(0.2678, dtype=torch.float64) tensor(-6.9542, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5712, dtype=torch.float64) delta_t tensor(0.1901, dtype=torch.float64)
18 gae_duplicate tensor(-0.8272, dtype=torch.float64) tensor(-4.1722, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7975, dtype=torch.float64) delta_t tensor(0.3713, dtype=torch.float64)
17 gae_duplicate tensor(0.2170, dtype=torch.float64) tensor(-7.5987, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6497, dtype=torch.float64) delta_t tensor(0.3667, dtype=torch.float64)
16 gae_duplicate tensor(0.2304, dtype=torch.float64) tensor(-7.7644, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4924, dtype=torch.float64) delta_t tensor(0.1455, dtype=torch.float64)
15 gae_duplicate tensor(-0.7422, dtype=torch.float64) tensor(-3.5666, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1934, dtype=torch.float64) delta_t tensor(0.0770, dtype=torch.float64)
14 gae_duplicate tensor(-0.7620, dtype=torch.float64) tensor(-1.6740, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4657, dtype=torch.float64) delta_t tensor(0.1141, dtype=torch.float64)
13 gae_duplicate tensor(-0.7701, dtype=torch.float64) tensor(-2.4133, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4966, dtype=torch.float64) delta_t tensor(0.3667, dtype=torch.float64)
12 gae_duplicate tensor(0.2650, dtype=torch.float64) tensor(-7.3975, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3318, dtype=torch.float64) delta_t tensor(0.1641, dtype=torch.float64)
11 gae_duplicate tensor(-0.7112, dtype=torch.float64) tensor(-4.0380, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6341, dtype=torch.float64) delta_t tensor(-0.6188, dtype=torch.float64)
10 gae_duplicate tensor(-1.6611, dtype=torch.float64) tensor(11.5808, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.1236, dtype=torch.float64) delta_t tensor(-2.2556, dtype=torch.float64)
9 gae_duplicate tensor(-3.3029, dtype=torch.float64) tensor(46.3432, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.1077, dtype=torch.float64) delta_t tensor(-2.0335, dtype=torch.float64)
8 gae_duplicate tensor(-6.1417, dtype=torch.float64) tensor(45.6767, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1786, dtype=torch.float64) delta_t tensor(-0.2148, dtype=torch.float64)
7 gae_duplicate tensor(-2.0689, dtype=torch.float64) tensor(9.0093, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2101, dtype=torch.float64) delta_t tensor(0.0099, dtype=torch.float64)
6 gae_duplicate tensor(-1.8204, dtype=torch.float64) tensor(0.4058, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1423, dtype=torch.float64) delta_t tensor(0.0139, dtype=torch.float64)
5 gae_duplicate tensor(-0.2019, dtype=torch.float64) tensor(-0.1879, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0047, dtype=torch.float64) delta_t tensor(0.1422, dtype=torch.float64)
4 gae_duplicate tensor(-0.5275, dtype=torch.float64) tensor(-2.9704, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3373, dtype=torch.float64) delta_t tensor(0.1471, dtype=torch.float64)
3 gae_duplicate tensor(-0.1657, dtype=torch.float64) tensor(-3.2623, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4826, dtype=torch.float64) delta_t tensor(-0.1075, dtype=torch.float64)
2 gae_duplicate tensor(-0.5893, dtype=torch.float64) tensor(1.7618, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3485.91162109375
value loss:202.47108459472656
entropies:355.1388854980469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.919173002243042 seconds
19 rew tensor(0.8569, dtype=torch.float64) delta_t tensor(0.3675, dtype=torch.float64)
19 gae_duplicate tensor(0.2044, dtype=torch.float64) tensor(-7.0350, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7747, dtype=torch.float64) delta_t tensor(0.4430, dtype=torch.float64)
18 gae_duplicate tensor(0.2960, dtype=torch.float64) tensor(-9.5057, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7493, dtype=torch.float64) delta_t tensor(0.3746, dtype=torch.float64)
17 gae_duplicate tensor(0.2321, dtype=torch.float64) tensor(-8.1512, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4326, dtype=torch.float64) delta_t tensor(0.2572, dtype=torch.float64)
16 gae_duplicate tensor(-0.8099, dtype=torch.float64) tensor(-5.7243, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5751, dtype=torch.float64) delta_t tensor(0.2609, dtype=torch.float64)
15 gae_duplicate tensor(0.1616, dtype=torch.float64) tensor(-5.7515, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2809, dtype=torch.float64) delta_t tensor(0.1868, dtype=torch.float64)
14 gae_duplicate tensor(-0.6343, dtype=torch.float64) tensor(-4.0577, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4353, dtype=torch.float64) delta_t tensor(0.1590, dtype=torch.float64)
13 gae_duplicate tensor(-0.7957, dtype=torch.float64) tensor(-3.7775, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1604, dtype=torch.float64) delta_t tensor(0.0248, dtype=torch.float64)
12 gae_duplicate tensor(-1.2092, dtype=torch.float64) tensor(-0.8328, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1961, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
11 gae_duplicate tensor(-0.9300, dtype=torch.float64) tensor(-0.3415, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7327, dtype=torch.float64) delta_t tensor(-0.6497, dtype=torch.float64)
10 gae_duplicate tensor(-1.7012, dtype=torch.float64) tensor(13.1884, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3310, dtype=torch.float64) delta_t tensor(-0.4275, dtype=torch.float64)
9 gae_duplicate tensor(-0.9322, dtype=torch.float64) tensor(9.7665, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8223, dtype=torch.float64) delta_t tensor(-0.6215, dtype=torch.float64)
8 gae_duplicate tensor(-3.2824, dtype=torch.float64) tensor(12.8440, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2430, dtype=torch.float64) delta_t tensor(-0.3418, dtype=torch.float64)
7 gae_duplicate tensor(-2.1634, dtype=torch.float64) tensor(8.4273, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0714, dtype=torch.float64) delta_t tensor(0.1434, dtype=torch.float64)
6 gae_duplicate tensor(-1.2167, dtype=torch.float64) tensor(-1.9172, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.0188, dtype=torch.float64) delta_t tensor(-0.1319, dtype=torch.float64)
5 gae_duplicate tensor(-0.8148, dtype=torch.float64) tensor(2.2996, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1604, dtype=torch.float64) delta_t tensor(0.1965, dtype=torch.float64)
4 gae_duplicate tensor(-0.1067, dtype=torch.float64) tensor(-3.5889, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0407, dtype=torch.float64) delta_t tensor(0.0668, dtype=torch.float64)
3 gae_duplicate tensor(-0.4895, dtype=torch.float64) tensor(-1.6360, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2484, dtype=torch.float64) delta_t tensor(-0.0733, dtype=torch.float64)
2 gae_duplicate tensor(-0.2819, dtype=torch.float64) tensor(1.1754, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:153.5273895263672
value loss:75.12290954589844
entropies:354.9969482421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.392736911773682 seconds
19 rew tensor(0.8680, dtype=torch.float64) delta_t tensor(0.2949, dtype=torch.float64)
19 gae_duplicate tensor(0.2341, dtype=torch.float64) tensor(-5.9422, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8260, dtype=torch.float64) delta_t tensor(0.4064, dtype=torch.float64)
18 gae_duplicate tensor(0.1583, dtype=torch.float64) tensor(-8.5666, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7481, dtype=torch.float64) delta_t tensor(0.2892, dtype=torch.float64)
17 gae_duplicate tensor(0.1727, dtype=torch.float64) tensor(-6.4595, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6531, dtype=torch.float64) delta_t tensor(0.3981, dtype=torch.float64)
16 gae_duplicate tensor(0.1804, dtype=torch.float64) tensor(-8.4531, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6358, dtype=torch.float64) delta_t tensor(0.2638, dtype=torch.float64)
15 gae_duplicate tensor(0.1336, dtype=torch.float64) tensor(-6.0154, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3218, dtype=torch.float64) delta_t tensor(0.1854, dtype=torch.float64)
14 gae_duplicate tensor(-0.7394, dtype=torch.float64) tensor(-4.2137, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4383, dtype=torch.float64) delta_t tensor(0.0498, dtype=torch.float64)
13 gae_duplicate tensor(-0.8102, dtype=torch.float64) tensor(-1.5725, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4378, dtype=torch.float64) delta_t tensor(0.3318, dtype=torch.float64)
12 gae_duplicate tensor(0.1679, dtype=torch.float64) tensor(-6.6794, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0324, dtype=torch.float64) delta_t tensor(-0.2182, dtype=torch.float64)
11 gae_duplicate tensor(-1.9107, dtype=torch.float64) tensor(3.9594, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2294, dtype=torch.float64) delta_t tensor(-0.2639, dtype=torch.float64)
10 gae_duplicate tensor(-1.0729, dtype=torch.float64) tensor(5.5033, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5035, dtype=torch.float64) delta_t tensor(-0.6209, dtype=torch.float64)
9 gae_duplicate tensor(-1.8568, dtype=torch.float64) tensor(12.8750, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3941, dtype=torch.float64) delta_t tensor(-0.1592, dtype=torch.float64)
8 gae_duplicate tensor(-1.9093, dtype=torch.float64) tensor(4.6515, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1059, dtype=torch.float64) delta_t tensor(-0.3348, dtype=torch.float64)
7 gae_duplicate tensor(-2.2255, dtype=torch.float64) tensor(6.6840, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8037, dtype=torch.float64) delta_t tensor(-0.5653, dtype=torch.float64)
6 gae_duplicate tensor(-4.1718, dtype=torch.float64) tensor(11.3399, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1548, dtype=torch.float64) delta_t tensor(-0.0384, dtype=torch.float64)
5 gae_duplicate tensor(-1.3881, dtype=torch.float64) tensor(1.8854, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0239, dtype=torch.float64) delta_t tensor(0.1068, dtype=torch.float64)
4 gae_duplicate tensor(-0.3801, dtype=torch.float64) tensor(-1.9414, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1610, dtype=torch.float64) delta_t tensor(0.0445, dtype=torch.float64)
3 gae_duplicate tensor(-1.0390, dtype=torch.float64) tensor(-1.2299, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2935, dtype=torch.float64) delta_t tensor(-0.2121, dtype=torch.float64)
2 gae_duplicate tensor(-0.4140, dtype=torch.float64) tensor(4.0076, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-86.74201202392578
value loss:83.2338638305664
entropies:354.787109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.748072147369385 seconds
19 rew tensor(0.8043, dtype=torch.float64) delta_t tensor(0.2262, dtype=torch.float64)
19 gae_duplicate tensor(0.1241, dtype=torch.float64) tensor(-4.4095, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7951, dtype=torch.float64) delta_t tensor(0.3197, dtype=torch.float64)
18 gae_duplicate tensor(0.1867, dtype=torch.float64) tensor(-6.7389, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7397, dtype=torch.float64) delta_t tensor(0.2991, dtype=torch.float64)
17 gae_duplicate tensor(0.2110, dtype=torch.float64) tensor(-6.5527, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6946, dtype=torch.float64) delta_t tensor(0.3311, dtype=torch.float64)
16 gae_duplicate tensor(0.1267, dtype=torch.float64) tensor(-7.0988, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5726, dtype=torch.float64) delta_t tensor(0.2161, dtype=torch.float64)
15 gae_duplicate tensor(0.0682, dtype=torch.float64) tensor(-4.9255, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3996, dtype=torch.float64) delta_t tensor(0.1767, dtype=torch.float64)
14 gae_duplicate tensor(-0.8030, dtype=torch.float64) tensor(-3.8585, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5931, dtype=torch.float64) delta_t tensor(0.0976, dtype=torch.float64)
13 gae_duplicate tensor(-0.1274, dtype=torch.float64) tensor(-2.3666, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4818, dtype=torch.float64) delta_t tensor(0.3339, dtype=torch.float64)
12 gae_duplicate tensor(0.1779, dtype=torch.float64) tensor(-6.7324, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3398, dtype=torch.float64) delta_t tensor(-0.3909, dtype=torch.float64)
11 gae_duplicate tensor(-1.7992, dtype=torch.float64) tensor(6.6957, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1619, dtype=torch.float64) delta_t tensor(-0.1952, dtype=torch.float64)
10 gae_duplicate tensor(-0.9324, dtype=torch.float64) tensor(4.8215, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.9069, dtype=torch.float64) delta_t tensor(-1.9087, dtype=torch.float64)
9 gae_duplicate tensor(-3.1485, dtype=torch.float64) tensor(38.4773, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.1348, dtype=torch.float64) delta_t tensor(-2.0105, dtype=torch.float64)
8 gae_duplicate tensor(-4.3297, dtype=torch.float64) tensor(42.2165, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4806, dtype=torch.float64) delta_t tensor(-0.5060, dtype=torch.float64)
7 gae_duplicate tensor(-2.2008, dtype=torch.float64) tensor(14.4516, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0026, dtype=torch.float64) delta_t tensor(0.1016, dtype=torch.float64)
6 gae_duplicate tensor(-0.8993, dtype=torch.float64) tensor(-0.7874, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.1611, dtype=torch.float64) delta_t tensor(0.0392, dtype=torch.float64)
5 gae_duplicate tensor(-0.2133, dtype=torch.float64) tensor(-0.8247, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1281, dtype=torch.float64) delta_t tensor(0.1641, dtype=torch.float64)
4 gae_duplicate tensor(-0.3094, dtype=torch.float64) tensor(-3.2872, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.2960, dtype=torch.float64) delta_t tensor(-0.0449, dtype=torch.float64)
3 gae_duplicate tensor(-0.2934, dtype=torch.float64) tensor(0.6393, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4165, dtype=torch.float64) delta_t tensor(-0.0404, dtype=torch.float64)
2 gae_duplicate tensor(-0.5322, dtype=torch.float64) tensor(0.6895, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3357.85791015625
value loss:159.39837646484375
entropies:354.6504211425781
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3946.0457)
ToM Target loss= tensor(3588.3665)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.781980276107788 seconds
19 rew tensor(0.8030, dtype=torch.float64) delta_t tensor(0.2392, dtype=torch.float64)
19 gae_duplicate tensor(0.1688, dtype=torch.float64) tensor(-4.6409, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7850, dtype=torch.float64) delta_t tensor(0.3021, dtype=torch.float64)
18 gae_duplicate tensor(0.2240, dtype=torch.float64) tensor(-6.4553, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7682, dtype=torch.float64) delta_t tensor(0.2868, dtype=torch.float64)
17 gae_duplicate tensor(0.2156, dtype=torch.float64) tensor(-6.0955, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7152, dtype=torch.float64) delta_t tensor(0.2834, dtype=torch.float64)
16 gae_duplicate tensor(0.2562, dtype=torch.float64) tensor(-6.1719, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7365, dtype=torch.float64) delta_t tensor(0.3585, dtype=torch.float64)
15 gae_duplicate tensor(0.2104, dtype=torch.float64) tensor(-7.5496, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6202, dtype=torch.float64) delta_t tensor(0.2348, dtype=torch.float64)
14 gae_duplicate tensor(0.0931, dtype=torch.float64) tensor(-5.2214, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5971, dtype=torch.float64) delta_t tensor(0.1996, dtype=torch.float64)
13 gae_duplicate tensor(-0.0390, dtype=torch.float64) tensor(-4.6881, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3901, dtype=torch.float64) delta_t tensor(0.2207, dtype=torch.float64)
12 gae_duplicate tensor(-0.7240, dtype=torch.float64) tensor(-4.6728, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0775, dtype=torch.float64) delta_t tensor(0.0534, dtype=torch.float64)
11 gae_duplicate tensor(-0.7231, dtype=torch.float64) tensor(-1.3915, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2235, dtype=torch.float64) delta_t tensor(-0.2811, dtype=torch.float64)
10 gae_duplicate tensor(-1.0557, dtype=torch.float64) tensor(5.6222, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.2209, dtype=torch.float64) delta_t tensor(-1.1398, dtype=torch.float64)
9 gae_duplicate tensor(-4.4244, dtype=torch.float64) tensor(23.3002, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9499, dtype=torch.float64) delta_t tensor(-0.8162, dtype=torch.float64)
8 gae_duplicate tensor(-3.5516, dtype=torch.float64) tensor(18.7998, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3796, dtype=torch.float64) delta_t tensor(-0.3565, dtype=torch.float64)
7 gae_duplicate tensor(-2.0000, dtype=torch.float64) tensor(8.5681, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5933, dtype=torch.float64) delta_t tensor(-0.4678, dtype=torch.float64)
6 gae_duplicate tensor(-2.3652, dtype=torch.float64) tensor(9.9763, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2637, dtype=torch.float64) delta_t tensor(-0.2195, dtype=torch.float64)
5 gae_duplicate tensor(-1.7779, dtype=torch.float64) tensor(5.1303, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2485, dtype=torch.float64) delta_t tensor(0.1989, dtype=torch.float64)
4 gae_duplicate tensor(-0.3310, dtype=torch.float64) tensor(-3.4156, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0057, dtype=torch.float64) delta_t tensor(-0.0019, dtype=torch.float64)
3 gae_duplicate tensor(-0.4383, dtype=torch.float64) tensor(-0.1508, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2495, dtype=torch.float64) delta_t tensor(-0.0183, dtype=torch.float64)
2 gae_duplicate tensor(-0.2952, dtype=torch.float64) tensor(0.4566, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1251.3431396484375
value loss:116.16699981689453
entropies:354.6256103515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.402655839920044 seconds
19 rew tensor(0.8490, dtype=torch.float64) delta_t tensor(0.2489, dtype=torch.float64)
19 gae_duplicate tensor(0.1628, dtype=torch.float64) tensor(-4.9680, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7782, dtype=torch.float64) delta_t tensor(0.3002, dtype=torch.float64)
18 gae_duplicate tensor(0.2274, dtype=torch.float64) tensor(-6.4080, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7779, dtype=torch.float64) delta_t tensor(0.2218, dtype=torch.float64)
17 gae_duplicate tensor(0.1641, dtype=torch.float64) tensor(-5.0020, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6874, dtype=torch.float64) delta_t tensor(0.3322, dtype=torch.float64)
16 gae_duplicate tensor(0.1635, dtype=torch.float64) tensor(-6.8595, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6669, dtype=torch.float64) delta_t tensor(0.2639, dtype=torch.float64)
15 gae_duplicate tensor(0.0500, dtype=torch.float64) tensor(-5.9739, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5206, dtype=torch.float64) delta_t tensor(0.3018, dtype=torch.float64)
14 gae_duplicate tensor(0.1515, dtype=torch.float64) tensor(-6.6332, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6275, dtype=torch.float64) delta_t tensor(0.2276, dtype=torch.float64)
13 gae_duplicate tensor(0.1411, dtype=torch.float64) tensor(-5.1833, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4270, dtype=torch.float64) delta_t tensor(0.2102, dtype=torch.float64)
12 gae_duplicate tensor(-0.0398, dtype=torch.float64) tensor(-4.5920, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.9701, dtype=torch.float64) delta_t tensor(-1.1218, dtype=torch.float64)
11 gae_duplicate tensor(-2.7308, dtype=torch.float64) tensor(20.5823, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0917, dtype=torch.float64) delta_t tensor(-0.0616, dtype=torch.float64)
10 gae_duplicate tensor(-0.9816, dtype=torch.float64) tensor(3.9052, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.8656, dtype=torch.float64) delta_t tensor(-1.9531, dtype=torch.float64)
9 gae_duplicate tensor(-3.5370, dtype=torch.float64) tensor(38.7508, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.2885, dtype=torch.float64) delta_t tensor(-1.0239, dtype=torch.float64)
8 gae_duplicate tensor(-3.2235, dtype=torch.float64) tensor(23.5109, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.3237, dtype=torch.float64) delta_t tensor(0.3436, dtype=torch.float64)
7 gae_duplicate tensor(-0.0373, dtype=torch.float64) tensor(-4.3670, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1846, dtype=torch.float64) delta_t tensor(0.0534, dtype=torch.float64)
6 gae_duplicate tensor(-1.7240, dtype=torch.float64) tensor(-1.2901, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.0054, dtype=torch.float64) delta_t tensor(-0.0937, dtype=torch.float64)
5 gae_duplicate tensor(-0.4329, dtype=torch.float64) tensor(1.6831, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2193, dtype=torch.float64) delta_t tensor(0.2696, dtype=torch.float64)
4 gae_duplicate tensor(0.1244, dtype=torch.float64) tensor(-5.1092, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1477, dtype=torch.float64) delta_t tensor(0.0925, dtype=torch.float64)
3 gae_duplicate tensor(-0.3188, dtype=torch.float64) tensor(-2.3651, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2953, dtype=torch.float64) delta_t tensor(0.0972, dtype=torch.float64)
2 gae_duplicate tensor(-0.1635, dtype=torch.float64) tensor(-2.1077, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1584.6865234375
value loss:109.18019104003906
entropies:354.51666259765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.5457751750946045 seconds
19 rew tensor(0.8584, dtype=torch.float64) delta_t tensor(0.2549, dtype=torch.float64)
19 gae_duplicate tensor(0.1948, dtype=torch.float64) tensor(-5.1161, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8608, dtype=torch.float64) delta_t tensor(0.3133, dtype=torch.float64)
18 gae_duplicate tensor(0.2722, dtype=torch.float64) tensor(-6.7088, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8264, dtype=torch.float64) delta_t tensor(0.3595, dtype=torch.float64)
17 gae_duplicate tensor(0.2636, dtype=torch.float64) tensor(-7.6226, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7419, dtype=torch.float64) delta_t tensor(0.3264, dtype=torch.float64)
16 gae_duplicate tensor(0.1453, dtype=torch.float64) tensor(-7.0863, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6294, dtype=torch.float64) delta_t tensor(0.2039, dtype=torch.float64)
15 gae_duplicate tensor(0.0850, dtype=torch.float64) tensor(-4.5516, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2264, dtype=torch.float64) delta_t tensor(-0.0483, dtype=torch.float64)
14 gae_duplicate tensor(-0.9144, dtype=torch.float64) tensor(0.3792, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3934, dtype=torch.float64) delta_t tensor(-0.0517, dtype=torch.float64)
13 gae_duplicate tensor(-0.8970, dtype=torch.float64) tensor(0.9751, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5215, dtype=torch.float64) delta_t tensor(0.3010, dtype=torch.float64)
12 gae_duplicate tensor(0.0682, dtype=torch.float64) tensor(-5.9815, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1970, dtype=torch.float64) delta_t tensor(0.0746, dtype=torch.float64)
11 gae_duplicate tensor(-0.8918, dtype=torch.float64) tensor(-2.5734, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2590, dtype=torch.float64) delta_t tensor(-0.2792, dtype=torch.float64)
10 gae_duplicate tensor(-1.5836, dtype=torch.float64) tensor(5.3909, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-2.0099, dtype=torch.float64) delta_t tensor(-1.9322, dtype=torch.float64)
9 gae_duplicate tensor(-4.9921, dtype=torch.float64) tensor(38.5774, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2537, dtype=torch.float64) delta_t tensor(-0.1339, dtype=torch.float64)
8 gae_duplicate tensor(-2.0108, dtype=torch.float64) tensor(6.0944, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0718, dtype=torch.float64) delta_t tensor(-0.9443, dtype=torch.float64)
7 gae_duplicate tensor(-2.4988, dtype=torch.float64) tensor(18.5052, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6768, dtype=torch.float64) delta_t tensor(-0.5680, dtype=torch.float64)
6 gae_duplicate tensor(-4.3558, dtype=torch.float64) tensor(13.3696, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4789, dtype=torch.float64) delta_t tensor(-0.5911, dtype=torch.float64)
5 gae_duplicate tensor(-2.0259, dtype=torch.float64) tensor(13.5014, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2957, dtype=torch.float64) delta_t tensor(0.2671, dtype=torch.float64)
4 gae_duplicate tensor(-0.0704, dtype=torch.float64) tensor(-3.9965, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0415, dtype=torch.float64) delta_t tensor(-0.0406, dtype=torch.float64)
3 gae_duplicate tensor(-0.4920, dtype=torch.float64) tensor(0.3493, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1471, dtype=torch.float64) delta_t tensor(0.0994, dtype=torch.float64)
2 gae_duplicate tensor(-0.1956, dtype=torch.float64) tensor(-1.8117, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2887.19091796875
value loss:167.2760772705078
entropies:354.5057373046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.773809194564819 seconds
19 rew tensor(0.8294, dtype=torch.float64) delta_t tensor(0.2019, dtype=torch.float64)
19 gae_duplicate tensor(0.0958, dtype=torch.float64) tensor(-3.9492, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8495, dtype=torch.float64) delta_t tensor(0.3240, dtype=torch.float64)
18 gae_duplicate tensor(0.2228, dtype=torch.float64) tensor(-6.8123, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8216, dtype=torch.float64) delta_t tensor(0.2639, dtype=torch.float64)
17 gae_duplicate tensor(0.1852, dtype=torch.float64) tensor(-5.9583, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7260, dtype=torch.float64) delta_t tensor(0.2959, dtype=torch.float64)
16 gae_duplicate tensor(0.2168, dtype=torch.float64) tensor(-6.5202, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6666, dtype=torch.float64) delta_t tensor(0.1193, dtype=torch.float64)
15 gae_duplicate tensor(0.0541, dtype=torch.float64) tensor(-2.8548, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5138, dtype=torch.float64) delta_t tensor(0.3092, dtype=torch.float64)
14 gae_duplicate tensor(0.2676, dtype=torch.float64) tensor(-6.3036, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7212, dtype=torch.float64) delta_t tensor(0.2505, dtype=torch.float64)
13 gae_duplicate tensor(0.2126, dtype=torch.float64) tensor(-5.7221, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1408, dtype=torch.float64) delta_t tensor(0.0372, dtype=torch.float64)
12 gae_duplicate tensor(-1.2548, dtype=torch.float64) tensor(-1.2251, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1083, dtype=torch.float64) delta_t tensor(-0.3960, dtype=torch.float64)
11 gae_duplicate tensor(-1.7055, dtype=torch.float64) tensor(7.8119, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1931, dtype=torch.float64) delta_t tensor(0.4351, dtype=torch.float64)
10 gae_duplicate tensor(0.2124, dtype=torch.float64) tensor(-8.2350, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8319, dtype=torch.float64) delta_t tensor(-1.0605, dtype=torch.float64)
9 gae_duplicate tensor(-2.8804, dtype=torch.float64) tensor(19.7502, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-2.2111, dtype=torch.float64) delta_t tensor(-1.6586, dtype=torch.float64)
8 gae_duplicate tensor(-4.1191, dtype=torch.float64) tensor(33.9466, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.4237, dtype=torch.float64) delta_t tensor(0.2424, dtype=torch.float64)
7 gae_duplicate tensor(-0.9072, dtype=torch.float64) tensor(-1.4582, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2437, dtype=torch.float64) delta_t tensor(0.3500, dtype=torch.float64)
6 gae_duplicate tensor(-0.5186, dtype=torch.float64) tensor(-7.1363, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(0.3402, dtype=torch.float64) delta_t tensor(0.0596, dtype=torch.float64)
5 gae_duplicate tensor(-0.0545, dtype=torch.float64) tensor(-1.8291, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0271, dtype=torch.float64) delta_t tensor(0.2074, dtype=torch.float64)
4 gae_duplicate tensor(0.0261, dtype=torch.float64) tensor(-4.3500, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3550, dtype=torch.float64) delta_t tensor(0.1030, dtype=torch.float64)
3 gae_duplicate tensor(-0.5050, dtype=torch.float64) tensor(-2.5956, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4418, dtype=torch.float64) delta_t tensor(0.0163, dtype=torch.float64)
2 gae_duplicate tensor(-0.1882, dtype=torch.float64) tensor(-0.6101, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:123.0291519165039
value loss:103.13142395019531
entropies:354.5873107910156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.449838161468506 seconds
19 rew tensor(0.8391, dtype=torch.float64) delta_t tensor(0.2100, dtype=torch.float64)
19 gae_duplicate tensor(0.0986, dtype=torch.float64) tensor(-4.1041, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8095, dtype=torch.float64) delta_t tensor(0.2611, dtype=torch.float64)
18 gae_duplicate tensor(0.1437, dtype=torch.float64) tensor(-5.5088, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7928, dtype=torch.float64) delta_t tensor(0.2460, dtype=torch.float64)
17 gae_duplicate tensor(0.2053, dtype=torch.float64) tensor(-5.5954, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7741, dtype=torch.float64) delta_t tensor(0.2602, dtype=torch.float64)
16 gae_duplicate tensor(0.2421, dtype=torch.float64) tensor(-5.5301, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7105, dtype=torch.float64) delta_t tensor(0.1707, dtype=torch.float64)
15 gae_duplicate tensor(-0.0549, dtype=torch.float64) tensor(-3.9220, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6516, dtype=torch.float64) delta_t tensor(0.2539, dtype=torch.float64)
14 gae_duplicate tensor(0.1277, dtype=torch.float64) tensor(-5.6075, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6696, dtype=torch.float64) delta_t tensor(0.1560, dtype=torch.float64)
13 gae_duplicate tensor(-0.1724, dtype=torch.float64) tensor(-3.6564, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6091, dtype=torch.float64) delta_t tensor(0.3788, dtype=torch.float64)
12 gae_duplicate tensor(0.2505, dtype=torch.float64) tensor(-7.9969, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0514, dtype=torch.float64) delta_t tensor(-0.1877, dtype=torch.float64)
11 gae_duplicate tensor(-0.9614, dtype=torch.float64) tensor(2.8837, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4940, dtype=torch.float64) delta_t tensor(0.4196, dtype=torch.float64)
10 gae_duplicate tensor(0.1588, dtype=torch.float64) tensor(-8.0022, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.3465, dtype=torch.float64) delta_t tensor(-1.3058, dtype=torch.float64)
9 gae_duplicate tensor(-3.3868, dtype=torch.float64) tensor(26.4221, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.3781, dtype=torch.float64) delta_t tensor(-1.1932, dtype=torch.float64)
8 gae_duplicate tensor(-3.3076, dtype=torch.float64) tensor(26.5837, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2505, dtype=torch.float64) delta_t tensor(-0.1615, dtype=torch.float64)
7 gae_duplicate tensor(-1.8839, dtype=torch.float64) tensor(5.4863, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4480, dtype=torch.float64) delta_t tensor(-0.2749, dtype=torch.float64)
6 gae_duplicate tensor(-0.9415, dtype=torch.float64) tensor(6.2722, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.1585, dtype=torch.float64) delta_t tensor(-0.2892, dtype=torch.float64)
5 gae_duplicate tensor(-2.2866, dtype=torch.float64) tensor(5.9807, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1828, dtype=torch.float64) delta_t tensor(-0.1526, dtype=torch.float64)
4 gae_duplicate tensor(-1.1226, dtype=torch.float64) tensor(3.8441, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.3218, dtype=torch.float64) delta_t tensor(0.2999, dtype=torch.float64)
3 gae_duplicate tensor(-0.1465, dtype=torch.float64) tensor(-5.2903, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.3977, dtype=torch.float64) delta_t tensor(0.0338, dtype=torch.float64)
2 gae_duplicate tensor(-0.2163, dtype=torch.float64) tensor(-1.1297, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1236.7637939453125
value loss:109.90272521972656
entropies:354.7396545410156
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3954.2183)
ToM Target loss= tensor(3576.0315)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.430851936340332 seconds
19 rew tensor(0.8558, dtype=torch.float64) delta_t tensor(0.2553, dtype=torch.float64)
19 gae_duplicate tensor(0.2174, dtype=torch.float64) tensor(-4.9762, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7996, dtype=torch.float64) delta_t tensor(0.2849, dtype=torch.float64)
18 gae_duplicate tensor(0.1361, dtype=torch.float64) tensor(-5.9819, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7510, dtype=torch.float64) delta_t tensor(0.3519, dtype=torch.float64)
17 gae_duplicate tensor(0.3199, dtype=torch.float64) tensor(-7.5879, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5453, dtype=torch.float64) delta_t tensor(0.0814, dtype=torch.float64)
16 gae_duplicate tensor(-0.9116, dtype=torch.float64) tensor(-2.4179, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4915, dtype=torch.float64) delta_t tensor(0.1024, dtype=torch.float64)
15 gae_duplicate tensor(-0.8336, dtype=torch.float64) tensor(-2.2878, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5038, dtype=torch.float64) delta_t tensor(0.2436, dtype=torch.float64)
14 gae_duplicate tensor(-0.7554, dtype=torch.float64) tensor(-4.8357, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5103, dtype=torch.float64) delta_t tensor(0.0108, dtype=torch.float64)
13 gae_duplicate tensor(-0.3166, dtype=torch.float64) tensor(-0.5984, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6295, dtype=torch.float64) delta_t tensor(0.3638, dtype=torch.float64)
12 gae_duplicate tensor(0.1332, dtype=torch.float64) tensor(-7.2845, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4674, dtype=torch.float64) delta_t tensor(0.5643, dtype=torch.float64)
11 gae_duplicate tensor(0.3046, dtype=torch.float64) tensor(-12.1838, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0067, dtype=torch.float64) delta_t tensor(-0.2199, dtype=torch.float64)
10 gae_duplicate tensor(-1.1327, dtype=torch.float64) tensor(3.1205, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.5778, dtype=torch.float64) delta_t tensor(-1.1413, dtype=torch.float64)
9 gae_duplicate tensor(-3.4669, dtype=torch.float64) tensor(22.5616, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1049, dtype=torch.float64) delta_t tensor(-0.0671, dtype=torch.float64)
8 gae_duplicate tensor(-3.0659, dtype=torch.float64) tensor(3.1381, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7743, dtype=torch.float64) delta_t tensor(-0.3999, dtype=torch.float64)
7 gae_duplicate tensor(-1.6719, dtype=torch.float64) tensor(8.2698, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5362, dtype=torch.float64) delta_t tensor(-0.4934, dtype=torch.float64)
6 gae_duplicate tensor(-2.8375, dtype=torch.float64) tensor(10.4252, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5811, dtype=torch.float64) delta_t tensor(-0.3122, dtype=torch.float64)
5 gae_duplicate tensor(-2.5105, dtype=torch.float64) tensor(7.3230, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0082, dtype=torch.float64) delta_t tensor(-0.0843, dtype=torch.float64)
4 gae_duplicate tensor(-0.9284, dtype=torch.float64) tensor(2.6063, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.0325, dtype=torch.float64) delta_t tensor(0.2406, dtype=torch.float64)
3 gae_duplicate tensor(-0.3332, dtype=torch.float64) tensor(-4.4293, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2105, dtype=torch.float64) delta_t tensor(0.0997, dtype=torch.float64)
2 gae_duplicate tensor(-0.3460, dtype=torch.float64) tensor(-2.4571, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-225.6044921875
value loss:101.31101989746094
entropies:354.78662109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.881685018539429 seconds
19 rew tensor(0.8351, dtype=torch.float64) delta_t tensor(0.2340, dtype=torch.float64)
19 gae_duplicate tensor(0.1434, dtype=torch.float64) tensor(-4.6206, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7510, dtype=torch.float64) delta_t tensor(0.2038, dtype=torch.float64)
18 gae_duplicate tensor(0.1569, dtype=torch.float64) tensor(-4.4615, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6858, dtype=torch.float64) delta_t tensor(0.2571, dtype=torch.float64)
17 gae_duplicate tensor(0.1644, dtype=torch.float64) tensor(-5.4895, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7075, dtype=torch.float64) delta_t tensor(0.2149, dtype=torch.float64)
16 gae_duplicate tensor(0.1804, dtype=torch.float64) tensor(-4.9739, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5446, dtype=torch.float64) delta_t tensor(0.1767, dtype=torch.float64)
15 gae_duplicate tensor(-0.2521, dtype=torch.float64) tensor(-3.9881, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1346, dtype=torch.float64) delta_t tensor(-0.4304, dtype=torch.float64)
14 gae_duplicate tensor(-0.8956, dtype=torch.float64) tensor(8.2297, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4985, dtype=torch.float64) delta_t tensor(0.0994, dtype=torch.float64)
13 gae_duplicate tensor(-0.3056, dtype=torch.float64) tensor(-1.2449, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5468, dtype=torch.float64) delta_t tensor(0.2663, dtype=torch.float64)
12 gae_duplicate tensor(-0.4468, dtype=torch.float64) tensor(-5.3762, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2119, dtype=torch.float64) delta_t tensor(0.0955, dtype=torch.float64)
11 gae_duplicate tensor(-1.0706, dtype=torch.float64) tensor(-1.9938, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6676, dtype=torch.float64) delta_t tensor(0.4646, dtype=torch.float64)
10 gae_duplicate tensor(0.2149, dtype=torch.float64) tensor(-9.6498, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-3.0346, dtype=torch.float64) delta_t tensor(-2.6180, dtype=torch.float64)
9 gae_duplicate tensor(-4.2703, dtype=torch.float64) tensor(49.8978, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.1722, dtype=torch.float64) delta_t tensor(-1.2936, dtype=torch.float64)
8 gae_duplicate tensor(-3.1943, dtype=torch.float64) tensor(31.8043, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2844, dtype=torch.float64) delta_t tensor(0.0812, dtype=torch.float64)
7 gae_duplicate tensor(-1.9477, dtype=torch.float64) tensor(1.4531, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0338, dtype=torch.float64) delta_t tensor(-0.0662, dtype=torch.float64)
6 gae_duplicate tensor(-2.0845, dtype=torch.float64) tensor(1.2984, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.3394, dtype=torch.float64) delta_t tensor(-0.0182, dtype=torch.float64)
5 gae_duplicate tensor(-2.2692, dtype=torch.float64) tensor(0.6848, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0767, dtype=torch.float64) delta_t tensor(-0.2760, dtype=torch.float64)
4 gae_duplicate tensor(-2.6213, dtype=torch.float64) tensor(5.4271, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1408, dtype=torch.float64) delta_t tensor(0.0292, dtype=torch.float64)
3 gae_duplicate tensor(-0.3469, dtype=torch.float64) tensor(0.1172, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2896, dtype=torch.float64) delta_t tensor(0.1716, dtype=torch.float64)
2 gae_duplicate tensor(-0.1833, dtype=torch.float64) tensor(-3.3478, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2999.195068359375
value loss:171.89256286621094
entropies:354.8837585449219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.989844083786011 seconds
19 rew tensor(0.8459, dtype=torch.float64) delta_t tensor(0.2275, dtype=torch.float64)
19 gae_duplicate tensor(0.1417, dtype=torch.float64) tensor(-4.4655, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5939, dtype=torch.float64) delta_t tensor(0.0640, dtype=torch.float64)
18 gae_duplicate tensor(-0.9665, dtype=torch.float64) tensor(-1.3896, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5337, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
17 gae_duplicate tensor(-0.8864, dtype=torch.float64) tensor(-0.1050, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7096, dtype=torch.float64) delta_t tensor(0.2273, dtype=torch.float64)
16 gae_duplicate tensor(0.0217, dtype=torch.float64) tensor(-4.5375, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4874, dtype=torch.float64) delta_t tensor(0.0915, dtype=torch.float64)
15 gae_duplicate tensor(-0.3635, dtype=torch.float64) tensor(-2.3865, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6496, dtype=torch.float64) delta_t tensor(0.2743, dtype=torch.float64)
14 gae_duplicate tensor(0.0697, dtype=torch.float64) tensor(-5.8763, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5500, dtype=torch.float64) delta_t tensor(0.1225, dtype=torch.float64)
13 gae_duplicate tensor(-0.1024, dtype=torch.float64) tensor(-2.9729, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0796, dtype=torch.float64) delta_t tensor(-0.0106, dtype=torch.float64)
12 gae_duplicate tensor(-1.5569, dtype=torch.float64) tensor(-0.1737, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3123, dtype=torch.float64) delta_t tensor(-0.2964, dtype=torch.float64)
11 gae_duplicate tensor(-0.8417, dtype=torch.float64) tensor(5.7503, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1697, dtype=torch.float64) delta_t tensor(-0.2138, dtype=torch.float64)
10 gae_duplicate tensor(-1.0906, dtype=torch.float64) tensor(4.6379, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-1.7352, dtype=torch.float64) delta_t tensor(-1.3437, dtype=torch.float64)
9 gae_duplicate tensor(-3.3637, dtype=torch.float64) tensor(27.4155, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-1.7407, dtype=torch.float64) delta_t tensor(-1.6922, dtype=torch.float64)
8 gae_duplicate tensor(-4.8510, dtype=torch.float64) tensor(36.8239, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4580, dtype=torch.float64) delta_t tensor(-0.0942, dtype=torch.float64)
7 gae_duplicate tensor(-2.2680, dtype=torch.float64) tensor(5.1959, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0973, dtype=torch.float64) delta_t tensor(0.2706, dtype=torch.float64)
6 gae_duplicate tensor(-1.3968, dtype=torch.float64) tensor(-4.6221, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6206, dtype=torch.float64) delta_t tensor(-0.4038, dtype=torch.float64)
5 gae_duplicate tensor(-2.9011, dtype=torch.float64) tensor(7.1075, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4175, dtype=torch.float64) delta_t tensor(0.3328, dtype=torch.float64)
4 gae_duplicate tensor(0.1554, dtype=torch.float64) tensor(-5.8013, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1874, dtype=torch.float64) delta_t tensor(-0.0961, dtype=torch.float64)
3 gae_duplicate tensor(-0.6456, dtype=torch.float64) tensor(1.4741, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0489, dtype=torch.float64) delta_t tensor(0.2104, dtype=torch.float64)
2 gae_duplicate tensor(-0.2360, dtype=torch.float64) tensor(-3.8736, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2914.677001953125
value loss:144.21524047851562
entropies:354.89788818359375
Policy training finished
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 802, in _callmethod
    conn = self._tls.connection
KeyboardInterrupt