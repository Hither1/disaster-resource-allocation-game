obs <crafter.objects.Shelter object at 0x12ac1c400> [39.  0.  0.  0. 39.  0.  0.  0. 21.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x1196fbb80> [40.  0.  0.  0. 38.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x12ac221f0> [ 9.  0.  0.  0.  9.  0.  0.  0. 13.  0.  0.  0.]
obs <crafter.objects.Shelter object at 0x12ac1c400> [39.  0.  0.  0. 39.  0.  0.  0. 22.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x1196fbb80> [42.  0.  0.  0. 38.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x12ac221f0> [ 9.  0.  0.  0.  9.  0.  0.  0. 14.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0027861595153808594 seconds
19 rew tensor(1.0105, dtype=torch.float64) delta_t tensor(0.8637, dtype=torch.float64)
19 gae_duplicate tensor(0.6063, dtype=torch.float64) tensor(-17.1527, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0209, dtype=torch.float64) delta_t tensor(0.9474, dtype=torch.float64)
18 gae_duplicate tensor(0.7255, dtype=torch.float64) tensor(-20.5436, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7582, dtype=torch.float64) delta_t tensor(0.5599, dtype=torch.float64)
17 gae_duplicate tensor(-0.0553, dtype=torch.float64) tensor(-12.7730, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0087, dtype=torch.float64) delta_t tensor(0.9353, dtype=torch.float64)
16 gae_duplicate tensor(0.7952, dtype=torch.float64) tensor(-19.0051, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6008, dtype=torch.float64) delta_t tensor(0.4626, dtype=torch.float64)
15 gae_duplicate tensor(0.3149, dtype=torch.float64) tensor(-10.8474, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9510, dtype=torch.float64) delta_t tensor(0.9264, dtype=torch.float64)
14 gae_duplicate tensor(0.5742, dtype=torch.float64) tensor(-19.6040, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5002, dtype=torch.float64) delta_t tensor(0.3694, dtype=torch.float64)
13 gae_duplicate tensor(0.1414, dtype=torch.float64) tensor(-9.1206, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9388, dtype=torch.float64) delta_t tensor(0.8919, dtype=torch.float64)
12 gae_duplicate tensor(0.3516, dtype=torch.float64) tensor(-18.3894, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1610, dtype=torch.float64) delta_t tensor(-0.2821, dtype=torch.float64)
11 gae_duplicate tensor(-2.8023, dtype=torch.float64) tensor(3.4821, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5330, dtype=torch.float64) delta_t tensor(0.5359, dtype=torch.float64)
10 gae_duplicate tensor(-0.7718, dtype=torch.float64) tensor(-10.3060, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1299, dtype=torch.float64) delta_t tensor(-0.0935, dtype=torch.float64)
9 gae_duplicate tensor(-0.3826, dtype=torch.float64) tensor(0.8810, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.8520, dtype=torch.float64) delta_t tensor(0.8827, dtype=torch.float64)
8 gae_duplicate tensor(0.4747, dtype=torch.float64) tensor(-17.2251, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5354, dtype=torch.float64) delta_t tensor(-1.5789, dtype=torch.float64)
7 gae_duplicate tensor(-2.2471, dtype=torch.float64) tensor(29.9203, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.8359, dtype=torch.float64) delta_t tensor(0.9108, dtype=torch.float64)
6 gae_duplicate tensor(0.2034, dtype=torch.float64) tensor(-15.3629, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7397, dtype=torch.float64) delta_t tensor(-0.6994, dtype=torch.float64)
5 gae_duplicate tensor(-0.9612, dtype=torch.float64) tensor(12.4560, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(1.3752, dtype=torch.float64) delta_t tensor(1.2971, dtype=torch.float64)
4 gae_duplicate tensor(1.0048, dtype=torch.float64) tensor(-24.1075, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2125, dtype=torch.float64) delta_t tensor(-0.1825, dtype=torch.float64)
3 gae_duplicate tensor(-0.4093, dtype=torch.float64) tensor(1.0874, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.1210, dtype=torch.float64) delta_t tensor(1.1264, dtype=torch.float64)
2 gae_duplicate tensor(1.0887, dtype=torch.float64) tensor(-22.1428, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:9016.9814453125
value loss:141.04637145996094
entropies:354.4092712402344
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 4.725949287414551 seconds
19 rew tensor(1.0231, dtype=torch.float64) delta_t tensor(0.8979, dtype=torch.float64)
19 gae_duplicate tensor(0.7442, dtype=torch.float64) tensor(-17.2680, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0410, dtype=torch.float64) delta_t tensor(0.9532, dtype=torch.float64)
18 gae_duplicate tensor(0.8137, dtype=torch.float64) tensor(-21.1844, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8171, dtype=torch.float64) delta_t tensor(0.5519, dtype=torch.float64)
17 gae_duplicate tensor(-0.0240, dtype=torch.float64) tensor(-12.9330, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8964, dtype=torch.float64) delta_t tensor(0.8238, dtype=torch.float64)
16 gae_duplicate tensor(0.5536, dtype=torch.float64) tensor(-17.2534, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4135, dtype=torch.float64) delta_t tensor(0.2167, dtype=torch.float64)
15 gae_duplicate tensor(-0.3774, dtype=torch.float64) tensor(-5.8323, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7419, dtype=torch.float64) delta_t tensor(0.6950, dtype=torch.float64)
14 gae_duplicate tensor(0.4888, dtype=torch.float64) tensor(-13.9209, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0638, dtype=torch.float64) delta_t tensor(-0.2004, dtype=torch.float64)
13 gae_duplicate tensor(-0.7236, dtype=torch.float64) tensor(2.4239, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8553, dtype=torch.float64) delta_t tensor(0.8130, dtype=torch.float64)
12 gae_duplicate tensor(0.5469, dtype=torch.float64) tensor(-16.1047, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1467, dtype=torch.float64) delta_t tensor(-0.2311, dtype=torch.float64)
11 gae_duplicate tensor(-0.6252, dtype=torch.float64) tensor(2.9639, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6639, dtype=torch.float64) delta_t tensor(0.6250, dtype=torch.float64)
10 gae_duplicate tensor(0.4483, dtype=torch.float64) tensor(-12.0111, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6063, dtype=torch.float64) delta_t tensor(-0.6104, dtype=torch.float64)
9 gae_duplicate tensor(-1.1707, dtype=torch.float64) tensor(11.0097, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7426, dtype=torch.float64) delta_t tensor(0.7236, dtype=torch.float64)
8 gae_duplicate tensor(0.3117, dtype=torch.float64) tensor(-13.3164, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6403, dtype=torch.float64) delta_t tensor(-1.6662, dtype=torch.float64)
7 gae_duplicate tensor(-2.5900, dtype=torch.float64) tensor(30.9736, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5065, dtype=torch.float64) delta_t tensor(0.5210, dtype=torch.float64)
6 gae_duplicate tensor(-0.0953, dtype=torch.float64) tensor(-7.0935, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8679, dtype=torch.float64) delta_t tensor(-0.8748, dtype=torch.float64)
5 gae_duplicate tensor(-1.2640, dtype=torch.float64) tensor(16.3186, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9443, dtype=torch.float64) delta_t tensor(0.8510, dtype=torch.float64)
4 gae_duplicate tensor(0.5536, dtype=torch.float64) tensor(-15.2616, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5105, dtype=torch.float64) delta_t tensor(-0.4911, dtype=torch.float64)
3 gae_duplicate tensor(-0.9593, dtype=torch.float64) tensor(8.0859, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2646, dtype=torch.float64) delta_t tensor(0.2402, dtype=torch.float64)
2 gae_duplicate tensor(-0.0177, dtype=torch.float64) tensor(-4.1519, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4470.185546875
value loss:103.70862579345703
entropies:354.89251708984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.881464004516602 seconds
19 rew tensor(1.0235, dtype=torch.float64) delta_t tensor(0.8374, dtype=torch.float64)
19 gae_duplicate tensor(0.5595, dtype=torch.float64) tensor(-16.3912, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9854, dtype=torch.float64) delta_t tensor(0.8317, dtype=torch.float64)
18 gae_duplicate tensor(0.5449, dtype=torch.float64) tensor(-18.3581, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9707, dtype=torch.float64) delta_t tensor(0.6296, dtype=torch.float64)
17 gae_duplicate tensor(0.5082, dtype=torch.float64) tensor(-13.7504, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7988, dtype=torch.float64) delta_t tensor(0.6305, dtype=torch.float64)
16 gae_duplicate tensor(0.1314, dtype=torch.float64) tensor(-13.4222, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7610, dtype=torch.float64) delta_t tensor(0.5014, dtype=torch.float64)
15 gae_duplicate tensor(0.3176, dtype=torch.float64) tensor(-11.2901, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4979, dtype=torch.float64) delta_t tensor(0.4006, dtype=torch.float64)
14 gae_duplicate tensor(-0.1745, dtype=torch.float64) tensor(-8.9551, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1860, dtype=torch.float64) delta_t tensor(0.0442, dtype=torch.float64)
13 gae_duplicate tensor(-0.2353, dtype=torch.float64) tensor(-1.7699, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6617, dtype=torch.float64) delta_t tensor(0.5519, dtype=torch.float64)
12 gae_duplicate tensor(-0.3675, dtype=torch.float64) tensor(-11.2258, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1809, dtype=torch.float64) delta_t tensor(0.0152, dtype=torch.float64)
11 gae_duplicate tensor(-0.2576, dtype=torch.float64) tensor(-1.4225, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3147, dtype=torch.float64) delta_t tensor(0.2390, dtype=torch.float64)
10 gae_duplicate tensor(-0.4509, dtype=torch.float64) tensor(-4.7875, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4640, dtype=torch.float64) delta_t tensor(-0.4320, dtype=torch.float64)
9 gae_duplicate tensor(-0.7070, dtype=torch.float64) tensor(8.0539, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4250, dtype=torch.float64) delta_t tensor(0.3588, dtype=torch.float64)
8 gae_duplicate tensor(-0.5109, dtype=torch.float64) tensor(-6.1974, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5877, dtype=torch.float64) delta_t tensor(-1.6306, dtype=torch.float64)
7 gae_duplicate tensor(-2.6774, dtype=torch.float64) tensor(31.2959, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2299, dtype=torch.float64) delta_t tensor(0.2737, dtype=torch.float64)
6 gae_duplicate tensor(-0.3952, dtype=torch.float64) tensor(-2.1633, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0892, dtype=torch.float64) delta_t tensor(-1.1172, dtype=torch.float64)
5 gae_duplicate tensor(-1.6789, dtype=torch.float64) tensor(21.3488, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.8843, dtype=torch.float64) delta_t tensor(0.7564, dtype=torch.float64)
4 gae_duplicate tensor(0.3398, dtype=torch.float64) tensor(-12.7155, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8313, dtype=torch.float64) delta_t tensor(-0.8454, dtype=torch.float64)
3 gae_duplicate tensor(-1.2423, dtype=torch.float64) tensor(15.4711, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2729, dtype=torch.float64) delta_t tensor(0.2318, dtype=torch.float64)
2 gae_duplicate tensor(-0.0023, dtype=torch.float64) tensor(-3.0434, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2567.536376953125
value loss:104.25749969482422
entropies:355.18621826171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.130719900131226 seconds
19 rew tensor(1.0300, dtype=torch.float64) delta_t tensor(0.7475, dtype=torch.float64)
19 gae_duplicate tensor(0.5750, dtype=torch.float64) tensor(-15.0706, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9509, dtype=torch.float64) delta_t tensor(0.7433, dtype=torch.float64)
18 gae_duplicate tensor(0.4737, dtype=torch.float64) tensor(-16.3696, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8000, dtype=torch.float64) delta_t tensor(0.5268, dtype=torch.float64)
17 gae_duplicate tensor(0.3445, dtype=torch.float64) tensor(-12.0636, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8823, dtype=torch.float64) delta_t tensor(0.7410, dtype=torch.float64)
16 gae_duplicate tensor(0.6583, dtype=torch.float64) tensor(-15.5494, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5325, dtype=torch.float64) delta_t tensor(0.2615, dtype=torch.float64)
15 gae_duplicate tensor(-0.0673, dtype=torch.float64) tensor(-6.8048, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6433, dtype=torch.float64) delta_t tensor(0.5385, dtype=torch.float64)
14 gae_duplicate tensor(-0.0217, dtype=torch.float64) tensor(-11.1606, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1504, dtype=torch.float64) delta_t tensor(-0.0416, dtype=torch.float64)
13 gae_duplicate tensor(-0.3351, dtype=torch.float64) tensor(-0.4665, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4278, dtype=torch.float64) delta_t tensor(0.2900, dtype=torch.float64)
12 gae_duplicate tensor(-0.9111, dtype=torch.float64) tensor(-5.4847, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0938, dtype=torch.float64) delta_t tensor(-0.2323, dtype=torch.float64)
11 gae_duplicate tensor(-0.9019, dtype=torch.float64) tensor(4.1820, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2907, dtype=torch.float64) delta_t tensor(0.2102, dtype=torch.float64)
10 gae_duplicate tensor(-0.3333, dtype=torch.float64) tensor(-3.6949, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7259, dtype=torch.float64) delta_t tensor(-0.6323, dtype=torch.float64)
9 gae_duplicate tensor(-0.8341, dtype=torch.float64) tensor(12.2775, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6085, dtype=torch.float64) delta_t tensor(0.5034, dtype=torch.float64)
8 gae_duplicate tensor(0.1490, dtype=torch.float64) tensor(-8.7260, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.8150, dtype=torch.float64) delta_t tensor(-1.8194, dtype=torch.float64)
7 gae_duplicate tensor(-2.1789, dtype=torch.float64) tensor(35.1554, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6447, dtype=torch.float64) delta_t tensor(0.6485, dtype=torch.float64)
6 gae_duplicate tensor(0.0580, dtype=torch.float64) tensor(-9.4872, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3168, dtype=torch.float64) delta_t tensor(-1.3383, dtype=torch.float64)
5 gae_duplicate tensor(-1.7598, dtype=torch.float64) tensor(25.9426, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9286, dtype=torch.float64) delta_t tensor(0.7552, dtype=torch.float64)
4 gae_duplicate tensor(0.5054, dtype=torch.float64) tensor(-12.3900, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7898, dtype=torch.float64) delta_t tensor(-0.7927, dtype=torch.float64)
3 gae_duplicate tensor(-1.5740, dtype=torch.float64) tensor(14.4019, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3084, dtype=torch.float64) delta_t tensor(0.2533, dtype=torch.float64)
2 gae_duplicate tensor(-0.0326, dtype=torch.float64) tensor(-3.4296, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1455.962158203125
value loss:104.36973571777344
entropies:355.16650390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.925302028656006 seconds
19 rew tensor(1.0079, dtype=torch.float64) delta_t tensor(0.7362, dtype=torch.float64)
19 gae_duplicate tensor(0.3792, dtype=torch.float64) tensor(-14.7727, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9327, dtype=torch.float64) delta_t tensor(0.6303, dtype=torch.float64)
18 gae_duplicate tensor(0.3876, dtype=torch.float64) tensor(-13.6899, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6029, dtype=torch.float64) delta_t tensor(0.2458, dtype=torch.float64)
17 gae_duplicate tensor(-0.8680, dtype=torch.float64) tensor(-5.8839, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7593, dtype=torch.float64) delta_t tensor(0.5874, dtype=torch.float64)
16 gae_duplicate tensor(0.3289, dtype=torch.float64) tensor(-12.2415, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4361, dtype=torch.float64) delta_t tensor(0.1920, dtype=torch.float64)
15 gae_duplicate tensor(-0.9096, dtype=torch.float64) tensor(-4.6257, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4156, dtype=torch.float64) delta_t tensor(0.2460, dtype=torch.float64)
14 gae_duplicate tensor(-0.0103, dtype=torch.float64) tensor(-5.2595, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2592, dtype=torch.float64) delta_t tensor(0.0863, dtype=torch.float64)
13 gae_duplicate tensor(-1.4045, dtype=torch.float64) tensor(-2.0847, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3650, dtype=torch.float64) delta_t tensor(0.1779, dtype=torch.float64)
12 gae_duplicate tensor(-0.0368, dtype=torch.float64) tensor(-3.7253, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1699, dtype=torch.float64) delta_t tensor(0.0446, dtype=torch.float64)
11 gae_duplicate tensor(-0.6909, dtype=torch.float64) tensor(-1.3694, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2518, dtype=torch.float64) delta_t tensor(0.1131, dtype=torch.float64)
10 gae_duplicate tensor(-0.2641, dtype=torch.float64) tensor(-2.2754, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7297, dtype=torch.float64) delta_t tensor(-0.6539, dtype=torch.float64)
9 gae_duplicate tensor(-1.0364, dtype=torch.float64) tensor(12.8578, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.8047, dtype=torch.float64) delta_t tensor(0.6430, dtype=torch.float64)
8 gae_duplicate tensor(0.2873, dtype=torch.float64) tensor(-11.1435, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.1018, dtype=torch.float64) delta_t tensor(-2.0366, dtype=torch.float64)
7 gae_duplicate tensor(-3.9238, dtype=torch.float64) tensor(39.0146, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0481, dtype=torch.float64) delta_t tensor(0.0468, dtype=torch.float64)
6 gae_duplicate tensor(-0.6985, dtype=torch.float64) tensor(3.2591, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3122, dtype=torch.float64) delta_t tensor(-1.2336, dtype=torch.float64)
5 gae_duplicate tensor(-1.6316, dtype=torch.float64) tensor(25.0468, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9205, dtype=torch.float64) delta_t tensor(0.6866, dtype=torch.float64)
4 gae_duplicate tensor(0.4589, dtype=torch.float64) tensor(-10.9287, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3236, dtype=torch.float64) delta_t tensor(-1.2869, dtype=torch.float64)
3 gae_duplicate tensor(-1.9444, dtype=torch.float64) tensor(24.2287, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5915, dtype=torch.float64) delta_t tensor(0.4996, dtype=torch.float64)
2 gae_duplicate tensor(-0.0251, dtype=torch.float64) tensor(-7.1063, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-598.101806640625
value loss:122.95246887207031
entropies:355.10491943359375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3972.6509)
ToM Target loss= tensor(3805.7903)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.81269097328186 seconds
19 rew tensor(1.0411, dtype=torch.float64) delta_t tensor(0.6900, dtype=torch.float64)
19 gae_duplicate tensor(0.4809, dtype=torch.float64) tensor(-13.6002, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0283, dtype=torch.float64) delta_t tensor(0.6989, dtype=torch.float64)
18 gae_duplicate tensor(0.5494, dtype=torch.float64) tensor(-15.6100, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9214, dtype=torch.float64) delta_t tensor(0.4935, dtype=torch.float64)
17 gae_duplicate tensor(0.1526, dtype=torch.float64) tensor(-11.8038, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(0.7035, dtype=torch.float64)
16 gae_duplicate tensor(0.6124, dtype=torch.float64) tensor(-15.0212, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6057, dtype=torch.float64) delta_t tensor(0.2945, dtype=torch.float64)
15 gae_duplicate tensor(-0.0593, dtype=torch.float64) tensor(-7.3059, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5696, dtype=torch.float64) delta_t tensor(0.3773, dtype=torch.float64)
14 gae_duplicate tensor(0.0441, dtype=torch.float64) tensor(-8.2447, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3623, dtype=torch.float64) delta_t tensor(0.1325, dtype=torch.float64)
13 gae_duplicate tensor(-0.5636, dtype=torch.float64) tensor(-3.5176, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1834, dtype=torch.float64) delta_t tensor(-0.0117, dtype=torch.float64)
12 gae_duplicate tensor(-1.7297, dtype=torch.float64) tensor(-0.4226, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2526, dtype=torch.float64) delta_t tensor(-0.3619, dtype=torch.float64)
11 gae_duplicate tensor(-1.9949, dtype=torch.float64) tensor(6.7842, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3817, dtype=torch.float64) delta_t tensor(0.1998, dtype=torch.float64)
10 gae_duplicate tensor(-0.4450, dtype=torch.float64) tensor(-3.1484, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5236, dtype=torch.float64) delta_t tensor(-0.3328, dtype=torch.float64)
9 gae_duplicate tensor(-0.8946, dtype=torch.float64) tensor(6.2300, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3697, dtype=torch.float64) delta_t tensor(0.1454, dtype=torch.float64)
8 gae_duplicate tensor(-0.6750, dtype=torch.float64) tensor(-2.4578, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.0296, dtype=torch.float64) delta_t tensor(-1.9157, dtype=torch.float64)
7 gae_duplicate tensor(-3.3635, dtype=torch.float64) tensor(38.3189, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2975, dtype=torch.float64) delta_t tensor(0.2929, dtype=torch.float64)
6 gae_duplicate tensor(-1.5470, dtype=torch.float64) tensor(-1.5373, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0982, dtype=torch.float64) delta_t tensor(-1.1264, dtype=torch.float64)
5 gae_duplicate tensor(-1.4797, dtype=torch.float64) tensor(21.4941, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9351, dtype=torch.float64) delta_t tensor(0.7032, dtype=torch.float64)
4 gae_duplicate tensor(0.5130, dtype=torch.float64) tensor(-11.6474, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9111, dtype=torch.float64) delta_t tensor(-0.9244, dtype=torch.float64)
3 gae_duplicate tensor(-1.8556, dtype=torch.float64) tensor(17.0668, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3706, dtype=torch.float64) delta_t tensor(0.2622, dtype=torch.float64)
2 gae_duplicate tensor(-0.1588, dtype=torch.float64) tensor(-3.5040, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:332.2232971191406
value loss:115.5514144897461
entropies:354.91143798828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.776680946350098 seconds
19 rew tensor(0.9651, dtype=torch.float64) delta_t tensor(0.4602, dtype=torch.float64)
19 gae_duplicate tensor(0.1208, dtype=torch.float64) tensor(-9.2737, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8808, dtype=torch.float64) delta_t tensor(0.4938, dtype=torch.float64)
18 gae_duplicate tensor(0.3289, dtype=torch.float64) tensor(-10.5391, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8543, dtype=torch.float64) delta_t tensor(0.4584, dtype=torch.float64)
17 gae_duplicate tensor(0.2498, dtype=torch.float64) tensor(-9.8796, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9062, dtype=torch.float64) delta_t tensor(0.6061, dtype=torch.float64)
16 gae_duplicate tensor(0.5164, dtype=torch.float64) tensor(-13.4147, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5022, dtype=torch.float64) delta_t tensor(0.0913, dtype=torch.float64)
15 gae_duplicate tensor(-0.3149, dtype=torch.float64) tensor(-3.3696, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7694, dtype=torch.float64) delta_t tensor(0.5343, dtype=torch.float64)
14 gae_duplicate tensor(0.2642, dtype=torch.float64) tensor(-10.5882, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2527, dtype=torch.float64) delta_t tensor(0.0033, dtype=torch.float64)
13 gae_duplicate tensor(-0.6851, dtype=torch.float64) tensor(-1.2640, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2214, dtype=torch.float64) delta_t tensor(-0.5084, dtype=torch.float64)
12 gae_duplicate tensor(-2.7580, dtype=torch.float64) tensor(10.4199, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0761, dtype=torch.float64) delta_t tensor(-0.0190, dtype=torch.float64)
11 gae_duplicate tensor(-0.7462, dtype=torch.float64) tensor(1.2160, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4289, dtype=torch.float64) delta_t tensor(0.1936, dtype=torch.float64)
10 gae_duplicate tensor(-0.4211, dtype=torch.float64) tensor(-3.6713, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6707, dtype=torch.float64) delta_t tensor(-0.4646, dtype=torch.float64)
9 gae_duplicate tensor(-0.7043, dtype=torch.float64) tensor(8.6648, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5589, dtype=torch.float64) delta_t tensor(0.2765, dtype=torch.float64)
8 gae_duplicate tensor(-0.2159, dtype=torch.float64) tensor(-4.3509, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.9775, dtype=torch.float64) delta_t tensor(-1.8843, dtype=torch.float64)
7 gae_duplicate tensor(-3.8777, dtype=torch.float64) tensor(37.5664, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3452, dtype=torch.float64) delta_t tensor(0.3078, dtype=torch.float64)
6 gae_duplicate tensor(-0.6362, dtype=torch.float64) tensor(-2.3026, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3082, dtype=torch.float64) delta_t tensor(-1.3187, dtype=torch.float64)
5 gae_duplicate tensor(-1.6139, dtype=torch.float64) tensor(24.9956, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.8830, dtype=torch.float64) delta_t tensor(0.5971, dtype=torch.float64)
4 gae_duplicate tensor(0.4113, dtype=torch.float64) tensor(-9.1899, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9195, dtype=torch.float64) delta_t tensor(-0.9084, dtype=torch.float64)
3 gae_duplicate tensor(-1.6040, dtype=torch.float64) tensor(16.3400, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2443, dtype=torch.float64) delta_t tensor(0.0469, dtype=torch.float64)
2 gae_duplicate tensor(-0.4267, dtype=torch.float64) tensor(0.7191, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1288.0352783203125
value loss:107.53478240966797
entropies:354.8771667480469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.984081029891968 seconds
19 rew tensor(1.0519, dtype=torch.float64) delta_t tensor(0.5279, dtype=torch.float64)
19 gae_duplicate tensor(0.4116, dtype=torch.float64) tensor(-10.5399, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9919, dtype=torch.float64) delta_t tensor(0.5481, dtype=torch.float64)
18 gae_duplicate tensor(0.0785, dtype=torch.float64) tensor(-11.7484, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8390, dtype=torch.float64) delta_t tensor(0.2546, dtype=torch.float64)
17 gae_duplicate tensor(0.0563, dtype=torch.float64) tensor(-6.0604, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8338, dtype=torch.float64) delta_t tensor(0.5080, dtype=torch.float64)
16 gae_duplicate tensor(0.4125, dtype=torch.float64) tensor(-10.6456, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5849, dtype=torch.float64) delta_t tensor(0.1436, dtype=torch.float64)
15 gae_duplicate tensor(-0.0810, dtype=torch.float64) tensor(-3.9142, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4725, dtype=torch.float64) delta_t tensor(0.2225, dtype=torch.float64)
14 gae_duplicate tensor(-0.1833, dtype=torch.float64) tensor(-4.8604, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0832, dtype=torch.float64) delta_t tensor(-0.2661, dtype=torch.float64)
13 gae_duplicate tensor(-1.2220, dtype=torch.float64) tensor(4.6127, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6865, dtype=torch.float64) delta_t tensor(0.3688, dtype=torch.float64)
12 gae_duplicate tensor(-0.0886, dtype=torch.float64) tensor(-6.6610, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0434, dtype=torch.float64) delta_t tensor(-0.1239, dtype=torch.float64)
11 gae_duplicate tensor(-0.4562, dtype=torch.float64) tensor(1.7153, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2817, dtype=torch.float64) delta_t tensor(0.0614, dtype=torch.float64)
10 gae_duplicate tensor(-0.2589, dtype=torch.float64) tensor(-1.0707, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7221, dtype=torch.float64) delta_t tensor(-0.4658, dtype=torch.float64)
9 gae_duplicate tensor(-0.6136, dtype=torch.float64) tensor(9.4378, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6325, dtype=torch.float64) delta_t tensor(0.2028, dtype=torch.float64)
8 gae_duplicate tensor(0.0344, dtype=torch.float64) tensor(-3.0082, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.8087, dtype=torch.float64) delta_t tensor(-1.5922, dtype=torch.float64)
7 gae_duplicate tensor(-1.8975, dtype=torch.float64) tensor(30.0237, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4471, dtype=torch.float64) delta_t tensor(0.4051, dtype=torch.float64)
6 gae_duplicate tensor(-0.2719, dtype=torch.float64) tensor(-4.9253, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3156, dtype=torch.float64) delta_t tensor(-1.3526, dtype=torch.float64)
5 gae_duplicate tensor(-1.6359, dtype=torch.float64) tensor(26.0665, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9303, dtype=torch.float64) delta_t tensor(0.5698, dtype=torch.float64)
4 gae_duplicate tensor(0.2401, dtype=torch.float64) tensor(-8.5783, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8857, dtype=torch.float64) delta_t tensor(-0.9362, dtype=torch.float64)
3 gae_duplicate tensor(-1.0803, dtype=torch.float64) tensor(17.5423, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3042, dtype=torch.float64) delta_t tensor(0.0498, dtype=torch.float64)
2 gae_duplicate tensor(-0.3374, dtype=torch.float64) tensor(0.9166, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1084.1614990234375
value loss:71.65095520019531
entropies:354.94061279296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.739128828048706 seconds
19 rew tensor(1.0093, dtype=torch.float64) delta_t tensor(0.3752, dtype=torch.float64)
19 gae_duplicate tensor(0.0932, dtype=torch.float64) tensor(-7.4210, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9907, dtype=torch.float64) delta_t tensor(0.5275, dtype=torch.float64)
18 gae_duplicate tensor(0.1301, dtype=torch.float64) tensor(-10.8387, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8235, dtype=torch.float64) delta_t tensor(0.2818, dtype=torch.float64)
17 gae_duplicate tensor(0.0861, dtype=torch.float64) tensor(-6.7591, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8284, dtype=torch.float64) delta_t tensor(0.3527, dtype=torch.float64)
16 gae_duplicate tensor(-0.2477, dtype=torch.float64) tensor(-7.4492, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5996, dtype=torch.float64) delta_t tensor(0.1266, dtype=torch.float64)
15 gae_duplicate tensor(-0.3586, dtype=torch.float64) tensor(-3.3720, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5149, dtype=torch.float64) delta_t tensor(0.2504, dtype=torch.float64)
14 gae_duplicate tensor(-0.3892, dtype=torch.float64) tensor(-5.0303, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1791, dtype=torch.float64) delta_t tensor(-0.4152, dtype=torch.float64)
13 gae_duplicate tensor(-2.3722, dtype=torch.float64) tensor(7.4429, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5625, dtype=torch.float64) delta_t tensor(0.2811, dtype=torch.float64)
12 gae_duplicate tensor(-0.5159, dtype=torch.float64) tensor(-5.0370, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0310, dtype=torch.float64) delta_t tensor(-0.1472, dtype=torch.float64)
11 gae_duplicate tensor(-0.7937, dtype=torch.float64) tensor(2.3005, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1814, dtype=torch.float64) delta_t tensor(-0.0375, dtype=torch.float64)
10 gae_duplicate tensor(-0.7945, dtype=torch.float64) tensor(0.7849, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5195, dtype=torch.float64) delta_t tensor(-0.2825, dtype=torch.float64)
9 gae_duplicate tensor(-0.7256, dtype=torch.float64) tensor(6.0989, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3411, dtype=torch.float64) delta_t tensor(-0.0561, dtype=torch.float64)
8 gae_duplicate tensor(-1.0048, dtype=torch.float64) tensor(1.6489, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5744, dtype=torch.float64) delta_t tensor(-1.4838, dtype=torch.float64)
7 gae_duplicate tensor(-2.5700, dtype=torch.float64) tensor(28.9070, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2405, dtype=torch.float64) delta_t tensor(0.2251, dtype=torch.float64)
6 gae_duplicate tensor(-0.9196, dtype=torch.float64) tensor(-1.3886, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8952, dtype=torch.float64) delta_t tensor(-0.9991, dtype=torch.float64)
5 gae_duplicate tensor(-1.5175, dtype=torch.float64) tensor(19.7566, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.8219, dtype=torch.float64) delta_t tensor(0.5248, dtype=torch.float64)
4 gae_duplicate tensor(0.1879, dtype=torch.float64) tensor(-8.5164, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6307, dtype=torch.float64) delta_t tensor(-0.7218, dtype=torch.float64)
3 gae_duplicate tensor(-1.1205, dtype=torch.float64) tensor(13.3323, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1834, dtype=torch.float64) delta_t tensor(0.0342, dtype=torch.float64)
2 gae_duplicate tensor(-0.2755, dtype=torch.float64) tensor(0.7039, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1454.6668701171875
value loss:79.0730972290039
entropies:354.9522399902344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.742164850234985 seconds
19 rew tensor(1.0272, dtype=torch.float64) delta_t tensor(0.4378, dtype=torch.float64)
19 gae_duplicate tensor(0.0399, dtype=torch.float64) tensor(-8.6733, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9533, dtype=torch.float64) delta_t tensor(0.4504, dtype=torch.float64)
18 gae_duplicate tensor(0.0703, dtype=torch.float64) tensor(-9.5889, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8020, dtype=torch.float64) delta_t tensor(0.0673, dtype=torch.float64)
17 gae_duplicate tensor(-0.1461, dtype=torch.float64) tensor(-2.2159, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7010, dtype=torch.float64) delta_t tensor(0.3819, dtype=torch.float64)
16 gae_duplicate tensor(0.1927, dtype=torch.float64) tensor(-7.5638, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3971, dtype=torch.float64) delta_t tensor(-0.0024, dtype=torch.float64)
15 gae_duplicate tensor(-0.2842, dtype=torch.float64) tensor(-0.7739, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6981, dtype=torch.float64) delta_t tensor(0.3740, dtype=torch.float64)
14 gae_duplicate tensor(-0.0352, dtype=torch.float64) tensor(-7.6477, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0437, dtype=torch.float64) delta_t tensor(-0.2512, dtype=torch.float64)
13 gae_duplicate tensor(-0.5785, dtype=torch.float64) tensor(4.4322, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5983, dtype=torch.float64) delta_t tensor(0.1757, dtype=torch.float64)
12 gae_duplicate tensor(-0.4546, dtype=torch.float64) tensor(-3.1436, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1041, dtype=torch.float64) delta_t tensor(-0.1257, dtype=torch.float64)
11 gae_duplicate tensor(-0.8329, dtype=torch.float64) tensor(2.3258, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4094, dtype=torch.float64) delta_t tensor(0.0339, dtype=torch.float64)
10 gae_duplicate tensor(-0.5499, dtype=torch.float64) tensor(-0.4079, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8159, dtype=torch.float64) delta_t tensor(-0.4296, dtype=torch.float64)
9 gae_duplicate tensor(-0.7498, dtype=torch.float64) tensor(8.1820, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6526, dtype=torch.float64) delta_t tensor(0.1785, dtype=torch.float64)
8 gae_duplicate tensor(-0.2530, dtype=torch.float64) tensor(-2.6082, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7094, dtype=torch.float64) delta_t tensor(-1.4797, dtype=torch.float64)
7 gae_duplicate tensor(-2.0860, dtype=torch.float64) tensor(29.0517, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5663, dtype=torch.float64) delta_t tensor(0.3603, dtype=torch.float64)
6 gae_duplicate tensor(-0.3912, dtype=torch.float64) tensor(-4.2436, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1817, dtype=torch.float64) delta_t tensor(-1.2582, dtype=torch.float64)
5 gae_duplicate tensor(-1.8534, dtype=torch.float64) tensor(24.7327, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.8903, dtype=torch.float64) delta_t tensor(0.5611, dtype=torch.float64)
4 gae_duplicate tensor(0.3204, dtype=torch.float64) tensor(-8.6477, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7039, dtype=torch.float64) delta_t tensor(-0.8095, dtype=torch.float64)
3 gae_duplicate tensor(-1.6460, dtype=torch.float64) tensor(15.3412, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2117, dtype=torch.float64) delta_t tensor(-0.0127, dtype=torch.float64)
2 gae_duplicate tensor(-0.4692, dtype=torch.float64) tensor(1.5980, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1723.896484375
value loss:67.35279846191406
entropies:354.966552734375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3953.3542)
ToM Target loss= tensor(3832.6404)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.77130126953125 seconds
19 rew tensor(0.7455, dtype=torch.float64) delta_t tensor(-0.0119, dtype=torch.float64)
19 gae_duplicate tensor(-1.2693, dtype=torch.float64) tensor(0.5463, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9138, dtype=torch.float64) delta_t tensor(0.3878, dtype=torch.float64)
18 gae_duplicate tensor(-0.1378, dtype=torch.float64) tensor(-7.7455, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7916, dtype=torch.float64) delta_t tensor(0.2842, dtype=torch.float64)
17 gae_duplicate tensor(-0.1297, dtype=torch.float64) tensor(-6.2218, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7626, dtype=torch.float64) delta_t tensor(0.3139, dtype=torch.float64)
16 gae_duplicate tensor(-0.1664, dtype=torch.float64) tensor(-6.6340, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5458, dtype=torch.float64) delta_t tensor(0.0222, dtype=torch.float64)
15 gae_duplicate tensor(-0.4728, dtype=torch.float64) tensor(-1.1947, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7217, dtype=torch.float64) delta_t tensor(0.3283, dtype=torch.float64)
14 gae_duplicate tensor(-0.3582, dtype=torch.float64) tensor(-6.7050, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4583, dtype=torch.float64) delta_t tensor(0.1243, dtype=torch.float64)
13 gae_duplicate tensor(-0.6228, dtype=torch.float64) tensor(-3.0905, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5754, dtype=torch.float64) delta_t tensor(0.2359, dtype=torch.float64)
12 gae_duplicate tensor(-0.5353, dtype=torch.float64) tensor(-5.1445, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2811, dtype=torch.float64) delta_t tensor(-0.3664, dtype=torch.float64)
11 gae_duplicate tensor(-2.1656, dtype=torch.float64) tensor(7.3552, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5230, dtype=torch.float64) delta_t tensor(-0.8461, dtype=torch.float64)
10 gae_duplicate tensor(-4.2823, dtype=torch.float64) tensor(16.7340, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8301, dtype=torch.float64) delta_t tensor(-0.6492, dtype=torch.float64)
9 gae_duplicate tensor(-3.1409, dtype=torch.float64) tensor(15.2089, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3330, dtype=torch.float64) delta_t tensor(-0.0305, dtype=torch.float64)
8 gae_duplicate tensor(-0.7824, dtype=torch.float64) tensor(2.1431, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.9322, dtype=torch.float64) delta_t tensor(-1.7895, dtype=torch.float64)
7 gae_duplicate tensor(-3.9563, dtype=torch.float64) tensor(36.2511, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0178, dtype=torch.float64) delta_t tensor(-0.0592, dtype=torch.float64)
6 gae_duplicate tensor(-0.8834, dtype=torch.float64) tensor(4.4971, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8172, dtype=torch.float64) delta_t tensor(-0.9022, dtype=torch.float64)
5 gae_duplicate tensor(-1.5440, dtype=torch.float64) tensor(17.9171, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7371, dtype=torch.float64) delta_t tensor(0.4062, dtype=torch.float64)
4 gae_duplicate tensor(0.1093, dtype=torch.float64) tensor(-6.2053, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7608, dtype=torch.float64) delta_t tensor(-0.8228, dtype=torch.float64)
3 gae_duplicate tensor(-1.6638, dtype=torch.float64) tensor(15.5679, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1700, dtype=torch.float64) delta_t tensor(0.0007, dtype=torch.float64)
2 gae_duplicate tensor(-0.5150, dtype=torch.float64) tensor(1.5631, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4137.33935546875
value loss:142.89566040039062
entropies:354.9627990722656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.252604961395264 seconds
19 rew tensor(0.9517, dtype=torch.float64) delta_t tensor(0.1382, dtype=torch.float64)
19 gae_duplicate tensor(-0.3060, dtype=torch.float64) tensor(-2.8694, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8097, dtype=torch.float64) delta_t tensor(0.1497, dtype=torch.float64)
18 gae_duplicate tensor(-0.1217, dtype=torch.float64) tensor(-3.0825, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6481, dtype=torch.float64) delta_t tensor(0.0410, dtype=torch.float64)
17 gae_duplicate tensor(-0.2175, dtype=torch.float64) tensor(-1.0931, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5785, dtype=torch.float64) delta_t tensor(0.1624, dtype=torch.float64)
16 gae_duplicate tensor(-0.3084, dtype=torch.float64) tensor(-3.3123, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4370, dtype=torch.float64) delta_t tensor(0.0944, dtype=torch.float64)
15 gae_duplicate tensor(-0.2992, dtype=torch.float64) tensor(-1.9764, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3798, dtype=torch.float64) delta_t tensor(0.0650, dtype=torch.float64)
14 gae_duplicate tensor(-0.3527, dtype=torch.float64) tensor(-1.5482, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2035, dtype=torch.float64) delta_t tensor(0.0347, dtype=torch.float64)
13 gae_duplicate tensor(-0.6160, dtype=torch.float64) tensor(-1.1720, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3351, dtype=torch.float64) delta_t tensor(0.0069, dtype=torch.float64)
12 gae_duplicate tensor(-0.3782, dtype=torch.float64) tensor(-0.0711, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0486, dtype=torch.float64) delta_t tensor(-0.2104, dtype=torch.float64)
11 gae_duplicate tensor(-0.8531, dtype=torch.float64) tensor(3.7971, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2858, dtype=torch.float64) delta_t tensor(0.0698, dtype=torch.float64)
10 gae_duplicate tensor(-0.8183, dtype=torch.float64) tensor(-0.8044, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3267, dtype=torch.float64) delta_t tensor(-0.3535, dtype=torch.float64)
9 gae_duplicate tensor(-0.7594, dtype=torch.float64) tensor(6.7950, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2098, dtype=torch.float64) delta_t tensor(0.0046, dtype=torch.float64)
8 gae_duplicate tensor(-1.1402, dtype=torch.float64) tensor(0.4244, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5178, dtype=torch.float64) delta_t tensor(-0.5834, dtype=torch.float64)
7 gae_duplicate tensor(-1.5319, dtype=torch.float64) tensor(11.5461, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1781, dtype=torch.float64) delta_t tensor(-0.3332, dtype=torch.float64)
6 gae_duplicate tensor(-1.3453, dtype=torch.float64) tensor(8.1954, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.2674, dtype=torch.float64) delta_t tensor(-0.4792, dtype=torch.float64)
5 gae_duplicate tensor(-1.4966, dtype=torch.float64) tensor(10.1737, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5061, dtype=torch.float64) delta_t tensor(0.2644, dtype=torch.float64)
4 gae_duplicate tensor(-0.3439, dtype=torch.float64) tensor(-4.1913, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0441, dtype=torch.float64) delta_t tensor(-0.3009, dtype=torch.float64)
3 gae_duplicate tensor(-0.9220, dtype=torch.float64) tensor(5.9869, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1851, dtype=torch.float64) delta_t tensor(-0.2500, dtype=torch.float64)
2 gae_duplicate tensor(-0.5601, dtype=torch.float64) tensor(5.5382, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1841.973876953125
value loss:39.04230880737305
entropies:354.8796081542969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.052046775817871 seconds
19 rew tensor(1.0561, dtype=torch.float64) delta_t tensor(0.1780, dtype=torch.float64)
19 gae_duplicate tensor(-0.0911, dtype=torch.float64) tensor(-3.5118, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9588, dtype=torch.float64) delta_t tensor(0.4413, dtype=torch.float64)
18 gae_duplicate tensor(0.0256, dtype=torch.float64) tensor(-9.0208, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8125, dtype=torch.float64) delta_t tensor(-0.0033, dtype=torch.float64)
17 gae_duplicate tensor(-0.1880, dtype=torch.float64) tensor(-0.8359, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7541, dtype=torch.float64) delta_t tensor(0.2596, dtype=torch.float64)
16 gae_duplicate tensor(-0.2009, dtype=torch.float64) tensor(-5.0954, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2898, dtype=torch.float64) delta_t tensor(-0.1120, dtype=torch.float64)
15 gae_duplicate tensor(-0.4024, dtype=torch.float64) tensor(1.7989, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5688, dtype=torch.float64) delta_t tensor(0.2373, dtype=torch.float64)
14 gae_duplicate tensor(-0.2098, dtype=torch.float64) tensor(-4.4167, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0918, dtype=torch.float64) delta_t tensor(-0.3119, dtype=torch.float64)
13 gae_duplicate tensor(-0.5958, dtype=torch.float64) tensor(5.6925, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5197, dtype=torch.float64) delta_t tensor(0.0696, dtype=torch.float64)
12 gae_duplicate tensor(-0.6256, dtype=torch.float64) tensor(-1.0509, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0893, dtype=torch.float64) delta_t tensor(-0.2477, dtype=torch.float64)
11 gae_duplicate tensor(-0.6077, dtype=torch.float64) tensor(4.9030, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2948, dtype=torch.float64) delta_t tensor(-0.0991, dtype=torch.float64)
10 gae_duplicate tensor(-0.5991, dtype=torch.float64) tensor(2.4594, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5756, dtype=torch.float64) delta_t tensor(-0.1411, dtype=torch.float64)
9 gae_duplicate tensor(-0.5811, dtype=torch.float64) tensor(2.9840, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3362, dtype=torch.float64) delta_t tensor(-0.2428, dtype=torch.float64)
8 gae_duplicate tensor(-0.3692, dtype=torch.float64) tensor(5.0561, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3749, dtype=torch.float64) delta_t tensor(-1.1052, dtype=torch.float64)
7 gae_duplicate tensor(-1.4622, dtype=torch.float64) tensor(22.6890, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5428, dtype=torch.float64) delta_t tensor(0.3521, dtype=torch.float64)
6 gae_duplicate tensor(-0.5592, dtype=torch.float64) tensor(-4.6549, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0360, dtype=torch.float64) delta_t tensor(-1.1511, dtype=torch.float64)
5 gae_duplicate tensor(-1.4206, dtype=torch.float64) tensor(22.8476, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7822, dtype=torch.float64) delta_t tensor(0.4308, dtype=torch.float64)
4 gae_duplicate tensor(-0.1268, dtype=torch.float64) tensor(-6.1877, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4408, dtype=torch.float64) delta_t tensor(-0.5478, dtype=torch.float64)
3 gae_duplicate tensor(-0.7464, dtype=torch.float64) tensor(10.1228, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0171, dtype=torch.float64) delta_t tensor(-0.3912, dtype=torch.float64)
2 gae_duplicate tensor(-0.7617, dtype=torch.float64) tensor(8.9198, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2941.52978515625
value loss:47.99513244628906
entropies:354.75115966796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.292379856109619 seconds
19 rew tensor(0.9512, dtype=torch.float64) delta_t tensor(0.1298, dtype=torch.float64)
19 gae_duplicate tensor(-0.1998, dtype=torch.float64) tensor(-2.3873, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.5652, dtype=torch.float64) delta_t tensor(-0.0010, dtype=torch.float64)
18 gae_duplicate tensor(-1.0064, dtype=torch.float64) tensor(-0.4665, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7650, dtype=torch.float64) delta_t tensor(0.0104, dtype=torch.float64)
17 gae_duplicate tensor(-0.3694, dtype=torch.float64) tensor(-0.1721, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6995, dtype=torch.float64) delta_t tensor(0.1711, dtype=torch.float64)
16 gae_duplicate tensor(-0.7783, dtype=torch.float64) tensor(-3.5412, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5535, dtype=torch.float64) delta_t tensor(0.0190, dtype=torch.float64)
15 gae_duplicate tensor(-0.1601, dtype=torch.float64) tensor(-0.8280, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7280, dtype=torch.float64) delta_t tensor(0.2431, dtype=torch.float64)
14 gae_duplicate tensor(-0.1399, dtype=torch.float64) tensor(-4.8070, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2713, dtype=torch.float64) delta_t tensor(-0.0030, dtype=torch.float64)
13 gae_duplicate tensor(-0.2676, dtype=torch.float64) tensor(-0.3005, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7691, dtype=torch.float64) delta_t tensor(0.3382, dtype=torch.float64)
12 gae_duplicate tensor(0.0202, dtype=torch.float64) tensor(-6.6212, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1314, dtype=torch.float64) delta_t tensor(0.0840, dtype=torch.float64)
11 gae_duplicate tensor(-0.3335, dtype=torch.float64) tensor(-2.4136, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3345, dtype=torch.float64) delta_t tensor(0.0689, dtype=torch.float64)
10 gae_duplicate tensor(-0.5322, dtype=torch.float64) tensor(-1.6315, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6556, dtype=torch.float64) delta_t tensor(-0.2239, dtype=torch.float64)
9 gae_duplicate tensor(-0.5105, dtype=torch.float64) tensor(4.4094, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4070, dtype=torch.float64) delta_t tensor(-0.0616, dtype=torch.float64)
8 gae_duplicate tensor(-0.4802, dtype=torch.float64) tensor(1.6204, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.2375, dtype=torch.float64) delta_t tensor(-1.8460, dtype=torch.float64)
7 gae_duplicate tensor(-4.9245, dtype=torch.float64) tensor(35.2891, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2053, dtype=torch.float64) delta_t tensor(-0.2208, dtype=torch.float64)
6 gae_duplicate tensor(-1.1365, dtype=torch.float64) tensor(7.9206, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0616, dtype=torch.float64) delta_t tensor(-1.0295, dtype=torch.float64)
5 gae_duplicate tensor(-1.5809, dtype=torch.float64) tensor(20.9248, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7137, dtype=torch.float64) delta_t tensor(0.2100, dtype=torch.float64)
4 gae_duplicate tensor(-0.2364, dtype=torch.float64) tensor(-2.1008, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9755, dtype=torch.float64) delta_t tensor(-0.7873, dtype=torch.float64)
3 gae_duplicate tensor(-1.2271, dtype=torch.float64) tensor(15.0463, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3514, dtype=torch.float64) delta_t tensor(0.0325, dtype=torch.float64)
2 gae_duplicate tensor(-0.4477, dtype=torch.float64) tensor(0.8939, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3380.8017578125
value loss:91.60724639892578
entropies:354.5180969238281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.900726079940796 seconds
19 rew tensor(0.9639, dtype=torch.float64) delta_t tensor(0.1780, dtype=torch.float64)
19 gae_duplicate tensor(-0.0114, dtype=torch.float64) tensor(-3.4835, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9552, dtype=torch.float64) delta_t tensor(0.2597, dtype=torch.float64)
18 gae_duplicate tensor(-0.1791, dtype=torch.float64) tensor(-5.5267, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8769, dtype=torch.float64) delta_t tensor(0.2369, dtype=torch.float64)
17 gae_duplicate tensor(-0.0218, dtype=torch.float64) tensor(-5.3818, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7814, dtype=torch.float64) delta_t tensor(0.1951, dtype=torch.float64)
16 gae_duplicate tensor(-0.0751, dtype=torch.float64) tensor(-4.2737, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7179, dtype=torch.float64) delta_t tensor(0.2188, dtype=torch.float64)
15 gae_duplicate tensor(-0.2840, dtype=torch.float64) tensor(-5.0105, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5876, dtype=torch.float64) delta_t tensor(0.1503, dtype=torch.float64)
14 gae_duplicate tensor(-0.0679, dtype=torch.float64) tensor(-3.4391, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3398, dtype=torch.float64) delta_t tensor(0.0743, dtype=torch.float64)
13 gae_duplicate tensor(-1.0211, dtype=torch.float64) tensor(-1.4740, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3465, dtype=torch.float64) delta_t tensor(-0.7994, dtype=torch.float64)
12 gae_duplicate tensor(-3.6802, dtype=torch.float64) tensor(16.3988, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3558, dtype=torch.float64) delta_t tensor(-0.3577, dtype=torch.float64)
11 gae_duplicate tensor(-4.5615, dtype=torch.float64) tensor(8.7443, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2120, dtype=torch.float64) delta_t tensor(-0.0451, dtype=torch.float64)
10 gae_duplicate tensor(-0.6419, dtype=torch.float64) tensor(1.7155, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4261, dtype=torch.float64) delta_t tensor(-0.1492, dtype=torch.float64)
9 gae_duplicate tensor(-0.4559, dtype=torch.float64) tensor(3.0292, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1249, dtype=torch.float64) delta_t tensor(-0.1790, dtype=torch.float64)
8 gae_duplicate tensor(-0.6652, dtype=torch.float64) tensor(4.1310, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1101, dtype=torch.float64) delta_t tensor(-0.7990, dtype=torch.float64)
7 gae_duplicate tensor(-1.3227, dtype=torch.float64) tensor(16.2735, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1400, dtype=torch.float64) delta_t tensor(-0.1098, dtype=torch.float64)
6 gae_duplicate tensor(-1.2936, dtype=torch.float64) tensor(4.0518, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7507, dtype=torch.float64) delta_t tensor(-0.8731, dtype=torch.float64)
5 gae_duplicate tensor(-1.5094, dtype=torch.float64) tensor(17.5118, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4378, dtype=torch.float64) delta_t tensor(0.1945, dtype=torch.float64)
4 gae_duplicate tensor(-0.3521, dtype=torch.float64) tensor(-1.9411, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4405, dtype=torch.float64) delta_t tensor(-0.1978, dtype=torch.float64)
3 gae_duplicate tensor(-0.9391, dtype=torch.float64) tensor(3.3092, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0024, dtype=torch.float64) delta_t tensor(-0.0345, dtype=torch.float64)
2 gae_duplicate tensor(-0.6803, dtype=torch.float64) tensor(1.2077, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2571.183837890625
value loss:97.98187255859375
entropies:354.40460205078125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3946.1768)
ToM Target loss= tensor(3848.9082)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.227624893188477 seconds
19 rew tensor(1.0403, dtype=torch.float64) delta_t tensor(0.1374, dtype=torch.float64)
19 gae_duplicate tensor(-0.0883, dtype=torch.float64) tensor(-2.5942, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0213, dtype=torch.float64) delta_t tensor(0.2837, dtype=torch.float64)
18 gae_duplicate tensor(0.0177, dtype=torch.float64) tensor(-6.0704, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9137, dtype=torch.float64) delta_t tensor(0.1811, dtype=torch.float64)
17 gae_duplicate tensor(-0.0730, dtype=torch.float64) tensor(-3.9386, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6789, dtype=torch.float64) delta_t tensor(0.1788, dtype=torch.float64)
16 gae_duplicate tensor(-0.0821, dtype=torch.float64) tensor(-3.8227, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2816, dtype=torch.float64) delta_t tensor(0.0543, dtype=torch.float64)
15 gae_duplicate tensor(-0.0371, dtype=torch.float64) tensor(-1.5466, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5602, dtype=torch.float64) delta_t tensor(0.1635, dtype=torch.float64)
14 gae_duplicate tensor(-0.2259, dtype=torch.float64) tensor(-3.2016, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0647, dtype=torch.float64) delta_t tensor(-0.1498, dtype=torch.float64)
13 gae_duplicate tensor(-0.3615, dtype=torch.float64) tensor(2.6416, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6756, dtype=torch.float64) delta_t tensor(0.2297, dtype=torch.float64)
12 gae_duplicate tensor(-0.3812, dtype=torch.float64) tensor(-4.2263, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1447, dtype=torch.float64) delta_t tensor(-0.1094, dtype=torch.float64)
11 gae_duplicate tensor(-0.6262, dtype=torch.float64) tensor(1.9953, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1742, dtype=torch.float64) delta_t tensor(-0.2680, dtype=torch.float64)
10 gae_duplicate tensor(-0.4869, dtype=torch.float64) tensor(5.8200, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8647, dtype=torch.float64) delta_t tensor(-0.0764, dtype=torch.float64)
9 gae_duplicate tensor(-0.4572, dtype=torch.float64) tensor(1.9857, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6607, dtype=torch.float64) delta_t tensor(-0.0622, dtype=torch.float64)
8 gae_duplicate tensor(-0.3238, dtype=torch.float64) tensor(1.3077, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.0040, dtype=torch.float64) delta_t tensor(-1.2815, dtype=torch.float64)
7 gae_duplicate tensor(-1.6399, dtype=torch.float64) tensor(26.4132, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.6445, dtype=torch.float64) delta_t tensor(0.2733, dtype=torch.float64)
6 gae_duplicate tensor(-0.0579, dtype=torch.float64) tensor(-2.8609, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3348, dtype=torch.float64) delta_t tensor(-1.2909, dtype=torch.float64)
5 gae_duplicate tensor(-1.6486, dtype=torch.float64) tensor(25.4119, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9346, dtype=torch.float64) delta_t tensor(0.4130, dtype=torch.float64)
4 gae_duplicate tensor(-0.0897, dtype=torch.float64) tensor(-5.6024, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7948, dtype=torch.float64) delta_t tensor(-0.5834, dtype=torch.float64)
3 gae_duplicate tensor(-0.8768, dtype=torch.float64) tensor(10.9947, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2542, dtype=torch.float64) delta_t tensor(-0.1427, dtype=torch.float64)
2 gae_duplicate tensor(-0.4448, dtype=torch.float64) tensor(4.0528, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2620.647216796875
value loss:46.93513870239258
entropies:354.25494384765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.909680128097534 seconds
19 rew tensor(1.0672, dtype=torch.float64) delta_t tensor(0.0753, dtype=torch.float64)
19 gae_duplicate tensor(-0.2892, dtype=torch.float64) tensor(-1.6897, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9810, dtype=torch.float64) delta_t tensor(0.2895, dtype=torch.float64)
18 gae_duplicate tensor(-0.1257, dtype=torch.float64) tensor(-6.1934, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8293, dtype=torch.float64) delta_t tensor(0.0230, dtype=torch.float64)
17 gae_duplicate tensor(-0.2051, dtype=torch.float64) tensor(-1.0352, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7103, dtype=torch.float64) delta_t tensor(0.2368, dtype=torch.float64)
16 gae_duplicate tensor(-0.0311, dtype=torch.float64) tensor(-4.7815, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4191, dtype=torch.float64) delta_t tensor(0.0991, dtype=torch.float64)
15 gae_duplicate tensor(-0.1912, dtype=torch.float64) tensor(-2.4553, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6239, dtype=torch.float64) delta_t tensor(0.2227, dtype=torch.float64)
14 gae_duplicate tensor(-0.1957, dtype=torch.float64) tensor(-4.5594, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0357, dtype=torch.float64) delta_t tensor(-0.0097, dtype=torch.float64)
13 gae_duplicate tensor(-0.3072, dtype=torch.float64) tensor(-0.2317, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6320, dtype=torch.float64) delta_t tensor(0.1314, dtype=torch.float64)
12 gae_duplicate tensor(-0.3453, dtype=torch.float64) tensor(-2.7662, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1249, dtype=torch.float64) delta_t tensor(-0.0327, dtype=torch.float64)
11 gae_duplicate tensor(-0.4228, dtype=torch.float64) tensor(0.3811, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2317, dtype=torch.float64) delta_t tensor(-0.1362, dtype=torch.float64)
10 gae_duplicate tensor(-0.3772, dtype=torch.float64) tensor(2.7574, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8191, dtype=torch.float64) delta_t tensor(-0.0537, dtype=torch.float64)
9 gae_duplicate tensor(-0.5536, dtype=torch.float64) tensor(1.2884, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6738, dtype=torch.float64) delta_t tensor(-0.0740, dtype=torch.float64)
8 gae_duplicate tensor(-0.2896, dtype=torch.float64) tensor(1.6747, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.8949, dtype=torch.float64) delta_t tensor(-1.0575, dtype=torch.float64)
7 gae_duplicate tensor(-1.4137, dtype=torch.float64) tensor(21.2708, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5311, dtype=torch.float64) delta_t tensor(0.2180, dtype=torch.float64)
6 gae_duplicate tensor(-0.0996, dtype=torch.float64) tensor(-2.1849, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3608, dtype=torch.float64) delta_t tensor(-1.2618, dtype=torch.float64)
5 gae_duplicate tensor(-1.5739, dtype=torch.float64) tensor(24.9512, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.8942, dtype=torch.float64) delta_t tensor(0.3792, dtype=torch.float64)
4 gae_duplicate tensor(-0.1668, dtype=torch.float64) tensor(-4.8112, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8700, dtype=torch.float64) delta_t tensor(-0.5110, dtype=torch.float64)
3 gae_duplicate tensor(-0.7889, dtype=torch.float64) tensor(9.6563, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2763, dtype=torch.float64) delta_t tensor(-0.1692, dtype=torch.float64)
2 gae_duplicate tensor(-0.6370, dtype=torch.float64) tensor(4.2820, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2015.4595947265625
value loss:38.976585388183594
entropies:354.010498046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0199878215789795 seconds
19 rew tensor(0.9870, dtype=torch.float64) delta_t tensor(0.1260, dtype=torch.float64)
19 gae_duplicate tensor(-0.2191, dtype=torch.float64) tensor(-2.5371, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9202, dtype=torch.float64) delta_t tensor(0.2620, dtype=torch.float64)
18 gae_duplicate tensor(0.0251, dtype=torch.float64) tensor(-5.1265, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9147, dtype=torch.float64) delta_t tensor(0.1703, dtype=torch.float64)
17 gae_duplicate tensor(-0.1523, dtype=torch.float64) tensor(-3.7420, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7852, dtype=torch.float64) delta_t tensor(0.2396, dtype=torch.float64)
16 gae_duplicate tensor(-0.1543, dtype=torch.float64) tensor(-4.9036, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7077, dtype=torch.float64) delta_t tensor(0.2120, dtype=torch.float64)
15 gae_duplicate tensor(-0.0869, dtype=torch.float64) tensor(-4.5639, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6602, dtype=torch.float64) delta_t tensor(0.2767, dtype=torch.float64)
14 gae_duplicate tensor(0.0656, dtype=torch.float64) tensor(-5.6961, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.3204, dtype=torch.float64) delta_t tensor(-0.4631, dtype=torch.float64)
13 gae_duplicate tensor(-2.4456, dtype=torch.float64) tensor(7.7746, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0690, dtype=torch.float64) delta_t tensor(-0.3032, dtype=torch.float64)
12 gae_duplicate tensor(-2.2690, dtype=torch.float64) tensor(7.3963, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3743, dtype=torch.float64) delta_t tensor(-0.2210, dtype=torch.float64)
11 gae_duplicate tensor(-3.3097, dtype=torch.float64) tensor(4.3201, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3492, dtype=torch.float64) delta_t tensor(0.1239, dtype=torch.float64)
10 gae_duplicate tensor(-0.3463, dtype=torch.float64) tensor(-1.7779, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5834, dtype=torch.float64) delta_t tensor(0.0957, dtype=torch.float64)
9 gae_duplicate tensor(-0.3357, dtype=torch.float64) tensor(-1.8371, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1029, dtype=torch.float64) delta_t tensor(-0.2286, dtype=torch.float64)
8 gae_duplicate tensor(-0.6125, dtype=torch.float64) tensor(4.1872, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.0465, dtype=torch.float64) delta_t tensor(-1.4615, dtype=torch.float64)
7 gae_duplicate tensor(-4.2560, dtype=torch.float64) tensor(30.9262, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1315, dtype=torch.float64) delta_t tensor(0.0807, dtype=torch.float64)
6 gae_duplicate tensor(-1.0335, dtype=torch.float64) tensor(0.9262, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0614, dtype=torch.float64) delta_t tensor(-0.8723, dtype=torch.float64)
5 gae_duplicate tensor(-1.4128, dtype=torch.float64) tensor(16.7760, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.6944, dtype=torch.float64) delta_t tensor(0.3785, dtype=torch.float64)
4 gae_duplicate tensor(-0.2020, dtype=torch.float64) tensor(-5.3589, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6323, dtype=torch.float64) delta_t tensor(-0.3504, dtype=torch.float64)
3 gae_duplicate tensor(-0.9068, dtype=torch.float64) tensor(6.3079, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0107, dtype=torch.float64) delta_t tensor(-0.1465, dtype=torch.float64)
2 gae_duplicate tensor(-0.5020, dtype=torch.float64) tensor(3.3841, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2604.10888671875
value loss:99.35174560546875
entropies:353.7805480957031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.906944036483765 seconds
19 rew tensor(0.8013, dtype=torch.float64) delta_t tensor(-0.1352, dtype=torch.float64)
19 gae_duplicate tensor(-1.6328, dtype=torch.float64) tensor(2.2149, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9413, dtype=torch.float64) delta_t tensor(0.2115, dtype=torch.float64)
18 gae_duplicate tensor(-0.1348, dtype=torch.float64) tensor(-3.7854, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7520, dtype=torch.float64) delta_t tensor(-0.2416, dtype=torch.float64)
17 gae_duplicate tensor(-1.3765, dtype=torch.float64) tensor(4.3169, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8045, dtype=torch.float64) delta_t tensor(0.1955, dtype=torch.float64)
16 gae_duplicate tensor(-0.0524, dtype=torch.float64) tensor(-3.2990, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8265, dtype=torch.float64) delta_t tensor(0.3734, dtype=torch.float64)
15 gae_duplicate tensor(0.1169, dtype=torch.float64) tensor(-7.9089, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4747, dtype=torch.float64) delta_t tensor(0.0288, dtype=torch.float64)
14 gae_duplicate tensor(-0.1161, dtype=torch.float64) tensor(-1.2152, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3619, dtype=torch.float64) delta_t tensor(0.1381, dtype=torch.float64)
13 gae_duplicate tensor(-0.2235, dtype=torch.float64) tensor(-2.8246, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6102, dtype=torch.float64) delta_t tensor(0.1958, dtype=torch.float64)
12 gae_duplicate tensor(-0.2365, dtype=torch.float64) tensor(-4.0331, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1974, dtype=torch.float64) delta_t tensor(0.4259, dtype=torch.float64)
11 gae_duplicate tensor(-0.1005, dtype=torch.float64) tensor(-8.6705, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0232, dtype=torch.float64) delta_t tensor(-0.3421, dtype=torch.float64)
10 gae_duplicate tensor(-0.5806, dtype=torch.float64) tensor(6.0910, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7709, dtype=torch.float64) delta_t tensor(0.0985, dtype=torch.float64)
9 gae_duplicate tensor(-0.0470, dtype=torch.float64) tensor(-1.4599, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7681, dtype=torch.float64) delta_t tensor(0.1320, dtype=torch.float64)
8 gae_duplicate tensor(-0.1268, dtype=torch.float64) tensor(-3.0078, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.7119, dtype=torch.float64) delta_t tensor(-1.7120, dtype=torch.float64)
7 gae_duplicate tensor(-4.9577, dtype=torch.float64) tensor(33.0982, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1557, dtype=torch.float64) delta_t tensor(0.0945, dtype=torch.float64)
6 gae_duplicate tensor(-0.8407, dtype=torch.float64) tensor(1.8792, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4901, dtype=torch.float64) delta_t tensor(-1.3064, dtype=torch.float64)
5 gae_duplicate tensor(-1.4189, dtype=torch.float64) tensor(25.0768, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9347, dtype=torch.float64) delta_t tensor(0.2233, dtype=torch.float64)
4 gae_duplicate tensor(-0.1064, dtype=torch.float64) tensor(-1.7110, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3784, dtype=torch.float64) delta_t tensor(-0.6547, dtype=torch.float64)
3 gae_duplicate tensor(-1.0420, dtype=torch.float64) tensor(12.6119, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6370, dtype=torch.float64) delta_t tensor(0.1888, dtype=torch.float64)
2 gae_duplicate tensor(-0.1305, dtype=torch.float64) tensor(-2.4680, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2520.33984375
value loss:85.45820617675781
entropies:353.49774169921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.797608137130737 seconds
19 rew tensor(0.9718, dtype=torch.float64) delta_t tensor(-0.0196, dtype=torch.float64)
19 gae_duplicate tensor(-0.3603, dtype=torch.float64) tensor(0.1856, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8949, dtype=torch.float64) delta_t tensor(0.1989, dtype=torch.float64)
18 gae_duplicate tensor(-0.0740, dtype=torch.float64) tensor(-3.8698, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6641, dtype=torch.float64) delta_t tensor(0.0817, dtype=torch.float64)
17 gae_duplicate tensor(-0.0900, dtype=torch.float64) tensor(-2.0109, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8192, dtype=torch.float64) delta_t tensor(0.2516, dtype=torch.float64)
16 gae_duplicate tensor(-0.0499, dtype=torch.float64) tensor(-5.2232, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3651, dtype=torch.float64) delta_t tensor(0.1436, dtype=torch.float64)
15 gae_duplicate tensor(-0.3652, dtype=torch.float64) tensor(-2.8387, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6144, dtype=torch.float64) delta_t tensor(0.1998, dtype=torch.float64)
14 gae_duplicate tensor(-0.9662, dtype=torch.float64) tensor(-4.2962, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.4508, dtype=torch.float64) delta_t tensor(-0.3413, dtype=torch.float64)
13 gae_duplicate tensor(-0.9629, dtype=torch.float64) tensor(6.3141, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5228, dtype=torch.float64) delta_t tensor(0.0913, dtype=torch.float64)
12 gae_duplicate tensor(-0.5358, dtype=torch.float64) tensor(-1.3656, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2972, dtype=torch.float64) delta_t tensor(0.1213, dtype=torch.float64)
11 gae_duplicate tensor(-0.5107, dtype=torch.float64) tensor(-2.3145, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6075, dtype=torch.float64) delta_t tensor(0.1664, dtype=torch.float64)
10 gae_duplicate tensor(-0.4568, dtype=torch.float64) tensor(-3.5051, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7430, dtype=torch.float64) delta_t tensor(0.0566, dtype=torch.float64)
9 gae_duplicate tensor(-0.2665, dtype=torch.float64) tensor(-1.5124, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5888, dtype=torch.float64) delta_t tensor(0.1331, dtype=torch.float64)
8 gae_duplicate tensor(-0.6027, dtype=torch.float64) tensor(-2.7450, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6616, dtype=torch.float64) delta_t tensor(-0.8748, dtype=torch.float64)
7 gae_duplicate tensor(-1.8529, dtype=torch.float64) tensor(17.3219, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5113, dtype=torch.float64) delta_t tensor(0.2692, dtype=torch.float64)
6 gae_duplicate tensor(-0.0496, dtype=torch.float64) tensor(-3.6490, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0002, dtype=torch.float64) delta_t tensor(-0.7399, dtype=torch.float64)
5 gae_duplicate tensor(-1.0631, dtype=torch.float64) tensor(13.6566, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.8402, dtype=torch.float64) delta_t tensor(0.5343, dtype=torch.float64)
4 gae_duplicate tensor(0.2377, dtype=torch.float64) tensor(-8.9537, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5370, dtype=torch.float64) delta_t tensor(-0.1552, dtype=torch.float64)
3 gae_duplicate tensor(-0.5413, dtype=torch.float64) tensor(2.0351, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0594, dtype=torch.float64) delta_t tensor(0.0042, dtype=torch.float64)
2 gae_duplicate tensor(-0.5898, dtype=torch.float64) tensor(0.1740, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:44.84320068359375
value loss:35.587791442871094
entropies:353.31768798828125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3939.3650)
ToM Target loss= tensor(3869.5603)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.917618989944458 seconds
19 rew tensor(1.0399, dtype=torch.float64) delta_t tensor(-0.0268, dtype=torch.float64)
19 gae_duplicate tensor(-0.2811, dtype=torch.float64) tensor(0.4123, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0297, dtype=torch.float64) delta_t tensor(0.1309, dtype=torch.float64)
18 gae_duplicate tensor(-0.2426, dtype=torch.float64) tensor(-2.4410, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9250, dtype=torch.float64) delta_t tensor(0.0422, dtype=torch.float64)
17 gae_duplicate tensor(-0.2916, dtype=torch.float64) tensor(-1.0124, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8173, dtype=torch.float64) delta_t tensor(0.1931, dtype=torch.float64)
16 gae_duplicate tensor(-0.1228, dtype=torch.float64) tensor(-3.8808, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6438, dtype=torch.float64) delta_t tensor(0.2082, dtype=torch.float64)
15 gae_duplicate tensor(0.1163, dtype=torch.float64) tensor(-4.6523, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5569, dtype=torch.float64) delta_t tensor(0.1419, dtype=torch.float64)
14 gae_duplicate tensor(0.0054, dtype=torch.float64) tensor(-3.0921, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4233, dtype=torch.float64) delta_t tensor(0.2876, dtype=torch.float64)
13 gae_duplicate tensor(-0.0878, dtype=torch.float64) tensor(-5.9413, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2433, dtype=torch.float64) delta_t tensor(-0.2117, dtype=torch.float64)
12 gae_duplicate tensor(-1.5622, dtype=torch.float64) tensor(3.2045, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2167, dtype=torch.float64) delta_t tensor(0.4019, dtype=torch.float64)
11 gae_duplicate tensor(-0.0962, dtype=torch.float64) tensor(-7.2802, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1665, dtype=torch.float64) delta_t tensor(-0.1918, dtype=torch.float64)
10 gae_duplicate tensor(-0.5952, dtype=torch.float64) tensor(3.1786, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6694, dtype=torch.float64) delta_t tensor(0.3114, dtype=torch.float64)
9 gae_duplicate tensor(0.1265, dtype=torch.float64) tensor(-5.7560, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5803, dtype=torch.float64) delta_t tensor(-0.0322, dtype=torch.float64)
8 gae_duplicate tensor(-0.4580, dtype=torch.float64) tensor(-0.1715, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.3688, dtype=torch.float64) delta_t tensor(-1.2371, dtype=torch.float64)
7 gae_duplicate tensor(-3.1480, dtype=torch.float64) tensor(25.6715, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1293, dtype=torch.float64) delta_t tensor(0.1705, dtype=torch.float64)
6 gae_duplicate tensor(-0.7883, dtype=torch.float64) tensor(-1.0922, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5105, dtype=torch.float64) delta_t tensor(-1.1731, dtype=torch.float64)
5 gae_duplicate tensor(-1.3268, dtype=torch.float64) tensor(23.6570, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9345, dtype=torch.float64) delta_t tensor(0.2508, dtype=torch.float64)
4 gae_duplicate tensor(-0.1142, dtype=torch.float64) tensor(-2.4902, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3281, dtype=torch.float64) delta_t tensor(-0.5911, dtype=torch.float64)
3 gae_duplicate tensor(-1.0266, dtype=torch.float64) tensor(10.9298, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4625, dtype=torch.float64) delta_t tensor(0.0083, dtype=torch.float64)
2 gae_duplicate tensor(-0.4320, dtype=torch.float64) tensor(0.9873, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1727.850341796875
value loss:53.48310089111328
entropies:353.26068115234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.730492830276489 seconds
19 rew tensor(1.0151, dtype=torch.float64) delta_t tensor(-0.0078, dtype=torch.float64)
19 gae_duplicate tensor(-0.5300, dtype=torch.float64) tensor(0.2797, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9092, dtype=torch.float64) delta_t tensor(0.1262, dtype=torch.float64)
18 gae_duplicate tensor(-0.4878, dtype=torch.float64) tensor(-2.6301, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8340, dtype=torch.float64) delta_t tensor(0.1429, dtype=torch.float64)
17 gae_duplicate tensor(-0.2219, dtype=torch.float64) tensor(-2.9457, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7689, dtype=torch.float64) delta_t tensor(0.1114, dtype=torch.float64)
16 gae_duplicate tensor(0.0036, dtype=torch.float64) tensor(-2.3988, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6006, dtype=torch.float64) delta_t tensor(0.2984, dtype=torch.float64)
15 gae_duplicate tensor(0.0205, dtype=torch.float64) tensor(-6.0630, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0637, dtype=torch.float64) delta_t tensor(-0.4500, dtype=torch.float64)
14 gae_duplicate tensor(-3.4619, dtype=torch.float64) tensor(7.4278, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0300, dtype=torch.float64) delta_t tensor(0.0483, dtype=torch.float64)
13 gae_duplicate tensor(-0.9718, dtype=torch.float64) tensor(-0.3309, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5747, dtype=torch.float64) delta_t tensor(0.1190, dtype=torch.float64)
12 gae_duplicate tensor(-0.2161, dtype=torch.float64) tensor(-2.5593, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4748, dtype=torch.float64) delta_t tensor(-0.2268, dtype=torch.float64)
11 gae_duplicate tensor(-2.2641, dtype=torch.float64) tensor(4.3223, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3563, dtype=torch.float64) delta_t tensor(0.0056, dtype=torch.float64)
10 gae_duplicate tensor(-0.2746, dtype=torch.float64) tensor(0.4430, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7609, dtype=torch.float64) delta_t tensor(0.2155, dtype=torch.float64)
9 gae_duplicate tensor(-0.1551, dtype=torch.float64) tensor(-4.2591, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5476, dtype=torch.float64) delta_t tensor(-0.0531, dtype=torch.float64)
8 gae_duplicate tensor(-0.3605, dtype=torch.float64) tensor(0.7635, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.3966, dtype=torch.float64) delta_t tensor(-1.3388, dtype=torch.float64)
7 gae_duplicate tensor(-4.9875, dtype=torch.float64) tensor(27.6002, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4285, dtype=torch.float64) delta_t tensor(0.3421, dtype=torch.float64)
6 gae_duplicate tensor(-0.1302, dtype=torch.float64) tensor(-4.0544, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3551, dtype=torch.float64) delta_t tensor(-1.0417, dtype=torch.float64)
5 gae_duplicate tensor(-1.3149, dtype=torch.float64) tensor(19.8381, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.8655, dtype=torch.float64) delta_t tensor(0.5218, dtype=torch.float64)
4 gae_duplicate tensor(0.1410, dtype=torch.float64) tensor(-8.1297, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8846, dtype=torch.float64) delta_t tensor(-0.3284, dtype=torch.float64)
3 gae_duplicate tensor(-0.7028, dtype=torch.float64) tensor(5.7059, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2017, dtype=torch.float64) delta_t tensor(-0.0427, dtype=torch.float64)
2 gae_duplicate tensor(-0.5256, dtype=torch.float64) tensor(1.5156, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1959.69189453125
value loss:92.52102661132812
entropies:353.0785217285156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.743186950683594 seconds
19 rew tensor(1.0122, dtype=torch.float64) delta_t tensor(-0.0696, dtype=torch.float64)
19 gae_duplicate tensor(-0.4532, dtype=torch.float64) tensor(1.3463, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9607, dtype=torch.float64) delta_t tensor(0.0753, dtype=torch.float64)
18 gae_duplicate tensor(-0.2104, dtype=torch.float64) tensor(-1.4760, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(-0.0323, dtype=torch.float64)
17 gae_duplicate tensor(-0.4566, dtype=torch.float64) tensor(0.5344, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4024, dtype=torch.float64) delta_t tensor(-0.1809, dtype=torch.float64)
16 gae_duplicate tensor(-1.2937, dtype=torch.float64) tensor(3.2475, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2431, dtype=torch.float64) delta_t tensor(-0.0279, dtype=torch.float64)
15 gae_duplicate tensor(-1.0481, dtype=torch.float64) tensor(1.0702, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6696, dtype=torch.float64) delta_t tensor(0.2954, dtype=torch.float64)
14 gae_duplicate tensor(0.1285, dtype=torch.float64) tensor(-5.7107, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2430, dtype=torch.float64) delta_t tensor(0.2637, dtype=torch.float64)
13 gae_duplicate tensor(-0.0616, dtype=torch.float64) tensor(-5.6260, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7145, dtype=torch.float64) delta_t tensor(0.2795, dtype=torch.float64)
12 gae_duplicate tensor(-0.0789, dtype=torch.float64) tensor(-6.1810, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0020, dtype=torch.float64) delta_t tensor(0.3457, dtype=torch.float64)
11 gae_duplicate tensor(-0.1695, dtype=torch.float64) tensor(-6.9623, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2949, dtype=torch.float64) delta_t tensor(0.0747, dtype=torch.float64)
10 gae_duplicate tensor(-0.2693, dtype=torch.float64) tensor(-2.2507, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6435, dtype=torch.float64) delta_t tensor(0.2505, dtype=torch.float64)
9 gae_duplicate tensor(-0.0712, dtype=torch.float64) tensor(-4.9793, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6268, dtype=torch.float64) delta_t tensor(0.0840, dtype=torch.float64)
8 gae_duplicate tensor(-0.2210, dtype=torch.float64) tensor(-2.1665, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.7942, dtype=torch.float64) delta_t tensor(-1.7153, dtype=torch.float64)
7 gae_duplicate tensor(-4.6034, dtype=torch.float64) tensor(33.9582, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1388, dtype=torch.float64) delta_t tensor(0.0203, dtype=torch.float64)
6 gae_duplicate tensor(-1.2658, dtype=torch.float64) tensor(2.3634, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2715, dtype=torch.float64) delta_t tensor(-0.9227, dtype=torch.float64)
5 gae_duplicate tensor(-1.4413, dtype=torch.float64) tensor(17.1613, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9097, dtype=torch.float64) delta_t tensor(0.3365, dtype=torch.float64)
4 gae_duplicate tensor(-0.0869, dtype=torch.float64) tensor(-4.8341, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0921, dtype=torch.float64) delta_t tensor(-0.3623, dtype=torch.float64)
3 gae_duplicate tensor(-0.7195, dtype=torch.float64) tensor(6.3838, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3976, dtype=torch.float64) delta_t tensor(0.1936, dtype=torch.float64)
2 gae_duplicate tensor(-0.3227, dtype=torch.float64) tensor(-2.8507, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1338.7509765625
value loss:82.64608001708984
entropies:352.8084411621094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.637754917144775 seconds
19 rew tensor(0.9853, dtype=torch.float64) delta_t tensor(-0.2426, dtype=torch.float64)
19 gae_duplicate tensor(-0.6110, dtype=torch.float64) tensor(4.9030, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9637, dtype=torch.float64) delta_t tensor(0.2017, dtype=torch.float64)
18 gae_duplicate tensor(0.0878, dtype=torch.float64) tensor(-3.5645, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7142, dtype=torch.float64) delta_t tensor(-0.1152, dtype=torch.float64)
17 gae_duplicate tensor(-0.4819, dtype=torch.float64) tensor(1.5935, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6265, dtype=torch.float64) delta_t tensor(-0.0039, dtype=torch.float64)
16 gae_duplicate tensor(-1.3211, dtype=torch.float64) tensor(0.9645, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3270, dtype=torch.float64) delta_t tensor(0.0685, dtype=torch.float64)
15 gae_duplicate tensor(-0.3760, dtype=torch.float64) tensor(-1.2888, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6084, dtype=torch.float64) delta_t tensor(0.1192, dtype=torch.float64)
14 gae_duplicate tensor(-0.1848, dtype=torch.float64) tensor(-2.3604, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1690, dtype=torch.float64) delta_t tensor(0.2888, dtype=torch.float64)
13 gae_duplicate tensor(-0.0246, dtype=torch.float64) tensor(-6.2173, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9038, dtype=torch.float64) delta_t tensor(0.3889, dtype=torch.float64)
12 gae_duplicate tensor(0.1623, dtype=torch.float64) tensor(-8.3170, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1095, dtype=torch.float64) delta_t tensor(0.2523, dtype=torch.float64)
11 gae_duplicate tensor(-0.2928, dtype=torch.float64) tensor(-5.6688, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2035, dtype=torch.float64) delta_t tensor(-0.0957, dtype=torch.float64)
10 gae_duplicate tensor(-0.3327, dtype=torch.float64) tensor(1.2867, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8313, dtype=torch.float64) delta_t tensor(0.1372, dtype=torch.float64)
9 gae_duplicate tensor(-0.0411, dtype=torch.float64) tensor(-2.3941, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.8812, dtype=torch.float64) delta_t tensor(0.2731, dtype=torch.float64)
8 gae_duplicate tensor(0.0591, dtype=torch.float64) tensor(-5.7221, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-3.0004, dtype=torch.float64) delta_t tensor(-1.8226, dtype=torch.float64)
7 gae_duplicate tensor(-4.4173, dtype=torch.float64) tensor(36.7218, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0360, dtype=torch.float64) delta_t tensor(-0.0097, dtype=torch.float64)
6 gae_duplicate tensor(-0.7044, dtype=torch.float64) tensor(3.4604, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1776, dtype=torch.float64) delta_t tensor(-0.7806, dtype=torch.float64)
5 gae_duplicate tensor(-1.0801, dtype=torch.float64) tensor(15.9170, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9065, dtype=torch.float64) delta_t tensor(0.4444, dtype=torch.float64)
4 gae_duplicate tensor(0.1585, dtype=torch.float64) tensor(-6.9213, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1786, dtype=torch.float64) delta_t tensor(-0.3572, dtype=torch.float64)
3 gae_duplicate tensor(-0.6693, dtype=torch.float64) tensor(6.4425, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5153, dtype=torch.float64) delta_t tensor(0.2950, dtype=torch.float64)
2 gae_duplicate tensor(-0.0010, dtype=torch.float64) tensor(-4.8754, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1389.0457763671875
value loss:74.71796417236328
entropies:352.70751953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.058840036392212 seconds
19 rew tensor(1.0410, dtype=torch.float64) delta_t tensor(-0.0045, dtype=torch.float64)
19 gae_duplicate tensor(-0.3012, dtype=torch.float64) tensor(0.1009, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9796, dtype=torch.float64) delta_t tensor(0.0521, dtype=torch.float64)
18 gae_duplicate tensor(-0.3384, dtype=torch.float64) tensor(-1.1018, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9360, dtype=torch.float64) delta_t tensor(0.0277, dtype=torch.float64)
17 gae_duplicate tensor(-0.3248, dtype=torch.float64) tensor(-0.7487, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8842, dtype=torch.float64) delta_t tensor(0.1922, dtype=torch.float64)
16 gae_duplicate tensor(-0.0821, dtype=torch.float64) tensor(-3.7115, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6570, dtype=torch.float64) delta_t tensor(0.3054, dtype=torch.float64)
15 gae_duplicate tensor(-0.3137, dtype=torch.float64) tensor(-6.7513, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4435, dtype=torch.float64) delta_t tensor(0.0801, dtype=torch.float64)
14 gae_duplicate tensor(-0.0477, dtype=torch.float64) tensor(-2.3516, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0999, dtype=torch.float64) delta_t tensor(0.2331, dtype=torch.float64)
13 gae_duplicate tensor(0.1128, dtype=torch.float64) tensor(-4.9582, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5708, dtype=torch.float64) delta_t tensor(0.1549, dtype=torch.float64)
12 gae_duplicate tensor(-0.0825, dtype=torch.float64) tensor(-3.2770, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0115, dtype=torch.float64) delta_t tensor(0.4419, dtype=torch.float64)
11 gae_duplicate tensor(-0.0975, dtype=torch.float64) tensor(-8.6529, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2928, dtype=torch.float64) delta_t tensor(-0.0964, dtype=torch.float64)
10 gae_duplicate tensor(-0.7808, dtype=torch.float64) tensor(0.8932, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8380, dtype=torch.float64) delta_t tensor(0.2752, dtype=torch.float64)
9 gae_duplicate tensor(-0.1439, dtype=torch.float64) tensor(-5.3604, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6272, dtype=torch.float64) delta_t tensor(0.0554, dtype=torch.float64)
8 gae_duplicate tensor(-0.2271, dtype=torch.float64) tensor(-1.8437, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.0827, dtype=torch.float64) delta_t tensor(-0.7434, dtype=torch.float64)
7 gae_duplicate tensor(-1.5200, dtype=torch.float64) tensor(14.5667, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3903, dtype=torch.float64) delta_t tensor(0.2692, dtype=torch.float64)
6 gae_duplicate tensor(-0.2156, dtype=torch.float64) tensor(-3.9575, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4093, dtype=torch.float64) delta_t tensor(-0.7603, dtype=torch.float64)
5 gae_duplicate tensor(-1.3612, dtype=torch.float64) tensor(14.6121, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(0.4610, dtype=torch.float64)
4 gae_duplicate tensor(0.1573, dtype=torch.float64) tensor(-7.5449, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0072, dtype=torch.float64) delta_t tensor(-0.2309, dtype=torch.float64)
3 gae_duplicate tensor(-0.5701, dtype=torch.float64) tensor(3.6401, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2686, dtype=torch.float64) delta_t tensor(-0.0783, dtype=torch.float64)
2 gae_duplicate tensor(-0.4420, dtype=torch.float64) tensor(2.1714, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:675.70458984375
value loss:29.336349487304688
entropies:352.4258117675781
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3928.9336)
ToM Target loss= tensor(3873.4177)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.89651083946228 seconds
19 rew tensor(0.9306, dtype=torch.float64) delta_t tensor(-0.0443, dtype=torch.float64)
19 gae_duplicate tensor(-0.1612, dtype=torch.float64) tensor(0.8690, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7570, dtype=torch.float64) delta_t tensor(-0.1422, dtype=torch.float64)
18 gae_duplicate tensor(-1.2051, dtype=torch.float64) tensor(2.9107, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7393, dtype=torch.float64) delta_t tensor(0.0220, dtype=torch.float64)
17 gae_duplicate tensor(-0.4959, dtype=torch.float64) tensor(-0.2099, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7419, dtype=torch.float64) delta_t tensor(0.0510, dtype=torch.float64)
16 gae_duplicate tensor(-0.0994, dtype=torch.float64) tensor(-0.9443, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6118, dtype=torch.float64) delta_t tensor(0.1097, dtype=torch.float64)
15 gae_duplicate tensor(-0.1641, dtype=torch.float64) tensor(-2.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5793, dtype=torch.float64) delta_t tensor(0.1182, dtype=torch.float64)
14 gae_duplicate tensor(-0.2048, dtype=torch.float64) tensor(-2.5430, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4820, dtype=torch.float64) delta_t tensor(0.2171, dtype=torch.float64)
13 gae_duplicate tensor(-0.0348, dtype=torch.float64) tensor(-5.1247, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5901, dtype=torch.float64) delta_t tensor(0.1445, dtype=torch.float64)
12 gae_duplicate tensor(-0.3256, dtype=torch.float64) tensor(-3.4625, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2644, dtype=torch.float64) delta_t tensor(0.5233, dtype=torch.float64)
11 gae_duplicate tensor(0.1202, dtype=torch.float64) tensor(-10.3427, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0077, dtype=torch.float64) delta_t tensor(-0.1060, dtype=torch.float64)
10 gae_duplicate tensor(-0.4758, dtype=torch.float64) tensor(0.7938, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6587, dtype=torch.float64) delta_t tensor(0.2323, dtype=torch.float64)
9 gae_duplicate tensor(-0.4408, dtype=torch.float64) tensor(-4.7468, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5023, dtype=torch.float64) delta_t tensor(0.1806, dtype=torch.float64)
8 gae_duplicate tensor(-0.0761, dtype=torch.float64) tensor(-3.7567, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.9911, dtype=torch.float64) delta_t tensor(-0.9047, dtype=torch.float64)
7 gae_duplicate tensor(-2.7918, dtype=torch.float64) tensor(19.4496, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0678, dtype=torch.float64) delta_t tensor(0.0235, dtype=torch.float64)
6 gae_duplicate tensor(-0.6579, dtype=torch.float64) tensor(1.1109, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0998, dtype=torch.float64) delta_t tensor(-0.6157, dtype=torch.float64)
5 gae_duplicate tensor(-1.1484, dtype=torch.float64) tensor(11.7931, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.6956, dtype=torch.float64) delta_t tensor(0.3049, dtype=torch.float64)
4 gae_duplicate tensor(-0.0100, dtype=torch.float64) tensor(-5.0409, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8535, dtype=torch.float64) delta_t tensor(-0.1372, dtype=torch.float64)
3 gae_duplicate tensor(-0.4165, dtype=torch.float64) tensor(2.3368, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3181, dtype=torch.float64) delta_t tensor(0.1128, dtype=torch.float64)
2 gae_duplicate tensor(-0.2556, dtype=torch.float64) tensor(-2.3196, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-22.007099151611328
value loss:39.54460906982422
entropies:352.3129577636719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.695310115814209 seconds
19 rew tensor(1.0418, dtype=torch.float64) delta_t tensor(-0.0937, dtype=torch.float64)
19 gae_duplicate tensor(-0.5390, dtype=torch.float64) tensor(1.9981, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9695, dtype=torch.float64) delta_t tensor(-0.1360, dtype=torch.float64)
18 gae_duplicate tensor(-0.6298, dtype=torch.float64) tensor(2.7255, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8268, dtype=torch.float64) delta_t tensor(-0.1597, dtype=torch.float64)
17 gae_duplicate tensor(-0.5499, dtype=torch.float64) tensor(3.4034, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6404, dtype=torch.float64) delta_t tensor(0.0817, dtype=torch.float64)
16 gae_duplicate tensor(-0.2276, dtype=torch.float64) tensor(-1.2744, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6314, dtype=torch.float64) delta_t tensor(0.2068, dtype=torch.float64)
15 gae_duplicate tensor(0.1080, dtype=torch.float64) tensor(-4.1307, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4094, dtype=torch.float64) delta_t tensor(0.1396, dtype=torch.float64)
14 gae_duplicate tensor(-0.0042, dtype=torch.float64) tensor(-3.1160, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.2358, dtype=torch.float64) delta_t tensor(-0.3707, dtype=torch.float64)
13 gae_duplicate tensor(-1.2291, dtype=torch.float64) tensor(7.2117, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4747, dtype=torch.float64) delta_t tensor(0.2624, dtype=torch.float64)
12 gae_duplicate tensor(-0.0608, dtype=torch.float64) tensor(-4.2774, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2011, dtype=torch.float64) delta_t tensor(0.2359, dtype=torch.float64)
11 gae_duplicate tensor(-0.2002, dtype=torch.float64) tensor(-5.0660, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0803, dtype=torch.float64) delta_t tensor(-0.1511, dtype=torch.float64)
10 gae_duplicate tensor(-0.2621, dtype=torch.float64) tensor(2.5812, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3395, dtype=torch.float64) delta_t tensor(0.2208, dtype=torch.float64)
9 gae_duplicate tensor(-0.1118, dtype=torch.float64) tensor(-4.0411, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1286, dtype=torch.float64) delta_t tensor(0.0164, dtype=torch.float64)
8 gae_duplicate tensor(-0.1699, dtype=torch.float64) tensor(-0.7274, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2045, dtype=torch.float64) delta_t tensor(-0.3700, dtype=torch.float64)
7 gae_duplicate tensor(-1.6785, dtype=torch.float64) tensor(7.2336, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0376, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
6 gae_duplicate tensor(-0.3568, dtype=torch.float64) tensor(-0.5098, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7717, dtype=torch.float64) delta_t tensor(-0.4240, dtype=torch.float64)
5 gae_duplicate tensor(-0.9221, dtype=torch.float64) tensor(7.8514, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5750, dtype=torch.float64) delta_t tensor(0.5262, dtype=torch.float64)
4 gae_duplicate tensor(0.2649, dtype=torch.float64) tensor(-9.2249, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3831, dtype=torch.float64) delta_t tensor(0.1735, dtype=torch.float64)
3 gae_duplicate tensor(-0.4000, dtype=torch.float64) tensor(-4.0553, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0092, dtype=torch.float64) delta_t tensor(0.1475, dtype=torch.float64)
2 gae_duplicate tensor(-0.4165, dtype=torch.float64) tensor(-3.4120, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:273.7274169921875
value loss:27.305721282958984
entropies:352.2070007324219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.839201211929321 seconds
19 rew tensor(0.9662, dtype=torch.float64) delta_t tensor(-0.3251, dtype=torch.float64)
19 gae_duplicate tensor(-0.5927, dtype=torch.float64) tensor(6.5948, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8923, dtype=torch.float64) delta_t tensor(0.0355, dtype=torch.float64)
18 gae_duplicate tensor(-0.1425, dtype=torch.float64) tensor(0.0502, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8133, dtype=torch.float64) delta_t tensor(0.0304, dtype=torch.float64)
17 gae_duplicate tensor(-0.2956, dtype=torch.float64) tensor(-0.5355, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6556, dtype=torch.float64) delta_t tensor(-0.1042, dtype=torch.float64)
16 gae_duplicate tensor(-0.3416, dtype=torch.float64) tensor(1.9532, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4294, dtype=torch.float64) delta_t tensor(0.0939, dtype=torch.float64)
15 gae_duplicate tensor(-0.3066, dtype=torch.float64) tensor(-1.5681, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7088, dtype=torch.float64) delta_t tensor(0.1637, dtype=torch.float64)
14 gae_duplicate tensor(-0.1644, dtype=torch.float64) tensor(-3.2001, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0713, dtype=torch.float64) delta_t tensor(0.1426, dtype=torch.float64)
13 gae_duplicate tensor(-0.0183, dtype=torch.float64) tensor(-3.1741, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7766, dtype=torch.float64) delta_t tensor(0.2836, dtype=torch.float64)
12 gae_duplicate tensor(0.0482, dtype=torch.float64) tensor(-6.0880, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0836, dtype=torch.float64) delta_t tensor(0.2263, dtype=torch.float64)
11 gae_duplicate tensor(-0.2232, dtype=torch.float64) tensor(-5.4751, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1914, dtype=torch.float64) delta_t tensor(-0.0985, dtype=torch.float64)
10 gae_duplicate tensor(-0.4380, dtype=torch.float64) tensor(1.3132, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7994, dtype=torch.float64) delta_t tensor(0.3345, dtype=torch.float64)
9 gae_duplicate tensor(-0.1075, dtype=torch.float64) tensor(-6.4733, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7469, dtype=torch.float64) delta_t tensor(0.1612, dtype=torch.float64)
8 gae_duplicate tensor(-0.2392, dtype=torch.float64) tensor(-3.7353, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.0420, dtype=torch.float64) delta_t tensor(-0.6362, dtype=torch.float64)
7 gae_duplicate tensor(-1.6213, dtype=torch.float64) tensor(12.4851, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3347, dtype=torch.float64) delta_t tensor(0.1746, dtype=torch.float64)
6 gae_duplicate tensor(-0.3234, dtype=torch.float64) tensor(-2.3754, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3108, dtype=torch.float64) delta_t tensor(-0.6620, dtype=torch.float64)
5 gae_duplicate tensor(-0.8331, dtype=torch.float64) tensor(13.3479, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9021, dtype=torch.float64) delta_t tensor(0.3637, dtype=torch.float64)
4 gae_duplicate tensor(-0.0866, dtype=torch.float64) tensor(-5.9743, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0004, dtype=torch.float64) delta_t tensor(-0.1256, dtype=torch.float64)
3 gae_duplicate tensor(-0.3290, dtype=torch.float64) tensor(1.8168, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3958, dtype=torch.float64) delta_t tensor(0.0945, dtype=torch.float64)
2 gae_duplicate tensor(-0.3747, dtype=torch.float64) tensor(-1.7884, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:57.59752655029297
value loss:22.871673583984375
entropies:351.9923095703125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.823786973953247 seconds
19 rew tensor(0.7736, dtype=torch.float64) delta_t tensor(-0.5462, dtype=torch.float64)
19 gae_duplicate tensor(-1.8133, dtype=torch.float64) tensor(10.4116, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9918, dtype=torch.float64) delta_t tensor(0.0260, dtype=torch.float64)
18 gae_duplicate tensor(-0.2203, dtype=torch.float64) tensor(0.4436, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7345, dtype=torch.float64) delta_t tensor(-0.1700, dtype=torch.float64)
17 gae_duplicate tensor(-0.4228, dtype=torch.float64) tensor(3.4803, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6734, dtype=torch.float64) delta_t tensor(0.0078, dtype=torch.float64)
16 gae_duplicate tensor(-0.2566, dtype=torch.float64) tensor(0.2053, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5690, dtype=torch.float64) delta_t tensor(0.2681, dtype=torch.float64)
15 gae_duplicate tensor(-0.1568, dtype=torch.float64) tensor(-4.9762, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4239, dtype=torch.float64) delta_t tensor(0.1238, dtype=torch.float64)
14 gae_duplicate tensor(-0.0182, dtype=torch.float64) tensor(-2.8140, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2345, dtype=torch.float64) delta_t tensor(0.2510, dtype=torch.float64)
13 gae_duplicate tensor(0.1264, dtype=torch.float64) tensor(-5.2759, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4021, dtype=torch.float64) delta_t tensor(0.2501, dtype=torch.float64)
12 gae_duplicate tensor(0.0673, dtype=torch.float64) tensor(-5.1781, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0086, dtype=torch.float64) delta_t tensor(0.1833, dtype=torch.float64)
11 gae_duplicate tensor(-0.1659, dtype=torch.float64) tensor(-3.9471, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0589, dtype=torch.float64) delta_t tensor(0.1198, dtype=torch.float64)
10 gae_duplicate tensor(-0.0393, dtype=torch.float64) tensor(-3.0808, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1667, dtype=torch.float64) delta_t tensor(0.2683, dtype=torch.float64)
9 gae_duplicate tensor(0.0645, dtype=torch.float64) tensor(-5.2419, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0271, dtype=torch.float64) delta_t tensor(0.0527, dtype=torch.float64)
8 gae_duplicate tensor(-0.2232, dtype=torch.float64) tensor(-1.4198, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1628, dtype=torch.float64) delta_t tensor(-0.5501, dtype=torch.float64)
7 gae_duplicate tensor(-2.7379, dtype=torch.float64) tensor(9.8880, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1269, dtype=torch.float64) delta_t tensor(0.0592, dtype=torch.float64)
6 gae_duplicate tensor(-0.4982, dtype=torch.float64) tensor(-0.1518, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5240, dtype=torch.float64) delta_t tensor(-0.1727, dtype=torch.float64)
5 gae_duplicate tensor(-0.6374, dtype=torch.float64) tensor(3.2747, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.6727, dtype=torch.float64) delta_t tensor(0.5827, dtype=torch.float64)
4 gae_duplicate tensor(0.4164, dtype=torch.float64) tensor(-11.1827, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4174, dtype=torch.float64) delta_t tensor(0.0937, dtype=torch.float64)
3 gae_duplicate tensor(-0.5536, dtype=torch.float64) tensor(-2.9516, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0182, dtype=torch.float64) delta_t tensor(0.1011, dtype=torch.float64)
2 gae_duplicate tensor(-0.1047, dtype=torch.float64) tensor(-2.2216, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1024.8905029296875
value loss:33.247562408447266
entropies:351.72467041015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.724935054779053 seconds
19 rew tensor(1.0143, dtype=torch.float64) delta_t tensor(-0.1632, dtype=torch.float64)
19 gae_duplicate tensor(-0.5905, dtype=torch.float64) tensor(3.0959, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9518, dtype=torch.float64) delta_t tensor(-0.0846, dtype=torch.float64)
18 gae_duplicate tensor(-0.4586, dtype=torch.float64) tensor(2.1095, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9397, dtype=torch.float64) delta_t tensor(-0.0335, dtype=torch.float64)
17 gae_duplicate tensor(-0.4607, dtype=torch.float64) tensor(1.0893, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6395, dtype=torch.float64) delta_t tensor(0.0328, dtype=torch.float64)
16 gae_duplicate tensor(-0.2944, dtype=torch.float64) tensor(-0.5548, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5592, dtype=torch.float64) delta_t tensor(0.1241, dtype=torch.float64)
15 gae_duplicate tensor(0.0167, dtype=torch.float64) tensor(-2.3460, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4468, dtype=torch.float64) delta_t tensor(0.1463, dtype=torch.float64)
14 gae_duplicate tensor(-0.0846, dtype=torch.float64) tensor(-3.3220, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2547, dtype=torch.float64) delta_t tensor(0.1625, dtype=torch.float64)
13 gae_duplicate tensor(-0.0781, dtype=torch.float64) tensor(-3.6410, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3376, dtype=torch.float64) delta_t tensor(0.1182, dtype=torch.float64)
12 gae_duplicate tensor(-0.2127, dtype=torch.float64) tensor(-2.6371, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0187, dtype=torch.float64) delta_t tensor(0.1954, dtype=torch.float64)
11 gae_duplicate tensor(-0.2871, dtype=torch.float64) tensor(-3.8875, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0091, dtype=torch.float64) delta_t tensor(-0.0724, dtype=torch.float64)
10 gae_duplicate tensor(-0.4760, dtype=torch.float64) tensor(0.9828, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4884, dtype=torch.float64) delta_t tensor(0.3805, dtype=torch.float64)
9 gae_duplicate tensor(0.0191, dtype=torch.float64) tensor(-7.2315, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3409, dtype=torch.float64) delta_t tensor(0.0928, dtype=torch.float64)
8 gae_duplicate tensor(-0.0255, dtype=torch.float64) tensor(-2.8334, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4643, dtype=torch.float64) delta_t tensor(-0.3072, dtype=torch.float64)
7 gae_duplicate tensor(-1.0415, dtype=torch.float64) tensor(6.3898, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2725, dtype=torch.float64) delta_t tensor(0.1601, dtype=torch.float64)
6 gae_duplicate tensor(-0.1441, dtype=torch.float64) tensor(-2.4477, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0443, dtype=torch.float64) delta_t tensor(-0.3043, dtype=torch.float64)
5 gae_duplicate tensor(-0.7588, dtype=torch.float64) tensor(5.1333, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7901, dtype=torch.float64) delta_t tensor(0.3965, dtype=torch.float64)
4 gae_duplicate tensor(-0.0965, dtype=torch.float64) tensor(-6.6492, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7240, dtype=torch.float64) delta_t tensor(0.0616, dtype=torch.float64)
3 gae_duplicate tensor(-0.1735, dtype=torch.float64) tensor(-1.7545, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1815, dtype=torch.float64) delta_t tensor(0.0298, dtype=torch.float64)
2 gae_duplicate tensor(-0.3804, dtype=torch.float64) tensor(-0.7041, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:942.338134765625
value loss:16.4249267578125
entropies:351.49212646484375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3937.3018)
ToM Target loss= tensor(3854.4988)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.827154159545898 seconds
19 rew tensor(1.0517, dtype=torch.float64) delta_t tensor(-0.0737, dtype=torch.float64)
19 gae_duplicate tensor(-0.5909, dtype=torch.float64) tensor(1.4389, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0100, dtype=torch.float64) delta_t tensor(-0.0549, dtype=torch.float64)
18 gae_duplicate tensor(-0.4343, dtype=torch.float64) tensor(1.1973, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9462, dtype=torch.float64) delta_t tensor(-0.0839, dtype=torch.float64)
17 gae_duplicate tensor(-0.4594, dtype=torch.float64) tensor(1.7751, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5940, dtype=torch.float64) delta_t tensor(-0.0656, dtype=torch.float64)
16 gae_duplicate tensor(-0.8403, dtype=torch.float64) tensor(1.1845, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5898, dtype=torch.float64) delta_t tensor(0.0988, dtype=torch.float64)
15 gae_duplicate tensor(-0.1272, dtype=torch.float64) tensor(-1.9144, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4494, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
14 gae_duplicate tensor(-0.1396, dtype=torch.float64) tensor(0.3508, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2224, dtype=torch.float64) delta_t tensor(0.2764, dtype=torch.float64)
13 gae_duplicate tensor(0.1187, dtype=torch.float64) tensor(-5.2982, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6439, dtype=torch.float64) delta_t tensor(0.1561, dtype=torch.float64)
12 gae_duplicate tensor(-0.2186, dtype=torch.float64) tensor(-3.7923, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0052, dtype=torch.float64) delta_t tensor(0.4346, dtype=torch.float64)
11 gae_duplicate tensor(0.0077, dtype=torch.float64) tensor(-9.0460, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1972, dtype=torch.float64) delta_t tensor(-0.1525, dtype=torch.float64)
10 gae_duplicate tensor(-0.6290, dtype=torch.float64) tensor(1.9714, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7121, dtype=torch.float64) delta_t tensor(0.4440, dtype=torch.float64)
9 gae_duplicate tensor(-0.0534, dtype=torch.float64) tensor(-8.5026, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7073, dtype=torch.float64) delta_t tensor(0.1315, dtype=torch.float64)
8 gae_duplicate tensor(-0.0443, dtype=torch.float64) tensor(-3.3023, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.6903, dtype=torch.float64) delta_t tensor(-1.1228, dtype=torch.float64)
7 gae_duplicate tensor(-5.6657, dtype=torch.float64) tensor(24.5833, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1543, dtype=torch.float64) delta_t tensor(-0.0328, dtype=torch.float64)
6 gae_duplicate tensor(-1.0123, dtype=torch.float64) tensor(2.5381, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3608, dtype=torch.float64) delta_t tensor(-0.4742, dtype=torch.float64)
5 gae_duplicate tensor(-0.7956, dtype=torch.float64) tensor(9.1728, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.8849, dtype=torch.float64) delta_t tensor(0.1984, dtype=torch.float64)
4 gae_duplicate tensor(-0.1007, dtype=torch.float64) tensor(-2.9189, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2066, dtype=torch.float64) delta_t tensor(-0.1524, dtype=torch.float64)
3 gae_duplicate tensor(-0.7516, dtype=torch.float64) tensor(2.5288, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4274, dtype=torch.float64) delta_t tensor(0.0753, dtype=torch.float64)
2 gae_duplicate tensor(-0.7096, dtype=torch.float64) tensor(-1.1973, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-676.3594970703125
value loss:68.64420318603516
entropies:351.1994323730469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.805222272872925 seconds
19 rew tensor(0.9395, dtype=torch.float64) delta_t tensor(-0.5831, dtype=torch.float64)
19 gae_duplicate tensor(-0.8272, dtype=torch.float64) tensor(11.3438, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8748, dtype=torch.float64) delta_t tensor(-0.1767, dtype=torch.float64)
18 gae_duplicate tensor(-0.6481, dtype=torch.float64) tensor(4.8243, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5939, dtype=torch.float64) delta_t tensor(-0.3202, dtype=torch.float64)
17 gae_duplicate tensor(-0.8475, dtype=torch.float64) tensor(6.7629, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7447, dtype=torch.float64) delta_t tensor(0.0411, dtype=torch.float64)
16 gae_duplicate tensor(-0.3211, dtype=torch.float64) tensor(-0.1509, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3287, dtype=torch.float64) delta_t tensor(0.1987, dtype=torch.float64)
15 gae_duplicate tensor(-0.0947, dtype=torch.float64) tensor(-3.8189, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6520, dtype=torch.float64) delta_t tensor(0.1541, dtype=torch.float64)
14 gae_duplicate tensor(-0.1399, dtype=torch.float64) tensor(-3.3132, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0880, dtype=torch.float64) delta_t tensor(0.2484, dtype=torch.float64)
13 gae_duplicate tensor(0.1576, dtype=torch.float64) tensor(-4.9831, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7414, dtype=torch.float64) delta_t tensor(0.2005, dtype=torch.float64)
12 gae_duplicate tensor(-0.0389, dtype=torch.float64) tensor(-4.2734, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3114, dtype=torch.float64) delta_t tensor(0.2083, dtype=torch.float64)
11 gae_duplicate tensor(-0.0917, dtype=torch.float64) tensor(-4.8196, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5100, dtype=torch.float64) delta_t tensor(0.1271, dtype=torch.float64)
10 gae_duplicate tensor(-0.2551, dtype=torch.float64) tensor(-2.9744, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7903, dtype=torch.float64) delta_t tensor(0.2379, dtype=torch.float64)
9 gae_duplicate tensor(-0.0097, dtype=torch.float64) tensor(-4.5631, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.9004, dtype=torch.float64) delta_t tensor(0.3322, dtype=torch.float64)
8 gae_duplicate tensor(0.1135, dtype=torch.float64) tensor(-7.5958, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.1692, dtype=torch.float64) delta_t tensor(-0.8432, dtype=torch.float64)
7 gae_duplicate tensor(-5.0458, dtype=torch.float64) tensor(15.6394, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0789, dtype=torch.float64) delta_t tensor(0.0456, dtype=torch.float64)
6 gae_duplicate tensor(-0.6324, dtype=torch.float64) tensor(0.5918, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9564, dtype=torch.float64) delta_t tensor(-0.2949, dtype=torch.float64)
5 gae_duplicate tensor(-0.5026, dtype=torch.float64) tensor(5.6817, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.8144, dtype=torch.float64) delta_t tensor(0.3467, dtype=torch.float64)
4 gae_duplicate tensor(-0.0354, dtype=torch.float64) tensor(-6.3900, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8110, dtype=torch.float64) delta_t tensor(-0.0237, dtype=torch.float64)
3 gae_duplicate tensor(-0.3425, dtype=torch.float64) tensor(0.1195, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2767, dtype=torch.float64) delta_t tensor(0.0765, dtype=torch.float64)
2 gae_duplicate tensor(-0.4329, dtype=torch.float64) tensor(-1.9604, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-101.23159790039062
value loss:57.335533142089844
entropies:350.7939147949219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9134299755096436 seconds
19 rew tensor(1.0457, dtype=torch.float64) delta_t tensor(-0.1984, dtype=torch.float64)
19 gae_duplicate tensor(-0.4624, dtype=torch.float64) tensor(3.7574, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0035, dtype=torch.float64) delta_t tensor(-0.1496, dtype=torch.float64)
18 gae_duplicate tensor(-0.4620, dtype=torch.float64) tensor(3.1743, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8708, dtype=torch.float64) delta_t tensor(-0.1653, dtype=torch.float64)
17 gae_duplicate tensor(-0.4220, dtype=torch.float64) tensor(3.5730, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8774, dtype=torch.float64) delta_t tensor(0.2098, dtype=torch.float64)
16 gae_duplicate tensor(-0.0922, dtype=torch.float64) tensor(-3.7212, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7026, dtype=torch.float64) delta_t tensor(0.1913, dtype=torch.float64)
15 gae_duplicate tensor(-0.0891, dtype=torch.float64) tensor(-4.2375, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2801, dtype=torch.float64) delta_t tensor(-0.0331, dtype=torch.float64)
14 gae_duplicate tensor(-0.1476, dtype=torch.float64) tensor(0.2315, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4750, dtype=torch.float64) delta_t tensor(0.2838, dtype=torch.float64)
13 gae_duplicate tensor(0.1724, dtype=torch.float64) tensor(-5.3781, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1590, dtype=torch.float64) delta_t tensor(-0.2699, dtype=torch.float64)
12 gae_duplicate tensor(-1.4197, dtype=torch.float64) tensor(4.7383, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2379, dtype=torch.float64) delta_t tensor(0.5202, dtype=torch.float64)
11 gae_duplicate tensor(0.1822, dtype=torch.float64) tensor(-9.6099, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0067, dtype=torch.float64) delta_t tensor(-0.2265, dtype=torch.float64)
10 gae_duplicate tensor(-0.3824, dtype=torch.float64) tensor(3.3891, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6973, dtype=torch.float64) delta_t tensor(0.5715, dtype=torch.float64)
9 gae_duplicate tensor(0.4621, dtype=torch.float64) tensor(-10.8346, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6832, dtype=torch.float64) delta_t tensor(-0.0315, dtype=torch.float64)
8 gae_duplicate tensor(-0.3214, dtype=torch.float64) tensor(-0.7074, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.8209, dtype=torch.float64) delta_t tensor(-1.0845, dtype=torch.float64)
7 gae_duplicate tensor(-5.2135, dtype=torch.float64) tensor(19.7873, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2743, dtype=torch.float64) delta_t tensor(0.1829, dtype=torch.float64)
6 gae_duplicate tensor(-0.6718, dtype=torch.float64) tensor(-1.1938, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4874, dtype=torch.float64) delta_t tensor(-0.4907, dtype=torch.float64)
5 gae_duplicate tensor(-0.8487, dtype=torch.float64) tensor(9.8101, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9224, dtype=torch.float64) delta_t tensor(0.1511, dtype=torch.float64)
4 gae_duplicate tensor(-0.1267, dtype=torch.float64) tensor(-1.8794, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2051, dtype=torch.float64) delta_t tensor(-0.1104, dtype=torch.float64)
3 gae_duplicate tensor(-0.5010, dtype=torch.float64) tensor(2.3947, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4437, dtype=torch.float64) delta_t tensor(0.1076, dtype=torch.float64)
2 gae_duplicate tensor(-0.1325, dtype=torch.float64) tensor(-1.6710, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-722.2825927734375
value loss:61.392250061035156
entropies:350.5312194824219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.753206014633179 seconds
19 rew tensor(1.0468, dtype=torch.float64) delta_t tensor(-0.1084, dtype=torch.float64)
19 gae_duplicate tensor(-0.1640, dtype=torch.float64) tensor(2.0459, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0484, dtype=torch.float64) delta_t tensor(0.0515, dtype=torch.float64)
18 gae_duplicate tensor(-0.0609, dtype=torch.float64) tensor(-0.8432, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9619, dtype=torch.float64) delta_t tensor(-0.3802, dtype=torch.float64)
17 gae_duplicate tensor(-0.4566, dtype=torch.float64) tensor(7.3522, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8013, dtype=torch.float64) delta_t tensor(-0.0256, dtype=torch.float64)
16 gae_duplicate tensor(-0.2084, dtype=torch.float64) tensor(1.1263, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6376, dtype=torch.float64) delta_t tensor(0.2635, dtype=torch.float64)
15 gae_duplicate tensor(0.0957, dtype=torch.float64) tensor(-4.9599, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5688, dtype=torch.float64) delta_t tensor(0.0297, dtype=torch.float64)
14 gae_duplicate tensor(-0.1589, dtype=torch.float64) tensor(-1.1847, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0104, dtype=torch.float64) delta_t tensor(0.1995, dtype=torch.float64)
13 gae_duplicate tensor(-0.0599, dtype=torch.float64) tensor(-4.0638, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7468, dtype=torch.float64) delta_t tensor(0.1551, dtype=torch.float64)
12 gae_duplicate tensor(-0.2771, dtype=torch.float64) tensor(-3.1815, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0617, dtype=torch.float64) delta_t tensor(0.1506, dtype=torch.float64)
11 gae_duplicate tensor(-0.0640, dtype=torch.float64) tensor(-3.1898, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2949, dtype=torch.float64) delta_t tensor(-0.0654, dtype=torch.float64)
10 gae_duplicate tensor(-0.2056, dtype=torch.float64) tensor(0.9496, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7870, dtype=torch.float64) delta_t tensor(0.5066, dtype=torch.float64)
9 gae_duplicate tensor(0.4388, dtype=torch.float64) tensor(-10.7377, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5751, dtype=torch.float64) delta_t tensor(-0.1347, dtype=torch.float64)
8 gae_duplicate tensor(-0.2738, dtype=torch.float64) tensor(1.5127, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.8774, dtype=torch.float64) delta_t tensor(-0.1435, dtype=torch.float64)
7 gae_duplicate tensor(-0.3901, dtype=torch.float64) tensor(3.0993, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4873, dtype=torch.float64) delta_t tensor(0.1457, dtype=torch.float64)
6 gae_duplicate tensor(-0.2700, dtype=torch.float64) tensor(-2.4423, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3315, dtype=torch.float64) delta_t tensor(-0.3800, dtype=torch.float64)
5 gae_duplicate tensor(-0.6926, dtype=torch.float64) tensor(7.4830, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9191, dtype=torch.float64) delta_t tensor(0.1916, dtype=torch.float64)
4 gae_duplicate tensor(-0.1696, dtype=torch.float64) tensor(-2.6750, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8551, dtype=torch.float64) delta_t tensor(0.1250, dtype=torch.float64)
3 gae_duplicate tensor(-0.0949, dtype=torch.float64) tensor(-2.6297, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3001, dtype=torch.float64) delta_t tensor(0.1162, dtype=torch.float64)
2 gae_duplicate tensor(-0.2505, dtype=torch.float64) tensor(-2.6109, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:712.6766967773438
value loss:12.011971473693848
entropies:350.32830810546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.826823949813843 seconds
19 rew tensor(1.0389, dtype=torch.float64) delta_t tensor(-0.2141, dtype=torch.float64)
19 gae_duplicate tensor(-0.7212, dtype=torch.float64) tensor(4.3940, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0180, dtype=torch.float64) delta_t tensor(0.1681, dtype=torch.float64)
18 gae_duplicate tensor(-0.0555, dtype=torch.float64) tensor(-2.6555, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6520, dtype=torch.float64) delta_t tensor(-0.5149, dtype=torch.float64)
17 gae_duplicate tensor(-1.8326, dtype=torch.float64) tensor(9.4546, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8900, dtype=torch.float64) delta_t tensor(0.1591, dtype=torch.float64)
16 gae_duplicate tensor(-0.1406, dtype=torch.float64) tensor(-1.9692, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6418, dtype=torch.float64) delta_t tensor(0.2677, dtype=torch.float64)
15 gae_duplicate tensor(-0.0145, dtype=torch.float64) tensor(-5.2860, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6724, dtype=torch.float64) delta_t tensor(0.0515, dtype=torch.float64)
14 gae_duplicate tensor(-0.1366, dtype=torch.float64) tensor(-1.6014, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2052, dtype=torch.float64) delta_t tensor(0.2544, dtype=torch.float64)
13 gae_duplicate tensor(0.0256, dtype=torch.float64) tensor(-5.1474, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8611, dtype=torch.float64) delta_t tensor(0.2548, dtype=torch.float64)
12 gae_duplicate tensor(0.0811, dtype=torch.float64) tensor(-5.3086, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0044, dtype=torch.float64) delta_t tensor(0.2414, dtype=torch.float64)
11 gae_duplicate tensor(0.0246, dtype=torch.float64) tensor(-5.1200, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3354, dtype=torch.float64) delta_t tensor(-0.0024, dtype=torch.float64)
10 gae_duplicate tensor(-0.3214, dtype=torch.float64) tensor(-0.4491, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6281, dtype=torch.float64) delta_t tensor(0.5751, dtype=torch.float64)
9 gae_duplicate tensor(0.4233, dtype=torch.float64) tensor(-10.8497, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5511, dtype=torch.float64) delta_t tensor(-0.0912, dtype=torch.float64)
8 gae_duplicate tensor(-0.2713, dtype=torch.float64) tensor(0.5776, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-3.6612, dtype=torch.float64) delta_t tensor(-1.9495, dtype=torch.float64)
7 gae_duplicate tensor(-4.9884, dtype=torch.float64) tensor(37.3769, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0161, dtype=torch.float64) delta_t tensor(0.0013, dtype=torch.float64)
6 gae_duplicate tensor(-1.1006, dtype=torch.float64) tensor(3.7880, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2483, dtype=torch.float64) delta_t tensor(-0.2077, dtype=torch.float64)
5 gae_duplicate tensor(-0.5819, dtype=torch.float64) tensor(4.1660, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9190, dtype=torch.float64) delta_t tensor(0.3711, dtype=torch.float64)
4 gae_duplicate tensor(-0.1155, dtype=torch.float64) tensor(-6.8903, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2536, dtype=torch.float64) delta_t tensor(-0.1096, dtype=torch.float64)
3 gae_duplicate tensor(-0.4251, dtype=torch.float64) tensor(1.4271, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5109, dtype=torch.float64) delta_t tensor(0.1864, dtype=torch.float64)
2 gae_duplicate tensor(-0.1789, dtype=torch.float64) tensor(-3.6438, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-756.7482299804688
value loss:91.05056762695312
entropies:350.1423034667969
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3925.9202)
ToM Target loss= tensor(3835.7224)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.822145700454712 seconds
19 rew tensor(0.9927, dtype=torch.float64) delta_t tensor(-0.0632, dtype=torch.float64)
19 gae_duplicate tensor(-0.4052, dtype=torch.float64) tensor(1.5339, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0071, dtype=torch.float64) delta_t tensor(0.1283, dtype=torch.float64)
18 gae_duplicate tensor(-0.0218, dtype=torch.float64) tensor(-2.8009, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9099, dtype=torch.float64) delta_t tensor(-0.1111, dtype=torch.float64)
17 gae_duplicate tensor(-0.4438, dtype=torch.float64) tensor(2.1118, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5735, dtype=torch.float64) delta_t tensor(-0.1558, dtype=torch.float64)
16 gae_duplicate tensor(-0.8452, dtype=torch.float64) tensor(3.1838, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6660, dtype=torch.float64) delta_t tensor(0.2478, dtype=torch.float64)
15 gae_duplicate tensor(0.0631, dtype=torch.float64) tensor(-4.3903, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6963, dtype=torch.float64) delta_t tensor(0.1382, dtype=torch.float64)
14 gae_duplicate tensor(-0.1655, dtype=torch.float64) tensor(-3.0029, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0551, dtype=torch.float64) delta_t tensor(0.0499, dtype=torch.float64)
13 gae_duplicate tensor(-0.1667, dtype=torch.float64) tensor(-1.3678, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6646, dtype=torch.float64) delta_t tensor(0.1037, dtype=torch.float64)
12 gae_duplicate tensor(-0.2736, dtype=torch.float64) tensor(-2.2835, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1324, dtype=torch.float64) delta_t tensor(0.3253, dtype=torch.float64)
11 gae_duplicate tensor(0.0520, dtype=torch.float64) tensor(-6.4035, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2479, dtype=torch.float64) delta_t tensor(-0.0946, dtype=torch.float64)
10 gae_duplicate tensor(-0.3121, dtype=torch.float64) tensor(1.0722, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7135, dtype=torch.float64) delta_t tensor(0.5679, dtype=torch.float64)
9 gae_duplicate tensor(0.2113, dtype=torch.float64) tensor(-10.3752, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5934, dtype=torch.float64) delta_t tensor(-0.1303, dtype=torch.float64)
8 gae_duplicate tensor(-0.1897, dtype=torch.float64) tensor(1.4987, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.4692, dtype=torch.float64) delta_t tensor(-0.6414, dtype=torch.float64)
7 gae_duplicate tensor(-3.6682, dtype=torch.float64) tensor(14.9649, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1583, dtype=torch.float64) delta_t tensor(-0.0922, dtype=torch.float64)
6 gae_duplicate tensor(-0.6761, dtype=torch.float64) tensor(2.8622, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3653, dtype=torch.float64) delta_t tensor(-0.2031, dtype=torch.float64)
5 gae_duplicate tensor(-0.5488, dtype=torch.float64) tensor(4.3026, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9126, dtype=torch.float64) delta_t tensor(0.0169, dtype=torch.float64)
4 gae_duplicate tensor(-0.2128, dtype=torch.float64) tensor(0.3060, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1759, dtype=torch.float64) delta_t tensor(-0.0236, dtype=torch.float64)
3 gae_duplicate tensor(-0.3919, dtype=torch.float64) tensor(0.4095, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4406, dtype=torch.float64) delta_t tensor(0.0968, dtype=torch.float64)
2 gae_duplicate tensor(-0.0878, dtype=torch.float64) tensor(-2.0524, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-71.24681854248047
value loss:34.488826751708984
entropies:350.0981750488281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.843082904815674 seconds
19 rew tensor(0.9439, dtype=torch.float64) delta_t tensor(-0.2739, dtype=torch.float64)
19 gae_duplicate tensor(-0.6818, dtype=torch.float64) tensor(5.4316, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9451, dtype=torch.float64) delta_t tensor(0.0337, dtype=torch.float64)
18 gae_duplicate tensor(-0.2354, dtype=torch.float64) tensor(-0.1941, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8679, dtype=torch.float64) delta_t tensor(-0.1705, dtype=torch.float64)
17 gae_duplicate tensor(-0.4608, dtype=torch.float64) tensor(3.4731, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7767, dtype=torch.float64) delta_t tensor(0.0395, dtype=torch.float64)
16 gae_duplicate tensor(-0.1731, dtype=torch.float64) tensor(-0.3986, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5683, dtype=torch.float64) delta_t tensor(0.1326, dtype=torch.float64)
15 gae_duplicate tensor(-0.1952, dtype=torch.float64) tensor(-2.5438, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6051, dtype=torch.float64) delta_t tensor(0.0438, dtype=torch.float64)
14 gae_duplicate tensor(-0.1803, dtype=torch.float64) tensor(-0.8843, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0874, dtype=torch.float64) delta_t tensor(0.1908, dtype=torch.float64)
13 gae_duplicate tensor(-0.0554, dtype=torch.float64) tensor(-3.8521, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4491, dtype=torch.float64) delta_t tensor(-0.0861, dtype=torch.float64)
12 gae_duplicate tensor(-1.2183, dtype=torch.float64) tensor(1.8113, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5026, dtype=torch.float64) delta_t tensor(-0.1553, dtype=torch.float64)
11 gae_duplicate tensor(-1.5528, dtype=torch.float64) tensor(3.2090, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3908, dtype=torch.float64) delta_t tensor(0.0439, dtype=torch.float64)
10 gae_duplicate tensor(-0.2270, dtype=torch.float64) tensor(-0.8279, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7609, dtype=torch.float64) delta_t tensor(0.4392, dtype=torch.float64)
9 gae_duplicate tensor(0.1871, dtype=torch.float64) tensor(-8.9881, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6319, dtype=torch.float64) delta_t tensor(0.0070, dtype=torch.float64)
8 gae_duplicate tensor(-0.1380, dtype=torch.float64) tensor(-0.9212, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6287, dtype=torch.float64) delta_t tensor(0.0780, dtype=torch.float64)
7 gae_duplicate tensor(-0.2039, dtype=torch.float64) tensor(-1.3471, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3782, dtype=torch.float64) delta_t tensor(0.0390, dtype=torch.float64)
6 gae_duplicate tensor(-0.1663, dtype=torch.float64) tensor(-0.7021, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1360, dtype=torch.float64) delta_t tensor(-0.1398, dtype=torch.float64)
5 gae_duplicate tensor(-0.5314, dtype=torch.float64) tensor(2.5455, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(0.2149, dtype=torch.float64)
4 gae_duplicate tensor(-0.2052, dtype=torch.float64) tensor(-3.6560, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7276, dtype=torch.float64) delta_t tensor(0.1469, dtype=torch.float64)
3 gae_duplicate tensor(0.0554, dtype=torch.float64) tensor(-3.2744, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1899, dtype=torch.float64) delta_t tensor(-0.1062, dtype=torch.float64)
2 gae_duplicate tensor(-0.3492, dtype=torch.float64) tensor(1.8699, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:404.9886779785156
value loss:17.459932327270508
entropies:349.90643310546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.758425235748291 seconds
19 rew tensor(1.0152, dtype=torch.float64) delta_t tensor(-0.0883, dtype=torch.float64)
19 gae_duplicate tensor(-0.5417, dtype=torch.float64) tensor(2.1065, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9431, dtype=torch.float64) delta_t tensor(-0.0611, dtype=torch.float64)
18 gae_duplicate tensor(-0.5068, dtype=torch.float64) tensor(1.6472, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(-0.1750, dtype=torch.float64)
17 gae_duplicate tensor(-0.3940, dtype=torch.float64) tensor(3.6975, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7293, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
16 gae_duplicate tensor(-0.3676, dtype=torch.float64) tensor(-0.7708, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5497, dtype=torch.float64) delta_t tensor(0.0462, dtype=torch.float64)
15 gae_duplicate tensor(-0.3836, dtype=torch.float64) tensor(-1.0164, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7725, dtype=torch.float64) delta_t tensor(0.1360, dtype=torch.float64)
14 gae_duplicate tensor(-0.2151, dtype=torch.float64) tensor(-2.6278, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2490, dtype=torch.float64) delta_t tensor(0.0533, dtype=torch.float64)
13 gae_duplicate tensor(-0.1899, dtype=torch.float64) tensor(-1.1705, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6553, dtype=torch.float64) delta_t tensor(0.0762, dtype=torch.float64)
12 gae_duplicate tensor(-0.1526, dtype=torch.float64) tensor(-1.4916, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1734, dtype=torch.float64) delta_t tensor(0.3496, dtype=torch.float64)
11 gae_duplicate tensor(0.0612, dtype=torch.float64) tensor(-7.5757, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1365, dtype=torch.float64) delta_t tensor(-0.1215, dtype=torch.float64)
10 gae_duplicate tensor(-0.5309, dtype=torch.float64) tensor(2.0687, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6687, dtype=torch.float64) delta_t tensor(0.5988, dtype=torch.float64)
9 gae_duplicate tensor(0.3668, dtype=torch.float64) tensor(-11.2466, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5670, dtype=torch.float64) delta_t tensor(-0.0541, dtype=torch.float64)
8 gae_duplicate tensor(-0.2052, dtype=torch.float64) tensor(-0.0699, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.8076, dtype=torch.float64) delta_t tensor(-0.9474, dtype=torch.float64)
7 gae_duplicate tensor(-5.0925, dtype=torch.float64) tensor(18.5818, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3024, dtype=torch.float64) delta_t tensor(-0.0791, dtype=torch.float64)
6 gae_duplicate tensor(-1.0216, dtype=torch.float64) tensor(3.2541, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3815, dtype=torch.float64) delta_t tensor(-0.2151, dtype=torch.float64)
5 gae_duplicate tensor(-0.4963, dtype=torch.float64) tensor(5.1143, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9130, dtype=torch.float64) delta_t tensor(0.0437, dtype=torch.float64)
4 gae_duplicate tensor(-0.1993, dtype=torch.float64) tensor(-0.4473, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1115, dtype=torch.float64) delta_t tensor(0.0885, dtype=torch.float64)
3 gae_duplicate tensor(-0.2610, dtype=torch.float64) tensor(-1.8300, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4832, dtype=torch.float64) delta_t tensor(0.1211, dtype=torch.float64)
2 gae_duplicate tensor(-0.0098, dtype=torch.float64) tensor(-2.4656, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-405.3314514160156
value loss:53.39397430419922
entropies:349.6869201660156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.802670001983643 seconds
19 rew tensor(1.0030, dtype=torch.float64) delta_t tensor(-0.0904, dtype=torch.float64)
19 gae_duplicate tensor(-0.3789, dtype=torch.float64) tensor(1.9613, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9402, dtype=torch.float64) delta_t tensor(-0.0074, dtype=torch.float64)
18 gae_duplicate tensor(-0.5805, dtype=torch.float64) tensor(0.2239, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7348, dtype=torch.float64) delta_t tensor(-0.1786, dtype=torch.float64)
17 gae_duplicate tensor(-0.3610, dtype=torch.float64) tensor(3.4599, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5422, dtype=torch.float64) delta_t tensor(-0.0229, dtype=torch.float64)
16 gae_duplicate tensor(-0.8530, dtype=torch.float64) tensor(0.8779, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5625, dtype=torch.float64) delta_t tensor(0.1293, dtype=torch.float64)
15 gae_duplicate tensor(0.0399, dtype=torch.float64) tensor(-2.3100, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4912, dtype=torch.float64) delta_t tensor(-0.0410, dtype=torch.float64)
14 gae_duplicate tensor(-0.2196, dtype=torch.float64) tensor(0.4761, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2752, dtype=torch.float64) delta_t tensor(0.1225, dtype=torch.float64)
13 gae_duplicate tensor(-0.0873, dtype=torch.float64) tensor(-2.4829, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6119, dtype=torch.float64) delta_t tensor(0.0979, dtype=torch.float64)
12 gae_duplicate tensor(-0.1460, dtype=torch.float64) tensor(-1.9391, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0940, dtype=torch.float64) delta_t tensor(0.3243, dtype=torch.float64)
11 gae_duplicate tensor(0.0031, dtype=torch.float64) tensor(-6.8967, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0922, dtype=torch.float64) delta_t tensor(-0.2759, dtype=torch.float64)
10 gae_duplicate tensor(-0.6347, dtype=torch.float64) tensor(4.8262, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7137, dtype=torch.float64) delta_t tensor(0.5652, dtype=torch.float64)
9 gae_duplicate tensor(0.3469, dtype=torch.float64) tensor(-10.2120, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6525, dtype=torch.float64) delta_t tensor(-0.0036, dtype=torch.float64)
8 gae_duplicate tensor(-0.1501, dtype=torch.float64) tensor(-1.1475, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.5521, dtype=torch.float64) delta_t tensor(-0.7039, dtype=torch.float64)
7 gae_duplicate tensor(-3.4847, dtype=torch.float64) tensor(13.6056, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2929, dtype=torch.float64) delta_t tensor(0.0324, dtype=torch.float64)
6 gae_duplicate tensor(-0.6533, dtype=torch.float64) tensor(0.7884, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3986, dtype=torch.float64) delta_t tensor(-0.3296, dtype=torch.float64)
5 gae_duplicate tensor(-0.5645, dtype=torch.float64) tensor(7.1574, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9094, dtype=torch.float64) delta_t tensor(0.2633, dtype=torch.float64)
4 gae_duplicate tensor(-0.1895, dtype=torch.float64) tensor(-4.0596, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1406, dtype=torch.float64) delta_t tensor(0.0349, dtype=torch.float64)
3 gae_duplicate tensor(-0.3127, dtype=torch.float64) tensor(-1.0319, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5306, dtype=torch.float64) delta_t tensor(0.1471, dtype=torch.float64)
2 gae_duplicate tensor(-0.1674, dtype=torch.float64) tensor(-2.9877, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-111.06053161621094
value loss:35.12659454345703
entropies:349.4327392578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.863724946975708 seconds
19 rew tensor(1.0364, dtype=torch.float64) delta_t tensor(-0.0876, dtype=torch.float64)
19 gae_duplicate tensor(-0.3928, dtype=torch.float64) tensor(1.6319, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0377, dtype=torch.float64) delta_t tensor(0.0338, dtype=torch.float64)
18 gae_duplicate tensor(-0.1266, dtype=torch.float64) tensor(-0.4832, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8697, dtype=torch.float64) delta_t tensor(-0.1320, dtype=torch.float64)
17 gae_duplicate tensor(-0.4287, dtype=torch.float64) tensor(2.7245, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8053, dtype=torch.float64) delta_t tensor(0.0966, dtype=torch.float64)
16 gae_duplicate tensor(-0.3376, dtype=torch.float64) tensor(-2.0604, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5835, dtype=torch.float64) delta_t tensor(0.1513, dtype=torch.float64)
15 gae_duplicate tensor(-0.0770, dtype=torch.float64) tensor(-3.0240, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3935, dtype=torch.float64) delta_t tensor(0.0968, dtype=torch.float64)
14 gae_duplicate tensor(-0.2063, dtype=torch.float64) tensor(-2.1115, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1835, dtype=torch.float64) delta_t tensor(-0.1973, dtype=torch.float64)
13 gae_duplicate tensor(-2.0469, dtype=torch.float64) tensor(3.3119, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0113, dtype=torch.float64) delta_t tensor(-0.3608, dtype=torch.float64)
12 gae_duplicate tensor(-2.6708, dtype=torch.float64) tensor(6.8351, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1037, dtype=torch.float64) delta_t tensor(0.1916, dtype=torch.float64)
11 gae_duplicate tensor(-0.4286, dtype=torch.float64) tensor(-3.4948, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0292, dtype=torch.float64) delta_t tensor(-0.0944, dtype=torch.float64)
10 gae_duplicate tensor(-0.3739, dtype=torch.float64) tensor(1.6188, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5138, dtype=torch.float64) delta_t tensor(0.4336, dtype=torch.float64)
9 gae_duplicate tensor(-0.2499, dtype=torch.float64) tensor(-7.7827, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3677, dtype=torch.float64) delta_t tensor(-0.0409, dtype=torch.float64)
8 gae_duplicate tensor(-0.1781, dtype=torch.float64) tensor(0.3187, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4577, dtype=torch.float64) delta_t tensor(-0.0264, dtype=torch.float64)
7 gae_duplicate tensor(-0.4365, dtype=torch.float64) tensor(0.2559, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1932, dtype=torch.float64) delta_t tensor(-0.0724, dtype=torch.float64)
6 gae_duplicate tensor(-0.2794, dtype=torch.float64) tensor(1.4266, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1254, dtype=torch.float64) delta_t tensor(-0.2411, dtype=torch.float64)
5 gae_duplicate tensor(-0.4269, dtype=torch.float64) tensor(4.5734, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7100, dtype=torch.float64) delta_t tensor(-0.0428, dtype=torch.float64)
4 gae_duplicate tensor(-0.2218, dtype=torch.float64) tensor(1.2644, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7786, dtype=torch.float64) delta_t tensor(0.0473, dtype=torch.float64)
3 gae_duplicate tensor(-0.5990, dtype=torch.float64) tensor(-0.7830, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1780, dtype=torch.float64) delta_t tensor(-0.1497, dtype=torch.float64)
2 gae_duplicate tensor(-0.7617, dtype=torch.float64) tensor(2.6433, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-464.9623107910156
value loss:29.7093505859375
entropies:349.11871337890625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3912.9844)
ToM Target loss= tensor(3818.9622)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.810602188110352 seconds
19 rew tensor(0.9633, dtype=torch.float64) delta_t tensor(-0.1468, dtype=torch.float64)
19 gae_duplicate tensor(-0.4472, dtype=torch.float64) tensor(2.6330, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8248, dtype=torch.float64) delta_t tensor(-0.0304, dtype=torch.float64)
18 gae_duplicate tensor(-0.4158, dtype=torch.float64) tensor(0.8038, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.0505, dtype=torch.float64)
17 gae_duplicate tensor(-0.2598, dtype=torch.float64) tensor(-0.8388, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.3132, dtype=torch.float64) delta_t tensor(-0.1624, dtype=torch.float64)
16 gae_duplicate tensor(-1.2022, dtype=torch.float64) tensor(3.1845, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5775, dtype=torch.float64) delta_t tensor(0.1018, dtype=torch.float64)
15 gae_duplicate tensor(-0.3213, dtype=torch.float64) tensor(-1.5809, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3342, dtype=torch.float64) delta_t tensor(0.0206, dtype=torch.float64)
14 gae_duplicate tensor(-0.1617, dtype=torch.float64) tensor(-0.6071, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2350, dtype=torch.float64) delta_t tensor(0.0262, dtype=torch.float64)
13 gae_duplicate tensor(-1.0835, dtype=torch.float64) tensor(-0.6822, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3358, dtype=torch.float64) delta_t tensor(0.0716, dtype=torch.float64)
12 gae_duplicate tensor(-0.2177, dtype=torch.float64) tensor(-1.4215, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2566, dtype=torch.float64) delta_t tensor(0.2858, dtype=torch.float64)
11 gae_duplicate tensor(-0.0650, dtype=torch.float64) tensor(-6.5585, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0146, dtype=torch.float64) delta_t tensor(0.0222, dtype=torch.float64)
10 gae_duplicate tensor(-0.6312, dtype=torch.float64) tensor(-1.5720, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3284, dtype=torch.float64) delta_t tensor(0.2101, dtype=torch.float64)
9 gae_duplicate tensor(-0.2045, dtype=torch.float64) tensor(-3.9350, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1965, dtype=torch.float64) delta_t tensor(0.2530, dtype=torch.float64)
8 gae_duplicate tensor(-0.0988, dtype=torch.float64) tensor(-5.1411, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0789, dtype=torch.float64) delta_t tensor(-0.2256, dtype=torch.float64)
7 gae_duplicate tensor(-1.0754, dtype=torch.float64) tensor(4.5461, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2190, dtype=torch.float64) delta_t tensor(-0.0189, dtype=torch.float64)
6 gae_duplicate tensor(-0.2832, dtype=torch.float64) tensor(1.0867, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6577, dtype=torch.float64) delta_t tensor(-0.0690, dtype=torch.float64)
5 gae_duplicate tensor(-0.6072, dtype=torch.float64) tensor(1.5568, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5094, dtype=torch.float64) delta_t tensor(0.2347, dtype=torch.float64)
4 gae_duplicate tensor(-0.1871, dtype=torch.float64) tensor(-5.0531, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5194, dtype=torch.float64) delta_t tensor(0.0917, dtype=torch.float64)
3 gae_duplicate tensor(-0.2161, dtype=torch.float64) tensor(-2.4397, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1163, dtype=torch.float64) delta_t tensor(0.0368, dtype=torch.float64)
2 gae_duplicate tensor(-0.3948, dtype=torch.float64) tensor(-0.6639, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:806.6739501953125
value loss:19.162757873535156
entropies:348.86517333984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.832741737365723 seconds
19 rew tensor(1.0073, dtype=torch.float64) delta_t tensor(-0.0040, dtype=torch.float64)
19 gae_duplicate tensor(-0.2131, dtype=torch.float64) tensor(0.1472, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9648, dtype=torch.float64) delta_t tensor(0.0140, dtype=torch.float64)
18 gae_duplicate tensor(-0.1137, dtype=torch.float64) tensor(-0.1195, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9351, dtype=torch.float64) delta_t tensor(0.0959, dtype=torch.float64)
17 gae_duplicate tensor(-0.0487, dtype=torch.float64) tensor(-1.9095, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7092, dtype=torch.float64) delta_t tensor(0.0841, dtype=torch.float64)
16 gae_duplicate tensor(-0.1449, dtype=torch.float64) tensor(-1.7131, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6468, dtype=torch.float64) delta_t tensor(0.0517, dtype=torch.float64)
15 gae_duplicate tensor(-0.2708, dtype=torch.float64) tensor(-1.2195, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3226, dtype=torch.float64) delta_t tensor(0.0033, dtype=torch.float64)
14 gae_duplicate tensor(-0.1428, dtype=torch.float64) tensor(-0.2092, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1479, dtype=torch.float64) delta_t tensor(0.0162, dtype=torch.float64)
13 gae_duplicate tensor(-0.8544, dtype=torch.float64) tensor(-0.6042, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4060, dtype=torch.float64) delta_t tensor(-0.6528, dtype=torch.float64)
12 gae_duplicate tensor(-1.6570, dtype=torch.float64) tensor(13.8920, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2931, dtype=torch.float64) delta_t tensor(0.6380, dtype=torch.float64)
11 gae_duplicate tensor(0.1158, dtype=torch.float64) tensor(-11.9207, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2143, dtype=torch.float64) delta_t tensor(-0.0025, dtype=torch.float64)
10 gae_duplicate tensor(-0.4408, dtype=torch.float64) tensor(-0.7289, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4777, dtype=torch.float64) delta_t tensor(0.4989, dtype=torch.float64)
9 gae_duplicate tensor(0.0184, dtype=torch.float64) tensor(-9.1296, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1029, dtype=torch.float64) delta_t tensor(-0.2481, dtype=torch.float64)
8 gae_duplicate tensor(-0.5674, dtype=torch.float64) tensor(3.5745, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3753, dtype=torch.float64) delta_t tensor(0.0814, dtype=torch.float64)
7 gae_duplicate tensor(-0.3405, dtype=torch.float64) tensor(-1.1501, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2731, dtype=torch.float64) delta_t tensor(-0.0752, dtype=torch.float64)
6 gae_duplicate tensor(-0.2677, dtype=torch.float64) tensor(1.3524, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0692, dtype=torch.float64) delta_t tensor(0.0480, dtype=torch.float64)
5 gae_duplicate tensor(-0.3443, dtype=torch.float64) tensor(-0.6839, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7918, dtype=torch.float64) delta_t tensor(0.1256, dtype=torch.float64)
4 gae_duplicate tensor(-0.2073, dtype=torch.float64) tensor(-2.1850, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6870, dtype=torch.float64) delta_t tensor(0.1407, dtype=torch.float64)
3 gae_duplicate tensor(-0.1167, dtype=torch.float64) tensor(-2.8164, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0824, dtype=torch.float64) delta_t tensor(-0.1572, dtype=torch.float64)
2 gae_duplicate tensor(-0.3077, dtype=torch.float64) tensor(2.6920, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:593.36083984375
value loss:22.953861236572266
entropies:348.6903991699219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.916727066040039 seconds
19 rew tensor(1.0080, dtype=torch.float64) delta_t tensor(-0.0915, dtype=torch.float64)
19 gae_duplicate tensor(-0.2067, dtype=torch.float64) tensor(1.8361, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9759, dtype=torch.float64) delta_t tensor(0.0332, dtype=torch.float64)
18 gae_duplicate tensor(-0.0883, dtype=torch.float64) tensor(-0.4189, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9786, dtype=torch.float64) delta_t tensor(-0.1627, dtype=torch.float64)
17 gae_duplicate tensor(-0.2503, dtype=torch.float64) tensor(3.0580, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.1233, dtype=torch.float64)
16 gae_duplicate tensor(0.0598, dtype=torch.float64) tensor(-1.9103, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7433, dtype=torch.float64) delta_t tensor(0.3671, dtype=torch.float64)
15 gae_duplicate tensor(-0.0708, dtype=torch.float64) tensor(-7.6983, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4492, dtype=torch.float64) delta_t tensor(-0.0227, dtype=torch.float64)
14 gae_duplicate tensor(-0.1434, dtype=torch.float64) tensor(-0.2965, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1982, dtype=torch.float64) delta_t tensor(0.2074, dtype=torch.float64)
13 gae_duplicate tensor(-0.0298, dtype=torch.float64) tensor(-3.8177, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4887, dtype=torch.float64) delta_t tensor(0.0516, dtype=torch.float64)
12 gae_duplicate tensor(-0.1715, dtype=torch.float64) tensor(-1.5130, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0464, dtype=torch.float64) delta_t tensor(0.1778, dtype=torch.float64)
11 gae_duplicate tensor(0.0618, dtype=torch.float64) tensor(-3.6138, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0951, dtype=torch.float64) delta_t tensor(-0.0891, dtype=torch.float64)
10 gae_duplicate tensor(-0.2061, dtype=torch.float64) tensor(1.5015, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4983, dtype=torch.float64) delta_t tensor(0.3792, dtype=torch.float64)
9 gae_duplicate tensor(0.0454, dtype=torch.float64) tensor(-7.1986, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3152, dtype=torch.float64) delta_t tensor(-0.0764, dtype=torch.float64)
8 gae_duplicate tensor(-0.1440, dtype=torch.float64) tensor(0.8470, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3955, dtype=torch.float64) delta_t tensor(0.0656, dtype=torch.float64)
7 gae_duplicate tensor(-0.0663, dtype=torch.float64) tensor(-1.3689, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1223, dtype=torch.float64) delta_t tensor(-0.0672, dtype=torch.float64)
6 gae_duplicate tensor(-0.1850, dtype=torch.float64) tensor(0.8375, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0465, dtype=torch.float64) delta_t tensor(0.0167, dtype=torch.float64)
5 gae_duplicate tensor(-0.3534, dtype=torch.float64) tensor(-0.1261, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7922, dtype=torch.float64) delta_t tensor(-0.0418, dtype=torch.float64)
4 gae_duplicate tensor(-0.1923, dtype=torch.float64) tensor(0.9548, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7816, dtype=torch.float64) delta_t tensor(0.1555, dtype=torch.float64)
3 gae_duplicate tensor(0.0018, dtype=torch.float64) tensor(-2.8224, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1995, dtype=torch.float64) delta_t tensor(-0.0583, dtype=torch.float64)
2 gae_duplicate tensor(-0.2305, dtype=torch.float64) tensor(0.8061, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1036.888671875
value loss:7.414525508880615
entropies:348.39990234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.801335096359253 seconds
19 rew tensor(0.9998, dtype=torch.float64) delta_t tensor(-0.1413, dtype=torch.float64)
19 gae_duplicate tensor(-0.4402, dtype=torch.float64) tensor(2.8416, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8259, dtype=torch.float64) delta_t tensor(-0.0173, dtype=torch.float64)
18 gae_duplicate tensor(-0.2856, dtype=torch.float64) tensor(0.7625, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7736, dtype=torch.float64) delta_t tensor(0.0133, dtype=torch.float64)
17 gae_duplicate tensor(-0.1565, dtype=torch.float64) tensor(-0.2013, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9360, dtype=torch.float64) delta_t tensor(0.1987, dtype=torch.float64)
16 gae_duplicate tensor(0.1358, dtype=torch.float64) tensor(-4.0021, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4732, dtype=torch.float64) delta_t tensor(0.0536, dtype=torch.float64)
15 gae_duplicate tensor(-0.2052, dtype=torch.float64) tensor(-1.6008, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6364, dtype=torch.float64) delta_t tensor(0.1719, dtype=torch.float64)
14 gae_duplicate tensor(-0.3303, dtype=torch.float64) tensor(-3.9018, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.2292, dtype=torch.float64) delta_t tensor(-0.1799, dtype=torch.float64)
13 gae_duplicate tensor(-2.3083, dtype=torch.float64) tensor(2.9324, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4402, dtype=torch.float64) delta_t tensor(-0.0350, dtype=torch.float64)
12 gae_duplicate tensor(-0.5251, dtype=torch.float64) tensor(1.0529, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0795, dtype=torch.float64) delta_t tensor(0.3936, dtype=torch.float64)
11 gae_duplicate tensor(0.0702, dtype=torch.float64) tensor(-7.4105, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4148, dtype=torch.float64) delta_t tensor(0.1734, dtype=torch.float64)
10 gae_duplicate tensor(-0.0214, dtype=torch.float64) tensor(-4.4729, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6673, dtype=torch.float64) delta_t tensor(0.2844, dtype=torch.float64)
9 gae_duplicate tensor(-0.0815, dtype=torch.float64) tensor(-5.5493, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3811, dtype=torch.float64) delta_t tensor(0.0542, dtype=torch.float64)
8 gae_duplicate tensor(-0.3563, dtype=torch.float64) tensor(-1.9715, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2720, dtype=torch.float64) delta_t tensor(0.0673, dtype=torch.float64)
7 gae_duplicate tensor(-0.2783, dtype=torch.float64) tensor(-2.1218, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0804, dtype=torch.float64) delta_t tensor(0.0390, dtype=torch.float64)
6 gae_duplicate tensor(-0.1813, dtype=torch.float64) tensor(-0.9003, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8313, dtype=torch.float64) delta_t tensor(-0.0080, dtype=torch.float64)
5 gae_duplicate tensor(-0.2577, dtype=torch.float64) tensor(0.3411, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.6620, dtype=torch.float64) delta_t tensor(0.2064, dtype=torch.float64)
4 gae_duplicate tensor(-0.1678, dtype=torch.float64) tensor(-3.8907, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4751, dtype=torch.float64) delta_t tensor(0.1564, dtype=torch.float64)
3 gae_duplicate tensor(-0.0006, dtype=torch.float64) tensor(-3.3918, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0382, dtype=torch.float64) delta_t tensor(-0.0416, dtype=torch.float64)
2 gae_duplicate tensor(-0.2315, dtype=torch.float64) tensor(0.6603, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1570.472412109375
value loss:20.013874053955078
entropies:348.1981201171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.845889091491699 seconds
19 rew tensor(1.0223, dtype=torch.float64) delta_t tensor(-0.0736, dtype=torch.float64)
19 gae_duplicate tensor(-0.2410, dtype=torch.float64) tensor(1.4347, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9050, dtype=torch.float64) delta_t tensor(-0.0106, dtype=torch.float64)
18 gae_duplicate tensor(-0.3174, dtype=torch.float64) tensor(0.2603, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5703, dtype=torch.float64) delta_t tensor(-0.2107, dtype=torch.float64)
17 gae_duplicate tensor(-1.5394, dtype=torch.float64) tensor(5.3694, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7888, dtype=torch.float64) delta_t tensor(0.1774, dtype=torch.float64)
16 gae_duplicate tensor(-0.0678, dtype=torch.float64) tensor(-2.8677, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7236, dtype=torch.float64) delta_t tensor(0.1063, dtype=torch.float64)
15 gae_duplicate tensor(-0.1335, dtype=torch.float64) tensor(-2.2666, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3148, dtype=torch.float64) delta_t tensor(-0.1229, dtype=torch.float64)
14 gae_duplicate tensor(-0.3468, dtype=torch.float64) tensor(1.8766, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4167, dtype=torch.float64) delta_t tensor(0.2160, dtype=torch.float64)
13 gae_duplicate tensor(-0.0040, dtype=torch.float64) tensor(-4.0617, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3324, dtype=torch.float64) delta_t tensor(-0.1608, dtype=torch.float64)
12 gae_duplicate tensor(-0.3364, dtype=torch.float64) tensor(2.8933, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1390, dtype=torch.float64) delta_t tensor(0.4369, dtype=torch.float64)
11 gae_duplicate tensor(-0.0403, dtype=torch.float64) tensor(-7.8951, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1660, dtype=torch.float64) delta_t tensor(-0.1483, dtype=torch.float64)
10 gae_duplicate tensor(-0.3586, dtype=torch.float64) tensor(1.9610, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8129, dtype=torch.float64) delta_t tensor(0.3389, dtype=torch.float64)
9 gae_duplicate tensor(0.1245, dtype=torch.float64) tensor(-6.0481, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7207, dtype=torch.float64) delta_t tensor(0.0929, dtype=torch.float64)
8 gae_duplicate tensor(-0.1392, dtype=torch.float64) tensor(-2.5173, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.8994, dtype=torch.float64) delta_t tensor(-0.0105, dtype=torch.float64)
7 gae_duplicate tensor(-0.2419, dtype=torch.float64) tensor(0.0037, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2631, dtype=torch.float64) delta_t tensor(0.0448, dtype=torch.float64)
6 gae_duplicate tensor(-0.2688, dtype=torch.float64) tensor(-0.7667, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3322, dtype=torch.float64) delta_t tensor(-0.0968, dtype=torch.float64)
5 gae_duplicate tensor(-0.3091, dtype=torch.float64) tensor(1.9524, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9150, dtype=torch.float64) delta_t tensor(0.1005, dtype=torch.float64)
4 gae_duplicate tensor(-0.1523, dtype=torch.float64) tensor(-1.4332, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1084, dtype=torch.float64) delta_t tensor(0.0981, dtype=torch.float64)
3 gae_duplicate tensor(-0.2664, dtype=torch.float64) tensor(-1.9970, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4492, dtype=torch.float64) delta_t tensor(0.1279, dtype=torch.float64)
2 gae_duplicate tensor(-0.0668, dtype=torch.float64) tensor(-2.8128, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:819.435302734375
value loss:14.182226181030273
entropies:348.050048828125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3913.6030)
ToM Target loss= tensor(3812.4634)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.801961183547974 seconds
19 rew tensor(1.0425, dtype=torch.float64) delta_t tensor(-0.0821, dtype=torch.float64)
19 gae_duplicate tensor(-0.1894, dtype=torch.float64) tensor(1.5940, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9669, dtype=torch.float64) delta_t tensor(-0.0003, dtype=torch.float64)
18 gae_duplicate tensor(-0.4673, dtype=torch.float64) tensor(0.1633, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9462, dtype=torch.float64) delta_t tensor(0.0290, dtype=torch.float64)
17 gae_duplicate tensor(-0.3605, dtype=torch.float64) tensor(-0.5566, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8072, dtype=torch.float64) delta_t tensor(-0.0298, dtype=torch.float64)
16 gae_duplicate tensor(-0.3543, dtype=torch.float64) tensor(0.5070, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6271, dtype=torch.float64) delta_t tensor(0.0461, dtype=torch.float64)
15 gae_duplicate tensor(-0.1056, dtype=torch.float64) tensor(-0.8041, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6765, dtype=torch.float64) delta_t tensor(0.0328, dtype=torch.float64)
14 gae_duplicate tensor(-0.1918, dtype=torch.float64) tensor(-0.6591, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3258, dtype=torch.float64) delta_t tensor(0.1897, dtype=torch.float64)
13 gae_duplicate tensor(-0.0749, dtype=torch.float64) tensor(-3.4588, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0301, dtype=torch.float64) delta_t tensor(-0.3879, dtype=torch.float64)
12 gae_duplicate tensor(-1.2221, dtype=torch.float64) tensor(7.5316, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.5561, dtype=torch.float64) delta_t tensor(-1.2254, dtype=torch.float64)
11 gae_duplicate tensor(-5.8859, dtype=torch.float64) tensor(23.5539, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0743, dtype=torch.float64) delta_t tensor(-0.3120, dtype=torch.float64)
10 gae_duplicate tensor(-2.3715, dtype=torch.float64) tensor(7.8838, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4912, dtype=torch.float64) delta_t tensor(0.3441, dtype=torch.float64)
9 gae_duplicate tensor(-0.0813, dtype=torch.float64) tensor(-6.2452, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.3290, dtype=torch.float64) delta_t tensor(0.0456, dtype=torch.float64)
8 gae_duplicate tensor(-0.1613, dtype=torch.float64) tensor(-1.4223, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3809, dtype=torch.float64) delta_t tensor(0.1044, dtype=torch.float64)
7 gae_duplicate tensor(-0.3325, dtype=torch.float64) tensor(-2.6740, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3159, dtype=torch.float64) delta_t tensor(0.0743, dtype=torch.float64)
6 gae_duplicate tensor(-0.1938, dtype=torch.float64) tensor(-1.6730, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0864, dtype=torch.float64) delta_t tensor(-0.0372, dtype=torch.float64)
5 gae_duplicate tensor(-0.3391, dtype=torch.float64) tensor(0.7925, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7605, dtype=torch.float64) delta_t tensor(0.1069, dtype=torch.float64)
4 gae_duplicate tensor(-0.2454, dtype=torch.float64) tensor(-1.9498, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7092, dtype=torch.float64) delta_t tensor(0.0420, dtype=torch.float64)
3 gae_duplicate tensor(-0.6592, dtype=torch.float64) tensor(-1.1373, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0911, dtype=torch.float64) delta_t tensor(-0.0540, dtype=torch.float64)
2 gae_duplicate tensor(-0.6730, dtype=torch.float64) tensor(0.5945, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1284.096923828125
value loss:84.79069519042969
entropies:347.83734130859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.873865127563477 seconds
19 rew tensor(0.9243, dtype=torch.float64) delta_t tensor(-0.1225, dtype=torch.float64)
19 gae_duplicate tensor(-0.2039, dtype=torch.float64) tensor(2.3939, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8731, dtype=torch.float64) delta_t tensor(-0.1198, dtype=torch.float64)
18 gae_duplicate tensor(-0.4308, dtype=torch.float64) tensor(2.5147, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6651, dtype=torch.float64) delta_t tensor(-0.2101, dtype=torch.float64)
17 gae_duplicate tensor(-0.3171, dtype=torch.float64) tensor(4.1865, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4608, dtype=torch.float64) delta_t tensor(-0.2120, dtype=torch.float64)
16 gae_duplicate tensor(-0.4498, dtype=torch.float64) tensor(4.4093, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2408, dtype=torch.float64) delta_t tensor(0.0994, dtype=torch.float64)
15 gae_duplicate tensor(-0.0058, dtype=torch.float64) tensor(-1.4239, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6469, dtype=torch.float64) delta_t tensor(0.1545, dtype=torch.float64)
14 gae_duplicate tensor(-0.0283, dtype=torch.float64) tensor(-3.3546, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.5378, dtype=torch.float64) delta_t tensor(-0.2491, dtype=torch.float64)
13 gae_duplicate tensor(-1.3188, dtype=torch.float64) tensor(4.0294, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6714, dtype=torch.float64) delta_t tensor(0.1926, dtype=torch.float64)
12 gae_duplicate tensor(-0.0490, dtype=torch.float64) tensor(-3.0924, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2727, dtype=torch.float64) delta_t tensor(-0.0751, dtype=torch.float64)
11 gae_duplicate tensor(-0.3212, dtype=torch.float64) tensor(1.0037, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3196, dtype=torch.float64) delta_t tensor(0.0972, dtype=torch.float64)
10 gae_duplicate tensor(-0.2773, dtype=torch.float64) tensor(-1.8285, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4850, dtype=torch.float64) delta_t tensor(0.1323, dtype=torch.float64)
9 gae_duplicate tensor(-0.0046, dtype=torch.float64) tensor(-2.5817, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4689, dtype=torch.float64) delta_t tensor(0.2660, dtype=torch.float64)
8 gae_duplicate tensor(0.0057, dtype=torch.float64) tensor(-5.3361, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9439, dtype=torch.float64) delta_t tensor(-0.0212, dtype=torch.float64)
7 gae_duplicate tensor(-0.2134, dtype=torch.float64) tensor(0.1510, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.3436, dtype=torch.float64) delta_t tensor(0.1508, dtype=torch.float64)
6 gae_duplicate tensor(-0.0240, dtype=torch.float64) tensor(-2.7980, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5978, dtype=torch.float64) delta_t tensor(-0.0445, dtype=torch.float64)
5 gae_duplicate tensor(-0.3481, dtype=torch.float64) tensor(0.5806, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7326, dtype=torch.float64) delta_t tensor(0.3898, dtype=torch.float64)
4 gae_duplicate tensor(-0.1277, dtype=torch.float64) tensor(-8.2115, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2515, dtype=torch.float64) delta_t tensor(0.1560, dtype=torch.float64)
3 gae_duplicate tensor(0.0240, dtype=torch.float64) tensor(-3.9463, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0597, dtype=torch.float64) delta_t tensor(-0.0263, dtype=torch.float64)
2 gae_duplicate tensor(-0.3004, dtype=torch.float64) tensor(0.4191, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:601.8854370117188
value loss:12.055750846862793
entropies:347.75848388671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.745307922363281 seconds
19 rew tensor(0.9599, dtype=torch.float64) delta_t tensor(-0.1395, dtype=torch.float64)
19 gae_duplicate tensor(-0.4777, dtype=torch.float64) tensor(2.6184, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9176, dtype=torch.float64) delta_t tensor(0.0061, dtype=torch.float64)
18 gae_duplicate tensor(-0.2467, dtype=torch.float64) tensor(0.3022, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7239, dtype=torch.float64) delta_t tensor(-0.0565, dtype=torch.float64)
17 gae_duplicate tensor(-0.2421, dtype=torch.float64) tensor(1.0797, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6139, dtype=torch.float64) delta_t tensor(0.0463, dtype=torch.float64)
16 gae_duplicate tensor(-0.2486, dtype=torch.float64) tensor(-0.8252, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4222, dtype=torch.float64) delta_t tensor(0.0079, dtype=torch.float64)
15 gae_duplicate tensor(-0.3987, dtype=torch.float64) tensor(-0.4021, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5336, dtype=torch.float64) delta_t tensor(0.0265, dtype=torch.float64)
14 gae_duplicate tensor(-0.1613, dtype=torch.float64) tensor(-0.4674, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1866, dtype=torch.float64) delta_t tensor(-0.0030, dtype=torch.float64)
13 gae_duplicate tensor(-0.2441, dtype=torch.float64) tensor(-0.2355, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5239, dtype=torch.float64) delta_t tensor(-0.0446, dtype=torch.float64)
12 gae_duplicate tensor(-0.4496, dtype=torch.float64) tensor(0.8799, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0770, dtype=torch.float64) delta_t tensor(0.1647, dtype=torch.float64)
11 gae_duplicate tensor(-0.0306, dtype=torch.float64) tensor(-2.8475, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0588, dtype=torch.float64) delta_t tensor(-0.2580, dtype=torch.float64)
10 gae_duplicate tensor(-0.5431, dtype=torch.float64) tensor(4.4711, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7720, dtype=torch.float64) delta_t tensor(0.2282, dtype=torch.float64)
9 gae_duplicate tensor(-0.0138, dtype=torch.float64) tensor(-3.9934, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7237, dtype=torch.float64) delta_t tensor(0.2164, dtype=torch.float64)
8 gae_duplicate tensor(0.0236, dtype=torch.float64) tensor(-4.3702, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.9452, dtype=torch.float64) delta_t tensor(-0.2217, dtype=torch.float64)
7 gae_duplicate tensor(-0.5354, dtype=torch.float64) tensor(4.1895, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5036, dtype=torch.float64) delta_t tensor(0.1329, dtype=torch.float64)
6 gae_duplicate tensor(-0.1561, dtype=torch.float64) tensor(-2.3541, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3959, dtype=torch.float64) delta_t tensor(-0.2870, dtype=torch.float64)
5 gae_duplicate tensor(-0.3966, dtype=torch.float64) tensor(5.2372, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.8956, dtype=torch.float64) delta_t tensor(0.1243, dtype=torch.float64)
4 gae_duplicate tensor(-0.1194, dtype=torch.float64) tensor(-1.8836, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9105, dtype=torch.float64) delta_t tensor(0.1129, dtype=torch.float64)
3 gae_duplicate tensor(-0.2287, dtype=torch.float64) tensor(-2.8108, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3992, dtype=torch.float64) delta_t tensor(0.1315, dtype=torch.float64)
2 gae_duplicate tensor(-0.2745, dtype=torch.float64) tensor(-2.5287, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:118.88993072509766
value loss:9.203676223754883
entropies:347.7789001464844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.011535882949829 seconds
19 rew tensor(0.9254, dtype=torch.float64) delta_t tensor(-0.2606, dtype=torch.float64)
19 gae_duplicate tensor(-0.4469, dtype=torch.float64) tensor(5.1840, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8620, dtype=torch.float64) delta_t tensor(-0.0494, dtype=torch.float64)
18 gae_duplicate tensor(-0.2432, dtype=torch.float64) tensor(1.3632, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8630, dtype=torch.float64) delta_t tensor(-0.0266, dtype=torch.float64)
17 gae_duplicate tensor(-0.2216, dtype=torch.float64) tensor(0.5562, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7338, dtype=torch.float64) delta_t tensor(-0.0107, dtype=torch.float64)
16 gae_duplicate tensor(-0.2691, dtype=torch.float64) tensor(0.2677, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6469, dtype=torch.float64) delta_t tensor(0.0036, dtype=torch.float64)
15 gae_duplicate tensor(-0.1860, dtype=torch.float64) tensor(-0.0347, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4972, dtype=torch.float64) delta_t tensor(0.0804, dtype=torch.float64)
14 gae_duplicate tensor(-0.2697, dtype=torch.float64) tensor(-1.4912, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5831, dtype=torch.float64) delta_t tensor(0.2263, dtype=torch.float64)
13 gae_duplicate tensor(-0.0698, dtype=torch.float64) tensor(-4.4027, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2571, dtype=torch.float64) delta_t tensor(-0.5997, dtype=torch.float64)
12 gae_duplicate tensor(-3.0034, dtype=torch.float64) tensor(11.1782, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3246, dtype=torch.float64) delta_t tensor(0.5052, dtype=torch.float64)
11 gae_duplicate tensor(0.0117, dtype=torch.float64) tensor(-8.9245, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1090, dtype=torch.float64) delta_t tensor(-0.1031, dtype=torch.float64)
10 gae_duplicate tensor(-0.4401, dtype=torch.float64) tensor(0.9854, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5830, dtype=torch.float64) delta_t tensor(0.3700, dtype=torch.float64)
9 gae_duplicate tensor(0.0781, dtype=torch.float64) tensor(-6.8416, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4579, dtype=torch.float64) delta_t tensor(0.0839, dtype=torch.float64)
8 gae_duplicate tensor(-0.3976, dtype=torch.float64) tensor(-2.0448, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.8582, dtype=torch.float64) delta_t tensor(-1.1056, dtype=torch.float64)
7 gae_duplicate tensor(-3.5990, dtype=torch.float64) tensor(25.5864, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0022, dtype=torch.float64) delta_t tensor(-0.1282, dtype=torch.float64)
6 gae_duplicate tensor(-1.1396, dtype=torch.float64) tensor(4.3645, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3068, dtype=torch.float64) delta_t tensor(0.0706, dtype=torch.float64)
5 gae_duplicate tensor(-0.2769, dtype=torch.float64) tensor(-1.4979, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.8965, dtype=torch.float64) delta_t tensor(0.2863, dtype=torch.float64)
4 gae_duplicate tensor(-0.0745, dtype=torch.float64) tensor(-5.3459, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2796, dtype=torch.float64) delta_t tensor(-0.1023, dtype=torch.float64)
3 gae_duplicate tensor(-0.3109, dtype=torch.float64) tensor(1.2072, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4956, dtype=torch.float64) delta_t tensor(0.1626, dtype=torch.float64)
2 gae_duplicate tensor(-0.2889, dtype=torch.float64) tensor(-2.7082, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1033.561279296875
value loss:60.49015808105469
entropies:347.7671203613281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.846249103546143 seconds
19 rew tensor(0.9866, dtype=torch.float64) delta_t tensor(0.0433, dtype=torch.float64)
19 gae_duplicate tensor(-0.1264, dtype=torch.float64) tensor(-0.8101, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8897, dtype=torch.float64) delta_t tensor(0.1001, dtype=torch.float64)
18 gae_duplicate tensor(-0.2932, dtype=torch.float64) tensor(-1.9572, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8139, dtype=torch.float64) delta_t tensor(0.0924, dtype=torch.float64)
17 gae_duplicate tensor(-0.1631, dtype=torch.float64) tensor(-2.4592, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6160, dtype=torch.float64) delta_t tensor(-0.1174, dtype=torch.float64)
16 gae_duplicate tensor(-0.8800, dtype=torch.float64) tensor(1.9196, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6309, dtype=torch.float64) delta_t tensor(0.0675, dtype=torch.float64)
15 gae_duplicate tensor(-0.2984, dtype=torch.float64) tensor(-1.2002, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7863, dtype=torch.float64) delta_t tensor(0.0641, dtype=torch.float64)
14 gae_duplicate tensor(-0.2607, dtype=torch.float64) tensor(-1.3137, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3307, dtype=torch.float64) delta_t tensor(0.0046, dtype=torch.float64)
13 gae_duplicate tensor(-0.2306, dtype=torch.float64) tensor(-0.2027, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7422, dtype=torch.float64) delta_t tensor(0.0564, dtype=torch.float64)
12 gae_duplicate tensor(-0.1686, dtype=torch.float64) tensor(-1.0848, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1407, dtype=torch.float64) delta_t tensor(0.1103, dtype=torch.float64)
11 gae_duplicate tensor(0.0072, dtype=torch.float64) tensor(-2.2330, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0427, dtype=torch.float64) delta_t tensor(-0.1653, dtype=torch.float64)
10 gae_duplicate tensor(-0.3249, dtype=torch.float64) tensor(3.2042, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7415, dtype=torch.float64) delta_t tensor(0.2530, dtype=torch.float64)
9 gae_duplicate tensor(0.1720, dtype=torch.float64) tensor(-4.5720, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7192, dtype=torch.float64) delta_t tensor(0.1409, dtype=torch.float64)
8 gae_duplicate tensor(-0.0202, dtype=torch.float64) tensor(-3.4209, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-3.2373, dtype=torch.float64) delta_t tensor(-1.3360, dtype=torch.float64)
7 gae_duplicate tensor(-3.4351, dtype=torch.float64) tensor(25.0847, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1202, dtype=torch.float64) delta_t tensor(0.0370, dtype=torch.float64)
6 gae_duplicate tensor(-0.5237, dtype=torch.float64) tensor(1.9895, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5278, dtype=torch.float64) delta_t tensor(-0.0547, dtype=torch.float64)
5 gae_duplicate tensor(-0.3245, dtype=torch.float64) tensor(1.0834, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9159, dtype=torch.float64) delta_t tensor(0.1029, dtype=torch.float64)
4 gae_duplicate tensor(-0.1231, dtype=torch.float64) tensor(-1.8196, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3525, dtype=torch.float64) delta_t tensor(-0.0574, dtype=torch.float64)
3 gae_duplicate tensor(-0.3228, dtype=torch.float64) tensor(1.1575, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5677, dtype=torch.float64) delta_t tensor(0.1886, dtype=torch.float64)
2 gae_duplicate tensor(-0.0552, dtype=torch.float64) tensor(-4.3773, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-579.2197265625
value loss:44.35580825805664
entropies:347.6289367675781
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3910.7026)
ToM Target loss= tensor(3812.3884)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.760601043701172 seconds
19 rew tensor(0.9730, dtype=torch.float64) delta_t tensor(0.0072, dtype=torch.float64)
19 gae_duplicate tensor(-0.2313, dtype=torch.float64) tensor(-0.2059, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9633, dtype=torch.float64) delta_t tensor(0.1215, dtype=torch.float64)
18 gae_duplicate tensor(-0.1054, dtype=torch.float64) tensor(-2.3430, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8354, dtype=torch.float64) delta_t tensor(-0.0526, dtype=torch.float64)
17 gae_duplicate tensor(-0.1335, dtype=torch.float64) tensor(0.7208, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7835, dtype=torch.float64) delta_t tensor(0.0013, dtype=torch.float64)
16 gae_duplicate tensor(-0.2135, dtype=torch.float64) tensor(0.2539, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3928, dtype=torch.float64) delta_t tensor(-0.1715, dtype=torch.float64)
15 gae_duplicate tensor(-0.9470, dtype=torch.float64) tensor(3.0798, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7072, dtype=torch.float64) delta_t tensor(0.0776, dtype=torch.float64)
14 gae_duplicate tensor(-0.1564, dtype=torch.float64) tensor(-1.2323, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3515, dtype=torch.float64) delta_t tensor(0.1135, dtype=torch.float64)
13 gae_duplicate tensor(-0.2384, dtype=torch.float64) tensor(-2.1296, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6751, dtype=torch.float64) delta_t tensor(0.0589, dtype=torch.float64)
12 gae_duplicate tensor(-0.2066, dtype=torch.float64) tensor(-1.3281, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1074, dtype=torch.float64) delta_t tensor(0.2081, dtype=torch.float64)
11 gae_duplicate tensor(-0.0276, dtype=torch.float64) tensor(-4.1383, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1843, dtype=torch.float64) delta_t tensor(-0.1181, dtype=torch.float64)
10 gae_duplicate tensor(-0.3713, dtype=torch.float64) tensor(2.0644, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7596, dtype=torch.float64) delta_t tensor(0.2378, dtype=torch.float64)
9 gae_duplicate tensor(0.0399, dtype=torch.float64) tensor(-4.1529, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6968, dtype=torch.float64) delta_t tensor(0.0857, dtype=torch.float64)
8 gae_duplicate tensor(-0.1009, dtype=torch.float64) tensor(-2.0268, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-3.3240, dtype=torch.float64) delta_t tensor(-1.3687, dtype=torch.float64)
7 gae_duplicate tensor(-3.3156, dtype=torch.float64) tensor(25.6662, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1618, dtype=torch.float64) delta_t tensor(0.0952, dtype=torch.float64)
6 gae_duplicate tensor(-0.3825, dtype=torch.float64) tensor(0.6818, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2839, dtype=torch.float64) delta_t tensor(0.1257, dtype=torch.float64)
5 gae_duplicate tensor(-0.2699, dtype=torch.float64) tensor(-1.9285, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9134, dtype=torch.float64) delta_t tensor(0.0545, dtype=torch.float64)
4 gae_duplicate tensor(-0.1238, dtype=torch.float64) tensor(-1.3137, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1748, dtype=torch.float64) delta_t tensor(0.0157, dtype=torch.float64)
3 gae_duplicate tensor(-0.3894, dtype=torch.float64) tensor(-0.5651, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4279, dtype=torch.float64) delta_t tensor(0.1030, dtype=torch.float64)
2 gae_duplicate tensor(-0.0816, dtype=torch.float64) tensor(-2.0606, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-582.0997924804688
value loss:40.596649169921875
entropies:347.52508544921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.834677219390869 seconds
19 rew tensor(1.0355, dtype=torch.float64) delta_t tensor(-0.0215, dtype=torch.float64)
19 gae_duplicate tensor(-0.1242, dtype=torch.float64) tensor(0.3390, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9617, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
18 gae_duplicate tensor(-0.1470, dtype=torch.float64) tensor(-0.2229, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9292, dtype=torch.float64) delta_t tensor(-0.0364, dtype=torch.float64)
17 gae_duplicate tensor(-0.2129, dtype=torch.float64) tensor(0.7797, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8030, dtype=torch.float64) delta_t tensor(-0.0060, dtype=torch.float64)
16 gae_duplicate tensor(-0.3062, dtype=torch.float64) tensor(0.3913, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7160, dtype=torch.float64) delta_t tensor(0.0902, dtype=torch.float64)
15 gae_duplicate tensor(-0.2353, dtype=torch.float64) tensor(-1.6711, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3069, dtype=torch.float64) delta_t tensor(-0.2965, dtype=torch.float64)
14 gae_duplicate tensor(-2.1030, dtype=torch.float64) tensor(5.0381, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0431, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
13 gae_duplicate tensor(-1.1092, dtype=torch.float64) tensor(-0.3585, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2765, dtype=torch.float64) delta_t tensor(-0.3280, dtype=torch.float64)
12 gae_duplicate tensor(-1.6701, dtype=torch.float64) tensor(5.7863, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0628, dtype=torch.float64) delta_t tensor(0.2446, dtype=torch.float64)
11 gae_duplicate tensor(-0.6328, dtype=torch.float64) tensor(-3.1197, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5266, dtype=torch.float64) delta_t tensor(0.1124, dtype=torch.float64)
10 gae_duplicate tensor(-0.1173, dtype=torch.float64) tensor(-2.6192, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7264, dtype=torch.float64) delta_t tensor(0.3189, dtype=torch.float64)
9 gae_duplicate tensor(0.1804, dtype=torch.float64) tensor(-6.3145, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4388, dtype=torch.float64) delta_t tensor(-0.1151, dtype=torch.float64)
8 gae_duplicate tensor(-0.2877, dtype=torch.float64) tensor(1.5152, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.7289, dtype=torch.float64) delta_t tensor(-0.8384, dtype=torch.float64)
7 gae_duplicate tensor(-5.6675, dtype=torch.float64) tensor(16.3995, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2900, dtype=torch.float64) delta_t tensor(0.0049, dtype=torch.float64)
6 gae_duplicate tensor(-0.9164, dtype=torch.float64) tensor(1.6346, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2126, dtype=torch.float64) delta_t tensor(0.1334, dtype=torch.float64)
5 gae_duplicate tensor(-0.1782, dtype=torch.float64) tensor(-1.8900, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(-0.0454, dtype=torch.float64)
4 gae_duplicate tensor(-0.2063, dtype=torch.float64) tensor(0.7637, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9337, dtype=torch.float64) delta_t tensor(0.0369, dtype=torch.float64)
3 gae_duplicate tensor(-0.1421, dtype=torch.float64) tensor(-0.8133, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2107, dtype=torch.float64) delta_t tensor(-0.0857, dtype=torch.float64)
2 gae_duplicate tensor(-0.3311, dtype=torch.float64) tensor(1.5998, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1024.70458984375
value loss:71.48690795898438
entropies:347.57427978515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.852170944213867 seconds
19 rew tensor(1.0008, dtype=torch.float64) delta_t tensor(-0.0777, dtype=torch.float64)
19 gae_duplicate tensor(-0.2481, dtype=torch.float64) tensor(1.6148, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9262, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
18 gae_duplicate tensor(-0.1337, dtype=torch.float64) tensor(-0.6851, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7541, dtype=torch.float64) delta_t tensor(-0.0353, dtype=torch.float64)
17 gae_duplicate tensor(-0.1042, dtype=torch.float64) tensor(0.6784, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8442, dtype=torch.float64) delta_t tensor(0.0296, dtype=torch.float64)
16 gae_duplicate tensor(-0.0458, dtype=torch.float64) tensor(-0.4210, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5442, dtype=torch.float64) delta_t tensor(-0.1404, dtype=torch.float64)
15 gae_duplicate tensor(-0.4167, dtype=torch.float64) tensor(2.5912, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6350, dtype=torch.float64) delta_t tensor(0.0651, dtype=torch.float64)
14 gae_duplicate tensor(-0.0718, dtype=torch.float64) tensor(-0.9214, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5116, dtype=torch.float64) delta_t tensor(0.0059, dtype=torch.float64)
13 gae_duplicate tensor(-0.1251, dtype=torch.float64) tensor(-0.1789, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4843, dtype=torch.float64) delta_t tensor(-0.0540, dtype=torch.float64)
12 gae_duplicate tensor(-0.2174, dtype=torch.float64) tensor(0.9222, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2156, dtype=torch.float64) delta_t tensor(0.1997, dtype=torch.float64)
11 gae_duplicate tensor(0.0190, dtype=torch.float64) tensor(-3.9123, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0398, dtype=torch.float64) delta_t tensor(-0.2877, dtype=torch.float64)
10 gae_duplicate tensor(-0.4552, dtype=torch.float64) tensor(5.5397, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7536, dtype=torch.float64) delta_t tensor(0.2820, dtype=torch.float64)
9 gae_duplicate tensor(0.0409, dtype=torch.float64) tensor(-5.3435, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.8216, dtype=torch.float64) delta_t tensor(0.0939, dtype=torch.float64)
8 gae_duplicate tensor(-0.0692, dtype=torch.float64) tensor(-2.2677, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.8011, dtype=torch.float64) delta_t tensor(-0.7675, dtype=torch.float64)
7 gae_duplicate tensor(-2.0666, dtype=torch.float64) tensor(14.7168, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1408, dtype=torch.float64) delta_t tensor(0.0129, dtype=torch.float64)
6 gae_duplicate tensor(-0.2333, dtype=torch.float64) tensor(1.2155, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4640, dtype=torch.float64) delta_t tensor(-0.1370, dtype=torch.float64)
5 gae_duplicate tensor(-0.3587, dtype=torch.float64) tensor(3.0631, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9084, dtype=torch.float64) delta_t tensor(0.2774, dtype=torch.float64)
4 gae_duplicate tensor(-0.1945, dtype=torch.float64) tensor(-5.0727, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3792, dtype=torch.float64) delta_t tensor(-0.1044, dtype=torch.float64)
3 gae_duplicate tensor(-0.3206, dtype=torch.float64) tensor(1.4756, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6302, dtype=torch.float64) delta_t tensor(0.2283, dtype=torch.float64)
2 gae_duplicate tensor(-0.0846, dtype=torch.float64) tensor(-3.9905, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-581.1376953125
value loss:19.700645446777344
entropies:347.5713806152344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.910078048706055 seconds
19 rew tensor(0.9140, dtype=torch.float64) delta_t tensor(-0.1222, dtype=torch.float64)
19 gae_duplicate tensor(-0.4593, dtype=torch.float64) tensor(2.4428, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.6108, dtype=torch.float64) delta_t tensor(-0.3664, dtype=torch.float64)
18 gae_duplicate tensor(-1.3065, dtype=torch.float64) tensor(8.0464, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6698, dtype=torch.float64) delta_t tensor(-0.0472, dtype=torch.float64)
17 gae_duplicate tensor(-0.3397, dtype=torch.float64) tensor(1.3170, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6844, dtype=torch.float64) delta_t tensor(0.0218, dtype=torch.float64)
16 gae_duplicate tensor(-0.3633, dtype=torch.float64) tensor(-0.3067, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5960, dtype=torch.float64) delta_t tensor(0.0328, dtype=torch.float64)
15 gae_duplicate tensor(-0.0385, dtype=torch.float64) tensor(-0.7154, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4234, dtype=torch.float64) delta_t tensor(-0.0474, dtype=torch.float64)
14 gae_duplicate tensor(-0.1824, dtype=torch.float64) tensor(1.0573, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5003, dtype=torch.float64) delta_t tensor(0.0640, dtype=torch.float64)
13 gae_duplicate tensor(-0.1160, dtype=torch.float64) tensor(-1.0990, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3698, dtype=torch.float64) delta_t tensor(-0.1724, dtype=torch.float64)
12 gae_duplicate tensor(-0.3706, dtype=torch.float64) tensor(3.1095, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2454, dtype=torch.float64) delta_t tensor(0.1363, dtype=torch.float64)
11 gae_duplicate tensor(-0.0690, dtype=torch.float64) tensor(-2.3911, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0279, dtype=torch.float64) delta_t tensor(-0.1724, dtype=torch.float64)
10 gae_duplicate tensor(-0.5470, dtype=torch.float64) tensor(3.1563, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6358, dtype=torch.float64) delta_t tensor(0.1646, dtype=torch.float64)
9 gae_duplicate tensor(-0.3830, dtype=torch.float64) tensor(-3.0457, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5453, dtype=torch.float64) delta_t tensor(0.1542, dtype=torch.float64)
8 gae_duplicate tensor(-0.0135, dtype=torch.float64) tensor(-3.3857, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4407, dtype=torch.float64) delta_t tensor(-0.0395, dtype=torch.float64)
7 gae_duplicate tensor(-0.1590, dtype=torch.float64) tensor(0.5101, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0326, dtype=torch.float64) delta_t tensor(-0.1084, dtype=torch.float64)
6 gae_duplicate tensor(-0.4531, dtype=torch.float64) tensor(2.0268, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0433, dtype=torch.float64) delta_t tensor(-0.1048, dtype=torch.float64)
5 gae_duplicate tensor(-0.1972, dtype=torch.float64) tensor(2.5110, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.6534, dtype=torch.float64) delta_t tensor(-0.0665, dtype=torch.float64)
4 gae_duplicate tensor(-0.2886, dtype=torch.float64) tensor(1.3846, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7566, dtype=torch.float64) delta_t tensor(0.0430, dtype=torch.float64)
3 gae_duplicate tensor(-0.0350, dtype=torch.float64) tensor(-0.6088, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2681, dtype=torch.float64) delta_t tensor(-0.0046, dtype=torch.float64)
2 gae_duplicate tensor(-0.4342, dtype=torch.float64) tensor(-0.0867, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-845.6917724609375
value loss:10.120269775390625
entropies:347.6357727050781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.909871816635132 seconds
19 rew tensor(1.0036, dtype=torch.float64) delta_t tensor(-0.0907, dtype=torch.float64)
19 gae_duplicate tensor(-0.2271, dtype=torch.float64) tensor(1.6950, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9094, dtype=torch.float64) delta_t tensor(-0.0602, dtype=torch.float64)
18 gae_duplicate tensor(-0.1676, dtype=torch.float64) tensor(1.3765, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4826, dtype=torch.float64) delta_t tensor(-0.2953, dtype=torch.float64)
17 gae_duplicate tensor(-1.6935, dtype=torch.float64) tensor(5.7354, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7181, dtype=torch.float64) delta_t tensor(0.0390, dtype=torch.float64)
16 gae_duplicate tensor(-0.3253, dtype=torch.float64) tensor(-0.2282, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5759, dtype=torch.float64) delta_t tensor(-0.0837, dtype=torch.float64)
15 gae_duplicate tensor(-0.4356, dtype=torch.float64) tensor(1.9442, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4476, dtype=torch.float64) delta_t tensor(-0.0072, dtype=torch.float64)
14 gae_duplicate tensor(-0.1295, dtype=torch.float64) tensor(0.2568, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5477, dtype=torch.float64) delta_t tensor(0.0132, dtype=torch.float64)
13 gae_duplicate tensor(-0.1606, dtype=torch.float64) tensor(-0.2334, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3517, dtype=torch.float64) delta_t tensor(-0.1668, dtype=torch.float64)
12 gae_duplicate tensor(-0.4089, dtype=torch.float64) tensor(3.2033, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3352, dtype=torch.float64) delta_t tensor(0.1846, dtype=torch.float64)
11 gae_duplicate tensor(-0.0534, dtype=torch.float64) tensor(-3.2219, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1384, dtype=torch.float64) delta_t tensor(-0.3039, dtype=torch.float64)
10 gae_duplicate tensor(-0.5642, dtype=torch.float64) tensor(5.7993, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7339, dtype=torch.float64) delta_t tensor(0.3461, dtype=torch.float64)
9 gae_duplicate tensor(0.2823, dtype=torch.float64) tensor(-5.8546, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7810, dtype=torch.float64) delta_t tensor(0.0151, dtype=torch.float64)
8 gae_duplicate tensor(-0.2200, dtype=torch.float64) tensor(-0.6454, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.2915, dtype=torch.float64) delta_t tensor(-0.2160, dtype=torch.float64)
7 gae_duplicate tensor(-0.7941, dtype=torch.float64) tensor(4.3984, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2473, dtype=torch.float64) delta_t tensor(-0.0728, dtype=torch.float64)
6 gae_duplicate tensor(-0.3025, dtype=torch.float64) tensor(1.6612, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5920, dtype=torch.float64) delta_t tensor(-0.1719, dtype=torch.float64)
5 gae_duplicate tensor(-0.3416, dtype=torch.float64) tensor(3.2916, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9082, dtype=torch.float64) delta_t tensor(-0.1241, dtype=torch.float64)
4 gae_duplicate tensor(-0.3204, dtype=torch.float64) tensor(2.5072, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3469, dtype=torch.float64) delta_t tensor(-0.0708, dtype=torch.float64)
3 gae_duplicate tensor(-0.2734, dtype=torch.float64) tensor(1.9827, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5862, dtype=torch.float64) delta_t tensor(0.1494, dtype=torch.float64)
2 gae_duplicate tensor(0.0214, dtype=torch.float64) tensor(-2.6040, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1231.341064453125
value loss:11.925050735473633
entropies:347.69732666015625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3913.1167)
ToM Target loss= tensor(3809.7712)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.849385976791382 seconds
19 rew tensor(0.9204, dtype=torch.float64) delta_t tensor(-0.1915, dtype=torch.float64)
19 gae_duplicate tensor(-0.3648, dtype=torch.float64) tensor(3.9460, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(-0.0004, dtype=torch.float64)
18 gae_duplicate tensor(-0.3939, dtype=torch.float64) tensor(0.5538, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6750, dtype=torch.float64) delta_t tensor(-0.1357, dtype=torch.float64)
17 gae_duplicate tensor(-0.2425, dtype=torch.float64) tensor(2.4215, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7283, dtype=torch.float64) delta_t tensor(0.0204, dtype=torch.float64)
16 gae_duplicate tensor(-0.0975, dtype=torch.float64) tensor(-0.1595, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4411, dtype=torch.float64) delta_t tensor(0.0009, dtype=torch.float64)
15 gae_duplicate tensor(-0.2345, dtype=torch.float64) tensor(-0.0194, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4058, dtype=torch.float64) delta_t tensor(-0.0843, dtype=torch.float64)
14 gae_duplicate tensor(-0.3138, dtype=torch.float64) tensor(1.6487, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0717, dtype=torch.float64) delta_t tensor(-0.1664, dtype=torch.float64)
13 gae_duplicate tensor(-1.5850, dtype=torch.float64) tensor(3.2218, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4478, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
12 gae_duplicate tensor(-0.2544, dtype=torch.float64) tensor(0.1852, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1243, dtype=torch.float64) delta_t tensor(0.0152, dtype=torch.float64)
11 gae_duplicate tensor(-0.2123, dtype=torch.float64) tensor(-0.1978, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1029, dtype=torch.float64) delta_t tensor(-0.0540, dtype=torch.float64)
10 gae_duplicate tensor(-0.2137, dtype=torch.float64) tensor(1.0220, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3702, dtype=torch.float64) delta_t tensor(0.0976, dtype=torch.float64)
9 gae_duplicate tensor(-0.1786, dtype=torch.float64) tensor(-1.7186, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2321, dtype=torch.float64) delta_t tensor(0.0528, dtype=torch.float64)
8 gae_duplicate tensor(-0.1948, dtype=torch.float64) tensor(-1.1161, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9901, dtype=torch.float64) delta_t tensor(-0.1398, dtype=torch.float64)
7 gae_duplicate tensor(-0.7370, dtype=torch.float64) tensor(2.5759, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1643, dtype=torch.float64) delta_t tensor(0.0003, dtype=torch.float64)
6 gae_duplicate tensor(-0.1097, dtype=torch.float64) tensor(0.3281, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5365, dtype=torch.float64) delta_t tensor(0.0704, dtype=torch.float64)
5 gae_duplicate tensor(-0.1994, dtype=torch.float64) tensor(-1.0368, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5441, dtype=torch.float64) delta_t tensor(0.0038, dtype=torch.float64)
4 gae_duplicate tensor(-0.2775, dtype=torch.float64) tensor(-0.3408, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4094, dtype=torch.float64) delta_t tensor(-0.1273, dtype=torch.float64)
3 gae_duplicate tensor(-0.4345, dtype=torch.float64) tensor(2.2745, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0548, dtype=torch.float64) delta_t tensor(-0.0764, dtype=torch.float64)
2 gae_duplicate tensor(-0.7319, dtype=torch.float64) tensor(1.7750, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-923.509033203125
value loss:10.992753028869629
entropies:347.71881103515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.896034002304077 seconds
19 rew tensor(0.9730, dtype=torch.float64) delta_t tensor(0.0975, dtype=torch.float64)
19 gae_duplicate tensor(-0.0449, dtype=torch.float64) tensor(-1.7769, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9843, dtype=torch.float64) delta_t tensor(0.1673, dtype=torch.float64)
18 gae_duplicate tensor(-0.0072, dtype=torch.float64) tensor(-3.5816, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7031, dtype=torch.float64) delta_t tensor(0.0403, dtype=torch.float64)
17 gae_duplicate tensor(-0.1959, dtype=torch.float64) tensor(-0.8742, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.2867, dtype=torch.float64) delta_t tensor(-0.4064, dtype=torch.float64)
16 gae_duplicate tensor(-1.9481, dtype=torch.float64) tensor(7.1925, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.1898, dtype=torch.float64) delta_t tensor(-0.0025, dtype=torch.float64)
15 gae_duplicate tensor(-0.1732, dtype=torch.float64) tensor(0.8436, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7092, dtype=torch.float64) delta_t tensor(0.0003, dtype=torch.float64)
14 gae_duplicate tensor(-0.1927, dtype=torch.float64) tensor(-0.0051, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.2477, dtype=torch.float64) delta_t tensor(-0.0125, dtype=torch.float64)
13 gae_duplicate tensor(-0.1717, dtype=torch.float64) tensor(0.3663, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7926, dtype=torch.float64) delta_t tensor(0.0622, dtype=torch.float64)
12 gae_duplicate tensor(-0.0520, dtype=torch.float64) tensor(-1.1384, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3835, dtype=torch.float64) delta_t tensor(-0.0845, dtype=torch.float64)
11 gae_duplicate tensor(-0.2309, dtype=torch.float64) tensor(1.2913, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4483, dtype=torch.float64) delta_t tensor(-0.1008, dtype=torch.float64)
10 gae_duplicate tensor(-0.3368, dtype=torch.float64) tensor(2.0189, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8023, dtype=torch.float64) delta_t tensor(0.1591, dtype=torch.float64)
9 gae_duplicate tensor(-0.0702, dtype=torch.float64) tensor(-2.6875, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.7175, dtype=torch.float64) delta_t tensor(0.0263, dtype=torch.float64)
8 gae_duplicate tensor(-0.2340, dtype=torch.float64) tensor(-0.6899, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.1478, dtype=torch.float64) delta_t tensor(-0.5628, dtype=torch.float64)
7 gae_duplicate tensor(-3.3198, dtype=torch.float64) tensor(10.1946, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4839, dtype=torch.float64) delta_t tensor(0.0468, dtype=torch.float64)
6 gae_duplicate tensor(-0.1762, dtype=torch.float64) tensor(0.2083, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9776, dtype=torch.float64) delta_t tensor(-0.0636, dtype=torch.float64)
5 gae_duplicate tensor(-0.3246, dtype=torch.float64) tensor(1.0784, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.8675, dtype=torch.float64) delta_t tensor(0.1551, dtype=torch.float64)
4 gae_duplicate tensor(-0.2235, dtype=torch.float64) tensor(-2.7620, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5910, dtype=torch.float64) delta_t tensor(-0.0692, dtype=torch.float64)
3 gae_duplicate tensor(-0.3915, dtype=torch.float64) tensor(0.7400, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1075, dtype=torch.float64) delta_t tensor(-0.1526, dtype=torch.float64)
2 gae_duplicate tensor(-0.3417, dtype=torch.float64) tensor(2.7836, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-806.772705078125
value loss:28.793357849121094
entropies:347.6852722167969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.842419862747192 seconds
19 rew tensor(1.0255, dtype=torch.float64) delta_t tensor(0.0618, dtype=torch.float64)
19 gae_duplicate tensor(-0.0081, dtype=torch.float64) tensor(-1.1908, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9738, dtype=torch.float64) delta_t tensor(0.1163, dtype=torch.float64)
18 gae_duplicate tensor(-0.0385, dtype=torch.float64) tensor(-2.1986, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7541, dtype=torch.float64) delta_t tensor(-0.1581, dtype=torch.float64)
17 gae_duplicate tensor(-1.1070, dtype=torch.float64) tensor(2.2298, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8238, dtype=torch.float64) delta_t tensor(0.1271, dtype=torch.float64)
16 gae_duplicate tensor(-0.0178, dtype=torch.float64) tensor(-2.0069, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8131, dtype=torch.float64) delta_t tensor(0.3354, dtype=torch.float64)
15 gae_duplicate tensor(-0.0193, dtype=torch.float64) tensor(-6.4821, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4401, dtype=torch.float64) delta_t tensor(-0.0452, dtype=torch.float64)
14 gae_duplicate tensor(-0.1549, dtype=torch.float64) tensor(0.2423, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3328, dtype=torch.float64) delta_t tensor(0.2155, dtype=torch.float64)
13 gae_duplicate tensor(0.0719, dtype=torch.float64) tensor(-4.1216, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2663, dtype=torch.float64) delta_t tensor(-0.1396, dtype=torch.float64)
12 gae_duplicate tensor(-1.3213, dtype=torch.float64) tensor(2.1594, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2145, dtype=torch.float64) delta_t tensor(0.1200, dtype=torch.float64)
11 gae_duplicate tensor(-0.1969, dtype=torch.float64) tensor(-2.2897, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0841, dtype=torch.float64) delta_t tensor(-0.0433, dtype=torch.float64)
10 gae_duplicate tensor(-0.3273, dtype=torch.float64) tensor(0.6164, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3395, dtype=torch.float64) delta_t tensor(0.2326, dtype=torch.float64)
9 gae_duplicate tensor(-0.1455, dtype=torch.float64) tensor(-4.8133, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0457, dtype=torch.float64) delta_t tensor(-0.0780, dtype=torch.float64)
8 gae_duplicate tensor(-0.3281, dtype=torch.float64) tensor(1.5700, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6509, dtype=torch.float64) delta_t tensor(-0.5496, dtype=torch.float64)
7 gae_duplicate tensor(-3.2541, dtype=torch.float64) tensor(9.4442, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2375, dtype=torch.float64) delta_t tensor(-0.0091, dtype=torch.float64)
6 gae_duplicate tensor(-0.3965, dtype=torch.float64) tensor(1.3083, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7219, dtype=torch.float64) delta_t tensor(0.1086, dtype=torch.float64)
5 gae_duplicate tensor(-0.1069, dtype=torch.float64) tensor(-1.9292, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5601, dtype=torch.float64) delta_t tensor(-0.1063, dtype=torch.float64)
4 gae_duplicate tensor(-0.3279, dtype=torch.float64) tensor(1.9200, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5456, dtype=torch.float64) delta_t tensor(-0.0105, dtype=torch.float64)
3 gae_duplicate tensor(-0.2525, dtype=torch.float64) tensor(0.5536, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0690, dtype=torch.float64) delta_t tensor(-0.1821, dtype=torch.float64)
2 gae_duplicate tensor(-0.5814, dtype=torch.float64) tensor(3.6595, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-22.130773544311523
value loss:29.24575424194336
entropies:347.7066345214844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.989674091339111 seconds
19 rew tensor(0.9928, dtype=torch.float64) delta_t tensor(0.1046, dtype=torch.float64)
19 gae_duplicate tensor(0.0141, dtype=torch.float64) tensor(-1.9339, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9298, dtype=torch.float64) delta_t tensor(0.1412, dtype=torch.float64)
18 gae_duplicate tensor(-0.0658, dtype=torch.float64) tensor(-2.8856, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8435, dtype=torch.float64) delta_t tensor(0.0113, dtype=torch.float64)
17 gae_duplicate tensor(-0.2046, dtype=torch.float64) tensor(-0.4781, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6626, dtype=torch.float64) delta_t tensor(0.0871, dtype=torch.float64)
16 gae_duplicate tensor(-0.1501, dtype=torch.float64) tensor(-1.6294, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7273, dtype=torch.float64) delta_t tensor(0.3076, dtype=torch.float64)
15 gae_duplicate tensor(0.0411, dtype=torch.float64) tensor(-6.1112, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3747, dtype=torch.float64) delta_t tensor(-0.1908, dtype=torch.float64)
14 gae_duplicate tensor(-0.8385, dtype=torch.float64) tensor(2.6956, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0744, dtype=torch.float64) delta_t tensor(-0.0770, dtype=torch.float64)
13 gae_duplicate tensor(-0.4161, dtype=torch.float64) tensor(1.6627, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2552, dtype=torch.float64) delta_t tensor(-0.3103, dtype=torch.float64)
12 gae_duplicate tensor(-2.2168, dtype=torch.float64) tensor(6.4126, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0521, dtype=torch.float64) delta_t tensor(-0.0115, dtype=torch.float64)
11 gae_duplicate tensor(-0.3204, dtype=torch.float64) tensor(0.7144, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1948, dtype=torch.float64) delta_t tensor(0.0937, dtype=torch.float64)
10 gae_duplicate tensor(-0.3062, dtype=torch.float64) tensor(-2.2757, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6697, dtype=torch.float64) delta_t tensor(0.3799, dtype=torch.float64)
9 gae_duplicate tensor(0.1549, dtype=torch.float64) tensor(-8.8969, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5232, dtype=torch.float64) delta_t tensor(-0.1304, dtype=torch.float64)
8 gae_duplicate tensor(-0.2950, dtype=torch.float64) tensor(2.0347, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.7132, dtype=torch.float64) delta_t tensor(-0.6214, dtype=torch.float64)
7 gae_duplicate tensor(-4.1635, dtype=torch.float64) tensor(12.3055, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2151, dtype=torch.float64) delta_t tensor(-0.5210, dtype=torch.float64)
6 gae_duplicate tensor(-3.2688, dtype=torch.float64) tensor(11.4077, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4006, dtype=torch.float64) delta_t tensor(0.1220, dtype=torch.float64)
5 gae_duplicate tensor(-0.2628, dtype=torch.float64) tensor(-1.1329, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9092, dtype=torch.float64) delta_t tensor(-0.1731, dtype=torch.float64)
4 gae_duplicate tensor(-0.2628, dtype=torch.float64) tensor(3.3433, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1150, dtype=torch.float64) delta_t tensor(-0.0125, dtype=torch.float64)
3 gae_duplicate tensor(-0.4962, dtype=torch.float64) tensor(1.0519, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3272, dtype=torch.float64) delta_t tensor(0.0719, dtype=torch.float64)
2 gae_duplicate tensor(-0.1444, dtype=torch.float64) tensor(-1.4016, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-897.58935546875
value loss:59.612754821777344
entropies:347.79644775390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.247995138168335 seconds
19 rew tensor(1.0029, dtype=torch.float64) delta_t tensor(0.1165, dtype=torch.float64)
19 gae_duplicate tensor(0.0295, dtype=torch.float64) tensor(-2.1049, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9507, dtype=torch.float64) delta_t tensor(0.1275, dtype=torch.float64)
18 gae_duplicate tensor(0.0032, dtype=torch.float64) tensor(-2.7163, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9726, dtype=torch.float64) delta_t tensor(0.1507, dtype=torch.float64)
17 gae_duplicate tensor(-0.0249, dtype=torch.float64) tensor(-3.2241, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7602, dtype=torch.float64) delta_t tensor(0.1995, dtype=torch.float64)
16 gae_duplicate tensor(-0.2197, dtype=torch.float64) tensor(-3.8691, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6946, dtype=torch.float64) delta_t tensor(0.0501, dtype=torch.float64)
15 gae_duplicate tensor(-0.1550, dtype=torch.float64) tensor(-1.3031, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2765, dtype=torch.float64) delta_t tensor(-0.0324, dtype=torch.float64)
14 gae_duplicate tensor(-0.2981, dtype=torch.float64) tensor(0.7442, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5350, dtype=torch.float64) delta_t tensor(0.1479, dtype=torch.float64)
13 gae_duplicate tensor(-0.1218, dtype=torch.float64) tensor(-2.5546, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3672, dtype=torch.float64) delta_t tensor(-0.5933, dtype=torch.float64)
12 gae_duplicate tensor(-3.6780, dtype=torch.float64) tensor(13.6425, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0439, dtype=torch.float64) delta_t tensor(-0.0435, dtype=torch.float64)
11 gae_duplicate tensor(-1.7891, dtype=torch.float64) tensor(1.4203, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1276, dtype=torch.float64) delta_t tensor(-0.1655, dtype=torch.float64)
10 gae_duplicate tensor(-0.6961, dtype=torch.float64) tensor(3.3030, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4180, dtype=torch.float64) delta_t tensor(0.2741, dtype=torch.float64)
9 gae_duplicate tensor(0.0484, dtype=torch.float64) tensor(-4.9110, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.4125, dtype=torch.float64) delta_t tensor(0.0335, dtype=torch.float64)
8 gae_duplicate tensor(-0.1759, dtype=torch.float64) tensor(-1.3062, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6802, dtype=torch.float64) delta_t tensor(0.0010, dtype=torch.float64)
7 gae_duplicate tensor(-0.5767, dtype=torch.float64) tensor(-0.3257, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0185, dtype=torch.float64) delta_t tensor(-0.0219, dtype=torch.float64)
6 gae_duplicate tensor(-0.1281, dtype=torch.float64) tensor(0.3788, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1384, dtype=torch.float64) delta_t tensor(0.1560, dtype=torch.float64)
5 gae_duplicate tensor(-0.4823, dtype=torch.float64) tensor(-2.9371, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.7923, dtype=torch.float64) delta_t tensor(-0.0881, dtype=torch.float64)
4 gae_duplicate tensor(-0.1982, dtype=torch.float64) tensor(1.4068, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0207, dtype=torch.float64) delta_t tensor(-0.0160, dtype=torch.float64)
3 gae_duplicate tensor(-0.1901, dtype=torch.float64) tensor(0.5390, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3669, dtype=torch.float64) delta_t tensor(0.0144, dtype=torch.float64)
2 gae_duplicate tensor(-0.3993, dtype=torch.float64) tensor(-0.3837, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:132.9068145751953
value loss:35.113868713378906
entropies:348.00982666015625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3903.3823)
ToM Target loss= tensor(3814.2759)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.542330980300903 seconds
19 rew tensor(1.0357, dtype=torch.float64) delta_t tensor(0.1270, dtype=torch.float64)
19 gae_duplicate tensor(0.0241, dtype=torch.float64) tensor(-2.5099, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0157, dtype=torch.float64) delta_t tensor(0.3180, dtype=torch.float64)
18 gae_duplicate tensor(0.1438, dtype=torch.float64) tensor(-6.2535, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7796, dtype=torch.float64) delta_t tensor(0.2283, dtype=torch.float64)
17 gae_duplicate tensor(0.0960, dtype=torch.float64) tensor(-4.8539, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7722, dtype=torch.float64) delta_t tensor(0.1242, dtype=torch.float64)
16 gae_duplicate tensor(0.0098, dtype=torch.float64) tensor(-2.7573, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3392, dtype=torch.float64) delta_t tensor(0.0018, dtype=torch.float64)
15 gae_duplicate tensor(-0.1343, dtype=torch.float64) tensor(-0.2572, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5915, dtype=torch.float64) delta_t tensor(0.0221, dtype=torch.float64)
14 gae_duplicate tensor(-0.0985, dtype=torch.float64) tensor(-0.3941, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0609, dtype=torch.float64) delta_t tensor(0.0978, dtype=torch.float64)
13 gae_duplicate tensor(-0.0976, dtype=torch.float64) tensor(-1.9721, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3899, dtype=torch.float64) delta_t tensor(-0.1683, dtype=torch.float64)
12 gae_duplicate tensor(-1.4734, dtype=torch.float64) tensor(2.8173, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1292, dtype=torch.float64) delta_t tensor(0.1445, dtype=torch.float64)
11 gae_duplicate tensor(-0.1649, dtype=torch.float64) tensor(-2.2652, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2716, dtype=torch.float64) delta_t tensor(-0.0875, dtype=torch.float64)
10 gae_duplicate tensor(-0.3728, dtype=torch.float64) tensor(1.3074, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.8630, dtype=torch.float64) delta_t tensor(0.1582, dtype=torch.float64)
9 gae_duplicate tensor(-0.2104, dtype=torch.float64) tensor(-2.8638, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6295, dtype=torch.float64) delta_t tensor(0.0249, dtype=torch.float64)
8 gae_duplicate tensor(-0.1925, dtype=torch.float64) tensor(-0.6934, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.8545, dtype=torch.float64) delta_t tensor(0.0454, dtype=torch.float64)
7 gae_duplicate tensor(-0.2107, dtype=torch.float64) tensor(-0.8689, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.5697, dtype=torch.float64) delta_t tensor(0.1714, dtype=torch.float64)
6 gae_duplicate tensor(-0.0271, dtype=torch.float64) tensor(-3.4261, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2257, dtype=torch.float64) delta_t tensor(-0.0752, dtype=torch.float64)
5 gae_duplicate tensor(-0.1998, dtype=torch.float64) tensor(1.2041, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.9082, dtype=torch.float64) delta_t tensor(-0.0099, dtype=torch.float64)
4 gae_duplicate tensor(-0.1773, dtype=torch.float64) tensor(0.3081, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7856, dtype=torch.float64) delta_t tensor(0.1259, dtype=torch.float64)
3 gae_duplicate tensor(-0.0331, dtype=torch.float64) tensor(-2.3581, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2749, dtype=torch.float64) delta_t tensor(0.0065, dtype=torch.float64)
2 gae_duplicate tensor(-0.1139, dtype=torch.float64) tensor(-0.4953, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1327.9439697265625
value loss:11.242721557617188
entropies:348.04931640625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9106340408325195 seconds
19 rew tensor(0.9502, dtype=torch.float64) delta_t tensor(0.0621, dtype=torch.float64)
19 gae_duplicate tensor(0.0123, dtype=torch.float64) tensor(-1.1527, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.7800, dtype=torch.float64) delta_t tensor(-0.0186, dtype=torch.float64)
18 gae_duplicate tensor(-0.2020, dtype=torch.float64) tensor(0.3915, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6741, dtype=torch.float64) delta_t tensor(0.0709, dtype=torch.float64)
17 gae_duplicate tensor(-0.0330, dtype=torch.float64) tensor(-1.2711, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5871, dtype=torch.float64) delta_t tensor(0.0879, dtype=torch.float64)
16 gae_duplicate tensor(-0.1262, dtype=torch.float64) tensor(-1.8528, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5425, dtype=torch.float64) delta_t tensor(0.0869, dtype=torch.float64)
15 gae_duplicate tensor(0.0022, dtype=torch.float64) tensor(-1.8160, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2926, dtype=torch.float64) delta_t tensor(0.0234, dtype=torch.float64)
14 gae_duplicate tensor(-0.0488, dtype=torch.float64) tensor(-0.6177, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3694, dtype=torch.float64) delta_t tensor(0.1534, dtype=torch.float64)
13 gae_duplicate tensor(0.1239, dtype=torch.float64) tensor(-3.0469, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3035, dtype=torch.float64) delta_t tensor(-0.0962, dtype=torch.float64)
12 gae_duplicate tensor(-0.2288, dtype=torch.float64) tensor(1.4800, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1571, dtype=torch.float64) delta_t tensor(0.2072, dtype=torch.float64)
11 gae_duplicate tensor(-0.1116, dtype=torch.float64) tensor(-4.0368, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1571, dtype=torch.float64) delta_t tensor(-0.0268, dtype=torch.float64)
10 gae_duplicate tensor(-0.2149, dtype=torch.float64) tensor(0.1932, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.5754, dtype=torch.float64) delta_t tensor(0.1152, dtype=torch.float64)
9 gae_duplicate tensor(-0.0922, dtype=torch.float64) tensor(-2.1244, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.5523, dtype=torch.float64) delta_t tensor(0.2279, dtype=torch.float64)
8 gae_duplicate tensor(0.1015, dtype=torch.float64) tensor(-4.4535, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2684, dtype=torch.float64) delta_t tensor(-0.0132, dtype=torch.float64)
7 gae_duplicate tensor(-0.1118, dtype=torch.float64) tensor(-0.2051, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.1018, dtype=torch.float64) delta_t tensor(0.0792, dtype=torch.float64)
6 gae_duplicate tensor(-0.1410, dtype=torch.float64) tensor(-1.4497, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8873, dtype=torch.float64) delta_t tensor(0.0186, dtype=torch.float64)
5 gae_duplicate tensor(-0.0941, dtype=torch.float64) tensor(-0.4562, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.6370, dtype=torch.float64) delta_t tensor(0.1128, dtype=torch.float64)
4 gae_duplicate tensor(-0.1440, dtype=torch.float64) tensor(-2.1047, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5146, dtype=torch.float64) delta_t tensor(0.0397, dtype=torch.float64)
3 gae_duplicate tensor(-0.0856, dtype=torch.float64) tensor(-0.9363, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1001, dtype=torch.float64) delta_t tensor(-0.0752, dtype=torch.float64)
2 gae_duplicate tensor(-0.3645, dtype=torch.float64) tensor(1.3092, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1102.154296875
value loss:5.189157485961914
entropies:347.9626159667969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.104522943496704 seconds
19 rew tensor(0.9637, dtype=torch.float64) delta_t tensor(0.1577, dtype=torch.float64)
19 gae_duplicate tensor(0.0713, dtype=torch.float64) tensor(-2.8602, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9422, dtype=torch.float64) delta_t tensor(0.1283, dtype=torch.float64)
18 gae_duplicate tensor(0.0294, dtype=torch.float64) tensor(-2.7250, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.4466, dtype=torch.float64) delta_t tensor(-0.2002, dtype=torch.float64)
17 gae_duplicate tensor(-1.4829, dtype=torch.float64) tensor(3.6052, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7180, dtype=torch.float64) delta_t tensor(0.0919, dtype=torch.float64)
16 gae_duplicate tensor(-0.1994, dtype=torch.float64) tensor(-1.3026, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.2900, dtype=torch.float64) delta_t tensor(0.0511, dtype=torch.float64)
15 gae_duplicate tensor(-0.1573, dtype=torch.float64) tensor(-1.0775, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6314, dtype=torch.float64) delta_t tensor(0.0915, dtype=torch.float64)
14 gae_duplicate tensor(-0.0925, dtype=torch.float64) tensor(-1.9214, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.5370, dtype=torch.float64) delta_t tensor(-0.3494, dtype=torch.float64)
13 gae_duplicate tensor(-2.4195, dtype=torch.float64) tensor(6.6974, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6207, dtype=torch.float64) delta_t tensor(0.0365, dtype=torch.float64)
12 gae_duplicate tensor(-0.2887, dtype=torch.float64) tensor(-0.2842, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2665, dtype=torch.float64) delta_t tensor(0.0683, dtype=torch.float64)
11 gae_duplicate tensor(-0.1709, dtype=torch.float64) tensor(-1.1840, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5123, dtype=torch.float64) delta_t tensor(0.0966, dtype=torch.float64)
10 gae_duplicate tensor(-0.3703, dtype=torch.float64) tensor(-1.7770, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7185, dtype=torch.float64) delta_t tensor(0.1804, dtype=torch.float64)
9 gae_duplicate tensor(0.0387, dtype=torch.float64) tensor(-3.6079, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6665, dtype=torch.float64) delta_t tensor(0.0875, dtype=torch.float64)
8 gae_duplicate tensor(-0.3449, dtype=torch.float64) tensor(-2.0970, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3943, dtype=torch.float64) delta_t tensor(0.0862, dtype=torch.float64)
7 gae_duplicate tensor(-0.0479, dtype=torch.float64) tensor(-1.7973, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4686, dtype=torch.float64) delta_t tensor(0.1335, dtype=torch.float64)
6 gae_duplicate tensor(-0.0083, dtype=torch.float64) tensor(-2.6819, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0428, dtype=torch.float64) delta_t tensor(-0.0918, dtype=torch.float64)
5 gae_duplicate tensor(-0.2767, dtype=torch.float64) tensor(1.5264, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.8026, dtype=torch.float64) delta_t tensor(0.0864, dtype=torch.float64)
4 gae_duplicate tensor(-0.1718, dtype=torch.float64) tensor(-2.1025, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5736, dtype=torch.float64) delta_t tensor(-0.0317, dtype=torch.float64)
3 gae_duplicate tensor(-0.4589, dtype=torch.float64) tensor(0.1549, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1192, dtype=torch.float64) delta_t tensor(0.0093, dtype=torch.float64)
2 gae_duplicate tensor(-0.3894, dtype=torch.float64) tensor(0.1568, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:623.094482421875
value loss:19.48587417602539
entropies:347.8591003417969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8706629276275635 seconds
19 rew tensor(1.0180, dtype=torch.float64) delta_t tensor(0.0363, dtype=torch.float64)
19 gae_duplicate tensor(-0.0069, dtype=torch.float64) tensor(-0.7042, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9864, dtype=torch.float64) delta_t tensor(0.1414, dtype=torch.float64)
18 gae_duplicate tensor(0.0407, dtype=torch.float64) tensor(-2.5626, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8057, dtype=torch.float64) delta_t tensor(0.0643, dtype=torch.float64)
17 gae_duplicate tensor(-0.0357, dtype=torch.float64) tensor(-1.5380, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8264, dtype=torch.float64) delta_t tensor(0.1414, dtype=torch.float64)
16 gae_duplicate tensor(-0.1630, dtype=torch.float64) tensor(-3.2460, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4518, dtype=torch.float64) delta_t tensor(0.0490, dtype=torch.float64)
15 gae_duplicate tensor(-0.1432, dtype=torch.float64) tensor(-1.1515, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4093, dtype=torch.float64) delta_t tensor(-0.0004, dtype=torch.float64)
14 gae_duplicate tensor(-0.1364, dtype=torch.float64) tensor(-0.1263, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0089, dtype=torch.float64) delta_t tensor(0.1138, dtype=torch.float64)
13 gae_duplicate tensor(-0.1143, dtype=torch.float64) tensor(-2.0780, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6671, dtype=torch.float64) delta_t tensor(0.1030, dtype=torch.float64)
12 gae_duplicate tensor(-0.3503, dtype=torch.float64) tensor(-2.5501, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1531, dtype=torch.float64) delta_t tensor(0.0308, dtype=torch.float64)
11 gae_duplicate tensor(-0.2177, dtype=torch.float64) tensor(-0.7729, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3036, dtype=torch.float64) delta_t tensor(-0.0566, dtype=torch.float64)
10 gae_duplicate tensor(-0.3698, dtype=torch.float64) tensor(1.0307, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7740, dtype=torch.float64) delta_t tensor(0.1941, dtype=torch.float64)
9 gae_duplicate tensor(-0.0782, dtype=torch.float64) tensor(-3.7454, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.6775, dtype=torch.float64) delta_t tensor(0.0115, dtype=torch.float64)
8 gae_duplicate tensor(-0.1386, dtype=torch.float64) tensor(-0.6575, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7253, dtype=torch.float64) delta_t tensor(0.0579, dtype=torch.float64)
7 gae_duplicate tensor(-0.2231, dtype=torch.float64) tensor(-1.4818, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.4793, dtype=torch.float64) delta_t tensor(0.0711, dtype=torch.float64)
6 gae_duplicate tensor(-0.1604, dtype=torch.float64) tensor(-1.2572, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1803, dtype=torch.float64) delta_t tensor(0.0468, dtype=torch.float64)
5 gae_duplicate tensor(-0.1566, dtype=torch.float64) tensor(-0.9731, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.8898, dtype=torch.float64) delta_t tensor(-0.0507, dtype=torch.float64)
4 gae_duplicate tensor(-0.2228, dtype=torch.float64) tensor(0.4400, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7322, dtype=torch.float64) delta_t tensor(0.0471, dtype=torch.float64)
3 gae_duplicate tensor(-0.3009, dtype=torch.float64) tensor(-0.5298, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2241, dtype=torch.float64) delta_t tensor(0.0039, dtype=torch.float64)
2 gae_duplicate tensor(-0.2120, dtype=torch.float64) tensor(-0.3630, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1108.5101318359375
value loss:6.052523136138916
entropies:347.7770690917969
Policy training finished
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt