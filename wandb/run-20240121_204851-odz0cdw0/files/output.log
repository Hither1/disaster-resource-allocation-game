obs <crafter.objects.Shelter object at 0x14685c7c0> [39.  0.  0.  0. 39.  0.  0.  0. 17.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x124789760> [37.  0.  0.  0. 42.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x146862580> [ 9.  0.  0.  0.  9.  0.  0.  0. 11.  0.  0.  0.]
obs <crafter.objects.Shelter object at 0x14685c7c0> [39.  0.  0.  0. 39.  0.  0.  0. 19.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x124789760> [41.  0.  0.  0. 40.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x146862580> [ 9.  0.  0.  0.  9.  0.  0.  0. 13.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0032241344451904297 seconds
19 rew tensor(1.1449, dtype=torch.float64) delta_t tensor(1.0708, dtype=torch.float64)
19 gae_duplicate tensor(0.9730, dtype=torch.float64) tensor(-21.2575, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2500, dtype=torch.float64) delta_t tensor(1.2001, dtype=torch.float64)
18 gae_duplicate tensor(1.1689, dtype=torch.float64) tensor(-25.9475, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.2194, dtype=torch.float64) delta_t tensor(1.1281, dtype=torch.float64)
17 gae_duplicate tensor(1.0727, dtype=torch.float64) tensor(-24.6257, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.2307, dtype=torch.float64) delta_t tensor(1.0963, dtype=torch.float64)
16 gae_duplicate tensor(1.1188, dtype=torch.float64) tensor(-23.2066, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.3161, dtype=torch.float64) delta_t tensor(1.2011, dtype=torch.float64)
15 gae_duplicate tensor(1.0481, dtype=torch.float64) tensor(-25.6739, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8716, dtype=torch.float64) delta_t tensor(0.7121, dtype=torch.float64)
14 gae_duplicate tensor(-0.9215, dtype=torch.float64) tensor(-16.9829, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.3048, dtype=torch.float64) delta_t tensor(1.1976, dtype=torch.float64)
13 gae_duplicate tensor(0.8973, dtype=torch.float64) tensor(-24.8236, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9050, dtype=torch.float64) delta_t tensor(0.6927, dtype=torch.float64)
12 gae_duplicate tensor(0.4656, dtype=torch.float64) tensor(-15.9827, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7894, dtype=torch.float64) delta_t tensor(0.6792, dtype=torch.float64)
11 gae_duplicate tensor(-1.5599, dtype=torch.float64) tensor(-14.9386, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1452, dtype=torch.float64) delta_t tensor(0.0112, dtype=torch.float64)
10 gae_duplicate tensor(-2.4834, dtype=torch.float64) tensor(-1.6821, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(1.3700, dtype=torch.float64) delta_t tensor(1.3358, dtype=torch.float64)
9 gae_duplicate tensor(0.8983, dtype=torch.float64) tensor(-26.3576, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1779, dtype=torch.float64) delta_t tensor(0.0154, dtype=torch.float64)
8 gae_duplicate tensor(-0.8217, dtype=torch.float64) tensor(-2.9947, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1563, dtype=torch.float64) delta_t tensor(0.1628, dtype=torch.float64)
7 gae_duplicate tensor(-1.7196, dtype=torch.float64) tensor(-4.1618, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.1177, dtype=torch.float64) delta_t tensor(-0.1046, dtype=torch.float64)
6 gae_duplicate tensor(-0.5923, dtype=torch.float64) tensor(1.6251, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7237, dtype=torch.float64) delta_t tensor(-0.6997, dtype=torch.float64)
5 gae_duplicate tensor(-0.9937, dtype=torch.float64) tensor(14.0322, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.6774, dtype=torch.float64) delta_t tensor(0.6940, dtype=torch.float64)
4 gae_duplicate tensor(0.0319, dtype=torch.float64) tensor(-12.2204, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1022, dtype=torch.float64) delta_t tensor(-0.1759, dtype=torch.float64)
3 gae_duplicate tensor(-0.7729, dtype=torch.float64) tensor(2.1660, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.0997, dtype=torch.float64) delta_t tensor(1.1076, dtype=torch.float64)
2 gae_duplicate tensor(1.0556, dtype=torch.float64) tensor(-21.6169, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:13115.35546875
value loss:188.06430053710938
entropies:354.4420471191406
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 5.122229099273682 seconds
19 rew tensor(1.1802, dtype=torch.float64) delta_t tensor(0.9668, dtype=torch.float64)
19 gae_duplicate tensor(0.8218, dtype=torch.float64) tensor(-18.3682, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2227, dtype=torch.float64) delta_t tensor(1.0679, dtype=torch.float64)
18 gae_duplicate tensor(0.9892, dtype=torch.float64) tensor(-23.6072, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0757, dtype=torch.float64) delta_t tensor(0.8832, dtype=torch.float64)
17 gae_duplicate tensor(0.7349, dtype=torch.float64) tensor(-18.9109, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8261, dtype=torch.float64) delta_t tensor(0.5339, dtype=torch.float64)
16 gae_duplicate tensor(-0.5411, dtype=torch.float64) tensor(-12.2371, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9310, dtype=torch.float64) delta_t tensor(0.6948, dtype=torch.float64)
15 gae_duplicate tensor(0.5882, dtype=torch.float64) tensor(-14.6418, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8506, dtype=torch.float64) delta_t tensor(0.6634, dtype=torch.float64)
14 gae_duplicate tensor(0.4852, dtype=torch.float64) tensor(-14.0334, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7601, dtype=torch.float64) delta_t tensor(0.5851, dtype=torch.float64)
13 gae_duplicate tensor(0.3183, dtype=torch.float64) tensor(-13.0027, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5873, dtype=torch.float64) delta_t tensor(0.3828, dtype=torch.float64)
12 gae_duplicate tensor(0.0039, dtype=torch.float64) tensor(-8.9650, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5209, dtype=torch.float64) delta_t tensor(0.3484, dtype=torch.float64)
11 gae_duplicate tensor(-0.1101, dtype=torch.float64) tensor(-7.3945, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1833, dtype=torch.float64) delta_t tensor(-0.0282, dtype=torch.float64)
10 gae_duplicate tensor(-0.4042, dtype=torch.float64) tensor(-0.2293, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5316, dtype=torch.float64) delta_t tensor(0.4529, dtype=torch.float64)
9 gae_duplicate tensor(-0.0520, dtype=torch.float64) tensor(-9.6597, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2834, dtype=torch.float64) delta_t tensor(-0.4942, dtype=torch.float64)
8 gae_duplicate tensor(-1.1229, dtype=torch.float64) tensor(9.1159, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6743, dtype=torch.float64) delta_t tensor(-0.7545, dtype=torch.float64)
7 gae_duplicate tensor(-1.9896, dtype=torch.float64) tensor(15.4627, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4900, dtype=torch.float64) delta_t tensor(-0.5169, dtype=torch.float64)
6 gae_duplicate tensor(-1.0406, dtype=torch.float64) tensor(11.8623, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1443, dtype=torch.float64) delta_t tensor(-1.1294, dtype=torch.float64)
5 gae_duplicate tensor(-1.9052, dtype=torch.float64) tensor(22.8145, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1715, dtype=torch.float64) delta_t tensor(0.1098, dtype=torch.float64)
4 gae_duplicate tensor(-0.7122, dtype=torch.float64) tensor(0.1795, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8381, dtype=torch.float64) delta_t tensor(-0.9586, dtype=torch.float64)
3 gae_duplicate tensor(-2.0981, dtype=torch.float64) tensor(18.9145, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4832, dtype=torch.float64) delta_t tensor(0.4509, dtype=torch.float64)
2 gae_duplicate tensor(-0.2508, dtype=torch.float64) tensor(-7.2354, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3681.072265625
value loss:118.09026336669922
entropies:353.5705871582031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.824568033218384 seconds
19 rew tensor(1.1293, dtype=torch.float64) delta_t tensor(0.7756, dtype=torch.float64)
19 gae_duplicate tensor(0.6796, dtype=torch.float64) tensor(-15.1264, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1300, dtype=torch.float64) delta_t tensor(0.8366, dtype=torch.float64)
18 gae_duplicate tensor(0.6647, dtype=torch.float64) tensor(-18.4477, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1021, dtype=torch.float64) delta_t tensor(0.8268, dtype=torch.float64)
17 gae_duplicate tensor(0.8399, dtype=torch.float64) tensor(-17.2137, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9797, dtype=torch.float64) delta_t tensor(0.6220, dtype=torch.float64)
16 gae_duplicate tensor(0.5360, dtype=torch.float64) tensor(-13.9811, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9827, dtype=torch.float64) delta_t tensor(0.6531, dtype=torch.float64)
15 gae_duplicate tensor(0.6073, dtype=torch.float64) tensor(-13.7072, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6923, dtype=torch.float64) delta_t tensor(0.3896, dtype=torch.float64)
14 gae_duplicate tensor(0.3011, dtype=torch.float64) tensor(-8.9218, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7482, dtype=torch.float64) delta_t tensor(0.4829, dtype=torch.float64)
13 gae_duplicate tensor(0.0889, dtype=torch.float64) tensor(-10.3381, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3974, dtype=torch.float64) delta_t tensor(0.0379, dtype=torch.float64)
12 gae_duplicate tensor(-0.1759, dtype=torch.float64) tensor(-1.5251, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0175, dtype=torch.float64) delta_t tensor(-0.2889, dtype=torch.float64)
11 gae_duplicate tensor(-3.3843, dtype=torch.float64) tensor(5.4013, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0837, dtype=torch.float64) delta_t tensor(-0.1873, dtype=torch.float64)
10 gae_duplicate tensor(-0.4790, dtype=torch.float64) tensor(4.1151, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5929, dtype=torch.float64) delta_t tensor(0.3744, dtype=torch.float64)
9 gae_duplicate tensor(0.1902, dtype=torch.float64) tensor(-7.0684, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5392, dtype=torch.float64) delta_t tensor(-0.8289, dtype=torch.float64)
8 gae_duplicate tensor(-1.3501, dtype=torch.float64) tensor(16.1087, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0232, dtype=torch.float64) delta_t tensor(-0.2447, dtype=torch.float64)
7 gae_duplicate tensor(-1.2131, dtype=torch.float64) tensor(5.8015, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6003, dtype=torch.float64) delta_t tensor(-0.7590, dtype=torch.float64)
6 gae_duplicate tensor(-1.1364, dtype=torch.float64) tensor(14.7354, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1059, dtype=torch.float64) delta_t tensor(-1.1006, dtype=torch.float64)
5 gae_duplicate tensor(-1.8567, dtype=torch.float64) tensor(22.3400, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2220, dtype=torch.float64) delta_t tensor(-0.3615, dtype=torch.float64)
4 gae_duplicate tensor(-0.9365, dtype=torch.float64) tensor(9.8623, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4588, dtype=torch.float64) delta_t tensor(-0.6201, dtype=torch.float64)
3 gae_duplicate tensor(-1.3349, dtype=torch.float64) tensor(14.6518, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1289, dtype=torch.float64) delta_t tensor(0.1293, dtype=torch.float64)
2 gae_duplicate tensor(-0.3213, dtype=torch.float64) tensor(-1.3351, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:695.8488159179688
value loss:97.59892272949219
entropies:352.47467041015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.713212251663208 seconds
19 rew tensor(1.1560, dtype=torch.float64) delta_t tensor(0.6279, dtype=torch.float64)
19 gae_duplicate tensor(0.2308, dtype=torch.float64) tensor(-12.5627, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1587, dtype=torch.float64) delta_t tensor(0.7258, dtype=torch.float64)
18 gae_duplicate tensor(0.7069, dtype=torch.float64) tensor(-14.7974, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0850, dtype=torch.float64) delta_t tensor(0.6053, dtype=torch.float64)
17 gae_duplicate tensor(0.5314, dtype=torch.float64) tensor(-13.1470, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9975, dtype=torch.float64) delta_t tensor(0.4177, dtype=torch.float64)
16 gae_duplicate tensor(0.1743, dtype=torch.float64) tensor(-9.0781, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9215, dtype=torch.float64) delta_t tensor(0.4925, dtype=torch.float64)
15 gae_duplicate tensor(0.4593, dtype=torch.float64) tensor(-11.0574, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6867, dtype=torch.float64) delta_t tensor(0.3519, dtype=torch.float64)
14 gae_duplicate tensor(0.2937, dtype=torch.float64) tensor(-8.0174, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7188, dtype=torch.float64) delta_t tensor(0.3974, dtype=torch.float64)
13 gae_duplicate tensor(-0.0417, dtype=torch.float64) tensor(-8.6208, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2879, dtype=torch.float64) delta_t tensor(-0.0751, dtype=torch.float64)
12 gae_duplicate tensor(-0.2572, dtype=torch.float64) tensor(0.6732, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5757, dtype=torch.float64) delta_t tensor(0.2220, dtype=torch.float64)
11 gae_duplicate tensor(-0.4275, dtype=torch.float64) tensor(-3.8994, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0621, dtype=torch.float64) delta_t tensor(-0.2537, dtype=torch.float64)
10 gae_duplicate tensor(-0.6330, dtype=torch.float64) tensor(4.6618, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2518, dtype=torch.float64) delta_t tensor(0.0086, dtype=torch.float64)
9 gae_duplicate tensor(-0.5645, dtype=torch.float64) tensor(0.9044, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2436, dtype=torch.float64) delta_t tensor(-0.6023, dtype=torch.float64)
8 gae_duplicate tensor(-1.0556, dtype=torch.float64) tensor(12.6471, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6382, dtype=torch.float64) delta_t tensor(-0.8059, dtype=torch.float64)
7 gae_duplicate tensor(-1.6890, dtype=torch.float64) tensor(15.8957, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6203, dtype=torch.float64) delta_t tensor(-0.6627, dtype=torch.float64)
6 gae_duplicate tensor(-1.1066, dtype=torch.float64) tensor(14.1649, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2962, dtype=torch.float64) delta_t tensor(-1.1617, dtype=torch.float64)
5 gae_duplicate tensor(-2.1666, dtype=torch.float64) tensor(25.2249, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0446, dtype=torch.float64) delta_t tensor(-0.1915, dtype=torch.float64)
4 gae_duplicate tensor(-0.8398, dtype=torch.float64) tensor(5.5822, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6664, dtype=torch.float64) delta_t tensor(-0.8442, dtype=torch.float64)
3 gae_duplicate tensor(-1.9174, dtype=torch.float64) tensor(14.4010, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1846, dtype=torch.float64) delta_t tensor(0.1152, dtype=torch.float64)
2 gae_duplicate tensor(-0.7098, dtype=torch.float64) tensor(-0.7618, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-754.239501953125
value loss:84.09295654296875
entropies:350.83123779296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.945690155029297 seconds
19 rew tensor(1.1342, dtype=torch.float64) delta_t tensor(0.4196, dtype=torch.float64)
19 gae_duplicate tensor(0.0785, dtype=torch.float64) tensor(-8.4064, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1610, dtype=torch.float64) delta_t tensor(0.5753, dtype=torch.float64)
18 gae_duplicate tensor(0.3789, dtype=torch.float64) tensor(-11.5933, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0928, dtype=torch.float64) delta_t tensor(0.5976, dtype=torch.float64)
17 gae_duplicate tensor(0.3988, dtype=torch.float64) tensor(-12.8822, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0032, dtype=torch.float64) delta_t tensor(0.4630, dtype=torch.float64)
16 gae_duplicate tensor(0.2776, dtype=torch.float64) tensor(-10.6250, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9874, dtype=torch.float64) delta_t tensor(0.4149, dtype=torch.float64)
15 gae_duplicate tensor(0.2086, dtype=torch.float64) tensor(-8.9004, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7712, dtype=torch.float64) delta_t tensor(0.2500, dtype=torch.float64)
14 gae_duplicate tensor(0.0058, dtype=torch.float64) tensor(-6.0457, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7372, dtype=torch.float64) delta_t tensor(0.2780, dtype=torch.float64)
13 gae_duplicate tensor(0.0176, dtype=torch.float64) tensor(-6.2439, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3664, dtype=torch.float64) delta_t tensor(-0.0796, dtype=torch.float64)
12 gae_duplicate tensor(-0.1999, dtype=torch.float64) tensor(0.9287, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5129, dtype=torch.float64) delta_t tensor(0.0470, dtype=torch.float64)
11 gae_duplicate tensor(-0.2030, dtype=torch.float64) tensor(-0.6124, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0072, dtype=torch.float64) delta_t tensor(-0.3160, dtype=torch.float64)
10 gae_duplicate tensor(-0.5360, dtype=torch.float64) tensor(5.7271, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3120, dtype=torch.float64) delta_t tensor(0.1065, dtype=torch.float64)
9 gae_duplicate tensor(-0.1953, dtype=torch.float64) tensor(-1.4848, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5306, dtype=torch.float64) delta_t tensor(-0.9762, dtype=torch.float64)
8 gae_duplicate tensor(-1.1990, dtype=torch.float64) tensor(17.8683, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3277, dtype=torch.float64) delta_t tensor(-1.4123, dtype=torch.float64)
7 gae_duplicate tensor(-3.9768, dtype=torch.float64) tensor(30.1596, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6791, dtype=torch.float64) delta_t tensor(-0.6447, dtype=torch.float64)
6 gae_duplicate tensor(-1.4788, dtype=torch.float64) tensor(15.7945, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5277, dtype=torch.float64) delta_t tensor(-1.3593, dtype=torch.float64)
5 gae_duplicate tensor(-1.7269, dtype=torch.float64) tensor(28.4118, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2457, dtype=torch.float64) delta_t tensor(0.1070, dtype=torch.float64)
4 gae_duplicate tensor(-0.6143, dtype=torch.float64) tensor(1.0295, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3531, dtype=torch.float64) delta_t tensor(-1.6767, dtype=torch.float64)
3 gae_duplicate tensor(-2.5363, dtype=torch.float64) tensor(32.6294, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6109, dtype=torch.float64) delta_t tensor(0.6068, dtype=torch.float64)
2 gae_duplicate tensor(-0.2368, dtype=torch.float64) tensor(-7.6816, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3230.44873046875
value loss:121.89305114746094
entropies:349.9880676269531
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3984.0688)
ToM Target loss= tensor(3808.8906)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.76036524772644 seconds
19 rew tensor(1.1800, dtype=torch.float64) delta_t tensor(0.2818, dtype=torch.float64)
19 gae_duplicate tensor(-0.0007, dtype=torch.float64) tensor(-5.4521, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1257, dtype=torch.float64) delta_t tensor(0.4213, dtype=torch.float64)
18 gae_duplicate tensor(0.1605, dtype=torch.float64) tensor(-9.9481, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1005, dtype=torch.float64) delta_t tensor(0.3833, dtype=torch.float64)
17 gae_duplicate tensor(0.1662, dtype=torch.float64) tensor(-9.3019, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7729, dtype=torch.float64) delta_t tensor(0.0576, dtype=torch.float64)
16 gae_duplicate tensor(-1.0868, dtype=torch.float64) tensor(-2.3853, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9319, dtype=torch.float64) delta_t tensor(0.3403, dtype=torch.float64)
15 gae_duplicate tensor(0.2757, dtype=torch.float64) tensor(-6.9784, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6981, dtype=torch.float64) delta_t tensor(0.1880, dtype=torch.float64)
14 gae_duplicate tensor(0.0411, dtype=torch.float64) tensor(-4.3001, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7069, dtype=torch.float64) delta_t tensor(0.2598, dtype=torch.float64)
13 gae_duplicate tensor(0.1110, dtype=torch.float64) tensor(-5.6739, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3399, dtype=torch.float64) delta_t tensor(-0.1314, dtype=torch.float64)
12 gae_duplicate tensor(-0.4034, dtype=torch.float64) tensor(2.0544, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4347, dtype=torch.float64) delta_t tensor(-0.0410, dtype=torch.float64)
11 gae_duplicate tensor(-0.3529, dtype=torch.float64) tensor(0.7202, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0828, dtype=torch.float64) delta_t tensor(-0.4644, dtype=torch.float64)
10 gae_duplicate tensor(-0.6719, dtype=torch.float64) tensor(9.1705, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3711, dtype=torch.float64) delta_t tensor(0.0914, dtype=torch.float64)
9 gae_duplicate tensor(-0.2127, dtype=torch.float64) tensor(-0.5511, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3837, dtype=torch.float64) delta_t tensor(-0.8177, dtype=torch.float64)
8 gae_duplicate tensor(-1.2350, dtype=torch.float64) tensor(15.2612, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6834, dtype=torch.float64) delta_t tensor(-0.8353, dtype=torch.float64)
7 gae_duplicate tensor(-1.5180, dtype=torch.float64) tensor(17.8929, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7259, dtype=torch.float64) delta_t tensor(-0.6499, dtype=torch.float64)
6 gae_duplicate tensor(-1.3264, dtype=torch.float64) tensor(14.7289, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3140, dtype=torch.float64) delta_t tensor(-1.0781, dtype=torch.float64)
5 gae_duplicate tensor(-1.5498, dtype=torch.float64) tensor(20.5680, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0169, dtype=torch.float64) delta_t tensor(-0.2239, dtype=torch.float64)
4 gae_duplicate tensor(-1.0544, dtype=torch.float64) tensor(6.7131, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8845, dtype=torch.float64) delta_t tensor(-1.1195, dtype=torch.float64)
3 gae_duplicate tensor(-2.4494, dtype=torch.float64) tensor(20.4503, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2655, dtype=torch.float64) delta_t tensor(0.2308, dtype=torch.float64)
2 gae_duplicate tensor(-0.6388, dtype=torch.float64) tensor(-1.9116, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3391.270263671875
value loss:78.88687896728516
entropies:348.8760986328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1116108894348145 seconds
19 rew tensor(1.1994, dtype=torch.float64) delta_t tensor(0.2031, dtype=torch.float64)
19 gae_duplicate tensor(-0.1751, dtype=torch.float64) tensor(-3.8177, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9287, dtype=torch.float64) delta_t tensor(0.1403, dtype=torch.float64)
18 gae_duplicate tensor(-1.0887, dtype=torch.float64) tensor(-3.7341, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8391, dtype=torch.float64) delta_t tensor(-0.0003, dtype=torch.float64)
17 gae_duplicate tensor(-1.1068, dtype=torch.float64) tensor(-0.1354, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0284, dtype=torch.float64) delta_t tensor(0.1791, dtype=torch.float64)
16 gae_duplicate tensor(-0.2884, dtype=torch.float64) tensor(-3.4713, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9333, dtype=torch.float64) delta_t tensor(0.2733, dtype=torch.float64)
15 gae_duplicate tensor(-0.3151, dtype=torch.float64) tensor(-5.5607, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2693, dtype=torch.float64) delta_t tensor(-0.3793, dtype=torch.float64)
14 gae_duplicate tensor(-1.4545, dtype=torch.float64) tensor(6.0002, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7407, dtype=torch.float64) delta_t tensor(0.2427, dtype=torch.float64)
13 gae_duplicate tensor(0.0359, dtype=torch.float64) tensor(-3.9659, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3721, dtype=torch.float64) delta_t tensor(-0.1382, dtype=torch.float64)
12 gae_duplicate tensor(-0.4853, dtype=torch.float64) tensor(2.6100, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5999, dtype=torch.float64) delta_t tensor(0.0809, dtype=torch.float64)
11 gae_duplicate tensor(-0.6515, dtype=torch.float64) tensor(-1.9152, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0977, dtype=torch.float64) delta_t tensor(-0.5948, dtype=torch.float64)
10 gae_duplicate tensor(-0.7934, dtype=torch.float64) tensor(10.8752, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4135, dtype=torch.float64) delta_t tensor(0.1720, dtype=torch.float64)
9 gae_duplicate tensor(-0.2923, dtype=torch.float64) tensor(-1.6486, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4872, dtype=torch.float64) delta_t tensor(-1.0061, dtype=torch.float64)
8 gae_duplicate tensor(-1.2205, dtype=torch.float64) tensor(18.8428, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3872, dtype=torch.float64) delta_t tensor(-1.4497, dtype=torch.float64)
7 gae_duplicate tensor(-3.6097, dtype=torch.float64) tensor(30.3509, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6265, dtype=torch.float64) delta_t tensor(-0.5472, dtype=torch.float64)
6 gae_duplicate tensor(-1.2231, dtype=torch.float64) tensor(12.9418, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5785, dtype=torch.float64) delta_t tensor(-1.1963, dtype=torch.float64)
5 gae_duplicate tensor(-1.9749, dtype=torch.float64) tensor(22.7177, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1810, dtype=torch.float64) delta_t tensor(0.0265, dtype=torch.float64)
4 gae_duplicate tensor(-0.4446, dtype=torch.float64) tensor(1.8305, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2984, dtype=torch.float64) delta_t tensor(-1.6033, dtype=torch.float64)
3 gae_duplicate tensor(-2.6291, dtype=torch.float64) tensor(29.2951, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5208, dtype=torch.float64) delta_t tensor(0.4646, dtype=torch.float64)
2 gae_duplicate tensor(-0.0236, dtype=torch.float64) tensor(-6.0285, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5774.11083984375
value loss:113.93092346191406
entropies:348.2294921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.960545063018799 seconds
19 rew tensor(1.1185, dtype=torch.float64) delta_t tensor(0.0808, dtype=torch.float64)
19 gae_duplicate tensor(-0.2651, dtype=torch.float64) tensor(-1.9496, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1123, dtype=torch.float64) delta_t tensor(0.1798, dtype=torch.float64)
18 gae_duplicate tensor(-0.1105, dtype=torch.float64) tensor(-3.5649, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0926, dtype=torch.float64) delta_t tensor(0.2443, dtype=torch.float64)
17 gae_duplicate tensor(-0.0635, dtype=torch.float64) tensor(-4.9469, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7713, dtype=torch.float64) delta_t tensor(-0.1876, dtype=torch.float64)
16 gae_duplicate tensor(-1.1218, dtype=torch.float64) tensor(2.8534, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8974, dtype=torch.float64) delta_t tensor(0.2304, dtype=torch.float64)
15 gae_duplicate tensor(0.0694, dtype=torch.float64) tensor(-4.2311, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7873, dtype=torch.float64) delta_t tensor(0.1888, dtype=torch.float64)
14 gae_duplicate tensor(0.0025, dtype=torch.float64) tensor(-4.0909, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7774, dtype=torch.float64) delta_t tensor(0.2040, dtype=torch.float64)
13 gae_duplicate tensor(-0.1415, dtype=torch.float64) tensor(-4.4331, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4382, dtype=torch.float64) delta_t tensor(-0.0914, dtype=torch.float64)
12 gae_duplicate tensor(-0.6271, dtype=torch.float64) tensor(1.1054, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0992, dtype=torch.float64) delta_t tensor(-0.3890, dtype=torch.float64)
11 gae_duplicate tensor(-2.1905, dtype=torch.float64) tensor(7.6212, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.0457, dtype=torch.float64) delta_t tensor(-1.4819, dtype=torch.float64)
10 gae_duplicate tensor(-6.1254, dtype=torch.float64) tensor(31.5047, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4069, dtype=torch.float64) delta_t tensor(0.0595, dtype=torch.float64)
9 gae_duplicate tensor(-0.6085, dtype=torch.float64) tensor(2.1656, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5687, dtype=torch.float64) delta_t tensor(-1.0105, dtype=torch.float64)
8 gae_duplicate tensor(-1.2112, dtype=torch.float64) tensor(19.5518, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1254, dtype=torch.float64) delta_t tensor(-0.4276, dtype=torch.float64)
7 gae_duplicate tensor(-1.2563, dtype=torch.float64) tensor(10.4076, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7991, dtype=torch.float64) delta_t tensor(-0.7614, dtype=torch.float64)
6 gae_duplicate tensor(-1.3570, dtype=torch.float64) tensor(15.2457, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2286, dtype=torch.float64) delta_t tensor(-1.0567, dtype=torch.float64)
5 gae_duplicate tensor(-1.8102, dtype=torch.float64) tensor(22.6186, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3919, dtype=torch.float64) delta_t tensor(-0.5282, dtype=torch.float64)
4 gae_duplicate tensor(-1.2151, dtype=torch.float64) tensor(12.7803, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5467, dtype=torch.float64) delta_t tensor(-0.7044, dtype=torch.float64)
3 gae_duplicate tensor(-1.4242, dtype=torch.float64) tensor(14.4684, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0496, dtype=torch.float64) delta_t tensor(0.0280, dtype=torch.float64)
2 gae_duplicate tensor(-0.5368, dtype=torch.float64) tensor(1.4908, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6498.21484375
value loss:127.19075775146484
entropies:348.0376281738281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.2356181144714355 seconds
19 rew tensor(1.1269, dtype=torch.float64) delta_t tensor(-0.3079, dtype=torch.float64)
19 gae_duplicate tensor(-0.5068, dtype=torch.float64) tensor(6.2331, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1081, dtype=torch.float64) delta_t tensor(-0.1407, dtype=torch.float64)
18 gae_duplicate tensor(-0.3564, dtype=torch.float64) tensor(3.2087, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0751, dtype=torch.float64) delta_t tensor(-0.0801, dtype=torch.float64)
17 gae_duplicate tensor(-0.3608, dtype=torch.float64) tensor(1.9043, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9699, dtype=torch.float64) delta_t tensor(-0.0622, dtype=torch.float64)
16 gae_duplicate tensor(-0.5160, dtype=torch.float64) tensor(1.2036, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8229, dtype=torch.float64) delta_t tensor(-0.1878, dtype=torch.float64)
15 gae_duplicate tensor(-0.6623, dtype=torch.float64) tensor(3.8778, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7562, dtype=torch.float64) delta_t tensor(0.0865, dtype=torch.float64)
14 gae_duplicate tensor(-0.0277, dtype=torch.float64) tensor(-1.2132, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6523, dtype=torch.float64) delta_t tensor(0.0273, dtype=torch.float64)
13 gae_duplicate tensor(-0.2714, dtype=torch.float64) tensor(-0.7302, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5275, dtype=torch.float64) delta_t tensor(-0.1233, dtype=torch.float64)
12 gae_duplicate tensor(-0.4437, dtype=torch.float64) tensor(2.4952, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2289, dtype=torch.float64) delta_t tensor(-0.4035, dtype=torch.float64)
11 gae_duplicate tensor(-0.7237, dtype=torch.float64) tensor(7.2515, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2097, dtype=torch.float64) delta_t tensor(-0.4359, dtype=torch.float64)
10 gae_duplicate tensor(-0.7020, dtype=torch.float64) tensor(9.5463, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0400, dtype=torch.float64) delta_t tensor(-0.0460, dtype=torch.float64)
9 gae_duplicate tensor(-0.5379, dtype=torch.float64) tensor(1.7853, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2121, dtype=torch.float64) delta_t tensor(-0.8161, dtype=torch.float64)
8 gae_duplicate tensor(-1.0551, dtype=torch.float64) tensor(16.7906, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1178, dtype=torch.float64) delta_t tensor(-1.1448, dtype=torch.float64)
7 gae_duplicate tensor(-1.5048, dtype=torch.float64) tensor(22.4196, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3316, dtype=torch.float64) delta_t tensor(-0.2853, dtype=torch.float64)
6 gae_duplicate tensor(-0.5213, dtype=torch.float64) tensor(8.0253, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7996, dtype=torch.float64) delta_t tensor(-1.2109, dtype=torch.float64)
5 gae_duplicate tensor(-1.5611, dtype=torch.float64) tensor(24.8298, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1444, dtype=torch.float64) delta_t tensor(0.0791, dtype=torch.float64)
4 gae_duplicate tensor(-0.3191, dtype=torch.float64) tensor(0.8536, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2086, dtype=torch.float64) delta_t tensor(-1.4311, dtype=torch.float64)
3 gae_duplicate tensor(-1.8856, dtype=torch.float64) tensor(26.5558, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5053, dtype=torch.float64) delta_t tensor(0.4700, dtype=torch.float64)
2 gae_duplicate tensor(-0.0037, dtype=torch.float64) tensor(-6.5945, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-7029.84033203125
value loss:67.65143585205078
entropies:347.8868713378906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.800210952758789 seconds
19 rew tensor(1.1590, dtype=torch.float64) delta_t tensor(0.0767, dtype=torch.float64)
19 gae_duplicate tensor(-0.3263, dtype=torch.float64) tensor(-1.9633, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1089, dtype=torch.float64) delta_t tensor(0.0152, dtype=torch.float64)
18 gae_duplicate tensor(-0.2804, dtype=torch.float64) tensor(-0.3846, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0809, dtype=torch.float64) delta_t tensor(0.1008, dtype=torch.float64)
17 gae_duplicate tensor(-0.3069, dtype=torch.float64) tensor(-1.9747, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9621, dtype=torch.float64) delta_t tensor(-0.1333, dtype=torch.float64)
16 gae_duplicate tensor(-0.3827, dtype=torch.float64) tensor(2.5593, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0289, dtype=torch.float64) delta_t tensor(0.1954, dtype=torch.float64)
15 gae_duplicate tensor(-0.3382, dtype=torch.float64) tensor(-3.1728, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3572, dtype=torch.float64) delta_t tensor(-0.4382, dtype=torch.float64)
14 gae_duplicate tensor(-1.8604, dtype=torch.float64) tensor(9.7395, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6943, dtype=torch.float64) delta_t tensor(0.1081, dtype=torch.float64)
13 gae_duplicate tensor(-0.2939, dtype=torch.float64) tensor(-1.3539, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2984, dtype=torch.float64) delta_t tensor(-0.1991, dtype=torch.float64)
12 gae_duplicate tensor(-0.5231, dtype=torch.float64) tensor(3.5970, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5228, dtype=torch.float64) delta_t tensor(-0.0189, dtype=torch.float64)
11 gae_duplicate tensor(-0.2916, dtype=torch.float64) tensor(1.1589, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1957, dtype=torch.float64) delta_t tensor(-0.5739, dtype=torch.float64)
10 gae_duplicate tensor(-0.8652, dtype=torch.float64) tensor(11.9231, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4574, dtype=torch.float64) delta_t tensor(0.2403, dtype=torch.float64)
9 gae_duplicate tensor(-0.2984, dtype=torch.float64) tensor(-3.2581, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6032, dtype=torch.float64) delta_t tensor(-1.0796, dtype=torch.float64)
8 gae_duplicate tensor(-1.4377, dtype=torch.float64) tensor(19.0868, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6466, dtype=torch.float64) delta_t tensor(-0.5186, dtype=torch.float64)
7 gae_duplicate tensor(-0.9970, dtype=torch.float64) tensor(11.0457, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6950, dtype=torch.float64) delta_t tensor(-0.3977, dtype=torch.float64)
6 gae_duplicate tensor(-1.1124, dtype=torch.float64) tensor(8.4952, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4912, dtype=torch.float64) delta_t tensor(-0.9374, dtype=torch.float64)
5 gae_duplicate tensor(-1.2083, dtype=torch.float64) tensor(17.9071, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0033, dtype=torch.float64) delta_t tensor(-0.0437, dtype=torch.float64)
4 gae_duplicate tensor(-0.7256, dtype=torch.float64) tensor(3.2378, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0877, dtype=torch.float64) delta_t tensor(-1.2068, dtype=torch.float64)
3 gae_duplicate tensor(-2.2499, dtype=torch.float64) tensor(24.1542, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3338, dtype=torch.float64) delta_t tensor(0.3550, dtype=torch.float64)
2 gae_duplicate tensor(-0.4820, dtype=torch.float64) tensor(-3.8103, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5331.2666015625
value loss:65.44537353515625
entropies:348.02294921875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3944.4900)
ToM Target loss= tensor(3817.0664)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.871767044067383 seconds
19 rew tensor(1.1444, dtype=torch.float64) delta_t tensor(-0.2066, dtype=torch.float64)
19 gae_duplicate tensor(-0.5497, dtype=torch.float64) tensor(3.5086, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1250, dtype=torch.float64) delta_t tensor(0.0410, dtype=torch.float64)
18 gae_duplicate tensor(-0.4741, dtype=torch.float64) tensor(-0.0886, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0059, dtype=torch.float64) delta_t tensor(-0.0162, dtype=torch.float64)
17 gae_duplicate tensor(-0.4403, dtype=torch.float64) tensor(0.3544, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9785, dtype=torch.float64) delta_t tensor(-0.0868, dtype=torch.float64)
16 gae_duplicate tensor(-0.3294, dtype=torch.float64) tensor(1.6908, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8700, dtype=torch.float64) delta_t tensor(0.1003, dtype=torch.float64)
15 gae_duplicate tensor(-0.1976, dtype=torch.float64) tensor(-1.7384, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4654, dtype=torch.float64) delta_t tensor(-0.2288, dtype=torch.float64)
14 gae_duplicate tensor(-1.5988, dtype=torch.float64) tensor(3.7473, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3559, dtype=torch.float64) delta_t tensor(-0.2466, dtype=torch.float64)
13 gae_duplicate tensor(-1.7261, dtype=torch.float64) tensor(5.5956, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3542, dtype=torch.float64) delta_t tensor(-0.1368, dtype=torch.float64)
12 gae_duplicate tensor(-0.4710, dtype=torch.float64) tensor(3.6371, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4882, dtype=torch.float64) delta_t tensor(-0.1412, dtype=torch.float64)
11 gae_duplicate tensor(-0.6744, dtype=torch.float64) tensor(3.0653, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0004, dtype=torch.float64) delta_t tensor(-0.3596, dtype=torch.float64)
10 gae_duplicate tensor(-0.6131, dtype=torch.float64) tensor(7.4991, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3814, dtype=torch.float64) delta_t tensor(0.1109, dtype=torch.float64)
9 gae_duplicate tensor(-0.3968, dtype=torch.float64) tensor(-0.9959, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5339, dtype=torch.float64) delta_t tensor(-0.9387, dtype=torch.float64)
8 gae_duplicate tensor(-1.0894, dtype=torch.float64) tensor(17.3575, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4969, dtype=torch.float64) delta_t tensor(-0.6326, dtype=torch.float64)
7 gae_duplicate tensor(-1.2834, dtype=torch.float64) tensor(13.2366, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7429, dtype=torch.float64) delta_t tensor(-0.1824, dtype=torch.float64)
6 gae_duplicate tensor(-0.7589, dtype=torch.float64) tensor(5.2039, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3769, dtype=torch.float64) delta_t tensor(-0.7895, dtype=torch.float64)
5 gae_duplicate tensor(-1.3694, dtype=torch.float64) tensor(14.7425, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1655, dtype=torch.float64) delta_t tensor(-0.1962, dtype=torch.float64)
4 gae_duplicate tensor(-0.9649, dtype=torch.float64) tensor(5.8171, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8616, dtype=torch.float64) delta_t tensor(-0.8279, dtype=torch.float64)
3 gae_duplicate tensor(-1.8782, dtype=torch.float64) tensor(17.0538, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1744, dtype=torch.float64) delta_t tensor(0.1980, dtype=torch.float64)
2 gae_duplicate tensor(-0.1642, dtype=torch.float64) tensor(-2.1007, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5363.57763671875
value loss:54.76791000366211
entropies:347.91339111328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.855664014816284 seconds
19 rew tensor(1.1922, dtype=torch.float64) delta_t tensor(-0.1439, dtype=torch.float64)
19 gae_duplicate tensor(-0.4902, dtype=torch.float64) tensor(2.7085, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1579, dtype=torch.float64) delta_t tensor(0.0642, dtype=torch.float64)
18 gae_duplicate tensor(-0.3280, dtype=torch.float64) tensor(-1.0343, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1165, dtype=torch.float64) delta_t tensor(0.1316, dtype=torch.float64)
17 gae_duplicate tensor(-0.2952, dtype=torch.float64) tensor(-2.9945, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0720, dtype=torch.float64) delta_t tensor(-0.1952, dtype=torch.float64)
16 gae_duplicate tensor(-0.4261, dtype=torch.float64) tensor(3.7919, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9577, dtype=torch.float64) delta_t tensor(-0.0278, dtype=torch.float64)
15 gae_duplicate tensor(-0.4272, dtype=torch.float64) tensor(0.9264, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4676, dtype=torch.float64) delta_t tensor(-0.1812, dtype=torch.float64)
14 gae_duplicate tensor(-1.5177, dtype=torch.float64) tensor(3.2075, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0482, dtype=torch.float64) delta_t tensor(-0.4992, dtype=torch.float64)
13 gae_duplicate tensor(-2.7909, dtype=torch.float64) tensor(10.9769, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1403, dtype=torch.float64) delta_t tensor(-0.5992, dtype=torch.float64)
12 gae_duplicate tensor(-3.3107, dtype=torch.float64) tensor(13.6641, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4043, dtype=torch.float64) delta_t tensor(0.0201, dtype=torch.float64)
11 gae_duplicate tensor(-0.3208, dtype=torch.float64) tensor(0.8990, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0094, dtype=torch.float64) delta_t tensor(-0.1604, dtype=torch.float64)
10 gae_duplicate tensor(-0.7034, dtype=torch.float64) tensor(2.7176, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4828, dtype=torch.float64) delta_t tensor(0.4243, dtype=torch.float64)
9 gae_duplicate tensor(-0.1293, dtype=torch.float64) tensor(-7.3745, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5499, dtype=torch.float64) delta_t tensor(-0.9245, dtype=torch.float64)
8 gae_duplicate tensor(-1.0617, dtype=torch.float64) tensor(16.8175, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9097, dtype=torch.float64) delta_t tensor(-0.5524, dtype=torch.float64)
7 gae_duplicate tensor(-1.2253, dtype=torch.float64) tensor(13.3927, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6490, dtype=torch.float64) delta_t tensor(-0.3085, dtype=torch.float64)
6 gae_duplicate tensor(-0.7135, dtype=torch.float64) tensor(8.0492, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6073, dtype=torch.float64) delta_t tensor(-0.9365, dtype=torch.float64)
5 gae_duplicate tensor(-1.3686, dtype=torch.float64) tensor(18.1539, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1129, dtype=torch.float64) delta_t tensor(0.1144, dtype=torch.float64)
4 gae_duplicate tensor(-0.3993, dtype=torch.float64) tensor(-0.0406, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2467, dtype=torch.float64) delta_t tensor(-1.2179, dtype=torch.float64)
3 gae_duplicate tensor(-1.8890, dtype=torch.float64) tensor(23.4346, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4548, dtype=torch.float64) delta_t tensor(0.4547, dtype=torch.float64)
2 gae_duplicate tensor(-0.2039, dtype=torch.float64) tensor(-6.4283, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-5540.72119140625
value loss:85.0241928100586
entropies:347.7108459472656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.937354803085327 seconds
19 rew tensor(1.1063, dtype=torch.float64) delta_t tensor(-0.2256, dtype=torch.float64)
19 gae_duplicate tensor(-0.5053, dtype=torch.float64) tensor(4.4024, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1478, dtype=torch.float64) delta_t tensor(0.1026, dtype=torch.float64)
18 gae_duplicate tensor(-0.4234, dtype=torch.float64) tensor(-1.4727, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0632, dtype=torch.float64) delta_t tensor(0.0724, dtype=torch.float64)
17 gae_duplicate tensor(-0.3356, dtype=torch.float64) tensor(-1.3599, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7232, dtype=torch.float64) delta_t tensor(-0.1262, dtype=torch.float64)
16 gae_duplicate tensor(-1.1585, dtype=torch.float64) tensor(2.7757, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8815, dtype=torch.float64) delta_t tensor(0.0432, dtype=torch.float64)
15 gae_duplicate tensor(-0.6308, dtype=torch.float64) tensor(-0.7350, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6257, dtype=torch.float64) delta_t tensor(0.0318, dtype=torch.float64)
14 gae_duplicate tensor(-0.0331, dtype=torch.float64) tensor(-0.7617, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3726, dtype=torch.float64) delta_t tensor(-0.1727, dtype=torch.float64)
13 gae_duplicate tensor(-1.5248, dtype=torch.float64) tensor(3.7618, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4288, dtype=torch.float64) delta_t tensor(-0.0975, dtype=torch.float64)
12 gae_duplicate tensor(-0.3912, dtype=torch.float64) tensor(2.6182, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3924, dtype=torch.float64) delta_t tensor(-0.0889, dtype=torch.float64)
11 gae_duplicate tensor(-0.5735, dtype=torch.float64) tensor(1.6270, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0796, dtype=torch.float64) delta_t tensor(-0.2557, dtype=torch.float64)
10 gae_duplicate tensor(-0.5893, dtype=torch.float64) tensor(5.0203, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3601, dtype=torch.float64) delta_t tensor(0.0606, dtype=torch.float64)
9 gae_duplicate tensor(-0.4267, dtype=torch.float64) tensor(-1.0728, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5485, dtype=torch.float64) delta_t tensor(-0.7906, dtype=torch.float64)
8 gae_duplicate tensor(-1.1614, dtype=torch.float64) tensor(15.5392, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1879, dtype=torch.float64) delta_t tensor(-0.2308, dtype=torch.float64)
7 gae_duplicate tensor(-0.8808, dtype=torch.float64) tensor(6.6982, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7579, dtype=torch.float64) delta_t tensor(-0.0837, dtype=torch.float64)
6 gae_duplicate tensor(-0.3401, dtype=torch.float64) tensor(2.4804, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1705, dtype=torch.float64) delta_t tensor(-0.5883, dtype=torch.float64)
5 gae_duplicate tensor(-0.9616, dtype=torch.float64) tensor(12.5041, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3314, dtype=torch.float64) delta_t tensor(-0.2759, dtype=torch.float64)
4 gae_duplicate tensor(-0.6406, dtype=torch.float64) tensor(6.5223, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3731, dtype=torch.float64) delta_t tensor(-0.2390, dtype=torch.float64)
3 gae_duplicate tensor(-1.2340, dtype=torch.float64) tensor(4.1110, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0786, dtype=torch.float64) delta_t tensor(-0.0762, dtype=torch.float64)
2 gae_duplicate tensor(-0.6137, dtype=torch.float64) tensor(2.1062, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3590.9736328125
value loss:34.34451675415039
entropies:346.9792785644531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.06016206741333 seconds
19 rew tensor(1.1705, dtype=torch.float64) delta_t tensor(-0.2096, dtype=torch.float64)
19 gae_duplicate tensor(-0.5082, dtype=torch.float64) tensor(3.5504, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1333, dtype=torch.float64) delta_t tensor(-0.1072, dtype=torch.float64)
18 gae_duplicate tensor(-0.2794, dtype=torch.float64) tensor(2.5010, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0364, dtype=torch.float64) delta_t tensor(0.1552, dtype=torch.float64)
17 gae_duplicate tensor(-0.2729, dtype=torch.float64) tensor(-2.7258, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(-0.1657, dtype=torch.float64)
16 gae_duplicate tensor(-0.5132, dtype=torch.float64) tensor(3.1710, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9362, dtype=torch.float64) delta_t tensor(0.1873, dtype=torch.float64)
15 gae_duplicate tensor(0.0426, dtype=torch.float64) tensor(-3.4157, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3154, dtype=torch.float64) delta_t tensor(-0.2892, dtype=torch.float64)
14 gae_duplicate tensor(-1.5231, dtype=torch.float64) tensor(5.8608, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6058, dtype=torch.float64) delta_t tensor(-0.0240, dtype=torch.float64)
13 gae_duplicate tensor(-1.6329, dtype=torch.float64) tensor(0.5445, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2684, dtype=torch.float64) delta_t tensor(-0.1595, dtype=torch.float64)
12 gae_duplicate tensor(-0.2230, dtype=torch.float64) tensor(3.1312, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4906, dtype=torch.float64) delta_t tensor(-0.0101, dtype=torch.float64)
11 gae_duplicate tensor(-0.1969, dtype=torch.float64) tensor(0.7361, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0640, dtype=torch.float64) delta_t tensor(-0.1754, dtype=torch.float64)
10 gae_duplicate tensor(-0.5720, dtype=torch.float64) tensor(3.2843, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1836, dtype=torch.float64) delta_t tensor(0.1140, dtype=torch.float64)
9 gae_duplicate tensor(-0.0999, dtype=torch.float64) tensor(-2.0650, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4944, dtype=torch.float64) delta_t tensor(-0.6405, dtype=torch.float64)
8 gae_duplicate tensor(-0.8003, dtype=torch.float64) tensor(11.0897, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4836, dtype=torch.float64) delta_t tensor(-0.3078, dtype=torch.float64)
7 gae_duplicate tensor(-1.1695, dtype=torch.float64) tensor(6.7311, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5876, dtype=torch.float64) delta_t tensor(-0.0029, dtype=torch.float64)
6 gae_duplicate tensor(-0.1471, dtype=torch.float64) tensor(0.9237, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5393, dtype=torch.float64) delta_t tensor(-0.8793, dtype=torch.float64)
5 gae_duplicate tensor(-1.3950, dtype=torch.float64) tensor(16.2223, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1923, dtype=torch.float64) delta_t tensor(-0.0926, dtype=torch.float64)
4 gae_duplicate tensor(-0.3017, dtype=torch.float64) tensor(3.2266, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8068, dtype=torch.float64) delta_t tensor(-0.5575, dtype=torch.float64)
3 gae_duplicate tensor(-1.4993, dtype=torch.float64) tensor(11.1434, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1561, dtype=torch.float64) delta_t tensor(0.1555, dtype=torch.float64)
2 gae_duplicate tensor(-0.0491, dtype=torch.float64) tensor(-1.7154, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3451.9375
value loss:34.64076614379883
entropies:346.0910339355469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.476099014282227 seconds
19 rew tensor(1.1321, dtype=torch.float64) delta_t tensor(-0.2144, dtype=torch.float64)
19 gae_duplicate tensor(-0.5016, dtype=torch.float64) tensor(4.0584, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1341, dtype=torch.float64) delta_t tensor(-0.1721, dtype=torch.float64)
18 gae_duplicate tensor(-0.3983, dtype=torch.float64) tensor(3.7831, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0967, dtype=torch.float64) delta_t tensor(-0.0441, dtype=torch.float64)
17 gae_duplicate tensor(-0.2542, dtype=torch.float64) tensor(1.2040, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0507, dtype=torch.float64) delta_t tensor(-0.1400, dtype=torch.float64)
16 gae_duplicate tensor(-0.3655, dtype=torch.float64) tensor(2.9118, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9361, dtype=torch.float64) delta_t tensor(0.1695, dtype=torch.float64)
15 gae_duplicate tensor(-0.3053, dtype=torch.float64) tensor(-3.1571, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7305, dtype=torch.float64) delta_t tensor(0.2072, dtype=torch.float64)
14 gae_duplicate tensor(0.0652, dtype=torch.float64) tensor(-4.1381, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6153, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
13 gae_duplicate tensor(-0.0777, dtype=torch.float64) tensor(-1.5476, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2702, dtype=torch.float64) delta_t tensor(0.0323, dtype=torch.float64)
12 gae_duplicate tensor(-0.2251, dtype=torch.float64) tensor(-1.4391, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5356, dtype=torch.float64) delta_t tensor(0.0767, dtype=torch.float64)
11 gae_duplicate tensor(-0.2486, dtype=torch.float64) tensor(-1.5081, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0460, dtype=torch.float64) delta_t tensor(0.0825, dtype=torch.float64)
10 gae_duplicate tensor(-0.5280, dtype=torch.float64) tensor(-2.0462, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4671, dtype=torch.float64) delta_t tensor(0.4245, dtype=torch.float64)
9 gae_duplicate tensor(0.0287, dtype=torch.float64) tensor(-8.4140, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4976, dtype=torch.float64) delta_t tensor(-0.6571, dtype=torch.float64)
8 gae_duplicate tensor(-0.9815, dtype=torch.float64) tensor(11.1671, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6580, dtype=torch.float64) delta_t tensor(-0.2600, dtype=torch.float64)
7 gae_duplicate tensor(-0.9034, dtype=torch.float64) tensor(6.8706, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8115, dtype=torch.float64) delta_t tensor(-0.1878, dtype=torch.float64)
6 gae_duplicate tensor(-0.8944, dtype=torch.float64) tensor(4.0495, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2276, dtype=torch.float64) delta_t tensor(-0.6585, dtype=torch.float64)
5 gae_duplicate tensor(-1.2646, dtype=torch.float64) tensor(13.6627, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1881, dtype=torch.float64) delta_t tensor(-0.0446, dtype=torch.float64)
4 gae_duplicate tensor(-1.0309, dtype=torch.float64) tensor(3.1072, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7245, dtype=torch.float64) delta_t tensor(-0.5680, dtype=torch.float64)
3 gae_duplicate tensor(-1.5681, dtype=torch.float64) tensor(10.0702, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1408, dtype=torch.float64) delta_t tensor(0.2413, dtype=torch.float64)
2 gae_duplicate tensor(-0.5893, dtype=torch.float64) tensor(-3.4850, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1991.4368896484375
value loss:42.52043151855469
entropies:345.84033203125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3928.3086)
ToM Target loss= tensor(3828.5457)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.73885703086853 seconds
19 rew tensor(1.1444, dtype=torch.float64) delta_t tensor(-0.1964, dtype=torch.float64)
19 gae_duplicate tensor(-0.4278, dtype=torch.float64) tensor(3.5905, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1477, dtype=torch.float64) delta_t tensor(0.0517, dtype=torch.float64)
18 gae_duplicate tensor(-0.2382, dtype=torch.float64) tensor(-1.0580, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0992, dtype=torch.float64) delta_t tensor(0.1911, dtype=torch.float64)
17 gae_duplicate tensor(-0.1532, dtype=torch.float64) tensor(-3.4274, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0067, dtype=torch.float64) delta_t tensor(0.0073, dtype=torch.float64)
16 gae_duplicate tensor(-0.2617, dtype=torch.float64) tensor(-0.5709, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9736, dtype=torch.float64) delta_t tensor(0.2916, dtype=torch.float64)
15 gae_duplicate tensor(0.1629, dtype=torch.float64) tensor(-5.3995, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0585, dtype=torch.float64) delta_t tensor(-0.5429, dtype=torch.float64)
14 gae_duplicate tensor(-2.6050, dtype=torch.float64) tensor(8.4822, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6427, dtype=torch.float64) delta_t tensor(0.1534, dtype=torch.float64)
13 gae_duplicate tensor(-0.2730, dtype=torch.float64) tensor(-1.9226, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2362, dtype=torch.float64) delta_t tensor(0.0332, dtype=torch.float64)
12 gae_duplicate tensor(-0.3549, dtype=torch.float64) tensor(-1.0435, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6040, dtype=torch.float64) delta_t tensor(0.2066, dtype=torch.float64)
11 gae_duplicate tensor(-0.0803, dtype=torch.float64) tensor(-4.1526, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1160, dtype=torch.float64) delta_t tensor(-0.0666, dtype=torch.float64)
10 gae_duplicate tensor(-0.4310, dtype=torch.float64) tensor(1.1031, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4717, dtype=torch.float64) delta_t tensor(0.4729, dtype=torch.float64)
9 gae_duplicate tensor(-0.0240, dtype=torch.float64) tensor(-8.2373, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6381, dtype=torch.float64) delta_t tensor(-0.6851, dtype=torch.float64)
8 gae_duplicate tensor(-0.7913, dtype=torch.float64) tensor(11.6969, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5243, dtype=torch.float64) delta_t tensor(-0.1751, dtype=torch.float64)
7 gae_duplicate tensor(-0.8064, dtype=torch.float64) tensor(4.8212, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7070, dtype=torch.float64) delta_t tensor(0.0241, dtype=torch.float64)
6 gae_duplicate tensor(-0.2646, dtype=torch.float64) tensor(0.0104, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4538, dtype=torch.float64) delta_t tensor(-0.6043, dtype=torch.float64)
5 gae_duplicate tensor(-0.9556, dtype=torch.float64) tensor(10.5745, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1007, dtype=torch.float64) delta_t tensor(0.0181, dtype=torch.float64)
4 gae_duplicate tensor(-0.2957, dtype=torch.float64) tensor(0.4950, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9310, dtype=torch.float64) delta_t tensor(-0.6695, dtype=torch.float64)
3 gae_duplicate tensor(-1.3673, dtype=torch.float64) tensor(12.4957, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2523, dtype=torch.float64) delta_t tensor(0.2918, dtype=torch.float64)
2 gae_duplicate tensor(-0.1278, dtype=torch.float64) tensor(-4.1405, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1352.433349609375
value loss:39.307682037353516
entropies:345.595458984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.992143869400024 seconds
19 rew tensor(1.2800, dtype=torch.float64) delta_t tensor(0.1136, dtype=torch.float64)
19 gae_duplicate tensor(-0.1371, dtype=torch.float64) tensor(-2.4046, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2557, dtype=torch.float64) delta_t tensor(0.3061, dtype=torch.float64)
18 gae_duplicate tensor(-0.0804, dtype=torch.float64) tensor(-6.2954, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1807, dtype=torch.float64) delta_t tensor(0.3316, dtype=torch.float64)
17 gae_duplicate tensor(0.0170, dtype=torch.float64) tensor(-6.5405, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1460, dtype=torch.float64) delta_t tensor(0.3433, dtype=torch.float64)
16 gae_duplicate tensor(0.0438, dtype=torch.float64) tensor(-8.1556, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.1099, dtype=torch.float64) delta_t tensor(0.1250, dtype=torch.float64)
15 gae_duplicate tensor(-0.1626, dtype=torch.float64) tensor(-3.1698, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4935, dtype=torch.float64) delta_t tensor(-0.4624, dtype=torch.float64)
14 gae_duplicate tensor(-2.9303, dtype=torch.float64) tensor(7.8482, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2080, dtype=torch.float64) delta_t tensor(-0.2385, dtype=torch.float64)
13 gae_duplicate tensor(-1.2747, dtype=torch.float64) tensor(4.9839, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.9456, dtype=torch.float64) delta_t tensor(-1.0510, dtype=torch.float64)
12 gae_duplicate tensor(-4.8065, dtype=torch.float64) tensor(18.8534, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1484, dtype=torch.float64) delta_t tensor(-0.4409, dtype=torch.float64)
11 gae_duplicate tensor(-1.8389, dtype=torch.float64) tensor(12.0112, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0119, dtype=torch.float64) delta_t tensor(0.2821, dtype=torch.float64)
10 gae_duplicate tensor(-0.0933, dtype=torch.float64) tensor(-4.2701, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6435, dtype=torch.float64) delta_t tensor(0.7265, dtype=torch.float64)
9 gae_duplicate tensor(0.4241, dtype=torch.float64) tensor(-14.4337, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7302, dtype=torch.float64) delta_t tensor(-0.7326, dtype=torch.float64)
8 gae_duplicate tensor(-0.9786, dtype=torch.float64) tensor(12.5615, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0654, dtype=torch.float64) delta_t tensor(-0.2315, dtype=torch.float64)
7 gae_duplicate tensor(-0.8405, dtype=torch.float64) tensor(6.1289, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9269, dtype=torch.float64) delta_t tensor(-0.2421, dtype=torch.float64)
6 gae_duplicate tensor(-0.3981, dtype=torch.float64) tensor(5.1991, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5984, dtype=torch.float64) delta_t tensor(-0.6385, dtype=torch.float64)
5 gae_duplicate tensor(-1.1772, dtype=torch.float64) tensor(12.8976, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2965, dtype=torch.float64) delta_t tensor(0.4345, dtype=torch.float64)
4 gae_duplicate tensor(0.0862, dtype=torch.float64) tensor(-6.6039, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6946, dtype=torch.float64) delta_t tensor(-1.4057, dtype=torch.float64)
3 gae_duplicate tensor(-1.9549, dtype=torch.float64) tensor(25.3867, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6367, dtype=torch.float64) delta_t tensor(0.7987, dtype=torch.float64)
2 gae_duplicate tensor(0.4630, dtype=torch.float64) tensor(-13.0694, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2303.525146484375
value loss:119.33429718017578
entropies:346.08453369140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.707276105880737 seconds
19 rew tensor(1.2354, dtype=torch.float64) delta_t tensor(0.1266, dtype=torch.float64)
19 gae_duplicate tensor(-0.2624, dtype=torch.float64) tensor(-2.3264, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2143, dtype=torch.float64) delta_t tensor(0.2270, dtype=torch.float64)
18 gae_duplicate tensor(-0.1534, dtype=torch.float64) tensor(-4.2718, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.2042, dtype=torch.float64) delta_t tensor(0.1410, dtype=torch.float64)
17 gae_duplicate tensor(-0.1525, dtype=torch.float64) tensor(-2.9783, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1181, dtype=torch.float64) delta_t tensor(-0.0311, dtype=torch.float64)
16 gae_duplicate tensor(-0.2729, dtype=torch.float64) tensor(0.4762, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0331, dtype=torch.float64) delta_t tensor(0.2652, dtype=torch.float64)
15 gae_duplicate tensor(-0.2221, dtype=torch.float64) tensor(-4.7093, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2610, dtype=torch.float64) delta_t tensor(-0.2143, dtype=torch.float64)
14 gae_duplicate tensor(-1.7099, dtype=torch.float64) tensor(4.2419, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0827, dtype=torch.float64) delta_t tensor(-0.4241, dtype=torch.float64)
13 gae_duplicate tensor(-3.1937, dtype=torch.float64) tensor(7.5470, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1108, dtype=torch.float64) delta_t tensor(0.1013, dtype=torch.float64)
12 gae_duplicate tensor(-1.4508, dtype=torch.float64) tensor(-2.2120, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5087, dtype=torch.float64) delta_t tensor(0.2625, dtype=torch.float64)
11 gae_duplicate tensor(-0.0316, dtype=torch.float64) tensor(-5.0496, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0947, dtype=torch.float64) delta_t tensor(0.3505, dtype=torch.float64)
10 gae_duplicate tensor(0.2000, dtype=torch.float64) tensor(-7.2972, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5684, dtype=torch.float64) delta_t tensor(0.7502, dtype=torch.float64)
9 gae_duplicate tensor(0.1068, dtype=torch.float64) tensor(-14.6608, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6716, dtype=torch.float64) delta_t tensor(-0.5744, dtype=torch.float64)
8 gae_duplicate tensor(-0.7785, dtype=torch.float64) tensor(8.9366, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2567, dtype=torch.float64) delta_t tensor(-0.3033, dtype=torch.float64)
7 gae_duplicate tensor(-0.6520, dtype=torch.float64) tensor(7.6268, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8177, dtype=torch.float64) delta_t tensor(-0.0756, dtype=torch.float64)
6 gae_duplicate tensor(-0.2711, dtype=torch.float64) tensor(1.9579, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6593, dtype=torch.float64) delta_t tensor(-0.6161, dtype=torch.float64)
5 gae_duplicate tensor(-0.9889, dtype=torch.float64) tensor(11.1881, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4206, dtype=torch.float64) delta_t tensor(0.5170, dtype=torch.float64)
4 gae_duplicate tensor(0.1053, dtype=torch.float64) tensor(-9.1080, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7621, dtype=torch.float64) delta_t tensor(-1.4572, dtype=torch.float64)
3 gae_duplicate tensor(-1.7190, dtype=torch.float64) tensor(26.7129, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.7546, dtype=torch.float64) delta_t tensor(0.8581, dtype=torch.float64)
2 gae_duplicate tensor(0.3106, dtype=torch.float64) tensor(-13.4926, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-232.9166259765625
value loss:78.44872283935547
entropies:346.39581298828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.813145637512207 seconds
19 rew tensor(1.1961, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
19 gae_duplicate tensor(-0.2294, dtype=torch.float64) tensor(0.2147, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1894, dtype=torch.float64) delta_t tensor(0.3231, dtype=torch.float64)
18 gae_duplicate tensor(0.0152, dtype=torch.float64) tensor(-5.9631, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9846, dtype=torch.float64) delta_t tensor(0.2921, dtype=torch.float64)
17 gae_duplicate tensor(0.2027, dtype=torch.float64) tensor(-5.9639, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0607, dtype=torch.float64) delta_t tensor(0.3141, dtype=torch.float64)
16 gae_duplicate tensor(-0.1365, dtype=torch.float64) tensor(-6.4793, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8999, dtype=torch.float64) delta_t tensor(0.2589, dtype=torch.float64)
15 gae_duplicate tensor(0.0954, dtype=torch.float64) tensor(-5.9652, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3483, dtype=torch.float64) delta_t tensor(0.0146, dtype=torch.float64)
14 gae_duplicate tensor(-1.2544, dtype=torch.float64) tensor(-1.1635, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1039, dtype=torch.float64) delta_t tensor(-0.5147, dtype=torch.float64)
13 gae_duplicate tensor(-4.5580, dtype=torch.float64) tensor(8.6897, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2475, dtype=torch.float64) delta_t tensor(0.2680, dtype=torch.float64)
12 gae_duplicate tensor(-0.0424, dtype=torch.float64) tensor(-3.9800, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6479, dtype=torch.float64) delta_t tensor(0.2815, dtype=torch.float64)
11 gae_duplicate tensor(-0.1012, dtype=torch.float64) tensor(-5.8559, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1613, dtype=torch.float64) delta_t tensor(0.3053, dtype=torch.float64)
10 gae_duplicate tensor(0.0008, dtype=torch.float64) tensor(-6.6943, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6422, dtype=torch.float64) delta_t tensor(0.5959, dtype=torch.float64)
9 gae_duplicate tensor(0.1549, dtype=torch.float64) tensor(-12.0344, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6725, dtype=torch.float64) delta_t tensor(-0.3684, dtype=torch.float64)
8 gae_duplicate tensor(-0.6317, dtype=torch.float64) tensor(6.9785, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0192, dtype=torch.float64) delta_t tensor(0.1600, dtype=torch.float64)
7 gae_duplicate tensor(-0.3319, dtype=torch.float64) tensor(-2.7371, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9737, dtype=torch.float64) delta_t tensor(-0.0853, dtype=torch.float64)
6 gae_duplicate tensor(-0.4079, dtype=torch.float64) tensor(1.1163, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8938, dtype=torch.float64) delta_t tensor(-0.1891, dtype=torch.float64)
5 gae_duplicate tensor(-0.5879, dtype=torch.float64) tensor(3.3980, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3991, dtype=torch.float64) delta_t tensor(-0.0540, dtype=torch.float64)
4 gae_duplicate tensor(-0.2884, dtype=torch.float64) tensor(1.2862, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2207, dtype=torch.float64) delta_t tensor(0.1647, dtype=torch.float64)
3 gae_duplicate tensor(-1.1751, dtype=torch.float64) tensor(-1.8915, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1176, dtype=torch.float64) delta_t tensor(0.2145, dtype=torch.float64)
2 gae_duplicate tensor(-0.2147, dtype=torch.float64) tensor(-4.4016, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2144.50927734375
value loss:59.672874450683594
entropies:346.6575927734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.73855185508728 seconds
19 rew tensor(1.1636, dtype=torch.float64) delta_t tensor(-0.1893, dtype=torch.float64)
19 gae_duplicate tensor(-0.3793, dtype=torch.float64) tensor(3.5509, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1153, dtype=torch.float64) delta_t tensor(-0.0728, dtype=torch.float64)
18 gae_duplicate tensor(-0.3137, dtype=torch.float64) tensor(1.8842, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1039, dtype=torch.float64) delta_t tensor(-0.0123, dtype=torch.float64)
17 gae_duplicate tensor(-0.2573, dtype=torch.float64) tensor(0.5562, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1046, dtype=torch.float64) delta_t tensor(-0.0086, dtype=torch.float64)
16 gae_duplicate tensor(-0.2732, dtype=torch.float64) tensor(0.4892, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9287, dtype=torch.float64) delta_t tensor(0.2398, dtype=torch.float64)
15 gae_duplicate tensor(-0.3539, dtype=torch.float64) tensor(-4.6699, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1864, dtype=torch.float64) delta_t tensor(-0.2433, dtype=torch.float64)
14 gae_duplicate tensor(-2.9213, dtype=torch.float64) tensor(3.6992, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6150, dtype=torch.float64) delta_t tensor(0.1460, dtype=torch.float64)
13 gae_duplicate tensor(-0.1398, dtype=torch.float64) tensor(-2.2808, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3826, dtype=torch.float64) delta_t tensor(0.2259, dtype=torch.float64)
12 gae_duplicate tensor(-0.0491, dtype=torch.float64) tensor(-4.3130, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3095, dtype=torch.float64) delta_t tensor(-0.0411, dtype=torch.float64)
11 gae_duplicate tensor(-0.3096, dtype=torch.float64) tensor(0.2820, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0543, dtype=torch.float64) delta_t tensor(0.2728, dtype=torch.float64)
10 gae_duplicate tensor(0.0798, dtype=torch.float64) tensor(-5.1948, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3117, dtype=torch.float64) delta_t tensor(0.5643, dtype=torch.float64)
9 gae_duplicate tensor(0.3603, dtype=torch.float64) tensor(-10.8578, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3444, dtype=torch.float64) delta_t tensor(-0.2411, dtype=torch.float64)
8 gae_duplicate tensor(-0.3185, dtype=torch.float64) tensor(3.2149, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0852, dtype=torch.float64) delta_t tensor(-0.2883, dtype=torch.float64)
7 gae_duplicate tensor(-0.6456, dtype=torch.float64) tensor(5.9629, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4509, dtype=torch.float64) delta_t tensor(0.2865, dtype=torch.float64)
6 gae_duplicate tensor(0.0690, dtype=torch.float64) tensor(-5.1478, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7869, dtype=torch.float64) delta_t tensor(-0.7945, dtype=torch.float64)
5 gae_duplicate tensor(-0.8851, dtype=torch.float64) tensor(14.6311, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1156, dtype=torch.float64) delta_t tensor(0.2790, dtype=torch.float64)
4 gae_duplicate tensor(0.0959, dtype=torch.float64) tensor(-4.2189, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2419, dtype=torch.float64) delta_t tensor(-0.7097, dtype=torch.float64)
3 gae_duplicate tensor(-1.1560, dtype=torch.float64) tensor(13.4935, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4610, dtype=torch.float64) delta_t tensor(0.5369, dtype=torch.float64)
2 gae_duplicate tensor(0.3406, dtype=torch.float64) tensor(-8.9033, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-211.3235321044922
value loss:37.55887985229492
entropies:347.105224609375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3922.3562)
ToM Target loss= tensor(3838.3555)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.979138135910034 seconds
19 rew tensor(1.2140, dtype=torch.float64) delta_t tensor(0.0016, dtype=torch.float64)
19 gae_duplicate tensor(-0.2946, dtype=torch.float64) tensor(0.0970, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1665, dtype=torch.float64) delta_t tensor(0.0239, dtype=torch.float64)
18 gae_duplicate tensor(-0.2461, dtype=torch.float64) tensor(-0.6477, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(-0.0003, dtype=torch.float64)
17 gae_duplicate tensor(-1.1166, dtype=torch.float64) tensor(0.3737, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0123, dtype=torch.float64) delta_t tensor(0.1980, dtype=torch.float64)
16 gae_duplicate tensor(-0.3284, dtype=torch.float64) tensor(-3.9185, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9641, dtype=torch.float64) delta_t tensor(0.2425, dtype=torch.float64)
15 gae_duplicate tensor(-0.3060, dtype=torch.float64) tensor(-5.2083, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6674, dtype=torch.float64) delta_t tensor(0.2307, dtype=torch.float64)
14 gae_duplicate tensor(0.0296, dtype=torch.float64) tensor(-4.8556, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7095, dtype=torch.float64) delta_t tensor(0.3568, dtype=torch.float64)
13 gae_duplicate tensor(0.1387, dtype=torch.float64) tensor(-7.1559, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3493, dtype=torch.float64) delta_t tensor(0.2935, dtype=torch.float64)
12 gae_duplicate tensor(0.0505, dtype=torch.float64) tensor(-6.0907, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3411, dtype=torch.float64) delta_t tensor(0.0230, dtype=torch.float64)
11 gae_duplicate tensor(-0.2033, dtype=torch.float64) tensor(-0.6680, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0147, dtype=torch.float64) delta_t tensor(0.3431, dtype=torch.float64)
10 gae_duplicate tensor(-0.1493, dtype=torch.float64) tensor(-7.1793, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3687, dtype=torch.float64) delta_t tensor(0.5766, dtype=torch.float64)
9 gae_duplicate tensor(0.3261, dtype=torch.float64) tensor(-12.0462, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5561, dtype=torch.float64) delta_t tensor(-0.2224, dtype=torch.float64)
8 gae_duplicate tensor(-0.3430, dtype=torch.float64) tensor(3.0908, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7538, dtype=torch.float64) delta_t tensor(-0.0095, dtype=torch.float64)
7 gae_duplicate tensor(-0.7362, dtype=torch.float64) tensor(-0.0883, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7643, dtype=torch.float64) delta_t tensor(0.0217, dtype=torch.float64)
6 gae_duplicate tensor(-0.6316, dtype=torch.float64) tensor(-0.3659, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3745, dtype=torch.float64) delta_t tensor(-0.4722, dtype=torch.float64)
5 gae_duplicate tensor(-0.9385, dtype=torch.float64) tensor(8.9259, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0592, dtype=torch.float64) delta_t tensor(0.1394, dtype=torch.float64)
4 gae_duplicate tensor(-0.6770, dtype=torch.float64) tensor(-1.4732, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9100, dtype=torch.float64) delta_t tensor(-0.4527, dtype=torch.float64)
3 gae_duplicate tensor(-1.4922, dtype=torch.float64) tensor(7.0327, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2601, dtype=torch.float64) delta_t tensor(0.4409, dtype=torch.float64)
2 gae_duplicate tensor(-0.3229, dtype=torch.float64) tensor(-7.0164, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1914.6641845703125
value loss:38.75416564941406
entropies:347.4162292480469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8046300411224365 seconds
19 rew tensor(1.1404, dtype=torch.float64) delta_t tensor(-0.1358, dtype=torch.float64)
19 gae_duplicate tensor(-0.3227, dtype=torch.float64) tensor(2.5004, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1330, dtype=torch.float64) delta_t tensor(0.0211, dtype=torch.float64)
18 gae_duplicate tensor(-0.2459, dtype=torch.float64) tensor(0.0500, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0452, dtype=torch.float64) delta_t tensor(-0.0272, dtype=torch.float64)
17 gae_duplicate tensor(-0.2230, dtype=torch.float64) tensor(0.6333, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7105, dtype=torch.float64) delta_t tensor(-0.1087, dtype=torch.float64)
16 gae_duplicate tensor(-1.1842, dtype=torch.float64) tensor(1.9796, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9093, dtype=torch.float64) delta_t tensor(0.2397, dtype=torch.float64)
15 gae_duplicate tensor(-0.2740, dtype=torch.float64) tensor(-4.3780, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7371, dtype=torch.float64) delta_t tensor(0.2357, dtype=torch.float64)
14 gae_duplicate tensor(0.1465, dtype=torch.float64) tensor(-4.9306, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6831, dtype=torch.float64) delta_t tensor(0.3626, dtype=torch.float64)
13 gae_duplicate tensor(0.3002, dtype=torch.float64) tensor(-7.7864, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5054, dtype=torch.float64) delta_t tensor(0.2941, dtype=torch.float64)
12 gae_duplicate tensor(0.1149, dtype=torch.float64) tensor(-6.1686, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2205, dtype=torch.float64) delta_t tensor(-0.0131, dtype=torch.float64)
11 gae_duplicate tensor(-0.1265, dtype=torch.float64) tensor(-0.3724, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1190, dtype=torch.float64) delta_t tensor(0.3614, dtype=torch.float64)
10 gae_duplicate tensor(0.1048, dtype=torch.float64) tensor(-6.7036, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0629, dtype=torch.float64) delta_t tensor(0.3362, dtype=torch.float64)
9 gae_duplicate tensor(-0.0020, dtype=torch.float64) tensor(-7.3158, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4370, dtype=torch.float64) delta_t tensor(-0.0789, dtype=torch.float64)
8 gae_duplicate tensor(-0.3122, dtype=torch.float64) tensor(1.1496, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0689, dtype=torch.float64) delta_t tensor(-0.2970, dtype=torch.float64)
7 gae_duplicate tensor(-1.2384, dtype=torch.float64) tensor(5.3999, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5284, dtype=torch.float64) delta_t tensor(0.2445, dtype=torch.float64)
6 gae_duplicate tensor(-0.0511, dtype=torch.float64) tensor(-4.0429, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7277, dtype=torch.float64) delta_t tensor(-0.6455, dtype=torch.float64)
5 gae_duplicate tensor(-0.9883, dtype=torch.float64) tensor(11.9140, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1732, dtype=torch.float64) delta_t tensor(0.3227, dtype=torch.float64)
4 gae_duplicate tensor(-0.2481, dtype=torch.float64) tensor(-5.7130, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3304, dtype=torch.float64) delta_t tensor(-0.6899, dtype=torch.float64)
3 gae_duplicate tensor(-1.5106, dtype=torch.float64) tensor(13.4949, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5200, dtype=torch.float64) delta_t tensor(0.5905, dtype=torch.float64)
2 gae_duplicate tensor(-0.1388, dtype=torch.float64) tensor(-10.4563, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1026.4093017578125
value loss:32.386722564697266
entropies:347.6748046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.765404939651489 seconds
19 rew tensor(1.1321, dtype=torch.float64) delta_t tensor(-0.0442, dtype=torch.float64)
19 gae_duplicate tensor(-0.3638, dtype=torch.float64) tensor(0.7789, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1465, dtype=torch.float64) delta_t tensor(0.0926, dtype=torch.float64)
18 gae_duplicate tensor(-0.2465, dtype=torch.float64) tensor(-1.3495, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8066, dtype=torch.float64) delta_t tensor(-0.1459, dtype=torch.float64)
17 gae_duplicate tensor(-1.2567, dtype=torch.float64) tensor(2.1659, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0672, dtype=torch.float64) delta_t tensor(-0.0469, dtype=torch.float64)
16 gae_duplicate tensor(-0.3169, dtype=torch.float64) tensor(1.2657, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9813, dtype=torch.float64) delta_t tensor(0.1910, dtype=torch.float64)
15 gae_duplicate tensor(-0.3358, dtype=torch.float64) tensor(-3.6684, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3427, dtype=torch.float64) delta_t tensor(-0.1664, dtype=torch.float64)
14 gae_duplicate tensor(-2.7740, dtype=torch.float64) tensor(4.2031, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7840, dtype=torch.float64) delta_t tensor(0.2476, dtype=torch.float64)
13 gae_duplicate tensor(0.0304, dtype=torch.float64) tensor(-4.4315, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3387, dtype=torch.float64) delta_t tensor(0.4054, dtype=torch.float64)
12 gae_duplicate tensor(0.2792, dtype=torch.float64) tensor(-8.7374, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5621, dtype=torch.float64) delta_t tensor(0.1460, dtype=torch.float64)
11 gae_duplicate tensor(-0.1110, dtype=torch.float64) tensor(-3.3642, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1851, dtype=torch.float64) delta_t tensor(0.1228, dtype=torch.float64)
10 gae_duplicate tensor(-0.0424, dtype=torch.float64) tensor(-2.8323, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4336, dtype=torch.float64) delta_t tensor(0.5664, dtype=torch.float64)
9 gae_duplicate tensor(0.4082, dtype=torch.float64) tensor(-10.3006, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5155, dtype=torch.float64) delta_t tensor(-0.0749, dtype=torch.float64)
8 gae_duplicate tensor(-0.3739, dtype=torch.float64) tensor(0.4200, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.9616, dtype=torch.float64) delta_t tensor(-1.0503, dtype=torch.float64)
7 gae_duplicate tensor(-3.2354, dtype=torch.float64) tensor(22.9553, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7188, dtype=torch.float64) delta_t tensor(0.0464, dtype=torch.float64)
6 gae_duplicate tensor(-0.8174, dtype=torch.float64) tensor(1.3111, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6388, dtype=torch.float64) delta_t tensor(-0.4921, dtype=torch.float64)
5 gae_duplicate tensor(-0.8105, dtype=torch.float64) tensor(9.0765, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1409, dtype=torch.float64) delta_t tensor(0.3160, dtype=torch.float64)
4 gae_duplicate tensor(0.0722, dtype=torch.float64) tensor(-4.7640, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3606, dtype=torch.float64) delta_t tensor(-0.6261, dtype=torch.float64)
3 gae_duplicate tensor(-1.2059, dtype=torch.float64) tensor(11.9754, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4871, dtype=torch.float64) delta_t tensor(0.5607, dtype=torch.float64)
2 gae_duplicate tensor(0.3298, dtype=torch.float64) tensor(-8.9162, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-406.52374267578125
value loss:67.2435302734375
entropies:348.0704650878906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9029669761657715 seconds
19 rew tensor(1.0972, dtype=torch.float64) delta_t tensor(-0.2888, dtype=torch.float64)
19 gae_duplicate tensor(-0.3833, dtype=torch.float64) tensor(5.3655, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1253, dtype=torch.float64) delta_t tensor(0.0032, dtype=torch.float64)
18 gae_duplicate tensor(-0.2681, dtype=torch.float64) tensor(-0.2713, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9419, dtype=torch.float64) delta_t tensor(-0.0478, dtype=torch.float64)
17 gae_duplicate tensor(-0.2953, dtype=torch.float64) tensor(1.0471, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9593, dtype=torch.float64) delta_t tensor(-0.0173, dtype=torch.float64)
16 gae_duplicate tensor(-0.1886, dtype=torch.float64) tensor(0.6336, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8535, dtype=torch.float64) delta_t tensor(0.2131, dtype=torch.float64)
15 gae_duplicate tensor(0.1581, dtype=torch.float64) tensor(-3.8980, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6490, dtype=torch.float64) delta_t tensor(0.2267, dtype=torch.float64)
14 gae_duplicate tensor(0.0947, dtype=torch.float64) tensor(-4.6774, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6902, dtype=torch.float64) delta_t tensor(0.2489, dtype=torch.float64)
13 gae_duplicate tensor(0.1654, dtype=torch.float64) tensor(-5.3820, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2197, dtype=torch.float64) delta_t tensor(0.0990, dtype=torch.float64)
12 gae_duplicate tensor(-0.1651, dtype=torch.float64) tensor(-2.2106, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5276, dtype=torch.float64) delta_t tensor(0.1510, dtype=torch.float64)
11 gae_duplicate tensor(-0.0587, dtype=torch.float64) tensor(-2.9756, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1568, dtype=torch.float64) delta_t tensor(0.2413, dtype=torch.float64)
10 gae_duplicate tensor(0.0954, dtype=torch.float64) tensor(-4.7644, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4871, dtype=torch.float64) delta_t tensor(0.4911, dtype=torch.float64)
9 gae_duplicate tensor(0.1194, dtype=torch.float64) tensor(-9.8425, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6647, dtype=torch.float64) delta_t tensor(-0.2460, dtype=torch.float64)
8 gae_duplicate tensor(-0.4106, dtype=torch.float64) tensor(3.8912, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1077, dtype=torch.float64) delta_t tensor(0.2418, dtype=torch.float64)
7 gae_duplicate tensor(-0.4315, dtype=torch.float64) tensor(-3.6571, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8216, dtype=torch.float64) delta_t tensor(0.1029, dtype=torch.float64)
6 gae_duplicate tensor(-0.4367, dtype=torch.float64) tensor(-2.1452, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1015, dtype=torch.float64) delta_t tensor(-0.0785, dtype=torch.float64)
5 gae_duplicate tensor(-0.4516, dtype=torch.float64) tensor(1.6316, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3619, dtype=torch.float64) delta_t tensor(-0.0067, dtype=torch.float64)
4 gae_duplicate tensor(-0.3476, dtype=torch.float64) tensor(0.3414, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4182, dtype=torch.float64) delta_t tensor(-0.0585, dtype=torch.float64)
3 gae_duplicate tensor(-0.7781, dtype=torch.float64) tensor(1.1832, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0111, dtype=torch.float64) delta_t tensor(0.1287, dtype=torch.float64)
2 gae_duplicate tensor(-0.1380, dtype=torch.float64) tensor(-2.0323, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1405.22265625
value loss:15.680520057678223
entropies:348.0267333984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.168574094772339 seconds
19 rew tensor(1.2292, dtype=torch.float64) delta_t tensor(-0.1042, dtype=torch.float64)
19 gae_duplicate tensor(-0.3068, dtype=torch.float64) tensor(2.2283, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2037, dtype=torch.float64) delta_t tensor(0.0077, dtype=torch.float64)
18 gae_duplicate tensor(-0.2248, dtype=torch.float64) tensor(0.1700, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1536, dtype=torch.float64) delta_t tensor(-0.0764, dtype=torch.float64)
17 gae_duplicate tensor(-0.2885, dtype=torch.float64) tensor(1.3539, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0275, dtype=torch.float64) delta_t tensor(-0.0568, dtype=torch.float64)
16 gae_duplicate tensor(-0.1868, dtype=torch.float64) tensor(1.2397, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9325, dtype=torch.float64) delta_t tensor(0.1230, dtype=torch.float64)
15 gae_duplicate tensor(-0.3014, dtype=torch.float64) tensor(-2.1559, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7850, dtype=torch.float64) delta_t tensor(0.2156, dtype=torch.float64)
14 gae_duplicate tensor(0.0263, dtype=torch.float64) tensor(-4.2333, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2971, dtype=torch.float64) delta_t tensor(-0.0029, dtype=torch.float64)
13 gae_duplicate tensor(-1.2841, dtype=torch.float64) tensor(0.1460, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5589, dtype=torch.float64) delta_t tensor(0.1497, dtype=torch.float64)
12 gae_duplicate tensor(0.0193, dtype=torch.float64) tensor(-2.6620, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7065, dtype=torch.float64) delta_t tensor(-0.7280, dtype=torch.float64)
11 gae_duplicate tensor(-4.3543, dtype=torch.float64) tensor(18.1835, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1407, dtype=torch.float64) delta_t tensor(0.1196, dtype=torch.float64)
10 gae_duplicate tensor(-2.3149, dtype=torch.float64) tensor(-1.3627, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0353, dtype=torch.float64) delta_t tensor(0.3583, dtype=torch.float64)
9 gae_duplicate tensor(0.1565, dtype=torch.float64) tensor(-7.7315, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3611, dtype=torch.float64) delta_t tensor(0.1095, dtype=torch.float64)
8 gae_duplicate tensor(-0.3648, dtype=torch.float64) tensor(-3.1100, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3791, dtype=torch.float64) delta_t tensor(-0.3797, dtype=torch.float64)
7 gae_duplicate tensor(-0.8438, dtype=torch.float64) tensor(7.1880, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5314, dtype=torch.float64) delta_t tensor(0.3869, dtype=torch.float64)
6 gae_duplicate tensor(0.1012, dtype=torch.float64) tensor(-7.4082, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9262, dtype=torch.float64) delta_t tensor(-0.6335, dtype=torch.float64)
5 gae_duplicate tensor(-0.9619, dtype=torch.float64) tensor(12.3118, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2705, dtype=torch.float64) delta_t tensor(0.4006, dtype=torch.float64)
4 gae_duplicate tensor(-0.0545, dtype=torch.float64) tensor(-6.7258, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6178, dtype=torch.float64) delta_t tensor(-0.8213, dtype=torch.float64)
3 gae_duplicate tensor(-1.2206, dtype=torch.float64) tensor(14.0273, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6051, dtype=torch.float64) delta_t tensor(0.7623, dtype=torch.float64)
2 gae_duplicate tensor(0.1775, dtype=torch.float64) tensor(-14.3703, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-476.6920471191406
value loss:69.99610137939453
entropies:347.778076171875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3918.8770)
ToM Target loss= tensor(3841.6655)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.220271825790405 seconds
19 rew tensor(1.1427, dtype=torch.float64) delta_t tensor(-0.2350, dtype=torch.float64)
19 gae_duplicate tensor(-0.3836, dtype=torch.float64) tensor(4.8030, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0971, dtype=torch.float64) delta_t tensor(-0.0428, dtype=torch.float64)
18 gae_duplicate tensor(-0.3062, dtype=torch.float64) tensor(1.2298, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9834, dtype=torch.float64) delta_t tensor(0.1738, dtype=torch.float64)
17 gae_duplicate tensor(-0.2274, dtype=torch.float64) tensor(-2.8076, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9136, dtype=torch.float64) delta_t tensor(0.0311, dtype=torch.float64)
16 gae_duplicate tensor(-0.2102, dtype=torch.float64) tensor(-0.7073, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8450, dtype=torch.float64) delta_t tensor(0.2065, dtype=torch.float64)
15 gae_duplicate tensor(0.0102, dtype=torch.float64) tensor(-4.0320, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6062, dtype=torch.float64) delta_t tensor(0.2408, dtype=torch.float64)
14 gae_duplicate tensor(0.1779, dtype=torch.float64) tensor(-4.7625, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7587, dtype=torch.float64) delta_t tensor(0.2811, dtype=torch.float64)
13 gae_duplicate tensor(0.1592, dtype=torch.float64) tensor(-5.9723, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0671, dtype=torch.float64) delta_t tensor(-0.1506, dtype=torch.float64)
12 gae_duplicate tensor(-1.1925, dtype=torch.float64) tensor(1.8718, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5174, dtype=torch.float64) delta_t tensor(0.0975, dtype=torch.float64)
11 gae_duplicate tensor(-0.1373, dtype=torch.float64) tensor(-1.7309, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0980, dtype=torch.float64) delta_t tensor(0.1939, dtype=torch.float64)
10 gae_duplicate tensor(-0.3040, dtype=torch.float64) tensor(-3.6173, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4800, dtype=torch.float64) delta_t tensor(0.4094, dtype=torch.float64)
9 gae_duplicate tensor(-0.1154, dtype=torch.float64) tensor(-8.4025, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6916, dtype=torch.float64) delta_t tensor(-0.1553, dtype=torch.float64)
8 gae_duplicate tensor(-0.4619, dtype=torch.float64) tensor(2.3394, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1664, dtype=torch.float64) delta_t tensor(0.3508, dtype=torch.float64)
7 gae_duplicate tensor(-0.0728, dtype=torch.float64) tensor(-6.9791, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7181, dtype=torch.float64) delta_t tensor(0.2154, dtype=torch.float64)
6 gae_duplicate tensor(0.1156, dtype=torch.float64) tensor(-4.4698, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2667, dtype=torch.float64) delta_t tensor(-0.0335, dtype=torch.float64)
5 gae_duplicate tensor(-0.3354, dtype=torch.float64) tensor(0.2575, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2749, dtype=torch.float64) delta_t tensor(-0.0422, dtype=torch.float64)
4 gae_duplicate tensor(-0.2433, dtype=torch.float64) tensor(0.7503, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6081, dtype=torch.float64) delta_t tensor(-0.0903, dtype=torch.float64)
3 gae_duplicate tensor(-0.4853, dtype=torch.float64) tensor(1.6898, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0732, dtype=torch.float64) delta_t tensor(0.1301, dtype=torch.float64)
2 gae_duplicate tensor(-0.1940, dtype=torch.float64) tensor(-2.3271, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1681.0321044921875
value loss:16.411670684814453
entropies:347.30517578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.01874303817749 seconds
19 rew tensor(1.2523, dtype=torch.float64) delta_t tensor(-0.2417, dtype=torch.float64)
19 gae_duplicate tensor(-0.3629, dtype=torch.float64) tensor(4.6319, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2152, dtype=torch.float64) delta_t tensor(-0.0065, dtype=torch.float64)
18 gae_duplicate tensor(-0.1825, dtype=torch.float64) tensor(0.6500, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0650, dtype=torch.float64) delta_t tensor(0.0511, dtype=torch.float64)
17 gae_duplicate tensor(-0.1326, dtype=torch.float64) tensor(-1.1446, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9350, dtype=torch.float64) delta_t tensor(-0.0681, dtype=torch.float64)
16 gae_duplicate tensor(-0.2747, dtype=torch.float64) tensor(0.8951, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8725, dtype=torch.float64) delta_t tensor(0.2160, dtype=torch.float64)
15 gae_duplicate tensor(-0.0101, dtype=torch.float64) tensor(-4.3985, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0887, dtype=torch.float64) delta_t tensor(-0.3635, dtype=torch.float64)
14 gae_duplicate tensor(-1.4887, dtype=torch.float64) tensor(6.8528, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7007, dtype=torch.float64) delta_t tensor(0.1752, dtype=torch.float64)
13 gae_duplicate tensor(-0.0396, dtype=torch.float64) tensor(-2.7323, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2678, dtype=torch.float64) delta_t tensor(0.0783, dtype=torch.float64)
12 gae_duplicate tensor(-0.1813, dtype=torch.float64) tensor(-1.7940, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5240, dtype=torch.float64) delta_t tensor(0.0160, dtype=torch.float64)
11 gae_duplicate tensor(-0.2917, dtype=torch.float64) tensor(-0.8091, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1209, dtype=torch.float64) delta_t tensor(0.0473, dtype=torch.float64)
10 gae_duplicate tensor(-0.2644, dtype=torch.float64) tensor(-1.1348, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3601, dtype=torch.float64) delta_t tensor(0.4901, dtype=torch.float64)
9 gae_duplicate tensor(0.2371, dtype=torch.float64) tensor(-9.1444, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4699, dtype=torch.float64) delta_t tensor(0.0567, dtype=torch.float64)
8 gae_duplicate tensor(-0.0683, dtype=torch.float64) tensor(-1.8808, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5159, dtype=torch.float64) delta_t tensor(0.0697, dtype=torch.float64)
7 gae_duplicate tensor(-0.4985, dtype=torch.float64) tensor(-1.0880, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6726, dtype=torch.float64) delta_t tensor(0.2754, dtype=torch.float64)
6 gae_duplicate tensor(-0.1339, dtype=torch.float64) tensor(-5.0087, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4048, dtype=torch.float64) delta_t tensor(-0.2253, dtype=torch.float64)
5 gae_duplicate tensor(-0.7152, dtype=torch.float64) tensor(3.5173, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1815, dtype=torch.float64) delta_t tensor(0.0717, dtype=torch.float64)
4 gae_duplicate tensor(-0.1211, dtype=torch.float64) tensor(-0.9927, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7533, dtype=torch.float64) delta_t tensor(-0.1286, dtype=torch.float64)
3 gae_duplicate tensor(-0.8518, dtype=torch.float64) tensor(3.1780, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1781, dtype=torch.float64) delta_t tensor(0.2940, dtype=torch.float64)
2 gae_duplicate tensor(0.0488, dtype=torch.float64) tensor(-5.3568, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:757.3589477539062
value loss:18.791181564331055
entropies:346.8362731933594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.94671106338501 seconds
19 rew tensor(1.2410, dtype=torch.float64) delta_t tensor(-0.1945, dtype=torch.float64)
19 gae_duplicate tensor(-0.3832, dtype=torch.float64) tensor(3.6826, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2053, dtype=torch.float64) delta_t tensor(-0.0614, dtype=torch.float64)
18 gae_duplicate tensor(-0.1922, dtype=torch.float64) tensor(1.5245, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1314, dtype=torch.float64) delta_t tensor(-0.0417, dtype=torch.float64)
17 gae_duplicate tensor(-0.2290, dtype=torch.float64) tensor(1.1030, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6772, dtype=torch.float64) delta_t tensor(-0.1882, dtype=torch.float64)
16 gae_duplicate tensor(-1.2529, dtype=torch.float64) tensor(3.3147, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8962, dtype=torch.float64) delta_t tensor(0.1329, dtype=torch.float64)
15 gae_duplicate tensor(-0.3325, dtype=torch.float64) tensor(-2.1515, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3401, dtype=torch.float64) delta_t tensor(-0.1621, dtype=torch.float64)
14 gae_duplicate tensor(-1.5318, dtype=torch.float64) tensor(2.1916, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6013, dtype=torch.float64) delta_t tensor(0.1297, dtype=torch.float64)
13 gae_duplicate tensor(-0.0961, dtype=torch.float64) tensor(-2.0994, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3819, dtype=torch.float64) delta_t tensor(0.1067, dtype=torch.float64)
12 gae_duplicate tensor(-0.0620, dtype=torch.float64) tensor(-2.3494, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3276, dtype=torch.float64) delta_t tensor(-0.0153, dtype=torch.float64)
11 gae_duplicate tensor(-0.1824, dtype=torch.float64) tensor(0.2014, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0217, dtype=torch.float64) delta_t tensor(0.0590, dtype=torch.float64)
10 gae_duplicate tensor(-0.3105, dtype=torch.float64) tensor(-1.5123, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3098, dtype=torch.float64) delta_t tensor(0.5317, dtype=torch.float64)
9 gae_duplicate tensor(0.2897, dtype=torch.float64) tensor(-9.6566, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4962, dtype=torch.float64) delta_t tensor(-0.1659, dtype=torch.float64)
8 gae_duplicate tensor(-0.4660, dtype=torch.float64) tensor(2.3058, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9657, dtype=torch.float64) delta_t tensor(-0.0420, dtype=torch.float64)
7 gae_duplicate tensor(-0.6363, dtype=torch.float64) tensor(0.9043, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5904, dtype=torch.float64) delta_t tensor(0.3506, dtype=torch.float64)
6 gae_duplicate tensor(0.1801, dtype=torch.float64) tensor(-6.8691, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6502, dtype=torch.float64) delta_t tensor(-0.2690, dtype=torch.float64)
5 gae_duplicate tensor(-0.6907, dtype=torch.float64) tensor(4.7573, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1206, dtype=torch.float64) delta_t tensor(0.2526, dtype=torch.float64)
4 gae_duplicate tensor(-0.1141, dtype=torch.float64) tensor(-4.2126, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2050, dtype=torch.float64) delta_t tensor(-0.4465, dtype=torch.float64)
3 gae_duplicate tensor(-0.8961, dtype=torch.float64) tensor(8.8373, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4956, dtype=torch.float64) delta_t tensor(0.5138, dtype=torch.float64)
2 gae_duplicate tensor(-0.1643, dtype=torch.float64) tensor(-8.2850, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:355.4881591796875
value loss:23.673561096191406
entropies:346.07861328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.061371088027954 seconds
19 rew tensor(1.1799, dtype=torch.float64) delta_t tensor(-0.1350, dtype=torch.float64)
19 gae_duplicate tensor(-0.3068, dtype=torch.float64) tensor(2.4614, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1818, dtype=torch.float64) delta_t tensor(0.0035, dtype=torch.float64)
18 gae_duplicate tensor(-0.1876, dtype=torch.float64) tensor(0.3045, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1093, dtype=torch.float64) delta_t tensor(0.0228, dtype=torch.float64)
17 gae_duplicate tensor(-0.1745, dtype=torch.float64) tensor(-0.2697, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0614, dtype=torch.float64) delta_t tensor(0.1256, dtype=torch.float64)
16 gae_duplicate tensor(-0.1803, dtype=torch.float64) tensor(-2.3827, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9333, dtype=torch.float64) delta_t tensor(0.0377, dtype=torch.float64)
15 gae_duplicate tensor(-0.2720, dtype=torch.float64) tensor(-0.9652, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8300, dtype=torch.float64) delta_t tensor(0.2628, dtype=torch.float64)
14 gae_duplicate tensor(0.1000, dtype=torch.float64) tensor(-5.1781, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.3677, dtype=torch.float64) delta_t tensor(-0.8692, dtype=torch.float64)
13 gae_duplicate tensor(-4.2386, dtype=torch.float64) tensor(19.9523, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1458, dtype=torch.float64) delta_t tensor(-0.1461, dtype=torch.float64)
12 gae_duplicate tensor(-1.2240, dtype=torch.float64) tensor(4.0291, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4457, dtype=torch.float64) delta_t tensor(0.0427, dtype=torch.float64)
11 gae_duplicate tensor(-0.2519, dtype=torch.float64) tensor(-0.6590, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0514, dtype=torch.float64) delta_t tensor(0.1868, dtype=torch.float64)
10 gae_duplicate tensor(-0.2193, dtype=torch.float64) tensor(-4.8810, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4170, dtype=torch.float64) delta_t tensor(0.4132, dtype=torch.float64)
9 gae_duplicate tensor(-0.0094, dtype=torch.float64) tensor(-7.5229, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6240, dtype=torch.float64) delta_t tensor(-0.0319, dtype=torch.float64)
8 gae_duplicate tensor(-0.2720, dtype=torch.float64) tensor(0.0518, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1109, dtype=torch.float64) delta_t tensor(-0.2739, dtype=torch.float64)
7 gae_duplicate tensor(-2.4590, dtype=torch.float64) tensor(6.5272, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7544, dtype=torch.float64) delta_t tensor(0.1406, dtype=torch.float64)
6 gae_duplicate tensor(-0.5853, dtype=torch.float64) tensor(-1.2787, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4182, dtype=torch.float64) delta_t tensor(-0.0805, dtype=torch.float64)
5 gae_duplicate tensor(-0.6542, dtype=torch.float64) tensor(1.2082, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0042, dtype=torch.float64) delta_t tensor(0.1436, dtype=torch.float64)
4 gae_duplicate tensor(-0.1686, dtype=torch.float64) tensor(-2.8101, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0430, dtype=torch.float64) delta_t tensor(-0.3252, dtype=torch.float64)
3 gae_duplicate tensor(-0.7323, dtype=torch.float64) tensor(5.2996, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3668, dtype=torch.float64) delta_t tensor(0.4396, dtype=torch.float64)
2 gae_duplicate tensor(-0.1483, dtype=torch.float64) tensor(-7.5077, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-437.6645202636719
value loss:57.84455871582031
entropies:345.1636047363281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.358325004577637 seconds
19 rew tensor(1.1229, dtype=torch.float64) delta_t tensor(-0.2550, dtype=torch.float64)
19 gae_duplicate tensor(-0.3575, dtype=torch.float64) tensor(4.9115, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1139, dtype=torch.float64) delta_t tensor(0.0093, dtype=torch.float64)
18 gae_duplicate tensor(-0.2934, dtype=torch.float64) tensor(0.1465, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9323, dtype=torch.float64) delta_t tensor(0.0320, dtype=torch.float64)
17 gae_duplicate tensor(-0.3499, dtype=torch.float64) tensor(-1.2614, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9730, dtype=torch.float64) delta_t tensor(0.1780, dtype=torch.float64)
16 gae_duplicate tensor(-0.1373, dtype=torch.float64) tensor(-3.1458, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8452, dtype=torch.float64) delta_t tensor(0.1237, dtype=torch.float64)
15 gae_duplicate tensor(0.0273, dtype=torch.float64) tensor(-2.6988, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6466, dtype=torch.float64) delta_t tensor(0.1923, dtype=torch.float64)
14 gae_duplicate tensor(0.0808, dtype=torch.float64) tensor(-4.6751, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7193, dtype=torch.float64) delta_t tensor(0.1774, dtype=torch.float64)
13 gae_duplicate tensor(0.0710, dtype=torch.float64) tensor(-3.5611, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2492, dtype=torch.float64) delta_t tensor(-0.0470, dtype=torch.float64)
12 gae_duplicate tensor(-0.2760, dtype=torch.float64) tensor(0.4027, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6257, dtype=torch.float64) delta_t tensor(0.1313, dtype=torch.float64)
11 gae_duplicate tensor(-0.1645, dtype=torch.float64) tensor(-2.5387, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1265, dtype=torch.float64) delta_t tensor(-0.1215, dtype=torch.float64)
10 gae_duplicate tensor(-0.3100, dtype=torch.float64) tensor(2.1580, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3618, dtype=torch.float64) delta_t tensor(0.3238, dtype=torch.float64)
9 gae_duplicate tensor(-0.1246, dtype=torch.float64) tensor(-5.3404, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4955, dtype=torch.float64) delta_t tensor(-0.0945, dtype=torch.float64)
8 gae_duplicate tensor(-0.5611, dtype=torch.float64) tensor(1.2897, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3838, dtype=torch.float64) delta_t tensor(0.1173, dtype=torch.float64)
7 gae_duplicate tensor(-0.1525, dtype=torch.float64) tensor(-1.9622, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7596, dtype=torch.float64) delta_t tensor(0.2151, dtype=torch.float64)
6 gae_duplicate tensor(0.0323, dtype=torch.float64) tensor(-4.4575, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2115, dtype=torch.float64) delta_t tensor(-0.0545, dtype=torch.float64)
5 gae_duplicate tensor(-0.2638, dtype=torch.float64) tensor(0.5573, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1844, dtype=torch.float64) delta_t tensor(0.0393, dtype=torch.float64)
4 gae_duplicate tensor(-0.2607, dtype=torch.float64) tensor(-0.5716, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5230, dtype=torch.float64) delta_t tensor(-0.0705, dtype=torch.float64)
3 gae_duplicate tensor(-0.6264, dtype=torch.float64) tensor(1.1263, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0892, dtype=torch.float64) delta_t tensor(0.0919, dtype=torch.float64)
2 gae_duplicate tensor(-0.6600, dtype=torch.float64) tensor(-1.8959, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1069.006103515625
value loss:14.007368087768555
entropies:344.04107666015625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3933.9121)
ToM Target loss= tensor(3826.8367)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.490358114242554 seconds
19 rew tensor(1.1936, dtype=torch.float64) delta_t tensor(-0.1810, dtype=torch.float64)
19 gae_duplicate tensor(-0.3317, dtype=torch.float64) tensor(3.3952, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1828, dtype=torch.float64) delta_t tensor(-0.0228, dtype=torch.float64)
18 gae_duplicate tensor(-0.1084, dtype=torch.float64) tensor(0.7142, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1211, dtype=torch.float64) delta_t tensor(0.0773, dtype=torch.float64)
17 gae_duplicate tensor(-0.1544, dtype=torch.float64) tensor(-1.3330, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0279, dtype=torch.float64) delta_t tensor(0.0374, dtype=torch.float64)
16 gae_duplicate tensor(-0.2450, dtype=torch.float64) tensor(-1.0734, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9819, dtype=torch.float64) delta_t tensor(0.1978, dtype=torch.float64)
15 gae_duplicate tensor(0.0320, dtype=torch.float64) tensor(-3.9296, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5823, dtype=torch.float64) delta_t tensor(0.1521, dtype=torch.float64)
14 gae_duplicate tensor(-0.1133, dtype=torch.float64) tensor(-3.0199, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8091, dtype=torch.float64) delta_t tensor(0.2340, dtype=torch.float64)
13 gae_duplicate tensor(0.0982, dtype=torch.float64) tensor(-4.7039, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2033, dtype=torch.float64) delta_t tensor(-0.0036, dtype=torch.float64)
12 gae_duplicate tensor(-0.3171, dtype=torch.float64) tensor(-0.3017, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5660, dtype=torch.float64) delta_t tensor(0.0703, dtype=torch.float64)
11 gae_duplicate tensor(-0.3563, dtype=torch.float64) tensor(-1.0208, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0673, dtype=torch.float64) delta_t tensor(0.0135, dtype=torch.float64)
10 gae_duplicate tensor(-0.3852, dtype=torch.float64) tensor(-0.3620, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4507, dtype=torch.float64) delta_t tensor(0.4878, dtype=torch.float64)
9 gae_duplicate tensor(0.0644, dtype=torch.float64) tensor(-9.2846, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7042, dtype=torch.float64) delta_t tensor(-0.1141, dtype=torch.float64)
8 gae_duplicate tensor(-0.5645, dtype=torch.float64) tensor(1.1215, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5117, dtype=torch.float64) delta_t tensor(-0.7942, dtype=torch.float64)
7 gae_duplicate tensor(-4.1942, dtype=torch.float64) tensor(16.7457, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9431, dtype=torch.float64) delta_t tensor(-0.1482, dtype=torch.float64)
6 gae_duplicate tensor(-1.1610, dtype=torch.float64) tensor(3.9387, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2691, dtype=torch.float64) delta_t tensor(0.0192, dtype=torch.float64)
5 gae_duplicate tensor(-0.4389, dtype=torch.float64) tensor(-0.1876, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0119, dtype=torch.float64) delta_t tensor(0.1750, dtype=torch.float64)
4 gae_duplicate tensor(-0.2435, dtype=torch.float64) tensor(-3.5216, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0630, dtype=torch.float64) delta_t tensor(-0.4173, dtype=torch.float64)
3 gae_duplicate tensor(-0.9816, dtype=torch.float64) tensor(6.9210, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3649, dtype=torch.float64) delta_t tensor(0.3791, dtype=torch.float64)
2 gae_duplicate tensor(-0.3343, dtype=torch.float64) tensor(-6.7525, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:50.71051788330078
value loss:53.13467025756836
entropies:343.0413818359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.850020885467529 seconds
19 rew tensor(1.1276, dtype=torch.float64) delta_t tensor(-0.2284, dtype=torch.float64)
19 gae_duplicate tensor(-0.3758, dtype=torch.float64) tensor(4.0991, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0676, dtype=torch.float64) delta_t tensor(-0.0398, dtype=torch.float64)
18 gae_duplicate tensor(-0.2337, dtype=torch.float64) tensor(1.2786, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0379, dtype=torch.float64) delta_t tensor(-0.0264, dtype=torch.float64)
17 gae_duplicate tensor(-0.2653, dtype=torch.float64) tensor(0.4192, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9661, dtype=torch.float64) delta_t tensor(0.0436, dtype=torch.float64)
16 gae_duplicate tensor(-0.1554, dtype=torch.float64) tensor(-0.6992, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8591, dtype=torch.float64) delta_t tensor(0.1485, dtype=torch.float64)
15 gae_duplicate tensor(-0.0201, dtype=torch.float64) tensor(-2.8992, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7049, dtype=torch.float64) delta_t tensor(0.2135, dtype=torch.float64)
14 gae_duplicate tensor(0.0977, dtype=torch.float64) tensor(-4.3624, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6873, dtype=torch.float64) delta_t tensor(0.0387, dtype=torch.float64)
13 gae_duplicate tensor(-0.0714, dtype=torch.float64) tensor(-1.1040, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2642, dtype=torch.float64) delta_t tensor(-0.0083, dtype=torch.float64)
12 gae_duplicate tensor(-0.4590, dtype=torch.float64) tensor(-0.3983, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5974, dtype=torch.float64) delta_t tensor(0.0327, dtype=torch.float64)
11 gae_duplicate tensor(-0.1295, dtype=torch.float64) tensor(-0.7057, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1056, dtype=torch.float64) delta_t tensor(-0.0227, dtype=torch.float64)
10 gae_duplicate tensor(-0.3742, dtype=torch.float64) tensor(0.2231, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4577, dtype=torch.float64) delta_t tensor(0.3971, dtype=torch.float64)
9 gae_duplicate tensor(0.2200, dtype=torch.float64) tensor(-7.2684, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5631, dtype=torch.float64) delta_t tensor(-0.0295, dtype=torch.float64)
8 gae_duplicate tensor(-0.2704, dtype=torch.float64) tensor(0.0448, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4809, dtype=torch.float64) delta_t tensor(0.1973, dtype=torch.float64)
7 gae_duplicate tensor(-0.0589, dtype=torch.float64) tensor(-3.5522, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7795, dtype=torch.float64) delta_t tensor(0.0830, dtype=torch.float64)
6 gae_duplicate tensor(-0.3799, dtype=torch.float64) tensor(-1.7683, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2489, dtype=torch.float64) delta_t tensor(-0.1285, dtype=torch.float64)
5 gae_duplicate tensor(-0.4802, dtype=torch.float64) tensor(3.4719, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2417, dtype=torch.float64) delta_t tensor(-0.0454, dtype=torch.float64)
4 gae_duplicate tensor(-0.4137, dtype=torch.float64) tensor(0.9627, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6555, dtype=torch.float64) delta_t tensor(-0.1457, dtype=torch.float64)
3 gae_duplicate tensor(-0.7436, dtype=torch.float64) tensor(2.2517, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1324, dtype=torch.float64) delta_t tensor(0.1463, dtype=torch.float64)
2 gae_duplicate tensor(-0.2341, dtype=torch.float64) tensor(-2.0447, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:558.4057006835938
value loss:11.57824993133545
entropies:342.0648193359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.859909772872925 seconds
19 rew tensor(1.1446, dtype=torch.float64) delta_t tensor(-0.2130, dtype=torch.float64)
19 gae_duplicate tensor(-0.2965, dtype=torch.float64) tensor(4.0395, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1594, dtype=torch.float64) delta_t tensor(-0.0265, dtype=torch.float64)
18 gae_duplicate tensor(-0.1274, dtype=torch.float64) tensor(0.8528, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0597, dtype=torch.float64) delta_t tensor(-0.0097, dtype=torch.float64)
17 gae_duplicate tensor(-0.1108, dtype=torch.float64) tensor(-0.0109, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8532, dtype=torch.float64) delta_t tensor(0.0055, dtype=torch.float64)
16 gae_duplicate tensor(-0.3715, dtype=torch.float64) tensor(0.2203, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8013, dtype=torch.float64) delta_t tensor(0.0439, dtype=torch.float64)
15 gae_duplicate tensor(-0.2866, dtype=torch.float64) tensor(-1.1751, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6113, dtype=torch.float64) delta_t tensor(0.1021, dtype=torch.float64)
14 gae_duplicate tensor(0.0399, dtype=torch.float64) tensor(-2.2964, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7350, dtype=torch.float64) delta_t tensor(0.1072, dtype=torch.float64)
13 gae_duplicate tensor(0.0250, dtype=torch.float64) tensor(-2.1370, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3036, dtype=torch.float64) delta_t tensor(-0.1577, dtype=torch.float64)
12 gae_duplicate tensor(-0.3864, dtype=torch.float64) tensor(2.1667, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4448, dtype=torch.float64) delta_t tensor(-0.0047, dtype=torch.float64)
11 gae_duplicate tensor(-0.4635, dtype=torch.float64) tensor(0.4742, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1183, dtype=torch.float64) delta_t tensor(-0.0460, dtype=torch.float64)
10 gae_duplicate tensor(-0.3289, dtype=torch.float64) tensor(0.6545, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1374, dtype=torch.float64) delta_t tensor(0.1179, dtype=torch.float64)
9 gae_duplicate tensor(-0.0317, dtype=torch.float64) tensor(-1.9709, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5022, dtype=torch.float64) delta_t tensor(0.0243, dtype=torch.float64)
8 gae_duplicate tensor(-0.2857, dtype=torch.float64) tensor(-0.7115, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6388, dtype=torch.float64) delta_t tensor(-0.0330, dtype=torch.float64)
7 gae_duplicate tensor(-0.4030, dtype=torch.float64) tensor(0.5252, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5826, dtype=torch.float64) delta_t tensor(0.2031, dtype=torch.float64)
6 gae_duplicate tensor(0.0626, dtype=torch.float64) tensor(-3.6103, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5304, dtype=torch.float64) delta_t tensor(-0.2258, dtype=torch.float64)
5 gae_duplicate tensor(-0.6806, dtype=torch.float64) tensor(3.6570, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0912, dtype=torch.float64) delta_t tensor(0.0063, dtype=torch.float64)
4 gae_duplicate tensor(-0.3180, dtype=torch.float64) tensor(0.2280, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8738, dtype=torch.float64) delta_t tensor(-0.4008, dtype=torch.float64)
3 gae_duplicate tensor(-0.9089, dtype=torch.float64) tensor(7.8114, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2847, dtype=torch.float64) delta_t tensor(0.2179, dtype=torch.float64)
2 gae_duplicate tensor(-0.0788, dtype=torch.float64) tensor(-3.5356, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-371.88641357421875
value loss:11.052339553833008
entropies:340.9874267578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.932685136795044 seconds
19 rew tensor(1.2260, dtype=torch.float64) delta_t tensor(-0.0800, dtype=torch.float64)
19 gae_duplicate tensor(-0.2301, dtype=torch.float64) tensor(1.5816, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1240, dtype=torch.float64) delta_t tensor(0.0350, dtype=torch.float64)
18 gae_duplicate tensor(-0.2082, dtype=torch.float64) tensor(-0.9891, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0083, dtype=torch.float64) delta_t tensor(-0.0078, dtype=torch.float64)
17 gae_duplicate tensor(-0.2114, dtype=torch.float64) tensor(0.0998, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9446, dtype=torch.float64) delta_t tensor(0.0196, dtype=torch.float64)
16 gae_duplicate tensor(-0.1853, dtype=torch.float64) tensor(-0.4598, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6346, dtype=torch.float64) delta_t tensor(-0.1236, dtype=torch.float64)
15 gae_duplicate tensor(-1.2814, dtype=torch.float64) tensor(1.8796, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7770, dtype=torch.float64) delta_t tensor(0.1636, dtype=torch.float64)
14 gae_duplicate tensor(0.0009, dtype=torch.float64) tensor(-2.9563, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6046, dtype=torch.float64) delta_t tensor(0.0671, dtype=torch.float64)
13 gae_duplicate tensor(-0.1368, dtype=torch.float64) tensor(-1.4063, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4311, dtype=torch.float64) delta_t tensor(0.0772, dtype=torch.float64)
12 gae_duplicate tensor(-0.3670, dtype=torch.float64) tensor(-1.0807, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2546, dtype=torch.float64) delta_t tensor(-0.2063, dtype=torch.float64)
11 gae_duplicate tensor(-0.3135, dtype=torch.float64) tensor(3.3668, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1056, dtype=torch.float64) delta_t tensor(0.0843, dtype=torch.float64)
10 gae_duplicate tensor(-0.2320, dtype=torch.float64) tensor(-1.0925, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3821, dtype=torch.float64) delta_t tensor(0.4035, dtype=torch.float64)
9 gae_duplicate tensor(0.0161, dtype=torch.float64) tensor(-8.4857, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5012, dtype=torch.float64) delta_t tensor(-0.0829, dtype=torch.float64)
8 gae_duplicate tensor(-0.5206, dtype=torch.float64) tensor(0.7103, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9188, dtype=torch.float64) delta_t tensor(0.1127, dtype=torch.float64)
7 gae_duplicate tensor(-0.1635, dtype=torch.float64) tensor(-1.9340, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6076, dtype=torch.float64) delta_t tensor(0.1491, dtype=torch.float64)
6 gae_duplicate tensor(-0.0460, dtype=torch.float64) tensor(-2.9054, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7622, dtype=torch.float64) delta_t tensor(-0.3168, dtype=torch.float64)
5 gae_duplicate tensor(-0.6204, dtype=torch.float64) tensor(6.4232, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0175, dtype=torch.float64) delta_t tensor(0.0212, dtype=torch.float64)
4 gae_duplicate tensor(-0.2790, dtype=torch.float64) tensor(0.2527, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2420, dtype=torch.float64) delta_t tensor(-0.5377, dtype=torch.float64)
3 gae_duplicate tensor(-0.7433, dtype=torch.float64) tensor(10.2459, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3072, dtype=torch.float64) delta_t tensor(0.1686, dtype=torch.float64)
2 gae_duplicate tensor(-0.2590, dtype=torch.float64) tensor(-1.6972, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-175.75222778320312
value loss:15.662227630615234
entropies:340.3627014160156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.67523980140686 seconds
19 rew tensor(1.1830, dtype=torch.float64) delta_t tensor(-0.1561, dtype=torch.float64)
19 gae_duplicate tensor(-0.3606, dtype=torch.float64) tensor(3.3428, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1851, dtype=torch.float64) delta_t tensor(-0.0218, dtype=torch.float64)
18 gae_duplicate tensor(-0.2896, dtype=torch.float64) tensor(0.8328, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8483, dtype=torch.float64) delta_t tensor(-0.2428, dtype=torch.float64)
17 gae_duplicate tensor(-1.1808, dtype=torch.float64) tensor(5.5896, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0867, dtype=torch.float64) delta_t tensor(0.1843, dtype=torch.float64)
16 gae_duplicate tensor(-0.1975, dtype=torch.float64) tensor(-2.7164, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8183, dtype=torch.float64) delta_t tensor(0.0715, dtype=torch.float64)
15 gae_duplicate tensor(-0.0405, dtype=torch.float64) tensor(-1.6271, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3977, dtype=torch.float64) delta_t tensor(-0.3545, dtype=torch.float64)
14 gae_duplicate tensor(-2.8939, dtype=torch.float64) tensor(5.9883, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5192, dtype=torch.float64) delta_t tensor(0.0282, dtype=torch.float64)
13 gae_duplicate tensor(-0.1896, dtype=torch.float64) tensor(0.1216, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5787, dtype=torch.float64) delta_t tensor(0.0396, dtype=torch.float64)
12 gae_duplicate tensor(-0.0557, dtype=torch.float64) tensor(-0.5777, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1594, dtype=torch.float64) delta_t tensor(-0.0796, dtype=torch.float64)
11 gae_duplicate tensor(-0.2144, dtype=torch.float64) tensor(1.6866, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2391, dtype=torch.float64) delta_t tensor(0.1996, dtype=torch.float64)
10 gae_duplicate tensor(-0.1768, dtype=torch.float64) tensor(-3.7908, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0327, dtype=torch.float64) delta_t tensor(0.2935, dtype=torch.float64)
9 gae_duplicate tensor(0.0447, dtype=torch.float64) tensor(-5.2860, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3530, dtype=torch.float64) delta_t tensor(0.0285, dtype=torch.float64)
8 gae_duplicate tensor(-0.3429, dtype=torch.float64) tensor(-1.5176, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4900, dtype=torch.float64) delta_t tensor(-0.2467, dtype=torch.float64)
7 gae_duplicate tensor(-0.8344, dtype=torch.float64) tensor(4.1151, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4863, dtype=torch.float64) delta_t tensor(0.1812, dtype=torch.float64)
6 gae_duplicate tensor(-0.3109, dtype=torch.float64) tensor(-2.7203, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9346, dtype=torch.float64) delta_t tensor(-0.3026, dtype=torch.float64)
5 gae_duplicate tensor(-0.4797, dtype=torch.float64) tensor(5.6581, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3711, dtype=torch.float64) delta_t tensor(0.2879, dtype=torch.float64)
4 gae_duplicate tensor(-0.0860, dtype=torch.float64) tensor(-4.8469, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6574, dtype=torch.float64) delta_t tensor(-0.6530, dtype=torch.float64)
3 gae_duplicate tensor(-0.8932, dtype=torch.float64) tensor(11.5740, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.7218, dtype=torch.float64) delta_t tensor(0.5505, dtype=torch.float64)
2 gae_duplicate tensor(0.0271, dtype=torch.float64) tensor(-8.7657, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-473.0042419433594
value loss:31.092500686645508
entropies:339.77459716796875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3894.5891)
ToM Target loss= tensor(3817.7073)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.250608921051025 seconds
19 rew tensor(1.1750, dtype=torch.float64) delta_t tensor(-0.1535, dtype=torch.float64)
19 gae_duplicate tensor(-0.2803, dtype=torch.float64) tensor(2.7450, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1770, dtype=torch.float64) delta_t tensor(0.0126, dtype=torch.float64)
18 gae_duplicate tensor(-0.2111, dtype=torch.float64) tensor(0.1602, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1224, dtype=torch.float64) delta_t tensor(0.0786, dtype=torch.float64)
17 gae_duplicate tensor(-0.1515, dtype=torch.float64) tensor(-1.3043, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9906, dtype=torch.float64) delta_t tensor(-0.0606, dtype=torch.float64)
16 gae_duplicate tensor(-0.2873, dtype=torch.float64) tensor(1.3970, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0194, dtype=torch.float64) delta_t tensor(0.2508, dtype=torch.float64)
15 gae_duplicate tensor(-0.2724, dtype=torch.float64) tensor(-5.0920, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.1677, dtype=torch.float64) delta_t tensor(-0.5560, dtype=torch.float64)
14 gae_duplicate tensor(-2.6410, dtype=torch.float64) tensor(9.6747, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7205, dtype=torch.float64) delta_t tensor(0.0313, dtype=torch.float64)
13 gae_duplicate tensor(-0.5798, dtype=torch.float64) tensor(0.2274, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2048, dtype=torch.float64) delta_t tensor(-0.0989, dtype=torch.float64)
12 gae_duplicate tensor(-0.3784, dtype=torch.float64) tensor(2.1563, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6566, dtype=torch.float64) delta_t tensor(0.0406, dtype=torch.float64)
11 gae_duplicate tensor(-0.2677, dtype=torch.float64) tensor(-0.5597, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1787, dtype=torch.float64) delta_t tensor(-0.1104, dtype=torch.float64)
10 gae_duplicate tensor(-0.2145, dtype=torch.float64) tensor(2.0003, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4719, dtype=torch.float64) delta_t tensor(0.2463, dtype=torch.float64)
9 gae_duplicate tensor(-0.2413, dtype=torch.float64) tensor(-3.7402, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6294, dtype=torch.float64) delta_t tensor(-0.1519, dtype=torch.float64)
8 gae_duplicate tensor(-0.3970, dtype=torch.float64) tensor(2.7773, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4768, dtype=torch.float64) delta_t tensor(0.2368, dtype=torch.float64)
7 gae_duplicate tensor(-0.0821, dtype=torch.float64) tensor(-5.3104, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7192, dtype=torch.float64) delta_t tensor(0.1407, dtype=torch.float64)
6 gae_duplicate tensor(0.1019, dtype=torch.float64) tensor(-3.1399, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3862, dtype=torch.float64) delta_t tensor(0.0072, dtype=torch.float64)
5 gae_duplicate tensor(-0.2954, dtype=torch.float64) tensor(-0.2679, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0814, dtype=torch.float64) delta_t tensor(-0.0701, dtype=torch.float64)
4 gae_duplicate tensor(-0.4052, dtype=torch.float64) tensor(1.3646, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8869, dtype=torch.float64) delta_t tensor(-0.4066, dtype=torch.float64)
3 gae_duplicate tensor(-0.5813, dtype=torch.float64) tensor(6.9609, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2804, dtype=torch.float64) delta_t tensor(0.1241, dtype=torch.float64)
2 gae_duplicate tensor(-0.3561, dtype=torch.float64) tensor(-1.7814, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-537.978271484375
value loss:23.063304901123047
entropies:338.95660400390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.225656032562256 seconds
19 rew tensor(1.1607, dtype=torch.float64) delta_t tensor(-0.1284, dtype=torch.float64)
19 gae_duplicate tensor(-0.2862, dtype=torch.float64) tensor(2.5127, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1231, dtype=torch.float64) delta_t tensor(-0.0394, dtype=torch.float64)
18 gae_duplicate tensor(-0.1414, dtype=torch.float64) tensor(0.9819, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0317, dtype=torch.float64) delta_t tensor(0.0659, dtype=torch.float64)
17 gae_duplicate tensor(-0.2163, dtype=torch.float64) tensor(-1.3274, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0630, dtype=torch.float64) delta_t tensor(0.0092, dtype=torch.float64)
16 gae_duplicate tensor(-0.1609, dtype=torch.float64) tensor(-0.2787, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9692, dtype=torch.float64) delta_t tensor(0.0469, dtype=torch.float64)
15 gae_duplicate tensor(-0.2754, dtype=torch.float64) tensor(-1.0357, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8859, dtype=torch.float64) delta_t tensor(0.2351, dtype=torch.float64)
14 gae_duplicate tensor(0.0444, dtype=torch.float64) tensor(-4.7321, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0523, dtype=torch.float64) delta_t tensor(-0.6503, dtype=torch.float64)
13 gae_duplicate tensor(-2.9971, dtype=torch.float64) tensor(10.4539, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1294, dtype=torch.float64) delta_t tensor(-0.2404, dtype=torch.float64)
12 gae_duplicate tensor(-1.3515, dtype=torch.float64) tensor(5.3267, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1385, dtype=torch.float64) delta_t tensor(-0.6723, dtype=torch.float64)
11 gae_duplicate tensor(-3.0108, dtype=torch.float64) tensor(12.0699, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0033, dtype=torch.float64) delta_t tensor(0.1281, dtype=torch.float64)
10 gae_duplicate tensor(-0.1428, dtype=torch.float64) tensor(-1.2371, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3331, dtype=torch.float64) delta_t tensor(0.2307, dtype=torch.float64)
9 gae_duplicate tensor(-0.1836, dtype=torch.float64) tensor(-4.9216, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5167, dtype=torch.float64) delta_t tensor(-0.0557, dtype=torch.float64)
8 gae_duplicate tensor(-0.2080, dtype=torch.float64) tensor(0.5150, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7564, dtype=torch.float64) delta_t tensor(0.2411, dtype=torch.float64)
7 gae_duplicate tensor(-0.1320, dtype=torch.float64) tensor(-3.9161, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6371, dtype=torch.float64) delta_t tensor(0.0666, dtype=torch.float64)
6 gae_duplicate tensor(-0.0339, dtype=torch.float64) tensor(-1.8562, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6083, dtype=torch.float64) delta_t tensor(-0.0565, dtype=torch.float64)
5 gae_duplicate tensor(-0.4579, dtype=torch.float64) tensor(0.7762, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0118, dtype=torch.float64) delta_t tensor(-0.0519, dtype=torch.float64)
4 gae_duplicate tensor(-0.2813, dtype=torch.float64) tensor(0.9325, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1065, dtype=torch.float64) delta_t tensor(-0.4477, dtype=torch.float64)
3 gae_duplicate tensor(-0.7747, dtype=torch.float64) tensor(7.8029, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3133, dtype=torch.float64) delta_t tensor(0.1536, dtype=torch.float64)
2 gae_duplicate tensor(-0.3028, dtype=torch.float64) tensor(-2.5102, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1147.4078369140625
value loss:42.47855758666992
entropies:338.3166198730469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.88588285446167 seconds
19 rew tensor(1.2170, dtype=torch.float64) delta_t tensor(-0.0604, dtype=torch.float64)
19 gae_duplicate tensor(-0.1883, dtype=torch.float64) tensor(1.1868, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1418, dtype=torch.float64) delta_t tensor(0.0119, dtype=torch.float64)
18 gae_duplicate tensor(-0.1583, dtype=torch.float64) tensor(-0.1690, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1172, dtype=torch.float64) delta_t tensor(0.1264, dtype=torch.float64)
17 gae_duplicate tensor(-0.1079, dtype=torch.float64) tensor(-2.2288, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0510, dtype=torch.float64) delta_t tensor(0.0581, dtype=torch.float64)
16 gae_duplicate tensor(-0.1306, dtype=torch.float64) tensor(-1.4617, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8451, dtype=torch.float64) delta_t tensor(0.0408, dtype=torch.float64)
15 gae_duplicate tensor(-0.1039, dtype=torch.float64) tensor(-1.1142, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7059, dtype=torch.float64) delta_t tensor(0.1942, dtype=torch.float64)
14 gae_duplicate tensor(0.0453, dtype=torch.float64) tensor(-3.9858, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4298, dtype=torch.float64) delta_t tensor(-0.2285, dtype=torch.float64)
13 gae_duplicate tensor(-1.4652, dtype=torch.float64) tensor(3.5086, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1965, dtype=torch.float64) delta_t tensor(-0.1433, dtype=torch.float64)
12 gae_duplicate tensor(-0.5473, dtype=torch.float64) tensor(3.2888, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4880, dtype=torch.float64) delta_t tensor(-0.1276, dtype=torch.float64)
11 gae_duplicate tensor(-0.3031, dtype=torch.float64) tensor(2.7220, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1211, dtype=torch.float64) delta_t tensor(-0.0252, dtype=torch.float64)
10 gae_duplicate tensor(-0.2365, dtype=torch.float64) tensor(0.7967, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4349, dtype=torch.float64) delta_t tensor(0.1586, dtype=torch.float64)
9 gae_duplicate tensor(-0.1303, dtype=torch.float64) tensor(-2.9062, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4770, dtype=torch.float64) delta_t tensor(0.0411, dtype=torch.float64)
8 gae_duplicate tensor(-0.0701, dtype=torch.float64) tensor(-1.0040, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3098, dtype=torch.float64) delta_t tensor(0.1508, dtype=torch.float64)
7 gae_duplicate tensor(-0.0156, dtype=torch.float64) tensor(-3.1853, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9576, dtype=torch.float64) delta_t tensor(-0.0896, dtype=torch.float64)
6 gae_duplicate tensor(-0.5818, dtype=torch.float64) tensor(1.3250, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0076, dtype=torch.float64) delta_t tensor(-0.0859, dtype=torch.float64)
5 gae_duplicate tensor(-0.3155, dtype=torch.float64) tensor(1.9437, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4530, dtype=torch.float64) delta_t tensor(-0.2167, dtype=torch.float64)
4 gae_duplicate tensor(-0.6507, dtype=torch.float64) tensor(5.9293, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3193, dtype=torch.float64) delta_t tensor(0.0164, dtype=torch.float64)
3 gae_duplicate tensor(-0.5742, dtype=torch.float64) tensor(0.7772, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1140, dtype=torch.float64) delta_t tensor(-0.0975, dtype=torch.float64)
2 gae_duplicate tensor(-0.5943, dtype=torch.float64) tensor(1.3458, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-456.8197937011719
value loss:13.033896446228027
entropies:338.127197265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.804734945297241 seconds
19 rew tensor(1.2278, dtype=torch.float64) delta_t tensor(-0.0267, dtype=torch.float64)
19 gae_duplicate tensor(-0.1671, dtype=torch.float64) tensor(0.6317, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1925, dtype=torch.float64) delta_t tensor(0.0920, dtype=torch.float64)
18 gae_duplicate tensor(-0.0780, dtype=torch.float64) tensor(-1.4703, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0372, dtype=torch.float64) delta_t tensor(-0.0187, dtype=torch.float64)
17 gae_duplicate tensor(-0.1665, dtype=torch.float64) tensor(0.1993, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9979, dtype=torch.float64) delta_t tensor(0.0990, dtype=torch.float64)
16 gae_duplicate tensor(-0.1915, dtype=torch.float64) tensor(-1.7660, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8588, dtype=torch.float64) delta_t tensor(0.1789, dtype=torch.float64)
15 gae_duplicate tensor(0.0636, dtype=torch.float64) tensor(-3.1999, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2385, dtype=torch.float64) delta_t tensor(-0.3021, dtype=torch.float64)
14 gae_duplicate tensor(-1.4649, dtype=torch.float64) tensor(5.9617, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3410, dtype=torch.float64) delta_t tensor(-0.1669, dtype=torch.float64)
13 gae_duplicate tensor(-1.4534, dtype=torch.float64) tensor(4.7675, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4439, dtype=torch.float64) delta_t tensor(-0.0107, dtype=torch.float64)
12 gae_duplicate tensor(-0.2986, dtype=torch.float64) tensor(0.5293, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2511, dtype=torch.float64) delta_t tensor(-0.6992, dtype=torch.float64)
11 gae_duplicate tensor(-3.5107, dtype=torch.float64) tensor(11.9130, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0297, dtype=torch.float64) delta_t tensor(0.1632, dtype=torch.float64)
10 gae_duplicate tensor(-0.0962, dtype=torch.float64) tensor(-1.4876, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3602, dtype=torch.float64) delta_t tensor(0.1463, dtype=torch.float64)
9 gae_duplicate tensor(-0.2116, dtype=torch.float64) tensor(-2.6013, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6424, dtype=torch.float64) delta_t tensor(-0.0009, dtype=torch.float64)
8 gae_duplicate tensor(-0.3715, dtype=torch.float64) tensor(-0.4015, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4229, dtype=torch.float64) delta_t tensor(0.2570, dtype=torch.float64)
7 gae_duplicate tensor(-0.1542, dtype=torch.float64) tensor(-4.2025, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6926, dtype=torch.float64) delta_t tensor(0.1006, dtype=torch.float64)
6 gae_duplicate tensor(-0.1318, dtype=torch.float64) tensor(-2.3256, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4886, dtype=torch.float64) delta_t tensor(-0.1234, dtype=torch.float64)
5 gae_duplicate tensor(-0.4819, dtype=torch.float64) tensor(1.9153, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2388, dtype=torch.float64) delta_t tensor(-0.2114, dtype=torch.float64)
4 gae_duplicate tensor(-0.4612, dtype=torch.float64) tensor(4.0818, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8398, dtype=torch.float64) delta_t tensor(-0.3896, dtype=torch.float64)
3 gae_duplicate tensor(-0.5731, dtype=torch.float64) tensor(7.2997, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1131, dtype=torch.float64) delta_t tensor(-0.0953, dtype=torch.float64)
2 gae_duplicate tensor(-0.4657, dtype=torch.float64) tensor(2.0312, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1272.5013427734375
value loss:38.00144577026367
entropies:337.8421630859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.839690923690796 seconds
19 rew tensor(1.2192, dtype=torch.float64) delta_t tensor(0.0274, dtype=torch.float64)
19 gae_duplicate tensor(-0.1260, dtype=torch.float64) tensor(-0.3221, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0880, dtype=torch.float64) delta_t tensor(0.0939, dtype=torch.float64)
18 gae_duplicate tensor(0.0061, dtype=torch.float64) tensor(-1.7873, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9944, dtype=torch.float64) delta_t tensor(0.0923, dtype=torch.float64)
17 gae_duplicate tensor(-0.1282, dtype=torch.float64) tensor(-2.3499, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9139, dtype=torch.float64) delta_t tensor(0.0810, dtype=torch.float64)
16 gae_duplicate tensor(-0.1759, dtype=torch.float64) tensor(-2.0263, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8283, dtype=torch.float64) delta_t tensor(0.1404, dtype=torch.float64)
15 gae_duplicate tensor(0.0245, dtype=torch.float64) tensor(-2.7437, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5450, dtype=torch.float64) delta_t tensor(0.0740, dtype=torch.float64)
14 gae_duplicate tensor(-0.0608, dtype=torch.float64) tensor(-1.5161, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7643, dtype=torch.float64) delta_t tensor(0.1024, dtype=torch.float64)
13 gae_duplicate tensor(-0.1479, dtype=torch.float64) tensor(-1.6818, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2304, dtype=torch.float64) delta_t tensor(-0.1083, dtype=torch.float64)
12 gae_duplicate tensor(-0.3519, dtype=torch.float64) tensor(2.3178, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5766, dtype=torch.float64) delta_t tensor(0.0713, dtype=torch.float64)
11 gae_duplicate tensor(-0.1870, dtype=torch.float64) tensor(-1.4271, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1800, dtype=torch.float64) delta_t tensor(-0.1974, dtype=torch.float64)
10 gae_duplicate tensor(-0.2731, dtype=torch.float64) tensor(3.4788, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3577, dtype=torch.float64) delta_t tensor(0.2951, dtype=torch.float64)
9 gae_duplicate tensor(-0.0150, dtype=torch.float64) tensor(-5.0026, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5136, dtype=torch.float64) delta_t tensor(-0.1602, dtype=torch.float64)
8 gae_duplicate tensor(-0.6847, dtype=torch.float64) tensor(2.5099, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8662, dtype=torch.float64) delta_t tensor(0.0816, dtype=torch.float64)
7 gae_duplicate tensor(-0.1181, dtype=torch.float64) tensor(-1.8433, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6329, dtype=torch.float64) delta_t tensor(0.1432, dtype=torch.float64)
6 gae_duplicate tensor(0.0571, dtype=torch.float64) tensor(-3.0909, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6337, dtype=torch.float64) delta_t tensor(-0.0746, dtype=torch.float64)
5 gae_duplicate tensor(-0.3426, dtype=torch.float64) tensor(1.0008, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0619, dtype=torch.float64) delta_t tensor(-0.0486, dtype=torch.float64)
4 gae_duplicate tensor(-0.2631, dtype=torch.float64) tensor(0.6203, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1735, dtype=torch.float64) delta_t tensor(-0.4460, dtype=torch.float64)
3 gae_duplicate tensor(-0.6083, dtype=torch.float64) tensor(8.9537, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4137, dtype=torch.float64) delta_t tensor(0.1729, dtype=torch.float64)
2 gae_duplicate tensor(-0.1437, dtype=torch.float64) tensor(-2.7468, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:322.325927734375
value loss:9.781314849853516
entropies:337.51123046875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3887.5759)
ToM Target loss= tensor(3798.0269)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.7035231590271 seconds
19 rew tensor(1.0781, dtype=torch.float64) delta_t tensor(-0.0750, dtype=torch.float64)
19 gae_duplicate tensor(-0.1930, dtype=torch.float64) tensor(1.2913, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0535, dtype=torch.float64) delta_t tensor(0.0326, dtype=torch.float64)
18 gae_duplicate tensor(-0.0963, dtype=torch.float64) tensor(-0.4436, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0542, dtype=torch.float64) delta_t tensor(0.1182, dtype=torch.float64)
17 gae_duplicate tensor(-0.1322, dtype=torch.float64) tensor(-2.1553, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9930, dtype=torch.float64) delta_t tensor(0.0800, dtype=torch.float64)
16 gae_duplicate tensor(-0.1298, dtype=torch.float64) tensor(-1.4377, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9533, dtype=torch.float64) delta_t tensor(0.1848, dtype=torch.float64)
15 gae_duplicate tensor(-0.1053, dtype=torch.float64) tensor(-3.5668, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4604, dtype=torch.float64) delta_t tensor(-0.0883, dtype=torch.float64)
14 gae_duplicate tensor(-1.4171, dtype=torch.float64) tensor(0.7518, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1069, dtype=torch.float64) delta_t tensor(-0.7060, dtype=torch.float64)
13 gae_duplicate tensor(-5.0167, dtype=torch.float64) tensor(12.0281, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3939, dtype=torch.float64) delta_t tensor(0.0670, dtype=torch.float64)
12 gae_duplicate tensor(-0.2262, dtype=torch.float64) tensor(0.4120, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4838, dtype=torch.float64) delta_t tensor(-0.0664, dtype=torch.float64)
11 gae_duplicate tensor(-0.3178, dtype=torch.float64) tensor(1.5188, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0131, dtype=torch.float64) delta_t tensor(0.0007, dtype=torch.float64)
10 gae_duplicate tensor(-0.1069, dtype=torch.float64) tensor(0.4475, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4032, dtype=torch.float64) delta_t tensor(0.1352, dtype=torch.float64)
9 gae_duplicate tensor(-0.2596, dtype=torch.float64) tensor(-3.3659, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5794, dtype=torch.float64) delta_t tensor(0.0373, dtype=torch.float64)
8 gae_duplicate tensor(-0.1226, dtype=torch.float64) tensor(-0.8847, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3915, dtype=torch.float64) delta_t tensor(0.1879, dtype=torch.float64)
7 gae_duplicate tensor(-0.0701, dtype=torch.float64) tensor(-3.4292, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6712, dtype=torch.float64) delta_t tensor(0.0591, dtype=torch.float64)
6 gae_duplicate tensor(-0.0251, dtype=torch.float64) tensor(-1.3967, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3828, dtype=torch.float64) delta_t tensor(-0.0221, dtype=torch.float64)
5 gae_duplicate tensor(-0.3062, dtype=torch.float64) tensor(-0.2068, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2243, dtype=torch.float64) delta_t tensor(-0.2059, dtype=torch.float64)
4 gae_duplicate tensor(-0.3603, dtype=torch.float64) tensor(4.2582, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7101, dtype=torch.float64) delta_t tensor(-0.2338, dtype=torch.float64)
3 gae_duplicate tensor(-0.3610, dtype=torch.float64) tensor(4.9065, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1402, dtype=torch.float64) delta_t tensor(-0.0096, dtype=torch.float64)
2 gae_duplicate tensor(-0.4021, dtype=torch.float64) tensor(0.3709, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-582.402099609375
value loss:47.57689666748047
entropies:337.3161315917969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9028401374816895 seconds
19 rew tensor(1.1629, dtype=torch.float64) delta_t tensor(-0.0133, dtype=torch.float64)
19 gae_duplicate tensor(-0.0768, dtype=torch.float64) tensor(0.1252, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1249, dtype=torch.float64) delta_t tensor(0.1420, dtype=torch.float64)
18 gae_duplicate tensor(-0.0019, dtype=torch.float64) tensor(-2.5345, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1157, dtype=torch.float64) delta_t tensor(0.1655, dtype=torch.float64)
17 gae_duplicate tensor(0.0490, dtype=torch.float64) tensor(-3.9446, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9772, dtype=torch.float64) delta_t tensor(0.0734, dtype=torch.float64)
16 gae_duplicate tensor(-0.1154, dtype=torch.float64) tensor(-1.7019, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8577, dtype=torch.float64) delta_t tensor(0.1589, dtype=torch.float64)
15 gae_duplicate tensor(-0.0245, dtype=torch.float64) tensor(-3.5102, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3597, dtype=torch.float64) delta_t tensor(-0.1480, dtype=torch.float64)
14 gae_duplicate tensor(-1.3823, dtype=torch.float64) tensor(3.3828, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7556, dtype=torch.float64) delta_t tensor(0.1769, dtype=torch.float64)
13 gae_duplicate tensor(-0.0393, dtype=torch.float64) tensor(-2.9914, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3492, dtype=torch.float64) delta_t tensor(-0.0845, dtype=torch.float64)
12 gae_duplicate tensor(-0.3006, dtype=torch.float64) tensor(1.5627, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4402, dtype=torch.float64) delta_t tensor(0.0152, dtype=torch.float64)
11 gae_duplicate tensor(-0.2676, dtype=torch.float64) tensor(-0.1081, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0308, dtype=torch.float64) delta_t tensor(-0.0014, dtype=torch.float64)
10 gae_duplicate tensor(-0.2890, dtype=torch.float64) tensor(0.0041, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2092, dtype=torch.float64) delta_t tensor(0.1586, dtype=torch.float64)
9 gae_duplicate tensor(-0.1299, dtype=torch.float64) tensor(-2.9990, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3819, dtype=torch.float64) delta_t tensor(0.0825, dtype=torch.float64)
8 gae_duplicate tensor(-0.1072, dtype=torch.float64) tensor(-1.9562, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8280, dtype=torch.float64) delta_t tensor(-0.0053, dtype=torch.float64)
7 gae_duplicate tensor(-0.3400, dtype=torch.float64) tensor(-0.1159, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5923, dtype=torch.float64) delta_t tensor(0.0720, dtype=torch.float64)
6 gae_duplicate tensor(-0.0133, dtype=torch.float64) tensor(-1.4949, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4832, dtype=torch.float64) delta_t tensor(-0.2169, dtype=torch.float64)
5 gae_duplicate tensor(-0.4053, dtype=torch.float64) tensor(3.5906, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1004, dtype=torch.float64) delta_t tensor(-0.0572, dtype=torch.float64)
4 gae_duplicate tensor(-0.2710, dtype=torch.float64) tensor(1.4672, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7514, dtype=torch.float64) delta_t tensor(-0.1230, dtype=torch.float64)
3 gae_duplicate tensor(-0.5421, dtype=torch.float64) tensor(1.3382, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1867, dtype=torch.float64) delta_t tensor(0.0154, dtype=torch.float64)
2 gae_duplicate tensor(-0.5557, dtype=torch.float64) tensor(-0.5947, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:474.8631286621094
value loss:11.993400573730469
entropies:337.35784912109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.754514932632446 seconds
19 rew tensor(1.1695, dtype=torch.float64) delta_t tensor(0.0254, dtype=torch.float64)
19 gae_duplicate tensor(-0.1258, dtype=torch.float64) tensor(-0.4797, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1839, dtype=torch.float64) delta_t tensor(0.1735, dtype=torch.float64)
18 gae_duplicate tensor(-0.0092, dtype=torch.float64) tensor(-3.1602, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1722, dtype=torch.float64) delta_t tensor(0.1553, dtype=torch.float64)
17 gae_duplicate tensor(0.0486, dtype=torch.float64) tensor(-3.2861, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0821, dtype=torch.float64) delta_t tensor(0.1106, dtype=torch.float64)
16 gae_duplicate tensor(-0.1301, dtype=torch.float64) tensor(-2.3367, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0131, dtype=torch.float64) delta_t tensor(0.2083, dtype=torch.float64)
15 gae_duplicate tensor(-0.0694, dtype=torch.float64) tensor(-4.7351, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4416, dtype=torch.float64) delta_t tensor(-0.1029, dtype=torch.float64)
14 gae_duplicate tensor(-1.5845, dtype=torch.float64) tensor(1.1247, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2329, dtype=torch.float64) delta_t tensor(-0.3764, dtype=torch.float64)
13 gae_duplicate tensor(-1.5733, dtype=torch.float64) tensor(6.4250, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3480, dtype=torch.float64) delta_t tensor(-0.0934, dtype=torch.float64)
12 gae_duplicate tensor(-0.3305, dtype=torch.float64) tensor(2.7115, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1174, dtype=torch.float64) delta_t tensor(-0.4919, dtype=torch.float64)
11 gae_duplicate tensor(-2.9261, dtype=torch.float64) tensor(11.2603, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1498, dtype=torch.float64) delta_t tensor(-0.1245, dtype=torch.float64)
10 gae_duplicate tensor(-0.8482, dtype=torch.float64) tensor(2.5832, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2048, dtype=torch.float64) delta_t tensor(0.0599, dtype=torch.float64)
9 gae_duplicate tensor(-0.2124, dtype=torch.float64) tensor(-0.9511, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5967, dtype=torch.float64) delta_t tensor(0.0561, dtype=torch.float64)
8 gae_duplicate tensor(-0.1047, dtype=torch.float64) tensor(-1.0092, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6371, dtype=torch.float64) delta_t tensor(0.0244, dtype=torch.float64)
7 gae_duplicate tensor(-0.3862, dtype=torch.float64) tensor(-1.3283, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7148, dtype=torch.float64) delta_t tensor(0.1699, dtype=torch.float64)
6 gae_duplicate tensor(4.4316e-06, dtype=torch.float64) tensor(-3.1059, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5602, dtype=torch.float64) delta_t tensor(-0.1614, dtype=torch.float64)
5 gae_duplicate tensor(-0.2061, dtype=torch.float64) tensor(2.4340, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0783, dtype=torch.float64) delta_t tensor(-0.1107, dtype=torch.float64)
4 gae_duplicate tensor(-0.4373, dtype=torch.float64) tensor(2.3753, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0759, dtype=torch.float64) delta_t tensor(-0.3224, dtype=torch.float64)
3 gae_duplicate tensor(-0.8698, dtype=torch.float64) tensor(6.1109, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2614, dtype=torch.float64) delta_t tensor(-0.0197, dtype=torch.float64)
2 gae_duplicate tensor(-0.4509, dtype=torch.float64) tensor(1.4885, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-961.73046875
value loss:32.53267288208008
entropies:337.8106994628906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.957079887390137 seconds
19 rew tensor(1.2311, dtype=torch.float64) delta_t tensor(0.0393, dtype=torch.float64)
19 gae_duplicate tensor(-0.0880, dtype=torch.float64) tensor(-0.9474, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2338, dtype=torch.float64) delta_t tensor(0.1809, dtype=torch.float64)
18 gae_duplicate tensor(0.1014, dtype=torch.float64) tensor(-4.0659, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1014, dtype=torch.float64) delta_t tensor(0.0945, dtype=torch.float64)
17 gae_duplicate tensor(-0.1042, dtype=torch.float64) tensor(-1.9281, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9585, dtype=torch.float64) delta_t tensor(0.1013, dtype=torch.float64)
16 gae_duplicate tensor(-0.1024, dtype=torch.float64) tensor(-2.5038, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9753, dtype=torch.float64) delta_t tensor(0.2619, dtype=torch.float64)
15 gae_duplicate tensor(0.1709, dtype=torch.float64) tensor(-5.1150, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6286, dtype=torch.float64) delta_t tensor(0.0907, dtype=torch.float64)
14 gae_duplicate tensor(-0.0395, dtype=torch.float64) tensor(-1.8829, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0069, dtype=torch.float64) delta_t tensor(-0.5236, dtype=torch.float64)
13 gae_duplicate tensor(-2.9269, dtype=torch.float64) tensor(9.0437, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3429, dtype=torch.float64) delta_t tensor(0.0601, dtype=torch.float64)
12 gae_duplicate tensor(-0.1135, dtype=torch.float64) tensor(-0.1477, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2794, dtype=torch.float64) delta_t tensor(-0.1543, dtype=torch.float64)
11 gae_duplicate tensor(-0.4086, dtype=torch.float64) tensor(3.2964, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0535, dtype=torch.float64) delta_t tensor(0.0551, dtype=torch.float64)
10 gae_duplicate tensor(-0.1782, dtype=torch.float64) tensor(-1.5393, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3327, dtype=torch.float64) delta_t tensor(0.2638, dtype=torch.float64)
9 gae_duplicate tensor(0.0066, dtype=torch.float64) tensor(-4.9721, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5738, dtype=torch.float64) delta_t tensor(-0.1195, dtype=torch.float64)
8 gae_duplicate tensor(-0.4368, dtype=torch.float64) tensor(2.0100, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8218, dtype=torch.float64) delta_t tensor(0.0450, dtype=torch.float64)
7 gae_duplicate tensor(-0.5265, dtype=torch.float64) tensor(-0.8587, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6260, dtype=torch.float64) delta_t tensor(0.0172, dtype=torch.float64)
6 gae_duplicate tensor(-0.1753, dtype=torch.float64) tensor(-0.4584, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6294, dtype=torch.float64) delta_t tensor(-0.0385, dtype=torch.float64)
5 gae_duplicate tensor(-0.3721, dtype=torch.float64) tensor(1.0208, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0297, dtype=torch.float64) delta_t tensor(0.0565, dtype=torch.float64)
4 gae_duplicate tensor(-0.1588, dtype=torch.float64) tensor(-0.7958, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0784, dtype=torch.float64) delta_t tensor(-0.2687, dtype=torch.float64)
3 gae_duplicate tensor(-0.5940, dtype=torch.float64) tensor(5.0245, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3240, dtype=torch.float64) delta_t tensor(0.0550, dtype=torch.float64)
2 gae_duplicate tensor(-0.4517, dtype=torch.float64) tensor(-0.4085, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:190.9651641845703
value loss:22.626480102539062
entropies:338.37738037109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.846144914627075 seconds
19 rew tensor(1.1437, dtype=torch.float64) delta_t tensor(-0.0550, dtype=torch.float64)
19 gae_duplicate tensor(-0.2000, dtype=torch.float64) tensor(0.9537, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1455, dtype=torch.float64) delta_t tensor(0.0878, dtype=torch.float64)
18 gae_duplicate tensor(-0.0860, dtype=torch.float64) tensor(-1.8174, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0619, dtype=torch.float64) delta_t tensor(0.0277, dtype=torch.float64)
17 gae_duplicate tensor(-0.0562, dtype=torch.float64) tensor(-1.2355, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0407, dtype=torch.float64) delta_t tensor(0.0849, dtype=torch.float64)
16 gae_duplicate tensor(-0.0161, dtype=torch.float64) tensor(-1.5455, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8183, dtype=torch.float64) delta_t tensor(-0.0026, dtype=torch.float64)
15 gae_duplicate tensor(-0.1731, dtype=torch.float64) tensor(-0.0953, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5238, dtype=torch.float64) delta_t tensor(-0.0474, dtype=torch.float64)
14 gae_duplicate tensor(-1.2065, dtype=torch.float64) tensor(0.4866, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5607, dtype=torch.float64) delta_t tensor(0.0112, dtype=torch.float64)
13 gae_duplicate tensor(-0.0898, dtype=torch.float64) tensor(-0.3009, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4300, dtype=torch.float64) delta_t tensor(0.0469, dtype=torch.float64)
12 gae_duplicate tensor(-0.0430, dtype=torch.float64) tensor(-0.8350, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3970, dtype=torch.float64) delta_t tensor(0.0224, dtype=torch.float64)
11 gae_duplicate tensor(-0.1596, dtype=torch.float64) tensor(-0.5391, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0551, dtype=torch.float64) delta_t tensor(-0.0496, dtype=torch.float64)
10 gae_duplicate tensor(-0.4012, dtype=torch.float64) tensor(1.3220, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2435, dtype=torch.float64) delta_t tensor(0.2622, dtype=torch.float64)
9 gae_duplicate tensor(0.0398, dtype=torch.float64) tensor(-4.6251, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4415, dtype=torch.float64) delta_t tensor(0.0820, dtype=torch.float64)
8 gae_duplicate tensor(-0.1645, dtype=torch.float64) tensor(-2.0250, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9449, dtype=torch.float64) delta_t tensor(0.0187, dtype=torch.float64)
7 gae_duplicate tensor(-0.3482, dtype=torch.float64) tensor(-0.7177, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6877, dtype=torch.float64) delta_t tensor(0.0599, dtype=torch.float64)
6 gae_duplicate tensor(-0.4467, dtype=torch.float64) tensor(-0.6632, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5661, dtype=torch.float64) delta_t tensor(-0.0575, dtype=torch.float64)
5 gae_duplicate tensor(-0.2408, dtype=torch.float64) tensor(1.0983, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0411, dtype=torch.float64) delta_t tensor(0.0343, dtype=torch.float64)
4 gae_duplicate tensor(-0.3906, dtype=torch.float64) tensor(-0.6252, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1217, dtype=torch.float64) delta_t tensor(-0.1784, dtype=torch.float64)
3 gae_duplicate tensor(-0.6048, dtype=torch.float64) tensor(3.0069, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4068, dtype=torch.float64) delta_t tensor(0.1175, dtype=torch.float64)
2 gae_duplicate tensor(-0.7020, dtype=torch.float64) tensor(-1.8630, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:449.55950927734375
value loss:11.225678443908691
entropies:339.00921630859375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3893.8113)
ToM Target loss= tensor(3786.1860)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.998105049133301 seconds
19 rew tensor(1.2439, dtype=torch.float64) delta_t tensor(-0.0182, dtype=torch.float64)
19 gae_duplicate tensor(-0.1441, dtype=torch.float64) tensor(0.5766, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2456, dtype=torch.float64) delta_t tensor(0.1358, dtype=torch.float64)
18 gae_duplicate tensor(-0.0257, dtype=torch.float64) tensor(-2.4194, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1300, dtype=torch.float64) delta_t tensor(0.1966, dtype=torch.float64)
16 rew tensor(1.0546, dtype=torch.float64) delta_t tensor(0.0359, dtype=torch.float64)
16 gae_duplicate tensor(-0.2115, dtype=torch.float64) tensor(-0.9325, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9544, dtype=torch.float64) delta_t tensor(0.1623, dtype=torch.float64)
15 gae_duplicate tensor(-0.0854, dtype=torch.float64) tensor(-2.8501, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5595, dtype=torch.float64) delta_t tensor(-0.0633, dtype=torch.float64)
14 gae_duplicate tensor(-1.3124, dtype=torch.float64) tensor(0.7175, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3504, dtype=torch.float64) delta_t tensor(-0.2440, dtype=torch.float64)
13 gae_duplicate tensor(-1.2646, dtype=torch.float64) tensor(4.6132, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2189, dtype=torch.float64) delta_t tensor(-0.4741, dtype=torch.float64)
12 gae_duplicate tensor(-3.1229, dtype=torch.float64) tensor(8.2594, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3088, dtype=torch.float64) delta_t tensor(-0.8995, dtype=torch.float64)
11 gae_duplicate tensor(-5.2839, dtype=torch.float64) tensor(21.0728, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1146, dtype=torch.float64) delta_t tensor(0.0964, dtype=torch.float64)
10 gae_duplicate tensor(-0.2028, dtype=torch.float64) tensor(-0.2235, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5614, dtype=torch.float64) delta_t tensor(0.2868, dtype=torch.float64)
9 gae_duplicate tensor(-0.1096, dtype=torch.float64) tensor(-5.3186, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6747, dtype=torch.float64) delta_t tensor(-0.0325, dtype=torch.float64)
8 gae_duplicate tensor(-0.2570, dtype=torch.float64) tensor(0.1090, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6320, dtype=torch.float64) delta_t tensor(0.3855, dtype=torch.float64)
7 gae_duplicate tensor(0.1656, dtype=torch.float64) tensor(-8.7544, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9937, dtype=torch.float64) delta_t tensor(0.0239, dtype=torch.float64)
6 gae_duplicate tensor(-0.1201, dtype=torch.float64) tensor(-0.8725, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3471, dtype=torch.float64) delta_t tensor(0.2416, dtype=torch.float64)
5 gae_duplicate tensor(-0.0210, dtype=torch.float64) tensor(-4.4941, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0251, dtype=torch.float64) delta_t tensor(0.0150, dtype=torch.float64)
4 gae_duplicate tensor(-0.2225, dtype=torch.float64) tensor(-0.8967, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1569, dtype=torch.float64) delta_t tensor(-0.0770, dtype=torch.float64)
3 gae_duplicate tensor(-0.3731, dtype=torch.float64) tensor(1.3455, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3010, dtype=torch.float64) delta_t tensor(0.1142, dtype=torch.float64)
2 gae_duplicate tensor(-0.2582, dtype=torch.float64) tensor(-1.5854, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-334.68060302734375
value loss:72.70462036132812
entropies:339.6131591796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.932358741760254 seconds
19 rew tensor(1.1791, dtype=torch.float64) delta_t tensor(-0.0848, dtype=torch.float64)
19 gae_duplicate tensor(-0.1919, dtype=torch.float64) tensor(1.6055, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1940, dtype=torch.float64) delta_t tensor(0.0949, dtype=torch.float64)
18 gae_duplicate tensor(-0.1127, dtype=torch.float64) tensor(-1.5051, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0912, dtype=torch.float64) delta_t tensor(0.0142, dtype=torch.float64)
17 gae_duplicate tensor(-0.2309, dtype=torch.float64) tensor(-0.3832, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0170, dtype=torch.float64) delta_t tensor(-0.0239, dtype=torch.float64)
16 gae_duplicate tensor(-0.1193, dtype=torch.float64) tensor(0.3831, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9124, dtype=torch.float64) delta_t tensor(0.1218, dtype=torch.float64)
15 gae_duplicate tensor(-0.1729, dtype=torch.float64) tensor(-2.0298, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1299, dtype=torch.float64) delta_t tensor(-0.4647, dtype=torch.float64)
14 gae_duplicate tensor(-2.9043, dtype=torch.float64) tensor(10.5262, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6835, dtype=torch.float64) delta_t tensor(-0.0241, dtype=torch.float64)
13 gae_duplicate tensor(-0.4693, dtype=torch.float64) tensor(1.2185, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2432, dtype=torch.float64) delta_t tensor(0.0358, dtype=torch.float64)
12 gae_duplicate tensor(-0.2911, dtype=torch.float64) tensor(-0.5460, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5605, dtype=torch.float64) delta_t tensor(-0.0102, dtype=torch.float64)
11 gae_duplicate tensor(-0.1126, dtype=torch.float64) tensor(0.2154, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1358, dtype=torch.float64) delta_t tensor(-0.0428, dtype=torch.float64)
10 gae_duplicate tensor(-0.3538, dtype=torch.float64) tensor(0.7529, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4211, dtype=torch.float64) delta_t tensor(0.2612, dtype=torch.float64)
9 gae_duplicate tensor(-0.1153, dtype=torch.float64) tensor(-5.2389, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6327, dtype=torch.float64) delta_t tensor(-0.0856, dtype=torch.float64)
8 gae_duplicate tensor(-0.2317, dtype=torch.float64) tensor(1.2988, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4417, dtype=torch.float64) delta_t tensor(0.1602, dtype=torch.float64)
7 gae_duplicate tensor(0.0245, dtype=torch.float64) tensor(-3.7341, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8012, dtype=torch.float64) delta_t tensor(0.0747, dtype=torch.float64)
6 gae_duplicate tensor(-0.2941, dtype=torch.float64) tensor(-1.6657, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2712, dtype=torch.float64) delta_t tensor(0.1030, dtype=torch.float64)
5 gae_duplicate tensor(-0.2807, dtype=torch.float64) tensor(-2.0300, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1550, dtype=torch.float64) delta_t tensor(-0.0180, dtype=torch.float64)
4 gae_duplicate tensor(-0.2508, dtype=torch.float64) tensor(0.2577, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7857, dtype=torch.float64) delta_t tensor(0.0197, dtype=torch.float64)
3 gae_duplicate tensor(-0.4497, dtype=torch.float64) tensor(0.0927, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2239, dtype=torch.float64) delta_t tensor(-0.0482, dtype=torch.float64)
2 gae_duplicate tensor(-0.6080, dtype=torch.float64) tensor(0.1054, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-55.26943588256836
value loss:20.786865234375
entropies:340.00567626953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.845062255859375 seconds
19 rew tensor(1.2808, dtype=torch.float64) delta_t tensor(-0.0096, dtype=torch.float64)
19 gae_duplicate tensor(-0.0746, dtype=torch.float64) tensor(0.1277, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9713, dtype=torch.float64) delta_t tensor(-0.1476, dtype=torch.float64)
18 gae_duplicate tensor(-1.6476, dtype=torch.float64) tensor(2.0110, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0515, dtype=torch.float64) delta_t tensor(-0.0096, dtype=torch.float64)
17 gae_duplicate tensor(-0.1881, dtype=torch.float64) tensor(0.4320, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0662, dtype=torch.float64) delta_t tensor(0.1828, dtype=torch.float64)
16 gae_duplicate tensor(-0.1421, dtype=torch.float64) tensor(-3.1652, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9368, dtype=torch.float64) delta_t tensor(0.0737, dtype=torch.float64)
15 gae_duplicate tensor(-0.0526, dtype=torch.float64) tensor(-1.8804, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0274, dtype=torch.float64) delta_t tensor(-0.5477, dtype=torch.float64)
14 gae_duplicate tensor(-2.4678, dtype=torch.float64) tensor(10.2147, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7530, dtype=torch.float64) delta_t tensor(0.1971, dtype=torch.float64)
13 gae_duplicate tensor(-0.1280, dtype=torch.float64) tensor(-2.6902, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3707, dtype=torch.float64) delta_t tensor(0.0597, dtype=torch.float64)
12 gae_duplicate tensor(-0.2249, dtype=torch.float64) tensor(-1.2598, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4597, dtype=torch.float64) delta_t tensor(0.0152, dtype=torch.float64)
11 gae_duplicate tensor(-0.1765, dtype=torch.float64) tensor(-0.5417, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2065, dtype=torch.float64) delta_t tensor(-0.0647, dtype=torch.float64)
10 gae_duplicate tensor(-0.1843, dtype=torch.float64) tensor(1.0915, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4591, dtype=torch.float64) delta_t tensor(0.2934, dtype=torch.float64)
9 gae_duplicate tensor(0.0224, dtype=torch.float64) tensor(-5.4503, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5719, dtype=torch.float64) delta_t tensor(0.0108, dtype=torch.float64)
8 gae_duplicate tensor(-0.2276, dtype=torch.float64) tensor(-0.8121, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7187, dtype=torch.float64) delta_t tensor(-0.5842, dtype=torch.float64)
7 gae_duplicate tensor(-2.4719, dtype=torch.float64) tensor(13.7461, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8659, dtype=torch.float64) delta_t tensor(0.0051, dtype=torch.float64)
6 gae_duplicate tensor(-0.5829, dtype=torch.float64) tensor(0.7527, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5318, dtype=torch.float64) delta_t tensor(0.0252, dtype=torch.float64)
5 gae_duplicate tensor(-0.2196, dtype=torch.float64) tensor(-0.0800, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0447, dtype=torch.float64) delta_t tensor(0.0174, dtype=torch.float64)
4 gae_duplicate tensor(-0.2200, dtype=torch.float64) tensor(-0.3328, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1691, dtype=torch.float64) delta_t tensor(-0.0962, dtype=torch.float64)
3 gae_duplicate tensor(-0.7850, dtype=torch.float64) tensor(2.3573, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2676, dtype=torch.float64) delta_t tensor(0.0590, dtype=torch.float64)
2 gae_duplicate tensor(-0.3083, dtype=torch.float64) tensor(-1.0513, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-819.196044921875
value loss:36.988189697265625
entropies:340.18170166015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.889188289642334 seconds
19 rew tensor(1.1365, dtype=torch.float64) delta_t tensor(-0.0898, dtype=torch.float64)
19 gae_duplicate tensor(-0.1102, dtype=torch.float64) tensor(1.7659, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1515, dtype=torch.float64) delta_t tensor(0.0792, dtype=torch.float64)
18 gae_duplicate tensor(-0.0741, dtype=torch.float64) tensor(-1.1955, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0473, dtype=torch.float64) delta_t tensor(-0.0444, dtype=torch.float64)
17 gae_duplicate tensor(-0.0861, dtype=torch.float64) tensor(0.6509, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9435, dtype=torch.float64) delta_t tensor(-0.0253, dtype=torch.float64)
16 gae_duplicate tensor(-0.1844, dtype=torch.float64) tensor(0.6613, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8816, dtype=torch.float64) delta_t tensor(0.0606, dtype=torch.float64)
15 gae_duplicate tensor(-0.2271, dtype=torch.float64) tensor(-0.7693, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6167, dtype=torch.float64) delta_t tensor(0.1518, dtype=torch.float64)
14 gae_duplicate tensor(-0.0259, dtype=torch.float64) tensor(-2.7249, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7012, dtype=torch.float64) delta_t tensor(-0.0492, dtype=torch.float64)
13 gae_duplicate tensor(-0.2329, dtype=torch.float64) tensor(0.5574, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2394, dtype=torch.float64) delta_t tensor(0.0477, dtype=torch.float64)
12 gae_duplicate tensor(-0.2668, dtype=torch.float64) tensor(-0.5354, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5458, dtype=torch.float64) delta_t tensor(0.0046, dtype=torch.float64)
11 gae_duplicate tensor(-0.1167, dtype=torch.float64) tensor(-0.4250, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1217, dtype=torch.float64) delta_t tensor(0.0054, dtype=torch.float64)
10 gae_duplicate tensor(-0.0808, dtype=torch.float64) tensor(-0.2683, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4566, dtype=torch.float64) delta_t tensor(0.3117, dtype=torch.float64)
9 gae_duplicate tensor(-0.0399, dtype=torch.float64) tensor(-6.1852, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6721, dtype=torch.float64) delta_t tensor(-0.1976, dtype=torch.float64)
8 gae_duplicate tensor(-0.4027, dtype=torch.float64) tensor(3.1900, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7912, dtype=torch.float64) delta_t tensor(-0.1098, dtype=torch.float64)
7 gae_duplicate tensor(-1.0555, dtype=torch.float64) tensor(2.5892, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7236, dtype=torch.float64) delta_t tensor(0.0846, dtype=torch.float64)
6 gae_duplicate tensor(-0.0523, dtype=torch.float64) tensor(-1.3273, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3899, dtype=torch.float64) delta_t tensor(0.1277, dtype=torch.float64)
5 gae_duplicate tensor(-0.0590, dtype=torch.float64) tensor(-2.5370, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0845, dtype=torch.float64) delta_t tensor(-0.0134, dtype=torch.float64)
4 gae_duplicate tensor(-0.2378, dtype=torch.float64) tensor(0.0627, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8732, dtype=torch.float64) delta_t tensor(-0.0214, dtype=torch.float64)
3 gae_duplicate tensor(-0.3240, dtype=torch.float64) tensor(0.3664, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2935, dtype=torch.float64) delta_t tensor(-0.0157, dtype=torch.float64)
2 gae_duplicate tensor(-0.4519, dtype=torch.float64) tensor(0.7989, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:195.77377319335938
value loss:8.417765617370605
entropies:339.9498291015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.020204067230225 seconds
19 rew tensor(1.1732, dtype=torch.float64) delta_t tensor(-0.0524, dtype=torch.float64)
19 gae_duplicate tensor(-0.1255, dtype=torch.float64) tensor(1.0359, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1742, dtype=torch.float64) delta_t tensor(0.0739, dtype=torch.float64)
18 gae_duplicate tensor(0.0268, dtype=torch.float64) tensor(-1.2226, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0704, dtype=torch.float64) delta_t tensor(-0.0098, dtype=torch.float64)
17 gae_duplicate tensor(-0.1088, dtype=torch.float64) tensor(0.2296, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0093, dtype=torch.float64) delta_t tensor(-0.0167, dtype=torch.float64)
16 gae_duplicate tensor(-0.1720, dtype=torch.float64) tensor(0.2247, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9435, dtype=torch.float64) delta_t tensor(0.0959, dtype=torch.float64)
15 gae_duplicate tensor(-0.0989, dtype=torch.float64) tensor(-1.6018, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7433, dtype=torch.float64) delta_t tensor(0.0419, dtype=torch.float64)
14 gae_duplicate tensor(-0.2418, dtype=torch.float64) tensor(-0.9463, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3935, dtype=torch.float64) delta_t tensor(-0.1766, dtype=torch.float64)
13 gae_duplicate tensor(-1.4616, dtype=torch.float64) tensor(2.7348, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3771, dtype=torch.float64) delta_t tensor(0.0646, dtype=torch.float64)
12 gae_duplicate tensor(-0.1041, dtype=torch.float64) tensor(-0.7089, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4568, dtype=torch.float64) delta_t tensor(-0.0452, dtype=torch.float64)
11 gae_duplicate tensor(-0.2493, dtype=torch.float64) tensor(1.1739, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0246, dtype=torch.float64) delta_t tensor(0.1105, dtype=torch.float64)
10 gae_duplicate tensor(-0.0682, dtype=torch.float64) tensor(-1.8841, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3699, dtype=torch.float64) delta_t tensor(0.2232, dtype=torch.float64)
9 gae_duplicate tensor(-0.0255, dtype=torch.float64) tensor(-4.0253, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5411, dtype=torch.float64) delta_t tensor(-0.0727, dtype=torch.float64)
8 gae_duplicate tensor(-0.5471, dtype=torch.float64) tensor(1.4270, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2650, dtype=torch.float64) delta_t tensor(-0.3469, dtype=torch.float64)
7 gae_duplicate tensor(-2.6534, dtype=torch.float64) tensor(8.4184, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8464, dtype=torch.float64) delta_t tensor(0.0105, dtype=torch.float64)
6 gae_duplicate tensor(-0.3725, dtype=torch.float64) tensor(0.4721, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3511, dtype=torch.float64) delta_t tensor(0.0935, dtype=torch.float64)
5 gae_duplicate tensor(-0.2002, dtype=torch.float64) tensor(-1.5335, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0495, dtype=torch.float64) delta_t tensor(0.0894, dtype=torch.float64)
4 gae_duplicate tensor(-0.2085, dtype=torch.float64) tensor(-1.4445, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9126, dtype=torch.float64) delta_t tensor(0.0828, dtype=torch.float64)
3 gae_duplicate tensor(-0.5207, dtype=torch.float64) tensor(-1.9939, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2498, dtype=torch.float64) delta_t tensor(0.0166, dtype=torch.float64)
2 gae_duplicate tensor(-0.5781, dtype=torch.float64) tensor(0.4085, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-132.92425537109375
value loss:22.45889663696289
entropies:339.5424499511719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3892.3997)
ToM Target loss= tensor(3763.8604)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.9017860889434814 seconds
19 rew tensor(1.1614, dtype=torch.float64) delta_t tensor(-0.0884, dtype=torch.float64)
19 gae_duplicate tensor(-0.1622, dtype=torch.float64) tensor(1.5152, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1759, dtype=torch.float64) delta_t tensor(0.0595, dtype=torch.float64)
18 gae_duplicate tensor(-0.0100, dtype=torch.float64) tensor(-0.9700, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1110, dtype=torch.float64) delta_t tensor(-0.0279, dtype=torch.float64)
17 gae_duplicate tensor(-0.2024, dtype=torch.float64) tensor(0.3942, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0454, dtype=torch.float64) delta_t tensor(0.0167, dtype=torch.float64)
16 gae_duplicate tensor(-0.1462, dtype=torch.float64) tensor(-0.3597, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9563, dtype=torch.float64) delta_t tensor(0.0411, dtype=torch.float64)
15 gae_duplicate tensor(-0.1406, dtype=torch.float64) tensor(-0.5830, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5942, dtype=torch.float64) delta_t tensor(-0.0923, dtype=torch.float64)
14 gae_duplicate tensor(-0.8590, dtype=torch.float64) tensor(2.0606, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2496, dtype=torch.float64) delta_t tensor(-0.4064, dtype=torch.float64)
13 gae_duplicate tensor(-3.1162, dtype=torch.float64) tensor(6.4473, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3374, dtype=torch.float64) delta_t tensor(-0.5608, dtype=torch.float64)
12 gae_duplicate tensor(-3.9440, dtype=torch.float64) tensor(10.1526, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3838, dtype=torch.float64) delta_t tensor(-0.1744, dtype=torch.float64)
11 gae_duplicate tensor(-2.1086, dtype=torch.float64) tensor(3.5034, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0118, dtype=torch.float64) delta_t tensor(0.1146, dtype=torch.float64)
10 gae_duplicate tensor(-0.0657, dtype=torch.float64) tensor(-1.7333, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4469, dtype=torch.float64) delta_t tensor(0.1341, dtype=torch.float64)
9 gae_duplicate tensor(-0.2459, dtype=torch.float64) tensor(-2.4010, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6140, dtype=torch.float64) delta_t tensor(0.0830, dtype=torch.float64)
8 gae_duplicate tensor(7.9057e-05, dtype=torch.float64) tensor(-1.8482, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8006, dtype=torch.float64) delta_t tensor(-0.0111, dtype=torch.float64)
7 gae_duplicate tensor(-0.6754, dtype=torch.float64) tensor(-0.3330, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7697, dtype=torch.float64) delta_t tensor(0.0954, dtype=torch.float64)
6 gae_duplicate tensor(-0.1411, dtype=torch.float64) tensor(-1.9139, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4266, dtype=torch.float64) delta_t tensor(0.2374, dtype=torch.float64)
5 gae_duplicate tensor(-0.0888, dtype=torch.float64) tensor(-4.6683, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0288, dtype=torch.float64) delta_t tensor(-0.0723, dtype=torch.float64)
4 gae_duplicate tensor(-0.1783, dtype=torch.float64) tensor(0.9809, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9980, dtype=torch.float64) delta_t tensor(0.1833, dtype=torch.float64)
3 gae_duplicate tensor(-0.0475, dtype=torch.float64) tensor(-3.0083, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3360, dtype=torch.float64) delta_t tensor(0.0333, dtype=torch.float64)
2 gae_duplicate tensor(-0.1982, dtype=torch.float64) tensor(-1.3611, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-408.688720703125
value loss:51.76716232299805
entropies:338.8048095703125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.496143817901611 seconds
19 rew tensor(1.1317, dtype=torch.float64) delta_t tensor(-0.0208, dtype=torch.float64)
19 gae_duplicate tensor(-0.1305, dtype=torch.float64) tensor(0.2461, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1452, dtype=torch.float64) delta_t tensor(0.1197, dtype=torch.float64)
18 gae_duplicate tensor(-0.0154, dtype=torch.float64) tensor(-2.6603, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0988, dtype=torch.float64) delta_t tensor(0.0268, dtype=torch.float64)
17 gae_duplicate tensor(-0.2295, dtype=torch.float64) tensor(-0.6653, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0982, dtype=torch.float64) delta_t tensor(0.0555, dtype=torch.float64)
16 gae_duplicate tensor(-0.0269, dtype=torch.float64) tensor(-1.0222, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9706, dtype=torch.float64) delta_t tensor(0.0057, dtype=torch.float64)
15 gae_duplicate tensor(-0.1017, dtype=torch.float64) tensor(-0.3044, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5595, dtype=torch.float64) delta_t tensor(0.0044, dtype=torch.float64)
14 gae_duplicate tensor(-0.7112, dtype=torch.float64) tensor(-0.1306, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4349, dtype=torch.float64) delta_t tensor(-0.1899, dtype=torch.float64)
13 gae_duplicate tensor(-1.3196, dtype=torch.float64) tensor(3.1398, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3370, dtype=torch.float64) delta_t tensor(0.2197, dtype=torch.float64)
12 gae_duplicate tensor(-0.0654, dtype=torch.float64) tensor(-3.3586, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5243, dtype=torch.float64) delta_t tensor(0.0346, dtype=torch.float64)
11 gae_duplicate tensor(-0.1960, dtype=torch.float64) tensor(-1.0301, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2332, dtype=torch.float64) delta_t tensor(-0.0253, dtype=torch.float64)
10 gae_duplicate tensor(-0.2429, dtype=torch.float64) tensor(0.4527, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5388, dtype=torch.float64) delta_t tensor(0.4123, dtype=torch.float64)
9 gae_duplicate tensor(0.1956, dtype=torch.float64) tensor(-7.6874, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6104, dtype=torch.float64) delta_t tensor(-0.1034, dtype=torch.float64)
8 gae_duplicate tensor(-0.3429, dtype=torch.float64) tensor(1.0347, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5944, dtype=torch.float64) delta_t tensor(-0.6006, dtype=torch.float64)
7 gae_duplicate tensor(-2.7013, dtype=torch.float64) tensor(15.7440, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8551, dtype=torch.float64) delta_t tensor(-0.1585, dtype=torch.float64)
6 gae_duplicate tensor(-0.6166, dtype=torch.float64) tensor(4.2804, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4892, dtype=torch.float64) delta_t tensor(0.0582, dtype=torch.float64)
5 gae_duplicate tensor(-0.3134, dtype=torch.float64) tensor(-0.6687, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0140, dtype=torch.float64) delta_t tensor(0.0126, dtype=torch.float64)
4 gae_duplicate tensor(-0.1485, dtype=torch.float64) tensor(-0.2036, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1537, dtype=torch.float64) delta_t tensor(0.0101, dtype=torch.float64)
3 gae_duplicate tensor(-0.5202, dtype=torch.float64) tensor(-0.4127, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3776, dtype=torch.float64) delta_t tensor(0.0097, dtype=torch.float64)
2 gae_duplicate tensor(-0.6168, dtype=torch.float64) tensor(-0.1670, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-447.1111145019531
value loss:24.358856201171875
entropies:338.6058349609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.281423091888428 seconds
19 rew tensor(1.0971, dtype=torch.float64) delta_t tensor(-0.0686, dtype=torch.float64)
19 gae_duplicate tensor(-0.1435, dtype=torch.float64) tensor(1.1830, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1232, dtype=torch.float64) delta_t tensor(0.0937, dtype=torch.float64)
18 gae_duplicate tensor(0.0016, dtype=torch.float64) tensor(-1.5673, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0583, dtype=torch.float64) delta_t tensor(0.0277, dtype=torch.float64)
17 gae_duplicate tensor(-0.0529, dtype=torch.float64) tensor(-0.8254, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9177, dtype=torch.float64) delta_t tensor(-0.0700, dtype=torch.float64)
16 gae_duplicate tensor(-0.1853, dtype=torch.float64) tensor(1.2002, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9445, dtype=torch.float64) delta_t tensor(0.0890, dtype=torch.float64)
15 gae_duplicate tensor(-0.1199, dtype=torch.float64) tensor(-1.6056, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6714, dtype=torch.float64) delta_t tensor(0.0512, dtype=torch.float64)
14 gae_duplicate tensor(-0.1057, dtype=torch.float64) tensor(-1.3473, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7505, dtype=torch.float64) delta_t tensor(0.1704, dtype=torch.float64)
13 gae_duplicate tensor(-0.0933, dtype=torch.float64) tensor(-3.3773, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1098, dtype=torch.float64) delta_t tensor(-0.2076, dtype=torch.float64)
12 gae_duplicate tensor(-1.0694, dtype=torch.float64) tensor(4.5246, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2107, dtype=torch.float64) delta_t tensor(-0.5618, dtype=torch.float64)
11 gae_duplicate tensor(-3.5097, dtype=torch.float64) tensor(16.9672, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0331, dtype=torch.float64) delta_t tensor(0.1462, dtype=torch.float64)
10 gae_duplicate tensor(-0.1023, dtype=torch.float64) tensor(-1.5476, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2862, dtype=torch.float64) delta_t tensor(0.2096, dtype=torch.float64)
9 gae_duplicate tensor(-0.0657, dtype=torch.float64) tensor(-4.6178, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5372, dtype=torch.float64) delta_t tensor(-0.0415, dtype=torch.float64)
8 gae_duplicate tensor(-0.2232, dtype=torch.float64) tensor(0.7361, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7321, dtype=torch.float64) delta_t tensor(0.1058, dtype=torch.float64)
7 gae_duplicate tensor(-0.1904, dtype=torch.float64) tensor(-1.9033, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6153, dtype=torch.float64) delta_t tensor(0.1898, dtype=torch.float64)
6 gae_duplicate tensor(-0.1209, dtype=torch.float64) tensor(-3.4054, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6057, dtype=torch.float64) delta_t tensor(0.0190, dtype=torch.float64)
5 gae_duplicate tensor(-0.1446, dtype=torch.float64) tensor(-0.6392, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0739, dtype=torch.float64) delta_t tensor(-0.0779, dtype=torch.float64)
4 gae_duplicate tensor(-0.2812, dtype=torch.float64) tensor(0.9508, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9837, dtype=torch.float64) delta_t tensor(0.0096, dtype=torch.float64)
3 gae_duplicate tensor(-0.3964, dtype=torch.float64) tensor(-0.0369, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2882, dtype=torch.float64) delta_t tensor(-0.0243, dtype=torch.float64)
2 gae_duplicate tensor(-0.4693, dtype=torch.float64) tensor(0.8173, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-388.5891418457031
value loss:26.596582412719727
entropies:337.9730224609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.772335052490234 seconds
19 rew tensor(1.0826, dtype=torch.float64) delta_t tensor(-0.0514, dtype=torch.float64)
19 gae_duplicate tensor(-0.0936, dtype=torch.float64) tensor(1.0884, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0858, dtype=torch.float64) delta_t tensor(0.0834, dtype=torch.float64)
18 gae_duplicate tensor(-0.0498, dtype=torch.float64) tensor(-1.6342, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0449, dtype=torch.float64) delta_t tensor(0.0058, dtype=torch.float64)
17 gae_duplicate tensor(-0.1629, dtype=torch.float64) tensor(-0.0531, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9423, dtype=torch.float64) delta_t tensor(-0.0362, dtype=torch.float64)
16 gae_duplicate tensor(-0.1716, dtype=torch.float64) tensor(0.5518, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9058, dtype=torch.float64) delta_t tensor(-0.0274, dtype=torch.float64)
15 gae_duplicate tensor(-0.2338, dtype=torch.float64) tensor(0.5052, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4232, dtype=torch.float64) delta_t tensor(-0.0903, dtype=torch.float64)
14 gae_duplicate tensor(-1.3381, dtype=torch.float64) tensor(1.1604, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5702, dtype=torch.float64) delta_t tensor(0.0192, dtype=torch.float64)
13 gae_duplicate tensor(-1.3294, dtype=torch.float64) tensor(-0.0750, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3577, dtype=torch.float64) delta_t tensor(-0.0319, dtype=torch.float64)
12 gae_duplicate tensor(-0.2170, dtype=torch.float64) tensor(0.7940, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3636, dtype=torch.float64) delta_t tensor(0.0533, dtype=torch.float64)
11 gae_duplicate tensor(-0.0051, dtype=torch.float64) tensor(-0.9401, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0719, dtype=torch.float64) delta_t tensor(0.0004, dtype=torch.float64)
10 gae_duplicate tensor(-0.0876, dtype=torch.float64) tensor(-0.0896, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2422, dtype=torch.float64) delta_t tensor(0.0392, dtype=torch.float64)
9 gae_duplicate tensor(-0.3428, dtype=torch.float64) tensor(-0.5883, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5020, dtype=torch.float64) delta_t tensor(-0.0725, dtype=torch.float64)
8 gae_duplicate tensor(-0.1824, dtype=torch.float64) tensor(1.5378, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5141, dtype=torch.float64) delta_t tensor(0.1350, dtype=torch.float64)
7 gae_duplicate tensor(-0.0013, dtype=torch.float64) tensor(-2.2758, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5676, dtype=torch.float64) delta_t tensor(0.2388, dtype=torch.float64)
6 gae_duplicate tensor(0.0631, dtype=torch.float64) tensor(-5.2474, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5459, dtype=torch.float64) delta_t tensor(0.0704, dtype=torch.float64)
5 gae_duplicate tensor(-0.0223, dtype=torch.float64) tensor(-1.7593, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1793, dtype=torch.float64) delta_t tensor(-0.0136, dtype=torch.float64)
4 gae_duplicate tensor(-0.1317, dtype=torch.float64) tensor(0.0818, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8328, dtype=torch.float64) delta_t tensor(0.0333, dtype=torch.float64)
3 gae_duplicate tensor(-0.2872, dtype=torch.float64) tensor(-0.5746, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1718, dtype=torch.float64) delta_t tensor(-0.2233, dtype=torch.float64)
2 gae_duplicate tensor(-0.4746, dtype=torch.float64) tensor(3.6739, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:116.57310485839844
value loss:10.440937995910645
entropies:337.0437316894531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.176823139190674 seconds
19 rew tensor(1.2680, dtype=torch.float64) delta_t tensor(0.0035, dtype=torch.float64)
19 gae_duplicate tensor(-0.1397, dtype=torch.float64) tensor(-0.0552, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2309, dtype=torch.float64) delta_t tensor(0.1292, dtype=torch.float64)
18 gae_duplicate tensor(-0.0640, dtype=torch.float64) tensor(-2.5165, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1661, dtype=torch.float64) delta_t tensor(0.1016, dtype=torch.float64)
17 gae_duplicate tensor(-0.1149, dtype=torch.float64) tensor(-1.7815, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9962, dtype=torch.float64) delta_t tensor(0.0140, dtype=torch.float64)
16 gae_duplicate tensor(-0.2070, dtype=torch.float64) tensor(-0.4017, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9294, dtype=torch.float64) delta_t tensor(0.0693, dtype=torch.float64)
15 gae_duplicate tensor(-0.0628, dtype=torch.float64) tensor(-1.3011, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3375, dtype=torch.float64) delta_t tensor(-0.0684, dtype=torch.float64)
14 gae_duplicate tensor(-1.3571, dtype=torch.float64) tensor(0.9362, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1711, dtype=torch.float64) delta_t tensor(-0.4082, dtype=torch.float64)
13 gae_duplicate tensor(-1.5662, dtype=torch.float64) tensor(6.8279, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2541, dtype=torch.float64) delta_t tensor(0.0880, dtype=torch.float64)
12 gae_duplicate tensor(-0.3284, dtype=torch.float64) tensor(-1.2632, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5616, dtype=torch.float64) delta_t tensor(0.0043, dtype=torch.float64)
11 gae_duplicate tensor(-0.1705, dtype=torch.float64) tensor(-0.1857, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1783, dtype=torch.float64) delta_t tensor(0.0210, dtype=torch.float64)
10 gae_duplicate tensor(-0.1416, dtype=torch.float64) tensor(0.0045, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5061, dtype=torch.float64) delta_t tensor(0.2189, dtype=torch.float64)
9 gae_duplicate tensor(-0.0284, dtype=torch.float64) tensor(-3.6926, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5027, dtype=torch.float64) delta_t tensor(0.0330, dtype=torch.float64)
8 gae_duplicate tensor(-0.1440, dtype=torch.float64) tensor(-0.7737, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6309, dtype=torch.float64) delta_t tensor(0.1067, dtype=torch.float64)
7 gae_duplicate tensor(-0.2412, dtype=torch.float64) tensor(-1.9898, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9209, dtype=torch.float64) delta_t tensor(0.0786, dtype=torch.float64)
6 gae_duplicate tensor(-0.2660, dtype=torch.float64) tensor(-1.5812, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1884, dtype=torch.float64) delta_t tensor(0.0259, dtype=torch.float64)
5 gae_duplicate tensor(-0.2625, dtype=torch.float64) tensor(-1.1721, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2260, dtype=torch.float64) delta_t tensor(-0.0723, dtype=torch.float64)
4 gae_duplicate tensor(-0.4532, dtype=torch.float64) tensor(1.4507, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5985, dtype=torch.float64) delta_t tensor(0.1833, dtype=torch.float64)
3 gae_duplicate tensor(-0.2542, dtype=torch.float64) tensor(-3.8482, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0112, dtype=torch.float64) delta_t tensor(-0.1595, dtype=torch.float64)
2 gae_duplicate tensor(-0.5846, dtype=torch.float64) tensor(3.0045, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:359.4830627441406
value loss:17.799678802490234
entropies:336.322021484375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3887.6011)
ToM Target loss= tensor(3756.8091)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.19019627571106 seconds
19 rew tensor(1.1633, dtype=torch.float64) delta_t tensor(0.0171, dtype=torch.float64)
19 gae_duplicate tensor(-0.1334, dtype=torch.float64) tensor(-0.2928, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1504, dtype=torch.float64) delta_t tensor(0.1392, dtype=torch.float64)
18 gae_duplicate tensor(-0.0003, dtype=torch.float64) tensor(-2.7181, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9800, dtype=torch.float64) delta_t tensor(0.0192, dtype=torch.float64)
17 gae_duplicate tensor(-0.0425, dtype=torch.float64) tensor(-0.5420, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9589, dtype=torch.float64) delta_t tensor(-0.0109, dtype=torch.float64)
16 gae_duplicate tensor(-0.1867, dtype=torch.float64) tensor(-0.2591, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7886, dtype=torch.float64) delta_t tensor(0.1004, dtype=torch.float64)
15 gae_duplicate tensor(-0.0009, dtype=torch.float64) tensor(-1.6894, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9062, dtype=torch.float64) delta_t tensor(0.2039, dtype=torch.float64)
14 gae_duplicate tensor(0.0772, dtype=torch.float64) tensor(-3.9131, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4910, dtype=torch.float64) delta_t tensor(0.0087, dtype=torch.float64)
13 gae_duplicate tensor(-0.0528, dtype=torch.float64) tensor(-0.6346, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4240, dtype=torch.float64) delta_t tensor(0.1549, dtype=torch.float64)
12 gae_duplicate tensor(0.0010, dtype=torch.float64) tensor(-2.9157, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1805, dtype=torch.float64) delta_t tensor(-0.0526, dtype=torch.float64)
11 gae_duplicate tensor(-0.0864, dtype=torch.float64) tensor(0.7096, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1727, dtype=torch.float64) delta_t tensor(0.0529, dtype=torch.float64)
10 gae_duplicate tensor(-0.1343, dtype=torch.float64) tensor(-0.8141, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1063, dtype=torch.float64) delta_t tensor(0.2879, dtype=torch.float64)
9 gae_duplicate tensor(0.1862, dtype=torch.float64) tensor(-5.1580, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4092, dtype=torch.float64) delta_t tensor(-0.0854, dtype=torch.float64)
8 gae_duplicate tensor(-0.2694, dtype=torch.float64) tensor(1.3595, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2560, dtype=torch.float64) delta_t tensor(0.1098, dtype=torch.float64)
7 gae_duplicate tensor(-0.2568, dtype=torch.float64) tensor(-1.8802, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5273, dtype=torch.float64) delta_t tensor(0.1556, dtype=torch.float64)
6 gae_duplicate tensor(-0.0979, dtype=torch.float64) tensor(-3.2384, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8110, dtype=torch.float64) delta_t tensor(0.0231, dtype=torch.float64)
5 gae_duplicate tensor(-0.1689, dtype=torch.float64) tensor(-0.6170, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2334, dtype=torch.float64) delta_t tensor(0.0983, dtype=torch.float64)
4 gae_duplicate tensor(-0.0149, dtype=torch.float64) tensor(-1.7027, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3920, dtype=torch.float64) delta_t tensor(-0.1037, dtype=torch.float64)
3 gae_duplicate tensor(-0.1749, dtype=torch.float64) tensor(1.5745, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5849, dtype=torch.float64) delta_t tensor(0.1436, dtype=torch.float64)
2 gae_duplicate tensor(-0.4394, dtype=torch.float64) tensor(-2.2499, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1258.318115234375
value loss:5.572240829467773
entropies:335.847412109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.191049098968506 seconds
19 rew tensor(1.1534, dtype=torch.float64) delta_t tensor(-0.0166, dtype=torch.float64)
19 gae_duplicate tensor(-0.1282, dtype=torch.float64) tensor(0.1836, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1674, dtype=torch.float64) delta_t tensor(0.1435, dtype=torch.float64)
18 gae_duplicate tensor(-0.0612, dtype=torch.float64) tensor(-3.3878, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0501, dtype=torch.float64) delta_t tensor(0.0115, dtype=torch.float64)
17 gae_duplicate tensor(-0.0367, dtype=torch.float64) tensor(-0.4087, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9867, dtype=torch.float64) delta_t tensor(0.0031, dtype=torch.float64)
16 gae_duplicate tensor(-0.1646, dtype=torch.float64) tensor(-0.1858, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9082, dtype=torch.float64) delta_t tensor(0.0482, dtype=torch.float64)
15 gae_duplicate tensor(-0.0992, dtype=torch.float64) tensor(-0.8228, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7695, dtype=torch.float64) delta_t tensor(0.1688, dtype=torch.float64)
14 gae_duplicate tensor(0.0777, dtype=torch.float64) tensor(-2.9879, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0839, dtype=torch.float64) delta_t tensor(-0.6915, dtype=torch.float64)
13 gae_duplicate tensor(-4.4635, dtype=torch.float64) tensor(11.4087, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0504, dtype=torch.float64) delta_t tensor(-0.1152, dtype=torch.float64)
12 gae_duplicate tensor(-1.4452, dtype=torch.float64) tensor(2.9164, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2547, dtype=torch.float64) delta_t tensor(-0.2426, dtype=torch.float64)
11 gae_duplicate tensor(-1.7038, dtype=torch.float64) tensor(4.2615, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0147, dtype=torch.float64) delta_t tensor(0.1086, dtype=torch.float64)
10 gae_duplicate tensor(-0.0857, dtype=torch.float64) tensor(-1.5139, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4145, dtype=torch.float64) delta_t tensor(0.2111, dtype=torch.float64)
9 gae_duplicate tensor(-0.0850, dtype=torch.float64) tensor(-4.0196, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5947, dtype=torch.float64) delta_t tensor(-0.0808, dtype=torch.float64)
8 gae_duplicate tensor(-0.2231, dtype=torch.float64) tensor(0.9875, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5926, dtype=torch.float64) delta_t tensor(0.1641, dtype=torch.float64)
7 gae_duplicate tensor(-0.0966, dtype=torch.float64) tensor(-2.6435, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6615, dtype=torch.float64) delta_t tensor(0.0902, dtype=torch.float64)
6 gae_duplicate tensor(0.0129, dtype=torch.float64) tensor(-1.7783, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4520, dtype=torch.float64) delta_t tensor(0.1055, dtype=torch.float64)
5 gae_duplicate tensor(-0.0691, dtype=torch.float64) tensor(-1.9607, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0703, dtype=torch.float64) delta_t tensor(-0.0416, dtype=torch.float64)
4 gae_duplicate tensor(-0.1332, dtype=torch.float64) tensor(0.6074, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9129, dtype=torch.float64) delta_t tensor(-0.0527, dtype=torch.float64)
3 gae_duplicate tensor(-0.2979, dtype=torch.float64) tensor(1.4260, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2932, dtype=torch.float64) delta_t tensor(-0.0863, dtype=torch.float64)
2 gae_duplicate tensor(-0.4578, dtype=torch.float64) tensor(1.6976, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-294.6390686035156
value loss:41.72943115234375
entropies:335.30816650390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.11391282081604 seconds
19 rew tensor(1.2041, dtype=torch.float64) delta_t tensor(0.0361, dtype=torch.float64)
19 gae_duplicate tensor(-0.1265, dtype=torch.float64) tensor(-0.8008, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1412, dtype=torch.float64) delta_t tensor(0.1020, dtype=torch.float64)
18 gae_duplicate tensor(-0.0549, dtype=torch.float64) tensor(-1.9284, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0919, dtype=torch.float64) delta_t tensor(0.0423, dtype=torch.float64)
17 gae_duplicate tensor(-0.2615, dtype=torch.float64) tensor(-0.3688, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0091, dtype=torch.float64) delta_t tensor(0.0983, dtype=torch.float64)
16 gae_duplicate tensor(-0.0521, dtype=torch.float64) tensor(-1.7130, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9378, dtype=torch.float64) delta_t tensor(0.0806, dtype=torch.float64)
15 gae_duplicate tensor(-0.1001, dtype=torch.float64) tensor(-1.6945, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.1576, dtype=torch.float64) delta_t tensor(-0.5970, dtype=torch.float64)
14 gae_duplicate tensor(-2.8173, dtype=torch.float64) tensor(11.2632, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7018, dtype=torch.float64) delta_t tensor(0.0919, dtype=torch.float64)
13 gae_duplicate tensor(-0.3020, dtype=torch.float64) tensor(-0.6670, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3192, dtype=torch.float64) delta_t tensor(0.1532, dtype=torch.float64)
12 gae_duplicate tensor(-0.1885, dtype=torch.float64) tensor(-3.3184, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4900, dtype=torch.float64) delta_t tensor(0.0686, dtype=torch.float64)
11 gae_duplicate tensor(-0.1016, dtype=torch.float64) tensor(-1.9264, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0924, dtype=torch.float64) delta_t tensor(-0.0033, dtype=torch.float64)
10 gae_duplicate tensor(-0.1591, dtype=torch.float64) tensor(-0.2030, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3981, dtype=torch.float64) delta_t tensor(0.1521, dtype=torch.float64)
9 gae_duplicate tensor(-0.0627, dtype=torch.float64) tensor(-3.2133, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5138, dtype=torch.float64) delta_t tensor(-0.0579, dtype=torch.float64)
8 gae_duplicate tensor(-0.2645, dtype=torch.float64) tensor(0.9972, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7309, dtype=torch.float64) delta_t tensor(0.0506, dtype=torch.float64)
7 gae_duplicate tensor(-0.1253, dtype=torch.float64) tensor(-0.9268, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6180, dtype=torch.float64) delta_t tensor(0.0800, dtype=torch.float64)
6 gae_duplicate tensor(-0.1777, dtype=torch.float64) tensor(-1.8843, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6084, dtype=torch.float64) delta_t tensor(-0.0187, dtype=torch.float64)
5 gae_duplicate tensor(-0.1921, dtype=torch.float64) tensor(0.1018, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0501, dtype=torch.float64) delta_t tensor(-0.0224, dtype=torch.float64)
4 gae_duplicate tensor(-0.2021, dtype=torch.float64) tensor(0.3044, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0338, dtype=torch.float64) delta_t tensor(0.0181, dtype=torch.float64)
3 gae_duplicate tensor(-0.1831, dtype=torch.float64) tensor(-0.1229, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3004, dtype=torch.float64) delta_t tensor(-0.0042, dtype=torch.float64)
2 gae_duplicate tensor(-0.3790, dtype=torch.float64) tensor(0.3224, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:221.58694458007812
value loss:20.024585723876953
entropies:335.0288391113281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.925209045410156 seconds
19 rew tensor(1.1792, dtype=torch.float64) delta_t tensor(-0.0151, dtype=torch.float64)
19 gae_duplicate tensor(-0.1596, dtype=torch.float64) tensor(0.2261, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1559, dtype=torch.float64) delta_t tensor(0.1391, dtype=torch.float64)
18 gae_duplicate tensor(-0.0535, dtype=torch.float64) tensor(-2.4485, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0489, dtype=torch.float64) delta_t tensor(0.0413, dtype=torch.float64)
17 gae_duplicate tensor(-0.1051, dtype=torch.float64) tensor(-1.2180, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9212, dtype=torch.float64) delta_t tensor(0.0130, dtype=torch.float64)
16 gae_duplicate tensor(-0.1467, dtype=torch.float64) tensor(-0.6499, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8931, dtype=torch.float64) delta_t tensor(0.1502, dtype=torch.float64)
15 gae_duplicate tensor(-0.0641, dtype=torch.float64) tensor(-2.7676, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1226, dtype=torch.float64) delta_t tensor(-0.2961, dtype=torch.float64)
14 gae_duplicate tensor(-1.3601, dtype=torch.float64) tensor(6.2659, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6871, dtype=torch.float64) delta_t tensor(0.0996, dtype=torch.float64)
13 gae_duplicate tensor(-0.0534, dtype=torch.float64) tensor(-1.2259, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1890, dtype=torch.float64) delta_t tensor(0.1062, dtype=torch.float64)
12 gae_duplicate tensor(0.0277, dtype=torch.float64) tensor(-1.9676, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6222, dtype=torch.float64) delta_t tensor(0.1254, dtype=torch.float64)
11 gae_duplicate tensor(0.0145, dtype=torch.float64) tensor(-2.2944, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1512, dtype=torch.float64) delta_t tensor(-0.0878, dtype=torch.float64)
10 gae_duplicate tensor(-0.2020, dtype=torch.float64) tensor(1.5048, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4173, dtype=torch.float64) delta_t tensor(0.0912, dtype=torch.float64)
9 gae_duplicate tensor(-0.2686, dtype=torch.float64) tensor(-2.2375, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6216, dtype=torch.float64) delta_t tensor(-0.1223, dtype=torch.float64)
8 gae_duplicate tensor(-0.3981, dtype=torch.float64) tensor(2.0083, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4071, dtype=torch.float64) delta_t tensor(0.2019, dtype=torch.float64)
7 gae_duplicate tensor(0.1212, dtype=torch.float64) tensor(-3.1774, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7632, dtype=torch.float64) delta_t tensor(0.0217, dtype=torch.float64)
6 gae_duplicate tensor(-0.1951, dtype=torch.float64) tensor(-0.5618, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3231, dtype=torch.float64) delta_t tensor(0.0651, dtype=torch.float64)
5 gae_duplicate tensor(-0.1220, dtype=torch.float64) tensor(-1.1452, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2052, dtype=torch.float64) delta_t tensor(-0.0344, dtype=torch.float64)
4 gae_duplicate tensor(-0.2050, dtype=torch.float64) tensor(0.5085, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7358, dtype=torch.float64) delta_t tensor(-0.0741, dtype=torch.float64)
3 gae_duplicate tensor(-0.4075, dtype=torch.float64) tensor(1.9661, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1345, dtype=torch.float64) delta_t tensor(-0.1695, dtype=torch.float64)
2 gae_duplicate tensor(-0.5140, dtype=torch.float64) tensor(3.2500, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:123.6297607421875
value loss:10.045208930969238
entropies:334.9053649902344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.663247108459473 seconds
19 rew tensor(1.1503, dtype=torch.float64) delta_t tensor(0.0051, dtype=torch.float64)
19 gae_duplicate tensor(-0.1314, dtype=torch.float64) tensor(-0.1387, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1398, dtype=torch.float64) delta_t tensor(0.1356, dtype=torch.float64)
18 gae_duplicate tensor(0.0234, dtype=torch.float64) tensor(-2.7800, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0245, dtype=torch.float64) delta_t tensor(0.0281, dtype=torch.float64)
17 gae_duplicate tensor(-0.0365, dtype=torch.float64) tensor(-0.8078, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9581, dtype=torch.float64) delta_t tensor(0.0540, dtype=torch.float64)
16 gae_duplicate tensor(-0.0546, dtype=torch.float64) tensor(-1.0645, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8557, dtype=torch.float64) delta_t tensor(0.0441, dtype=torch.float64)
15 gae_duplicate tensor(-0.0585, dtype=torch.float64) tensor(-0.8364, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7116, dtype=torch.float64) delta_t tensor(0.2173, dtype=torch.float64)
14 gae_duplicate tensor(-0.1303, dtype=torch.float64) tensor(-3.3841, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6918, dtype=torch.float64) delta_t tensor(0.0612, dtype=torch.float64)
13 gae_duplicate tensor(-0.0385, dtype=torch.float64) tensor(-1.4863, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2539, dtype=torch.float64) delta_t tensor(0.0397, dtype=torch.float64)
12 gae_duplicate tensor(-0.2075, dtype=torch.float64) tensor(-1.1713, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5993, dtype=torch.float64) delta_t tensor(0.1347, dtype=torch.float64)
11 gae_duplicate tensor(-0.0820, dtype=torch.float64) tensor(-2.2858, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2386, dtype=torch.float64) delta_t tensor(-0.1930, dtype=torch.float64)
10 gae_duplicate tensor(-0.3462, dtype=torch.float64) tensor(3.5483, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4103, dtype=torch.float64) delta_t tensor(0.2000, dtype=torch.float64)
9 gae_duplicate tensor(-0.0735, dtype=torch.float64) tensor(-3.2577, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5150, dtype=torch.float64) delta_t tensor(-0.1489, dtype=torch.float64)
8 gae_duplicate tensor(-0.3531, dtype=torch.float64) tensor(2.5595, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9324, dtype=torch.float64) delta_t tensor(-0.2091, dtype=torch.float64)
7 gae_duplicate tensor(-1.2504, dtype=torch.float64) tensor(3.7396, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7494, dtype=torch.float64) delta_t tensor(-0.1598, dtype=torch.float64)
6 gae_duplicate tensor(-0.3379, dtype=torch.float64) tensor(3.0149, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4295, dtype=torch.float64) delta_t tensor(-0.0440, dtype=torch.float64)
5 gae_duplicate tensor(-0.2751, dtype=torch.float64) tensor(1.1920, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0776, dtype=torch.float64) delta_t tensor(-0.0319, dtype=torch.float64)
4 gae_duplicate tensor(-0.2432, dtype=torch.float64) tensor(0.2675, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9158, dtype=torch.float64) delta_t tensor(-0.0669, dtype=torch.float64)
3 gae_duplicate tensor(-0.4803, dtype=torch.float64) tensor(0.8683, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2879, dtype=torch.float64) delta_t tensor(-0.0038, dtype=torch.float64)
2 gae_duplicate tensor(-0.2419, dtype=torch.float64) tensor(0.7443, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-21.297269821166992
value loss:8.34683609008789
entropies:334.5131530761719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3856.2314)
ToM Target loss= tensor(3749.5696)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.1381189823150635 seconds
19 rew tensor(1.1670, dtype=torch.float64) delta_t tensor(-0.0572, dtype=torch.float64)
19 gae_duplicate tensor(-0.1554, dtype=torch.float64) tensor(0.9461, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1417, dtype=torch.float64) delta_t tensor(0.0628, dtype=torch.float64)
18 gae_duplicate tensor(-0.0520, dtype=torch.float64) tensor(-0.9453, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0625, dtype=torch.float64) delta_t tensor(-0.0036, dtype=torch.float64)
17 gae_duplicate tensor(-0.1845, dtype=torch.float64) tensor(-0.0073, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9822, dtype=torch.float64) delta_t tensor(0.0178, dtype=torch.float64)
16 gae_duplicate tensor(-0.0938, dtype=torch.float64) tensor(-0.4163, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.3832, dtype=torch.float64) delta_t tensor(-0.4484, dtype=torch.float64)
15 gae_duplicate tensor(-2.7285, dtype=torch.float64) tensor(7.3519, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6926, dtype=torch.float64) delta_t tensor(0.2604, dtype=torch.float64)
14 gae_duplicate tensor(-0.0024, dtype=torch.float64) tensor(-3.5639, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7253, dtype=torch.float64) delta_t tensor(0.1247, dtype=torch.float64)
13 gae_duplicate tensor(-0.0065, dtype=torch.float64) tensor(-2.4389, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2665, dtype=torch.float64) delta_t tensor(0.0615, dtype=torch.float64)
12 gae_duplicate tensor(-0.1930, dtype=torch.float64) tensor(-1.6307, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6378, dtype=torch.float64) delta_t tensor(0.1606, dtype=torch.float64)
11 gae_duplicate tensor(0.0166, dtype=torch.float64) tensor(-3.0866, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2060, dtype=torch.float64) delta_t tensor(-0.1413, dtype=torch.float64)
10 gae_duplicate tensor(-0.2465, dtype=torch.float64) tensor(2.0986, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4274, dtype=torch.float64) delta_t tensor(0.1098, dtype=torch.float64)
9 gae_duplicate tensor(-0.1311, dtype=torch.float64) tensor(-1.6156, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5684, dtype=torch.float64) delta_t tensor(-0.0377, dtype=torch.float64)
8 gae_duplicate tensor(-0.1650, dtype=torch.float64) tensor(0.2387, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1466, dtype=torch.float64) delta_t tensor(-0.2783, dtype=torch.float64)
7 gae_duplicate tensor(-2.3517, dtype=torch.float64) tensor(4.6323, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8176, dtype=torch.float64) delta_t tensor(-0.1286, dtype=torch.float64)
6 gae_duplicate tensor(-0.4950, dtype=torch.float64) tensor(2.5925, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4030, dtype=torch.float64) delta_t tensor(0.0854, dtype=torch.float64)
5 gae_duplicate tensor(-0.1681, dtype=torch.float64) tensor(-1.0024, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0254, dtype=torch.float64) delta_t tensor(-0.0113, dtype=torch.float64)
4 gae_duplicate tensor(-0.2083, dtype=torch.float64) tensor(0.0470, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9948, dtype=torch.float64) delta_t tensor(-0.0799, dtype=torch.float64)
3 gae_duplicate tensor(-0.3718, dtype=torch.float64) tensor(1.8837, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3143, dtype=torch.float64) delta_t tensor(0.0439, dtype=torch.float64)
2 gae_duplicate tensor(-0.2701, dtype=torch.float64) tensor(-0.6504, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-329.6365051269531
value loss:25.425243377685547
entropies:334.1639404296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.806819677352905 seconds
19 rew tensor(1.1751, dtype=torch.float64) delta_t tensor(-0.1208, dtype=torch.float64)
19 gae_duplicate tensor(-0.1618, dtype=torch.float64) tensor(2.1268, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1488, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
18 gae_duplicate tensor(-0.1511, dtype=torch.float64) tensor(0.0466, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1238, dtype=torch.float64) delta_t tensor(0.0033, dtype=torch.float64)
17 gae_duplicate tensor(-0.1667, dtype=torch.float64) tensor(-0.1461, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0058, dtype=torch.float64) delta_t tensor(-0.0465, dtype=torch.float64)
16 gae_duplicate tensor(-0.1831, dtype=torch.float64) tensor(0.8176, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9175, dtype=torch.float64) delta_t tensor(0.1360, dtype=torch.float64)
15 gae_duplicate tensor(-0.1148, dtype=torch.float64) tensor(-2.8820, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1682, dtype=torch.float64) delta_t tensor(-0.2451, dtype=torch.float64)
14 gae_duplicate tensor(-1.2877, dtype=torch.float64) tensor(3.4137, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7263, dtype=torch.float64) delta_t tensor(0.0967, dtype=torch.float64)
13 gae_duplicate tensor(-0.2925, dtype=torch.float64) tensor(-1.6268, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2936, dtype=torch.float64) delta_t tensor(0.1189, dtype=torch.float64)
12 gae_duplicate tensor(-0.2153, dtype=torch.float64) tensor(-2.2777, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7749, dtype=torch.float64) delta_t tensor(0.2151, dtype=torch.float64)
11 gae_duplicate tensor(0.1035, dtype=torch.float64) tensor(-4.7275, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2362, dtype=torch.float64) delta_t tensor(-0.1406, dtype=torch.float64)
10 gae_duplicate tensor(-0.1879, dtype=torch.float64) tensor(1.9528, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4574, dtype=torch.float64) delta_t tensor(0.1731, dtype=torch.float64)
9 gae_duplicate tensor(-0.1712, dtype=torch.float64) tensor(-3.0578, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6913, dtype=torch.float64) delta_t tensor(-0.2049, dtype=torch.float64)
8 gae_duplicate tensor(-0.5688, dtype=torch.float64) tensor(3.2141, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5331, dtype=torch.float64) delta_t tensor(-0.5589, dtype=torch.float64)
7 gae_duplicate tensor(-2.9321, dtype=torch.float64) tensor(9.3013, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8357, dtype=torch.float64) delta_t tensor(-0.1290, dtype=torch.float64)
6 gae_duplicate tensor(-0.6375, dtype=torch.float64) tensor(2.9020, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4846, dtype=torch.float64) delta_t tensor(0.1597, dtype=torch.float64)
5 gae_duplicate tensor(-0.1609, dtype=torch.float64) tensor(-2.3774, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1245, dtype=torch.float64) delta_t tensor(0.1125, dtype=torch.float64)
4 gae_duplicate tensor(-0.1731, dtype=torch.float64) tensor(-2.1430, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2987, dtype=torch.float64) delta_t tensor(-0.1934, dtype=torch.float64)
3 gae_duplicate tensor(-0.6911, dtype=torch.float64) tensor(3.9202, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4645, dtype=torch.float64) delta_t tensor(0.0608, dtype=torch.float64)
2 gae_duplicate tensor(-0.3863, dtype=torch.float64) tensor(-0.6858, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-509.8372802734375
value loss:25.82489013671875
entropies:334.1015319824219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.947511196136475 seconds
19 rew tensor(1.1648, dtype=torch.float64) delta_t tensor(-0.1317, dtype=torch.float64)
19 gae_duplicate tensor(-0.1964, dtype=torch.float64) tensor(2.3479, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1665, dtype=torch.float64) delta_t tensor(0.0079, dtype=torch.float64)
18 gae_duplicate tensor(-0.0851, dtype=torch.float64) tensor(0.0782, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0894, dtype=torch.float64) delta_t tensor(-0.0600, dtype=torch.float64)
17 gae_duplicate tensor(-0.1485, dtype=torch.float64) tensor(0.8191, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0131, dtype=torch.float64) delta_t tensor(-0.0362, dtype=torch.float64)
16 gae_duplicate tensor(-0.1952, dtype=torch.float64) tensor(0.7881, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9593, dtype=torch.float64) delta_t tensor(-0.0164, dtype=torch.float64)
15 gae_duplicate tensor(-0.1629, dtype=torch.float64) tensor(0.3433, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7888, dtype=torch.float64) delta_t tensor(0.2822, dtype=torch.float64)
14 gae_duplicate tensor(0.0076, dtype=torch.float64) tensor(-4.6511, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1079, dtype=torch.float64) delta_t tensor(-0.4806, dtype=torch.float64)
13 gae_duplicate tensor(-2.9552, dtype=torch.float64) tensor(7.3881, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2441, dtype=torch.float64) delta_t tensor(0.0411, dtype=torch.float64)
12 gae_duplicate tensor(-0.1625, dtype=torch.float64) tensor(-0.0076, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4765, dtype=torch.float64) delta_t tensor(-0.0443, dtype=torch.float64)
11 gae_duplicate tensor(-0.3134, dtype=torch.float64) tensor(0.7448, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1379, dtype=torch.float64) delta_t tensor(-0.0865, dtype=torch.float64)
10 gae_duplicate tensor(-0.1847, dtype=torch.float64) tensor(1.6019, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4148, dtype=torch.float64) delta_t tensor(0.1935, dtype=torch.float64)
9 gae_duplicate tensor(-0.0716, dtype=torch.float64) tensor(-3.3340, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5936, dtype=torch.float64) delta_t tensor(-0.1724, dtype=torch.float64)
8 gae_duplicate tensor(-0.3740, dtype=torch.float64) tensor(2.6592, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7920, dtype=torch.float64) delta_t tensor(0.1396, dtype=torch.float64)
7 gae_duplicate tensor(-0.0491, dtype=torch.float64) tensor(-2.0293, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6724, dtype=torch.float64) delta_t tensor(-0.0415, dtype=torch.float64)
6 gae_duplicate tensor(-0.1312, dtype=torch.float64) tensor(0.3120, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5602, dtype=torch.float64) delta_t tensor(0.0317, dtype=torch.float64)
5 gae_duplicate tensor(-0.2587, dtype=torch.float64) tensor(-0.1998, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0333, dtype=torch.float64) delta_t tensor(0.0417, dtype=torch.float64)
4 gae_duplicate tensor(-0.1319, dtype=torch.float64) tensor(-0.8240, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0944, dtype=torch.float64) delta_t tensor(-0.0138, dtype=torch.float64)
3 gae_duplicate tensor(-0.4514, dtype=torch.float64) tensor(0.1389, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3983, dtype=torch.float64) delta_t tensor(0.0126, dtype=torch.float64)
2 gae_duplicate tensor(-0.4656, dtype=torch.float64) tensor(-1.1276, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-362.8792724609375
value loss:18.626115798950195
entropies:334.3965759277344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.266103029251099 seconds
19 rew tensor(1.1919, dtype=torch.float64) delta_t tensor(-0.1374, dtype=torch.float64)
19 gae_duplicate tensor(-0.1899, dtype=torch.float64) tensor(2.4889, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1784, dtype=torch.float64) delta_t tensor(0.0116, dtype=torch.float64)
18 gae_duplicate tensor(-0.1314, dtype=torch.float64) tensor(0.0111, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7740, dtype=torch.float64) delta_t tensor(-0.3586, dtype=torch.float64)
17 gae_duplicate tensor(-1.7215, dtype=torch.float64) tensor(6.4234, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9469, dtype=torch.float64) delta_t tensor(-0.0292, dtype=torch.float64)
16 gae_duplicate tensor(-0.3285, dtype=torch.float64) tensor(0.6560, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8933, dtype=torch.float64) delta_t tensor(-0.0026, dtype=torch.float64)
15 gae_duplicate tensor(-0.2094, dtype=torch.float64) tensor(-0.0270, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4036, dtype=torch.float64) delta_t tensor(-0.1863, dtype=torch.float64)
14 gae_duplicate tensor(-1.4017, dtype=torch.float64) tensor(4.6198, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4340, dtype=torch.float64) delta_t tensor(-0.1166, dtype=torch.float64)
13 gae_duplicate tensor(-1.3701, dtype=torch.float64) tensor(1.7200, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4162, dtype=torch.float64) delta_t tensor(0.0842, dtype=torch.float64)
12 gae_duplicate tensor(-0.1602, dtype=torch.float64) tensor(-1.6158, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2423, dtype=torch.float64) delta_t tensor(-0.0565, dtype=torch.float64)
11 gae_duplicate tensor(-0.1972, dtype=torch.float64) tensor(0.9302, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0745, dtype=torch.float64) delta_t tensor(-0.0293, dtype=torch.float64)
10 gae_duplicate tensor(-0.1557, dtype=torch.float64) tensor(0.5754, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2266, dtype=torch.float64) delta_t tensor(0.0286, dtype=torch.float64)
9 gae_duplicate tensor(-0.1904, dtype=torch.float64) tensor(-0.4376, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4856, dtype=torch.float64) delta_t tensor(-0.0497, dtype=torch.float64)
8 gae_duplicate tensor(-0.2450, dtype=torch.float64) tensor(0.7841, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7941, dtype=torch.float64) delta_t tensor(0.0360, dtype=torch.float64)
7 gae_duplicate tensor(-0.3784, dtype=torch.float64) tensor(-1.4684, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5659, dtype=torch.float64) delta_t tensor(0.1564, dtype=torch.float64)
6 gae_duplicate tensor(-0.0832, dtype=torch.float64) tensor(-3.6173, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6920, dtype=torch.float64) delta_t tensor(-0.0489, dtype=torch.float64)
5 gae_duplicate tensor(-0.2054, dtype=torch.float64) tensor(0.6059, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0689, dtype=torch.float64) delta_t tensor(0.0930, dtype=torch.float64)
4 gae_duplicate tensor(-0.0732, dtype=torch.float64) tensor(-1.7876, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0565, dtype=torch.float64) delta_t tensor(-0.0703, dtype=torch.float64)
3 gae_duplicate tensor(-0.1041, dtype=torch.float64) tensor(1.2151, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2834, dtype=torch.float64) delta_t tensor(-0.1206, dtype=torch.float64)
2 gae_duplicate tensor(-0.4492, dtype=torch.float64) tensor(1.3026, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-758.903076171875
value loss:15.05486011505127
entropies:334.978515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.871267080307007 seconds
19 rew tensor(1.1920, dtype=torch.float64) delta_t tensor(-0.1174, dtype=torch.float64)
19 gae_duplicate tensor(-0.2009, dtype=torch.float64) tensor(1.9958, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1923, dtype=torch.float64) delta_t tensor(0.0109, dtype=torch.float64)
18 gae_duplicate tensor(-0.1015, dtype=torch.float64) tensor(0.0886, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1017, dtype=torch.float64) delta_t tensor(-0.0457, dtype=torch.float64)
17 gae_duplicate tensor(-0.2258, dtype=torch.float64) tensor(0.7703, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9881, dtype=torch.float64) delta_t tensor(-0.0868, dtype=torch.float64)
16 gae_duplicate tensor(-0.2510, dtype=torch.float64) tensor(1.7530, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8326, dtype=torch.float64) delta_t tensor(-0.0927, dtype=torch.float64)
15 gae_duplicate tensor(-0.2487, dtype=torch.float64) tensor(2.3587, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7249, dtype=torch.float64) delta_t tensor(0.0117, dtype=torch.float64)
14 gae_duplicate tensor(-0.1736, dtype=torch.float64) tensor(0.2706, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5865, dtype=torch.float64) delta_t tensor(0.0517, dtype=torch.float64)
13 gae_duplicate tensor(-0.1642, dtype=torch.float64) tensor(-0.8135, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3544, dtype=torch.float64) delta_t tensor(-0.0192, dtype=torch.float64)
12 gae_duplicate tensor(-0.1268, dtype=torch.float64) tensor(0.0800, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2749, dtype=torch.float64) delta_t tensor(-0.0654, dtype=torch.float64)
11 gae_duplicate tensor(-0.1539, dtype=torch.float64) tensor(1.2846, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0643, dtype=torch.float64) delta_t tensor(-0.0015, dtype=torch.float64)
10 gae_duplicate tensor(-0.2097, dtype=torch.float64) tensor(0.4939, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2118, dtype=torch.float64) delta_t tensor(0.1285, dtype=torch.float64)
9 gae_duplicate tensor(-0.0141, dtype=torch.float64) tensor(-2.5549, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4642, dtype=torch.float64) delta_t tensor(-0.0807, dtype=torch.float64)
8 gae_duplicate tensor(-0.1778, dtype=torch.float64) tensor(0.9036, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1756, dtype=torch.float64) delta_t tensor(0.1373, dtype=torch.float64)
7 gae_duplicate tensor(-0.1963, dtype=torch.float64) tensor(-2.1364, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5565, dtype=torch.float64) delta_t tensor(0.1459, dtype=torch.float64)
6 gae_duplicate tensor(-0.0616, dtype=torch.float64) tensor(-2.6586, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7665, dtype=torch.float64) delta_t tensor(-0.0048, dtype=torch.float64)
5 gae_duplicate tensor(-0.3038, dtype=torch.float64) tensor(-0.1562, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2132, dtype=torch.float64) delta_t tensor(0.1263, dtype=torch.float64)
4 gae_duplicate tensor(-0.0927, dtype=torch.float64) tensor(-2.6770, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3910, dtype=torch.float64) delta_t tensor(-0.1671, dtype=torch.float64)
3 gae_duplicate tensor(-0.3529, dtype=torch.float64) tensor(3.2370, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5913, dtype=torch.float64) delta_t tensor(0.1508, dtype=torch.float64)
2 gae_duplicate tensor(-0.4493, dtype=torch.float64) tensor(-2.6037, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-71.01522064208984
value loss:5.656306743621826
entropies:335.86749267578125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3848.0183)
ToM Target loss= tensor(3738.1880)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.73619818687439 seconds
19 rew tensor(1.1787, dtype=torch.float64) delta_t tensor(-0.1424, dtype=torch.float64)
19 gae_duplicate tensor(-0.2888, dtype=torch.float64) tensor(2.6508, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8929, dtype=torch.float64) delta_t tensor(-0.2319, dtype=torch.float64)
18 gae_duplicate tensor(-1.3825, dtype=torch.float64) tensor(4.3116, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1011, dtype=torch.float64) delta_t tensor(-0.0594, dtype=torch.float64)
17 gae_duplicate tensor(-0.1716, dtype=torch.float64) tensor(1.4108, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9196, dtype=torch.float64) delta_t tensor(-0.1152, dtype=torch.float64)
16 gae_duplicate tensor(-0.2457, dtype=torch.float64) tensor(2.3926, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8952, dtype=torch.float64) delta_t tensor(0.0107, dtype=torch.float64)
15 gae_duplicate tensor(-0.2740, dtype=torch.float64) tensor(-0.0639, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6606, dtype=torch.float64) delta_t tensor(0.0818, dtype=torch.float64)
14 gae_duplicate tensor(-0.0703, dtype=torch.float64) tensor(-1.5095, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8414, dtype=torch.float64) delta_t tensor(0.1664, dtype=torch.float64)
13 gae_duplicate tensor(-0.0940, dtype=torch.float64) tensor(-3.2197, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2443, dtype=torch.float64) delta_t tensor(-0.0768, dtype=torch.float64)
12 gae_duplicate tensor(-0.2706, dtype=torch.float64) tensor(1.1456, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3884, dtype=torch.float64) delta_t tensor(0.0565, dtype=torch.float64)
11 gae_duplicate tensor(-0.1087, dtype=torch.float64) tensor(-1.1092, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0290, dtype=torch.float64) delta_t tensor(-0.0744, dtype=torch.float64)
10 gae_duplicate tensor(-0.1850, dtype=torch.float64) tensor(1.5305, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2023, dtype=torch.float64) delta_t tensor(0.0545, dtype=torch.float64)
9 gae_duplicate tensor(-0.2109, dtype=torch.float64) tensor(-0.8025, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4885, dtype=torch.float64) delta_t tensor(-0.0999, dtype=torch.float64)
8 gae_duplicate tensor(-0.3264, dtype=torch.float64) tensor(1.6002, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5061, dtype=torch.float64) delta_t tensor(-0.5036, dtype=torch.float64)
7 gae_duplicate tensor(-3.3931, dtype=torch.float64) tensor(12.0824, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5833, dtype=torch.float64) delta_t tensor(0.1076, dtype=torch.float64)
6 gae_duplicate tensor(-0.3910, dtype=torch.float64) tensor(-1.1247, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7434, dtype=torch.float64) delta_t tensor(-0.0289, dtype=torch.float64)
5 gae_duplicate tensor(-0.1203, dtype=torch.float64) tensor(0.3898, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0664, dtype=torch.float64) delta_t tensor(0.1065, dtype=torch.float64)
4 gae_duplicate tensor(-0.0836, dtype=torch.float64) tensor(-1.6782, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2738, dtype=torch.float64) delta_t tensor(-0.2050, dtype=torch.float64)
3 gae_duplicate tensor(-0.7587, dtype=torch.float64) tensor(3.7929, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4054, dtype=torch.float64) delta_t tensor(-0.0187, dtype=torch.float64)
2 gae_duplicate tensor(-0.2887, dtype=torch.float64) tensor(0.1936, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1278.489013671875
value loss:25.482709884643555
entropies:336.5010986328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.881335973739624 seconds
19 rew tensor(1.1510, dtype=torch.float64) delta_t tensor(-0.1158, dtype=torch.float64)
19 gae_duplicate tensor(-0.1874, dtype=torch.float64) tensor(2.3455, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1535, dtype=torch.float64) delta_t tensor(0.0277, dtype=torch.float64)
18 gae_duplicate tensor(-0.1130, dtype=torch.float64) tensor(-0.4799, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5699, dtype=torch.float64) delta_t tensor(-0.5159, dtype=torch.float64)
17 gae_duplicate tensor(-1.5910, dtype=torch.float64) tensor(8.7528, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0133, dtype=torch.float64) delta_t tensor(-0.0654, dtype=torch.float64)
16 gae_duplicate tensor(-0.3418, dtype=torch.float64) tensor(1.9672, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8829, dtype=torch.float64) delta_t tensor(0.0446, dtype=torch.float64)
15 gae_duplicate tensor(-0.2933, dtype=torch.float64) tensor(-0.2477, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8063, dtype=torch.float64) delta_t tensor(0.0678, dtype=torch.float64)
14 gae_duplicate tensor(-0.1311, dtype=torch.float64) tensor(-1.2857, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5581, dtype=torch.float64) delta_t tensor(0.0813, dtype=torch.float64)
13 gae_duplicate tensor(-0.0473, dtype=torch.float64) tensor(-1.6312, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5154, dtype=torch.float64) delta_t tensor(0.1111, dtype=torch.float64)
12 gae_duplicate tensor(-0.0287, dtype=torch.float64) tensor(-2.0150, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0403, dtype=torch.float64) delta_t tensor(-0.3598, dtype=torch.float64)
11 gae_duplicate tensor(-1.8472, dtype=torch.float64) tensor(5.9547, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0312, dtype=torch.float64) delta_t tensor(-0.0202, dtype=torch.float64)
10 gae_duplicate tensor(-0.2009, dtype=torch.float64) tensor(1.1439, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2301, dtype=torch.float64) delta_t tensor(0.0413, dtype=torch.float64)
9 gae_duplicate tensor(-0.1615, dtype=torch.float64) tensor(-0.6897, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4320, dtype=torch.float64) delta_t tensor(-0.1058, dtype=torch.float64)
8 gae_duplicate tensor(-0.1881, dtype=torch.float64) tensor(1.7234, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9259, dtype=torch.float64) delta_t tensor(0.0124, dtype=torch.float64)
7 gae_duplicate tensor(-0.1559, dtype=torch.float64) tensor(0.0540, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5381, dtype=torch.float64) delta_t tensor(0.1457, dtype=torch.float64)
6 gae_duplicate tensor(-0.1912, dtype=torch.float64) tensor(-2.4656, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7956, dtype=torch.float64) delta_t tensor(-0.1621, dtype=torch.float64)
5 gae_duplicate tensor(-0.5424, dtype=torch.float64) tensor(2.6603, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0416, dtype=torch.float64) delta_t tensor(-0.0183, dtype=torch.float64)
4 gae_duplicate tensor(-0.1975, dtype=torch.float64) tensor(0.3116, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1598, dtype=torch.float64) delta_t tensor(0.0920, dtype=torch.float64)
3 gae_duplicate tensor(-0.2379, dtype=torch.float64) tensor(-1.5406, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2977, dtype=torch.float64) delta_t tensor(-0.0507, dtype=torch.float64)
2 gae_duplicate tensor(-0.3407, dtype=torch.float64) tensor(0.7049, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-915.1423950195312
value loss:15.795879364013672
entropies:336.8368835449219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.932676076889038 seconds
19 rew tensor(1.1271, dtype=torch.float64) delta_t tensor(-0.0572, dtype=torch.float64)
19 gae_duplicate tensor(-0.1625, dtype=torch.float64) tensor(1.0177, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1287, dtype=torch.float64) delta_t tensor(0.0699, dtype=torch.float64)
18 gae_duplicate tensor(-0.0914, dtype=torch.float64) tensor(-1.0667, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0610, dtype=torch.float64) delta_t tensor(-0.0014, dtype=torch.float64)
17 gae_duplicate tensor(-0.0869, dtype=torch.float64) tensor(-0.0855, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0496, dtype=torch.float64) delta_t tensor(0.0646, dtype=torch.float64)
16 gae_duplicate tensor(-0.0011, dtype=torch.float64) tensor(-1.2863, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9203, dtype=torch.float64) delta_t tensor(0.0233, dtype=torch.float64)
15 gae_duplicate tensor(-0.1325, dtype=torch.float64) tensor(-0.6927, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7379, dtype=torch.float64) delta_t tensor(0.1547, dtype=torch.float64)
14 gae_duplicate tensor(-0.0960, dtype=torch.float64) tensor(-2.7503, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6725, dtype=torch.float64) delta_t tensor(0.0990, dtype=torch.float64)
13 gae_duplicate tensor(0.0648, dtype=torch.float64) tensor(-2.1154, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2805, dtype=torch.float64) delta_t tensor(0.0284, dtype=torch.float64)
12 gae_duplicate tensor(-0.0655, dtype=torch.float64) tensor(-0.7137, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4816, dtype=torch.float64) delta_t tensor(0.0363, dtype=torch.float64)
11 gae_duplicate tensor(-0.0700, dtype=torch.float64) tensor(-0.5402, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1481, dtype=torch.float64) delta_t tensor(-0.0790, dtype=torch.float64)
10 gae_duplicate tensor(-0.1627, dtype=torch.float64) tensor(1.2043, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3929, dtype=torch.float64) delta_t tensor(0.2111, dtype=torch.float64)
9 gae_duplicate tensor(-0.0075, dtype=torch.float64) tensor(-4.0826, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5951, dtype=torch.float64) delta_t tensor(-0.1870, dtype=torch.float64)
8 gae_duplicate tensor(-0.2680, dtype=torch.float64) tensor(3.1804, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5526, dtype=torch.float64) delta_t tensor(-0.3448, dtype=torch.float64)
7 gae_duplicate tensor(-1.5236, dtype=torch.float64) tensor(6.0786, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6880, dtype=torch.float64) delta_t tensor(-0.0428, dtype=torch.float64)
6 gae_duplicate tensor(-0.2973, dtype=torch.float64) tensor(1.7066, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6289, dtype=torch.float64) delta_t tensor(0.0876, dtype=torch.float64)
5 gae_duplicate tensor(-0.1267, dtype=torch.float64) tensor(-1.2558, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2108, dtype=torch.float64) delta_t tensor(0.0750, dtype=torch.float64)
4 gae_duplicate tensor(-0.1189, dtype=torch.float64) tensor(-1.2027, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3829, dtype=torch.float64) delta_t tensor(-0.1405, dtype=torch.float64)
3 gae_duplicate tensor(-0.5640, dtype=torch.float64) tensor(2.9026, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5760, dtype=torch.float64) delta_t tensor(0.1149, dtype=torch.float64)
2 gae_duplicate tensor(-0.5191, dtype=torch.float64) tensor(-2.4489, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:25.048236846923828
value loss:12.0616455078125
entropies:337.3323669433594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.192981958389282 seconds
19 rew tensor(1.2416, dtype=torch.float64) delta_t tensor(0.0055, dtype=torch.float64)
19 gae_duplicate tensor(-0.0716, dtype=torch.float64) tensor(-0.0405, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2171, dtype=torch.float64) delta_t tensor(0.1513, dtype=torch.float64)
18 gae_duplicate tensor(0.0204, dtype=torch.float64) tensor(-2.5636, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0853, dtype=torch.float64) delta_t tensor(0.0589, dtype=torch.float64)
17 gae_duplicate tensor(-0.0217, dtype=torch.float64) tensor(-1.2779, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0600, dtype=torch.float64) delta_t tensor(0.0590, dtype=torch.float64)
16 gae_duplicate tensor(-0.1209, dtype=torch.float64) tensor(-1.2776, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9820, dtype=torch.float64) delta_t tensor(0.1972, dtype=torch.float64)
15 gae_duplicate tensor(-0.1741, dtype=torch.float64) tensor(-3.9364, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7481, dtype=torch.float64) delta_t tensor(0.1694, dtype=torch.float64)
14 gae_duplicate tensor(0.0113, dtype=torch.float64) tensor(-3.6997, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0844, dtype=torch.float64) delta_t tensor(-0.4558, dtype=torch.float64)
13 gae_duplicate tensor(-2.8514, dtype=torch.float64) tensor(10.2579, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3059, dtype=torch.float64) delta_t tensor(0.1664, dtype=torch.float64)
12 gae_duplicate tensor(-0.0234, dtype=torch.float64) tensor(-2.3500, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4899, dtype=torch.float64) delta_t tensor(0.0502, dtype=torch.float64)
11 gae_duplicate tensor(-0.0878, dtype=torch.float64) tensor(-1.2409, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0293, dtype=torch.float64) delta_t tensor(0.0611, dtype=torch.float64)
10 gae_duplicate tensor(-0.1106, dtype=torch.float64) tensor(-1.1359, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4137, dtype=torch.float64) delta_t tensor(0.1512, dtype=torch.float64)
9 gae_duplicate tensor(-0.2046, dtype=torch.float64) tensor(-2.8049, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6132, dtype=torch.float64) delta_t tensor(-0.0369, dtype=torch.float64)
8 gae_duplicate tensor(-0.2617, dtype=torch.float64) tensor(0.5898, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5597, dtype=torch.float64) delta_t tensor(-0.4104, dtype=torch.float64)
7 gae_duplicate tensor(-3.5158, dtype=torch.float64) tensor(10.2512, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8067, dtype=torch.float64) delta_t tensor(0.0182, dtype=torch.float64)
6 gae_duplicate tensor(-0.6926, dtype=torch.float64) tensor(1.0508, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5122, dtype=torch.float64) delta_t tensor(0.2153, dtype=torch.float64)
5 gae_duplicate tensor(-0.1010, dtype=torch.float64) tensor(-3.6001, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1143, dtype=torch.float64) delta_t tensor(0.1085, dtype=torch.float64)
4 gae_duplicate tensor(-0.0389, dtype=torch.float64) tensor(-2.1643, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2891, dtype=torch.float64) delta_t tensor(-0.1384, dtype=torch.float64)
3 gae_duplicate tensor(-0.3046, dtype=torch.float64) tensor(2.4267, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4524, dtype=torch.float64) delta_t tensor(0.0340, dtype=torch.float64)
2 gae_duplicate tensor(-0.4712, dtype=torch.float64) tensor(-0.3600, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:10.075507164001465
value loss:38.90576934814453
entropies:337.7854309082031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7327561378479 seconds
19 rew tensor(1.1264, dtype=torch.float64) delta_t tensor(0.0257, dtype=torch.float64)
19 gae_duplicate tensor(-0.0444, dtype=torch.float64) tensor(-0.4340, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0613, dtype=torch.float64) delta_t tensor(0.0868, dtype=torch.float64)
18 gae_duplicate tensor(-0.0218, dtype=torch.float64) tensor(-1.7016, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9577, dtype=torch.float64) delta_t tensor(-0.0221, dtype=torch.float64)
17 gae_duplicate tensor(-0.1254, dtype=torch.float64) tensor(0.1851, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0211, dtype=torch.float64) delta_t tensor(0.0669, dtype=torch.float64)
16 gae_duplicate tensor(-0.0151, dtype=torch.float64) tensor(-1.3173, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8407, dtype=torch.float64) delta_t tensor(-0.0377, dtype=torch.float64)
15 gae_duplicate tensor(-0.1855, dtype=torch.float64) tensor(0.7185, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7391, dtype=torch.float64) delta_t tensor(0.1777, dtype=torch.float64)
14 gae_duplicate tensor(-0.1146, dtype=torch.float64) tensor(-3.3017, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7111, dtype=torch.float64) delta_t tensor(0.1390, dtype=torch.float64)
13 gae_duplicate tensor(-0.0639, dtype=torch.float64) tensor(-3.2596, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4132, dtype=torch.float64) delta_t tensor(0.0243, dtype=torch.float64)
12 gae_duplicate tensor(-0.1080, dtype=torch.float64) tensor(-1.0473, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3199, dtype=torch.float64) delta_t tensor(-0.0162, dtype=torch.float64)
11 gae_duplicate tensor(-0.1571, dtype=torch.float64) tensor(-0.0410, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0421, dtype=torch.float64) delta_t tensor(-0.1552, dtype=torch.float64)
10 gae_duplicate tensor(-0.2725, dtype=torch.float64) tensor(2.8994, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1638, dtype=torch.float64) delta_t tensor(-0.0833, dtype=torch.float64)
9 gae_duplicate tensor(-0.3386, dtype=torch.float64) tensor(1.6726, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2288, dtype=torch.float64) delta_t tensor(0.0321, dtype=torch.float64)
8 gae_duplicate tensor(-0.1495, dtype=torch.float64) tensor(-0.2901, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6178, dtype=torch.float64) delta_t tensor(-0.0705, dtype=torch.float64)
7 gae_duplicate tensor(-0.2960, dtype=torch.float64) tensor(1.1047, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6340, dtype=torch.float64) delta_t tensor(0.1639, dtype=torch.float64)
6 gae_duplicate tensor(0.0508, dtype=torch.float64) tensor(-2.9362, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3636, dtype=torch.float64) delta_t tensor(-0.0756, dtype=torch.float64)
5 gae_duplicate tensor(-0.2744, dtype=torch.float64) tensor(1.0133, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2184, dtype=torch.float64) delta_t tensor(-0.0056, dtype=torch.float64)
4 gae_duplicate tensor(-0.1465, dtype=torch.float64) tensor(0.1905, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4986, dtype=torch.float64) delta_t tensor(0.0668, dtype=torch.float64)
3 gae_duplicate tensor(-0.3333, dtype=torch.float64) tensor(-1.1772, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0180, dtype=torch.float64) delta_t tensor(-0.2523, dtype=torch.float64)
2 gae_duplicate tensor(-0.4946, dtype=torch.float64) tensor(4.9675, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:57.501739501953125
value loss:4.76582145690918
entropies:337.8988952636719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3872.4702)
ToM Target loss= tensor(3731.3059)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.93011212348938 seconds
19 rew tensor(1.1926, dtype=torch.float64) delta_t tensor(0.0367, dtype=torch.float64)
19 gae_duplicate tensor(-0.0627, dtype=torch.float64) tensor(-0.7282, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1804, dtype=torch.float64) delta_t tensor(0.1757, dtype=torch.float64)
18 gae_duplicate tensor(-0.0111, dtype=torch.float64) tensor(-3.1987, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1157, dtype=torch.float64) delta_t tensor(0.1247, dtype=torch.float64)
17 gae_duplicate tensor(0.0087, dtype=torch.float64) tensor(-2.4170, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9292, dtype=torch.float64) delta_t tensor(0.0608, dtype=torch.float64)
16 gae_duplicate tensor(-0.0600, dtype=torch.float64) tensor(-1.4275, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8953, dtype=torch.float64) delta_t tensor(0.1196, dtype=torch.float64)
15 gae_duplicate tensor(-0.0969, dtype=torch.float64) tensor(-2.2999, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3124, dtype=torch.float64) delta_t tensor(-0.1679, dtype=torch.float64)
14 gae_duplicate tensor(-1.4010, dtype=torch.float64) tensor(2.6261, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7357, dtype=torch.float64) delta_t tensor(0.1861, dtype=torch.float64)
13 gae_duplicate tensor(0.0009, dtype=torch.float64) tensor(-3.0984, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2154, dtype=torch.float64) delta_t tensor(-0.0108, dtype=torch.float64)
12 gae_duplicate tensor(-0.1672, dtype=torch.float64) tensor(0.0031, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5271, dtype=torch.float64) delta_t tensor(0.0363, dtype=torch.float64)
11 gae_duplicate tensor(-0.1382, dtype=torch.float64) tensor(-0.5302, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2258, dtype=torch.float64) delta_t tensor(-0.1621, dtype=torch.float64)
10 gae_duplicate tensor(-0.2009, dtype=torch.float64) tensor(2.7750, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4366, dtype=torch.float64) delta_t tensor(0.1251, dtype=torch.float64)
9 gae_duplicate tensor(-0.1558, dtype=torch.float64) tensor(-1.7835, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6628, dtype=torch.float64) delta_t tensor(-0.0756, dtype=torch.float64)
8 gae_duplicate tensor(-0.2021, dtype=torch.float64) tensor(1.5879, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5307, dtype=torch.float64) delta_t tensor(0.2726, dtype=torch.float64)
7 gae_duplicate tensor(0.1176, dtype=torch.float64) tensor(-5.2669, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8644, dtype=torch.float64) delta_t tensor(0.0471, dtype=torch.float64)
6 gae_duplicate tensor(-0.0398, dtype=torch.float64) tensor(-1.3971, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2797, dtype=torch.float64) delta_t tensor(0.1379, dtype=torch.float64)
5 gae_duplicate tensor(-0.0428, dtype=torch.float64) tensor(-2.4529, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0923, dtype=torch.float64) delta_t tensor(0.0337, dtype=torch.float64)
4 gae_duplicate tensor(-0.1192, dtype=torch.float64) tensor(-0.4991, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8205, dtype=torch.float64) delta_t tensor(0.0298, dtype=torch.float64)
3 gae_duplicate tensor(-0.4374, dtype=torch.float64) tensor(-0.6787, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1846, dtype=torch.float64) delta_t tensor(-0.1470, dtype=torch.float64)
2 gae_duplicate tensor(-0.6572, dtype=torch.float64) tensor(1.9166, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:819.642822265625
value loss:10.082292556762695
entropies:338.199462890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7523353099823 seconds
19 rew tensor(1.2283, dtype=torch.float64) delta_t tensor(0.0123, dtype=torch.float64)
19 gae_duplicate tensor(-0.0901, dtype=torch.float64) tensor(-0.2102, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2294, dtype=torch.float64) delta_t tensor(0.2047, dtype=torch.float64)
18 gae_duplicate tensor(0.1340, dtype=torch.float64) tensor(-3.4787, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1508, dtype=torch.float64) delta_t tensor(0.1177, dtype=torch.float64)
17 gae_duplicate tensor(0.0669, dtype=torch.float64) tensor(-2.8392, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9802, dtype=torch.float64) delta_t tensor(0.1228, dtype=torch.float64)
16 gae_duplicate tensor(-0.0484, dtype=torch.float64) tensor(-2.2724, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9024, dtype=torch.float64) delta_t tensor(0.1454, dtype=torch.float64)
15 gae_duplicate tensor(0.0369, dtype=torch.float64) tensor(-2.9537, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3417, dtype=torch.float64) delta_t tensor(0.0196, dtype=torch.float64)
14 gae_duplicate tensor(-0.6349, dtype=torch.float64) tensor(-1.0665, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7795, dtype=torch.float64) delta_t tensor(0.1827, dtype=torch.float64)
13 gae_duplicate tensor(-0.0027, dtype=torch.float64) tensor(-3.1547, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1336, dtype=torch.float64) delta_t tensor(0.0740, dtype=torch.float64)
12 gae_duplicate tensor(-0.2049, dtype=torch.float64) tensor(-1.7320, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6961, dtype=torch.float64) delta_t tensor(0.1513, dtype=torch.float64)
11 gae_duplicate tensor(-0.1023, dtype=torch.float64) tensor(-3.0072, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3276, dtype=torch.float64) delta_t tensor(-0.0845, dtype=torch.float64)
10 gae_duplicate tensor(-0.1855, dtype=torch.float64) tensor(1.3524, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5397, dtype=torch.float64) delta_t tensor(0.2543, dtype=torch.float64)
9 gae_duplicate tensor(-0.1793, dtype=torch.float64) tensor(-5.0234, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7034, dtype=torch.float64) delta_t tensor(-0.0968, dtype=torch.float64)
8 gae_duplicate tensor(-0.2344, dtype=torch.float64) tensor(1.1608, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3962, dtype=torch.float64) delta_t tensor(-0.1499, dtype=torch.float64)
7 gae_duplicate tensor(-2.4457, dtype=torch.float64) tensor(4.8554, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9783, dtype=torch.float64) delta_t tensor(-0.0424, dtype=torch.float64)
6 gae_duplicate tensor(-0.3865, dtype=torch.float64) tensor(0.9882, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4004, dtype=torch.float64) delta_t tensor(0.1619, dtype=torch.float64)
5 gae_duplicate tensor(-0.2545, dtype=torch.float64) tensor(-2.3007, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0629, dtype=torch.float64) delta_t tensor(0.0129, dtype=torch.float64)
4 gae_duplicate tensor(-0.3040, dtype=torch.float64) tensor(-0.7924, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2597, dtype=torch.float64) delta_t tensor(-0.0122, dtype=torch.float64)
3 gae_duplicate tensor(-0.4118, dtype=torch.float64) tensor(0.3631, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4018, dtype=torch.float64) delta_t tensor(0.0713, dtype=torch.float64)
2 gae_duplicate tensor(-0.3307, dtype=torch.float64) tensor(-1.0255, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1050.00634765625
value loss:19.77838897705078
entropies:338.42779541015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8710010051727295 seconds
19 rew tensor(1.2270, dtype=torch.float64) delta_t tensor(0.0231, dtype=torch.float64)
19 gae_duplicate tensor(-0.0995, dtype=torch.float64) tensor(-0.4424, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1766, dtype=torch.float64) delta_t tensor(0.0954, dtype=torch.float64)
18 gae_duplicate tensor(-0.0050, dtype=torch.float64) tensor(-2.0511, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0204, dtype=torch.float64) delta_t tensor(-0.0438, dtype=torch.float64)
17 gae_duplicate tensor(-0.2464, dtype=torch.float64) tensor(0.7901, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9580, dtype=torch.float64) delta_t tensor(-0.0133, dtype=torch.float64)
16 gae_duplicate tensor(-0.2304, dtype=torch.float64) tensor(0.6604, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8012, dtype=torch.float64) delta_t tensor(0.0188, dtype=torch.float64)
15 gae_duplicate tensor(-0.1044, dtype=torch.float64) tensor(-0.4155, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7062, dtype=torch.float64) delta_t tensor(0.2318, dtype=torch.float64)
14 gae_duplicate tensor(-0.0981, dtype=torch.float64) tensor(-4.3438, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6116, dtype=torch.float64) delta_t tensor(0.1130, dtype=torch.float64)
13 gae_duplicate tensor(-0.1001, dtype=torch.float64) tensor(-2.1804, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3948, dtype=torch.float64) delta_t tensor(0.0627, dtype=torch.float64)
12 gae_duplicate tensor(-0.1596, dtype=torch.float64) tensor(-1.1519, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3240, dtype=torch.float64) delta_t tensor(-0.0154, dtype=torch.float64)
11 gae_duplicate tensor(-0.1473, dtype=torch.float64) tensor(0.1854, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0168, dtype=torch.float64) delta_t tensor(0.1047, dtype=torch.float64)
10 gae_duplicate tensor(-0.1766, dtype=torch.float64) tensor(-2.2312, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3048, dtype=torch.float64) delta_t tensor(0.0620, dtype=torch.float64)
9 gae_duplicate tensor(-0.2920, dtype=torch.float64) tensor(-2.0726, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6014, dtype=torch.float64) delta_t tensor(-0.0872, dtype=torch.float64)
8 gae_duplicate tensor(-0.2008, dtype=torch.float64) tensor(1.3931, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8663, dtype=torch.float64) delta_t tensor(0.2936, dtype=torch.float64)
7 gae_duplicate tensor(-0.0251, dtype=torch.float64) tensor(-5.6093, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7057, dtype=torch.float64) delta_t tensor(0.2025, dtype=torch.float64)
6 gae_duplicate tensor(-0.0023, dtype=torch.float64) tensor(-4.4187, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6045, dtype=torch.float64) delta_t tensor(0.2190, dtype=torch.float64)
5 gae_duplicate tensor(-0.0571, dtype=torch.float64) tensor(-4.6041, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1031, dtype=torch.float64) delta_t tensor(0.0811, dtype=torch.float64)
4 gae_duplicate tensor(-0.0426, dtype=torch.float64) tensor(-2.0071, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2843, dtype=torch.float64) delta_t tensor(0.0405, dtype=torch.float64)
3 gae_duplicate tensor(-0.2083, dtype=torch.float64) tensor(-0.9462, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4548, dtype=torch.float64) delta_t tensor(0.0458, dtype=torch.float64)
2 gae_duplicate tensor(-0.4050, dtype=torch.float64) tensor(-1.3578, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1572.0379638671875
value loss:9.319470405578613
entropies:338.27374267578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.881261825561523 seconds
19 rew tensor(1.2545, dtype=torch.float64) delta_t tensor(-0.0550, dtype=torch.float64)
19 gae_duplicate tensor(-0.1862, dtype=torch.float64) tensor(0.9740, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1922, dtype=torch.float64) delta_t tensor(0.0179, dtype=torch.float64)
18 gae_duplicate tensor(-0.1042, dtype=torch.float64) tensor(-0.3377, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1553, dtype=torch.float64) delta_t tensor(-0.0049, dtype=torch.float64)
17 gae_duplicate tensor(-0.1957, dtype=torch.float64) tensor(0.1007, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1292, dtype=torch.float64) delta_t tensor(-0.0052, dtype=torch.float64)
16 gae_duplicate tensor(-0.1516, dtype=torch.float64) tensor(0.1709, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0528, dtype=torch.float64) delta_t tensor(0.0383, dtype=torch.float64)
15 gae_duplicate tensor(-0.2616, dtype=torch.float64) tensor(-0.7017, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3720, dtype=torch.float64) delta_t tensor(-0.3863, dtype=torch.float64)
14 gae_duplicate tensor(-1.6803, dtype=torch.float64) tensor(7.8520, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.4164, dtype=torch.float64) delta_t tensor(-0.8419, dtype=torch.float64)
13 gae_duplicate tensor(-2.9698, dtype=torch.float64) tensor(17.7360, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2913, dtype=torch.float64) delta_t tensor(-0.4405, dtype=torch.float64)
12 gae_duplicate tensor(-2.1745, dtype=torch.float64) tensor(8.6554, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1135, dtype=torch.float64) delta_t tensor(-0.3163, dtype=torch.float64)
11 gae_duplicate tensor(-1.2927, dtype=torch.float64) tensor(6.1392, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0512, dtype=torch.float64) delta_t tensor(0.1685, dtype=torch.float64)
10 gae_duplicate tensor(-0.1763, dtype=torch.float64) tensor(-2.5987, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5274, dtype=torch.float64) delta_t tensor(0.1249, dtype=torch.float64)
9 gae_duplicate tensor(-0.2450, dtype=torch.float64) tensor(-2.9467, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7082, dtype=torch.float64) delta_t tensor(-0.0821, dtype=torch.float64)
8 gae_duplicate tensor(-0.1607, dtype=torch.float64) tensor(1.5711, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8144, dtype=torch.float64) delta_t tensor(0.3673, dtype=torch.float64)
7 gae_duplicate tensor(0.0164, dtype=torch.float64) tensor(-7.7989, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8505, dtype=torch.float64) delta_t tensor(0.1292, dtype=torch.float64)
6 gae_duplicate tensor(-0.2223, dtype=torch.float64) tensor(-3.1842, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5285, dtype=torch.float64) delta_t tensor(0.3839, dtype=torch.float64)
5 gae_duplicate tensor(0.1248, dtype=torch.float64) tensor(-7.9028, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1274, dtype=torch.float64) delta_t tensor(0.0847, dtype=torch.float64)
4 gae_duplicate tensor(-0.1093, dtype=torch.float64) tensor(-2.4291, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3769, dtype=torch.float64) delta_t tensor(0.0316, dtype=torch.float64)
3 gae_duplicate tensor(-0.0363, dtype=torch.float64) tensor(-0.8036, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4525, dtype=torch.float64) delta_t tensor(-0.0151, dtype=torch.float64)
2 gae_duplicate tensor(-0.3950, dtype=torch.float64) tensor(-0.3803, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-853.5909423828125
value loss:55.65890884399414
entropies:338.34521484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.188218116760254 seconds
19 rew tensor(1.1781, dtype=torch.float64) delta_t tensor(-0.0374, dtype=torch.float64)
19 gae_duplicate tensor(-0.1877, dtype=torch.float64) tensor(0.6342, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1399, dtype=torch.float64) delta_t tensor(0.0513, dtype=torch.float64)
18 gae_duplicate tensor(-0.0559, dtype=torch.float64) tensor(-1.0246, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0097, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
17 gae_duplicate tensor(-0.1491, dtype=torch.float64) tensor(0.5799, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0092, dtype=torch.float64) delta_t tensor(-0.0551, dtype=torch.float64)
16 gae_duplicate tensor(-0.1956, dtype=torch.float64) tensor(1.0708, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8540, dtype=torch.float64) delta_t tensor(-0.0449, dtype=torch.float64)
15 gae_duplicate tensor(-0.1581, dtype=torch.float64) tensor(1.1409, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6128, dtype=torch.float64) delta_t tensor(-0.1652, dtype=torch.float64)
14 gae_duplicate tensor(-1.2938, dtype=torch.float64) tensor(2.8809, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4502, dtype=torch.float64) delta_t tensor(-0.0066, dtype=torch.float64)
13 gae_duplicate tensor(-0.1367, dtype=torch.float64) tensor(0.3629, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3713, dtype=torch.float64) delta_t tensor(0.0449, dtype=torch.float64)
12 gae_duplicate tensor(-0.0962, dtype=torch.float64) tensor(-0.6905, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2180, dtype=torch.float64) delta_t tensor(-0.0702, dtype=torch.float64)
11 gae_duplicate tensor(-0.1902, dtype=torch.float64) tensor(1.1212, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1379, dtype=torch.float64) delta_t tensor(-0.0049, dtype=torch.float64)
10 gae_duplicate tensor(-0.1581, dtype=torch.float64) tensor(0.2988, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0628, dtype=torch.float64) delta_t tensor(0.1439, dtype=torch.float64)
9 gae_duplicate tensor(-0.2070, dtype=torch.float64) tensor(-2.7138, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2777, dtype=torch.float64) delta_t tensor(-0.0812, dtype=torch.float64)
8 gae_duplicate tensor(-0.2647, dtype=torch.float64) tensor(1.2979, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4476, dtype=torch.float64) delta_t tensor(0.1075, dtype=torch.float64)
7 gae_duplicate tensor(-0.1316, dtype=torch.float64) tensor(-2.0183, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4349, dtype=torch.float64) delta_t tensor(0.1223, dtype=torch.float64)
6 gae_duplicate tensor(-0.1168, dtype=torch.float64) tensor(-2.0884, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9683, dtype=torch.float64) delta_t tensor(0.0429, dtype=torch.float64)
5 gae_duplicate tensor(-0.2353, dtype=torch.float64) tensor(-1.1509, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2938, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
4 gae_duplicate tensor(-0.1408, dtype=torch.float64) tensor(-0.3586, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5179, dtype=torch.float64) delta_t tensor(0.0621, dtype=torch.float64)
3 gae_duplicate tensor(-0.1315, dtype=torch.float64) tensor(-1.0856, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6303, dtype=torch.float64) delta_t tensor(0.0476, dtype=torch.float64)
2 gae_duplicate tensor(-0.0773, dtype=torch.float64) tensor(-0.9073, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:51.66639709472656
value loss:6.005523204803467
entropies:338.7852783203125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3882.0093)
ToM Target loss= tensor(3733.9487)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.114138841629028 seconds
19 rew tensor(1.2304, dtype=torch.float64) delta_t tensor(0.0151, dtype=torch.float64)
19 gae_duplicate tensor(-0.0781, dtype=torch.float64) tensor(-0.2934, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1780, dtype=torch.float64) delta_t tensor(0.1280, dtype=torch.float64)
18 gae_duplicate tensor(0.0255, dtype=torch.float64) tensor(-2.2180, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9838, dtype=torch.float64) delta_t tensor(-0.0226, dtype=torch.float64)
17 gae_duplicate tensor(-0.1517, dtype=torch.float64) tensor(0.1103, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9733, dtype=torch.float64) delta_t tensor(-0.0671, dtype=torch.float64)
16 gae_duplicate tensor(-0.1821, dtype=torch.float64) tensor(1.3238, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8679, dtype=torch.float64) delta_t tensor(-0.0030, dtype=torch.float64)
15 gae_duplicate tensor(-0.1208, dtype=torch.float64) tensor(0.1383, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5267, dtype=torch.float64) delta_t tensor(0.0034, dtype=torch.float64)
14 gae_duplicate tensor(-1.1808, dtype=torch.float64) tensor(-0.6325, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6030, dtype=torch.float64) delta_t tensor(0.0509, dtype=torch.float64)
13 gae_duplicate tensor(-0.0401, dtype=torch.float64) tensor(-0.8900, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3139, dtype=torch.float64) delta_t tensor(0.1417, dtype=torch.float64)
12 gae_duplicate tensor(-0.2220, dtype=torch.float64) tensor(-2.6806, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4722, dtype=torch.float64) delta_t tensor(-0.0223, dtype=torch.float64)
11 gae_duplicate tensor(-0.1412, dtype=torch.float64) tensor(0.1430, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1056, dtype=torch.float64) delta_t tensor(-0.0072, dtype=torch.float64)
10 gae_duplicate tensor(-0.3051, dtype=torch.float64) tensor(0.1539, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4394, dtype=torch.float64) delta_t tensor(0.1028, dtype=torch.float64)
9 gae_duplicate tensor(-0.1114, dtype=torch.float64) tensor(-1.7742, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6165, dtype=torch.float64) delta_t tensor(-0.0468, dtype=torch.float64)
8 gae_duplicate tensor(-0.3289, dtype=torch.float64) tensor(0.6794, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6918, dtype=torch.float64) delta_t tensor(0.1946, dtype=torch.float64)
7 gae_duplicate tensor(-0.1252, dtype=torch.float64) tensor(-3.2281, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8490, dtype=torch.float64) delta_t tensor(0.0019, dtype=torch.float64)
6 gae_duplicate tensor(-0.1955, dtype=torch.float64) tensor(-0.4298, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4309, dtype=torch.float64) delta_t tensor(0.1283, dtype=torch.float64)
5 gae_duplicate tensor(-0.0458, dtype=torch.float64) tensor(-2.3255, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0380, dtype=torch.float64) delta_t tensor(0.0180, dtype=torch.float64)
4 gae_duplicate tensor(-0.1707, dtype=torch.float64) tensor(-0.5240, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0621, dtype=torch.float64) delta_t tensor(-0.0266, dtype=torch.float64)
3 gae_duplicate tensor(-0.2551, dtype=torch.float64) tensor(0.4033, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3117, dtype=torch.float64) delta_t tensor(-0.0787, dtype=torch.float64)
2 gae_duplicate tensor(-0.4579, dtype=torch.float64) tensor(1.2121, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:493.36279296875
value loss:8.200888633728027
entropies:339.1430969238281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1306471824646 seconds
19 rew tensor(0.9713, dtype=torch.float64) delta_t tensor(-0.1900, dtype=torch.float64)
19 gae_duplicate tensor(-1.3940, dtype=torch.float64) tensor(3.2734, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2004, dtype=torch.float64) delta_t tensor(0.1582, dtype=torch.float64)
18 gae_duplicate tensor(0.0069, dtype=torch.float64) tensor(-2.4058, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1498, dtype=torch.float64) delta_t tensor(0.1766, dtype=torch.float64)
17 gae_duplicate tensor(0.0664, dtype=torch.float64) tensor(-3.2690, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0726, dtype=torch.float64) delta_t tensor(0.0816, dtype=torch.float64)
16 gae_duplicate tensor(-0.0384, dtype=torch.float64) tensor(-1.7932, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9185, dtype=torch.float64) delta_t tensor(0.1857, dtype=torch.float64)
15 gae_duplicate tensor(-0.1468, dtype=torch.float64) tensor(-3.3351, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6387, dtype=torch.float64) delta_t tensor(-0.0348, dtype=torch.float64)
14 gae_duplicate tensor(-0.7856, dtype=torch.float64) tensor(0.8506, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0718, dtype=torch.float64) delta_t tensor(-0.3138, dtype=torch.float64)
13 gae_duplicate tensor(-2.5200, dtype=torch.float64) tensor(4.9083, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6847, dtype=torch.float64) delta_t tensor(0.3037, dtype=torch.float64)
12 gae_duplicate tensor(-0.0337, dtype=torch.float64) tensor(-4.8080, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8150, dtype=torch.float64) delta_t tensor(-1.1086, dtype=torch.float64)
11 gae_duplicate tensor(-6.0970, dtype=torch.float64) tensor(24.2752, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2010, dtype=torch.float64) delta_t tensor(0.2533, dtype=torch.float64)
10 gae_duplicate tensor(-0.1848, dtype=torch.float64) tensor(-2.9457, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2355, dtype=torch.float64) delta_t tensor(-0.0284, dtype=torch.float64)
9 gae_duplicate tensor(-0.2126, dtype=torch.float64) tensor(0.2166, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5513, dtype=torch.float64) delta_t tensor(0.0296, dtype=torch.float64)
8 gae_duplicate tensor(-0.6467, dtype=torch.float64) tensor(-0.5619, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5411, dtype=torch.float64) delta_t tensor(-0.6164, dtype=torch.float64)
7 gae_duplicate tensor(-3.9268, dtype=torch.float64) tensor(14.4111, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8270, dtype=torch.float64) delta_t tensor(0.0238, dtype=torch.float64)
6 gae_duplicate tensor(-0.9694, dtype=torch.float64) tensor(0.2035, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6079, dtype=torch.float64) delta_t tensor(-0.0847, dtype=torch.float64)
5 gae_duplicate tensor(-0.3491, dtype=torch.float64) tensor(1.7530, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0926, dtype=torch.float64) delta_t tensor(0.0968, dtype=torch.float64)
4 gae_duplicate tensor(-0.2000, dtype=torch.float64) tensor(-1.4784, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2131, dtype=torch.float64) delta_t tensor(-0.1083, dtype=torch.float64)
3 gae_duplicate tensor(-0.4474, dtype=torch.float64) tensor(1.6643, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2455, dtype=torch.float64) delta_t tensor(-0.0250, dtype=torch.float64)
2 gae_duplicate tensor(-0.4771, dtype=torch.float64) tensor(0.5808, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1794.820068359375
value loss:103.92761993408203
entropies:339.5496520996094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.96874213218689 seconds
19 rew tensor(1.1451, dtype=torch.float64) delta_t tensor(-0.0083, dtype=torch.float64)
19 gae_duplicate tensor(-0.0939, dtype=torch.float64) tensor(0.1449, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1454, dtype=torch.float64) delta_t tensor(0.1215, dtype=torch.float64)
18 gae_duplicate tensor(0.0595, dtype=torch.float64) tensor(-2.3254, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0549, dtype=torch.float64) delta_t tensor(0.0571, dtype=torch.float64)
17 gae_duplicate tensor(-0.0107, dtype=torch.float64) tensor(-1.1797, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0811, dtype=torch.float64) delta_t tensor(0.0985, dtype=torch.float64)
16 gae_duplicate tensor(-0.0128, dtype=torch.float64) tensor(-1.9875, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9389, dtype=torch.float64) delta_t tensor(0.0124, dtype=torch.float64)
15 gae_duplicate tensor(-0.0831, dtype=torch.float64) tensor(-0.2745, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9507, dtype=torch.float64) delta_t tensor(0.2055, dtype=torch.float64)
14 gae_duplicate tensor(-0.0884, dtype=torch.float64) tensor(-3.5544, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2147, dtype=torch.float64) delta_t tensor(-0.3578, dtype=torch.float64)
13 gae_duplicate tensor(-2.2315, dtype=torch.float64) tensor(5.5147, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0059, dtype=torch.float64) delta_t tensor(-0.2452, dtype=torch.float64)
12 gae_duplicate tensor(-2.3097, dtype=torch.float64) tensor(6.5813, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1175, dtype=torch.float64) delta_t tensor(-0.2274, dtype=torch.float64)
11 gae_duplicate tensor(-1.9953, dtype=torch.float64) tensor(6.1493, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.0035, dtype=torch.float64) delta_t tensor(-0.9430, dtype=torch.float64)
10 gae_duplicate tensor(-5.4867, dtype=torch.float64) tensor(16.3779, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0107, dtype=torch.float64) delta_t tensor(-0.1639, dtype=torch.float64)
9 gae_duplicate tensor(-2.4209, dtype=torch.float64) tensor(6.7135, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4901, dtype=torch.float64) delta_t tensor(-0.1003, dtype=torch.float64)
8 gae_duplicate tensor(-0.3584, dtype=torch.float64) tensor(2.7283, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2964, dtype=torch.float64) delta_t tensor(-0.0438, dtype=torch.float64)
7 gae_duplicate tensor(-0.6570, dtype=torch.float64) tensor(0.8118, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7381, dtype=torch.float64) delta_t tensor(-0.0678, dtype=torch.float64)
6 gae_duplicate tensor(-0.3470, dtype=torch.float64) tensor(1.0259, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7285, dtype=torch.float64) delta_t tensor(0.0194, dtype=torch.float64)
5 gae_duplicate tensor(-0.2264, dtype=torch.float64) tensor(-0.7260, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1348, dtype=torch.float64) delta_t tensor(-0.0550, dtype=torch.float64)
4 gae_duplicate tensor(-0.2213, dtype=torch.float64) tensor(1.3247, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4377, dtype=torch.float64) delta_t tensor(0.0332, dtype=torch.float64)
3 gae_duplicate tensor(-0.2245, dtype=torch.float64) tensor(-0.2727, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4974, dtype=torch.float64) delta_t tensor(0.1363, dtype=torch.float64)
2 gae_duplicate tensor(-0.0578, dtype=torch.float64) tensor(-2.3100, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1967.7567138671875
value loss:80.9895248413086
entropies:339.60968017578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.073709726333618 seconds
19 rew tensor(1.2243, dtype=torch.float64) delta_t tensor(0.0202, dtype=torch.float64)
19 gae_duplicate tensor(-0.0807, dtype=torch.float64) tensor(-0.4011, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1864, dtype=torch.float64) delta_t tensor(0.1167, dtype=torch.float64)
18 gae_duplicate tensor(0.0547, dtype=torch.float64) tensor(-2.0367, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1245, dtype=torch.float64) delta_t tensor(0.0516, dtype=torch.float64)
17 gae_duplicate tensor(-0.0662, dtype=torch.float64) tensor(-1.2056, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0352, dtype=torch.float64) delta_t tensor(0.0912, dtype=torch.float64)
16 gae_duplicate tensor(-0.0796, dtype=torch.float64) tensor(-1.6627, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9697, dtype=torch.float64) delta_t tensor(0.0572, dtype=torch.float64)
15 gae_duplicate tensor(-0.0926, dtype=torch.float64) tensor(-1.5185, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1184, dtype=torch.float64) delta_t tensor(-0.3839, dtype=torch.float64)
14 gae_duplicate tensor(-1.6019, dtype=torch.float64) tensor(6.5340, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1733, dtype=torch.float64) delta_t tensor(-0.3652, dtype=torch.float64)
13 gae_duplicate tensor(-2.7751, dtype=torch.float64) tensor(9.5769, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0224, dtype=torch.float64) delta_t tensor(-0.1320, dtype=torch.float64)
12 gae_duplicate tensor(-1.2896, dtype=torch.float64) tensor(3.0358, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3064, dtype=torch.float64) delta_t tensor(-0.1916, dtype=torch.float64)
11 gae_duplicate tensor(-1.3613, dtype=torch.float64) tensor(3.6354, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1955, dtype=torch.float64) delta_t tensor(-0.0698, dtype=torch.float64)
10 gae_duplicate tensor(-0.3610, dtype=torch.float64) tensor(1.9047, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6062, dtype=torch.float64) delta_t tensor(0.1194, dtype=torch.float64)
9 gae_duplicate tensor(-0.0897, dtype=torch.float64) tensor(-1.8572, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7112, dtype=torch.float64) delta_t tensor(-0.1748, dtype=torch.float64)
8 gae_duplicate tensor(-0.2988, dtype=torch.float64) tensor(2.7498, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6901, dtype=torch.float64) delta_t tensor(0.0287, dtype=torch.float64)
7 gae_duplicate tensor(-1.0993, dtype=torch.float64) tensor(-0.9497, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8430, dtype=torch.float64) delta_t tensor(-0.0600, dtype=torch.float64)
6 gae_duplicate tensor(-0.3464, dtype=torch.float64) tensor(1.2513, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3123, dtype=torch.float64) delta_t tensor(0.1181, dtype=torch.float64)
5 gae_duplicate tensor(-0.2013, dtype=torch.float64) tensor(-1.9256, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1657, dtype=torch.float64) delta_t tensor(-0.0743, dtype=torch.float64)
4 gae_duplicate tensor(-0.2840, dtype=torch.float64) tensor(1.0983, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8677, dtype=torch.float64) delta_t tensor(-0.0768, dtype=torch.float64)
3 gae_duplicate tensor(-0.3429, dtype=torch.float64) tensor(1.4391, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1823, dtype=torch.float64) delta_t tensor(-0.1689, dtype=torch.float64)
2 gae_duplicate tensor(-0.4299, dtype=torch.float64) tensor(3.7287, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1355.0426025390625
value loss:28.97209358215332
entropies:339.3185729980469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.000895023345947 seconds
19 rew tensor(1.1365, dtype=torch.float64) delta_t tensor(-0.0940, dtype=torch.float64)
19 gae_duplicate tensor(-0.1573, dtype=torch.float64) tensor(1.5909, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1382, dtype=torch.float64) delta_t tensor(0.0314, dtype=torch.float64)
18 gae_duplicate tensor(-0.1613, dtype=torch.float64) tensor(-0.5684, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0863, dtype=torch.float64) delta_t tensor(0.0088, dtype=torch.float64)
17 gae_duplicate tensor(-0.1177, dtype=torch.float64) tensor(-0.1402, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0757, dtype=torch.float64) delta_t tensor(0.0240, dtype=torch.float64)
16 gae_duplicate tensor(-0.1788, dtype=torch.float64) tensor(-0.1322, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9838, dtype=torch.float64) delta_t tensor(0.1838, dtype=torch.float64)
15 gae_duplicate tensor(-0.0121, dtype=torch.float64) tensor(-4.1803, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2766, dtype=torch.float64) delta_t tensor(-0.2787, dtype=torch.float64)
14 gae_duplicate tensor(-1.2739, dtype=torch.float64) tensor(4.2109, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0198, dtype=torch.float64) delta_t tensor(-0.4227, dtype=torch.float64)
13 gae_duplicate tensor(-2.6396, dtype=torch.float64) tensor(7.5087, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1483, dtype=torch.float64) delta_t tensor(-0.0314, dtype=torch.float64)
12 gae_duplicate tensor(-1.1456, dtype=torch.float64) tensor(1.5818, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4897, dtype=torch.float64) delta_t tensor(0.0464, dtype=torch.float64)
11 gae_duplicate tensor(-0.3502, dtype=torch.float64) tensor(-0.6637, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1309, dtype=torch.float64) delta_t tensor(0.0010, dtype=torch.float64)
10 gae_duplicate tensor(-0.1350, dtype=torch.float64) tensor(-0.5888, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4849, dtype=torch.float64) delta_t tensor(0.1842, dtype=torch.float64)
9 gae_duplicate tensor(-0.1983, dtype=torch.float64) tensor(-3.2124, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6482, dtype=torch.float64) delta_t tensor(-0.1606, dtype=torch.float64)
8 gae_duplicate tensor(-0.2315, dtype=torch.float64) tensor(2.8004, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7742, dtype=torch.float64) delta_t tensor(0.1606, dtype=torch.float64)
7 gae_duplicate tensor(0.0458, dtype=torch.float64) tensor(-3.0416, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7533, dtype=torch.float64) delta_t tensor(0.0029, dtype=torch.float64)
6 gae_duplicate tensor(-0.1781, dtype=torch.float64) tensor(-0.2694, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5697, dtype=torch.float64) delta_t tensor(0.1073, dtype=torch.float64)
5 gae_duplicate tensor(-0.0885, dtype=torch.float64) tensor(-2.1225, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0418, dtype=torch.float64) delta_t tensor(-0.0498, dtype=torch.float64)
4 gae_duplicate tensor(-0.2013, dtype=torch.float64) tensor(0.7016, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2293, dtype=torch.float64) delta_t tensor(-0.0119, dtype=torch.float64)
3 gae_duplicate tensor(-0.1165, dtype=torch.float64) tensor(0.2613, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3644, dtype=torch.float64) delta_t tensor(-0.1949, dtype=torch.float64)
2 gae_duplicate tensor(-0.5784, dtype=torch.float64) tensor(3.5935, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-487.33953857421875
value loss:22.34874153137207
entropies:339.082763671875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3864.9180)
ToM Target loss= tensor(3737.4741)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.832005739212036 seconds
19 rew tensor(1.1869, dtype=torch.float64) delta_t tensor(-0.0049, dtype=torch.float64)
19 gae_duplicate tensor(-0.1339, dtype=torch.float64) tensor(0.0695, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1886, dtype=torch.float64) delta_t tensor(0.1604, dtype=torch.float64)
18 gae_duplicate tensor(-0.0341, dtype=torch.float64) tensor(-2.9294, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7602, dtype=torch.float64) delta_t tensor(-0.2128, dtype=torch.float64)
17 gae_duplicate tensor(-1.2234, dtype=torch.float64) tensor(3.4397, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0191, dtype=torch.float64) delta_t tensor(0.0513, dtype=torch.float64)
16 gae_duplicate tensor(-0.1128, dtype=torch.float64) tensor(-0.6331, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9157, dtype=torch.float64) delta_t tensor(0.0638, dtype=torch.float64)
15 gae_duplicate tensor(-0.1104, dtype=torch.float64) tensor(-1.1056, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5073, dtype=torch.float64) delta_t tensor(0.0736, dtype=torch.float64)
14 gae_duplicate tensor(-1.1620, dtype=torch.float64) tensor(-1.3665, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6075, dtype=torch.float64) delta_t tensor(0.0752, dtype=torch.float64)
13 gae_duplicate tensor(-0.0111, dtype=torch.float64) tensor(-1.5446, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1767, dtype=torch.float64) delta_t tensor(0.1084, dtype=torch.float64)
12 gae_duplicate tensor(-0.1039, dtype=torch.float64) tensor(-1.9260, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4798, dtype=torch.float64) delta_t tensor(0.0163, dtype=torch.float64)
11 gae_duplicate tensor(-0.0745, dtype=torch.float64) tensor(-0.4994, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1449, dtype=torch.float64) delta_t tensor(0.0309, dtype=torch.float64)
10 gae_duplicate tensor(-0.2986, dtype=torch.float64) tensor(-0.5605, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5535, dtype=torch.float64) delta_t tensor(0.2257, dtype=torch.float64)
9 gae_duplicate tensor(-0.0697, dtype=torch.float64) tensor(-4.2018, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7367, dtype=torch.float64) delta_t tensor(-0.1509, dtype=torch.float64)
8 gae_duplicate tensor(-0.2969, dtype=torch.float64) tensor(2.3731, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9465, dtype=torch.float64) delta_t tensor(-0.0245, dtype=torch.float64)
7 gae_duplicate tensor(-0.9097, dtype=torch.float64) tensor(1.4665, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9994, dtype=torch.float64) delta_t tensor(-0.2008, dtype=torch.float64)
6 gae_duplicate tensor(-0.9757, dtype=torch.float64) tensor(3.5545, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3000, dtype=torch.float64) delta_t tensor(0.2093, dtype=torch.float64)
5 gae_duplicate tensor(-0.0645, dtype=torch.float64) tensor(-3.0266, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0296, dtype=torch.float64) delta_t tensor(-0.0220, dtype=torch.float64)
4 gae_duplicate tensor(-0.2363, dtype=torch.float64) tensor(-0.2420, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1676, dtype=torch.float64) delta_t tensor(-0.1306, dtype=torch.float64)
3 gae_duplicate tensor(-0.5969, dtype=torch.float64) tensor(2.8052, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3916, dtype=torch.float64) delta_t tensor(0.1008, dtype=torch.float64)
2 gae_duplicate tensor(-0.5305, dtype=torch.float64) tensor(-3.6533, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:339.3522033691406
value loss:15.836080551147461
entropies:339.1974182128906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.831871032714844 seconds
19 rew tensor(1.1684, dtype=torch.float64) delta_t tensor(-0.0641, dtype=torch.float64)
19 gae_duplicate tensor(-0.1120, dtype=torch.float64) tensor(1.2978, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2080, dtype=torch.float64) delta_t tensor(0.1174, dtype=torch.float64)
18 gae_duplicate tensor(0.0099, dtype=torch.float64) tensor(-2.1074, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1584, dtype=torch.float64) delta_t tensor(0.0972, dtype=torch.float64)
17 gae_duplicate tensor(-0.0713, dtype=torch.float64) tensor(-2.1985, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0676, dtype=torch.float64) delta_t tensor(0.0542, dtype=torch.float64)
16 gae_duplicate tensor(-0.0368, dtype=torch.float64) tensor(-1.2373, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9760, dtype=torch.float64) delta_t tensor(0.1334, dtype=torch.float64)
15 gae_duplicate tensor(-0.0191, dtype=torch.float64) tensor(-2.6248, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4510, dtype=torch.float64) delta_t tensor(-0.1308, dtype=torch.float64)
14 gae_duplicate tensor(-1.3041, dtype=torch.float64) tensor(2.1667, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7016, dtype=torch.float64) delta_t tensor(0.0811, dtype=torch.float64)
13 gae_duplicate tensor(-0.3345, dtype=torch.float64) tensor(-1.6475, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4321, dtype=torch.float64) delta_t tensor(0.1933, dtype=torch.float64)
12 gae_duplicate tensor(0.0128, dtype=torch.float64) tensor(-3.9880, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0905, dtype=torch.float64) delta_t tensor(-0.3304, dtype=torch.float64)
11 gae_duplicate tensor(-2.1896, dtype=torch.float64) tensor(4.6693, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.0072, dtype=torch.float64) delta_t tensor(-0.8271, dtype=torch.float64)
10 gae_duplicate tensor(-5.3157, dtype=torch.float64) tensor(14.5679, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1167, dtype=torch.float64) delta_t tensor(-0.3478, dtype=torch.float64)
9 gae_duplicate tensor(-3.7370, dtype=torch.float64) tensor(10.0199, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6969, dtype=torch.float64) delta_t tensor(-0.0898, dtype=torch.float64)
8 gae_duplicate tensor(-0.3793, dtype=torch.float64) tensor(2.1244, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1099, dtype=torch.float64) delta_t tensor(-0.2897, dtype=torch.float64)
7 gae_duplicate tensor(-2.8995, dtype=torch.float64) tensor(4.3598, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9011, dtype=torch.float64) delta_t tensor(-0.0379, dtype=torch.float64)
6 gae_duplicate tensor(-0.4439, dtype=torch.float64) tensor(1.1917, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3909, dtype=torch.float64) delta_t tensor(0.0682, dtype=torch.float64)
5 gae_duplicate tensor(-0.1317, dtype=torch.float64) tensor(-1.4074, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0282, dtype=torch.float64) delta_t tensor(0.0266, dtype=torch.float64)
4 gae_duplicate tensor(-0.1271, dtype=torch.float64) tensor(-0.4883, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1028, dtype=torch.float64) delta_t tensor(-0.1646, dtype=torch.float64)
3 gae_duplicate tensor(-0.5609, dtype=torch.float64) tensor(2.8253, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3205, dtype=torch.float64) delta_t tensor(0.0206, dtype=torch.float64)
2 gae_duplicate tensor(-0.4844, dtype=torch.float64) tensor(-0.0055, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1577.64208984375
value loss:93.34791564941406
entropies:339.5140075683594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.627324819564819 seconds
19 rew tensor(1.2139, dtype=torch.float64) delta_t tensor(-0.0544, dtype=torch.float64)
19 gae_duplicate tensor(-0.1600, dtype=torch.float64) tensor(1.1338, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1755, dtype=torch.float64) delta_t tensor(0.0302, dtype=torch.float64)
18 gae_duplicate tensor(-0.0447, dtype=torch.float64) tensor(-0.5167, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1634, dtype=torch.float64) delta_t tensor(0.0834, dtype=torch.float64)
17 gae_duplicate tensor(-0.1312, dtype=torch.float64) tensor(-1.5663, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1379, dtype=torch.float64) delta_t tensor(0.1003, dtype=torch.float64)
16 gae_duplicate tensor(-0.0148, dtype=torch.float64) tensor(-2.6327, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9685, dtype=torch.float64) delta_t tensor(0.1238, dtype=torch.float64)
15 gae_duplicate tensor(-0.2009, dtype=torch.float64) tensor(-3.2596, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4223, dtype=torch.float64) delta_t tensor(-0.1989, dtype=torch.float64)
14 gae_duplicate tensor(-1.9630, dtype=torch.float64) tensor(2.6390, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6496, dtype=torch.float64) delta_t tensor(0.2652, dtype=torch.float64)
13 gae_duplicate tensor(0.0379, dtype=torch.float64) tensor(-4.3492, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6301, dtype=torch.float64) delta_t tensor(0.3033, dtype=torch.float64)
12 gae_duplicate tensor(0.0867, dtype=torch.float64) tensor(-5.6574, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3192, dtype=torch.float64) delta_t tensor(0.0195, dtype=torch.float64)
11 gae_duplicate tensor(-0.3776, dtype=torch.float64) tensor(-1.4819, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7734, dtype=torch.float64) delta_t tensor(-0.6462, dtype=torch.float64)
10 gae_duplicate tensor(-4.9744, dtype=torch.float64) tensor(10.7789, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4189, dtype=torch.float64) delta_t tensor(-0.5464, dtype=torch.float64)
9 gae_duplicate tensor(-3.8057, dtype=torch.float64) tensor(10.3170, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4937, dtype=torch.float64) delta_t tensor(0.2763, dtype=torch.float64)
8 gae_duplicate tensor(-0.1183, dtype=torch.float64) tensor(-3.7779, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.3823, dtype=torch.float64) delta_t tensor(-0.8335, dtype=torch.float64)
7 gae_duplicate tensor(-3.5636, dtype=torch.float64) tensor(15.9310, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9287, dtype=torch.float64) delta_t tensor(-0.0097, dtype=torch.float64)
6 gae_duplicate tensor(-0.8182, dtype=torch.float64) tensor(1.7493, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6662, dtype=torch.float64) delta_t tensor(0.2508, dtype=torch.float64)
5 gae_duplicate tensor(-0.1441, dtype=torch.float64) tensor(-4.5168, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2946, dtype=torch.float64) delta_t tensor(0.1364, dtype=torch.float64)
4 gae_duplicate tensor(-0.1912, dtype=torch.float64) tensor(-3.5098, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7607, dtype=torch.float64) delta_t tensor(-0.1052, dtype=torch.float64)
3 gae_duplicate tensor(-0.4341, dtype=torch.float64) tensor(1.4989, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6296, dtype=torch.float64) delta_t tensor(0.1478, dtype=torch.float64)
2 gae_duplicate tensor(-0.1227, dtype=torch.float64) tensor(-2.3916, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-652.7538452148438
value loss:102.17013549804688
entropies:340.0273742675781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.272062063217163 seconds
19 rew tensor(1.1861, dtype=torch.float64) delta_t tensor(-0.1091, dtype=torch.float64)
19 gae_duplicate tensor(-0.1457, dtype=torch.float64) tensor(2.0673, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1367, dtype=torch.float64) delta_t tensor(-0.0287, dtype=torch.float64)
18 gae_duplicate tensor(-0.1314, dtype=torch.float64) tensor(0.7164, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1118, dtype=torch.float64) delta_t tensor(-0.0488, dtype=torch.float64)
17 gae_duplicate tensor(-0.1653, dtype=torch.float64) tensor(1.1139, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0220, dtype=torch.float64) delta_t tensor(-0.0444, dtype=torch.float64)
16 gae_duplicate tensor(-0.1868, dtype=torch.float64) tensor(1.0504, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9858, dtype=torch.float64) delta_t tensor(0.0550, dtype=torch.float64)
15 gae_duplicate tensor(-0.1961, dtype=torch.float64) tensor(-1.1823, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7425, dtype=torch.float64) delta_t tensor(0.1110, dtype=torch.float64)
14 gae_duplicate tensor(-0.2168, dtype=torch.float64) tensor(-1.9748, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4735, dtype=torch.float64) delta_t tensor(-0.1056, dtype=torch.float64)
13 gae_duplicate tensor(-1.1269, dtype=torch.float64) tensor(2.5186, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2980, dtype=torch.float64) delta_t tensor(0.1165, dtype=torch.float64)
12 gae_duplicate tensor(-0.1778, dtype=torch.float64) tensor(-2.4816, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3250, dtype=torch.float64) delta_t tensor(-0.7314, dtype=torch.float64)
11 gae_duplicate tensor(-4.8208, dtype=torch.float64) tensor(16.2970, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4084, dtype=torch.float64) delta_t tensor(-0.1195, dtype=torch.float64)
10 gae_duplicate tensor(-1.2913, dtype=torch.float64) tensor(4.4171, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4060, dtype=torch.float64) delta_t tensor(0.0758, dtype=torch.float64)
9 gae_duplicate tensor(-0.1763, dtype=torch.float64) tensor(-1.0797, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5957, dtype=torch.float64) delta_t tensor(0.0870, dtype=torch.float64)
8 gae_duplicate tensor(-0.0892, dtype=torch.float64) tensor(-1.5432, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4843, dtype=torch.float64) delta_t tensor(-0.5712, dtype=torch.float64)
7 gae_duplicate tensor(-3.8076, dtype=torch.float64) tensor(9.3105, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7971, dtype=torch.float64) delta_t tensor(0.0468, dtype=torch.float64)
6 gae_duplicate tensor(-0.4711, dtype=torch.float64) tensor(-0.1253, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5077, dtype=torch.float64) delta_t tensor(0.1488, dtype=torch.float64)
5 gae_duplicate tensor(-0.0395, dtype=torch.float64) tensor(-2.8434, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0866, dtype=torch.float64) delta_t tensor(-0.0206, dtype=torch.float64)
4 gae_duplicate tensor(-0.1918, dtype=torch.float64) tensor(0.2706, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0829, dtype=torch.float64) delta_t tensor(0.0930, dtype=torch.float64)
3 gae_duplicate tensor(-0.3275, dtype=torch.float64) tensor(-1.6458, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2584, dtype=torch.float64) delta_t tensor(-0.0229, dtype=torch.float64)
2 gae_duplicate tensor(-0.2871, dtype=torch.float64) tensor(0.5062, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1463.191162109375
value loss:66.85133361816406
entropies:340.83453369140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.539383888244629 seconds
19 rew tensor(1.1626, dtype=torch.float64) delta_t tensor(-0.1851, dtype=torch.float64)
19 gae_duplicate tensor(-0.2521, dtype=torch.float64) tensor(3.8400, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1632, dtype=torch.float64) delta_t tensor(-0.0057, dtype=torch.float64)
18 gae_duplicate tensor(-0.1127, dtype=torch.float64) tensor(0.3808, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0999, dtype=torch.float64) delta_t tensor(-0.0509, dtype=torch.float64)
17 gae_duplicate tensor(-0.1770, dtype=torch.float64) tensor(1.3166, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9864, dtype=torch.float64) delta_t tensor(-0.0540, dtype=torch.float64)
16 gae_duplicate tensor(-0.2870, dtype=torch.float64) tensor(1.1931, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9369, dtype=torch.float64) delta_t tensor(-0.0218, dtype=torch.float64)
15 gae_duplicate tensor(-0.2761, dtype=torch.float64) tensor(0.4563, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5144, dtype=torch.float64) delta_t tensor(-0.0491, dtype=torch.float64)
14 gae_duplicate tensor(-1.2343, dtype=torch.float64) tensor(0.2560, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4836, dtype=torch.float64) delta_t tensor(-0.0954, dtype=torch.float64)
13 gae_duplicate tensor(-1.6378, dtype=torch.float64) tensor(1.3721, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3213, dtype=torch.float64) delta_t tensor(0.0346, dtype=torch.float64)
12 gae_duplicate tensor(-0.2127, dtype=torch.float64) tensor(-0.6326, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1707, dtype=torch.float64) delta_t tensor(-0.5517, dtype=torch.float64)
11 gae_duplicate tensor(-3.3636, dtype=torch.float64) tensor(9.7711, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0416, dtype=torch.float64) delta_t tensor(0.2313, dtype=torch.float64)
10 gae_duplicate tensor(-0.0140, dtype=torch.float64) tensor(-3.7344, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3383, dtype=torch.float64) delta_t tensor(0.0210, dtype=torch.float64)
9 gae_duplicate tensor(-0.2417, dtype=torch.float64) tensor(-1.2206, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5201, dtype=torch.float64) delta_t tensor(0.0951, dtype=torch.float64)
8 gae_duplicate tensor(-0.1151, dtype=torch.float64) tensor(-2.0207, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5505, dtype=torch.float64) delta_t tensor(0.1662, dtype=torch.float64)
7 gae_duplicate tensor(-0.3064, dtype=torch.float64) tensor(-4.2693, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6365, dtype=torch.float64) delta_t tensor(0.2061, dtype=torch.float64)
6 gae_duplicate tensor(-0.0210, dtype=torch.float64) tensor(-5.6339, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4945, dtype=torch.float64) delta_t tensor(0.1824, dtype=torch.float64)
5 gae_duplicate tensor(-0.0946, dtype=torch.float64) tensor(-4.6827, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1122, dtype=torch.float64) delta_t tensor(-0.0458, dtype=torch.float64)
4 gae_duplicate tensor(-0.1641, dtype=torch.float64) tensor(0.7443, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9103, dtype=torch.float64) delta_t tensor(0.2167, dtype=torch.float64)
3 gae_duplicate tensor(0.0700, dtype=torch.float64) tensor(-3.7228, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2191, dtype=torch.float64) delta_t tensor(-0.0870, dtype=torch.float64)
2 gae_duplicate tensor(-0.2260, dtype=torch.float64) tensor(1.0513, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:206.76966857910156
value loss:31.305450439453125
entropies:341.2639465332031
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3886.7571)
ToM Target loss= tensor(3751.7561)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.895946979522705 seconds
19 rew tensor(1.2107, dtype=torch.float64) delta_t tensor(-0.1595, dtype=torch.float64)
19 gae_duplicate tensor(-0.2523, dtype=torch.float64) tensor(3.4571, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2124, dtype=torch.float64) delta_t tensor(0.0094, dtype=torch.float64)
18 gae_duplicate tensor(-0.1297, dtype=torch.float64) tensor(-0.1137, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0823, dtype=torch.float64) delta_t tensor(-0.0870, dtype=torch.float64)
17 gae_duplicate tensor(-0.1932, dtype=torch.float64) tensor(1.8005, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9834, dtype=torch.float64) delta_t tensor(-0.1157, dtype=torch.float64)
16 gae_duplicate tensor(-0.1988, dtype=torch.float64) tensor(2.2701, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9465, dtype=torch.float64) delta_t tensor(0.0258, dtype=torch.float64)
15 gae_duplicate tensor(-0.2011, dtype=torch.float64) tensor(-0.4081, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3567, dtype=torch.float64) delta_t tensor(-0.1907, dtype=torch.float64)
14 gae_duplicate tensor(-1.2871, dtype=torch.float64) tensor(3.2760, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6508, dtype=torch.float64) delta_t tensor(0.1134, dtype=torch.float64)
13 gae_duplicate tensor(-0.0676, dtype=torch.float64) tensor(-1.6427, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2450, dtype=torch.float64) delta_t tensor(0.0257, dtype=torch.float64)
12 gae_duplicate tensor(-0.2392, dtype=torch.float64) tensor(-0.7100, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4722, dtype=torch.float64) delta_t tensor(-0.0236, dtype=torch.float64)
11 gae_duplicate tensor(-0.1005, dtype=torch.float64) tensor(0.2961, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0299, dtype=torch.float64) delta_t tensor(0.1972, dtype=torch.float64)
10 gae_duplicate tensor(-0.0606, dtype=torch.float64) tensor(-3.4200, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3500, dtype=torch.float64) delta_t tensor(0.0638, dtype=torch.float64)
9 gae_duplicate tensor(-0.0933, dtype=torch.float64) tensor(-1.4337, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6764, dtype=torch.float64) delta_t tensor(-0.0401, dtype=torch.float64)
8 gae_duplicate tensor(-0.2246, dtype=torch.float64) tensor(0.4905, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3142, dtype=torch.float64) delta_t tensor(-0.1253, dtype=torch.float64)
7 gae_duplicate tensor(-2.1765, dtype=torch.float64) tensor(1.9618, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7405, dtype=torch.float64) delta_t tensor(0.2124, dtype=torch.float64)
6 gae_duplicate tensor(-0.2122, dtype=torch.float64) tensor(-3.4051, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4854, dtype=torch.float64) delta_t tensor(0.3302, dtype=torch.float64)
5 gae_duplicate tensor(-0.1029, dtype=torch.float64) tensor(-6.5797, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1070, dtype=torch.float64) delta_t tensor(0.0430, dtype=torch.float64)
4 gae_duplicate tensor(-0.1615, dtype=torch.float64) tensor(-1.4713, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2111, dtype=torch.float64) delta_t tensor(0.0171, dtype=torch.float64)
3 gae_duplicate tensor(-0.2512, dtype=torch.float64) tensor(0.1460, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4519, dtype=torch.float64) delta_t tensor(0.0871, dtype=torch.float64)
2 gae_duplicate tensor(-0.2095, dtype=torch.float64) tensor(-1.7658, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:299.27130126953125
value loss:17.12234878540039
entropies:341.9667663574219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.965912818908691 seconds
19 rew tensor(1.1749, dtype=torch.float64) delta_t tensor(-0.1481, dtype=torch.float64)
19 gae_duplicate tensor(-0.2558, dtype=torch.float64) tensor(2.6786, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1627, dtype=torch.float64) delta_t tensor(-0.0038, dtype=torch.float64)
18 gae_duplicate tensor(-0.1584, dtype=torch.float64) tensor(0.3613, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0223, dtype=torch.float64) delta_t tensor(-0.0794, dtype=torch.float64)
17 gae_duplicate tensor(-0.1569, dtype=torch.float64) tensor(1.4977, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9735, dtype=torch.float64) delta_t tensor(-0.1311, dtype=torch.float64)
16 gae_duplicate tensor(-0.2863, dtype=torch.float64) tensor(2.4524, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9113, dtype=torch.float64) delta_t tensor(-0.0159, dtype=torch.float64)
15 gae_duplicate tensor(-0.2766, dtype=torch.float64) tensor(0.6114, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5406, dtype=torch.float64) delta_t tensor(-0.1125, dtype=torch.float64)
14 gae_duplicate tensor(-0.8593, dtype=torch.float64) tensor(2.1793, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5628, dtype=torch.float64) delta_t tensor(0.0436, dtype=torch.float64)
13 gae_duplicate tensor(-0.1061, dtype=torch.float64) tensor(-0.7110, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3348, dtype=torch.float64) delta_t tensor(0.0723, dtype=torch.float64)
12 gae_duplicate tensor(-0.2414, dtype=torch.float64) tensor(-1.3229, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4024, dtype=torch.float64) delta_t tensor(0.0283, dtype=torch.float64)
11 gae_duplicate tensor(-0.1527, dtype=torch.float64) tensor(-0.8067, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0385, dtype=torch.float64) delta_t tensor(0.0842, dtype=torch.float64)
10 gae_duplicate tensor(-0.0047, dtype=torch.float64) tensor(-1.7557, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2363, dtype=torch.float64) delta_t tensor(0.1396, dtype=torch.float64)
9 gae_duplicate tensor(-0.1409, dtype=torch.float64) tensor(-2.6606, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4210, dtype=torch.float64) delta_t tensor(0.1528, dtype=torch.float64)
8 gae_duplicate tensor(-0.0273, dtype=torch.float64) tensor(-2.9381, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1464, dtype=torch.float64) delta_t tensor(0.1375, dtype=torch.float64)
7 gae_duplicate tensor(-0.1084, dtype=torch.float64) tensor(-3.0695, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5499, dtype=torch.float64) delta_t tensor(0.2514, dtype=torch.float64)
6 gae_duplicate tensor(-0.0019, dtype=torch.float64) tensor(-5.0608, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7188, dtype=torch.float64) delta_t tensor(0.2699, dtype=torch.float64)
5 gae_duplicate tensor(0.1270, dtype=torch.float64) tensor(-6.0116, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2462, dtype=torch.float64) delta_t tensor(-0.0124, dtype=torch.float64)
4 gae_duplicate tensor(-0.2256, dtype=torch.float64) tensor(-0.5777, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3688, dtype=torch.float64) delta_t tensor(0.2569, dtype=torch.float64)
3 gae_duplicate tensor(0.0760, dtype=torch.float64) tensor(-4.6430, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6032, dtype=torch.float64) delta_t tensor(-0.0045, dtype=torch.float64)
2 gae_duplicate tensor(-0.3403, dtype=torch.float64) tensor(-0.2454, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:988.7777099609375
value loss:8.240670204162598
entropies:342.3284606933594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.979959011077881 seconds
19 rew tensor(1.2263, dtype=torch.float64) delta_t tensor(-0.0590, dtype=torch.float64)
19 gae_duplicate tensor(-0.1512, dtype=torch.float64) tensor(1.2551, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1749, dtype=torch.float64) delta_t tensor(0.0567, dtype=torch.float64)
18 gae_duplicate tensor(-0.0090, dtype=torch.float64) tensor(-1.0711, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0851, dtype=torch.float64) delta_t tensor(0.0234, dtype=torch.float64)
17 gae_duplicate tensor(-0.0530, dtype=torch.float64) tensor(-0.4525, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9231, dtype=torch.float64) delta_t tensor(-0.1044, dtype=torch.float64)
16 gae_duplicate tensor(-0.1954, dtype=torch.float64) tensor(1.7269, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8852, dtype=torch.float64) delta_t tensor(0.0498, dtype=torch.float64)
15 gae_duplicate tensor(-0.1477, dtype=torch.float64) tensor(-0.8351, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3814, dtype=torch.float64) delta_t tensor(-0.0940, dtype=torch.float64)
14 gae_duplicate tensor(-0.8345, dtype=torch.float64) tensor(1.4289, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5754, dtype=torch.float64) delta_t tensor(0.1387, dtype=torch.float64)
13 gae_duplicate tensor(-0.0648, dtype=torch.float64) tensor(-2.7083, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2711, dtype=torch.float64) delta_t tensor(0.0233, dtype=torch.float64)
12 gae_duplicate tensor(-0.1836, dtype=torch.float64) tensor(-0.6545, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3961, dtype=torch.float64) delta_t tensor(0.0397, dtype=torch.float64)
11 gae_duplicate tensor(-0.0811, dtype=torch.float64) tensor(-0.7768, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0771, dtype=torch.float64) delta_t tensor(0.0957, dtype=torch.float64)
10 gae_duplicate tensor(-0.1373, dtype=torch.float64) tensor(-1.8650, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2102, dtype=torch.float64) delta_t tensor(0.1478, dtype=torch.float64)
9 gae_duplicate tensor(-0.0477, dtype=torch.float64) tensor(-2.7579, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4699, dtype=torch.float64) delta_t tensor(0.0952, dtype=torch.float64)
8 gae_duplicate tensor(-0.0594, dtype=torch.float64) tensor(-2.1360, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0233, dtype=torch.float64) delta_t tensor(0.0142, dtype=torch.float64)
7 gae_duplicate tensor(-0.1916, dtype=torch.float64) tensor(-0.7213, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6244, dtype=torch.float64) delta_t tensor(0.3702, dtype=torch.float64)
6 gae_duplicate tensor(0.1766, dtype=torch.float64) tensor(-7.0094, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6214, dtype=torch.float64) delta_t tensor(0.1490, dtype=torch.float64)
5 gae_duplicate tensor(-0.0160, dtype=torch.float64) tensor(-3.9410, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1443, dtype=torch.float64) delta_t tensor(0.0028, dtype=torch.float64)
4 gae_duplicate tensor(-0.0858, dtype=torch.float64) tensor(-0.3436, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2441, dtype=torch.float64) delta_t tensor(0.0019, dtype=torch.float64)
3 gae_duplicate tensor(-0.1259, dtype=torch.float64) tensor(0.0524, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5007, dtype=torch.float64) delta_t tensor(-0.0656, dtype=torch.float64)
2 gae_duplicate tensor(-0.6404, dtype=torch.float64) tensor(0.8277, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:986.4716796875
value loss:7.196167945861816
entropies:342.7686767578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.904195785522461 seconds
19 rew tensor(1.1132, dtype=torch.float64) delta_t tensor(-0.0163, dtype=torch.float64)
19 gae_duplicate tensor(-0.1467, dtype=torch.float64) tensor(0.2530, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8136, dtype=torch.float64) delta_t tensor(-0.1730, dtype=torch.float64)
18 gae_duplicate tensor(-1.4453, dtype=torch.float64) tensor(3.2151, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9995, dtype=torch.float64) delta_t tensor(0.0449, dtype=torch.float64)
17 gae_duplicate tensor(-0.1624, dtype=torch.float64) tensor(-0.5972, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9344, dtype=torch.float64) delta_t tensor(0.0337, dtype=torch.float64)
16 gae_duplicate tensor(-0.0951, dtype=torch.float64) tensor(-0.6438, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7948, dtype=torch.float64) delta_t tensor(0.0042, dtype=torch.float64)
15 gae_duplicate tensor(-0.0522, dtype=torch.float64) tensor(-0.1227, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7265, dtype=torch.float64) delta_t tensor(0.1418, dtype=torch.float64)
14 gae_duplicate tensor(0.0291, dtype=torch.float64) tensor(-3.0404, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6278, dtype=torch.float64) delta_t tensor(0.1535, dtype=torch.float64)
13 gae_duplicate tensor(-0.2087, dtype=torch.float64) tensor(-3.3312, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3863, dtype=torch.float64) delta_t tensor(0.1066, dtype=torch.float64)
12 gae_duplicate tensor(0.0348, dtype=torch.float64) tensor(-2.2748, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3440, dtype=torch.float64) delta_t tensor(0.0811, dtype=torch.float64)
11 gae_duplicate tensor(-0.1092, dtype=torch.float64) tensor(-1.8323, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0428, dtype=torch.float64) delta_t tensor(0.0734, dtype=torch.float64)
10 gae_duplicate tensor(-0.0629, dtype=torch.float64) tensor(-1.6994, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1800, dtype=torch.float64) delta_t tensor(0.0207, dtype=torch.float64)
9 gae_duplicate tensor(-0.1052, dtype=torch.float64) tensor(-0.3307, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4701, dtype=torch.float64) delta_t tensor(0.0315, dtype=torch.float64)
8 gae_duplicate tensor(-0.0790, dtype=torch.float64) tensor(-0.7676, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8923, dtype=torch.float64) delta_t tensor(0.0978, dtype=torch.float64)
7 gae_duplicate tensor(-0.1464, dtype=torch.float64) tensor(-2.1019, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5471, dtype=torch.float64) delta_t tensor(0.0672, dtype=torch.float64)
6 gae_duplicate tensor(-0.0890, dtype=torch.float64) tensor(-1.4401, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6454, dtype=torch.float64) delta_t tensor(-0.0185, dtype=torch.float64)
5 gae_duplicate tensor(-0.1856, dtype=torch.float64) tensor(0.1905, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0659, dtype=torch.float64) delta_t tensor(-0.0079, dtype=torch.float64)
4 gae_duplicate tensor(-0.2425, dtype=torch.float64) tensor(0.0662, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1389, dtype=torch.float64) delta_t tensor(-0.0342, dtype=torch.float64)
3 gae_duplicate tensor(-0.4783, dtype=torch.float64) tensor(0.3948, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4097, dtype=torch.float64) delta_t tensor(-0.0802, dtype=torch.float64)
2 gae_duplicate tensor(-0.3202, dtype=torch.float64) tensor(1.3006, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:596.431884765625
value loss:7.882868766784668
entropies:343.34344482421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9876580238342285 seconds
19 rew tensor(1.2393, dtype=torch.float64) delta_t tensor(0.1349, dtype=torch.float64)
19 gae_duplicate tensor(0.0191, dtype=torch.float64) tensor(-2.8383, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2264, dtype=torch.float64) delta_t tensor(0.2635, dtype=torch.float64)
18 gae_duplicate tensor(0.1322, dtype=torch.float64) tensor(-5.3401, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1108, dtype=torch.float64) delta_t tensor(0.1444, dtype=torch.float64)
17 gae_duplicate tensor(0.0001, dtype=torch.float64) tensor(-3.5835, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0736, dtype=torch.float64) delta_t tensor(0.1996, dtype=torch.float64)
16 gae_duplicate tensor(0.0428, dtype=torch.float64) tensor(-4.6981, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9436, dtype=torch.float64) delta_t tensor(0.2750, dtype=torch.float64)
15 gae_duplicate tensor(0.0915, dtype=torch.float64) tensor(-5.4040, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0830, dtype=torch.float64) delta_t tensor(-0.4099, dtype=torch.float64)
14 gae_duplicate tensor(-1.8810, dtype=torch.float64) tensor(6.3088, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3679, dtype=torch.float64) delta_t tensor(-0.0554, dtype=torch.float64)
13 gae_duplicate tensor(-1.0026, dtype=torch.float64) tensor(1.9101, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0511, dtype=torch.float64) delta_t tensor(0.0906, dtype=torch.float64)
12 gae_duplicate tensor(-1.1990, dtype=torch.float64) tensor(-0.4266, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6531, dtype=torch.float64) delta_t tensor(0.1333, dtype=torch.float64)
11 gae_duplicate tensor(-0.0078, dtype=torch.float64) tensor(-2.9627, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2283, dtype=torch.float64) delta_t tensor(0.1031, dtype=torch.float64)
10 gae_duplicate tensor(-0.2067, dtype=torch.float64) tensor(-2.2549, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6910, dtype=torch.float64) delta_t tensor(0.0542, dtype=torch.float64)
9 gae_duplicate tensor(-0.0951, dtype=torch.float64) tensor(-1.1692, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7965, dtype=torch.float64) delta_t tensor(-0.0476, dtype=torch.float64)
8 gae_duplicate tensor(-0.1702, dtype=torch.float64) tensor(0.7937, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6544, dtype=torch.float64) delta_t tensor(-0.3088, dtype=torch.float64)
7 gae_duplicate tensor(-2.1169, dtype=torch.float64) tensor(6.7739, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1364, dtype=torch.float64) delta_t tensor(-0.0761, dtype=torch.float64)
6 gae_duplicate tensor(-0.4980, dtype=torch.float64) tensor(1.7146, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9736, dtype=torch.float64) delta_t tensor(0.1588, dtype=torch.float64)
5 gae_duplicate tensor(-0.1283, dtype=torch.float64) tensor(-2.6349, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2995, dtype=torch.float64) delta_t tensor(-0.0900, dtype=torch.float64)
4 gae_duplicate tensor(-0.3117, dtype=torch.float64) tensor(1.3138, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6489, dtype=torch.float64) delta_t tensor(-0.0267, dtype=torch.float64)
3 gae_duplicate tensor(-0.3208, dtype=torch.float64) tensor(0.5917, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0455, dtype=torch.float64) delta_t tensor(-0.0656, dtype=torch.float64)
2 gae_duplicate tensor(-0.2563, dtype=torch.float64) tensor(1.2021, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:485.0760803222656
value loss:26.62099838256836
entropies:344.14105224609375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3910.1938)
ToM Target loss= tensor(3774.7532)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.770977020263672 seconds
19 rew tensor(1.1247, dtype=torch.float64) delta_t tensor(0.0636, dtype=torch.float64)
19 gae_duplicate tensor(0.0125, dtype=torch.float64) tensor(-1.1646, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1505, dtype=torch.float64) delta_t tensor(0.2187, dtype=torch.float64)
18 gae_duplicate tensor(0.1451, dtype=torch.float64) tensor(-4.5390, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0376, dtype=torch.float64) delta_t tensor(0.1139, dtype=torch.float64)
17 gae_duplicate tensor(0.0394, dtype=torch.float64) tensor(-2.4763, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9507, dtype=torch.float64) delta_t tensor(0.1284, dtype=torch.float64)
16 gae_duplicate tensor(-0.0337, dtype=torch.float64) tensor(-2.6059, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9363, dtype=torch.float64) delta_t tensor(0.2108, dtype=torch.float64)
15 gae_duplicate tensor(0.1622, dtype=torch.float64) tensor(-4.3431, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3668, dtype=torch.float64) delta_t tensor(-0.0035, dtype=torch.float64)
14 gae_duplicate tensor(-0.9057, dtype=torch.float64) tensor(-0.0518, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6499, dtype=torch.float64) delta_t tensor(0.0495, dtype=torch.float64)
13 gae_duplicate tensor(-0.2389, dtype=torch.float64) tensor(-1.0551, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1840, dtype=torch.float64) delta_t tensor(0.1296, dtype=torch.float64)
12 gae_duplicate tensor(-0.1111, dtype=torch.float64) tensor(-2.6097, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6132, dtype=torch.float64) delta_t tensor(0.1495, dtype=torch.float64)
11 gae_duplicate tensor(0.0246, dtype=torch.float64) tensor(-2.9600, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1125, dtype=torch.float64) delta_t tensor(0.0282, dtype=torch.float64)
10 gae_duplicate tensor(-0.0364, dtype=torch.float64) tensor(-0.7564, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4874, dtype=torch.float64) delta_t tensor(0.1305, dtype=torch.float64)
9 gae_duplicate tensor(-0.1533, dtype=torch.float64) tensor(-2.3223, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7235, dtype=torch.float64) delta_t tensor(-0.1170, dtype=torch.float64)
8 gae_duplicate tensor(-0.2518, dtype=torch.float64) tensor(1.8929, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3574, dtype=torch.float64) delta_t tensor(0.0354, dtype=torch.float64)
7 gae_duplicate tensor(-0.1621, dtype=torch.float64) tensor(-0.6664, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7635, dtype=torch.float64) delta_t tensor(0.0868, dtype=torch.float64)
6 gae_duplicate tensor(-0.0366, dtype=torch.float64) tensor(-1.6866, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2706, dtype=torch.float64) delta_t tensor(-0.0413, dtype=torch.float64)
5 gae_duplicate tensor(-0.1847, dtype=torch.float64) tensor(0.6812, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1317, dtype=torch.float64) delta_t tensor(-0.0326, dtype=torch.float64)
4 gae_duplicate tensor(-0.1818, dtype=torch.float64) tensor(0.5785, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7802, dtype=torch.float64) delta_t tensor(-0.1224, dtype=torch.float64)
3 gae_duplicate tensor(-0.2814, dtype=torch.float64) tensor(2.3379, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2381, dtype=torch.float64) delta_t tensor(1.2783e-05, dtype=torch.float64)
2 gae_duplicate tensor(-0.3851, dtype=torch.float64) tensor(0.5438, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1051.8408203125
value loss:5.969537734985352
entropies:344.84991455078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.967336893081665 seconds
19 rew tensor(1.1515, dtype=torch.float64) delta_t tensor(0.0605, dtype=torch.float64)
19 gae_duplicate tensor(-0.0708, dtype=torch.float64) tensor(-1.1713, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0872, dtype=torch.float64) delta_t tensor(0.1037, dtype=torch.float64)
18 gae_duplicate tensor(0.0782, dtype=torch.float64) tensor(-2.1625, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0241, dtype=torch.float64) delta_t tensor(0.0587, dtype=torch.float64)
17 gae_duplicate tensor(-0.0023, dtype=torch.float64) tensor(-1.4407, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0139, dtype=torch.float64) delta_t tensor(0.0726, dtype=torch.float64)
16 gae_duplicate tensor(-0.0942, dtype=torch.float64) tensor(-1.6769, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8978, dtype=torch.float64) delta_t tensor(0.1329, dtype=torch.float64)
15 gae_duplicate tensor(-0.0782, dtype=torch.float64) tensor(-2.7843, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1940, dtype=torch.float64) delta_t tensor(-0.2963, dtype=torch.float64)
14 gae_duplicate tensor(-1.4120, dtype=torch.float64) tensor(5.4249, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1013, dtype=torch.float64) delta_t tensor(-0.3264, dtype=torch.float64)
13 gae_duplicate tensor(-1.4897, dtype=torch.float64) tensor(7.1929, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3793, dtype=torch.float64) delta_t tensor(0.2066, dtype=torch.float64)
12 gae_duplicate tensor(-0.0753, dtype=torch.float64) tensor(-3.4111, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4359, dtype=torch.float64) delta_t tensor(0.0796, dtype=torch.float64)
11 gae_duplicate tensor(-0.1845, dtype=torch.float64) tensor(-1.7682, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0809, dtype=torch.float64) delta_t tensor(0.1003, dtype=torch.float64)
10 gae_duplicate tensor(-0.1212, dtype=torch.float64) tensor(-2.0509, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4162, dtype=torch.float64) delta_t tensor(-0.0469, dtype=torch.float64)
9 gae_duplicate tensor(-0.2377, dtype=torch.float64) tensor(0.4578, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5690, dtype=torch.float64) delta_t tensor(-0.0305, dtype=torch.float64)
8 gae_duplicate tensor(-0.1439, dtype=torch.float64) tensor(0.6174, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3064, dtype=torch.float64) delta_t tensor(0.0589, dtype=torch.float64)
7 gae_duplicate tensor(-0.2652, dtype=torch.float64) tensor(-1.0971, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7082, dtype=torch.float64) delta_t tensor(0.0642, dtype=torch.float64)
6 gae_duplicate tensor(-0.1789, dtype=torch.float64) tensor(-1.3798, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2768, dtype=torch.float64) delta_t tensor(-0.0593, dtype=torch.float64)
5 gae_duplicate tensor(-0.3359, dtype=torch.float64) tensor(0.8131, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2605, dtype=torch.float64) delta_t tensor(-0.0981, dtype=torch.float64)
4 gae_duplicate tensor(-0.2965, dtype=torch.float64) tensor(1.7199, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6138, dtype=torch.float64) delta_t tensor(-0.0105, dtype=torch.float64)
3 gae_duplicate tensor(-0.1679, dtype=torch.float64) tensor(0.4107, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0975, dtype=torch.float64) delta_t tensor(0.0322, dtype=torch.float64)
2 gae_duplicate tensor(-0.1533, dtype=torch.float64) tensor(-0.7498, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:71.76617431640625
value loss:16.174413681030273
entropies:345.3380126953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.948676109313965 seconds
19 rew tensor(1.1889, dtype=torch.float64) delta_t tensor(0.0254, dtype=torch.float64)
19 gae_duplicate tensor(-0.1099, dtype=torch.float64) tensor(-0.4915, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1148, dtype=torch.float64) delta_t tensor(0.0995, dtype=torch.float64)
18 gae_duplicate tensor(-0.0331, dtype=torch.float64) tensor(-2.0800, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0480, dtype=torch.float64) delta_t tensor(0.0389, dtype=torch.float64)
17 gae_duplicate tensor(-0.0974, dtype=torch.float64) tensor(-0.9565, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9491, dtype=torch.float64) delta_t tensor(0.0296, dtype=torch.float64)
16 gae_duplicate tensor(-0.1258, dtype=torch.float64) tensor(-0.6896, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8327, dtype=torch.float64) delta_t tensor(0.0603, dtype=torch.float64)
15 gae_duplicate tensor(-0.1335, dtype=torch.float64) tensor(-1.4466, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6649, dtype=torch.float64) delta_t tensor(0.1699, dtype=torch.float64)
14 gae_duplicate tensor(-0.0743, dtype=torch.float64) tensor(-3.6099, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6397, dtype=torch.float64) delta_t tensor(0.1009, dtype=torch.float64)
13 gae_duplicate tensor(0.0378, dtype=torch.float64) tensor(-2.1978, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2942, dtype=torch.float64) delta_t tensor(0.1143, dtype=torch.float64)
12 gae_duplicate tensor(-0.1218, dtype=torch.float64) tensor(-2.1728, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4979, dtype=torch.float64) delta_t tensor(0.0473, dtype=torch.float64)
11 gae_duplicate tensor(-0.1371, dtype=torch.float64) tensor(-1.0485, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0919, dtype=torch.float64) delta_t tensor(0.0293, dtype=torch.float64)
10 gae_duplicate tensor(-0.2357, dtype=torch.float64) tensor(-0.7536, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4894, dtype=torch.float64) delta_t tensor(0.0677, dtype=torch.float64)
9 gae_duplicate tensor(-0.0754, dtype=torch.float64) tensor(-1.8050, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5653, dtype=torch.float64) delta_t tensor(-0.1001, dtype=torch.float64)
8 gae_duplicate tensor(-0.3000, dtype=torch.float64) tensor(2.0018, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5942, dtype=torch.float64) delta_t tensor(0.0916, dtype=torch.float64)
7 gae_duplicate tensor(-0.3847, dtype=torch.float64) tensor(-1.6476, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8263, dtype=torch.float64) delta_t tensor(-0.0849, dtype=torch.float64)
6 gae_duplicate tensor(-0.2649, dtype=torch.float64) tensor(1.3078, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2528, dtype=torch.float64) delta_t tensor(-0.0847, dtype=torch.float64)
5 gae_duplicate tensor(-0.3784, dtype=torch.float64) tensor(1.9742, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1593, dtype=torch.float64) delta_t tensor(-0.1492, dtype=torch.float64)
4 gae_duplicate tensor(-0.3362, dtype=torch.float64) tensor(2.8916, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7084, dtype=torch.float64) delta_t tensor(0.0514, dtype=torch.float64)
3 gae_duplicate tensor(-0.2685, dtype=torch.float64) tensor(-1.0016, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1130, dtype=torch.float64) delta_t tensor(-0.2008, dtype=torch.float64)
2 gae_duplicate tensor(-0.6753, dtype=torch.float64) tensor(3.3090, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:361.10272216796875
value loss:6.920001983642578
entropies:345.8628845214844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.66185188293457 seconds
19 rew tensor(1.1619, dtype=torch.float64) delta_t tensor(-0.0944, dtype=torch.float64)
19 gae_duplicate tensor(-0.1498, dtype=torch.float64) tensor(1.7898, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1885, dtype=torch.float64) delta_t tensor(0.0798, dtype=torch.float64)
18 gae_duplicate tensor(-0.0859, dtype=torch.float64) tensor(-1.3811, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0894, dtype=torch.float64) delta_t tensor(0.0297, dtype=torch.float64)
17 gae_duplicate tensor(-0.0496, dtype=torch.float64) tensor(-0.6753, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7251, dtype=torch.float64) delta_t tensor(-0.2973, dtype=torch.float64)
16 gae_duplicate tensor(-1.4913, dtype=torch.float64) tensor(6.2452, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9228, dtype=torch.float64) delta_t tensor(0.0458, dtype=torch.float64)
15 gae_duplicate tensor(-0.2862, dtype=torch.float64) tensor(-0.4407, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4040, dtype=torch.float64) delta_t tensor(-0.0354, dtype=torch.float64)
14 gae_duplicate tensor(-0.6383, dtype=torch.float64) tensor(0.7343, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3967, dtype=torch.float64) delta_t tensor(-0.1876, dtype=torch.float64)
13 gae_duplicate tensor(-1.3560, dtype=torch.float64) tensor(3.3830, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2842, dtype=torch.float64) delta_t tensor(0.1315, dtype=torch.float64)
12 gae_duplicate tensor(-0.0109, dtype=torch.float64) tensor(-1.9751, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5505, dtype=torch.float64) delta_t tensor(0.0557, dtype=torch.float64)
11 gae_duplicate tensor(-0.0573, dtype=torch.float64) tensor(-1.4534, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1347, dtype=torch.float64) delta_t tensor(-0.0055, dtype=torch.float64)
10 gae_duplicate tensor(-0.2045, dtype=torch.float64) tensor(-0.0588, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5082, dtype=torch.float64) delta_t tensor(-0.0135, dtype=torch.float64)
9 gae_duplicate tensor(-0.3504, dtype=torch.float64) tensor(-0.1259, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7547, dtype=torch.float64) delta_t tensor(-0.1287, dtype=torch.float64)
8 gae_duplicate tensor(-0.3196, dtype=torch.float64) tensor(2.2877, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3815, dtype=torch.float64) delta_t tensor(-0.1921, dtype=torch.float64)
7 gae_duplicate tensor(-0.8345, dtype=torch.float64) tensor(3.4807, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9288, dtype=torch.float64) delta_t tensor(0.0523, dtype=torch.float64)
6 gae_duplicate tensor(-0.3195, dtype=torch.float64) tensor(-0.4052, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1433, dtype=torch.float64) delta_t tensor(-0.0378, dtype=torch.float64)
5 gae_duplicate tensor(-0.1508, dtype=torch.float64) tensor(0.7791, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3228, dtype=torch.float64) delta_t tensor(-0.0287, dtype=torch.float64)
4 gae_duplicate tensor(-0.1893, dtype=torch.float64) tensor(0.4853, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6116, dtype=torch.float64) delta_t tensor(-0.1103, dtype=torch.float64)
3 gae_duplicate tensor(-0.3114, dtype=torch.float64) tensor(2.1404, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0362, dtype=torch.float64) delta_t tensor(-0.0405, dtype=torch.float64)
2 gae_duplicate tensor(-0.4696, dtype=torch.float64) tensor(0.9387, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-943.9979858398438
value loss:11.990438461303711
entropies:346.5497131347656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.151320934295654 seconds
19 rew tensor(1.1632, dtype=torch.float64) delta_t tensor(-0.2021, dtype=torch.float64)
19 gae_duplicate tensor(-0.2455, dtype=torch.float64) tensor(3.9799, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1769, dtype=torch.float64) delta_t tensor(-0.0417, dtype=torch.float64)
18 gae_duplicate tensor(-0.1738, dtype=torch.float64) tensor(1.1888, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1633, dtype=torch.float64) delta_t tensor(-0.0352, dtype=torch.float64)
17 gae_duplicate tensor(-0.1050, dtype=torch.float64) tensor(0.8080, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1249, dtype=torch.float64) delta_t tensor(-0.0434, dtype=torch.float64)
16 gae_duplicate tensor(-0.1075, dtype=torch.float64) tensor(0.9948, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5241, dtype=torch.float64) delta_t tensor(-0.5094, dtype=torch.float64)
15 gae_duplicate tensor(-2.6336, dtype=torch.float64) tensor(10.8337, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2894, dtype=torch.float64) delta_t tensor(-0.3677, dtype=torch.float64)
14 gae_duplicate tensor(-1.2980, dtype=torch.float64) tensor(7.8141, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5062, dtype=torch.float64) delta_t tensor(-0.1250, dtype=torch.float64)
13 gae_duplicate tensor(-1.4172, dtype=torch.float64) tensor(2.9407, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2463, dtype=torch.float64) delta_t tensor(-0.4675, dtype=torch.float64)
12 gae_duplicate tensor(-3.9936, dtype=torch.float64) tensor(7.2798, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0063, dtype=torch.float64) delta_t tensor(-0.4921, dtype=torch.float64)
11 gae_duplicate tensor(-3.3645, dtype=torch.float64) tensor(11.5723, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0354, dtype=torch.float64) delta_t tensor(0.0233, dtype=torch.float64)
10 gae_duplicate tensor(-0.2772, dtype=torch.float64) tensor(0.8297, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4791, dtype=torch.float64) delta_t tensor(-0.0210, dtype=torch.float64)
9 gae_duplicate tensor(-0.1659, dtype=torch.float64) tensor(0.4446, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4900, dtype=torch.float64) delta_t tensor(0.0110, dtype=torch.float64)
8 gae_duplicate tensor(-0.1654, dtype=torch.float64) tensor(-0.1861, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.9338, dtype=torch.float64) delta_t tensor(-0.9369, dtype=torch.float64)
7 gae_duplicate tensor(-6.3138, dtype=torch.float64) tensor(16.0787, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7958, dtype=torch.float64) delta_t tensor(-0.1798, dtype=torch.float64)
6 gae_duplicate tensor(-0.9600, dtype=torch.float64) tensor(5.4111, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3978, dtype=torch.float64) delta_t tensor(0.1924, dtype=torch.float64)
5 gae_duplicate tensor(-0.2923, dtype=torch.float64) tensor(-3.4277, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0611, dtype=torch.float64) delta_t tensor(0.0362, dtype=torch.float64)
4 gae_duplicate tensor(-0.2420, dtype=torch.float64) tensor(-0.8236, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1886, dtype=torch.float64) delta_t tensor(-0.0697, dtype=torch.float64)
3 gae_duplicate tensor(-0.2320, dtype=torch.float64) tensor(1.4035, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4068, dtype=torch.float64) delta_t tensor(0.2118, dtype=torch.float64)
2 gae_duplicate tensor(-0.2685, dtype=torch.float64) tensor(-3.2515, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3543.87548828125
value loss:128.01502990722656
entropies:347.2836608886719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3900.2559)
ToM Target loss= tensor(3786.8730)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.018182754516602 seconds
19 rew tensor(1.1611, dtype=torch.float64) delta_t tensor(-0.1203, dtype=torch.float64)
19 gae_duplicate tensor(-0.1837, dtype=torch.float64) tensor(2.3885, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1232, dtype=torch.float64) delta_t tensor(0.0037, dtype=torch.float64)
18 gae_duplicate tensor(-0.1225, dtype=torch.float64) tensor(0.0710, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9975, dtype=torch.float64) delta_t tensor(-0.0990, dtype=torch.float64)
17 gae_duplicate tensor(-0.2270, dtype=torch.float64) tensor(1.9050, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9824, dtype=torch.float64) delta_t tensor(-0.0697, dtype=torch.float64)
16 gae_duplicate tensor(-0.2247, dtype=torch.float64) tensor(1.6993, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8955, dtype=torch.float64) delta_t tensor(0.0097, dtype=torch.float64)
15 gae_duplicate tensor(-0.1641, dtype=torch.float64) tensor(0.0815, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7920, dtype=torch.float64) delta_t tensor(0.2687, dtype=torch.float64)
14 gae_duplicate tensor(-0.0496, dtype=torch.float64) tensor(-4.9047, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6946, dtype=torch.float64) delta_t tensor(0.0596, dtype=torch.float64)
13 gae_duplicate tensor(-0.1678, dtype=torch.float64) tensor(-1.3328, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2685, dtype=torch.float64) delta_t tensor(0.0577, dtype=torch.float64)
12 gae_duplicate tensor(-0.2178, dtype=torch.float64) tensor(-0.9796, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5029, dtype=torch.float64) delta_t tensor(0.0334, dtype=torch.float64)
11 gae_duplicate tensor(-0.2199, dtype=torch.float64) tensor(-0.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1141, dtype=torch.float64) delta_t tensor(-0.0686, dtype=torch.float64)
10 gae_duplicate tensor(-0.2305, dtype=torch.float64) tensor(1.3394, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4090, dtype=torch.float64) delta_t tensor(0.1336, dtype=torch.float64)
9 gae_duplicate tensor(-0.0997, dtype=torch.float64) tensor(-2.2889, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5843, dtype=torch.float64) delta_t tensor(-0.1548, dtype=torch.float64)
8 gae_duplicate tensor(-0.2795, dtype=torch.float64) tensor(2.8851, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5899, dtype=torch.float64) delta_t tensor(-0.5879, dtype=torch.float64)
7 gae_duplicate tensor(-3.5962, dtype=torch.float64) tensor(10.1756, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7806, dtype=torch.float64) delta_t tensor(-0.0532, dtype=torch.float64)
6 gae_duplicate tensor(-0.8483, dtype=torch.float64) tensor(1.8588, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4947, dtype=torch.float64) delta_t tensor(0.0440, dtype=torch.float64)
5 gae_duplicate tensor(-0.2442, dtype=torch.float64) tensor(-0.7019, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1171, dtype=torch.float64) delta_t tensor(-0.0370, dtype=torch.float64)
4 gae_duplicate tensor(-0.1524, dtype=torch.float64) tensor(0.7460, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2317, dtype=torch.float64) delta_t tensor(-0.0590, dtype=torch.float64)
3 gae_duplicate tensor(-0.3115, dtype=torch.float64) tensor(1.2795, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4742, dtype=torch.float64) delta_t tensor(-0.0135, dtype=torch.float64)
2 gae_duplicate tensor(-0.3597, dtype=torch.float64) tensor(0.1136, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-821.3687133789062
value loss:26.667844772338867
entropies:347.93621826171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.660194158554077 seconds
19 rew tensor(1.1966, dtype=torch.float64) delta_t tensor(-0.1513, dtype=torch.float64)
19 gae_duplicate tensor(-0.2129, dtype=torch.float64) tensor(3.0620, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1974, dtype=torch.float64) delta_t tensor(0.0178, dtype=torch.float64)
18 gae_duplicate tensor(-0.1216, dtype=torch.float64) tensor(-0.1145, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8484, dtype=torch.float64) delta_t tensor(-0.2518, dtype=torch.float64)
17 gae_duplicate tensor(-1.4985, dtype=torch.float64) tensor(4.6653, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7666, dtype=torch.float64) delta_t tensor(-0.2957, dtype=torch.float64)
16 gae_duplicate tensor(-1.3171, dtype=torch.float64) tensor(5.7367, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8442, dtype=torch.float64) delta_t tensor(0.1003, dtype=torch.float64)
15 gae_duplicate tensor(-0.0935, dtype=torch.float64) tensor(-1.1267, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8045, dtype=torch.float64) delta_t tensor(0.1885, dtype=torch.float64)
14 gae_duplicate tensor(0.0324, dtype=torch.float64) tensor(-4.0747, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6565, dtype=torch.float64) delta_t tensor(0.1037, dtype=torch.float64)
13 gae_duplicate tensor(-0.0282, dtype=torch.float64) tensor(-2.1487, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4183, dtype=torch.float64) delta_t tensor(0.0498, dtype=torch.float64)
12 gae_duplicate tensor(-0.2151, dtype=torch.float64) tensor(-1.2323, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4244, dtype=torch.float64) delta_t tensor(0.0972, dtype=torch.float64)
11 gae_duplicate tensor(-0.0771, dtype=torch.float64) tensor(-1.9409, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1004, dtype=torch.float64) delta_t tensor(0.0274, dtype=torch.float64)
10 gae_duplicate tensor(-0.0970, dtype=torch.float64) tensor(-0.6430, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0833, dtype=torch.float64) delta_t tensor(-0.0204, dtype=torch.float64)
9 gae_duplicate tensor(-0.3003, dtype=torch.float64) tensor(0.0309, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5198, dtype=torch.float64) delta_t tensor(-0.1019, dtype=torch.float64)
8 gae_duplicate tensor(-0.3409, dtype=torch.float64) tensor(2.0612, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6720, dtype=torch.float64) delta_t tensor(-0.3136, dtype=torch.float64)
7 gae_duplicate tensor(-2.3212, dtype=torch.float64) tensor(7.0352, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6358, dtype=torch.float64) delta_t tensor(0.1509, dtype=torch.float64)
6 gae_duplicate tensor(-0.2187, dtype=torch.float64) tensor(-2.5955, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7173, dtype=torch.float64) delta_t tensor(0.0310, dtype=torch.float64)
5 gae_duplicate tensor(-0.1649, dtype=torch.float64) tensor(-1.0585, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2853, dtype=torch.float64) delta_t tensor(0.1055, dtype=torch.float64)
4 gae_duplicate tensor(-0.2638, dtype=torch.float64) tensor(-2.0270, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5189, dtype=torch.float64) delta_t tensor(-0.1971, dtype=torch.float64)
3 gae_duplicate tensor(-0.3392, dtype=torch.float64) tensor(3.4013, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6295, dtype=torch.float64) delta_t tensor(0.0756, dtype=torch.float64)
2 gae_duplicate tensor(-0.2640, dtype=torch.float64) tensor(-0.7632, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-540.516845703125
value loss:20.031946182250977
entropies:348.3350830078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.790367126464844 seconds
19 rew tensor(1.2101, dtype=torch.float64) delta_t tensor(-0.1378, dtype=torch.float64)
19 gae_duplicate tensor(-0.2547, dtype=torch.float64) tensor(2.5453, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1585, dtype=torch.float64) delta_t tensor(-0.0380, dtype=torch.float64)
18 gae_duplicate tensor(-0.1073, dtype=torch.float64) tensor(1.0650, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0953, dtype=torch.float64) delta_t tensor(-0.0670, dtype=torch.float64)
17 gae_duplicate tensor(-0.2085, dtype=torch.float64) tensor(1.3175, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8299, dtype=torch.float64) delta_t tensor(-0.2658, dtype=torch.float64)
16 gae_duplicate tensor(-1.5096, dtype=torch.float64) tensor(5.7199, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9199, dtype=torch.float64) delta_t tensor(-0.0270, dtype=torch.float64)
15 gae_duplicate tensor(-0.2023, dtype=torch.float64) tensor(1.0611, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8186, dtype=torch.float64) delta_t tensor(0.3044, dtype=torch.float64)
14 gae_duplicate tensor(0.1251, dtype=torch.float64) tensor(-5.5892, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.4246, dtype=torch.float64) delta_t tensor(-0.8874, dtype=torch.float64)
13 gae_duplicate tensor(-2.7287, dtype=torch.float64) tensor(17.2574, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1637, dtype=torch.float64) delta_t tensor(-0.1221, dtype=torch.float64)
12 gae_duplicate tensor(-1.5681, dtype=torch.float64) tensor(5.4281, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1775, dtype=torch.float64) delta_t tensor(-0.0441, dtype=torch.float64)
11 gae_duplicate tensor(-0.2029, dtype=torch.float64) tensor(1.3822, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0538, dtype=torch.float64) delta_t tensor(0.1127, dtype=torch.float64)
10 gae_duplicate tensor(-0.1434, dtype=torch.float64) tensor(-1.9158, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2906, dtype=torch.float64) delta_t tensor(-0.0424, dtype=torch.float64)
9 gae_duplicate tensor(-0.2550, dtype=torch.float64) tensor(0.6158, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3884, dtype=torch.float64) delta_t tensor(0.0291, dtype=torch.float64)
8 gae_duplicate tensor(-0.1017, dtype=torch.float64) tensor(-0.5324, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0257, dtype=torch.float64) delta_t tensor(-0.0308, dtype=torch.float64)
7 gae_duplicate tensor(-0.2335, dtype=torch.float64) tensor(0.7239, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4786, dtype=torch.float64) delta_t tensor(0.1732, dtype=torch.float64)
6 gae_duplicate tensor(0.0089, dtype=torch.float64) tensor(-3.3336, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8005, dtype=torch.float64) delta_t tensor(0.0038, dtype=torch.float64)
5 gae_duplicate tensor(-0.1999, dtype=torch.float64) tensor(-0.2308, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0416, dtype=torch.float64) delta_t tensor(-0.0567, dtype=torch.float64)
4 gae_duplicate tensor(-0.2151, dtype=torch.float64) tensor(1.2923, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2393, dtype=torch.float64) delta_t tensor(0.0270, dtype=torch.float64)
3 gae_duplicate tensor(-0.0737, dtype=torch.float64) tensor(-0.4702, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3600, dtype=torch.float64) delta_t tensor(-0.1139, dtype=torch.float64)
2 gae_duplicate tensor(-0.3348, dtype=torch.float64) tensor(2.0251, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1625.7061767578125
value loss:28.439830780029297
entropies:348.7635803222656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.76430606842041 seconds
19 rew tensor(1.1749, dtype=torch.float64) delta_t tensor(-0.0853, dtype=torch.float64)
19 gae_duplicate tensor(-0.1872, dtype=torch.float64) tensor(1.7251, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1757, dtype=torch.float64) delta_t tensor(0.0545, dtype=torch.float64)
18 gae_duplicate tensor(-0.1549, dtype=torch.float64) tensor(-0.9913, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0611, dtype=torch.float64) delta_t tensor(0.0365, dtype=torch.float64)
17 gae_duplicate tensor(-0.1813, dtype=torch.float64) tensor(-0.9151, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0746, dtype=torch.float64) delta_t tensor(-0.0186, dtype=torch.float64)
16 gae_duplicate tensor(-0.1170, dtype=torch.float64) tensor(0.1137, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6707, dtype=torch.float64) delta_t tensor(-0.1154, dtype=torch.float64)
15 gae_duplicate tensor(-1.2674, dtype=torch.float64) tensor(1.8703, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5126, dtype=torch.float64) delta_t tensor(0.0088, dtype=torch.float64)
14 gae_duplicate tensor(-0.9811, dtype=torch.float64) tensor(0.4803, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1111, dtype=torch.float64) delta_t tensor(-0.5489, dtype=torch.float64)
13 gae_duplicate tensor(-3.8232, dtype=torch.float64) tensor(9.3606, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2964, dtype=torch.float64) delta_t tensor(0.2124, dtype=torch.float64)
12 gae_duplicate tensor(-0.1761, dtype=torch.float64) tensor(-2.9974, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4533, dtype=torch.float64) delta_t tensor(-0.1071, dtype=torch.float64)
11 gae_duplicate tensor(-0.4079, dtype=torch.float64) tensor(1.6300, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2306, dtype=torch.float64) delta_t tensor(0.0597, dtype=torch.float64)
10 gae_duplicate tensor(-0.2570, dtype=torch.float64) tensor(-1.1305, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6212, dtype=torch.float64) delta_t tensor(0.0391, dtype=torch.float64)
9 gae_duplicate tensor(-0.3024, dtype=torch.float64) tensor(-0.7425, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6755, dtype=torch.float64) delta_t tensor(-0.0944, dtype=torch.float64)
8 gae_duplicate tensor(-0.6528, dtype=torch.float64) tensor(1.6120, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8445, dtype=torch.float64) delta_t tensor(-0.2821, dtype=torch.float64)
7 gae_duplicate tensor(-2.0844, dtype=torch.float64) tensor(5.3267, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9765, dtype=torch.float64) delta_t tensor(0.1156, dtype=torch.float64)
6 gae_duplicate tensor(-0.4671, dtype=torch.float64) tensor(-2.1950, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1542, dtype=torch.float64) delta_t tensor(0.1313, dtype=torch.float64)
5 gae_duplicate tensor(-0.2266, dtype=torch.float64) tensor(-2.5667, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2933, dtype=torch.float64) delta_t tensor(-0.1171, dtype=torch.float64)
4 gae_duplicate tensor(-0.2318, dtype=torch.float64) tensor(1.9854, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6644, dtype=torch.float64) delta_t tensor(0.1143, dtype=torch.float64)
3 gae_duplicate tensor(-0.0622, dtype=torch.float64) tensor(-2.1128, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0246, dtype=torch.float64) delta_t tensor(0.0069, dtype=torch.float64)
2 gae_duplicate tensor(-0.1444, dtype=torch.float64) tensor(-0.2012, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-647.7870483398438
value loss:40.38154983520508
entropies:348.89935302734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.288743019104004 seconds
19 rew tensor(1.1746, dtype=torch.float64) delta_t tensor(-0.0857, dtype=torch.float64)
19 gae_duplicate tensor(-0.1916, dtype=torch.float64) tensor(1.8428, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1754, dtype=torch.float64) delta_t tensor(0.0692, dtype=torch.float64)
18 gae_duplicate tensor(-0.0629, dtype=torch.float64) tensor(-1.1109, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0745, dtype=torch.float64) delta_t tensor(0.0674, dtype=torch.float64)
17 gae_duplicate tensor(-0.1605, dtype=torch.float64) tensor(-1.4494, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9318, dtype=torch.float64) delta_t tensor(-0.0137, dtype=torch.float64)
16 gae_duplicate tensor(-0.1068, dtype=torch.float64) tensor(0.0984, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8706, dtype=torch.float64) delta_t tensor(0.1933, dtype=torch.float64)
15 gae_duplicate tensor(-0.0324, dtype=torch.float64) tensor(-4.0111, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3909, dtype=torch.float64) delta_t tensor(-0.0118, dtype=torch.float64)
14 gae_duplicate tensor(-1.0050, dtype=torch.float64) tensor(0.1648, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6779, dtype=torch.float64) delta_t tensor(0.0876, dtype=torch.float64)
13 gae_duplicate tensor(-0.0555, dtype=torch.float64) tensor(-1.7455, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1908, dtype=torch.float64) delta_t tensor(0.0659, dtype=torch.float64)
12 gae_duplicate tensor(-0.1501, dtype=torch.float64) tensor(-1.3735, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5955, dtype=torch.float64) delta_t tensor(0.0569, dtype=torch.float64)
11 gae_duplicate tensor(-0.1726, dtype=torch.float64) tensor(-1.0970, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2046, dtype=torch.float64) delta_t tensor(-0.0468, dtype=torch.float64)
10 gae_duplicate tensor(-0.3697, dtype=torch.float64) tensor(0.9475, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3894, dtype=torch.float64) delta_t tensor(0.0576, dtype=torch.float64)
9 gae_duplicate tensor(-0.1012, dtype=torch.float64) tensor(-1.0645, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5497, dtype=torch.float64) delta_t tensor(0.0543, dtype=torch.float64)
8 gae_duplicate tensor(-0.1649, dtype=torch.float64) tensor(-1.2531, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7640, dtype=torch.float64) delta_t tensor(0.1153, dtype=torch.float64)
7 gae_duplicate tensor(-0.2095, dtype=torch.float64) tensor(-2.1264, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7702, dtype=torch.float64) delta_t tensor(0.1779, dtype=torch.float64)
6 gae_duplicate tensor(0.0356, dtype=torch.float64) tensor(-3.5040, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4022, dtype=torch.float64) delta_t tensor(0.1161, dtype=torch.float64)
5 gae_duplicate tensor(-0.1371, dtype=torch.float64) tensor(-2.6048, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0162, dtype=torch.float64) delta_t tensor(-0.0330, dtype=torch.float64)
4 gae_duplicate tensor(-0.2690, dtype=torch.float64) tensor(0.5255, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0103, dtype=torch.float64) delta_t tensor(0.0778, dtype=torch.float64)
3 gae_duplicate tensor(-0.2026, dtype=torch.float64) tensor(-1.2896, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3409, dtype=torch.float64) delta_t tensor(0.0076, dtype=torch.float64)
2 gae_duplicate tensor(-0.2524, dtype=torch.float64) tensor(-0.2063, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:945.57958984375
value loss:7.57565975189209
entropies:349.2847595214844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3912.8271)
ToM Target loss= tensor(3813.0942)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.19351601600647 seconds
19 rew tensor(1.1363, dtype=torch.float64) delta_t tensor(-0.0308, dtype=torch.float64)
19 gae_duplicate tensor(-0.0858, dtype=torch.float64) tensor(0.5945, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1745, dtype=torch.float64) delta_t tensor(0.1299, dtype=torch.float64)
18 gae_duplicate tensor(-0.0103, dtype=torch.float64) tensor(-2.5161, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0364, dtype=torch.float64) delta_t tensor(0.0321, dtype=torch.float64)
17 gae_duplicate tensor(-0.1284, dtype=torch.float64) tensor(-1.0738, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9471, dtype=torch.float64) delta_t tensor(0.0588, dtype=torch.float64)
16 gae_duplicate tensor(-0.0477, dtype=torch.float64) tensor(-1.1360, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8958, dtype=torch.float64) delta_t tensor(0.1652, dtype=torch.float64)
15 gae_duplicate tensor(-0.0629, dtype=torch.float64) tensor(-3.0787, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1031, dtype=torch.float64) delta_t tensor(-0.3261, dtype=torch.float64)
14 gae_duplicate tensor(-2.6415, dtype=torch.float64) tensor(7.0554, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6136, dtype=torch.float64) delta_t tensor(0.0640, dtype=torch.float64)
13 gae_duplicate tensor(-0.0967, dtype=torch.float64) tensor(-0.6119, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1827, dtype=torch.float64) delta_t tensor(0.1145, dtype=torch.float64)
12 gae_duplicate tensor(-0.0429, dtype=torch.float64) tensor(-2.2987, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4978, dtype=torch.float64) delta_t tensor(-0.0159, dtype=torch.float64)
11 gae_duplicate tensor(-0.1679, dtype=torch.float64) tensor(0.0344, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0989, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
10 gae_duplicate tensor(-0.1326, dtype=torch.float64) tensor(-0.6474, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5339, dtype=torch.float64) delta_t tensor(0.0184, dtype=torch.float64)
9 gae_duplicate tensor(-0.0575, dtype=torch.float64) tensor(-0.4026, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6940, dtype=torch.float64) delta_t tensor(-0.1154, dtype=torch.float64)
8 gae_duplicate tensor(-0.1950, dtype=torch.float64) tensor(2.3222, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3441, dtype=torch.float64) delta_t tensor(0.0073, dtype=torch.float64)
7 gae_duplicate tensor(-0.2523, dtype=torch.float64) tensor(0.0322, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7088, dtype=torch.float64) delta_t tensor(0.0690, dtype=torch.float64)
6 gae_duplicate tensor(-0.1023, dtype=torch.float64) tensor(-1.2452, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2957, dtype=torch.float64) delta_t tensor(0.1357, dtype=torch.float64)
5 gae_duplicate tensor(-0.0702, dtype=torch.float64) tensor(-2.6127, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2095, dtype=torch.float64) delta_t tensor(-0.0623, dtype=torch.float64)
4 gae_duplicate tensor(-0.1933, dtype=torch.float64) tensor(0.9501, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6748, dtype=torch.float64) delta_t tensor(0.0355, dtype=torch.float64)
3 gae_duplicate tensor(-0.1793, dtype=torch.float64) tensor(-0.4146, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1468, dtype=torch.float64) delta_t tensor(0.0224, dtype=torch.float64)
2 gae_duplicate tensor(-0.1637, dtype=torch.float64) tensor(-0.4373, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:201.92311096191406
value loss:13.8526611328125
entropies:349.3531494140625
Policy training finished
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt